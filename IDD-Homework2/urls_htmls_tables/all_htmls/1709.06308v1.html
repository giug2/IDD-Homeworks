<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1709.06308] Exploring Human-like Attention Supervision in Visual Question Answering</title><meta property="og:description" content="Attention mechanisms have been widely applied in the Visual Question Answering (VQA) task,
as they help to focus on the area-of-interest of both visual and textual information.
To answer the questions correctly, the mo…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Exploring Human-like Attention Supervision in Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Exploring Human-like Attention Supervision in Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1709.06308">

<!--Generated on Thu Mar  7 23:59:49 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Exploring Human-like Attention Supervision in Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Tingting Qiao     Jianfeng Dong     Duanqing Xu 
<br class="ltx_break">  Zhejiang University      Zhejiang University     Zhejiang University
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">qiaott@zju.edu.cn</span>   <span id="id2.2.id2" class="ltx_text ltx_font_typewriter">danieljf24@zju.edu.cn</span>   <span id="id3.3.id3" class="ltx_text ltx_font_typewriter">xdq@zju.edu.cn</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Attention mechanisms have been widely applied in the Visual Question Answering (VQA) task,
as they help to focus on the area-of-interest of both visual and textual information.
To answer the questions correctly, the model needs to selectively target different areas of an image,
which suggests that an attention-based model may benefit from an explicit attention supervision.
In this work, we aim to address the problem of adding attention supervision to VQA models.
Since there is a lack of human attention data,
we first propose a <em id="id4.id1.1" class="ltx_emph ltx_font_italic">Human Attention Network (HAN)</em> to generate human-like attention maps,
training on a recently released dataset called Human ATtention Dataset (VQA-HAT).
Then, we apply the pre-trained HAN on the VQA v2.0 dataset to automatically produce the human-like attention maps for all image-question pairs.
The generated human-like attention map dataset for the VQA v2.0 dataset is named as <em id="id4.id1.2" class="ltx_emph ltx_font_italic">Human-Like ATtention (HLAT)</em> dataset.
Finally, we apply human-like attention supervision to an attention-based VQA model.
The experiments show that adding human-like supervision yields a more accurate attention together with a better performance, showing a promising future for human-like attention supervision in VQA.</p>
</div>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Introduction</h2>

<div id="Sx1.p1" class="ltx_para ltx_noindent">
<p id="Sx1.p1.1" class="ltx_p">Recently, attention-based models have been proved effective in VQA recently (<span id="Sx1.p1.1.1" class="ltx_text ltx_font_bold">?</span>; <span id="Sx1.p1.1.2" class="ltx_text ltx_font_bold">?</span>; <span id="Sx1.p1.1.3" class="ltx_text ltx_font_bold">?</span>; <span id="Sx1.p1.1.4" class="ltx_text ltx_font_bold">?</span>; <span id="Sx1.p1.1.5" class="ltx_text ltx_font_bold">?</span>).
Inspired by human attention mechanisms, these models learn dynamic weights indicating the importance of different regions in an image.
However, the accuracy of the attention that is implicitly learned during training is not ensured.
As it can be observed in Fig.<a href="#Sx1.F1" title="Figure 1 ‣ Introduction ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>,
the model without attention supervision generates inaccurate attention maps,
which results in the incorrect answers.
A new VQA-HAT (Human ATtention) dataset has been recently collected by (<span id="Sx1.p1.1.6" class="ltx_text ltx_font_bold">?</span>) and used to evaluate the attention learned in VQA attention-based models.
The conclusion of this work was that current attention-based models do not seem to focus on the same area
as humans do when answering the questions,
which suggests that there is still room for improving the performance of VQA by adding human attention supervision.
</p>
</div>
<figure id="Sx1.F1" class="ltx_figure"><img src="/html/1709.06308/assets/x1.png" id="Sx1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="390" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Visualization of images, attention maps and predicted answers. As it is possible to see, through explicit attention supervision, the attention maps are more accurate and the predicted answers yield better results. Best viewed in color.</figcaption>
</figure>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p">The public VQA-HAT dataset has good potential to help training.
However, only around 10<math id="Sx1.p2.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="Sx1.p2.1.m1.1a"><mo id="Sx1.p2.1.m1.1.1" xref="Sx1.p2.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="Sx1.p2.1.m1.1b"><csymbol cd="latexml" id="Sx1.p2.1.m1.1.1.cmml" xref="Sx1.p2.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p2.1.m1.1c">\%</annotation></semantics></math> of the human attention maps for the image-question pairs in the VQA v1.0 dataset (<span id="Sx1.p2.1.1" class="ltx_text ltx_font_bold">?</span>) are labeled,
which makes it less effective when used for the purpose of evaluating and improving the quality of the machine-generated attention maps as it is quite limited.
Besides, there are further questions to be explored:</p>
<ul id="Sx1.I1" class="ltx_itemize">
<li id="Sx1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i1.p1.1" class="ltx_p">Do the regions highlighted by the human attention help VQA attention-based models to yield better answers?</p>
</div>
</li>
<li id="Sx1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i2.p1.1" class="ltx_p">How can human attention help to improve the performance of attention-based models in VQA?</p>
</div>
</li>
</ul>
<p id="Sx1.p2.2" class="ltx_p">To tackle these questions, a new and large-scale human attention dataset is first needed.
Collecting human labeled attention maps is one possible approach, but as mentioned in (<span id="Sx1.p2.2.1" class="ltx_text ltx_font_bold">?</span>; <span id="Sx1.p2.2.2" class="ltx_text ltx_font_bold">?</span>),
it is a time-consuming and expensive task.
Since attention-based models in VQA have shown the good performance on VQA tasks,
we therefore aim to develop a general network to automatically generate attention maps for image-question pairs through training on the existing VQA-HAT.
We propose a Human Attention Network (HAN) to generate attention maps for image-question pairs.
Specifically, we propose to use a Gated Recurrent Unit (GRU) (<span id="Sx1.p2.2.3" class="ltx_text ltx_font_bold">?</span>) to encode several attention maps that are learned in the attention-based model during training in order to get a refined attention map.
The pre-trained HAN is then used to generate attention maps for the image-question pairs in the VQA v2.0 dataset.
The new attention map dataset for the VQA v2.0 dataset is named as Human-Like ATtention (HLAT) dataset.</p>
</div>
<div id="Sx1.p3" class="ltx_para">
<p id="Sx1.p3.1" class="ltx_p">The human-like attention maps are then used as the attention supervision in the VQA attention-based model.
In order to better verify the effectiveness of the human-like attention supervision,
we conduct two contrast experiments on the VQA v2.0 dataset.
To be specific, the attention-based model proposed by (<span id="Sx1.p3.1.1" class="ltx_text ltx_font_bold">?</span>) is used as the baseline.
We then add human-like attention supervision to the baseline model.
The experiment results show that the human-like attention supervised model outperforms the baseline model by 0.15<math id="Sx1.p3.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="Sx1.p3.1.m1.1a"><mo id="Sx1.p3.1.m1.1.1" xref="Sx1.p3.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="Sx1.p3.1.m1.1b"><csymbol cd="latexml" id="Sx1.p3.1.m1.1.1.cmml" xref="Sx1.p3.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p3.1.m1.1c">\%</annotation></semantics></math>,
demonstrating the effectiveness of human-like attention supervision.
As it can be seen in Fig.<a href="#Sx1.F1" title="Figure 1 ‣ Introduction ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the model with attention supervision generates more accurate attention and gives the better answers.
To summarize, the main contributions of our work are as follows:</p>
</div>
<div id="Sx1.p4" class="ltx_para">
<p id="Sx1.p4.1" class="ltx_p">1. A Human Attention Network (HAN) which can be conveniently used to produce human-like attention maps for image-question pairs is proposed.</p>
</div>
<div id="Sx1.p5" class="ltx_para">
<p id="Sx1.p5.1" class="ltx_p">2. The pre-trained HAN is used to produce human-like attention maps for all the image-question pairs in the VQA v2.0 dataset.
We name the produced attention dataset for the VQA v2.0 dataset as Human-Like ATtention dataset (HLAT).
The HLAT can be used to explicitly train the attention-based models and also evaluate the quality of the model-generated attention.
The dataset will be made available to the public.</p>
</div>
<div id="Sx1.p6" class="ltx_para">
<p id="Sx1.p6.1" class="ltx_p">3. The overall accuracy of the attention-based model improves 0.15<math id="Sx1.p6.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="Sx1.p6.1.m1.1a"><mo id="Sx1.p6.1.m1.1.1" xref="Sx1.p6.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="Sx1.p6.1.m1.1b"><csymbol cd="latexml" id="Sx1.p6.1.m1.1.1.cmml" xref="Sx1.p6.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p6.1.m1.1c">\%</annotation></semantics></math> on the VQA v2.0 test-dev set by adding human-like attention supervision, showing the effectiveness of explicit human-like attention supervision in VQA.
Therefore, we get to the conclusion that regions focused by humans indeed help VQA attention-based models to achieve a better performance.</p>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Related Work</h2>

<div id="Sx2.p1" class="ltx_para">
<p id="Sx2.p1.1" class="ltx_p"><span id="Sx2.p1.1.1" class="ltx_text ltx_font_bold">VQA attention-based model</span>
 Traditional models (<span id="Sx2.p1.1.2" class="ltx_text ltx_font_bold">?</span>; <span id="Sx2.p1.1.3" class="ltx_text ltx_font_bold">?</span>; <span id="Sx2.p1.1.4" class="ltx_text ltx_font_bold">?</span>; <span id="Sx2.p1.1.5" class="ltx_text ltx_font_bold">?</span>; <span id="Sx2.p1.1.6" class="ltx_text ltx_font_bold">?</span>)
usually present general global features to represent the visual information,
which may contain a lot of irrelevant and noisy information when predicting the answer.
Attention mechanisms are therefore proposed to address this problem as
they help models to focus only on the relevant region of the image according to the given question.
(<span id="Sx2.p1.1.7" class="ltx_text ltx_font_bold">?</span>) proposed stacked attention networks which employ the attention networks for multi-step reasoning, narrowing down the selection of visual information.
Dynamic memory networks (<span id="Sx2.p1.1.8" class="ltx_text ltx_font_bold">?</span>) integrated an attention mechanism with a memory model.
Multi-model compact bilinear pooling (<span id="Sx2.p1.1.9" class="ltx_text ltx_font_bold">?</span>) combined visual and textual representations to a joint representation.
Hierarchical co-attention network (<span id="Sx2.p1.1.10" class="ltx_text ltx_font_bold">?</span>) recursively fused the attended question and image features to output the answers.
Dual attention networks (<span id="Sx2.p1.1.11" class="ltx_text ltx_font_bold">?</span>) employed multiple reasoning steps based on the memory of previous attention.
(<span id="Sx2.p1.1.12" class="ltx_text ltx_font_bold">?</span>) proposed multimodal low-rank bilinear pooling (MLB) which uses element-wise multiplication to reduce complex computations of the original bilinear pooling model.</p>
</div>
<div id="Sx2.p2" class="ltx_para">
<p id="Sx2.p2.1" class="ltx_p">One limitation of the mentioned works is that they are unsupervised attention models, whose attention is learned without supervision.
The attention in these models is always learned implicitly and may end up being simply fortuitous,
as it can be seen in Fig.<a href="#Sx1.F1" title="Figure 1 ‣ Introduction ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
To address this problem, we explore to add attention supervision to the attention-based model.
The attention maps in the HLAT are used as attention supervision to train the VQA model on the VQA v2.0 dataset.</p>
</div>
<div id="Sx2.p3" class="ltx_para ltx_noindent">
<p id="Sx2.p3.1" class="ltx_p"><span id="Sx2.p3.1.1" class="ltx_text ltx_font_bold">Attention supervision</span>
 Attention supervision has recently been explored in computer vision.
(<span id="Sx2.p3.1.2" class="ltx_text ltx_font_bold">?</span>) leveraged gaze tracking information to provide spatial and temporal attention for video caption generation.
In image captioning, (<span id="Sx2.p3.1.3" class="ltx_text ltx_font_bold">?</span>) proposed a method to improve the correctness of visual attention using object segments as supervision.
(<span id="Sx2.p3.1.4" class="ltx_text ltx_font_bold">?</span>) proposed to use segmentations which are manually labeled by humans to supervise attention generated during training in VQA.
However, using segmentations as attention supervision is potentially inaccurate, especially for some questions that need more reasoning, for example, <em id="Sx2.p3.1.5" class="ltx_emph ltx_font_italic">are all children paying attention to the class?</em> Or <em id="Sx2.p3.1.6" class="ltx_emph ltx_font_italic">Is it a sunny day?</em> It is ineffective to segment a specific object to answer the questions. Apart from the accurate attention area, the model also needs more global information to analyze. We propose to add human-like attention supervision to models, as human-like attention contains lots of information indicating the important areas that should be focused.</p>
</div>
<div id="Sx2.p4" class="ltx_para ltx_noindent">
<p id="Sx2.p4.2" class="ltx_p"><span id="Sx2.p4.2.1" class="ltx_text ltx_font_bold">Human attention dataset</span>
 Research about human attention and eye tracking has already been carried out (<span id="Sx2.p4.2.2" class="ltx_text ltx_font_bold">?</span>; <span id="Sx2.p4.2.3" class="ltx_text ltx_font_bold">?</span>; <span id="Sx2.p4.2.4" class="ltx_text ltx_font_bold">?</span>; <span id="Sx2.p4.2.5" class="ltx_text ltx_font_bold">?</span>).
(<span id="Sx2.p4.2.6" class="ltx_text ltx_font_bold">?</span>) used mouse-tracking to collect large-scale human attention annotations for MS COCO.
Recently, (<span id="Sx2.p4.2.7" class="ltx_text ltx_font_bold">?</span>) published the VQA-HAT (Human ATtention) dataset which contains human attention annotations for around 10<math id="Sx2.p4.2.m2.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="Sx2.p4.2.m2.1a"><mo id="Sx2.p4.2.m2.1.1" xref="Sx2.p4.2.m2.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="Sx2.p4.2.m2.1b"><csymbol cd="latexml" id="Sx2.p4.2.m2.1.1.cmml" xref="Sx2.p4.2.m2.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx2.p4.2.m2.1c">\%</annotation></semantics></math> image-question pairs in the VQA v1.0 dataset.
These datasets indicate the attentive area of the human when staring at the images and are very useful for evaluation purposes.
However, as mentioned in (<span id="Sx2.p4.2.8" class="ltx_text ltx_font_bold">?</span>; <span id="Sx2.p4.2.9" class="ltx_text ltx_font_bold">?</span>),
collecting datasets is always a very time-consuming task and it requires a vast amount of effort.
In this work, instead of collecting human labeled attention data, the HAN is proposed to generate attention maps automatically, training on the VQA-HAT dataset.
The pre-trained HAN can be generally used to produce attention maps for image-question pairs.</p>
</div>
<figure id="Sx2.F2" class="ltx_figure"><img src="/html/1709.06308/assets/x2.png" id="Sx2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="922" height="331" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Human Attention Network (HAN) for predicting the attention map given an image-question pair.</figcaption>
</figure>
</section>
<section id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Approach</h2>

<div id="Sx3.p1" class="ltx_para">
<p id="Sx3.p1.1" class="ltx_p">In this section, details about this work will be provided.
First, the input representation will be introduced.
Then, the details of the Human Attention Network (HAN) and the supervised attention model for VQA will be presented.
To help understanding, they are illustrated in different sections.
</p>
</div>
<section id="Sx3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Input representation</h3>

<section id="Sx3.SSx1.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Image representation</h4>

<div id="Sx3.SSx1.SSSx1.p1" class="ltx_para">
<p id="Sx3.SSx1.SSSx1.p1.4" class="ltx_p"> Following the common practice in the art (<span id="Sx3.SSx1.SSSx1.p1.4.1" class="ltx_text ltx_font_bold">?</span>; <span id="Sx3.SSx1.SSSx1.p1.4.2" class="ltx_text ltx_font_bold">?</span>), image features are extracted from the ResNet-152 (<span id="Sx3.SSx1.SSSx1.p1.4.3" class="ltx_text ltx_font_bold">?</span>) which is pre-trained on the ImageNet (<span id="Sx3.SSx1.SSSx1.p1.4.4" class="ltx_text ltx_font_bold">?</span>).
Specifically, the original image <math id="Sx3.SSx1.SSSx1.p1.2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="Sx3.SSx1.SSSx1.p1.2.m2.1a"><mi id="Sx3.SSx1.SSSx1.p1.2.m2.1.1" xref="Sx3.SSx1.SSSx1.p1.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx1.p1.2.m2.1b"><ci id="Sx3.SSx1.SSSx1.p1.2.m2.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx1.p1.2.m2.1c">I</annotation></semantics></math> is first scaled to <math id="Sx3.SSx1.SSSx1.p1.3.m3.1" class="ltx_Math" alttext="448\times 448" display="inline"><semantics id="Sx3.SSx1.SSSx1.p1.3.m3.1a"><mrow id="Sx3.SSx1.SSSx1.p1.3.m3.1.1" xref="Sx3.SSx1.SSSx1.p1.3.m3.1.1.cmml"><mn id="Sx3.SSx1.SSSx1.p1.3.m3.1.1.2" xref="Sx3.SSx1.SSSx1.p1.3.m3.1.1.2.cmml">448</mn><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx1.SSSx1.p1.3.m3.1.1.1" xref="Sx3.SSx1.SSSx1.p1.3.m3.1.1.1.cmml">×</mo><mn id="Sx3.SSx1.SSSx1.p1.3.m3.1.1.3" xref="Sx3.SSx1.SSSx1.p1.3.m3.1.1.3.cmml">448</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx1.p1.3.m3.1b"><apply id="Sx3.SSx1.SSSx1.p1.3.m3.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.3.m3.1.1"><times id="Sx3.SSx1.SSSx1.p1.3.m3.1.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.3.m3.1.1.1"></times><cn type="integer" id="Sx3.SSx1.SSSx1.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx1.SSSx1.p1.3.m3.1.1.2">448</cn><cn type="integer" id="Sx3.SSx1.SSSx1.p1.3.m3.1.1.3.cmml" xref="Sx3.SSx1.SSSx1.p1.3.m3.1.1.3">448</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx1.p1.3.m3.1c">448\times 448</annotation></semantics></math>. Then, the feature from the last convolutional layer of the ResNet-152 is taken as the initial feature map.
The image <math id="Sx3.SSx1.SSSx1.p1.4.m4.1" class="ltx_Math" alttext="I" display="inline"><semantics id="Sx3.SSx1.SSSx1.p1.4.m4.1a"><mi id="Sx3.SSx1.SSSx1.p1.4.m4.1.1" xref="Sx3.SSx1.SSSx1.p1.4.m4.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx1.p1.4.m4.1b"><ci id="Sx3.SSx1.SSSx1.p1.4.m4.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.4.m4.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx1.p1.4.m4.1c">I</annotation></semantics></math> is represented as</p>
<table id="Sx3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E1.m1.2" class="ltx_Math" alttext="F=CNN(I)," display="block"><semantics id="Sx3.E1.m1.2a"><mrow id="Sx3.E1.m1.2.2.1" xref="Sx3.E1.m1.2.2.1.1.cmml"><mrow id="Sx3.E1.m1.2.2.1.1" xref="Sx3.E1.m1.2.2.1.1.cmml"><mi id="Sx3.E1.m1.2.2.1.1.2" xref="Sx3.E1.m1.2.2.1.1.2.cmml">F</mi><mo id="Sx3.E1.m1.2.2.1.1.1" xref="Sx3.E1.m1.2.2.1.1.1.cmml">=</mo><mrow id="Sx3.E1.m1.2.2.1.1.3" xref="Sx3.E1.m1.2.2.1.1.3.cmml"><mi id="Sx3.E1.m1.2.2.1.1.3.2" xref="Sx3.E1.m1.2.2.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.2.2.1.1.3.1" xref="Sx3.E1.m1.2.2.1.1.3.1.cmml">​</mo><mi id="Sx3.E1.m1.2.2.1.1.3.3" xref="Sx3.E1.m1.2.2.1.1.3.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.2.2.1.1.3.1a" xref="Sx3.E1.m1.2.2.1.1.3.1.cmml">​</mo><mi id="Sx3.E1.m1.2.2.1.1.3.4" xref="Sx3.E1.m1.2.2.1.1.3.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.2.2.1.1.3.1b" xref="Sx3.E1.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="Sx3.E1.m1.2.2.1.1.3.5.2" xref="Sx3.E1.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="Sx3.E1.m1.2.2.1.1.3.5.2.1" xref="Sx3.E1.m1.2.2.1.1.3.cmml">(</mo><mi id="Sx3.E1.m1.1.1" xref="Sx3.E1.m1.1.1.cmml">I</mi><mo stretchy="false" id="Sx3.E1.m1.2.2.1.1.3.5.2.2" xref="Sx3.E1.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E1.m1.2.2.1.2" xref="Sx3.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E1.m1.2b"><apply id="Sx3.E1.m1.2.2.1.1.cmml" xref="Sx3.E1.m1.2.2.1"><eq id="Sx3.E1.m1.2.2.1.1.1.cmml" xref="Sx3.E1.m1.2.2.1.1.1"></eq><ci id="Sx3.E1.m1.2.2.1.1.2.cmml" xref="Sx3.E1.m1.2.2.1.1.2">𝐹</ci><apply id="Sx3.E1.m1.2.2.1.1.3.cmml" xref="Sx3.E1.m1.2.2.1.1.3"><times id="Sx3.E1.m1.2.2.1.1.3.1.cmml" xref="Sx3.E1.m1.2.2.1.1.3.1"></times><ci id="Sx3.E1.m1.2.2.1.1.3.2.cmml" xref="Sx3.E1.m1.2.2.1.1.3.2">𝐶</ci><ci id="Sx3.E1.m1.2.2.1.1.3.3.cmml" xref="Sx3.E1.m1.2.2.1.1.3.3">𝑁</ci><ci id="Sx3.E1.m1.2.2.1.1.3.4.cmml" xref="Sx3.E1.m1.2.2.1.1.3.4">𝑁</ci><ci id="Sx3.E1.m1.1.1.cmml" xref="Sx3.E1.m1.1.1">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E1.m1.2c">F=CNN(I),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx1.SSSx1.p1.9" class="ltx_p">where <math id="Sx3.SSx1.SSSx1.p1.5.m1.1" class="ltx_Math" alttext="F\in\mathbbm{R}^{m\times l^{2}}" display="inline"><semantics id="Sx3.SSx1.SSSx1.p1.5.m1.1a"><mrow id="Sx3.SSx1.SSSx1.p1.5.m1.1.1" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.cmml"><mi id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.2" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.2.cmml">F</mi><mo id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.1" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.1.cmml">∈</mo><msup id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.cmml"><mi id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.2" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.cmml"><mi id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.2" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.1" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.1.cmml">×</mo><msup id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3.cmml"><mi id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3.2" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3.2.cmml">l</mi><mn id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3.3" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3.3.cmml">2</mn></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx1.p1.5.m1.1b"><apply id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1"><in id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.1"></in><ci id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.2.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.2">𝐹</ci><apply id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.1.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3">superscript</csymbol><ci id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.2.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.2">ℝ</ci><apply id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3"><times id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.1.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.1"></times><ci id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.2.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.2">𝑚</ci><apply id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3.1.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3">superscript</csymbol><ci id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3.2.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3.2">𝑙</ci><cn type="integer" id="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3.3.cmml" xref="Sx3.SSx1.SSSx1.p1.5.m1.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx1.p1.5.m1.1c">F\in\mathbbm{R}^{m\times l^{2}}</annotation></semantics></math> is a feature matrix, <math id="Sx3.SSx1.SSSx1.p1.6.m2.1" class="ltx_Math" alttext="l^{2}=14\times 14" display="inline"><semantics id="Sx3.SSx1.SSSx1.p1.6.m2.1a"><mrow id="Sx3.SSx1.SSSx1.p1.6.m2.1.1" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.cmml"><msup id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2.cmml"><mi id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2.2" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2.2.cmml">l</mi><mn id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2.3" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2.3.cmml">2</mn></msup><mo id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.1" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.1.cmml">=</mo><mrow id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.cmml"><mn id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.2" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.2.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.1" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.1.cmml">×</mo><mn id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.3" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.3.cmml">14</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx1.p1.6.m2.1b"><apply id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1"><eq id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.1"></eq><apply id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2.cmml" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2.1.cmml" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2">superscript</csymbol><ci id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2.2.cmml" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2.2">𝑙</ci><cn type="integer" id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2.3.cmml" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.2.3">2</cn></apply><apply id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.cmml" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3"><times id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.1.cmml" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.1"></times><cn type="integer" id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.2.cmml" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.2">14</cn><cn type="integer" id="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.3.cmml" xref="Sx3.SSx1.SSSx1.p1.6.m2.1.1.3.3">14</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx1.p1.6.m2.1c">l^{2}=14\times 14</annotation></semantics></math> is the number of regions in the image and <math id="Sx3.SSx1.SSSx1.p1.7.m3.1" class="ltx_Math" alttext="m=2048" display="inline"><semantics id="Sx3.SSx1.SSSx1.p1.7.m3.1a"><mrow id="Sx3.SSx1.SSSx1.p1.7.m3.1.1" xref="Sx3.SSx1.SSSx1.p1.7.m3.1.1.cmml"><mi id="Sx3.SSx1.SSSx1.p1.7.m3.1.1.2" xref="Sx3.SSx1.SSSx1.p1.7.m3.1.1.2.cmml">m</mi><mo id="Sx3.SSx1.SSSx1.p1.7.m3.1.1.1" xref="Sx3.SSx1.SSSx1.p1.7.m3.1.1.1.cmml">=</mo><mn id="Sx3.SSx1.SSSx1.p1.7.m3.1.1.3" xref="Sx3.SSx1.SSSx1.p1.7.m3.1.1.3.cmml">2048</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx1.p1.7.m3.1b"><apply id="Sx3.SSx1.SSSx1.p1.7.m3.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.7.m3.1.1"><eq id="Sx3.SSx1.SSSx1.p1.7.m3.1.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.7.m3.1.1.1"></eq><ci id="Sx3.SSx1.SSSx1.p1.7.m3.1.1.2.cmml" xref="Sx3.SSx1.SSSx1.p1.7.m3.1.1.2">𝑚</ci><cn type="integer" id="Sx3.SSx1.SSSx1.p1.7.m3.1.1.3.cmml" xref="Sx3.SSx1.SSSx1.p1.7.m3.1.1.3">2048</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx1.p1.7.m3.1c">m=2048</annotation></semantics></math> is the dimension of the feature vector for each region.
Therefore, the input image <math id="Sx3.SSx1.SSSx1.p1.8.m4.1" class="ltx_Math" alttext="I" display="inline"><semantics id="Sx3.SSx1.SSSx1.p1.8.m4.1a"><mi id="Sx3.SSx1.SSSx1.p1.8.m4.1.1" xref="Sx3.SSx1.SSSx1.p1.8.m4.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx1.p1.8.m4.1b"><ci id="Sx3.SSx1.SSSx1.p1.8.m4.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.8.m4.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx1.p1.8.m4.1c">I</annotation></semantics></math> is represented by a set of visual feature vectors over <math id="Sx3.SSx1.SSSx1.p1.9.m5.1" class="ltx_Math" alttext="14\times 14" display="inline"><semantics id="Sx3.SSx1.SSSx1.p1.9.m5.1a"><mrow id="Sx3.SSx1.SSSx1.p1.9.m5.1.1" xref="Sx3.SSx1.SSSx1.p1.9.m5.1.1.cmml"><mn id="Sx3.SSx1.SSSx1.p1.9.m5.1.1.2" xref="Sx3.SSx1.SSSx1.p1.9.m5.1.1.2.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx1.SSSx1.p1.9.m5.1.1.1" xref="Sx3.SSx1.SSSx1.p1.9.m5.1.1.1.cmml">×</mo><mn id="Sx3.SSx1.SSSx1.p1.9.m5.1.1.3" xref="Sx3.SSx1.SSSx1.p1.9.m5.1.1.3.cmml">14</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx1.p1.9.m5.1b"><apply id="Sx3.SSx1.SSSx1.p1.9.m5.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.9.m5.1.1"><times id="Sx3.SSx1.SSSx1.p1.9.m5.1.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.9.m5.1.1.1"></times><cn type="integer" id="Sx3.SSx1.SSSx1.p1.9.m5.1.1.2.cmml" xref="Sx3.SSx1.SSSx1.p1.9.m5.1.1.2">14</cn><cn type="integer" id="Sx3.SSx1.SSSx1.p1.9.m5.1.1.3.cmml" xref="Sx3.SSx1.SSSx1.p1.9.m5.1.1.3">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx1.p1.9.m5.1c">14\times 14</annotation></semantics></math> regions of the image.</p>
</div>
</section>
<section id="Sx3.SSx1.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Question representation</h4>

<div id="Sx3.SSx1.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx1.SSSx2.p1.8" class="ltx_p"> Following (<span id="Sx3.SSx1.SSSx2.p1.8.1" class="ltx_text ltx_font_bold">?</span>), a GRU is employed to encode the question.
Specifically, given a question <math id="Sx3.SSx1.SSSx2.p1.2.m2.4" class="ltx_Math" alttext="q=\{q_{1},...,q_{|q|}\}" display="inline"><semantics id="Sx3.SSx1.SSSx2.p1.2.m2.4a"><mrow id="Sx3.SSx1.SSSx2.p1.2.m2.4.4" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.cmml"><mi id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.4" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.4.cmml">q</mi><mo id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.3" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.3.cmml">=</mo><mrow id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.3.cmml"><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.3" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.3.cmml">{</mo><msub id="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1" xref="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1.cmml"><mi id="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1.2" xref="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1.2.cmml">q</mi><mn id="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1.3" xref="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.4" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.3.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx1.SSSx2.p1.2.m2.2.2" xref="Sx3.SSx1.SSSx2.p1.2.m2.2.2.cmml">…</mi><mo id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.5" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.3.cmml">,</mo><msub id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.2" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.2.cmml"><mi id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.2.2" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.2.2.cmml">q</mi><mrow id="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.3" xref="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.3.1" xref="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi id="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.1" xref="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.1.cmml">q</mi><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.3.2" xref="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msub><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.6" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx2.p1.2.m2.4b"><apply id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4"><eq id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.3.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.3"></eq><ci id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.4.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.4">𝑞</ci><set id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.3.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2"><apply id="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1.2.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1.2">𝑞</ci><cn type="integer" id="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1.3.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.3.3.1.1.1.3">1</cn></apply><ci id="Sx3.SSx1.SSSx2.p1.2.m2.2.2.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.2.2">…</ci><apply id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.2.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.2.1.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.2">subscript</csymbol><ci id="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.2.2.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.4.4.2.2.2.2">𝑞</ci><apply id="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.2.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.3"><abs id="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.2.1.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.3.1"></abs><ci id="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.2.m2.1.1.1.1">𝑞</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx2.p1.2.m2.4c">q=\{q_{1},...,q_{|q|}\}</annotation></semantics></math>, where <math id="Sx3.SSx1.SSSx2.p1.3.m3.1" class="ltx_Math" alttext="q_{t}" display="inline"><semantics id="Sx3.SSx1.SSSx2.p1.3.m3.1a"><msub id="Sx3.SSx1.SSSx2.p1.3.m3.1.1" xref="Sx3.SSx1.SSSx2.p1.3.m3.1.1.cmml"><mi id="Sx3.SSx1.SSSx2.p1.3.m3.1.1.2" xref="Sx3.SSx1.SSSx2.p1.3.m3.1.1.2.cmml">q</mi><mi id="Sx3.SSx1.SSSx2.p1.3.m3.1.1.3" xref="Sx3.SSx1.SSSx2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx2.p1.3.m3.1b"><apply id="Sx3.SSx1.SSSx2.p1.3.m3.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx2.p1.3.m3.1.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.3.m3.1.1">subscript</csymbol><ci id="Sx3.SSx1.SSSx2.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx1.SSSx2.p1.3.m3.1.1.2">𝑞</ci><ci id="Sx3.SSx1.SSSx2.p1.3.m3.1.1.3.cmml" xref="Sx3.SSx1.SSSx2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx2.p1.3.m3.1c">q_{t}</annotation></semantics></math> is the one-hot encoding representation of the <math id="Sx3.SSx1.SSSx2.p1.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="Sx3.SSx1.SSSx2.p1.4.m4.1a"><mi id="Sx3.SSx1.SSSx2.p1.4.m4.1.1" xref="Sx3.SSx1.SSSx2.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx2.p1.4.m4.1b"><ci id="Sx3.SSx1.SSSx2.p1.4.m4.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx2.p1.4.m4.1c">t</annotation></semantics></math>-th word and <math id="Sx3.SSx1.SSSx2.p1.5.m5.1" class="ltx_Math" alttext="|q|" display="inline"><semantics id="Sx3.SSx1.SSSx2.p1.5.m5.1a"><mrow id="Sx3.SSx1.SSSx2.p1.5.m5.1.2.2" xref="Sx3.SSx1.SSSx2.p1.5.m5.1.2.1.cmml"><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.5.m5.1.2.2.1" xref="Sx3.SSx1.SSSx2.p1.5.m5.1.2.1.1.cmml">|</mo><mi id="Sx3.SSx1.SSSx2.p1.5.m5.1.1" xref="Sx3.SSx1.SSSx2.p1.5.m5.1.1.cmml">q</mi><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.5.m5.1.2.2.2" xref="Sx3.SSx1.SSSx2.p1.5.m5.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx2.p1.5.m5.1b"><apply id="Sx3.SSx1.SSSx2.p1.5.m5.1.2.1.cmml" xref="Sx3.SSx1.SSSx2.p1.5.m5.1.2.2"><abs id="Sx3.SSx1.SSSx2.p1.5.m5.1.2.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.5.m5.1.2.2.1"></abs><ci id="Sx3.SSx1.SSSx2.p1.5.m5.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.5.m5.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx2.p1.5.m5.1c">|q|</annotation></semantics></math> is the number of words in the question.
First, the words are embedded to a vector space by a word embedding matrix <math id="Sx3.SSx1.SSSx2.p1.6.m6.1" class="ltx_Math" alttext="W" display="inline"><semantics id="Sx3.SSx1.SSSx2.p1.6.m6.1a"><mi id="Sx3.SSx1.SSSx2.p1.6.m6.1.1" xref="Sx3.SSx1.SSSx2.p1.6.m6.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx2.p1.6.m6.1b"><ci id="Sx3.SSx1.SSSx2.p1.6.m6.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.6.m6.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx2.p1.6.m6.1c">W</annotation></semantics></math> which results in <math id="Sx3.SSx1.SSSx2.p1.7.m7.1" class="ltx_Math" alttext="x_{t}=Wq_{t}" display="inline"><semantics id="Sx3.SSx1.SSSx2.p1.7.m7.1a"><mrow id="Sx3.SSx1.SSSx2.p1.7.m7.1.1" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.cmml"><msub id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2.cmml"><mi id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2.2" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2.2.cmml">x</mi><mi id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2.3" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2.3.cmml">t</mi></msub><mo id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.1" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.1.cmml">=</mo><mrow id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.cmml"><mi id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.2" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.1" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.1.cmml">​</mo><msub id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3.cmml"><mi id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3.2" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3.2.cmml">q</mi><mi id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3.3" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx2.p1.7.m7.1b"><apply id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1"><eq id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.1"></eq><apply id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2.1.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2">subscript</csymbol><ci id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2.2.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2.2">𝑥</ci><ci id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2.3.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.2.3">𝑡</ci></apply><apply id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3"><times id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.1.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.1"></times><ci id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.2.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.2">𝑊</ci><apply id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3.1.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3">subscript</csymbol><ci id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3.2.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3.2">𝑞</ci><ci id="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3.3.cmml" xref="Sx3.SSx1.SSSx2.p1.7.m7.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx2.p1.7.m7.1c">x_{t}=Wq_{t}</annotation></semantics></math>.
The word embedding vectors are then sequentially fed into a GRU module to get a sequence of hidden state vectors <math id="Sx3.SSx1.SSSx2.p1.8.m8.5" class="ltx_Math" alttext="\{h_{1},h_{2},...,h_{|q|}\}" display="inline"><semantics id="Sx3.SSx1.SSSx2.p1.8.m8.5a"><mrow id="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3" xref="Sx3.SSx1.SSSx2.p1.8.m8.5.5.4.cmml"><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.4" xref="Sx3.SSx1.SSSx2.p1.8.m8.5.5.4.cmml">{</mo><msub id="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1" xref="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1.cmml"><mi id="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1.2" xref="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1.2.cmml">h</mi><mn id="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1.3" xref="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1.3.cmml">1</mn></msub><mo id="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.5" xref="Sx3.SSx1.SSSx2.p1.8.m8.5.5.4.cmml">,</mo><msub id="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2" xref="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2.cmml"><mi id="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2.2" xref="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2.2.cmml">h</mi><mn id="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2.3" xref="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2.3.cmml">2</mn></msub><mo id="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.6" xref="Sx3.SSx1.SSSx2.p1.8.m8.5.5.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx1.SSSx2.p1.8.m8.2.2" xref="Sx3.SSx1.SSSx2.p1.8.m8.2.2.cmml">…</mi><mo id="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.7" xref="Sx3.SSx1.SSSx2.p1.8.m8.5.5.4.cmml">,</mo><msub id="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.3" xref="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.3.cmml"><mi id="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.3.2" xref="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.3.2.cmml">h</mi><mrow id="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.3" xref="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.3.1" xref="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.2.1.cmml">|</mo><mi id="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.1" xref="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.1.cmml">q</mi><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.3.2" xref="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.2.1.cmml">|</mo></mrow></msub><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.8" xref="Sx3.SSx1.SSSx2.p1.8.m8.5.5.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx2.p1.8.m8.5b"><set id="Sx3.SSx1.SSSx2.p1.8.m8.5.5.4.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3"><apply id="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1">subscript</csymbol><ci id="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1.2.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1.2">ℎ</ci><cn type="integer" id="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1.3.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.3.3.1.1.3">1</cn></apply><apply id="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2.1.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2">subscript</csymbol><ci id="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2.2.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2.2">ℎ</ci><cn type="integer" id="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2.3.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.4.4.2.2.3">2</cn></apply><ci id="Sx3.SSx1.SSSx2.p1.8.m8.2.2.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.2.2">…</ci><apply id="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.3.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.3.1.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.3">subscript</csymbol><ci id="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.3.2.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.5.5.3.3.2">ℎ</ci><apply id="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.2.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.3"><abs id="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.2.1.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.3.1"></abs><ci id="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.8.m8.1.1.1.1">𝑞</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx2.p1.8.m8.5c">\{h_{1},h_{2},...,h_{|q|}\}</annotation></semantics></math>,</p>
<table id="Sx3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E2.m1.5" class="ltx_Math" alttext="h_{t}=GRU(x_{t},h_{t-1}),t\in\{1,2,...,|q|\}." display="block"><semantics id="Sx3.E2.m1.5a"><mrow id="Sx3.E2.m1.5.5.1"><mrow id="Sx3.E2.m1.5.5.1.1.2" xref="Sx3.E2.m1.5.5.1.1.3.cmml"><mrow id="Sx3.E2.m1.5.5.1.1.1.1" xref="Sx3.E2.m1.5.5.1.1.1.1.cmml"><msub id="Sx3.E2.m1.5.5.1.1.1.1.4" xref="Sx3.E2.m1.5.5.1.1.1.1.4.cmml"><mi id="Sx3.E2.m1.5.5.1.1.1.1.4.2" xref="Sx3.E2.m1.5.5.1.1.1.1.4.2.cmml">h</mi><mi id="Sx3.E2.m1.5.5.1.1.1.1.4.3" xref="Sx3.E2.m1.5.5.1.1.1.1.4.3.cmml">t</mi></msub><mo id="Sx3.E2.m1.5.5.1.1.1.1.3" xref="Sx3.E2.m1.5.5.1.1.1.1.3.cmml">=</mo><mrow id="Sx3.E2.m1.5.5.1.1.1.1.2" xref="Sx3.E2.m1.5.5.1.1.1.1.2.cmml"><mi id="Sx3.E2.m1.5.5.1.1.1.1.2.4" xref="Sx3.E2.m1.5.5.1.1.1.1.2.4.cmml">G</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.5.5.1.1.1.1.2.3" xref="Sx3.E2.m1.5.5.1.1.1.1.2.3.cmml">​</mo><mi id="Sx3.E2.m1.5.5.1.1.1.1.2.5" xref="Sx3.E2.m1.5.5.1.1.1.1.2.5.cmml">R</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.5.5.1.1.1.1.2.3a" xref="Sx3.E2.m1.5.5.1.1.1.1.2.3.cmml">​</mo><mi id="Sx3.E2.m1.5.5.1.1.1.1.2.6" xref="Sx3.E2.m1.5.5.1.1.1.1.2.6.cmml">U</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.5.5.1.1.1.1.2.3b" xref="Sx3.E2.m1.5.5.1.1.1.1.2.3.cmml">​</mo><mrow id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.3" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.3.cmml">(</mo><msub id="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1.2" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1.3" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.4" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.3.cmml">,</mo><msub id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.cmml"><mi id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.2" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.2.cmml">h</mi><mrow id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.cmml"><mi id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.2" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.2.cmml">t</mi><mo id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.1" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.1.cmml">−</mo><mn id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.3" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.5" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E2.m1.5.5.1.1.2.3" xref="Sx3.E2.m1.5.5.1.1.3a.cmml">,</mo><mrow id="Sx3.E2.m1.5.5.1.1.2.2" xref="Sx3.E2.m1.5.5.1.1.2.2.cmml"><mi id="Sx3.E2.m1.5.5.1.1.2.2.3" xref="Sx3.E2.m1.5.5.1.1.2.2.3.cmml">t</mi><mo id="Sx3.E2.m1.5.5.1.1.2.2.2" xref="Sx3.E2.m1.5.5.1.1.2.2.2.cmml">∈</mo><mrow id="Sx3.E2.m1.5.5.1.1.2.2.1.1" xref="Sx3.E2.m1.5.5.1.1.2.2.1.2.cmml"><mo stretchy="false" id="Sx3.E2.m1.5.5.1.1.2.2.1.1.2" xref="Sx3.E2.m1.5.5.1.1.2.2.1.2.cmml">{</mo><mn id="Sx3.E2.m1.1.1" xref="Sx3.E2.m1.1.1.cmml">1</mn><mo id="Sx3.E2.m1.5.5.1.1.2.2.1.1.3" xref="Sx3.E2.m1.5.5.1.1.2.2.1.2.cmml">,</mo><mn id="Sx3.E2.m1.2.2" xref="Sx3.E2.m1.2.2.cmml">2</mn><mo id="Sx3.E2.m1.5.5.1.1.2.2.1.1.4" xref="Sx3.E2.m1.5.5.1.1.2.2.1.2.cmml">,</mo><mi mathvariant="normal" id="Sx3.E2.m1.3.3" xref="Sx3.E2.m1.3.3.cmml">…</mi><mo id="Sx3.E2.m1.5.5.1.1.2.2.1.1.5" xref="Sx3.E2.m1.5.5.1.1.2.2.1.2.cmml">,</mo><mrow id="Sx3.E2.m1.5.5.1.1.2.2.1.1.1.2" xref="Sx3.E2.m1.5.5.1.1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E2.m1.5.5.1.1.2.2.1.1.1.2.1" xref="Sx3.E2.m1.5.5.1.1.2.2.1.1.1.1.1.cmml">|</mo><mi id="Sx3.E2.m1.4.4" xref="Sx3.E2.m1.4.4.cmml">q</mi><mo stretchy="false" id="Sx3.E2.m1.5.5.1.1.2.2.1.1.1.2.2" xref="Sx3.E2.m1.5.5.1.1.2.2.1.1.1.1.1.cmml">|</mo></mrow><mo stretchy="false" id="Sx3.E2.m1.5.5.1.1.2.2.1.1.6" xref="Sx3.E2.m1.5.5.1.1.2.2.1.2.cmml">}</mo></mrow></mrow></mrow><mo lspace="0em" id="Sx3.E2.m1.5.5.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E2.m1.5b"><apply id="Sx3.E2.m1.5.5.1.1.3.cmml" xref="Sx3.E2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="Sx3.E2.m1.5.5.1.1.3a.cmml" xref="Sx3.E2.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="Sx3.E2.m1.5.5.1.1.1.1.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1"><eq id="Sx3.E2.m1.5.5.1.1.1.1.3.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.3"></eq><apply id="Sx3.E2.m1.5.5.1.1.1.1.4.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx3.E2.m1.5.5.1.1.1.1.4.1.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.4">subscript</csymbol><ci id="Sx3.E2.m1.5.5.1.1.1.1.4.2.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.4.2">ℎ</ci><ci id="Sx3.E2.m1.5.5.1.1.1.1.4.3.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.4.3">𝑡</ci></apply><apply id="Sx3.E2.m1.5.5.1.1.1.1.2.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2"><times id="Sx3.E2.m1.5.5.1.1.1.1.2.3.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2.3"></times><ci id="Sx3.E2.m1.5.5.1.1.1.1.2.4.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2.4">𝐺</ci><ci id="Sx3.E2.m1.5.5.1.1.1.1.2.5.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2.5">𝑅</ci><ci id="Sx3.E2.m1.5.5.1.1.1.1.2.6.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2.6">𝑈</ci><interval closure="open" id="Sx3.E2.m1.5.5.1.1.1.1.2.2.3.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2"><apply id="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.1.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.2.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.2">ℎ</ci><apply id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3"><minus id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.1.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.1"></minus><ci id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.2.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.3.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply><apply id="Sx3.E2.m1.5.5.1.1.2.2.cmml" xref="Sx3.E2.m1.5.5.1.1.2.2"><in id="Sx3.E2.m1.5.5.1.1.2.2.2.cmml" xref="Sx3.E2.m1.5.5.1.1.2.2.2"></in><ci id="Sx3.E2.m1.5.5.1.1.2.2.3.cmml" xref="Sx3.E2.m1.5.5.1.1.2.2.3">𝑡</ci><set id="Sx3.E2.m1.5.5.1.1.2.2.1.2.cmml" xref="Sx3.E2.m1.5.5.1.1.2.2.1.1"><cn type="integer" id="Sx3.E2.m1.1.1.cmml" xref="Sx3.E2.m1.1.1">1</cn><cn type="integer" id="Sx3.E2.m1.2.2.cmml" xref="Sx3.E2.m1.2.2">2</cn><ci id="Sx3.E2.m1.3.3.cmml" xref="Sx3.E2.m1.3.3">…</ci><apply id="Sx3.E2.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="Sx3.E2.m1.5.5.1.1.2.2.1.1.1.2"><abs id="Sx3.E2.m1.5.5.1.1.2.2.1.1.1.1.1.cmml" xref="Sx3.E2.m1.5.5.1.1.2.2.1.1.1.2.1"></abs><ci id="Sx3.E2.m1.4.4.cmml" xref="Sx3.E2.m1.4.4">𝑞</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2.m1.5c">h_{t}=GRU(x_{t},h_{t-1}),t\in\{1,2,...,|q|\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx1.SSSx2.p1.11" class="ltx_p">Finally, the last hidden state vector <math id="Sx3.SSx1.SSSx2.p1.9.m1.1" class="ltx_Math" alttext="h_{|q|}" display="inline"><semantics id="Sx3.SSx1.SSSx2.p1.9.m1.1a"><msub id="Sx3.SSx1.SSSx2.p1.9.m1.1.2" xref="Sx3.SSx1.SSSx2.p1.9.m1.1.2.cmml"><mi id="Sx3.SSx1.SSSx2.p1.9.m1.1.2.2" xref="Sx3.SSx1.SSSx2.p1.9.m1.1.2.2.cmml">h</mi><mrow id="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.3" xref="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.3.1" xref="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.2.1.cmml">|</mo><mi id="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.1" xref="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.1.cmml">q</mi><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.3.2" xref="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.2.1.cmml">|</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx2.p1.9.m1.1b"><apply id="Sx3.SSx1.SSSx2.p1.9.m1.1.2.cmml" xref="Sx3.SSx1.SSSx2.p1.9.m1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx2.p1.9.m1.1.2.1.cmml" xref="Sx3.SSx1.SSSx2.p1.9.m1.1.2">subscript</csymbol><ci id="Sx3.SSx1.SSSx2.p1.9.m1.1.2.2.cmml" xref="Sx3.SSx1.SSSx2.p1.9.m1.1.2.2">ℎ</ci><apply id="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.2.cmml" xref="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.3"><abs id="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.2.1.cmml" xref="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.3.1"></abs><ci id="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.9.m1.1.1.1.1">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx2.p1.9.m1.1c">h_{|q|}</annotation></semantics></math> of the GRU is taken as the representation of the question,
<em id="Sx3.SSx1.SSSx2.p1.11.1" class="ltx_emph ltx_font_italic">i.e.,</em> <math id="Sx3.SSx1.SSSx2.p1.10.m2.1" class="ltx_Math" alttext="Q=h_{|q|}\in\mathbbm{R}^{n}" display="inline"><semantics id="Sx3.SSx1.SSSx2.p1.10.m2.1a"><mrow id="Sx3.SSx1.SSSx2.p1.10.m2.1.2" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.cmml"><mi id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.2" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.2.cmml">Q</mi><mo id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.3" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.3.cmml">=</mo><msub id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.4" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.4.cmml"><mi id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.4.2" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.4.2.cmml">h</mi><mrow id="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.3" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.3.1" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.2.1.cmml">|</mo><mi id="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.1" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.1.cmml">q</mi><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.3.2" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.5" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.5.cmml">∈</mo><msup id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6.cmml"><mi id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6.2" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6.2.cmml">ℝ</mi><mi id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6.3" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx2.p1.10.m2.1b"><apply id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2"><and id="Sx3.SSx1.SSSx2.p1.10.m2.1.2a.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2"></and><apply id="Sx3.SSx1.SSSx2.p1.10.m2.1.2b.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2"><eq id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.3.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.3"></eq><ci id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.2.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.2">𝑄</ci><apply id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.4.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.4"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.4.1.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.4">subscript</csymbol><ci id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.4.2.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.4.2">ℎ</ci><apply id="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.2.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.3"><abs id="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.2.1.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.3.1"></abs><ci id="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.1.1.1">𝑞</ci></apply></apply></apply><apply id="Sx3.SSx1.SSSx2.p1.10.m2.1.2c.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2"><in id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.5.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.5"></in><share href="#Sx3.SSx1.SSSx2.p1.10.m2.1.2.4.cmml" id="Sx3.SSx1.SSSx2.p1.10.m2.1.2d.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2"></share><apply id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6.1.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6">superscript</csymbol><ci id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6.2.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6.2">ℝ</ci><ci id="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6.3.cmml" xref="Sx3.SSx1.SSSx2.p1.10.m2.1.2.6.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx2.p1.10.m2.1c">Q=h_{|q|}\in\mathbbm{R}^{n}</annotation></semantics></math>, where <math id="Sx3.SSx1.SSSx2.p1.11.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="Sx3.SSx1.SSSx2.p1.11.m3.1a"><mi id="Sx3.SSx1.SSSx2.p1.11.m3.1.1" xref="Sx3.SSx1.SSSx2.p1.11.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx2.p1.11.m3.1b"><ci id="Sx3.SSx1.SSSx2.p1.11.m3.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.11.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx2.p1.11.m3.1c">n</annotation></semantics></math> is the size of the GRU.
Note that the word embedding matrix and the GRU are trained end-to-end.</p>
</div>
</section>
</section>
<section id="Sx3.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Human Attention Network</h3>

<div id="Sx3.SSx2.p1" class="ltx_para">
<p id="Sx3.SSx2.p1.1" class="ltx_p">Given an image-question pair <math id="Sx3.SSx2.p1.1.m1.2" class="ltx_Math" alttext="(I,q)" display="inline"><semantics id="Sx3.SSx2.p1.1.m1.2a"><mrow id="Sx3.SSx2.p1.1.m1.2.3.2" xref="Sx3.SSx2.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.1.m1.2.3.2.1" xref="Sx3.SSx2.p1.1.m1.2.3.1.cmml">(</mo><mi id="Sx3.SSx2.p1.1.m1.1.1" xref="Sx3.SSx2.p1.1.m1.1.1.cmml">I</mi><mo id="Sx3.SSx2.p1.1.m1.2.3.2.2" xref="Sx3.SSx2.p1.1.m1.2.3.1.cmml">,</mo><mi id="Sx3.SSx2.p1.1.m1.2.2" xref="Sx3.SSx2.p1.1.m1.2.2.cmml">q</mi><mo stretchy="false" id="Sx3.SSx2.p1.1.m1.2.3.2.3" xref="Sx3.SSx2.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.1.m1.2b"><interval closure="open" id="Sx3.SSx2.p1.1.m1.2.3.1.cmml" xref="Sx3.SSx2.p1.1.m1.2.3.2"><ci id="Sx3.SSx2.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.p1.1.m1.1.1">𝐼</ci><ci id="Sx3.SSx2.p1.1.m1.2.2.cmml" xref="Sx3.SSx2.p1.1.m1.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.1.m1.2c">(I,q)</annotation></semantics></math>, our proposed Human Attention Network (HAN) is designed to predict the attention map.</p>
</div>
<div id="Sx3.SSx2.p2" class="ltx_para">
<p id="Sx3.SSx2.p2.1" class="ltx_p">The structure of the HAN is shown in Fig.<a href="#Sx2.F2" title="Figure 2 ‣ Related Work ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. It consists of two modules, namely the attention generation module and the attention refinement module. The attention generation module is able to generate several coarse attention maps.
The attention refinement module aims to refine the coarse attention maps in order to obtain a more precise attention map.</p>
</div>
<section id="Sx3.SSx2.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Attention generation</h4>

<div id="Sx3.SSx2.SSSx1.p1" class="ltx_para">
<p id="Sx3.SSx2.SSSx1.p1.6" class="ltx_p"> The attention mechanism used is motivated by (<span id="Sx3.SSx2.SSSx1.p1.6.1" class="ltx_text ltx_font_bold">?</span>),
which first fuses the image and the question by a low-rank bilinear pooling and then uses a convolutional layer to generate multiple attention maps over the image.
Specifically, the feature matrix <math id="Sx3.SSx2.SSSx1.p1.2.m2.1" class="ltx_Math" alttext="F" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.2.m2.1a"><mi id="Sx3.SSx2.SSSx1.p1.2.m2.1.1" xref="Sx3.SSx2.SSSx1.p1.2.m2.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.2.m2.1b"><ci id="Sx3.SSx2.SSSx1.p1.2.m2.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.2.m2.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.2.m2.1c">F</annotation></semantics></math> of an image <math id="Sx3.SSx2.SSSx1.p1.3.m3.1" class="ltx_Math" alttext="I" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.3.m3.1a"><mi id="Sx3.SSx2.SSSx1.p1.3.m3.1.1" xref="Sx3.SSx2.SSSx1.p1.3.m3.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.3.m3.1b"><ci id="Sx3.SSx2.SSSx1.p1.3.m3.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.3.m3.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.3.m3.1c">I</annotation></semantics></math> and the feature vector <math id="Sx3.SSx2.SSSx1.p1.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.4.m4.1a"><mi id="Sx3.SSx2.SSSx1.p1.4.m4.1.1" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.4.m4.1b"><ci id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.4.m4.1c">Q</annotation></semantics></math> of the question <math id="Sx3.SSx2.SSSx1.p1.5.m5.1" class="ltx_Math" alttext="q" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.5.m5.1a"><mi id="Sx3.SSx2.SSSx1.p1.5.m5.1.1" xref="Sx3.SSx2.SSSx1.p1.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.5.m5.1b"><ci id="Sx3.SSx2.SSSx1.p1.5.m5.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.5.m5.1c">q</annotation></semantics></math> are first projected into a <math id="Sx3.SSx2.SSSx1.p1.6.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.6.m6.1a"><mi id="Sx3.SSx2.SSSx1.p1.6.m6.1.1" xref="Sx3.SSx2.SSSx1.p1.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.6.m6.1b"><ci id="Sx3.SSx2.SSSx1.p1.6.m6.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.6.m6.1c">d</annotation></semantics></math>-dimensional embedding space.
Then, they are fused by element-wise multiplication.
The fused feature matrix of the image and the question is given by</p>
<table id="Sx3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E3.m1.1" class="ltx_Math" alttext="X=\sigma(UQ\cdot\mathbbm{1}^{T})\circ\sigma(VF)," display="block"><semantics id="Sx3.E3.m1.1a"><mrow id="Sx3.E3.m1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.cmml"><mrow id="Sx3.E3.m1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.cmml"><mi id="Sx3.E3.m1.1.1.1.1.4" xref="Sx3.E3.m1.1.1.1.1.4.cmml">X</mi><mo id="Sx3.E3.m1.1.1.1.1.3" xref="Sx3.E3.m1.1.1.1.1.3.cmml">=</mo><mrow id="Sx3.E3.m1.1.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.2.cmml"><mrow id="Sx3.E3.m1.1.1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E3.m1.1.1.1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E3.m1.1.1.1.1.1.1.1.3" xref="Sx3.E3.m1.1.1.1.1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.1.1.1.1.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">U</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.1" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">Q</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">⋅</mo><msup id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝟙</mn><mi id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">T</mi></msup></mrow><mo rspace="0.055em" stretchy="false" id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="Sx3.E3.m1.1.1.1.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.1.1.2.cmml">∘</mo><mi id="Sx3.E3.m1.1.1.1.1.1.1.3" xref="Sx3.E3.m1.1.1.1.1.1.1.3.cmml">σ</mi></mrow><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.1.1.1.1.2.3" xref="Sx3.E3.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="Sx3.E3.m1.1.1.1.1.2.2.1" xref="Sx3.E3.m1.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="Sx3.E3.m1.1.1.1.1.2.2.1.2" xref="Sx3.E3.m1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="Sx3.E3.m1.1.1.1.1.2.2.1.1" xref="Sx3.E3.m1.1.1.1.1.2.2.1.1.cmml"><mi id="Sx3.E3.m1.1.1.1.1.2.2.1.1.2" xref="Sx3.E3.m1.1.1.1.1.2.2.1.1.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.1.1.1.1.2.2.1.1.1" xref="Sx3.E3.m1.1.1.1.1.2.2.1.1.1.cmml">​</mo><mi id="Sx3.E3.m1.1.1.1.1.2.2.1.1.3" xref="Sx3.E3.m1.1.1.1.1.2.2.1.1.3.cmml">F</mi></mrow><mo stretchy="false" id="Sx3.E3.m1.1.1.1.1.2.2.1.3" xref="Sx3.E3.m1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E3.m1.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E3.m1.1b"><apply id="Sx3.E3.m1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1"><eq id="Sx3.E3.m1.1.1.1.1.3.cmml" xref="Sx3.E3.m1.1.1.1.1.3"></eq><ci id="Sx3.E3.m1.1.1.1.1.4.cmml" xref="Sx3.E3.m1.1.1.1.1.4">𝑋</ci><apply id="Sx3.E3.m1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.1.1.1.1.2"><times id="Sx3.E3.m1.1.1.1.1.2.3.cmml" xref="Sx3.E3.m1.1.1.1.1.2.3"></times><apply id="Sx3.E3.m1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1"><compose id="Sx3.E3.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.2"></compose><apply id="Sx3.E3.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1"><times id="Sx3.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.2"></times><ci id="Sx3.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.3">𝜎</ci><apply id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1"><ci id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.1">⋅</ci><apply id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2"><times id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.1"></times><ci id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑈</ci><ci id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑄</ci></apply><apply id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><cn type="integer" id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply><ci id="Sx3.E3.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.3">𝜎</ci></apply><apply id="Sx3.E3.m1.1.1.1.1.2.2.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.2.2.1"><times id="Sx3.E3.m1.1.1.1.1.2.2.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.2.2.1.1.1"></times><ci id="Sx3.E3.m1.1.1.1.1.2.2.1.1.2.cmml" xref="Sx3.E3.m1.1.1.1.1.2.2.1.1.2">𝑉</ci><ci id="Sx3.E3.m1.1.1.1.1.2.2.1.1.3.cmml" xref="Sx3.E3.m1.1.1.1.1.2.2.1.1.3">𝐹</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E3.m1.1c">X=\sigma(UQ\cdot\mathbbm{1}^{T})\circ\sigma(VF),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx2.SSSx1.p1.11" class="ltx_p">where <math id="Sx3.SSx2.SSSx1.p1.7.m1.1" class="ltx_Math" alttext="\mathbbm{1}\in\mathbbm{R}^{l^{2}}" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.7.m1.1a"><mrow id="Sx3.SSx2.SSSx1.p1.7.m1.1.1" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.cmml"><mn id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.2" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.2.cmml">𝟙</mn><mo id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.1" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.1.cmml">∈</mo><msup id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.2" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.2.cmml">ℝ</mi><msup id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3.cmml"><mi id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3.2" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3.2.cmml">l</mi><mn id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3.3" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3.3.cmml">2</mn></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.7.m1.1b"><apply id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1"><in id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.1"></in><cn type="integer" id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.2.cmml" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.2">1</cn><apply id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.cmml" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.2">ℝ</ci><apply id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3.2.cmml" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3.2">𝑙</ci><cn type="integer" id="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.7.m1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.7.m1.1c">\mathbbm{1}\in\mathbbm{R}^{l^{2}}</annotation></semantics></math> denotes a column vector of ones, <math id="Sx3.SSx2.SSSx1.p1.8.m2.1" class="ltx_Math" alttext="U\in\mathbbm{R}^{d\times n}" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.8.m2.1a"><mrow id="Sx3.SSx2.SSSx1.p1.8.m2.1.1" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.cmml"><mi id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.2" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.2.cmml">U</mi><mo id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.1" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.1.cmml">∈</mo><msup id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.2" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.cmml"><mi id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.2" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.1" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.3" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.8.m2.1b"><apply id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1"><in id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.1"></in><ci id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.2.cmml" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.2">𝑈</ci><apply id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.cmml" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.2">ℝ</ci><apply id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3"><times id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.1"></times><ci id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.2.cmml" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.2">𝑑</ci><ci id="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.8.m2.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.8.m2.1c">U\in\mathbbm{R}^{d\times n}</annotation></semantics></math> and <math id="Sx3.SSx2.SSSx1.p1.9.m3.1" class="ltx_Math" alttext="V\in\mathbbm{R}^{d\times m}" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.9.m3.1a"><mrow id="Sx3.SSx2.SSSx1.p1.9.m3.1.1" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.cmml"><mi id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.2" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.2.cmml">V</mi><mo id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.1" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.1.cmml">∈</mo><msup id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.2" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.cmml"><mi id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.2" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.1" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.3" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.9.m3.1b"><apply id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1"><in id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.1"></in><ci id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.2.cmml" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.2">𝑉</ci><apply id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.cmml" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.2">ℝ</ci><apply id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3"><times id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.1"></times><ci id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.2.cmml" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.2">𝑑</ci><ci id="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.9.m3.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.9.m3.1c">V\in\mathbbm{R}^{d\times m}</annotation></semantics></math> are respectively trainable affine matrices for the question and for the image.
The symbol <math id="Sx3.SSx2.SSSx1.p1.10.m4.1" class="ltx_Math" alttext="\circ" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.10.m4.1a"><mo id="Sx3.SSx2.SSSx1.p1.10.m4.1.1" xref="Sx3.SSx2.SSSx1.p1.10.m4.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.10.m4.1b"><compose id="Sx3.SSx2.SSSx1.p1.10.m4.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.10.m4.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.10.m4.1c">\circ</annotation></semantics></math> denotes the element-wise multiplication, while <math id="Sx3.SSx2.SSSx1.p1.11.m5.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.11.m5.1a"><mrow id="Sx3.SSx2.SSSx1.p1.11.m5.1.2" xref="Sx3.SSx2.SSSx1.p1.11.m5.1.2.cmml"><mi id="Sx3.SSx2.SSSx1.p1.11.m5.1.2.2" xref="Sx3.SSx2.SSSx1.p1.11.m5.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx1.p1.11.m5.1.2.1" xref="Sx3.SSx2.SSSx1.p1.11.m5.1.2.1.cmml">​</mo><mrow id="Sx3.SSx2.SSSx1.p1.11.m5.1.2.3.2" xref="Sx3.SSx2.SSSx1.p1.11.m5.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx1.p1.11.m5.1.2.3.2.1" xref="Sx3.SSx2.SSSx1.p1.11.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx1.p1.11.m5.1.1" xref="Sx3.SSx2.SSSx1.p1.11.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="Sx3.SSx2.SSSx1.p1.11.m5.1.2.3.2.2" xref="Sx3.SSx2.SSSx1.p1.11.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.11.m5.1b"><apply id="Sx3.SSx2.SSSx1.p1.11.m5.1.2.cmml" xref="Sx3.SSx2.SSSx1.p1.11.m5.1.2"><times id="Sx3.SSx2.SSSx1.p1.11.m5.1.2.1.cmml" xref="Sx3.SSx2.SSSx1.p1.11.m5.1.2.1"></times><ci id="Sx3.SSx2.SSSx1.p1.11.m5.1.2.2.cmml" xref="Sx3.SSx2.SSSx1.p1.11.m5.1.2.2">𝜎</ci><ci id="Sx3.SSx2.SSSx1.p1.11.m5.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.11.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.11.m5.1c">\sigma(\cdot)</annotation></semantics></math> is the hyperbolic tangent function.
Note that the bias terms in the low-rank bilinear pooling are omitted for simplicity.</p>
</div>
<div id="Sx3.SSx2.SSSx1.p2" class="ltx_para">
<p id="Sx3.SSx2.SSSx1.p2.1" class="ltx_p">Subsequently, a convolutional layer is applied to the fused feature <math id="Sx3.SSx2.SSSx1.p2.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="Sx3.SSx2.SSSx1.p2.1.m1.1a"><mi id="Sx3.SSx2.SSSx1.p2.1.m1.1.1" xref="Sx3.SSx2.SSSx1.p2.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p2.1.m1.1b"><ci id="Sx3.SSx2.SSSx1.p2.1.m1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p2.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p2.1.m1.1c">X</annotation></semantics></math> to generate a sequence of attention maps which is expressed as</p>
<table id="Sx3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E4.m1.3" class="ltx_Math" alttext="\alpha_{1},\alpha_{2},...,\alpha_{G}=C_{con}(X)," display="block"><semantics id="Sx3.E4.m1.3a"><mrow id="Sx3.E4.m1.3.3.1" xref="Sx3.E4.m1.3.3.1.1.cmml"><mrow id="Sx3.E4.m1.3.3.1.1" xref="Sx3.E4.m1.3.3.1.1.cmml"><mrow id="Sx3.E4.m1.3.3.1.1.3.3" xref="Sx3.E4.m1.3.3.1.1.3.4.cmml"><msub id="Sx3.E4.m1.3.3.1.1.1.1.1" xref="Sx3.E4.m1.3.3.1.1.1.1.1.cmml"><mi id="Sx3.E4.m1.3.3.1.1.1.1.1.2" xref="Sx3.E4.m1.3.3.1.1.1.1.1.2.cmml">α</mi><mn id="Sx3.E4.m1.3.3.1.1.1.1.1.3" xref="Sx3.E4.m1.3.3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.E4.m1.3.3.1.1.3.3.4" xref="Sx3.E4.m1.3.3.1.1.3.4.cmml">,</mo><msub id="Sx3.E4.m1.3.3.1.1.2.2.2" xref="Sx3.E4.m1.3.3.1.1.2.2.2.cmml"><mi id="Sx3.E4.m1.3.3.1.1.2.2.2.2" xref="Sx3.E4.m1.3.3.1.1.2.2.2.2.cmml">α</mi><mn id="Sx3.E4.m1.3.3.1.1.2.2.2.3" xref="Sx3.E4.m1.3.3.1.1.2.2.2.3.cmml">2</mn></msub><mo id="Sx3.E4.m1.3.3.1.1.3.3.5" xref="Sx3.E4.m1.3.3.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.E4.m1.2.2" xref="Sx3.E4.m1.2.2.cmml">…</mi><mo id="Sx3.E4.m1.3.3.1.1.3.3.6" xref="Sx3.E4.m1.3.3.1.1.3.4.cmml">,</mo><msub id="Sx3.E4.m1.3.3.1.1.3.3.3" xref="Sx3.E4.m1.3.3.1.1.3.3.3.cmml"><mi id="Sx3.E4.m1.3.3.1.1.3.3.3.2" xref="Sx3.E4.m1.3.3.1.1.3.3.3.2.cmml">α</mi><mi id="Sx3.E4.m1.3.3.1.1.3.3.3.3" xref="Sx3.E4.m1.3.3.1.1.3.3.3.3.cmml">G</mi></msub></mrow><mo id="Sx3.E4.m1.3.3.1.1.4" xref="Sx3.E4.m1.3.3.1.1.4.cmml">=</mo><mrow id="Sx3.E4.m1.3.3.1.1.5" xref="Sx3.E4.m1.3.3.1.1.5.cmml"><msub id="Sx3.E4.m1.3.3.1.1.5.2" xref="Sx3.E4.m1.3.3.1.1.5.2.cmml"><mi id="Sx3.E4.m1.3.3.1.1.5.2.2" xref="Sx3.E4.m1.3.3.1.1.5.2.2.cmml">C</mi><mrow id="Sx3.E4.m1.3.3.1.1.5.2.3" xref="Sx3.E4.m1.3.3.1.1.5.2.3.cmml"><mi id="Sx3.E4.m1.3.3.1.1.5.2.3.2" xref="Sx3.E4.m1.3.3.1.1.5.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.3.3.1.1.5.2.3.1" xref="Sx3.E4.m1.3.3.1.1.5.2.3.1.cmml">​</mo><mi id="Sx3.E4.m1.3.3.1.1.5.2.3.3" xref="Sx3.E4.m1.3.3.1.1.5.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.3.3.1.1.5.2.3.1a" xref="Sx3.E4.m1.3.3.1.1.5.2.3.1.cmml">​</mo><mi id="Sx3.E4.m1.3.3.1.1.5.2.3.4" xref="Sx3.E4.m1.3.3.1.1.5.2.3.4.cmml">n</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.3.3.1.1.5.1" xref="Sx3.E4.m1.3.3.1.1.5.1.cmml">​</mo><mrow id="Sx3.E4.m1.3.3.1.1.5.3.2" xref="Sx3.E4.m1.3.3.1.1.5.cmml"><mo stretchy="false" id="Sx3.E4.m1.3.3.1.1.5.3.2.1" xref="Sx3.E4.m1.3.3.1.1.5.cmml">(</mo><mi id="Sx3.E4.m1.1.1" xref="Sx3.E4.m1.1.1.cmml">X</mi><mo stretchy="false" id="Sx3.E4.m1.3.3.1.1.5.3.2.2" xref="Sx3.E4.m1.3.3.1.1.5.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E4.m1.3.3.1.2" xref="Sx3.E4.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E4.m1.3b"><apply id="Sx3.E4.m1.3.3.1.1.cmml" xref="Sx3.E4.m1.3.3.1"><eq id="Sx3.E4.m1.3.3.1.1.4.cmml" xref="Sx3.E4.m1.3.3.1.1.4"></eq><list id="Sx3.E4.m1.3.3.1.1.3.4.cmml" xref="Sx3.E4.m1.3.3.1.1.3.3"><apply id="Sx3.E4.m1.3.3.1.1.1.1.1.cmml" xref="Sx3.E4.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E4.m1.3.3.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.3.3.1.1.1.1.1.2">𝛼</ci><cn type="integer" id="Sx3.E4.m1.3.3.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.3.3.1.1.1.1.1.3">1</cn></apply><apply id="Sx3.E4.m1.3.3.1.1.2.2.2.cmml" xref="Sx3.E4.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.E4.m1.3.3.1.1.2.2.2.1.cmml" xref="Sx3.E4.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="Sx3.E4.m1.3.3.1.1.2.2.2.2.cmml" xref="Sx3.E4.m1.3.3.1.1.2.2.2.2">𝛼</ci><cn type="integer" id="Sx3.E4.m1.3.3.1.1.2.2.2.3.cmml" xref="Sx3.E4.m1.3.3.1.1.2.2.2.3">2</cn></apply><ci id="Sx3.E4.m1.2.2.cmml" xref="Sx3.E4.m1.2.2">…</ci><apply id="Sx3.E4.m1.3.3.1.1.3.3.3.cmml" xref="Sx3.E4.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.E4.m1.3.3.1.1.3.3.3.1.cmml" xref="Sx3.E4.m1.3.3.1.1.3.3.3">subscript</csymbol><ci id="Sx3.E4.m1.3.3.1.1.3.3.3.2.cmml" xref="Sx3.E4.m1.3.3.1.1.3.3.3.2">𝛼</ci><ci id="Sx3.E4.m1.3.3.1.1.3.3.3.3.cmml" xref="Sx3.E4.m1.3.3.1.1.3.3.3.3">𝐺</ci></apply></list><apply id="Sx3.E4.m1.3.3.1.1.5.cmml" xref="Sx3.E4.m1.3.3.1.1.5"><times id="Sx3.E4.m1.3.3.1.1.5.1.cmml" xref="Sx3.E4.m1.3.3.1.1.5.1"></times><apply id="Sx3.E4.m1.3.3.1.1.5.2.cmml" xref="Sx3.E4.m1.3.3.1.1.5.2"><csymbol cd="ambiguous" id="Sx3.E4.m1.3.3.1.1.5.2.1.cmml" xref="Sx3.E4.m1.3.3.1.1.5.2">subscript</csymbol><ci id="Sx3.E4.m1.3.3.1.1.5.2.2.cmml" xref="Sx3.E4.m1.3.3.1.1.5.2.2">𝐶</ci><apply id="Sx3.E4.m1.3.3.1.1.5.2.3.cmml" xref="Sx3.E4.m1.3.3.1.1.5.2.3"><times id="Sx3.E4.m1.3.3.1.1.5.2.3.1.cmml" xref="Sx3.E4.m1.3.3.1.1.5.2.3.1"></times><ci id="Sx3.E4.m1.3.3.1.1.5.2.3.2.cmml" xref="Sx3.E4.m1.3.3.1.1.5.2.3.2">𝑐</ci><ci id="Sx3.E4.m1.3.3.1.1.5.2.3.3.cmml" xref="Sx3.E4.m1.3.3.1.1.5.2.3.3">𝑜</ci><ci id="Sx3.E4.m1.3.3.1.1.5.2.3.4.cmml" xref="Sx3.E4.m1.3.3.1.1.5.2.3.4">𝑛</ci></apply></apply><ci id="Sx3.E4.m1.1.1.cmml" xref="Sx3.E4.m1.1.1">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E4.m1.3c">\alpha_{1},\alpha_{2},...,\alpha_{G}=C_{con}(X),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx2.SSSx1.p2.3" class="ltx_p">where <math id="Sx3.SSx2.SSSx1.p2.2.m1.1" class="ltx_Math" alttext="C_{con}(\cdot)" display="inline"><semantics id="Sx3.SSx2.SSSx1.p2.2.m1.1a"><mrow id="Sx3.SSx2.SSSx1.p2.2.m1.1.2" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.cmml"><msub id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.cmml"><mi id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.2" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.2.cmml">C</mi><mrow id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.cmml"><mi id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.2" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.1" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.3" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.1a" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.4" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.4.cmml">n</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.1" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.1.cmml">​</mo><mrow id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.3.2" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.3.2.1" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx1.p2.2.m1.1.1" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.3.2.2" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p2.2.m1.1b"><apply id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.cmml" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2"><times id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.1.cmml" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.1"></times><apply id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.cmml" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.1.cmml" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2">subscript</csymbol><ci id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.2.cmml" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.2">𝐶</ci><apply id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.cmml" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3"><times id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.1.cmml" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.1"></times><ci id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.2.cmml" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.2">𝑐</ci><ci id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.3.cmml" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.3">𝑜</ci><ci id="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.4.cmml" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.2.2.3.4">𝑛</ci></apply></apply><ci id="Sx3.SSx2.SSSx1.p2.2.m1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p2.2.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p2.2.m1.1c">C_{con}(\cdot)</annotation></semantics></math> denotes the 1-D convolution operation with <math id="Sx3.SSx2.SSSx1.p2.3.m2.1" class="ltx_Math" alttext="G" display="inline"><semantics id="Sx3.SSx2.SSSx1.p2.3.m2.1a"><mi id="Sx3.SSx2.SSSx1.p2.3.m2.1.1" xref="Sx3.SSx2.SSSx1.p2.3.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p2.3.m2.1b"><ci id="Sx3.SSx2.SSSx1.p2.3.m2.1.1.cmml" xref="Sx3.SSx2.SSSx1.p2.3.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p2.3.m2.1c">G</annotation></semantics></math> convolutional kernels of size 1.
In this way, multiple attention maps, also known as multiple glimpses in (<span id="Sx3.SSx2.SSSx1.p2.3.1" class="ltx_text ltx_font_bold">?</span>; <span id="Sx3.SSx2.SSSx1.p2.3.2" class="ltx_text ltx_font_bold">?</span>), are generated.</p>
</div>
</section>
<section id="Sx3.SSx2.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Attention refinement</h4>

<div id="Sx3.SSx2.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx2.SSSx2.p1.6" class="ltx_p"> The multiple attention maps generated by the attention generation module are coarse,
however, they contain lots of information.
In this section,
the multiple attention maps are fused by means of a GRU, as it has the ability of neglecting irrelevant information and keeping the important information.
Specifically, the sequence of attention maps <math id="Sx3.SSx2.SSSx2.p1.2.m2.4" class="ltx_Math" alttext="\alpha=\{\alpha_{1},\alpha_{2},...,\alpha_{G}\}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.2.m2.4a"><mrow id="Sx3.SSx2.SSSx2.p1.2.m2.4.4" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.cmml"><mi id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.5" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.5.cmml">α</mi><mo id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.4" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.4.cmml">=</mo><mrow id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.4.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.4" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1" xref="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1.cmml"><mi id="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1.2" xref="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1.2.cmml">α</mi><mn id="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1.3" xref="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.5" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2" xref="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2.cmml"><mi id="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2.2" xref="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2.2.cmml">α</mi><mn id="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2.3" xref="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.6" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx2.SSSx2.p1.2.m2.1.1" xref="Sx3.SSx2.SSSx2.p1.2.m2.1.1.cmml">…</mi><mo id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.7" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3.2" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3.2.cmml">α</mi><mi id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3.3" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3.3.cmml">G</mi></msub><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.8" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.2.m2.4b"><apply id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4"><eq id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.4.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.4"></eq><ci id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.5.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.5">𝛼</ci><set id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3"><apply id="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1.2">𝛼</ci><cn type="integer" id="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2.2">𝛼</ci><cn type="integer" id="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="Sx3.SSx2.SSSx2.p1.2.m2.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.1.1">…</ci><apply id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3.2">𝛼</ci><ci id="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.4.4.3.3.3.3">𝐺</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.2.m2.4c">\alpha=\{\alpha_{1},\alpha_{2},...,\alpha_{G}\}</annotation></semantics></math> that is generated by the attention generation module is fed into the GRU sequentially.
The last hidden state vector of the GRU is taken as the attention vector <math id="Sx3.SSx2.SSSx2.p1.3.m3.1" class="ltx_Math" alttext="h_{GRU}(\alpha)\in\mathbbm{R}^{p}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.3.m3.1a"><mrow id="Sx3.SSx2.SSSx2.p1.3.m3.1.2" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.cmml"><mrow id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.cmml"><msub id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.cmml"><mi id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.2" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.2.cmml">h</mi><mrow id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.2" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.1" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.3" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.1a" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.4" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.4.cmml">U</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.1" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.1.cmml">​</mo><mrow id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.3.2" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.3.2.1" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.cmml">(</mo><mi id="Sx3.SSx2.SSSx2.p1.3.m3.1.1" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.1.cmml">α</mi><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.3.2.2" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.1" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.1.cmml">∈</mo><msup id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3.2" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3.2.cmml">ℝ</mi><mi id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3.3" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3.3.cmml">p</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.3.m3.1b"><apply id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2"><in id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.1"></in><apply id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2"><times id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.1"></times><apply id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2">subscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.2">ℎ</ci><apply id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3"><times id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.1"></times><ci id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.2">𝐺</ci><ci id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.3">𝑅</ci><ci id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.2.2.3.4">𝑈</ci></apply></apply><ci id="Sx3.SSx2.SSSx2.p1.3.m3.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.1">𝛼</ci></apply><apply id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3.2">ℝ</ci><ci id="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.2.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.3.m3.1c">h_{GRU}(\alpha)\in\mathbbm{R}^{p}</annotation></semantics></math>, where <math id="Sx3.SSx2.SSSx2.p1.4.m4.1" class="ltx_Math" alttext="p" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.4.m4.1a"><mi id="Sx3.SSx2.SSSx2.p1.4.m4.1.1" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.4.m4.1b"><ci id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.4.m4.1c">p</annotation></semantics></math> is the
size of the GRU.
The vector <math id="Sx3.SSx2.SSSx2.p1.5.m5.1" class="ltx_Math" alttext="h_{GRU}(\alpha)" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.5.m5.1a"><mrow id="Sx3.SSx2.SSSx2.p1.5.m5.1.2" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.cmml"><msub id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.cmml"><mi id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.2" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.2.cmml">h</mi><mrow id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.2" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.1" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.3" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.1a" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.4" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.4.cmml">U</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.1" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.1.cmml">​</mo><mrow id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.3.2" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.3.2.1" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.cmml">(</mo><mi id="Sx3.SSx2.SSSx2.p1.5.m5.1.1" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.cmml">α</mi><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.3.2.2" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.5.m5.1b"><apply id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2"><times id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.1"></times><apply id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2">subscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.2">ℎ</ci><apply id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3"><times id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.1"></times><ci id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.2">𝐺</ci><ci id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.3">𝑅</ci><ci id="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.2.2.3.4">𝑈</ci></apply></apply><ci id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.5.m5.1c">h_{GRU}(\alpha)</annotation></semantics></math> is then driven through a fully connected layer followed by a softmax layer.
More formally, the predicted refined attention map for the given image-question pair <math id="Sx3.SSx2.SSSx2.p1.6.m6.2" class="ltx_Math" alttext="(I,q)" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.6.m6.2a"><mrow id="Sx3.SSx2.SSSx2.p1.6.m6.2.3.2" xref="Sx3.SSx2.SSSx2.p1.6.m6.2.3.1.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.6.m6.2.3.2.1" xref="Sx3.SSx2.SSSx2.p1.6.m6.2.3.1.cmml">(</mo><mi id="Sx3.SSx2.SSSx2.p1.6.m6.1.1" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.cmml">I</mi><mo id="Sx3.SSx2.SSSx2.p1.6.m6.2.3.2.2" xref="Sx3.SSx2.SSSx2.p1.6.m6.2.3.1.cmml">,</mo><mi id="Sx3.SSx2.SSSx2.p1.6.m6.2.2" xref="Sx3.SSx2.SSSx2.p1.6.m6.2.2.cmml">q</mi><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.6.m6.2.3.2.3" xref="Sx3.SSx2.SSSx2.p1.6.m6.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.6.m6.2b"><interval closure="open" id="Sx3.SSx2.SSSx2.p1.6.m6.2.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.2.3.2"><ci id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1">𝐼</ci><ci id="Sx3.SSx2.SSSx2.p1.6.m6.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.6.m6.2c">(I,q)</annotation></semantics></math> is calculated as</p>
<table id="Sx3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E5.m1.4" class="ltx_Math" alttext="\alpha_{h}^{\prime}(I,q)=softmax(W\cdot h_{GRU}(\alpha)+b)," display="block"><semantics id="Sx3.E5.m1.4a"><mrow id="Sx3.E5.m1.4.4.1" xref="Sx3.E5.m1.4.4.1.1.cmml"><mrow id="Sx3.E5.m1.4.4.1.1" xref="Sx3.E5.m1.4.4.1.1.cmml"><mrow id="Sx3.E5.m1.4.4.1.1.3" xref="Sx3.E5.m1.4.4.1.1.3.cmml"><msubsup id="Sx3.E5.m1.4.4.1.1.3.2" xref="Sx3.E5.m1.4.4.1.1.3.2.cmml"><mi id="Sx3.E5.m1.4.4.1.1.3.2.2.2" xref="Sx3.E5.m1.4.4.1.1.3.2.2.2.cmml">α</mi><mi id="Sx3.E5.m1.4.4.1.1.3.2.2.3" xref="Sx3.E5.m1.4.4.1.1.3.2.2.3.cmml">h</mi><mo id="Sx3.E5.m1.4.4.1.1.3.2.3" xref="Sx3.E5.m1.4.4.1.1.3.2.3.cmml">′</mo></msubsup><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.4.4.1.1.3.1" xref="Sx3.E5.m1.4.4.1.1.3.1.cmml">​</mo><mrow id="Sx3.E5.m1.4.4.1.1.3.3.2" xref="Sx3.E5.m1.4.4.1.1.3.3.1.cmml"><mo stretchy="false" id="Sx3.E5.m1.4.4.1.1.3.3.2.1" xref="Sx3.E5.m1.4.4.1.1.3.3.1.cmml">(</mo><mi id="Sx3.E5.m1.1.1" xref="Sx3.E5.m1.1.1.cmml">I</mi><mo id="Sx3.E5.m1.4.4.1.1.3.3.2.2" xref="Sx3.E5.m1.4.4.1.1.3.3.1.cmml">,</mo><mi id="Sx3.E5.m1.2.2" xref="Sx3.E5.m1.2.2.cmml">q</mi><mo stretchy="false" id="Sx3.E5.m1.4.4.1.1.3.3.2.3" xref="Sx3.E5.m1.4.4.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E5.m1.4.4.1.1.2" xref="Sx3.E5.m1.4.4.1.1.2.cmml">=</mo><mrow id="Sx3.E5.m1.4.4.1.1.1" xref="Sx3.E5.m1.4.4.1.1.1.cmml"><mi id="Sx3.E5.m1.4.4.1.1.1.3" xref="Sx3.E5.m1.4.4.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.4.4.1.1.1.2" xref="Sx3.E5.m1.4.4.1.1.1.2.cmml">​</mo><mi id="Sx3.E5.m1.4.4.1.1.1.4" xref="Sx3.E5.m1.4.4.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.4.4.1.1.1.2a" xref="Sx3.E5.m1.4.4.1.1.1.2.cmml">​</mo><mi id="Sx3.E5.m1.4.4.1.1.1.5" xref="Sx3.E5.m1.4.4.1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.4.4.1.1.1.2b" xref="Sx3.E5.m1.4.4.1.1.1.2.cmml">​</mo><mi id="Sx3.E5.m1.4.4.1.1.1.6" xref="Sx3.E5.m1.4.4.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.4.4.1.1.1.2c" xref="Sx3.E5.m1.4.4.1.1.1.2.cmml">​</mo><mi id="Sx3.E5.m1.4.4.1.1.1.7" xref="Sx3.E5.m1.4.4.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.4.4.1.1.1.2d" xref="Sx3.E5.m1.4.4.1.1.1.2.cmml">​</mo><mi id="Sx3.E5.m1.4.4.1.1.1.8" xref="Sx3.E5.m1.4.4.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.4.4.1.1.1.2e" xref="Sx3.E5.m1.4.4.1.1.1.2.cmml">​</mo><mi id="Sx3.E5.m1.4.4.1.1.1.9" xref="Sx3.E5.m1.4.4.1.1.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.4.4.1.1.1.2f" xref="Sx3.E5.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="Sx3.E5.m1.4.4.1.1.1.1.1" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E5.m1.4.4.1.1.1.1.1.2" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E5.m1.4.4.1.1.1.1.1.1" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.cmml"><mrow id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.cmml"><mi id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.2" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.1" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.1.cmml">⋅</mo><msub id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.cmml"><mi id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.2" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.2.cmml">h</mi><mrow id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.cmml"><mi id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.2" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.1" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.1.cmml">​</mo><mi id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.3" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.1a" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.1.cmml">​</mo><mi id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.4" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.4.cmml">U</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.1" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.3.2" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.3.2.1" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.cmml">(</mo><mi id="Sx3.E5.m1.3.3" xref="Sx3.E5.m1.3.3.cmml">α</mi><mo stretchy="false" id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.3.2.2" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx3.E5.m1.4.4.1.1.1.1.1.1.1" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.1.cmml">+</mo><mi id="Sx3.E5.m1.4.4.1.1.1.1.1.1.3" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo stretchy="false" id="Sx3.E5.m1.4.4.1.1.1.1.1.3" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E5.m1.4.4.1.2" xref="Sx3.E5.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E5.m1.4b"><apply id="Sx3.E5.m1.4.4.1.1.cmml" xref="Sx3.E5.m1.4.4.1"><eq id="Sx3.E5.m1.4.4.1.1.2.cmml" xref="Sx3.E5.m1.4.4.1.1.2"></eq><apply id="Sx3.E5.m1.4.4.1.1.3.cmml" xref="Sx3.E5.m1.4.4.1.1.3"><times id="Sx3.E5.m1.4.4.1.1.3.1.cmml" xref="Sx3.E5.m1.4.4.1.1.3.1"></times><apply id="Sx3.E5.m1.4.4.1.1.3.2.cmml" xref="Sx3.E5.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="Sx3.E5.m1.4.4.1.1.3.2.1.cmml" xref="Sx3.E5.m1.4.4.1.1.3.2">superscript</csymbol><apply id="Sx3.E5.m1.4.4.1.1.3.2.2.cmml" xref="Sx3.E5.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="Sx3.E5.m1.4.4.1.1.3.2.2.1.cmml" xref="Sx3.E5.m1.4.4.1.1.3.2">subscript</csymbol><ci id="Sx3.E5.m1.4.4.1.1.3.2.2.2.cmml" xref="Sx3.E5.m1.4.4.1.1.3.2.2.2">𝛼</ci><ci id="Sx3.E5.m1.4.4.1.1.3.2.2.3.cmml" xref="Sx3.E5.m1.4.4.1.1.3.2.2.3">ℎ</ci></apply><ci id="Sx3.E5.m1.4.4.1.1.3.2.3.cmml" xref="Sx3.E5.m1.4.4.1.1.3.2.3">′</ci></apply><interval closure="open" id="Sx3.E5.m1.4.4.1.1.3.3.1.cmml" xref="Sx3.E5.m1.4.4.1.1.3.3.2"><ci id="Sx3.E5.m1.1.1.cmml" xref="Sx3.E5.m1.1.1">𝐼</ci><ci id="Sx3.E5.m1.2.2.cmml" xref="Sx3.E5.m1.2.2">𝑞</ci></interval></apply><apply id="Sx3.E5.m1.4.4.1.1.1.cmml" xref="Sx3.E5.m1.4.4.1.1.1"><times id="Sx3.E5.m1.4.4.1.1.1.2.cmml" xref="Sx3.E5.m1.4.4.1.1.1.2"></times><ci id="Sx3.E5.m1.4.4.1.1.1.3.cmml" xref="Sx3.E5.m1.4.4.1.1.1.3">𝑠</ci><ci id="Sx3.E5.m1.4.4.1.1.1.4.cmml" xref="Sx3.E5.m1.4.4.1.1.1.4">𝑜</ci><ci id="Sx3.E5.m1.4.4.1.1.1.5.cmml" xref="Sx3.E5.m1.4.4.1.1.1.5">𝑓</ci><ci id="Sx3.E5.m1.4.4.1.1.1.6.cmml" xref="Sx3.E5.m1.4.4.1.1.1.6">𝑡</ci><ci id="Sx3.E5.m1.4.4.1.1.1.7.cmml" xref="Sx3.E5.m1.4.4.1.1.1.7">𝑚</ci><ci id="Sx3.E5.m1.4.4.1.1.1.8.cmml" xref="Sx3.E5.m1.4.4.1.1.1.8">𝑎</ci><ci id="Sx3.E5.m1.4.4.1.1.1.9.cmml" xref="Sx3.E5.m1.4.4.1.1.1.9">𝑥</ci><apply id="Sx3.E5.m1.4.4.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1"><plus id="Sx3.E5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.1"></plus><apply id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2"><times id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.1"></times><apply id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2"><ci id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.1">⋅</ci><ci id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.2">𝑊</ci><apply id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.1.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.2.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.2">ℎ</ci><apply id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3"><times id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.1"></times><ci id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.2.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.2">𝐺</ci><ci id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.3">𝑅</ci><ci id="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.4.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.3.4">𝑈</ci></apply></apply></apply><ci id="Sx3.E5.m1.3.3.cmml" xref="Sx3.E5.m1.3.3">𝛼</ci></apply><ci id="Sx3.E5.m1.4.4.1.1.1.1.1.1.3.cmml" xref="Sx3.E5.m1.4.4.1.1.1.1.1.1.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E5.m1.4c">\alpha_{h}^{\prime}(I,q)=softmax(W\cdot h_{GRU}(\alpha)+b),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx2.SSSx2.p1.9" class="ltx_p">where <math id="Sx3.SSx2.SSSx2.p1.7.m1.1" class="ltx_Math" alttext="W\in\mathbbm{R}^{l^{2}\times p}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.7.m1.1a"><mrow id="Sx3.SSx2.SSSx2.p1.7.m1.1.1" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.cmml"><mi id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.2" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.2.cmml">W</mi><mo id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.1" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.1.cmml">∈</mo><msup id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.2" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.cmml"><msup id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2.cmml"><mi id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2.2" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2.2.cmml">l</mi><mn id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2.3" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2.3.cmml">2</mn></msup><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.1" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.3" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.3.cmml">p</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.7.m1.1b"><apply id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1"><in id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.1"></in><ci id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.2">𝑊</ci><apply id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.2">ℝ</ci><apply id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3"><times id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.1"></times><apply id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2.2">𝑙</ci><cn type="integer" id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.2.3">2</cn></apply><ci id="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m1.1.1.3.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.7.m1.1c">W\in\mathbbm{R}^{l^{2}\times p}</annotation></semantics></math> is an affine transformation matrix, <math id="Sx3.SSx2.SSSx2.p1.8.m2.1" class="ltx_Math" alttext="softmax(\cdot)" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.8.m2.1a"><mrow id="Sx3.SSx2.SSSx2.p1.8.m2.1.2" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.cmml"><mi id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.2" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.3" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1a" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.4" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1b" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.5" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1c" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.6" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1d" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.7" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1e" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.8" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.8.cmml">x</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1f" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1.cmml">​</mo><mrow id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.9.2" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.9.2.1" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.8.m2.1.1" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.9.2.2" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.8.m2.1b"><apply id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2"><times id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.1"></times><ci id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.2">𝑠</ci><ci id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.3">𝑜</ci><ci id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.4.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.4">𝑓</ci><ci id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.5.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.5">𝑡</ci><ci id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.6.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.6">𝑚</ci><ci id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.7.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.7">𝑎</ci><ci id="Sx3.SSx2.SSSx2.p1.8.m2.1.2.8.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.2.8">𝑥</ci><ci id="Sx3.SSx2.SSSx2.p1.8.m2.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.8.m2.1c">softmax(\cdot)</annotation></semantics></math> indicates the softmax function
and <math id="Sx3.SSx2.SSSx2.p1.9.m3.1" class="ltx_Math" alttext="b\in\mathbbm{R}^{l^{2}}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.9.m3.1a"><mrow id="Sx3.SSx2.SSSx2.p1.9.m3.1.1" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.cmml"><mi id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.2" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.2.cmml">b</mi><mo id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.1" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.1.cmml">∈</mo><msup id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.2" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.2.cmml">ℝ</mi><msup id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3.2" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3.2.cmml">l</mi><mn id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3.3" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3.3.cmml">2</mn></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.9.m3.1b"><apply id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1"><in id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.1"></in><ci id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.2">𝑏</ci><apply id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.2">ℝ</ci><apply id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3.2">𝑙</ci><cn type="integer" id="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m3.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.9.m3.1c">b\in\mathbbm{R}^{l^{2}}</annotation></semantics></math> is the bias term.</p>
</div>
</section>
<section id="Sx3.SSx2.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Objective function</h4>

<div id="Sx3.SSx2.SSSx3.p1" class="ltx_para">
<p id="Sx3.SSx2.SSSx3.p1.4" class="ltx_p"> The proposed HAN is trained on the VQA-HAT dataset, which contains triplets of <math id="Sx3.SSx2.SSSx3.p1.2.m2.3" class="ltx_Math" alttext="(I,q,\alpha_{h})" display="inline"><semantics id="Sx3.SSx2.SSSx3.p1.2.m2.3a"><mrow id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.2.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.2" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.2.cmml">(</mo><mi id="Sx3.SSx2.SSSx3.p1.2.m2.1.1" xref="Sx3.SSx2.SSSx3.p1.2.m2.1.1.cmml">I</mi><mo id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.3" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.2.cmml">,</mo><mi id="Sx3.SSx2.SSSx3.p1.2.m2.2.2" xref="Sx3.SSx2.SSSx3.p1.2.m2.2.2.cmml">q</mi><mo id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.4" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.2.cmml">,</mo><msub id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1.cmml"><mi id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1.2" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1.2.cmml">α</mi><mi id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1.3" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1.3.cmml">h</mi></msub><mo stretchy="false" id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.5" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx3.p1.2.m2.3b"><vector id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.2.cmml" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1"><ci id="Sx3.SSx2.SSSx3.p1.2.m2.1.1.cmml" xref="Sx3.SSx2.SSSx3.p1.2.m2.1.1">𝐼</ci><ci id="Sx3.SSx2.SSSx3.p1.2.m2.2.2.cmml" xref="Sx3.SSx2.SSSx3.p1.2.m2.2.2">𝑞</ci><apply id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1.cmml" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1.1.cmml" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1">subscript</csymbol><ci id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1.2.cmml" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1.2">𝛼</ci><ci id="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1.3.cmml" xref="Sx3.SSx2.SSSx3.p1.2.m2.3.3.1.1.3">ℎ</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx3.p1.2.m2.3c">(I,q,\alpha_{h})</annotation></semantics></math>,
where <math id="Sx3.SSx2.SSSx3.p1.3.m3.1" class="ltx_Math" alttext="\alpha_{h}" display="inline"><semantics id="Sx3.SSx2.SSSx3.p1.3.m3.1a"><msub id="Sx3.SSx2.SSSx3.p1.3.m3.1.1" xref="Sx3.SSx2.SSSx3.p1.3.m3.1.1.cmml"><mi id="Sx3.SSx2.SSSx3.p1.3.m3.1.1.2" xref="Sx3.SSx2.SSSx3.p1.3.m3.1.1.2.cmml">α</mi><mi id="Sx3.SSx2.SSSx3.p1.3.m3.1.1.3" xref="Sx3.SSx2.SSSx3.p1.3.m3.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx3.p1.3.m3.1b"><apply id="Sx3.SSx2.SSSx3.p1.3.m3.1.1.cmml" xref="Sx3.SSx2.SSSx3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx3.p1.3.m3.1.1.1.cmml" xref="Sx3.SSx2.SSSx3.p1.3.m3.1.1">subscript</csymbol><ci id="Sx3.SSx2.SSSx3.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx2.SSSx3.p1.3.m3.1.1.2">𝛼</ci><ci id="Sx3.SSx2.SSSx3.p1.3.m3.1.1.3.cmml" xref="Sx3.SSx2.SSSx3.p1.3.m3.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx3.p1.3.m3.1c">\alpha_{h}</annotation></semantics></math> is the human attention for the given image-question pair <math id="Sx3.SSx2.SSSx3.p1.4.m4.2" class="ltx_Math" alttext="(I,q)" display="inline"><semantics id="Sx3.SSx2.SSSx3.p1.4.m4.2a"><mrow id="Sx3.SSx2.SSSx3.p1.4.m4.2.3.2" xref="Sx3.SSx2.SSSx3.p1.4.m4.2.3.1.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx3.p1.4.m4.2.3.2.1" xref="Sx3.SSx2.SSSx3.p1.4.m4.2.3.1.cmml">(</mo><mi id="Sx3.SSx2.SSSx3.p1.4.m4.1.1" xref="Sx3.SSx2.SSSx3.p1.4.m4.1.1.cmml">I</mi><mo id="Sx3.SSx2.SSSx3.p1.4.m4.2.3.2.2" xref="Sx3.SSx2.SSSx3.p1.4.m4.2.3.1.cmml">,</mo><mi id="Sx3.SSx2.SSSx3.p1.4.m4.2.2" xref="Sx3.SSx2.SSSx3.p1.4.m4.2.2.cmml">q</mi><mo stretchy="false" id="Sx3.SSx2.SSSx3.p1.4.m4.2.3.2.3" xref="Sx3.SSx2.SSSx3.p1.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx3.p1.4.m4.2b"><interval closure="open" id="Sx3.SSx2.SSSx3.p1.4.m4.2.3.1.cmml" xref="Sx3.SSx2.SSSx3.p1.4.m4.2.3.2"><ci id="Sx3.SSx2.SSSx3.p1.4.m4.1.1.cmml" xref="Sx3.SSx2.SSSx3.p1.4.m4.1.1">𝐼</ci><ci id="Sx3.SSx2.SSSx3.p1.4.m4.2.2.cmml" xref="Sx3.SSx2.SSSx3.p1.4.m4.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx3.p1.4.m4.2c">(I,q)</annotation></semantics></math>.</p>
</div>
<div id="Sx3.SSx2.SSSx3.p2" class="ltx_para">
<p id="Sx3.SSx2.SSSx3.p2.1" class="ltx_p">In order to make the model-generated attention map get close to the human attention map,
the Mean Squared Error (MSE) is used as the objective function.
The MSE loss <math id="Sx3.SSx2.SSSx3.p2.1.m1.1" class="ltx_Math" alttext="L_{mse}" display="inline"><semantics id="Sx3.SSx2.SSSx3.p2.1.m1.1a"><msub id="Sx3.SSx2.SSSx3.p2.1.m1.1.1" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.cmml"><mi id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.2" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.2.cmml">L</mi><mrow id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.2" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.1" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.3" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.1a" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.4" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.4.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx3.p2.1.m1.1b"><apply id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.cmml" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.1.cmml" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.2.cmml" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.2">𝐿</ci><apply id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.cmml" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3"><times id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.1"></times><ci id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.2">𝑚</ci><ci id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.3">𝑠</ci><ci id="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.4.cmml" xref="Sx3.SSx2.SSSx3.p2.1.m1.1.1.3.4">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx3.p2.1.m1.1c">L_{mse}</annotation></semantics></math> for a given training triplet is defined as</p>
<table id="Sx3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E6.m1.6" class="ltx_Math" alttext="L_{mse}(I,q,a_{h};\theta)=(\alpha_{h}^{\prime}(I,q)-\alpha_{h})^{2}," display="block"><semantics id="Sx3.E6.m1.6a"><mrow id="Sx3.E6.m1.6.6.1" xref="Sx3.E6.m1.6.6.1.1.cmml"><mrow id="Sx3.E6.m1.6.6.1.1" xref="Sx3.E6.m1.6.6.1.1.cmml"><mrow id="Sx3.E6.m1.6.6.1.1.1" xref="Sx3.E6.m1.6.6.1.1.1.cmml"><msub id="Sx3.E6.m1.6.6.1.1.1.3" xref="Sx3.E6.m1.6.6.1.1.1.3.cmml"><mi id="Sx3.E6.m1.6.6.1.1.1.3.2" xref="Sx3.E6.m1.6.6.1.1.1.3.2.cmml">L</mi><mrow id="Sx3.E6.m1.6.6.1.1.1.3.3" xref="Sx3.E6.m1.6.6.1.1.1.3.3.cmml"><mi id="Sx3.E6.m1.6.6.1.1.1.3.3.2" xref="Sx3.E6.m1.6.6.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.6.6.1.1.1.3.3.1" xref="Sx3.E6.m1.6.6.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E6.m1.6.6.1.1.1.3.3.3" xref="Sx3.E6.m1.6.6.1.1.1.3.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.6.6.1.1.1.3.3.1a" xref="Sx3.E6.m1.6.6.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E6.m1.6.6.1.1.1.3.3.4" xref="Sx3.E6.m1.6.6.1.1.1.3.3.4.cmml">e</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.6.6.1.1.1.2" xref="Sx3.E6.m1.6.6.1.1.1.2.cmml">​</mo><mrow id="Sx3.E6.m1.6.6.1.1.1.1.1" xref="Sx3.E6.m1.6.6.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E6.m1.6.6.1.1.1.1.1.2" xref="Sx3.E6.m1.6.6.1.1.1.1.2.cmml">(</mo><mi id="Sx3.E6.m1.1.1" xref="Sx3.E6.m1.1.1.cmml">I</mi><mo id="Sx3.E6.m1.6.6.1.1.1.1.1.3" xref="Sx3.E6.m1.6.6.1.1.1.1.2.cmml">,</mo><mi id="Sx3.E6.m1.2.2" xref="Sx3.E6.m1.2.2.cmml">q</mi><mo id="Sx3.E6.m1.6.6.1.1.1.1.1.4" xref="Sx3.E6.m1.6.6.1.1.1.1.2.cmml">,</mo><msub id="Sx3.E6.m1.6.6.1.1.1.1.1.1" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.cmml"><mi id="Sx3.E6.m1.6.6.1.1.1.1.1.1.2" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.2.cmml">a</mi><mi id="Sx3.E6.m1.6.6.1.1.1.1.1.1.3" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.3.cmml">h</mi></msub><mo id="Sx3.E6.m1.6.6.1.1.1.1.1.5" xref="Sx3.E6.m1.6.6.1.1.1.1.2.cmml">;</mo><mi id="Sx3.E6.m1.3.3" xref="Sx3.E6.m1.3.3.cmml">θ</mi><mo stretchy="false" id="Sx3.E6.m1.6.6.1.1.1.1.1.6" xref="Sx3.E6.m1.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx3.E6.m1.6.6.1.1.3" xref="Sx3.E6.m1.6.6.1.1.3.cmml">=</mo><msup id="Sx3.E6.m1.6.6.1.1.2" xref="Sx3.E6.m1.6.6.1.1.2.cmml"><mrow id="Sx3.E6.m1.6.6.1.1.2.1.1" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.E6.m1.6.6.1.1.2.1.1.2" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.cmml">(</mo><mrow id="Sx3.E6.m1.6.6.1.1.2.1.1.1" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.cmml"><mrow id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.cmml"><msubsup id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.cmml"><mi id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.2.2" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.2.2.cmml">α</mi><mi id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.2.3" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.2.3.cmml">h</mi><mo id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.3" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.3.cmml">′</mo></msubsup><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.1" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.1.cmml">​</mo><mrow id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.3.2" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.3.1.cmml"><mo stretchy="false" id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.3.2.1" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.3.1.cmml">(</mo><mi id="Sx3.E6.m1.4.4" xref="Sx3.E6.m1.4.4.cmml">I</mi><mo id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.3.2.2" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.3.1.cmml">,</mo><mi id="Sx3.E6.m1.5.5" xref="Sx3.E6.m1.5.5.cmml">q</mi><mo stretchy="false" id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.3.2.3" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E6.m1.6.6.1.1.2.1.1.1.1" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.1.cmml">−</mo><msub id="Sx3.E6.m1.6.6.1.1.2.1.1.1.3" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.3.cmml"><mi id="Sx3.E6.m1.6.6.1.1.2.1.1.1.3.2" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.3.2.cmml">α</mi><mi id="Sx3.E6.m1.6.6.1.1.2.1.1.1.3.3" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.3.3.cmml">h</mi></msub></mrow><mo stretchy="false" id="Sx3.E6.m1.6.6.1.1.2.1.1.3" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.cmml">)</mo></mrow><mn id="Sx3.E6.m1.6.6.1.1.2.3" xref="Sx3.E6.m1.6.6.1.1.2.3.cmml">2</mn></msup></mrow><mo id="Sx3.E6.m1.6.6.1.2" xref="Sx3.E6.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E6.m1.6b"><apply id="Sx3.E6.m1.6.6.1.1.cmml" xref="Sx3.E6.m1.6.6.1"><eq id="Sx3.E6.m1.6.6.1.1.3.cmml" xref="Sx3.E6.m1.6.6.1.1.3"></eq><apply id="Sx3.E6.m1.6.6.1.1.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1"><times id="Sx3.E6.m1.6.6.1.1.1.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.2"></times><apply id="Sx3.E6.m1.6.6.1.1.1.3.cmml" xref="Sx3.E6.m1.6.6.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.6.6.1.1.1.3.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1.3">subscript</csymbol><ci id="Sx3.E6.m1.6.6.1.1.1.3.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.3.2">𝐿</ci><apply id="Sx3.E6.m1.6.6.1.1.1.3.3.cmml" xref="Sx3.E6.m1.6.6.1.1.1.3.3"><times id="Sx3.E6.m1.6.6.1.1.1.3.3.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1.3.3.1"></times><ci id="Sx3.E6.m1.6.6.1.1.1.3.3.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.3.3.2">𝑚</ci><ci id="Sx3.E6.m1.6.6.1.1.1.3.3.3.cmml" xref="Sx3.E6.m1.6.6.1.1.1.3.3.3">𝑠</ci><ci id="Sx3.E6.m1.6.6.1.1.1.3.3.4.cmml" xref="Sx3.E6.m1.6.6.1.1.1.3.3.4">𝑒</ci></apply></apply><vector id="Sx3.E6.m1.6.6.1.1.1.1.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1"><ci id="Sx3.E6.m1.1.1.cmml" xref="Sx3.E6.m1.1.1">𝐼</ci><ci id="Sx3.E6.m1.2.2.cmml" xref="Sx3.E6.m1.2.2">𝑞</ci><apply id="Sx3.E6.m1.6.6.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E6.m1.6.6.1.1.1.1.1.1.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.2">𝑎</ci><ci id="Sx3.E6.m1.6.6.1.1.1.1.1.1.3.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.3">ℎ</ci></apply><ci id="Sx3.E6.m1.3.3.cmml" xref="Sx3.E6.m1.3.3">𝜃</ci></vector></apply><apply id="Sx3.E6.m1.6.6.1.1.2.cmml" xref="Sx3.E6.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.6.6.1.1.2.2.cmml" xref="Sx3.E6.m1.6.6.1.1.2">superscript</csymbol><apply id="Sx3.E6.m1.6.6.1.1.2.1.1.1.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1"><minus id="Sx3.E6.m1.6.6.1.1.2.1.1.1.1.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.1"></minus><apply id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2"><times id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.1.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.1"></times><apply id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.1.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2">superscript</csymbol><apply id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.2.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.2.1.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2">subscript</csymbol><ci id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.2.2.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.2.2">𝛼</ci><ci id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.2.3.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.2.3">ℎ</ci></apply><ci id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.3.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.2.3">′</ci></apply><interval closure="open" id="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.3.1.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.2.3.2"><ci id="Sx3.E6.m1.4.4.cmml" xref="Sx3.E6.m1.4.4">𝐼</ci><ci id="Sx3.E6.m1.5.5.cmml" xref="Sx3.E6.m1.5.5">𝑞</ci></interval></apply><apply id="Sx3.E6.m1.6.6.1.1.2.1.1.1.3.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.6.6.1.1.2.1.1.1.3.1.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.3">subscript</csymbol><ci id="Sx3.E6.m1.6.6.1.1.2.1.1.1.3.2.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.3.2">𝛼</ci><ci id="Sx3.E6.m1.6.6.1.1.2.1.1.1.3.3.cmml" xref="Sx3.E6.m1.6.6.1.1.2.1.1.1.3.3">ℎ</ci></apply></apply><cn type="integer" id="Sx3.E6.m1.6.6.1.1.2.3.cmml" xref="Sx3.E6.m1.6.6.1.1.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E6.m1.6c">L_{mse}(I,q,a_{h};\theta)=(\alpha_{h}^{\prime}(I,q)-\alpha_{h})^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx2.SSSx3.p2.3" class="ltx_p">where <math id="Sx3.SSx2.SSSx3.p2.2.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="Sx3.SSx2.SSSx3.p2.2.m1.1a"><mi id="Sx3.SSx2.SSSx3.p2.2.m1.1.1" xref="Sx3.SSx2.SSSx3.p2.2.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx3.p2.2.m1.1b"><ci id="Sx3.SSx2.SSSx3.p2.2.m1.1.1.cmml" xref="Sx3.SSx2.SSSx3.p2.2.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx3.p2.2.m1.1c">\theta</annotation></semantics></math> represents all trainable parameters used in the HAN.
The HAN is trained by minimizing the overall MSE loss on a given training set <math id="Sx3.SSx2.SSSx3.p2.3.m2.3" class="ltx_Math" alttext="\mathcal{D}=\{(I,q,\alpha_{h})\}" display="inline"><semantics id="Sx3.SSx2.SSSx3.p2.3.m2.3a"><mrow id="Sx3.SSx2.SSSx3.p2.3.m2.3.3" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.3" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.3.cmml">𝒟</mi><mo id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.2" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.2.cmml">=</mo><mrow id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.2" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.2.cmml">{</mo><mrow id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.2" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.2.cmml">(</mo><mi id="Sx3.SSx2.SSSx3.p2.3.m2.1.1" xref="Sx3.SSx2.SSSx3.p2.3.m2.1.1.cmml">I</mi><mo id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.3" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.2.cmml">,</mo><mi id="Sx3.SSx2.SSSx3.p2.3.m2.2.2" xref="Sx3.SSx2.SSSx3.p2.3.m2.2.2.cmml">q</mi><mo id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.4" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.2.cmml">,</mo><msub id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1.cmml"><mi id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1.2" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1.2.cmml">α</mi><mi id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1.3" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1.3.cmml">h</mi></msub><mo stretchy="false" id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.5" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.2.cmml">)</mo></mrow><mo stretchy="false" id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.3" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx3.p2.3.m2.3b"><apply id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.cmml" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3"><eq id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.2.cmml" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.2"></eq><ci id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.3.cmml" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.3">𝒟</ci><set id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.2.cmml" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1"><vector id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.2.cmml" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1"><ci id="Sx3.SSx2.SSSx3.p2.3.m2.1.1.cmml" xref="Sx3.SSx2.SSSx3.p2.3.m2.1.1">𝐼</ci><ci id="Sx3.SSx2.SSSx3.p2.3.m2.2.2.cmml" xref="Sx3.SSx2.SSSx3.p2.3.m2.2.2">𝑞</ci><apply id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1.2">𝛼</ci><ci id="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.SSSx3.p2.3.m2.3.3.1.1.1.1.1.3">ℎ</ci></apply></vector></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx3.p2.3.m2.3c">\mathcal{D}=\{(I,q,\alpha_{h})\}</annotation></semantics></math>.</p>
<table id="Sx3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E7.m1.7" class="ltx_Math" alttext="\underset{\theta}{\mathrm{argmin}}\sum_{(I,q,a_{h})\in\mathcal{D}}L_{mse}(I,q,\alpha_{h};\theta)." display="block"><semantics id="Sx3.E7.m1.7a"><mrow id="Sx3.E7.m1.7.7.1" xref="Sx3.E7.m1.7.7.1.1.cmml"><mrow id="Sx3.E7.m1.7.7.1.1" xref="Sx3.E7.m1.7.7.1.1.cmml"><munder accentunder="true" id="Sx3.E7.m1.7.7.1.1.3" xref="Sx3.E7.m1.7.7.1.1.3.cmml"><mi id="Sx3.E7.m1.7.7.1.1.3.2" xref="Sx3.E7.m1.7.7.1.1.3.2.cmml">argmin</mi><mo id="Sx3.E7.m1.7.7.1.1.3.1" xref="Sx3.E7.m1.7.7.1.1.3.1.cmml">𝜃</mo></munder><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.7.7.1.1.2" xref="Sx3.E7.m1.7.7.1.1.2.cmml">​</mo><mrow id="Sx3.E7.m1.7.7.1.1.1" xref="Sx3.E7.m1.7.7.1.1.1.cmml"><munder id="Sx3.E7.m1.7.7.1.1.1.2" xref="Sx3.E7.m1.7.7.1.1.1.2.cmml"><mo movablelimits="false" id="Sx3.E7.m1.7.7.1.1.1.2.2" xref="Sx3.E7.m1.7.7.1.1.1.2.2.cmml">∑</mo><mrow id="Sx3.E7.m1.3.3.3" xref="Sx3.E7.m1.3.3.3.cmml"><mrow id="Sx3.E7.m1.3.3.3.3.1" xref="Sx3.E7.m1.3.3.3.3.2.cmml"><mo stretchy="false" id="Sx3.E7.m1.3.3.3.3.1.2" xref="Sx3.E7.m1.3.3.3.3.2.cmml">(</mo><mi id="Sx3.E7.m1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.cmml">I</mi><mo id="Sx3.E7.m1.3.3.3.3.1.3" xref="Sx3.E7.m1.3.3.3.3.2.cmml">,</mo><mi id="Sx3.E7.m1.2.2.2.2" xref="Sx3.E7.m1.2.2.2.2.cmml">q</mi><mo id="Sx3.E7.m1.3.3.3.3.1.4" xref="Sx3.E7.m1.3.3.3.3.2.cmml">,</mo><msub id="Sx3.E7.m1.3.3.3.3.1.1" xref="Sx3.E7.m1.3.3.3.3.1.1.cmml"><mi id="Sx3.E7.m1.3.3.3.3.1.1.2" xref="Sx3.E7.m1.3.3.3.3.1.1.2.cmml">a</mi><mi id="Sx3.E7.m1.3.3.3.3.1.1.3" xref="Sx3.E7.m1.3.3.3.3.1.1.3.cmml">h</mi></msub><mo stretchy="false" id="Sx3.E7.m1.3.3.3.3.1.5" xref="Sx3.E7.m1.3.3.3.3.2.cmml">)</mo></mrow><mo id="Sx3.E7.m1.3.3.3.4" xref="Sx3.E7.m1.3.3.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.E7.m1.3.3.3.5" xref="Sx3.E7.m1.3.3.3.5.cmml">𝒟</mi></mrow></munder><mrow id="Sx3.E7.m1.7.7.1.1.1.1" xref="Sx3.E7.m1.7.7.1.1.1.1.cmml"><msub id="Sx3.E7.m1.7.7.1.1.1.1.3" xref="Sx3.E7.m1.7.7.1.1.1.1.3.cmml"><mi id="Sx3.E7.m1.7.7.1.1.1.1.3.2" xref="Sx3.E7.m1.7.7.1.1.1.1.3.2.cmml">L</mi><mrow id="Sx3.E7.m1.7.7.1.1.1.1.3.3" xref="Sx3.E7.m1.7.7.1.1.1.1.3.3.cmml"><mi id="Sx3.E7.m1.7.7.1.1.1.1.3.3.2" xref="Sx3.E7.m1.7.7.1.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.7.7.1.1.1.1.3.3.1" xref="Sx3.E7.m1.7.7.1.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E7.m1.7.7.1.1.1.1.3.3.3" xref="Sx3.E7.m1.7.7.1.1.1.1.3.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.7.7.1.1.1.1.3.3.1a" xref="Sx3.E7.m1.7.7.1.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E7.m1.7.7.1.1.1.1.3.3.4" xref="Sx3.E7.m1.7.7.1.1.1.1.3.3.4.cmml">e</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.7.7.1.1.1.1.2" xref="Sx3.E7.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E7.m1.7.7.1.1.1.1.1.1" xref="Sx3.E7.m1.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E7.m1.7.7.1.1.1.1.1.1.2" xref="Sx3.E7.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mi id="Sx3.E7.m1.4.4" xref="Sx3.E7.m1.4.4.cmml">I</mi><mo id="Sx3.E7.m1.7.7.1.1.1.1.1.1.3" xref="Sx3.E7.m1.7.7.1.1.1.1.1.2.cmml">,</mo><mi id="Sx3.E7.m1.5.5" xref="Sx3.E7.m1.5.5.cmml">q</mi><mo id="Sx3.E7.m1.7.7.1.1.1.1.1.1.4" xref="Sx3.E7.m1.7.7.1.1.1.1.1.2.cmml">,</mo><msub id="Sx3.E7.m1.7.7.1.1.1.1.1.1.1" xref="Sx3.E7.m1.7.7.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E7.m1.7.7.1.1.1.1.1.1.1.2" xref="Sx3.E7.m1.7.7.1.1.1.1.1.1.1.2.cmml">α</mi><mi id="Sx3.E7.m1.7.7.1.1.1.1.1.1.1.3" xref="Sx3.E7.m1.7.7.1.1.1.1.1.1.1.3.cmml">h</mi></msub><mo id="Sx3.E7.m1.7.7.1.1.1.1.1.1.5" xref="Sx3.E7.m1.7.7.1.1.1.1.1.2.cmml">;</mo><mi id="Sx3.E7.m1.6.6" xref="Sx3.E7.m1.6.6.cmml">θ</mi><mo stretchy="false" id="Sx3.E7.m1.7.7.1.1.1.1.1.1.6" xref="Sx3.E7.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="Sx3.E7.m1.7.7.1.2" xref="Sx3.E7.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E7.m1.7b"><apply id="Sx3.E7.m1.7.7.1.1.cmml" xref="Sx3.E7.m1.7.7.1"><times id="Sx3.E7.m1.7.7.1.1.2.cmml" xref="Sx3.E7.m1.7.7.1.1.2"></times><apply id="Sx3.E7.m1.7.7.1.1.3.cmml" xref="Sx3.E7.m1.7.7.1.1.3"><ci id="Sx3.E7.m1.7.7.1.1.3.1.cmml" xref="Sx3.E7.m1.7.7.1.1.3.1">𝜃</ci><ci id="Sx3.E7.m1.7.7.1.1.3.2.cmml" xref="Sx3.E7.m1.7.7.1.1.3.2">argmin</ci></apply><apply id="Sx3.E7.m1.7.7.1.1.1.cmml" xref="Sx3.E7.m1.7.7.1.1.1"><apply id="Sx3.E7.m1.7.7.1.1.1.2.cmml" xref="Sx3.E7.m1.7.7.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E7.m1.7.7.1.1.1.2.1.cmml" xref="Sx3.E7.m1.7.7.1.1.1.2">subscript</csymbol><sum id="Sx3.E7.m1.7.7.1.1.1.2.2.cmml" xref="Sx3.E7.m1.7.7.1.1.1.2.2"></sum><apply id="Sx3.E7.m1.3.3.3.cmml" xref="Sx3.E7.m1.3.3.3"><in id="Sx3.E7.m1.3.3.3.4.cmml" xref="Sx3.E7.m1.3.3.3.4"></in><vector id="Sx3.E7.m1.3.3.3.3.2.cmml" xref="Sx3.E7.m1.3.3.3.3.1"><ci id="Sx3.E7.m1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1">𝐼</ci><ci id="Sx3.E7.m1.2.2.2.2.cmml" xref="Sx3.E7.m1.2.2.2.2">𝑞</ci><apply id="Sx3.E7.m1.3.3.3.3.1.1.cmml" xref="Sx3.E7.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="Sx3.E7.m1.3.3.3.3.1.1.1.cmml" xref="Sx3.E7.m1.3.3.3.3.1.1">subscript</csymbol><ci id="Sx3.E7.m1.3.3.3.3.1.1.2.cmml" xref="Sx3.E7.m1.3.3.3.3.1.1.2">𝑎</ci><ci id="Sx3.E7.m1.3.3.3.3.1.1.3.cmml" xref="Sx3.E7.m1.3.3.3.3.1.1.3">ℎ</ci></apply></vector><ci id="Sx3.E7.m1.3.3.3.5.cmml" xref="Sx3.E7.m1.3.3.3.5">𝒟</ci></apply></apply><apply id="Sx3.E7.m1.7.7.1.1.1.1.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1"><times id="Sx3.E7.m1.7.7.1.1.1.1.2.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.2"></times><apply id="Sx3.E7.m1.7.7.1.1.1.1.3.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E7.m1.7.7.1.1.1.1.3.1.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E7.m1.7.7.1.1.1.1.3.2.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.3.2">𝐿</ci><apply id="Sx3.E7.m1.7.7.1.1.1.1.3.3.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.3.3"><times id="Sx3.E7.m1.7.7.1.1.1.1.3.3.1.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.3.3.1"></times><ci id="Sx3.E7.m1.7.7.1.1.1.1.3.3.2.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.3.3.2">𝑚</ci><ci id="Sx3.E7.m1.7.7.1.1.1.1.3.3.3.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.3.3.3">𝑠</ci><ci id="Sx3.E7.m1.7.7.1.1.1.1.3.3.4.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.3.3.4">𝑒</ci></apply></apply><vector id="Sx3.E7.m1.7.7.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.1.1"><ci id="Sx3.E7.m1.4.4.cmml" xref="Sx3.E7.m1.4.4">𝐼</ci><ci id="Sx3.E7.m1.5.5.cmml" xref="Sx3.E7.m1.5.5">𝑞</ci><apply id="Sx3.E7.m1.7.7.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E7.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E7.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.1.1.1.2">𝛼</ci><ci id="Sx3.E7.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E7.m1.7.7.1.1.1.1.1.1.1.3">ℎ</ci></apply><ci id="Sx3.E7.m1.6.6.cmml" xref="Sx3.E7.m1.6.6">𝜃</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E7.m1.7c">\underset{\theta}{\mathrm{argmin}}\sum_{(I,q,a_{h})\in\mathcal{D}}L_{mse}(I,q,\alpha_{h};\theta).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<figure id="Sx3.F3" class="ltx_figure"><img src="/html/1709.06308/assets/x3.png" id="Sx3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="208" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Structure of the proposed supervised attention model. The model-generated attention explicitly learns from the human-like attention generated by the HAN.</figcaption>
</figure>
</section>
</section>
<section id="Sx3.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Attention supervision for VQA</h3>

<div id="Sx3.SSx3.p1" class="ltx_para">
<p id="Sx3.SSx3.p1.1" class="ltx_p">In this section, the details of the VQA model are presented.
For comparison, an unsupervised attention model is discussed first.
Afterwards, the proposed supervised attention model is introduced.
</p>
</div>
<section id="Sx3.SSx3.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Unsupervised attention model</h4>

<div id="Sx3.SSx3.SSSx1.p1" class="ltx_para">
<p id="Sx3.SSx3.SSSx1.p1.1" class="ltx_p">The Multimodal Low-rank Bilinear attention networks (MLB) (<span id="Sx3.SSx3.SSSx1.p1.1.1" class="ltx_text ltx_font_bold">?</span>) is used as our baseline,
due to its unsupervised attention mechanism and satisfactory performance.
Given an image-question pair, the MLB first generates several attention maps for the given image-question pair and obtains the attentive visual feature.
Then, the attentive visual feature and the question feature are fused by a low-rank bilinear pooling.
The output is finally fed to a multi-way classifier to produce probabilities over the candidate answers.</p>
</div>
<div id="Sx3.SSx3.SSSx1.p2" class="ltx_para">
<p id="Sx3.SSx3.SSSx1.p2.5" class="ltx_p">Specifically, given an image feature matrix <math id="Sx3.SSx3.SSSx1.p2.1.m1.1" class="ltx_Math" alttext="F" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.1.m1.1a"><mi id="Sx3.SSx3.SSSx1.p2.1.m1.1.1" xref="Sx3.SSx3.SSSx1.p2.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.1.m1.1b"><ci id="Sx3.SSx3.SSSx1.p2.1.m1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.1.m1.1c">F</annotation></semantics></math> and a question feature vector <math id="Sx3.SSx3.SSSx1.p2.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.2.m2.1a"><mi id="Sx3.SSx3.SSSx1.p2.2.m2.1.1" xref="Sx3.SSx3.SSSx1.p2.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.2.m2.1b"><ci id="Sx3.SSx3.SSSx1.p2.2.m2.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.2.m2.1c">Q</annotation></semantics></math>,
the attention maps are first computed as described in Eq. <a href="#Sx3.E3" title="In Attention generation ‣ Human Attention Network ‣ Approach ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and Eq. <a href="#Sx3.E4" title="In Attention generation ‣ Human Attention Network ‣ Approach ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
Then, they are fed into a softmax layer to get the probability distribution over the image.
Hence, a sequence of attention maps is obtained,
denoted as <math id="Sx3.SSx3.SSSx1.p2.3.m3.4" class="ltx_Math" alttext="\alpha=\{\alpha_{1},\alpha_{2},...,\alpha_{G}\}" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.3.m3.4a"><mrow id="Sx3.SSx3.SSSx1.p2.3.m3.4.4" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.cmml"><mi id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.5" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.5.cmml">α</mi><mo id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.4" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.4.cmml">=</mo><mrow id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.4.cmml"><mo stretchy="false" id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.4" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.4.cmml">{</mo><msub id="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1" xref="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1.cmml"><mi id="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1.2" xref="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1.2.cmml">α</mi><mn id="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1.3" xref="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.5" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.4.cmml">,</mo><msub id="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2" xref="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2.cmml"><mi id="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2.2" xref="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2.2.cmml">α</mi><mn id="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2.3" xref="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.6" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx3.SSSx1.p2.3.m3.1.1" xref="Sx3.SSx3.SSSx1.p2.3.m3.1.1.cmml">…</mi><mo id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.7" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.4.cmml">,</mo><msub id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3.cmml"><mi id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3.2" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3.2.cmml">α</mi><mi id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3.3" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3.3.cmml">G</mi></msub><mo stretchy="false" id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.8" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.3.m3.4b"><apply id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4"><eq id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.4.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.4"></eq><ci id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.5.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.5">𝛼</ci><set id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.4.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3"><apply id="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1.2.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1.2">𝛼</ci><cn type="integer" id="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1.3.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2.1.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2">subscript</csymbol><ci id="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2.2.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2.2">𝛼</ci><cn type="integer" id="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2.3.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="Sx3.SSx3.SSSx1.p2.3.m3.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.1.1">…</ci><apply id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3.1.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3">subscript</csymbol><ci id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3.2.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3.2">𝛼</ci><ci id="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3.3.cmml" xref="Sx3.SSx3.SSSx1.p2.3.m3.4.4.3.3.3.3">𝐺</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.3.m3.4c">\alpha=\{\alpha_{1},\alpha_{2},...,\alpha_{G}\}</annotation></semantics></math>.
With the attention maps <math id="Sx3.SSx3.SSSx1.p2.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.4.m4.1a"><mi id="Sx3.SSx3.SSSx1.p2.4.m4.1.1" xref="Sx3.SSx3.SSSx1.p2.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.4.m4.1b"><ci id="Sx3.SSx3.SSSx1.p2.4.m4.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.4.m4.1c">\alpha</annotation></semantics></math>,
the <math id="Sx3.SSx3.SSSx1.p2.5.m5.1" class="ltx_Math" alttext="s" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.5.m5.1a"><mi id="Sx3.SSx3.SSSx1.p2.5.m5.1.1" xref="Sx3.SSx3.SSSx1.p2.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.5.m5.1b"><ci id="Sx3.SSx3.SSSx1.p2.5.m5.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.5.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.5.m5.1c">s</annotation></semantics></math>-dimensional attentive visual feature is then calculated by</p>
<table id="Sx3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E8.m1.1" class="ltx_Math" alttext="\hat{F}=\bigparallel_{g=1}^{G}\sum_{i=1}^{l^{2}}softmax({\alpha}_{g}^{i})F^{i}," display="block"><semantics id="Sx3.E8.m1.1a"><mrow id="Sx3.E8.m1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.cmml"><mrow id="Sx3.E8.m1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.cmml"><mover accent="true" id="Sx3.E8.m1.1.1.1.1.3" xref="Sx3.E8.m1.1.1.1.1.3.cmml"><mi id="Sx3.E8.m1.1.1.1.1.3.2" xref="Sx3.E8.m1.1.1.1.1.3.2.cmml">F</mi><mo id="Sx3.E8.m1.1.1.1.1.3.1" xref="Sx3.E8.m1.1.1.1.1.3.1.cmml">^</mo></mover><mo id="Sx3.E8.m1.1.1.1.1.2" xref="Sx3.E8.m1.1.1.1.1.2.cmml">=</mo><mrow id="Sx3.E8.m1.1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.1.cmml"><munderover id="Sx3.E8.m1.1.1.1.1.1.2" xref="Sx3.E8.m1.1.1.1.1.1.2.cmml"><mo fence="false" largeop="true" movablelimits="false" stretchy="false" id="Sx3.E8.m1.1.1.1.1.1.2.2.2" xref="Sx3.E8.m1.1.1.1.1.1.2.2.2.cmml">‖</mo><mrow id="Sx3.E8.m1.1.1.1.1.1.2.2.3" xref="Sx3.E8.m1.1.1.1.1.1.2.2.3.cmml"><mi id="Sx3.E8.m1.1.1.1.1.1.2.2.3.2" xref="Sx3.E8.m1.1.1.1.1.1.2.2.3.2.cmml">g</mi><mo id="Sx3.E8.m1.1.1.1.1.1.2.2.3.1" xref="Sx3.E8.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx3.E8.m1.1.1.1.1.1.2.2.3.3" xref="Sx3.E8.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx3.E8.m1.1.1.1.1.1.2.3" xref="Sx3.E8.m1.1.1.1.1.1.2.3.cmml">G</mi></munderover><mrow id="Sx3.E8.m1.1.1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.1.1.cmml"><munderover id="Sx3.E8.m1.1.1.1.1.1.1.2" xref="Sx3.E8.m1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="Sx3.E8.m1.1.1.1.1.1.1.2.2.2" xref="Sx3.E8.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx3.E8.m1.1.1.1.1.1.1.2.2.3" xref="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.2" xref="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.1" xref="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.3" xref="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msup id="Sx3.E8.m1.1.1.1.1.1.1.2.3" xref="Sx3.E8.m1.1.1.1.1.1.1.2.3.cmml"><mi id="Sx3.E8.m1.1.1.1.1.1.1.2.3.2" xref="Sx3.E8.m1.1.1.1.1.1.1.2.3.2.cmml">l</mi><mn id="Sx3.E8.m1.1.1.1.1.1.1.2.3.3" xref="Sx3.E8.m1.1.1.1.1.1.1.2.3.3.cmml">2</mn></msup></munderover><mrow id="Sx3.E8.m1.1.1.1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.3" xref="Sx3.E8.m1.1.1.1.1.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.1.1.1.2" xref="Sx3.E8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.4" xref="Sx3.E8.m1.1.1.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.1.1.1.2a" xref="Sx3.E8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.5" xref="Sx3.E8.m1.1.1.1.1.1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.1.1.1.2b" xref="Sx3.E8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.6" xref="Sx3.E8.m1.1.1.1.1.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.1.1.1.2c" xref="Sx3.E8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.7" xref="Sx3.E8.m1.1.1.1.1.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.1.1.1.2d" xref="Sx3.E8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.8" xref="Sx3.E8.m1.1.1.1.1.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.1.1.1.2e" xref="Sx3.E8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.9" xref="Sx3.E8.m1.1.1.1.1.1.1.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.1.1.1.2f" xref="Sx3.E8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">α</mi><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">g</mi><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.1.1.1.2g" xref="Sx3.E8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><msup id="Sx3.E8.m1.1.1.1.1.1.1.1.10" xref="Sx3.E8.m1.1.1.1.1.1.1.1.10.cmml"><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.10.2" xref="Sx3.E8.m1.1.1.1.1.1.1.1.10.2.cmml">F</mi><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.10.3" xref="Sx3.E8.m1.1.1.1.1.1.1.1.10.3.cmml">i</mi></msup></mrow></mrow></mrow></mrow><mo id="Sx3.E8.m1.1.1.1.2" xref="Sx3.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E8.m1.1b"><apply id="Sx3.E8.m1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1"><eq id="Sx3.E8.m1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.1.1.1.1.2"></eq><apply id="Sx3.E8.m1.1.1.1.1.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3"><ci id="Sx3.E8.m1.1.1.1.1.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.1">^</ci><ci id="Sx3.E8.m1.1.1.1.1.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2">𝐹</ci></apply><apply id="Sx3.E8.m1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1"><apply id="Sx3.E8.m1.1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.1.2.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.2">superscript</csymbol><apply id="Sx3.E8.m1.1.1.1.1.1.2.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx3.E8.m1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.2.2.2">‖</ci><apply id="Sx3.E8.m1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.2.2.3"><eq id="Sx3.E8.m1.1.1.1.1.1.2.2.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="Sx3.E8.m1.1.1.1.1.1.2.2.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.2.2.3.2">𝑔</ci><cn type="integer" id="Sx3.E8.m1.1.1.1.1.1.2.2.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="Sx3.E8.m1.1.1.1.1.1.2.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.2.3">𝐺</ci></apply><apply id="Sx3.E8.m1.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1"><apply id="Sx3.E8.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="Sx3.E8.m1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="Sx3.E8.m1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2.2.3"><eq id="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="Sx3.E8.m1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="Sx3.E8.m1.1.1.1.1.1.1.2.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2.3.2">𝑙</ci><cn type="integer" id="Sx3.E8.m1.1.1.1.1.1.1.2.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="Sx3.E8.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1"><times id="Sx3.E8.m1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.2"></times><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.3">𝑠</ci><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.4.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.4">𝑜</ci><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.5.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.5">𝑓</ci><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.6.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.6">𝑡</ci><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.7.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.7">𝑚</ci><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.8.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.8">𝑎</ci><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.9.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.9">𝑥</ci><apply id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝛼</ci><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑔</ci></apply><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Sx3.E8.m1.1.1.1.1.1.1.1.10.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.10"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.1.1.1.10.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.10">superscript</csymbol><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.10.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.10.2">𝐹</ci><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.10.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.10.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E8.m1.1c">\hat{F}=\bigparallel_{g=1}^{G}\sum_{i=1}^{l^{2}}softmax({\alpha}_{g}^{i})F^{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.SSSx1.p2.14" class="ltx_p">where <math id="Sx3.SSx3.SSSx1.p2.6.m1.1" class="ltx_Math" alttext="\bigparallel" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.6.m1.1a"><mo fence="false" largeop="true" stretchy="false" id="Sx3.SSx3.SSSx1.p2.6.m1.1.1" xref="Sx3.SSx3.SSSx1.p2.6.m1.1.1.cmml">‖</mo><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.6.m1.1b"><ci id="Sx3.SSx3.SSSx1.p2.6.m1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.6.m1.1.1">‖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.6.m1.1c">\bigparallel</annotation></semantics></math> denotes the concatenation operation of vectors,
<math id="Sx3.SSx3.SSSx1.p2.7.m2.1" class="ltx_Math" alttext="\alpha_{g}^{i}" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.7.m2.1a"><msubsup id="Sx3.SSx3.SSSx1.p2.7.m2.1.1" xref="Sx3.SSx3.SSSx1.p2.7.m2.1.1.cmml"><mi id="Sx3.SSx3.SSSx1.p2.7.m2.1.1.2.2" xref="Sx3.SSx3.SSSx1.p2.7.m2.1.1.2.2.cmml">α</mi><mi id="Sx3.SSx3.SSSx1.p2.7.m2.1.1.2.3" xref="Sx3.SSx3.SSSx1.p2.7.m2.1.1.2.3.cmml">g</mi><mi id="Sx3.SSx3.SSSx1.p2.7.m2.1.1.3" xref="Sx3.SSx3.SSSx1.p2.7.m2.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.7.m2.1b"><apply id="Sx3.SSx3.SSSx1.p2.7.m2.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.7.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p2.7.m2.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.7.m2.1.1">superscript</csymbol><apply id="Sx3.SSx3.SSSx1.p2.7.m2.1.1.2.cmml" xref="Sx3.SSx3.SSSx1.p2.7.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p2.7.m2.1.1.2.1.cmml" xref="Sx3.SSx3.SSSx1.p2.7.m2.1.1">subscript</csymbol><ci id="Sx3.SSx3.SSSx1.p2.7.m2.1.1.2.2.cmml" xref="Sx3.SSx3.SSSx1.p2.7.m2.1.1.2.2">𝛼</ci><ci id="Sx3.SSx3.SSSx1.p2.7.m2.1.1.2.3.cmml" xref="Sx3.SSx3.SSSx1.p2.7.m2.1.1.2.3">𝑔</ci></apply><ci id="Sx3.SSx3.SSSx1.p2.7.m2.1.1.3.cmml" xref="Sx3.SSx3.SSSx1.p2.7.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.7.m2.1c">\alpha_{g}^{i}</annotation></semantics></math> indicates the <math id="Sx3.SSx3.SSSx1.p2.8.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.8.m3.1a"><mi id="Sx3.SSx3.SSSx1.p2.8.m3.1.1" xref="Sx3.SSx3.SSSx1.p2.8.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.8.m3.1b"><ci id="Sx3.SSx3.SSSx1.p2.8.m3.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.8.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.8.m3.1c">i</annotation></semantics></math>-th element of the <math id="Sx3.SSx3.SSSx1.p2.9.m4.1" class="ltx_Math" alttext="g" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.9.m4.1a"><mi id="Sx3.SSx3.SSSx1.p2.9.m4.1.1" xref="Sx3.SSx3.SSSx1.p2.9.m4.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.9.m4.1b"><ci id="Sx3.SSx3.SSSx1.p2.9.m4.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.9.m4.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.9.m4.1c">g</annotation></semantics></math>-th attention maps in <math id="Sx3.SSx3.SSSx1.p2.10.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.10.m5.1a"><mi id="Sx3.SSx3.SSSx1.p2.10.m5.1.1" xref="Sx3.SSx3.SSSx1.p2.10.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.10.m5.1b"><ci id="Sx3.SSx3.SSSx1.p2.10.m5.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.10.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.10.m5.1c">\alpha</annotation></semantics></math>, <math id="Sx3.SSx3.SSSx1.p2.11.m6.1" class="ltx_Math" alttext="F^{i}" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.11.m6.1a"><msup id="Sx3.SSx3.SSSx1.p2.11.m6.1.1" xref="Sx3.SSx3.SSSx1.p2.11.m6.1.1.cmml"><mi id="Sx3.SSx3.SSSx1.p2.11.m6.1.1.2" xref="Sx3.SSx3.SSSx1.p2.11.m6.1.1.2.cmml">F</mi><mi id="Sx3.SSx3.SSSx1.p2.11.m6.1.1.3" xref="Sx3.SSx3.SSSx1.p2.11.m6.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.11.m6.1b"><apply id="Sx3.SSx3.SSSx1.p2.11.m6.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.11.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p2.11.m6.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.11.m6.1.1">superscript</csymbol><ci id="Sx3.SSx3.SSSx1.p2.11.m6.1.1.2.cmml" xref="Sx3.SSx3.SSSx1.p2.11.m6.1.1.2">𝐹</ci><ci id="Sx3.SSx3.SSSx1.p2.11.m6.1.1.3.cmml" xref="Sx3.SSx3.SSSx1.p2.11.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.11.m6.1c">F^{i}</annotation></semantics></math> indicates the <math id="Sx3.SSx3.SSSx1.p2.12.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.12.m7.1a"><mi id="Sx3.SSx3.SSSx1.p2.12.m7.1.1" xref="Sx3.SSx3.SSSx1.p2.12.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.12.m7.1b"><ci id="Sx3.SSx3.SSSx1.p2.12.m7.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.12.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.12.m7.1c">i</annotation></semantics></math>-th row of an image feature map and the dimensionality of <math id="Sx3.SSx3.SSSx1.p2.13.m8.1" class="ltx_Math" alttext="\hat{F}" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.13.m8.1a"><mover accent="true" id="Sx3.SSx3.SSSx1.p2.13.m8.1.1" xref="Sx3.SSx3.SSSx1.p2.13.m8.1.1.cmml"><mi id="Sx3.SSx3.SSSx1.p2.13.m8.1.1.2" xref="Sx3.SSx3.SSSx1.p2.13.m8.1.1.2.cmml">F</mi><mo id="Sx3.SSx3.SSSx1.p2.13.m8.1.1.1" xref="Sx3.SSx3.SSSx1.p2.13.m8.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.13.m8.1b"><apply id="Sx3.SSx3.SSSx1.p2.13.m8.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.13.m8.1.1"><ci id="Sx3.SSx3.SSSx1.p2.13.m8.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.13.m8.1.1.1">^</ci><ci id="Sx3.SSx3.SSSx1.p2.13.m8.1.1.2.cmml" xref="Sx3.SSx3.SSSx1.p2.13.m8.1.1.2">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.13.m8.1c">\hat{F}</annotation></semantics></math> is <math id="Sx3.SSx3.SSSx1.p2.14.m9.1" class="ltx_Math" alttext="s=m\times G" display="inline"><semantics id="Sx3.SSx3.SSSx1.p2.14.m9.1a"><mrow id="Sx3.SSx3.SSSx1.p2.14.m9.1.1" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.cmml"><mi id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.2" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.2.cmml">s</mi><mo id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.1" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.1.cmml">=</mo><mrow id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.cmml"><mi id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.2" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.1" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.1.cmml">×</mo><mi id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.3" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.3.cmml">G</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p2.14.m9.1b"><apply id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1"><eq id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.1"></eq><ci id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.2.cmml" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.2">𝑠</ci><apply id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.cmml" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3"><times id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.1.cmml" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.1"></times><ci id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.2.cmml" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.2">𝑚</ci><ci id="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.3.cmml" xref="Sx3.SSx3.SSSx1.p2.14.m9.1.1.3.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p2.14.m9.1c">s=m\times G</annotation></semantics></math>.</p>
</div>
<div id="Sx3.SSx3.SSSx1.p3" class="ltx_para">
<p id="Sx3.SSx3.SSSx1.p3.2" class="ltx_p">In order to predict the answer,
the attentive visual feature vector <math id="Sx3.SSx3.SSSx1.p3.1.m1.1" class="ltx_Math" alttext="\hat{F}" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.1.m1.1a"><mover accent="true" id="Sx3.SSx3.SSSx1.p3.1.m1.1.1" xref="Sx3.SSx3.SSSx1.p3.1.m1.1.1.cmml"><mi id="Sx3.SSx3.SSSx1.p3.1.m1.1.1.2" xref="Sx3.SSx3.SSSx1.p3.1.m1.1.1.2.cmml">F</mi><mo id="Sx3.SSx3.SSSx1.p3.1.m1.1.1.1" xref="Sx3.SSx3.SSSx1.p3.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.1.m1.1b"><apply id="Sx3.SSx3.SSSx1.p3.1.m1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.1.m1.1.1"><ci id="Sx3.SSx3.SSSx1.p3.1.m1.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.1.m1.1.1.1">^</ci><ci id="Sx3.SSx3.SSSx1.p3.1.m1.1.1.2.cmml" xref="Sx3.SSx3.SSSx1.p3.1.m1.1.1.2">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.1.m1.1c">\hat{F}</annotation></semantics></math> and the question vector <math id="Sx3.SSx3.SSSx1.p3.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.2.m2.1a"><mi id="Sx3.SSx3.SSSx1.p3.2.m2.1.1" xref="Sx3.SSx3.SSSx1.p3.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.2.m2.1b"><ci id="Sx3.SSx3.SSSx1.p3.2.m2.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.2.m2.1c">Q</annotation></semantics></math> are combined through another low-rank bilinear pooling.
The output of the low-rank bilinear pooling is fed to a linear layer followed by a softmax classifier to produce probabilities over the candidate answers.
More formally, the answer probabilities are given by</p>
<table id="Sx3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E9.m1.4" class="ltx_Math" alttext="p(a\mid I,q;\Theta)=softmax(P(\sigma(U^{\prime}Q)\circ\sigma(V^{\prime}\hat{F})))," display="block"><semantics id="Sx3.E9.m1.4a"><mrow id="Sx3.E9.m1.4.4.1" xref="Sx3.E9.m1.4.4.1.1.cmml"><mrow id="Sx3.E9.m1.4.4.1.1" xref="Sx3.E9.m1.4.4.1.1.cmml"><mrow id="Sx3.E9.m1.4.4.1.1.1" xref="Sx3.E9.m1.4.4.1.1.1.cmml"><mi id="Sx3.E9.m1.4.4.1.1.1.3" xref="Sx3.E9.m1.4.4.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.1.2" xref="Sx3.E9.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="Sx3.E9.m1.4.4.1.1.1.1.1" xref="Sx3.E9.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E9.m1.4.4.1.1.1.1.1.2" xref="Sx3.E9.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E9.m1.4.4.1.1.1.1.1.1" xref="Sx3.E9.m1.4.4.1.1.1.1.1.1.cmml"><mi id="Sx3.E9.m1.4.4.1.1.1.1.1.1.2" xref="Sx3.E9.m1.4.4.1.1.1.1.1.1.2.cmml">a</mi><mo id="Sx3.E9.m1.4.4.1.1.1.1.1.1.1" xref="Sx3.E9.m1.4.4.1.1.1.1.1.1.1.cmml">∣</mo><mrow id="Sx3.E9.m1.4.4.1.1.1.1.1.1.3.2" xref="Sx3.E9.m1.4.4.1.1.1.1.1.1.3.1.cmml"><mi id="Sx3.E9.m1.1.1" xref="Sx3.E9.m1.1.1.cmml">I</mi><mo id="Sx3.E9.m1.4.4.1.1.1.1.1.1.3.2.1" xref="Sx3.E9.m1.4.4.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="Sx3.E9.m1.2.2" xref="Sx3.E9.m1.2.2.cmml">q</mi><mo id="Sx3.E9.m1.4.4.1.1.1.1.1.1.3.2.2" xref="Sx3.E9.m1.4.4.1.1.1.1.1.1.3.1.cmml">;</mo><mi mathvariant="normal" id="Sx3.E9.m1.3.3" xref="Sx3.E9.m1.3.3.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="Sx3.E9.m1.4.4.1.1.1.1.1.3" xref="Sx3.E9.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E9.m1.4.4.1.1.3" xref="Sx3.E9.m1.4.4.1.1.3.cmml">=</mo><mrow id="Sx3.E9.m1.4.4.1.1.2" xref="Sx3.E9.m1.4.4.1.1.2.cmml"><mi id="Sx3.E9.m1.4.4.1.1.2.3" xref="Sx3.E9.m1.4.4.1.1.2.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.2.2" xref="Sx3.E9.m1.4.4.1.1.2.2.cmml">​</mo><mi id="Sx3.E9.m1.4.4.1.1.2.4" xref="Sx3.E9.m1.4.4.1.1.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.2.2a" xref="Sx3.E9.m1.4.4.1.1.2.2.cmml">​</mo><mi id="Sx3.E9.m1.4.4.1.1.2.5" xref="Sx3.E9.m1.4.4.1.1.2.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.2.2b" xref="Sx3.E9.m1.4.4.1.1.2.2.cmml">​</mo><mi id="Sx3.E9.m1.4.4.1.1.2.6" xref="Sx3.E9.m1.4.4.1.1.2.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.2.2c" xref="Sx3.E9.m1.4.4.1.1.2.2.cmml">​</mo><mi id="Sx3.E9.m1.4.4.1.1.2.7" xref="Sx3.E9.m1.4.4.1.1.2.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.2.2d" xref="Sx3.E9.m1.4.4.1.1.2.2.cmml">​</mo><mi id="Sx3.E9.m1.4.4.1.1.2.8" xref="Sx3.E9.m1.4.4.1.1.2.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.2.2e" xref="Sx3.E9.m1.4.4.1.1.2.2.cmml">​</mo><mi id="Sx3.E9.m1.4.4.1.1.2.9" xref="Sx3.E9.m1.4.4.1.1.2.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.2.2f" xref="Sx3.E9.m1.4.4.1.1.2.2.cmml">​</mo><mrow id="Sx3.E9.m1.4.4.1.1.2.1.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.E9.m1.4.4.1.1.2.1.1.2" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.cmml">(</mo><mrow id="Sx3.E9.m1.4.4.1.1.2.1.1.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.cmml"><mi id="Sx3.E9.m1.4.4.1.1.2.1.1.1.3" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.2" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.2.cmml">​</mo><mrow id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.2" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.cmml"><mrow id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.3" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.2" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">U</mi><mo id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">Q</mi></mrow><mo rspace="0.055em" stretchy="false" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.2" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.cmml">∘</mo><mi id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.cmml">σ</mi></mrow><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.3" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.2" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.cmml"><msup id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2.cmml"><mi id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2.2" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2.2.cmml">V</mi><mo id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2.3" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.1.cmml">​</mo><mover accent="true" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.3" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.3.cmml"><mi id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.3.2" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.3.2.cmml">F</mi><mo id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.3.1" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.3.1.cmml">^</mo></mover></mrow><mo stretchy="false" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.3" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.3" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.E9.m1.4.4.1.1.2.1.1.3" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E9.m1.4.4.1.2" xref="Sx3.E9.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E9.m1.4b"><apply id="Sx3.E9.m1.4.4.1.1.cmml" xref="Sx3.E9.m1.4.4.1"><eq id="Sx3.E9.m1.4.4.1.1.3.cmml" xref="Sx3.E9.m1.4.4.1.1.3"></eq><apply id="Sx3.E9.m1.4.4.1.1.1.cmml" xref="Sx3.E9.m1.4.4.1.1.1"><times id="Sx3.E9.m1.4.4.1.1.1.2.cmml" xref="Sx3.E9.m1.4.4.1.1.1.2"></times><ci id="Sx3.E9.m1.4.4.1.1.1.3.cmml" xref="Sx3.E9.m1.4.4.1.1.1.3">𝑝</ci><apply id="Sx3.E9.m1.4.4.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="Sx3.E9.m1.4.4.1.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.4.4.1.1.1.1.1.1.1">conditional</csymbol><ci id="Sx3.E9.m1.4.4.1.1.1.1.1.1.2.cmml" xref="Sx3.E9.m1.4.4.1.1.1.1.1.1.2">𝑎</ci><list id="Sx3.E9.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E9.m1.4.4.1.1.1.1.1.1.3.2"><ci id="Sx3.E9.m1.1.1.cmml" xref="Sx3.E9.m1.1.1">𝐼</ci><ci id="Sx3.E9.m1.2.2.cmml" xref="Sx3.E9.m1.2.2">𝑞</ci><ci id="Sx3.E9.m1.3.3.cmml" xref="Sx3.E9.m1.3.3">Θ</ci></list></apply></apply><apply id="Sx3.E9.m1.4.4.1.1.2.cmml" xref="Sx3.E9.m1.4.4.1.1.2"><times id="Sx3.E9.m1.4.4.1.1.2.2.cmml" xref="Sx3.E9.m1.4.4.1.1.2.2"></times><ci id="Sx3.E9.m1.4.4.1.1.2.3.cmml" xref="Sx3.E9.m1.4.4.1.1.2.3">𝑠</ci><ci id="Sx3.E9.m1.4.4.1.1.2.4.cmml" xref="Sx3.E9.m1.4.4.1.1.2.4">𝑜</ci><ci id="Sx3.E9.m1.4.4.1.1.2.5.cmml" xref="Sx3.E9.m1.4.4.1.1.2.5">𝑓</ci><ci id="Sx3.E9.m1.4.4.1.1.2.6.cmml" xref="Sx3.E9.m1.4.4.1.1.2.6">𝑡</ci><ci id="Sx3.E9.m1.4.4.1.1.2.7.cmml" xref="Sx3.E9.m1.4.4.1.1.2.7">𝑚</ci><ci id="Sx3.E9.m1.4.4.1.1.2.8.cmml" xref="Sx3.E9.m1.4.4.1.1.2.8">𝑎</ci><ci id="Sx3.E9.m1.4.4.1.1.2.9.cmml" xref="Sx3.E9.m1.4.4.1.1.2.9">𝑥</ci><apply id="Sx3.E9.m1.4.4.1.1.2.1.1.1.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1"><times id="Sx3.E9.m1.4.4.1.1.2.1.1.1.2.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.2"></times><ci id="Sx3.E9.m1.4.4.1.1.2.1.1.1.3.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.3">𝑃</ci><apply id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1"><times id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.3.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.3"></times><apply id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1"><compose id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.2"></compose><apply id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1"><times id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.2"></times><ci id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.3">𝜎</ci><apply id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1"><times id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑈</ci><ci id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑄</ci></apply></apply><ci id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.1.3">𝜎</ci></apply><apply id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1"><times id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.1.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.1"></times><apply id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2">superscript</csymbol><ci id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2.2.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2.2">𝑉</ci><ci id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2.3.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.2.3">′</ci></apply><apply id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.3.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.3"><ci id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.3.1.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.3.1">^</ci><ci id="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.3.2.cmml" xref="Sx3.E9.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.1.3.2">𝐹</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E9.m1.4c">p(a\mid I,q;\Theta)=softmax(P(\sigma(U^{\prime}Q)\circ\sigma(V^{\prime}\hat{F}))),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.SSSx1.p3.7" class="ltx_p">where <math id="Sx3.SSx3.SSSx1.p3.3.m1.1" class="ltx_Math" alttext="P\in\mathbbm{R}^{K\times r}" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.3.m1.1a"><mrow id="Sx3.SSx3.SSSx1.p3.3.m1.1.1" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.cmml"><mi id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.2" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.2.cmml">P</mi><mo id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.1" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.1.cmml">∈</mo><msup id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.cmml"><mi id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.2" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.cmml"><mi id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.2" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.1" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.3" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.3.m1.1b"><apply id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1"><in id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.1"></in><ci id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.2.cmml" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.2">𝑃</ci><apply id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.cmml" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.1.cmml" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3">superscript</csymbol><ci id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.2.cmml" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.2">ℝ</ci><apply id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.cmml" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3"><times id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.1.cmml" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.1"></times><ci id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.2.cmml" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.2">𝐾</ci><ci id="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.3.cmml" xref="Sx3.SSx3.SSSx1.p3.3.m1.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.3.m1.1c">P\in\mathbbm{R}^{K\times r}</annotation></semantics></math>, <math id="Sx3.SSx3.SSSx1.p3.4.m2.1" class="ltx_Math" alttext="U^{\prime}\in\mathbbm{R}^{r\times n}" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.4.m2.1a"><mrow id="Sx3.SSx3.SSSx1.p3.4.m2.1.1" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.cmml"><msup id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2.cmml"><mi id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2.2" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2.2.cmml">U</mi><mo id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2.3" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2.3.cmml">′</mo></msup><mo id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.1" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.1.cmml">∈</mo><msup id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.cmml"><mi id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.2" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.cmml"><mi id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.2" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.2.cmml">r</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.1" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.3" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.4.m2.1b"><apply id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1"><in id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.1"></in><apply id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2.1.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2">superscript</csymbol><ci id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2.2.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2.2">𝑈</ci><ci id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2.3.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.2.3">′</ci></apply><apply id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.1.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3">superscript</csymbol><ci id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.2.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.2">ℝ</ci><apply id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3"><times id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.1.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.1"></times><ci id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.2.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.2">𝑟</ci><ci id="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.3.cmml" xref="Sx3.SSx3.SSSx1.p3.4.m2.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.4.m2.1c">U^{\prime}\in\mathbbm{R}^{r\times n}</annotation></semantics></math> and <math id="Sx3.SSx3.SSSx1.p3.5.m3.1" class="ltx_Math" alttext="V^{\prime}\in\mathbbm{R}^{r\times s}" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.5.m3.1a"><mrow id="Sx3.SSx3.SSSx1.p3.5.m3.1.1" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.cmml"><msup id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2.cmml"><mi id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2.2" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2.2.cmml">V</mi><mo id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2.3" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2.3.cmml">′</mo></msup><mo id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.1" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.1.cmml">∈</mo><msup id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.cmml"><mi id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.2" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.cmml"><mi id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.2" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.2.cmml">r</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.1" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.3" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.3.cmml">s</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.5.m3.1b"><apply id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1"><in id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.1"></in><apply id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2.1.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2">superscript</csymbol><ci id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2.2.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2.2">𝑉</ci><ci id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2.3.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.2.3">′</ci></apply><apply id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.1.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3">superscript</csymbol><ci id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.2.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.2">ℝ</ci><apply id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3"><times id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.1.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.1"></times><ci id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.2.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.2">𝑟</ci><ci id="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.3.cmml" xref="Sx3.SSx3.SSSx1.p3.5.m3.1.1.3.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.5.m3.1c">V^{\prime}\in\mathbbm{R}^{r\times s}</annotation></semantics></math> are trainable affine matrices.
The MLB model is trained by minimizing the cross-entropy loss over the training data.
Given a training triplet of <math id="Sx3.SSx3.SSSx1.p3.6.m4.3" class="ltx_Math" alttext="(I,q,A)" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.6.m4.3a"><mrow id="Sx3.SSx3.SSSx1.p3.6.m4.3.4.2" xref="Sx3.SSx3.SSSx1.p3.6.m4.3.4.1.cmml"><mo stretchy="false" id="Sx3.SSx3.SSSx1.p3.6.m4.3.4.2.1" xref="Sx3.SSx3.SSSx1.p3.6.m4.3.4.1.cmml">(</mo><mi id="Sx3.SSx3.SSSx1.p3.6.m4.1.1" xref="Sx3.SSx3.SSSx1.p3.6.m4.1.1.cmml">I</mi><mo id="Sx3.SSx3.SSSx1.p3.6.m4.3.4.2.2" xref="Sx3.SSx3.SSSx1.p3.6.m4.3.4.1.cmml">,</mo><mi id="Sx3.SSx3.SSSx1.p3.6.m4.2.2" xref="Sx3.SSx3.SSSx1.p3.6.m4.2.2.cmml">q</mi><mo id="Sx3.SSx3.SSSx1.p3.6.m4.3.4.2.3" xref="Sx3.SSx3.SSSx1.p3.6.m4.3.4.1.cmml">,</mo><mi id="Sx3.SSx3.SSSx1.p3.6.m4.3.3" xref="Sx3.SSx3.SSSx1.p3.6.m4.3.3.cmml">A</mi><mo stretchy="false" id="Sx3.SSx3.SSSx1.p3.6.m4.3.4.2.4" xref="Sx3.SSx3.SSSx1.p3.6.m4.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.6.m4.3b"><vector id="Sx3.SSx3.SSSx1.p3.6.m4.3.4.1.cmml" xref="Sx3.SSx3.SSSx1.p3.6.m4.3.4.2"><ci id="Sx3.SSx3.SSSx1.p3.6.m4.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.6.m4.1.1">𝐼</ci><ci id="Sx3.SSx3.SSSx1.p3.6.m4.2.2.cmml" xref="Sx3.SSx3.SSSx1.p3.6.m4.2.2">𝑞</ci><ci id="Sx3.SSx3.SSSx1.p3.6.m4.3.3.cmml" xref="Sx3.SSx3.SSSx1.p3.6.m4.3.3">𝐴</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.6.m4.3c">(I,q,A)</annotation></semantics></math>, where <math id="Sx3.SSx3.SSSx1.p3.7.m5.1" class="ltx_Math" alttext="A" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.7.m5.1a"><mi id="Sx3.SSx3.SSSx1.p3.7.m5.1.1" xref="Sx3.SSx3.SSSx1.p3.7.m5.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.7.m5.1b"><ci id="Sx3.SSx3.SSSx1.p3.7.m5.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.7.m5.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.7.m5.1c">A</annotation></semantics></math> is the ground truth of the predicted answer,
the cross-entropy loss is defined as</p>
<table id="Sx3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E10.m1.7" class="ltx_Math" alttext="L_{cls}(I,q,A)=\frac{1}{K}\sum_{k=1}^{K}-log\;p(a_{k}\mid I,q\,;\Theta)." display="block"><semantics id="Sx3.E10.m1.7a"><mrow id="Sx3.E10.m1.7.7.1" xref="Sx3.E10.m1.7.7.1.1.cmml"><mrow id="Sx3.E10.m1.7.7.1.1" xref="Sx3.E10.m1.7.7.1.1.cmml"><mrow id="Sx3.E10.m1.7.7.1.1.3" xref="Sx3.E10.m1.7.7.1.1.3.cmml"><msub id="Sx3.E10.m1.7.7.1.1.3.2" xref="Sx3.E10.m1.7.7.1.1.3.2.cmml"><mi id="Sx3.E10.m1.7.7.1.1.3.2.2" xref="Sx3.E10.m1.7.7.1.1.3.2.2.cmml">L</mi><mrow id="Sx3.E10.m1.7.7.1.1.3.2.3" xref="Sx3.E10.m1.7.7.1.1.3.2.3.cmml"><mi id="Sx3.E10.m1.7.7.1.1.3.2.3.2" xref="Sx3.E10.m1.7.7.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.7.7.1.1.3.2.3.1" xref="Sx3.E10.m1.7.7.1.1.3.2.3.1.cmml">​</mo><mi id="Sx3.E10.m1.7.7.1.1.3.2.3.3" xref="Sx3.E10.m1.7.7.1.1.3.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.7.7.1.1.3.2.3.1a" xref="Sx3.E10.m1.7.7.1.1.3.2.3.1.cmml">​</mo><mi id="Sx3.E10.m1.7.7.1.1.3.2.3.4" xref="Sx3.E10.m1.7.7.1.1.3.2.3.4.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.7.7.1.1.3.1" xref="Sx3.E10.m1.7.7.1.1.3.1.cmml">​</mo><mrow id="Sx3.E10.m1.7.7.1.1.3.3.2" xref="Sx3.E10.m1.7.7.1.1.3.3.1.cmml"><mo stretchy="false" id="Sx3.E10.m1.7.7.1.1.3.3.2.1" xref="Sx3.E10.m1.7.7.1.1.3.3.1.cmml">(</mo><mi id="Sx3.E10.m1.1.1" xref="Sx3.E10.m1.1.1.cmml">I</mi><mo id="Sx3.E10.m1.7.7.1.1.3.3.2.2" xref="Sx3.E10.m1.7.7.1.1.3.3.1.cmml">,</mo><mi id="Sx3.E10.m1.2.2" xref="Sx3.E10.m1.2.2.cmml">q</mi><mo id="Sx3.E10.m1.7.7.1.1.3.3.2.3" xref="Sx3.E10.m1.7.7.1.1.3.3.1.cmml">,</mo><mi id="Sx3.E10.m1.3.3" xref="Sx3.E10.m1.3.3.cmml">A</mi><mo stretchy="false" id="Sx3.E10.m1.7.7.1.1.3.3.2.4" xref="Sx3.E10.m1.7.7.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E10.m1.7.7.1.1.2" xref="Sx3.E10.m1.7.7.1.1.2.cmml">=</mo><mrow id="Sx3.E10.m1.7.7.1.1.1" xref="Sx3.E10.m1.7.7.1.1.1.cmml"><mrow id="Sx3.E10.m1.7.7.1.1.1.3" xref="Sx3.E10.m1.7.7.1.1.1.3.cmml"><mfrac id="Sx3.E10.m1.7.7.1.1.1.3.2" xref="Sx3.E10.m1.7.7.1.1.1.3.2.cmml"><mn id="Sx3.E10.m1.7.7.1.1.1.3.2.2" xref="Sx3.E10.m1.7.7.1.1.1.3.2.2.cmml">1</mn><mi id="Sx3.E10.m1.7.7.1.1.1.3.2.3" xref="Sx3.E10.m1.7.7.1.1.1.3.2.3.cmml">K</mi></mfrac><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.7.7.1.1.1.3.1" xref="Sx3.E10.m1.7.7.1.1.1.3.1.cmml">​</mo><munderover id="Sx3.E10.m1.7.7.1.1.1.3.3" xref="Sx3.E10.m1.7.7.1.1.1.3.3.cmml"><mo movablelimits="false" rspace="0em" id="Sx3.E10.m1.7.7.1.1.1.3.3.2.2" xref="Sx3.E10.m1.7.7.1.1.1.3.3.2.2.cmml">∑</mo><mrow id="Sx3.E10.m1.7.7.1.1.1.3.3.2.3" xref="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.cmml"><mi id="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.2" xref="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.2.cmml">k</mi><mo id="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.1" xref="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.1.cmml">=</mo><mn id="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.3" xref="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.3.cmml">1</mn></mrow><mi id="Sx3.E10.m1.7.7.1.1.1.3.3.3" xref="Sx3.E10.m1.7.7.1.1.1.3.3.3.cmml">K</mi></munderover></mrow><mo lspace="0em" id="Sx3.E10.m1.7.7.1.1.1.2" xref="Sx3.E10.m1.7.7.1.1.1.2.cmml">−</mo><mrow id="Sx3.E10.m1.7.7.1.1.1.1" xref="Sx3.E10.m1.7.7.1.1.1.1.cmml"><mi id="Sx3.E10.m1.7.7.1.1.1.1.3" xref="Sx3.E10.m1.7.7.1.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.7.7.1.1.1.1.2" xref="Sx3.E10.m1.7.7.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E10.m1.7.7.1.1.1.1.4" xref="Sx3.E10.m1.7.7.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.7.7.1.1.1.1.2a" xref="Sx3.E10.m1.7.7.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E10.m1.7.7.1.1.1.1.5" xref="Sx3.E10.m1.7.7.1.1.1.1.5.cmml">g</mi><mo lspace="0.280em" rspace="0em" id="Sx3.E10.m1.7.7.1.1.1.1.2b" xref="Sx3.E10.m1.7.7.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E10.m1.7.7.1.1.1.1.6" xref="Sx3.E10.m1.7.7.1.1.1.1.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.7.7.1.1.1.1.2c" xref="Sx3.E10.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E10.m1.7.7.1.1.1.1.1.1" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E10.m1.7.7.1.1.1.1.1.1.2" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.cmml"><msub id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2.2" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2.3" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.1" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.1.cmml">∣</mo><mrow id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.3.2" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.3.1.cmml"><mi id="Sx3.E10.m1.4.4" xref="Sx3.E10.m1.4.4.cmml">I</mi><mo id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.3.2.1" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="Sx3.E10.m1.5.5" xref="Sx3.E10.m1.5.5.cmml">q</mi><mo lspace="0.170em" id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.3.2.2" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">;</mo><mi mathvariant="normal" id="Sx3.E10.m1.6.6" xref="Sx3.E10.m1.6.6.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="Sx3.E10.m1.7.7.1.1.1.1.1.1.3" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="Sx3.E10.m1.7.7.1.2" xref="Sx3.E10.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E10.m1.7b"><apply id="Sx3.E10.m1.7.7.1.1.cmml" xref="Sx3.E10.m1.7.7.1"><eq id="Sx3.E10.m1.7.7.1.1.2.cmml" xref="Sx3.E10.m1.7.7.1.1.2"></eq><apply id="Sx3.E10.m1.7.7.1.1.3.cmml" xref="Sx3.E10.m1.7.7.1.1.3"><times id="Sx3.E10.m1.7.7.1.1.3.1.cmml" xref="Sx3.E10.m1.7.7.1.1.3.1"></times><apply id="Sx3.E10.m1.7.7.1.1.3.2.cmml" xref="Sx3.E10.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="Sx3.E10.m1.7.7.1.1.3.2.1.cmml" xref="Sx3.E10.m1.7.7.1.1.3.2">subscript</csymbol><ci id="Sx3.E10.m1.7.7.1.1.3.2.2.cmml" xref="Sx3.E10.m1.7.7.1.1.3.2.2">𝐿</ci><apply id="Sx3.E10.m1.7.7.1.1.3.2.3.cmml" xref="Sx3.E10.m1.7.7.1.1.3.2.3"><times id="Sx3.E10.m1.7.7.1.1.3.2.3.1.cmml" xref="Sx3.E10.m1.7.7.1.1.3.2.3.1"></times><ci id="Sx3.E10.m1.7.7.1.1.3.2.3.2.cmml" xref="Sx3.E10.m1.7.7.1.1.3.2.3.2">𝑐</ci><ci id="Sx3.E10.m1.7.7.1.1.3.2.3.3.cmml" xref="Sx3.E10.m1.7.7.1.1.3.2.3.3">𝑙</ci><ci id="Sx3.E10.m1.7.7.1.1.3.2.3.4.cmml" xref="Sx3.E10.m1.7.7.1.1.3.2.3.4">𝑠</ci></apply></apply><vector id="Sx3.E10.m1.7.7.1.1.3.3.1.cmml" xref="Sx3.E10.m1.7.7.1.1.3.3.2"><ci id="Sx3.E10.m1.1.1.cmml" xref="Sx3.E10.m1.1.1">𝐼</ci><ci id="Sx3.E10.m1.2.2.cmml" xref="Sx3.E10.m1.2.2">𝑞</ci><ci id="Sx3.E10.m1.3.3.cmml" xref="Sx3.E10.m1.3.3">𝐴</ci></vector></apply><apply id="Sx3.E10.m1.7.7.1.1.1.cmml" xref="Sx3.E10.m1.7.7.1.1.1"><minus id="Sx3.E10.m1.7.7.1.1.1.2.cmml" xref="Sx3.E10.m1.7.7.1.1.1.2"></minus><apply id="Sx3.E10.m1.7.7.1.1.1.3.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3"><times id="Sx3.E10.m1.7.7.1.1.1.3.1.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.1"></times><apply id="Sx3.E10.m1.7.7.1.1.1.3.2.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.2"><divide id="Sx3.E10.m1.7.7.1.1.1.3.2.1.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.2"></divide><cn type="integer" id="Sx3.E10.m1.7.7.1.1.1.3.2.2.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.2.2">1</cn><ci id="Sx3.E10.m1.7.7.1.1.1.3.2.3.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.2.3">𝐾</ci></apply><apply id="Sx3.E10.m1.7.7.1.1.1.3.3.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.E10.m1.7.7.1.1.1.3.3.1.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.3">superscript</csymbol><apply id="Sx3.E10.m1.7.7.1.1.1.3.3.2.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.E10.m1.7.7.1.1.1.3.3.2.1.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.3">subscript</csymbol><sum id="Sx3.E10.m1.7.7.1.1.1.3.3.2.2.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.3.2.2"></sum><apply id="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.3.2.3"><eq id="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.1.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.1"></eq><ci id="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.2.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.2">𝑘</ci><cn type="integer" id="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.3.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="Sx3.E10.m1.7.7.1.1.1.3.3.3.cmml" xref="Sx3.E10.m1.7.7.1.1.1.3.3.3">𝐾</ci></apply></apply><apply id="Sx3.E10.m1.7.7.1.1.1.1.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1"><times id="Sx3.E10.m1.7.7.1.1.1.1.2.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1.2"></times><ci id="Sx3.E10.m1.7.7.1.1.1.1.3.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1.3">𝑙</ci><ci id="Sx3.E10.m1.7.7.1.1.1.1.4.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1.4">𝑜</ci><ci id="Sx3.E10.m1.7.7.1.1.1.1.5.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1.5">𝑔</ci><ci id="Sx3.E10.m1.7.7.1.1.1.1.6.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1.6">𝑝</ci><apply id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><list id="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E10.m1.7.7.1.1.1.1.1.1.1.3.2"><ci id="Sx3.E10.m1.4.4.cmml" xref="Sx3.E10.m1.4.4">𝐼</ci><ci id="Sx3.E10.m1.5.5.cmml" xref="Sx3.E10.m1.5.5">𝑞</ci><ci id="Sx3.E10.m1.6.6.cmml" xref="Sx3.E10.m1.6.6">Θ</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E10.m1.7c">L_{cls}(I,q,A)=\frac{1}{K}\sum_{k=1}^{K}-log\;p(a_{k}\mid I,q\,;\Theta).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.SSSx1.p3.13" class="ltx_p">Here, <math id="Sx3.SSx3.SSSx1.p3.8.m1.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.8.m1.1a"><mi mathvariant="normal" id="Sx3.SSx3.SSSx1.p3.8.m1.1.1" xref="Sx3.SSx3.SSSx1.p3.8.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.8.m1.1b"><ci id="Sx3.SSx3.SSSx1.p3.8.m1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.8.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.8.m1.1c">\Theta</annotation></semantics></math> represents all parameters in the model and <math id="Sx3.SSx3.SSSx1.p3.9.m2.1" class="ltx_Math" alttext="A\in Ans" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.9.m2.1a"><mrow id="Sx3.SSx3.SSSx1.p3.9.m2.1.1" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.cmml"><mi id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.2" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.2.cmml">A</mi><mo id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.1" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.1.cmml">∈</mo><mrow id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.cmml"><mi id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.2" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.1" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.3" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.1a" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.4" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.4.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.9.m2.1b"><apply id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1"><in id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.1"></in><ci id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.2.cmml" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.2">𝐴</ci><apply id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.cmml" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3"><times id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.1.cmml" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.1"></times><ci id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.2.cmml" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.2">𝐴</ci><ci id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.3.cmml" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.3">𝑛</ci><ci id="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.4.cmml" xref="Sx3.SSx3.SSSx1.p3.9.m2.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.9.m2.1c">A\in Ans</annotation></semantics></math>,
where <math id="Sx3.SSx3.SSSx1.p3.10.m3.4" class="ltx_Math" alttext="Ans=\{a_{1},a_{2},...,a_{K}\}" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.10.m3.4a"><mrow id="Sx3.SSx3.SSSx1.p3.10.m3.4.4" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.cmml"><mrow id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.cmml"><mi id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.2" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.1" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.1.cmml">​</mo><mi id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.3" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.1a" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.1.cmml">​</mo><mi id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.4" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.4.cmml">s</mi></mrow><mo id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.4" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.4.cmml">=</mo><mrow id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.4.cmml"><mo stretchy="false" id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.4" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.4.cmml">{</mo><msub id="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1" xref="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1.cmml"><mi id="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1.2" xref="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1.2.cmml">a</mi><mn id="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1.3" xref="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.5" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.4.cmml">,</mo><msub id="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2" xref="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2.cmml"><mi id="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2.2" xref="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2.2.cmml">a</mi><mn id="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2.3" xref="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.6" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx3.SSSx1.p3.10.m3.1.1" xref="Sx3.SSx3.SSSx1.p3.10.m3.1.1.cmml">…</mi><mo id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.7" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.4.cmml">,</mo><msub id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3.cmml"><mi id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3.2" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3.2.cmml">a</mi><mi id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3.3" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3.3.cmml">K</mi></msub><mo stretchy="false" id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.8" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.10.m3.4b"><apply id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4"><eq id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.4.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.4"></eq><apply id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5"><times id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.1.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.1"></times><ci id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.2.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.2">𝐴</ci><ci id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.3.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.3">𝑛</ci><ci id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.4.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.5.4">𝑠</ci></apply><set id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.4.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3"><apply id="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1">subscript</csymbol><ci id="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1.2.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1.2">𝑎</ci><cn type="integer" id="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1.3.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.2.2.1.1.1.3">1</cn></apply><apply id="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2.1.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2">subscript</csymbol><ci id="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2.2.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2.2">𝑎</ci><cn type="integer" id="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2.3.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.3.3.2.2.2.3">2</cn></apply><ci id="Sx3.SSx3.SSSx1.p3.10.m3.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.1.1">…</ci><apply id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3.1.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3">subscript</csymbol><ci id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3.2.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3.2">𝑎</ci><ci id="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3.3.cmml" xref="Sx3.SSx3.SSSx1.p3.10.m3.4.4.3.3.3.3">𝐾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.10.m3.4c">Ans=\{a_{1},a_{2},...,a_{K}\}</annotation></semantics></math> is the set of candidate answers, <math id="Sx3.SSx3.SSSx1.p3.11.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.11.m4.1a"><mi id="Sx3.SSx3.SSSx1.p3.11.m4.1.1" xref="Sx3.SSx3.SSSx1.p3.11.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.11.m4.1b"><ci id="Sx3.SSx3.SSSx1.p3.11.m4.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.11.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.11.m4.1c">K</annotation></semantics></math> is the size of the <math id="Sx3.SSx3.SSSx1.p3.12.m5.1" class="ltx_Math" alttext="Ans" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.12.m5.1a"><mrow id="Sx3.SSx3.SSSx1.p3.12.m5.1.1" xref="Sx3.SSx3.SSSx1.p3.12.m5.1.1.cmml"><mi id="Sx3.SSx3.SSSx1.p3.12.m5.1.1.2" xref="Sx3.SSx3.SSSx1.p3.12.m5.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.SSSx1.p3.12.m5.1.1.1" xref="Sx3.SSx3.SSSx1.p3.12.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx3.SSSx1.p3.12.m5.1.1.3" xref="Sx3.SSx3.SSSx1.p3.12.m5.1.1.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.SSSx1.p3.12.m5.1.1.1a" xref="Sx3.SSx3.SSSx1.p3.12.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx3.SSSx1.p3.12.m5.1.1.4" xref="Sx3.SSx3.SSSx1.p3.12.m5.1.1.4.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.12.m5.1b"><apply id="Sx3.SSx3.SSSx1.p3.12.m5.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.12.m5.1.1"><times id="Sx3.SSx3.SSSx1.p3.12.m5.1.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.12.m5.1.1.1"></times><ci id="Sx3.SSx3.SSSx1.p3.12.m5.1.1.2.cmml" xref="Sx3.SSx3.SSSx1.p3.12.m5.1.1.2">𝐴</ci><ci id="Sx3.SSx3.SSSx1.p3.12.m5.1.1.3.cmml" xref="Sx3.SSx3.SSSx1.p3.12.m5.1.1.3">𝑛</ci><ci id="Sx3.SSx3.SSSx1.p3.12.m5.1.1.4.cmml" xref="Sx3.SSx3.SSSx1.p3.12.m5.1.1.4">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.12.m5.1c">Ans</annotation></semantics></math>.
After training the model, the predicted answer of a given image-question pair <math id="Sx3.SSx3.SSSx1.p3.13.m6.2" class="ltx_Math" alttext="(I,q)" display="inline"><semantics id="Sx3.SSx3.SSSx1.p3.13.m6.2a"><mrow id="Sx3.SSx3.SSSx1.p3.13.m6.2.3.2" xref="Sx3.SSx3.SSSx1.p3.13.m6.2.3.1.cmml"><mo stretchy="false" id="Sx3.SSx3.SSSx1.p3.13.m6.2.3.2.1" xref="Sx3.SSx3.SSSx1.p3.13.m6.2.3.1.cmml">(</mo><mi id="Sx3.SSx3.SSSx1.p3.13.m6.1.1" xref="Sx3.SSx3.SSSx1.p3.13.m6.1.1.cmml">I</mi><mo id="Sx3.SSx3.SSSx1.p3.13.m6.2.3.2.2" xref="Sx3.SSx3.SSSx1.p3.13.m6.2.3.1.cmml">,</mo><mi id="Sx3.SSx3.SSSx1.p3.13.m6.2.2" xref="Sx3.SSx3.SSSx1.p3.13.m6.2.2.cmml">q</mi><mo stretchy="false" id="Sx3.SSx3.SSSx1.p3.13.m6.2.3.2.3" xref="Sx3.SSx3.SSSx1.p3.13.m6.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx1.p3.13.m6.2b"><interval closure="open" id="Sx3.SSx3.SSSx1.p3.13.m6.2.3.1.cmml" xref="Sx3.SSx3.SSSx1.p3.13.m6.2.3.2"><ci id="Sx3.SSx3.SSSx1.p3.13.m6.1.1.cmml" xref="Sx3.SSx3.SSSx1.p3.13.m6.1.1">𝐼</ci><ci id="Sx3.SSx3.SSSx1.p3.13.m6.2.2.cmml" xref="Sx3.SSx3.SSSx1.p3.13.m6.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx1.p3.13.m6.2c">(I,q)</annotation></semantics></math> is</p>
<table id="Sx3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E11.m1.4" class="ltx_Math" alttext="\hat{a}=\mathrm{{argmax}}\;p(a\mid I,q;\Theta)." display="block"><semantics id="Sx3.E11.m1.4a"><mrow id="Sx3.E11.m1.4.4.1" xref="Sx3.E11.m1.4.4.1.1.cmml"><mrow id="Sx3.E11.m1.4.4.1.1" xref="Sx3.E11.m1.4.4.1.1.cmml"><mover accent="true" id="Sx3.E11.m1.4.4.1.1.3" xref="Sx3.E11.m1.4.4.1.1.3.cmml"><mi id="Sx3.E11.m1.4.4.1.1.3.2" xref="Sx3.E11.m1.4.4.1.1.3.2.cmml">a</mi><mo id="Sx3.E11.m1.4.4.1.1.3.1" xref="Sx3.E11.m1.4.4.1.1.3.1.cmml">^</mo></mover><mo id="Sx3.E11.m1.4.4.1.1.2" xref="Sx3.E11.m1.4.4.1.1.2.cmml">=</mo><mrow id="Sx3.E11.m1.4.4.1.1.1" xref="Sx3.E11.m1.4.4.1.1.1.cmml"><mi id="Sx3.E11.m1.4.4.1.1.1.3" xref="Sx3.E11.m1.4.4.1.1.1.3.cmml">argmax</mi><mo lspace="0.280em" rspace="0em" id="Sx3.E11.m1.4.4.1.1.1.2" xref="Sx3.E11.m1.4.4.1.1.1.2.cmml">​</mo><mi id="Sx3.E11.m1.4.4.1.1.1.4" xref="Sx3.E11.m1.4.4.1.1.1.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E11.m1.4.4.1.1.1.2a" xref="Sx3.E11.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="Sx3.E11.m1.4.4.1.1.1.1.1" xref="Sx3.E11.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E11.m1.4.4.1.1.1.1.1.2" xref="Sx3.E11.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E11.m1.4.4.1.1.1.1.1.1" xref="Sx3.E11.m1.4.4.1.1.1.1.1.1.cmml"><mi id="Sx3.E11.m1.4.4.1.1.1.1.1.1.2" xref="Sx3.E11.m1.4.4.1.1.1.1.1.1.2.cmml">a</mi><mo id="Sx3.E11.m1.4.4.1.1.1.1.1.1.1" xref="Sx3.E11.m1.4.4.1.1.1.1.1.1.1.cmml">∣</mo><mrow id="Sx3.E11.m1.4.4.1.1.1.1.1.1.3.2" xref="Sx3.E11.m1.4.4.1.1.1.1.1.1.3.1.cmml"><mi id="Sx3.E11.m1.1.1" xref="Sx3.E11.m1.1.1.cmml">I</mi><mo id="Sx3.E11.m1.4.4.1.1.1.1.1.1.3.2.1" xref="Sx3.E11.m1.4.4.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="Sx3.E11.m1.2.2" xref="Sx3.E11.m1.2.2.cmml">q</mi><mo id="Sx3.E11.m1.4.4.1.1.1.1.1.1.3.2.2" xref="Sx3.E11.m1.4.4.1.1.1.1.1.1.3.1.cmml">;</mo><mi mathvariant="normal" id="Sx3.E11.m1.3.3" xref="Sx3.E11.m1.3.3.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="Sx3.E11.m1.4.4.1.1.1.1.1.3" xref="Sx3.E11.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="Sx3.E11.m1.4.4.1.2" xref="Sx3.E11.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E11.m1.4b"><apply id="Sx3.E11.m1.4.4.1.1.cmml" xref="Sx3.E11.m1.4.4.1"><eq id="Sx3.E11.m1.4.4.1.1.2.cmml" xref="Sx3.E11.m1.4.4.1.1.2"></eq><apply id="Sx3.E11.m1.4.4.1.1.3.cmml" xref="Sx3.E11.m1.4.4.1.1.3"><ci id="Sx3.E11.m1.4.4.1.1.3.1.cmml" xref="Sx3.E11.m1.4.4.1.1.3.1">^</ci><ci id="Sx3.E11.m1.4.4.1.1.3.2.cmml" xref="Sx3.E11.m1.4.4.1.1.3.2">𝑎</ci></apply><apply id="Sx3.E11.m1.4.4.1.1.1.cmml" xref="Sx3.E11.m1.4.4.1.1.1"><times id="Sx3.E11.m1.4.4.1.1.1.2.cmml" xref="Sx3.E11.m1.4.4.1.1.1.2"></times><ci id="Sx3.E11.m1.4.4.1.1.1.3.cmml" xref="Sx3.E11.m1.4.4.1.1.1.3">argmax</ci><ci id="Sx3.E11.m1.4.4.1.1.1.4.cmml" xref="Sx3.E11.m1.4.4.1.1.1.4">𝑝</ci><apply id="Sx3.E11.m1.4.4.1.1.1.1.1.1.cmml" xref="Sx3.E11.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="Sx3.E11.m1.4.4.1.1.1.1.1.1.1.cmml" xref="Sx3.E11.m1.4.4.1.1.1.1.1.1.1">conditional</csymbol><ci id="Sx3.E11.m1.4.4.1.1.1.1.1.1.2.cmml" xref="Sx3.E11.m1.4.4.1.1.1.1.1.1.2">𝑎</ci><list id="Sx3.E11.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E11.m1.4.4.1.1.1.1.1.1.3.2"><ci id="Sx3.E11.m1.1.1.cmml" xref="Sx3.E11.m1.1.1">𝐼</ci><ci id="Sx3.E11.m1.2.2.cmml" xref="Sx3.E11.m1.2.2">𝑞</ci><ci id="Sx3.E11.m1.3.3.cmml" xref="Sx3.E11.m1.3.3">Θ</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E11.m1.4c">\hat{a}=\mathrm{{argmax}}\;p(a\mid I,q;\Theta).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="Sx3.SSx3.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Supervised attention model</h4>

<div id="Sx3.SSx3.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx3.SSSx2.p1.1" class="ltx_p"> In the mentioned MLB model, attention maps are learned without any supervision,
which may lead to inaccurate attention maps, as shown in Fig.<a href="#Sx4.F5" title="Figure 5 ‣ Attention-based model for VQA ‣ Experiment ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
In order to remedy this problem, attention supervision is added to the unsupervised attention model.
In this way, the attention maps that are generated during training can explicitly learn from the ground truth.</p>
</div>
<div id="Sx3.SSx3.SSSx2.p2" class="ltx_para">
<p id="Sx3.SSx3.SSSx2.p2.1" class="ltx_p">Specifically, to train the human-like attention supervised model, the ground truth of the attention maps is needed.
However, the human-labeled attention maps in the VQA-HAT dataset is not sufficient and manually annotating a new attention dataset is an expensive and time-consuming task.
Therefore, the pre-trained HAN is used to generate attention maps for all the image-question pairs in the VQA v2.0 dataset.
The generated attention map dataset for the VQA v2.0 dataset is named as Human-Like ATtention (HLAT) dataset.
Fig.<a href="#Sx4.F4" title="Figure 4 ‣ Human Attention Network (HAN) ‣ Experiment ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the comparison between the human attention and the human-like attention generated by the HAN.
As it can be observed, the HAN-generated attention share similar attentive areas with the human attention,
showing the promising results of using human-like attention as the ground truth for the attention learned in the models.
Therefore, the HLAT is used for training the proposed supervised attention model.
Fig.<a href="#Sx3.F3" title="Figure 3 ‣ Objective function ‣ Human Attention Network ‣ Approach ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the structure of the proposed supervised attention model.</p>
</div>
<div id="Sx3.SSx3.SSSx2.p3" class="ltx_para">
<p id="Sx3.SSx3.SSSx2.p3.5" class="ltx_p">More formally, the triplet <math id="Sx3.SSx3.SSSx2.p3.1.m1.3" class="ltx_Math" alttext="(I,q,A)" display="inline"><semantics id="Sx3.SSx3.SSSx2.p3.1.m1.3a"><mrow id="Sx3.SSx3.SSSx2.p3.1.m1.3.4.2" xref="Sx3.SSx3.SSSx2.p3.1.m1.3.4.1.cmml"><mo stretchy="false" id="Sx3.SSx3.SSSx2.p3.1.m1.3.4.2.1" xref="Sx3.SSx3.SSSx2.p3.1.m1.3.4.1.cmml">(</mo><mi id="Sx3.SSx3.SSSx2.p3.1.m1.1.1" xref="Sx3.SSx3.SSSx2.p3.1.m1.1.1.cmml">I</mi><mo id="Sx3.SSx3.SSSx2.p3.1.m1.3.4.2.2" xref="Sx3.SSx3.SSSx2.p3.1.m1.3.4.1.cmml">,</mo><mi id="Sx3.SSx3.SSSx2.p3.1.m1.2.2" xref="Sx3.SSx3.SSSx2.p3.1.m1.2.2.cmml">q</mi><mo id="Sx3.SSx3.SSSx2.p3.1.m1.3.4.2.3" xref="Sx3.SSx3.SSSx2.p3.1.m1.3.4.1.cmml">,</mo><mi id="Sx3.SSx3.SSSx2.p3.1.m1.3.3" xref="Sx3.SSx3.SSSx2.p3.1.m1.3.3.cmml">A</mi><mo stretchy="false" id="Sx3.SSx3.SSSx2.p3.1.m1.3.4.2.4" xref="Sx3.SSx3.SSSx2.p3.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p3.1.m1.3b"><vector id="Sx3.SSx3.SSSx2.p3.1.m1.3.4.1.cmml" xref="Sx3.SSx3.SSSx2.p3.1.m1.3.4.2"><ci id="Sx3.SSx3.SSSx2.p3.1.m1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.1.m1.1.1">𝐼</ci><ci id="Sx3.SSx3.SSSx2.p3.1.m1.2.2.cmml" xref="Sx3.SSx3.SSSx2.p3.1.m1.2.2">𝑞</ci><ci id="Sx3.SSx3.SSSx2.p3.1.m1.3.3.cmml" xref="Sx3.SSx3.SSSx2.p3.1.m1.3.3">𝐴</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p3.1.m1.3c">(I,q,A)</annotation></semantics></math> in the VQA v2.0 dataset is extended to <math id="Sx3.SSx3.SSSx2.p3.2.m2.4" class="ltx_Math" alttext="(I,q,A,\alpha_{h}^{\prime})" display="inline"><semantics id="Sx3.SSx3.SSSx2.p3.2.m2.4a"><mrow id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.2.cmml"><mo stretchy="false" id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.2" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.2.cmml">(</mo><mi id="Sx3.SSx3.SSSx2.p3.2.m2.1.1" xref="Sx3.SSx3.SSSx2.p3.2.m2.1.1.cmml">I</mi><mo id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.3" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.2.cmml">,</mo><mi id="Sx3.SSx3.SSSx2.p3.2.m2.2.2" xref="Sx3.SSx3.SSSx2.p3.2.m2.2.2.cmml">q</mi><mo id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.4" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.2.cmml">,</mo><mi id="Sx3.SSx3.SSSx2.p3.2.m2.3.3" xref="Sx3.SSx3.SSSx2.p3.2.m2.3.3.cmml">A</mi><mo id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.5" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.2.cmml">,</mo><msubsup id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.cmml"><mi id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.2.2" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.2.2.cmml">α</mi><mi id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.2.3" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.2.3.cmml">h</mi><mo id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.3" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.6" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p3.2.m2.4b"><vector id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.2.cmml" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1"><ci id="Sx3.SSx3.SSSx2.p3.2.m2.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.2.m2.1.1">𝐼</ci><ci id="Sx3.SSx3.SSSx2.p3.2.m2.2.2.cmml" xref="Sx3.SSx3.SSSx2.p3.2.m2.2.2">𝑞</ci><ci id="Sx3.SSx3.SSSx2.p3.2.m2.3.3.cmml" xref="Sx3.SSx3.SSSx2.p3.2.m2.3.3">𝐴</ci><apply id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1">superscript</csymbol><apply id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.2.cmml" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.2.1.cmml" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1">subscript</csymbol><ci id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.2.2.cmml" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.2.2">𝛼</ci><ci id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.2.3.cmml" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.2.3">ℎ</ci></apply><ci id="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.3.cmml" xref="Sx3.SSx3.SSSx2.p3.2.m2.4.4.1.1.3">′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p3.2.m2.4c">(I,q,A,\alpha_{h}^{\prime})</annotation></semantics></math>,
where <math id="Sx3.SSx3.SSSx2.p3.3.m3.1" class="ltx_Math" alttext="\alpha_{h}^{\prime}" display="inline"><semantics id="Sx3.SSx3.SSSx2.p3.3.m3.1a"><msubsup id="Sx3.SSx3.SSSx2.p3.3.m3.1.1" xref="Sx3.SSx3.SSSx2.p3.3.m3.1.1.cmml"><mi id="Sx3.SSx3.SSSx2.p3.3.m3.1.1.2.2" xref="Sx3.SSx3.SSSx2.p3.3.m3.1.1.2.2.cmml">α</mi><mi id="Sx3.SSx3.SSSx2.p3.3.m3.1.1.2.3" xref="Sx3.SSx3.SSSx2.p3.3.m3.1.1.2.3.cmml">h</mi><mo id="Sx3.SSx3.SSSx2.p3.3.m3.1.1.3" xref="Sx3.SSx3.SSSx2.p3.3.m3.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p3.3.m3.1b"><apply id="Sx3.SSx3.SSSx2.p3.3.m3.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.3.m3.1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.3.m3.1.1">superscript</csymbol><apply id="Sx3.SSx3.SSSx2.p3.3.m3.1.1.2.cmml" xref="Sx3.SSx3.SSSx2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.3.m3.1.1.2.1.cmml" xref="Sx3.SSx3.SSSx2.p3.3.m3.1.1">subscript</csymbol><ci id="Sx3.SSx3.SSSx2.p3.3.m3.1.1.2.2.cmml" xref="Sx3.SSx3.SSSx2.p3.3.m3.1.1.2.2">𝛼</ci><ci id="Sx3.SSx3.SSSx2.p3.3.m3.1.1.2.3.cmml" xref="Sx3.SSx3.SSSx2.p3.3.m3.1.1.2.3">ℎ</ci></apply><ci id="Sx3.SSx3.SSSx2.p3.3.m3.1.1.3.cmml" xref="Sx3.SSx3.SSSx2.p3.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p3.3.m3.1c">\alpha_{h}^{\prime}</annotation></semantics></math> is the generated human-like attention map corresponding to the image-question pair <math id="Sx3.SSx3.SSSx2.p3.4.m4.2" class="ltx_Math" alttext="(I,q)" display="inline"><semantics id="Sx3.SSx3.SSSx2.p3.4.m4.2a"><mrow id="Sx3.SSx3.SSSx2.p3.4.m4.2.3.2" xref="Sx3.SSx3.SSSx2.p3.4.m4.2.3.1.cmml"><mo stretchy="false" id="Sx3.SSx3.SSSx2.p3.4.m4.2.3.2.1" xref="Sx3.SSx3.SSSx2.p3.4.m4.2.3.1.cmml">(</mo><mi id="Sx3.SSx3.SSSx2.p3.4.m4.1.1" xref="Sx3.SSx3.SSSx2.p3.4.m4.1.1.cmml">I</mi><mo id="Sx3.SSx3.SSSx2.p3.4.m4.2.3.2.2" xref="Sx3.SSx3.SSSx2.p3.4.m4.2.3.1.cmml">,</mo><mi id="Sx3.SSx3.SSSx2.p3.4.m4.2.2" xref="Sx3.SSx3.SSSx2.p3.4.m4.2.2.cmml">q</mi><mo stretchy="false" id="Sx3.SSx3.SSSx2.p3.4.m4.2.3.2.3" xref="Sx3.SSx3.SSSx2.p3.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p3.4.m4.2b"><interval closure="open" id="Sx3.SSx3.SSSx2.p3.4.m4.2.3.1.cmml" xref="Sx3.SSx3.SSSx2.p3.4.m4.2.3.2"><ci id="Sx3.SSx3.SSSx2.p3.4.m4.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.4.m4.1.1">𝐼</ci><ci id="Sx3.SSx3.SSSx2.p3.4.m4.2.2.cmml" xref="Sx3.SSx3.SSSx2.p3.4.m4.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p3.4.m4.2c">(I,q)</annotation></semantics></math>.
In order to employ attention supervision,
a GRU is first employed to encode the sequence of attention maps <math id="Sx3.SSx3.SSSx2.p3.5.m5.4" class="ltx_Math" alttext="\alpha=\{\alpha_{1},\alpha_{2},...,\alpha_{G}\}" display="inline"><semantics id="Sx3.SSx3.SSSx2.p3.5.m5.4a"><mrow id="Sx3.SSx3.SSSx2.p3.5.m5.4.4" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.cmml"><mi id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.5" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.5.cmml">α</mi><mo id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.4" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.4.cmml">=</mo><mrow id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.4.cmml"><mo stretchy="false" id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.4" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.4.cmml">{</mo><msub id="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1" xref="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1.cmml"><mi id="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1.2" xref="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1.2.cmml">α</mi><mn id="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1.3" xref="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.5" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.4.cmml">,</mo><msub id="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2" xref="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2.cmml"><mi id="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2.2" xref="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2.2.cmml">α</mi><mn id="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2.3" xref="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2.3.cmml">2</mn></msub><mo id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.6" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx3.SSSx2.p3.5.m5.1.1" xref="Sx3.SSx3.SSSx2.p3.5.m5.1.1.cmml">…</mi><mo id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.7" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.4.cmml">,</mo><msub id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3.cmml"><mi id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3.2" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3.2.cmml">α</mi><mi id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3.3" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3.3.cmml">G</mi></msub><mo stretchy="false" id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.8" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p3.5.m5.4b"><apply id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4"><eq id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.4.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.4"></eq><ci id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.5.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.5">𝛼</ci><set id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.4.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3"><apply id="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1">subscript</csymbol><ci id="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1.2.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1.2">𝛼</ci><cn type="integer" id="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1.3.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.2.2.1.1.1.3">1</cn></apply><apply id="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2.1.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2">subscript</csymbol><ci id="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2.2.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2.2">𝛼</ci><cn type="integer" id="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2.3.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.3.3.2.2.2.3">2</cn></apply><ci id="Sx3.SSx3.SSSx2.p3.5.m5.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.1.1">…</ci><apply id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3.1.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3">subscript</csymbol><ci id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3.2.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3.2">𝛼</ci><ci id="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3.3.cmml" xref="Sx3.SSx3.SSSx2.p3.5.m5.4.4.3.3.3.3">𝐺</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p3.5.m5.4c">\alpha=\{\alpha_{1},\alpha_{2},...,\alpha_{G}\}</annotation></semantics></math> that is generated in the MLB to get a refined attention map.
The output is then fed to a linear layer followed by a softmax layer to produce attention probabilities over the image.
The attention supervision loss is computed by</p>
<table id="Sx3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E12.m1.4" class="ltx_Math" alttext="L_{att}(I,q,\alpha_{h}^{\prime})=(softmax(W_{h}\cdot h_{GRU}(\alpha)+b_{h})-\alpha_{h}^{\prime})^{2}," display="block"><semantics id="Sx3.E12.m1.4a"><mrow id="Sx3.E12.m1.4.4.1" xref="Sx3.E12.m1.4.4.1.1.cmml"><mrow id="Sx3.E12.m1.4.4.1.1" xref="Sx3.E12.m1.4.4.1.1.cmml"><mrow id="Sx3.E12.m1.4.4.1.1.1" xref="Sx3.E12.m1.4.4.1.1.1.cmml"><msub id="Sx3.E12.m1.4.4.1.1.1.3" xref="Sx3.E12.m1.4.4.1.1.1.3.cmml"><mi id="Sx3.E12.m1.4.4.1.1.1.3.2" xref="Sx3.E12.m1.4.4.1.1.1.3.2.cmml">L</mi><mrow id="Sx3.E12.m1.4.4.1.1.1.3.3" xref="Sx3.E12.m1.4.4.1.1.1.3.3.cmml"><mi id="Sx3.E12.m1.4.4.1.1.1.3.3.2" xref="Sx3.E12.m1.4.4.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.1.3.3.1" xref="Sx3.E12.m1.4.4.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E12.m1.4.4.1.1.1.3.3.3" xref="Sx3.E12.m1.4.4.1.1.1.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.1.3.3.1a" xref="Sx3.E12.m1.4.4.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E12.m1.4.4.1.1.1.3.3.4" xref="Sx3.E12.m1.4.4.1.1.1.3.3.4.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.1.2" xref="Sx3.E12.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="Sx3.E12.m1.4.4.1.1.1.1.1" xref="Sx3.E12.m1.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E12.m1.4.4.1.1.1.1.1.2" xref="Sx3.E12.m1.4.4.1.1.1.1.2.cmml">(</mo><mi id="Sx3.E12.m1.1.1" xref="Sx3.E12.m1.1.1.cmml">I</mi><mo id="Sx3.E12.m1.4.4.1.1.1.1.1.3" xref="Sx3.E12.m1.4.4.1.1.1.1.2.cmml">,</mo><mi id="Sx3.E12.m1.2.2" xref="Sx3.E12.m1.2.2.cmml">q</mi><mo id="Sx3.E12.m1.4.4.1.1.1.1.1.4" xref="Sx3.E12.m1.4.4.1.1.1.1.2.cmml">,</mo><msubsup id="Sx3.E12.m1.4.4.1.1.1.1.1.1" xref="Sx3.E12.m1.4.4.1.1.1.1.1.1.cmml"><mi id="Sx3.E12.m1.4.4.1.1.1.1.1.1.2.2" xref="Sx3.E12.m1.4.4.1.1.1.1.1.1.2.2.cmml">α</mi><mi id="Sx3.E12.m1.4.4.1.1.1.1.1.1.2.3" xref="Sx3.E12.m1.4.4.1.1.1.1.1.1.2.3.cmml">h</mi><mo id="Sx3.E12.m1.4.4.1.1.1.1.1.1.3" xref="Sx3.E12.m1.4.4.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="Sx3.E12.m1.4.4.1.1.1.1.1.5" xref="Sx3.E12.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx3.E12.m1.4.4.1.1.3" xref="Sx3.E12.m1.4.4.1.1.3.cmml">=</mo><msup id="Sx3.E12.m1.4.4.1.1.2" xref="Sx3.E12.m1.4.4.1.1.2.cmml"><mrow id="Sx3.E12.m1.4.4.1.1.2.1.1" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.E12.m1.4.4.1.1.2.1.1.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.cmml">(</mo><mrow id="Sx3.E12.m1.4.4.1.1.2.1.1.1" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.cmml"><mrow id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.cmml"><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.3" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.4" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2a" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.5" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2b" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.6" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2c" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.7" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2d" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.8" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2e" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.9" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2f" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.cmml"><mrow id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.cmml"><msub id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2.2.cmml">W</mi><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2.3" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2.3.cmml">h</mi></msub><mo lspace="0.222em" rspace="0.222em" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.1" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.1.cmml">⋅</mo><msub id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.2.cmml">h</mi><mrow id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.cmml"><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.1" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.1.cmml">​</mo><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.3" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.1a" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.1.cmml">​</mo><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.4" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.4.cmml">U</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.1" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.3.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.3.2.1" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="Sx3.E12.m1.3.3" xref="Sx3.E12.m1.3.3.cmml">α</mi><mo stretchy="false" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.3.2.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.1" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.3" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.3.cmml">h</mi></msub></mrow><mo stretchy="false" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.3" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E12.m1.4.4.1.1.2.1.1.1.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.2.cmml">−</mo><msubsup id="Sx3.E12.m1.4.4.1.1.2.1.1.1.3" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.cmml"><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.2.2" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.2.2.cmml">α</mi><mi id="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.2.3" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.2.3.cmml">h</mi><mo id="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.3" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.3.cmml">′</mo></msubsup></mrow><mo stretchy="false" id="Sx3.E12.m1.4.4.1.1.2.1.1.3" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.cmml">)</mo></mrow><mn id="Sx3.E12.m1.4.4.1.1.2.3" xref="Sx3.E12.m1.4.4.1.1.2.3.cmml">2</mn></msup></mrow><mo id="Sx3.E12.m1.4.4.1.2" xref="Sx3.E12.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E12.m1.4b"><apply id="Sx3.E12.m1.4.4.1.1.cmml" xref="Sx3.E12.m1.4.4.1"><eq id="Sx3.E12.m1.4.4.1.1.3.cmml" xref="Sx3.E12.m1.4.4.1.1.3"></eq><apply id="Sx3.E12.m1.4.4.1.1.1.cmml" xref="Sx3.E12.m1.4.4.1.1.1"><times id="Sx3.E12.m1.4.4.1.1.1.2.cmml" xref="Sx3.E12.m1.4.4.1.1.1.2"></times><apply id="Sx3.E12.m1.4.4.1.1.1.3.cmml" xref="Sx3.E12.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E12.m1.4.4.1.1.1.3.1.cmml" xref="Sx3.E12.m1.4.4.1.1.1.3">subscript</csymbol><ci id="Sx3.E12.m1.4.4.1.1.1.3.2.cmml" xref="Sx3.E12.m1.4.4.1.1.1.3.2">𝐿</ci><apply id="Sx3.E12.m1.4.4.1.1.1.3.3.cmml" xref="Sx3.E12.m1.4.4.1.1.1.3.3"><times id="Sx3.E12.m1.4.4.1.1.1.3.3.1.cmml" xref="Sx3.E12.m1.4.4.1.1.1.3.3.1"></times><ci id="Sx3.E12.m1.4.4.1.1.1.3.3.2.cmml" xref="Sx3.E12.m1.4.4.1.1.1.3.3.2">𝑎</ci><ci id="Sx3.E12.m1.4.4.1.1.1.3.3.3.cmml" xref="Sx3.E12.m1.4.4.1.1.1.3.3.3">𝑡</ci><ci id="Sx3.E12.m1.4.4.1.1.1.3.3.4.cmml" xref="Sx3.E12.m1.4.4.1.1.1.3.3.4">𝑡</ci></apply></apply><vector id="Sx3.E12.m1.4.4.1.1.1.1.2.cmml" xref="Sx3.E12.m1.4.4.1.1.1.1.1"><ci id="Sx3.E12.m1.1.1.cmml" xref="Sx3.E12.m1.1.1">𝐼</ci><ci id="Sx3.E12.m1.2.2.cmml" xref="Sx3.E12.m1.2.2">𝑞</ci><apply id="Sx3.E12.m1.4.4.1.1.1.1.1.1.cmml" xref="Sx3.E12.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E12.m1.4.4.1.1.1.1.1.1.1.cmml" xref="Sx3.E12.m1.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.E12.m1.4.4.1.1.1.1.1.1.2.cmml" xref="Sx3.E12.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E12.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E12.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E12.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E12.m1.4.4.1.1.1.1.1.1.2.2">𝛼</ci><ci id="Sx3.E12.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E12.m1.4.4.1.1.1.1.1.1.2.3">ℎ</ci></apply><ci id="Sx3.E12.m1.4.4.1.1.1.1.1.1.3.cmml" xref="Sx3.E12.m1.4.4.1.1.1.1.1.1.3">′</ci></apply></vector></apply><apply id="Sx3.E12.m1.4.4.1.1.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="Sx3.E12.m1.4.4.1.1.2.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2">superscript</csymbol><apply id="Sx3.E12.m1.4.4.1.1.2.1.1.1.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1"><minus id="Sx3.E12.m1.4.4.1.1.2.1.1.1.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.2"></minus><apply id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1"><times id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.2"></times><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.3.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.3">𝑠</ci><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.4.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.4">𝑜</ci><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.5.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.5">𝑓</ci><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.6.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.6">𝑡</ci><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.7.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.7">𝑚</ci><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.8.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.8">𝑎</ci><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.9.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.9">𝑥</ci><apply id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1"><plus id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.1"></plus><apply id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2"><times id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.1"></times><apply id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2"><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.1">⋅</ci><apply id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2.2">𝑊</ci><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.2.3">ℎ</ci></apply><apply id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.2">ℎ</ci><apply id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3"><times id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.1"></times><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.2">𝐺</ci><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.3">𝑅</ci><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.4.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.2.3.3.4">𝑈</ci></apply></apply></apply><ci id="Sx3.E12.m1.3.3.cmml" xref="Sx3.E12.m1.3.3">𝛼</ci></apply><apply id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.3">ℎ</ci></apply></apply></apply><apply id="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.1.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.3">superscript</csymbol><apply id="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.2.1.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.3">subscript</csymbol><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.2.2.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.2.2">𝛼</ci><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.2.3.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.2.3">ℎ</ci></apply><ci id="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.3.cmml" xref="Sx3.E12.m1.4.4.1.1.2.1.1.1.3.3">′</ci></apply></apply><cn type="integer" id="Sx3.E12.m1.4.4.1.1.2.3.cmml" xref="Sx3.E12.m1.4.4.1.1.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E12.m1.4c">L_{att}(I,q,\alpha_{h}^{\prime})=(softmax(W_{h}\cdot h_{GRU}(\alpha)+b_{h})-\alpha_{h}^{\prime})^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.SSSx2.p3.9" class="ltx_p">where <math id="Sx3.SSx3.SSSx2.p3.6.m1.1" class="ltx_Math" alttext="W_{h}\in\mathbbm{R}^{l^{2}\times p}" display="inline"><semantics id="Sx3.SSx3.SSSx2.p3.6.m1.1a"><mrow id="Sx3.SSx3.SSSx2.p3.6.m1.1.1" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.cmml"><msub id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2.cmml"><mi id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2.2" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2.2.cmml">W</mi><mi id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2.3" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2.3.cmml">h</mi></msub><mo id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.1" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.1.cmml">∈</mo><msup id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.cmml"><mi id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.2" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.cmml"><msup id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2.cmml"><mi id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2.2" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2.2.cmml">l</mi><mn id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2.3" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2.3.cmml">2</mn></msup><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.1" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.3" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.3.cmml">p</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p3.6.m1.1b"><apply id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1"><in id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.1"></in><apply id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2.1.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2">subscript</csymbol><ci id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2.2.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2.2">𝑊</ci><ci id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2.3.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.2.3">ℎ</ci></apply><apply id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.1.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3">superscript</csymbol><ci id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.2.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.2">ℝ</ci><apply id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3"><times id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.1.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.1"></times><apply id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2.1.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2">superscript</csymbol><ci id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2.2.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2.2">𝑙</ci><cn type="integer" id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2.3.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.2.3">2</cn></apply><ci id="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.3.cmml" xref="Sx3.SSx3.SSSx2.p3.6.m1.1.1.3.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p3.6.m1.1c">W_{h}\in\mathbbm{R}^{l^{2}\times p}</annotation></semantics></math> is an affine transformation matrix, <math id="Sx3.SSx3.SSSx2.p3.7.m2.1" class="ltx_Math" alttext="b_{h}\in\mathbbm{R}^{l^{2}}" display="inline"><semantics id="Sx3.SSx3.SSSx2.p3.7.m2.1a"><mrow id="Sx3.SSx3.SSSx2.p3.7.m2.1.1" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.cmml"><msub id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2.cmml"><mi id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2.2" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2.2.cmml">b</mi><mi id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2.3" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2.3.cmml">h</mi></msub><mo id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.1" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.1.cmml">∈</mo><msup id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.cmml"><mi id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.2" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.2.cmml">ℝ</mi><msup id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3.cmml"><mi id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3.2" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3.2.cmml">l</mi><mn id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3.3" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3.3.cmml">2</mn></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p3.7.m2.1b"><apply id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1"><in id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.1"></in><apply id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2.1.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2">subscript</csymbol><ci id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2.2.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2.2">𝑏</ci><ci id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2.3.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.2.3">ℎ</ci></apply><apply id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.1.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3">superscript</csymbol><ci id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.2.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.2">ℝ</ci><apply id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3.1.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3">superscript</csymbol><ci id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3.2.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3.2">𝑙</ci><cn type="integer" id="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3.3.cmml" xref="Sx3.SSx3.SSSx2.p3.7.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p3.7.m2.1c">b_{h}\in\mathbbm{R}^{l^{2}}</annotation></semantics></math> is a bias term and <math id="Sx3.SSx3.SSSx2.p3.8.m3.1" class="ltx_Math" alttext="p" display="inline"><semantics id="Sx3.SSx3.SSSx2.p3.8.m3.1a"><mi id="Sx3.SSx3.SSSx2.p3.8.m3.1.1" xref="Sx3.SSx3.SSSx2.p3.8.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p3.8.m3.1b"><ci id="Sx3.SSx3.SSSx2.p3.8.m3.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.8.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p3.8.m3.1c">p</annotation></semantics></math>-dimensional <math id="Sx3.SSx3.SSSx2.p3.9.m4.1" class="ltx_Math" alttext="h_{GRU}(\alpha)" display="inline"><semantics id="Sx3.SSx3.SSSx2.p3.9.m4.1a"><mrow id="Sx3.SSx3.SSSx2.p3.9.m4.1.2" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.cmml"><msub id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.cmml"><mi id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.2" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.2.cmml">h</mi><mrow id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.cmml"><mi id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.2" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.1" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.3" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.1a" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.4" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.4.cmml">U</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.1" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.1.cmml">​</mo><mrow id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.3.2" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.cmml"><mo stretchy="false" id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.3.2.1" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.cmml">(</mo><mi id="Sx3.SSx3.SSSx2.p3.9.m4.1.1" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.1.cmml">α</mi><mo stretchy="false" id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.3.2.2" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p3.9.m4.1b"><apply id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.cmml" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2"><times id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.1.cmml" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.1"></times><apply id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.cmml" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.1.cmml" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2">subscript</csymbol><ci id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.2.cmml" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.2">ℎ</ci><apply id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.cmml" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3"><times id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.1.cmml" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.1"></times><ci id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.2.cmml" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.2">𝐺</ci><ci id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.3.cmml" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.3">𝑅</ci><ci id="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.4.cmml" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.2.2.3.4">𝑈</ci></apply></apply><ci id="Sx3.SSx3.SSSx2.p3.9.m4.1.1.cmml" xref="Sx3.SSx3.SSSx2.p3.9.m4.1.1">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p3.9.m4.1c">h_{GRU}(\alpha)</annotation></semantics></math> indicates the last hidden state vector of the GRU, which is conceptually similar to the GRU defined in Eq.<a href="#Sx3.E5" title="In Attention refinement ‣ Human Attention Network ‣ Approach ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div id="Sx3.SSx3.SSSx2.p4" class="ltx_para">
<p id="Sx3.SSx3.SSSx2.p4.1" class="ltx_p">The loss of the supervised attention model is the weighted sum of the classification loss and attention supervision loss.
Given an extended training triplet of <math id="Sx3.SSx3.SSSx2.p4.1.m1.4" class="ltx_Math" alttext="(I,q,A,\alpha_{h}^{\prime})" display="inline"><semantics id="Sx3.SSx3.SSSx2.p4.1.m1.4a"><mrow id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.2.cmml"><mo stretchy="false" id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.2" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.2.cmml">(</mo><mi id="Sx3.SSx3.SSSx2.p4.1.m1.1.1" xref="Sx3.SSx3.SSSx2.p4.1.m1.1.1.cmml">I</mi><mo id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.3" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.2.cmml">,</mo><mi id="Sx3.SSx3.SSSx2.p4.1.m1.2.2" xref="Sx3.SSx3.SSSx2.p4.1.m1.2.2.cmml">q</mi><mo id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.4" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.2.cmml">,</mo><mi id="Sx3.SSx3.SSSx2.p4.1.m1.3.3" xref="Sx3.SSx3.SSSx2.p4.1.m1.3.3.cmml">A</mi><mo id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.5" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.2.cmml">,</mo><msubsup id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.cmml"><mi id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.2.2" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.2.2.cmml">α</mi><mi id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.2.3" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.2.3.cmml">h</mi><mo id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.3" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.6" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p4.1.m1.4b"><vector id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.2.cmml" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1"><ci id="Sx3.SSx3.SSSx2.p4.1.m1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p4.1.m1.1.1">𝐼</ci><ci id="Sx3.SSx3.SSSx2.p4.1.m1.2.2.cmml" xref="Sx3.SSx3.SSSx2.p4.1.m1.2.2">𝑞</ci><ci id="Sx3.SSx3.SSSx2.p4.1.m1.3.3.cmml" xref="Sx3.SSx3.SSSx2.p4.1.m1.3.3">𝐴</ci><apply id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.cmml" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1">superscript</csymbol><apply id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.2.cmml" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.2.1.cmml" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1">subscript</csymbol><ci id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.2.2.cmml" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.2.2">𝛼</ci><ci id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.2.3.cmml" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.2.3">ℎ</ci></apply><ci id="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.3.cmml" xref="Sx3.SSx3.SSSx2.p4.1.m1.4.4.1.1.3">′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p4.1.m1.4c">(I,q,A,\alpha_{h}^{\prime})</annotation></semantics></math>, the loss is defined as</p>
<table id="Sx3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E13.m1.9" class="ltx_Math" alttext="L(I,q,A,\alpha_{h}^{\prime})=L_{cls}(I,q,A)+\lambda\,L_{att}(I,q,\alpha_{h}^{\prime})," display="block"><semantics id="Sx3.E13.m1.9a"><mrow id="Sx3.E13.m1.9.9.1" xref="Sx3.E13.m1.9.9.1.1.cmml"><mrow id="Sx3.E13.m1.9.9.1.1" xref="Sx3.E13.m1.9.9.1.1.cmml"><mrow id="Sx3.E13.m1.9.9.1.1.1" xref="Sx3.E13.m1.9.9.1.1.1.cmml"><mi id="Sx3.E13.m1.9.9.1.1.1.3" xref="Sx3.E13.m1.9.9.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.E13.m1.9.9.1.1.1.2" xref="Sx3.E13.m1.9.9.1.1.1.2.cmml">​</mo><mrow id="Sx3.E13.m1.9.9.1.1.1.1.1" xref="Sx3.E13.m1.9.9.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E13.m1.9.9.1.1.1.1.1.2" xref="Sx3.E13.m1.9.9.1.1.1.1.2.cmml">(</mo><mi id="Sx3.E13.m1.1.1" xref="Sx3.E13.m1.1.1.cmml">I</mi><mo id="Sx3.E13.m1.9.9.1.1.1.1.1.3" xref="Sx3.E13.m1.9.9.1.1.1.1.2.cmml">,</mo><mi id="Sx3.E13.m1.2.2" xref="Sx3.E13.m1.2.2.cmml">q</mi><mo id="Sx3.E13.m1.9.9.1.1.1.1.1.4" xref="Sx3.E13.m1.9.9.1.1.1.1.2.cmml">,</mo><mi id="Sx3.E13.m1.3.3" xref="Sx3.E13.m1.3.3.cmml">A</mi><mo id="Sx3.E13.m1.9.9.1.1.1.1.1.5" xref="Sx3.E13.m1.9.9.1.1.1.1.2.cmml">,</mo><msubsup id="Sx3.E13.m1.9.9.1.1.1.1.1.1" xref="Sx3.E13.m1.9.9.1.1.1.1.1.1.cmml"><mi id="Sx3.E13.m1.9.9.1.1.1.1.1.1.2.2" xref="Sx3.E13.m1.9.9.1.1.1.1.1.1.2.2.cmml">α</mi><mi id="Sx3.E13.m1.9.9.1.1.1.1.1.1.2.3" xref="Sx3.E13.m1.9.9.1.1.1.1.1.1.2.3.cmml">h</mi><mo id="Sx3.E13.m1.9.9.1.1.1.1.1.1.3" xref="Sx3.E13.m1.9.9.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="Sx3.E13.m1.9.9.1.1.1.1.1.6" xref="Sx3.E13.m1.9.9.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx3.E13.m1.9.9.1.1.3" xref="Sx3.E13.m1.9.9.1.1.3.cmml">=</mo><mrow id="Sx3.E13.m1.9.9.1.1.2" xref="Sx3.E13.m1.9.9.1.1.2.cmml"><mrow id="Sx3.E13.m1.9.9.1.1.2.3" xref="Sx3.E13.m1.9.9.1.1.2.3.cmml"><msub id="Sx3.E13.m1.9.9.1.1.2.3.2" xref="Sx3.E13.m1.9.9.1.1.2.3.2.cmml"><mi id="Sx3.E13.m1.9.9.1.1.2.3.2.2" xref="Sx3.E13.m1.9.9.1.1.2.3.2.2.cmml">L</mi><mrow id="Sx3.E13.m1.9.9.1.1.2.3.2.3" xref="Sx3.E13.m1.9.9.1.1.2.3.2.3.cmml"><mi id="Sx3.E13.m1.9.9.1.1.2.3.2.3.2" xref="Sx3.E13.m1.9.9.1.1.2.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.E13.m1.9.9.1.1.2.3.2.3.1" xref="Sx3.E13.m1.9.9.1.1.2.3.2.3.1.cmml">​</mo><mi id="Sx3.E13.m1.9.9.1.1.2.3.2.3.3" xref="Sx3.E13.m1.9.9.1.1.2.3.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E13.m1.9.9.1.1.2.3.2.3.1a" xref="Sx3.E13.m1.9.9.1.1.2.3.2.3.1.cmml">​</mo><mi id="Sx3.E13.m1.9.9.1.1.2.3.2.3.4" xref="Sx3.E13.m1.9.9.1.1.2.3.2.3.4.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E13.m1.9.9.1.1.2.3.1" xref="Sx3.E13.m1.9.9.1.1.2.3.1.cmml">​</mo><mrow id="Sx3.E13.m1.9.9.1.1.2.3.3.2" xref="Sx3.E13.m1.9.9.1.1.2.3.3.1.cmml"><mo stretchy="false" id="Sx3.E13.m1.9.9.1.1.2.3.3.2.1" xref="Sx3.E13.m1.9.9.1.1.2.3.3.1.cmml">(</mo><mi id="Sx3.E13.m1.4.4" xref="Sx3.E13.m1.4.4.cmml">I</mi><mo id="Sx3.E13.m1.9.9.1.1.2.3.3.2.2" xref="Sx3.E13.m1.9.9.1.1.2.3.3.1.cmml">,</mo><mi id="Sx3.E13.m1.5.5" xref="Sx3.E13.m1.5.5.cmml">q</mi><mo id="Sx3.E13.m1.9.9.1.1.2.3.3.2.3" xref="Sx3.E13.m1.9.9.1.1.2.3.3.1.cmml">,</mo><mi id="Sx3.E13.m1.6.6" xref="Sx3.E13.m1.6.6.cmml">A</mi><mo stretchy="false" id="Sx3.E13.m1.9.9.1.1.2.3.3.2.4" xref="Sx3.E13.m1.9.9.1.1.2.3.3.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E13.m1.9.9.1.1.2.2" xref="Sx3.E13.m1.9.9.1.1.2.2.cmml">+</mo><mrow id="Sx3.E13.m1.9.9.1.1.2.1" xref="Sx3.E13.m1.9.9.1.1.2.1.cmml"><mi id="Sx3.E13.m1.9.9.1.1.2.1.3" xref="Sx3.E13.m1.9.9.1.1.2.1.3.cmml">λ</mi><mo lspace="0.170em" rspace="0em" id="Sx3.E13.m1.9.9.1.1.2.1.2" xref="Sx3.E13.m1.9.9.1.1.2.1.2.cmml">​</mo><msub id="Sx3.E13.m1.9.9.1.1.2.1.4" xref="Sx3.E13.m1.9.9.1.1.2.1.4.cmml"><mi id="Sx3.E13.m1.9.9.1.1.2.1.4.2" xref="Sx3.E13.m1.9.9.1.1.2.1.4.2.cmml">L</mi><mrow id="Sx3.E13.m1.9.9.1.1.2.1.4.3" xref="Sx3.E13.m1.9.9.1.1.2.1.4.3.cmml"><mi id="Sx3.E13.m1.9.9.1.1.2.1.4.3.2" xref="Sx3.E13.m1.9.9.1.1.2.1.4.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E13.m1.9.9.1.1.2.1.4.3.1" xref="Sx3.E13.m1.9.9.1.1.2.1.4.3.1.cmml">​</mo><mi id="Sx3.E13.m1.9.9.1.1.2.1.4.3.3" xref="Sx3.E13.m1.9.9.1.1.2.1.4.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E13.m1.9.9.1.1.2.1.4.3.1a" xref="Sx3.E13.m1.9.9.1.1.2.1.4.3.1.cmml">​</mo><mi id="Sx3.E13.m1.9.9.1.1.2.1.4.3.4" xref="Sx3.E13.m1.9.9.1.1.2.1.4.3.4.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E13.m1.9.9.1.1.2.1.2a" xref="Sx3.E13.m1.9.9.1.1.2.1.2.cmml">​</mo><mrow id="Sx3.E13.m1.9.9.1.1.2.1.1.1" xref="Sx3.E13.m1.9.9.1.1.2.1.1.2.cmml"><mo stretchy="false" id="Sx3.E13.m1.9.9.1.1.2.1.1.1.2" xref="Sx3.E13.m1.9.9.1.1.2.1.1.2.cmml">(</mo><mi id="Sx3.E13.m1.7.7" xref="Sx3.E13.m1.7.7.cmml">I</mi><mo id="Sx3.E13.m1.9.9.1.1.2.1.1.1.3" xref="Sx3.E13.m1.9.9.1.1.2.1.1.2.cmml">,</mo><mi id="Sx3.E13.m1.8.8" xref="Sx3.E13.m1.8.8.cmml">q</mi><mo id="Sx3.E13.m1.9.9.1.1.2.1.1.1.4" xref="Sx3.E13.m1.9.9.1.1.2.1.1.2.cmml">,</mo><msubsup id="Sx3.E13.m1.9.9.1.1.2.1.1.1.1" xref="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.cmml"><mi id="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.2.2" xref="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.2.2.cmml">α</mi><mi id="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.2.3" xref="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.2.3.cmml">h</mi><mo id="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.3" xref="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="Sx3.E13.m1.9.9.1.1.2.1.1.1.5" xref="Sx3.E13.m1.9.9.1.1.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx3.E13.m1.9.9.1.2" xref="Sx3.E13.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E13.m1.9b"><apply id="Sx3.E13.m1.9.9.1.1.cmml" xref="Sx3.E13.m1.9.9.1"><eq id="Sx3.E13.m1.9.9.1.1.3.cmml" xref="Sx3.E13.m1.9.9.1.1.3"></eq><apply id="Sx3.E13.m1.9.9.1.1.1.cmml" xref="Sx3.E13.m1.9.9.1.1.1"><times id="Sx3.E13.m1.9.9.1.1.1.2.cmml" xref="Sx3.E13.m1.9.9.1.1.1.2"></times><ci id="Sx3.E13.m1.9.9.1.1.1.3.cmml" xref="Sx3.E13.m1.9.9.1.1.1.3">𝐿</ci><vector id="Sx3.E13.m1.9.9.1.1.1.1.2.cmml" xref="Sx3.E13.m1.9.9.1.1.1.1.1"><ci id="Sx3.E13.m1.1.1.cmml" xref="Sx3.E13.m1.1.1">𝐼</ci><ci id="Sx3.E13.m1.2.2.cmml" xref="Sx3.E13.m1.2.2">𝑞</ci><ci id="Sx3.E13.m1.3.3.cmml" xref="Sx3.E13.m1.3.3">𝐴</ci><apply id="Sx3.E13.m1.9.9.1.1.1.1.1.1.cmml" xref="Sx3.E13.m1.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E13.m1.9.9.1.1.1.1.1.1.1.cmml" xref="Sx3.E13.m1.9.9.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.E13.m1.9.9.1.1.1.1.1.1.2.cmml" xref="Sx3.E13.m1.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E13.m1.9.9.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E13.m1.9.9.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E13.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E13.m1.9.9.1.1.1.1.1.1.2.2">𝛼</ci><ci id="Sx3.E13.m1.9.9.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E13.m1.9.9.1.1.1.1.1.1.2.3">ℎ</ci></apply><ci id="Sx3.E13.m1.9.9.1.1.1.1.1.1.3.cmml" xref="Sx3.E13.m1.9.9.1.1.1.1.1.1.3">′</ci></apply></vector></apply><apply id="Sx3.E13.m1.9.9.1.1.2.cmml" xref="Sx3.E13.m1.9.9.1.1.2"><plus id="Sx3.E13.m1.9.9.1.1.2.2.cmml" xref="Sx3.E13.m1.9.9.1.1.2.2"></plus><apply id="Sx3.E13.m1.9.9.1.1.2.3.cmml" xref="Sx3.E13.m1.9.9.1.1.2.3"><times id="Sx3.E13.m1.9.9.1.1.2.3.1.cmml" xref="Sx3.E13.m1.9.9.1.1.2.3.1"></times><apply id="Sx3.E13.m1.9.9.1.1.2.3.2.cmml" xref="Sx3.E13.m1.9.9.1.1.2.3.2"><csymbol cd="ambiguous" id="Sx3.E13.m1.9.9.1.1.2.3.2.1.cmml" xref="Sx3.E13.m1.9.9.1.1.2.3.2">subscript</csymbol><ci id="Sx3.E13.m1.9.9.1.1.2.3.2.2.cmml" xref="Sx3.E13.m1.9.9.1.1.2.3.2.2">𝐿</ci><apply id="Sx3.E13.m1.9.9.1.1.2.3.2.3.cmml" xref="Sx3.E13.m1.9.9.1.1.2.3.2.3"><times id="Sx3.E13.m1.9.9.1.1.2.3.2.3.1.cmml" xref="Sx3.E13.m1.9.9.1.1.2.3.2.3.1"></times><ci id="Sx3.E13.m1.9.9.1.1.2.3.2.3.2.cmml" xref="Sx3.E13.m1.9.9.1.1.2.3.2.3.2">𝑐</ci><ci id="Sx3.E13.m1.9.9.1.1.2.3.2.3.3.cmml" xref="Sx3.E13.m1.9.9.1.1.2.3.2.3.3">𝑙</ci><ci id="Sx3.E13.m1.9.9.1.1.2.3.2.3.4.cmml" xref="Sx3.E13.m1.9.9.1.1.2.3.2.3.4">𝑠</ci></apply></apply><vector id="Sx3.E13.m1.9.9.1.1.2.3.3.1.cmml" xref="Sx3.E13.m1.9.9.1.1.2.3.3.2"><ci id="Sx3.E13.m1.4.4.cmml" xref="Sx3.E13.m1.4.4">𝐼</ci><ci id="Sx3.E13.m1.5.5.cmml" xref="Sx3.E13.m1.5.5">𝑞</ci><ci id="Sx3.E13.m1.6.6.cmml" xref="Sx3.E13.m1.6.6">𝐴</ci></vector></apply><apply id="Sx3.E13.m1.9.9.1.1.2.1.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1"><times id="Sx3.E13.m1.9.9.1.1.2.1.2.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.2"></times><ci id="Sx3.E13.m1.9.9.1.1.2.1.3.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.3">𝜆</ci><apply id="Sx3.E13.m1.9.9.1.1.2.1.4.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.4"><csymbol cd="ambiguous" id="Sx3.E13.m1.9.9.1.1.2.1.4.1.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.4">subscript</csymbol><ci id="Sx3.E13.m1.9.9.1.1.2.1.4.2.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.4.2">𝐿</ci><apply id="Sx3.E13.m1.9.9.1.1.2.1.4.3.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.4.3"><times id="Sx3.E13.m1.9.9.1.1.2.1.4.3.1.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.4.3.1"></times><ci id="Sx3.E13.m1.9.9.1.1.2.1.4.3.2.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.4.3.2">𝑎</ci><ci id="Sx3.E13.m1.9.9.1.1.2.1.4.3.3.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.4.3.3">𝑡</ci><ci id="Sx3.E13.m1.9.9.1.1.2.1.4.3.4.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.4.3.4">𝑡</ci></apply></apply><vector id="Sx3.E13.m1.9.9.1.1.2.1.1.2.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.1.1"><ci id="Sx3.E13.m1.7.7.cmml" xref="Sx3.E13.m1.7.7">𝐼</ci><ci id="Sx3.E13.m1.8.8.cmml" xref="Sx3.E13.m1.8.8">𝑞</ci><apply id="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.1.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.1.1.1">superscript</csymbol><apply id="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.2.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.2.1.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.1.1.1">subscript</csymbol><ci id="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.2.2.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.2.2">𝛼</ci><ci id="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.2.3.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.2.3">ℎ</ci></apply><ci id="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.3.cmml" xref="Sx3.E13.m1.9.9.1.1.2.1.1.1.1.3">′</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E13.m1.9c">L(I,q,A,\alpha_{h}^{\prime})=L_{cls}(I,q,A)+\lambda\,L_{att}(I,q,\alpha_{h}^{\prime}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.SSSx2.p4.2" class="ltx_p">where <math id="Sx3.SSx3.SSSx2.p4.2.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="Sx3.SSx3.SSSx2.p4.2.m1.1a"><mi id="Sx3.SSx3.SSSx2.p4.2.m1.1.1" xref="Sx3.SSx3.SSSx2.p4.2.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p4.2.m1.1b"><ci id="Sx3.SSx3.SSSx2.p4.2.m1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p4.2.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p4.2.m1.1c">\lambda</annotation></semantics></math> is a trade-off parameter. The model is trained by minimizing the total loss of Eq.<a href="#Sx3.E13" title="In Supervised attention model ‣ Attention supervision for VQA ‣ Approach ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>.</p>
</div>
</section>
</section>
</section>
<section id="Sx4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Experiment</h2>

<section id="Sx4.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Human Attention Network (HAN)</h3>

<figure id="Sx4.F4" class="ltx_figure"><img src="/html/1709.06308/assets/x4.png" id="Sx4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="921" height="573" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Comparison between human attention and human-like attention generated by the HAN.</figcaption>
</figure>
<section id="Sx4.SSx1.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Dataset</h4>

<div id="Sx4.SSx1.SSSx1.p1" class="ltx_para">
<p id="Sx4.SSx1.SSSx1.p1.1" class="ltx_p">The HAN is evaluated on the recently released VQA-HAT dataset (<span id="Sx4.SSx1.SSSx1.p1.1.1" class="ltx_text ltx_font_bold">?</span>) as it is the only human-labeled attention dataset for VQA.
The task of collecting the human attention data of the VQA-HAT dataset was implemented by 800 different annotators.
The dataset contains human attention maps for around 60k image-question pairs in the VQA v1.0 dataset, which in total has approximately 600k image-question pairs in the dataset.
Specifically, the annotators are shown a blurred image and a question about the image,
and they need to sharpen the regions of the image that will help them to answer the question correctly.
In the end, human attention maps were collected for 58,475 image-question pairs in the training set and 1,374 in the validation set of the VQA v1.0.
The HAN is trained on the training set of the VQA-HAT and the experiment results are evaluated on the validation set of the VQA-HAT.
Before training, 8 mislabeled attention maps whose value is zero were removed.
As the output of the HAN is processed through a softmax layer,
all human attention maps are also fed to a softmax layer before training for modeling consistency.</p>
</div>
</section>
<section id="Sx4.SSx1.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Implementation details</h4>

<div id="Sx4.SSx1.SSSx2.p1" class="ltx_para">
<p id="Sx4.SSx1.SSSx2.p1.1" class="ltx_p">The experimental setup of (<span id="Sx4.SSx1.SSSx2.p1.1.1" class="ltx_text ltx_font_bold">?</span>) is also followed.
The wording embedding matrix and the GRU for encoding words are initialized with the pre-trained skip-thought vector model (<span id="Sx4.SSx1.SSSx2.p1.1.2" class="ltx_text ltx_font_bold">?</span>).
As a result, the question vectors have 2400 dimensions.
The number of the glimpses in the HAN is set to 3,
which shows the best performance.
The size of the hidden state in the GRU for refining the attention maps is set to 512.
The joint embedding size <math id="Sx4.SSx1.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Sx4.SSx1.SSSx2.p1.1.m1.1a"><mi id="Sx4.SSx1.SSSx2.p1.1.m1.1.1" xref="Sx4.SSx1.SSSx2.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx2.p1.1.m1.1b"><ci id="Sx4.SSx1.SSSx2.p1.1.m1.1.1.cmml" xref="Sx4.SSx1.SSSx2.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx2.p1.1.m1.1c">d</annotation></semantics></math> used for embedding images and questions is set to 1200.
The Adam optimizer (<span id="Sx4.SSx1.SSSx2.p1.1.3" class="ltx_text ltx_font_bold">?</span>) is used with a base learning rate of 3e-4.
The batch size is set to 64 and the iterations are set to 300k.
Dropout is used with ratio 0.5.
The network is implemented using the Torch7 (<span id="Sx4.SSx1.SSSx2.p1.1.4" class="ltx_text ltx_font_bold">?</span>).</p>
</div>
</section>
<section id="Sx4.SSx1.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Evaluation metric: rank correlation</h4>

<div id="Sx4.SSx1.SSSx3.p1" class="ltx_para">
<p id="Sx4.SSx1.SSSx3.p1.1" class="ltx_p">The evaluation method provided in (<span id="Sx4.SSx1.SSSx3.p1.1.1" class="ltx_text ltx_font_bold">?</span>) is used.
This evaluation method uses the mean rank-correlation coefficient to evaluate the quality of the attention maps, a higher value meaning a better quality.
To be specific, first, both the machine-generated attention maps and the human labeled attention maps scaled to <math id="Sx4.SSx1.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="14\times 14" display="inline"><semantics id="Sx4.SSx1.SSSx3.p1.1.m1.1a"><mrow id="Sx4.SSx1.SSSx3.p1.1.m1.1.1" xref="Sx4.SSx1.SSSx3.p1.1.m1.1.1.cmml"><mn id="Sx4.SSx1.SSSx3.p1.1.m1.1.1.2" xref="Sx4.SSx1.SSSx3.p1.1.m1.1.1.2.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="Sx4.SSx1.SSSx3.p1.1.m1.1.1.1" xref="Sx4.SSx1.SSSx3.p1.1.m1.1.1.1.cmml">×</mo><mn id="Sx4.SSx1.SSSx3.p1.1.m1.1.1.3" xref="Sx4.SSx1.SSSx3.p1.1.m1.1.1.3.cmml">14</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx3.p1.1.m1.1b"><apply id="Sx4.SSx1.SSSx3.p1.1.m1.1.1.cmml" xref="Sx4.SSx1.SSSx3.p1.1.m1.1.1"><times id="Sx4.SSx1.SSSx3.p1.1.m1.1.1.1.cmml" xref="Sx4.SSx1.SSSx3.p1.1.m1.1.1.1"></times><cn type="integer" id="Sx4.SSx1.SSSx3.p1.1.m1.1.1.2.cmml" xref="Sx4.SSx1.SSSx3.p1.1.m1.1.1.2">14</cn><cn type="integer" id="Sx4.SSx1.SSSx3.p1.1.m1.1.1.3.cmml" xref="Sx4.SSx1.SSSx3.p1.1.m1.1.1.3">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx3.p1.1.m1.1c">14\times 14</annotation></semantics></math>.
Then, the pixels are ranked according to their spatial attention value and finally, the correlation between the two ranked lists is computed.
In (<span id="Sx4.SSx1.SSSx3.p1.1.2" class="ltx_text ltx_font_bold">?</span>), in order to make the results more objective,
three human attention maps are collected per image-question pair for the validation dataset
and the mean rank-correlation is computed among these three maps.
Therefore, in this experiment, the reported correlation value is averaged over the three sets of attention maps that are labeled by different annotators.
The rank-correlation in the experiment is calculated by</p>
<table id="Sx4.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx4.E14.m1.2" class="ltx_Math" alttext="\frac{1}{3}\sum_{i=1}^{3}(1-\frac{6\sum_{j=1}^{l^{2}}({att^{\prime}}^{j}-att_{i}^{j})^{2}}{l^{2}-l})" display="block"><semantics id="Sx4.E14.m1.2a"><mrow id="Sx4.E14.m1.2.2" xref="Sx4.E14.m1.2.2.cmml"><mfrac id="Sx4.E14.m1.2.2.3" xref="Sx4.E14.m1.2.2.3.cmml"><mn id="Sx4.E14.m1.2.2.3.2" xref="Sx4.E14.m1.2.2.3.2.cmml">1</mn><mn id="Sx4.E14.m1.2.2.3.3" xref="Sx4.E14.m1.2.2.3.3.cmml">3</mn></mfrac><mo lspace="0em" rspace="0em" id="Sx4.E14.m1.2.2.2" xref="Sx4.E14.m1.2.2.2.cmml">​</mo><mrow id="Sx4.E14.m1.2.2.1" xref="Sx4.E14.m1.2.2.1.cmml"><munderover id="Sx4.E14.m1.2.2.1.2" xref="Sx4.E14.m1.2.2.1.2.cmml"><mo movablelimits="false" rspace="0em" id="Sx4.E14.m1.2.2.1.2.2.2" xref="Sx4.E14.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="Sx4.E14.m1.2.2.1.2.2.3" xref="Sx4.E14.m1.2.2.1.2.2.3.cmml"><mi id="Sx4.E14.m1.2.2.1.2.2.3.2" xref="Sx4.E14.m1.2.2.1.2.2.3.2.cmml">i</mi><mo id="Sx4.E14.m1.2.2.1.2.2.3.1" xref="Sx4.E14.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="Sx4.E14.m1.2.2.1.2.2.3.3" xref="Sx4.E14.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mn id="Sx4.E14.m1.2.2.1.2.3" xref="Sx4.E14.m1.2.2.1.2.3.cmml">3</mn></munderover><mrow id="Sx4.E14.m1.2.2.1.1.1" xref="Sx4.E14.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.E14.m1.2.2.1.1.1.2" xref="Sx4.E14.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="Sx4.E14.m1.2.2.1.1.1.1" xref="Sx4.E14.m1.2.2.1.1.1.1.cmml"><mn id="Sx4.E14.m1.2.2.1.1.1.1.2" xref="Sx4.E14.m1.2.2.1.1.1.1.2.cmml">1</mn><mo id="Sx4.E14.m1.2.2.1.1.1.1.1" xref="Sx4.E14.m1.2.2.1.1.1.1.1.cmml">−</mo><mfrac id="Sx4.E14.m1.1.1" xref="Sx4.E14.m1.1.1.cmml"><mrow id="Sx4.E14.m1.1.1.1" xref="Sx4.E14.m1.1.1.1.cmml"><mn id="Sx4.E14.m1.1.1.1.3" xref="Sx4.E14.m1.1.1.1.3.cmml">6</mn><mo lspace="0em" rspace="0em" id="Sx4.E14.m1.1.1.1.2" xref="Sx4.E14.m1.1.1.1.2.cmml">​</mo><mrow id="Sx4.E14.m1.1.1.1.1" xref="Sx4.E14.m1.1.1.1.1.cmml"><msubsup id="Sx4.E14.m1.1.1.1.1.2" xref="Sx4.E14.m1.1.1.1.1.2.cmml"><mo rspace="0em" id="Sx4.E14.m1.1.1.1.1.2.2.2" xref="Sx4.E14.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx4.E14.m1.1.1.1.1.2.2.3" xref="Sx4.E14.m1.1.1.1.1.2.2.3.cmml"><mi id="Sx4.E14.m1.1.1.1.1.2.2.3.2" xref="Sx4.E14.m1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="Sx4.E14.m1.1.1.1.1.2.2.3.1" xref="Sx4.E14.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx4.E14.m1.1.1.1.1.2.2.3.3" xref="Sx4.E14.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msup id="Sx4.E14.m1.1.1.1.1.2.3" xref="Sx4.E14.m1.1.1.1.1.2.3.cmml"><mi id="Sx4.E14.m1.1.1.1.1.2.3.2" xref="Sx4.E14.m1.1.1.1.1.2.3.2.cmml">l</mi><mn id="Sx4.E14.m1.1.1.1.1.2.3.3" xref="Sx4.E14.m1.1.1.1.1.2.3.3.cmml">2</mn></msup></msubsup><msup id="Sx4.E14.m1.1.1.1.1.1" xref="Sx4.E14.m1.1.1.1.1.1.cmml"><mrow id="Sx4.E14.m1.1.1.1.1.1.1.1" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.E14.m1.1.1.1.1.1.1.1.2" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.E14.m1.1.1.1.1.1.1.1.1" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.2" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.1" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.3" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.1a" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mmultiscripts id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.2.2" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.2.2.cmml">t</mi><mrow id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4a" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.cmml"></mrow><mo id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.2.3" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.2.3.cmml">′</mo><mrow id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4b" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.cmml"></mrow><mi id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.3" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.3.cmml">j</mi></mmultiscripts></mrow><mo id="Sx4.E14.m1.1.1.1.1.1.1.1.1.1" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.2" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.1" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.3" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.1a" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.cmml"><mi id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.2.2" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.2.2.cmml">t</mi><mi id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.2.3" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.2.3.cmml">i</mi><mi id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.3" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.3.cmml">j</mi></msubsup></mrow></mrow><mo stretchy="false" id="Sx4.E14.m1.1.1.1.1.1.1.1.3" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="Sx4.E14.m1.1.1.1.1.1.3" xref="Sx4.E14.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mrow id="Sx4.E14.m1.1.1.3" xref="Sx4.E14.m1.1.1.3.cmml"><msup id="Sx4.E14.m1.1.1.3.2" xref="Sx4.E14.m1.1.1.3.2.cmml"><mi id="Sx4.E14.m1.1.1.3.2.2" xref="Sx4.E14.m1.1.1.3.2.2.cmml">l</mi><mn id="Sx4.E14.m1.1.1.3.2.3" xref="Sx4.E14.m1.1.1.3.2.3.cmml">2</mn></msup><mo id="Sx4.E14.m1.1.1.3.1" xref="Sx4.E14.m1.1.1.3.1.cmml">−</mo><mi id="Sx4.E14.m1.1.1.3.3" xref="Sx4.E14.m1.1.1.3.3.cmml">l</mi></mrow></mfrac></mrow><mo stretchy="false" id="Sx4.E14.m1.2.2.1.1.1.3" xref="Sx4.E14.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E14.m1.2b"><apply id="Sx4.E14.m1.2.2.cmml" xref="Sx4.E14.m1.2.2"><times id="Sx4.E14.m1.2.2.2.cmml" xref="Sx4.E14.m1.2.2.2"></times><apply id="Sx4.E14.m1.2.2.3.cmml" xref="Sx4.E14.m1.2.2.3"><divide id="Sx4.E14.m1.2.2.3.1.cmml" xref="Sx4.E14.m1.2.2.3"></divide><cn type="integer" id="Sx4.E14.m1.2.2.3.2.cmml" xref="Sx4.E14.m1.2.2.3.2">1</cn><cn type="integer" id="Sx4.E14.m1.2.2.3.3.cmml" xref="Sx4.E14.m1.2.2.3.3">3</cn></apply><apply id="Sx4.E14.m1.2.2.1.cmml" xref="Sx4.E14.m1.2.2.1"><apply id="Sx4.E14.m1.2.2.1.2.cmml" xref="Sx4.E14.m1.2.2.1.2"><csymbol cd="ambiguous" id="Sx4.E14.m1.2.2.1.2.1.cmml" xref="Sx4.E14.m1.2.2.1.2">superscript</csymbol><apply id="Sx4.E14.m1.2.2.1.2.2.cmml" xref="Sx4.E14.m1.2.2.1.2"><csymbol cd="ambiguous" id="Sx4.E14.m1.2.2.1.2.2.1.cmml" xref="Sx4.E14.m1.2.2.1.2">subscript</csymbol><sum id="Sx4.E14.m1.2.2.1.2.2.2.cmml" xref="Sx4.E14.m1.2.2.1.2.2.2"></sum><apply id="Sx4.E14.m1.2.2.1.2.2.3.cmml" xref="Sx4.E14.m1.2.2.1.2.2.3"><eq id="Sx4.E14.m1.2.2.1.2.2.3.1.cmml" xref="Sx4.E14.m1.2.2.1.2.2.3.1"></eq><ci id="Sx4.E14.m1.2.2.1.2.2.3.2.cmml" xref="Sx4.E14.m1.2.2.1.2.2.3.2">𝑖</ci><cn type="integer" id="Sx4.E14.m1.2.2.1.2.2.3.3.cmml" xref="Sx4.E14.m1.2.2.1.2.2.3.3">1</cn></apply></apply><cn type="integer" id="Sx4.E14.m1.2.2.1.2.3.cmml" xref="Sx4.E14.m1.2.2.1.2.3">3</cn></apply><apply id="Sx4.E14.m1.2.2.1.1.1.1.cmml" xref="Sx4.E14.m1.2.2.1.1.1"><minus id="Sx4.E14.m1.2.2.1.1.1.1.1.cmml" xref="Sx4.E14.m1.2.2.1.1.1.1.1"></minus><cn type="integer" id="Sx4.E14.m1.2.2.1.1.1.1.2.cmml" xref="Sx4.E14.m1.2.2.1.1.1.1.2">1</cn><apply id="Sx4.E14.m1.1.1.cmml" xref="Sx4.E14.m1.1.1"><divide id="Sx4.E14.m1.1.1.2.cmml" xref="Sx4.E14.m1.1.1"></divide><apply id="Sx4.E14.m1.1.1.1.cmml" xref="Sx4.E14.m1.1.1.1"><times id="Sx4.E14.m1.1.1.1.2.cmml" xref="Sx4.E14.m1.1.1.1.2"></times><cn type="integer" id="Sx4.E14.m1.1.1.1.3.cmml" xref="Sx4.E14.m1.1.1.1.3">6</cn><apply id="Sx4.E14.m1.1.1.1.1.cmml" xref="Sx4.E14.m1.1.1.1.1"><apply id="Sx4.E14.m1.1.1.1.1.2.cmml" xref="Sx4.E14.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.E14.m1.1.1.1.1.2.1.cmml" xref="Sx4.E14.m1.1.1.1.1.2">superscript</csymbol><apply id="Sx4.E14.m1.1.1.1.1.2.2.cmml" xref="Sx4.E14.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.E14.m1.1.1.1.1.2.2.1.cmml" xref="Sx4.E14.m1.1.1.1.1.2">subscript</csymbol><sum id="Sx4.E14.m1.1.1.1.1.2.2.2.cmml" xref="Sx4.E14.m1.1.1.1.1.2.2.2"></sum><apply id="Sx4.E14.m1.1.1.1.1.2.2.3.cmml" xref="Sx4.E14.m1.1.1.1.1.2.2.3"><eq id="Sx4.E14.m1.1.1.1.1.2.2.3.1.cmml" xref="Sx4.E14.m1.1.1.1.1.2.2.3.1"></eq><ci id="Sx4.E14.m1.1.1.1.1.2.2.3.2.cmml" xref="Sx4.E14.m1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="Sx4.E14.m1.1.1.1.1.2.2.3.3.cmml" xref="Sx4.E14.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="Sx4.E14.m1.1.1.1.1.2.3.cmml" xref="Sx4.E14.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx4.E14.m1.1.1.1.1.2.3.1.cmml" xref="Sx4.E14.m1.1.1.1.1.2.3">superscript</csymbol><ci id="Sx4.E14.m1.1.1.1.1.2.3.2.cmml" xref="Sx4.E14.m1.1.1.1.1.2.3.2">𝑙</ci><cn type="integer" id="Sx4.E14.m1.1.1.1.1.2.3.3.cmml" xref="Sx4.E14.m1.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="Sx4.E14.m1.1.1.1.1.1.cmml" xref="Sx4.E14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.E14.m1.1.1.1.1.1.2.cmml" xref="Sx4.E14.m1.1.1.1.1.1">superscript</csymbol><apply id="Sx4.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1"><minus id="Sx4.E14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2"><times id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.1"></times><ci id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.3">𝑡</ci><apply id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4">superscript</csymbol><apply id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.2.1.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4">superscript</csymbol><ci id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.2.2.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.2.2">𝑡</ci><ci id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.2.3.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.2.3">′</ci></apply><ci id="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.2.4.3">𝑗</ci></apply></apply><apply id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3"><times id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.2">𝑎</ci><ci id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.3">𝑡</ci><apply id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.1.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4">superscript</csymbol><apply id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.2.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.2.1.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4">subscript</csymbol><ci id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.2.2.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.2.2">𝑡</ci><ci id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.2.3.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.2.3">𝑖</ci></apply><ci id="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.3.cmml" xref="Sx4.E14.m1.1.1.1.1.1.1.1.1.3.4.3">𝑗</ci></apply></apply></apply><cn type="integer" id="Sx4.E14.m1.1.1.1.1.1.3.cmml" xref="Sx4.E14.m1.1.1.1.1.1.3">2</cn></apply></apply></apply><apply id="Sx4.E14.m1.1.1.3.cmml" xref="Sx4.E14.m1.1.1.3"><minus id="Sx4.E14.m1.1.1.3.1.cmml" xref="Sx4.E14.m1.1.1.3.1"></minus><apply id="Sx4.E14.m1.1.1.3.2.cmml" xref="Sx4.E14.m1.1.1.3.2"><csymbol cd="ambiguous" id="Sx4.E14.m1.1.1.3.2.1.cmml" xref="Sx4.E14.m1.1.1.3.2">superscript</csymbol><ci id="Sx4.E14.m1.1.1.3.2.2.cmml" xref="Sx4.E14.m1.1.1.3.2.2">𝑙</ci><cn type="integer" id="Sx4.E14.m1.1.1.3.2.3.cmml" xref="Sx4.E14.m1.1.1.3.2.3">2</cn></apply><ci id="Sx4.E14.m1.1.1.3.3.cmml" xref="Sx4.E14.m1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E14.m1.2c">\frac{1}{3}\sum_{i=1}^{3}(1-\frac{6\sum_{j=1}^{l^{2}}({att^{\prime}}^{j}-att_{i}^{j})^{2}}{l^{2}-l})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="Sx4.SSx1.SSSx3.p1.7" class="ltx_p">where <math id="Sx4.SSx1.SSSx3.p1.2.m1.1" class="ltx_Math" alttext="{att^{\prime}}^{j}" display="inline"><semantics id="Sx4.SSx1.SSSx3.p1.2.m1.1a"><mrow id="Sx4.SSx1.SSSx3.p1.2.m1.1.1" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.cmml"><mi id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.2" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.1" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.1.cmml">​</mo><mi id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.3" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.1a" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.1.cmml">​</mo><mmultiscripts id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.cmml"><mi id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.2.2" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.2.2.cmml">t</mi><mrow id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4a" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.cmml"></mrow><mo id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.2.3" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.2.3.cmml">′</mo><mrow id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4b" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.cmml"></mrow><mi id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.3" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.3.cmml">j</mi></mmultiscripts></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx3.p1.2.m1.1b"><apply id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.cmml" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1"><times id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.1.cmml" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.1"></times><ci id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.2.cmml" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.2">𝑎</ci><ci id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.3.cmml" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.3">𝑡</ci><apply id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.cmml" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.1.cmml" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4">superscript</csymbol><apply id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.2.cmml" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.2.1.cmml" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4">superscript</csymbol><ci id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.2.2.cmml" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.2.2">𝑡</ci><ci id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.2.3.cmml" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.2.3">′</ci></apply><ci id="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.3.cmml" xref="Sx4.SSx1.SSSx3.p1.2.m1.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx3.p1.2.m1.1c">{att^{\prime}}^{j}</annotation></semantics></math> is the <math id="Sx4.SSx1.SSSx3.p1.3.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="Sx4.SSx1.SSSx3.p1.3.m2.1a"><mi id="Sx4.SSx1.SSSx3.p1.3.m2.1.1" xref="Sx4.SSx1.SSSx3.p1.3.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx3.p1.3.m2.1b"><ci id="Sx4.SSx1.SSSx3.p1.3.m2.1.1.cmml" xref="Sx4.SSx1.SSSx3.p1.3.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx3.p1.3.m2.1c">j</annotation></semantics></math>-th element of the predicted attention map and <math id="Sx4.SSx1.SSSx3.p1.4.m3.1" class="ltx_Math" alttext="att_{i}^{j}" display="inline"><semantics id="Sx4.SSx1.SSSx3.p1.4.m3.1a"><mrow id="Sx4.SSx1.SSSx3.p1.4.m3.1.1" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.cmml"><mi id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.2" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.1" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.1.cmml">​</mo><mi id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.3" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.1a" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.1.cmml">​</mo><msubsup id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.cmml"><mi id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.2.2" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.2.2.cmml">t</mi><mi id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.2.3" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.2.3.cmml">i</mi><mi id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.3" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.3.cmml">j</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx3.p1.4.m3.1b"><apply id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.cmml" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1"><times id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.1.cmml" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.1"></times><ci id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.2.cmml" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.2">𝑎</ci><ci id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.3.cmml" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.3">𝑡</ci><apply id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.cmml" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.1.cmml" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4">superscript</csymbol><apply id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.2.cmml" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.2.1.cmml" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4">subscript</csymbol><ci id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.2.2.cmml" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.2.2">𝑡</ci><ci id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.2.3.cmml" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.2.3">𝑖</ci></apply><ci id="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.3.cmml" xref="Sx4.SSx1.SSSx3.p1.4.m3.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx3.p1.4.m3.1c">att_{i}^{j}</annotation></semantics></math> is the <math id="Sx4.SSx1.SSSx3.p1.5.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="Sx4.SSx1.SSSx3.p1.5.m4.1a"><mi id="Sx4.SSx1.SSSx3.p1.5.m4.1.1" xref="Sx4.SSx1.SSSx3.p1.5.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx3.p1.5.m4.1b"><ci id="Sx4.SSx1.SSSx3.p1.5.m4.1.1.cmml" xref="Sx4.SSx1.SSSx3.p1.5.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx3.p1.5.m4.1c">j</annotation></semantics></math>-th element of the human attention map labeled by <math id="Sx4.SSx1.SSSx3.p1.6.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx4.SSx1.SSSx3.p1.6.m5.1a"><mi id="Sx4.SSx1.SSSx3.p1.6.m5.1.1" xref="Sx4.SSx1.SSSx3.p1.6.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx3.p1.6.m5.1b"><ci id="Sx4.SSx1.SSSx3.p1.6.m5.1.1.cmml" xref="Sx4.SSx1.SSSx3.p1.6.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx3.p1.6.m5.1c">i</annotation></semantics></math>-th annotator.
<math id="Sx4.SSx1.SSSx3.p1.7.m6.1" class="ltx_Math" alttext="l" display="inline"><semantics id="Sx4.SSx1.SSSx3.p1.7.m6.1a"><mi id="Sx4.SSx1.SSSx3.p1.7.m6.1.1" xref="Sx4.SSx1.SSSx3.p1.7.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx3.p1.7.m6.1b"><ci id="Sx4.SSx1.SSSx3.p1.7.m6.1.1.cmml" xref="Sx4.SSx1.SSSx3.p1.7.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx3.p1.7.m6.1c">l</annotation></semantics></math> denotes the size of the attention map, which is 14 in this experiment.</p>
</div>
<figure id="Sx4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span><span id="Sx4.T1.7.1" class="ltx_text ltx_font_bold">Mean rank-correlation coefficients</span> A higher value means a better quality. Error bars show standard error of the mean.
The results show that attention maps produced by the HAN have the highest correlation with human attention maps, surpassing the human performance by 0.045.
</figcaption>
<div id="Sx4.T1.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:170.3pt;height:97.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-9.5pt,5.4pt) scale(0.9,0.9) ;">
<table id="Sx4.T1.5.5" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Sx4.T1.5.5.6.1" class="ltx_tr">
<th id="Sx4.T1.5.5.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T1.5.5.6.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<td id="Sx4.T1.5.5.6.1.2" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T1.5.5.6.1.2.1" class="ltx_text ltx_font_bold">Mean Rank-correlation</span></td>
</tr>
<tr id="Sx4.T1.1.1.1" class="ltx_tr">
<th id="Sx4.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Random</th>
<td id="Sx4.T1.1.1.1.1" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">0.000 <math id="Sx4.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="Sx4.T1.1.1.1.1.m1.1a"><mo id="Sx4.T1.1.1.1.1.m1.1.1" xref="Sx4.T1.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="Sx4.T1.1.1.1.1.m1.1b"><csymbol cd="latexml" id="Sx4.T1.1.1.1.1.m1.1.1.cmml" xref="Sx4.T1.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T1.1.1.1.1.m1.1c">\pm</annotation></semantics></math> 0.001</td>
</tr>
<tr id="Sx4.T1.2.2.2" class="ltx_tr">
<th id="Sx4.T1.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">Human</th>
<td id="Sx4.T1.2.2.2.1" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">0.623 <math id="Sx4.T1.2.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="Sx4.T1.2.2.2.1.m1.1a"><mo id="Sx4.T1.2.2.2.1.m1.1.1" xref="Sx4.T1.2.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="Sx4.T1.2.2.2.1.m1.1b"><csymbol cd="latexml" id="Sx4.T1.2.2.2.1.m1.1.1.cmml" xref="Sx4.T1.2.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T1.2.2.2.1.m1.1c">\pm</annotation></semantics></math> 0.003</td>
</tr>
<tr id="Sx4.T1.3.3.3" class="ltx_tr">
<th id="Sx4.T1.3.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">SAN (<span id="Sx4.T1.3.3.3.2.1" class="ltx_text ltx_font_bold">?</span>)</th>
<td id="Sx4.T1.3.3.3.1" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">0.249 <math id="Sx4.T1.3.3.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="Sx4.T1.3.3.3.1.m1.1a"><mo id="Sx4.T1.3.3.3.1.m1.1.1" xref="Sx4.T1.3.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="Sx4.T1.3.3.3.1.m1.1b"><csymbol cd="latexml" id="Sx4.T1.3.3.3.1.m1.1.1.cmml" xref="Sx4.T1.3.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T1.3.3.3.1.m1.1c">\pm</annotation></semantics></math> 0.004</td>
</tr>
<tr id="Sx4.T1.4.4.4" class="ltx_tr">
<th id="Sx4.T1.4.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HieCoAtt (<span id="Sx4.T1.4.4.4.2.1" class="ltx_text ltx_font_bold">?</span>)</th>
<td id="Sx4.T1.4.4.4.1" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">0.264 <math id="Sx4.T1.4.4.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="Sx4.T1.4.4.4.1.m1.1a"><mo id="Sx4.T1.4.4.4.1.m1.1.1" xref="Sx4.T1.4.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="Sx4.T1.4.4.4.1.m1.1b"><csymbol cd="latexml" id="Sx4.T1.4.4.4.1.m1.1.1.cmml" xref="Sx4.T1.4.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T1.4.4.4.1.m1.1c">\pm</annotation></semantics></math> 0.004</td>
</tr>
<tr id="Sx4.T1.5.5.5" class="ltx_tr">
<th id="Sx4.T1.5.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">HAN</th>
<td id="Sx4.T1.5.5.5.1" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T1.5.5.5.1.1" class="ltx_text ltx_font_bold">0.668 <math id="Sx4.T1.5.5.5.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="Sx4.T1.5.5.5.1.1.m1.1a"><mo id="Sx4.T1.5.5.5.1.1.m1.1.1" xref="Sx4.T1.5.5.5.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="Sx4.T1.5.5.5.1.1.m1.1b"><csymbol cd="latexml" id="Sx4.T1.5.5.5.1.1.m1.1.1.cmml" xref="Sx4.T1.5.5.5.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T1.5.5.5.1.1.m1.1c">\pm</annotation></semantics></math> 0.001</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="Sx4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results comparison between the HAN using the GRU and the HAN without using the GRU, where <math id="Sx4.T2.2.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="Sx4.T2.2.m1.1b"><mi id="Sx4.T2.2.m1.1.1" xref="Sx4.T2.2.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Sx4.T2.2.m1.1c"><ci id="Sx4.T2.2.m1.1.1.cmml" xref="Sx4.T2.2.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.2.m1.1d">G</annotation></semantics></math> denotes the number of glimpses. As it can be observed, applying a GRU to fuse attention maps significantly improves the performance of the HAN.</figcaption>
<div id="Sx4.T2.10" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:220.3pt;height:81pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-12.2pt,4.5pt) scale(0.9,0.9) ;">
<table id="Sx4.T2.10.8" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T2.10.8.9.1" class="ltx_tr">
<th id="Sx4.T2.10.8.9.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T2.10.8.9.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="Sx4.T2.10.8.9.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T2.10.8.9.1.2.1" class="ltx_text ltx_font_bold">Mean Rank-correlation</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T2.4.2.2" class="ltx_tr">
<th id="Sx4.T2.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">HAN(<math id="Sx4.T2.3.1.1.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="Sx4.T2.3.1.1.1.m1.1a"><mi id="Sx4.T2.3.1.1.1.m1.1.1" xref="Sx4.T2.3.1.1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Sx4.T2.3.1.1.1.m1.1b"><ci id="Sx4.T2.3.1.1.1.m1.1.1.cmml" xref="Sx4.T2.3.1.1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.3.1.1.1.m1.1c">G</annotation></semantics></math>=2,without GRU)</th>
<td id="Sx4.T2.4.2.2.2" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">0.406 <math id="Sx4.T2.4.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="Sx4.T2.4.2.2.2.m1.1a"><mo id="Sx4.T2.4.2.2.2.m1.1.1" xref="Sx4.T2.4.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="Sx4.T2.4.2.2.2.m1.1b"><csymbol cd="latexml" id="Sx4.T2.4.2.2.2.m1.1.1.cmml" xref="Sx4.T2.4.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.4.2.2.2.m1.1c">\pm</annotation></semantics></math> 0.001</td>
</tr>
<tr id="Sx4.T2.6.4.4" class="ltx_tr">
<th id="Sx4.T2.5.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HAN(<math id="Sx4.T2.5.3.3.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="Sx4.T2.5.3.3.1.m1.1a"><mi id="Sx4.T2.5.3.3.1.m1.1.1" xref="Sx4.T2.5.3.3.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Sx4.T2.5.3.3.1.m1.1b"><ci id="Sx4.T2.5.3.3.1.m1.1.1.cmml" xref="Sx4.T2.5.3.3.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.5.3.3.1.m1.1c">G</annotation></semantics></math>=2,with GRU)</th>
<td id="Sx4.T2.6.4.4.2" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T2.6.4.4.2.1" class="ltx_text ltx_font_bold">0.656 <math id="Sx4.T2.6.4.4.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="Sx4.T2.6.4.4.2.1.m1.1a"><mo id="Sx4.T2.6.4.4.2.1.m1.1.1" xref="Sx4.T2.6.4.4.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="Sx4.T2.6.4.4.2.1.m1.1b"><csymbol cd="latexml" id="Sx4.T2.6.4.4.2.1.m1.1.1.cmml" xref="Sx4.T2.6.4.4.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.6.4.4.2.1.m1.1c">\pm</annotation></semantics></math> 0.002</span></td>
</tr>
<tr id="Sx4.T2.8.6.6" class="ltx_tr">
<th id="Sx4.T2.7.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HAN(<math id="Sx4.T2.7.5.5.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="Sx4.T2.7.5.5.1.m1.1a"><mi id="Sx4.T2.7.5.5.1.m1.1.1" xref="Sx4.T2.7.5.5.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Sx4.T2.7.5.5.1.m1.1b"><ci id="Sx4.T2.7.5.5.1.m1.1.1.cmml" xref="Sx4.T2.7.5.5.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.7.5.5.1.m1.1c">G</annotation></semantics></math>=3,without GRU)</th>
<td id="Sx4.T2.8.6.6.2" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">0.411 <math id="Sx4.T2.8.6.6.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="Sx4.T2.8.6.6.2.m1.1a"><mo id="Sx4.T2.8.6.6.2.m1.1.1" xref="Sx4.T2.8.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="Sx4.T2.8.6.6.2.m1.1b"><csymbol cd="latexml" id="Sx4.T2.8.6.6.2.m1.1.1.cmml" xref="Sx4.T2.8.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.8.6.6.2.m1.1c">\pm</annotation></semantics></math> 0.001</td>
</tr>
<tr id="Sx4.T2.10.8.8" class="ltx_tr">
<th id="Sx4.T2.9.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">HAN(<math id="Sx4.T2.9.7.7.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="Sx4.T2.9.7.7.1.m1.1a"><mi id="Sx4.T2.9.7.7.1.m1.1.1" xref="Sx4.T2.9.7.7.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Sx4.T2.9.7.7.1.m1.1b"><ci id="Sx4.T2.9.7.7.1.m1.1.1.cmml" xref="Sx4.T2.9.7.7.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.9.7.7.1.m1.1c">G</annotation></semantics></math>=3,with GRU)</th>
<td id="Sx4.T2.10.8.8.2" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">
<span id="Sx4.T2.10.8.8.2.1" class="ltx_text ltx_font_bold">0.668</span> <math id="Sx4.T2.10.8.8.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="Sx4.T2.10.8.8.2.m1.1a"><mo id="Sx4.T2.10.8.8.2.m1.1.1" xref="Sx4.T2.10.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="Sx4.T2.10.8.8.2.m1.1b"><csymbol cd="latexml" id="Sx4.T2.10.8.8.2.m1.1.1.cmml" xref="Sx4.T2.10.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.10.8.8.2.m1.1c">\pm</annotation></semantics></math> <span id="Sx4.T2.10.8.8.2.2" class="ltx_text ltx_font_bold">0.001</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="Sx4.SSx1.SSSx4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Results</h4>

<div id="Sx4.SSx1.SSSx4.p1" class="ltx_para">
<p id="Sx4.SSx1.SSSx4.p1.1" class="ltx_p">Previous works (<span id="Sx4.SSx1.SSSx4.p1.1.1" class="ltx_text ltx_font_bold">?</span>; <span id="Sx4.SSx1.SSSx4.p1.1.2" class="ltx_text ltx_font_bold">?</span>) have explored the effect of the different number of glimpses in VQA. It was found that multiple glimpses may result in a better performance. Therefore, the HAN is also evaluated with different glimpses, namely 1, 2, 3 and 4, yielding a performance of 0.536, 0.656, 0.668 and 0.553 respectively.
The number of glimpses is set to 3 in the experiment, as the model shows the best performance.
The performance of the HAN is presented in Tab.<a href="#Sx4.T1" title="Table 1 ‣ Evaluation metric: rank correlation ‣ Human Attention Network (HAN) ‣ Experiment ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, where the model achieves the best performance in predicting attention maps.
As it can be observed, the performance of the HAN significantly outperforms the VQA models (SAN, HieCoAtt) by around 40<math id="Sx4.SSx1.SSSx4.p1.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="Sx4.SSx1.SSSx4.p1.1.m1.1a"><mo id="Sx4.SSx1.SSSx4.p1.1.m1.1.1" xref="Sx4.SSx1.SSSx4.p1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx4.p1.1.m1.1b"><csymbol cd="latexml" id="Sx4.SSx1.SSSx4.p1.1.m1.1.1.cmml" xref="Sx4.SSx1.SSSx4.p1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx4.p1.1.m1.1c">\%</annotation></semantics></math>, which indicates that the attention explicitly learned by the HAN is more human-like than the attention that is implicitly learned by traditional attention-based models.
The correlation between human-labeled attention maps is 0.623,
which shows that different annotators have different views about the relevant area in the image given the same question and the correctness of the attention maps is difficult to define.
Therefore, for this model, making model-generated attention more human-like is the best choice.
The experiment also shows that our generated attention has the highest correlation (0.668) with human attention, showing the ability of the HAN to generate human-like attention maps for image-question pairs.</p>
</div>
<div id="Sx4.SSx1.SSSx4.p2" class="ltx_para">
<p id="Sx4.SSx1.SSSx4.p2.1" class="ltx_p">In order to verify the effectiveness of using the GRU to fuse attention maps, two experiments are conducted with the number of glimpses equal to 2 and 3.
Specifically, in these two experiments, instead of fusing the attention maps using the GRU, the average attention map is obtained among several attention maps.
The performance of our model with and without GRU is shown in Tab.<a href="#Sx4.T2" title="Table 2 ‣ Evaluation metric: rank correlation ‣ Human Attention Network (HAN) ‣ Experiment ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
The HAN using the GRU significantly outperforms the HAN without using the GRU, showing the effectiveness of using the GRU to encode the attention maps.</p>
</div>
</section>
</section>
<section id="Sx4.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Attention-based model for VQA</h3>

<figure id="Sx4.F5" class="ltx_figure"><img src="/html/1709.06308/assets/x5.png" id="Sx4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="922" height="403" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Examples of generated attention maps and predicted answers. As shown in the figure, through attention supervision, the attention generated by attention-based model is more accurate, which results in better answers.</figcaption>
</figure>
<section id="Sx4.SSx2.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Dataset</h4>

<div id="Sx4.SSx2.SSSx1.p1" class="ltx_para">
<p id="Sx4.SSx2.SSSx1.p1.1" class="ltx_p">The unsupervised attention model and the supervised attention model are evaluated on the more recent VQA v2.0 dataset,
which contains 443,757 image-question pairs in the training set, 214,354 in the validation set and 447,793 in the testing set.
This version of the dataset is more balanced in comparison to the VQA v1.0 dataset.
Specifically, for every question, there are two similar images but they yield two different answers.
Therefore, it forces models to focus more on visual information.
The models are trained on the training and validation sets and tested on the test-dev set.</p>
</div>
<div id="Sx4.SSx2.SSSx1.p2" class="ltx_para">
<p id="Sx4.SSx2.SSSx1.p2.1" class="ltx_p">When training the supervised attention model, the attention maps in the generated HLAT dataset are used as the ground truth of the attention maps.
The HLAT contains attention maps for all the image-question pairs in the VQA v2.0 dataset.
The third column of Fig.<a href="#Sx4.F4" title="Figure 4 ‣ Human Attention Network (HAN) ‣ Experiment ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the examples of the attention maps in the HLAT dataset.</p>
</div>
</section>
<section id="Sx4.SSx2.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Implementation details</h4>

<div id="Sx4.SSx2.SSSx2.p1" class="ltx_para">
<p id="Sx4.SSx2.SSSx2.p1.1" class="ltx_p">The setup of the experiment is kept almost the same as above, excepting that the number of glimpses is set to 1 and 2,
and the number of iterations is fixed to 300k in the VQA experiments. The top 3000 most frequent answers are used as possible outputs.</p>
</div>
<figure id="Sx4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>The VQA v2.0 test-dev results, where <math id="Sx4.T3.2.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="Sx4.T3.2.m1.1b"><mi id="Sx4.T3.2.m1.1.1" xref="Sx4.T3.2.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Sx4.T3.2.m1.1c"><ci id="Sx4.T3.2.m1.1.1.cmml" xref="Sx4.T3.2.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T3.2.m1.1d">G</annotation></semantics></math> denotes the number of glimpses. </figcaption>
<div id="Sx4.T3.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:251.5pt;height:132.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-27.6pt,14.6pt) scale(0.82,0.82) ;">
<table id="Sx4.T3.6.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Sx4.T3.6.4.5.1" class="ltx_tr">
<th id="Sx4.T3.6.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T3.6.4.5.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<td id="Sx4.T3.6.4.5.1.2" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T3.6.4.5.1.2.1" class="ltx_text ltx_font_bold">Yes/No</span></td>
<td id="Sx4.T3.6.4.5.1.3" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T3.6.4.5.1.3.1" class="ltx_text ltx_font_bold">Number</span></td>
<td id="Sx4.T3.6.4.5.1.4" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T3.6.4.5.1.4.1" class="ltx_text ltx_font_bold">Other</span></td>
<td id="Sx4.T3.6.4.5.1.5" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T3.6.4.5.1.5.1" class="ltx_text ltx_font_bold">Overall</span></td>
</tr>
<tr id="Sx4.T3.6.4.6.2" class="ltx_tr">
<th id="Sx4.T3.6.4.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Prior</th>
<td id="Sx4.T3.6.4.6.2.2" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">61.20</td>
<td id="Sx4.T3.6.4.6.2.3" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">0.36</td>
<td id="Sx4.T3.6.4.6.2.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">1.17</td>
<td id="Sx4.T3.6.4.6.2.5" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">25.98</td>
</tr>
<tr id="Sx4.T3.6.4.7.3" class="ltx_tr">
<th id="Sx4.T3.6.4.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">Language-only</th>
<td id="Sx4.T3.6.4.7.3.2" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">26.3</td>
<td id="Sx4.T3.6.4.7.3.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">28.1</td>
<td id="Sx4.T3.6.4.7.3.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">28.1</td>
<td id="Sx4.T3.6.4.7.3.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">28.1</td>
</tr>
<tr id="Sx4.T3.6.4.8.4" class="ltx_tr">
<th id="Sx4.T3.6.4.8.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">d-LSTM Q+norm I</th>
<td id="Sx4.T3.6.4.8.4.2" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">26.3</td>
<td id="Sx4.T3.6.4.8.4.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">28.1</td>
<td id="Sx4.T3.6.4.8.4.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">41.85</td>
<td id="Sx4.T3.6.4.8.4.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">54.22</td>
</tr>
<tr id="Sx4.T3.6.4.9.5" class="ltx_tr">
<th id="Sx4.T3.6.4.9.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">(<span id="Sx4.T3.6.4.9.5.1.1" class="ltx_text ltx_font_bold">?</span>)</th>
<td id="Sx4.T3.6.4.9.5.2" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="Sx4.T3.6.4.9.5.3" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="Sx4.T3.6.4.9.5.4" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="Sx4.T3.6.4.9.5.5" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
<tr id="Sx4.T3.3.1.1" class="ltx_tr">
<th id="Sx4.T3.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">unsupervised model(<math id="Sx4.T3.3.1.1.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="Sx4.T3.3.1.1.1.m1.1a"><mi id="Sx4.T3.3.1.1.1.m1.1.1" xref="Sx4.T3.3.1.1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Sx4.T3.3.1.1.1.m1.1b"><ci id="Sx4.T3.3.1.1.1.m1.1.1.cmml" xref="Sx4.T3.3.1.1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T3.3.1.1.1.m1.1c">G</annotation></semantics></math>=1)</th>
<td id="Sx4.T3.3.1.1.2" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">78.12</td>
<td id="Sx4.T3.3.1.1.3" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">37.52</td>
<td id="Sx4.T3.3.1.1.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">52.92</td>
<td id="Sx4.T3.3.1.1.5" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">61.55</td>
</tr>
<tr id="Sx4.T3.4.2.2" class="ltx_tr">
<th id="Sx4.T3.4.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">supervised model(<math id="Sx4.T3.4.2.2.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="Sx4.T3.4.2.2.1.m1.1a"><mi id="Sx4.T3.4.2.2.1.m1.1.1" xref="Sx4.T3.4.2.2.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Sx4.T3.4.2.2.1.m1.1b"><ci id="Sx4.T3.4.2.2.1.m1.1.1.cmml" xref="Sx4.T3.4.2.2.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T3.4.2.2.1.m1.1c">G</annotation></semantics></math>=1)</th>
<td id="Sx4.T3.4.2.2.2" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">78.03</td>
<td id="Sx4.T3.4.2.2.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">37.93</td>
<td id="Sx4.T3.4.2.2.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">53.14</td>
<td id="Sx4.T3.4.2.2.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">61.66</td>
</tr>
<tr id="Sx4.T3.5.3.3" class="ltx_tr">
<th id="Sx4.T3.5.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">unsupervised model(<math id="Sx4.T3.5.3.3.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="Sx4.T3.5.3.3.1.m1.1a"><mi id="Sx4.T3.5.3.3.1.m1.1.1" xref="Sx4.T3.5.3.3.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Sx4.T3.5.3.3.1.m1.1b"><ci id="Sx4.T3.5.3.3.1.m1.1.1.cmml" xref="Sx4.T3.5.3.3.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T3.5.3.3.1.m1.1c">G</annotation></semantics></math>=2)</th>
<td id="Sx4.T3.5.3.3.2" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">78.4</td>
<td id="Sx4.T3.5.3.3.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">37.52</td>
<td id="Sx4.T3.5.3.3.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">53.29</td>
<td id="Sx4.T3.5.3.3.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">61.84</td>
</tr>
<tr id="Sx4.T3.6.4.4" class="ltx_tr">
<th id="Sx4.T3.6.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">supervised model(<math id="Sx4.T3.6.4.4.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="Sx4.T3.6.4.4.1.m1.1a"><mi id="Sx4.T3.6.4.4.1.m1.1.1" xref="Sx4.T3.6.4.4.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Sx4.T3.6.4.4.1.m1.1b"><ci id="Sx4.T3.6.4.4.1.m1.1.1.cmml" xref="Sx4.T3.6.4.4.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T3.6.4.4.1.m1.1c">G</annotation></semantics></math>=2)</th>
<td id="Sx4.T3.6.4.4.2" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T3.6.4.4.2.1" class="ltx_text ltx_font_bold">78.54</span></td>
<td id="Sx4.T3.6.4.4.3" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T3.6.4.4.3.1" class="ltx_text ltx_font_bold">37.94</span></td>
<td id="Sx4.T3.6.4.4.4" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T3.6.4.4.4.1" class="ltx_text ltx_font_bold">53.38</span></td>
<td id="Sx4.T3.6.4.4.5" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="Sx4.T3.6.4.4.5.1" class="ltx_text ltx_font_bold">61.99</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="Sx4.SSx2.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Evaluation metric</h4>

<div id="Sx4.SSx2.SSSx3.p1" class="ltx_para">
<p id="Sx4.SSx2.SSSx3.p1.2" class="ltx_p">The model results are evaluated using the provided accuracy metric (<span id="Sx4.SSx2.SSSx3.p1.2.1" class="ltx_text ltx_font_bold">?</span>).
The accuracy of a predicted answer is given by</p>
<table id="Sx4.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx4.E15.m1.2" class="ltx_Math" alttext="\mathrm{min(\frac{\#humans\;that\;provided\ that\,answer}{3},1)}" display="block"><semantics id="Sx4.E15.m1.2a"><mrow id="Sx4.E15.m1.2.3" xref="Sx4.E15.m1.2.3.cmml"><mi id="Sx4.E15.m1.2.3.2" xref="Sx4.E15.m1.2.3.2.cmml">min</mi><mo lspace="0em" rspace="0em" id="Sx4.E15.m1.2.3.1" xref="Sx4.E15.m1.2.3.1.cmml">​</mo><mrow id="Sx4.E15.m1.2.3.3.2" xref="Sx4.E15.m1.2.3.3.1.cmml"><mo stretchy="false" id="Sx4.E15.m1.2.3.3.2.1" xref="Sx4.E15.m1.2.3.3.1.cmml">(</mo><mfrac id="Sx4.E15.m1.1.1" xref="Sx4.E15.m1.1.1.cmml"><mrow id="Sx4.E15.m1.1.1.2" xref="Sx4.E15.m1.1.1.2.cmml"><mi mathvariant="normal" id="Sx4.E15.m1.1.1.2.2" xref="Sx4.E15.m1.1.1.2.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="Sx4.E15.m1.1.1.2.1" xref="Sx4.E15.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E15.m1.1.1.2.3" xref="Sx4.E15.m1.1.1.2.3.cmml">humans</mi><mo lspace="0.280em" rspace="0em" id="Sx4.E15.m1.1.1.2.1a" xref="Sx4.E15.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E15.m1.1.1.2.4" xref="Sx4.E15.m1.1.1.2.4.cmml">that</mi><mo lspace="0.280em" rspace="0em" id="Sx4.E15.m1.1.1.2.1b" xref="Sx4.E15.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E15.m1.1.1.2.5" xref="Sx4.E15.m1.1.1.2.5.cmml">provided</mi><mo lspace="0.500em" rspace="0em" id="Sx4.E15.m1.1.1.2.1c" xref="Sx4.E15.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E15.m1.1.1.2.6" xref="Sx4.E15.m1.1.1.2.6.cmml">that</mi><mo lspace="0.170em" rspace="0em" id="Sx4.E15.m1.1.1.2.1d" xref="Sx4.E15.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E15.m1.1.1.2.7" xref="Sx4.E15.m1.1.1.2.7.cmml">answer</mi></mrow><mn id="Sx4.E15.m1.1.1.3" xref="Sx4.E15.m1.1.1.3.cmml">3</mn></mfrac><mo id="Sx4.E15.m1.2.3.3.2.2" xref="Sx4.E15.m1.2.3.3.1.cmml">,</mo><mn id="Sx4.E15.m1.2.2" xref="Sx4.E15.m1.2.2.cmml">1</mn><mo stretchy="false" id="Sx4.E15.m1.2.3.3.2.3" xref="Sx4.E15.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E15.m1.2b"><apply id="Sx4.E15.m1.2.3.cmml" xref="Sx4.E15.m1.2.3"><times id="Sx4.E15.m1.2.3.1.cmml" xref="Sx4.E15.m1.2.3.1"></times><ci id="Sx4.E15.m1.2.3.2.cmml" xref="Sx4.E15.m1.2.3.2">min</ci><interval closure="open" id="Sx4.E15.m1.2.3.3.1.cmml" xref="Sx4.E15.m1.2.3.3.2"><apply id="Sx4.E15.m1.1.1.cmml" xref="Sx4.E15.m1.1.1"><divide id="Sx4.E15.m1.1.1.1.cmml" xref="Sx4.E15.m1.1.1"></divide><apply id="Sx4.E15.m1.1.1.2.cmml" xref="Sx4.E15.m1.1.1.2"><times id="Sx4.E15.m1.1.1.2.1.cmml" xref="Sx4.E15.m1.1.1.2.1"></times><ci id="Sx4.E15.m1.1.1.2.2.cmml" xref="Sx4.E15.m1.1.1.2.2">#</ci><ci id="Sx4.E15.m1.1.1.2.3.cmml" xref="Sx4.E15.m1.1.1.2.3">humans</ci><ci id="Sx4.E15.m1.1.1.2.4.cmml" xref="Sx4.E15.m1.1.1.2.4">that</ci><ci id="Sx4.E15.m1.1.1.2.5.cmml" xref="Sx4.E15.m1.1.1.2.5">provided</ci><ci id="Sx4.E15.m1.1.1.2.6.cmml" xref="Sx4.E15.m1.1.1.2.6">that</ci><ci id="Sx4.E15.m1.1.1.2.7.cmml" xref="Sx4.E15.m1.1.1.2.7">answer</ci></apply><cn type="integer" id="Sx4.E15.m1.1.1.3.cmml" xref="Sx4.E15.m1.1.1.3">3</cn></apply><cn type="integer" id="Sx4.E15.m1.2.2.cmml" xref="Sx4.E15.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E15.m1.2c">\mathrm{min(\frac{\#humans\;that\;provided\ that\,answer}{3},1)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="Sx4.SSx2.SSSx3.p1.1" class="ltx_p">An answer is deemed 100<math id="Sx4.SSx2.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="Sx4.SSx2.SSSx3.p1.1.m1.1a"><mo id="Sx4.SSx2.SSSx3.p1.1.m1.1.1" xref="Sx4.SSx2.SSSx3.p1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.SSSx3.p1.1.m1.1b"><csymbol cd="latexml" id="Sx4.SSx2.SSSx3.p1.1.m1.1.1.cmml" xref="Sx4.SSx2.SSSx3.p1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.SSSx3.p1.1.m1.1c">\%</annotation></semantics></math> accurate if at least 3 annotators agree on the answer.
Intuitively, this metric takes into account the consensus between the annotators.</p>
</div>
</section>
<section id="Sx4.SSx2.SSSx4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Results</h4>

<div id="Sx4.SSx2.SSSx4.p1" class="ltx_para">
<p id="Sx4.SSx2.SSSx4.p1.2" class="ltx_p">Tab.<a href="#Sx4.T3" title="Table 3 ‣ Implementation details ‣ Attention-based model for VQA ‣ Experiment ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> presents the accuracy comparison between the unsupervised model and the supervised model on the VQA v2.0 dataset.
The accuracy of Prior, Language-only, deeper LSTM Q + norm I baseline models in (<span id="Sx4.SSx2.SSSx4.p1.2.1" class="ltx_text ltx_font_bold">?</span>) are also presented for comparison.
As shown in this table, our supervised model outperforms the unsupervised model by 0.11<math id="Sx4.SSx2.SSSx4.p1.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="Sx4.SSx2.SSSx4.p1.1.m1.1a"><mo id="Sx4.SSx2.SSSx4.p1.1.m1.1.1" xref="Sx4.SSx2.SSSx4.p1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.SSSx4.p1.1.m1.1b"><csymbol cd="latexml" id="Sx4.SSx2.SSSx4.p1.1.m1.1.1.cmml" xref="Sx4.SSx2.SSSx4.p1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.SSSx4.p1.1.m1.1c">\%</annotation></semantics></math> when the number of glimpses is set to 1 and by 0.15<math id="Sx4.SSx2.SSSx4.p1.2.m2.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="Sx4.SSx2.SSSx4.p1.2.m2.1a"><mo id="Sx4.SSx2.SSSx4.p1.2.m2.1.1" xref="Sx4.SSx2.SSSx4.p1.2.m2.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.SSSx4.p1.2.m2.1b"><csymbol cd="latexml" id="Sx4.SSx2.SSSx4.p1.2.m2.1.1.cmml" xref="Sx4.SSx2.SSSx4.p1.2.m2.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.SSSx4.p1.2.m2.1c">\%</annotation></semantics></math> when the number of glimpses is set to 2, showing the effectiveness of applying attention supervision to attention-based model.
The supervised model achieves a much higher accuracy when the question is a counting problem,
which indicates that the generated attention in the supervised model is more accurate and comprehensive.
Fig.<a href="#Sx4.F5" title="Figure 5 ‣ Attention-based model for VQA ‣ Experiment ‣ Exploring Human-like Attention Supervision in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> samples the attention maps and the answers that are predicted by both the unsupervised model and the supervised model.
As it can be observed, after human-like attention supervision, the attention maps are more accurate and focused on the most relevant areas.
It can therefore be concluded that more human-like attention helps to improve the performance of the model.</p>
</div>
</section>
</section>
</section>
<section id="Sx5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>

<div id="Sx5.p1" class="ltx_para">
<p id="Sx5.p1.1" class="ltx_p">In this work, we make a first attempt to verify the effectiveness of applying human-like attention supervision in VQA.
The HAN is first proposed to generate human-like attention maps for image-question pairs.
The HLAT dataset generated by the HAN can be potentially used as a supervision to help training attention-based models in VQA.
The framework of the human-like attention supervision in the proposed supervised attention model can be easily applied to other attention-based models.
The experiment results demonstrate that the supervised model outperforms the unsupervised model and through visualization,
it is observed that the attention that is generated by the supervised attention model is more accurate, which yields better answers.
In conclusion, explicit attention supervision indeed help attention-based models in VQA to get a better performance.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bibx1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Andreas et al<span id="bib.bibx1.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
Andreas, J.; Rohrbach, M.; Darrell, T.; and Klein, D.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Neural module networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx1.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, 39–48.

</span>
</li>
<li id="bib.bibx2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Antol et al<span id="bib.bibx2.1.1.1" class="ltx_text">.</span> 2015]</span>
<span class="ltx_bibblock">
Antol, S.; Agrawal, A.; Lu, J.; Mitchell, M.; Batra, D.; Lawrence Zitnick, C.;
and Parikh, D.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Vqa: Visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx2.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE International Conference on Computer
Vision</span>, 2425–2433.

</span>
</li>
<li id="bib.bibx3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Cho et al<span id="bib.bibx3.1.1.1" class="ltx_text">.</span> 2014]</span>
<span class="ltx_bibblock">
Cho, K.; Van Merriënboer, B.; Gulcehre, C.; Bahdanau, D.; Bougares, F.;
Schwenk, H.; and Bengio, Y.

</span>
<span class="ltx_bibblock">2014.

</span>
<span class="ltx_bibblock">Learning phrase representations using rnn encoder-decoder for
statistical machine translation.

</span>
<span class="ltx_bibblock"><span id="bib.bibx3.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1406.1078</span>.

</span>
</li>
<li id="bib.bibx4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Collobert, Kavukcuoglu, and
Farabet 2011]</span>
<span class="ltx_bibblock">
Collobert, R.; Kavukcuoglu, K.; and Farabet, C.

</span>
<span class="ltx_bibblock">2011.

</span>
<span class="ltx_bibblock">Torch7: A matlab-like environment for machine learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx4.1.1" class="ltx_text ltx_font_italic">BigLearn Workshop of Neural Information Processing Systems</span>.

</span>
</li>
<li id="bib.bibx5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Das et al<span id="bib.bibx5.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
Das, A.; Agrawal, H.; Zitnick, C. L.; Parikh, D.; and Batra, D.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Human attention in visual question answering: Do humans and deep
networks look at the same regions?

</span>
<span class="ltx_bibblock"><span id="bib.bibx5.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1606.03556</span>.

</span>
</li>
<li id="bib.bibx6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Deng et al<span id="bib.bibx6.1.1.1" class="ltx_text">.</span> 2009]</span>
<span class="ltx_bibblock">
Deng, J.; Dong, W.; Socher, R.; Li, L.-J.; Li, K.; and Fei-Fei, L.

</span>
<span class="ltx_bibblock">2009.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx6.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, 248–255.

</span>
</li>
<li id="bib.bibx7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Fukui et al<span id="bib.bibx7.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
Fukui, A.; Park, D. H.; Yang, D.; Rohrbach, A.; Darrell, T.; and Rohrbach, M.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Multimodal compact bilinear pooling for visual question answering and
visual grounding.

</span>
<span class="ltx_bibblock"><span id="bib.bibx7.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1606.01847</span>.

</span>
</li>
<li id="bib.bibx8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Gan et al<span id="bib.bibx8.1.1.1" class="ltx_text">.</span> 2017]</span>
<span class="ltx_bibblock">
Gan, C.; Li, Y.; Li, H.; Sun, C.; and Gong, B.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Vqs: Linking segmentations to questions and answers for supervised
attention in vqa and question-focused semantic segmentation.

</span>
<span class="ltx_bibblock"><span id="bib.bibx8.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1708.04686</span>.

</span>
</li>
<li id="bib.bibx9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[He et al<span id="bib.bibx9.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
He, K.; Zhang, X.; Ren, S.; and Sun, J.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx9.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, 770–778.

</span>
</li>
<li id="bib.bibx10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Jiang et al<span id="bib.bibx10.1.1.1" class="ltx_text">.</span> 2015]</span>
<span class="ltx_bibblock">
Jiang, M.; Huang, S.; Duan, J.; and Zhao, Q.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Salicon: Saliency in context.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx10.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, 1072–1080.

</span>
</li>
<li id="bib.bibx11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Kim et al<span id="bib.bibx11.1.1.1" class="ltx_text">.</span> 2016a]</span>
<span class="ltx_bibblock">
Kim, J.-H.; Lee, S.-W.; Kwak, D.; Heo, M.-O.; Kim, J.; Ha, J.-W.; and Zhang,
B.-T.

</span>
<span class="ltx_bibblock">2016a.

</span>
<span class="ltx_bibblock">Multimodal residual learning for visual qa.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx11.3.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
361–369.

</span>
</li>
<li id="bib.bibx12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Kim et al<span id="bib.bibx12.1.1.1" class="ltx_text">.</span> 2016b]</span>
<span class="ltx_bibblock">
Kim, J.-H.; On, K.-W.; Kim, J.; Ha, J.-W.; and Zhang, B.-T.

</span>
<span class="ltx_bibblock">2016b.

</span>
<span class="ltx_bibblock">Hadamard product for low-rank bilinear pooling.

</span>
<span class="ltx_bibblock"><span id="bib.bibx12.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1610.04325</span>.

</span>
</li>
<li id="bib.bibx13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Kingma and Ba 2014]</span>
<span class="ltx_bibblock">
Kingma, D., and Ba, J.

</span>
<span class="ltx_bibblock">2014.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bibx13.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1412.6980</span>.

</span>
</li>
<li id="bib.bibx14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Kiros et al<span id="bib.bibx14.1.1.1" class="ltx_text">.</span> 2015]</span>
<span class="ltx_bibblock">
Kiros, R.; Zhu, Y.; Salakhutdinov, R. R.; Zemel, R.; Urtasun, R.; Torralba, A.;
and Fidler, S.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Skip-thought vectors.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx14.3.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
3294–3302.

</span>
</li>
<li id="bib.bibx15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Kumar et al<span id="bib.bibx15.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
Kumar, A.; Irsoy, O.; Ondruska, P.; Iyyer, M.; Bradbury, J.; Gulrajani, I.;
Zhong, V.; Paulus, R.; and Socher, R.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Ask me anything: Dynamic memory networks for natural language
processing.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx15.3.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, 1378–1387.

</span>
</li>
<li id="bib.bibx16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Liu et al<span id="bib.bibx16.1.1.1" class="ltx_text">.</span> 2017]</span>
<span class="ltx_bibblock">
Liu, C.; Mao, J.; Sha, F.; and Yuille, A. L.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Attention correctness in neural image captioning.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx16.3.1" class="ltx_text ltx_font_italic">Association for the Advancement of Artificial Intelligence</span>,
4176–4182.

</span>
</li>
<li id="bib.bibx17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Lu et al<span id="bib.bibx17.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
Lu, J.; Yang, J.; Batra, D.; and Parikh, D.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Hierarchical question-image co-attention for visual question
answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx17.3.1" class="ltx_text ltx_font_italic">Advances In Neural Information Processing Systems</span>,
289–297.

</span>
</li>
<li id="bib.bibx18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Malinowski, Rohrbach, and
Fritz 2015]</span>
<span class="ltx_bibblock">
Malinowski, M.; Rohrbach, M.; and Fritz, M.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Ask your neurons: A neural-based approach to answering questions
about images.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx18.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE International Conference on Computer
Vision</span>, 1–9.

</span>
</li>
<li id="bib.bibx19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Nam, Ha, and Kim 2016]</span>
<span class="ltx_bibblock">
Nam, H.; Ha, J.-W.; and Kim, J.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Dual attention networks for multimodal reasoning and matching.

</span>
<span class="ltx_bibblock"><span id="bib.bibx19.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1611.00471</span>.

</span>
</li>
<li id="bib.bibx20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Noh, Hongsuck Seo, and
Han 2016]</span>
<span class="ltx_bibblock">
Noh, H.; Hongsuck Seo, P.; and Han, B.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Image question answering using convolutional neural network with
dynamic parameter prediction.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx20.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, 30–38.

</span>
</li>
<li id="bib.bibx21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Shih, Singh, and Hoiem 2016]</span>
<span class="ltx_bibblock">
Shih, K. J.; Singh, S.; and Hoiem, D.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Where to look: Focus regions for visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx21.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, 4613–4621.

</span>
</li>
<li id="bib.bibx22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Yang et al<span id="bib.bibx22.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
Yang, Z.; He, X.; Gao, J.; Deng, L.; and Smola, A.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Stacked attention networks for image question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx22.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, 21–29.

</span>
</li>
<li id="bib.bibx23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Yu et al<span id="bib.bibx23.1.1.1" class="ltx_text">.</span> 2017]</span>
<span class="ltx_bibblock">
Yu, Y.; Choi, J.; Kim, Y.; Yoo, K.; Lee, S.-H.; and Kim, G.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Supervising neural attention models for video captioning by human
gaze data.

</span>
<span class="ltx_bibblock"><span id="bib.bibx23.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1707.06029</span>.

</span>
</li>
<li id="bib.bibx24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Zhou et al<span id="bib.bibx24.1.1.1" class="ltx_text">.</span> 2015]</span>
<span class="ltx_bibblock">
Zhou, B.; Tian, Y.; Sukhbaatar, S.; Szlam, A.; and Fergus, R.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Simple baseline for visual question answering.

</span>
<span class="ltx_bibblock"><span id="bib.bibx24.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1512.02167</span>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="Sx6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Supplementary Material</h2>

<div id="Sx6.p1" class="ltx_para ltx_noindent">
<svg version="1.1" fill="none" height="0" stroke="none" width="0" overflow="visible"><g transform="translate(0,0) scale(1,-1)"><g transform="translate(0,-449.7)"><g transform="translate(0,750.518887505189) scale(1, -1)"><foreignObject width="700.013837000138" height="380.102393801024" overflow="visible">
<div id="Sx6.p1.pic1.2.2" class="ltx_logical-block ltx_minipage ltx_align_middle" style="width:505.9pt;">
<div id="Sx6.p1.pic1.2.2.p1" class="ltx_para">
<img src="/html/1709.06308/assets/x6.png" id="Sx6.p1.pic1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="415" height="566" alt="[Uncaptioned image]">
</div>
<figure id="Sx6.F6" class="ltx_figure ltx_align_center">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Examples of the human attention and the attention generated by the HAN. As it can be seen in the figure, the attention generated by the HAN has comparable quality as the human attention.</figcaption>
</figure>
</div></foreignObject></g></g></g></svg>
</div>
<figure id="Sx6.F7" class="ltx_figure"><img src="/html/1709.06308/assets/x7.png" id="Sx6.F7.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="415" height="608" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Examples of the attention generated by the unsupervised model and the supervised model. As it can be observed, before attention supervision, the generated attention is relatively coarse and inaccurate. However, after attention supervision, the model generates more accurate attention and yields better answers. In (k), (l), (m) and (n), two models predict the same answers, however the supervised model has more confidence on the results as it has more accurate attention.</figcaption>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1709.06307" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1709.06308" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1709.06308">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1709.06308" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1709.06309" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar  7 23:59:49 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
