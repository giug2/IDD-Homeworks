<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2401.13191] Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model</title><meta property="og:description" content="Recently, deep learning-based facial landmark detection for in-the-wild faces has achieved significant improvement. However, there are still challenges in face landmark detection in other domains (e.g. cartoon, caricat…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2401.13191">

<!--Generated on Tue Feb 27 08:12:14 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Recently, deep learning-based facial landmark detection for in-the-wild faces has achieved significant improvement. However, there are still challenges in face landmark detection in other domains (<span id="id1.id1.1" class="ltx_text ltx_font_italic">e</span>.<span id="id1.id1.2" class="ltx_text ltx_font_italic">g</span>. cartoon, caricature, etc). This is due to the scarcity of extensively annotated training data. To tackle this concern, we design a two-stage training approach that effectively leverages limited datasets and the pre-trained diffusion model to obtain aligned pairs of landmarks and face in multiple domains. In the first stage, we train a landmark-conditioned face generation model on a large dataset of real faces. In the second stage, we fine-tune the above model on a small dataset of image-landmark pairs with text prompts for controlling the domain. Our new designs enable our method to generate high-quality synthetic paired datasets from multiple domains while preserving the alignment between landmarks and facial features. Finally, we fine-tuned a pre-trained face landmark detection model on the synthetic dataset to achieve multi-domain face landmark detection. Our qualitative and quantitative results demonstrate that our method outperforms existing methods on multi-domain face landmark detection.</p>
</div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Index Terms<span id="p1.1.1.1" class="ltx_text ltx_font_upright">— </span></span>
face landmark detection, diffusion model, fine-tuning, domain adaptation</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Facial landmark detection is a critical area in computer vision, with applications <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> in a wide range of technologies, including 3D facial reconstruction, face recognition, expression recognition, and augmented reality (AR)/virtual reality (VR). While supervised landmark detection has made significant progress for in-the-wild faces <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, facial landmark recognition for new image domains (such as art, cartoon, and caricature) still faces challenges. The main challenge is the lack of paired image-landmark datasets from other domains. Data collection is also a time-consuming and expensive process.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Existing methods mainly use geometry warping and style translation to transform existing face landmark datasets into a data distribution that is similar to the target domain. Yaniv <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> propose an approach for augmenting natural face images artistically, enabling the training of networks to detect landmarks in artistic portraits. Facial landmark datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> are transformed into ”artistic face” data using a technique known as geometric-aware style transfer. This process combines a gram matrix-based method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> for transferring artistic styles with geometric warping to achieve the transfer of facial features and geometry. Recently, Sindel <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> introduced an approach to detect facial landmarks in high-resolution paintings and prints. Similar to the previous method, they also use geometric-aware style transfer to perform augmentation on the dataset. What sets it apart is that it employed CycleGAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> to perform style transfer on the images. However, when dealing with datasets that exhibit a substantial domain gap from real images, such as cartoons, caricatures, etc., the geometric-aware style transfer used in these methods tends not to work well, leading to suboptimal results in terms of image translation. Cai <span id="S1.p2.1.3" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> also proposed an automatic method for 3D caricature reconstruction. The method is to first regress a 3D face model and orientation and then project 3D landmarks and orientation to recover 2D landmarks. However, their method is only applicable to caricatures and requires a large amount of data to train.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Recent advances in text-to-image synthesis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> have shown impressive performance and creativity, enabling the conversion of text descriptions into visually appealing creations. These generative systems excel in a variety of areas, including rendering realistic and diverse appearances, powerful editing, etc. In more recent developments, ControlNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> extends the capabilities of pretrained diffusion models using auxiliary input conditions. ControlNet proficiently captures task-specific conditions like pose, depth map, and semantic map, demonstrating robustness even when trained on limited datasets.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we tackle multi-domain face landmark detection by leveraging synthetic data generated through a text-to-image diffusion model. Firstly, our goal is to generate high-quality data pairs of multi-domain face images and their landmarks. We propose a two-stage training approach that generates high-quality data pairs of multi-domain face images and their landmarks using a small dataset and pre-trained text-image model based on ControlNet. In the first stage, we train ControlNet on a large dataset of real-world faces <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. We use facial landmarks as a condition aligned with the face image as a condition for generating the face image. In the second stage, the pre-trained model is fine-tuned using a small multi-domain face dataset to generate face images of diverse domains. Secondly, we created a large multi-domain facial landmark dataset of 25 styles, each of which contains 400 images with annotations. We control the geometric characteristics and styles of face images by editing landmarks and text prompts. Finally, we fine-tune the existing face landmark detection model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> on this dataset, which achieved state-of-the-art performance on the ArtFace<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and Caricature datasets<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Proposed Method</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Our method is based on the pre-trained text-to-image model, <span id="S2.p1.1.1" class="ltx_text ltx_font_italic">i</span>.<span id="S2.p1.1.2" class="ltx_text ltx_font_italic">e</span>., latent diffusion model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. In this section, we first give a brief introduction to the details of the latent diffusion model in Sec. <a href="#S2.SS1" title="2.1 Latent Diffusion Model ‣ 2 Proposed Method ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.1</span></a>. Next, we present an overview of our landmark-guided diffusion model in Sec. <a href="#S2.SS2" title="2.2 Landmark-guided Latent Diffusion Model ‣ 2 Proposed Method ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2</span></a> and describe our procedure for generating synthetic datasets in Sec. <a href="#S2.SS3" title="2.3 Synthetic Dataset Geneartion ‣ 2 Proposed Method ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.3</span></a>. Finally, we describe the fine-tuning process for the face landmark detector in Sec. <a href="#S2.SS4" title="2.4 Fine-tuning Landmark Detection Model ‣ 2 Proposed Method ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.4</span></a>.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2401.13191/assets/x1.png" id="S2.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="376" height="179" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F1.3.1.1" class="ltx_text ltx_font_bold">Fig. 1</span>: </span>Overview of our proposed framework. We propose a two-stage framework for creating a high-quality multi-domain face from a face landmark with diffusion prior. (a) First stage, we train our model with a pair of real faces and landmarks. (b) Second stage, we further fine-tune the model with a small multi-domain dataset. (c) We generate diverse facial data by controlling both the text and landmarks. (d) We fine-tune the pre-trained landmark detector with the synthetic dataset.</figcaption>
</figure>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Latent Diffusion Model</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.7" class="ltx_p">The Latent Diffusion Model (LDM) is a diffusion model that has recently exhibited exceptional performance in the realm of image synthesis. It comprises two main components: an autoencoder and a diffusion model. The autoencoder, consisting of an encoder <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">E</annotation></semantics></math> and a decoder <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">D</annotation></semantics></math>, learns to reconstruct images. The encoder first projects an image x into a lower-dimensional latent space: <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="z=E(I)" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.2" xref="S2.SS1.p1.3.m3.1.2.cmml"><mi id="S2.SS1.p1.3.m3.1.2.2" xref="S2.SS1.p1.3.m3.1.2.2.cmml">z</mi><mo id="S2.SS1.p1.3.m3.1.2.1" xref="S2.SS1.p1.3.m3.1.2.1.cmml">=</mo><mrow id="S2.SS1.p1.3.m3.1.2.3" xref="S2.SS1.p1.3.m3.1.2.3.cmml"><mi id="S2.SS1.p1.3.m3.1.2.3.2" xref="S2.SS1.p1.3.m3.1.2.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.3.m3.1.2.3.1" xref="S2.SS1.p1.3.m3.1.2.3.1.cmml">​</mo><mrow id="S2.SS1.p1.3.m3.1.2.3.3.2" xref="S2.SS1.p1.3.m3.1.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.1.2.3.3.2.1" xref="S2.SS1.p1.3.m3.1.2.3.cmml">(</mo><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">I</mi><mo stretchy="false" id="S2.SS1.p1.3.m3.1.2.3.3.2.2" xref="S2.SS1.p1.3.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.2.cmml" xref="S2.SS1.p1.3.m3.1.2"><eq id="S2.SS1.p1.3.m3.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.2.1"></eq><ci id="S2.SS1.p1.3.m3.1.2.2.cmml" xref="S2.SS1.p1.3.m3.1.2.2">𝑧</ci><apply id="S2.SS1.p1.3.m3.1.2.3.cmml" xref="S2.SS1.p1.3.m3.1.2.3"><times id="S2.SS1.p1.3.m3.1.2.3.1.cmml" xref="S2.SS1.p1.3.m3.1.2.3.1"></times><ci id="S2.SS1.p1.3.m3.1.2.3.2.cmml" xref="S2.SS1.p1.3.m3.1.2.3.2">𝐸</ci><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">z=E(I)</annotation></semantics></math>, and the decoder reconstructs the original image from the latent space: <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="\hat{I}=D(z)" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.2" xref="S2.SS1.p1.4.m4.1.2.cmml"><mover accent="true" id="S2.SS1.p1.4.m4.1.2.2" xref="S2.SS1.p1.4.m4.1.2.2.cmml"><mi id="S2.SS1.p1.4.m4.1.2.2.2" xref="S2.SS1.p1.4.m4.1.2.2.2.cmml">I</mi><mo id="S2.SS1.p1.4.m4.1.2.2.1" xref="S2.SS1.p1.4.m4.1.2.2.1.cmml">^</mo></mover><mo id="S2.SS1.p1.4.m4.1.2.1" xref="S2.SS1.p1.4.m4.1.2.1.cmml">=</mo><mrow id="S2.SS1.p1.4.m4.1.2.3" xref="S2.SS1.p1.4.m4.1.2.3.cmml"><mi id="S2.SS1.p1.4.m4.1.2.3.2" xref="S2.SS1.p1.4.m4.1.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.4.m4.1.2.3.1" xref="S2.SS1.p1.4.m4.1.2.3.1.cmml">​</mo><mrow id="S2.SS1.p1.4.m4.1.2.3.3.2" xref="S2.SS1.p1.4.m4.1.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.1.2.3.3.2.1" xref="S2.SS1.p1.4.m4.1.2.3.cmml">(</mo><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">z</mi><mo stretchy="false" id="S2.SS1.p1.4.m4.1.2.3.3.2.2" xref="S2.SS1.p1.4.m4.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.2.cmml" xref="S2.SS1.p1.4.m4.1.2"><eq id="S2.SS1.p1.4.m4.1.2.1.cmml" xref="S2.SS1.p1.4.m4.1.2.1"></eq><apply id="S2.SS1.p1.4.m4.1.2.2.cmml" xref="S2.SS1.p1.4.m4.1.2.2"><ci id="S2.SS1.p1.4.m4.1.2.2.1.cmml" xref="S2.SS1.p1.4.m4.1.2.2.1">^</ci><ci id="S2.SS1.p1.4.m4.1.2.2.2.cmml" xref="S2.SS1.p1.4.m4.1.2.2.2">𝐼</ci></apply><apply id="S2.SS1.p1.4.m4.1.2.3.cmml" xref="S2.SS1.p1.4.m4.1.2.3"><times id="S2.SS1.p1.4.m4.1.2.3.1.cmml" xref="S2.SS1.p1.4.m4.1.2.3.1"></times><ci id="S2.SS1.p1.4.m4.1.2.3.2.cmml" xref="S2.SS1.p1.4.m4.1.2.3.2">𝐷</ci><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\hat{I}=D(z)</annotation></semantics></math>. Then, the Denoising Diffusion Probabilistic Model (DDPM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> is employed to generate the latent <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">z</annotation></semantics></math>. DDPM adds noise to <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="z_{0}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">z</mi><mn id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝑧</ci><cn type="integer" id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">z_{0}</annotation></semantics></math> gradually with <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">T</annotation></semantics></math> timesteps to mimic diffusion in non-equilibrium thermodynamics, which can be modeled as:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.4" class="ltx_Math" alttext="q(z_{t}|z_{t-1}):=N(z_{t};\sqrt{1-\beta_{t}}z_{t-1},\beta_{t})" display="block"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.3" xref="S2.E1.m1.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S2.E1.m1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.2.cmml">z</mi><mrow id="S2.E1.m1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.E1.m1.1.1.1.1.1.1.3.3.1" xref="S2.E1.m1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E1.m1.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo rspace="0.278em" stretchy="false" id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.E1.m1.4.4.5" xref="S2.E1.m1.4.4.5.cmml">:=</mo><mrow id="S2.E1.m1.4.4.4" xref="S2.E1.m1.4.4.4.cmml"><mi id="S2.E1.m1.4.4.4.5" xref="S2.E1.m1.4.4.4.5.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.4.4" xref="S2.E1.m1.4.4.4.4.cmml">​</mo><mrow id="S2.E1.m1.4.4.4.3.3" xref="S2.E1.m1.4.4.4.3.4.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.4.3.3.4" xref="S2.E1.m1.4.4.4.3.4.cmml">(</mo><msub id="S2.E1.m1.2.2.2.1.1.1" xref="S2.E1.m1.2.2.2.1.1.1.cmml"><mi id="S2.E1.m1.2.2.2.1.1.1.2" xref="S2.E1.m1.2.2.2.1.1.1.2.cmml">z</mi><mi id="S2.E1.m1.2.2.2.1.1.1.3" xref="S2.E1.m1.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S2.E1.m1.4.4.4.3.3.5" xref="S2.E1.m1.4.4.4.3.4.cmml">;</mo><mrow id="S2.E1.m1.3.3.3.2.2.2" xref="S2.E1.m1.3.3.3.2.2.2.cmml"><msqrt id="S2.E1.m1.3.3.3.2.2.2.2" xref="S2.E1.m1.3.3.3.2.2.2.2.cmml"><mrow id="S2.E1.m1.3.3.3.2.2.2.2.2" xref="S2.E1.m1.3.3.3.2.2.2.2.2.cmml"><mn id="S2.E1.m1.3.3.3.2.2.2.2.2.2" xref="S2.E1.m1.3.3.3.2.2.2.2.2.2.cmml">1</mn><mo id="S2.E1.m1.3.3.3.2.2.2.2.2.1" xref="S2.E1.m1.3.3.3.2.2.2.2.2.1.cmml">−</mo><msub id="S2.E1.m1.3.3.3.2.2.2.2.2.3" xref="S2.E1.m1.3.3.3.2.2.2.2.2.3.cmml"><mi id="S2.E1.m1.3.3.3.2.2.2.2.2.3.2" xref="S2.E1.m1.3.3.3.2.2.2.2.2.3.2.cmml">β</mi><mi id="S2.E1.m1.3.3.3.2.2.2.2.2.3.3" xref="S2.E1.m1.3.3.3.2.2.2.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.3.2.2.2.1" xref="S2.E1.m1.3.3.3.2.2.2.1.cmml">​</mo><msub id="S2.E1.m1.3.3.3.2.2.2.3" xref="S2.E1.m1.3.3.3.2.2.2.3.cmml"><mi id="S2.E1.m1.3.3.3.2.2.2.3.2" xref="S2.E1.m1.3.3.3.2.2.2.3.2.cmml">z</mi><mrow id="S2.E1.m1.3.3.3.2.2.2.3.3" xref="S2.E1.m1.3.3.3.2.2.2.3.3.cmml"><mi id="S2.E1.m1.3.3.3.2.2.2.3.3.2" xref="S2.E1.m1.3.3.3.2.2.2.3.3.2.cmml">t</mi><mo id="S2.E1.m1.3.3.3.2.2.2.3.3.1" xref="S2.E1.m1.3.3.3.2.2.2.3.3.1.cmml">−</mo><mn id="S2.E1.m1.3.3.3.2.2.2.3.3.3" xref="S2.E1.m1.3.3.3.2.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.E1.m1.4.4.4.3.3.6" xref="S2.E1.m1.4.4.4.3.4.cmml">,</mo><msub id="S2.E1.m1.4.4.4.3.3.3" xref="S2.E1.m1.4.4.4.3.3.3.cmml"><mi id="S2.E1.m1.4.4.4.3.3.3.2" xref="S2.E1.m1.4.4.4.3.3.3.2.cmml">β</mi><mi id="S2.E1.m1.4.4.4.3.3.3.3" xref="S2.E1.m1.4.4.4.3.3.3.3.cmml">t</mi></msub><mo stretchy="false" id="S2.E1.m1.4.4.4.3.3.7" xref="S2.E1.m1.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4"><csymbol cd="latexml" id="S2.E1.m1.4.4.5.cmml" xref="S2.E1.m1.4.4.5">assign</csymbol><apply id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><times id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.2"></times><ci id="S2.E1.m1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.3">𝑞</ci><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S2.E1.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2">𝑧</ci><apply id="S2.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3"><minus id="S2.E1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.1"></minus><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S2.E1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S2.E1.m1.4.4.4.cmml" xref="S2.E1.m1.4.4.4"><times id="S2.E1.m1.4.4.4.4.cmml" xref="S2.E1.m1.4.4.4.4"></times><ci id="S2.E1.m1.4.4.4.5.cmml" xref="S2.E1.m1.4.4.4.5">𝑁</ci><list id="S2.E1.m1.4.4.4.3.4.cmml" xref="S2.E1.m1.4.4.4.3.3"><apply id="S2.E1.m1.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.1.1.1.2">𝑧</ci><ci id="S2.E1.m1.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="S2.E1.m1.3.3.3.2.2.2.cmml" xref="S2.E1.m1.3.3.3.2.2.2"><times id="S2.E1.m1.3.3.3.2.2.2.1.cmml" xref="S2.E1.m1.3.3.3.2.2.2.1"></times><apply id="S2.E1.m1.3.3.3.2.2.2.2.cmml" xref="S2.E1.m1.3.3.3.2.2.2.2"><root id="S2.E1.m1.3.3.3.2.2.2.2a.cmml" xref="S2.E1.m1.3.3.3.2.2.2.2"></root><apply id="S2.E1.m1.3.3.3.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.3.2.2.2.2.2"><minus id="S2.E1.m1.3.3.3.2.2.2.2.2.1.cmml" xref="S2.E1.m1.3.3.3.2.2.2.2.2.1"></minus><cn type="integer" id="S2.E1.m1.3.3.3.2.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.3.2.2.2.2.2.2">1</cn><apply id="S2.E1.m1.3.3.3.2.2.2.2.2.3.cmml" xref="S2.E1.m1.3.3.3.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.3.2.2.2.2.2.3.1.cmml" xref="S2.E1.m1.3.3.3.2.2.2.2.2.3">subscript</csymbol><ci id="S2.E1.m1.3.3.3.2.2.2.2.2.3.2.cmml" xref="S2.E1.m1.3.3.3.2.2.2.2.2.3.2">𝛽</ci><ci id="S2.E1.m1.3.3.3.2.2.2.2.2.3.3.cmml" xref="S2.E1.m1.3.3.3.2.2.2.2.2.3.3">𝑡</ci></apply></apply></apply><apply id="S2.E1.m1.3.3.3.2.2.2.3.cmml" xref="S2.E1.m1.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.3.2.2.2.3.1.cmml" xref="S2.E1.m1.3.3.3.2.2.2.3">subscript</csymbol><ci id="S2.E1.m1.3.3.3.2.2.2.3.2.cmml" xref="S2.E1.m1.3.3.3.2.2.2.3.2">𝑧</ci><apply id="S2.E1.m1.3.3.3.2.2.2.3.3.cmml" xref="S2.E1.m1.3.3.3.2.2.2.3.3"><minus id="S2.E1.m1.3.3.3.2.2.2.3.3.1.cmml" xref="S2.E1.m1.3.3.3.2.2.2.3.3.1"></minus><ci id="S2.E1.m1.3.3.3.2.2.2.3.3.2.cmml" xref="S2.E1.m1.3.3.3.2.2.2.3.3.2">𝑡</ci><cn type="integer" id="S2.E1.m1.3.3.3.2.2.2.3.3.3.cmml" xref="S2.E1.m1.3.3.3.2.2.2.3.3.3">1</cn></apply></apply></apply><apply id="S2.E1.m1.4.4.4.3.3.3.cmml" xref="S2.E1.m1.4.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.4.3.3.3.1.cmml" xref="S2.E1.m1.4.4.4.3.3.3">subscript</csymbol><ci id="S2.E1.m1.4.4.4.3.3.3.2.cmml" xref="S2.E1.m1.4.4.4.3.3.3.2">𝛽</ci><ci id="S2.E1.m1.4.4.4.3.3.3.3.cmml" xref="S2.E1.m1.4.4.4.3.3.3.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">q(z_{t}|z_{t-1}):=N(z_{t};\sqrt{1-\beta_{t}}z_{t-1},\beta_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.8" class="ltx_p">The Markov chain is a gradually forward noising process by a predefined noise schedule <math id="S2.SS1.p1.8.m1.3" class="ltx_Math" alttext="{\beta_{1},...,\beta_{T}}" display="inline"><semantics id="S2.SS1.p1.8.m1.3a"><mrow id="S2.SS1.p1.8.m1.3.3.2" xref="S2.SS1.p1.8.m1.3.3.3.cmml"><msub id="S2.SS1.p1.8.m1.2.2.1.1" xref="S2.SS1.p1.8.m1.2.2.1.1.cmml"><mi id="S2.SS1.p1.8.m1.2.2.1.1.2" xref="S2.SS1.p1.8.m1.2.2.1.1.2.cmml">β</mi><mn id="S2.SS1.p1.8.m1.2.2.1.1.3" xref="S2.SS1.p1.8.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.8.m1.3.3.2.3" xref="S2.SS1.p1.8.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.8.m1.1.1" xref="S2.SS1.p1.8.m1.1.1.cmml">…</mi><mo id="S2.SS1.p1.8.m1.3.3.2.4" xref="S2.SS1.p1.8.m1.3.3.3.cmml">,</mo><msub id="S2.SS1.p1.8.m1.3.3.2.2" xref="S2.SS1.p1.8.m1.3.3.2.2.cmml"><mi id="S2.SS1.p1.8.m1.3.3.2.2.2" xref="S2.SS1.p1.8.m1.3.3.2.2.2.cmml">β</mi><mi id="S2.SS1.p1.8.m1.3.3.2.2.3" xref="S2.SS1.p1.8.m1.3.3.2.2.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m1.3b"><list id="S2.SS1.p1.8.m1.3.3.3.cmml" xref="S2.SS1.p1.8.m1.3.3.2"><apply id="S2.SS1.p1.8.m1.2.2.1.1.cmml" xref="S2.SS1.p1.8.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.2.2.1.1.1.cmml" xref="S2.SS1.p1.8.m1.2.2.1.1">subscript</csymbol><ci id="S2.SS1.p1.8.m1.2.2.1.1.2.cmml" xref="S2.SS1.p1.8.m1.2.2.1.1.2">𝛽</ci><cn type="integer" id="S2.SS1.p1.8.m1.2.2.1.1.3.cmml" xref="S2.SS1.p1.8.m1.2.2.1.1.3">1</cn></apply><ci id="S2.SS1.p1.8.m1.1.1.cmml" xref="S2.SS1.p1.8.m1.1.1">…</ci><apply id="S2.SS1.p1.8.m1.3.3.2.2.cmml" xref="S2.SS1.p1.8.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.3.3.2.2.1.cmml" xref="S2.SS1.p1.8.m1.3.3.2.2">subscript</csymbol><ci id="S2.SS1.p1.8.m1.3.3.2.2.2.cmml" xref="S2.SS1.p1.8.m1.3.3.2.2.2">𝛽</ci><ci id="S2.SS1.p1.8.m1.3.3.2.2.3.cmml" xref="S2.SS1.p1.8.m1.3.3.2.2.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m1.3c">{\beta_{1},...,\beta_{T}}</annotation></semantics></math>. Subsequently, they proceed to construct and train a U-Net model to acquire an understanding of the reverse diffusion process, denoted as:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.4" class="ltx_Math" alttext="q(z_{t}|z_{0})=N(z_{t};\sqrt{\bar{\alpha}_{t}}z_{0},(1-\bar{\alpha}_{t})I)" display="block"><semantics id="S2.E2.m1.4a"><mrow id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S2.E2.m1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S2.E2.m1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.1.1.3.2.cmml">z</mi><mn id="S2.E2.m1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.4.4.5" xref="S2.E2.m1.4.4.5.cmml">=</mo><mrow id="S2.E2.m1.4.4.4" xref="S2.E2.m1.4.4.4.cmml"><mi id="S2.E2.m1.4.4.4.5" xref="S2.E2.m1.4.4.4.5.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.4.4" xref="S2.E2.m1.4.4.4.4.cmml">​</mo><mrow id="S2.E2.m1.4.4.4.3.3" xref="S2.E2.m1.4.4.4.3.4.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.4.3.3.4" xref="S2.E2.m1.4.4.4.3.4.cmml">(</mo><msub id="S2.E2.m1.2.2.2.1.1.1" xref="S2.E2.m1.2.2.2.1.1.1.cmml"><mi id="S2.E2.m1.2.2.2.1.1.1.2" xref="S2.E2.m1.2.2.2.1.1.1.2.cmml">z</mi><mi id="S2.E2.m1.2.2.2.1.1.1.3" xref="S2.E2.m1.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S2.E2.m1.4.4.4.3.3.5" xref="S2.E2.m1.4.4.4.3.4.cmml">;</mo><mrow id="S2.E2.m1.3.3.3.2.2.2" xref="S2.E2.m1.3.3.3.2.2.2.cmml"><msqrt id="S2.E2.m1.3.3.3.2.2.2.2" xref="S2.E2.m1.3.3.3.2.2.2.2.cmml"><msub id="S2.E2.m1.3.3.3.2.2.2.2.2" xref="S2.E2.m1.3.3.3.2.2.2.2.2.cmml"><mover accent="true" id="S2.E2.m1.3.3.3.2.2.2.2.2.2" xref="S2.E2.m1.3.3.3.2.2.2.2.2.2.cmml"><mi id="S2.E2.m1.3.3.3.2.2.2.2.2.2.2" xref="S2.E2.m1.3.3.3.2.2.2.2.2.2.2.cmml">α</mi><mo id="S2.E2.m1.3.3.3.2.2.2.2.2.2.1" xref="S2.E2.m1.3.3.3.2.2.2.2.2.2.1.cmml">¯</mo></mover><mi id="S2.E2.m1.3.3.3.2.2.2.2.2.3" xref="S2.E2.m1.3.3.3.2.2.2.2.2.3.cmml">t</mi></msub></msqrt><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.3.2.2.2.1" xref="S2.E2.m1.3.3.3.2.2.2.1.cmml">​</mo><msub id="S2.E2.m1.3.3.3.2.2.2.3" xref="S2.E2.m1.3.3.3.2.2.2.3.cmml"><mi id="S2.E2.m1.3.3.3.2.2.2.3.2" xref="S2.E2.m1.3.3.3.2.2.2.3.2.cmml">z</mi><mn id="S2.E2.m1.3.3.3.2.2.2.3.3" xref="S2.E2.m1.3.3.3.2.2.2.3.3.cmml">0</mn></msub></mrow><mo id="S2.E2.m1.4.4.4.3.3.6" xref="S2.E2.m1.4.4.4.3.4.cmml">,</mo><mrow id="S2.E2.m1.4.4.4.3.3.3" xref="S2.E2.m1.4.4.4.3.3.3.cmml"><mrow id="S2.E2.m1.4.4.4.3.3.3.1.1" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.4.3.3.3.1.1.2" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.4.4.4.3.3.3.1.1.1" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.cmml"><mn id="S2.E2.m1.4.4.4.3.3.3.1.1.1.2" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.2.cmml">1</mn><mo id="S2.E2.m1.4.4.4.3.3.3.1.1.1.1" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.1.cmml">−</mo><msub id="S2.E2.m1.4.4.4.3.3.3.1.1.1.3" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.cmml"><mover accent="true" id="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.2" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.2.cmml"><mi id="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.2.2" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.2.2.cmml">α</mi><mo id="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.2.1" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.3" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S2.E2.m1.4.4.4.3.3.3.1.1.3" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.4.3.3.3.2" xref="S2.E2.m1.4.4.4.3.3.3.2.cmml">​</mo><mi id="S2.E2.m1.4.4.4.3.3.3.3" xref="S2.E2.m1.4.4.4.3.3.3.3.cmml">I</mi></mrow><mo stretchy="false" id="S2.E2.m1.4.4.4.3.3.7" xref="S2.E2.m1.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.4b"><apply id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4"><eq id="S2.E2.m1.4.4.5.cmml" xref="S2.E2.m1.4.4.5"></eq><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><times id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></times><ci id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3">𝑞</ci><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.2">𝑧</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><apply id="S2.E2.m1.4.4.4.cmml" xref="S2.E2.m1.4.4.4"><times id="S2.E2.m1.4.4.4.4.cmml" xref="S2.E2.m1.4.4.4.4"></times><ci id="S2.E2.m1.4.4.4.5.cmml" xref="S2.E2.m1.4.4.4.5">𝑁</ci><list id="S2.E2.m1.4.4.4.3.4.cmml" xref="S2.E2.m1.4.4.4.3.3"><apply id="S2.E2.m1.2.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.2.1.1.1.2">𝑧</ci><ci id="S2.E2.m1.2.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="S2.E2.m1.3.3.3.2.2.2.cmml" xref="S2.E2.m1.3.3.3.2.2.2"><times id="S2.E2.m1.3.3.3.2.2.2.1.cmml" xref="S2.E2.m1.3.3.3.2.2.2.1"></times><apply id="S2.E2.m1.3.3.3.2.2.2.2.cmml" xref="S2.E2.m1.3.3.3.2.2.2.2"><root id="S2.E2.m1.3.3.3.2.2.2.2a.cmml" xref="S2.E2.m1.3.3.3.2.2.2.2"></root><apply id="S2.E2.m1.3.3.3.2.2.2.2.2.cmml" xref="S2.E2.m1.3.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.3.2.2.2.2.2.1.cmml" xref="S2.E2.m1.3.3.3.2.2.2.2.2">subscript</csymbol><apply id="S2.E2.m1.3.3.3.2.2.2.2.2.2.cmml" xref="S2.E2.m1.3.3.3.2.2.2.2.2.2"><ci id="S2.E2.m1.3.3.3.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.3.3.3.2.2.2.2.2.2.1">¯</ci><ci id="S2.E2.m1.3.3.3.2.2.2.2.2.2.2.cmml" xref="S2.E2.m1.3.3.3.2.2.2.2.2.2.2">𝛼</ci></apply><ci id="S2.E2.m1.3.3.3.2.2.2.2.2.3.cmml" xref="S2.E2.m1.3.3.3.2.2.2.2.2.3">𝑡</ci></apply></apply><apply id="S2.E2.m1.3.3.3.2.2.2.3.cmml" xref="S2.E2.m1.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.3.2.2.2.3.1.cmml" xref="S2.E2.m1.3.3.3.2.2.2.3">subscript</csymbol><ci id="S2.E2.m1.3.3.3.2.2.2.3.2.cmml" xref="S2.E2.m1.3.3.3.2.2.2.3.2">𝑧</ci><cn type="integer" id="S2.E2.m1.3.3.3.2.2.2.3.3.cmml" xref="S2.E2.m1.3.3.3.2.2.2.3.3">0</cn></apply></apply><apply id="S2.E2.m1.4.4.4.3.3.3.cmml" xref="S2.E2.m1.4.4.4.3.3.3"><times id="S2.E2.m1.4.4.4.3.3.3.2.cmml" xref="S2.E2.m1.4.4.4.3.3.3.2"></times><apply id="S2.E2.m1.4.4.4.3.3.3.1.1.1.cmml" xref="S2.E2.m1.4.4.4.3.3.3.1.1"><minus id="S2.E2.m1.4.4.4.3.3.3.1.1.1.1.cmml" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.1"></minus><cn type="integer" id="S2.E2.m1.4.4.4.3.3.3.1.1.1.2.cmml" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.2">1</cn><apply id="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.cmml" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.1.cmml" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.3">subscript</csymbol><apply id="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.2.cmml" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.2"><ci id="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.2.1.cmml" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.2.1">¯</ci><ci id="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.2.2.cmml" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.2.2">𝛼</ci></apply><ci id="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.3.cmml" xref="S2.E2.m1.4.4.4.3.3.3.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S2.E2.m1.4.4.4.3.3.3.3.cmml" xref="S2.E2.m1.4.4.4.3.3.3.3">𝐼</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.4c">q(z_{t}|z_{0})=N(z_{t};\sqrt{\bar{\alpha}_{t}}z_{0},(1-\bar{\alpha}_{t})I)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.4" class="ltx_p">The reverse process starts from <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="z_{T}" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><msub id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml">z</mi><mi id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2">𝑧</ci><ci id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">z_{T}</annotation></semantics></math> , which is close to an isotropic Gaussian. The U-Net then is trained to predict <math id="S2.SS1.p2.2.m2.1" class="ltx_Math" alttext="z_{t-1}" display="inline"><semantics id="S2.SS1.p2.2.m2.1a"><msub id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.1.1.2" xref="S2.SS1.p2.2.m2.1.1.2.cmml">z</mi><mrow id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3.cmml"><mi id="S2.SS1.p2.2.m2.1.1.3.2" xref="S2.SS1.p2.2.m2.1.1.3.2.cmml">t</mi><mo id="S2.SS1.p2.2.m2.1.1.3.1" xref="S2.SS1.p2.2.m2.1.1.3.1.cmml">−</mo><mn id="S2.SS1.p2.2.m2.1.1.3.3" xref="S2.SS1.p2.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2">𝑧</ci><apply id="S2.SS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3"><minus id="S2.SS1.p2.2.m2.1.1.3.1.cmml" xref="S2.SS1.p2.2.m2.1.1.3.1"></minus><ci id="S2.SS1.p2.2.m2.1.1.3.2.cmml" xref="S2.SS1.p2.2.m2.1.1.3.2">𝑡</ci><cn type="integer" id="S2.SS1.p2.2.m2.1.1.3.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">z_{t-1}</annotation></semantics></math> from <math id="S2.SS1.p2.3.m3.1" class="ltx_Math" alttext="z_{t}" display="inline"><semantics id="S2.SS1.p2.3.m3.1a"><msub id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml"><mi id="S2.SS1.p2.3.m3.1.1.2" xref="S2.SS1.p2.3.m3.1.1.2.cmml">z</mi><mi id="S2.SS1.p2.3.m3.1.1.3" xref="S2.SS1.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.2">𝑧</ci><ci id="S2.SS1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">z_{t}</annotation></semantics></math> by estimating the true posterior <math id="S2.SS1.p2.4.m4.1" class="ltx_Math" alttext="q(z_{t-1}|z_{t})" display="inline"><semantics id="S2.SS1.p2.4.m4.1a"><mrow id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">​</mo><mrow id="S2.SS1.p2.4.m4.1.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p2.4.m4.1.1.1.1.2" xref="S2.SS1.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.4.m4.1.1.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.1.1.cmml"><msub id="S2.SS1.p2.4.m4.1.1.1.1.1.2" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p2.4.m4.1.1.1.1.1.2.2" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.2.cmml">z</mi><mrow id="S2.SS1.p2.4.m4.1.1.1.1.1.2.3" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.cmml"><mi id="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.2" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.1" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.3" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S2.SS1.p2.4.m4.1.1.1.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.cmml">|</mo><msub id="S2.SS1.p2.4.m4.1.1.1.1.1.3" xref="S2.SS1.p2.4.m4.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p2.4.m4.1.1.1.1.1.3.2" xref="S2.SS1.p2.4.m4.1.1.1.1.1.3.2.cmml">z</mi><mi id="S2.SS1.p2.4.m4.1.1.1.1.1.3.3" xref="S2.SS1.p2.4.m4.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S2.SS1.p2.4.m4.1.1.1.1.3" xref="S2.SS1.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><times id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2"></times><ci id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3">𝑞</ci><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.2">𝑧</ci><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.3"><minus id="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.1"></minus><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.3.2">𝑧</ci><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">q(z_{t-1}|z_{t})</annotation></semantics></math> which can be modeled as:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.6" class="ltx_Math" alttext="p_{\theta}(z_{t-1}|z_{t})=N(z_{t-1};\mu_{\theta}(z_{t},t),\sigma_{\theta}(z_{t},t))" display="block"><semantics id="S2.E3.m1.6a"><mrow id="S2.E3.m1.6.6" xref="S2.E3.m1.6.6.cmml"><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.cmml"><msub id="S2.E3.m1.3.3.1.3" xref="S2.E3.m1.3.3.1.3.cmml"><mi id="S2.E3.m1.3.3.1.3.2" xref="S2.E3.m1.3.3.1.3.2.cmml">p</mi><mi id="S2.E3.m1.3.3.1.3.3" xref="S2.E3.m1.3.3.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.2" xref="S2.E3.m1.3.3.1.2.cmml">​</mo><mrow id="S2.E3.m1.3.3.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.3.3.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.3.3.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.cmml"><msub id="S2.E3.m1.3.3.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.2.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.2.2" xref="S2.E3.m1.3.3.1.1.1.1.2.2.cmml">z</mi><mrow id="S2.E3.m1.3.3.1.1.1.1.2.3" xref="S2.E3.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.2.3.2" xref="S2.E3.m1.3.3.1.1.1.1.2.3.2.cmml">t</mi><mo id="S2.E3.m1.3.3.1.1.1.1.2.3.1" xref="S2.E3.m1.3.3.1.1.1.1.2.3.1.cmml">−</mo><mn id="S2.E3.m1.3.3.1.1.1.1.2.3.3" xref="S2.E3.m1.3.3.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S2.E3.m1.3.3.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.cmml">|</mo><msub id="S2.E3.m1.3.3.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.3.2" xref="S2.E3.m1.3.3.1.1.1.1.3.2.cmml">z</mi><mi id="S2.E3.m1.3.3.1.1.1.1.3.3" xref="S2.E3.m1.3.3.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S2.E3.m1.3.3.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.6.6.5" xref="S2.E3.m1.6.6.5.cmml">=</mo><mrow id="S2.E3.m1.6.6.4" xref="S2.E3.m1.6.6.4.cmml"><mi id="S2.E3.m1.6.6.4.5" xref="S2.E3.m1.6.6.4.5.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.6.6.4.4" xref="S2.E3.m1.6.6.4.4.cmml">​</mo><mrow id="S2.E3.m1.6.6.4.3.3" xref="S2.E3.m1.6.6.4.3.4.cmml"><mo stretchy="false" id="S2.E3.m1.6.6.4.3.3.4" xref="S2.E3.m1.6.6.4.3.4.cmml">(</mo><msub id="S2.E3.m1.4.4.2.1.1.1" xref="S2.E3.m1.4.4.2.1.1.1.cmml"><mi id="S2.E3.m1.4.4.2.1.1.1.2" xref="S2.E3.m1.4.4.2.1.1.1.2.cmml">z</mi><mrow id="S2.E3.m1.4.4.2.1.1.1.3" xref="S2.E3.m1.4.4.2.1.1.1.3.cmml"><mi id="S2.E3.m1.4.4.2.1.1.1.3.2" xref="S2.E3.m1.4.4.2.1.1.1.3.2.cmml">t</mi><mo id="S2.E3.m1.4.4.2.1.1.1.3.1" xref="S2.E3.m1.4.4.2.1.1.1.3.1.cmml">−</mo><mn id="S2.E3.m1.4.4.2.1.1.1.3.3" xref="S2.E3.m1.4.4.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S2.E3.m1.6.6.4.3.3.5" xref="S2.E3.m1.6.6.4.3.4.cmml">;</mo><mrow id="S2.E3.m1.5.5.3.2.2.2" xref="S2.E3.m1.5.5.3.2.2.2.cmml"><msub id="S2.E3.m1.5.5.3.2.2.2.3" xref="S2.E3.m1.5.5.3.2.2.2.3.cmml"><mi id="S2.E3.m1.5.5.3.2.2.2.3.2" xref="S2.E3.m1.5.5.3.2.2.2.3.2.cmml">μ</mi><mi id="S2.E3.m1.5.5.3.2.2.2.3.3" xref="S2.E3.m1.5.5.3.2.2.2.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.3.2.2.2.2" xref="S2.E3.m1.5.5.3.2.2.2.2.cmml">​</mo><mrow id="S2.E3.m1.5.5.3.2.2.2.1.1" xref="S2.E3.m1.5.5.3.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.5.5.3.2.2.2.1.1.2" xref="S2.E3.m1.5.5.3.2.2.2.1.2.cmml">(</mo><msub id="S2.E3.m1.5.5.3.2.2.2.1.1.1" xref="S2.E3.m1.5.5.3.2.2.2.1.1.1.cmml"><mi id="S2.E3.m1.5.5.3.2.2.2.1.1.1.2" xref="S2.E3.m1.5.5.3.2.2.2.1.1.1.2.cmml">z</mi><mi id="S2.E3.m1.5.5.3.2.2.2.1.1.1.3" xref="S2.E3.m1.5.5.3.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S2.E3.m1.5.5.3.2.2.2.1.1.3" xref="S2.E3.m1.5.5.3.2.2.2.1.2.cmml">,</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">t</mi><mo stretchy="false" id="S2.E3.m1.5.5.3.2.2.2.1.1.4" xref="S2.E3.m1.5.5.3.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.6.6.4.3.3.6" xref="S2.E3.m1.6.6.4.3.4.cmml">,</mo><mrow id="S2.E3.m1.6.6.4.3.3.3" xref="S2.E3.m1.6.6.4.3.3.3.cmml"><msub id="S2.E3.m1.6.6.4.3.3.3.3" xref="S2.E3.m1.6.6.4.3.3.3.3.cmml"><mi id="S2.E3.m1.6.6.4.3.3.3.3.2" xref="S2.E3.m1.6.6.4.3.3.3.3.2.cmml">σ</mi><mi id="S2.E3.m1.6.6.4.3.3.3.3.3" xref="S2.E3.m1.6.6.4.3.3.3.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.6.6.4.3.3.3.2" xref="S2.E3.m1.6.6.4.3.3.3.2.cmml">​</mo><mrow id="S2.E3.m1.6.6.4.3.3.3.1.1" xref="S2.E3.m1.6.6.4.3.3.3.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.6.6.4.3.3.3.1.1.2" xref="S2.E3.m1.6.6.4.3.3.3.1.2.cmml">(</mo><msub id="S2.E3.m1.6.6.4.3.3.3.1.1.1" xref="S2.E3.m1.6.6.4.3.3.3.1.1.1.cmml"><mi id="S2.E3.m1.6.6.4.3.3.3.1.1.1.2" xref="S2.E3.m1.6.6.4.3.3.3.1.1.1.2.cmml">z</mi><mi id="S2.E3.m1.6.6.4.3.3.3.1.1.1.3" xref="S2.E3.m1.6.6.4.3.3.3.1.1.1.3.cmml">t</mi></msub><mo id="S2.E3.m1.6.6.4.3.3.3.1.1.3" xref="S2.E3.m1.6.6.4.3.3.3.1.2.cmml">,</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">t</mi><mo stretchy="false" id="S2.E3.m1.6.6.4.3.3.3.1.1.4" xref="S2.E3.m1.6.6.4.3.3.3.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E3.m1.6.6.4.3.3.7" xref="S2.E3.m1.6.6.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.6b"><apply id="S2.E3.m1.6.6.cmml" xref="S2.E3.m1.6.6"><eq id="S2.E3.m1.6.6.5.cmml" xref="S2.E3.m1.6.6.5"></eq><apply id="S2.E3.m1.3.3.1.cmml" xref="S2.E3.m1.3.3.1"><times id="S2.E3.m1.3.3.1.2.cmml" xref="S2.E3.m1.3.3.1.2"></times><apply id="S2.E3.m1.3.3.1.3.cmml" xref="S2.E3.m1.3.3.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.3.1.cmml" xref="S2.E3.m1.3.3.1.3">subscript</csymbol><ci id="S2.E3.m1.3.3.1.3.2.cmml" xref="S2.E3.m1.3.3.1.3.2">𝑝</ci><ci id="S2.E3.m1.3.3.1.3.3.cmml" xref="S2.E3.m1.3.3.1.3.3">𝜃</ci></apply><apply id="S2.E3.m1.3.3.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.3.3.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="S2.E3.m1.3.3.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.2.2">𝑧</ci><apply id="S2.E3.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.2.3"><minus id="S2.E3.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.2.3.1"></minus><ci id="S2.E3.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S2.E3.m1.3.3.1.1.1.1.2.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E3.m1.3.3.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3.2">𝑧</ci><ci id="S2.E3.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S2.E3.m1.6.6.4.cmml" xref="S2.E3.m1.6.6.4"><times id="S2.E3.m1.6.6.4.4.cmml" xref="S2.E3.m1.6.6.4.4"></times><ci id="S2.E3.m1.6.6.4.5.cmml" xref="S2.E3.m1.6.6.4.5">𝑁</ci><list id="S2.E3.m1.6.6.4.3.4.cmml" xref="S2.E3.m1.6.6.4.3.3"><apply id="S2.E3.m1.4.4.2.1.1.1.cmml" xref="S2.E3.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.2.1.1.1.1.cmml" xref="S2.E3.m1.4.4.2.1.1.1">subscript</csymbol><ci id="S2.E3.m1.4.4.2.1.1.1.2.cmml" xref="S2.E3.m1.4.4.2.1.1.1.2">𝑧</ci><apply id="S2.E3.m1.4.4.2.1.1.1.3.cmml" xref="S2.E3.m1.4.4.2.1.1.1.3"><minus id="S2.E3.m1.4.4.2.1.1.1.3.1.cmml" xref="S2.E3.m1.4.4.2.1.1.1.3.1"></minus><ci id="S2.E3.m1.4.4.2.1.1.1.3.2.cmml" xref="S2.E3.m1.4.4.2.1.1.1.3.2">𝑡</ci><cn type="integer" id="S2.E3.m1.4.4.2.1.1.1.3.3.cmml" xref="S2.E3.m1.4.4.2.1.1.1.3.3">1</cn></apply></apply><apply id="S2.E3.m1.5.5.3.2.2.2.cmml" xref="S2.E3.m1.5.5.3.2.2.2"><times id="S2.E3.m1.5.5.3.2.2.2.2.cmml" xref="S2.E3.m1.5.5.3.2.2.2.2"></times><apply id="S2.E3.m1.5.5.3.2.2.2.3.cmml" xref="S2.E3.m1.5.5.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.3.2.2.2.3.1.cmml" xref="S2.E3.m1.5.5.3.2.2.2.3">subscript</csymbol><ci id="S2.E3.m1.5.5.3.2.2.2.3.2.cmml" xref="S2.E3.m1.5.5.3.2.2.2.3.2">𝜇</ci><ci id="S2.E3.m1.5.5.3.2.2.2.3.3.cmml" xref="S2.E3.m1.5.5.3.2.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S2.E3.m1.5.5.3.2.2.2.1.2.cmml" xref="S2.E3.m1.5.5.3.2.2.2.1.1"><apply id="S2.E3.m1.5.5.3.2.2.2.1.1.1.cmml" xref="S2.E3.m1.5.5.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.3.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.5.5.3.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E3.m1.5.5.3.2.2.2.1.1.1.2.cmml" xref="S2.E3.m1.5.5.3.2.2.2.1.1.1.2">𝑧</ci><ci id="S2.E3.m1.5.5.3.2.2.2.1.1.1.3.cmml" xref="S2.E3.m1.5.5.3.2.2.2.1.1.1.3">𝑡</ci></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝑡</ci></interval></apply><apply id="S2.E3.m1.6.6.4.3.3.3.cmml" xref="S2.E3.m1.6.6.4.3.3.3"><times id="S2.E3.m1.6.6.4.3.3.3.2.cmml" xref="S2.E3.m1.6.6.4.3.3.3.2"></times><apply id="S2.E3.m1.6.6.4.3.3.3.3.cmml" xref="S2.E3.m1.6.6.4.3.3.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.4.3.3.3.3.1.cmml" xref="S2.E3.m1.6.6.4.3.3.3.3">subscript</csymbol><ci id="S2.E3.m1.6.6.4.3.3.3.3.2.cmml" xref="S2.E3.m1.6.6.4.3.3.3.3.2">𝜎</ci><ci id="S2.E3.m1.6.6.4.3.3.3.3.3.cmml" xref="S2.E3.m1.6.6.4.3.3.3.3.3">𝜃</ci></apply><interval closure="open" id="S2.E3.m1.6.6.4.3.3.3.1.2.cmml" xref="S2.E3.m1.6.6.4.3.3.3.1.1"><apply id="S2.E3.m1.6.6.4.3.3.3.1.1.1.cmml" xref="S2.E3.m1.6.6.4.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.4.3.3.3.1.1.1.1.cmml" xref="S2.E3.m1.6.6.4.3.3.3.1.1.1">subscript</csymbol><ci id="S2.E3.m1.6.6.4.3.3.3.1.1.1.2.cmml" xref="S2.E3.m1.6.6.4.3.3.3.1.1.1.2">𝑧</ci><ci id="S2.E3.m1.6.6.4.3.3.3.1.1.1.3.cmml" xref="S2.E3.m1.6.6.4.3.3.3.1.1.1.3">𝑡</ci></apply><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝑡</ci></interval></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.6c">p_{\theta}(z_{t-1}|z_{t})=N(z_{t-1};\mu_{\theta}(z_{t},t),\sigma_{\theta}(z_{t},t))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p2.7" class="ltx_p">At each time step, a random noise <math id="S2.SS1.p2.5.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S2.SS1.p2.5.m1.1a"><mi id="S2.SS1.p2.5.m1.1.1" xref="S2.SS1.p2.5.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m1.1b"><ci id="S2.SS1.p2.5.m1.1.1.cmml" xref="S2.SS1.p2.5.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m1.1c">\epsilon</annotation></semantics></math> is drawn from a diagonal Gaussian distribution, and a time-conditioned denoising model <math id="S2.SS1.p2.6.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS1.p2.6.m2.1a"><mi id="S2.SS1.p2.6.m2.1.1" xref="S2.SS1.p2.6.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m2.1b"><ci id="S2.SS1.p2.6.m2.1.1.cmml" xref="S2.SS1.p2.6.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m2.1c">\theta</annotation></semantics></math> is trained to predict the added noise in each timestep <math id="S2.SS1.p2.7.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS1.p2.7.m3.1a"><mi id="S2.SS1.p2.7.m3.1.1" xref="S2.SS1.p2.7.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m3.1b"><ci id="S2.SS1.p2.7.m3.1.1.cmml" xref="S2.SS1.p2.7.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m3.1c">t</annotation></semantics></math> with a simple MSE error:</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.3" class="ltx_Math" alttext="L(\theta):=||\epsilon_{\theta}(z_{t},t)-\epsilon||^{2}_{2}" display="block"><semantics id="S2.E4.m1.3a"><mrow id="S2.E4.m1.3.3" xref="S2.E4.m1.3.3.cmml"><mrow id="S2.E4.m1.3.3.3" xref="S2.E4.m1.3.3.3.cmml"><mi id="S2.E4.m1.3.3.3.2" xref="S2.E4.m1.3.3.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.3.3.3.1" xref="S2.E4.m1.3.3.3.1.cmml">​</mo><mrow id="S2.E4.m1.3.3.3.3.2" xref="S2.E4.m1.3.3.3.cmml"><mo stretchy="false" id="S2.E4.m1.3.3.3.3.2.1" xref="S2.E4.m1.3.3.3.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">θ</mi><mo rspace="0.278em" stretchy="false" id="S2.E4.m1.3.3.3.3.2.2" xref="S2.E4.m1.3.3.3.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.E4.m1.3.3.2" xref="S2.E4.m1.3.3.2.cmml">:=</mo><msubsup id="S2.E4.m1.3.3.1" xref="S2.E4.m1.3.3.1.cmml"><mrow id="S2.E4.m1.3.3.1.1.1.1" xref="S2.E4.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.3.3.1.1.1.1.2" xref="S2.E4.m1.3.3.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E4.m1.3.3.1.1.1.1.1" xref="S2.E4.m1.3.3.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.3.3.1.1.1.1.1.1" xref="S2.E4.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S2.E4.m1.3.3.1.1.1.1.1.1.3" xref="S2.E4.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.E4.m1.3.3.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S2.E4.m1.3.3.1.1.1.1.1.1.3.3" xref="S2.E4.m1.3.3.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.3.3.1.1.1.1.1.1.2" xref="S2.E4.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E4.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.3.3.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.3.3.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E4.m1.2.2" xref="S2.E4.m1.2.2.cmml">t</mi><mo stretchy="false" id="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S2.E4.m1.3.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.3.3.1.1.1.1.1.2" xref="S2.E4.m1.3.3.1.1.1.1.1.2.cmml">−</mo><mi id="S2.E4.m1.3.3.1.1.1.1.1.3" xref="S2.E4.m1.3.3.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo stretchy="false" id="S2.E4.m1.3.3.1.1.1.1.3" xref="S2.E4.m1.3.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E4.m1.3.3.1.3" xref="S2.E4.m1.3.3.1.3.cmml">2</mn><mn id="S2.E4.m1.3.3.1.1.3" xref="S2.E4.m1.3.3.1.1.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.3b"><apply id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3"><csymbol cd="latexml" id="S2.E4.m1.3.3.2.cmml" xref="S2.E4.m1.3.3.2">assign</csymbol><apply id="S2.E4.m1.3.3.3.cmml" xref="S2.E4.m1.3.3.3"><times id="S2.E4.m1.3.3.3.1.cmml" xref="S2.E4.m1.3.3.3.1"></times><ci id="S2.E4.m1.3.3.3.2.cmml" xref="S2.E4.m1.3.3.3.2">𝐿</ci><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝜃</ci></apply><apply id="S2.E4.m1.3.3.1.cmml" xref="S2.E4.m1.3.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.2.cmml" xref="S2.E4.m1.3.3.1">subscript</csymbol><apply id="S2.E4.m1.3.3.1.1.cmml" xref="S2.E4.m1.3.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.2.cmml" xref="S2.E4.m1.3.3.1">superscript</csymbol><apply id="S2.E4.m1.3.3.1.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.3.3.1.1.1.2.1.cmml" xref="S2.E4.m1.3.3.1.1.1.1.2">norm</csymbol><apply id="S2.E4.m1.3.3.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1"><minus id="S2.E4.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.2"></minus><apply id="S2.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.1"><times id="S2.E4.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.1.2"></times><apply id="S2.E4.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S2.E4.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S2.E4.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.1.1.1"><apply id="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S2.E4.m1.2.2.cmml" xref="S2.E4.m1.2.2">𝑡</ci></interval></apply><ci id="S2.E4.m1.3.3.1.1.1.1.1.3.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.3">italic-ϵ</ci></apply></apply><cn type="integer" id="S2.E4.m1.3.3.1.1.3.cmml" xref="S2.E4.m1.3.3.1.1.3">2</cn></apply><cn type="integer" id="S2.E4.m1.3.3.1.3.cmml" xref="S2.E4.m1.3.3.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.3c">L(\theta):=||\epsilon_{\theta}(z_{t},t)-\epsilon||^{2}_{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Landmark-guided Latent Diffusion Model</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.4" class="ltx_p">Given a landmark <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">L</annotation></semantics></math> of dimension <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="N\times 2" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mrow id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p1.2.m2.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><times id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1"></times><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝑁</ci><cn type="integer" id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">N\times 2</annotation></semantics></math>, where <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">N</annotation></semantics></math> is the number of landmarks, and a prompt <math id="S2.SS2.p1.4.m4.1" class="ltx_Math" alttext="\boldsymbol{c}" display="inline"><semantics id="S2.SS2.p1.4.m4.1a"><mi id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">𝒄</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">𝒄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">\boldsymbol{c}</annotation></semantics></math> description (<span id="S2.SS2.p1.4.1" class="ltx_text ltx_font_italic">e</span>.<span id="S2.SS2.p1.4.2" class="ltx_text ltx_font_italic">g</span>., “<span id="S2.SS2.p1.4.3" class="ltx_text ltx_font_italic">cartoon style, pixar style</span>”, in Fig. <a href="#S2.F1" title="Figure 1 ‣ 2 Proposed Method ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). Our goal is to generate a face that maintains the same facial structure by inputting exaggerated landmarks and style-relevant prompts. Due to the lack of a large-scale multi-domain facial landmark annotation dataset, we propose a two-stage training framework suitable for small datasets. The details of the small dataset will be discussed in Sec. <a href="#S3.SS1" title="3.1 Dataset ‣ 3 Experimental ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.11" class="ltx_p">As shown in Fig. <a href="#S2.F1" title="Figure 1 ‣ 2 Proposed Method ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (a) and (b), our method contains two stages of training for different purposes. <span id="S2.SS2.p2.11.1" class="ltx_text ltx_font_bold ltx_font_italic">First stage</span>. We prepare a training dataset <math id="S2.SS2.p2.1.m1.2" class="ltx_Math" alttext="D^{src}={z^{src},L^{src}}" display="inline"><semantics id="S2.SS2.p2.1.m1.2a"><mrow id="S2.SS2.p2.1.m1.2.2" xref="S2.SS2.p2.1.m1.2.2.cmml"><msup id="S2.SS2.p2.1.m1.2.2.4" xref="S2.SS2.p2.1.m1.2.2.4.cmml"><mi id="S2.SS2.p2.1.m1.2.2.4.2" xref="S2.SS2.p2.1.m1.2.2.4.2.cmml">D</mi><mrow id="S2.SS2.p2.1.m1.2.2.4.3" xref="S2.SS2.p2.1.m1.2.2.4.3.cmml"><mi id="S2.SS2.p2.1.m1.2.2.4.3.2" xref="S2.SS2.p2.1.m1.2.2.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.1.m1.2.2.4.3.1" xref="S2.SS2.p2.1.m1.2.2.4.3.1.cmml">​</mo><mi id="S2.SS2.p2.1.m1.2.2.4.3.3" xref="S2.SS2.p2.1.m1.2.2.4.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.1.m1.2.2.4.3.1a" xref="S2.SS2.p2.1.m1.2.2.4.3.1.cmml">​</mo><mi id="S2.SS2.p2.1.m1.2.2.4.3.4" xref="S2.SS2.p2.1.m1.2.2.4.3.4.cmml">c</mi></mrow></msup><mo id="S2.SS2.p2.1.m1.2.2.3" xref="S2.SS2.p2.1.m1.2.2.3.cmml">=</mo><mrow id="S2.SS2.p2.1.m1.2.2.2.2" xref="S2.SS2.p2.1.m1.2.2.2.3.cmml"><msup id="S2.SS2.p2.1.m1.1.1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.SS2.p2.1.m1.1.1.1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.1.m1.1.1.1.1.1.3.2" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.1.m1.1.1.1.1.1.3.1" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.1.m1.1.1.1.1.1.3.3" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.1.m1.1.1.1.1.1.3.1a" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.1.m1.1.1.1.1.1.3.4" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.4.cmml">c</mi></mrow></msup><mo id="S2.SS2.p2.1.m1.2.2.2.2.3" xref="S2.SS2.p2.1.m1.2.2.2.3.cmml">,</mo><msup id="S2.SS2.p2.1.m1.2.2.2.2.2" xref="S2.SS2.p2.1.m1.2.2.2.2.2.cmml"><mi id="S2.SS2.p2.1.m1.2.2.2.2.2.2" xref="S2.SS2.p2.1.m1.2.2.2.2.2.2.cmml">L</mi><mrow id="S2.SS2.p2.1.m1.2.2.2.2.2.3" xref="S2.SS2.p2.1.m1.2.2.2.2.2.3.cmml"><mi id="S2.SS2.p2.1.m1.2.2.2.2.2.3.2" xref="S2.SS2.p2.1.m1.2.2.2.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.1.m1.2.2.2.2.2.3.1" xref="S2.SS2.p2.1.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S2.SS2.p2.1.m1.2.2.2.2.2.3.3" xref="S2.SS2.p2.1.m1.2.2.2.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.1.m1.2.2.2.2.2.3.1a" xref="S2.SS2.p2.1.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S2.SS2.p2.1.m1.2.2.2.2.2.3.4" xref="S2.SS2.p2.1.m1.2.2.2.2.2.3.4.cmml">c</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.2b"><apply id="S2.SS2.p2.1.m1.2.2.cmml" xref="S2.SS2.p2.1.m1.2.2"><eq id="S2.SS2.p2.1.m1.2.2.3.cmml" xref="S2.SS2.p2.1.m1.2.2.3"></eq><apply id="S2.SS2.p2.1.m1.2.2.4.cmml" xref="S2.SS2.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.4.1.cmml" xref="S2.SS2.p2.1.m1.2.2.4">superscript</csymbol><ci id="S2.SS2.p2.1.m1.2.2.4.2.cmml" xref="S2.SS2.p2.1.m1.2.2.4.2">𝐷</ci><apply id="S2.SS2.p2.1.m1.2.2.4.3.cmml" xref="S2.SS2.p2.1.m1.2.2.4.3"><times id="S2.SS2.p2.1.m1.2.2.4.3.1.cmml" xref="S2.SS2.p2.1.m1.2.2.4.3.1"></times><ci id="S2.SS2.p2.1.m1.2.2.4.3.2.cmml" xref="S2.SS2.p2.1.m1.2.2.4.3.2">𝑠</ci><ci id="S2.SS2.p2.1.m1.2.2.4.3.3.cmml" xref="S2.SS2.p2.1.m1.2.2.4.3.3">𝑟</ci><ci id="S2.SS2.p2.1.m1.2.2.4.3.4.cmml" xref="S2.SS2.p2.1.m1.2.2.4.3.4">𝑐</ci></apply></apply><list id="S2.SS2.p2.1.m1.2.2.2.3.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2"><apply id="S2.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.2">𝑧</ci><apply id="S2.SS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3"><times id="S2.SS2.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.1"></times><ci id="S2.SS2.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.2">𝑠</ci><ci id="S2.SS2.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.3">𝑟</ci><ci id="S2.SS2.p2.1.m1.1.1.1.1.1.3.4.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.4">𝑐</ci></apply></apply><apply id="S2.SS2.p2.1.m1.2.2.2.2.2.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.2.2.2.1.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2.2">superscript</csymbol><ci id="S2.SS2.p2.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2.2.2">𝐿</ci><apply id="S2.SS2.p2.1.m1.2.2.2.2.2.3.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2.2.3"><times id="S2.SS2.p2.1.m1.2.2.2.2.2.3.1.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2.2.3.1"></times><ci id="S2.SS2.p2.1.m1.2.2.2.2.2.3.2.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2.2.3.2">𝑠</ci><ci id="S2.SS2.p2.1.m1.2.2.2.2.2.3.3.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2.2.3.3">𝑟</ci><ci id="S2.SS2.p2.1.m1.2.2.2.2.2.3.4.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2.2.3.4">𝑐</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.2c">D^{src}={z^{src},L^{src}}</annotation></semantics></math> with <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="256^{2}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><msup id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mn id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">256</mn><mn id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">superscript</csymbol><cn type="integer" id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">256</cn><cn type="integer" id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">256^{2}</annotation></semantics></math> Flickr-Faces-HQ (FFHQ) for first-stage training, which consists of the diffusion latent <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="z^{src}=E(x^{src})" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mrow id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><msup id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.3.2" xref="S2.SS2.p2.3.m3.1.1.3.2.cmml">z</mi><mrow id="S2.SS2.p2.3.m3.1.1.3.3" xref="S2.SS2.p2.3.m3.1.1.3.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.3.3.2" xref="S2.SS2.p2.3.m3.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.3.3.1" xref="S2.SS2.p2.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.3.3.3" xref="S2.SS2.p2.3.m3.1.1.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.3.3.1a" xref="S2.SS2.p2.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.3.3.4" xref="S2.SS2.p2.3.m3.1.1.3.3.4.cmml">c</mi></mrow></msup><mo id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">=</mo><mrow id="S2.SS2.p2.3.m3.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.3" xref="S2.SS2.p2.3.m3.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.1.2" xref="S2.SS2.p2.3.m3.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p2.3.m3.1.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.3.m3.1.1.1.1.1.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p2.3.m3.1.1.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.1.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S2.SS2.p2.3.m3.1.1.1.1.1.1.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.1a" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.4" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.4.cmml">c</mi></mrow></msup><mo stretchy="false" id="S2.SS2.p2.3.m3.1.1.1.1.1.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><eq id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2"></eq><apply id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.3.2">𝑧</ci><apply id="S2.SS2.p2.3.m3.1.1.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3.3"><times id="S2.SS2.p2.3.m3.1.1.3.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.3.3.1"></times><ci id="S2.SS2.p2.3.m3.1.1.3.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.3.3.2">𝑠</ci><ci id="S2.SS2.p2.3.m3.1.1.3.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3.3.3">𝑟</ci><ci id="S2.SS2.p2.3.m3.1.1.3.3.4.cmml" xref="S2.SS2.p2.3.m3.1.1.3.3.4">𝑐</ci></apply></apply><apply id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1"><times id="S2.SS2.p2.3.m3.1.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.2"></times><ci id="S2.SS2.p2.3.m3.1.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.3">𝐸</ci><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.2">𝑥</ci><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.3"><times id="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.1"></times><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.3">𝑟</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.4.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.3.4">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">z^{src}=E(x^{src})</annotation></semantics></math> from real face <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="x^{src}" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><msup id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">x</mi><mrow id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml"><mi id="S2.SS2.p2.4.m4.1.1.3.2" xref="S2.SS2.p2.4.m4.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.4.m4.1.1.3.1" xref="S2.SS2.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.4.m4.1.1.3.3" xref="S2.SS2.p2.4.m4.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.4.m4.1.1.3.1a" xref="S2.SS2.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.4.m4.1.1.3.4" xref="S2.SS2.p2.4.m4.1.1.3.4.cmml">c</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">superscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">𝑥</ci><apply id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3"><times id="S2.SS2.p2.4.m4.1.1.3.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3.1"></times><ci id="S2.SS2.p2.4.m4.1.1.3.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2">𝑠</ci><ci id="S2.SS2.p2.4.m4.1.1.3.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3">𝑟</ci><ci id="S2.SS2.p2.4.m4.1.1.3.4.cmml" xref="S2.SS2.p2.4.m4.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">x^{src}</annotation></semantics></math> encoded by VQGAN encoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, and its landmark <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="L^{src}" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><msup id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">L</mi><mrow id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml"><mi id="S2.SS2.p2.5.m5.1.1.3.2" xref="S2.SS2.p2.5.m5.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.5.m5.1.1.3.1" xref="S2.SS2.p2.5.m5.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.5.m5.1.1.3.3" xref="S2.SS2.p2.5.m5.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.5.m5.1.1.3.1a" xref="S2.SS2.p2.5.m5.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.5.m5.1.1.3.4" xref="S2.SS2.p2.5.m5.1.1.3.4.cmml">c</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">superscript</csymbol><ci id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2">𝐿</ci><apply id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3"><times id="S2.SS2.p2.5.m5.1.1.3.1.cmml" xref="S2.SS2.p2.5.m5.1.1.3.1"></times><ci id="S2.SS2.p2.5.m5.1.1.3.2.cmml" xref="S2.SS2.p2.5.m5.1.1.3.2">𝑠</ci><ci id="S2.SS2.p2.5.m5.1.1.3.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3">𝑟</ci><ci id="S2.SS2.p2.5.m5.1.1.3.4.cmml" xref="S2.SS2.p2.5.m5.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">L^{src}</annotation></semantics></math>. Note that we directly use visualized landmark images with coordinates as training conditions. To facilitate better recognition of semantic contents from landmarks for generated images, we add empty strings for training at this stage. <span id="S2.SS2.p2.11.2" class="ltx_text ltx_font_bold ltx_font_italic">Second stage</span>. We create a small scale multi-domain dataset <math id="S2.SS2.p2.6.m6.3" class="ltx_Math" alttext="D^{trg}={z^{trg},L^{trg},c^{trg}}" display="inline"><semantics id="S2.SS2.p2.6.m6.3a"><mrow id="S2.SS2.p2.6.m6.3.3" xref="S2.SS2.p2.6.m6.3.3.cmml"><msup id="S2.SS2.p2.6.m6.3.3.5" xref="S2.SS2.p2.6.m6.3.3.5.cmml"><mi id="S2.SS2.p2.6.m6.3.3.5.2" xref="S2.SS2.p2.6.m6.3.3.5.2.cmml">D</mi><mrow id="S2.SS2.p2.6.m6.3.3.5.3" xref="S2.SS2.p2.6.m6.3.3.5.3.cmml"><mi id="S2.SS2.p2.6.m6.3.3.5.3.2" xref="S2.SS2.p2.6.m6.3.3.5.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m6.3.3.5.3.1" xref="S2.SS2.p2.6.m6.3.3.5.3.1.cmml">​</mo><mi id="S2.SS2.p2.6.m6.3.3.5.3.3" xref="S2.SS2.p2.6.m6.3.3.5.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m6.3.3.5.3.1a" xref="S2.SS2.p2.6.m6.3.3.5.3.1.cmml">​</mo><mi id="S2.SS2.p2.6.m6.3.3.5.3.4" xref="S2.SS2.p2.6.m6.3.3.5.3.4.cmml">g</mi></mrow></msup><mo id="S2.SS2.p2.6.m6.3.3.4" xref="S2.SS2.p2.6.m6.3.3.4.cmml">=</mo><mrow id="S2.SS2.p2.6.m6.3.3.3.3" xref="S2.SS2.p2.6.m6.3.3.3.4.cmml"><msup id="S2.SS2.p2.6.m6.1.1.1.1.1" xref="S2.SS2.p2.6.m6.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.6.m6.1.1.1.1.1.2" xref="S2.SS2.p2.6.m6.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.SS2.p2.6.m6.1.1.1.1.1.3" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.6.m6.1.1.1.1.1.3.2" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m6.1.1.1.1.1.3.1" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.6.m6.1.1.1.1.1.3.3" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m6.1.1.1.1.1.3.1a" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.6.m6.1.1.1.1.1.3.4" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3.4.cmml">g</mi></mrow></msup><mo id="S2.SS2.p2.6.m6.3.3.3.3.4" xref="S2.SS2.p2.6.m6.3.3.3.4.cmml">,</mo><msup id="S2.SS2.p2.6.m6.2.2.2.2.2" xref="S2.SS2.p2.6.m6.2.2.2.2.2.cmml"><mi id="S2.SS2.p2.6.m6.2.2.2.2.2.2" xref="S2.SS2.p2.6.m6.2.2.2.2.2.2.cmml">L</mi><mrow id="S2.SS2.p2.6.m6.2.2.2.2.2.3" xref="S2.SS2.p2.6.m6.2.2.2.2.2.3.cmml"><mi id="S2.SS2.p2.6.m6.2.2.2.2.2.3.2" xref="S2.SS2.p2.6.m6.2.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m6.2.2.2.2.2.3.1" xref="S2.SS2.p2.6.m6.2.2.2.2.2.3.1.cmml">​</mo><mi id="S2.SS2.p2.6.m6.2.2.2.2.2.3.3" xref="S2.SS2.p2.6.m6.2.2.2.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m6.2.2.2.2.2.3.1a" xref="S2.SS2.p2.6.m6.2.2.2.2.2.3.1.cmml">​</mo><mi id="S2.SS2.p2.6.m6.2.2.2.2.2.3.4" xref="S2.SS2.p2.6.m6.2.2.2.2.2.3.4.cmml">g</mi></mrow></msup><mo id="S2.SS2.p2.6.m6.3.3.3.3.5" xref="S2.SS2.p2.6.m6.3.3.3.4.cmml">,</mo><msup id="S2.SS2.p2.6.m6.3.3.3.3.3" xref="S2.SS2.p2.6.m6.3.3.3.3.3.cmml"><mi id="S2.SS2.p2.6.m6.3.3.3.3.3.2" xref="S2.SS2.p2.6.m6.3.3.3.3.3.2.cmml">c</mi><mrow id="S2.SS2.p2.6.m6.3.3.3.3.3.3" xref="S2.SS2.p2.6.m6.3.3.3.3.3.3.cmml"><mi id="S2.SS2.p2.6.m6.3.3.3.3.3.3.2" xref="S2.SS2.p2.6.m6.3.3.3.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m6.3.3.3.3.3.3.1" xref="S2.SS2.p2.6.m6.3.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS2.p2.6.m6.3.3.3.3.3.3.3" xref="S2.SS2.p2.6.m6.3.3.3.3.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m6.3.3.3.3.3.3.1a" xref="S2.SS2.p2.6.m6.3.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS2.p2.6.m6.3.3.3.3.3.3.4" xref="S2.SS2.p2.6.m6.3.3.3.3.3.3.4.cmml">g</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.3b"><apply id="S2.SS2.p2.6.m6.3.3.cmml" xref="S2.SS2.p2.6.m6.3.3"><eq id="S2.SS2.p2.6.m6.3.3.4.cmml" xref="S2.SS2.p2.6.m6.3.3.4"></eq><apply id="S2.SS2.p2.6.m6.3.3.5.cmml" xref="S2.SS2.p2.6.m6.3.3.5"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.3.3.5.1.cmml" xref="S2.SS2.p2.6.m6.3.3.5">superscript</csymbol><ci id="S2.SS2.p2.6.m6.3.3.5.2.cmml" xref="S2.SS2.p2.6.m6.3.3.5.2">𝐷</ci><apply id="S2.SS2.p2.6.m6.3.3.5.3.cmml" xref="S2.SS2.p2.6.m6.3.3.5.3"><times id="S2.SS2.p2.6.m6.3.3.5.3.1.cmml" xref="S2.SS2.p2.6.m6.3.3.5.3.1"></times><ci id="S2.SS2.p2.6.m6.3.3.5.3.2.cmml" xref="S2.SS2.p2.6.m6.3.3.5.3.2">𝑡</ci><ci id="S2.SS2.p2.6.m6.3.3.5.3.3.cmml" xref="S2.SS2.p2.6.m6.3.3.5.3.3">𝑟</ci><ci id="S2.SS2.p2.6.m6.3.3.5.3.4.cmml" xref="S2.SS2.p2.6.m6.3.3.5.3.4">𝑔</ci></apply></apply><list id="S2.SS2.p2.6.m6.3.3.3.4.cmml" xref="S2.SS2.p2.6.m6.3.3.3.3"><apply id="S2.SS2.p2.6.m6.1.1.1.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p2.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.6.m6.1.1.1.1.1.2">𝑧</ci><apply id="S2.SS2.p2.6.m6.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3"><times id="S2.SS2.p2.6.m6.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3.1"></times><ci id="S2.SS2.p2.6.m6.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3.2">𝑡</ci><ci id="S2.SS2.p2.6.m6.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3.3">𝑟</ci><ci id="S2.SS2.p2.6.m6.1.1.1.1.1.3.4.cmml" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3.4">𝑔</ci></apply></apply><apply id="S2.SS2.p2.6.m6.2.2.2.2.2.cmml" xref="S2.SS2.p2.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.2.2.2.2.2.1.cmml" xref="S2.SS2.p2.6.m6.2.2.2.2.2">superscript</csymbol><ci id="S2.SS2.p2.6.m6.2.2.2.2.2.2.cmml" xref="S2.SS2.p2.6.m6.2.2.2.2.2.2">𝐿</ci><apply id="S2.SS2.p2.6.m6.2.2.2.2.2.3.cmml" xref="S2.SS2.p2.6.m6.2.2.2.2.2.3"><times id="S2.SS2.p2.6.m6.2.2.2.2.2.3.1.cmml" xref="S2.SS2.p2.6.m6.2.2.2.2.2.3.1"></times><ci id="S2.SS2.p2.6.m6.2.2.2.2.2.3.2.cmml" xref="S2.SS2.p2.6.m6.2.2.2.2.2.3.2">𝑡</ci><ci id="S2.SS2.p2.6.m6.2.2.2.2.2.3.3.cmml" xref="S2.SS2.p2.6.m6.2.2.2.2.2.3.3">𝑟</ci><ci id="S2.SS2.p2.6.m6.2.2.2.2.2.3.4.cmml" xref="S2.SS2.p2.6.m6.2.2.2.2.2.3.4">𝑔</ci></apply></apply><apply id="S2.SS2.p2.6.m6.3.3.3.3.3.cmml" xref="S2.SS2.p2.6.m6.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.3.3.3.3.3.1.cmml" xref="S2.SS2.p2.6.m6.3.3.3.3.3">superscript</csymbol><ci id="S2.SS2.p2.6.m6.3.3.3.3.3.2.cmml" xref="S2.SS2.p2.6.m6.3.3.3.3.3.2">𝑐</ci><apply id="S2.SS2.p2.6.m6.3.3.3.3.3.3.cmml" xref="S2.SS2.p2.6.m6.3.3.3.3.3.3"><times id="S2.SS2.p2.6.m6.3.3.3.3.3.3.1.cmml" xref="S2.SS2.p2.6.m6.3.3.3.3.3.3.1"></times><ci id="S2.SS2.p2.6.m6.3.3.3.3.3.3.2.cmml" xref="S2.SS2.p2.6.m6.3.3.3.3.3.3.2">𝑡</ci><ci id="S2.SS2.p2.6.m6.3.3.3.3.3.3.3.cmml" xref="S2.SS2.p2.6.m6.3.3.3.3.3.3.3">𝑟</ci><ci id="S2.SS2.p2.6.m6.3.3.3.3.3.3.4.cmml" xref="S2.SS2.p2.6.m6.3.3.3.3.3.3.4">𝑔</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.3c">D^{trg}={z^{trg},L^{trg},c^{trg}}</annotation></semantics></math>, which consists of the diffusion latent <math id="S2.SS2.p2.7.m7.1" class="ltx_Math" alttext="z^{trg}" display="inline"><semantics id="S2.SS2.p2.7.m7.1a"><msup id="S2.SS2.p2.7.m7.1.1" xref="S2.SS2.p2.7.m7.1.1.cmml"><mi id="S2.SS2.p2.7.m7.1.1.2" xref="S2.SS2.p2.7.m7.1.1.2.cmml">z</mi><mrow id="S2.SS2.p2.7.m7.1.1.3" xref="S2.SS2.p2.7.m7.1.1.3.cmml"><mi id="S2.SS2.p2.7.m7.1.1.3.2" xref="S2.SS2.p2.7.m7.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.7.m7.1.1.3.1" xref="S2.SS2.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.7.m7.1.1.3.3" xref="S2.SS2.p2.7.m7.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.7.m7.1.1.3.1a" xref="S2.SS2.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.7.m7.1.1.3.4" xref="S2.SS2.p2.7.m7.1.1.3.4.cmml">g</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.1b"><apply id="S2.SS2.p2.7.m7.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.1.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1">superscript</csymbol><ci id="S2.SS2.p2.7.m7.1.1.2.cmml" xref="S2.SS2.p2.7.m7.1.1.2">𝑧</ci><apply id="S2.SS2.p2.7.m7.1.1.3.cmml" xref="S2.SS2.p2.7.m7.1.1.3"><times id="S2.SS2.p2.7.m7.1.1.3.1.cmml" xref="S2.SS2.p2.7.m7.1.1.3.1"></times><ci id="S2.SS2.p2.7.m7.1.1.3.2.cmml" xref="S2.SS2.p2.7.m7.1.1.3.2">𝑡</ci><ci id="S2.SS2.p2.7.m7.1.1.3.3.cmml" xref="S2.SS2.p2.7.m7.1.1.3.3">𝑟</ci><ci id="S2.SS2.p2.7.m7.1.1.3.4.cmml" xref="S2.SS2.p2.7.m7.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.1c">z^{trg}</annotation></semantics></math> from multi-domain face <math id="S2.SS2.p2.8.m8.1" class="ltx_Math" alttext="x^{trg}" display="inline"><semantics id="S2.SS2.p2.8.m8.1a"><msup id="S2.SS2.p2.8.m8.1.1" xref="S2.SS2.p2.8.m8.1.1.cmml"><mi id="S2.SS2.p2.8.m8.1.1.2" xref="S2.SS2.p2.8.m8.1.1.2.cmml">x</mi><mrow id="S2.SS2.p2.8.m8.1.1.3" xref="S2.SS2.p2.8.m8.1.1.3.cmml"><mi id="S2.SS2.p2.8.m8.1.1.3.2" xref="S2.SS2.p2.8.m8.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.8.m8.1.1.3.1" xref="S2.SS2.p2.8.m8.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.8.m8.1.1.3.3" xref="S2.SS2.p2.8.m8.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.8.m8.1.1.3.1a" xref="S2.SS2.p2.8.m8.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.8.m8.1.1.3.4" xref="S2.SS2.p2.8.m8.1.1.3.4.cmml">g</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m8.1b"><apply id="S2.SS2.p2.8.m8.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1">superscript</csymbol><ci id="S2.SS2.p2.8.m8.1.1.2.cmml" xref="S2.SS2.p2.8.m8.1.1.2">𝑥</ci><apply id="S2.SS2.p2.8.m8.1.1.3.cmml" xref="S2.SS2.p2.8.m8.1.1.3"><times id="S2.SS2.p2.8.m8.1.1.3.1.cmml" xref="S2.SS2.p2.8.m8.1.1.3.1"></times><ci id="S2.SS2.p2.8.m8.1.1.3.2.cmml" xref="S2.SS2.p2.8.m8.1.1.3.2">𝑡</ci><ci id="S2.SS2.p2.8.m8.1.1.3.3.cmml" xref="S2.SS2.p2.8.m8.1.1.3.3">𝑟</ci><ci id="S2.SS2.p2.8.m8.1.1.3.4.cmml" xref="S2.SS2.p2.8.m8.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.1c">x^{trg}</annotation></semantics></math>, the landmark <math id="S2.SS2.p2.9.m9.1" class="ltx_Math" alttext="L^{trg}" display="inline"><semantics id="S2.SS2.p2.9.m9.1a"><msup id="S2.SS2.p2.9.m9.1.1" xref="S2.SS2.p2.9.m9.1.1.cmml"><mi id="S2.SS2.p2.9.m9.1.1.2" xref="S2.SS2.p2.9.m9.1.1.2.cmml">L</mi><mrow id="S2.SS2.p2.9.m9.1.1.3" xref="S2.SS2.p2.9.m9.1.1.3.cmml"><mi id="S2.SS2.p2.9.m9.1.1.3.2" xref="S2.SS2.p2.9.m9.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.9.m9.1.1.3.1" xref="S2.SS2.p2.9.m9.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.9.m9.1.1.3.3" xref="S2.SS2.p2.9.m9.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.9.m9.1.1.3.1a" xref="S2.SS2.p2.9.m9.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.9.m9.1.1.3.4" xref="S2.SS2.p2.9.m9.1.1.3.4.cmml">g</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m9.1b"><apply id="S2.SS2.p2.9.m9.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.1.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1">superscript</csymbol><ci id="S2.SS2.p2.9.m9.1.1.2.cmml" xref="S2.SS2.p2.9.m9.1.1.2">𝐿</ci><apply id="S2.SS2.p2.9.m9.1.1.3.cmml" xref="S2.SS2.p2.9.m9.1.1.3"><times id="S2.SS2.p2.9.m9.1.1.3.1.cmml" xref="S2.SS2.p2.9.m9.1.1.3.1"></times><ci id="S2.SS2.p2.9.m9.1.1.3.2.cmml" xref="S2.SS2.p2.9.m9.1.1.3.2">𝑡</ci><ci id="S2.SS2.p2.9.m9.1.1.3.3.cmml" xref="S2.SS2.p2.9.m9.1.1.3.3">𝑟</ci><ci id="S2.SS2.p2.9.m9.1.1.3.4.cmml" xref="S2.SS2.p2.9.m9.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m9.1c">L^{trg}</annotation></semantics></math> of <math id="S2.SS2.p2.10.m10.1" class="ltx_Math" alttext="x^{trg}" display="inline"><semantics id="S2.SS2.p2.10.m10.1a"><msup id="S2.SS2.p2.10.m10.1.1" xref="S2.SS2.p2.10.m10.1.1.cmml"><mi id="S2.SS2.p2.10.m10.1.1.2" xref="S2.SS2.p2.10.m10.1.1.2.cmml">x</mi><mrow id="S2.SS2.p2.10.m10.1.1.3" xref="S2.SS2.p2.10.m10.1.1.3.cmml"><mi id="S2.SS2.p2.10.m10.1.1.3.2" xref="S2.SS2.p2.10.m10.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.10.m10.1.1.3.1" xref="S2.SS2.p2.10.m10.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.10.m10.1.1.3.3" xref="S2.SS2.p2.10.m10.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.10.m10.1.1.3.1a" xref="S2.SS2.p2.10.m10.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.10.m10.1.1.3.4" xref="S2.SS2.p2.10.m10.1.1.3.4.cmml">g</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.10.m10.1b"><apply id="S2.SS2.p2.10.m10.1.1.cmml" xref="S2.SS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.1.1.1.cmml" xref="S2.SS2.p2.10.m10.1.1">superscript</csymbol><ci id="S2.SS2.p2.10.m10.1.1.2.cmml" xref="S2.SS2.p2.10.m10.1.1.2">𝑥</ci><apply id="S2.SS2.p2.10.m10.1.1.3.cmml" xref="S2.SS2.p2.10.m10.1.1.3"><times id="S2.SS2.p2.10.m10.1.1.3.1.cmml" xref="S2.SS2.p2.10.m10.1.1.3.1"></times><ci id="S2.SS2.p2.10.m10.1.1.3.2.cmml" xref="S2.SS2.p2.10.m10.1.1.3.2">𝑡</ci><ci id="S2.SS2.p2.10.m10.1.1.3.3.cmml" xref="S2.SS2.p2.10.m10.1.1.3.3">𝑟</ci><ci id="S2.SS2.p2.10.m10.1.1.3.4.cmml" xref="S2.SS2.p2.10.m10.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.10.m10.1c">x^{trg}</annotation></semantics></math>, and text-prompt <math id="S2.SS2.p2.11.m11.1" class="ltx_Math" alttext="c^{trg}" display="inline"><semantics id="S2.SS2.p2.11.m11.1a"><msup id="S2.SS2.p2.11.m11.1.1" xref="S2.SS2.p2.11.m11.1.1.cmml"><mi id="S2.SS2.p2.11.m11.1.1.2" xref="S2.SS2.p2.11.m11.1.1.2.cmml">c</mi><mrow id="S2.SS2.p2.11.m11.1.1.3" xref="S2.SS2.p2.11.m11.1.1.3.cmml"><mi id="S2.SS2.p2.11.m11.1.1.3.2" xref="S2.SS2.p2.11.m11.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.11.m11.1.1.3.1" xref="S2.SS2.p2.11.m11.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.11.m11.1.1.3.3" xref="S2.SS2.p2.11.m11.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.11.m11.1.1.3.1a" xref="S2.SS2.p2.11.m11.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.11.m11.1.1.3.4" xref="S2.SS2.p2.11.m11.1.1.3.4.cmml">g</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.11.m11.1b"><apply id="S2.SS2.p2.11.m11.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.11.m11.1.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1">superscript</csymbol><ci id="S2.SS2.p2.11.m11.1.1.2.cmml" xref="S2.SS2.p2.11.m11.1.1.2">𝑐</ci><apply id="S2.SS2.p2.11.m11.1.1.3.cmml" xref="S2.SS2.p2.11.m11.1.1.3"><times id="S2.SS2.p2.11.m11.1.1.3.1.cmml" xref="S2.SS2.p2.11.m11.1.1.3.1"></times><ci id="S2.SS2.p2.11.m11.1.1.3.2.cmml" xref="S2.SS2.p2.11.m11.1.1.3.2">𝑡</ci><ci id="S2.SS2.p2.11.m11.1.1.3.3.cmml" xref="S2.SS2.p2.11.m11.1.1.3.3">𝑟</ci><ci id="S2.SS2.p2.11.m11.1.1.3.4.cmml" xref="S2.SS2.p2.11.m11.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.11.m11.1c">c^{trg}</annotation></semantics></math>. In addition to the landmark and image data pairs, we added text prompts, such as “<span id="S2.SS2.p2.11.3" class="ltx_text ltx_font_italic">a portrait of cartoon style</span>,” to control the style of the output. After fine-tuning, we can generate exaggerated multi-domain faces by editing the coordinates of landmarks, while keeping the landmarks and faces aligned. We use the same training objective <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> in both stages.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Synthetic Dataset Geneartion</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">As shown in Fig. <a href="#S2.F1" title="Figure 1 ‣ 2 Proposed Method ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (c), we random sample the landmarks from the training dataset and edit them according to the following guidelines. We selected the following editing attributes: chubby, linear transform, open eyes, raised eyebrow, stretched nostrils, and eye/nose/mouth shifting. When editing landmarks, we random sample two of them each time. Then, we control the domain through text prompts, and we have a total of 25 different styles to choose from. We generated 400 images for each style category, thus, our synthetic dataset contains a total of 10,000 images. The generated samples are shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.1 Dataset ‣ 3 Experimental ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Compared to some classic GAN methods, they often encounter difficulties in generating multi-domain images. Therefore, a new model needs to be trained for each new domain. In this regard, we only need to train one model to control the generation of a wide variety of images.</p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Fine-tuning Landmark Detection Model</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.1" class="ltx_p">In contrast to training a new model, we found that fine-tuning an existing model with synthetic data produces better results. Therefore, we employ a model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> with high performance for real-world facial landmark detection as a pre-trained model. The landmark regression method is based on a stacked Hourglasses Networks (HGs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> that generates <math id="S2.SS4.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS4.p1.1.m1.1a"><mi id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><ci id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">N</annotation></semantics></math> heatmaps, each of which is a probability distribution over the predicted facial landmarks. Finally, the landmark locations are fine-tuned based on STAR loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experimental</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.5" class="ltx_p"><span id="S3.p1.5.1" class="ltx_text ltx_font_bold ltx_font_italic">Diffusion model</span>. We implement our method based on the official codebase of Stable Diffusion <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> and the publicly available 1.4 billion parameter T2I model. We first train our model for 200k steps on the FFHQ dataset<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. Then, we train for 100k steps on our small multi-domain dataset. The resolution of 256 <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.p1.1.m1.1a"><mo id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><times id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\times</annotation></semantics></math> 256 from the input landmark. The batch size and learning rate are set to 4 and <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="10^{-5}" display="inline"><semantics id="S3.p1.2.m2.1a"><msup id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mn id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">10</mn><mrow id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml"><mo id="S3.p1.2.m2.1.1.3a" xref="S3.p1.2.m2.1.1.3.cmml">−</mo><mn id="S3.p1.2.m2.1.1.3.2" xref="S3.p1.2.m2.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">superscript</csymbol><cn type="integer" id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">10</cn><apply id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3"><minus id="S3.p1.2.m2.1.1.3.1.cmml" xref="S3.p1.2.m2.1.1.3"></minus><cn type="integer" id="S3.p1.2.m2.1.1.3.2.cmml" xref="S3.p1.2.m2.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">10^{-5}</annotation></semantics></math>. The training process is performed on only one NVIDIA RTX Titan GPU and can be completed within one day. At inference, we apply DDIM sampler <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> with classifier-free guidance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> in our experiments for landmark-guided face generation. <span id="S3.p1.5.2" class="ltx_text ltx_font_bold ltx_font_italic">Face landmark detector</span>. Learning rate and batch size are set to <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="S3.p1.3.m3.1a"><msup id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mn id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">10</mn><mrow id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml"><mo id="S3.p1.3.m3.1.1.3a" xref="S3.p1.3.m3.1.1.3.cmml">−</mo><mn id="S3.p1.3.m3.1.1.3.2" xref="S3.p1.3.m3.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1">superscript</csymbol><cn type="integer" id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2">10</cn><apply id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3"><minus id="S3.p1.3.m3.1.1.3.1.cmml" xref="S3.p1.3.m3.1.1.3"></minus><cn type="integer" id="S3.p1.3.m3.1.1.3.2.cmml" xref="S3.p1.3.m3.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">10^{-4}</annotation></semantics></math> and 32. We use ADAM optimization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> with <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S3.p1.4.m4.1a"><mrow id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><msub id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml"><mi id="S3.p1.4.m4.1.1.2.2" xref="S3.p1.4.m4.1.1.2.2.cmml">β</mi><mn id="S3.p1.4.m4.1.1.2.3" xref="S3.p1.4.m4.1.1.2.3.cmml">1</mn></msub><mo id="S3.p1.4.m4.1.1.1" xref="S3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><eq id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1"></eq><apply id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.2.1.cmml" xref="S3.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.p1.4.m4.1.1.2.2.cmml" xref="S3.p1.4.m4.1.1.2.2">𝛽</ci><cn type="integer" id="S3.p1.4.m4.1.1.2.3.cmml" xref="S3.p1.4.m4.1.1.2.3">1</cn></apply><cn type="float" id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">\beta_{1}=0.9</annotation></semantics></math>, <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S3.p1.5.m5.1a"><mrow id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><msub id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml"><mi id="S3.p1.5.m5.1.1.2.2" xref="S3.p1.5.m5.1.1.2.2.cmml">β</mi><mn id="S3.p1.5.m5.1.1.2.3" xref="S3.p1.5.m5.1.1.2.3.cmml">2</mn></msub><mo id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><eq id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1"></eq><apply id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.2.1.cmml" xref="S3.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.p1.5.m5.1.1.2.2.cmml" xref="S3.p1.5.m5.1.1.2.2">𝛽</ci><cn type="integer" id="S3.p1.5.m5.1.1.2.3.cmml" xref="S3.p1.5.m5.1.1.2.3">2</cn></apply><cn type="float" id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\beta_{2}=0.999</annotation></semantics></math>.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p"><span id="S3.p2.1.1" class="ltx_text ltx_font_bold">Baseline</span>. We make comparisons to foa<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, ArtFacePoint<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, STAR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, and CariFace<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. All the models and their pre-trained models are provided on their official Github website. Since CariFace is primarily designed for landmark detection in caricature-style images, it largely failed when tested on the ArtFace dataset. Therefore, we did not showcase its results on ArtFace.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Dataset</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.6" class="ltx_p"><span id="S3.SS1.p1.6.1" class="ltx_text ltx_font_bold">FFHQ</span>: The Flickr-Faces-HQ Dataset, notable in high-fidelity GAN projects like StyleGAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, contains <math id="S3.SS1.p1.1.m1.2" class="ltx_Math" alttext="70,000" display="inline"><semantics id="S3.SS1.p1.1.m1.2a"><mrow id="S3.SS1.p1.1.m1.2.3.2" xref="S3.SS1.p1.1.m1.2.3.1.cmml"><mn id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">70</mn><mo id="S3.SS1.p1.1.m1.2.3.2.1" xref="S3.SS1.p1.1.m1.2.3.1.cmml">,</mo><mn id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.2b"><list id="S3.SS1.p1.1.m1.2.3.1.cmml" xref="S3.SS1.p1.1.m1.2.3.2"><cn type="integer" id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">70</cn><cn type="integer" id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.2c">70,000</annotation></semantics></math> high-resolution (<math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="1024\times 1024" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mn id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">1024</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><times id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"></times><cn type="integer" id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">1024</cn><cn type="integer" id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">1024\times 1024</annotation></semantics></math>) images, resized to <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="256\times 256" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mn id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">256</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">×</mo><mn id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><times id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></times><cn type="integer" id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">256</cn><cn type="integer" id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">256\times 256</annotation></semantics></math> for our training purposes. <span id="S3.SS1.p1.6.2" class="ltx_text ltx_font_bold">ArtFace</span>: The ArtFace dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, a collection of art paintings, comprises 160 images (<math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="256\times 256" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mn id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">256</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.4.m4.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml">×</mo><mn id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><times id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1"></times><cn type="integer" id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">256</cn><cn type="integer" id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">256\times 256</annotation></semantics></math>) with 68 landmarks, each representing various artistic styles. <span id="S3.SS1.p1.6.3" class="ltx_text ltx_font_bold">CariFace</span>: This dataset features landmark annotations for caricatures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, with 6,240 images for training and 1,560 for testing. <span id="S3.SS1.p1.6.4" class="ltx_text ltx_font_bold">Small multi-domain dataset</span>: We created a small dataset (<math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mo id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><lt id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">&lt;</annotation></semantics></math>1k) of images using other generative model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> and a subset of the Artface dataset to train our diffusion model. We randomly selected 112 (70%) images from the ArtFace dataset and 100 (1.6%) images from the CariFace dataset for the training set. In addition, we used a pre-trained DualstyleGAN to generate <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="50-100" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mn id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">50</mn><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">−</mo><mn id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><minus id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></minus><cn type="integer" id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">50</cn><cn type="integer" id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">50-100</annotation></semantics></math> synthetic images for each of the 8 styles. The total number is 984. We then used <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> to annotate these images and manually refined the coordinates.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2401.13191/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="189" height="84" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.3.1.1" class="ltx_text ltx_font_bold">Fig. 2</span>: </span>Sample results of our method.</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results and Discussion</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text ltx_font_bold">Qualitative results</span>. In Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.1 Dataset ‣ 3 Experimental ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we show some images generated from the input of edited landmarks and text. As can be seen from the results, our generated samples are well aligned with the landmarks after the landmarks are exaggeratedly edited. Qualitative results can be visualized in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4 Results and Discussion ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. For caricature results, foa and ArtFacePoint exhibited large errors in the prediction of facial contours. Although the Cariface model performs well compared to other methods, our method is still more accurate in capturing mouth details and facial contours. ArtFacePoint and foa both perform well on simple painting images. However, our method is significantly better at capturing facial details in images with a large domain gap. STAR is trained on real-world face images, which is not a fair comparison here. However, we do this to demonstrate the effectiveness of our synthetic dataset.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.1" class="ltx_p"><span id="S4.p2.1.1" class="ltx_text ltx_font_bold">Quantitative results</span>. We report relative Normalized Mean Error (NME), Failure Rate (FR), and Area Under Curve (AUC) similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> for Artface and CariFace dataset experiments in Table <a href="#S4.T1" title="Table 1 ‣ 4 Results and Discussion ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Notably, we achieved state-of-the-art results on the ArtFace dataset. It is important to clarify that our model’s training was conducted using a significantly smaller dataset, consisting of only 100 images for the diffusion model training, compared to over 6,000 images utilized by CariFace. This aspect underscores the efficiency of our approach, as it demonstrates our method’s capability to achieve competitive, and in some cases superior, results with substantially less training data. The slight underperformance on the CariFace dataset, compared to the CariFace method, can be attributed to the limited size of our training set, yet the results remain robust and indicative of our method’s efficacy in multi-domain facial landmark detection.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.1" class="ltx_p"><span id="S4.p3.1.1" class="ltx_text ltx_font_bold">Ablation results</span>. As shown in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4 Results and Discussion ‣ Towards Multi-domain Face Landmark Detection with Synthetic data from Diffusion model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we present the results of the ablation study. When we directly train a diffusion model on a small-scale dataset (One-step), the generated faces still retain the style of the input prompt. However, the generated faces do not match the input landmarks semantically. The landmarks fail to exert control over the generated images due to their lack of alignment with the generated faces. Training on a large-scale dataset of real-world face images aligns faces with landmarks effectively. Nevertheless, introducing exaggerated landmarks as input deviates from the spatial distribution seen in our familiar face data, resulting in some inherent bias. With our two-stage approach, we not only have the ability to generate multi-domain faces using text prompts but can also produce aligned face images even when given exaggerated landmarks as input.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2401.13191/assets/x3.png" id="S4.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="184" height="129" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.3.1.1" class="ltx_text ltx_font_bold">Fig. 3</span>: </span>Qualitative comparison between evaluated methods.</figcaption>
</figure>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.8.1.1" class="ltx_text ltx_font_bold">Table 1</span>: </span>Quantitative comparison with evaluated baselines.</figcaption>
<table id="S4.T1.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.6.7.1" class="ltx_tr">
<th id="S4.T1.6.7.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;"></th>
<th id="S4.T1.6.7.1.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;" colspan="3">ArtFace</th>
<th id="S4.T1.6.7.1.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;" colspan="3">CariFace</th>
</tr>
<tr id="S4.T1.6.6" class="ltx_tr">
<th id="S4.T1.6.6.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;">Metric</th>
<th id="S4.T1.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;"><math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="NME" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml"><mi id="S4.T1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.m1.1.1.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.T1.1.1.1.m1.1.1.1" xref="S4.T1.1.1.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.m1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.T1.1.1.1.m1.1.1.1a" xref="S4.T1.1.1.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.1.1.1.m1.1.1.4" xref="S4.T1.1.1.1.m1.1.1.4.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"><times id="S4.T1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1.1"></times><ci id="S4.T1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.m1.1.1.2">𝑁</ci><ci id="S4.T1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.m1.1.1.3">𝑀</ci><ci id="S4.T1.1.1.1.m1.1.1.4.cmml" xref="S4.T1.1.1.1.m1.1.1.4">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">NME</annotation></semantics></math></th>
<th id="S4.T1.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;"><math id="S4.T1.2.2.2.m1.1" class="ltx_Math" alttext="FR_{10\%}" display="inline"><semantics id="S4.T1.2.2.2.m1.1a"><mrow id="S4.T1.2.2.2.m1.1.1" xref="S4.T1.2.2.2.m1.1.1.cmml"><mi id="S4.T1.2.2.2.m1.1.1.2" xref="S4.T1.2.2.2.m1.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.T1.2.2.2.m1.1.1.1" xref="S4.T1.2.2.2.m1.1.1.1.cmml">​</mo><msub id="S4.T1.2.2.2.m1.1.1.3" xref="S4.T1.2.2.2.m1.1.1.3.cmml"><mi id="S4.T1.2.2.2.m1.1.1.3.2" xref="S4.T1.2.2.2.m1.1.1.3.2.cmml">R</mi><mrow id="S4.T1.2.2.2.m1.1.1.3.3" xref="S4.T1.2.2.2.m1.1.1.3.3.cmml"><mn id="S4.T1.2.2.2.m1.1.1.3.3.2" xref="S4.T1.2.2.2.m1.1.1.3.3.2.cmml">10</mn><mo id="S4.T1.2.2.2.m1.1.1.3.3.1" xref="S4.T1.2.2.2.m1.1.1.3.3.1.cmml">%</mo></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.m1.1b"><apply id="S4.T1.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.m1.1.1"><times id="S4.T1.2.2.2.m1.1.1.1.cmml" xref="S4.T1.2.2.2.m1.1.1.1"></times><ci id="S4.T1.2.2.2.m1.1.1.2.cmml" xref="S4.T1.2.2.2.m1.1.1.2">𝐹</ci><apply id="S4.T1.2.2.2.m1.1.1.3.cmml" xref="S4.T1.2.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.2.2.2.m1.1.1.3.1.cmml" xref="S4.T1.2.2.2.m1.1.1.3">subscript</csymbol><ci id="S4.T1.2.2.2.m1.1.1.3.2.cmml" xref="S4.T1.2.2.2.m1.1.1.3.2">𝑅</ci><apply id="S4.T1.2.2.2.m1.1.1.3.3.cmml" xref="S4.T1.2.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="S4.T1.2.2.2.m1.1.1.3.3.1.cmml" xref="S4.T1.2.2.2.m1.1.1.3.3.1">percent</csymbol><cn type="integer" id="S4.T1.2.2.2.m1.1.1.3.3.2.cmml" xref="S4.T1.2.2.2.m1.1.1.3.3.2">10</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.m1.1c">FR_{10\%}</annotation></semantics></math></th>
<th id="S4.T1.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;"><math id="S4.T1.3.3.3.m1.1" class="ltx_Math" alttext="AUC_{10\%}" display="inline"><semantics id="S4.T1.3.3.3.m1.1a"><mrow id="S4.T1.3.3.3.m1.1.1" xref="S4.T1.3.3.3.m1.1.1.cmml"><mi id="S4.T1.3.3.3.m1.1.1.2" xref="S4.T1.3.3.3.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.T1.3.3.3.m1.1.1.1" xref="S4.T1.3.3.3.m1.1.1.1.cmml">​</mo><mi id="S4.T1.3.3.3.m1.1.1.3" xref="S4.T1.3.3.3.m1.1.1.3.cmml">U</mi><mo lspace="0em" rspace="0em" id="S4.T1.3.3.3.m1.1.1.1a" xref="S4.T1.3.3.3.m1.1.1.1.cmml">​</mo><msub id="S4.T1.3.3.3.m1.1.1.4" xref="S4.T1.3.3.3.m1.1.1.4.cmml"><mi id="S4.T1.3.3.3.m1.1.1.4.2" xref="S4.T1.3.3.3.m1.1.1.4.2.cmml">C</mi><mrow id="S4.T1.3.3.3.m1.1.1.4.3" xref="S4.T1.3.3.3.m1.1.1.4.3.cmml"><mn id="S4.T1.3.3.3.m1.1.1.4.3.2" xref="S4.T1.3.3.3.m1.1.1.4.3.2.cmml">10</mn><mo id="S4.T1.3.3.3.m1.1.1.4.3.1" xref="S4.T1.3.3.3.m1.1.1.4.3.1.cmml">%</mo></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.m1.1b"><apply id="S4.T1.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.m1.1.1"><times id="S4.T1.3.3.3.m1.1.1.1.cmml" xref="S4.T1.3.3.3.m1.1.1.1"></times><ci id="S4.T1.3.3.3.m1.1.1.2.cmml" xref="S4.T1.3.3.3.m1.1.1.2">𝐴</ci><ci id="S4.T1.3.3.3.m1.1.1.3.cmml" xref="S4.T1.3.3.3.m1.1.1.3">𝑈</ci><apply id="S4.T1.3.3.3.m1.1.1.4.cmml" xref="S4.T1.3.3.3.m1.1.1.4"><csymbol cd="ambiguous" id="S4.T1.3.3.3.m1.1.1.4.1.cmml" xref="S4.T1.3.3.3.m1.1.1.4">subscript</csymbol><ci id="S4.T1.3.3.3.m1.1.1.4.2.cmml" xref="S4.T1.3.3.3.m1.1.1.4.2">𝐶</ci><apply id="S4.T1.3.3.3.m1.1.1.4.3.cmml" xref="S4.T1.3.3.3.m1.1.1.4.3"><csymbol cd="latexml" id="S4.T1.3.3.3.m1.1.1.4.3.1.cmml" xref="S4.T1.3.3.3.m1.1.1.4.3.1">percent</csymbol><cn type="integer" id="S4.T1.3.3.3.m1.1.1.4.3.2.cmml" xref="S4.T1.3.3.3.m1.1.1.4.3.2">10</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.m1.1c">AUC_{10\%}</annotation></semantics></math></th>
<th id="S4.T1.4.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;"><math id="S4.T1.4.4.4.m1.1" class="ltx_Math" alttext="NME" display="inline"><semantics id="S4.T1.4.4.4.m1.1a"><mrow id="S4.T1.4.4.4.m1.1.1" xref="S4.T1.4.4.4.m1.1.1.cmml"><mi id="S4.T1.4.4.4.m1.1.1.2" xref="S4.T1.4.4.4.m1.1.1.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.4.m1.1.1.1" xref="S4.T1.4.4.4.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.4.m1.1.1.3" xref="S4.T1.4.4.4.m1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.4.m1.1.1.1a" xref="S4.T1.4.4.4.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.4.m1.1.1.4" xref="S4.T1.4.4.4.m1.1.1.4.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.m1.1b"><apply id="S4.T1.4.4.4.m1.1.1.cmml" xref="S4.T1.4.4.4.m1.1.1"><times id="S4.T1.4.4.4.m1.1.1.1.cmml" xref="S4.T1.4.4.4.m1.1.1.1"></times><ci id="S4.T1.4.4.4.m1.1.1.2.cmml" xref="S4.T1.4.4.4.m1.1.1.2">𝑁</ci><ci id="S4.T1.4.4.4.m1.1.1.3.cmml" xref="S4.T1.4.4.4.m1.1.1.3">𝑀</ci><ci id="S4.T1.4.4.4.m1.1.1.4.cmml" xref="S4.T1.4.4.4.m1.1.1.4">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.m1.1c">NME</annotation></semantics></math></th>
<th id="S4.T1.5.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;"><math id="S4.T1.5.5.5.m1.1" class="ltx_Math" alttext="FR_{10\%}" display="inline"><semantics id="S4.T1.5.5.5.m1.1a"><mrow id="S4.T1.5.5.5.m1.1.1" xref="S4.T1.5.5.5.m1.1.1.cmml"><mi id="S4.T1.5.5.5.m1.1.1.2" xref="S4.T1.5.5.5.m1.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.T1.5.5.5.m1.1.1.1" xref="S4.T1.5.5.5.m1.1.1.1.cmml">​</mo><msub id="S4.T1.5.5.5.m1.1.1.3" xref="S4.T1.5.5.5.m1.1.1.3.cmml"><mi id="S4.T1.5.5.5.m1.1.1.3.2" xref="S4.T1.5.5.5.m1.1.1.3.2.cmml">R</mi><mrow id="S4.T1.5.5.5.m1.1.1.3.3" xref="S4.T1.5.5.5.m1.1.1.3.3.cmml"><mn id="S4.T1.5.5.5.m1.1.1.3.3.2" xref="S4.T1.5.5.5.m1.1.1.3.3.2.cmml">10</mn><mo id="S4.T1.5.5.5.m1.1.1.3.3.1" xref="S4.T1.5.5.5.m1.1.1.3.3.1.cmml">%</mo></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.m1.1b"><apply id="S4.T1.5.5.5.m1.1.1.cmml" xref="S4.T1.5.5.5.m1.1.1"><times id="S4.T1.5.5.5.m1.1.1.1.cmml" xref="S4.T1.5.5.5.m1.1.1.1"></times><ci id="S4.T1.5.5.5.m1.1.1.2.cmml" xref="S4.T1.5.5.5.m1.1.1.2">𝐹</ci><apply id="S4.T1.5.5.5.m1.1.1.3.cmml" xref="S4.T1.5.5.5.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.5.5.5.m1.1.1.3.1.cmml" xref="S4.T1.5.5.5.m1.1.1.3">subscript</csymbol><ci id="S4.T1.5.5.5.m1.1.1.3.2.cmml" xref="S4.T1.5.5.5.m1.1.1.3.2">𝑅</ci><apply id="S4.T1.5.5.5.m1.1.1.3.3.cmml" xref="S4.T1.5.5.5.m1.1.1.3.3"><csymbol cd="latexml" id="S4.T1.5.5.5.m1.1.1.3.3.1.cmml" xref="S4.T1.5.5.5.m1.1.1.3.3.1">percent</csymbol><cn type="integer" id="S4.T1.5.5.5.m1.1.1.3.3.2.cmml" xref="S4.T1.5.5.5.m1.1.1.3.3.2">10</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.m1.1c">FR_{10\%}</annotation></semantics></math></th>
<th id="S4.T1.6.6.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;"><math id="S4.T1.6.6.6.m1.1" class="ltx_Math" alttext="AUC_{10\%}" display="inline"><semantics id="S4.T1.6.6.6.m1.1a"><mrow id="S4.T1.6.6.6.m1.1.1" xref="S4.T1.6.6.6.m1.1.1.cmml"><mi id="S4.T1.6.6.6.m1.1.1.2" xref="S4.T1.6.6.6.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.T1.6.6.6.m1.1.1.1" xref="S4.T1.6.6.6.m1.1.1.1.cmml">​</mo><mi id="S4.T1.6.6.6.m1.1.1.3" xref="S4.T1.6.6.6.m1.1.1.3.cmml">U</mi><mo lspace="0em" rspace="0em" id="S4.T1.6.6.6.m1.1.1.1a" xref="S4.T1.6.6.6.m1.1.1.1.cmml">​</mo><msub id="S4.T1.6.6.6.m1.1.1.4" xref="S4.T1.6.6.6.m1.1.1.4.cmml"><mi id="S4.T1.6.6.6.m1.1.1.4.2" xref="S4.T1.6.6.6.m1.1.1.4.2.cmml">C</mi><mrow id="S4.T1.6.6.6.m1.1.1.4.3" xref="S4.T1.6.6.6.m1.1.1.4.3.cmml"><mn id="S4.T1.6.6.6.m1.1.1.4.3.2" xref="S4.T1.6.6.6.m1.1.1.4.3.2.cmml">10</mn><mo id="S4.T1.6.6.6.m1.1.1.4.3.1" xref="S4.T1.6.6.6.m1.1.1.4.3.1.cmml">%</mo></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.m1.1b"><apply id="S4.T1.6.6.6.m1.1.1.cmml" xref="S4.T1.6.6.6.m1.1.1"><times id="S4.T1.6.6.6.m1.1.1.1.cmml" xref="S4.T1.6.6.6.m1.1.1.1"></times><ci id="S4.T1.6.6.6.m1.1.1.2.cmml" xref="S4.T1.6.6.6.m1.1.1.2">𝐴</ci><ci id="S4.T1.6.6.6.m1.1.1.3.cmml" xref="S4.T1.6.6.6.m1.1.1.3">𝑈</ci><apply id="S4.T1.6.6.6.m1.1.1.4.cmml" xref="S4.T1.6.6.6.m1.1.1.4"><csymbol cd="ambiguous" id="S4.T1.6.6.6.m1.1.1.4.1.cmml" xref="S4.T1.6.6.6.m1.1.1.4">subscript</csymbol><ci id="S4.T1.6.6.6.m1.1.1.4.2.cmml" xref="S4.T1.6.6.6.m1.1.1.4.2">𝐶</ci><apply id="S4.T1.6.6.6.m1.1.1.4.3.cmml" xref="S4.T1.6.6.6.m1.1.1.4.3"><csymbol cd="latexml" id="S4.T1.6.6.6.m1.1.1.4.3.1.cmml" xref="S4.T1.6.6.6.m1.1.1.4.3.1">percent</csymbol><cn type="integer" id="S4.T1.6.6.6.m1.1.1.4.3.2.cmml" xref="S4.T1.6.6.6.m1.1.1.4.3.2">10</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.m1.1c">AUC_{10\%}</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.6.8.1" class="ltx_tr">
<th id="S4.T1.6.8.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;">Ours</th>
<td id="S4.T1.6.8.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;">4.64</td>
<td id="S4.T1.6.8.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;">2.26</td>
<td id="S4.T1.6.8.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;">0.5548</td>
<td id="S4.T1.6.8.1.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;">5.54</td>
<td id="S4.T1.6.8.1.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;">6.29</td>
<td id="S4.T1.6.8.1.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.4pt;padding-right:1.4pt;">0.4838</td>
</tr>
<tr id="S4.T1.6.9.2" class="ltx_tr">
<th id="S4.T1.6.9.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:1.4pt;padding-right:1.4pt;">foa</th>
<td id="S4.T1.6.9.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">4.69</td>
<td id="S4.T1.6.9.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">3.75</td>
<td id="S4.T1.6.9.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">0.5388</td>
<td id="S4.T1.6.9.2.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">8.26</td>
<td id="S4.T1.6.9.2.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">22.31</td>
<td id="S4.T1.6.9.2.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">0.2997</td>
</tr>
<tr id="S4.T1.6.10.3" class="ltx_tr">
<th id="S4.T1.6.10.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:1.4pt;padding-right:1.4pt;">ArtFace</th>
<td id="S4.T1.6.10.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">6.50</td>
<td id="S4.T1.6.10.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">10.62</td>
<td id="S4.T1.6.10.3.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">0.4573</td>
<td id="S4.T1.6.10.3.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">12.04</td>
<td id="S4.T1.6.10.3.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">44.41</td>
<td id="S4.T1.6.10.3.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">0.1476</td>
</tr>
<tr id="S4.T1.6.11.4" class="ltx_tr">
<th id="S4.T1.6.11.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:1.4pt;padding-right:1.4pt;">CariFace</th>
<td id="S4.T1.6.11.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">-</td>
<td id="S4.T1.6.11.4.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">-</td>
<td id="S4.T1.6.11.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">-</td>
<td id="S4.T1.6.11.4.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">4.54</td>
<td id="S4.T1.6.11.4.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">0.71</td>
<td id="S4.T1.6.11.4.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.4pt;padding-right:1.4pt;">0.5477</td>
</tr>
<tr id="S4.T1.6.12.5" class="ltx_tr">
<th id="S4.T1.6.12.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_b" style="padding-left:1.4pt;padding-right:1.4pt;">STAR</th>
<td id="S4.T1.6.12.5.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.4pt;padding-right:1.4pt;">6.20</td>
<td id="S4.T1.6.12.5.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.4pt;padding-right:1.4pt;">13.21</td>
<td id="S4.T1.6.12.5.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.4pt;padding-right:1.4pt;">0.5142</td>
<td id="S4.T1.6.12.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.4pt;padding-right:1.4pt;">7.16</td>
<td id="S4.T1.6.12.5.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.4pt;padding-right:1.4pt;">13.73</td>
<td id="S4.T1.6.12.5.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.4pt;padding-right:1.4pt;">0.3875</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2401.13191/assets/x4.png" id="S4.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="193" height="62" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.3.1.1" class="ltx_text ltx_font_bold">Fig. 4</span>: </span>Ablation study of our method.</figcaption>
</figure>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We introduced a novel two-stage approach for creating synthetic datasets for multi-domain facial landmark detection, effectively utilizing limited datasets and pre-trained diffusion models. Our method generates high-quality, domain-spanning synthetic datasets, maintaining alignment between landmarks and facial features. We then fine-tuned a pre-trained landmark detection model on this dataset. Experimental results show our method outperforms others in accuracy on both ArtFace and CariFace datasets.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Ran Yi, Zipeng Ye, Ruoyu Fan, Yezhi Shu, Yong-Jin Liu, Yu-Kun Lai, and Paul L
Rosin,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">“Animating portrait line drawings from a single face photo and a
speech signal,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM SIGGRAPH 2022 Conference Proceedings</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, 2022, pp. 1–8.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Yu Deng, Jiaolong Yang, Sicheng Xu, Dong Chen, Yunde Jia, and Xin Tong,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">“Accurate 3d face reconstruction with weakly-supervised learning:
From single image to image set,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition workshops</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, 2019, pp. 0–0.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Ivona Tautkute, Tomasz Trzcinski, and Adam Bielski,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">“I know how you feel: Emotion recognition with facial landmarks,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">proceedings of the IEEE/CVF conference on computer vision and
pattern recognition workshops</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, 2018, pp. 1878–1880.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Zhanpeng Zhang, Ping Luo, Chen Change Loy, and Xiaoou Tang,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">“Facial landmark detection by deep multi-task learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision
(ECCV)</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">. Springer, 2014, pp. 94–108.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Adrian Bulat and Georgios Tzimiropoulos,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">“How far are we from solving the 2d &amp; 3d face alignment
problem?(and a dataset of 230,000 3d facial landmarks),”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE International Conference on Computer
Vision (ICCV)</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, 2017, pp. 1021–1030.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Xuanyi Dong, Yan Yan, Wanli Ouyang, and Yi Yang,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">“Style aggregated network for facial landmark detection,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, 2018, pp. 379–388.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Zhen-Hua Feng, Josef Kittler, Muhammad Awais, Patrik Huber, and Xiao-Jun Wu,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">“Wing loss for robust facial landmark localisation with
convolutional neural networks,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, 2018, pp. 2235–2245.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Yangyu Huang, Hao Yang, Chong Li, Jongyoo Kim, and Fangyun Wei,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">“Adnet: Leveraging error-bias towards normal direction in face
alignment,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE International Conference on Computer
Vision (ICCV)</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, 2021, pp. 3080–3090.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Zhenglin Zhou, Huaxia Li, Hong Liu, Nanyang Wang, Gang Yu, and Rongrong Ji,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">“Star loss: Reducing semantic ambiguity in facial landmark
detection,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2023, pp. 15475–15484.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Jordan Yaniv, Yael Newman, and Ariel Shamir,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">“The face of art: landmark detection and geometric style in
portraits,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM Transactions on Graphics (TOG)</span><span id="bib.bib10.4.2" class="ltx_text" style="font-size:90%;">, vol. 38, no. 4, pp. 1–15,
2019.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Christos Sagonas, Epameinondas Antonakos, Georgios Tzimiropoulos, Stefanos
Zafeiriou, and Maja Pantic,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">“300 faces in-the-wild challenge: Database and results,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Image and vision computing</span><span id="bib.bib11.4.2" class="ltx_text" style="font-size:90%;">, vol. 47, pp. 3–18, 2016.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Leon A Gatys, Alexander S Ecker, and Matthias Bethge,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">“A neural algorithm of artistic style,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1508.06576</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Aline Sindel, Andreas Maier, and Vincent Christlein,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">“Artfacepoints: High-resolution facial landmark detection in
paintings and prints,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision
(ECCV)</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">. Springer, 2022, pp. 298–313.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Jun-Yan Zhu, Taesung Park, Phillip Isola, and Alexei A Efros,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">“Unpaired image-to-image translation using cycle-consistent
adversarial networks,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE International Conference on Computer
Vision (ICCV)</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, 2017, pp. 2223–2232.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Jeong-gi Kwak, Youngsaeng Jin, Yuanming Li, Dongsik Yoon, Donghyeon Kim, and
Hanseok Ko,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">“Adverse weather image translation with asymmetric and
uncertainty-aware gan,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">The 32th British Machine Vision Conference</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Yuanming Li, Youngsaeng Jin, Jeonggi Kwak, Dongsik Yoon, David Han, and Hanseok
Ko,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">“Adaptive content feature enhancement gan for multimodal selfie to
anime translation,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">The 32th British Machine Vision Conference</span><span id="bib.bib16.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Hongrui Cai, Yudong Guo, Zhuang Peng, and Juyong Zhang,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">“Landmark detection and 3d face reconstruction for caricature using
a nonlinear parametric model,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Graphical Models</span><span id="bib.bib17.4.2" class="ltx_text" style="font-size:90%;">, vol. 115, pp. 101103, 2021.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Björn
Ommer,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">“High-resolution image synthesis with latent diffusion models,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, 2022, pp. 10684–10695.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Dustin Podell, Zion English, Kyle Lacey, Andreas Blattmann, Tim Dockhorn, Jonas
Müller, Joe Penna, and Robin Rombach,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">“Sdxl: Improving latent diffusion models for high-resolution image
synthesis,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2307.01952</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Lvmin Zhang and Maneesh Agrawala,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">“Adding conditional control to text-to-image diffusion models,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2302.05543</span><span id="bib.bib20.4.2" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Tero Karras, Samuli Laine, and Timo Aila,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">“A style-based generator architecture for generative adversarial
networks,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2019, pp. 4401–4410.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Jonathan Ho, Ajay Jain, and Pieter Abbeel,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">“Denoising diffusion probabilistic models,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the Advances in Neural Information Processing
Systems (NeurIPS)</span><span id="bib.bib22.4.2" class="ltx_text" style="font-size:90%;">, vol. 33, pp. 6840–6851, 2020.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Patrick Esser, Robin Rombach, and Bjorn Ommer,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">“Taming transformers for high-resolution image synthesis,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, 2021, pp. 12873–12883.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Jiaming Song, Chenlin Meng, and Stefano Ermon,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">“Denoising diffusion implicit models,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2010.02502</span><span id="bib.bib24.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Jonathan Ho and Tim Salimans,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">“Classifier-free diffusion guidance,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2207.12598</span><span id="bib.bib25.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Diederik P Kingma and Jimmy Ba,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">“Adam: A method for stochastic optimization,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1412.6980</span><span id="bib.bib26.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Shuai Yang, Liming Jiang, Ziwei Liu, and Chen Change Loy,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">“Pastiche master: Exemplar-based high-resolution portrait style
transfer,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2401.13190" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2401.13191" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2401.13191">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2401.13191" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2401.13192" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 08:12:14 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
