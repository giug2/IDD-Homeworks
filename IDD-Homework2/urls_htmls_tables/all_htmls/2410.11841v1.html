<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation</title>
<!--Generated on Tue Oct 15 17:56:30 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Recommender Systems,  Large Language Model,  Mixture of Experts" lang="en" name="keywords"/>
<base href="/html/2410.11841v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S1" title="In GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S2" title="In GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S2.SS0.SSS0.Px1" title="In 2. Related Works ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title">Explainable Recommendation System.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S2.SS0.SSS0.Px2" title="In 2. Related Works ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title">Mixture of Experts.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3" title="In GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS1" title="In 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Task Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS2" title="In 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span> VAE-GMM for Rating Reconstruction</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS2.SSS1" title="In 3.2. VAE-GMM for Rating Reconstruction ‣ 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Rating Reconstruction with Variational Autoencoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS2.SSS2" title="In 3.2. VAE-GMM for Rating Reconstruction ‣ 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>User Clustering with Gaussian Mixture Model</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS3" title="In 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Multi-gating Mixture of Experts</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS3.SSS1" title="In 3.3. Multi-gating Mixture of Experts ‣ 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Multi-gating Mechanism for Expert Selection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS3.SSS2" title="In 3.3. Multi-gating Mixture of Experts ‣ 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Fine-grained Mixture of Experts</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS4" title="In 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Two-stage Training Objective</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS4.SSS1" title="In 3.4. Two-stage Training Objective ‣ 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.1 </span>Stage 1: Rating Reconstruction Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS4.SSS2" title="In 3.4. Two-stage Training Objective ‣ 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.2 </span>Stage 2: Explanation Generation Training</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4" title="In GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.SS1" title="In 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.SS2" title="In 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Implementation Detail</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.SS3" title="In 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Compared Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.SS4" title="In 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.SS5" title="In 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Results and Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.SS5.SSS1" title="In 4.5. Results and Analysis ‣ 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5.1 </span>Main Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.SS5.SSS2" title="In 4.5. Results and Analysis ‣ 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5.2 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.SS5.SSS3" title="In 4.5. Results and Analysis ‣ 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5.3 </span>Analysis of Multi-gating Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.SS5.SSS4" title="In 4.5. Results and Analysis ‣ 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5.4 </span>Analysis of Data Sparsity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.SS6" title="In 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Human Evaluation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S5" title="In GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Case Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S6" title="In GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#A1" title="In GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>ELBO in GaVaMoE</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#A2" title="In GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Human scoring Criteria</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">GaVaMoE: Gaussian-Variational Gated Mixture of Experts 
<br class="ltx_break"/>for Explainable Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Fei Tang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Zhejiang University</span><span class="ltx_text ltx_affiliation_country" id="id2.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:flysugar@zju.edu.cn">flysugar@zju.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yongliang Shen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id3.1.id1">Zhejiang University</span><span class="ltx_text ltx_affiliation_country" id="id4.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:syl@zju.edu.cn">syl@zju.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hang Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">Zhejiang University</span><span class="ltx_text ltx_affiliation_country" id="id6.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:22451046@zju.edu.cn">22451046@zju.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zeqi Tan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Zhejiang University</span><span class="ltx_text ltx_affiliation_country" id="id8.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zqtan@zju.edu.cn">zqtan@zju.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wenqi Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">Zhejiang University</span><span class="ltx_text ltx_affiliation_country" id="id10.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhangwenqi@zju.edu.cn">zhangwenqi@zju.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Guiyang Hou
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id11.1.id1">Zhejiang University</span><span class="ltx_text ltx_affiliation_country" id="id12.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:gyhou@zju.edu.cn">gyhou@zju.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kaitao Song
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">Microsoft Research Asia</span><span class="ltx_text ltx_affiliation_country" id="id14.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:kaitaosong@microsoft.com">kaitaosong@microsoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Weiming Lu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id15.1.id1">Zhejiang University</span><span class="ltx_text ltx_affiliation_country" id="id16.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:luwm@zju.edu.cn">luwm@zju.edu.cn</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yueting Zhuang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id17.1.id1">Zhejiang University</span><span class="ltx_text ltx_affiliation_country" id="id18.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yzhuang@zju.edu.cn">yzhuang@zju.edu.cn</a>
</span></span></span>
</div>
<div class="ltx_dates">(2018; 20 February 2007; 12 March 2009; 5 June 2009)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id19.id1">Large language model-based explainable recommendation (LLM-based ER) systems show promise in generating human-like explanations for recommendations. However, they face challenges in modeling user-item collaborative preferences, personalizing explanations, and handling sparse user-item interactions.
To address these issues, we propose GaVaMoE, a novel Gaussian-Variational Gated Mixture of Experts framework for explainable recommendation.
GaVaMoE introduces two key components: (1) a rating reconstruction module that employs Variational Autoencoder (VAE) with a Gaussian Mixture Model (GMM) to capture complex user-item collaborative preferences, serving as a pre-trained multi-gating mechanism; and (2) a set of fine-grained expert models coupled with the multi-gating mechanism for generating highly personalized explanations. The VAE component models latent factors in user-item interactions, while the GMM clusters users with similar behaviors. Each cluster corresponds to a gate in the multi-gating mechanism, routing user-item pairs to appropriate expert models. This architecture enables GaVaMoE to generate tailored explanations for specific user types and preferences, mitigating data sparsity by leveraging user similarities. Extensive experiments on three real-world datasets demonstrate that GaVaMoE significantly outperforms existing methods in explanation quality, personalization, and consistency. Notably, GaVaMoE exhibits robust performance in scenarios with sparse user-item interactions, maintaining high-quality explanations even for users with limited historical data<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Our project is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/sugarandgugu/GaVaMoE" title="">https://github.com/sugarandgugu/GaVaMoE</a>.</span></span></span>.</p>
</div>
<div class="ltx_keywords">Recommender Systems, Large Language Model, Mixture of Experts
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct
conference title from your rights confirmation emai; June 03–05,
2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommendation systems have become ubiquitous in the digital age, offering personalized suggestions to help users navigate vast amounts of information <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib36" title="">tintarev2015explaining, </a>)</cite>. As these systems evolve, the ability to explain recommendations has emerged as a critical factor in enhancing user trust, decision-making, and satisfaction <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib44" title="">zhang2019tutorial, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib45" title="">zhang2020explainable, </a>)</cite>. Clear and meaningful explanations not only aid users in making better choices but also increase their confidence in the recommendation process. Consequently, developing effective explainable recommendation systems has become a key research focus <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib9" title="">gao2019explainable, </a>)</cite>, driving the creation of more user-centric and trustworthy AI-driven experiences.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recent advancements <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib37" title="">touvron2023llama, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib6" title="">dubey2024llama, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib35" title="">team2023gemini, </a>)</cite> in large language models have opened new avenues for generating human-like explanations in recommendation systems, leading to the development of LLM-based ER systems <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib23" title="">li2023personalized, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib42" title="">yang2024fine, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib27" title="">ma2024xrec, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib2" title="">cai2022pevae, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib10" title="">hada2021rexplug, </a>)</cite>. Recent works such as PEPLER <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib23" title="">li2023personalized, </a>)</cite>, LLM2ER <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib42" title="">yang2024fine, </a>)</cite>, and XRec <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib27" title="">ma2024xrec, </a>)</cite> have demonstrated the potential of LLMs in generating contextually rich and coherent explanations. PEPLER <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib23" title="">li2023personalized, </a>)</cite> pioneered this field by utilizing GPT-2 <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib29" title="">radford2019language, </a>)</cite> and user-item IDs as prompts, demonstrating the potential of transfer learning in recommendation systems. LLM2ER <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib42" title="">yang2024fine, </a>)</cite> built upon this foundation by introducing a personalized prompt module, addressing the limitations of solely relying on user-item IDs. XRec <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib27" title="">ma2024xrec, </a>)</cite> further advanced the field by incorporating user and item profiles and integrating collaborative filtering signals, bridging the gap between conventional recommendation techniques and LLM-based approaches.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Despite their promising potential, current LLM-based ER systems face several critical challenges that limit their effectiveness.
First, these systems struggle to adequately model user-item collaborative preferences, particularly in capturing the complex, non-linear relationships that exist between users and items.
Second, the generated explanations frequently lack sufficient personalization, failing to reflect the nuanced preferences and behaviors of individual users. This results in generic recommendations that may not resonate with users’ specific interests or needs.
Third, LLM-based ER approaches perform poorly when confronted with sparse user-item interactions, a common scenario in real-world recommendation systems. This sparsity problem significantly hampers the ability of these models to generate accurate and meaningful explanations, particularly for users with limited historical data or for new or niche items in the system.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address these challenges, we propose GaVaMoE, a novel Gaussian-Variational Gated Mixture of Experts framework for explainable recommendation. GaVaMoE introduces two key components that work together to improve personalization and effectively mitigate data sparsity. The first component, a rating reconstruction module, employs Variational Autoencoder (VAE) <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib17" title="">kingma2013auto, </a>)</cite> in conjunction with a Gaussian Mixture Model (GMM) <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib16" title="">jiang2016variational, </a>)</cite> to capture deep user-item collaborative preferences. This module maps user-item pairs into a latent space and clusters users with similar behaviors, uncovering underlying patterns even in sparse data scenarios.
Building upon these learned representations and user clusters, the second component implements a multi-gated mixture of experts. A dynamic multi-gating mechanism, informed by the GMM clustering, routes user-item pairs to the appropriate fine-grained experts, ensuring highly personalized and contextually relevant explanations. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, GaVaMoE first processes user-item interactions through VAE encoding and GMM clustering, then uses the multi-gating mechanism to activate the most suitable experts for explanation generation.
This architecture enables GaVaMoE to produce more personalized and contextually relevant explanations compared to previous LLM-based ER systems, which typically use LLMs with generic prompts.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="389" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">Comparison of GaVaMoE with previous LLM-based ER systems for explanation generation. GaVaMoE processes user-item interactions through VAE encoding and GMM clustering, then routes them to fine-grained experts via multi-gating, generating highly personalized, high-quality explanations. In contrast, previous methods typically generate more generic explanations with limited personalization.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">GaVaMoE offers significant advantages in three key areas:
<span class="ltx_text ltx_font_bold" id="S1.p5.1.1">(1) Enhanced Collaborative Preference Modeling:</span> The VAE explicitly models latent factors influencing user-item interactions, allowing GaVaMoE to capture complex, non-linear relationships and encode user-item collaborative preferences directly into the latent space.
<span class="ltx_text ltx_font_bold" id="S1.p5.1.2">(2) Improved Personalization:</span> The GMM clustering identifies distinct user groups based on their rating behaviors, enabling more nuanced user representation. The multi-gating mechanism ensures that explanations are tailored to specific user types and preferences, with each gate specializing in routing user-item pairs to suitable experts.
<span class="ltx_text ltx_font_bold" id="S1.p5.1.3">(3) Effective Handling of Data Sparsity:</span> By employing GMM for clustering user-item interactions and utilizing multiple expert models, the system can leverage similarities among users to generate meaningful explanations, even for those with limited interaction history.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Our main contributions can be summarized as follows:</p>
</div>
<div class="ltx_para" id="S1.p7">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce GaVaMoE, an novel framework that integrates a VAE with GMM (VAE-GMM) for rating reconstruction and a Multi-gating Mixture of Experts for explanation generation. This design allows for more accurate modeling of user-item collaborative preferences and generates highly personalized, contextually relevant explanations.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We develop a dynamic multi-gating mechanism that efficiently routes user-item pairs to expert models based on clustered user behaviors. This mechanism enhances the system’s ability to handle sparse data and generate tailored explanations for diverse user groups, ensuring that even users with limited interaction histories receive meaningful, high-quality recommendations and explanations.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We conduct extensive experiments on three real-world datasets, demonstrating that GaVaMoE significantly outperforms previous methods across multiple metrics, including explanation quality, personalization, and consistency, and effectively addressing data sparsity challenges.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Works</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_font_bold ltx_title_paragraph">Explainable Recommendation System.</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">Explainable recommendation provides explanations that clarify why certain items are recommended, thereby enhancing the transparency and persuasiveness of the recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib45" title="">zhang2020explainable, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib36" title="">tintarev2015explaining, </a>)</cite>.
Explainable recommendations can be presented in various format, such as predefined templates <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib33" title="">tan2021counterfactual, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib46" title="">zhang2014explicit, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib19" title="">li2020generate, </a>)</cite>, reasoning rules <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib3" title="">chen2021neural, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib32" title="">shi2020neural, </a>)</cite>. However, these methods are expensive to maintain and fail to produce diverse, personalized explanations, resulting in poor generalization. Related works of Explainable recommendation based on item features <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib11" title="">he2015trirank, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib39" title="">wang2018tem, </a>)</cite>, knowledge graph paths <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib1" title="">ai2018learning, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib8" title="">fu2020fairness, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib40" title="">xian2019reinforcement, </a>)</cite>, and ranked text <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib20" title="">li2021extraexplanationrankingdatasets, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib21" title="">li2021extra, </a>)</cite> also similarly face the problem of low generalization and poor personalization. To address these challenges, more and more explainable recommendation systems based on natural language processing techniques have been studied. These works focus on using generative models to directly obtain personalized explanations. NRT <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib24" title="">li2017neural, </a>)</cite> simultaneously performs accurate score prediction while generating high-quality summarized prompts by integrating user and item latent factors. Co-Attentive Multi-Task Learning (CAML ) <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib4" title="">chen2019co, </a>)</cite> integrates a multi-task learning mechanism and adopts the joint attention proposed in <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib34" title="">tay2018multi, </a>)</cite>. PETER<cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib22" title="">li2021personalized, </a>)</cite> employs a small, unpretrained Transformer, connecting user and item IDs with generated text through a designed context prediction task for personalized text generation.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p2.1">Recently, research on LLM-based ER systems has gained significant attention. ReXPlug is an end-to-end explainable recommendation framework that generates high-quality personalized natural language reviews for users by plugging in and utilizing a plug-and-play language model. PEPLER <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib23" title="">li2023personalized, </a>)</cite> utilizes a pretrained language model GPT2 <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib29" title="">radford2019language, </a>)</cite> to generate explainable recommendations by incorporating user and item ID vectors into prompts. LLM2ER <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib42" title="">yang2024fine, </a>)</cite> utilizes a personalized prompt learning module to match user preference and fine-tunes the model with reinforcement learning using two innovative explainability quality reward models to generate explanations. Xrec <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib27" title="">ma2024xrec, </a>)</cite> seamlessly integrates the capabilities of large language models with a graph-based collaborative filtering paradigm to generate text. To address the low-quality issues caused by hallucination in large language models, PEVAE <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib2" title="">cai2022pevae, </a>)</cite> employs personalized variational autoencoders to tackle specific quality concerns, while PRAG <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib41" title="">xie2023factual, </a>)</cite> enhances performance by incorporating retrieval augmentation to resolve certain low-quality issues.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_font_bold ltx_title_paragraph">Mixture of Experts.</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">Mixture of Experts (MoE) technology was first introduced by <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib14" title="">jacobs1991adaptive, </a>)</cite>, where different experts are used to complete various subtasks. With the development of deep learning, the Transformer <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib38" title="">vaswani2017attention, </a>)</cite> has been widely used in various natural language processing tasks. In the process, numerous studies have attempted to replace the feed-forward neural network (FFN) layer within Transformer with MoE. Sparsely-Gated MoE <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib30" title="">shazeer2017outrageously, </a>)</cite> introduces a sparsely gated mixture of experts layer, which contains multiple feed-forward layers and scales up to 137B parameters. This MoE implementation is applied convolutely between stacked LSTM <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib13" title="">hochreiter1997long, </a>)</cite> layers. GShard <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib18" title="">lepikhin2020gshard, </a>)</cite> is a pioneer in scaling MoE language models to ultra-large sizes using learnable top-2 or top-1 routing strategies. Switch Transformer <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib7" title="">fedus2022switch, </a>)</cite> introduces the concept of expert capacity and simplifies the expert routing algorithm, summarizing a set of MoE training experiences. The ST-MoE <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib48" title="">zoph2022st, </a>)</cite> model is a stable and transferable sparse expert model that addresses training instability issues by introducing router z-loss. With the development of large language models, researchers have made significant innovations in MoE. Mixtral 8x7B <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib15" title="">jiang2024mixtral, </a>)</cite> is a sparse mixture of experts language model with 8 feed-forward blocks, achieving performance comparable to a 70B parameter model across multiple benchmarks. LLaMA-MoE <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib47" title="">zhu2024llama, </a>)</cite> constructs a sparse MoE model by partitioning the FFN parameters of the existing large language model LLaMA <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib37" title="">touvron2023llama, </a>)</cite> into multiple experts.
DeepSeekMoE <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib5" title="">dai2024deepseekmoe, </a>)</cite> innovatively proposes fine-grained expert segmentation and shared expert isolation strategies to address the problems of knowledge mixing and redundancy, enhancing model performance.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="340" id="S2.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S2.F2.3.2" style="font-size:90%;">The architecture of GaVaMoE. The model comprises N stacked GaVaMoE Blocks, each featuring two key componets: (1) VAE-GMM for Rating Reconstruction, which uses VAE and GMM to reconstruct user-item ratings, capturing collaborative signals and clustering users with similar preferences; and (2) Multi-gating Mixture of Experts, which employs a Multi-gating mechanism to route user-item pairs to appropriate fine-grained experts for explanation generation. GaVaMoE’s training occurs in two stages: Rating Reconstruction Training, which focuses on learning user-item collaborative preferences and clustering, followed by Explanation Generation Training, which utilizes the learned representations to produce personalized explanations.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Method</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we present GaVaMoE, a novel explainable recommendation system based on a Mixture of Experts model. We begin by providing a detailed definition of the explainable recommendation task (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS1" title="3.1. Task Formulation ‣ 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">3.1</span></a>). Then, we introduce our proposed framework, illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S2.F2" title="Figure 2 ‣ Mixture of Experts. ‣ 2. Related Works ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, which consists of two main components: VAE-GMM for Rating Reconstruction (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS2" title="3.2. VAE-GMM for Rating Reconstruction ‣ 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">3.2</span></a>), and Multi-gating Mixture of Experts (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS3" title="3.3. Multi-gating Mixture of Experts ‣ 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">3.3</span></a>). Finally, we detail the two-stage training process of our framework (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS4" title="3.4. Two-stage Training Objective ‣ 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">3.4</span></a>), demonstrating how these components work in concert to produce personalized and contextually relevant explanations.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Task Formulation</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.13">The explainable recommendation task involves generating personalized item recommendations along with human-readable explanations. Formally, given a user-item pair <math alttext="y\in Y" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">y</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑦</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">y\in Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_y ∈ italic_Y</annotation></semantics></math>, which consists of a user ID <math alttext="u\in U" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">u</mi><mo id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><in id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"></in><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑢</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">u\in U</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_u ∈ italic_U</annotation></semantics></math> and an item ID <math alttext="i\in I" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">i</mi><mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><in id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></in><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑖</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">i\in I</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_i ∈ italic_I</annotation></semantics></math>, we consider the rating <math alttext="r_{u,i}\in R_{&gt;0}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.2"><semantics id="S3.SS1.p1.4.m4.2a"><mrow id="S3.SS1.p1.4.m4.2.3" xref="S3.SS1.p1.4.m4.2.3.cmml"><msub id="S3.SS1.p1.4.m4.2.3.2" xref="S3.SS1.p1.4.m4.2.3.2.cmml"><mi id="S3.SS1.p1.4.m4.2.3.2.2" xref="S3.SS1.p1.4.m4.2.3.2.2.cmml">r</mi><mrow id="S3.SS1.p1.4.m4.2.2.2.4" xref="S3.SS1.p1.4.m4.2.2.2.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.cmml">u</mi><mo id="S3.SS1.p1.4.m4.2.2.2.4.1" xref="S3.SS1.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.4.m4.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.SS1.p1.4.m4.2.3.1" xref="S3.SS1.p1.4.m4.2.3.1.cmml">∈</mo><msub id="S3.SS1.p1.4.m4.2.3.3" xref="S3.SS1.p1.4.m4.2.3.3.cmml"><mi id="S3.SS1.p1.4.m4.2.3.3.2" xref="S3.SS1.p1.4.m4.2.3.3.2.cmml">R</mi><mrow id="S3.SS1.p1.4.m4.2.3.3.3" xref="S3.SS1.p1.4.m4.2.3.3.3.cmml"><mi id="S3.SS1.p1.4.m4.2.3.3.3.2" xref="S3.SS1.p1.4.m4.2.3.3.3.2.cmml"></mi><mo id="S3.SS1.p1.4.m4.2.3.3.3.1" xref="S3.SS1.p1.4.m4.2.3.3.3.1.cmml">&gt;</mo><mn id="S3.SS1.p1.4.m4.2.3.3.3.3" xref="S3.SS1.p1.4.m4.2.3.3.3.3.cmml">0</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.2b"><apply id="S3.SS1.p1.4.m4.2.3.cmml" xref="S3.SS1.p1.4.m4.2.3"><in id="S3.SS1.p1.4.m4.2.3.1.cmml" xref="S3.SS1.p1.4.m4.2.3.1"></in><apply id="S3.SS1.p1.4.m4.2.3.2.cmml" xref="S3.SS1.p1.4.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.3.2.1.cmml" xref="S3.SS1.p1.4.m4.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.3.2.2.cmml" xref="S3.SS1.p1.4.m4.2.3.2.2">𝑟</ci><list id="S3.SS1.p1.4.m4.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2.4"><ci id="S3.SS1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1">𝑢</ci><ci id="S3.SS1.p1.4.m4.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2">𝑖</ci></list></apply><apply id="S3.SS1.p1.4.m4.2.3.3.cmml" xref="S3.SS1.p1.4.m4.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.3.3.1.cmml" xref="S3.SS1.p1.4.m4.2.3.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.3.3.2.cmml" xref="S3.SS1.p1.4.m4.2.3.3.2">𝑅</ci><apply id="S3.SS1.p1.4.m4.2.3.3.3.cmml" xref="S3.SS1.p1.4.m4.2.3.3.3"><gt id="S3.SS1.p1.4.m4.2.3.3.3.1.cmml" xref="S3.SS1.p1.4.m4.2.3.3.3.1"></gt><csymbol cd="latexml" id="S3.SS1.p1.4.m4.2.3.3.3.2.cmml" xref="S3.SS1.p1.4.m4.2.3.3.3.2">absent</csymbol><cn id="S3.SS1.p1.4.m4.2.3.3.3.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.2.3.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.2c">r_{u,i}\in R_{&gt;0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.2d">italic_r start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT ∈ italic_R start_POSTSUBSCRIPT &gt; 0 end_POSTSUBSCRIPT</annotation></semantics></math> as an indicator of user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_u</annotation></semantics></math>’s positive attitude towards item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_i</annotation></semantics></math>. Each item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_i</annotation></semantics></math> is associated with a set of features <math alttext="f_{u,i}\in F" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.2"><semantics id="S3.SS1.p1.8.m8.2a"><mrow id="S3.SS1.p1.8.m8.2.3" xref="S3.SS1.p1.8.m8.2.3.cmml"><msub id="S3.SS1.p1.8.m8.2.3.2" xref="S3.SS1.p1.8.m8.2.3.2.cmml"><mi id="S3.SS1.p1.8.m8.2.3.2.2" xref="S3.SS1.p1.8.m8.2.3.2.2.cmml">f</mi><mrow id="S3.SS1.p1.8.m8.2.2.2.4" xref="S3.SS1.p1.8.m8.2.2.2.3.cmml"><mi id="S3.SS1.p1.8.m8.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.cmml">u</mi><mo id="S3.SS1.p1.8.m8.2.2.2.4.1" xref="S3.SS1.p1.8.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.8.m8.2.2.2.2" xref="S3.SS1.p1.8.m8.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.SS1.p1.8.m8.2.3.1" xref="S3.SS1.p1.8.m8.2.3.1.cmml">∈</mo><mi id="S3.SS1.p1.8.m8.2.3.3" xref="S3.SS1.p1.8.m8.2.3.3.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.2b"><apply id="S3.SS1.p1.8.m8.2.3.cmml" xref="S3.SS1.p1.8.m8.2.3"><in id="S3.SS1.p1.8.m8.2.3.1.cmml" xref="S3.SS1.p1.8.m8.2.3.1"></in><apply id="S3.SS1.p1.8.m8.2.3.2.cmml" xref="S3.SS1.p1.8.m8.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.2.3.2.1.cmml" xref="S3.SS1.p1.8.m8.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.2.3.2.2.cmml" xref="S3.SS1.p1.8.m8.2.3.2.2">𝑓</ci><list id="S3.SS1.p1.8.m8.2.2.2.3.cmml" xref="S3.SS1.p1.8.m8.2.2.2.4"><ci id="S3.SS1.p1.8.m8.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1">𝑢</ci><ci id="S3.SS1.p1.8.m8.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS1.p1.8.m8.2.3.3.cmml" xref="S3.SS1.p1.8.m8.2.3.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.2c">f_{u,i}\in F</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.2d">italic_f start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT ∈ italic_F</annotation></semantics></math>, which describe its characteristics (e.g., ”thrilling” or ”comedy” for a movie). These features play a crucial role in generating explainable text, as they reflect the attributes of an item under specific circumstances <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib22" title="">li2021personalized, </a>)</cite>.
Following LLM2ER <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib42" title="">yang2024fine, </a>)</cite>, we incorporate these feature words into the LLM prompt to enhance explanation generation. In summary, the input consists of user ID <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_u</annotation></semantics></math>, item ID <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_i</annotation></semantics></math>, user’s rating <math alttext="r_{u,i}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.2"><semantics id="S3.SS1.p1.11.m11.2a"><msub id="S3.SS1.p1.11.m11.2.3" xref="S3.SS1.p1.11.m11.2.3.cmml"><mi id="S3.SS1.p1.11.m11.2.3.2" xref="S3.SS1.p1.11.m11.2.3.2.cmml">r</mi><mrow id="S3.SS1.p1.11.m11.2.2.2.4" xref="S3.SS1.p1.11.m11.2.2.2.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.1.cmml">u</mi><mo id="S3.SS1.p1.11.m11.2.2.2.4.1" xref="S3.SS1.p1.11.m11.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.11.m11.2.2.2.2" xref="S3.SS1.p1.11.m11.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.2b"><apply id="S3.SS1.p1.11.m11.2.3.cmml" xref="S3.SS1.p1.11.m11.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.2.3.1.cmml" xref="S3.SS1.p1.11.m11.2.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.2.3.2.cmml" xref="S3.SS1.p1.11.m11.2.3.2">𝑟</ci><list id="S3.SS1.p1.11.m11.2.2.2.3.cmml" xref="S3.SS1.p1.11.m11.2.2.2.4"><ci id="S3.SS1.p1.11.m11.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1">𝑢</ci><ci id="S3.SS1.p1.11.m11.2.2.2.2.cmml" xref="S3.SS1.p1.11.m11.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.2c">r_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.2d">italic_r start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, feature words <math alttext="f_{u,i}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.2"><semantics id="S3.SS1.p1.12.m12.2a"><msub id="S3.SS1.p1.12.m12.2.3" xref="S3.SS1.p1.12.m12.2.3.cmml"><mi id="S3.SS1.p1.12.m12.2.3.2" xref="S3.SS1.p1.12.m12.2.3.2.cmml">f</mi><mrow id="S3.SS1.p1.12.m12.2.2.2.4" xref="S3.SS1.p1.12.m12.2.2.2.3.cmml"><mi id="S3.SS1.p1.12.m12.1.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.1.cmml">u</mi><mo id="S3.SS1.p1.12.m12.2.2.2.4.1" xref="S3.SS1.p1.12.m12.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.12.m12.2.2.2.2" xref="S3.SS1.p1.12.m12.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.2b"><apply id="S3.SS1.p1.12.m12.2.3.cmml" xref="S3.SS1.p1.12.m12.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.2.3.1.cmml" xref="S3.SS1.p1.12.m12.2.3">subscript</csymbol><ci id="S3.SS1.p1.12.m12.2.3.2.cmml" xref="S3.SS1.p1.12.m12.2.3.2">𝑓</ci><list id="S3.SS1.p1.12.m12.2.2.2.3.cmml" xref="S3.SS1.p1.12.m12.2.2.2.4"><ci id="S3.SS1.p1.12.m12.1.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1">𝑢</ci><ci id="S3.SS1.p1.12.m12.2.2.2.2.cmml" xref="S3.SS1.p1.12.m12.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.2c">f_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.2d">italic_f start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Given this input, our model aims to generate explainable text <math alttext="\hat{e}_{u,i}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.2"><semantics id="S3.SS1.p1.13.m13.2a"><msub id="S3.SS1.p1.13.m13.2.3" xref="S3.SS1.p1.13.m13.2.3.cmml"><mover accent="true" id="S3.SS1.p1.13.m13.2.3.2" xref="S3.SS1.p1.13.m13.2.3.2.cmml"><mi id="S3.SS1.p1.13.m13.2.3.2.2" xref="S3.SS1.p1.13.m13.2.3.2.2.cmml">e</mi><mo id="S3.SS1.p1.13.m13.2.3.2.1" xref="S3.SS1.p1.13.m13.2.3.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p1.13.m13.2.2.2.4" xref="S3.SS1.p1.13.m13.2.2.2.3.cmml"><mi id="S3.SS1.p1.13.m13.1.1.1.1" xref="S3.SS1.p1.13.m13.1.1.1.1.cmml">u</mi><mo id="S3.SS1.p1.13.m13.2.2.2.4.1" xref="S3.SS1.p1.13.m13.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.13.m13.2.2.2.2" xref="S3.SS1.p1.13.m13.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.2b"><apply id="S3.SS1.p1.13.m13.2.3.cmml" xref="S3.SS1.p1.13.m13.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.2.3.1.cmml" xref="S3.SS1.p1.13.m13.2.3">subscript</csymbol><apply id="S3.SS1.p1.13.m13.2.3.2.cmml" xref="S3.SS1.p1.13.m13.2.3.2"><ci id="S3.SS1.p1.13.m13.2.3.2.1.cmml" xref="S3.SS1.p1.13.m13.2.3.2.1">^</ci><ci id="S3.SS1.p1.13.m13.2.3.2.2.cmml" xref="S3.SS1.p1.13.m13.2.3.2.2">𝑒</ci></apply><list id="S3.SS1.p1.13.m13.2.2.2.3.cmml" xref="S3.SS1.p1.13.m13.2.2.2.4"><ci id="S3.SS1.p1.13.m13.1.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1">𝑢</ci><ci id="S3.SS1.p1.13.m13.2.2.2.2.cmml" xref="S3.SS1.p1.13.m13.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.2c">\hat{e}_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.2d">over^ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span> VAE-GMM for Rating Reconstruction</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">To effectively capture deep collaborative preferences and cluster users with similar behaviors, we propose a Variational Autoencoder (VAE) integrated with a Gaussian Mixture Model (GMM). This component serves as the foundation for modeling complex user-item collaborative preferences and acts as a routing strategy for our multi-gating mechanism, addressing the challenge of data sparsity.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1. </span>Rating Reconstruction with Variational Autoencoder</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.6">We employ a VAE to learn compact representations of user-item interactions. Given a user-item pair <math alttext="(u,i)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.2"><semantics id="S3.SS2.SSS1.p1.1.m1.2a"><mrow id="S3.SS2.SSS1.p1.1.m1.2.3.2" xref="S3.SS2.SSS1.p1.1.m1.2.3.1.cmml"><mo id="S3.SS2.SSS1.p1.1.m1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p1.1.m1.2.3.1.cmml">(</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml">u</mi><mo id="S3.SS2.SSS1.p1.1.m1.2.3.2.2" xref="S3.SS2.SSS1.p1.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS2.SSS1.p1.1.m1.2.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.cmml">i</mi><mo id="S3.SS2.SSS1.p1.1.m1.2.3.2.3" stretchy="false" xref="S3.SS2.SSS1.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.2b"><interval closure="open" id="S3.SS2.SSS1.p1.1.m1.2.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.3.2"><ci id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">𝑢</ci><ci id="S3.SS2.SSS1.p1.1.m1.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2">𝑖</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.2c">(u,i)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.2d">( italic_u , italic_i )</annotation></semantics></math> where <math alttext="u\in U" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><mrow id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml">u</mi><mo id="S3.SS2.SSS1.p1.2.m2.1.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.cmml">∈</mo><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><apply id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1"><in id="S3.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1"></in><ci id="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.2">𝑢</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">u\in U</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">italic_u ∈ italic_U</annotation></semantics></math> and <math alttext="i\in I" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.3.m3.1"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><mrow id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml">i</mi><mo id="S3.SS2.SSS1.p1.3.m3.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.cmml">∈</mo><mi id="S3.SS2.SSS1.p1.3.m3.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><apply id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1"><in id="S3.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1"></in><ci id="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.2">𝑖</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">i\in I</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">italic_i ∈ italic_I</annotation></semantics></math>, the encoder <math alttext="E" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.4.m4.1"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><mi id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><ci id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m4.1d">italic_E</annotation></semantics></math> of the VAE predicts the mean <math alttext="\mu" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.5.m5.1"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><mi id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><ci id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.5.m5.1d">italic_μ</annotation></semantics></math> and log-variance <math alttext="log(\sigma)^{2}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.6.m6.1"><semantics id="S3.SS2.SSS1.p1.6.m6.1a"><mrow id="S3.SS2.SSS1.p1.6.m6.1.2" xref="S3.SS2.SSS1.p1.6.m6.1.2.cmml"><mi id="S3.SS2.SSS1.p1.6.m6.1.2.2" xref="S3.SS2.SSS1.p1.6.m6.1.2.2.cmml">l</mi><mo id="S3.SS2.SSS1.p1.6.m6.1.2.1" xref="S3.SS2.SSS1.p1.6.m6.1.2.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p1.6.m6.1.2.3" xref="S3.SS2.SSS1.p1.6.m6.1.2.3.cmml">o</mi><mo id="S3.SS2.SSS1.p1.6.m6.1.2.1a" xref="S3.SS2.SSS1.p1.6.m6.1.2.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p1.6.m6.1.2.4" xref="S3.SS2.SSS1.p1.6.m6.1.2.4.cmml">g</mi><mo id="S3.SS2.SSS1.p1.6.m6.1.2.1b" xref="S3.SS2.SSS1.p1.6.m6.1.2.1.cmml">⁢</mo><msup id="S3.SS2.SSS1.p1.6.m6.1.2.5" xref="S3.SS2.SSS1.p1.6.m6.1.2.5.cmml"><mrow id="S3.SS2.SSS1.p1.6.m6.1.2.5.2.2" xref="S3.SS2.SSS1.p1.6.m6.1.2.5.cmml"><mo id="S3.SS2.SSS1.p1.6.m6.1.2.5.2.2.1" stretchy="false" xref="S3.SS2.SSS1.p1.6.m6.1.2.5.cmml">(</mo><mi id="S3.SS2.SSS1.p1.6.m6.1.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.cmml">σ</mi><mo id="S3.SS2.SSS1.p1.6.m6.1.2.5.2.2.2" stretchy="false" xref="S3.SS2.SSS1.p1.6.m6.1.2.5.cmml">)</mo></mrow><mn id="S3.SS2.SSS1.p1.6.m6.1.2.5.3" xref="S3.SS2.SSS1.p1.6.m6.1.2.5.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m6.1b"><apply id="S3.SS2.SSS1.p1.6.m6.1.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.2"><times id="S3.SS2.SSS1.p1.6.m6.1.2.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.2.1"></times><ci id="S3.SS2.SSS1.p1.6.m6.1.2.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.2.2">𝑙</ci><ci id="S3.SS2.SSS1.p1.6.m6.1.2.3.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.2.3">𝑜</ci><ci id="S3.SS2.SSS1.p1.6.m6.1.2.4.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.2.4">𝑔</ci><apply id="S3.SS2.SSS1.p1.6.m6.1.2.5.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.2.5"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.6.m6.1.2.5.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.2.5">superscript</csymbol><ci id="S3.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1">𝜎</ci><cn id="S3.SS2.SSS1.p1.6.m6.1.2.5.3.cmml" type="integer" xref="S3.SS2.SSS1.p1.6.m6.1.2.5.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m6.1c">log(\sigma)^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.6.m6.1d">italic_l italic_o italic_g ( italic_σ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> of the latent representation:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[\mu,log(\sigma)^{2}]=E(u,i)" class="ltx_Math" display="block" id="S3.E1.m1.5"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml"><mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.2.cmml"><mo id="S3.E1.m1.5.5.1.1.2" stretchy="false" xref="S3.E1.m1.5.5.1.2.cmml">[</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">μ</mi><mo id="S3.E1.m1.5.5.1.1.3" xref="S3.E1.m1.5.5.1.2.cmml">,</mo><mrow id="S3.E1.m1.5.5.1.1.1" xref="S3.E1.m1.5.5.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.2.cmml">l</mi><mo id="S3.E1.m1.5.5.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.5.5.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.3.cmml">o</mi><mo id="S3.E1.m1.5.5.1.1.1.1a" xref="S3.E1.m1.5.5.1.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.5.5.1.1.1.4" xref="S3.E1.m1.5.5.1.1.1.4.cmml">g</mi><mo id="S3.E1.m1.5.5.1.1.1.1b" xref="S3.E1.m1.5.5.1.1.1.1.cmml">⁢</mo><msup id="S3.E1.m1.5.5.1.1.1.5" xref="S3.E1.m1.5.5.1.1.1.5.cmml"><mrow id="S3.E1.m1.5.5.1.1.1.5.2.2" xref="S3.E1.m1.5.5.1.1.1.5.cmml"><mo id="S3.E1.m1.5.5.1.1.1.5.2.2.1" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.5.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">σ</mi><mo id="S3.E1.m1.5.5.1.1.1.5.2.2.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.5.cmml">)</mo></mrow><mn id="S3.E1.m1.5.5.1.1.1.5.3" xref="S3.E1.m1.5.5.1.1.1.5.3.cmml">2</mn></msup></mrow><mo id="S3.E1.m1.5.5.1.1.4" stretchy="false" xref="S3.E1.m1.5.5.1.2.cmml">]</mo></mrow><mo id="S3.E1.m1.5.5.2" xref="S3.E1.m1.5.5.2.cmml">=</mo><mrow id="S3.E1.m1.5.5.3" xref="S3.E1.m1.5.5.3.cmml"><mi id="S3.E1.m1.5.5.3.2" xref="S3.E1.m1.5.5.3.2.cmml">E</mi><mo id="S3.E1.m1.5.5.3.1" xref="S3.E1.m1.5.5.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.3.3.2" xref="S3.E1.m1.5.5.3.3.1.cmml"><mo id="S3.E1.m1.5.5.3.3.2.1" stretchy="false" xref="S3.E1.m1.5.5.3.3.1.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">u</mi><mo id="S3.E1.m1.5.5.3.3.2.2" xref="S3.E1.m1.5.5.3.3.1.cmml">,</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">i</mi><mo id="S3.E1.m1.5.5.3.3.2.3" stretchy="false" xref="S3.E1.m1.5.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5"><eq id="S3.E1.m1.5.5.2.cmml" xref="S3.E1.m1.5.5.2"></eq><interval closure="closed" id="S3.E1.m1.5.5.1.2.cmml" xref="S3.E1.m1.5.5.1.1"><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝜇</ci><apply id="S3.E1.m1.5.5.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1"><times id="S3.E1.m1.5.5.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1"></times><ci id="S3.E1.m1.5.5.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.2">𝑙</ci><ci id="S3.E1.m1.5.5.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.3">𝑜</ci><ci id="S3.E1.m1.5.5.1.1.1.4.cmml" xref="S3.E1.m1.5.5.1.1.1.4">𝑔</ci><apply id="S3.E1.m1.5.5.1.1.1.5.cmml" xref="S3.E1.m1.5.5.1.1.1.5"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.5.1.cmml" xref="S3.E1.m1.5.5.1.1.1.5">superscript</csymbol><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝜎</ci><cn id="S3.E1.m1.5.5.1.1.1.5.3.cmml" type="integer" xref="S3.E1.m1.5.5.1.1.1.5.3">2</cn></apply></apply></interval><apply id="S3.E1.m1.5.5.3.cmml" xref="S3.E1.m1.5.5.3"><times id="S3.E1.m1.5.5.3.1.cmml" xref="S3.E1.m1.5.5.3.1"></times><ci id="S3.E1.m1.5.5.3.2.cmml" xref="S3.E1.m1.5.5.3.2">𝐸</ci><interval closure="open" id="S3.E1.m1.5.5.3.3.1.cmml" xref="S3.E1.m1.5.5.3.3.2"><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑢</ci><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝑖</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">[\mu,log(\sigma)^{2}]=E(u,i)</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.5d">[ italic_μ , italic_l italic_o italic_g ( italic_σ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] = italic_E ( italic_u , italic_i )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.1">To enable backpropagation during training, we utilize the reparameterization trick <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib25" title="">liang2018variational, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib31" title="">shenbin2020recvae, </a>)</cite>, which transforms the random sampling process into a differentiable operation:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="z=\mu+\varepsilon\sigma,\quad\varepsilon\sim N(0,I)" class="ltx_Math" display="block" id="S3.E2.m1.4"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.3.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml">z</mi><mo id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml">μ</mi><mo id="S3.E2.m1.3.3.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml">+</mo><mrow id="S3.E2.m1.3.3.1.1.3.3" xref="S3.E2.m1.3.3.1.1.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.3.3.2.cmml">ε</mi><mo id="S3.E2.m1.3.3.1.1.3.3.1" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.1.1.3.3.3" xref="S3.E2.m1.3.3.1.1.3.3.3.cmml">σ</mi></mrow></mrow></mrow><mo id="S3.E2.m1.4.4.2.3" rspace="1.167em" xref="S3.E2.m1.4.4.3a.cmml">,</mo><mrow id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml"><mi id="S3.E2.m1.4.4.2.2.2" xref="S3.E2.m1.4.4.2.2.2.cmml">ε</mi><mo id="S3.E2.m1.4.4.2.2.1" xref="S3.E2.m1.4.4.2.2.1.cmml">∼</mo><mrow id="S3.E2.m1.4.4.2.2.3" xref="S3.E2.m1.4.4.2.2.3.cmml"><mi id="S3.E2.m1.4.4.2.2.3.2" xref="S3.E2.m1.4.4.2.2.3.2.cmml">N</mi><mo id="S3.E2.m1.4.4.2.2.3.1" xref="S3.E2.m1.4.4.2.2.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.4.4.2.2.3.3.2" xref="S3.E2.m1.4.4.2.2.3.3.1.cmml"><mo id="S3.E2.m1.4.4.2.2.3.3.2.1" stretchy="false" xref="S3.E2.m1.4.4.2.2.3.3.1.cmml">(</mo><mn id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">0</mn><mo id="S3.E2.m1.4.4.2.2.3.3.2.2" xref="S3.E2.m1.4.4.2.2.3.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">I</mi><mo id="S3.E2.m1.4.4.2.2.3.3.2.3" stretchy="false" xref="S3.E2.m1.4.4.2.2.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.3.cmml" xref="S3.E2.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.3a.cmml" xref="S3.E2.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1"><eq id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"></eq><ci id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2">𝑧</ci><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><plus id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1"></plus><ci id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2">𝜇</ci><apply id="S3.E2.m1.3.3.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3"><times id="S3.E2.m1.3.3.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1"></times><ci id="S3.E2.m1.3.3.1.1.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.3.2">𝜀</ci><ci id="S3.E2.m1.3.3.1.1.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3.3">𝜎</ci></apply></apply></apply><apply id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2"><csymbol cd="latexml" id="S3.E2.m1.4.4.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1">similar-to</csymbol><ci id="S3.E2.m1.4.4.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2">𝜀</ci><apply id="S3.E2.m1.4.4.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.3"><times id="S3.E2.m1.4.4.2.2.3.1.cmml" xref="S3.E2.m1.4.4.2.2.3.1"></times><ci id="S3.E2.m1.4.4.2.2.3.2.cmml" xref="S3.E2.m1.4.4.2.2.3.2">𝑁</ci><interval closure="open" id="S3.E2.m1.4.4.2.2.3.3.1.cmml" xref="S3.E2.m1.4.4.2.2.3.3.2"><cn id="S3.E2.m1.1.1.cmml" type="integer" xref="S3.E2.m1.1.1">0</cn><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝐼</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">z=\mu+\varepsilon\sigma,\quad\varepsilon\sim N(0,I)</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.4d">italic_z = italic_μ + italic_ε italic_σ , italic_ε ∼ italic_N ( 0 , italic_I )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p3">
<p class="ltx_p" id="S3.SS2.SSS1.p3.3">where <math alttext="\varepsilon" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.1.m1.1"><semantics id="S3.SS2.SSS1.p3.1.m1.1a"><mi id="S3.SS2.SSS1.p3.1.m1.1.1" xref="S3.SS2.SSS1.p3.1.m1.1.1.cmml">ε</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.1.m1.1b"><ci id="S3.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1">𝜀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.1.m1.1c">\varepsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.1.m1.1d">italic_ε</annotation></semantics></math> is randomly sampled from a standard normal distribution. The decoder <math alttext="D" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.2.m2.1"><semantics id="S3.SS2.SSS1.p3.2.m2.1a"><mi id="S3.SS2.SSS1.p3.2.m2.1.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.2.m2.1b"><ci id="S3.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.2.m2.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.2.m2.1d">italic_D</annotation></semantics></math> then reconstructs the rating from the latent <math alttext="z" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.3.m3.1"><semantics id="S3.SS2.SSS1.p3.3.m3.1a"><mi id="S3.SS2.SSS1.p3.3.m3.1.1" xref="S3.SS2.SSS1.p3.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.3.m3.1b"><ci id="S3.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.3.m3.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.3.m3.1d">italic_z</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{r}_{u,i}=D(z)" class="ltx_Math" display="block" id="S3.E3.m1.3"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.4" xref="S3.E3.m1.3.4.cmml"><msub id="S3.E3.m1.3.4.2" xref="S3.E3.m1.3.4.2.cmml"><mover accent="true" id="S3.E3.m1.3.4.2.2" xref="S3.E3.m1.3.4.2.2.cmml"><mi id="S3.E3.m1.3.4.2.2.2" xref="S3.E3.m1.3.4.2.2.2.cmml">r</mi><mo id="S3.E3.m1.3.4.2.2.1" xref="S3.E3.m1.3.4.2.2.1.cmml">^</mo></mover><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">u</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E3.m1.3.4.1" xref="S3.E3.m1.3.4.1.cmml">=</mo><mrow id="S3.E3.m1.3.4.3" xref="S3.E3.m1.3.4.3.cmml"><mi id="S3.E3.m1.3.4.3.2" xref="S3.E3.m1.3.4.3.2.cmml">D</mi><mo id="S3.E3.m1.3.4.3.1" xref="S3.E3.m1.3.4.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.3.4.3.3.2" xref="S3.E3.m1.3.4.3.cmml"><mo id="S3.E3.m1.3.4.3.3.2.1" stretchy="false" xref="S3.E3.m1.3.4.3.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">z</mi><mo id="S3.E3.m1.3.4.3.3.2.2" stretchy="false" xref="S3.E3.m1.3.4.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.4.cmml" xref="S3.E3.m1.3.4"><eq id="S3.E3.m1.3.4.1.cmml" xref="S3.E3.m1.3.4.1"></eq><apply id="S3.E3.m1.3.4.2.cmml" xref="S3.E3.m1.3.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.4.2.1.cmml" xref="S3.E3.m1.3.4.2">subscript</csymbol><apply id="S3.E3.m1.3.4.2.2.cmml" xref="S3.E3.m1.3.4.2.2"><ci id="S3.E3.m1.3.4.2.2.1.cmml" xref="S3.E3.m1.3.4.2.2.1">^</ci><ci id="S3.E3.m1.3.4.2.2.2.cmml" xref="S3.E3.m1.3.4.2.2.2">𝑟</ci></apply><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑢</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E3.m1.3.4.3.cmml" xref="S3.E3.m1.3.4.3"><times id="S3.E3.m1.3.4.3.1.cmml" xref="S3.E3.m1.3.4.3.1"></times><ci id="S3.E3.m1.3.4.3.2.cmml" xref="S3.E3.m1.3.4.3.2">𝐷</ci><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\hat{r}_{u,i}=D(z)</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.3d">over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT = italic_D ( italic_z )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p4">
<p class="ltx_p" id="S3.SS2.SSS1.p4.1">This reconstruction process allows the model to learn a compact representation of user-item interactions, effectively modeling complex collaborative preferences.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2. </span>User Clustering with Gaussian Mixture Model</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.4">To cluster users with similar collaborative preferences, we extend the above VAE by incorporating a Gaussian Mixture Model (GMM). Following the approach in <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib16" title="">jiang2016variational, </a>)</cite>, we assume that user-item pair embeddings follow a mixed Gaussian distribution, which allows us to cluster users with similar collaborative preferences. We define a Gaussian mixture distribution <math alttext="P=\text{GMM}(\pi,\bar{\mu},(\bar{\sigma})^{2})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.4"><semantics id="S3.SS2.SSS2.p1.1.m1.4a"><mrow id="S3.SS2.SSS2.p1.1.m1.4.4" xref="S3.SS2.SSS2.p1.1.m1.4.4.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.4.4.3" xref="S3.SS2.SSS2.p1.1.m1.4.4.3.cmml">P</mi><mo id="S3.SS2.SSS2.p1.1.m1.4.4.2" xref="S3.SS2.SSS2.p1.1.m1.4.4.2.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.1.m1.4.4.1" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.cmml"><mtext id="S3.SS2.SSS2.p1.1.m1.4.4.1.3" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.3a.cmml">GMM</mtext><mo id="S3.SS2.SSS2.p1.1.m1.4.4.1.2" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.1.2.cmml"><mo id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.1.2.cmml">(</mo><mi id="S3.SS2.SSS2.p1.1.m1.2.2" xref="S3.SS2.SSS2.p1.1.m1.2.2.cmml">π</mi><mo id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.1.2.cmml">,</mo><mover accent="true" id="S3.SS2.SSS2.p1.1.m1.3.3" xref="S3.SS2.SSS2.p1.1.m1.3.3.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.3.3.2" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.cmml">μ</mi><mo id="S3.SS2.SSS2.p1.1.m1.3.3.1" xref="S3.SS2.SSS2.p1.1.m1.3.3.1.cmml">¯</mo></mover><mo id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.4" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.1.2.cmml">,</mo><msup id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1.cmml"><mrow id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1.2.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mo id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1.2.2.1" stretchy="false" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">(</mo><mover accent="true" id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml">σ</mi><mo id="S3.SS2.SSS2.p1.1.m1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml">¯</mo></mover><mo id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1.2.2.2" stretchy="false" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">)</mo></mrow><mn id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.5" stretchy="false" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.4b"><apply id="S3.SS2.SSS2.p1.1.m1.4.4.cmml" xref="S3.SS2.SSS2.p1.1.m1.4.4"><eq id="S3.SS2.SSS2.p1.1.m1.4.4.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.4.4.2"></eq><ci id="S3.SS2.SSS2.p1.1.m1.4.4.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.4.4.3">𝑃</ci><apply id="S3.SS2.SSS2.p1.1.m1.4.4.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.4.4.1"><times id="S3.SS2.SSS2.p1.1.m1.4.4.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.2"></times><ci id="S3.SS2.SSS2.p1.1.m1.4.4.1.3a.cmml" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.3"><mtext id="S3.SS2.SSS2.p1.1.m1.4.4.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.3">GMM</mtext></ci><vector id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1"><ci id="S3.SS2.SSS2.p1.1.m1.2.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2">𝜋</ci><apply id="S3.SS2.SSS2.p1.1.m1.3.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3"><ci id="S3.SS2.SSS2.p1.1.m1.3.3.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.1">¯</ci><ci id="S3.SS2.SSS2.p1.1.m1.3.3.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.2">𝜇</ci></apply><apply id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1.2.2"><ci id="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1">¯</ci><ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2">𝜎</ci></apply><cn id="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.1.m1.4.4.1.1.1.1.3">2</cn></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.4c">P=\text{GMM}(\pi,\bar{\mu},(\bar{\sigma})^{2})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.4d">italic_P = GMM ( italic_π , over¯ start_ARG italic_μ end_ARG , ( over¯ start_ARG italic_σ end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><mi id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><ci id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">italic_π</annotation></semantics></math> represents the prior distribution, and <math alttext="\bar{\mu}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.3.m3.1"><semantics id="S3.SS2.SSS2.p1.3.m3.1a"><mover accent="true" id="S3.SS2.SSS2.p1.3.m3.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml">μ</mi><mo id="S3.SS2.SSS2.p1.3.m3.1.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.1b"><apply id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1"><ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1">¯</ci><ci id="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.2">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">\bar{\mu}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.3.m3.1d">over¯ start_ARG italic_μ end_ARG</annotation></semantics></math> and <math alttext="(\bar{\sigma})^{2}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.4.m4.1"><semantics id="S3.SS2.SSS2.p1.4.m4.1a"><msup id="S3.SS2.SSS2.p1.4.m4.1.2" xref="S3.SS2.SSS2.p1.4.m4.1.2.cmml"><mrow id="S3.SS2.SSS2.p1.4.m4.1.2.2.2" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml"><mo id="S3.SS2.SSS2.p1.4.m4.1.2.2.2.1" stretchy="false" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml">(</mo><mover accent="true" id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS2.p1.4.m4.1.1.2" xref="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml">σ</mi><mo id="S3.SS2.SSS2.p1.4.m4.1.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.cmml">¯</mo></mover><mo id="S3.SS2.SSS2.p1.4.m4.1.2.2.2.2" stretchy="false" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml">)</mo></mrow><mn id="S3.SS2.SSS2.p1.4.m4.1.2.3" xref="S3.SS2.SSS2.p1.4.m4.1.2.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m4.1b"><apply id="S3.SS2.SSS2.p1.4.m4.1.2.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.4.m4.1.2.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.2">superscript</csymbol><apply id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.2.2.2"><ci id="S3.SS2.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1">¯</ci><ci id="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.2">𝜎</ci></apply><cn id="S3.SS2.SSS2.p1.4.m4.1.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.4.m4.1.2.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">(\bar{\sigma})^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.4.m4.1d">( over¯ start_ARG italic_σ end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> represent the mean and variance of the Gaussian mixture distribution, respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.1">Assuming <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.1.m1.1"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><mi id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><ci id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.1.m1.1d">italic_K</annotation></semantics></math> clusters, the process of sampling and clustering from the latent space can be represented as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(x,z,c)=p(x|z)p(z|c)p(c)" class="ltx_Math" display="block" id="S3.E4.m1.6"><semantics id="S3.E4.m1.6a"><mrow id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml"><mrow id="S3.E4.m1.6.6.4" xref="S3.E4.m1.6.6.4.cmml"><mi id="S3.E4.m1.6.6.4.2" xref="S3.E4.m1.6.6.4.2.cmml">p</mi><mo id="S3.E4.m1.6.6.4.1" xref="S3.E4.m1.6.6.4.1.cmml">⁢</mo><mrow id="S3.E4.m1.6.6.4.3.2" xref="S3.E4.m1.6.6.4.3.1.cmml"><mo id="S3.E4.m1.6.6.4.3.2.1" stretchy="false" xref="S3.E4.m1.6.6.4.3.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">x</mi><mo id="S3.E4.m1.6.6.4.3.2.2" xref="S3.E4.m1.6.6.4.3.1.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">z</mi><mo id="S3.E4.m1.6.6.4.3.2.3" xref="S3.E4.m1.6.6.4.3.1.cmml">,</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">c</mi><mo id="S3.E4.m1.6.6.4.3.2.4" stretchy="false" xref="S3.E4.m1.6.6.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.6.6.3" xref="S3.E4.m1.6.6.3.cmml">=</mo><mrow id="S3.E4.m1.6.6.2" xref="S3.E4.m1.6.6.2.cmml"><mi id="S3.E4.m1.6.6.2.4" xref="S3.E4.m1.6.6.2.4.cmml">p</mi><mo id="S3.E4.m1.6.6.2.3" xref="S3.E4.m1.6.6.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.cmml"><mo id="S3.E4.m1.5.5.1.1.1.2" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.5.5.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.E4.m1.5.5.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="S3.E4.m1.5.5.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.3.cmml">z</mi></mrow><mo id="S3.E4.m1.5.5.1.1.1.3" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E4.m1.6.6.2.3a" xref="S3.E4.m1.6.6.2.3.cmml">⁢</mo><mi id="S3.E4.m1.6.6.2.5" xref="S3.E4.m1.6.6.2.5.cmml">p</mi><mo id="S3.E4.m1.6.6.2.3b" xref="S3.E4.m1.6.6.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.6.6.2.2.1" xref="S3.E4.m1.6.6.2.2.1.1.cmml"><mo id="S3.E4.m1.6.6.2.2.1.2" stretchy="false" xref="S3.E4.m1.6.6.2.2.1.1.cmml">(</mo><mrow id="S3.E4.m1.6.6.2.2.1.1" xref="S3.E4.m1.6.6.2.2.1.1.cmml"><mi id="S3.E4.m1.6.6.2.2.1.1.2" xref="S3.E4.m1.6.6.2.2.1.1.2.cmml">z</mi><mo fence="false" id="S3.E4.m1.6.6.2.2.1.1.1" xref="S3.E4.m1.6.6.2.2.1.1.1.cmml">|</mo><mi id="S3.E4.m1.6.6.2.2.1.1.3" xref="S3.E4.m1.6.6.2.2.1.1.3.cmml">c</mi></mrow><mo id="S3.E4.m1.6.6.2.2.1.3" stretchy="false" xref="S3.E4.m1.6.6.2.2.1.1.cmml">)</mo></mrow><mo id="S3.E4.m1.6.6.2.3c" xref="S3.E4.m1.6.6.2.3.cmml">⁢</mo><mi id="S3.E4.m1.6.6.2.6" xref="S3.E4.m1.6.6.2.6.cmml">p</mi><mo id="S3.E4.m1.6.6.2.3d" xref="S3.E4.m1.6.6.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.6.6.2.7.2" xref="S3.E4.m1.6.6.2.cmml"><mo id="S3.E4.m1.6.6.2.7.2.1" stretchy="false" xref="S3.E4.m1.6.6.2.cmml">(</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">c</mi><mo id="S3.E4.m1.6.6.2.7.2.2" stretchy="false" xref="S3.E4.m1.6.6.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.6b"><apply id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6"><eq id="S3.E4.m1.6.6.3.cmml" xref="S3.E4.m1.6.6.3"></eq><apply id="S3.E4.m1.6.6.4.cmml" xref="S3.E4.m1.6.6.4"><times id="S3.E4.m1.6.6.4.1.cmml" xref="S3.E4.m1.6.6.4.1"></times><ci id="S3.E4.m1.6.6.4.2.cmml" xref="S3.E4.m1.6.6.4.2">𝑝</ci><vector id="S3.E4.m1.6.6.4.3.1.cmml" xref="S3.E4.m1.6.6.4.3.2"><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑥</ci><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑧</ci><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝑐</ci></vector></apply><apply id="S3.E4.m1.6.6.2.cmml" xref="S3.E4.m1.6.6.2"><times id="S3.E4.m1.6.6.2.3.cmml" xref="S3.E4.m1.6.6.2.3"></times><ci id="S3.E4.m1.6.6.2.4.cmml" xref="S3.E4.m1.6.6.2.4">𝑝</ci><apply id="S3.E4.m1.5.5.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.2">𝑥</ci><ci id="S3.E4.m1.5.5.1.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.3">𝑧</ci></apply><ci id="S3.E4.m1.6.6.2.5.cmml" xref="S3.E4.m1.6.6.2.5">𝑝</ci><apply id="S3.E4.m1.6.6.2.2.1.1.cmml" xref="S3.E4.m1.6.6.2.2.1"><csymbol cd="latexml" id="S3.E4.m1.6.6.2.2.1.1.1.cmml" xref="S3.E4.m1.6.6.2.2.1.1.1">conditional</csymbol><ci id="S3.E4.m1.6.6.2.2.1.1.2.cmml" xref="S3.E4.m1.6.6.2.2.1.1.2">𝑧</ci><ci id="S3.E4.m1.6.6.2.2.1.1.3.cmml" xref="S3.E4.m1.6.6.2.2.1.1.3">𝑐</ci></apply><ci id="S3.E4.m1.6.6.2.6.cmml" xref="S3.E4.m1.6.6.2.6">𝑝</ci><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.6c">p(x,z,c)=p(x|z)p(z|c)p(c)</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.6d">italic_p ( italic_x , italic_z , italic_c ) = italic_p ( italic_x | italic_z ) italic_p ( italic_z | italic_c ) italic_p ( italic_c )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.p2.5">where <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.2.m1.1"><semantics id="S3.SS2.SSS2.p2.2.m1.1a"><mi id="S3.SS2.SSS2.p2.2.m1.1.1" xref="S3.SS2.SSS2.p2.2.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.2.m1.1b"><ci id="S3.SS2.SSS2.p2.2.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.2.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.2.m1.1d">italic_x</annotation></semantics></math> represents the observed sample, <math alttext="z" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.3.m2.1"><semantics id="S3.SS2.SSS2.p2.3.m2.1a"><mi id="S3.SS2.SSS2.p2.3.m2.1.1" xref="S3.SS2.SSS2.p2.3.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.3.m2.1b"><ci id="S3.SS2.SSS2.p2.3.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.3.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.3.m2.1d">italic_z</annotation></semantics></math> is the embedding of the user-item pair <math alttext="(u,i)" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.4.m3.2"><semantics id="S3.SS2.SSS2.p2.4.m3.2a"><mrow id="S3.SS2.SSS2.p2.4.m3.2.3.2" xref="S3.SS2.SSS2.p2.4.m3.2.3.1.cmml"><mo id="S3.SS2.SSS2.p2.4.m3.2.3.2.1" stretchy="false" xref="S3.SS2.SSS2.p2.4.m3.2.3.1.cmml">(</mo><mi id="S3.SS2.SSS2.p2.4.m3.1.1" xref="S3.SS2.SSS2.p2.4.m3.1.1.cmml">u</mi><mo id="S3.SS2.SSS2.p2.4.m3.2.3.2.2" xref="S3.SS2.SSS2.p2.4.m3.2.3.1.cmml">,</mo><mi id="S3.SS2.SSS2.p2.4.m3.2.2" xref="S3.SS2.SSS2.p2.4.m3.2.2.cmml">i</mi><mo id="S3.SS2.SSS2.p2.4.m3.2.3.2.3" stretchy="false" xref="S3.SS2.SSS2.p2.4.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.4.m3.2b"><interval closure="open" id="S3.SS2.SSS2.p2.4.m3.2.3.1.cmml" xref="S3.SS2.SSS2.p2.4.m3.2.3.2"><ci id="S3.SS2.SSS2.p2.4.m3.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m3.1.1">𝑢</ci><ci id="S3.SS2.SSS2.p2.4.m3.2.2.cmml" xref="S3.SS2.SSS2.p2.4.m3.2.2">𝑖</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.4.m3.2c">(u,i)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.4.m3.2d">( italic_u , italic_i )</annotation></semantics></math>, and <math alttext="c" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.5.m4.1"><semantics id="S3.SS2.SSS2.p2.5.m4.1a"><mi id="S3.SS2.SSS2.p2.5.m4.1.1" xref="S3.SS2.SSS2.p2.5.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.5.m4.1b"><ci id="S3.SS2.SSS2.p2.5.m4.1.1.cmml" xref="S3.SS2.SSS2.p2.5.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.5.m4.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.5.m4.1d">italic_c</annotation></semantics></math> is the cluster assignment. The probabilities are defined as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx1">
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p(c)" class="ltx_Math" display="inline" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.2" xref="S3.E5.m1.1.2.cmml"><mi id="S3.E5.m1.1.2.2" xref="S3.E5.m1.1.2.2.cmml">p</mi><mo id="S3.E5.m1.1.2.1" xref="S3.E5.m1.1.2.1.cmml">⁢</mo><mrow id="S3.E5.m1.1.2.3.2" xref="S3.E5.m1.1.2.cmml"><mo id="S3.E5.m1.1.2.3.2.1" stretchy="false" xref="S3.E5.m1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">c</mi><mo id="S3.E5.m1.1.2.3.2.2" stretchy="false" xref="S3.E5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.2.cmml" xref="S3.E5.m1.1.2"><times id="S3.E5.m1.1.2.1.cmml" xref="S3.E5.m1.1.2.1"></times><ci id="S3.E5.m1.1.2.2.cmml" xref="S3.E5.m1.1.2.2">𝑝</ci><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle p(c)</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">italic_p ( italic_c )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{Cat}(c|\pi)" class="ltx_Math" display="inline" id="S3.E5.m2.1"><semantics id="S3.E5.m2.1a"><mrow id="S3.E5.m2.1.1" xref="S3.E5.m2.1.1.cmml"><mi id="S3.E5.m2.1.1.3" xref="S3.E5.m2.1.1.3.cmml"></mi><mo id="S3.E5.m2.1.1.2" xref="S3.E5.m2.1.1.2.cmml">=</mo><mrow id="S3.E5.m2.1.1.1" xref="S3.E5.m2.1.1.1.cmml"><mtext id="S3.E5.m2.1.1.1.3" xref="S3.E5.m2.1.1.1.3a.cmml">Cat</mtext><mo id="S3.E5.m2.1.1.1.2" xref="S3.E5.m2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m2.1.1.1.1.1" xref="S3.E5.m2.1.1.1.1.1.1.cmml"><mo id="S3.E5.m2.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m2.1.1.1.1.1.1" xref="S3.E5.m2.1.1.1.1.1.1.cmml"><mi id="S3.E5.m2.1.1.1.1.1.1.2" xref="S3.E5.m2.1.1.1.1.1.1.2.cmml">c</mi><mo fence="false" id="S3.E5.m2.1.1.1.1.1.1.1" xref="S3.E5.m2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E5.m2.1.1.1.1.1.1.3" xref="S3.E5.m2.1.1.1.1.1.1.3.cmml">π</mi></mrow><mo id="S3.E5.m2.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m2.1b"><apply id="S3.E5.m2.1.1.cmml" xref="S3.E5.m2.1.1"><eq id="S3.E5.m2.1.1.2.cmml" xref="S3.E5.m2.1.1.2"></eq><csymbol cd="latexml" id="S3.E5.m2.1.1.3.cmml" xref="S3.E5.m2.1.1.3">absent</csymbol><apply id="S3.E5.m2.1.1.1.cmml" xref="S3.E5.m2.1.1.1"><times id="S3.E5.m2.1.1.1.2.cmml" xref="S3.E5.m2.1.1.1.2"></times><ci id="S3.E5.m2.1.1.1.3a.cmml" xref="S3.E5.m2.1.1.1.3"><mtext id="S3.E5.m2.1.1.1.3.cmml" xref="S3.E5.m2.1.1.1.3">Cat</mtext></ci><apply id="S3.E5.m2.1.1.1.1.1.1.cmml" xref="S3.E5.m2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E5.m2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m2.1.1.1.1.1.1.2">𝑐</ci><ci id="S3.E5.m2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m2.1.1.1.1.1.1.3">𝜋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m2.1c">\displaystyle=\text{Cat}(c|\pi)</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m2.1d">= Cat ( italic_c | italic_π )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p(z|c)" class="ltx_Math" display="inline" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mi id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml">p</mi><mo id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">z</mi><mo fence="false" id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S3.E6.m1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><times id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"></times><ci id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">𝑝</ci><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle p(z|c)</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">italic_p ( italic_z | italic_c )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{N}(z|\bar{\mu}_{c},(\bar{\sigma}_{c})^{2}I)" class="ltx_Math" display="inline" id="S3.E6.m2.1"><semantics id="S3.E6.m2.1a"><mrow id="S3.E6.m2.1.1" xref="S3.E6.m2.1.1.cmml"><mi id="S3.E6.m2.1.1.3" xref="S3.E6.m2.1.1.3.cmml"></mi><mo id="S3.E6.m2.1.1.2" xref="S3.E6.m2.1.1.2.cmml">=</mo><mrow id="S3.E6.m2.1.1.1" xref="S3.E6.m2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m2.1.1.1.3" xref="S3.E6.m2.1.1.1.3.cmml">𝒩</mi><mo id="S3.E6.m2.1.1.1.2" xref="S3.E6.m2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m2.1.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.cmml"><mo id="S3.E6.m2.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m2.1.1.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.cmml"><mi id="S3.E6.m2.1.1.1.1.1.1.4" xref="S3.E6.m2.1.1.1.1.1.1.4.cmml">z</mi><mo fence="false" id="S3.E6.m2.1.1.1.1.1.1.3" xref="S3.E6.m2.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E6.m2.1.1.1.1.1.1.2.2" xref="S3.E6.m2.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E6.m2.1.1.1.1.1.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E6.m2.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">μ</mi><mo id="S3.E6.m2.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.2.1.cmml">¯</mo></mover><mi id="S3.E6.m2.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.E6.m2.1.1.1.1.1.1.2.2.3" xref="S3.E6.m2.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.E6.m2.1.1.1.1.1.1.2.2.2" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.cmml"><msup id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.cmml"><mrow id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml"><mo id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.2" stretchy="false" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml"><mover accent="true" id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.2" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.2.cmml"><mi id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.2.2" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.2.2.cmml">σ</mi><mo id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.2.1" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.2.1.cmml">¯</mo></mover><mi id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.3" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.3" stretchy="false" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.3" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.3.cmml">2</mn></msup><mo id="S3.E6.m2.1.1.1.1.1.1.2.2.2.2" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.2.cmml">⁢</mo><mi id="S3.E6.m2.1.1.1.1.1.1.2.2.2.3" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.3.cmml">I</mi></mrow></mrow></mrow><mo id="S3.E6.m2.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m2.1b"><apply id="S3.E6.m2.1.1.cmml" xref="S3.E6.m2.1.1"><eq id="S3.E6.m2.1.1.2.cmml" xref="S3.E6.m2.1.1.2"></eq><csymbol cd="latexml" id="S3.E6.m2.1.1.3.cmml" xref="S3.E6.m2.1.1.3">absent</csymbol><apply id="S3.E6.m2.1.1.1.cmml" xref="S3.E6.m2.1.1.1"><times id="S3.E6.m2.1.1.1.2.cmml" xref="S3.E6.m2.1.1.1.2"></times><ci id="S3.E6.m2.1.1.1.3.cmml" xref="S3.E6.m2.1.1.1.3">𝒩</ci><apply id="S3.E6.m2.1.1.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m2.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.3">conditional</csymbol><ci id="S3.E6.m2.1.1.1.1.1.1.4.cmml" xref="S3.E6.m2.1.1.1.1.1.1.4">𝑧</ci><list id="S3.E6.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.2.2"><apply id="S3.E6.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E6.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.2.1">¯</ci><ci id="S3.E6.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.2.2">𝜇</ci></apply><ci id="S3.E6.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S3.E6.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2"><times id="S3.E6.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.2"></times><apply id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1">superscript</csymbol><apply id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1">subscript</csymbol><apply id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.2"><ci id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.2.1">¯</ci><ci id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.2.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.2.2">𝜎</ci></apply><ci id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.3">𝑐</ci></apply><cn id="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.3.cmml" type="integer" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.1.3">2</cn></apply><ci id="S3.E6.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.2.2.2.3">𝐼</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m2.1c">\displaystyle=\mathcal{N}(z|\bar{\mu}_{c},(\bar{\sigma}_{c})^{2}I)</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m2.1d">= caligraphic_N ( italic_z | over¯ start_ARG italic_μ end_ARG start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , ( over¯ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_I )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p(x|z)" class="ltx_Math" display="inline" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mi id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml">p</mi><mo id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.3.cmml">z</mi></mrow><mo id="S3.E7.m1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><times id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2"></times><ci id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3">𝑝</ci><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E7.m1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle p(x|z)</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">italic_p ( italic_x | italic_z )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=Ber(x|\mu_{x})" class="ltx_Math" display="inline" id="S3.E7.m2.1"><semantics id="S3.E7.m2.1a"><mrow id="S3.E7.m2.1.1" xref="S3.E7.m2.1.1.cmml"><mi id="S3.E7.m2.1.1.3" xref="S3.E7.m2.1.1.3.cmml"></mi><mo id="S3.E7.m2.1.1.2" xref="S3.E7.m2.1.1.2.cmml">=</mo><mrow id="S3.E7.m2.1.1.1" xref="S3.E7.m2.1.1.1.cmml"><mi id="S3.E7.m2.1.1.1.3" xref="S3.E7.m2.1.1.1.3.cmml">B</mi><mo id="S3.E7.m2.1.1.1.2" xref="S3.E7.m2.1.1.1.2.cmml">⁢</mo><mi id="S3.E7.m2.1.1.1.4" xref="S3.E7.m2.1.1.1.4.cmml">e</mi><mo id="S3.E7.m2.1.1.1.2a" xref="S3.E7.m2.1.1.1.2.cmml">⁢</mo><mi id="S3.E7.m2.1.1.1.5" xref="S3.E7.m2.1.1.1.5.cmml">r</mi><mo id="S3.E7.m2.1.1.1.2b" xref="S3.E7.m2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m2.1.1.1.1.1" xref="S3.E7.m2.1.1.1.1.1.1.cmml"><mo id="S3.E7.m2.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m2.1.1.1.1.1.1" xref="S3.E7.m2.1.1.1.1.1.1.cmml"><mi id="S3.E7.m2.1.1.1.1.1.1.2" xref="S3.E7.m2.1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.E7.m2.1.1.1.1.1.1.1" xref="S3.E7.m2.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E7.m2.1.1.1.1.1.1.3" xref="S3.E7.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m2.1.1.1.1.1.1.3.2" xref="S3.E7.m2.1.1.1.1.1.1.3.2.cmml">μ</mi><mi id="S3.E7.m2.1.1.1.1.1.1.3.3" xref="S3.E7.m2.1.1.1.1.1.1.3.3.cmml">x</mi></msub></mrow><mo id="S3.E7.m2.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m2.1b"><apply id="S3.E7.m2.1.1.cmml" xref="S3.E7.m2.1.1"><eq id="S3.E7.m2.1.1.2.cmml" xref="S3.E7.m2.1.1.2"></eq><csymbol cd="latexml" id="S3.E7.m2.1.1.3.cmml" xref="S3.E7.m2.1.1.3">absent</csymbol><apply id="S3.E7.m2.1.1.1.cmml" xref="S3.E7.m2.1.1.1"><times id="S3.E7.m2.1.1.1.2.cmml" xref="S3.E7.m2.1.1.1.2"></times><ci id="S3.E7.m2.1.1.1.3.cmml" xref="S3.E7.m2.1.1.1.3">𝐵</ci><ci id="S3.E7.m2.1.1.1.4.cmml" xref="S3.E7.m2.1.1.1.4">𝑒</ci><ci id="S3.E7.m2.1.1.1.5.cmml" xref="S3.E7.m2.1.1.1.5">𝑟</ci><apply id="S3.E7.m2.1.1.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E7.m2.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.E7.m2.1.1.1.1.1.1.3.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3.2">𝜇</ci><ci id="S3.E7.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m2.1c">\displaystyle=Ber(x|\mu_{x})</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m2.1d">= italic_B italic_e italic_r ( italic_x | italic_μ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.p2.9">where <math alttext="\text{Cat}(\pi)" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.6.m1.1"><semantics id="S3.SS2.SSS2.p2.6.m1.1a"><mrow id="S3.SS2.SSS2.p2.6.m1.1.2" xref="S3.SS2.SSS2.p2.6.m1.1.2.cmml"><mtext id="S3.SS2.SSS2.p2.6.m1.1.2.2" xref="S3.SS2.SSS2.p2.6.m1.1.2.2a.cmml">Cat</mtext><mo id="S3.SS2.SSS2.p2.6.m1.1.2.1" xref="S3.SS2.SSS2.p2.6.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p2.6.m1.1.2.3.2" xref="S3.SS2.SSS2.p2.6.m1.1.2.cmml"><mo id="S3.SS2.SSS2.p2.6.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS2.p2.6.m1.1.2.cmml">(</mo><mi id="S3.SS2.SSS2.p2.6.m1.1.1" xref="S3.SS2.SSS2.p2.6.m1.1.1.cmml">π</mi><mo id="S3.SS2.SSS2.p2.6.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS2.p2.6.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.6.m1.1b"><apply id="S3.SS2.SSS2.p2.6.m1.1.2.cmml" xref="S3.SS2.SSS2.p2.6.m1.1.2"><times id="S3.SS2.SSS2.p2.6.m1.1.2.1.cmml" xref="S3.SS2.SSS2.p2.6.m1.1.2.1"></times><ci id="S3.SS2.SSS2.p2.6.m1.1.2.2a.cmml" xref="S3.SS2.SSS2.p2.6.m1.1.2.2"><mtext id="S3.SS2.SSS2.p2.6.m1.1.2.2.cmml" xref="S3.SS2.SSS2.p2.6.m1.1.2.2">Cat</mtext></ci><ci id="S3.SS2.SSS2.p2.6.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.6.m1.1.1">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.6.m1.1c">\text{Cat}(\pi)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.6.m1.1d">Cat ( italic_π )</annotation></semantics></math> is a categorical distribution parameterized by <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.7.m2.1"><semantics id="S3.SS2.SSS2.p2.7.m2.1a"><mi id="S3.SS2.SSS2.p2.7.m2.1.1" xref="S3.SS2.SSS2.p2.7.m2.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.7.m2.1b"><ci id="S3.SS2.SSS2.p2.7.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.7.m2.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.7.m2.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.7.m2.1d">italic_π</annotation></semantics></math>, and <math alttext="\text{Ber}(x|\mu_{x})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.8.m3.1"><semantics id="S3.SS2.SSS2.p2.8.m3.1a"><mrow id="S3.SS2.SSS2.p2.8.m3.1.1" xref="S3.SS2.SSS2.p2.8.m3.1.1.cmml"><mtext id="S3.SS2.SSS2.p2.8.m3.1.1.3" xref="S3.SS2.SSS2.p2.8.m3.1.1.3a.cmml">Ber</mtext><mo id="S3.SS2.SSS2.p2.8.m3.1.1.2" xref="S3.SS2.SSS2.p2.8.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p2.8.m3.1.1.1.1" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.2" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.1" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3.2.cmml">μ</mi><mi id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3.3.cmml">x</mi></msub></mrow><mo id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.8.m3.1b"><apply id="S3.SS2.SSS2.p2.8.m3.1.1.cmml" xref="S3.SS2.SSS2.p2.8.m3.1.1"><times id="S3.SS2.SSS2.p2.8.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p2.8.m3.1.1.2"></times><ci id="S3.SS2.SSS2.p2.8.m3.1.1.3a.cmml" xref="S3.SS2.SSS2.p2.8.m3.1.1.3"><mtext id="S3.SS2.SSS2.p2.8.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p2.8.m3.1.1.3">Ber</mtext></ci><apply id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3.2">𝜇</ci><ci id="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p2.8.m3.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.8.m3.1c">\text{Ber}(x|\mu_{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.8.m3.1d">Ber ( italic_x | italic_μ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT )</annotation></semantics></math> denotes a multivariate Bernoulli
distribution for the output of decoder <math alttext="D" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.9.m4.1"><semantics id="S3.SS2.SSS2.p2.9.m4.1a"><mi id="S3.SS2.SSS2.p2.9.m4.1.1" xref="S3.SS2.SSS2.p2.9.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.9.m4.1b"><ci id="S3.SS2.SSS2.p2.9.m4.1.1.cmml" xref="S3.SS2.SSS2.p2.9.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.9.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.9.m4.1d">italic_D</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p3">
<p class="ltx_p" id="S3.SS2.SSS2.p3.1">By optimizing the Evidence Lower Bound (ELBO) (detailed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#A1" title="Appendix A ELBO in GaVaMoE ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">A</span></a>), we train this VAE-GMM model to simultaneously learn latent representations and cluster assignments. Each resulting cluster corresponds to a gate in our Multi-gating Mechanism, providing GaVaMoE with a routing strategy.
By directing user-item pairs to cluster-specific gates, we ensure that the explanation generation process is tailored to the specific preference patterns identified within each cluster.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Multi-gating Mixture of Experts</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Building upon the VAE-GMM component, we introduce a novel multi-gating mixture of experts architecture to generate explanations. This architecture combines a dynamic routing mechanism with fine-grained experts to enhance personalization and efficiency. Our approach extends the traditional Mixture of Experts (MoE) concept by introducing a multi-gating mechanism informed by user clustering and a fine-grained expert strategy.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1. </span>Multi-gating Mechanism for Expert Selection</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.2">Our multi-gating mechanism leverages the clustering information obtained from the VAE-GMM process (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S3.SS2" title="3.2. VAE-GMM for Rating Reconstruction ‣ 3. Method ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">3.2</span></a>) to route user-item pairs to the most appropriate experts. For a given input sample represented by its latent embedding <math alttext="\mathbf{z}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mi id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><ci id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">bold_z</annotation></semantics></math>, we compute the probability of it belonging to each cluster <math alttext="c" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.1"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mi id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.1d">italic_c</annotation></semantics></math> using the following equation:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E8">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E8X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\gamma_{c}=\frac{\pi_{c}\cdot\mathcal{N}(\mathbf{z}|\bar{\mu}_{c}%
,(\bar{\sigma}_{c})^{2})}{\sum_{c^{\prime}=1}^{K}\pi_{c^{\prime}}\cdot\mathcal%
{N}(\mathbf{z}|\bar{\mu}_{c^{\prime}},(\bar{\sigma}_{c^{\prime}})^{2})}" class="ltx_Math" display="inline" id="S3.E8X.2.1.1.m1.2"><semantics id="S3.E8X.2.1.1.m1.2a"><mrow id="S3.E8X.2.1.1.m1.2.3" xref="S3.E8X.2.1.1.m1.2.3.cmml"><msub id="S3.E8X.2.1.1.m1.2.3.2" xref="S3.E8X.2.1.1.m1.2.3.2.cmml"><mi id="S3.E8X.2.1.1.m1.2.3.2.2" xref="S3.E8X.2.1.1.m1.2.3.2.2.cmml">γ</mi><mi id="S3.E8X.2.1.1.m1.2.3.2.3" xref="S3.E8X.2.1.1.m1.2.3.2.3.cmml">c</mi></msub><mo id="S3.E8X.2.1.1.m1.2.3.1" xref="S3.E8X.2.1.1.m1.2.3.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E8X.2.1.1.m1.2.2" xref="S3.E8X.2.1.1.m1.2.2.cmml"><mfrac id="S3.E8X.2.1.1.m1.2.2a" xref="S3.E8X.2.1.1.m1.2.2.cmml"><mrow id="S3.E8X.2.1.1.m1.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.cmml"><mrow id="S3.E8X.2.1.1.m1.1.1.1.3" xref="S3.E8X.2.1.1.m1.1.1.1.3.cmml"><msub id="S3.E8X.2.1.1.m1.1.1.1.3.2" xref="S3.E8X.2.1.1.m1.1.1.1.3.2.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.3.2.2" xref="S3.E8X.2.1.1.m1.1.1.1.3.2.2.cmml">π</mi><mi id="S3.E8X.2.1.1.m1.1.1.1.3.2.3" xref="S3.E8X.2.1.1.m1.1.1.1.3.2.3.cmml">c</mi></msub><mo id="S3.E8X.2.1.1.m1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E8X.2.1.1.m1.1.1.1.3.1.cmml">⋅</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8X.2.1.1.m1.1.1.1.3.3" xref="S3.E8X.2.1.1.m1.1.1.1.3.3.cmml">𝒩</mi></mrow><mo id="S3.E8X.2.1.1.m1.1.1.1.2" xref="S3.E8X.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8X.2.1.1.m1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.4" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.4.cmml">𝐳</mi><mo fence="false" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">μ</mi><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">¯</mo></mover><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.cmml"><mrow id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mover accent="true" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml">σ</mi><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml">¯</mo></mover><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml">c</mi></msub><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow><mn id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.3.cmml">2</mn></msup></mrow></mrow><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E8X.2.1.1.m1.2.2.2" xref="S3.E8X.2.1.1.m1.2.2.2.cmml"><msubsup id="S3.E8X.2.1.1.m1.2.2.2.2" xref="S3.E8X.2.1.1.m1.2.2.2.2.cmml"><mo id="S3.E8X.2.1.1.m1.2.2.2.2.2.2" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E8X.2.1.1.m1.2.2.2.2.2.3" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3.cmml"><msup id="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2.cmml"><mi id="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2.2" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2.2.cmml">c</mi><mo id="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2.3" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2.3.cmml">′</mo></msup><mo id="S3.E8X.2.1.1.m1.2.2.2.2.2.3.1" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E8X.2.1.1.m1.2.2.2.2.2.3.3" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8X.2.1.1.m1.2.2.2.2.3" xref="S3.E8X.2.1.1.m1.2.2.2.2.3.cmml">K</mi></msubsup><mrow id="S3.E8X.2.1.1.m1.2.2.2.1" xref="S3.E8X.2.1.1.m1.2.2.2.1.cmml"><mrow id="S3.E8X.2.1.1.m1.2.2.2.1.3" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.cmml"><msub id="S3.E8X.2.1.1.m1.2.2.2.1.3.2" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.2.cmml"><mi id="S3.E8X.2.1.1.m1.2.2.2.1.3.2.2" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.2.2.cmml">π</mi><msup id="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3.cmml"><mi id="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3.2" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3.2.cmml">c</mi><mo id="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3.3" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3.3.cmml">′</mo></msup></msub><mo id="S3.E8X.2.1.1.m1.2.2.2.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.1.cmml">⋅</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8X.2.1.1.m1.2.2.2.1.3.3" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.3.cmml">𝒩</mi></mrow><mo id="S3.E8X.2.1.1.m1.2.2.2.1.2" xref="S3.E8X.2.1.1.m1.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E8X.2.1.1.m1.2.2.2.1.1.1" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.cmml"><mo id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.2" stretchy="false" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.cmml"><mi id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.4" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.4.cmml">𝐳</mi><mo fence="false" id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.3" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.3.cmml">|</mo><mrow id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.3.cmml"><msub id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.2" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.2.2.cmml">μ</mi><mo id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.2.1" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.2.1.cmml">¯</mo></mover><msup id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3.2" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3.3" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></msub><mo id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.3" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.3.cmml">,</mo><msup id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.cmml"><mrow id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.cmml"><mo id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.cmml"><mover accent="true" id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.2" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.2.cmml"><mi id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.2.2" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.2.2.cmml">σ</mi><mo id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.2.1" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.2.1.cmml">¯</mo></mover><msup id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3.cmml"><mi id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3.2" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3.2.cmml">c</mi><mo id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3.3" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3.3.cmml">′</mo></msup></msub><mo id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow><mn id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.3" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.3.cmml">2</mn></msup></mrow></mrow><mo id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.3" stretchy="false" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E8X.2.1.1.m1.2b"><apply id="S3.E8X.2.1.1.m1.2.3.cmml" xref="S3.E8X.2.1.1.m1.2.3"><eq id="S3.E8X.2.1.1.m1.2.3.1.cmml" xref="S3.E8X.2.1.1.m1.2.3.1"></eq><apply id="S3.E8X.2.1.1.m1.2.3.2.cmml" xref="S3.E8X.2.1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.3.2.1.cmml" xref="S3.E8X.2.1.1.m1.2.3.2">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.2.3.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.3.2.2">𝛾</ci><ci id="S3.E8X.2.1.1.m1.2.3.2.3.cmml" xref="S3.E8X.2.1.1.m1.2.3.2.3">𝑐</ci></apply><apply id="S3.E8X.2.1.1.m1.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2"><divide id="S3.E8X.2.1.1.m1.2.2.3.cmml" xref="S3.E8X.2.1.1.m1.2.2"></divide><apply id="S3.E8X.2.1.1.m1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1"><times id="S3.E8X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.2"></times><apply id="S3.E8X.2.1.1.m1.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.3"><ci id="S3.E8X.2.1.1.m1.1.1.1.3.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.3.1">⋅</ci><apply id="S3.E8X.2.1.1.m1.1.1.1.3.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.3.2.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.1.1.1.3.2.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.3.2.2">𝜋</ci><ci id="S3.E8X.2.1.1.m1.1.1.1.3.2.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.3.2.3">𝑐</ci></apply><ci id="S3.E8X.2.1.1.m1.1.1.1.3.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.3.3">𝒩</ci></apply><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.3">conditional</csymbol><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.4.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.4">𝐳</ci><list id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2"><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1">¯</ci><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2">𝜇</ci></apply><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1">subscript</csymbol><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2"><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2.1">¯</ci><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2.2">𝜎</ci></apply><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3">𝑐</ci></apply><cn id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.2.2.2.3">2</cn></apply></list></apply></apply><apply id="S3.E8X.2.1.1.m1.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2"><apply id="S3.E8X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.2.2.2.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2">superscript</csymbol><apply id="S3.E8X.2.1.1.m1.2.2.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.2.2.2.2.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2">subscript</csymbol><sum id="S3.E8X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.2"></sum><apply id="S3.E8X.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3"><eq id="S3.E8X.2.1.1.m1.2.2.2.2.2.3.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3.1"></eq><apply id="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2">superscript</csymbol><ci id="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2.2">𝑐</ci><ci id="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3.2.3">′</ci></apply><cn id="S3.E8X.2.1.1.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E8X.2.1.1.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E8X.2.1.1.m1.2.2.2.2.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.3">𝐾</ci></apply><apply id="S3.E8X.2.1.1.m1.2.2.2.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1"><times id="S3.E8X.2.1.1.m1.2.2.2.1.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.2"></times><apply id="S3.E8X.2.1.1.m1.2.2.2.1.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.3"><ci id="S3.E8X.2.1.1.m1.2.2.2.1.3.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.1">⋅</ci><apply id="S3.E8X.2.1.1.m1.2.2.2.1.3.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.2.2.1.3.2.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.2">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.2.2.2.1.3.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.2.2">𝜋</ci><apply id="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3">superscript</csymbol><ci id="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3.2">𝑐</ci><ci id="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.2.3.3">′</ci></apply></apply><ci id="S3.E8X.2.1.1.m1.2.2.2.1.3.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.3.3">𝒩</ci></apply><apply id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.3">conditional</csymbol><ci id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.4.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.4">𝐳</ci><list id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2"><apply id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.2"><ci id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.2.1">¯</ci><ci id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.2.2">𝜇</ci></apply><apply id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.3.3">′</ci></apply></apply><apply id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1">subscript</csymbol><apply id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.2"><ci id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.2.1">¯</ci><ci id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.2.2">𝜎</ci></apply><apply id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3">superscript</csymbol><ci id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3.2">𝑐</ci><ci id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.1.1.1.3.3">′</ci></apply></apply><cn id="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E8X.2.1.1.m1.2.2.2.1.1.1.1.2.2.2.3">2</cn></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8X.2.1.1.m1.2c">\displaystyle\gamma_{c}=\frac{\pi_{c}\cdot\mathcal{N}(\mathbf{z}|\bar{\mu}_{c}%
,(\bar{\sigma}_{c})^{2})}{\sum_{c^{\prime}=1}^{K}\pi_{c^{\prime}}\cdot\mathcal%
{N}(\mathbf{z}|\bar{\mu}_{c^{\prime}},(\bar{\sigma}_{c^{\prime}})^{2})}</annotation><annotation encoding="application/x-llamapun" id="S3.E8X.2.1.1.m1.2d">italic_γ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = divide start_ARG italic_π start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ⋅ caligraphic_N ( bold_z | over¯ start_ARG italic_μ end_ARG start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , ( over¯ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ⋅ caligraphic_N ( bold_z | over¯ start_ARG italic_μ end_ARG start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , ( over¯ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p2">
<p class="ltx_p" id="S3.SS3.SSS1.p2.1">This probability calculation allows us to identify the most likely cluster for each input sample. Our design incorporates a one-to-one correspondence between clusters and gates, where each cluster identified by the VAE-GMM is associated with a specific gate in the multi-gating mechanism. The number of gates in our multi-gating mechanism is therefore equal to the number of clusters K identified in the VAE-GMM stage.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p3">
<p class="ltx_p" id="S3.SS3.SSS1.p3.6">To determine which gate should process the input, we select the cluster with the highest probability:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bar{c}=argmax_{c}\gamma_{c}" class="ltx_Math" display="block" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mover accent="true" id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.2.2" xref="S3.E9.m1.1.1.2.2.cmml">c</mi><mo id="S3.E9.m1.1.1.2.1" xref="S3.E9.m1.1.1.2.1.cmml">¯</mo></mover><mo id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.3.2" xref="S3.E9.m1.1.1.3.2.cmml">a</mi><mo id="S3.E9.m1.1.1.3.1" xref="S3.E9.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E9.m1.1.1.3.3" xref="S3.E9.m1.1.1.3.3.cmml">r</mi><mo id="S3.E9.m1.1.1.3.1a" xref="S3.E9.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E9.m1.1.1.3.4" xref="S3.E9.m1.1.1.3.4.cmml">g</mi><mo id="S3.E9.m1.1.1.3.1b" xref="S3.E9.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E9.m1.1.1.3.5" xref="S3.E9.m1.1.1.3.5.cmml">m</mi><mo id="S3.E9.m1.1.1.3.1c" xref="S3.E9.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E9.m1.1.1.3.6" xref="S3.E9.m1.1.1.3.6.cmml">a</mi><mo id="S3.E9.m1.1.1.3.1d" xref="S3.E9.m1.1.1.3.1.cmml">⁢</mo><msub id="S3.E9.m1.1.1.3.7" xref="S3.E9.m1.1.1.3.7.cmml"><mi id="S3.E9.m1.1.1.3.7.2" xref="S3.E9.m1.1.1.3.7.2.cmml">x</mi><mi id="S3.E9.m1.1.1.3.7.3" xref="S3.E9.m1.1.1.3.7.3.cmml">c</mi></msub><mo id="S3.E9.m1.1.1.3.1e" xref="S3.E9.m1.1.1.3.1.cmml">⁢</mo><msub id="S3.E9.m1.1.1.3.8" xref="S3.E9.m1.1.1.3.8.cmml"><mi id="S3.E9.m1.1.1.3.8.2" xref="S3.E9.m1.1.1.3.8.2.cmml">γ</mi><mi id="S3.E9.m1.1.1.3.8.3" xref="S3.E9.m1.1.1.3.8.3.cmml">c</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><eq id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"></eq><apply id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2"><ci id="S3.E9.m1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.2.1">¯</ci><ci id="S3.E9.m1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.2.2">𝑐</ci></apply><apply id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3"><times id="S3.E9.m1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.3.1"></times><ci id="S3.E9.m1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.3.2">𝑎</ci><ci id="S3.E9.m1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.3.3">𝑟</ci><ci id="S3.E9.m1.1.1.3.4.cmml" xref="S3.E9.m1.1.1.3.4">𝑔</ci><ci id="S3.E9.m1.1.1.3.5.cmml" xref="S3.E9.m1.1.1.3.5">𝑚</ci><ci id="S3.E9.m1.1.1.3.6.cmml" xref="S3.E9.m1.1.1.3.6">𝑎</ci><apply id="S3.E9.m1.1.1.3.7.cmml" xref="S3.E9.m1.1.1.3.7"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.3.7.1.cmml" xref="S3.E9.m1.1.1.3.7">subscript</csymbol><ci id="S3.E9.m1.1.1.3.7.2.cmml" xref="S3.E9.m1.1.1.3.7.2">𝑥</ci><ci id="S3.E9.m1.1.1.3.7.3.cmml" xref="S3.E9.m1.1.1.3.7.3">𝑐</ci></apply><apply id="S3.E9.m1.1.1.3.8.cmml" xref="S3.E9.m1.1.1.3.8"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.3.8.1.cmml" xref="S3.E9.m1.1.1.3.8">subscript</csymbol><ci id="S3.E9.m1.1.1.3.8.2.cmml" xref="S3.E9.m1.1.1.3.8.2">𝛾</ci><ci id="S3.E9.m1.1.1.3.8.3.cmml" xref="S3.E9.m1.1.1.3.8.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\bar{c}=argmax_{c}\gamma_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">over¯ start_ARG italic_c end_ARG = italic_a italic_r italic_g italic_m italic_a italic_x start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT italic_γ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS1.p3.5">where <math alttext="\bar{c}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.1.m1.1"><semantics id="S3.SS3.SSS1.p3.1.m1.1a"><mover accent="true" id="S3.SS3.SSS1.p3.1.m1.1.1" xref="S3.SS3.SSS1.p3.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p3.1.m1.1.1.2" xref="S3.SS3.SSS1.p3.1.m1.1.1.2.cmml">c</mi><mo id="S3.SS3.SSS1.p3.1.m1.1.1.1" xref="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.1.m1.1b"><apply id="S3.SS3.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1"><ci id="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.1">¯</ci><ci id="S3.SS3.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.2">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.1.m1.1c">\bar{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.1.m1.1d">over¯ start_ARG italic_c end_ARG</annotation></semantics></math> represents the index of the selected gate. Given <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.2.m2.1"><semantics id="S3.SS3.SSS1.p3.2.m2.1a"><mi id="S3.SS3.SSS1.p3.2.m2.1.1" xref="S3.SS3.SSS1.p3.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.2.m2.1b"><ci id="S3.SS3.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.2.m2.1d">italic_K</annotation></semantics></math> clusters and a corresponding set of <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.3.m3.1"><semantics id="S3.SS3.SSS1.p3.3.m3.1a"><mi id="S3.SS3.SSS1.p3.3.m3.1.1" xref="S3.SS3.SSS1.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.3.m3.1b"><ci id="S3.SS3.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.3.m3.1d">italic_K</annotation></semantics></math> gates <math alttext="G={G_{1},...,G_{K}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.4.m4.3"><semantics id="S3.SS3.SSS1.p3.4.m4.3a"><mrow id="S3.SS3.SSS1.p3.4.m4.3.3" xref="S3.SS3.SSS1.p3.4.m4.3.3.cmml"><mi id="S3.SS3.SSS1.p3.4.m4.3.3.4" xref="S3.SS3.SSS1.p3.4.m4.3.3.4.cmml">G</mi><mo id="S3.SS3.SSS1.p3.4.m4.3.3.3" xref="S3.SS3.SSS1.p3.4.m4.3.3.3.cmml">=</mo><mrow id="S3.SS3.SSS1.p3.4.m4.3.3.2.2" xref="S3.SS3.SSS1.p3.4.m4.3.3.2.3.cmml"><msub id="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1" xref="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1.2" xref="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1.2.cmml">G</mi><mn id="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1.3" xref="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS1.p3.4.m4.3.3.2.2.3" xref="S3.SS3.SSS1.p3.4.m4.3.3.2.3.cmml">,</mo><mi id="S3.SS3.SSS1.p3.4.m4.1.1" mathvariant="normal" xref="S3.SS3.SSS1.p3.4.m4.1.1.cmml">…</mi><mo id="S3.SS3.SSS1.p3.4.m4.3.3.2.2.4" xref="S3.SS3.SSS1.p3.4.m4.3.3.2.3.cmml">,</mo><msub id="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2" xref="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2.cmml"><mi id="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2.2" xref="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2.2.cmml">G</mi><mi id="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2.3" xref="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2.3.cmml">K</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.4.m4.3b"><apply id="S3.SS3.SSS1.p3.4.m4.3.3.cmml" xref="S3.SS3.SSS1.p3.4.m4.3.3"><eq id="S3.SS3.SSS1.p3.4.m4.3.3.3.cmml" xref="S3.SS3.SSS1.p3.4.m4.3.3.3"></eq><ci id="S3.SS3.SSS1.p3.4.m4.3.3.4.cmml" xref="S3.SS3.SSS1.p3.4.m4.3.3.4">𝐺</ci><list id="S3.SS3.SSS1.p3.4.m4.3.3.2.3.cmml" xref="S3.SS3.SSS1.p3.4.m4.3.3.2.2"><apply id="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1.2">𝐺</ci><cn id="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p3.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS3.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1">…</ci><apply id="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2.cmml" xref="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2.2">𝐺</ci><ci id="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2.3.cmml" xref="S3.SS3.SSS1.p3.4.m4.3.3.2.2.2.3">𝐾</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.4.m4.3c">G={G_{1},...,G_{K}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.4.m4.3d">italic_G = italic_G start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_G start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, we select the specific gate <math alttext="G_{\bar{c}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.5.m5.1"><semantics id="S3.SS3.SSS1.p3.5.m5.1a"><msub id="S3.SS3.SSS1.p3.5.m5.1.1" xref="S3.SS3.SSS1.p3.5.m5.1.1.cmml"><mi id="S3.SS3.SSS1.p3.5.m5.1.1.2" xref="S3.SS3.SSS1.p3.5.m5.1.1.2.cmml">G</mi><mover accent="true" id="S3.SS3.SSS1.p3.5.m5.1.1.3" xref="S3.SS3.SSS1.p3.5.m5.1.1.3.cmml"><mi id="S3.SS3.SSS1.p3.5.m5.1.1.3.2" xref="S3.SS3.SSS1.p3.5.m5.1.1.3.2.cmml">c</mi><mo id="S3.SS3.SSS1.p3.5.m5.1.1.3.1" xref="S3.SS3.SSS1.p3.5.m5.1.1.3.1.cmml">¯</mo></mover></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.5.m5.1b"><apply id="S3.SS3.SSS1.p3.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.5.m5.1.1.1.cmml" xref="S3.SS3.SSS1.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p3.5.m5.1.1.2.cmml" xref="S3.SS3.SSS1.p3.5.m5.1.1.2">𝐺</ci><apply id="S3.SS3.SSS1.p3.5.m5.1.1.3.cmml" xref="S3.SS3.SSS1.p3.5.m5.1.1.3"><ci id="S3.SS3.SSS1.p3.5.m5.1.1.3.1.cmml" xref="S3.SS3.SSS1.p3.5.m5.1.1.3.1">¯</ci><ci id="S3.SS3.SSS1.p3.5.m5.1.1.3.2.cmml" xref="S3.SS3.SSS1.p3.5.m5.1.1.3.2">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.5.m5.1c">G_{\bar{c}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.5.m5.1d">italic_G start_POSTSUBSCRIPT over¯ start_ARG italic_c end_ARG end_POSTSUBSCRIPT</annotation></semantics></math> for processing the input.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p4">
<p class="ltx_p" id="S3.SS3.SSS1.p4.1">Multi-gating mechanism ensures that users within the same cluster are directed to the same gate, guaranteeing the preferences and styles of specific user groups.
This is particularly beneficial for handling sparse data, as the model can leverage knowledge from users within the same cluster to discover implicit preferences for those with limited interaction history.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2. </span>Fine-grained Mixture of Experts</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.4">To address issues of knowledge hybridity and knowledge redundancy <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib5" title="">dai2024deepseekmoe, </a>)</cite>, we modify the original structure by dividing the fully connected network layers into smaller, more specialized units.
Specifically, we reduce the intermediate hidden dimensions of the fully connected layers to <math alttext="\frac{1}{r}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.1.m1.1"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><mfrac id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml"><mn id="S3.SS3.SSS2.p1.1.m1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml">1</mn><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml">r</mi></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><apply id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"><divide id="S3.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"></divide><cn id="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml" type="integer" xref="S3.SS3.SSS2.p1.1.m1.1.1.2">1</cn><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">\frac{1}{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.1.m1.1d">divide start_ARG 1 end_ARG start_ARG italic_r end_ARG</annotation></semantics></math> of their original size, effectively splitting each expert Feed-Forward Network (FFN) into <math alttext="r" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.2.m2.1"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mi id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><ci id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.2.m2.1d">italic_r</annotation></semantics></math> smaller experts.
Assuming the original number of experts is <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.3.m3.1"><semantics id="S3.SS3.SSS2.p1.3.m3.1a"><mi id="S3.SS3.SSS2.p1.3.m3.1.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.3.m3.1b"><ci id="S3.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.3.m3.1d">italic_N</annotation></semantics></math>, the number of experts is now <math alttext="rN" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.4.m4.1"><semantics id="S3.SS3.SSS2.p1.4.m4.1a"><mrow id="S3.SS3.SSS2.p1.4.m4.1.1" xref="S3.SS3.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p1.4.m4.1.1.2" xref="S3.SS3.SSS2.p1.4.m4.1.1.2.cmml">r</mi><mo id="S3.SS3.SSS2.p1.4.m4.1.1.1" xref="S3.SS3.SSS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.1.3" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.4.m4.1b"><apply id="S3.SS3.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1"><times id="S3.SS3.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.1"></times><ci id="S3.SS3.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.2">𝑟</ci><ci id="S3.SS3.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.4.m4.1c">rN</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.4.m4.1d">italic_r italic_N</annotation></semantics></math> after reduction.
This fine-grained expert strategy allows the model to achieve increased specialization without additional computational cost.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p2">
<p class="ltx_p" id="S3.SS3.SSS2.p2.6">Given an input <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.1.m1.1"><semantics id="S3.SS3.SSS2.p2.1.m1.1a"><mi id="S3.SS3.SSS2.p2.1.m1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.m1.1b"><ci id="S3.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.1.m1.1d">italic_x</annotation></semantics></math>, after determining the corresponding gate <math alttext="G_{\bar{c}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.2.m2.1"><semantics id="S3.SS3.SSS2.p2.2.m2.1a"><msub id="S3.SS3.SSS2.p2.2.m2.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.1.1.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml">G</mi><mover accent="true" id="S3.SS3.SSS2.p2.2.m2.1.1.3" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.1.1.3.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.2.cmml">c</mi><mo id="S3.SS3.SSS2.p2.2.m2.1.1.3.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.1.cmml">¯</mo></mover></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m2.1b"><apply id="S3.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.2">𝐺</ci><apply id="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3"><ci id="S3.SS3.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.1">¯</ci><ci id="S3.SS3.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.2">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m2.1c">G_{\bar{c}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.2.m2.1d">italic_G start_POSTSUBSCRIPT over¯ start_ARG italic_c end_ARG end_POSTSUBSCRIPT</annotation></semantics></math> through the multi-gating mechanism, we proceed to select the most relevant experts within this gate. To achieve this, we compute logits <math alttext="f(x)=\mathbf{W}\cdot x" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.3.m3.1"><semantics id="S3.SS3.SSS2.p2.3.m3.1a"><mrow id="S3.SS3.SSS2.p2.3.m3.1.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.cmml"><mrow id="S3.SS3.SSS2.p2.3.m3.1.2.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.2.2.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.2.cmml">f</mi><mo id="S3.SS3.SSS2.p2.3.m3.1.2.2.1" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml"><mo id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.2.1" stretchy="false" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml">(</mo><mi id="S3.SS3.SSS2.p2.3.m3.1.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.cmml">x</mi><mo id="S3.SS3.SSS2.p2.3.m3.1.2.2.3.2.2" stretchy="false" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS2.p2.3.m3.1.2.1" xref="S3.SS3.SSS2.p2.3.m3.1.2.1.cmml">=</mo><mrow id="S3.SS3.SSS2.p2.3.m3.1.2.3" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.2.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.2.cmml">𝐖</mi><mo id="S3.SS3.SSS2.p2.3.m3.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.1.cmml">⋅</mo><mi id="S3.SS3.SSS2.p2.3.m3.1.2.3.3" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3.cmml">x</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.3.m3.1b"><apply id="S3.SS3.SSS2.p2.3.m3.1.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2"><eq id="S3.SS3.SSS2.p2.3.m3.1.2.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.1"></eq><apply id="S3.SS3.SSS2.p2.3.m3.1.2.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2"><times id="S3.SS3.SSS2.p2.3.m3.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.1"></times><ci id="S3.SS3.SSS2.p2.3.m3.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.2.2">𝑓</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1">𝑥</ci></apply><apply id="S3.SS3.SSS2.p2.3.m3.1.2.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3"><ci id="S3.SS3.SSS2.p2.3.m3.1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.1">⋅</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.2.3.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.2">𝐖</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.2.3.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.2.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.3.m3.1c">f(x)=\mathbf{W}\cdot x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.3.m3.1d">italic_f ( italic_x ) = bold_W ⋅ italic_x</annotation></semantics></math>, where <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.4.m4.1"><semantics id="S3.SS3.SSS2.p2.4.m4.1a"><mi id="S3.SS3.SSS2.p2.4.m4.1.1" xref="S3.SS3.SSS2.p2.4.m4.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.4.m4.1b"><ci id="S3.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.4.m4.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.4.m4.1d">bold_W</annotation></semantics></math> is the weight matrix associated with gate <math alttext="G_{\bar{c}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.5.m5.1"><semantics id="S3.SS3.SSS2.p2.5.m5.1a"><msub id="S3.SS3.SSS2.p2.5.m5.1.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p2.5.m5.1.1.2" xref="S3.SS3.SSS2.p2.5.m5.1.1.2.cmml">G</mi><mover accent="true" id="S3.SS3.SSS2.p2.5.m5.1.1.3" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.5.m5.1.1.3.2" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.2.cmml">c</mi><mo id="S3.SS3.SSS2.p2.5.m5.1.1.3.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.1.cmml">¯</mo></mover></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.5.m5.1b"><apply id="S3.SS3.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.5.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.5.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.2">𝐺</ci><apply id="S3.SS3.SSS2.p2.5.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3"><ci id="S3.SS3.SSS2.p2.5.m5.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.1">¯</ci><ci id="S3.SS3.SSS2.p2.5.m5.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.2">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.5.m5.1c">G_{\bar{c}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.5.m5.1d">italic_G start_POSTSUBSCRIPT over¯ start_ARG italic_c end_ARG end_POSTSUBSCRIPT</annotation></semantics></math>. These logits represent the relevance scores of each expert for the given input within the selected gate. To obtain normalized probabilities for expert selection, we apply a softmax function overall all <math alttext="rN" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.6.m6.1"><semantics id="S3.SS3.SSS2.p2.6.m6.1a"><mrow id="S3.SS3.SSS2.p2.6.m6.1.1" xref="S3.SS3.SSS2.p2.6.m6.1.1.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.1.1.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.2.cmml">r</mi><mo id="S3.SS3.SSS2.p2.6.m6.1.1.1" xref="S3.SS3.SSS2.p2.6.m6.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.6.m6.1.1.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.6.m6.1b"><apply id="S3.SS3.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1"><times id="S3.SS3.SSS2.p2.6.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.1"></times><ci id="S3.SS3.SSS2.p2.6.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.2">𝑟</ci><ci id="S3.SS3.SSS2.p2.6.m6.1.1.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.6.m6.1c">rN</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.6.m6.1d">italic_r italic_N</annotation></semantics></math> experts:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="G_{\bar{c}}(x)_{i}=\frac{e^{f(x)_{i}}}{\sum_{j=1}^{rN}e^{f(x)_{j}}}" class="ltx_Math" display="block" id="S3.E10.m1.3"><semantics id="S3.E10.m1.3a"><mrow id="S3.E10.m1.3.4" xref="S3.E10.m1.3.4.cmml"><mrow id="S3.E10.m1.3.4.2" xref="S3.E10.m1.3.4.2.cmml"><msub id="S3.E10.m1.3.4.2.2" xref="S3.E10.m1.3.4.2.2.cmml"><mi id="S3.E10.m1.3.4.2.2.2" xref="S3.E10.m1.3.4.2.2.2.cmml">G</mi><mover accent="true" id="S3.E10.m1.3.4.2.2.3" xref="S3.E10.m1.3.4.2.2.3.cmml"><mi id="S3.E10.m1.3.4.2.2.3.2" xref="S3.E10.m1.3.4.2.2.3.2.cmml">c</mi><mo id="S3.E10.m1.3.4.2.2.3.1" xref="S3.E10.m1.3.4.2.2.3.1.cmml">¯</mo></mover></msub><mo id="S3.E10.m1.3.4.2.1" xref="S3.E10.m1.3.4.2.1.cmml">⁢</mo><msub id="S3.E10.m1.3.4.2.3" xref="S3.E10.m1.3.4.2.3.cmml"><mrow id="S3.E10.m1.3.4.2.3.2.2" xref="S3.E10.m1.3.4.2.3.cmml"><mo id="S3.E10.m1.3.4.2.3.2.2.1" stretchy="false" xref="S3.E10.m1.3.4.2.3.cmml">(</mo><mi id="S3.E10.m1.3.3" xref="S3.E10.m1.3.3.cmml">x</mi><mo id="S3.E10.m1.3.4.2.3.2.2.2" stretchy="false" xref="S3.E10.m1.3.4.2.3.cmml">)</mo></mrow><mi id="S3.E10.m1.3.4.2.3.3" xref="S3.E10.m1.3.4.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E10.m1.3.4.1" xref="S3.E10.m1.3.4.1.cmml">=</mo><mfrac id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml"><msup id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.3" xref="S3.E10.m1.1.1.1.3.cmml">e</mi><mrow id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.3.cmml">f</mi><mo id="S3.E10.m1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E10.m1.1.1.1.1.1.4" xref="S3.E10.m1.1.1.1.1.1.4.cmml"><mrow id="S3.E10.m1.1.1.1.1.1.4.2.2" xref="S3.E10.m1.1.1.1.1.1.4.cmml"><mo id="S3.E10.m1.1.1.1.1.1.4.2.2.1" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.4.cmml">(</mo><mi id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml">x</mi><mo id="S3.E10.m1.1.1.1.1.1.4.2.2.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.4.cmml">)</mo></mrow><mi id="S3.E10.m1.1.1.1.1.1.4.3" xref="S3.E10.m1.1.1.1.1.1.4.3.cmml">i</mi></msub></mrow></msup><mrow id="S3.E10.m1.2.2.2" xref="S3.E10.m1.2.2.2.cmml"><msubsup id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.cmml"><mo id="S3.E10.m1.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E10.m1.2.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.2.3.cmml"><mi id="S3.E10.m1.2.2.2.2.2.3.2" xref="S3.E10.m1.2.2.2.2.2.3.2.cmml">j</mi><mo id="S3.E10.m1.2.2.2.2.2.3.1" xref="S3.E10.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E10.m1.2.2.2.2.2.3.3" xref="S3.E10.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E10.m1.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.3.cmml"><mi id="S3.E10.m1.2.2.2.2.3.2" xref="S3.E10.m1.2.2.2.2.3.2.cmml">r</mi><mo id="S3.E10.m1.2.2.2.2.3.1" xref="S3.E10.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E10.m1.2.2.2.2.3.3" xref="S3.E10.m1.2.2.2.2.3.3.cmml">N</mi></mrow></msubsup><msup id="S3.E10.m1.2.2.2.3" xref="S3.E10.m1.2.2.2.3.cmml"><mi id="S3.E10.m1.2.2.2.3.2" xref="S3.E10.m1.2.2.2.3.2.cmml">e</mi><mrow id="S3.E10.m1.2.2.2.1.1" xref="S3.E10.m1.2.2.2.1.1.cmml"><mi id="S3.E10.m1.2.2.2.1.1.3" xref="S3.E10.m1.2.2.2.1.1.3.cmml">f</mi><mo id="S3.E10.m1.2.2.2.1.1.2" xref="S3.E10.m1.2.2.2.1.1.2.cmml">⁢</mo><msub id="S3.E10.m1.2.2.2.1.1.4" xref="S3.E10.m1.2.2.2.1.1.4.cmml"><mrow id="S3.E10.m1.2.2.2.1.1.4.2.2" xref="S3.E10.m1.2.2.2.1.1.4.cmml"><mo id="S3.E10.m1.2.2.2.1.1.4.2.2.1" stretchy="false" xref="S3.E10.m1.2.2.2.1.1.4.cmml">(</mo><mi id="S3.E10.m1.2.2.2.1.1.1" xref="S3.E10.m1.2.2.2.1.1.1.cmml">x</mi><mo id="S3.E10.m1.2.2.2.1.1.4.2.2.2" stretchy="false" xref="S3.E10.m1.2.2.2.1.1.4.cmml">)</mo></mrow><mi id="S3.E10.m1.2.2.2.1.1.4.3" xref="S3.E10.m1.2.2.2.1.1.4.3.cmml">j</mi></msub></mrow></msup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.3b"><apply id="S3.E10.m1.3.4.cmml" xref="S3.E10.m1.3.4"><eq id="S3.E10.m1.3.4.1.cmml" xref="S3.E10.m1.3.4.1"></eq><apply id="S3.E10.m1.3.4.2.cmml" xref="S3.E10.m1.3.4.2"><times id="S3.E10.m1.3.4.2.1.cmml" xref="S3.E10.m1.3.4.2.1"></times><apply id="S3.E10.m1.3.4.2.2.cmml" xref="S3.E10.m1.3.4.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.3.4.2.2.1.cmml" xref="S3.E10.m1.3.4.2.2">subscript</csymbol><ci id="S3.E10.m1.3.4.2.2.2.cmml" xref="S3.E10.m1.3.4.2.2.2">𝐺</ci><apply id="S3.E10.m1.3.4.2.2.3.cmml" xref="S3.E10.m1.3.4.2.2.3"><ci id="S3.E10.m1.3.4.2.2.3.1.cmml" xref="S3.E10.m1.3.4.2.2.3.1">¯</ci><ci id="S3.E10.m1.3.4.2.2.3.2.cmml" xref="S3.E10.m1.3.4.2.2.3.2">𝑐</ci></apply></apply><apply id="S3.E10.m1.3.4.2.3.cmml" xref="S3.E10.m1.3.4.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.4.2.3.1.cmml" xref="S3.E10.m1.3.4.2.3">subscript</csymbol><ci id="S3.E10.m1.3.3.cmml" xref="S3.E10.m1.3.3">𝑥</ci><ci id="S3.E10.m1.3.4.2.3.3.cmml" xref="S3.E10.m1.3.4.2.3.3">𝑖</ci></apply></apply><apply id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2"><divide id="S3.E10.m1.2.2.3.cmml" xref="S3.E10.m1.2.2"></divide><apply id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1">superscript</csymbol><ci id="S3.E10.m1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.3">𝑒</ci><apply id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.2"></times><ci id="S3.E10.m1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.3">𝑓</ci><apply id="S3.E10.m1.1.1.1.1.1.4.cmml" xref="S3.E10.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.4.1.cmml" xref="S3.E10.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1">𝑥</ci><ci id="S3.E10.m1.1.1.1.1.1.4.3.cmml" xref="S3.E10.m1.1.1.1.1.1.4.3">𝑖</ci></apply></apply></apply><apply id="S3.E10.m1.2.2.2.cmml" xref="S3.E10.m1.2.2.2"><apply id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2">superscript</csymbol><apply id="S3.E10.m1.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2">subscript</csymbol><sum id="S3.E10.m1.2.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2"></sum><apply id="S3.E10.m1.2.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.3"><eq id="S3.E10.m1.2.2.2.2.2.3.1.cmml" xref="S3.E10.m1.2.2.2.2.2.3.1"></eq><ci id="S3.E10.m1.2.2.2.2.2.3.2.cmml" xref="S3.E10.m1.2.2.2.2.2.3.2">𝑗</ci><cn id="S3.E10.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E10.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E10.m1.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.3"><times id="S3.E10.m1.2.2.2.2.3.1.cmml" xref="S3.E10.m1.2.2.2.2.3.1"></times><ci id="S3.E10.m1.2.2.2.2.3.2.cmml" xref="S3.E10.m1.2.2.2.2.3.2">𝑟</ci><ci id="S3.E10.m1.2.2.2.2.3.3.cmml" xref="S3.E10.m1.2.2.2.2.3.3">𝑁</ci></apply></apply><apply id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.3.1.cmml" xref="S3.E10.m1.2.2.2.3">superscript</csymbol><ci id="S3.E10.m1.2.2.2.3.2.cmml" xref="S3.E10.m1.2.2.2.3.2">𝑒</ci><apply id="S3.E10.m1.2.2.2.1.1.cmml" xref="S3.E10.m1.2.2.2.1.1"><times id="S3.E10.m1.2.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.2.1.1.2"></times><ci id="S3.E10.m1.2.2.2.1.1.3.cmml" xref="S3.E10.m1.2.2.2.1.1.3">𝑓</ci><apply id="S3.E10.m1.2.2.2.1.1.4.cmml" xref="S3.E10.m1.2.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.1.1.4.1.cmml" xref="S3.E10.m1.2.2.2.1.1.4">subscript</csymbol><ci id="S3.E10.m1.2.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.2.1.1.1">𝑥</ci><ci id="S3.E10.m1.2.2.2.1.1.4.3.cmml" xref="S3.E10.m1.2.2.2.1.1.4.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.3c">G_{\bar{c}}(x)_{i}=\frac{e^{f(x)_{i}}}{\sum_{j=1}^{rN}e^{f(x)_{j}}}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.3d">italic_G start_POSTSUBSCRIPT over¯ start_ARG italic_c end_ARG end_POSTSUBSCRIPT ( italic_x ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = divide start_ARG italic_e start_POSTSUPERSCRIPT italic_f ( italic_x ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_r italic_N end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT italic_f ( italic_x ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p2.8">where <math alttext="G_{\bar{c}}(x)_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.7.m1.1"><semantics id="S3.SS3.SSS2.p2.7.m1.1a"><mrow id="S3.SS3.SSS2.p2.7.m1.1.2" xref="S3.SS3.SSS2.p2.7.m1.1.2.cmml"><msub id="S3.SS3.SSS2.p2.7.m1.1.2.2" xref="S3.SS3.SSS2.p2.7.m1.1.2.2.cmml"><mi id="S3.SS3.SSS2.p2.7.m1.1.2.2.2" xref="S3.SS3.SSS2.p2.7.m1.1.2.2.2.cmml">G</mi><mover accent="true" id="S3.SS3.SSS2.p2.7.m1.1.2.2.3" xref="S3.SS3.SSS2.p2.7.m1.1.2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.7.m1.1.2.2.3.2" xref="S3.SS3.SSS2.p2.7.m1.1.2.2.3.2.cmml">c</mi><mo id="S3.SS3.SSS2.p2.7.m1.1.2.2.3.1" xref="S3.SS3.SSS2.p2.7.m1.1.2.2.3.1.cmml">¯</mo></mover></msub><mo id="S3.SS3.SSS2.p2.7.m1.1.2.1" xref="S3.SS3.SSS2.p2.7.m1.1.2.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p2.7.m1.1.2.3" xref="S3.SS3.SSS2.p2.7.m1.1.2.3.cmml"><mrow id="S3.SS3.SSS2.p2.7.m1.1.2.3.2.2" xref="S3.SS3.SSS2.p2.7.m1.1.2.3.cmml"><mo id="S3.SS3.SSS2.p2.7.m1.1.2.3.2.2.1" stretchy="false" xref="S3.SS3.SSS2.p2.7.m1.1.2.3.cmml">(</mo><mi id="S3.SS3.SSS2.p2.7.m1.1.1" xref="S3.SS3.SSS2.p2.7.m1.1.1.cmml">x</mi><mo id="S3.SS3.SSS2.p2.7.m1.1.2.3.2.2.2" stretchy="false" xref="S3.SS3.SSS2.p2.7.m1.1.2.3.cmml">)</mo></mrow><mi id="S3.SS3.SSS2.p2.7.m1.1.2.3.3" xref="S3.SS3.SSS2.p2.7.m1.1.2.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.7.m1.1b"><apply id="S3.SS3.SSS2.p2.7.m1.1.2.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.2"><times id="S3.SS3.SSS2.p2.7.m1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.2.1"></times><apply id="S3.SS3.SSS2.p2.7.m1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.2.2.2">𝐺</ci><apply id="S3.SS3.SSS2.p2.7.m1.1.2.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.2.2.3"><ci id="S3.SS3.SSS2.p2.7.m1.1.2.2.3.1.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.2.2.3.1">¯</ci><ci id="S3.SS3.SSS2.p2.7.m1.1.2.2.3.2.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.2.2.3.2">𝑐</ci></apply></apply><apply id="S3.SS3.SSS2.p2.7.m1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.1">𝑥</ci><ci id="S3.SS3.SSS2.p2.7.m1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.2.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.7.m1.1c">G_{\bar{c}}(x)_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.7.m1.1d">italic_G start_POSTSUBSCRIPT over¯ start_ARG italic_c end_ARG end_POSTSUBSCRIPT ( italic_x ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the gating value for the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.8.m2.1"><semantics id="S3.SS3.SSS2.p2.8.m2.1a"><mi id="S3.SS3.SSS2.p2.8.m2.1.1" xref="S3.SS3.SSS2.p2.8.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.8.m2.1b"><ci id="S3.SS3.SSS2.p2.8.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.8.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.8.m2.1d">italic_i</annotation></semantics></math>-th expert.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p3">
<p class="ltx_p" id="S3.SS3.SSS2.p3.3">To further enhance efficiency and specialization, we select only the top <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.1.m1.1"><semantics id="S3.SS3.SSS2.p3.1.m1.1a"><mi id="S3.SS3.SSS2.p3.1.m1.1.1" xref="S3.SS3.SSS2.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.1.m1.1b"><ci id="S3.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.1.m1.1d">italic_k</annotation></semantics></math> experts based on their gating values. Let <math alttext="\Omega" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.2.m2.1"><semantics id="S3.SS3.SSS2.p3.2.m2.1a"><mi id="S3.SS3.SSS2.p3.2.m2.1.1" mathvariant="normal" xref="S3.SS3.SSS2.p3.2.m2.1.1.cmml">Ω</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.2.m2.1b"><ci id="S3.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1">Ω</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.2.m2.1c">\Omega</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.2.m2.1d">roman_Ω</annotation></semantics></math> represent the set of indices for these top <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.3.m3.1"><semantics id="S3.SS3.SSS2.p3.3.m3.1a"><mi id="S3.SS3.SSS2.p3.3.m3.1.1" xref="S3.SS3.SSS2.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.3.m3.1b"><ci id="S3.SS3.SSS2.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.3.m3.1d">italic_k</annotation></semantics></math> experts. The final output of the expert layer is then computed as a weighted combination of the selected experts’ outputs:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{i\in\Omega}^{rN}G_{\bar{c}}(x)_{i}\cdot E_{i}(x)" class="ltx_Math" display="block" id="S3.E11.m1.2"><semantics id="S3.E11.m1.2a"><mrow id="S3.E11.m1.2.3" xref="S3.E11.m1.2.3.cmml"><munderover id="S3.E11.m1.2.3.1" xref="S3.E11.m1.2.3.1.cmml"><mo id="S3.E11.m1.2.3.1.2.2" movablelimits="false" xref="S3.E11.m1.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E11.m1.2.3.1.2.3" xref="S3.E11.m1.2.3.1.2.3.cmml"><mi id="S3.E11.m1.2.3.1.2.3.2" xref="S3.E11.m1.2.3.1.2.3.2.cmml">i</mi><mo id="S3.E11.m1.2.3.1.2.3.1" xref="S3.E11.m1.2.3.1.2.3.1.cmml">∈</mo><mi id="S3.E11.m1.2.3.1.2.3.3" mathvariant="normal" xref="S3.E11.m1.2.3.1.2.3.3.cmml">Ω</mi></mrow><mrow id="S3.E11.m1.2.3.1.3" xref="S3.E11.m1.2.3.1.3.cmml"><mi id="S3.E11.m1.2.3.1.3.2" xref="S3.E11.m1.2.3.1.3.2.cmml">r</mi><mo id="S3.E11.m1.2.3.1.3.1" xref="S3.E11.m1.2.3.1.3.1.cmml">⁢</mo><mi id="S3.E11.m1.2.3.1.3.3" xref="S3.E11.m1.2.3.1.3.3.cmml">N</mi></mrow></munderover><mrow id="S3.E11.m1.2.3.2" xref="S3.E11.m1.2.3.2.cmml"><mrow id="S3.E11.m1.2.3.2.2" xref="S3.E11.m1.2.3.2.2.cmml"><mrow id="S3.E11.m1.2.3.2.2.2" xref="S3.E11.m1.2.3.2.2.2.cmml"><msub id="S3.E11.m1.2.3.2.2.2.2" xref="S3.E11.m1.2.3.2.2.2.2.cmml"><mi id="S3.E11.m1.2.3.2.2.2.2.2" xref="S3.E11.m1.2.3.2.2.2.2.2.cmml">G</mi><mover accent="true" id="S3.E11.m1.2.3.2.2.2.2.3" xref="S3.E11.m1.2.3.2.2.2.2.3.cmml"><mi id="S3.E11.m1.2.3.2.2.2.2.3.2" xref="S3.E11.m1.2.3.2.2.2.2.3.2.cmml">c</mi><mo id="S3.E11.m1.2.3.2.2.2.2.3.1" xref="S3.E11.m1.2.3.2.2.2.2.3.1.cmml">¯</mo></mover></msub><mo id="S3.E11.m1.2.3.2.2.2.1" xref="S3.E11.m1.2.3.2.2.2.1.cmml">⁢</mo><msub id="S3.E11.m1.2.3.2.2.2.3" xref="S3.E11.m1.2.3.2.2.2.3.cmml"><mrow id="S3.E11.m1.2.3.2.2.2.3.2.2" xref="S3.E11.m1.2.3.2.2.2.3.cmml"><mo id="S3.E11.m1.2.3.2.2.2.3.2.2.1" stretchy="false" xref="S3.E11.m1.2.3.2.2.2.3.cmml">(</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">x</mi><mo id="S3.E11.m1.2.3.2.2.2.3.2.2.2" rspace="0.055em" stretchy="false" xref="S3.E11.m1.2.3.2.2.2.3.cmml">)</mo></mrow><mi id="S3.E11.m1.2.3.2.2.2.3.3" xref="S3.E11.m1.2.3.2.2.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E11.m1.2.3.2.2.1" rspace="0.222em" xref="S3.E11.m1.2.3.2.2.1.cmml">⋅</mo><msub id="S3.E11.m1.2.3.2.2.3" xref="S3.E11.m1.2.3.2.2.3.cmml"><mi id="S3.E11.m1.2.3.2.2.3.2" xref="S3.E11.m1.2.3.2.2.3.2.cmml">E</mi><mi id="S3.E11.m1.2.3.2.2.3.3" xref="S3.E11.m1.2.3.2.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E11.m1.2.3.2.1" xref="S3.E11.m1.2.3.2.1.cmml">⁢</mo><mrow id="S3.E11.m1.2.3.2.3.2" xref="S3.E11.m1.2.3.2.cmml"><mo id="S3.E11.m1.2.3.2.3.2.1" stretchy="false" xref="S3.E11.m1.2.3.2.cmml">(</mo><mi id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml">x</mi><mo id="S3.E11.m1.2.3.2.3.2.2" stretchy="false" xref="S3.E11.m1.2.3.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.2b"><apply id="S3.E11.m1.2.3.cmml" xref="S3.E11.m1.2.3"><apply id="S3.E11.m1.2.3.1.cmml" xref="S3.E11.m1.2.3.1"><csymbol cd="ambiguous" id="S3.E11.m1.2.3.1.1.cmml" xref="S3.E11.m1.2.3.1">superscript</csymbol><apply id="S3.E11.m1.2.3.1.2.cmml" xref="S3.E11.m1.2.3.1"><csymbol cd="ambiguous" id="S3.E11.m1.2.3.1.2.1.cmml" xref="S3.E11.m1.2.3.1">subscript</csymbol><sum id="S3.E11.m1.2.3.1.2.2.cmml" xref="S3.E11.m1.2.3.1.2.2"></sum><apply id="S3.E11.m1.2.3.1.2.3.cmml" xref="S3.E11.m1.2.3.1.2.3"><in id="S3.E11.m1.2.3.1.2.3.1.cmml" xref="S3.E11.m1.2.3.1.2.3.1"></in><ci id="S3.E11.m1.2.3.1.2.3.2.cmml" xref="S3.E11.m1.2.3.1.2.3.2">𝑖</ci><ci id="S3.E11.m1.2.3.1.2.3.3.cmml" xref="S3.E11.m1.2.3.1.2.3.3">Ω</ci></apply></apply><apply id="S3.E11.m1.2.3.1.3.cmml" xref="S3.E11.m1.2.3.1.3"><times id="S3.E11.m1.2.3.1.3.1.cmml" xref="S3.E11.m1.2.3.1.3.1"></times><ci id="S3.E11.m1.2.3.1.3.2.cmml" xref="S3.E11.m1.2.3.1.3.2">𝑟</ci><ci id="S3.E11.m1.2.3.1.3.3.cmml" xref="S3.E11.m1.2.3.1.3.3">𝑁</ci></apply></apply><apply id="S3.E11.m1.2.3.2.cmml" xref="S3.E11.m1.2.3.2"><times id="S3.E11.m1.2.3.2.1.cmml" xref="S3.E11.m1.2.3.2.1"></times><apply id="S3.E11.m1.2.3.2.2.cmml" xref="S3.E11.m1.2.3.2.2"><ci id="S3.E11.m1.2.3.2.2.1.cmml" xref="S3.E11.m1.2.3.2.2.1">⋅</ci><apply id="S3.E11.m1.2.3.2.2.2.cmml" xref="S3.E11.m1.2.3.2.2.2"><times id="S3.E11.m1.2.3.2.2.2.1.cmml" xref="S3.E11.m1.2.3.2.2.2.1"></times><apply id="S3.E11.m1.2.3.2.2.2.2.cmml" xref="S3.E11.m1.2.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.2.3.2.2.2.2.1.cmml" xref="S3.E11.m1.2.3.2.2.2.2">subscript</csymbol><ci id="S3.E11.m1.2.3.2.2.2.2.2.cmml" xref="S3.E11.m1.2.3.2.2.2.2.2">𝐺</ci><apply id="S3.E11.m1.2.3.2.2.2.2.3.cmml" xref="S3.E11.m1.2.3.2.2.2.2.3"><ci id="S3.E11.m1.2.3.2.2.2.2.3.1.cmml" xref="S3.E11.m1.2.3.2.2.2.2.3.1">¯</ci><ci id="S3.E11.m1.2.3.2.2.2.2.3.2.cmml" xref="S3.E11.m1.2.3.2.2.2.2.3.2">𝑐</ci></apply></apply><apply id="S3.E11.m1.2.3.2.2.2.3.cmml" xref="S3.E11.m1.2.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.2.3.2.2.2.3.1.cmml" xref="S3.E11.m1.2.3.2.2.2.3">subscript</csymbol><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝑥</ci><ci id="S3.E11.m1.2.3.2.2.2.3.3.cmml" xref="S3.E11.m1.2.3.2.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.E11.m1.2.3.2.2.3.cmml" xref="S3.E11.m1.2.3.2.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.2.3.2.2.3.1.cmml" xref="S3.E11.m1.2.3.2.2.3">subscript</csymbol><ci id="S3.E11.m1.2.3.2.2.3.2.cmml" xref="S3.E11.m1.2.3.2.2.3.2">𝐸</ci><ci id="S3.E11.m1.2.3.2.2.3.3.cmml" xref="S3.E11.m1.2.3.2.2.3.3">𝑖</ci></apply></apply><ci id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.2c">\sum_{i\in\Omega}^{rN}G_{\bar{c}}(x)_{i}\cdot E_{i}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.2d">∑ start_POSTSUBSCRIPT italic_i ∈ roman_Ω end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_r italic_N end_POSTSUPERSCRIPT italic_G start_POSTSUBSCRIPT over¯ start_ARG italic_c end_ARG end_POSTSUBSCRIPT ( italic_x ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p3.6">where <math alttext="E_{i(x)}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.4.m1.1"><semantics id="S3.SS3.SSS2.p3.4.m1.1a"><msub id="S3.SS3.SSS2.p3.4.m1.1.2" xref="S3.SS3.SSS2.p3.4.m1.1.2.cmml"><mi id="S3.SS3.SSS2.p3.4.m1.1.2.2" xref="S3.SS3.SSS2.p3.4.m1.1.2.2.cmml">E</mi><mrow id="S3.SS3.SSS2.p3.4.m1.1.1.1" xref="S3.SS3.SSS2.p3.4.m1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p3.4.m1.1.1.1.3" xref="S3.SS3.SSS2.p3.4.m1.1.1.1.3.cmml">i</mi><mo id="S3.SS3.SSS2.p3.4.m1.1.1.1.2" xref="S3.SS3.SSS2.p3.4.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p3.4.m1.1.1.1.4.2" xref="S3.SS3.SSS2.p3.4.m1.1.1.1.cmml"><mo id="S3.SS3.SSS2.p3.4.m1.1.1.1.4.2.1" stretchy="false" xref="S3.SS3.SSS2.p3.4.m1.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS2.p3.4.m1.1.1.1.1" xref="S3.SS3.SSS2.p3.4.m1.1.1.1.1.cmml">x</mi><mo id="S3.SS3.SSS2.p3.4.m1.1.1.1.4.2.2" stretchy="false" xref="S3.SS3.SSS2.p3.4.m1.1.1.1.cmml">)</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.4.m1.1b"><apply id="S3.SS3.SSS2.p3.4.m1.1.2.cmml" xref="S3.SS3.SSS2.p3.4.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.4.m1.1.2.1.cmml" xref="S3.SS3.SSS2.p3.4.m1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p3.4.m1.1.2.2.cmml" xref="S3.SS3.SSS2.p3.4.m1.1.2.2">𝐸</ci><apply id="S3.SS3.SSS2.p3.4.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.4.m1.1.1.1"><times id="S3.SS3.SSS2.p3.4.m1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.4.m1.1.1.1.2"></times><ci id="S3.SS3.SSS2.p3.4.m1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.4.m1.1.1.1.3">𝑖</ci><ci id="S3.SS3.SSS2.p3.4.m1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.4.m1.1.1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.4.m1.1c">E_{i(x)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.4.m1.1d">italic_E start_POSTSUBSCRIPT italic_i ( italic_x ) end_POSTSUBSCRIPT</annotation></semantics></math> is the output of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.5.m2.1"><semantics id="S3.SS3.SSS2.p3.5.m2.1a"><mi id="S3.SS3.SSS2.p3.5.m2.1.1" xref="S3.SS3.SSS2.p3.5.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.5.m2.1b"><ci id="S3.SS3.SSS2.p3.5.m2.1.1.cmml" xref="S3.SS3.SSS2.p3.5.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.5.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.5.m2.1d">italic_i</annotation></semantics></math>-th expert network for input <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.6.m3.1"><semantics id="S3.SS3.SSS2.p3.6.m3.1a"><mi id="S3.SS3.SSS2.p3.6.m3.1.1" xref="S3.SS3.SSS2.p3.6.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.6.m3.1b"><ci id="S3.SS3.SSS2.p3.6.m3.1.1.cmml" xref="S3.SS3.SSS2.p3.6.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.6.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.6.m3.1d">italic_x</annotation></semantics></math>.
By combining the multi-gating mechanism with fine-grained mixture of experts, our approach effectively addresses the challenges of personalization and data sparsity in explainable recommendation systems. It enables the model to generate highly tailored explanations by routing inputs to the most appropriate specialized experts, even in scenarios with limited user interaction data.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Two-stage Training Objective</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">To effectively train the GaVaMoE model, we employ a two-stage training process. This approach allows us to first capture deep collaborative preferences and then leverage this information for personalized explanation generation. The two stages are as follows:</p>
</div>
<section class="ltx_subsubsection" id="S3.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.1. </span>Stage 1: Rating Reconstruction Training</h4>
<div class="ltx_para" id="S3.SS4.SSS1.p1">
<p class="ltx_p" id="S3.SS4.SSS1.p1.2">The first stage focuses on training the VAE-GMM by rating reconstruction. Importantly, the VAE-GMM serves as a key component for the multi-gating mechanism. Our goal here is to capture nuanced user-item collaborative preferences and create user clusters.
We optimize the Evidence Lower Bound (ELBO) as our objective function:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{ELBO}}(x,\beta)=\mathbb{E}{q(z,c|x)}\left[\log p(x|z)\right%
]-\beta\cdot\text{KL}\left(q(z,c|x)||p(z,c)\right)" class="ltx_math_unparsed" display="block" id="S3.E12.m1.6"><semantics id="S3.E12.m1.6a"><mrow id="S3.E12.m1.6b"><msub id="S3.E12.m1.6.7"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.6.7.2">ℒ</mi><mtext id="S3.E12.m1.6.7.3">ELBO</mtext></msub><mrow id="S3.E12.m1.6.8"><mo id="S3.E12.m1.6.8.1" stretchy="false">(</mo><mi id="S3.E12.m1.1.1">x</mi><mo id="S3.E12.m1.6.8.2">,</mo><mi id="S3.E12.m1.2.2">β</mi><mo id="S3.E12.m1.6.8.3" stretchy="false">)</mo></mrow><mo id="S3.E12.m1.6.9">=</mo><mi id="S3.E12.m1.6.10">𝔼</mi><mi id="S3.E12.m1.6.11">q</mi><mrow id="S3.E12.m1.6.12"><mo id="S3.E12.m1.6.12.1" stretchy="false">(</mo><mi id="S3.E12.m1.3.3">z</mi><mo id="S3.E12.m1.6.12.2">,</mo><mi id="S3.E12.m1.6.12.3">c</mi><mo fence="false" id="S3.E12.m1.6.12.4" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E12.m1.6.12.5">x</mi><mo id="S3.E12.m1.6.12.6" stretchy="false">)</mo></mrow><mrow id="S3.E12.m1.6.13"><mo id="S3.E12.m1.6.13.1">[</mo><mi id="S3.E12.m1.6.13.2">log</mi><mi id="S3.E12.m1.6.13.3">p</mi><mrow id="S3.E12.m1.6.13.4"><mo id="S3.E12.m1.6.13.4.1" stretchy="false">(</mo><mi id="S3.E12.m1.6.13.4.2">x</mi><mo fence="false" id="S3.E12.m1.6.13.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E12.m1.6.13.4.4">z</mi><mo id="S3.E12.m1.6.13.4.5" stretchy="false">)</mo></mrow><mo id="S3.E12.m1.6.13.5">]</mo></mrow><mo id="S3.E12.m1.6.14">−</mo><mi id="S3.E12.m1.6.15">β</mi><mo id="S3.E12.m1.6.16" lspace="0.222em" rspace="0.222em">⋅</mo><mtext id="S3.E12.m1.6.17">KL</mtext><mrow id="S3.E12.m1.6.18"><mo id="S3.E12.m1.6.18.1">(</mo><mi id="S3.E12.m1.6.18.2">q</mi><mrow id="S3.E12.m1.6.18.3"><mo id="S3.E12.m1.6.18.3.1" stretchy="false">(</mo><mi id="S3.E12.m1.4.4">z</mi><mo id="S3.E12.m1.6.18.3.2">,</mo><mi id="S3.E12.m1.6.18.3.3">c</mi><mo fence="false" id="S3.E12.m1.6.18.3.4" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E12.m1.6.18.3.5">x</mi><mo id="S3.E12.m1.6.18.3.6" stretchy="false">)</mo></mrow><mo fence="false" id="S3.E12.m1.6.18.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S3.E12.m1.6.18.5" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E12.m1.6.18.6">p</mi><mrow id="S3.E12.m1.6.18.7"><mo id="S3.E12.m1.6.18.7.1" stretchy="false">(</mo><mi id="S3.E12.m1.5.5">z</mi><mo id="S3.E12.m1.6.18.7.2">,</mo><mi id="S3.E12.m1.6.6">c</mi><mo id="S3.E12.m1.6.18.7.3" stretchy="false">)</mo></mrow><mo id="S3.E12.m1.6.18.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E12.m1.6c">\mathcal{L}_{\text{ELBO}}(x,\beta)=\mathbb{E}{q(z,c|x)}\left[\log p(x|z)\right%
]-\beta\cdot\text{KL}\left(q(z,c|x)||p(z,c)\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.6d">caligraphic_L start_POSTSUBSCRIPT ELBO end_POSTSUBSCRIPT ( italic_x , italic_β ) = blackboard_E italic_q ( italic_z , italic_c | italic_x ) [ roman_log italic_p ( italic_x | italic_z ) ] - italic_β ⋅ KL ( italic_q ( italic_z , italic_c | italic_x ) | | italic_p ( italic_z , italic_c ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS1.p1.1">This function balances two key aspects: the reconstruction of user-item interactions and the organization of these interactions into distinct clusters. The first term encourages accurate reconstruction, while the second term, controlled by the hyperparameter <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.1.m1.1"><semantics id="S3.SS4.SSS1.p1.1.m1.1a"><mi id="S3.SS4.SSS1.p1.1.m1.1.1" xref="S3.SS4.SSS1.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.1.m1.1b"><ci id="S3.SS4.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS1.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.1.m1.1d">italic_β</annotation></semantics></math>, ensures that our latent representations are well-structured and informative.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.2. </span>Stage 2: Explanation Generation Training</h4>
<div class="ltx_para" id="S3.SS4.SSS2.p1">
<p class="ltx_p" id="S3.SS4.SSS2.p1.5">With our collaborative preferences captured, the second stage focuses on training the Multi-gating Mixture of Experts to generate personalized explanations. We leverage the user clusters and latent representations learned in the first stage.
Our objective function for this stage combines rating prediction accuracy with explanation quality:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{total}}=\alpha\cdot\mathcal{L}_{\text{ELBO}}+(1-\alpha)%
\cdot\mathcal{L}_{\text{explanation}}" class="ltx_Math" display="block" id="S3.E13.m1.1"><semantics id="S3.E13.m1.1a"><mrow id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml"><msub id="S3.E13.m1.1.1.3" xref="S3.E13.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.3.2" xref="S3.E13.m1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E13.m1.1.1.3.3" xref="S3.E13.m1.1.1.3.3a.cmml">total</mtext></msub><mo id="S3.E13.m1.1.1.2" xref="S3.E13.m1.1.1.2.cmml">=</mo><mrow id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.cmml"><mrow id="S3.E13.m1.1.1.1.3" xref="S3.E13.m1.1.1.1.3.cmml"><mi id="S3.E13.m1.1.1.1.3.2" xref="S3.E13.m1.1.1.1.3.2.cmml">α</mi><mo id="S3.E13.m1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E13.m1.1.1.1.3.1.cmml">⋅</mo><msub id="S3.E13.m1.1.1.1.3.3" xref="S3.E13.m1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.3.3.2" xref="S3.E13.m1.1.1.1.3.3.2.cmml">ℒ</mi><mtext id="S3.E13.m1.1.1.1.3.3.3" xref="S3.E13.m1.1.1.1.3.3.3a.cmml">ELBO</mtext></msub></mrow><mo id="S3.E13.m1.1.1.1.2" xref="S3.E13.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><mrow id="S3.E13.m1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E13.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E13.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E13.m1.1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E13.m1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E13.m1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo id="S3.E13.m1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E13.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E13.m1.1.1.1.1.2" rspace="0.222em" xref="S3.E13.m1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E13.m1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.3.2" xref="S3.E13.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E13.m1.1.1.1.1.3.3" xref="S3.E13.m1.1.1.1.1.3.3a.cmml">explanation</mtext></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1"><eq id="S3.E13.m1.1.1.2.cmml" xref="S3.E13.m1.1.1.2"></eq><apply id="S3.E13.m1.1.1.3.cmml" xref="S3.E13.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.3">subscript</csymbol><ci id="S3.E13.m1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.3.2">ℒ</ci><ci id="S3.E13.m1.1.1.3.3a.cmml" xref="S3.E13.m1.1.1.3.3"><mtext id="S3.E13.m1.1.1.3.3.cmml" mathsize="70%" xref="S3.E13.m1.1.1.3.3">total</mtext></ci></apply><apply id="S3.E13.m1.1.1.1.cmml" xref="S3.E13.m1.1.1.1"><plus id="S3.E13.m1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.2"></plus><apply id="S3.E13.m1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.3"><ci id="S3.E13.m1.1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.1.3.1">⋅</ci><ci id="S3.E13.m1.1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.1.3.2">𝛼</ci><apply id="S3.E13.m1.1.1.1.3.3.cmml" xref="S3.E13.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.3.3.1.cmml" xref="S3.E13.m1.1.1.1.3.3">subscript</csymbol><ci id="S3.E13.m1.1.1.1.3.3.2.cmml" xref="S3.E13.m1.1.1.1.3.3.2">ℒ</ci><ci id="S3.E13.m1.1.1.1.3.3.3a.cmml" xref="S3.E13.m1.1.1.1.3.3.3"><mtext id="S3.E13.m1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E13.m1.1.1.1.3.3.3">ELBO</mtext></ci></apply></apply><apply id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1"><ci id="S3.E13.m1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.2">⋅</ci><apply id="S3.E13.m1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1"><minus id="S3.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1"></minus><cn id="S3.E13.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E13.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E13.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="S3.E13.m1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E13.m1.1.1.1.1.3.3a.cmml" xref="S3.E13.m1.1.1.1.1.3.3"><mtext id="S3.E13.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E13.m1.1.1.1.1.3.3">explanation</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\mathcal{L}_{\text{total}}=\alpha\cdot\mathcal{L}_{\text{ELBO}}+(1-\alpha)%
\cdot\mathcal{L}_{\text{explanation}}</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.1d">caligraphic_L start_POSTSUBSCRIPT total end_POSTSUBSCRIPT = italic_α ⋅ caligraphic_L start_POSTSUBSCRIPT ELBO end_POSTSUBSCRIPT + ( 1 - italic_α ) ⋅ caligraphic_L start_POSTSUBSCRIPT explanation end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS2.p1.4">Here, <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.1.m1.1"><semantics id="S3.SS4.SSS2.p1.1.m1.1a"><mi id="S3.SS4.SSS2.p1.1.m1.1.1" xref="S3.SS4.SSS2.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.1.m1.1b"><ci id="S3.SS4.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS2.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.1.m1.1d">italic_α</annotation></semantics></math> balances the importance of accurate rating predictions <math alttext="\mathcal{L}_{\text{ELBO}}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.2.m2.1"><semantics id="S3.SS4.SSS2.p1.2.m2.1a"><msub id="S3.SS4.SSS2.p1.2.m2.1.1" xref="S3.SS4.SSS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p1.2.m2.1.1.2" xref="S3.SS4.SSS2.p1.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.SS4.SSS2.p1.2.m2.1.1.3" xref="S3.SS4.SSS2.p1.2.m2.1.1.3a.cmml">ELBO</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.2.m2.1b"><apply id="S3.SS4.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS4.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS4.SSS2.p1.2.m2.1.1.2">ℒ</ci><ci id="S3.SS4.SSS2.p1.2.m2.1.1.3a.cmml" xref="S3.SS4.SSS2.p1.2.m2.1.1.3"><mtext id="S3.SS4.SSS2.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS4.SSS2.p1.2.m2.1.1.3">ELBO</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.2.m2.1c">\mathcal{L}_{\text{ELBO}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT ELBO end_POSTSUBSCRIPT</annotation></semantics></math> with the quality of generated explanations <math alttext="\mathcal{L}_{\text{explanation}}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.3.m3.1"><semantics id="S3.SS4.SSS2.p1.3.m3.1a"><msub id="S3.SS4.SSS2.p1.3.m3.1.1" xref="S3.SS4.SSS2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p1.3.m3.1.1.2" xref="S3.SS4.SSS2.p1.3.m3.1.1.2.cmml">ℒ</mi><mtext id="S3.SS4.SSS2.p1.3.m3.1.1.3" xref="S3.SS4.SSS2.p1.3.m3.1.1.3a.cmml">explanation</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.3.m3.1b"><apply id="S3.SS4.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1.2">ℒ</ci><ci id="S3.SS4.SSS2.p1.3.m3.1.1.3a.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1.3"><mtext id="S3.SS4.SSS2.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS4.SSS2.p1.3.m3.1.1.3">explanation</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.3.m3.1c">\mathcal{L}_{\text{explanation}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT explanation end_POSTSUBSCRIPT</annotation></semantics></math>. The <math alttext="\mathcal{L}_{\text{explanation}}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.4.m4.1"><semantics id="S3.SS4.SSS2.p1.4.m4.1a"><msub id="S3.SS4.SSS2.p1.4.m4.1.1" xref="S3.SS4.SSS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p1.4.m4.1.1.2" xref="S3.SS4.SSS2.p1.4.m4.1.1.2.cmml">ℒ</mi><mtext id="S3.SS4.SSS2.p1.4.m4.1.1.3" xref="S3.SS4.SSS2.p1.4.m4.1.1.3a.cmml">explanation</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.4.m4.1b"><apply id="S3.SS4.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1.2">ℒ</ci><ci id="S3.SS4.SSS2.p1.4.m4.1.1.3a.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1.3"><mtext id="S3.SS4.SSS2.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS4.SSS2.p1.4.m4.1.1.3">explanation</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.4.m4.1c">\mathcal{L}_{\text{explanation}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT explanation end_POSTSUBSCRIPT</annotation></semantics></math> is the negative log-likelihood of generating the correct explanation.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.p2">
<p class="ltx_p" id="S3.SS4.SSS2.p2.1">This two-stage approach allows GaVaMoE to excel in both collaborative filtering and personalized explanation generation. By first building a VAE-GMM in understanding user-item interactions, and then leveraging this understanding for tailored explanations, we create a model capable of providing highly personalized and contextually relevant recommendations and explanations.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiment</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Datasets</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">To comprehensively evaluate GaVaMoE, we utilized three diverse real-world datasets: TripAdvisor<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.tripadvisor.com" title="">https://www.tripadvisor.com</a></span></span></span>, Amazon (Movies &amp; TV)<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="http://jmcauley.ucsd.edu/data/amazon" title="">http://jmcauley.ucsd.edu/data/amazon</a></span></span></span>, and Yelp<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.yelp.com/dataset" title="">https://www.yelp.com/dataset</a></span></span></span>.
TripAdvisor represents the travel and hospitality sector with hotel and attraction reviews, Amazon focuses on the entertainment domain with movie and TV show ratings, while Yelp encompasses a broad spectrum of local businesses including restaurants, services, and retail. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.T1" title="Table 1 ‣ 4.1. Datasets ‣ 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, these datasets exhibit varying scales and potential sparsity levels, with Yelp being the largest and potentially most sparse, followed by Amazon and TripAdvisor.
This diversity in data characteristics enables us to evaluate GaVaMoE’s adaptability and robustness in handling different user behavior patterns and data sparsity challenges. For our experiments, each dataset was randomly split into training, validation, and test sets at a ratio of 8:1:1.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.2.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S4.T1.3.2" style="font-size:90%;">Statistics of the Datasets</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.4.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S4.T1.4.1.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.4.1.1.2">TripAdvisor</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.4.1.1.3">Amazon</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.4.1.1.4">Yelp</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.4.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.4.2.1.1">#users</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.2.1.2">9,765</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.2.1.3">7,506</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T1.4.2.1.4">27,147</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.4.3.2.1">#items</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.3.2.2">6,280</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.3.2.3">7,360</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.3.2.4">20,266</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.4.4.3.1">#records</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.3.2">320,023</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.3.3">441,783</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.4.3.4">1,293,247</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.4.5.4.1">#features</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.5.4.2">5,069</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.5.4.3">5,399</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S4.T1.4.5.4.4">7,340</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.2.1.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text" id="S4.T2.3.2" style="font-size:90%;">Performance comparison of explanation generation methods across three datasets. Metrics include BLEU and ROUGE for text quality, Distinct for personalization, and BERTScore for semantic consistency. </span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.4.1.1">
<td class="ltx_td ltx_border_tt" id="S4.T2.4.1.1.1"></td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T2.4.1.1.2">BLEU (%)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T2.4.1.1.3">ROUGE (%)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T2.4.1.1.4">Distinct (%)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T2.4.1.1.5">BERTScore</th>
</tr>
<tr class="ltx_tr" id="S4.T2.4.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.2">BLEU-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.3">BLEU-4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.4">ROUGE-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.5">ROUGE-L</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.6">Distinct-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.7">Distinct-2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.8">BERTScore-P</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.9">BERTScore-R</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.10">BERTScore-F</th>
</tr>
<tr class="ltx_tr" id="S4.T2.4.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="10" id="S4.T2.4.3.3.1">Amazon(Movie &amp; TV)</th>
</tr>
<tr class="ltx_tr" id="S4.T2.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.1">PEPLER</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.2">12.564</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.3">0.991</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.4">14.005</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.5">10.816</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.6">17.134</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.7">61.190</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.8">0.369</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.9">0.362</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.10">0.364</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.5.5">
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.5.1">PETER</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.5.2">14.796</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.5.3">1.201</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.5.4">15.335</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.5.5">11.614</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.5.6">17.431</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.5.7">62.790</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.5.8">0.384</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.5.9">0.376</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.5.10">0.380</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.6.6">
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.6.1">PEVAE</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.6.2">16.349</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.6.3">1.503</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.6.4">19.255</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.6.5">15.853</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.6.6">18.440</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.6.7">60.610</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.6.8">0.349</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.6.9">0.340</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.6.10">0.345</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.7.7">
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.7.1">NETE</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.7.2">14.965</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.7.3">1.152</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.7.4">16.470</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.7.5">12.982</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.7.6">14.503</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.7.7">47.312</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.7.8">0.344</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.7.9">0.344</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.7.10">0.344</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.8.8">
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.8.1">XRec</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.8.2">20.259</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.8.3">1.730</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.8.4">24.971</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.8.5">17.737</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.8.6">20.370</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.8.7">64.444</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.8.8">0.409</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.8.9">0.398</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.8.10">0.401</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.9.9">
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.9.1">GaVaMoE</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.9.2"><span class="ltx_text ltx_font_bold" id="S4.T2.4.9.9.2.1">21.370</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.9.3"><span class="ltx_text ltx_font_bold" id="S4.T2.4.9.9.3.1">1.751</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.9.4"><span class="ltx_text ltx_font_bold" id="S4.T2.4.9.9.4.1">25.445</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.9.5"><span class="ltx_text ltx_font_bold" id="S4.T2.4.9.9.5.1">17.747</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.9.6"><span class="ltx_text ltx_font_bold" id="S4.T2.4.9.9.6.1">21.254</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.9.7"><span class="ltx_text ltx_font_bold" id="S4.T2.4.9.9.7.1">65.784</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.9.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.9.9.8.1">0.416</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.9.9"><span class="ltx_text ltx_font_bold" id="S4.T2.4.9.9.9.1">0.410</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.9.10"><span class="ltx_text ltx_font_bold" id="S4.T2.4.9.9.10.1">0.412</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.10.10">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="10" id="S4.T2.4.10.10.1">TripAdvisor</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.11.11">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.11.11.1">PEPLER</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.11.11.2">13.392</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.11.11.3">0.965</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.11.11.4">15.382</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.11.11.5">12.078</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.11.11.6">18.124</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.11.11.7">64.923</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.11.11.8">0.345</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.11.11.9">0.303</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.11.11.10">0.343</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.12.12">
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.12.1">PETER</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.12.2">14.957</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.12.3">0.881</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.12.4">16.514</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.12.5">13.002</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.12.6">19.400</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.12.7">65.652</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.12.8">0.354</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.12.9">0.325</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.12.10">0.350</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.13.13">
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.13.1">PEVAE</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.13.2">15.705</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.13.3">1.401</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.13.4">18.675</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.13.5">15.411</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.13.6">18.182</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.13.7">66.414</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.13.8">0.369</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.13.9">0.363</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.13.10">0.368</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.14.14">
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.14.1">NETE</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.14.2">13.847</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.14.3">1.186</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.14.4">14.891</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.14.5">11.880</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.14.6">14.854</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.14.7">48.431</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.14.8">0.300</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.14.9">0.293</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.14.10">0.295</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.15.15">
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.15.1">XRec</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.15.2">19.642</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.15.3">1.650</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.15.4">23.672</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.15.5">16.871</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.15.6">21.113</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.15.7">65.332</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.15.8">0.386</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.15.9">0.380</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.15.10">0.384</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.16.16">
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.16.1">GaVaMoE</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.16.2"><span class="ltx_text ltx_font_bold" id="S4.T2.4.16.16.2.1">21.142</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.16.3"><span class="ltx_text ltx_font_bold" id="S4.T2.4.16.16.3.1">1.891</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.16.4"><span class="ltx_text ltx_font_bold" id="S4.T2.4.16.16.4.1">25.465</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.16.5"><span class="ltx_text ltx_font_bold" id="S4.T2.4.16.16.5.1">18.118</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.16.6"><span class="ltx_text ltx_font_bold" id="S4.T2.4.16.16.6.1">22.784</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.16.7"><span class="ltx_text ltx_font_bold" id="S4.T2.4.16.16.7.1">68.398</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.16.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.16.16.8.1">0.397</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.16.9"><span class="ltx_text ltx_font_bold" id="S4.T2.4.16.16.9.1">0.392</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.16.10"><span class="ltx_text ltx_font_bold" id="S4.T2.4.16.16.10.1">0.394</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.17.17">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="10" id="S4.T2.4.17.17.1">Yelp</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.18.18">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.18.1">PEPLER</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.18.2">9.448</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.18.3">0.623</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.18.4">12.604</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.18.5">9.769</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.18.6">13.321</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.18.7">43.577</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.18.8">0.317</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.18.9">0.294</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.18.10">0.305</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.19.19">
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.19.1">PETER</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.19.2">8.072</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.19.3">0.574</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.19.4">12.965</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.19.5">9.850</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.19.6">14.240</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.19.7">52.891</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.19.8">0.298</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.19.9">0.271</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.19.10">0.281</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.20.20">
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.20.1">PEVAE</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.20.2">14.250</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.20.3">1.217</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.20.4">16.229</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.20.5">13.891</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.20.6">16.890</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.20.7">58.510</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.20.8">0.328</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.20.9">0.323</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.20.10">0.326</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.21.21">
<td class="ltx_td ltx_align_center" id="S4.T2.4.21.21.1">NETE</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.21.21.2">11.314</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.21.21.3">0.823</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.21.21.4">14.041</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.21.21.5">9.226</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.21.21.6">13.245</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.21.21.7">44.426</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.21.21.8">0.222</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.21.21.9">0.137</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.21.21.10">0.144</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.22.22">
<td class="ltx_td ltx_align_center" id="S4.T2.4.22.22.1">XRec</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.22.22.2">19.379</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.22.22.3">1.601</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.22.22.4">22.870</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.22.22.5">16.531</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.22.22.6">17.560</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.22.22.7">61.190</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.22.22.8">0.395</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.22.22.9">0.351</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.22.22.10">0.373</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.23.23">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.23.23.1">GaVaMoE</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.23.23.2"><span class="ltx_text ltx_font_bold" id="S4.T2.4.23.23.2.1">19.586</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.23.23.3"><span class="ltx_text ltx_font_bold" id="S4.T2.4.23.23.3.1">1.616</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.23.23.4"><span class="ltx_text ltx_font_bold" id="S4.T2.4.23.23.4.1">23.259</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.23.23.5"><span class="ltx_text ltx_font_bold" id="S4.T2.4.23.23.5.1">17.416</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.23.23.6"><span class="ltx_text ltx_font_bold" id="S4.T2.4.23.23.6.1">19.483</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.23.23.7"><span class="ltx_text ltx_font_bold" id="S4.T2.4.23.23.7.1">63.847</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.23.23.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.23.23.8.1">0.406</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.23.23.9"><span class="ltx_text ltx_font_bold" id="S4.T2.4.23.23.9.1">0.374</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.23.23.10"><span class="ltx_text ltx_font_bold" id="S4.T2.4.23.23.10.1">0.381</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Implementation Detail</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">GaVaMoE employs a two-layer Transformer encoder and a two-layer MLP for the decoder in the VAE. The latent space size is 128, with user and item embeddings of 768. We set batch size to 4096, learning rate to 1e-5, <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_β</annotation></semantics></math> to 0.1 and 30 training epochs. For explanation generation training, we set the batch size to 1, learning tate to 3e-5.The training process utilizes AdamW with a gradient accumulation of 8 and a clipping norm of 0.3. GaVaMoE uses LLaMA3.1-8B <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib6" title="">dubey2024llama, </a>)</cite> with 32 GaVaMoE blocks, replacing the FFN with MoE (hidden size 1280, 12 experts, 2 activated per pass). The number of gates matches user clusters, and explanation generation training lasts 3 for epochs.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Compared Methods</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We compare our model’s performance against the following competiable baselines in explainable recommendation:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">NETE<cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib19" title="">li2020generate, </a>)</cite>: presents a gated fusion recurrent unit that leverages neural templates to generate high-quality, explainable text for recommendation systems.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1">PETER <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib22" title="">li2021personalized, </a>)</cite>: utilizes Transformer to integrate user and item IDs into generated explanations.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1">PEPLER <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib23" title="">li2023personalized, </a>)</cite>: adopts a pre-trained GPT-2 model with prompt tuning for explanation generation.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1">PEVAE <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib2" title="">cai2022pevae, </a>)</cite>: extends hierarchical VAEs to address data sparsity in LLM-based recommendation systems, aligning with our focus on sparse interaction scenarios.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i5.p1">
<p class="ltx_p" id="S4.I1.i5.p1.1">XRec <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib27" title="">ma2024xrec, </a>)</cite>: generates explanatory texts by integrating high-order collaborative signals encoded by graph neural networks and the text generation capabilities of LLMs.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">These baselines were carefully selected to represent the progression of explainable recommendation systems, from template-based approaches (NETE) to advanced LLM-based models (XRec).</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Evaluation Metrics</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">To comprehensively evaluate GaVaMoE’s performance, we employ metrics assessing three key dimensions: explanation quality, personalization, and consistency. For explanation quality, we use BLEU <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib28" title="">papineni2002bleu, </a>)</cite> (BLEU-1 and BLEU-4) and ROUGE <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib26" title="">lin2004rouge, </a>)</cite> (ROUGE-1 and ROUGE-L) to assess fluency, grammatical correctness, and content overlap. For personalization, we employ Distinct-1 and Distinct-2, evaluating unigram and bigram diversity in generated text. For consistency, we utilize BERTScore <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib43" title="">zhang2019bertscore, </a>)</cite>, capturing deeper semantic similarities using contextual embeddings. While BLEU and ROUGE are widely used, they have limitations in capturing true semantic information, relying primarily on n-gram overlap. BERTScore addresses this limitation with a more sophisticated approach to evaluating semantic consistency. This diverse set of metrics allows for a comprehensive evaluation of GaVaMoE’s performance across various aspects of explanation generation, assessing not only linguistic quality but also personalization and semantic consistency.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Results and Analysis</h3>
<section class="ltx_subsubsection" id="S4.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.5.1. </span>Main Results</h4>
<div class="ltx_para" id="S4.SS5.SSS1.p1">
<p class="ltx_p" id="S4.SS5.SSS1.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.T2" title="Table 2 ‣ 4.1. Datasets ‣ 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> presents the performance comparison of various explanation generation methods across TripAdvisor, Yelp, and Amazon (Movie &amp; TV) datasets. GaVaMoE consistently outperforms all baselines, including the state-of-the-art XRec model, across all metrics and datasets. Specifically, GaVaMoE achieves significant improvements over XRec: 6.39% on TripAdvisor, 4.46% on Yelp, and 2.57% on Amazon on average. In terms of text quality, GaVaMoE achieves the highest BLEU-4 and ROUGE-L scores across all datasets. For instance, on the Amazon dataset, GaVaMoE’s BLEU-4 score of 1.75% surpasses XRec’s 1.73%. The model’s superior performance in these metrics indicates its ability to generate high-quality, fluent explanations. GaVaMoE also demonstrates enhanced consistency, as measured by BERTScore. On the Amazon dataset, GaVaMoE achieves a BERTScore-F of 0.412, compared to XRec’s 0.401. Notably, on the sparser Yelp dataset, GaVaMoE’s BERTScore-F of 0.381 shows a 2.14% increase over XRec, highlighting its robustness in handling sparse data scenarios. For personalization, measured by Distinct scores, GaVaMoE consistently generates more diverse explanations. On TripAdvisor, GaVaMoE’s Distinct-1 and Distinct-2 scores of 22.784% and 68.398% respectively outperform XRec’s 21.113% and 65.332%.</p>
</div>
<div class="ltx_para" id="S4.SS5.SSS1.p2">
<p class="ltx_p" id="S4.SS5.SSS1.p2.1">These improvements can be attributed to GaVaMoE’s key components. The VAE enables deep collaborative preference modeling, capturing nuanced user-item interactions for more accurate and personalized explanations. This is enhanced by the integration of GMM, which refines user grouping based on similar preferences. The resulting clusters inform a multi-gating mechanism that efficiently routes user-item pairs to the most suitable experts, ensuring each explanation is generated by an expert familiar with the specific interaction pattern. These fine-grained experts, focusing on specific user subsets, allow for targeted and personalized explanation generation.
This combination of deep preference modeling, clustering, efficient routing, and specialized generation enables GaVaMoE to produce higher quality, personalized, and consistent explanations.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.2.1.1" style="font-size:90%;">Table 3</span>. </span><span class="ltx_text" id="S4.T3.3.2" style="font-size:90%;">Performance of GaVaMoE with different numbers of gates cross three datasets.</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T3.4.1.1.1">Router</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.2">BLEU-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.3">BLEU-4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.4">ROUGE-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.5">ROUGE-L</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.6">DISTINCT-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.7">DISTINCT-2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.8">BERTScore-P</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.9">BERTScore-R</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.10">BERTScore-F</th>
</tr>
<tr class="ltx_tr" id="S4.T3.4.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" colspan="10" id="S4.T3.4.2.2.1">TripAdvisor</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.4.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T3.4.3.1.1">2</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.3.1.2">17.270</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.3.1.3">1.735</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.3.1.4">25.314</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.3.1.5">18.392</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.3.1.6">20.466</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.3.1.7">65.332</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.3.1.8">0.301</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.3.1.9">0.296</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.4.3.1.10">0.263</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.4.2.1">3</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.2.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.4.2.2.1">21.142</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.2.3"><span class="ltx_text ltx_font_bold" id="S4.T3.4.4.2.3.1">1.891</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.2.4"><span class="ltx_text ltx_font_bold" id="S4.T3.4.4.2.4.1">25.465</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.2.5"><span class="ltx_text ltx_font_bold" id="S4.T3.4.4.2.5.1">18.118</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.2.6"><span class="ltx_text ltx_font_bold" id="S4.T3.4.4.2.6.1">22.784</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.2.7"><span class="ltx_text ltx_font_bold" id="S4.T3.4.4.2.7.1">68.398</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.2.8"><span class="ltx_text ltx_font_bold" id="S4.T3.4.4.2.8.1">0.397</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.2.9"><span class="ltx_text ltx_font_bold" id="S4.T3.4.4.2.9.1">0.392</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.4.2.10"><span class="ltx_text ltx_font_bold" id="S4.T3.4.4.2.10.1">0.395</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.5.3.1">4</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.5.3.2">19.980</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.5.3.3">1.862</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.5.3.4">25.040</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.5.3.5">18.192</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.5.3.6">21.284</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.5.3.7">67.190</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.5.3.8">0.313</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.5.3.9">0.299</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.5.3.10">0.285</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.6.4.1">5</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.6.4.2">16.038</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.6.4.3">1.748</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.6.4.4">24.886</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.6.4.5">18.034</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.6.4.6">20.130</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.6.4.7">66.036</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.6.4.8">0.290</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.6.4.9">0.259</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.6.4.10">0.240</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.7.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="10" id="S4.T3.4.7.5.1">Amazon (Movie &amp; TV)</th>
</tr>
<tr class="ltx_tr" id="S4.T3.4.8.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T3.4.8.6.1">2</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.8.6.2">17.465</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.8.6.3">1.521</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.8.6.4">21.072</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.8.6.5">15.271</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.8.6.6">17.113</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.8.6.7">60.074</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.8.6.8">0.311</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.8.6.9">0.290</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.4.8.6.10">0.304</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.9.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.9.7.1">3</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.9.7.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.9.7.2.1">19.586</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.9.7.3"><span class="ltx_text ltx_font_bold" id="S4.T3.4.9.7.3.1">1.616</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.9.7.4"><span class="ltx_text ltx_font_bold" id="S4.T3.4.9.7.4.1">23.259</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.9.7.5"><span class="ltx_text ltx_font_bold" id="S4.T3.4.9.7.5.1">17.416</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.9.7.6"><span class="ltx_text ltx_font_bold" id="S4.T3.4.9.7.6.1">19.483</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.9.7.7"><span class="ltx_text ltx_font_bold" id="S4.T3.4.9.7.7.1">63.847</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.9.7.8"><span class="ltx_text ltx_font_bold" id="S4.T3.4.9.7.8.1">0.406</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.9.7.9"><span class="ltx_text ltx_font_bold" id="S4.T3.4.9.7.9.1">0.374</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.9.7.10"><span class="ltx_text ltx_font_bold" id="S4.T3.4.9.7.10.1">0.381</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.10.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.10.8.1">4</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.10.8.2">16.224</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.10.8.3">1.398</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.10.8.4">22.697</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.10.8.5">16.875</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.10.8.6">17.470</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.10.8.7">61.454</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.10.8.8">0.368</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.10.8.9">0.350</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.10.8.10">0.353</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.11.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.11.9.1">5</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.11.9.2">16.047</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.11.9.3">1.326</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.11.9.4">22.067</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.11.9.5">16.644</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.11.9.6">17.201</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.11.9.7">61.241</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.11.9.8">0.360</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.11.9.9">0.334</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.11.9.10">0.347</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.12.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="10" id="S4.T3.4.12.10.1">Yelp</th>
</tr>
<tr class="ltx_tr" id="S4.T3.4.13.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T3.4.13.11.1">2</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.13.11.2">17.465</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.13.11.3">1.521</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.13.11.4">21.072</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.13.11.5">15.271</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.13.11.6">17.113</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.13.11.7">60.074</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.13.11.8">0.311</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.13.11.9">0.290</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.4.13.11.10">0.304</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.14.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.14.12.1">3</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.14.12.2"><span class="ltx_text ltx_font_bold" id="S4.T3.4.14.12.2.1">19.586</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.14.12.3"><span class="ltx_text ltx_font_bold" id="S4.T3.4.14.12.3.1">1.616</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.14.12.4"><span class="ltx_text ltx_font_bold" id="S4.T3.4.14.12.4.1">23.259</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.14.12.5"><span class="ltx_text ltx_font_bold" id="S4.T3.4.14.12.5.1">17.416</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.14.12.6"><span class="ltx_text ltx_font_bold" id="S4.T3.4.14.12.6.1">19.483</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.14.12.7"><span class="ltx_text ltx_font_bold" id="S4.T3.4.14.12.7.1">63.847</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.14.12.8"><span class="ltx_text ltx_font_bold" id="S4.T3.4.14.12.8.1">0.406</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.14.12.9"><span class="ltx_text ltx_font_bold" id="S4.T3.4.14.12.9.1">0.374</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.14.12.10"><span class="ltx_text ltx_font_bold" id="S4.T3.4.14.12.10.1">0.381</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.15.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.15.13.1">4</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.15.13.2">16.224</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.15.13.3">1.398</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.15.13.4">22.697</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.15.13.5">16.875</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.15.13.6">17.470</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.15.13.7">61.454</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.15.13.8">0.368</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.15.13.9">0.350</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.15.13.10">0.353</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.16.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T3.4.16.14.1">5</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.16.14.2">16.047</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.16.14.3">1.326</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.16.14.4">22.067</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.16.14.5">16.644</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.16.14.6">17.201</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.16.14.7">61.241</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.16.14.8">0.360</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.16.14.9">0.334</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S4.T3.4.16.14.10">0.347</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="308" id="S4.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">Ablation study results comparing GaVaMoE variants across TripAdvisor, Amazon, and Yelp datasets.</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.5.2. </span>Ablation Study</h4>
<div class="ltx_para" id="S4.SS5.SSS2.p1">
<p class="ltx_p" id="S4.SS5.SSS2.p1.1">To further evaluate the efficacy of GaVaMoE’s components, we conducted a comprehensive ablation study across three diverse datasets. We compared the following variants:</p>
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">GaVaMoE[LLaMA3.1]</span>: Our full model, incorporating both the multi-gating mechanism and the enhanced MoE architecture.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">GaVaMoE[LLaMA3.1] w/o Multi-gating</span>: A variant that retains the MoE architecture but removes the multi-gating mechanism.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i3.p1.1.1">GaVaMoE[LLaMA3.1] w/o Fine-grained experts</span>: A variant that retains the multi-gating mechanism but removes the fine-grained experts.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i4.p1">
<p class="ltx_p" id="S4.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i4.p1.1.1">Base[LLaMA3.1]</span>: A baseline version using only the LLaMA 3.1 language model, without the multi-gating mechanism and MoE architecture.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i5.p1">
<p class="ltx_p" id="S4.I2.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i5.p1.1.1">GaVaMoE[GPT2]</span>: Uses GPT2 as the base language model while retaining our multi-gating and MoE components.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS5.SSS2.p1.2">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.F3" title="Figure 3 ‣ 4.5.1. Main Results ‣ 4.5. Results and Analysis ‣ 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> presents our ablation study results, comparing BLEU-4 and BERTScore metrics across three datasets. Key findings include:
(1) <span class="ltx_text ltx_font_bold" id="S4.SS5.SSS2.p1.2.1">Effectiveness of Multi-gating Mechanism and Fine-grained Experts</span>: GaVaMoE[LLaMA3.1] consistently outperformed its variants without multi-gating or fine-grained experts. For instance, on the Amazon dataset, GaVaMoE[LLaMA3.1] achieved a BLEU-4 score of 1.89, compared to 1.82 for the variant without multi-gating and 1.85 for the variant without fine-grained experts. This demonstrates the crucial role of both components in enhancing the quality and relevance of generated explanations.
(2) <span class="ltx_text ltx_font_bold" id="S4.SS5.SSS2.p1.2.2">Complementary Effects of Architectural Components</span>: The full GaVaMoE[LLaMA3.1] model demonstrated substantial improvements over Base[LLaMA3.1], with BERTScore increases of 7.6%, 8.1%, and 6.2% on TripAdvisor, Amazon, and Yelp datasets, respectively. This highlights the complementary benefits of the multi-gating mechanism for precise routing and the MoE structure for specialized processing.
(3) <span class="ltx_text ltx_font_bold" id="S4.SS5.SSS2.p1.2.3">Base Model Independence</span>: Interestingly, GaVaMoE[GPT2] showed competitive performance, outperforming most baseline models except XRec. This indicates that our multi-gating and MoE components provide substantial improvements even with smaller, less advanced language models.
(4) <span class="ltx_text ltx_font_bold" id="S4.SS5.SSS2.p1.2.4">Scalability</span>: Performance remained strong across different base model sizes. GaVaMoE[GPT2]’s BLEU-4 scores were only slightly lower than GaVaMoE[LLaMA3.1] (e.g., 1.76 vs. 1.89 on Amazon), showcasing the architecture’s flexibility across various computational settings.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS5.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.5.3. </span>Analysis of Multi-gating Mechanism</h4>
<div class="ltx_para" id="S4.SS5.SSS3.p1">
<p class="ltx_p" id="S4.SS5.SSS3.p1.1">To evaluate the impact of our multi-gating mechanism, we varied the number of gates from 2 to 5 across three datasets. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.T3" title="Table 3 ‣ 4.5.1. Main Results ‣ 4.5. Results and Analysis ‣ 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> shows distinct optimal gate configurations for each dataset: 3 gates for TripAdvisor, 2 gates for Amazon, and 3 gates for Yelp.</p>
</div>
<div class="ltx_para" id="S4.SS5.SSS3.p2">
<p class="ltx_p" id="S4.SS5.SSS3.p2.1">These variations in optimal gate numbers reflect the intricate relationship between dataset characteristics and model performance. With fewer gates, user-item collaborative preferences within each cluster tend to be more consistent, enabling better pattern learning and generalization. However, as the number of gates increases, data dispersion may introduce noise, potentially reducing the model’s generalization ability. The effectiveness of the multi-gating mechanism also depends on balanced data distribution across gates. An imbalance, such as one gate receiving significantly fewer items, can lead to incomplete training of both the gate and its associated experts, impacting overall performance.</p>
</div>
<div class="ltx_para" id="S4.SS5.SSS3.p3">
<p class="ltx_p" id="S4.SS5.SSS3.p3.1">Our analysis underscores the importance of tuning the number of gates based on dataset-specific characteristics. The optimal configuration balances capturing diverse user-item preferences with maintaining sufficient data consistency within clusters.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="282" id="S4.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.2.1.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S4.F4.3.2" style="font-size:90%;">Performance comparison across different sparsity levels (ds1, ds2, ds3). GaVaMoE demonstrates consistent superiority and stability across all sparsity levels.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="553" id="S4.F5.1.g1" src="x5.png" width="830"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="553" id="S4.F5.2.g1" src="x6.png" width="830"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="553" id="S4.F5.3.g1" src="x7.png" width="830"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="553" id="S4.F5.4.g1" src="x8.png" width="830"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.6.1.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="S4.F5.7.2" style="font-size:90%;">Visualization of latent space distributions in GaVaMoE for different numbers of user clusters.</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS5.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.5.4. </span>Analysis of Data Sparsity</h4>
<div class="ltx_para" id="S4.SS5.SSS4.p1">
<p class="ltx_p" id="S4.SS5.SSS4.p1.1">To evaluate GaVaMoE’s robustness against data sparsity, we conducted a comprehensive evaluation of GaVaMoE’s performance across varying levels of user-item interaction sparsity. Following methodologies from <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib27" title="">ma2024xrec, </a>)</cite> and <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib2" title="">cai2022pevae, </a>)</cite>, we divided the test data into three equal subsets (ds1, ds2, ds3) based on user appearance frequency in the training data. This division creates a spectrum of sparsity, with ds1 containing the most frequent users and ds3 the least frequent, allowing us to assess model performance under increasingly sparse conditions.</p>
</div>
<div class="ltx_para" id="S4.SS5.SSS4.p2">
<p class="ltx_p" id="S4.SS5.SSS4.p2.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.F4" title="Figure 4 ‣ 4.5.3. Analysis of Multi-gating Mechanism ‣ 4.5. Results and Analysis ‣ 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>, GaVaMoE consistently outperforms XRec and PEPLER across all sparsity levels in terms of BLEU-4 and BERTScore metrics. Notably, GaVaMoE’s performance remains stable from ds1 to ds3, indicating its effectiveness in handling sparse data scenarios.</p>
</div>
<div class="ltx_para" id="S4.SS5.SSS4.p3">
<p class="ltx_p" id="S4.SS5.SSS4.p3.1">The robustness of GaVaMoE can be attributed to its clustering and fine-grained expert models. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.F5" title="Figure 5 ‣ 4.5.3. Analysis of Multi-gating Mechanism ‣ 4.5. Results and Analysis ‣ 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a> visualizes the latent space distribution, demonstrating clear separation of user categories. This clustering approach is crucial for addressing data sparsity: when encountering users with limited interactions, the model leverages information from similar users within the same cluster, enabling personalized explanations even for sparse users.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6. </span>Human Evaluation</h3>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T4.2.1.1" style="font-size:90%;">Table 4</span>. </span><span class="ltx_text" id="S4.T4.3.2" style="font-size:90%;">The human evaluation results on the Yelp dataset.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.4.1.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.4.1.1.2">P</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.4.1.1.3">Q</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.4.1.1.4">U</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.4.1.1.5">Human Score</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.4.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.2.1.1">GaVaMoE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.2.1.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.2.1.2.1">4.524</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.2.1.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.2.1.3.1">4.553</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.2.1.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.2.1.4.1">4.541</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.2.1.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.2.1.5.1">4.538</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.3.2">
<td class="ltx_td ltx_align_center" id="S4.T4.4.3.2.1">XRec</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.3.2.2">4.390</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.3.2.3">4.287</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.3.2.4">4.252</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.3.2.5">4.317</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.3">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.4.3.1">PEPLER</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.4.3.2">3.766</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.4.3.3">3.652</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.4.3.4">3.773</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.4.3.5">3.734</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T5.2.1.1" style="font-size:90%;">Table 5</span>. </span><span class="ltx_text" id="S4.T5.3.2" style="font-size:90%;">Comparison of explanations generated by baselines and GaVaMoE under different user interaction scenarios. Case 1 represents a user with limited interaction history, while Case 2 represents a user with sufficient interactions.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T5.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.4.1.1">
<th class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T5.4.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T5.4.1.1.1.1">Case 1: Limited user-item interactions</span></th>
<th class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T5.4.1.1.2.1">Case 2: Sufficient user-item interactions</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.4.2.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" colspan="2" id="S4.T5.4.2.1.1"><span class="ltx_text ltx_font_bold" id="S4.T5.4.2.1.1.1">Ground Truth</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.4.3.2">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T5.4.3.2.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.4.3.2.1.1">
<span class="ltx_p" id="S4.T5.4.3.2.1.1.1" style="width:203.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.3.2.1.1.1.1">Text:</span> While undoubtedly a well-done and stunning movie.</span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" id="S4.T5.4.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.4.3.2.2.1">
<span class="ltx_p" id="S4.T5.4.3.2.2.1.1" style="width:203.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.3.2.2.1.1.1">Text:</span> J.K. Rowling’s magical world is beautifully brought to life in this fantasy film.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.4.4.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T5.4.4.3.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.4.4.3.1.1">
<span class="ltx_p" id="S4.T5.4.4.3.1.1.1" style="width:203.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.4.3.1.1.1.1">Features:</span> undoubtedly, stunning, movie</span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top" id="S4.T5.4.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.4.4.3.2.1">
<span class="ltx_p" id="S4.T5.4.4.3.2.1.1" style="width:203.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.4.3.2.1.1.1">Features:</span> J.K. Rowling, magic, fantasy, books</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.4.5.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" colspan="2" id="S4.T5.4.5.4.1"><span class="ltx_text ltx_font_bold" id="S4.T5.4.5.4.1.1">Generated Explanations</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.4.6.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T5.4.6.5.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.4.6.5.1.1">
<span class="ltx_p" id="S4.T5.4.6.5.1.1.1" style="width:203.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.6.5.1.1.1.1">PETER:</span> I think this film is a good movie.</span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" id="S4.T5.4.6.5.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.4.6.5.2.1">
<span class="ltx_p" id="S4.T5.4.6.5.2.1.1" style="width:203.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.6.5.2.1.1.1">PETER:</span> This fantasy movie is based on J.K. Rowling’s books.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.4.7.6">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T5.4.7.6.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.4.7.6.1.1">
<span class="ltx_p" id="S4.T5.4.7.6.1.1.1" style="width:203.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.7.6.1.1.1.1">PEPLER:</span> The film is a very good movie.</span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top" id="S4.T5.4.7.6.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.4.7.6.2.1">
<span class="ltx_p" id="S4.T5.4.7.6.2.1.1" style="width:203.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.7.6.2.1.1.1">PEPLER:</span> The film is fantasy based on J.K. Rowling’s books.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.4.8.7">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T5.4.8.7.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.4.8.7.1.1">
<span class="ltx_p" id="S4.T5.4.8.7.1.1.1" style="width:203.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.8.7.1.1.1.1">XRec:</span> While a well-done and stunning movie, it lacks depth and fails to engage.</span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top" id="S4.T5.4.8.7.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.4.8.7.2.1">
<span class="ltx_p" id="S4.T5.4.8.7.2.1.1" style="width:203.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.8.7.2.1.1.1">XRec:</span> J.K. Rowling’s magical world is vividly brought to life, offering a rich and immersive experience.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.4.9.8">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r" id="S4.T5.4.9.8.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.4.9.8.1.1">
<span class="ltx_p" id="S4.T5.4.9.8.1.1.1" style="width:203.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.9.8.1.1.1.1">GaVaMoE:</span> While undoubtedly a well-done and stunning movie, the visuals and performances are excellent.</span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb" id="S4.T5.4.9.8.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.4.9.8.2.1">
<span class="ltx_p" id="S4.T5.4.9.8.2.1.1" style="width:203.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.9.8.2.1.1.1">GaVaMoE:</span> J.K. Rowling’s magical world is beautifully brought to life in this fantasy film, with stunning visuals and a captivating story.</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.4">To validate GaVaMoE’s effectiveness in real-world scenarios, we conducted a human evaluation study using 2,000 randomly sampled entries from the Yelp dataset. We compared GaVaMoE against XRec and PEPLER, employing three professionals to assess the generated explanations based on personalization (P), text quality (Q), and user satisfaction (U). Each criterion was scored on a 1-to-5 scale, with details provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#A2" title="Appendix B Human scoring Criteria ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">B</span></a>. We computed a composite Human-Score using a weighted formula:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Human-Score}=\lambda_{p}P_{score}+\lambda_{q}Q_{score}+\lambda_{u}U_{score}" class="ltx_Math" display="block" id="S4.E14.m1.1"><semantics id="S4.E14.m1.1a"><mrow id="S4.E14.m1.1.1" xref="S4.E14.m1.1.1.cmml"><mtext id="S4.E14.m1.1.1.2" xref="S4.E14.m1.1.1.2a.cmml">Human-Score</mtext><mo id="S4.E14.m1.1.1.1" xref="S4.E14.m1.1.1.1.cmml">=</mo><mrow id="S4.E14.m1.1.1.3" xref="S4.E14.m1.1.1.3.cmml"><mrow id="S4.E14.m1.1.1.3.2" xref="S4.E14.m1.1.1.3.2.cmml"><msub id="S4.E14.m1.1.1.3.2.2" xref="S4.E14.m1.1.1.3.2.2.cmml"><mi id="S4.E14.m1.1.1.3.2.2.2" xref="S4.E14.m1.1.1.3.2.2.2.cmml">λ</mi><mi id="S4.E14.m1.1.1.3.2.2.3" xref="S4.E14.m1.1.1.3.2.2.3.cmml">p</mi></msub><mo id="S4.E14.m1.1.1.3.2.1" xref="S4.E14.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S4.E14.m1.1.1.3.2.3" xref="S4.E14.m1.1.1.3.2.3.cmml"><mi id="S4.E14.m1.1.1.3.2.3.2" xref="S4.E14.m1.1.1.3.2.3.2.cmml">P</mi><mrow id="S4.E14.m1.1.1.3.2.3.3" xref="S4.E14.m1.1.1.3.2.3.3.cmml"><mi id="S4.E14.m1.1.1.3.2.3.3.2" xref="S4.E14.m1.1.1.3.2.3.3.2.cmml">s</mi><mo id="S4.E14.m1.1.1.3.2.3.3.1" xref="S4.E14.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.3.2.3.3.3" xref="S4.E14.m1.1.1.3.2.3.3.3.cmml">c</mi><mo id="S4.E14.m1.1.1.3.2.3.3.1a" xref="S4.E14.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.3.2.3.3.4" xref="S4.E14.m1.1.1.3.2.3.3.4.cmml">o</mi><mo id="S4.E14.m1.1.1.3.2.3.3.1b" xref="S4.E14.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.3.2.3.3.5" xref="S4.E14.m1.1.1.3.2.3.3.5.cmml">r</mi><mo id="S4.E14.m1.1.1.3.2.3.3.1c" xref="S4.E14.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.3.2.3.3.6" xref="S4.E14.m1.1.1.3.2.3.3.6.cmml">e</mi></mrow></msub></mrow><mo id="S4.E14.m1.1.1.3.1" xref="S4.E14.m1.1.1.3.1.cmml">+</mo><mrow id="S4.E14.m1.1.1.3.3" xref="S4.E14.m1.1.1.3.3.cmml"><msub id="S4.E14.m1.1.1.3.3.2" xref="S4.E14.m1.1.1.3.3.2.cmml"><mi id="S4.E14.m1.1.1.3.3.2.2" xref="S4.E14.m1.1.1.3.3.2.2.cmml">λ</mi><mi id="S4.E14.m1.1.1.3.3.2.3" xref="S4.E14.m1.1.1.3.3.2.3.cmml">q</mi></msub><mo id="S4.E14.m1.1.1.3.3.1" xref="S4.E14.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S4.E14.m1.1.1.3.3.3" xref="S4.E14.m1.1.1.3.3.3.cmml"><mi id="S4.E14.m1.1.1.3.3.3.2" xref="S4.E14.m1.1.1.3.3.3.2.cmml">Q</mi><mrow id="S4.E14.m1.1.1.3.3.3.3" xref="S4.E14.m1.1.1.3.3.3.3.cmml"><mi id="S4.E14.m1.1.1.3.3.3.3.2" xref="S4.E14.m1.1.1.3.3.3.3.2.cmml">s</mi><mo id="S4.E14.m1.1.1.3.3.3.3.1" xref="S4.E14.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.3.3.3.3.3" xref="S4.E14.m1.1.1.3.3.3.3.3.cmml">c</mi><mo id="S4.E14.m1.1.1.3.3.3.3.1a" xref="S4.E14.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.3.3.3.3.4" xref="S4.E14.m1.1.1.3.3.3.3.4.cmml">o</mi><mo id="S4.E14.m1.1.1.3.3.3.3.1b" xref="S4.E14.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.3.3.3.3.5" xref="S4.E14.m1.1.1.3.3.3.3.5.cmml">r</mi><mo id="S4.E14.m1.1.1.3.3.3.3.1c" xref="S4.E14.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.3.3.3.3.6" xref="S4.E14.m1.1.1.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow><mo id="S4.E14.m1.1.1.3.1a" xref="S4.E14.m1.1.1.3.1.cmml">+</mo><mrow id="S4.E14.m1.1.1.3.4" xref="S4.E14.m1.1.1.3.4.cmml"><msub id="S4.E14.m1.1.1.3.4.2" xref="S4.E14.m1.1.1.3.4.2.cmml"><mi id="S4.E14.m1.1.1.3.4.2.2" xref="S4.E14.m1.1.1.3.4.2.2.cmml">λ</mi><mi id="S4.E14.m1.1.1.3.4.2.3" xref="S4.E14.m1.1.1.3.4.2.3.cmml">u</mi></msub><mo id="S4.E14.m1.1.1.3.4.1" xref="S4.E14.m1.1.1.3.4.1.cmml">⁢</mo><msub id="S4.E14.m1.1.1.3.4.3" xref="S4.E14.m1.1.1.3.4.3.cmml"><mi id="S4.E14.m1.1.1.3.4.3.2" xref="S4.E14.m1.1.1.3.4.3.2.cmml">U</mi><mrow id="S4.E14.m1.1.1.3.4.3.3" xref="S4.E14.m1.1.1.3.4.3.3.cmml"><mi id="S4.E14.m1.1.1.3.4.3.3.2" xref="S4.E14.m1.1.1.3.4.3.3.2.cmml">s</mi><mo id="S4.E14.m1.1.1.3.4.3.3.1" xref="S4.E14.m1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.3.4.3.3.3" xref="S4.E14.m1.1.1.3.4.3.3.3.cmml">c</mi><mo id="S4.E14.m1.1.1.3.4.3.3.1a" xref="S4.E14.m1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.3.4.3.3.4" xref="S4.E14.m1.1.1.3.4.3.3.4.cmml">o</mi><mo id="S4.E14.m1.1.1.3.4.3.3.1b" xref="S4.E14.m1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.3.4.3.3.5" xref="S4.E14.m1.1.1.3.4.3.3.5.cmml">r</mi><mo id="S4.E14.m1.1.1.3.4.3.3.1c" xref="S4.E14.m1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.3.4.3.3.6" xref="S4.E14.m1.1.1.3.4.3.3.6.cmml">e</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.1b"><apply id="S4.E14.m1.1.1.cmml" xref="S4.E14.m1.1.1"><eq id="S4.E14.m1.1.1.1.cmml" xref="S4.E14.m1.1.1.1"></eq><ci id="S4.E14.m1.1.1.2a.cmml" xref="S4.E14.m1.1.1.2"><mtext id="S4.E14.m1.1.1.2.cmml" xref="S4.E14.m1.1.1.2">Human-Score</mtext></ci><apply id="S4.E14.m1.1.1.3.cmml" xref="S4.E14.m1.1.1.3"><plus id="S4.E14.m1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.3.1"></plus><apply id="S4.E14.m1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.3.2"><times id="S4.E14.m1.1.1.3.2.1.cmml" xref="S4.E14.m1.1.1.3.2.1"></times><apply id="S4.E14.m1.1.1.3.2.2.cmml" xref="S4.E14.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.3.2.2.1.cmml" xref="S4.E14.m1.1.1.3.2.2">subscript</csymbol><ci id="S4.E14.m1.1.1.3.2.2.2.cmml" xref="S4.E14.m1.1.1.3.2.2.2">𝜆</ci><ci id="S4.E14.m1.1.1.3.2.2.3.cmml" xref="S4.E14.m1.1.1.3.2.2.3">𝑝</ci></apply><apply id="S4.E14.m1.1.1.3.2.3.cmml" xref="S4.E14.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.3.2.3.1.cmml" xref="S4.E14.m1.1.1.3.2.3">subscript</csymbol><ci id="S4.E14.m1.1.1.3.2.3.2.cmml" xref="S4.E14.m1.1.1.3.2.3.2">𝑃</ci><apply id="S4.E14.m1.1.1.3.2.3.3.cmml" xref="S4.E14.m1.1.1.3.2.3.3"><times id="S4.E14.m1.1.1.3.2.3.3.1.cmml" xref="S4.E14.m1.1.1.3.2.3.3.1"></times><ci id="S4.E14.m1.1.1.3.2.3.3.2.cmml" xref="S4.E14.m1.1.1.3.2.3.3.2">𝑠</ci><ci id="S4.E14.m1.1.1.3.2.3.3.3.cmml" xref="S4.E14.m1.1.1.3.2.3.3.3">𝑐</ci><ci id="S4.E14.m1.1.1.3.2.3.3.4.cmml" xref="S4.E14.m1.1.1.3.2.3.3.4">𝑜</ci><ci id="S4.E14.m1.1.1.3.2.3.3.5.cmml" xref="S4.E14.m1.1.1.3.2.3.3.5">𝑟</ci><ci id="S4.E14.m1.1.1.3.2.3.3.6.cmml" xref="S4.E14.m1.1.1.3.2.3.3.6">𝑒</ci></apply></apply></apply><apply id="S4.E14.m1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.3.3"><times id="S4.E14.m1.1.1.3.3.1.cmml" xref="S4.E14.m1.1.1.3.3.1"></times><apply id="S4.E14.m1.1.1.3.3.2.cmml" xref="S4.E14.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.3.3.2.1.cmml" xref="S4.E14.m1.1.1.3.3.2">subscript</csymbol><ci id="S4.E14.m1.1.1.3.3.2.2.cmml" xref="S4.E14.m1.1.1.3.3.2.2">𝜆</ci><ci id="S4.E14.m1.1.1.3.3.2.3.cmml" xref="S4.E14.m1.1.1.3.3.2.3">𝑞</ci></apply><apply id="S4.E14.m1.1.1.3.3.3.cmml" xref="S4.E14.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.3.3.3.1.cmml" xref="S4.E14.m1.1.1.3.3.3">subscript</csymbol><ci id="S4.E14.m1.1.1.3.3.3.2.cmml" xref="S4.E14.m1.1.1.3.3.3.2">𝑄</ci><apply id="S4.E14.m1.1.1.3.3.3.3.cmml" xref="S4.E14.m1.1.1.3.3.3.3"><times id="S4.E14.m1.1.1.3.3.3.3.1.cmml" xref="S4.E14.m1.1.1.3.3.3.3.1"></times><ci id="S4.E14.m1.1.1.3.3.3.3.2.cmml" xref="S4.E14.m1.1.1.3.3.3.3.2">𝑠</ci><ci id="S4.E14.m1.1.1.3.3.3.3.3.cmml" xref="S4.E14.m1.1.1.3.3.3.3.3">𝑐</ci><ci id="S4.E14.m1.1.1.3.3.3.3.4.cmml" xref="S4.E14.m1.1.1.3.3.3.3.4">𝑜</ci><ci id="S4.E14.m1.1.1.3.3.3.3.5.cmml" xref="S4.E14.m1.1.1.3.3.3.3.5">𝑟</ci><ci id="S4.E14.m1.1.1.3.3.3.3.6.cmml" xref="S4.E14.m1.1.1.3.3.3.3.6">𝑒</ci></apply></apply></apply><apply id="S4.E14.m1.1.1.3.4.cmml" xref="S4.E14.m1.1.1.3.4"><times id="S4.E14.m1.1.1.3.4.1.cmml" xref="S4.E14.m1.1.1.3.4.1"></times><apply id="S4.E14.m1.1.1.3.4.2.cmml" xref="S4.E14.m1.1.1.3.4.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.3.4.2.1.cmml" xref="S4.E14.m1.1.1.3.4.2">subscript</csymbol><ci id="S4.E14.m1.1.1.3.4.2.2.cmml" xref="S4.E14.m1.1.1.3.4.2.2">𝜆</ci><ci id="S4.E14.m1.1.1.3.4.2.3.cmml" xref="S4.E14.m1.1.1.3.4.2.3">𝑢</ci></apply><apply id="S4.E14.m1.1.1.3.4.3.cmml" xref="S4.E14.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.3.4.3.1.cmml" xref="S4.E14.m1.1.1.3.4.3">subscript</csymbol><ci id="S4.E14.m1.1.1.3.4.3.2.cmml" xref="S4.E14.m1.1.1.3.4.3.2">𝑈</ci><apply id="S4.E14.m1.1.1.3.4.3.3.cmml" xref="S4.E14.m1.1.1.3.4.3.3"><times id="S4.E14.m1.1.1.3.4.3.3.1.cmml" xref="S4.E14.m1.1.1.3.4.3.3.1"></times><ci id="S4.E14.m1.1.1.3.4.3.3.2.cmml" xref="S4.E14.m1.1.1.3.4.3.3.2">𝑠</ci><ci id="S4.E14.m1.1.1.3.4.3.3.3.cmml" xref="S4.E14.m1.1.1.3.4.3.3.3">𝑐</ci><ci id="S4.E14.m1.1.1.3.4.3.3.4.cmml" xref="S4.E14.m1.1.1.3.4.3.3.4">𝑜</ci><ci id="S4.E14.m1.1.1.3.4.3.3.5.cmml" xref="S4.E14.m1.1.1.3.4.3.3.5">𝑟</ci><ci id="S4.E14.m1.1.1.3.4.3.3.6.cmml" xref="S4.E14.m1.1.1.3.4.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.1c">\text{Human-Score}=\lambda_{p}P_{score}+\lambda_{q}Q_{score}+\lambda_{u}U_{score}</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.1d">Human-Score = italic_λ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_P start_POSTSUBSCRIPT italic_s italic_c italic_o italic_r italic_e end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_s italic_c italic_o italic_r italic_e end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_s italic_c italic_o italic_r italic_e end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS6.p1.3">Where <math alttext="\lambda_{p}=0.4" class="ltx_Math" display="inline" id="S4.SS6.p1.1.m1.1"><semantics id="S4.SS6.p1.1.m1.1a"><mrow id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml"><msub id="S4.SS6.p1.1.m1.1.1.2" xref="S4.SS6.p1.1.m1.1.1.2.cmml"><mi id="S4.SS6.p1.1.m1.1.1.2.2" xref="S4.SS6.p1.1.m1.1.1.2.2.cmml">λ</mi><mi id="S4.SS6.p1.1.m1.1.1.2.3" xref="S4.SS6.p1.1.m1.1.1.2.3.cmml">p</mi></msub><mo id="S4.SS6.p1.1.m1.1.1.1" xref="S4.SS6.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS6.p1.1.m1.1.1.3" xref="S4.SS6.p1.1.m1.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><apply id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1"><eq id="S4.SS6.p1.1.m1.1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1.1"></eq><apply id="S4.SS6.p1.1.m1.1.1.2.cmml" xref="S4.SS6.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS6.p1.1.m1.1.1.2.1.cmml" xref="S4.SS6.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS6.p1.1.m1.1.1.2.2.cmml" xref="S4.SS6.p1.1.m1.1.1.2.2">𝜆</ci><ci id="S4.SS6.p1.1.m1.1.1.2.3.cmml" xref="S4.SS6.p1.1.m1.1.1.2.3">𝑝</ci></apply><cn id="S4.SS6.p1.1.m1.1.1.3.cmml" type="float" xref="S4.SS6.p1.1.m1.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">\lambda_{p}=0.4</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = 0.4</annotation></semantics></math>, <math alttext="\lambda_{q}" class="ltx_Math" display="inline" id="S4.SS6.p1.2.m2.1"><semantics id="S4.SS6.p1.2.m2.1a"><msub id="S4.SS6.p1.2.m2.1.1" xref="S4.SS6.p1.2.m2.1.1.cmml"><mi id="S4.SS6.p1.2.m2.1.1.2" xref="S4.SS6.p1.2.m2.1.1.2.cmml">λ</mi><mi id="S4.SS6.p1.2.m2.1.1.3" xref="S4.SS6.p1.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.m2.1b"><apply id="S4.SS6.p1.2.m2.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.2.m2.1.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS6.p1.2.m2.1.1.2.cmml" xref="S4.SS6.p1.2.m2.1.1.2">𝜆</ci><ci id="S4.SS6.p1.2.m2.1.1.3.cmml" xref="S4.SS6.p1.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.2.m2.1c">\lambda_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.2.m2.1d">italic_λ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\lambda_{u}=0.3" class="ltx_Math" display="inline" id="S4.SS6.p1.3.m3.1"><semantics id="S4.SS6.p1.3.m3.1a"><mrow id="S4.SS6.p1.3.m3.1.1" xref="S4.SS6.p1.3.m3.1.1.cmml"><msub id="S4.SS6.p1.3.m3.1.1.2" xref="S4.SS6.p1.3.m3.1.1.2.cmml"><mi id="S4.SS6.p1.3.m3.1.1.2.2" xref="S4.SS6.p1.3.m3.1.1.2.2.cmml">λ</mi><mi id="S4.SS6.p1.3.m3.1.1.2.3" xref="S4.SS6.p1.3.m3.1.1.2.3.cmml">u</mi></msub><mo id="S4.SS6.p1.3.m3.1.1.1" xref="S4.SS6.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS6.p1.3.m3.1.1.3" xref="S4.SS6.p1.3.m3.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.3.m3.1b"><apply id="S4.SS6.p1.3.m3.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1"><eq id="S4.SS6.p1.3.m3.1.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1.1"></eq><apply id="S4.SS6.p1.3.m3.1.1.2.cmml" xref="S4.SS6.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS6.p1.3.m3.1.1.2.1.cmml" xref="S4.SS6.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS6.p1.3.m3.1.1.2.2.cmml" xref="S4.SS6.p1.3.m3.1.1.2.2">𝜆</ci><ci id="S4.SS6.p1.3.m3.1.1.2.3.cmml" xref="S4.SS6.p1.3.m3.1.1.2.3">𝑢</ci></apply><cn id="S4.SS6.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS6.p1.3.m3.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.3.m3.1c">\lambda_{u}=0.3</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.3.m3.1d">italic_λ start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = 0.3</annotation></semantics></math>. The scores P, Q, and U represent the metrics for personalization, text quality, and user satisfaction, respectively.</p>
</div>
<div class="ltx_para" id="S4.SS6.p2">
<p class="ltx_p" id="S4.SS6.p2.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.T4" title="Table 4 ‣ 4.6. Human Evaluation ‣ 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> presents these results, showing that GaVaMoE consistently outperformed baselines across all metrics. GaVaMoE achieved the highest overall Human-Score of 4.538, significantly surpassing XRec (4.317) and PEPLER (3.734). These human evaluation results corroborate our computational findings, demonstrating GaVaMoE’s ability to generate high-quality, personalized explanations that resonate with users in real-world scenarios.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Case Study</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">To further evaluate GaVaMoE’s effectiveness in generating personalized and relevant explanations, we conducted a detailed case study comparing our model’s performance with baseline methods under different user interaction scenarios. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#S4.T5" title="Table 5 ‣ 4.6. Human Evaluation ‣ 4. Experiment ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a> presents a comparative analysis of explanations generated by GaVaMoE and baseline methods under two distinct scenarios: limited and sufficient user-item interactions. GaVaMoE demonstrates superior performance across both cases, effectively addressing the challenges of data sparsity and personalization. In the limited interaction scenario (Case 1), GaVaMoE captures all key item features (”undoubtedly,” ”stunning,” ”movie”), showcasing its robustness in sparse data conditions. The model’s explanation closely mirrors the ground truth while adding relevant details about ”visuals and performances,” providing a more comprehensive insight. Similarly, in the sufficient interaction case (Case 2), GaVaMoE accurately captures the essence of J.K. Rowling’s magical world and the fantasy genre, demonstrating its ability to leverage richer user history. Across both scenarios, GaVaMoE maintains appropriate sentiment and context, avoiding the introduction of irrelevant or inaccurate information - a pitfall observed in some baseline methods like XRec. In contrast, PETER and PEPLER consistently produce generic statements lacking specific descriptors, highlighting GaVaMoE’s superior feature integration and contextual understanding. These observations underscore GaVaMoE’s effectiveness in generating highly personalized, contextually relevant, and informative explanations, regardless of the extent of user interaction history. The model’s performance aligns with our initial goals of enhancing explainable recommendations through improved collaborative preference modeling and personalization, particularly in scenarios with sparse user-item interactions.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we introduced GaVaMoE, a novel Gaussian-Variational Gated Mixture of Experts framework for explainable recommendation systems. GaVaMoE addresses critical challenges in existing LLM-based ER systems through two key innovations: (1) a rating reconstruction module employing VAE with GMM for capturing complex user-item collaborative preferences, and (2) a multi-gating mechanism coupled with expert models for generating personalized explanations. Our approach enhances collaborative preference modeling, improves personalization, and effectively handles data sparsity. Extensive experiments on three real-world datasets demonstrate that GaVaMoE significantly outperforms state-of-the-art methods across multiple metrics, including explanation quality, personalization, and consistency. Notably, GaVaMoE exhibits robust performance in sparse data scenarios, maintaining high-quality explanations even for users with limited historical data.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Qingyao Ai, Vahid Azizi, Xu Chen, and Yongfeng Zhang.

</span>
<span class="ltx_bibblock">Learning heterogeneous knowledge base embeddings for explainable recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Algorithms</span>, 11(9):137, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Zefeng Cai and Zerui Cai.

</span>
<span class="ltx_bibblock">Pevae: A hierarchical vae for personalized explainable recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</span>, pages 692–702, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Hanxiong Chen, Shaoyun Shi, Yunqi Li, and Yongfeng Zhang.

</span>
<span class="ltx_bibblock">Neural collaborative reasoning.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Proceedings of the Web Conference 2021</span>, pages 1516–1527, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Zhongxia Chen, Xiting Wang, Xing Xie, Tong Wu, Guoqing Bu, Yining Wang, and Enhong Chen.

</span>
<span class="ltx_bibblock">Co-attentive multi-task learning for explainable recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">IJCAI</span>, volume 2019, pages 2137–2143, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Damai Dai, Chengqi Deng, Chenggang Zhao, RX Xu, Huazuo Gao, Deli Chen, Jiashi Li, Wangding Zeng, Xingkai Yu, Y Wu, et al.

</span>
<span class="ltx_bibblock">Deepseekmoe: Towards ultimate expert specialization in mixture-of-experts language models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2401.06066</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, et al.

</span>
<span class="ltx_bibblock">The llama 3 herd of models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2407.21783</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
William Fedus, Barret Zoph, and Noam Shazeer.

</span>
<span class="ltx_bibblock">Switch transformers: Scaling to trillion parameter models with simple and efficient sparsity.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">Journal of Machine Learning Research</span>, 23(120):1–39, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Zuohui Fu, Yikun Xian, Ruoyuan Gao, Jieyu Zhao, Qiaoying Huang, Yingqiang Ge, Shuyuan Xu, Shijie Geng, Chirag Shah, Yongfeng Zhang, et al.

</span>
<span class="ltx_bibblock">Fairness-aware explainable recommendation over knowledge graphs.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 43rd international ACM SIGIR conference on research and development in information retrieval</span>, pages 69–78, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Jingyue Gao, Xiting Wang, Yasha Wang, and Xing Xie.

</span>
<span class="ltx_bibblock">Explainable recommendation through attentive multi-view learning.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</span>, volume 33, pages 3622–3629, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Deepesh V Hada and Shirish K Shevade.

</span>
<span class="ltx_bibblock">Rexplug: Explainable recommendation using plug-and-play language model.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Proceedings of the 44th International ACM SIGIR Conference on Research and Development in Information Retrieval</span>, pages 81–91, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Xiangnan He, Tao Chen, Min-Yen Kan, and Xiao Chen.

</span>
<span class="ltx_bibblock">Trirank: Review-aware explainable recommendation by modeling aspects.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">Proceedings of the 24th ACM international on conference on information and knowledge management</span>, pages 1661–1670, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Irina Higgins, Loic Matthey, Arka Pal, Christopher P Burgess, Xavier Glorot, Matthew M Botvinick, Shakir Mohamed, and Alexander Lerchner.

</span>
<span class="ltx_bibblock">beta-vae: Learning basic visual concepts with a constrained variational framework.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">ICLR (Poster)</span>, 3, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
S Hochreiter.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">Neural Computation MIT-Press</span>, 1997.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Robert A Jacobs, Michael I Jordan, Steven J Nowlan, and Geoffrey E Hinton.

</span>
<span class="ltx_bibblock">Adaptive mixtures of local experts.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">Neural computation</span>, 3(1):79–87, 1991.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Albert Q Jiang, Alexandre Sablayrolles, Antoine Roux, Arthur Mensch, Blanche Savary, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Emma Bou Hanna, Florian Bressand, et al.

</span>
<span class="ltx_bibblock">Mixtral of experts.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2401.04088</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Zhuxi Jiang, Yin Zheng, Huachun Tan, Bangsheng Tang, and Hanning Zhou.

</span>
<span class="ltx_bibblock">Variational deep embedding: An unsupervised and generative approach to clustering.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:1611.05148</span>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Diederik P Kingma.

</span>
<span class="ltx_bibblock">Auto-encoding variational bayes.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:1312.6114</span>, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Dmitry Lepikhin, HyoukJoong Lee, Yuanzhong Xu, Dehao Chen, Orhan Firat, Yanping Huang, Maxim Krikun, Noam Shazeer, and Zhifeng Chen.

</span>
<span class="ltx_bibblock">Gshard: Scaling giant models with conditional computation and automatic sharding.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2006.16668</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Lei Li, Yongfeng Zhang, and Li Chen.

</span>
<span class="ltx_bibblock">Generate neural template explanations for recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management</span>, pages 755–764, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Lei Li, Yongfeng Zhang, and Li Chen.

</span>
<span class="ltx_bibblock">Extra: Explanation ranking datasets for explainable recommendation, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Lei Li, Yongfeng Zhang, and Li Chen.

</span>
<span class="ltx_bibblock">Extra: Explanation ranking datasets for explainable recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 44th International ACM SIGIR conference on Research and Development in Information Retrieval</span>, pages 2463–2469, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Lei Li, Yongfeng Zhang, and Li Chen.

</span>
<span class="ltx_bibblock">Personalized transformer for explainable recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2105.11601</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Lei Li, Yongfeng Zhang, and Li Chen.

</span>
<span class="ltx_bibblock">Personalized prompt learning for explainable recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">ACM Transactions on Information Systems</span>, 41(4):1–26, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Piji Li, Zihao Wang, Zhaochun Ren, Lidong Bing, and Wai Lam.

</span>
<span class="ltx_bibblock">Neural rating regression with abstractive tips generation for recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">Proceedings of the 40th International ACM SIGIR conference on Research and Development in Information Retrieval</span>, pages 345–354, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Dawen Liang, Rahul G Krishnan, Matthew D Hoffman, and Tony Jebara.

</span>
<span class="ltx_bibblock">Variational autoencoders for collaborative filtering.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">Proceedings of the 2018 world wide web conference</span>, pages 689–698, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Chin-Yew Lin.

</span>
<span class="ltx_bibblock">Rouge: A package for automatic evaluation of summaries.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">Text summarization branches out</span>, pages 74–81, 2004.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Qiyao Ma, Xubin Ren, and Chao Huang.

</span>
<span class="ltx_bibblock">Xrec: Large language models for explainable recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2406.02377</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Kishore Papineni, Salim Roukos, Todd Ward, and Wei-Jing Zhu.

</span>
<span class="ltx_bibblock">Bleu: a method for automatic evaluation of machine translation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 40th annual meeting of the Association for Computational Linguistics</span>, pages 311–318, 2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et al.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">OpenAI blog</span>, 1(8):9, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Noam Shazeer, Azalia Mirhoseini, Krzysztof Maziarz, Andy Davis, Quoc Le, Geoffrey Hinton, and Jeff Dean.

</span>
<span class="ltx_bibblock">Outrageously large neural networks: The sparsely-gated mixture-of-experts layer.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:1701.06538</span>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Ilya Shenbin, Anton Alekseev, Elena Tutubalina, Valentin Malykh, and Sergey I Nikolenko.

</span>
<span class="ltx_bibblock">Recvae: A new variational autoencoder for top-n recommendations with implicit feedback.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 13th international conference on web search and data mining</span>, pages 528–536, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Shaoyun Shi, Hanxiong Chen, Weizhi Ma, Jiaxin Mao, Min Zhang, and Yongfeng Zhang.

</span>
<span class="ltx_bibblock">Neural logic reasoning.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management</span>, pages 1365–1374, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Juntao Tan, Shuyuan Xu, Yingqiang Ge, Yunqi Li, Xu Chen, and Yongfeng Zhang.

</span>
<span class="ltx_bibblock">Counterfactual explainable recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 30th ACM International Conference on Information &amp; Knowledge Management</span>, pages 1784–1793, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Yi Tay, Anh Tuan Luu, and Siu Cheung Hui.

</span>
<span class="ltx_bibblock">Multi-pointer co-attention networks for recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</span>, pages 2309–2318, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Gemini Team, Rohan Anil, Sebastian Borgeaud, Yonghui Wu, Jean-Baptiste Alayrac, Jiahui Yu, Radu Soricut, Johan Schalkwyk, Andrew M Dai, Anja Hauth, et al.

</span>
<span class="ltx_bibblock">Gemini: a family of highly capable multimodal models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2312.11805</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Nava Tintarev and Judith Masthoff.

</span>
<span class="ltx_bibblock">Explaining recommendations: Design and evaluation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">Recommender systems handbook</span>, pages 353–382. Springer, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2302.13971</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
A Vaswani.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib38.1.1">Advances in Neural Information Processing Systems</span>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Xiang Wang, Xiangnan He, Fuli Feng, Liqiang Nie, and Tat-Seng Chua.

</span>
<span class="ltx_bibblock">Tem: Tree-enhanced embedding model for explainable recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib39.1.1">Proceedings of the 2018 world wide web conference</span>, pages 1543–1552, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Yikun Xian, Zuohui Fu, Shan Muthukrishnan, Gerard De Melo, and Yongfeng Zhang.

</span>
<span class="ltx_bibblock">Reinforcement knowledge graph reasoning for explainable recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib40.1.1">Proceedings of the 42nd international ACM SIGIR conference on research and development in information retrieval</span>, pages 285–294, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Zhouhang Xie, Sameer Singh, Julian McAuley, and Bodhisattwa Prasad Majumder.

</span>
<span class="ltx_bibblock">Factual and informative review generation for explainable recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</span>, volume 37, pages 13816–13824, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Mengyuan Yang, Mengying Zhu, Yan Wang, Linxun Chen, Yilei Zhao, Xiuyuan Wang, Bing Han, Xiaolin Zheng, and Jianwei Yin.

</span>
<span class="ltx_bibblock">Fine-tuning large language model based explainable recommendation with explainable quality reward.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</span>, volume 38, pages 9250–9259, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Tianyi Zhang, Varsha Kishore, Felix Wu, Kilian Q Weinberger, and Yoav Artzi.

</span>
<span class="ltx_bibblock">Bertscore: Evaluating text generation with bert.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:1904.09675</span>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Yongfeng Zhang.

</span>
<span class="ltx_bibblock">Tutorial on explainable recommendation and search.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">Proceedings of the 2019 ACM SIGIR International Conference on Theory of Information Retrieval</span>, pages 255–256, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Yongfeng Zhang, Xu Chen, et al.

</span>
<span class="ltx_bibblock">Explainable recommendation: A survey and new perspectives.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">Foundations and Trends® in Information Retrieval</span>, 14(1):1–101, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Yongfeng Zhang, Guokun Lai, Min Zhang, Yi Zhang, Yiqun Liu, and Shaoping Ma.

</span>
<span class="ltx_bibblock">Explicit factor models for explainable recommendation based on phrase-level sentiment analysis.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib46.1.1">Proceedings of the 37th international ACM SIGIR conference on Research &amp; development in information retrieval</span>, pages 83–92, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Tong Zhu, Xiaoye Qu, Daize Dong, Jiacheng Ruan, Jingqi Tong, Conghui He, and Yu Cheng.

</span>
<span class="ltx_bibblock">Llama-moe: Building mixture-of-experts from llama with continual pre-training.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib47.1.1">arXiv preprint arXiv:2406.16554</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Barret Zoph, Irwan Bello, Sameer Kumar, Nan Du, Yanping Huang, Jeff Dean, Noam Shazeer, and William Fedus.

</span>
<span class="ltx_bibblock">St-moe: Designing stable and transferable sparse expert models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:2202.08906</span>, 2022.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>ELBO in GaVaMoE</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In GaVaMoE, our objective is to maximize the likelihood of user-item pairs, equivalent to maximizing <math alttext="\log p(x)" class="ltx_Math" display="inline" id="A1.p1.1.m1.1"><semantics id="A1.p1.1.m1.1a"><mrow id="A1.p1.1.m1.1.2" xref="A1.p1.1.m1.1.2.cmml"><mrow id="A1.p1.1.m1.1.2.2" xref="A1.p1.1.m1.1.2.2.cmml"><mi id="A1.p1.1.m1.1.2.2.1" xref="A1.p1.1.m1.1.2.2.1.cmml">log</mi><mo id="A1.p1.1.m1.1.2.2a" lspace="0.167em" xref="A1.p1.1.m1.1.2.2.cmml">⁡</mo><mi id="A1.p1.1.m1.1.2.2.2" xref="A1.p1.1.m1.1.2.2.2.cmml">p</mi></mrow><mo id="A1.p1.1.m1.1.2.1" xref="A1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="A1.p1.1.m1.1.2.3.2" xref="A1.p1.1.m1.1.2.cmml"><mo id="A1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="A1.p1.1.m1.1.2.cmml">(</mo><mi id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">x</mi><mo id="A1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="A1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.2.cmml" xref="A1.p1.1.m1.1.2"><times id="A1.p1.1.m1.1.2.1.cmml" xref="A1.p1.1.m1.1.2.1"></times><apply id="A1.p1.1.m1.1.2.2.cmml" xref="A1.p1.1.m1.1.2.2"><log id="A1.p1.1.m1.1.2.2.1.cmml" xref="A1.p1.1.m1.1.2.2.1"></log><ci id="A1.p1.1.m1.1.2.2.2.cmml" xref="A1.p1.1.m1.1.2.2.2">𝑝</ci></apply><ci id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">\log p(x)</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">roman_log italic_p ( italic_x )</annotation></semantics></math>. Adopting Jensen’s inequality, we derive the variational evidence lower bound (ELBO) as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A1.E15">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E15X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="4"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{ELBO}(x)" class="ltx_Math" display="inline" id="A1.E15X.2.1.1.m1.1"><semantics id="A1.E15X.2.1.1.m1.1a"><mrow id="A1.E15X.2.1.1.m1.1.2" xref="A1.E15X.2.1.1.m1.1.2.cmml"><msub id="A1.E15X.2.1.1.m1.1.2.2" xref="A1.E15X.2.1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E15X.2.1.1.m1.1.2.2.2" xref="A1.E15X.2.1.1.m1.1.2.2.2.cmml">ℒ</mi><mrow id="A1.E15X.2.1.1.m1.1.2.2.3" xref="A1.E15X.2.1.1.m1.1.2.2.3.cmml"><mi id="A1.E15X.2.1.1.m1.1.2.2.3.2" xref="A1.E15X.2.1.1.m1.1.2.2.3.2.cmml">E</mi><mo id="A1.E15X.2.1.1.m1.1.2.2.3.1" xref="A1.E15X.2.1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="A1.E15X.2.1.1.m1.1.2.2.3.3" xref="A1.E15X.2.1.1.m1.1.2.2.3.3.cmml">L</mi><mo id="A1.E15X.2.1.1.m1.1.2.2.3.1a" xref="A1.E15X.2.1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="A1.E15X.2.1.1.m1.1.2.2.3.4" xref="A1.E15X.2.1.1.m1.1.2.2.3.4.cmml">B</mi><mo id="A1.E15X.2.1.1.m1.1.2.2.3.1b" xref="A1.E15X.2.1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="A1.E15X.2.1.1.m1.1.2.2.3.5" xref="A1.E15X.2.1.1.m1.1.2.2.3.5.cmml">O</mi></mrow></msub><mo id="A1.E15X.2.1.1.m1.1.2.1" xref="A1.E15X.2.1.1.m1.1.2.1.cmml">⁢</mo><mrow id="A1.E15X.2.1.1.m1.1.2.3.2" xref="A1.E15X.2.1.1.m1.1.2.cmml"><mo id="A1.E15X.2.1.1.m1.1.2.3.2.1" stretchy="false" xref="A1.E15X.2.1.1.m1.1.2.cmml">(</mo><mi id="A1.E15X.2.1.1.m1.1.1" xref="A1.E15X.2.1.1.m1.1.1.cmml">x</mi><mo id="A1.E15X.2.1.1.m1.1.2.3.2.2" stretchy="false" xref="A1.E15X.2.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E15X.2.1.1.m1.1b"><apply id="A1.E15X.2.1.1.m1.1.2.cmml" xref="A1.E15X.2.1.1.m1.1.2"><times id="A1.E15X.2.1.1.m1.1.2.1.cmml" xref="A1.E15X.2.1.1.m1.1.2.1"></times><apply id="A1.E15X.2.1.1.m1.1.2.2.cmml" xref="A1.E15X.2.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="A1.E15X.2.1.1.m1.1.2.2.1.cmml" xref="A1.E15X.2.1.1.m1.1.2.2">subscript</csymbol><ci id="A1.E15X.2.1.1.m1.1.2.2.2.cmml" xref="A1.E15X.2.1.1.m1.1.2.2.2">ℒ</ci><apply id="A1.E15X.2.1.1.m1.1.2.2.3.cmml" xref="A1.E15X.2.1.1.m1.1.2.2.3"><times id="A1.E15X.2.1.1.m1.1.2.2.3.1.cmml" xref="A1.E15X.2.1.1.m1.1.2.2.3.1"></times><ci id="A1.E15X.2.1.1.m1.1.2.2.3.2.cmml" xref="A1.E15X.2.1.1.m1.1.2.2.3.2">𝐸</ci><ci id="A1.E15X.2.1.1.m1.1.2.2.3.3.cmml" xref="A1.E15X.2.1.1.m1.1.2.2.3.3">𝐿</ci><ci id="A1.E15X.2.1.1.m1.1.2.2.3.4.cmml" xref="A1.E15X.2.1.1.m1.1.2.2.3.4">𝐵</ci><ci id="A1.E15X.2.1.1.m1.1.2.2.3.5.cmml" xref="A1.E15X.2.1.1.m1.1.2.2.3.5">𝑂</ci></apply></apply><ci id="A1.E15X.2.1.1.m1.1.1.cmml" xref="A1.E15X.2.1.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15X.2.1.1.m1.1c">\displaystyle\mathcal{L}_{ELBO}(x)</annotation><annotation encoding="application/x-llamapun" id="A1.E15X.2.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_E italic_L italic_B italic_O end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}_{q(z,c|x)}\left[\log\frac{p(c,z,x)}{q(z,c|x)}\right]" class="ltx_Math" display="inline" id="A1.E15X.3.2.2.m1.8"><semantics id="A1.E15X.3.2.2.m1.8a"><mrow id="A1.E15X.3.2.2.m1.8.8" xref="A1.E15X.3.2.2.m1.8.8.cmml"><mi id="A1.E15X.3.2.2.m1.8.8.3" xref="A1.E15X.3.2.2.m1.8.8.3.cmml"></mi><mo id="A1.E15X.3.2.2.m1.8.8.2" xref="A1.E15X.3.2.2.m1.8.8.2.cmml">=</mo><mrow id="A1.E15X.3.2.2.m1.8.8.1" xref="A1.E15X.3.2.2.m1.8.8.1.cmml"><msub id="A1.E15X.3.2.2.m1.8.8.1.3" xref="A1.E15X.3.2.2.m1.8.8.1.3.cmml"><mi id="A1.E15X.3.2.2.m1.8.8.1.3.2" xref="A1.E15X.3.2.2.m1.8.8.1.3.2.cmml">𝔼</mi><mrow id="A1.E15X.3.2.2.m1.2.2.2" xref="A1.E15X.3.2.2.m1.2.2.2.cmml"><mi id="A1.E15X.3.2.2.m1.2.2.2.4" xref="A1.E15X.3.2.2.m1.2.2.2.4.cmml">q</mi><mo id="A1.E15X.3.2.2.m1.2.2.2.3" xref="A1.E15X.3.2.2.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.E15X.3.2.2.m1.2.2.2.2.1" xref="A1.E15X.3.2.2.m1.2.2.2.2.2.cmml"><mo id="A1.E15X.3.2.2.m1.2.2.2.2.1.2" stretchy="false" xref="A1.E15X.3.2.2.m1.2.2.2.2.2.cmml">(</mo><mi id="A1.E15X.3.2.2.m1.1.1.1.1" xref="A1.E15X.3.2.2.m1.1.1.1.1.cmml">z</mi><mo id="A1.E15X.3.2.2.m1.2.2.2.2.1.3" xref="A1.E15X.3.2.2.m1.2.2.2.2.2.cmml">,</mo><mrow id="A1.E15X.3.2.2.m1.2.2.2.2.1.1" xref="A1.E15X.3.2.2.m1.2.2.2.2.1.1.cmml"><mi id="A1.E15X.3.2.2.m1.2.2.2.2.1.1.2" xref="A1.E15X.3.2.2.m1.2.2.2.2.1.1.2.cmml">c</mi><mo fence="false" id="A1.E15X.3.2.2.m1.2.2.2.2.1.1.1" xref="A1.E15X.3.2.2.m1.2.2.2.2.1.1.1.cmml">|</mo><mi id="A1.E15X.3.2.2.m1.2.2.2.2.1.1.3" xref="A1.E15X.3.2.2.m1.2.2.2.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E15X.3.2.2.m1.2.2.2.2.1.4" stretchy="false" xref="A1.E15X.3.2.2.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow></msub><mo id="A1.E15X.3.2.2.m1.8.8.1.2" xref="A1.E15X.3.2.2.m1.8.8.1.2.cmml">⁢</mo><mrow id="A1.E15X.3.2.2.m1.8.8.1.1.1" xref="A1.E15X.3.2.2.m1.8.8.1.1.2.cmml"><mo id="A1.E15X.3.2.2.m1.8.8.1.1.1.2" xref="A1.E15X.3.2.2.m1.8.8.1.1.2.1.cmml">[</mo><mrow id="A1.E15X.3.2.2.m1.8.8.1.1.1.1" xref="A1.E15X.3.2.2.m1.8.8.1.1.1.1.cmml"><mi id="A1.E15X.3.2.2.m1.8.8.1.1.1.1.1" xref="A1.E15X.3.2.2.m1.8.8.1.1.1.1.1.cmml">log</mi><mo id="A1.E15X.3.2.2.m1.8.8.1.1.1.1a" lspace="0.167em" xref="A1.E15X.3.2.2.m1.8.8.1.1.1.1.cmml">⁡</mo><mstyle displaystyle="true" id="A1.E15X.3.2.2.m1.7.7" xref="A1.E15X.3.2.2.m1.7.7.cmml"><mfrac id="A1.E15X.3.2.2.m1.7.7a" xref="A1.E15X.3.2.2.m1.7.7.cmml"><mrow id="A1.E15X.3.2.2.m1.5.5.3" xref="A1.E15X.3.2.2.m1.5.5.3.cmml"><mi id="A1.E15X.3.2.2.m1.5.5.3.5" xref="A1.E15X.3.2.2.m1.5.5.3.5.cmml">p</mi><mo id="A1.E15X.3.2.2.m1.5.5.3.4" xref="A1.E15X.3.2.2.m1.5.5.3.4.cmml">⁢</mo><mrow id="A1.E15X.3.2.2.m1.5.5.3.6.2" xref="A1.E15X.3.2.2.m1.5.5.3.6.1.cmml"><mo id="A1.E15X.3.2.2.m1.5.5.3.6.2.1" stretchy="false" xref="A1.E15X.3.2.2.m1.5.5.3.6.1.cmml">(</mo><mi id="A1.E15X.3.2.2.m1.3.3.1.1" xref="A1.E15X.3.2.2.m1.3.3.1.1.cmml">c</mi><mo id="A1.E15X.3.2.2.m1.5.5.3.6.2.2" xref="A1.E15X.3.2.2.m1.5.5.3.6.1.cmml">,</mo><mi id="A1.E15X.3.2.2.m1.4.4.2.2" xref="A1.E15X.3.2.2.m1.4.4.2.2.cmml">z</mi><mo id="A1.E15X.3.2.2.m1.5.5.3.6.2.3" xref="A1.E15X.3.2.2.m1.5.5.3.6.1.cmml">,</mo><mi id="A1.E15X.3.2.2.m1.5.5.3.3" xref="A1.E15X.3.2.2.m1.5.5.3.3.cmml">x</mi><mo id="A1.E15X.3.2.2.m1.5.5.3.6.2.4" stretchy="false" xref="A1.E15X.3.2.2.m1.5.5.3.6.1.cmml">)</mo></mrow></mrow><mrow id="A1.E15X.3.2.2.m1.7.7.5" xref="A1.E15X.3.2.2.m1.7.7.5.cmml"><mi id="A1.E15X.3.2.2.m1.7.7.5.4" xref="A1.E15X.3.2.2.m1.7.7.5.4.cmml">q</mi><mo id="A1.E15X.3.2.2.m1.7.7.5.3" xref="A1.E15X.3.2.2.m1.7.7.5.3.cmml">⁢</mo><mrow id="A1.E15X.3.2.2.m1.7.7.5.2.1" xref="A1.E15X.3.2.2.m1.7.7.5.2.2.cmml"><mo id="A1.E15X.3.2.2.m1.7.7.5.2.1.2" stretchy="false" xref="A1.E15X.3.2.2.m1.7.7.5.2.2.cmml">(</mo><mi id="A1.E15X.3.2.2.m1.6.6.4.1" xref="A1.E15X.3.2.2.m1.6.6.4.1.cmml">z</mi><mo id="A1.E15X.3.2.2.m1.7.7.5.2.1.3" xref="A1.E15X.3.2.2.m1.7.7.5.2.2.cmml">,</mo><mrow id="A1.E15X.3.2.2.m1.7.7.5.2.1.1" xref="A1.E15X.3.2.2.m1.7.7.5.2.1.1.cmml"><mi id="A1.E15X.3.2.2.m1.7.7.5.2.1.1.2" xref="A1.E15X.3.2.2.m1.7.7.5.2.1.1.2.cmml">c</mi><mo fence="false" id="A1.E15X.3.2.2.m1.7.7.5.2.1.1.1" xref="A1.E15X.3.2.2.m1.7.7.5.2.1.1.1.cmml">|</mo><mi id="A1.E15X.3.2.2.m1.7.7.5.2.1.1.3" xref="A1.E15X.3.2.2.m1.7.7.5.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E15X.3.2.2.m1.7.7.5.2.1.4" stretchy="false" xref="A1.E15X.3.2.2.m1.7.7.5.2.2.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="A1.E15X.3.2.2.m1.8.8.1.1.1.3" xref="A1.E15X.3.2.2.m1.8.8.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E15X.3.2.2.m1.8b"><apply id="A1.E15X.3.2.2.m1.8.8.cmml" xref="A1.E15X.3.2.2.m1.8.8"><eq id="A1.E15X.3.2.2.m1.8.8.2.cmml" xref="A1.E15X.3.2.2.m1.8.8.2"></eq><csymbol cd="latexml" id="A1.E15X.3.2.2.m1.8.8.3.cmml" xref="A1.E15X.3.2.2.m1.8.8.3">absent</csymbol><apply id="A1.E15X.3.2.2.m1.8.8.1.cmml" xref="A1.E15X.3.2.2.m1.8.8.1"><times id="A1.E15X.3.2.2.m1.8.8.1.2.cmml" xref="A1.E15X.3.2.2.m1.8.8.1.2"></times><apply id="A1.E15X.3.2.2.m1.8.8.1.3.cmml" xref="A1.E15X.3.2.2.m1.8.8.1.3"><csymbol cd="ambiguous" id="A1.E15X.3.2.2.m1.8.8.1.3.1.cmml" xref="A1.E15X.3.2.2.m1.8.8.1.3">subscript</csymbol><ci id="A1.E15X.3.2.2.m1.8.8.1.3.2.cmml" xref="A1.E15X.3.2.2.m1.8.8.1.3.2">𝔼</ci><apply id="A1.E15X.3.2.2.m1.2.2.2.cmml" xref="A1.E15X.3.2.2.m1.2.2.2"><times id="A1.E15X.3.2.2.m1.2.2.2.3.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.3"></times><ci id="A1.E15X.3.2.2.m1.2.2.2.4.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.4">𝑞</ci><interval closure="open" id="A1.E15X.3.2.2.m1.2.2.2.2.2.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.2.1"><ci id="A1.E15X.3.2.2.m1.1.1.1.1.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.1">𝑧</ci><apply id="A1.E15X.3.2.2.m1.2.2.2.2.1.1.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.E15X.3.2.2.m1.2.2.2.2.1.1.1.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.2.1.1.1">conditional</csymbol><ci id="A1.E15X.3.2.2.m1.2.2.2.2.1.1.2.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.2.1.1.2">𝑐</ci><ci id="A1.E15X.3.2.2.m1.2.2.2.2.1.1.3.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.2.1.1.3">𝑥</ci></apply></interval></apply></apply><apply id="A1.E15X.3.2.2.m1.8.8.1.1.2.cmml" xref="A1.E15X.3.2.2.m1.8.8.1.1.1"><csymbol cd="latexml" id="A1.E15X.3.2.2.m1.8.8.1.1.2.1.cmml" xref="A1.E15X.3.2.2.m1.8.8.1.1.1.2">delimited-[]</csymbol><apply id="A1.E15X.3.2.2.m1.8.8.1.1.1.1.cmml" xref="A1.E15X.3.2.2.m1.8.8.1.1.1.1"><log id="A1.E15X.3.2.2.m1.8.8.1.1.1.1.1.cmml" xref="A1.E15X.3.2.2.m1.8.8.1.1.1.1.1"></log><apply id="A1.E15X.3.2.2.m1.7.7.cmml" xref="A1.E15X.3.2.2.m1.7.7"><divide id="A1.E15X.3.2.2.m1.7.7.6.cmml" xref="A1.E15X.3.2.2.m1.7.7"></divide><apply id="A1.E15X.3.2.2.m1.5.5.3.cmml" xref="A1.E15X.3.2.2.m1.5.5.3"><times id="A1.E15X.3.2.2.m1.5.5.3.4.cmml" xref="A1.E15X.3.2.2.m1.5.5.3.4"></times><ci id="A1.E15X.3.2.2.m1.5.5.3.5.cmml" xref="A1.E15X.3.2.2.m1.5.5.3.5">𝑝</ci><vector id="A1.E15X.3.2.2.m1.5.5.3.6.1.cmml" xref="A1.E15X.3.2.2.m1.5.5.3.6.2"><ci id="A1.E15X.3.2.2.m1.3.3.1.1.cmml" xref="A1.E15X.3.2.2.m1.3.3.1.1">𝑐</ci><ci id="A1.E15X.3.2.2.m1.4.4.2.2.cmml" xref="A1.E15X.3.2.2.m1.4.4.2.2">𝑧</ci><ci id="A1.E15X.3.2.2.m1.5.5.3.3.cmml" xref="A1.E15X.3.2.2.m1.5.5.3.3">𝑥</ci></vector></apply><apply id="A1.E15X.3.2.2.m1.7.7.5.cmml" xref="A1.E15X.3.2.2.m1.7.7.5"><times id="A1.E15X.3.2.2.m1.7.7.5.3.cmml" xref="A1.E15X.3.2.2.m1.7.7.5.3"></times><ci id="A1.E15X.3.2.2.m1.7.7.5.4.cmml" xref="A1.E15X.3.2.2.m1.7.7.5.4">𝑞</ci><interval closure="open" id="A1.E15X.3.2.2.m1.7.7.5.2.2.cmml" xref="A1.E15X.3.2.2.m1.7.7.5.2.1"><ci id="A1.E15X.3.2.2.m1.6.6.4.1.cmml" xref="A1.E15X.3.2.2.m1.6.6.4.1">𝑧</ci><apply id="A1.E15X.3.2.2.m1.7.7.5.2.1.1.cmml" xref="A1.E15X.3.2.2.m1.7.7.5.2.1.1"><csymbol cd="latexml" id="A1.E15X.3.2.2.m1.7.7.5.2.1.1.1.cmml" xref="A1.E15X.3.2.2.m1.7.7.5.2.1.1.1">conditional</csymbol><ci id="A1.E15X.3.2.2.m1.7.7.5.2.1.1.2.cmml" xref="A1.E15X.3.2.2.m1.7.7.5.2.1.1.2">𝑐</ci><ci id="A1.E15X.3.2.2.m1.7.7.5.2.1.1.3.cmml" xref="A1.E15X.3.2.2.m1.7.7.5.2.1.1.3">𝑥</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15X.3.2.2.m1.8c">\displaystyle=\mathbb{E}_{q(z,c|x)}\left[\log\frac{p(c,z,x)}{q(z,c|x)}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.E15X.3.2.2.m1.8d">= blackboard_E start_POSTSUBSCRIPT italic_q ( italic_z , italic_c | italic_x ) end_POSTSUBSCRIPT [ roman_log divide start_ARG italic_p ( italic_c , italic_z , italic_x ) end_ARG start_ARG italic_q ( italic_z , italic_c | italic_x ) end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E15Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}_{q(z,c|x)}\left[\log p(x|z)+\log p(z|c)+\log p(c)%
\right]-" class="ltx_Math" display="inline" id="A1.E15Xa.2.1.1.m1.4"><semantics id="A1.E15Xa.2.1.1.m1.4a"><mrow id="A1.E15Xa.2.1.1.m1.4.4" xref="A1.E15Xa.2.1.1.m1.4.4.cmml"><mi id="A1.E15Xa.2.1.1.m1.4.4.3" xref="A1.E15Xa.2.1.1.m1.4.4.3.cmml"></mi><mo id="A1.E15Xa.2.1.1.m1.4.4.2" xref="A1.E15Xa.2.1.1.m1.4.4.2.cmml">=</mo><mrow id="A1.E15Xa.2.1.1.m1.4.4.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.cmml"><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.cmml"><msub id="A1.E15Xa.2.1.1.m1.4.4.1.1.3" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.3.cmml"><mi id="A1.E15Xa.2.1.1.m1.4.4.1.1.3.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.3.2.cmml">𝔼</mi><mrow id="A1.E15Xa.2.1.1.m1.2.2.2" xref="A1.E15Xa.2.1.1.m1.2.2.2.cmml"><mi id="A1.E15Xa.2.1.1.m1.2.2.2.4" xref="A1.E15Xa.2.1.1.m1.2.2.2.4.cmml">q</mi><mo id="A1.E15Xa.2.1.1.m1.2.2.2.3" xref="A1.E15Xa.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.E15Xa.2.1.1.m1.2.2.2.2.1" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.2.cmml"><mo id="A1.E15Xa.2.1.1.m1.2.2.2.2.1.2" stretchy="false" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.2.cmml">(</mo><mi id="A1.E15Xa.2.1.1.m1.1.1.1.1" xref="A1.E15Xa.2.1.1.m1.1.1.1.1.cmml">z</mi><mo id="A1.E15Xa.2.1.1.m1.2.2.2.2.1.3" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.2.cmml">,</mo><mrow id="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.cmml"><mi id="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.2" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.2.cmml">c</mi><mo fence="false" id="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.1" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml">|</mo><mi id="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.3" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E15Xa.2.1.1.m1.2.2.2.2.1.4" stretchy="false" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow></msub><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.2.cmml">⁢</mo><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.2.cmml"><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.2.1.cmml">[</mo><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.cmml"><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3a" lspace="0.167em" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">z</mi></mrow><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.3" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.3.cmml">+</mo><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml"><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3.cmml"><mi id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3a" lspace="0.167em" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3.cmml">⁡</mo><mi id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3.2.cmml">p</mi></mrow><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.cmml"><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.cmml"><mi id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.2.cmml">z</mi><mo fence="false" id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.cmml">|</mo><mi id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.3" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.3.cmml">c</mi></mrow><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.3a" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.3.cmml">+</mo><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.cmml"><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2.cmml"><mi id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2.1.cmml">log</mi><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2a" lspace="0.167em" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2.cmml">⁡</mo><mi id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2.2.cmml">p</mi></mrow><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.1" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.1.cmml">⁢</mo><mrow id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.3.2" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.cmml"><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.3.2.1" stretchy="false" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.cmml">(</mo><mi id="A1.E15Xa.2.1.1.m1.3.3" xref="A1.E15Xa.2.1.1.m1.3.3.cmml">c</mi><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.3.2.2" stretchy="false" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.3" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E15Xa.2.1.1.m1.4.4.1.3" xref="A1.E15Xa.2.1.1.m1.4.4.1.3.cmml">−</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E15Xa.2.1.1.m1.4b"><apply id="A1.E15Xa.2.1.1.m1.4.4.cmml" xref="A1.E15Xa.2.1.1.m1.4.4"><eq id="A1.E15Xa.2.1.1.m1.4.4.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.2"></eq><csymbol cd="latexml" id="A1.E15Xa.2.1.1.m1.4.4.3.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.3">absent</csymbol><apply id="A1.E15Xa.2.1.1.m1.4.4.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1"><csymbol cd="latexml" id="A1.E15Xa.2.1.1.m1.4.4.1.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1">limit-from</csymbol><apply id="A1.E15Xa.2.1.1.m1.4.4.1.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1"><times id="A1.E15Xa.2.1.1.m1.4.4.1.1.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.2"></times><apply id="A1.E15Xa.2.1.1.m1.4.4.1.1.3.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="A1.E15Xa.2.1.1.m1.4.4.1.1.3.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.3">subscript</csymbol><ci id="A1.E15Xa.2.1.1.m1.4.4.1.1.3.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.3.2">𝔼</ci><apply id="A1.E15Xa.2.1.1.m1.2.2.2.cmml" xref="A1.E15Xa.2.1.1.m1.2.2.2"><times id="A1.E15Xa.2.1.1.m1.2.2.2.3.cmml" xref="A1.E15Xa.2.1.1.m1.2.2.2.3"></times><ci id="A1.E15Xa.2.1.1.m1.2.2.2.4.cmml" xref="A1.E15Xa.2.1.1.m1.2.2.2.4">𝑞</ci><interval closure="open" id="A1.E15Xa.2.1.1.m1.2.2.2.2.2.cmml" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.1"><ci id="A1.E15Xa.2.1.1.m1.1.1.1.1.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.1.1">𝑧</ci><apply id="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.cmml" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.1">conditional</csymbol><ci id="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.2.cmml" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.2">𝑐</ci><ci id="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.3.cmml" xref="A1.E15Xa.2.1.1.m1.2.2.2.2.1.1.3">𝑥</ci></apply></interval></apply></apply><apply id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.2.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1"><plus id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.3.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.3"></plus><apply id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1"><times id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.2"></times><apply id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3"><log id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.1"></log><ci id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3">𝑧</ci></apply></apply><apply id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2"><times id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.2"></times><apply id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3"><log id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3.1"></log><ci id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.3.2">𝑝</ci></apply><apply id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.1">conditional</csymbol><ci id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.2">𝑧</ci><ci id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.2.1.1.1.3">𝑐</ci></apply></apply><apply id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4"><times id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.1"></times><apply id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2"><log id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2.1.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2.1"></log><ci id="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2.2.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.1.1.1.1.4.2.2">𝑝</ci></apply><ci id="A1.E15Xa.2.1.1.m1.3.3.cmml" xref="A1.E15Xa.2.1.1.m1.3.3">𝑐</ci></apply></apply></apply></apply><minus id="A1.E15Xa.2.1.1.m1.4.4.1.3.cmml" xref="A1.E15Xa.2.1.1.m1.4.4.1.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15Xa.2.1.1.m1.4c">\displaystyle=\mathbb{E}_{q(z,c|x)}\left[\log p(x|z)+\log p(z|c)+\log p(c)%
\right]-</annotation><annotation encoding="application/x-llamapun" id="A1.E15Xa.2.1.1.m1.4d">= blackboard_E start_POSTSUBSCRIPT italic_q ( italic_z , italic_c | italic_x ) end_POSTSUBSCRIPT [ roman_log italic_p ( italic_x | italic_z ) + roman_log italic_p ( italic_z | italic_c ) + roman_log italic_p ( italic_c ) ] -</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E15Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\quad\mathbb{E}_{q(z,c|x)}\left[\log q(z|x)+\log q(c|x)\right]" class="ltx_Math" display="inline" id="A1.E15Xb.2.1.1.m1.3"><semantics id="A1.E15Xb.2.1.1.m1.3a"><mrow id="A1.E15Xb.2.1.1.m1.3.3" xref="A1.E15Xb.2.1.1.m1.3.3.cmml"><msub id="A1.E15Xb.2.1.1.m1.3.3.3" xref="A1.E15Xb.2.1.1.m1.3.3.3.cmml"><mi id="A1.E15Xb.2.1.1.m1.3.3.3.2" xref="A1.E15Xb.2.1.1.m1.3.3.3.2.cmml">𝔼</mi><mrow id="A1.E15Xb.2.1.1.m1.2.2.2" xref="A1.E15Xb.2.1.1.m1.2.2.2.cmml"><mi id="A1.E15Xb.2.1.1.m1.2.2.2.4" xref="A1.E15Xb.2.1.1.m1.2.2.2.4.cmml">q</mi><mo id="A1.E15Xb.2.1.1.m1.2.2.2.3" xref="A1.E15Xb.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.E15Xb.2.1.1.m1.2.2.2.2.1" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.2.cmml"><mo id="A1.E15Xb.2.1.1.m1.2.2.2.2.1.2" stretchy="false" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.2.cmml">(</mo><mi id="A1.E15Xb.2.1.1.m1.1.1.1.1" xref="A1.E15Xb.2.1.1.m1.1.1.1.1.cmml">z</mi><mo id="A1.E15Xb.2.1.1.m1.2.2.2.2.1.3" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.2.cmml">,</mo><mrow id="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.cmml"><mi id="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.2" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.2.cmml">c</mi><mo fence="false" id="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.1" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.1.cmml">|</mo><mi id="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.3" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E15Xb.2.1.1.m1.2.2.2.2.1.4" stretchy="false" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow></msub><mo id="A1.E15Xb.2.1.1.m1.3.3.2" xref="A1.E15Xb.2.1.1.m1.3.3.2.cmml">⁢</mo><mrow id="A1.E15Xb.2.1.1.m1.3.3.1.1" xref="A1.E15Xb.2.1.1.m1.3.3.1.2.cmml"><mo id="A1.E15Xb.2.1.1.m1.3.3.1.1.2" xref="A1.E15Xb.2.1.1.m1.3.3.1.2.1.cmml">[</mo><mrow id="A1.E15Xb.2.1.1.m1.3.3.1.1.1" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.cmml"><mrow id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.cmml"><mrow id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3.cmml"><mi id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3.1" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3.1.cmml">log</mi><mo id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3a" lspace="0.167em" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3.cmml">⁡</mo><mi id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3.2" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3.2.cmml">q</mi></mrow><mo id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.2" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.2" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">z</mi><mo fence="false" id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.1" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.3" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.3.cmml">+</mo><mrow id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.cmml"><mrow id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3.cmml"><mi id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3.1" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3.1.cmml">log</mi><mo id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3a" lspace="0.167em" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3.cmml">⁡</mo><mi id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3.2" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3.2.cmml">q</mi></mrow><mo id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.2" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.cmml"><mo id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.2" stretchy="false" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.cmml"><mi id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.2" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.2.cmml">c</mi><mo fence="false" id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.1" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.1.cmml">|</mo><mi id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.3" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.3" stretchy="false" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E15Xb.2.1.1.m1.3.3.1.1.3" xref="A1.E15Xb.2.1.1.m1.3.3.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E15Xb.2.1.1.m1.3b"><apply id="A1.E15Xb.2.1.1.m1.3.3.cmml" xref="A1.E15Xb.2.1.1.m1.3.3"><times id="A1.E15Xb.2.1.1.m1.3.3.2.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.2"></times><apply id="A1.E15Xb.2.1.1.m1.3.3.3.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.3"><csymbol cd="ambiguous" id="A1.E15Xb.2.1.1.m1.3.3.3.1.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.3">subscript</csymbol><ci id="A1.E15Xb.2.1.1.m1.3.3.3.2.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.3.2">𝔼</ci><apply id="A1.E15Xb.2.1.1.m1.2.2.2.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2"><times id="A1.E15Xb.2.1.1.m1.2.2.2.3.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.3"></times><ci id="A1.E15Xb.2.1.1.m1.2.2.2.4.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.4">𝑞</ci><interval closure="open" id="A1.E15Xb.2.1.1.m1.2.2.2.2.2.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.1"><ci id="A1.E15Xb.2.1.1.m1.1.1.1.1.cmml" xref="A1.E15Xb.2.1.1.m1.1.1.1.1">𝑧</ci><apply id="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.1">conditional</csymbol><ci id="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.2.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.2">𝑐</ci><ci id="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.3.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.1.1.3">𝑥</ci></apply></interval></apply></apply><apply id="A1.E15Xb.2.1.1.m1.3.3.1.2.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1"><csymbol cd="latexml" id="A1.E15Xb.2.1.1.m1.3.3.1.2.1.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.2">delimited-[]</csymbol><apply id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1"><plus id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.3.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.3"></plus><apply id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1"><times id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.2"></times><apply id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3"><log id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3.1.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3.1"></log><ci id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3.2.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.3.2">𝑞</ci></apply><apply id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.2">𝑧</ci><ci id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2"><times id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.2.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.2"></times><apply id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3"><log id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3.1.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3.1"></log><ci id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3.2.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.3.2">𝑞</ci></apply><apply id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1"><csymbol cd="latexml" id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.1.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.1">conditional</csymbol><ci id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.2.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.2">𝑐</ci><ci id="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.3.cmml" xref="A1.E15Xb.2.1.1.m1.3.3.1.1.1.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15Xb.2.1.1.m1.3c">\displaystyle\quad\mathbb{E}_{q(z,c|x)}\left[\log q(z|x)+\log q(c|x)\right]</annotation><annotation encoding="application/x-llamapun" id="A1.E15Xb.2.1.1.m1.3d">blackboard_E start_POSTSUBSCRIPT italic_q ( italic_z , italic_c | italic_x ) end_POSTSUBSCRIPT [ roman_log italic_q ( italic_z | italic_x ) + roman_log italic_q ( italic_c | italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E15Xc">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}_{q(z,c|x)}\left[\log p(x|z)+\log\frac{p(z,c)}{q(z,c|x%
)}\right]" class="ltx_Math" display="inline" id="A1.E15Xc.2.1.1.m1.7"><semantics id="A1.E15Xc.2.1.1.m1.7a"><mrow id="A1.E15Xc.2.1.1.m1.7.7" xref="A1.E15Xc.2.1.1.m1.7.7.cmml"><mi id="A1.E15Xc.2.1.1.m1.7.7.3" xref="A1.E15Xc.2.1.1.m1.7.7.3.cmml"></mi><mo id="A1.E15Xc.2.1.1.m1.7.7.2" xref="A1.E15Xc.2.1.1.m1.7.7.2.cmml">=</mo><mrow id="A1.E15Xc.2.1.1.m1.7.7.1" xref="A1.E15Xc.2.1.1.m1.7.7.1.cmml"><msub id="A1.E15Xc.2.1.1.m1.7.7.1.3" xref="A1.E15Xc.2.1.1.m1.7.7.1.3.cmml"><mi id="A1.E15Xc.2.1.1.m1.7.7.1.3.2" xref="A1.E15Xc.2.1.1.m1.7.7.1.3.2.cmml">𝔼</mi><mrow id="A1.E15Xc.2.1.1.m1.2.2.2" xref="A1.E15Xc.2.1.1.m1.2.2.2.cmml"><mi id="A1.E15Xc.2.1.1.m1.2.2.2.4" xref="A1.E15Xc.2.1.1.m1.2.2.2.4.cmml">q</mi><mo id="A1.E15Xc.2.1.1.m1.2.2.2.3" xref="A1.E15Xc.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.E15Xc.2.1.1.m1.2.2.2.2.1" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.2.cmml"><mo id="A1.E15Xc.2.1.1.m1.2.2.2.2.1.2" stretchy="false" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.2.cmml">(</mo><mi id="A1.E15Xc.2.1.1.m1.1.1.1.1" xref="A1.E15Xc.2.1.1.m1.1.1.1.1.cmml">z</mi><mo id="A1.E15Xc.2.1.1.m1.2.2.2.2.1.3" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.2.cmml">,</mo><mrow id="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.cmml"><mi id="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.2" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.2.cmml">c</mi><mo fence="false" id="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.1" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.1.cmml">|</mo><mi id="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.3" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E15Xc.2.1.1.m1.2.2.2.2.1.4" stretchy="false" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow></msub><mo id="A1.E15Xc.2.1.1.m1.7.7.1.2" xref="A1.E15Xc.2.1.1.m1.7.7.1.2.cmml">⁢</mo><mrow id="A1.E15Xc.2.1.1.m1.7.7.1.1.1" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.2.cmml"><mo id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.2" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.2.1.cmml">[</mo><mrow id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.cmml"><mrow id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.cmml"><mrow id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3.cmml"><mi id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3.1" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3.1.cmml">log</mi><mo id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3a" lspace="0.167em" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3.cmml">⁡</mo><mi id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3.2" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.2" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.2" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.3" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">z</mi></mrow><mo id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.2" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.2.cmml">+</mo><mrow id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.3" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.3.cmml"><mi id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.3.1" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.3.1.cmml">log</mi><mo id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.3a" lspace="0.167em" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.3.cmml">⁡</mo><mstyle displaystyle="true" id="A1.E15Xc.2.1.1.m1.6.6" xref="A1.E15Xc.2.1.1.m1.6.6.cmml"><mfrac id="A1.E15Xc.2.1.1.m1.6.6a" xref="A1.E15Xc.2.1.1.m1.6.6.cmml"><mrow id="A1.E15Xc.2.1.1.m1.4.4.2" xref="A1.E15Xc.2.1.1.m1.4.4.2.cmml"><mi id="A1.E15Xc.2.1.1.m1.4.4.2.4" xref="A1.E15Xc.2.1.1.m1.4.4.2.4.cmml">p</mi><mo id="A1.E15Xc.2.1.1.m1.4.4.2.3" xref="A1.E15Xc.2.1.1.m1.4.4.2.3.cmml">⁢</mo><mrow id="A1.E15Xc.2.1.1.m1.4.4.2.5.2" xref="A1.E15Xc.2.1.1.m1.4.4.2.5.1.cmml"><mo id="A1.E15Xc.2.1.1.m1.4.4.2.5.2.1" stretchy="false" xref="A1.E15Xc.2.1.1.m1.4.4.2.5.1.cmml">(</mo><mi id="A1.E15Xc.2.1.1.m1.3.3.1.1" xref="A1.E15Xc.2.1.1.m1.3.3.1.1.cmml">z</mi><mo id="A1.E15Xc.2.1.1.m1.4.4.2.5.2.2" xref="A1.E15Xc.2.1.1.m1.4.4.2.5.1.cmml">,</mo><mi id="A1.E15Xc.2.1.1.m1.4.4.2.2" xref="A1.E15Xc.2.1.1.m1.4.4.2.2.cmml">c</mi><mo id="A1.E15Xc.2.1.1.m1.4.4.2.5.2.3" stretchy="false" xref="A1.E15Xc.2.1.1.m1.4.4.2.5.1.cmml">)</mo></mrow></mrow><mrow id="A1.E15Xc.2.1.1.m1.6.6.4" xref="A1.E15Xc.2.1.1.m1.6.6.4.cmml"><mi id="A1.E15Xc.2.1.1.m1.6.6.4.4" xref="A1.E15Xc.2.1.1.m1.6.6.4.4.cmml">q</mi><mo id="A1.E15Xc.2.1.1.m1.6.6.4.3" xref="A1.E15Xc.2.1.1.m1.6.6.4.3.cmml">⁢</mo><mrow id="A1.E15Xc.2.1.1.m1.6.6.4.2.1" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.2.cmml"><mo id="A1.E15Xc.2.1.1.m1.6.6.4.2.1.2" stretchy="false" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.2.cmml">(</mo><mi id="A1.E15Xc.2.1.1.m1.5.5.3.1" xref="A1.E15Xc.2.1.1.m1.5.5.3.1.cmml">z</mi><mo id="A1.E15Xc.2.1.1.m1.6.6.4.2.1.3" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.2.cmml">,</mo><mrow id="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.cmml"><mi id="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.2" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.2.cmml">c</mi><mo fence="false" id="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.1" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.1.cmml">|</mo><mi id="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.3" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E15Xc.2.1.1.m1.6.6.4.2.1.4" stretchy="false" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.2.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><mo id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.3" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E15Xc.2.1.1.m1.7b"><apply id="A1.E15Xc.2.1.1.m1.7.7.cmml" xref="A1.E15Xc.2.1.1.m1.7.7"><eq id="A1.E15Xc.2.1.1.m1.7.7.2.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.2"></eq><csymbol cd="latexml" id="A1.E15Xc.2.1.1.m1.7.7.3.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.3">absent</csymbol><apply id="A1.E15Xc.2.1.1.m1.7.7.1.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1"><times id="A1.E15Xc.2.1.1.m1.7.7.1.2.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.2"></times><apply id="A1.E15Xc.2.1.1.m1.7.7.1.3.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.3"><csymbol cd="ambiguous" id="A1.E15Xc.2.1.1.m1.7.7.1.3.1.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.3">subscript</csymbol><ci id="A1.E15Xc.2.1.1.m1.7.7.1.3.2.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.3.2">𝔼</ci><apply id="A1.E15Xc.2.1.1.m1.2.2.2.cmml" xref="A1.E15Xc.2.1.1.m1.2.2.2"><times id="A1.E15Xc.2.1.1.m1.2.2.2.3.cmml" xref="A1.E15Xc.2.1.1.m1.2.2.2.3"></times><ci id="A1.E15Xc.2.1.1.m1.2.2.2.4.cmml" xref="A1.E15Xc.2.1.1.m1.2.2.2.4">𝑞</ci><interval closure="open" id="A1.E15Xc.2.1.1.m1.2.2.2.2.2.cmml" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.1"><ci id="A1.E15Xc.2.1.1.m1.1.1.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.1.1.1.1">𝑧</ci><apply id="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.1">conditional</csymbol><ci id="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.2.cmml" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.2">𝑐</ci><ci id="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.3.cmml" xref="A1.E15Xc.2.1.1.m1.2.2.2.2.1.1.3">𝑥</ci></apply></interval></apply></apply><apply id="A1.E15Xc.2.1.1.m1.7.7.1.1.2.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1"><csymbol cd="latexml" id="A1.E15Xc.2.1.1.m1.7.7.1.1.2.1.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.2">delimited-[]</csymbol><apply id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1"><plus id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.2.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.2"></plus><apply id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1"><times id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.2.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.2"></times><apply id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3"><log id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3.1.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3.1"></log><ci id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3.2.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.3">𝑧</ci></apply></apply><apply id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.3.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.3"><log id="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.3.1.cmml" xref="A1.E15Xc.2.1.1.m1.7.7.1.1.1.1.3.1"></log><apply id="A1.E15Xc.2.1.1.m1.6.6.cmml" xref="A1.E15Xc.2.1.1.m1.6.6"><divide id="A1.E15Xc.2.1.1.m1.6.6.5.cmml" xref="A1.E15Xc.2.1.1.m1.6.6"></divide><apply id="A1.E15Xc.2.1.1.m1.4.4.2.cmml" xref="A1.E15Xc.2.1.1.m1.4.4.2"><times id="A1.E15Xc.2.1.1.m1.4.4.2.3.cmml" xref="A1.E15Xc.2.1.1.m1.4.4.2.3"></times><ci id="A1.E15Xc.2.1.1.m1.4.4.2.4.cmml" xref="A1.E15Xc.2.1.1.m1.4.4.2.4">𝑝</ci><interval closure="open" id="A1.E15Xc.2.1.1.m1.4.4.2.5.1.cmml" xref="A1.E15Xc.2.1.1.m1.4.4.2.5.2"><ci id="A1.E15Xc.2.1.1.m1.3.3.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.3.3.1.1">𝑧</ci><ci id="A1.E15Xc.2.1.1.m1.4.4.2.2.cmml" xref="A1.E15Xc.2.1.1.m1.4.4.2.2">𝑐</ci></interval></apply><apply id="A1.E15Xc.2.1.1.m1.6.6.4.cmml" xref="A1.E15Xc.2.1.1.m1.6.6.4"><times id="A1.E15Xc.2.1.1.m1.6.6.4.3.cmml" xref="A1.E15Xc.2.1.1.m1.6.6.4.3"></times><ci id="A1.E15Xc.2.1.1.m1.6.6.4.4.cmml" xref="A1.E15Xc.2.1.1.m1.6.6.4.4">𝑞</ci><interval closure="open" id="A1.E15Xc.2.1.1.m1.6.6.4.2.2.cmml" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.1"><ci id="A1.E15Xc.2.1.1.m1.5.5.3.1.cmml" xref="A1.E15Xc.2.1.1.m1.5.5.3.1">𝑧</ci><apply id="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1"><csymbol cd="latexml" id="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.1">conditional</csymbol><ci id="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.2.cmml" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.2">𝑐</ci><ci id="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.3.cmml" xref="A1.E15Xc.2.1.1.m1.6.6.4.2.1.1.3">𝑥</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15Xc.2.1.1.m1.7c">\displaystyle=\mathbb{E}_{q(z,c|x)}\left[\log p(x|z)+\log\frac{p(z,c)}{q(z,c|x%
)}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.E15Xc.2.1.1.m1.7d">= blackboard_E start_POSTSUBSCRIPT italic_q ( italic_z , italic_c | italic_x ) end_POSTSUBSCRIPT [ roman_log italic_p ( italic_x | italic_z ) + roman_log divide start_ARG italic_p ( italic_z , italic_c ) end_ARG start_ARG italic_q ( italic_z , italic_c | italic_x ) end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.4">The first term represents the reconstruction loss, allowing the model to discover deep level user-item interactions. The second term calculates the Kullback-Leibler divergence between the mixed Gaussian prior distribution <math alttext="q(z|x)" class="ltx_Math" display="inline" id="A1.p2.1.m1.1"><semantics id="A1.p2.1.m1.1a"><mrow id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml"><mi id="A1.p2.1.m1.1.1.3" xref="A1.p2.1.m1.1.1.3.cmml">q</mi><mo id="A1.p2.1.m1.1.1.2" xref="A1.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.p2.1.m1.1.1.1.1" xref="A1.p2.1.m1.1.1.1.1.1.cmml"><mo id="A1.p2.1.m1.1.1.1.1.2" stretchy="false" xref="A1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.p2.1.m1.1.1.1.1.1" xref="A1.p2.1.m1.1.1.1.1.1.cmml"><mi id="A1.p2.1.m1.1.1.1.1.1.2" xref="A1.p2.1.m1.1.1.1.1.1.2.cmml">z</mi><mo fence="false" id="A1.p2.1.m1.1.1.1.1.1.1" xref="A1.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.p2.1.m1.1.1.1.1.1.3" xref="A1.p2.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.p2.1.m1.1.1.1.1.3" stretchy="false" xref="A1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><apply id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1"><times id="A1.p2.1.m1.1.1.2.cmml" xref="A1.p2.1.m1.1.1.2"></times><ci id="A1.p2.1.m1.1.1.3.cmml" xref="A1.p2.1.m1.1.1.3">𝑞</ci><apply id="A1.p2.1.m1.1.1.1.1.1.cmml" xref="A1.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="A1.p2.1.m1.1.1.1.1.1.1.cmml" xref="A1.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.p2.1.m1.1.1.1.1.1.2.cmml" xref="A1.p2.1.m1.1.1.1.1.1.2">𝑧</ci><ci id="A1.p2.1.m1.1.1.1.1.1.3.cmml" xref="A1.p2.1.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">q(z|x)</annotation><annotation encoding="application/x-llamapun" id="A1.p2.1.m1.1d">italic_q ( italic_z | italic_x )</annotation></semantics></math> and the variational posterior <math alttext="p(z,c)" class="ltx_Math" display="inline" id="A1.p2.2.m2.2"><semantics id="A1.p2.2.m2.2a"><mrow id="A1.p2.2.m2.2.3" xref="A1.p2.2.m2.2.3.cmml"><mi id="A1.p2.2.m2.2.3.2" xref="A1.p2.2.m2.2.3.2.cmml">p</mi><mo id="A1.p2.2.m2.2.3.1" xref="A1.p2.2.m2.2.3.1.cmml">⁢</mo><mrow id="A1.p2.2.m2.2.3.3.2" xref="A1.p2.2.m2.2.3.3.1.cmml"><mo id="A1.p2.2.m2.2.3.3.2.1" stretchy="false" xref="A1.p2.2.m2.2.3.3.1.cmml">(</mo><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">z</mi><mo id="A1.p2.2.m2.2.3.3.2.2" xref="A1.p2.2.m2.2.3.3.1.cmml">,</mo><mi id="A1.p2.2.m2.2.2" xref="A1.p2.2.m2.2.2.cmml">c</mi><mo id="A1.p2.2.m2.2.3.3.2.3" stretchy="false" xref="A1.p2.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.2b"><apply id="A1.p2.2.m2.2.3.cmml" xref="A1.p2.2.m2.2.3"><times id="A1.p2.2.m2.2.3.1.cmml" xref="A1.p2.2.m2.2.3.1"></times><ci id="A1.p2.2.m2.2.3.2.cmml" xref="A1.p2.2.m2.2.3.2">𝑝</ci><interval closure="open" id="A1.p2.2.m2.2.3.3.1.cmml" xref="A1.p2.2.m2.2.3.3.2"><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">𝑧</ci><ci id="A1.p2.2.m2.2.2.cmml" xref="A1.p2.2.m2.2.2">𝑐</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.2c">p(z,c)</annotation><annotation encoding="application/x-llamapun" id="A1.p2.2.m2.2d">italic_p ( italic_z , italic_c )</annotation></semantics></math>. To learn more disentangled representations, according to <math alttext="\beta" class="ltx_Math" display="inline" id="A1.p2.3.m3.1"><semantics id="A1.p2.3.m3.1a"><mi id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><ci id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.p2.3.m3.1d">italic_β</annotation></semantics></math>-VAE<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#bib.bib12" title="">12</a>]</cite> approach, we added a hyperparameter <math alttext="\beta" class="ltx_Math" display="inline" id="A1.p2.4.m4.1"><semantics id="A1.p2.4.m4.1a"><mi id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><ci id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.p2.4.m4.1d">italic_β</annotation></semantics></math> to the KL divergence term, rewriting the formula as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(16)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{ELBO}}(x,\beta)=\mathbb{E}_{q(z,c|x)}\left[\log p(x|z)%
\right]-\beta\cdot\text{KL}\left(q(z,c|x)||p(z,c)\right)" class="ltx_math_unparsed" display="block" id="A1.E16.m1.7"><semantics id="A1.E16.m1.7a"><mrow id="A1.E16.m1.7b"><msub id="A1.E16.m1.7.8"><mi class="ltx_font_mathcaligraphic" id="A1.E16.m1.7.8.2">ℒ</mi><mtext id="A1.E16.m1.7.8.3">ELBO</mtext></msub><mrow id="A1.E16.m1.7.9"><mo id="A1.E16.m1.7.9.1" stretchy="false">(</mo><mi id="A1.E16.m1.3.3">x</mi><mo id="A1.E16.m1.7.9.2">,</mo><mi id="A1.E16.m1.4.4">β</mi><mo id="A1.E16.m1.7.9.3" stretchy="false">)</mo></mrow><mo id="A1.E16.m1.7.10">=</mo><msub id="A1.E16.m1.7.11"><mi id="A1.E16.m1.7.11.2">𝔼</mi><mrow id="A1.E16.m1.2.2.2"><mi id="A1.E16.m1.2.2.2.4">q</mi><mo id="A1.E16.m1.2.2.2.3">⁢</mo><mrow id="A1.E16.m1.2.2.2.2.1"><mo id="A1.E16.m1.2.2.2.2.1.2" stretchy="false">(</mo><mi id="A1.E16.m1.1.1.1.1">z</mi><mo id="A1.E16.m1.2.2.2.2.1.3">,</mo><mrow id="A1.E16.m1.2.2.2.2.1.1"><mi id="A1.E16.m1.2.2.2.2.1.1.2">c</mi><mo fence="false" id="A1.E16.m1.2.2.2.2.1.1.1">|</mo><mi id="A1.E16.m1.2.2.2.2.1.1.3">x</mi></mrow><mo id="A1.E16.m1.2.2.2.2.1.4" stretchy="false">)</mo></mrow></mrow></msub><mrow id="A1.E16.m1.7.12"><mo id="A1.E16.m1.7.12.1">[</mo><mi id="A1.E16.m1.7.12.2">log</mi><mi id="A1.E16.m1.7.12.3">p</mi><mrow id="A1.E16.m1.7.12.4"><mo id="A1.E16.m1.7.12.4.1" stretchy="false">(</mo><mi id="A1.E16.m1.7.12.4.2">x</mi><mo fence="false" id="A1.E16.m1.7.12.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E16.m1.7.12.4.4">z</mi><mo id="A1.E16.m1.7.12.4.5" stretchy="false">)</mo></mrow><mo id="A1.E16.m1.7.12.5">]</mo></mrow><mo id="A1.E16.m1.7.13">−</mo><mi id="A1.E16.m1.7.14">β</mi><mo id="A1.E16.m1.7.15" lspace="0.222em" rspace="0.222em">⋅</mo><mtext id="A1.E16.m1.7.16">KL</mtext><mrow id="A1.E16.m1.7.17"><mo id="A1.E16.m1.7.17.1">(</mo><mi id="A1.E16.m1.7.17.2">q</mi><mrow id="A1.E16.m1.7.17.3"><mo id="A1.E16.m1.7.17.3.1" stretchy="false">(</mo><mi id="A1.E16.m1.5.5">z</mi><mo id="A1.E16.m1.7.17.3.2">,</mo><mi id="A1.E16.m1.7.17.3.3">c</mi><mo fence="false" id="A1.E16.m1.7.17.3.4" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E16.m1.7.17.3.5">x</mi><mo id="A1.E16.m1.7.17.3.6" stretchy="false">)</mo></mrow><mo fence="false" id="A1.E16.m1.7.17.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.E16.m1.7.17.5" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E16.m1.7.17.6">p</mi><mrow id="A1.E16.m1.7.17.7"><mo id="A1.E16.m1.7.17.7.1" stretchy="false">(</mo><mi id="A1.E16.m1.6.6">z</mi><mo id="A1.E16.m1.7.17.7.2">,</mo><mi id="A1.E16.m1.7.7">c</mi><mo id="A1.E16.m1.7.17.7.3" stretchy="false">)</mo></mrow><mo id="A1.E16.m1.7.17.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E16.m1.7c">\mathcal{L}_{\text{ELBO}}(x,\beta)=\mathbb{E}_{q(z,c|x)}\left[\log p(x|z)%
\right]-\beta\cdot\text{KL}\left(q(z,c|x)||p(z,c)\right)</annotation><annotation encoding="application/x-llamapun" id="A1.E16.m1.7d">caligraphic_L start_POSTSUBSCRIPT ELBO end_POSTSUBSCRIPT ( italic_x , italic_β ) = blackboard_E start_POSTSUBSCRIPT italic_q ( italic_z , italic_c | italic_x ) end_POSTSUBSCRIPT [ roman_log italic_p ( italic_x | italic_z ) ] - italic_β ⋅ KL ( italic_q ( italic_z , italic_c | italic_x ) | | italic_p ( italic_z , italic_c ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.p3">
<p class="ltx_p" id="A1.p3.1">where <math alttext="\beta" class="ltx_Math" display="inline" id="A1.p3.1.m1.1"><semantics id="A1.p3.1.m1.1a"><mi id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><ci id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.p3.1.m1.1d">italic_β</annotation></semantics></math> balances the reconstruction loss and the KL regularization term. The KL regularization term is derived as:</p>
</div>
<div class="ltx_para" id="A1.p4">
<table class="ltx_equationgroup ltx_eqn_table" id="A1.E17">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E17X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(17)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{KL}(q(z,c|x)||p(z,c))" class="ltx_math_unparsed" display="inline" id="A1.E17X.2.1.1.m1.3"><semantics id="A1.E17X.2.1.1.m1.3a"><mrow id="A1.E17X.2.1.1.m1.3b"><mtext id="A1.E17X.2.1.1.m1.3.4">KL</mtext><mrow id="A1.E17X.2.1.1.m1.3.5"><mo id="A1.E17X.2.1.1.m1.3.5.1" stretchy="false">(</mo><mi id="A1.E17X.2.1.1.m1.3.5.2">q</mi><mrow id="A1.E17X.2.1.1.m1.3.5.3"><mo id="A1.E17X.2.1.1.m1.3.5.3.1" stretchy="false">(</mo><mi id="A1.E17X.2.1.1.m1.1.1">z</mi><mo id="A1.E17X.2.1.1.m1.3.5.3.2">,</mo><mi id="A1.E17X.2.1.1.m1.3.5.3.3">c</mi><mo fence="false" id="A1.E17X.2.1.1.m1.3.5.3.4" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E17X.2.1.1.m1.3.5.3.5">x</mi><mo id="A1.E17X.2.1.1.m1.3.5.3.6" stretchy="false">)</mo></mrow><mo fence="false" id="A1.E17X.2.1.1.m1.3.5.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.E17X.2.1.1.m1.3.5.5" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E17X.2.1.1.m1.3.5.6">p</mi><mrow id="A1.E17X.2.1.1.m1.3.5.7"><mo id="A1.E17X.2.1.1.m1.3.5.7.1" stretchy="false">(</mo><mi id="A1.E17X.2.1.1.m1.2.2">z</mi><mo id="A1.E17X.2.1.1.m1.3.5.7.2">,</mo><mi id="A1.E17X.2.1.1.m1.3.3">c</mi><mo id="A1.E17X.2.1.1.m1.3.5.7.3" stretchy="false">)</mo></mrow><mo id="A1.E17X.2.1.1.m1.3.5.8" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E17X.2.1.1.m1.3c">\displaystyle\text{KL}(q(z,c|x)||p(z,c))</annotation><annotation encoding="application/x-llamapun" id="A1.E17X.2.1.1.m1.3d">KL ( italic_q ( italic_z , italic_c | italic_x ) | | italic_p ( italic_z , italic_c ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E17Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\frac{1}{2}\sum_{c=1}^{K}\gamma_{i,c}\sum_{d=1}^{D}\left(\log(%
\bar{\sigma}_{c,d})^{2}+\left(\frac{\sigma_{i,d}}{\bar{\sigma}_{c,d}}\right)^{%
2}+\sum_{c=1}^{K}\gamma_{i,c}\log\frac{\pi_{c}}{\gamma_{i,c}}\right)" class="ltx_math_unparsed" display="inline" id="A1.E17Xa.2.1.1.m1.13"><semantics id="A1.E17Xa.2.1.1.m1.13a"><mrow id="A1.E17Xa.2.1.1.m1.13b"><mo id="A1.E17Xa.2.1.1.m1.13.14" rspace="0em">=</mo><mo id="A1.E17Xa.2.1.1.m1.13.15" lspace="0em">−</mo><mstyle displaystyle="true" id="A1.E17Xa.2.1.1.m1.13.16"><mfrac id="A1.E17Xa.2.1.1.m1.13.16a"><mn id="A1.E17Xa.2.1.1.m1.13.16.2">1</mn><mn id="A1.E17Xa.2.1.1.m1.13.16.3">2</mn></mfrac></mstyle><mstyle displaystyle="true" id="A1.E17Xa.2.1.1.m1.13.17"><munderover id="A1.E17Xa.2.1.1.m1.13.17a"><mo id="A1.E17Xa.2.1.1.m1.13.17.2.2" movablelimits="false">∑</mo><mrow id="A1.E17Xa.2.1.1.m1.13.17.2.3"><mi id="A1.E17Xa.2.1.1.m1.13.17.2.3.2">c</mi><mo id="A1.E17Xa.2.1.1.m1.13.17.2.3.1">=</mo><mn id="A1.E17Xa.2.1.1.m1.13.17.2.3.3">1</mn></mrow><mi id="A1.E17Xa.2.1.1.m1.13.17.3">K</mi></munderover></mstyle><msub id="A1.E17Xa.2.1.1.m1.13.18"><mi id="A1.E17Xa.2.1.1.m1.13.18.2">γ</mi><mrow id="A1.E17Xa.2.1.1.m1.2.2.2.4"><mi id="A1.E17Xa.2.1.1.m1.1.1.1.1">i</mi><mo id="A1.E17Xa.2.1.1.m1.2.2.2.4.1">,</mo><mi id="A1.E17Xa.2.1.1.m1.2.2.2.2">c</mi></mrow></msub><mstyle displaystyle="true" id="A1.E17Xa.2.1.1.m1.13.19"><munderover id="A1.E17Xa.2.1.1.m1.13.19a"><mo id="A1.E17Xa.2.1.1.m1.13.19.2.2" movablelimits="false">∑</mo><mrow id="A1.E17Xa.2.1.1.m1.13.19.2.3"><mi id="A1.E17Xa.2.1.1.m1.13.19.2.3.2">d</mi><mo id="A1.E17Xa.2.1.1.m1.13.19.2.3.1">=</mo><mn id="A1.E17Xa.2.1.1.m1.13.19.2.3.3">1</mn></mrow><mi id="A1.E17Xa.2.1.1.m1.13.19.3">D</mi></munderover></mstyle><mrow id="A1.E17Xa.2.1.1.m1.13.20"><mo id="A1.E17Xa.2.1.1.m1.13.20.1">(</mo><mi id="A1.E17Xa.2.1.1.m1.13.13">log</mi><msup id="A1.E17Xa.2.1.1.m1.13.20.2"><mrow id="A1.E17Xa.2.1.1.m1.13.20.2.2"><mo id="A1.E17Xa.2.1.1.m1.13.20.2.2.1" stretchy="false">(</mo><msub id="A1.E17Xa.2.1.1.m1.13.20.2.2.2"><mover accent="true" id="A1.E17Xa.2.1.1.m1.13.20.2.2.2.2"><mi id="A1.E17Xa.2.1.1.m1.13.20.2.2.2.2.2">σ</mi><mo id="A1.E17Xa.2.1.1.m1.13.20.2.2.2.2.1">¯</mo></mover><mrow id="A1.E17Xa.2.1.1.m1.4.4.2.4"><mi id="A1.E17Xa.2.1.1.m1.3.3.1.1">c</mi><mo id="A1.E17Xa.2.1.1.m1.4.4.2.4.1">,</mo><mi id="A1.E17Xa.2.1.1.m1.4.4.2.2">d</mi></mrow></msub><mo id="A1.E17Xa.2.1.1.m1.13.20.2.2.3" stretchy="false">)</mo></mrow><mn id="A1.E17Xa.2.1.1.m1.13.20.2.3">2</mn></msup><mo id="A1.E17Xa.2.1.1.m1.13.20.3">+</mo><msup id="A1.E17Xa.2.1.1.m1.13.20.4"><mrow id="A1.E17Xa.2.1.1.m1.13.20.4.2"><mo id="A1.E17Xa.2.1.1.m1.13.20.4.2.1">(</mo><mstyle displaystyle="true" id="A1.E17Xa.2.1.1.m1.8.8"><mfrac id="A1.E17Xa.2.1.1.m1.8.8a"><msub id="A1.E17Xa.2.1.1.m1.6.6.2"><mi id="A1.E17Xa.2.1.1.m1.6.6.2.4">σ</mi><mrow id="A1.E17Xa.2.1.1.m1.6.6.2.2.2.4"><mi id="A1.E17Xa.2.1.1.m1.5.5.1.1.1.1">i</mi><mo id="A1.E17Xa.2.1.1.m1.6.6.2.2.2.4.1">,</mo><mi id="A1.E17Xa.2.1.1.m1.6.6.2.2.2.2">d</mi></mrow></msub><msub id="A1.E17Xa.2.1.1.m1.8.8.4"><mover accent="true" id="A1.E17Xa.2.1.1.m1.8.8.4.4"><mi id="A1.E17Xa.2.1.1.m1.8.8.4.4.2">σ</mi><mo id="A1.E17Xa.2.1.1.m1.8.8.4.4.1">¯</mo></mover><mrow id="A1.E17Xa.2.1.1.m1.8.8.4.2.2.4"><mi id="A1.E17Xa.2.1.1.m1.7.7.3.1.1.1">c</mi><mo id="A1.E17Xa.2.1.1.m1.8.8.4.2.2.4.1">,</mo><mi id="A1.E17Xa.2.1.1.m1.8.8.4.2.2.2">d</mi></mrow></msub></mfrac></mstyle><mo id="A1.E17Xa.2.1.1.m1.13.20.4.2.2">)</mo></mrow><mn id="A1.E17Xa.2.1.1.m1.13.20.4.3">2</mn></msup><mo id="A1.E17Xa.2.1.1.m1.13.20.5">+</mo><mstyle displaystyle="true" id="A1.E17Xa.2.1.1.m1.13.20.6"><munderover id="A1.E17Xa.2.1.1.m1.13.20.6a"><mo id="A1.E17Xa.2.1.1.m1.13.20.6.2.2" movablelimits="false">∑</mo><mrow id="A1.E17Xa.2.1.1.m1.13.20.6.2.3"><mi id="A1.E17Xa.2.1.1.m1.13.20.6.2.3.2">c</mi><mo id="A1.E17Xa.2.1.1.m1.13.20.6.2.3.1">=</mo><mn id="A1.E17Xa.2.1.1.m1.13.20.6.2.3.3">1</mn></mrow><mi id="A1.E17Xa.2.1.1.m1.13.20.6.3">K</mi></munderover></mstyle><msub id="A1.E17Xa.2.1.1.m1.13.20.7"><mi id="A1.E17Xa.2.1.1.m1.13.20.7.2">γ</mi><mrow id="A1.E17Xa.2.1.1.m1.10.10.2.4"><mi id="A1.E17Xa.2.1.1.m1.9.9.1.1">i</mi><mo id="A1.E17Xa.2.1.1.m1.10.10.2.4.1">,</mo><mi id="A1.E17Xa.2.1.1.m1.10.10.2.2">c</mi></mrow></msub><mi id="A1.E17Xa.2.1.1.m1.13.20.8">log</mi><mstyle displaystyle="true" id="A1.E17Xa.2.1.1.m1.12.12"><mfrac id="A1.E17Xa.2.1.1.m1.12.12a"><msub id="A1.E17Xa.2.1.1.m1.12.12.4"><mi id="A1.E17Xa.2.1.1.m1.12.12.4.2">π</mi><mi id="A1.E17Xa.2.1.1.m1.12.12.4.3">c</mi></msub><msub id="A1.E17Xa.2.1.1.m1.12.12.2"><mi id="A1.E17Xa.2.1.1.m1.12.12.2.4">γ</mi><mrow id="A1.E17Xa.2.1.1.m1.12.12.2.2.2.4"><mi id="A1.E17Xa.2.1.1.m1.11.11.1.1.1.1">i</mi><mo id="A1.E17Xa.2.1.1.m1.12.12.2.2.2.4.1">,</mo><mi id="A1.E17Xa.2.1.1.m1.12.12.2.2.2.2">c</mi></mrow></msub></mfrac></mstyle><mo id="A1.E17Xa.2.1.1.m1.13.20.9">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E17Xa.2.1.1.m1.13c">\displaystyle=-\frac{1}{2}\sum_{c=1}^{K}\gamma_{i,c}\sum_{d=1}^{D}\left(\log(%
\bar{\sigma}_{c,d})^{2}+\left(\frac{\sigma_{i,d}}{\bar{\sigma}_{c,d}}\right)^{%
2}+\sum_{c=1}^{K}\gamma_{i,c}\log\frac{\pi_{c}}{\gamma_{i,c}}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.E17Xa.2.1.1.m1.13d">= - divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∑ start_POSTSUBSCRIPT italic_c = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_γ start_POSTSUBSCRIPT italic_i , italic_c end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_d = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT ( roman_log ( over¯ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT italic_c , italic_d end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( divide start_ARG italic_σ start_POSTSUBSCRIPT italic_i , italic_d end_POSTSUBSCRIPT end_ARG start_ARG over¯ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT italic_c , italic_d end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_c = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_γ start_POSTSUBSCRIPT italic_i , italic_c end_POSTSUBSCRIPT roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_ARG start_ARG italic_γ start_POSTSUBSCRIPT italic_i , italic_c end_POSTSUBSCRIPT end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E17Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+\frac{1}{2}\sum_{d=1}^{D}\left(\log\left(\sigma_{i,d}\right)^{2}%
\right)-\frac{1}{2}\sum_{c=1}^{K}\gamma_{i,c}\sum_{d=1}^{D}\left(\frac{(\mu_{i%
,d}-\bar{\mu}_{c,d})}{\bar{\sigma}_{c,d}}\right)^{2}+\frac{1}{2}" class="ltx_math_unparsed" display="inline" id="A1.E17Xb.2.1.1.m1.12"><semantics id="A1.E17Xb.2.1.1.m1.12a"><mrow id="A1.E17Xb.2.1.1.m1.12b"><mo id="A1.E17Xb.2.1.1.m1.12.13">+</mo><mstyle displaystyle="true" id="A1.E17Xb.2.1.1.m1.12.14"><mfrac id="A1.E17Xb.2.1.1.m1.12.14a"><mn id="A1.E17Xb.2.1.1.m1.12.14.2">1</mn><mn id="A1.E17Xb.2.1.1.m1.12.14.3">2</mn></mfrac></mstyle><mstyle displaystyle="true" id="A1.E17Xb.2.1.1.m1.12.15"><munderover id="A1.E17Xb.2.1.1.m1.12.15a"><mo id="A1.E17Xb.2.1.1.m1.12.15.2.2" movablelimits="false">∑</mo><mrow id="A1.E17Xb.2.1.1.m1.12.15.2.3"><mi id="A1.E17Xb.2.1.1.m1.12.15.2.3.2">d</mi><mo id="A1.E17Xb.2.1.1.m1.12.15.2.3.1">=</mo><mn id="A1.E17Xb.2.1.1.m1.12.15.2.3.3">1</mn></mrow><mi id="A1.E17Xb.2.1.1.m1.12.15.3">D</mi></munderover></mstyle><mrow id="A1.E17Xb.2.1.1.m1.12.16"><mo id="A1.E17Xb.2.1.1.m1.12.16.1">(</mo><mi id="A1.E17Xb.2.1.1.m1.12.12">log</mi><msup id="A1.E17Xb.2.1.1.m1.12.16.2"><mrow id="A1.E17Xb.2.1.1.m1.12.16.2.2"><mo id="A1.E17Xb.2.1.1.m1.12.16.2.2.1">(</mo><msub id="A1.E17Xb.2.1.1.m1.12.16.2.2.2"><mi id="A1.E17Xb.2.1.1.m1.12.16.2.2.2.2">σ</mi><mrow id="A1.E17Xb.2.1.1.m1.2.2.2.4"><mi id="A1.E17Xb.2.1.1.m1.1.1.1.1">i</mi><mo id="A1.E17Xb.2.1.1.m1.2.2.2.4.1">,</mo><mi id="A1.E17Xb.2.1.1.m1.2.2.2.2">d</mi></mrow></msub><mo id="A1.E17Xb.2.1.1.m1.12.16.2.2.3">)</mo></mrow><mn id="A1.E17Xb.2.1.1.m1.12.16.2.3">2</mn></msup><mo id="A1.E17Xb.2.1.1.m1.12.16.3">)</mo></mrow><mo id="A1.E17Xb.2.1.1.m1.12.17">−</mo><mstyle displaystyle="true" id="A1.E17Xb.2.1.1.m1.12.18"><mfrac id="A1.E17Xb.2.1.1.m1.12.18a"><mn id="A1.E17Xb.2.1.1.m1.12.18.2">1</mn><mn id="A1.E17Xb.2.1.1.m1.12.18.3">2</mn></mfrac></mstyle><mstyle displaystyle="true" id="A1.E17Xb.2.1.1.m1.12.19"><munderover id="A1.E17Xb.2.1.1.m1.12.19a"><mo id="A1.E17Xb.2.1.1.m1.12.19.2.2" movablelimits="false">∑</mo><mrow id="A1.E17Xb.2.1.1.m1.12.19.2.3"><mi id="A1.E17Xb.2.1.1.m1.12.19.2.3.2">c</mi><mo id="A1.E17Xb.2.1.1.m1.12.19.2.3.1">=</mo><mn id="A1.E17Xb.2.1.1.m1.12.19.2.3.3">1</mn></mrow><mi id="A1.E17Xb.2.1.1.m1.12.19.3">K</mi></munderover></mstyle><msub id="A1.E17Xb.2.1.1.m1.12.20"><mi id="A1.E17Xb.2.1.1.m1.12.20.2">γ</mi><mrow id="A1.E17Xb.2.1.1.m1.4.4.2.4"><mi id="A1.E17Xb.2.1.1.m1.3.3.1.1">i</mi><mo id="A1.E17Xb.2.1.1.m1.4.4.2.4.1">,</mo><mi id="A1.E17Xb.2.1.1.m1.4.4.2.2">c</mi></mrow></msub><mstyle displaystyle="true" id="A1.E17Xb.2.1.1.m1.12.21"><munderover id="A1.E17Xb.2.1.1.m1.12.21a"><mo id="A1.E17Xb.2.1.1.m1.12.21.2.2" movablelimits="false">∑</mo><mrow id="A1.E17Xb.2.1.1.m1.12.21.2.3"><mi id="A1.E17Xb.2.1.1.m1.12.21.2.3.2">d</mi><mo id="A1.E17Xb.2.1.1.m1.12.21.2.3.1">=</mo><mn id="A1.E17Xb.2.1.1.m1.12.21.2.3.3">1</mn></mrow><mi id="A1.E17Xb.2.1.1.m1.12.21.3">D</mi></munderover></mstyle><msup id="A1.E17Xb.2.1.1.m1.12.22"><mrow id="A1.E17Xb.2.1.1.m1.12.22.2"><mo id="A1.E17Xb.2.1.1.m1.12.22.2.1">(</mo><mstyle displaystyle="true" id="A1.E17Xb.2.1.1.m1.11.11"><mfrac id="A1.E17Xb.2.1.1.m1.11.11a"><mrow id="A1.E17Xb.2.1.1.m1.9.9.5.5"><mo id="A1.E17Xb.2.1.1.m1.9.9.5.5.2" stretchy="false">(</mo><mrow id="A1.E17Xb.2.1.1.m1.9.9.5.5.1"><msub id="A1.E17Xb.2.1.1.m1.9.9.5.5.1.2"><mi id="A1.E17Xb.2.1.1.m1.9.9.5.5.1.2.2">μ</mi><mrow id="A1.E17Xb.2.1.1.m1.6.6.2.2.2.4"><mi id="A1.E17Xb.2.1.1.m1.5.5.1.1.1.1">i</mi><mo id="A1.E17Xb.2.1.1.m1.6.6.2.2.2.4.1">,</mo><mi id="A1.E17Xb.2.1.1.m1.6.6.2.2.2.2">d</mi></mrow></msub><mo id="A1.E17Xb.2.1.1.m1.9.9.5.5.1.1">−</mo><msub id="A1.E17Xb.2.1.1.m1.9.9.5.5.1.3"><mover accent="true" id="A1.E17Xb.2.1.1.m1.9.9.5.5.1.3.2"><mi id="A1.E17Xb.2.1.1.m1.9.9.5.5.1.3.2.2">μ</mi><mo id="A1.E17Xb.2.1.1.m1.9.9.5.5.1.3.2.1">¯</mo></mover><mrow id="A1.E17Xb.2.1.1.m1.8.8.4.4.2.4"><mi id="A1.E17Xb.2.1.1.m1.7.7.3.3.1.1">c</mi><mo id="A1.E17Xb.2.1.1.m1.8.8.4.4.2.4.1">,</mo><mi id="A1.E17Xb.2.1.1.m1.8.8.4.4.2.2">d</mi></mrow></msub></mrow><mo id="A1.E17Xb.2.1.1.m1.9.9.5.5.3" stretchy="false">)</mo></mrow><msub id="A1.E17Xb.2.1.1.m1.11.11.7"><mover accent="true" id="A1.E17Xb.2.1.1.m1.11.11.7.4"><mi id="A1.E17Xb.2.1.1.m1.11.11.7.4.2">σ</mi><mo id="A1.E17Xb.2.1.1.m1.11.11.7.4.1">¯</mo></mover><mrow id="A1.E17Xb.2.1.1.m1.11.11.7.2.2.4"><mi id="A1.E17Xb.2.1.1.m1.10.10.6.1.1.1">c</mi><mo id="A1.E17Xb.2.1.1.m1.11.11.7.2.2.4.1">,</mo><mi id="A1.E17Xb.2.1.1.m1.11.11.7.2.2.2">d</mi></mrow></msub></mfrac></mstyle><mo id="A1.E17Xb.2.1.1.m1.12.22.2.2">)</mo></mrow><mn id="A1.E17Xb.2.1.1.m1.12.22.3">2</mn></msup><mo id="A1.E17Xb.2.1.1.m1.12.23">+</mo><mstyle displaystyle="true" id="A1.E17Xb.2.1.1.m1.12.24"><mfrac id="A1.E17Xb.2.1.1.m1.12.24a"><mn id="A1.E17Xb.2.1.1.m1.12.24.2">1</mn><mn id="A1.E17Xb.2.1.1.m1.12.24.3">2</mn></mfrac></mstyle></mrow><annotation encoding="application/x-tex" id="A1.E17Xb.2.1.1.m1.12c">\displaystyle+\frac{1}{2}\sum_{d=1}^{D}\left(\log\left(\sigma_{i,d}\right)^{2}%
\right)-\frac{1}{2}\sum_{c=1}^{K}\gamma_{i,c}\sum_{d=1}^{D}\left(\frac{(\mu_{i%
,d}-\bar{\mu}_{c,d})}{\bar{\sigma}_{c,d}}\right)^{2}+\frac{1}{2}</annotation><annotation encoding="application/x-llamapun" id="A1.E17Xb.2.1.1.m1.12d">+ divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∑ start_POSTSUBSCRIPT italic_d = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT ( roman_log ( italic_σ start_POSTSUBSCRIPT italic_i , italic_d end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) - divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∑ start_POSTSUBSCRIPT italic_c = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_γ start_POSTSUBSCRIPT italic_i , italic_c end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_d = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT ( divide start_ARG ( italic_μ start_POSTSUBSCRIPT italic_i , italic_d end_POSTSUBSCRIPT - over¯ start_ARG italic_μ end_ARG start_POSTSUBSCRIPT italic_c , italic_d end_POSTSUBSCRIPT ) end_ARG start_ARG over¯ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT italic_c , italic_d end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + divide start_ARG 1 end_ARG start_ARG 2 end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="A1.p5">
<p class="ltx_p" id="A1.p5.13">In this formulation, <math alttext="K" class="ltx_Math" display="inline" id="A1.p5.1.m1.1"><semantics id="A1.p5.1.m1.1a"><mi id="A1.p5.1.m1.1.1" xref="A1.p5.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.p5.1.m1.1b"><ci id="A1.p5.1.m1.1.1.cmml" xref="A1.p5.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A1.p5.1.m1.1d">italic_K</annotation></semantics></math> represents the number of clusters, <math alttext="D" class="ltx_Math" display="inline" id="A1.p5.2.m2.1"><semantics id="A1.p5.2.m2.1a"><mi id="A1.p5.2.m2.1.1" xref="A1.p5.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="A1.p5.2.m2.1b"><ci id="A1.p5.2.m2.1.1.cmml" xref="A1.p5.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.2.m2.1c">D</annotation><annotation encoding="application/x-llamapun" id="A1.p5.2.m2.1d">italic_D</annotation></semantics></math> is the dimensionality of the latent space, <math alttext="\gamma_{i,c}" class="ltx_Math" display="inline" id="A1.p5.3.m3.2"><semantics id="A1.p5.3.m3.2a"><msub id="A1.p5.3.m3.2.3" xref="A1.p5.3.m3.2.3.cmml"><mi id="A1.p5.3.m3.2.3.2" xref="A1.p5.3.m3.2.3.2.cmml">γ</mi><mrow id="A1.p5.3.m3.2.2.2.4" xref="A1.p5.3.m3.2.2.2.3.cmml"><mi id="A1.p5.3.m3.1.1.1.1" xref="A1.p5.3.m3.1.1.1.1.cmml">i</mi><mo id="A1.p5.3.m3.2.2.2.4.1" xref="A1.p5.3.m3.2.2.2.3.cmml">,</mo><mi id="A1.p5.3.m3.2.2.2.2" xref="A1.p5.3.m3.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.p5.3.m3.2b"><apply id="A1.p5.3.m3.2.3.cmml" xref="A1.p5.3.m3.2.3"><csymbol cd="ambiguous" id="A1.p5.3.m3.2.3.1.cmml" xref="A1.p5.3.m3.2.3">subscript</csymbol><ci id="A1.p5.3.m3.2.3.2.cmml" xref="A1.p5.3.m3.2.3.2">𝛾</ci><list id="A1.p5.3.m3.2.2.2.3.cmml" xref="A1.p5.3.m3.2.2.2.4"><ci id="A1.p5.3.m3.1.1.1.1.cmml" xref="A1.p5.3.m3.1.1.1.1">𝑖</ci><ci id="A1.p5.3.m3.2.2.2.2.cmml" xref="A1.p5.3.m3.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.3.m3.2c">\gamma_{i,c}</annotation><annotation encoding="application/x-llamapun" id="A1.p5.3.m3.2d">italic_γ start_POSTSUBSCRIPT italic_i , italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the probability that the <math alttext="i" class="ltx_Math" display="inline" id="A1.p5.4.m4.1"><semantics id="A1.p5.4.m4.1a"><mi id="A1.p5.4.m4.1.1" xref="A1.p5.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.p5.4.m4.1b"><ci id="A1.p5.4.m4.1.1.cmml" xref="A1.p5.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.p5.4.m4.1d">italic_i</annotation></semantics></math>-th sample belongs to cluster <math alttext="c" class="ltx_Math" display="inline" id="A1.p5.5.m5.1"><semantics id="A1.p5.5.m5.1a"><mi id="A1.p5.5.m5.1.1" xref="A1.p5.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.p5.5.m5.1b"><ci id="A1.p5.5.m5.1.1.cmml" xref="A1.p5.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.5.m5.1c">c</annotation><annotation encoding="application/x-llamapun" id="A1.p5.5.m5.1d">italic_c</annotation></semantics></math>, and <math alttext="\pi_{c}" class="ltx_Math" display="inline" id="A1.p5.6.m6.1"><semantics id="A1.p5.6.m6.1a"><msub id="A1.p5.6.m6.1.1" xref="A1.p5.6.m6.1.1.cmml"><mi id="A1.p5.6.m6.1.1.2" xref="A1.p5.6.m6.1.1.2.cmml">π</mi><mi id="A1.p5.6.m6.1.1.3" xref="A1.p5.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p5.6.m6.1b"><apply id="A1.p5.6.m6.1.1.cmml" xref="A1.p5.6.m6.1.1"><csymbol cd="ambiguous" id="A1.p5.6.m6.1.1.1.cmml" xref="A1.p5.6.m6.1.1">subscript</csymbol><ci id="A1.p5.6.m6.1.1.2.cmml" xref="A1.p5.6.m6.1.1.2">𝜋</ci><ci id="A1.p5.6.m6.1.1.3.cmml" xref="A1.p5.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.6.m6.1c">\pi_{c}</annotation><annotation encoding="application/x-llamapun" id="A1.p5.6.m6.1d">italic_π start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the prior probability of cluster <math alttext="c" class="ltx_Math" display="inline" id="A1.p5.7.m7.1"><semantics id="A1.p5.7.m7.1a"><mi id="A1.p5.7.m7.1.1" xref="A1.p5.7.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.p5.7.m7.1b"><ci id="A1.p5.7.m7.1.1.cmml" xref="A1.p5.7.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.7.m7.1c">c</annotation><annotation encoding="application/x-llamapun" id="A1.p5.7.m7.1d">italic_c</annotation></semantics></math>. The parameters <math alttext="\mu_{i,d}" class="ltx_Math" display="inline" id="A1.p5.8.m8.2"><semantics id="A1.p5.8.m8.2a"><msub id="A1.p5.8.m8.2.3" xref="A1.p5.8.m8.2.3.cmml"><mi id="A1.p5.8.m8.2.3.2" xref="A1.p5.8.m8.2.3.2.cmml">μ</mi><mrow id="A1.p5.8.m8.2.2.2.4" xref="A1.p5.8.m8.2.2.2.3.cmml"><mi id="A1.p5.8.m8.1.1.1.1" xref="A1.p5.8.m8.1.1.1.1.cmml">i</mi><mo id="A1.p5.8.m8.2.2.2.4.1" xref="A1.p5.8.m8.2.2.2.3.cmml">,</mo><mi id="A1.p5.8.m8.2.2.2.2" xref="A1.p5.8.m8.2.2.2.2.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.p5.8.m8.2b"><apply id="A1.p5.8.m8.2.3.cmml" xref="A1.p5.8.m8.2.3"><csymbol cd="ambiguous" id="A1.p5.8.m8.2.3.1.cmml" xref="A1.p5.8.m8.2.3">subscript</csymbol><ci id="A1.p5.8.m8.2.3.2.cmml" xref="A1.p5.8.m8.2.3.2">𝜇</ci><list id="A1.p5.8.m8.2.2.2.3.cmml" xref="A1.p5.8.m8.2.2.2.4"><ci id="A1.p5.8.m8.1.1.1.1.cmml" xref="A1.p5.8.m8.1.1.1.1">𝑖</ci><ci id="A1.p5.8.m8.2.2.2.2.cmml" xref="A1.p5.8.m8.2.2.2.2">𝑑</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.8.m8.2c">\mu_{i,d}</annotation><annotation encoding="application/x-llamapun" id="A1.p5.8.m8.2d">italic_μ start_POSTSUBSCRIPT italic_i , italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\sigma_{i,d}" class="ltx_Math" display="inline" id="A1.p5.9.m9.2"><semantics id="A1.p5.9.m9.2a"><msub id="A1.p5.9.m9.2.3" xref="A1.p5.9.m9.2.3.cmml"><mi id="A1.p5.9.m9.2.3.2" xref="A1.p5.9.m9.2.3.2.cmml">σ</mi><mrow id="A1.p5.9.m9.2.2.2.4" xref="A1.p5.9.m9.2.2.2.3.cmml"><mi id="A1.p5.9.m9.1.1.1.1" xref="A1.p5.9.m9.1.1.1.1.cmml">i</mi><mo id="A1.p5.9.m9.2.2.2.4.1" xref="A1.p5.9.m9.2.2.2.3.cmml">,</mo><mi id="A1.p5.9.m9.2.2.2.2" xref="A1.p5.9.m9.2.2.2.2.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.p5.9.m9.2b"><apply id="A1.p5.9.m9.2.3.cmml" xref="A1.p5.9.m9.2.3"><csymbol cd="ambiguous" id="A1.p5.9.m9.2.3.1.cmml" xref="A1.p5.9.m9.2.3">subscript</csymbol><ci id="A1.p5.9.m9.2.3.2.cmml" xref="A1.p5.9.m9.2.3.2">𝜎</ci><list id="A1.p5.9.m9.2.2.2.3.cmml" xref="A1.p5.9.m9.2.2.2.4"><ci id="A1.p5.9.m9.1.1.1.1.cmml" xref="A1.p5.9.m9.1.1.1.1">𝑖</ci><ci id="A1.p5.9.m9.2.2.2.2.cmml" xref="A1.p5.9.m9.2.2.2.2">𝑑</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.9.m9.2c">\sigma_{i,d}</annotation><annotation encoding="application/x-llamapun" id="A1.p5.9.m9.2d">italic_σ start_POSTSUBSCRIPT italic_i , italic_d end_POSTSUBSCRIPT</annotation></semantics></math> are the mean and standard deviation of the <math alttext="i" class="ltx_Math" display="inline" id="A1.p5.10.m10.1"><semantics id="A1.p5.10.m10.1a"><mi id="A1.p5.10.m10.1.1" xref="A1.p5.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.p5.10.m10.1b"><ci id="A1.p5.10.m10.1.1.cmml" xref="A1.p5.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.10.m10.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.p5.10.m10.1d">italic_i</annotation></semantics></math>-th sample in the d-th dimension, while <math alttext="\bar{\mu}{c,d}" class="ltx_Math" display="inline" id="A1.p5.11.m11.2"><semantics id="A1.p5.11.m11.2a"><mrow id="A1.p5.11.m11.2.2.1" xref="A1.p5.11.m11.2.2.2.cmml"><mrow id="A1.p5.11.m11.2.2.1.1" xref="A1.p5.11.m11.2.2.1.1.cmml"><mover accent="true" id="A1.p5.11.m11.2.2.1.1.2" xref="A1.p5.11.m11.2.2.1.1.2.cmml"><mi id="A1.p5.11.m11.2.2.1.1.2.2" xref="A1.p5.11.m11.2.2.1.1.2.2.cmml">μ</mi><mo id="A1.p5.11.m11.2.2.1.1.2.1" xref="A1.p5.11.m11.2.2.1.1.2.1.cmml">¯</mo></mover><mo id="A1.p5.11.m11.2.2.1.1.1" xref="A1.p5.11.m11.2.2.1.1.1.cmml">⁢</mo><mi id="A1.p5.11.m11.2.2.1.1.3" xref="A1.p5.11.m11.2.2.1.1.3.cmml">c</mi></mrow><mo id="A1.p5.11.m11.2.2.1.2" xref="A1.p5.11.m11.2.2.2.cmml">,</mo><mi id="A1.p5.11.m11.1.1" xref="A1.p5.11.m11.1.1.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p5.11.m11.2b"><list id="A1.p5.11.m11.2.2.2.cmml" xref="A1.p5.11.m11.2.2.1"><apply id="A1.p5.11.m11.2.2.1.1.cmml" xref="A1.p5.11.m11.2.2.1.1"><times id="A1.p5.11.m11.2.2.1.1.1.cmml" xref="A1.p5.11.m11.2.2.1.1.1"></times><apply id="A1.p5.11.m11.2.2.1.1.2.cmml" xref="A1.p5.11.m11.2.2.1.1.2"><ci id="A1.p5.11.m11.2.2.1.1.2.1.cmml" xref="A1.p5.11.m11.2.2.1.1.2.1">¯</ci><ci id="A1.p5.11.m11.2.2.1.1.2.2.cmml" xref="A1.p5.11.m11.2.2.1.1.2.2">𝜇</ci></apply><ci id="A1.p5.11.m11.2.2.1.1.3.cmml" xref="A1.p5.11.m11.2.2.1.1.3">𝑐</ci></apply><ci id="A1.p5.11.m11.1.1.cmml" xref="A1.p5.11.m11.1.1">𝑑</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.11.m11.2c">\bar{\mu}{c,d}</annotation><annotation encoding="application/x-llamapun" id="A1.p5.11.m11.2d">over¯ start_ARG italic_μ end_ARG italic_c , italic_d</annotation></semantics></math> and <math alttext="\bar{\sigma}{c,d}" class="ltx_Math" display="inline" id="A1.p5.12.m12.2"><semantics id="A1.p5.12.m12.2a"><mrow id="A1.p5.12.m12.2.2.1" xref="A1.p5.12.m12.2.2.2.cmml"><mrow id="A1.p5.12.m12.2.2.1.1" xref="A1.p5.12.m12.2.2.1.1.cmml"><mover accent="true" id="A1.p5.12.m12.2.2.1.1.2" xref="A1.p5.12.m12.2.2.1.1.2.cmml"><mi id="A1.p5.12.m12.2.2.1.1.2.2" xref="A1.p5.12.m12.2.2.1.1.2.2.cmml">σ</mi><mo id="A1.p5.12.m12.2.2.1.1.2.1" xref="A1.p5.12.m12.2.2.1.1.2.1.cmml">¯</mo></mover><mo id="A1.p5.12.m12.2.2.1.1.1" xref="A1.p5.12.m12.2.2.1.1.1.cmml">⁢</mo><mi id="A1.p5.12.m12.2.2.1.1.3" xref="A1.p5.12.m12.2.2.1.1.3.cmml">c</mi></mrow><mo id="A1.p5.12.m12.2.2.1.2" xref="A1.p5.12.m12.2.2.2.cmml">,</mo><mi id="A1.p5.12.m12.1.1" xref="A1.p5.12.m12.1.1.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p5.12.m12.2b"><list id="A1.p5.12.m12.2.2.2.cmml" xref="A1.p5.12.m12.2.2.1"><apply id="A1.p5.12.m12.2.2.1.1.cmml" xref="A1.p5.12.m12.2.2.1.1"><times id="A1.p5.12.m12.2.2.1.1.1.cmml" xref="A1.p5.12.m12.2.2.1.1.1"></times><apply id="A1.p5.12.m12.2.2.1.1.2.cmml" xref="A1.p5.12.m12.2.2.1.1.2"><ci id="A1.p5.12.m12.2.2.1.1.2.1.cmml" xref="A1.p5.12.m12.2.2.1.1.2.1">¯</ci><ci id="A1.p5.12.m12.2.2.1.1.2.2.cmml" xref="A1.p5.12.m12.2.2.1.1.2.2">𝜎</ci></apply><ci id="A1.p5.12.m12.2.2.1.1.3.cmml" xref="A1.p5.12.m12.2.2.1.1.3">𝑐</ci></apply><ci id="A1.p5.12.m12.1.1.cmml" xref="A1.p5.12.m12.1.1">𝑑</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.12.m12.2c">\bar{\sigma}{c,d}</annotation><annotation encoding="application/x-llamapun" id="A1.p5.12.m12.2d">over¯ start_ARG italic_σ end_ARG italic_c , italic_d</annotation></semantics></math> are the mean and standard deviation of cluster <math alttext="c" class="ltx_Math" display="inline" id="A1.p5.13.m13.1"><semantics id="A1.p5.13.m13.1a"><mi id="A1.p5.13.m13.1.1" xref="A1.p5.13.m13.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.p5.13.m13.1b"><ci id="A1.p5.13.m13.1.1.cmml" xref="A1.p5.13.m13.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.13.m13.1c">c</annotation><annotation encoding="application/x-llamapun" id="A1.p5.13.m13.1d">italic_c</annotation></semantics></math> in the d-th dimension.</p>
</div>
<div class="ltx_para" id="A1.p6">
<p class="ltx_p" id="A1.p6.1">By optimizing this ELBO, GaVaMoE can effectively learn a structured latent space that captures both user-item interactions and user clustering information, which is crucial for the subsequent multi-gating mechanism and personalized explanation generation.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Human scoring Criteria</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">This guide provides detailed instructions for evaluating generated explanations on a 1-to-5 scale across three dimensions: Personalization, Text Quality, and User Satisfaction:</p>
</div>
<div class="ltx_para" id="A2.p2">
<ul class="ltx_itemize" id="A2.I1">
<li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i1.p1.1.1">Personalization (P):</span> Consider the user’s past interactions, stated preferences, and behavioral patterns when assessing alignment. Look for specific mentions of user-relevant features or experiences.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i2.p1.1.1">Text Quality (Q):</span> Evaluate the explanation’s grammatical correctness, logical flow, and appropriate use of language. Consider whether the text would be easily understood by the average user.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i3.p1">
<p class="ltx_p" id="A2.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i3.p1.1.1">User Satisfaction (U):</span> Assess whether the explanation would likely motivate the user to engage further with the recommended item or the platform. Consider factors such as informativeness, persuasiveness, and appeal.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="A2.p3">
<p class="ltx_p" id="A2.p3.1">A detailed scoring guide with specific criteria for each score level is provided in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.11841v1#A2.T6" title="Table 6 ‣ Appendix B Human scoring Criteria ‣ GaVaMoE: Gaussian-Variational Gated Mixture of Experts for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>, ensuring consistency and reliability in the human evaluation process.</p>
</div>
<div class="ltx_para" id="A2.p4">
<p class="ltx_p" id="A2.p4.1">To ensure comprehensive and precise evaluations, human experts are encouraged to utilize the full range of the scale, including half-point scores (e.g., 3.5) when explanations fall between two score descriptions. This granular approach allows for a more nuanced assessment of the explanations’ quality and effectiveness.</p>
</div>
<figure class="ltx_table" id="A2.T6">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 6. </span>Scoring Criteria for Human Evaluation</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T6.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T6.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="A2.T6.4.1.1.1"><span class="ltx_text ltx_font_bold" id="A2.T6.4.1.1.1.1" style="font-size:90%;">Score</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A2.T6.4.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.1.1.2.1">
<span class="ltx_p" id="A2.T6.4.1.1.2.1.1" style="width:199.2pt;"><span class="ltx_text ltx_font_bold" id="A2.T6.4.1.1.2.1.1.1" style="font-size:90%;">Criteria Description</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="2" id="A2.T6.4.2.2.1"><span class="ltx_text ltx_font_bold" id="A2.T6.4.2.2.1.1" style="font-size:90%;">Personalization (P)</span></th>
</tr>
<tr class="ltx_tr" id="A2.T6.4.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.3.3.1"><span class="ltx_text" id="A2.T6.4.3.3.1.1" style="font-size:90%;">5</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.3.3.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.3.3.2.1">
<span class="ltx_p" id="A2.T6.4.3.3.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.3.3.2.1.1.1" style="font-size:90%;">Explanation perfectly aligns with user preferences, demonstrating deep understanding of individual tastes.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.4.4.1"><span class="ltx_text" id="A2.T6.4.4.4.1.1" style="font-size:90%;">4</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.4.4.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.4.4.2.1">
<span class="ltx_p" id="A2.T6.4.4.4.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.4.4.2.1.1.1" style="font-size:90%;">Explanation shows strong alignment with user preferences, with minor misalignments.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.5.5.1"><span class="ltx_text" id="A2.T6.4.5.5.1.1" style="font-size:90%;">3</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.5.5.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.5.5.2.1">
<span class="ltx_p" id="A2.T6.4.5.5.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.5.5.2.1.1.1" style="font-size:90%;">Explanation moderately aligns with user preferences, with some noticeable misalignments.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.6.6.1"><span class="ltx_text" id="A2.T6.4.6.6.1.1" style="font-size:90%;">2</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.6.6.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.6.6.2.1">
<span class="ltx_p" id="A2.T6.4.6.6.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.6.6.2.1.1.1" style="font-size:90%;">Explanation shows weak alignment with user preferences, with significant misalignments.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.7.7.1"><span class="ltx_text" id="A2.T6.4.7.7.1.1" style="font-size:90%;">1</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.7.7.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.7.7.2.1">
<span class="ltx_p" id="A2.T6.4.7.7.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.7.7.2.1.1.1" style="font-size:90%;">Explanation shows no alignment with user preferences.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="2" id="A2.T6.4.8.8.1"><span class="ltx_text ltx_font_bold" id="A2.T6.4.8.8.1.1" style="font-size:90%;">Text Quality (Q)</span></th>
</tr>
<tr class="ltx_tr" id="A2.T6.4.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.9.9.1"><span class="ltx_text" id="A2.T6.4.9.9.1.1" style="font-size:90%;">5</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.9.9.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.9.9.2.1">
<span class="ltx_p" id="A2.T6.4.9.9.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.9.9.2.1.1.1" style="font-size:90%;">Text is exceptionally clear, coherent, and well-structured, with no errors.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.10.10.1"><span class="ltx_text" id="A2.T6.4.10.10.1.1" style="font-size:90%;">4</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.10.10.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.10.10.2.1">
<span class="ltx_p" id="A2.T6.4.10.10.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.10.10.2.1.1.1" style="font-size:90%;">Text is clear and coherent, with minimal structural issues or errors.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.11.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.11.11.1"><span class="ltx_text" id="A2.T6.4.11.11.1.1" style="font-size:90%;">3</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.11.11.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.11.11.2.1">
<span class="ltx_p" id="A2.T6.4.11.11.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.11.11.2.1.1.1" style="font-size:90%;">Text is generally clear but has some issues with coherence or structure.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.12.12.1"><span class="ltx_text" id="A2.T6.4.12.12.1.1" style="font-size:90%;">2</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.12.12.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.12.12.2.1">
<span class="ltx_p" id="A2.T6.4.12.12.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.12.12.2.1.1.1" style="font-size:90%;">Text has notable issues with clarity, coherence, or structure.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.13.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.13.13.1"><span class="ltx_text" id="A2.T6.4.13.13.1.1" style="font-size:90%;">1</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.13.13.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.13.13.2.1">
<span class="ltx_p" id="A2.T6.4.13.13.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.13.13.2.1.1.1" style="font-size:90%;">Text is unclear, incoherent, or poorly structured.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="2" id="A2.T6.4.14.14.1"><span class="ltx_text ltx_font_bold" id="A2.T6.4.14.14.1.1" style="font-size:90%;">User Satisfaction (U)</span></th>
</tr>
<tr class="ltx_tr" id="A2.T6.4.15.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.15.15.1"><span class="ltx_text" id="A2.T6.4.15.15.1.1" style="font-size:90%;">5</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.15.15.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.15.15.2.1">
<span class="ltx_p" id="A2.T6.4.15.15.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.15.15.2.1.1.1" style="font-size:90%;">Explanation is highly engaging, likely to prompt immediate user interaction or action.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.16.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.16.16.1"><span class="ltx_text" id="A2.T6.4.16.16.1.1" style="font-size:90%;">4</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.16.16.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.16.16.2.1">
<span class="ltx_p" id="A2.T6.4.16.16.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.16.16.2.1.1.1" style="font-size:90%;">Explanation is engaging and likely to prompt user interaction.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.17.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.17.17.1"><span class="ltx_text" id="A2.T6.4.17.17.1.1" style="font-size:90%;">3</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.17.17.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.17.17.2.1">
<span class="ltx_p" id="A2.T6.4.17.17.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.17.17.2.1.1.1" style="font-size:90%;">Explanation is somewhat engaging, may prompt user interaction.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.18.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A2.T6.4.18.18.1"><span class="ltx_text" id="A2.T6.4.18.18.1.1" style="font-size:90%;">2</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T6.4.18.18.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.18.18.2.1">
<span class="ltx_p" id="A2.T6.4.18.18.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.18.18.2.1.1.1" style="font-size:90%;">Explanation is unlikely to prompt user interaction.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.19.19">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A2.T6.4.19.19.1"><span class="ltx_text" id="A2.T6.4.19.19.1.1" style="font-size:90%;">1</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="A2.T6.4.19.19.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T6.4.19.19.2.1">
<span class="ltx_p" id="A2.T6.4.19.19.2.1.1" style="width:199.2pt;"><span class="ltx_text" id="A2.T6.4.19.19.2.1.1.1" style="font-size:90%;">Explanation is likely to discourage user interaction.</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Oct 15 17:56:30 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
