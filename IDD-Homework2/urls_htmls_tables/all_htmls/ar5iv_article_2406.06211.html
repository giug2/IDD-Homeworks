<article class="ltx_document ltx_authors_1line">
 <h1 class="ltx_title ltx_title_document">
  iMotion-LLM: Motion Prediction Instruction Tuning
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Abdulwahab Felemban
    <sup class="ltx_sup" id="id7.7.id1">
     1
    </sup>
    Eslam Mohamed Bakr
    <sup class="ltx_sup" id="id8.8.id2">
     1
    </sup>
    Xiaoqian Shen
    <sup class="ltx_sup" id="id9.9.id3">
     1
    </sup>
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_bold" id="id4.4.1">
     Jian Ding
     <sup class="ltx_sup" id="id4.4.1.1">
      <span class="ltx_text ltx_font_medium" id="id4.4.1.1.1">
       1
      </span>
     </sup>
    </span>
    <span class="ltx_text ltx_font_bold" id="id5.5.2">
     Abduallah Mohamed
     <sup class="ltx_sup" id="id5.5.2.1">
      <span class="ltx_text ltx_font_medium" id="id5.5.2.1.1">
       2
      </span>
     </sup>
    </span>
    <span class="ltx_text ltx_font_bold" id="id6.6.3">
     Mohamed Elhoseiny
     <sup class="ltx_sup" id="id6.6.3.1">
      <span class="ltx_text ltx_font_medium" id="id6.6.3.1.1">
       1
      </span>
     </sup>
    </span>
    <br class="ltx_break"/>
    <sup class="ltx_sup" id="id10.10.id4">
     1
    </sup>
    KAUST
    <sup class="ltx_sup" id="id11.11.id5">
     2
    </sup>
    Meta Reality Labs
    <br class="ltx_break"/>
    <sup class="ltx_sup" id="id12.12.id6">
     1
    </sup>
    <span class="ltx_text ltx_font_typewriter" id="id13.13.id7">
     {abdulwahab.felemban, eslam.abdelrahman, xiaoqian.shen
    </span>
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id14.14.id8">
     jian.ding, mohamed.elhoseiny}@kaust.edu.sa
    </span>
    <br class="ltx_break"/>
    <sup class="ltx_sup" id="id15.15.id9">
     2
    </sup>
    abduallahadel@meta.com
   </span>
   <span class="ltx_author_notes">
    This work was done outside of Meta with personal capacity.
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id16.id1">
   We introduce iMotion-LLM: a Multimodal Large Language Models (LLMs) with trajectory prediction, tailored to guide interactive multi-agent scenarios. Different from conventional motion prediction approaches, iMotion-LLM capitalizes on textual instructions as key inputs for generating contextually relevant trajectories. By enriching the real-world driving scenarios in the Waymo Open Dataset with textual motion instructions, we created InstructWaymo. Leveraging this dataset, iMotion-LLM integrates a pretrained LLM, fine-tuned with LoRA, to translate scene features into the LLM input space.
iMotion-LLM offers significant advantages over conventional motion prediction models. First, it can generate trajectories that align with the provided instructions if it is a feasible direction. Second, when given an infeasible direction, it can reject the instruction, thereby enhancing safety.
These findings act as milestones in empowering autonomous navigation systems to interpret and predict the dynamics of multi-agent environments, laying the groundwork for future advancements in this field.
  </p>
 </div>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <figure class="ltx_figure" id="S1.F1">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="249" id="S1.F1.g1" src="/html/2406.06211/assets/x1.png" width="461"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S1.F1.3.1.1" style="font-size:90%;">
      Figure 1
     </span>
     :
    </span>
    <span class="ltx_text" id="S1.F1.4.2" style="font-size:90%;">
     Our iMotion-LLM model can process three types of instructions and predict the corresponding trajectories. First, it can handle ground truth instructions that align with the direction of the recorded real-scenario trajectory (
     <span class="ltx_text ltx_font_italic" id="S1.F1.4.2.1">
      e.g.
     </span>
     , Waymo Open Dataset), correctly accepting the instruction and providing an explanation and trajectory. Second, iMotion-LLM can follow other feasible non-ground truth directions and predict the correct explanation and trajectory. Finally, when given an infeasible direction, iMotion-LLM correctly rejects the instruction.
    </span>
   </figcaption>
  </figure>
  <div class="ltx_para" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    Motion prediction is a crucial component in autonomous driving. Forecasting future trajectories of surrounding entities based on historical data is vital for safety and motion planning. Recent challenges,
    <span class="ltx_text ltx_font_italic" id="S1.p1.1.1">
     e.g.
    </span>
    , Waymo Open Dataset challenges
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib18" title="">
      18
     </a>
     ]
    </cite>
    , introduce a track specifically designed to concentrate on motion prediction where 1.1 seconds of the past motion is observed, and 8 seconds to be predicted into the future.
Various methodologies
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib25" title="">
      25
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib43" title="">
      43
     </a>
     ]
    </cite>
    have been developed to tackle this challenge; however, they lack support for human-vehicle interaction through interactive instructions.
   </p>
  </div>
  <div class="ltx_para" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    With the advent of large language models (LLMs), significant advancements have been made in applying LLMs to the autonomous driving context
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib50" title="">
      50
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib11" title="">
      11
     </a>
     ]
    </cite>
    .
Integrating LLMs into autonomous driving systems markedly improves decision-making and vehicle adaptability. This advancement results in more intelligent, reactive vehicles and promotes more intuitive human-machine interactions, making autonomous driving more effective and user-friendly.
However, the majority of existing LLM applications in autonomous driving
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib50" title="">
      50
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib11" title="">
      11
     </a>
     ]
    </cite>
    concentrate on text or image inputs, neglecting the potential of vectorized motion prediction data. Vectorized motion data offers an abstract view of driving scenarios, providing essential information for motion prediction, such as the historical states of agents; they usually offer other vectorized map features like the locations of traffic lights or lane centers.
The investigation into LLM applications for vector data is still underexplored
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib7" title="">
      7
     </a>
     ]
    </cite>
    , indicating an opportunity to improve autonomous driving technology by exploiting the benefits of vector data.
   </p>
  </div>
  <div class="ltx_para" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    To this end, we integrate LLMs with vectorized motion prediction data and introduce the instructing motion prediction task that utilizes human instructions and scene data as inputs. iMotion-LLM can output trajectory forecasts, language explanation of how the vehicle executes this trajectory if it can, and a decision of whether to accept or reject the instruction based on feasibility, as illustrated in Figure
    <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    and Figure
    <a class="ltx_ref" href="#S4.F3" title="Figure 3 ‣ 4 iMotion-LLM ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      3
     </span>
    </a>
    .
To support this task, we augment the Waymo Open dataset
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib17" title="">
      17
     </a>
     ]
    </cite>
    with ego vehicle direction instructions. The instruction details and statistics are explained in Section
    <a class="ltx_ref" href="#S3" title="3 InstructWaymo: Instruction Augmentation of Waymo Open Dataset ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      3
     </span>
    </a>
    .
Subsequently, we introduce the iMotion-LLM: an instructable motion prediction model based on Large Language Models (LLMs).
iMotion-LLM, harnesses pretrained models’ multi-modal trajectory prediction capabilities through an encoder-decoder transformer architecture.
As shown in Figure
    <a class="ltx_ref" href="#S4.F3" title="Figure 3 ‣ 4 iMotion-LLM ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      3
     </span>
    </a>
    , it employs an LLM Projection to project encoded scene context embeddings from the Scene Encoder into the LLM input space.
The LLM generates instruction token [I] and N [S] tokens representing scene context embeddings.
These are combined into a single query by the Instruct Mapper. The resulting keys and values, derived and projected by the Scene Mapper, are used by the Multi-modal Trajectory Prediction Decoder.
Our experiments, using GameFormer
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib25" title="">
      25
     </a>
     ]
    </cite>
    as a backbone, show that iMotion-LLM empowers autonomous navigation systems to interpret and predict the dynamics of multi-agent environments, while matching the performance of existing models.
   </p>
  </div>
  <div class="ltx_para" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    Our contributions can be summarized as:
   </p>
   <ul class="ltx_itemize" id="S1.I1">
    <li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I1.i1.p1">
      <p class="ltx_p" id="S1.I1.i1.p1.1">
       We proposed the instructing motion prediction task, which takes human instructions and scene data as inputs and outputs a text to indicate a decision, a text that describes how the action is executed, and trajectory predictions.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I1.i2.p1">
      <p class="ltx_p" id="S1.I1.i2.p1.1">
       We augmented the Waymo Open Dataset with instruction categories enabling instructing the motion prediction task. This augmentation, named InstructWaymo, is easily expandable to include more driving scenarios information of higher granularity and will benefit future research in this direction.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I1.i3.p1">
      <p class="ltx_p" id="S1.I1.i3.p1.1">
       We introduced two evaluation metrics: Instruction Following Recall (IFR) and Direction Variety Score (DVS), to measure the model’s ability to adhere to instructions and the diversity of the predicted modalities across different directional categories. These attributes cannot be reflected in the conventional metrics used in the motion prediction task.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I1.i4.p1">
      <p class="ltx_p" id="S1.I1.i4.p1.1">
       We introduced the iMotion-LLM: an instructing motion prediction model based on Large Language Models (LLMs). Different from earlier motion prediction models, iMotion-LLM leverages instructions, scene and vectorized motion data as an input to generate contextually relevant predictions.
      </p>
     </div>
    </li>
   </ul>
  </div>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Related Work
  </h2>
  <div class="ltx_para" id="S2.p1">
   <p class="ltx_p" id="S2.p1.1">
    <span class="ltx_text ltx_font_bold" id="S2.p1.1.1">
     Multimodal Large Langauge Models.
    </span>
    Large Language Models (LLMs) have significantly advanced in recent years
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib40" title="">
      40
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib15" title="">
      15
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib5" title="">
      5
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib47" title="">
      47
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib46" title="">
      46
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib1" title="">
      1
     </a>
     ]
    </cite>
    , with models like GPT-4
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib1" title="">
      1
     </a>
     ]
    </cite>
    demonstrating remarkable abilities in generating coherent, contextually relevant text across numerous domains. With the strong performance of LLMs, there is an emergence of multi-modal LLMs (MLLMs)
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib3" title="">
      3
     </a>
     ]
    </cite>
    , which extend the LLMs with reasoning abilities across diverse modalities. Notable works includes Flamingo
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib3" title="">
      3
     </a>
     ]
    </cite>
    , InstructBLIP
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib14" title="">
      14
     </a>
     ]
    </cite>
    , MiniGPT-4
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib6" title="">
      6
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib52" title="">
      52
     </a>
     ]
    </cite>
    , LLaVA
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib32" title="">
      32
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib31" title="">
      31
     </a>
     ]
    </cite>
    , and Vicuna
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib10" title="">
      10
     </a>
     ]
    </cite>
    . These works used visual instruction tuning to align with human intentions. There are some extensions that focus on detection and segmentation
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib52" title="">
      52
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib48" title="">
      48
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib29" title="">
      29
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib4" title="">
      4
     </a>
     ]
    </cite>
    , videos
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib30" title="">
      30
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib51" title="">
      51
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib33" title="">
      33
     </a>
     ]
    </cite>
    , and 3D
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib22" title="">
      22
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib49" title="">
      49
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib20" title="">
      20
     </a>
     ]
    </cite>
    . Our work focuses on MLLMs for motion prediction tasks.
   </p>
  </div>
  <div class="ltx_para" id="S2.p2">
   <p class="ltx_p" id="S2.p2.1">
    <span class="ltx_text ltx_font_bold" id="S2.p2.1.1">
     Motion Prediction Models for Driving Scenarios.
    </span>
    The task of motion prediction involves analyzing the historical tracks of agents on a corresponding map to predict their joint future positions several seconds into the future. LSTMs
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib2" title="">
      2
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib21" title="">
      21
     </a>
     ]
    </cite>
    have been used to encode the historical states of agents, while CNNs
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib12" title="">
      12
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib19" title="">
      19
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib41" title="">
      41
     </a>
     ]
    </cite>
    have been employed to encode the rasterized images of the scene. Recently, GNNs
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib9" title="">
      9
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib27" title="">
      27
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib36" title="">
      36
     </a>
     ]
    </cite>
    have been employed to depict agent interactions effectively. The advent of Transformer-based models, like SceneTransformer
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib39" title="">
      39
     </a>
     ]
    </cite>
    and WayFormer
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib38" title="">
      38
     </a>
     ]
    </cite>
    , has further enhanced prediction through their efficient structure, though they primarily focus on the encoding process. Motion Transformer
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib44" title="">
      44
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib45" title="">
      45
     </a>
     ]
    </cite>
    and GameFormer
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib26" title="">
      26
     </a>
     ]
    </cite>
    innovates by improving the decoding stage, leading to better accuracy. MotionLLM
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib42" title="">
      42
     </a>
     ]
    </cite>
    used similar structures of LLM for the modeling, but still did not introduce the language reasoning ability to motion prediction task.
   </p>
  </div>
  <div class="ltx_para" id="S2.p3">
   <p class="ltx_p" id="S2.p3.1">
    <span class="ltx_text ltx_font_bold" id="S2.p3.1.1">
     Multimodal Large Language Models for autonomous driving.
    </span>
    With the emergence of LLM, there is a trend to adapt LLM for autonomous driving scenes
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib8" title="">
      8
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib16" title="">
      16
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib23" title="">
      23
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib24" title="">
      24
     </a>
     ]
    </cite>
    . Innovations like GPT-Driver
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib34" title="">
      34
     </a>
     ]
    </cite>
    and SurrealDriver
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib28" title="">
      28
     </a>
     ]
    </cite>
    exemplify the transformative impact of LLMs in motion planning and driving maneuver generation, marking significant advancements in autonomous vehicle technology. However, the majority of existing methods primarily focus on text or image inputs, overlooking the benefits of vector data in motion prediction, which include reduced computational complexity and improved accuracy. In this paper, we integrate Large Language Models (LLMs) with vector-based data for motion prediction.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   InstructWaymo: Instruction Augmentation of Waymo Open Dataset
  </h2>
  <div class="ltx_para" id="S3.p1">
   <p class="ltx_p" id="S3.p1.1">
    InstructWaymo introduces a new perspective on the Waymo Open Dataset by making motion prediction instructable and language descriptive. We designed a module that categorizes future motion into different directions, speeds, and acceleration categories. Additionally, we extract scene attributes from the most recent observed time step (at 1.1 seconds), including the relative locations of nearby agents, traffic lights, and stop signs. InstructWaymo uses future direction information as an instruction and all other information, including future motion details, as an output caption. To enhance iMotion-LLM training and evaluation, we measure direction feasibility based on the ego vehicle’s current location, heading, speed, and detected road center lanes to determine if specific directions are feasible to execute or not. InstructWaymo integrates this information into the output caption. We provide InstructWaymo as a script to augment the Wamo Open Dataset.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S3.p2">
   <p class="ltx_p" id="S3.p2.1">
    <span class="ltx_text ltx_font_bold" id="S3.p2.1.1">
     Direction.
    </span>
    Direction is fundamental for instructing navigation, drawing inspiration from the mean Average Precision (mAP) metric utilized in Waymo motion prediction challenges
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib17" title="">
      17
     </a>
     ]
    </cite>
    , where they compute mAP across various motion ranges to comprehensively assess performance across diverse driving behaviors. We reuse their definition of driving behaviors, obtaining eight conceivable direction conditions encompassing 8 classes listed in Table
    <a class="ltx_ref" href="#S3.T1" title="Table 1 ‣ 3 InstructWaymo: Instruction Augmentation of Waymo Open Dataset ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    with their statistics in the training and evaluation sets. See the calculation of the direction in Section
    <a class="ltx_ref" href="#A2" title="Appendix B Calculation of the directions ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      B
     </span>
    </a>
    in the appendix.
   </p>
  </div>
  <figure class="ltx_table" id="S3.T1">
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     <span class="ltx_text" id="S3.T1.2.1.1" style="font-size:90%;">
      Table 1
     </span>
     :
    </span>
    <span class="ltx_text" id="S3.T1.3.2" style="font-size:90%;">
     Direction categories with their corresponding presence proportion in the train set of 327,391 driving scenarios and in the test set of 2,311 driving scenarios.
    </span>
   </figcaption>
   <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.4" style="width:425.9pt;height:46.7pt;vertical-align:-0.8pt;">
    <span class="ltx_transformed_inner" style="transform:translate(-37.6pt,4.1pt) scale(0.85,0.85) ;">
     <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.4.1">
      <thead class="ltx_thead">
       <tr class="ltx_tr" id="S3.T1.4.1.1.1">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.4.1.1.1.1">
         Category
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.4.1.1.1.2">
         Stationary
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.4.1.1.1.3">
         Straight
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.4.1.1.1.4">
         Straight-right
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.4.1.1.1.5">
         Straight-left
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.4.1.1.1.6">
         Right
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.4.1.1.1.7">
         Left
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.4.1.1.1.8">
         Right u-turn
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.4.1.1.1.9">
         Left u-turn
        </th>
       </tr>
      </thead>
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="S3.T1.4.1.2.1">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.4.1.2.1.1">
         Train
        </th>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.4.1.2.1.2">
         1.6%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.4.1.2.1.3">
         55.8%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.4.1.2.1.4">
         3.3%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.4.1.2.1.5">
         3.7%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.4.1.2.1.6">
         16.7%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.4.1.2.1.7">
         17.5%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.4.1.2.1.8">
         0.1%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.4.1.2.1.9">
         1.4%
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T1.4.1.3.2">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T1.4.1.3.2.1">
         Test
        </th>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.4.1.3.2.2">
         1.8%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.4.1.3.2.3">
         56.1%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.4.1.3.2.4">
         3.3%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.4.1.3.2.5">
         3.2%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.4.1.3.2.6">
         16.7%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.4.1.3.2.7">
         17.7%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.4.1.3.2.8">
         0.0%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.4.1.3.2.9">
         1.1%
        </td>
       </tr>
      </tbody>
     </table>
    </span>
   </div>
  </figure>
  <div class="ltx_para ltx_noindent" id="S3.p3">
   <p class="ltx_p" id="S3.p3.1">
    <span class="ltx_text ltx_font_bold" id="S3.p3.1.1">
     Speed and Acceleration.
    </span>
    Following the intuition used in
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib37" title="">
      37
     </a>
     ]
    </cite>
    , we categorize trajectories of moving vehicles based on speeds and relative change in speeds. For that, we heuristically defined 5-speed categories and 9-acceleration categories; the suggested upper threshold and the categories are listed in the appendix in Table
    <a class="ltx_ref" href="#A1.T6" title="Table 6 ‣ Appendix A Speed and acceleration categories ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      6
     </span>
    </a>
    .
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S3.p4">
   <p class="ltx_p" id="S3.p4.1">
    <span class="ltx_text ltx_font_bold" id="S3.p4.1.1">
     Transcribing scene and map information.
    </span>
    Based on the latest observed time step information, the Waymo Open Dataset provides easy access to different attributes agents and scene attributes. Agents and map information are transcribed as relative locations to the ego vehicle, enriching the contextual driving information. A relative location is transcribed as a relative distance with a relative directional position (for example, Agent-2 is 10m far behind).
   </p>
  </div>
  <figure class="ltx_figure ltx_align_floatright" id="S3.F2">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="428" id="S3.F2.g1" src="/html/2406.06211/assets/figures/lane_feasibility.png" width="598"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S3.F2.6.3.1" style="font-size:90%;">
      Figure 2
     </span>
     :
    </span>
    <span class="ltx_text" id="S3.F2.4.2" style="font-size:90%;">
     Feasibility detection of lane directions with "move straight" and "turn right" as feasible directions within a range of (
     <math alttext="r1" class="ltx_Math" display="inline" id="S3.F2.3.1.m1.1">
      <semantics id="S3.F2.3.1.m1.1b">
       <mrow id="S3.F2.3.1.m1.1.1" xref="S3.F2.3.1.m1.1.1.cmml">
        <mi id="S3.F2.3.1.m1.1.1.2" xref="S3.F2.3.1.m1.1.1.2.cmml">
         r
        </mi>
        <mo id="S3.F2.3.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S3.F2.3.1.m1.1.1.1.cmml">
         ​
        </mo>
        <mn id="S3.F2.3.1.m1.1.1.3" xref="S3.F2.3.1.m1.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.F2.3.1.m1.1c">
        <apply id="S3.F2.3.1.m1.1.1.cmml" xref="S3.F2.3.1.m1.1.1">
         <times id="S3.F2.3.1.m1.1.1.1.cmml" xref="S3.F2.3.1.m1.1.1.1">
         </times>
         <ci id="S3.F2.3.1.m1.1.1.2.cmml" xref="S3.F2.3.1.m1.1.1.2">
          𝑟
         </ci>
         <cn id="S3.F2.3.1.m1.1.1.3.cmml" type="integer" xref="S3.F2.3.1.m1.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.3.1.m1.1d">
        r1
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="r2" class="ltx_Math" display="inline" id="S3.F2.4.2.m2.1">
      <semantics id="S3.F2.4.2.m2.1b">
       <mrow id="S3.F2.4.2.m2.1.1" xref="S3.F2.4.2.m2.1.1.cmml">
        <mi id="S3.F2.4.2.m2.1.1.2" xref="S3.F2.4.2.m2.1.1.2.cmml">
         r
        </mi>
        <mo id="S3.F2.4.2.m2.1.1.1" lspace="0em" rspace="0em" xref="S3.F2.4.2.m2.1.1.1.cmml">
         ​
        </mo>
        <mn id="S3.F2.4.2.m2.1.1.3" xref="S3.F2.4.2.m2.1.1.3.cmml">
         2
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.F2.4.2.m2.1c">
        <apply id="S3.F2.4.2.m2.1.1.cmml" xref="S3.F2.4.2.m2.1.1">
         <times id="S3.F2.4.2.m2.1.1.1.cmml" xref="S3.F2.4.2.m2.1.1.1">
         </times>
         <ci id="S3.F2.4.2.m2.1.1.2.cmml" xref="S3.F2.4.2.m2.1.1.2">
          𝑟
         </ci>
         <cn id="S3.F2.4.2.m2.1.1.3.cmml" type="integer" xref="S3.F2.4.2.m2.1.1.3">
          2
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.4.2.m2.1d">
        r2
       </annotation>
      </semantics>
     </math>
     ).
    </span>
   </figcaption>
  </figure>
  <div class="ltx_para ltx_noindent" id="S3.p5">
   <p class="ltx_p" id="S3.p5.2">
    <span class="ltx_text ltx_font_bold" id="S3.p5.2.1">
     Feasibility of directions.
    </span>
    We define the feasibility of directions into three categories: 1) actual-scenario direction, which is based on the ground truth future trajectory and hence is always assumed to be a feasible direction; 2) Other feasible directions that are not the actual-scenario direction; 3) Infeasible directions, which is the complement set of feasible directions. To assess feasibility, we consider a set of candidate destinations relative to the ego vehicle’s current location and heading. These candidate destinations are possible locations on associated lanes within a range determined by the vehicle’s speed (minimum range
    <math alttext="r_{1}" class="ltx_Math" display="inline" id="S3.p5.1.m1.1">
     <semantics id="S3.p5.1.m1.1a">
      <msub id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">
       <mi id="S3.p5.1.m1.1.1.2" xref="S3.p5.1.m1.1.1.2.cmml">
        r
       </mi>
       <mn id="S3.p5.1.m1.1.1.3" xref="S3.p5.1.m1.1.1.3.cmml">
        1
       </mn>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b">
       <apply id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1">
        <csymbol cd="ambiguous" id="S3.p5.1.m1.1.1.1.cmml" xref="S3.p5.1.m1.1.1">
         subscript
        </csymbol>
        <ci id="S3.p5.1.m1.1.1.2.cmml" xref="S3.p5.1.m1.1.1.2">
         𝑟
        </ci>
        <cn id="S3.p5.1.m1.1.1.3.cmml" type="integer" xref="S3.p5.1.m1.1.1.3">
         1
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">
       r_{1}
      </annotation>
     </semantics>
    </math>
    , maximum range
    <math alttext="r_{2}" class="ltx_Math" display="inline" id="S3.p5.2.m2.1">
     <semantics id="S3.p5.2.m2.1a">
      <msub id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml">
       <mi id="S3.p5.2.m2.1.1.2" xref="S3.p5.2.m2.1.1.2.cmml">
        r
       </mi>
       <mn id="S3.p5.2.m2.1.1.3" xref="S3.p5.2.m2.1.1.3.cmml">
        2
       </mn>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b">
       <apply id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1">
        <csymbol cd="ambiguous" id="S3.p5.2.m2.1.1.1.cmml" xref="S3.p5.2.m2.1.1">
         subscript
        </csymbol>
        <ci id="S3.p5.2.m2.1.1.2.cmml" xref="S3.p5.2.m2.1.1.2">
         𝑟
        </ci>
        <cn id="S3.p5.2.m2.1.1.3.cmml" type="integer" xref="S3.p5.2.m2.1.1.3">
         2
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">
       r_{2}
      </annotation>
     </semantics>
    </math>
    ). Figure
    <a class="ltx_ref" href="#S3.F2" title="Figure 2 ‣ 3 InstructWaymo: Instruction Augmentation of Waymo Open Dataset ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    illustrates this concept with two feasible directions.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S3.p6">
   <p class="ltx_p" id="S3.p6.1">
    <span class="ltx_text ltx_font_bold" id="S3.p6.1.1">
     LLM Instruction and caption.
    </span>
    Based on the previously extracted attributes, we generate a template of input instruction and output caption that the LLM can process. The input can be either the final future direction or additional two-step directions and speeds. in the results section, we focus on the model trained and evaluated with the final future direction instructions only unless otherwise stated. The output caption that the LLM aligns to generate auto-regressively includes the final direction, with two-step directions, speeds, and accelerations achieving the final direction. Additionally, it states the relative position of the interactive agent (Agent-2), and the relative locations of the closest traffic light and stop sign. In this work, we considered selecting the relative location of the agent labeled as the interactive agent (Agent-2) in the Waymo Interaction Prediction challenge.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   iMotion-LLM
  </h2>
  <figure class="ltx_figure" id="S4.F3">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="261" id="S4.F3.g1" src="/html/2406.06211/assets/x2.png" width="346"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">
      Figure 3
     </span>
     :
    </span>
    <span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">
     The proposed pipeline, referred to as iMotion-LLM, leverages the multi-modal trajectory prediction capabilities of pretrained models, employing an encoder-decoder transformer architecture.
Given a textual instruction and scene context embeddings, iMotion-LLM utilizes an LLM Mapper to project the encoded scene context embeddings from the Scene Encoder into the LLM input space. Subsequently, the LLM generates an instruction token [I] and a sequence of [S] tokens representing the scene context embeddings. The [I] token is projected to a query, and the scene context-generated tokens are projected to be the keys and values utilized by the multi-modal trajectory prediction decoder.
    </span>
   </figcaption>
  </figure>
  <div class="ltx_para ltx_noindent" id="S4.p1">
   <p class="ltx_p" id="S4.p1.5">
    <span class="ltx_text ltx_font_bold" id="S4.p1.5.1">
     Revisiting existing models.
    </span>
    Recent successful transformer-based interactive trajectory prediction models
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib25" title="">
      25
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib43" title="">
      43
     </a>
     ]
    </cite>
    commonly employ a schema comprising two main blocks. Initially, a scene encoder encodes the observed map and agent information into embeddings representing scene context information
    <math alttext="S\in\mathbb{R}^{R\times d_{scene}}" class="ltx_Math" display="inline" id="S4.p1.1.m1.1">
     <semantics id="S4.p1.1.m1.1a">
      <mrow id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">
       <mi id="S4.p1.1.m1.1.1.2" xref="S4.p1.1.m1.1.1.2.cmml">
        S
       </mi>
       <mo id="S4.p1.1.m1.1.1.1" xref="S4.p1.1.m1.1.1.1.cmml">
        ∈
       </mo>
       <msup id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">
        <mi id="S4.p1.1.m1.1.1.3.2" xref="S4.p1.1.m1.1.1.3.2.cmml">
         ℝ
        </mi>
        <mrow id="S4.p1.1.m1.1.1.3.3" xref="S4.p1.1.m1.1.1.3.3.cmml">
         <mi id="S4.p1.1.m1.1.1.3.3.2" xref="S4.p1.1.m1.1.1.3.3.2.cmml">
          R
         </mi>
         <mo id="S4.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.p1.1.m1.1.1.3.3.1.cmml">
          ×
         </mo>
         <msub id="S4.p1.1.m1.1.1.3.3.3" xref="S4.p1.1.m1.1.1.3.3.3.cmml">
          <mi id="S4.p1.1.m1.1.1.3.3.3.2" xref="S4.p1.1.m1.1.1.3.3.3.2.cmml">
           d
          </mi>
          <mrow id="S4.p1.1.m1.1.1.3.3.3.3" xref="S4.p1.1.m1.1.1.3.3.3.3.cmml">
           <mi id="S4.p1.1.m1.1.1.3.3.3.3.2" xref="S4.p1.1.m1.1.1.3.3.3.3.2.cmml">
            s
           </mi>
           <mo id="S4.p1.1.m1.1.1.3.3.3.3.1" lspace="0em" rspace="0em" xref="S4.p1.1.m1.1.1.3.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="S4.p1.1.m1.1.1.3.3.3.3.3" xref="S4.p1.1.m1.1.1.3.3.3.3.3.cmml">
            c
           </mi>
           <mo id="S4.p1.1.m1.1.1.3.3.3.3.1a" lspace="0em" rspace="0em" xref="S4.p1.1.m1.1.1.3.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="S4.p1.1.m1.1.1.3.3.3.3.4" xref="S4.p1.1.m1.1.1.3.3.3.3.4.cmml">
            e
           </mi>
           <mo id="S4.p1.1.m1.1.1.3.3.3.3.1b" lspace="0em" rspace="0em" xref="S4.p1.1.m1.1.1.3.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="S4.p1.1.m1.1.1.3.3.3.3.5" xref="S4.p1.1.m1.1.1.3.3.3.3.5.cmml">
            n
           </mi>
           <mo id="S4.p1.1.m1.1.1.3.3.3.3.1c" lspace="0em" rspace="0em" xref="S4.p1.1.m1.1.1.3.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="S4.p1.1.m1.1.1.3.3.3.3.6" xref="S4.p1.1.m1.1.1.3.3.3.3.6.cmml">
            e
           </mi>
          </mrow>
         </msub>
        </mrow>
       </msup>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b">
       <apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">
        <in id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1">
        </in>
        <ci id="S4.p1.1.m1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.2">
         𝑆
        </ci>
        <apply id="S4.p1.1.m1.1.1.3.cmml" xref="S4.p1.1.m1.1.1.3">
         <csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.3.1.cmml" xref="S4.p1.1.m1.1.1.3">
          superscript
         </csymbol>
         <ci id="S4.p1.1.m1.1.1.3.2.cmml" xref="S4.p1.1.m1.1.1.3.2">
          ℝ
         </ci>
         <apply id="S4.p1.1.m1.1.1.3.3.cmml" xref="S4.p1.1.m1.1.1.3.3">
          <times id="S4.p1.1.m1.1.1.3.3.1.cmml" xref="S4.p1.1.m1.1.1.3.3.1">
          </times>
          <ci id="S4.p1.1.m1.1.1.3.3.2.cmml" xref="S4.p1.1.m1.1.1.3.3.2">
           𝑅
          </ci>
          <apply id="S4.p1.1.m1.1.1.3.3.3.cmml" xref="S4.p1.1.m1.1.1.3.3.3">
           <csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.3.3.3.1.cmml" xref="S4.p1.1.m1.1.1.3.3.3">
            subscript
           </csymbol>
           <ci id="S4.p1.1.m1.1.1.3.3.3.2.cmml" xref="S4.p1.1.m1.1.1.3.3.3.2">
            𝑑
           </ci>
           <apply id="S4.p1.1.m1.1.1.3.3.3.3.cmml" xref="S4.p1.1.m1.1.1.3.3.3.3">
            <times id="S4.p1.1.m1.1.1.3.3.3.3.1.cmml" xref="S4.p1.1.m1.1.1.3.3.3.3.1">
            </times>
            <ci id="S4.p1.1.m1.1.1.3.3.3.3.2.cmml" xref="S4.p1.1.m1.1.1.3.3.3.3.2">
             𝑠
            </ci>
            <ci id="S4.p1.1.m1.1.1.3.3.3.3.3.cmml" xref="S4.p1.1.m1.1.1.3.3.3.3.3">
             𝑐
            </ci>
            <ci id="S4.p1.1.m1.1.1.3.3.3.3.4.cmml" xref="S4.p1.1.m1.1.1.3.3.3.3.4">
             𝑒
            </ci>
            <ci id="S4.p1.1.m1.1.1.3.3.3.3.5.cmml" xref="S4.p1.1.m1.1.1.3.3.3.3.5">
             𝑛
            </ci>
            <ci id="S4.p1.1.m1.1.1.3.3.3.3.6.cmml" xref="S4.p1.1.m1.1.1.3.3.3.3.6">
             𝑒
            </ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">
       S\in\mathbb{R}^{R\times d_{scene}}
      </annotation>
     </semantics>
    </math>
    , where
    <math alttext="d_{scene}" class="ltx_Math" display="inline" id="S4.p1.2.m2.1">
     <semantics id="S4.p1.2.m2.1a">
      <msub id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">
       <mi id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">
        d
       </mi>
       <mrow id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml">
        <mi id="S4.p1.2.m2.1.1.3.2" xref="S4.p1.2.m2.1.1.3.2.cmml">
         s
        </mi>
        <mo id="S4.p1.2.m2.1.1.3.1" lspace="0em" rspace="0em" xref="S4.p1.2.m2.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S4.p1.2.m2.1.1.3.3" xref="S4.p1.2.m2.1.1.3.3.cmml">
         c
        </mi>
        <mo id="S4.p1.2.m2.1.1.3.1a" lspace="0em" rspace="0em" xref="S4.p1.2.m2.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S4.p1.2.m2.1.1.3.4" xref="S4.p1.2.m2.1.1.3.4.cmml">
         e
        </mi>
        <mo id="S4.p1.2.m2.1.1.3.1b" lspace="0em" rspace="0em" xref="S4.p1.2.m2.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S4.p1.2.m2.1.1.3.5" xref="S4.p1.2.m2.1.1.3.5.cmml">
         n
        </mi>
        <mo id="S4.p1.2.m2.1.1.3.1c" lspace="0em" rspace="0em" xref="S4.p1.2.m2.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S4.p1.2.m2.1.1.3.6" xref="S4.p1.2.m2.1.1.3.6.cmml">
         e
        </mi>
       </mrow>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b">
       <apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">
        <csymbol cd="ambiguous" id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1">
         subscript
        </csymbol>
        <ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">
         𝑑
        </ci>
        <apply id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3">
         <times id="S4.p1.2.m2.1.1.3.1.cmml" xref="S4.p1.2.m2.1.1.3.1">
         </times>
         <ci id="S4.p1.2.m2.1.1.3.2.cmml" xref="S4.p1.2.m2.1.1.3.2">
          𝑠
         </ci>
         <ci id="S4.p1.2.m2.1.1.3.3.cmml" xref="S4.p1.2.m2.1.1.3.3">
          𝑐
         </ci>
         <ci id="S4.p1.2.m2.1.1.3.4.cmml" xref="S4.p1.2.m2.1.1.3.4">
          𝑒
         </ci>
         <ci id="S4.p1.2.m2.1.1.3.5.cmml" xref="S4.p1.2.m2.1.1.3.5">
          𝑛
         </ci>
         <ci id="S4.p1.2.m2.1.1.3.6.cmml" xref="S4.p1.2.m2.1.1.3.6">
          𝑒
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">
       d_{scene}
      </annotation>
     </semantics>
    </math>
    is the embedding dimension. Subsequently, the multimodal trajectory prediction decoder utilizes cross-attention with
    <math alttext="S" class="ltx_Math" display="inline" id="S4.p1.3.m3.1">
     <semantics id="S4.p1.3.m3.1a">
      <mi id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">
       S
      </mi>
      <annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b">
       <ci id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">
        𝑆
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">
       S
      </annotation>
     </semantics>
    </math>
    as keys and values, employing
    <math alttext="K" class="ltx_Math" display="inline" id="S4.p1.4.m4.1">
     <semantics id="S4.p1.4.m4.1a">
      <mi id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml">
       K
      </mi>
      <annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b">
       <ci id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1">
        𝐾
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">
       K
      </annotation>
     </semantics>
    </math>
    learnable queries
    <math alttext="q_{motion}\in\mathbb{R}^{K\times d_{scene}}" class="ltx_Math" display="inline" id="S4.p1.5.m5.1">
     <semantics id="S4.p1.5.m5.1a">
      <mrow id="S4.p1.5.m5.1.1" xref="S4.p1.5.m5.1.1.cmml">
       <msub id="S4.p1.5.m5.1.1.2" xref="S4.p1.5.m5.1.1.2.cmml">
        <mi id="S4.p1.5.m5.1.1.2.2" xref="S4.p1.5.m5.1.1.2.2.cmml">
         q
        </mi>
        <mrow id="S4.p1.5.m5.1.1.2.3" xref="S4.p1.5.m5.1.1.2.3.cmml">
         <mi id="S4.p1.5.m5.1.1.2.3.2" xref="S4.p1.5.m5.1.1.2.3.2.cmml">
          m
         </mi>
         <mo id="S4.p1.5.m5.1.1.2.3.1" lspace="0em" rspace="0em" xref="S4.p1.5.m5.1.1.2.3.1.cmml">
          ​
         </mo>
         <mi id="S4.p1.5.m5.1.1.2.3.3" xref="S4.p1.5.m5.1.1.2.3.3.cmml">
          o
         </mi>
         <mo id="S4.p1.5.m5.1.1.2.3.1a" lspace="0em" rspace="0em" xref="S4.p1.5.m5.1.1.2.3.1.cmml">
          ​
         </mo>
         <mi id="S4.p1.5.m5.1.1.2.3.4" xref="S4.p1.5.m5.1.1.2.3.4.cmml">
          t
         </mi>
         <mo id="S4.p1.5.m5.1.1.2.3.1b" lspace="0em" rspace="0em" xref="S4.p1.5.m5.1.1.2.3.1.cmml">
          ​
         </mo>
         <mi id="S4.p1.5.m5.1.1.2.3.5" xref="S4.p1.5.m5.1.1.2.3.5.cmml">
          i
         </mi>
         <mo id="S4.p1.5.m5.1.1.2.3.1c" lspace="0em" rspace="0em" xref="S4.p1.5.m5.1.1.2.3.1.cmml">
          ​
         </mo>
         <mi id="S4.p1.5.m5.1.1.2.3.6" xref="S4.p1.5.m5.1.1.2.3.6.cmml">
          o
         </mi>
         <mo id="S4.p1.5.m5.1.1.2.3.1d" lspace="0em" rspace="0em" xref="S4.p1.5.m5.1.1.2.3.1.cmml">
          ​
         </mo>
         <mi id="S4.p1.5.m5.1.1.2.3.7" xref="S4.p1.5.m5.1.1.2.3.7.cmml">
          n
         </mi>
        </mrow>
       </msub>
       <mo id="S4.p1.5.m5.1.1.1" xref="S4.p1.5.m5.1.1.1.cmml">
        ∈
       </mo>
       <msup id="S4.p1.5.m5.1.1.3" xref="S4.p1.5.m5.1.1.3.cmml">
        <mi id="S4.p1.5.m5.1.1.3.2" xref="S4.p1.5.m5.1.1.3.2.cmml">
         ℝ
        </mi>
        <mrow id="S4.p1.5.m5.1.1.3.3" xref="S4.p1.5.m5.1.1.3.3.cmml">
         <mi id="S4.p1.5.m5.1.1.3.3.2" xref="S4.p1.5.m5.1.1.3.3.2.cmml">
          K
         </mi>
         <mo id="S4.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.p1.5.m5.1.1.3.3.1.cmml">
          ×
         </mo>
         <msub id="S4.p1.5.m5.1.1.3.3.3" xref="S4.p1.5.m5.1.1.3.3.3.cmml">
          <mi id="S4.p1.5.m5.1.1.3.3.3.2" xref="S4.p1.5.m5.1.1.3.3.3.2.cmml">
           d
          </mi>
          <mrow id="S4.p1.5.m5.1.1.3.3.3.3" xref="S4.p1.5.m5.1.1.3.3.3.3.cmml">
           <mi id="S4.p1.5.m5.1.1.3.3.3.3.2" xref="S4.p1.5.m5.1.1.3.3.3.3.2.cmml">
            s
           </mi>
           <mo id="S4.p1.5.m5.1.1.3.3.3.3.1" lspace="0em" rspace="0em" xref="S4.p1.5.m5.1.1.3.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="S4.p1.5.m5.1.1.3.3.3.3.3" xref="S4.p1.5.m5.1.1.3.3.3.3.3.cmml">
            c
           </mi>
           <mo id="S4.p1.5.m5.1.1.3.3.3.3.1a" lspace="0em" rspace="0em" xref="S4.p1.5.m5.1.1.3.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="S4.p1.5.m5.1.1.3.3.3.3.4" xref="S4.p1.5.m5.1.1.3.3.3.3.4.cmml">
            e
           </mi>
           <mo id="S4.p1.5.m5.1.1.3.3.3.3.1b" lspace="0em" rspace="0em" xref="S4.p1.5.m5.1.1.3.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="S4.p1.5.m5.1.1.3.3.3.3.5" xref="S4.p1.5.m5.1.1.3.3.3.3.5.cmml">
            n
           </mi>
           <mo id="S4.p1.5.m5.1.1.3.3.3.3.1c" lspace="0em" rspace="0em" xref="S4.p1.5.m5.1.1.3.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="S4.p1.5.m5.1.1.3.3.3.3.6" xref="S4.p1.5.m5.1.1.3.3.3.3.6.cmml">
            e
           </mi>
          </mrow>
         </msub>
        </mrow>
       </msup>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S4.p1.5.m5.1b">
       <apply id="S4.p1.5.m5.1.1.cmml" xref="S4.p1.5.m5.1.1">
        <in id="S4.p1.5.m5.1.1.1.cmml" xref="S4.p1.5.m5.1.1.1">
        </in>
        <apply id="S4.p1.5.m5.1.1.2.cmml" xref="S4.p1.5.m5.1.1.2">
         <csymbol cd="ambiguous" id="S4.p1.5.m5.1.1.2.1.cmml" xref="S4.p1.5.m5.1.1.2">
          subscript
         </csymbol>
         <ci id="S4.p1.5.m5.1.1.2.2.cmml" xref="S4.p1.5.m5.1.1.2.2">
          𝑞
         </ci>
         <apply id="S4.p1.5.m5.1.1.2.3.cmml" xref="S4.p1.5.m5.1.1.2.3">
          <times id="S4.p1.5.m5.1.1.2.3.1.cmml" xref="S4.p1.5.m5.1.1.2.3.1">
          </times>
          <ci id="S4.p1.5.m5.1.1.2.3.2.cmml" xref="S4.p1.5.m5.1.1.2.3.2">
           𝑚
          </ci>
          <ci id="S4.p1.5.m5.1.1.2.3.3.cmml" xref="S4.p1.5.m5.1.1.2.3.3">
           𝑜
          </ci>
          <ci id="S4.p1.5.m5.1.1.2.3.4.cmml" xref="S4.p1.5.m5.1.1.2.3.4">
           𝑡
          </ci>
          <ci id="S4.p1.5.m5.1.1.2.3.5.cmml" xref="S4.p1.5.m5.1.1.2.3.5">
           𝑖
          </ci>
          <ci id="S4.p1.5.m5.1.1.2.3.6.cmml" xref="S4.p1.5.m5.1.1.2.3.6">
           𝑜
          </ci>
          <ci id="S4.p1.5.m5.1.1.2.3.7.cmml" xref="S4.p1.5.m5.1.1.2.3.7">
           𝑛
          </ci>
         </apply>
        </apply>
        <apply id="S4.p1.5.m5.1.1.3.cmml" xref="S4.p1.5.m5.1.1.3">
         <csymbol cd="ambiguous" id="S4.p1.5.m5.1.1.3.1.cmml" xref="S4.p1.5.m5.1.1.3">
          superscript
         </csymbol>
         <ci id="S4.p1.5.m5.1.1.3.2.cmml" xref="S4.p1.5.m5.1.1.3.2">
          ℝ
         </ci>
         <apply id="S4.p1.5.m5.1.1.3.3.cmml" xref="S4.p1.5.m5.1.1.3.3">
          <times id="S4.p1.5.m5.1.1.3.3.1.cmml" xref="S4.p1.5.m5.1.1.3.3.1">
          </times>
          <ci id="S4.p1.5.m5.1.1.3.3.2.cmml" xref="S4.p1.5.m5.1.1.3.3.2">
           𝐾
          </ci>
          <apply id="S4.p1.5.m5.1.1.3.3.3.cmml" xref="S4.p1.5.m5.1.1.3.3.3">
           <csymbol cd="ambiguous" id="S4.p1.5.m5.1.1.3.3.3.1.cmml" xref="S4.p1.5.m5.1.1.3.3.3">
            subscript
           </csymbol>
           <ci id="S4.p1.5.m5.1.1.3.3.3.2.cmml" xref="S4.p1.5.m5.1.1.3.3.3.2">
            𝑑
           </ci>
           <apply id="S4.p1.5.m5.1.1.3.3.3.3.cmml" xref="S4.p1.5.m5.1.1.3.3.3.3">
            <times id="S4.p1.5.m5.1.1.3.3.3.3.1.cmml" xref="S4.p1.5.m5.1.1.3.3.3.3.1">
            </times>
            <ci id="S4.p1.5.m5.1.1.3.3.3.3.2.cmml" xref="S4.p1.5.m5.1.1.3.3.3.3.2">
             𝑠
            </ci>
            <ci id="S4.p1.5.m5.1.1.3.3.3.3.3.cmml" xref="S4.p1.5.m5.1.1.3.3.3.3.3">
             𝑐
            </ci>
            <ci id="S4.p1.5.m5.1.1.3.3.3.3.4.cmml" xref="S4.p1.5.m5.1.1.3.3.3.3.4">
             𝑒
            </ci>
            <ci id="S4.p1.5.m5.1.1.3.3.3.3.5.cmml" xref="S4.p1.5.m5.1.1.3.3.3.3.5">
             𝑛
            </ci>
            <ci id="S4.p1.5.m5.1.1.3.3.3.3.6.cmml" xref="S4.p1.5.m5.1.1.3.3.3.3.6">
             𝑒
            </ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">
       q_{motion}\in\mathbb{R}^{K\times d_{scene}}
      </annotation>
     </semantics>
    </math>
    to predict a Gaussian Mixture Model (GMM) of future trajectories for interactive agents. Both the Scene Encoder and Trajectory Decoder are depicted in Figure
    <a class="ltx_ref" href="#S4.F3" title="Figure 3 ‣ 4 iMotion-LLM ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      3
     </span>
    </a>
    . The vectorized motion data is encoded through an LSTM, while the map features are processed using Multi-Layer Perceptrons (MLPs) for continuous features such as center lanes, or embedding layers for categorical features like the state of traffic lights. Subsequently, the Scene Encoder functions as a feature fusion layer.
   </p>
  </div>
  <section class="ltx_subsection" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    Conditional Multimodal Trajectory Prediction Decoder
   </h3>
   <div class="ltx_para" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.4">
     To generate a conditional output, cGAN
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib35" title="">
       35
      </a>
      ]
     </cite>
     uses a conditioning signal in the generator model’s input. Inspired by this, we fuse an additional learnable query,
     <math alttext="q_{\text{instruction}}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1">
      <semantics id="S4.SS1.p1.1.m1.1a">
       <msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">
        <mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">
         q
        </mi>
        <mtext id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3a.cmml">
         instruction
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b">
        <apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">
          𝑞
         </ci>
         <ci id="S4.SS1.p1.1.m1.1.1.3a.cmml" xref="S4.SS1.p1.1.m1.1.1.3">
          <mtext id="S4.SS1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p1.1.m1.1.1.3">
           instruction
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">
        q_{\text{instruction}}
       </annotation>
      </semantics>
     </math>
     , with the motion generation queries,
     <math alttext="q_{\text{motion}}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1">
      <semantics id="S4.SS1.p1.2.m2.1a">
       <msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">
        <mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">
         q
        </mi>
        <mtext id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3a.cmml">
         motion
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b">
        <apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">
          𝑞
         </ci>
         <ci id="S4.SS1.p1.2.m2.1.1.3a.cmml" xref="S4.SS1.p1.2.m2.1.1.3">
          <mtext id="S4.SS1.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p1.2.m2.1.1.3">
           motion
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">
        q_{\text{motion}}
       </annotation>
      </semantics>
     </math>
     . For the base model,
     <math alttext="q_{\text{instruction}}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1">
      <semantics id="S4.SS1.p1.3.m3.1a">
       <msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">
        <mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">
         q
        </mi>
        <mtext id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3a.cmml">
         instruction
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b">
        <apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">
          𝑞
         </ci>
         <ci id="S4.SS1.p1.3.m3.1.1.3a.cmml" xref="S4.SS1.p1.3.m3.1.1.3">
          <mtext id="S4.SS1.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p1.3.m3.1.1.3">
           instruction
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">
        q_{\text{instruction}}
       </annotation>
      </semantics>
     </math>
     is learned using a simple embedding layer with a categorical class as input. When integrating an LLM with the base model,
     <math alttext="q_{\text{instruction}}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1">
      <semantics id="S4.SS1.p1.4.m4.1a">
       <msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">
        <mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">
         q
        </mi>
        <mtext id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3a.cmml">
         instruction
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b">
        <apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">
          𝑞
         </ci>
         <ci id="S4.SS1.p1.4.m4.1.1.3a.cmml" xref="S4.SS1.p1.4.m4.1.1.3">
          <mtext id="S4.SS1.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p1.4.m4.1.1.3">
           instruction
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">
        q_{\text{instruction}}
       </annotation>
      </semantics>
     </math>
     is derived from the LLM’s output embeddings as described in the next subsection.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.2
    </span>
    Integration of iMotion-LLM
   </h3>
   <div class="ltx_para" id="S4.SS2.p1">
    <p class="ltx_p" id="S4.SS2.p1.1">
     In our proposed design we integrate, align, and instruct fine-tune the LLM with a pretrained Scene Encoder and the Multi-modal Trajectory Prediction Decoder. The LLM lies between them, and enables instructability. To enable this integrational design, illustrated in Figure
     <a class="ltx_ref" href="#S4.F3" title="Figure 3 ‣ 4 iMotion-LLM ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     , five main blocks are required:
1) LLM Projection module.
2) LLM itself.
3) Scene Mapper.
4) Instruction Mapper.
5) Output Caption.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p2">
    <p class="ltx_p" id="S4.SS2.p2.3">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p2.3.1">
      LLM Projection.
     </span>
     Inspired by Vision-LLMs
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib13" title="">
       13
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib53" title="">
       53
      </a>
      ]
     </cite>
     , we employ a simple MLP-based projection layer to map input scene embeddings
     <math alttext="S\in\mathbb{R}^{R\times d_{scene}}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1">
      <semantics id="S4.SS2.p2.1.m1.1a">
       <mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">
        <mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">
         S
        </mi>
        <mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">
         ∈
        </mo>
        <msup id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">
         <mi id="S4.SS2.p2.1.m1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.3.2.cmml">
          ℝ
         </mi>
         <mrow id="S4.SS2.p2.1.m1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.cmml">
          <mi id="S4.SS2.p2.1.m1.1.1.3.3.2" xref="S4.SS2.p2.1.m1.1.1.3.3.2.cmml">
           R
          </mi>
          <mo id="S4.SS2.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p2.1.m1.1.1.3.3.1.cmml">
           ×
          </mo>
          <msub id="S4.SS2.p2.1.m1.1.1.3.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.3.cmml">
           <mi id="S4.SS2.p2.1.m1.1.1.3.3.3.2" xref="S4.SS2.p2.1.m1.1.1.3.3.3.2.cmml">
            d
           </mi>
           <mrow id="S4.SS2.p2.1.m1.1.1.3.3.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.cmml">
            <mi id="S4.SS2.p2.1.m1.1.1.3.3.3.3.2" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.2.cmml">
             s
            </mi>
            <mo id="S4.SS2.p2.1.m1.1.1.3.3.3.3.1" lspace="0em" rspace="0em" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.1.cmml">
             ​
            </mo>
            <mi id="S4.SS2.p2.1.m1.1.1.3.3.3.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.3.cmml">
             c
            </mi>
            <mo id="S4.SS2.p2.1.m1.1.1.3.3.3.3.1a" lspace="0em" rspace="0em" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.1.cmml">
             ​
            </mo>
            <mi id="S4.SS2.p2.1.m1.1.1.3.3.3.3.4" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.4.cmml">
             e
            </mi>
            <mo id="S4.SS2.p2.1.m1.1.1.3.3.3.3.1b" lspace="0em" rspace="0em" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.1.cmml">
             ​
            </mo>
            <mi id="S4.SS2.p2.1.m1.1.1.3.3.3.3.5" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.5.cmml">
             n
            </mi>
            <mo id="S4.SS2.p2.1.m1.1.1.3.3.3.3.1c" lspace="0em" rspace="0em" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.1.cmml">
             ​
            </mo>
            <mi id="S4.SS2.p2.1.m1.1.1.3.3.3.3.6" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.6.cmml">
             e
            </mi>
           </mrow>
          </msub>
         </mrow>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b">
        <apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">
         <in id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1">
         </in>
         <ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">
          𝑆
         </ci>
         <apply id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">
          <csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3">
           superscript
          </csymbol>
          <ci id="S4.SS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2">
           ℝ
          </ci>
          <apply id="S4.SS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3">
           <times id="S4.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.1">
           </times>
           <ci id="S4.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.2">
            𝑅
           </ci>
           <apply id="S4.SS2.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3">
            <csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.3.3.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3">
             subscript
            </csymbol>
            <ci id="S4.SS2.p2.1.m1.1.1.3.3.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3.2">
             𝑑
            </ci>
            <apply id="S4.SS2.p2.1.m1.1.1.3.3.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3">
             <times id="S4.SS2.p2.1.m1.1.1.3.3.3.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.1">
             </times>
             <ci id="S4.SS2.p2.1.m1.1.1.3.3.3.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.2">
              𝑠
             </ci>
             <ci id="S4.SS2.p2.1.m1.1.1.3.3.3.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.3">
              𝑐
             </ci>
             <ci id="S4.SS2.p2.1.m1.1.1.3.3.3.3.4.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.4">
              𝑒
             </ci>
             <ci id="S4.SS2.p2.1.m1.1.1.3.3.3.3.5.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.5">
              𝑛
             </ci>
             <ci id="S4.SS2.p2.1.m1.1.1.3.3.3.3.6.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.6">
              𝑒
             </ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">
        S\in\mathbb{R}^{R\times d_{scene}}
       </annotation>
      </semantics>
     </math>
     to
     <math alttext="\tilde{S}\in\mathbb{R}^{R\times d_{LLM}}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1">
      <semantics id="S4.SS2.p2.2.m2.1a">
       <mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">
        <mover accent="true" id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">
         <mi id="S4.SS2.p2.2.m2.1.1.2.2" xref="S4.SS2.p2.2.m2.1.1.2.2.cmml">
          S
         </mi>
         <mo id="S4.SS2.p2.2.m2.1.1.2.1" xref="S4.SS2.p2.2.m2.1.1.2.1.cmml">
          ~
         </mo>
        </mover>
        <mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">
         ∈
        </mo>
        <msup id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">
         <mi id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">
          ℝ
         </mi>
         <mrow id="S4.SS2.p2.2.m2.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml">
          <mi id="S4.SS2.p2.2.m2.1.1.3.3.2" xref="S4.SS2.p2.2.m2.1.1.3.3.2.cmml">
           R
          </mi>
          <mo id="S4.SS2.p2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p2.2.m2.1.1.3.3.1.cmml">
           ×
          </mo>
          <msub id="S4.SS2.p2.2.m2.1.1.3.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.3.cmml">
           <mi id="S4.SS2.p2.2.m2.1.1.3.3.3.2" xref="S4.SS2.p2.2.m2.1.1.3.3.3.2.cmml">
            d
           </mi>
           <mrow id="S4.SS2.p2.2.m2.1.1.3.3.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3.cmml">
            <mi id="S4.SS2.p2.2.m2.1.1.3.3.3.3.2" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3.2.cmml">
             L
            </mi>
            <mo id="S4.SS2.p2.2.m2.1.1.3.3.3.3.1" lspace="0em" rspace="0em" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3.1.cmml">
             ​
            </mo>
            <mi id="S4.SS2.p2.2.m2.1.1.3.3.3.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3.3.cmml">
             L
            </mi>
            <mo id="S4.SS2.p2.2.m2.1.1.3.3.3.3.1a" lspace="0em" rspace="0em" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3.1.cmml">
             ​
            </mo>
            <mi id="S4.SS2.p2.2.m2.1.1.3.3.3.3.4" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3.4.cmml">
             M
            </mi>
           </mrow>
          </msub>
         </mrow>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b">
        <apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">
         <in id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1">
         </in>
         <apply id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">
          <ci id="S4.SS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.2.1">
           ~
          </ci>
          <ci id="S4.SS2.p2.2.m2.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2.2">
           𝑆
          </ci>
         </apply>
         <apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">
          <csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3">
           superscript
          </csymbol>
          <ci id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">
           ℝ
          </ci>
          <apply id="S4.SS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3">
           <times id="S4.SS2.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.1">
           </times>
           <ci id="S4.SS2.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.2">
            𝑅
           </ci>
           <apply id="S4.SS2.p2.2.m2.1.1.3.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3">
            <csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.3.3.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3">
             subscript
            </csymbol>
            <ci id="S4.SS2.p2.2.m2.1.1.3.3.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3.2">
             𝑑
            </ci>
            <apply id="S4.SS2.p2.2.m2.1.1.3.3.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3">
             <times id="S4.SS2.p2.2.m2.1.1.3.3.3.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3.1">
             </times>
             <ci id="S4.SS2.p2.2.m2.1.1.3.3.3.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3.2">
              𝐿
             </ci>
             <ci id="S4.SS2.p2.2.m2.1.1.3.3.3.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3.3">
              𝐿
             </ci>
             <ci id="S4.SS2.p2.2.m2.1.1.3.3.3.3.4.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3.3.4">
              𝑀
             </ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">
        \tilde{S}\in\mathbb{R}^{R\times d_{LLM}}
       </annotation>
      </semantics>
     </math>
     , aligning with the LLM embeddings dimension
     <math alttext="d_{LLM}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1">
      <semantics id="S4.SS2.p2.3.m3.1a">
       <msub id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">
        <mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">
         d
        </mi>
        <mrow id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">
         <mi id="S4.SS2.p2.3.m3.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.3.2.cmml">
          L
         </mi>
         <mo id="S4.SS2.p2.3.m3.1.1.3.1" lspace="0em" rspace="0em" xref="S4.SS2.p2.3.m3.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.p2.3.m3.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml">
          L
         </mi>
         <mo id="S4.SS2.p2.3.m3.1.1.3.1a" lspace="0em" rspace="0em" xref="S4.SS2.p2.3.m3.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.p2.3.m3.1.1.3.4" xref="S4.SS2.p2.3.m3.1.1.3.4.cmml">
          M
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b">
        <apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">
          𝑑
         </ci>
         <apply id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">
          <times id="S4.SS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3.1">
          </times>
          <ci id="S4.SS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.3.2">
           𝐿
          </ci>
          <ci id="S4.SS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3">
           𝐿
          </ci>
          <ci id="S4.SS2.p2.3.m3.1.1.3.4.cmml" xref="S4.SS2.p2.3.m3.1.1.3.4">
           𝑀
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">
        d_{LLM}
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p3">
    <p class="ltx_p" id="S4.SS2.p3.6">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p3.6.1">
      LLM.
     </span>
     Projected scene embeddings
     <math alttext="\tilde{S}" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1">
      <semantics id="S4.SS2.p3.1.m1.1a">
       <mover accent="true" id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">
        <mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">
         S
        </mi>
        <mo id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b">
        <apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">
         <ci id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1">
          ~
         </ci>
         <ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">
          𝑆
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">
        \tilde{S}
       </annotation>
      </semantics>
     </math>
     and input instruction
     <math alttext="T_{I}" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1">
      <semantics id="S4.SS2.p3.2.m2.1a">
       <msub id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">
        <mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">
         T
        </mi>
        <mi id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">
         I
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b">
        <apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">
          𝑇
         </ci>
         <ci id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">
          𝐼
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">
        T_{I}
       </annotation>
      </semantics>
     </math>
     are fed to the LLM to generate new tokens,
     <math alttext="[I;S_{1};S_{2};\dots;S_{N}]" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.5">
      <semantics id="S4.SS2.p3.3.m3.5a">
       <mrow id="S4.SS2.p3.3.m3.5.5.3" xref="S4.SS2.p3.3.m3.5.5.4.cmml">
        <mo id="S4.SS2.p3.3.m3.5.5.3.4" stretchy="false" xref="S4.SS2.p3.3.m3.5.5.4.cmml">
         [
        </mo>
        <mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">
         I
        </mi>
        <mo id="S4.SS2.p3.3.m3.5.5.3.5" xref="S4.SS2.p3.3.m3.5.5.4.cmml">
         ;
        </mo>
        <msub id="S4.SS2.p3.3.m3.3.3.1.1" xref="S4.SS2.p3.3.m3.3.3.1.1.cmml">
         <mi id="S4.SS2.p3.3.m3.3.3.1.1.2" xref="S4.SS2.p3.3.m3.3.3.1.1.2.cmml">
          S
         </mi>
         <mn id="S4.SS2.p3.3.m3.3.3.1.1.3" xref="S4.SS2.p3.3.m3.3.3.1.1.3.cmml">
          1
         </mn>
        </msub>
        <mo id="S4.SS2.p3.3.m3.5.5.3.6" xref="S4.SS2.p3.3.m3.5.5.4.cmml">
         ;
        </mo>
        <msub id="S4.SS2.p3.3.m3.4.4.2.2" xref="S4.SS2.p3.3.m3.4.4.2.2.cmml">
         <mi id="S4.SS2.p3.3.m3.4.4.2.2.2" xref="S4.SS2.p3.3.m3.4.4.2.2.2.cmml">
          S
         </mi>
         <mn id="S4.SS2.p3.3.m3.4.4.2.2.3" xref="S4.SS2.p3.3.m3.4.4.2.2.3.cmml">
          2
         </mn>
        </msub>
        <mo id="S4.SS2.p3.3.m3.5.5.3.7" xref="S4.SS2.p3.3.m3.5.5.4.cmml">
         ;
        </mo>
        <mi id="S4.SS2.p3.3.m3.2.2" mathvariant="normal" xref="S4.SS2.p3.3.m3.2.2.cmml">
         …
        </mi>
        <mo id="S4.SS2.p3.3.m3.5.5.3.8" xref="S4.SS2.p3.3.m3.5.5.4.cmml">
         ;
        </mo>
        <msub id="S4.SS2.p3.3.m3.5.5.3.3" xref="S4.SS2.p3.3.m3.5.5.3.3.cmml">
         <mi id="S4.SS2.p3.3.m3.5.5.3.3.2" xref="S4.SS2.p3.3.m3.5.5.3.3.2.cmml">
          S
         </mi>
         <mi id="S4.SS2.p3.3.m3.5.5.3.3.3" xref="S4.SS2.p3.3.m3.5.5.3.3.3.cmml">
          N
         </mi>
        </msub>
        <mo id="S4.SS2.p3.3.m3.5.5.3.9" stretchy="false" xref="S4.SS2.p3.3.m3.5.5.4.cmml">
         ]
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.5b">
        <list id="S4.SS2.p3.3.m3.5.5.4.cmml" xref="S4.SS2.p3.3.m3.5.5.3">
         <ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">
          𝐼
         </ci>
         <apply id="S4.SS2.p3.3.m3.3.3.1.1.cmml" xref="S4.SS2.p3.3.m3.3.3.1.1">
          <csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.3.3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.3.3.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS2.p3.3.m3.3.3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.3.3.1.1.2">
           𝑆
          </ci>
          <cn id="S4.SS2.p3.3.m3.3.3.1.1.3.cmml" type="integer" xref="S4.SS2.p3.3.m3.3.3.1.1.3">
           1
          </cn>
         </apply>
         <apply id="S4.SS2.p3.3.m3.4.4.2.2.cmml" xref="S4.SS2.p3.3.m3.4.4.2.2">
          <csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.4.4.2.2.1.cmml" xref="S4.SS2.p3.3.m3.4.4.2.2">
           subscript
          </csymbol>
          <ci id="S4.SS2.p3.3.m3.4.4.2.2.2.cmml" xref="S4.SS2.p3.3.m3.4.4.2.2.2">
           𝑆
          </ci>
          <cn id="S4.SS2.p3.3.m3.4.4.2.2.3.cmml" type="integer" xref="S4.SS2.p3.3.m3.4.4.2.2.3">
           2
          </cn>
         </apply>
         <ci id="S4.SS2.p3.3.m3.2.2.cmml" xref="S4.SS2.p3.3.m3.2.2">
          …
         </ci>
         <apply id="S4.SS2.p3.3.m3.5.5.3.3.cmml" xref="S4.SS2.p3.3.m3.5.5.3.3">
          <csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.5.5.3.3.1.cmml" xref="S4.SS2.p3.3.m3.5.5.3.3">
           subscript
          </csymbol>
          <ci id="S4.SS2.p3.3.m3.5.5.3.3.2.cmml" xref="S4.SS2.p3.3.m3.5.5.3.3.2">
           𝑆
          </ci>
          <ci id="S4.SS2.p3.3.m3.5.5.3.3.3.cmml" xref="S4.SS2.p3.3.m3.5.5.3.3.3">
           𝑁
          </ci>
         </apply>
        </list>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.5c">
        [I;S_{1};S_{2};\dots;S_{N}]
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="I" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.1">
      <semantics id="S4.SS2.p3.4.m4.1a">
       <mi id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml">
        I
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b">
        <ci id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">
         𝐼
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">
        I
       </annotation>
      </semantics>
     </math>
     represents instruction embedding and
     <math alttext="S_{n}" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.1">
      <semantics id="S4.SS2.p3.5.m5.1a">
       <msub id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">
        <mi id="S4.SS2.p3.5.m5.1.1.2" xref="S4.SS2.p3.5.m5.1.1.2.cmml">
         S
        </mi>
        <mi id="S4.SS2.p3.5.m5.1.1.3" xref="S4.SS2.p3.5.m5.1.1.3.cmml">
         n
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b">
        <apply id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2">
          𝑆
         </ci>
         <ci id="S4.SS2.p3.5.m5.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3">
          𝑛
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">
        S_{n}
       </annotation>
      </semantics>
     </math>
     represents scene embeddings after grounding the instruction
     <math alttext="T_{I}" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m6.1">
      <semantics id="S4.SS2.p3.6.m6.1a">
       <msub id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml">
        <mi id="S4.SS2.p3.6.m6.1.1.2" xref="S4.SS2.p3.6.m6.1.1.2.cmml">
         T
        </mi>
        <mi id="S4.SS2.p3.6.m6.1.1.3" xref="S4.SS2.p3.6.m6.1.1.3.cmml">
         I
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.1b">
        <apply id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.1.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p3.6.m6.1.1.2.cmml" xref="S4.SS2.p3.6.m6.1.1.2">
          𝑇
         </ci>
         <ci id="S4.SS2.p3.6.m6.1.1.3.cmml" xref="S4.SS2.p3.6.m6.1.1.3">
          𝐼
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.1c">
        T_{I}
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p4">
    <p class="ltx_p" id="S4.SS2.p4.2">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p4.2.1">
      Scene Mapper.
     </span>
     To ensure seamless integration, we freeze the motion prediction model’s encoder and decoder. Consequently, we map instruction-grounded tokens
     <math alttext="[S_{i}]\in\mathbb{R}^{d_{LLM}}" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1">
      <semantics id="S4.SS2.p4.1.m1.1a">
       <mrow id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">
        <mrow id="S4.SS2.p4.1.m1.1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.2.cmml">
         <mo id="S4.SS2.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p4.1.m1.1.1.1.2.1.cmml">
          [
         </mo>
         <msub id="S4.SS2.p4.1.m1.1.1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.1.1.cmml">
          <mi id="S4.SS2.p4.1.m1.1.1.1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.1.1.1.2.cmml">
           S
          </mi>
          <mi id="S4.SS2.p4.1.m1.1.1.1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.1.1.1.3.cmml">
           i
          </mi>
         </msub>
         <mo id="S4.SS2.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p4.1.m1.1.1.1.2.1.cmml">
          ]
         </mo>
        </mrow>
        <mo id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">
         ∈
        </mo>
        <msup id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">
         <mi id="S4.SS2.p4.1.m1.1.1.3.2" xref="S4.SS2.p4.1.m1.1.1.3.2.cmml">
          ℝ
         </mi>
         <msub id="S4.SS2.p4.1.m1.1.1.3.3" xref="S4.SS2.p4.1.m1.1.1.3.3.cmml">
          <mi id="S4.SS2.p4.1.m1.1.1.3.3.2" xref="S4.SS2.p4.1.m1.1.1.3.3.2.cmml">
           d
          </mi>
          <mrow id="S4.SS2.p4.1.m1.1.1.3.3.3" xref="S4.SS2.p4.1.m1.1.1.3.3.3.cmml">
           <mi id="S4.SS2.p4.1.m1.1.1.3.3.3.2" xref="S4.SS2.p4.1.m1.1.1.3.3.3.2.cmml">
            L
           </mi>
           <mo id="S4.SS2.p4.1.m1.1.1.3.3.3.1" lspace="0em" rspace="0em" xref="S4.SS2.p4.1.m1.1.1.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS2.p4.1.m1.1.1.3.3.3.3" xref="S4.SS2.p4.1.m1.1.1.3.3.3.3.cmml">
            L
           </mi>
           <mo id="S4.SS2.p4.1.m1.1.1.3.3.3.1a" lspace="0em" rspace="0em" xref="S4.SS2.p4.1.m1.1.1.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS2.p4.1.m1.1.1.3.3.3.4" xref="S4.SS2.p4.1.m1.1.1.3.3.3.4.cmml">
            M
           </mi>
          </mrow>
         </msub>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b">
        <apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">
         <in id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">
         </in>
         <apply id="S4.SS2.p4.1.m1.1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.1.1">
          <csymbol cd="latexml" id="S4.SS2.p4.1.m1.1.1.1.2.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1.1.2">
           delimited-[]
          </csymbol>
          <apply id="S4.SS2.p4.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS2.p4.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.1.1.1.2">
            𝑆
           </ci>
           <ci id="S4.SS2.p4.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.1.1.1.3">
            𝑖
           </ci>
          </apply>
         </apply>
         <apply id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3">
          <csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.3.1.cmml" xref="S4.SS2.p4.1.m1.1.1.3">
           superscript
          </csymbol>
          <ci id="S4.SS2.p4.1.m1.1.1.3.2.cmml" xref="S4.SS2.p4.1.m1.1.1.3.2">
           ℝ
          </ci>
          <apply id="S4.SS2.p4.1.m1.1.1.3.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3">
           <csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3">
            subscript
           </csymbol>
           <ci id="S4.SS2.p4.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3.2">
            𝑑
           </ci>
           <apply id="S4.SS2.p4.1.m1.1.1.3.3.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3.3">
            <times id="S4.SS2.p4.1.m1.1.1.3.3.3.1.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3.3.1">
            </times>
            <ci id="S4.SS2.p4.1.m1.1.1.3.3.3.2.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3.3.2">
             𝐿
            </ci>
            <ci id="S4.SS2.p4.1.m1.1.1.3.3.3.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3.3.3">
             𝐿
            </ci>
            <ci id="S4.SS2.p4.1.m1.1.1.3.3.3.4.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3.3.4">
             𝑀
            </ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">
        [S_{i}]\in\mathbb{R}^{d_{LLM}}
       </annotation>
      </semantics>
     </math>
     back to
     <math alttext="\mathbb{R}^{d_{scene}}" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1">
      <semantics id="S4.SS2.p4.2.m2.1a">
       <msup id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">
        <mi id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">
         ℝ
        </mi>
        <msub id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">
         <mi id="S4.SS2.p4.2.m2.1.1.3.2" xref="S4.SS2.p4.2.m2.1.1.3.2.cmml">
          d
         </mi>
         <mrow id="S4.SS2.p4.2.m2.1.1.3.3" xref="S4.SS2.p4.2.m2.1.1.3.3.cmml">
          <mi id="S4.SS2.p4.2.m2.1.1.3.3.2" xref="S4.SS2.p4.2.m2.1.1.3.3.2.cmml">
           s
          </mi>
          <mo id="S4.SS2.p4.2.m2.1.1.3.3.1" lspace="0em" rspace="0em" xref="S4.SS2.p4.2.m2.1.1.3.3.1.cmml">
           ​
          </mo>
          <mi id="S4.SS2.p4.2.m2.1.1.3.3.3" xref="S4.SS2.p4.2.m2.1.1.3.3.3.cmml">
           c
          </mi>
          <mo id="S4.SS2.p4.2.m2.1.1.3.3.1a" lspace="0em" rspace="0em" xref="S4.SS2.p4.2.m2.1.1.3.3.1.cmml">
           ​
          </mo>
          <mi id="S4.SS2.p4.2.m2.1.1.3.3.4" xref="S4.SS2.p4.2.m2.1.1.3.3.4.cmml">
           e
          </mi>
          <mo id="S4.SS2.p4.2.m2.1.1.3.3.1b" lspace="0em" rspace="0em" xref="S4.SS2.p4.2.m2.1.1.3.3.1.cmml">
           ​
          </mo>
          <mi id="S4.SS2.p4.2.m2.1.1.3.3.5" xref="S4.SS2.p4.2.m2.1.1.3.3.5.cmml">
           n
          </mi>
          <mo id="S4.SS2.p4.2.m2.1.1.3.3.1c" lspace="0em" rspace="0em" xref="S4.SS2.p4.2.m2.1.1.3.3.1.cmml">
           ​
          </mo>
          <mi id="S4.SS2.p4.2.m2.1.1.3.3.6" xref="S4.SS2.p4.2.m2.1.1.3.3.6.cmml">
           e
          </mi>
         </mrow>
        </msub>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b">
        <apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">
          ℝ
         </ci>
         <apply id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3">
          <csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.3.1.cmml" xref="S4.SS2.p4.2.m2.1.1.3">
           subscript
          </csymbol>
          <ci id="S4.SS2.p4.2.m2.1.1.3.2.cmml" xref="S4.SS2.p4.2.m2.1.1.3.2">
           𝑑
          </ci>
          <apply id="S4.SS2.p4.2.m2.1.1.3.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3">
           <times id="S4.SS2.p4.2.m2.1.1.3.3.1.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3.1">
           </times>
           <ci id="S4.SS2.p4.2.m2.1.1.3.3.2.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3.2">
            𝑠
           </ci>
           <ci id="S4.SS2.p4.2.m2.1.1.3.3.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3.3">
            𝑐
           </ci>
           <ci id="S4.SS2.p4.2.m2.1.1.3.3.4.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3.4">
            𝑒
           </ci>
           <ci id="S4.SS2.p4.2.m2.1.1.3.3.5.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3.5">
            𝑛
           </ci>
           <ci id="S4.SS2.p4.2.m2.1.1.3.3.6.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3.6">
            𝑒
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">
        \mathbb{R}^{d_{scene}}
       </annotation>
      </semantics>
     </math>
     , serving as keys and values in the Multimodal Trajectory Prediction Decoder, defined in Eq.
     <a class="ltx_ref" href="#S4.E1" title="In 4.2 Integration of iMotion-LLM ‣ 4 iMotion-LLM ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     .
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S4.E1">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="\small K_{i}\&amp;V_{i}=MLP([S_{i}]);i\in{1,...,N}." class="ltx_Math" display="block" id="S4.E1.m1.4">
         <semantics id="S4.E1.m1.4a">
          <mrow id="S4.E1.m1.4.4.1">
           <mrow id="S4.E1.m1.4.4.1.1.2" xref="S4.E1.m1.4.4.1.1.3.cmml">
            <mrow id="S4.E1.m1.4.4.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.cmml">
             <mrow id="S4.E1.m1.4.4.1.1.1.1.3" xref="S4.E1.m1.4.4.1.1.1.1.3.cmml">
              <msub id="S4.E1.m1.4.4.1.1.1.1.3.2" xref="S4.E1.m1.4.4.1.1.1.1.3.2.cmml">
               <mi id="S4.E1.m1.4.4.1.1.1.1.3.2.2" mathsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.3.2.2.cmml">
                K
               </mi>
               <mi id="S4.E1.m1.4.4.1.1.1.1.3.2.3" mathsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.3.2.3.cmml">
                i
               </mi>
              </msub>
              <mo id="S4.E1.m1.4.4.1.1.1.1.3.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S4.E1.m1.4.4.1.1.1.1.3.1.cmml">
               &amp;
              </mo>
              <msub id="S4.E1.m1.4.4.1.1.1.1.3.3" xref="S4.E1.m1.4.4.1.1.1.1.3.3.cmml">
               <mi id="S4.E1.m1.4.4.1.1.1.1.3.3.2" mathsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.3.3.2.cmml">
                V
               </mi>
               <mi id="S4.E1.m1.4.4.1.1.1.1.3.3.3" mathsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.3.3.3.cmml">
                i
               </mi>
              </msub>
             </mrow>
             <mo id="S4.E1.m1.4.4.1.1.1.1.2" mathsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.2.cmml">
              =
             </mo>
             <mrow id="S4.E1.m1.4.4.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.1.cmml">
              <mi id="S4.E1.m1.4.4.1.1.1.1.1.3" mathsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.1.3.cmml">
               M
              </mi>
              <mo id="S4.E1.m1.4.4.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E1.m1.4.4.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mi id="S4.E1.m1.4.4.1.1.1.1.1.4" mathsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.1.4.cmml">
               L
              </mi>
              <mo id="S4.E1.m1.4.4.1.1.1.1.1.2a" lspace="0em" rspace="0em" xref="S4.E1.m1.4.4.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mi id="S4.E1.m1.4.4.1.1.1.1.1.5" mathsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.1.5.cmml">
               P
              </mi>
              <mo id="S4.E1.m1.4.4.1.1.1.1.1.2b" lspace="0em" rspace="0em" xref="S4.E1.m1.4.4.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="S4.E1.m1.4.4.1.1.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.1.cmml">
               <mo id="S4.E1.m1.4.4.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">
                <mo id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">
                 [
                </mo>
                <msub id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">
                 <mi id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">
                  S
                 </mi>
                 <mi id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">
                  i
                 </mi>
                </msub>
                <mo id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">
                 ]
                </mo>
               </mrow>
               <mo id="S4.E1.m1.4.4.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S4.E1.m1.4.4.1.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
            <mo id="S4.E1.m1.4.4.1.1.2.3" mathsize="90%" xref="S4.E1.m1.4.4.1.1.3a.cmml">
             ;
            </mo>
            <mrow id="S4.E1.m1.4.4.1.1.2.2" xref="S4.E1.m1.4.4.1.1.2.2.cmml">
             <mi id="S4.E1.m1.4.4.1.1.2.2.2" mathsize="90%" xref="S4.E1.m1.4.4.1.1.2.2.2.cmml">
              i
             </mi>
             <mo id="S4.E1.m1.4.4.1.1.2.2.1" mathsize="90%" xref="S4.E1.m1.4.4.1.1.2.2.1.cmml">
              ∈
             </mo>
             <mrow id="S4.E1.m1.4.4.1.1.2.2.3.2" xref="S4.E1.m1.4.4.1.1.2.2.3.1.cmml">
              <mn id="S4.E1.m1.1.1" mathsize="90%" xref="S4.E1.m1.1.1.cmml">
               1
              </mn>
              <mo id="S4.E1.m1.4.4.1.1.2.2.3.2.1" mathsize="90%" xref="S4.E1.m1.4.4.1.1.2.2.3.1.cmml">
               ,
              </mo>
              <mi id="S4.E1.m1.2.2" mathsize="90%" mathvariant="normal" xref="S4.E1.m1.2.2.cmml">
               …
              </mi>
              <mo id="S4.E1.m1.4.4.1.1.2.2.3.2.2" mathsize="90%" xref="S4.E1.m1.4.4.1.1.2.2.3.1.cmml">
               ,
              </mo>
              <mi id="S4.E1.m1.3.3" mathsize="90%" xref="S4.E1.m1.3.3.cmml">
               N
              </mi>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E1.m1.4.4.1.2" lspace="0em" mathsize="90%">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E1.m1.4b">
           <apply id="S4.E1.m1.4.4.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.2">
            <csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.3a.cmml" xref="S4.E1.m1.4.4.1.1.2.3">
             formulae-sequence
            </csymbol>
            <apply id="S4.E1.m1.4.4.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1">
             <eq id="S4.E1.m1.4.4.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.2">
             </eq>
             <apply id="S4.E1.m1.4.4.1.1.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3">
              <and id="S4.E1.m1.4.4.1.1.1.1.3.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.1">
              </and>
              <apply id="S4.E1.m1.4.4.1.1.1.1.3.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.2">
               <csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.2">
                subscript
               </csymbol>
               <ci id="S4.E1.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.2.2">
                𝐾
               </ci>
               <ci id="S4.E1.m1.4.4.1.1.1.1.3.2.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.2.3">
                𝑖
               </ci>
              </apply>
              <apply id="S4.E1.m1.4.4.1.1.1.1.3.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.3">
               <csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.1.1.3.3.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.3">
                subscript
               </csymbol>
               <ci id="S4.E1.m1.4.4.1.1.1.1.3.3.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.3.2">
                𝑉
               </ci>
               <ci id="S4.E1.m1.4.4.1.1.1.1.3.3.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.3.3">
                𝑖
               </ci>
              </apply>
             </apply>
             <apply id="S4.E1.m1.4.4.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1">
              <times id="S4.E1.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.2">
              </times>
              <ci id="S4.E1.m1.4.4.1.1.1.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.3">
               𝑀
              </ci>
              <ci id="S4.E1.m1.4.4.1.1.1.1.1.4.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.4">
               𝐿
              </ci>
              <ci id="S4.E1.m1.4.4.1.1.1.1.1.5.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.5">
               𝑃
              </ci>
              <apply id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1">
               <csymbol cd="latexml" id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.2">
                delimited-[]
               </csymbol>
               <apply id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1">
                 subscript
                </csymbol>
                <ci id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">
                 𝑆
                </ci>
                <ci id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">
                 𝑖
                </ci>
               </apply>
              </apply>
             </apply>
            </apply>
            <apply id="S4.E1.m1.4.4.1.1.2.2.cmml" xref="S4.E1.m1.4.4.1.1.2.2">
             <in id="S4.E1.m1.4.4.1.1.2.2.1.cmml" xref="S4.E1.m1.4.4.1.1.2.2.1">
             </in>
             <ci id="S4.E1.m1.4.4.1.1.2.2.2.cmml" xref="S4.E1.m1.4.4.1.1.2.2.2">
              𝑖
             </ci>
             <list id="S4.E1.m1.4.4.1.1.2.2.3.1.cmml" xref="S4.E1.m1.4.4.1.1.2.2.3.2">
              <cn id="S4.E1.m1.1.1.cmml" type="integer" xref="S4.E1.m1.1.1">
               1
              </cn>
              <ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">
               …
              </ci>
              <ci id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3">
               𝑁
              </ci>
             </list>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E1.m1.4c">
           \small K_{i}\&amp;V_{i}=MLP([S_{i}]);i\in{1,...,N}.
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (1)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p5">
    <p class="ltx_p" id="S4.SS2.p5.3">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p5.3.1">
      Instruct Mapper.
     </span>
     Following the Scene Mapper, we project instruction token
     <math alttext="I" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1">
      <semantics id="S4.SS2.p5.1.m1.1a">
       <mi id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">
        I
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b">
        <ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">
         𝐼
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">
        I
       </annotation>
      </semantics>
     </math>
     back to the motion prediction model’s embedding space (
     <math alttext="d_{scene}" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1">
      <semantics id="S4.SS2.p5.2.m2.1a">
       <msub id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">
        <mi id="S4.SS2.p5.2.m2.1.1.2" xref="S4.SS2.p5.2.m2.1.1.2.cmml">
         d
        </mi>
        <mrow id="S4.SS2.p5.2.m2.1.1.3" xref="S4.SS2.p5.2.m2.1.1.3.cmml">
         <mi id="S4.SS2.p5.2.m2.1.1.3.2" xref="S4.SS2.p5.2.m2.1.1.3.2.cmml">
          s
         </mi>
         <mo id="S4.SS2.p5.2.m2.1.1.3.1" lspace="0em" rspace="0em" xref="S4.SS2.p5.2.m2.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.p5.2.m2.1.1.3.3" xref="S4.SS2.p5.2.m2.1.1.3.3.cmml">
          c
         </mi>
         <mo id="S4.SS2.p5.2.m2.1.1.3.1a" lspace="0em" rspace="0em" xref="S4.SS2.p5.2.m2.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.p5.2.m2.1.1.3.4" xref="S4.SS2.p5.2.m2.1.1.3.4.cmml">
          e
         </mi>
         <mo id="S4.SS2.p5.2.m2.1.1.3.1b" lspace="0em" rspace="0em" xref="S4.SS2.p5.2.m2.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.p5.2.m2.1.1.3.5" xref="S4.SS2.p5.2.m2.1.1.3.5.cmml">
          n
         </mi>
         <mo id="S4.SS2.p5.2.m2.1.1.3.1c" lspace="0em" rspace="0em" xref="S4.SS2.p5.2.m2.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.p5.2.m2.1.1.3.6" xref="S4.SS2.p5.2.m2.1.1.3.6.cmml">
          e
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b">
        <apply id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p5.2.m2.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1.2">
          𝑑
         </ci>
         <apply id="S4.SS2.p5.2.m2.1.1.3.cmml" xref="S4.SS2.p5.2.m2.1.1.3">
          <times id="S4.SS2.p5.2.m2.1.1.3.1.cmml" xref="S4.SS2.p5.2.m2.1.1.3.1">
          </times>
          <ci id="S4.SS2.p5.2.m2.1.1.3.2.cmml" xref="S4.SS2.p5.2.m2.1.1.3.2">
           𝑠
          </ci>
          <ci id="S4.SS2.p5.2.m2.1.1.3.3.cmml" xref="S4.SS2.p5.2.m2.1.1.3.3">
           𝑐
          </ci>
          <ci id="S4.SS2.p5.2.m2.1.1.3.4.cmml" xref="S4.SS2.p5.2.m2.1.1.3.4">
           𝑒
          </ci>
          <ci id="S4.SS2.p5.2.m2.1.1.3.5.cmml" xref="S4.SS2.p5.2.m2.1.1.3.5">
           𝑛
          </ci>
          <ci id="S4.SS2.p5.2.m2.1.1.3.6.cmml" xref="S4.SS2.p5.2.m2.1.1.3.6">
           𝑒
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">
        d_{scene}
       </annotation>
      </semantics>
     </math>
     ), which is fused with
     <math alttext="q_{motion}" class="ltx_Math" display="inline" id="S4.SS2.p5.3.m3.1">
      <semantics id="S4.SS2.p5.3.m3.1a">
       <msub id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml">
        <mi id="S4.SS2.p5.3.m3.1.1.2" xref="S4.SS2.p5.3.m3.1.1.2.cmml">
         q
        </mi>
        <mrow id="S4.SS2.p5.3.m3.1.1.3" xref="S4.SS2.p5.3.m3.1.1.3.cmml">
         <mi id="S4.SS2.p5.3.m3.1.1.3.2" xref="S4.SS2.p5.3.m3.1.1.3.2.cmml">
          m
         </mi>
         <mo id="S4.SS2.p5.3.m3.1.1.3.1" lspace="0em" rspace="0em" xref="S4.SS2.p5.3.m3.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.p5.3.m3.1.1.3.3" xref="S4.SS2.p5.3.m3.1.1.3.3.cmml">
          o
         </mi>
         <mo id="S4.SS2.p5.3.m3.1.1.3.1a" lspace="0em" rspace="0em" xref="S4.SS2.p5.3.m3.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.p5.3.m3.1.1.3.4" xref="S4.SS2.p5.3.m3.1.1.3.4.cmml">
          t
         </mi>
         <mo id="S4.SS2.p5.3.m3.1.1.3.1b" lspace="0em" rspace="0em" xref="S4.SS2.p5.3.m3.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.p5.3.m3.1.1.3.5" xref="S4.SS2.p5.3.m3.1.1.3.5.cmml">
          i
         </mi>
         <mo id="S4.SS2.p5.3.m3.1.1.3.1c" lspace="0em" rspace="0em" xref="S4.SS2.p5.3.m3.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.p5.3.m3.1.1.3.6" xref="S4.SS2.p5.3.m3.1.1.3.6.cmml">
          o
         </mi>
         <mo id="S4.SS2.p5.3.m3.1.1.3.1d" lspace="0em" rspace="0em" xref="S4.SS2.p5.3.m3.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.p5.3.m3.1.1.3.7" xref="S4.SS2.p5.3.m3.1.1.3.7.cmml">
          n
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b">
        <apply id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p5.3.m3.1.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p5.3.m3.1.1.2.cmml" xref="S4.SS2.p5.3.m3.1.1.2">
          𝑞
         </ci>
         <apply id="S4.SS2.p5.3.m3.1.1.3.cmml" xref="S4.SS2.p5.3.m3.1.1.3">
          <times id="S4.SS2.p5.3.m3.1.1.3.1.cmml" xref="S4.SS2.p5.3.m3.1.1.3.1">
          </times>
          <ci id="S4.SS2.p5.3.m3.1.1.3.2.cmml" xref="S4.SS2.p5.3.m3.1.1.3.2">
           𝑚
          </ci>
          <ci id="S4.SS2.p5.3.m3.1.1.3.3.cmml" xref="S4.SS2.p5.3.m3.1.1.3.3">
           𝑜
          </ci>
          <ci id="S4.SS2.p5.3.m3.1.1.3.4.cmml" xref="S4.SS2.p5.3.m3.1.1.3.4">
           𝑡
          </ci>
          <ci id="S4.SS2.p5.3.m3.1.1.3.5.cmml" xref="S4.SS2.p5.3.m3.1.1.3.5">
           𝑖
          </ci>
          <ci id="S4.SS2.p5.3.m3.1.1.3.6.cmml" xref="S4.SS2.p5.3.m3.1.1.3.6">
           𝑜
          </ci>
          <ci id="S4.SS2.p5.3.m3.1.1.3.7.cmml" xref="S4.SS2.p5.3.m3.1.1.3.7">
           𝑛
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">
        q_{motion}
       </annotation>
      </semantics>
     </math>
     through a simple addition operation, as shown in Eq.
     <a class="ltx_ref" href="#S4.E2" title="In 4.2 Integration of iMotion-LLM ‣ 4 iMotion-LLM ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     .
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S4.E2">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="\small Q=q_{motion}+MLP([I])." class="ltx_Math" display="block" id="S4.E2.m1.2">
         <semantics id="S4.E2.m1.2a">
          <mrow id="S4.E2.m1.2.2.1" xref="S4.E2.m1.2.2.1.1.cmml">
           <mrow id="S4.E2.m1.2.2.1.1" xref="S4.E2.m1.2.2.1.1.cmml">
            <mi id="S4.E2.m1.2.2.1.1.3" mathsize="90%" xref="S4.E2.m1.2.2.1.1.3.cmml">
             Q
            </mi>
            <mo id="S4.E2.m1.2.2.1.1.2" mathsize="90%" xref="S4.E2.m1.2.2.1.1.2.cmml">
             =
            </mo>
            <mrow id="S4.E2.m1.2.2.1.1.1" xref="S4.E2.m1.2.2.1.1.1.cmml">
             <msub id="S4.E2.m1.2.2.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.3.cmml">
              <mi id="S4.E2.m1.2.2.1.1.1.3.2" mathsize="90%" xref="S4.E2.m1.2.2.1.1.1.3.2.cmml">
               q
              </mi>
              <mrow id="S4.E2.m1.2.2.1.1.1.3.3" xref="S4.E2.m1.2.2.1.1.1.3.3.cmml">
               <mi id="S4.E2.m1.2.2.1.1.1.3.3.2" mathsize="90%" xref="S4.E2.m1.2.2.1.1.1.3.3.2.cmml">
                m
               </mi>
               <mo id="S4.E2.m1.2.2.1.1.1.3.3.1" lspace="0em" rspace="0em" xref="S4.E2.m1.2.2.1.1.1.3.3.1.cmml">
                ​
               </mo>
               <mi id="S4.E2.m1.2.2.1.1.1.3.3.3" mathsize="90%" xref="S4.E2.m1.2.2.1.1.1.3.3.3.cmml">
                o
               </mi>
               <mo id="S4.E2.m1.2.2.1.1.1.3.3.1a" lspace="0em" rspace="0em" xref="S4.E2.m1.2.2.1.1.1.3.3.1.cmml">
                ​
               </mo>
               <mi id="S4.E2.m1.2.2.1.1.1.3.3.4" mathsize="90%" xref="S4.E2.m1.2.2.1.1.1.3.3.4.cmml">
                t
               </mi>
               <mo id="S4.E2.m1.2.2.1.1.1.3.3.1b" lspace="0em" rspace="0em" xref="S4.E2.m1.2.2.1.1.1.3.3.1.cmml">
                ​
               </mo>
               <mi id="S4.E2.m1.2.2.1.1.1.3.3.5" mathsize="90%" xref="S4.E2.m1.2.2.1.1.1.3.3.5.cmml">
                i
               </mi>
               <mo id="S4.E2.m1.2.2.1.1.1.3.3.1c" lspace="0em" rspace="0em" xref="S4.E2.m1.2.2.1.1.1.3.3.1.cmml">
                ​
               </mo>
               <mi id="S4.E2.m1.2.2.1.1.1.3.3.6" mathsize="90%" xref="S4.E2.m1.2.2.1.1.1.3.3.6.cmml">
                o
               </mi>
               <mo id="S4.E2.m1.2.2.1.1.1.3.3.1d" lspace="0em" rspace="0em" xref="S4.E2.m1.2.2.1.1.1.3.3.1.cmml">
                ​
               </mo>
               <mi id="S4.E2.m1.2.2.1.1.1.3.3.7" mathsize="90%" xref="S4.E2.m1.2.2.1.1.1.3.3.7.cmml">
                n
               </mi>
              </mrow>
             </msub>
             <mo id="S4.E2.m1.2.2.1.1.1.2" mathsize="90%" xref="S4.E2.m1.2.2.1.1.1.2.cmml">
              +
             </mo>
             <mrow id="S4.E2.m1.2.2.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.cmml">
              <mi id="S4.E2.m1.2.2.1.1.1.1.3" mathsize="90%" xref="S4.E2.m1.2.2.1.1.1.1.3.cmml">
               M
              </mi>
              <mo id="S4.E2.m1.2.2.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E2.m1.2.2.1.1.1.1.2.cmml">
               ​
              </mo>
              <mi id="S4.E2.m1.2.2.1.1.1.1.4" mathsize="90%" xref="S4.E2.m1.2.2.1.1.1.1.4.cmml">
               L
              </mi>
              <mo id="S4.E2.m1.2.2.1.1.1.1.2a" lspace="0em" rspace="0em" xref="S4.E2.m1.2.2.1.1.1.1.2.cmml">
               ​
              </mo>
              <mi id="S4.E2.m1.2.2.1.1.1.1.5" mathsize="90%" xref="S4.E2.m1.2.2.1.1.1.1.5.cmml">
               P
              </mi>
              <mo id="S4.E2.m1.2.2.1.1.1.1.2b" lspace="0em" rspace="0em" xref="S4.E2.m1.2.2.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="S4.E2.m1.2.2.1.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.cmml">
               <mo id="S4.E2.m1.2.2.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S4.E2.m1.2.2.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml">
                <mo id="S4.E2.m1.2.2.1.1.1.1.1.1.1.2.1" maxsize="90%" minsize="90%" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">
                 [
                </mo>
                <mi id="S4.E2.m1.1.1" mathsize="90%" xref="S4.E2.m1.1.1.cmml">
                 I
                </mi>
                <mo id="S4.E2.m1.2.2.1.1.1.1.1.1.1.2.2" maxsize="90%" minsize="90%" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">
                 ]
                </mo>
               </mrow>
               <mo id="S4.E2.m1.2.2.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S4.E2.m1.2.2.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E2.m1.2.2.1.2" lspace="0em" mathsize="90%" xref="S4.E2.m1.2.2.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E2.m1.2b">
           <apply id="S4.E2.m1.2.2.1.1.cmml" xref="S4.E2.m1.2.2.1">
            <eq id="S4.E2.m1.2.2.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.2">
            </eq>
            <ci id="S4.E2.m1.2.2.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.3">
             𝑄
            </ci>
            <apply id="S4.E2.m1.2.2.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1">
             <plus id="S4.E2.m1.2.2.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.2">
             </plus>
             <apply id="S4.E2.m1.2.2.1.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.3">
              <csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.3.1.cmml" xref="S4.E2.m1.2.2.1.1.1.3">
               subscript
              </csymbol>
              <ci id="S4.E2.m1.2.2.1.1.1.3.2.cmml" xref="S4.E2.m1.2.2.1.1.1.3.2">
               𝑞
              </ci>
              <apply id="S4.E2.m1.2.2.1.1.1.3.3.cmml" xref="S4.E2.m1.2.2.1.1.1.3.3">
               <times id="S4.E2.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.E2.m1.2.2.1.1.1.3.3.1">
               </times>
               <ci id="S4.E2.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.E2.m1.2.2.1.1.1.3.3.2">
                𝑚
               </ci>
               <ci id="S4.E2.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.E2.m1.2.2.1.1.1.3.3.3">
                𝑜
               </ci>
               <ci id="S4.E2.m1.2.2.1.1.1.3.3.4.cmml" xref="S4.E2.m1.2.2.1.1.1.3.3.4">
                𝑡
               </ci>
               <ci id="S4.E2.m1.2.2.1.1.1.3.3.5.cmml" xref="S4.E2.m1.2.2.1.1.1.3.3.5">
                𝑖
               </ci>
               <ci id="S4.E2.m1.2.2.1.1.1.3.3.6.cmml" xref="S4.E2.m1.2.2.1.1.1.3.3.6">
                𝑜
               </ci>
               <ci id="S4.E2.m1.2.2.1.1.1.3.3.7.cmml" xref="S4.E2.m1.2.2.1.1.1.3.3.7">
                𝑛
               </ci>
              </apply>
             </apply>
             <apply id="S4.E2.m1.2.2.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1">
              <times id="S4.E2.m1.2.2.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.2">
              </times>
              <ci id="S4.E2.m1.2.2.1.1.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.3">
               𝑀
              </ci>
              <ci id="S4.E2.m1.2.2.1.1.1.1.4.cmml" xref="S4.E2.m1.2.2.1.1.1.1.4">
               𝐿
              </ci>
              <ci id="S4.E2.m1.2.2.1.1.1.1.5.cmml" xref="S4.E2.m1.2.2.1.1.1.1.5">
               𝑃
              </ci>
              <apply id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.2">
               <csymbol cd="latexml" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.2.1">
                delimited-[]
               </csymbol>
               <ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">
                𝐼
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E2.m1.2c">
           \small Q=q_{motion}+MLP([I]).
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (2)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p6">
    <p class="ltx_p" id="S4.SS2.p6.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p6.1.1">
      Output Caption.
     </span>
     Along with generating scene and instruction tokens, the LLM outputs a text that describes how the instruction is executed, key scene information, and a textual decision of ("&lt;Accept&gt;" or "&lt;Reject&gt;") to indicate whether an instruction is feasible or not.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Instruction Following and Diversity Metrics
  </h2>
  <div class="ltx_para" id="S5.p1">
   <p class="ltx_p" id="S5.p1.2">
    Our primary objective is to render current motion prediction models interactive and controllable. Hence, conventional metrics like Average Displacement Error (ADE) and Final Displacement Error (FDE) alone may not suffice to adequately evaluate the instruction-following capabilities of the proposed model. To address this, we introduce two metrics: Instruction Following Recall (
    <math alttext="IFR" class="ltx_Math" display="inline" id="S5.p1.1.m1.1">
     <semantics id="S5.p1.1.m1.1a">
      <mrow id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">
       <mi id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">
        I
       </mi>
       <mo id="S5.p1.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S5.p1.1.m1.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">
        F
       </mi>
       <mo id="S5.p1.1.m1.1.1.1a" lspace="0em" rspace="0em" xref="S5.p1.1.m1.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p1.1.m1.1.1.4" xref="S5.p1.1.m1.1.1.4.cmml">
        R
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b">
       <apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1">
        <times id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1.1">
        </times>
        <ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">
         𝐼
        </ci>
        <ci id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3">
         𝐹
        </ci>
        <ci id="S5.p1.1.m1.1.1.4.cmml" xref="S5.p1.1.m1.1.1.4">
         𝑅
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">
       IFR
      </annotation>
     </semantics>
    </math>
    ) and Direction Variety Score (
    <math alttext="DVS" class="ltx_Math" display="inline" id="S5.p1.2.m2.1">
     <semantics id="S5.p1.2.m2.1a">
      <mrow id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml">
       <mi id="S5.p1.2.m2.1.1.2" xref="S5.p1.2.m2.1.1.2.cmml">
        D
       </mi>
       <mo id="S5.p1.2.m2.1.1.1" lspace="0em" rspace="0em" xref="S5.p1.2.m2.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p1.2.m2.1.1.3" xref="S5.p1.2.m2.1.1.3.cmml">
        V
       </mi>
       <mo id="S5.p1.2.m2.1.1.1a" lspace="0em" rspace="0em" xref="S5.p1.2.m2.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p1.2.m2.1.1.4" xref="S5.p1.2.m2.1.1.4.cmml">
        S
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b">
       <apply id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1">
        <times id="S5.p1.2.m2.1.1.1.cmml" xref="S5.p1.2.m2.1.1.1">
        </times>
        <ci id="S5.p1.2.m2.1.1.2.cmml" xref="S5.p1.2.m2.1.1.2">
         𝐷
        </ci>
        <ci id="S5.p1.2.m2.1.1.3.cmml" xref="S5.p1.2.m2.1.1.3">
         𝑉
        </ci>
        <ci id="S5.p1.2.m2.1.1.4.cmml" xref="S5.p1.2.m2.1.1.4">
         𝑆
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">
       DVS
      </annotation>
     </semantics>
    </math>
    ).
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S5.p2">
   <p class="ltx_p" id="S5.p2.4">
    <span class="ltx_text ltx_font_bold" id="S5.p2.4.1">
     Instruction Following Recall (IFR).
    </span>
    To gauge the model’s ability to adhere to instructions, we compare given instructions direction
    <math alttext="D_{intruct}" class="ltx_Math" display="inline" id="S5.p2.1.m1.1">
     <semantics id="S5.p2.1.m1.1a">
      <msub id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml">
       <mi id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2.cmml">
        D
       </mi>
       <mrow id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3.cmml">
        <mi id="S5.p2.1.m1.1.1.3.2" xref="S5.p2.1.m1.1.1.3.2.cmml">
         i
        </mi>
        <mo id="S5.p2.1.m1.1.1.3.1" lspace="0em" rspace="0em" xref="S5.p2.1.m1.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p2.1.m1.1.1.3.3" xref="S5.p2.1.m1.1.1.3.3.cmml">
         n
        </mi>
        <mo id="S5.p2.1.m1.1.1.3.1a" lspace="0em" rspace="0em" xref="S5.p2.1.m1.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p2.1.m1.1.1.3.4" xref="S5.p2.1.m1.1.1.3.4.cmml">
         t
        </mi>
        <mo id="S5.p2.1.m1.1.1.3.1b" lspace="0em" rspace="0em" xref="S5.p2.1.m1.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p2.1.m1.1.1.3.5" xref="S5.p2.1.m1.1.1.3.5.cmml">
         r
        </mi>
        <mo id="S5.p2.1.m1.1.1.3.1c" lspace="0em" rspace="0em" xref="S5.p2.1.m1.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p2.1.m1.1.1.3.6" xref="S5.p2.1.m1.1.1.3.6.cmml">
         u
        </mi>
        <mo id="S5.p2.1.m1.1.1.3.1d" lspace="0em" rspace="0em" xref="S5.p2.1.m1.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p2.1.m1.1.1.3.7" xref="S5.p2.1.m1.1.1.3.7.cmml">
         c
        </mi>
        <mo id="S5.p2.1.m1.1.1.3.1e" lspace="0em" rspace="0em" xref="S5.p2.1.m1.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p2.1.m1.1.1.3.8" xref="S5.p2.1.m1.1.1.3.8.cmml">
         t
        </mi>
       </mrow>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b">
       <apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1">
        <csymbol cd="ambiguous" id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1">
         subscript
        </csymbol>
        <ci id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">
         𝐷
        </ci>
        <apply id="S5.p2.1.m1.1.1.3.cmml" xref="S5.p2.1.m1.1.1.3">
         <times id="S5.p2.1.m1.1.1.3.1.cmml" xref="S5.p2.1.m1.1.1.3.1">
         </times>
         <ci id="S5.p2.1.m1.1.1.3.2.cmml" xref="S5.p2.1.m1.1.1.3.2">
          𝑖
         </ci>
         <ci id="S5.p2.1.m1.1.1.3.3.cmml" xref="S5.p2.1.m1.1.1.3.3">
          𝑛
         </ci>
         <ci id="S5.p2.1.m1.1.1.3.4.cmml" xref="S5.p2.1.m1.1.1.3.4">
          𝑡
         </ci>
         <ci id="S5.p2.1.m1.1.1.3.5.cmml" xref="S5.p2.1.m1.1.1.3.5">
          𝑟
         </ci>
         <ci id="S5.p2.1.m1.1.1.3.6.cmml" xref="S5.p2.1.m1.1.1.3.6">
          𝑢
         </ci>
         <ci id="S5.p2.1.m1.1.1.3.7.cmml" xref="S5.p2.1.m1.1.1.3.7">
          𝑐
         </ci>
         <ci id="S5.p2.1.m1.1.1.3.8.cmml" xref="S5.p2.1.m1.1.1.3.8">
          𝑡
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">
       D_{intruct}
      </annotation>
     </semantics>
    </math>
    , with the directions of the generated multimodal trajectories. For each of the
    <math alttext="M" class="ltx_Math" display="inline" id="S5.p2.2.m2.1">
     <semantics id="S5.p2.2.m2.1a">
      <mi id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml">
       M
      </mi>
      <annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b">
       <ci id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1">
        𝑀
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">
       M
      </annotation>
     </semantics>
    </math>
    modalities, we calculate its direction
    <math alttext="D_{pred_{j}}" class="ltx_Math" display="inline" id="S5.p2.3.m3.1">
     <semantics id="S5.p2.3.m3.1a">
      <msub id="S5.p2.3.m3.1.1" xref="S5.p2.3.m3.1.1.cmml">
       <mi id="S5.p2.3.m3.1.1.2" xref="S5.p2.3.m3.1.1.2.cmml">
        D
       </mi>
       <mrow id="S5.p2.3.m3.1.1.3" xref="S5.p2.3.m3.1.1.3.cmml">
        <mi id="S5.p2.3.m3.1.1.3.2" xref="S5.p2.3.m3.1.1.3.2.cmml">
         p
        </mi>
        <mo id="S5.p2.3.m3.1.1.3.1" lspace="0em" rspace="0em" xref="S5.p2.3.m3.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p2.3.m3.1.1.3.3" xref="S5.p2.3.m3.1.1.3.3.cmml">
         r
        </mi>
        <mo id="S5.p2.3.m3.1.1.3.1a" lspace="0em" rspace="0em" xref="S5.p2.3.m3.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p2.3.m3.1.1.3.4" xref="S5.p2.3.m3.1.1.3.4.cmml">
         e
        </mi>
        <mo id="S5.p2.3.m3.1.1.3.1b" lspace="0em" rspace="0em" xref="S5.p2.3.m3.1.1.3.1.cmml">
         ​
        </mo>
        <msub id="S5.p2.3.m3.1.1.3.5" xref="S5.p2.3.m3.1.1.3.5.cmml">
         <mi id="S5.p2.3.m3.1.1.3.5.2" xref="S5.p2.3.m3.1.1.3.5.2.cmml">
          d
         </mi>
         <mi id="S5.p2.3.m3.1.1.3.5.3" xref="S5.p2.3.m3.1.1.3.5.3.cmml">
          j
         </mi>
        </msub>
       </mrow>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S5.p2.3.m3.1b">
       <apply id="S5.p2.3.m3.1.1.cmml" xref="S5.p2.3.m3.1.1">
        <csymbol cd="ambiguous" id="S5.p2.3.m3.1.1.1.cmml" xref="S5.p2.3.m3.1.1">
         subscript
        </csymbol>
        <ci id="S5.p2.3.m3.1.1.2.cmml" xref="S5.p2.3.m3.1.1.2">
         𝐷
        </ci>
        <apply id="S5.p2.3.m3.1.1.3.cmml" xref="S5.p2.3.m3.1.1.3">
         <times id="S5.p2.3.m3.1.1.3.1.cmml" xref="S5.p2.3.m3.1.1.3.1">
         </times>
         <ci id="S5.p2.3.m3.1.1.3.2.cmml" xref="S5.p2.3.m3.1.1.3.2">
          𝑝
         </ci>
         <ci id="S5.p2.3.m3.1.1.3.3.cmml" xref="S5.p2.3.m3.1.1.3.3">
          𝑟
         </ci>
         <ci id="S5.p2.3.m3.1.1.3.4.cmml" xref="S5.p2.3.m3.1.1.3.4">
          𝑒
         </ci>
         <apply id="S5.p2.3.m3.1.1.3.5.cmml" xref="S5.p2.3.m3.1.1.3.5">
          <csymbol cd="ambiguous" id="S5.p2.3.m3.1.1.3.5.1.cmml" xref="S5.p2.3.m3.1.1.3.5">
           subscript
          </csymbol>
          <ci id="S5.p2.3.m3.1.1.3.5.2.cmml" xref="S5.p2.3.m3.1.1.3.5.2">
           𝑑
          </ci>
          <ci id="S5.p2.3.m3.1.1.3.5.3.cmml" xref="S5.p2.3.m3.1.1.3.5.3">
           𝑗
          </ci>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p2.3.m3.1c">
       D_{pred_{j}}
      </annotation>
     </semantics>
    </math>
    , using the same module used to extract the actual-scenario ground truth future direction. Based on that
    <math alttext="IFR" class="ltx_Math" display="inline" id="S5.p2.4.m4.1">
     <semantics id="S5.p2.4.m4.1a">
      <mrow id="S5.p2.4.m4.1.1" xref="S5.p2.4.m4.1.1.cmml">
       <mi id="S5.p2.4.m4.1.1.2" xref="S5.p2.4.m4.1.1.2.cmml">
        I
       </mi>
       <mo id="S5.p2.4.m4.1.1.1" lspace="0em" rspace="0em" xref="S5.p2.4.m4.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p2.4.m4.1.1.3" xref="S5.p2.4.m4.1.1.3.cmml">
        F
       </mi>
       <mo id="S5.p2.4.m4.1.1.1a" lspace="0em" rspace="0em" xref="S5.p2.4.m4.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p2.4.m4.1.1.4" xref="S5.p2.4.m4.1.1.4.cmml">
        R
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p2.4.m4.1b">
       <apply id="S5.p2.4.m4.1.1.cmml" xref="S5.p2.4.m4.1.1">
        <times id="S5.p2.4.m4.1.1.1.cmml" xref="S5.p2.4.m4.1.1.1">
        </times>
        <ci id="S5.p2.4.m4.1.1.2.cmml" xref="S5.p2.4.m4.1.1.2">
         𝐼
        </ci>
        <ci id="S5.p2.4.m4.1.1.3.cmml" xref="S5.p2.4.m4.1.1.3">
         𝐹
        </ci>
        <ci id="S5.p2.4.m4.1.1.4.cmml" xref="S5.p2.4.m4.1.1.4">
         𝑅
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p2.4.m4.1c">
       IFR
      </annotation>
     </semantics>
    </math>
    is computed as the average recall across N samples of multimodal trajectory predictions:
   </p>
  </div>
  <div class="ltx_para" id="S5.p3">
   <table class="ltx_equation ltx_eqn_table" id="S5.E3">
    <tbody>
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_eqn_cell ltx_align_center">
       <math alttext="\small IFR=\frac{1}{N}\sum^{N}_{i=1}\frac{1}{M}\sum^{M}_{j=1}\text{Recall}\left(D_{pred_{j}}^{i}\mid D_{intruct}^{i}\right)," class="ltx_Math" display="block" id="S5.E3.m1.1">
        <semantics id="S5.E3.m1.1a">
         <mrow id="S5.E3.m1.1.1.1" xref="S5.E3.m1.1.1.1.1.cmml">
          <mrow id="S5.E3.m1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.cmml">
           <mrow id="S5.E3.m1.1.1.1.1.3" xref="S5.E3.m1.1.1.1.1.3.cmml">
            <mi id="S5.E3.m1.1.1.1.1.3.2" mathsize="90%" xref="S5.E3.m1.1.1.1.1.3.2.cmml">
             I
            </mi>
            <mo id="S5.E3.m1.1.1.1.1.3.1" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.3.1.cmml">
             ​
            </mo>
            <mi id="S5.E3.m1.1.1.1.1.3.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.3.3.cmml">
             F
            </mi>
            <mo id="S5.E3.m1.1.1.1.1.3.1a" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.3.1.cmml">
             ​
            </mo>
            <mi id="S5.E3.m1.1.1.1.1.3.4" mathsize="90%" xref="S5.E3.m1.1.1.1.1.3.4.cmml">
             R
            </mi>
           </mrow>
           <mo id="S5.E3.m1.1.1.1.1.2" mathsize="90%" xref="S5.E3.m1.1.1.1.1.2.cmml">
            =
           </mo>
           <mrow id="S5.E3.m1.1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.1.cmml">
            <mfrac id="S5.E3.m1.1.1.1.1.1.3" xref="S5.E3.m1.1.1.1.1.1.3.cmml">
             <mn id="S5.E3.m1.1.1.1.1.1.3.2" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.3.2.cmml">
              1
             </mn>
             <mi id="S5.E3.m1.1.1.1.1.1.3.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.3.3.cmml">
              N
             </mi>
            </mfrac>
            <mo id="S5.E3.m1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.1.2.cmml">
             ​
            </mo>
            <mrow id="S5.E3.m1.1.1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.1.1.cmml">
             <munderover id="S5.E3.m1.1.1.1.1.1.1.2" xref="S5.E3.m1.1.1.1.1.1.1.2.cmml">
              <mo id="S5.E3.m1.1.1.1.1.1.1.2.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S5.E3.m1.1.1.1.1.1.1.2.2.2.cmml">
               ∑
              </mo>
              <mrow id="S5.E3.m1.1.1.1.1.1.1.2.3" xref="S5.E3.m1.1.1.1.1.1.1.2.3.cmml">
               <mi id="S5.E3.m1.1.1.1.1.1.1.2.3.2" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.2.3.2.cmml">
                i
               </mi>
               <mo id="S5.E3.m1.1.1.1.1.1.1.2.3.1" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.2.3.1.cmml">
                =
               </mo>
               <mn id="S5.E3.m1.1.1.1.1.1.1.2.3.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.2.3.3.cmml">
                1
               </mn>
              </mrow>
              <mi id="S5.E3.m1.1.1.1.1.1.1.2.2.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.2.2.3.cmml">
               N
              </mi>
             </munderover>
             <mrow id="S5.E3.m1.1.1.1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.1.1.1.cmml">
              <mfrac id="S5.E3.m1.1.1.1.1.1.1.1.3" xref="S5.E3.m1.1.1.1.1.1.1.1.3.cmml">
               <mn id="S5.E3.m1.1.1.1.1.1.1.1.3.2" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.3.2.cmml">
                1
               </mn>
               <mi id="S5.E3.m1.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.3.3.cmml">
                M
               </mi>
              </mfrac>
              <mo id="S5.E3.m1.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="S5.E3.m1.1.1.1.1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.1.1.1.1.cmml">
               <munderover id="S5.E3.m1.1.1.1.1.1.1.1.1.2" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.cmml">
                <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.2.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">
                 ∑
                </mo>
                <mrow id="S5.E3.m1.1.1.1.1.1.1.1.1.2.3" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml">
                 <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.2" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">
                  j
                 </mi>
                 <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.1" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">
                  =
                 </mo>
                 <mn id="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">
                  1
                 </mn>
                </mrow>
                <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.2.2.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">
                 M
                </mi>
               </munderover>
               <mrow id="S5.E3.m1.1.1.1.1.1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.cmml">
                <mtext id="S5.E3.m1.1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.3a.cmml">
                 Recall
                </mtext>
                <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml">
                 ​
                </mo>
                <mrow id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                 <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  (
                 </mo>
                 <mrow id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  <msubsup id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                   <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">
                    D
                   </mi>
                   <mrow id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">
                    <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">
                     p
                    </mi>
                    <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">
                     ​
                    </mo>
                    <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">
                     r
                    </mi>
                    <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1a" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">
                     ​
                    </mo>
                    <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.4" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.4.cmml">
                     e
                    </mi>
                    <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1b" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">
                     ​
                    </mo>
                    <msub id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5.cmml">
                     <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5.2" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5.2.cmml">
                      d
                     </mi>
                     <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5.3.cmml">
                      j
                     </mi>
                    </msub>
                   </mrow>
                   <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                    i
                   </mi>
                  </msubsup>
                  <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   ∣
                  </mo>
                  <msubsup id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                   <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">
                    D
                   </mi>
                   <mrow id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">
                    <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">
                     i
                    </mi>
                    <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">
                     ​
                    </mo>
                    <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">
                     n
                    </mi>
                    <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1a" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">
                     ​
                    </mo>
                    <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.4" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.4.cmml">
                     t
                    </mi>
                    <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1b" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">
                     ​
                    </mo>
                    <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.5" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.5.cmml">
                     r
                    </mi>
                    <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1c" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">
                     ​
                    </mo>
                    <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.6" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.6.cmml">
                     u
                    </mi>
                    <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1d" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">
                     ​
                    </mo>
                    <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.7" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.7.cmml">
                     c
                    </mi>
                    <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1e" lspace="0em" rspace="0em" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">
                     ​
                    </mo>
                    <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.8" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.8.cmml">
                     t
                    </mi>
                   </mrow>
                   <mi id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                    i
                   </mi>
                  </msubsup>
                 </mrow>
                 <mo id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
          <mo id="S5.E3.m1.1.1.1.2" mathsize="90%" xref="S5.E3.m1.1.1.1.1.cmml">
           ,
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S5.E3.m1.1b">
          <apply id="S5.E3.m1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1">
           <eq id="S5.E3.m1.1.1.1.1.2.cmml" xref="S5.E3.m1.1.1.1.1.2">
           </eq>
           <apply id="S5.E3.m1.1.1.1.1.3.cmml" xref="S5.E3.m1.1.1.1.1.3">
            <times id="S5.E3.m1.1.1.1.1.3.1.cmml" xref="S5.E3.m1.1.1.1.1.3.1">
            </times>
            <ci id="S5.E3.m1.1.1.1.1.3.2.cmml" xref="S5.E3.m1.1.1.1.1.3.2">
             𝐼
            </ci>
            <ci id="S5.E3.m1.1.1.1.1.3.3.cmml" xref="S5.E3.m1.1.1.1.1.3.3">
             𝐹
            </ci>
            <ci id="S5.E3.m1.1.1.1.1.3.4.cmml" xref="S5.E3.m1.1.1.1.1.3.4">
             𝑅
            </ci>
           </apply>
           <apply id="S5.E3.m1.1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1.1">
            <times id="S5.E3.m1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.1.1.1.1.1.2">
            </times>
            <apply id="S5.E3.m1.1.1.1.1.1.3.cmml" xref="S5.E3.m1.1.1.1.1.1.3">
             <divide id="S5.E3.m1.1.1.1.1.1.3.1.cmml" xref="S5.E3.m1.1.1.1.1.1.3">
             </divide>
             <cn id="S5.E3.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S5.E3.m1.1.1.1.1.1.3.2">
              1
             </cn>
             <ci id="S5.E3.m1.1.1.1.1.1.3.3.cmml" xref="S5.E3.m1.1.1.1.1.1.3.3">
              𝑁
             </ci>
            </apply>
            <apply id="S5.E3.m1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1">
             <apply id="S5.E3.m1.1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.2">
              <csymbol cd="ambiguous" id="S5.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.2">
               subscript
              </csymbol>
              <apply id="S5.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.2">
               <csymbol cd="ambiguous" id="S5.E3.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.2">
                superscript
               </csymbol>
               <sum id="S5.E3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.2.2.2">
               </sum>
               <ci id="S5.E3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.2.2.3">
                𝑁
               </ci>
              </apply>
              <apply id="S5.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.2.3">
               <eq id="S5.E3.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.2.3.1">
               </eq>
               <ci id="S5.E3.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.2.3.2">
                𝑖
               </ci>
               <cn id="S5.E3.m1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S5.E3.m1.1.1.1.1.1.1.2.3.3">
                1
               </cn>
              </apply>
             </apply>
             <apply id="S5.E3.m1.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1">
              <times id="S5.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.2">
              </times>
              <apply id="S5.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.3">
               <divide id="S5.E3.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.3">
               </divide>
               <cn id="S5.E3.m1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S5.E3.m1.1.1.1.1.1.1.1.3.2">
                1
               </cn>
               <ci id="S5.E3.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.3.3">
                𝑀
               </ci>
              </apply>
              <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1">
               <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2">
                <csymbol cd="ambiguous" id="S5.E3.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2">
                 subscript
                </csymbol>
                <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2">
                 <csymbol cd="ambiguous" id="S5.E3.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2">
                  superscript
                 </csymbol>
                 <sum id="S5.E3.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.2.2">
                 </sum>
                 <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.2.3">
                  𝑀
                 </ci>
                </apply>
                <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.3">
                 <eq id="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.1">
                 </eq>
                 <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.2">
                  𝑗
                 </ci>
                 <cn id="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S5.E3.m1.1.1.1.1.1.1.1.1.2.3.3">
                  1
                 </cn>
                </apply>
               </apply>
               <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1">
                <times id="S5.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.2">
                </times>
                <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.3">
                 <mtext id="S5.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="90%" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.3">
                  Recall
                 </mtext>
                </ci>
                <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1">
                 <csymbol cd="latexml" id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">
                  conditional
                 </csymbol>
                 <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                  <csymbol cd="ambiguous" id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                   superscript
                  </csymbol>
                  <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                   <csymbol cd="ambiguous" id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                    subscript
                   </csymbol>
                   <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">
                    𝐷
                   </ci>
                   <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">
                    <times id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1">
                    </times>
                    <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2">
                     𝑝
                    </ci>
                    <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3">
                     𝑟
                    </ci>
                    <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.4.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.4">
                     𝑒
                    </ci>
                    <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5">
                     <csymbol cd="ambiguous" id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5">
                      subscript
                     </csymbol>
                     <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5.2">
                      𝑑
                     </ci>
                     <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.5.3">
                      𝑗
                     </ci>
                    </apply>
                   </apply>
                  </apply>
                  <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">
                   𝑖
                  </ci>
                 </apply>
                 <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                  <csymbol cd="ambiguous" id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                   superscript
                  </csymbol>
                  <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                   <csymbol cd="ambiguous" id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                    subscript
                   </csymbol>
                   <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">
                    𝐷
                   </ci>
                   <apply id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">
                    <times id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1">
                    </times>
                    <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2">
                     𝑖
                    </ci>
                    <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3">
                     𝑛
                    </ci>
                    <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.4">
                     𝑡
                    </ci>
                    <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.5.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.5">
                     𝑟
                    </ci>
                    <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.6.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.6">
                     𝑢
                    </ci>
                    <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.7.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.7">
                     𝑐
                    </ci>
                    <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.8.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.8">
                     𝑡
                    </ci>
                   </apply>
                  </apply>
                  <ci id="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">
                   𝑖
                  </ci>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S5.E3.m1.1c">
          \small IFR=\frac{1}{N}\sum^{N}_{i=1}\frac{1}{M}\sum^{M}_{j=1}\text{Recall}\left(D_{pred_{j}}^{i}\mid D_{intruct}^{i}\right),
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
      <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
       <span class="ltx_tag ltx_tag_equation ltx_align_right">
        (3)
       </span>
      </td>
     </tr>
    </tbody>
   </table>
   <p class="ltx_p" id="S5.p3.3">
    Where a higher
    <math alttext="IFR" class="ltx_Math" display="inline" id="S5.p3.1.m1.1">
     <semantics id="S5.p3.1.m1.1a">
      <mrow id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml">
       <mi id="S5.p3.1.m1.1.1.2" xref="S5.p3.1.m1.1.1.2.cmml">
        I
       </mi>
       <mo id="S5.p3.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S5.p3.1.m1.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p3.1.m1.1.1.3" xref="S5.p3.1.m1.1.1.3.cmml">
        F
       </mi>
       <mo id="S5.p3.1.m1.1.1.1a" lspace="0em" rspace="0em" xref="S5.p3.1.m1.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p3.1.m1.1.1.4" xref="S5.p3.1.m1.1.1.4.cmml">
        R
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b">
       <apply id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1">
        <times id="S5.p3.1.m1.1.1.1.cmml" xref="S5.p3.1.m1.1.1.1">
        </times>
        <ci id="S5.p3.1.m1.1.1.2.cmml" xref="S5.p3.1.m1.1.1.2">
         𝐼
        </ci>
        <ci id="S5.p3.1.m1.1.1.3.cmml" xref="S5.p3.1.m1.1.1.3">
         𝐹
        </ci>
        <ci id="S5.p3.1.m1.1.1.4.cmml" xref="S5.p3.1.m1.1.1.4">
         𝑅
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">
       IFR
      </annotation>
     </semantics>
    </math>
    indicates higher adherence to a given instruction signal. For an unconditional model that takes no instruction signal, we can still measure the
    <math alttext="IRF" class="ltx_Math" display="inline" id="S5.p3.2.m2.1">
     <semantics id="S5.p3.2.m2.1a">
      <mrow id="S5.p3.2.m2.1.1" xref="S5.p3.2.m2.1.1.cmml">
       <mi id="S5.p3.2.m2.1.1.2" xref="S5.p3.2.m2.1.1.2.cmml">
        I
       </mi>
       <mo id="S5.p3.2.m2.1.1.1" lspace="0em" rspace="0em" xref="S5.p3.2.m2.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p3.2.m2.1.1.3" xref="S5.p3.2.m2.1.1.3.cmml">
        R
       </mi>
       <mo id="S5.p3.2.m2.1.1.1a" lspace="0em" rspace="0em" xref="S5.p3.2.m2.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p3.2.m2.1.1.4" xref="S5.p3.2.m2.1.1.4.cmml">
        F
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p3.2.m2.1b">
       <apply id="S5.p3.2.m2.1.1.cmml" xref="S5.p3.2.m2.1.1">
        <times id="S5.p3.2.m2.1.1.1.cmml" xref="S5.p3.2.m2.1.1.1">
        </times>
        <ci id="S5.p3.2.m2.1.1.2.cmml" xref="S5.p3.2.m2.1.1.2">
         𝐼
        </ci>
        <ci id="S5.p3.2.m2.1.1.3.cmml" xref="S5.p3.2.m2.1.1.3">
         𝑅
        </ci>
        <ci id="S5.p3.2.m2.1.1.4.cmml" xref="S5.p3.2.m2.1.1.4">
         𝐹
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p3.2.m2.1c">
       IRF
      </annotation>
     </semantics>
    </math>
    where
    <math alttext="D_{intruct}" class="ltx_Math" display="inline" id="S5.p3.3.m3.1">
     <semantics id="S5.p3.3.m3.1a">
      <msub id="S5.p3.3.m3.1.1" xref="S5.p3.3.m3.1.1.cmml">
       <mi id="S5.p3.3.m3.1.1.2" xref="S5.p3.3.m3.1.1.2.cmml">
        D
       </mi>
       <mrow id="S5.p3.3.m3.1.1.3" xref="S5.p3.3.m3.1.1.3.cmml">
        <mi id="S5.p3.3.m3.1.1.3.2" xref="S5.p3.3.m3.1.1.3.2.cmml">
         i
        </mi>
        <mo id="S5.p3.3.m3.1.1.3.1" lspace="0em" rspace="0em" xref="S5.p3.3.m3.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p3.3.m3.1.1.3.3" xref="S5.p3.3.m3.1.1.3.3.cmml">
         n
        </mi>
        <mo id="S5.p3.3.m3.1.1.3.1a" lspace="0em" rspace="0em" xref="S5.p3.3.m3.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p3.3.m3.1.1.3.4" xref="S5.p3.3.m3.1.1.3.4.cmml">
         t
        </mi>
        <mo id="S5.p3.3.m3.1.1.3.1b" lspace="0em" rspace="0em" xref="S5.p3.3.m3.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p3.3.m3.1.1.3.5" xref="S5.p3.3.m3.1.1.3.5.cmml">
         r
        </mi>
        <mo id="S5.p3.3.m3.1.1.3.1c" lspace="0em" rspace="0em" xref="S5.p3.3.m3.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p3.3.m3.1.1.3.6" xref="S5.p3.3.m3.1.1.3.6.cmml">
         u
        </mi>
        <mo id="S5.p3.3.m3.1.1.3.1d" lspace="0em" rspace="0em" xref="S5.p3.3.m3.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p3.3.m3.1.1.3.7" xref="S5.p3.3.m3.1.1.3.7.cmml">
         c
        </mi>
        <mo id="S5.p3.3.m3.1.1.3.1e" lspace="0em" rspace="0em" xref="S5.p3.3.m3.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p3.3.m3.1.1.3.8" xref="S5.p3.3.m3.1.1.3.8.cmml">
         t
        </mi>
       </mrow>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S5.p3.3.m3.1b">
       <apply id="S5.p3.3.m3.1.1.cmml" xref="S5.p3.3.m3.1.1">
        <csymbol cd="ambiguous" id="S5.p3.3.m3.1.1.1.cmml" xref="S5.p3.3.m3.1.1">
         subscript
        </csymbol>
        <ci id="S5.p3.3.m3.1.1.2.cmml" xref="S5.p3.3.m3.1.1.2">
         𝐷
        </ci>
        <apply id="S5.p3.3.m3.1.1.3.cmml" xref="S5.p3.3.m3.1.1.3">
         <times id="S5.p3.3.m3.1.1.3.1.cmml" xref="S5.p3.3.m3.1.1.3.1">
         </times>
         <ci id="S5.p3.3.m3.1.1.3.2.cmml" xref="S5.p3.3.m3.1.1.3.2">
          𝑖
         </ci>
         <ci id="S5.p3.3.m3.1.1.3.3.cmml" xref="S5.p3.3.m3.1.1.3.3">
          𝑛
         </ci>
         <ci id="S5.p3.3.m3.1.1.3.4.cmml" xref="S5.p3.3.m3.1.1.3.4">
          𝑡
         </ci>
         <ci id="S5.p3.3.m3.1.1.3.5.cmml" xref="S5.p3.3.m3.1.1.3.5">
          𝑟
         </ci>
         <ci id="S5.p3.3.m3.1.1.3.6.cmml" xref="S5.p3.3.m3.1.1.3.6">
          𝑢
         </ci>
         <ci id="S5.p3.3.m3.1.1.3.7.cmml" xref="S5.p3.3.m3.1.1.3.7">
          𝑐
         </ci>
         <ci id="S5.p3.3.m3.1.1.3.8.cmml" xref="S5.p3.3.m3.1.1.3.8">
          𝑡
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p3.3.m3.1c">
       D_{intruct}
      </annotation>
     </semantics>
    </math>
    is considered the actual-scenario ground truth’s future direction.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S5.p4">
   <p class="ltx_p" id="S5.p4.1">
    <span class="ltx_text ltx_font_bold" id="S5.p4.1.1">
     Direction Variety Score (DVS).
    </span>
    To assess the directional diversity of predicted modalities, we measure the ratio of unique direction categories predicted over the total number of modalities
    <math alttext="M" class="ltx_Math" display="inline" id="S5.p4.1.m1.1">
     <semantics id="S5.p4.1.m1.1a">
      <mi id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml">
       M
      </mi>
      <annotation-xml encoding="MathML-Content" id="S5.p4.1.m1.1b">
       <ci id="S5.p4.1.m1.1.1.cmml" xref="S5.p4.1.m1.1.1">
        𝑀
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p4.1.m1.1c">
       M
      </annotation>
     </semantics>
    </math>
    . This metric is calculated irrespective of the actual or given instruction as:
   </p>
   <table class="ltx_equation ltx_eqn_table" id="S5.E4">
    <tbody>
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_eqn_cell ltx_align_center">
       <math alttext="\small DVS=\frac{1}{N}\sum^{N}_{i=1}\frac{\text{Unique}(D_{pred}^{i})}{M}," class="ltx_Math" display="block" id="S5.E4.m1.2">
        <semantics id="S5.E4.m1.2a">
         <mrow id="S5.E4.m1.2.2.1" xref="S5.E4.m1.2.2.1.1.cmml">
          <mrow id="S5.E4.m1.2.2.1.1" xref="S5.E4.m1.2.2.1.1.cmml">
           <mrow id="S5.E4.m1.2.2.1.1.2" xref="S5.E4.m1.2.2.1.1.2.cmml">
            <mi id="S5.E4.m1.2.2.1.1.2.2" mathsize="90%" xref="S5.E4.m1.2.2.1.1.2.2.cmml">
             D
            </mi>
            <mo id="S5.E4.m1.2.2.1.1.2.1" lspace="0em" rspace="0em" xref="S5.E4.m1.2.2.1.1.2.1.cmml">
             ​
            </mo>
            <mi id="S5.E4.m1.2.2.1.1.2.3" mathsize="90%" xref="S5.E4.m1.2.2.1.1.2.3.cmml">
             V
            </mi>
            <mo id="S5.E4.m1.2.2.1.1.2.1a" lspace="0em" rspace="0em" xref="S5.E4.m1.2.2.1.1.2.1.cmml">
             ​
            </mo>
            <mi id="S5.E4.m1.2.2.1.1.2.4" mathsize="90%" xref="S5.E4.m1.2.2.1.1.2.4.cmml">
             S
            </mi>
           </mrow>
           <mo id="S5.E4.m1.2.2.1.1.1" mathsize="90%" xref="S5.E4.m1.2.2.1.1.1.cmml">
            =
           </mo>
           <mrow id="S5.E4.m1.2.2.1.1.3" xref="S5.E4.m1.2.2.1.1.3.cmml">
            <mfrac id="S5.E4.m1.2.2.1.1.3.2" xref="S5.E4.m1.2.2.1.1.3.2.cmml">
             <mn id="S5.E4.m1.2.2.1.1.3.2.2" mathsize="90%" xref="S5.E4.m1.2.2.1.1.3.2.2.cmml">
              1
             </mn>
             <mi id="S5.E4.m1.2.2.1.1.3.2.3" mathsize="90%" xref="S5.E4.m1.2.2.1.1.3.2.3.cmml">
              N
             </mi>
            </mfrac>
            <mo id="S5.E4.m1.2.2.1.1.3.1" lspace="0em" rspace="0em" xref="S5.E4.m1.2.2.1.1.3.1.cmml">
             ​
            </mo>
            <mrow id="S5.E4.m1.2.2.1.1.3.3" xref="S5.E4.m1.2.2.1.1.3.3.cmml">
             <munderover id="S5.E4.m1.2.2.1.1.3.3.1" xref="S5.E4.m1.2.2.1.1.3.3.1.cmml">
              <mo id="S5.E4.m1.2.2.1.1.3.3.1.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S5.E4.m1.2.2.1.1.3.3.1.2.2.cmml">
               ∑
              </mo>
              <mrow id="S5.E4.m1.2.2.1.1.3.3.1.3" xref="S5.E4.m1.2.2.1.1.3.3.1.3.cmml">
               <mi id="S5.E4.m1.2.2.1.1.3.3.1.3.2" mathsize="90%" xref="S5.E4.m1.2.2.1.1.3.3.1.3.2.cmml">
                i
               </mi>
               <mo id="S5.E4.m1.2.2.1.1.3.3.1.3.1" mathsize="90%" xref="S5.E4.m1.2.2.1.1.3.3.1.3.1.cmml">
                =
               </mo>
               <mn id="S5.E4.m1.2.2.1.1.3.3.1.3.3" mathsize="90%" xref="S5.E4.m1.2.2.1.1.3.3.1.3.3.cmml">
                1
               </mn>
              </mrow>
              <mi id="S5.E4.m1.2.2.1.1.3.3.1.2.3" mathsize="90%" xref="S5.E4.m1.2.2.1.1.3.3.1.2.3.cmml">
               N
              </mi>
             </munderover>
             <mfrac id="S5.E4.m1.1.1" xref="S5.E4.m1.1.1.cmml">
              <mrow id="S5.E4.m1.1.1.1" xref="S5.E4.m1.1.1.1.cmml">
               <mtext id="S5.E4.m1.1.1.1.3" mathsize="90%" xref="S5.E4.m1.1.1.1.3a.cmml">
                Unique
               </mtext>
               <mo id="S5.E4.m1.1.1.1.2" lspace="0em" rspace="0em" xref="S5.E4.m1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="S5.E4.m1.1.1.1.1.1" xref="S5.E4.m1.1.1.1.1.1.1.cmml">
                <mo id="S5.E4.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S5.E4.m1.1.1.1.1.1.1.cmml">
                 (
                </mo>
                <msubsup id="S5.E4.m1.1.1.1.1.1.1" xref="S5.E4.m1.1.1.1.1.1.1.cmml">
                 <mi id="S5.E4.m1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S5.E4.m1.1.1.1.1.1.1.2.2.cmml">
                  D
                 </mi>
                 <mrow id="S5.E4.m1.1.1.1.1.1.1.2.3" xref="S5.E4.m1.1.1.1.1.1.1.2.3.cmml">
                  <mi id="S5.E4.m1.1.1.1.1.1.1.2.3.2" mathsize="90%" xref="S5.E4.m1.1.1.1.1.1.1.2.3.2.cmml">
                   p
                  </mi>
                  <mo id="S5.E4.m1.1.1.1.1.1.1.2.3.1" lspace="0em" rspace="0em" xref="S5.E4.m1.1.1.1.1.1.1.2.3.1.cmml">
                   ​
                  </mo>
                  <mi id="S5.E4.m1.1.1.1.1.1.1.2.3.3" mathsize="90%" xref="S5.E4.m1.1.1.1.1.1.1.2.3.3.cmml">
                   r
                  </mi>
                  <mo id="S5.E4.m1.1.1.1.1.1.1.2.3.1a" lspace="0em" rspace="0em" xref="S5.E4.m1.1.1.1.1.1.1.2.3.1.cmml">
                   ​
                  </mo>
                  <mi id="S5.E4.m1.1.1.1.1.1.1.2.3.4" mathsize="90%" xref="S5.E4.m1.1.1.1.1.1.1.2.3.4.cmml">
                   e
                  </mi>
                  <mo id="S5.E4.m1.1.1.1.1.1.1.2.3.1b" lspace="0em" rspace="0em" xref="S5.E4.m1.1.1.1.1.1.1.2.3.1.cmml">
                   ​
                  </mo>
                  <mi id="S5.E4.m1.1.1.1.1.1.1.2.3.5" mathsize="90%" xref="S5.E4.m1.1.1.1.1.1.1.2.3.5.cmml">
                   d
                  </mi>
                 </mrow>
                 <mi id="S5.E4.m1.1.1.1.1.1.1.3" mathsize="90%" xref="S5.E4.m1.1.1.1.1.1.1.3.cmml">
                  i
                 </mi>
                </msubsup>
                <mo id="S5.E4.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S5.E4.m1.1.1.1.1.1.1.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mi id="S5.E4.m1.1.1.3" mathsize="90%" xref="S5.E4.m1.1.1.3.cmml">
               M
              </mi>
             </mfrac>
            </mrow>
           </mrow>
          </mrow>
          <mo id="S5.E4.m1.2.2.1.2" mathsize="90%" xref="S5.E4.m1.2.2.1.1.cmml">
           ,
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S5.E4.m1.2b">
          <apply id="S5.E4.m1.2.2.1.1.cmml" xref="S5.E4.m1.2.2.1">
           <eq id="S5.E4.m1.2.2.1.1.1.cmml" xref="S5.E4.m1.2.2.1.1.1">
           </eq>
           <apply id="S5.E4.m1.2.2.1.1.2.cmml" xref="S5.E4.m1.2.2.1.1.2">
            <times id="S5.E4.m1.2.2.1.1.2.1.cmml" xref="S5.E4.m1.2.2.1.1.2.1">
            </times>
            <ci id="S5.E4.m1.2.2.1.1.2.2.cmml" xref="S5.E4.m1.2.2.1.1.2.2">
             𝐷
            </ci>
            <ci id="S5.E4.m1.2.2.1.1.2.3.cmml" xref="S5.E4.m1.2.2.1.1.2.3">
             𝑉
            </ci>
            <ci id="S5.E4.m1.2.2.1.1.2.4.cmml" xref="S5.E4.m1.2.2.1.1.2.4">
             𝑆
            </ci>
           </apply>
           <apply id="S5.E4.m1.2.2.1.1.3.cmml" xref="S5.E4.m1.2.2.1.1.3">
            <times id="S5.E4.m1.2.2.1.1.3.1.cmml" xref="S5.E4.m1.2.2.1.1.3.1">
            </times>
            <apply id="S5.E4.m1.2.2.1.1.3.2.cmml" xref="S5.E4.m1.2.2.1.1.3.2">
             <divide id="S5.E4.m1.2.2.1.1.3.2.1.cmml" xref="S5.E4.m1.2.2.1.1.3.2">
             </divide>
             <cn id="S5.E4.m1.2.2.1.1.3.2.2.cmml" type="integer" xref="S5.E4.m1.2.2.1.1.3.2.2">
              1
             </cn>
             <ci id="S5.E4.m1.2.2.1.1.3.2.3.cmml" xref="S5.E4.m1.2.2.1.1.3.2.3">
              𝑁
             </ci>
            </apply>
            <apply id="S5.E4.m1.2.2.1.1.3.3.cmml" xref="S5.E4.m1.2.2.1.1.3.3">
             <apply id="S5.E4.m1.2.2.1.1.3.3.1.cmml" xref="S5.E4.m1.2.2.1.1.3.3.1">
              <csymbol cd="ambiguous" id="S5.E4.m1.2.2.1.1.3.3.1.1.cmml" xref="S5.E4.m1.2.2.1.1.3.3.1">
               subscript
              </csymbol>
              <apply id="S5.E4.m1.2.2.1.1.3.3.1.2.cmml" xref="S5.E4.m1.2.2.1.1.3.3.1">
               <csymbol cd="ambiguous" id="S5.E4.m1.2.2.1.1.3.3.1.2.1.cmml" xref="S5.E4.m1.2.2.1.1.3.3.1">
                superscript
               </csymbol>
               <sum id="S5.E4.m1.2.2.1.1.3.3.1.2.2.cmml" xref="S5.E4.m1.2.2.1.1.3.3.1.2.2">
               </sum>
               <ci id="S5.E4.m1.2.2.1.1.3.3.1.2.3.cmml" xref="S5.E4.m1.2.2.1.1.3.3.1.2.3">
                𝑁
               </ci>
              </apply>
              <apply id="S5.E4.m1.2.2.1.1.3.3.1.3.cmml" xref="S5.E4.m1.2.2.1.1.3.3.1.3">
               <eq id="S5.E4.m1.2.2.1.1.3.3.1.3.1.cmml" xref="S5.E4.m1.2.2.1.1.3.3.1.3.1">
               </eq>
               <ci id="S5.E4.m1.2.2.1.1.3.3.1.3.2.cmml" xref="S5.E4.m1.2.2.1.1.3.3.1.3.2">
                𝑖
               </ci>
               <cn id="S5.E4.m1.2.2.1.1.3.3.1.3.3.cmml" type="integer" xref="S5.E4.m1.2.2.1.1.3.3.1.3.3">
                1
               </cn>
              </apply>
             </apply>
             <apply id="S5.E4.m1.1.1.cmml" xref="S5.E4.m1.1.1">
              <divide id="S5.E4.m1.1.1.2.cmml" xref="S5.E4.m1.1.1">
              </divide>
              <apply id="S5.E4.m1.1.1.1.cmml" xref="S5.E4.m1.1.1.1">
               <times id="S5.E4.m1.1.1.1.2.cmml" xref="S5.E4.m1.1.1.1.2">
               </times>
               <ci id="S5.E4.m1.1.1.1.3a.cmml" xref="S5.E4.m1.1.1.1.3">
                <mtext id="S5.E4.m1.1.1.1.3.cmml" mathsize="90%" xref="S5.E4.m1.1.1.1.3">
                 Unique
                </mtext>
               </ci>
               <apply id="S5.E4.m1.1.1.1.1.1.1.cmml" xref="S5.E4.m1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S5.E4.m1.1.1.1.1.1.1.1.cmml" xref="S5.E4.m1.1.1.1.1.1">
                 superscript
                </csymbol>
                <apply id="S5.E4.m1.1.1.1.1.1.1.2.cmml" xref="S5.E4.m1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="S5.E4.m1.1.1.1.1.1.1.2.1.cmml" xref="S5.E4.m1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="S5.E4.m1.1.1.1.1.1.1.2.2.cmml" xref="S5.E4.m1.1.1.1.1.1.1.2.2">
                  𝐷
                 </ci>
                 <apply id="S5.E4.m1.1.1.1.1.1.1.2.3.cmml" xref="S5.E4.m1.1.1.1.1.1.1.2.3">
                  <times id="S5.E4.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S5.E4.m1.1.1.1.1.1.1.2.3.1">
                  </times>
                  <ci id="S5.E4.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S5.E4.m1.1.1.1.1.1.1.2.3.2">
                   𝑝
                  </ci>
                  <ci id="S5.E4.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S5.E4.m1.1.1.1.1.1.1.2.3.3">
                   𝑟
                  </ci>
                  <ci id="S5.E4.m1.1.1.1.1.1.1.2.3.4.cmml" xref="S5.E4.m1.1.1.1.1.1.1.2.3.4">
                   𝑒
                  </ci>
                  <ci id="S5.E4.m1.1.1.1.1.1.1.2.3.5.cmml" xref="S5.E4.m1.1.1.1.1.1.1.2.3.5">
                   𝑑
                  </ci>
                 </apply>
                </apply>
                <ci id="S5.E4.m1.1.1.1.1.1.1.3.cmml" xref="S5.E4.m1.1.1.1.1.1.1.3">
                 𝑖
                </ci>
               </apply>
              </apply>
              <ci id="S5.E4.m1.1.1.3.cmml" xref="S5.E4.m1.1.1.3">
               𝑀
              </ci>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S5.E4.m1.2c">
          \small DVS=\frac{1}{N}\sum^{N}_{i=1}\frac{\text{Unique}(D_{pred}^{i})}{M},
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
      <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
       <span class="ltx_tag ltx_tag_equation ltx_align_right">
        (4)
       </span>
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <div class="ltx_para" id="S5.p5">
   <p class="ltx_p" id="S5.p5.1">
    Where a higher
    <math alttext="DVS" class="ltx_Math" display="inline" id="S5.p5.1.m1.1">
     <semantics id="S5.p5.1.m1.1a">
      <mrow id="S5.p5.1.m1.1.1" xref="S5.p5.1.m1.1.1.cmml">
       <mi id="S5.p5.1.m1.1.1.2" xref="S5.p5.1.m1.1.1.2.cmml">
        D
       </mi>
       <mo id="S5.p5.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S5.p5.1.m1.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p5.1.m1.1.1.3" xref="S5.p5.1.m1.1.1.3.cmml">
        V
       </mi>
       <mo id="S5.p5.1.m1.1.1.1a" lspace="0em" rspace="0em" xref="S5.p5.1.m1.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p5.1.m1.1.1.4" xref="S5.p5.1.m1.1.1.4.cmml">
        S
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p5.1.m1.1b">
       <apply id="S5.p5.1.m1.1.1.cmml" xref="S5.p5.1.m1.1.1">
        <times id="S5.p5.1.m1.1.1.1.cmml" xref="S5.p5.1.m1.1.1.1">
        </times>
        <ci id="S5.p5.1.m1.1.1.2.cmml" xref="S5.p5.1.m1.1.1.2">
         𝐷
        </ci>
        <ci id="S5.p5.1.m1.1.1.3.cmml" xref="S5.p5.1.m1.1.1.3">
         𝑉
        </ci>
        <ci id="S5.p5.1.m1.1.1.4.cmml" xref="S5.p5.1.m1.1.1.4">
         𝑆
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p5.1.m1.1c">
       DVS
      </annotation>
     </semantics>
    </math>
    indicates more diversity of predicted directions.
   </p>
  </div>
  <div class="ltx_para" id="S5.p6">
   <p class="ltx_p" id="S5.p6.7">
    Figure
    <a class="ltx_ref" href="#S5.F4" title="Figure 4 ‣ 5 Instruction Following and Diversity Metrics ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      4
     </span>
    </a>
    shows three illustrative examples given an input instruction or an actual-scenario instruction of “move straight.”. The left example shows the highest possible
    <math alttext="IFR" class="ltx_Math" display="inline" id="S5.p6.1.m1.1">
     <semantics id="S5.p6.1.m1.1a">
      <mrow id="S5.p6.1.m1.1.1" xref="S5.p6.1.m1.1.1.cmml">
       <mi id="S5.p6.1.m1.1.1.2" xref="S5.p6.1.m1.1.1.2.cmml">
        I
       </mi>
       <mo id="S5.p6.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S5.p6.1.m1.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p6.1.m1.1.1.3" xref="S5.p6.1.m1.1.1.3.cmml">
        F
       </mi>
       <mo id="S5.p6.1.m1.1.1.1a" lspace="0em" rspace="0em" xref="S5.p6.1.m1.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p6.1.m1.1.1.4" xref="S5.p6.1.m1.1.1.4.cmml">
        R
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p6.1.m1.1b">
       <apply id="S5.p6.1.m1.1.1.cmml" xref="S5.p6.1.m1.1.1">
        <times id="S5.p6.1.m1.1.1.1.cmml" xref="S5.p6.1.m1.1.1.1">
        </times>
        <ci id="S5.p6.1.m1.1.1.2.cmml" xref="S5.p6.1.m1.1.1.2">
         𝐼
        </ci>
        <ci id="S5.p6.1.m1.1.1.3.cmml" xref="S5.p6.1.m1.1.1.3">
         𝐹
        </ci>
        <ci id="S5.p6.1.m1.1.1.4.cmml" xref="S5.p6.1.m1.1.1.4">
         𝑅
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p6.1.m1.1c">
       IFR
      </annotation>
     </semantics>
    </math>
    , where all modalities are precisely in the "move straight" direction. The middle example has only two true positives while covering 3 unique directions, resulting in a
    <math alttext="2/6" class="ltx_Math" display="inline" id="S5.p6.2.m2.1">
     <semantics id="S5.p6.2.m2.1a">
      <mrow id="S5.p6.2.m2.1.1" xref="S5.p6.2.m2.1.1.cmml">
       <mn id="S5.p6.2.m2.1.1.2" xref="S5.p6.2.m2.1.1.2.cmml">
        2
       </mn>
       <mo id="S5.p6.2.m2.1.1.1" xref="S5.p6.2.m2.1.1.1.cmml">
        /
       </mo>
       <mn id="S5.p6.2.m2.1.1.3" xref="S5.p6.2.m2.1.1.3.cmml">
        6
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p6.2.m2.1b">
       <apply id="S5.p6.2.m2.1.1.cmml" xref="S5.p6.2.m2.1.1">
        <divide id="S5.p6.2.m2.1.1.1.cmml" xref="S5.p6.2.m2.1.1.1">
        </divide>
        <cn id="S5.p6.2.m2.1.1.2.cmml" type="integer" xref="S5.p6.2.m2.1.1.2">
         2
        </cn>
        <cn id="S5.p6.2.m2.1.1.3.cmml" type="integer" xref="S5.p6.2.m2.1.1.3">
         6
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p6.2.m2.1c">
       2/6
      </annotation>
     </semantics>
    </math>
    <math alttext="IFR" class="ltx_Math" display="inline" id="S5.p6.3.m3.1">
     <semantics id="S5.p6.3.m3.1a">
      <mrow id="S5.p6.3.m3.1.1" xref="S5.p6.3.m3.1.1.cmml">
       <mi id="S5.p6.3.m3.1.1.2" xref="S5.p6.3.m3.1.1.2.cmml">
        I
       </mi>
       <mo id="S5.p6.3.m3.1.1.1" lspace="0em" rspace="0em" xref="S5.p6.3.m3.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p6.3.m3.1.1.3" xref="S5.p6.3.m3.1.1.3.cmml">
        F
       </mi>
       <mo id="S5.p6.3.m3.1.1.1a" lspace="0em" rspace="0em" xref="S5.p6.3.m3.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p6.3.m3.1.1.4" xref="S5.p6.3.m3.1.1.4.cmml">
        R
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p6.3.m3.1b">
       <apply id="S5.p6.3.m3.1.1.cmml" xref="S5.p6.3.m3.1.1">
        <times id="S5.p6.3.m3.1.1.1.cmml" xref="S5.p6.3.m3.1.1.1">
        </times>
        <ci id="S5.p6.3.m3.1.1.2.cmml" xref="S5.p6.3.m3.1.1.2">
         𝐼
        </ci>
        <ci id="S5.p6.3.m3.1.1.3.cmml" xref="S5.p6.3.m3.1.1.3">
         𝐹
        </ci>
        <ci id="S5.p6.3.m3.1.1.4.cmml" xref="S5.p6.3.m3.1.1.4">
         𝑅
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p6.3.m3.1c">
       IFR
      </annotation>
     </semantics>
    </math>
    and
    <math alttext="3/6" class="ltx_Math" display="inline" id="S5.p6.4.m4.1">
     <semantics id="S5.p6.4.m4.1a">
      <mrow id="S5.p6.4.m4.1.1" xref="S5.p6.4.m4.1.1.cmml">
       <mn id="S5.p6.4.m4.1.1.2" xref="S5.p6.4.m4.1.1.2.cmml">
        3
       </mn>
       <mo id="S5.p6.4.m4.1.1.1" xref="S5.p6.4.m4.1.1.1.cmml">
        /
       </mo>
       <mn id="S5.p6.4.m4.1.1.3" xref="S5.p6.4.m4.1.1.3.cmml">
        6
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p6.4.m4.1b">
       <apply id="S5.p6.4.m4.1.1.cmml" xref="S5.p6.4.m4.1.1">
        <divide id="S5.p6.4.m4.1.1.1.cmml" xref="S5.p6.4.m4.1.1.1">
        </divide>
        <cn id="S5.p6.4.m4.1.1.2.cmml" type="integer" xref="S5.p6.4.m4.1.1.2">
         3
        </cn>
        <cn id="S5.p6.4.m4.1.1.3.cmml" type="integer" xref="S5.p6.4.m4.1.1.3">
         6
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p6.4.m4.1c">
       3/6
      </annotation>
     </semantics>
    </math>
    <math alttext="DVS" class="ltx_Math" display="inline" id="S5.p6.5.m5.1">
     <semantics id="S5.p6.5.m5.1a">
      <mrow id="S5.p6.5.m5.1.1" xref="S5.p6.5.m5.1.1.cmml">
       <mi id="S5.p6.5.m5.1.1.2" xref="S5.p6.5.m5.1.1.2.cmml">
        D
       </mi>
       <mo id="S5.p6.5.m5.1.1.1" lspace="0em" rspace="0em" xref="S5.p6.5.m5.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p6.5.m5.1.1.3" xref="S5.p6.5.m5.1.1.3.cmml">
        V
       </mi>
       <mo id="S5.p6.5.m5.1.1.1a" lspace="0em" rspace="0em" xref="S5.p6.5.m5.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p6.5.m5.1.1.4" xref="S5.p6.5.m5.1.1.4.cmml">
        S
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p6.5.m5.1b">
       <apply id="S5.p6.5.m5.1.1.cmml" xref="S5.p6.5.m5.1.1">
        <times id="S5.p6.5.m5.1.1.1.cmml" xref="S5.p6.5.m5.1.1.1">
        </times>
        <ci id="S5.p6.5.m5.1.1.2.cmml" xref="S5.p6.5.m5.1.1.2">
         𝐷
        </ci>
        <ci id="S5.p6.5.m5.1.1.3.cmml" xref="S5.p6.5.m5.1.1.3">
         𝑉
        </ci>
        <ci id="S5.p6.5.m5.1.1.4.cmml" xref="S5.p6.5.m5.1.1.4">
         𝑆
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p6.5.m5.1c">
       DVS
      </annotation>
     </semantics>
    </math>
    . The right example shows the highest possible directional diversity of a maximum possible number of unique directions, with only one true positive resulting in
    <math alttext="1/6" class="ltx_Math" display="inline" id="S5.p6.6.m6.1">
     <semantics id="S5.p6.6.m6.1a">
      <mrow id="S5.p6.6.m6.1.1" xref="S5.p6.6.m6.1.1.cmml">
       <mn id="S5.p6.6.m6.1.1.2" xref="S5.p6.6.m6.1.1.2.cmml">
        1
       </mn>
       <mo id="S5.p6.6.m6.1.1.1" xref="S5.p6.6.m6.1.1.1.cmml">
        /
       </mo>
       <mn id="S5.p6.6.m6.1.1.3" xref="S5.p6.6.m6.1.1.3.cmml">
        6
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p6.6.m6.1b">
       <apply id="S5.p6.6.m6.1.1.cmml" xref="S5.p6.6.m6.1.1">
        <divide id="S5.p6.6.m6.1.1.1.cmml" xref="S5.p6.6.m6.1.1.1">
        </divide>
        <cn id="S5.p6.6.m6.1.1.2.cmml" type="integer" xref="S5.p6.6.m6.1.1.2">
         1
        </cn>
        <cn id="S5.p6.6.m6.1.1.3.cmml" type="integer" xref="S5.p6.6.m6.1.1.3">
         6
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p6.6.m6.1c">
       1/6
      </annotation>
     </semantics>
    </math>
    <math alttext="IFR" class="ltx_Math" display="inline" id="S5.p6.7.m7.1">
     <semantics id="S5.p6.7.m7.1a">
      <mrow id="S5.p6.7.m7.1.1" xref="S5.p6.7.m7.1.1.cmml">
       <mi id="S5.p6.7.m7.1.1.2" xref="S5.p6.7.m7.1.1.2.cmml">
        I
       </mi>
       <mo id="S5.p6.7.m7.1.1.1" lspace="0em" rspace="0em" xref="S5.p6.7.m7.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p6.7.m7.1.1.3" xref="S5.p6.7.m7.1.1.3.cmml">
        F
       </mi>
       <mo id="S5.p6.7.m7.1.1.1a" lspace="0em" rspace="0em" xref="S5.p6.7.m7.1.1.1.cmml">
        ​
       </mo>
       <mi id="S5.p6.7.m7.1.1.4" xref="S5.p6.7.m7.1.1.4.cmml">
        R
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p6.7.m7.1b">
       <apply id="S5.p6.7.m7.1.1.cmml" xref="S5.p6.7.m7.1.1">
        <times id="S5.p6.7.m7.1.1.1.cmml" xref="S5.p6.7.m7.1.1.1">
        </times>
        <ci id="S5.p6.7.m7.1.1.2.cmml" xref="S5.p6.7.m7.1.1.2">
         𝐼
        </ci>
        <ci id="S5.p6.7.m7.1.1.3.cmml" xref="S5.p6.7.m7.1.1.3">
         𝐹
        </ci>
        <ci id="S5.p6.7.m7.1.1.4.cmml" xref="S5.p6.7.m7.1.1.4">
         𝑅
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p6.7.m7.1c">
       IFR
      </annotation>
     </semantics>
    </math>
    . In our experiments, we report the values in percentages.
   </p>
  </div>
  <figure class="ltx_figure" id="S5.F4">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="142" id="S5.F4.g1" src="/html/2406.06211/assets/figures/ifr_dvs_illustration.png" width="449"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S5.F4.2.1.1" style="font-size:90%;">
      Figure 4
     </span>
     :
    </span>
    <span class="ltx_text" id="S5.F4.3.2" style="font-size:90%;">
     Illustrative examples of IFR and DVS of 6 modalities given a direction instruction of "move straight".
    </span>
   </figcaption>
  </figure>
 </section>
 <section class="ltx_section" id="S6">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    6
   </span>
   Experiments
  </h2>
  <section class="ltx_subsection" id="S6.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     6.1
    </span>
    Experimental Setup
   </h3>
   <div class="ltx_para ltx_noindent" id="S6.SS1.p1">
    <p class="ltx_p" id="S6.SS1.p1.2">
     <span class="ltx_text ltx_font_bold" id="S6.SS1.p1.2.1">
      Implementation Details.
     </span>
     We adopt GameFormer
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib25" title="">
       25
      </a>
      ]
     </cite>
     as our trajectory forecasting backbone, using 327,391 training samples. The LLM projection layers and LoRA weights are fine-tuned over 15,000 training steps, with 4,000 iterations per inner epoch and a batch size of 24, effectively covering 360,000 training samples. With LoRA parameters of (r=8, alpha=16). We utilize the Adam optimizer with an initial learning rate (LR) of
     <math alttext="1e\text{-}4" class="ltx_Math" display="inline" id="S6.SS1.p1.1.m1.1">
      <semantics id="S6.SS1.p1.1.m1.1a">
       <mrow id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml">
        <mn id="S6.SS1.p1.1.m1.1.1.2" xref="S6.SS1.p1.1.m1.1.1.2.cmml">
         1
        </mn>
        <mo id="S6.SS1.p1.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S6.SS1.p1.1.m1.1.1.1.cmml">
         ​
        </mo>
        <mi id="S6.SS1.p1.1.m1.1.1.3" xref="S6.SS1.p1.1.m1.1.1.3.cmml">
         e
        </mi>
        <mo id="S6.SS1.p1.1.m1.1.1.1a" lspace="0em" rspace="0em" xref="S6.SS1.p1.1.m1.1.1.1.cmml">
         ​
        </mo>
        <mtext id="S6.SS1.p1.1.m1.1.1.4" xref="S6.SS1.p1.1.m1.1.1.4a.cmml">
         -
        </mtext>
        <mo id="S6.SS1.p1.1.m1.1.1.1b" lspace="0em" rspace="0em" xref="S6.SS1.p1.1.m1.1.1.1.cmml">
         ​
        </mo>
        <mn id="S6.SS1.p1.1.m1.1.1.5" xref="S6.SS1.p1.1.m1.1.1.5.cmml">
         4
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.1b">
        <apply id="S6.SS1.p1.1.m1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1">
         <times id="S6.SS1.p1.1.m1.1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1.1">
         </times>
         <cn id="S6.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S6.SS1.p1.1.m1.1.1.2">
          1
         </cn>
         <ci id="S6.SS1.p1.1.m1.1.1.3.cmml" xref="S6.SS1.p1.1.m1.1.1.3">
          𝑒
         </ci>
         <ci id="S6.SS1.p1.1.m1.1.1.4a.cmml" xref="S6.SS1.p1.1.m1.1.1.4">
          <mtext id="S6.SS1.p1.1.m1.1.1.4.cmml" xref="S6.SS1.p1.1.m1.1.1.4">
           -
          </mtext>
         </ci>
         <cn id="S6.SS1.p1.1.m1.1.1.5.cmml" type="integer" xref="S6.SS1.p1.1.m1.1.1.5">
          4
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.1c">
        1e\text{-}4
       </annotation>
      </semantics>
     </math>
     , incorporating a linear warmup for the first 100 steps starting from a warmup LR of
     <math alttext="1e\text{-}6" class="ltx_Math" display="inline" id="S6.SS1.p1.2.m2.1">
      <semantics id="S6.SS1.p1.2.m2.1a">
       <mrow id="S6.SS1.p1.2.m2.1.1" xref="S6.SS1.p1.2.m2.1.1.cmml">
        <mn id="S6.SS1.p1.2.m2.1.1.2" xref="S6.SS1.p1.2.m2.1.1.2.cmml">
         1
        </mn>
        <mo id="S6.SS1.p1.2.m2.1.1.1" lspace="0em" rspace="0em" xref="S6.SS1.p1.2.m2.1.1.1.cmml">
         ​
        </mo>
        <mi id="S6.SS1.p1.2.m2.1.1.3" xref="S6.SS1.p1.2.m2.1.1.3.cmml">
         e
        </mi>
        <mo id="S6.SS1.p1.2.m2.1.1.1a" lspace="0em" rspace="0em" xref="S6.SS1.p1.2.m2.1.1.1.cmml">
         ​
        </mo>
        <mtext id="S6.SS1.p1.2.m2.1.1.4" xref="S6.SS1.p1.2.m2.1.1.4a.cmml">
         -
        </mtext>
        <mo id="S6.SS1.p1.2.m2.1.1.1b" lspace="0em" rspace="0em" xref="S6.SS1.p1.2.m2.1.1.1.cmml">
         ​
        </mo>
        <mn id="S6.SS1.p1.2.m2.1.1.5" xref="S6.SS1.p1.2.m2.1.1.5.cmml">
         6
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S6.SS1.p1.2.m2.1b">
        <apply id="S6.SS1.p1.2.m2.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1">
         <times id="S6.SS1.p1.2.m2.1.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1.1">
         </times>
         <cn id="S6.SS1.p1.2.m2.1.1.2.cmml" type="integer" xref="S6.SS1.p1.2.m2.1.1.2">
          1
         </cn>
         <ci id="S6.SS1.p1.2.m2.1.1.3.cmml" xref="S6.SS1.p1.2.m2.1.1.3">
          𝑒
         </ci>
         <ci id="S6.SS1.p1.2.m2.1.1.4a.cmml" xref="S6.SS1.p1.2.m2.1.1.4">
          <mtext id="S6.SS1.p1.2.m2.1.1.4.cmml" xref="S6.SS1.p1.2.m2.1.1.4">
           -
          </mtext>
         </ci>
         <cn id="S6.SS1.p1.2.m2.1.1.5.cmml" type="integer" xref="S6.SS1.p1.2.m2.1.1.5">
          6
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S6.SS1.p1.2.m2.1c">
        1e\text{-}6
       </annotation>
      </semantics>
     </math>
     , followed by a cosine LR scheduler. The training process takes 12 hours on four A100-80GB GPUs.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S6.SS1.p2">
    <p class="ltx_p" id="S6.SS1.p2.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS1.p2.1.1">
      Metrics.
     </span>
     In addition to the proposed metrics,
     <span class="ltx_text ltx_font_italic" id="S6.SS1.p2.1.2">
      i.e.
     </span>
     , Recall-Instruction Following (
     <math alttext="RIF" class="ltx_Math" display="inline" id="S6.SS1.p2.1.m1.1">
      <semantics id="S6.SS1.p2.1.m1.1a">
       <mrow id="S6.SS1.p2.1.m1.1.1" xref="S6.SS1.p2.1.m1.1.1.cmml">
        <mi id="S6.SS1.p2.1.m1.1.1.2" xref="S6.SS1.p2.1.m1.1.1.2.cmml">
         R
        </mi>
        <mo id="S6.SS1.p2.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S6.SS1.p2.1.m1.1.1.1.cmml">
         ​
        </mo>
        <mi id="S6.SS1.p2.1.m1.1.1.3" xref="S6.SS1.p2.1.m1.1.1.3.cmml">
         I
        </mi>
        <mo id="S6.SS1.p2.1.m1.1.1.1a" lspace="0em" rspace="0em" xref="S6.SS1.p2.1.m1.1.1.1.cmml">
         ​
        </mo>
        <mi id="S6.SS1.p2.1.m1.1.1.4" xref="S6.SS1.p2.1.m1.1.1.4.cmml">
         F
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S6.SS1.p2.1.m1.1b">
        <apply id="S6.SS1.p2.1.m1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1">
         <times id="S6.SS1.p2.1.m1.1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1.1">
         </times>
         <ci id="S6.SS1.p2.1.m1.1.1.2.cmml" xref="S6.SS1.p2.1.m1.1.1.2">
          𝑅
         </ci>
         <ci id="S6.SS1.p2.1.m1.1.1.3.cmml" xref="S6.SS1.p2.1.m1.1.1.3">
          𝐼
         </ci>
         <ci id="S6.SS1.p2.1.m1.1.1.4.cmml" xref="S6.SS1.p2.1.m1.1.1.4">
          𝐹
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S6.SS1.p2.1.m1.1c">
        RIF
       </annotation>
      </semantics>
     </math>
     ) and Diversity, which are discussed in Section
     <a class="ltx_ref" href="#S5" title="5 Instruction Following and Diversity Metrics ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     , we employ the conventional motion metrics; minADE and minFDE
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib17" title="">
       17
      </a>
      ]
     </cite>
     .
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S6.SS1.p3">
    <p class="ltx_p" id="S6.SS1.p3.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS1.p3.1.1">
      Evaluation.
     </span>
     Each model is evaluated with three instruction types: actual-scenario, other feasible, and infeasible. We use 2,311 evaluation examples. Each scenario has a set of feasible and infeasible instructions biased toward the least representative direction. During evaluating these two types, we sample instructions to balance the categorical types used. The details of this sampling are explained in
     <a class="ltx_ref" href="#A4" title="Appendix D Evaluation Sampling ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       D
      </span>
     </a>
     . Evaluation takes 4 hours on a single A100-80GB GPU.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S6.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     6.2
    </span>
    Results &amp; Discussion
   </h3>
   <figure class="ltx_table" id="S6.T2">
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      <span class="ltx_text" id="S6.T2.7.1.1" style="font-size:90%;">
       Table 2
      </span>
      :
     </span>
     <span class="ltx_text" id="S6.T2.8.2" style="font-size:90%;">
      Instruction following recall (IFR) and direction variety scores (DVS) for different models across three different input instruction categories. This table compares the base GameFormer model that takes no instruction as input, the conditional Gameformer that takes a discrete direction category as an input, and iMotion-LLM. The results on iMotion-LLM in this table assume all generated trajectories are valid (i.e. without feasibility classification).
     </span>
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T2.5">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="S6.T2.5.6.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S6.T2.5.6.1.1">
        <span class="ltx_text ltx_font_bold" id="S6.T2.5.6.1.1.1">
         Instruction Type:
        </span>
       </th>
       <th class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S6.T2.5.6.1.2">
        <table class="ltx_tabular ltx_align_middle" id="S6.T2.5.6.1.2.1">
         <tr class="ltx_tr" id="S6.T2.5.6.1.2.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T2.5.6.1.2.1.1.1">
           Actual-scenario
          </td>
         </tr>
         <tr class="ltx_tr" id="S6.T2.5.6.1.2.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T2.5.6.1.2.1.2.1">
           instructions
          </td>
         </tr>
        </table>
        |
       </th>
       <th class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S6.T2.5.6.1.3">
        <table class="ltx_tabular ltx_align_middle" id="S6.T2.5.6.1.3.1">
         <tr class="ltx_tr" id="S6.T2.5.6.1.3.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T2.5.6.1.3.1.1.1">
           Other feasible
          </td>
         </tr>
         <tr class="ltx_tr" id="S6.T2.5.6.1.3.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T2.5.6.1.3.1.2.1">
           instructions
          </td>
         </tr>
        </table>
        |
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S6.T2.5.6.1.4">
        <table class="ltx_tabular ltx_align_middle" id="S6.T2.5.6.1.4.1">
         <tr class="ltx_tr" id="S6.T2.5.6.1.4.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T2.5.6.1.4.1.1.1">
           Infeasible
          </td>
         </tr>
         <tr class="ltx_tr" id="S6.T2.5.6.1.4.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T2.5.6.1.4.1.2.1">
           instructions
          </td>
         </tr>
        </table>
       </th>
      </tr>
      <tr class="ltx_tr" id="S6.T2.4.4">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S6.T2.4.4.5">
        <span class="ltx_text ltx_font_bold" id="S6.T2.4.4.5.1">
         Model
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T2.1.1.1">
        <span class="ltx_text ltx_font_bold" id="S6.T2.1.1.1.1">
         IFR
         <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.1.1.1.1.m1.1">
          <semantics id="S6.T2.1.1.1.1.m1.1a">
           <mo id="S6.T2.1.1.1.1.m1.1.1" stretchy="false" xref="S6.T2.1.1.1.1.m1.1.1.cmml">
            ↑
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T2.1.1.1.1.m1.1b">
            <ci id="S6.T2.1.1.1.1.m1.1.1.cmml" xref="S6.T2.1.1.1.1.m1.1.1">
             ↑
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T2.1.1.1.1.m1.1c">
            \uparrow
           </annotation>
          </semantics>
         </math>
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T2.2.2.2">
        <span class="ltx_text ltx_font_bold" id="S6.T2.2.2.2.1">
         DVS
         <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T2.2.2.2.1.m1.1">
          <semantics id="S6.T2.2.2.2.1.m1.1a">
           <mo id="S6.T2.2.2.2.1.m1.1.1" stretchy="false" xref="S6.T2.2.2.2.1.m1.1.1.cmml">
            ↓
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T2.2.2.2.1.m1.1b">
            <ci id="S6.T2.2.2.2.1.m1.1.1.cmml" xref="S6.T2.2.2.2.1.m1.1.1">
             ↓
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T2.2.2.2.1.m1.1c">
            \downarrow
           </annotation>
          </semantics>
         </math>
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T2.3.3.3">
        <span class="ltx_text ltx_font_bold" id="S6.T2.3.3.3.1">
         IFR
         <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.3.3.3.1.m1.1">
          <semantics id="S6.T2.3.3.3.1.m1.1a">
           <mo id="S6.T2.3.3.3.1.m1.1.1" stretchy="false" xref="S6.T2.3.3.3.1.m1.1.1.cmml">
            ↑
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T2.3.3.3.1.m1.1b">
            <ci id="S6.T2.3.3.3.1.m1.1.1.cmml" xref="S6.T2.3.3.3.1.m1.1.1">
             ↑
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T2.3.3.3.1.m1.1c">
            \uparrow
           </annotation>
          </semantics>
         </math>
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T2.4.4.6">
        <span class="ltx_text ltx_font_bold" id="S6.T2.4.4.6.1">
         DVS
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T2.4.4.4">
        <span class="ltx_text ltx_font_bold" id="S6.T2.4.4.4.1">
         IFR
         <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T2.4.4.4.1.m1.1">
          <semantics id="S6.T2.4.4.4.1.m1.1a">
           <mo id="S6.T2.4.4.4.1.m1.1.1" stretchy="false" xref="S6.T2.4.4.4.1.m1.1.1.cmml">
            ↓
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T2.4.4.4.1.m1.1b">
            <ci id="S6.T2.4.4.4.1.m1.1.1.cmml" xref="S6.T2.4.4.4.1.m1.1.1">
             ↓
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T2.4.4.4.1.m1.1c">
            \downarrow
           </annotation>
          </semantics>
         </math>
        </span>
       </th>
       <th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T2.4.4.7">
        <span class="ltx_text ltx_font_bold" id="S6.T2.4.4.7.1">
         DVS
        </span>
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S6.T2.5.7.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T2.5.7.1.1">
        Baseline (GameFormer)
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.5.7.1.2">
        80.4%
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.5.7.1.3">
        9.1%
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.5.7.1.4">
        –
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.5.7.1.5">
        –
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.5.7.1.6">
        –
       </td>
       <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T2.5.7.1.7">
        –
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T2.5.8.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T2.5.8.2.1">
        Conditional Baseline (C-GameFormer)
       </th>
       <td class="ltx_td ltx_align_center" id="S6.T2.5.8.2.2">
        87.6%
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.5.8.2.3">
        5.0%
       </td>
       <td class="ltx_td ltx_align_center" id="S6.T2.5.8.2.4">
        43.1%
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.5.8.2.5">
        18.1%
       </td>
       <td class="ltx_td ltx_align_center" id="S6.T2.5.8.2.6">
        16.8%
       </td>
       <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T2.5.8.2.7">
        20.5%
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T2.5.5" style="background-color:#D9D9FF;">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S6.T2.5.5.1">
        <span class="ltx_text" id="S6.T2.5.5.1.1" style="background-color:#D9D9FF;">
         iMotion-LLM
         <math alttext="{}_{\text{without classification}}" class="ltx_Math" display="inline" id="S6.T2.5.5.1.1.m1.1" style="background-color:#D9D9FF;">
          <semantics id="S6.T2.5.5.1.1.m1.1a">
           <msub id="S6.T2.5.5.1.1.m1.1.1" xref="S6.T2.5.5.1.1.m1.1.1.cmml">
            <mi id="S6.T2.5.5.1.1.m1.1.1a" xref="S6.T2.5.5.1.1.m1.1.1.cmml">
            </mi>
            <mtext id="S6.T2.5.5.1.1.m1.1.1.1" mathbackground="#D9D9FF" xref="S6.T2.5.5.1.1.m1.1.1.1a.cmml">
             without classification
            </mtext>
           </msub>
           <annotation-xml encoding="MathML-Content" id="S6.T2.5.5.1.1.m1.1b">
            <apply id="S6.T2.5.5.1.1.m1.1.1.cmml" xref="S6.T2.5.5.1.1.m1.1.1">
             <ci id="S6.T2.5.5.1.1.m1.1.1.1a.cmml" xref="S6.T2.5.5.1.1.m1.1.1.1">
              <mtext id="S6.T2.5.5.1.1.m1.1.1.1.cmml" mathbackground="#D9D9FF" mathsize="70%" xref="S6.T2.5.5.1.1.m1.1.1.1">
               without classification
              </mtext>
             </ci>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T2.5.5.1.1.m1.1c">
            {}_{\text{without classification}}
           </annotation>
          </semantics>
         </math>
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.5.5.2">
        <span class="ltx_text" id="S6.T2.5.5.2.1" style="background-color:#D9D9FF;">
         89.6%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T2.5.5.3">
        <span class="ltx_text" id="S6.T2.5.5.3.1" style="background-color:#D9D9FF;">
         2.1%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.5.5.4">
        <span class="ltx_text" id="S6.T2.5.5.4.1" style="background-color:#D9D9FF;">
         37.4%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T2.5.5.5">
        <span class="ltx_text" id="S6.T2.5.5.5.1" style="background-color:#D9D9FF;">
         10.7%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.5.5.6">
        <span class="ltx_text" id="S6.T2.5.5.6.1" style="background-color:#D9D9FF;">
         20.4%
        </span>
       </td>
       <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S6.T2.5.5.7">
        <span class="ltx_text" id="S6.T2.5.5.7.1" style="background-color:#D9D9FF;">
         13.8%
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_para ltx_noindent" id="S6.SS2.p1">
    <p class="ltx_p" id="S6.SS2.p1.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS2.p1.1.1">
      GameFormer.
     </span>
     The baseline model takes no signal as an input other than the scene and historical trajectory features. Yet to compare, we measure the unconditional model’s adherence to the ground truth future direction. The results are shown in Table
     <a class="ltx_ref" href="#S6.T2" title="Table 2 ‣ 6.2 Results &amp; Discussion ‣ 6 Experiments ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     .
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S6.SS2.p2">
    <p class="ltx_p" id="S6.SS2.p2.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS2.p2.1.1">
      Conditional GameFormer.
     </span>
     As we show in Table
     <a class="ltx_ref" href="#S6.T2" title="Table 2 ‣ 6.2 Results &amp; Discussion ‣ 6 Experiments ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     , making GameFormer conditional on a discrete direction unlocks the model capability in following actual-scenario instructions, indicated by the increase of 7.2% in IFR, combined with a drop of 4.1% in DVS, indicating less variety in the prediction directions, thus higher precision instruction following. While also following the feasible instructions to some limit, and significantly less instruction following infeasible instructions.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S6.SS2.p3">
    <p class="ltx_p" id="S6.SS2.p3.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS2.p3.1.1">
      iMotion-LLM without classification.
     </span>
     Even though iMotion-LLM was trained with feasibility classification capability, we show in Table
     <a class="ltx_ref" href="#S6.T2" title="Table 2 ‣ 6.2 Results &amp; Discussion ‣ 6 Experiments ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     how the model performs, assuming all generated trajectories are valid. With this setup, iMotion-LLM can improve the actual-scenario instruction with higher precision, indicated by an increase of 2% in IFR and a drop of 2.9% in DVS. But it doesn’t show improvement for the other than the actual-scenario instruction.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S6.SS2.p4">
    <p class="ltx_p" id="S6.SS2.p4.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS2.p4.1.1">
      iMotion-LLM with feasibility detection.
     </span>
     Given the iMotion-LLM capability in detecting whether an instruction should be accepted or rejected, Table
     <a class="ltx_ref" href="#S6.T3" title="Table 3 ‣ 6.2 Results &amp; Discussion ‣ 6 Experiments ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     shows that iMotion-LLM accepts actual-scenario instructions with a rate of 95.1%, which matches with the ensured feasibility of these instructions. Even though there is a drop in IFR due to false negatives, the actual-scenario performance is combined with a rate of 85.5% of detecting true negatives. Rejecting infeasible instructions reduces the IFR for infeasible instructions marginally from 20.4% to 6.6%.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S6.SS2.p5">
    <p class="ltx_p" id="S6.SS2.p5.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS2.p5.1.1">
      Insignificance of other feasible instructions following.
     </span>
     For other feasible instructions besides the actual-scenario instruction, as shown in Table
     <a class="ltx_ref" href="#S6.T3" title="Table 3 ‣ 6.2 Results &amp; Discussion ‣ 6 Experiments ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     both the conditional GameFormer and iMotion-LLM exhibit lower IFR and higher DVS compared to the actual-scenario case. Intuitively, this behavior correlates with infeasibility of instructions rather than feasibility. Even though iMotion-LLM detects the feasibility of actual-scenario and infeasible instructions with a high rate, it does not detect other feasible instructions’ true positives with such significance.
We attribute this to two factors. First, driving behaviors for other feasible instructions may diverge from real scenarios, making the task more complex and requiring better generalizability. Second, as shown in Figure
     <a class="ltx_ref" href="#S6.F5" title="Figure 5 ‣ 6.2 Results &amp; Discussion ‣ 6 Experiments ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     , feasible directions might not always align with safety, laws, or convenience. Interestingly, iMotion-LLM rejects this instruction. Figure
     <a class="ltx_ref" href="#S6.F6" title="Figure 6 ‣ 6.2 Results &amp; Discussion ‣ 6 Experiments ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     shows a successful case of accepting feasible instructions and rejecting infeasible instructions; stationary was labeled as infeasible due to the vehicle’s current velocity. We show additional results in appendix
     <a class="ltx_ref" href="#A3" title="Appendix C Additional Qualitative Results ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       C
      </span>
     </a>
     .
    </p>
   </div>
   <figure class="ltx_table" id="S6.T3">
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      <span class="ltx_text" id="S6.T3.14.2.1" style="font-size:90%;">
       Table 3
      </span>
      :
     </span>
     <span class="ltx_text" id="S6.T3.2.1" style="font-size:90%;">
      Accuracy and effect on instruction following metrics of iMotion-LLM when considering direction feasibility detection. iMotion-LLM
      <math alttext="{}_{\text{without classification}}" class="ltx_Math" display="inline" id="S6.T3.2.1.m1.1">
       <semantics id="S6.T3.2.1.m1.1b">
        <msub id="S6.T3.2.1.m1.1.1" xref="S6.T3.2.1.m1.1.1.cmml">
         <mi id="S6.T3.2.1.m1.1.1b" xref="S6.T3.2.1.m1.1.1.cmml">
         </mi>
         <mtext id="S6.T3.2.1.m1.1.1.1" xref="S6.T3.2.1.m1.1.1.1a.cmml">
          without classification
         </mtext>
        </msub>
        <annotation-xml encoding="MathML-Content" id="S6.T3.2.1.m1.1c">
         <apply id="S6.T3.2.1.m1.1.1.cmml" xref="S6.T3.2.1.m1.1.1">
          <ci id="S6.T3.2.1.m1.1.1.1a.cmml" xref="S6.T3.2.1.m1.1.1.1">
           <mtext id="S6.T3.2.1.m1.1.1.1.cmml" mathsize="70%" xref="S6.T3.2.1.m1.1.1.1">
            without classification
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S6.T3.2.1.m1.1d">
         {}_{\text{without classification}}
        </annotation>
       </semantics>
      </math>
      refers to the exact same model without using feasibility detection and blindly evaluating all its generated trajectory modalities. iMotion-LLM does not accumulate rejected instructions in the metric calculations, reflecting no instruction following.
     </span>
    </figcaption>
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T3.12" style="width:433.6pt;height:92.8pt;vertical-align:-0.0pt;">
     <span class="ltx_transformed_inner" style="transform:translate(-48.3pt,10.3pt) scale(0.817913924777829,0.817913924777829) ;">
      <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T3.12.10">
       <thead class="ltx_thead">
        <tr class="ltx_tr" id="S6.T3.12.10.11.1">
         <th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S6.T3.12.10.11.1.1">
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S6.T3.12.10.11.1.2">
          <table class="ltx_tabular ltx_align_middle" id="S6.T3.12.10.11.1.2.1">
           <tr class="ltx_tr" id="S6.T3.12.10.11.1.2.1.1">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T3.12.10.11.1.2.1.1.1">
             Actual-scenario
            </td>
           </tr>
           <tr class="ltx_tr" id="S6.T3.12.10.11.1.2.1.2">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T3.12.10.11.1.2.1.2.1">
             instructions
            </td>
           </tr>
          </table>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S6.T3.12.10.11.1.3">
          <table class="ltx_tabular ltx_align_middle" id="S6.T3.12.10.11.1.3.1">
           <tr class="ltx_tr" id="S6.T3.12.10.11.1.3.1.1">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T3.12.10.11.1.3.1.1.1">
             Other feasible
            </td>
           </tr>
           <tr class="ltx_tr" id="S6.T3.12.10.11.1.3.1.2">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T3.12.10.11.1.3.1.2.1">
             instructions
            </td>
           </tr>
          </table>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S6.T3.12.10.11.1.4">
          Infeasible instructions
         </th>
        </tr>
        <tr class="ltx_tr" id="S6.T3.11.9.9">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S6.T3.11.9.9.10">
          <span class="ltx_text ltx_font_bold" id="S6.T3.11.9.9.10.1">
           Model
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S6.T3.3.1.1.1">
          <span class="ltx_text ltx_font_bold" id="S6.T3.3.1.1.1.1">
           Acc.
           <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T3.3.1.1.1.1.m1.1">
            <semantics id="S6.T3.3.1.1.1.1.m1.1a">
             <mo id="S6.T3.3.1.1.1.1.m1.1.1" stretchy="false" xref="S6.T3.3.1.1.1.1.m1.1.1.cmml">
              ↑
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T3.3.1.1.1.1.m1.1b">
              <ci id="S6.T3.3.1.1.1.1.m1.1.1.cmml" xref="S6.T3.3.1.1.1.1.m1.1.1">
               ↑
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T3.3.1.1.1.1.m1.1c">
              \uparrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S6.T3.4.2.2.2">
          <span class="ltx_text ltx_font_bold" id="S6.T3.4.2.2.2.1">
           IFR
           <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T3.4.2.2.2.1.m1.1">
            <semantics id="S6.T3.4.2.2.2.1.m1.1a">
             <mo id="S6.T3.4.2.2.2.1.m1.1.1" stretchy="false" xref="S6.T3.4.2.2.2.1.m1.1.1.cmml">
              ↑
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T3.4.2.2.2.1.m1.1b">
              <ci id="S6.T3.4.2.2.2.1.m1.1.1.cmml" xref="S6.T3.4.2.2.2.1.m1.1.1">
               ↑
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T3.4.2.2.2.1.m1.1c">
              \uparrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S6.T3.5.3.3.3">
          <span class="ltx_text ltx_font_bold" id="S6.T3.5.3.3.3.1">
           DVS
           <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T3.5.3.3.3.1.m1.1">
            <semantics id="S6.T3.5.3.3.3.1.m1.1a">
             <mo id="S6.T3.5.3.3.3.1.m1.1.1" stretchy="false" xref="S6.T3.5.3.3.3.1.m1.1.1.cmml">
              ↓
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T3.5.3.3.3.1.m1.1b">
              <ci id="S6.T3.5.3.3.3.1.m1.1.1.cmml" xref="S6.T3.5.3.3.3.1.m1.1.1">
               ↓
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T3.5.3.3.3.1.m1.1c">
              \downarrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S6.T3.6.4.4.4">
          <span class="ltx_text ltx_font_bold" id="S6.T3.6.4.4.4.1">
           Acc.
           <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T3.6.4.4.4.1.m1.1">
            <semantics id="S6.T3.6.4.4.4.1.m1.1a">
             <mo id="S6.T3.6.4.4.4.1.m1.1.1" stretchy="false" xref="S6.T3.6.4.4.4.1.m1.1.1.cmml">
              ↑
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T3.6.4.4.4.1.m1.1b">
              <ci id="S6.T3.6.4.4.4.1.m1.1.1.cmml" xref="S6.T3.6.4.4.4.1.m1.1.1">
               ↑
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T3.6.4.4.4.1.m1.1c">
              \uparrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S6.T3.7.5.5.5">
          <span class="ltx_text ltx_font_bold" id="S6.T3.7.5.5.5.1">
           IFR
           <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T3.7.5.5.5.1.m1.1">
            <semantics id="S6.T3.7.5.5.5.1.m1.1a">
             <mo id="S6.T3.7.5.5.5.1.m1.1.1" stretchy="false" xref="S6.T3.7.5.5.5.1.m1.1.1.cmml">
              ↑
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T3.7.5.5.5.1.m1.1b">
              <ci id="S6.T3.7.5.5.5.1.m1.1.1.cmml" xref="S6.T3.7.5.5.5.1.m1.1.1">
               ↑
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T3.7.5.5.5.1.m1.1c">
              \uparrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S6.T3.8.6.6.6">
          <span class="ltx_text ltx_font_bold" id="S6.T3.8.6.6.6.1">
           DVS
           <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T3.8.6.6.6.1.m1.1">
            <semantics id="S6.T3.8.6.6.6.1.m1.1a">
             <mo id="S6.T3.8.6.6.6.1.m1.1.1" stretchy="false" xref="S6.T3.8.6.6.6.1.m1.1.1.cmml">
              ↓
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T3.8.6.6.6.1.m1.1b">
              <ci id="S6.T3.8.6.6.6.1.m1.1.1.cmml" xref="S6.T3.8.6.6.6.1.m1.1.1">
               ↓
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T3.8.6.6.6.1.m1.1c">
              \downarrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S6.T3.9.7.7.7">
          <span class="ltx_text ltx_font_bold" id="S6.T3.9.7.7.7.1">
           Acc.
           <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T3.9.7.7.7.1.m1.1">
            <semantics id="S6.T3.9.7.7.7.1.m1.1a">
             <mo id="S6.T3.9.7.7.7.1.m1.1.1" stretchy="false" xref="S6.T3.9.7.7.7.1.m1.1.1.cmml">
              ↑
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T3.9.7.7.7.1.m1.1b">
              <ci id="S6.T3.9.7.7.7.1.m1.1.1.cmml" xref="S6.T3.9.7.7.7.1.m1.1.1">
               ↑
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T3.9.7.7.7.1.m1.1c">
              \uparrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S6.T3.10.8.8.8">
          <span class="ltx_text ltx_font_bold" id="S6.T3.10.8.8.8.1">
           IFR
           <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T3.10.8.8.8.1.m1.1">
            <semantics id="S6.T3.10.8.8.8.1.m1.1a">
             <mo id="S6.T3.10.8.8.8.1.m1.1.1" stretchy="false" xref="S6.T3.10.8.8.8.1.m1.1.1.cmml">
              ↓
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T3.10.8.8.8.1.m1.1b">
              <ci id="S6.T3.10.8.8.8.1.m1.1.1.cmml" xref="S6.T3.10.8.8.8.1.m1.1.1">
               ↓
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T3.10.8.8.8.1.m1.1c">
              \downarrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S6.T3.11.9.9.9">
          <span class="ltx_text ltx_font_bold" id="S6.T3.11.9.9.9.1">
           DVS
           <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T3.11.9.9.9.1.m1.1">
            <semantics id="S6.T3.11.9.9.9.1.m1.1a">
             <mo id="S6.T3.11.9.9.9.1.m1.1.1" stretchy="false" xref="S6.T3.11.9.9.9.1.m1.1.1.cmml">
              ↑
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T3.11.9.9.9.1.m1.1b">
              <ci id="S6.T3.11.9.9.9.1.m1.1.1.cmml" xref="S6.T3.11.9.9.9.1.m1.1.1">
               ↑
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T3.11.9.9.9.1.m1.1c">
              \uparrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
        </tr>
       </thead>
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="S6.T3.12.10.12.1">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T3.12.10.12.1.1">
          Conditional Baseline (C-GameFormer)
         </th>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.12.10.12.1.2">
          –
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.12.10.12.1.3">
          87.6%
         </td>
         <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.12.10.12.1.4">
          5.0%
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.12.10.12.1.5">
          –
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.12.10.12.1.6">
          43.1%
         </td>
         <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.12.10.12.1.7">
          18.1%
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.12.10.12.1.8">
          –
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.12.10.12.1.9">
          16.8%
         </td>
         <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T3.12.10.12.1.10">
          20.5%
         </td>
        </tr>
        <tr class="ltx_tr" id="S6.T3.12.10.10">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T3.12.10.10.1">
          iMotion-LLM
          <math alttext="{}_{\text{without classification}}" class="ltx_Math" display="inline" id="S6.T3.12.10.10.1.m1.1">
           <semantics id="S6.T3.12.10.10.1.m1.1a">
            <msub id="S6.T3.12.10.10.1.m1.1.1" xref="S6.T3.12.10.10.1.m1.1.1.cmml">
             <mi id="S6.T3.12.10.10.1.m1.1.1a" xref="S6.T3.12.10.10.1.m1.1.1.cmml">
             </mi>
             <mtext id="S6.T3.12.10.10.1.m1.1.1.1" xref="S6.T3.12.10.10.1.m1.1.1.1a.cmml">
              without classification
             </mtext>
            </msub>
            <annotation-xml encoding="MathML-Content" id="S6.T3.12.10.10.1.m1.1b">
             <apply id="S6.T3.12.10.10.1.m1.1.1.cmml" xref="S6.T3.12.10.10.1.m1.1.1">
              <ci id="S6.T3.12.10.10.1.m1.1.1.1a.cmml" xref="S6.T3.12.10.10.1.m1.1.1.1">
               <mtext id="S6.T3.12.10.10.1.m1.1.1.1.cmml" mathsize="70%" xref="S6.T3.12.10.10.1.m1.1.1.1">
                without classification
               </mtext>
              </ci>
             </apply>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S6.T3.12.10.10.1.m1.1c">
             {}_{\text{without classification}}
            </annotation>
           </semantics>
          </math>
         </th>
         <td class="ltx_td ltx_align_center" id="S6.T3.12.10.10.2">
          –
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T3.12.10.10.3">
          89.6%
         </td>
         <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.12.10.10.4">
          2.1%
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T3.12.10.10.5">
          –
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T3.12.10.10.6">
          37.4%
         </td>
         <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.12.10.10.7">
          10.7%
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T3.12.10.10.8">
          –
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T3.12.10.10.9">
          20.4%
         </td>
         <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T3.12.10.10.10">
          13.8%
         </td>
        </tr>
        <tr class="ltx_tr" id="S6.T3.12.10.13.2" style="background-color:#D9D9FF;">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S6.T3.12.10.13.2.1">
          <span class="ltx_text" id="S6.T3.12.10.13.2.1.1" style="background-color:#D9D9FF;">
           iMotion-LLM
          </span>
         </th>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.12.10.13.2.2">
          <span class="ltx_text" id="S6.T3.12.10.13.2.2.1" style="background-color:#D9D9FF;">
           95.1%
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.12.10.13.2.3">
          <span class="ltx_text" id="S6.T3.12.10.13.2.3.1" style="background-color:#D9D9FF;">
           86.2%
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T3.12.10.13.2.4">
          <span class="ltx_text" id="S6.T3.12.10.13.2.4.1" style="background-color:#D9D9FF;">
           1.9%
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.12.10.13.2.5">
          <span class="ltx_text" id="S6.T3.12.10.13.2.5.1" style="background-color:#D9D9FF;">
           41.2%
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.12.10.13.2.6">
          <span class="ltx_text" id="S6.T3.12.10.13.2.6.1" style="background-color:#D9D9FF;">
           21.7
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T3.12.10.13.2.7">
          <span class="ltx_text" id="S6.T3.12.10.13.2.7.1" style="background-color:#D9D9FF;">
           6.8%
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.12.10.13.2.8">
          <span class="ltx_text" id="S6.T3.12.10.13.2.8.1" style="background-color:#D9D9FF;">
           85.8%
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.12.10.13.2.9">
          <span class="ltx_text" id="S6.T3.12.10.13.2.9.1" style="background-color:#D9D9FF;">
           6.6%
          </span>
         </td>
         <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S6.T3.12.10.13.2.10">
          <span class="ltx_text" id="S6.T3.12.10.13.2.10.1" style="background-color:#D9D9FF;">
           8.1%
          </span>
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
   </figure>
   <figure class="ltx_table" id="S6.T4">
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      <span class="ltx_text" id="S6.T4.7.1.1" style="font-size:90%;">
       Table 4
      </span>
      :
     </span>
     <span class="ltx_text" id="S6.T4.8.2" style="font-size:90%;">
      Instruction following and displacement error when considering a more detailed instruction of two-step direction and speed in addition to the final direction instruction.
     </span>
    </figcaption>
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T4.5" style="width:433.6pt;height:127.5pt;vertical-align:-0.8pt;">
     <span class="ltx_transformed_inner" style="transform:translate(-48.2pt,14.1pt) scale(0.818171050394225,0.818171050394225) ;">
      <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T4.5.5">
       <thead class="ltx_thead">
        <tr class="ltx_tr" id="S6.T4.5.5.6.1">
         <th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S6.T4.5.5.6.1.1">
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S6.T4.5.5.6.1.2">
          <span class="ltx_text ltx_font_bold" id="S6.T4.5.5.6.1.2.1">
           Instruction Type:
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S6.T4.5.5.6.1.3">
          <table class="ltx_tabular ltx_align_middle" id="S6.T4.5.5.6.1.3.1">
           <tr class="ltx_tr" id="S6.T4.5.5.6.1.3.1.1">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.5.5.6.1.3.1.1.1">
             Actual-scenario
            </td>
           </tr>
           <tr class="ltx_tr" id="S6.T4.5.5.6.1.3.1.2">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.5.5.6.1.3.1.2.1">
             instructions
            </td>
           </tr>
          </table>
         </th>
        </tr>
        <tr class="ltx_tr" id="S6.T4.4.4.4">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S6.T4.4.4.4.5">
          <span class="ltx_text ltx_font_bold" id="S6.T4.4.4.4.5.1">
           Model
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S6.T4.4.4.4.6">
          <span class="ltx_text ltx_font_bold" id="S6.T4.4.4.4.6.1">
           Instruction
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T4.1.1.1.1">
          <span class="ltx_text ltx_font_bold" id="S6.T4.1.1.1.1.1">
           IFR
           <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T4.1.1.1.1.1.m1.1">
            <semantics id="S6.T4.1.1.1.1.1.m1.1a">
             <mo id="S6.T4.1.1.1.1.1.m1.1.1" stretchy="false" xref="S6.T4.1.1.1.1.1.m1.1.1.cmml">
              ↑
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T4.1.1.1.1.1.m1.1b">
              <ci id="S6.T4.1.1.1.1.1.m1.1.1.cmml" xref="S6.T4.1.1.1.1.1.m1.1.1">
               ↑
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T4.1.1.1.1.1.m1.1c">
              \uparrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T4.2.2.2.2">
          <span class="ltx_text ltx_font_bold" id="S6.T4.2.2.2.2.1">
           DVS
           <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T4.2.2.2.2.1.m1.1">
            <semantics id="S6.T4.2.2.2.2.1.m1.1a">
             <mo id="S6.T4.2.2.2.2.1.m1.1.1" stretchy="false" xref="S6.T4.2.2.2.2.1.m1.1.1.cmml">
              ↓
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T4.2.2.2.2.1.m1.1b">
              <ci id="S6.T4.2.2.2.2.1.m1.1.1.cmml" xref="S6.T4.2.2.2.2.1.m1.1.1">
               ↓
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T4.2.2.2.2.1.m1.1c">
              \downarrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T4.3.3.3.3">
          <table class="ltx_tabular ltx_align_middle" id="S6.T4.3.3.3.3.2">
           <tr class="ltx_tr" id="S6.T4.3.3.3.3.2.1">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.3.3.3.3.2.1.1">
             <span class="ltx_text ltx_font_bold" id="S6.T4.3.3.3.3.2.1.1.1">
              Vehicles
             </span>
            </td>
           </tr>
           <tr class="ltx_tr" id="S6.T4.3.3.3.3.2.2">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.3.3.3.3.2.2.1">
             <span class="ltx_text ltx_font_bold" id="S6.T4.3.3.3.3.2.2.1.1">
              minADE
             </span>
            </td>
           </tr>
          </table>
          <span class="ltx_text ltx_font_bold" id="S6.T4.3.3.3.3.1">
           <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T4.3.3.3.3.1.m1.1">
            <semantics id="S6.T4.3.3.3.3.1.m1.1a">
             <mo id="S6.T4.3.3.3.3.1.m1.1.1" stretchy="false" xref="S6.T4.3.3.3.3.1.m1.1.1.cmml">
              ↓
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T4.3.3.3.3.1.m1.1b">
              <ci id="S6.T4.3.3.3.3.1.m1.1.1.cmml" xref="S6.T4.3.3.3.3.1.m1.1.1">
               ↓
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T4.3.3.3.3.1.m1.1c">
              \downarrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T4.4.4.4.4">
          <table class="ltx_tabular ltx_align_middle" id="S6.T4.4.4.4.4.2">
           <tr class="ltx_tr" id="S6.T4.4.4.4.4.2.1">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.4.4.4.4.2.1.1">
             <span class="ltx_text ltx_font_bold" id="S6.T4.4.4.4.4.2.1.1.1">
              Vehicles
             </span>
            </td>
           </tr>
           <tr class="ltx_tr" id="S6.T4.4.4.4.4.2.2">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.4.4.4.4.2.2.1">
             <span class="ltx_text ltx_font_bold" id="S6.T4.4.4.4.4.2.2.1.1">
              minFDE
             </span>
            </td>
           </tr>
          </table>
          <span class="ltx_text ltx_font_bold" id="S6.T4.4.4.4.4.1">
           <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T4.4.4.4.4.1.m1.1">
            <semantics id="S6.T4.4.4.4.4.1.m1.1a">
             <mo id="S6.T4.4.4.4.4.1.m1.1.1" stretchy="false" xref="S6.T4.4.4.4.4.1.m1.1.1.cmml">
              ↓
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T4.4.4.4.4.1.m1.1b">
              <ci id="S6.T4.4.4.4.4.1.m1.1.1.cmml" xref="S6.T4.4.4.4.4.1.m1.1.1">
               ↓
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T4.4.4.4.4.1.m1.1c">
              \downarrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
        </tr>
       </thead>
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="S6.T4.5.5.7.1">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T4.5.5.7.1.1">
          Baseline (GameFormer)
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T4.5.5.7.1.2">
          None
         </th>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.5.5.7.1.3">
          80.4%
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.5.5.7.1.4">
          9.1%
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.5.5.7.1.5">
          1.18
         </td>
         <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T4.5.5.7.1.6">
          2.44
         </td>
        </tr>
        <tr class="ltx_tr" id="S6.T4.5.5.8.2">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T4.5.5.8.2.1">
          Conditional Baseline (C-GameFormer)
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T4.5.5.8.2.2">
          Final direction
         </th>
         <td class="ltx_td ltx_align_center" id="S6.T4.5.5.8.2.3">
          87.6%
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T4.5.5.8.2.4">
          5.0%
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T4.5.5.8.2.5">
          1.09
         </td>
         <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.5.5.8.2.6">
          2.22%
         </td>
        </tr>
        <tr class="ltx_tr" id="S6.T4.5.5.5">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T4.5.5.5.1">
          iMotion-LLM
          <math alttext="{}_{\text{without classification}}" class="ltx_Math" display="inline" id="S6.T4.5.5.5.1.m1.1">
           <semantics id="S6.T4.5.5.5.1.m1.1a">
            <msub id="S6.T4.5.5.5.1.m1.1.1" xref="S6.T4.5.5.5.1.m1.1.1.cmml">
             <mi id="S6.T4.5.5.5.1.m1.1.1a" xref="S6.T4.5.5.5.1.m1.1.1.cmml">
             </mi>
             <mtext id="S6.T4.5.5.5.1.m1.1.1.1" xref="S6.T4.5.5.5.1.m1.1.1.1a.cmml">
              without classification
             </mtext>
            </msub>
            <annotation-xml encoding="MathML-Content" id="S6.T4.5.5.5.1.m1.1b">
             <apply id="S6.T4.5.5.5.1.m1.1.1.cmml" xref="S6.T4.5.5.5.1.m1.1.1">
              <ci id="S6.T4.5.5.5.1.m1.1.1.1a.cmml" xref="S6.T4.5.5.5.1.m1.1.1.1">
               <mtext id="S6.T4.5.5.5.1.m1.1.1.1.cmml" mathsize="70%" xref="S6.T4.5.5.5.1.m1.1.1.1">
                without classification
               </mtext>
              </ci>
             </apply>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S6.T4.5.5.5.1.m1.1c">
             {}_{\text{without classification}}
            </annotation>
           </semantics>
          </math>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T4.5.5.5.2">
          Final direction
         </th>
         <td class="ltx_td ltx_align_center" id="S6.T4.5.5.5.3">
          89.6%
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T4.5.5.5.4">
          2.1%
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T4.5.5.5.5">
          1.49
         </td>
         <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.5.5.5.6">
          3.33
         </td>
        </tr>
        <tr class="ltx_tr" id="S6.T4.5.5.9.3" style="background-color:#D9D9FF;">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S6.T4.5.5.9.3.1">
          <span class="ltx_text" id="S6.T4.5.5.9.3.1.1" style="background-color:#D9D9FF;">
           iMotion-LLM
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S6.T4.5.5.9.3.2">
          <span class="ltx_text" id="S6.T4.5.5.9.3.2.1" style="background-color:#D9D9FF;">
           + Two-step direction &amp; speed
          </span>
         </th>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.5.5.9.3.3">
          <span class="ltx_text" id="S6.T4.5.5.9.3.3.1" style="background-color:#D9D9FF;">
           87.5%
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.5.5.9.3.4">
          <span class="ltx_text" id="S6.T4.5.5.9.3.4.1" style="background-color:#D9D9FF;">
           2.2%
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.5.5.9.3.5">
          <span class="ltx_text ltx_font_bold" id="S6.T4.5.5.9.3.5.1" style="background-color:#D9D9FF;">
           1.23
          </span>
         </td>
         <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S6.T4.5.5.9.3.6">
          <span class="ltx_text ltx_font_bold" id="S6.T4.5.5.9.3.6.1" style="background-color:#D9D9FF;">
           2.49
          </span>
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
   </figure>
   <div class="ltx_para ltx_noindent" id="S6.SS2.p6">
    <p class="ltx_p" id="S6.SS2.p6.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS2.p6.1.1">
      Vehicle minADE and minFDE.
     </span>
     Even though this work focuses on a new task, Table
     <a class="ltx_ref" href="#S6.T5" title="Table 5 ‣ 6.2 Results &amp; Discussion ‣ 6 Experiments ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     shows how our model does not diverge significantly from the baseline, and it still inherits the capabilities of the conditional baseline of generating trajectories that diverge from the ground truth future, when other than the ground truth future actual-scenario instruction is used, indicated by the higher displacement errors, where the displacement errors are always calculated with the ground truth actual-scenario future trajectory as a reference.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S6.SS2.p7">
    <p class="ltx_p" id="S6.SS2.p7.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS2.p7.1.1">
      Longer detailed instruction.
     </span>
     in Table
     <a class="ltx_ref" href="#S6.T4" title="Table 4 ‣ 6.2 Results &amp; Discussion ‣ 6 Experiments ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     we show how a longer instruction setting shows that the LLM integration with GameFormer in iMotion-LLM can approach closer values of displacement errors to the base GameFormer. A longer instruction considers two-step direction and speed descriptions of the first and second half of the future (from the latest observed step to 4 seconds in the future and from the 4th second to 8 seconds in the future) in addition to the final direction. For example, "Turn right by first moving straight with a moderate speed, then turn right with a slow speed.".
    </p>
   </div>
   <figure class="ltx_table" id="S6.T5">
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      <span class="ltx_text" id="S6.T5.9.1.1" style="font-size:90%;">
       Table 5
      </span>
      :
     </span>
     <span class="ltx_text" id="S6.T5.10.2" style="font-size:90%;">
      The minADE and minFDE for vehicle agents for all models.
     </span>
    </figcaption>
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T5.7" style="width:433.6pt;height:101.4pt;vertical-align:-0.0pt;">
     <span class="ltx_transformed_inner" style="transform:translate(-64.1pt,15.0pt) scale(0.771812430512296,0.771812430512296) ;">
      <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T5.7.7">
       <thead class="ltx_thead">
        <tr class="ltx_tr" id="S6.T5.7.7.8.1">
         <th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S6.T5.7.7.8.1.1">
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S6.T5.7.7.8.1.2">
          Actual-scenario instructions
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S6.T5.7.7.8.1.3">
          Other feasible instructions
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S6.T5.7.7.8.1.4">
          Infeasible instructions
         </th>
        </tr>
        <tr class="ltx_tr" id="S6.T5.6.6.6">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S6.T5.6.6.6.7">
          <span class="ltx_text ltx_font_bold" id="S6.T5.6.6.6.7.1">
           Model
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S6.T5.1.1.1.1">
          <table class="ltx_tabular ltx_align_middle" id="S6.T5.1.1.1.1.2">
           <tr class="ltx_tr" id="S6.T5.1.1.1.1.2.1">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.1.1.1.1.2.1.1">
             <span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.1.2.1.1.1">
              Vehicles
             </span>
            </td>
           </tr>
           <tr class="ltx_tr" id="S6.T5.1.1.1.1.2.2">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.1.1.1.1.2.2.1">
             <span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.1.2.2.1.1">
              minADE
             </span>
            </td>
           </tr>
          </table>
          <span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.1.1">
           <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T5.1.1.1.1.1.m1.1">
            <semantics id="S6.T5.1.1.1.1.1.m1.1a">
             <mo id="S6.T5.1.1.1.1.1.m1.1.1" stretchy="false" xref="S6.T5.1.1.1.1.1.m1.1.1.cmml">
              ↓
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T5.1.1.1.1.1.m1.1b">
              <ci id="S6.T5.1.1.1.1.1.m1.1.1.cmml" xref="S6.T5.1.1.1.1.1.m1.1.1">
               ↓
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T5.1.1.1.1.1.m1.1c">
              \downarrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S6.T5.2.2.2.2">
          <table class="ltx_tabular ltx_align_middle" id="S6.T5.2.2.2.2.2">
           <tr class="ltx_tr" id="S6.T5.2.2.2.2.2.1">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.2.2.2.2.2.1.1">
             <span class="ltx_text ltx_font_bold" id="S6.T5.2.2.2.2.2.1.1.1">
              Vehicles
             </span>
            </td>
           </tr>
           <tr class="ltx_tr" id="S6.T5.2.2.2.2.2.2">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.2.2.2.2.2.2.1">
             <span class="ltx_text ltx_font_bold" id="S6.T5.2.2.2.2.2.2.1.1">
              minFDE
             </span>
            </td>
           </tr>
          </table>
          <span class="ltx_text ltx_font_bold" id="S6.T5.2.2.2.2.1">
           <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T5.2.2.2.2.1.m1.1">
            <semantics id="S6.T5.2.2.2.2.1.m1.1a">
             <mo id="S6.T5.2.2.2.2.1.m1.1.1" stretchy="false" xref="S6.T5.2.2.2.2.1.m1.1.1.cmml">
              ↓
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T5.2.2.2.2.1.m1.1b">
              <ci id="S6.T5.2.2.2.2.1.m1.1.1.cmml" xref="S6.T5.2.2.2.2.1.m1.1.1">
               ↓
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T5.2.2.2.2.1.m1.1c">
              \downarrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S6.T5.3.3.3.3">
          <table class="ltx_tabular ltx_align_middle" id="S6.T5.3.3.3.3.2">
           <tr class="ltx_tr" id="S6.T5.3.3.3.3.2.1">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.3.3.3.3.2.1.1">
             <span class="ltx_text ltx_font_bold" id="S6.T5.3.3.3.3.2.1.1.1">
              Vehicles
             </span>
            </td>
           </tr>
           <tr class="ltx_tr" id="S6.T5.3.3.3.3.2.2">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.3.3.3.3.2.2.1">
             <span class="ltx_text ltx_font_bold" id="S6.T5.3.3.3.3.2.2.1.1">
              minADE
             </span>
            </td>
           </tr>
          </table>
          <span class="ltx_text ltx_font_bold" id="S6.T5.3.3.3.3.1">
           <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T5.3.3.3.3.1.m1.1">
            <semantics id="S6.T5.3.3.3.3.1.m1.1a">
             <mo id="S6.T5.3.3.3.3.1.m1.1.1" stretchy="false" xref="S6.T5.3.3.3.3.1.m1.1.1.cmml">
              ↓
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T5.3.3.3.3.1.m1.1b">
              <ci id="S6.T5.3.3.3.3.1.m1.1.1.cmml" xref="S6.T5.3.3.3.3.1.m1.1.1">
               ↓
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T5.3.3.3.3.1.m1.1c">
              \downarrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S6.T5.4.4.4.4">
          <table class="ltx_tabular ltx_align_middle" id="S6.T5.4.4.4.4.2">
           <tr class="ltx_tr" id="S6.T5.4.4.4.4.2.1">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.4.4.4.4.2.1.1">
             <span class="ltx_text ltx_font_bold" id="S6.T5.4.4.4.4.2.1.1.1">
              Vehicles
             </span>
            </td>
           </tr>
           <tr class="ltx_tr" id="S6.T5.4.4.4.4.2.2">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.4.4.4.4.2.2.1">
             <span class="ltx_text ltx_font_bold" id="S6.T5.4.4.4.4.2.2.1.1">
              minFDE
             </span>
            </td>
           </tr>
          </table>
          <span class="ltx_text ltx_font_bold" id="S6.T5.4.4.4.4.1">
           <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T5.4.4.4.4.1.m1.1">
            <semantics id="S6.T5.4.4.4.4.1.m1.1a">
             <mo id="S6.T5.4.4.4.4.1.m1.1.1" stretchy="false" xref="S6.T5.4.4.4.4.1.m1.1.1.cmml">
              ↓
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T5.4.4.4.4.1.m1.1b">
              <ci id="S6.T5.4.4.4.4.1.m1.1.1.cmml" xref="S6.T5.4.4.4.4.1.m1.1.1">
               ↓
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T5.4.4.4.4.1.m1.1c">
              \downarrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S6.T5.5.5.5.5">
          <table class="ltx_tabular ltx_align_middle" id="S6.T5.5.5.5.5.2">
           <tr class="ltx_tr" id="S6.T5.5.5.5.5.2.1">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.5.5.5.5.2.1.1">
             <span class="ltx_text ltx_font_bold" id="S6.T5.5.5.5.5.2.1.1.1">
              Vehicles
             </span>
            </td>
           </tr>
           <tr class="ltx_tr" id="S6.T5.5.5.5.5.2.2">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.5.5.5.5.2.2.1">
             <span class="ltx_text ltx_font_bold" id="S6.T5.5.5.5.5.2.2.1.1">
              minADE
             </span>
            </td>
           </tr>
          </table>
          <span class="ltx_text ltx_font_bold" id="S6.T5.5.5.5.5.1">
           <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T5.5.5.5.5.1.m1.1">
            <semantics id="S6.T5.5.5.5.5.1.m1.1a">
             <mo id="S6.T5.5.5.5.5.1.m1.1.1" stretchy="false" xref="S6.T5.5.5.5.5.1.m1.1.1.cmml">
              ↓
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T5.5.5.5.5.1.m1.1b">
              <ci id="S6.T5.5.5.5.5.1.m1.1.1.cmml" xref="S6.T5.5.5.5.5.1.m1.1.1">
               ↓
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T5.5.5.5.5.1.m1.1c">
              \downarrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
         <th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S6.T5.6.6.6.6">
          <table class="ltx_tabular ltx_align_middle" id="S6.T5.6.6.6.6.2">
           <tr class="ltx_tr" id="S6.T5.6.6.6.6.2.1">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.6.6.6.6.2.1.1">
             <span class="ltx_text ltx_font_bold" id="S6.T5.6.6.6.6.2.1.1.1">
              Vehicles
             </span>
            </td>
           </tr>
           <tr class="ltx_tr" id="S6.T5.6.6.6.6.2.2">
            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.6.6.6.6.2.2.1">
             <span class="ltx_text ltx_font_bold" id="S6.T5.6.6.6.6.2.2.1.1">
              minFDE
             </span>
            </td>
           </tr>
          </table>
          <span class="ltx_text ltx_font_bold" id="S6.T5.6.6.6.6.1">
           <math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T5.6.6.6.6.1.m1.1">
            <semantics id="S6.T5.6.6.6.6.1.m1.1a">
             <mo id="S6.T5.6.6.6.6.1.m1.1.1" stretchy="false" xref="S6.T5.6.6.6.6.1.m1.1.1.cmml">
              ↓
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.T5.6.6.6.6.1.m1.1b">
              <ci id="S6.T5.6.6.6.6.1.m1.1.1.cmml" xref="S6.T5.6.6.6.6.1.m1.1.1">
               ↓
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.T5.6.6.6.6.1.m1.1c">
              \downarrow
             </annotation>
            </semantics>
           </math>
          </span>
         </th>
        </tr>
       </thead>
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="S6.T5.7.7.9.1">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T5.7.7.9.1.1">
          Baseline (GameFormer)
         </th>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.7.7.9.1.2">
          1.18
         </td>
         <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.7.7.9.1.3">
          2.44
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.7.7.9.1.4">
          –
         </td>
         <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.7.7.9.1.5">
          –
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.7.7.9.1.6">
          –
         </td>
         <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T5.7.7.9.1.7">
          –
         </td>
        </tr>
        <tr class="ltx_tr" id="S6.T5.7.7.10.2">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T5.7.7.10.2.1">
          Conditional Baseline (C-GameFormer)
         </th>
         <td class="ltx_td ltx_align_center" id="S6.T5.7.7.10.2.2">
          1.09
         </td>
         <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.7.7.10.2.3">
          2.22
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T5.7.7.10.2.4">
          2.14
         </td>
         <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.7.7.10.2.5">
          5.39
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T5.7.7.10.2.6">
          2.29
         </td>
         <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.7.7.10.2.7">
          5.56
         </td>
        </tr>
        <tr class="ltx_tr" id="S6.T5.7.7.7">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T5.7.7.7.1">
          iMotion-LLM
          <math alttext="{}_{\text{without classification}}" class="ltx_Math" display="inline" id="S6.T5.7.7.7.1.m1.1">
           <semantics id="S6.T5.7.7.7.1.m1.1a">
            <msub id="S6.T5.7.7.7.1.m1.1.1" xref="S6.T5.7.7.7.1.m1.1.1.cmml">
             <mi id="S6.T5.7.7.7.1.m1.1.1a" xref="S6.T5.7.7.7.1.m1.1.1.cmml">
             </mi>
             <mtext id="S6.T5.7.7.7.1.m1.1.1.1" xref="S6.T5.7.7.7.1.m1.1.1.1a.cmml">
              without classification
             </mtext>
            </msub>
            <annotation-xml encoding="MathML-Content" id="S6.T5.7.7.7.1.m1.1b">
             <apply id="S6.T5.7.7.7.1.m1.1.1.cmml" xref="S6.T5.7.7.7.1.m1.1.1">
              <ci id="S6.T5.7.7.7.1.m1.1.1.1a.cmml" xref="S6.T5.7.7.7.1.m1.1.1.1">
               <mtext id="S6.T5.7.7.7.1.m1.1.1.1.cmml" mathsize="70%" xref="S6.T5.7.7.7.1.m1.1.1.1">
                without classification
               </mtext>
              </ci>
             </apply>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S6.T5.7.7.7.1.m1.1c">
             {}_{\text{without classification}}
            </annotation>
           </semantics>
          </math>
         </th>
         <td class="ltx_td ltx_align_center" id="S6.T5.7.7.7.2">
          1.49
         </td>
         <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.7.7.7.3">
          3.33
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T5.7.7.7.4">
          2.40
         </td>
         <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.7.7.7.5">
          6.16
         </td>
         <td class="ltx_td ltx_align_center" id="S6.T5.7.7.7.6">
          2.57
         </td>
         <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.7.7.7.7">
          6.59
         </td>
        </tr>
        <tr class="ltx_tr" id="S6.T5.7.7.11.3">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S6.T5.7.7.11.3.1">
          iMotion-LLM
         </th>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.7.7.11.3.2">
          1.48
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T5.7.7.11.3.3">
          3.32
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.7.7.11.3.4">
          2.50
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T5.7.7.11.3.5">
          6.65
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.7.7.11.3.6">
          3.04
         </td>
         <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S6.T5.7.7.11.3.7">
          8.11
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
   </figure>
   <figure class="ltx_figure" id="S6.F5">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="162" id="S6.F5.g1" src="/html/2406.06211/assets/figures/ex3.png" width="598"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="S6.F5.2.1.1" style="font-size:90%;">
       Figure 5
      </span>
      :
     </span>
     <span class="ltx_text" id="S6.F5.3.2" style="font-size:90%;">
      Qualitative result showing in the top figure how iMotion-LLM accept and follow the actual-scenario instruction of "move straight" and in the bottom figure how it rejects "turn right" even though "turn right" is labeled as a feasible direction.
     </span>
    </figcaption>
   </figure>
   <figure class="ltx_figure" id="S6.F6">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="249" id="S6.F6.g1" src="/html/2406.06211/assets/x3.png" width="461"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="S6.F6.2.1.1" style="font-size:90%;">
       Figure 6
      </span>
      :
     </span>
     <span class="ltx_text" id="S6.F6.3.2" style="font-size:90%;">
      Qualitative result showing the model ability in following feasible instructions (top two figures), and making sense of surroundings. While also rejecting irrational scenarios like staying stationary in the bottom figure. Yet it generates a trajectory where the ego is stopping, and the interactive agent (Agent-2) is overtaking it.
     </span>
    </figcaption>
   </figure>
  </section>
 </section>
 <section class="ltx_section" id="S7">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    7
   </span>
   Limitations and Future Directions
  </h2>
  <div class="ltx_para" id="S7.p1">
   <p class="ltx_p" id="S7.p1.1">
    Our study provides a key step by focusing on direction-based instructions, illustrating the potential of the LLM in executing driving tasks. By showing that the model can effectively interpret and act on these instructions, we have established a baseline that future research can build upon. Exploring more complex instructions that encompass greater granularity and contextual information will further enhance the model’s nuanced understanding and execution of multifaceted driving tasks.
Furthermore, we employed relatively simple instructions and output captions, demonstrating the feasibility and effectiveness of this approach. Our work paves the way for incorporating more advanced and diverse input instructions and output captioning with varying levels of reasoning based on the ego state and surroundings. Although these elements were not included in this study, the attributes we extracted in InstructWaymo can facilitate their seamless integration. This presents an exciting opportunity for future research to develop more sophisticated and naturalistic implementations, extending the impact of our initial findings
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S8">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    8
   </span>
   Conclusion
  </h2>
  <div class="ltx_para" id="S8.p1">
   <p class="ltx_p" id="S8.p1.1">
    In conclusion, we introduce iMotion-LLM, a Large Multimodal Model powered by LLMs, tailored for trajectory prediction in interactive multi-agent scenarios within autonomous navigation. By leveraging textual instructions as key inputs, our model not only generates contextually relevant trajectory predictions but also showcases an enhanced ability to interpret and act upon these instructions. Through integration with a pretrained LLM fine-tuned with LoRA, iMotion-LLM effectively translates scene features into the LLM input space, enabling accurate multimodal trajectory forecasts. Notably, our model’s ability to generate trajectories aligned with provided instructions inherits the performance of the underlying backbone model, marking a significant advancement in empowering autonomous navigation systems to anticipate the dynamics of multi-agent environments. iMotion-LLM, combined with InstructWaymo instructions and captions, provides the capability to align trajectories with feasible instructions and reject infeasible ones, thereby enhancing operational safety. This work not only advances the field of autonomous navigation by enabling systems to better anticipate and react within multi-agent environments but also sets a solid foundation for further innovations in interactive autonomous systems.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [1]
    </span>
    <span class="ltx_bibblock">
     Achiam, J., Adler, S., Agarwal, S., Ahmad, L., Akkaya, I., Aleman, F.L., Almeida, D., Altenschmidt, J., Altman, S., Anadkat, S., et al.: Gpt-4 technical report. arXiv preprint arXiv:2303.08774 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [2]
    </span>
    <span class="ltx_bibblock">
     Alahi, A., Goel, K., Ramanathan, V., Robicquet, A., Fei-Fei, L., Savarese, S.: Social lstm: Human trajectory prediction in crowded spaces. In: Proceedings of the IEEE conference on computer vision and pattern recognition. pp. 961–971 (2016)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [3]
    </span>
    <span class="ltx_bibblock">
     Alayrac, J.B., Donahue, J., Luc, P., Miech, A., Barr, I., Hasson, Y., Lenc, K., Mensch, A., Millican, K., Reynolds, M., et al.: Flamingo: a visual language model for few-shot learning. Advances in Neural Information Processing Systems
     <span class="ltx_text ltx_font_bold" id="bib.bib3.1.1">
      35
     </span>
     , 23716–23736 (2022)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [4]
    </span>
    <span class="ltx_bibblock">
     Bai, J., Bai, S., Yang, S., Wang, S., Tan, S., Wang, P., Lin, J., Zhou, C., Zhou, J.: Qwen-vl: A versatile vision-language model for understanding, localization, text reading, and beyond (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [5]
    </span>
    <span class="ltx_bibblock">
     Brown, T., Mann, B., Ryder, N., Subbiah, M., Kaplan, J.D., Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G., Askell, A., et al.: Language models are few-shot learners. Advances in neural information processing systems
     <span class="ltx_text ltx_font_bold" id="bib.bib5.1.1">
      33
     </span>
     , 1877–1901 (2020)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [6]
    </span>
    <span class="ltx_bibblock">
     Chen, J., Zhu, D., Shen, X., Li, X., Liu, Z., Zhang, P., Krishnamoorthi, R., Chandra, V., Xiong, Y., Elhoseiny, M.: Minigpt-v2: large language model as a unified interface for vision-language multi-task learning. arXiv preprint arXiv:2310.09478 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [7]
    </span>
    <span class="ltx_bibblock">
     Chen, L., Sinavski, O., Hünermann, J., Karnsund, A., Willmott, A.J., Birch, D., Maund, D., Shotton, J.: Driving with llms: Fusing object-level vector modality for explainable autonomous driving. arXiv preprint arXiv:2310.01957 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [8]
    </span>
    <span class="ltx_bibblock">
     Chen, L., Sinavski, O., Hünermann, J., Karnsund, A., Willmott, A.J., Birch, D., Maund, D., Shotton, J.: Driving with llms: Fusing object-level vector modality for explainable autonomous driving. arXiv preprint arXiv:2310.01957 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [9]
    </span>
    <span class="ltx_bibblock">
     Chen, Y., Ivanovic, B., Pavone, M.: Scept: Scene-consistent, policy-based trajectory predictions for planning. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 17103–17112 (2022)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [10]
    </span>
    <span class="ltx_bibblock">
     Chiang, W.L., Li, Z., Lin, Z., Sheng, Y., Wu, Z., Zhang, H., Zheng, L., Zhuang, S., Zhuang, Y., Gonzalez, J.E., Stoica, I., Xing, E.P.: Vicuna: An open-source chatbot impressing gpt-4 with 90%* chatgpt quality (March 2023),
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://lmsys.org/blog/2023-03-30-vicuna/" target="_blank" title="">
      https://lmsys.org/blog/2023-03-30-vicuna/
     </a>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [11]
    </span>
    <span class="ltx_bibblock">
     Cui, C., Ma, Y., Cao, X., Ye, W., Wang, Z.: Drive as you speak: Enabling human-like interaction with large language models in autonomous vehicles. In: Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision. pp. 902–909 (2024)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [12]
    </span>
    <span class="ltx_bibblock">
     Cui, H., Radosavljevic, V., Chou, F.C., Lin, T.H., Nguyen, T., Huang, T.K., Schneider, J., Djuric, N.: Multimodal trajectory predictions for autonomous driving using deep convolutional networks. In: 2019 International Conference on Robotics and Automation (ICRA). pp. 2090–2096. IEEE (2019)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [13]
    </span>
    <span class="ltx_bibblock">
     Dai, W., Li, J., Li, D., Tiong, A., Zhao, J., Wang, W., Li, B., Fung, P., Hoi, S.: InstructBLIP: Towards general-purpose vision-language models with instruction tuning. In: Thirty-seventh Conference on Neural Information Processing Systems (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [14]
    </span>
    <span class="ltx_bibblock">
     Dai, W., Li, J., Li, D., Tiong, A.M.H., Zhao, J., Wang, W., Li, B., Fung, P., Hoi, S.C.H.: Instructblip: Towards general-purpose vision-language models with instruction tuning. CoRR
     <span class="ltx_text ltx_font_bold" id="bib.bib14.1.1">
      abs/2305.06500
     </span>
     (2023). https://doi.org/10.48550/ARXIV.2305.06500
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [15]
    </span>
    <span class="ltx_bibblock">
     Devlin, J., Chang, M.W., Lee, K., Toutanova, K.: Bert: Pre-training of deep bidirectional transformers for language understanding. arXiv preprint arXiv:1810.04805 (2018)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [16]
    </span>
    <span class="ltx_bibblock">
     Dewangan, V., Choudhary, T., Chandhok, S., Priyadarshan, S., Jain, A., Singh, A.K., Srivastava, S., Jatavallabhula, K.M., Krishna, K.M.: Talk2bev: Language-enhanced bird’s-eye view maps for autonomous driving. arXiv preprint arXiv:2310.02251 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [17]
    </span>
    <span class="ltx_bibblock">
     Ettinger, S., Cheng, S., Caine, B., Liu, C., Zhao, H., Pradhan, S., Chai, Y., Sapp, B., Qi, C., Zhou, Y., Yang, Z., Chouard, A., Sun, P., Ngiam, J., Vasudevan, V., McCauley, A., Shlens, J., Anguelov, D.: Large scale interactive motion forecasting for autonomous driving : The waymo open motion dataset. In: 2021 IEEE/CVF International Conference on Computer Vision (ICCV). pp. 9690–9699. IEEE Computer Society, Los Alamitos, CA, USA (oct 2021). https://doi.org/10.1109/ICCV48922.2021.00957,
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.ieeecomputersociety.org/10.1109/ICCV48922.2021.00957" target="_blank" title="">
      https://doi.ieeecomputersociety.org/10.1109/ICCV48922.2021.00957
     </a>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [18]
    </span>
    <span class="ltx_bibblock">
     Ettinger, S., Cheng, S., Caine, B., Liu, C., Zhao, H., Pradhan, S., Chai, Y., Sapp, B., Qi, C.R., Zhou, Y., et al.: Large scale interactive motion forecasting for autonomous driving: The waymo open motion dataset. In: Proceedings of the IEEE/CVF International Conference on Computer Vision. pp. 9710–9719 (2021)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [19]
    </span>
    <span class="ltx_bibblock">
     Gilles, T., Sabatini, S., Tsishkou, D., Stanciulescu, B., Moutarde, F.: Home: Heatmap output for future motion estimation. In: 2021 IEEE International Intelligent Transportation Systems Conference (ITSC). pp. 500–507. IEEE (2021)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [20]
    </span>
    <span class="ltx_bibblock">
     Guo, Z., Zhang, R., Zhu, X., Tang, Y., Ma, X., Han, J., Chen, K., Gao, P., Li, X., Li, H., et al.: Point-bind &amp; point-llm: Aligning point cloud with multi-modality for 3d understanding, generation, and instruction following. arXiv preprint arXiv:2309.00615 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [21]
    </span>
    <span class="ltx_bibblock">
     Hochreiter, S., Schmidhuber, J.: Long short-term memory. Neural computation
     <span class="ltx_text ltx_font_bold" id="bib.bib21.1.1">
      9
     </span>
     (8), 1735–1780 (1997)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [22]
    </span>
    <span class="ltx_bibblock">
     Hong, Y., Zhen, H., Chen, P., Zheng, S., Du, Y., Chen, Z., Gan, C.: 3d-llm: Injecting the 3d world into large language models. arXiv preprint arXiv:2307.12981 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [23]
    </span>
    <span class="ltx_bibblock">
     Hu, A., Russell, L., Yeo, H., Murez, Z., Fedoseev, G., Kendall, A., Shotton, J., Corrado, G.: Gaia-1: A generative world model for autonomous driving. arXiv preprint arXiv:2309.17080 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [24]
    </span>
    <span class="ltx_bibblock">
     Huang, W., Abbeel, P., Pathak, D., Mordatch, I.: Language models as zero-shot planners: Extracting actionable knowledge for embodied agents. In: International Conference on Machine Learning. pp. 9118–9147. PMLR (2022)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [25]
    </span>
    <span class="ltx_bibblock">
     Huang, Z., Liu, H., Lv, C.: Gameformer: Game-theoretic modeling and learning of transformer-based interactive prediction and planning for autonomous driving. In: Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV). pp. 3903–3913 (October 2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [26]
    </span>
    <span class="ltx_bibblock">
     Huang, Z., Liu, H., Lv, C.: Gameformer: Game-theoretic modeling and learning of transformer-based interactive prediction and planning for autonomous driving. arXiv preprint arXiv:2303.05760 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [27]
    </span>
    <span class="ltx_bibblock">
     Huang, Z., Mo, X., Lv, C.: Multi-modal motion prediction with transformer-based neural network for autonomous driving. In: 2022 International Conference on Robotics and Automation (ICRA). pp. 2605–2611. IEEE (2022)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [28]
    </span>
    <span class="ltx_bibblock">
     Jin, Y., Shen, X., Peng, H., Liu, X., Qin, J., Li, J., Xie, J., Gao, P., Zhou, G., Gong, J.: Surrealdriver: Designing generative driver agent simulation framework in urban contexts based on large language model. arXiv preprint arXiv:2309.13193 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [29]
    </span>
    <span class="ltx_bibblock">
     Lai, X., Tian, Z., Chen, Y., Li, Y., Yuan, Y., Liu, S., Jia, J.: Lisa: Reasoning segmentation via large language model. arXiv preprint arXiv:2308.00692 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [30]
    </span>
    <span class="ltx_bibblock">
     Li, K., He, Y., Wang, Y., Li, Y., Wang, W., Luo, P., Wang, Y., Wang, L., Qiao, Y.: Videochat: Chat-centric video understanding. arXiv preprint arXiv:2305.06355 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [31]
    </span>
    <span class="ltx_bibblock">
     Liu, H., Li, C., Li, Y., Lee, Y.J.: Improved baselines with visual instruction tuning. arXiv preprint arXiv:2310.03744 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [32]
    </span>
    <span class="ltx_bibblock">
     Liu, H., Li, C., Wu, Q., Lee, Y.J.: Visual instruction tuning. Advances in neural information processing systems
     <span class="ltx_text ltx_font_bold" id="bib.bib32.1.1">
      36
     </span>
     (2024)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [33]
    </span>
    <span class="ltx_bibblock">
     Maaz, M., Rasheed, H., Khan, S., Khan, F.S.: Video-chatgpt: Towards detailed video understanding via large vision and language models. arXiv preprint arXiv:2306.05424 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [34]
    </span>
    <span class="ltx_bibblock">
     Mao, J., Qian, Y., Zhao, H., Wang, Y.: Gpt-driver: Learning to drive with gpt. arXiv preprint arXiv:2310.01415 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [35]
    </span>
    <span class="ltx_bibblock">
     Mirza, M., Osindero, S.: Conditional generative adversarial nets (2014)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [36]
    </span>
    <span class="ltx_bibblock">
     Mo, X., Huang, Z., Xing, Y., Lv, C.: Multi-agent trajectory prediction with heterogeneous edge-enhanced graph attention network. IEEE Transactions on Intelligent Transportation Systems
     <span class="ltx_text ltx_font_bold" id="bib.bib36.1.1">
      23
     </span>
     (7), 9554–9567 (2022)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [37]
    </span>
    <span class="ltx_bibblock">
     Mohamed, A., Zhu, D., Vu, W., Elhoseiny, M., Claudel, C.: Social-implicit: Rethinking trajectory prediction evaluation and the effectiveness of implicit maximum likelihood estimation. In: European Conference on Computer Vision. pp. 463–479. Springer (2022)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [38]
    </span>
    <span class="ltx_bibblock">
     Nayakanti, N., Al-Rfou, R., Zhou, A., Goel, K., Refaat, K.S., Sapp, B.: Wayformer: Motion forecasting via simple &amp; efficient attention networks. In: 2023 IEEE International Conference on Robotics and Automation (ICRA). pp. 2980–2987. IEEE (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [39]
    </span>
    <span class="ltx_bibblock">
     Ngiam, J., Vasudevan, V., Caine, B., Zhang, Z., Chiang, H.T.L., Ling, J., Roelofs, R., Bewley, A., Liu, C., Venugopal, A., et al.: Scene transformer: A unified architecture for predicting future trajectories of multiple agents. In: International Conference on Learning Representations (2021)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib40">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [40]
    </span>
    <span class="ltx_bibblock">
     Radford, A., Wu, J., Child, R., Luan, D., Amodei, D., Sutskever, I., et al.: Language models are unsupervised multitask learners. OpenAI blog
     <span class="ltx_text ltx_font_bold" id="bib.bib40.1.1">
      1
     </span>
     (8),  9 (2019)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib41">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [41]
    </span>
    <span class="ltx_bibblock">
     Salzmann, T., Ivanovic, B., Chakravarty, P., Pavone, M.: Trajectron++: Dynamically-feasible trajectory forecasting with heterogeneous data. In: Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part XVIII 16. pp. 683–700. Springer (2020)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib42">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [42]
    </span>
    <span class="ltx_bibblock">
     Seff, A., Cera, B., Chen, D., Ng, M., Zhou, A., Nayakanti, N., Refaat, K.S., Al-Rfou, R., Sapp, B.: Motionlm: Multi-agent motion forecasting as language modeling. In: Proceedings of the IEEE/CVF International Conference on Computer Vision. pp. 8579–8590 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib43">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [43]
    </span>
    <span class="ltx_bibblock">
     Shi, S., Jiang, L., Dai, D., Schiele, B.: Motion transformer with global intention localization and local movement refinement. Advances in Neural Information Processing Systems (2022)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib44">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [44]
    </span>
    <span class="ltx_bibblock">
     Shi, S., Jiang, L., Dai, D., Schiele, B.: Motion transformer with global intention localization and local movement refinement. Advances in Neural Information Processing Systems
     <span class="ltx_text ltx_font_bold" id="bib.bib44.1.1">
      35
     </span>
     , 6531–6543 (2022)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib45">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [45]
    </span>
    <span class="ltx_bibblock">
     Shi, S., Jiang, L., Dai, D., Schiele, B.: Mtr++: Multi-agent motion prediction with symmetric scene modeling and guided intention querying. IEEE Transactions on Pattern Analysis and Machine Intelligence (2024)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib46">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [46]
    </span>
    <span class="ltx_bibblock">
     Touvron, H., Lavril, T., Izacard, G., Martinet, X., Lachaux, M.A., Lacroix, T., Rozière, B., Goyal, N., Hambro, E., Azhar, F., et al.: Llama: Open and efficient foundation language models. arXiv preprint arXiv:2302.13971 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib47">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [47]
    </span>
    <span class="ltx_bibblock">
     Touvron, H., Martin, L., Stone, K., Albert, P., Almahairi, A., Babaei, Y., Bashlykov, N., Batra, S., Bhargava, P., Bhosale, S., et al.: Llama 2: Open foundation and fine-tuned chat models. arXiv preprint arXiv:2307.09288 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib48">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [48]
    </span>
    <span class="ltx_bibblock">
     Wang, W., Chen, Z., Chen, X., Wu, J., Zhu, X., Zeng, G., Luo, P., Lu, T., Zhou, J., Qiao, Y., et al.: Visionllm: Large language model is also an open-ended decoder for vision-centric tasks. Advances in Neural Information Processing Systems
     <span class="ltx_text ltx_font_bold" id="bib.bib48.1.1">
      36
     </span>
     (2024)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib49">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [49]
    </span>
    <span class="ltx_bibblock">
     Xu, R., Wang, X., Wang, T., Chen, Y., Pang, J., Lin, D.: Pointllm: Empowering large language models to understand point clouds. arXiv preprint arXiv:2308.16911 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib50">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [50]
    </span>
    <span class="ltx_bibblock">
     Xu, Z., Zhang, Y., Xie, E., Zhao, Z., Guo, Y., Wong, K.K., Li, Z., Zhao, H.: Drivegpt4: Interpretable end-to-end autonomous driving via large language model. arXiv preprint arXiv:2310.01412 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib51">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [51]
    </span>
    <span class="ltx_bibblock">
     Zhang, H., Li, X., Bing, L.: Video-llama: An instruction-tuned audio-visual language model for video understanding. arXiv preprint arXiv:2306.02858 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib52">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [52]
    </span>
    <span class="ltx_bibblock">
     Zhu, D., Chen, J., Shen, X., Li, X., Elhoseiny, M.: Minigpt-4: Enhancing vision-language understanding with advanced large language models. arXiv preprint arXiv:2304.10592 (2023)
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib53">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [53]
    </span>
    <span class="ltx_bibblock">
     Zhu, D., Chen, J., Shen, X., Li, X., Elhoseiny, M.: MiniGPT-4: Enhancing vision-language understanding with advanced large language models. In: The Twelfth International Conference on Learning Representations (2024)
    </span>
   </li>
  </ul>
 </section>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <section class="ltx_appendix" id="A1">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Speed and acceleration categories
  </h2>
  <div class="ltx_para" id="A1.p1">
   <p class="ltx_p" id="A1.p1.1">
    The set of 5 different speed categories ranging from very slow to very fast, and the set of acceleration or deceleration ranging from mind to extreme, including a no acceleration (i.e., constant velocity). We designed these thresholds heuristically, yet they can be easily adapted. Table
    <a class="ltx_ref" href="#A1.T6" title="Table 6 ‣ Appendix A Speed and acceleration categories ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      6
     </span>
    </a>
    shows the used thresholds.
   </p>
  </div>
  <figure class="ltx_table" id="A1.T6">
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     <span class="ltx_text" id="A1.T6.2.1.1" style="font-size:90%;">
      Table 6
     </span>
     :
    </span>
    <span class="ltx_text" id="A1.T6.3.2" style="font-size:90%;">
     Speed and acceleration/deceleration categories and upper thresholds.
    </span>
   </figcaption>
   <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T6.4" style="width:328.6pt;height:54.8pt;vertical-align:-0.8pt;">
    <span class="ltx_transformed_inner" style="transform:translate(-54.8pt,9.0pt) scale(0.75,0.75) ;">
     <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T6.4.1">
      <thead class="ltx_thead">
       <tr class="ltx_tr" id="A1.T6.4.1.1.1">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T6.4.1.1.1.1">
         Speed category
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T6.4.1.1.1.2">
         Very slow
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T6.4.1.1.1.3">
         Slow
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T6.4.1.1.1.4">
         Moderate
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T6.4.1.1.1.5">
         Fast
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T6.4.1.1.1.6">
         Very fast
        </th>
       </tr>
      </thead>
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="A1.T6.4.1.2.1">
        <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T6.4.1.2.1.1">
         Threshold (km/h)
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.1.2.1.2">
         20
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.1.2.1.3">
         40
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.1.2.1.4">
         90
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.1.2.1.5">
         120
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.2.1.6">
         &gt;120
        </td>
       </tr>
       <tr class="ltx_tr" id="A1.T6.4.1.3.2">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T6.4.1.3.2.1">
         Accel./Decel. category
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T6.4.1.3.2.2">
         Constant velocity
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T6.4.1.3.2.3">
         mild
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T6.4.1.3.2.4">
         Moderate
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T6.4.1.3.2.5">
         aggressive
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T6.4.1.3.2.6">
         extreme
        </th>
       </tr>
       <tr class="ltx_tr" id="A1.T6.4.1.4.3">
        <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="A1.T6.4.1.4.3.1">
         Threshold (km/h increase in 8s)
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="A1.T6.4.1.4.3.2">
         6
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="A1.T6.4.1.4.3.3">
         25
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="A1.T6.4.1.4.3.4">
         46
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="A1.T6.4.1.4.3.5">
         65
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T6.4.1.4.3.6">
         &gt;65
        </td>
       </tr>
      </tbody>
     </table>
    </span>
   </div>
  </figure>
 </section>
 <section class="ltx_appendix" id="A2">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix B
   </span>
   Calculation of the directions
  </h2>
  <div class="ltx_para" id="A2.p1">
   <p class="ltx_p" id="A2.p1.6">
    Following the illustration shown in Figure
    <a class="ltx_ref" href="#A2.F7" title="Figure 7 ‣ Appendix B Calculation of the directions ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      7
     </span>
    </a>
    , motion direction is measured based on the relative heading angle between a time step and a future target step. We calculate direction solely based on trajectory information; the heading angle is calculated using two consecutive trajectory discrete samples. If the maximum future speed is within a threshold of
    <math alttext="\text{v}_{\text{stationary}}=2\text{m/s}" class="ltx_Math" display="inline" id="A2.p1.1.m1.1">
     <semantics id="A2.p1.1.m1.1a">
      <mrow id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml">
       <msub id="A2.p1.1.m1.1.1.2" xref="A2.p1.1.m1.1.1.2.cmml">
        <mtext id="A2.p1.1.m1.1.1.2.2" xref="A2.p1.1.m1.1.1.2.2a.cmml">
         v
        </mtext>
        <mtext id="A2.p1.1.m1.1.1.2.3" xref="A2.p1.1.m1.1.1.2.3a.cmml">
         stationary
        </mtext>
       </msub>
       <mo id="A2.p1.1.m1.1.1.1" xref="A2.p1.1.m1.1.1.1.cmml">
        =
       </mo>
       <mrow id="A2.p1.1.m1.1.1.3" xref="A2.p1.1.m1.1.1.3.cmml">
        <mn id="A2.p1.1.m1.1.1.3.2" xref="A2.p1.1.m1.1.1.3.2.cmml">
         2
        </mn>
        <mo id="A2.p1.1.m1.1.1.3.1" lspace="0em" rspace="0em" xref="A2.p1.1.m1.1.1.3.1.cmml">
         ​
        </mo>
        <mtext id="A2.p1.1.m1.1.1.3.3" xref="A2.p1.1.m1.1.1.3.3a.cmml">
         m/s
        </mtext>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b">
       <apply id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">
        <eq id="A2.p1.1.m1.1.1.1.cmml" xref="A2.p1.1.m1.1.1.1">
        </eq>
        <apply id="A2.p1.1.m1.1.1.2.cmml" xref="A2.p1.1.m1.1.1.2">
         <csymbol cd="ambiguous" id="A2.p1.1.m1.1.1.2.1.cmml" xref="A2.p1.1.m1.1.1.2">
          subscript
         </csymbol>
         <ci id="A2.p1.1.m1.1.1.2.2a.cmml" xref="A2.p1.1.m1.1.1.2.2">
          <mtext id="A2.p1.1.m1.1.1.2.2.cmml" xref="A2.p1.1.m1.1.1.2.2">
           v
          </mtext>
         </ci>
         <ci id="A2.p1.1.m1.1.1.2.3a.cmml" xref="A2.p1.1.m1.1.1.2.3">
          <mtext id="A2.p1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="A2.p1.1.m1.1.1.2.3">
           stationary
          </mtext>
         </ci>
        </apply>
        <apply id="A2.p1.1.m1.1.1.3.cmml" xref="A2.p1.1.m1.1.1.3">
         <times id="A2.p1.1.m1.1.1.3.1.cmml" xref="A2.p1.1.m1.1.1.3.1">
         </times>
         <cn id="A2.p1.1.m1.1.1.3.2.cmml" type="integer" xref="A2.p1.1.m1.1.1.3.2">
          2
         </cn>
         <ci id="A2.p1.1.m1.1.1.3.3a.cmml" xref="A2.p1.1.m1.1.1.3.3">
          <mtext id="A2.p1.1.m1.1.1.3.3.cmml" xref="A2.p1.1.m1.1.1.3.3">
           m/s
          </mtext>
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">
       \text{v}_{\text{stationary}}=2\text{m/s}
      </annotation>
     </semantics>
    </math>
    , and the vehicle traveled a distance within
    <math alttext="\text{d}_{\text{stationary}}=5\text{m}" class="ltx_Math" display="inline" id="A2.p1.2.m2.1">
     <semantics id="A2.p1.2.m2.1a">
      <mrow id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml">
       <msub id="A2.p1.2.m2.1.1.2" xref="A2.p1.2.m2.1.1.2.cmml">
        <mtext id="A2.p1.2.m2.1.1.2.2" xref="A2.p1.2.m2.1.1.2.2a.cmml">
         d
        </mtext>
        <mtext id="A2.p1.2.m2.1.1.2.3" xref="A2.p1.2.m2.1.1.2.3a.cmml">
         stationary
        </mtext>
       </msub>
       <mo id="A2.p1.2.m2.1.1.1" xref="A2.p1.2.m2.1.1.1.cmml">
        =
       </mo>
       <mrow id="A2.p1.2.m2.1.1.3" xref="A2.p1.2.m2.1.1.3.cmml">
        <mn id="A2.p1.2.m2.1.1.3.2" xref="A2.p1.2.m2.1.1.3.2.cmml">
         5
        </mn>
        <mo id="A2.p1.2.m2.1.1.3.1" lspace="0em" rspace="0em" xref="A2.p1.2.m2.1.1.3.1.cmml">
         ​
        </mo>
        <mtext id="A2.p1.2.m2.1.1.3.3" xref="A2.p1.2.m2.1.1.3.3a.cmml">
         m
        </mtext>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b">
       <apply id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1">
        <eq id="A2.p1.2.m2.1.1.1.cmml" xref="A2.p1.2.m2.1.1.1">
        </eq>
        <apply id="A2.p1.2.m2.1.1.2.cmml" xref="A2.p1.2.m2.1.1.2">
         <csymbol cd="ambiguous" id="A2.p1.2.m2.1.1.2.1.cmml" xref="A2.p1.2.m2.1.1.2">
          subscript
         </csymbol>
         <ci id="A2.p1.2.m2.1.1.2.2a.cmml" xref="A2.p1.2.m2.1.1.2.2">
          <mtext id="A2.p1.2.m2.1.1.2.2.cmml" xref="A2.p1.2.m2.1.1.2.2">
           d
          </mtext>
         </ci>
         <ci id="A2.p1.2.m2.1.1.2.3a.cmml" xref="A2.p1.2.m2.1.1.2.3">
          <mtext id="A2.p1.2.m2.1.1.2.3.cmml" mathsize="70%" xref="A2.p1.2.m2.1.1.2.3">
           stationary
          </mtext>
         </ci>
        </apply>
        <apply id="A2.p1.2.m2.1.1.3.cmml" xref="A2.p1.2.m2.1.1.3">
         <times id="A2.p1.2.m2.1.1.3.1.cmml" xref="A2.p1.2.m2.1.1.3.1">
         </times>
         <cn id="A2.p1.2.m2.1.1.3.2.cmml" type="integer" xref="A2.p1.2.m2.1.1.3.2">
          5
         </cn>
         <ci id="A2.p1.2.m2.1.1.3.3a.cmml" xref="A2.p1.2.m2.1.1.3.3">
          <mtext id="A2.p1.2.m2.1.1.3.3.cmml" xref="A2.p1.2.m2.1.1.3.3">
           m
          </mtext>
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">
       \text{d}_{\text{stationary}}=5\text{m}
      </annotation>
     </semantics>
    </math>
    , the vehicle is considered stationary. Otherwise, the vehicle is moving straight if the relative heading is within
    <math alttext="\theta_{\text{s}}=30" class="ltx_Math" display="inline" id="A2.p1.3.m3.1">
     <semantics id="A2.p1.3.m3.1a">
      <mrow id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml">
       <msub id="A2.p1.3.m3.1.1.2" xref="A2.p1.3.m3.1.1.2.cmml">
        <mi id="A2.p1.3.m3.1.1.2.2" xref="A2.p1.3.m3.1.1.2.2.cmml">
         θ
        </mi>
        <mtext id="A2.p1.3.m3.1.1.2.3" xref="A2.p1.3.m3.1.1.2.3a.cmml">
         s
        </mtext>
       </msub>
       <mo id="A2.p1.3.m3.1.1.1" xref="A2.p1.3.m3.1.1.1.cmml">
        =
       </mo>
       <mn id="A2.p1.3.m3.1.1.3" xref="A2.p1.3.m3.1.1.3.cmml">
        30
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b">
       <apply id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1">
        <eq id="A2.p1.3.m3.1.1.1.cmml" xref="A2.p1.3.m3.1.1.1">
        </eq>
        <apply id="A2.p1.3.m3.1.1.2.cmml" xref="A2.p1.3.m3.1.1.2">
         <csymbol cd="ambiguous" id="A2.p1.3.m3.1.1.2.1.cmml" xref="A2.p1.3.m3.1.1.2">
          subscript
         </csymbol>
         <ci id="A2.p1.3.m3.1.1.2.2.cmml" xref="A2.p1.3.m3.1.1.2.2">
          𝜃
         </ci>
         <ci id="A2.p1.3.m3.1.1.2.3a.cmml" xref="A2.p1.3.m3.1.1.2.3">
          <mtext id="A2.p1.3.m3.1.1.2.3.cmml" mathsize="70%" xref="A2.p1.3.m3.1.1.2.3">
           s
          </mtext>
         </ci>
        </apply>
        <cn id="A2.p1.3.m3.1.1.3.cmml" type="integer" xref="A2.p1.3.m3.1.1.3">
         30
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">
       \theta_{\text{s}}=30
      </annotation>
     </semantics>
    </math>
    degrees. But if the longitudinal displacement is greater than
    <math alttext="\text{d}_{\text{v}}=5\text{m}" class="ltx_Math" display="inline" id="A2.p1.4.m4.1">
     <semantics id="A2.p1.4.m4.1a">
      <mrow id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml">
       <msub id="A2.p1.4.m4.1.1.2" xref="A2.p1.4.m4.1.1.2.cmml">
        <mtext id="A2.p1.4.m4.1.1.2.2" xref="A2.p1.4.m4.1.1.2.2a.cmml">
         d
        </mtext>
        <mtext id="A2.p1.4.m4.1.1.2.3" xref="A2.p1.4.m4.1.1.2.3a.cmml">
         v
        </mtext>
       </msub>
       <mo id="A2.p1.4.m4.1.1.1" xref="A2.p1.4.m4.1.1.1.cmml">
        =
       </mo>
       <mrow id="A2.p1.4.m4.1.1.3" xref="A2.p1.4.m4.1.1.3.cmml">
        <mn id="A2.p1.4.m4.1.1.3.2" xref="A2.p1.4.m4.1.1.3.2.cmml">
         5
        </mn>
        <mo id="A2.p1.4.m4.1.1.3.1" lspace="0em" rspace="0em" xref="A2.p1.4.m4.1.1.3.1.cmml">
         ​
        </mo>
        <mtext id="A2.p1.4.m4.1.1.3.3" xref="A2.p1.4.m4.1.1.3.3a.cmml">
         m
        </mtext>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b">
       <apply id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1">
        <eq id="A2.p1.4.m4.1.1.1.cmml" xref="A2.p1.4.m4.1.1.1">
        </eq>
        <apply id="A2.p1.4.m4.1.1.2.cmml" xref="A2.p1.4.m4.1.1.2">
         <csymbol cd="ambiguous" id="A2.p1.4.m4.1.1.2.1.cmml" xref="A2.p1.4.m4.1.1.2">
          subscript
         </csymbol>
         <ci id="A2.p1.4.m4.1.1.2.2a.cmml" xref="A2.p1.4.m4.1.1.2.2">
          <mtext id="A2.p1.4.m4.1.1.2.2.cmml" xref="A2.p1.4.m4.1.1.2.2">
           d
          </mtext>
         </ci>
         <ci id="A2.p1.4.m4.1.1.2.3a.cmml" xref="A2.p1.4.m4.1.1.2.3">
          <mtext id="A2.p1.4.m4.1.1.2.3.cmml" mathsize="70%" xref="A2.p1.4.m4.1.1.2.3">
           v
          </mtext>
         </ci>
        </apply>
        <apply id="A2.p1.4.m4.1.1.3.cmml" xref="A2.p1.4.m4.1.1.3">
         <times id="A2.p1.4.m4.1.1.3.1.cmml" xref="A2.p1.4.m4.1.1.3.1">
         </times>
         <cn id="A2.p1.4.m4.1.1.3.2.cmml" type="integer" xref="A2.p1.4.m4.1.1.3.2">
          5
         </cn>
         <ci id="A2.p1.4.m4.1.1.3.3a.cmml" xref="A2.p1.4.m4.1.1.3.3">
          <mtext id="A2.p1.4.m4.1.1.3.3.cmml" xref="A2.p1.4.m4.1.1.3.3">
           m
          </mtext>
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">
       \text{d}_{\text{v}}=5\text{m}
      </annotation>
     </semantics>
    </math>
    , it is categorized as straight veering right/left. If the relative heading exceeds
    <math alttext="\theta_{\text{s}}" class="ltx_Math" display="inline" id="A2.p1.5.m5.1">
     <semantics id="A2.p1.5.m5.1a">
      <msub id="A2.p1.5.m5.1.1" xref="A2.p1.5.m5.1.1.cmml">
       <mi id="A2.p1.5.m5.1.1.2" xref="A2.p1.5.m5.1.1.2.cmml">
        θ
       </mi>
       <mtext id="A2.p1.5.m5.1.1.3" xref="A2.p1.5.m5.1.1.3a.cmml">
        s
       </mtext>
      </msub>
      <annotation-xml encoding="MathML-Content" id="A2.p1.5.m5.1b">
       <apply id="A2.p1.5.m5.1.1.cmml" xref="A2.p1.5.m5.1.1">
        <csymbol cd="ambiguous" id="A2.p1.5.m5.1.1.1.cmml" xref="A2.p1.5.m5.1.1">
         subscript
        </csymbol>
        <ci id="A2.p1.5.m5.1.1.2.cmml" xref="A2.p1.5.m5.1.1.2">
         𝜃
        </ci>
        <ci id="A2.p1.5.m5.1.1.3a.cmml" xref="A2.p1.5.m5.1.1.3">
         <mtext id="A2.p1.5.m5.1.1.3.cmml" mathsize="70%" xref="A2.p1.5.m5.1.1.3">
          s
         </mtext>
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p1.5.m5.1c">
       \theta_{\text{s}}
      </annotation>
     </semantics>
    </math>
    , and the latitudinal shift is less than
    <math alttext="\text{d}_{\text{u}}=5\text{m}" class="ltx_Math" display="inline" id="A2.p1.6.m6.1">
     <semantics id="A2.p1.6.m6.1a">
      <mrow id="A2.p1.6.m6.1.1" xref="A2.p1.6.m6.1.1.cmml">
       <msub id="A2.p1.6.m6.1.1.2" xref="A2.p1.6.m6.1.1.2.cmml">
        <mtext id="A2.p1.6.m6.1.1.2.2" xref="A2.p1.6.m6.1.1.2.2a.cmml">
         d
        </mtext>
        <mtext id="A2.p1.6.m6.1.1.2.3" xref="A2.p1.6.m6.1.1.2.3a.cmml">
         u
        </mtext>
       </msub>
       <mo id="A2.p1.6.m6.1.1.1" xref="A2.p1.6.m6.1.1.1.cmml">
        =
       </mo>
       <mrow id="A2.p1.6.m6.1.1.3" xref="A2.p1.6.m6.1.1.3.cmml">
        <mn id="A2.p1.6.m6.1.1.3.2" xref="A2.p1.6.m6.1.1.3.2.cmml">
         5
        </mn>
        <mo id="A2.p1.6.m6.1.1.3.1" lspace="0em" rspace="0em" xref="A2.p1.6.m6.1.1.3.1.cmml">
         ​
        </mo>
        <mtext id="A2.p1.6.m6.1.1.3.3" xref="A2.p1.6.m6.1.1.3.3a.cmml">
         m
        </mtext>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.p1.6.m6.1b">
       <apply id="A2.p1.6.m6.1.1.cmml" xref="A2.p1.6.m6.1.1">
        <eq id="A2.p1.6.m6.1.1.1.cmml" xref="A2.p1.6.m6.1.1.1">
        </eq>
        <apply id="A2.p1.6.m6.1.1.2.cmml" xref="A2.p1.6.m6.1.1.2">
         <csymbol cd="ambiguous" id="A2.p1.6.m6.1.1.2.1.cmml" xref="A2.p1.6.m6.1.1.2">
          subscript
         </csymbol>
         <ci id="A2.p1.6.m6.1.1.2.2a.cmml" xref="A2.p1.6.m6.1.1.2.2">
          <mtext id="A2.p1.6.m6.1.1.2.2.cmml" xref="A2.p1.6.m6.1.1.2.2">
           d
          </mtext>
         </ci>
         <ci id="A2.p1.6.m6.1.1.2.3a.cmml" xref="A2.p1.6.m6.1.1.2.3">
          <mtext id="A2.p1.6.m6.1.1.2.3.cmml" mathsize="70%" xref="A2.p1.6.m6.1.1.2.3">
           u
          </mtext>
         </ci>
        </apply>
        <apply id="A2.p1.6.m6.1.1.3.cmml" xref="A2.p1.6.m6.1.1.3">
         <times id="A2.p1.6.m6.1.1.3.1.cmml" xref="A2.p1.6.m6.1.1.3.1">
         </times>
         <cn id="A2.p1.6.m6.1.1.3.2.cmml" type="integer" xref="A2.p1.6.m6.1.1.3.2">
          5
         </cn>
         <ci id="A2.p1.6.m6.1.1.3.3a.cmml" xref="A2.p1.6.m6.1.1.3.3">
          <mtext id="A2.p1.6.m6.1.1.3.3.cmml" xref="A2.p1.6.m6.1.1.3.3">
           m
          </mtext>
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p1.6.m6.1c">
       \text{d}_{\text{u}}=5\text{m}
      </annotation>
     </semantics>
    </math>
    in the opposite direction, it is considered as turning right/left. Otherwise, it is a U-turn. Right and left directions are distinguished based on the sign of the relative heading. Figure
    <a class="ltx_ref" href="#A2.F7" title="Figure 7 ‣ Appendix B Calculation of the directions ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      7
     </span>
    </a>
    illustrates the different classes. Table
    <a class="ltx_ref" href="#S3.T1" title="Table 1 ‣ 3 InstructWaymo: Instruction Augmentation of Waymo Open Dataset ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    provides detailed statistics on these eight categories.
   </p>
  </div>
  <figure class="ltx_figure" id="A2.F7">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="140" id="A2.F7.g1" src="/html/2406.06211/assets/figures/directions.png" width="598"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="A2.F7.2.1.1" style="font-size:90%;">
      Figure 7
     </span>
     :
    </span>
    <span class="ltx_text" id="A2.F7.3.2" style="font-size:90%;">
     Illustrative examples of directions categories.
    </span>
   </figcaption>
  </figure>
 </section>
 <section class="ltx_appendix" id="A3">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix C
   </span>
   Additional Qualitative Results
  </h2>
  <figure class="ltx_figure" id="A3.F8">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="210" id="A3.F8.g1" src="/html/2406.06211/assets/figures/ex8_lowq.png" width="598"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="A3.F8.2.1.1" style="font-size:90%;">
      Figure 8
     </span>
     :
    </span>
    <span class="ltx_text" id="A3.F8.3.2" style="font-size:90%;">
     Qualitative Results.
    </span>
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A3.F9">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="233" id="A3.F9.g1" src="/html/2406.06211/assets/figures/ex9_lowq.png" width="598"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="A3.F9.2.1.1" style="font-size:90%;">
      Figure 9
     </span>
     :
    </span>
    <span class="ltx_text" id="A3.F9.3.2" style="font-size:90%;">
     Qualitative Results.
    </span>
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A3.F10">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="236" id="A3.F10.g1" src="/html/2406.06211/assets/figures/ex10_lowq.png" width="598"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="A3.F10.2.1.1" style="font-size:90%;">
      Figure 10
     </span>
     :
    </span>
    <span class="ltx_text" id="A3.F10.3.2" style="font-size:90%;">
     Qualitative Results.
    </span>
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A3.F11">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="311" id="A3.F11.g1" src="/html/2406.06211/assets/figures/ex11_lowq.png" width="598"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="A3.F11.2.1.1" style="font-size:90%;">
      Figure 11
     </span>
     :
    </span>
    <span class="ltx_text" id="A3.F11.3.2" style="font-size:90%;">
     Qualitative Results.
    </span>
   </figcaption>
  </figure>
 </section>
 <section class="ltx_appendix" id="A4">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix D
   </span>
   Evaluation Sampling
  </h2>
  <div class="ltx_para" id="A4.p1">
   <p class="ltx_p" id="A4.p1.1">
    A total of 2,311 evaluation examples were used, where the directions category were validated to be of similar distribution to the train data. Since the set of other feasible and infeasible directions for a given example could be up to 7 (where 8 is the number of possible categories), we do not evaluate all. For evaluation, we consider the reciprocal of the distribution across samples of the evaluation other feasible instructions set, and the evaluation infeasible instructions set for sampling. Through this we balance having excessive number of instructions that always appears as other feasible instruction or infeasible instruction.
    <a class="ltx_ref" href="#A4.T7" title="Table 7 ‣ Appendix D Evaluation Sampling ‣ iMotion-LLM: Motion Prediction Instruction Tuning">
     <span class="ltx_text ltx_ref_tag">
      7
     </span>
    </a>
    shows the distribution of each category.
   </p>
  </div>
  <figure class="ltx_table" id="A4.T7">
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     <span class="ltx_text" id="A4.T7.2.1.1" style="font-size:90%;">
      Table 7
     </span>
     :
    </span>
    <span class="ltx_text" id="A4.T7.3.2" style="font-size:90%;">
     The categorical distribution of directions for the other feasible and infeasible instructions in the test set.
    </span>
   </figcaption>
   <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A4.T7.4" style="width:428.3pt;height:40.1pt;vertical-align:-0.7pt;">
    <span class="ltx_transformed_inner" style="transform:translate(-79.2pt,7.3pt) scale(0.73,0.73) ;">
     <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T7.4.1">
      <thead class="ltx_thead">
       <tr class="ltx_tr" id="A4.T7.4.1.1.1">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A4.T7.4.1.1.1.1">
         Category
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A4.T7.4.1.1.1.2">
         Stationary
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A4.T7.4.1.1.1.3">
         Straight
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A4.T7.4.1.1.1.4">
         Straight-right
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A4.T7.4.1.1.1.5">
         Straight-left
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A4.T7.4.1.1.1.6">
         Right
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A4.T7.4.1.1.1.7">
         Left
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A4.T7.4.1.1.1.8">
         Right u-turn
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A4.T7.4.1.1.1.9">
         Left u-turn
        </th>
       </tr>
      </thead>
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="A4.T7.4.1.2.1">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A4.T7.4.1.2.1.1">
         Other feasible instructions
        </th>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T7.4.1.2.1.2">
         18.23%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T7.4.1.2.1.3">
         2.7%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T7.4.1.2.1.4">
         3.88%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T7.4.1.2.1.5">
         3.91%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T7.4.1.2.1.6">
         8.36%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T7.4.1.2.1.7">
         16.04%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T7.4.1.2.1.8">
         23.75%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T7.4.1.2.1.9">
         23.12%
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T7.4.1.3.2">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A4.T7.4.1.3.2.1">
         Infeasible instructions
        </th>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A4.T7.4.1.3.2.2">
         7.04%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A4.T7.4.1.3.2.3">
         6.76%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A4.T7.4.1.3.2.4">
         15.34%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A4.T7.4.1.3.2.5">
         9.14%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A4.T7.4.1.3.2.6">
         39.00%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A4.T7.4.1.3.2.7">
         13.54%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A4.T7.4.1.3.2.8">
         4.32%
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A4.T7.4.1.3.2.9">
         4.85%
        </td>
       </tr>
      </tbody>
     </table>
    </span>
   </div>
  </figure>
 </section>
</article>
