<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2308.09160] FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning</title><meta property="og:description" content="Personalized Federated Learning (PFL) represents a promising solution for decentralized learning in heterogeneous data environments. Partial model personalization has been proposed to improve the efficiency of PFL by s…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2308.09160">

<!--Generated on Wed Feb 28 12:05:51 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Guangyu Sun<sup id="id1.1.id1" class="ltx_sup">1</sup>, Matias Mendieta<sup id="id2.2.id2" class="ltx_sup">1</sup>, Jun Luo<sup id="id3.3.id3" class="ltx_sup">2</sup>, Shandong Wu<sup id="id4.4.id4" class="ltx_sup">3</sup>, Chen Chen<sup id="id5.5.id5" class="ltx_sup">1</sup>
<br class="ltx_break">
<br class="ltx_break"><sup id="id6.6.id6" class="ltx_sup">1</sup>Center for Research in Computer Vision, University of Central Florida, USA
<br class="ltx_break"><sup id="id7.7.id7" class="ltx_sup">2</sup>Intelligent Systems Program,
University of Pittsburgh, USA
<br class="ltx_break"><sup id="id8.8.id8" class="ltx_sup">3</sup>Department of Radiology, Biomedical Informatics,
<br class="ltx_break">and Bioengineering,
University of Pittsburgh, USA
<br class="ltx_break"><span id="id9.9.id9" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{guangyu.sun, matias.mendieta}@ucf.edu; jul117@pitt.edu;<span id="id9.9.id9.1" class="ltx_text ltx_font_serif"> 
<br class="ltx_break"></span>wus3@upmc.edu; chen.chen@crcv.ucf.edu<span id="id9.9.id9.2" class="ltx_text ltx_font_serif">
</span></span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id10.id1" class="ltx_p">Personalized Federated Learning (PFL) represents a promising solution for decentralized learning in heterogeneous data environments. Partial model personalization has been proposed to improve the efficiency of PFL by selectively updating local model parameters instead of aggregating all of them. However, previous work on partial model personalization has mainly focused on Convolutional Neural Networks (CNNs), leaving a gap in understanding how it can be applied to other popular models such as Vision Transformers (ViTs).
In this work, we investigate where and how to partially personalize a ViT model. Specifically, we empirically evaluate the sensitivity to data distribution of each type of layer. Based on the insights that the self-attention layer and the classification head are the most sensitive parts of a ViT, we propose a novel approach called FedPerfix, which leverages plugins to transfer information from the aggregated model to the local client as a personalization. Finally, we evaluate the proposed approach on CIFAR-100, OrganAMNIST, and Office-Home datasets and demonstrate its effectiveness in improving the model’s performance compared to several advanced PFL methods. Code is available at <a target="_blank" href="https://github.com/imguangyu/FedPerfix" title="" class="ltx_ref ltx_href">https://github.com/imguangyu/FedPerfix</a></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> has emerged as a promising method for training machine learning models on decentralized data without requiring direct data sharing. However, data heterogeneity among participating clients can present a significant challenge. Due to the various circumstances of the clients, the data across the clients can be non-independent and non-identically distributed (non-IID).
Therefore, achieving satisfactory performance using a one-model-fits-all approach is difficult, and personalized models are often needed to achieve the best results. This has inspired the study of Personalized Federated Learning (PFL), where the focus is shifted from the performance of the global model on the server to the local models on the clients.
</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In the context of personalized federated learning, previous literature has explored two main approaches: <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">full model personalization</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">partial model personalization</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Full model personalization involves maintaining a separate local model for each client and updating it based on a joint objective, while partial model personalization aims to personalize only a subset of the model parameters. A convergence analysis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> suggests that partial model personalization can achieve most of the benefits of full model personalization with fewer shared parameters, offering advantages in terms of computation, communication, and privacy to enable the deployment of larger models on the clients.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">However, recent literature shows that <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">where</span> and <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">how</span> to perform partial model personalization has a high correlation to the model architectures and the tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, which requires further study when applied to a new architecture.
Despite the multitude of approaches proposed in the literature, the majority of methods have only been evaluated on Convolutional Neural Networks (CNNs). Meanwhile, Vision Transformers (ViTs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> have demonstrated superior performance compared to CNNs in several tasks, such as image classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> and object detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, making them an attractive option for personalized federated learning. However, to the best of our knowledge, the application of ViT in the federated learning community has received limited attention in the existing literature <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>.
Given the advantages of ViT shown under centralized training, it is reasonable to expect that these benefits can also be realized in PFL by offering a more robust model for improved performance on the clients.
Therefore, in this work, we investigate <span id="S1.p3.1.3" class="ltx_text ltx_font_italic">where</span> and <span id="S1.p3.1.4" class="ltx_text ltx_font_italic">how</span> to <span id="S1.p3.1.5" class="ltx_text ltx_font_italic">partially personalize</span> a <span id="S1.p3.1.6" class="ltx_text ltx_font_italic">ViT</span> model.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Drawing from previous research on CNNs, layers that serve specific engineering purposes, such as feature extraction, normalization, or classification, have been identified as suitable candidates for partial model personalization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
These layers might have a higher <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">sensitivity</span> to the distribution of the training data. Therefore, aggregating the model weights trained from different data distributions may result in an inaccurate feature, while
keeping them updated locally can gain a better feature for the local data distribution.
Similarly, we select some candidates from ViT and conduct an empirical study to investigate the sensitivity of each type of layer. Specifically, we quantitatively evaluate the impact of keeping certain layers updated locally without aggregation with other clients. This evaluation shows that the <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">self-attention layers</span> and the <span id="S1.p4.1.3" class="ltx_text ltx_font_italic">classification head</span> have a higher sensitivity than other layers, providing insights about <span id="S1.p4.1.4" class="ltx_text ltx_font_italic">where</span> to personalize.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To personalize the sensitive parts,
one intuitive approach is to keep them completely local.
However, the global aggregation has shown the capability to provide a more general global model than local models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. Completely preventing the sharing with the global model will severely hinder the potential benefits of leveraging general knowledge from the aggregated global model. Therefore, we desire to train a personalization module to <span id="S1.p5.1.1" class="ltx_text ltx_framed ltx_framed_underline">bridge the general knowledge and the client-specific knowledge.</span></p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">As existing works in transfer learning suggest,
the same pre-trained model can be transferred to different downstream data by adding different tiny architectures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. We refer to these tiny architectures as <span id="S1.p6.1.1" class="ltx_text ltx_font_italic">plugins</span> since they are small-sized parameters plugged into the pre-trained model. These plugins are trained while the weights of the pre-trained model are frozen. The plugged model can achieve comparable performance as the fully fine-tuned model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. Since the model can maintain the same level of performance without changing the weights of the pre-trained model, the downstream-specific knowledge is captured by the plugins. Therefore, the plugins show the capability to <span id="S1.p6.1.2" class="ltx_text ltx_font_italic">personalize</span> the same model to satisfy different downstream data.
In federated learning, <span id="S1.p6.1.3" class="ltx_text ltx_framed ltx_framed_underline">we can consider
the aggregated model as an inferior version of the “pre-trained” model, and the data on different clients as the downstream data</span>, as shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
With this perspective, we can therefore exploit the capability of the plugins in the federated learning context to capture client-specific knowledge for personalization.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">Therefore, we select and adapt a specific family of plugin, <span id="S1.p7.1.1" class="ltx_text ltx_font_italic">Prefixes</span>, to personalize the self-attention layer and propose a novel approach <span id="S1.p7.1.2" class="ltx_text ltx_font_bold">FedPerfix</span>, short for <span id="S1.p7.1.3" class="ltx_text ltx_font_bold">Fed</span>erated <span id="S1.p7.1.4" class="ltx_text ltx_font_bold">Per</span>sonalized Pre<span id="S1.p7.1.5" class="ltx_text ltx_font_bold">fix</span>-tuning.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2308.09160/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="379" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S1.F1.2.1" class="ltx_text ltx_font_bold">Analogy between transfer learning and personalized federated learning.</span> A pre-trained model can be transferred to different downstream data with different plugins. In personalized federated learning, we are seeking different personalization modules (PM) to transfer the aggregated model to different client data.</figcaption>
</figure>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">The main contributions of this paper are as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We perform an empirical study to reveal the sensitivity to data distribution of each type of layer in a ViT for PFL and locate the self-attention layer and classification head as the sensitive part to be personalized. (Section <a href="#S3.SS3" title="3.3 Empirical Study: Partial ViT Personalization ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>)</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a novel partial model personalization approach on ViT, FedPerfix, inspired by the connection between PFL and transfer learning. Specifically, we exploit Prefix plugins to capture client-specific knowledge for personalization. (Section <a href="#S3.SS5" title="3.5 FedPerfix: Stabilize the Prefix ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.5</span></a>)</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We conduct evaluations on CIFAR-100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, OrganAMINIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, and Office-home <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, which are across different domains, and degrees of data heterogeneity and achieve state-of-the-art performance compared with several competitive methods with lower resource requirements. (Section <a href="#S4.SS2" title="4.2 Performance Evaluation ‣ 4 Experiment ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>)
</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Personalized Federated Learning.</span>
Personalized Federated Learning focuses on training a client-specific model to achieve satisfying performance on each client instead of a unified global model to fit all the client data. In terms of the shared parameters, full model personalization keeps a separate personalized model for each client and designs different training objectives, where the global model is usually served as the regularization term <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. The training objectives are designed with the idea of meta-learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, Moreau Envelopes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, model interpolation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, decoupling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, <em id="S2.p1.1.2" class="ltx_emph ltx_font_italic">etc</em>. In contrast, partial model personalization focuses on personalizing some specific parameters inside a model.
Some works simply keep these parameters, <em id="S2.p1.1.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S2.p1.1.4" class="ltx_text"></span>, the classification head <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, and the batch normalization layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> updated locally, while some works design additional parameters, <em id="S2.p1.1.5" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S2.p1.1.6" class="ltx_text"></span>, prototypes for each class <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> or hypernetworks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, to further personalized these parameters. Our proposed method focuses on the self-attention layers in a ViT and leverages plugins in transfer learning, enabling personalization without introducing significant overhead. Our experimental results demonstrate that FedPerfix outperforms existing methods in terms of both efficiency and effectiveness.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Vision Transformer.</span>
ViTs, a type of attention-based neural network, have shown superior performance in several fields compared to CNNs. In particular, ViTs have achieved state-of-the-art performance on various benchmarks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>.
ViTs employ self-attention mechanisms to learn the dependencies between different regions of an image and can capture long-range dependencies more effectively than CNNs.
Despite their success, the use of ViTs in federated learning has not been as widely explored as CNNs. Qu <em id="S2.p2.1.2" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.3" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> studied the performance of ViT under conventional FL settings and found that simply replacing CNNs with ViTs can greatly accelerate convergence and reach a better global model, especially when dealing with heterogeneous data, demonstrating the potential of ViTs in FL.
In this paper, we extend the application of ViT to PFL and propose a novel approach to better personalize a ViT.
</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Parameter-efficient Fine-tuning and Plugins.</span>
Fine-tuning is a popular technique for adapting a pre-trained model to a new task.
However, fine-tuning can be computationally expensive, especially for large models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>. Parameter-efficient fine-tuning (PEFT) has been proposed to address this issue by selectively updating only a subset of the model’s parameters or a few added parameters. These added parameters are plugged into the pre-trained model; therefore, they are summarised as “Plugins” in this paper.
Although the location of the plugins for a transformer is various, including the input <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, the self-attention layer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, and the feed-forward network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, all of them can be trained to achieve comparable performance as fine-tuning without updating the weights of the pre-trained model.
The plugins have also been applied to conventional FL to enable large pre-trained models and reduce the communication cost <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>.
In the PFL,
inspired by analogy from fine-tuning to the local training, the plugins can similarly be employed to personalize the representation from the global model to the local data distribution. Based on our empirical study, we choose prefixes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> since the parameters are directly applied to the self-attention layer and propose our method, FedPerfix.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Formulation</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.11" class="ltx_p">We consider a classification problem in Computer Vision (CV).
A dataset <math id="S3.SS1.p1.1.m1.4" class="ltx_Math" alttext="\mathcal{D}=\{(x,y)|x\in X,y\in Y\}" display="inline"><semantics id="S3.SS1.p1.1.m1.4a"><mrow id="S3.SS1.p1.1.m1.4.4" xref="S3.SS1.p1.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.4.4.4" xref="S3.SS1.p1.1.m1.4.4.4.cmml">𝒟</mi><mo id="S3.SS1.p1.1.m1.4.4.3" xref="S3.SS1.p1.1.m1.4.4.3.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.4.4.2.2" xref="S3.SS1.p1.1.m1.4.4.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.4.4.2.2.3" xref="S3.SS1.p1.1.m1.4.4.2.3.1.cmml">{</mo><mrow id="S3.SS1.p1.1.m1.3.3.1.1.1.2" xref="S3.SS1.p1.1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.3.3.1.1.1.2.1" xref="S3.SS1.p1.1.m1.3.3.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">x</mi><mo id="S3.SS1.p1.1.m1.3.3.1.1.1.2.2" xref="S3.SS1.p1.1.m1.3.3.1.1.1.1.cmml">,</mo><mi id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.1.m1.3.3.1.1.1.2.3" xref="S3.SS1.p1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p1.1.m1.4.4.2.2.4" xref="S3.SS1.p1.1.m1.4.4.2.3.1.cmml">|</mo><mrow id="S3.SS1.p1.1.m1.4.4.2.2.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.3.cmml"><mrow id="S3.SS1.p1.1.m1.4.4.2.2.2.1.1" xref="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.cmml"><mi id="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.2.cmml">x</mi><mo id="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.1" xref="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.3" xref="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.3.cmml">X</mi></mrow><mo id="S3.SS1.p1.1.m1.4.4.2.2.2.2.3" xref="S3.SS1.p1.1.m1.4.4.2.2.2.3a.cmml">,</mo><mrow id="S3.SS1.p1.1.m1.4.4.2.2.2.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.2.cmml">y</mi><mo id="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.1" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.1.cmml">∈</mo><mi id="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.3" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.3.cmml">Y</mi></mrow></mrow><mo stretchy="false" id="S3.SS1.p1.1.m1.4.4.2.2.5" xref="S3.SS1.p1.1.m1.4.4.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.4b"><apply id="S3.SS1.p1.1.m1.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4"><eq id="S3.SS1.p1.1.m1.4.4.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3"></eq><ci id="S3.SS1.p1.1.m1.4.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4.4">𝒟</ci><apply id="S3.SS1.p1.1.m1.4.4.2.3.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2"><csymbol cd="latexml" id="S3.SS1.p1.1.m1.4.4.2.3.1.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.SS1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1.2"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑥</ci><ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">𝑦</ci></interval><apply id="S3.SS1.p1.1.m1.4.4.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.2.2.2.3a.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.1.1"><in id="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.1"></in><ci id="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.2">𝑥</ci><ci id="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.3.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.1.1.3">𝑋</ci></apply><apply id="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.2"><in id="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.1"></in><ci id="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.2.3">𝑌</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.4c">\mathcal{D}=\{(x,y)|x\in X,y\in Y\}</annotation></semantics></math> is separated on <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">N</annotation></semantics></math> clients, where <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">X</annotation></semantics></math> is the input space and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">Y</annotation></semantics></math> is the label space.
Data on each client is denoted as <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝒟</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathcal{D}_{i}</annotation></semantics></math>, and the distribution <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="P_{i}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">P</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑃</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">P_{i}</annotation></semantics></math>. The client distributions are not identical. Each client has access to <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="m_{i}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><msub id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">m</mi><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑚</ci><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">m_{i}</annotation></semantics></math> samples drawn IID from the distribution <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="P_{i}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">P</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝑃</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">P_{i}</annotation></semantics></math>. The total number of samples is <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="M=\sum_{i=1}^{N}m_{i}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">M</mi><mo rspace="0.111em" id="S3.SS1.p1.9.m9.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml"><msubsup id="S3.SS1.p1.9.m9.1.1.3.1" xref="S3.SS1.p1.9.m9.1.1.3.1.cmml"><mo id="S3.SS1.p1.9.m9.1.1.3.1.2.2" xref="S3.SS1.p1.9.m9.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p1.9.m9.1.1.3.1.2.3" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.cmml"><mi id="S3.SS1.p1.9.m9.1.1.3.1.2.3.2" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.SS1.p1.9.m9.1.1.3.1.2.3.1" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.9.m9.1.1.3.1.2.3.3" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.9.m9.1.1.3.1.3" xref="S3.SS1.p1.9.m9.1.1.3.1.3.cmml">N</mi></msubsup><msub id="S3.SS1.p1.9.m9.1.1.3.2" xref="S3.SS1.p1.9.m9.1.1.3.2.cmml"><mi id="S3.SS1.p1.9.m9.1.1.3.2.2" xref="S3.SS1.p1.9.m9.1.1.3.2.2.cmml">m</mi><mi id="S3.SS1.p1.9.m9.1.1.3.2.3" xref="S3.SS1.p1.9.m9.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><eq id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1"></eq><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝑀</ci><apply id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3"><apply id="S3.SS1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.3.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1">superscript</csymbol><apply id="S3.SS1.p1.9.m9.1.1.3.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.3.1.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1">subscript</csymbol><sum id="S3.SS1.p1.9.m9.1.1.3.1.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.2.2"></sum><apply id="S3.SS1.p1.9.m9.1.1.3.1.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3"><eq id="S3.SS1.p1.9.m9.1.1.3.1.2.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.1"></eq><ci id="S3.SS1.p1.9.m9.1.1.3.1.2.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p1.9.m9.1.1.3.1.2.3.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.9.m9.1.1.3.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.3">𝑁</ci></apply><apply id="S3.SS1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.3.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.3.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2.2">𝑚</ci><ci id="S3.SS1.p1.9.m9.1.1.3.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">M=\sum_{i=1}^{N}m_{i}</annotation></semantics></math>.
The hypothesis (model) on each client is noted as <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="h_{i}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><msub id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">h</mi><mi id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">ℎ</ci><ci id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">h_{i}</annotation></semantics></math>, and the expected loss on the <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="i^{\text{th}}" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><msup id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml">i</mi><mtext id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">superscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2">𝑖</ci><ci id="S3.SS1.p1.11.m11.1.1.3a.cmml" xref="S3.SS1.p1.11.m11.1.1.3"><mtext mathsize="70%" id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">i^{\text{th}}</annotation></semantics></math> client is denoted as</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.6" class="ltx_Math" alttext="\mathcal{L}_{\mathcal{D}_{i}}(h_{i})=\mathbb{E}_{(x,y)\sim P_{i}}[\ell(h(x),y)]" display="block"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml"><mrow id="S3.E1.m1.5.5.1" xref="S3.E1.m1.5.5.1.cmml"><msub id="S3.E1.m1.5.5.1.3" xref="S3.E1.m1.5.5.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.1.3.2" xref="S3.E1.m1.5.5.1.3.2.cmml">ℒ</mi><msub id="S3.E1.m1.5.5.1.3.3" xref="S3.E1.m1.5.5.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.1.3.3.2" xref="S3.E1.m1.5.5.1.3.3.2.cmml">𝒟</mi><mi id="S3.E1.m1.5.5.1.3.3.3" xref="S3.E1.m1.5.5.1.3.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.2" xref="S3.E1.m1.5.5.1.2.cmml">​</mo><mrow id="S3.E1.m1.5.5.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.5.5.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.2.cmml">h</mi><mi id="S3.E1.m1.5.5.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.3" xref="S3.E1.m1.6.6.3.cmml">=</mo><mrow id="S3.E1.m1.6.6.2" xref="S3.E1.m1.6.6.2.cmml"><msub id="S3.E1.m1.6.6.2.3" xref="S3.E1.m1.6.6.2.3.cmml"><mi id="S3.E1.m1.6.6.2.3.2" xref="S3.E1.m1.6.6.2.3.2.cmml">𝔼</mi><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mrow id="S3.E1.m1.2.2.2.4.2" xref="S3.E1.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.4.2.1" xref="S3.E1.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">x</mi><mo id="S3.E1.m1.2.2.2.4.2.2" xref="S3.E1.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E1.m1.2.2.2.4.2.3" xref="S3.E1.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">∼</mo><msub id="S3.E1.m1.2.2.2.5" xref="S3.E1.m1.2.2.2.5.cmml"><mi id="S3.E1.m1.2.2.2.5.2" xref="S3.E1.m1.2.2.2.5.2.cmml">P</mi><mi id="S3.E1.m1.2.2.2.5.3" xref="S3.E1.m1.2.2.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.2.2" xref="S3.E1.m1.6.6.2.2.cmml">​</mo><mrow id="S3.E1.m1.6.6.2.1.1" xref="S3.E1.m1.6.6.2.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.1.1.2" xref="S3.E1.m1.6.6.2.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.6.6.2.1.1.1" xref="S3.E1.m1.6.6.2.1.1.1.cmml"><mi mathvariant="normal" id="S3.E1.m1.6.6.2.1.1.1.3" xref="S3.E1.m1.6.6.2.1.1.1.3.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.2.1.1.1.2" xref="S3.E1.m1.6.6.2.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.6.6.2.1.1.1.1.1" xref="S3.E1.m1.6.6.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.1.1.1.1.1.2" xref="S3.E1.m1.6.6.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.E1.m1.6.6.2.1.1.1.1.1.1" xref="S3.E1.m1.6.6.2.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.2.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.2.1.1.1.1.1.1.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.2.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.2.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.6.6.2.1.1.1.1.1.1.3.2" xref="S3.E1.m1.6.6.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.1.1.1.1.1.1.3.2.1" xref="S3.E1.m1.6.6.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">x</mi><mo stretchy="false" id="S3.E1.m1.6.6.2.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.6.6.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.2.1.1.1.1.1.3" xref="S3.E1.m1.6.6.2.1.1.1.1.2.cmml">,</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">y</mi><mo stretchy="false" id="S3.E1.m1.6.6.2.1.1.1.1.1.4" xref="S3.E1.m1.6.6.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m1.6.6.2.1.1.3" xref="S3.E1.m1.6.6.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><eq id="S3.E1.m1.6.6.3.cmml" xref="S3.E1.m1.6.6.3"></eq><apply id="S3.E1.m1.5.5.1.cmml" xref="S3.E1.m1.5.5.1"><times id="S3.E1.m1.5.5.1.2.cmml" xref="S3.E1.m1.5.5.1.2"></times><apply id="S3.E1.m1.5.5.1.3.cmml" xref="S3.E1.m1.5.5.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.3.1.cmml" xref="S3.E1.m1.5.5.1.3">subscript</csymbol><ci id="S3.E1.m1.5.5.1.3.2.cmml" xref="S3.E1.m1.5.5.1.3.2">ℒ</ci><apply id="S3.E1.m1.5.5.1.3.3.cmml" xref="S3.E1.m1.5.5.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.3.3.1.cmml" xref="S3.E1.m1.5.5.1.3.3">subscript</csymbol><ci id="S3.E1.m1.5.5.1.3.3.2.cmml" xref="S3.E1.m1.5.5.1.3.3.2">𝒟</ci><ci id="S3.E1.m1.5.5.1.3.3.3.cmml" xref="S3.E1.m1.5.5.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.5.5.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2">ℎ</ci><ci id="S3.E1.m1.5.5.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.6.6.2.cmml" xref="S3.E1.m1.6.6.2"><times id="S3.E1.m1.6.6.2.2.cmml" xref="S3.E1.m1.6.6.2.2"></times><apply id="S3.E1.m1.6.6.2.3.cmml" xref="S3.E1.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.3.1.cmml" xref="S3.E1.m1.6.6.2.3">subscript</csymbol><ci id="S3.E1.m1.6.6.2.3.2.cmml" xref="S3.E1.m1.6.6.2.3.2">𝔼</ci><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><csymbol cd="latexml" id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E1.m1.2.2.2.4.1.cmml" xref="S3.E1.m1.2.2.2.4.2"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑥</ci><ci id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E1.m1.2.2.2.5.cmml" xref="S3.E1.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.5.1.cmml" xref="S3.E1.m1.2.2.2.5">subscript</csymbol><ci id="S3.E1.m1.2.2.2.5.2.cmml" xref="S3.E1.m1.2.2.2.5.2">𝑃</ci><ci id="S3.E1.m1.2.2.2.5.3.cmml" xref="S3.E1.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.E1.m1.6.6.2.1.2.cmml" xref="S3.E1.m1.6.6.2.1.1"><csymbol cd="latexml" id="S3.E1.m1.6.6.2.1.2.1.cmml" xref="S3.E1.m1.6.6.2.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.6.6.2.1.1.1.cmml" xref="S3.E1.m1.6.6.2.1.1.1"><times id="S3.E1.m1.6.6.2.1.1.1.2.cmml" xref="S3.E1.m1.6.6.2.1.1.1.2"></times><ci id="S3.E1.m1.6.6.2.1.1.1.3.cmml" xref="S3.E1.m1.6.6.2.1.1.1.3">ℓ</ci><interval closure="open" id="S3.E1.m1.6.6.2.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.1"><apply id="S3.E1.m1.6.6.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.1.1"><times id="S3.E1.m1.6.6.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.1.1.1"></times><ci id="S3.E1.m1.6.6.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑥</ci></apply><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">\mathcal{L}_{\mathcal{D}_{i}}(h_{i})=\mathbb{E}_{(x,y)\sim P_{i}}[\ell(h(x),y)]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.16" class="ltx_p">where <math id="S3.SS1.p1.12.m1.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.SS1.p1.12.m1.1a"><mi mathvariant="normal" id="S3.SS1.p1.12.m1.1.1" xref="S3.SS1.p1.12.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m1.1b"><ci id="S3.SS1.p1.12.m1.1.1.cmml" xref="S3.SS1.p1.12.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m1.1c">\ell</annotation></semantics></math> is the loss function.
Further, considering the <span id="S3.SS1.p1.16.1" class="ltx_text ltx_font_italic">partial model personalization</span>, the parameters in each client model can be divided into two parts: global parameters <math id="S3.SS1.p1.13.m2.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S3.SS1.p1.13.m2.1a"><mi id="S3.SS1.p1.13.m2.1.1" xref="S3.SS1.p1.13.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m2.1b"><ci id="S3.SS1.p1.13.m2.1.1.cmml" xref="S3.SS1.p1.13.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m2.1c">u</annotation></semantics></math> and local parameters <math id="S3.SS1.p1.14.m3.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.SS1.p1.14.m3.1a"><msub id="S3.SS1.p1.14.m3.1.1" xref="S3.SS1.p1.14.m3.1.1.cmml"><mi id="S3.SS1.p1.14.m3.1.1.2" xref="S3.SS1.p1.14.m3.1.1.2.cmml">v</mi><mi id="S3.SS1.p1.14.m3.1.1.3" xref="S3.SS1.p1.14.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m3.1b"><apply id="S3.SS1.p1.14.m3.1.1.cmml" xref="S3.SS1.p1.14.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m3.1.1.1.cmml" xref="S3.SS1.p1.14.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m3.1.1.2.cmml" xref="S3.SS1.p1.14.m3.1.1.2">𝑣</ci><ci id="S3.SS1.p1.14.m3.1.1.3.cmml" xref="S3.SS1.p1.14.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m3.1c">v_{i}</annotation></semantics></math>, i.e., <math id="S3.SS1.p1.15.m4.1" class="ltx_Math" alttext="h_{i}=u\cup v_{i}" display="inline"><semantics id="S3.SS1.p1.15.m4.1a"><mrow id="S3.SS1.p1.15.m4.1.1" xref="S3.SS1.p1.15.m4.1.1.cmml"><msub id="S3.SS1.p1.15.m4.1.1.2" xref="S3.SS1.p1.15.m4.1.1.2.cmml"><mi id="S3.SS1.p1.15.m4.1.1.2.2" xref="S3.SS1.p1.15.m4.1.1.2.2.cmml">h</mi><mi id="S3.SS1.p1.15.m4.1.1.2.3" xref="S3.SS1.p1.15.m4.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.15.m4.1.1.1" xref="S3.SS1.p1.15.m4.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.15.m4.1.1.3" xref="S3.SS1.p1.15.m4.1.1.3.cmml"><mi id="S3.SS1.p1.15.m4.1.1.3.2" xref="S3.SS1.p1.15.m4.1.1.3.2.cmml">u</mi><mo id="S3.SS1.p1.15.m4.1.1.3.1" xref="S3.SS1.p1.15.m4.1.1.3.1.cmml">∪</mo><msub id="S3.SS1.p1.15.m4.1.1.3.3" xref="S3.SS1.p1.15.m4.1.1.3.3.cmml"><mi id="S3.SS1.p1.15.m4.1.1.3.3.2" xref="S3.SS1.p1.15.m4.1.1.3.3.2.cmml">v</mi><mi id="S3.SS1.p1.15.m4.1.1.3.3.3" xref="S3.SS1.p1.15.m4.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m4.1b"><apply id="S3.SS1.p1.15.m4.1.1.cmml" xref="S3.SS1.p1.15.m4.1.1"><eq id="S3.SS1.p1.15.m4.1.1.1.cmml" xref="S3.SS1.p1.15.m4.1.1.1"></eq><apply id="S3.SS1.p1.15.m4.1.1.2.cmml" xref="S3.SS1.p1.15.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m4.1.1.2.1.cmml" xref="S3.SS1.p1.15.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.15.m4.1.1.2.2.cmml" xref="S3.SS1.p1.15.m4.1.1.2.2">ℎ</ci><ci id="S3.SS1.p1.15.m4.1.1.2.3.cmml" xref="S3.SS1.p1.15.m4.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.15.m4.1.1.3.cmml" xref="S3.SS1.p1.15.m4.1.1.3"><union id="S3.SS1.p1.15.m4.1.1.3.1.cmml" xref="S3.SS1.p1.15.m4.1.1.3.1"></union><ci id="S3.SS1.p1.15.m4.1.1.3.2.cmml" xref="S3.SS1.p1.15.m4.1.1.3.2">𝑢</ci><apply id="S3.SS1.p1.15.m4.1.1.3.3.cmml" xref="S3.SS1.p1.15.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m4.1.1.3.3.1.cmml" xref="S3.SS1.p1.15.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.15.m4.1.1.3.3.2.cmml" xref="S3.SS1.p1.15.m4.1.1.3.3.2">𝑣</ci><ci id="S3.SS1.p1.15.m4.1.1.3.3.3.cmml" xref="S3.SS1.p1.15.m4.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m4.1c">h_{i}=u\cup v_{i}</annotation></semantics></math>. Specifically, <math id="S3.SS1.p1.16.m5.1" class="ltx_Math" alttext="v_{i}=\varnothing" display="inline"><semantics id="S3.SS1.p1.16.m5.1a"><mrow id="S3.SS1.p1.16.m5.1.1" xref="S3.SS1.p1.16.m5.1.1.cmml"><msub id="S3.SS1.p1.16.m5.1.1.2" xref="S3.SS1.p1.16.m5.1.1.2.cmml"><mi id="S3.SS1.p1.16.m5.1.1.2.2" xref="S3.SS1.p1.16.m5.1.1.2.2.cmml">v</mi><mi id="S3.SS1.p1.16.m5.1.1.2.3" xref="S3.SS1.p1.16.m5.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.16.m5.1.1.1" xref="S3.SS1.p1.16.m5.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S3.SS1.p1.16.m5.1.1.3" xref="S3.SS1.p1.16.m5.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m5.1b"><apply id="S3.SS1.p1.16.m5.1.1.cmml" xref="S3.SS1.p1.16.m5.1.1"><eq id="S3.SS1.p1.16.m5.1.1.1.cmml" xref="S3.SS1.p1.16.m5.1.1.1"></eq><apply id="S3.SS1.p1.16.m5.1.1.2.cmml" xref="S3.SS1.p1.16.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m5.1.1.2.1.cmml" xref="S3.SS1.p1.16.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.16.m5.1.1.2.2.cmml" xref="S3.SS1.p1.16.m5.1.1.2.2">𝑣</ci><ci id="S3.SS1.p1.16.m5.1.1.2.3.cmml" xref="S3.SS1.p1.16.m5.1.1.2.3">𝑖</ci></apply><emptyset id="S3.SS1.p1.16.m5.1.1.3.cmml" xref="S3.SS1.p1.16.m5.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m5.1c">v_{i}=\varnothing</annotation></semantics></math> indicates <span id="S3.SS1.p1.16.2" class="ltx_text ltx_font_italic">full model personalization</span>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.8" class="ltx_p">In each communication round <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="t\in[T]" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.2" xref="S3.SS1.p2.1.m1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.2.2" xref="S3.SS1.p2.1.m1.1.2.2.cmml">t</mi><mo id="S3.SS1.p2.1.m1.1.2.1" xref="S3.SS1.p2.1.m1.1.2.1.cmml">∈</mo><mrow id="S3.SS1.p2.1.m1.1.2.3.2" xref="S3.SS1.p2.1.m1.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.1.2.3.2.1" xref="S3.SS1.p2.1.m1.1.2.3.1.1.cmml">[</mo><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">T</mi><mo stretchy="false" id="S3.SS1.p2.1.m1.1.2.3.2.2" xref="S3.SS1.p2.1.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.2"><in id="S3.SS1.p2.1.m1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.2.1"></in><ci id="S3.SS1.p2.1.m1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.2.2">𝑡</ci><apply id="S3.SS1.p2.1.m1.1.2.3.1.cmml" xref="S3.SS1.p2.1.m1.1.2.3.2"><csymbol cd="latexml" id="S3.SS1.p2.1.m1.1.2.3.1.1.cmml" xref="S3.SS1.p2.1.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">t\in[T]</annotation></semantics></math>, each client will receive <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="u^{(t-1)}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msup id="S3.SS1.p2.2.m2.1.2" xref="S3.SS1.p2.2.m2.1.2.cmml"><mi id="S3.SS1.p2.2.m2.1.2.2" xref="S3.SS1.p2.2.m2.1.2.2.cmml">u</mi><mrow id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p2.2.m2.1.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS1.p2.2.m2.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.2.cmml" xref="S3.SS1.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.2">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.2.2">𝑢</ci><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><minus id="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1"></minus><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">u^{(t-1)}</annotation></semantics></math> from the server and plug <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="v_{i}^{(t-1)}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msubsup id="S3.SS1.p2.3.m3.1.2" xref="S3.SS1.p2.3.m3.1.2.cmml"><mi id="S3.SS1.p2.3.m3.1.2.2.2" xref="S3.SS1.p2.3.m3.1.2.2.2.cmml">v</mi><mi id="S3.SS1.p2.3.m3.1.2.2.3" xref="S3.SS1.p2.3.m3.1.2.2.3.cmml">i</mi><mrow id="S3.SS1.p2.3.m3.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.1.1.1.1.2" xref="S3.SS1.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.3.m3.1.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.1.1.1.2" xref="S3.SS1.p2.3.m3.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p2.3.m3.1.1.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS1.p2.3.m3.1.1.1.1.1.3" xref="S3.SS1.p2.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS1.p2.3.m3.1.1.1.1.3" xref="S3.SS1.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.2.cmml" xref="S3.SS1.p2.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.2">superscript</csymbol><apply id="S3.SS1.p2.3.m3.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.2.2.1.cmml" xref="S3.SS1.p2.3.m3.1.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.2.2.2.cmml" xref="S3.SS1.p2.3.m3.1.2.2.2">𝑣</ci><ci id="S3.SS1.p2.3.m3.1.2.2.3.cmml" xref="S3.SS1.p2.3.m3.1.2.2.3">𝑖</ci></apply><apply id="S3.SS1.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1"><minus id="S3.SS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1"></minus><ci id="S3.SS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">v_{i}^{(t-1)}</annotation></semantics></math> into <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="u^{(t-1)}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><msup id="S3.SS1.p2.4.m4.1.2" xref="S3.SS1.p2.4.m4.1.2.cmml"><mi id="S3.SS1.p2.4.m4.1.2.2" xref="S3.SS1.p2.4.m4.1.2.2.cmml">u</mi><mrow id="S3.SS1.p2.4.m4.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.1.1.1.1.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.4.m4.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p2.4.m4.1.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS1.p2.4.m4.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS1.p2.4.m4.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.2.cmml" xref="S3.SS1.p2.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.2">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.2.2">𝑢</ci><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1"><minus id="S3.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1"></minus><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">u^{(t-1)}</annotation></semantics></math>. Then,
<math id="S3.SS1.p2.5.m5.4" class="ltx_Math" alttext="u_{i}^{(t)},v_{i}^{(t)}" display="inline"><semantics id="S3.SS1.p2.5.m5.4a"><mrow id="S3.SS1.p2.5.m5.4.4.2" xref="S3.SS1.p2.5.m5.4.4.3.cmml"><msubsup id="S3.SS1.p2.5.m5.3.3.1.1" xref="S3.SS1.p2.5.m5.3.3.1.1.cmml"><mi id="S3.SS1.p2.5.m5.3.3.1.1.2.2" xref="S3.SS1.p2.5.m5.3.3.1.1.2.2.cmml">u</mi><mi id="S3.SS1.p2.5.m5.3.3.1.1.2.3" xref="S3.SS1.p2.5.m5.3.3.1.1.2.3.cmml">i</mi><mrow id="S3.SS1.p2.5.m5.1.1.1.3" xref="S3.SS1.p2.5.m5.3.3.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.3.1" xref="S3.SS1.p2.5.m5.3.3.1.1.cmml">(</mo><mi id="S3.SS1.p2.5.m5.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.3.2" xref="S3.SS1.p2.5.m5.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS1.p2.5.m5.4.4.2.3" xref="S3.SS1.p2.5.m5.4.4.3.cmml">,</mo><msubsup id="S3.SS1.p2.5.m5.4.4.2.2" xref="S3.SS1.p2.5.m5.4.4.2.2.cmml"><mi id="S3.SS1.p2.5.m5.4.4.2.2.2.2" xref="S3.SS1.p2.5.m5.4.4.2.2.2.2.cmml">v</mi><mi id="S3.SS1.p2.5.m5.4.4.2.2.2.3" xref="S3.SS1.p2.5.m5.4.4.2.2.2.3.cmml">i</mi><mrow id="S3.SS1.p2.5.m5.2.2.1.3" xref="S3.SS1.p2.5.m5.4.4.2.2.cmml"><mo stretchy="false" id="S3.SS1.p2.5.m5.2.2.1.3.1" xref="S3.SS1.p2.5.m5.4.4.2.2.cmml">(</mo><mi id="S3.SS1.p2.5.m5.2.2.1.1" xref="S3.SS1.p2.5.m5.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.p2.5.m5.2.2.1.3.2" xref="S3.SS1.p2.5.m5.4.4.2.2.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.4b"><list id="S3.SS1.p2.5.m5.4.4.3.cmml" xref="S3.SS1.p2.5.m5.4.4.2"><apply id="S3.SS1.p2.5.m5.3.3.1.1.cmml" xref="S3.SS1.p2.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.3.3.1.1.1.cmml" xref="S3.SS1.p2.5.m5.3.3.1.1">superscript</csymbol><apply id="S3.SS1.p2.5.m5.3.3.1.1.2.cmml" xref="S3.SS1.p2.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.3.3.1.1.2.1.cmml" xref="S3.SS1.p2.5.m5.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.3.3.1.1.2.2.cmml" xref="S3.SS1.p2.5.m5.3.3.1.1.2.2">𝑢</ci><ci id="S3.SS1.p2.5.m5.3.3.1.1.2.3.cmml" xref="S3.SS1.p2.5.m5.3.3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.5.m5.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1">𝑡</ci></apply><apply id="S3.SS1.p2.5.m5.4.4.2.2.cmml" xref="S3.SS1.p2.5.m5.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.4.4.2.2.1.cmml" xref="S3.SS1.p2.5.m5.4.4.2.2">superscript</csymbol><apply id="S3.SS1.p2.5.m5.4.4.2.2.2.cmml" xref="S3.SS1.p2.5.m5.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.4.4.2.2.2.1.cmml" xref="S3.SS1.p2.5.m5.4.4.2.2">subscript</csymbol><ci id="S3.SS1.p2.5.m5.4.4.2.2.2.2.cmml" xref="S3.SS1.p2.5.m5.4.4.2.2.2.2">𝑣</ci><ci id="S3.SS1.p2.5.m5.4.4.2.2.2.3.cmml" xref="S3.SS1.p2.5.m5.4.4.2.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.5.m5.2.2.1.1.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.4c">u_{i}^{(t)},v_{i}^{(t)}</annotation></semantics></math> are trained on the local data.
After the local training,
only the <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="u_{i}^{(t)}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msubsup id="S3.SS1.p2.6.m6.1.2" xref="S3.SS1.p2.6.m6.1.2.cmml"><mi id="S3.SS1.p2.6.m6.1.2.2.2" xref="S3.SS1.p2.6.m6.1.2.2.2.cmml">u</mi><mi id="S3.SS1.p2.6.m6.1.2.2.3" xref="S3.SS1.p2.6.m6.1.2.2.3.cmml">i</mi><mrow id="S3.SS1.p2.6.m6.1.1.1.3" xref="S3.SS1.p2.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.6.m6.1.1.1.3.1" xref="S3.SS1.p2.6.m6.1.2.cmml">(</mo><mi id="S3.SS1.p2.6.m6.1.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.p2.6.m6.1.1.1.3.2" xref="S3.SS1.p2.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.2.cmml" xref="S3.SS1.p2.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.2.1.cmml" xref="S3.SS1.p2.6.m6.1.2">superscript</csymbol><apply id="S3.SS1.p2.6.m6.1.2.2.cmml" xref="S3.SS1.p2.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.2.2.1.cmml" xref="S3.SS1.p2.6.m6.1.2">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.2.2.2.cmml" xref="S3.SS1.p2.6.m6.1.2.2.2">𝑢</ci><ci id="S3.SS1.p2.6.m6.1.2.2.3.cmml" xref="S3.SS1.p2.6.m6.1.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.6.m6.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">u_{i}^{(t)}</annotation></semantics></math> of <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">K</annotation></semantics></math> sampled clients will be sent to the server and participate in the global aggregation. The sampled ratio (client participation rate) is denoted as <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="r=K/N" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mrow id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">r</mi><mo id="S3.SS1.p2.8.m8.1.1.1" xref="S3.SS1.p2.8.m8.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml"><mi id="S3.SS1.p2.8.m8.1.1.3.2" xref="S3.SS1.p2.8.m8.1.1.3.2.cmml">K</mi><mo id="S3.SS1.p2.8.m8.1.1.3.1" xref="S3.SS1.p2.8.m8.1.1.3.1.cmml">/</mo><mi id="S3.SS1.p2.8.m8.1.1.3.3" xref="S3.SS1.p2.8.m8.1.1.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><eq id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.1"></eq><ci id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">𝑟</ci><apply id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3"><divide id="S3.SS1.p2.8.m8.1.1.3.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.1"></divide><ci id="S3.SS1.p2.8.m8.1.1.3.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2">𝐾</ci><ci id="S3.SS1.p2.8.m8.1.1.3.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">r=K/N</annotation></semantics></math>.
The global aggregation is formulated as</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="u^{(t)}=\sum_{i=1}^{K}\alpha_{i}u_{i}^{(t)}" display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.3" xref="S3.E2.m1.2.3.cmml"><msup id="S3.E2.m1.2.3.2" xref="S3.E2.m1.2.3.2.cmml"><mi id="S3.E2.m1.2.3.2.2" xref="S3.E2.m1.2.3.2.2.cmml">u</mi><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.2.3.2.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.3.1" xref="S3.E2.m1.2.3.2.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.2.3.2.cmml">)</mo></mrow></msup><mo rspace="0.111em" id="S3.E2.m1.2.3.1" xref="S3.E2.m1.2.3.1.cmml">=</mo><mrow id="S3.E2.m1.2.3.3" xref="S3.E2.m1.2.3.3.cmml"><munderover id="S3.E2.m1.2.3.3.1" xref="S3.E2.m1.2.3.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.2.3.3.1.2.2" xref="S3.E2.m1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.2.3.3.1.2.3" xref="S3.E2.m1.2.3.3.1.2.3.cmml"><mi id="S3.E2.m1.2.3.3.1.2.3.2" xref="S3.E2.m1.2.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E2.m1.2.3.3.1.2.3.1" xref="S3.E2.m1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.2.3.3.1.2.3.3" xref="S3.E2.m1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.2.3.3.1.3" xref="S3.E2.m1.2.3.3.1.3.cmml">K</mi></munderover><mrow id="S3.E2.m1.2.3.3.2" xref="S3.E2.m1.2.3.3.2.cmml"><msub id="S3.E2.m1.2.3.3.2.2" xref="S3.E2.m1.2.3.3.2.2.cmml"><mi id="S3.E2.m1.2.3.3.2.2.2" xref="S3.E2.m1.2.3.3.2.2.2.cmml">α</mi><mi id="S3.E2.m1.2.3.3.2.2.3" xref="S3.E2.m1.2.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.3.3.2.1" xref="S3.E2.m1.2.3.3.2.1.cmml">​</mo><msubsup id="S3.E2.m1.2.3.3.2.3" xref="S3.E2.m1.2.3.3.2.3.cmml"><mi id="S3.E2.m1.2.3.3.2.3.2.2" xref="S3.E2.m1.2.3.3.2.3.2.2.cmml">u</mi><mi id="S3.E2.m1.2.3.3.2.3.2.3" xref="S3.E2.m1.2.3.3.2.3.2.3.cmml">i</mi><mrow id="S3.E2.m1.2.2.1.3" xref="S3.E2.m1.2.3.3.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.3.1" xref="S3.E2.m1.2.3.3.2.3.cmml">(</mo><mi id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S3.E2.m1.2.2.1.3.2" xref="S3.E2.m1.2.3.3.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.3.cmml" xref="S3.E2.m1.2.3"><eq id="S3.E2.m1.2.3.1.cmml" xref="S3.E2.m1.2.3.1"></eq><apply id="S3.E2.m1.2.3.2.cmml" xref="S3.E2.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.2.1.cmml" xref="S3.E2.m1.2.3.2">superscript</csymbol><ci id="S3.E2.m1.2.3.2.2.cmml" xref="S3.E2.m1.2.3.2.2">𝑢</ci><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑡</ci></apply><apply id="S3.E2.m1.2.3.3.cmml" xref="S3.E2.m1.2.3.3"><apply id="S3.E2.m1.2.3.3.1.cmml" xref="S3.E2.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.1.1.cmml" xref="S3.E2.m1.2.3.3.1">superscript</csymbol><apply id="S3.E2.m1.2.3.3.1.2.cmml" xref="S3.E2.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.1.2.1.cmml" xref="S3.E2.m1.2.3.3.1">subscript</csymbol><sum id="S3.E2.m1.2.3.3.1.2.2.cmml" xref="S3.E2.m1.2.3.3.1.2.2"></sum><apply id="S3.E2.m1.2.3.3.1.2.3.cmml" xref="S3.E2.m1.2.3.3.1.2.3"><eq id="S3.E2.m1.2.3.3.1.2.3.1.cmml" xref="S3.E2.m1.2.3.3.1.2.3.1"></eq><ci id="S3.E2.m1.2.3.3.1.2.3.2.cmml" xref="S3.E2.m1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.2.3.3.1.2.3.3.cmml" xref="S3.E2.m1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.2.3.3.1.3.cmml" xref="S3.E2.m1.2.3.3.1.3">𝐾</ci></apply><apply id="S3.E2.m1.2.3.3.2.cmml" xref="S3.E2.m1.2.3.3.2"><times id="S3.E2.m1.2.3.3.2.1.cmml" xref="S3.E2.m1.2.3.3.2.1"></times><apply id="S3.E2.m1.2.3.3.2.2.cmml" xref="S3.E2.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.2.2.1.cmml" xref="S3.E2.m1.2.3.3.2.2">subscript</csymbol><ci id="S3.E2.m1.2.3.3.2.2.2.cmml" xref="S3.E2.m1.2.3.3.2.2.2">𝛼</ci><ci id="S3.E2.m1.2.3.3.2.2.3.cmml" xref="S3.E2.m1.2.3.3.2.2.3">𝑖</ci></apply><apply id="S3.E2.m1.2.3.3.2.3.cmml" xref="S3.E2.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.2.3.1.cmml" xref="S3.E2.m1.2.3.3.2.3">superscript</csymbol><apply id="S3.E2.m1.2.3.3.2.3.2.cmml" xref="S3.E2.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.2.3.2.1.cmml" xref="S3.E2.m1.2.3.3.2.3">subscript</csymbol><ci id="S3.E2.m1.2.3.3.2.3.2.2.cmml" xref="S3.E2.m1.2.3.3.2.3.2.2">𝑢</ci><ci id="S3.E2.m1.2.3.3.2.3.2.3.cmml" xref="S3.E2.m1.2.3.3.2.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">u^{(t)}=\sum_{i=1}^{K}\alpha_{i}u_{i}^{(t)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.12" class="ltx_p">where <math id="S3.SS1.p2.9.m1.1" class="ltx_Math" alttext="\alpha_{i}" display="inline"><semantics id="S3.SS1.p2.9.m1.1a"><msub id="S3.SS1.p2.9.m1.1.1" xref="S3.SS1.p2.9.m1.1.1.cmml"><mi id="S3.SS1.p2.9.m1.1.1.2" xref="S3.SS1.p2.9.m1.1.1.2.cmml">α</mi><mi id="S3.SS1.p2.9.m1.1.1.3" xref="S3.SS1.p2.9.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m1.1b"><apply id="S3.SS1.p2.9.m1.1.1.cmml" xref="S3.SS1.p2.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m1.1.1.1.cmml" xref="S3.SS1.p2.9.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.9.m1.1.1.2.cmml" xref="S3.SS1.p2.9.m1.1.1.2">𝛼</ci><ci id="S3.SS1.p2.9.m1.1.1.3.cmml" xref="S3.SS1.p2.9.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m1.1c">\alpha_{i}</annotation></semantics></math> is the aggregation coefficient. Federated Averaging (FedAVG) is the most common aggregation algorithm where <math id="S3.SS1.p2.10.m2.1" class="ltx_Math" alttext="\alpha_{i}=\frac{m_{i}}{M}" display="inline"><semantics id="S3.SS1.p2.10.m2.1a"><mrow id="S3.SS1.p2.10.m2.1.1" xref="S3.SS1.p2.10.m2.1.1.cmml"><msub id="S3.SS1.p2.10.m2.1.1.2" xref="S3.SS1.p2.10.m2.1.1.2.cmml"><mi id="S3.SS1.p2.10.m2.1.1.2.2" xref="S3.SS1.p2.10.m2.1.1.2.2.cmml">α</mi><mi id="S3.SS1.p2.10.m2.1.1.2.3" xref="S3.SS1.p2.10.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p2.10.m2.1.1.1" xref="S3.SS1.p2.10.m2.1.1.1.cmml">=</mo><mfrac id="S3.SS1.p2.10.m2.1.1.3" xref="S3.SS1.p2.10.m2.1.1.3.cmml"><msub id="S3.SS1.p2.10.m2.1.1.3.2" xref="S3.SS1.p2.10.m2.1.1.3.2.cmml"><mi id="S3.SS1.p2.10.m2.1.1.3.2.2" xref="S3.SS1.p2.10.m2.1.1.3.2.2.cmml">m</mi><mi id="S3.SS1.p2.10.m2.1.1.3.2.3" xref="S3.SS1.p2.10.m2.1.1.3.2.3.cmml">i</mi></msub><mi id="S3.SS1.p2.10.m2.1.1.3.3" xref="S3.SS1.p2.10.m2.1.1.3.3.cmml">M</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m2.1b"><apply id="S3.SS1.p2.10.m2.1.1.cmml" xref="S3.SS1.p2.10.m2.1.1"><eq id="S3.SS1.p2.10.m2.1.1.1.cmml" xref="S3.SS1.p2.10.m2.1.1.1"></eq><apply id="S3.SS1.p2.10.m2.1.1.2.cmml" xref="S3.SS1.p2.10.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m2.1.1.2.1.cmml" xref="S3.SS1.p2.10.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.10.m2.1.1.2.2.cmml" xref="S3.SS1.p2.10.m2.1.1.2.2">𝛼</ci><ci id="S3.SS1.p2.10.m2.1.1.2.3.cmml" xref="S3.SS1.p2.10.m2.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p2.10.m2.1.1.3.cmml" xref="S3.SS1.p2.10.m2.1.1.3"><divide id="S3.SS1.p2.10.m2.1.1.3.1.cmml" xref="S3.SS1.p2.10.m2.1.1.3"></divide><apply id="S3.SS1.p2.10.m2.1.1.3.2.cmml" xref="S3.SS1.p2.10.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m2.1.1.3.2.1.cmml" xref="S3.SS1.p2.10.m2.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p2.10.m2.1.1.3.2.2.cmml" xref="S3.SS1.p2.10.m2.1.1.3.2.2">𝑚</ci><ci id="S3.SS1.p2.10.m2.1.1.3.2.3.cmml" xref="S3.SS1.p2.10.m2.1.1.3.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.10.m2.1.1.3.3.cmml" xref="S3.SS1.p2.10.m2.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m2.1c">\alpha_{i}=\frac{m_{i}}{M}</annotation></semantics></math>. After <math id="S3.SS1.p2.11.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p2.11.m3.1a"><mi id="S3.SS1.p2.11.m3.1.1" xref="S3.SS1.p2.11.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m3.1b"><ci id="S3.SS1.p2.11.m3.1.1.cmml" xref="S3.SS1.p2.11.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m3.1c">T</annotation></semantics></math> rounds of communication, each client model will receive a copy of the newest global parameters and plug its own local parameters into the global parameters. Then, the model will be evaluated on its own test data drawn IID from <math id="S3.SS1.p2.12.m4.1" class="ltx_Math" alttext="P_{i}" display="inline"><semantics id="S3.SS1.p2.12.m4.1a"><msub id="S3.SS1.p2.12.m4.1.1" xref="S3.SS1.p2.12.m4.1.1.cmml"><mi id="S3.SS1.p2.12.m4.1.1.2" xref="S3.SS1.p2.12.m4.1.1.2.cmml">P</mi><mi id="S3.SS1.p2.12.m4.1.1.3" xref="S3.SS1.p2.12.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m4.1b"><apply id="S3.SS1.p2.12.m4.1.1.cmml" xref="S3.SS1.p2.12.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m4.1.1.1.cmml" xref="S3.SS1.p2.12.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.12.m4.1.1.2.cmml" xref="S3.SS1.p2.12.m4.1.1.2">𝑃</ci><ci id="S3.SS1.p2.12.m4.1.1.3.cmml" xref="S3.SS1.p2.12.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m4.1c">P_{i}</annotation></semantics></math>.
To assess the overall performance, the mean and standard deviation of the <span id="S3.SS1.p2.12.1" class="ltx_text ltx_font_bold">Top-1 classification accuracy (Acc)</span> for all clients will be reported.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Recap: Partial Model Personalization for CNN</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">In this section, we provide a brief recap of the approaches for partial model personalization in CNNs.
We aim to leverage the insights and experiences gained from previous research to explore the strategy to personalize ViTs partially.
</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p"><span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_bold">FedRep <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite></span>
is a partial model personalization method that aims to preserve client-specific information while leveraging common knowledge in the earlier layers of a CNN by keeping the last classification layer and a few blocks local and aggregating the rest.
<span id="S3.SS2.p2.1.2" class="ltx_text ltx_font_bold">FedBN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite></span>
is a partial model personalization method that updates Batch normalization (BN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> layers locally while aggregating the rest of the model. This method leverages the local statistics of the BN layer to adapt to the data distribution of each client while maintaining a global representation of the model, achieving a better balance between personalization and global representation.
<span id="S3.SS2.p2.1.3" class="ltx_text ltx_font_bold">FedBABU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> </span>
focuses on personalizing the classification head to address the issue of inconsistent feature spaces among clients. Unlike FedRep, FedBABU freezes the classification head and fine-tunes it for several steps before evaluation. By doing so, FedBABU can mitigate the negative impact of classification head drift and encourage consistent feature spaces across all clients.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">In summary, previous approaches to partial model personalization for CNNs provide valuable insights to answer the “where to personalize” question for ViTs: The layers to be personalized are usually designed with some engineering purpose, thus, are sensitive to data distribution. For instance, the normalization layers are designed to capture the statistical characters of the data, while classification heads are designed to map the feature to a predicted class.
Building on these insights, we group the layers in ViT by their engineering purpose and conduct an empirical study to determine the layers in ViT that are the most sensitive to data distribution. We evaluated the performance of ViT while keeping some specific types of layers updated locally without aggregating with other clients. The results of our study are presented in Section <a href="#S3.SS3" title="3.3 Empirical Study: Partial ViT Personalization ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span><span id="S3.T1.25.1" class="ltx_text ltx_font_bold">Sensitivity to data distribution of each type of layer in a Vision Transformer.</span>
The <span id="S3.T1.26.2" class="ltx_text ltx_font_italic">mean</span> and <span id="S3.T1.27.3" class="ltx_text ltx_font_italic">standard deviation</span> of the client’s Top-1 Accuracy are reported for each type of layer (<span id="S3.T1.28.4" class="ltx_text ltx_font_bold">Stand-alone</span>). Considering the classification head is the most sensitive type of layer, we also report the performance when a type of layer is kept updated locally along with the classification head (<span id="S3.T1.29.5" class="ltx_text ltx_font_bold">Combined</span>). The <span id="S3.T1.30.6" class="ltx_text ltx_font_bold">overall</span> performance is the mean of the stand-alone accuracy and combined accuracy.</figcaption>
<div id="S3.T1.18.18" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:266.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(84.9pt,-52.1pt) scale(1.64301544465924,1.64301544465924) ;">
<table id="S3.T1.18.18.18" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.18.18.18.19.1" class="ltx_tr">
<th id="S3.T1.18.18.18.19.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="S3.T1.18.18.18.19.1.1.1" class="ltx_text ltx_font_bold">Type</span></th>
<td id="S3.T1.18.18.18.19.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T1.18.18.18.19.1.2.1" class="ltx_text ltx_font_bold">Stand-alone</span></td>
<td id="S3.T1.18.18.18.19.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T1.18.18.18.19.1.3.1" class="ltx_text ltx_font_bold">Combined</span></td>
<td id="S3.T1.18.18.18.19.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T1.18.18.18.19.1.4.1" class="ltx_text ltx_font_bold">Overall</span></td>
</tr>
<tr id="S3.T1.1.1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">All Local</th>
<td id="S3.T1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="34.74_{\pm 9.36}" display="inline"><semantics id="S3.T1.1.1.1.1.1.m1.1a"><msub id="S3.T1.1.1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.1.1.m1.1.1.cmml"><mn id="S3.T1.1.1.1.1.1.m1.1.1.2" xref="S3.T1.1.1.1.1.1.m1.1.1.2.cmml">34.74</mn><mrow id="S3.T1.1.1.1.1.1.m1.1.1.3" xref="S3.T1.1.1.1.1.1.m1.1.1.3.cmml"><mo id="S3.T1.1.1.1.1.1.m1.1.1.3a" xref="S3.T1.1.1.1.1.1.m1.1.1.3.cmml">±</mo><mn id="S3.T1.1.1.1.1.1.m1.1.1.3.2" xref="S3.T1.1.1.1.1.1.m1.1.1.3.2.cmml">9.36</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.1.1.1.1.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.1.1.1.1.1.m1.1.1.2">34.74</cn><apply id="S3.T1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.T1.1.1.1.1.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S3.T1.1.1.1.1.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S3.T1.1.1.1.1.1.m1.1.1.3.2">9.36</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.1.1.m1.1c">34.74_{\pm 9.36}</annotation></semantics></math></td>
<td id="S3.T1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S3.T1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="S3.T1.2.2.2.2" class="ltx_tr">
<th id="S3.T1.2.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">All Global</th>
<td id="S3.T1.2.2.2.2.1" class="ltx_td ltx_align_center"><math id="S3.T1.2.2.2.2.1.m1.1" class="ltx_Math" alttext="23.29_{\pm 11.31}" display="inline"><semantics id="S3.T1.2.2.2.2.1.m1.1a"><msub id="S3.T1.2.2.2.2.1.m1.1.1" xref="S3.T1.2.2.2.2.1.m1.1.1.cmml"><mn id="S3.T1.2.2.2.2.1.m1.1.1.2" xref="S3.T1.2.2.2.2.1.m1.1.1.2.cmml">23.29</mn><mrow id="S3.T1.2.2.2.2.1.m1.1.1.3" xref="S3.T1.2.2.2.2.1.m1.1.1.3.cmml"><mo id="S3.T1.2.2.2.2.1.m1.1.1.3a" xref="S3.T1.2.2.2.2.1.m1.1.1.3.cmml">±</mo><mn id="S3.T1.2.2.2.2.1.m1.1.1.3.2" xref="S3.T1.2.2.2.2.1.m1.1.1.3.2.cmml">11.31</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.2.1.m1.1b"><apply id="S3.T1.2.2.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.2.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.2.2.2.2.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.2.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.2.2.2.2.1.m1.1.1.2">23.29</cn><apply id="S3.T1.2.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.2.2.2.2.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.2.2.2.2.1.m1.1.1.3.1.cmml" xref="S3.T1.2.2.2.2.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.2.2.2.2.1.m1.1.1.3.2.cmml" xref="S3.T1.2.2.2.2.1.m1.1.1.3.2">11.31</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.2.1.m1.1c">23.29_{\pm 11.31}</annotation></semantics></math></td>
<td id="S3.T1.2.2.2.2.3" class="ltx_td ltx_align_center">-</td>
<td id="S3.T1.2.2.2.2.4" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S3.T1.3.3.3.3" class="ltx_tr">
<th id="S3.T1.3.3.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">Classification Head</th>
<td id="S3.T1.3.3.3.3.1" class="ltx_td ltx_align_center"><math id="S3.T1.3.3.3.3.1.m1.1" class="ltx_Math" alttext="44.42_{\pm 7.98}" display="inline"><semantics id="S3.T1.3.3.3.3.1.m1.1a"><msub id="S3.T1.3.3.3.3.1.m1.1.1" xref="S3.T1.3.3.3.3.1.m1.1.1.cmml"><mn id="S3.T1.3.3.3.3.1.m1.1.1.2" xref="S3.T1.3.3.3.3.1.m1.1.1.2.cmml">44.42</mn><mrow id="S3.T1.3.3.3.3.1.m1.1.1.3" xref="S3.T1.3.3.3.3.1.m1.1.1.3.cmml"><mo id="S3.T1.3.3.3.3.1.m1.1.1.3a" xref="S3.T1.3.3.3.3.1.m1.1.1.3.cmml">±</mo><mn id="S3.T1.3.3.3.3.1.m1.1.1.3.2" xref="S3.T1.3.3.3.3.1.m1.1.1.3.2.cmml">7.98</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.3.1.m1.1b"><apply id="S3.T1.3.3.3.3.1.m1.1.1.cmml" xref="S3.T1.3.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.3.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.3.3.3.3.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.3.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.3.3.3.3.1.m1.1.1.2">44.42</cn><apply id="S3.T1.3.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.3.3.3.3.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.3.3.3.3.1.m1.1.1.3.1.cmml" xref="S3.T1.3.3.3.3.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.3.3.3.3.1.m1.1.1.3.2.cmml" xref="S3.T1.3.3.3.3.1.m1.1.1.3.2">7.98</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.3.1.m1.1c">44.42_{\pm 7.98}</annotation></semantics></math></td>
<td id="S3.T1.3.3.3.3.3" class="ltx_td ltx_align_center">-</td>
<td id="S3.T1.3.3.3.3.4" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S3.T1.6.6.6.6" class="ltx_tr">
<th id="S3.T1.6.6.6.6.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Patch Embedding</th>
<td id="S3.T1.4.4.4.4.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T1.4.4.4.4.1.m1.1" class="ltx_Math" alttext="27.61_{\pm 10.02}" display="inline"><semantics id="S3.T1.4.4.4.4.1.m1.1a"><msub id="S3.T1.4.4.4.4.1.m1.1.1" xref="S3.T1.4.4.4.4.1.m1.1.1.cmml"><mn id="S3.T1.4.4.4.4.1.m1.1.1.2" xref="S3.T1.4.4.4.4.1.m1.1.1.2.cmml">27.61</mn><mrow id="S3.T1.4.4.4.4.1.m1.1.1.3" xref="S3.T1.4.4.4.4.1.m1.1.1.3.cmml"><mo id="S3.T1.4.4.4.4.1.m1.1.1.3a" xref="S3.T1.4.4.4.4.1.m1.1.1.3.cmml">±</mo><mn id="S3.T1.4.4.4.4.1.m1.1.1.3.2" xref="S3.T1.4.4.4.4.1.m1.1.1.3.2.cmml">10.02</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.4.4.1.m1.1b"><apply id="S3.T1.4.4.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.4.4.4.4.1.m1.1.1.1.cmml" xref="S3.T1.4.4.4.4.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.4.4.4.4.1.m1.1.1.2.cmml" xref="S3.T1.4.4.4.4.1.m1.1.1.2">27.61</cn><apply id="S3.T1.4.4.4.4.1.m1.1.1.3.cmml" xref="S3.T1.4.4.4.4.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.4.4.4.4.1.m1.1.1.3.1.cmml" xref="S3.T1.4.4.4.4.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.4.4.4.4.1.m1.1.1.3.2.cmml" xref="S3.T1.4.4.4.4.1.m1.1.1.3.2">10.02</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.4.4.1.m1.1c">27.61_{\pm 10.02}</annotation></semantics></math></td>
<td id="S3.T1.5.5.5.5.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T1.5.5.5.5.2.m1.1" class="ltx_Math" alttext="43.45_{\pm 8.69}" display="inline"><semantics id="S3.T1.5.5.5.5.2.m1.1a"><msub id="S3.T1.5.5.5.5.2.m1.1.1" xref="S3.T1.5.5.5.5.2.m1.1.1.cmml"><mn id="S3.T1.5.5.5.5.2.m1.1.1.2" xref="S3.T1.5.5.5.5.2.m1.1.1.2.cmml">43.45</mn><mrow id="S3.T1.5.5.5.5.2.m1.1.1.3" xref="S3.T1.5.5.5.5.2.m1.1.1.3.cmml"><mo id="S3.T1.5.5.5.5.2.m1.1.1.3a" xref="S3.T1.5.5.5.5.2.m1.1.1.3.cmml">±</mo><mn id="S3.T1.5.5.5.5.2.m1.1.1.3.2" xref="S3.T1.5.5.5.5.2.m1.1.1.3.2.cmml">8.69</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.5.5.2.m1.1b"><apply id="S3.T1.5.5.5.5.2.m1.1.1.cmml" xref="S3.T1.5.5.5.5.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.5.5.5.5.2.m1.1.1.1.cmml" xref="S3.T1.5.5.5.5.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.5.5.5.5.2.m1.1.1.2.cmml" xref="S3.T1.5.5.5.5.2.m1.1.1.2">43.45</cn><apply id="S3.T1.5.5.5.5.2.m1.1.1.3.cmml" xref="S3.T1.5.5.5.5.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.5.5.5.5.2.m1.1.1.3.1.cmml" xref="S3.T1.5.5.5.5.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.5.5.5.5.2.m1.1.1.3.2.cmml" xref="S3.T1.5.5.5.5.2.m1.1.1.3.2">8.69</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.5.5.2.m1.1c">43.45_{\pm 8.69}</annotation></semantics></math></td>
<td id="S3.T1.6.6.6.6.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T1.6.6.6.6.3.m1.1" class="ltx_Math" alttext="35.53" display="inline"><semantics id="S3.T1.6.6.6.6.3.m1.1a"><mn id="S3.T1.6.6.6.6.3.m1.1.1" xref="S3.T1.6.6.6.6.3.m1.1.1.cmml">35.53</mn><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.6.6.3.m1.1b"><cn type="float" id="S3.T1.6.6.6.6.3.m1.1.1.cmml" xref="S3.T1.6.6.6.6.3.m1.1.1">35.53</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.6.6.3.m1.1c">35.53</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.9.9.9.9" class="ltx_tr">
<th id="S3.T1.9.9.9.9.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">Position Embedding</th>
<td id="S3.T1.7.7.7.7.1" class="ltx_td ltx_align_center"><math id="S3.T1.7.7.7.7.1.m1.1" class="ltx_Math" alttext="23.80_{\pm 11.42}" display="inline"><semantics id="S3.T1.7.7.7.7.1.m1.1a"><msub id="S3.T1.7.7.7.7.1.m1.1.1" xref="S3.T1.7.7.7.7.1.m1.1.1.cmml"><mn id="S3.T1.7.7.7.7.1.m1.1.1.2" xref="S3.T1.7.7.7.7.1.m1.1.1.2.cmml">23.80</mn><mrow id="S3.T1.7.7.7.7.1.m1.1.1.3" xref="S3.T1.7.7.7.7.1.m1.1.1.3.cmml"><mo id="S3.T1.7.7.7.7.1.m1.1.1.3a" xref="S3.T1.7.7.7.7.1.m1.1.1.3.cmml">±</mo><mn id="S3.T1.7.7.7.7.1.m1.1.1.3.2" xref="S3.T1.7.7.7.7.1.m1.1.1.3.2.cmml">11.42</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.7.7.1.m1.1b"><apply id="S3.T1.7.7.7.7.1.m1.1.1.cmml" xref="S3.T1.7.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.7.7.7.7.1.m1.1.1.1.cmml" xref="S3.T1.7.7.7.7.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.7.7.7.7.1.m1.1.1.2.cmml" xref="S3.T1.7.7.7.7.1.m1.1.1.2">23.80</cn><apply id="S3.T1.7.7.7.7.1.m1.1.1.3.cmml" xref="S3.T1.7.7.7.7.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.7.7.7.7.1.m1.1.1.3.1.cmml" xref="S3.T1.7.7.7.7.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.7.7.7.7.1.m1.1.1.3.2.cmml" xref="S3.T1.7.7.7.7.1.m1.1.1.3.2">11.42</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.7.7.1.m1.1c">23.80_{\pm 11.42}</annotation></semantics></math></td>
<td id="S3.T1.8.8.8.8.2" class="ltx_td ltx_align_center"><math id="S3.T1.8.8.8.8.2.m1.1" class="ltx_Math" alttext="45.04_{\pm 8.08}" display="inline"><semantics id="S3.T1.8.8.8.8.2.m1.1a"><msub id="S3.T1.8.8.8.8.2.m1.1.1" xref="S3.T1.8.8.8.8.2.m1.1.1.cmml"><mn id="S3.T1.8.8.8.8.2.m1.1.1.2" xref="S3.T1.8.8.8.8.2.m1.1.1.2.cmml">45.04</mn><mrow id="S3.T1.8.8.8.8.2.m1.1.1.3" xref="S3.T1.8.8.8.8.2.m1.1.1.3.cmml"><mo id="S3.T1.8.8.8.8.2.m1.1.1.3a" xref="S3.T1.8.8.8.8.2.m1.1.1.3.cmml">±</mo><mn id="S3.T1.8.8.8.8.2.m1.1.1.3.2" xref="S3.T1.8.8.8.8.2.m1.1.1.3.2.cmml">8.08</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.8.8.2.m1.1b"><apply id="S3.T1.8.8.8.8.2.m1.1.1.cmml" xref="S3.T1.8.8.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.8.8.8.8.2.m1.1.1.1.cmml" xref="S3.T1.8.8.8.8.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.8.8.8.8.2.m1.1.1.2.cmml" xref="S3.T1.8.8.8.8.2.m1.1.1.2">45.04</cn><apply id="S3.T1.8.8.8.8.2.m1.1.1.3.cmml" xref="S3.T1.8.8.8.8.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.8.8.8.8.2.m1.1.1.3.1.cmml" xref="S3.T1.8.8.8.8.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.8.8.8.8.2.m1.1.1.3.2.cmml" xref="S3.T1.8.8.8.8.2.m1.1.1.3.2">8.08</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.8.8.2.m1.1c">45.04_{\pm 8.08}</annotation></semantics></math></td>
<td id="S3.T1.9.9.9.9.3" class="ltx_td ltx_align_center"><math id="S3.T1.9.9.9.9.3.m1.1" class="ltx_Math" alttext="34.42" display="inline"><semantics id="S3.T1.9.9.9.9.3.m1.1a"><mn id="S3.T1.9.9.9.9.3.m1.1.1" xref="S3.T1.9.9.9.9.3.m1.1.1.cmml">34.42</mn><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.9.9.3.m1.1b"><cn type="float" id="S3.T1.9.9.9.9.3.m1.1.1.cmml" xref="S3.T1.9.9.9.9.3.m1.1.1">34.42</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.9.9.3.m1.1c">34.42</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.12.12.12.12" class="ltx_tr">
<th id="S3.T1.12.12.12.12.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">LayerNorm</th>
<td id="S3.T1.10.10.10.10.1" class="ltx_td ltx_align_center"><math id="S3.T1.10.10.10.10.1.m1.1" class="ltx_Math" alttext="23.94_{\pm 11.19}" display="inline"><semantics id="S3.T1.10.10.10.10.1.m1.1a"><msub id="S3.T1.10.10.10.10.1.m1.1.1" xref="S3.T1.10.10.10.10.1.m1.1.1.cmml"><mn id="S3.T1.10.10.10.10.1.m1.1.1.2" xref="S3.T1.10.10.10.10.1.m1.1.1.2.cmml">23.94</mn><mrow id="S3.T1.10.10.10.10.1.m1.1.1.3" xref="S3.T1.10.10.10.10.1.m1.1.1.3.cmml"><mo id="S3.T1.10.10.10.10.1.m1.1.1.3a" xref="S3.T1.10.10.10.10.1.m1.1.1.3.cmml">±</mo><mn id="S3.T1.10.10.10.10.1.m1.1.1.3.2" xref="S3.T1.10.10.10.10.1.m1.1.1.3.2.cmml">11.19</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.10.10.1.m1.1b"><apply id="S3.T1.10.10.10.10.1.m1.1.1.cmml" xref="S3.T1.10.10.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.10.10.10.10.1.m1.1.1.1.cmml" xref="S3.T1.10.10.10.10.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.10.10.10.10.1.m1.1.1.2.cmml" xref="S3.T1.10.10.10.10.1.m1.1.1.2">23.94</cn><apply id="S3.T1.10.10.10.10.1.m1.1.1.3.cmml" xref="S3.T1.10.10.10.10.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.10.10.10.10.1.m1.1.1.3.1.cmml" xref="S3.T1.10.10.10.10.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.10.10.10.10.1.m1.1.1.3.2.cmml" xref="S3.T1.10.10.10.10.1.m1.1.1.3.2">11.19</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.10.10.1.m1.1c">23.94_{\pm 11.19}</annotation></semantics></math></td>
<td id="S3.T1.11.11.11.11.2" class="ltx_td ltx_align_center"><math id="S3.T1.11.11.11.11.2.m1.1" class="ltx_Math" alttext="44.60_{\pm 7.96}" display="inline"><semantics id="S3.T1.11.11.11.11.2.m1.1a"><msub id="S3.T1.11.11.11.11.2.m1.1.1" xref="S3.T1.11.11.11.11.2.m1.1.1.cmml"><mn id="S3.T1.11.11.11.11.2.m1.1.1.2" xref="S3.T1.11.11.11.11.2.m1.1.1.2.cmml">44.60</mn><mrow id="S3.T1.11.11.11.11.2.m1.1.1.3" xref="S3.T1.11.11.11.11.2.m1.1.1.3.cmml"><mo id="S3.T1.11.11.11.11.2.m1.1.1.3a" xref="S3.T1.11.11.11.11.2.m1.1.1.3.cmml">±</mo><mn id="S3.T1.11.11.11.11.2.m1.1.1.3.2" xref="S3.T1.11.11.11.11.2.m1.1.1.3.2.cmml">7.96</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.11.11.2.m1.1b"><apply id="S3.T1.11.11.11.11.2.m1.1.1.cmml" xref="S3.T1.11.11.11.11.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.11.11.11.11.2.m1.1.1.1.cmml" xref="S3.T1.11.11.11.11.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.11.11.11.11.2.m1.1.1.2.cmml" xref="S3.T1.11.11.11.11.2.m1.1.1.2">44.60</cn><apply id="S3.T1.11.11.11.11.2.m1.1.1.3.cmml" xref="S3.T1.11.11.11.11.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.11.11.11.11.2.m1.1.1.3.1.cmml" xref="S3.T1.11.11.11.11.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.11.11.11.11.2.m1.1.1.3.2.cmml" xref="S3.T1.11.11.11.11.2.m1.1.1.3.2">7.96</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.11.11.2.m1.1c">44.60_{\pm 7.96}</annotation></semantics></math></td>
<td id="S3.T1.12.12.12.12.3" class="ltx_td ltx_align_center"><math id="S3.T1.12.12.12.12.3.m1.1" class="ltx_Math" alttext="34.27" display="inline"><semantics id="S3.T1.12.12.12.12.3.m1.1a"><mn id="S3.T1.12.12.12.12.3.m1.1.1" xref="S3.T1.12.12.12.12.3.m1.1.1.cmml">34.27</mn><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.12.12.3.m1.1b"><cn type="float" id="S3.T1.12.12.12.12.3.m1.1.1.cmml" xref="S3.T1.12.12.12.12.3.m1.1.1">34.27</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.12.12.3.m1.1c">34.27</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.15.15.15.15" class="ltx_tr">
<th id="S3.T1.15.15.15.15.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">Self-attention</th>
<td id="S3.T1.13.13.13.13.1" class="ltx_td ltx_align_center"><math id="S3.T1.13.13.13.13.1.m1.1" class="ltx_Math" alttext="42.95_{\pm 8.68}" display="inline"><semantics id="S3.T1.13.13.13.13.1.m1.1a"><msub id="S3.T1.13.13.13.13.1.m1.1.1" xref="S3.T1.13.13.13.13.1.m1.1.1.cmml"><mn id="S3.T1.13.13.13.13.1.m1.1.1.2" xref="S3.T1.13.13.13.13.1.m1.1.1.2.cmml">42.95</mn><mrow id="S3.T1.13.13.13.13.1.m1.1.1.3" xref="S3.T1.13.13.13.13.1.m1.1.1.3.cmml"><mo id="S3.T1.13.13.13.13.1.m1.1.1.3a" xref="S3.T1.13.13.13.13.1.m1.1.1.3.cmml">±</mo><mn id="S3.T1.13.13.13.13.1.m1.1.1.3.2" xref="S3.T1.13.13.13.13.1.m1.1.1.3.2.cmml">8.68</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.13.13.1.m1.1b"><apply id="S3.T1.13.13.13.13.1.m1.1.1.cmml" xref="S3.T1.13.13.13.13.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.13.13.13.13.1.m1.1.1.1.cmml" xref="S3.T1.13.13.13.13.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.13.13.13.13.1.m1.1.1.2.cmml" xref="S3.T1.13.13.13.13.1.m1.1.1.2">42.95</cn><apply id="S3.T1.13.13.13.13.1.m1.1.1.3.cmml" xref="S3.T1.13.13.13.13.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.13.13.13.13.1.m1.1.1.3.1.cmml" xref="S3.T1.13.13.13.13.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.13.13.13.13.1.m1.1.1.3.2.cmml" xref="S3.T1.13.13.13.13.1.m1.1.1.3.2">8.68</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.13.13.1.m1.1c">42.95_{\pm 8.68}</annotation></semantics></math></td>
<td id="S3.T1.14.14.14.14.2" class="ltx_td ltx_align_center"><math id="S3.T1.14.14.14.14.2.m1.1" class="ltx_Math" alttext="44.63_{\pm 8.67}" display="inline"><semantics id="S3.T1.14.14.14.14.2.m1.1a"><msub id="S3.T1.14.14.14.14.2.m1.1.1" xref="S3.T1.14.14.14.14.2.m1.1.1.cmml"><mn id="S3.T1.14.14.14.14.2.m1.1.1.2" xref="S3.T1.14.14.14.14.2.m1.1.1.2.cmml">44.63</mn><mrow id="S3.T1.14.14.14.14.2.m1.1.1.3" xref="S3.T1.14.14.14.14.2.m1.1.1.3.cmml"><mo id="S3.T1.14.14.14.14.2.m1.1.1.3a" xref="S3.T1.14.14.14.14.2.m1.1.1.3.cmml">±</mo><mn id="S3.T1.14.14.14.14.2.m1.1.1.3.2" xref="S3.T1.14.14.14.14.2.m1.1.1.3.2.cmml">8.67</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.14.14.2.m1.1b"><apply id="S3.T1.14.14.14.14.2.m1.1.1.cmml" xref="S3.T1.14.14.14.14.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.14.14.14.14.2.m1.1.1.1.cmml" xref="S3.T1.14.14.14.14.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.14.14.14.14.2.m1.1.1.2.cmml" xref="S3.T1.14.14.14.14.2.m1.1.1.2">44.63</cn><apply id="S3.T1.14.14.14.14.2.m1.1.1.3.cmml" xref="S3.T1.14.14.14.14.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.14.14.14.14.2.m1.1.1.3.1.cmml" xref="S3.T1.14.14.14.14.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.14.14.14.14.2.m1.1.1.3.2.cmml" xref="S3.T1.14.14.14.14.2.m1.1.1.3.2">8.67</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.14.14.2.m1.1c">44.63_{\pm 8.67}</annotation></semantics></math></td>
<td id="S3.T1.15.15.15.15.3" class="ltx_td ltx_align_center"><math id="S3.T1.15.15.15.15.3.m1.1" class="ltx_Math" alttext="\mathbf{43.79}" display="inline"><semantics id="S3.T1.15.15.15.15.3.m1.1a"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T1.15.15.15.15.3.m1.1.1" xref="S3.T1.15.15.15.15.3.m1.1.1.cmml">43.79</mn><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.15.15.3.m1.1b"><cn type="float" id="S3.T1.15.15.15.15.3.m1.1.1.cmml" xref="S3.T1.15.15.15.15.3.m1.1.1">43.79</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.15.15.3.m1.1c">\mathbf{43.79}</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.18.18.18.18" class="ltx_tr">
<th id="S3.T1.18.18.18.18.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">MLP</th>
<td id="S3.T1.16.16.16.16.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S3.T1.16.16.16.16.1.m1.1" class="ltx_Math" alttext="42.53_{\pm 8.82}" display="inline"><semantics id="S3.T1.16.16.16.16.1.m1.1a"><msub id="S3.T1.16.16.16.16.1.m1.1.1" xref="S3.T1.16.16.16.16.1.m1.1.1.cmml"><mn id="S3.T1.16.16.16.16.1.m1.1.1.2" xref="S3.T1.16.16.16.16.1.m1.1.1.2.cmml">42.53</mn><mrow id="S3.T1.16.16.16.16.1.m1.1.1.3" xref="S3.T1.16.16.16.16.1.m1.1.1.3.cmml"><mo id="S3.T1.16.16.16.16.1.m1.1.1.3a" xref="S3.T1.16.16.16.16.1.m1.1.1.3.cmml">±</mo><mn id="S3.T1.16.16.16.16.1.m1.1.1.3.2" xref="S3.T1.16.16.16.16.1.m1.1.1.3.2.cmml">8.82</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.16.16.1.m1.1b"><apply id="S3.T1.16.16.16.16.1.m1.1.1.cmml" xref="S3.T1.16.16.16.16.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.16.16.16.16.1.m1.1.1.1.cmml" xref="S3.T1.16.16.16.16.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.16.16.16.16.1.m1.1.1.2.cmml" xref="S3.T1.16.16.16.16.1.m1.1.1.2">42.53</cn><apply id="S3.T1.16.16.16.16.1.m1.1.1.3.cmml" xref="S3.T1.16.16.16.16.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.16.16.16.16.1.m1.1.1.3.1.cmml" xref="S3.T1.16.16.16.16.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.16.16.16.16.1.m1.1.1.3.2.cmml" xref="S3.T1.16.16.16.16.1.m1.1.1.3.2">8.82</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.16.16.1.m1.1c">42.53_{\pm 8.82}</annotation></semantics></math></td>
<td id="S3.T1.17.17.17.17.2" class="ltx_td ltx_align_center ltx_border_bb"><math id="S3.T1.17.17.17.17.2.m1.1" class="ltx_Math" alttext="42.63_{\pm 8.84}" display="inline"><semantics id="S3.T1.17.17.17.17.2.m1.1a"><msub id="S3.T1.17.17.17.17.2.m1.1.1" xref="S3.T1.17.17.17.17.2.m1.1.1.cmml"><mn id="S3.T1.17.17.17.17.2.m1.1.1.2" xref="S3.T1.17.17.17.17.2.m1.1.1.2.cmml">42.63</mn><mrow id="S3.T1.17.17.17.17.2.m1.1.1.3" xref="S3.T1.17.17.17.17.2.m1.1.1.3.cmml"><mo id="S3.T1.17.17.17.17.2.m1.1.1.3a" xref="S3.T1.17.17.17.17.2.m1.1.1.3.cmml">±</mo><mn id="S3.T1.17.17.17.17.2.m1.1.1.3.2" xref="S3.T1.17.17.17.17.2.m1.1.1.3.2.cmml">8.84</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.17.17.2.m1.1b"><apply id="S3.T1.17.17.17.17.2.m1.1.1.cmml" xref="S3.T1.17.17.17.17.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.17.17.17.17.2.m1.1.1.1.cmml" xref="S3.T1.17.17.17.17.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T1.17.17.17.17.2.m1.1.1.2.cmml" xref="S3.T1.17.17.17.17.2.m1.1.1.2">42.63</cn><apply id="S3.T1.17.17.17.17.2.m1.1.1.3.cmml" xref="S3.T1.17.17.17.17.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T1.17.17.17.17.2.m1.1.1.3.1.cmml" xref="S3.T1.17.17.17.17.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T1.17.17.17.17.2.m1.1.1.3.2.cmml" xref="S3.T1.17.17.17.17.2.m1.1.1.3.2">8.84</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.17.17.2.m1.1c">42.63_{\pm 8.84}</annotation></semantics></math></td>
<td id="S3.T1.18.18.18.18.3" class="ltx_td ltx_align_center ltx_border_bb"><math id="S3.T1.18.18.18.18.3.m1.1" class="ltx_Math" alttext="42.58" display="inline"><semantics id="S3.T1.18.18.18.18.3.m1.1a"><mn id="S3.T1.18.18.18.18.3.m1.1.1" xref="S3.T1.18.18.18.18.3.m1.1.1.cmml">42.58</mn><annotation-xml encoding="MathML-Content" id="S3.T1.18.18.18.18.3.m1.1b"><cn type="float" id="S3.T1.18.18.18.18.3.m1.1.1.cmml" xref="S3.T1.18.18.18.18.3.m1.1.1">42.58</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.18.18.18.3.m1.1c">42.58</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2308.09160/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="140" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S3.F2.2.1" class="ltx_text ltx_font_bold">Several designs to personalize the self-attention layer in a ViT.</span> SDP is short for Scaled Dot Product, the red part indicates the local parameters, the blue part indicates the global parameters and the gray parts are vectors or modules with no learnable parameter. (a) Vanilla attention simply keeps the self-attention and classification updated locally. (b) Vanilla prefix-tuning only keeps the prefixes updated locally and aggregates the original self-attention layer. (c) FedPerfix uses a local adapter to generate the prefixes and aggregates the original self-attention layer. The adapter is composed of a scale-down, an activation, and a scale-up layer.</figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Empirical Study: Partial ViT Personalization</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">In a ViT, we consider the following layers as candidates
to be personalized and evaluate their sensitivity to data distribution when they are updated locally:
<span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_bold">Patch Embedding</span> layer converts the input image to a sequence of patches, then applies a linear projection to map each patch into an embedding vector.
<span id="S3.SS3.p1.1.2" class="ltx_text ltx_font_bold">Position Embedding</span> layer is responsible for injecting positional information into the sequence of patches produced by the patch embedding layer, allowing the model to capture the spatial arrangement of the image.
<span id="S3.SS3.p1.1.3" class="ltx_text ltx_font_bold">LayerNorm</span> is a normalization layer commonly used in ViT to normalize the feature maps across the channel dimension.
<span id="S3.SS3.p1.1.4" class="ltx_text ltx_font_bold">Self-attention layer</span> allows the model to attend to different regions of the input image and capture long-range dependencies between them.
<span id="S3.SS3.p1.1.5" class="ltx_text ltx_font_bold">MLP</span> layers, following the self-attention layer, enable the model to capture non-linear relationships between the image patches.
<span id="S3.SS3.p1.1.6" class="ltx_text ltx_font_bold">Classification Head</span> applies a linear projection from the [CLS] token to a predicted class.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">We perform experiments on CIFAR-100 with our default setting, which will be introduced in Section <a href="#S4.SS1" title="4.1 Experiment Details ‣ 4 Experiment ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>. We keep the specified type of layer updated locally and report the mean and standard deviation of the Top-1 Accuracy across all clients as the metrics to indicate the <span id="S3.SS3.p2.1.1" class="ltx_text ltx_font_italic">sensitivity</span> to data distribution.
The result is shown in the second column of Table <a href="#S3.T1" title="Table 1 ‣ 3.2 Recap: Partial Model Personalization for CNN ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p">From the table, we can draw several insights. Keeping all layers local yields better performance than aggregating all layers. This suggests that aggregation of heterogeneous data may have a negative impact on some layers. Meanwhile, keeping each type of layer updated locally allows for greater adaptability to each client’s data, leading to different degrees of improvement compared with keeping every layer global.
Among all types of layers, the classification head is the most sensitive to data distribution, leading to the highest stand-alone performance, which is as expected.
Except for the classification head,
self-attention layer is more sensitive to data distribution than other components, showing a higher standard-alone performance.
</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.1" class="ltx_p">Considering the vital importance of the classification head, we also reported the combined performance when a type of layer is kept updated locally along with the classification head,
as shown in the third column of Table <a href="#S3.T1" title="Table 1 ‣ 3.2 Recap: Partial Model Personalization for CNN ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. To decide the most sensitive layers to be personalized, we averaged the performance under the two settings as the overall performance.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.1" class="ltx_p">Based on the overall performance, personalizing the self-attention and classification head is one possible answer to the question of <span id="S3.SS3.p5.1.1" class="ltx_text ltx_font_italic">where</span> to personalize. Besides, a vanilla baseline to keep the self-attention layers and classification head updated locally is proposed, which is referred to as Vanilla Attention as described in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 Recap: Partial Model Personalization for CNN ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (a).</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Proposed Baseline: Vanilla Prefix-tuning</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">Building upon the insights about <span id="S3.SS4.p1.1.1" class="ltx_text ltx_font_italic">where</span> to personalize gained in the previous section, we move to the next question about <span id="S3.SS4.p1.1.2" class="ltx_text ltx_font_italic">how</span> to personalize the selected layers. As obtained from our empirical study, Vanilla Attention is a baseline to personalize the self-attention layer by completely keeping the self-attention updated locally. However, it will also prevent it from learning general information for the global model.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">As explained in Section <a href="#S1" title="1 Introduction ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the plugins can be trained on the local data to capture the client-specific knowledge as a personalization module. There are three widely used plugins for ViTs: a) <span id="S3.SS4.p2.1.1" class="ltx_text ltx_font_bold">Prompts</span> that are learnable embeddings appended to the inputs, b) <span id="S3.SS4.p2.1.2" class="ltx_text ltx_font_bold">Adapters</span> that are inserted into the MLP layers, and c) <span id="S3.SS4.p2.1.3" class="ltx_text ltx_font_bold">Prefixes</span> that are appended to the key and value matrix of the self-attention layer. Given that the self-attention layer is one of the most sensitive layers,
It is plausible that the Prefixes integrated nearest to the self-attention layer are capable of capturing the most relevant client-specific information pertaining to the self-attention mechanism.
Besides, we further compare the effectiveness of all three plugins and discuss it in Section <a href="#S5.SS3" title="5.3 Investigation of FedPerfix ‣ 5 Ablation Study ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.3</span></a>. Therefore, we select Prefixes as our personalization module.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.1" class="ltx_p">Specifically, learnable prefixes are appended to the self-attention layer and kept updated locally on the client. Meanwhile, the original self-attention layer is shared across all clients as normal to capture global dependencies. We refer to this approach as Vanilla Prefix-tuning.
</p>
</div>
<div id="S3.SS4.p4" class="ltx_para">
<p id="S3.SS4.p4.7" class="ltx_p">An illustration of how Prefixes cooperate with the self-attention layer is shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 Recap: Partial Model Personalization for CNN ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (b). Besides, we formulate the output of one head of the self-attention layer as</p>
<table id="S3.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle head_{i}=" display="inline"><semantics id="S3.E3X.2.1.1.m1.1a"><mrow id="S3.E3X.2.1.1.m1.1.1" xref="S3.E3X.2.1.1.m1.1.1.cmml"><mrow id="S3.E3X.2.1.1.m1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.2.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.2.2" xref="S3.E3X.2.1.1.m1.1.1.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.1.1.2.1" xref="S3.E3X.2.1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.1.1.2.3" xref="S3.E3X.2.1.1.m1.1.1.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.1.1.2.1a" xref="S3.E3X.2.1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.1.1.2.4" xref="S3.E3X.2.1.1.m1.1.1.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.1.1.2.1b" xref="S3.E3X.2.1.1.m1.1.1.2.1.cmml">​</mo><msub id="S3.E3X.2.1.1.m1.1.1.2.5" xref="S3.E3X.2.1.1.m1.1.1.2.5.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.2.5.2" xref="S3.E3X.2.1.1.m1.1.1.2.5.2.cmml">d</mi><mi id="S3.E3X.2.1.1.m1.1.1.2.5.3" xref="S3.E3X.2.1.1.m1.1.1.2.5.3.cmml">i</mi></msub></mrow><mo id="S3.E3X.2.1.1.m1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.cmml">=</mo><mi id="S3.E3X.2.1.1.m1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.1b"><apply id="S3.E3X.2.1.1.m1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1"><eq id="S3.E3X.2.1.1.m1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1"></eq><apply id="S3.E3X.2.1.1.m1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.2"><times id="S3.E3X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.1"></times><ci id="S3.E3X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.2">ℎ</ci><ci id="S3.E3X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.3">𝑒</ci><ci id="S3.E3X.2.1.1.m1.1.1.2.4.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.4">𝑎</ci><apply id="S3.E3X.2.1.1.m1.1.1.2.5.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.2.5.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.5">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.1.1.2.5.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.5.2">𝑑</ci><ci id="S3.E3X.2.1.1.m1.1.1.2.5.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.2.5.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="S3.E3X.2.1.1.m1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.1c">\displaystyle head_{i}=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3X.3.2.2.m1.1" class="ltx_math_unparsed" alttext="\displaystyle Attention({\bm{Z}}^{l-1}{\bm{W}}_{q}^{(i)}," display="inline"><semantics id="S3.E3X.3.2.2.m1.1a"><mrow id="S3.E3X.3.2.2.m1.1b"><mi id="S3.E3X.3.2.2.m1.1.2">A</mi><mi id="S3.E3X.3.2.2.m1.1.3">t</mi><mi id="S3.E3X.3.2.2.m1.1.4">t</mi><mi id="S3.E3X.3.2.2.m1.1.5">e</mi><mi id="S3.E3X.3.2.2.m1.1.6">n</mi><mi id="S3.E3X.3.2.2.m1.1.7">t</mi><mi id="S3.E3X.3.2.2.m1.1.8">i</mi><mi id="S3.E3X.3.2.2.m1.1.9">o</mi><mi id="S3.E3X.3.2.2.m1.1.10">n</mi><mrow id="S3.E3X.3.2.2.m1.1.11"><mo stretchy="false" id="S3.E3X.3.2.2.m1.1.11.1">(</mo><msup id="S3.E3X.3.2.2.m1.1.11.2"><mi id="S3.E3X.3.2.2.m1.1.11.2.2">𝒁</mi><mrow id="S3.E3X.3.2.2.m1.1.11.2.3"><mi id="S3.E3X.3.2.2.m1.1.11.2.3.2">l</mi><mo id="S3.E3X.3.2.2.m1.1.11.2.3.1">−</mo><mn id="S3.E3X.3.2.2.m1.1.11.2.3.3">1</mn></mrow></msup><msubsup id="S3.E3X.3.2.2.m1.1.11.3"><mi id="S3.E3X.3.2.2.m1.1.11.3.2.2">𝑾</mi><mi id="S3.E3X.3.2.2.m1.1.11.3.2.3">q</mi><mrow id="S3.E3X.3.2.2.m1.1.1.1.3"><mo stretchy="false" id="S3.E3X.3.2.2.m1.1.1.1.3.1">(</mo><mi id="S3.E3X.3.2.2.m1.1.1.1.1">i</mi><mo stretchy="false" id="S3.E3X.3.2.2.m1.1.1.1.3.2">)</mo></mrow></msubsup><mo id="S3.E3X.3.2.2.m1.1.11.4">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E3X.3.2.2.m1.1c">\displaystyle Attention({\bm{Z}}^{l-1}{\bm{W}}_{q}^{(i)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr id="S3.E3Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xa.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle{\bm{Z}}^{l-1}[{\bm{P}}_{k},{\bm{W}}_{k}^{(i)}]," display="inline"><semantics id="S3.E3Xa.2.1.1.m1.2a"><mrow id="S3.E3Xa.2.1.1.m1.2.2.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.cmml"><msup id="S3.E3Xa.2.1.1.m1.2.2.1.1.4" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4.2.cmml">𝒁</mi><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.2.cmml">l</mi><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.1.cmml">−</mo><mn id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.3.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.cmml">​</mo><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.3.cmml"><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.3.cmml">[</mo><msub id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">𝑷</mi><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.4" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.3.cmml">,</mo><msubsup id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml">k</mi><mrow id="S3.E3Xa.2.1.1.m1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.1.1.1.3.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml">(</mo><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.1.1.1.3.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.5" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S3.E3Xa.2.1.1.m1.2.2.1.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.2b"><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1"><times id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3"></times><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4">superscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4.2">𝒁</ci><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3"><minus id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.1"></minus><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.2">𝑙</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4.3.3">1</cn></apply></apply><interval closure="closed" id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2"><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.2">𝑷</ci><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2">superscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2.2">𝑾</ci><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2.3">𝑘</ci></apply><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.2c">\displaystyle{\bm{Z}}^{l-1}[{\bm{P}}_{k},{\bm{W}}_{k}^{(i)}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E3Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xb.2.1.1.m1.1" class="ltx_math_unparsed" alttext="\displaystyle{\bm{Z}}^{l-1}[{\bm{P}}_{v},{\bm{W}}_{v}^{(i)})])" display="inline"><semantics id="S3.E3Xb.2.1.1.m1.1a"><mrow id="S3.E3Xb.2.1.1.m1.1b"><mrow id="S3.E3Xb.2.1.1.m1.1.2"><msup id="S3.E3Xb.2.1.1.m1.1.2.1"><mi id="S3.E3Xb.2.1.1.m1.1.2.1.2">𝒁</mi><mrow id="S3.E3Xb.2.1.1.m1.1.2.1.3"><mi id="S3.E3Xb.2.1.1.m1.1.2.1.3.2">l</mi><mo id="S3.E3Xb.2.1.1.m1.1.2.1.3.1">−</mo><mn id="S3.E3Xb.2.1.1.m1.1.2.1.3.3">1</mn></mrow></msup><mrow id="S3.E3Xb.2.1.1.m1.1.2.2"><mo stretchy="false" id="S3.E3Xb.2.1.1.m1.1.2.2.1">[</mo><msub id="S3.E3Xb.2.1.1.m1.1.2.2.2"><mi id="S3.E3Xb.2.1.1.m1.1.2.2.2.2">𝑷</mi><mi id="S3.E3Xb.2.1.1.m1.1.2.2.2.3">v</mi></msub><mo id="S3.E3Xb.2.1.1.m1.1.2.2.3">,</mo><msubsup id="S3.E3Xb.2.1.1.m1.1.2.2.4"><mi id="S3.E3Xb.2.1.1.m1.1.2.2.4.2.2">𝑾</mi><mi id="S3.E3Xb.2.1.1.m1.1.2.2.4.2.3">v</mi><mrow id="S3.E3Xb.2.1.1.m1.1.1.1.3"><mo stretchy="false" id="S3.E3Xb.2.1.1.m1.1.1.1.3.1">(</mo><mi id="S3.E3Xb.2.1.1.m1.1.1.1.1">i</mi><mo stretchy="false" id="S3.E3Xb.2.1.1.m1.1.1.1.3.2">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E3Xb.2.1.1.m1.1.2.2.5">)</mo></mrow><mo stretchy="false" id="S3.E3Xb.2.1.1.m1.1.2.3">]</mo></mrow><mo stretchy="false" id="S3.E3Xb.2.1.1.m1.1.3">)</mo></mrow><annotation encoding="application/x-tex" id="S3.E3Xb.2.1.1.m1.1c">\displaystyle{\bm{Z}}^{l-1}[{\bm{P}}_{v},{\bm{W}}_{v}^{(i)})])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS4.p4.6" class="ltx_p">where <math id="S3.SS4.p4.1.m1.1" class="ltx_Math" alttext="{\bm{Z}}^{l-1}" display="inline"><semantics id="S3.SS4.p4.1.m1.1a"><msup id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi id="S3.SS4.p4.1.m1.1.1.2" xref="S3.SS4.p4.1.m1.1.1.2.cmml">𝒁</mi><mrow id="S3.SS4.p4.1.m1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.3.cmml"><mi id="S3.SS4.p4.1.m1.1.1.3.2" xref="S3.SS4.p4.1.m1.1.1.3.2.cmml">l</mi><mo id="S3.SS4.p4.1.m1.1.1.3.1" xref="S3.SS4.p4.1.m1.1.1.3.1.cmml">−</mo><mn id="S3.SS4.p4.1.m1.1.1.3.3" xref="S3.SS4.p4.1.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2">𝒁</ci><apply id="S3.SS4.p4.1.m1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3"><minus id="S3.SS4.p4.1.m1.1.1.3.1.cmml" xref="S3.SS4.p4.1.m1.1.1.3.1"></minus><ci id="S3.SS4.p4.1.m1.1.1.3.2.cmml" xref="S3.SS4.p4.1.m1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS4.p4.1.m1.1.1.3.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">{\bm{Z}}^{l-1}</annotation></semantics></math> is the output from the last layer, <math id="S3.SS4.p4.2.m2.1" class="ltx_Math" alttext="{\bm{P}}_{k}" display="inline"><semantics id="S3.SS4.p4.2.m2.1a"><msub id="S3.SS4.p4.2.m2.1.1" xref="S3.SS4.p4.2.m2.1.1.cmml"><mi id="S3.SS4.p4.2.m2.1.1.2" xref="S3.SS4.p4.2.m2.1.1.2.cmml">𝑷</mi><mi id="S3.SS4.p4.2.m2.1.1.3" xref="S3.SS4.p4.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.1b"><apply id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p4.2.m2.1.1.2.cmml" xref="S3.SS4.p4.2.m2.1.1.2">𝑷</ci><ci id="S3.SS4.p4.2.m2.1.1.3.cmml" xref="S3.SS4.p4.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">{\bm{P}}_{k}</annotation></semantics></math> and <math id="S3.SS4.p4.3.m3.1" class="ltx_Math" alttext="{\bm{P}}_{v}" display="inline"><semantics id="S3.SS4.p4.3.m3.1a"><msub id="S3.SS4.p4.3.m3.1.1" xref="S3.SS4.p4.3.m3.1.1.cmml"><mi id="S3.SS4.p4.3.m3.1.1.2" xref="S3.SS4.p4.3.m3.1.1.2.cmml">𝑷</mi><mi id="S3.SS4.p4.3.m3.1.1.3" xref="S3.SS4.p4.3.m3.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m3.1b"><apply id="S3.SS4.p4.3.m3.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.3.m3.1.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p4.3.m3.1.1.2.cmml" xref="S3.SS4.p4.3.m3.1.1.2">𝑷</ci><ci id="S3.SS4.p4.3.m3.1.1.3.cmml" xref="S3.SS4.p4.3.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m3.1c">{\bm{P}}_{v}</annotation></semantics></math> are prefixes, <math id="S3.SS4.p4.4.m4.3" class="ltx_Math" alttext="{\bm{W}}_{q}^{(i)},{\bm{W}}_{k}^{(i)}," display="inline"><semantics id="S3.SS4.p4.4.m4.3a"><mrow id="S3.SS4.p4.4.m4.3.3.1"><mrow id="S3.SS4.p4.4.m4.3.3.1.1.2" xref="S3.SS4.p4.4.m4.3.3.1.1.3.cmml"><msubsup id="S3.SS4.p4.4.m4.3.3.1.1.1.1" xref="S3.SS4.p4.4.m4.3.3.1.1.1.1.cmml"><mi id="S3.SS4.p4.4.m4.3.3.1.1.1.1.2.2" xref="S3.SS4.p4.4.m4.3.3.1.1.1.1.2.2.cmml">𝑾</mi><mi id="S3.SS4.p4.4.m4.3.3.1.1.1.1.2.3" xref="S3.SS4.p4.4.m4.3.3.1.1.1.1.2.3.cmml">q</mi><mrow id="S3.SS4.p4.4.m4.1.1.1.3" xref="S3.SS4.p4.4.m4.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p4.4.m4.1.1.1.3.1" xref="S3.SS4.p4.4.m4.3.3.1.1.1.1.cmml">(</mo><mi id="S3.SS4.p4.4.m4.1.1.1.1" xref="S3.SS4.p4.4.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS4.p4.4.m4.1.1.1.3.2" xref="S3.SS4.p4.4.m4.3.3.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS4.p4.4.m4.3.3.1.1.2.3" xref="S3.SS4.p4.4.m4.3.3.1.1.3.cmml">,</mo><msubsup id="S3.SS4.p4.4.m4.3.3.1.1.2.2" xref="S3.SS4.p4.4.m4.3.3.1.1.2.2.cmml"><mi id="S3.SS4.p4.4.m4.3.3.1.1.2.2.2.2" xref="S3.SS4.p4.4.m4.3.3.1.1.2.2.2.2.cmml">𝑾</mi><mi id="S3.SS4.p4.4.m4.3.3.1.1.2.2.2.3" xref="S3.SS4.p4.4.m4.3.3.1.1.2.2.2.3.cmml">k</mi><mrow id="S3.SS4.p4.4.m4.2.2.1.3" xref="S3.SS4.p4.4.m4.3.3.1.1.2.2.cmml"><mo stretchy="false" id="S3.SS4.p4.4.m4.2.2.1.3.1" xref="S3.SS4.p4.4.m4.3.3.1.1.2.2.cmml">(</mo><mi id="S3.SS4.p4.4.m4.2.2.1.1" xref="S3.SS4.p4.4.m4.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS4.p4.4.m4.2.2.1.3.2" xref="S3.SS4.p4.4.m4.3.3.1.1.2.2.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.SS4.p4.4.m4.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.m4.3b"><list id="S3.SS4.p4.4.m4.3.3.1.1.3.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.2"><apply id="S3.SS4.p4.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p4.4.m4.3.3.1.1.1.1.2.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.3.3.1.1.1.1.2.1.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p4.4.m4.3.3.1.1.1.1.2.2.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.1.1.2.2">𝑾</ci><ci id="S3.SS4.p4.4.m4.3.3.1.1.1.1.2.3.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.1.1.2.3">𝑞</ci></apply><ci id="S3.SS4.p4.4.m4.1.1.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1.1.1">𝑖</ci></apply><apply id="S3.SS4.p4.4.m4.3.3.1.1.2.2.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.3.3.1.1.2.2.1.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.2.2">superscript</csymbol><apply id="S3.SS4.p4.4.m4.3.3.1.1.2.2.2.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.3.3.1.1.2.2.2.1.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.2.2">subscript</csymbol><ci id="S3.SS4.p4.4.m4.3.3.1.1.2.2.2.2.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.2.2.2.2">𝑾</ci><ci id="S3.SS4.p4.4.m4.3.3.1.1.2.2.2.3.cmml" xref="S3.SS4.p4.4.m4.3.3.1.1.2.2.2.3">𝑘</ci></apply><ci id="S3.SS4.p4.4.m4.2.2.1.1.cmml" xref="S3.SS4.p4.4.m4.2.2.1.1">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.m4.3c">{\bm{W}}_{q}^{(i)},{\bm{W}}_{k}^{(i)},</annotation></semantics></math> and <math id="S3.SS4.p4.5.m5.1" class="ltx_Math" alttext="{\bm{W}}_{v}^{(i)}" display="inline"><semantics id="S3.SS4.p4.5.m5.1a"><msubsup id="S3.SS4.p4.5.m5.1.2" xref="S3.SS4.p4.5.m5.1.2.cmml"><mi id="S3.SS4.p4.5.m5.1.2.2.2" xref="S3.SS4.p4.5.m5.1.2.2.2.cmml">𝑾</mi><mi id="S3.SS4.p4.5.m5.1.2.2.3" xref="S3.SS4.p4.5.m5.1.2.2.3.cmml">v</mi><mrow id="S3.SS4.p4.5.m5.1.1.1.3" xref="S3.SS4.p4.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS4.p4.5.m5.1.1.1.3.1" xref="S3.SS4.p4.5.m5.1.2.cmml">(</mo><mi id="S3.SS4.p4.5.m5.1.1.1.1" xref="S3.SS4.p4.5.m5.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS4.p4.5.m5.1.1.1.3.2" xref="S3.SS4.p4.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.5.m5.1b"><apply id="S3.SS4.p4.5.m5.1.2.cmml" xref="S3.SS4.p4.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m5.1.2.1.cmml" xref="S3.SS4.p4.5.m5.1.2">superscript</csymbol><apply id="S3.SS4.p4.5.m5.1.2.2.cmml" xref="S3.SS4.p4.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m5.1.2.2.1.cmml" xref="S3.SS4.p4.5.m5.1.2">subscript</csymbol><ci id="S3.SS4.p4.5.m5.1.2.2.2.cmml" xref="S3.SS4.p4.5.m5.1.2.2.2">𝑾</ci><ci id="S3.SS4.p4.5.m5.1.2.2.3.cmml" xref="S3.SS4.p4.5.m5.1.2.2.3">𝑣</ci></apply><ci id="S3.SS4.p4.5.m5.1.1.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.5.m5.1c">{\bm{W}}_{v}^{(i)}</annotation></semantics></math> are the parameters in the self-attention layer, and <math id="S3.SS4.p4.6.m6.1" class="ltx_math_unparsed" alttext="[,]" display="inline"><semantics id="S3.SS4.p4.6.m6.1a"><mrow id="S3.SS4.p4.6.m6.1b"><mo stretchy="false" id="S3.SS4.p4.6.m6.1.1">[</mo><mo id="S3.SS4.p4.6.m6.1.2">,</mo><mo stretchy="false" id="S3.SS4.p4.6.m6.1.3">]</mo></mrow><annotation encoding="application/x-tex" id="S3.SS4.p4.6.m6.1c">[,]</annotation></semantics></math> is the concatenate operation.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>FedPerfix: Stabilize the Prefix</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.1" class="ltx_p">In Vanilla Prefix-tuning, the prefixes are randomly initialized, which can result in unstable performance when initialized with different weights. We later conduct an experiment to demonstrate such instability in Section <a href="#S5.SS3" title="5.3 Investigation of FedPerfix ‣ 5 Ablation Study ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.3</span></a> when Vanilla Prefix-tuning is initialized with different weights.
To address this issue, we draw inspiration from the parallel attention design <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, which uses adapters to stabilize the prefixes. Similarly, we propose to use adapters in Vanilla Prefix-tuning to stabilize the prefix initialization. Specifically, we add a parallel adapter to prepare the prefixes for each layer, as shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 Recap: Partial Model Personalization for CNN ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Meanwhile, we add a hyperparameter <math id="S3.SS5.p1.1.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS5.p1.1.m1.1a"><mi id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><ci id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">s</annotation></semantics></math> to control the efficiency of the adapter. Following the design of parallel attention, the prefixes are generated as</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.4" class="ltx_Math" alttext="\small{\bm{P}}_{k},{\bm{P}}_{v}=Adapter({\bm{Z}}^{l-1})=\text{Tanh}({\bm{Z}}^{l-1}{\bm{W}}_{down}){\bm{W}}_{up}" display="block"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.3.cmml"><msub id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo mathsize="90%" id="S3.E4.m1.2.2.2.2.3" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><msub id="S3.E4.m1.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml">𝑷</mi><mi mathsize="90%" id="S3.E4.m1.2.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.3.cmml">v</mi></msub></mrow><mo mathsize="90%" id="S3.E4.m1.4.4.6" xref="S3.E4.m1.4.4.6.cmml">=</mo><mrow id="S3.E4.m1.3.3.3" xref="S3.E4.m1.3.3.3.cmml"><mi mathsize="90%" id="S3.E4.m1.3.3.3.3" xref="S3.E4.m1.3.3.3.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.2" xref="S3.E4.m1.3.3.3.2.cmml">​</mo><mi mathsize="90%" id="S3.E4.m1.3.3.3.4" xref="S3.E4.m1.3.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.2a" xref="S3.E4.m1.3.3.3.2.cmml">​</mo><mi mathsize="90%" id="S3.E4.m1.3.3.3.5" xref="S3.E4.m1.3.3.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.2b" xref="S3.E4.m1.3.3.3.2.cmml">​</mo><mi mathsize="90%" id="S3.E4.m1.3.3.3.6" xref="S3.E4.m1.3.3.3.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.2c" xref="S3.E4.m1.3.3.3.2.cmml">​</mo><mi mathsize="90%" id="S3.E4.m1.3.3.3.7" xref="S3.E4.m1.3.3.3.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.2d" xref="S3.E4.m1.3.3.3.2.cmml">​</mo><mi mathsize="90%" id="S3.E4.m1.3.3.3.8" xref="S3.E4.m1.3.3.3.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.2e" xref="S3.E4.m1.3.3.3.2.cmml">​</mo><mi mathsize="90%" id="S3.E4.m1.3.3.3.9" xref="S3.E4.m1.3.3.3.9.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.2f" xref="S3.E4.m1.3.3.3.2.cmml">​</mo><mrow id="S3.E4.m1.3.3.3.1.1" xref="S3.E4.m1.3.3.3.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E4.m1.3.3.3.1.1.2" xref="S3.E4.m1.3.3.3.1.1.1.cmml">(</mo><msup id="S3.E4.m1.3.3.3.1.1.1" xref="S3.E4.m1.3.3.3.1.1.1.cmml"><mi mathsize="90%" id="S3.E4.m1.3.3.3.1.1.1.2" xref="S3.E4.m1.3.3.3.1.1.1.2.cmml">𝒁</mi><mrow id="S3.E4.m1.3.3.3.1.1.1.3" xref="S3.E4.m1.3.3.3.1.1.1.3.cmml"><mi mathsize="90%" id="S3.E4.m1.3.3.3.1.1.1.3.2" xref="S3.E4.m1.3.3.3.1.1.1.3.2.cmml">l</mi><mo mathsize="90%" id="S3.E4.m1.3.3.3.1.1.1.3.1" xref="S3.E4.m1.3.3.3.1.1.1.3.1.cmml">−</mo><mn mathsize="90%" id="S3.E4.m1.3.3.3.1.1.1.3.3" xref="S3.E4.m1.3.3.3.1.1.1.3.3.cmml">1</mn></mrow></msup><mo maxsize="90%" minsize="90%" id="S3.E4.m1.3.3.3.1.1.3" xref="S3.E4.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S3.E4.m1.4.4.7" xref="S3.E4.m1.4.4.7.cmml">=</mo><mrow id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml"><mtext mathsize="90%" id="S3.E4.m1.4.4.4.3" xref="S3.E4.m1.4.4.4.3a.cmml">Tanh</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.2" xref="S3.E4.m1.4.4.4.2.cmml">​</mo><mrow id="S3.E4.m1.4.4.4.1.1" xref="S3.E4.m1.4.4.4.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E4.m1.4.4.4.1.1.2" xref="S3.E4.m1.4.4.4.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.4.4.4.1.1.1" xref="S3.E4.m1.4.4.4.1.1.1.cmml"><msup id="S3.E4.m1.4.4.4.1.1.1.2" xref="S3.E4.m1.4.4.4.1.1.1.2.cmml"><mi mathsize="90%" id="S3.E4.m1.4.4.4.1.1.1.2.2" xref="S3.E4.m1.4.4.4.1.1.1.2.2.cmml">𝒁</mi><mrow id="S3.E4.m1.4.4.4.1.1.1.2.3" xref="S3.E4.m1.4.4.4.1.1.1.2.3.cmml"><mi mathsize="90%" id="S3.E4.m1.4.4.4.1.1.1.2.3.2" xref="S3.E4.m1.4.4.4.1.1.1.2.3.2.cmml">l</mi><mo mathsize="90%" id="S3.E4.m1.4.4.4.1.1.1.2.3.1" xref="S3.E4.m1.4.4.4.1.1.1.2.3.1.cmml">−</mo><mn mathsize="90%" id="S3.E4.m1.4.4.4.1.1.1.2.3.3" xref="S3.E4.m1.4.4.4.1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.1.1.1.1" xref="S3.E4.m1.4.4.4.1.1.1.1.cmml">​</mo><msub id="S3.E4.m1.4.4.4.1.1.1.3" xref="S3.E4.m1.4.4.4.1.1.1.3.cmml"><mi mathsize="90%" id="S3.E4.m1.4.4.4.1.1.1.3.2" xref="S3.E4.m1.4.4.4.1.1.1.3.2.cmml">𝑾</mi><mrow id="S3.E4.m1.4.4.4.1.1.1.3.3" xref="S3.E4.m1.4.4.4.1.1.1.3.3.cmml"><mi mathsize="90%" id="S3.E4.m1.4.4.4.1.1.1.3.3.2" xref="S3.E4.m1.4.4.4.1.1.1.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.1.1.1.3.3.1" xref="S3.E4.m1.4.4.4.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E4.m1.4.4.4.1.1.1.3.3.3" xref="S3.E4.m1.4.4.4.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.1.1.1.3.3.1a" xref="S3.E4.m1.4.4.4.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E4.m1.4.4.4.1.1.1.3.3.4" xref="S3.E4.m1.4.4.4.1.1.1.3.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.1.1.1.3.3.1b" xref="S3.E4.m1.4.4.4.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E4.m1.4.4.4.1.1.1.3.3.5" xref="S3.E4.m1.4.4.4.1.1.1.3.3.5.cmml">n</mi></mrow></msub></mrow><mo maxsize="90%" minsize="90%" id="S3.E4.m1.4.4.4.1.1.3" xref="S3.E4.m1.4.4.4.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.2a" xref="S3.E4.m1.4.4.4.2.cmml">​</mo><msub id="S3.E4.m1.4.4.4.4" xref="S3.E4.m1.4.4.4.4.cmml"><mi mathsize="90%" id="S3.E4.m1.4.4.4.4.2" xref="S3.E4.m1.4.4.4.4.2.cmml">𝑾</mi><mrow id="S3.E4.m1.4.4.4.4.3" xref="S3.E4.m1.4.4.4.4.3.cmml"><mi mathsize="90%" id="S3.E4.m1.4.4.4.4.3.2" xref="S3.E4.m1.4.4.4.4.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.4.3.1" xref="S3.E4.m1.4.4.4.4.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E4.m1.4.4.4.4.3.3" xref="S3.E4.m1.4.4.4.4.3.3.cmml">p</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><and id="S3.E4.m1.4.4a.cmml" xref="S3.E4.m1.4.4"></and><apply id="S3.E4.m1.4.4b.cmml" xref="S3.E4.m1.4.4"><eq id="S3.E4.m1.4.4.6.cmml" xref="S3.E4.m1.4.4.6"></eq><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2"><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2">𝑷</ci><ci id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E4.m1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2">𝑷</ci><ci id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.3">𝑣</ci></apply></list><apply id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3.3"><times id="S3.E4.m1.3.3.3.2.cmml" xref="S3.E4.m1.3.3.3.2"></times><ci id="S3.E4.m1.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3">𝐴</ci><ci id="S3.E4.m1.3.3.3.4.cmml" xref="S3.E4.m1.3.3.3.4">𝑑</ci><ci id="S3.E4.m1.3.3.3.5.cmml" xref="S3.E4.m1.3.3.3.5">𝑎</ci><ci id="S3.E4.m1.3.3.3.6.cmml" xref="S3.E4.m1.3.3.3.6">𝑝</ci><ci id="S3.E4.m1.3.3.3.7.cmml" xref="S3.E4.m1.3.3.3.7">𝑡</ci><ci id="S3.E4.m1.3.3.3.8.cmml" xref="S3.E4.m1.3.3.3.8">𝑒</ci><ci id="S3.E4.m1.3.3.3.9.cmml" xref="S3.E4.m1.3.3.3.9">𝑟</ci><apply id="S3.E4.m1.3.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.3.1.1">superscript</csymbol><ci id="S3.E4.m1.3.3.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.3.1.1.1.2">𝒁</ci><apply id="S3.E4.m1.3.3.3.1.1.1.3.cmml" xref="S3.E4.m1.3.3.3.1.1.1.3"><minus id="S3.E4.m1.3.3.3.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.3.1.1.1.3.1"></minus><ci id="S3.E4.m1.3.3.3.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.3.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.E4.m1.3.3.3.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.3.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E4.m1.4.4c.cmml" xref="S3.E4.m1.4.4"><eq id="S3.E4.m1.4.4.7.cmml" xref="S3.E4.m1.4.4.7"></eq><share href="#S3.E4.m1.3.3.3.cmml" id="S3.E4.m1.4.4d.cmml" xref="S3.E4.m1.4.4"></share><apply id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"><times id="S3.E4.m1.4.4.4.2.cmml" xref="S3.E4.m1.4.4.4.2"></times><ci id="S3.E4.m1.4.4.4.3a.cmml" xref="S3.E4.m1.4.4.4.3"><mtext mathsize="90%" id="S3.E4.m1.4.4.4.3.cmml" xref="S3.E4.m1.4.4.4.3">Tanh</mtext></ci><apply id="S3.E4.m1.4.4.4.1.1.1.cmml" xref="S3.E4.m1.4.4.4.1.1"><times id="S3.E4.m1.4.4.4.1.1.1.1.cmml" xref="S3.E4.m1.4.4.4.1.1.1.1"></times><apply id="S3.E4.m1.4.4.4.1.1.1.2.cmml" xref="S3.E4.m1.4.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.4.1.1.1.2">superscript</csymbol><ci id="S3.E4.m1.4.4.4.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.4.1.1.1.2.2">𝒁</ci><apply id="S3.E4.m1.4.4.4.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.4.1.1.1.2.3"><minus id="S3.E4.m1.4.4.4.1.1.1.2.3.1.cmml" xref="S3.E4.m1.4.4.4.1.1.1.2.3.1"></minus><ci id="S3.E4.m1.4.4.4.1.1.1.2.3.2.cmml" xref="S3.E4.m1.4.4.4.1.1.1.2.3.2">𝑙</ci><cn type="integer" id="S3.E4.m1.4.4.4.1.1.1.2.3.3.cmml" xref="S3.E4.m1.4.4.4.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E4.m1.4.4.4.1.1.1.3.cmml" xref="S3.E4.m1.4.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.4.4.4.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.4.1.1.1.3.2">𝑾</ci><apply id="S3.E4.m1.4.4.4.1.1.1.3.3.cmml" xref="S3.E4.m1.4.4.4.1.1.1.3.3"><times id="S3.E4.m1.4.4.4.1.1.1.3.3.1.cmml" xref="S3.E4.m1.4.4.4.1.1.1.3.3.1"></times><ci id="S3.E4.m1.4.4.4.1.1.1.3.3.2.cmml" xref="S3.E4.m1.4.4.4.1.1.1.3.3.2">𝑑</ci><ci id="S3.E4.m1.4.4.4.1.1.1.3.3.3.cmml" xref="S3.E4.m1.4.4.4.1.1.1.3.3.3">𝑜</ci><ci id="S3.E4.m1.4.4.4.1.1.1.3.3.4.cmml" xref="S3.E4.m1.4.4.4.1.1.1.3.3.4">𝑤</ci><ci id="S3.E4.m1.4.4.4.1.1.1.3.3.5.cmml" xref="S3.E4.m1.4.4.4.1.1.1.3.3.5">𝑛</ci></apply></apply></apply><apply id="S3.E4.m1.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.4.1.cmml" xref="S3.E4.m1.4.4.4.4">subscript</csymbol><ci id="S3.E4.m1.4.4.4.4.2.cmml" xref="S3.E4.m1.4.4.4.4.2">𝑾</ci><apply id="S3.E4.m1.4.4.4.4.3.cmml" xref="S3.E4.m1.4.4.4.4.3"><times id="S3.E4.m1.4.4.4.4.3.1.cmml" xref="S3.E4.m1.4.4.4.4.3.1"></times><ci id="S3.E4.m1.4.4.4.4.3.2.cmml" xref="S3.E4.m1.4.4.4.4.3.2">𝑢</ci><ci id="S3.E4.m1.4.4.4.4.3.3.cmml" xref="S3.E4.m1.4.4.4.4.3.3">𝑝</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\small{\bm{P}}_{k},{\bm{P}}_{v}=Adapter({\bm{Z}}^{l-1})=\text{Tanh}({\bm{Z}}^{l-1}{\bm{W}}_{down}){\bm{W}}_{up}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS5.p1.3" class="ltx_p">where Tanh is the activation function, <math id="S3.SS5.p1.2.m1.1" class="ltx_Math" alttext="{\bm{W}}_{down}" display="inline"><semantics id="S3.SS5.p1.2.m1.1a"><msub id="S3.SS5.p1.2.m1.1.1" xref="S3.SS5.p1.2.m1.1.1.cmml"><mi id="S3.SS5.p1.2.m1.1.1.2" xref="S3.SS5.p1.2.m1.1.1.2.cmml">𝑾</mi><mrow id="S3.SS5.p1.2.m1.1.1.3" xref="S3.SS5.p1.2.m1.1.1.3.cmml"><mi id="S3.SS5.p1.2.m1.1.1.3.2" xref="S3.SS5.p1.2.m1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m1.1.1.3.1" xref="S3.SS5.p1.2.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.2.m1.1.1.3.3" xref="S3.SS5.p1.2.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m1.1.1.3.1a" xref="S3.SS5.p1.2.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.2.m1.1.1.3.4" xref="S3.SS5.p1.2.m1.1.1.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m1.1.1.3.1b" xref="S3.SS5.p1.2.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.2.m1.1.1.3.5" xref="S3.SS5.p1.2.m1.1.1.3.5.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m1.1b"><apply id="S3.SS5.p1.2.m1.1.1.cmml" xref="S3.SS5.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.2.m1.1.1.1.cmml" xref="S3.SS5.p1.2.m1.1.1">subscript</csymbol><ci id="S3.SS5.p1.2.m1.1.1.2.cmml" xref="S3.SS5.p1.2.m1.1.1.2">𝑾</ci><apply id="S3.SS5.p1.2.m1.1.1.3.cmml" xref="S3.SS5.p1.2.m1.1.1.3"><times id="S3.SS5.p1.2.m1.1.1.3.1.cmml" xref="S3.SS5.p1.2.m1.1.1.3.1"></times><ci id="S3.SS5.p1.2.m1.1.1.3.2.cmml" xref="S3.SS5.p1.2.m1.1.1.3.2">𝑑</ci><ci id="S3.SS5.p1.2.m1.1.1.3.3.cmml" xref="S3.SS5.p1.2.m1.1.1.3.3">𝑜</ci><ci id="S3.SS5.p1.2.m1.1.1.3.4.cmml" xref="S3.SS5.p1.2.m1.1.1.3.4">𝑤</ci><ci id="S3.SS5.p1.2.m1.1.1.3.5.cmml" xref="S3.SS5.p1.2.m1.1.1.3.5">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m1.1c">{\bm{W}}_{down}</annotation></semantics></math> and <math id="S3.SS5.p1.3.m2.1" class="ltx_Math" alttext="{\bm{W}}_{up}" display="inline"><semantics id="S3.SS5.p1.3.m2.1a"><msub id="S3.SS5.p1.3.m2.1.1" xref="S3.SS5.p1.3.m2.1.1.cmml"><mi id="S3.SS5.p1.3.m2.1.1.2" xref="S3.SS5.p1.3.m2.1.1.2.cmml">𝑾</mi><mrow id="S3.SS5.p1.3.m2.1.1.3" xref="S3.SS5.p1.3.m2.1.1.3.cmml"><mi id="S3.SS5.p1.3.m2.1.1.3.2" xref="S3.SS5.p1.3.m2.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.3.m2.1.1.3.1" xref="S3.SS5.p1.3.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.3.m2.1.1.3.3" xref="S3.SS5.p1.3.m2.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m2.1b"><apply id="S3.SS5.p1.3.m2.1.1.cmml" xref="S3.SS5.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.3.m2.1.1.1.cmml" xref="S3.SS5.p1.3.m2.1.1">subscript</csymbol><ci id="S3.SS5.p1.3.m2.1.1.2.cmml" xref="S3.SS5.p1.3.m2.1.1.2">𝑾</ci><apply id="S3.SS5.p1.3.m2.1.1.3.cmml" xref="S3.SS5.p1.3.m2.1.1.3"><times id="S3.SS5.p1.3.m2.1.1.3.1.cmml" xref="S3.SS5.p1.3.m2.1.1.3.1"></times><ci id="S3.SS5.p1.3.m2.1.1.3.2.cmml" xref="S3.SS5.p1.3.m2.1.1.3.2">𝑢</ci><ci id="S3.SS5.p1.3.m2.1.1.3.3.cmml" xref="S3.SS5.p1.3.m2.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m2.1c">{\bm{W}}_{up}</annotation></semantics></math> are parameters of the scaling layers of the adapter.
As a result, the output of one head of the self-attention layer with parallel attention is shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 Recap: Partial Model Personalization for CNN ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(c) and formulated as</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle head_{i}=" display="inline"><semantics id="S3.E5X.2.1.1.m1.1a"><mrow id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml"><mrow id="S3.E5X.2.1.1.m1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.2.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.2.2" xref="S3.E5X.2.1.1.m1.1.1.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.1.1.2.1" xref="S3.E5X.2.1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.E5X.2.1.1.m1.1.1.2.3" xref="S3.E5X.2.1.1.m1.1.1.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.1.1.2.1a" xref="S3.E5X.2.1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.E5X.2.1.1.m1.1.1.2.4" xref="S3.E5X.2.1.1.m1.1.1.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.1.1.2.1b" xref="S3.E5X.2.1.1.m1.1.1.2.1.cmml">​</mo><msub id="S3.E5X.2.1.1.m1.1.1.2.5" xref="S3.E5X.2.1.1.m1.1.1.2.5.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.2.5.2" xref="S3.E5X.2.1.1.m1.1.1.2.5.2.cmml">d</mi><mi id="S3.E5X.2.1.1.m1.1.1.2.5.3" xref="S3.E5X.2.1.1.m1.1.1.2.5.3.cmml">i</mi></msub></mrow><mo id="S3.E5X.2.1.1.m1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.cmml">=</mo><mi id="S3.E5X.2.1.1.m1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><apply id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1"><eq id="S3.E5X.2.1.1.m1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1"></eq><apply id="S3.E5X.2.1.1.m1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2"><times id="S3.E5X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.1"></times><ci id="S3.E5X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.2">ℎ</ci><ci id="S3.E5X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3">𝑒</ci><ci id="S3.E5X.2.1.1.m1.1.1.2.4.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.4">𝑎</ci><apply id="S3.E5X.2.1.1.m1.1.1.2.5.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.2.5.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.5">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.2.5.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.5.2">𝑑</ci><ci id="S3.E5X.2.1.1.m1.1.1.2.5.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.5.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="S3.E5X.2.1.1.m1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle head_{i}=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.3.2.2.m1.1" class="ltx_math_unparsed" alttext="\displaystyle Attention({\bm{Z}}^{l-1}{\bm{W}}_{q}^{(i)}," display="inline"><semantics id="S3.E5X.3.2.2.m1.1a"><mrow id="S3.E5X.3.2.2.m1.1b"><mi id="S3.E5X.3.2.2.m1.1.2">A</mi><mi id="S3.E5X.3.2.2.m1.1.3">t</mi><mi id="S3.E5X.3.2.2.m1.1.4">t</mi><mi id="S3.E5X.3.2.2.m1.1.5">e</mi><mi id="S3.E5X.3.2.2.m1.1.6">n</mi><mi id="S3.E5X.3.2.2.m1.1.7">t</mi><mi id="S3.E5X.3.2.2.m1.1.8">i</mi><mi id="S3.E5X.3.2.2.m1.1.9">o</mi><mi id="S3.E5X.3.2.2.m1.1.10">n</mi><mrow id="S3.E5X.3.2.2.m1.1.11"><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.11.1">(</mo><msup id="S3.E5X.3.2.2.m1.1.11.2"><mi id="S3.E5X.3.2.2.m1.1.11.2.2">𝒁</mi><mrow id="S3.E5X.3.2.2.m1.1.11.2.3"><mi id="S3.E5X.3.2.2.m1.1.11.2.3.2">l</mi><mo id="S3.E5X.3.2.2.m1.1.11.2.3.1">−</mo><mn id="S3.E5X.3.2.2.m1.1.11.2.3.3">1</mn></mrow></msup><msubsup id="S3.E5X.3.2.2.m1.1.11.3"><mi id="S3.E5X.3.2.2.m1.1.11.3.2.2">𝑾</mi><mi id="S3.E5X.3.2.2.m1.1.11.3.2.3">q</mi><mrow id="S3.E5X.3.2.2.m1.1.1.1.3"><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.3.1">(</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1">i</mi><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.3.2">)</mo></mrow></msubsup><mo id="S3.E5X.3.2.2.m1.1.11.4">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.1c">\displaystyle Attention({\bm{Z}}^{l-1}{\bm{W}}_{q}^{(i)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S3.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5Xa.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle{\bm{Z}}^{l-1}[s{\bm{P}}_{k},{\bm{W}}_{k}^{(i)}]," display="inline"><semantics id="S3.E5Xa.2.1.1.m1.2a"><mrow id="S3.E5Xa.2.1.1.m1.2.2.1" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E5Xa.2.1.1.m1.2.2.1.1" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.cmml"><msup id="S3.E5Xa.2.1.1.m1.2.2.1.1.4" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4.cmml"><mi id="S3.E5Xa.2.1.1.m1.2.2.1.1.4.2" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4.2.cmml">𝒁</mi><mrow id="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.2" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.2.cmml">l</mi><mo id="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.1" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.1.cmml">−</mo><mn id="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.3" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.3.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.2.2.1.1.3" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.3.cmml">​</mo><mrow id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.3.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.3" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.3.cmml">[</mo><mrow id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml">​</mo><msub id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3.2" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3.2.cmml">𝑷</mi><mi id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3.3" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.4" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.3.cmml">,</mo><msubsup id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2.2" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2.3" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml">k</mi><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.1.1.1.3.1" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml">(</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.1.1.1.3.2" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.5" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S3.E5Xa.2.1.1.m1.2.2.1.2" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.2b"><apply id="S3.E5Xa.2.1.1.m1.2.2.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1"><times id="S3.E5Xa.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.3"></times><apply id="S3.E5Xa.2.1.1.m1.2.2.1.1.4.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.2.2.1.1.4.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4">superscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.2.2.1.1.4.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4.2">𝒁</ci><apply id="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3"><minus id="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.1"></minus><ci id="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.2">𝑙</ci><cn type="integer" id="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.4.3.3">1</cn></apply></apply><interval closure="closed" id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2"><apply id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1"><times id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1"></times><ci id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.2">𝑠</ci><apply id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3.2">𝑷</ci><ci id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2.2">𝑾</ci><ci id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2.3">𝑘</ci></apply><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.2c">\displaystyle{\bm{Z}}^{l-1}[s{\bm{P}}_{k},{\bm{W}}_{k}^{(i)}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E5Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5Xb.2.1.1.m1.1" class="ltx_math_unparsed" alttext="\displaystyle{\bm{Z}}^{l-1}[s{\bm{P}}_{v},{\bm{W}}_{v}^{(i)}])." display="inline"><semantics id="S3.E5Xb.2.1.1.m1.1a"><mrow id="S3.E5Xb.2.1.1.m1.1b"><msup id="S3.E5Xb.2.1.1.m1.1.2"><mi id="S3.E5Xb.2.1.1.m1.1.2.2">𝒁</mi><mrow id="S3.E5Xb.2.1.1.m1.1.2.3"><mi id="S3.E5Xb.2.1.1.m1.1.2.3.2">l</mi><mo id="S3.E5Xb.2.1.1.m1.1.2.3.1">−</mo><mn id="S3.E5Xb.2.1.1.m1.1.2.3.3">1</mn></mrow></msup><mrow id="S3.E5Xb.2.1.1.m1.1.3"><mo stretchy="false" id="S3.E5Xb.2.1.1.m1.1.3.1">[</mo><mi id="S3.E5Xb.2.1.1.m1.1.3.2">s</mi><msub id="S3.E5Xb.2.1.1.m1.1.3.3"><mi id="S3.E5Xb.2.1.1.m1.1.3.3.2">𝑷</mi><mi id="S3.E5Xb.2.1.1.m1.1.3.3.3">v</mi></msub><mo id="S3.E5Xb.2.1.1.m1.1.3.4">,</mo><msubsup id="S3.E5Xb.2.1.1.m1.1.3.5"><mi id="S3.E5Xb.2.1.1.m1.1.3.5.2.2">𝑾</mi><mi id="S3.E5Xb.2.1.1.m1.1.3.5.2.3">v</mi><mrow id="S3.E5Xb.2.1.1.m1.1.1.1.3"><mo stretchy="false" id="S3.E5Xb.2.1.1.m1.1.1.1.3.1">(</mo><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1">i</mi><mo stretchy="false" id="S3.E5Xb.2.1.1.m1.1.1.1.3.2">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E5Xb.2.1.1.m1.1.3.6">]</mo></mrow><mo stretchy="false" id="S3.E5Xb.2.1.1.m1.1.4">)</mo><mo lspace="0em" id="S3.E5Xb.2.1.1.m1.1.5">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E5Xb.2.1.1.m1.1c">\displaystyle{\bm{Z}}^{l-1}[s{\bm{P}}_{v},{\bm{W}}_{v}^{(i)}]).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span><span id="S3.T2.29.1" class="ltx_text ltx_font_bold">Performance and required resources for each method.</span> The mean and standard deviation of the Top-1 Accuracy among all clients are reported. The bold style indicates the best performance in each dataset.</figcaption>
<div id="S3.T2.27.27" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:159.3pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-54.0pt,19.7pt) scale(0.800732968956513,0.800732968956513) ;">
<table id="S3.T2.27.27.27" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T2.27.27.27.28.1" class="ltx_tr">
<td id="S3.T2.27.27.27.28.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" rowspan="2"><span id="S3.T2.27.27.27.28.1.1.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S3.T2.27.27.27.28.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3"><span id="S3.T2.27.27.27.28.1.2.1" class="ltx_text ltx_font_bold">Performance</span></td>
<td id="S3.T2.27.27.27.28.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T2.27.27.27.28.1.3.1" class="ltx_text ltx_font_bold">Storage</span></td>
<td id="S3.T2.27.27.27.28.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T2.27.27.27.28.1.4.1" class="ltx_text ltx_font_bold">Computation</span></td>
<td id="S3.T2.27.27.27.28.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T2.27.27.27.28.1.5.1" class="ltx_text ltx_font_bold">Communication</span></td>
</tr>
<tr id="S3.T2.27.27.27.29.2" class="ltx_tr">
<td id="S3.T2.27.27.27.29.2.1" class="ltx_td ltx_align_center">CIFAR-100</td>
<td id="S3.T2.27.27.27.29.2.2" class="ltx_td ltx_align_center">OrganAMNIST</td>
<td id="S3.T2.27.27.27.29.2.3" class="ltx_td ltx_align_center ltx_border_r">Office-Home</td>
<td id="S3.T2.27.27.27.29.2.4" class="ltx_td ltx_align_center">(# Params)</td>
<td id="S3.T2.27.27.27.29.2.5" class="ltx_td ltx_align_center">(FLOPs)</td>
<td id="S3.T2.27.27.27.29.2.6" class="ltx_td ltx_align_center">(# Params)</td>
</tr>
<tr id="S3.T2.3.3.3.3" class="ltx_tr">
<td id="S3.T2.3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedAvg</td>
<td id="S3.T2.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T2.1.1.1.1.1.m1.1" class="ltx_Math" alttext="23.29_{\pm 11.31}" display="inline"><semantics id="S3.T2.1.1.1.1.1.m1.1a"><msub id="S3.T2.1.1.1.1.1.m1.1.1" xref="S3.T2.1.1.1.1.1.m1.1.1.cmml"><mn id="S3.T2.1.1.1.1.1.m1.1.1.2" xref="S3.T2.1.1.1.1.1.m1.1.1.2.cmml">23.29</mn><mrow id="S3.T2.1.1.1.1.1.m1.1.1.3" xref="S3.T2.1.1.1.1.1.m1.1.1.3.cmml"><mo id="S3.T2.1.1.1.1.1.m1.1.1.3a" xref="S3.T2.1.1.1.1.1.m1.1.1.3.cmml">±</mo><mn id="S3.T2.1.1.1.1.1.m1.1.1.3.2" xref="S3.T2.1.1.1.1.1.m1.1.1.3.2.cmml">11.31</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.1.1.m1.1b"><apply id="S3.T2.1.1.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.T2.1.1.1.1.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.T2.1.1.1.1.1.m1.1.1.2">23.29</cn><apply id="S3.T2.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.T2.1.1.1.1.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S3.T2.1.1.1.1.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S3.T2.1.1.1.1.1.m1.1.1.3.2">11.31</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.1.1.m1.1c">23.29_{\pm 11.31}</annotation></semantics></math></td>
<td id="S3.T2.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T2.2.2.2.2.2.m1.1" class="ltx_Math" alttext="87.31_{\pm 5.98}" display="inline"><semantics id="S3.T2.2.2.2.2.2.m1.1a"><msub id="S3.T2.2.2.2.2.2.m1.1.1" xref="S3.T2.2.2.2.2.2.m1.1.1.cmml"><mn id="S3.T2.2.2.2.2.2.m1.1.1.2" xref="S3.T2.2.2.2.2.2.m1.1.1.2.cmml">87.31</mn><mrow id="S3.T2.2.2.2.2.2.m1.1.1.3" xref="S3.T2.2.2.2.2.2.m1.1.1.3.cmml"><mo id="S3.T2.2.2.2.2.2.m1.1.1.3a" xref="S3.T2.2.2.2.2.2.m1.1.1.3.cmml">±</mo><mn id="S3.T2.2.2.2.2.2.m1.1.1.3.2" xref="S3.T2.2.2.2.2.2.m1.1.1.3.2.cmml">5.98</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.2.2.m1.1b"><apply id="S3.T2.2.2.2.2.2.m1.1.1.cmml" xref="S3.T2.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.2.2.2.2.2.m1.1.1.1.cmml" xref="S3.T2.2.2.2.2.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.2.2.2.2.2.m1.1.1.2.cmml" xref="S3.T2.2.2.2.2.2.m1.1.1.2">87.31</cn><apply id="S3.T2.2.2.2.2.2.m1.1.1.3.cmml" xref="S3.T2.2.2.2.2.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.2.2.2.2.2.m1.1.1.3.1.cmml" xref="S3.T2.2.2.2.2.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.2.2.2.2.2.m1.1.1.3.2.cmml" xref="S3.T2.2.2.2.2.2.m1.1.1.3.2">5.98</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.2.2.m1.1c">87.31_{\pm 5.98}</annotation></semantics></math></td>
<td id="S3.T2.3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S3.T2.3.3.3.3.3.m1.1" class="ltx_Math" alttext="21.47_{\pm 6.24}" display="inline"><semantics id="S3.T2.3.3.3.3.3.m1.1a"><msub id="S3.T2.3.3.3.3.3.m1.1.1" xref="S3.T2.3.3.3.3.3.m1.1.1.cmml"><mn id="S3.T2.3.3.3.3.3.m1.1.1.2" xref="S3.T2.3.3.3.3.3.m1.1.1.2.cmml">21.47</mn><mrow id="S3.T2.3.3.3.3.3.m1.1.1.3" xref="S3.T2.3.3.3.3.3.m1.1.1.3.cmml"><mo id="S3.T2.3.3.3.3.3.m1.1.1.3a" xref="S3.T2.3.3.3.3.3.m1.1.1.3.cmml">±</mo><mn id="S3.T2.3.3.3.3.3.m1.1.1.3.2" xref="S3.T2.3.3.3.3.3.m1.1.1.3.2.cmml">6.24</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.3.3.3.m1.1b"><apply id="S3.T2.3.3.3.3.3.m1.1.1.cmml" xref="S3.T2.3.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.3.3.3.3.3.m1.1.1.1.cmml" xref="S3.T2.3.3.3.3.3.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.3.3.3.3.3.m1.1.1.2.cmml" xref="S3.T2.3.3.3.3.3.m1.1.1.2">21.47</cn><apply id="S3.T2.3.3.3.3.3.m1.1.1.3.cmml" xref="S3.T2.3.3.3.3.3.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.3.3.3.3.3.m1.1.1.3.1.cmml" xref="S3.T2.3.3.3.3.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.3.3.3.3.3.m1.1.1.3.2.cmml" xref="S3.T2.3.3.3.3.3.m1.1.1.3.2">6.24</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.3.3.3.m1.1c">21.47_{\pm 6.24}</annotation></semantics></math></td>
<td id="S3.T2.3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t">21.03M (100%)</td>
<td id="S3.T2.3.3.3.3.6" class="ltx_td ltx_align_center ltx_border_t">65.65M (100%)</td>
<td id="S3.T2.3.3.3.3.7" class="ltx_td ltx_align_center ltx_border_t">21.03M (100%)</td>
</tr>
<tr id="S3.T2.6.6.6.6" class="ltx_tr">
<td id="S3.T2.6.6.6.6.4" class="ltx_td ltx_align_center ltx_border_r">Local</td>
<td id="S3.T2.4.4.4.4.1" class="ltx_td ltx_align_center"><math id="S3.T2.4.4.4.4.1.m1.1" class="ltx_Math" alttext="34.74_{\pm 9.36}" display="inline"><semantics id="S3.T2.4.4.4.4.1.m1.1a"><msub id="S3.T2.4.4.4.4.1.m1.1.1" xref="S3.T2.4.4.4.4.1.m1.1.1.cmml"><mn id="S3.T2.4.4.4.4.1.m1.1.1.2" xref="S3.T2.4.4.4.4.1.m1.1.1.2.cmml">34.74</mn><mrow id="S3.T2.4.4.4.4.1.m1.1.1.3" xref="S3.T2.4.4.4.4.1.m1.1.1.3.cmml"><mo id="S3.T2.4.4.4.4.1.m1.1.1.3a" xref="S3.T2.4.4.4.4.1.m1.1.1.3.cmml">±</mo><mn id="S3.T2.4.4.4.4.1.m1.1.1.3.2" xref="S3.T2.4.4.4.4.1.m1.1.1.3.2.cmml">9.36</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.4.4.1.m1.1b"><apply id="S3.T2.4.4.4.4.1.m1.1.1.cmml" xref="S3.T2.4.4.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.4.4.4.4.1.m1.1.1.1.cmml" xref="S3.T2.4.4.4.4.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.4.4.4.4.1.m1.1.1.2.cmml" xref="S3.T2.4.4.4.4.1.m1.1.1.2">34.74</cn><apply id="S3.T2.4.4.4.4.1.m1.1.1.3.cmml" xref="S3.T2.4.4.4.4.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.4.4.4.4.1.m1.1.1.3.1.cmml" xref="S3.T2.4.4.4.4.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.4.4.4.4.1.m1.1.1.3.2.cmml" xref="S3.T2.4.4.4.4.1.m1.1.1.3.2">9.36</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.4.4.1.m1.1c">34.74_{\pm 9.36}</annotation></semantics></math></td>
<td id="S3.T2.5.5.5.5.2" class="ltx_td ltx_align_center"><math id="S3.T2.5.5.5.5.2.m1.1" class="ltx_Math" alttext="78.26_{\pm 11.07}" display="inline"><semantics id="S3.T2.5.5.5.5.2.m1.1a"><msub id="S3.T2.5.5.5.5.2.m1.1.1" xref="S3.T2.5.5.5.5.2.m1.1.1.cmml"><mn id="S3.T2.5.5.5.5.2.m1.1.1.2" xref="S3.T2.5.5.5.5.2.m1.1.1.2.cmml">78.26</mn><mrow id="S3.T2.5.5.5.5.2.m1.1.1.3" xref="S3.T2.5.5.5.5.2.m1.1.1.3.cmml"><mo id="S3.T2.5.5.5.5.2.m1.1.1.3a" xref="S3.T2.5.5.5.5.2.m1.1.1.3.cmml">±</mo><mn id="S3.T2.5.5.5.5.2.m1.1.1.3.2" xref="S3.T2.5.5.5.5.2.m1.1.1.3.2.cmml">11.07</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.5.5.5.5.2.m1.1b"><apply id="S3.T2.5.5.5.5.2.m1.1.1.cmml" xref="S3.T2.5.5.5.5.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.5.5.5.5.2.m1.1.1.1.cmml" xref="S3.T2.5.5.5.5.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.5.5.5.5.2.m1.1.1.2.cmml" xref="S3.T2.5.5.5.5.2.m1.1.1.2">78.26</cn><apply id="S3.T2.5.5.5.5.2.m1.1.1.3.cmml" xref="S3.T2.5.5.5.5.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.5.5.5.5.2.m1.1.1.3.1.cmml" xref="S3.T2.5.5.5.5.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.5.5.5.5.2.m1.1.1.3.2.cmml" xref="S3.T2.5.5.5.5.2.m1.1.1.3.2">11.07</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.5.5.5.5.2.m1.1c">78.26_{\pm 11.07}</annotation></semantics></math></td>
<td id="S3.T2.6.6.6.6.3" class="ltx_td ltx_align_center ltx_border_r"><math id="S3.T2.6.6.6.6.3.m1.1" class="ltx_Math" alttext="20.39_{\pm 7.26}" display="inline"><semantics id="S3.T2.6.6.6.6.3.m1.1a"><msub id="S3.T2.6.6.6.6.3.m1.1.1" xref="S3.T2.6.6.6.6.3.m1.1.1.cmml"><mn id="S3.T2.6.6.6.6.3.m1.1.1.2" xref="S3.T2.6.6.6.6.3.m1.1.1.2.cmml">20.39</mn><mrow id="S3.T2.6.6.6.6.3.m1.1.1.3" xref="S3.T2.6.6.6.6.3.m1.1.1.3.cmml"><mo id="S3.T2.6.6.6.6.3.m1.1.1.3a" xref="S3.T2.6.6.6.6.3.m1.1.1.3.cmml">±</mo><mn id="S3.T2.6.6.6.6.3.m1.1.1.3.2" xref="S3.T2.6.6.6.6.3.m1.1.1.3.2.cmml">7.26</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.6.6.6.6.3.m1.1b"><apply id="S3.T2.6.6.6.6.3.m1.1.1.cmml" xref="S3.T2.6.6.6.6.3.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.6.6.6.6.3.m1.1.1.1.cmml" xref="S3.T2.6.6.6.6.3.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.6.6.6.6.3.m1.1.1.2.cmml" xref="S3.T2.6.6.6.6.3.m1.1.1.2">20.39</cn><apply id="S3.T2.6.6.6.6.3.m1.1.1.3.cmml" xref="S3.T2.6.6.6.6.3.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.6.6.6.6.3.m1.1.1.3.1.cmml" xref="S3.T2.6.6.6.6.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.6.6.6.6.3.m1.1.1.3.2.cmml" xref="S3.T2.6.6.6.6.3.m1.1.1.3.2">7.26</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.6.6.6.6.3.m1.1c">20.39_{\pm 7.26}</annotation></semantics></math></td>
<td id="S3.T2.6.6.6.6.5" class="ltx_td ltx_align_center">21.03M (100%)</td>
<td id="S3.T2.6.6.6.6.6" class="ltx_td ltx_align_center">65.65M (100%)</td>
<td id="S3.T2.6.6.6.6.7" class="ltx_td ltx_align_center">0 (0%)</td>
</tr>
<tr id="S3.T2.9.9.9.9" class="ltx_tr">
<td id="S3.T2.9.9.9.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">APFL</td>
<td id="S3.T2.7.7.7.7.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T2.7.7.7.7.1.m1.1" class="ltx_Math" alttext="44.88_{\pm 10.50}" display="inline"><semantics id="S3.T2.7.7.7.7.1.m1.1a"><msub id="S3.T2.7.7.7.7.1.m1.1.1" xref="S3.T2.7.7.7.7.1.m1.1.1.cmml"><mn id="S3.T2.7.7.7.7.1.m1.1.1.2" xref="S3.T2.7.7.7.7.1.m1.1.1.2.cmml">44.88</mn><mrow id="S3.T2.7.7.7.7.1.m1.1.1.3" xref="S3.T2.7.7.7.7.1.m1.1.1.3.cmml"><mo id="S3.T2.7.7.7.7.1.m1.1.1.3a" xref="S3.T2.7.7.7.7.1.m1.1.1.3.cmml">±</mo><mn id="S3.T2.7.7.7.7.1.m1.1.1.3.2" xref="S3.T2.7.7.7.7.1.m1.1.1.3.2.cmml">10.50</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.7.7.7.7.1.m1.1b"><apply id="S3.T2.7.7.7.7.1.m1.1.1.cmml" xref="S3.T2.7.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.7.7.7.7.1.m1.1.1.1.cmml" xref="S3.T2.7.7.7.7.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.7.7.7.7.1.m1.1.1.2.cmml" xref="S3.T2.7.7.7.7.1.m1.1.1.2">44.88</cn><apply id="S3.T2.7.7.7.7.1.m1.1.1.3.cmml" xref="S3.T2.7.7.7.7.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.7.7.7.7.1.m1.1.1.3.1.cmml" xref="S3.T2.7.7.7.7.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.7.7.7.7.1.m1.1.1.3.2.cmml" xref="S3.T2.7.7.7.7.1.m1.1.1.3.2">10.50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.7.7.7.7.1.m1.1c">44.88_{\pm 10.50}</annotation></semantics></math></td>
<td id="S3.T2.8.8.8.8.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T2.8.8.8.8.2.m1.1" class="ltx_Math" alttext="89.74_{\pm 5.83}" display="inline"><semantics id="S3.T2.8.8.8.8.2.m1.1a"><msub id="S3.T2.8.8.8.8.2.m1.1.1" xref="S3.T2.8.8.8.8.2.m1.1.1.cmml"><mn id="S3.T2.8.8.8.8.2.m1.1.1.2" xref="S3.T2.8.8.8.8.2.m1.1.1.2.cmml">89.74</mn><mrow id="S3.T2.8.8.8.8.2.m1.1.1.3" xref="S3.T2.8.8.8.8.2.m1.1.1.3.cmml"><mo id="S3.T2.8.8.8.8.2.m1.1.1.3a" xref="S3.T2.8.8.8.8.2.m1.1.1.3.cmml">±</mo><mn id="S3.T2.8.8.8.8.2.m1.1.1.3.2" xref="S3.T2.8.8.8.8.2.m1.1.1.3.2.cmml">5.83</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.8.8.8.8.2.m1.1b"><apply id="S3.T2.8.8.8.8.2.m1.1.1.cmml" xref="S3.T2.8.8.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.8.8.8.8.2.m1.1.1.1.cmml" xref="S3.T2.8.8.8.8.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.8.8.8.8.2.m1.1.1.2.cmml" xref="S3.T2.8.8.8.8.2.m1.1.1.2">89.74</cn><apply id="S3.T2.8.8.8.8.2.m1.1.1.3.cmml" xref="S3.T2.8.8.8.8.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.8.8.8.8.2.m1.1.1.3.1.cmml" xref="S3.T2.8.8.8.8.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.8.8.8.8.2.m1.1.1.3.2.cmml" xref="S3.T2.8.8.8.8.2.m1.1.1.3.2">5.83</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.8.8.8.8.2.m1.1c">89.74_{\pm 5.83}</annotation></semantics></math></td>
<td id="S3.T2.9.9.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S3.T2.9.9.9.9.3.m1.1" class="ltx_Math" alttext="24.23_{\pm 7.02}" display="inline"><semantics id="S3.T2.9.9.9.9.3.m1.1a"><msub id="S3.T2.9.9.9.9.3.m1.1.1" xref="S3.T2.9.9.9.9.3.m1.1.1.cmml"><mn id="S3.T2.9.9.9.9.3.m1.1.1.2" xref="S3.T2.9.9.9.9.3.m1.1.1.2.cmml">24.23</mn><mrow id="S3.T2.9.9.9.9.3.m1.1.1.3" xref="S3.T2.9.9.9.9.3.m1.1.1.3.cmml"><mo id="S3.T2.9.9.9.9.3.m1.1.1.3a" xref="S3.T2.9.9.9.9.3.m1.1.1.3.cmml">±</mo><mn id="S3.T2.9.9.9.9.3.m1.1.1.3.2" xref="S3.T2.9.9.9.9.3.m1.1.1.3.2.cmml">7.02</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.9.9.9.9.3.m1.1b"><apply id="S3.T2.9.9.9.9.3.m1.1.1.cmml" xref="S3.T2.9.9.9.9.3.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.9.9.9.9.3.m1.1.1.1.cmml" xref="S3.T2.9.9.9.9.3.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.9.9.9.9.3.m1.1.1.2.cmml" xref="S3.T2.9.9.9.9.3.m1.1.1.2">24.23</cn><apply id="S3.T2.9.9.9.9.3.m1.1.1.3.cmml" xref="S3.T2.9.9.9.9.3.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.9.9.9.9.3.m1.1.1.3.1.cmml" xref="S3.T2.9.9.9.9.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.9.9.9.9.3.m1.1.1.3.2.cmml" xref="S3.T2.9.9.9.9.3.m1.1.1.3.2">7.02</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.9.9.9.9.3.m1.1c">24.23_{\pm 7.02}</annotation></semantics></math></td>
<td id="S3.T2.9.9.9.9.5" class="ltx_td ltx_align_center ltx_border_t">42.06M (200%)</td>
<td id="S3.T2.9.9.9.9.6" class="ltx_td ltx_align_center ltx_border_t">131.30M (200%)</td>
<td id="S3.T2.9.9.9.9.7" class="ltx_td ltx_align_center ltx_border_t">21.03M (100%)</td>
</tr>
<tr id="S3.T2.12.12.12.12" class="ltx_tr">
<td id="S3.T2.12.12.12.12.4" class="ltx_td ltx_align_center ltx_border_r">Per-FedAVG</td>
<td id="S3.T2.10.10.10.10.1" class="ltx_td ltx_align_center"><math id="S3.T2.10.10.10.10.1.m1.1" class="ltx_Math" alttext="33.86_{\pm 8.01}" display="inline"><semantics id="S3.T2.10.10.10.10.1.m1.1a"><msub id="S3.T2.10.10.10.10.1.m1.1.1" xref="S3.T2.10.10.10.10.1.m1.1.1.cmml"><mn id="S3.T2.10.10.10.10.1.m1.1.1.2" xref="S3.T2.10.10.10.10.1.m1.1.1.2.cmml">33.86</mn><mrow id="S3.T2.10.10.10.10.1.m1.1.1.3" xref="S3.T2.10.10.10.10.1.m1.1.1.3.cmml"><mo id="S3.T2.10.10.10.10.1.m1.1.1.3a" xref="S3.T2.10.10.10.10.1.m1.1.1.3.cmml">±</mo><mn id="S3.T2.10.10.10.10.1.m1.1.1.3.2" xref="S3.T2.10.10.10.10.1.m1.1.1.3.2.cmml">8.01</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.10.10.10.10.1.m1.1b"><apply id="S3.T2.10.10.10.10.1.m1.1.1.cmml" xref="S3.T2.10.10.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.10.10.10.10.1.m1.1.1.1.cmml" xref="S3.T2.10.10.10.10.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.10.10.10.10.1.m1.1.1.2.cmml" xref="S3.T2.10.10.10.10.1.m1.1.1.2">33.86</cn><apply id="S3.T2.10.10.10.10.1.m1.1.1.3.cmml" xref="S3.T2.10.10.10.10.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.10.10.10.10.1.m1.1.1.3.1.cmml" xref="S3.T2.10.10.10.10.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.10.10.10.10.1.m1.1.1.3.2.cmml" xref="S3.T2.10.10.10.10.1.m1.1.1.3.2">8.01</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.10.10.10.10.1.m1.1c">33.86_{\pm 8.01}</annotation></semantics></math></td>
<td id="S3.T2.11.11.11.11.2" class="ltx_td ltx_align_center"><math id="S3.T2.11.11.11.11.2.m1.1" class="ltx_Math" alttext="82.81_{\pm 7.13}" display="inline"><semantics id="S3.T2.11.11.11.11.2.m1.1a"><msub id="S3.T2.11.11.11.11.2.m1.1.1" xref="S3.T2.11.11.11.11.2.m1.1.1.cmml"><mn id="S3.T2.11.11.11.11.2.m1.1.1.2" xref="S3.T2.11.11.11.11.2.m1.1.1.2.cmml">82.81</mn><mrow id="S3.T2.11.11.11.11.2.m1.1.1.3" xref="S3.T2.11.11.11.11.2.m1.1.1.3.cmml"><mo id="S3.T2.11.11.11.11.2.m1.1.1.3a" xref="S3.T2.11.11.11.11.2.m1.1.1.3.cmml">±</mo><mn id="S3.T2.11.11.11.11.2.m1.1.1.3.2" xref="S3.T2.11.11.11.11.2.m1.1.1.3.2.cmml">7.13</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.11.11.11.11.2.m1.1b"><apply id="S3.T2.11.11.11.11.2.m1.1.1.cmml" xref="S3.T2.11.11.11.11.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.11.11.11.11.2.m1.1.1.1.cmml" xref="S3.T2.11.11.11.11.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.11.11.11.11.2.m1.1.1.2.cmml" xref="S3.T2.11.11.11.11.2.m1.1.1.2">82.81</cn><apply id="S3.T2.11.11.11.11.2.m1.1.1.3.cmml" xref="S3.T2.11.11.11.11.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.11.11.11.11.2.m1.1.1.3.1.cmml" xref="S3.T2.11.11.11.11.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.11.11.11.11.2.m1.1.1.3.2.cmml" xref="S3.T2.11.11.11.11.2.m1.1.1.3.2">7.13</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.11.11.11.11.2.m1.1c">82.81_{\pm 7.13}</annotation></semantics></math></td>
<td id="S3.T2.12.12.12.12.3" class="ltx_td ltx_align_center ltx_border_r"><math id="S3.T2.12.12.12.12.3.m1.1" class="ltx_Math" alttext="17.09_{\pm 4.83}" display="inline"><semantics id="S3.T2.12.12.12.12.3.m1.1a"><msub id="S3.T2.12.12.12.12.3.m1.1.1" xref="S3.T2.12.12.12.12.3.m1.1.1.cmml"><mn id="S3.T2.12.12.12.12.3.m1.1.1.2" xref="S3.T2.12.12.12.12.3.m1.1.1.2.cmml">17.09</mn><mrow id="S3.T2.12.12.12.12.3.m1.1.1.3" xref="S3.T2.12.12.12.12.3.m1.1.1.3.cmml"><mo id="S3.T2.12.12.12.12.3.m1.1.1.3a" xref="S3.T2.12.12.12.12.3.m1.1.1.3.cmml">±</mo><mn id="S3.T2.12.12.12.12.3.m1.1.1.3.2" xref="S3.T2.12.12.12.12.3.m1.1.1.3.2.cmml">4.83</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.12.12.12.12.3.m1.1b"><apply id="S3.T2.12.12.12.12.3.m1.1.1.cmml" xref="S3.T2.12.12.12.12.3.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.12.12.12.12.3.m1.1.1.1.cmml" xref="S3.T2.12.12.12.12.3.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.12.12.12.12.3.m1.1.1.2.cmml" xref="S3.T2.12.12.12.12.3.m1.1.1.2">17.09</cn><apply id="S3.T2.12.12.12.12.3.m1.1.1.3.cmml" xref="S3.T2.12.12.12.12.3.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.12.12.12.12.3.m1.1.1.3.1.cmml" xref="S3.T2.12.12.12.12.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.12.12.12.12.3.m1.1.1.3.2.cmml" xref="S3.T2.12.12.12.12.3.m1.1.1.3.2">4.83</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.12.12.12.12.3.m1.1c">17.09_{\pm 4.83}</annotation></semantics></math></td>
<td id="S3.T2.12.12.12.12.5" class="ltx_td ltx_align_center">21.03M (100%)</td>
<td id="S3.T2.12.12.12.12.6" class="ltx_td ltx_align_center">131.30M (200%)</td>
<td id="S3.T2.12.12.12.12.7" class="ltx_td ltx_align_center">21.03M (100%)</td>
</tr>
<tr id="S3.T2.15.15.15.15" class="ltx_tr">
<td id="S3.T2.15.15.15.15.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedBN</td>
<td id="S3.T2.13.13.13.13.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T2.13.13.13.13.1.m1.1" class="ltx_Math" alttext="23.94_{\pm 11.19}" display="inline"><semantics id="S3.T2.13.13.13.13.1.m1.1a"><msub id="S3.T2.13.13.13.13.1.m1.1.1" xref="S3.T2.13.13.13.13.1.m1.1.1.cmml"><mn id="S3.T2.13.13.13.13.1.m1.1.1.2" xref="S3.T2.13.13.13.13.1.m1.1.1.2.cmml">23.94</mn><mrow id="S3.T2.13.13.13.13.1.m1.1.1.3" xref="S3.T2.13.13.13.13.1.m1.1.1.3.cmml"><mo id="S3.T2.13.13.13.13.1.m1.1.1.3a" xref="S3.T2.13.13.13.13.1.m1.1.1.3.cmml">±</mo><mn id="S3.T2.13.13.13.13.1.m1.1.1.3.2" xref="S3.T2.13.13.13.13.1.m1.1.1.3.2.cmml">11.19</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.13.13.13.13.1.m1.1b"><apply id="S3.T2.13.13.13.13.1.m1.1.1.cmml" xref="S3.T2.13.13.13.13.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.13.13.13.13.1.m1.1.1.1.cmml" xref="S3.T2.13.13.13.13.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.13.13.13.13.1.m1.1.1.2.cmml" xref="S3.T2.13.13.13.13.1.m1.1.1.2">23.94</cn><apply id="S3.T2.13.13.13.13.1.m1.1.1.3.cmml" xref="S3.T2.13.13.13.13.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.13.13.13.13.1.m1.1.1.3.1.cmml" xref="S3.T2.13.13.13.13.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.13.13.13.13.1.m1.1.1.3.2.cmml" xref="S3.T2.13.13.13.13.1.m1.1.1.3.2">11.19</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.13.13.13.13.1.m1.1c">23.94_{\pm 11.19}</annotation></semantics></math></td>
<td id="S3.T2.14.14.14.14.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T2.14.14.14.14.2.m1.1" class="ltx_Math" alttext="87.63_{\pm 5.78}" display="inline"><semantics id="S3.T2.14.14.14.14.2.m1.1a"><msub id="S3.T2.14.14.14.14.2.m1.1.1" xref="S3.T2.14.14.14.14.2.m1.1.1.cmml"><mn id="S3.T2.14.14.14.14.2.m1.1.1.2" xref="S3.T2.14.14.14.14.2.m1.1.1.2.cmml">87.63</mn><mrow id="S3.T2.14.14.14.14.2.m1.1.1.3" xref="S3.T2.14.14.14.14.2.m1.1.1.3.cmml"><mo id="S3.T2.14.14.14.14.2.m1.1.1.3a" xref="S3.T2.14.14.14.14.2.m1.1.1.3.cmml">±</mo><mn id="S3.T2.14.14.14.14.2.m1.1.1.3.2" xref="S3.T2.14.14.14.14.2.m1.1.1.3.2.cmml">5.78</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.14.14.14.14.2.m1.1b"><apply id="S3.T2.14.14.14.14.2.m1.1.1.cmml" xref="S3.T2.14.14.14.14.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.14.14.14.14.2.m1.1.1.1.cmml" xref="S3.T2.14.14.14.14.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.14.14.14.14.2.m1.1.1.2.cmml" xref="S3.T2.14.14.14.14.2.m1.1.1.2">87.63</cn><apply id="S3.T2.14.14.14.14.2.m1.1.1.3.cmml" xref="S3.T2.14.14.14.14.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.14.14.14.14.2.m1.1.1.3.1.cmml" xref="S3.T2.14.14.14.14.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.14.14.14.14.2.m1.1.1.3.2.cmml" xref="S3.T2.14.14.14.14.2.m1.1.1.3.2">5.78</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.14.14.14.14.2.m1.1c">87.63_{\pm 5.78}</annotation></semantics></math></td>
<td id="S3.T2.15.15.15.15.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S3.T2.15.15.15.15.3.m1.1" class="ltx_Math" alttext="21.25_{\pm 5.89}" display="inline"><semantics id="S3.T2.15.15.15.15.3.m1.1a"><msub id="S3.T2.15.15.15.15.3.m1.1.1" xref="S3.T2.15.15.15.15.3.m1.1.1.cmml"><mn id="S3.T2.15.15.15.15.3.m1.1.1.2" xref="S3.T2.15.15.15.15.3.m1.1.1.2.cmml">21.25</mn><mrow id="S3.T2.15.15.15.15.3.m1.1.1.3" xref="S3.T2.15.15.15.15.3.m1.1.1.3.cmml"><mo id="S3.T2.15.15.15.15.3.m1.1.1.3a" xref="S3.T2.15.15.15.15.3.m1.1.1.3.cmml">±</mo><mn id="S3.T2.15.15.15.15.3.m1.1.1.3.2" xref="S3.T2.15.15.15.15.3.m1.1.1.3.2.cmml">5.89</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.15.15.15.15.3.m1.1b"><apply id="S3.T2.15.15.15.15.3.m1.1.1.cmml" xref="S3.T2.15.15.15.15.3.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.15.15.15.15.3.m1.1.1.1.cmml" xref="S3.T2.15.15.15.15.3.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.15.15.15.15.3.m1.1.1.2.cmml" xref="S3.T2.15.15.15.15.3.m1.1.1.2">21.25</cn><apply id="S3.T2.15.15.15.15.3.m1.1.1.3.cmml" xref="S3.T2.15.15.15.15.3.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.15.15.15.15.3.m1.1.1.3.1.cmml" xref="S3.T2.15.15.15.15.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.15.15.15.15.3.m1.1.1.3.2.cmml" xref="S3.T2.15.15.15.15.3.m1.1.1.3.2">5.89</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.15.15.15.15.3.m1.1c">21.25_{\pm 5.89}</annotation></semantics></math></td>
<td id="S3.T2.15.15.15.15.5" class="ltx_td ltx_align_center ltx_border_t">21.03M (100%)</td>
<td id="S3.T2.15.15.15.15.6" class="ltx_td ltx_align_center ltx_border_t">65.65M (100%)</td>
<td id="S3.T2.15.15.15.15.7" class="ltx_td ltx_align_center ltx_border_t">21.01M (100%)</td>
</tr>
<tr id="S3.T2.18.18.18.18" class="ltx_tr">
<td id="S3.T2.18.18.18.18.4" class="ltx_td ltx_align_center ltx_border_r">FedBABU</td>
<td id="S3.T2.16.16.16.16.1" class="ltx_td ltx_align_center"><math id="S3.T2.16.16.16.16.1.m1.1" class="ltx_Math" alttext="41.41_{\pm 8.87}" display="inline"><semantics id="S3.T2.16.16.16.16.1.m1.1a"><msub id="S3.T2.16.16.16.16.1.m1.1.1" xref="S3.T2.16.16.16.16.1.m1.1.1.cmml"><mn id="S3.T2.16.16.16.16.1.m1.1.1.2" xref="S3.T2.16.16.16.16.1.m1.1.1.2.cmml">41.41</mn><mrow id="S3.T2.16.16.16.16.1.m1.1.1.3" xref="S3.T2.16.16.16.16.1.m1.1.1.3.cmml"><mo id="S3.T2.16.16.16.16.1.m1.1.1.3a" xref="S3.T2.16.16.16.16.1.m1.1.1.3.cmml">±</mo><mn id="S3.T2.16.16.16.16.1.m1.1.1.3.2" xref="S3.T2.16.16.16.16.1.m1.1.1.3.2.cmml">8.87</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.16.16.16.16.1.m1.1b"><apply id="S3.T2.16.16.16.16.1.m1.1.1.cmml" xref="S3.T2.16.16.16.16.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.16.16.16.16.1.m1.1.1.1.cmml" xref="S3.T2.16.16.16.16.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.16.16.16.16.1.m1.1.1.2.cmml" xref="S3.T2.16.16.16.16.1.m1.1.1.2">41.41</cn><apply id="S3.T2.16.16.16.16.1.m1.1.1.3.cmml" xref="S3.T2.16.16.16.16.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.16.16.16.16.1.m1.1.1.3.1.cmml" xref="S3.T2.16.16.16.16.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.16.16.16.16.1.m1.1.1.3.2.cmml" xref="S3.T2.16.16.16.16.1.m1.1.1.3.2">8.87</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.16.16.16.16.1.m1.1c">41.41_{\pm 8.87}</annotation></semantics></math></td>
<td id="S3.T2.17.17.17.17.2" class="ltx_td ltx_align_center"><math id="S3.T2.17.17.17.17.2.m1.1" class="ltx_Math" alttext="88.38_{\pm 7.16}" display="inline"><semantics id="S3.T2.17.17.17.17.2.m1.1a"><msub id="S3.T2.17.17.17.17.2.m1.1.1" xref="S3.T2.17.17.17.17.2.m1.1.1.cmml"><mn id="S3.T2.17.17.17.17.2.m1.1.1.2" xref="S3.T2.17.17.17.17.2.m1.1.1.2.cmml">88.38</mn><mrow id="S3.T2.17.17.17.17.2.m1.1.1.3" xref="S3.T2.17.17.17.17.2.m1.1.1.3.cmml"><mo id="S3.T2.17.17.17.17.2.m1.1.1.3a" xref="S3.T2.17.17.17.17.2.m1.1.1.3.cmml">±</mo><mn id="S3.T2.17.17.17.17.2.m1.1.1.3.2" xref="S3.T2.17.17.17.17.2.m1.1.1.3.2.cmml">7.16</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.17.17.17.17.2.m1.1b"><apply id="S3.T2.17.17.17.17.2.m1.1.1.cmml" xref="S3.T2.17.17.17.17.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.17.17.17.17.2.m1.1.1.1.cmml" xref="S3.T2.17.17.17.17.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.17.17.17.17.2.m1.1.1.2.cmml" xref="S3.T2.17.17.17.17.2.m1.1.1.2">88.38</cn><apply id="S3.T2.17.17.17.17.2.m1.1.1.3.cmml" xref="S3.T2.17.17.17.17.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.17.17.17.17.2.m1.1.1.3.1.cmml" xref="S3.T2.17.17.17.17.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.17.17.17.17.2.m1.1.1.3.2.cmml" xref="S3.T2.17.17.17.17.2.m1.1.1.3.2">7.16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.17.17.17.17.2.m1.1c">88.38_{\pm 7.16}</annotation></semantics></math></td>
<td id="S3.T2.18.18.18.18.3" class="ltx_td ltx_align_center ltx_border_r"><math id="S3.T2.18.18.18.18.3.m1.1" class="ltx_Math" alttext="19.50_{\pm 7.71}" display="inline"><semantics id="S3.T2.18.18.18.18.3.m1.1a"><msub id="S3.T2.18.18.18.18.3.m1.1.1" xref="S3.T2.18.18.18.18.3.m1.1.1.cmml"><mn id="S3.T2.18.18.18.18.3.m1.1.1.2" xref="S3.T2.18.18.18.18.3.m1.1.1.2.cmml">19.50</mn><mrow id="S3.T2.18.18.18.18.3.m1.1.1.3" xref="S3.T2.18.18.18.18.3.m1.1.1.3.cmml"><mo id="S3.T2.18.18.18.18.3.m1.1.1.3a" xref="S3.T2.18.18.18.18.3.m1.1.1.3.cmml">±</mo><mn id="S3.T2.18.18.18.18.3.m1.1.1.3.2" xref="S3.T2.18.18.18.18.3.m1.1.1.3.2.cmml">7.71</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.18.18.18.18.3.m1.1b"><apply id="S3.T2.18.18.18.18.3.m1.1.1.cmml" xref="S3.T2.18.18.18.18.3.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.18.18.18.18.3.m1.1.1.1.cmml" xref="S3.T2.18.18.18.18.3.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.18.18.18.18.3.m1.1.1.2.cmml" xref="S3.T2.18.18.18.18.3.m1.1.1.2">19.50</cn><apply id="S3.T2.18.18.18.18.3.m1.1.1.3.cmml" xref="S3.T2.18.18.18.18.3.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.18.18.18.18.3.m1.1.1.3.1.cmml" xref="S3.T2.18.18.18.18.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.18.18.18.18.3.m1.1.1.3.2.cmml" xref="S3.T2.18.18.18.18.3.m1.1.1.3.2">7.71</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.18.18.18.18.3.m1.1c">19.50_{\pm 7.71}</annotation></semantics></math></td>
<td id="S3.T2.18.18.18.18.5" class="ltx_td ltx_align_center">21.03M (100%)</td>
<td id="S3.T2.18.18.18.18.6" class="ltx_td ltx_align_center">65.65M (100%)</td>
<td id="S3.T2.18.18.18.18.7" class="ltx_td ltx_align_center">20.66M (98%)</td>
</tr>
<tr id="S3.T2.21.21.21.21" class="ltx_tr">
<td id="S3.T2.21.21.21.21.4" class="ltx_td ltx_align_center ltx_border_r">FedRep</td>
<td id="S3.T2.19.19.19.19.1" class="ltx_td ltx_align_center"><math id="S3.T2.19.19.19.19.1.m1.1" class="ltx_Math" alttext="44.42_{\pm 7.80}" display="inline"><semantics id="S3.T2.19.19.19.19.1.m1.1a"><msub id="S3.T2.19.19.19.19.1.m1.1.1" xref="S3.T2.19.19.19.19.1.m1.1.1.cmml"><mn id="S3.T2.19.19.19.19.1.m1.1.1.2" xref="S3.T2.19.19.19.19.1.m1.1.1.2.cmml">44.42</mn><mrow id="S3.T2.19.19.19.19.1.m1.1.1.3" xref="S3.T2.19.19.19.19.1.m1.1.1.3.cmml"><mo id="S3.T2.19.19.19.19.1.m1.1.1.3a" xref="S3.T2.19.19.19.19.1.m1.1.1.3.cmml">±</mo><mn id="S3.T2.19.19.19.19.1.m1.1.1.3.2" xref="S3.T2.19.19.19.19.1.m1.1.1.3.2.cmml">7.80</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.19.19.19.19.1.m1.1b"><apply id="S3.T2.19.19.19.19.1.m1.1.1.cmml" xref="S3.T2.19.19.19.19.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.19.19.19.19.1.m1.1.1.1.cmml" xref="S3.T2.19.19.19.19.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.19.19.19.19.1.m1.1.1.2.cmml" xref="S3.T2.19.19.19.19.1.m1.1.1.2">44.42</cn><apply id="S3.T2.19.19.19.19.1.m1.1.1.3.cmml" xref="S3.T2.19.19.19.19.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.19.19.19.19.1.m1.1.1.3.1.cmml" xref="S3.T2.19.19.19.19.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.19.19.19.19.1.m1.1.1.3.2.cmml" xref="S3.T2.19.19.19.19.1.m1.1.1.3.2">7.80</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.19.19.19.19.1.m1.1c">44.42_{\pm 7.80}</annotation></semantics></math></td>
<td id="S3.T2.20.20.20.20.2" class="ltx_td ltx_align_center"><math id="S3.T2.20.20.20.20.2.m1.1" class="ltx_Math" alttext="92.63_{\pm 3.77}" display="inline"><semantics id="S3.T2.20.20.20.20.2.m1.1a"><msub id="S3.T2.20.20.20.20.2.m1.1.1" xref="S3.T2.20.20.20.20.2.m1.1.1.cmml"><mn id="S3.T2.20.20.20.20.2.m1.1.1.2" xref="S3.T2.20.20.20.20.2.m1.1.1.2.cmml">92.63</mn><mrow id="S3.T2.20.20.20.20.2.m1.1.1.3" xref="S3.T2.20.20.20.20.2.m1.1.1.3.cmml"><mo id="S3.T2.20.20.20.20.2.m1.1.1.3a" xref="S3.T2.20.20.20.20.2.m1.1.1.3.cmml">±</mo><mn id="S3.T2.20.20.20.20.2.m1.1.1.3.2" xref="S3.T2.20.20.20.20.2.m1.1.1.3.2.cmml">3.77</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.20.20.20.20.2.m1.1b"><apply id="S3.T2.20.20.20.20.2.m1.1.1.cmml" xref="S3.T2.20.20.20.20.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.20.20.20.20.2.m1.1.1.1.cmml" xref="S3.T2.20.20.20.20.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.20.20.20.20.2.m1.1.1.2.cmml" xref="S3.T2.20.20.20.20.2.m1.1.1.2">92.63</cn><apply id="S3.T2.20.20.20.20.2.m1.1.1.3.cmml" xref="S3.T2.20.20.20.20.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.20.20.20.20.2.m1.1.1.3.1.cmml" xref="S3.T2.20.20.20.20.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.20.20.20.20.2.m1.1.1.3.2.cmml" xref="S3.T2.20.20.20.20.2.m1.1.1.3.2">3.77</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.20.20.20.20.2.m1.1c">92.63_{\pm 3.77}</annotation></semantics></math></td>
<td id="S3.T2.21.21.21.21.3" class="ltx_td ltx_align_center ltx_border_r"><math id="S3.T2.21.21.21.21.3.m1.1" class="ltx_Math" alttext="23.67_{\pm 5.97}" display="inline"><semantics id="S3.T2.21.21.21.21.3.m1.1a"><msub id="S3.T2.21.21.21.21.3.m1.1.1" xref="S3.T2.21.21.21.21.3.m1.1.1.cmml"><mn id="S3.T2.21.21.21.21.3.m1.1.1.2" xref="S3.T2.21.21.21.21.3.m1.1.1.2.cmml">23.67</mn><mrow id="S3.T2.21.21.21.21.3.m1.1.1.3" xref="S3.T2.21.21.21.21.3.m1.1.1.3.cmml"><mo id="S3.T2.21.21.21.21.3.m1.1.1.3a" xref="S3.T2.21.21.21.21.3.m1.1.1.3.cmml">±</mo><mn id="S3.T2.21.21.21.21.3.m1.1.1.3.2" xref="S3.T2.21.21.21.21.3.m1.1.1.3.2.cmml">5.97</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.21.21.21.21.3.m1.1b"><apply id="S3.T2.21.21.21.21.3.m1.1.1.cmml" xref="S3.T2.21.21.21.21.3.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.21.21.21.21.3.m1.1.1.1.cmml" xref="S3.T2.21.21.21.21.3.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.21.21.21.21.3.m1.1.1.2.cmml" xref="S3.T2.21.21.21.21.3.m1.1.1.2">23.67</cn><apply id="S3.T2.21.21.21.21.3.m1.1.1.3.cmml" xref="S3.T2.21.21.21.21.3.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.21.21.21.21.3.m1.1.1.3.1.cmml" xref="S3.T2.21.21.21.21.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.21.21.21.21.3.m1.1.1.3.2.cmml" xref="S3.T2.21.21.21.21.3.m1.1.1.3.2">5.97</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.21.21.21.21.3.m1.1c">23.67_{\pm 5.97}</annotation></semantics></math></td>
<td id="S3.T2.21.21.21.21.5" class="ltx_td ltx_align_center">21.03M (100%)</td>
<td id="S3.T2.21.21.21.21.6" class="ltx_td ltx_align_center">65.65M (100%)</td>
<td id="S3.T2.21.21.21.21.7" class="ltx_td ltx_align_center">20.66M (98%)</td>
</tr>
<tr id="S3.T2.24.24.24.24" class="ltx_tr">
<td id="S3.T2.24.24.24.24.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Vanilla Attention</td>
<td id="S3.T2.22.22.22.22.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T2.22.22.22.22.1.m1.1" class="ltx_Math" alttext="44.63_{\pm 8.67}" display="inline"><semantics id="S3.T2.22.22.22.22.1.m1.1a"><msub id="S3.T2.22.22.22.22.1.m1.1.1" xref="S3.T2.22.22.22.22.1.m1.1.1.cmml"><mn id="S3.T2.22.22.22.22.1.m1.1.1.2" xref="S3.T2.22.22.22.22.1.m1.1.1.2.cmml">44.63</mn><mrow id="S3.T2.22.22.22.22.1.m1.1.1.3" xref="S3.T2.22.22.22.22.1.m1.1.1.3.cmml"><mo id="S3.T2.22.22.22.22.1.m1.1.1.3a" xref="S3.T2.22.22.22.22.1.m1.1.1.3.cmml">±</mo><mn id="S3.T2.22.22.22.22.1.m1.1.1.3.2" xref="S3.T2.22.22.22.22.1.m1.1.1.3.2.cmml">8.67</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.22.22.22.22.1.m1.1b"><apply id="S3.T2.22.22.22.22.1.m1.1.1.cmml" xref="S3.T2.22.22.22.22.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.22.22.22.22.1.m1.1.1.1.cmml" xref="S3.T2.22.22.22.22.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.22.22.22.22.1.m1.1.1.2.cmml" xref="S3.T2.22.22.22.22.1.m1.1.1.2">44.63</cn><apply id="S3.T2.22.22.22.22.1.m1.1.1.3.cmml" xref="S3.T2.22.22.22.22.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.22.22.22.22.1.m1.1.1.3.1.cmml" xref="S3.T2.22.22.22.22.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.22.22.22.22.1.m1.1.1.3.2.cmml" xref="S3.T2.22.22.22.22.1.m1.1.1.3.2">8.67</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.22.22.22.22.1.m1.1c">44.63_{\pm 8.67}</annotation></semantics></math></td>
<td id="S3.T2.23.23.23.23.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T2.23.23.23.23.2.m1.1" class="ltx_Math" alttext="88.90_{\pm 5.87}" display="inline"><semantics id="S3.T2.23.23.23.23.2.m1.1a"><msub id="S3.T2.23.23.23.23.2.m1.1.1" xref="S3.T2.23.23.23.23.2.m1.1.1.cmml"><mn id="S3.T2.23.23.23.23.2.m1.1.1.2" xref="S3.T2.23.23.23.23.2.m1.1.1.2.cmml">88.90</mn><mrow id="S3.T2.23.23.23.23.2.m1.1.1.3" xref="S3.T2.23.23.23.23.2.m1.1.1.3.cmml"><mo id="S3.T2.23.23.23.23.2.m1.1.1.3a" xref="S3.T2.23.23.23.23.2.m1.1.1.3.cmml">±</mo><mn id="S3.T2.23.23.23.23.2.m1.1.1.3.2" xref="S3.T2.23.23.23.23.2.m1.1.1.3.2.cmml">5.87</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.23.23.23.23.2.m1.1b"><apply id="S3.T2.23.23.23.23.2.m1.1.1.cmml" xref="S3.T2.23.23.23.23.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.23.23.23.23.2.m1.1.1.1.cmml" xref="S3.T2.23.23.23.23.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.23.23.23.23.2.m1.1.1.2.cmml" xref="S3.T2.23.23.23.23.2.m1.1.1.2">88.90</cn><apply id="S3.T2.23.23.23.23.2.m1.1.1.3.cmml" xref="S3.T2.23.23.23.23.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.23.23.23.23.2.m1.1.1.3.1.cmml" xref="S3.T2.23.23.23.23.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.23.23.23.23.2.m1.1.1.3.2.cmml" xref="S3.T2.23.23.23.23.2.m1.1.1.3.2">5.87</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.23.23.23.23.2.m1.1c">88.90_{\pm 5.87}</annotation></semantics></math></td>
<td id="S3.T2.24.24.24.24.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S3.T2.24.24.24.24.3.m1.1" class="ltx_Math" alttext="22.55_{\pm 6.37}" display="inline"><semantics id="S3.T2.24.24.24.24.3.m1.1a"><msub id="S3.T2.24.24.24.24.3.m1.1.1" xref="S3.T2.24.24.24.24.3.m1.1.1.cmml"><mn id="S3.T2.24.24.24.24.3.m1.1.1.2" xref="S3.T2.24.24.24.24.3.m1.1.1.2.cmml">22.55</mn><mrow id="S3.T2.24.24.24.24.3.m1.1.1.3" xref="S3.T2.24.24.24.24.3.m1.1.1.3.cmml"><mo id="S3.T2.24.24.24.24.3.m1.1.1.3a" xref="S3.T2.24.24.24.24.3.m1.1.1.3.cmml">±</mo><mn id="S3.T2.24.24.24.24.3.m1.1.1.3.2" xref="S3.T2.24.24.24.24.3.m1.1.1.3.2.cmml">6.37</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.24.24.24.24.3.m1.1b"><apply id="S3.T2.24.24.24.24.3.m1.1.1.cmml" xref="S3.T2.24.24.24.24.3.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.24.24.24.24.3.m1.1.1.1.cmml" xref="S3.T2.24.24.24.24.3.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.24.24.24.24.3.m1.1.1.2.cmml" xref="S3.T2.24.24.24.24.3.m1.1.1.2">22.55</cn><apply id="S3.T2.24.24.24.24.3.m1.1.1.3.cmml" xref="S3.T2.24.24.24.24.3.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.24.24.24.24.3.m1.1.1.3.1.cmml" xref="S3.T2.24.24.24.24.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.24.24.24.24.3.m1.1.1.3.2.cmml" xref="S3.T2.24.24.24.24.3.m1.1.1.3.2">6.37</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.24.24.24.24.3.m1.1c">22.55_{\pm 6.37}</annotation></semantics></math></td>
<td id="S3.T2.24.24.24.24.5" class="ltx_td ltx_align_center ltx_border_t">21.03M (100%)</td>
<td id="S3.T2.24.24.24.24.6" class="ltx_td ltx_align_center ltx_border_t">65.65M (100%)</td>
<td id="S3.T2.24.24.24.24.7" class="ltx_td ltx_align_center ltx_border_t">13.89M (66%)</td>
</tr>
<tr id="S3.T2.27.27.27.27" class="ltx_tr">
<td id="S3.T2.27.27.27.27.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">FedPerfix (ours)</td>
<td id="S3.T2.25.25.25.25.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S3.T2.25.25.25.25.1.m1.1" class="ltx_Math" alttext="\mathbf{48.10}_{\pm 7.76}" display="inline"><semantics id="S3.T2.25.25.25.25.1.m1.1a"><msub id="S3.T2.25.25.25.25.1.m1.1.1" xref="S3.T2.25.25.25.25.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T2.25.25.25.25.1.m1.1.1.2" xref="S3.T2.25.25.25.25.1.m1.1.1.2.cmml">48.10</mn><mrow id="S3.T2.25.25.25.25.1.m1.1.1.3" xref="S3.T2.25.25.25.25.1.m1.1.1.3.cmml"><mo id="S3.T2.25.25.25.25.1.m1.1.1.3a" xref="S3.T2.25.25.25.25.1.m1.1.1.3.cmml">±</mo><mn id="S3.T2.25.25.25.25.1.m1.1.1.3.2" xref="S3.T2.25.25.25.25.1.m1.1.1.3.2.cmml">7.76</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.25.25.25.25.1.m1.1b"><apply id="S3.T2.25.25.25.25.1.m1.1.1.cmml" xref="S3.T2.25.25.25.25.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.25.25.25.25.1.m1.1.1.1.cmml" xref="S3.T2.25.25.25.25.1.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.25.25.25.25.1.m1.1.1.2.cmml" xref="S3.T2.25.25.25.25.1.m1.1.1.2">48.10</cn><apply id="S3.T2.25.25.25.25.1.m1.1.1.3.cmml" xref="S3.T2.25.25.25.25.1.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.25.25.25.25.1.m1.1.1.3.1.cmml" xref="S3.T2.25.25.25.25.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.25.25.25.25.1.m1.1.1.3.2.cmml" xref="S3.T2.25.25.25.25.1.m1.1.1.3.2">7.76</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.25.25.25.25.1.m1.1c">\mathbf{48.10}_{\pm 7.76}</annotation></semantics></math></td>
<td id="S3.T2.26.26.26.26.2" class="ltx_td ltx_align_center ltx_border_bb"><math id="S3.T2.26.26.26.26.2.m1.1" class="ltx_Math" alttext="\mathbf{93.17}_{\pm 3.51}" display="inline"><semantics id="S3.T2.26.26.26.26.2.m1.1a"><msub id="S3.T2.26.26.26.26.2.m1.1.1" xref="S3.T2.26.26.26.26.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T2.26.26.26.26.2.m1.1.1.2" xref="S3.T2.26.26.26.26.2.m1.1.1.2.cmml">93.17</mn><mrow id="S3.T2.26.26.26.26.2.m1.1.1.3" xref="S3.T2.26.26.26.26.2.m1.1.1.3.cmml"><mo id="S3.T2.26.26.26.26.2.m1.1.1.3a" xref="S3.T2.26.26.26.26.2.m1.1.1.3.cmml">±</mo><mn id="S3.T2.26.26.26.26.2.m1.1.1.3.2" xref="S3.T2.26.26.26.26.2.m1.1.1.3.2.cmml">3.51</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.26.26.26.26.2.m1.1b"><apply id="S3.T2.26.26.26.26.2.m1.1.1.cmml" xref="S3.T2.26.26.26.26.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.26.26.26.26.2.m1.1.1.1.cmml" xref="S3.T2.26.26.26.26.2.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.26.26.26.26.2.m1.1.1.2.cmml" xref="S3.T2.26.26.26.26.2.m1.1.1.2">93.17</cn><apply id="S3.T2.26.26.26.26.2.m1.1.1.3.cmml" xref="S3.T2.26.26.26.26.2.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.26.26.26.26.2.m1.1.1.3.1.cmml" xref="S3.T2.26.26.26.26.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.26.26.26.26.2.m1.1.1.3.2.cmml" xref="S3.T2.26.26.26.26.2.m1.1.1.3.2">3.51</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.26.26.26.26.2.m1.1c">\mathbf{93.17}_{\pm 3.51}</annotation></semantics></math></td>
<td id="S3.T2.27.27.27.27.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><math id="S3.T2.27.27.27.27.3.m1.1" class="ltx_Math" alttext="\mathbf{24.38}_{\pm 8.47}" display="inline"><semantics id="S3.T2.27.27.27.27.3.m1.1a"><msub id="S3.T2.27.27.27.27.3.m1.1.1" xref="S3.T2.27.27.27.27.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S3.T2.27.27.27.27.3.m1.1.1.2" xref="S3.T2.27.27.27.27.3.m1.1.1.2.cmml">24.38</mn><mrow id="S3.T2.27.27.27.27.3.m1.1.1.3" xref="S3.T2.27.27.27.27.3.m1.1.1.3.cmml"><mo id="S3.T2.27.27.27.27.3.m1.1.1.3a" xref="S3.T2.27.27.27.27.3.m1.1.1.3.cmml">±</mo><mn id="S3.T2.27.27.27.27.3.m1.1.1.3.2" xref="S3.T2.27.27.27.27.3.m1.1.1.3.2.cmml">8.47</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T2.27.27.27.27.3.m1.1b"><apply id="S3.T2.27.27.27.27.3.m1.1.1.cmml" xref="S3.T2.27.27.27.27.3.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.27.27.27.27.3.m1.1.1.1.cmml" xref="S3.T2.27.27.27.27.3.m1.1.1">subscript</csymbol><cn type="float" id="S3.T2.27.27.27.27.3.m1.1.1.2.cmml" xref="S3.T2.27.27.27.27.3.m1.1.1.2">24.38</cn><apply id="S3.T2.27.27.27.27.3.m1.1.1.3.cmml" xref="S3.T2.27.27.27.27.3.m1.1.1.3"><csymbol cd="latexml" id="S3.T2.27.27.27.27.3.m1.1.1.3.1.cmml" xref="S3.T2.27.27.27.27.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S3.T2.27.27.27.27.3.m1.1.1.3.2.cmml" xref="S3.T2.27.27.27.27.3.m1.1.1.3.2">8.47</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.27.27.27.27.3.m1.1c">\mathbf{24.38}_{\pm 8.47}</annotation></semantics></math></td>
<td id="S3.T2.27.27.27.27.5" class="ltx_td ltx_align_center ltx_border_bb">24.42M (116%)</td>
<td id="S3.T2.27.27.27.27.6" class="ltx_td ltx_align_center ltx_border_bb">66.58M (101%)</td>
<td id="S3.T2.27.27.27.27.7" class="ltx_td ltx_align_center ltx_border_bb">20.66M (98%)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S3.SS5.p2" class="ltx_para">
<p id="S3.SS5.p2.1" class="ltx_p">In conclusion, FedPerfix is proposed as a novel approach to transfer the information from the aggregated self-attention layer to fit the local data better, leveraging the plugins in transfer learning.
The local prefixes are trained for personalization, while the global self-attention layer captures global dependencies. Therefore,
FedPerfix provides a promising solution to address the question of how to perform personalization for ViTs.
</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experiment Details</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Dataset.</span> We use three popular datasets to evaluate the performance: <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_bold">CIFAR-100</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, <span id="S4.SS1.p1.1.3" class="ltx_text ltx_font_bold">OrganAMNIST</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, and <span id="S4.SS1.p1.1.4" class="ltx_text ltx_font_bold">Office-Home</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. CIFAR-100 is a widely-used image classification dataset consisting of 50,000 RGB images across 100 classes. Office-Home is a domain adaptation dataset for object recognition tasks, which contains 15,500 images across 65 categories, captured from four different domains: Artistic images, Clipart, Product images, and Real-World images. OrganAMNIST is a medical image classification dataset that includes 58,850 gray-scale images of organs and tissues from human anatomy. The images are classified into 11 different classes. These datasets are chosen to evaluate the performance in various scenarios, including different data scales, domains, and the number of classes.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.10" class="ltx_p"><span id="S4.SS1.p2.10.1" class="ltx_text ltx_font_bold">Federated learning settings.</span>
We conduct <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="T=50" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">T</mi><mo id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><eq id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></eq><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">T=50</annotation></semantics></math> communication rounds with each local training consisting of 10 epochs. To account for the various factors that can affect federated learning performance, we adjust the default settings for each dataset to focus on different scenarios with varying degrees of data heterogeneity of <span id="S4.SS1.p2.10.2" class="ltx_text ltx_font_bold">label skew</span> and <span id="S4.SS1.p2.10.3" class="ltx_text ltx_font_bold">concept skew</span>. For CIFAR-100, which has a relatively high number of samples and classes, we simulate a federated learning environment with <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="N=64" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">N</mi><mo id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><eq id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"></eq><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝑁</ci><cn type="integer" id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">N=64</annotation></semantics></math> clients using a Dirichlet distribution with <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">α</mi><mo id="S4.SS1.p2.3.m3.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><eq id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1"></eq><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝛼</ci><cn type="float" id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\alpha=0.1</annotation></semantics></math> and sampling <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mrow id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">K</mi><mo id="S4.SS1.p2.4.m4.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><eq id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1"></eq><ci id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">𝐾</ci><cn type="integer" id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">K=8</annotation></semantics></math> clients with a ratio <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="r=0.125" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><mrow id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">r</mi><mo id="S4.SS1.p2.5.m5.1.1.1" xref="S4.SS1.p2.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml">0.125</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><eq id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1.1"></eq><ci id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2">𝑟</ci><cn type="float" id="S4.SS1.p2.5.m5.1.1.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3">0.125</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">r=0.125</annotation></semantics></math> for each round.
For OrganAMNIST, which has a similar number of samples but fewer classes than CIFAR-100, we partition the data using a Dirichlet distribution with a larger <math id="S4.SS1.p2.6.m6.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S4.SS1.p2.6.m6.1a"><mrow id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml"><mi id="S4.SS1.p2.6.m6.1.1.2" xref="S4.SS1.p2.6.m6.1.1.2.cmml">α</mi><mo id="S4.SS1.p2.6.m6.1.1.1" xref="S4.SS1.p2.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.6.m6.1.1.3" xref="S4.SS1.p2.6.m6.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><apply id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1"><eq id="S4.SS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1.1"></eq><ci id="S4.SS1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.p2.6.m6.1.1.2">𝛼</ci><cn type="float" id="S4.SS1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">\alpha=0.5</annotation></semantics></math> and apply the same client settings as CIFAR-100.
As for Office-Home, which has fewer samples captured from 4 different domains, we focus on concept skew by partitioning the data from each domain into four different clients using a Dirichlet distribution with <math id="S4.SS1.p2.7.m7.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S4.SS1.p2.7.m7.1a"><mrow id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml"><mi id="S4.SS1.p2.7.m7.1.1.2" xref="S4.SS1.p2.7.m7.1.1.2.cmml">α</mi><mo id="S4.SS1.p2.7.m7.1.1.1" xref="S4.SS1.p2.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.7.m7.1.1.3" xref="S4.SS1.p2.7.m7.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.1b"><apply id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1"><eq id="S4.SS1.p2.7.m7.1.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1.1"></eq><ci id="S4.SS1.p2.7.m7.1.1.2.cmml" xref="S4.SS1.p2.7.m7.1.1.2">𝛼</ci><cn type="float" id="S4.SS1.p2.7.m7.1.1.3.cmml" xref="S4.SS1.p2.7.m7.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.1c">\alpha=1.0</annotation></semantics></math>, resulting in a total of <math id="S4.SS1.p2.8.m8.1" class="ltx_Math" alttext="N=16" display="inline"><semantics id="S4.SS1.p2.8.m8.1a"><mrow id="S4.SS1.p2.8.m8.1.1" xref="S4.SS1.p2.8.m8.1.1.cmml"><mi id="S4.SS1.p2.8.m8.1.1.2" xref="S4.SS1.p2.8.m8.1.1.2.cmml">N</mi><mo id="S4.SS1.p2.8.m8.1.1.1" xref="S4.SS1.p2.8.m8.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.8.m8.1.1.3" xref="S4.SS1.p2.8.m8.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m8.1b"><apply id="S4.SS1.p2.8.m8.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1"><eq id="S4.SS1.p2.8.m8.1.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1.1"></eq><ci id="S4.SS1.p2.8.m8.1.1.2.cmml" xref="S4.SS1.p2.8.m8.1.1.2">𝑁</ci><cn type="integer" id="S4.SS1.p2.8.m8.1.1.3.cmml" xref="S4.SS1.p2.8.m8.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m8.1c">N=16</annotation></semantics></math> clients. In each communication round, we randomly sample <math id="S4.SS1.p2.9.m9.1" class="ltx_Math" alttext="K=4" display="inline"><semantics id="S4.SS1.p2.9.m9.1a"><mrow id="S4.SS1.p2.9.m9.1.1" xref="S4.SS1.p2.9.m9.1.1.cmml"><mi id="S4.SS1.p2.9.m9.1.1.2" xref="S4.SS1.p2.9.m9.1.1.2.cmml">K</mi><mo id="S4.SS1.p2.9.m9.1.1.1" xref="S4.SS1.p2.9.m9.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.9.m9.1.1.3" xref="S4.SS1.p2.9.m9.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m9.1b"><apply id="S4.SS1.p2.9.m9.1.1.cmml" xref="S4.SS1.p2.9.m9.1.1"><eq id="S4.SS1.p2.9.m9.1.1.1.cmml" xref="S4.SS1.p2.9.m9.1.1.1"></eq><ci id="S4.SS1.p2.9.m9.1.1.2.cmml" xref="S4.SS1.p2.9.m9.1.1.2">𝐾</ci><cn type="integer" id="S4.SS1.p2.9.m9.1.1.3.cmml" xref="S4.SS1.p2.9.m9.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m9.1c">K=4</annotation></semantics></math> clients from any domain with a ratio <math id="S4.SS1.p2.10.m10.1" class="ltx_Math" alttext="r=0.25" display="inline"><semantics id="S4.SS1.p2.10.m10.1a"><mrow id="S4.SS1.p2.10.m10.1.1" xref="S4.SS1.p2.10.m10.1.1.cmml"><mi id="S4.SS1.p2.10.m10.1.1.2" xref="S4.SS1.p2.10.m10.1.1.2.cmml">r</mi><mo id="S4.SS1.p2.10.m10.1.1.1" xref="S4.SS1.p2.10.m10.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.10.m10.1.1.3" xref="S4.SS1.p2.10.m10.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m10.1b"><apply id="S4.SS1.p2.10.m10.1.1.cmml" xref="S4.SS1.p2.10.m10.1.1"><eq id="S4.SS1.p2.10.m10.1.1.1.cmml" xref="S4.SS1.p2.10.m10.1.1.1"></eq><ci id="S4.SS1.p2.10.m10.1.1.2.cmml" xref="S4.SS1.p2.10.m10.1.1.2">𝑟</ci><cn type="float" id="S4.SS1.p2.10.m10.1.1.3.cmml" xref="S4.SS1.p2.10.m10.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m10.1c">r=0.25</annotation></semantics></math>. A visualization of the data partitioning is provided in <span id="S4.SS1.p2.10.4" class="ltx_text" style="color:#0000FF;">Supplementary A.1</span>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.2" class="ltx_p"><span id="S4.SS1.p3.2.1" class="ltx_text ltx_font_bold">Model Architecture and Baselines.</span> We choose ViT-Small (ViT-S) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> with a patch size of <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mn id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><cn type="integer" id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">16</annotation></semantics></math> and an image size of <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="224" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mn id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">224</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><cn type="integer" id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">224</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">224</annotation></semantics></math> as our model for evaluation. We compare our proposed FedPerfix method against a range of baseline methods, including widely used approaches like FedAVG and local training without aggregation (Local). We also compare our method against advanced full model personalization methods, namely APFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and Per-FedAVG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, and three partial model personalization methods, namely FedBN, FedRep, and FedBABU. Besides, we also include the performance of Vanilla Attention, which keeps the self-attention layer and the classification head updated locally, as a reference. APFL adapts the global and local model through an adaptive mixture coefficient, while Per-FedAVG employs meta-learning to improve the global model. These methods are model-agnostic and can be applied to ViTs. FedBN keeps the batch normalization layer updated locally and aggregates the remaining layers in the server with FedAVG. To adapt it to ViTs, we replace the batch normalization layer with the layer normalization layer. FedRep keeps the classification head updated locally while aggregating the other layers in the server. FedBABU freezes the classification head and aggregates the remaining layers in the server, then fine-tunes the classification head on the local data for one step before the evaluation.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.1" class="ltx_p"><span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_bold">Evaluation Metrics.</span> We report the final mean and standard deviation of Top-1 accuracy among all clients after all communication rounds finish as the evaluation metrics. Besides, to evaluate the feasibility of the methods, an analysis of storage, computation, and communication costs is reported in Section <a href="#S4.SS4" title="4.4 Resource Requirements Analysis ‣ 4 Experiment ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para ltx_noindent">
<p id="S4.SS1.p5.3" class="ltx_p"><span id="S4.SS1.p5.3.1" class="ltx_text ltx_font_bold">Implement Details.</span> All hyperparameters in each method are tuned as optimal in a range. Each model is optimized with the SGD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> optimizer with the optimal learning rate, which is <math id="S4.SS1.p5.1.m1.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S4.SS1.p5.1.m1.1a"><mn id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><cn type="float" id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">0.01</annotation></semantics></math> for most methods. The server and all the clients are simulated in one machine, and we resize the images in all datasets as <math id="S4.SS1.p5.2.m2.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="S4.SS1.p5.2.m2.1a"><mrow id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml"><mn id="S4.SS1.p5.2.m2.1.1.2" xref="S4.SS1.p5.2.m2.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p5.2.m2.1.1.1" xref="S4.SS1.p5.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS1.p5.2.m2.1.1.3" xref="S4.SS1.p5.2.m2.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><apply id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1"><times id="S4.SS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1.1"></times><cn type="integer" id="S4.SS1.p5.2.m2.1.1.2.cmml" xref="S4.SS1.p5.2.m2.1.1.2">224</cn><cn type="integer" id="S4.SS1.p5.2.m2.1.1.3.cmml" xref="S4.SS1.p5.2.m2.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">224\times 224</annotation></semantics></math> RGB images to fit the model and set the batch size of the client data as <math id="S4.SS1.p5.3.m3.1" class="ltx_Math" alttext="64" display="inline"><semantics id="S4.SS1.p5.3.m3.1a"><mn id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b"><cn type="integer" id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">64</annotation></semantics></math>. The model is implemented from the TIMM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> library.
All the experiments are implemented in Pytorch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> and performed on 4 Nvidia A5000 GPUs. More details are provided in <span id="S4.SS1.p5.3.2" class="ltx_text" style="color:#0000FF;">Supplementary A.2</span>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Performance Evaluation</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Based on the evaluation results presented in Table <a href="#S3.T2" title="Table 2 ‣ 3.5 FedPerfix: Stabilize the Prefix ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, several insights can be drawn regarding the performance of the compared methods. It can be observed that FedAVG performs worse than Local when facing a large label skew, <em id="S4.SS2.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS2.p1.1.2" class="ltx_text"></span>, on CIFAR-100. This indicates the importance of addressing data heterogeneity in federated learning scenarios. However, when the label skew is not that extreme, the information gathered from the global aggregation can alleviate the overfitting due to few training samples on the client, leading to higher performance.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">In addition, it is worth noting that the methods that focus on the global objective instead of information transferring from the global to the client model, such as Per-FedAVG, achieve better performance than FedAVG but still show inferior performance compared to Local when facing extreme label skew or concept skew, <em id="S4.SS2.p2.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS2.p2.1.2" class="ltx_text"></span>, CIFAR-100 and Office-Home. This suggests that direct modification of the global objective may not always be the most effective way when using ViTs. Performing meta-learning on relatively small-size client data for a relatively large ViT is a challenging task, which limits the effectiveness of Per-FedAVG.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">On the other hand, how to leverage the information provided in the global model is crucial for partial model personalization.
The layer normalization version of FedBN shows little impact on the performance, leading to a negligible improvement based on FedAVG. However, APFL, FedRep, Vanilla Attention, FedBABU, and FedPerfix find a more suitable way to transfer the information from the global model, leading to superior performance than other methods. Consistent with the conclusion we draw from the empirical study, FedRep, FedBABU, and Vanilla Attention personalized the sensitive parts in ViT, thus outperforming FedAVG and Local by a significant margin.
As an extension, APFL and our method, FedPerfix, balance the information between the local and global models in a proper manner, leading to the highest two performances considering the performance across all three datasets.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.2" class="ltx_p">Surprisingly, we find that there is a connection between FedPerfix and APFL. Equation <a href="#S3.E3" title="In 3.4 Proposed Baseline: Vanilla Prefix-tuning ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, which shows the output of a self-attention with Prefixes, can be rewritten as</p>
<table id="S4.E6" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E6X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle head(x)=" display="inline"><semantics id="S4.E6X.2.1.1.m1.1a"><mrow id="S4.E6X.2.1.1.m1.1.2" xref="S4.E6X.2.1.1.m1.1.2.cmml"><mrow id="S4.E6X.2.1.1.m1.1.2.2" xref="S4.E6X.2.1.1.m1.1.2.2.cmml"><mi id="S4.E6X.2.1.1.m1.1.2.2.2" xref="S4.E6X.2.1.1.m1.1.2.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.E6X.2.1.1.m1.1.2.2.1" xref="S4.E6X.2.1.1.m1.1.2.2.1.cmml">​</mo><mi id="S4.E6X.2.1.1.m1.1.2.2.3" xref="S4.E6X.2.1.1.m1.1.2.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E6X.2.1.1.m1.1.2.2.1a" xref="S4.E6X.2.1.1.m1.1.2.2.1.cmml">​</mo><mi id="S4.E6X.2.1.1.m1.1.2.2.4" xref="S4.E6X.2.1.1.m1.1.2.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E6X.2.1.1.m1.1.2.2.1b" xref="S4.E6X.2.1.1.m1.1.2.2.1.cmml">​</mo><mi id="S4.E6X.2.1.1.m1.1.2.2.5" xref="S4.E6X.2.1.1.m1.1.2.2.5.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E6X.2.1.1.m1.1.2.2.1c" xref="S4.E6X.2.1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S4.E6X.2.1.1.m1.1.2.2.6.2" xref="S4.E6X.2.1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S4.E6X.2.1.1.m1.1.2.2.6.2.1" xref="S4.E6X.2.1.1.m1.1.2.2.cmml">(</mo><mi id="S4.E6X.2.1.1.m1.1.1" xref="S4.E6X.2.1.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E6X.2.1.1.m1.1.2.2.6.2.2" xref="S4.E6X.2.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E6X.2.1.1.m1.1.2.1" xref="S4.E6X.2.1.1.m1.1.2.1.cmml">=</mo><mi id="S4.E6X.2.1.1.m1.1.2.3" xref="S4.E6X.2.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E6X.2.1.1.m1.1b"><apply id="S4.E6X.2.1.1.m1.1.2.cmml" xref="S4.E6X.2.1.1.m1.1.2"><eq id="S4.E6X.2.1.1.m1.1.2.1.cmml" xref="S4.E6X.2.1.1.m1.1.2.1"></eq><apply id="S4.E6X.2.1.1.m1.1.2.2.cmml" xref="S4.E6X.2.1.1.m1.1.2.2"><times id="S4.E6X.2.1.1.m1.1.2.2.1.cmml" xref="S4.E6X.2.1.1.m1.1.2.2.1"></times><ci id="S4.E6X.2.1.1.m1.1.2.2.2.cmml" xref="S4.E6X.2.1.1.m1.1.2.2.2">ℎ</ci><ci id="S4.E6X.2.1.1.m1.1.2.2.3.cmml" xref="S4.E6X.2.1.1.m1.1.2.2.3">𝑒</ci><ci id="S4.E6X.2.1.1.m1.1.2.2.4.cmml" xref="S4.E6X.2.1.1.m1.1.2.2.4">𝑎</ci><ci id="S4.E6X.2.1.1.m1.1.2.2.5.cmml" xref="S4.E6X.2.1.1.m1.1.2.2.5">𝑑</ci><ci id="S4.E6X.2.1.1.m1.1.1.cmml" xref="S4.E6X.2.1.1.m1.1.1">𝑥</ci></apply><csymbol cd="latexml" id="S4.E6X.2.1.1.m1.1.2.3.cmml" xref="S4.E6X.2.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6X.2.1.1.m1.1c">\displaystyle head(x)=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E6X.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle(1-\lambda(x))\underbrace{Attn(x{\bm{W}}_{q},x{\bm{W}}_{k},x{\bm{W}}_{v})}_{\text{aggregated attention}}" display="inline"><semantics id="S4.E6X.3.2.2.m1.5a"><mrow id="S4.E6X.3.2.2.m1.5.5" xref="S4.E6X.3.2.2.m1.5.5.cmml"><mrow id="S4.E6X.3.2.2.m1.5.5.1.1" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.cmml"><mo stretchy="false" id="S4.E6X.3.2.2.m1.5.5.1.1.2" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.cmml">(</mo><mrow id="S4.E6X.3.2.2.m1.5.5.1.1.1" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.cmml"><mn id="S4.E6X.3.2.2.m1.5.5.1.1.1.2" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.2.cmml">1</mn><mo id="S4.E6X.3.2.2.m1.5.5.1.1.1.1" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.1.cmml">−</mo><mrow id="S4.E6X.3.2.2.m1.5.5.1.1.1.3" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.3.cmml"><mi id="S4.E6X.3.2.2.m1.5.5.1.1.1.3.2" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.5.5.1.1.1.3.1" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.3.1.cmml">​</mo><mrow id="S4.E6X.3.2.2.m1.5.5.1.1.1.3.3.2" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.3.cmml"><mo stretchy="false" id="S4.E6X.3.2.2.m1.5.5.1.1.1.3.3.2.1" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.3.cmml">(</mo><mi id="S4.E6X.3.2.2.m1.4.4" xref="S4.E6X.3.2.2.m1.4.4.cmml">x</mi><mo stretchy="false" id="S4.E6X.3.2.2.m1.5.5.1.1.1.3.3.2.2" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E6X.3.2.2.m1.5.5.1.1.3" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.5.5.2" xref="S4.E6X.3.2.2.m1.5.5.2.cmml">​</mo><munder id="S4.E6X.3.2.2.m1.5.5.3" xref="S4.E6X.3.2.2.m1.5.5.3.cmml"><munder accentunder="true" id="S4.E6X.3.2.2.m1.3.3" xref="S4.E6X.3.2.2.m1.3.3.cmml"><mrow id="S4.E6X.3.2.2.m1.3.3.3" xref="S4.E6X.3.2.2.m1.3.3.3.cmml"><mi id="S4.E6X.3.2.2.m1.3.3.3.5" xref="S4.E6X.3.2.2.m1.3.3.3.5.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.3.3.3.4" xref="S4.E6X.3.2.2.m1.3.3.3.4.cmml">​</mo><mi id="S4.E6X.3.2.2.m1.3.3.3.6" xref="S4.E6X.3.2.2.m1.3.3.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.3.3.3.4a" xref="S4.E6X.3.2.2.m1.3.3.3.4.cmml">​</mo><mi id="S4.E6X.3.2.2.m1.3.3.3.7" xref="S4.E6X.3.2.2.m1.3.3.3.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.3.3.3.4b" xref="S4.E6X.3.2.2.m1.3.3.3.4.cmml">​</mo><mi id="S4.E6X.3.2.2.m1.3.3.3.8" xref="S4.E6X.3.2.2.m1.3.3.3.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.3.3.3.4c" xref="S4.E6X.3.2.2.m1.3.3.3.4.cmml">​</mo><mrow id="S4.E6X.3.2.2.m1.3.3.3.3.3" xref="S4.E6X.3.2.2.m1.3.3.3.3.4.cmml"><mo stretchy="false" id="S4.E6X.3.2.2.m1.3.3.3.3.3.4" xref="S4.E6X.3.2.2.m1.3.3.3.3.4.cmml">(</mo><mrow id="S4.E6X.3.2.2.m1.1.1.1.1.1.1" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.2" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="S4.E6X.3.2.2.m1.3.3.3.3.3.5" xref="S4.E6X.3.2.2.m1.3.3.3.3.4.cmml">,</mo><mrow id="S4.E6X.3.2.2.m1.2.2.2.2.2.2" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.cmml"><mi id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.2" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.1" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.1.cmml">​</mo><msub id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3.cmml"><mi id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3.2" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3.2.cmml">𝑾</mi><mi id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3.3" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3.3.cmml">k</mi></msub></mrow><mo id="S4.E6X.3.2.2.m1.3.3.3.3.3.6" xref="S4.E6X.3.2.2.m1.3.3.3.3.4.cmml">,</mo><mrow id="S4.E6X.3.2.2.m1.3.3.3.3.3.3" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3.cmml"><mi id="S4.E6X.3.2.2.m1.3.3.3.3.3.3.2" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.3.3.3.3.3.3.1" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3.1.cmml">​</mo><msub id="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3.cmml"><mi id="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3.2" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3.2.cmml">𝑾</mi><mi id="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3.3" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3.3.cmml">v</mi></msub></mrow><mo stretchy="false" id="S4.E6X.3.2.2.m1.3.3.3.3.3.7" xref="S4.E6X.3.2.2.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow><mo id="S4.E6X.3.2.2.m1.3.3.4" xref="S4.E6X.3.2.2.m1.3.3.4.cmml">⏟</mo></munder><mtext id="S4.E6X.3.2.2.m1.5.5.3.2" xref="S4.E6X.3.2.2.m1.5.5.3.2a.cmml">aggregated attention</mtext></munder></mrow><annotation-xml encoding="MathML-Content" id="S4.E6X.3.2.2.m1.5b"><apply id="S4.E6X.3.2.2.m1.5.5.cmml" xref="S4.E6X.3.2.2.m1.5.5"><times id="S4.E6X.3.2.2.m1.5.5.2.cmml" xref="S4.E6X.3.2.2.m1.5.5.2"></times><apply id="S4.E6X.3.2.2.m1.5.5.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.5.5.1.1"><minus id="S4.E6X.3.2.2.m1.5.5.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.1"></minus><cn type="integer" id="S4.E6X.3.2.2.m1.5.5.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.2">1</cn><apply id="S4.E6X.3.2.2.m1.5.5.1.1.1.3.cmml" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.3"><times id="S4.E6X.3.2.2.m1.5.5.1.1.1.3.1.cmml" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.3.1"></times><ci id="S4.E6X.3.2.2.m1.5.5.1.1.1.3.2.cmml" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.3.2">𝜆</ci><ci id="S4.E6X.3.2.2.m1.4.4.cmml" xref="S4.E6X.3.2.2.m1.4.4">𝑥</ci></apply></apply><apply id="S4.E6X.3.2.2.m1.5.5.3.cmml" xref="S4.E6X.3.2.2.m1.5.5.3"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.5.5.3.1.cmml" xref="S4.E6X.3.2.2.m1.5.5.3">subscript</csymbol><apply id="S4.E6X.3.2.2.m1.3.3.cmml" xref="S4.E6X.3.2.2.m1.3.3"><ci id="S4.E6X.3.2.2.m1.3.3.4.cmml" xref="S4.E6X.3.2.2.m1.3.3.4">⏟</ci><apply id="S4.E6X.3.2.2.m1.3.3.3.cmml" xref="S4.E6X.3.2.2.m1.3.3.3"><times id="S4.E6X.3.2.2.m1.3.3.3.4.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.4"></times><ci id="S4.E6X.3.2.2.m1.3.3.3.5.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.5">𝐴</ci><ci id="S4.E6X.3.2.2.m1.3.3.3.6.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.6">𝑡</ci><ci id="S4.E6X.3.2.2.m1.3.3.3.7.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.7">𝑡</ci><ci id="S4.E6X.3.2.2.m1.3.3.3.8.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.8">𝑛</ci><vector id="S4.E6X.3.2.2.m1.3.3.3.3.4.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.3.3"><apply id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1"><times id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.1"></times><ci id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.2">𝑥</ci><apply id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.2">𝑾</ci><ci id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2"><times id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.1.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.1"></times><ci id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.2">𝑥</ci><apply id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3.1.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3.2">𝑾</ci><ci id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3.3.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.3.3">𝑘</ci></apply></apply><apply id="S4.E6X.3.2.2.m1.3.3.3.3.3.3.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3"><times id="S4.E6X.3.2.2.m1.3.3.3.3.3.3.1.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3.1"></times><ci id="S4.E6X.3.2.2.m1.3.3.3.3.3.3.2.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3.2">𝑥</ci><apply id="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3.1.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3.2.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3.2">𝑾</ci><ci id="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3.3.cmml" xref="S4.E6X.3.2.2.m1.3.3.3.3.3.3.3.3">𝑣</ci></apply></apply></vector></apply></apply><ci id="S4.E6X.3.2.2.m1.5.5.3.2a.cmml" xref="S4.E6X.3.2.2.m1.5.5.3.2"><mtext mathsize="70%" id="S4.E6X.3.2.2.m1.5.5.3.2.cmml" xref="S4.E6X.3.2.2.m1.5.5.3.2">aggregated attention</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6X.3.2.2.m1.5c">\displaystyle(1-\lambda(x))\underbrace{Attn(x{\bm{W}}_{q},x{\bm{W}}_{k},x{\bm{W}}_{v})}_{\text{aggregated attention}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
<tr id="S4.E6Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E6Xa.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle+\lambda(x)\underbrace{Attn(x{\bm{W}}_{q},x{\bm{P}}_{k},x{\bm{P}}_{v})}_{\text{personalized attention}}" display="inline"><semantics id="S4.E6Xa.2.1.1.m1.4a"><mrow id="S4.E6Xa.2.1.1.m1.4.5" xref="S4.E6Xa.2.1.1.m1.4.5.cmml"><mo id="S4.E6Xa.2.1.1.m1.4.5a" xref="S4.E6Xa.2.1.1.m1.4.5.cmml">+</mo><mrow id="S4.E6Xa.2.1.1.m1.4.5.2" xref="S4.E6Xa.2.1.1.m1.4.5.2.cmml"><mi id="S4.E6Xa.2.1.1.m1.4.5.2.2" xref="S4.E6Xa.2.1.1.m1.4.5.2.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.E6Xa.2.1.1.m1.4.5.2.1" xref="S4.E6Xa.2.1.1.m1.4.5.2.1.cmml">​</mo><mrow id="S4.E6Xa.2.1.1.m1.4.5.2.3.2" xref="S4.E6Xa.2.1.1.m1.4.5.2.cmml"><mo stretchy="false" id="S4.E6Xa.2.1.1.m1.4.5.2.3.2.1" xref="S4.E6Xa.2.1.1.m1.4.5.2.cmml">(</mo><mi id="S4.E6Xa.2.1.1.m1.4.4" xref="S4.E6Xa.2.1.1.m1.4.4.cmml">x</mi><mo stretchy="false" id="S4.E6Xa.2.1.1.m1.4.5.2.3.2.2" xref="S4.E6Xa.2.1.1.m1.4.5.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E6Xa.2.1.1.m1.4.5.2.1a" xref="S4.E6Xa.2.1.1.m1.4.5.2.1.cmml">​</mo><munder id="S4.E6Xa.2.1.1.m1.4.5.2.4" xref="S4.E6Xa.2.1.1.m1.4.5.2.4.cmml"><munder accentunder="true" id="S4.E6Xa.2.1.1.m1.3.3" xref="S4.E6Xa.2.1.1.m1.3.3.cmml"><mrow id="S4.E6Xa.2.1.1.m1.3.3.3" xref="S4.E6Xa.2.1.1.m1.3.3.3.cmml"><mi id="S4.E6Xa.2.1.1.m1.3.3.3.5" xref="S4.E6Xa.2.1.1.m1.3.3.3.5.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.E6Xa.2.1.1.m1.3.3.3.4" xref="S4.E6Xa.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S4.E6Xa.2.1.1.m1.3.3.3.6" xref="S4.E6Xa.2.1.1.m1.3.3.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E6Xa.2.1.1.m1.3.3.3.4a" xref="S4.E6Xa.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S4.E6Xa.2.1.1.m1.3.3.3.7" xref="S4.E6Xa.2.1.1.m1.3.3.3.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E6Xa.2.1.1.m1.3.3.3.4b" xref="S4.E6Xa.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S4.E6Xa.2.1.1.m1.3.3.3.8" xref="S4.E6Xa.2.1.1.m1.3.3.3.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E6Xa.2.1.1.m1.3.3.3.4c" xref="S4.E6Xa.2.1.1.m1.3.3.3.4.cmml">​</mo><mrow id="S4.E6Xa.2.1.1.m1.3.3.3.3.3" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.4.cmml"><mo stretchy="false" id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.4" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.4.cmml">(</mo><mrow id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.2" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3.2" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3.3" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.5" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.4.cmml">,</mo><mrow id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.cmml"><mi id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.2" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.1" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.1.cmml">​</mo><msub id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3.cmml"><mi id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3.2" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3.2.cmml">𝑷</mi><mi id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3.3" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3.3.cmml">k</mi></msub></mrow><mo id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.6" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.4.cmml">,</mo><mrow id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.cmml"><mi id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.2" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.1" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.1.cmml">​</mo><msub id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3.cmml"><mi id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3.2" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3.2.cmml">𝑷</mi><mi id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3.3" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3.3.cmml">v</mi></msub></mrow><mo stretchy="false" id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.7" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow><mo id="S4.E6Xa.2.1.1.m1.3.3.4" xref="S4.E6Xa.2.1.1.m1.3.3.4.cmml">⏟</mo></munder><mtext id="S4.E6Xa.2.1.1.m1.4.5.2.4.2" xref="S4.E6Xa.2.1.1.m1.4.5.2.4.2a.cmml">personalized attention</mtext></munder></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6Xa.2.1.1.m1.4b"><apply id="S4.E6Xa.2.1.1.m1.4.5.cmml" xref="S4.E6Xa.2.1.1.m1.4.5"><plus id="S4.E6Xa.2.1.1.m1.4.5.1.cmml" xref="S4.E6Xa.2.1.1.m1.4.5"></plus><apply id="S4.E6Xa.2.1.1.m1.4.5.2.cmml" xref="S4.E6Xa.2.1.1.m1.4.5.2"><times id="S4.E6Xa.2.1.1.m1.4.5.2.1.cmml" xref="S4.E6Xa.2.1.1.m1.4.5.2.1"></times><ci id="S4.E6Xa.2.1.1.m1.4.5.2.2.cmml" xref="S4.E6Xa.2.1.1.m1.4.5.2.2">𝜆</ci><ci id="S4.E6Xa.2.1.1.m1.4.4.cmml" xref="S4.E6Xa.2.1.1.m1.4.4">𝑥</ci><apply id="S4.E6Xa.2.1.1.m1.4.5.2.4.cmml" xref="S4.E6Xa.2.1.1.m1.4.5.2.4"><csymbol cd="ambiguous" id="S4.E6Xa.2.1.1.m1.4.5.2.4.1.cmml" xref="S4.E6Xa.2.1.1.m1.4.5.2.4">subscript</csymbol><apply id="S4.E6Xa.2.1.1.m1.3.3.cmml" xref="S4.E6Xa.2.1.1.m1.3.3"><ci id="S4.E6Xa.2.1.1.m1.3.3.4.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.4">⏟</ci><apply id="S4.E6Xa.2.1.1.m1.3.3.3.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3"><times id="S4.E6Xa.2.1.1.m1.3.3.3.4.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.4"></times><ci id="S4.E6Xa.2.1.1.m1.3.3.3.5.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.5">𝐴</ci><ci id="S4.E6Xa.2.1.1.m1.3.3.3.6.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.6">𝑡</ci><ci id="S4.E6Xa.2.1.1.m1.3.3.3.7.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.7">𝑡</ci><ci id="S4.E6Xa.2.1.1.m1.3.3.3.8.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.8">𝑛</ci><vector id="S4.E6Xa.2.1.1.m1.3.3.3.3.4.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3"><apply id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1"><times id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.1"></times><ci id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.2">𝑥</ci><apply id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3.2">𝑾</ci><ci id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2"><times id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.1.cmml" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.1"></times><ci id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.2.cmml" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.2">𝑥</ci><apply id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3.cmml" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3.1.cmml" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3.2.cmml" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3.2">𝑷</ci><ci id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3.3.cmml" xref="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3.3">𝑘</ci></apply></apply><apply id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3"><times id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.1.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.1"></times><ci id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.2.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.2">𝑥</ci><apply id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3.1.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3.2.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3.2">𝑷</ci><ci id="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3.3.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.3.3.3.3.3.3">𝑣</ci></apply></apply></vector></apply></apply><ci id="S4.E6Xa.2.1.1.m1.4.5.2.4.2a.cmml" xref="S4.E6Xa.2.1.1.m1.4.5.2.4.2"><mtext mathsize="70%" id="S4.E6Xa.2.1.1.m1.4.5.2.4.2.cmml" xref="S4.E6Xa.2.1.1.m1.4.5.2.4.2">personalized attention</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6Xa.2.1.1.m1.4c">\displaystyle+\lambda(x)\underbrace{Attn(x{\bm{W}}_{q},x{\bm{P}}_{k},x{\bm{P}}_{v})}_{\text{personalized attention}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S4.SS2.p4.1" class="ltx_p">where <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="\lambda(x)" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mrow id="S4.SS2.p4.1.m1.1.2" xref="S4.SS2.p4.1.m1.1.2.cmml"><mi id="S4.SS2.p4.1.m1.1.2.2" xref="S4.SS2.p4.1.m1.1.2.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.1.m1.1.2.1" xref="S4.SS2.p4.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p4.1.m1.1.2.3.2" xref="S4.SS2.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p4.1.m1.1.2.3.2.1" xref="S4.SS2.p4.1.m1.1.2.cmml">(</mo><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS2.p4.1.m1.1.2.3.2.2" xref="S4.SS2.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.2"><times id="S4.SS2.p4.1.m1.1.2.1.cmml" xref="S4.SS2.p4.1.m1.1.2.1"></times><ci id="S4.SS2.p4.1.m1.1.2.2.cmml" xref="S4.SS2.p4.1.m1.1.2.2">𝜆</ci><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\lambda(x)</annotation></semantics></math> is a scalar representing the normalized attention weights on the prefixes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. More details are provided in <span id="S4.SS2.p4.1.1" class="ltx_text" style="color:#0000FF;">Supplementary B</span>. It reveals that <span id="S4.SS2.p4.1.2" class="ltx_text ltx_font_italic">the local prefixes are learned as a mixture coefficient between the aggregated attention from the global model and the personalized attention from the prefixes</span>. The high performance of both APFL and FedPerfix indicates the effectiveness of a mixture between the local and global models in PFL. Compared with APFL, FedPerfix only mixed the sensitive self-attention layers instead of the entire model, leading to higher performance. Meanwhile, FedPerfix trains the Prefix, which can be considered as the mixture coefficient, and the model simultaneously, while APFL needs separate training for the personalized model. Therefore, FedPerfix can achieve higher performance with fewer <span id="S4.SS2.p4.1.3" class="ltx_text ltx_font_bold">storage</span>, <span id="S4.SS2.p4.1.4" class="ltx_text ltx_font_bold">computation</span>, and <span id="S4.SS2.p4.1.5" class="ltx_text ltx_font_bold">communication</span> resources. Furthermore, we provide a more detailed resource requirements analysis of each method in the following Section <a href="#S4.SS4" title="4.4 Resource Requirements Analysis ‣ 4 Experiment ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Client-wise Performance</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">In Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.3 Client-wise Performance ‣ 4 Experiment ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we present a density plot depicting the performance gain of each method in comparison to Local. Notably, FedPerfix demonstrates an average performance gain of over 10%, surpassing all other methods. Moreover, FedPerfix outperforms all other methods by achieving up to 30% performance gains for certain clients. Conversely, some clients experience performance degradation under other methods, while FedPerfix ensures performance gains for nearly all clients.
In conclusion, FedPerfix shows a <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_italic">higher upper bound</span> while maintaining <span id="S4.SS3.p1.1.2" class="ltx_text ltx_font_italic">a high lower bound</span>, which will encourage more clients to involve in the federated training with performance-gaining guarantees for almost all clients.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2308.09160/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="258" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S4.F3.2.1" class="ltx_text ltx_font_bold">Client-wise performance for each method on CIFAR-100.</span> Density of the accuracy gain compared with Local training is plotted. FedPerfix provides highest upper and lower bounds among all the methods.</figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Resource Requirements Analysis</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">In federated learning, it is crucial to consider the practicality of each method in terms of the storage, computation, and communication resources required by each participating client. As such, it is imperative to analyze the resource demands of each approach to determine its feasibility in realistic federated settings.
</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">We present a resource analysis of the evaluated methods, taking into account the storage, computation, and communication demands, which are crucial aspects in practical federated learning scenarios where clients may have limited resources. Table <a href="#S3.T2" title="Table 2 ‣ 3.5 FedPerfix: Stabilize the Prefix ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> reports the parameter size required to store the model, the FLOPs needed for training, and the parameter size required for communication. Notably, FedPerfix achieves superior performance compared to other methods with slightly more resources for storage and computation but fewer resources for communication.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.1" class="ltx_p">Overall, our proposed FedPerfix approach demonstrates the highest efficiency in terms of achieving superior performance while utilizing fewer storage, computation, and communication resources compared to other methods. These findings highlight the potential of our approach to effectively address the resource constraints often encountered in realistic federated learning scenarios.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Ablation Study</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we conduct an ablation study on the CIFAR-100 dataset to evaluate the robustness of FedPerfix under various federated learning settings and to investigate FedPerfix with different designs.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Performance on CIFAR-100 with different backbones.</figcaption>
<table id="S5.T3.15.15" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.15.15.16.1" class="ltx_tr">
<th id="S5.T3.15.15.16.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"><span id="S5.T3.15.15.16.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S5.T3.15.15.16.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T3.15.15.16.1.2.1" class="ltx_text ltx_font_bold">ResNet50</span></th>
<th id="S5.T3.15.15.16.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T3.15.15.16.1.3.1" class="ltx_text ltx_font_bold">ViT-Small</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.2.2.2" class="ltx_tr">
<th id="S5.T3.2.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">FedAVG</th>
<td id="S5.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="17.87_{\pm 13.16}" display="inline"><semantics id="S5.T3.1.1.1.1.m1.1a"><msub id="S5.T3.1.1.1.1.m1.1.1" xref="S5.T3.1.1.1.1.m1.1.1.cmml"><mn id="S5.T3.1.1.1.1.m1.1.1.2" xref="S5.T3.1.1.1.1.m1.1.1.2.cmml">17.87</mn><mrow id="S5.T3.1.1.1.1.m1.1.1.3" xref="S5.T3.1.1.1.1.m1.1.1.3.cmml"><mo id="S5.T3.1.1.1.1.m1.1.1.3a" xref="S5.T3.1.1.1.1.m1.1.1.3.cmml">±</mo><mn id="S5.T3.1.1.1.1.m1.1.1.3.2" xref="S5.T3.1.1.1.1.m1.1.1.3.2.cmml">13.16</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.1.m1.1b"><apply id="S5.T3.1.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.1.1.1.1.m1.1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.1.1.1.1.m1.1.1.2.cmml" xref="S5.T3.1.1.1.1.m1.1.1.2">17.87</cn><apply id="S5.T3.1.1.1.1.m1.1.1.3.cmml" xref="S5.T3.1.1.1.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.1.1.1.1.m1.1.1.3.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.1.1.1.1.m1.1.1.3.2.cmml" xref="S5.T3.1.1.1.1.m1.1.1.3.2">13.16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.1.m1.1c">17.87_{\pm 13.16}</annotation></semantics></math></td>
<td id="S5.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T3.2.2.2.2.m1.1" class="ltx_Math" alttext="23.29_{\pm 11.31}" display="inline"><semantics id="S5.T3.2.2.2.2.m1.1a"><msub id="S5.T3.2.2.2.2.m1.1.1" xref="S5.T3.2.2.2.2.m1.1.1.cmml"><mn id="S5.T3.2.2.2.2.m1.1.1.2" xref="S5.T3.2.2.2.2.m1.1.1.2.cmml">23.29</mn><mrow id="S5.T3.2.2.2.2.m1.1.1.3" xref="S5.T3.2.2.2.2.m1.1.1.3.cmml"><mo id="S5.T3.2.2.2.2.m1.1.1.3a" xref="S5.T3.2.2.2.2.m1.1.1.3.cmml">±</mo><mn id="S5.T3.2.2.2.2.m1.1.1.3.2" xref="S5.T3.2.2.2.2.m1.1.1.3.2.cmml">11.31</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.2.m1.1b"><apply id="S5.T3.2.2.2.2.m1.1.1.cmml" xref="S5.T3.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.2.2.2.2.m1.1.1.1.cmml" xref="S5.T3.2.2.2.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.2.2.2.2.m1.1.1.2.cmml" xref="S5.T3.2.2.2.2.m1.1.1.2">23.29</cn><apply id="S5.T3.2.2.2.2.m1.1.1.3.cmml" xref="S5.T3.2.2.2.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.2.2.2.2.m1.1.1.3.1.cmml" xref="S5.T3.2.2.2.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.2.2.2.2.m1.1.1.3.2.cmml" xref="S5.T3.2.2.2.2.m1.1.1.3.2">11.31</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.2.m1.1c">23.29_{\pm 11.31}</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.4.4.4" class="ltx_tr">
<th id="S5.T3.4.4.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Local</th>
<td id="S5.T3.3.3.3.1" class="ltx_td ltx_align_center"><math id="S5.T3.3.3.3.1.m1.1" class="ltx_Math" alttext="28.34_{\pm 9.83}" display="inline"><semantics id="S5.T3.3.3.3.1.m1.1a"><msub id="S5.T3.3.3.3.1.m1.1.1" xref="S5.T3.3.3.3.1.m1.1.1.cmml"><mn id="S5.T3.3.3.3.1.m1.1.1.2" xref="S5.T3.3.3.3.1.m1.1.1.2.cmml">28.34</mn><mrow id="S5.T3.3.3.3.1.m1.1.1.3" xref="S5.T3.3.3.3.1.m1.1.1.3.cmml"><mo id="S5.T3.3.3.3.1.m1.1.1.3a" xref="S5.T3.3.3.3.1.m1.1.1.3.cmml">±</mo><mn id="S5.T3.3.3.3.1.m1.1.1.3.2" xref="S5.T3.3.3.3.1.m1.1.1.3.2.cmml">9.83</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.1.m1.1b"><apply id="S5.T3.3.3.3.1.m1.1.1.cmml" xref="S5.T3.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.3.3.3.1.m1.1.1.1.cmml" xref="S5.T3.3.3.3.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.3.3.3.1.m1.1.1.2.cmml" xref="S5.T3.3.3.3.1.m1.1.1.2">28.34</cn><apply id="S5.T3.3.3.3.1.m1.1.1.3.cmml" xref="S5.T3.3.3.3.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.3.3.3.1.m1.1.1.3.1.cmml" xref="S5.T3.3.3.3.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.3.3.3.1.m1.1.1.3.2.cmml" xref="S5.T3.3.3.3.1.m1.1.1.3.2">9.83</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.1.m1.1c">28.34_{\pm 9.83}</annotation></semantics></math></td>
<td id="S5.T3.4.4.4.2" class="ltx_td ltx_align_center"><math id="S5.T3.4.4.4.2.m1.1" class="ltx_Math" alttext="34.74_{\pm 9.36}" display="inline"><semantics id="S5.T3.4.4.4.2.m1.1a"><msub id="S5.T3.4.4.4.2.m1.1.1" xref="S5.T3.4.4.4.2.m1.1.1.cmml"><mn id="S5.T3.4.4.4.2.m1.1.1.2" xref="S5.T3.4.4.4.2.m1.1.1.2.cmml">34.74</mn><mrow id="S5.T3.4.4.4.2.m1.1.1.3" xref="S5.T3.4.4.4.2.m1.1.1.3.cmml"><mo id="S5.T3.4.4.4.2.m1.1.1.3a" xref="S5.T3.4.4.4.2.m1.1.1.3.cmml">±</mo><mn id="S5.T3.4.4.4.2.m1.1.1.3.2" xref="S5.T3.4.4.4.2.m1.1.1.3.2.cmml">9.36</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.4.2.m1.1b"><apply id="S5.T3.4.4.4.2.m1.1.1.cmml" xref="S5.T3.4.4.4.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.4.4.4.2.m1.1.1.1.cmml" xref="S5.T3.4.4.4.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.4.4.4.2.m1.1.1.2.cmml" xref="S5.T3.4.4.4.2.m1.1.1.2">34.74</cn><apply id="S5.T3.4.4.4.2.m1.1.1.3.cmml" xref="S5.T3.4.4.4.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.4.4.4.2.m1.1.1.3.1.cmml" xref="S5.T3.4.4.4.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.4.4.4.2.m1.1.1.3.2.cmml" xref="S5.T3.4.4.4.2.m1.1.1.3.2">9.36</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.4.2.m1.1c">34.74_{\pm 9.36}</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.6.6.6" class="ltx_tr">
<th id="S5.T3.6.6.6.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">APFL</th>
<td id="S5.T3.5.5.5.1" class="ltx_td ltx_align_center"><math id="S5.T3.5.5.5.1.m1.1" class="ltx_Math" alttext="30.71_{\pm 9.89}" display="inline"><semantics id="S5.T3.5.5.5.1.m1.1a"><msub id="S5.T3.5.5.5.1.m1.1.1" xref="S5.T3.5.5.5.1.m1.1.1.cmml"><mn id="S5.T3.5.5.5.1.m1.1.1.2" xref="S5.T3.5.5.5.1.m1.1.1.2.cmml">30.71</mn><mrow id="S5.T3.5.5.5.1.m1.1.1.3" xref="S5.T3.5.5.5.1.m1.1.1.3.cmml"><mo id="S5.T3.5.5.5.1.m1.1.1.3a" xref="S5.T3.5.5.5.1.m1.1.1.3.cmml">±</mo><mn id="S5.T3.5.5.5.1.m1.1.1.3.2" xref="S5.T3.5.5.5.1.m1.1.1.3.2.cmml">9.89</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.5.5.5.1.m1.1b"><apply id="S5.T3.5.5.5.1.m1.1.1.cmml" xref="S5.T3.5.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.5.5.5.1.m1.1.1.1.cmml" xref="S5.T3.5.5.5.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.5.5.5.1.m1.1.1.2.cmml" xref="S5.T3.5.5.5.1.m1.1.1.2">30.71</cn><apply id="S5.T3.5.5.5.1.m1.1.1.3.cmml" xref="S5.T3.5.5.5.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.5.5.5.1.m1.1.1.3.1.cmml" xref="S5.T3.5.5.5.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.5.5.5.1.m1.1.1.3.2.cmml" xref="S5.T3.5.5.5.1.m1.1.1.3.2">9.89</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.5.5.1.m1.1c">30.71_{\pm 9.89}</annotation></semantics></math></td>
<td id="S5.T3.6.6.6.2" class="ltx_td ltx_align_center"><math id="S5.T3.6.6.6.2.m1.1" class="ltx_Math" alttext="44.88_{\pm 10.50}" display="inline"><semantics id="S5.T3.6.6.6.2.m1.1a"><msub id="S5.T3.6.6.6.2.m1.1.1" xref="S5.T3.6.6.6.2.m1.1.1.cmml"><mn id="S5.T3.6.6.6.2.m1.1.1.2" xref="S5.T3.6.6.6.2.m1.1.1.2.cmml">44.88</mn><mrow id="S5.T3.6.6.6.2.m1.1.1.3" xref="S5.T3.6.6.6.2.m1.1.1.3.cmml"><mo id="S5.T3.6.6.6.2.m1.1.1.3a" xref="S5.T3.6.6.6.2.m1.1.1.3.cmml">±</mo><mn id="S5.T3.6.6.6.2.m1.1.1.3.2" xref="S5.T3.6.6.6.2.m1.1.1.3.2.cmml">10.50</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.6.6.6.2.m1.1b"><apply id="S5.T3.6.6.6.2.m1.1.1.cmml" xref="S5.T3.6.6.6.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.6.6.6.2.m1.1.1.1.cmml" xref="S5.T3.6.6.6.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.6.6.6.2.m1.1.1.2.cmml" xref="S5.T3.6.6.6.2.m1.1.1.2">44.88</cn><apply id="S5.T3.6.6.6.2.m1.1.1.3.cmml" xref="S5.T3.6.6.6.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.6.6.6.2.m1.1.1.3.1.cmml" xref="S5.T3.6.6.6.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.6.6.6.2.m1.1.1.3.2.cmml" xref="S5.T3.6.6.6.2.m1.1.1.3.2">10.50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.6.6.2.m1.1c">44.88_{\pm 10.50}</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.8.8.8" class="ltx_tr">
<th id="S5.T3.8.8.8.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Per-FedAVG</th>
<td id="S5.T3.7.7.7.1" class="ltx_td ltx_align_center"><math id="S5.T3.7.7.7.1.m1.1" class="ltx_Math" alttext="28.82_{\pm 8.53}" display="inline"><semantics id="S5.T3.7.7.7.1.m1.1a"><msub id="S5.T3.7.7.7.1.m1.1.1" xref="S5.T3.7.7.7.1.m1.1.1.cmml"><mn id="S5.T3.7.7.7.1.m1.1.1.2" xref="S5.T3.7.7.7.1.m1.1.1.2.cmml">28.82</mn><mrow id="S5.T3.7.7.7.1.m1.1.1.3" xref="S5.T3.7.7.7.1.m1.1.1.3.cmml"><mo id="S5.T3.7.7.7.1.m1.1.1.3a" xref="S5.T3.7.7.7.1.m1.1.1.3.cmml">±</mo><mn id="S5.T3.7.7.7.1.m1.1.1.3.2" xref="S5.T3.7.7.7.1.m1.1.1.3.2.cmml">8.53</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.7.7.7.1.m1.1b"><apply id="S5.T3.7.7.7.1.m1.1.1.cmml" xref="S5.T3.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.7.7.7.1.m1.1.1.1.cmml" xref="S5.T3.7.7.7.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.7.7.7.1.m1.1.1.2.cmml" xref="S5.T3.7.7.7.1.m1.1.1.2">28.82</cn><apply id="S5.T3.7.7.7.1.m1.1.1.3.cmml" xref="S5.T3.7.7.7.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.7.7.7.1.m1.1.1.3.1.cmml" xref="S5.T3.7.7.7.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.7.7.7.1.m1.1.1.3.2.cmml" xref="S5.T3.7.7.7.1.m1.1.1.3.2">8.53</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.7.7.7.1.m1.1c">28.82_{\pm 8.53}</annotation></semantics></math></td>
<td id="S5.T3.8.8.8.2" class="ltx_td ltx_align_center"><math id="S5.T3.8.8.8.2.m1.1" class="ltx_Math" alttext="33.86_{\pm 8.01}" display="inline"><semantics id="S5.T3.8.8.8.2.m1.1a"><msub id="S5.T3.8.8.8.2.m1.1.1" xref="S5.T3.8.8.8.2.m1.1.1.cmml"><mn id="S5.T3.8.8.8.2.m1.1.1.2" xref="S5.T3.8.8.8.2.m1.1.1.2.cmml">33.86</mn><mrow id="S5.T3.8.8.8.2.m1.1.1.3" xref="S5.T3.8.8.8.2.m1.1.1.3.cmml"><mo id="S5.T3.8.8.8.2.m1.1.1.3a" xref="S5.T3.8.8.8.2.m1.1.1.3.cmml">±</mo><mn id="S5.T3.8.8.8.2.m1.1.1.3.2" xref="S5.T3.8.8.8.2.m1.1.1.3.2.cmml">8.01</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.8.8.8.2.m1.1b"><apply id="S5.T3.8.8.8.2.m1.1.1.cmml" xref="S5.T3.8.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.8.8.8.2.m1.1.1.1.cmml" xref="S5.T3.8.8.8.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.8.8.8.2.m1.1.1.2.cmml" xref="S5.T3.8.8.8.2.m1.1.1.2">33.86</cn><apply id="S5.T3.8.8.8.2.m1.1.1.3.cmml" xref="S5.T3.8.8.8.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.8.8.8.2.m1.1.1.3.1.cmml" xref="S5.T3.8.8.8.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.8.8.8.2.m1.1.1.3.2.cmml" xref="S5.T3.8.8.8.2.m1.1.1.3.2">8.01</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.8.8.8.2.m1.1c">33.86_{\pm 8.01}</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.10.10.10" class="ltx_tr">
<th id="S5.T3.10.10.10.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedBN</th>
<td id="S5.T3.9.9.9.1" class="ltx_td ltx_align_center"><math id="S5.T3.9.9.9.1.m1.1" class="ltx_Math" alttext="19.33_{\pm 10.25}" display="inline"><semantics id="S5.T3.9.9.9.1.m1.1a"><msub id="S5.T3.9.9.9.1.m1.1.1" xref="S5.T3.9.9.9.1.m1.1.1.cmml"><mn id="S5.T3.9.9.9.1.m1.1.1.2" xref="S5.T3.9.9.9.1.m1.1.1.2.cmml">19.33</mn><mrow id="S5.T3.9.9.9.1.m1.1.1.3" xref="S5.T3.9.9.9.1.m1.1.1.3.cmml"><mo id="S5.T3.9.9.9.1.m1.1.1.3a" xref="S5.T3.9.9.9.1.m1.1.1.3.cmml">±</mo><mn id="S5.T3.9.9.9.1.m1.1.1.3.2" xref="S5.T3.9.9.9.1.m1.1.1.3.2.cmml">10.25</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.9.9.9.1.m1.1b"><apply id="S5.T3.9.9.9.1.m1.1.1.cmml" xref="S5.T3.9.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.9.9.9.1.m1.1.1.1.cmml" xref="S5.T3.9.9.9.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.9.9.9.1.m1.1.1.2.cmml" xref="S5.T3.9.9.9.1.m1.1.1.2">19.33</cn><apply id="S5.T3.9.9.9.1.m1.1.1.3.cmml" xref="S5.T3.9.9.9.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.9.9.9.1.m1.1.1.3.1.cmml" xref="S5.T3.9.9.9.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.9.9.9.1.m1.1.1.3.2.cmml" xref="S5.T3.9.9.9.1.m1.1.1.3.2">10.25</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.9.9.9.1.m1.1c">19.33_{\pm 10.25}</annotation></semantics></math></td>
<td id="S5.T3.10.10.10.2" class="ltx_td ltx_align_center"><math id="S5.T3.10.10.10.2.m1.1" class="ltx_Math" alttext="23.94_{\pm 11.19}" display="inline"><semantics id="S5.T3.10.10.10.2.m1.1a"><msub id="S5.T3.10.10.10.2.m1.1.1" xref="S5.T3.10.10.10.2.m1.1.1.cmml"><mn id="S5.T3.10.10.10.2.m1.1.1.2" xref="S5.T3.10.10.10.2.m1.1.1.2.cmml">23.94</mn><mrow id="S5.T3.10.10.10.2.m1.1.1.3" xref="S5.T3.10.10.10.2.m1.1.1.3.cmml"><mo id="S5.T3.10.10.10.2.m1.1.1.3a" xref="S5.T3.10.10.10.2.m1.1.1.3.cmml">±</mo><mn id="S5.T3.10.10.10.2.m1.1.1.3.2" xref="S5.T3.10.10.10.2.m1.1.1.3.2.cmml">11.19</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.10.10.10.2.m1.1b"><apply id="S5.T3.10.10.10.2.m1.1.1.cmml" xref="S5.T3.10.10.10.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.10.10.10.2.m1.1.1.1.cmml" xref="S5.T3.10.10.10.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.10.10.10.2.m1.1.1.2.cmml" xref="S5.T3.10.10.10.2.m1.1.1.2">23.94</cn><apply id="S5.T3.10.10.10.2.m1.1.1.3.cmml" xref="S5.T3.10.10.10.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.10.10.10.2.m1.1.1.3.1.cmml" xref="S5.T3.10.10.10.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.10.10.10.2.m1.1.1.3.2.cmml" xref="S5.T3.10.10.10.2.m1.1.1.3.2">11.19</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.10.10.10.2.m1.1c">23.94_{\pm 11.19}</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.12.12.12" class="ltx_tr">
<th id="S5.T3.12.12.12.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedBABU</th>
<td id="S5.T3.11.11.11.1" class="ltx_td ltx_align_center"><math id="S5.T3.11.11.11.1.m1.1" class="ltx_Math" alttext="24.56_{\pm 7.82}" display="inline"><semantics id="S5.T3.11.11.11.1.m1.1a"><msub id="S5.T3.11.11.11.1.m1.1.1" xref="S5.T3.11.11.11.1.m1.1.1.cmml"><mn id="S5.T3.11.11.11.1.m1.1.1.2" xref="S5.T3.11.11.11.1.m1.1.1.2.cmml">24.56</mn><mrow id="S5.T3.11.11.11.1.m1.1.1.3" xref="S5.T3.11.11.11.1.m1.1.1.3.cmml"><mo id="S5.T3.11.11.11.1.m1.1.1.3a" xref="S5.T3.11.11.11.1.m1.1.1.3.cmml">±</mo><mn id="S5.T3.11.11.11.1.m1.1.1.3.2" xref="S5.T3.11.11.11.1.m1.1.1.3.2.cmml">7.82</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.11.11.11.1.m1.1b"><apply id="S5.T3.11.11.11.1.m1.1.1.cmml" xref="S5.T3.11.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.11.11.11.1.m1.1.1.1.cmml" xref="S5.T3.11.11.11.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.11.11.11.1.m1.1.1.2.cmml" xref="S5.T3.11.11.11.1.m1.1.1.2">24.56</cn><apply id="S5.T3.11.11.11.1.m1.1.1.3.cmml" xref="S5.T3.11.11.11.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.11.11.11.1.m1.1.1.3.1.cmml" xref="S5.T3.11.11.11.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.11.11.11.1.m1.1.1.3.2.cmml" xref="S5.T3.11.11.11.1.m1.1.1.3.2">7.82</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.11.11.11.1.m1.1c">24.56_{\pm 7.82}</annotation></semantics></math></td>
<td id="S5.T3.12.12.12.2" class="ltx_td ltx_align_center"><math id="S5.T3.12.12.12.2.m1.1" class="ltx_Math" alttext="41.41_{\pm 8.87}" display="inline"><semantics id="S5.T3.12.12.12.2.m1.1a"><msub id="S5.T3.12.12.12.2.m1.1.1" xref="S5.T3.12.12.12.2.m1.1.1.cmml"><mn id="S5.T3.12.12.12.2.m1.1.1.2" xref="S5.T3.12.12.12.2.m1.1.1.2.cmml">41.41</mn><mrow id="S5.T3.12.12.12.2.m1.1.1.3" xref="S5.T3.12.12.12.2.m1.1.1.3.cmml"><mo id="S5.T3.12.12.12.2.m1.1.1.3a" xref="S5.T3.12.12.12.2.m1.1.1.3.cmml">±</mo><mn id="S5.T3.12.12.12.2.m1.1.1.3.2" xref="S5.T3.12.12.12.2.m1.1.1.3.2.cmml">8.87</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.12.12.12.2.m1.1b"><apply id="S5.T3.12.12.12.2.m1.1.1.cmml" xref="S5.T3.12.12.12.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.12.12.12.2.m1.1.1.1.cmml" xref="S5.T3.12.12.12.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.12.12.12.2.m1.1.1.2.cmml" xref="S5.T3.12.12.12.2.m1.1.1.2">41.41</cn><apply id="S5.T3.12.12.12.2.m1.1.1.3.cmml" xref="S5.T3.12.12.12.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.12.12.12.2.m1.1.1.3.1.cmml" xref="S5.T3.12.12.12.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.12.12.12.2.m1.1.1.3.2.cmml" xref="S5.T3.12.12.12.2.m1.1.1.3.2">8.87</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.12.12.12.2.m1.1c">41.41_{\pm 8.87}</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.14.14.14" class="ltx_tr">
<th id="S5.T3.14.14.14.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedRep</th>
<td id="S5.T3.13.13.13.1" class="ltx_td ltx_align_center"><math id="S5.T3.13.13.13.1.m1.1" class="ltx_Math" alttext="39.52_{\pm 10.92}" display="inline"><semantics id="S5.T3.13.13.13.1.m1.1a"><msub id="S5.T3.13.13.13.1.m1.1.1" xref="S5.T3.13.13.13.1.m1.1.1.cmml"><mn id="S5.T3.13.13.13.1.m1.1.1.2" xref="S5.T3.13.13.13.1.m1.1.1.2.cmml">39.52</mn><mrow id="S5.T3.13.13.13.1.m1.1.1.3" xref="S5.T3.13.13.13.1.m1.1.1.3.cmml"><mo id="S5.T3.13.13.13.1.m1.1.1.3a" xref="S5.T3.13.13.13.1.m1.1.1.3.cmml">±</mo><mn id="S5.T3.13.13.13.1.m1.1.1.3.2" xref="S5.T3.13.13.13.1.m1.1.1.3.2.cmml">10.92</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.13.13.13.1.m1.1b"><apply id="S5.T3.13.13.13.1.m1.1.1.cmml" xref="S5.T3.13.13.13.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.13.13.13.1.m1.1.1.1.cmml" xref="S5.T3.13.13.13.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.13.13.13.1.m1.1.1.2.cmml" xref="S5.T3.13.13.13.1.m1.1.1.2">39.52</cn><apply id="S5.T3.13.13.13.1.m1.1.1.3.cmml" xref="S5.T3.13.13.13.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.13.13.13.1.m1.1.1.3.1.cmml" xref="S5.T3.13.13.13.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.13.13.13.1.m1.1.1.3.2.cmml" xref="S5.T3.13.13.13.1.m1.1.1.3.2">10.92</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.13.13.13.1.m1.1c">39.52_{\pm 10.92}</annotation></semantics></math></td>
<td id="S5.T3.14.14.14.2" class="ltx_td ltx_align_center"><math id="S5.T3.14.14.14.2.m1.1" class="ltx_Math" alttext="44.42_{\pm 7.80}" display="inline"><semantics id="S5.T3.14.14.14.2.m1.1a"><msub id="S5.T3.14.14.14.2.m1.1.1" xref="S5.T3.14.14.14.2.m1.1.1.cmml"><mn id="S5.T3.14.14.14.2.m1.1.1.2" xref="S5.T3.14.14.14.2.m1.1.1.2.cmml">44.42</mn><mrow id="S5.T3.14.14.14.2.m1.1.1.3" xref="S5.T3.14.14.14.2.m1.1.1.3.cmml"><mo id="S5.T3.14.14.14.2.m1.1.1.3a" xref="S5.T3.14.14.14.2.m1.1.1.3.cmml">±</mo><mn id="S5.T3.14.14.14.2.m1.1.1.3.2" xref="S5.T3.14.14.14.2.m1.1.1.3.2.cmml">7.80</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.14.14.14.2.m1.1b"><apply id="S5.T3.14.14.14.2.m1.1.1.cmml" xref="S5.T3.14.14.14.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.14.14.14.2.m1.1.1.1.cmml" xref="S5.T3.14.14.14.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.14.14.14.2.m1.1.1.2.cmml" xref="S5.T3.14.14.14.2.m1.1.1.2">44.42</cn><apply id="S5.T3.14.14.14.2.m1.1.1.3.cmml" xref="S5.T3.14.14.14.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.14.14.14.2.m1.1.1.3.1.cmml" xref="S5.T3.14.14.14.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.14.14.14.2.m1.1.1.3.2.cmml" xref="S5.T3.14.14.14.2.m1.1.1.3.2">7.80</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.14.14.14.2.m1.1c">44.42_{\pm 7.80}</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.15.15.15" class="ltx_tr">
<th id="S5.T3.15.15.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S5.T3.15.15.15.2.1" class="ltx_text ltx_font_bold">FedPerfix</span></th>
<td id="S5.T3.15.15.15.3" class="ltx_td ltx_align_center ltx_border_bb">-</td>
<td id="S5.T3.15.15.15.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S5.T3.15.15.15.1.m1.1" class="ltx_Math" alttext="48.10_{\pm 7.76}" display="inline"><semantics id="S5.T3.15.15.15.1.m1.1a"><msub id="S5.T3.15.15.15.1.m1.1.1" xref="S5.T3.15.15.15.1.m1.1.1.cmml"><mn id="S5.T3.15.15.15.1.m1.1.1.2" xref="S5.T3.15.15.15.1.m1.1.1.2.cmml">48.10</mn><mrow id="S5.T3.15.15.15.1.m1.1.1.3" xref="S5.T3.15.15.15.1.m1.1.1.3.cmml"><mo id="S5.T3.15.15.15.1.m1.1.1.3a" xref="S5.T3.15.15.15.1.m1.1.1.3.cmml">±</mo><mn id="S5.T3.15.15.15.1.m1.1.1.3.2" xref="S5.T3.15.15.15.1.m1.1.1.3.2.cmml">7.76</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.15.15.15.1.m1.1b"><apply id="S5.T3.15.15.15.1.m1.1.1.cmml" xref="S5.T3.15.15.15.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.15.15.15.1.m1.1.1.1.cmml" xref="S5.T3.15.15.15.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.15.15.15.1.m1.1.1.2.cmml" xref="S5.T3.15.15.15.1.m1.1.1.2">48.10</cn><apply id="S5.T3.15.15.15.1.m1.1.1.3.cmml" xref="S5.T3.15.15.15.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.15.15.15.1.m1.1.1.3.1.cmml" xref="S5.T3.15.15.15.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.15.15.15.1.m1.1.1.3.2.cmml" xref="S5.T3.15.15.15.1.m1.1.1.3.2">7.76</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.15.15.15.1.m1.1c">48.10_{\pm 7.76}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Performance Comparison with CNN Backbone</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">To further demonstrate the motivation behind our work, <em id="S5.SS1.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS1.p1.1.2" class="ltx_text"></span>, addressing PFL with ViT, we conduct experiments to compare ViT and CNN as different backbones for the same set of methods. Given that the comparison methods are <span id="S5.SS1.p1.1.3" class="ltx_text ltx_font_italic">originally designed with a CNN backbone</span>, we conduct experiments on CIFAR-100 with a CNN backbone as a reference to investigate the impact of replacing the CNNs with ViTs in these methods. To fairly compare the performance, we choose ResNet50 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> as the CNN backbone due to its similar parameter size (<span id="S5.SS1.p1.1.4" class="ltx_text ltx_font_bold">24.37M</span>) to ViT-Small <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> (<span id="S5.SS1.p1.1.5" class="ltx_text ltx_font_bold">21.03M</span>).</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">The result is shown in Table <a href="#S5.T3" title="Table 3 ‣ 5 Ablation Study ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Simply replacing the CNN backbone with the ViT backbone significantly improves performance for each method without additional operations. It suggests that the advantages of ViTs that demonstrated superior performance compared to CNNs in centralized settings may also translate to personalized federated learning scenarios.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">The success of ViTs in existing methods highlights their potential for personalized federated learning. However, there is a lack of approaches specifically designed for ViTs. To address this gap, we propose FedPerfix, which is tailored for ViTs and focuses on personalizing the sensitive parts of the network. By doing so, FedPerfix further improves performance compared to existing methods that incorporate ViTs. Our approach fills an important research gap and suggests that there is still much to be gained from exploring the unique properties of ViTs for personalized federated learning.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Different FL Settings</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">In order to assess the robustness of FedPerfix in more challenging federated learning scenarios, we conduct experiments that involve varying the number of clients with fewer samples per client and a lower client participation rate. We also compare the performance of FedPerfix with other competitive methods and report the results in Table <a href="#S5.T4" title="Table 4 ‣ 5.2 Different FL Settings ‣ 5 Ablation Study ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Our experimental results demonstrate that FedPerfix exhibits robust performance in different federated learning settings, outperforming all other methods consistently. Thus, FedPerfix can be considered a reliable solution for extreme federated learning scenarios.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Performance on CIFAR-100 under different federated learning settings.</figcaption>
<div id="S5.T4.26.26" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:187.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(70.8pt,-30.6pt) scale(1.48518911941131,1.48518911941131) ;">
<table id="S5.T4.26.26.26" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.2.2.2.2" class="ltx_tr">
<th id="S5.T4.2.2.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S5.T4.2.2.2.2.3.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S5.T4.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2"><math id="S5.T4.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{N=64}" display="inline"><semantics id="S5.T4.1.1.1.1.1.m1.1a"><mrow id="S5.T4.1.1.1.1.1.m1.1.1" xref="S5.T4.1.1.1.1.1.m1.1.1.cmml"><mi id="S5.T4.1.1.1.1.1.m1.1.1.2" xref="S5.T4.1.1.1.1.1.m1.1.1.2.cmml">𝐍</mi><mo id="S5.T4.1.1.1.1.1.m1.1.1.1" xref="S5.T4.1.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.T4.1.1.1.1.1.m1.1.1.3" xref="S5.T4.1.1.1.1.1.m1.1.1.3.cmml">𝟔𝟒</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.1.1.m1.1b"><apply id="S5.T4.1.1.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.1.1.m1.1.1"><eq id="S5.T4.1.1.1.1.1.m1.1.1.1.cmml" xref="S5.T4.1.1.1.1.1.m1.1.1.1"></eq><ci id="S5.T4.1.1.1.1.1.m1.1.1.2.cmml" xref="S5.T4.1.1.1.1.1.m1.1.1.2">𝐍</ci><cn type="integer" id="S5.T4.1.1.1.1.1.m1.1.1.3.cmml" xref="S5.T4.1.1.1.1.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.1.1.m1.1c">\mathbf{N=64}</annotation></semantics></math></th>
<th id="S5.T4.2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><math id="S5.T4.2.2.2.2.2.m1.1" class="ltx_Math" alttext="\mathbf{N=128}" display="inline"><semantics id="S5.T4.2.2.2.2.2.m1.1a"><mrow id="S5.T4.2.2.2.2.2.m1.1.1" xref="S5.T4.2.2.2.2.2.m1.1.1.cmml"><mi id="S5.T4.2.2.2.2.2.m1.1.1.2" xref="S5.T4.2.2.2.2.2.m1.1.1.2.cmml">𝐍</mi><mo id="S5.T4.2.2.2.2.2.m1.1.1.1" xref="S5.T4.2.2.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S5.T4.2.2.2.2.2.m1.1.1.3" xref="S5.T4.2.2.2.2.2.m1.1.1.3.cmml">𝟏𝟐𝟖</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.2.2.2.2.2.m1.1b"><apply id="S5.T4.2.2.2.2.2.m1.1.1.cmml" xref="S5.T4.2.2.2.2.2.m1.1.1"><eq id="S5.T4.2.2.2.2.2.m1.1.1.1.cmml" xref="S5.T4.2.2.2.2.2.m1.1.1.1"></eq><ci id="S5.T4.2.2.2.2.2.m1.1.1.2.cmml" xref="S5.T4.2.2.2.2.2.m1.1.1.2">𝐍</ci><cn type="integer" id="S5.T4.2.2.2.2.2.m1.1.1.3.cmml" xref="S5.T4.2.2.2.2.2.m1.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.2.2.2.2.m1.1c">\mathbf{N=128}</annotation></semantics></math></th>
</tr>
<tr id="S5.T4.6.6.6.6" class="ltx_tr">
<th id="S5.T4.3.3.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_column"><math id="S5.T4.3.3.3.3.1.m1.1" class="ltx_Math" alttext="r=6.25\%" display="inline"><semantics id="S5.T4.3.3.3.3.1.m1.1a"><mrow id="S5.T4.3.3.3.3.1.m1.1.1" xref="S5.T4.3.3.3.3.1.m1.1.1.cmml"><mi id="S5.T4.3.3.3.3.1.m1.1.1.2" xref="S5.T4.3.3.3.3.1.m1.1.1.2.cmml">r</mi><mo id="S5.T4.3.3.3.3.1.m1.1.1.1" xref="S5.T4.3.3.3.3.1.m1.1.1.1.cmml">=</mo><mrow id="S5.T4.3.3.3.3.1.m1.1.1.3" xref="S5.T4.3.3.3.3.1.m1.1.1.3.cmml"><mn id="S5.T4.3.3.3.3.1.m1.1.1.3.2" xref="S5.T4.3.3.3.3.1.m1.1.1.3.2.cmml">6.25</mn><mo id="S5.T4.3.3.3.3.1.m1.1.1.3.1" xref="S5.T4.3.3.3.3.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.3.3.3.3.1.m1.1b"><apply id="S5.T4.3.3.3.3.1.m1.1.1.cmml" xref="S5.T4.3.3.3.3.1.m1.1.1"><eq id="S5.T4.3.3.3.3.1.m1.1.1.1.cmml" xref="S5.T4.3.3.3.3.1.m1.1.1.1"></eq><ci id="S5.T4.3.3.3.3.1.m1.1.1.2.cmml" xref="S5.T4.3.3.3.3.1.m1.1.1.2">𝑟</ci><apply id="S5.T4.3.3.3.3.1.m1.1.1.3.cmml" xref="S5.T4.3.3.3.3.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.3.3.3.3.1.m1.1.1.3.1.cmml" xref="S5.T4.3.3.3.3.1.m1.1.1.3.1">percent</csymbol><cn type="float" id="S5.T4.3.3.3.3.1.m1.1.1.3.2.cmml" xref="S5.T4.3.3.3.3.1.m1.1.1.3.2">6.25</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.3.3.3.1.m1.1c">r=6.25\%</annotation></semantics></math></th>
<th id="S5.T4.4.4.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><math id="S5.T4.4.4.4.4.2.m1.1" class="ltx_Math" alttext="r=12.5\%" display="inline"><semantics id="S5.T4.4.4.4.4.2.m1.1a"><mrow id="S5.T4.4.4.4.4.2.m1.1.1" xref="S5.T4.4.4.4.4.2.m1.1.1.cmml"><mi id="S5.T4.4.4.4.4.2.m1.1.1.2" xref="S5.T4.4.4.4.4.2.m1.1.1.2.cmml">r</mi><mo id="S5.T4.4.4.4.4.2.m1.1.1.1" xref="S5.T4.4.4.4.4.2.m1.1.1.1.cmml">=</mo><mrow id="S5.T4.4.4.4.4.2.m1.1.1.3" xref="S5.T4.4.4.4.4.2.m1.1.1.3.cmml"><mn id="S5.T4.4.4.4.4.2.m1.1.1.3.2" xref="S5.T4.4.4.4.4.2.m1.1.1.3.2.cmml">12.5</mn><mo id="S5.T4.4.4.4.4.2.m1.1.1.3.1" xref="S5.T4.4.4.4.4.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.4.4.4.4.2.m1.1b"><apply id="S5.T4.4.4.4.4.2.m1.1.1.cmml" xref="S5.T4.4.4.4.4.2.m1.1.1"><eq id="S5.T4.4.4.4.4.2.m1.1.1.1.cmml" xref="S5.T4.4.4.4.4.2.m1.1.1.1"></eq><ci id="S5.T4.4.4.4.4.2.m1.1.1.2.cmml" xref="S5.T4.4.4.4.4.2.m1.1.1.2">𝑟</ci><apply id="S5.T4.4.4.4.4.2.m1.1.1.3.cmml" xref="S5.T4.4.4.4.4.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.4.4.4.4.2.m1.1.1.3.1.cmml" xref="S5.T4.4.4.4.4.2.m1.1.1.3.1">percent</csymbol><cn type="float" id="S5.T4.4.4.4.4.2.m1.1.1.3.2.cmml" xref="S5.T4.4.4.4.4.2.m1.1.1.3.2">12.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.4.4.4.4.2.m1.1c">r=12.5\%</annotation></semantics></math></th>
<th id="S5.T4.5.5.5.5.3" class="ltx_td ltx_align_center ltx_th ltx_th_column"><math id="S5.T4.5.5.5.5.3.m1.1" class="ltx_Math" alttext="r=6.25\%" display="inline"><semantics id="S5.T4.5.5.5.5.3.m1.1a"><mrow id="S5.T4.5.5.5.5.3.m1.1.1" xref="S5.T4.5.5.5.5.3.m1.1.1.cmml"><mi id="S5.T4.5.5.5.5.3.m1.1.1.2" xref="S5.T4.5.5.5.5.3.m1.1.1.2.cmml">r</mi><mo id="S5.T4.5.5.5.5.3.m1.1.1.1" xref="S5.T4.5.5.5.5.3.m1.1.1.1.cmml">=</mo><mrow id="S5.T4.5.5.5.5.3.m1.1.1.3" xref="S5.T4.5.5.5.5.3.m1.1.1.3.cmml"><mn id="S5.T4.5.5.5.5.3.m1.1.1.3.2" xref="S5.T4.5.5.5.5.3.m1.1.1.3.2.cmml">6.25</mn><mo id="S5.T4.5.5.5.5.3.m1.1.1.3.1" xref="S5.T4.5.5.5.5.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.5.5.5.5.3.m1.1b"><apply id="S5.T4.5.5.5.5.3.m1.1.1.cmml" xref="S5.T4.5.5.5.5.3.m1.1.1"><eq id="S5.T4.5.5.5.5.3.m1.1.1.1.cmml" xref="S5.T4.5.5.5.5.3.m1.1.1.1"></eq><ci id="S5.T4.5.5.5.5.3.m1.1.1.2.cmml" xref="S5.T4.5.5.5.5.3.m1.1.1.2">𝑟</ci><apply id="S5.T4.5.5.5.5.3.m1.1.1.3.cmml" xref="S5.T4.5.5.5.5.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.5.5.5.5.3.m1.1.1.3.1.cmml" xref="S5.T4.5.5.5.5.3.m1.1.1.3.1">percent</csymbol><cn type="float" id="S5.T4.5.5.5.5.3.m1.1.1.3.2.cmml" xref="S5.T4.5.5.5.5.3.m1.1.1.3.2">6.25</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.5.5.5.5.3.m1.1c">r=6.25\%</annotation></semantics></math></th>
<th id="S5.T4.6.6.6.6.4" class="ltx_td ltx_align_center ltx_th ltx_th_column"><math id="S5.T4.6.6.6.6.4.m1.1" class="ltx_Math" alttext="r=12.5\%" display="inline"><semantics id="S5.T4.6.6.6.6.4.m1.1a"><mrow id="S5.T4.6.6.6.6.4.m1.1.1" xref="S5.T4.6.6.6.6.4.m1.1.1.cmml"><mi id="S5.T4.6.6.6.6.4.m1.1.1.2" xref="S5.T4.6.6.6.6.4.m1.1.1.2.cmml">r</mi><mo id="S5.T4.6.6.6.6.4.m1.1.1.1" xref="S5.T4.6.6.6.6.4.m1.1.1.1.cmml">=</mo><mrow id="S5.T4.6.6.6.6.4.m1.1.1.3" xref="S5.T4.6.6.6.6.4.m1.1.1.3.cmml"><mn id="S5.T4.6.6.6.6.4.m1.1.1.3.2" xref="S5.T4.6.6.6.6.4.m1.1.1.3.2.cmml">12.5</mn><mo id="S5.T4.6.6.6.6.4.m1.1.1.3.1" xref="S5.T4.6.6.6.6.4.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.6.6.6.6.4.m1.1b"><apply id="S5.T4.6.6.6.6.4.m1.1.1.cmml" xref="S5.T4.6.6.6.6.4.m1.1.1"><eq id="S5.T4.6.6.6.6.4.m1.1.1.1.cmml" xref="S5.T4.6.6.6.6.4.m1.1.1.1"></eq><ci id="S5.T4.6.6.6.6.4.m1.1.1.2.cmml" xref="S5.T4.6.6.6.6.4.m1.1.1.2">𝑟</ci><apply id="S5.T4.6.6.6.6.4.m1.1.1.3.cmml" xref="S5.T4.6.6.6.6.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.6.6.6.6.4.m1.1.1.3.1.cmml" xref="S5.T4.6.6.6.6.4.m1.1.1.3.1">percent</csymbol><cn type="float" id="S5.T4.6.6.6.6.4.m1.1.1.3.2.cmml" xref="S5.T4.6.6.6.6.4.m1.1.1.3.2">12.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.6.6.6.6.4.m1.1c">r=12.5\%</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.10.10.10.10" class="ltx_tr">
<th id="S5.T4.10.10.10.10.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">FedAvg</th>
<td id="S5.T4.7.7.7.7.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T4.7.7.7.7.1.m1.1" class="ltx_Math" alttext="19.76_{\pm 9.35}" display="inline"><semantics id="S5.T4.7.7.7.7.1.m1.1a"><msub id="S5.T4.7.7.7.7.1.m1.1.1" xref="S5.T4.7.7.7.7.1.m1.1.1.cmml"><mn id="S5.T4.7.7.7.7.1.m1.1.1.2" xref="S5.T4.7.7.7.7.1.m1.1.1.2.cmml">19.76</mn><mrow id="S5.T4.7.7.7.7.1.m1.1.1.3" xref="S5.T4.7.7.7.7.1.m1.1.1.3.cmml"><mo id="S5.T4.7.7.7.7.1.m1.1.1.3a" xref="S5.T4.7.7.7.7.1.m1.1.1.3.cmml">±</mo><mn id="S5.T4.7.7.7.7.1.m1.1.1.3.2" xref="S5.T4.7.7.7.7.1.m1.1.1.3.2.cmml">9.35</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.7.7.7.7.1.m1.1b"><apply id="S5.T4.7.7.7.7.1.m1.1.1.cmml" xref="S5.T4.7.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.7.7.7.7.1.m1.1.1.1.cmml" xref="S5.T4.7.7.7.7.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.7.7.7.7.1.m1.1.1.2.cmml" xref="S5.T4.7.7.7.7.1.m1.1.1.2">19.76</cn><apply id="S5.T4.7.7.7.7.1.m1.1.1.3.cmml" xref="S5.T4.7.7.7.7.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.7.7.7.7.1.m1.1.1.3.1.cmml" xref="S5.T4.7.7.7.7.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.7.7.7.7.1.m1.1.1.3.2.cmml" xref="S5.T4.7.7.7.7.1.m1.1.1.3.2">9.35</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.7.7.7.7.1.m1.1c">19.76_{\pm 9.35}</annotation></semantics></math></td>
<td id="S5.T4.8.8.8.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S5.T4.8.8.8.8.2.m1.1" class="ltx_Math" alttext="23.29_{\pm 11.31}" display="inline"><semantics id="S5.T4.8.8.8.8.2.m1.1a"><msub id="S5.T4.8.8.8.8.2.m1.1.1" xref="S5.T4.8.8.8.8.2.m1.1.1.cmml"><mn id="S5.T4.8.8.8.8.2.m1.1.1.2" xref="S5.T4.8.8.8.8.2.m1.1.1.2.cmml">23.29</mn><mrow id="S5.T4.8.8.8.8.2.m1.1.1.3" xref="S5.T4.8.8.8.8.2.m1.1.1.3.cmml"><mo id="S5.T4.8.8.8.8.2.m1.1.1.3a" xref="S5.T4.8.8.8.8.2.m1.1.1.3.cmml">±</mo><mn id="S5.T4.8.8.8.8.2.m1.1.1.3.2" xref="S5.T4.8.8.8.8.2.m1.1.1.3.2.cmml">11.31</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.8.8.8.8.2.m1.1b"><apply id="S5.T4.8.8.8.8.2.m1.1.1.cmml" xref="S5.T4.8.8.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.8.8.8.8.2.m1.1.1.1.cmml" xref="S5.T4.8.8.8.8.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.8.8.8.8.2.m1.1.1.2.cmml" xref="S5.T4.8.8.8.8.2.m1.1.1.2">23.29</cn><apply id="S5.T4.8.8.8.8.2.m1.1.1.3.cmml" xref="S5.T4.8.8.8.8.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.8.8.8.8.2.m1.1.1.3.1.cmml" xref="S5.T4.8.8.8.8.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.8.8.8.8.2.m1.1.1.3.2.cmml" xref="S5.T4.8.8.8.8.2.m1.1.1.3.2">11.31</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.8.8.8.8.2.m1.1c">23.29_{\pm 11.31}</annotation></semantics></math></td>
<td id="S5.T4.9.9.9.9.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T4.9.9.9.9.3.m1.1" class="ltx_Math" alttext="19.64_{\pm 10.01}" display="inline"><semantics id="S5.T4.9.9.9.9.3.m1.1a"><msub id="S5.T4.9.9.9.9.3.m1.1.1" xref="S5.T4.9.9.9.9.3.m1.1.1.cmml"><mn id="S5.T4.9.9.9.9.3.m1.1.1.2" xref="S5.T4.9.9.9.9.3.m1.1.1.2.cmml">19.64</mn><mrow id="S5.T4.9.9.9.9.3.m1.1.1.3" xref="S5.T4.9.9.9.9.3.m1.1.1.3.cmml"><mo id="S5.T4.9.9.9.9.3.m1.1.1.3a" xref="S5.T4.9.9.9.9.3.m1.1.1.3.cmml">±</mo><mn id="S5.T4.9.9.9.9.3.m1.1.1.3.2" xref="S5.T4.9.9.9.9.3.m1.1.1.3.2.cmml">10.01</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.9.9.9.9.3.m1.1b"><apply id="S5.T4.9.9.9.9.3.m1.1.1.cmml" xref="S5.T4.9.9.9.9.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.9.9.9.9.3.m1.1.1.1.cmml" xref="S5.T4.9.9.9.9.3.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.9.9.9.9.3.m1.1.1.2.cmml" xref="S5.T4.9.9.9.9.3.m1.1.1.2">19.64</cn><apply id="S5.T4.9.9.9.9.3.m1.1.1.3.cmml" xref="S5.T4.9.9.9.9.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.9.9.9.9.3.m1.1.1.3.1.cmml" xref="S5.T4.9.9.9.9.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.9.9.9.9.3.m1.1.1.3.2.cmml" xref="S5.T4.9.9.9.9.3.m1.1.1.3.2">10.01</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.9.9.9.9.3.m1.1c">19.64_{\pm 10.01}</annotation></semantics></math></td>
<td id="S5.T4.10.10.10.10.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T4.10.10.10.10.4.m1.1" class="ltx_Math" alttext="23.29_{\pm 11.81}" display="inline"><semantics id="S5.T4.10.10.10.10.4.m1.1a"><msub id="S5.T4.10.10.10.10.4.m1.1.1" xref="S5.T4.10.10.10.10.4.m1.1.1.cmml"><mn id="S5.T4.10.10.10.10.4.m1.1.1.2" xref="S5.T4.10.10.10.10.4.m1.1.1.2.cmml">23.29</mn><mrow id="S5.T4.10.10.10.10.4.m1.1.1.3" xref="S5.T4.10.10.10.10.4.m1.1.1.3.cmml"><mo id="S5.T4.10.10.10.10.4.m1.1.1.3a" xref="S5.T4.10.10.10.10.4.m1.1.1.3.cmml">±</mo><mn id="S5.T4.10.10.10.10.4.m1.1.1.3.2" xref="S5.T4.10.10.10.10.4.m1.1.1.3.2.cmml">11.81</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.10.10.10.10.4.m1.1b"><apply id="S5.T4.10.10.10.10.4.m1.1.1.cmml" xref="S5.T4.10.10.10.10.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.10.10.10.10.4.m1.1.1.1.cmml" xref="S5.T4.10.10.10.10.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.10.10.10.10.4.m1.1.1.2.cmml" xref="S5.T4.10.10.10.10.4.m1.1.1.2">23.29</cn><apply id="S5.T4.10.10.10.10.4.m1.1.1.3.cmml" xref="S5.T4.10.10.10.10.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.10.10.10.10.4.m1.1.1.3.1.cmml" xref="S5.T4.10.10.10.10.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.10.10.10.10.4.m1.1.1.3.2.cmml" xref="S5.T4.10.10.10.10.4.m1.1.1.3.2">11.81</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.10.10.10.10.4.m1.1c">23.29_{\pm 11.81}</annotation></semantics></math></td>
</tr>
<tr id="S5.T4.14.14.14.14" class="ltx_tr">
<th id="S5.T4.14.14.14.14.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Local</th>
<td id="S5.T4.11.11.11.11.1" class="ltx_td ltx_align_center"><math id="S5.T4.11.11.11.11.1.m1.1" class="ltx_Math" alttext="32.35_{\pm 11.64}" display="inline"><semantics id="S5.T4.11.11.11.11.1.m1.1a"><msub id="S5.T4.11.11.11.11.1.m1.1.1" xref="S5.T4.11.11.11.11.1.m1.1.1.cmml"><mn id="S5.T4.11.11.11.11.1.m1.1.1.2" xref="S5.T4.11.11.11.11.1.m1.1.1.2.cmml">32.35</mn><mrow id="S5.T4.11.11.11.11.1.m1.1.1.3" xref="S5.T4.11.11.11.11.1.m1.1.1.3.cmml"><mo id="S5.T4.11.11.11.11.1.m1.1.1.3a" xref="S5.T4.11.11.11.11.1.m1.1.1.3.cmml">±</mo><mn id="S5.T4.11.11.11.11.1.m1.1.1.3.2" xref="S5.T4.11.11.11.11.1.m1.1.1.3.2.cmml">11.64</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.11.11.11.11.1.m1.1b"><apply id="S5.T4.11.11.11.11.1.m1.1.1.cmml" xref="S5.T4.11.11.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.11.11.11.11.1.m1.1.1.1.cmml" xref="S5.T4.11.11.11.11.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.11.11.11.11.1.m1.1.1.2.cmml" xref="S5.T4.11.11.11.11.1.m1.1.1.2">32.35</cn><apply id="S5.T4.11.11.11.11.1.m1.1.1.3.cmml" xref="S5.T4.11.11.11.11.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.11.11.11.11.1.m1.1.1.3.1.cmml" xref="S5.T4.11.11.11.11.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.11.11.11.11.1.m1.1.1.3.2.cmml" xref="S5.T4.11.11.11.11.1.m1.1.1.3.2">11.64</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.11.11.11.11.1.m1.1c">32.35_{\pm 11.64}</annotation></semantics></math></td>
<td id="S5.T4.12.12.12.12.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S5.T4.12.12.12.12.2.m1.1" class="ltx_Math" alttext="34.74_{\pm 9.36}" display="inline"><semantics id="S5.T4.12.12.12.12.2.m1.1a"><msub id="S5.T4.12.12.12.12.2.m1.1.1" xref="S5.T4.12.12.12.12.2.m1.1.1.cmml"><mn id="S5.T4.12.12.12.12.2.m1.1.1.2" xref="S5.T4.12.12.12.12.2.m1.1.1.2.cmml">34.74</mn><mrow id="S5.T4.12.12.12.12.2.m1.1.1.3" xref="S5.T4.12.12.12.12.2.m1.1.1.3.cmml"><mo id="S5.T4.12.12.12.12.2.m1.1.1.3a" xref="S5.T4.12.12.12.12.2.m1.1.1.3.cmml">±</mo><mn id="S5.T4.12.12.12.12.2.m1.1.1.3.2" xref="S5.T4.12.12.12.12.2.m1.1.1.3.2.cmml">9.36</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.12.12.12.12.2.m1.1b"><apply id="S5.T4.12.12.12.12.2.m1.1.1.cmml" xref="S5.T4.12.12.12.12.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.12.12.12.12.2.m1.1.1.1.cmml" xref="S5.T4.12.12.12.12.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.12.12.12.12.2.m1.1.1.2.cmml" xref="S5.T4.12.12.12.12.2.m1.1.1.2">34.74</cn><apply id="S5.T4.12.12.12.12.2.m1.1.1.3.cmml" xref="S5.T4.12.12.12.12.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.12.12.12.12.2.m1.1.1.3.1.cmml" xref="S5.T4.12.12.12.12.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.12.12.12.12.2.m1.1.1.3.2.cmml" xref="S5.T4.12.12.12.12.2.m1.1.1.3.2">9.36</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.12.12.12.12.2.m1.1c">34.74_{\pm 9.36}</annotation></semantics></math></td>
<td id="S5.T4.13.13.13.13.3" class="ltx_td ltx_align_center"><math id="S5.T4.13.13.13.13.3.m1.1" class="ltx_Math" alttext="31.79_{\pm 12.00}" display="inline"><semantics id="S5.T4.13.13.13.13.3.m1.1a"><msub id="S5.T4.13.13.13.13.3.m1.1.1" xref="S5.T4.13.13.13.13.3.m1.1.1.cmml"><mn id="S5.T4.13.13.13.13.3.m1.1.1.2" xref="S5.T4.13.13.13.13.3.m1.1.1.2.cmml">31.79</mn><mrow id="S5.T4.13.13.13.13.3.m1.1.1.3" xref="S5.T4.13.13.13.13.3.m1.1.1.3.cmml"><mo id="S5.T4.13.13.13.13.3.m1.1.1.3a" xref="S5.T4.13.13.13.13.3.m1.1.1.3.cmml">±</mo><mn id="S5.T4.13.13.13.13.3.m1.1.1.3.2" xref="S5.T4.13.13.13.13.3.m1.1.1.3.2.cmml">12.00</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.13.13.13.13.3.m1.1b"><apply id="S5.T4.13.13.13.13.3.m1.1.1.cmml" xref="S5.T4.13.13.13.13.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.13.13.13.13.3.m1.1.1.1.cmml" xref="S5.T4.13.13.13.13.3.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.13.13.13.13.3.m1.1.1.2.cmml" xref="S5.T4.13.13.13.13.3.m1.1.1.2">31.79</cn><apply id="S5.T4.13.13.13.13.3.m1.1.1.3.cmml" xref="S5.T4.13.13.13.13.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.13.13.13.13.3.m1.1.1.3.1.cmml" xref="S5.T4.13.13.13.13.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.13.13.13.13.3.m1.1.1.3.2.cmml" xref="S5.T4.13.13.13.13.3.m1.1.1.3.2">12.00</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.13.13.13.13.3.m1.1c">31.79_{\pm 12.00}</annotation></semantics></math></td>
<td id="S5.T4.14.14.14.14.4" class="ltx_td ltx_align_center"><math id="S5.T4.14.14.14.14.4.m1.1" class="ltx_Math" alttext="36.03_{\pm 9.57}" display="inline"><semantics id="S5.T4.14.14.14.14.4.m1.1a"><msub id="S5.T4.14.14.14.14.4.m1.1.1" xref="S5.T4.14.14.14.14.4.m1.1.1.cmml"><mn id="S5.T4.14.14.14.14.4.m1.1.1.2" xref="S5.T4.14.14.14.14.4.m1.1.1.2.cmml">36.03</mn><mrow id="S5.T4.14.14.14.14.4.m1.1.1.3" xref="S5.T4.14.14.14.14.4.m1.1.1.3.cmml"><mo id="S5.T4.14.14.14.14.4.m1.1.1.3a" xref="S5.T4.14.14.14.14.4.m1.1.1.3.cmml">±</mo><mn id="S5.T4.14.14.14.14.4.m1.1.1.3.2" xref="S5.T4.14.14.14.14.4.m1.1.1.3.2.cmml">9.57</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.14.14.14.14.4.m1.1b"><apply id="S5.T4.14.14.14.14.4.m1.1.1.cmml" xref="S5.T4.14.14.14.14.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.14.14.14.14.4.m1.1.1.1.cmml" xref="S5.T4.14.14.14.14.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.14.14.14.14.4.m1.1.1.2.cmml" xref="S5.T4.14.14.14.14.4.m1.1.1.2">36.03</cn><apply id="S5.T4.14.14.14.14.4.m1.1.1.3.cmml" xref="S5.T4.14.14.14.14.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.14.14.14.14.4.m1.1.1.3.1.cmml" xref="S5.T4.14.14.14.14.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.14.14.14.14.4.m1.1.1.3.2.cmml" xref="S5.T4.14.14.14.14.4.m1.1.1.3.2">9.57</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.14.14.14.14.4.m1.1c">36.03_{\pm 9.57}</annotation></semantics></math></td>
</tr>
<tr id="S5.T4.18.18.18.18" class="ltx_tr">
<th id="S5.T4.18.18.18.18.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"> APFL</th>
<td id="S5.T4.15.15.15.15.1" class="ltx_td ltx_align_center"><math id="S5.T4.15.15.15.15.1.m1.1" class="ltx_Math" alttext="42.55_{\pm 13.51}" display="inline"><semantics id="S5.T4.15.15.15.15.1.m1.1a"><msub id="S5.T4.15.15.15.15.1.m1.1.1" xref="S5.T4.15.15.15.15.1.m1.1.1.cmml"><mn id="S5.T4.15.15.15.15.1.m1.1.1.2" xref="S5.T4.15.15.15.15.1.m1.1.1.2.cmml">42.55</mn><mrow id="S5.T4.15.15.15.15.1.m1.1.1.3" xref="S5.T4.15.15.15.15.1.m1.1.1.3.cmml"><mo id="S5.T4.15.15.15.15.1.m1.1.1.3a" xref="S5.T4.15.15.15.15.1.m1.1.1.3.cmml">±</mo><mn id="S5.T4.15.15.15.15.1.m1.1.1.3.2" xref="S5.T4.15.15.15.15.1.m1.1.1.3.2.cmml">13.51</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.15.15.15.15.1.m1.1b"><apply id="S5.T4.15.15.15.15.1.m1.1.1.cmml" xref="S5.T4.15.15.15.15.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.15.15.15.15.1.m1.1.1.1.cmml" xref="S5.T4.15.15.15.15.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.15.15.15.15.1.m1.1.1.2.cmml" xref="S5.T4.15.15.15.15.1.m1.1.1.2">42.55</cn><apply id="S5.T4.15.15.15.15.1.m1.1.1.3.cmml" xref="S5.T4.15.15.15.15.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.15.15.15.15.1.m1.1.1.3.1.cmml" xref="S5.T4.15.15.15.15.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.15.15.15.15.1.m1.1.1.3.2.cmml" xref="S5.T4.15.15.15.15.1.m1.1.1.3.2">13.51</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.15.15.15.15.1.m1.1c">42.55_{\pm 13.51}</annotation></semantics></math></td>
<td id="S5.T4.16.16.16.16.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S5.T4.16.16.16.16.2.m1.1" class="ltx_Math" alttext="44.88_{\pm 10.50}" display="inline"><semantics id="S5.T4.16.16.16.16.2.m1.1a"><msub id="S5.T4.16.16.16.16.2.m1.1.1" xref="S5.T4.16.16.16.16.2.m1.1.1.cmml"><mn id="S5.T4.16.16.16.16.2.m1.1.1.2" xref="S5.T4.16.16.16.16.2.m1.1.1.2.cmml">44.88</mn><mrow id="S5.T4.16.16.16.16.2.m1.1.1.3" xref="S5.T4.16.16.16.16.2.m1.1.1.3.cmml"><mo id="S5.T4.16.16.16.16.2.m1.1.1.3a" xref="S5.T4.16.16.16.16.2.m1.1.1.3.cmml">±</mo><mn id="S5.T4.16.16.16.16.2.m1.1.1.3.2" xref="S5.T4.16.16.16.16.2.m1.1.1.3.2.cmml">10.50</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.16.16.16.16.2.m1.1b"><apply id="S5.T4.16.16.16.16.2.m1.1.1.cmml" xref="S5.T4.16.16.16.16.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.16.16.16.16.2.m1.1.1.1.cmml" xref="S5.T4.16.16.16.16.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.16.16.16.16.2.m1.1.1.2.cmml" xref="S5.T4.16.16.16.16.2.m1.1.1.2">44.88</cn><apply id="S5.T4.16.16.16.16.2.m1.1.1.3.cmml" xref="S5.T4.16.16.16.16.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.16.16.16.16.2.m1.1.1.3.1.cmml" xref="S5.T4.16.16.16.16.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.16.16.16.16.2.m1.1.1.3.2.cmml" xref="S5.T4.16.16.16.16.2.m1.1.1.3.2">10.50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.16.16.16.16.2.m1.1c">44.88_{\pm 10.50}</annotation></semantics></math></td>
<td id="S5.T4.17.17.17.17.3" class="ltx_td ltx_align_center"><math id="S5.T4.17.17.17.17.3.m1.1" class="ltx_Math" alttext="41.64_{\pm 12.77}" display="inline"><semantics id="S5.T4.17.17.17.17.3.m1.1a"><msub id="S5.T4.17.17.17.17.3.m1.1.1" xref="S5.T4.17.17.17.17.3.m1.1.1.cmml"><mn id="S5.T4.17.17.17.17.3.m1.1.1.2" xref="S5.T4.17.17.17.17.3.m1.1.1.2.cmml">41.64</mn><mrow id="S5.T4.17.17.17.17.3.m1.1.1.3" xref="S5.T4.17.17.17.17.3.m1.1.1.3.cmml"><mo id="S5.T4.17.17.17.17.3.m1.1.1.3a" xref="S5.T4.17.17.17.17.3.m1.1.1.3.cmml">±</mo><mn id="S5.T4.17.17.17.17.3.m1.1.1.3.2" xref="S5.T4.17.17.17.17.3.m1.1.1.3.2.cmml">12.77</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.17.17.17.17.3.m1.1b"><apply id="S5.T4.17.17.17.17.3.m1.1.1.cmml" xref="S5.T4.17.17.17.17.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.17.17.17.17.3.m1.1.1.1.cmml" xref="S5.T4.17.17.17.17.3.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.17.17.17.17.3.m1.1.1.2.cmml" xref="S5.T4.17.17.17.17.3.m1.1.1.2">41.64</cn><apply id="S5.T4.17.17.17.17.3.m1.1.1.3.cmml" xref="S5.T4.17.17.17.17.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.17.17.17.17.3.m1.1.1.3.1.cmml" xref="S5.T4.17.17.17.17.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.17.17.17.17.3.m1.1.1.3.2.cmml" xref="S5.T4.17.17.17.17.3.m1.1.1.3.2">12.77</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.17.17.17.17.3.m1.1c">41.64_{\pm 12.77}</annotation></semantics></math></td>
<td id="S5.T4.18.18.18.18.4" class="ltx_td ltx_align_center"><math id="S5.T4.18.18.18.18.4.m1.1" class="ltx_Math" alttext="43.92_{\pm 9.40}" display="inline"><semantics id="S5.T4.18.18.18.18.4.m1.1a"><msub id="S5.T4.18.18.18.18.4.m1.1.1" xref="S5.T4.18.18.18.18.4.m1.1.1.cmml"><mn id="S5.T4.18.18.18.18.4.m1.1.1.2" xref="S5.T4.18.18.18.18.4.m1.1.1.2.cmml">43.92</mn><mrow id="S5.T4.18.18.18.18.4.m1.1.1.3" xref="S5.T4.18.18.18.18.4.m1.1.1.3.cmml"><mo id="S5.T4.18.18.18.18.4.m1.1.1.3a" xref="S5.T4.18.18.18.18.4.m1.1.1.3.cmml">±</mo><mn id="S5.T4.18.18.18.18.4.m1.1.1.3.2" xref="S5.T4.18.18.18.18.4.m1.1.1.3.2.cmml">9.40</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.18.18.18.18.4.m1.1b"><apply id="S5.T4.18.18.18.18.4.m1.1.1.cmml" xref="S5.T4.18.18.18.18.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.18.18.18.18.4.m1.1.1.1.cmml" xref="S5.T4.18.18.18.18.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.18.18.18.18.4.m1.1.1.2.cmml" xref="S5.T4.18.18.18.18.4.m1.1.1.2">43.92</cn><apply id="S5.T4.18.18.18.18.4.m1.1.1.3.cmml" xref="S5.T4.18.18.18.18.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.18.18.18.18.4.m1.1.1.3.1.cmml" xref="S5.T4.18.18.18.18.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.18.18.18.18.4.m1.1.1.3.2.cmml" xref="S5.T4.18.18.18.18.4.m1.1.1.3.2">9.40</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.18.18.18.18.4.m1.1c">43.92_{\pm 9.40}</annotation></semantics></math></td>
</tr>
<tr id="S5.T4.22.22.22.22" class="ltx_tr">
<th id="S5.T4.22.22.22.22.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedRep</th>
<td id="S5.T4.19.19.19.19.1" class="ltx_td ltx_align_center"><math id="S5.T4.19.19.19.19.1.m1.1" class="ltx_Math" alttext="35.72_{\pm 10.33}" display="inline"><semantics id="S5.T4.19.19.19.19.1.m1.1a"><msub id="S5.T4.19.19.19.19.1.m1.1.1" xref="S5.T4.19.19.19.19.1.m1.1.1.cmml"><mn id="S5.T4.19.19.19.19.1.m1.1.1.2" xref="S5.T4.19.19.19.19.1.m1.1.1.2.cmml">35.72</mn><mrow id="S5.T4.19.19.19.19.1.m1.1.1.3" xref="S5.T4.19.19.19.19.1.m1.1.1.3.cmml"><mo id="S5.T4.19.19.19.19.1.m1.1.1.3a" xref="S5.T4.19.19.19.19.1.m1.1.1.3.cmml">±</mo><mn id="S5.T4.19.19.19.19.1.m1.1.1.3.2" xref="S5.T4.19.19.19.19.1.m1.1.1.3.2.cmml">10.33</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.19.19.19.19.1.m1.1b"><apply id="S5.T4.19.19.19.19.1.m1.1.1.cmml" xref="S5.T4.19.19.19.19.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.19.19.19.19.1.m1.1.1.1.cmml" xref="S5.T4.19.19.19.19.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.19.19.19.19.1.m1.1.1.2.cmml" xref="S5.T4.19.19.19.19.1.m1.1.1.2">35.72</cn><apply id="S5.T4.19.19.19.19.1.m1.1.1.3.cmml" xref="S5.T4.19.19.19.19.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.19.19.19.19.1.m1.1.1.3.1.cmml" xref="S5.T4.19.19.19.19.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.19.19.19.19.1.m1.1.1.3.2.cmml" xref="S5.T4.19.19.19.19.1.m1.1.1.3.2">10.33</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.19.19.19.19.1.m1.1c">35.72_{\pm 10.33}</annotation></semantics></math></td>
<td id="S5.T4.20.20.20.20.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S5.T4.20.20.20.20.2.m1.1" class="ltx_Math" alttext="44.42_{\pm 7.80}" display="inline"><semantics id="S5.T4.20.20.20.20.2.m1.1a"><msub id="S5.T4.20.20.20.20.2.m1.1.1" xref="S5.T4.20.20.20.20.2.m1.1.1.cmml"><mn id="S5.T4.20.20.20.20.2.m1.1.1.2" xref="S5.T4.20.20.20.20.2.m1.1.1.2.cmml">44.42</mn><mrow id="S5.T4.20.20.20.20.2.m1.1.1.3" xref="S5.T4.20.20.20.20.2.m1.1.1.3.cmml"><mo id="S5.T4.20.20.20.20.2.m1.1.1.3a" xref="S5.T4.20.20.20.20.2.m1.1.1.3.cmml">±</mo><mn id="S5.T4.20.20.20.20.2.m1.1.1.3.2" xref="S5.T4.20.20.20.20.2.m1.1.1.3.2.cmml">7.80</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.20.20.20.20.2.m1.1b"><apply id="S5.T4.20.20.20.20.2.m1.1.1.cmml" xref="S5.T4.20.20.20.20.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.20.20.20.20.2.m1.1.1.1.cmml" xref="S5.T4.20.20.20.20.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.20.20.20.20.2.m1.1.1.2.cmml" xref="S5.T4.20.20.20.20.2.m1.1.1.2">44.42</cn><apply id="S5.T4.20.20.20.20.2.m1.1.1.3.cmml" xref="S5.T4.20.20.20.20.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.20.20.20.20.2.m1.1.1.3.1.cmml" xref="S5.T4.20.20.20.20.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.20.20.20.20.2.m1.1.1.3.2.cmml" xref="S5.T4.20.20.20.20.2.m1.1.1.3.2">7.80</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.20.20.20.20.2.m1.1c">44.42_{\pm 7.80}</annotation></semantics></math></td>
<td id="S5.T4.21.21.21.21.3" class="ltx_td ltx_align_center"><math id="S5.T4.21.21.21.21.3.m1.1" class="ltx_Math" alttext="35.88_{\pm 9.59}" display="inline"><semantics id="S5.T4.21.21.21.21.3.m1.1a"><msub id="S5.T4.21.21.21.21.3.m1.1.1" xref="S5.T4.21.21.21.21.3.m1.1.1.cmml"><mn id="S5.T4.21.21.21.21.3.m1.1.1.2" xref="S5.T4.21.21.21.21.3.m1.1.1.2.cmml">35.88</mn><mrow id="S5.T4.21.21.21.21.3.m1.1.1.3" xref="S5.T4.21.21.21.21.3.m1.1.1.3.cmml"><mo id="S5.T4.21.21.21.21.3.m1.1.1.3a" xref="S5.T4.21.21.21.21.3.m1.1.1.3.cmml">±</mo><mn id="S5.T4.21.21.21.21.3.m1.1.1.3.2" xref="S5.T4.21.21.21.21.3.m1.1.1.3.2.cmml">9.59</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.21.21.21.21.3.m1.1b"><apply id="S5.T4.21.21.21.21.3.m1.1.1.cmml" xref="S5.T4.21.21.21.21.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.21.21.21.21.3.m1.1.1.1.cmml" xref="S5.T4.21.21.21.21.3.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.21.21.21.21.3.m1.1.1.2.cmml" xref="S5.T4.21.21.21.21.3.m1.1.1.2">35.88</cn><apply id="S5.T4.21.21.21.21.3.m1.1.1.3.cmml" xref="S5.T4.21.21.21.21.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.21.21.21.21.3.m1.1.1.3.1.cmml" xref="S5.T4.21.21.21.21.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.21.21.21.21.3.m1.1.1.3.2.cmml" xref="S5.T4.21.21.21.21.3.m1.1.1.3.2">9.59</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.21.21.21.21.3.m1.1c">35.88_{\pm 9.59}</annotation></semantics></math></td>
<td id="S5.T4.22.22.22.22.4" class="ltx_td ltx_align_center"><math id="S5.T4.22.22.22.22.4.m1.1" class="ltx_Math" alttext="44.70_{\pm 8.40}" display="inline"><semantics id="S5.T4.22.22.22.22.4.m1.1a"><msub id="S5.T4.22.22.22.22.4.m1.1.1" xref="S5.T4.22.22.22.22.4.m1.1.1.cmml"><mn id="S5.T4.22.22.22.22.4.m1.1.1.2" xref="S5.T4.22.22.22.22.4.m1.1.1.2.cmml">44.70</mn><mrow id="S5.T4.22.22.22.22.4.m1.1.1.3" xref="S5.T4.22.22.22.22.4.m1.1.1.3.cmml"><mo id="S5.T4.22.22.22.22.4.m1.1.1.3a" xref="S5.T4.22.22.22.22.4.m1.1.1.3.cmml">±</mo><mn id="S5.T4.22.22.22.22.4.m1.1.1.3.2" xref="S5.T4.22.22.22.22.4.m1.1.1.3.2.cmml">8.40</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.22.22.22.22.4.m1.1b"><apply id="S5.T4.22.22.22.22.4.m1.1.1.cmml" xref="S5.T4.22.22.22.22.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.22.22.22.22.4.m1.1.1.1.cmml" xref="S5.T4.22.22.22.22.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.22.22.22.22.4.m1.1.1.2.cmml" xref="S5.T4.22.22.22.22.4.m1.1.1.2">44.70</cn><apply id="S5.T4.22.22.22.22.4.m1.1.1.3.cmml" xref="S5.T4.22.22.22.22.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.22.22.22.22.4.m1.1.1.3.1.cmml" xref="S5.T4.22.22.22.22.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.22.22.22.22.4.m1.1.1.3.2.cmml" xref="S5.T4.22.22.22.22.4.m1.1.1.3.2">8.40</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.22.22.22.22.4.m1.1c">44.70_{\pm 8.40}</annotation></semantics></math></td>
</tr>
<tr id="S5.T4.26.26.26.26" class="ltx_tr">
<th id="S5.T4.26.26.26.26.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S5.T4.26.26.26.26.5.1" class="ltx_text ltx_font_bold">FedPerfix</span></th>
<td id="S5.T4.23.23.23.23.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S5.T4.23.23.23.23.1.m1.1" class="ltx_Math" alttext="\mathbf{43.80}_{\pm 11.56}" display="inline"><semantics id="S5.T4.23.23.23.23.1.m1.1a"><msub id="S5.T4.23.23.23.23.1.m1.1.1" xref="S5.T4.23.23.23.23.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T4.23.23.23.23.1.m1.1.1.2" xref="S5.T4.23.23.23.23.1.m1.1.1.2.cmml">43.80</mn><mrow id="S5.T4.23.23.23.23.1.m1.1.1.3" xref="S5.T4.23.23.23.23.1.m1.1.1.3.cmml"><mo id="S5.T4.23.23.23.23.1.m1.1.1.3a" xref="S5.T4.23.23.23.23.1.m1.1.1.3.cmml">±</mo><mn id="S5.T4.23.23.23.23.1.m1.1.1.3.2" xref="S5.T4.23.23.23.23.1.m1.1.1.3.2.cmml">11.56</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.23.23.23.23.1.m1.1b"><apply id="S5.T4.23.23.23.23.1.m1.1.1.cmml" xref="S5.T4.23.23.23.23.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.23.23.23.23.1.m1.1.1.1.cmml" xref="S5.T4.23.23.23.23.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.23.23.23.23.1.m1.1.1.2.cmml" xref="S5.T4.23.23.23.23.1.m1.1.1.2">43.80</cn><apply id="S5.T4.23.23.23.23.1.m1.1.1.3.cmml" xref="S5.T4.23.23.23.23.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.23.23.23.23.1.m1.1.1.3.1.cmml" xref="S5.T4.23.23.23.23.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.23.23.23.23.1.m1.1.1.3.2.cmml" xref="S5.T4.23.23.23.23.1.m1.1.1.3.2">11.56</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.23.23.23.23.1.m1.1c">\mathbf{43.80}_{\pm 11.56}</annotation></semantics></math></td>
<td id="S5.T4.24.24.24.24.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><math id="S5.T4.24.24.24.24.2.m1.1" class="ltx_Math" alttext="\mathbf{48.10}_{\pm 7.76}" display="inline"><semantics id="S5.T4.24.24.24.24.2.m1.1a"><msub id="S5.T4.24.24.24.24.2.m1.1.1" xref="S5.T4.24.24.24.24.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T4.24.24.24.24.2.m1.1.1.2" xref="S5.T4.24.24.24.24.2.m1.1.1.2.cmml">48.10</mn><mrow id="S5.T4.24.24.24.24.2.m1.1.1.3" xref="S5.T4.24.24.24.24.2.m1.1.1.3.cmml"><mo id="S5.T4.24.24.24.24.2.m1.1.1.3a" xref="S5.T4.24.24.24.24.2.m1.1.1.3.cmml">±</mo><mn id="S5.T4.24.24.24.24.2.m1.1.1.3.2" xref="S5.T4.24.24.24.24.2.m1.1.1.3.2.cmml">7.76</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.24.24.24.24.2.m1.1b"><apply id="S5.T4.24.24.24.24.2.m1.1.1.cmml" xref="S5.T4.24.24.24.24.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.24.24.24.24.2.m1.1.1.1.cmml" xref="S5.T4.24.24.24.24.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.24.24.24.24.2.m1.1.1.2.cmml" xref="S5.T4.24.24.24.24.2.m1.1.1.2">48.10</cn><apply id="S5.T4.24.24.24.24.2.m1.1.1.3.cmml" xref="S5.T4.24.24.24.24.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.24.24.24.24.2.m1.1.1.3.1.cmml" xref="S5.T4.24.24.24.24.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.24.24.24.24.2.m1.1.1.3.2.cmml" xref="S5.T4.24.24.24.24.2.m1.1.1.3.2">7.76</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.24.24.24.24.2.m1.1c">\mathbf{48.10}_{\pm 7.76}</annotation></semantics></math></td>
<td id="S5.T4.25.25.25.25.3" class="ltx_td ltx_align_center ltx_border_bb"><math id="S5.T4.25.25.25.25.3.m1.1" class="ltx_Math" alttext="\mathbf{43.96}_{\pm 10.42}" display="inline"><semantics id="S5.T4.25.25.25.25.3.m1.1a"><msub id="S5.T4.25.25.25.25.3.m1.1.1" xref="S5.T4.25.25.25.25.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T4.25.25.25.25.3.m1.1.1.2" xref="S5.T4.25.25.25.25.3.m1.1.1.2.cmml">43.96</mn><mrow id="S5.T4.25.25.25.25.3.m1.1.1.3" xref="S5.T4.25.25.25.25.3.m1.1.1.3.cmml"><mo id="S5.T4.25.25.25.25.3.m1.1.1.3a" xref="S5.T4.25.25.25.25.3.m1.1.1.3.cmml">±</mo><mn id="S5.T4.25.25.25.25.3.m1.1.1.3.2" xref="S5.T4.25.25.25.25.3.m1.1.1.3.2.cmml">10.42</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.25.25.25.25.3.m1.1b"><apply id="S5.T4.25.25.25.25.3.m1.1.1.cmml" xref="S5.T4.25.25.25.25.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.25.25.25.25.3.m1.1.1.1.cmml" xref="S5.T4.25.25.25.25.3.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.25.25.25.25.3.m1.1.1.2.cmml" xref="S5.T4.25.25.25.25.3.m1.1.1.2">43.96</cn><apply id="S5.T4.25.25.25.25.3.m1.1.1.3.cmml" xref="S5.T4.25.25.25.25.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.25.25.25.25.3.m1.1.1.3.1.cmml" xref="S5.T4.25.25.25.25.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.25.25.25.25.3.m1.1.1.3.2.cmml" xref="S5.T4.25.25.25.25.3.m1.1.1.3.2">10.42</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.25.25.25.25.3.m1.1c">\mathbf{43.96}_{\pm 10.42}</annotation></semantics></math></td>
<td id="S5.T4.26.26.26.26.4" class="ltx_td ltx_align_center ltx_border_bb"><math id="S5.T4.26.26.26.26.4.m1.1" class="ltx_Math" alttext="\mathbf{46.96}_{\pm 9.00}" display="inline"><semantics id="S5.T4.26.26.26.26.4.m1.1a"><msub id="S5.T4.26.26.26.26.4.m1.1.1" xref="S5.T4.26.26.26.26.4.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T4.26.26.26.26.4.m1.1.1.2" xref="S5.T4.26.26.26.26.4.m1.1.1.2.cmml">46.96</mn><mrow id="S5.T4.26.26.26.26.4.m1.1.1.3" xref="S5.T4.26.26.26.26.4.m1.1.1.3.cmml"><mo id="S5.T4.26.26.26.26.4.m1.1.1.3a" xref="S5.T4.26.26.26.26.4.m1.1.1.3.cmml">±</mo><mn id="S5.T4.26.26.26.26.4.m1.1.1.3.2" xref="S5.T4.26.26.26.26.4.m1.1.1.3.2.cmml">9.00</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T4.26.26.26.26.4.m1.1b"><apply id="S5.T4.26.26.26.26.4.m1.1.1.cmml" xref="S5.T4.26.26.26.26.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.26.26.26.26.4.m1.1.1.1.cmml" xref="S5.T4.26.26.26.26.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T4.26.26.26.26.4.m1.1.1.2.cmml" xref="S5.T4.26.26.26.26.4.m1.1.1.2">46.96</cn><apply id="S5.T4.26.26.26.26.4.m1.1.1.3.cmml" xref="S5.T4.26.26.26.26.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.26.26.26.26.4.m1.1.1.3.1.cmml" xref="S5.T4.26.26.26.26.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T4.26.26.26.26.4.m1.1.1.3.2.cmml" xref="S5.T4.26.26.26.26.4.m1.1.1.3.2">9.00</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.26.26.26.26.4.m1.1c">\mathbf{46.96}_{\pm 9.00}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Investigation of FedPerfix</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">In this subsection, we investigate the impact of the model size of FedPerfix and verify its effectiveness compared with other designs.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para ltx_noindent">
<p id="S5.SS3.p2.1" class="ltx_p"><span id="S5.SS3.p2.1.1" class="ltx_text ltx_font_bold">Impact of Model Size.</span> The model size is a crucial factor in federated learning, as it determines the resource requirements for storage, computation, and communication.
To examine the impact of model size on the performance of FedPerfix, we conducted experiments with three different ViT backbones: ViT-Tiny, ViT-Small (Default), and ViT-Base. Additionally, we included the results of the baselines and two competitive methods as a reference. As shown in Table <a href="#S5.T5" title="Table 5 ‣ 5.3 Investigation of FedPerfix ‣ 5 Ablation Study ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, FedPerfix still yields superior performance with different model sizes. Besides,
the larger models generally performed better, with ViT-Base achieving the highest performance for each method. However, we note that the performance improvement decreases as the model size increases, suggesting a potential trade-off between model size and performance. This finding highlights the importance of selecting an appropriate model size to achieve the optimal balance between performance and resource requirements, particularly in resource-constrained environments where storage and computation resources are limited.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para ltx_noindent">
<p id="S5.SS3.p3.1" class="ltx_p"><span id="S5.SS3.p3.1.1" class="ltx_text ltx_font_bold">FedPerfix vs. Vanilla Prefix-tuning.</span> As mentioned in Section <a href="#S3.SS5" title="3.5 FedPerfix: Stabilize the Prefix ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.5</span></a>, the initialization of the Prefixes will affect the performance. To show the effectiveness of the parallel attention design in FedPerfix, we conduct experiments with Vanilla Prefix-tuning under two different initialization, initialized with zero (Prefix-Z) and random initialization (Prefix-R). Then, we compare the results with FedPerfix. The result is shown in Table <a href="#S5.T6" title="Table 6 ‣ 5.3 Investigation of FedPerfix ‣ 5 Ablation Study ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
As expected, the prefixes generated from the parallel attention yield better performance than the other two manually initialized prefixes,
highlighting the effectiveness of the parallel attention design in FedPerfix.</p>
</div>
<div id="S5.SS3.p4" class="ltx_para ltx_noindent">
<p id="S5.SS3.p4.1" class="ltx_p"><span id="S5.SS3.p4.1.1" class="ltx_text ltx_font_bold">FedPerfix vs. Prompts &amp; Adapters. </span> Prompts and adapters are also popular plugins that are widely used. To verify whether FedPerfix is the most effective among all families of the plugins, we also apply Prompts and Adapters to personalized federated learning. Specifically, we append several trainable Prompts to the input embeddings and keep them updated locally as the implementation of Prompt-tuning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Meanwhile, we add Adapters to the MLP layers as the implementation of Adatper-tuning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. The results are shown in Table <a href="#S5.T6" title="Table 6 ‣ 5.3 Investigation of FedPerfix ‣ 5 Ablation Study ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. Adding personalized Prompts doesn’t improve the performance compared with simply keeping the classification head updated locally, indicating that the transformation to the input is not effective in PFL. However, adding Adapters to the MLP layers can also lead to a promising result as FedPerfix. Recap the result of our empirical study shown in Table <a href="#S3.T1" title="Table 1 ‣ 3.2 Recap: Partial Model Personalization for CNN ‣ 3 Method ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, MLP layers are also sensitive to data distribution in a ViT. We note that as another instance to show the effectiveness of adding plugins to the sensitive parts of a ViT in PFL.</p>
</div>
<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Performance on CIFAR-100 with different model sizes.</figcaption>
<table id="S5.T5.15.15" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T5.15.15.16.1" class="ltx_tr">
<th id="S5.T5.15.15.16.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"><span id="S5.T5.15.15.16.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S5.T5.15.15.16.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T5.15.15.16.1.2.1" class="ltx_text ltx_font_bold">ViT-Tiny</span></th>
<th id="S5.T5.15.15.16.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T5.15.15.16.1.3.1" class="ltx_text ltx_font_bold">ViT-Small</span></th>
<th id="S5.T5.15.15.16.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T5.15.15.16.1.4.1" class="ltx_text ltx_font_bold">ViT-Base</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T5.3.3.3" class="ltx_tr">
<th id="S5.T5.3.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">FedAVG</th>
<td id="S5.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T5.1.1.1.1.m1.1" class="ltx_Math" alttext="19.56_{\pm 10.27}" display="inline"><semantics id="S5.T5.1.1.1.1.m1.1a"><msub id="S5.T5.1.1.1.1.m1.1.1" xref="S5.T5.1.1.1.1.m1.1.1.cmml"><mn id="S5.T5.1.1.1.1.m1.1.1.2" xref="S5.T5.1.1.1.1.m1.1.1.2.cmml">19.56</mn><mrow id="S5.T5.1.1.1.1.m1.1.1.3" xref="S5.T5.1.1.1.1.m1.1.1.3.cmml"><mo id="S5.T5.1.1.1.1.m1.1.1.3a" xref="S5.T5.1.1.1.1.m1.1.1.3.cmml">±</mo><mn id="S5.T5.1.1.1.1.m1.1.1.3.2" xref="S5.T5.1.1.1.1.m1.1.1.3.2.cmml">10.27</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.1.1.1.1.m1.1b"><apply id="S5.T5.1.1.1.1.m1.1.1.cmml" xref="S5.T5.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.1.1.1.1.m1.1.1.1.cmml" xref="S5.T5.1.1.1.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.1.1.1.1.m1.1.1.2.cmml" xref="S5.T5.1.1.1.1.m1.1.1.2">19.56</cn><apply id="S5.T5.1.1.1.1.m1.1.1.3.cmml" xref="S5.T5.1.1.1.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.1.1.1.1.m1.1.1.3.1.cmml" xref="S5.T5.1.1.1.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.1.1.1.1.m1.1.1.3.2.cmml" xref="S5.T5.1.1.1.1.m1.1.1.3.2">10.27</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.1.1.1.1.m1.1c">19.56_{\pm 10.27}</annotation></semantics></math></td>
<td id="S5.T5.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T5.2.2.2.2.m1.1" class="ltx_Math" alttext="23.29_{\pm 11.31}" display="inline"><semantics id="S5.T5.2.2.2.2.m1.1a"><msub id="S5.T5.2.2.2.2.m1.1.1" xref="S5.T5.2.2.2.2.m1.1.1.cmml"><mn id="S5.T5.2.2.2.2.m1.1.1.2" xref="S5.T5.2.2.2.2.m1.1.1.2.cmml">23.29</mn><mrow id="S5.T5.2.2.2.2.m1.1.1.3" xref="S5.T5.2.2.2.2.m1.1.1.3.cmml"><mo id="S5.T5.2.2.2.2.m1.1.1.3a" xref="S5.T5.2.2.2.2.m1.1.1.3.cmml">±</mo><mn id="S5.T5.2.2.2.2.m1.1.1.3.2" xref="S5.T5.2.2.2.2.m1.1.1.3.2.cmml">11.31</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.2.2.2.2.m1.1b"><apply id="S5.T5.2.2.2.2.m1.1.1.cmml" xref="S5.T5.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.2.2.2.2.m1.1.1.1.cmml" xref="S5.T5.2.2.2.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.2.2.2.2.m1.1.1.2.cmml" xref="S5.T5.2.2.2.2.m1.1.1.2">23.29</cn><apply id="S5.T5.2.2.2.2.m1.1.1.3.cmml" xref="S5.T5.2.2.2.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.2.2.2.2.m1.1.1.3.1.cmml" xref="S5.T5.2.2.2.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.2.2.2.2.m1.1.1.3.2.cmml" xref="S5.T5.2.2.2.2.m1.1.1.3.2">11.31</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.2.2.2.2.m1.1c">23.29_{\pm 11.31}</annotation></semantics></math></td>
<td id="S5.T5.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T5.3.3.3.3.m1.1" class="ltx_Math" alttext="24.82_{\pm 11.53}" display="inline"><semantics id="S5.T5.3.3.3.3.m1.1a"><msub id="S5.T5.3.3.3.3.m1.1.1" xref="S5.T5.3.3.3.3.m1.1.1.cmml"><mn id="S5.T5.3.3.3.3.m1.1.1.2" xref="S5.T5.3.3.3.3.m1.1.1.2.cmml">24.82</mn><mrow id="S5.T5.3.3.3.3.m1.1.1.3" xref="S5.T5.3.3.3.3.m1.1.1.3.cmml"><mo id="S5.T5.3.3.3.3.m1.1.1.3a" xref="S5.T5.3.3.3.3.m1.1.1.3.cmml">±</mo><mn id="S5.T5.3.3.3.3.m1.1.1.3.2" xref="S5.T5.3.3.3.3.m1.1.1.3.2.cmml">11.53</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.3.3.3.3.m1.1b"><apply id="S5.T5.3.3.3.3.m1.1.1.cmml" xref="S5.T5.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.3.3.3.3.m1.1.1.1.cmml" xref="S5.T5.3.3.3.3.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.3.3.3.3.m1.1.1.2.cmml" xref="S5.T5.3.3.3.3.m1.1.1.2">24.82</cn><apply id="S5.T5.3.3.3.3.m1.1.1.3.cmml" xref="S5.T5.3.3.3.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.3.3.3.3.m1.1.1.3.1.cmml" xref="S5.T5.3.3.3.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.3.3.3.3.m1.1.1.3.2.cmml" xref="S5.T5.3.3.3.3.m1.1.1.3.2">11.53</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.3.3.3.3.m1.1c">24.82_{\pm 11.53}</annotation></semantics></math></td>
</tr>
<tr id="S5.T5.6.6.6" class="ltx_tr">
<th id="S5.T5.6.6.6.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Local</th>
<td id="S5.T5.4.4.4.1" class="ltx_td ltx_align_center"><math id="S5.T5.4.4.4.1.m1.1" class="ltx_Math" alttext="33.73_{\pm 9.20}" display="inline"><semantics id="S5.T5.4.4.4.1.m1.1a"><msub id="S5.T5.4.4.4.1.m1.1.1" xref="S5.T5.4.4.4.1.m1.1.1.cmml"><mn id="S5.T5.4.4.4.1.m1.1.1.2" xref="S5.T5.4.4.4.1.m1.1.1.2.cmml">33.73</mn><mrow id="S5.T5.4.4.4.1.m1.1.1.3" xref="S5.T5.4.4.4.1.m1.1.1.3.cmml"><mo id="S5.T5.4.4.4.1.m1.1.1.3a" xref="S5.T5.4.4.4.1.m1.1.1.3.cmml">±</mo><mn id="S5.T5.4.4.4.1.m1.1.1.3.2" xref="S5.T5.4.4.4.1.m1.1.1.3.2.cmml">9.20</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.4.4.4.1.m1.1b"><apply id="S5.T5.4.4.4.1.m1.1.1.cmml" xref="S5.T5.4.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.4.4.4.1.m1.1.1.1.cmml" xref="S5.T5.4.4.4.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.4.4.4.1.m1.1.1.2.cmml" xref="S5.T5.4.4.4.1.m1.1.1.2">33.73</cn><apply id="S5.T5.4.4.4.1.m1.1.1.3.cmml" xref="S5.T5.4.4.4.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.4.4.4.1.m1.1.1.3.1.cmml" xref="S5.T5.4.4.4.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.4.4.4.1.m1.1.1.3.2.cmml" xref="S5.T5.4.4.4.1.m1.1.1.3.2">9.20</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.4.4.4.1.m1.1c">33.73_{\pm 9.20}</annotation></semantics></math></td>
<td id="S5.T5.5.5.5.2" class="ltx_td ltx_align_center"><math id="S5.T5.5.5.5.2.m1.1" class="ltx_Math" alttext="34.74_{\pm 9.36}" display="inline"><semantics id="S5.T5.5.5.5.2.m1.1a"><msub id="S5.T5.5.5.5.2.m1.1.1" xref="S5.T5.5.5.5.2.m1.1.1.cmml"><mn id="S5.T5.5.5.5.2.m1.1.1.2" xref="S5.T5.5.5.5.2.m1.1.1.2.cmml">34.74</mn><mrow id="S5.T5.5.5.5.2.m1.1.1.3" xref="S5.T5.5.5.5.2.m1.1.1.3.cmml"><mo id="S5.T5.5.5.5.2.m1.1.1.3a" xref="S5.T5.5.5.5.2.m1.1.1.3.cmml">±</mo><mn id="S5.T5.5.5.5.2.m1.1.1.3.2" xref="S5.T5.5.5.5.2.m1.1.1.3.2.cmml">9.36</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.5.5.5.2.m1.1b"><apply id="S5.T5.5.5.5.2.m1.1.1.cmml" xref="S5.T5.5.5.5.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.5.5.5.2.m1.1.1.1.cmml" xref="S5.T5.5.5.5.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.5.5.5.2.m1.1.1.2.cmml" xref="S5.T5.5.5.5.2.m1.1.1.2">34.74</cn><apply id="S5.T5.5.5.5.2.m1.1.1.3.cmml" xref="S5.T5.5.5.5.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.5.5.5.2.m1.1.1.3.1.cmml" xref="S5.T5.5.5.5.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.5.5.5.2.m1.1.1.3.2.cmml" xref="S5.T5.5.5.5.2.m1.1.1.3.2">9.36</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.5.5.5.2.m1.1c">34.74_{\pm 9.36}</annotation></semantics></math></td>
<td id="S5.T5.6.6.6.3" class="ltx_td ltx_align_center"><math id="S5.T5.6.6.6.3.m1.1" class="ltx_Math" alttext="38.93_{\pm 10.08}" display="inline"><semantics id="S5.T5.6.6.6.3.m1.1a"><msub id="S5.T5.6.6.6.3.m1.1.1" xref="S5.T5.6.6.6.3.m1.1.1.cmml"><mn id="S5.T5.6.6.6.3.m1.1.1.2" xref="S5.T5.6.6.6.3.m1.1.1.2.cmml">38.93</mn><mrow id="S5.T5.6.6.6.3.m1.1.1.3" xref="S5.T5.6.6.6.3.m1.1.1.3.cmml"><mo id="S5.T5.6.6.6.3.m1.1.1.3a" xref="S5.T5.6.6.6.3.m1.1.1.3.cmml">±</mo><mn id="S5.T5.6.6.6.3.m1.1.1.3.2" xref="S5.T5.6.6.6.3.m1.1.1.3.2.cmml">10.08</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.6.6.6.3.m1.1b"><apply id="S5.T5.6.6.6.3.m1.1.1.cmml" xref="S5.T5.6.6.6.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.6.6.6.3.m1.1.1.1.cmml" xref="S5.T5.6.6.6.3.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.6.6.6.3.m1.1.1.2.cmml" xref="S5.T5.6.6.6.3.m1.1.1.2">38.93</cn><apply id="S5.T5.6.6.6.3.m1.1.1.3.cmml" xref="S5.T5.6.6.6.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.6.6.6.3.m1.1.1.3.1.cmml" xref="S5.T5.6.6.6.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.6.6.6.3.m1.1.1.3.2.cmml" xref="S5.T5.6.6.6.3.m1.1.1.3.2">10.08</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.6.6.6.3.m1.1c">38.93_{\pm 10.08}</annotation></semantics></math></td>
</tr>
<tr id="S5.T5.9.9.9" class="ltx_tr">
<th id="S5.T5.9.9.9.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">APFL</th>
<td id="S5.T5.7.7.7.1" class="ltx_td ltx_align_center"><math id="S5.T5.7.7.7.1.m1.1" class="ltx_Math" alttext="37.66_{\pm 10.04}" display="inline"><semantics id="S5.T5.7.7.7.1.m1.1a"><msub id="S5.T5.7.7.7.1.m1.1.1" xref="S5.T5.7.7.7.1.m1.1.1.cmml"><mn id="S5.T5.7.7.7.1.m1.1.1.2" xref="S5.T5.7.7.7.1.m1.1.1.2.cmml">37.66</mn><mrow id="S5.T5.7.7.7.1.m1.1.1.3" xref="S5.T5.7.7.7.1.m1.1.1.3.cmml"><mo id="S5.T5.7.7.7.1.m1.1.1.3a" xref="S5.T5.7.7.7.1.m1.1.1.3.cmml">±</mo><mn id="S5.T5.7.7.7.1.m1.1.1.3.2" xref="S5.T5.7.7.7.1.m1.1.1.3.2.cmml">10.04</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.7.7.7.1.m1.1b"><apply id="S5.T5.7.7.7.1.m1.1.1.cmml" xref="S5.T5.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.7.7.7.1.m1.1.1.1.cmml" xref="S5.T5.7.7.7.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.7.7.7.1.m1.1.1.2.cmml" xref="S5.T5.7.7.7.1.m1.1.1.2">37.66</cn><apply id="S5.T5.7.7.7.1.m1.1.1.3.cmml" xref="S5.T5.7.7.7.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.7.7.7.1.m1.1.1.3.1.cmml" xref="S5.T5.7.7.7.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.7.7.7.1.m1.1.1.3.2.cmml" xref="S5.T5.7.7.7.1.m1.1.1.3.2">10.04</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.7.7.7.1.m1.1c">37.66_{\pm 10.04}</annotation></semantics></math></td>
<td id="S5.T5.8.8.8.2" class="ltx_td ltx_align_center"><math id="S5.T5.8.8.8.2.m1.1" class="ltx_Math" alttext="44.88_{\pm 10.50}" display="inline"><semantics id="S5.T5.8.8.8.2.m1.1a"><msub id="S5.T5.8.8.8.2.m1.1.1" xref="S5.T5.8.8.8.2.m1.1.1.cmml"><mn id="S5.T5.8.8.8.2.m1.1.1.2" xref="S5.T5.8.8.8.2.m1.1.1.2.cmml">44.88</mn><mrow id="S5.T5.8.8.8.2.m1.1.1.3" xref="S5.T5.8.8.8.2.m1.1.1.3.cmml"><mo id="S5.T5.8.8.8.2.m1.1.1.3a" xref="S5.T5.8.8.8.2.m1.1.1.3.cmml">±</mo><mn id="S5.T5.8.8.8.2.m1.1.1.3.2" xref="S5.T5.8.8.8.2.m1.1.1.3.2.cmml">10.50</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.8.8.8.2.m1.1b"><apply id="S5.T5.8.8.8.2.m1.1.1.cmml" xref="S5.T5.8.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.8.8.8.2.m1.1.1.1.cmml" xref="S5.T5.8.8.8.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.8.8.8.2.m1.1.1.2.cmml" xref="S5.T5.8.8.8.2.m1.1.1.2">44.88</cn><apply id="S5.T5.8.8.8.2.m1.1.1.3.cmml" xref="S5.T5.8.8.8.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.8.8.8.2.m1.1.1.3.1.cmml" xref="S5.T5.8.8.8.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.8.8.8.2.m1.1.1.3.2.cmml" xref="S5.T5.8.8.8.2.m1.1.1.3.2">10.50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.8.8.8.2.m1.1c">44.88_{\pm 10.50}</annotation></semantics></math></td>
<td id="S5.T5.9.9.9.3" class="ltx_td ltx_align_center"><math id="S5.T5.9.9.9.3.m1.1" class="ltx_Math" alttext="47.57_{\pm 9.57}" display="inline"><semantics id="S5.T5.9.9.9.3.m1.1a"><msub id="S5.T5.9.9.9.3.m1.1.1" xref="S5.T5.9.9.9.3.m1.1.1.cmml"><mn id="S5.T5.9.9.9.3.m1.1.1.2" xref="S5.T5.9.9.9.3.m1.1.1.2.cmml">47.57</mn><mrow id="S5.T5.9.9.9.3.m1.1.1.3" xref="S5.T5.9.9.9.3.m1.1.1.3.cmml"><mo id="S5.T5.9.9.9.3.m1.1.1.3a" xref="S5.T5.9.9.9.3.m1.1.1.3.cmml">±</mo><mn id="S5.T5.9.9.9.3.m1.1.1.3.2" xref="S5.T5.9.9.9.3.m1.1.1.3.2.cmml">9.57</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.9.9.9.3.m1.1b"><apply id="S5.T5.9.9.9.3.m1.1.1.cmml" xref="S5.T5.9.9.9.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.9.9.9.3.m1.1.1.1.cmml" xref="S5.T5.9.9.9.3.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.9.9.9.3.m1.1.1.2.cmml" xref="S5.T5.9.9.9.3.m1.1.1.2">47.57</cn><apply id="S5.T5.9.9.9.3.m1.1.1.3.cmml" xref="S5.T5.9.9.9.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.9.9.9.3.m1.1.1.3.1.cmml" xref="S5.T5.9.9.9.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.9.9.9.3.m1.1.1.3.2.cmml" xref="S5.T5.9.9.9.3.m1.1.1.3.2">9.57</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.9.9.9.3.m1.1c">47.57_{\pm 9.57}</annotation></semantics></math></td>
</tr>
<tr id="S5.T5.12.12.12" class="ltx_tr">
<th id="S5.T5.12.12.12.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedRep</th>
<td id="S5.T5.10.10.10.1" class="ltx_td ltx_align_center"><math id="S5.T5.10.10.10.1.m1.1" class="ltx_Math" alttext="41.58_{\pm 7.19}" display="inline"><semantics id="S5.T5.10.10.10.1.m1.1a"><msub id="S5.T5.10.10.10.1.m1.1.1" xref="S5.T5.10.10.10.1.m1.1.1.cmml"><mn id="S5.T5.10.10.10.1.m1.1.1.2" xref="S5.T5.10.10.10.1.m1.1.1.2.cmml">41.58</mn><mrow id="S5.T5.10.10.10.1.m1.1.1.3" xref="S5.T5.10.10.10.1.m1.1.1.3.cmml"><mo id="S5.T5.10.10.10.1.m1.1.1.3a" xref="S5.T5.10.10.10.1.m1.1.1.3.cmml">±</mo><mn id="S5.T5.10.10.10.1.m1.1.1.3.2" xref="S5.T5.10.10.10.1.m1.1.1.3.2.cmml">7.19</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.10.10.10.1.m1.1b"><apply id="S5.T5.10.10.10.1.m1.1.1.cmml" xref="S5.T5.10.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.10.10.10.1.m1.1.1.1.cmml" xref="S5.T5.10.10.10.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.10.10.10.1.m1.1.1.2.cmml" xref="S5.T5.10.10.10.1.m1.1.1.2">41.58</cn><apply id="S5.T5.10.10.10.1.m1.1.1.3.cmml" xref="S5.T5.10.10.10.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.10.10.10.1.m1.1.1.3.1.cmml" xref="S5.T5.10.10.10.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.10.10.10.1.m1.1.1.3.2.cmml" xref="S5.T5.10.10.10.1.m1.1.1.3.2">7.19</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.10.10.10.1.m1.1c">41.58_{\pm 7.19}</annotation></semantics></math></td>
<td id="S5.T5.11.11.11.2" class="ltx_td ltx_align_center"><math id="S5.T5.11.11.11.2.m1.1" class="ltx_Math" alttext="44.42_{\pm 7.80}" display="inline"><semantics id="S5.T5.11.11.11.2.m1.1a"><msub id="S5.T5.11.11.11.2.m1.1.1" xref="S5.T5.11.11.11.2.m1.1.1.cmml"><mn id="S5.T5.11.11.11.2.m1.1.1.2" xref="S5.T5.11.11.11.2.m1.1.1.2.cmml">44.42</mn><mrow id="S5.T5.11.11.11.2.m1.1.1.3" xref="S5.T5.11.11.11.2.m1.1.1.3.cmml"><mo id="S5.T5.11.11.11.2.m1.1.1.3a" xref="S5.T5.11.11.11.2.m1.1.1.3.cmml">±</mo><mn id="S5.T5.11.11.11.2.m1.1.1.3.2" xref="S5.T5.11.11.11.2.m1.1.1.3.2.cmml">7.80</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.11.11.11.2.m1.1b"><apply id="S5.T5.11.11.11.2.m1.1.1.cmml" xref="S5.T5.11.11.11.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.11.11.11.2.m1.1.1.1.cmml" xref="S5.T5.11.11.11.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.11.11.11.2.m1.1.1.2.cmml" xref="S5.T5.11.11.11.2.m1.1.1.2">44.42</cn><apply id="S5.T5.11.11.11.2.m1.1.1.3.cmml" xref="S5.T5.11.11.11.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.11.11.11.2.m1.1.1.3.1.cmml" xref="S5.T5.11.11.11.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.11.11.11.2.m1.1.1.3.2.cmml" xref="S5.T5.11.11.11.2.m1.1.1.3.2">7.80</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.11.11.11.2.m1.1c">44.42_{\pm 7.80}</annotation></semantics></math></td>
<td id="S5.T5.12.12.12.3" class="ltx_td ltx_align_center"><math id="S5.T5.12.12.12.3.m1.1" class="ltx_Math" alttext="44.34_{\pm 8.35}" display="inline"><semantics id="S5.T5.12.12.12.3.m1.1a"><msub id="S5.T5.12.12.12.3.m1.1.1" xref="S5.T5.12.12.12.3.m1.1.1.cmml"><mn id="S5.T5.12.12.12.3.m1.1.1.2" xref="S5.T5.12.12.12.3.m1.1.1.2.cmml">44.34</mn><mrow id="S5.T5.12.12.12.3.m1.1.1.3" xref="S5.T5.12.12.12.3.m1.1.1.3.cmml"><mo id="S5.T5.12.12.12.3.m1.1.1.3a" xref="S5.T5.12.12.12.3.m1.1.1.3.cmml">±</mo><mn id="S5.T5.12.12.12.3.m1.1.1.3.2" xref="S5.T5.12.12.12.3.m1.1.1.3.2.cmml">8.35</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.12.12.12.3.m1.1b"><apply id="S5.T5.12.12.12.3.m1.1.1.cmml" xref="S5.T5.12.12.12.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.12.12.12.3.m1.1.1.1.cmml" xref="S5.T5.12.12.12.3.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.12.12.12.3.m1.1.1.2.cmml" xref="S5.T5.12.12.12.3.m1.1.1.2">44.34</cn><apply id="S5.T5.12.12.12.3.m1.1.1.3.cmml" xref="S5.T5.12.12.12.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.12.12.12.3.m1.1.1.3.1.cmml" xref="S5.T5.12.12.12.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.12.12.12.3.m1.1.1.3.2.cmml" xref="S5.T5.12.12.12.3.m1.1.1.3.2">8.35</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.12.12.12.3.m1.1c">44.34_{\pm 8.35}</annotation></semantics></math></td>
</tr>
<tr id="S5.T5.15.15.15" class="ltx_tr">
<th id="S5.T5.15.15.15.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S5.T5.15.15.15.4.1" class="ltx_text ltx_font_bold">FedPerfix</span></th>
<td id="S5.T5.13.13.13.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S5.T5.13.13.13.1.m1.1" class="ltx_Math" alttext="\mathbf{44.71}_{\pm 8.47}" display="inline"><semantics id="S5.T5.13.13.13.1.m1.1a"><msub id="S5.T5.13.13.13.1.m1.1.1" xref="S5.T5.13.13.13.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T5.13.13.13.1.m1.1.1.2" xref="S5.T5.13.13.13.1.m1.1.1.2.cmml">44.71</mn><mrow id="S5.T5.13.13.13.1.m1.1.1.3" xref="S5.T5.13.13.13.1.m1.1.1.3.cmml"><mo id="S5.T5.13.13.13.1.m1.1.1.3a" xref="S5.T5.13.13.13.1.m1.1.1.3.cmml">±</mo><mn id="S5.T5.13.13.13.1.m1.1.1.3.2" xref="S5.T5.13.13.13.1.m1.1.1.3.2.cmml">8.47</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.13.13.13.1.m1.1b"><apply id="S5.T5.13.13.13.1.m1.1.1.cmml" xref="S5.T5.13.13.13.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.13.13.13.1.m1.1.1.1.cmml" xref="S5.T5.13.13.13.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.13.13.13.1.m1.1.1.2.cmml" xref="S5.T5.13.13.13.1.m1.1.1.2">44.71</cn><apply id="S5.T5.13.13.13.1.m1.1.1.3.cmml" xref="S5.T5.13.13.13.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.13.13.13.1.m1.1.1.3.1.cmml" xref="S5.T5.13.13.13.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.13.13.13.1.m1.1.1.3.2.cmml" xref="S5.T5.13.13.13.1.m1.1.1.3.2">8.47</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.13.13.13.1.m1.1c">\mathbf{44.71}_{\pm 8.47}</annotation></semantics></math></td>
<td id="S5.T5.14.14.14.2" class="ltx_td ltx_align_center ltx_border_bb"><math id="S5.T5.14.14.14.2.m1.1" class="ltx_Math" alttext="\mathbf{48.10}_{\pm 7.76}" display="inline"><semantics id="S5.T5.14.14.14.2.m1.1a"><msub id="S5.T5.14.14.14.2.m1.1.1" xref="S5.T5.14.14.14.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T5.14.14.14.2.m1.1.1.2" xref="S5.T5.14.14.14.2.m1.1.1.2.cmml">48.10</mn><mrow id="S5.T5.14.14.14.2.m1.1.1.3" xref="S5.T5.14.14.14.2.m1.1.1.3.cmml"><mo id="S5.T5.14.14.14.2.m1.1.1.3a" xref="S5.T5.14.14.14.2.m1.1.1.3.cmml">±</mo><mn id="S5.T5.14.14.14.2.m1.1.1.3.2" xref="S5.T5.14.14.14.2.m1.1.1.3.2.cmml">7.76</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.14.14.14.2.m1.1b"><apply id="S5.T5.14.14.14.2.m1.1.1.cmml" xref="S5.T5.14.14.14.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.14.14.14.2.m1.1.1.1.cmml" xref="S5.T5.14.14.14.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.14.14.14.2.m1.1.1.2.cmml" xref="S5.T5.14.14.14.2.m1.1.1.2">48.10</cn><apply id="S5.T5.14.14.14.2.m1.1.1.3.cmml" xref="S5.T5.14.14.14.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.14.14.14.2.m1.1.1.3.1.cmml" xref="S5.T5.14.14.14.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.14.14.14.2.m1.1.1.3.2.cmml" xref="S5.T5.14.14.14.2.m1.1.1.3.2">7.76</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.14.14.14.2.m1.1c">\mathbf{48.10}_{\pm 7.76}</annotation></semantics></math></td>
<td id="S5.T5.15.15.15.3" class="ltx_td ltx_align_center ltx_border_bb"><math id="S5.T5.15.15.15.3.m1.1" class="ltx_Math" alttext="\mathbf{48.40}_{\pm 8.18}" display="inline"><semantics id="S5.T5.15.15.15.3.m1.1a"><msub id="S5.T5.15.15.15.3.m1.1.1" xref="S5.T5.15.15.15.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T5.15.15.15.3.m1.1.1.2" xref="S5.T5.15.15.15.3.m1.1.1.2.cmml">48.40</mn><mrow id="S5.T5.15.15.15.3.m1.1.1.3" xref="S5.T5.15.15.15.3.m1.1.1.3.cmml"><mo id="S5.T5.15.15.15.3.m1.1.1.3a" xref="S5.T5.15.15.15.3.m1.1.1.3.cmml">±</mo><mn id="S5.T5.15.15.15.3.m1.1.1.3.2" xref="S5.T5.15.15.15.3.m1.1.1.3.2.cmml">8.18</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T5.15.15.15.3.m1.1b"><apply id="S5.T5.15.15.15.3.m1.1.1.cmml" xref="S5.T5.15.15.15.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.15.15.15.3.m1.1.1.1.cmml" xref="S5.T5.15.15.15.3.m1.1.1">subscript</csymbol><cn type="float" id="S5.T5.15.15.15.3.m1.1.1.2.cmml" xref="S5.T5.15.15.15.3.m1.1.1.2">48.40</cn><apply id="S5.T5.15.15.15.3.m1.1.1.3.cmml" xref="S5.T5.15.15.15.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T5.15.15.15.3.m1.1.1.3.1.cmml" xref="S5.T5.15.15.15.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T5.15.15.15.3.m1.1.1.3.2.cmml" xref="S5.T5.15.15.15.3.m1.1.1.3.2">8.18</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.15.15.15.3.m1.1c">\mathbf{48.40}_{\pm 8.18}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Performance of different designs on CIFAR-100. Prefix-Z and Prefix-R mean vanilla prefix-tuning with zero and random initialization. </figcaption>
<div id="S5.T6.5.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:60.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(87.9pt,-12.3pt) scale(1.68221707716372,1.68221707716372) ;">
<table id="S5.T6.5.5.5" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T6.5.5.5.6.1" class="ltx_tr">
<th id="S5.T6.5.5.5.6.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"><span id="S5.T6.5.5.5.6.1.1.1" class="ltx_text ltx_font_bold">FedPerfix</span></th>
<th id="S5.T6.5.5.5.6.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T6.5.5.5.6.1.2.1" class="ltx_text ltx_font_bold">Prefix-Z</span></th>
<th id="S5.T6.5.5.5.6.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt"><span id="S5.T6.5.5.5.6.1.3.1" class="ltx_text ltx_font_bold">Prefix-R</span></th>
<th id="S5.T6.5.5.5.6.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T6.5.5.5.6.1.4.1" class="ltx_text ltx_font_bold">Prompts</span></th>
<th id="S5.T6.5.5.5.6.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T6.5.5.5.6.1.5.1" class="ltx_text ltx_font_bold">Adapters</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T6.5.5.5.5" class="ltx_tr">
<th id="S5.T6.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t"><math id="S5.T6.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{48.10}_{\pm 7.76}" display="inline"><semantics id="S5.T6.1.1.1.1.1.m1.1a"><msub id="S5.T6.1.1.1.1.1.m1.1.1" xref="S5.T6.1.1.1.1.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T6.1.1.1.1.1.m1.1.1.2" xref="S5.T6.1.1.1.1.1.m1.1.1.2.cmml">48.10</mn><mrow id="S5.T6.1.1.1.1.1.m1.1.1.3" xref="S5.T6.1.1.1.1.1.m1.1.1.3.cmml"><mo id="S5.T6.1.1.1.1.1.m1.1.1.3a" xref="S5.T6.1.1.1.1.1.m1.1.1.3.cmml">±</mo><mn id="S5.T6.1.1.1.1.1.m1.1.1.3.2" xref="S5.T6.1.1.1.1.1.m1.1.1.3.2.cmml">7.76</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T6.1.1.1.1.1.m1.1b"><apply id="S5.T6.1.1.1.1.1.m1.1.1.cmml" xref="S5.T6.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T6.1.1.1.1.1.m1.1.1.1.cmml" xref="S5.T6.1.1.1.1.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T6.1.1.1.1.1.m1.1.1.2.cmml" xref="S5.T6.1.1.1.1.1.m1.1.1.2">48.10</cn><apply id="S5.T6.1.1.1.1.1.m1.1.1.3.cmml" xref="S5.T6.1.1.1.1.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T6.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S5.T6.1.1.1.1.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T6.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S5.T6.1.1.1.1.1.m1.1.1.3.2">7.76</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.1.1.1.1.1.m1.1c">\mathbf{48.10}_{\pm 7.76}</annotation></semantics></math></th>
<td id="S5.T6.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="S5.T6.2.2.2.2.2.m1.1" class="ltx_Math" alttext="47.37_{\pm 8.47}" display="inline"><semantics id="S5.T6.2.2.2.2.2.m1.1a"><msub id="S5.T6.2.2.2.2.2.m1.1.1" xref="S5.T6.2.2.2.2.2.m1.1.1.cmml"><mn id="S5.T6.2.2.2.2.2.m1.1.1.2" xref="S5.T6.2.2.2.2.2.m1.1.1.2.cmml">47.37</mn><mrow id="S5.T6.2.2.2.2.2.m1.1.1.3" xref="S5.T6.2.2.2.2.2.m1.1.1.3.cmml"><mo id="S5.T6.2.2.2.2.2.m1.1.1.3a" xref="S5.T6.2.2.2.2.2.m1.1.1.3.cmml">±</mo><mn id="S5.T6.2.2.2.2.2.m1.1.1.3.2" xref="S5.T6.2.2.2.2.2.m1.1.1.3.2.cmml">8.47</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T6.2.2.2.2.2.m1.1b"><apply id="S5.T6.2.2.2.2.2.m1.1.1.cmml" xref="S5.T6.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T6.2.2.2.2.2.m1.1.1.1.cmml" xref="S5.T6.2.2.2.2.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T6.2.2.2.2.2.m1.1.1.2.cmml" xref="S5.T6.2.2.2.2.2.m1.1.1.2">47.37</cn><apply id="S5.T6.2.2.2.2.2.m1.1.1.3.cmml" xref="S5.T6.2.2.2.2.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T6.2.2.2.2.2.m1.1.1.3.1.cmml" xref="S5.T6.2.2.2.2.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T6.2.2.2.2.2.m1.1.1.3.2.cmml" xref="S5.T6.2.2.2.2.2.m1.1.1.3.2">8.47</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.2.2.2.2.2.m1.1c">47.37_{\pm 8.47}</annotation></semantics></math></td>
<td id="S5.T6.3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><math id="S5.T6.3.3.3.3.3.m1.1" class="ltx_Math" alttext="46.98_{\pm 8.10}" display="inline"><semantics id="S5.T6.3.3.3.3.3.m1.1a"><msub id="S5.T6.3.3.3.3.3.m1.1.1" xref="S5.T6.3.3.3.3.3.m1.1.1.cmml"><mn id="S5.T6.3.3.3.3.3.m1.1.1.2" xref="S5.T6.3.3.3.3.3.m1.1.1.2.cmml">46.98</mn><mrow id="S5.T6.3.3.3.3.3.m1.1.1.3" xref="S5.T6.3.3.3.3.3.m1.1.1.3.cmml"><mo id="S5.T6.3.3.3.3.3.m1.1.1.3a" xref="S5.T6.3.3.3.3.3.m1.1.1.3.cmml">±</mo><mn id="S5.T6.3.3.3.3.3.m1.1.1.3.2" xref="S5.T6.3.3.3.3.3.m1.1.1.3.2.cmml">8.10</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T6.3.3.3.3.3.m1.1b"><apply id="S5.T6.3.3.3.3.3.m1.1.1.cmml" xref="S5.T6.3.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T6.3.3.3.3.3.m1.1.1.1.cmml" xref="S5.T6.3.3.3.3.3.m1.1.1">subscript</csymbol><cn type="float" id="S5.T6.3.3.3.3.3.m1.1.1.2.cmml" xref="S5.T6.3.3.3.3.3.m1.1.1.2">46.98</cn><apply id="S5.T6.3.3.3.3.3.m1.1.1.3.cmml" xref="S5.T6.3.3.3.3.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T6.3.3.3.3.3.m1.1.1.3.1.cmml" xref="S5.T6.3.3.3.3.3.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T6.3.3.3.3.3.m1.1.1.3.2.cmml" xref="S5.T6.3.3.3.3.3.m1.1.1.3.2">8.10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.3.3.3.3.3.m1.1c">46.98_{\pm 8.10}</annotation></semantics></math></td>
<td id="S5.T6.4.4.4.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="S5.T6.4.4.4.4.4.m1.1" class="ltx_Math" alttext="44.19_{\pm 8.13}" display="inline"><semantics id="S5.T6.4.4.4.4.4.m1.1a"><msub id="S5.T6.4.4.4.4.4.m1.1.1" xref="S5.T6.4.4.4.4.4.m1.1.1.cmml"><mn id="S5.T6.4.4.4.4.4.m1.1.1.2" xref="S5.T6.4.4.4.4.4.m1.1.1.2.cmml">44.19</mn><mrow id="S5.T6.4.4.4.4.4.m1.1.1.3" xref="S5.T6.4.4.4.4.4.m1.1.1.3.cmml"><mo id="S5.T6.4.4.4.4.4.m1.1.1.3a" xref="S5.T6.4.4.4.4.4.m1.1.1.3.cmml">±</mo><mn id="S5.T6.4.4.4.4.4.m1.1.1.3.2" xref="S5.T6.4.4.4.4.4.m1.1.1.3.2.cmml">8.13</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T6.4.4.4.4.4.m1.1b"><apply id="S5.T6.4.4.4.4.4.m1.1.1.cmml" xref="S5.T6.4.4.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T6.4.4.4.4.4.m1.1.1.1.cmml" xref="S5.T6.4.4.4.4.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T6.4.4.4.4.4.m1.1.1.2.cmml" xref="S5.T6.4.4.4.4.4.m1.1.1.2">44.19</cn><apply id="S5.T6.4.4.4.4.4.m1.1.1.3.cmml" xref="S5.T6.4.4.4.4.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T6.4.4.4.4.4.m1.1.1.3.1.cmml" xref="S5.T6.4.4.4.4.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T6.4.4.4.4.4.m1.1.1.3.2.cmml" xref="S5.T6.4.4.4.4.4.m1.1.1.3.2">8.13</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.4.4.4.4.4.m1.1c">44.19_{\pm 8.13}</annotation></semantics></math></td>
<td id="S5.T6.5.5.5.5.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="S5.T6.5.5.5.5.5.m1.1" class="ltx_Math" alttext="47.99_{\pm 8.59}" display="inline"><semantics id="S5.T6.5.5.5.5.5.m1.1a"><msub id="S5.T6.5.5.5.5.5.m1.1.1" xref="S5.T6.5.5.5.5.5.m1.1.1.cmml"><mn id="S5.T6.5.5.5.5.5.m1.1.1.2" xref="S5.T6.5.5.5.5.5.m1.1.1.2.cmml">47.99</mn><mrow id="S5.T6.5.5.5.5.5.m1.1.1.3" xref="S5.T6.5.5.5.5.5.m1.1.1.3.cmml"><mo id="S5.T6.5.5.5.5.5.m1.1.1.3a" xref="S5.T6.5.5.5.5.5.m1.1.1.3.cmml">±</mo><mn id="S5.T6.5.5.5.5.5.m1.1.1.3.2" xref="S5.T6.5.5.5.5.5.m1.1.1.3.2.cmml">8.59</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T6.5.5.5.5.5.m1.1b"><apply id="S5.T6.5.5.5.5.5.m1.1.1.cmml" xref="S5.T6.5.5.5.5.5.m1.1.1"><csymbol cd="ambiguous" id="S5.T6.5.5.5.5.5.m1.1.1.1.cmml" xref="S5.T6.5.5.5.5.5.m1.1.1">subscript</csymbol><cn type="float" id="S5.T6.5.5.5.5.5.m1.1.1.2.cmml" xref="S5.T6.5.5.5.5.5.m1.1.1.2">47.99</cn><apply id="S5.T6.5.5.5.5.5.m1.1.1.3.cmml" xref="S5.T6.5.5.5.5.5.m1.1.1.3"><csymbol cd="latexml" id="S5.T6.5.5.5.5.5.m1.1.1.3.1.cmml" xref="S5.T6.5.5.5.5.5.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T6.5.5.5.5.5.m1.1.1.3.2.cmml" xref="S5.T6.5.5.5.5.5.m1.1.1.3.2">8.59</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.5.5.5.5.5.m1.1c">47.99_{\pm 8.59}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this work, we studied two research questions of where and how to personalize a ViT in federated learning. We conducted an empirical study to reveal that the self-attention and classification layers are the most sensitive layers for personalization. Based on that, we proposed FedPerfix, a novel method that introduces Prefixes with parallel attention to personalize the self-attention layers. Through extensive experiments on various datasets with different degrees of data heterogeneity, we demonstrated that FedPerfix achieves state-of-the-art performance while also reducing resource requirements. Our work focuses on ViTs and represents a shift in attention from the extensively researched CNNs, serving as inspiration for further investigation.
</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Acknowledgement</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">This work is partially supported by the NSF/Intel Partnership on MLWiNS under Grant No. 2003198.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Manoj Ghuhan Arivazhagan, Vinay Aggarwal, Aaditya Kumar Singh, and Sunav
Choudhary.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Federated Learning with Personalization Layers, Dec. 2019.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">arXiv:1912.00818 [cs, stat].
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Han Cai, Chuang Gan, Ligeng Zhu, and Song Han.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">TinyTL: Reduce Memory, Not Parameters for Efficient
On-Device Learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">,
volume 33, pages 11285–11297. Curran Associates, Inc., 2020.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Nicolas Carion, Francisco Massa, Gabriel Synnaeve, Nicolas Usunier, Alexander
Kirillov, and Sergey Zagoruyko.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">End-to-End Object Detection with Transformers, May 2020.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">arXiv:2005.12872 [cs].
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Hong-You Chen and Wei-Lun Chao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">ON BRIDGING GENERIC AND PERSONALIZED FEDERATED LEARNING
FOR IMAGE CLASSIFICATION.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">2022.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Liam Collins, Hamed Hassani, Aryan Mokhtari, and Sanjay Shakkottai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Exploiting Shared Representations for Personalized Federated
Learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 38th International Conference on
Machine Learning</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, pages 2089–2099. PMLR, July 2021.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.6.1" class="ltx_text" style="font-size:90%;">ISSN: 2640-3498.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Yuyang Deng, Mohammad Mahdi Kamani, and Mehrdad Mahdavi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Adaptive Personalized Federated Learning, Nov. 2020.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">arXiv:2003.13461 [cs, stat].
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Canh T. Dinh, Nguyen H. Tran, and Tuan Dung Nguyen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Personalized Federated Learning with Moreau Envelopes, Jan.
2022.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">arXiv:2006.08848 [cs, stat].
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, Jakob Uszkoreit, and Neil Houlsby.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">An Image is Worth 16x16 Words: Transformers for Image
Recognition at Scale, June 2021.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">arXiv:2010.11929 [cs].
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Personalized Federated Learning: A Meta-Learning
Approach, Oct. 2020.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">arXiv:2002.07948 [cs, math, stat].
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Junxian He, Chunting Zhou, Xuezhe Ma, Taylor Berg-Kirkpatrick, and Graham
Neubig.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Towards a Unified View of Parameter-Efficient Transfer
Learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">Feb. 2022.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, pages 770–778, 2016.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Edward J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean
Wang, Lu Wang, and Weizhu Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">LoRA: Low-Rank Adaptation of Large Language Models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">June 2021.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Yutao Huang, Lingyang Chu, Zirui Zhou, Lanjun Wang, Jiangchuan Liu, Jian Pei,
and Yong Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Personalized Cross-Silo Federated Learning on Non-IID
Data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial Intelligence</span><span id="bib.bib13.4.2" class="ltx_text" style="font-size:90%;">,
35(9):7865–7873, May 2021.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.5.1" class="ltx_text" style="font-size:90%;">Number: 9.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Sergey Ioffe and Christian Szegedy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Batch Normalization: Accelerating Deep Network Training by
Reducing Internal Covariate Shift, Mar. 2015.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">arXiv:1502.03167 [cs].
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Menglin Jia, Luming Tang, Bor-Chun Chen, Claire Cardie, Serge Belongie, Bharath
Hariharan, and Ser-Nam Lim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Visual Prompt Tuning, July 2022.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">arXiv:2203.12119 [cs].
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Alex Krizhevsky.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Learning Multiple Layers of Features from Tiny Images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">University of Toronto</span><span id="bib.bib16.4.2" class="ltx_text" style="font-size:90%;">, 2012.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Qinbin Li, Bingsheng He, and Dawn Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Model-Contrastive Federated Learning, Mar. 2021.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">arXiv:2103.16257 [cs].
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Tian Li, Shengyuan Hu, Ahmad Beirami, and Virginia Smith.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Ditto: Fair and Robust Federated Learning Through
Personalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 38th International Conference on
Machine Learning</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, pages 6357–6368. PMLR, July 2021.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.6.1" class="ltx_text" style="font-size:90%;">ISSN: 2640-3498.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Xiaoxiao Li, Meirui Jiang, Xiaofei Zhang, Michael Kamp, and Qi Dou.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">FedBN: Federated Learning on Non-IID Features via Local
Batch Normalization, May 2021.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">arXiv:2102.07623 [cs].
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Xin-Chun Li, De-Chuan Zhan, Yunfeng Shao, Bingshuai Li, and Shaoming Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">FedPHP: Federated Personalization with Inherited Private
Models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In Nuria Oliver, Fernando Pérez-Cruz, Stefan Kramer, Jesse Read, and
Jose A. Lozano, editors, </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Machine Learning and Knowledge Discovery
in Databases. Research Track</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, Lecture Notes in Computer Science,
pages 587–602, Cham, 2021. Springer International Publishing.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Xiang Lisa Li and Percy Liang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Prefix-Tuning: Optimizing Continuous Prompts for
Generation, Jan. 2021.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">arXiv:2101.00190 [cs].
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Ze Liu, Yutong Lin, Yue Cao, Han Hu, Yixuan Wei, Zheng Zhang, Stephen Lin, and
Baining Guo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Swin Transformer: Hierarchical Vision Transformer using
Shifted Windows, Aug. 2021.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">arXiv:2103.14030 [cs].
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Ze Liu, Jia Ning, Yue Cao, Yixuan Wei, Zheng Zhang, Stephen Lin, and Han Hu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Video Swin Transformer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv:2106.13230 [cs]</span><span id="bib.bib23.4.2" class="ltx_text" style="font-size:90%;">, June 2021.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.5.1" class="ltx_text" style="font-size:90%;">arXiv: 2106.13230.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Jun Luo, Matias Mendieta, Chen Chen, and Shandong Wu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">PGFed: Personalize Each Client’s Global Objective for
Federated Learning, Dec. 2022.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">arXiv:2212.01448 [cs].
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Yishay Mansour, Mehryar Mohri, Jae Ro, and Ananda Theertha Suresh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Three Approaches for Personalization with Applications to
Federated Learning, July 2020.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">arXiv:2002.10619 [cs, stat].
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
H. Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise
Agüera y Arcas.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Communication-Efficient Learning of Deep Networks from
Decentralized Data, Feb. 2017.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">arXiv:1602.05629 [cs].
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Matias Mendieta, Taojiannan Yang, Pu Wang, Minwoo Lee, Zhengming Ding, and Chen
Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Local Learning Matters: Rethinking Data Heterogeneity in
Federated Learning, Apr. 2022.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">arXiv:2111.14213 [cs].
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Jaehoon Oh, Sangmook Kim, and Se-Young Yun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">FedBABU: Towards Enhanced Representation for Federated
Image Classification, Mar. 2022.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">arXiv:2106.06042 [cs].
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory
Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, Alban
Desmaison, Andreas Kopf, Edward Yang, Zachary DeVito, Martin Raison, Alykhan
Tejani, Sasank Chilamkurthy, Benoit Steiner, Lu Fang, Junjie Bai, and Soumith
Chintala.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">PyTorch: An imperative style, high-performance deep learning
library.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems 32</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, pages
8024–8035. Curran Associates, Inc., 2019.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Jonas Pfeiffer, Aishwarya Kamath, Andreas Rücklé, Kyunghyun Cho, and Iryna
Gurevych.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">AdapterFusion: Non-Destructive Task Composition for
Transfer Learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 16th Conference of the European
Chapter of the Association for Computational Linguistics: Main
Volume</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, pages 487–503, Online, 2021. Association for Computational
Linguistics.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Jonas Pfeiffer, Andreas Rücklé, Clifton Poth, Aishwarya Kamath, Ivan Vulić,
Sebastian Ruder, Kyunghyun Cho, and Iryna Gurevych.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">AdapterHub: A Framework for Adapting Transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 2020 Conference on Empirical Methods
in Natural Language Processing: System Demonstrations</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, pages
46–54, Online, 2020. Association for Computational Linguistics.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Krishna Pillutla, Kshitiz Malik, Abdel-Rahman Mohamed, Mike Rabbat, Maziar
Sanjabi, and Lin Xiao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Federated Learning with Partial Model Personalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 39th International Conference on
Machine Learning</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, pages 17716–17758. PMLR, June 2022.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.6.1" class="ltx_text" style="font-size:90%;">ISSN: 2640-3498.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Liangqiong Qu, Yuyin Zhou, Paul Pu Liang, Yingda Xia, Feifei Wang, Ehsan Adeli,
Li Fei-Fei, and Daniel Rubin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Rethinking Architecture Design for Tackling Data
Heterogeneity in Federated Learning, Apr. 2022.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">arXiv:2106.06047 [cs].
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Sebastian Ruder.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">An overview of gradient descent optimization algorithms, June 2017.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">arXiv:1609.04747 [cs].
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Aviv Shamsian, Aviv Navon, Ethan Fetaya, and Gal Chechik.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Personalized Federated Learning using Hypernetworks, Mar. 2021.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text" style="font-size:90%;">arXiv:2103.04628 [cs].
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Guangyu Sun, Matias Mendieta, Taojiannan Yang, and Chen Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Conquering the Communication Constraints to Enable Large
Pre-Trained Models in Federated Learning, Nov. 2022.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text" style="font-size:90%;">arXiv:2210.01708 [cs].
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Yue Tan, Guodong Long, Lu Liu, Tianyi Zhou, Qinghua Lu, Jing Jiang, and Chengqi
Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">FedProto: Federated Prototype Learning across Heterogeneous
Clients.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial Intelligence</span><span id="bib.bib37.4.2" class="ltx_text" style="font-size:90%;">,
36(8):8432–8440, June 2022.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.5.1" class="ltx_text" style="font-size:90%;">Number: 8.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Hugo Touvron, Matthieu Cord, Matthijs Douze, Francisco Massa, Alexandre
Sablayrolles, and Herve Jegou.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Training data-efficient image transformers &amp;amp; distillation
through attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib38.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International conference on machine learning</span><span id="bib.bib38.5.3" class="ltx_text" style="font-size:90%;">, volume 139,
pages 10347–10357, July 2021.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Hemanth Venkateswara, Jose Eusebio, Shayok Chakraborty, and Sethuraman
Panchanathan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Deep hashing network for unsupervised domain adaptation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib39.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib39.5.3" class="ltx_text" style="font-size:90%;">, pages 5018–5027, 2017.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Ross Wightman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">PyTorch Image Models, 2019.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text" style="font-size:90%;">Publication Title: GitHub repository.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Jiancheng Yang, Rui Shi, Donglai Wei, Zequan Liu, Lin Zhao, Bilian Ke,
Hanspeter Pfister, and Bingbing Ni.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">MedMNIST v2-A large-scale lightweight benchmark for 2D and 3D
biomedical image classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Scientific Data</span><span id="bib.bib41.4.2" class="ltx_text" style="font-size:90%;">, 10(1):41, 2023.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.5.1" class="ltx_text" style="font-size:90%;">Publisher: Nature Publishing Group UK London.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Bruce X. B. Yu, Jianlong Chang, Lingbo Liu, Qi Tian, and Chang Wen Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">Towards a Unified View on Visual Parameter-Efficient
Transfer Learning, Oct. 2022.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">arXiv:2210.00788 [cs].
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Hao Zhang, Feng Li, Shilong Liu, Lei Zhang, Hang Su, Jun Zhu, Lionel M. Ni, and
Heung-Yeung Shum.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">DINO: DETR with Improved DeNoising Anchor Boxes for
End-to-End Object Detection, Apr. 2022.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text" style="font-size:90%;">arXiv:2203.03605 [cs] version: 3.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Michael Zhang, Karan Sapra, Sanja Fidler, Serena Yeung, and Jose M. Alvarez.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Personalized Federated Learning with First Order Model
Optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text" style="font-size:90%;">Jan. 2023.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure id="S7.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S7.F4.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:143.1pt;">
<img src="/html/2308.09160/assets/x4.png" id="S7.F4.1.g1" class="ltx_graphics ltx_img_landscape" width="460" height="368" alt="Refer to caption">
<p id="S7.F4.1.1" class="ltx_p ltx_align_center"><span id="S7.F4.1.1.1" class="ltx_text" style="font-size:80%;">(a) CIFAR-100</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S7.F4.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:143.1pt;">
<img src="/html/2308.09160/assets/x5.png" id="S7.F4.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="362" alt="Refer to caption">
<p id="S7.F4.2.1" class="ltx_p ltx_align_center"><span id="S7.F4.2.1.1" class="ltx_text" style="font-size:80%;">(b) OrganAMNIST</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S7.F4.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:143.1pt;">
<img src="/html/2308.09160/assets/x6.png" id="S7.F4.3.g1" class="ltx_graphics ltx_img_landscape" width="461" height="362" alt="Refer to caption">
<p id="S7.F4.3.1" class="ltx_p ltx_align_center"><span id="S7.F4.3.1.1" class="ltx_text" style="font-size:80%;">(c) Office-Home</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Data Partitioning of each dataset.</figcaption>
</figure>
<figure id="S7.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S7.F5.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:143.1pt;">
<img src="/html/2308.09160/assets/x7.png" id="S7.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="344" alt="Refer to caption">
<p id="S7.F5.1.1" class="ltx_p ltx_align_center"><span id="S7.F5.1.1.1" class="ltx_text" style="font-size:80%;">(a) Hidden Dimension vs. Performance</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S7.F5.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:143.1pt;">
<img src="/html/2308.09160/assets/x8.png" id="S7.F5.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="344" alt="Refer to caption">
<p id="S7.F5.2.1" class="ltx_p ltx_align_center"><span id="S7.F5.2.1.1" class="ltx_text" style="font-size:80%;">(b) Scale vs. Performance</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S7.F5.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:143.1pt;">
<img src="/html/2308.09160/assets/x9.png" id="S7.F5.3.g1" class="ltx_graphics ltx_img_landscape" width="461" height="344" alt="Refer to caption">
<p id="S7.F5.3.1" class="ltx_p ltx_align_center"><span id="S7.F5.3.1.1" class="ltx_text" style="font-size:80%;">(c) Prefix Depth vs. Performance</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Impact of each hyperparameter on CIFAR-100.</figcaption>
</figure>
<section id="Ax1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">Supplementary</h2>

<div id="Ax1.p1" class="ltx_para">
<p id="Ax1.p1.1" class="ltx_p">The supplementary is organized in the following sections:</p>
<ul id="Ax1.I1" class="ltx_itemize">
<li id="Ax1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ax1.I1.i1.p1" class="ltx_para">
<p id="Ax1.I1.i1.p1.1" class="ltx_p">Section <a href="#A1" title="Appendix A Experiment Details ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>: More details about the experiments.</p>
</div>
</li>
<li id="Ax1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ax1.I1.i2.p1" class="ltx_para">
<p id="Ax1.I1.i2.p1.1" class="ltx_p">Section <a href="#A2" title="Appendix B Connection between APFL and FedPerfix ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>: Connection and comparison between APFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and FedPerfix.</p>
</div>
</li>
<li id="Ax1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ax1.I1.i3.p1" class="ltx_para">
<p id="Ax1.I1.i3.p1.1" class="ltx_p">Section <a href="#A3" title="Appendix C More Ablation Study ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>: More hyperparameter ablations of FedPerfix.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Experiment Details</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Visualization of Data Partitioning</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.3" class="ltx_p">We partition the data in each dataset with Dirichlet distributions, which is a common setting in previous work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. The details of the distributions are visualized in Figure <a href="#S7.F4" title="Figure 4 ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Specifically, the number of clients <math id="A1.SS1.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A1.SS1.p1.1.m1.1a"><mi id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">N</annotation></semantics></math>, number of classes <math id="A1.SS1.p1.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A1.SS1.p1.2.m2.1a"><mi id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><ci id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">C</annotation></semantics></math>, and the parameter of Dirichlet distribution <math id="A1.SS1.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A1.SS1.p1.3.m3.1a"><mi id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><ci id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">\alpha</annotation></semantics></math> for each dataset are as follows:</p>
<ul id="A1.I1" class="ltx_itemize">
<li id="A1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i1.p1" class="ltx_para">
<p id="A1.I1.i1.p1.1" class="ltx_p">CIFAR-100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>: <math id="A1.I1.i1.p1.1.m1.2" class="ltx_Math" alttext="N=64,C=100,\alpha=0.1" display="inline"><semantics id="A1.I1.i1.p1.1.m1.2a"><mrow id="A1.I1.i1.p1.1.m1.2.2.2" xref="A1.I1.i1.p1.1.m1.2.2.3.cmml"><mrow id="A1.I1.i1.p1.1.m1.1.1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.1.1.cmml"><mi id="A1.I1.i1.p1.1.m1.1.1.1.1.2" xref="A1.I1.i1.p1.1.m1.1.1.1.1.2.cmml">N</mi><mo id="A1.I1.i1.p1.1.m1.1.1.1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="A1.I1.i1.p1.1.m1.1.1.1.1.3" xref="A1.I1.i1.p1.1.m1.1.1.1.1.3.cmml">64</mn></mrow><mo id="A1.I1.i1.p1.1.m1.2.2.2.3" xref="A1.I1.i1.p1.1.m1.2.2.3a.cmml">,</mo><mrow id="A1.I1.i1.p1.1.m1.2.2.2.2.2" xref="A1.I1.i1.p1.1.m1.2.2.2.2.3.cmml"><mrow id="A1.I1.i1.p1.1.m1.2.2.2.2.1.1" xref="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.cmml"><mi id="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.2" xref="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.2.cmml">C</mi><mo id="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.1" xref="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.1.cmml">=</mo><mn id="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.3" xref="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.3.cmml">100</mn></mrow><mo id="A1.I1.i1.p1.1.m1.2.2.2.2.2.3" xref="A1.I1.i1.p1.1.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A1.I1.i1.p1.1.m1.2.2.2.2.2.2" xref="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.cmml"><mi id="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.2" xref="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.2.cmml">α</mi><mo id="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.1" xref="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.1.cmml">=</mo><mn id="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.3" xref="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.3.cmml">0.1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.2b"><apply id="A1.I1.i1.p1.1.m1.2.2.3.cmml" xref="A1.I1.i1.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="A1.I1.i1.p1.1.m1.2.2.3a.cmml" xref="A1.I1.i1.p1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A1.I1.i1.p1.1.m1.1.1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1.1.1"><eq id="A1.I1.i1.p1.1.m1.1.1.1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1.1.1.1"></eq><ci id="A1.I1.i1.p1.1.m1.1.1.1.1.2.cmml" xref="A1.I1.i1.p1.1.m1.1.1.1.1.2">𝑁</ci><cn type="integer" id="A1.I1.i1.p1.1.m1.1.1.1.1.3.cmml" xref="A1.I1.i1.p1.1.m1.1.1.1.1.3">64</cn></apply><apply id="A1.I1.i1.p1.1.m1.2.2.2.2.3.cmml" xref="A1.I1.i1.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.I1.i1.p1.1.m1.2.2.2.2.3a.cmml" xref="A1.I1.i1.p1.1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.cmml" xref="A1.I1.i1.p1.1.m1.2.2.2.2.1.1"><eq id="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.1"></eq><ci id="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.2.cmml" xref="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.2">𝐶</ci><cn type="integer" id="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.3.cmml" xref="A1.I1.i1.p1.1.m1.2.2.2.2.1.1.3">100</cn></apply><apply id="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.cmml" xref="A1.I1.i1.p1.1.m1.2.2.2.2.2.2"><eq id="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.1.cmml" xref="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.1"></eq><ci id="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.2">𝛼</ci><cn type="float" id="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.3.cmml" xref="A1.I1.i1.p1.1.m1.2.2.2.2.2.2.3">0.1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.2c">N=64,C=100,\alpha=0.1</annotation></semantics></math>.</p>
</div>
</li>
<li id="A1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i2.p1" class="ltx_para">
<p id="A1.I1.i2.p1.1" class="ltx_p">OrganAMNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>: <math id="A1.I1.i2.p1.1.m1.2" class="ltx_Math" alttext="N=64,C=11,\alpha=0.5" display="inline"><semantics id="A1.I1.i2.p1.1.m1.2a"><mrow id="A1.I1.i2.p1.1.m1.2.2.2" xref="A1.I1.i2.p1.1.m1.2.2.3.cmml"><mrow id="A1.I1.i2.p1.1.m1.1.1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.1.1.cmml"><mi id="A1.I1.i2.p1.1.m1.1.1.1.1.2" xref="A1.I1.i2.p1.1.m1.1.1.1.1.2.cmml">N</mi><mo id="A1.I1.i2.p1.1.m1.1.1.1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="A1.I1.i2.p1.1.m1.1.1.1.1.3" xref="A1.I1.i2.p1.1.m1.1.1.1.1.3.cmml">64</mn></mrow><mo id="A1.I1.i2.p1.1.m1.2.2.2.3" xref="A1.I1.i2.p1.1.m1.2.2.3a.cmml">,</mo><mrow id="A1.I1.i2.p1.1.m1.2.2.2.2.2" xref="A1.I1.i2.p1.1.m1.2.2.2.2.3.cmml"><mrow id="A1.I1.i2.p1.1.m1.2.2.2.2.1.1" xref="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.cmml"><mi id="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.2" xref="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.2.cmml">C</mi><mo id="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.1" xref="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.1.cmml">=</mo><mn id="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.3" xref="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.3.cmml">11</mn></mrow><mo id="A1.I1.i2.p1.1.m1.2.2.2.2.2.3" xref="A1.I1.i2.p1.1.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A1.I1.i2.p1.1.m1.2.2.2.2.2.2" xref="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.cmml"><mi id="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.2" xref="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.2.cmml">α</mi><mo id="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.1" xref="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.1.cmml">=</mo><mn id="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.3" xref="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.3.cmml">0.5</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.1.m1.2b"><apply id="A1.I1.i2.p1.1.m1.2.2.3.cmml" xref="A1.I1.i2.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="A1.I1.i2.p1.1.m1.2.2.3a.cmml" xref="A1.I1.i2.p1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A1.I1.i2.p1.1.m1.1.1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1.1"><eq id="A1.I1.i2.p1.1.m1.1.1.1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1.1.1"></eq><ci id="A1.I1.i2.p1.1.m1.1.1.1.1.2.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1.1.2">𝑁</ci><cn type="integer" id="A1.I1.i2.p1.1.m1.1.1.1.1.3.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1.1.3">64</cn></apply><apply id="A1.I1.i2.p1.1.m1.2.2.2.2.3.cmml" xref="A1.I1.i2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.I1.i2.p1.1.m1.2.2.2.2.3a.cmml" xref="A1.I1.i2.p1.1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.cmml" xref="A1.I1.i2.p1.1.m1.2.2.2.2.1.1"><eq id="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.1"></eq><ci id="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.2.cmml" xref="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.2">𝐶</ci><cn type="integer" id="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.3.cmml" xref="A1.I1.i2.p1.1.m1.2.2.2.2.1.1.3">11</cn></apply><apply id="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.cmml" xref="A1.I1.i2.p1.1.m1.2.2.2.2.2.2"><eq id="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.1.cmml" xref="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.1"></eq><ci id="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.2">𝛼</ci><cn type="float" id="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.3.cmml" xref="A1.I1.i2.p1.1.m1.2.2.2.2.2.2.3">0.5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.1.m1.2c">N=64,C=11,\alpha=0.5</annotation></semantics></math>.</p>
</div>
</li>
<li id="A1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i3.p1" class="ltx_para">
<p id="A1.I1.i3.p1.1" class="ltx_p">Office-Home <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>: <math id="A1.I1.i3.p1.1.m1.2" class="ltx_Math" alttext="N=16,C=65,\alpha=1.0" display="inline"><semantics id="A1.I1.i3.p1.1.m1.2a"><mrow id="A1.I1.i3.p1.1.m1.2.2.2" xref="A1.I1.i3.p1.1.m1.2.2.3.cmml"><mrow id="A1.I1.i3.p1.1.m1.1.1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.1.1.cmml"><mi id="A1.I1.i3.p1.1.m1.1.1.1.1.2" xref="A1.I1.i3.p1.1.m1.1.1.1.1.2.cmml">N</mi><mo id="A1.I1.i3.p1.1.m1.1.1.1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="A1.I1.i3.p1.1.m1.1.1.1.1.3" xref="A1.I1.i3.p1.1.m1.1.1.1.1.3.cmml">16</mn></mrow><mo id="A1.I1.i3.p1.1.m1.2.2.2.3" xref="A1.I1.i3.p1.1.m1.2.2.3a.cmml">,</mo><mrow id="A1.I1.i3.p1.1.m1.2.2.2.2.2" xref="A1.I1.i3.p1.1.m1.2.2.2.2.3.cmml"><mrow id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.cmml"><mi id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.2" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.2.cmml">C</mi><mo id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.cmml">=</mo><mn id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.3" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.3.cmml">65</mn></mrow><mo id="A1.I1.i3.p1.1.m1.2.2.2.2.2.3" xref="A1.I1.i3.p1.1.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A1.I1.i3.p1.1.m1.2.2.2.2.2.2" xref="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.cmml"><mi id="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.2" xref="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.2.cmml">α</mi><mo id="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.1" xref="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.1.cmml">=</mo><mn id="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.3" xref="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.3.cmml">1.0</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.1.m1.2b"><apply id="A1.I1.i3.p1.1.m1.2.2.3.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="A1.I1.i3.p1.1.m1.2.2.3a.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A1.I1.i3.p1.1.m1.1.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1"><eq id="A1.I1.i3.p1.1.m1.1.1.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1.1"></eq><ci id="A1.I1.i3.p1.1.m1.1.1.1.1.2.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1.2">𝑁</ci><cn type="integer" id="A1.I1.i3.p1.1.m1.1.1.1.1.3.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1.1.3">16</cn></apply><apply id="A1.I1.i3.p1.1.m1.2.2.2.2.3.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.I1.i3.p1.1.m1.2.2.2.2.3a.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1"><eq id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.1"></eq><ci id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.2">𝐶</ci><cn type="integer" id="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.3.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.1.1.3">65</cn></apply><apply id="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.2.2"><eq id="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.1"></eq><ci id="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.2">𝛼</ci><cn type="float" id="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.3.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2.2.2.2.3">1.0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.1.m1.2c">N=16,C=65,\alpha=1.0</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Hyperparameters</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p">We perform experiments based on the implementation from an existing
federated learning platform. For each method, we tune the hyperparameters in a range and report the result with the optimal hyperparameters. The range and optimal value of the hyperparameters are as follows:</p>
</div>
<div id="A1.SS2.p2" class="ltx_para">
<p id="A1.SS2.p2.3" class="ltx_p"><span id="A1.SS2.p2.3.1" class="ltx_text ltx_font_bold">FedAVG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite></span>: Learning rate (<math id="A1.SS2.p2.1.m1.1" class="ltx_Math" alttext="lr" display="inline"><semantics id="A1.SS2.p2.1.m1.1a"><mrow id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml"><mi id="A1.SS2.p2.1.m1.1.1.2" xref="A1.SS2.p2.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p2.1.m1.1.1.1" xref="A1.SS2.p2.1.m1.1.1.1.cmml">​</mo><mi id="A1.SS2.p2.1.m1.1.1.3" xref="A1.SS2.p2.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><apply id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1"><times id="A1.SS2.p2.1.m1.1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1.1"></times><ci id="A1.SS2.p2.1.m1.1.1.2.cmml" xref="A1.SS2.p2.1.m1.1.1.2">𝑙</ci><ci id="A1.SS2.p2.1.m1.1.1.3.cmml" xref="A1.SS2.p2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">lr</annotation></semantics></math>) is searched from <math id="A1.SS2.p2.2.m2.3" class="ltx_Math" alttext="\{0.001,0.01,0.1\}" display="inline"><semantics id="A1.SS2.p2.2.m2.3a"><mrow id="A1.SS2.p2.2.m2.3.4.2" xref="A1.SS2.p2.2.m2.3.4.1.cmml"><mo stretchy="false" id="A1.SS2.p2.2.m2.3.4.2.1" xref="A1.SS2.p2.2.m2.3.4.1.cmml">{</mo><mn id="A1.SS2.p2.2.m2.1.1" xref="A1.SS2.p2.2.m2.1.1.cmml">0.001</mn><mo id="A1.SS2.p2.2.m2.3.4.2.2" xref="A1.SS2.p2.2.m2.3.4.1.cmml">,</mo><mn id="A1.SS2.p2.2.m2.2.2" xref="A1.SS2.p2.2.m2.2.2.cmml">0.01</mn><mo id="A1.SS2.p2.2.m2.3.4.2.3" xref="A1.SS2.p2.2.m2.3.4.1.cmml">,</mo><mn id="A1.SS2.p2.2.m2.3.3" xref="A1.SS2.p2.2.m2.3.3.cmml">0.1</mn><mo stretchy="false" id="A1.SS2.p2.2.m2.3.4.2.4" xref="A1.SS2.p2.2.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.3b"><set id="A1.SS2.p2.2.m2.3.4.1.cmml" xref="A1.SS2.p2.2.m2.3.4.2"><cn type="float" id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1">0.001</cn><cn type="float" id="A1.SS2.p2.2.m2.2.2.cmml" xref="A1.SS2.p2.2.m2.2.2">0.01</cn><cn type="float" id="A1.SS2.p2.2.m2.3.3.cmml" xref="A1.SS2.p2.2.m2.3.3">0.1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.3c">\{0.001,0.01,0.1\}</annotation></semantics></math>. The optimal value is <math id="A1.SS2.p2.3.m3.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A1.SS2.p2.3.m3.1a"><mn id="A1.SS2.p2.3.m3.1.1" xref="A1.SS2.p2.3.m3.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m3.1b"><cn type="float" id="A1.SS2.p2.3.m3.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m3.1c">0.01</annotation></semantics></math>.</p>
</div>
<div id="A1.SS2.p3" class="ltx_para">
<p id="A1.SS2.p3.3" class="ltx_p"><span id="A1.SS2.p3.3.1" class="ltx_text ltx_font_bold">Local</span>: <math id="A1.SS2.p3.1.m1.1" class="ltx_Math" alttext="lr" display="inline"><semantics id="A1.SS2.p3.1.m1.1a"><mrow id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml"><mi id="A1.SS2.p3.1.m1.1.1.2" xref="A1.SS2.p3.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p3.1.m1.1.1.1" xref="A1.SS2.p3.1.m1.1.1.1.cmml">​</mo><mi id="A1.SS2.p3.1.m1.1.1.3" xref="A1.SS2.p3.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><apply id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1"><times id="A1.SS2.p3.1.m1.1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1.1"></times><ci id="A1.SS2.p3.1.m1.1.1.2.cmml" xref="A1.SS2.p3.1.m1.1.1.2">𝑙</ci><ci id="A1.SS2.p3.1.m1.1.1.3.cmml" xref="A1.SS2.p3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">lr</annotation></semantics></math> is searched from <math id="A1.SS2.p3.2.m2.3" class="ltx_Math" alttext="\{0.001,0.01,0.1\}" display="inline"><semantics id="A1.SS2.p3.2.m2.3a"><mrow id="A1.SS2.p3.2.m2.3.4.2" xref="A1.SS2.p3.2.m2.3.4.1.cmml"><mo stretchy="false" id="A1.SS2.p3.2.m2.3.4.2.1" xref="A1.SS2.p3.2.m2.3.4.1.cmml">{</mo><mn id="A1.SS2.p3.2.m2.1.1" xref="A1.SS2.p3.2.m2.1.1.cmml">0.001</mn><mo id="A1.SS2.p3.2.m2.3.4.2.2" xref="A1.SS2.p3.2.m2.3.4.1.cmml">,</mo><mn id="A1.SS2.p3.2.m2.2.2" xref="A1.SS2.p3.2.m2.2.2.cmml">0.01</mn><mo id="A1.SS2.p3.2.m2.3.4.2.3" xref="A1.SS2.p3.2.m2.3.4.1.cmml">,</mo><mn id="A1.SS2.p3.2.m2.3.3" xref="A1.SS2.p3.2.m2.3.3.cmml">0.1</mn><mo stretchy="false" id="A1.SS2.p3.2.m2.3.4.2.4" xref="A1.SS2.p3.2.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.3b"><set id="A1.SS2.p3.2.m2.3.4.1.cmml" xref="A1.SS2.p3.2.m2.3.4.2"><cn type="float" id="A1.SS2.p3.2.m2.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1">0.001</cn><cn type="float" id="A1.SS2.p3.2.m2.2.2.cmml" xref="A1.SS2.p3.2.m2.2.2">0.01</cn><cn type="float" id="A1.SS2.p3.2.m2.3.3.cmml" xref="A1.SS2.p3.2.m2.3.3">0.1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.3c">\{0.001,0.01,0.1\}</annotation></semantics></math>. The optimal value is <math id="A1.SS2.p3.3.m3.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A1.SS2.p3.3.m3.1a"><mn id="A1.SS2.p3.3.m3.1.1" xref="A1.SS2.p3.3.m3.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.3.m3.1b"><cn type="float" id="A1.SS2.p3.3.m3.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.3.m3.1c">0.01</annotation></semantics></math>.</p>
</div>
<div id="A1.SS2.p4" class="ltx_para">
<p id="A1.SS2.p4.6" class="ltx_p"><span id="A1.SS2.p4.6.1" class="ltx_text ltx_font_bold">APFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite></span>: <math id="A1.SS2.p4.1.m1.1" class="ltx_Math" alttext="lr" display="inline"><semantics id="A1.SS2.p4.1.m1.1a"><mrow id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml"><mi id="A1.SS2.p4.1.m1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p4.1.m1.1.1.1" xref="A1.SS2.p4.1.m1.1.1.1.cmml">​</mo><mi id="A1.SS2.p4.1.m1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><apply id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1"><times id="A1.SS2.p4.1.m1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1.1"></times><ci id="A1.SS2.p4.1.m1.1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.1.2">𝑙</ci><ci id="A1.SS2.p4.1.m1.1.1.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">lr</annotation></semantics></math> and the initial mixture coefficient <math id="A1.SS2.p4.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A1.SS2.p4.2.m2.1a"><mi id="A1.SS2.p4.2.m2.1.1" xref="A1.SS2.p4.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.2.m2.1b"><ci id="A1.SS2.p4.2.m2.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.2.m2.1c">\alpha</annotation></semantics></math> are searched from <math id="A1.SS2.p4.3.m3.3" class="ltx_Math" alttext="\{0.001,0.01,0.1\}" display="inline"><semantics id="A1.SS2.p4.3.m3.3a"><mrow id="A1.SS2.p4.3.m3.3.4.2" xref="A1.SS2.p4.3.m3.3.4.1.cmml"><mo stretchy="false" id="A1.SS2.p4.3.m3.3.4.2.1" xref="A1.SS2.p4.3.m3.3.4.1.cmml">{</mo><mn id="A1.SS2.p4.3.m3.1.1" xref="A1.SS2.p4.3.m3.1.1.cmml">0.001</mn><mo id="A1.SS2.p4.3.m3.3.4.2.2" xref="A1.SS2.p4.3.m3.3.4.1.cmml">,</mo><mn id="A1.SS2.p4.3.m3.2.2" xref="A1.SS2.p4.3.m3.2.2.cmml">0.01</mn><mo id="A1.SS2.p4.3.m3.3.4.2.3" xref="A1.SS2.p4.3.m3.3.4.1.cmml">,</mo><mn id="A1.SS2.p4.3.m3.3.3" xref="A1.SS2.p4.3.m3.3.3.cmml">0.1</mn><mo stretchy="false" id="A1.SS2.p4.3.m3.3.4.2.4" xref="A1.SS2.p4.3.m3.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.3.m3.3b"><set id="A1.SS2.p4.3.m3.3.4.1.cmml" xref="A1.SS2.p4.3.m3.3.4.2"><cn type="float" id="A1.SS2.p4.3.m3.1.1.cmml" xref="A1.SS2.p4.3.m3.1.1">0.001</cn><cn type="float" id="A1.SS2.p4.3.m3.2.2.cmml" xref="A1.SS2.p4.3.m3.2.2">0.01</cn><cn type="float" id="A1.SS2.p4.3.m3.3.3.cmml" xref="A1.SS2.p4.3.m3.3.3">0.1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.3.m3.3c">\{0.001,0.01,0.1\}</annotation></semantics></math> and <math id="A1.SS2.p4.4.m4.3" class="ltx_Math" alttext="\{0.25,0.5,0.75\}" display="inline"><semantics id="A1.SS2.p4.4.m4.3a"><mrow id="A1.SS2.p4.4.m4.3.4.2" xref="A1.SS2.p4.4.m4.3.4.1.cmml"><mo stretchy="false" id="A1.SS2.p4.4.m4.3.4.2.1" xref="A1.SS2.p4.4.m4.3.4.1.cmml">{</mo><mn id="A1.SS2.p4.4.m4.1.1" xref="A1.SS2.p4.4.m4.1.1.cmml">0.25</mn><mo id="A1.SS2.p4.4.m4.3.4.2.2" xref="A1.SS2.p4.4.m4.3.4.1.cmml">,</mo><mn id="A1.SS2.p4.4.m4.2.2" xref="A1.SS2.p4.4.m4.2.2.cmml">0.5</mn><mo id="A1.SS2.p4.4.m4.3.4.2.3" xref="A1.SS2.p4.4.m4.3.4.1.cmml">,</mo><mn id="A1.SS2.p4.4.m4.3.3" xref="A1.SS2.p4.4.m4.3.3.cmml">0.75</mn><mo stretchy="false" id="A1.SS2.p4.4.m4.3.4.2.4" xref="A1.SS2.p4.4.m4.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.4.m4.3b"><set id="A1.SS2.p4.4.m4.3.4.1.cmml" xref="A1.SS2.p4.4.m4.3.4.2"><cn type="float" id="A1.SS2.p4.4.m4.1.1.cmml" xref="A1.SS2.p4.4.m4.1.1">0.25</cn><cn type="float" id="A1.SS2.p4.4.m4.2.2.cmml" xref="A1.SS2.p4.4.m4.2.2">0.5</cn><cn type="float" id="A1.SS2.p4.4.m4.3.3.cmml" xref="A1.SS2.p4.4.m4.3.3">0.75</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.4.m4.3c">\{0.25,0.5,0.75\}</annotation></semantics></math>, the optimal values are <math id="A1.SS2.p4.5.m5.1" class="ltx_Math" alttext="lr=0.01" display="inline"><semantics id="A1.SS2.p4.5.m5.1a"><mrow id="A1.SS2.p4.5.m5.1.1" xref="A1.SS2.p4.5.m5.1.1.cmml"><mrow id="A1.SS2.p4.5.m5.1.1.2" xref="A1.SS2.p4.5.m5.1.1.2.cmml"><mi id="A1.SS2.p4.5.m5.1.1.2.2" xref="A1.SS2.p4.5.m5.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p4.5.m5.1.1.2.1" xref="A1.SS2.p4.5.m5.1.1.2.1.cmml">​</mo><mi id="A1.SS2.p4.5.m5.1.1.2.3" xref="A1.SS2.p4.5.m5.1.1.2.3.cmml">r</mi></mrow><mo id="A1.SS2.p4.5.m5.1.1.1" xref="A1.SS2.p4.5.m5.1.1.1.cmml">=</mo><mn id="A1.SS2.p4.5.m5.1.1.3" xref="A1.SS2.p4.5.m5.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.5.m5.1b"><apply id="A1.SS2.p4.5.m5.1.1.cmml" xref="A1.SS2.p4.5.m5.1.1"><eq id="A1.SS2.p4.5.m5.1.1.1.cmml" xref="A1.SS2.p4.5.m5.1.1.1"></eq><apply id="A1.SS2.p4.5.m5.1.1.2.cmml" xref="A1.SS2.p4.5.m5.1.1.2"><times id="A1.SS2.p4.5.m5.1.1.2.1.cmml" xref="A1.SS2.p4.5.m5.1.1.2.1"></times><ci id="A1.SS2.p4.5.m5.1.1.2.2.cmml" xref="A1.SS2.p4.5.m5.1.1.2.2">𝑙</ci><ci id="A1.SS2.p4.5.m5.1.1.2.3.cmml" xref="A1.SS2.p4.5.m5.1.1.2.3">𝑟</ci></apply><cn type="float" id="A1.SS2.p4.5.m5.1.1.3.cmml" xref="A1.SS2.p4.5.m5.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.5.m5.1c">lr=0.01</annotation></semantics></math> and <math id="A1.SS2.p4.6.m6.1" class="ltx_Math" alttext="\alpha=0.25" display="inline"><semantics id="A1.SS2.p4.6.m6.1a"><mrow id="A1.SS2.p4.6.m6.1.1" xref="A1.SS2.p4.6.m6.1.1.cmml"><mi id="A1.SS2.p4.6.m6.1.1.2" xref="A1.SS2.p4.6.m6.1.1.2.cmml">α</mi><mo id="A1.SS2.p4.6.m6.1.1.1" xref="A1.SS2.p4.6.m6.1.1.1.cmml">=</mo><mn id="A1.SS2.p4.6.m6.1.1.3" xref="A1.SS2.p4.6.m6.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.6.m6.1b"><apply id="A1.SS2.p4.6.m6.1.1.cmml" xref="A1.SS2.p4.6.m6.1.1"><eq id="A1.SS2.p4.6.m6.1.1.1.cmml" xref="A1.SS2.p4.6.m6.1.1.1"></eq><ci id="A1.SS2.p4.6.m6.1.1.2.cmml" xref="A1.SS2.p4.6.m6.1.1.2">𝛼</ci><cn type="float" id="A1.SS2.p4.6.m6.1.1.3.cmml" xref="A1.SS2.p4.6.m6.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.6.m6.1c">\alpha=0.25</annotation></semantics></math>.</p>
</div>
<div id="A1.SS2.p5" class="ltx_para">
<p id="A1.SS2.p5.6" class="ltx_p"><span id="A1.SS2.p5.6.1" class="ltx_text ltx_font_bold">Per-FedAVG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite></span>: <math id="A1.SS2.p5.1.m1.1" class="ltx_Math" alttext="lr" display="inline"><semantics id="A1.SS2.p5.1.m1.1a"><mrow id="A1.SS2.p5.1.m1.1.1" xref="A1.SS2.p5.1.m1.1.1.cmml"><mi id="A1.SS2.p5.1.m1.1.1.2" xref="A1.SS2.p5.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.1.m1.1.1.1" xref="A1.SS2.p5.1.m1.1.1.1.cmml">​</mo><mi id="A1.SS2.p5.1.m1.1.1.3" xref="A1.SS2.p5.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.1b"><apply id="A1.SS2.p5.1.m1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1"><times id="A1.SS2.p5.1.m1.1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1.1"></times><ci id="A1.SS2.p5.1.m1.1.1.2.cmml" xref="A1.SS2.p5.1.m1.1.1.2">𝑙</ci><ci id="A1.SS2.p5.1.m1.1.1.3.cmml" xref="A1.SS2.p5.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.1c">lr</annotation></semantics></math> and <math id="A1.SS2.p5.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A1.SS2.p5.2.m2.1a"><mi id="A1.SS2.p5.2.m2.1.1" xref="A1.SS2.p5.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.2.m2.1b"><ci id="A1.SS2.p5.2.m2.1.1.cmml" xref="A1.SS2.p5.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.2.m2.1c">\beta</annotation></semantics></math> are searched from <math id="A1.SS2.p5.3.m3.3" class="ltx_Math" alttext="\{0.001,0.01,0.1\}" display="inline"><semantics id="A1.SS2.p5.3.m3.3a"><mrow id="A1.SS2.p5.3.m3.3.4.2" xref="A1.SS2.p5.3.m3.3.4.1.cmml"><mo stretchy="false" id="A1.SS2.p5.3.m3.3.4.2.1" xref="A1.SS2.p5.3.m3.3.4.1.cmml">{</mo><mn id="A1.SS2.p5.3.m3.1.1" xref="A1.SS2.p5.3.m3.1.1.cmml">0.001</mn><mo id="A1.SS2.p5.3.m3.3.4.2.2" xref="A1.SS2.p5.3.m3.3.4.1.cmml">,</mo><mn id="A1.SS2.p5.3.m3.2.2" xref="A1.SS2.p5.3.m3.2.2.cmml">0.01</mn><mo id="A1.SS2.p5.3.m3.3.4.2.3" xref="A1.SS2.p5.3.m3.3.4.1.cmml">,</mo><mn id="A1.SS2.p5.3.m3.3.3" xref="A1.SS2.p5.3.m3.3.3.cmml">0.1</mn><mo stretchy="false" id="A1.SS2.p5.3.m3.3.4.2.4" xref="A1.SS2.p5.3.m3.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.3.m3.3b"><set id="A1.SS2.p5.3.m3.3.4.1.cmml" xref="A1.SS2.p5.3.m3.3.4.2"><cn type="float" id="A1.SS2.p5.3.m3.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1">0.001</cn><cn type="float" id="A1.SS2.p5.3.m3.2.2.cmml" xref="A1.SS2.p5.3.m3.2.2">0.01</cn><cn type="float" id="A1.SS2.p5.3.m3.3.3.cmml" xref="A1.SS2.p5.3.m3.3.3">0.1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.3.m3.3c">\{0.001,0.01,0.1\}</annotation></semantics></math> and <math id="A1.SS2.p5.4.m4.3" class="ltx_Math" alttext="\{0.001,0.01,0.1\}" display="inline"><semantics id="A1.SS2.p5.4.m4.3a"><mrow id="A1.SS2.p5.4.m4.3.4.2" xref="A1.SS2.p5.4.m4.3.4.1.cmml"><mo stretchy="false" id="A1.SS2.p5.4.m4.3.4.2.1" xref="A1.SS2.p5.4.m4.3.4.1.cmml">{</mo><mn id="A1.SS2.p5.4.m4.1.1" xref="A1.SS2.p5.4.m4.1.1.cmml">0.001</mn><mo id="A1.SS2.p5.4.m4.3.4.2.2" xref="A1.SS2.p5.4.m4.3.4.1.cmml">,</mo><mn id="A1.SS2.p5.4.m4.2.2" xref="A1.SS2.p5.4.m4.2.2.cmml">0.01</mn><mo id="A1.SS2.p5.4.m4.3.4.2.3" xref="A1.SS2.p5.4.m4.3.4.1.cmml">,</mo><mn id="A1.SS2.p5.4.m4.3.3" xref="A1.SS2.p5.4.m4.3.3.cmml">0.1</mn><mo stretchy="false" id="A1.SS2.p5.4.m4.3.4.2.4" xref="A1.SS2.p5.4.m4.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.4.m4.3b"><set id="A1.SS2.p5.4.m4.3.4.1.cmml" xref="A1.SS2.p5.4.m4.3.4.2"><cn type="float" id="A1.SS2.p5.4.m4.1.1.cmml" xref="A1.SS2.p5.4.m4.1.1">0.001</cn><cn type="float" id="A1.SS2.p5.4.m4.2.2.cmml" xref="A1.SS2.p5.4.m4.2.2">0.01</cn><cn type="float" id="A1.SS2.p5.4.m4.3.3.cmml" xref="A1.SS2.p5.4.m4.3.3">0.1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.4.m4.3c">\{0.001,0.01,0.1\}</annotation></semantics></math>, the optimal values are <math id="A1.SS2.p5.5.m5.1" class="ltx_Math" alttext="lr=0.001" display="inline"><semantics id="A1.SS2.p5.5.m5.1a"><mrow id="A1.SS2.p5.5.m5.1.1" xref="A1.SS2.p5.5.m5.1.1.cmml"><mrow id="A1.SS2.p5.5.m5.1.1.2" xref="A1.SS2.p5.5.m5.1.1.2.cmml"><mi id="A1.SS2.p5.5.m5.1.1.2.2" xref="A1.SS2.p5.5.m5.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.5.m5.1.1.2.1" xref="A1.SS2.p5.5.m5.1.1.2.1.cmml">​</mo><mi id="A1.SS2.p5.5.m5.1.1.2.3" xref="A1.SS2.p5.5.m5.1.1.2.3.cmml">r</mi></mrow><mo id="A1.SS2.p5.5.m5.1.1.1" xref="A1.SS2.p5.5.m5.1.1.1.cmml">=</mo><mn id="A1.SS2.p5.5.m5.1.1.3" xref="A1.SS2.p5.5.m5.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.5.m5.1b"><apply id="A1.SS2.p5.5.m5.1.1.cmml" xref="A1.SS2.p5.5.m5.1.1"><eq id="A1.SS2.p5.5.m5.1.1.1.cmml" xref="A1.SS2.p5.5.m5.1.1.1"></eq><apply id="A1.SS2.p5.5.m5.1.1.2.cmml" xref="A1.SS2.p5.5.m5.1.1.2"><times id="A1.SS2.p5.5.m5.1.1.2.1.cmml" xref="A1.SS2.p5.5.m5.1.1.2.1"></times><ci id="A1.SS2.p5.5.m5.1.1.2.2.cmml" xref="A1.SS2.p5.5.m5.1.1.2.2">𝑙</ci><ci id="A1.SS2.p5.5.m5.1.1.2.3.cmml" xref="A1.SS2.p5.5.m5.1.1.2.3">𝑟</ci></apply><cn type="float" id="A1.SS2.p5.5.m5.1.1.3.cmml" xref="A1.SS2.p5.5.m5.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.5.m5.1c">lr=0.001</annotation></semantics></math> and <math id="A1.SS2.p5.6.m6.1" class="ltx_Math" alttext="\beta=0.001" display="inline"><semantics id="A1.SS2.p5.6.m6.1a"><mrow id="A1.SS2.p5.6.m6.1.1" xref="A1.SS2.p5.6.m6.1.1.cmml"><mi id="A1.SS2.p5.6.m6.1.1.2" xref="A1.SS2.p5.6.m6.1.1.2.cmml">β</mi><mo id="A1.SS2.p5.6.m6.1.1.1" xref="A1.SS2.p5.6.m6.1.1.1.cmml">=</mo><mn id="A1.SS2.p5.6.m6.1.1.3" xref="A1.SS2.p5.6.m6.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.6.m6.1b"><apply id="A1.SS2.p5.6.m6.1.1.cmml" xref="A1.SS2.p5.6.m6.1.1"><eq id="A1.SS2.p5.6.m6.1.1.1.cmml" xref="A1.SS2.p5.6.m6.1.1.1"></eq><ci id="A1.SS2.p5.6.m6.1.1.2.cmml" xref="A1.SS2.p5.6.m6.1.1.2">𝛽</ci><cn type="float" id="A1.SS2.p5.6.m6.1.1.3.cmml" xref="A1.SS2.p5.6.m6.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.6.m6.1c">\beta=0.001</annotation></semantics></math>.</p>
</div>
<div id="A1.SS2.p6" class="ltx_para">
<p id="A1.SS2.p6.3" class="ltx_p"><span id="A1.SS2.p6.3.1" class="ltx_text ltx_font_bold">FedBN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite></span>: <math id="A1.SS2.p6.1.m1.1" class="ltx_Math" alttext="lr" display="inline"><semantics id="A1.SS2.p6.1.m1.1a"><mrow id="A1.SS2.p6.1.m1.1.1" xref="A1.SS2.p6.1.m1.1.1.cmml"><mi id="A1.SS2.p6.1.m1.1.1.2" xref="A1.SS2.p6.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.1.m1.1.1.1" xref="A1.SS2.p6.1.m1.1.1.1.cmml">​</mo><mi id="A1.SS2.p6.1.m1.1.1.3" xref="A1.SS2.p6.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.1.m1.1b"><apply id="A1.SS2.p6.1.m1.1.1.cmml" xref="A1.SS2.p6.1.m1.1.1"><times id="A1.SS2.p6.1.m1.1.1.1.cmml" xref="A1.SS2.p6.1.m1.1.1.1"></times><ci id="A1.SS2.p6.1.m1.1.1.2.cmml" xref="A1.SS2.p6.1.m1.1.1.2">𝑙</ci><ci id="A1.SS2.p6.1.m1.1.1.3.cmml" xref="A1.SS2.p6.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.1.m1.1c">lr</annotation></semantics></math> is searched from <math id="A1.SS2.p6.2.m2.3" class="ltx_Math" alttext="\{0.001,0.01,0.1\}" display="inline"><semantics id="A1.SS2.p6.2.m2.3a"><mrow id="A1.SS2.p6.2.m2.3.4.2" xref="A1.SS2.p6.2.m2.3.4.1.cmml"><mo stretchy="false" id="A1.SS2.p6.2.m2.3.4.2.1" xref="A1.SS2.p6.2.m2.3.4.1.cmml">{</mo><mn id="A1.SS2.p6.2.m2.1.1" xref="A1.SS2.p6.2.m2.1.1.cmml">0.001</mn><mo id="A1.SS2.p6.2.m2.3.4.2.2" xref="A1.SS2.p6.2.m2.3.4.1.cmml">,</mo><mn id="A1.SS2.p6.2.m2.2.2" xref="A1.SS2.p6.2.m2.2.2.cmml">0.01</mn><mo id="A1.SS2.p6.2.m2.3.4.2.3" xref="A1.SS2.p6.2.m2.3.4.1.cmml">,</mo><mn id="A1.SS2.p6.2.m2.3.3" xref="A1.SS2.p6.2.m2.3.3.cmml">0.1</mn><mo stretchy="false" id="A1.SS2.p6.2.m2.3.4.2.4" xref="A1.SS2.p6.2.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.2.m2.3b"><set id="A1.SS2.p6.2.m2.3.4.1.cmml" xref="A1.SS2.p6.2.m2.3.4.2"><cn type="float" id="A1.SS2.p6.2.m2.1.1.cmml" xref="A1.SS2.p6.2.m2.1.1">0.001</cn><cn type="float" id="A1.SS2.p6.2.m2.2.2.cmml" xref="A1.SS2.p6.2.m2.2.2">0.01</cn><cn type="float" id="A1.SS2.p6.2.m2.3.3.cmml" xref="A1.SS2.p6.2.m2.3.3">0.1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.2.m2.3c">\{0.001,0.01,0.1\}</annotation></semantics></math>. The optimal value is <math id="A1.SS2.p6.3.m3.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A1.SS2.p6.3.m3.1a"><mn id="A1.SS2.p6.3.m3.1.1" xref="A1.SS2.p6.3.m3.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.3.m3.1b"><cn type="float" id="A1.SS2.p6.3.m3.1.1.cmml" xref="A1.SS2.p6.3.m3.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.3.m3.1c">0.01</annotation></semantics></math>.</p>
</div>
<div id="A1.SS2.p7" class="ltx_para">
<p id="A1.SS2.p7.3" class="ltx_p"><span id="A1.SS2.p7.3.1" class="ltx_text ltx_font_bold">FedRep <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite></span>: <math id="A1.SS2.p7.1.m1.1" class="ltx_Math" alttext="lr" display="inline"><semantics id="A1.SS2.p7.1.m1.1a"><mrow id="A1.SS2.p7.1.m1.1.1" xref="A1.SS2.p7.1.m1.1.1.cmml"><mi id="A1.SS2.p7.1.m1.1.1.2" xref="A1.SS2.p7.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p7.1.m1.1.1.1" xref="A1.SS2.p7.1.m1.1.1.1.cmml">​</mo><mi id="A1.SS2.p7.1.m1.1.1.3" xref="A1.SS2.p7.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p7.1.m1.1b"><apply id="A1.SS2.p7.1.m1.1.1.cmml" xref="A1.SS2.p7.1.m1.1.1"><times id="A1.SS2.p7.1.m1.1.1.1.cmml" xref="A1.SS2.p7.1.m1.1.1.1"></times><ci id="A1.SS2.p7.1.m1.1.1.2.cmml" xref="A1.SS2.p7.1.m1.1.1.2">𝑙</ci><ci id="A1.SS2.p7.1.m1.1.1.3.cmml" xref="A1.SS2.p7.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p7.1.m1.1c">lr</annotation></semantics></math> is searched from <math id="A1.SS2.p7.2.m2.3" class="ltx_Math" alttext="\{0.001,0.01,0.1\}" display="inline"><semantics id="A1.SS2.p7.2.m2.3a"><mrow id="A1.SS2.p7.2.m2.3.4.2" xref="A1.SS2.p7.2.m2.3.4.1.cmml"><mo stretchy="false" id="A1.SS2.p7.2.m2.3.4.2.1" xref="A1.SS2.p7.2.m2.3.4.1.cmml">{</mo><mn id="A1.SS2.p7.2.m2.1.1" xref="A1.SS2.p7.2.m2.1.1.cmml">0.001</mn><mo id="A1.SS2.p7.2.m2.3.4.2.2" xref="A1.SS2.p7.2.m2.3.4.1.cmml">,</mo><mn id="A1.SS2.p7.2.m2.2.2" xref="A1.SS2.p7.2.m2.2.2.cmml">0.01</mn><mo id="A1.SS2.p7.2.m2.3.4.2.3" xref="A1.SS2.p7.2.m2.3.4.1.cmml">,</mo><mn id="A1.SS2.p7.2.m2.3.3" xref="A1.SS2.p7.2.m2.3.3.cmml">0.1</mn><mo stretchy="false" id="A1.SS2.p7.2.m2.3.4.2.4" xref="A1.SS2.p7.2.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p7.2.m2.3b"><set id="A1.SS2.p7.2.m2.3.4.1.cmml" xref="A1.SS2.p7.2.m2.3.4.2"><cn type="float" id="A1.SS2.p7.2.m2.1.1.cmml" xref="A1.SS2.p7.2.m2.1.1">0.001</cn><cn type="float" id="A1.SS2.p7.2.m2.2.2.cmml" xref="A1.SS2.p7.2.m2.2.2">0.01</cn><cn type="float" id="A1.SS2.p7.2.m2.3.3.cmml" xref="A1.SS2.p7.2.m2.3.3">0.1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p7.2.m2.3c">\{0.001,0.01,0.1\}</annotation></semantics></math>. The optimal value is <math id="A1.SS2.p7.3.m3.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A1.SS2.p7.3.m3.1a"><mn id="A1.SS2.p7.3.m3.1.1" xref="A1.SS2.p7.3.m3.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p7.3.m3.1b"><cn type="float" id="A1.SS2.p7.3.m3.1.1.cmml" xref="A1.SS2.p7.3.m3.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p7.3.m3.1c">0.01</annotation></semantics></math>. The classification head is defined as the last layer.</p>
</div>
<div id="A1.SS2.p8" class="ltx_para">
<p id="A1.SS2.p8.3" class="ltx_p"><span id="A1.SS2.p8.3.1" class="ltx_text ltx_font_bold">FedBABU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite></span>: <math id="A1.SS2.p8.1.m1.1" class="ltx_Math" alttext="lr" display="inline"><semantics id="A1.SS2.p8.1.m1.1a"><mrow id="A1.SS2.p8.1.m1.1.1" xref="A1.SS2.p8.1.m1.1.1.cmml"><mi id="A1.SS2.p8.1.m1.1.1.2" xref="A1.SS2.p8.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p8.1.m1.1.1.1" xref="A1.SS2.p8.1.m1.1.1.1.cmml">​</mo><mi id="A1.SS2.p8.1.m1.1.1.3" xref="A1.SS2.p8.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p8.1.m1.1b"><apply id="A1.SS2.p8.1.m1.1.1.cmml" xref="A1.SS2.p8.1.m1.1.1"><times id="A1.SS2.p8.1.m1.1.1.1.cmml" xref="A1.SS2.p8.1.m1.1.1.1"></times><ci id="A1.SS2.p8.1.m1.1.1.2.cmml" xref="A1.SS2.p8.1.m1.1.1.2">𝑙</ci><ci id="A1.SS2.p8.1.m1.1.1.3.cmml" xref="A1.SS2.p8.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p8.1.m1.1c">lr</annotation></semantics></math> is searched from <math id="A1.SS2.p8.2.m2.3" class="ltx_Math" alttext="\{0.001,0.01,0.1\}" display="inline"><semantics id="A1.SS2.p8.2.m2.3a"><mrow id="A1.SS2.p8.2.m2.3.4.2" xref="A1.SS2.p8.2.m2.3.4.1.cmml"><mo stretchy="false" id="A1.SS2.p8.2.m2.3.4.2.1" xref="A1.SS2.p8.2.m2.3.4.1.cmml">{</mo><mn id="A1.SS2.p8.2.m2.1.1" xref="A1.SS2.p8.2.m2.1.1.cmml">0.001</mn><mo id="A1.SS2.p8.2.m2.3.4.2.2" xref="A1.SS2.p8.2.m2.3.4.1.cmml">,</mo><mn id="A1.SS2.p8.2.m2.2.2" xref="A1.SS2.p8.2.m2.2.2.cmml">0.01</mn><mo id="A1.SS2.p8.2.m2.3.4.2.3" xref="A1.SS2.p8.2.m2.3.4.1.cmml">,</mo><mn id="A1.SS2.p8.2.m2.3.3" xref="A1.SS2.p8.2.m2.3.3.cmml">0.1</mn><mo stretchy="false" id="A1.SS2.p8.2.m2.3.4.2.4" xref="A1.SS2.p8.2.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p8.2.m2.3b"><set id="A1.SS2.p8.2.m2.3.4.1.cmml" xref="A1.SS2.p8.2.m2.3.4.2"><cn type="float" id="A1.SS2.p8.2.m2.1.1.cmml" xref="A1.SS2.p8.2.m2.1.1">0.001</cn><cn type="float" id="A1.SS2.p8.2.m2.2.2.cmml" xref="A1.SS2.p8.2.m2.2.2">0.01</cn><cn type="float" id="A1.SS2.p8.2.m2.3.3.cmml" xref="A1.SS2.p8.2.m2.3.3">0.1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p8.2.m2.3c">\{0.001,0.01,0.1\}</annotation></semantics></math>. The optimal value is <math id="A1.SS2.p8.3.m3.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A1.SS2.p8.3.m3.1a"><mn id="A1.SS2.p8.3.m3.1.1" xref="A1.SS2.p8.3.m3.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p8.3.m3.1b"><cn type="float" id="A1.SS2.p8.3.m3.1.1.cmml" xref="A1.SS2.p8.3.m3.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p8.3.m3.1c">0.01</annotation></semantics></math>. One local step is done for fine-tuning the classification head. The classification head is defined as the last layer.</p>
</div>
<div id="A1.SS2.p9" class="ltx_para">
<p id="A1.SS2.p9.6" class="ltx_p"><span id="A1.SS2.p9.6.1" class="ltx_text ltx_font_bold">FedPerfix</span>: <math id="A1.SS2.p9.1.m1.1" class="ltx_Math" alttext="lr" display="inline"><semantics id="A1.SS2.p9.1.m1.1a"><mrow id="A1.SS2.p9.1.m1.1.1" xref="A1.SS2.p9.1.m1.1.1.cmml"><mi id="A1.SS2.p9.1.m1.1.1.2" xref="A1.SS2.p9.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p9.1.m1.1.1.1" xref="A1.SS2.p9.1.m1.1.1.1.cmml">​</mo><mi id="A1.SS2.p9.1.m1.1.1.3" xref="A1.SS2.p9.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.1.m1.1b"><apply id="A1.SS2.p9.1.m1.1.1.cmml" xref="A1.SS2.p9.1.m1.1.1"><times id="A1.SS2.p9.1.m1.1.1.1.cmml" xref="A1.SS2.p9.1.m1.1.1.1"></times><ci id="A1.SS2.p9.1.m1.1.1.2.cmml" xref="A1.SS2.p9.1.m1.1.1.2">𝑙</ci><ci id="A1.SS2.p9.1.m1.1.1.3.cmml" xref="A1.SS2.p9.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.1.m1.1c">lr</annotation></semantics></math> is searched from <math id="A1.SS2.p9.2.m2.3" class="ltx_Math" alttext="\{0.001,0.01,0.1\}" display="inline"><semantics id="A1.SS2.p9.2.m2.3a"><mrow id="A1.SS2.p9.2.m2.3.4.2" xref="A1.SS2.p9.2.m2.3.4.1.cmml"><mo stretchy="false" id="A1.SS2.p9.2.m2.3.4.2.1" xref="A1.SS2.p9.2.m2.3.4.1.cmml">{</mo><mn id="A1.SS2.p9.2.m2.1.1" xref="A1.SS2.p9.2.m2.1.1.cmml">0.001</mn><mo id="A1.SS2.p9.2.m2.3.4.2.2" xref="A1.SS2.p9.2.m2.3.4.1.cmml">,</mo><mn id="A1.SS2.p9.2.m2.2.2" xref="A1.SS2.p9.2.m2.2.2.cmml">0.01</mn><mo id="A1.SS2.p9.2.m2.3.4.2.3" xref="A1.SS2.p9.2.m2.3.4.1.cmml">,</mo><mn id="A1.SS2.p9.2.m2.3.3" xref="A1.SS2.p9.2.m2.3.3.cmml">0.1</mn><mo stretchy="false" id="A1.SS2.p9.2.m2.3.4.2.4" xref="A1.SS2.p9.2.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.2.m2.3b"><set id="A1.SS2.p9.2.m2.3.4.1.cmml" xref="A1.SS2.p9.2.m2.3.4.2"><cn type="float" id="A1.SS2.p9.2.m2.1.1.cmml" xref="A1.SS2.p9.2.m2.1.1">0.001</cn><cn type="float" id="A1.SS2.p9.2.m2.2.2.cmml" xref="A1.SS2.p9.2.m2.2.2">0.01</cn><cn type="float" id="A1.SS2.p9.2.m2.3.3.cmml" xref="A1.SS2.p9.2.m2.3.3">0.1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.2.m2.3c">\{0.001,0.01,0.1\}</annotation></semantics></math>, and the optimal value is <math id="A1.SS2.p9.3.m3.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A1.SS2.p9.3.m3.1a"><mn id="A1.SS2.p9.3.m3.1.1" xref="A1.SS2.p9.3.m3.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.3.m3.1b"><cn type="float" id="A1.SS2.p9.3.m3.1.1.cmml" xref="A1.SS2.p9.3.m3.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.3.m3.1c">0.01</annotation></semantics></math>. The hidden state dimension is set as <math id="A1.SS2.p9.4.m4.1" class="ltx_Math" alttext="256" display="inline"><semantics id="A1.SS2.p9.4.m4.1a"><mn id="A1.SS2.p9.4.m4.1.1" xref="A1.SS2.p9.4.m4.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.4.m4.1b"><cn type="integer" id="A1.SS2.p9.4.m4.1.1.cmml" xref="A1.SS2.p9.4.m4.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.4.m4.1c">256</annotation></semantics></math>. The scale <math id="A1.SS2.p9.5.m5.1" class="ltx_Math" alttext="s" display="inline"><semantics id="A1.SS2.p9.5.m5.1a"><mi id="A1.SS2.p9.5.m5.1.1" xref="A1.SS2.p9.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.5.m5.1b"><ci id="A1.SS2.p9.5.m5.1.1.cmml" xref="A1.SS2.p9.5.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.5.m5.1c">s</annotation></semantics></math> is set as <math id="A1.SS2.p9.6.m6.1" class="ltx_Math" alttext="1.5" display="inline"><semantics id="A1.SS2.p9.6.m6.1a"><mn id="A1.SS2.p9.6.m6.1.1" xref="A1.SS2.p9.6.m6.1.1.cmml">1.5</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.6.m6.1b"><cn type="float" id="A1.SS2.p9.6.m6.1.1.cmml" xref="A1.SS2.p9.6.m6.1.1">1.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.6.m6.1c">1.5</annotation></semantics></math>. The classification head is defined as the last two layers.</p>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Connection between APFL and FedPerfix</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">In this section, we provide a detailed comparison between the APFL and FedPerfix to explain <span id="A2.p1.1.1" class="ltx_text ltx_font_italic">why they both have the leading performance</span> compared with other methods and show that our method has <span id="A2.p1.1.2" class="ltx_text ltx_font_italic">additional advantages in storage and computation resource requirements</span>.</p>
</div>
<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Why APFL and FedPerfix lead the performance?</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.5" class="ltx_p">First, we briefly introduce the idea of APFL. APFL keeps a separate personalized model for each client. In each communication round, it will first train the global and local models separately and obtain their gradients, then update the personalized model with the gradient mixed from these two models. Now if we only consider the personalized model, its update can be written as</p>
<table id="A2.E7" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A2.E7X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E7X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle h_{per}" display="inline"><semantics id="A2.E7X.2.1.1.m1.1a"><msub id="A2.E7X.2.1.1.m1.1.1" xref="A2.E7X.2.1.1.m1.1.1.cmml"><mi id="A2.E7X.2.1.1.m1.1.1.2" xref="A2.E7X.2.1.1.m1.1.1.2.cmml">h</mi><mrow id="A2.E7X.2.1.1.m1.1.1.3" xref="A2.E7X.2.1.1.m1.1.1.3.cmml"><mi id="A2.E7X.2.1.1.m1.1.1.3.2" xref="A2.E7X.2.1.1.m1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="A2.E7X.2.1.1.m1.1.1.3.1" xref="A2.E7X.2.1.1.m1.1.1.3.1.cmml">​</mo><mi id="A2.E7X.2.1.1.m1.1.1.3.3" xref="A2.E7X.2.1.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A2.E7X.2.1.1.m1.1.1.3.1a" xref="A2.E7X.2.1.1.m1.1.1.3.1.cmml">​</mo><mi id="A2.E7X.2.1.1.m1.1.1.3.4" xref="A2.E7X.2.1.1.m1.1.1.3.4.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.E7X.2.1.1.m1.1b"><apply id="A2.E7X.2.1.1.m1.1.1.cmml" xref="A2.E7X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.E7X.2.1.1.m1.1.1.1.cmml" xref="A2.E7X.2.1.1.m1.1.1">subscript</csymbol><ci id="A2.E7X.2.1.1.m1.1.1.2.cmml" xref="A2.E7X.2.1.1.m1.1.1.2">ℎ</ci><apply id="A2.E7X.2.1.1.m1.1.1.3.cmml" xref="A2.E7X.2.1.1.m1.1.1.3"><times id="A2.E7X.2.1.1.m1.1.1.3.1.cmml" xref="A2.E7X.2.1.1.m1.1.1.3.1"></times><ci id="A2.E7X.2.1.1.m1.1.1.3.2.cmml" xref="A2.E7X.2.1.1.m1.1.1.3.2">𝑝</ci><ci id="A2.E7X.2.1.1.m1.1.1.3.3.cmml" xref="A2.E7X.2.1.1.m1.1.1.3.3">𝑒</ci><ci id="A2.E7X.2.1.1.m1.1.1.3.4.cmml" xref="A2.E7X.2.1.1.m1.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E7X.2.1.1.m1.1c">\displaystyle h_{per}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E7X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\leftarrow h_{per}-\eta(\alpha\nabla h_{per}+(1-\alpha)\nabla h_{global})" display="inline"><semantics id="A2.E7X.3.2.2.m1.1a"><mrow id="A2.E7X.3.2.2.m1.1.1" xref="A2.E7X.3.2.2.m1.1.1.cmml"><mi id="A2.E7X.3.2.2.m1.1.1.3" xref="A2.E7X.3.2.2.m1.1.1.3.cmml"></mi><mo stretchy="false" id="A2.E7X.3.2.2.m1.1.1.2" xref="A2.E7X.3.2.2.m1.1.1.2.cmml">←</mo><mrow id="A2.E7X.3.2.2.m1.1.1.1" xref="A2.E7X.3.2.2.m1.1.1.1.cmml"><msub id="A2.E7X.3.2.2.m1.1.1.1.3" xref="A2.E7X.3.2.2.m1.1.1.1.3.cmml"><mi id="A2.E7X.3.2.2.m1.1.1.1.3.2" xref="A2.E7X.3.2.2.m1.1.1.1.3.2.cmml">h</mi><mrow id="A2.E7X.3.2.2.m1.1.1.1.3.3" xref="A2.E7X.3.2.2.m1.1.1.1.3.3.cmml"><mi id="A2.E7X.3.2.2.m1.1.1.1.3.3.2" xref="A2.E7X.3.2.2.m1.1.1.1.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="A2.E7X.3.2.2.m1.1.1.1.3.3.1" xref="A2.E7X.3.2.2.m1.1.1.1.3.3.1.cmml">​</mo><mi id="A2.E7X.3.2.2.m1.1.1.1.3.3.3" xref="A2.E7X.3.2.2.m1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A2.E7X.3.2.2.m1.1.1.1.3.3.1a" xref="A2.E7X.3.2.2.m1.1.1.1.3.3.1.cmml">​</mo><mi id="A2.E7X.3.2.2.m1.1.1.1.3.3.4" xref="A2.E7X.3.2.2.m1.1.1.1.3.3.4.cmml">r</mi></mrow></msub><mo id="A2.E7X.3.2.2.m1.1.1.1.2" xref="A2.E7X.3.2.2.m1.1.1.1.2.cmml">−</mo><mrow id="A2.E7X.3.2.2.m1.1.1.1.1" xref="A2.E7X.3.2.2.m1.1.1.1.1.cmml"><mi id="A2.E7X.3.2.2.m1.1.1.1.1.3" xref="A2.E7X.3.2.2.m1.1.1.1.1.3.cmml">η</mi><mo lspace="0em" rspace="0em" id="A2.E7X.3.2.2.m1.1.1.1.1.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.2.cmml">​</mo><mrow id="A2.E7X.3.2.2.m1.1.1.1.1.1.1" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mrow id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.1" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml"><mo rspace="0.167em" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.1" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.1.cmml">∇</mo><msub id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.2.cmml">h</mi><mrow id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.1" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.3" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.1a" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.4" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.4.cmml">r</mi></mrow></msub></mrow></mrow><mo id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml"><mo rspace="0.167em" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml">∇</mo><msub id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">h</mi><mrow id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.2" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.3" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1a" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.4" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1b" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.5" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1c" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.6" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1d" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.7" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.7.cmml">l</mi></mrow></msub></mrow></mrow></mrow><mo stretchy="false" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.3" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E7X.3.2.2.m1.1b"><apply id="A2.E7X.3.2.2.m1.1.1.cmml" xref="A2.E7X.3.2.2.m1.1.1"><ci id="A2.E7X.3.2.2.m1.1.1.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.2">←</ci><csymbol cd="latexml" id="A2.E7X.3.2.2.m1.1.1.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.3">absent</csymbol><apply id="A2.E7X.3.2.2.m1.1.1.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1"><minus id="A2.E7X.3.2.2.m1.1.1.1.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.2"></minus><apply id="A2.E7X.3.2.2.m1.1.1.1.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E7X.3.2.2.m1.1.1.1.3.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.3">subscript</csymbol><ci id="A2.E7X.3.2.2.m1.1.1.1.3.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.3.2">ℎ</ci><apply id="A2.E7X.3.2.2.m1.1.1.1.3.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.3.3"><times id="A2.E7X.3.2.2.m1.1.1.1.3.3.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.3.3.1"></times><ci id="A2.E7X.3.2.2.m1.1.1.1.3.3.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.3.3.2">𝑝</ci><ci id="A2.E7X.3.2.2.m1.1.1.1.3.3.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.3.3.3">𝑒</ci><ci id="A2.E7X.3.2.2.m1.1.1.1.3.3.4.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.3.3.4">𝑟</ci></apply></apply><apply id="A2.E7X.3.2.2.m1.1.1.1.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1"><times id="A2.E7X.3.2.2.m1.1.1.1.1.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.2"></times><ci id="A2.E7X.3.2.2.m1.1.1.1.1.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.3">𝜂</ci><apply id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1"><plus id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.2"></plus><apply id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3"><times id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.1"></times><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.2">𝛼</ci><apply id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3"><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.1">∇</ci><apply id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.2">ℎ</ci><apply id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3"><times id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.1"></times><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.2">𝑝</ci><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.3">𝑒</ci><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.4.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.3.2.3.4">𝑟</ci></apply></apply></apply></apply><apply id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1"><times id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.2"></times><apply id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"><minus id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3"><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1">∇</ci><apply id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2">ℎ</ci><apply id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3"><times id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.2">𝑔</ci><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.3">𝑙</ci><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.4.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.4">𝑜</ci><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.5.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.5">𝑏</ci><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.6.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.6">𝑎</ci><ci id="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.7.cmml" xref="A2.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.7">𝑙</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E7X.3.2.2.m1.1c">\displaystyle\leftarrow h_{per}-\eta(\alpha\nabla h_{per}+(1-\alpha)\nabla h_{global})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr id="A2.E7Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E7Xa.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle=h_{per}-\eta\nabla(\alpha h_{per}+(1-\alpha)h_{global})," display="inline"><semantics id="A2.E7Xa.2.1.1.m1.2a"><mrow id="A2.E7Xa.2.1.1.m1.2.2.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.cmml"><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.3.cmml"></mi><mo id="A2.E7Xa.2.1.1.m1.2.2.1.1.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.2.cmml">=</mo><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.cmml"><msub id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.cmml"><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.2.cmml">h</mi><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.cmml"><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.1a" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.4" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.4.cmml">r</mi></mrow></msub><mo id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.2.cmml">−</mo><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.cmml"><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml"><mo id="A2.E7Xa.2.1.1.m1.1.1" xref="A2.E7Xa.2.1.1.m1.1.1.cmml">∇</mo><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml">h</mi><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.1a" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.4" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.4.cmml">r</mi></mrow></msub></mrow><mo id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msub id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">h</mi><mrow id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1a" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.4" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1b" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.5" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1c" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.6" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1d" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.7" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.7.cmml">l</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.3" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="A2.E7Xa.2.1.1.m1.2.2.1.2" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E7Xa.2.1.1.m1.2b"><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1"><eq id="A2.E7Xa.2.1.1.m1.2.2.1.1.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.2"></eq><csymbol cd="latexml" id="A2.E7Xa.2.1.1.m1.2.2.1.1.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.3">absent</csymbol><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1"><minus id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.2"></minus><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.2">ℎ</ci><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3"><times id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.1"></times><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.2">𝑝</ci><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.3">𝑒</ci><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.4.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.3.3.4">𝑟</ci></apply></apply><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1"><times id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.2"></times><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.3">𝜂</ci><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1"><ci id="A2.E7Xa.2.1.1.m1.1.1.cmml" xref="A2.E7Xa.2.1.1.m1.1.1">∇</ci><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1"><plus id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2"></plus><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3"><times id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1"></times><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝛼</ci><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.2">ℎ</ci><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3"><times id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.1"></times><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.2">𝑝</ci><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3">𝑒</ci><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.4.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.4">𝑟</ci></apply></apply></apply><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1"><times id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2"></times><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><minus id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">ℎ</ci><apply id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3"><times id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2">𝑔</ci><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3">𝑙</ci><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.4">𝑜</ci><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.5">𝑏</ci><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.6.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.6">𝑎</ci><ci id="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.7.cmml" xref="A2.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.7">𝑙</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E7Xa.2.1.1.m1.2c">\displaystyle=h_{per}-\eta\nabla(\alpha h_{per}+(1-\alpha)h_{global}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="A2.SS1.p1.4" class="ltx_p">where <math id="A2.SS1.p1.1.m1.1" class="ltx_Math" alttext="h_{per}" display="inline"><semantics id="A2.SS1.p1.1.m1.1a"><msub id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml"><mi id="A2.SS1.p1.1.m1.1.1.2" xref="A2.SS1.p1.1.m1.1.1.2.cmml">h</mi><mrow id="A2.SS1.p1.1.m1.1.1.3" xref="A2.SS1.p1.1.m1.1.1.3.cmml"><mi id="A2.SS1.p1.1.m1.1.1.3.2" xref="A2.SS1.p1.1.m1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p1.1.m1.1.1.3.1" xref="A2.SS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="A2.SS1.p1.1.m1.1.1.3.3" xref="A2.SS1.p1.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p1.1.m1.1.1.3.1a" xref="A2.SS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="A2.SS1.p1.1.m1.1.1.3.4" xref="A2.SS1.p1.1.m1.1.1.3.4.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><apply id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.1.m1.1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="A2.SS1.p1.1.m1.1.1.2.cmml" xref="A2.SS1.p1.1.m1.1.1.2">ℎ</ci><apply id="A2.SS1.p1.1.m1.1.1.3.cmml" xref="A2.SS1.p1.1.m1.1.1.3"><times id="A2.SS1.p1.1.m1.1.1.3.1.cmml" xref="A2.SS1.p1.1.m1.1.1.3.1"></times><ci id="A2.SS1.p1.1.m1.1.1.3.2.cmml" xref="A2.SS1.p1.1.m1.1.1.3.2">𝑝</ci><ci id="A2.SS1.p1.1.m1.1.1.3.3.cmml" xref="A2.SS1.p1.1.m1.1.1.3.3">𝑒</ci><ci id="A2.SS1.p1.1.m1.1.1.3.4.cmml" xref="A2.SS1.p1.1.m1.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">h_{per}</annotation></semantics></math> is the personalized model, <math id="A2.SS1.p1.2.m2.1" class="ltx_Math" alttext="h_{global}" display="inline"><semantics id="A2.SS1.p1.2.m2.1a"><msub id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml"><mi id="A2.SS1.p1.2.m2.1.1.2" xref="A2.SS1.p1.2.m2.1.1.2.cmml">h</mi><mrow id="A2.SS1.p1.2.m2.1.1.3" xref="A2.SS1.p1.2.m2.1.1.3.cmml"><mi id="A2.SS1.p1.2.m2.1.1.3.2" xref="A2.SS1.p1.2.m2.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p1.2.m2.1.1.3.1" xref="A2.SS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="A2.SS1.p1.2.m2.1.1.3.3" xref="A2.SS1.p1.2.m2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p1.2.m2.1.1.3.1a" xref="A2.SS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="A2.SS1.p1.2.m2.1.1.3.4" xref="A2.SS1.p1.2.m2.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p1.2.m2.1.1.3.1b" xref="A2.SS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="A2.SS1.p1.2.m2.1.1.3.5" xref="A2.SS1.p1.2.m2.1.1.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p1.2.m2.1.1.3.1c" xref="A2.SS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="A2.SS1.p1.2.m2.1.1.3.6" xref="A2.SS1.p1.2.m2.1.1.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p1.2.m2.1.1.3.1d" xref="A2.SS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="A2.SS1.p1.2.m2.1.1.3.7" xref="A2.SS1.p1.2.m2.1.1.3.7.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><apply id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.2.m2.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="A2.SS1.p1.2.m2.1.1.2.cmml" xref="A2.SS1.p1.2.m2.1.1.2">ℎ</ci><apply id="A2.SS1.p1.2.m2.1.1.3.cmml" xref="A2.SS1.p1.2.m2.1.1.3"><times id="A2.SS1.p1.2.m2.1.1.3.1.cmml" xref="A2.SS1.p1.2.m2.1.1.3.1"></times><ci id="A2.SS1.p1.2.m2.1.1.3.2.cmml" xref="A2.SS1.p1.2.m2.1.1.3.2">𝑔</ci><ci id="A2.SS1.p1.2.m2.1.1.3.3.cmml" xref="A2.SS1.p1.2.m2.1.1.3.3">𝑙</ci><ci id="A2.SS1.p1.2.m2.1.1.3.4.cmml" xref="A2.SS1.p1.2.m2.1.1.3.4">𝑜</ci><ci id="A2.SS1.p1.2.m2.1.1.3.5.cmml" xref="A2.SS1.p1.2.m2.1.1.3.5">𝑏</ci><ci id="A2.SS1.p1.2.m2.1.1.3.6.cmml" xref="A2.SS1.p1.2.m2.1.1.3.6">𝑎</ci><ci id="A2.SS1.p1.2.m2.1.1.3.7.cmml" xref="A2.SS1.p1.2.m2.1.1.3.7">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">h_{global}</annotation></semantics></math> is the global model, <math id="A2.SS1.p1.3.m3.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="A2.SS1.p1.3.m3.1a"><mi id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><ci id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">\eta</annotation></semantics></math> is the learning rate, and <math id="A2.SS1.p1.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.SS1.p1.4.m4.1a"><mi id="A2.SS1.p1.4.m4.1.1" xref="A2.SS1.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.1b"><ci id="A2.SS1.p1.4.m4.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.1c">\alpha</annotation></semantics></math> is the mixture coefficient.</p>
</div>
<div id="A2.SS1.p2" class="ltx_para">
<p id="A2.SS1.p2.2" class="ltx_p">Therefore, the updating of the personalized model is equivalent to updating a model <math id="A2.SS1.p2.1.m1.1" class="ltx_Math" alttext="\bar{h}" display="inline"><semantics id="A2.SS1.p2.1.m1.1a"><mover accent="true" id="A2.SS1.p2.1.m1.1.1" xref="A2.SS1.p2.1.m1.1.1.cmml"><mi id="A2.SS1.p2.1.m1.1.1.2" xref="A2.SS1.p2.1.m1.1.1.2.cmml">h</mi><mo id="A2.SS1.p2.1.m1.1.1.1" xref="A2.SS1.p2.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.1.m1.1b"><apply id="A2.SS1.p2.1.m1.1.1.cmml" xref="A2.SS1.p2.1.m1.1.1"><ci id="A2.SS1.p2.1.m1.1.1.1.cmml" xref="A2.SS1.p2.1.m1.1.1.1">¯</ci><ci id="A2.SS1.p2.1.m1.1.1.2.cmml" xref="A2.SS1.p2.1.m1.1.1.2">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.1.m1.1c">\bar{h}</annotation></semantics></math> that takes the mixture of the personalized and global models as the output. Further, we formulate the output of <math id="A2.SS1.p2.2.m2.1" class="ltx_Math" alttext="\bar{h}" display="inline"><semantics id="A2.SS1.p2.2.m2.1a"><mover accent="true" id="A2.SS1.p2.2.m2.1.1" xref="A2.SS1.p2.2.m2.1.1.cmml"><mi id="A2.SS1.p2.2.m2.1.1.2" xref="A2.SS1.p2.2.m2.1.1.2.cmml">h</mi><mo id="A2.SS1.p2.2.m2.1.1.1" xref="A2.SS1.p2.2.m2.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.2.m2.1b"><apply id="A2.SS1.p2.2.m2.1.1.cmml" xref="A2.SS1.p2.2.m2.1.1"><ci id="A2.SS1.p2.2.m2.1.1.1.cmml" xref="A2.SS1.p2.2.m2.1.1.1">¯</ci><ci id="A2.SS1.p2.2.m2.1.1.2.cmml" xref="A2.SS1.p2.2.m2.1.1.2">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.2.m2.1c">\bar{h}</annotation></semantics></math> as</p>
<table id="A2.E8" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A2.E8X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E8X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle{\bm{O}}^{(L)}=" display="inline"><semantics id="A2.E8X.2.1.1.m1.1a"><mrow id="A2.E8X.2.1.1.m1.1.2" xref="A2.E8X.2.1.1.m1.1.2.cmml"><msup id="A2.E8X.2.1.1.m1.1.2.2" xref="A2.E8X.2.1.1.m1.1.2.2.cmml"><mi id="A2.E8X.2.1.1.m1.1.2.2.2" xref="A2.E8X.2.1.1.m1.1.2.2.2.cmml">𝑶</mi><mrow id="A2.E8X.2.1.1.m1.1.1.1.3" xref="A2.E8X.2.1.1.m1.1.2.2.cmml"><mo stretchy="false" id="A2.E8X.2.1.1.m1.1.1.1.3.1" xref="A2.E8X.2.1.1.m1.1.2.2.cmml">(</mo><mi id="A2.E8X.2.1.1.m1.1.1.1.1" xref="A2.E8X.2.1.1.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="A2.E8X.2.1.1.m1.1.1.1.3.2" xref="A2.E8X.2.1.1.m1.1.2.2.cmml">)</mo></mrow></msup><mo id="A2.E8X.2.1.1.m1.1.2.1" xref="A2.E8X.2.1.1.m1.1.2.1.cmml">=</mo><mi id="A2.E8X.2.1.1.m1.1.2.3" xref="A2.E8X.2.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.E8X.2.1.1.m1.1b"><apply id="A2.E8X.2.1.1.m1.1.2.cmml" xref="A2.E8X.2.1.1.m1.1.2"><eq id="A2.E8X.2.1.1.m1.1.2.1.cmml" xref="A2.E8X.2.1.1.m1.1.2.1"></eq><apply id="A2.E8X.2.1.1.m1.1.2.2.cmml" xref="A2.E8X.2.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="A2.E8X.2.1.1.m1.1.2.2.1.cmml" xref="A2.E8X.2.1.1.m1.1.2.2">superscript</csymbol><ci id="A2.E8X.2.1.1.m1.1.2.2.2.cmml" xref="A2.E8X.2.1.1.m1.1.2.2.2">𝑶</ci><ci id="A2.E8X.2.1.1.m1.1.1.1.1.cmml" xref="A2.E8X.2.1.1.m1.1.1.1.1">𝐿</ci></apply><csymbol cd="latexml" id="A2.E8X.2.1.1.m1.1.2.3.cmml" xref="A2.E8X.2.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E8X.2.1.1.m1.1c">\displaystyle{\bm{O}}^{(L)}=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E8X.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle{\color[rgb]{0,0,1}\alpha}h_{per}^{(L)}({\bm{Z}}^{(L-1)})+{\color[rgb]{0,0,1}(1-\alpha)}h_{global}^{(L)}({\bm{Z}}^{(L-1)})," display="inline"><semantics id="A2.E8X.3.2.2.m1.5a"><mrow id="A2.E8X.3.2.2.m1.5.5.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.cmml"><mrow id="A2.E8X.3.2.2.m1.5.5.1.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.cmml"><mrow id="A2.E8X.3.2.2.m1.5.5.1.1.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.cmml"><mi mathcolor="#0000FF" id="A2.E8X.3.2.2.m1.5.5.1.1.1.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.3.cmml">α</mi><mo lspace="0em" rspace="0em" id="A2.E8X.3.2.2.m1.5.5.1.1.1.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.2.cmml">​</mo><msubsup id="A2.E8X.3.2.2.m1.5.5.1.1.1.4" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.cmml"><mi id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.2.cmml">h</mi><mrow id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.cmml"><mi id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.1.cmml">​</mo><mi id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.1a" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.1.cmml">​</mo><mi id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.4" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.4.cmml">r</mi></mrow><mrow id="A2.E8X.3.2.2.m1.1.1.1.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.cmml"><mo stretchy="false" id="A2.E8X.3.2.2.m1.1.1.1.3.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.cmml">(</mo><mi id="A2.E8X.3.2.2.m1.1.1.1.1" xref="A2.E8X.3.2.2.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="A2.E8X.3.2.2.m1.1.1.1.3.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="A2.E8X.3.2.2.m1.5.5.1.1.1.2a" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml">(</mo><msup id="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml"><mi id="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml">𝒁</mi><mrow id="A2.E8X.3.2.2.m1.2.2.1.1" xref="A2.E8X.3.2.2.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="A2.E8X.3.2.2.m1.2.2.1.1.2" xref="A2.E8X.3.2.2.m1.2.2.1.1.1.cmml">(</mo><mrow id="A2.E8X.3.2.2.m1.2.2.1.1.1" xref="A2.E8X.3.2.2.m1.2.2.1.1.1.cmml"><mi id="A2.E8X.3.2.2.m1.2.2.1.1.1.2" xref="A2.E8X.3.2.2.m1.2.2.1.1.1.2.cmml">L</mi><mo id="A2.E8X.3.2.2.m1.2.2.1.1.1.1" xref="A2.E8X.3.2.2.m1.2.2.1.1.1.1.cmml">−</mo><mn id="A2.E8X.3.2.2.m1.2.2.1.1.1.3" xref="A2.E8X.3.2.2.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A2.E8X.3.2.2.m1.2.2.1.1.3" xref="A2.E8X.3.2.2.m1.2.2.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E8X.3.2.2.m1.5.5.1.1.4" xref="A2.E8X.3.2.2.m1.5.5.1.1.4.cmml">+</mo><mrow id="A2.E8X.3.2.2.m1.5.5.1.1.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.cmml"><mrow id="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.cmml"><mo mathcolor="#0000FF" stretchy="false" id="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.cmml">(</mo><mrow id="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.cmml"><mn mathcolor="#0000FF" id="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.2.cmml">1</mn><mo mathcolor="#0000FF" id="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.1.cmml">−</mo><mi mathcolor="#0000FF" id="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.3.cmml">α</mi></mrow><mo mathcolor="#0000FF" stretchy="false" id="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A2.E8X.3.2.2.m1.5.5.1.1.3.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.3.cmml">​</mo><msubsup id="A2.E8X.3.2.2.m1.5.5.1.1.3.4" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.cmml"><mi id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.2.cmml">h</mi><mrow id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.cmml"><mi id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.1.cmml">​</mo><mi id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.1a" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.1.cmml">​</mo><mi id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.4" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.1b" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.1.cmml">​</mo><mi id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.5" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.1c" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.1.cmml">​</mo><mi id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.6" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.1d" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.1.cmml">​</mo><mi id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.7" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.7.cmml">l</mi></mrow><mrow id="A2.E8X.3.2.2.m1.3.3.1.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.cmml"><mo stretchy="false" id="A2.E8X.3.2.2.m1.3.3.1.3.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.cmml">(</mo><mi id="A2.E8X.3.2.2.m1.3.3.1.1" xref="A2.E8X.3.2.2.m1.3.3.1.1.cmml">L</mi><mo stretchy="false" id="A2.E8X.3.2.2.m1.3.3.1.3.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="A2.E8X.3.2.2.m1.5.5.1.1.3.3a" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.3.cmml">​</mo><mrow id="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.1.cmml"><mo stretchy="false" id="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.1.cmml">(</mo><msup id="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.1" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.1.cmml"><mi id="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.1.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.1.2.cmml">𝒁</mi><mrow id="A2.E8X.3.2.2.m1.4.4.1.1" xref="A2.E8X.3.2.2.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="A2.E8X.3.2.2.m1.4.4.1.1.2" xref="A2.E8X.3.2.2.m1.4.4.1.1.1.cmml">(</mo><mrow id="A2.E8X.3.2.2.m1.4.4.1.1.1" xref="A2.E8X.3.2.2.m1.4.4.1.1.1.cmml"><mi id="A2.E8X.3.2.2.m1.4.4.1.1.1.2" xref="A2.E8X.3.2.2.m1.4.4.1.1.1.2.cmml">L</mi><mo id="A2.E8X.3.2.2.m1.4.4.1.1.1.1" xref="A2.E8X.3.2.2.m1.4.4.1.1.1.1.cmml">−</mo><mn id="A2.E8X.3.2.2.m1.4.4.1.1.1.3" xref="A2.E8X.3.2.2.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A2.E8X.3.2.2.m1.4.4.1.1.3" xref="A2.E8X.3.2.2.m1.4.4.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.3" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E8X.3.2.2.m1.5.5.1.2" xref="A2.E8X.3.2.2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E8X.3.2.2.m1.5b"><apply id="A2.E8X.3.2.2.m1.5.5.1.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1"><plus id="A2.E8X.3.2.2.m1.5.5.1.1.4.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.4"></plus><apply id="A2.E8X.3.2.2.m1.5.5.1.1.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1"><times id="A2.E8X.3.2.2.m1.5.5.1.1.1.2.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.2"></times><ci id="A2.E8X.3.2.2.m1.5.5.1.1.1.3.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.3">𝛼</ci><apply id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4"><csymbol cd="ambiguous" id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4">superscript</csymbol><apply id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4"><csymbol cd="ambiguous" id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4">subscript</csymbol><ci id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.2.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.2">ℎ</ci><apply id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3"><times id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.1"></times><ci id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.2.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.2">𝑝</ci><ci id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.3.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.3">𝑒</ci><ci id="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.4.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.4.2.3.4">𝑟</ci></apply></apply><ci id="A2.E8X.3.2.2.m1.1.1.1.1.cmml" xref="A2.E8X.3.2.2.m1.1.1.1.1">𝐿</ci></apply><apply id="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1">superscript</csymbol><ci id="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.2">𝒁</ci><apply id="A2.E8X.3.2.2.m1.2.2.1.1.1.cmml" xref="A2.E8X.3.2.2.m1.2.2.1.1"><minus id="A2.E8X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="A2.E8X.3.2.2.m1.2.2.1.1.1.1"></minus><ci id="A2.E8X.3.2.2.m1.2.2.1.1.1.2.cmml" xref="A2.E8X.3.2.2.m1.2.2.1.1.1.2">𝐿</ci><cn type="integer" id="A2.E8X.3.2.2.m1.2.2.1.1.1.3.cmml" xref="A2.E8X.3.2.2.m1.2.2.1.1.1.3">1</cn></apply></apply></apply><apply id="A2.E8X.3.2.2.m1.5.5.1.1.3.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3"><times id="A2.E8X.3.2.2.m1.5.5.1.1.3.3.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.3"></times><apply id="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1"><minus id="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.1"></minus><cn type="integer" id="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.2.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.2">1</cn><ci id="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.3.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.2.1.1.1.3">𝛼</ci></apply><apply id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4"><csymbol cd="ambiguous" id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4">superscript</csymbol><apply id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4"><csymbol cd="ambiguous" id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4">subscript</csymbol><ci id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.2.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.2">ℎ</ci><apply id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3"><times id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.1"></times><ci id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.2.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.2">𝑔</ci><ci id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.3.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.3">𝑙</ci><ci id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.4.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.4">𝑜</ci><ci id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.5.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.5">𝑏</ci><ci id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.6.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.6">𝑎</ci><ci id="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.7.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.4.2.3.7">𝑙</ci></apply></apply><ci id="A2.E8X.3.2.2.m1.3.3.1.1.cmml" xref="A2.E8X.3.2.2.m1.3.3.1.1">𝐿</ci></apply><apply id="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1"><csymbol cd="ambiguous" id="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.1.1.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1">superscript</csymbol><ci id="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.1.2.cmml" xref="A2.E8X.3.2.2.m1.5.5.1.1.3.2.1.1.2">𝒁</ci><apply id="A2.E8X.3.2.2.m1.4.4.1.1.1.cmml" xref="A2.E8X.3.2.2.m1.4.4.1.1"><minus id="A2.E8X.3.2.2.m1.4.4.1.1.1.1.cmml" xref="A2.E8X.3.2.2.m1.4.4.1.1.1.1"></minus><ci id="A2.E8X.3.2.2.m1.4.4.1.1.1.2.cmml" xref="A2.E8X.3.2.2.m1.4.4.1.1.1.2">𝐿</ci><cn type="integer" id="A2.E8X.3.2.2.m1.4.4.1.1.1.3.cmml" xref="A2.E8X.3.2.2.m1.4.4.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E8X.3.2.2.m1.5c">\displaystyle{\color[rgb]{0,0,1}\alpha}h_{per}^{(L)}({\bm{Z}}^{(L-1)})+{\color[rgb]{0,0,1}(1-\alpha)}h_{global}^{(L)}({\bm{Z}}^{(L-1)}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
</tbody>
</table>
<p id="A2.SS1.p2.4" class="ltx_p">where <math id="A2.SS1.p2.3.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="A2.SS1.p2.3.m1.1a"><mi id="A2.SS1.p2.3.m1.1.1" xref="A2.SS1.p2.3.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.3.m1.1b"><ci id="A2.SS1.p2.3.m1.1.1.cmml" xref="A2.SS1.p2.3.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.3.m1.1c">L</annotation></semantics></math> is the number of layers of the model, <math id="A2.SS1.p2.4.m2.1" class="ltx_Math" alttext="{\bm{Z}}^{(L-1)}" display="inline"><semantics id="A2.SS1.p2.4.m2.1a"><msup id="A2.SS1.p2.4.m2.1.2" xref="A2.SS1.p2.4.m2.1.2.cmml"><mi id="A2.SS1.p2.4.m2.1.2.2" xref="A2.SS1.p2.4.m2.1.2.2.cmml">𝒁</mi><mrow id="A2.SS1.p2.4.m2.1.1.1.1" xref="A2.SS1.p2.4.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.SS1.p2.4.m2.1.1.1.1.2" xref="A2.SS1.p2.4.m2.1.1.1.1.1.cmml">(</mo><mrow id="A2.SS1.p2.4.m2.1.1.1.1.1" xref="A2.SS1.p2.4.m2.1.1.1.1.1.cmml"><mi id="A2.SS1.p2.4.m2.1.1.1.1.1.2" xref="A2.SS1.p2.4.m2.1.1.1.1.1.2.cmml">L</mi><mo id="A2.SS1.p2.4.m2.1.1.1.1.1.1" xref="A2.SS1.p2.4.m2.1.1.1.1.1.1.cmml">−</mo><mn id="A2.SS1.p2.4.m2.1.1.1.1.1.3" xref="A2.SS1.p2.4.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A2.SS1.p2.4.m2.1.1.1.1.3" xref="A2.SS1.p2.4.m2.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.4.m2.1b"><apply id="A2.SS1.p2.4.m2.1.2.cmml" xref="A2.SS1.p2.4.m2.1.2"><csymbol cd="ambiguous" id="A2.SS1.p2.4.m2.1.2.1.cmml" xref="A2.SS1.p2.4.m2.1.2">superscript</csymbol><ci id="A2.SS1.p2.4.m2.1.2.2.cmml" xref="A2.SS1.p2.4.m2.1.2.2">𝒁</ci><apply id="A2.SS1.p2.4.m2.1.1.1.1.1.cmml" xref="A2.SS1.p2.4.m2.1.1.1.1"><minus id="A2.SS1.p2.4.m2.1.1.1.1.1.1.cmml" xref="A2.SS1.p2.4.m2.1.1.1.1.1.1"></minus><ci id="A2.SS1.p2.4.m2.1.1.1.1.1.2.cmml" xref="A2.SS1.p2.4.m2.1.1.1.1.1.2">𝐿</ci><cn type="integer" id="A2.SS1.p2.4.m2.1.1.1.1.1.3.cmml" xref="A2.SS1.p2.4.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.4.m2.1c">{\bm{Z}}^{(L-1)}</annotation></semantics></math> is the hidden state from the last layer.</p>
</div>
<div id="A2.SS1.p3" class="ltx_para">
<p id="A2.SS1.p3.4" class="ltx_p">For FedPerfix, the output of one head of the self-attention layer can be formulated and rewritten <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> as</p>
<table id="A2.E9" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A2.E9X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E9X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle head({\bm{Z}})=" display="inline"><semantics id="A2.E9X.2.1.1.m1.1a"><mrow id="A2.E9X.2.1.1.m1.1.2" xref="A2.E9X.2.1.1.m1.1.2.cmml"><mrow id="A2.E9X.2.1.1.m1.1.2.2" xref="A2.E9X.2.1.1.m1.1.2.2.cmml"><mi id="A2.E9X.2.1.1.m1.1.2.2.2" xref="A2.E9X.2.1.1.m1.1.2.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="A2.E9X.2.1.1.m1.1.2.2.1" xref="A2.E9X.2.1.1.m1.1.2.2.1.cmml">​</mo><mi id="A2.E9X.2.1.1.m1.1.2.2.3" xref="A2.E9X.2.1.1.m1.1.2.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A2.E9X.2.1.1.m1.1.2.2.1a" xref="A2.E9X.2.1.1.m1.1.2.2.1.cmml">​</mo><mi id="A2.E9X.2.1.1.m1.1.2.2.4" xref="A2.E9X.2.1.1.m1.1.2.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="A2.E9X.2.1.1.m1.1.2.2.1b" xref="A2.E9X.2.1.1.m1.1.2.2.1.cmml">​</mo><mi id="A2.E9X.2.1.1.m1.1.2.2.5" xref="A2.E9X.2.1.1.m1.1.2.2.5.cmml">d</mi><mo lspace="0em" rspace="0em" id="A2.E9X.2.1.1.m1.1.2.2.1c" xref="A2.E9X.2.1.1.m1.1.2.2.1.cmml">​</mo><mrow id="A2.E9X.2.1.1.m1.1.2.2.6.2" xref="A2.E9X.2.1.1.m1.1.2.2.cmml"><mo stretchy="false" id="A2.E9X.2.1.1.m1.1.2.2.6.2.1" xref="A2.E9X.2.1.1.m1.1.2.2.cmml">(</mo><mi id="A2.E9X.2.1.1.m1.1.1" xref="A2.E9X.2.1.1.m1.1.1.cmml">𝒁</mi><mo stretchy="false" id="A2.E9X.2.1.1.m1.1.2.2.6.2.2" xref="A2.E9X.2.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="A2.E9X.2.1.1.m1.1.2.1" xref="A2.E9X.2.1.1.m1.1.2.1.cmml">=</mo><mi id="A2.E9X.2.1.1.m1.1.2.3" xref="A2.E9X.2.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.E9X.2.1.1.m1.1b"><apply id="A2.E9X.2.1.1.m1.1.2.cmml" xref="A2.E9X.2.1.1.m1.1.2"><eq id="A2.E9X.2.1.1.m1.1.2.1.cmml" xref="A2.E9X.2.1.1.m1.1.2.1"></eq><apply id="A2.E9X.2.1.1.m1.1.2.2.cmml" xref="A2.E9X.2.1.1.m1.1.2.2"><times id="A2.E9X.2.1.1.m1.1.2.2.1.cmml" xref="A2.E9X.2.1.1.m1.1.2.2.1"></times><ci id="A2.E9X.2.1.1.m1.1.2.2.2.cmml" xref="A2.E9X.2.1.1.m1.1.2.2.2">ℎ</ci><ci id="A2.E9X.2.1.1.m1.1.2.2.3.cmml" xref="A2.E9X.2.1.1.m1.1.2.2.3">𝑒</ci><ci id="A2.E9X.2.1.1.m1.1.2.2.4.cmml" xref="A2.E9X.2.1.1.m1.1.2.2.4">𝑎</ci><ci id="A2.E9X.2.1.1.m1.1.2.2.5.cmml" xref="A2.E9X.2.1.1.m1.1.2.2.5">𝑑</ci><ci id="A2.E9X.2.1.1.m1.1.1.cmml" xref="A2.E9X.2.1.1.m1.1.1">𝒁</ci></apply><csymbol cd="latexml" id="A2.E9X.2.1.1.m1.1.2.3.cmml" xref="A2.E9X.2.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9X.2.1.1.m1.1c">\displaystyle head({\bm{Z}})=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E9X.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle Attn({\bm{Z}}{\bm{W}}_{q},{\bm{Z}}[{\bm{P}}_{k},{\bm{W}}_{k}],{\bm{Z}}[{\bm{P}}_{v},{\bm{W}}_{v}])" display="inline"><semantics id="A2.E9X.3.2.2.m1.3a"><mrow id="A2.E9X.3.2.2.m1.3.3" xref="A2.E9X.3.2.2.m1.3.3.cmml"><mi id="A2.E9X.3.2.2.m1.3.3.5" xref="A2.E9X.3.2.2.m1.3.3.5.cmml">A</mi><mo lspace="0em" rspace="0em" id="A2.E9X.3.2.2.m1.3.3.4" xref="A2.E9X.3.2.2.m1.3.3.4.cmml">​</mo><mi id="A2.E9X.3.2.2.m1.3.3.6" xref="A2.E9X.3.2.2.m1.3.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.E9X.3.2.2.m1.3.3.4a" xref="A2.E9X.3.2.2.m1.3.3.4.cmml">​</mo><mi id="A2.E9X.3.2.2.m1.3.3.7" xref="A2.E9X.3.2.2.m1.3.3.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.E9X.3.2.2.m1.3.3.4b" xref="A2.E9X.3.2.2.m1.3.3.4.cmml">​</mo><mi id="A2.E9X.3.2.2.m1.3.3.8" xref="A2.E9X.3.2.2.m1.3.3.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="A2.E9X.3.2.2.m1.3.3.4c" xref="A2.E9X.3.2.2.m1.3.3.4.cmml">​</mo><mrow id="A2.E9X.3.2.2.m1.3.3.3.3" xref="A2.E9X.3.2.2.m1.3.3.3.4.cmml"><mo stretchy="false" id="A2.E9X.3.2.2.m1.3.3.3.3.4" xref="A2.E9X.3.2.2.m1.3.3.3.4.cmml">(</mo><mrow id="A2.E9X.3.2.2.m1.1.1.1.1.1" xref="A2.E9X.3.2.2.m1.1.1.1.1.1.cmml"><mi id="A2.E9X.3.2.2.m1.1.1.1.1.1.2" xref="A2.E9X.3.2.2.m1.1.1.1.1.1.2.cmml">𝒁</mi><mo lspace="0em" rspace="0em" id="A2.E9X.3.2.2.m1.1.1.1.1.1.1" xref="A2.E9X.3.2.2.m1.1.1.1.1.1.1.cmml">​</mo><msub id="A2.E9X.3.2.2.m1.1.1.1.1.1.3" xref="A2.E9X.3.2.2.m1.1.1.1.1.1.3.cmml"><mi id="A2.E9X.3.2.2.m1.1.1.1.1.1.3.2" xref="A2.E9X.3.2.2.m1.1.1.1.1.1.3.2.cmml">𝑾</mi><mi id="A2.E9X.3.2.2.m1.1.1.1.1.1.3.3" xref="A2.E9X.3.2.2.m1.1.1.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="A2.E9X.3.2.2.m1.3.3.3.3.5" xref="A2.E9X.3.2.2.m1.3.3.3.4.cmml">,</mo><mrow id="A2.E9X.3.2.2.m1.2.2.2.2.2" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.cmml"><mi id="A2.E9X.3.2.2.m1.2.2.2.2.2.4" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.4.cmml">𝒁</mi><mo lspace="0em" rspace="0em" id="A2.E9X.3.2.2.m1.2.2.2.2.2.3" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.3.cmml">​</mo><mrow id="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.3" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.2.3.cmml">[</mo><msub id="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.cmml"><mi id="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.cmml">𝑷</mi><mi id="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.cmml">k</mi></msub><mo id="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.4" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.2.3.cmml">,</mo><msub id="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2.cmml"><mi id="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2.2" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2.2.cmml">𝑾</mi><mi id="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2.3" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.5" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.2.3.cmml">]</mo></mrow></mrow><mo id="A2.E9X.3.2.2.m1.3.3.3.3.6" xref="A2.E9X.3.2.2.m1.3.3.3.4.cmml">,</mo><mrow id="A2.E9X.3.2.2.m1.3.3.3.3.3" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.cmml"><mi id="A2.E9X.3.2.2.m1.3.3.3.3.3.4" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.4.cmml">𝒁</mi><mo lspace="0em" rspace="0em" id="A2.E9X.3.2.2.m1.3.3.3.3.3.3" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.3.cmml">​</mo><mrow id="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.2.3.cmml"><mo stretchy="false" id="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.3" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.2.3.cmml">[</mo><msub id="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1.cmml"><mi id="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1.2" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1.2.cmml">𝑷</mi><mi id="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1.3" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1.3.cmml">v</mi></msub><mo id="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.4" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.2.3.cmml">,</mo><msub id="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2.cmml"><mi id="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2.2" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2.2.cmml">𝑾</mi><mi id="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2.3" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2.3.cmml">v</mi></msub><mo stretchy="false" id="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.5" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="A2.E9X.3.2.2.m1.3.3.3.3.7" xref="A2.E9X.3.2.2.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E9X.3.2.2.m1.3b"><apply id="A2.E9X.3.2.2.m1.3.3.cmml" xref="A2.E9X.3.2.2.m1.3.3"><times id="A2.E9X.3.2.2.m1.3.3.4.cmml" xref="A2.E9X.3.2.2.m1.3.3.4"></times><ci id="A2.E9X.3.2.2.m1.3.3.5.cmml" xref="A2.E9X.3.2.2.m1.3.3.5">𝐴</ci><ci id="A2.E9X.3.2.2.m1.3.3.6.cmml" xref="A2.E9X.3.2.2.m1.3.3.6">𝑡</ci><ci id="A2.E9X.3.2.2.m1.3.3.7.cmml" xref="A2.E9X.3.2.2.m1.3.3.7">𝑡</ci><ci id="A2.E9X.3.2.2.m1.3.3.8.cmml" xref="A2.E9X.3.2.2.m1.3.3.8">𝑛</ci><vector id="A2.E9X.3.2.2.m1.3.3.3.4.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3"><apply id="A2.E9X.3.2.2.m1.1.1.1.1.1.cmml" xref="A2.E9X.3.2.2.m1.1.1.1.1.1"><times id="A2.E9X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="A2.E9X.3.2.2.m1.1.1.1.1.1.1"></times><ci id="A2.E9X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="A2.E9X.3.2.2.m1.1.1.1.1.1.2">𝒁</ci><apply id="A2.E9X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="A2.E9X.3.2.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E9X.3.2.2.m1.1.1.1.1.1.3.1.cmml" xref="A2.E9X.3.2.2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E9X.3.2.2.m1.1.1.1.1.1.3.2.cmml" xref="A2.E9X.3.2.2.m1.1.1.1.1.1.3.2">𝑾</ci><ci id="A2.E9X.3.2.2.m1.1.1.1.1.1.3.3.cmml" xref="A2.E9X.3.2.2.m1.1.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="A2.E9X.3.2.2.m1.2.2.2.2.2.cmml" xref="A2.E9X.3.2.2.m1.2.2.2.2.2"><times id="A2.E9X.3.2.2.m1.2.2.2.2.2.3.cmml" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.3"></times><ci id="A2.E9X.3.2.2.m1.2.2.2.2.2.4.cmml" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.4">𝒁</ci><interval closure="closed" id="A2.E9X.3.2.2.m1.2.2.2.2.2.2.3.cmml" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2"><apply id="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.cmml" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.1.cmml" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.cmml" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2">𝑷</ci><ci id="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.cmml" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3">𝑘</ci></apply><apply id="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2.cmml" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2.1.cmml" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2.2.cmml" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2.2">𝑾</ci><ci id="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2.3.cmml" xref="A2.E9X.3.2.2.m1.2.2.2.2.2.2.2.2.3">𝑘</ci></apply></interval></apply><apply id="A2.E9X.3.2.2.m1.3.3.3.3.3.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3.3"><times id="A2.E9X.3.2.2.m1.3.3.3.3.3.3.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.3"></times><ci id="A2.E9X.3.2.2.m1.3.3.3.3.3.4.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.4">𝒁</ci><interval closure="closed" id="A2.E9X.3.2.2.m1.3.3.3.3.3.2.3.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2"><apply id="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1.1.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1">subscript</csymbol><ci id="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1.2.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1.2">𝑷</ci><ci id="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1.3.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.1.1.1.3">𝑣</ci></apply><apply id="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2.1.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2">subscript</csymbol><ci id="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2.2.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2.2">𝑾</ci><ci id="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2.3.cmml" xref="A2.E9X.3.2.2.m1.3.3.3.3.3.2.2.2.3">𝑣</ci></apply></interval></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9X.3.2.2.m1.3c">\displaystyle Attn({\bm{Z}}{\bm{W}}_{q},{\bm{Z}}[{\bm{P}}_{k},{\bm{W}}_{k}],{\bm{Z}}[{\bm{P}}_{v},{\bm{W}}_{v}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="6" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
<tr id="A2.E9Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E9Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="A2.E9Xa.2.1.1.m1.1a"><mo id="A2.E9Xa.2.1.1.m1.1.1" xref="A2.E9Xa.2.1.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="A2.E9Xa.2.1.1.m1.1b"><eq id="A2.E9Xa.2.1.1.m1.1.1.cmml" xref="A2.E9Xa.2.1.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="A2.E9Xa.2.1.1.m1.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E9Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\text{softmax}({\bm{Z}}{\bm{W}}_{q}[{\bm{P}}_{k},{\bm{W}}_{k}]^{\top})\begin{bmatrix}{\bm{P}}_{v}\\
{\bm{Z}}{\bm{W}}_{v}\end{bmatrix}" display="inline"><semantics id="A2.E9Xa.3.2.2.m1.1a"><mrow id="A2.E9Xa.3.2.2.m1.1.1" xref="A2.E9Xa.3.2.2.m1.1.1.cmml"><mtext id="A2.E9Xa.3.2.2.m1.1.1.3" xref="A2.E9Xa.3.2.2.m1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="A2.E9Xa.3.2.2.m1.1.1.2" xref="A2.E9Xa.3.2.2.m1.1.1.2.cmml">​</mo><mrow id="A2.E9Xa.3.2.2.m1.1.1.1.1" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.E9Xa.3.2.2.m1.1.1.1.1.2" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E9Xa.3.2.2.m1.1.1.1.1.1" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.cmml"><mi id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.4" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.4.cmml">𝒁</mi><mo lspace="0em" rspace="0em" id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.3" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.3.cmml">​</mo><msub id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5.cmml"><mi id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5.2" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5.2.cmml">𝑾</mi><mi id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5.3" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5.3.cmml">q</mi></msub><mo lspace="0em" rspace="0em" id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.3a" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.3.cmml">​</mo><msup id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.cmml"><mrow id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml">[</mo><msub id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝑷</mi><mi id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.4" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.cmml"><mi id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.2" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.2.cmml">𝑾</mi><mi id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.3" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.5" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml">]</mo></mrow><mo id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.4" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.4.cmml">⊤</mo></msup></mrow><mo stretchy="false" id="A2.E9Xa.3.2.2.m1.1.1.1.1.3" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A2.E9Xa.3.2.2.m1.1.1.2a" xref="A2.E9Xa.3.2.2.m1.1.1.2.cmml">​</mo><mrow id="A2.E9.m1.1.1.1.1.1.1a.3" xref="A2.E9.m1.1.1.1.1.1.1a.2.cmml"><mo id="A2.E9.m1.1.1.1.1.1.1a.3.1" xref="A2.E9.m1.1.1.1.1.1.1a.2.1.cmml">[</mo><mtable rowspacing="0pt" id="A2.E9.m1.1.1.1.1.1.1.1.1.mf" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtr id="A2.E9.m1.1.1.1.1.1.1.1.1.mfa" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtd id="A2.E9.m1.1.1.1.1.1.1.1.1.mfb" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.cmml"><msub id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml"><mi id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml">𝑷</mi><mi id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.cmml">v</mi></msub></mtd></mtr><mtr id="A2.E9.m1.1.1.1.1.1.1.1.1.mfc" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtd id="A2.E9.m1.1.1.1.1.1.1.1.1.mfd" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.cmml"><mrow id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.cmml"><mi id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.2" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.2.cmml">𝒁</mi><mo lspace="0em" rspace="0em" id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.1" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.1.cmml">​</mo><msub id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3.cmml"><mi id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3.2" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3.2.cmml">𝑾</mi><mi id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3.3" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3.3.cmml">v</mi></msub></mrow></mtd></mtr></mtable><mo id="A2.E9.m1.1.1.1.1.1.1a.3.2" xref="A2.E9.m1.1.1.1.1.1.1a.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E9Xa.3.2.2.m1.1b"><apply id="A2.E9Xa.3.2.2.m1.1.1.cmml" xref="A2.E9Xa.3.2.2.m1.1.1"><times id="A2.E9Xa.3.2.2.m1.1.1.2.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.2"></times><ci id="A2.E9Xa.3.2.2.m1.1.1.3a.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.3"><mtext id="A2.E9Xa.3.2.2.m1.1.1.3.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.3">softmax</mtext></ci><apply id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1"><times id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.3.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.3"></times><ci id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.4.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.4">𝒁</ci><apply id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5.1.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5">subscript</csymbol><ci id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5.2.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5.2">𝑾</ci><ci id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5.3.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.5.3">𝑞</ci></apply><apply id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.3.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2">superscript</csymbol><interval closure="closed" id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2"><apply id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">𝑷</ci><ci id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.2">𝑾</ci><ci id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.3">𝑘</ci></apply></interval><csymbol cd="latexml" id="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.4.cmml" xref="A2.E9Xa.3.2.2.m1.1.1.1.1.1.2.4">top</csymbol></apply></apply><apply id="A2.E9.m1.1.1.1.1.1.1a.2.cmml" xref="A2.E9.m1.1.1.1.1.1.1a.3"><csymbol cd="latexml" id="A2.E9.m1.1.1.1.1.1.1a.2.1.cmml" xref="A2.E9.m1.1.1.1.1.1.1a.3.1">matrix</csymbol><matrix id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf"><matrixrow id="A2.E9.m1.1.1.1.1.1.1.1.1.mfa.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf"><apply id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1"><csymbol cd="ambiguous" id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1.1.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1">subscript</csymbol><ci id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2">𝑷</ci><ci id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3">𝑣</ci></apply></matrixrow><matrixrow id="A2.E9.m1.1.1.1.1.1.1.1.1.mfb.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf"><apply id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1"><times id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.1.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.1"></times><ci id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.2.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.2">𝒁</ci><apply id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3"><csymbol cd="ambiguous" id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3.1.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3">subscript</csymbol><ci id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3.2.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3.2">𝑾</ci><ci id="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3.3.cmml" xref="A2.E9.m1.1.1.1.1.1.1.1.1.mf.2.1.1.3.3">𝑣</ci></apply></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9Xa.3.2.2.m1.1c">\displaystyle\text{softmax}({\bm{Z}}{\bm{W}}_{q}[{\bm{P}}_{k},{\bm{W}}_{k}]^{\top})\begin{bmatrix}{\bm{P}}_{v}\\
{\bm{Z}}{\bm{W}}_{v}\end{bmatrix}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="A2.E9Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E9Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="A2.E9Xb.2.1.1.m1.1a"><mo id="A2.E9Xb.2.1.1.m1.1.1" xref="A2.E9Xb.2.1.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="A2.E9Xb.2.1.1.m1.1b"><eq id="A2.E9Xb.2.1.1.m1.1.1.cmml" xref="A2.E9Xb.2.1.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="A2.E9Xb.2.1.1.m1.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E9Xb.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle(1-\lambda({\bm{Z}}))\text{softmax}({\bm{Z}}{\bm{W}}_{q}{\bm{W}}_{k}^{\top}{\bm{Z}}^{\top}){\bm{Z}}{\bm{W}}_{v}" display="inline"><semantics id="A2.E9Xb.3.2.2.m1.3a"><mrow id="A2.E9Xb.3.2.2.m1.3.3" xref="A2.E9Xb.3.2.2.m1.3.3.cmml"><mrow id="A2.E9Xb.3.2.2.m1.2.2.1.1" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="A2.E9Xb.3.2.2.m1.2.2.1.1.2" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.cmml">(</mo><mrow id="A2.E9Xb.3.2.2.m1.2.2.1.1.1" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.cmml"><mn id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.2" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.2.cmml">1</mn><mo id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.1" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.1.cmml">−</mo><mrow id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.cmml"><mi id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.2" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.1" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.1.cmml">​</mo><mrow id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.3.2" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.cmml"><mo stretchy="false" id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.3.2.1" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.cmml">(</mo><mi id="A2.E9Xb.3.2.2.m1.1.1" xref="A2.E9Xb.3.2.2.m1.1.1.cmml">𝒁</mi><mo stretchy="false" id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.3.2.2" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="A2.E9Xb.3.2.2.m1.2.2.1.1.3" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A2.E9Xb.3.2.2.m1.3.3.3" xref="A2.E9Xb.3.2.2.m1.3.3.3.cmml">​</mo><mtext id="A2.E9Xb.3.2.2.m1.3.3.4" xref="A2.E9Xb.3.2.2.m1.3.3.4a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="A2.E9Xb.3.2.2.m1.3.3.3a" xref="A2.E9Xb.3.2.2.m1.3.3.3.cmml">​</mo><mrow id="A2.E9Xb.3.2.2.m1.3.3.2.1" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.cmml"><mo stretchy="false" id="A2.E9Xb.3.2.2.m1.3.3.2.1.2" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.cmml">(</mo><mrow id="A2.E9Xb.3.2.2.m1.3.3.2.1.1" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.cmml"><mi id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.2" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.2.cmml">𝒁</mi><mo lspace="0em" rspace="0em" id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.1" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.1.cmml">​</mo><msub id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3.cmml"><mi id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3.2" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3.2.cmml">𝑾</mi><mi id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3.3" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3.3.cmml">q</mi></msub><mo lspace="0em" rspace="0em" id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.1a" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.1.cmml">​</mo><msubsup id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.cmml"><mi id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.2.2" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.2.2.cmml">𝑾</mi><mi id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.2.3" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.2.3.cmml">k</mi><mo id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.3" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.1b" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.1.cmml">​</mo><msup id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5.cmml"><mi id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5.2" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5.2.cmml">𝒁</mi><mo id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5.3" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5.3.cmml">⊤</mo></msup></mrow><mo stretchy="false" id="A2.E9Xb.3.2.2.m1.3.3.2.1.3" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A2.E9Xb.3.2.2.m1.3.3.3b" xref="A2.E9Xb.3.2.2.m1.3.3.3.cmml">​</mo><mi id="A2.E9Xb.3.2.2.m1.3.3.5" xref="A2.E9Xb.3.2.2.m1.3.3.5.cmml">𝒁</mi><mo lspace="0em" rspace="0em" id="A2.E9Xb.3.2.2.m1.3.3.3c" xref="A2.E9Xb.3.2.2.m1.3.3.3.cmml">​</mo><msub id="A2.E9Xb.3.2.2.m1.3.3.6" xref="A2.E9Xb.3.2.2.m1.3.3.6.cmml"><mi id="A2.E9Xb.3.2.2.m1.3.3.6.2" xref="A2.E9Xb.3.2.2.m1.3.3.6.2.cmml">𝑾</mi><mi id="A2.E9Xb.3.2.2.m1.3.3.6.3" xref="A2.E9Xb.3.2.2.m1.3.3.6.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.E9Xb.3.2.2.m1.3b"><apply id="A2.E9Xb.3.2.2.m1.3.3.cmml" xref="A2.E9Xb.3.2.2.m1.3.3"><times id="A2.E9Xb.3.2.2.m1.3.3.3.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.3"></times><apply id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.cmml" xref="A2.E9Xb.3.2.2.m1.2.2.1.1"><minus id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.1.cmml" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.1"></minus><cn type="integer" id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.2.cmml" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.2">1</cn><apply id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.cmml" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3"><times id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.1.cmml" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.1"></times><ci id="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.2.cmml" xref="A2.E9Xb.3.2.2.m1.2.2.1.1.1.3.2">𝜆</ci><ci id="A2.E9Xb.3.2.2.m1.1.1.cmml" xref="A2.E9Xb.3.2.2.m1.1.1">𝒁</ci></apply></apply><ci id="A2.E9Xb.3.2.2.m1.3.3.4a.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.4"><mtext id="A2.E9Xb.3.2.2.m1.3.3.4.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.4">softmax</mtext></ci><apply id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1"><times id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.1.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.1"></times><ci id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.2.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.2">𝒁</ci><apply id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3"><csymbol cd="ambiguous" id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3.1.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3">subscript</csymbol><ci id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3.2.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3.2">𝑾</ci><ci id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3.3.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.3.3">𝑞</ci></apply><apply id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4"><csymbol cd="ambiguous" id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.1.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4">superscript</csymbol><apply id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.2.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4"><csymbol cd="ambiguous" id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.2.1.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4">subscript</csymbol><ci id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.2.2.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.2.2">𝑾</ci><ci id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.2.3.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.2.3">𝑘</ci></apply><csymbol cd="latexml" id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.3.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.4.3">top</csymbol></apply><apply id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5"><csymbol cd="ambiguous" id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5.1.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5">superscript</csymbol><ci id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5.2.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5.2">𝒁</ci><csymbol cd="latexml" id="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5.3.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.2.1.1.5.3">top</csymbol></apply></apply><ci id="A2.E9Xb.3.2.2.m1.3.3.5.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.5">𝒁</ci><apply id="A2.E9Xb.3.2.2.m1.3.3.6.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.6"><csymbol cd="ambiguous" id="A2.E9Xb.3.2.2.m1.3.3.6.1.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.6">subscript</csymbol><ci id="A2.E9Xb.3.2.2.m1.3.3.6.2.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.6.2">𝑾</ci><ci id="A2.E9Xb.3.2.2.m1.3.3.6.3.cmml" xref="A2.E9Xb.3.2.2.m1.3.3.6.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9Xb.3.2.2.m1.3c">\displaystyle(1-\lambda({\bm{Z}}))\text{softmax}({\bm{Z}}{\bm{W}}_{q}{\bm{W}}_{k}^{\top}{\bm{Z}}^{\top}){\bm{Z}}{\bm{W}}_{v}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="A2.E9Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E9Xc.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle+\lambda({\bm{Z}})\text{softmax}({\bm{Z}}{\bm{W}}_{q}{\bm{P}}_{k}^{\top}){\bm{P}}_{v}" display="inline"><semantics id="A2.E9Xc.2.1.1.m1.2a"><mrow id="A2.E9Xc.2.1.1.m1.2.2" xref="A2.E9Xc.2.1.1.m1.2.2.cmml"><mo id="A2.E9Xc.2.1.1.m1.2.2a" xref="A2.E9Xc.2.1.1.m1.2.2.cmml">+</mo><mrow id="A2.E9Xc.2.1.1.m1.2.2.1" xref="A2.E9Xc.2.1.1.m1.2.2.1.cmml"><mi id="A2.E9Xc.2.1.1.m1.2.2.1.3" xref="A2.E9Xc.2.1.1.m1.2.2.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A2.E9Xc.2.1.1.m1.2.2.1.2" xref="A2.E9Xc.2.1.1.m1.2.2.1.2.cmml">​</mo><mrow id="A2.E9Xc.2.1.1.m1.2.2.1.4.2" xref="A2.E9Xc.2.1.1.m1.2.2.1.cmml"><mo stretchy="false" id="A2.E9Xc.2.1.1.m1.2.2.1.4.2.1" xref="A2.E9Xc.2.1.1.m1.2.2.1.cmml">(</mo><mi id="A2.E9Xc.2.1.1.m1.1.1" xref="A2.E9Xc.2.1.1.m1.1.1.cmml">𝒁</mi><mo stretchy="false" id="A2.E9Xc.2.1.1.m1.2.2.1.4.2.2" xref="A2.E9Xc.2.1.1.m1.2.2.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A2.E9Xc.2.1.1.m1.2.2.1.2a" xref="A2.E9Xc.2.1.1.m1.2.2.1.2.cmml">​</mo><mtext id="A2.E9Xc.2.1.1.m1.2.2.1.5" xref="A2.E9Xc.2.1.1.m1.2.2.1.5a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="A2.E9Xc.2.1.1.m1.2.2.1.2b" xref="A2.E9Xc.2.1.1.m1.2.2.1.2.cmml">​</mo><mrow id="A2.E9Xc.2.1.1.m1.2.2.1.1.1" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.2" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.cmml"><mi id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.2" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.2.cmml">𝒁</mi><mo lspace="0em" rspace="0em" id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.1" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.1.cmml">​</mo><msub id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3.cmml"><mi id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3.2" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3.2.cmml">𝑾</mi><mi id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3.3" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3.3.cmml">q</mi></msub><mo lspace="0em" rspace="0em" id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.1a" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.1.cmml">​</mo><msubsup id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.cmml"><mi id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.2.2" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.2.2.cmml">𝑷</mi><mi id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.2.3" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.2.3.cmml">k</mi><mo id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.3" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.3.cmml">⊤</mo></msubsup></mrow><mo stretchy="false" id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.3" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A2.E9Xc.2.1.1.m1.2.2.1.2c" xref="A2.E9Xc.2.1.1.m1.2.2.1.2.cmml">​</mo><msub id="A2.E9Xc.2.1.1.m1.2.2.1.6" xref="A2.E9Xc.2.1.1.m1.2.2.1.6.cmml"><mi id="A2.E9Xc.2.1.1.m1.2.2.1.6.2" xref="A2.E9Xc.2.1.1.m1.2.2.1.6.2.cmml">𝑷</mi><mi id="A2.E9Xc.2.1.1.m1.2.2.1.6.3" xref="A2.E9Xc.2.1.1.m1.2.2.1.6.3.cmml">v</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E9Xc.2.1.1.m1.2b"><apply id="A2.E9Xc.2.1.1.m1.2.2.cmml" xref="A2.E9Xc.2.1.1.m1.2.2"><plus id="A2.E9Xc.2.1.1.m1.2.2.2.cmml" xref="A2.E9Xc.2.1.1.m1.2.2"></plus><apply id="A2.E9Xc.2.1.1.m1.2.2.1.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1"><times id="A2.E9Xc.2.1.1.m1.2.2.1.2.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.2"></times><ci id="A2.E9Xc.2.1.1.m1.2.2.1.3.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.3">𝜆</ci><ci id="A2.E9Xc.2.1.1.m1.1.1.cmml" xref="A2.E9Xc.2.1.1.m1.1.1">𝒁</ci><ci id="A2.E9Xc.2.1.1.m1.2.2.1.5a.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.5"><mtext id="A2.E9Xc.2.1.1.m1.2.2.1.5.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.5">softmax</mtext></ci><apply id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1"><times id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.1"></times><ci id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.2">𝒁</ci><apply id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3.1.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3.2.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3.2">𝑾</ci><ci id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3.3.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.3.3">𝑞</ci></apply><apply id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.1.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4">superscript</csymbol><apply id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.2.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.2.1.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4">subscript</csymbol><ci id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.2.2.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.2.2">𝑷</ci><ci id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.2.3.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.2.3">𝑘</ci></apply><csymbol cd="latexml" id="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.3.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.1.1.1.4.3">top</csymbol></apply></apply><apply id="A2.E9Xc.2.1.1.m1.2.2.1.6.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.6"><csymbol cd="ambiguous" id="A2.E9Xc.2.1.1.m1.2.2.1.6.1.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.6">subscript</csymbol><ci id="A2.E9Xc.2.1.1.m1.2.2.1.6.2.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.6.2">𝑷</ci><ci id="A2.E9Xc.2.1.1.m1.2.2.1.6.3.cmml" xref="A2.E9Xc.2.1.1.m1.2.2.1.6.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9Xc.2.1.1.m1.2c">\displaystyle+\lambda({\bm{Z}})\text{softmax}({\bm{Z}}{\bm{W}}_{q}{\bm{P}}_{k}^{\top}){\bm{P}}_{v}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="A2.E9Xd" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E9Xd.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="A2.E9Xd.2.1.1.m1.1a"><mo id="A2.E9Xd.2.1.1.m1.1.1" xref="A2.E9Xd.2.1.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="A2.E9Xd.2.1.1.m1.1b"><eq id="A2.E9Xd.2.1.1.m1.1.1.cmml" xref="A2.E9Xd.2.1.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="A2.E9Xd.2.1.1.m1.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E9Xd.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle{\color[rgb]{0,0,1}(1-\lambda({\bm{Z}}))}Attn({\bm{Z}}{\bm{W}}_{q},x{\bm{W}}_{k},x{\bm{W}}_{v})" display="inline"><semantics id="A2.E9Xd.3.2.2.m1.5a"><mrow id="A2.E9Xd.3.2.2.m1.5.5" xref="A2.E9Xd.3.2.2.m1.5.5.cmml"><mrow id="A2.E9Xd.3.2.2.m1.2.2.1.1" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.cmml"><mo mathcolor="#0000FF" stretchy="false" id="A2.E9Xd.3.2.2.m1.2.2.1.1.2" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.cmml">(</mo><mrow id="A2.E9Xd.3.2.2.m1.2.2.1.1.1" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.cmml"><mn mathcolor="#0000FF" id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.2" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.2.cmml">1</mn><mo mathcolor="#0000FF" id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.1" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.1.cmml">−</mo><mrow id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.cmml"><mi mathcolor="#0000FF" id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.2" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.1" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.1.cmml">​</mo><mrow id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.3.2" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.cmml"><mo mathcolor="#0000FF" stretchy="false" id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.3.2.1" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.cmml">(</mo><mi mathcolor="#0000FF" id="A2.E9Xd.3.2.2.m1.1.1" xref="A2.E9Xd.3.2.2.m1.1.1.cmml">𝒁</mi><mo mathcolor="#0000FF" stretchy="false" id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.3.2.2" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo mathcolor="#0000FF" stretchy="false" id="A2.E9Xd.3.2.2.m1.2.2.1.1.3" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A2.E9Xd.3.2.2.m1.5.5.5" xref="A2.E9Xd.3.2.2.m1.5.5.5.cmml">​</mo><mi id="A2.E9Xd.3.2.2.m1.5.5.6" xref="A2.E9Xd.3.2.2.m1.5.5.6.cmml">A</mi><mo lspace="0em" rspace="0em" id="A2.E9Xd.3.2.2.m1.5.5.5a" xref="A2.E9Xd.3.2.2.m1.5.5.5.cmml">​</mo><mi id="A2.E9Xd.3.2.2.m1.5.5.7" xref="A2.E9Xd.3.2.2.m1.5.5.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.E9Xd.3.2.2.m1.5.5.5b" xref="A2.E9Xd.3.2.2.m1.5.5.5.cmml">​</mo><mi id="A2.E9Xd.3.2.2.m1.5.5.8" xref="A2.E9Xd.3.2.2.m1.5.5.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.E9Xd.3.2.2.m1.5.5.5c" xref="A2.E9Xd.3.2.2.m1.5.5.5.cmml">​</mo><mi id="A2.E9Xd.3.2.2.m1.5.5.9" xref="A2.E9Xd.3.2.2.m1.5.5.9.cmml">n</mi><mo lspace="0em" rspace="0em" id="A2.E9Xd.3.2.2.m1.5.5.5d" xref="A2.E9Xd.3.2.2.m1.5.5.5.cmml">​</mo><mrow id="A2.E9Xd.3.2.2.m1.5.5.4.3" xref="A2.E9Xd.3.2.2.m1.5.5.4.4.cmml"><mo stretchy="false" id="A2.E9Xd.3.2.2.m1.5.5.4.3.4" xref="A2.E9Xd.3.2.2.m1.5.5.4.4.cmml">(</mo><mrow id="A2.E9Xd.3.2.2.m1.3.3.2.1.1" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1.cmml"><mi id="A2.E9Xd.3.2.2.m1.3.3.2.1.1.2" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1.2.cmml">𝒁</mi><mo lspace="0em" rspace="0em" id="A2.E9Xd.3.2.2.m1.3.3.2.1.1.1" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1.1.cmml">​</mo><msub id="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3.cmml"><mi id="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3.2" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3.2.cmml">𝑾</mi><mi id="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3.3" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3.3.cmml">q</mi></msub></mrow><mo id="A2.E9Xd.3.2.2.m1.5.5.4.3.5" xref="A2.E9Xd.3.2.2.m1.5.5.4.4.cmml">,</mo><mrow id="A2.E9Xd.3.2.2.m1.4.4.3.2.2" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2.cmml"><mi id="A2.E9Xd.3.2.2.m1.4.4.3.2.2.2" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="A2.E9Xd.3.2.2.m1.4.4.3.2.2.1" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2.1.cmml">​</mo><msub id="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3.cmml"><mi id="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3.2" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3.2.cmml">𝑾</mi><mi id="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3.3" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3.3.cmml">k</mi></msub></mrow><mo id="A2.E9Xd.3.2.2.m1.5.5.4.3.6" xref="A2.E9Xd.3.2.2.m1.5.5.4.4.cmml">,</mo><mrow id="A2.E9Xd.3.2.2.m1.5.5.4.3.3" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3.cmml"><mi id="A2.E9Xd.3.2.2.m1.5.5.4.3.3.2" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="A2.E9Xd.3.2.2.m1.5.5.4.3.3.1" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3.1.cmml">​</mo><msub id="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3.cmml"><mi id="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3.2" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3.2.cmml">𝑾</mi><mi id="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3.3" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3.3.cmml">v</mi></msub></mrow><mo stretchy="false" id="A2.E9Xd.3.2.2.m1.5.5.4.3.7" xref="A2.E9Xd.3.2.2.m1.5.5.4.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E9Xd.3.2.2.m1.5b"><apply id="A2.E9Xd.3.2.2.m1.5.5.cmml" xref="A2.E9Xd.3.2.2.m1.5.5"><times id="A2.E9Xd.3.2.2.m1.5.5.5.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.5"></times><apply id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.cmml" xref="A2.E9Xd.3.2.2.m1.2.2.1.1"><minus id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.1.cmml" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.1"></minus><cn type="integer" id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.2.cmml" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.2">1</cn><apply id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.cmml" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3"><times id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.1.cmml" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.1"></times><ci id="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.2.cmml" xref="A2.E9Xd.3.2.2.m1.2.2.1.1.1.3.2">𝜆</ci><ci id="A2.E9Xd.3.2.2.m1.1.1.cmml" xref="A2.E9Xd.3.2.2.m1.1.1">𝒁</ci></apply></apply><ci id="A2.E9Xd.3.2.2.m1.5.5.6.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.6">𝐴</ci><ci id="A2.E9Xd.3.2.2.m1.5.5.7.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.7">𝑡</ci><ci id="A2.E9Xd.3.2.2.m1.5.5.8.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.8">𝑡</ci><ci id="A2.E9Xd.3.2.2.m1.5.5.9.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.9">𝑛</ci><vector id="A2.E9Xd.3.2.2.m1.5.5.4.4.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.4.3"><apply id="A2.E9Xd.3.2.2.m1.3.3.2.1.1.cmml" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1"><times id="A2.E9Xd.3.2.2.m1.3.3.2.1.1.1.cmml" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1.1"></times><ci id="A2.E9Xd.3.2.2.m1.3.3.2.1.1.2.cmml" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1.2">𝒁</ci><apply id="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3.cmml" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3"><csymbol cd="ambiguous" id="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3.1.cmml" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3">subscript</csymbol><ci id="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3.2.cmml" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3.2">𝑾</ci><ci id="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3.3.cmml" xref="A2.E9Xd.3.2.2.m1.3.3.2.1.1.3.3">𝑞</ci></apply></apply><apply id="A2.E9Xd.3.2.2.m1.4.4.3.2.2.cmml" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2"><times id="A2.E9Xd.3.2.2.m1.4.4.3.2.2.1.cmml" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2.1"></times><ci id="A2.E9Xd.3.2.2.m1.4.4.3.2.2.2.cmml" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2.2">𝑥</ci><apply id="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3.cmml" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3"><csymbol cd="ambiguous" id="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3.1.cmml" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3">subscript</csymbol><ci id="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3.2.cmml" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3.2">𝑾</ci><ci id="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3.3.cmml" xref="A2.E9Xd.3.2.2.m1.4.4.3.2.2.3.3">𝑘</ci></apply></apply><apply id="A2.E9Xd.3.2.2.m1.5.5.4.3.3.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3"><times id="A2.E9Xd.3.2.2.m1.5.5.4.3.3.1.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3.1"></times><ci id="A2.E9Xd.3.2.2.m1.5.5.4.3.3.2.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3.2">𝑥</ci><apply id="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3"><csymbol cd="ambiguous" id="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3.1.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3">subscript</csymbol><ci id="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3.2.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3.2">𝑾</ci><ci id="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3.3.cmml" xref="A2.E9Xd.3.2.2.m1.5.5.4.3.3.3.3">𝑣</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9Xd.3.2.2.m1.5c">\displaystyle{\color[rgb]{0,0,1}(1-\lambda({\bm{Z}}))}Attn({\bm{Z}}{\bm{W}}_{q},x{\bm{W}}_{k},x{\bm{W}}_{v})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="A2.E9Xe" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E9Xe.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle+{\color[rgb]{0,0,1}\lambda({\bm{Z}})}Attn({\bm{Z}}{\bm{W}}_{q},{\bm{P}}_{k},{\bm{P}}_{v})" display="inline"><semantics id="A2.E9Xe.2.1.1.m1.4a"><mrow id="A2.E9Xe.2.1.1.m1.4.4" xref="A2.E9Xe.2.1.1.m1.4.4.cmml"><mo id="A2.E9Xe.2.1.1.m1.4.4a" xref="A2.E9Xe.2.1.1.m1.4.4.cmml">+</mo><mrow id="A2.E9Xe.2.1.1.m1.4.4.3" xref="A2.E9Xe.2.1.1.m1.4.4.3.cmml"><mi mathcolor="#0000FF" id="A2.E9Xe.2.1.1.m1.4.4.3.5" xref="A2.E9Xe.2.1.1.m1.4.4.3.5.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A2.E9Xe.2.1.1.m1.4.4.3.4" xref="A2.E9Xe.2.1.1.m1.4.4.3.4.cmml">​</mo><mrow id="A2.E9Xe.2.1.1.m1.4.4.3.6.2" xref="A2.E9Xe.2.1.1.m1.4.4.3.cmml"><mo mathcolor="#0000FF" stretchy="false" id="A2.E9Xe.2.1.1.m1.4.4.3.6.2.1" xref="A2.E9Xe.2.1.1.m1.4.4.3.cmml">(</mo><mi mathcolor="#0000FF" id="A2.E9Xe.2.1.1.m1.1.1" xref="A2.E9Xe.2.1.1.m1.1.1.cmml">𝒁</mi><mo mathcolor="#0000FF" stretchy="false" id="A2.E9Xe.2.1.1.m1.4.4.3.6.2.2" xref="A2.E9Xe.2.1.1.m1.4.4.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A2.E9Xe.2.1.1.m1.4.4.3.4a" xref="A2.E9Xe.2.1.1.m1.4.4.3.4.cmml">​</mo><mi id="A2.E9Xe.2.1.1.m1.4.4.3.7" xref="A2.E9Xe.2.1.1.m1.4.4.3.7.cmml">A</mi><mo lspace="0em" rspace="0em" id="A2.E9Xe.2.1.1.m1.4.4.3.4b" xref="A2.E9Xe.2.1.1.m1.4.4.3.4.cmml">​</mo><mi id="A2.E9Xe.2.1.1.m1.4.4.3.8" xref="A2.E9Xe.2.1.1.m1.4.4.3.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.E9Xe.2.1.1.m1.4.4.3.4c" xref="A2.E9Xe.2.1.1.m1.4.4.3.4.cmml">​</mo><mi id="A2.E9Xe.2.1.1.m1.4.4.3.9" xref="A2.E9Xe.2.1.1.m1.4.4.3.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.E9Xe.2.1.1.m1.4.4.3.4d" xref="A2.E9Xe.2.1.1.m1.4.4.3.4.cmml">​</mo><mi id="A2.E9Xe.2.1.1.m1.4.4.3.10" xref="A2.E9Xe.2.1.1.m1.4.4.3.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="A2.E9Xe.2.1.1.m1.4.4.3.4e" xref="A2.E9Xe.2.1.1.m1.4.4.3.4.cmml">​</mo><mrow id="A2.E9Xe.2.1.1.m1.4.4.3.3.3" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.4.cmml"><mo stretchy="false" id="A2.E9Xe.2.1.1.m1.4.4.3.3.3.4" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.4.cmml">(</mo><mrow id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.cmml"><mi id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.2" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.2.cmml">𝒁</mi><mo lspace="0em" rspace="0em" id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.1" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.1.cmml">​</mo><msub id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3.cmml"><mi id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3.2" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3.2.cmml">𝑾</mi><mi id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3.3" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="A2.E9Xe.2.1.1.m1.4.4.3.3.3.5" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.4.cmml">,</mo><msub id="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2" xref="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2.cmml"><mi id="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2.2" xref="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2.2.cmml">𝑷</mi><mi id="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2.3" xref="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2.3.cmml">k</mi></msub><mo id="A2.E9Xe.2.1.1.m1.4.4.3.3.3.6" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.4.cmml">,</mo><msub id="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3.cmml"><mi id="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3.2" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3.2.cmml">𝑷</mi><mi id="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3.3" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3.3.cmml">v</mi></msub><mo stretchy="false" id="A2.E9Xe.2.1.1.m1.4.4.3.3.3.7" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E9Xe.2.1.1.m1.4b"><apply id="A2.E9Xe.2.1.1.m1.4.4.cmml" xref="A2.E9Xe.2.1.1.m1.4.4"><plus id="A2.E9Xe.2.1.1.m1.4.4.4.cmml" xref="A2.E9Xe.2.1.1.m1.4.4"></plus><apply id="A2.E9Xe.2.1.1.m1.4.4.3.cmml" xref="A2.E9Xe.2.1.1.m1.4.4.3"><times id="A2.E9Xe.2.1.1.m1.4.4.3.4.cmml" xref="A2.E9Xe.2.1.1.m1.4.4.3.4"></times><ci id="A2.E9Xe.2.1.1.m1.4.4.3.5.cmml" xref="A2.E9Xe.2.1.1.m1.4.4.3.5">𝜆</ci><ci id="A2.E9Xe.2.1.1.m1.1.1.cmml" xref="A2.E9Xe.2.1.1.m1.1.1">𝒁</ci><ci id="A2.E9Xe.2.1.1.m1.4.4.3.7.cmml" xref="A2.E9Xe.2.1.1.m1.4.4.3.7">𝐴</ci><ci id="A2.E9Xe.2.1.1.m1.4.4.3.8.cmml" xref="A2.E9Xe.2.1.1.m1.4.4.3.8">𝑡</ci><ci id="A2.E9Xe.2.1.1.m1.4.4.3.9.cmml" xref="A2.E9Xe.2.1.1.m1.4.4.3.9">𝑡</ci><ci id="A2.E9Xe.2.1.1.m1.4.4.3.10.cmml" xref="A2.E9Xe.2.1.1.m1.4.4.3.10">𝑛</ci><vector id="A2.E9Xe.2.1.1.m1.4.4.3.3.4.cmml" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.3"><apply id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.cmml" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1"><times id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.1"></times><ci id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.2">𝒁</ci><apply id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3.cmml" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3.1.cmml" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3.2.cmml" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3.2">𝑾</ci><ci id="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3.3.cmml" xref="A2.E9Xe.2.1.1.m1.2.2.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2.cmml" xref="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2.1.cmml" xref="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2">subscript</csymbol><ci id="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2.2.cmml" xref="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2.2">𝑷</ci><ci id="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2.3.cmml" xref="A2.E9Xe.2.1.1.m1.3.3.2.2.2.2.3">𝑘</ci></apply><apply id="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3.cmml" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3.1.cmml" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3">subscript</csymbol><ci id="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3.2.cmml" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3.2">𝑷</ci><ci id="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3.3.cmml" xref="A2.E9Xe.2.1.1.m1.4.4.3.3.3.3.3">𝑣</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9Xe.2.1.1.m1.4c">\displaystyle+{\color[rgb]{0,0,1}\lambda({\bm{Z}})}Attn({\bm{Z}}{\bm{W}}_{q},{\bm{P}}_{k},{\bm{P}}_{v})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="A2.SS1.p3.3" class="ltx_p">where <math id="A2.SS1.p3.1.m1.1" class="ltx_Math" alttext="Attn" display="inline"><semantics id="A2.SS1.p3.1.m1.1a"><mrow id="A2.SS1.p3.1.m1.1.1" xref="A2.SS1.p3.1.m1.1.1.cmml"><mi id="A2.SS1.p3.1.m1.1.1.2" xref="A2.SS1.p3.1.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p3.1.m1.1.1.1" xref="A2.SS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="A2.SS1.p3.1.m1.1.1.3" xref="A2.SS1.p3.1.m1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p3.1.m1.1.1.1a" xref="A2.SS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="A2.SS1.p3.1.m1.1.1.4" xref="A2.SS1.p3.1.m1.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p3.1.m1.1.1.1b" xref="A2.SS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="A2.SS1.p3.1.m1.1.1.5" xref="A2.SS1.p3.1.m1.1.1.5.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.1.m1.1b"><apply id="A2.SS1.p3.1.m1.1.1.cmml" xref="A2.SS1.p3.1.m1.1.1"><times id="A2.SS1.p3.1.m1.1.1.1.cmml" xref="A2.SS1.p3.1.m1.1.1.1"></times><ci id="A2.SS1.p3.1.m1.1.1.2.cmml" xref="A2.SS1.p3.1.m1.1.1.2">𝐴</ci><ci id="A2.SS1.p3.1.m1.1.1.3.cmml" xref="A2.SS1.p3.1.m1.1.1.3">𝑡</ci><ci id="A2.SS1.p3.1.m1.1.1.4.cmml" xref="A2.SS1.p3.1.m1.1.1.4">𝑡</ci><ci id="A2.SS1.p3.1.m1.1.1.5.cmml" xref="A2.SS1.p3.1.m1.1.1.5">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.1.m1.1c">Attn</annotation></semantics></math> is the attention operation, <math id="A2.SS1.p3.2.m2.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="A2.SS1.p3.2.m2.1a"><mi id="A2.SS1.p3.2.m2.1.1" xref="A2.SS1.p3.2.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.2.m2.1b"><ci id="A2.SS1.p3.2.m2.1.1.cmml" xref="A2.SS1.p3.2.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.2.m2.1c">Z</annotation></semantics></math> is the hidden state from the last layer, and <math id="A2.SS1.p3.3.m3.1" class="ltx_Math" alttext="\lambda({\bm{Z}})" display="inline"><semantics id="A2.SS1.p3.3.m3.1a"><mrow id="A2.SS1.p3.3.m3.1.2" xref="A2.SS1.p3.3.m3.1.2.cmml"><mi id="A2.SS1.p3.3.m3.1.2.2" xref="A2.SS1.p3.3.m3.1.2.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p3.3.m3.1.2.1" xref="A2.SS1.p3.3.m3.1.2.1.cmml">​</mo><mrow id="A2.SS1.p3.3.m3.1.2.3.2" xref="A2.SS1.p3.3.m3.1.2.cmml"><mo stretchy="false" id="A2.SS1.p3.3.m3.1.2.3.2.1" xref="A2.SS1.p3.3.m3.1.2.cmml">(</mo><mi id="A2.SS1.p3.3.m3.1.1" xref="A2.SS1.p3.3.m3.1.1.cmml">𝒁</mi><mo stretchy="false" id="A2.SS1.p3.3.m3.1.2.3.2.2" xref="A2.SS1.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.3.m3.1b"><apply id="A2.SS1.p3.3.m3.1.2.cmml" xref="A2.SS1.p3.3.m3.1.2"><times id="A2.SS1.p3.3.m3.1.2.1.cmml" xref="A2.SS1.p3.3.m3.1.2.1"></times><ci id="A2.SS1.p3.3.m3.1.2.2.cmml" xref="A2.SS1.p3.3.m3.1.2.2">𝜆</ci><ci id="A2.SS1.p3.3.m3.1.1.cmml" xref="A2.SS1.p3.3.m3.1.1">𝒁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.3.m3.1c">\lambda({\bm{Z}})</annotation></semantics></math> is the mixture coefficient defined as</p>
<table id="A2.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A2.E10.m1.4" class="ltx_math_unparsed" alttext="\small\lambda({\bm{Z}})=\frac{\sum_{i}\exp({\bm{Z}}{\bm{W}}_{q}{\bm{P}}_{k}^{\top})_{i}}{\sum_{i}\exp({\bm{Z}}{\bm{W}}_{q}{\bm{P}}_{k}^{\top})_{i}+\sum_{j}\exp({\bm{Z}}{\bm{W}}_{q}{\bm{W}}_{k}^{\top}{\bm{Z}}^{\top})_{j}}." display="block"><semantics id="A2.E10.m1.4a"><mrow id="A2.E10.m1.4.4.1"><mrow id="A2.E10.m1.4.4.1.1"><mrow id="A2.E10.m1.4.4.1.1.2"><mi mathsize="90%" id="A2.E10.m1.4.4.1.1.2.2">λ</mi><mo lspace="0em" rspace="0em" id="A2.E10.m1.4.4.1.1.2.1">​</mo><mrow id="A2.E10.m1.4.4.1.1.2.3.2"><mo maxsize="90%" minsize="90%" id="A2.E10.m1.4.4.1.1.2.3.2.1">(</mo><mi mathsize="90%" id="A2.E10.m1.3.3">𝒁</mi><mo maxsize="90%" minsize="90%" id="A2.E10.m1.4.4.1.1.2.3.2.2">)</mo></mrow></mrow><mo mathsize="90%" id="A2.E10.m1.4.4.1.1.1">=</mo><mfrac id="A2.E10.m1.2.2"><mrow id="A2.E10.m1.1.1.1"><msub id="A2.E10.m1.1.1.1.2"><mo maxsize="90%" minsize="90%" stretchy="true" id="A2.E10.m1.1.1.1.2.2">∑</mo><mi mathsize="90%" id="A2.E10.m1.1.1.1.2.3">i</mi></msub><mi mathsize="90%" id="A2.E10.m1.1.1.1.1">exp</mi><msub id="A2.E10.m1.1.1.1.3"><mrow id="A2.E10.m1.1.1.1.3.2"><mo maxsize="90%" minsize="90%" id="A2.E10.m1.1.1.1.3.2.1">(</mo><mi mathsize="90%" id="A2.E10.m1.1.1.1.3.2.2">𝒁</mi><msub id="A2.E10.m1.1.1.1.3.2.3"><mi mathsize="90%" id="A2.E10.m1.1.1.1.3.2.3.2">𝑾</mi><mi mathsize="90%" id="A2.E10.m1.1.1.1.3.2.3.3">q</mi></msub><msubsup id="A2.E10.m1.1.1.1.3.2.4"><mi mathsize="90%" id="A2.E10.m1.1.1.1.3.2.4.2.2">𝑷</mi><mi mathsize="90%" id="A2.E10.m1.1.1.1.3.2.4.2.3">k</mi><mo mathsize="90%" id="A2.E10.m1.1.1.1.3.2.4.3">⊤</mo></msubsup><mo maxsize="90%" minsize="90%" id="A2.E10.m1.1.1.1.3.2.5">)</mo></mrow><mi mathsize="90%" id="A2.E10.m1.1.1.1.3.3">i</mi></msub></mrow><mrow id="A2.E10.m1.2.2.2"><msub id="A2.E10.m1.2.2.2.2"><mo maxsize="90%" minsize="90%" stretchy="true" id="A2.E10.m1.2.2.2.2.2">∑</mo><mi mathsize="90%" id="A2.E10.m1.2.2.2.2.3">i</mi></msub><mi mathsize="90%" id="A2.E10.m1.2.2.2.1">exp</mi><msub id="A2.E10.m1.2.2.2.3"><mrow id="A2.E10.m1.2.2.2.3.2"><mo maxsize="90%" minsize="90%" id="A2.E10.m1.2.2.2.3.2.1">(</mo><mi mathsize="90%" id="A2.E10.m1.2.2.2.3.2.2">𝒁</mi><msub id="A2.E10.m1.2.2.2.3.2.3"><mi mathsize="90%" id="A2.E10.m1.2.2.2.3.2.3.2">𝑾</mi><mi mathsize="90%" id="A2.E10.m1.2.2.2.3.2.3.3">q</mi></msub><msubsup id="A2.E10.m1.2.2.2.3.2.4"><mi mathsize="90%" id="A2.E10.m1.2.2.2.3.2.4.2.2">𝑷</mi><mi mathsize="90%" id="A2.E10.m1.2.2.2.3.2.4.2.3">k</mi><mo mathsize="90%" id="A2.E10.m1.2.2.2.3.2.4.3">⊤</mo></msubsup><mo maxsize="90%" minsize="90%" id="A2.E10.m1.2.2.2.3.2.5">)</mo></mrow><mi mathsize="90%" id="A2.E10.m1.2.2.2.3.3">i</mi></msub><mo mathsize="90%" rspace="0.055em" id="A2.E10.m1.2.2.2.4">+</mo><msub id="A2.E10.m1.2.2.2.5"><mo maxsize="90%" minsize="90%" stretchy="true" id="A2.E10.m1.2.2.2.5.2">∑</mo><mi mathsize="90%" id="A2.E10.m1.2.2.2.5.3">j</mi></msub><mi mathsize="90%" id="A2.E10.m1.2.2.2.6">exp</mi><msub id="A2.E10.m1.2.2.2.7"><mrow id="A2.E10.m1.2.2.2.7.2"><mo maxsize="90%" minsize="90%" id="A2.E10.m1.2.2.2.7.2.1">(</mo><mi mathsize="90%" id="A2.E10.m1.2.2.2.7.2.2">𝒁</mi><msub id="A2.E10.m1.2.2.2.7.2.3"><mi mathsize="90%" id="A2.E10.m1.2.2.2.7.2.3.2">𝑾</mi><mi mathsize="90%" id="A2.E10.m1.2.2.2.7.2.3.3">q</mi></msub><msubsup id="A2.E10.m1.2.2.2.7.2.4"><mi mathsize="90%" id="A2.E10.m1.2.2.2.7.2.4.2.2">𝑾</mi><mi mathsize="90%" id="A2.E10.m1.2.2.2.7.2.4.2.3">k</mi><mo mathsize="90%" id="A2.E10.m1.2.2.2.7.2.4.3">⊤</mo></msubsup><msup id="A2.E10.m1.2.2.2.7.2.5"><mi mathsize="90%" id="A2.E10.m1.2.2.2.7.2.5.2">𝒁</mi><mo mathsize="90%" id="A2.E10.m1.2.2.2.7.2.5.3">⊤</mo></msup><mo maxsize="90%" minsize="90%" id="A2.E10.m1.2.2.2.7.2.6">)</mo></mrow><mi mathsize="90%" id="A2.E10.m1.2.2.2.7.3">j</mi></msub></mrow></mfrac></mrow><mo lspace="0em" mathsize="90%" id="A2.E10.m1.4.4.1.2">.</mo></mrow><annotation encoding="application/x-tex" id="A2.E10.m1.4b">\small\lambda({\bm{Z}})=\frac{\sum_{i}\exp({\bm{Z}}{\bm{W}}_{q}{\bm{P}}_{k}^{\top})_{i}}{\sum_{i}\exp({\bm{Z}}{\bm{W}}_{q}{\bm{P}}_{k}^{\top})_{i}+\sum_{j}\exp({\bm{Z}}{\bm{W}}_{q}{\bm{W}}_{k}^{\top}{\bm{Z}}^{\top})_{j}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div id="A2.SS1.p4" class="ltx_para">
<p id="A2.SS1.p4.1" class="ltx_p">If only taking the self-attention layer into consideration, Equation <a href="#A2.E8" title="In B.1 Why APFL and FedPerfix lead the performance? ‣ Appendix B Connection between APFL and FedPerfix ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> and Equation <a href="#A2.E9" title="In B.1 Why APFL and FedPerfix lead the performance? ‣ Appendix B Connection between APFL and FedPerfix ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> share a similar formulation, which can be interpreted as an information transfer between the global and local models. Therefore, both approaches have a leading performance, indicating that <span id="A2.SS1.p4.1.1" class="ltx_text ltx_font_italic">the underlying idea to balance local and global information is effective and crucial in personalized federated learning</span>.</p>
</div>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Advantages of FedPerfix </h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.1" class="ltx_p">Although APFL and FedPerfix share a connected underlying idea, FedPerfix can outperform APFL in a consistent margin across different settings. Besides,
FedPerfix is much more efficient than APFL from several perspectives:</p>
<ul id="A2.I1" class="ltx_itemize">
<li id="A2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i1.p1" class="ltx_para">
<p id="A2.I1.i1.p1.1" class="ltx_p">Parameter size of the Prefixes in FedPerfix (<span id="A2.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">289.0K</span>) is fewer than a separate self-attention layer (<span id="A2.I1.i1.p1.1.2" class="ltx_text ltx_font_bold">577.5K</span>) in APFL, leading to fewer computational costs for the self-attention layer.</p>
</div>
</li>
<li id="A2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i2.p1" class="ltx_para">
<p id="A2.I1.i2.p1.1" class="ltx_p">APFL needs to perform the mixture between the global and local models with additional computational costs for every layer, while FedPerfix only needs to perform it for the self-attention layers.</p>
</div>
</li>
<li id="A2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i3.p1" class="ltx_para">
<p id="A2.I1.i3.p1.1" class="ltx_p">APFL needs to store a separate personalized model (<span id="A2.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">21.03M</span>) on each client, while FedPerfix only needs (<span id="A2.I1.i3.p1.1.2" class="ltx_text ltx_font_bold">3.39M</span>) additional space.</p>
</div>
</li>
</ul>
</div>
<div id="A2.SS2.p2" class="ltx_para">
<p id="A2.SS2.p2.2" class="ltx_p">In conclusion, APFL needs <math id="A2.SS2.p2.1.m1.1" class="ltx_math_unparsed" alttext="\mathbf{70\times}" display="inline"><semantics id="A2.SS2.p2.1.m1.1a"><mrow id="A2.SS2.p2.1.m1.1b"><mn id="A2.SS2.p2.1.m1.1.1">𝟕𝟎</mn><mo lspace="0.222em" id="A2.SS2.p2.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="A2.SS2.p2.1.m1.1c">\mathbf{70\times}</annotation></semantics></math> additional FLOPs and <math id="A2.SS2.p2.2.m2.1" class="ltx_math_unparsed" alttext="\mathbf{6.2\times}" display="inline"><semantics id="A2.SS2.p2.2.m2.1a"><mrow id="A2.SS2.p2.2.m2.1b"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A2.SS2.p2.2.m2.1.1">6.2</mn><mo lspace="0.222em" id="A2.SS2.p2.2.m2.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="A2.SS2.p2.2.m2.1c">\mathbf{6.2\times}</annotation></semantics></math> additional parameters to store than FedPerfix, using FedAVG as a baseline.
Therefore, when compared with APFL, FedPerfix not only achieves superior performance but also enjoys a more efficient implementation by specifying and focusing only on the sensitive parts of the ViT. This targeted approach leads to a more effective and efficient approach for personalized federated learning.</p>
</div>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>More Ablation Study</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">To reduce the exhausting hyperparameter-searching in practice, we report the result under a unified default setting for all tasks in the main paper. <span id="A3.p1.1.1" class="ltx_text ltx_font_italic">The performance under such a unified default setting still achieves state-of-the-art performance</span>, demonstrating the robustness of our proposed method.
However, we still want to demonstrate the potential to further improve the performance by tuning the hyperparameters. In this section, we will show the results and analyze the impact of three key hyperparameters in FedPerfix: hidden dimension, scale, and the depths of prefixes.</p>
</div>
<section id="A3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Impact of Hidden Dimension and Scale</h3>

<div id="A3.SS1.p1" class="ltx_para">
<p id="A3.SS1.p1.5" class="ltx_p">The hidden dimension is the dimension of the hidden state of the adapter to generate the Prefixes, <em id="A3.SS1.p1.5.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="A3.SS1.p1.5.2" class="ltx_text"></span>, the common dimension shared by <math id="A3.SS1.p1.1.m1.1" class="ltx_Math" alttext="{\bm{W}}_{down}" display="inline"><semantics id="A3.SS1.p1.1.m1.1a"><msub id="A3.SS1.p1.1.m1.1.1" xref="A3.SS1.p1.1.m1.1.1.cmml"><mi id="A3.SS1.p1.1.m1.1.1.2" xref="A3.SS1.p1.1.m1.1.1.2.cmml">𝑾</mi><mrow id="A3.SS1.p1.1.m1.1.1.3" xref="A3.SS1.p1.1.m1.1.1.3.cmml"><mi id="A3.SS1.p1.1.m1.1.1.3.2" xref="A3.SS1.p1.1.m1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p1.1.m1.1.1.3.1" xref="A3.SS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="A3.SS1.p1.1.m1.1.1.3.3" xref="A3.SS1.p1.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p1.1.m1.1.1.3.1a" xref="A3.SS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="A3.SS1.p1.1.m1.1.1.3.4" xref="A3.SS1.p1.1.m1.1.1.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p1.1.m1.1.1.3.1b" xref="A3.SS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="A3.SS1.p1.1.m1.1.1.3.5" xref="A3.SS1.p1.1.m1.1.1.3.5.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.1.m1.1b"><apply id="A3.SS1.p1.1.m1.1.1.cmml" xref="A3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p1.1.m1.1.1.1.cmml" xref="A3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="A3.SS1.p1.1.m1.1.1.2.cmml" xref="A3.SS1.p1.1.m1.1.1.2">𝑾</ci><apply id="A3.SS1.p1.1.m1.1.1.3.cmml" xref="A3.SS1.p1.1.m1.1.1.3"><times id="A3.SS1.p1.1.m1.1.1.3.1.cmml" xref="A3.SS1.p1.1.m1.1.1.3.1"></times><ci id="A3.SS1.p1.1.m1.1.1.3.2.cmml" xref="A3.SS1.p1.1.m1.1.1.3.2">𝑑</ci><ci id="A3.SS1.p1.1.m1.1.1.3.3.cmml" xref="A3.SS1.p1.1.m1.1.1.3.3">𝑜</ci><ci id="A3.SS1.p1.1.m1.1.1.3.4.cmml" xref="A3.SS1.p1.1.m1.1.1.3.4">𝑤</ci><ci id="A3.SS1.p1.1.m1.1.1.3.5.cmml" xref="A3.SS1.p1.1.m1.1.1.3.5">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.1.m1.1c">{\bm{W}}_{down}</annotation></semantics></math> and <math id="A3.SS1.p1.2.m2.1" class="ltx_Math" alttext="{\bm{W}}_{up}" display="inline"><semantics id="A3.SS1.p1.2.m2.1a"><msub id="A3.SS1.p1.2.m2.1.1" xref="A3.SS1.p1.2.m2.1.1.cmml"><mi id="A3.SS1.p1.2.m2.1.1.2" xref="A3.SS1.p1.2.m2.1.1.2.cmml">𝑾</mi><mrow id="A3.SS1.p1.2.m2.1.1.3" xref="A3.SS1.p1.2.m2.1.1.3.cmml"><mi id="A3.SS1.p1.2.m2.1.1.3.2" xref="A3.SS1.p1.2.m2.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p1.2.m2.1.1.3.1" xref="A3.SS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="A3.SS1.p1.2.m2.1.1.3.3" xref="A3.SS1.p1.2.m2.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.2.m2.1b"><apply id="A3.SS1.p1.2.m2.1.1.cmml" xref="A3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.SS1.p1.2.m2.1.1.1.cmml" xref="A3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="A3.SS1.p1.2.m2.1.1.2.cmml" xref="A3.SS1.p1.2.m2.1.1.2">𝑾</ci><apply id="A3.SS1.p1.2.m2.1.1.3.cmml" xref="A3.SS1.p1.2.m2.1.1.3"><times id="A3.SS1.p1.2.m2.1.1.3.1.cmml" xref="A3.SS1.p1.2.m2.1.1.3.1"></times><ci id="A3.SS1.p1.2.m2.1.1.3.2.cmml" xref="A3.SS1.p1.2.m2.1.1.3.2">𝑢</ci><ci id="A3.SS1.p1.2.m2.1.1.3.3.cmml" xref="A3.SS1.p1.2.m2.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.2.m2.1c">{\bm{W}}_{up}</annotation></semantics></math>, and the scale <math id="A3.SS1.p1.3.m3.1" class="ltx_Math" alttext="s" display="inline"><semantics id="A3.SS1.p1.3.m3.1a"><mi id="A3.SS1.p1.3.m3.1.1" xref="A3.SS1.p1.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.3.m3.1b"><ci id="A3.SS1.p1.3.m3.1.1.cmml" xref="A3.SS1.p1.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.3.m3.1c">s</annotation></semantics></math> is scalar to control the impact of the Prefixes. In our default setting, the hidden dimension is set as <math id="A3.SS1.p1.4.m4.1" class="ltx_Math" alttext="256" display="inline"><semantics id="A3.SS1.p1.4.m4.1a"><mn id="A3.SS1.p1.4.m4.1.1" xref="A3.SS1.p1.4.m4.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.4.m4.1b"><cn type="integer" id="A3.SS1.p1.4.m4.1.1.cmml" xref="A3.SS1.p1.4.m4.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.4.m4.1c">256</annotation></semantics></math>, and the scale is set as <math id="A3.SS1.p1.5.m5.1" class="ltx_Math" alttext="1.5" display="inline"><semantics id="A3.SS1.p1.5.m5.1a"><mn id="A3.SS1.p1.5.m5.1.1" xref="A3.SS1.p1.5.m5.1.1.cmml">1.5</mn><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.5.m5.1b"><cn type="float" id="A3.SS1.p1.5.m5.1.1.cmml" xref="A3.SS1.p1.5.m5.1.1">1.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.5.m5.1c">1.5</annotation></semantics></math>. FedPerfix, under the default setting, can outperform all the compared methods in all datasets. Here, we demonstrate the potential to achieve better performance on CIFAR-100 by tuning the hyperparameters.
As shown in Figure <a href="#S7.F5" title="Figure 5 ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (a) and (b), increasing the hidden dimension and scale will not always lead to an increase in performance. Therefore, in practice, further tuning the hidden dimension and the scale can lead to a better result, even though without such tuning can still maintain a high performance.</p>
</div>
</section>
<section id="A3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Impact of the Depths of Prefixes</h3>

<div id="A3.SS2.p1" class="ltx_para">
<p id="A3.SS2.p1.1" class="ltx_p">In our default setting, we add the Prefixes to every self-attention layer. To investigate the impact of the depths of Prefixes, we further conduct experiments only to add Prefixes to the last several self-attention layers, <em id="A3.SS2.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="A3.SS2.p1.1.2" class="ltx_text"></span>, <math id="A3.SS2.p1.1.m1.1" class="ltx_Math" alttext="depth=1" display="inline"><semantics id="A3.SS2.p1.1.m1.1a"><mrow id="A3.SS2.p1.1.m1.1.1" xref="A3.SS2.p1.1.m1.1.1.cmml"><mrow id="A3.SS2.p1.1.m1.1.1.2" xref="A3.SS2.p1.1.m1.1.1.2.cmml"><mi id="A3.SS2.p1.1.m1.1.1.2.2" xref="A3.SS2.p1.1.m1.1.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A3.SS2.p1.1.m1.1.1.2.1" xref="A3.SS2.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="A3.SS2.p1.1.m1.1.1.2.3" xref="A3.SS2.p1.1.m1.1.1.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.SS2.p1.1.m1.1.1.2.1a" xref="A3.SS2.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="A3.SS2.p1.1.m1.1.1.2.4" xref="A3.SS2.p1.1.m1.1.1.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="A3.SS2.p1.1.m1.1.1.2.1b" xref="A3.SS2.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="A3.SS2.p1.1.m1.1.1.2.5" xref="A3.SS2.p1.1.m1.1.1.2.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.SS2.p1.1.m1.1.1.2.1c" xref="A3.SS2.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="A3.SS2.p1.1.m1.1.1.2.6" xref="A3.SS2.p1.1.m1.1.1.2.6.cmml">h</mi></mrow><mo id="A3.SS2.p1.1.m1.1.1.1" xref="A3.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="A3.SS2.p1.1.m1.1.1.3" xref="A3.SS2.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.1.m1.1b"><apply id="A3.SS2.p1.1.m1.1.1.cmml" xref="A3.SS2.p1.1.m1.1.1"><eq id="A3.SS2.p1.1.m1.1.1.1.cmml" xref="A3.SS2.p1.1.m1.1.1.1"></eq><apply id="A3.SS2.p1.1.m1.1.1.2.cmml" xref="A3.SS2.p1.1.m1.1.1.2"><times id="A3.SS2.p1.1.m1.1.1.2.1.cmml" xref="A3.SS2.p1.1.m1.1.1.2.1"></times><ci id="A3.SS2.p1.1.m1.1.1.2.2.cmml" xref="A3.SS2.p1.1.m1.1.1.2.2">𝑑</ci><ci id="A3.SS2.p1.1.m1.1.1.2.3.cmml" xref="A3.SS2.p1.1.m1.1.1.2.3">𝑒</ci><ci id="A3.SS2.p1.1.m1.1.1.2.4.cmml" xref="A3.SS2.p1.1.m1.1.1.2.4">𝑝</ci><ci id="A3.SS2.p1.1.m1.1.1.2.5.cmml" xref="A3.SS2.p1.1.m1.1.1.2.5">𝑡</ci><ci id="A3.SS2.p1.1.m1.1.1.2.6.cmml" xref="A3.SS2.p1.1.m1.1.1.2.6">ℎ</ci></apply><cn type="integer" id="A3.SS2.p1.1.m1.1.1.3.cmml" xref="A3.SS2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.1.m1.1c">depth=1</annotation></semantics></math> means only adding Prefixes to the last self-attention layer. The result is shown in Figure <a href="#S7.F5" title="Figure 5 ‣ FedPerfix: Towards Partial Model Personalization of Vision Transformers in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (c). In general, with the increase in the depths of the Prefixes, the overall performance increases. However, such an increase is not strict, indicating the potential to further improve the performance and reduce storage and computational costs.</p>
</div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2308.09159" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2308.09160" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2308.09160">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2308.09160" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2308.09161" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 12:05:51 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
