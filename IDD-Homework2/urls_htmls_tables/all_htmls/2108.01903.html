<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2108.01903] Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application</title><meta property="og:description" content="While machine learning techniques are being applied to various fields for their exceptional ability to find complex relations in large datasets, the strengthening of regulations on data ownership and privacy is causing…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2108.01903">

<!--Generated on Sat Mar  2 04:18:54 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Federated Learning,  Non-IID,  clustering,  personalized model,  healthcare data,  Major Depressive Disorder
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Joo Hun Yoo<sup id="id1.1.id1" class="ltx_sup">1</sup>, Ha Min Son<sup id="id2.2.id2" class="ltx_sup">1</sup>, Hyejun Jeong<sup id="id3.3.id3" class="ltx_sup">1</sup>,
Eun-Hye Jang<sup id="id4.4.id4" class="ltx_sup">2</sup>, Ah Young Kim<sup id="id5.5.id5" class="ltx_sup">2</sup>, Han Young Yu<sup id="id6.6.id6" class="ltx_sup">2</sup>, 
<br class="ltx_break">Hong Jin Jeon<sup id="id7.7.id7" class="ltx_sup">3,*</sup>,
Tai-Myoung Chung<sup id="id8.8.id8" class="ltx_sup">1,*</sup>
<br class="ltx_break"><sup id="id9.9.id9" class="ltx_sup"><span id="id9.9.id9.1" class="ltx_text" style="font-size:90%;">1</span></sup><span id="id10.10.id10" class="ltx_text" style="font-size:90%;"> College of Computing and Informatics, Sungkyunkwan University
<br class="ltx_break"><sup id="id10.10.id10.1" class="ltx_sup">2</sup> Bio-Medical IT Convergence Research Division, Electronics and Telecommunications Research Institute
<br class="ltx_break"><sup id="id10.10.id10.2" class="ltx_sup">3</sup> Department of Psychiatry, Samsung Medical Center
<br class="ltx_break"><span id="id10.10.id10.3" class="ltx_text ltx_font_typewriter" style="font-size:89%;">{andrewyoo, sonhamin, june.jeong}@g.skku.edu</span>
<span id="id10.10.id10.4" class="ltx_text ltx_font_typewriter" style="font-size:89%;">{cleta4u, aykim, uhan0}@etri.re.kr
<br class="ltx_break">{jeonhj, tmchung}@skku.edu</span>
</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id11.id1" class="ltx_p">While machine learning techniques are being applied to various fields for their exceptional ability to find complex relations in large datasets, the strengthening of regulations on data ownership and privacy is causing increasing difficulty in its application to medical data. In light of this, Federated Learning has recently been proposed as a solution to train on private data without breach of confidentiality. This conservation of privacy is particularly appealing in the field of healthcare, where patient data is highly confidential.
However, many studies have shown that its assumption of Independent and Identically Distributed data is unrealistic for medical data. In this paper, we propose Personalized Federated Cluster Models, a hierarchical clustering-based FL process, to predict Major Depressive Disorder severity from Heart Rate Variability. By allowing clients to receive more personalized model, we address problems caused by non-IID data, showing an accuracy increase in severity prediction. This increase in performance may be sufficient to use Personalized Federated Cluster Models in many existing Federated Learning scenarios.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Federated Learning, Non-IID, clustering, personalized model, healthcare data, Major Depressive Disorder

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Machine Learning (ML) techniques are being applied to various research fields for their ability to learn from large amounts of data and extract meaning information <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. This is advantageous, as the various statistical analysis methods used in the past, such as logistic regression analysis, have the limitation of inconsistent performance considering extensive number of variables. Deep learning (DL) techniques in particular are being used to find complex relations between both dependent and independent variables in large sets of data—a highly time consuming task for human experts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. However, the full transition to DL in the field of healthcare has some practical difficulties.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">While deep learning techniques are assumed to have a large, accessible, and centralized dataset, it is becoming difficult to apply DL to healthcare data due to restrictions of privacy laws. Many organizations have reported changes to their data privacy regulations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, such as the tightening rules of EU’s General Data Protection Regulation (GDPR), California Consumer Privacy Act (CCPA), and China’s Cyber Security Law (CSL). In light of this, Federated Learning (FL) has been introduced to solve the limitation of centralized DL approaches. FL can comply with strict privacy regulations, as it does not rely on data collection. Owning to these advantages, FL has potential in its application to the healthcare field. However, FL is also known to have limitations due to its assumption of Independent and Identically Distributed (IID) data. In this research, we present a method to alleviate this assumption with an applications of FL in the medical field, particularly in the prediction of Major Depressive Disorder (MDD) severity.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">MDD is a mental disorder characterized by at least two weeks of pervasive low mood, loss of interest, and low energy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. Current evaluation of depression symptoms relies on scoring methods such as Hamilton Depression (HAM-D), Montgomery–Åsberg Depression Rating Scale (MADRS), and Beck’s Depression Inventory (BDI), with more specific diagnosis through consultation with psychiatrists. Nevertheless, these diagnostic methods are significantly dependent on the mood of the subject and requires a considerable amount of time to conduct. As a solution, researchers have analyzed diagnosis of MDD using biomarkers such as neuroimage, Electroencephalogram (EEG), and Heart Rate Variability (HRV). We focus on HRV for its advantage of having a lower data collection cost, and the simplicity of its measurement method.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we use FL with hierarchical clustering to create Personalized Federated Cluster Models (PFCM). Previous researches regarding mental healthcare analysis were conducted without consideration to data privacy; this creates difficulties applying DL methods to practical scenarios. Other studies that have addressed the concerns for data privacy overlooked the presentation of results in a realistic non-IID environment. In this research, we use FL as a method to leverage the strengths of DL while preserving data privacy. Clustering is used as a method to supplement the limitations of FL in non-IID environment—as is the case with healthcare dataset. Our main contributions are summarized as follows:</p>
</div>
<div id="S1.p5" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a privacy-preserving framework that leverages the strengths of deep learning technique in MDD diagnosis.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We improve HRV-based analytical performance of MDD severity by creating Personalized Federated Cluster Models.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Background &amp; Related works</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">Federated Learning and Clustering Methods</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Federated Learning (FL)  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> is a distributed ML framework that allows training on data distributed across multiple clients without breach of confidentiality. One of the fundamental aspects of FL is privacy preservation, as there is no need for data collection.
FL typically progresses with the repetitions of the following steps. A centralized server creates an initial global model and distributes it to each client. Each client trains its copy of the model with local data. Then, each client sends the local updates of the model to the server. The server aggregates the clients’ updates, modifies the global model, and distributes the updated global model back to the clients. These steps are repeated until the model converges, or a stopping criterion is met <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. By doing so, training is achieved exclusively through local model updates, without access to raw data, resulting in attack surface reduction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2108.01903/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="631" height="378" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Distributional differences between HRV dataset variables. Values have non-identical distribution even though they have undergone a scale standardization process. This specifically represents one of the concept shift, same label but different feature, where conditional distributions may vary.</figcaption>
</figure>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">While conventional FL algorithms, such as FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, show promising results, it relies heavily on an environment in which the data spread across clients are Independent and Identically Distributed (IID). Real-world healthcare data, however, are by nature, non-IID, heterogeneously distributed across the clients—an environment in which each random variable does not agree with the same probability distribution, and not all variables are mutually independent <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Figure <a href="#S2.F1" title="Figure 1 ‣ II-A Federated Learning and Clustering Methods ‣ II Background &amp; Related works ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the distribution of variables measured in baseline phase among the variables in HRV data used in this study. Not only for the differences in personal characteristics, but features extracted from the same HRV variables also have a non-identical distribution. In short, conventional FL algorithms cannot provide an optimal solution, as it is built on the assumption of IID data.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">Many researchers have attempted to address this non-IID issue by blending different approaches in Computer Science to FL. References <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> combined different clustering algorithms at many different steps in training. By grouping clients with similarities, different models for each cluster of clients are created, resulting in a reduced non-IIDness of data within a single cluster. Reference  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> resembles our work in terms of technical methods, as they leverage the hierarchical clustering algorithm to alleviate the ambiguity of pre-defining a number of clusters. However, the listed studies do not fully leverage the strength of clustering. During the testing phase, clients in the test set are allocated to all cluster models rather than distributed to their closest respective cluster.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">HRV data for Major Depressive Disorder Diagnosis</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Heart Rate Variability (HRV) has been gaining attention in the field of depression analysis for its prominent correlation with depressive symptoms. Most previous researches chose the Support Vector Machine with feature selection (SVM-RFE) algorithm as the key ML algorithm. Table <a href="#S2.T1" title="TABLE I ‣ II-B HRV data for Major Depressive Disorder Diagnosis ‣ II Background &amp; Related works ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> summarizes some significant related works. Reference <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> applied the SVM-RFE algorithm to HRV, serum proteomics, and other multi-modal data. Reference <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> proposed an MDD diagnosis system using SVM-RFE only on HRV.
Reference <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> proposed a single-lead ECG system based on HRV reactivity, ECG signal, and mental tasks analysis, to classify MDD subjects from non-MDD subjects.
Most of these studies report promising results.
Their approaches, however, are limited as classifying MDD into only two classes do not fully reflect its non-binary nature. As such, patients with mild or borderline depression scores may be inaccurately placed into different classes.
In addition, they do not address the problem of privacy regulations. Like most ML algorithms, SVMs rely on the premise of a centralized and accessible set of data. In practical healthcare environments, however, access to data is limited as it Personal Health Information.</p>
</div>
<figure id="S2.T1" class="ltx_table ltx_align_center">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Comparison with other researches</figcaption>
<table id="S2.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S2.T1.1.1.1" class="ltx_tr">
<th id="S2.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Researches</th>
<th id="S2.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Data</th>
<th id="S2.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Classes</th>
<th id="S2.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Data-privacy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S2.T1.1.2.1" class="ltx_tr">
<th id="S2.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite></th>
<th id="S2.T1.1.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">HRV, serum proteomics</th>
<td id="S2.T1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">2</td>
<td id="S2.T1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">x</td>
</tr>
<tr id="S2.T1.1.3.2" class="ltx_tr">
<th id="S2.T1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite></th>
<th id="S2.T1.1.3.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">HRV</th>
<td id="S2.T1.1.3.2.3" class="ltx_td ltx_align_center">2</td>
<td id="S2.T1.1.3.2.4" class="ltx_td ltx_align_center">x</td>
</tr>
<tr id="S2.T1.1.4.3" class="ltx_tr">
<th id="S2.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite></th>
<th id="S2.T1.1.4.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">ECG, HRV, tasks anlaysis</th>
<td id="S2.T1.1.4.3.3" class="ltx_td ltx_align_center">2</td>
<td id="S2.T1.1.4.3.4" class="ltx_td ltx_align_center">x</td>
</tr>
<tr id="S2.T1.1.5.4" class="ltx_tr">
<th id="S2.T1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b"><span id="S2.T1.1.5.4.1.1" class="ltx_text ltx_font_bold">PFCM</span></th>
<th id="S2.T1.1.5.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b"><span id="S2.T1.1.5.4.2.1" class="ltx_text ltx_font_bold">HRV</span></th>
<td id="S2.T1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S2.T1.1.5.4.3.1" class="ltx_text ltx_font_bold">3</span></td>
<td id="S2.T1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S2.T1.1.5.4.4.1" class="ltx_text ltx_font_bold">✓</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">Federated Learning in Mental Disorder Diagnosis</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Owing to the advantages of FL in privacy protection, there have been studies that have applied FL to monitor and classify mental disorders.
For example, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> used facial expression and speech signals to predict emotion and monitor mental health, and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> predicted the severity of the depressive disorder based on users’ mobile phone typing dynamics. Reference<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> used both data from users’ mobile phone typing and the Hamilton Depression Rating Scale (HDRS) score.
However, these studies did not use HRV data. To the best of our knowledge, no previous studies has used both HRV and FL for MDD analysis.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Personalized Federated Cluster Model</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Dataset</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The HRV data used in this study were designed and collected for research at the Department of Psychiatry at Samsung Medical Center. A total of 100 subjects, including a control group, were followed for twelve weeks. Their HRV parameters were measured in three phases: baseline, stress, and recovery. Each subject visited the medical center at least one time and at most five times in the twelve-week time span to provide baseline demographic and clinical data. In addition, non personally identifiable information parameters such as the age and gender of each subject were included in the demographic data. Other scores such as HAM-D, Panic Disorder Severity Scale (PDSS), Anxiety Sensitivity Index (ASI), and Scale for Suicide Ideation (SSI) were also included in the clinical data.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">However, mental health scores were excluded from analysis as these metrics directly represent the status of the subject. Our objective is to find potential complex relations between the easily collectable HRV data and depression severity. Thus, our proposed method used only HRV data features and simple biomarker data values as input variables. For severity prediction, we assume HAM-D, in which the scale ranges from 0 to 50, as the target indicator for MDD severity. We categorized the HAM-D values into three classes according to scientific evidence, with 0 to 7 being <span id="S3.SS1.p2.1.1" class="ltx_text ltx_font_italic">Normal</span>, 8 to 16 being <span id="S3.SS1.p2.1.2" class="ltx_text ltx_font_italic">Mild depression</span>, and 17 to 50 being <span id="S3.SS1.p2.1.3" class="ltx_text ltx_font_italic">Moderate-Severe depression</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">Our HRV data involves multi-dimensional features extracted from the time and frequency domains. The standard deviation of average normal to normal intervals (sDNN), number of pairs of adjacent NN intervals differing by more than 50ms in the entire recording (NN50), NN50 count divided by the total number of all NN interval (PNN50), Root Mean Square Differences of successive RR intervals (RMSSD), Very Low Frequency (VLF), Low Frequency (LF), High Frequency (HF), Low/High Frequency ratio (LF/HF), Frequency Power, heart rate, respiration, and temperature variables are collected in our multi-dimensionally extracted HRV features.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2108.01903/assets/architecture.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="435" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>An Overview of the Training Procedure of PFCM.
Top: In data preprocessing step, there are three shapes of data as numbered in this figure. 1) a raw data with null column inserted, 2) a data for each sample, 3) a preprocessed <math id="S3.F2.4.m1.1" class="ltx_Math" alttext="n\times n" display="inline"><semantics id="S3.F2.4.m1.1b"><mrow id="S3.F2.4.m1.1.1" xref="S3.F2.4.m1.1.1.cmml"><mi id="S3.F2.4.m1.1.1.2" xref="S3.F2.4.m1.1.1.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S3.F2.4.m1.1.1.1" xref="S3.F2.4.m1.1.1.1.cmml">×</mo><mi id="S3.F2.4.m1.1.1.3" xref="S3.F2.4.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.4.m1.1c"><apply id="S3.F2.4.m1.1.1.cmml" xref="S3.F2.4.m1.1.1"><times id="S3.F2.4.m1.1.1.1.cmml" xref="S3.F2.4.m1.1.1.1"></times><ci id="S3.F2.4.m1.1.1.2.cmml" xref="S3.F2.4.m1.1.1.2">𝑛</ci><ci id="S3.F2.4.m1.1.1.3.cmml" xref="S3.F2.4.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.m1.1d">n\times n</annotation></semantics></math> matrix data for each data sample.
Bottom Left: Step 1 utilizes the conventional FedAvg method for <math id="S3.F2.5.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.F2.5.m2.1b"><mi id="S3.F2.5.m2.1.1" xref="S3.F2.5.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.F2.5.m2.1c"><ci id="S3.F2.5.m2.1.1.cmml" xref="S3.F2.5.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.m2.1d">n</annotation></semantics></math> epochs to generate updated global model. Bottom Right: Step 2 introduces a Personalized Federated Cluster Models (PFCM) created based on the <math id="S3.F2.6.m3.1" class="ltx_Math" alttext="\Delta w" display="inline"><semantics id="S3.F2.6.m3.1b"><mrow id="S3.F2.6.m3.1.1" xref="S3.F2.6.m3.1.1.cmml"><mi mathvariant="normal" id="S3.F2.6.m3.1.1.2" xref="S3.F2.6.m3.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.F2.6.m3.1.1.1" xref="S3.F2.6.m3.1.1.1.cmml">​</mo><mi id="S3.F2.6.m3.1.1.3" xref="S3.F2.6.m3.1.1.3.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.6.m3.1c"><apply id="S3.F2.6.m3.1.1.cmml" xref="S3.F2.6.m3.1.1"><times id="S3.F2.6.m3.1.1.1.cmml" xref="S3.F2.6.m3.1.1.1"></times><ci id="S3.F2.6.m3.1.1.2.cmml" xref="S3.F2.6.m3.1.1.2">Δ</ci><ci id="S3.F2.6.m3.1.1.3.cmml" xref="S3.F2.6.m3.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.m3.1d">\Delta w</annotation></semantics></math> value calculated by comparing each clients with the updated global model.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Preprocessing</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">Our HRV dataset has a total of 479 rows and 80 columns, with each row representing a single subject’s visit and the columns representing the demographic data and extracted HRV features from three phases (baseline, stress, and recovery). As we use a Convolutional Neural Network (CNN)-based FL framework, we preprocess our data into a <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="n\times n" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">×</mo><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><times id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></times><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑛</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">n\times n</annotation></semantics></math> matrix to best exploit the strengths of CNNs to find high-level features. We added an extra dummy column with zero values to create a total of 81 columns. With the 81 columns, we create a <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="9\times 9" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mn id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">9</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><times id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></times><cn type="integer" id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">9</cn><cn type="integer" id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">9\times 9</annotation></semantics></math> matrix based on a single row represented in our HRV dataset as presented at the top of Figure <a href="#S3.F2" title="Figure 2 ‣ III-A Dataset ‣ III Personalized Federated Cluster Model ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. In addition, since the HRV feature variables have different data distributions, we normalized all values between the range of 0 and 1. As such, we created 479 instances of data based on each visit. These 479 instances were then distributed across 100 clients based on the corresponding subject number. To fully simulate a real-world environment, these clients were not given the ability intercommunicate.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.4.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.5.2" class="ltx_text ltx_font_italic">Training Procedure</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.5" class="ltx_p">The training procedure is of two steps as shown at the bottom in Figure <a href="#S3.F2" title="Figure 2 ‣ III-A Dataset ‣ III Personalized Federated Cluster Model ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
In step one, we conduct the conventional FL training method to create an updated global model.</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="W_{t}=\{{w_{t}}^{1},...,{w_{t}}^{m}\}" display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><msub id="S3.E1.m1.3.3.4" xref="S3.E1.m1.3.3.4.cmml"><mi id="S3.E1.m1.3.3.4.2" xref="S3.E1.m1.3.3.4.2.cmml">W</mi><mi id="S3.E1.m1.3.3.4.3" xref="S3.E1.m1.3.3.4.3.cmml">t</mi></msub><mo id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml">=</mo><mrow id="S3.E1.m1.3.3.2.2" xref="S3.E1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.2.2.3" xref="S3.E1.m1.3.3.2.3.cmml">{</mo><mmultiscripts id="S3.E1.m1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.2.2" xref="S3.E1.m1.2.2.1.1.1.2.2.cmml">w</mi><mi id="S3.E1.m1.2.2.1.1.1.2.3" xref="S3.E1.m1.2.2.1.1.1.2.3.cmml">t</mi><mrow id="S3.E1.m1.2.2.1.1.1a" xref="S3.E1.m1.2.2.1.1.1.cmml"></mrow><mrow id="S3.E1.m1.2.2.1.1.1b" xref="S3.E1.m1.2.2.1.1.1.cmml"></mrow><mn id="S3.E1.m1.2.2.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.3.cmml">1</mn></mmultiscripts><mo id="S3.E1.m1.3.3.2.2.4" xref="S3.E1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">…</mi><mo id="S3.E1.m1.3.3.2.2.5" xref="S3.E1.m1.3.3.2.3.cmml">,</mo><mmultiscripts id="S3.E1.m1.3.3.2.2.2" xref="S3.E1.m1.3.3.2.2.2.cmml"><mi id="S3.E1.m1.3.3.2.2.2.2.2" xref="S3.E1.m1.3.3.2.2.2.2.2.cmml">w</mi><mi id="S3.E1.m1.3.3.2.2.2.2.3" xref="S3.E1.m1.3.3.2.2.2.2.3.cmml">t</mi><mrow id="S3.E1.m1.3.3.2.2.2a" xref="S3.E1.m1.3.3.2.2.2.cmml"></mrow><mrow id="S3.E1.m1.3.3.2.2.2b" xref="S3.E1.m1.3.3.2.2.2.cmml"></mrow><mi id="S3.E1.m1.3.3.2.2.2.3" xref="S3.E1.m1.3.3.2.2.2.3.cmml">m</mi></mmultiscripts><mo stretchy="false" id="S3.E1.m1.3.3.2.2.6" xref="S3.E1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><eq id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"></eq><apply id="S3.E1.m1.3.3.4.cmml" xref="S3.E1.m1.3.3.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.4.1.cmml" xref="S3.E1.m1.3.3.4">subscript</csymbol><ci id="S3.E1.m1.3.3.4.2.cmml" xref="S3.E1.m1.3.3.4.2">𝑊</ci><ci id="S3.E1.m1.3.3.4.3.cmml" xref="S3.E1.m1.3.3.4.3">𝑡</ci></apply><set id="S3.E1.m1.3.3.2.3.cmml" xref="S3.E1.m1.3.3.2.2"><apply id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.E1.m1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2.2">𝑤</ci><ci id="S3.E1.m1.2.2.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.E1.m1.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">…</ci><apply id="S3.E1.m1.3.3.2.2.2.cmml" xref="S3.E1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.2.1.cmml" xref="S3.E1.m1.3.3.2.2.2">superscript</csymbol><apply id="S3.E1.m1.3.3.2.2.2.2.cmml" xref="S3.E1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2">𝑤</ci><ci id="S3.E1.m1.3.3.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E1.m1.3.3.2.2.2.3.cmml" xref="S3.E1.m1.3.3.2.2.2.3">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">W_{t}=\{{w_{t}}^{1},...,{w_{t}}^{m}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.4" class="ltx_p">The server first distributes a global model across all clients. Received model weights are stored locally as <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="{w_{t}}^{1}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mmultiscripts id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2.2" xref="S3.SS3.p1.1.m1.1.1.2.2.cmml">w</mi><mi id="S3.SS3.p1.1.m1.1.1.2.3" xref="S3.SS3.p1.1.m1.1.1.2.3.cmml">t</mi><mrow id="S3.SS3.p1.1.m1.1.1a" xref="S3.SS3.p1.1.m1.1.1.cmml"></mrow><mrow id="S3.SS3.p1.1.m1.1.1b" xref="S3.SS3.p1.1.m1.1.1.cmml"></mrow><mn id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">1</mn></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">superscript</csymbol><apply id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2.2">𝑤</ci><ci id="S3.SS3.p1.1.m1.1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">{w_{t}}^{1}</annotation></semantics></math>, …, <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="{w_{t}}^{m}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mmultiscripts id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.cmml">w</mi><mi id="S3.SS3.p1.2.m2.1.1.2.3" xref="S3.SS3.p1.2.m2.1.1.2.3.cmml">t</mi><mrow id="S3.SS3.p1.2.m2.1.1a" xref="S3.SS3.p1.2.m2.1.1.cmml"></mrow><mrow id="S3.SS3.p1.2.m2.1.1b" xref="S3.SS3.p1.2.m2.1.1.cmml"></mrow><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">m</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2">𝑤</ci><ci id="S3.SS3.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">{w_{t}}^{m}</annotation></semantics></math> (Eq. <a href="#S3.E1" title="In III-C Training Procedure ‣ III Personalized Federated Cluster Model ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), where <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="w_{t}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">w</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑤</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">w_{t}</annotation></semantics></math> is a global model, and <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">M</annotation></semantics></math> is the total number of clients.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\Delta{w_{t}}^{i}={w_{t}}^{i}-w_{t}" display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mrow id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml"><mi mathvariant="normal" id="S3.E2.m1.1.1.2.2" xref="S3.E2.m1.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.2.1" xref="S3.E2.m1.1.1.2.1.cmml">​</mo><mmultiscripts id="S3.E2.m1.1.1.2.3" xref="S3.E2.m1.1.1.2.3.cmml"><mi id="S3.E2.m1.1.1.2.3.2.2" xref="S3.E2.m1.1.1.2.3.2.2.cmml">w</mi><mi id="S3.E2.m1.1.1.2.3.2.3" xref="S3.E2.m1.1.1.2.3.2.3.cmml">t</mi><mrow id="S3.E2.m1.1.1.2.3a" xref="S3.E2.m1.1.1.2.3.cmml"></mrow><mrow id="S3.E2.m1.1.1.2.3b" xref="S3.E2.m1.1.1.2.3.cmml"></mrow><mi id="S3.E2.m1.1.1.2.3.3" xref="S3.E2.m1.1.1.2.3.3.cmml">i</mi></mmultiscripts></mrow><mo id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml"><mmultiscripts id="S3.E2.m1.1.1.3.2" xref="S3.E2.m1.1.1.3.2.cmml"><mi id="S3.E2.m1.1.1.3.2.2.2" xref="S3.E2.m1.1.1.3.2.2.2.cmml">w</mi><mi id="S3.E2.m1.1.1.3.2.2.3" xref="S3.E2.m1.1.1.3.2.2.3.cmml">t</mi><mrow id="S3.E2.m1.1.1.3.2a" xref="S3.E2.m1.1.1.3.2.cmml"></mrow><mrow id="S3.E2.m1.1.1.3.2b" xref="S3.E2.m1.1.1.3.2.cmml"></mrow><mi id="S3.E2.m1.1.1.3.2.3" xref="S3.E2.m1.1.1.3.2.3.cmml">i</mi></mmultiscripts><mo id="S3.E2.m1.1.1.3.1" xref="S3.E2.m1.1.1.3.1.cmml">−</mo><msub id="S3.E2.m1.1.1.3.3" xref="S3.E2.m1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.3.3.2" xref="S3.E2.m1.1.1.3.3.2.cmml">w</mi><mi id="S3.E2.m1.1.1.3.3.3" xref="S3.E2.m1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><eq id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"></eq><apply id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2"><times id="S3.E2.m1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.2.1"></times><ci id="S3.E2.m1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.2.2">Δ</ci><apply id="S3.E2.m1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.2.3.1.cmml" xref="S3.E2.m1.1.1.2.3">superscript</csymbol><apply id="S3.E2.m1.1.1.2.3.2.cmml" xref="S3.E2.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.2.3.2.1.cmml" xref="S3.E2.m1.1.1.2.3">subscript</csymbol><ci id="S3.E2.m1.1.1.2.3.2.2.cmml" xref="S3.E2.m1.1.1.2.3.2.2">𝑤</ci><ci id="S3.E2.m1.1.1.2.3.2.3.cmml" xref="S3.E2.m1.1.1.2.3.2.3">𝑡</ci></apply><ci id="S3.E2.m1.1.1.2.3.3.cmml" xref="S3.E2.m1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"><minus id="S3.E2.m1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.3.1"></minus><apply id="S3.E2.m1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.3.2">superscript</csymbol><apply id="S3.E2.m1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.2.2.1.cmml" xref="S3.E2.m1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.3.2.2.2.cmml" xref="S3.E2.m1.1.1.3.2.2.2">𝑤</ci><ci id="S3.E2.m1.1.1.3.2.2.3.cmml" xref="S3.E2.m1.1.1.3.2.2.3">𝑡</ci></apply><ci id="S3.E2.m1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.E2.m1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.3.3.2">𝑤</ci><ci id="S3.E2.m1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\Delta{w_{t}}^{i}={w_{t}}^{i}-w_{t}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.2" class="ltx_p">Each client trains its copy of the global model using its local data to calculate the weight difference between the client model and the global model as presented in Eq. <a href="#S3.E2" title="In III-C Training Procedure ‣ III Personalized Federated Cluster Model ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Then the updated set of client model weights are saved in <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\Delta W_{t}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml">​</mo><msub id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.3.2.cmml">W</mi><mi id="S3.SS3.p2.1.m1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><times id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1"></times><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">Δ</ci><apply id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.2">𝑊</ci><ci id="S3.SS3.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\Delta W_{t}</annotation></semantics></math> (<math id="S3.SS3.p2.2.m2.4" class="ltx_Math" alttext="\Delta W_{t}=\{\Delta{w_{t}}^{1},\Delta{w_{t}}^{2},...,\Delta{w_{t}}^{m}\}" display="inline"><semantics id="S3.SS3.p2.2.m2.4a"><mrow id="S3.SS3.p2.2.m2.4.4" xref="S3.SS3.p2.2.m2.4.4.cmml"><mrow id="S3.SS3.p2.2.m2.4.4.5" xref="S3.SS3.p2.2.m2.4.4.5.cmml"><mi mathvariant="normal" id="S3.SS3.p2.2.m2.4.4.5.2" xref="S3.SS3.p2.2.m2.4.4.5.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.4.4.5.1" xref="S3.SS3.p2.2.m2.4.4.5.1.cmml">​</mo><msub id="S3.SS3.p2.2.m2.4.4.5.3" xref="S3.SS3.p2.2.m2.4.4.5.3.cmml"><mi id="S3.SS3.p2.2.m2.4.4.5.3.2" xref="S3.SS3.p2.2.m2.4.4.5.3.2.cmml">W</mi><mi id="S3.SS3.p2.2.m2.4.4.5.3.3" xref="S3.SS3.p2.2.m2.4.4.5.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS3.p2.2.m2.4.4.4" xref="S3.SS3.p2.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS3.p2.2.m2.4.4.3.3" xref="S3.SS3.p2.2.m2.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS3.p2.2.m2.4.4.3.3.4" xref="S3.SS3.p2.2.m2.4.4.3.4.cmml">{</mo><mrow id="S3.SS3.p2.2.m2.2.2.1.1.1" xref="S3.SS3.p2.2.m2.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p2.2.m2.2.2.1.1.1.2" xref="S3.SS3.p2.2.m2.2.2.1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.2.2.1.1.1.1" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.cmml">​</mo><mmultiscripts id="S3.SS3.p2.2.m2.2.2.1.1.1.3" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.2.2.1.1.1.3.2.2" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3.2.2.cmml">w</mi><mi id="S3.SS3.p2.2.m2.2.2.1.1.1.3.2.3" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3.2.3.cmml">t</mi><mrow id="S3.SS3.p2.2.m2.2.2.1.1.1.3a" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3.cmml"></mrow><mrow id="S3.SS3.p2.2.m2.2.2.1.1.1.3b" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3.cmml"></mrow><mn id="S3.SS3.p2.2.m2.2.2.1.1.1.3.3" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3.3.cmml">1</mn></mmultiscripts></mrow><mo id="S3.SS3.p2.2.m2.4.4.3.3.5" xref="S3.SS3.p2.2.m2.4.4.3.4.cmml">,</mo><mrow id="S3.SS3.p2.2.m2.3.3.2.2.2" xref="S3.SS3.p2.2.m2.3.3.2.2.2.cmml"><mi mathvariant="normal" id="S3.SS3.p2.2.m2.3.3.2.2.2.2" xref="S3.SS3.p2.2.m2.3.3.2.2.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.3.3.2.2.2.1" xref="S3.SS3.p2.2.m2.3.3.2.2.2.1.cmml">​</mo><mmultiscripts id="S3.SS3.p2.2.m2.3.3.2.2.2.3" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3.cmml"><mi id="S3.SS3.p2.2.m2.3.3.2.2.2.3.2.2" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3.2.2.cmml">w</mi><mi id="S3.SS3.p2.2.m2.3.3.2.2.2.3.2.3" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3.2.3.cmml">t</mi><mrow id="S3.SS3.p2.2.m2.3.3.2.2.2.3a" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3.cmml"></mrow><mrow id="S3.SS3.p2.2.m2.3.3.2.2.2.3b" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3.cmml"></mrow><mn id="S3.SS3.p2.2.m2.3.3.2.2.2.3.3" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3.3.cmml">2</mn></mmultiscripts></mrow><mo id="S3.SS3.p2.2.m2.4.4.3.3.6" xref="S3.SS3.p2.2.m2.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.p2.2.m2.4.4.3.3.7" xref="S3.SS3.p2.2.m2.4.4.3.4.cmml">,</mo><mrow id="S3.SS3.p2.2.m2.4.4.3.3.3" xref="S3.SS3.p2.2.m2.4.4.3.3.3.cmml"><mi mathvariant="normal" id="S3.SS3.p2.2.m2.4.4.3.3.3.2" xref="S3.SS3.p2.2.m2.4.4.3.3.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.4.4.3.3.3.1" xref="S3.SS3.p2.2.m2.4.4.3.3.3.1.cmml">​</mo><mmultiscripts id="S3.SS3.p2.2.m2.4.4.3.3.3.3" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3.cmml"><mi id="S3.SS3.p2.2.m2.4.4.3.3.3.3.2.2" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3.2.2.cmml">w</mi><mi id="S3.SS3.p2.2.m2.4.4.3.3.3.3.2.3" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3.2.3.cmml">t</mi><mrow id="S3.SS3.p2.2.m2.4.4.3.3.3.3a" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3.cmml"></mrow><mrow id="S3.SS3.p2.2.m2.4.4.3.3.3.3b" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3.cmml"></mrow><mi id="S3.SS3.p2.2.m2.4.4.3.3.3.3.3" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3.3.cmml">m</mi></mmultiscripts></mrow><mo stretchy="false" id="S3.SS3.p2.2.m2.4.4.3.3.8" xref="S3.SS3.p2.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.4b"><apply id="S3.SS3.p2.2.m2.4.4.cmml" xref="S3.SS3.p2.2.m2.4.4"><eq id="S3.SS3.p2.2.m2.4.4.4.cmml" xref="S3.SS3.p2.2.m2.4.4.4"></eq><apply id="S3.SS3.p2.2.m2.4.4.5.cmml" xref="S3.SS3.p2.2.m2.4.4.5"><times id="S3.SS3.p2.2.m2.4.4.5.1.cmml" xref="S3.SS3.p2.2.m2.4.4.5.1"></times><ci id="S3.SS3.p2.2.m2.4.4.5.2.cmml" xref="S3.SS3.p2.2.m2.4.4.5.2">Δ</ci><apply id="S3.SS3.p2.2.m2.4.4.5.3.cmml" xref="S3.SS3.p2.2.m2.4.4.5.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.4.4.5.3.1.cmml" xref="S3.SS3.p2.2.m2.4.4.5.3">subscript</csymbol><ci id="S3.SS3.p2.2.m2.4.4.5.3.2.cmml" xref="S3.SS3.p2.2.m2.4.4.5.3.2">𝑊</ci><ci id="S3.SS3.p2.2.m2.4.4.5.3.3.cmml" xref="S3.SS3.p2.2.m2.4.4.5.3.3">𝑡</ci></apply></apply><set id="S3.SS3.p2.2.m2.4.4.3.4.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3"><apply id="S3.SS3.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1"><times id="S3.SS3.p2.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1"></times><ci id="S3.SS3.p2.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.2">Δ</ci><apply id="S3.SS3.p2.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.1.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3">superscript</csymbol><apply id="S3.SS3.p2.2.m2.2.2.1.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.1.1.1.3.2.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.2.m2.2.2.1.1.1.3.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3.2.2">𝑤</ci><ci id="S3.SS3.p2.2.m2.2.2.1.1.1.3.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p2.2.m2.2.2.1.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.p2.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2.2"><times id="S3.SS3.p2.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2.2.1"></times><ci id="S3.SS3.p2.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2.2.2">Δ</ci><apply id="S3.SS3.p2.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.3.3.2.2.2.3.1.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3">superscript</csymbol><apply id="S3.SS3.p2.2.m2.3.3.2.2.2.3.2.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.3.3.2.2.2.3.2.1.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS3.p2.2.m2.3.3.2.2.2.3.2.2.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3.2.2">𝑤</ci><ci id="S3.SS3.p2.2.m2.3.3.2.2.2.3.2.3.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p2.2.m2.3.3.2.2.2.3.3.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">…</ci><apply id="S3.SS3.p2.2.m2.4.4.3.3.3.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3.3"><times id="S3.SS3.p2.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3.3.1"></times><ci id="S3.SS3.p2.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3.3.2">Δ</ci><apply id="S3.SS3.p2.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.4.4.3.3.3.3.1.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3">superscript</csymbol><apply id="S3.SS3.p2.2.m2.4.4.3.3.3.3.2.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.4.4.3.3.3.3.2.1.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS3.p2.2.m2.4.4.3.3.3.3.2.2.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3.2.2">𝑤</ci><ci id="S3.SS3.p2.2.m2.4.4.3.3.3.3.2.3.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.2.m2.4.4.3.3.3.3.3.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3.3.3.3">𝑚</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.4c">\Delta W_{t}=\{\Delta{w_{t}}^{1},\Delta{w_{t}}^{2},...,\Delta{w_{t}}^{m}\}</annotation></semantics></math>).</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\Delta{w_{t}}=\frac{1}{m}\sum_{i=1}^{m}\Delta{w_{t}}^{i}" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mrow id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml"><mi mathvariant="normal" id="S3.E3.m1.1.1.2.2" xref="S3.E3.m1.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.2.1" xref="S3.E3.m1.1.1.2.1.cmml">​</mo><msub id="S3.E3.m1.1.1.2.3" xref="S3.E3.m1.1.1.2.3.cmml"><mi id="S3.E3.m1.1.1.2.3.2" xref="S3.E3.m1.1.1.2.3.2.cmml">w</mi><mi id="S3.E3.m1.1.1.2.3.3" xref="S3.E3.m1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mfrac id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml"><mn id="S3.E3.m1.1.1.3.2.2" xref="S3.E3.m1.1.1.3.2.2.cmml">1</mn><mi id="S3.E3.m1.1.1.3.2.3" xref="S3.E3.m1.1.1.3.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.1" xref="S3.E3.m1.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml"><munderover id="S3.E3.m1.1.1.3.3.1" xref="S3.E3.m1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.1.1.3.3.1.2.2" xref="S3.E3.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.3.3.1.2.3" xref="S3.E3.m1.1.1.3.3.1.2.3.cmml"><mi id="S3.E3.m1.1.1.3.3.1.2.3.2" xref="S3.E3.m1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.1.1.3.3.1.2.3.1" xref="S3.E3.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.3.3.1.2.3.3" xref="S3.E3.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.3.3.1.3" xref="S3.E3.m1.1.1.3.3.1.3.cmml">m</mi></munderover><mrow id="S3.E3.m1.1.1.3.3.2" xref="S3.E3.m1.1.1.3.3.2.cmml"><mi mathvariant="normal" id="S3.E3.m1.1.1.3.3.2.2" xref="S3.E3.m1.1.1.3.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.3.2.1" xref="S3.E3.m1.1.1.3.3.2.1.cmml">​</mo><mmultiscripts id="S3.E3.m1.1.1.3.3.2.3" xref="S3.E3.m1.1.1.3.3.2.3.cmml"><mi id="S3.E3.m1.1.1.3.3.2.3.2.2" xref="S3.E3.m1.1.1.3.3.2.3.2.2.cmml">w</mi><mi id="S3.E3.m1.1.1.3.3.2.3.2.3" xref="S3.E3.m1.1.1.3.3.2.3.2.3.cmml">t</mi><mrow id="S3.E3.m1.1.1.3.3.2.3a" xref="S3.E3.m1.1.1.3.3.2.3.cmml"></mrow><mrow id="S3.E3.m1.1.1.3.3.2.3b" xref="S3.E3.m1.1.1.3.3.2.3.cmml"></mrow><mi id="S3.E3.m1.1.1.3.3.2.3.3" xref="S3.E3.m1.1.1.3.3.2.3.3.cmml">i</mi></mmultiscripts></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"></eq><apply id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"><times id="S3.E3.m1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.2.1"></times><ci id="S3.E3.m1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.2.2">Δ</ci><apply id="S3.E3.m1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.3.1.cmml" xref="S3.E3.m1.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.2.3.2.cmml" xref="S3.E3.m1.1.1.2.3.2">𝑤</ci><ci id="S3.E3.m1.1.1.2.3.3.cmml" xref="S3.E3.m1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><times id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3.1"></times><apply id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2"><divide id="S3.E3.m1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.3.2"></divide><cn type="integer" id="S3.E3.m1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2">1</cn><ci id="S3.E3.m1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.3.2.3">𝑚</ci></apply><apply id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3"><apply id="S3.E3.m1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.1.1.cmml" xref="S3.E3.m1.1.1.3.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.3.3.1.2.cmml" xref="S3.E3.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.1.2.1.cmml" xref="S3.E3.m1.1.1.3.3.1">subscript</csymbol><sum id="S3.E3.m1.1.1.3.3.1.2.2.cmml" xref="S3.E3.m1.1.1.3.3.1.2.2"></sum><apply id="S3.E3.m1.1.1.3.3.1.2.3.cmml" xref="S3.E3.m1.1.1.3.3.1.2.3"><eq id="S3.E3.m1.1.1.3.3.1.2.3.1.cmml" xref="S3.E3.m1.1.1.3.3.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.3.3.1.2.3.2.cmml" xref="S3.E3.m1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.1.1.3.3.1.2.3.3.cmml" xref="S3.E3.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.3.3.1.3.cmml" xref="S3.E3.m1.1.1.3.3.1.3">𝑚</ci></apply><apply id="S3.E3.m1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2"><times id="S3.E3.m1.1.1.3.3.2.1.cmml" xref="S3.E3.m1.1.1.3.3.2.1"></times><ci id="S3.E3.m1.1.1.3.3.2.2.cmml" xref="S3.E3.m1.1.1.3.3.2.2">Δ</ci><apply id="S3.E3.m1.1.1.3.3.2.3.cmml" xref="S3.E3.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.2.3.1.cmml" xref="S3.E3.m1.1.1.3.3.2.3">superscript</csymbol><apply id="S3.E3.m1.1.1.3.3.2.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.2.3.2.1.cmml" xref="S3.E3.m1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.3.2.3.2.2.cmml" xref="S3.E3.m1.1.1.3.3.2.3.2.2">𝑤</ci><ci id="S3.E3.m1.1.1.3.3.2.3.2.3.cmml" xref="S3.E3.m1.1.1.3.3.2.3.2.3">𝑡</ci></apply><ci id="S3.E3.m1.1.1.3.3.2.3.3.cmml" xref="S3.E3.m1.1.1.3.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\Delta{w_{t}}=\frac{1}{m}\sum_{i=1}^{m}\Delta{w_{t}}^{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.3" class="ltx_p">After training for <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="T-1" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">T</mi><mo id="S3.SS3.p3.1.m1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.cmml">−</mo><mn id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><minus id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1"></minus><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">T-1</annotation></semantics></math> times where <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">T</annotation></semantics></math> is a total number of training epochs prior to clustering, the updated model weights are sent back to the sever. The server aggregates and averages (Eq. <a href="#S3.E3" title="In III-C Training Procedure ‣ III Personalized Federated Cluster Model ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) the updates from the clients—with the resulting weights symbolized as <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\Delta w_{t+1}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mrow id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m3.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.cmml">​</mo><msub id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.2" xref="S3.SS3.p3.3.m3.1.1.3.2.cmml">w</mi><mrow id="S3.SS3.p3.3.m3.1.1.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.3.2" xref="S3.SS3.p3.3.m3.1.1.3.3.2.cmml">t</mi><mo id="S3.SS3.p3.3.m3.1.1.3.3.1" xref="S3.SS3.p3.3.m3.1.1.3.3.1.cmml">+</mo><mn id="S3.SS3.p3.3.m3.1.1.3.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><times id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1"></times><ci id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2">Δ</ci><apply id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.2">𝑤</ci><apply id="S3.SS3.p3.3.m3.1.1.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3"><plus id="S3.SS3.p3.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.1"></plus><ci id="S3.SS3.p3.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p3.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\Delta w_{t+1}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\Delta w_{t+1}=w_{t}+\eta_{t}\Delta{w_{t}}\\
" display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mrow id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml"><mi mathvariant="normal" id="S3.E4.m1.1.1.2.2" xref="S3.E4.m1.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.2.1" xref="S3.E4.m1.1.1.2.1.cmml">​</mo><msub id="S3.E4.m1.1.1.2.3" xref="S3.E4.m1.1.1.2.3.cmml"><mi id="S3.E4.m1.1.1.2.3.2" xref="S3.E4.m1.1.1.2.3.2.cmml">w</mi><mrow id="S3.E4.m1.1.1.2.3.3" xref="S3.E4.m1.1.1.2.3.3.cmml"><mi id="S3.E4.m1.1.1.2.3.3.2" xref="S3.E4.m1.1.1.2.3.3.2.cmml">t</mi><mo id="S3.E4.m1.1.1.2.3.3.1" xref="S3.E4.m1.1.1.2.3.3.1.cmml">+</mo><mn id="S3.E4.m1.1.1.2.3.3.3" xref="S3.E4.m1.1.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><msub id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml"><mi id="S3.E4.m1.1.1.3.2.2" xref="S3.E4.m1.1.1.3.2.2.cmml">w</mi><mi id="S3.E4.m1.1.1.3.2.3" xref="S3.E4.m1.1.1.3.2.3.cmml">t</mi></msub><mo id="S3.E4.m1.1.1.3.1" xref="S3.E4.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml"><msub id="S3.E4.m1.1.1.3.3.2" xref="S3.E4.m1.1.1.3.3.2.cmml"><mi id="S3.E4.m1.1.1.3.3.2.2" xref="S3.E4.m1.1.1.3.3.2.2.cmml">η</mi><mi id="S3.E4.m1.1.1.3.3.2.3" xref="S3.E4.m1.1.1.3.3.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.3.3.1" xref="S3.E4.m1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E4.m1.1.1.3.3.3" xref="S3.E4.m1.1.1.3.3.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.3.3.1a" xref="S3.E4.m1.1.1.3.3.1.cmml">​</mo><msub id="S3.E4.m1.1.1.3.3.4" xref="S3.E4.m1.1.1.3.3.4.cmml"><mi id="S3.E4.m1.1.1.3.3.4.2" xref="S3.E4.m1.1.1.3.3.4.2.cmml">w</mi><mi id="S3.E4.m1.1.1.3.3.4.3" xref="S3.E4.m1.1.1.3.3.4.3.cmml">t</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><eq id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"></eq><apply id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2"><times id="S3.E4.m1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.2.1"></times><ci id="S3.E4.m1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.2.2">Δ</ci><apply id="S3.E4.m1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.2.3.1.cmml" xref="S3.E4.m1.1.1.2.3">subscript</csymbol><ci id="S3.E4.m1.1.1.2.3.2.cmml" xref="S3.E4.m1.1.1.2.3.2">𝑤</ci><apply id="S3.E4.m1.1.1.2.3.3.cmml" xref="S3.E4.m1.1.1.2.3.3"><plus id="S3.E4.m1.1.1.2.3.3.1.cmml" xref="S3.E4.m1.1.1.2.3.3.1"></plus><ci id="S3.E4.m1.1.1.2.3.3.2.cmml" xref="S3.E4.m1.1.1.2.3.3.2">𝑡</ci><cn type="integer" id="S3.E4.m1.1.1.2.3.3.3.cmml" xref="S3.E4.m1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><plus id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3.1"></plus><apply id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2">𝑤</ci><ci id="S3.E4.m1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.3.2.3">𝑡</ci></apply><apply id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3"><times id="S3.E4.m1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3.1"></times><apply id="S3.E4.m1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.2.1.cmml" xref="S3.E4.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.3.3.2.2.cmml" xref="S3.E4.m1.1.1.3.3.2.2">𝜂</ci><ci id="S3.E4.m1.1.1.3.3.2.3.cmml" xref="S3.E4.m1.1.1.3.3.2.3">𝑡</ci></apply><ci id="S3.E4.m1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3">Δ</ci><apply id="S3.E4.m1.1.1.3.3.4.cmml" xref="S3.E4.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.4.1.cmml" xref="S3.E4.m1.1.1.3.3.4">subscript</csymbol><ci id="S3.E4.m1.1.1.3.3.4.2.cmml" xref="S3.E4.m1.1.1.3.3.4.2">𝑤</ci><ci id="S3.E4.m1.1.1.3.3.4.3.cmml" xref="S3.E4.m1.1.1.3.3.4.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\Delta w_{t+1}=w_{t}+\eta_{t}\Delta{w_{t}}\\
</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.3" class="ltx_p">The global model is updated based on <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="\Delta w_{t}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mrow id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.cmml">​</mo><msub id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.2" xref="S3.SS3.p4.1.m1.1.1.3.2.cmml">w</mi><mi id="S3.SS3.p4.1.m1.1.1.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><times id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1"></times><ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">Δ</ci><apply id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.2">𝑤</ci><ci id="S3.SS3.p4.1.m1.1.1.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\Delta w_{t}</annotation></semantics></math>, as in Eq. <a href="#S3.E4" title="In III-C Training Procedure ‣ III Personalized Federated Cluster Model ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
Then, the updated global model (<math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="w_{T}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><msub id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">w</mi><mi id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">𝑤</ci><ci id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">w_{T}</annotation></semantics></math>) is again distributed to each client (<math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="W_{t}" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><msub id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml"><mi id="S3.SS3.p4.3.m3.1.1.2" xref="S3.SS3.p4.3.m3.1.1.2.cmml">W</mi><mi id="S3.SS3.p4.3.m3.1.1.3" xref="S3.SS3.p4.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><apply id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2">𝑊</ci><ci id="S3.SS3.p4.3.m3.1.1.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">W_{t}</annotation></semantics></math>). After this process is repeated for a pre-defined number of rounds, the resulting updated global model is saved for use in step two.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.4" class="ltx_p">In step two, we apply hierarchical clustering to the updated global model to create PFCM. Similar to step one, the server first distributes the updated global model to each client.
Each client trains its copy of the updated global model using its local data. However, rather than aggregating and averaging the weights, the server calculates <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="\Delta{w_{t}}^{i}" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><mrow id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.cmml">​</mo><mmultiscripts id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3.cmml"><mi id="S3.SS3.p5.1.m1.1.1.3.2.2" xref="S3.SS3.p5.1.m1.1.1.3.2.2.cmml">w</mi><mi id="S3.SS3.p5.1.m1.1.1.3.2.3" xref="S3.SS3.p5.1.m1.1.1.3.2.3.cmml">t</mi><mrow id="S3.SS3.p5.1.m1.1.1.3a" xref="S3.SS3.p5.1.m1.1.1.3.cmml"></mrow><mrow id="S3.SS3.p5.1.m1.1.1.3b" xref="S3.SS3.p5.1.m1.1.1.3.cmml"></mrow><mi id="S3.SS3.p5.1.m1.1.1.3.3" xref="S3.SS3.p5.1.m1.1.1.3.3.cmml">i</mi></mmultiscripts></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><times id="S3.SS3.p5.1.m1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1"></times><ci id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2">Δ</ci><apply id="S3.SS3.p5.1.m1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.3.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3">superscript</csymbol><apply id="S3.SS3.p5.1.m1.1.1.3.2.cmml" xref="S3.SS3.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.3.2.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.3.2.2.cmml" xref="S3.SS3.p5.1.m1.1.1.3.2.2">𝑤</ci><ci id="S3.SS3.p5.1.m1.1.1.3.2.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p5.1.m1.1.1.3.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">\Delta{w_{t}}^{i}</annotation></semantics></math> for each client <math id="S3.SS3.p5.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p5.2.m2.1a"><mi id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><ci id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">i</annotation></semantics></math>, defined as the difference between the weights of the updated global model and the weights trained on each client. The resulting <math id="S3.SS3.p5.3.m3.1" class="ltx_Math" alttext="\Delta{w_{t}}^{i}" display="inline"><semantics id="S3.SS3.p5.3.m3.1a"><mrow id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p5.3.m3.1.1.2" xref="S3.SS3.p5.3.m3.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.3.m3.1.1.1" xref="S3.SS3.p5.3.m3.1.1.1.cmml">​</mo><mmultiscripts id="S3.SS3.p5.3.m3.1.1.3" xref="S3.SS3.p5.3.m3.1.1.3.cmml"><mi id="S3.SS3.p5.3.m3.1.1.3.2.2" xref="S3.SS3.p5.3.m3.1.1.3.2.2.cmml">w</mi><mi id="S3.SS3.p5.3.m3.1.1.3.2.3" xref="S3.SS3.p5.3.m3.1.1.3.2.3.cmml">t</mi><mrow id="S3.SS3.p5.3.m3.1.1.3a" xref="S3.SS3.p5.3.m3.1.1.3.cmml"></mrow><mrow id="S3.SS3.p5.3.m3.1.1.3b" xref="S3.SS3.p5.3.m3.1.1.3.cmml"></mrow><mi id="S3.SS3.p5.3.m3.1.1.3.3" xref="S3.SS3.p5.3.m3.1.1.3.3.cmml">i</mi></mmultiscripts></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><apply id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1"><times id="S3.SS3.p5.3.m3.1.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1.1"></times><ci id="S3.SS3.p5.3.m3.1.1.2.cmml" xref="S3.SS3.p5.3.m3.1.1.2">Δ</ci><apply id="S3.SS3.p5.3.m3.1.1.3.cmml" xref="S3.SS3.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.3.1.cmml" xref="S3.SS3.p5.3.m3.1.1.3">superscript</csymbol><apply id="S3.SS3.p5.3.m3.1.1.3.2.cmml" xref="S3.SS3.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.3.2.1.cmml" xref="S3.SS3.p5.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.p5.3.m3.1.1.3.2.2.cmml" xref="S3.SS3.p5.3.m3.1.1.3.2.2">𝑤</ci><ci id="S3.SS3.p5.3.m3.1.1.3.2.3.cmml" xref="S3.SS3.p5.3.m3.1.1.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p5.3.m3.1.1.3.3.cmml" xref="S3.SS3.p5.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">\Delta{w_{t}}^{i}</annotation></semantics></math> for each client <math id="S3.SS3.p5.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p5.4.m4.1a"><mi id="S3.SS3.p5.4.m4.1.1" xref="S3.SS3.p5.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.4.m4.1b"><ci id="S3.SS3.p5.4.m4.1.1.cmml" xref="S3.SS3.p5.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.4.m4.1c">i</annotation></semantics></math> are clustered using the bottom-up hierarchical clustering algorithm to group clients of sufficiently similar weight updates to produce PFCM. Each clustered model is further trained with the conventional FL algorithm described in step one—with a key difference to the number of client updates being aggregated and averaged at each round. The result after a pre-defined number of rounds of training is a PFCM.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.1" class="ltx_p ltx_figure_panel"><span id="alg1.1.1" class="ltx_text"><span id="alg1.1.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>new client with data <math id="alg1.1.m1.1" class="ltx_Math" alttext="D_{test}" display="inline"><semantics id="alg1.1.m1.1a"><msub id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml"><mi id="alg1.1.m1.1.1.2" xref="alg1.1.m1.1.1.2.cmml">D</mi><mrow id="alg1.1.m1.1.1.3" xref="alg1.1.m1.1.1.3.cmml"><mi id="alg1.1.m1.1.1.3.2" xref="alg1.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.1.m1.1.1.3.1" xref="alg1.1.m1.1.1.3.1.cmml">​</mo><mi id="alg1.1.m1.1.1.3.3" xref="alg1.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.1.m1.1.1.3.1a" xref="alg1.1.m1.1.1.3.1.cmml">​</mo><mi id="alg1.1.m1.1.1.3.4" xref="alg1.1.m1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.1.m1.1.1.3.1b" xref="alg1.1.m1.1.1.3.1.cmml">​</mo><mi id="alg1.1.m1.1.1.3.5" xref="alg1.1.m1.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><apply id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.1.m1.1.1.1.cmml" xref="alg1.1.m1.1.1">subscript</csymbol><ci id="alg1.1.m1.1.1.2.cmml" xref="alg1.1.m1.1.1.2">𝐷</ci><apply id="alg1.1.m1.1.1.3.cmml" xref="alg1.1.m1.1.1.3"><times id="alg1.1.m1.1.1.3.1.cmml" xref="alg1.1.m1.1.1.3.1"></times><ci id="alg1.1.m1.1.1.3.2.cmml" xref="alg1.1.m1.1.1.3.2">𝑡</ci><ci id="alg1.1.m1.1.1.3.3.cmml" xref="alg1.1.m1.1.1.3.3">𝑒</ci><ci id="alg1.1.m1.1.1.3.4.cmml" xref="alg1.1.m1.1.1.3.4">𝑠</ci><ci id="alg1.1.m1.1.1.3.5.cmml" xref="alg1.1.m1.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">D_{test}</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.4" class="ltx_p ltx_figure_panel">Initialize <math id="alg1.2.m1.1" class="ltx_Math" alttext="w_{0}" display="inline"><semantics id="alg1.2.m1.1a"><msub id="alg1.2.m1.1.1" xref="alg1.2.m1.1.1.cmml"><mi id="alg1.2.m1.1.1.2" xref="alg1.2.m1.1.1.2.cmml">w</mi><mn id="alg1.2.m1.1.1.3" xref="alg1.2.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.2.m1.1b"><apply id="alg1.2.m1.1.1.cmml" xref="alg1.2.m1.1.1"><csymbol cd="ambiguous" id="alg1.2.m1.1.1.1.cmml" xref="alg1.2.m1.1.1">subscript</csymbol><ci id="alg1.2.m1.1.1.2.cmml" xref="alg1.2.m1.1.1.2">𝑤</ci><cn type="integer" id="alg1.2.m1.1.1.3.cmml" xref="alg1.2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m1.1c">w_{0}</annotation></semantics></math>
<br class="ltx_break"><span id="alg1.4.3" class="ltx_text ltx_font_bold">for</span> <em id="alg1.4.2" class="ltx_emph ltx_font_italic"><math id="alg1.3.1.m1.1" class="ltx_Math" alttext="p\leftarrow 0" display="inline"><semantics id="alg1.3.1.m1.1a"><mrow id="alg1.3.1.m1.1.1" xref="alg1.3.1.m1.1.1.cmml"><mi id="alg1.3.1.m1.1.1.2" xref="alg1.3.1.m1.1.1.2.cmml">p</mi><mo stretchy="false" id="alg1.3.1.m1.1.1.1" xref="alg1.3.1.m1.1.1.1.cmml">←</mo><mn id="alg1.3.1.m1.1.1.3" xref="alg1.3.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.3.1.m1.1b"><apply id="alg1.3.1.m1.1.1.cmml" xref="alg1.3.1.m1.1.1"><ci id="alg1.3.1.m1.1.1.1.cmml" xref="alg1.3.1.m1.1.1.1">←</ci><ci id="alg1.3.1.m1.1.1.2.cmml" xref="alg1.3.1.m1.1.1.2">𝑝</ci><cn type="integer" id="alg1.3.1.m1.1.1.3.cmml" xref="alg1.3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.1.m1.1c">p\leftarrow 0</annotation></semantics></math> <span id="alg1.4.2.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> <math id="alg1.4.2.m2.1" class="ltx_Math" alttext="P" display="inline"><semantics id="alg1.4.2.m2.1a"><mi id="alg1.4.2.m2.1.1" xref="alg1.4.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.4.2.m2.1b"><ci id="alg1.4.2.m2.1.1.cmml" xref="alg1.4.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.2.m2.1c">P</annotation></semantics></math> </em> <span id="alg1.4.4" class="ltx_text ltx_font_bold">do</span> </p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="alg1.28" class="ltx_block ltx_figure_panel">
<div id="alg1.5" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.5.m1.1" class="ltx_Math" alttext="w_{p+1}\leftarrow WeightUpdate(w_{p})" display="inline"><semantics id="alg1.5.m1.1a"><mrow id="alg1.5.m1.1.1" xref="alg1.5.m1.1.1.cmml"><msub id="alg1.5.m1.1.1.3" xref="alg1.5.m1.1.1.3.cmml"><mi id="alg1.5.m1.1.1.3.2" xref="alg1.5.m1.1.1.3.2.cmml">w</mi><mrow id="alg1.5.m1.1.1.3.3" xref="alg1.5.m1.1.1.3.3.cmml"><mi id="alg1.5.m1.1.1.3.3.2" xref="alg1.5.m1.1.1.3.3.2.cmml">p</mi><mo id="alg1.5.m1.1.1.3.3.1" xref="alg1.5.m1.1.1.3.3.1.cmml">+</mo><mn id="alg1.5.m1.1.1.3.3.3" xref="alg1.5.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg1.5.m1.1.1.2" xref="alg1.5.m1.1.1.2.cmml">←</mo><mrow id="alg1.5.m1.1.1.1" xref="alg1.5.m1.1.1.1.cmml"><mi id="alg1.5.m1.1.1.1.3" xref="alg1.5.m1.1.1.1.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="alg1.5.m1.1.1.1.2" xref="alg1.5.m1.1.1.1.2.cmml">​</mo><mi id="alg1.5.m1.1.1.1.4" xref="alg1.5.m1.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.5.m1.1.1.1.2a" xref="alg1.5.m1.1.1.1.2.cmml">​</mo><mi id="alg1.5.m1.1.1.1.5" xref="alg1.5.m1.1.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.5.m1.1.1.1.2b" xref="alg1.5.m1.1.1.1.2.cmml">​</mo><mi id="alg1.5.m1.1.1.1.6" xref="alg1.5.m1.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.5.m1.1.1.1.2c" xref="alg1.5.m1.1.1.1.2.cmml">​</mo><mi id="alg1.5.m1.1.1.1.7" xref="alg1.5.m1.1.1.1.7.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.5.m1.1.1.1.2d" xref="alg1.5.m1.1.1.1.2.cmml">​</mo><mi id="alg1.5.m1.1.1.1.8" xref="alg1.5.m1.1.1.1.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.5.m1.1.1.1.2e" xref="alg1.5.m1.1.1.1.2.cmml">​</mo><mi id="alg1.5.m1.1.1.1.9" xref="alg1.5.m1.1.1.1.9.cmml">U</mi><mo lspace="0em" rspace="0em" id="alg1.5.m1.1.1.1.2f" xref="alg1.5.m1.1.1.1.2.cmml">​</mo><mi id="alg1.5.m1.1.1.1.10" xref="alg1.5.m1.1.1.1.10.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.5.m1.1.1.1.2g" xref="alg1.5.m1.1.1.1.2.cmml">​</mo><mi id="alg1.5.m1.1.1.1.11" xref="alg1.5.m1.1.1.1.11.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.5.m1.1.1.1.2h" xref="alg1.5.m1.1.1.1.2.cmml">​</mo><mi id="alg1.5.m1.1.1.1.12" xref="alg1.5.m1.1.1.1.12.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.5.m1.1.1.1.2i" xref="alg1.5.m1.1.1.1.2.cmml">​</mo><mi id="alg1.5.m1.1.1.1.13" xref="alg1.5.m1.1.1.1.13.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.5.m1.1.1.1.2j" xref="alg1.5.m1.1.1.1.2.cmml">​</mo><mi id="alg1.5.m1.1.1.1.14" xref="alg1.5.m1.1.1.1.14.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.5.m1.1.1.1.2k" xref="alg1.5.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.5.m1.1.1.1.1.1" xref="alg1.5.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.5.m1.1.1.1.1.1.2" xref="alg1.5.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.5.m1.1.1.1.1.1.1" xref="alg1.5.m1.1.1.1.1.1.1.cmml"><mi id="alg1.5.m1.1.1.1.1.1.1.2" xref="alg1.5.m1.1.1.1.1.1.1.2.cmml">w</mi><mi id="alg1.5.m1.1.1.1.1.1.1.3" xref="alg1.5.m1.1.1.1.1.1.1.3.cmml">p</mi></msub><mo stretchy="false" id="alg1.5.m1.1.1.1.1.1.3" xref="alg1.5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.5.m1.1b"><apply id="alg1.5.m1.1.1.cmml" xref="alg1.5.m1.1.1"><ci id="alg1.5.m1.1.1.2.cmml" xref="alg1.5.m1.1.1.2">←</ci><apply id="alg1.5.m1.1.1.3.cmml" xref="alg1.5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.5.m1.1.1.3.1.cmml" xref="alg1.5.m1.1.1.3">subscript</csymbol><ci id="alg1.5.m1.1.1.3.2.cmml" xref="alg1.5.m1.1.1.3.2">𝑤</ci><apply id="alg1.5.m1.1.1.3.3.cmml" xref="alg1.5.m1.1.1.3.3"><plus id="alg1.5.m1.1.1.3.3.1.cmml" xref="alg1.5.m1.1.1.3.3.1"></plus><ci id="alg1.5.m1.1.1.3.3.2.cmml" xref="alg1.5.m1.1.1.3.3.2">𝑝</ci><cn type="integer" id="alg1.5.m1.1.1.3.3.3.cmml" xref="alg1.5.m1.1.1.3.3.3">1</cn></apply></apply><apply id="alg1.5.m1.1.1.1.cmml" xref="alg1.5.m1.1.1.1"><times id="alg1.5.m1.1.1.1.2.cmml" xref="alg1.5.m1.1.1.1.2"></times><ci id="alg1.5.m1.1.1.1.3.cmml" xref="alg1.5.m1.1.1.1.3">𝑊</ci><ci id="alg1.5.m1.1.1.1.4.cmml" xref="alg1.5.m1.1.1.1.4">𝑒</ci><ci id="alg1.5.m1.1.1.1.5.cmml" xref="alg1.5.m1.1.1.1.5">𝑖</ci><ci id="alg1.5.m1.1.1.1.6.cmml" xref="alg1.5.m1.1.1.1.6">𝑔</ci><ci id="alg1.5.m1.1.1.1.7.cmml" xref="alg1.5.m1.1.1.1.7">ℎ</ci><ci id="alg1.5.m1.1.1.1.8.cmml" xref="alg1.5.m1.1.1.1.8">𝑡</ci><ci id="alg1.5.m1.1.1.1.9.cmml" xref="alg1.5.m1.1.1.1.9">𝑈</ci><ci id="alg1.5.m1.1.1.1.10.cmml" xref="alg1.5.m1.1.1.1.10">𝑝</ci><ci id="alg1.5.m1.1.1.1.11.cmml" xref="alg1.5.m1.1.1.1.11">𝑑</ci><ci id="alg1.5.m1.1.1.1.12.cmml" xref="alg1.5.m1.1.1.1.12">𝑎</ci><ci id="alg1.5.m1.1.1.1.13.cmml" xref="alg1.5.m1.1.1.1.13">𝑡</ci><ci id="alg1.5.m1.1.1.1.14.cmml" xref="alg1.5.m1.1.1.1.14">𝑒</ci><apply id="alg1.5.m1.1.1.1.1.1.1.cmml" xref="alg1.5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.5.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.5.m1.1.1.1.1.1.1.2.cmml" xref="alg1.5.m1.1.1.1.1.1.1.2">𝑤</ci><ci id="alg1.5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.5.m1.1.1.1.1.1.1.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m1.1c">w_{p+1}\leftarrow WeightUpdate(w_{p})</annotation></semantics></math>

</div>
<div id="alg1.28.1" class="ltx_listingline"> end for
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="alg1.29" class="ltx_block ltx_figure_panel">
<div id="alg1.8" class="ltx_listingline">
<math id="alg1.6.m1.1" class="ltx_Math" alttext="\Delta W_{test}\leftarrow w_{P}-w_{T}" display="inline"><semantics id="alg1.6.m1.1a"><mrow id="alg1.6.m1.1.1" xref="alg1.6.m1.1.1.cmml"><mrow id="alg1.6.m1.1.1.2" xref="alg1.6.m1.1.1.2.cmml"><mi mathvariant="normal" id="alg1.6.m1.1.1.2.2" xref="alg1.6.m1.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.6.m1.1.1.2.1" xref="alg1.6.m1.1.1.2.1.cmml">​</mo><msub id="alg1.6.m1.1.1.2.3" xref="alg1.6.m1.1.1.2.3.cmml"><mi id="alg1.6.m1.1.1.2.3.2" xref="alg1.6.m1.1.1.2.3.2.cmml">W</mi><mrow id="alg1.6.m1.1.1.2.3.3" xref="alg1.6.m1.1.1.2.3.3.cmml"><mi id="alg1.6.m1.1.1.2.3.3.2" xref="alg1.6.m1.1.1.2.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.6.m1.1.1.2.3.3.1" xref="alg1.6.m1.1.1.2.3.3.1.cmml">​</mo><mi id="alg1.6.m1.1.1.2.3.3.3" xref="alg1.6.m1.1.1.2.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.6.m1.1.1.2.3.3.1a" xref="alg1.6.m1.1.1.2.3.3.1.cmml">​</mo><mi id="alg1.6.m1.1.1.2.3.3.4" xref="alg1.6.m1.1.1.2.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.6.m1.1.1.2.3.3.1b" xref="alg1.6.m1.1.1.2.3.3.1.cmml">​</mo><mi id="alg1.6.m1.1.1.2.3.3.5" xref="alg1.6.m1.1.1.2.3.3.5.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="alg1.6.m1.1.1.1" xref="alg1.6.m1.1.1.1.cmml">←</mo><mrow id="alg1.6.m1.1.1.3" xref="alg1.6.m1.1.1.3.cmml"><msub id="alg1.6.m1.1.1.3.2" xref="alg1.6.m1.1.1.3.2.cmml"><mi id="alg1.6.m1.1.1.3.2.2" xref="alg1.6.m1.1.1.3.2.2.cmml">w</mi><mi id="alg1.6.m1.1.1.3.2.3" xref="alg1.6.m1.1.1.3.2.3.cmml">P</mi></msub><mo id="alg1.6.m1.1.1.3.1" xref="alg1.6.m1.1.1.3.1.cmml">−</mo><msub id="alg1.6.m1.1.1.3.3" xref="alg1.6.m1.1.1.3.3.cmml"><mi id="alg1.6.m1.1.1.3.3.2" xref="alg1.6.m1.1.1.3.3.2.cmml">w</mi><mi id="alg1.6.m1.1.1.3.3.3" xref="alg1.6.m1.1.1.3.3.3.cmml">T</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.6.m1.1b"><apply id="alg1.6.m1.1.1.cmml" xref="alg1.6.m1.1.1"><ci id="alg1.6.m1.1.1.1.cmml" xref="alg1.6.m1.1.1.1">←</ci><apply id="alg1.6.m1.1.1.2.cmml" xref="alg1.6.m1.1.1.2"><times id="alg1.6.m1.1.1.2.1.cmml" xref="alg1.6.m1.1.1.2.1"></times><ci id="alg1.6.m1.1.1.2.2.cmml" xref="alg1.6.m1.1.1.2.2">Δ</ci><apply id="alg1.6.m1.1.1.2.3.cmml" xref="alg1.6.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.6.m1.1.1.2.3.1.cmml" xref="alg1.6.m1.1.1.2.3">subscript</csymbol><ci id="alg1.6.m1.1.1.2.3.2.cmml" xref="alg1.6.m1.1.1.2.3.2">𝑊</ci><apply id="alg1.6.m1.1.1.2.3.3.cmml" xref="alg1.6.m1.1.1.2.3.3"><times id="alg1.6.m1.1.1.2.3.3.1.cmml" xref="alg1.6.m1.1.1.2.3.3.1"></times><ci id="alg1.6.m1.1.1.2.3.3.2.cmml" xref="alg1.6.m1.1.1.2.3.3.2">𝑡</ci><ci id="alg1.6.m1.1.1.2.3.3.3.cmml" xref="alg1.6.m1.1.1.2.3.3.3">𝑒</ci><ci id="alg1.6.m1.1.1.2.3.3.4.cmml" xref="alg1.6.m1.1.1.2.3.3.4">𝑠</ci><ci id="alg1.6.m1.1.1.2.3.3.5.cmml" xref="alg1.6.m1.1.1.2.3.3.5">𝑡</ci></apply></apply></apply><apply id="alg1.6.m1.1.1.3.cmml" xref="alg1.6.m1.1.1.3"><minus id="alg1.6.m1.1.1.3.1.cmml" xref="alg1.6.m1.1.1.3.1"></minus><apply id="alg1.6.m1.1.1.3.2.cmml" xref="alg1.6.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.6.m1.1.1.3.2.1.cmml" xref="alg1.6.m1.1.1.3.2">subscript</csymbol><ci id="alg1.6.m1.1.1.3.2.2.cmml" xref="alg1.6.m1.1.1.3.2.2">𝑤</ci><ci id="alg1.6.m1.1.1.3.2.3.cmml" xref="alg1.6.m1.1.1.3.2.3">𝑃</ci></apply><apply id="alg1.6.m1.1.1.3.3.cmml" xref="alg1.6.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.6.m1.1.1.3.3.1.cmml" xref="alg1.6.m1.1.1.3.3">subscript</csymbol><ci id="alg1.6.m1.1.1.3.3.2.cmml" xref="alg1.6.m1.1.1.3.3.2">𝑤</ci><ci id="alg1.6.m1.1.1.3.3.3.cmml" xref="alg1.6.m1.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m1.1c">\Delta W_{test}\leftarrow w_{P}-w_{T}</annotation></semantics></math> 
<br class="ltx_break"><span id="alg1.8.3" class="ltx_text ltx_font_bold">for</span> <em id="alg1.8.2" class="ltx_emph ltx_font_italic"><math id="alg1.7.1.m1.1" class="ltx_Math" alttext="k\leftarrow 0" display="inline"><semantics id="alg1.7.1.m1.1a"><mrow id="alg1.7.1.m1.1.1" xref="alg1.7.1.m1.1.1.cmml"><mi id="alg1.7.1.m1.1.1.2" xref="alg1.7.1.m1.1.1.2.cmml">k</mi><mo stretchy="false" id="alg1.7.1.m1.1.1.1" xref="alg1.7.1.m1.1.1.1.cmml">←</mo><mn id="alg1.7.1.m1.1.1.3" xref="alg1.7.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.7.1.m1.1b"><apply id="alg1.7.1.m1.1.1.cmml" xref="alg1.7.1.m1.1.1"><ci id="alg1.7.1.m1.1.1.1.cmml" xref="alg1.7.1.m1.1.1.1">←</ci><ci id="alg1.7.1.m1.1.1.2.cmml" xref="alg1.7.1.m1.1.1.2">𝑘</ci><cn type="integer" id="alg1.7.1.m1.1.1.3.cmml" xref="alg1.7.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.1.m1.1c">k\leftarrow 0</annotation></semantics></math> <span id="alg1.8.2.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> <math id="alg1.8.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.8.2.m2.1a"><mi id="alg1.8.2.m2.1.1" xref="alg1.8.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.8.2.m2.1b"><ci id="alg1.8.2.m2.1.1.cmml" xref="alg1.8.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.2.m2.1c">K</annotation></semantics></math> </em> <span id="alg1.8.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg1.9" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.9.m1.2" class="ltx_Math" alttext="idx\leftarrow FindNearestCluster(C_{k},\Delta W_{test})" display="inline"><semantics id="alg1.9.m1.2a"><mrow id="alg1.9.m1.2.2" xref="alg1.9.m1.2.2.cmml"><mrow id="alg1.9.m1.2.2.4" xref="alg1.9.m1.2.2.4.cmml"><mi id="alg1.9.m1.2.2.4.2" xref="alg1.9.m1.2.2.4.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.4.1" xref="alg1.9.m1.2.2.4.1.cmml">​</mo><mi id="alg1.9.m1.2.2.4.3" xref="alg1.9.m1.2.2.4.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.4.1a" xref="alg1.9.m1.2.2.4.1.cmml">​</mo><mi id="alg1.9.m1.2.2.4.4" xref="alg1.9.m1.2.2.4.4.cmml">x</mi></mrow><mo stretchy="false" id="alg1.9.m1.2.2.3" xref="alg1.9.m1.2.2.3.cmml">←</mo><mrow id="alg1.9.m1.2.2.2" xref="alg1.9.m1.2.2.2.cmml"><mi id="alg1.9.m1.2.2.2.4" xref="alg1.9.m1.2.2.2.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.5" xref="alg1.9.m1.2.2.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3a" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.6" xref="alg1.9.m1.2.2.2.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3b" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.7" xref="alg1.9.m1.2.2.2.7.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3c" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.8" xref="alg1.9.m1.2.2.2.8.cmml">N</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3d" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.9" xref="alg1.9.m1.2.2.2.9.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3e" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.10" xref="alg1.9.m1.2.2.2.10.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3f" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.11" xref="alg1.9.m1.2.2.2.11.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3g" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.12" xref="alg1.9.m1.2.2.2.12.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3h" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.13" xref="alg1.9.m1.2.2.2.13.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3i" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.14" xref="alg1.9.m1.2.2.2.14.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3j" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.15" xref="alg1.9.m1.2.2.2.15.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3k" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.16" xref="alg1.9.m1.2.2.2.16.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3l" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.17" xref="alg1.9.m1.2.2.2.17.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3m" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.18" xref="alg1.9.m1.2.2.2.18.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3n" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.19" xref="alg1.9.m1.2.2.2.19.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3o" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.20" xref="alg1.9.m1.2.2.2.20.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3p" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mi id="alg1.9.m1.2.2.2.21" xref="alg1.9.m1.2.2.2.21.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.3q" xref="alg1.9.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.9.m1.2.2.2.2.2" xref="alg1.9.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.9.m1.2.2.2.2.2.3" xref="alg1.9.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.9.m1.1.1.1.1.1.1" xref="alg1.9.m1.1.1.1.1.1.1.cmml"><mi id="alg1.9.m1.1.1.1.1.1.1.2" xref="alg1.9.m1.1.1.1.1.1.1.2.cmml">C</mi><mi id="alg1.9.m1.1.1.1.1.1.1.3" xref="alg1.9.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="alg1.9.m1.2.2.2.2.2.4" xref="alg1.9.m1.2.2.2.2.3.cmml">,</mo><mrow id="alg1.9.m1.2.2.2.2.2.2" xref="alg1.9.m1.2.2.2.2.2.2.cmml"><mi mathvariant="normal" id="alg1.9.m1.2.2.2.2.2.2.2" xref="alg1.9.m1.2.2.2.2.2.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.2.2.2.1" xref="alg1.9.m1.2.2.2.2.2.2.1.cmml">​</mo><msub id="alg1.9.m1.2.2.2.2.2.2.3" xref="alg1.9.m1.2.2.2.2.2.2.3.cmml"><mi id="alg1.9.m1.2.2.2.2.2.2.3.2" xref="alg1.9.m1.2.2.2.2.2.2.3.2.cmml">W</mi><mrow id="alg1.9.m1.2.2.2.2.2.2.3.3" xref="alg1.9.m1.2.2.2.2.2.2.3.3.cmml"><mi id="alg1.9.m1.2.2.2.2.2.2.3.3.2" xref="alg1.9.m1.2.2.2.2.2.2.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.2.2.2.3.3.1" xref="alg1.9.m1.2.2.2.2.2.2.3.3.1.cmml">​</mo><mi id="alg1.9.m1.2.2.2.2.2.2.3.3.3" xref="alg1.9.m1.2.2.2.2.2.2.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.2.2.2.3.3.1a" xref="alg1.9.m1.2.2.2.2.2.2.3.3.1.cmml">​</mo><mi id="alg1.9.m1.2.2.2.2.2.2.3.3.4" xref="alg1.9.m1.2.2.2.2.2.2.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.9.m1.2.2.2.2.2.2.3.3.1b" xref="alg1.9.m1.2.2.2.2.2.2.3.3.1.cmml">​</mo><mi id="alg1.9.m1.2.2.2.2.2.2.3.3.5" xref="alg1.9.m1.2.2.2.2.2.2.3.3.5.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="alg1.9.m1.2.2.2.2.2.5" xref="alg1.9.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.m1.2b"><apply id="alg1.9.m1.2.2.cmml" xref="alg1.9.m1.2.2"><ci id="alg1.9.m1.2.2.3.cmml" xref="alg1.9.m1.2.2.3">←</ci><apply id="alg1.9.m1.2.2.4.cmml" xref="alg1.9.m1.2.2.4"><times id="alg1.9.m1.2.2.4.1.cmml" xref="alg1.9.m1.2.2.4.1"></times><ci id="alg1.9.m1.2.2.4.2.cmml" xref="alg1.9.m1.2.2.4.2">𝑖</ci><ci id="alg1.9.m1.2.2.4.3.cmml" xref="alg1.9.m1.2.2.4.3">𝑑</ci><ci id="alg1.9.m1.2.2.4.4.cmml" xref="alg1.9.m1.2.2.4.4">𝑥</ci></apply><apply id="alg1.9.m1.2.2.2.cmml" xref="alg1.9.m1.2.2.2"><times id="alg1.9.m1.2.2.2.3.cmml" xref="alg1.9.m1.2.2.2.3"></times><ci id="alg1.9.m1.2.2.2.4.cmml" xref="alg1.9.m1.2.2.2.4">𝐹</ci><ci id="alg1.9.m1.2.2.2.5.cmml" xref="alg1.9.m1.2.2.2.5">𝑖</ci><ci id="alg1.9.m1.2.2.2.6.cmml" xref="alg1.9.m1.2.2.2.6">𝑛</ci><ci id="alg1.9.m1.2.2.2.7.cmml" xref="alg1.9.m1.2.2.2.7">𝑑</ci><ci id="alg1.9.m1.2.2.2.8.cmml" xref="alg1.9.m1.2.2.2.8">𝑁</ci><ci id="alg1.9.m1.2.2.2.9.cmml" xref="alg1.9.m1.2.2.2.9">𝑒</ci><ci id="alg1.9.m1.2.2.2.10.cmml" xref="alg1.9.m1.2.2.2.10">𝑎</ci><ci id="alg1.9.m1.2.2.2.11.cmml" xref="alg1.9.m1.2.2.2.11">𝑟</ci><ci id="alg1.9.m1.2.2.2.12.cmml" xref="alg1.9.m1.2.2.2.12">𝑒</ci><ci id="alg1.9.m1.2.2.2.13.cmml" xref="alg1.9.m1.2.2.2.13">𝑠</ci><ci id="alg1.9.m1.2.2.2.14.cmml" xref="alg1.9.m1.2.2.2.14">𝑡</ci><ci id="alg1.9.m1.2.2.2.15.cmml" xref="alg1.9.m1.2.2.2.15">𝐶</ci><ci id="alg1.9.m1.2.2.2.16.cmml" xref="alg1.9.m1.2.2.2.16">𝑙</ci><ci id="alg1.9.m1.2.2.2.17.cmml" xref="alg1.9.m1.2.2.2.17">𝑢</ci><ci id="alg1.9.m1.2.2.2.18.cmml" xref="alg1.9.m1.2.2.2.18">𝑠</ci><ci id="alg1.9.m1.2.2.2.19.cmml" xref="alg1.9.m1.2.2.2.19">𝑡</ci><ci id="alg1.9.m1.2.2.2.20.cmml" xref="alg1.9.m1.2.2.2.20">𝑒</ci><ci id="alg1.9.m1.2.2.2.21.cmml" xref="alg1.9.m1.2.2.2.21">𝑟</ci><interval closure="open" id="alg1.9.m1.2.2.2.2.3.cmml" xref="alg1.9.m1.2.2.2.2.2"><apply id="alg1.9.m1.1.1.1.1.1.1.cmml" xref="alg1.9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.9.m1.1.1.1.1.1.1.1.cmml" xref="alg1.9.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.9.m1.1.1.1.1.1.1.2.cmml" xref="alg1.9.m1.1.1.1.1.1.1.2">𝐶</ci><ci id="alg1.9.m1.1.1.1.1.1.1.3.cmml" xref="alg1.9.m1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.9.m1.2.2.2.2.2.2.cmml" xref="alg1.9.m1.2.2.2.2.2.2"><times id="alg1.9.m1.2.2.2.2.2.2.1.cmml" xref="alg1.9.m1.2.2.2.2.2.2.1"></times><ci id="alg1.9.m1.2.2.2.2.2.2.2.cmml" xref="alg1.9.m1.2.2.2.2.2.2.2">Δ</ci><apply id="alg1.9.m1.2.2.2.2.2.2.3.cmml" xref="alg1.9.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.9.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.9.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="alg1.9.m1.2.2.2.2.2.2.3.2.cmml" xref="alg1.9.m1.2.2.2.2.2.2.3.2">𝑊</ci><apply id="alg1.9.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.9.m1.2.2.2.2.2.2.3.3"><times id="alg1.9.m1.2.2.2.2.2.2.3.3.1.cmml" xref="alg1.9.m1.2.2.2.2.2.2.3.3.1"></times><ci id="alg1.9.m1.2.2.2.2.2.2.3.3.2.cmml" xref="alg1.9.m1.2.2.2.2.2.2.3.3.2">𝑡</ci><ci id="alg1.9.m1.2.2.2.2.2.2.3.3.3.cmml" xref="alg1.9.m1.2.2.2.2.2.2.3.3.3">𝑒</ci><ci id="alg1.9.m1.2.2.2.2.2.2.3.3.4.cmml" xref="alg1.9.m1.2.2.2.2.2.2.3.3.4">𝑠</ci><ci id="alg1.9.m1.2.2.2.2.2.2.3.3.5.cmml" xref="alg1.9.m1.2.2.2.2.2.2.3.3.5">𝑡</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m1.2c">idx\leftarrow FindNearestCluster(C_{k},\Delta W_{test})</annotation></semantics></math>

</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="alg1.30" class="ltx_block ltx_figure_panel">
<div id="alg1.30.1" class="ltx_listingline"> end for
</div>
<div id="alg1.10" class="ltx_listingline">Evaluate(<math id="alg1.10.m1.2" class="ltx_Math" alttext="W_{C_{idx}},D_{test}" display="inline"><semantics id="alg1.10.m1.2a"><mrow id="alg1.10.m1.2.2.2" xref="alg1.10.m1.2.2.3.cmml"><msub id="alg1.10.m1.1.1.1.1" xref="alg1.10.m1.1.1.1.1.cmml"><mi id="alg1.10.m1.1.1.1.1.2" xref="alg1.10.m1.1.1.1.1.2.cmml">W</mi><msub id="alg1.10.m1.1.1.1.1.3" xref="alg1.10.m1.1.1.1.1.3.cmml"><mi id="alg1.10.m1.1.1.1.1.3.2" xref="alg1.10.m1.1.1.1.1.3.2.cmml">C</mi><mrow id="alg1.10.m1.1.1.1.1.3.3" xref="alg1.10.m1.1.1.1.1.3.3.cmml"><mi id="alg1.10.m1.1.1.1.1.3.3.2" xref="alg1.10.m1.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.10.m1.1.1.1.1.3.3.1" xref="alg1.10.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="alg1.10.m1.1.1.1.1.3.3.3" xref="alg1.10.m1.1.1.1.1.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.10.m1.1.1.1.1.3.3.1a" xref="alg1.10.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="alg1.10.m1.1.1.1.1.3.3.4" xref="alg1.10.m1.1.1.1.1.3.3.4.cmml">x</mi></mrow></msub></msub><mo id="alg1.10.m1.2.2.2.3" xref="alg1.10.m1.2.2.3.cmml">,</mo><msub id="alg1.10.m1.2.2.2.2" xref="alg1.10.m1.2.2.2.2.cmml"><mi id="alg1.10.m1.2.2.2.2.2" xref="alg1.10.m1.2.2.2.2.2.cmml">D</mi><mrow id="alg1.10.m1.2.2.2.2.3" xref="alg1.10.m1.2.2.2.2.3.cmml"><mi id="alg1.10.m1.2.2.2.2.3.2" xref="alg1.10.m1.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.10.m1.2.2.2.2.3.1" xref="alg1.10.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.10.m1.2.2.2.2.3.3" xref="alg1.10.m1.2.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.10.m1.2.2.2.2.3.1a" xref="alg1.10.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.10.m1.2.2.2.2.3.4" xref="alg1.10.m1.2.2.2.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.10.m1.2.2.2.2.3.1b" xref="alg1.10.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.10.m1.2.2.2.2.3.5" xref="alg1.10.m1.2.2.2.2.3.5.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.10.m1.2b"><list id="alg1.10.m1.2.2.3.cmml" xref="alg1.10.m1.2.2.2"><apply id="alg1.10.m1.1.1.1.1.cmml" xref="alg1.10.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.10.m1.1.1.1.1.1.cmml" xref="alg1.10.m1.1.1.1.1">subscript</csymbol><ci id="alg1.10.m1.1.1.1.1.2.cmml" xref="alg1.10.m1.1.1.1.1.2">𝑊</ci><apply id="alg1.10.m1.1.1.1.1.3.cmml" xref="alg1.10.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.10.m1.1.1.1.1.3.1.cmml" xref="alg1.10.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.10.m1.1.1.1.1.3.2.cmml" xref="alg1.10.m1.1.1.1.1.3.2">𝐶</ci><apply id="alg1.10.m1.1.1.1.1.3.3.cmml" xref="alg1.10.m1.1.1.1.1.3.3"><times id="alg1.10.m1.1.1.1.1.3.3.1.cmml" xref="alg1.10.m1.1.1.1.1.3.3.1"></times><ci id="alg1.10.m1.1.1.1.1.3.3.2.cmml" xref="alg1.10.m1.1.1.1.1.3.3.2">𝑖</ci><ci id="alg1.10.m1.1.1.1.1.3.3.3.cmml" xref="alg1.10.m1.1.1.1.1.3.3.3">𝑑</ci><ci id="alg1.10.m1.1.1.1.1.3.3.4.cmml" xref="alg1.10.m1.1.1.1.1.3.3.4">𝑥</ci></apply></apply></apply><apply id="alg1.10.m1.2.2.2.2.cmml" xref="alg1.10.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.10.m1.2.2.2.2.1.cmml" xref="alg1.10.m1.2.2.2.2">subscript</csymbol><ci id="alg1.10.m1.2.2.2.2.2.cmml" xref="alg1.10.m1.2.2.2.2.2">𝐷</ci><apply id="alg1.10.m1.2.2.2.2.3.cmml" xref="alg1.10.m1.2.2.2.2.3"><times id="alg1.10.m1.2.2.2.2.3.1.cmml" xref="alg1.10.m1.2.2.2.2.3.1"></times><ci id="alg1.10.m1.2.2.2.2.3.2.cmml" xref="alg1.10.m1.2.2.2.2.3.2">𝑡</ci><ci id="alg1.10.m1.2.2.2.2.3.3.cmml" xref="alg1.10.m1.2.2.2.2.3.3">𝑒</ci><ci id="alg1.10.m1.2.2.2.2.3.4.cmml" xref="alg1.10.m1.2.2.2.2.3.4">𝑠</ci><ci id="alg1.10.m1.2.2.2.2.3.5.cmml" xref="alg1.10.m1.2.2.2.2.3.5">𝑡</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m1.2c">W_{C_{idx}},D_{test}</annotation></semantics></math>)


</div>
</div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.31.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Test Procedure. <math id="alg1.19.m1.1" class="ltx_Math" alttext="w_{P}" display="inline"><semantics id="alg1.19.m1.1b"><msub id="alg1.19.m1.1.1" xref="alg1.19.m1.1.1.cmml"><mi id="alg1.19.m1.1.1.2" xref="alg1.19.m1.1.1.2.cmml">w</mi><mi id="alg1.19.m1.1.1.3" xref="alg1.19.m1.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.19.m1.1c"><apply id="alg1.19.m1.1.1.cmml" xref="alg1.19.m1.1.1"><csymbol cd="ambiguous" id="alg1.19.m1.1.1.1.cmml" xref="alg1.19.m1.1.1">subscript</csymbol><ci id="alg1.19.m1.1.1.2.cmml" xref="alg1.19.m1.1.1.2">𝑤</ci><ci id="alg1.19.m1.1.1.3.cmml" xref="alg1.19.m1.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.m1.1d">w_{P}</annotation></semantics></math> is a weight of after <math id="alg1.20.m2.1" class="ltx_Math" alttext="P" display="inline"><semantics id="alg1.20.m2.1b"><mi id="alg1.20.m2.1.1" xref="alg1.20.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.20.m2.1c"><ci id="alg1.20.m2.1.1.cmml" xref="alg1.20.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.m2.1d">P</annotation></semantics></math> rounds of global model communication on test dataset <math id="alg1.21.m3.1" class="ltx_Math" alttext="D_{test}" display="inline"><semantics id="alg1.21.m3.1b"><msub id="alg1.21.m3.1.1" xref="alg1.21.m3.1.1.cmml"><mi id="alg1.21.m3.1.1.2" xref="alg1.21.m3.1.1.2.cmml">D</mi><mrow id="alg1.21.m3.1.1.3" xref="alg1.21.m3.1.1.3.cmml"><mi id="alg1.21.m3.1.1.3.2" xref="alg1.21.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.21.m3.1.1.3.1" xref="alg1.21.m3.1.1.3.1.cmml">​</mo><mi id="alg1.21.m3.1.1.3.3" xref="alg1.21.m3.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.21.m3.1.1.3.1b" xref="alg1.21.m3.1.1.3.1.cmml">​</mo><mi id="alg1.21.m3.1.1.3.4" xref="alg1.21.m3.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.21.m3.1.1.3.1c" xref="alg1.21.m3.1.1.3.1.cmml">​</mo><mi id="alg1.21.m3.1.1.3.5" xref="alg1.21.m3.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.21.m3.1c"><apply id="alg1.21.m3.1.1.cmml" xref="alg1.21.m3.1.1"><csymbol cd="ambiguous" id="alg1.21.m3.1.1.1.cmml" xref="alg1.21.m3.1.1">subscript</csymbol><ci id="alg1.21.m3.1.1.2.cmml" xref="alg1.21.m3.1.1.2">𝐷</ci><apply id="alg1.21.m3.1.1.3.cmml" xref="alg1.21.m3.1.1.3"><times id="alg1.21.m3.1.1.3.1.cmml" xref="alg1.21.m3.1.1.3.1"></times><ci id="alg1.21.m3.1.1.3.2.cmml" xref="alg1.21.m3.1.1.3.2">𝑡</ci><ci id="alg1.21.m3.1.1.3.3.cmml" xref="alg1.21.m3.1.1.3.3">𝑒</ci><ci id="alg1.21.m3.1.1.3.4.cmml" xref="alg1.21.m3.1.1.3.4">𝑠</ci><ci id="alg1.21.m3.1.1.3.5.cmml" xref="alg1.21.m3.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.m3.1d">D_{test}</annotation></semantics></math>, <math id="alg1.22.m4.1" class="ltx_Math" alttext="\Delta W_{test}" display="inline"><semantics id="alg1.22.m4.1b"><mrow id="alg1.22.m4.1.1" xref="alg1.22.m4.1.1.cmml"><mi mathvariant="normal" id="alg1.22.m4.1.1.2" xref="alg1.22.m4.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.22.m4.1.1.1" xref="alg1.22.m4.1.1.1.cmml">​</mo><msub id="alg1.22.m4.1.1.3" xref="alg1.22.m4.1.1.3.cmml"><mi id="alg1.22.m4.1.1.3.2" xref="alg1.22.m4.1.1.3.2.cmml">W</mi><mrow id="alg1.22.m4.1.1.3.3" xref="alg1.22.m4.1.1.3.3.cmml"><mi id="alg1.22.m4.1.1.3.3.2" xref="alg1.22.m4.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.22.m4.1.1.3.3.1" xref="alg1.22.m4.1.1.3.3.1.cmml">​</mo><mi id="alg1.22.m4.1.1.3.3.3" xref="alg1.22.m4.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.22.m4.1.1.3.3.1b" xref="alg1.22.m4.1.1.3.3.1.cmml">​</mo><mi id="alg1.22.m4.1.1.3.3.4" xref="alg1.22.m4.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.22.m4.1.1.3.3.1c" xref="alg1.22.m4.1.1.3.3.1.cmml">​</mo><mi id="alg1.22.m4.1.1.3.3.5" xref="alg1.22.m4.1.1.3.3.5.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.22.m4.1c"><apply id="alg1.22.m4.1.1.cmml" xref="alg1.22.m4.1.1"><times id="alg1.22.m4.1.1.1.cmml" xref="alg1.22.m4.1.1.1"></times><ci id="alg1.22.m4.1.1.2.cmml" xref="alg1.22.m4.1.1.2">Δ</ci><apply id="alg1.22.m4.1.1.3.cmml" xref="alg1.22.m4.1.1.3"><csymbol cd="ambiguous" id="alg1.22.m4.1.1.3.1.cmml" xref="alg1.22.m4.1.1.3">subscript</csymbol><ci id="alg1.22.m4.1.1.3.2.cmml" xref="alg1.22.m4.1.1.3.2">𝑊</ci><apply id="alg1.22.m4.1.1.3.3.cmml" xref="alg1.22.m4.1.1.3.3"><times id="alg1.22.m4.1.1.3.3.1.cmml" xref="alg1.22.m4.1.1.3.3.1"></times><ci id="alg1.22.m4.1.1.3.3.2.cmml" xref="alg1.22.m4.1.1.3.3.2">𝑡</ci><ci id="alg1.22.m4.1.1.3.3.3.cmml" xref="alg1.22.m4.1.1.3.3.3">𝑒</ci><ci id="alg1.22.m4.1.1.3.3.4.cmml" xref="alg1.22.m4.1.1.3.3.4">𝑠</ci><ci id="alg1.22.m4.1.1.3.3.5.cmml" xref="alg1.22.m4.1.1.3.3.5">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.m4.1d">\Delta W_{test}</annotation></semantics></math> is a weight difference between the test globally trained model and the global model after post learning, <math id="alg1.23.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.23.m5.1b"><mi id="alg1.23.m5.1.1" xref="alg1.23.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.23.m5.1c"><ci id="alg1.23.m5.1.1.cmml" xref="alg1.23.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.m5.1d">K</annotation></semantics></math> is a number of clusters, <math id="alg1.24.m6.1" class="ltx_Math" alttext="C_{k}" display="inline"><semantics id="alg1.24.m6.1b"><msub id="alg1.24.m6.1.1" xref="alg1.24.m6.1.1.cmml"><mi id="alg1.24.m6.1.1.2" xref="alg1.24.m6.1.1.2.cmml">C</mi><mi id="alg1.24.m6.1.1.3" xref="alg1.24.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.24.m6.1c"><apply id="alg1.24.m6.1.1.cmml" xref="alg1.24.m6.1.1"><csymbol cd="ambiguous" id="alg1.24.m6.1.1.1.cmml" xref="alg1.24.m6.1.1">subscript</csymbol><ci id="alg1.24.m6.1.1.2.cmml" xref="alg1.24.m6.1.1.2">𝐶</ci><ci id="alg1.24.m6.1.1.3.cmml" xref="alg1.24.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.m6.1d">C_{k}</annotation></semantics></math> is a list of the weights of the cluster models, <math id="alg1.25.m7.1" class="ltx_Math" alttext="idx" display="inline"><semantics id="alg1.25.m7.1b"><mrow id="alg1.25.m7.1.1" xref="alg1.25.m7.1.1.cmml"><mi id="alg1.25.m7.1.1.2" xref="alg1.25.m7.1.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.25.m7.1.1.1" xref="alg1.25.m7.1.1.1.cmml">​</mo><mi id="alg1.25.m7.1.1.3" xref="alg1.25.m7.1.1.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.25.m7.1.1.1b" xref="alg1.25.m7.1.1.1.cmml">​</mo><mi id="alg1.25.m7.1.1.4" xref="alg1.25.m7.1.1.4.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.25.m7.1c"><apply id="alg1.25.m7.1.1.cmml" xref="alg1.25.m7.1.1"><times id="alg1.25.m7.1.1.1.cmml" xref="alg1.25.m7.1.1.1"></times><ci id="alg1.25.m7.1.1.2.cmml" xref="alg1.25.m7.1.1.2">𝑖</ci><ci id="alg1.25.m7.1.1.3.cmml" xref="alg1.25.m7.1.1.3">𝑑</ci><ci id="alg1.25.m7.1.1.4.cmml" xref="alg1.25.m7.1.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.m7.1d">idx</annotation></semantics></math> is an index of the nearest cluster, and <math id="alg1.26.m8.1" class="ltx_Math" alttext="W_{C_{idx}}" display="inline"><semantics id="alg1.26.m8.1b"><msub id="alg1.26.m8.1.1" xref="alg1.26.m8.1.1.cmml"><mi id="alg1.26.m8.1.1.2" xref="alg1.26.m8.1.1.2.cmml">W</mi><msub id="alg1.26.m8.1.1.3" xref="alg1.26.m8.1.1.3.cmml"><mi id="alg1.26.m8.1.1.3.2" xref="alg1.26.m8.1.1.3.2.cmml">C</mi><mrow id="alg1.26.m8.1.1.3.3" xref="alg1.26.m8.1.1.3.3.cmml"><mi id="alg1.26.m8.1.1.3.3.2" xref="alg1.26.m8.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.26.m8.1.1.3.3.1" xref="alg1.26.m8.1.1.3.3.1.cmml">​</mo><mi id="alg1.26.m8.1.1.3.3.3" xref="alg1.26.m8.1.1.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.26.m8.1.1.3.3.1b" xref="alg1.26.m8.1.1.3.3.1.cmml">​</mo><mi id="alg1.26.m8.1.1.3.3.4" xref="alg1.26.m8.1.1.3.3.4.cmml">x</mi></mrow></msub></msub><annotation-xml encoding="MathML-Content" id="alg1.26.m8.1c"><apply id="alg1.26.m8.1.1.cmml" xref="alg1.26.m8.1.1"><csymbol cd="ambiguous" id="alg1.26.m8.1.1.1.cmml" xref="alg1.26.m8.1.1">subscript</csymbol><ci id="alg1.26.m8.1.1.2.cmml" xref="alg1.26.m8.1.1.2">𝑊</ci><apply id="alg1.26.m8.1.1.3.cmml" xref="alg1.26.m8.1.1.3"><csymbol cd="ambiguous" id="alg1.26.m8.1.1.3.1.cmml" xref="alg1.26.m8.1.1.3">subscript</csymbol><ci id="alg1.26.m8.1.1.3.2.cmml" xref="alg1.26.m8.1.1.3.2">𝐶</ci><apply id="alg1.26.m8.1.1.3.3.cmml" xref="alg1.26.m8.1.1.3.3"><times id="alg1.26.m8.1.1.3.3.1.cmml" xref="alg1.26.m8.1.1.3.3.1"></times><ci id="alg1.26.m8.1.1.3.3.2.cmml" xref="alg1.26.m8.1.1.3.3.2">𝑖</ci><ci id="alg1.26.m8.1.1.3.3.3.cmml" xref="alg1.26.m8.1.1.3.3.3">𝑑</ci><ci id="alg1.26.m8.1.1.3.3.4.cmml" xref="alg1.26.m8.1.1.3.3.4">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.26.m8.1d">W_{C_{idx}}</annotation></semantics></math> is the weight of the nearest cluster model.</figcaption>
</figure>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS4.4.1.1" class="ltx_text">III-D</span> </span><span id="S3.SS4.5.2" class="ltx_text ltx_font_italic">Testing Procedure</span>
</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.5" class="ltx_p">To fully exploit the strengths of PFCM, we conduct our testing procedure framed as an introduction of new clients, presented in Algorithm <a href="#alg1" title="Algorithm 1 ‣ III-C Training Procedure ‣ III Personalized Federated Cluster Model ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. During the testing procedure, we create a queue of clients that did not participate in training. When a new client is introduced, the client is first given the updated global model from step 1 of the training procedure. The client trains this model for a pre-defined number of rounds and sends the weight updates to the server. The server computes <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\Delta W_{test}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">​</mo><msub id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml"><mi id="S3.SS4.p1.1.m1.1.1.3.2" xref="S3.SS4.p1.1.m1.1.1.3.2.cmml">W</mi><mrow id="S3.SS4.p1.1.m1.1.1.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS4.p1.1.m1.1.1.3.3.2" xref="S3.SS4.p1.1.m1.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.3.3.1" xref="S3.SS4.p1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.3.3.1a" xref="S3.SS4.p1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3.3.4" xref="S3.SS4.p1.1.m1.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.3.3.1b" xref="S3.SS4.p1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3.3.5" xref="S3.SS4.p1.1.m1.1.1.3.3.5.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><times id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1"></times><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">Δ</ci><apply id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.1.1.3.2">𝑊</ci><apply id="S3.SS4.p1.1.m1.1.1.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3"><times id="S3.SS4.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS4.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3.2">𝑡</ci><ci id="S3.SS4.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3.3">𝑒</ci><ci id="S3.SS4.p1.1.m1.1.1.3.3.4.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3.4">𝑠</ci><ci id="S3.SS4.p1.1.m1.1.1.3.3.5.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3.5">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\Delta W_{test}</annotation></semantics></math>, defined as the weights trained on the newly introduced client, and calculates the vector distance between the weights of each cluster model and <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="\Delta W_{test}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><mrow id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.cmml">​</mo><msub id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml"><mi id="S3.SS4.p1.2.m2.1.1.3.2" xref="S3.SS4.p1.2.m2.1.1.3.2.cmml">W</mi><mrow id="S3.SS4.p1.2.m2.1.1.3.3" xref="S3.SS4.p1.2.m2.1.1.3.3.cmml"><mi id="S3.SS4.p1.2.m2.1.1.3.3.2" xref="S3.SS4.p1.2.m2.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.3.1" xref="S3.SS4.p1.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.3.3" xref="S3.SS4.p1.2.m2.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.3.1a" xref="S3.SS4.p1.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.3.4" xref="S3.SS4.p1.2.m2.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.3.1b" xref="S3.SS4.p1.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.3.5" xref="S3.SS4.p1.2.m2.1.1.3.3.5.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><times id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1"></times><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">Δ</ci><apply id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.3.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.3.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2">𝑊</ci><apply id="S3.SS4.p1.2.m2.1.1.3.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3"><times id="S3.SS4.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3.1"></times><ci id="S3.SS4.p1.2.m2.1.1.3.3.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3.2">𝑡</ci><ci id="S3.SS4.p1.2.m2.1.1.3.3.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3.3">𝑒</ci><ci id="S3.SS4.p1.2.m2.1.1.3.3.4.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3.4">𝑠</ci><ci id="S3.SS4.p1.2.m2.1.1.3.3.5.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3.5">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">\Delta W_{test}</annotation></semantics></math> using the cosine similarity metric. Then the <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="idx" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mrow id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.3.m3.1.1.1" xref="S3.SS4.p1.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.3.m3.1.1.1a" xref="S3.SS4.p1.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS4.p1.3.m3.1.1.4" xref="S3.SS4.p1.3.m3.1.1.4.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><times id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1.1"></times><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">𝑖</ci><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝑑</ci><ci id="S3.SS4.p1.3.m3.1.1.4.cmml" xref="S3.SS4.p1.3.m3.1.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">idx</annotation></semantics></math> of the most similar cluster model will be found by comparing the cosine similarity between each cluster model’s weight and <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="\Delta W_{test}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><mrow id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.1.1" xref="S3.SS4.p1.4.m4.1.1.1.cmml">​</mo><msub id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml"><mi id="S3.SS4.p1.4.m4.1.1.3.2" xref="S3.SS4.p1.4.m4.1.1.3.2.cmml">W</mi><mrow id="S3.SS4.p1.4.m4.1.1.3.3" xref="S3.SS4.p1.4.m4.1.1.3.3.cmml"><mi id="S3.SS4.p1.4.m4.1.1.3.3.2" xref="S3.SS4.p1.4.m4.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.1.3.3.1" xref="S3.SS4.p1.4.m4.1.1.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.4.m4.1.1.3.3.3" xref="S3.SS4.p1.4.m4.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.1.3.3.1a" xref="S3.SS4.p1.4.m4.1.1.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.4.m4.1.1.3.3.4" xref="S3.SS4.p1.4.m4.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.1.3.3.1b" xref="S3.SS4.p1.4.m4.1.1.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.4.m4.1.1.3.3.5" xref="S3.SS4.p1.4.m4.1.1.3.3.5.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><times id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1"></times><ci id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2">Δ</ci><apply id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.3.1.cmml" xref="S3.SS4.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.3.2.cmml" xref="S3.SS4.p1.4.m4.1.1.3.2">𝑊</ci><apply id="S3.SS4.p1.4.m4.1.1.3.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3"><times id="S3.SS4.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3.1"></times><ci id="S3.SS4.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3.2">𝑡</ci><ci id="S3.SS4.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3.3">𝑒</ci><ci id="S3.SS4.p1.4.m4.1.1.3.3.4.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3.4">𝑠</ci><ci id="S3.SS4.p1.4.m4.1.1.3.3.5.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3.5">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">\Delta W_{test}</annotation></semantics></math>, as represented as <math id="S3.SS4.p1.5.m5.2" class="ltx_Math" alttext="FindNearestCluster(C_{k},\Delta W_{test})" display="inline"><semantics id="S3.SS4.p1.5.m5.2a"><mrow id="S3.SS4.p1.5.m5.2.2" xref="S3.SS4.p1.5.m5.2.2.cmml"><mi id="S3.SS4.p1.5.m5.2.2.4" xref="S3.SS4.p1.5.m5.2.2.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.5" xref="S3.SS4.p1.5.m5.2.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3a" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.6" xref="S3.SS4.p1.5.m5.2.2.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3b" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.7" xref="S3.SS4.p1.5.m5.2.2.7.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3c" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.8" xref="S3.SS4.p1.5.m5.2.2.8.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3d" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.9" xref="S3.SS4.p1.5.m5.2.2.9.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3e" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.10" xref="S3.SS4.p1.5.m5.2.2.10.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3f" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.11" xref="S3.SS4.p1.5.m5.2.2.11.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3g" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.12" xref="S3.SS4.p1.5.m5.2.2.12.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3h" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.13" xref="S3.SS4.p1.5.m5.2.2.13.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3i" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.14" xref="S3.SS4.p1.5.m5.2.2.14.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3j" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.15" xref="S3.SS4.p1.5.m5.2.2.15.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3k" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.16" xref="S3.SS4.p1.5.m5.2.2.16.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3l" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.17" xref="S3.SS4.p1.5.m5.2.2.17.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3m" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.18" xref="S3.SS4.p1.5.m5.2.2.18.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3n" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.19" xref="S3.SS4.p1.5.m5.2.2.19.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3o" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.20" xref="S3.SS4.p1.5.m5.2.2.20.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3p" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.21" xref="S3.SS4.p1.5.m5.2.2.21.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.3q" xref="S3.SS4.p1.5.m5.2.2.3.cmml">​</mo><mrow id="S3.SS4.p1.5.m5.2.2.2.2" xref="S3.SS4.p1.5.m5.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.p1.5.m5.2.2.2.2.3" xref="S3.SS4.p1.5.m5.2.2.2.3.cmml">(</mo><msub id="S3.SS4.p1.5.m5.1.1.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.2" xref="S3.SS4.p1.5.m5.1.1.1.1.1.2.cmml">C</mi><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.3" xref="S3.SS4.p1.5.m5.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS4.p1.5.m5.2.2.2.2.4" xref="S3.SS4.p1.5.m5.2.2.2.3.cmml">,</mo><mrow id="S3.SS4.p1.5.m5.2.2.2.2.2" xref="S3.SS4.p1.5.m5.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.SS4.p1.5.m5.2.2.2.2.2.2" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.2.2.2.1" xref="S3.SS4.p1.5.m5.2.2.2.2.2.1.cmml">​</mo><msub id="S3.SS4.p1.5.m5.2.2.2.2.2.3" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.cmml"><mi id="S3.SS4.p1.5.m5.2.2.2.2.2.3.2" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.2.cmml">W</mi><mrow id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.cmml"><mi id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.2" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.1" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.3" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.1a" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.4" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.1b" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.5" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.5.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S3.SS4.p1.5.m5.2.2.2.2.5" xref="S3.SS4.p1.5.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.2b"><apply id="S3.SS4.p1.5.m5.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2"><times id="S3.SS4.p1.5.m5.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2.3"></times><ci id="S3.SS4.p1.5.m5.2.2.4.cmml" xref="S3.SS4.p1.5.m5.2.2.4">𝐹</ci><ci id="S3.SS4.p1.5.m5.2.2.5.cmml" xref="S3.SS4.p1.5.m5.2.2.5">𝑖</ci><ci id="S3.SS4.p1.5.m5.2.2.6.cmml" xref="S3.SS4.p1.5.m5.2.2.6">𝑛</ci><ci id="S3.SS4.p1.5.m5.2.2.7.cmml" xref="S3.SS4.p1.5.m5.2.2.7">𝑑</ci><ci id="S3.SS4.p1.5.m5.2.2.8.cmml" xref="S3.SS4.p1.5.m5.2.2.8">𝑁</ci><ci id="S3.SS4.p1.5.m5.2.2.9.cmml" xref="S3.SS4.p1.5.m5.2.2.9">𝑒</ci><ci id="S3.SS4.p1.5.m5.2.2.10.cmml" xref="S3.SS4.p1.5.m5.2.2.10">𝑎</ci><ci id="S3.SS4.p1.5.m5.2.2.11.cmml" xref="S3.SS4.p1.5.m5.2.2.11">𝑟</ci><ci id="S3.SS4.p1.5.m5.2.2.12.cmml" xref="S3.SS4.p1.5.m5.2.2.12">𝑒</ci><ci id="S3.SS4.p1.5.m5.2.2.13.cmml" xref="S3.SS4.p1.5.m5.2.2.13">𝑠</ci><ci id="S3.SS4.p1.5.m5.2.2.14.cmml" xref="S3.SS4.p1.5.m5.2.2.14">𝑡</ci><ci id="S3.SS4.p1.5.m5.2.2.15.cmml" xref="S3.SS4.p1.5.m5.2.2.15">𝐶</ci><ci id="S3.SS4.p1.5.m5.2.2.16.cmml" xref="S3.SS4.p1.5.m5.2.2.16">𝑙</ci><ci id="S3.SS4.p1.5.m5.2.2.17.cmml" xref="S3.SS4.p1.5.m5.2.2.17">𝑢</ci><ci id="S3.SS4.p1.5.m5.2.2.18.cmml" xref="S3.SS4.p1.5.m5.2.2.18">𝑠</ci><ci id="S3.SS4.p1.5.m5.2.2.19.cmml" xref="S3.SS4.p1.5.m5.2.2.19">𝑡</ci><ci id="S3.SS4.p1.5.m5.2.2.20.cmml" xref="S3.SS4.p1.5.m5.2.2.20">𝑒</ci><ci id="S3.SS4.p1.5.m5.2.2.21.cmml" xref="S3.SS4.p1.5.m5.2.2.21">𝑟</ci><interval closure="open" id="S3.SS4.p1.5.m5.2.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2"><apply id="S3.SS4.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.2">𝐶</ci><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS4.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2"><times id="S3.SS4.p1.5.m5.2.2.2.2.2.1.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.1"></times><ci id="S3.SS4.p1.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2">Δ</ci><apply id="S3.SS4.p1.5.m5.2.2.2.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.2.2.2.2.2.3.1.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS4.p1.5.m5.2.2.2.2.2.3.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.2">𝑊</ci><apply id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3"><times id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.1.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.1"></times><ci id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.2">𝑡</ci><ci id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.3">𝑒</ci><ci id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.4.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.4">𝑠</ci><ci id="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.5.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.3.3.5">𝑡</ci></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.2c">FindNearestCluster(C_{k},\Delta W_{test})</annotation></semantics></math> in Algorithm <a href="#alg1" title="Algorithm 1 ‣ III-C Training Procedure ‣ III Personalized Federated Cluster Model ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Note that we avoid the double-dipping problem; the cluster model used to predict the testing data never sees the testing data. It is a one-time registration process into the PFCM framework wherein the client trains a model using its data and sends the weights of the model to the server. The server then sends the client a cluster model that has not seen the testing data. The client is given the most similar cluster model, with which the accuracy of its data is calculated. After distributing the most similar model to each client in the queue, the accuracy rates are averaged to produce the final test accuracy.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiment</span>
</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.4.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.5.2" class="ltx_text ltx_font_italic">Experiment Settings</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Our experiment is framed as a MDD severity classification task with three classes. We used a HRV dataset collected at the Department of Psychiatry at the Samsung Medical Center. There were 479 total samples, each represented by 100 subjects. We created a 80-20 training and testing set split based on the number of subjects.
In addition, we used a Convolutional Neural Network (CNN) model as our base model, shown in Figure <a href="#S4.F3" title="Figure 3 ‣ IV-A Experiment Settings ‣ IV Experiment ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, and used a self-developed FL framework based on the PyTorch library.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2108.01903/assets/hrv_cnn_model.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="181" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Convolutional Neural Network model for preprocessed HRV data.</figcaption>
</figure>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">To perform FL on our HRV dataset, we set the input values as <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="9\times 9" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mn id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">9</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><times id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></times><cn type="integer" id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">9</cn><cn type="integer" id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">9\times 9</annotation></semantics></math> matrices. This input was passed through two convolutional layers with 10 and 20 channels, respectively, followed by two fully-connected layers. We trained our initial global model for 50 epochs, using the Stochastic Gradient Descent (SGD) optimizer with a learning rate of 0.1 and a momentum of 0.5, and a the cross-entropy loss function. After creating cluster models using hierarchical clustering, we train each cluster for an additional 20 epochs with the same hyperparameters. The experiment was implemented with Pytorch 1.7.1 and Sklearn 0.24.2, on eight Intel Core i7-10700 processors. GPUs were not required, due to the small size of our dataset.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2108.01903/assets/acc.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="586" height="455" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>A comparison of accuracy between our work (PFCM), FedAvg, and ML frameworks (SVM-RFE and SVM)</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.4.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.5.2" class="ltx_text ltx_font_italic">Experiment Results</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In any classification task, it is important to first set a baseline performance by which our methods can be compared. We set our baseline performance to be the popular FedAvg algorithm. In addition, we report results of Support Vector Machine (SVM) and Support Vector Machine with Recursive Feature Elimination (SVM-RFE) method, as it is a method frequently used in related studies. Noted that for SVM and SVM-RFE, the models have access to the entirety of the data, disregarding privacy. Figure <a href="#S4.F4" title="Figure 4 ‣ IV-A Experiment Settings ‣ IV Experiment ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the accuracy rates on our HRV dataset. For SVM and SVM-RFE, we set the x-axis as the number of maximum iterations. We observed that SVM achieved a lackluster performance of 65.26%, with SVM-RFE showing an improved performance of 68.42%. In addition, the model trained on the FedAvg framework showed a stagnant performance of 70.53%. When our PFCM method was implemented at the end of round 50, marked by the dotted black line, the best performance was seen with an accuracy rate of 73.68%. Table <a href="#S4.T2" title="TABLE II ‣ IV-B Experiment Results ‣ IV Experiment ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> shows the result of our PFCM in terms of sensitivity and specificity, which are indicators of true positive and true negative rates. Sensitivity is 73.13% in <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">Normal</span> group, 63.16% in <span id="S4.SS2.p1.1.2" class="ltx_text ltx_font_italic">Mild depression</span> group, and 100.0% in <span id="S4.SS2.p1.1.3" class="ltx_text ltx_font_italic">Moderate-Severe depression</span> group, being more sensitive to classes of higher severity. Specificity is 100.0% in <span id="S4.SS2.p1.1.4" class="ltx_text ltx_font_italic">Normal</span> group, 96.05% in <span id="S4.SS2.p1.1.5" class="ltx_text ltx_font_italic">Mild depression</span> group, and 74.42% in <span id="S4.SS2.p1.1.6" class="ltx_text ltx_font_italic">Moderate-Severe depression</span> group. Overall, our PFCM method achieves better sensitivity and specificity performance compared to studies that analyzed depressive disorder via HRV and other biomarker data.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Sensitivity and Specificity using PFCM</figcaption>
<div id="S4.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:91.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(79.9pt,-18.7pt) scale(1.69409947278835,1.69409947278835) ;">
<table id="S4.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S4.T2.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Normal</th>
<th id="S4.T2.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Mild</th>
<th id="S4.T2.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Moderate-Severe</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.2.1" class="ltx_tr">
<th id="S4.T2.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Sensitivity</th>
<td id="S4.T2.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">73.13%</td>
<td id="S4.T2.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">63.16%</td>
<td id="S4.T2.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">100%</td>
</tr>
<tr id="S4.T2.1.1.3.2" class="ltx_tr">
<th id="S4.T2.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">Specificity</th>
<td id="S4.T2.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_b">100%</td>
<td id="S4.T2.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_b">96.05%</td>
<td id="S4.T2.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_b">74.42%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">To provide more context regarding the performance of our analysis model, we present our accuracy compared to the results presented in other studies, as shown in Table <a href="#S4.T3" title="TABLE III ‣ IV-B Experiment Results ‣ IV Experiment ‣ Personalized Federated Learning with Clustering: Non-IID Heart Rate Variability Data Application" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>. Our reported performance of 73.68% may seem lackluster compared to reported results of other studies, with some reporting accuracy rates of up to 87%. However, a key distinction is in the number of classes, as the listed studies are based on a 2-class classification task. By changing our task into a 2-class classification task, we also report an increased accuracy rate of 90.70%. This was the highest accuracy score compared to the results reported in other studies. We want to further the research of MDD analysis by beginning to create more detailed severity classes as opposed to the simple binary classification. Unlike physical illness, most areas of mental disorder, specific diagnosis of severity is more important than determining whether a disease is present.</p>
</div>
<figure id="S4.T3" class="ltx_table ltx_align_center">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Accuracy Comparison with other researches</figcaption>
<table id="S4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Research Paper</th>
<th id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Analysis Method</th>
<th id="S4.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Number of Classes</th>
<th id="S4.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.2.1" class="ltx_tr">
<td id="S4.T3.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite></td>
<td id="S4.T3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">SVM-RFE</td>
<td id="S4.T3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">2</td>
<td id="S4.T3.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">74.40%</td>
</tr>
<tr id="S4.T3.1.3.2" class="ltx_tr">
<td id="S4.T3.1.3.2.1" class="ltx_td ltx_align_left"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite></td>
<td id="S4.T3.1.3.2.2" class="ltx_td ltx_align_center">SVM-RFE</td>
<td id="S4.T3.1.3.2.3" class="ltx_td ltx_align_center">2</td>
<td id="S4.T3.1.3.2.4" class="ltx_td ltx_align_center">80.10%</td>
</tr>
<tr id="S4.T3.1.4.3" class="ltx_tr">
<td id="S4.T3.1.4.3.1" class="ltx_td ltx_align_left"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite></td>
<td id="S4.T3.1.4.3.2" class="ltx_td ltx_align_center">SVM+PCA</td>
<td id="S4.T3.1.4.3.3" class="ltx_td ltx_align_center">2</td>
<td id="S4.T3.1.4.3.4" class="ltx_td ltx_align_center">87.00%</td>
</tr>
<tr id="S4.T3.1.5.4" class="ltx_tr">
<td id="S4.T3.1.5.4.1" class="ltx_td ltx_align_left"><span id="S4.T3.1.5.4.1.1" class="ltx_text ltx_font_bold">PFCM</span></td>
<td id="S4.T3.1.5.4.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.4.2.1" class="ltx_text ltx_font_bold">CNN-based FL</span></td>
<td id="S4.T3.1.5.4.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.4.3.1" class="ltx_text ltx_font_bold">2</span></td>
<td id="S4.T3.1.5.4.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.4.4.1" class="ltx_text ltx_font_bold">90.70%</span></td>
</tr>
<tr id="S4.T3.1.6.5" class="ltx_tr">
<td id="S4.T3.1.6.5.1" class="ltx_td ltx_align_left ltx_border_b">PFCM</td>
<td id="S4.T3.1.6.5.2" class="ltx_td ltx_align_center ltx_border_b">CNN-based FL</td>
<td id="S4.T3.1.6.5.3" class="ltx_td ltx_align_center ltx_border_b">3</td>
<td id="S4.T3.1.6.5.4" class="ltx_td ltx_align_center ltx_border_b">73.68%</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Discussion</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Artificial Intelligence is continually spreading to many specific fields of healthcare with the increase of data quantity and quality, paired with developing computing power. There have been various attempts to find implicit and complex relations between variables that were once seen to have limited correlation. With MDD in particular, promising researches have been published regarding the increase in analysis performance using ML. Practical limitations of these methods, however, are data privacy laws that restrict the collection of healthcare data. Certain researches that have addressed the issue of privacy failed to show adequate results in realistic non-IID scenarios.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">Our research have shown that it is possible to successfully apply ML algorithms on privately distributed HRV data. PFCM shows a result of 78.76% and 90.16% for average sensitivity and specificity, respectively. This is an increased performance compared to the baseline method of FedAvg. This was a result of an improved performance when personalized models were distributed to each client. A root cause of the stagnant performance seen with FL is highly skewed data. Despite extended training, the model continued to predict that every input was of a normal subject. In a non-IID scenario, one in which the labels of the data of each client are heavily skewed, vanilla FedAvg algorithms creates a highly biased model. Given this type of imbalance, a common solution would be to re-sample or give higher weights to classes with less samples. However, this method is impossible to implement without access to data. By creating models with different biases solely based on local weight updates, and by implementing a clustering phase at the introduction of a new client, we can provide each client with a correctly biased model—a model that is biased towards the corresponding client’s data.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">In addition, PFCM showed higher accuracy compared to SVM and SVM-RFE, despite holding the assumption of accessible and centralized data. Though SVMs are a powerful tool, lower performance was observed as it was unable to make clear distinctions between <span id="S5.p3.1.1" class="ltx_text ltx_font_italic">Normal</span> and <span id="S5.p3.1.2" class="ltx_text ltx_font_italic">Mild</span> subjects. Owing to its ability to extract high-level features, the CNN-based approach made clearer distinctions between the severity classes, achieving higher performance. This is particularly important, as PFCM showed better performance while conforming to privacy regulations.</p>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.1" class="ltx_p">The significance of our PFCM method is apparent when compared to the results reported in other studies. Though other related studies report higher accuracy rates on a 2-class classification task, these are unfair comparisons to our research, as we report our accuracy rates on a 3-class classification task. However, if we change our dataset into a 2-class classification task, by combining the <span id="S5.p4.1.1" class="ltx_text ltx_font_italic">Normal</span> and <span id="S5.p4.1.2" class="ltx_text ltx_font_italic">Mild</span> classes, we report accuracy rates that are higher than previously reported studies. Not only does this demonstrate that our method shows superior performance, it also shows that the HRV of <span id="S5.p4.1.3" class="ltx_text ltx_font_italic">Normal</span> subjects are almost indistinguishable with <span id="S5.p4.1.4" class="ltx_text ltx_font_italic">Mild</span> subjects.</p>
</div>
<section id="S5.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_font_italic ltx_title_subsection">Limitations &amp; Future Works</h3>

<div id="S5.SSx1.p1" class="ltx_para">
<p id="S5.SSx1.p1.1" class="ltx_p">The main limitation to this study is the lack of data. Though it would have been optimal to separate our data into four classes based on the HAM-D metric, due to unavailability of data, we combined the categories of <span id="S5.SSx1.p1.1.1" class="ltx_text ltx_font_italic">Moderate</span> and <span id="S5.SSx1.p1.1.2" class="ltx_text ltx_font_italic">Severe</span>. Furthermore, we have trained our model to be more sensitive to higher levels of HAM-D. This resulted in a decreased sensitivity of normal subjects. For this framework to be adopted as a screening test in a practical healthcare setting, higher sensitivity of all classes are required. However, we believe these limitations can be solved with more data, especially for <span id="S5.SSx1.p1.1.3" class="ltx_text ltx_font_italic">Moderate</span> and <span id="S5.SSx1.p1.1.4" class="ltx_text ltx_font_italic">Severe</span> patients.</p>
</div>
<div id="S5.SSx1.p2" class="ltx_para">
<p id="S5.SSx1.p2.1" class="ltx_p">In future studies, we plan to conduct further clinical trials with Samsung Medical Center. This will allow collection and analysis of data containing more variables. In addition to data collection, we also plan to improve mental disorder diagnostic performance by exploring additional applications of ML techniques such as Recurrent Neural Network, Long-Short Term Memory, and Generative Adversarial Network in our analysis.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We have shown that even without a large and balanced HRV dataset, our Personalized Federated Cluster Model (PFCM) can accurately analyze the severity of a Major Depressive Disorder (MDD). In addition, we have shown that current Federated Learning methods can outperform other machine learning techniques through proper clustering of sufficiently similar clients. Lastly, unlike previous researches, our PFCM method provides a solution to apply ML techniques in strict data privacy environments. With a higher quantity and balance of data, we believe it may be viable to use PFCM to enable analysis of not only many problems in the field of healthcare, but also in many realistic FL environments.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">Acknowledgement</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work was partly supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2019-0-00421, Artificial Intelligence Graduate School Program(Sungkyunkwan University)), and Healthcare AI Convergence Research &amp; Development Program through the National IT Industry Promotion Agency of Korea (NIPA) funded by Ministry of Science and ICT (No. S1601-20-1041)</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Y.-W. Chen and L. C. Jain, “Deep learning in healthcare,” 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
I. Tobore, J. Li, L. Yuhang, Y. Al-Handarish, A. Kandwal, Z. Nie, and L. Wang,
“Deep learning intervention for health care challenges: Some biomedical
domain considerations,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">JMIR Mhealth Uhealth</em>, vol. 7, no. 8, p.
e11966, Aug 2019. [Online]. Available:
http://www.ncbi.nlm.nih.gov/pubmed/31376272

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
K. A. Houser and W. G. Voss, “Gdpr: The end of google and facebook or a new
paradigm in data privacy,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Rich. JL &amp; Tech.</em>, vol. 25, p. 1, 2018.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
R. Belmaker and G. Agam, “Major depressive disorder,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">New England
Journal of Medicine</em>, vol. 358, no. 1, pp. 55–68, 2008.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>.   PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. Konečnỳ, H. B. McMahan, F. X. Yu, P. Richtárik, A. T. Suresh,
and D. Bacon, “Federated learning: Strategies for improving communication
efficiency,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1610.05492</em>, 2016.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, A. Talwalkar, and V. Smith, “Federated learning:
Challenges, methods, and future directions,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing
Magazine</em>, vol. 37, no. 3, p. 50–60, May 2020. [Online]. Available:
http://dx.doi.org/10.1109/MSP.2020.2975749

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
F. Sattler, K.-R. Müller, and W. Samek, “Clustered federated learning:
Model-agnostic distributed multitask optimization under privacy
constraints,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning
Systems</em>, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
C. Briggs, Z. Fan, and P. Andras, “Federated learning with hierarchical
clustering of local updates to improve training on non-iid data,” 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
E. Y. Kim, M. Y. Lee, S. H. Kim, K. Ha, K. P. Kim, and Y. M. Ahn,
“Diagnosis of major depressive disorder by combining multimodal
information from heart rate dynamics and serum proteomics using
machine-learning algorithm,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Prog Neuropsychopharmacol Biol
Psychiatry</em>, vol. 76, pp. 65–71, 06 2017.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
S. Byun, A. Y. Kim, E. H. Jang, S. Kim, K. W. Choi, H. Y. Yu, and H. J. Jeon,
“Detection of major depressive disorder from linear and nonlinear heart rate
variability features during mental task protocol,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Computers in
biology and medicine</em>, vol. 112, p. 103381, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
M. Kobayashi, G. Sun, T. Shinba, T. Matsui, and T. Kirimoto,
“Development of a mental disorder screening system using support vector
machine for classification of heart rate variability measured from
single-lead electrocardiography,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">2019 IEEE Sensors Applications
Symposium (SAS)</em>, 2019, pp. 1–6.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
P. Chhikara, P. Singh, R. Tekchandani, N. Kumar, and M. Guizani,
“Federated learning meets human emotions: A decentralized framework for
human-computer interaction for iot applications,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of
Things Journal</em>, pp. 1–1, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
B. Cao, L. Zheng, C. Zhang, P. S. Yu, A. Piscitello, J. Zulueta, O. Ajilore,
K. Ryan, and A. D. Leow, “Deepmood: Modeling mobile phone typing dynamics
for mood detection,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 23rd ACM SIGKDD
International Conference on Knowledge Discovery and Data Mining</em>, ser. KDD
’17.   New York, NY, USA: Association
for Computing Machinery, 2017, p. 747–755. [Online]. Available:
https://doi.org/10.1145/3097983.3098086

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
X. Xu, H. Peng, L. Sun, M. Z. A. Bhuiyan, L. Liu, and L. He,
“Privacy-preserving federated depression detection from multi-source mobile
health data,” 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
M. Hamilton, “A rating scale for depression,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Journal of neurology,
neurosurgery, and psychiatry</em>, vol. 23, no. 1, p. 56, 1960.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2108.01902" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2108.01903" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2108.01903">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2108.01903" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2108.01904" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  2 04:18:54 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
