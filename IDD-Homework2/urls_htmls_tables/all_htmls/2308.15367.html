<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2308.15367] Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation</title><meta property="og:description" content="Federated learning (FL) emerges as a decentralized learning framework which trains models from multiple distributed clients without sharing their data to preserve privacy. Recently, large-scale pre-trained models (e.g.â€¦">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2308.15367">

<!--Generated on Wed Feb 28 09:51:36 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Efficient Model Personalization in Federated Learning 
<br class="ltx_break">via Client-Specific Prompt Generation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Fu-En Yang<sup id="id6.6.id1" class="ltx_sup"><span id="id6.6.id1.1" class="ltx_text ltx_font_italic">1,2</span></sup> â€ƒâ€ƒChien-Yi Wang<sup id="id7.7.id2" class="ltx_sup"><span id="id7.7.id2.1" class="ltx_text ltx_font_italic">2</span></sup> â€ƒâ€ƒYu-Chiang Frank Wang<sup id="id8.8.id3" class="ltx_sup"><span id="id8.8.id3.1" class="ltx_text ltx_font_italic">1,2</span></sup> 
<br class="ltx_break"><sup id="id9.9.id4" class="ltx_sup"><span id="id9.9.id4.1" class="ltx_text ltx_font_italic">1</span></sup>National Taiwan University â€ƒâ€ƒ<sup id="id10.10.id5" class="ltx_sup"><span id="id10.10.id5.1" class="ltx_text ltx_font_italic">2</span></sup>NVIDIA
<br class="ltx_break"><span id="id11.11.id6" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{f07942077, ycwang}@ntu.edu.tw, chienyiw@nvidia.com</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id12.id1" class="ltx_p">Federated learning (FL) emerges as a decentralized learning framework which trains models from multiple distributed clients without sharing their data to preserve privacy. Recently, large-scale pre-trained models (e.g., Vision Transformer) have shown a strong capability of deriving robust representations. However, the data heterogeneity among clients, the limited computation resources, and the communication bandwidth restrict the deployment of large-scale models in FL frameworks. To leverage robust representations from large-scale models while enabling efficient model personalization for heterogeneous clients, we propose a novel personalized FL framework of client-specific Prompt Generation (pFedPG), which learns to deploy a personalized prompt generator at the server for producing client-specific visual prompts that efficiently adapts frozen backbones to local data distributions. Our proposed framework jointly optimizes the stages of personalized prompt adaptation locally and personalized prompt generation globally. The former aims to train visual prompts that adapt foundation models to each client, while the latter observes local optimization directions to generate personalized prompts for all clients. Through extensive experiments on benchmark datasets, we show that our pFedPG is favorable against state-of-the-art personalized FL methods under various types of data heterogeneity, allowing computation and communication efficient model personalization.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">With access to web-scale training data (<span id="S1.p1.1.1" class="ltx_text ltx_font_italic">e.g.,</span> LAION-5BÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>), deep learning has demonstrated remarkable achievements across computer visionÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> and natural language understandingÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>.
However, in real-world scenarios, user data is typically scattered across various domains, such as hospital sites or edge devices. Due to increasing risks of privacy breaches and stricter privacy protection regulationsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, centralized learning schemes are not preferable.
With the aim of collaboratively training models without exposing usersâ€™ private data, Federated learning (FL) has emerged as a prominent distributed learning framework and has garnered growing research interest. This privacy-preserving learning paradigm has been widely adopted in applications like medical image diagnosisÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, face recognitionÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, and person re-identificationÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2308.15367/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="211" height="185" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Comparison between (a) FedAvg and (b) our approach. Instead of updating and transporting entire models <math id="S1.F1.4.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S1.F1.4.m1.1b"><mi id="S1.F1.4.m1.1.1" xref="S1.F1.4.m1.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S1.F1.4.m1.1c"><ci id="S1.F1.4.m1.1.1.cmml" xref="S1.F1.4.m1.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.4.m1.1d">\theta</annotation></semantics></math>, our FL method learns to generate personalized prompts <span id="S1.F1.8.1" class="ltx_text ltx_markedasmath ltx_font_bold">P</span> by implicitly observing local optimization directions <math id="S1.F1.6.m3.1" class="ltx_Math" alttext="\Delta\textbf{P}=\widetilde{\textbf{P}}-\textbf{P}" display="inline"><semantics id="S1.F1.6.m3.1b"><mrow id="S1.F1.6.m3.1.1" xref="S1.F1.6.m3.1.1.cmml"><mrow id="S1.F1.6.m3.1.1.2" xref="S1.F1.6.m3.1.1.2.cmml"><mi mathvariant="normal" id="S1.F1.6.m3.1.1.2.2" xref="S1.F1.6.m3.1.1.2.2.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="S1.F1.6.m3.1.1.2.1" xref="S1.F1.6.m3.1.1.2.1.cmml">â€‹</mo><mtext class="ltx_mathvariant_bold" id="S1.F1.6.m3.1.1.2.3" xref="S1.F1.6.m3.1.1.2.3a.cmml">P</mtext></mrow><mo id="S1.F1.6.m3.1.1.1" xref="S1.F1.6.m3.1.1.1.cmml">=</mo><mrow id="S1.F1.6.m3.1.1.3" xref="S1.F1.6.m3.1.1.3.cmml"><mover accent="true" id="S1.F1.6.m3.1.1.3.2" xref="S1.F1.6.m3.1.1.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S1.F1.6.m3.1.1.3.2.2" xref="S1.F1.6.m3.1.1.3.2.2a.cmml">P</mtext><mo id="S1.F1.6.m3.1.1.3.2.1" xref="S1.F1.6.m3.1.1.3.2.1.cmml">~</mo></mover><mo id="S1.F1.6.m3.1.1.3.1" xref="S1.F1.6.m3.1.1.3.1.cmml">âˆ’</mo><mtext class="ltx_mathvariant_bold" id="S1.F1.6.m3.1.1.3.3" xref="S1.F1.6.m3.1.1.3.3a.cmml">P</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.6.m3.1c"><apply id="S1.F1.6.m3.1.1.cmml" xref="S1.F1.6.m3.1.1"><eq id="S1.F1.6.m3.1.1.1.cmml" xref="S1.F1.6.m3.1.1.1"></eq><apply id="S1.F1.6.m3.1.1.2.cmml" xref="S1.F1.6.m3.1.1.2"><times id="S1.F1.6.m3.1.1.2.1.cmml" xref="S1.F1.6.m3.1.1.2.1"></times><ci id="S1.F1.6.m3.1.1.2.2.cmml" xref="S1.F1.6.m3.1.1.2.2">Î”</ci><ci id="S1.F1.6.m3.1.1.2.3a.cmml" xref="S1.F1.6.m3.1.1.2.3"><mtext class="ltx_mathvariant_bold" id="S1.F1.6.m3.1.1.2.3.cmml" xref="S1.F1.6.m3.1.1.2.3">P</mtext></ci></apply><apply id="S1.F1.6.m3.1.1.3.cmml" xref="S1.F1.6.m3.1.1.3"><minus id="S1.F1.6.m3.1.1.3.1.cmml" xref="S1.F1.6.m3.1.1.3.1"></minus><apply id="S1.F1.6.m3.1.1.3.2.cmml" xref="S1.F1.6.m3.1.1.3.2"><ci id="S1.F1.6.m3.1.1.3.2.1.cmml" xref="S1.F1.6.m3.1.1.3.2.1">~</ci><ci id="S1.F1.6.m3.1.1.3.2.2a.cmml" xref="S1.F1.6.m3.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S1.F1.6.m3.1.1.3.2.2.cmml" xref="S1.F1.6.m3.1.1.3.2.2">P</mtext></ci></apply><ci id="S1.F1.6.m3.1.1.3.3a.cmml" xref="S1.F1.6.m3.1.1.3.3"><mtext class="ltx_mathvariant_bold" id="S1.F1.6.m3.1.1.3.3.cmml" xref="S1.F1.6.m3.1.1.3.3">P</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m3.1d">\Delta\textbf{P}=\widetilde{\textbf{P}}-\textbf{P}</annotation></semantics></math> for efficient model personalization on top of frozen foundation models.
</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Without the need of data sharing among clients, the mainstream FL approach of FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> learns a global model by averaging model parameters trained on clientsâ€™ private data.
However, data distributed in each client might be <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">heterogeneous</em> in terms of <em id="S1.p2.1.2" class="ltx_emph ltx_font_italic">domain discrepancy</em>Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> or <em id="S1.p2.1.3" class="ltx_emph ltx_font_italic">imbalanced class distribution</em>Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. Sharing a global model across heterogeneous data clients is prone to highly deviate from their local distribution, leading to severe performance degradationÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>.
Previous FL worksÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> propose types of constraints (<span id="S1.p2.1.4" class="ltx_text ltx_font_italic">e.g.,</span> <math id="S1.p2.1.m1.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S1.p2.1.m1.1a"><msub id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml"><mi id="S1.p2.1.m1.1.1.2" xref="S1.p2.1.m1.1.1.2.cmml">L</mi><mn id="S1.p2.1.m1.1.1.3" xref="S1.p2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><apply id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p2.1.m1.1.1.1.cmml" xref="S1.p2.1.m1.1.1">subscript</csymbol><ci id="S1.p2.1.m1.1.1.2.cmml" xref="S1.p2.1.m1.1.1.2">ğ¿</ci><cn type="integer" id="S1.p2.1.m1.1.1.3.cmml" xref="S1.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">L_{2}</annotation></semantics></math>Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> or contrastive regularizationÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>) to prevent the local training to be divergent from each other.
To better handle the inevitable data heterogeneity across clients, personalized federated learning (pFL) methodsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> are instead proposed to allow each client to train a personalized model that adapts to their own data distribution.
For example, pFedHNÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> introduces a hypernetwork at the server to directly generate model parameters for each client, whereas pFedLAÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> learns a layer-wise model aggregation policy to assign different weights for personalized model aggregation.
While the above pFL approaches are desirable for handling heterogeneous data, they are typically restricted to small backbone architectures (<span id="S1.p2.1.5" class="ltx_text ltx_font_italic">e.g.,</span> LeNetÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>) due to the high complexity of outputting model parametersÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> or aggregation weightsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> for large-scale models. Consequently, the capability of derived features is limited, leading to a lack of performance improvement and training instability.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Recently, training from large foundation modelsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> for downstream tasks has become a prominent paradigm in centralized learning. To leverage the strong representations derived by foundation models for alleviating data heterogeneity, ViT-FLÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> incorporates pre-trained Vision Transformer (ViT)Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> into standard FL algorithms (<span id="S1.p3.1.1" class="ltx_text ltx_font_italic">e.g.,</span> FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>) and shows improved robustness and stability on heterogeneously distributed data.
However, the use of large pre-trained models for all clients in existing FL algorithms can cause extensive computational and communication burdens, as these methods require transporting entire model parameters between clients and the server. Additionally, overfitting issues might occur when large-scale models are trained with relatively limited client data.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">For efficiently tuning large-scale models, prompt learningÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite> provides a flexible way to adapt pre-trained models to downstream tasks by solely training the additional inserted trainable parameters (<span id="S1.p4.1.1" class="ltx_text ltx_font_italic">i.e.,</span> prompts). For instance, VPTÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> treats prompts as task-specific parameters and prepends them to the input tokens of a pre-trained ViT. In this way, prompts could be optimized to capture task-specific information while instructing a frozen model to perform tasks of interest.
However, a straightforward way to adopt prompt learning into FL, <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">i.e.,</span> simply averaging prompts learned from all clients, cannot address data heterogeneity among clients effectively and often leads to unsatisfactory performance (as evident in TablesÂ <a href="#S3.T1" title="Table 1 â€£ Learning of personalized prompt generation â€£ 3.2.2 Personalized prompt generation at the server â€£ 3.2 Efficient Model Personalization in FL via Client-Specific Prompt Generation â€£ 3 Proposed Method â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-<a href="#S4.T3" title="Table 3 â€£ 4.2 Quantitative Evaluation â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). Therefore, there is a crucial challenge to develop new FL methods that can leverage prompt learning effectively while handling data heterogeneity among clients.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this paper, we aim at achieving efficient model personalization among clients with data heterogeneity. As depicted in Fig.Â <a href="#S1.F1" title="Figure 1 â€£ 1 Introduction â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, different from conventional FL methods (<span id="S1.p5.1.1" class="ltx_text ltx_font_italic">e.g.,</span> FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>) that updates and transports entire model parameters, we propose a novel personalized FL scheme of <em id="S1.p5.1.2" class="ltx_emph ltx_font_italic">client-specific Prompt Generation (pFedPG)</em> that exploits underlying client-specific characteristics to produce personalized prompts for each client, which enables efficient adaptation to local data distribution.
To be more precise, each client trains the client-specific prompts to instruct a model to perform recognition tasks on the target client using its private data. As the local training is not required to update entire large models, the computation overload could be minimized while the possible overfitting issues are mitigated accordingly.
On the other hand, we employ a personalized prompt generation module on the server side, which is learned to obtain the underlying optimization directions among clients. With such client characteristics implicitly observed, we are capable of producing personalized prompts to facilitate efficient adaptation for each client with heterogeneous data distribution.
By iteratively training the above two stages in a mutually beneficial manner, we are capable of achieving effective yet efficient model personalization on top of the robust representations derived from large-scale foundation models.
</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">We now summarize the contributions of this work below:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a personalized FL framework of client-specific Prompt Generation (pFedPG), which alternates between <span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_italic">personalized prompt generation</span> and <span id="S1.I1.i1.p1.1.2" class="ltx_text ltx_font_italic">personalized prompt adaptation</span> to enable efficient model personalization under heterogeneous data.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We design a client-specific prompt generator at the server, which effectively exploits personalized optimization directions and produces client-specific prompts for updating each client model.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Evaluations on several benchmark datasets in domain discrepancy and imbalanced class distribution verify that our method performs favorably against existing personalized FL approaches and exhibits sufficient training efficiency.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Federated Learning (FL)</h5>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">Federated Learning is a learning framework in machine learning with the goal of training models from distributed data sources while protecting data privacy. The most widely recognized approach for federated learning is FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, which partitions the learning process into local training and global averaging.
However, data distributed in real-world scenarios are typically non-IID, indicating the presence of domain discrepancy or imbalanced class distribution among clients. Directly averaging models trained on heterogeneous data can lead to severe performance degradation and training instability.
To address this challenge, several methodsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> have been proposed to regularize local training in FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. For instance, FedProxÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> and SCAFFOLDÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> restrict the local update to be consistent by <math id="S2.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><msub id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">L</mi><mn id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2">ğ¿</ci><cn type="integer" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">L_{2}</annotation></semantics></math> distance over model weights and variance reduction technique over gradients, respectively. MOONÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> applies a contrastive objective to regularize the optimization of local models, ensuring that they do not deviate significantly from the global model.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Personalized Federated Learning (pFL)</h5>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">Instead of constructing a global model shared among all clients, personalized FL algorithmsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> are proposed to address data heterogeneity issues by learning customized models at each client.
Several worksÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> achieve model personalization by only aggregating parts of a model (<span id="S2.SS0.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_italic">e.g.,</span> feature extractor) at the server while keeping or learning additional modules (<span id="S2.SS0.SSS0.Px2.p1.1.2" class="ltx_text ltx_font_italic">e.g.,</span> classifier) locally.
Per-FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> analogizes the local training and server aggregation processes as inner and outer loops optimization in model-agnostic meta-learningÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, facilitating local model adaptation from the global model initialization.
PartialFedÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> and FedALAÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> derive customized models by adaptively aggregating the global and local models. Similarly, pFedLAÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> learns a layer-wise aggregation policy to construct a personalized model by assigning larger weights to clients with higher similarities.
Some recent worksÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> achieve model personalization by either learning sparse models or applying adapter layers.
Instead of employing average-based aggregation at the server, pFedHNÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> directly generates model parameters for all clients. However, its applicability is limited to small and shallow models (<span id="S2.SS0.SSS0.Px2.p1.1.3" class="ltx_text ltx_font_italic">e.g.,</span> LeNetÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>) due to the high complexity of the model parameter space.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2308.15367/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="449" height="182" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of our client-specific Prompt Generation (pFedPG) framework. pFedPG learns a prompt generator <math id="S2.F2.7.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S2.F2.7.m1.1b"><mi id="S2.F2.7.m1.1.1" xref="S2.F2.7.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S2.F2.7.m1.1c"><ci id="S2.F2.7.m1.1.1.cmml" xref="S2.F2.7.m1.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.7.m1.1d">G</annotation></semantics></math> together with client-agnostic prompt basis <math id="S2.F2.8.m2.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S2.F2.8.m2.1b"><msub id="S2.F2.8.m2.1.1" xref="S2.F2.8.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.F2.8.m2.1.1.2" xref="S2.F2.8.m2.1.1.2a.cmml">P</mtext><mrow id="S2.F2.8.m2.1.1.3" xref="S2.F2.8.m2.1.1.3.cmml"><mi id="S2.F2.8.m2.1.1.3.2" xref="S2.F2.8.m2.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S2.F2.8.m2.1.1.3.1" xref="S2.F2.8.m2.1.1.3.1.cmml">â€‹</mo><mi id="S2.F2.8.m2.1.1.3.3" xref="S2.F2.8.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.F2.8.m2.1.1.3.1b" xref="S2.F2.8.m2.1.1.3.1.cmml">â€‹</mo><mi id="S2.F2.8.m2.1.1.3.4" xref="S2.F2.8.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F2.8.m2.1.1.3.1c" xref="S2.F2.8.m2.1.1.3.1.cmml">â€‹</mo><mi id="S2.F2.8.m2.1.1.3.5" xref="S2.F2.8.m2.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.F2.8.m2.1c"><apply id="S2.F2.8.m2.1.1.cmml" xref="S2.F2.8.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.8.m2.1.1.1.cmml" xref="S2.F2.8.m2.1.1">subscript</csymbol><ci id="S2.F2.8.m2.1.1.2a.cmml" xref="S2.F2.8.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.F2.8.m2.1.1.2.cmml" xref="S2.F2.8.m2.1.1.2">P</mtext></ci><apply id="S2.F2.8.m2.1.1.3.cmml" xref="S2.F2.8.m2.1.1.3"><times id="S2.F2.8.m2.1.1.3.1.cmml" xref="S2.F2.8.m2.1.1.3.1"></times><ci id="S2.F2.8.m2.1.1.3.2.cmml" xref="S2.F2.8.m2.1.1.3.2">ğ‘</ci><ci id="S2.F2.8.m2.1.1.3.3.cmml" xref="S2.F2.8.m2.1.1.3.3">ğ‘</ci><ci id="S2.F2.8.m2.1.1.3.4.cmml" xref="S2.F2.8.m2.1.1.3.4">ğ‘ </ci><ci id="S2.F2.8.m2.1.1.3.5.cmml" xref="S2.F2.8.m2.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.m2.1d">\textbf{P}_{base}</annotation></semantics></math> and a bank of client descriptors <math id="S2.F2.9.m3.1" class="ltx_Math" alttext="D=\{d_{n}\}_{n=1}^{N}" display="inline"><semantics id="S2.F2.9.m3.1b"><mrow id="S2.F2.9.m3.1.1" xref="S2.F2.9.m3.1.1.cmml"><mi id="S2.F2.9.m3.1.1.3" xref="S2.F2.9.m3.1.1.3.cmml">D</mi><mo id="S2.F2.9.m3.1.1.2" xref="S2.F2.9.m3.1.1.2.cmml">=</mo><msubsup id="S2.F2.9.m3.1.1.1" xref="S2.F2.9.m3.1.1.1.cmml"><mrow id="S2.F2.9.m3.1.1.1.1.1.1" xref="S2.F2.9.m3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.F2.9.m3.1.1.1.1.1.1.2" xref="S2.F2.9.m3.1.1.1.1.1.2.cmml">{</mo><msub id="S2.F2.9.m3.1.1.1.1.1.1.1" xref="S2.F2.9.m3.1.1.1.1.1.1.1.cmml"><mi id="S2.F2.9.m3.1.1.1.1.1.1.1.2" xref="S2.F2.9.m3.1.1.1.1.1.1.1.2.cmml">d</mi><mi id="S2.F2.9.m3.1.1.1.1.1.1.1.3" xref="S2.F2.9.m3.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S2.F2.9.m3.1.1.1.1.1.1.3" xref="S2.F2.9.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.F2.9.m3.1.1.1.1.3" xref="S2.F2.9.m3.1.1.1.1.3.cmml"><mi id="S2.F2.9.m3.1.1.1.1.3.2" xref="S2.F2.9.m3.1.1.1.1.3.2.cmml">n</mi><mo id="S2.F2.9.m3.1.1.1.1.3.1" xref="S2.F2.9.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S2.F2.9.m3.1.1.1.1.3.3" xref="S2.F2.9.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.F2.9.m3.1.1.1.3" xref="S2.F2.9.m3.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.9.m3.1c"><apply id="S2.F2.9.m3.1.1.cmml" xref="S2.F2.9.m3.1.1"><eq id="S2.F2.9.m3.1.1.2.cmml" xref="S2.F2.9.m3.1.1.2"></eq><ci id="S2.F2.9.m3.1.1.3.cmml" xref="S2.F2.9.m3.1.1.3">ğ·</ci><apply id="S2.F2.9.m3.1.1.1.cmml" xref="S2.F2.9.m3.1.1.1"><csymbol cd="ambiguous" id="S2.F2.9.m3.1.1.1.2.cmml" xref="S2.F2.9.m3.1.1.1">superscript</csymbol><apply id="S2.F2.9.m3.1.1.1.1.cmml" xref="S2.F2.9.m3.1.1.1"><csymbol cd="ambiguous" id="S2.F2.9.m3.1.1.1.1.2.cmml" xref="S2.F2.9.m3.1.1.1">subscript</csymbol><set id="S2.F2.9.m3.1.1.1.1.1.2.cmml" xref="S2.F2.9.m3.1.1.1.1.1.1"><apply id="S2.F2.9.m3.1.1.1.1.1.1.1.cmml" xref="S2.F2.9.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.F2.9.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.F2.9.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.F2.9.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.F2.9.m3.1.1.1.1.1.1.1.2">ğ‘‘</ci><ci id="S2.F2.9.m3.1.1.1.1.1.1.1.3.cmml" xref="S2.F2.9.m3.1.1.1.1.1.1.1.3">ğ‘›</ci></apply></set><apply id="S2.F2.9.m3.1.1.1.1.3.cmml" xref="S2.F2.9.m3.1.1.1.1.3"><eq id="S2.F2.9.m3.1.1.1.1.3.1.cmml" xref="S2.F2.9.m3.1.1.1.1.3.1"></eq><ci id="S2.F2.9.m3.1.1.1.1.3.2.cmml" xref="S2.F2.9.m3.1.1.1.1.3.2">ğ‘›</ci><cn type="integer" id="S2.F2.9.m3.1.1.1.1.3.3.cmml" xref="S2.F2.9.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.F2.9.m3.1.1.1.3.cmml" xref="S2.F2.9.m3.1.1.1.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.9.m3.1d">D=\{d_{n}\}_{n=1}^{N}</annotation></semantics></math> at the server. With local classification loss observed, both client-specific prompts <math id="S2.F2.10.m4.1" class="ltx_Math" alttext="\mathtt{\textbf{P}}_{n}" display="inline"><semantics id="S2.F2.10.m4.1b"><msub id="S2.F2.10.m4.1.1" xref="S2.F2.10.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.F2.10.m4.1.1.2" xref="S2.F2.10.m4.1.1.2a.cmml">P</mtext><mi id="S2.F2.10.m4.1.1.3" xref="S2.F2.10.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.10.m4.1c"><apply id="S2.F2.10.m4.1.1.cmml" xref="S2.F2.10.m4.1.1"><csymbol cd="ambiguous" id="S2.F2.10.m4.1.1.1.cmml" xref="S2.F2.10.m4.1.1">subscript</csymbol><ci id="S2.F2.10.m4.1.1.2a.cmml" xref="S2.F2.10.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.F2.10.m4.1.1.2.cmml" xref="S2.F2.10.m4.1.1.2">P</mtext></ci><ci id="S2.F2.10.m4.1.1.3.cmml" xref="S2.F2.10.m4.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.10.m4.1d">\mathtt{\textbf{P}}_{n}</annotation></semantics></math> and local classification head <math id="S2.F2.11.m5.1" class="ltx_Math" alttext="H_{n}" display="inline"><semantics id="S2.F2.11.m5.1b"><msub id="S2.F2.11.m5.1.1" xref="S2.F2.11.m5.1.1.cmml"><mi id="S2.F2.11.m5.1.1.2" xref="S2.F2.11.m5.1.1.2.cmml">H</mi><mi id="S2.F2.11.m5.1.1.3" xref="S2.F2.11.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.11.m5.1c"><apply id="S2.F2.11.m5.1.1.cmml" xref="S2.F2.11.m5.1.1"><csymbol cd="ambiguous" id="S2.F2.11.m5.1.1.1.cmml" xref="S2.F2.11.m5.1.1">subscript</csymbol><ci id="S2.F2.11.m5.1.1.2.cmml" xref="S2.F2.11.m5.1.1.2">ğ»</ci><ci id="S2.F2.11.m5.1.1.3.cmml" xref="S2.F2.11.m5.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.11.m5.1d">H_{n}</annotation></semantics></math> are updated at each client <math id="S2.F2.12.m6.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.F2.12.m6.1b"><mi id="S2.F2.12.m6.1.1" xref="S2.F2.12.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.F2.12.m6.1c"><ci id="S2.F2.12.m6.1.1.cmml" xref="S2.F2.12.m6.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.12.m6.1d">n</annotation></semantics></math>. We alternate between the stages of (a) <span id="S2.F2.15.1" class="ltx_text ltx_font_italic">personalized prompt adaptation</span> and (b) <span id="S2.F2.16.2" class="ltx_text ltx_font_italic">personalized prompt generation</span> to enable efficient personalization of foundation models like ViT.
</figcaption>
</figure>
</section>
<section id="S2.SS0.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Foundation Models and Prompt Learning</h5>

<div id="S2.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px3.p1.1" class="ltx_p">Leveraging publicly available pre-trained foundation modelsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> to downstream tasks has emerged as a prominent scheme in centralized learning. In particular, TransformerÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> architectures have demonstrated exceptional ability in deriving robust and discriminative representations. In the FL community, some worksÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> start to investigate the effectiveness of leveraging foundation models into the FL framework.
For instance, ViT-FLÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> first incorporates the pre-trained Vision Transformer (ViT)Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> architecture into FL and shows improved model performance and training stability.
However, most FL algorithms typically require updating <span id="S2.SS0.SSS0.Px3.p1.1.1" class="ltx_text ltx_font_italic">entire</span> model, making the adoption of foundation models challenging in real-world FL scenarios (<span id="S2.SS0.SSS0.Px3.p1.1.2" class="ltx_text ltx_font_italic">e.g.,</span> edge devices or medical sites) due to limited computation/communication resources.</p>
</div>
<div id="S2.SS0.SSS0.Px3.p2" class="ltx_para">
<p id="S2.SS0.SSS0.Px3.p2.1" class="ltx_p">Prompt learning techniquesÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> have been widely used in the NLP community for adapting language models to downstream tasks effectively via only optimizing a small amount of continuous task-specific prompt vectors. Recently, Visual Prompt Tuning (VPT)Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> has also been proposed as an efficient and effective alternative to fully fine-tuning the large-scale ViT model. It introduces additional learnable prompts into the input image embedding space. These prompts act as task-specific parameters, adapting the frozen backbone model to perform downstream tasks.
Very recently, several concurrent worksÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> choose to insert prompts to a frozen CLIPÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> text encoder at local clients.
While allowing efficient FL, these methods follow FedAvg and adopt <span id="S2.SS0.SSS0.Px3.p2.1.1" class="ltx_text ltx_font_italic">average-based</span> prompt aggregation, which is not optimal for clients with significant data heterogeneity.
Thus, applying prompt learning techniques to data heterogeneous FL scenarios remains an open research challenge. In this work, we propose a unique personalized prompt generation to enable efficient model personalization upon clients with heterogeneous data.

</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Method</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Formulation</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.6" class="ltx_p">For the sake of completeness, we first define the problem setting in this paper. Following previous personalized federated learning worksÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>, we assume that training data are distributed in <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">N</annotation></semantics></math> separated clients with heterogeneous datasets <math id="S3.SS1.p1.2.m2.4" class="ltx_Math" alttext="\mathcal{D}=\{\mathcal{D}_{1},\mathcal{D}_{2},...,\mathcal{D}_{N}\}" display="inline"><semantics id="S3.SS1.p1.2.m2.4a"><mrow id="S3.SS1.p1.2.m2.4.4" xref="S3.SS1.p1.2.m2.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.4.4.5" xref="S3.SS1.p1.2.m2.4.4.5.cmml">ğ’Ÿ</mi><mo id="S3.SS1.p1.2.m2.4.4.4" xref="S3.SS1.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.4.4.3.3" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.4.4.3.3.4" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.2.m2.2.2.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml">ğ’Ÿ</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.4.4.3.3.5" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml">ğ’Ÿ</mi><mn id="S3.SS1.p1.2.m2.3.3.2.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.2.m2.4.4.3.3.6" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">â€¦</mi><mo id="S3.SS1.p1.2.m2.4.4.3.3.7" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.4.4.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.4.4.3.3.3.2" xref="S3.SS1.p1.2.m2.4.4.3.3.3.2.cmml">ğ’Ÿ</mi><mi id="S3.SS1.p1.2.m2.4.4.3.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS1.p1.2.m2.4.4.3.3.8" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.4b"><apply id="S3.SS1.p1.2.m2.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4"><eq id="S3.SS1.p1.2.m2.4.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4.4"></eq><ci id="S3.SS1.p1.2.m2.4.4.5.cmml" xref="S3.SS1.p1.2.m2.4.4.5">ğ’Ÿ</ci><set id="S3.SS1.p1.2.m2.4.4.3.4.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3"><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2">ğ’Ÿ</ci><cn type="integer" id="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2">ğ’Ÿ</ci><cn type="integer" id="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">â€¦</ci><apply id="S3.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.2">ğ’Ÿ</ci><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3">ğ‘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.4c">\mathcal{D}=\{\mathcal{D}_{1},\mathcal{D}_{2},...,\mathcal{D}_{N}\}</annotation></semantics></math>, each contains a set of image-label pairs <math id="S3.SS1.p1.3.m3.2" class="ltx_Math" alttext="\mathcal{D}_{n}=\{(\mathtt{\textbf{x}}_{i},y_{i})\}_{i=1}^{|\mathcal{D}_{n}|}" display="inline"><semantics id="S3.SS1.p1.3.m3.2a"><mrow id="S3.SS1.p1.3.m3.2.2" xref="S3.SS1.p1.3.m3.2.2.cmml"><msub id="S3.SS1.p1.3.m3.2.2.3" xref="S3.SS1.p1.3.m3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.2.2.3.2" xref="S3.SS1.p1.3.m3.2.2.3.2.cmml">ğ’Ÿ</mi><mi id="S3.SS1.p1.3.m3.2.2.3.3" xref="S3.SS1.p1.3.m3.2.2.3.3.cmml">n</mi></msub><mo id="S3.SS1.p1.3.m3.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.cmml">=</mo><msubsup id="S3.SS1.p1.3.m3.2.2.1" xref="S3.SS1.p1.3.m3.2.2.1.cmml"><mrow id="S3.SS1.p1.3.m3.2.2.1.1.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.3" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.2a.cmml">x</mtext><mi id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.4" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.5" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.3" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.3.m3.2.2.1.1.3" xref="S3.SS1.p1.3.m3.2.2.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.3.2" xref="S3.SS1.p1.3.m3.2.2.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.3.m3.2.2.1.1.3.1" xref="S3.SS1.p1.3.m3.2.2.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.3.m3.2.2.1.1.3.3" xref="S3.SS1.p1.3.m3.2.2.1.1.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p1.3.m3.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS1.p1.3.m3.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.2b"><apply id="S3.SS1.p1.3.m3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2"><eq id="S3.SS1.p1.3.m3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2"></eq><apply id="S3.SS1.p1.3.m3.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.3.1.cmml" xref="S3.SS1.p1.3.m3.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.3.2.cmml" xref="S3.SS1.p1.3.m3.2.2.3.2">ğ’Ÿ</ci><ci id="S3.SS1.p1.3.m3.2.2.3.3.cmml" xref="S3.SS1.p1.3.m3.2.2.3.3">ğ‘›</ci></apply><apply id="S3.SS1.p1.3.m3.2.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1">superscript</csymbol><apply id="S3.SS1.p1.3.m3.2.2.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1">subscript</csymbol><set id="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1"><interval closure="open" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2"><apply id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.2a.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.2">x</mtext></ci><ci id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2.2">ğ‘¦</ci><ci id="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.1.1.2.2.3">ğ‘–</ci></apply></interval></set><apply id="S3.SS1.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.3"><eq id="S3.SS1.p1.3.m3.2.2.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.3.1"></eq><ci id="S3.SS1.p1.3.m3.2.2.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.3.2">ğ‘–</ci><cn type="integer" id="S3.SS1.p1.3.m3.2.2.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1"><abs id="S3.SS1.p1.3.m3.1.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.2"></abs><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2">ğ’Ÿ</ci><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.3">ğ‘›</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.2c">\mathcal{D}_{n}=\{(\mathtt{\textbf{x}}_{i},y_{i})\}_{i=1}^{|\mathcal{D}_{n}|}</annotation></semantics></math>. These datasets follow <span id="S3.SS1.p1.6.1" class="ltx_text ltx_font_italic">non-IID</span> (independent and identically distributed) data distribution in terms of either domain discrepancy or imbalanced label space.
With the interest of training efficiency and local data privacy preserved, we aim at learning a client-specific prompt generation mechanism that produces <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">K</annotation></semantics></math> personalized visual prompts <math id="S3.SS1.p1.5.m5.4" class="ltx_Math" alttext="\textbf{P}_{n}=[p^{1}_{n},p^{2}_{n},...,p^{K}_{n}]" display="inline"><semantics id="S3.SS1.p1.5.m5.4a"><mrow id="S3.SS1.p1.5.m5.4.4" xref="S3.SS1.p1.5.m5.4.4.cmml"><msub id="S3.SS1.p1.5.m5.4.4.5" xref="S3.SS1.p1.5.m5.4.4.5.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.5.m5.4.4.5.2" xref="S3.SS1.p1.5.m5.4.4.5.2a.cmml">P</mtext><mi id="S3.SS1.p1.5.m5.4.4.5.3" xref="S3.SS1.p1.5.m5.4.4.5.3.cmml">n</mi></msub><mo id="S3.SS1.p1.5.m5.4.4.4" xref="S3.SS1.p1.5.m5.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.5.m5.4.4.3.3" xref="S3.SS1.p1.5.m5.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m5.4.4.3.3.4" xref="S3.SS1.p1.5.m5.4.4.3.4.cmml">[</mo><msubsup id="S3.SS1.p1.5.m5.2.2.1.1.1" xref="S3.SS1.p1.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.5.m5.2.2.1.1.1.2.2" xref="S3.SS1.p1.5.m5.2.2.1.1.1.2.2.cmml">p</mi><mi id="S3.SS1.p1.5.m5.2.2.1.1.1.3" xref="S3.SS1.p1.5.m5.2.2.1.1.1.3.cmml">n</mi><mn id="S3.SS1.p1.5.m5.2.2.1.1.1.2.3" xref="S3.SS1.p1.5.m5.2.2.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S3.SS1.p1.5.m5.4.4.3.3.5" xref="S3.SS1.p1.5.m5.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.5.m5.3.3.2.2.2" xref="S3.SS1.p1.5.m5.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.5.m5.3.3.2.2.2.2.2" xref="S3.SS1.p1.5.m5.3.3.2.2.2.2.2.cmml">p</mi><mi id="S3.SS1.p1.5.m5.3.3.2.2.2.3" xref="S3.SS1.p1.5.m5.3.3.2.2.2.3.cmml">n</mi><mn id="S3.SS1.p1.5.m5.3.3.2.2.2.2.3" xref="S3.SS1.p1.5.m5.3.3.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.p1.5.m5.4.4.3.3.6" xref="S3.SS1.p1.5.m5.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">â€¦</mi><mo id="S3.SS1.p1.5.m5.4.4.3.3.7" xref="S3.SS1.p1.5.m5.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.5.m5.4.4.3.3.3" xref="S3.SS1.p1.5.m5.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.5.m5.4.4.3.3.3.2.2" xref="S3.SS1.p1.5.m5.4.4.3.3.3.2.2.cmml">p</mi><mi id="S3.SS1.p1.5.m5.4.4.3.3.3.3" xref="S3.SS1.p1.5.m5.4.4.3.3.3.3.cmml">n</mi><mi id="S3.SS1.p1.5.m5.4.4.3.3.3.2.3" xref="S3.SS1.p1.5.m5.4.4.3.3.3.2.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS1.p1.5.m5.4.4.3.3.8" xref="S3.SS1.p1.5.m5.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.4b"><apply id="S3.SS1.p1.5.m5.4.4.cmml" xref="S3.SS1.p1.5.m5.4.4"><eq id="S3.SS1.p1.5.m5.4.4.4.cmml" xref="S3.SS1.p1.5.m5.4.4.4"></eq><apply id="S3.SS1.p1.5.m5.4.4.5.cmml" xref="S3.SS1.p1.5.m5.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.5.1.cmml" xref="S3.SS1.p1.5.m5.4.4.5">subscript</csymbol><ci id="S3.SS1.p1.5.m5.4.4.5.2a.cmml" xref="S3.SS1.p1.5.m5.4.4.5.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.5.m5.4.4.5.2.cmml" xref="S3.SS1.p1.5.m5.4.4.5.2">P</mtext></ci><ci id="S3.SS1.p1.5.m5.4.4.5.3.cmml" xref="S3.SS1.p1.5.m5.4.4.5.3">ğ‘›</ci></apply><list id="S3.SS1.p1.5.m5.4.4.3.4.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3"><apply id="S3.SS1.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1">subscript</csymbol><apply id="S3.SS1.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.2.2.1.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.5.m5.2.2.1.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1.2.2">ğ‘</ci><cn type="integer" id="S3.SS1.p1.5.m5.2.2.1.1.1.2.3.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS1.p1.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1.3">ğ‘›</ci></apply><apply id="S3.SS1.p1.5.m5.3.3.2.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2">subscript</csymbol><apply id="S3.SS1.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.3.3.2.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2">superscript</csymbol><ci id="S3.SS1.p1.5.m5.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2.2.2">ğ‘</ci><cn type="integer" id="S3.SS1.p1.5.m5.3.3.2.2.2.2.3.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.5.m5.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2.3">ğ‘›</ci></apply><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">â€¦</ci><apply id="S3.SS1.p1.5.m5.4.4.3.3.3.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3.3">subscript</csymbol><apply id="S3.SS1.p1.5.m5.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.3.3.3.2.1.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3.3">superscript</csymbol><ci id="S3.SS1.p1.5.m5.4.4.3.3.3.2.2.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3.3.2.2">ğ‘</ci><ci id="S3.SS1.p1.5.m5.4.4.3.3.3.2.3.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3.3.2.3">ğ¾</ci></apply><ci id="S3.SS1.p1.5.m5.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3.3.3">ğ‘›</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.4c">\textbf{P}_{n}=[p^{1}_{n},p^{2}_{n},...,p^{K}_{n}]</annotation></semantics></math> that adapt a pre-trained foundation model <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="F^{*}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msup id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">F</mi><mo id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">ğ¹</ci><times id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">F^{*}</annotation></semantics></math> to perform classification tasks on each local client.
Through our learned client-specific prompts, we enable efficient model personalization for each heterogeneous client while preserving the robust representation from a frozen foundation model without the risks of overfitting.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Efficient Model Personalization in FL via Client-Specific Prompt Generation</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">As illustrated in Fig.Â <a href="#S2.F2" title="Figure 2 â€£ Personalized Federated Learning (pFL) â€£ 2 Related Works â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we propose a personalized federated learning framework of <em id="S3.SS2.p1.1.1" class="ltx_emph ltx_font_italic">client-specific Prompt Generation</em> (pFedPG).
To leverage underlying client characteristics and enable efficient model personalization for all clients, pFedPG alternates between the stages of <em id="S3.SS2.p1.1.2" class="ltx_emph ltx_font_italic">personalized prompt adaptation</em> and <em id="S3.SS2.p1.1.3" class="ltx_emph ltx_font_italic">personalized prompt generation</em> at local clients and the global server, respectively.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.7" class="ltx_p">In the stage of <em id="S3.SS2.p2.7.1" class="ltx_emph ltx_font_italic">personalized prompt adaptation</em>, pFedPG advances the visual prompt learning techniqueÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> in FL frameworks. A small number of trainable parameters, denoted as <span id="S3.SS2.p2.7.2" class="ltx_text ltx_font_italic">prompts</span> <math id="S3.SS2.p2.1.m1.4" class="ltx_Math" alttext="\textbf{P}_{n}=[p^{1}_{n},p^{2}_{n},...,p^{K}_{n}]" display="inline"><semantics id="S3.SS2.p2.1.m1.4a"><mrow id="S3.SS2.p2.1.m1.4.4" xref="S3.SS2.p2.1.m1.4.4.cmml"><msub id="S3.SS2.p2.1.m1.4.4.5" xref="S3.SS2.p2.1.m1.4.4.5.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.1.m1.4.4.5.2" xref="S3.SS2.p2.1.m1.4.4.5.2a.cmml">P</mtext><mi id="S3.SS2.p2.1.m1.4.4.5.3" xref="S3.SS2.p2.1.m1.4.4.5.3.cmml">n</mi></msub><mo id="S3.SS2.p2.1.m1.4.4.4" xref="S3.SS2.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS2.p2.1.m1.4.4.3.3" xref="S3.SS2.p2.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.4.4.3.3.4" xref="S3.SS2.p2.1.m1.4.4.3.4.cmml">[</mo><msubsup id="S3.SS2.p2.1.m1.2.2.1.1.1" xref="S3.SS2.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.2.2" xref="S3.SS2.p2.1.m1.2.2.1.1.1.2.2.cmml">p</mi><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.3" xref="S3.SS2.p2.1.m1.2.2.1.1.1.3.cmml">n</mi><mn id="S3.SS2.p2.1.m1.2.2.1.1.1.2.3" xref="S3.SS2.p2.1.m1.2.2.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S3.SS2.p2.1.m1.4.4.3.3.5" xref="S3.SS2.p2.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.p2.1.m1.3.3.2.2.2" xref="S3.SS2.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.p2.1.m1.3.3.2.2.2.2.2" xref="S3.SS2.p2.1.m1.3.3.2.2.2.2.2.cmml">p</mi><mi id="S3.SS2.p2.1.m1.3.3.2.2.2.3" xref="S3.SS2.p2.1.m1.3.3.2.2.2.3.cmml">n</mi><mn id="S3.SS2.p2.1.m1.3.3.2.2.2.2.3" xref="S3.SS2.p2.1.m1.3.3.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS2.p2.1.m1.4.4.3.3.6" xref="S3.SS2.p2.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">â€¦</mi><mo id="S3.SS2.p2.1.m1.4.4.3.3.7" xref="S3.SS2.p2.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.p2.1.m1.4.4.3.3.3" xref="S3.SS2.p2.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS2.p2.1.m1.4.4.3.3.3.2.2" xref="S3.SS2.p2.1.m1.4.4.3.3.3.2.2.cmml">p</mi><mi id="S3.SS2.p2.1.m1.4.4.3.3.3.3" xref="S3.SS2.p2.1.m1.4.4.3.3.3.3.cmml">n</mi><mi id="S3.SS2.p2.1.m1.4.4.3.3.3.2.3" xref="S3.SS2.p2.1.m1.4.4.3.3.3.2.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS2.p2.1.m1.4.4.3.3.8" xref="S3.SS2.p2.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.4b"><apply id="S3.SS2.p2.1.m1.4.4.cmml" xref="S3.SS2.p2.1.m1.4.4"><eq id="S3.SS2.p2.1.m1.4.4.4.cmml" xref="S3.SS2.p2.1.m1.4.4.4"></eq><apply id="S3.SS2.p2.1.m1.4.4.5.cmml" xref="S3.SS2.p2.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.4.4.5.1.cmml" xref="S3.SS2.p2.1.m1.4.4.5">subscript</csymbol><ci id="S3.SS2.p2.1.m1.4.4.5.2a.cmml" xref="S3.SS2.p2.1.m1.4.4.5.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.1.m1.4.4.5.2.cmml" xref="S3.SS2.p2.1.m1.4.4.5.2">P</mtext></ci><ci id="S3.SS2.p2.1.m1.4.4.5.3.cmml" xref="S3.SS2.p2.1.m1.4.4.5.3">ğ‘›</ci></apply><list id="S3.SS2.p2.1.m1.4.4.3.4.cmml" xref="S3.SS2.p2.1.m1.4.4.3.3"><apply id="S3.SS2.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.2.2">ğ‘</ci><cn type="integer" id="S3.SS2.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.3">ğ‘›</ci></apply><apply id="S3.SS2.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S3.SS2.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.SS2.p2.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.2.2.2">ğ‘</ci><cn type="integer" id="S3.SS2.p2.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.p2.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.2.3">ğ‘›</ci></apply><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">â€¦</ci><apply id="S3.SS2.p2.1.m1.4.4.3.3.3.cmml" xref="S3.SS2.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS2.p2.1.m1.4.4.3.3.3">subscript</csymbol><apply id="S3.SS2.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS2.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS2.p2.1.m1.4.4.3.3.3">superscript</csymbol><ci id="S3.SS2.p2.1.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS2.p2.1.m1.4.4.3.3.3.2.2">ğ‘</ci><ci id="S3.SS2.p2.1.m1.4.4.3.3.3.2.3.cmml" xref="S3.SS2.p2.1.m1.4.4.3.3.3.2.3">ğ¾</ci></apply><ci id="S3.SS2.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS2.p2.1.m1.4.4.3.3.3.3">ğ‘›</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.4c">\textbf{P}_{n}=[p^{1}_{n},p^{2}_{n},...,p^{K}_{n}]</annotation></semantics></math>, are inserted into a frozen foundation model <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="F^{*}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msup id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">F</mi><mo id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">ğ¹</ci><times id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">F^{*}</annotation></semantics></math> to encode client-specific information at client <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">n</annotation></semantics></math>.
In the stage of <em id="S3.SS2.p2.7.3" class="ltx_emph ltx_font_italic">personalized prompt generation</em>, a personalized prompt generator <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">G</annotation></semantics></math> is learned to produce personalized prompts for each client by exploiting the underlying characteristics among clients.
Once the learning process is complete, we are able to efficiently adapt the frozen foundation model <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="F^{*}" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><msup id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">F</mi><mo id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">ğ¹</ci><times id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">F^{*}</annotation></semantics></math> by the client-specific prompts <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="\textbf{P}_{n}" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><msub id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2a.cmml">P</mtext><mi id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.2a.cmml" xref="S3.SS2.p2.6.m6.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2">P</mtext></ci><ci id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\textbf{P}_{n}</annotation></semantics></math> to perform recognition tasks at each client <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><mi id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">n</annotation></semantics></math>. We now detail each learning stage, including the training/inference processes below.</p>
</div>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Personalized prompt adaptation at local clients</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.1" class="ltx_p">To enable efficient model adaptation on top of large-scale foundation models and prevent possible overfitting problems caused by updating on relatively limited private data, we advance <em id="S3.SS2.SSS1.p1.1.1" class="ltx_emph ltx_font_italic">Personalized Prompt Adaptation</em> based on the prompt learningÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> scheme. Note that, the prompts could be treated as client-specific learnable parameters and directly optimized through gradients during training.
With the prompts learned, we can efficiently adapt the foundation model <math id="S3.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="F^{*}" display="inline"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><msup id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml">F</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2">ğ¹</ci><times id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">F^{*}</annotation></semantics></math> to the data distribution of interest.</p>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS1.p2.8" class="ltx_p">As depicted in Fig.Â <a href="#S2.F2" title="Figure 2 â€£ Personalized Federated Learning (pFL) â€£ 2 Related Works â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a), this training stage aims to learn client-specific prompts <math id="S3.SS2.SSS1.p2.1.m1.4" class="ltx_Math" alttext="\textbf{P}_{n}=[p^{1}_{n},p^{2}_{n},...,p^{K}_{n}]" display="inline"><semantics id="S3.SS2.SSS1.p2.1.m1.4a"><mrow id="S3.SS2.SSS1.p2.1.m1.4.4" xref="S3.SS2.SSS1.p2.1.m1.4.4.cmml"><msub id="S3.SS2.SSS1.p2.1.m1.4.4.5" xref="S3.SS2.SSS1.p2.1.m1.4.4.5.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p2.1.m1.4.4.5.2" xref="S3.SS2.SSS1.p2.1.m1.4.4.5.2a.cmml">P</mtext><mi id="S3.SS2.SSS1.p2.1.m1.4.4.5.3" xref="S3.SS2.SSS1.p2.1.m1.4.4.5.3.cmml">n</mi></msub><mo id="S3.SS2.SSS1.p2.1.m1.4.4.4" xref="S3.SS2.SSS1.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS2.SSS1.p2.1.m1.4.4.3.3" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.4" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml">[</mo><msubsup id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2.cmml">p</mi><mi id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.3" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.3.cmml">n</mi><mn id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.3" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.5" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2.2" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2.2.cmml">p</mi><mi id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.3" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.3.cmml">n</mi><mn id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2.3" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.6" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml">â€¦</mi><mo id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.7" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2.2" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2.2.cmml">p</mi><mi id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.3" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.3.cmml">n</mi><mi id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2.3" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.8" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.4b"><apply id="S3.SS2.SSS1.p2.1.m1.4.4.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4"><eq id="S3.SS2.SSS1.p2.1.m1.4.4.4.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.4"></eq><apply id="S3.SS2.SSS1.p2.1.m1.4.4.5.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.4.4.5.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.5">subscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.4.4.5.2a.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.5.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p2.1.m1.4.4.5.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.5.2">P</mtext></ci><ci id="S3.SS2.SSS1.p2.1.m1.4.4.5.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.5.3">ğ‘›</ci></apply><list id="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3"><apply id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2">ğ‘</ci><cn type="integer" id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.3">ğ‘›</ci></apply><apply id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2.2">ğ‘</ci><cn type="integer" id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.3">ğ‘›</ci></apply><ci id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1">â€¦</ci><apply id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3">subscript</csymbol><apply id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3">superscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2.2">ğ‘</ci><ci id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2.3">ğ¾</ci></apply><ci id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.3">ğ‘›</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.4c">\textbf{P}_{n}=[p^{1}_{n},p^{2}_{n},...,p^{K}_{n}]</annotation></semantics></math> by leveraging the Transformer-based frozen foundation model <math id="S3.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="F^{*}" display="inline"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><msup id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.cmml">F</mi><mo id="S3.SS2.SSS1.p2.2.m2.1.1.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><apply id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.2">ğ¹</ci><times id="S3.SS2.SSS1.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">F^{*}</annotation></semantics></math> with locally updated classification head <math id="S3.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="H_{n}" display="inline"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><msub id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p2.3.m3.1.1.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml">H</mi><mi id="S3.SS2.SSS1.p2.3.m3.1.1.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><apply id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.2">ğ»</ci><ci id="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">H_{n}</annotation></semantics></math>. To be more specific, we followÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> and divide an input image <span id="S3.SS2.SSS1.p2.8.1" class="ltx_text ltx_markedasmath ltx_font_bold">x</span> to <math id="S3.SS2.SSS1.p2.5.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.SSS1.p2.5.m5.1a"><mi id="S3.SS2.SSS1.p2.5.m5.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.5.m5.1b"><ci id="S3.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m5.1c">m</annotation></semantics></math> image patches <math id="S3.SS2.SSS1.p2.6.m6.1" class="ltx_Math" alttext="\{a^{i}\}_{i=1}^{m}" display="inline"><semantics id="S3.SS2.SSS1.p2.6.m6.1a"><msubsup id="S3.SS2.SSS1.p2.6.m6.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.cmml"><mrow id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.2.cmml">{</mo><msup id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.2.cmml">a</mi><mi id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS1.p2.6.m6.1.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.6.m6.1.1.1.3.2" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p2.6.m6.1.1.1.3.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.SSS1.p2.6.m6.1.1.1.3.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS1.p2.6.m6.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.6.m6.1b"><apply id="S3.SS2.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1">superscript</csymbol><apply id="S3.SS2.SSS1.p2.6.m6.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.6.m6.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1">subscript</csymbol><set id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1"><apply id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.2">ğ‘</ci><ci id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.3">ğ‘–</ci></apply></set><apply id="S3.SS2.SSS1.p2.6.m6.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.3"><eq id="S3.SS2.SSS1.p2.6.m6.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.3.1"></eq><ci id="S3.SS2.SSS1.p2.6.m6.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.3.2">ğ‘–</ci><cn type="integer" id="S3.SS2.SSS1.p2.6.m6.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS1.p2.6.m6.1.1.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.3">ğ‘š</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.6.m6.1c">\{a^{i}\}_{i=1}^{m}</annotation></semantics></math> and then derive the latent embedding <span id="S3.SS2.SSS1.p2.8.2" class="ltx_text ltx_markedasmath ltx_font_bold">z</span> by a frozen feature embedding module <math id="S3.SS2.SSS1.p2.8.m8.1" class="ltx_Math" alttext="\mathtt{Embed}" display="inline"><semantics id="S3.SS2.SSS1.p2.8.m8.1a"><mi id="S3.SS2.SSS1.p2.8.m8.1.1" xref="S3.SS2.SSS1.p2.8.m8.1.1.cmml">ğ™´ğš–ğš‹ğšğš</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.8.m8.1b"><ci id="S3.SS2.SSS1.p2.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m8.1.1">ğ™´ğš–ğš‹ğšğš</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.8.m8.1c">\mathtt{Embed}</annotation></semantics></math> as follows:</p>
<table id="S3.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.E1X.2.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">x</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=[a^{1},a^{2},...,a^{m}],\quad a\in\mathbb{R}^{3\times h\times w}," display="inline"><semantics id="S3.E1X.3.2.2.m1.2a"><mrow id="S3.E1X.3.2.2.m1.2.2.1"><mrow id="S3.E1X.3.2.2.m1.2.2.1.1.2" xref="S3.E1X.3.2.2.m1.2.2.1.1.3.cmml"><mrow id="S3.E1X.3.2.2.m1.2.2.1.1.1.1" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.cmml"><mi id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.5" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.5.cmml"></mi><mo id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.4" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.4.cmml">=</mo><mrow id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.4.cmml"><mo stretchy="false" id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.4" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.4.cmml">[</mo><msup id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">a</mi><mn id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.5" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.4.cmml">,</mo><msup id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2.2" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.cmml">a</mi><mn id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2.3" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2.3.cmml">2</mn></msup><mo id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.6" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E1X.3.2.2.m1.1.1" xref="S3.E1X.3.2.2.m1.1.1.cmml">â€¦</mi><mo id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.7" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.4.cmml">,</mo><msup id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3.cmml"><mi id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3.2" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3.2.cmml">a</mi><mi id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3.3" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3.3.cmml">m</mi></msup><mo stretchy="false" id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.8" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.4.cmml">]</mo></mrow></mrow><mo rspace="1.167em" id="S3.E1X.3.2.2.m1.2.2.1.1.2.3" xref="S3.E1X.3.2.2.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S3.E1X.3.2.2.m1.2.2.1.1.2.2" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.cmml"><mi id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.2" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.2.cmml">a</mi><mo id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.1" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.1.cmml">âˆˆ</mo><msup id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.cmml"><mi id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.2" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.2.cmml">â„</mi><mrow id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.cmml"><mn id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.2" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.1" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.1.cmml">Ã—</mo><mi id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.3" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.3.cmml">h</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.1a" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.1.cmml">Ã—</mo><mi id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.4" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.4.cmml">w</mi></mrow></msup></mrow></mrow><mo id="S3.E1X.3.2.2.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.3.2.2.m1.2b"><apply id="S3.E1X.3.2.2.m1.2.2.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.2.2.1.1.3a.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1"><eq id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.4.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.4"></eq><csymbol cd="latexml" id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.5.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.5">absent</csymbol><list id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.4.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3"><apply id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2">ğ‘</ci><cn type="integer" id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2.2">ğ‘</ci><cn type="integer" id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S3.E1X.3.2.2.m1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1">â€¦</ci><apply id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3.1.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3.2.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3.2">ğ‘</ci><ci id="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3.3.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.3.3">ğ‘š</ci></apply></list></apply><apply id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2"><in id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.1.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.1"></in><ci id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.2">ğ‘</ci><apply id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3">superscript</csymbol><ci id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.2">â„</ci><apply id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3"><times id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.1.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.1"></times><cn type="integer" id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.2.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.2">3</cn><ci id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.3.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.3">â„</ci><ci id="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.4.cmml" xref="S3.E1X.3.2.2.m1.2.2.1.1.2.2.3.3.4">ğ‘¤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.3.2.2.m1.2c">\displaystyle=[a^{1},a^{2},...,a^{m}],\quad a\in\mathbb{R}^{3\times h\times w},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
<tr id="S3.E1Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.E1Xa.2.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">z</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1Xa.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=[z^{1},z^{2},...,z^{m}],\quad z=\mathtt{Embed}(a)," display="inline"><semantics id="S3.E1Xa.3.2.2.m1.3a"><mrow id="S3.E1Xa.3.2.2.m1.3.3.1"><mrow id="S3.E1Xa.3.2.2.m1.3.3.1.1.2" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.3.cmml"><mrow id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.cmml"><mi id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.5" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.5.cmml"></mi><mo id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.4" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.4.cmml">=</mo><mrow id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.4.cmml"><mo stretchy="false" id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.4" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.4.cmml">[</mo><msup id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml">z</mi><mn id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.5" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.4.cmml">,</mo><msup id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2.cmml"><mi id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2.2" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2.2.cmml">z</mi><mn id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2.3" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2.3.cmml">2</mn></msup><mo id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.6" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E1Xa.3.2.2.m1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.cmml">â€¦</mi><mo id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.7" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.4.cmml">,</mo><msup id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3.cmml"><mi id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3.2" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3.2.cmml">z</mi><mi id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3.3" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3.3.cmml">m</mi></msup><mo stretchy="false" id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.8" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.4.cmml">]</mo></mrow></mrow><mo rspace="1.167em" id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.3" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.cmml"><mi id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.2" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.cmml">z</mi><mo id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.1" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.1.cmml">=</mo><mrow id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.cmml"><mi id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.2" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.2.cmml">ğ™´ğš–ğš‹ğšğš</mi><mo lspace="0em" rspace="0em" id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.1" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.1.cmml">â€‹</mo><mrow id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.3.2" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.3.2.1" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.cmml">(</mo><mi id="S3.E1Xa.3.2.2.m1.2.2" xref="S3.E1Xa.3.2.2.m1.2.2.cmml">a</mi><mo stretchy="false" id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.3.2.2" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1Xa.3.2.2.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1Xa.3.2.2.m1.3b"><apply id="S3.E1Xa.3.2.2.m1.3.3.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.3.3.1.1.3a.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1"><eq id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.4.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.4"></eq><csymbol cd="latexml" id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.5.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.5">absent</csymbol><list id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.4.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3"><apply id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.2">ğ‘§</ci><cn type="integer" id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2.2">ğ‘§</ci><cn type="integer" id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S3.E1Xa.3.2.2.m1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1">â€¦</ci><apply id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3.1.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3.2.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3.2">ğ‘§</ci><ci id="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3.3.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.1.1.3.3.3.3">ğ‘š</ci></apply></list></apply><apply id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2"><eq id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.1"></eq><ci id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.2">ğ‘§</ci><apply id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3"><times id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.1"></times><ci id="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.2">ğ™´ğš–ğš‹ğšğš</ci><ci id="S3.E1Xa.3.2.2.m1.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.2.2">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xa.3.2.2.m1.3c">\displaystyle=[z^{1},z^{2},...,z^{m}],\quad z=\mathtt{Embed}(a),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.SSS1.p2.20" class="ltx_p">where <math id="S3.SS2.SSS1.p2.9.m1.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS2.SSS1.p2.9.m1.1a"><mi id="S3.SS2.SSS1.p2.9.m1.1.1" xref="S3.SS2.SSS1.p2.9.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.9.m1.1b"><ci id="S3.SS2.SSS1.p2.9.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.9.m1.1.1">â„</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.9.m1.1c">h</annotation></semantics></math> and <math id="S3.SS2.SSS1.p2.10.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS2.SSS1.p2.10.m2.1a"><mi id="S3.SS2.SSS1.p2.10.m2.1.1" xref="S3.SS2.SSS1.p2.10.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.10.m2.1b"><ci id="S3.SS2.SSS1.p2.10.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.10.m2.1.1">ğ‘¤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.10.m2.1c">w</annotation></semantics></math> denote the height and width of an image patch, and the patch embedding <math id="S3.SS2.SSS1.p2.11.m3.1" class="ltx_Math" alttext="z^{m}" display="inline"><semantics id="S3.SS2.SSS1.p2.11.m3.1a"><msup id="S3.SS2.SSS1.p2.11.m3.1.1" xref="S3.SS2.SSS1.p2.11.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p2.11.m3.1.1.2" xref="S3.SS2.SSS1.p2.11.m3.1.1.2.cmml">z</mi><mi id="S3.SS2.SSS1.p2.11.m3.1.1.3" xref="S3.SS2.SSS1.p2.11.m3.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.11.m3.1b"><apply id="S3.SS2.SSS1.p2.11.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.11.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.11.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p2.11.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p2.11.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p2.11.m3.1.1.2">ğ‘§</ci><ci id="S3.SS2.SSS1.p2.11.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p2.11.m3.1.1.3">ğ‘š</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.11.m3.1c">z^{m}</annotation></semantics></math> is projected to <math id="S3.SS2.SSS1.p2.12.m4.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.SSS1.p2.12.m4.1a"><mi id="S3.SS2.SSS1.p2.12.m4.1.1" xref="S3.SS2.SSS1.p2.12.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.12.m4.1b"><ci id="S3.SS2.SSS1.p2.12.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.12.m4.1.1">ğ‘™</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.12.m4.1c">l</annotation></semantics></math>-dimension. Once the latent embedding <span id="S3.SS2.SSS1.p2.20.1" class="ltx_text ltx_markedasmath ltx_font_bold">z</span> is obtained, we form the input embedding of the Transformer encoder <math id="S3.SS2.SSS1.p2.14.m6.1" class="ltx_Math" alttext="F^{*}" display="inline"><semantics id="S3.SS2.SSS1.p2.14.m6.1a"><msup id="S3.SS2.SSS1.p2.14.m6.1.1" xref="S3.SS2.SSS1.p2.14.m6.1.1.cmml"><mi id="S3.SS2.SSS1.p2.14.m6.1.1.2" xref="S3.SS2.SSS1.p2.14.m6.1.1.2.cmml">F</mi><mo id="S3.SS2.SSS1.p2.14.m6.1.1.3" xref="S3.SS2.SSS1.p2.14.m6.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.14.m6.1b"><apply id="S3.SS2.SSS1.p2.14.m6.1.1.cmml" xref="S3.SS2.SSS1.p2.14.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.14.m6.1.1.1.cmml" xref="S3.SS2.SSS1.p2.14.m6.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p2.14.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p2.14.m6.1.1.2">ğ¹</ci><times id="S3.SS2.SSS1.p2.14.m6.1.1.3.cmml" xref="S3.SS2.SSS1.p2.14.m6.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.14.m6.1c">F^{*}</annotation></semantics></math> by concatenating <span id="S3.SS2.SSS1.p2.20.2" class="ltx_text ltx_markedasmath ltx_font_bold">z</span> with a classification token <math id="S3.SS2.SSS1.p2.16.m8.1" class="ltx_Math" alttext="c\in\mathbb{R}^{l}" display="inline"><semantics id="S3.SS2.SSS1.p2.16.m8.1a"><mrow id="S3.SS2.SSS1.p2.16.m8.1.1" xref="S3.SS2.SSS1.p2.16.m8.1.1.cmml"><mi id="S3.SS2.SSS1.p2.16.m8.1.1.2" xref="S3.SS2.SSS1.p2.16.m8.1.1.2.cmml">c</mi><mo id="S3.SS2.SSS1.p2.16.m8.1.1.1" xref="S3.SS2.SSS1.p2.16.m8.1.1.1.cmml">âˆˆ</mo><msup id="S3.SS2.SSS1.p2.16.m8.1.1.3" xref="S3.SS2.SSS1.p2.16.m8.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.16.m8.1.1.3.2" xref="S3.SS2.SSS1.p2.16.m8.1.1.3.2.cmml">â„</mi><mi id="S3.SS2.SSS1.p2.16.m8.1.1.3.3" xref="S3.SS2.SSS1.p2.16.m8.1.1.3.3.cmml">l</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.16.m8.1b"><apply id="S3.SS2.SSS1.p2.16.m8.1.1.cmml" xref="S3.SS2.SSS1.p2.16.m8.1.1"><in id="S3.SS2.SSS1.p2.16.m8.1.1.1.cmml" xref="S3.SS2.SSS1.p2.16.m8.1.1.1"></in><ci id="S3.SS2.SSS1.p2.16.m8.1.1.2.cmml" xref="S3.SS2.SSS1.p2.16.m8.1.1.2">ğ‘</ci><apply id="S3.SS2.SSS1.p2.16.m8.1.1.3.cmml" xref="S3.SS2.SSS1.p2.16.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.16.m8.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.16.m8.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p2.16.m8.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.16.m8.1.1.3.2">â„</ci><ci id="S3.SS2.SSS1.p2.16.m8.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.16.m8.1.1.3.3">ğ‘™</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.16.m8.1c">c\in\mathbb{R}^{l}</annotation></semantics></math> (pre-trained with the ViT backbone), and the client-specific prompts <math id="S3.SS2.SSS1.p2.17.m9.4" class="ltx_Math" alttext="\textbf{P}_{n}=\left[p^{1}_{n},p^{2}_{n},...,p^{K}_{n}\right]" display="inline"><semantics id="S3.SS2.SSS1.p2.17.m9.4a"><mrow id="S3.SS2.SSS1.p2.17.m9.4.4" xref="S3.SS2.SSS1.p2.17.m9.4.4.cmml"><msub id="S3.SS2.SSS1.p2.17.m9.4.4.5" xref="S3.SS2.SSS1.p2.17.m9.4.4.5.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p2.17.m9.4.4.5.2" xref="S3.SS2.SSS1.p2.17.m9.4.4.5.2a.cmml">P</mtext><mi id="S3.SS2.SSS1.p2.17.m9.4.4.5.3" xref="S3.SS2.SSS1.p2.17.m9.4.4.5.3.cmml">n</mi></msub><mo id="S3.SS2.SSS1.p2.17.m9.4.4.4" xref="S3.SS2.SSS1.p2.17.m9.4.4.4.cmml">=</mo><mrow id="S3.SS2.SSS1.p2.17.m9.4.4.3.3" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.4.cmml"><mo id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.4" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.4.cmml">[</mo><msubsup id="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1" xref="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.2.2" xref="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.2.2.cmml">p</mi><mi id="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.3" xref="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.3.cmml">n</mi><mn id="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.2.3" xref="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.5" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2" xref="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.2.2" xref="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.2.2.cmml">p</mi><mi id="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.3" xref="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.3.cmml">n</mi><mn id="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.2.3" xref="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.6" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS1.p2.17.m9.1.1" xref="S3.SS2.SSS1.p2.17.m9.1.1.cmml">â€¦</mi><mo id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.7" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.2.2" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.2.2.cmml">p</mi><mi id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.3" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.3.cmml">n</mi><mi id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.2.3" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.2.3.cmml">K</mi></msubsup><mo id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.8" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.17.m9.4b"><apply id="S3.SS2.SSS1.p2.17.m9.4.4.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4"><eq id="S3.SS2.SSS1.p2.17.m9.4.4.4.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.4"></eq><apply id="S3.SS2.SSS1.p2.17.m9.4.4.5.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.17.m9.4.4.5.1.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.5">subscript</csymbol><ci id="S3.SS2.SSS1.p2.17.m9.4.4.5.2a.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.5.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p2.17.m9.4.4.5.2.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.5.2">P</mtext></ci><ci id="S3.SS2.SSS1.p2.17.m9.4.4.5.3.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.5.3">ğ‘›</ci></apply><list id="S3.SS2.SSS1.p2.17.m9.4.4.3.4.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.3"><apply id="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.2.2">ğ‘</ci><cn type="integer" id="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.17.m9.2.2.1.1.1.3">ğ‘›</ci></apply><apply id="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.cmml" xref="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.2.2">ğ‘</ci><cn type="integer" id="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.17.m9.3.3.2.2.2.3">ğ‘›</ci></apply><ci id="S3.SS2.SSS1.p2.17.m9.1.1.cmml" xref="S3.SS2.SSS1.p2.17.m9.1.1">â€¦</ci><apply id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3">subscript</csymbol><apply id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.2.1.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3">superscript</csymbol><ci id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.2.2.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.2.2">ğ‘</ci><ci id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.2.3.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.2.3">ğ¾</ci></apply><ci id="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS1.p2.17.m9.4.4.3.3.3.3">ğ‘›</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.17.m9.4c">\textbf{P}_{n}=\left[p^{1}_{n},p^{2}_{n},...,p^{K}_{n}\right]</annotation></semantics></math> as <math id="S3.SS2.SSS1.p2.18.m10.3" class="ltx_Math" alttext="[c,\textbf{P}_{n},\mathtt{\textbf{z}}]" display="inline"><semantics id="S3.SS2.SSS1.p2.18.m10.3a"><mrow id="S3.SS2.SSS1.p2.18.m10.3.3.1" xref="S3.SS2.SSS1.p2.18.m10.3.3.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.18.m10.3.3.1.2" xref="S3.SS2.SSS1.p2.18.m10.3.3.2.cmml">[</mo><mi id="S3.SS2.SSS1.p2.18.m10.1.1" xref="S3.SS2.SSS1.p2.18.m10.1.1.cmml">c</mi><mo id="S3.SS2.SSS1.p2.18.m10.3.3.1.3" xref="S3.SS2.SSS1.p2.18.m10.3.3.2.cmml">,</mo><msub id="S3.SS2.SSS1.p2.18.m10.3.3.1.1" xref="S3.SS2.SSS1.p2.18.m10.3.3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p2.18.m10.3.3.1.1.2" xref="S3.SS2.SSS1.p2.18.m10.3.3.1.1.2a.cmml">P</mtext><mi id="S3.SS2.SSS1.p2.18.m10.3.3.1.1.3" xref="S3.SS2.SSS1.p2.18.m10.3.3.1.1.3.cmml">n</mi></msub><mo id="S3.SS2.SSS1.p2.18.m10.3.3.1.4" xref="S3.SS2.SSS1.p2.18.m10.3.3.2.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p2.18.m10.2.2" xref="S3.SS2.SSS1.p2.18.m10.2.2a.cmml">z</mtext><mo stretchy="false" id="S3.SS2.SSS1.p2.18.m10.3.3.1.5" xref="S3.SS2.SSS1.p2.18.m10.3.3.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.18.m10.3b"><list id="S3.SS2.SSS1.p2.18.m10.3.3.2.cmml" xref="S3.SS2.SSS1.p2.18.m10.3.3.1"><ci id="S3.SS2.SSS1.p2.18.m10.1.1.cmml" xref="S3.SS2.SSS1.p2.18.m10.1.1">ğ‘</ci><apply id="S3.SS2.SSS1.p2.18.m10.3.3.1.1.cmml" xref="S3.SS2.SSS1.p2.18.m10.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.18.m10.3.3.1.1.1.cmml" xref="S3.SS2.SSS1.p2.18.m10.3.3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.18.m10.3.3.1.1.2a.cmml" xref="S3.SS2.SSS1.p2.18.m10.3.3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p2.18.m10.3.3.1.1.2.cmml" xref="S3.SS2.SSS1.p2.18.m10.3.3.1.1.2">P</mtext></ci><ci id="S3.SS2.SSS1.p2.18.m10.3.3.1.1.3.cmml" xref="S3.SS2.SSS1.p2.18.m10.3.3.1.1.3">ğ‘›</ci></apply><ci id="S3.SS2.SSS1.p2.18.m10.2.2a.cmml" xref="S3.SS2.SSS1.p2.18.m10.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p2.18.m10.2.2.cmml" xref="S3.SS2.SSS1.p2.18.m10.2.2">z</mtext></ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.18.m10.3c">[c,\textbf{P}_{n},\mathtt{\textbf{z}}]</annotation></semantics></math>. To encourage the client-specific prompts to adapt upon this clientâ€™s data, we employ the standard cross-entropy loss <math id="S3.SS2.SSS1.p2.19.m11.1" class="ltx_Math" alttext="\mathcal{L}_{cla}" display="inline"><semantics id="S3.SS2.SSS1.p2.19.m11.1a"><msub id="S3.SS2.SSS1.p2.19.m11.1.1" xref="S3.SS2.SSS1.p2.19.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.19.m11.1.1.2" xref="S3.SS2.SSS1.p2.19.m11.1.1.2.cmml">â„’</mi><mrow id="S3.SS2.SSS1.p2.19.m11.1.1.3" xref="S3.SS2.SSS1.p2.19.m11.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.19.m11.1.1.3.2" xref="S3.SS2.SSS1.p2.19.m11.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.19.m11.1.1.3.1" xref="S3.SS2.SSS1.p2.19.m11.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS1.p2.19.m11.1.1.3.3" xref="S3.SS2.SSS1.p2.19.m11.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.19.m11.1.1.3.1a" xref="S3.SS2.SSS1.p2.19.m11.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS1.p2.19.m11.1.1.3.4" xref="S3.SS2.SSS1.p2.19.m11.1.1.3.4.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.19.m11.1b"><apply id="S3.SS2.SSS1.p2.19.m11.1.1.cmml" xref="S3.SS2.SSS1.p2.19.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.19.m11.1.1.1.cmml" xref="S3.SS2.SSS1.p2.19.m11.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.19.m11.1.1.2.cmml" xref="S3.SS2.SSS1.p2.19.m11.1.1.2">â„’</ci><apply id="S3.SS2.SSS1.p2.19.m11.1.1.3.cmml" xref="S3.SS2.SSS1.p2.19.m11.1.1.3"><times id="S3.SS2.SSS1.p2.19.m11.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.19.m11.1.1.3.1"></times><ci id="S3.SS2.SSS1.p2.19.m11.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.19.m11.1.1.3.2">ğ‘</ci><ci id="S3.SS2.SSS1.p2.19.m11.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.19.m11.1.1.3.3">ğ‘™</ci><ci id="S3.SS2.SSS1.p2.19.m11.1.1.3.4.cmml" xref="S3.SS2.SSS1.p2.19.m11.1.1.3.4">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.19.m11.1c">\mathcal{L}_{cla}</annotation></semantics></math> over <math id="S3.SS2.SSS1.p2.20.m12.1" class="ltx_Math" alttext="|\mathcal{D}_{n}|" display="inline"><semantics id="S3.SS2.SSS1.p2.20.m12.1a"><mrow id="S3.SS2.SSS1.p2.20.m12.1.1.1" xref="S3.SS2.SSS1.p2.20.m12.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.20.m12.1.1.1.2" xref="S3.SS2.SSS1.p2.20.m12.1.1.2.1.cmml">|</mo><msub id="S3.SS2.SSS1.p2.20.m12.1.1.1.1" xref="S3.SS2.SSS1.p2.20.m12.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.20.m12.1.1.1.1.2" xref="S3.SS2.SSS1.p2.20.m12.1.1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S3.SS2.SSS1.p2.20.m12.1.1.1.1.3" xref="S3.SS2.SSS1.p2.20.m12.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS2.SSS1.p2.20.m12.1.1.1.3" xref="S3.SS2.SSS1.p2.20.m12.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.20.m12.1b"><apply id="S3.SS2.SSS1.p2.20.m12.1.1.2.cmml" xref="S3.SS2.SSS1.p2.20.m12.1.1.1"><abs id="S3.SS2.SSS1.p2.20.m12.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.20.m12.1.1.1.2"></abs><apply id="S3.SS2.SSS1.p2.20.m12.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.20.m12.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.20.m12.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.20.m12.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.20.m12.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.20.m12.1.1.1.1.2">ğ’Ÿ</ci><ci id="S3.SS2.SSS1.p2.20.m12.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.20.m12.1.1.1.1.3">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.20.m12.1c">|\mathcal{D}_{n}|</annotation></semantics></math> samples, and is calculated as:</p>
<table id="S3.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{n}=\frac{1}{\left|\mathcal{D}_{n}\right|}\sum_{j=1}^{\left|\mathcal{D}_{n}\right|}\mathcal{L}_{cla}\left(H_{n}\left(F^{*}\left(\left[c,\textbf{P}_{n},\mathtt{\textbf{z}}_{j}\right]\right)\right),y_{j}\right)." display="inline"><semantics id="S3.E2X.2.1.1.m1.4a"><mrow id="S3.E2X.2.1.1.m1.4.4.1" xref="S3.E2X.2.1.1.m1.4.4.1.1.cmml"><mrow id="S3.E2X.2.1.1.m1.4.4.1.1" xref="S3.E2X.2.1.1.m1.4.4.1.1.cmml"><msub id="S3.E2X.2.1.1.m1.4.4.1.1.4" xref="S3.E2X.2.1.1.m1.4.4.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2X.2.1.1.m1.4.4.1.1.4.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.4.2.cmml">â„’</mi><mi id="S3.E2X.2.1.1.m1.4.4.1.1.4.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.4.3.cmml">n</mi></msub><mo id="S3.E2X.2.1.1.m1.4.4.1.1.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.3.cmml">=</mo><mrow id="S3.E2X.2.1.1.m1.4.4.1.1.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E2X.2.1.1.m1.1.1" xref="S3.E2X.2.1.1.m1.1.1.cmml"><mfrac id="S3.E2X.2.1.1.m1.1.1a" xref="S3.E2X.2.1.1.m1.1.1.cmml"><mn id="S3.E2X.2.1.1.m1.1.1.3" xref="S3.E2X.2.1.1.m1.1.1.3.cmml">1</mn><mrow id="S3.E2X.2.1.1.m1.1.1.1.1" xref="S3.E2X.2.1.1.m1.1.1.1.2.cmml"><mo id="S3.E2X.2.1.1.m1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E2X.2.1.1.m1.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2X.2.1.1.m1.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S3.E2X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S3.E2X.2.1.1.m1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.4.4.1.1.2.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.3.cmml">â€‹</mo><mrow id="S3.E2X.2.1.1.m1.4.4.1.1.2.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.cmml"><munderover id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3a" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.cmml"><mo movablelimits="false" id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.2.cmml">âˆ‘</mo><mrow id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.cmml"><mi id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.2.cmml">j</mi><mo id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.1" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S3.E2X.2.1.1.m1.2.2.1.1" xref="S3.E2X.2.1.1.m1.2.2.1.2.cmml"><mo id="S3.E2X.2.1.1.m1.2.2.1.1.2" xref="S3.E2X.2.1.1.m1.2.2.1.2.1.cmml">|</mo><msub id="S3.E2X.2.1.1.m1.2.2.1.1.1" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2X.2.1.1.m1.2.2.1.1.1.2" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S3.E2X.2.1.1.m1.2.2.1.1.1.3" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.3.cmml">n</mi></msub><mo id="S3.E2X.2.1.1.m1.2.2.1.1.3" xref="S3.E2X.2.1.1.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.cmml"><msub id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.2.cmml">â„’</mi><mrow id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.cmml"><mi id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.1" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.1.cmml">â€‹</mo><mi id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.1a" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.1.cmml">â€‹</mo><mi id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.4" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.4.cmml">a</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml">â€‹</mo><mrow id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml"><mo id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml">(</mo><mrow id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml">H</mi><mi id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">F</mi><mo id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">âˆ—</mo></msup><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">[</mo><mi id="S3.E2X.2.1.1.m1.3.3" xref="S3.E2X.2.1.1.m1.3.3.cmml">c</mi><mo id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml">P</mtext><mi id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.5" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2a.cmml">z</mtext><mi id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.6" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.4" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.5" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E2X.2.1.1.m1.4.4.1.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.2.1.1.m1.4b"><apply id="S3.E2X.2.1.1.m1.4.4.1.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1"><eq id="S3.E2X.2.1.1.m1.4.4.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.3"></eq><apply id="S3.E2X.2.1.1.m1.4.4.1.1.4.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.1.1.4.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.4">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.4.4.1.1.4.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.4.2">â„’</ci><ci id="S3.E2X.2.1.1.m1.4.4.1.1.4.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.4.3">ğ‘›</ci></apply><apply id="S3.E2X.2.1.1.m1.4.4.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2"><times id="S3.E2X.2.1.1.m1.4.4.1.1.2.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.3"></times><apply id="S3.E2X.2.1.1.m1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1"><divide id="S3.E2X.2.1.1.m1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.1.1"></divide><cn type="integer" id="S3.E2X.2.1.1.m1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.3">1</cn><apply id="S3.E2X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1"><abs id="S3.E2X.2.1.1.m1.1.1.1.2.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.2"></abs><apply id="S3.E2X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.2">ğ’Ÿ</ci><ci id="S3.E2X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.3">ğ‘›</ci></apply></apply></apply><apply id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2"><apply id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3">subscript</csymbol><sum id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.2"></sum><apply id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3"><eq id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.1"></eq><ci id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.2">ğ‘—</ci><cn type="integer" id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E2X.2.1.1.m1.2.2.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1"><abs id="S3.E2X.2.1.1.m1.2.2.1.2.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.2"></abs><apply id="S3.E2X.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.2">ğ’Ÿ</ci><ci id="S3.E2X.2.1.1.m1.2.2.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.3">ğ‘›</ci></apply></apply></apply><apply id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2"><times id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.3"></times><apply id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.2">â„’</ci><apply id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3"><times id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.1"></times><ci id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.2">ğ‘</ci><ci id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.3">ğ‘™</ci><ci id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.4.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.4.3.4">ğ‘</ci></apply></apply><interval closure="open" id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2"><apply id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1"><times id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.2">ğ»</ci><ci id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.3">ğ‘›</ci></apply><apply id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1"><times id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.2">ğ¹</ci><times id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3"></times></apply><list id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E2X.2.1.1.m1.3.3.cmml" xref="S3.E2X.2.1.1.m1.3.3">ğ‘</ci><apply id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">P</mtext></ci><ci id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">ğ‘›</ci></apply><apply id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2a.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">z</mtext></ci><ci id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">ğ‘—</ci></apply></list></apply></apply><apply id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2">ğ‘¦</ci><ci id="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.3">ğ‘—</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.4c">\displaystyle\mathcal{L}_{n}=\frac{1}{\left|\mathcal{D}_{n}\right|}\sum_{j=1}^{\left|\mathcal{D}_{n}\right|}\mathcal{L}_{cla}\left(H_{n}\left(F^{*}\left(\left[c,\textbf{P}_{n},\mathtt{\textbf{z}}_{j}\right]\right)\right),y_{j}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.SSS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS1.p3.4" class="ltx_p">As a result, the client-specific prompts <math id="S3.SS2.SSS1.p3.1.m1.1" class="ltx_Math" alttext="\mathtt{\textbf{P}_{n}}" display="inline"><semantics id="S3.SS2.SSS1.p3.1.m1.1a"><msub id="S3.SS2.SSS1.p3.1.m1.1.1" xref="S3.SS2.SSS1.p3.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p3.1.m1.1.1.2" xref="S3.SS2.SSS1.p3.1.m1.1.1.2a.cmml">P</mtext><mi id="S3.SS2.SSS1.p3.1.m1.1.1.3" xref="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml">ğš—</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.1.m1.1b"><apply id="S3.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.1.m1.1.1.2a.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.2">P</mtext></ci><ci id="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.3">ğš—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.1.m1.1c">\mathtt{\textbf{P}_{n}}</annotation></semantics></math> can be optimized end-to-end by gradient decent (the same as <math id="S3.SS2.SSS1.p3.2.m2.1" class="ltx_Math" alttext="H_{n}" display="inline"><semantics id="S3.SS2.SSS1.p3.2.m2.1a"><msub id="S3.SS2.SSS1.p3.2.m2.1.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p3.2.m2.1.1.2" xref="S3.SS2.SSS1.p3.2.m2.1.1.2.cmml">H</mi><mi id="S3.SS2.SSS1.p3.2.m2.1.1.3" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.2.m2.1b"><apply id="S3.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.2">ğ»</ci><ci id="S3.SS2.SSS1.p3.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.2.m2.1c">H_{n}</annotation></semantics></math>) with learning rate <math id="S3.SS2.SSS1.p3.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS2.SSS1.p3.3.m3.1a"><mi id="S3.SS2.SSS1.p3.3.m3.1.1" xref="S3.SS2.SSS1.p3.3.m3.1.1.cmml">Î³</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.3.m3.1b"><ci id="S3.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1">ğ›¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.3.m3.1c">\gamma</annotation></semantics></math> as <math id="S3.SS2.SSS1.p3.4.m4.1" class="ltx_Math" alttext="\mathtt{\widetilde{\textbf{P}}_{n}}\leftarrow\mathtt{\textbf{P}_{n}}-\gamma\cdot\partial(\mathcal{L}_{n})/\partial\mathtt{\textbf{P}_{n}}" display="inline"><semantics id="S3.SS2.SSS1.p3.4.m4.1a"><mrow id="S3.SS2.SSS1.p3.4.m4.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.cmml"><msub id="S3.SS2.SSS1.p3.4.m4.1.1.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.cmml"><mover accent="true" id="S3.SS2.SSS1.p3.4.m4.1.1.3.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p3.4.m4.1.1.3.2.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.2.2a.cmml">P</mtext><mo id="S3.SS2.SSS1.p3.4.m4.1.1.3.2.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.2.1.cmml">~</mo></mover><mi id="S3.SS2.SSS1.p3.4.m4.1.1.3.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.3.cmml">ğš—</mi></msub><mo stretchy="false" id="S3.SS2.SSS1.p3.4.m4.1.1.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.2.cmml">â†</mo><mrow id="S3.SS2.SSS1.p3.4.m4.1.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.cmml"><msub id="S3.SS2.SSS1.p3.4.m4.1.1.1.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.2a.cmml">P</mtext><mi id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.3.cmml">ğš—</mi></msub><mo id="S3.SS2.SSS1.p3.4.m4.1.1.1.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.2.cmml">âˆ’</mo><mrow id="S3.SS2.SSS1.p3.4.m4.1.1.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.3.cmml">Î³</mi><mo lspace="0.222em" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.2.cmml">â‹…</mo><mrow id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.cmml"><mo lspace="0.055em" rspace="0em" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.2.cmml">âˆ‚</mo><mrow id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.cmml"><mrow id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.2.cmml">â„’</mi><mi id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.2.cmml">/</mo><mrow id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.cmml"><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.1.cmml">âˆ‚</mo><msub id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.2a.cmml">P</mtext><mi id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.3.cmml">ğš—</mi></msub></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.4.m4.1b"><apply id="S3.SS2.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1"><ci id="S3.SS2.SSS1.p3.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.2">â†</ci><apply id="S3.SS2.SSS1.p3.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.3">subscript</csymbol><apply id="S3.SS2.SSS1.p3.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.2"><ci id="S3.SS2.SSS1.p3.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.2.1">~</ci><ci id="S3.SS2.SSS1.p3.4.m4.1.1.3.2.2a.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p3.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.2.2">P</mtext></ci></apply><ci id="S3.SS2.SSS1.p3.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.3">ğš—</ci></apply><apply id="S3.SS2.SSS1.p3.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1"><minus id="S3.SS2.SSS1.p3.4.m4.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.2"></minus><apply id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.2a.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.2">P</mtext></ci><ci id="S3.SS2.SSS1.p3.4.m4.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.3.3">ğš—</ci></apply><apply id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1"><ci id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.2">â‹…</ci><ci id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.3">ğ›¾</ci><apply id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1"><partialdiff id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.2"></partialdiff><apply id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1"><divide id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.2"></divide><apply id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.2">â„’</ci><ci id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.1.1.1.3">ğ‘›</ci></apply><apply id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3"><partialdiff id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.1"></partialdiff><apply id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.2a.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.2">P</mtext></ci><ci id="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.1.1.1.3.2.3">ğš—</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.4.m4.1c">\mathtt{\widetilde{\textbf{P}}_{n}}\leftarrow\mathtt{\textbf{P}_{n}}-\gamma\cdot\partial(\mathcal{L}_{n})/\partial\mathtt{\textbf{P}_{n}}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.SSS1.p4" class="ltx_para">
<p id="S3.SS2.SSS1.p4.1" class="ltx_p">With personalized prompt adaptation, pFedPG is able to realize parameter-efficient model adaptation without requiring updating entire model parameters yet mitigating possible overfitting concerns and huge computation workloads.</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Personalized prompt generation at the server</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.1" class="ltx_p">Conventional FL methods (<span id="S3.SS2.SSS2.p1.1.1" class="ltx_text ltx_font_italic">e.g.,</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>) typically adopt average-based model aggregation at the server. However, this aggregation manner poses a significant risk of deviating from local data distributions and introduces massive communication overheads, especially when deploying large-scale models among heterogeneous clients. Recall that the prompts trained locally could be treated as client-specific parameters to adapt the frozen model to the client of interest. Instead of averaging model parameters or prompts from clients, we aim at learning a unique personalized prompt generation mechanism at the server to exploit cross-client knowledge and then produce personalized prompts that serve as a good initialization to facilitate efficient local adaptation. Since the server cannot access local private data, it is challenging to obtain the client-specific characteristics for encouraging the produced personalized prompts to boost local adaptation. In the following, we will elaborate on how our personalized prompt generation be learned in the FL scheme.</p>
</div>
<section id="S3.SS2.SSS2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Design and architecture</h5>

<div id="S3.SS2.SSS2.Px1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS2.Px1.p1.12" class="ltx_p">As illustrated in Fig.Â <a href="#S2.F2" title="Figure 2 â€£ Personalized Federated Learning (pFL) â€£ 2 Related Works â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(b), with the goal of generating personalized prompts <math id="S3.SS2.SSS2.Px1.p1.1.m1.2" class="ltx_Math" alttext="\{\textbf{P}_{1},...\textbf{P}_{N}\}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.1.m1.2a"><mrow id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.3" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.3.cmml">{</mo><msub id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.2a.cmml">P</mtext><mn id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.4" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.3.cmml">,</mo><mrow id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.2.cmml">â€¦</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.1" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.1.cmml">â€‹</mo><msub id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.2a.cmml">P</mtext><mi id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.3" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.3.cmml">N</mi></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.5" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.1.m1.2b"><set id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2"><apply id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.2a.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.2">P</mtext></ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2"><times id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.1"></times><ci id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.2">â€¦</ci><apply id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.2a.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.2">P</mtext></ci><ci id="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.2.2.2.2.3.3">ğ‘</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.1.m1.2c">\{\textbf{P}_{1},...\textbf{P}_{N}\}</annotation></semantics></math> for all <math id="S3.SS2.SSS2.Px1.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.2.m2.1a"><mi id="S3.SS2.SSS2.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.2.m2.1b"><ci id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.2.m2.1c">N</annotation></semantics></math> clients, our pFedPG learns to transform a set of client-agnostic prompt basis <math id="S3.SS2.SSS2.Px1.p1.3.m3.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.3.m3.1a"><msub id="S3.SS2.SSS2.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.2a.cmml">P</mtext><mrow id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.1" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.1a" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.4" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.1b" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.5" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.3.m3.1b"><apply id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.2a.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.2">P</mtext></ci><apply id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3"><times id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.1"></times><ci id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.2">ğ‘</ci><ci id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.3">ğ‘</ci><ci id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.4.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.4">ğ‘ </ci><ci id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.5.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.3.m3.1c">\textbf{P}_{base}</annotation></semantics></math> through a conditional prompt generator <math id="S3.SS2.SSS2.Px1.p1.4.m4.2" class="ltx_Math" alttext="G(\cdot;\varphi)" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.4.m4.2a"><mrow id="S3.SS2.SSS2.Px1.p1.4.m4.2.3" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.4.m4.2.3.2" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.3.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.4.m4.2.3.1" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.3.1.cmml">â€‹</mo><mrow id="S3.SS2.SSS2.Px1.p1.4.m4.2.3.3.2" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.4.m4.2.3.3.2.1" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.cmml">â‹…</mo><mo id="S3.SS2.SSS2.Px1.p1.4.m4.2.3.3.2.2" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.3.3.1.cmml">;</mo><mi id="S3.SS2.SSS2.Px1.p1.4.m4.2.2" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.2.cmml">Ï†</mi><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.4.m4.2.3.3.2.3" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.4.m4.2b"><apply id="S3.SS2.SSS2.Px1.p1.4.m4.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.3"><times id="S3.SS2.SSS2.Px1.p1.4.m4.2.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.3.1"></times><ci id="S3.SS2.SSS2.Px1.p1.4.m4.2.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.3.2">ğº</ci><list id="S3.SS2.SSS2.Px1.p1.4.m4.2.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.3.3.2"><ci id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1">â‹…</ci><ci id="S3.SS2.SSS2.Px1.p1.4.m4.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.2.2">ğœ‘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.4.m4.2c">G(\cdot;\varphi)</annotation></semantics></math> parameterized by <math id="S3.SS2.SSS2.Px1.p1.5.m5.1" class="ltx_Math" alttext="\varphi" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.5.m5.1a"><mi id="S3.SS2.SSS2.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1.cmml">Ï†</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.5.m5.1b"><ci id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1">ğœ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.5.m5.1c">\varphi</annotation></semantics></math> with the guidance of client descriptor <math id="S3.SS2.SSS2.Px1.p1.6.m6.1" class="ltx_Math" alttext="d_{n}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.6.m6.1a"><msub id="S3.SS2.SSS2.Px1.p1.6.m6.1.1" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.6.m6.1.1.2" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1.2.cmml">d</mi><mi id="S3.SS2.SSS2.Px1.p1.6.m6.1.1.3" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.6.m6.1b"><apply id="S3.SS2.SSS2.Px1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1.2">ğ‘‘</ci><ci id="S3.SS2.SSS2.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.6.m6.1c">d_{n}</annotation></semantics></math> selected from <math id="S3.SS2.SSS2.Px1.p1.7.m7.4" class="ltx_Math" alttext="D=\{d_{1},d_{2},...,d_{N}\}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.7.m7.4a"><mrow id="S3.SS2.SSS2.Px1.p1.7.m7.4.4" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.cmml"><mi id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.5" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.5.cmml">D</mi><mo id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.4" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.4.cmml">=</mo><mrow id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.4" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.4.cmml">{</mo><msub id="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1" xref="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1.2.cmml">d</mi><mn id="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.5" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2" xref="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2.2.cmml">d</mi><mn id="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2.3" xref="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.6" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS2.Px1.p1.7.m7.1.1" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.cmml">â€¦</mi><mo id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.7" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3.2" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3.3" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.8" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.7.m7.4b"><apply id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4"><eq id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.4.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.4"></eq><ci id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.5.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.5">ğ·</ci><set id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.4.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3"><apply id="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1.2">ğ‘‘</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2.2">ğ‘‘</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1">â€¦</ci><apply id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3.2">ğ‘‘</ci><ci id="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.4.4.3.3.3.3">ğ‘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.7.m7.4c">D=\{d_{1},d_{2},...,d_{N}\}</annotation></semantics></math>.
To be more specific, we realize the conditional prompt generator <math id="S3.SS2.SSS2.Px1.p1.8.m8.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.8.m8.1a"><mi id="S3.SS2.SSS2.Px1.p1.8.m8.1.1" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.8.m8.1b"><ci id="S3.SS2.SSS2.Px1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.8.m8.1c">G</annotation></semantics></math> based on cross-attentionÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> while the client-agnostic prompts <math id="S3.SS2.SSS2.Px1.p1.9.m9.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.9.m9.1a"><msub id="S3.SS2.SSS2.Px1.p1.9.m9.1.1" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2a.cmml">P</mtext><mrow id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.1" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.1a" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.4" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.1b" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.5" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.9.m9.1b"><apply id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2a.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2">P</mtext></ci><apply id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3"><times id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.1"></times><ci id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.2">ğ‘</ci><ci id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.3">ğ‘</ci><ci id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.4.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.4">ğ‘ </ci><ci id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.5.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.9.m9.1c">\textbf{P}_{base}</annotation></semantics></math> and the client descriptor <math id="S3.SS2.SSS2.Px1.p1.10.m10.1" class="ltx_Math" alttext="d_{n}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.10.m10.1a"><msub id="S3.SS2.SSS2.Px1.p1.10.m10.1.1" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.2" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.2.cmml">d</mi><mi id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.3" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.10.m10.1b"><apply id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.2">ğ‘‘</ci><ci id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.10.m10.1c">d_{n}</annotation></semantics></math> are expected to capture client-agnostic information and encode the client-specific characteristics, respectively.
As a result, generating personalized prompts could be achieved by retrieving client-relevant knowledge from <math id="S3.SS2.SSS2.Px1.p1.11.m11.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.11.m11.1a"><msub id="S3.SS2.SSS2.Px1.p1.11.m11.1.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2a.cmml">P</mtext><mrow id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.1a" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.4" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.1b" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.5" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.11.m11.1b"><apply id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2a.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2">P</mtext></ci><apply id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3"><times id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.1"></times><ci id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.2">ğ‘</ci><ci id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.3">ğ‘</ci><ci id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.4.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.4">ğ‘ </ci><ci id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.5.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.11.m11.1c">\textbf{P}_{base}</annotation></semantics></math> through the query of the client descriptor <math id="S3.SS2.SSS2.Px1.p1.12.m12.1" class="ltx_Math" alttext="d_{n}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.12.m12.1a"><msub id="S3.SS2.SSS2.Px1.p1.12.m12.1.1" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.2" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.2.cmml">d</mi><mi id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.3" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.12.m12.1b"><apply id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.2">ğ‘‘</ci><ci id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.12.m12.1c">d_{n}</annotation></semantics></math>, as formulated below,</p>
<table id="S3.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\textbf{P}_{n}" display="inline"><semantics id="S3.E3X.2.1.1.m1.1a"><msub id="S3.E3X.2.1.1.m1.1.1" xref="S3.E3X.2.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E3X.2.1.1.m1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.2a.cmml">P</mtext><mi id="S3.E3X.2.1.1.m1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.1b"><apply id="S3.E3X.2.1.1.m1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.1.1.2a.cmml" xref="S3.E3X.2.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.E3X.2.1.1.m1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.2">P</mtext></ci><ci id="S3.E3X.2.1.1.m1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.1c">\displaystyle\textbf{P}_{n}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3X.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle=G\left(\textbf{P}_{base},d_{n}\right)=\textbf{P}_{base}+\mathtt{Atten}\left(\mathcal{Q},\mathcal{K},\mathcal{V}\right)W^{\mathcal{O}}" display="inline"><semantics id="S3.E3X.3.2.2.m1.5a"><mrow id="S3.E3X.3.2.2.m1.5.5" xref="S3.E3X.3.2.2.m1.5.5.cmml"><mi id="S3.E3X.3.2.2.m1.5.5.4" xref="S3.E3X.3.2.2.m1.5.5.4.cmml"></mi><mo id="S3.E3X.3.2.2.m1.5.5.5" xref="S3.E3X.3.2.2.m1.5.5.5.cmml">=</mo><mrow id="S3.E3X.3.2.2.m1.5.5.2" xref="S3.E3X.3.2.2.m1.5.5.2.cmml"><mi id="S3.E3X.3.2.2.m1.5.5.2.4" xref="S3.E3X.3.2.2.m1.5.5.2.4.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.5.5.2.3" xref="S3.E3X.3.2.2.m1.5.5.2.3.cmml">â€‹</mo><mrow id="S3.E3X.3.2.2.m1.5.5.2.2.2" xref="S3.E3X.3.2.2.m1.5.5.2.2.3.cmml"><mo id="S3.E3X.3.2.2.m1.5.5.2.2.2.3" xref="S3.E3X.3.2.2.m1.5.5.2.2.3.cmml">(</mo><msub id="S3.E3X.3.2.2.m1.4.4.1.1.1.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.2a.cmml">P</mtext><mrow id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.cmml"><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.2" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.1" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.1.cmml">â€‹</mo><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.3" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.1a" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.1.cmml">â€‹</mo><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.4" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.1b" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.1.cmml">â€‹</mo><mi id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.5" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.5.cmml">e</mi></mrow></msub><mo id="S3.E3X.3.2.2.m1.5.5.2.2.2.4" xref="S3.E3X.3.2.2.m1.5.5.2.2.3.cmml">,</mo><msub id="S3.E3X.3.2.2.m1.5.5.2.2.2.2" xref="S3.E3X.3.2.2.m1.5.5.2.2.2.2.cmml"><mi id="S3.E3X.3.2.2.m1.5.5.2.2.2.2.2" xref="S3.E3X.3.2.2.m1.5.5.2.2.2.2.2.cmml">d</mi><mi id="S3.E3X.3.2.2.m1.5.5.2.2.2.2.3" xref="S3.E3X.3.2.2.m1.5.5.2.2.2.2.3.cmml">n</mi></msub><mo id="S3.E3X.3.2.2.m1.5.5.2.2.2.5" xref="S3.E3X.3.2.2.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3X.3.2.2.m1.5.5.6" xref="S3.E3X.3.2.2.m1.5.5.6.cmml">=</mo><mrow id="S3.E3X.3.2.2.m1.5.5.7" xref="S3.E3X.3.2.2.m1.5.5.7.cmml"><msub id="S3.E3X.3.2.2.m1.5.5.7.2" xref="S3.E3X.3.2.2.m1.5.5.7.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E3X.3.2.2.m1.5.5.7.2.2" xref="S3.E3X.3.2.2.m1.5.5.7.2.2a.cmml">P</mtext><mrow id="S3.E3X.3.2.2.m1.5.5.7.2.3" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.cmml"><mi id="S3.E3X.3.2.2.m1.5.5.7.2.3.2" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.5.5.7.2.3.1" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.1.cmml">â€‹</mo><mi id="S3.E3X.3.2.2.m1.5.5.7.2.3.3" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.5.5.7.2.3.1a" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.1.cmml">â€‹</mo><mi id="S3.E3X.3.2.2.m1.5.5.7.2.3.4" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.5.5.7.2.3.1b" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.1.cmml">â€‹</mo><mi id="S3.E3X.3.2.2.m1.5.5.7.2.3.5" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.5.cmml">e</mi></mrow></msub><mo id="S3.E3X.3.2.2.m1.5.5.7.1" xref="S3.E3X.3.2.2.m1.5.5.7.1.cmml">+</mo><mrow id="S3.E3X.3.2.2.m1.5.5.7.3" xref="S3.E3X.3.2.2.m1.5.5.7.3.cmml"><mi id="S3.E3X.3.2.2.m1.5.5.7.3.2" xref="S3.E3X.3.2.2.m1.5.5.7.3.2.cmml">ğ™°ğšğšğšğš—</mi><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.5.5.7.3.1" xref="S3.E3X.3.2.2.m1.5.5.7.3.1.cmml">â€‹</mo><mrow id="S3.E3X.3.2.2.m1.5.5.7.3.3.2" xref="S3.E3X.3.2.2.m1.5.5.7.3.3.1.cmml"><mo id="S3.E3X.3.2.2.m1.5.5.7.3.3.2.1" xref="S3.E3X.3.2.2.m1.5.5.7.3.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3X.3.2.2.m1.1.1" xref="S3.E3X.3.2.2.m1.1.1.cmml">ğ’¬</mi><mo id="S3.E3X.3.2.2.m1.5.5.7.3.3.2.2" xref="S3.E3X.3.2.2.m1.5.5.7.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3X.3.2.2.m1.2.2" xref="S3.E3X.3.2.2.m1.2.2.cmml">ğ’¦</mi><mo id="S3.E3X.3.2.2.m1.5.5.7.3.3.2.3" xref="S3.E3X.3.2.2.m1.5.5.7.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3X.3.2.2.m1.3.3" xref="S3.E3X.3.2.2.m1.3.3.cmml">ğ’±</mi><mo id="S3.E3X.3.2.2.m1.5.5.7.3.3.2.4" xref="S3.E3X.3.2.2.m1.5.5.7.3.3.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.5.5.7.3.1a" xref="S3.E3X.3.2.2.m1.5.5.7.3.1.cmml">â€‹</mo><msup id="S3.E3X.3.2.2.m1.5.5.7.3.4" xref="S3.E3X.3.2.2.m1.5.5.7.3.4.cmml"><mi id="S3.E3X.3.2.2.m1.5.5.7.3.4.2" xref="S3.E3X.3.2.2.m1.5.5.7.3.4.2.cmml">W</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3X.3.2.2.m1.5.5.7.3.4.3" xref="S3.E3X.3.2.2.m1.5.5.7.3.4.3.cmml">ğ’ª</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.3.2.2.m1.5b"><apply id="S3.E3X.3.2.2.m1.5.5.cmml" xref="S3.E3X.3.2.2.m1.5.5"><and id="S3.E3X.3.2.2.m1.5.5a.cmml" xref="S3.E3X.3.2.2.m1.5.5"></and><apply id="S3.E3X.3.2.2.m1.5.5b.cmml" xref="S3.E3X.3.2.2.m1.5.5"><eq id="S3.E3X.3.2.2.m1.5.5.5.cmml" xref="S3.E3X.3.2.2.m1.5.5.5"></eq><csymbol cd="latexml" id="S3.E3X.3.2.2.m1.5.5.4.cmml" xref="S3.E3X.3.2.2.m1.5.5.4">absent</csymbol><apply id="S3.E3X.3.2.2.m1.5.5.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.2"><times id="S3.E3X.3.2.2.m1.5.5.2.3.cmml" xref="S3.E3X.3.2.2.m1.5.5.2.3"></times><ci id="S3.E3X.3.2.2.m1.5.5.2.4.cmml" xref="S3.E3X.3.2.2.m1.5.5.2.4">ğº</ci><interval closure="open" id="S3.E3X.3.2.2.m1.5.5.2.2.3.cmml" xref="S3.E3X.3.2.2.m1.5.5.2.2.2"><apply id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.2a.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.2">P</mtext></ci><apply id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3"><times id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.1"></times><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.2">ğ‘</ci><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.3">ğ‘</ci><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.4.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.4">ğ‘ </ci><ci id="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.5.cmml" xref="S3.E3X.3.2.2.m1.4.4.1.1.1.1.3.5">ğ‘’</ci></apply></apply><apply id="S3.E3X.3.2.2.m1.5.5.2.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.5.5.2.2.2.2.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.2.2.2.2">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.5.5.2.2.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.2.2.2.2.2">ğ‘‘</ci><ci id="S3.E3X.3.2.2.m1.5.5.2.2.2.2.3.cmml" xref="S3.E3X.3.2.2.m1.5.5.2.2.2.2.3">ğ‘›</ci></apply></interval></apply></apply><apply id="S3.E3X.3.2.2.m1.5.5c.cmml" xref="S3.E3X.3.2.2.m1.5.5"><eq id="S3.E3X.3.2.2.m1.5.5.6.cmml" xref="S3.E3X.3.2.2.m1.5.5.6"></eq><share href="#S3.E3X.3.2.2.m1.5.5.2.cmml" id="S3.E3X.3.2.2.m1.5.5d.cmml" xref="S3.E3X.3.2.2.m1.5.5"></share><apply id="S3.E3X.3.2.2.m1.5.5.7.cmml" xref="S3.E3X.3.2.2.m1.5.5.7"><plus id="S3.E3X.3.2.2.m1.5.5.7.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.1"></plus><apply id="S3.E3X.3.2.2.m1.5.5.7.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.5.5.7.2.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.2">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.5.5.7.2.2a.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E3X.3.2.2.m1.5.5.7.2.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.2.2">P</mtext></ci><apply id="S3.E3X.3.2.2.m1.5.5.7.2.3.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.2.3"><times id="S3.E3X.3.2.2.m1.5.5.7.2.3.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.1"></times><ci id="S3.E3X.3.2.2.m1.5.5.7.2.3.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.2">ğ‘</ci><ci id="S3.E3X.3.2.2.m1.5.5.7.2.3.3.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.3">ğ‘</ci><ci id="S3.E3X.3.2.2.m1.5.5.7.2.3.4.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.4">ğ‘ </ci><ci id="S3.E3X.3.2.2.m1.5.5.7.2.3.5.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.2.3.5">ğ‘’</ci></apply></apply><apply id="S3.E3X.3.2.2.m1.5.5.7.3.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.3"><times id="S3.E3X.3.2.2.m1.5.5.7.3.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.3.1"></times><ci id="S3.E3X.3.2.2.m1.5.5.7.3.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.3.2">ğ™°ğšğšğšğš—</ci><vector id="S3.E3X.3.2.2.m1.5.5.7.3.3.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.3.3.2"><ci id="S3.E3X.3.2.2.m1.1.1.cmml" xref="S3.E3X.3.2.2.m1.1.1">ğ’¬</ci><ci id="S3.E3X.3.2.2.m1.2.2.cmml" xref="S3.E3X.3.2.2.m1.2.2">ğ’¦</ci><ci id="S3.E3X.3.2.2.m1.3.3.cmml" xref="S3.E3X.3.2.2.m1.3.3">ğ’±</ci></vector><apply id="S3.E3X.3.2.2.m1.5.5.7.3.4.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.3.4"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.5.5.7.3.4.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.3.4">superscript</csymbol><ci id="S3.E3X.3.2.2.m1.5.5.7.3.4.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.3.4.2">ğ‘Š</ci><ci id="S3.E3X.3.2.2.m1.5.5.7.3.4.3.cmml" xref="S3.E3X.3.2.2.m1.5.5.7.3.4.3">ğ’ª</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.3.2.2.m1.5c">\displaystyle=G\left(\textbf{P}_{base},d_{n}\right)=\textbf{P}_{base}+\mathtt{Atten}\left(\mathcal{Q},\mathcal{K},\mathcal{V}\right)W^{\mathcal{O}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr id="S3.E3Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xa.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle=\textbf{P}_{base}+\mathtt{Softmax}(\frac{\mathcal{Q}\mathcal{K}^{T}}{\sqrt{l_{k}}})\mathcal{V}W^{\mathcal{O}}," display="inline"><semantics id="S3.E3Xa.2.1.1.m1.2a"><mrow id="S3.E3Xa.2.1.1.m1.2.2.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.cmml"></mi><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.cmml"><msub id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.2a.cmml">P</mtext><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.1a" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.4" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.1b" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.5" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.5.cmml">e</mi></mrow></msub><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.1.cmml">+</mo><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.2.cmml">ğš‚ğš˜ğšğšğš–ğšŠğš¡</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.1.cmml">â€‹</mo><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.3.2" xref="S3.E3Xa.2.1.1.m1.1.1.cmml"><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.3.2.1" xref="S3.E3Xa.2.1.1.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S3.E3Xa.2.1.1.m1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.cmml"><mfrac id="S3.E3Xa.2.1.1.m1.1.1a" xref="S3.E3Xa.2.1.1.m1.1.1.cmml"><mrow id="S3.E3Xa.2.1.1.m1.1.1.2" xref="S3.E3Xa.2.1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.1.1.2.2" xref="S3.E3Xa.2.1.1.m1.1.1.2.2.cmml">ğ’¬</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.1.1.2.1" xref="S3.E3Xa.2.1.1.m1.1.1.2.1.cmml">â€‹</mo><msup id="S3.E3Xa.2.1.1.m1.1.1.2.3" xref="S3.E3Xa.2.1.1.m1.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.1.1.2.3.2" xref="S3.E3Xa.2.1.1.m1.1.1.2.3.2.cmml">ğ’¦</mi><mi id="S3.E3Xa.2.1.1.m1.1.1.2.3.3" xref="S3.E3Xa.2.1.1.m1.1.1.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S3.E3Xa.2.1.1.m1.1.1.3" xref="S3.E3Xa.2.1.1.m1.1.1.3.cmml"><msub id="S3.E3Xa.2.1.1.m1.1.1.3.2" xref="S3.E3Xa.2.1.1.m1.1.1.3.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.3.2.2" xref="S3.E3Xa.2.1.1.m1.1.1.3.2.2.cmml">l</mi><mi id="S3.E3Xa.2.1.1.m1.1.1.3.2.3" xref="S3.E3Xa.2.1.1.m1.1.1.3.2.3.cmml">k</mi></msub></msqrt></mfrac></mstyle><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.3.2.2" xref="S3.E3Xa.2.1.1.m1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.1a" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.1.cmml">â€‹</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.4" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.4.cmml">ğ’±</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.1b" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.1.cmml">â€‹</mo><msup id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5.2.cmml">W</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5.3.cmml">ğ’ª</mi></msup></mrow></mrow></mrow><mo id="S3.E3Xa.2.1.1.m1.2.2.1.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.2b"><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1"><eq id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1"></eq><csymbol cd="latexml" id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2">absent</csymbol><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3"><plus id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.1"></plus><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.2a.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.2">P</mtext></ci><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3"><times id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.1"></times><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.2">ğ‘</ci><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.3">ğ‘</ci><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.4.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.4">ğ‘ </ci><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.5.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.2.3.5">ğ‘’</ci></apply></apply><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3"><times id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.1"></times><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.2">ğš‚ğš˜ğšğšğš–ğšŠğš¡</ci><apply id="S3.E3Xa.2.1.1.m1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.3.2"><divide id="S3.E3Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.3.2"></divide><apply id="S3.E3Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.2"><times id="S3.E3Xa.2.1.1.m1.1.1.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.2.1"></times><ci id="S3.E3Xa.2.1.1.m1.1.1.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.2.2">ğ’¬</ci><apply id="S3.E3Xa.2.1.1.m1.1.1.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.2.3">superscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.2.3.2">ğ’¦</ci><ci id="S3.E3Xa.2.1.1.m1.1.1.2.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.2.3.3">ğ‘‡</ci></apply></apply><apply id="S3.E3Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.3"><root id="S3.E3Xa.2.1.1.m1.1.1.3a.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.3"></root><apply id="S3.E3Xa.2.1.1.m1.1.1.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.3.2.2">ğ‘™</ci><ci id="S3.E3Xa.2.1.1.m1.1.1.3.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.3.2.3">ğ‘˜</ci></apply></apply></apply><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.4.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.4">ğ’±</ci><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5">superscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5.2">ğ‘Š</ci><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.3.5.3">ğ’ª</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.2c">\displaystyle=\textbf{P}_{base}+\mathtt{Softmax}(\frac{\mathcal{Q}\mathcal{K}^{T}}{\sqrt{l_{k}}})\mathcal{V}W^{\mathcal{O}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<table id="S3.Ex1" class="ltx_equationgroup ltx_eqn_table">

<tbody id="S3.Ex1X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1X.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\text{where}\quad\mathcal{Q}=[d_{n}]W^{\mathcal{Q}},\mathcal{K}=\textbf{P}_{base}W^{\mathcal{K}},\mathcal{V}=\textbf{P}_{base}W^{\mathcal{V}}," display="inline"><semantics id="S3.Ex1X.2.1.1.m1.3a"><mrow id="S3.Ex1X.2.1.1.m1.3.3.1"><mrow id="S3.Ex1X.2.1.1.m1.3.3.1.1.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.3.cmml"><mrow id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.cmml"><mrow id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.3.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.3.1.cmml"><mtext id="S3.Ex1X.2.1.1.m1.1.1" xref="S3.Ex1X.2.1.1.m1.1.1a.cmml">where</mtext><mspace width="1em" id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.3.2.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.3.1.cmml"></mspace><mi class="ltx_font_mathcaligraphic" id="S3.Ex1X.2.1.1.m1.2.2" xref="S3.Ex1X.2.1.1.m1.2.2.cmml">ğ’¬</mi></mrow><mo id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.cmml"><mrow id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml">[</mo><msub id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">d</mi><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.2.cmml">â€‹</mo><msup id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3.2.cmml">W</mi><mi class="ltx_font_mathcaligraphic" id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3.3.cmml">ğ’¬</mi></msup></mrow></mrow><mo id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.3.cmml"><mrow id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.2.cmml">ğ’¦</mi><mo id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.1.cmml">=</mo><mrow id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.cmml"><msub id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.2a.cmml">P</mtext><mrow id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.cmml"><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.1a" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.4" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.1b" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.5" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.5.cmml">e</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.1.cmml">â€‹</mo><msup id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3.cmml"><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3.2.cmml">W</mi><mi class="ltx_font_mathcaligraphic" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3.3.cmml">ğ’¦</mi></msup></mrow></mrow><mo id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.3a.cmml">,</mo><mrow id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.2.cmml">ğ’±</mi><mo id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.1.cmml">=</mo><mrow id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.cmml"><msub id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.2a.cmml">P</mtext><mrow id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.cmml"><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.1.cmml">â€‹</mo><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.1a" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.1.cmml">â€‹</mo><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.4" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.1b" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.1.cmml">â€‹</mo><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.5" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.5.cmml">e</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.1.cmml">â€‹</mo><msup id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3.cmml"><mi id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3.2" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3.2.cmml">W</mi><mi class="ltx_font_mathcaligraphic" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3.3" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3.3.cmml">ğ’±</mi></msup></mrow></mrow></mrow></mrow><mo id="S3.Ex1X.2.1.1.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.2.1.1.m1.3b"><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.2.1.1.m1.3.3.1.1.3a.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1"><eq id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.2"></eq><list id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.3.2"><ci id="S3.Ex1X.2.1.1.m1.1.1a.cmml" xref="S3.Ex1X.2.1.1.m1.1.1"><mtext id="S3.Ex1X.2.1.1.m1.1.1.cmml" xref="S3.Ex1X.2.1.1.m1.1.1">where</mtext></ci><ci id="S3.Ex1X.2.1.1.m1.2.2.cmml" xref="S3.Ex1X.2.1.1.m1.2.2">ğ’¬</ci></list><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1"><times id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.2"></times><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2">ğ‘‘</ci><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3">ğ‘›</ci></apply></apply><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3.2">ğ‘Š</ci><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.1.1.1.3.3">ğ’¬</ci></apply></apply></apply><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.3a.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1"><eq id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.1"></eq><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.2">ğ’¦</ci><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3"><times id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.1"></times><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2">subscript</csymbol><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.2a.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.2">P</mtext></ci><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3"><times id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.1"></times><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.2">ğ‘</ci><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.3">ğ‘</ci><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.4.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.4">ğ‘ </ci><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.5.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.2.3.5">ğ‘’</ci></apply></apply><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3">superscript</csymbol><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3.2">ğ‘Š</ci><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.1.1.3.3.3">ğ’¦</ci></apply></apply></apply><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2"><eq id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.1"></eq><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.2">ğ’±</ci><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3"><times id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.1"></times><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2">subscript</csymbol><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.2a.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.2">P</mtext></ci><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3"><times id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.1"></times><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.2">ğ‘</ci><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.3">ğ‘</ci><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.4.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.4">ğ‘ </ci><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.5.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.2.3.5">ğ‘’</ci></apply></apply><apply id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3">superscript</csymbol><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3.2">ğ‘Š</ci><ci id="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1.1.2.2.2.2.3.3.3">ğ’±</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.2.1.1.m1.3c">\displaystyle\text{where}\quad\mathcal{Q}=[d_{n}]W^{\mathcal{Q}},\mathcal{K}=\textbf{P}_{base}W^{\mathcal{K}},\mathcal{V}=\textbf{P}_{base}W^{\mathcal{V}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.Px1.p1.20" class="ltx_p">where <math id="S3.SS2.SSS2.Px1.p1.13.m1.1" class="ltx_Math" alttext="\sqrt{l_{k}}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.13.m1.1a"><msqrt id="S3.SS2.SSS2.Px1.p1.13.m1.1.1" xref="S3.SS2.SSS2.Px1.p1.13.m1.1.1.cmml"><msub id="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2.2" xref="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2.2.cmml">l</mi><mi id="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2.3" xref="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2.3.cmml">k</mi></msub></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.13.m1.1b"><apply id="S3.SS2.SSS2.Px1.p1.13.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m1.1.1"><root id="S3.SS2.SSS2.Px1.p1.13.m1.1.1a.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m1.1.1"></root><apply id="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2.2">ğ‘™</ci><ci id="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m1.1.1.2.3">ğ‘˜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.13.m1.1c">\sqrt{l_{k}}</annotation></semantics></math> is a scaling factor and <math id="S3.SS2.SSS2.Px1.p1.14.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.14.m2.1a"><mi id="S3.SS2.SSS2.Px1.p1.14.m2.1.1" xref="S3.SS2.SSS2.Px1.p1.14.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.14.m2.1b"><ci id="S3.SS2.SSS2.Px1.p1.14.m2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m2.1.1">ğ‘™</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.14.m2.1c">l</annotation></semantics></math> is the embedding dimension. <math id="S3.SS2.SSS2.Px1.p1.15.m3.1" class="ltx_Math" alttext="W^{\mathcal{Q}}\in\mathbb{R}^{l\times l_{k}}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.15.m3.1a"><mrow id="S3.SS2.SSS2.Px1.p1.15.m3.1.1" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.cmml"><msup id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2.2" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2.2.cmml">W</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2.3" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2.3.cmml">ğ’¬</mi></msup><mo id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.1" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.1.cmml">âˆˆ</mo><msup id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.2.cmml">â„</mi><mrow id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.2" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.2.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.1" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.1.cmml">Ã—</mo><msub id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3.2.cmml">l</mi><mi id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.15.m3.1b"><apply id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1"><in id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.1"></in><apply id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2.2">ğ‘Š</ci><ci id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.2.3">ğ’¬</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.2">â„</ci><apply id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3"><times id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.1"></times><ci id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.2">ğ‘™</ci><apply id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3.2">ğ‘™</ci><ci id="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m3.1.1.3.3.3.3">ğ‘˜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.15.m3.1c">W^{\mathcal{Q}}\in\mathbb{R}^{l\times l_{k}}</annotation></semantics></math>, <math id="S3.SS2.SSS2.Px1.p1.16.m4.1" class="ltx_Math" alttext="W^{\mathcal{K}}\in\mathbb{R}^{l\times l_{k}}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.16.m4.1a"><mrow id="S3.SS2.SSS2.Px1.p1.16.m4.1.1" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.cmml"><msup id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2.2" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2.2.cmml">W</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2.3" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2.3.cmml">ğ’¦</mi></msup><mo id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.1" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.1.cmml">âˆˆ</mo><msup id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.2.cmml">â„</mi><mrow id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.2" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.2.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.1" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.1.cmml">Ã—</mo><msub id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3.2.cmml">l</mi><mi id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.16.m4.1b"><apply id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1"><in id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.1"></in><apply id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2.2">ğ‘Š</ci><ci id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.2.3">ğ’¦</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.2">â„</ci><apply id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3"><times id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.1"></times><ci id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.2">ğ‘™</ci><apply id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3.2">ğ‘™</ci><ci id="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m4.1.1.3.3.3.3">ğ‘˜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.16.m4.1c">W^{\mathcal{K}}\in\mathbb{R}^{l\times l_{k}}</annotation></semantics></math>, <math id="S3.SS2.SSS2.Px1.p1.17.m5.1" class="ltx_Math" alttext="W^{\mathcal{V}}\in\mathbb{R}^{l\times l_{v}}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.17.m5.1a"><mrow id="S3.SS2.SSS2.Px1.p1.17.m5.1.1" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.cmml"><msup id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2.2" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2.2.cmml">W</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2.3" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2.3.cmml">ğ’±</mi></msup><mo id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.1" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.1.cmml">âˆˆ</mo><msup id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.2.cmml">â„</mi><mrow id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.2" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.2.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.1" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.1.cmml">Ã—</mo><msub id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3.2" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3.2.cmml">l</mi><mi id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3.3" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.17.m5.1b"><apply id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1"><in id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.1"></in><apply id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2.2">ğ‘Š</ci><ci id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.2.3">ğ’±</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.2">â„</ci><apply id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3"><times id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.1"></times><ci id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.2">ğ‘™</ci><apply id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3.2">ğ‘™</ci><ci id="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m5.1.1.3.3.3.3">ğ‘£</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.17.m5.1c">W^{\mathcal{V}}\in\mathbb{R}^{l\times l_{v}}</annotation></semantics></math>, and <math id="S3.SS2.SSS2.Px1.p1.18.m6.1" class="ltx_Math" alttext="W^{\mathcal{O}}\in\mathbb{R}^{l_{v}\times l}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.18.m6.1a"><mrow id="S3.SS2.SSS2.Px1.p1.18.m6.1.1" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.cmml"><msup id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2.2" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2.2.cmml">W</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2.3" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2.3.cmml">ğ’ª</mi></msup><mo id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.1" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.1.cmml">âˆˆ</mo><msup id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.2.cmml">â„</mi><mrow id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.cmml"><msub id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2.2" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2.2.cmml">l</mi><mi id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2.3" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2.3.cmml">v</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.1" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.1.cmml">Ã—</mo><mi id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.3" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.3.cmml">l</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.18.m6.1b"><apply id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1"><in id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.1"></in><apply id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2.2">ğ‘Š</ci><ci id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.2.3">ğ’ª</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.2">â„</ci><apply id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3"><times id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.1"></times><apply id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2.2">ğ‘™</ci><ci id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.2.3">ğ‘£</ci></apply><ci id="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m6.1.1.3.3.3">ğ‘™</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.18.m6.1c">W^{\mathcal{O}}\in\mathbb{R}^{l_{v}\times l}</annotation></semantics></math> are learnable projection matrixes, where <math id="S3.SS2.SSS2.Px1.p1.19.m7.1" class="ltx_Math" alttext="l_{k}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.19.m7.1a"><msub id="S3.SS2.SSS2.Px1.p1.19.m7.1.1" xref="S3.SS2.SSS2.Px1.p1.19.m7.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.19.m7.1.1.2" xref="S3.SS2.SSS2.Px1.p1.19.m7.1.1.2.cmml">l</mi><mi id="S3.SS2.SSS2.Px1.p1.19.m7.1.1.3" xref="S3.SS2.SSS2.Px1.p1.19.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.19.m7.1b"><apply id="S3.SS2.SSS2.Px1.p1.19.m7.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.19.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.19.m7.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.19.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.19.m7.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.19.m7.1.1.2">ğ‘™</ci><ci id="S3.SS2.SSS2.Px1.p1.19.m7.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.19.m7.1.1.3">ğ‘˜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.19.m7.1c">l_{k}</annotation></semantics></math> and <math id="S3.SS2.SSS2.Px1.p1.20.m8.1" class="ltx_Math" alttext="l_{v}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.20.m8.1a"><msub id="S3.SS2.SSS2.Px1.p1.20.m8.1.1" xref="S3.SS2.SSS2.Px1.p1.20.m8.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.20.m8.1.1.2" xref="S3.SS2.SSS2.Px1.p1.20.m8.1.1.2.cmml">l</mi><mi id="S3.SS2.SSS2.Px1.p1.20.m8.1.1.3" xref="S3.SS2.SSS2.Px1.p1.20.m8.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.20.m8.1b"><apply id="S3.SS2.SSS2.Px1.p1.20.m8.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.20.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.20.m8.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.20.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.20.m8.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.20.m8.1.1.2">ğ‘™</ci><ci id="S3.SS2.SSS2.Px1.p1.20.m8.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.20.m8.1.1.3">ğ‘£</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.20.m8.1c">l_{v}</annotation></semantics></math> are internal dimensions, as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>.</p>
</div>
</section>
<section id="S3.SS2.SSS2.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Learning of personalized prompt generation</h5>

<div id="S3.SS2.SSS2.Px2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.Px2.p1.6" class="ltx_p">As the goal of personalized prompts is to serve as a good initialization for each client that facilitates the local adaptation, we learn our personalized prompt generation module (<span id="S3.SS2.SSS2.Px2.p1.6.1" class="ltx_text ltx_font_italic">i.e.,</span> <math id="S3.SS2.SSS2.Px2.p1.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.1.m1.1a"><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.1.m1.1b"><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.1.m1.1c">G</annotation></semantics></math>, <math id="S3.SS2.SSS2.Px2.p1.2.m2.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.2.m2.1a"><msub id="S3.SS2.SSS2.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2a.cmml">P</mtext><mrow id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.1" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.1a" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.4" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.1b" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.5" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.2.m2.1b"><apply id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2">P</mtext></ci><apply id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3"><times id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.1"></times><ci id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.2">ğ‘</ci><ci id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.3">ğ‘</ci><ci id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.4.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.4">ğ‘ </ci><ci id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.5.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.2.m2.1c">\textbf{P}_{base}</annotation></semantics></math> and <math id="S3.SS2.SSS2.Px2.p1.3.m3.1" class="ltx_Math" alttext="d_{n}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.3.m3.1a"><msub id="S3.SS2.SSS2.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.cmml">d</mi><mi id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.3.m3.1b"><apply id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2">ğ‘‘</ci><ci id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.3.m3.1c">d_{n}</annotation></semantics></math>) through the training rewards observed from the local optimization process.
Inspired byÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, the change of prompts after local training <math id="S3.SS2.SSS2.Px2.p1.4.m4.1" class="ltx_Math" alttext="\Delta\textbf{P}_{n}=\widetilde{\textbf{P}_{n}}-\textbf{P}_{n}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.4.m4.1a"><mrow id="S3.SS2.SSS2.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.cmml"><mrow id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.2.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.1.cmml">â€‹</mo><msub id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.2a.cmml">P</mtext><mi id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.3.cmml">n</mi></msub></mrow><mo id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.cmml"><mover accent="true" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.cmml"><msub id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.2a.cmml">P</mtext><mi id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.3.cmml">n</mi></msub><mo id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.1.cmml">~</mo></mover><mo id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.1.cmml">âˆ’</mo><msub id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.2a.cmml">P</mtext><mi id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.3.cmml">n</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.4.m4.1b"><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1"><eq id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1"></eq><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2"><times id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.1"></times><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.2">Î”</ci><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.2">P</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.3">ğ‘›</ci></apply></apply><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3"><minus id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.1"></minus><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2"><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.1">~</ci><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.2">P</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.2.2.3">ğ‘›</ci></apply></apply><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.2">P</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.3.3.3">ğ‘›</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.4.m4.1c">\Delta\textbf{P}_{n}=\widetilde{\textbf{P}_{n}}-\textbf{P}_{n}</annotation></semantics></math> indicates the direction of local optimization at client <math id="S3.SS2.SSS2.Px2.p1.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.5.m5.1a"><mi id="S3.SS2.SSS2.Px2.p1.5.m5.1.1" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.5.m5.1b"><ci id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.5.m5.1c">n</annotation></semantics></math> that could be treated as training feedback, assessing the quality of the server-generated prompt initialization for each client.
With <math id="S3.SS2.SSS2.Px2.p1.6.m6.1" class="ltx_Math" alttext="\Delta\textbf{P}_{n}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.6.m6.1a"><mrow id="S3.SS2.SSS2.Px2.p1.6.m6.1.1" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.2" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.2.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.cmml">â€‹</mo><msub id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.2a.cmml">P</mtext><mi id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.6.m6.1b"><apply id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1"><times id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1"></times><ci id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.2">Î”</ci><apply id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.2">P</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.3.3">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.6.m6.1c">\Delta\textbf{P}_{n}</annotation></semantics></math> observed, we are capable of training our pFedPG end-to-end via gradient descent.</p>
</div>
<div id="S3.SS2.SSS2.Px2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS2.Px2.p2.1" class="ltx_p">To be more specific, the update of the conditional prompt generator <math id="S3.SS2.SSS2.Px2.p2.1.m1.2" class="ltx_Math" alttext="G(\cdot;\varphi)" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.1.m1.2a"><mrow id="S3.SS2.SSS2.Px2.p2.1.m1.2.3" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.1.m1.2.3.2" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.3.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.1.m1.2.3.1" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.3.1.cmml">â€‹</mo><mrow id="S3.SS2.SSS2.Px2.p2.1.m1.2.3.3.2" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.1.m1.2.3.3.2.1" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.1.m1.1.1" xref="S3.SS2.SSS2.Px2.p2.1.m1.1.1.cmml">â‹…</mo><mo id="S3.SS2.SSS2.Px2.p2.1.m1.2.3.3.2.2" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.3.3.1.cmml">;</mo><mi id="S3.SS2.SSS2.Px2.p2.1.m1.2.2" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.2.cmml">Ï†</mi><mo stretchy="false" id="S3.SS2.SSS2.Px2.p2.1.m1.2.3.3.2.3" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.1.m1.2b"><apply id="S3.SS2.SSS2.Px2.p2.1.m1.2.3.cmml" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.3"><times id="S3.SS2.SSS2.Px2.p2.1.m1.2.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.3.1"></times><ci id="S3.SS2.SSS2.Px2.p2.1.m1.2.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.3.2">ğº</ci><list id="S3.SS2.SSS2.Px2.p2.1.m1.2.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.3.3.2"><ci id="S3.SS2.SSS2.Px2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.1.m1.1.1">â‹…</ci><ci id="S3.SS2.SSS2.Px2.p2.1.m1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.1.m1.2.2">ğœ‘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.1.m1.2c">G(\cdot;\varphi)</annotation></semantics></math> can be derived by the gradients computed locally and expressed by the chain rule as</p>
<table id="S3.E4" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E4X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\Delta\varphi=\nabla_{\varphi}\mathcal{L}_{n}" display="inline"><semantics id="S3.E4X.2.1.1.m1.1a"><mrow id="S3.E4X.2.1.1.m1.1.1" xref="S3.E4X.2.1.1.m1.1.1.cmml"><mrow id="S3.E4X.2.1.1.m1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.2.cmml"><mi mathvariant="normal" id="S3.E4X.2.1.1.m1.1.1.2.2" xref="S3.E4X.2.1.1.m1.1.1.2.2.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.1.1.2.1" xref="S3.E4X.2.1.1.m1.1.1.2.1.cmml">â€‹</mo><mi id="S3.E4X.2.1.1.m1.1.1.2.3" xref="S3.E4X.2.1.1.m1.1.1.2.3.cmml">Ï†</mi></mrow><mo id="S3.E4X.2.1.1.m1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.cmml">=</mo><mrow id="S3.E4X.2.1.1.m1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.3.cmml"><msub id="S3.E4X.2.1.1.m1.1.1.3.1" xref="S3.E4X.2.1.1.m1.1.1.3.1.cmml"><mo rspace="0.167em" id="S3.E4X.2.1.1.m1.1.1.3.1.2" xref="S3.E4X.2.1.1.m1.1.1.3.1.2.cmml">âˆ‡</mo><mi id="S3.E4X.2.1.1.m1.1.1.3.1.3" xref="S3.E4X.2.1.1.m1.1.1.3.1.3.cmml">Ï†</mi></msub><msub id="S3.E4X.2.1.1.m1.1.1.3.2" xref="S3.E4X.2.1.1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4X.2.1.1.m1.1.1.3.2.2" xref="S3.E4X.2.1.1.m1.1.1.3.2.2.cmml">â„’</mi><mi id="S3.E4X.2.1.1.m1.1.1.3.2.3" xref="S3.E4X.2.1.1.m1.1.1.3.2.3.cmml">n</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.1b"><apply id="S3.E4X.2.1.1.m1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1"><eq id="S3.E4X.2.1.1.m1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1"></eq><apply id="S3.E4X.2.1.1.m1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.2"><times id="S3.E4X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.2.1"></times><ci id="S3.E4X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.2.2">Î”</ci><ci id="S3.E4X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.2.3">ğœ‘</ci></apply><apply id="S3.E4X.2.1.1.m1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.3"><apply id="S3.E4X.2.1.1.m1.1.1.3.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.3.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.1">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.1.1.3.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.1.2">âˆ‡</ci><ci id="S3.E4X.2.1.1.m1.1.1.3.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.1.3">ğœ‘</ci></apply><apply id="S3.E4X.2.1.1.m1.1.1.3.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.3.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.1.1.3.2.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.2.2">â„’</ci><ci id="S3.E4X.2.1.1.m1.1.1.3.2.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.2.3">ğ‘›</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.1c">\displaystyle\Delta\varphi=\nabla_{\varphi}\mathcal{L}_{n}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=(\nabla_{\varphi}\textbf{P}_{n})^{T}\nabla_{\textbf{P}_{n}}\mathcal{L}_{n}" display="inline"><semantics id="S3.E4X.3.2.2.m1.1a"><mrow id="S3.E4X.3.2.2.m1.1.1" xref="S3.E4X.3.2.2.m1.1.1.cmml"><mi id="S3.E4X.3.2.2.m1.1.1.3" xref="S3.E4X.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E4X.3.2.2.m1.1.1.2" xref="S3.E4X.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E4X.3.2.2.m1.1.1.1" xref="S3.E4X.3.2.2.m1.1.1.1.cmml"><msup id="S3.E4X.3.2.2.m1.1.1.1.1" xref="S3.E4X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E4X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">âˆ‡</mo><mi id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">Ï†</mi></msub><msub id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.2" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.2a.cmml">P</mtext><mi id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.3" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml">n</mi></msub></mrow><mo stretchy="false" id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E4X.3.2.2.m1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0.167em" rspace="0em" id="S3.E4X.3.2.2.m1.1.1.1.2" xref="S3.E4X.3.2.2.m1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E4X.3.2.2.m1.1.1.1.3" xref="S3.E4X.3.2.2.m1.1.1.1.3.cmml"><msub id="S3.E4X.3.2.2.m1.1.1.1.3.1" xref="S3.E4X.3.2.2.m1.1.1.1.3.1.cmml"><mo rspace="0.167em" id="S3.E4X.3.2.2.m1.1.1.1.3.1.2" xref="S3.E4X.3.2.2.m1.1.1.1.3.1.2.cmml">âˆ‡</mo><msub id="S3.E4X.3.2.2.m1.1.1.1.3.1.3" xref="S3.E4X.3.2.2.m1.1.1.1.3.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E4X.3.2.2.m1.1.1.1.3.1.3.2" xref="S3.E4X.3.2.2.m1.1.1.1.3.1.3.2a.cmml">P</mtext><mi id="S3.E4X.3.2.2.m1.1.1.1.3.1.3.3" xref="S3.E4X.3.2.2.m1.1.1.1.3.1.3.3.cmml">n</mi></msub></msub><msub id="S3.E4X.3.2.2.m1.1.1.1.3.2" xref="S3.E4X.3.2.2.m1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4X.3.2.2.m1.1.1.1.3.2.2" xref="S3.E4X.3.2.2.m1.1.1.1.3.2.2.cmml">â„’</mi><mi id="S3.E4X.3.2.2.m1.1.1.1.3.2.3" xref="S3.E4X.3.2.2.m1.1.1.1.3.2.3.cmml">n</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.3.2.2.m1.1b"><apply id="S3.E4X.3.2.2.m1.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1"><eq id="S3.E4X.3.2.2.m1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E4X.3.2.2.m1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1.1"><times id="S3.E4X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.2"></times><apply id="S3.E4X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1">superscript</csymbol><apply id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1"><apply id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.2">âˆ‡</ci><ci id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.1.3">ğœ‘</ci></apply><apply id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.2">P</mtext></ci><ci id="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1.1.1.1.2.3">ğ‘›</ci></apply></apply><ci id="S3.E4X.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.1.3">ğ‘‡</ci></apply><apply id="S3.E4X.3.2.2.m1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3"><apply id="S3.E4X.3.2.2.m1.1.1.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.1.1.1.3.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3.1">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.1.1.1.3.1.2.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3.1.2">âˆ‡</ci><apply id="S3.E4X.3.2.2.m1.1.1.1.3.1.3.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.1.1.1.3.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3.1.3">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.1.1.1.3.1.3.2a.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3.1.3.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S3.E4X.3.2.2.m1.1.1.1.3.1.3.2.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3.1.3.2">P</mtext></ci><ci id="S3.E4X.3.2.2.m1.1.1.1.3.1.3.3.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3.1.3.3">ğ‘›</ci></apply></apply><apply id="S3.E4X.3.2.2.m1.1.1.1.3.2.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.1.1.1.3.2.1.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3.2">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.1.1.1.3.2.2.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3.2.2">â„’</ci><ci id="S3.E4X.3.2.2.m1.1.1.1.3.2.3.cmml" xref="S3.E4X.3.2.2.m1.1.1.1.3.2.3">ğ‘›</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.3.2.2.m1.1c">\displaystyle=(\nabla_{\varphi}\textbf{P}_{n})^{T}\nabla_{\textbf{P}_{n}}\mathcal{L}_{n}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
<tr id="S3.E4Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\cong(\nabla_{\varphi}\textbf{P}_{n})^{T}\Delta\textbf{P}_{n}," display="inline"><semantics id="S3.E4Xa.2.1.1.m1.1a"><mrow id="S3.E4Xa.2.1.1.m1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3.cmml"></mi><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.cmml">â‰…</mo><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.cmml"><msup id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">âˆ‡</mo><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">Ï†</mi></msub><msub id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2a.cmml">P</mtext><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">n</mi></msub></mrow><mo stretchy="false" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.2.cmml">â€‹</mo><mi mathvariant="normal" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.2a" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.2.cmml">â€‹</mo><msub id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.2a.cmml">P</mtext><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.3.cmml">n</mi></msub></mrow></mrow><mo id="S3.E4Xa.2.1.1.m1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4Xa.2.1.1.m1.1b"><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1"><approx id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2"></approx><csymbol cd="latexml" id="S3.E4Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3">absent</csymbol><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1"><times id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.2"></times><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1"><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2">âˆ‡</ci><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3">ğœ‘</ci></apply><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2">P</mtext></ci><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">ğ‘›</ci></apply></apply><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.3">ğ‘‡</ci></apply><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3">Î”</ci><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.2a.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.2"><mtext class="ltx_mathvariant_bold" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.2">P</mtext></ci><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.4.3">ğ‘›</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4Xa.2.1.1.m1.1c">\displaystyle\cong(\nabla_{\varphi}\textbf{P}_{n})^{T}\Delta\textbf{P}_{n},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.SSS2.Px2.p2.6" class="ltx_p">where <math id="S3.SS2.SSS2.Px2.p2.2.m1.1" class="ltx_Math" alttext="\nabla_{\textbf{P}_{n}}\mathcal{L}_{n}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.2.m1.1a"><mrow id="S3.SS2.SSS2.Px2.p2.2.m1.1.1" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.cmml"><msub id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.cmml"><mo id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.2.cmml">âˆ‡</mo><msub id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.2a.cmml">P</mtext><mi id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.3.cmml">n</mi></msub></msub><msub id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.2" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.2.cmml">â„’</mi><mi id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.3" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.2.m1.1b"><apply id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1"><apply id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.2">âˆ‡</ci><apply id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.2a.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.2">P</mtext></ci><ci id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.1.3.3">ğ‘›</ci></apply></apply><apply id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.2">â„’</ci><ci id="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px2.p2.2.m1.1.1.2.3">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.2.m1.1c">\nabla_{\textbf{P}_{n}}\mathcal{L}_{n}</annotation></semantics></math> is approximated by <math id="S3.SS2.SSS2.Px2.p2.3.m2.1" class="ltx_Math" alttext="\Delta\textbf{P}_{n}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.3.m2.1a"><mrow id="S3.SS2.SSS2.Px2.p2.3.m2.1.1" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.2" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.2.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.cmml">â€‹</mo><msub id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.2a.cmml">P</mtext><mi id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.3.m2.1b"><apply id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1"><times id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.1"></times><ci id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.2">Î”</ci><apply id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.2a.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.2">P</mtext></ci><ci id="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.3.m2.1.1.3.3">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.3.m2.1c">\Delta\textbf{P}_{n}</annotation></semantics></math> that indicates the optimization direction of local training. We apply the same optimization rule to learn the client-agnostic prompts <math id="S3.SS2.SSS2.Px2.p2.4.m3.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.4.m3.1a"><msub id="S3.SS2.SSS2.Px2.p2.4.m3.1.1" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.2" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.2a.cmml">P</mtext><mrow id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.2" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.1" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.3" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.1a" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.4" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.1b" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.5" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.4.m3.1b"><apply id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.2a.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.2">P</mtext></ci><apply id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3"><times id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.1"></times><ci id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.2">ğ‘</ci><ci id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.3">ğ‘</ci><ci id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.4.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.4">ğ‘ </ci><ci id="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.5.cmml" xref="S3.SS2.SSS2.Px2.p2.4.m3.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.4.m3.1c">\textbf{P}_{base}</annotation></semantics></math> and client descriptor <math id="S3.SS2.SSS2.Px2.p2.5.m4.1" class="ltx_Math" alttext="d_{n}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.5.m4.1a"><msub id="S3.SS2.SSS2.Px2.p2.5.m4.1.1" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.2" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.2.cmml">d</mi><mi id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.5.m4.1b"><apply id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.2">ğ‘‘</ci><ci id="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p2.5.m4.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.5.m4.1c">d_{n}</annotation></semantics></math> end-to-end with <math id="S3.SS2.SSS2.Px2.p2.6.m5.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS2.SSS2.Px2.p2.6.m5.1a"><mi id="S3.SS2.SSS2.Px2.p2.6.m5.1.1" xref="S3.SS2.SSS2.Px2.p2.6.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p2.6.m5.1b"><ci id="S3.SS2.SSS2.Px2.p2.6.m5.1.1.cmml" xref="S3.SS2.SSS2.Px2.p2.6.m5.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p2.6.m5.1c">G</annotation></semantics></math>, and summarize the gradient update as follows,</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\varphi\leftarrow\varphi-\alpha\nabla_{\varphi}\textbf{P}_{n}^{T}\Delta\textbf{P}_{n}," display="inline"><semantics id="S3.E5X.2.1.1.m1.1a"><mrow id="S3.E5X.2.1.1.m1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E5X.2.1.1.m1.1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.2.cmml">Ï†</mi><mo stretchy="false" id="S3.E5X.2.1.1.m1.1.1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.cmml">â†</mo><mrow id="S3.E5X.2.1.1.m1.1.1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.1.1.3.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.2.cmml">Ï†</mi><mo id="S3.E5X.2.1.1.m1.1.1.1.1.3.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.1.cmml">âˆ’</mo><mrow id="S3.E5X.2.1.1.m1.1.1.1.1.3.3" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.2.cmml">Î±</mi><mo lspace="0.167em" rspace="0em" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.1.cmml">â€‹</mo><mrow id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.cmml"><msub id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1.cmml"><mo rspace="0.167em" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1.2.cmml">âˆ‡</mo><mi id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1.3" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1.3.cmml">Ï†</mi></msub><mrow id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.cmml"><msubsup id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.2.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.2.2a.cmml">P</mtext><mi id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.2.3" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.2.3.cmml">n</mi><mi id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.3" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.1.cmml">â€‹</mo><mi mathvariant="normal" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.3" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.3.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.1a" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.1.cmml">â€‹</mo><msub id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.2a.cmml">P</mtext><mi id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.3" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.3.cmml">n</mi></msub></mrow></mrow></mrow></mrow></mrow><mo id="S3.E5X.2.1.1.m1.1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><apply id="S3.E5X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1"><ci id="S3.E5X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1">â†</ci><ci id="S3.E5X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.2">ğœ‘</ci><apply id="S3.E5X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3"><minus id="S3.E5X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.1"></minus><ci id="S3.E5X.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.2">ğœ‘</ci><apply id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3"><times id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.1"></times><ci id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.2">ğ›¼</ci><apply id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3"><apply id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1.2">âˆ‡</ci><ci id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.1.3">ğœ‘</ci></apply><apply id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2"><times id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.1"></times><apply id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2">superscript</csymbol><apply id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.2.2a.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.2.2">P</mtext></ci><ci id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.2.3">ğ‘›</ci></apply><ci id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.2.3">ğ‘‡</ci></apply><ci id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.3">Î”</ci><apply id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.2a.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.2"><mtext class="ltx_mathvariant_bold" id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.2">P</mtext></ci><ci id="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.3.3.2.4.3">ğ‘›</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle\varphi\leftarrow\varphi-\alpha\nabla_{\varphi}\textbf{P}_{n}^{T}\Delta\textbf{P}_{n},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S3.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\textbf{P}_{base}\leftarrow\textbf{P}_{base}-\alpha\nabla_{\textbf{P}_{base}}\varphi^{T}\nabla_{\varphi}\textbf{P}_{n}^{T}\Delta\textbf{P}_{n}," display="inline"><semantics id="S3.E5Xa.2.1.1.m1.1a"><mrow id="S3.E5Xa.2.1.1.m1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E5Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.2a.cmml">P</mtext><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.1.cmml">â€‹</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.1a" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.1.cmml">â€‹</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.4" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.1b" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.1.cmml">â€‹</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.5" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.5.cmml">e</mi></mrow></msub><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.cmml">â†</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.cmml"><msub id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.2a.cmml">P</mtext><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.1a" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.4" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.1b" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.1.cmml">â€‹</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.5" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.5.cmml">e</mi></mrow></msub><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.1.cmml">âˆ’</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml">Î±</mi><mo lspace="0.167em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.1.cmml">â€‹</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml"><msub id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.cmml"><mo rspace="0.167em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.2.cmml">âˆ‡</mo><msub id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.2a.cmml">P</mtext><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.1.cmml">â€‹</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.1a" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.1.cmml">â€‹</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.4" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.1b" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.1.cmml">â€‹</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.5" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.5.cmml">e</mi></mrow></msub></msub><msup id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2.2.cmml">Ï†</mi><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2.3.cmml">T</mi></msup></mrow><mo lspace="0.167em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.1a" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.1.cmml">â€‹</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.cmml"><msub id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1.cmml"><mo rspace="0.167em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1.2.cmml">âˆ‡</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1.3.cmml">Ï†</mi></msub><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.cmml"><msubsup id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.2a.cmml">P</mtext><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.3.cmml">n</mi><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.1.cmml">â€‹</mo><mi mathvariant="normal" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.3.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.1a" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.1.cmml">â€‹</mo><msub id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.2a.cmml">P</mtext><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.3.cmml">n</mi></msub></mrow></mrow></mrow></mrow></mrow><mo id="S3.E5Xa.2.1.1.m1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.1b"><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1"><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1">â†</ci><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.2a.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.2">P</mtext></ci><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.1"></times><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.2">ğ‘</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.3">ğ‘</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.4.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.4">ğ‘ </ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.5.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.3.5">ğ‘’</ci></apply></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3"><minus id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.1"></minus><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.2a.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.2">P</mtext></ci><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.2">ğ‘</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.3">ğ‘</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.4">ğ‘ </ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.5.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.2.3.5">ğ‘’</ci></apply></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.1"></times><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.2">ğ›¼</ci><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3"><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.2">âˆ‡</ci><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.2a.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.2">P</mtext></ci><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.1"></times><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.2">ğ‘</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.3">ğ‘</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.4.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.4">ğ‘ </ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.5.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.5">ğ‘’</ci></apply></apply></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2">superscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2.2">ğœ‘</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.3.2.3">ğ‘‡</ci></apply></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4"><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1.2">âˆ‡</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.1.3">ğœ‘</ci></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.1"></times><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.2a.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.2">P</mtext></ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.3">ğ‘›</ci></apply><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.2.3">ğ‘‡</ci></apply><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.3">Î”</ci><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.2a.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.2"><mtext class="ltx_mathvariant_bold" id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.2">P</mtext></ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.3.4.2.4.3">ğ‘›</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.1c">\displaystyle\textbf{P}_{base}\leftarrow\textbf{P}_{base}-\alpha\nabla_{\textbf{P}_{base}}\varphi^{T}\nabla_{\varphi}\textbf{P}_{n}^{T}\Delta\textbf{P}_{n},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E5Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle d_{n}\leftarrow d_{n}-\alpha\nabla_{d_{n}}\varphi^{T}\nabla_{\varphi}\textbf{P}_{n}^{T}\Delta\textbf{P}_{n}." display="inline"><semantics id="S3.E5Xb.2.1.1.m1.1a"><mrow id="S3.E5Xb.2.1.1.m1.1.1.1" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E5Xb.2.1.1.m1.1.1.1.1" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E5Xb.2.1.1.m1.1.1.1.1.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.2.cmml"><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.2.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.2.2.cmml">d</mi><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.2.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.2.3.cmml">n</mi></msub><mo stretchy="false" id="S3.E5Xb.2.1.1.m1.1.1.1.1.1" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.1.cmml">â†</mo><mrow id="S3.E5Xb.2.1.1.m1.1.1.1.1.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.cmml"><msub id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2.cmml"><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2.2.cmml">d</mi><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2.3.cmml">n</mi></msub><mo id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.1" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.1.cmml">âˆ’</mo><mrow id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.2.cmml">Î±</mi><mo lspace="0.167em" rspace="0em" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.1" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.1.cmml">â€‹</mo><mrow id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.cmml"><msub id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.cmml"><mo rspace="0.167em" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.2.cmml">âˆ‡</mo><msub id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3.cmml"><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3.2.cmml">d</mi><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.cmml">n</mi></msub></msub><msup id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2.cmml"><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2.2.cmml">Ï†</mi><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2.3.cmml">T</mi></msup></mrow><mo lspace="0.167em" rspace="0em" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.1a" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.1.cmml">â€‹</mo><mrow id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.cmml"><msub id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1.cmml"><mo rspace="0.167em" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1.2.cmml">âˆ‡</mo><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1.3.cmml">Ï†</mi></msub><mrow id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.cmml"><msubsup id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.2a.cmml">P</mtext><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.3.cmml">n</mi><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.1" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.1.cmml">â€‹</mo><mi mathvariant="normal" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.3.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.1a" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.1.cmml">â€‹</mo><msub id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.2a.cmml">P</mtext><mi id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.3" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.3.cmml">n</mi></msub></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E5Xb.2.1.1.m1.1.1.1.2" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xb.2.1.1.m1.1b"><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1"><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.1">â†</ci><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.2.2">ğ‘‘</ci><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.2.3">ğ‘›</ci></apply><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3"><minus id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.1"></minus><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2.2">ğ‘‘</ci><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.2.3">ğ‘›</ci></apply><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3"><times id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.1"></times><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.2">ğ›¼</ci><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3"><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1">subscript</csymbol><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.2">âˆ‡</ci><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3">subscript</csymbol><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3.2">ğ‘‘</ci><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.1.3.3">ğ‘›</ci></apply></apply><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2">superscript</csymbol><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2.2">ğœ‘</ci><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.3.2.3">ğ‘‡</ci></apply></apply><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4"><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1">subscript</csymbol><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1.2">âˆ‡</ci><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.1.3">ğœ‘</ci></apply><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2"><times id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.1"></times><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2">superscript</csymbol><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2">subscript</csymbol><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.2a.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.2">P</mtext></ci><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.2.3">ğ‘›</ci></apply><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.2.3">ğ‘‡</ci></apply><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.3">Î”</ci><apply id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4"><csymbol cd="ambiguous" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.1.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4">subscript</csymbol><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.2a.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.2"><mtext class="ltx_mathvariant_bold" id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.2.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.2">P</mtext></ci><ci id="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.3.cmml" xref="S3.E5Xb.2.1.1.m1.1.1.1.1.3.3.4.2.4.3">ğ‘›</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xb.2.1.1.m1.1c">\displaystyle d_{n}\leftarrow d_{n}-\alpha\nabla_{d_{n}}\varphi^{T}\nabla_{\varphi}\textbf{P}_{n}^{T}\Delta\textbf{P}_{n}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.17.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> pFedPG for Efficient and Personalized FL</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.15" class="ltx_p ltx_figure_panel"><span id="alg1.15.1" class="ltx_text ltx_font_bold">Input</span>: Number of communication rounds <math id="alg1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">T</annotation></semantics></math>, <math id="alg1.2.m2.1" class="ltx_Math" alttext="F^{*}" display="inline"><semantics id="alg1.2.m2.1a"><msup id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml"><mi id="alg1.2.m2.1.1.2" xref="alg1.2.m2.1.1.2.cmml">F</mi><mo id="alg1.2.m2.1.1.3" xref="alg1.2.m2.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><apply id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.2.m2.1.1.1.cmml" xref="alg1.2.m2.1.1">superscript</csymbol><ci id="alg1.2.m2.1.1.2.cmml" xref="alg1.2.m2.1.1.2">ğ¹</ci><times id="alg1.2.m2.1.1.3.cmml" xref="alg1.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">F^{*}</annotation></semantics></math>, <math id="alg1.3.m3.1" class="ltx_Math" alttext="G" display="inline"><semantics id="alg1.3.m3.1a"><mi id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">G</annotation></semantics></math>, <math id="alg1.4.m4.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="alg1.4.m4.1a"><msub id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.4.m4.1.1.2" xref="alg1.4.m4.1.1.2a.cmml">P</mtext><mrow id="alg1.4.m4.1.1.3" xref="alg1.4.m4.1.1.3.cmml"><mi id="alg1.4.m4.1.1.3.2" xref="alg1.4.m4.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg1.4.m4.1.1.3.1" xref="alg1.4.m4.1.1.3.1.cmml">â€‹</mo><mi id="alg1.4.m4.1.1.3.3" xref="alg1.4.m4.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.4.m4.1.1.3.1a" xref="alg1.4.m4.1.1.3.1.cmml">â€‹</mo><mi id="alg1.4.m4.1.1.3.4" xref="alg1.4.m4.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.4.m4.1.1.3.1b" xref="alg1.4.m4.1.1.3.1.cmml">â€‹</mo><mi id="alg1.4.m4.1.1.3.5" xref="alg1.4.m4.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><apply id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1"><csymbol cd="ambiguous" id="alg1.4.m4.1.1.1.cmml" xref="alg1.4.m4.1.1">subscript</csymbol><ci id="alg1.4.m4.1.1.2a.cmml" xref="alg1.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="alg1.4.m4.1.1.2.cmml" xref="alg1.4.m4.1.1.2">P</mtext></ci><apply id="alg1.4.m4.1.1.3.cmml" xref="alg1.4.m4.1.1.3"><times id="alg1.4.m4.1.1.3.1.cmml" xref="alg1.4.m4.1.1.3.1"></times><ci id="alg1.4.m4.1.1.3.2.cmml" xref="alg1.4.m4.1.1.3.2">ğ‘</ci><ci id="alg1.4.m4.1.1.3.3.cmml" xref="alg1.4.m4.1.1.3.3">ğ‘</ci><ci id="alg1.4.m4.1.1.3.4.cmml" xref="alg1.4.m4.1.1.3.4">ğ‘ </ci><ci id="alg1.4.m4.1.1.3.5.cmml" xref="alg1.4.m4.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">\textbf{P}_{base}</annotation></semantics></math>, <math id="alg1.5.m5.1" class="ltx_Math" alttext="D" display="inline"><semantics id="alg1.5.m5.1a"><mi id="alg1.5.m5.1.1" xref="alg1.5.m5.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><ci id="alg1.5.m5.1.1.cmml" xref="alg1.5.m5.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">D</annotation></semantics></math>, and <math id="alg1.6.m6.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.6.m6.1a"><mi id="alg1.6.m6.1.1" xref="alg1.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.6.m6.1b"><ci id="alg1.6.m6.1.1.cmml" xref="alg1.6.m6.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m6.1c">N</annotation></semantics></math> sets of <math id="alg1.7.m7.1" class="ltx_Math" alttext="\textbf{P}_{n}" display="inline"><semantics id="alg1.7.m7.1a"><msub id="alg1.7.m7.1.1" xref="alg1.7.m7.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.7.m7.1.1.2" xref="alg1.7.m7.1.1.2a.cmml">P</mtext><mi id="alg1.7.m7.1.1.3" xref="alg1.7.m7.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.7.m7.1b"><apply id="alg1.7.m7.1.1.cmml" xref="alg1.7.m7.1.1"><csymbol cd="ambiguous" id="alg1.7.m7.1.1.1.cmml" xref="alg1.7.m7.1.1">subscript</csymbol><ci id="alg1.7.m7.1.1.2a.cmml" xref="alg1.7.m7.1.1.2"><mtext class="ltx_mathvariant_bold" id="alg1.7.m7.1.1.2.cmml" xref="alg1.7.m7.1.1.2">P</mtext></ci><ci id="alg1.7.m7.1.1.3.cmml" xref="alg1.7.m7.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m7.1c">\textbf{P}_{n}</annotation></semantics></math> and <math id="alg1.8.m8.1" class="ltx_Math" alttext="H_{n}" display="inline"><semantics id="alg1.8.m8.1a"><msub id="alg1.8.m8.1.1" xref="alg1.8.m8.1.1.cmml"><mi id="alg1.8.m8.1.1.2" xref="alg1.8.m8.1.1.2.cmml">H</mi><mi id="alg1.8.m8.1.1.3" xref="alg1.8.m8.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.8.m8.1b"><apply id="alg1.8.m8.1.1.cmml" xref="alg1.8.m8.1.1"><csymbol cd="ambiguous" id="alg1.8.m8.1.1.1.cmml" xref="alg1.8.m8.1.1">subscript</csymbol><ci id="alg1.8.m8.1.1.2.cmml" xref="alg1.8.m8.1.1.2">ğ»</ci><ci id="alg1.8.m8.1.1.3.cmml" xref="alg1.8.m8.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m8.1c">H_{n}</annotation></semantics></math>, <math id="alg1.9.m9.2" class="ltx_Math" alttext="n\in[1,N]" display="inline"><semantics id="alg1.9.m9.2a"><mrow id="alg1.9.m9.2.3" xref="alg1.9.m9.2.3.cmml"><mi id="alg1.9.m9.2.3.2" xref="alg1.9.m9.2.3.2.cmml">n</mi><mo id="alg1.9.m9.2.3.1" xref="alg1.9.m9.2.3.1.cmml">âˆˆ</mo><mrow id="alg1.9.m9.2.3.3.2" xref="alg1.9.m9.2.3.3.1.cmml"><mo stretchy="false" id="alg1.9.m9.2.3.3.2.1" xref="alg1.9.m9.2.3.3.1.cmml">[</mo><mn id="alg1.9.m9.1.1" xref="alg1.9.m9.1.1.cmml">1</mn><mo id="alg1.9.m9.2.3.3.2.2" xref="alg1.9.m9.2.3.3.1.cmml">,</mo><mi id="alg1.9.m9.2.2" xref="alg1.9.m9.2.2.cmml">N</mi><mo stretchy="false" id="alg1.9.m9.2.3.3.2.3" xref="alg1.9.m9.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.m9.2b"><apply id="alg1.9.m9.2.3.cmml" xref="alg1.9.m9.2.3"><in id="alg1.9.m9.2.3.1.cmml" xref="alg1.9.m9.2.3.1"></in><ci id="alg1.9.m9.2.3.2.cmml" xref="alg1.9.m9.2.3.2">ğ‘›</ci><interval closure="closed" id="alg1.9.m9.2.3.3.1.cmml" xref="alg1.9.m9.2.3.3.2"><cn type="integer" id="alg1.9.m9.1.1.cmml" xref="alg1.9.m9.1.1">1</cn><ci id="alg1.9.m9.2.2.cmml" xref="alg1.9.m9.2.2">ğ‘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m9.2c">n\in[1,N]</annotation></semantics></math> 
<br class="ltx_break"><span id="alg1.15.2" class="ltx_text ltx_font_bold">Data</span>: <math id="alg1.10.m10.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.10.m10.1a"><mi id="alg1.10.m10.1.1" xref="alg1.10.m10.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.10.m10.1b"><ci id="alg1.10.m10.1.1.cmml" xref="alg1.10.m10.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m10.1c">N</annotation></semantics></math> labeled datasets <math id="alg1.11.m11.1" class="ltx_Math" alttext="\mathcal{D}_{n}" display="inline"><semantics id="alg1.11.m11.1a"><msub id="alg1.11.m11.1.1" xref="alg1.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.11.m11.1.1.2" xref="alg1.11.m11.1.1.2.cmml">ğ’Ÿ</mi><mi id="alg1.11.m11.1.1.3" xref="alg1.11.m11.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.11.m11.1b"><apply id="alg1.11.m11.1.1.cmml" xref="alg1.11.m11.1.1"><csymbol cd="ambiguous" id="alg1.11.m11.1.1.1.cmml" xref="alg1.11.m11.1.1">subscript</csymbol><ci id="alg1.11.m11.1.1.2.cmml" xref="alg1.11.m11.1.1.2">ğ’Ÿ</ci><ci id="alg1.11.m11.1.1.3.cmml" xref="alg1.11.m11.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.m11.1c">\mathcal{D}_{n}</annotation></semantics></math>, <math id="alg1.12.m12.2" class="ltx_Math" alttext="n\in[1,N]" display="inline"><semantics id="alg1.12.m12.2a"><mrow id="alg1.12.m12.2.3" xref="alg1.12.m12.2.3.cmml"><mi id="alg1.12.m12.2.3.2" xref="alg1.12.m12.2.3.2.cmml">n</mi><mo id="alg1.12.m12.2.3.1" xref="alg1.12.m12.2.3.1.cmml">âˆˆ</mo><mrow id="alg1.12.m12.2.3.3.2" xref="alg1.12.m12.2.3.3.1.cmml"><mo stretchy="false" id="alg1.12.m12.2.3.3.2.1" xref="alg1.12.m12.2.3.3.1.cmml">[</mo><mn id="alg1.12.m12.1.1" xref="alg1.12.m12.1.1.cmml">1</mn><mo id="alg1.12.m12.2.3.3.2.2" xref="alg1.12.m12.2.3.3.1.cmml">,</mo><mi id="alg1.12.m12.2.2" xref="alg1.12.m12.2.2.cmml">N</mi><mo stretchy="false" id="alg1.12.m12.2.3.3.2.3" xref="alg1.12.m12.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.12.m12.2b"><apply id="alg1.12.m12.2.3.cmml" xref="alg1.12.m12.2.3"><in id="alg1.12.m12.2.3.1.cmml" xref="alg1.12.m12.2.3.1"></in><ci id="alg1.12.m12.2.3.2.cmml" xref="alg1.12.m12.2.3.2">ğ‘›</ci><interval closure="closed" id="alg1.12.m12.2.3.3.1.cmml" xref="alg1.12.m12.2.3.3.2"><cn type="integer" id="alg1.12.m12.1.1.cmml" xref="alg1.12.m12.1.1">1</cn><ci id="alg1.12.m12.2.2.cmml" xref="alg1.12.m12.2.2">ğ‘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.m12.2c">n\in[1,N]</annotation></semantics></math>
<br class="ltx_break"><span id="alg1.15.3" class="ltx_text ltx_font_bold">Output</span>: <math id="alg1.13.m13.1" class="ltx_Math" alttext="F^{*}" display="inline"><semantics id="alg1.13.m13.1a"><msup id="alg1.13.m13.1.1" xref="alg1.13.m13.1.1.cmml"><mi id="alg1.13.m13.1.1.2" xref="alg1.13.m13.1.1.2.cmml">F</mi><mo id="alg1.13.m13.1.1.3" xref="alg1.13.m13.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.13.m13.1b"><apply id="alg1.13.m13.1.1.cmml" xref="alg1.13.m13.1.1"><csymbol cd="ambiguous" id="alg1.13.m13.1.1.1.cmml" xref="alg1.13.m13.1.1">superscript</csymbol><ci id="alg1.13.m13.1.1.2.cmml" xref="alg1.13.m13.1.1.2">ğ¹</ci><times id="alg1.13.m13.1.1.3.cmml" xref="alg1.13.m13.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.m13.1c">F^{*}</annotation></semantics></math>, <math id="alg1.14.m14.1" class="ltx_Math" alttext="H_{n}" display="inline"><semantics id="alg1.14.m14.1a"><msub id="alg1.14.m14.1.1" xref="alg1.14.m14.1.1.cmml"><mi id="alg1.14.m14.1.1.2" xref="alg1.14.m14.1.1.2.cmml">H</mi><mi id="alg1.14.m14.1.1.3" xref="alg1.14.m14.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.14.m14.1b"><apply id="alg1.14.m14.1.1.cmml" xref="alg1.14.m14.1.1"><csymbol cd="ambiguous" id="alg1.14.m14.1.1.1.cmml" xref="alg1.14.m14.1.1">subscript</csymbol><ci id="alg1.14.m14.1.1.2.cmml" xref="alg1.14.m14.1.1.2">ğ»</ci><ci id="alg1.14.m14.1.1.3.cmml" xref="alg1.14.m14.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.m14.1c">H_{n}</annotation></semantics></math>, <math id="alg1.15.m15.1" class="ltx_Math" alttext="\textbf{P}_{n}" display="inline"><semantics id="alg1.15.m15.1a"><msub id="alg1.15.m15.1.1" xref="alg1.15.m15.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.15.m15.1.1.2" xref="alg1.15.m15.1.1.2a.cmml">P</mtext><mi id="alg1.15.m15.1.1.3" xref="alg1.15.m15.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.15.m15.1b"><apply id="alg1.15.m15.1.1.cmml" xref="alg1.15.m15.1.1"><csymbol cd="ambiguous" id="alg1.15.m15.1.1.1.cmml" xref="alg1.15.m15.1.1">subscript</csymbol><ci id="alg1.15.m15.1.1.2a.cmml" xref="alg1.15.m15.1.1.2"><mtext class="ltx_mathvariant_bold" id="alg1.15.m15.1.1.2.cmml" xref="alg1.15.m15.1.1.2">P</mtext></ci><ci id="alg1.15.m15.1.1.3.cmml" xref="alg1.15.m15.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.m15.1c">\textbf{P}_{n}</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.18" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>Â Â Let <math id="alg1.l1.m1.1" class="ltx_Math" alttext="t=0" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">t</mi><mo id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">=</mo><mn id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><eq id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1"></eq><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">ğ‘¡</ci><cn type="integer" id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">t=0</annotation></semantics></math>;

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Â Â <span id="alg1.l2.2" class="ltx_text ltx_font_bold">while</span>Â <math id="alg1.l2.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">t</annotation></semantics></math> &lt;<math id="alg1.l2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">T</annotation></semantics></math>Â <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>Â Â Â Â Â <span id="alg1.l3.2" class="ltx_text ltx_font_bold"># Personalized prompt adaptation at clients</span>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>Â Â Â Â Â <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span>Â <math id="alg1.l4.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">n</annotation></semantics></math> in <math id="alg1.l4.m2.1" class="ltx_Math" alttext="1:N" display="inline"><semantics id="alg1.l4.m2.1a"><mrow id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><mn id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="alg1.l4.m2.1.1.1" xref="alg1.l4.m2.1.1.1.cmml">:</mo><mi id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><ci id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1.1">:</ci><cn type="integer" id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2">1</cn><ci id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">1:N</annotation></semantics></math>Â <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>Â Â Â Â Â Â Â Â Keep <math id="alg1.l5.m1.1" class="ltx_Math" alttext="F^{*}" display="inline"><semantics id="alg1.l5.m1.1a"><msup id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">F</mi><mo id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">ğ¹</ci><times id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">F^{*}</annotation></semantics></math> freeze;

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>Â Â Â Â Â Â Â Â Set <math id="alg1.l6.m1.2" class="ltx_Math" alttext="\textbf{P}_{n}=G(\textbf{P}_{base},d_{n})" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml"><msub id="alg1.l6.m1.2.2.4" xref="alg1.l6.m1.2.2.4.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l6.m1.2.2.4.2" xref="alg1.l6.m1.2.2.4.2a.cmml">P</mtext><mi id="alg1.l6.m1.2.2.4.3" xref="alg1.l6.m1.2.2.4.3.cmml">n</mi></msub><mo id="alg1.l6.m1.2.2.3" xref="alg1.l6.m1.2.2.3.cmml">=</mo><mrow id="alg1.l6.m1.2.2.2" xref="alg1.l6.m1.2.2.2.cmml"><mi id="alg1.l6.m1.2.2.2.4" xref="alg1.l6.m1.2.2.2.4.cmml">G</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.3" xref="alg1.l6.m1.2.2.2.3.cmml">â€‹</mo><mrow id="alg1.l6.m1.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l6.m1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.2a.cmml">P</mtext><mrow id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.1.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.1.1.3.1" xref="alg1.l6.m1.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l6.m1.1.1.1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.1.1.3.1a" xref="alg1.l6.m1.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l6.m1.1.1.1.1.1.1.3.4" xref="alg1.l6.m1.1.1.1.1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.1.1.3.1b" xref="alg1.l6.m1.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l6.m1.1.1.1.1.1.1.3.5" xref="alg1.l6.m1.1.1.1.1.1.1.3.5.cmml">e</mi></mrow></msub><mo id="alg1.l6.m1.2.2.2.2.2.4" xref="alg1.l6.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l6.m1.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l6.m1.2.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.2.cmml">d</mi><mi id="alg1.l6.m1.2.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.2.5" xref="alg1.l6.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2"><eq id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.3"></eq><apply id="alg1.l6.m1.2.2.4.cmml" xref="alg1.l6.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.4.1.cmml" xref="alg1.l6.m1.2.2.4">subscript</csymbol><ci id="alg1.l6.m1.2.2.4.2a.cmml" xref="alg1.l6.m1.2.2.4.2"><mtext class="ltx_mathvariant_bold" id="alg1.l6.m1.2.2.4.2.cmml" xref="alg1.l6.m1.2.2.4.2">P</mtext></ci><ci id="alg1.l6.m1.2.2.4.3.cmml" xref="alg1.l6.m1.2.2.4.3">ğ‘›</ci></apply><apply id="alg1.l6.m1.2.2.2.cmml" xref="alg1.l6.m1.2.2.2"><times id="alg1.l6.m1.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.3"></times><ci id="alg1.l6.m1.2.2.2.4.cmml" xref="alg1.l6.m1.2.2.2.4">ğº</ci><interval closure="open" id="alg1.l6.m1.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2"><apply id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.2a.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="alg1.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2">P</mtext></ci><apply id="alg1.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3"><times id="alg1.l6.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.1"></times><ci id="alg1.l6.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.2">ğ‘</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.3">ğ‘</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.3.4.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.4">ğ‘ </ci><ci id="alg1.l6.m1.1.1.1.1.1.1.3.5.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.5">ğ‘’</ci></apply></apply><apply id="alg1.l6.m1.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.2">ğ‘‘</ci><ci id="alg1.l6.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.3">ğ‘›</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">\textbf{P}_{n}=G(\textbf{P}_{base},d_{n})</annotation></semantics></math>, <math id="alg1.l6.m2.1" class="ltx_Math" alttext="d_{n}\in D" display="inline"><semantics id="alg1.l6.m2.1a"><mrow id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><msub id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml"><mi id="alg1.l6.m2.1.1.2.2" xref="alg1.l6.m2.1.1.2.2.cmml">d</mi><mi id="alg1.l6.m2.1.1.2.3" xref="alg1.l6.m2.1.1.2.3.cmml">n</mi></msub><mo id="alg1.l6.m2.1.1.1" xref="alg1.l6.m2.1.1.1.cmml">âˆˆ</mo><mi id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><in id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1.1"></in><apply id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.2.1.cmml" xref="alg1.l6.m2.1.1.2">subscript</csymbol><ci id="alg1.l6.m2.1.1.2.2.cmml" xref="alg1.l6.m2.1.1.2.2">ğ‘‘</ci><ci id="alg1.l6.m2.1.1.2.3.cmml" xref="alg1.l6.m2.1.1.2.3">ğ‘›</ci></apply><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">ğ·</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">d_{n}\in D</annotation></semantics></math> (Eq.Â (<a href="#S3.E3" title="In Design and architecture â€£ 3.2.2 Personalized prompt generation at the server â€£ 3.2 Efficient Model Personalization in FL via Client-Specific Prompt Generation â€£ 3 Proposed Method â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>));

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>Â Â Â Â Â Â Â Â Randomly sample a minibatch from <math id="alg1.l7.m1.1" class="ltx_Math" alttext="\mathcal{D}_{n}" display="inline"><semantics id="alg1.l7.m1.1a"><msub id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">ğ’Ÿ</mi><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">ğ’Ÿ</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\mathcal{D}_{n}</annotation></semantics></math>;

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>Â Â Â Â Â Â Â Â Update <math id="alg1.l8.m1.1" class="ltx_Math" alttext="H_{n}" display="inline"><semantics id="alg1.l8.m1.1a"><msub id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">H</mi><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">ğ»</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">H_{n}</annotation></semantics></math> with <math id="alg1.l8.m2.1" class="ltx_Math" alttext="\mathcal{L}_{n}" display="inline"><semantics id="alg1.l8.m2.1a"><msub id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m2.1.1.2" xref="alg1.l8.m2.1.1.2.cmml">â„’</mi><mi id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.1.1.1.cmml" xref="alg1.l8.m2.1.1">subscript</csymbol><ci id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1.2">â„’</ci><ci id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\mathcal{L}_{n}</annotation></semantics></math> (Eq.Â (<a href="#S3.E2" title="In 3.2.1 Personalized prompt adaptation at local clients â€£ 3.2 Efficient Model Personalization in FL via Client-Specific Prompt Generation â€£ 3 Proposed Method â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>));

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>Â Â Â Â Â Â Â Â Update <math id="alg1.l9.m1.1" class="ltx_Math" alttext="\textbf{P}_{n}" display="inline"><semantics id="alg1.l9.m1.1a"><msub id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2a.cmml">P</mtext><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.2a.cmml" xref="alg1.l9.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">P</mtext></ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\textbf{P}_{n}</annotation></semantics></math> by <math id="alg1.l9.m2.1" class="ltx_Math" alttext="\mathtt{\widetilde{\textbf{P}}_{n}}\leftarrow\mathtt{\textbf{P}_{n}}-\gamma\frac{\partial(\mathcal{L}_{n})}{\partial\mathtt{\textbf{P}_{n}}}" display="inline"><semantics id="alg1.l9.m2.1a"><mrow id="alg1.l9.m2.1.2" xref="alg1.l9.m2.1.2.cmml"><msub id="alg1.l9.m2.1.2.2" xref="alg1.l9.m2.1.2.2.cmml"><mover accent="true" id="alg1.l9.m2.1.2.2.2" xref="alg1.l9.m2.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l9.m2.1.2.2.2.2" xref="alg1.l9.m2.1.2.2.2.2a.cmml">P</mtext><mo id="alg1.l9.m2.1.2.2.2.1" xref="alg1.l9.m2.1.2.2.2.1.cmml">~</mo></mover><mi id="alg1.l9.m2.1.2.2.3" xref="alg1.l9.m2.1.2.2.3.cmml">ğš—</mi></msub><mo stretchy="false" id="alg1.l9.m2.1.2.1" xref="alg1.l9.m2.1.2.1.cmml">â†</mo><mrow id="alg1.l9.m2.1.2.3" xref="alg1.l9.m2.1.2.3.cmml"><msub id="alg1.l9.m2.1.2.3.2" xref="alg1.l9.m2.1.2.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l9.m2.1.2.3.2.2" xref="alg1.l9.m2.1.2.3.2.2a.cmml">P</mtext><mi id="alg1.l9.m2.1.2.3.2.3" xref="alg1.l9.m2.1.2.3.2.3.cmml">ğš—</mi></msub><mo id="alg1.l9.m2.1.2.3.1" xref="alg1.l9.m2.1.2.3.1.cmml">âˆ’</mo><mrow id="alg1.l9.m2.1.2.3.3" xref="alg1.l9.m2.1.2.3.3.cmml"><mi id="alg1.l9.m2.1.2.3.3.2" xref="alg1.l9.m2.1.2.3.3.2.cmml">Î³</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m2.1.2.3.3.1" xref="alg1.l9.m2.1.2.3.3.1.cmml">â€‹</mo><mfrac id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mrow id="alg1.l9.m2.1.1.1" xref="alg1.l9.m2.1.1.1.cmml"><mo rspace="0em" id="alg1.l9.m2.1.1.1.2" xref="alg1.l9.m2.1.1.1.2.cmml">âˆ‚</mo><mrow id="alg1.l9.m2.1.1.1.1.1" xref="alg1.l9.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l9.m2.1.1.1.1.1.2" xref="alg1.l9.m2.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l9.m2.1.1.1.1.1.1" xref="alg1.l9.m2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m2.1.1.1.1.1.1.2" xref="alg1.l9.m2.1.1.1.1.1.1.2.cmml">â„’</mi><mi id="alg1.l9.m2.1.1.1.1.1.1.3" xref="alg1.l9.m2.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="alg1.l9.m2.1.1.1.1.1.3" xref="alg1.l9.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml"><mo rspace="0em" id="alg1.l9.m2.1.1.3.1" xref="alg1.l9.m2.1.1.3.1.cmml">âˆ‚</mo><msub id="alg1.l9.m2.1.1.3.2" xref="alg1.l9.m2.1.1.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l9.m2.1.1.3.2.2" xref="alg1.l9.m2.1.1.3.2.2a.cmml">P</mtext><mi id="alg1.l9.m2.1.1.3.2.3" xref="alg1.l9.m2.1.1.3.2.3.cmml">ğš—</mi></msub></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.2.cmml" xref="alg1.l9.m2.1.2"><ci id="alg1.l9.m2.1.2.1.cmml" xref="alg1.l9.m2.1.2.1">â†</ci><apply id="alg1.l9.m2.1.2.2.cmml" xref="alg1.l9.m2.1.2.2"><csymbol cd="ambiguous" id="alg1.l9.m2.1.2.2.1.cmml" xref="alg1.l9.m2.1.2.2">subscript</csymbol><apply id="alg1.l9.m2.1.2.2.2.cmml" xref="alg1.l9.m2.1.2.2.2"><ci id="alg1.l9.m2.1.2.2.2.1.cmml" xref="alg1.l9.m2.1.2.2.2.1">~</ci><ci id="alg1.l9.m2.1.2.2.2.2a.cmml" xref="alg1.l9.m2.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.l9.m2.1.2.2.2.2.cmml" xref="alg1.l9.m2.1.2.2.2.2">P</mtext></ci></apply><ci id="alg1.l9.m2.1.2.2.3.cmml" xref="alg1.l9.m2.1.2.2.3">ğš—</ci></apply><apply id="alg1.l9.m2.1.2.3.cmml" xref="alg1.l9.m2.1.2.3"><minus id="alg1.l9.m2.1.2.3.1.cmml" xref="alg1.l9.m2.1.2.3.1"></minus><apply id="alg1.l9.m2.1.2.3.2.cmml" xref="alg1.l9.m2.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l9.m2.1.2.3.2.1.cmml" xref="alg1.l9.m2.1.2.3.2">subscript</csymbol><ci id="alg1.l9.m2.1.2.3.2.2a.cmml" xref="alg1.l9.m2.1.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.l9.m2.1.2.3.2.2.cmml" xref="alg1.l9.m2.1.2.3.2.2">P</mtext></ci><ci id="alg1.l9.m2.1.2.3.2.3.cmml" xref="alg1.l9.m2.1.2.3.2.3">ğš—</ci></apply><apply id="alg1.l9.m2.1.2.3.3.cmml" xref="alg1.l9.m2.1.2.3.3"><times id="alg1.l9.m2.1.2.3.3.1.cmml" xref="alg1.l9.m2.1.2.3.3.1"></times><ci id="alg1.l9.m2.1.2.3.3.2.cmml" xref="alg1.l9.m2.1.2.3.3.2">ğ›¾</ci><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><divide id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1"></divide><apply id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1.1"><partialdiff id="alg1.l9.m2.1.1.1.2.cmml" xref="alg1.l9.m2.1.1.1.2"></partialdiff><apply id="alg1.l9.m2.1.1.1.1.1.1.cmml" xref="alg1.l9.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m2.1.1.1.1.1.1.2">â„’</ci><ci id="alg1.l9.m2.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m2.1.1.1.1.1.1.3">ğ‘›</ci></apply></apply><apply id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3"><partialdiff id="alg1.l9.m2.1.1.3.1.cmml" xref="alg1.l9.m2.1.1.3.1"></partialdiff><apply id="alg1.l9.m2.1.1.3.2.cmml" xref="alg1.l9.m2.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.3.2.1.cmml" xref="alg1.l9.m2.1.1.3.2">subscript</csymbol><ci id="alg1.l9.m2.1.1.3.2.2a.cmml" xref="alg1.l9.m2.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="alg1.l9.m2.1.1.3.2.2.cmml" xref="alg1.l9.m2.1.1.3.2.2">P</mtext></ci><ci id="alg1.l9.m2.1.1.3.2.3.cmml" xref="alg1.l9.m2.1.1.3.2.3">ğš—</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">\mathtt{\widetilde{\textbf{P}}_{n}}\leftarrow\mathtt{\textbf{P}_{n}}-\gamma\frac{\partial(\mathcal{L}_{n})}{\partial\mathtt{\textbf{P}_{n}}}</annotation></semantics></math>;

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>Â Â Â Â Â Â Â Â <math id="alg1.l10.m1.1" class="ltx_Math" alttext="\Delta\textbf{P}_{n}=\widetilde{\textbf{P}_{n}}-\textbf{P}_{n}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mrow id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi mathvariant="normal" id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.2.1" xref="alg1.l10.m1.1.1.2.1.cmml">â€‹</mo><msub id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l10.m1.1.1.2.3.2" xref="alg1.l10.m1.1.1.2.3.2a.cmml">P</mtext><mi id="alg1.l10.m1.1.1.2.3.3" xref="alg1.l10.m1.1.1.2.3.3.cmml">n</mi></msub></mrow><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">=</mo><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mover accent="true" id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml"><msub id="alg1.l10.m1.1.1.3.2.2" xref="alg1.l10.m1.1.1.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l10.m1.1.1.3.2.2.2" xref="alg1.l10.m1.1.1.3.2.2.2a.cmml">P</mtext><mi id="alg1.l10.m1.1.1.3.2.2.3" xref="alg1.l10.m1.1.1.3.2.2.3.cmml">n</mi></msub><mo id="alg1.l10.m1.1.1.3.2.1" xref="alg1.l10.m1.1.1.3.2.1.cmml">~</mo></mover><mo id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">âˆ’</mo><msub id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l10.m1.1.1.3.3.2" xref="alg1.l10.m1.1.1.3.3.2a.cmml">P</mtext><mi id="alg1.l10.m1.1.1.3.3.3" xref="alg1.l10.m1.1.1.3.3.3.cmml">n</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><eq id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></eq><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><times id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2.1"></times><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">Î”</ci><apply id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.3.1.cmml" xref="alg1.l10.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.3.2a.cmml" xref="alg1.l10.m1.1.1.2.3.2"><mtext class="ltx_mathvariant_bold" id="alg1.l10.m1.1.1.2.3.2.cmml" xref="alg1.l10.m1.1.1.2.3.2">P</mtext></ci><ci id="alg1.l10.m1.1.1.2.3.3.cmml" xref="alg1.l10.m1.1.1.2.3.3">ğ‘›</ci></apply></apply><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><minus id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></minus><apply id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2"><ci id="alg1.l10.m1.1.1.3.2.1.cmml" xref="alg1.l10.m1.1.1.3.2.1">~</ci><apply id="alg1.l10.m1.1.1.3.2.2.cmml" xref="alg1.l10.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.2.2.1.cmml" xref="alg1.l10.m1.1.1.3.2.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.2.2a.cmml" xref="alg1.l10.m1.1.1.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.l10.m1.1.1.3.2.2.2.cmml" xref="alg1.l10.m1.1.1.3.2.2.2">P</mtext></ci><ci id="alg1.l10.m1.1.1.3.2.2.3.cmml" xref="alg1.l10.m1.1.1.3.2.2.3">ğ‘›</ci></apply></apply><apply id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.3.1.cmml" xref="alg1.l10.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.3.2a.cmml" xref="alg1.l10.m1.1.1.3.3.2"><mtext class="ltx_mathvariant_bold" id="alg1.l10.m1.1.1.3.3.2.cmml" xref="alg1.l10.m1.1.1.3.3.2">P</mtext></ci><ci id="alg1.l10.m1.1.1.3.3.3.cmml" xref="alg1.l10.m1.1.1.3.3.3">ğ‘›</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\Delta\textbf{P}_{n}=\widetilde{\textbf{P}_{n}}-\textbf{P}_{n}</annotation></semantics></math>;

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>Â Â Â Â Â <span id="alg1.l11.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l11.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>Â Â Â Â Â <span id="alg1.l12.2" class="ltx_text ltx_font_bold"># Personalized prompt generation at the server</span>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>Â Â Â Â Â Receive <math id="alg1.l13.m1.1" class="ltx_Math" alttext="\Delta\textbf{P}_{n}" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi mathvariant="normal" id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">â€‹</mo><msub id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2a.cmml">P</mtext><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><times id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></times><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">Î”</ci><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.2a.cmml" xref="alg1.l13.m1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">P</mtext></ci><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\Delta\textbf{P}_{n}</annotation></semantics></math> from all <math id="alg1.l13.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l13.m2.1a"><mi id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><ci id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">N</annotation></semantics></math> clients;

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>Â Â Â Â Â Update <math id="alg1.l14.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="alg1.l14.m1.1a"><mi id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">G</annotation></semantics></math>, <math id="alg1.l14.m2.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="alg1.l14.m2.1a"><msub id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l14.m2.1.1.2" xref="alg1.l14.m2.1.1.2a.cmml">P</mtext><mrow id="alg1.l14.m2.1.1.3" xref="alg1.l14.m2.1.1.3.cmml"><mi id="alg1.l14.m2.1.1.3.2" xref="alg1.l14.m2.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m2.1.1.3.1" xref="alg1.l14.m2.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l14.m2.1.1.3.3" xref="alg1.l14.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m2.1.1.3.1a" xref="alg1.l14.m2.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l14.m2.1.1.3.4" xref="alg1.l14.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m2.1.1.3.1b" xref="alg1.l14.m2.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l14.m2.1.1.3.5" xref="alg1.l14.m2.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b"><apply id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1"><csymbol cd="ambiguous" id="alg1.l14.m2.1.1.1.cmml" xref="alg1.l14.m2.1.1">subscript</csymbol><ci id="alg1.l14.m2.1.1.2a.cmml" xref="alg1.l14.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="alg1.l14.m2.1.1.2.cmml" xref="alg1.l14.m2.1.1.2">P</mtext></ci><apply id="alg1.l14.m2.1.1.3.cmml" xref="alg1.l14.m2.1.1.3"><times id="alg1.l14.m2.1.1.3.1.cmml" xref="alg1.l14.m2.1.1.3.1"></times><ci id="alg1.l14.m2.1.1.3.2.cmml" xref="alg1.l14.m2.1.1.3.2">ğ‘</ci><ci id="alg1.l14.m2.1.1.3.3.cmml" xref="alg1.l14.m2.1.1.3.3">ğ‘</ci><ci id="alg1.l14.m2.1.1.3.4.cmml" xref="alg1.l14.m2.1.1.3.4">ğ‘ </ci><ci id="alg1.l14.m2.1.1.3.5.cmml" xref="alg1.l14.m2.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.1c">\textbf{P}_{base}</annotation></semantics></math>, and <math id="alg1.l14.m3.1" class="ltx_Math" alttext="D" display="inline"><semantics id="alg1.l14.m3.1a"><mi id="alg1.l14.m3.1.1" xref="alg1.l14.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="alg1.l14.m3.1b"><ci id="alg1.l14.m3.1.1.cmml" xref="alg1.l14.m3.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m3.1c">D</annotation></semantics></math> by Eq.Â (<a href="#S3.E5" title="In Learning of personalized prompt generation â€£ 3.2.2 Personalized prompt generation at the server â€£ 3.2 Efficient Model Personalization in FL via Client-Specific Prompt Generation â€£ 3 Proposed Method â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>);

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>Â Â Â Â Â <math id="alg1.l15.m1.1" class="ltx_Math" alttext="t=t+1" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">t</mi><mo id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">=</mo><mrow id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml">t</mi><mo id="alg1.l15.m1.1.1.3.1" xref="alg1.l15.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><eq id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"></eq><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">ğ‘¡</ci><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><plus id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3.1"></plus><ci id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">t=t+1</annotation></semantics></math>;

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>Â Â <span id="alg1.l16.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l16.3" class="ltx_text ltx_font_bold">while</span>
</div>
</div>
</div>
</div>
</figure>
<div id="S3.SS2.SSS2.Px2.p3" class="ltx_para">
<p id="S3.SS2.SSS2.Px2.p3.4" class="ltx_p">We note that, the client-agnostic prompt basis <math id="S3.SS2.SSS2.Px2.p3.1.m1.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p3.1.m1.1a"><msub id="S3.SS2.SSS2.Px2.p3.1.m1.1.1" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.2" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.2a.cmml">P</mtext><mrow id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.1" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.1a" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.4" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.1b" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.5" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p3.1.m1.1b"><apply id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.2a.cmml" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.2">P</mtext></ci><apply id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3"><times id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.1"></times><ci id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.2">ğ‘</ci><ci id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.3">ğ‘</ci><ci id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.4.cmml" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.4">ğ‘ </ci><ci id="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.5.cmml" xref="S3.SS2.SSS2.Px2.p3.1.m1.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p3.1.m1.1c">\textbf{P}_{base}</annotation></semantics></math> and conditional prompt generator <math id="S3.SS2.SSS2.Px2.p3.2.m2.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS2.SSS2.Px2.p3.2.m2.1a"><mi id="S3.SS2.SSS2.Px2.p3.2.m2.1.1" xref="S3.SS2.SSS2.Px2.p3.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p3.2.m2.1b"><ci id="S3.SS2.SSS2.Px2.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px2.p3.2.m2.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p3.2.m2.1c">G</annotation></semantics></math> are optimized by all clients, enforcing them to exploit cross-client knowledge, while client descriptor <math id="S3.SS2.SSS2.Px2.p3.3.m3.1" class="ltx_Math" alttext="d_{n}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p3.3.m3.1a"><msub id="S3.SS2.SSS2.Px2.p3.3.m3.1.1" xref="S3.SS2.SSS2.Px2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p3.3.m3.1.1.2" xref="S3.SS2.SSS2.Px2.p3.3.m3.1.1.2.cmml">d</mi><mi id="S3.SS2.SSS2.Px2.p3.3.m3.1.1.3" xref="S3.SS2.SSS2.Px2.p3.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p3.3.m3.1b"><apply id="S3.SS2.SSS2.Px2.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p3.3.m3.1.1.2">ğ‘‘</ci><ci id="S3.SS2.SSS2.Px2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p3.3.m3.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p3.3.m3.1c">d_{n}</annotation></semantics></math> is solely regarding client <math id="S3.SS2.SSS2.Px2.p3.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.SSS2.Px2.p3.4.m4.1a"><mi id="S3.SS2.SSS2.Px2.p3.4.m4.1.1" xref="S3.SS2.SSS2.Px2.p3.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p3.4.m4.1b"><ci id="S3.SS2.SSS2.Px2.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px2.p3.4.m4.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p3.4.m4.1c">n</annotation></semantics></math>, to encourage the derivation of client-specific characteristics.
With our proposed personalized prompt generation module, pFedPG is able to generate personalized prompts to facilitate local adaptation while leveraging learned knowledge across clients without explicitly accessing private data.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Quantitative comparisons on Office-Caltech10 and DomainNet datasets using ViT-B/16. <span id="S3.T1.10.1" class="ltx_text ltx_font_bold">Bold</span> denotes the best result.</figcaption>
<div id="S3.T1.8" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:482.0pt;height:198.7pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-87.6pt,36.0pt) scale(0.73341706887537,0.73341706887537) ;">
<table id="S3.T1.8.8" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.8.8.9.1" class="ltx_tr">
<td id="S3.T1.8.8.9.1.1" class="ltx_td ltx_align_left ltx_border_tt">Datasets</td>
<td id="S3.T1.8.8.9.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="5">Office-Caltech10 (%)</td>
<td id="S3.T1.8.8.9.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="7">DomainNet (%)</td>
<td id="S3.T1.8.8.9.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt">Comm.</td>
</tr>
<tr id="S3.T1.8.8.10.2" class="ltx_tr">
<td id="S3.T1.8.8.10.2.1" class="ltx_td ltx_align_left ltx_border_t">Method</td>
<td id="S3.T1.8.8.10.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.8.10.2.2.1" class="ltx_text ltx_font_italic">A</span></td>
<td id="S3.T1.8.8.10.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.8.10.2.3.1" class="ltx_text ltx_font_italic">C</span></td>
<td id="S3.T1.8.8.10.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.8.10.2.4.1" class="ltx_text ltx_font_italic">D</span></td>
<td id="S3.T1.8.8.10.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.8.10.2.5.1" class="ltx_text ltx_font_italic">W</span></td>
<td id="S3.T1.8.8.10.2.6" class="ltx_td ltx_align_center ltx_border_t">Avg.</td>
<td id="S3.T1.8.8.10.2.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.8.10.2.7.1" class="ltx_text ltx_font_italic">C</span></td>
<td id="S3.T1.8.8.10.2.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.8.10.2.8.1" class="ltx_text ltx_font_italic">I</span></td>
<td id="S3.T1.8.8.10.2.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.8.10.2.9.1" class="ltx_text ltx_font_italic">P</span></td>
<td id="S3.T1.8.8.10.2.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.8.10.2.10.1" class="ltx_text ltx_font_italic">Q</span></td>
<td id="S3.T1.8.8.10.2.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.8.10.2.11.1" class="ltx_text ltx_font_italic">R</span></td>
<td id="S3.T1.8.8.10.2.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.8.10.2.12.1" class="ltx_text ltx_font_italic">S</span></td>
<td id="S3.T1.8.8.10.2.13" class="ltx_td ltx_align_center ltx_border_t">Avg.</td>
<td id="S3.T1.8.8.10.2.14" class="ltx_td ltx_nopad_r ltx_align_center">Cost</td>
</tr>
<tr id="S3.T1.8.8.11.3" class="ltx_tr">
<td id="S3.T1.8.8.11.3.1" class="ltx_td ltx_align_left ltx_border_t" colspan="6"><span id="S3.T1.8.8.11.3.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Baselines</span></td>
<td id="S3.T1.8.8.11.3.2" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.11.3.3" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.11.3.4" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.11.3.5" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.11.3.6" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.11.3.7" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.11.3.8" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.11.3.9" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S3.T1.8.8.12.4" class="ltx_tr">
<td id="S3.T1.8.8.12.4.1" class="ltx_td ltx_align_left">SingleSet-Full</td>
<td id="S3.T1.8.8.12.4.2" class="ltx_td ltx_align_center">80.73</td>
<td id="S3.T1.8.8.12.4.3" class="ltx_td ltx_align_center">73.33</td>
<td id="S3.T1.8.8.12.4.4" class="ltx_td ltx_align_center">90.62</td>
<td id="S3.T1.8.8.12.4.5" class="ltx_td ltx_align_center">94.92</td>
<td id="S3.T1.8.8.12.4.6" class="ltx_td ltx_align_center">84.90</td>
<td id="S3.T1.8.8.12.4.7" class="ltx_td ltx_align_center">47.34</td>
<td id="S3.T1.8.8.12.4.8" class="ltx_td ltx_align_center">37.14</td>
<td id="S3.T1.8.8.12.4.9" class="ltx_td ltx_align_center">67.21</td>
<td id="S3.T1.8.8.12.4.10" class="ltx_td ltx_align_center">55.30</td>
<td id="S3.T1.8.8.12.4.11" class="ltx_td ltx_align_center">84.88</td>
<td id="S3.T1.8.8.12.4.12" class="ltx_td ltx_align_center">45.13</td>
<td id="S3.T1.8.8.12.4.13" class="ltx_td ltx_align_center">56.17</td>
<td id="S3.T1.8.8.12.4.14" class="ltx_td ltx_nopad_r ltx_align_center">-</td>
</tr>
<tr id="S3.T1.8.8.13.5" class="ltx_tr">
<td id="S3.T1.8.8.13.5.1" class="ltx_td ltx_align_left">SingleSet-VPTÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</td>
<td id="S3.T1.8.8.13.5.2" class="ltx_td ltx_align_center">83.33</td>
<td id="S3.T1.8.8.13.5.3" class="ltx_td ltx_align_center">74.67</td>
<td id="S3.T1.8.8.13.5.4" class="ltx_td ltx_align_center">96.88</td>
<td id="S3.T1.8.8.13.5.5" class="ltx_td ltx_align_center">96.61</td>
<td id="S3.T1.8.8.13.5.6" class="ltx_td ltx_align_center">87.87</td>
<td id="S3.T1.8.8.13.5.7" class="ltx_td ltx_align_center">57.98</td>
<td id="S3.T1.8.8.13.5.8" class="ltx_td ltx_align_center">41.55</td>
<td id="S3.T1.8.8.13.5.9" class="ltx_td ltx_align_center">74.64</td>
<td id="S3.T1.8.8.13.5.10" class="ltx_td ltx_align_center">59.60</td>
<td id="S3.T1.8.8.13.5.11" class="ltx_td ltx_align_center">89.56</td>
<td id="S3.T1.8.8.13.5.12" class="ltx_td ltx_align_center">60.47</td>
<td id="S3.T1.8.8.13.5.13" class="ltx_td ltx_align_center">63.97</td>
<td id="S3.T1.8.8.13.5.14" class="ltx_td ltx_nopad_r ltx_align_center">-</td>
</tr>
<tr id="S3.T1.1.1.1" class="ltx_tr">
<td id="S3.T1.1.1.1.2" class="ltx_td ltx_align_left">FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>
</td>
<td id="S3.T1.1.1.1.3" class="ltx_td ltx_align_center">89.58</td>
<td id="S3.T1.1.1.1.4" class="ltx_td ltx_align_center">80.44</td>
<td id="S3.T1.1.1.1.5" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.1.1.1.6" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.1.1.1.7" class="ltx_td ltx_align_center">92.51</td>
<td id="S3.T1.1.1.1.8" class="ltx_td ltx_align_center">63.50</td>
<td id="S3.T1.1.1.1.9" class="ltx_td ltx_align_center">38.05</td>
<td id="S3.T1.1.1.1.10" class="ltx_td ltx_align_center">71.89</td>
<td id="S3.T1.1.1.1.11" class="ltx_td ltx_align_center">60.80</td>
<td id="S3.T1.1.1.1.12" class="ltx_td ltx_align_center">78.55</td>
<td id="S3.T1.1.1.1.13" class="ltx_td ltx_align_center">60.47</td>
<td id="S3.T1.1.1.1.14" class="ltx_td ltx_align_center">62.21</td>
<td id="S3.T1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><math id="S3.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="8.58\times 10^{7}" display="inline"><semantics id="S3.T1.1.1.1.1.m1.1a"><mrow id="S3.T1.1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.1.m1.1.1.cmml"><mn id="S3.T1.1.1.1.1.m1.1.1.2" xref="S3.T1.1.1.1.1.m1.1.1.2.cmml">8.58</mn><mo lspace="0.222em" rspace="0.222em" id="S3.T1.1.1.1.1.m1.1.1.1" xref="S3.T1.1.1.1.1.m1.1.1.1.cmml">Ã—</mo><msup id="S3.T1.1.1.1.1.m1.1.1.3" xref="S3.T1.1.1.1.1.m1.1.1.3.cmml"><mn id="S3.T1.1.1.1.1.m1.1.1.3.2" xref="S3.T1.1.1.1.1.m1.1.1.3.2.cmml">10</mn><mn id="S3.T1.1.1.1.1.m1.1.1.3.3" xref="S3.T1.1.1.1.1.m1.1.1.3.3.cmml">7</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.1.m1.1.1"><times id="S3.T1.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.1.1.1.1.m1.1.1.1"></times><cn type="float" id="S3.T1.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.1.1.1.1.m1.1.1.2">8.58</cn><apply id="S3.T1.1.1.1.1.m1.1.1.3.cmml" xref="S3.T1.1.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.1.1.1.1.m1.1.1.3.1.cmml" xref="S3.T1.1.1.1.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.T1.1.1.1.1.m1.1.1.3.2.cmml" xref="S3.T1.1.1.1.1.m1.1.1.3.2">10</cn><cn type="integer" id="S3.T1.1.1.1.1.m1.1.1.3.3.cmml" xref="S3.T1.1.1.1.1.m1.1.1.3.3">7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.1.m1.1c">8.58\times 10^{7}</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.8.8.14.6" class="ltx_tr">
<td id="S3.T1.8.8.14.6.1" class="ltx_td ltx_align_left ltx_border_t" colspan="6"><span id="S3.T1.8.8.14.6.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Personalized Federated Learning</span></td>
<td id="S3.T1.8.8.14.6.2" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.14.6.3" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.14.6.4" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.14.6.5" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.14.6.6" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.14.6.7" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.14.6.8" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.14.6.9" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S3.T1.2.2.2" class="ltx_tr">
<td id="S3.T1.2.2.2.2" class="ltx_td ltx_align_left">Per-FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</td>
<td id="S3.T1.2.2.2.3" class="ltx_td ltx_align_center">91.67</td>
<td id="S3.T1.2.2.2.4" class="ltx_td ltx_align_center">90.22</td>
<td id="S3.T1.2.2.2.5" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.2.2.2.6" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.2.2.2.7" class="ltx_td ltx_align_center">95.47</td>
<td id="S3.T1.2.2.2.8" class="ltx_td ltx_align_center">69.39</td>
<td id="S3.T1.2.2.2.9" class="ltx_td ltx_align_center">48.71</td>
<td id="S3.T1.2.2.2.10" class="ltx_td ltx_align_center">82.07</td>
<td id="S3.T1.2.2.2.11" class="ltx_td ltx_align_center">35.30</td>
<td id="S3.T1.2.2.2.12" class="ltx_td ltx_align_center">90.63</td>
<td id="S3.T1.2.2.2.13" class="ltx_td ltx_align_center">72.56</td>
<td id="S3.T1.2.2.2.14" class="ltx_td ltx_align_center">66.44</td>
<td id="S3.T1.2.2.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><math id="S3.T1.2.2.2.1.m1.1" class="ltx_Math" alttext="8.58\times 10^{7}" display="inline"><semantics id="S3.T1.2.2.2.1.m1.1a"><mrow id="S3.T1.2.2.2.1.m1.1.1" xref="S3.T1.2.2.2.1.m1.1.1.cmml"><mn id="S3.T1.2.2.2.1.m1.1.1.2" xref="S3.T1.2.2.2.1.m1.1.1.2.cmml">8.58</mn><mo lspace="0.222em" rspace="0.222em" id="S3.T1.2.2.2.1.m1.1.1.1" xref="S3.T1.2.2.2.1.m1.1.1.1.cmml">Ã—</mo><msup id="S3.T1.2.2.2.1.m1.1.1.3" xref="S3.T1.2.2.2.1.m1.1.1.3.cmml"><mn id="S3.T1.2.2.2.1.m1.1.1.3.2" xref="S3.T1.2.2.2.1.m1.1.1.3.2.cmml">10</mn><mn id="S3.T1.2.2.2.1.m1.1.1.3.3" xref="S3.T1.2.2.2.1.m1.1.1.3.3.cmml">7</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.1.m1.1b"><apply id="S3.T1.2.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.2.1.m1.1.1"><times id="S3.T1.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.2.2.2.1.m1.1.1.1"></times><cn type="float" id="S3.T1.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.2.2.2.1.m1.1.1.2">8.58</cn><apply id="S3.T1.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.2.2.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.2.2.2.1.m1.1.1.3.1.cmml" xref="S3.T1.2.2.2.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.T1.2.2.2.1.m1.1.1.3.2.cmml" xref="S3.T1.2.2.2.1.m1.1.1.3.2">10</cn><cn type="integer" id="S3.T1.2.2.2.1.m1.1.1.3.3.cmml" xref="S3.T1.2.2.2.1.m1.1.1.3.3">7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.1.m1.1c">8.58\times 10^{7}</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.3.3.3" class="ltx_tr">
<td id="S3.T1.3.3.3.2" class="ltx_td ltx_align_left">FedRepÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</td>
<td id="S3.T1.3.3.3.3" class="ltx_td ltx_align_center">91.15</td>
<td id="S3.T1.3.3.3.4" class="ltx_td ltx_align_center">88.44</td>
<td id="S3.T1.3.3.3.5" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.3.3.3.6" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.3.3.3.7" class="ltx_td ltx_align_center">94.90</td>
<td id="S3.T1.3.3.3.8" class="ltx_td ltx_align_center">64.26</td>
<td id="S3.T1.3.3.3.9" class="ltx_td ltx_align_center">38.20</td>
<td id="S3.T1.3.3.3.10" class="ltx_td ltx_align_center">72.86</td>
<td id="S3.T1.3.3.3.11" class="ltx_td ltx_align_center"><span id="S3.T1.3.3.3.11.1" class="ltx_text ltx_font_bold">62.10</span></td>
<td id="S3.T1.3.3.3.12" class="ltx_td ltx_align_center">82.66</td>
<td id="S3.T1.3.3.3.13" class="ltx_td ltx_align_center">60.11</td>
<td id="S3.T1.3.3.3.14" class="ltx_td ltx_align_center">63.37</td>
<td id="S3.T1.3.3.3.1" class="ltx_td ltx_nopad_r ltx_align_center"><math id="S3.T1.3.3.3.1.m1.1" class="ltx_Math" alttext="8.58\times 10^{7}" display="inline"><semantics id="S3.T1.3.3.3.1.m1.1a"><mrow id="S3.T1.3.3.3.1.m1.1.1" xref="S3.T1.3.3.3.1.m1.1.1.cmml"><mn id="S3.T1.3.3.3.1.m1.1.1.2" xref="S3.T1.3.3.3.1.m1.1.1.2.cmml">8.58</mn><mo lspace="0.222em" rspace="0.222em" id="S3.T1.3.3.3.1.m1.1.1.1" xref="S3.T1.3.3.3.1.m1.1.1.1.cmml">Ã—</mo><msup id="S3.T1.3.3.3.1.m1.1.1.3" xref="S3.T1.3.3.3.1.m1.1.1.3.cmml"><mn id="S3.T1.3.3.3.1.m1.1.1.3.2" xref="S3.T1.3.3.3.1.m1.1.1.3.2.cmml">10</mn><mn id="S3.T1.3.3.3.1.m1.1.1.3.3" xref="S3.T1.3.3.3.1.m1.1.1.3.3.cmml">7</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.1.m1.1b"><apply id="S3.T1.3.3.3.1.m1.1.1.cmml" xref="S3.T1.3.3.3.1.m1.1.1"><times id="S3.T1.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.3.3.3.1.m1.1.1.1"></times><cn type="float" id="S3.T1.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.3.3.3.1.m1.1.1.2">8.58</cn><apply id="S3.T1.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.3.3.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.3.3.3.1.m1.1.1.3.1.cmml" xref="S3.T1.3.3.3.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.T1.3.3.3.1.m1.1.1.3.2.cmml" xref="S3.T1.3.3.3.1.m1.1.1.3.2">10</cn><cn type="integer" id="S3.T1.3.3.3.1.m1.1.1.3.3.cmml" xref="S3.T1.3.3.3.1.m1.1.1.3.3">7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.1.m1.1c">8.58\times 10^{7}</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.4.4.4" class="ltx_tr">
<td id="S3.T1.4.4.4.2" class="ltx_td ltx_align_left">FedRoDÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
<td id="S3.T1.4.4.4.3" class="ltx_td ltx_align_center">92.19</td>
<td id="S3.T1.4.4.4.4" class="ltx_td ltx_align_center">90.67</td>
<td id="S3.T1.4.4.4.5" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.4.4.4.6" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.4.4.4.7" class="ltx_td ltx_align_center">95.72</td>
<td id="S3.T1.4.4.4.8" class="ltx_td ltx_align_center">66.54</td>
<td id="S3.T1.4.4.4.9" class="ltx_td ltx_align_center">42.92</td>
<td id="S3.T1.4.4.4.10" class="ltx_td ltx_align_center">74.15</td>
<td id="S3.T1.4.4.4.11" class="ltx_td ltx_align_center">57.20</td>
<td id="S3.T1.4.4.4.12" class="ltx_td ltx_align_center">84.63</td>
<td id="S3.T1.4.4.4.13" class="ltx_td ltx_align_center">66.43</td>
<td id="S3.T1.4.4.4.14" class="ltx_td ltx_align_center">65.31</td>
<td id="S3.T1.4.4.4.1" class="ltx_td ltx_nopad_r ltx_align_center"><math id="S3.T1.4.4.4.1.m1.1" class="ltx_Math" alttext="8.58\times 10^{7}" display="inline"><semantics id="S3.T1.4.4.4.1.m1.1a"><mrow id="S3.T1.4.4.4.1.m1.1.1" xref="S3.T1.4.4.4.1.m1.1.1.cmml"><mn id="S3.T1.4.4.4.1.m1.1.1.2" xref="S3.T1.4.4.4.1.m1.1.1.2.cmml">8.58</mn><mo lspace="0.222em" rspace="0.222em" id="S3.T1.4.4.4.1.m1.1.1.1" xref="S3.T1.4.4.4.1.m1.1.1.1.cmml">Ã—</mo><msup id="S3.T1.4.4.4.1.m1.1.1.3" xref="S3.T1.4.4.4.1.m1.1.1.3.cmml"><mn id="S3.T1.4.4.4.1.m1.1.1.3.2" xref="S3.T1.4.4.4.1.m1.1.1.3.2.cmml">10</mn><mn id="S3.T1.4.4.4.1.m1.1.1.3.3" xref="S3.T1.4.4.4.1.m1.1.1.3.3.cmml">7</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.4.1.m1.1b"><apply id="S3.T1.4.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.4.1.m1.1.1"><times id="S3.T1.4.4.4.1.m1.1.1.1.cmml" xref="S3.T1.4.4.4.1.m1.1.1.1"></times><cn type="float" id="S3.T1.4.4.4.1.m1.1.1.2.cmml" xref="S3.T1.4.4.4.1.m1.1.1.2">8.58</cn><apply id="S3.T1.4.4.4.1.m1.1.1.3.cmml" xref="S3.T1.4.4.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.4.4.4.1.m1.1.1.3.1.cmml" xref="S3.T1.4.4.4.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.T1.4.4.4.1.m1.1.1.3.2.cmml" xref="S3.T1.4.4.4.1.m1.1.1.3.2">10</cn><cn type="integer" id="S3.T1.4.4.4.1.m1.1.1.3.3.cmml" xref="S3.T1.4.4.4.1.m1.1.1.3.3">7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.4.1.m1.1c">8.58\times 10^{7}</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.5.5.5" class="ltx_tr">
<td id="S3.T1.5.5.5.2" class="ltx_td ltx_align_left">FedBABUÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</td>
<td id="S3.T1.5.5.5.3" class="ltx_td ltx_align_center">89.06</td>
<td id="S3.T1.5.5.5.4" class="ltx_td ltx_align_center">85.78</td>
<td id="S3.T1.5.5.5.5" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.5.5.5.6" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.5.5.5.7" class="ltx_td ltx_align_center">93.71</td>
<td id="S3.T1.5.5.5.8" class="ltx_td ltx_align_center">63.31</td>
<td id="S3.T1.5.5.5.9" class="ltx_td ltx_align_center">43.07</td>
<td id="S3.T1.5.5.5.10" class="ltx_td ltx_align_center">74.80</td>
<td id="S3.T1.5.5.5.11" class="ltx_td ltx_align_center">43.80</td>
<td id="S3.T1.5.5.5.12" class="ltx_td ltx_align_center">87.26</td>
<td id="S3.T1.5.5.5.13" class="ltx_td ltx_align_center">67.15</td>
<td id="S3.T1.5.5.5.14" class="ltx_td ltx_align_center">63.23</td>
<td id="S3.T1.5.5.5.1" class="ltx_td ltx_nopad_r ltx_align_center"><math id="S3.T1.5.5.5.1.m1.1" class="ltx_Math" alttext="8.58\times 10^{7}" display="inline"><semantics id="S3.T1.5.5.5.1.m1.1a"><mrow id="S3.T1.5.5.5.1.m1.1.1" xref="S3.T1.5.5.5.1.m1.1.1.cmml"><mn id="S3.T1.5.5.5.1.m1.1.1.2" xref="S3.T1.5.5.5.1.m1.1.1.2.cmml">8.58</mn><mo lspace="0.222em" rspace="0.222em" id="S3.T1.5.5.5.1.m1.1.1.1" xref="S3.T1.5.5.5.1.m1.1.1.1.cmml">Ã—</mo><msup id="S3.T1.5.5.5.1.m1.1.1.3" xref="S3.T1.5.5.5.1.m1.1.1.3.cmml"><mn id="S3.T1.5.5.5.1.m1.1.1.3.2" xref="S3.T1.5.5.5.1.m1.1.1.3.2.cmml">10</mn><mn id="S3.T1.5.5.5.1.m1.1.1.3.3" xref="S3.T1.5.5.5.1.m1.1.1.3.3.cmml">7</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.5.1.m1.1b"><apply id="S3.T1.5.5.5.1.m1.1.1.cmml" xref="S3.T1.5.5.5.1.m1.1.1"><times id="S3.T1.5.5.5.1.m1.1.1.1.cmml" xref="S3.T1.5.5.5.1.m1.1.1.1"></times><cn type="float" id="S3.T1.5.5.5.1.m1.1.1.2.cmml" xref="S3.T1.5.5.5.1.m1.1.1.2">8.58</cn><apply id="S3.T1.5.5.5.1.m1.1.1.3.cmml" xref="S3.T1.5.5.5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.5.5.5.1.m1.1.1.3.1.cmml" xref="S3.T1.5.5.5.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.T1.5.5.5.1.m1.1.1.3.2.cmml" xref="S3.T1.5.5.5.1.m1.1.1.3.2">10</cn><cn type="integer" id="S3.T1.5.5.5.1.m1.1.1.3.3.cmml" xref="S3.T1.5.5.5.1.m1.1.1.3.3">7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.5.1.m1.1c">8.58\times 10^{7}</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.8.8.15.7" class="ltx_tr">
<td id="S3.T1.8.8.15.7.1" class="ltx_td ltx_align_left ltx_border_t" colspan="6"><span id="S3.T1.8.8.15.7.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Efficient Federated Learning</span></td>
<td id="S3.T1.8.8.15.7.2" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.15.7.3" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.15.7.4" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.15.7.5" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.15.7.6" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.15.7.7" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.15.7.8" class="ltx_td ltx_border_t"></td>
<td id="S3.T1.8.8.15.7.9" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S3.T1.6.6.6" class="ltx_tr">
<td id="S3.T1.6.6.6.2" class="ltx_td ltx_align_left">FedVPTÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</td>
<td id="S3.T1.6.6.6.3" class="ltx_td ltx_align_center">92.71</td>
<td id="S3.T1.6.6.6.4" class="ltx_td ltx_align_center">84.44</td>
<td id="S3.T1.6.6.6.5" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.6.6.6.6" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.6.6.6.7" class="ltx_td ltx_align_center">94.29</td>
<td id="S3.T1.6.6.6.8" class="ltx_td ltx_align_center">65.59</td>
<td id="S3.T1.6.6.6.9" class="ltx_td ltx_align_center">44.14</td>
<td id="S3.T1.6.6.6.10" class="ltx_td ltx_align_center">76.58</td>
<td id="S3.T1.6.6.6.11" class="ltx_td ltx_align_center">47.30</td>
<td id="S3.T1.6.6.6.12" class="ltx_td ltx_align_center">91.04</td>
<td id="S3.T1.6.6.6.13" class="ltx_td ltx_align_center">60.29</td>
<td id="S3.T1.6.6.6.14" class="ltx_td ltx_align_center">64.16</td>
<td id="S3.T1.6.6.6.1" class="ltx_td ltx_nopad_r ltx_align_center"><math id="S3.T1.6.6.6.1.m1.1" class="ltx_Math" alttext="7.68\times 10^{3}" display="inline"><semantics id="S3.T1.6.6.6.1.m1.1a"><mrow id="S3.T1.6.6.6.1.m1.1.1" xref="S3.T1.6.6.6.1.m1.1.1.cmml"><mn id="S3.T1.6.6.6.1.m1.1.1.2" xref="S3.T1.6.6.6.1.m1.1.1.2.cmml">7.68</mn><mo lspace="0.222em" rspace="0.222em" id="S3.T1.6.6.6.1.m1.1.1.1" xref="S3.T1.6.6.6.1.m1.1.1.1.cmml">Ã—</mo><msup id="S3.T1.6.6.6.1.m1.1.1.3" xref="S3.T1.6.6.6.1.m1.1.1.3.cmml"><mn id="S3.T1.6.6.6.1.m1.1.1.3.2" xref="S3.T1.6.6.6.1.m1.1.1.3.2.cmml">10</mn><mn id="S3.T1.6.6.6.1.m1.1.1.3.3" xref="S3.T1.6.6.6.1.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.6.1.m1.1b"><apply id="S3.T1.6.6.6.1.m1.1.1.cmml" xref="S3.T1.6.6.6.1.m1.1.1"><times id="S3.T1.6.6.6.1.m1.1.1.1.cmml" xref="S3.T1.6.6.6.1.m1.1.1.1"></times><cn type="float" id="S3.T1.6.6.6.1.m1.1.1.2.cmml" xref="S3.T1.6.6.6.1.m1.1.1.2">7.68</cn><apply id="S3.T1.6.6.6.1.m1.1.1.3.cmml" xref="S3.T1.6.6.6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.6.6.6.1.m1.1.1.3.1.cmml" xref="S3.T1.6.6.6.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.T1.6.6.6.1.m1.1.1.3.2.cmml" xref="S3.T1.6.6.6.1.m1.1.1.3.2">10</cn><cn type="integer" id="S3.T1.6.6.6.1.m1.1.1.3.3.cmml" xref="S3.T1.6.6.6.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.6.1.m1.1c">7.68\times 10^{3}</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.7.7.7" class="ltx_tr">
<td id="S3.T1.7.7.7.2" class="ltx_td ltx_align_left">FedVPT-DÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</td>
<td id="S3.T1.7.7.7.3" class="ltx_td ltx_align_center">91.67</td>
<td id="S3.T1.7.7.7.4" class="ltx_td ltx_align_center">89.33</td>
<td id="S3.T1.7.7.7.5" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.7.7.7.6" class="ltx_td ltx_align_center">100.0</td>
<td id="S3.T1.7.7.7.7" class="ltx_td ltx_align_center">95.25</td>
<td id="S3.T1.7.7.7.8" class="ltx_td ltx_align_center">63.31</td>
<td id="S3.T1.7.7.7.9" class="ltx_td ltx_align_center">43.07</td>
<td id="S3.T1.7.7.7.10" class="ltx_td ltx_align_center">74.80</td>
<td id="S3.T1.7.7.7.11" class="ltx_td ltx_align_center">54.80</td>
<td id="S3.T1.7.7.7.12" class="ltx_td ltx_align_center">87.26</td>
<td id="S3.T1.7.7.7.13" class="ltx_td ltx_align_center">67.15</td>
<td id="S3.T1.7.7.7.14" class="ltx_td ltx_align_center">65.07</td>
<td id="S3.T1.7.7.7.1" class="ltx_td ltx_nopad_r ltx_align_center"><math id="S3.T1.7.7.7.1.m1.1" class="ltx_Math" alttext="9.22\times 10^{3}" display="inline"><semantics id="S3.T1.7.7.7.1.m1.1a"><mrow id="S3.T1.7.7.7.1.m1.1.1" xref="S3.T1.7.7.7.1.m1.1.1.cmml"><mn id="S3.T1.7.7.7.1.m1.1.1.2" xref="S3.T1.7.7.7.1.m1.1.1.2.cmml">9.22</mn><mo lspace="0.222em" rspace="0.222em" id="S3.T1.7.7.7.1.m1.1.1.1" xref="S3.T1.7.7.7.1.m1.1.1.1.cmml">Ã—</mo><msup id="S3.T1.7.7.7.1.m1.1.1.3" xref="S3.T1.7.7.7.1.m1.1.1.3.cmml"><mn id="S3.T1.7.7.7.1.m1.1.1.3.2" xref="S3.T1.7.7.7.1.m1.1.1.3.2.cmml">10</mn><mn id="S3.T1.7.7.7.1.m1.1.1.3.3" xref="S3.T1.7.7.7.1.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.7.1.m1.1b"><apply id="S3.T1.7.7.7.1.m1.1.1.cmml" xref="S3.T1.7.7.7.1.m1.1.1"><times id="S3.T1.7.7.7.1.m1.1.1.1.cmml" xref="S3.T1.7.7.7.1.m1.1.1.1"></times><cn type="float" id="S3.T1.7.7.7.1.m1.1.1.2.cmml" xref="S3.T1.7.7.7.1.m1.1.1.2">9.22</cn><apply id="S3.T1.7.7.7.1.m1.1.1.3.cmml" xref="S3.T1.7.7.7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.7.7.7.1.m1.1.1.3.1.cmml" xref="S3.T1.7.7.7.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.T1.7.7.7.1.m1.1.1.3.2.cmml" xref="S3.T1.7.7.7.1.m1.1.1.3.2">10</cn><cn type="integer" id="S3.T1.7.7.7.1.m1.1.1.3.3.cmml" xref="S3.T1.7.7.7.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.7.1.m1.1c">9.22\times 10^{3}</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.8.8.8" class="ltx_tr">
<td id="S3.T1.8.8.8.2" class="ltx_td ltx_align_left ltx_border_bb">pFedPG (Ours)</td>
<td id="S3.T1.8.8.8.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.8.8.8.3.1" class="ltx_text ltx_font_bold">94.79</span></td>
<td id="S3.T1.8.8.8.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.8.8.8.4.1" class="ltx_text ltx_font_bold">92.44</span></td>
<td id="S3.T1.8.8.8.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.8.8.8.5.1" class="ltx_text ltx_font_bold">100.0</span></td>
<td id="S3.T1.8.8.8.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.8.8.8.6.1" class="ltx_text ltx_font_bold">100.0</span></td>
<td id="S3.T1.8.8.8.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.8.8.8.7.1" class="ltx_text ltx_font_bold">96.81</span></td>
<td id="S3.T1.8.8.8.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.8.8.8.8.1" class="ltx_text ltx_font_bold">73.00</span></td>
<td id="S3.T1.8.8.8.9" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.8.8.8.9.1" class="ltx_text ltx_font_bold">50.08</span></td>
<td id="S3.T1.8.8.8.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.8.8.8.10.1" class="ltx_text ltx_font_bold">84.33</span></td>
<td id="S3.T1.8.8.8.11" class="ltx_td ltx_align_center ltx_border_bb">60.00</td>
<td id="S3.T1.8.8.8.12" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.8.8.8.12.1" class="ltx_text ltx_font_bold">94.00</span></td>
<td id="S3.T1.8.8.8.13" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.8.8.8.13.1" class="ltx_text ltx_font_bold">68.41</span></td>
<td id="S3.T1.8.8.8.14" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.8.8.8.14.1" class="ltx_text ltx_font_bold">71.64</span></td>
<td id="S3.T1.8.8.8.1" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><math id="S3.T1.8.8.8.1.m1.1" class="ltx_Math" alttext="7.68\times 10^{3}" display="inline"><semantics id="S3.T1.8.8.8.1.m1.1a"><mrow id="S3.T1.8.8.8.1.m1.1.1" xref="S3.T1.8.8.8.1.m1.1.1.cmml"><mn id="S3.T1.8.8.8.1.m1.1.1.2" xref="S3.T1.8.8.8.1.m1.1.1.2.cmml">7.68</mn><mo lspace="0.222em" rspace="0.222em" id="S3.T1.8.8.8.1.m1.1.1.1" xref="S3.T1.8.8.8.1.m1.1.1.1.cmml">Ã—</mo><msup id="S3.T1.8.8.8.1.m1.1.1.3" xref="S3.T1.8.8.8.1.m1.1.1.3.cmml"><mn id="S3.T1.8.8.8.1.m1.1.1.3.2" xref="S3.T1.8.8.8.1.m1.1.1.3.2.cmml">10</mn><mn id="S3.T1.8.8.8.1.m1.1.1.3.3" xref="S3.T1.8.8.8.1.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.8.1.m1.1b"><apply id="S3.T1.8.8.8.1.m1.1.1.cmml" xref="S3.T1.8.8.8.1.m1.1.1"><times id="S3.T1.8.8.8.1.m1.1.1.1.cmml" xref="S3.T1.8.8.8.1.m1.1.1.1"></times><cn type="float" id="S3.T1.8.8.8.1.m1.1.1.2.cmml" xref="S3.T1.8.8.8.1.m1.1.1.2">7.68</cn><apply id="S3.T1.8.8.8.1.m1.1.1.3.cmml" xref="S3.T1.8.8.8.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.8.8.8.1.m1.1.1.3.1.cmml" xref="S3.T1.8.8.8.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.T1.8.8.8.1.m1.1.1.3.2.cmml" xref="S3.T1.8.8.8.1.m1.1.1.3.2">10</cn><cn type="integer" id="S3.T1.8.8.8.1.m1.1.1.3.3.cmml" xref="S3.T1.8.8.8.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.8.1.m1.1c">7.68\times 10^{3}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>pFedPG Training and Inference</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">In AlgorithmÂ <a href="#alg1" title="Algorithm 1 â€£ Learning of personalized prompt generation â€£ 3.2.2 Personalized prompt generation at the server â€£ 3.2 Efficient Model Personalization in FL via Client-Specific Prompt Generation â€£ 3 Proposed Method â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we summarize the training details of our proposed pFedPG. We alternate between the learning processes of personalized prompt generation and personalized prompt adaptation until converging.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.6" class="ltx_p">Once the learning of the proposed framework is complete, we deploy the learned client-specific prompts <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\textbf{P}_{n}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2a.cmml">P</mtext><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2a.cmml" xref="S3.SS3.p2.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">P</mtext></ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\textbf{P}_{n}</annotation></semantics></math> to instruct the pre-trained feature extractor <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="F^{*}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msup id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">F</mi><mo id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">ğ¹</ci><times id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">F^{*}</annotation></semantics></math> to extract discriminative representations together with locally trained classification head <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="H_{n}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">H</mi><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">ğ»</ci><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">H_{n}</annotation></semantics></math> for performing the recognition task at each client. Formally, the categorical predictions <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="y^{*}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msup id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">y</mi><mo id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">ğ‘¦</ci><times id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">y^{*}</annotation></semantics></math> over <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">ğ‘Œ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">Y</annotation></semantics></math> classes at each client <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><mi id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">n</annotation></semantics></math> can be computed as:</p>
<table id="S3.E6" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E6X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6X.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle y^{*}=\mathop{\arg\min}_{k\in K}{H_{n}(F^{*}(\left[c,\textbf{P}_{n},\mathtt{\textbf{x}}\right]))}." display="inline"><semantics id="S3.E6X.2.1.1.m1.3a"><mrow id="S3.E6X.2.1.1.m1.3.3.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.E6X.2.1.1.m1.3.3.1.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.cmml"><msup id="S3.E6X.2.1.1.m1.3.3.1.1.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.cmml"><mi id="S3.E6X.2.1.1.m1.3.3.1.1.3.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.cmml">y</mi><mo id="S3.E6X.2.1.1.m1.3.3.1.1.3.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.cmml">âˆ—</mo></msup><mo id="S3.E6X.2.1.1.m1.3.3.1.1.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.cmml"><munder id="S3.E6X.2.1.1.m1.3.3.1.1.1.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.cmml"><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2.cmml"><mi id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2a" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2.cmml">â¡</mo><mi id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2.2.cmml">min</mi></mrow><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.cmml"><mi id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.2.cmml">k</mi><mo id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.1.cmml">âˆˆ</mo><mi id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.3.cmml">K</mi></mrow></munder><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.1.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.cmml"><msub id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3.2.cmml">H</mi><mi id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><msup id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">F</mi><mo id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">âˆ—</mo></msup><mo lspace="0em" rspace="0em" id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">[</mo><mi id="S3.E6X.2.1.1.m1.1.1" xref="S3.E6X.2.1.1.m1.1.1.cmml">c</mi><mo id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml">P</mtext><mi id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S3.E6X.2.1.1.m1.2.2" xref="S3.E6X.2.1.1.m1.2.2a.cmml">x</mtext><mo id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.5" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">]</mo></mrow><mo stretchy="false" id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E6X.2.1.1.m1.3.3.1.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6X.2.1.1.m1.3b"><apply id="S3.E6X.2.1.1.m1.3.3.1.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1"><eq id="S3.E6X.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.2"></eq><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.3.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3">superscript</csymbol><ci id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2">ğ‘¦</ci><times id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3"></times></apply><apply id="S3.E6X.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1"><apply id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2">subscript</csymbol><apply id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2"><arg id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2.1"></arg><min id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.2.2"></min></apply><apply id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3"><in id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.1"></in><ci id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.2">ğ‘˜</ci><ci id="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.2.3.3">ğ¾</ci></apply></apply><apply id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1"><times id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.2"></times><apply id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3.2">ğ»</ci><ci id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.3.3">ğ‘›</ci></apply><apply id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1"><times id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2"></times><apply id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.2">ğ¹</ci><times id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.3"></times></apply><list id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><ci id="S3.E6X.2.1.1.m1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1">ğ‘</ci><apply id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">P</mtext></ci><ci id="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">ğ‘›</ci></apply><ci id="S3.E6X.2.1.1.m1.2.2a.cmml" xref="S3.E6X.2.1.1.m1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E6X.2.1.1.m1.2.2.cmml" xref="S3.E6X.2.1.1.m1.2.2">x</mtext></ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6X.2.1.1.m1.3c">\displaystyle y^{*}=\mathop{\arg\min}_{k\in K}{H_{n}(F^{*}(\left[c,\textbf{P}_{n},\mathtt{\textbf{x}}\right]))}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets and Experimental Setup</h3>

<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Datasets</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p">We evaluate our method on five public benchmark datasets covering types of data heterogeneity, including domain discrepancy and imbalanced class distribution. For <span id="S4.SS1.SSS1.p1.1.1" class="ltx_text ltx_font_italic">domain discrepancy</span>, <span id="S4.SS1.SSS1.p1.1.2" class="ltx_text ltx_font_bold">Office-Caltech10</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> is composed of four data domains including <span id="S4.SS1.SSS1.p1.1.3" class="ltx_text ltx_font_italic">Amazon</span>, <span id="S4.SS1.SSS1.p1.1.4" class="ltx_text ltx_font_italic">DSLR</span>, <span id="S4.SS1.SSS1.p1.1.5" class="ltx_text ltx_font_italic">Webcam</span>, and <span id="S4.SS1.SSS1.p1.1.6" class="ltx_text ltx_font_italic">Caltech</span>. Each domain contains ten classes, with 2,533 images in total.
<span id="S4.SS1.SSS1.p1.1.7" class="ltx_text ltx_font_bold">DomainNet</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> consists of 0.6 million images of 345 classes distributed across six domains, <span id="S4.SS1.SSS1.p1.1.8" class="ltx_text ltx_font_italic">Clipart</span>, <span id="S4.SS1.SSS1.p1.1.9" class="ltx_text ltx_font_italic">Infograph</span>, <span id="S4.SS1.SSS1.p1.1.10" class="ltx_text ltx_font_italic">Painting</span>, <span id="S4.SS1.SSS1.p1.1.11" class="ltx_text ltx_font_italic">Quickdraw</span>, <span id="S4.SS1.SSS1.p1.1.12" class="ltx_text ltx_font_italic">Real</span> and <span id="S4.SS1.SSS1.p1.1.13" class="ltx_text ltx_font_italic">Sketch</span>. FollowingÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, we use the top ten most frequent classes to form a sub-dataset for our experiments.
As for medical image diagnosis tasks, <span id="S4.SS1.SSS1.p1.1.14" class="ltx_text ltx_font_bold">Dermoscopic-FL</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> is comprised of four data sites collected from HAM10KÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> and MSKÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Each data site contains three types of skin lesions, with 10,490 images in total. More detailed statistics and sampled images are provided in the supplementary material.
For <span id="S4.SS1.SSS1.p1.1.15" class="ltx_text ltx_font_italic">imbalanced class distribution</span>, <span id="S4.SS1.SSS1.p1.1.16" class="ltx_text ltx_font_bold">CIFAR-10</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> contains 5,000 training images and 1,000 testing images per class, totaling ten classes. <span id="S4.SS1.SSS1.p1.1.17" class="ltx_text ltx_font_bold">CIFAR-100</span>Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> consists of 60,000 images of 100 categories with 500 training images and 100 testing images per class.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Experimental settings</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.6" class="ltx_p">To properly evaluate our proposed approach and fairly compare it with existing FL methods, we conduct experiments on two types of heterogeneous FL settings: domain discrepancy and imbalanced class distribution.
For conducting clients with <span id="S4.SS1.SSS2.p1.6.1" class="ltx_text ltx_font_italic">domain discrepancy</span>, we assign a data domain to a client, indicating the number of clients (<math id="S4.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS1.SSS2.p1.1.m1.1a"><mi id="S4.SS1.SSS2.p1.1.m1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.1b"><ci id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.1c">N</annotation></semantics></math>) is set as 4, 6, and 4 for Office-Caltech10, DomainNet, and Dermoscopic-FL datasets, respectively.
As for simulating <span id="S4.SS1.SSS2.p1.6.2" class="ltx_text ltx_font_italic">imbalanced class distribution</span>, we consider two non-IID settings using CIFAR-10 and CIFAR-100. FollowingÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, the first non-IID setting we considered is randomly selecting disjoint <math id="S4.SS1.SSS2.p1.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.SSS2.p1.2.m2.1a"><mi id="S4.SS1.SSS2.p1.2.m2.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.2.m2.1b"><ci id="S4.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.2.m2.1c">c</annotation></semantics></math> classes for each client and denoted as <em id="S4.SS1.SSS2.p1.6.3" class="ltx_emph ltx_font_italic">disjoint label space</em>. In our experiments, <math id="S4.SS1.SSS2.p1.3.m3.1" class="ltx_Math" alttext="c=2" display="inline"><semantics id="S4.SS1.SSS2.p1.3.m3.1a"><mrow id="S4.SS1.SSS2.p1.3.m3.1.1" xref="S4.SS1.SSS2.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS2.p1.3.m3.1.1.2" xref="S4.SS1.SSS2.p1.3.m3.1.1.2.cmml">c</mi><mo id="S4.SS1.SSS2.p1.3.m3.1.1.1" xref="S4.SS1.SSS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS2.p1.3.m3.1.1.3" xref="S4.SS1.SSS2.p1.3.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.3.m3.1b"><apply id="S4.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1"><eq id="S4.SS1.SSS2.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1.1"></eq><ci id="S4.SS1.SSS2.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1.2">ğ‘</ci><cn type="integer" id="S4.SS1.SSS2.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.3.m3.1c">c=2</annotation></semantics></math> and <math id="S4.SS1.SSS2.p1.4.m4.1" class="ltx_Math" alttext="c=10" display="inline"><semantics id="S4.SS1.SSS2.p1.4.m4.1a"><mrow id="S4.SS1.SSS2.p1.4.m4.1.1" xref="S4.SS1.SSS2.p1.4.m4.1.1.cmml"><mi id="S4.SS1.SSS2.p1.4.m4.1.1.2" xref="S4.SS1.SSS2.p1.4.m4.1.1.2.cmml">c</mi><mo id="S4.SS1.SSS2.p1.4.m4.1.1.1" xref="S4.SS1.SSS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS2.p1.4.m4.1.1.3" xref="S4.SS1.SSS2.p1.4.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.4.m4.1b"><apply id="S4.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1"><eq id="S4.SS1.SSS2.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1.1"></eq><ci id="S4.SS1.SSS2.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1.2">ğ‘</ci><cn type="integer" id="S4.SS1.SSS2.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.4.m4.1c">c=10</annotation></semantics></math> for CIFAR-10 and CIFAR-100, respectively.
As for the other non-IID setting, data in each class would be partitioned into all clients following a Dirichlet distribution <math id="S4.SS1.SSS2.p1.5.m5.1" class="ltx_Math" alttext="Dir(\alpha)" display="inline"><semantics id="S4.SS1.SSS2.p1.5.m5.1a"><mrow id="S4.SS1.SSS2.p1.5.m5.1.2" xref="S4.SS1.SSS2.p1.5.m5.1.2.cmml"><mi id="S4.SS1.SSS2.p1.5.m5.1.2.2" xref="S4.SS1.SSS2.p1.5.m5.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p1.5.m5.1.2.1" xref="S4.SS1.SSS2.p1.5.m5.1.2.1.cmml">â€‹</mo><mi id="S4.SS1.SSS2.p1.5.m5.1.2.3" xref="S4.SS1.SSS2.p1.5.m5.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p1.5.m5.1.2.1a" xref="S4.SS1.SSS2.p1.5.m5.1.2.1.cmml">â€‹</mo><mi id="S4.SS1.SSS2.p1.5.m5.1.2.4" xref="S4.SS1.SSS2.p1.5.m5.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p1.5.m5.1.2.1b" xref="S4.SS1.SSS2.p1.5.m5.1.2.1.cmml">â€‹</mo><mrow id="S4.SS1.SSS2.p1.5.m5.1.2.5.2" xref="S4.SS1.SSS2.p1.5.m5.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p1.5.m5.1.2.5.2.1" xref="S4.SS1.SSS2.p1.5.m5.1.2.cmml">(</mo><mi id="S4.SS1.SSS2.p1.5.m5.1.1" xref="S4.SS1.SSS2.p1.5.m5.1.1.cmml">Î±</mi><mo stretchy="false" id="S4.SS1.SSS2.p1.5.m5.1.2.5.2.2" xref="S4.SS1.SSS2.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.5.m5.1b"><apply id="S4.SS1.SSS2.p1.5.m5.1.2.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.2"><times id="S4.SS1.SSS2.p1.5.m5.1.2.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.2.1"></times><ci id="S4.SS1.SSS2.p1.5.m5.1.2.2.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.2.2">ğ·</ci><ci id="S4.SS1.SSS2.p1.5.m5.1.2.3.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.2.3">ğ‘–</ci><ci id="S4.SS1.SSS2.p1.5.m5.1.2.4.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.2.4">ğ‘Ÿ</ci><ci id="S4.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1">ğ›¼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.5.m5.1c">Dir(\alpha)</annotation></semantics></math>. We follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and set <math id="S4.SS1.SSS2.p1.6.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.SSS2.p1.6.m6.1a"><mi id="S4.SS1.SSS2.p1.6.m6.1.1" xref="S4.SS1.SSS2.p1.6.m6.1.1.cmml">Î±</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.6.m6.1b"><ci id="S4.SS1.SSS2.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1">ğ›¼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.6.m6.1c">\alpha</annotation></semantics></math> to 0.1 over 10 clients.</p>
</div>
</section>
<section id="S4.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3 </span>Implementation details</h4>

<div id="S4.SS1.SSS3.p1" class="ltx_para">
<p id="S4.SS1.SSS3.p1.15" class="ltx_p">We use ViT-B/16Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> pre-trained on ImageNet21kÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> as the backbone of <math id="S4.SS1.SSS3.p1.1.m1.1" class="ltx_Math" alttext="F^{*}" display="inline"><semantics id="S4.SS1.SSS3.p1.1.m1.1a"><msup id="S4.SS1.SSS3.p1.1.m1.1.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS3.p1.1.m1.1.1.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.2.cmml">F</mi><mo id="S4.SS1.SSS3.p1.1.m1.1.1.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.1.m1.1b"><apply id="S4.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.SSS3.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.2">ğ¹</ci><times id="S4.SS1.SSS3.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.1.m1.1c">F^{*}</annotation></semantics></math> and a single linear layer to realize the classification head <math id="S4.SS1.SSS3.p1.2.m2.1" class="ltx_Math" alttext="H_{n}" display="inline"><semantics id="S4.SS1.SSS3.p1.2.m2.1a"><msub id="S4.SS1.SSS3.p1.2.m2.1.1" xref="S4.SS1.SSS3.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS3.p1.2.m2.1.1.2" xref="S4.SS1.SSS3.p1.2.m2.1.1.2.cmml">H</mi><mi id="S4.SS1.SSS3.p1.2.m2.1.1.3" xref="S4.SS1.SSS3.p1.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.2.m2.1b"><apply id="S4.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1.2">ğ»</ci><ci id="S4.SS1.SSS3.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.2.m2.1c">H_{n}</annotation></semantics></math>. The input images of all datasets are resized to 224 <math id="S4.SS1.SSS3.p1.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS1.SSS3.p1.3.m3.1a"><mo id="S4.SS1.SSS3.p1.3.m3.1.1" xref="S4.SS1.SSS3.p1.3.m3.1.1.cmml">Ã—</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.3.m3.1b"><times id="S4.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.3.m3.1c">\times</annotation></semantics></math> 224 pixels. For each client, we train <math id="S4.SS1.SSS3.p1.4.m4.1" class="ltx_Math" alttext="\mathtt{\textbf{P}_{n}}" display="inline"><semantics id="S4.SS1.SSS3.p1.4.m4.1a"><msub id="S4.SS1.SSS3.p1.4.m4.1.1" xref="S4.SS1.SSS3.p1.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS3.p1.4.m4.1.1.2" xref="S4.SS1.SSS3.p1.4.m4.1.1.2a.cmml">P</mtext><mi id="S4.SS1.SSS3.p1.4.m4.1.1.3" xref="S4.SS1.SSS3.p1.4.m4.1.1.3.cmml">ğš—</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.4.m4.1b"><apply id="S4.SS1.SSS3.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.4.m4.1.1.2a.cmml" xref="S4.SS1.SSS3.p1.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS3.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS3.p1.4.m4.1.1.2">P</mtext></ci><ci id="S4.SS1.SSS3.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS3.p1.4.m4.1.1.3">ğš—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.4.m4.1c">\mathtt{\textbf{P}_{n}}</annotation></semantics></math> and <math id="S4.SS1.SSS3.p1.5.m5.1" class="ltx_Math" alttext="H_{n}" display="inline"><semantics id="S4.SS1.SSS3.p1.5.m5.1a"><msub id="S4.SS1.SSS3.p1.5.m5.1.1" xref="S4.SS1.SSS3.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS3.p1.5.m5.1.1.2" xref="S4.SS1.SSS3.p1.5.m5.1.1.2.cmml">H</mi><mi id="S4.SS1.SSS3.p1.5.m5.1.1.3" xref="S4.SS1.SSS3.p1.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.5.m5.1b"><apply id="S4.SS1.SSS3.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1.2">ğ»</ci><ci id="S4.SS1.SSS3.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.5.m5.1c">H_{n}</annotation></semantics></math> using the SGD optimizer with a learning rate <math id="S4.SS1.SSS3.p1.6.m6.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.SSS3.p1.6.m6.1a"><mi id="S4.SS1.SSS3.p1.6.m6.1.1" xref="S4.SS1.SSS3.p1.6.m6.1.1.cmml">Î³</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.6.m6.1b"><ci id="S4.SS1.SSS3.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS3.p1.6.m6.1.1">ğ›¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.6.m6.1c">\gamma</annotation></semantics></math> of 0.25 with a weight decay rate of 0.001 and a batch size of 64 for 5 epochs. The number of communication round <math id="S4.SS1.SSS3.p1.7.m7.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS1.SSS3.p1.7.m7.1a"><mi id="S4.SS1.SSS3.p1.7.m7.1.1" xref="S4.SS1.SSS3.p1.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.7.m7.1b"><ci id="S4.SS1.SSS3.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS3.p1.7.m7.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.7.m7.1c">T</annotation></semantics></math> is set to 100. We set the learning rate <math id="S4.SS1.SSS3.p1.8.m8.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.SSS3.p1.8.m8.1a"><mi id="S4.SS1.SSS3.p1.8.m8.1.1" xref="S4.SS1.SSS3.p1.8.m8.1.1.cmml">Î±</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.8.m8.1b"><ci id="S4.SS1.SSS3.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS3.p1.8.m8.1.1">ğ›¼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.8.m8.1c">\alpha</annotation></semantics></math> for updating <math id="S4.SS1.SSS3.p1.9.m9.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS1.SSS3.p1.9.m9.1a"><mi id="S4.SS1.SSS3.p1.9.m9.1.1" xref="S4.SS1.SSS3.p1.9.m9.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.9.m9.1b"><ci id="S4.SS1.SSS3.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS3.p1.9.m9.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.9.m9.1c">G</annotation></semantics></math>, <math id="S4.SS1.SSS3.p1.10.m10.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S4.SS1.SSS3.p1.10.m10.1a"><msub id="S4.SS1.SSS3.p1.10.m10.1.1" xref="S4.SS1.SSS3.p1.10.m10.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS3.p1.10.m10.1.1.2" xref="S4.SS1.SSS3.p1.10.m10.1.1.2a.cmml">P</mtext><mrow id="S4.SS1.SSS3.p1.10.m10.1.1.3" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.cmml"><mi id="S4.SS1.SSS3.p1.10.m10.1.1.3.2" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p1.10.m10.1.1.3.1" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS1.SSS3.p1.10.m10.1.1.3.3" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p1.10.m10.1.1.3.1a" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS1.SSS3.p1.10.m10.1.1.3.4" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p1.10.m10.1.1.3.1b" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS1.SSS3.p1.10.m10.1.1.3.5" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.10.m10.1b"><apply id="S4.SS1.SSS3.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.10.m10.1.1.1.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.10.m10.1.1.2a.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS3.p1.10.m10.1.1.2.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1.2">P</mtext></ci><apply id="S4.SS1.SSS3.p1.10.m10.1.1.3.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1.3"><times id="S4.SS1.SSS3.p1.10.m10.1.1.3.1.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.1"></times><ci id="S4.SS1.SSS3.p1.10.m10.1.1.3.2.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.2">ğ‘</ci><ci id="S4.SS1.SSS3.p1.10.m10.1.1.3.3.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.3">ğ‘</ci><ci id="S4.SS1.SSS3.p1.10.m10.1.1.3.4.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.4">ğ‘ </ci><ci id="S4.SS1.SSS3.p1.10.m10.1.1.3.5.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.10.m10.1c">\textbf{P}_{base}</annotation></semantics></math>, and <math id="S4.SS1.SSS3.p1.11.m11.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.SS1.SSS3.p1.11.m11.1a"><mi id="S4.SS1.SSS3.p1.11.m11.1.1" xref="S4.SS1.SSS3.p1.11.m11.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.11.m11.1b"><ci id="S4.SS1.SSS3.p1.11.m11.1.1.cmml" xref="S4.SS1.SSS3.p1.11.m11.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.11.m11.1c">D</annotation></semantics></math> to 0.001. The number of prompts <math id="S4.SS1.SSS3.p1.12.m12.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS1.SSS3.p1.12.m12.1a"><mi id="S4.SS1.SSS3.p1.12.m12.1.1" xref="S4.SS1.SSS3.p1.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.12.m12.1b"><ci id="S4.SS1.SSS3.p1.12.m12.1.1.cmml" xref="S4.SS1.SSS3.p1.12.m12.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.12.m12.1c">K</annotation></semantics></math> of <math id="S4.SS1.SSS3.p1.13.m13.1" class="ltx_Math" alttext="\mathtt{\textbf{P}_{n}}" display="inline"><semantics id="S4.SS1.SSS3.p1.13.m13.1a"><msub id="S4.SS1.SSS3.p1.13.m13.1.1" xref="S4.SS1.SSS3.p1.13.m13.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS3.p1.13.m13.1.1.2" xref="S4.SS1.SSS3.p1.13.m13.1.1.2a.cmml">P</mtext><mi id="S4.SS1.SSS3.p1.13.m13.1.1.3" xref="S4.SS1.SSS3.p1.13.m13.1.1.3.cmml">ğš—</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.13.m13.1b"><apply id="S4.SS1.SSS3.p1.13.m13.1.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.13.m13.1.1.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.13.m13.1.1.2a.cmml" xref="S4.SS1.SSS3.p1.13.m13.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS3.p1.13.m13.1.1.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.1.1.2">P</mtext></ci><ci id="S4.SS1.SSS3.p1.13.m13.1.1.3.cmml" xref="S4.SS1.SSS3.p1.13.m13.1.1.3">ğš—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.13.m13.1c">\mathtt{\textbf{P}_{n}}</annotation></semantics></math> and <math id="S4.SS1.SSS3.p1.14.m14.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S4.SS1.SSS3.p1.14.m14.1a"><msub id="S4.SS1.SSS3.p1.14.m14.1.1" xref="S4.SS1.SSS3.p1.14.m14.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS3.p1.14.m14.1.1.2" xref="S4.SS1.SSS3.p1.14.m14.1.1.2a.cmml">P</mtext><mrow id="S4.SS1.SSS3.p1.14.m14.1.1.3" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.cmml"><mi id="S4.SS1.SSS3.p1.14.m14.1.1.3.2" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p1.14.m14.1.1.3.1" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS1.SSS3.p1.14.m14.1.1.3.3" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p1.14.m14.1.1.3.1a" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS1.SSS3.p1.14.m14.1.1.3.4" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p1.14.m14.1.1.3.1b" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS1.SSS3.p1.14.m14.1.1.3.5" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.14.m14.1b"><apply id="S4.SS1.SSS3.p1.14.m14.1.1.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.14.m14.1.1.1.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.14.m14.1.1.2a.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.SSS3.p1.14.m14.1.1.2.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1.2">P</mtext></ci><apply id="S4.SS1.SSS3.p1.14.m14.1.1.3.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1.3"><times id="S4.SS1.SSS3.p1.14.m14.1.1.3.1.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.1"></times><ci id="S4.SS1.SSS3.p1.14.m14.1.1.3.2.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.2">ğ‘</ci><ci id="S4.SS1.SSS3.p1.14.m14.1.1.3.3.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.3">ğ‘</ci><ci id="S4.SS1.SSS3.p1.14.m14.1.1.3.4.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.4">ğ‘ </ci><ci id="S4.SS1.SSS3.p1.14.m14.1.1.3.5.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.14.m14.1c">\textbf{P}_{base}</annotation></semantics></math> is set as 10 for datasets except for Dermoscopic-FL with <math id="S4.SS1.SSS3.p1.15.m15.1" class="ltx_Math" alttext="K=3" display="inline"><semantics id="S4.SS1.SSS3.p1.15.m15.1a"><mrow id="S4.SS1.SSS3.p1.15.m15.1.1" xref="S4.SS1.SSS3.p1.15.m15.1.1.cmml"><mi id="S4.SS1.SSS3.p1.15.m15.1.1.2" xref="S4.SS1.SSS3.p1.15.m15.1.1.2.cmml">K</mi><mo id="S4.SS1.SSS3.p1.15.m15.1.1.1" xref="S4.SS1.SSS3.p1.15.m15.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.p1.15.m15.1.1.3" xref="S4.SS1.SSS3.p1.15.m15.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.15.m15.1b"><apply id="S4.SS1.SSS3.p1.15.m15.1.1.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.1"><eq id="S4.SS1.SSS3.p1.15.m15.1.1.1.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.1.1"></eq><ci id="S4.SS1.SSS3.p1.15.m15.1.1.2.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.1.2">ğ¾</ci><cn type="integer" id="S4.SS1.SSS3.p1.15.m15.1.1.3.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.15.m15.1c">K=3</annotation></semantics></math>. The hyperparameters above are tuned by cross-validation.
In all our experiments, we implement our model using PyTorchÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> and conduct training on NVIDIA TESLA V100 GPUs with 32 GB memory.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Quantitative comparisons on CIFAR-10/100 datasets using ViT-B/16. <span id="S4.T2.4.1" class="ltx_text ltx_font_bold">Bold</span> denotes the best result.</figcaption>
<div id="S4.T2.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:223.6pt;height:155.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-81.9pt,57.1pt) scale(0.577119428356334,0.577119428356334) ;">
<table id="S4.T2.2.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.2.2.3.1" class="ltx_tr">
<th id="S4.T2.2.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt">Datasets</th>
<td id="S4.T2.2.2.3.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">CIFAR-10 (%)</td>
<td id="S4.T2.2.2.3.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">CIFAR-100 (%)</td>
</tr>
<tr id="S4.T2.2.2.2" class="ltx_tr">
<th id="S4.T2.2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Method</th>
<td id="S4.T2.2.2.2.4" class="ltx_td ltx_align_center ltx_border_t">Disjoint</td>
<td id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="Dir(0.1)" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.1.m1.1.2" xref="S4.T2.1.1.1.1.m1.1.2.cmml"><mi id="S4.T2.1.1.1.1.m1.1.2.2" xref="S4.T2.1.1.1.1.m1.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.T2.1.1.1.1.m1.1.2.1" xref="S4.T2.1.1.1.1.m1.1.2.1.cmml">â€‹</mo><mi id="S4.T2.1.1.1.1.m1.1.2.3" xref="S4.T2.1.1.1.1.m1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T2.1.1.1.1.m1.1.2.1a" xref="S4.T2.1.1.1.1.m1.1.2.1.cmml">â€‹</mo><mi id="S4.T2.1.1.1.1.m1.1.2.4" xref="S4.T2.1.1.1.1.m1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T2.1.1.1.1.m1.1.2.1b" xref="S4.T2.1.1.1.1.m1.1.2.1.cmml">â€‹</mo><mrow id="S4.T2.1.1.1.1.m1.1.2.5.2" xref="S4.T2.1.1.1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.T2.1.1.1.1.m1.1.2.5.2.1" xref="S4.T2.1.1.1.1.m1.1.2.cmml">(</mo><mn id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">0.1</mn><mo stretchy="false" id="S4.T2.1.1.1.1.m1.1.2.5.2.2" xref="S4.T2.1.1.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.2"><times id="S4.T2.1.1.1.1.m1.1.2.1.cmml" xref="S4.T2.1.1.1.1.m1.1.2.1"></times><ci id="S4.T2.1.1.1.1.m1.1.2.2.cmml" xref="S4.T2.1.1.1.1.m1.1.2.2">ğ·</ci><ci id="S4.T2.1.1.1.1.m1.1.2.3.cmml" xref="S4.T2.1.1.1.1.m1.1.2.3">ğ‘–</ci><ci id="S4.T2.1.1.1.1.m1.1.2.4.cmml" xref="S4.T2.1.1.1.1.m1.1.2.4">ğ‘Ÿ</ci><cn type="float" id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">Dir(0.1)</annotation></semantics></math></td>
<td id="S4.T2.2.2.2.5" class="ltx_td ltx_align_center ltx_border_t">Disjoint</td>
<td id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="Dir(0.1)" display="inline"><semantics id="S4.T2.2.2.2.2.m1.1a"><mrow id="S4.T2.2.2.2.2.m1.1.2" xref="S4.T2.2.2.2.2.m1.1.2.cmml"><mi id="S4.T2.2.2.2.2.m1.1.2.2" xref="S4.T2.2.2.2.2.m1.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.T2.2.2.2.2.m1.1.2.1" xref="S4.T2.2.2.2.2.m1.1.2.1.cmml">â€‹</mo><mi id="S4.T2.2.2.2.2.m1.1.2.3" xref="S4.T2.2.2.2.2.m1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T2.2.2.2.2.m1.1.2.1a" xref="S4.T2.2.2.2.2.m1.1.2.1.cmml">â€‹</mo><mi id="S4.T2.2.2.2.2.m1.1.2.4" xref="S4.T2.2.2.2.2.m1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T2.2.2.2.2.m1.1.2.1b" xref="S4.T2.2.2.2.2.m1.1.2.1.cmml">â€‹</mo><mrow id="S4.T2.2.2.2.2.m1.1.2.5.2" xref="S4.T2.2.2.2.2.m1.1.2.cmml"><mo stretchy="false" id="S4.T2.2.2.2.2.m1.1.2.5.2.1" xref="S4.T2.2.2.2.2.m1.1.2.cmml">(</mo><mn id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml">0.1</mn><mo stretchy="false" id="S4.T2.2.2.2.2.m1.1.2.5.2.2" xref="S4.T2.2.2.2.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><apply id="S4.T2.2.2.2.2.m1.1.2.cmml" xref="S4.T2.2.2.2.2.m1.1.2"><times id="S4.T2.2.2.2.2.m1.1.2.1.cmml" xref="S4.T2.2.2.2.2.m1.1.2.1"></times><ci id="S4.T2.2.2.2.2.m1.1.2.2.cmml" xref="S4.T2.2.2.2.2.m1.1.2.2">ğ·</ci><ci id="S4.T2.2.2.2.2.m1.1.2.3.cmml" xref="S4.T2.2.2.2.2.m1.1.2.3">ğ‘–</ci><ci id="S4.T2.2.2.2.2.m1.1.2.4.cmml" xref="S4.T2.2.2.2.2.m1.1.2.4">ğ‘Ÿ</ci><cn type="float" id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">Dir(0.1)</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.2.2.4.2" class="ltx_tr">
<th id="S4.T2.2.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="5"><span id="S4.T2.2.2.4.2.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Baselines</span></th>
</tr>
<tr id="S4.T2.2.2.5.3" class="ltx_tr">
<th id="S4.T2.2.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SingleSet-Full</th>
<td id="S4.T2.2.2.5.3.2" class="ltx_td ltx_align_center">89.51</td>
<td id="S4.T2.2.2.5.3.3" class="ltx_td ltx_align_center">83.85</td>
<td id="S4.T2.2.2.5.3.4" class="ltx_td ltx_align_center">67.74</td>
<td id="S4.T2.2.2.5.3.5" class="ltx_td ltx_align_center">49.64</td>
</tr>
<tr id="S4.T2.2.2.6.4" class="ltx_tr">
<th id="S4.T2.2.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SingleSet-VPTÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</th>
<td id="S4.T2.2.2.6.4.2" class="ltx_td ltx_align_center">88.91</td>
<td id="S4.T2.2.2.6.4.3" class="ltx_td ltx_align_center">84.32</td>
<td id="S4.T2.2.2.6.4.4" class="ltx_td ltx_align_center">63.42</td>
<td id="S4.T2.2.2.6.4.5" class="ltx_td ltx_align_center">46.46</td>
</tr>
<tr id="S4.T2.2.2.7.5" class="ltx_tr">
<th id="S4.T2.2.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>
</th>
<td id="S4.T2.2.2.7.5.2" class="ltx_td ltx_align_center">88.04</td>
<td id="S4.T2.2.2.7.5.3" class="ltx_td ltx_align_center">79.79</td>
<td id="S4.T2.2.2.7.5.4" class="ltx_td ltx_align_center">63.33</td>
<td id="S4.T2.2.2.7.5.5" class="ltx_td ltx_align_center">51.37</td>
</tr>
<tr id="S4.T2.2.2.8.6" class="ltx_tr">
<th id="S4.T2.2.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="5"><span id="S4.T2.2.2.8.6.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Personalized Federated Learning</span></th>
</tr>
<tr id="S4.T2.2.2.9.7" class="ltx_tr">
<th id="S4.T2.2.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Per-FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</th>
<td id="S4.T2.2.2.9.7.2" class="ltx_td ltx_align_center">88.13</td>
<td id="S4.T2.2.2.9.7.3" class="ltx_td ltx_align_center">85.14</td>
<td id="S4.T2.2.2.9.7.4" class="ltx_td ltx_align_center">69.31</td>
<td id="S4.T2.2.2.9.7.5" class="ltx_td ltx_align_center">52.68</td>
</tr>
<tr id="S4.T2.2.2.10.8" class="ltx_tr">
<th id="S4.T2.2.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedRepÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</th>
<td id="S4.T2.2.2.10.8.2" class="ltx_td ltx_align_center">87.07</td>
<td id="S4.T2.2.2.10.8.3" class="ltx_td ltx_align_center">82.40</td>
<td id="S4.T2.2.2.10.8.4" class="ltx_td ltx_align_center">65.71</td>
<td id="S4.T2.2.2.10.8.5" class="ltx_td ltx_align_center">50.36</td>
</tr>
<tr id="S4.T2.2.2.11.9" class="ltx_tr">
<th id="S4.T2.2.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedRoDÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</th>
<td id="S4.T2.2.2.11.9.2" class="ltx_td ltx_align_center">87.61</td>
<td id="S4.T2.2.2.11.9.3" class="ltx_td ltx_align_center">80.36</td>
<td id="S4.T2.2.2.11.9.4" class="ltx_td ltx_align_center">63.90</td>
<td id="S4.T2.2.2.11.9.5" class="ltx_td ltx_align_center">51.42</td>
</tr>
<tr id="S4.T2.2.2.12.10" class="ltx_tr">
<th id="S4.T2.2.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedBABUÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</th>
<td id="S4.T2.2.2.12.10.2" class="ltx_td ltx_align_center">83.15</td>
<td id="S4.T2.2.2.12.10.3" class="ltx_td ltx_align_center">76.33</td>
<td id="S4.T2.2.2.12.10.4" class="ltx_td ltx_align_center">55.91</td>
<td id="S4.T2.2.2.12.10.5" class="ltx_td ltx_align_center">50.19</td>
</tr>
<tr id="S4.T2.2.2.13.11" class="ltx_tr">
<th id="S4.T2.2.2.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="5"><span id="S4.T2.2.2.13.11.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Efficient Federated Learning</span></th>
</tr>
<tr id="S4.T2.2.2.14.12" class="ltx_tr">
<th id="S4.T2.2.2.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedVPTÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</th>
<td id="S4.T2.2.2.14.12.2" class="ltx_td ltx_align_center">89.39</td>
<td id="S4.T2.2.2.14.12.3" class="ltx_td ltx_align_center">85.11</td>
<td id="S4.T2.2.2.14.12.4" class="ltx_td ltx_align_center">55.49</td>
<td id="S4.T2.2.2.14.12.5" class="ltx_td ltx_align_center">45.26</td>
</tr>
<tr id="S4.T2.2.2.15.13" class="ltx_tr">
<th id="S4.T2.2.2.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedVPT-DÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</th>
<td id="S4.T2.2.2.15.13.2" class="ltx_td ltx_align_center">89.56</td>
<td id="S4.T2.2.2.15.13.3" class="ltx_td ltx_align_center">85.43</td>
<td id="S4.T2.2.2.15.13.4" class="ltx_td ltx_align_center">66.91</td>
<td id="S4.T2.2.2.15.13.5" class="ltx_td ltx_align_center">50.25</td>
</tr>
<tr id="S4.T2.2.2.16.14" class="ltx_tr">
<th id="S4.T2.2.2.16.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">pFedPG (Ours)</th>
<td id="S4.T2.2.2.16.14.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.2.2.16.14.2.1" class="ltx_text ltx_font_bold">90.08</span></td>
<td id="S4.T2.2.2.16.14.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.2.2.16.14.3.1" class="ltx_text ltx_font_bold">87.57</span></td>
<td id="S4.T2.2.2.16.14.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.2.2.16.14.4.1" class="ltx_text ltx_font_bold">70.96</span></td>
<td id="S4.T2.2.2.16.14.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.2.2.16.14.5.1" class="ltx_text ltx_font_bold">55.91</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Quantitative Evaluation</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We compare our proposed pFedPG with existing FL methods on benchmark datasets representing various types of data heterogeneity (<span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">i.e.,</span> domain discrepancy and imbalanced class distribution). In our experiments, <span id="S4.SS2.p1.1.2" class="ltx_text ltx_font_italic">SingleSet-Full</span> and FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> are viewed as baselines, where the former trains a model at each client without information sharing, while the latter aggregates client models to construct a shared global model. In addition, <span id="S4.SS2.p1.1.3" class="ltx_text ltx_font_italic">SingleSet-VPT</span> indicates each client independently applies visual prompt tuningÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> to learn prompts at the input embedding space.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">In TablesÂ <a href="#S3.T1" title="Table 1 â€£ Learning of personalized prompt generation â€£ 3.2.2 Personalized prompt generation at the server â€£ 3.2 Efficient Model Personalization in FL via Client-Specific Prompt Generation â€£ 3 Proposed Method â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-<a href="#S4.T3" title="Table 3 â€£ 4.2 Quantitative Evaluation â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we summarized the results compared with the state-of-the-art pFL works. To be more specific, Per-FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> applies meta-learningÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> to derive customized models for each client from a global initialization.
FedRepÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> aggregates feature extractors but keeps classifiers trained locally; FedBABUÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> only updates and shares feature extractors during FL training.
FedRoDÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> additionally learns a personalized classification head without model aggregation.
Instead of updating entire model parameters, two <span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_italic">efficient</span> FL baselines, <span id="S4.SS2.p2.1.2" class="ltx_text ltx_font_italic">FedVPT</span> and <span id="S4.SS2.p2.1.3" class="ltx_text ltx_font_italic">FedVPT-D</span>, are conducted, which keep the backbone frozen, and aggregate prompts globally. FollowingÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, FedVPT inserts prompts to the input, and FedVPT-D prepends prompts to the input and hidden layers.
Note that, we use ViT-B/16Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> as the backbone of the above methods for fair comparisons.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">In TableÂ <a href="#S3.T1" title="Table 1 â€£ Learning of personalized prompt generation â€£ 3.2.2 Personalized prompt generation at the server â€£ 3.2 Efficient Model Personalization in FL via Client-Specific Prompt Generation â€£ 3 Proposed Method â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we provide the quantitative comparisons on Office-Caltech10 and DomainNet datasets with the presence of <span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_bold">domain shifts</span> across clients. Our approach achieved the highest 96.81% and 71.64% average accuracies on Office-Caltech10 and DomainNet, respectively, as shown from TableÂ <a href="#S3.T1" title="Table 1 â€£ Learning of personalized prompt generation â€£ 3.2.2 Personalized prompt generation at the server â€£ 3.2 Efficient Model Personalization in FL via Client-Specific Prompt Generation â€£ 3 Proposed Method â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Furthermore, our method demonstrated the best communication efficiency, using only approximately 0.01% of parameters in comparison to other existing pFL methods. Note that the costs of FedRepÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> and FedBABUÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> are the numbers of model parameters of the ViT backbone (<span id="S4.SS2.p3.1.2" class="ltx_text ltx_font_italic">i.e.,</span> 85.8M), while the communication costs ofÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> can be approximated to 85.8M, as they transmit the ViT backbone along with a single-layer classifier, which adds relatively few parameters.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">In addition to domain discrepancy, we conducted comparisons on the <span id="S4.SS2.p4.1.1" class="ltx_text ltx_font_bold">imbalanced class distribution</span> scenario using CIFAR-10 and CIFAR-100 datasets, as shown in TableÂ <a href="#S4.T2" title="Table 2 â€£ 4.1.3 Implementation details â€£ 4.1 Datasets and Experimental Setup â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
As mentioned in Sec.Â <a href="#S4.SS1.SSS2" title="4.1.2 Experimental settings â€£ 4.1 Datasets and Experimental Setup â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1.2</span></a>, two types of imbalanced data are simulated, including disjoint label space and imbalanced label distribution drawn from <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="Dir(0.1)" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mrow id="S4.SS2.p4.1.m1.1.2" xref="S4.SS2.p4.1.m1.1.2.cmml"><mi id="S4.SS2.p4.1.m1.1.2.2" xref="S4.SS2.p4.1.m1.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.1.m1.1.2.1" xref="S4.SS2.p4.1.m1.1.2.1.cmml">â€‹</mo><mi id="S4.SS2.p4.1.m1.1.2.3" xref="S4.SS2.p4.1.m1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.1.m1.1.2.1a" xref="S4.SS2.p4.1.m1.1.2.1.cmml">â€‹</mo><mi id="S4.SS2.p4.1.m1.1.2.4" xref="S4.SS2.p4.1.m1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.1.m1.1.2.1b" xref="S4.SS2.p4.1.m1.1.2.1.cmml">â€‹</mo><mrow id="S4.SS2.p4.1.m1.1.2.5.2" xref="S4.SS2.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p4.1.m1.1.2.5.2.1" xref="S4.SS2.p4.1.m1.1.2.cmml">(</mo><mn id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">0.1</mn><mo stretchy="false" id="S4.SS2.p4.1.m1.1.2.5.2.2" xref="S4.SS2.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.2"><times id="S4.SS2.p4.1.m1.1.2.1.cmml" xref="S4.SS2.p4.1.m1.1.2.1"></times><ci id="S4.SS2.p4.1.m1.1.2.2.cmml" xref="S4.SS2.p4.1.m1.1.2.2">ğ·</ci><ci id="S4.SS2.p4.1.m1.1.2.3.cmml" xref="S4.SS2.p4.1.m1.1.2.3">ğ‘–</ci><ci id="S4.SS2.p4.1.m1.1.2.4.cmml" xref="S4.SS2.p4.1.m1.1.2.4">ğ‘Ÿ</ci><cn type="float" id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">Dir(0.1)</annotation></semantics></math>.
TableÂ <a href="#S4.T2" title="Table 2 â€£ 4.1.3 Implementation details â€£ 4.1 Datasets and Experimental Setup â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> demonstrates that our method performed favorably against existing FL works over the two datasets on both types of label imbalance.
To further exhibit the ability of our method to more practical scenarios, we compare with state-of-the-art works for the cross-site medical image diagnosis task using Dermoscopic-FL. As we can observe in TableÂ <a href="#S4.T3" title="Table 3 â€£ 4.2 Quantitative Evaluation â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, our pFedPG consistently performed superiorly against other FL methods on all hospital sites.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Quantitative comparisons on Dermoscopic-FL dataset using ViT-B/16. <span id="S4.T3.2.1" class="ltx_text ltx_font_bold">Bold</span> denotes the best result.</figcaption>
<div id="S4.T3.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:223.6pt;height:153.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-71.5pt,49.1pt) scale(0.60996328927558,0.60996328927558) ;">
<table id="S4.T3.3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.3.1.1.1" class="ltx_tr">
<th id="S4.T3.3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt">Method</th>
<td id="S4.T3.3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">A</td>
<td id="S4.T3.3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">B</td>
<td id="S4.T3.3.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">C</td>
<td id="S4.T3.3.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">D</td>
<td id="S4.T3.3.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">Avg.</td>
</tr>
<tr id="S4.T3.3.1.2.2" class="ltx_tr">
<th id="S4.T3.3.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="5"><span id="S4.T3.3.1.2.2.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Baselines</span></th>
<td id="S4.T3.3.1.2.2.2" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S4.T3.3.1.3.3" class="ltx_tr">
<th id="S4.T3.3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SingleSet-Full</th>
<td id="S4.T3.3.1.3.3.2" class="ltx_td ltx_align_center">76.09</td>
<td id="S4.T3.3.1.3.3.3" class="ltx_td ltx_align_center">97.29</td>
<td id="S4.T3.3.1.3.3.4" class="ltx_td ltx_align_center">71.65</td>
<td id="S4.T3.3.1.3.3.5" class="ltx_td ltx_align_center">73.57</td>
<td id="S4.T3.3.1.3.3.6" class="ltx_td ltx_align_center">79.65</td>
</tr>
<tr id="S4.T3.3.1.4.4" class="ltx_tr">
<th id="S4.T3.3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SingleSet-VPTÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</th>
<td id="S4.T3.3.1.4.4.2" class="ltx_td ltx_align_center">70.90</td>
<td id="S4.T3.3.1.4.4.3" class="ltx_td ltx_align_center">96.25</td>
<td id="S4.T3.3.1.4.4.4" class="ltx_td ltx_align_center">70.12</td>
<td id="S4.T3.3.1.4.4.5" class="ltx_td ltx_align_center">68.33</td>
<td id="S4.T3.3.1.4.4.6" class="ltx_td ltx_align_center">76.40</td>
</tr>
<tr id="S4.T3.3.1.5.5" class="ltx_tr">
<th id="S4.T3.3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>
</th>
<td id="S4.T3.3.1.5.5.2" class="ltx_td ltx_align_center">62.54</td>
<td id="S4.T3.3.1.5.5.3" class="ltx_td ltx_align_center">96.12</td>
<td id="S4.T3.3.1.5.5.4" class="ltx_td ltx_align_center">51.52</td>
<td id="S4.T3.3.1.5.5.5" class="ltx_td ltx_align_center">68.08</td>
<td id="S4.T3.3.1.5.5.6" class="ltx_td ltx_align_center">69.57</td>
</tr>
<tr id="S4.T3.3.1.6.6" class="ltx_tr">
<th id="S4.T3.3.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="5"><span id="S4.T3.3.1.6.6.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Personalized Federated Learning</span></th>
<td id="S4.T3.3.1.6.6.2" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S4.T3.3.1.7.7" class="ltx_tr">
<th id="S4.T3.3.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Per-FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</th>
<td id="S4.T3.3.1.7.7.2" class="ltx_td ltx_align_center">76.09</td>
<td id="S4.T3.3.1.7.7.3" class="ltx_td ltx_align_center">91.99</td>
<td id="S4.T3.3.1.7.7.4" class="ltx_td ltx_align_center">70.12</td>
<td id="S4.T3.3.1.7.7.5" class="ltx_td ltx_align_center">74.56</td>
<td id="S4.T3.3.1.7.7.6" class="ltx_td ltx_align_center">78.19</td>
</tr>
<tr id="S4.T3.3.1.8.8" class="ltx_tr">
<th id="S4.T3.3.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedRepÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</th>
<td id="S4.T3.3.1.8.8.2" class="ltx_td ltx_align_center">69.06</td>
<td id="S4.T3.3.1.8.8.3" class="ltx_td ltx_align_center">96.12</td>
<td id="S4.T3.3.1.8.8.4" class="ltx_td ltx_align_center">60.37</td>
<td id="S4.T3.3.1.8.8.5" class="ltx_td ltx_align_center">68.58</td>
<td id="S4.T3.3.1.8.8.6" class="ltx_td ltx_align_center">73.53</td>
</tr>
<tr id="S4.T3.3.1.9.9" class="ltx_tr">
<th id="S4.T3.3.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedRoDÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</th>
<td id="S4.T3.3.1.9.9.2" class="ltx_td ltx_align_center">63.55</td>
<td id="S4.T3.3.1.9.9.3" class="ltx_td ltx_align_center">96.67</td>
<td id="S4.T3.3.1.9.9.4" class="ltx_td ltx_align_center">58.84</td>
<td id="S4.T3.3.1.9.9.5" class="ltx_td ltx_align_center">69.33</td>
<td id="S4.T3.3.1.9.9.6" class="ltx_td ltx_align_center">72.10</td>
</tr>
<tr id="S4.T3.3.1.10.10" class="ltx_tr">
<th id="S4.T3.3.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedBABUÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</th>
<td id="S4.T3.3.1.10.10.2" class="ltx_td ltx_align_center">58.19</td>
<td id="S4.T3.3.1.10.10.3" class="ltx_td ltx_align_center">97.16</td>
<td id="S4.T3.3.1.10.10.4" class="ltx_td ltx_align_center">49.09</td>
<td id="S4.T3.3.1.10.10.5" class="ltx_td ltx_align_center">68.58</td>
<td id="S4.T3.3.1.10.10.6" class="ltx_td ltx_align_center">68.26</td>
</tr>
<tr id="S4.T3.3.1.11.11" class="ltx_tr">
<th id="S4.T3.3.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="5"><span id="S4.T3.3.1.11.11.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Efficient Federated Learning</span></th>
<td id="S4.T3.3.1.11.11.2" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S4.T3.3.1.12.12" class="ltx_tr">
<th id="S4.T3.3.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedVPTÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</th>
<td id="S4.T3.3.1.12.12.2" class="ltx_td ltx_align_center">74.92</td>
<td id="S4.T3.3.1.12.12.3" class="ltx_td ltx_align_center">96.77</td>
<td id="S4.T3.3.1.12.12.4" class="ltx_td ltx_align_center">67.07</td>
<td id="S4.T3.3.1.12.12.5" class="ltx_td ltx_align_center">75.06</td>
<td id="S4.T3.3.1.12.12.6" class="ltx_td ltx_align_center">78.46</td>
</tr>
<tr id="S4.T3.3.1.13.13" class="ltx_tr">
<th id="S4.T3.3.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedVPT-DÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</th>
<td id="S4.T3.3.1.13.13.2" class="ltx_td ltx_align_center">73.91</td>
<td id="S4.T3.3.1.13.13.3" class="ltx_td ltx_align_center">96.12</td>
<td id="S4.T3.3.1.13.13.4" class="ltx_td ltx_align_center">74.09</td>
<td id="S4.T3.3.1.13.13.5" class="ltx_td ltx_align_center">77.81</td>
<td id="S4.T3.3.1.13.13.6" class="ltx_td ltx_align_center">80.48</td>
</tr>
<tr id="S4.T3.3.1.14.14" class="ltx_tr">
<th id="S4.T3.3.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">pFedPG (Ours)</th>
<td id="S4.T3.3.1.14.14.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.3.1.14.14.2.1" class="ltx_text ltx_font_bold">79.26</span></td>
<td id="S4.T3.3.1.14.14.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.3.1.14.14.3.1" class="ltx_text ltx_font_bold">97.29</span></td>
<td id="S4.T3.3.1.14.14.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.3.1.14.14.4.1" class="ltx_text ltx_font_bold">76.22</span></td>
<td id="S4.T3.3.1.14.14.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.3.1.14.14.5.1" class="ltx_text ltx_font_bold">78.80</span></td>
<td id="S4.T3.3.1.14.14.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.3.1.14.14.6.1" class="ltx_text ltx_font_bold">82.89</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Analysis of our personalized prompt generation and the architecture of prompt generator <math id="S4.T4.2.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.T4.2.m1.1b"><mi id="S4.T4.2.m1.1.1" xref="S4.T4.2.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.T4.2.m1.1c"><ci id="S4.T4.2.m1.1.1.cmml" xref="S4.T4.2.m1.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.m1.1d">G</annotation></semantics></math> on benchmark datasets.</figcaption>
<div id="S4.T4.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:357.7pt;height:73pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-88.2pt,17.8pt) scale(0.669678880222307,0.669678880222307) ;">
<table id="S4.T4.4.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.4.2.3.1" class="ltx_tr">
<th id="S4.T4.4.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt">Module</th>
<td id="S4.T4.4.2.3.1.2" class="ltx_td ltx_align_center ltx_border_tt">Method</td>
<td id="S4.T4.4.2.3.1.3" class="ltx_td ltx_align_center ltx_border_tt">Office-Caltech10</td>
<td id="S4.T4.4.2.3.1.4" class="ltx_td ltx_align_center ltx_border_tt">DomainNet</td>
<td id="S4.T4.4.2.3.1.5" class="ltx_td ltx_align_center ltx_border_tt">CIFAR-10</td>
<td id="S4.T4.4.2.3.1.6" class="ltx_td ltx_align_center ltx_border_tt">CIFAR-100</td>
</tr>
<tr id="S4.T4.4.2.4.2" class="ltx_tr">
<th id="S4.T4.4.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="S4.T4.4.2.4.2.1.1" class="ltx_text">Prompt generation</span></th>
<td id="S4.T4.4.2.4.2.2" class="ltx_td ltx_align_center ltx_border_t">FedVPT</td>
<td id="S4.T4.4.2.4.2.3" class="ltx_td ltx_align_center ltx_border_t">94.29</td>
<td id="S4.T4.4.2.4.2.4" class="ltx_td ltx_align_center ltx_border_t">64.16</td>
<td id="S4.T4.4.2.4.2.5" class="ltx_td ltx_align_center ltx_border_t">89.39</td>
<td id="S4.T4.4.2.4.2.6" class="ltx_td ltx_align_center ltx_border_t">55.49</td>
</tr>
<tr id="S4.T4.3.1.1" class="ltx_tr">
<td id="S4.T4.3.1.1.1" class="ltx_td ltx_align_center"><math id="S4.T4.3.1.1.1.m1.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S4.T4.3.1.1.1.m1.1a"><msub id="S4.T4.3.1.1.1.m1.1.1" xref="S4.T4.3.1.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T4.3.1.1.1.m1.1.1.2" xref="S4.T4.3.1.1.1.m1.1.1.2a.cmml">P</mtext><mrow id="S4.T4.3.1.1.1.m1.1.1.3" xref="S4.T4.3.1.1.1.m1.1.1.3.cmml"><mi id="S4.T4.3.1.1.1.m1.1.1.3.2" xref="S4.T4.3.1.1.1.m1.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.T4.3.1.1.1.m1.1.1.3.1" xref="S4.T4.3.1.1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S4.T4.3.1.1.1.m1.1.1.3.3" xref="S4.T4.3.1.1.1.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T4.3.1.1.1.m1.1.1.3.1a" xref="S4.T4.3.1.1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S4.T4.3.1.1.1.m1.1.1.3.4" xref="S4.T4.3.1.1.1.m1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.3.1.1.1.m1.1.1.3.1b" xref="S4.T4.3.1.1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S4.T4.3.1.1.1.m1.1.1.3.5" xref="S4.T4.3.1.1.1.m1.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T4.3.1.1.1.m1.1b"><apply id="S4.T4.3.1.1.1.m1.1.1.cmml" xref="S4.T4.3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.3.1.1.1.m1.1.1.1.cmml" xref="S4.T4.3.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T4.3.1.1.1.m1.1.1.2a.cmml" xref="S4.T4.3.1.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T4.3.1.1.1.m1.1.1.2.cmml" xref="S4.T4.3.1.1.1.m1.1.1.2">P</mtext></ci><apply id="S4.T4.3.1.1.1.m1.1.1.3.cmml" xref="S4.T4.3.1.1.1.m1.1.1.3"><times id="S4.T4.3.1.1.1.m1.1.1.3.1.cmml" xref="S4.T4.3.1.1.1.m1.1.1.3.1"></times><ci id="S4.T4.3.1.1.1.m1.1.1.3.2.cmml" xref="S4.T4.3.1.1.1.m1.1.1.3.2">ğ‘</ci><ci id="S4.T4.3.1.1.1.m1.1.1.3.3.cmml" xref="S4.T4.3.1.1.1.m1.1.1.3.3">ğ‘</ci><ci id="S4.T4.3.1.1.1.m1.1.1.3.4.cmml" xref="S4.T4.3.1.1.1.m1.1.1.3.4">ğ‘ </ci><ci id="S4.T4.3.1.1.1.m1.1.1.3.5.cmml" xref="S4.T4.3.1.1.1.m1.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.1.1.1.m1.1c">\textbf{P}_{base}</annotation></semantics></math></td>
<td id="S4.T4.3.1.1.2" class="ltx_td ltx_align_center">93.16</td>
<td id="S4.T4.3.1.1.3" class="ltx_td ltx_align_center">64.87</td>
<td id="S4.T4.3.1.1.4" class="ltx_td ltx_align_center">88.23</td>
<td id="S4.T4.3.1.1.5" class="ltx_td ltx_align_center">66.89</td>
</tr>
<tr id="S4.T4.4.2.2" class="ltx_tr">
<th id="S4.T4.4.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="S4.T4.4.2.2.1.1" class="ltx_text">Architecture of <math id="S4.T4.4.2.2.1.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.T4.4.2.2.1.1.m1.1a"><mi id="S4.T4.4.2.2.1.1.m1.1.1" xref="S4.T4.4.2.2.1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.T4.4.2.2.1.1.m1.1b"><ci id="S4.T4.4.2.2.1.1.m1.1.1.cmml" xref="S4.T4.4.2.2.1.1.m1.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.2.2.1.1.m1.1c">G</annotation></semantics></math></span></th>
<td id="S4.T4.4.2.2.2" class="ltx_td ltx_align_center ltx_border_t">MLPÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>
</td>
<td id="S4.T4.4.2.2.3" class="ltx_td ltx_align_center ltx_border_t">94.96</td>
<td id="S4.T4.4.2.2.4" class="ltx_td ltx_align_center ltx_border_t">63.33</td>
<td id="S4.T4.4.2.2.5" class="ltx_td ltx_align_center ltx_border_t">87.47</td>
<td id="S4.T4.4.2.2.6" class="ltx_td ltx_align_center ltx_border_t">66.73</td>
</tr>
<tr id="S4.T4.4.2.5.3" class="ltx_tr">
<td id="S4.T4.4.2.5.3.1" class="ltx_td ltx_align_center">AdaINÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>
</td>
<td id="S4.T4.4.2.5.3.2" class="ltx_td ltx_align_center">95.72</td>
<td id="S4.T4.4.2.5.3.3" class="ltx_td ltx_align_center">70.08</td>
<td id="S4.T4.4.2.5.3.4" class="ltx_td ltx_align_center">89.77</td>
<td id="S4.T4.4.2.5.3.5" class="ltx_td ltx_align_center">69.44</td>
</tr>
<tr id="S4.T4.4.2.6.4" class="ltx_tr">
<th id="S4.T4.4.2.6.4.1" class="ltx_td ltx_th ltx_th_row ltx_border_bb ltx_border_t"></th>
<td id="S4.T4.4.2.6.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T4.4.2.6.4.2.1" class="ltx_text ltx_font_bold">pFedPG</span></td>
<td id="S4.T4.4.2.6.4.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T4.4.2.6.4.3.1" class="ltx_text ltx_font_bold">96.81</span></td>
<td id="S4.T4.4.2.6.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T4.4.2.6.4.4.1" class="ltx_text ltx_font_bold">71.64</span></td>
<td id="S4.T4.4.2.6.4.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T4.4.2.6.4.5.1" class="ltx_text ltx_font_bold">90.08</span></td>
<td id="S4.T4.4.2.6.4.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T4.4.2.6.4.6.1" class="ltx_text ltx_font_bold">70.96</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.1" class="ltx_p">We observed that, with the presence of significant data heterogeneity (<span id="S4.SS2.p5.1.1" class="ltx_text ltx_font_italic">e.g.,</span> large style difference in DomainNet) across clients, existing FL works which obtain a shared feature encoderÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> by aggregation might still deviate from local data domains, while Per-FedAvgÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> focuses on deriving a global initialization would not be preferable under severe discrepancy across clients. As shown in TablesÂ <a href="#S3.T1" title="Table 1 â€£ Learning of personalized prompt generation â€£ 3.2.2 Personalized prompt generation at the server â€£ 3.2 Efficient Model Personalization in FL via Client-Specific Prompt Generation â€£ 3 Proposed Method â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-Â <a href="#S4.T3" title="Table 3 â€£ 4.2 Quantitative Evaluation â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, FedVPT and FedVPT-D achieve comparable or even superior performance over existing FL works, exhibiting the ability of efficient FL methods to mitigate possible overfitting issues. However, sharing a set of global prompts is still not desirable for heterogeneous clients.
To explicitly enable efficient model personalization to tackle heterogeneous data, our approach learns to generate personalized prompts to facilitate local adaptation for each client. With the above results, we successfully confirm the effectiveness and robustness of our proposed pFedPG to address data heterogeneity with training efficiency.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Analysis of Our pFedPG</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">In this section, we first conduct experiments to confirm the effectiveness of our designed personalized prompt generation. Then, we provide a detailed analysis of the impact of different number prompts.
Due to the page limitations, we provide the analysis of model backbones and the size of client data in the supplementary material.</p>
</div>
<section id="S4.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Effectiveness of personalized prompt generation</h5>

<div id="S4.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px1.p1.5" class="ltx_p">In the upper part of TableÂ <a href="#S4.T4" title="Table 4 â€£ 4.2 Quantitative Evaluation â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we intend to verify the effectiveness of our personalized prompt generation for facilitating adaptation at each client on benchmark datasets, where CIFAR-10/100 are under the setting of disjoint label space. In TableÂ <a href="#S4.T4" title="Table 4 â€£ 4.2 Quantitative Evaluation â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we first ablate <math id="S4.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\textbf{P}_{n}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.1.m1.1a"><msub id="S4.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2a.cmml">P</mtext><mi id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2a.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2">P</mtext></ci><ci id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.1.m1.1c">\textbf{P}_{n}</annotation></semantics></math> with the global prompts obtained by global averaging (as in <span id="S4.SS3.SSS0.Px1.p1.5.1" class="ltx_text ltx_font_italic">FedVPT</span>).
As reported in TableÂ <a href="#S4.T4" title="Table 4 â€£ 4.2 Quantitative Evaluation â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the globally averaged prompts cannot achieve satisfactory performance since sharing a single set of prompts would not be favorable to heterogeneous clients.
In addition, we examine the performance of applying the trained <span id="S4.SS3.SSS0.Px1.p1.5.2" class="ltx_text ltx_font_italic">client-agnostic prompt basis</span> <math id="S4.SS3.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.2.m2.1a"><msub id="S4.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2a.cmml">P</mtext><mrow id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.1" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.1a" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.4" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.1b" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.5" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2a.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2">P</mtext></ci><apply id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3"><times id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.1"></times><ci id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.2">ğ‘</ci><ci id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.3">ğ‘</ci><ci id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.4.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.4">ğ‘ </ci><ci id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.5.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.2.m2.1c">\textbf{P}_{base}</annotation></semantics></math> to clients instead of applying personalized prompts <math id="S4.SS3.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\textbf{P}_{n}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.3.m3.1a"><msub id="S4.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2a.cmml">P</mtext><mi id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2a.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2">P</mtext></ci><ci id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.3.m3.1c">\textbf{P}_{n}</annotation></semantics></math>.
We observed that the performance of <math id="S4.SS3.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.4.m4.1a"><msub id="S4.SS3.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.2a.cmml">P</mtext><mrow id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.2" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.1" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.3" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.1a" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.4" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.1b" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.5" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.2a.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.2">P</mtext></ci><apply id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3"><times id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.1"></times><ci id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.2">ğ‘</ci><ci id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.3">ğ‘</ci><ci id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.4.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.4">ğ‘ </ci><ci id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.5.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.4.m4.1c">\textbf{P}_{base}</annotation></semantics></math> is still inferior to ours (which applies <math id="S4.SS3.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="\textbf{P}_{n}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.5.m5.1a"><msub id="S4.SS3.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2a.cmml">P</mtext><mi id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.3" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.5.m5.1b"><apply id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2a.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2">P</mtext></ci><ci id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.5.m5.1c">\textbf{P}_{n}</annotation></semantics></math>).
As evident from the above experiments, the effectiveness of our proposed personalized prompt generation for allowing personalized FL under various types of data heterogeneity would be successfully verified.
</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Effectiveness of our designed prompt generator <math id="S4.SS3.SSS0.Px2.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS3.SSS0.Px2.1.m1.1b"><mi id="S4.SS3.SSS0.Px2.1.m1.1.1" xref="S4.SS3.SSS0.Px2.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.1.m1.1c"><ci id="S4.SS3.SSS0.Px2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.1.m1.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.1.m1.1d">G</annotation></semantics></math>
</h5>

<div id="S4.SS3.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px2.p1.8" class="ltx_p">From the results shown in the lower half of TableÂ <a href="#S4.T4" title="Table 4 â€£ 4.2 Quantitative Evaluation â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we see that the performance dropped when we replaced our cross-attention-based prompt generator <math id="S4.SS3.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.1.m1.1a"><mi id="S4.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.m1.1b"><ci id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.m1.1c">G</annotation></semantics></math> and <math id="S4.SS3.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.2.m2.1a"><msub id="S4.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2a.cmml">P</mtext><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.1a" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.4" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.1b" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.5" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2a.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2">P</mtext></ci><apply id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3"><times id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.1"></times><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.2">ğ‘</ci><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.3">ğ‘</ci><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.4.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.4">ğ‘ </ci><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.5.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.2.m2.1c">\textbf{P}_{base}</annotation></semantics></math> with an MLP-based network asÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>, which acts on client descriptors and then output prompts for each client.
The inferior performance of the MLP-based prompt generator is due to its high training complexity and instability, resulting from the requirement of deploying a fully-connected layer for each prompt embedding. Another alternative prompt generator is to compute adaptive instance normalization (AdaIN)Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> for <math id="S4.SS3.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.3.m3.1a"><msub id="S4.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.2" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.2a.cmml">P</mtext><mrow id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.2" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.1" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.3" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.1a" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.4" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.1b" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.5" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.3.m3.1b"><apply id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.2a.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.2">P</mtext></ci><apply id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3"><times id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.1"></times><ci id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.2">ğ‘</ci><ci id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.3">ğ‘</ci><ci id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.4.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.4">ğ‘ </ci><ci id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.5.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.3.m3.1c">\textbf{P}_{base}</annotation></semantics></math> and the client descriptor <math id="S4.SS3.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="d_{n}" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.4.m4.1a"><msub id="S4.SS3.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.4.m4.1.1.2" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1.2.cmml">d</mi><mi id="S4.SS3.SSS0.Px2.p1.4.m4.1.1.3" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.4.m4.1b"><apply id="S4.SS3.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1.2">ğ‘‘</ci><ci id="S4.SS3.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.4.m4.1c">d_{n}</annotation></semantics></math>. This method allows for the transfer of client-agnostic prompts <math id="S4.SS3.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="\textbf{P}_{base}" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.5.m5.1a"><msub id="S4.SS3.SSS0.Px2.p1.5.m5.1.1" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.2" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.2a.cmml">P</mtext><mrow id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.2" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.1" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.3" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.1a" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.4" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.1b" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.1.cmml">â€‹</mo><mi id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.5" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.5.m5.1b"><apply id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.2a.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.2">P</mtext></ci><apply id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3"><times id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.1"></times><ci id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.2">ğ‘</ci><ci id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.3">ğ‘</ci><ci id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.4.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.4">ğ‘ </ci><ci id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.5.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.5">ğ‘’</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.5.m5.1c">\textbf{P}_{base}</annotation></semantics></math> to personalized prompts <math id="S4.SS3.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="\textbf{P}_{n}" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.6.m6.1a"><msub id="S4.SS3.SSS0.Px2.p1.6.m6.1.1" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px2.p1.6.m6.1.1.2" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1.2a.cmml">P</mtext><mi id="S4.SS3.SSS0.Px2.p1.6.m6.1.1.3" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.6.m6.1b"><apply id="S4.SS3.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.6.m6.1.1.2a.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1.2">P</mtext></ci><ci id="S4.SS3.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.6.m6.1c">\textbf{P}_{n}</annotation></semantics></math> by replacing the mean and variance calculated from the client descriptor <math id="S4.SS3.SSS0.Px2.p1.7.m7.1" class="ltx_Math" alttext="d_{n}" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.7.m7.1a"><msub id="S4.SS3.SSS0.Px2.p1.7.m7.1.1" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.7.m7.1.1.2" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1.2.cmml">d</mi><mi id="S4.SS3.SSS0.Px2.p1.7.m7.1.1.3" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.7.m7.1b"><apply id="S4.SS3.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.7.m7.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1.2">ğ‘‘</ci><ci id="S4.SS3.SSS0.Px2.p1.7.m7.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.7.m7.1c">d_{n}</annotation></semantics></math>, similar to the style transfer approachÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. However, as seen in TableÂ <a href="#S4.T4" title="Table 4 â€£ 4.2 Quantitative Evaluation â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, directly computing AdaIN did not explicitly model the prompt generation process, resulting in inferior performance compared to ours.
The results summarized in TableÂ <a href="#S4.T4" title="Table 4 â€£ 4.2 Quantitative Evaluation â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> confirm the effectiveness of our designed architecture of prompt generator <math id="S4.SS3.SSS0.Px2.p1.8.m8.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.8.m8.1a"><mi id="S4.SS3.SSS0.Px2.p1.8.m8.1.1" xref="S4.SS3.SSS0.Px2.p1.8.m8.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.8.m8.1b"><ci id="S4.SS3.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m8.1.1">ğº</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.8.m8.1c">G</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Impact of the number of prompts <math id="S4.SS3.SSS0.Px3.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.SSS0.Px3.1.m1.1b"><mi id="S4.SS3.SSS0.Px3.1.m1.1.1" xref="S4.SS3.SSS0.Px3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.1.m1.1c"><ci id="S4.SS3.SSS0.Px3.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.1.m1.1d">K</annotation></semantics></math>
</h5>

<div id="S4.SS3.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px3.p1.3" class="ltx_p">We also analyze the impact of the number of prompts <math id="S4.SS3.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.1.m1.1a"><mi id="S4.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.1.m1.1b"><ci id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.1.m1.1c">K</annotation></semantics></math> on benchmark datasets, and show the results in TableÂ <a href="#S4.T5" title="Table 5 â€£ Impact of the number of prompts ğ¾ â€£ 4.3 Analysis of Our pFedPG â€£ 4 Experiments â€£ Efficient Model Personalization in Federated Learning via Client-Specific Prompt Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
We found that when the number of prompts is set too low (<span id="S4.SS3.SSS0.Px3.p1.3.1" class="ltx_text ltx_font_italic">e.g.,</span> <math id="S4.SS3.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="K=1" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.2.m2.1a"><mrow id="S4.SS3.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml">K</mi><mo id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.1" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1"><eq id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.1"></eq><ci id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2">ğ¾</ci><cn type="integer" id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.2.m2.1c">K=1</annotation></semantics></math>), the modelâ€™s accuracy drops slightly due to insufficient capacity. In contrast, if the number of prompts is set too high, such as 100 or 200, the modelâ€™s performance significantly degrades. This is because a large number of prompts may encode noisy and task-irrelevant information, which can adversely affect the quality of the features derived from foundation models.
With the above observation, we thus set <math id="S4.SS3.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.3.m3.1a"><mi id="S4.SS3.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.3.m3.1b"><ci id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.3.m3.1c">K</annotation></semantics></math> as 10 for these datasets which achieves the best trade-off between communication cost and performance.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Impact of the number of prompts <math id="S4.T5.3.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T5.3.m1.1b"><mi id="S4.T5.3.m1.1.1" xref="S4.T5.3.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T5.3.m1.1c"><ci id="S4.T5.3.m1.1.1.cmml" xref="S4.T5.3.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.m1.1d">K</annotation></semantics></math> on benchmark datasets, where CIFAR-10/100 are drawn from <math id="S4.T5.4.m2.1" class="ltx_Math" alttext="Dir(0.1)" display="inline"><semantics id="S4.T5.4.m2.1b"><mrow id="S4.T5.4.m2.1.2" xref="S4.T5.4.m2.1.2.cmml"><mi id="S4.T5.4.m2.1.2.2" xref="S4.T5.4.m2.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.T5.4.m2.1.2.1" xref="S4.T5.4.m2.1.2.1.cmml">â€‹</mo><mi id="S4.T5.4.m2.1.2.3" xref="S4.T5.4.m2.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T5.4.m2.1.2.1b" xref="S4.T5.4.m2.1.2.1.cmml">â€‹</mo><mi id="S4.T5.4.m2.1.2.4" xref="S4.T5.4.m2.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T5.4.m2.1.2.1c" xref="S4.T5.4.m2.1.2.1.cmml">â€‹</mo><mrow id="S4.T5.4.m2.1.2.5.2" xref="S4.T5.4.m2.1.2.cmml"><mo stretchy="false" id="S4.T5.4.m2.1.2.5.2.1" xref="S4.T5.4.m2.1.2.cmml">(</mo><mn id="S4.T5.4.m2.1.1" xref="S4.T5.4.m2.1.1.cmml">0.1</mn><mo stretchy="false" id="S4.T5.4.m2.1.2.5.2.2" xref="S4.T5.4.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T5.4.m2.1c"><apply id="S4.T5.4.m2.1.2.cmml" xref="S4.T5.4.m2.1.2"><times id="S4.T5.4.m2.1.2.1.cmml" xref="S4.T5.4.m2.1.2.1"></times><ci id="S4.T5.4.m2.1.2.2.cmml" xref="S4.T5.4.m2.1.2.2">ğ·</ci><ci id="S4.T5.4.m2.1.2.3.cmml" xref="S4.T5.4.m2.1.2.3">ğ‘–</ci><ci id="S4.T5.4.m2.1.2.4.cmml" xref="S4.T5.4.m2.1.2.4">ğ‘Ÿ</ci><cn type="float" id="S4.T5.4.m2.1.1.cmml" xref="S4.T5.4.m2.1.1">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.m2.1d">Dir(0.1)</annotation></semantics></math>.</figcaption>
<div id="S4.T5.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:228.6pt;height:96.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-34.5pt,14.6pt) scale(0.767899843802644,0.767899843802644) ;">
<table id="S4.T5.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.5.1.1" class="ltx_tr">
<th id="S4.T5.5.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><math id="S4.T5.5.1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T5.5.1.1.1.m1.1a"><mi id="S4.T5.5.1.1.1.m1.1.1" xref="S4.T5.5.1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T5.5.1.1.1.m1.1b"><ci id="S4.T5.5.1.1.1.m1.1.1.cmml" xref="S4.T5.5.1.1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.1.1.1.m1.1c">K</annotation></semantics></math></th>
<th id="S4.T5.5.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Office-Caltech10</th>
<th id="S4.T5.5.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">DomainNet</th>
<th id="S4.T5.5.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">CIFAR-10</th>
<th id="S4.T5.5.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">CIFAR-100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.5.1.2.1" class="ltx_tr">
<th id="S4.T5.5.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S4.T5.5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">96.09</td>
<td id="S4.T5.5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">70.27</td>
<td id="S4.T5.5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">86.14</td>
<td id="S4.T5.5.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">55.77</td>
</tr>
<tr id="S4.T5.5.1.3.2" class="ltx_tr">
<th id="S4.T5.5.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">5</th>
<td id="S4.T5.5.1.3.2.2" class="ltx_td ltx_align_center">96.77</td>
<td id="S4.T5.5.1.3.2.3" class="ltx_td ltx_align_center">70.53</td>
<td id="S4.T5.5.1.3.2.4" class="ltx_td ltx_align_center">87.41</td>
<td id="S4.T5.5.1.3.2.5" class="ltx_td ltx_align_center">55.79</td>
</tr>
<tr id="S4.T5.5.1.4.3" class="ltx_tr">
<th id="S4.T5.5.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">10</th>
<td id="S4.T5.5.1.4.3.2" class="ltx_td ltx_align_center"><span id="S4.T5.5.1.4.3.2.1" class="ltx_text ltx_font_bold">96.81</span></td>
<td id="S4.T5.5.1.4.3.3" class="ltx_td ltx_align_center"><span id="S4.T5.5.1.4.3.3.1" class="ltx_text ltx_font_bold">71.64</span></td>
<td id="S4.T5.5.1.4.3.4" class="ltx_td ltx_align_center"><span id="S4.T5.5.1.4.3.4.1" class="ltx_text ltx_font_bold">87.57</span></td>
<td id="S4.T5.5.1.4.3.5" class="ltx_td ltx_align_center"><span id="S4.T5.5.1.4.3.5.1" class="ltx_text ltx_font_bold">55.91</span></td>
</tr>
<tr id="S4.T5.5.1.5.4" class="ltx_tr">
<th id="S4.T5.5.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">50</th>
<td id="S4.T5.5.1.5.4.2" class="ltx_td ltx_align_center">95.10</td>
<td id="S4.T5.5.1.5.4.3" class="ltx_td ltx_align_center">69.55</td>
<td id="S4.T5.5.1.5.4.4" class="ltx_td ltx_align_center">85.63</td>
<td id="S4.T5.5.1.5.4.5" class="ltx_td ltx_align_center">54.52</td>
</tr>
<tr id="S4.T5.5.1.6.5" class="ltx_tr">
<th id="S4.T5.5.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">100</th>
<td id="S4.T5.5.1.6.5.2" class="ltx_td ltx_align_center">94.53</td>
<td id="S4.T5.5.1.6.5.3" class="ltx_td ltx_align_center">68.79</td>
<td id="S4.T5.5.1.6.5.4" class="ltx_td ltx_align_center">85.02</td>
<td id="S4.T5.5.1.6.5.5" class="ltx_td ltx_align_center">53.61</td>
</tr>
<tr id="S4.T5.5.1.7.6" class="ltx_tr">
<th id="S4.T5.5.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">200</th>
<td id="S4.T5.5.1.7.6.2" class="ltx_td ltx_align_center ltx_border_bb">94.46</td>
<td id="S4.T5.5.1.7.6.3" class="ltx_td ltx_align_center ltx_border_bb">66.83</td>
<td id="S4.T5.5.1.7.6.4" class="ltx_td ltx_align_center ltx_border_bb">83.53</td>
<td id="S4.T5.5.1.7.6.5" class="ltx_td ltx_align_center ltx_border_bb">52.34</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we proposed a novel client-specific Prompt Generation framework (pFedPG) for enabling efficient model personalization among heterogeneous clients.
By alternative optimization of the proposed personalized prompt generation and client-specific prompt adaptation, our pFedPG is capable of producing personalized prompts for each client by observing underlying directions of local training among clients, while clients optimize such client-specific prompts to adapt a pre-trained model to local data distribution.
We conducted extensive quantitative experiments, verifying that our framework performed favorably against SOTA pFL approaches at heterogeneous data clients while achieving training and communication efficiency.</p>
</div>
<section id="S5.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Acknowledgment</h5>

<div id="S5.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p1.1" class="ltx_p">This work is supported in part by the National Science and Technology Council under grant NSTC111-2634-F-002-020 and National Taiwan University under grant NTU-112L900901. We also thank to National Center for High-performance Computing (NCHC) for providing computational and storage resources.</p>
</div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Rishi Bommasani, DrewÂ A Hudson, Ehsan Adeli, Russ Altman, Simran Arora, Sydney
von Arx, MichaelÂ S Bernstein, Jeannette Bohg, Antoine Bosselut, Emma
Brunskill, etÂ al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">On the opportunities and risks of foundation models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2108.07258</span><span id="bib.bib1.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, JaredÂ D Kaplan, Prafulla
Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
etÂ al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Language models are few-shot learners.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Daoyuan Chen, Liuyi Yao, Dawei Gao, Bolin Ding, and Yaliang Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Efficient personalized federated learning via sparse
model-adaptation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Hong-You Chen and Wei-Lun Chao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">On bridging generic and personalized federated learning for image
classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Hong-You Chen, Cheng-Hao Tu, Ziwei Li, Han-Wei Shen, and Wei-Lun Chao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">On the importance and applicability of pre-training for federated
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Zhen Chen, Meilu Zhu, Chen Yang, and Yixuan Yuan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Personalized retrogress-resilient framework for real-world medical
federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">MICCAI</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
NoelÂ CF Codella, David Gutman, MÂ Emre Celebi, Brian Helba, MichaelÂ A Marchetti,
StephenÂ W Dusza, Aadi Kalloo, Konstantinos Liopyris, Nabin Mishra, Harald
Kittler, etÂ al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Skin lesion analysis toward melanoma detection: A challenge at the
2017 international symposium on biomedical imaging (isbi), hosted by the
international skin imaging collaboration (isic).
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ISBI</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Liam Collins, Hamed Hassani, Aryan Mokhtari, and Sanjay Shakkottai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Exploiting shared representations for personalized federated
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Bart Custers, AlanÂ M Sears, Francien Dechesne, Ilina Georgieva, Tommaso Tani,
and Simone VanÂ der Hof.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">EU personal data protection in policy and practice</span><span id="bib.bib9.3.2" class="ltx_text" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.4.1" class="ltx_text" style="font-size:90%;">Springer, 2019.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Rong Dai, Li Shen, Fengxiang He, Xinmei Tian, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Dispfl: Towards communication-efficient personalized federated
learning via decentralized sparse training.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Imagenet: A large-scale hierarchical image database.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, 2009.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Bert: Pre-training of deep bidirectional transformers for language
understanding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1810.04805</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, Jakob Uszkoreit, and Neil Houlsby.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">An image is worth 16x16 words: Transformers for image recognition at
scale.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Personalized federated learning with theoretical guarantees: A
model-agnostic meta-learning approach.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Chelsea Finn, Pieter Abbeel, and Sergey Levine.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Model-agnostic meta-learning for fast adaptation of deep networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Gregory Griffin, Alex Holub, and Pietro Perona.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Caltech-256 object category dataset.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">Technical report, 2007.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Tao Guo, Song Guo, Junxiao Wang, and Wenchao Xu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Promptfl: Let federated participants cooperatively learn prompts
instead of modelsâ€“federated learning in age of foundation model.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2208.11625</span><span id="bib.bib17.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xinlei Chen, Saining Xie, Yanghao Li, Piotr DollÃ¡r, and Ross
Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Masked autoencoders are scalable vision learners.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Haoqi Fan, Yuxin Wu, Saining Xie, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Momentum contrast for unsupervised visual representation learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Xun Huang and Serge Belongie.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Arbitrary style transfer in real-time with adaptive instance
normalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Menglin Jia, Luming Tang, Bor-Chun Chen, Claire Cardie, Serge Belongie, Bharath
Hariharan, and Ser-Nam Lim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Visual prompt tuning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
SaiÂ Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian
Stich, and AnandaÂ Theertha Suresh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Scaffold: Stochastic controlled averaging for federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Alex Krizhevsky, Geoffrey Hinton, etÂ al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Learning multiple layers of features from tiny images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">2009.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Yann LeCun, LÃ©on Bottou, Yoshua Bengio, and Patrick Haffner.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Gradient-based learning applied to document recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE</span><span id="bib.bib24.4.2" class="ltx_text" style="font-size:90%;">, 1998.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Brian Lester, Rami Al-Rfou, and Noah Constant.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">The power of scale for parameter-efficient prompt tuning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2104.08691</span><span id="bib.bib25.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Qinbin Li, Bingsheng He, and Dawn Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Model-contrastive federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Tian Li, Shengyuan Hu, Ahmad Beirami, and Virginia Smith.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Ditto: Fair and robust federated learning through personalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Tian Li, AnitÂ Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Federated optimization in heterogeneous networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">MLSys</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Xiaoxiao Li, Meirui Jiang, Xiaofei Zhang, Michael Kamp, and Qi Dou.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Fed{bn}: Federated learning on non-{iid} features via
local batch normalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
XiangÂ Lisa Li and Percy Liang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Prefix-tuning: Optimizing continuous prompts for generation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2101.00190</span><span id="bib.bib30.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Chih-Ting Liu, Chien-Yi Wang, Shao-Yi Chien, and Shang-Hong Lai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Fedfr: Joint optimization federated framework for generic and
personalized face recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AAAI</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Xiao Liu, Kaixuan Ji, Yicheng Fu, Zhengxiao Du, Zhilin Yang, and Jie Tang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">P-tuning v2: Prompt tuning can be comparable to fine-tuning
universally across scales and tasks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2110.07602</span><span id="bib.bib32.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Xiaosong Ma, Jie Zhang, Song Guo, and Wenchao Xu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Layer-wised model aggregation for personalized federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib33.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib33.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and BlaiseÂ Aguera y
Arcas.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Communication-efficient learning of deep networks from decentralized
data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib34.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AISTATS</span><span id="bib.bib34.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Matias Mendieta, Taojiannan Yang, Pu Wang, Minwoo Lee, Zhengming Ding, and Chen
Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Local learning matters: Rethinking data heterogeneity in federated
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib35.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib35.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
John Nguyen, Jianyu Wang, Kshitiz Malik, Maziar Sanjabi, and Michael Rabbat.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Where to begin? on the impact of pre-training and initialization in
federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2210.08090</span><span id="bib.bib36.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Jaehoon Oh, SangMook Kim, and Se-Young Yun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Fedbabu: Toward enhanced representation for federated image
classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib37.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib37.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory
Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, etÂ al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Pytorch: An imperative style, high-performance deep learning library.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib38.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib38.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Xingchao Peng, Qinxun Bai, Xide Xia, Zijun Huang, Kate Saenko, and Bo Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Moment matching for multi-source domain adaptation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib39.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib39.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Liangqiong Qu, Yuyin Zhou, PaulÂ Pu Liang, Yingda Xia, Feifei Wang, Ehsan Adeli,
Li Fei-Fei, and Daniel Rubin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Rethinking architecture design for tackling data heterogeneity in
federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib40.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib40.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Alec Radford, JongÂ Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh,
Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark,
etÂ al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Learning transferable visual models from natural language
supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib41.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib41.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Kate Saenko, Brian Kulis, Mario Fritz, and Trevor Darrell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">Adapting visual category models to new domains.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib42.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib42.5.3" class="ltx_text" style="font-size:90%;">, 2010.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Christoph Schuhmann, Romain Beaumont, Richard Vencu, Cade Gordon, Ross
Wightman, Mehdi Cherti, Theo Coombes, Aarush Katta, Clayton Mullis, Mitchell
Wortsman, etÂ al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Laion-5b: An open large-scale dataset for training next generation
image-text models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2210.08402</span><span id="bib.bib43.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Aviv Shamsian, Aviv Navon, Ethan Fetaya, and Gal Chechik.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Personalized federated learning using hypernetworks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib44.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib44.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
Yiqing Shen, Yuyin Zhou, and Lequan Yu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Cd2-pfed: Cyclic distillation-guided channel decoupling for model
personalization in federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib45.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib45.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Aliaksandra Shysheya, John Bronskill, Massimiliano Patacchiola, Sebastian
Nowozin, and RichardÂ E Turner.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">Fit: Parameter efficient few-shot transfer learning for personalized
and federated image classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib46.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib46.5.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text" style="font-size:90%;">
Shangchao Su, Mingzhao Yang, Bin Li, and Xiangyang Xue.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.2.1" class="ltx_text" style="font-size:90%;">Cross-domain federated adaptive prompt tuning for clip.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2211.07864</span><span id="bib.bib47.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text" style="font-size:90%;">
Benyuan Sun, Hongxing Huo, Yi Yang, and Bo Bai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.2.1" class="ltx_text" style="font-size:90%;">Partialfed: Cross-domain personalized federated learning via partial
initialization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib48.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text" style="font-size:90%;">
Yue Tan, Guodong Long, Lu Liu, Tianyi Zhou, Qinghua Lu, Jing Jiang, and Chengqi
Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.2.1" class="ltx_text" style="font-size:90%;">Fedproto: Federated prototype learning across heterogeneous clients.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib49.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AAAI</span><span id="bib.bib49.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text" style="font-size:90%;">
Philipp Tschandl, Cliff Rosendahl, and Harald Kittler.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.2.1" class="ltx_text" style="font-size:90%;">The ham10000 dataset, a large collection of multi-source
dermatoscopic images of common pigmented skin lesions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Scientific data</span><span id="bib.bib50.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text" style="font-size:90%;">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
AidanÂ N Gomez, Åukasz Kaiser, and Illia Polosukhin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.2.1" class="ltx_text" style="font-size:90%;">Attention is all you need.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib51.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib51.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock"><span id="bib.bib52.1.1" class="ltx_text" style="font-size:90%;">
Jianqing Zhang, Yang Hua, Hao Wang, Tao Song, Zhengui Xue, Ruhui Ma, and
Haibing Guan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.2.1" class="ltx_text" style="font-size:90%;">Fedala: Adaptive local aggregation for personalized federated
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2212.01197</span><span id="bib.bib52.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock"><span id="bib.bib53.1.1" class="ltx_text" style="font-size:90%;">
Lin Zhang, Li Shen, Liang Ding, Dacheng Tao, and Ling-Yu Duan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.2.1" class="ltx_text" style="font-size:90%;">Fine-tuning global model via data-free knowledge distillation for
non-iid federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib53.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib53.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock"><span id="bib.bib54.1.1" class="ltx_text" style="font-size:90%;">
Susan Zhang, Stephen Roller, Naman Goyal, Mikel Artetxe, Moya Chen, Shuohui
Chen, Christopher Dewan, Mona Diab, Xian Li, XiÂ Victoria Lin, etÂ al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.2.1" class="ltx_text" style="font-size:90%;">Opt: Open pre-trained transformer language models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2205.01068</span><span id="bib.bib54.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock"><span id="bib.bib55.1.1" class="ltx_text" style="font-size:90%;">
Kaiyang Zhou, Jingkang Yang, ChenÂ Change Loy, and Ziwei Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.2.1" class="ltx_text" style="font-size:90%;">Conditional prompt learning for vision-language models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib55.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE/CVF Conference on Computer Vision and Pattern
Recognition (CVPR)</span><span id="bib.bib55.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock"><span id="bib.bib56.1.1" class="ltx_text" style="font-size:90%;">
Kaiyang Zhou, Jingkang Yang, ChenÂ Change Loy, and Ziwei Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.2.1" class="ltx_text" style="font-size:90%;">Learning to prompt for vision-language models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">International Journal of Computer Vision (IJCV)</span><span id="bib.bib56.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock"><span id="bib.bib57.1.1" class="ltx_text" style="font-size:90%;">
Weiming Zhuang, Yonggang Wen, Xuesen Zhang, Xin Gan, Daiying Yin, Dongzhan
Zhou, Shuai Zhang, and Shuai Yi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.2.1" class="ltx_text" style="font-size:90%;">Performance optimization of federated person re-identification via
benchmark analysis.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib57.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM MM</span><span id="bib.bib57.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2308.15366" class="ar5iv-nav-button ar5iv-nav-button-prev">â—„</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2308.15367" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2308.15367">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2308.15367" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2308.15368" class="ar5iv-nav-button ar5iv-nav-button-next">â–º</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 09:51:36 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "Ã—";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
