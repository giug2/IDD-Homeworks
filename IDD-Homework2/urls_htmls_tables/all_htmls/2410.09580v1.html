<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>\method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search</title>
<!--Generated on Sat Oct 12 16:19:25 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.09580v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S1" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S2" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S3" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Notations and Definitions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.SS1" title="In 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>MDP Formulation for MCR</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.SS2" title="In 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>S-agent</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.SS3" title="In 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>S-planner</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.SS4" title="In 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Guiding S-agent with S-planner</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S5" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experimental Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S6" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Experimental Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S6.SS1" title="In 6 Experimental Results ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Overall Performance Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S6.SS2" title="In 6 Experimental Results ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Efficiency Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S6.SS3" title="In 6 Experimental Results ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S6.SS4" title="In 6 Experimental Results ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Hyperparameter Sensitivity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S6.SS5" title="In 6 Experimental Results ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.5 </span>Case Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S7" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S8" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S9" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">9 </span>Ethics Statement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A1" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Table of Notations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A2" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Additional Related Works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A3" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Details of the State Encoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A4" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Transition Function</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A5" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Reward Function</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6" title="In \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Experimental Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS1" title="In Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.1 </span>Dataset Details and Statistics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS2" title="In Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.2 </span>Details of the User Simulator</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS3" title="In Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.3 </span>Details of hDCG Calculation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS4" title="In Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.4 </span>Details of Baseline Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS5" title="In Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.5 </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS6" title="In Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.6 </span>Hyper-parameter Sensitivity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS7" title="In Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.7 </span>Additional Analysis on Action Strategies</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS8" title="In Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.8 </span>Case Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS9" title="In Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.9 </span>Additional Analysis on Efficiency</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document" lang="en">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_ERROR undefined" id="id19.id1">\method</span>: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hanwen Du<sup class="ltx_sup" id="id1.1.1"><math alttext="\clubsuit" class="ltx_Math" display="inline" id="id1.1.1.m1.1"><semantics id="id1.1.1.m1.1a"><mi id="id1.1.1.m1.1.1" mathvariant="normal" xref="id1.1.1.m1.1.1.cmml">♣</mi><annotation-xml encoding="MathML-Content" id="id1.1.1.m1.1b"><ci id="id1.1.1.m1.1.1.cmml" xref="id1.1.1.m1.1.1">♣</ci></annotation-xml><annotation encoding="application/x-tex" id="id1.1.1.m1.1c">\clubsuit</annotation><annotation encoding="application/x-llamapun" id="id1.1.1.m1.1d">♣</annotation></semantics></math></sup>   Bo Peng<sup class="ltx_sup" id="id2.2.2"><math alttext="\clubsuit" class="ltx_Math" display="inline" id="id2.2.2.m1.1"><semantics id="id2.2.2.m1.1a"><mi id="id2.2.2.m1.1.1" mathvariant="normal" xref="id2.2.2.m1.1.1.cmml">♣</mi><annotation-xml encoding="MathML-Content" id="id2.2.2.m1.1b"><ci id="id2.2.2.m1.1.1.cmml" xref="id2.2.2.m1.1.1">♣</ci></annotation-xml><annotation encoding="application/x-tex" id="id2.2.2.m1.1c">\clubsuit</annotation><annotation encoding="application/x-llamapun" id="id2.2.2.m1.1d">♣</annotation></semantics></math></sup>   Xia Ning<sup class="ltx_sup" id="id3.3.3"><math alttext="\clubsuit" class="ltx_Math" display="inline" id="id3.3.3.m1.1"><semantics id="id3.3.3.m1.1a"><mi id="id3.3.3.m1.1.1" mathvariant="normal" xref="id3.3.3.m1.1.1.cmml">♣</mi><annotation-xml encoding="MathML-Content" id="id3.3.3.m1.1b"><ci id="id3.3.3.m1.1.1.cmml" xref="id3.3.3.m1.1.1">♣</ci></annotation-xml><annotation encoding="application/x-tex" id="id3.3.3.m1.1c">\clubsuit</annotation><annotation encoding="application/x-llamapun" id="id3.3.3.m1.1d">♣</annotation></semantics></math></sup><sup class="ltx_sup" id="id4.4.4"><math alttext="\spadesuit" class="ltx_Math" display="inline" id="id4.4.4.m1.1"><semantics id="id4.4.4.m1.1a"><mi id="id4.4.4.m1.1.1" mathvariant="normal" xref="id4.4.4.m1.1.1.cmml">♠</mi><annotation-xml encoding="MathML-Content" id="id4.4.4.m1.1b"><ci id="id4.4.4.m1.1.1.cmml" xref="id4.4.4.m1.1.1">♠</ci></annotation-xml><annotation encoding="application/x-tex" id="id4.4.4.m1.1c">\spadesuit</annotation><annotation encoding="application/x-llamapun" id="id4.4.4.m1.1d">♠</annotation></semantics></math></sup><sup class="ltx_sup" id="id5.5.5"><math alttext="\heartsuit" class="ltx_Math" display="inline" id="id5.5.5.m1.1"><semantics id="id5.5.5.m1.1a"><mi id="id5.5.5.m1.1.1" mathvariant="normal" xref="id5.5.5.m1.1.1.cmml">♡</mi><annotation-xml encoding="MathML-Content" id="id5.5.5.m1.1b"><ci id="id5.5.5.m1.1.1.cmml" xref="id5.5.5.m1.1.1">♡</ci></annotation-xml><annotation encoding="application/x-tex" id="id5.5.5.m1.1c">\heartsuit</annotation><annotation encoding="application/x-llamapun" id="id5.5.5.m1.1d">♡</annotation></semantics></math></sup><sup class="ltx_sup" id="id6.6.6"><math alttext="\diamondsuit" class="ltx_Math" display="inline" id="id6.6.6.m1.1"><semantics id="id6.6.6.m1.1a"><mi id="id6.6.6.m1.1.1" mathvariant="normal" xref="id6.6.6.m1.1.1.cmml">♢</mi><annotation-xml encoding="MathML-Content" id="id6.6.6.m1.1b"><ci id="id6.6.6.m1.1.1.cmml" xref="id6.6.6.m1.1.1">♢</ci></annotation-xml><annotation encoding="application/x-tex" id="id6.6.6.m1.1c">\diamondsuit</annotation><annotation encoding="application/x-llamapun" id="id6.6.6.m1.1d">♢</annotation></semantics></math></sup>✉
<br class="ltx_break"/><sup class="ltx_sup" id="id7.7.7"><math alttext="\clubsuit" class="ltx_Math" display="inline" id="id7.7.7.m1.1"><semantics id="id7.7.7.m1.1a"><mi id="id7.7.7.m1.1.1" mathvariant="normal" xref="id7.7.7.m1.1.1.cmml">♣</mi><annotation-xml encoding="MathML-Content" id="id7.7.7.m1.1b"><ci id="id7.7.7.m1.1.1.cmml" xref="id7.7.7.m1.1.1">♣</ci></annotation-xml><annotation encoding="application/x-tex" id="id7.7.7.m1.1c">\clubsuit</annotation><annotation encoding="application/x-llamapun" id="id7.7.7.m1.1d">♣</annotation></semantics></math></sup>Department of Computer Science
and Engineering, The Ohio State University, USA
<br class="ltx_break"/><sup class="ltx_sup" id="id8.8.8"><math alttext="\spadesuit" class="ltx_Math" display="inline" id="id8.8.8.m1.1"><semantics id="id8.8.8.m1.1a"><mi id="id8.8.8.m1.1.1" mathvariant="normal" xref="id8.8.8.m1.1.1.cmml">♠</mi><annotation-xml encoding="MathML-Content" id="id8.8.8.m1.1b"><ci id="id8.8.8.m1.1.1.cmml" xref="id8.8.8.m1.1.1">♠</ci></annotation-xml><annotation encoding="application/x-tex" id="id8.8.8.m1.1c">\spadesuit</annotation><annotation encoding="application/x-llamapun" id="id8.8.8.m1.1d">♠</annotation></semantics></math></sup>Division of Medicinal Chemistry and Pharmacognosy, College of Pharmacy, The Ohio State University, USA
<br class="ltx_break"/><sup class="ltx_sup" id="id9.9.9"><math alttext="\heartsuit" class="ltx_Math" display="inline" id="id9.9.9.m1.1"><semantics id="id9.9.9.m1.1a"><mi id="id9.9.9.m1.1.1" mathvariant="normal" xref="id9.9.9.m1.1.1.cmml">♡</mi><annotation-xml encoding="MathML-Content" id="id9.9.9.m1.1b"><ci id="id9.9.9.m1.1.1.cmml" xref="id9.9.9.m1.1.1">♡</ci></annotation-xml><annotation encoding="application/x-tex" id="id9.9.9.m1.1c">\heartsuit</annotation><annotation encoding="application/x-llamapun" id="id9.9.9.m1.1d">♡</annotation></semantics></math></sup>Department of Biomedical Informatics, The Ohio State University, USA
<br class="ltx_break"/><sup class="ltx_sup" id="id10.10.10"><math alttext="\diamondsuit" class="ltx_Math" display="inline" id="id10.10.10.m1.1"><semantics id="id10.10.10.m1.1a"><mi id="id10.10.10.m1.1.1" mathvariant="normal" xref="id10.10.10.m1.1.1.cmml">♢</mi><annotation-xml encoding="MathML-Content" id="id10.10.10.m1.1b"><ci id="id10.10.10.m1.1.1.cmml" xref="id10.10.10.m1.1.1">♢</ci></annotation-xml><annotation encoding="application/x-tex" id="id10.10.10.m1.1c">\diamondsuit</annotation><annotation encoding="application/x-llamapun" id="id10.10.10.m1.1d">♢</annotation></semantics></math></sup>Translational Data Analytics Institute, The Ohio State University, USA
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id20.11.id1">{du.1128,peng.707,ning.104}@osu.edu</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id18.8"><span class="ltx_text" id="id18.8.8">Conversational Recommender Systems (CRS) proactively engage users in interactive dialogues to elicit user preferences and provide personalized recommendations.
Existing methods train Reinforcement Learning (RL)-based agent with greedy action selection or sampling strategy, and may suffer from suboptimal conversational planning. To address this, we present a novel Monte Carlo Tree Search (MCTS)-based CRS framework <span class="ltx_ERROR undefined" id="id18.8.8.9">\method</span>.
<span class="ltx_ERROR undefined" id="id18.8.8.10">\method</span>consists of a conversational agent (<span class="ltx_text" id="id11.1.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="id11.1.1.1.m1.1"><semantics id="id11.1.1.1.m1.1a"><mrow id="id11.1.1.1.m1.1.1" xref="id11.1.1.1.m1.1.1.cmml"><mi id="id11.1.1.1.m1.1.1.2" xref="id11.1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="id11.1.1.1.m1.1.1.1" xref="id11.1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="id11.1.1.1.m1.1.1.3" xref="id11.1.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="id11.1.1.1.m1.1b"><apply id="id11.1.1.1.m1.1.1.cmml" xref="id11.1.1.1.m1.1.1"><times id="id11.1.1.1.m1.1.1.1.cmml" xref="id11.1.1.1.m1.1.1.1"></times><ci id="id11.1.1.1.m1.1.1.2.cmml" xref="id11.1.1.1.m1.1.1.2">𝚂</ci><ci id="id11.1.1.1.m1.1.1.3a.cmml" xref="id11.1.1.1.m1.1.1.3"><mtext id="id11.1.1.1.m1.1.1.3.cmml" xref="id11.1.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id11.1.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="id11.1.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span>) and a conversational planner (<span class="ltx_text" id="id12.2.2.2"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="id12.2.2.2.m1.1"><semantics id="id12.2.2.2.m1.1a"><mrow id="id12.2.2.2.m1.1.1" xref="id12.2.2.2.m1.1.1.cmml"><mi id="id12.2.2.2.m1.1.1.2" xref="id12.2.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="id12.2.2.2.m1.1.1.1" xref="id12.2.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="id12.2.2.2.m1.1.1.3" xref="id12.2.2.2.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="id12.2.2.2.m1.1b"><apply id="id12.2.2.2.m1.1.1.cmml" xref="id12.2.2.2.m1.1.1"><times id="id12.2.2.2.m1.1.1.1.cmml" xref="id12.2.2.2.m1.1.1.1"></times><ci id="id12.2.2.2.m1.1.1.2.cmml" xref="id12.2.2.2.m1.1.1.2">𝚂</ci><ci id="id12.2.2.2.m1.1.1.3a.cmml" xref="id12.2.2.2.m1.1.1.3"><mtext id="id12.2.2.2.m1.1.1.3.cmml" xref="id12.2.2.2.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id12.2.2.2.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="id12.2.2.2.m1.1d">typewriter_S -planner</annotation></semantics></math></span>).
<span class="ltx_text" id="id13.3.3.3"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="id13.3.3.3.m1.1"><semantics id="id13.3.3.3.m1.1a"><mrow id="id13.3.3.3.m1.1.1" xref="id13.3.3.3.m1.1.1.cmml"><mi id="id13.3.3.3.m1.1.1.2" xref="id13.3.3.3.m1.1.1.2.cmml">𝚂</mi><mo id="id13.3.3.3.m1.1.1.1" xref="id13.3.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="id13.3.3.3.m1.1.1.3" xref="id13.3.3.3.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="id13.3.3.3.m1.1b"><apply id="id13.3.3.3.m1.1.1.cmml" xref="id13.3.3.3.m1.1.1"><times id="id13.3.3.3.m1.1.1.1.cmml" xref="id13.3.3.3.m1.1.1.1"></times><ci id="id13.3.3.3.m1.1.1.2.cmml" xref="id13.3.3.3.m1.1.1.2">𝚂</ci><ci id="id13.3.3.3.m1.1.1.3a.cmml" xref="id13.3.3.3.m1.1.1.3"><mtext id="id13.3.3.3.m1.1.1.3.cmml" xref="id13.3.3.3.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id13.3.3.3.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="id13.3.3.3.m1.1d">typewriter_S -planner</annotation></semantics></math></span> builds a conversational search tree with MCTS based on the initial actions proposed by <span class="ltx_text" id="id14.4.4.4"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="id14.4.4.4.m1.1"><semantics id="id14.4.4.4.m1.1a"><mrow id="id14.4.4.4.m1.1.1" xref="id14.4.4.4.m1.1.1.cmml"><mi id="id14.4.4.4.m1.1.1.2" xref="id14.4.4.4.m1.1.1.2.cmml">𝚂</mi><mo id="id14.4.4.4.m1.1.1.1" xref="id14.4.4.4.m1.1.1.1.cmml">⁢</mo><mtext id="id14.4.4.4.m1.1.1.3" xref="id14.4.4.4.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="id14.4.4.4.m1.1b"><apply id="id14.4.4.4.m1.1.1.cmml" xref="id14.4.4.4.m1.1.1"><times id="id14.4.4.4.m1.1.1.1.cmml" xref="id14.4.4.4.m1.1.1.1"></times><ci id="id14.4.4.4.m1.1.1.2.cmml" xref="id14.4.4.4.m1.1.1.2">𝚂</ci><ci id="id14.4.4.4.m1.1.1.3a.cmml" xref="id14.4.4.4.m1.1.1.3"><mtext id="id14.4.4.4.m1.1.1.3.cmml" xref="id14.4.4.4.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id14.4.4.4.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="id14.4.4.4.m1.1d">typewriter_S -agent</annotation></semantics></math></span> to find conversation plans.
The best conversation plans from <span class="ltx_text" id="id15.5.5.5"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="id15.5.5.5.m1.1"><semantics id="id15.5.5.5.m1.1a"><mrow id="id15.5.5.5.m1.1.1" xref="id15.5.5.5.m1.1.1.cmml"><mi id="id15.5.5.5.m1.1.1.2" xref="id15.5.5.5.m1.1.1.2.cmml">𝚂</mi><mo id="id15.5.5.5.m1.1.1.1" xref="id15.5.5.5.m1.1.1.1.cmml">⁢</mo><mtext id="id15.5.5.5.m1.1.1.3" xref="id15.5.5.5.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="id15.5.5.5.m1.1b"><apply id="id15.5.5.5.m1.1.1.cmml" xref="id15.5.5.5.m1.1.1"><times id="id15.5.5.5.m1.1.1.1.cmml" xref="id15.5.5.5.m1.1.1.1"></times><ci id="id15.5.5.5.m1.1.1.2.cmml" xref="id15.5.5.5.m1.1.1.2">𝚂</ci><ci id="id15.5.5.5.m1.1.1.3a.cmml" xref="id15.5.5.5.m1.1.1.3"><mtext id="id15.5.5.5.m1.1.1.3.cmml" xref="id15.5.5.5.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id15.5.5.5.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="id15.5.5.5.m1.1d">typewriter_S -planner</annotation></semantics></math></span> are used to guide the training of <span class="ltx_text" id="id16.6.6.6"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="id16.6.6.6.m1.1"><semantics id="id16.6.6.6.m1.1a"><mrow id="id16.6.6.6.m1.1.1" xref="id16.6.6.6.m1.1.1.cmml"><mi id="id16.6.6.6.m1.1.1.2" xref="id16.6.6.6.m1.1.1.2.cmml">𝚂</mi><mo id="id16.6.6.6.m1.1.1.1" xref="id16.6.6.6.m1.1.1.1.cmml">⁢</mo><mtext id="id16.6.6.6.m1.1.1.3" xref="id16.6.6.6.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="id16.6.6.6.m1.1b"><apply id="id16.6.6.6.m1.1.1.cmml" xref="id16.6.6.6.m1.1.1"><times id="id16.6.6.6.m1.1.1.1.cmml" xref="id16.6.6.6.m1.1.1.1"></times><ci id="id16.6.6.6.m1.1.1.2.cmml" xref="id16.6.6.6.m1.1.1.2">𝚂</ci><ci id="id16.6.6.6.m1.1.1.3a.cmml" xref="id16.6.6.6.m1.1.1.3"><mtext id="id16.6.6.6.m1.1.1.3.cmml" xref="id16.6.6.6.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id16.6.6.6.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="id16.6.6.6.m1.1d">typewriter_S -agent</annotation></semantics></math></span>, creating a self-training loop where <span class="ltx_text" id="id17.7.7.7"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="id17.7.7.7.m1.1"><semantics id="id17.7.7.7.m1.1a"><mrow id="id17.7.7.7.m1.1.1" xref="id17.7.7.7.m1.1.1.cmml"><mi id="id17.7.7.7.m1.1.1.2" xref="id17.7.7.7.m1.1.1.2.cmml">𝚂</mi><mo id="id17.7.7.7.m1.1.1.1" xref="id17.7.7.7.m1.1.1.1.cmml">⁢</mo><mtext id="id17.7.7.7.m1.1.1.3" xref="id17.7.7.7.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="id17.7.7.7.m1.1b"><apply id="id17.7.7.7.m1.1.1.cmml" xref="id17.7.7.7.m1.1.1"><times id="id17.7.7.7.m1.1.1.1.cmml" xref="id17.7.7.7.m1.1.1.1"></times><ci id="id17.7.7.7.m1.1.1.2.cmml" xref="id17.7.7.7.m1.1.1.2">𝚂</ci><ci id="id17.7.7.7.m1.1.1.3a.cmml" xref="id17.7.7.7.m1.1.1.3"><mtext id="id17.7.7.7.m1.1.1.3.cmml" xref="id17.7.7.7.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id17.7.7.7.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="id17.7.7.7.m1.1d">typewriter_S -agent</annotation></semantics></math></span> can iteratively improve its capability for conversational planning.
Furthermore, we propose an efficient variant <span class="ltx_text" id="id18.8.8.8"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="id18.8.8.8.m1.1"><semantics id="id18.8.8.8.m1.1a"><mrow id="id18.8.8.8.m1.1.1" xref="id18.8.8.8.m1.1.1.cmml"><mi id="id18.8.8.8.m1.1.1.2" xref="id18.8.8.8.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="id18.8.8.8.m1.1.1.1" xref="id18.8.8.8.m1.1.1.1.cmml">⁢</mo><mtext id="id18.8.8.8.m1.1.1.3" xref="id18.8.8.8.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="id18.8.8.8.m1.1b"><apply id="id18.8.8.8.m1.1.1.cmml" xref="id18.8.8.8.m1.1.1"><times id="id18.8.8.8.m1.1.1.1.cmml" xref="id18.8.8.8.m1.1.1.1"></times><ci id="id18.8.8.8.m1.1.1.2.cmml" xref="id18.8.8.8.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="id18.8.8.8.m1.1.1.3a.cmml" xref="id18.8.8.8.m1.1.1.3"><mtext id="id18.8.8.8.m1.1.1.3.cmml" xref="id18.8.8.8.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id18.8.8.8.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="id18.8.8.8.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> for trade-off between training efficiency and performance. Extensive experiments on four benchmark datasets validate the effectiveness of our approach, showing that <span class="ltx_ERROR undefined" id="id18.8.8.11">\method</span>outperforms the state-of-the-art baselines.</span></p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<div class="ltx_block ltx_align_bottom" id="p1.10">
<span class="ltx_ERROR undefined" id="p1.10.11">\method</span>
<p class="ltx_p ltx_align_center" id="p1.10.12"><span class="ltx_text ltx_font_bold" id="p1.10.12.1">: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search</span></p>
<br class="ltx_break ltx_centering"/>
<p class="ltx_p ltx_align_center" id="p1.10.10" style="width:433.6pt;"><span class="ltx_text ltx_inline-block" id="p1.10.10.10" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p1.10.10.10.10">
<span class="ltx_tbody">
<span class="ltx_tr" id="p1.6.6.6.6.6">
<span class="ltx_td ltx_align_center" id="p1.6.6.6.6.6.6" style="padding-top:-1.5pt;padding-bottom:-1.5pt;"><span class="ltx_text ltx_font_bold" id="p1.6.6.6.6.6.6.6">Hanwen Du<sup class="ltx_sup" id="p1.1.1.1.1.1.1.1.1"><math alttext="\clubsuit" class="ltx_Math" display="inline" id="p1.1.1.1.1.1.1.1.1.m1.1"><semantics id="p1.1.1.1.1.1.1.1.1.m1.1a"><mi id="p1.1.1.1.1.1.1.1.1.m1.1.1" mathvariant="normal" xref="p1.1.1.1.1.1.1.1.1.m1.1.1.cmml">♣</mi><annotation-xml encoding="MathML-Content" id="p1.1.1.1.1.1.1.1.1.m1.1b"><ci id="p1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="p1.1.1.1.1.1.1.1.1.m1.1.1">♣</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.1.1.1.1.1.1.1.1.m1.1c">\clubsuit</annotation><annotation encoding="application/x-llamapun" id="p1.1.1.1.1.1.1.1.1.m1.1d">♣</annotation></semantics></math></sup>   Bo Peng<sup class="ltx_sup" id="p1.2.2.2.2.2.2.2.2"><math alttext="\clubsuit" class="ltx_Math" display="inline" id="p1.2.2.2.2.2.2.2.2.m1.1"><semantics id="p1.2.2.2.2.2.2.2.2.m1.1a"><mi id="p1.2.2.2.2.2.2.2.2.m1.1.1" mathvariant="normal" xref="p1.2.2.2.2.2.2.2.2.m1.1.1.cmml">♣</mi><annotation-xml encoding="MathML-Content" id="p1.2.2.2.2.2.2.2.2.m1.1b"><ci id="p1.2.2.2.2.2.2.2.2.m1.1.1.cmml" xref="p1.2.2.2.2.2.2.2.2.m1.1.1">♣</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.2.2.2.2.2.2.2.2.m1.1c">\clubsuit</annotation><annotation encoding="application/x-llamapun" id="p1.2.2.2.2.2.2.2.2.m1.1d">♣</annotation></semantics></math></sup>   Xia Ning<sup class="ltx_sup" id="p1.3.3.3.3.3.3.3.3"><math alttext="\clubsuit" class="ltx_Math" display="inline" id="p1.3.3.3.3.3.3.3.3.m1.1"><semantics id="p1.3.3.3.3.3.3.3.3.m1.1a"><mi id="p1.3.3.3.3.3.3.3.3.m1.1.1" mathvariant="normal" xref="p1.3.3.3.3.3.3.3.3.m1.1.1.cmml">♣</mi><annotation-xml encoding="MathML-Content" id="p1.3.3.3.3.3.3.3.3.m1.1b"><ci id="p1.3.3.3.3.3.3.3.3.m1.1.1.cmml" xref="p1.3.3.3.3.3.3.3.3.m1.1.1">♣</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.3.3.3.3.3.3.3.3.m1.1c">\clubsuit</annotation><annotation encoding="application/x-llamapun" id="p1.3.3.3.3.3.3.3.3.m1.1d">♣</annotation></semantics></math></sup><sup class="ltx_sup" id="p1.4.4.4.4.4.4.4.4"><math alttext="\spadesuit" class="ltx_Math" display="inline" id="p1.4.4.4.4.4.4.4.4.m1.1"><semantics id="p1.4.4.4.4.4.4.4.4.m1.1a"><mi id="p1.4.4.4.4.4.4.4.4.m1.1.1" mathvariant="normal" xref="p1.4.4.4.4.4.4.4.4.m1.1.1.cmml">♠</mi><annotation-xml encoding="MathML-Content" id="p1.4.4.4.4.4.4.4.4.m1.1b"><ci id="p1.4.4.4.4.4.4.4.4.m1.1.1.cmml" xref="p1.4.4.4.4.4.4.4.4.m1.1.1">♠</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.4.4.4.4.4.4.4.4.m1.1c">\spadesuit</annotation><annotation encoding="application/x-llamapun" id="p1.4.4.4.4.4.4.4.4.m1.1d">♠</annotation></semantics></math></sup><sup class="ltx_sup" id="p1.5.5.5.5.5.5.5.5"><math alttext="\heartsuit" class="ltx_Math" display="inline" id="p1.5.5.5.5.5.5.5.5.m1.1"><semantics id="p1.5.5.5.5.5.5.5.5.m1.1a"><mi id="p1.5.5.5.5.5.5.5.5.m1.1.1" mathvariant="normal" xref="p1.5.5.5.5.5.5.5.5.m1.1.1.cmml">♡</mi><annotation-xml encoding="MathML-Content" id="p1.5.5.5.5.5.5.5.5.m1.1b"><ci id="p1.5.5.5.5.5.5.5.5.m1.1.1.cmml" xref="p1.5.5.5.5.5.5.5.5.m1.1.1">♡</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.5.5.5.5.5.5.5.5.m1.1c">\heartsuit</annotation><annotation encoding="application/x-llamapun" id="p1.5.5.5.5.5.5.5.5.m1.1d">♡</annotation></semantics></math></sup><sup class="ltx_sup" id="p1.6.6.6.6.6.6.6.6"><math alttext="\diamondsuit" class="ltx_Math" display="inline" id="p1.6.6.6.6.6.6.6.6.m1.1"><semantics id="p1.6.6.6.6.6.6.6.6.m1.1a"><mi id="p1.6.6.6.6.6.6.6.6.m1.1.1" mathvariant="normal" xref="p1.6.6.6.6.6.6.6.6.m1.1.1.cmml">♢</mi><annotation-xml encoding="MathML-Content" id="p1.6.6.6.6.6.6.6.6.m1.1b"><ci id="p1.6.6.6.6.6.6.6.6.m1.1.1.cmml" xref="p1.6.6.6.6.6.6.6.6.m1.1.1">♢</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.6.6.6.6.6.6.6.6.m1.1c">\diamondsuit</annotation><annotation encoding="application/x-llamapun" id="p1.6.6.6.6.6.6.6.6.m1.1d">♢</annotation></semantics></math></sup>✉</span></span></span>
<span class="ltx_tr" id="p1.7.7.7.7.7">
<span class="ltx_td ltx_align_center" id="p1.7.7.7.7.7.1" style="padding-top:-1.5pt;padding-bottom:-1.5pt;"><sup class="ltx_sup" id="p1.7.7.7.7.7.1.1"><math alttext="\clubsuit" class="ltx_Math" display="inline" id="p1.7.7.7.7.7.1.1.m1.1"><semantics id="p1.7.7.7.7.7.1.1.m1.1a"><mi id="p1.7.7.7.7.7.1.1.m1.1.1" mathvariant="normal" xref="p1.7.7.7.7.7.1.1.m1.1.1.cmml">♣</mi><annotation-xml encoding="MathML-Content" id="p1.7.7.7.7.7.1.1.m1.1b"><ci id="p1.7.7.7.7.7.1.1.m1.1.1.cmml" xref="p1.7.7.7.7.7.1.1.m1.1.1">♣</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.7.7.7.7.7.1.1.m1.1c">\clubsuit</annotation><annotation encoding="application/x-llamapun" id="p1.7.7.7.7.7.1.1.m1.1d">♣</annotation></semantics></math></sup>Department of Computer Science
and Engineering, The Ohio State University, USA</span></span>
<span class="ltx_tr" id="p1.8.8.8.8.8">
<span class="ltx_td ltx_align_center" id="p1.8.8.8.8.8.1" style="padding-top:-1.5pt;padding-bottom:-1.5pt;"><sup class="ltx_sup" id="p1.8.8.8.8.8.1.1"><math alttext="\spadesuit" class="ltx_Math" display="inline" id="p1.8.8.8.8.8.1.1.m1.1"><semantics id="p1.8.8.8.8.8.1.1.m1.1a"><mi id="p1.8.8.8.8.8.1.1.m1.1.1" mathvariant="normal" xref="p1.8.8.8.8.8.1.1.m1.1.1.cmml">♠</mi><annotation-xml encoding="MathML-Content" id="p1.8.8.8.8.8.1.1.m1.1b"><ci id="p1.8.8.8.8.8.1.1.m1.1.1.cmml" xref="p1.8.8.8.8.8.1.1.m1.1.1">♠</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.8.8.8.8.8.1.1.m1.1c">\spadesuit</annotation><annotation encoding="application/x-llamapun" id="p1.8.8.8.8.8.1.1.m1.1d">♠</annotation></semantics></math></sup>Division of Medicinal Chemistry and Pharmacognosy, College of Pharmacy, The Ohio State University, USA</span></span>
<span class="ltx_tr" id="p1.9.9.9.9.9">
<span class="ltx_td ltx_align_center" id="p1.9.9.9.9.9.1" style="padding-top:-1.5pt;padding-bottom:-1.5pt;"><sup class="ltx_sup" id="p1.9.9.9.9.9.1.1"><math alttext="\heartsuit" class="ltx_Math" display="inline" id="p1.9.9.9.9.9.1.1.m1.1"><semantics id="p1.9.9.9.9.9.1.1.m1.1a"><mi id="p1.9.9.9.9.9.1.1.m1.1.1" mathvariant="normal" xref="p1.9.9.9.9.9.1.1.m1.1.1.cmml">♡</mi><annotation-xml encoding="MathML-Content" id="p1.9.9.9.9.9.1.1.m1.1b"><ci id="p1.9.9.9.9.9.1.1.m1.1.1.cmml" xref="p1.9.9.9.9.9.1.1.m1.1.1">♡</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.9.9.9.9.9.1.1.m1.1c">\heartsuit</annotation><annotation encoding="application/x-llamapun" id="p1.9.9.9.9.9.1.1.m1.1d">♡</annotation></semantics></math></sup>Department of Biomedical Informatics, The Ohio State University, USA</span></span>
<span class="ltx_tr" id="p1.10.10.10.10.10">
<span class="ltx_td ltx_align_center" id="p1.10.10.10.10.10.1" style="padding-top:-1.5pt;padding-bottom:-1.5pt;"><sup class="ltx_sup" id="p1.10.10.10.10.10.1.1"><math alttext="\diamondsuit" class="ltx_Math" display="inline" id="p1.10.10.10.10.10.1.1.m1.1"><semantics id="p1.10.10.10.10.10.1.1.m1.1a"><mi id="p1.10.10.10.10.10.1.1.m1.1.1" mathvariant="normal" xref="p1.10.10.10.10.10.1.1.m1.1.1.cmml">♢</mi><annotation-xml encoding="MathML-Content" id="p1.10.10.10.10.10.1.1.m1.1b"><ci id="p1.10.10.10.10.10.1.1.m1.1.1.cmml" xref="p1.10.10.10.10.10.1.1.m1.1.1">♢</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.10.10.10.10.10.1.1.m1.1c">\diamondsuit</annotation><annotation encoding="application/x-llamapun" id="p1.10.10.10.10.10.1.1.m1.1d">♢</annotation></semantics></math></sup>Translational Data Analytics Institute, The Ohio State University, USA</span></span>
<span class="ltx_tr" id="p1.10.10.10.10.11.1">
<span class="ltx_td ltx_align_center" id="p1.10.10.10.10.11.1.1" style="padding-top:-1.5pt;padding-bottom:-1.5pt;"><span class="ltx_text ltx_font_typewriter" id="p1.10.10.10.10.11.1.1.1">{du.1128,peng.707,ning.104}@osu.edu</span></span></span>
</span>
</span></span></p>
<br class="ltx_break ltx_centering"/>
</div>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Conversational Recommender Systems (CRSs) are developed to proactively engage users with interactive dialogues to understand user preferences and provide highly personalized recommendations <cite class="ltx_cite ltx_citemacro_cite">Christakopoulou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib8" title="">2016</a>); Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite>.
For example, on an online dining platform such as Yelp <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite>,
CRS can chat with users through natural language dialogues (e.g., ask a question like, “What is your preferred food type?”) and recommend products that best match the users’ preferences expressed in the conversation.
Among different settings of CRS <cite class="ltx_cite ltx_citemacro_cite">Sun and Zhang (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib41" title="">2018</a>); Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>); He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib18" title="">2023</a>)</cite>, the Multi-turn Conversational Recommendation (MCR) setting <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib28" title="">c</a>); Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>)</cite> is
popular as it can interact/communicate with users multiple times (i.e., multiple turns) to iteratively learn
user preferences <cite class="ltx_cite ltx_citemacro_cite">Fu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib13" title="">2020</a>); Jannach et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib19" title="">2021</a>)</cite>.
In this work, we develop an innovative Monte Carlo Tree Search (MCTS)-based MCR framework to enhance the strategic conversational planning ability for MCR, offering a fresh perspective for handling complex conversation environments and enhancing user experiences.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="258" id="S1.F1.g1" src="x1.png" width="813"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An example of conversational search tree for a user. Conversation starts at the root node with the user specifying preference on an attribute type and its value. The search tree expands as <span class="ltx_text" id="S1.F1.4.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S1.F1.4.1.m1.1"><semantics id="S1.F1.4.1.m1.1b"><mrow id="S1.F1.4.1.m1.1.1" xref="S1.F1.4.1.m1.1.1.cmml"><mi id="S1.F1.4.1.m1.1.1.2" xref="S1.F1.4.1.m1.1.1.2.cmml">𝚂</mi><mo id="S1.F1.4.1.m1.1.1.1" xref="S1.F1.4.1.m1.1.1.1.cmml">⁢</mo><mtext id="S1.F1.4.1.m1.1.1.3" xref="S1.F1.4.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.4.1.m1.1c"><apply id="S1.F1.4.1.m1.1.1.cmml" xref="S1.F1.4.1.m1.1.1"><times id="S1.F1.4.1.m1.1.1.1.cmml" xref="S1.F1.4.1.m1.1.1.1"></times><ci id="S1.F1.4.1.m1.1.1.2.cmml" xref="S1.F1.4.1.m1.1.1.2">𝚂</ci><ci id="S1.F1.4.1.m1.1.1.3a.cmml" xref="S1.F1.4.1.m1.1.1.3"><mtext id="S1.F1.4.1.m1.1.1.3.cmml" xref="S1.F1.4.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.4.1.m1.1d">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.F1.4.1.m1.1e">typewriter_S -agent</annotation></semantics></math></span> decides different action types—<math alttext="\mathtt{ask}" class="ltx_Math" display="inline" id="S1.F1.5.m1.1"><semantics id="S1.F1.5.m1.1b"><mi id="S1.F1.5.m1.1.1" xref="S1.F1.5.m1.1.1.cmml">𝚊𝚜𝚔</mi><annotation-xml encoding="MathML-Content" id="S1.F1.5.m1.1c"><ci id="S1.F1.5.m1.1.1.cmml" xref="S1.F1.5.m1.1.1">𝚊𝚜𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.m1.1d">\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.5.m1.1e">typewriter_ask</annotation></semantics></math> and <math alttext="\mathtt{rec}" class="ltx_Math" display="inline" id="S1.F1.6.m2.1"><semantics id="S1.F1.6.m2.1b"><mi id="S1.F1.6.m2.1.1" xref="S1.F1.6.m2.1.1.cmml">𝚛𝚎𝚌</mi><annotation-xml encoding="MathML-Content" id="S1.F1.6.m2.1c"><ci id="S1.F1.6.m2.1.1.cmml" xref="S1.F1.6.m2.1.1">𝚛𝚎𝚌</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m2.1d">\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.6.m2.1e">typewriter_rec</annotation></semantics></math>—at each turn. Red line connects the highest-rewarded conversation plan found by the tree.</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">A key of MCR is to decide what action (asking a question on specific attribute values or recommending specific items) to take at each conversational turn—a conversational turn consists of the CRS taking an action and the user responding to that action—to effectively elicit information on user preferences and make personalized recommendations <cite class="ltx_cite ltx_citemacro_cite">Fu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib13" title="">2020</a>); Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib26" title="">2020a</a>)</cite>.
To achieve this, previous methods formulated MCR as a Marchovian Decision Process (MDP) <cite class="ltx_cite ltx_citemacro_cite">Bellman (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib3" title="">1957</a>)</cite>,
and trained policy-based <cite class="ltx_cite ltx_citemacro_cite">Sun and Zhang (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib41" title="">2018</a>); Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite> or value-based <cite class="ltx_cite ltx_citemacro_cite">Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>)</cite> agents via Reinforcement Learning (RL) to learn conversation strategies.
Despite promising,
these methods could suffer from myopic actions and limited planning capability due to the following reasons.
First, they base their planning solely on observations of the current state (e.g., items that the user indicates a negative preference for)
without exploring potential future states.
As a result, they could take myopic actions <cite class="ltx_cite ltx_citemacro_cite">Anthony et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib1" title="">2017</a>); Cohen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib9" title="">2022</a>)</cite>.
Second, they generate conversation trajectories, also referred to as conversation plans, by sequentially sampling actions, and thus could suffer from the cumulative error, especially when generating long trajectories for planning <cite class="ltx_cite ltx_citemacro_cite">Kumar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib24" title="">2019</a>); Lan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib25" title="">2020</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.14">To address these limitations, we present a novel MCTS-based MCR framework—<span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.14.15">S</span>trategic <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.14.16">A</span>ction <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.14.17">P</span>lanning with <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.14.18">I</span>ntelligent <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.14.19">E</span>xploration <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.14.20">N</span>on-myopic <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.14.21">T</span>actics, referred to as <span class="ltx_ERROR undefined" id="S1.p3.14.22">\method</span>.
<span class="ltx_ERROR undefined" id="S1.p3.14.23">\method</span>comprises a conversational agent, referred to as <span class="ltx_text" id="S1.p3.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S1.p3.1.1.m1.1"><semantics id="S1.p3.1.1.m1.1a"><mrow id="S1.p3.1.1.m1.1.1" xref="S1.p3.1.1.m1.1.1.cmml"><mi id="S1.p3.1.1.m1.1.1.2" xref="S1.p3.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.1.1.m1.1.1.1" xref="S1.p3.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.1.1.m1.1.1.3" xref="S1.p3.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.1.1.m1.1b"><apply id="S1.p3.1.1.m1.1.1.cmml" xref="S1.p3.1.1.m1.1.1"><times id="S1.p3.1.1.m1.1.1.1.cmml" xref="S1.p3.1.1.m1.1.1.1"></times><ci id="S1.p3.1.1.m1.1.1.2.cmml" xref="S1.p3.1.1.m1.1.1.2">𝚂</ci><ci id="S1.p3.1.1.m1.1.1.3a.cmml" xref="S1.p3.1.1.m1.1.1.3"><mtext id="S1.p3.1.1.m1.1.1.3.cmml" xref="S1.p3.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span>,
where <span class="ltx_text" id="S1.p3.2.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S1.p3.2.2.m1.1"><semantics id="S1.p3.2.2.m1.1a"><mrow id="S1.p3.2.2.m1.1.1" xref="S1.p3.2.2.m1.1.1.cmml"><mi id="S1.p3.2.2.m1.1.1.2" xref="S1.p3.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.2.2.m1.1.1.1" xref="S1.p3.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.2.2.m1.1.1.3" xref="S1.p3.2.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.2.2.m1.1b"><apply id="S1.p3.2.2.m1.1.1.cmml" xref="S1.p3.2.2.m1.1.1"><times id="S1.p3.2.2.m1.1.1.1.cmml" xref="S1.p3.2.2.m1.1.1.1"></times><ci id="S1.p3.2.2.m1.1.1.2.cmml" xref="S1.p3.2.2.m1.1.1.2">𝚂</ci><ci id="S1.p3.2.2.m1.1.1.3a.cmml" xref="S1.p3.2.2.m1.1.1.3"><mtext id="S1.p3.2.2.m1.1.1.3.cmml" xref="S1.p3.2.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> utilizes an MCTS-based algorithm,
referred to as <span class="ltx_text" id="S1.p3.3.3"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S1.p3.3.3.m1.1"><semantics id="S1.p3.3.3.m1.1a"><mrow id="S1.p3.3.3.m1.1.1" xref="S1.p3.3.3.m1.1.1.cmml"><mi id="S1.p3.3.3.m1.1.1.2" xref="S1.p3.3.3.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.3.3.m1.1.1.1" xref="S1.p3.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.3.3.m1.1.1.3" xref="S1.p3.3.3.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.3.3.m1.1b"><apply id="S1.p3.3.3.m1.1.1.cmml" xref="S1.p3.3.3.m1.1.1"><times id="S1.p3.3.3.m1.1.1.1.cmml" xref="S1.p3.3.3.m1.1.1.1"></times><ci id="S1.p3.3.3.m1.1.1.2.cmml" xref="S1.p3.3.3.m1.1.1.2">𝚂</ci><ci id="S1.p3.3.3.m1.1.1.3a.cmml" xref="S1.p3.3.3.m1.1.1.3"><mtext id="S1.p3.3.3.m1.1.1.3.cmml" xref="S1.p3.3.3.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.3.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.3.m1.1d">typewriter_S -planner</annotation></semantics></math></span>, to plan conversations.
<span class="ltx_text" id="S1.p3.4.4"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S1.p3.4.4.m1.1"><semantics id="S1.p3.4.4.m1.1a"><mrow id="S1.p3.4.4.m1.1.1" xref="S1.p3.4.4.m1.1.1.cmml"><mi id="S1.p3.4.4.m1.1.1.2" xref="S1.p3.4.4.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.4.4.m1.1.1.1" xref="S1.p3.4.4.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.4.4.m1.1.1.3" xref="S1.p3.4.4.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.4.4.m1.1b"><apply id="S1.p3.4.4.m1.1.1.cmml" xref="S1.p3.4.4.m1.1.1"><times id="S1.p3.4.4.m1.1.1.1.cmml" xref="S1.p3.4.4.m1.1.1.1"></times><ci id="S1.p3.4.4.m1.1.1.2.cmml" xref="S1.p3.4.4.m1.1.1.2">𝚂</ci><ci id="S1.p3.4.4.m1.1.1.3a.cmml" xref="S1.p3.4.4.m1.1.1.3"><mtext id="S1.p3.4.4.m1.1.1.3.cmml" xref="S1.p3.4.4.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.4.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.4.m1.1d">typewriter_S -agent</annotation></semantics></math></span> builds a global information graph and two personalized graphs with dedicated graph encoders to extract the representation of the conversational states, and synergizes a policy network and a Q-network to decide specific actions based on the learned state representations.
<span class="ltx_text" id="S1.p3.5.5"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S1.p3.5.5.m1.1"><semantics id="S1.p3.5.5.m1.1a"><mrow id="S1.p3.5.5.m1.1.1" xref="S1.p3.5.5.m1.1.1.cmml"><mi id="S1.p3.5.5.m1.1.1.2" xref="S1.p3.5.5.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.5.5.m1.1.1.1" xref="S1.p3.5.5.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.5.5.m1.1.1.3" xref="S1.p3.5.5.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.5.5.m1.1b"><apply id="S1.p3.5.5.m1.1.1.cmml" xref="S1.p3.5.5.m1.1.1"><times id="S1.p3.5.5.m1.1.1.1.cmml" xref="S1.p3.5.5.m1.1.1.1"></times><ci id="S1.p3.5.5.m1.1.1.2.cmml" xref="S1.p3.5.5.m1.1.1.2">𝚂</ci><ci id="S1.p3.5.5.m1.1.1.3a.cmml" xref="S1.p3.5.5.m1.1.1.3"><mtext id="S1.p3.5.5.m1.1.1.3.cmml" xref="S1.p3.5.5.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.5.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.5.5.m1.1d">typewriter_S -planner</annotation></semantics></math></span> leverages MCTS <cite class="ltx_cite ltx_citemacro_cite">Kocsis and Szepesvári (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib23" title="">2006</a>); Coulom (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib10" title="">2007</a>)</cite> to simulate future conversations with lookahead explorations. This non-myopic conversational planning process ensures <span class="ltx_text" id="S1.p3.6.6"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S1.p3.6.6.m1.1"><semantics id="S1.p3.6.6.m1.1a"><mrow id="S1.p3.6.6.m1.1.1" xref="S1.p3.6.6.m1.1.1.cmml"><mi id="S1.p3.6.6.m1.1.1.2" xref="S1.p3.6.6.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.6.6.m1.1.1.1" xref="S1.p3.6.6.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.6.6.m1.1.1.3" xref="S1.p3.6.6.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.6.6.m1.1b"><apply id="S1.p3.6.6.m1.1.1.cmml" xref="S1.p3.6.6.m1.1.1"><times id="S1.p3.6.6.m1.1.1.1.cmml" xref="S1.p3.6.6.m1.1.1.1"></times><ci id="S1.p3.6.6.m1.1.1.2.cmml" xref="S1.p3.6.6.m1.1.1.2">𝚂</ci><ci id="S1.p3.6.6.m1.1.1.3a.cmml" xref="S1.p3.6.6.m1.1.1.3"><mtext id="S1.p3.6.6.m1.1.1.3.cmml" xref="S1.p3.6.6.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.6.6.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.6.6.m1.1d">typewriter_S -planner</annotation></semantics></math></span> can strategically plan conversations that maximize the cumulative reward (a numerical signal measuring whether the action taken by <span class="ltx_text" id="S1.p3.7.7"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S1.p3.7.7.m1.1"><semantics id="S1.p3.7.7.m1.1a"><mrow id="S1.p3.7.7.m1.1.1" xref="S1.p3.7.7.m1.1.1.cmml"><mi id="S1.p3.7.7.m1.1.1.2" xref="S1.p3.7.7.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.7.7.m1.1.1.1" xref="S1.p3.7.7.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.7.7.m1.1.1.3" xref="S1.p3.7.7.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.7.7.m1.1b"><apply id="S1.p3.7.7.m1.1.1.cmml" xref="S1.p3.7.7.m1.1.1"><times id="S1.p3.7.7.m1.1.1.1.cmml" xref="S1.p3.7.7.m1.1.1.1"></times><ci id="S1.p3.7.7.m1.1.1.2.cmml" xref="S1.p3.7.7.m1.1.1.2">𝚂</ci><ci id="S1.p3.7.7.m1.1.1.3a.cmml" xref="S1.p3.7.7.m1.1.1.3"><mtext id="S1.p3.7.7.m1.1.1.3.cmml" xref="S1.p3.7.7.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.7.7.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.7.7.m1.1d">typewriter_S -agent</annotation></semantics></math></span> is good or not), instead of greedily selecting actions based on immediate reward.
The best conversation plans with the highest cumulative rewards found by <span class="ltx_text" id="S1.p3.8.8"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S1.p3.8.8.m1.1"><semantics id="S1.p3.8.8.m1.1a"><mrow id="S1.p3.8.8.m1.1.1" xref="S1.p3.8.8.m1.1.1.cmml"><mi id="S1.p3.8.8.m1.1.1.2" xref="S1.p3.8.8.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.8.8.m1.1.1.1" xref="S1.p3.8.8.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.8.8.m1.1.1.3" xref="S1.p3.8.8.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.8.8.m1.1b"><apply id="S1.p3.8.8.m1.1.1.cmml" xref="S1.p3.8.8.m1.1.1"><times id="S1.p3.8.8.m1.1.1.1.cmml" xref="S1.p3.8.8.m1.1.1.1"></times><ci id="S1.p3.8.8.m1.1.1.2.cmml" xref="S1.p3.8.8.m1.1.1.2">𝚂</ci><ci id="S1.p3.8.8.m1.1.1.3a.cmml" xref="S1.p3.8.8.m1.1.1.3"><mtext id="S1.p3.8.8.m1.1.1.3.cmml" xref="S1.p3.8.8.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.8.8.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.8.8.m1.1d">typewriter_S -planner</annotation></semantics></math></span> are used to guide the training of <span class="ltx_text" id="S1.p3.9.9"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S1.p3.9.9.m1.1"><semantics id="S1.p3.9.9.m1.1a"><mrow id="S1.p3.9.9.m1.1.1" xref="S1.p3.9.9.m1.1.1.cmml"><mi id="S1.p3.9.9.m1.1.1.2" xref="S1.p3.9.9.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.9.9.m1.1.1.1" xref="S1.p3.9.9.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.9.9.m1.1.1.3" xref="S1.p3.9.9.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.9.9.m1.1b"><apply id="S1.p3.9.9.m1.1.1.cmml" xref="S1.p3.9.9.m1.1.1"><times id="S1.p3.9.9.m1.1.1.1.cmml" xref="S1.p3.9.9.m1.1.1.1"></times><ci id="S1.p3.9.9.m1.1.1.2.cmml" xref="S1.p3.9.9.m1.1.1.2">𝚂</ci><ci id="S1.p3.9.9.m1.1.1.3a.cmml" xref="S1.p3.9.9.m1.1.1.3"><mtext id="S1.p3.9.9.m1.1.1.3.cmml" xref="S1.p3.9.9.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.9.9.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.9.9.m1.1d">typewriter_S -agent</annotation></semantics></math></span>.
In this way, <span class="ltx_text" id="S1.p3.10.10"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S1.p3.10.10.m1.1"><semantics id="S1.p3.10.10.m1.1a"><mrow id="S1.p3.10.10.m1.1.1" xref="S1.p3.10.10.m1.1.1.cmml"><mi id="S1.p3.10.10.m1.1.1.2" xref="S1.p3.10.10.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.10.10.m1.1.1.1" xref="S1.p3.10.10.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.10.10.m1.1.1.3" xref="S1.p3.10.10.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.10.10.m1.1b"><apply id="S1.p3.10.10.m1.1.1.cmml" xref="S1.p3.10.10.m1.1.1"><times id="S1.p3.10.10.m1.1.1.1.cmml" xref="S1.p3.10.10.m1.1.1.1"></times><ci id="S1.p3.10.10.m1.1.1.2.cmml" xref="S1.p3.10.10.m1.1.1.2">𝚂</ci><ci id="S1.p3.10.10.m1.1.1.3a.cmml" xref="S1.p3.10.10.m1.1.1.3"><mtext id="S1.p3.10.10.m1.1.1.3.cmml" xref="S1.p3.10.10.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.10.10.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.10.10.m1.1d">typewriter_S -agent</annotation></semantics></math></span> can engage in a self-training loop <cite class="ltx_cite ltx_citemacro_cite">Silver et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib40" title="">2017</a>)</cite>—collecting trajectories from multiple conversation simulations and training the <span class="ltx_text" id="S1.p3.11.11"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S1.p3.11.11.m1.1"><semantics id="S1.p3.11.11.m1.1a"><mrow id="S1.p3.11.11.m1.1.1" xref="S1.p3.11.11.m1.1.1.cmml"><mi id="S1.p3.11.11.m1.1.1.2" xref="S1.p3.11.11.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.11.11.m1.1.1.1" xref="S1.p3.11.11.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.11.11.m1.1.1.3" xref="S1.p3.11.11.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.11.11.m1.1b"><apply id="S1.p3.11.11.m1.1.1.cmml" xref="S1.p3.11.11.m1.1.1"><times id="S1.p3.11.11.m1.1.1.1.cmml" xref="S1.p3.11.11.m1.1.1.1"></times><ci id="S1.p3.11.11.m1.1.1.2.cmml" xref="S1.p3.11.11.m1.1.1.2">𝚂</ci><ci id="S1.p3.11.11.m1.1.1.3a.cmml" xref="S1.p3.11.11.m1.1.1.3"><mtext id="S1.p3.11.11.m1.1.1.3.cmml" xref="S1.p3.11.11.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.11.11.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.11.11.m1.1d">typewriter_S -agent</annotation></semantics></math></span> on selected, high-rewarded trajectories—to iteratively improve its planning capability.
During inference, <span class="ltx_text" id="S1.p3.12.12"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S1.p3.12.12.m1.1"><semantics id="S1.p3.12.12.m1.1a"><mrow id="S1.p3.12.12.m1.1.1" xref="S1.p3.12.12.m1.1.1.cmml"><mi id="S1.p3.12.12.m1.1.1.2" xref="S1.p3.12.12.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.12.12.m1.1.1.1" xref="S1.p3.12.12.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.12.12.m1.1.1.3" xref="S1.p3.12.12.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.12.12.m1.1b"><apply id="S1.p3.12.12.m1.1.1.cmml" xref="S1.p3.12.12.m1.1.1"><times id="S1.p3.12.12.m1.1.1.1.cmml" xref="S1.p3.12.12.m1.1.1.1"></times><ci id="S1.p3.12.12.m1.1.1.2.cmml" xref="S1.p3.12.12.m1.1.1.2">𝚂</ci><ci id="S1.p3.12.12.m1.1.1.3a.cmml" xref="S1.p3.12.12.m1.1.1.3"><mtext id="S1.p3.12.12.m1.1.1.3.cmml" xref="S1.p3.12.12.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.12.12.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.12.12.m1.1d">typewriter_S -agent</annotation></semantics></math></span> can directly make well-informed decisions without <span class="ltx_text" id="S1.p3.13.13"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S1.p3.13.13.m1.1"><semantics id="S1.p3.13.13.m1.1a"><mrow id="S1.p3.13.13.m1.1.1" xref="S1.p3.13.13.m1.1.1.cmml"><mi id="S1.p3.13.13.m1.1.1.2" xref="S1.p3.13.13.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.13.13.m1.1.1.1" xref="S1.p3.13.13.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.13.13.m1.1.1.3" xref="S1.p3.13.13.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.13.13.m1.1b"><apply id="S1.p3.13.13.m1.1.1.cmml" xref="S1.p3.13.13.m1.1.1"><times id="S1.p3.13.13.m1.1.1.1.cmml" xref="S1.p3.13.13.m1.1.1.1"></times><ci id="S1.p3.13.13.m1.1.1.2.cmml" xref="S1.p3.13.13.m1.1.1.2">𝚂</ci><ci id="S1.p3.13.13.m1.1.1.3a.cmml" xref="S1.p3.13.13.m1.1.1.3"><mtext id="S1.p3.13.13.m1.1.1.3.cmml" xref="S1.p3.13.13.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.13.13.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.13.13.m1.1d">typewriter_S -planner</annotation></semantics></math></span>, since it inherits the <span class="ltx_text" id="S1.p3.14.14"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S1.p3.14.14.m1.1"><semantics id="S1.p3.14.14.m1.1a"><mrow id="S1.p3.14.14.m1.1.1" xref="S1.p3.14.14.m1.1.1.cmml"><mi id="S1.p3.14.14.m1.1.1.2" xref="S1.p3.14.14.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p3.14.14.m1.1.1.1" xref="S1.p3.14.14.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p3.14.14.m1.1.1.3" xref="S1.p3.14.14.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.14.14.m1.1b"><apply id="S1.p3.14.14.m1.1.1.cmml" xref="S1.p3.14.14.m1.1.1"><times id="S1.p3.14.14.m1.1.1.1.cmml" xref="S1.p3.14.14.m1.1.1.1"></times><ci id="S1.p3.14.14.m1.1.1.2.cmml" xref="S1.p3.14.14.m1.1.1.2">𝚂</ci><ci id="S1.p3.14.14.m1.1.1.3a.cmml" xref="S1.p3.14.14.m1.1.1.3"><mtext id="S1.p3.14.14.m1.1.1.3.cmml" xref="S1.p3.14.14.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.14.14.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p3.14.14.m1.1d">typewriter_S -planner</annotation></semantics></math></span>’s expertise in strategic and non-myopic planning.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.3">To make MCTS scalable w.r.t. the size of items and attributes, we introduce a hierarchical action selection process <cite class="ltx_cite ltx_citemacro_cite">Nachum et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib34" title="">2018</a>)</cite>, and two action types: <math alttext="\mathtt{ask}" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mi id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">𝚊𝚜𝚔</mi><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">𝚊𝚜𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">typewriter_ask</annotation></semantics></math> and <math alttext="\mathtt{rec}" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mi id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">𝚛𝚎𝚌</mi><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">𝚛𝚎𝚌</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">typewriter_rec</annotation></semantics></math>. At each turn, instead of searching over all the items and attribute values, <span class="ltx_text" id="S1.p4.3.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S1.p4.3.1.m1.1"><semantics id="S1.p4.3.1.m1.1a"><mrow id="S1.p4.3.1.m1.1.1" xref="S1.p4.3.1.m1.1.1.cmml"><mi id="S1.p4.3.1.m1.1.1.2" xref="S1.p4.3.1.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p4.3.1.m1.1.1.1" xref="S1.p4.3.1.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p4.3.1.m1.1.1.3" xref="S1.p4.3.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.3.1.m1.1b"><apply id="S1.p4.3.1.m1.1.1.cmml" xref="S1.p4.3.1.m1.1.1"><times id="S1.p4.3.1.m1.1.1.1.cmml" xref="S1.p4.3.1.m1.1.1.1"></times><ci id="S1.p4.3.1.m1.1.1.2.cmml" xref="S1.p4.3.1.m1.1.1.2">𝚂</ci><ci id="S1.p4.3.1.m1.1.1.3a.cmml" xref="S1.p4.3.1.m1.1.1.3"><mtext id="S1.p4.3.1.m1.1.1.3.cmml" xref="S1.p4.3.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p4.3.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> builds a conversational search tree (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">1</span></a>) that only searches over the two action types and uses the Q-network to decide the specific action, thus greatly reducing the search space.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We evaluate <span class="ltx_ERROR undefined" id="S1.p5.1.1">\method</span>against 9 state-of-the-art CRS baselines, and show <span class="ltx_ERROR undefined" id="S1.p5.1.2">\method</span>significantly outperforms baselines on 4 benchmark datasets.
Our case study also shows that the action strategies of <span class="ltx_ERROR undefined" id="S1.p5.1.3">\method</span>are beneficial for information seeking and recommendation success in the conversations.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.4">Furthermore, we develop an efficient variant of <span class="ltx_ERROR undefined" id="S1.p6.4.5">\method</span>, denoted as <span class="ltx_text" id="S1.p6.1.1"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S1.p6.1.1.m1.1"><semantics id="S1.p6.1.1.m1.1a"><mrow id="S1.p6.1.1.m1.1.1" xref="S1.p6.1.1.m1.1.1.cmml"><mi id="S1.p6.1.1.m1.1.1.2" xref="S1.p6.1.1.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S1.p6.1.1.m1.1.1.1" xref="S1.p6.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p6.1.1.m1.1.1.3" xref="S1.p6.1.1.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.1.1.m1.1b"><apply id="S1.p6.1.1.m1.1.1.cmml" xref="S1.p6.1.1.m1.1.1"><times id="S1.p6.1.1.m1.1.1.1.cmml" xref="S1.p6.1.1.m1.1.1.1"></times><ci id="S1.p6.1.1.m1.1.1.2.cmml" xref="S1.p6.1.1.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S1.p6.1.1.m1.1.1.3a.cmml" xref="S1.p6.1.1.m1.1.1.3"><mtext id="S1.p6.1.1.m1.1.1.3.cmml" xref="S1.p6.1.1.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.1.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p6.1.1.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span>.
Different from <span class="ltx_ERROR undefined" id="S1.p6.4.6">\method</span>, which is trained on selected, high-rewarded trajectories, <span class="ltx_text" id="S1.p6.2.2"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S1.p6.2.2.m1.1"><semantics id="S1.p6.2.2.m1.1a"><mrow id="S1.p6.2.2.m1.1.1" xref="S1.p6.2.2.m1.1.1.cmml"><mi id="S1.p6.2.2.m1.1.1.2" xref="S1.p6.2.2.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S1.p6.2.2.m1.1.1.1" xref="S1.p6.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p6.2.2.m1.1.1.3" xref="S1.p6.2.2.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.2.2.m1.1b"><apply id="S1.p6.2.2.m1.1.1.cmml" xref="S1.p6.2.2.m1.1.1"><times id="S1.p6.2.2.m1.1.1.1.cmml" xref="S1.p6.2.2.m1.1.1.1"></times><ci id="S1.p6.2.2.m1.1.1.2.cmml" xref="S1.p6.2.2.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S1.p6.2.2.m1.1.1.3a.cmml" xref="S1.p6.2.2.m1.1.1.3"><mtext id="S1.p6.2.2.m1.1.1.3.cmml" xref="S1.p6.2.2.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.2.2.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p6.2.2.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> consumes all trajectories found by <span class="ltx_text" id="S1.p6.3.3"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S1.p6.3.3.m1.1"><semantics id="S1.p6.3.3.m1.1a"><mrow id="S1.p6.3.3.m1.1.1" xref="S1.p6.3.3.m1.1.1.cmml"><mi id="S1.p6.3.3.m1.1.1.2" xref="S1.p6.3.3.m1.1.1.2.cmml">𝚂</mi><mo id="S1.p6.3.3.m1.1.1.1" xref="S1.p6.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p6.3.3.m1.1.1.3" xref="S1.p6.3.3.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.3.3.m1.1b"><apply id="S1.p6.3.3.m1.1.1.cmml" xref="S1.p6.3.3.m1.1.1"><times id="S1.p6.3.3.m1.1.1.1.cmml" xref="S1.p6.3.3.m1.1.1.1"></times><ci id="S1.p6.3.3.m1.1.1.2.cmml" xref="S1.p6.3.3.m1.1.1.2">𝚂</ci><ci id="S1.p6.3.3.m1.1.1.3a.cmml" xref="S1.p6.3.3.m1.1.1.3"><mtext id="S1.p6.3.3.m1.1.1.3.cmml" xref="S1.p6.3.3.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.3.3.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p6.3.3.m1.1d">typewriter_S -planner</annotation></semantics></math></span> for training via a listwise ranking loss.
As a result, <span class="ltx_text" id="S1.p6.4.4"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S1.p6.4.4.m1.1"><semantics id="S1.p6.4.4.m1.1a"><mrow id="S1.p6.4.4.m1.1.1" xref="S1.p6.4.4.m1.1.1.cmml"><mi id="S1.p6.4.4.m1.1.1.2" xref="S1.p6.4.4.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S1.p6.4.4.m1.1.1.1" xref="S1.p6.4.4.m1.1.1.1.cmml">⁢</mo><mtext id="S1.p6.4.4.m1.1.1.3" xref="S1.p6.4.4.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.4.4.m1.1b"><apply id="S1.p6.4.4.m1.1.1.cmml" xref="S1.p6.4.4.m1.1.1"><times id="S1.p6.4.4.m1.1.1.1.cmml" xref="S1.p6.4.4.m1.1.1.1"></times><ci id="S1.p6.4.4.m1.1.1.2.cmml" xref="S1.p6.4.4.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S1.p6.4.4.m1.1.1.3a.cmml" xref="S1.p6.4.4.m1.1.1.3"><mtext id="S1.p6.4.4.m1.1.1.3.cmml" xref="S1.p6.4.4.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.4.4.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.p6.4.4.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> requires less cost of collecting training trajectories compared to <span class="ltx_ERROR undefined" id="S1.p6.4.7">\method</span>, and enables superior efficiency.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Our contributions are summarized as follows:</p>
</div>
<div class="ltx_para" id="S1.p8">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.3">We present <span class="ltx_ERROR undefined" id="S1.I1.i1.p1.3.4">\method</span>, a novel MCR framework synergizing an MCTS-based <span class="ltx_text" id="S1.I1.i1.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S1.I1.i1.p1.1.1.m1.1"><semantics id="S1.I1.i1.p1.1.1.m1.1a"><mrow id="S1.I1.i1.p1.1.1.m1.1.1" xref="S1.I1.i1.p1.1.1.m1.1.1.cmml"><mi id="S1.I1.i1.p1.1.1.m1.1.1.2" xref="S1.I1.i1.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S1.I1.i1.p1.1.1.m1.1.1.1" xref="S1.I1.i1.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S1.I1.i1.p1.1.1.m1.1.1.3" xref="S1.I1.i1.p1.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.1.m1.1b"><apply id="S1.I1.i1.p1.1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.1.m1.1.1"><times id="S1.I1.i1.p1.1.1.m1.1.1.1.cmml" xref="S1.I1.i1.p1.1.1.m1.1.1.1"></times><ci id="S1.I1.i1.p1.1.1.m1.1.1.2.cmml" xref="S1.I1.i1.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S1.I1.i1.p1.1.1.m1.1.1.3a.cmml" xref="S1.I1.i1.p1.1.1.m1.1.1.3"><mtext id="S1.I1.i1.p1.1.1.m1.1.1.3.cmml" xref="S1.I1.i1.p1.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> and an <span class="ltx_text" id="S1.I1.i1.p1.2.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S1.I1.i1.p1.2.2.m1.1"><semantics id="S1.I1.i1.p1.2.2.m1.1a"><mrow id="S1.I1.i1.p1.2.2.m1.1.1" xref="S1.I1.i1.p1.2.2.m1.1.1.cmml"><mi id="S1.I1.i1.p1.2.2.m1.1.1.2" xref="S1.I1.i1.p1.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="S1.I1.i1.p1.2.2.m1.1.1.1" xref="S1.I1.i1.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S1.I1.i1.p1.2.2.m1.1.1.3" xref="S1.I1.i1.p1.2.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.2.2.m1.1b"><apply id="S1.I1.i1.p1.2.2.m1.1.1.cmml" xref="S1.I1.i1.p1.2.2.m1.1.1"><times id="S1.I1.i1.p1.2.2.m1.1.1.1.cmml" xref="S1.I1.i1.p1.2.2.m1.1.1.1"></times><ci id="S1.I1.i1.p1.2.2.m1.1.1.2.cmml" xref="S1.I1.i1.p1.2.2.m1.1.1.2">𝚂</ci><ci id="S1.I1.i1.p1.2.2.m1.1.1.3a.cmml" xref="S1.I1.i1.p1.2.2.m1.1.1.3"><mtext id="S1.I1.i1.p1.2.2.m1.1.1.3.cmml" xref="S1.I1.i1.p1.2.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.2.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.2.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> with a self-training loop to iteratively improve <span class="ltx_text" id="S1.I1.i1.p1.3.3"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S1.I1.i1.p1.3.3.m1.1"><semantics id="S1.I1.i1.p1.3.3.m1.1a"><mrow id="S1.I1.i1.p1.3.3.m1.1.1" xref="S1.I1.i1.p1.3.3.m1.1.1.cmml"><mi id="S1.I1.i1.p1.3.3.m1.1.1.2" xref="S1.I1.i1.p1.3.3.m1.1.1.2.cmml">𝚂</mi><mo id="S1.I1.i1.p1.3.3.m1.1.1.1" xref="S1.I1.i1.p1.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="S1.I1.i1.p1.3.3.m1.1.1.3" xref="S1.I1.i1.p1.3.3.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.3.3.m1.1b"><apply id="S1.I1.i1.p1.3.3.m1.1.1.cmml" xref="S1.I1.i1.p1.3.3.m1.1.1"><times id="S1.I1.i1.p1.3.3.m1.1.1.1.cmml" xref="S1.I1.i1.p1.3.3.m1.1.1.1"></times><ci id="S1.I1.i1.p1.3.3.m1.1.1.2.cmml" xref="S1.I1.i1.p1.3.3.m1.1.1.2">𝚂</ci><ci id="S1.I1.i1.p1.3.3.m1.1.1.3a.cmml" xref="S1.I1.i1.p1.3.3.m1.1.1.3"><mtext id="S1.I1.i1.p1.3.3.m1.1.1.3.cmml" xref="S1.I1.i1.p1.3.3.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.3.3.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.3.3.m1.1d">typewriter_S -agent</annotation></semantics></math></span>’s planning capability. To the best of our knowledge, <span class="ltx_ERROR undefined" id="S1.I1.i1.p1.3.5">\method</span>is the first to leverage an MCTS-based planning algorithm to achieve strategic, non-myopic planning for MCR.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.3">We further develop <span class="ltx_text" id="S1.I1.i2.p1.1.1"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S1.I1.i2.p1.1.1.m1.1"><semantics id="S1.I1.i2.p1.1.1.m1.1a"><mrow id="S1.I1.i2.p1.1.1.m1.1.1" xref="S1.I1.i2.p1.1.1.m1.1.1.cmml"><mi id="S1.I1.i2.p1.1.1.m1.1.1.2" xref="S1.I1.i2.p1.1.1.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S1.I1.i2.p1.1.1.m1.1.1.1" xref="S1.I1.i2.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S1.I1.i2.p1.1.1.m1.1.1.3" xref="S1.I1.i2.p1.1.1.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.1.1.m1.1b"><apply id="S1.I1.i2.p1.1.1.m1.1.1.cmml" xref="S1.I1.i2.p1.1.1.m1.1.1"><times id="S1.I1.i2.p1.1.1.m1.1.1.1.cmml" xref="S1.I1.i2.p1.1.1.m1.1.1.1"></times><ci id="S1.I1.i2.p1.1.1.m1.1.1.2.cmml" xref="S1.I1.i2.p1.1.1.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S1.I1.i2.p1.1.1.m1.1.1.3a.cmml" xref="S1.I1.i2.p1.1.1.m1.1.1.3"><mtext id="S1.I1.i2.p1.1.1.m1.1.1.3.cmml" xref="S1.I1.i2.p1.1.1.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.1.1.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.1.1.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span>, an efficient variant trained on all trajectories from <span class="ltx_text" id="S1.I1.i2.p1.2.2"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S1.I1.i2.p1.2.2.m1.1"><semantics id="S1.I1.i2.p1.2.2.m1.1a"><mrow id="S1.I1.i2.p1.2.2.m1.1.1" xref="S1.I1.i2.p1.2.2.m1.1.1.cmml"><mi id="S1.I1.i2.p1.2.2.m1.1.1.2" xref="S1.I1.i2.p1.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="S1.I1.i2.p1.2.2.m1.1.1.1" xref="S1.I1.i2.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S1.I1.i2.p1.2.2.m1.1.1.3" xref="S1.I1.i2.p1.2.2.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.2.2.m1.1b"><apply id="S1.I1.i2.p1.2.2.m1.1.1.cmml" xref="S1.I1.i2.p1.2.2.m1.1.1"><times id="S1.I1.i2.p1.2.2.m1.1.1.1.cmml" xref="S1.I1.i2.p1.2.2.m1.1.1.1"></times><ci id="S1.I1.i2.p1.2.2.m1.1.1.2.cmml" xref="S1.I1.i2.p1.2.2.m1.1.1.2">𝚂</ci><ci id="S1.I1.i2.p1.2.2.m1.1.1.3a.cmml" xref="S1.I1.i2.p1.2.2.m1.1.1.3"><mtext id="S1.I1.i2.p1.2.2.m1.1.1.3.cmml" xref="S1.I1.i2.p1.2.2.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.2.2.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.2.2.m1.1d">typewriter_S -planner</annotation></semantics></math></span> via a listwise ranking loss. <span class="ltx_text" id="S1.I1.i2.p1.3.3"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S1.I1.i2.p1.3.3.m1.1"><semantics id="S1.I1.i2.p1.3.3.m1.1a"><mrow id="S1.I1.i2.p1.3.3.m1.1.1" xref="S1.I1.i2.p1.3.3.m1.1.1.cmml"><mi id="S1.I1.i2.p1.3.3.m1.1.1.2" xref="S1.I1.i2.p1.3.3.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S1.I1.i2.p1.3.3.m1.1.1.1" xref="S1.I1.i2.p1.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="S1.I1.i2.p1.3.3.m1.1.1.3" xref="S1.I1.i2.p1.3.3.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.3.3.m1.1b"><apply id="S1.I1.i2.p1.3.3.m1.1.1.cmml" xref="S1.I1.i2.p1.3.3.m1.1.1"><times id="S1.I1.i2.p1.3.3.m1.1.1.1.cmml" xref="S1.I1.i2.p1.3.3.m1.1.1.1"></times><ci id="S1.I1.i2.p1.3.3.m1.1.1.2.cmml" xref="S1.I1.i2.p1.3.3.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S1.I1.i2.p1.3.3.m1.1.1.3a.cmml" xref="S1.I1.i2.p1.3.3.m1.1.1.3"><mtext id="S1.I1.i2.p1.3.3.m1.1.1.3.cmml" xref="S1.I1.i2.p1.3.3.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.3.3.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.3.3.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> addresses the efficiency issue with MCTS while maintaining similar performance with <span class="ltx_ERROR undefined" id="S1.I1.i2.p1.3.4">\method</span>.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Our extensive experiments show both <span class="ltx_ERROR undefined" id="S1.I1.i3.p1.1.2">\method</span>and <span class="ltx_text" id="S1.I1.i3.p1.1.1"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S1.I1.i3.p1.1.1.m1.1"><semantics id="S1.I1.i3.p1.1.1.m1.1a"><mrow id="S1.I1.i3.p1.1.1.m1.1.1" xref="S1.I1.i3.p1.1.1.m1.1.1.cmml"><mi id="S1.I1.i3.p1.1.1.m1.1.1.2" xref="S1.I1.i3.p1.1.1.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S1.I1.i3.p1.1.1.m1.1.1.1" xref="S1.I1.i3.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S1.I1.i3.p1.1.1.m1.1.1.3" xref="S1.I1.i3.p1.1.1.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.1.m1.1b"><apply id="S1.I1.i3.p1.1.1.m1.1.1.cmml" xref="S1.I1.i3.p1.1.1.m1.1.1"><times id="S1.I1.i3.p1.1.1.m1.1.1.1.cmml" xref="S1.I1.i3.p1.1.1.m1.1.1.1"></times><ci id="S1.I1.i3.p1.1.1.m1.1.1.2.cmml" xref="S1.I1.i3.p1.1.1.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S1.I1.i3.p1.1.1.m1.1.1.3a.cmml" xref="S1.I1.i3.p1.1.1.m1.1.1.3"><mtext id="S1.I1.i3.p1.1.1.m1.1.1.3.cmml" xref="S1.I1.i3.p1.1.1.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.1.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.1.1.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> outperform the state-of-the-art baselines. Our case study shows <span class="ltx_ERROR undefined" id="S1.I1.i3.p1.1.3">\method</span>can strategically take actions that enhance information seeking and recommendation success.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.6">CRS understands user preferences through interactive natural language conversations to provide personalized recommendations <cite class="ltx_cite ltx_citemacro_cite">Fu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib13" title="">2020</a>); Jannach et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib19" title="">2021</a>)</cite>.
Early methods <cite class="ltx_cite ltx_citemacro_cite">Christakopoulou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib8" title="">2016</a>); Sun and Zhang (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib41" title="">2018</a>)</cite> ask users about their desired attribute values to narrow down the list of candidate items to recommend, but are limited under the single-turn setting, as they can only recommend once in a conversation.
To address this, multi-turn CRSs allow for multiple turns of question inquiries and item recommendations.
For example, <span class="ltx_text" id="S2.p1.1.1"><math alttext="\mathop{\mathtt{EAR}}\limits" class="ltx_Math" display="inline" id="S2.p1.1.1.m1.1"><semantics id="S2.p1.1.1.m1.1a"><mo id="S2.p1.1.1.m1.1.1" movablelimits="false" xref="S2.p1.1.1.m1.1.1.cmml">𝙴𝙰𝚁</mo><annotation-xml encoding="MathML-Content" id="S2.p1.1.1.m1.1b"><ci id="S2.p1.1.1.m1.1.1.cmml" xref="S2.p1.1.1.m1.1.1">𝙴𝙰𝚁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.1.m1.1c">\mathop{\mathtt{EAR}}\limits</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.1.m1.1d">typewriter_EAR</annotation></semantics></math></span> <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite> adjusts the conversation strategy based on the user’s feedbacks with a three-staged process.
<span class="ltx_text" id="S2.p1.2.2"><math alttext="\mathop{\mathtt{SCPR}}\limits" class="ltx_Math" display="inline" id="S2.p1.2.2.m1.1"><semantics id="S2.p1.2.2.m1.1a"><mo id="S2.p1.2.2.m1.1.1" movablelimits="false" xref="S2.p1.2.2.m1.1.1.cmml">𝚂𝙲𝙿𝚁</mo><annotation-xml encoding="MathML-Content" id="S2.p1.2.2.m1.1b"><ci id="S2.p1.2.2.m1.1.1.cmml" xref="S2.p1.2.2.m1.1.1">𝚂𝙲𝙿𝚁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.2.m1.1c">\mathop{\mathtt{SCPR}}\limits</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.2.m1.1d">typewriter_SCPR</annotation></semantics></math></span> <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib28" title="">2020c</a>)</cite> models MCR as a path reasoning problem over the knowledge graph of users, items, and attribute values.
<span class="ltx_text" id="S2.p1.3.3"><math alttext="\mathop{\mathtt{UNICORN}}\limits" class="ltx_Math" display="inline" id="S2.p1.3.3.m1.1"><semantics id="S2.p1.3.3.m1.1a"><mo id="S2.p1.3.3.m1.1.1" movablelimits="false" xref="S2.p1.3.3.m1.1.1.cmml">𝚄𝙽𝙸𝙲𝙾𝚁𝙽</mo><annotation-xml encoding="MathML-Content" id="S2.p1.3.3.m1.1b"><ci id="S2.p1.3.3.m1.1.1.cmml" xref="S2.p1.3.3.m1.1.1">𝚄𝙽𝙸𝙲𝙾𝚁𝙽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.3.m1.1c">\mathop{\mathtt{UNICORN}}\limits</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.3.m1.1d">typewriter_UNICORN</annotation></semantics></math></span> <cite class="ltx_cite ltx_citemacro_cite">Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>)</cite> introduces a graph-based RL framework for MCR.
<span class="ltx_text" id="S2.p1.4.4"><math alttext="\mathop{\mathtt{MCMIPL}}\limits" class="ltx_Math" display="inline" id="S2.p1.4.4.m1.1"><semantics id="S2.p1.4.4.m1.1a"><mo id="S2.p1.4.4.m1.1.1" movablelimits="false" xref="S2.p1.4.4.m1.1.1.cmml">𝙼𝙲𝙼𝙸𝙿𝙻</mo><annotation-xml encoding="MathML-Content" id="S2.p1.4.4.m1.1b"><ci id="S2.p1.4.4.m1.1.1.cmml" xref="S2.p1.4.4.m1.1.1">𝙼𝙲𝙼𝙸𝙿𝙻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.4.m1.1c">\mathop{\mathtt{MCMIPL}}\limits</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.4.m1.1d">typewriter_MCMIPL</annotation></semantics></math></span> <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>)</cite> develops a multi-interest policy learning framework to understand user’s interests over multiple attribute values.
<span class="ltx_text" id="S2.p1.5.5"><math alttext="\mathop{\mathtt{HutCRS}}\limits" class="ltx_Math" display="inline" id="S2.p1.5.5.m1.1"><semantics id="S2.p1.5.5.m1.1a"><mo id="S2.p1.5.5.m1.1.1" movablelimits="false" xref="S2.p1.5.5.m1.1.1.cmml">𝙷𝚞𝚝𝙲𝚁𝚂</mo><annotation-xml encoding="MathML-Content" id="S2.p1.5.5.m1.1b"><ci id="S2.p1.5.5.m1.1.1.cmml" xref="S2.p1.5.5.m1.1.1">𝙷𝚞𝚝𝙲𝚁𝚂</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.5.m1.1c">\mathop{\mathtt{HutCRS}}\limits</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.5.m1.1d">typewriter_HutCRS</annotation></semantics></math></span> <cite class="ltx_cite ltx_citemacro_cite">Qian et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib36" title="">2023</a>)</cite> introduces a user interest tracing module to track user preferences.
<span class="ltx_text" id="S2.p1.6.6"><math alttext="\mathop{\mathtt{CORE}}\limits" class="ltx_Math" display="inline" id="S2.p1.6.6.m1.1"><semantics id="S2.p1.6.6.m1.1a"><mo id="S2.p1.6.6.m1.1.1" movablelimits="false" xref="S2.p1.6.6.m1.1.1.cmml">𝙲𝙾𝚁𝙴</mo><annotation-xml encoding="MathML-Content" id="S2.p1.6.6.m1.1b"><ci id="S2.p1.6.6.m1.1.1.cmml" xref="S2.p1.6.6.m1.1.1">𝙲𝙾𝚁𝙴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.6.m1.1c">\mathop{\mathtt{CORE}}\limits</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.6.m1.1d">typewriter_CORE</annotation></semantics></math></span> <cite class="ltx_cite ltx_citemacro_cite">Jin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib20" title="">2023</a>)</cite> designs a CRS framework powered by large language models with user-friendly prompts and interactive feedback mechanisms.
<cite class="ltx_cite ltx_citemacro_citet">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib7" title="">2019</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Montazeralghaem et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib33" title="">2021</a>)</cite> build a tree-structured index with clustering algorithms to handle the large scale of items and attribute values in MCR.
<em class="ltx_emph ltx_font_italic" id="S2.p1.6.7">Different from these methods, <span class="ltx_ERROR undefined" id="S2.p1.6.7.1">\method</span>is able to iteratively improve its planning ability through self-training on demonstrations from MCTS, allowing for more informed and non-myopic conversation strategies.</em> Additional related works on reinforcement learning for CRS are available in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A2" title="Appendix B Additional Related Works ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Notations and Definitions</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.18">We denote <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">caligraphic_U</annotation></semantics></math> as the set of users, <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">caligraphic_V</annotation></semantics></math> as the set of items,
<math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">caligraphic_Y</annotation></semantics></math> as the set of attribute types (e.g., price range, star rating), and
<math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">caligraphic_P</annotation></semantics></math> as the set of attribute values (e.g., medium price range, five-star rating).
Each user <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><mrow id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">u</mi><mo id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><in id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1"></in><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝑢</ci><ci id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">italic_u ∈ caligraphic_U</annotation></semantics></math> has an interaction history (e.g., view, purchase) with a set of items <math alttext="\mathcal{V}(u)" class="ltx_Math" display="inline" id="S3.p1.6.m6.1"><semantics id="S3.p1.6.m6.1a"><mrow id="S3.p1.6.m6.1.2" xref="S3.p1.6.m6.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.6.m6.1.2.2" xref="S3.p1.6.m6.1.2.2.cmml">𝒱</mi><mo id="S3.p1.6.m6.1.2.1" xref="S3.p1.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.p1.6.m6.1.2.3.2" xref="S3.p1.6.m6.1.2.cmml"><mo id="S3.p1.6.m6.1.2.3.2.1" stretchy="false" xref="S3.p1.6.m6.1.2.cmml">(</mo><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">u</mi><mo id="S3.p1.6.m6.1.2.3.2.2" stretchy="false" xref="S3.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.2.cmml" xref="S3.p1.6.m6.1.2"><times id="S3.p1.6.m6.1.2.1.cmml" xref="S3.p1.6.m6.1.2.1"></times><ci id="S3.p1.6.m6.1.2.2.cmml" xref="S3.p1.6.m6.1.2.2">𝒱</ci><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\mathcal{V}(u)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.1d">caligraphic_V ( italic_u )</annotation></semantics></math>.
Each item <math alttext="v\in\mathcal{V}" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><mrow id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">v</mi><mo id="S3.p1.7.m7.1.1.1" xref="S3.p1.7.m7.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><in id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1"></in><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">𝑣</ci><ci id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">v\in\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">italic_v ∈ caligraphic_V</annotation></semantics></math> is associated with a set of attribute types <math alttext="\mathcal{Y}(v)" class="ltx_Math" display="inline" id="S3.p1.8.m8.1"><semantics id="S3.p1.8.m8.1a"><mrow id="S3.p1.8.m8.1.2" xref="S3.p1.8.m8.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.8.m8.1.2.2" xref="S3.p1.8.m8.1.2.2.cmml">𝒴</mi><mo id="S3.p1.8.m8.1.2.1" xref="S3.p1.8.m8.1.2.1.cmml">⁢</mo><mrow id="S3.p1.8.m8.1.2.3.2" xref="S3.p1.8.m8.1.2.cmml"><mo id="S3.p1.8.m8.1.2.3.2.1" stretchy="false" xref="S3.p1.8.m8.1.2.cmml">(</mo><mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">v</mi><mo id="S3.p1.8.m8.1.2.3.2.2" stretchy="false" xref="S3.p1.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.2.cmml" xref="S3.p1.8.m8.1.2"><times id="S3.p1.8.m8.1.2.1.cmml" xref="S3.p1.8.m8.1.2.1"></times><ci id="S3.p1.8.m8.1.2.2.cmml" xref="S3.p1.8.m8.1.2.2">𝒴</ci><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\mathcal{Y}(v)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.1d">caligraphic_Y ( italic_v )</annotation></semantics></math> and the corresponding set of attribute values <math alttext="\mathcal{P}(v)" class="ltx_Math" display="inline" id="S3.p1.9.m9.1"><semantics id="S3.p1.9.m9.1a"><mrow id="S3.p1.9.m9.1.2" xref="S3.p1.9.m9.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.9.m9.1.2.2" xref="S3.p1.9.m9.1.2.2.cmml">𝒫</mi><mo id="S3.p1.9.m9.1.2.1" xref="S3.p1.9.m9.1.2.1.cmml">⁢</mo><mrow id="S3.p1.9.m9.1.2.3.2" xref="S3.p1.9.m9.1.2.cmml"><mo id="S3.p1.9.m9.1.2.3.2.1" stretchy="false" xref="S3.p1.9.m9.1.2.cmml">(</mo><mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">v</mi><mo id="S3.p1.9.m9.1.2.3.2.2" stretchy="false" xref="S3.p1.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.2.cmml" xref="S3.p1.9.m9.1.2"><times id="S3.p1.9.m9.1.2.1.cmml" xref="S3.p1.9.m9.1.2.1"></times><ci id="S3.p1.9.m9.1.2.2.cmml" xref="S3.p1.9.m9.1.2.2">𝒫</ci><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">\mathcal{P}(v)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.9.m9.1d">caligraphic_P ( italic_v )</annotation></semantics></math>.
Each conversation is initialized by a user specifying preference on an attribute type <math alttext="y_{0}\in\mathcal{Y}" class="ltx_Math" display="inline" id="S3.p1.10.m10.1"><semantics id="S3.p1.10.m10.1a"><mrow id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml"><msub id="S3.p1.10.m10.1.1.2" xref="S3.p1.10.m10.1.1.2.cmml"><mi id="S3.p1.10.m10.1.1.2.2" xref="S3.p1.10.m10.1.1.2.2.cmml">y</mi><mn id="S3.p1.10.m10.1.1.2.3" xref="S3.p1.10.m10.1.1.2.3.cmml">0</mn></msub><mo id="S3.p1.10.m10.1.1.1" xref="S3.p1.10.m10.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.10.m10.1.1.3" xref="S3.p1.10.m10.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><apply id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1"><in id="S3.p1.10.m10.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1"></in><apply id="S3.p1.10.m10.1.1.2.cmml" xref="S3.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.2.1.cmml" xref="S3.p1.10.m10.1.1.2">subscript</csymbol><ci id="S3.p1.10.m10.1.1.2.2.cmml" xref="S3.p1.10.m10.1.1.2.2">𝑦</ci><cn id="S3.p1.10.m10.1.1.2.3.cmml" type="integer" xref="S3.p1.10.m10.1.1.2.3">0</cn></apply><ci id="S3.p1.10.m10.1.1.3.cmml" xref="S3.p1.10.m10.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">y_{0}\in\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.10.m10.1d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ caligraphic_Y</annotation></semantics></math> and its corresponding attribute value <math alttext="p_{0}\in\mathcal{P}" class="ltx_Math" display="inline" id="S3.p1.11.m11.1"><semantics id="S3.p1.11.m11.1a"><mrow id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml"><msub id="S3.p1.11.m11.1.1.2" xref="S3.p1.11.m11.1.1.2.cmml"><mi id="S3.p1.11.m11.1.1.2.2" xref="S3.p1.11.m11.1.1.2.2.cmml">p</mi><mn id="S3.p1.11.m11.1.1.2.3" xref="S3.p1.11.m11.1.1.2.3.cmml">0</mn></msub><mo id="S3.p1.11.m11.1.1.1" xref="S3.p1.11.m11.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.11.m11.1.1.3" xref="S3.p1.11.m11.1.1.3.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b"><apply id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1"><in id="S3.p1.11.m11.1.1.1.cmml" xref="S3.p1.11.m11.1.1.1"></in><apply id="S3.p1.11.m11.1.1.2.cmml" xref="S3.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.p1.11.m11.1.1.2.1.cmml" xref="S3.p1.11.m11.1.1.2">subscript</csymbol><ci id="S3.p1.11.m11.1.1.2.2.cmml" xref="S3.p1.11.m11.1.1.2.2">𝑝</ci><cn id="S3.p1.11.m11.1.1.2.3.cmml" type="integer" xref="S3.p1.11.m11.1.1.2.3">0</cn></apply><ci id="S3.p1.11.m11.1.1.3.cmml" xref="S3.p1.11.m11.1.1.3">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">p_{0}\in\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.11.m11.1d">italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ caligraphic_P</annotation></semantics></math> (e.g., the user says “I am looking for a place with medium price range.”).
At the <math alttext="t" class="ltx_Math" display="inline" id="S3.p1.12.m12.1"><semantics id="S3.p1.12.m12.1a"><mi id="S3.p1.12.m12.1.1" xref="S3.p1.12.m12.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.1b"><ci id="S3.p1.12.m12.1.1.cmml" xref="S3.p1.12.m12.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p1.12.m12.1d">italic_t</annotation></semantics></math>-th conversational turn, <span class="ltx_text" id="S3.p1.13.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S3.p1.13.1.m1.1"><semantics id="S3.p1.13.1.m1.1a"><mrow id="S3.p1.13.1.m1.1.1" xref="S3.p1.13.1.m1.1.1.cmml"><mi id="S3.p1.13.1.m1.1.1.2" xref="S3.p1.13.1.m1.1.1.2.cmml">𝚂</mi><mo id="S3.p1.13.1.m1.1.1.1" xref="S3.p1.13.1.m1.1.1.1.cmml">⁢</mo><mtext id="S3.p1.13.1.m1.1.1.3" xref="S3.p1.13.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.13.1.m1.1b"><apply id="S3.p1.13.1.m1.1.1.cmml" xref="S3.p1.13.1.m1.1.1"><times id="S3.p1.13.1.m1.1.1.1.cmml" xref="S3.p1.13.1.m1.1.1.1"></times><ci id="S3.p1.13.1.m1.1.1.2.cmml" xref="S3.p1.13.1.m1.1.1.2">𝚂</ci><ci id="S3.p1.13.1.m1.1.1.3a.cmml" xref="S3.p1.13.1.m1.1.1.3"><mtext id="S3.p1.13.1.m1.1.1.3.cmml" xref="S3.p1.13.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S3.p1.13.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> can either ask for preferences over attribute values from a set of candidate attribute values <math alttext="\mathcal{P}^{c}_{t}" class="ltx_Math" display="inline" id="S3.p1.14.m13.1"><semantics id="S3.p1.14.m13.1a"><msubsup id="S3.p1.14.m13.1.1" xref="S3.p1.14.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.14.m13.1.1.2.2" xref="S3.p1.14.m13.1.1.2.2.cmml">𝒫</mi><mi id="S3.p1.14.m13.1.1.3" xref="S3.p1.14.m13.1.1.3.cmml">t</mi><mi id="S3.p1.14.m13.1.1.2.3" xref="S3.p1.14.m13.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.14.m13.1b"><apply id="S3.p1.14.m13.1.1.cmml" xref="S3.p1.14.m13.1.1"><csymbol cd="ambiguous" id="S3.p1.14.m13.1.1.1.cmml" xref="S3.p1.14.m13.1.1">subscript</csymbol><apply id="S3.p1.14.m13.1.1.2.cmml" xref="S3.p1.14.m13.1.1"><csymbol cd="ambiguous" id="S3.p1.14.m13.1.1.2.1.cmml" xref="S3.p1.14.m13.1.1">superscript</csymbol><ci id="S3.p1.14.m13.1.1.2.2.cmml" xref="S3.p1.14.m13.1.1.2.2">𝒫</ci><ci id="S3.p1.14.m13.1.1.2.3.cmml" xref="S3.p1.14.m13.1.1.2.3">𝑐</ci></apply><ci id="S3.p1.14.m13.1.1.3.cmml" xref="S3.p1.14.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m13.1c">\mathcal{P}^{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.14.m13.1d">caligraphic_P start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, or recommend items from a set of candidate items <math alttext="\mathcal{V}^{c}_{t}" class="ltx_Math" display="inline" id="S3.p1.15.m14.1"><semantics id="S3.p1.15.m14.1a"><msubsup id="S3.p1.15.m14.1.1" xref="S3.p1.15.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.15.m14.1.1.2.2" xref="S3.p1.15.m14.1.1.2.2.cmml">𝒱</mi><mi id="S3.p1.15.m14.1.1.3" xref="S3.p1.15.m14.1.1.3.cmml">t</mi><mi id="S3.p1.15.m14.1.1.2.3" xref="S3.p1.15.m14.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.15.m14.1b"><apply id="S3.p1.15.m14.1.1.cmml" xref="S3.p1.15.m14.1.1"><csymbol cd="ambiguous" id="S3.p1.15.m14.1.1.1.cmml" xref="S3.p1.15.m14.1.1">subscript</csymbol><apply id="S3.p1.15.m14.1.1.2.cmml" xref="S3.p1.15.m14.1.1"><csymbol cd="ambiguous" id="S3.p1.15.m14.1.1.2.1.cmml" xref="S3.p1.15.m14.1.1">superscript</csymbol><ci id="S3.p1.15.m14.1.1.2.2.cmml" xref="S3.p1.15.m14.1.1.2.2">𝒱</ci><ci id="S3.p1.15.m14.1.1.2.3.cmml" xref="S3.p1.15.m14.1.1.2.3">𝑐</ci></apply><ci id="S3.p1.15.m14.1.1.3.cmml" xref="S3.p1.15.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m14.1c">\mathcal{V}^{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.15.m14.1d">caligraphic_V start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
Based on the user’s reply (accept or reject attribute values/items), <span class="ltx_text" id="S3.p1.16.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S3.p1.16.2.m1.1"><semantics id="S3.p1.16.2.m1.1a"><mrow id="S3.p1.16.2.m1.1.1" xref="S3.p1.16.2.m1.1.1.cmml"><mi id="S3.p1.16.2.m1.1.1.2" xref="S3.p1.16.2.m1.1.1.2.cmml">𝚂</mi><mo id="S3.p1.16.2.m1.1.1.1" xref="S3.p1.16.2.m1.1.1.1.cmml">⁢</mo><mtext id="S3.p1.16.2.m1.1.1.3" xref="S3.p1.16.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.16.2.m1.1b"><apply id="S3.p1.16.2.m1.1.1.cmml" xref="S3.p1.16.2.m1.1.1"><times id="S3.p1.16.2.m1.1.1.1.cmml" xref="S3.p1.16.2.m1.1.1.1"></times><ci id="S3.p1.16.2.m1.1.1.2.cmml" xref="S3.p1.16.2.m1.1.1.2">𝚂</ci><ci id="S3.p1.16.2.m1.1.1.3a.cmml" xref="S3.p1.16.2.m1.1.1.3"><mtext id="S3.p1.16.2.m1.1.1.3.cmml" xref="S3.p1.16.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S3.p1.16.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> repeatedly communicates with users until the user accepts at least one recommended item at turn <math alttext="T" class="ltx_Math" display="inline" id="S3.p1.17.m15.1"><semantics id="S3.p1.17.m15.1a"><mi id="S3.p1.17.m15.1.1" xref="S3.p1.17.m15.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p1.17.m15.1b"><ci id="S3.p1.17.m15.1.1.cmml" xref="S3.p1.17.m15.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.17.m15.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.p1.17.m15.1d">italic_T</annotation></semantics></math> (success), or the conversation reaches the maximum number of turns and terminates at <math alttext="T{=}T_{\text{max}}" class="ltx_Math" display="inline" id="S3.p1.18.m16.1"><semantics id="S3.p1.18.m16.1a"><mrow id="S3.p1.18.m16.1.1" xref="S3.p1.18.m16.1.1.cmml"><mi id="S3.p1.18.m16.1.1.2" xref="S3.p1.18.m16.1.1.2.cmml">T</mi><mo id="S3.p1.18.m16.1.1.1" xref="S3.p1.18.m16.1.1.1.cmml">=</mo><msub id="S3.p1.18.m16.1.1.3" xref="S3.p1.18.m16.1.1.3.cmml"><mi id="S3.p1.18.m16.1.1.3.2" xref="S3.p1.18.m16.1.1.3.2.cmml">T</mi><mtext id="S3.p1.18.m16.1.1.3.3" xref="S3.p1.18.m16.1.1.3.3a.cmml">max</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.18.m16.1b"><apply id="S3.p1.18.m16.1.1.cmml" xref="S3.p1.18.m16.1.1"><eq id="S3.p1.18.m16.1.1.1.cmml" xref="S3.p1.18.m16.1.1.1"></eq><ci id="S3.p1.18.m16.1.1.2.cmml" xref="S3.p1.18.m16.1.1.2">𝑇</ci><apply id="S3.p1.18.m16.1.1.3.cmml" xref="S3.p1.18.m16.1.1.3"><csymbol cd="ambiguous" id="S3.p1.18.m16.1.1.3.1.cmml" xref="S3.p1.18.m16.1.1.3">subscript</csymbol><ci id="S3.p1.18.m16.1.1.3.2.cmml" xref="S3.p1.18.m16.1.1.3.2">𝑇</ci><ci id="S3.p1.18.m16.1.1.3.3a.cmml" xref="S3.p1.18.m16.1.1.3.3"><mtext id="S3.p1.18.m16.1.1.3.3.cmml" mathsize="70%" xref="S3.p1.18.m16.1.1.3.3">max</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m16.1c">T{=}T_{\text{max}}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.18.m16.1d">italic_T = italic_T start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math> (fail).
The goal of MCR is to recommend at least one item that the user accepts, and complete the conversation in as few turns as possible to prevent the user from becoming impatient after too many turns.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.4">We introduce <span class="ltx_ERROR undefined" id="S4.p1.4.5">\method</span>, an MCTS-based MCR framework that achieves strategic and non-myopic conversational
planning.
<span class="ltx_ERROR undefined" id="S4.p1.4.6">\method</span>formulates MCR as an MDP with a hierarchical action selection process (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.SS1" title="4.1 MDP Formulation for MCR ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">4.1</span></a>).
A conversational agent (<span class="ltx_text" id="S4.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.p1.1.1.m1.1"><semantics id="S4.p1.1.1.m1.1a"><mrow id="S4.p1.1.1.m1.1.1" xref="S4.p1.1.1.m1.1.1.cmml"><mi id="S4.p1.1.1.m1.1.1.2" xref="S4.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.p1.1.1.m1.1.1.1" xref="S4.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.p1.1.1.m1.1.1.3" xref="S4.p1.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.1.m1.1b"><apply id="S4.p1.1.1.m1.1.1.cmml" xref="S4.p1.1.1.m1.1.1"><times id="S4.p1.1.1.m1.1.1.1.cmml" xref="S4.p1.1.1.m1.1.1.1"></times><ci id="S4.p1.1.1.m1.1.1.2.cmml" xref="S4.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.p1.1.1.m1.1.1.3a.cmml" xref="S4.p1.1.1.m1.1.1.3"><mtext id="S4.p1.1.1.m1.1.1.3.cmml" xref="S4.p1.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span>) observes the current state and decides the actions in each conversational turn (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.SS2" title='4.2 𝚂⁢"-agent" ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search'><span class="ltx_text ltx_ref_tag">4.2</span></a>), a conversational planner (<span class="ltx_text" id="S4.p1.2.2"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.p1.2.2.m1.1"><semantics id="S4.p1.2.2.m1.1a"><mrow id="S4.p1.2.2.m1.1.1" xref="S4.p1.2.2.m1.1.1.cmml"><mi id="S4.p1.2.2.m1.1.1.2" xref="S4.p1.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="S4.p1.2.2.m1.1.1.1" xref="S4.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S4.p1.2.2.m1.1.1.3" xref="S4.p1.2.2.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.2.m1.1b"><apply id="S4.p1.2.2.m1.1.1.cmml" xref="S4.p1.2.2.m1.1.1"><times id="S4.p1.2.2.m1.1.1.1.cmml" xref="S4.p1.2.2.m1.1.1.1"></times><ci id="S4.p1.2.2.m1.1.1.2.cmml" xref="S4.p1.2.2.m1.1.1.2">𝚂</ci><ci id="S4.p1.2.2.m1.1.1.3a.cmml" xref="S4.p1.2.2.m1.1.1.3"><mtext id="S4.p1.2.2.m1.1.1.3.cmml" xref="S4.p1.2.2.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.2.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.2.m1.1d">typewriter_S -planner</annotation></semantics></math></span>) leverages an MCTS-based algorithm to plan conversations (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.SS3" title='4.3 𝚂⁢"-planner" ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search'><span class="ltx_text ltx_ref_tag">4.3</span></a>), and <span class="ltx_text" id="S4.p1.3.3"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.p1.3.3.m1.1"><semantics id="S4.p1.3.3.m1.1a"><mrow id="S4.p1.3.3.m1.1.1" xref="S4.p1.3.3.m1.1.1.cmml"><mi id="S4.p1.3.3.m1.1.1.2" xref="S4.p1.3.3.m1.1.1.2.cmml">𝚂</mi><mo id="S4.p1.3.3.m1.1.1.1" xref="S4.p1.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="S4.p1.3.3.m1.1.1.3" xref="S4.p1.3.3.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.3.3.m1.1b"><apply id="S4.p1.3.3.m1.1.1.cmml" xref="S4.p1.3.3.m1.1.1"><times id="S4.p1.3.3.m1.1.1.1.cmml" xref="S4.p1.3.3.m1.1.1.1"></times><ci id="S4.p1.3.3.m1.1.1.2.cmml" xref="S4.p1.3.3.m1.1.1.2">𝚂</ci><ci id="S4.p1.3.3.m1.1.1.3a.cmml" xref="S4.p1.3.3.m1.1.1.3"><mtext id="S4.p1.3.3.m1.1.1.3.cmml" xref="S4.p1.3.3.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.3.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.p1.3.3.m1.1d">typewriter_S -agent</annotation></semantics></math></span> engages in a self-training loop with guidance from <span class="ltx_text" id="S4.p1.4.4"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.p1.4.4.m1.1"><semantics id="S4.p1.4.4.m1.1a"><mrow id="S4.p1.4.4.m1.1.1" xref="S4.p1.4.4.m1.1.1.cmml"><mi id="S4.p1.4.4.m1.1.1.2" xref="S4.p1.4.4.m1.1.1.2.cmml">𝚂</mi><mo id="S4.p1.4.4.m1.1.1.1" xref="S4.p1.4.4.m1.1.1.1.cmml">⁢</mo><mtext id="S4.p1.4.4.m1.1.1.3" xref="S4.p1.4.4.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.4.4.m1.1b"><apply id="S4.p1.4.4.m1.1.1.cmml" xref="S4.p1.4.4.m1.1.1"><times id="S4.p1.4.4.m1.1.1.1.cmml" xref="S4.p1.4.4.m1.1.1.1"></times><ci id="S4.p1.4.4.m1.1.1.2.cmml" xref="S4.p1.4.4.m1.1.1.2">𝚂</ci><ci id="S4.p1.4.4.m1.1.1.3a.cmml" xref="S4.p1.4.4.m1.1.1.3"><mtext id="S4.p1.4.4.m1.1.1.3.cmml" xref="S4.p1.4.4.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.4.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.p1.4.4.m1.1d">typewriter_S -planner</annotation></semantics></math></span> (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.SS4" title='4.4 Guiding 𝚂⁢"-agent" with 𝚂⁢"-planner" ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search'><span class="ltx_text ltx_ref_tag">4.4</span></a>).
An framework overview of <span class="ltx_ERROR undefined" id="S4.p1.4.7">\method</span>is in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.F2" title="Figure 2 ‣ State ‣ 4.1 MDP Formulation for MCR ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">2</span></a>
and the training algorithm is in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#alg1" title='Algorithm 1 ‣ 4.3 𝚂⁢"-planner" ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search'><span class="ltx_text ltx_ref_tag">1</span></a>. We summarize all the notations in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A1" title="Appendix A Table of Notations ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>MDP Formulation for MCR</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.16">We formulate MCR as an MDP where <span class="ltx_text" id="S4.SS1.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS1.p1.1.1.m1.1"><semantics id="S4.SS1.p1.1.1.m1.1a"><mrow id="S4.SS1.p1.1.1.m1.1.1" xref="S4.SS1.p1.1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.1.m1.1.1.2" xref="S4.SS1.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS1.p1.1.1.m1.1.1.1" xref="S4.SS1.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS1.p1.1.1.m1.1.1.3" xref="S4.SS1.p1.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.1.m1.1b"><apply id="S4.SS1.p1.1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.1.m1.1.1"><times id="S4.SS1.p1.1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.1.m1.1.1.1"></times><ci id="S4.SS1.p1.1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS1.p1.1.1.m1.1.1.3a.cmml" xref="S4.SS1.p1.1.1.m1.1.1.3"><mtext id="S4.SS1.p1.1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> can be trained in an RL environment to learn to plan conversations strategically.
For each user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m1.1"><semantics id="S4.SS1.p1.2.m1.1a"><mi id="S4.SS1.p1.2.m1.1.1" xref="S4.SS1.p1.2.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m1.1b"><ci id="S4.SS1.p1.2.m1.1.1.cmml" xref="S4.SS1.p1.2.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m1.1d">italic_u</annotation></semantics></math>, the MDP environment <math alttext="\mathcal{M}(u)" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m2.1"><semantics id="S4.SS1.p1.3.m2.1a"><mrow id="S4.SS1.p1.3.m2.1.2" xref="S4.SS1.p1.3.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.3.m2.1.2.2" xref="S4.SS1.p1.3.m2.1.2.2.cmml">ℳ</mi><mo id="S4.SS1.p1.3.m2.1.2.1" xref="S4.SS1.p1.3.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p1.3.m2.1.2.3.2" xref="S4.SS1.p1.3.m2.1.2.cmml"><mo id="S4.SS1.p1.3.m2.1.2.3.2.1" stretchy="false" xref="S4.SS1.p1.3.m2.1.2.cmml">(</mo><mi id="S4.SS1.p1.3.m2.1.1" xref="S4.SS1.p1.3.m2.1.1.cmml">u</mi><mo id="S4.SS1.p1.3.m2.1.2.3.2.2" stretchy="false" xref="S4.SS1.p1.3.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m2.1b"><apply id="S4.SS1.p1.3.m2.1.2.cmml" xref="S4.SS1.p1.3.m2.1.2"><times id="S4.SS1.p1.3.m2.1.2.1.cmml" xref="S4.SS1.p1.3.m2.1.2.1"></times><ci id="S4.SS1.p1.3.m2.1.2.2.cmml" xref="S4.SS1.p1.3.m2.1.2.2">ℳ</ci><ci id="S4.SS1.p1.3.m2.1.1.cmml" xref="S4.SS1.p1.3.m2.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m2.1c">\mathcal{M}(u)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m2.1d">caligraphic_M ( italic_u )</annotation></semantics></math> is defined as a quintuple
<math alttext="\mathcal{M}(u)=\{\mathcal{S},\mathcal{A},\mathcal{T},\mathcal{R},\gamma\}_{u}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m3.6"><semantics id="S4.SS1.p1.4.m3.6a"><mrow id="S4.SS1.p1.4.m3.6.7" xref="S4.SS1.p1.4.m3.6.7.cmml"><mrow id="S4.SS1.p1.4.m3.6.7.2" xref="S4.SS1.p1.4.m3.6.7.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m3.6.7.2.2" xref="S4.SS1.p1.4.m3.6.7.2.2.cmml">ℳ</mi><mo id="S4.SS1.p1.4.m3.6.7.2.1" xref="S4.SS1.p1.4.m3.6.7.2.1.cmml">⁢</mo><mrow id="S4.SS1.p1.4.m3.6.7.2.3.2" xref="S4.SS1.p1.4.m3.6.7.2.cmml"><mo id="S4.SS1.p1.4.m3.6.7.2.3.2.1" stretchy="false" xref="S4.SS1.p1.4.m3.6.7.2.cmml">(</mo><mi id="S4.SS1.p1.4.m3.1.1" xref="S4.SS1.p1.4.m3.1.1.cmml">u</mi><mo id="S4.SS1.p1.4.m3.6.7.2.3.2.2" stretchy="false" xref="S4.SS1.p1.4.m3.6.7.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.4.m3.6.7.1" xref="S4.SS1.p1.4.m3.6.7.1.cmml">=</mo><msub id="S4.SS1.p1.4.m3.6.7.3" xref="S4.SS1.p1.4.m3.6.7.3.cmml"><mrow id="S4.SS1.p1.4.m3.6.7.3.2.2" xref="S4.SS1.p1.4.m3.6.7.3.2.1.cmml"><mo id="S4.SS1.p1.4.m3.6.7.3.2.2.1" stretchy="false" xref="S4.SS1.p1.4.m3.6.7.3.2.1.cmml">{</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m3.2.2" xref="S4.SS1.p1.4.m3.2.2.cmml">𝒮</mi><mo id="S4.SS1.p1.4.m3.6.7.3.2.2.2" xref="S4.SS1.p1.4.m3.6.7.3.2.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m3.3.3" xref="S4.SS1.p1.4.m3.3.3.cmml">𝒜</mi><mo id="S4.SS1.p1.4.m3.6.7.3.2.2.3" xref="S4.SS1.p1.4.m3.6.7.3.2.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m3.4.4" xref="S4.SS1.p1.4.m3.4.4.cmml">𝒯</mi><mo id="S4.SS1.p1.4.m3.6.7.3.2.2.4" xref="S4.SS1.p1.4.m3.6.7.3.2.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m3.5.5" xref="S4.SS1.p1.4.m3.5.5.cmml">ℛ</mi><mo id="S4.SS1.p1.4.m3.6.7.3.2.2.5" xref="S4.SS1.p1.4.m3.6.7.3.2.1.cmml">,</mo><mi id="S4.SS1.p1.4.m3.6.6" xref="S4.SS1.p1.4.m3.6.6.cmml">γ</mi><mo id="S4.SS1.p1.4.m3.6.7.3.2.2.6" stretchy="false" xref="S4.SS1.p1.4.m3.6.7.3.2.1.cmml">}</mo></mrow><mi id="S4.SS1.p1.4.m3.6.7.3.3" xref="S4.SS1.p1.4.m3.6.7.3.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m3.6b"><apply id="S4.SS1.p1.4.m3.6.7.cmml" xref="S4.SS1.p1.4.m3.6.7"><eq id="S4.SS1.p1.4.m3.6.7.1.cmml" xref="S4.SS1.p1.4.m3.6.7.1"></eq><apply id="S4.SS1.p1.4.m3.6.7.2.cmml" xref="S4.SS1.p1.4.m3.6.7.2"><times id="S4.SS1.p1.4.m3.6.7.2.1.cmml" xref="S4.SS1.p1.4.m3.6.7.2.1"></times><ci id="S4.SS1.p1.4.m3.6.7.2.2.cmml" xref="S4.SS1.p1.4.m3.6.7.2.2">ℳ</ci><ci id="S4.SS1.p1.4.m3.1.1.cmml" xref="S4.SS1.p1.4.m3.1.1">𝑢</ci></apply><apply id="S4.SS1.p1.4.m3.6.7.3.cmml" xref="S4.SS1.p1.4.m3.6.7.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m3.6.7.3.1.cmml" xref="S4.SS1.p1.4.m3.6.7.3">subscript</csymbol><set id="S4.SS1.p1.4.m3.6.7.3.2.1.cmml" xref="S4.SS1.p1.4.m3.6.7.3.2.2"><ci id="S4.SS1.p1.4.m3.2.2.cmml" xref="S4.SS1.p1.4.m3.2.2">𝒮</ci><ci id="S4.SS1.p1.4.m3.3.3.cmml" xref="S4.SS1.p1.4.m3.3.3">𝒜</ci><ci id="S4.SS1.p1.4.m3.4.4.cmml" xref="S4.SS1.p1.4.m3.4.4">𝒯</ci><ci id="S4.SS1.p1.4.m3.5.5.cmml" xref="S4.SS1.p1.4.m3.5.5">ℛ</ci><ci id="S4.SS1.p1.4.m3.6.6.cmml" xref="S4.SS1.p1.4.m3.6.6">𝛾</ci></set><ci id="S4.SS1.p1.4.m3.6.7.3.3.cmml" xref="S4.SS1.p1.4.m3.6.7.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m3.6c">\mathcal{M}(u)=\{\mathcal{S},\mathcal{A},\mathcal{T},\mathcal{R},\gamma\}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m3.6d">caligraphic_M ( italic_u ) = { caligraphic_S , caligraphic_A , caligraphic_T , caligraphic_R , italic_γ } start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>
(index <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m4.1"><semantics id="S4.SS1.p1.5.m4.1a"><mi id="S4.SS1.p1.5.m4.1.1" xref="S4.SS1.p1.5.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m4.1b"><ci id="S4.SS1.p1.5.m4.1.1.cmml" xref="S4.SS1.p1.5.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m4.1d">italic_u</annotation></semantics></math> is dropped when no ambiguity arises), where <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m5.1"><semantics id="S4.SS1.p1.6.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m5.1.1" xref="S4.SS1.p1.6.m5.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m5.1b"><ci id="S4.SS1.p1.6.m5.1.1.cmml" xref="S4.SS1.p1.6.m5.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m5.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m5.1d">caligraphic_S</annotation></semantics></math> denotes the state space, which summarizes all the information about the conversation and the user; <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m6.1"><semantics id="S4.SS1.p1.7.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.7.m6.1.1" xref="S4.SS1.p1.7.m6.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m6.1b"><ci id="S4.SS1.p1.7.m6.1.1.cmml" xref="S4.SS1.p1.7.m6.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m6.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m6.1d">caligraphic_A</annotation></semantics></math> denotes the action space, which includes asking (<math alttext="\mathtt{ask}" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m7.1"><semantics id="S4.SS1.p1.8.m7.1a"><mi id="S4.SS1.p1.8.m7.1.1" xref="S4.SS1.p1.8.m7.1.1.cmml">𝚊𝚜𝚔</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m7.1b"><ci id="S4.SS1.p1.8.m7.1.1.cmml" xref="S4.SS1.p1.8.m7.1.1">𝚊𝚜𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m7.1c">\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m7.1d">typewriter_ask</annotation></semantics></math>) for specific attribute types and their respective values, or recommending (<math alttext="\mathtt{rec}" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m8.1"><semantics id="S4.SS1.p1.9.m8.1a"><mi id="S4.SS1.p1.9.m8.1.1" xref="S4.SS1.p1.9.m8.1.1.cmml">𝚛𝚎𝚌</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m8.1b"><ci id="S4.SS1.p1.9.m8.1.1.cmml" xref="S4.SS1.p1.9.m8.1.1">𝚛𝚎𝚌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m8.1c">\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.9.m8.1d">typewriter_rec</annotation></semantics></math>) specific items;
<math alttext="\mathcal{T}:\mathcal{S}\times\mathcal{A}\rightarrow\mathcal{S}" class="ltx_Math" display="inline" id="S4.SS1.p1.10.m9.1"><semantics id="S4.SS1.p1.10.m9.1a"><mrow id="S4.SS1.p1.10.m9.1.1" xref="S4.SS1.p1.10.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.10.m9.1.1.2" xref="S4.SS1.p1.10.m9.1.1.2.cmml">𝒯</mi><mo id="S4.SS1.p1.10.m9.1.1.1" lspace="0.278em" rspace="0.278em" xref="S4.SS1.p1.10.m9.1.1.1.cmml">:</mo><mrow id="S4.SS1.p1.10.m9.1.1.3" xref="S4.SS1.p1.10.m9.1.1.3.cmml"><mrow id="S4.SS1.p1.10.m9.1.1.3.2" xref="S4.SS1.p1.10.m9.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.10.m9.1.1.3.2.2" xref="S4.SS1.p1.10.m9.1.1.3.2.2.cmml">𝒮</mi><mo id="S4.SS1.p1.10.m9.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.10.m9.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.10.m9.1.1.3.2.3" xref="S4.SS1.p1.10.m9.1.1.3.2.3.cmml">𝒜</mi></mrow><mo id="S4.SS1.p1.10.m9.1.1.3.1" stretchy="false" xref="S4.SS1.p1.10.m9.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.10.m9.1.1.3.3" xref="S4.SS1.p1.10.m9.1.1.3.3.cmml">𝒮</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m9.1b"><apply id="S4.SS1.p1.10.m9.1.1.cmml" xref="S4.SS1.p1.10.m9.1.1"><ci id="S4.SS1.p1.10.m9.1.1.1.cmml" xref="S4.SS1.p1.10.m9.1.1.1">:</ci><ci id="S4.SS1.p1.10.m9.1.1.2.cmml" xref="S4.SS1.p1.10.m9.1.1.2">𝒯</ci><apply id="S4.SS1.p1.10.m9.1.1.3.cmml" xref="S4.SS1.p1.10.m9.1.1.3"><ci id="S4.SS1.p1.10.m9.1.1.3.1.cmml" xref="S4.SS1.p1.10.m9.1.1.3.1">→</ci><apply id="S4.SS1.p1.10.m9.1.1.3.2.cmml" xref="S4.SS1.p1.10.m9.1.1.3.2"><times id="S4.SS1.p1.10.m9.1.1.3.2.1.cmml" xref="S4.SS1.p1.10.m9.1.1.3.2.1"></times><ci id="S4.SS1.p1.10.m9.1.1.3.2.2.cmml" xref="S4.SS1.p1.10.m9.1.1.3.2.2">𝒮</ci><ci id="S4.SS1.p1.10.m9.1.1.3.2.3.cmml" xref="S4.SS1.p1.10.m9.1.1.3.2.3">𝒜</ci></apply><ci id="S4.SS1.p1.10.m9.1.1.3.3.cmml" xref="S4.SS1.p1.10.m9.1.1.3.3">𝒮</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m9.1c">\mathcal{T}:\mathcal{S}\times\mathcal{A}\rightarrow\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.10.m9.1d">caligraphic_T : caligraphic_S × caligraphic_A → caligraphic_S</annotation></semantics></math> denotes the transition to the next state after taking an action from the current state; <math alttext="\mathcal{R}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S4.SS1.p1.11.m10.1"><semantics id="S4.SS1.p1.11.m10.1a"><mrow id="S4.SS1.p1.11.m10.1.1" xref="S4.SS1.p1.11.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.11.m10.1.1.2" xref="S4.SS1.p1.11.m10.1.1.2.cmml">ℛ</mi><mo id="S4.SS1.p1.11.m10.1.1.1" lspace="0.278em" rspace="0.278em" xref="S4.SS1.p1.11.m10.1.1.1.cmml">:</mo><mrow id="S4.SS1.p1.11.m10.1.1.3" xref="S4.SS1.p1.11.m10.1.1.3.cmml"><mrow id="S4.SS1.p1.11.m10.1.1.3.2" xref="S4.SS1.p1.11.m10.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.11.m10.1.1.3.2.2" xref="S4.SS1.p1.11.m10.1.1.3.2.2.cmml">𝒮</mi><mo id="S4.SS1.p1.11.m10.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.11.m10.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.11.m10.1.1.3.2.3" xref="S4.SS1.p1.11.m10.1.1.3.2.3.cmml">𝒜</mi></mrow><mo id="S4.SS1.p1.11.m10.1.1.3.1" stretchy="false" xref="S4.SS1.p1.11.m10.1.1.3.1.cmml">→</mo><mi id="S4.SS1.p1.11.m10.1.1.3.3" xref="S4.SS1.p1.11.m10.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m10.1b"><apply id="S4.SS1.p1.11.m10.1.1.cmml" xref="S4.SS1.p1.11.m10.1.1"><ci id="S4.SS1.p1.11.m10.1.1.1.cmml" xref="S4.SS1.p1.11.m10.1.1.1">:</ci><ci id="S4.SS1.p1.11.m10.1.1.2.cmml" xref="S4.SS1.p1.11.m10.1.1.2">ℛ</ci><apply id="S4.SS1.p1.11.m10.1.1.3.cmml" xref="S4.SS1.p1.11.m10.1.1.3"><ci id="S4.SS1.p1.11.m10.1.1.3.1.cmml" xref="S4.SS1.p1.11.m10.1.1.3.1">→</ci><apply id="S4.SS1.p1.11.m10.1.1.3.2.cmml" xref="S4.SS1.p1.11.m10.1.1.3.2"><times id="S4.SS1.p1.11.m10.1.1.3.2.1.cmml" xref="S4.SS1.p1.11.m10.1.1.3.2.1"></times><ci id="S4.SS1.p1.11.m10.1.1.3.2.2.cmml" xref="S4.SS1.p1.11.m10.1.1.3.2.2">𝒮</ci><ci id="S4.SS1.p1.11.m10.1.1.3.2.3.cmml" xref="S4.SS1.p1.11.m10.1.1.3.2.3">𝒜</ci></apply><ci id="S4.SS1.p1.11.m10.1.1.3.3.cmml" xref="S4.SS1.p1.11.m10.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m10.1c">\mathcal{R}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.11.m10.1d">caligraphic_R : caligraphic_S × caligraphic_A → blackboard_R</annotation></semantics></math> denotes the immediate reward function after taking an action at the current state; and <math alttext="\gamma\in(0,1)" class="ltx_Math" display="inline" id="S4.SS1.p1.12.m11.2"><semantics id="S4.SS1.p1.12.m11.2a"><mrow id="S4.SS1.p1.12.m11.2.3" xref="S4.SS1.p1.12.m11.2.3.cmml"><mi id="S4.SS1.p1.12.m11.2.3.2" xref="S4.SS1.p1.12.m11.2.3.2.cmml">γ</mi><mo id="S4.SS1.p1.12.m11.2.3.1" xref="S4.SS1.p1.12.m11.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p1.12.m11.2.3.3.2" xref="S4.SS1.p1.12.m11.2.3.3.1.cmml"><mo id="S4.SS1.p1.12.m11.2.3.3.2.1" stretchy="false" xref="S4.SS1.p1.12.m11.2.3.3.1.cmml">(</mo><mn id="S4.SS1.p1.12.m11.1.1" xref="S4.SS1.p1.12.m11.1.1.cmml">0</mn><mo id="S4.SS1.p1.12.m11.2.3.3.2.2" xref="S4.SS1.p1.12.m11.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p1.12.m11.2.2" xref="S4.SS1.p1.12.m11.2.2.cmml">1</mn><mo id="S4.SS1.p1.12.m11.2.3.3.2.3" stretchy="false" xref="S4.SS1.p1.12.m11.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m11.2b"><apply id="S4.SS1.p1.12.m11.2.3.cmml" xref="S4.SS1.p1.12.m11.2.3"><in id="S4.SS1.p1.12.m11.2.3.1.cmml" xref="S4.SS1.p1.12.m11.2.3.1"></in><ci id="S4.SS1.p1.12.m11.2.3.2.cmml" xref="S4.SS1.p1.12.m11.2.3.2">𝛾</ci><interval closure="open" id="S4.SS1.p1.12.m11.2.3.3.1.cmml" xref="S4.SS1.p1.12.m11.2.3.3.2"><cn id="S4.SS1.p1.12.m11.1.1.cmml" type="integer" xref="S4.SS1.p1.12.m11.1.1">0</cn><cn id="S4.SS1.p1.12.m11.2.2.cmml" type="integer" xref="S4.SS1.p1.12.m11.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m11.2c">\gamma\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.12.m11.2d">italic_γ ∈ ( 0 , 1 )</annotation></semantics></math> denotes the discount factor.
For hierarchical action selection <cite class="ltx_cite ltx_citemacro_cite">Nachum et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib34" title="">2018</a>)</cite>,
<span class="ltx_text" id="S4.SS1.p1.13.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS1.p1.13.2.m1.1"><semantics id="S4.SS1.p1.13.2.m1.1a"><mrow id="S4.SS1.p1.13.2.m1.1.1" xref="S4.SS1.p1.13.2.m1.1.1.cmml"><mi id="S4.SS1.p1.13.2.m1.1.1.2" xref="S4.SS1.p1.13.2.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS1.p1.13.2.m1.1.1.1" xref="S4.SS1.p1.13.2.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS1.p1.13.2.m1.1.1.3" xref="S4.SS1.p1.13.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.2.m1.1b"><apply id="S4.SS1.p1.13.2.m1.1.1.cmml" xref="S4.SS1.p1.13.2.m1.1.1"><times id="S4.SS1.p1.13.2.m1.1.1.1.cmml" xref="S4.SS1.p1.13.2.m1.1.1.1"></times><ci id="S4.SS1.p1.13.2.m1.1.1.2.cmml" xref="S4.SS1.p1.13.2.m1.1.1.2">𝚂</ci><ci id="S4.SS1.p1.13.2.m1.1.1.3a.cmml" xref="S4.SS1.p1.13.2.m1.1.1.3"><mtext id="S4.SS1.p1.13.2.m1.1.1.3.cmml" xref="S4.SS1.p1.13.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.13.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> first chooses an action type <math alttext="o_{t}\in\{\mathtt{ask},\mathtt{rec}\}" class="ltx_Math" display="inline" id="S4.SS1.p1.14.m12.2"><semantics id="S4.SS1.p1.14.m12.2a"><mrow id="S4.SS1.p1.14.m12.2.3" xref="S4.SS1.p1.14.m12.2.3.cmml"><msub id="S4.SS1.p1.14.m12.2.3.2" xref="S4.SS1.p1.14.m12.2.3.2.cmml"><mi id="S4.SS1.p1.14.m12.2.3.2.2" xref="S4.SS1.p1.14.m12.2.3.2.2.cmml">o</mi><mi id="S4.SS1.p1.14.m12.2.3.2.3" xref="S4.SS1.p1.14.m12.2.3.2.3.cmml">t</mi></msub><mo id="S4.SS1.p1.14.m12.2.3.1" xref="S4.SS1.p1.14.m12.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p1.14.m12.2.3.3.2" xref="S4.SS1.p1.14.m12.2.3.3.1.cmml"><mo id="S4.SS1.p1.14.m12.2.3.3.2.1" stretchy="false" xref="S4.SS1.p1.14.m12.2.3.3.1.cmml">{</mo><mi id="S4.SS1.p1.14.m12.1.1" xref="S4.SS1.p1.14.m12.1.1.cmml">𝚊𝚜𝚔</mi><mo id="S4.SS1.p1.14.m12.2.3.3.2.2" xref="S4.SS1.p1.14.m12.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p1.14.m12.2.2" xref="S4.SS1.p1.14.m12.2.2.cmml">𝚛𝚎𝚌</mi><mo id="S4.SS1.p1.14.m12.2.3.3.2.3" stretchy="false" xref="S4.SS1.p1.14.m12.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m12.2b"><apply id="S4.SS1.p1.14.m12.2.3.cmml" xref="S4.SS1.p1.14.m12.2.3"><in id="S4.SS1.p1.14.m12.2.3.1.cmml" xref="S4.SS1.p1.14.m12.2.3.1"></in><apply id="S4.SS1.p1.14.m12.2.3.2.cmml" xref="S4.SS1.p1.14.m12.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m12.2.3.2.1.cmml" xref="S4.SS1.p1.14.m12.2.3.2">subscript</csymbol><ci id="S4.SS1.p1.14.m12.2.3.2.2.cmml" xref="S4.SS1.p1.14.m12.2.3.2.2">𝑜</ci><ci id="S4.SS1.p1.14.m12.2.3.2.3.cmml" xref="S4.SS1.p1.14.m12.2.3.2.3">𝑡</ci></apply><set id="S4.SS1.p1.14.m12.2.3.3.1.cmml" xref="S4.SS1.p1.14.m12.2.3.3.2"><ci id="S4.SS1.p1.14.m12.1.1.cmml" xref="S4.SS1.p1.14.m12.1.1">𝚊𝚜𝚔</ci><ci id="S4.SS1.p1.14.m12.2.2.cmml" xref="S4.SS1.p1.14.m12.2.2">𝚛𝚎𝚌</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m12.2c">o_{t}\in\{\mathtt{ask},\mathtt{rec}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.14.m12.2d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ { typewriter_ask , typewriter_rec }</annotation></semantics></math> at each conversational turn, indexed by <math alttext="t" class="ltx_Math" display="inline" id="S4.SS1.p1.15.m13.1"><semantics id="S4.SS1.p1.15.m13.1a"><mi id="S4.SS1.p1.15.m13.1.1" xref="S4.SS1.p1.15.m13.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.15.m13.1b"><ci id="S4.SS1.p1.15.m13.1.1.cmml" xref="S4.SS1.p1.15.m13.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.15.m13.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.15.m13.1d">italic_t</annotation></semantics></math>,
then chooses the objective of that action type. In summary, the MDP environment provides information about the current state for <span class="ltx_text" id="S4.SS1.p1.16.3"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS1.p1.16.3.m1.1"><semantics id="S4.SS1.p1.16.3.m1.1a"><mrow id="S4.SS1.p1.16.3.m1.1.1" xref="S4.SS1.p1.16.3.m1.1.1.cmml"><mi id="S4.SS1.p1.16.3.m1.1.1.2" xref="S4.SS1.p1.16.3.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS1.p1.16.3.m1.1.1.1" xref="S4.SS1.p1.16.3.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS1.p1.16.3.m1.1.1.3" xref="S4.SS1.p1.16.3.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.16.3.m1.1b"><apply id="S4.SS1.p1.16.3.m1.1.1.cmml" xref="S4.SS1.p1.16.3.m1.1.1"><times id="S4.SS1.p1.16.3.m1.1.1.1.cmml" xref="S4.SS1.p1.16.3.m1.1.1.1"></times><ci id="S4.SS1.p1.16.3.m1.1.1.2.cmml" xref="S4.SS1.p1.16.3.m1.1.1.2">𝚂</ci><ci id="S4.SS1.p1.16.3.m1.1.1.3a.cmml" xref="S4.SS1.p1.16.3.m1.1.1.3"><mtext id="S4.SS1.p1.16.3.m1.1.1.3.cmml" xref="S4.SS1.p1.16.3.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.16.3.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.16.3.m1.1d">typewriter_S -agent</annotation></semantics></math></span>, and trains it to maximize the reward by optimizing its action strategy.</p>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">State</h4>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="161" id="S4.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_ERROR undefined" id="S4.F2.16.8">\method</span>consists of a conversational agent (<span class="ltx_text" id="S4.F2.8.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.F2.8.1.m1.1"><semantics id="S4.F2.8.1.m1.1b"><mrow id="S4.F2.8.1.m1.1.1" xref="S4.F2.8.1.m1.1.1.cmml"><mi id="S4.F2.8.1.m1.1.1.2" xref="S4.F2.8.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.F2.8.1.m1.1.1.1" xref="S4.F2.8.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.F2.8.1.m1.1.1.3" xref="S4.F2.8.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.8.1.m1.1c"><apply id="S4.F2.8.1.m1.1.1.cmml" xref="S4.F2.8.1.m1.1.1"><times id="S4.F2.8.1.m1.1.1.1.cmml" xref="S4.F2.8.1.m1.1.1.1"></times><ci id="S4.F2.8.1.m1.1.1.2.cmml" xref="S4.F2.8.1.m1.1.1.2">𝚂</ci><ci id="S4.F2.8.1.m1.1.1.3a.cmml" xref="S4.F2.8.1.m1.1.1.3"><mtext id="S4.F2.8.1.m1.1.1.3.cmml" xref="S4.F2.8.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.8.1.m1.1d">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.F2.8.1.m1.1e">typewriter_S -agent</annotation></semantics></math></span>) and a conversational planner (<span class="ltx_text" id="S4.F2.9.2"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.F2.9.2.m1.1"><semantics id="S4.F2.9.2.m1.1b"><mrow id="S4.F2.9.2.m1.1.1" xref="S4.F2.9.2.m1.1.1.cmml"><mi id="S4.F2.9.2.m1.1.1.2" xref="S4.F2.9.2.m1.1.1.2.cmml">𝚂</mi><mo id="S4.F2.9.2.m1.1.1.1" xref="S4.F2.9.2.m1.1.1.1.cmml">⁢</mo><mtext id="S4.F2.9.2.m1.1.1.3" xref="S4.F2.9.2.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.9.2.m1.1c"><apply id="S4.F2.9.2.m1.1.1.cmml" xref="S4.F2.9.2.m1.1.1"><times id="S4.F2.9.2.m1.1.1.1.cmml" xref="S4.F2.9.2.m1.1.1.1"></times><ci id="S4.F2.9.2.m1.1.1.2.cmml" xref="S4.F2.9.2.m1.1.1.2">𝚂</ci><ci id="S4.F2.9.2.m1.1.1.3a.cmml" xref="S4.F2.9.2.m1.1.1.3"><mtext id="S4.F2.9.2.m1.1.1.3.cmml" xref="S4.F2.9.2.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.9.2.m1.1d">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.F2.9.2.m1.1e">typewriter_S -planner</annotation></semantics></math></span>). <span class="ltx_text" id="S4.F2.10.3"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.F2.10.3.m1.1"><semantics id="S4.F2.10.3.m1.1b"><mrow id="S4.F2.10.3.m1.1.1" xref="S4.F2.10.3.m1.1.1.cmml"><mi id="S4.F2.10.3.m1.1.1.2" xref="S4.F2.10.3.m1.1.1.2.cmml">𝚂</mi><mo id="S4.F2.10.3.m1.1.1.1" xref="S4.F2.10.3.m1.1.1.1.cmml">⁢</mo><mtext id="S4.F2.10.3.m1.1.1.3" xref="S4.F2.10.3.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.10.3.m1.1c"><apply id="S4.F2.10.3.m1.1.1.cmml" xref="S4.F2.10.3.m1.1.1"><times id="S4.F2.10.3.m1.1.1.1.cmml" xref="S4.F2.10.3.m1.1.1.1"></times><ci id="S4.F2.10.3.m1.1.1.2.cmml" xref="S4.F2.10.3.m1.1.1.2">𝚂</ci><ci id="S4.F2.10.3.m1.1.1.3a.cmml" xref="S4.F2.10.3.m1.1.1.3"><mtext id="S4.F2.10.3.m1.1.1.3.cmml" xref="S4.F2.10.3.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.10.3.m1.1d">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.F2.10.3.m1.1e">typewriter_S -planner</annotation></semantics></math></span> leverages MCTS to perform non-myopic conversational planning based on the heuristics from <span class="ltx_text" id="S4.F2.11.4"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.F2.11.4.m1.1"><semantics id="S4.F2.11.4.m1.1b"><mrow id="S4.F2.11.4.m1.1.1" xref="S4.F2.11.4.m1.1.1.cmml"><mi id="S4.F2.11.4.m1.1.1.2" xref="S4.F2.11.4.m1.1.1.2.cmml">𝚂</mi><mo id="S4.F2.11.4.m1.1.1.1" xref="S4.F2.11.4.m1.1.1.1.cmml">⁢</mo><mtext id="S4.F2.11.4.m1.1.1.3" xref="S4.F2.11.4.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.11.4.m1.1c"><apply id="S4.F2.11.4.m1.1.1.cmml" xref="S4.F2.11.4.m1.1.1"><times id="S4.F2.11.4.m1.1.1.1.cmml" xref="S4.F2.11.4.m1.1.1.1"></times><ci id="S4.F2.11.4.m1.1.1.2.cmml" xref="S4.F2.11.4.m1.1.1.2">𝚂</ci><ci id="S4.F2.11.4.m1.1.1.3a.cmml" xref="S4.F2.11.4.m1.1.1.3"><mtext id="S4.F2.11.4.m1.1.1.3.cmml" xref="S4.F2.11.4.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.11.4.m1.1d">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.F2.11.4.m1.1e">typewriter_S -agent</annotation></semantics></math></span>. The best conversation plans found by <span class="ltx_text" id="S4.F2.12.5"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.F2.12.5.m1.1"><semantics id="S4.F2.12.5.m1.1b"><mrow id="S4.F2.12.5.m1.1.1" xref="S4.F2.12.5.m1.1.1.cmml"><mi id="S4.F2.12.5.m1.1.1.2" xref="S4.F2.12.5.m1.1.1.2.cmml">𝚂</mi><mo id="S4.F2.12.5.m1.1.1.1" xref="S4.F2.12.5.m1.1.1.1.cmml">⁢</mo><mtext id="S4.F2.12.5.m1.1.1.3" xref="S4.F2.12.5.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.12.5.m1.1c"><apply id="S4.F2.12.5.m1.1.1.cmml" xref="S4.F2.12.5.m1.1.1"><times id="S4.F2.12.5.m1.1.1.1.cmml" xref="S4.F2.12.5.m1.1.1.1"></times><ci id="S4.F2.12.5.m1.1.1.2.cmml" xref="S4.F2.12.5.m1.1.1.2">𝚂</ci><ci id="S4.F2.12.5.m1.1.1.3a.cmml" xref="S4.F2.12.5.m1.1.1.3"><mtext id="S4.F2.12.5.m1.1.1.3.cmml" xref="S4.F2.12.5.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.12.5.m1.1d">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.F2.12.5.m1.1e">typewriter_S -planner</annotation></semantics></math></span> are used to guide the training of <span class="ltx_text" id="S4.F2.13.6"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.F2.13.6.m1.1"><semantics id="S4.F2.13.6.m1.1b"><mrow id="S4.F2.13.6.m1.1.1" xref="S4.F2.13.6.m1.1.1.cmml"><mi id="S4.F2.13.6.m1.1.1.2" xref="S4.F2.13.6.m1.1.1.2.cmml">𝚂</mi><mo id="S4.F2.13.6.m1.1.1.1" xref="S4.F2.13.6.m1.1.1.1.cmml">⁢</mo><mtext id="S4.F2.13.6.m1.1.1.3" xref="S4.F2.13.6.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.13.6.m1.1c"><apply id="S4.F2.13.6.m1.1.1.cmml" xref="S4.F2.13.6.m1.1.1"><times id="S4.F2.13.6.m1.1.1.1.cmml" xref="S4.F2.13.6.m1.1.1.1"></times><ci id="S4.F2.13.6.m1.1.1.2.cmml" xref="S4.F2.13.6.m1.1.1.2">𝚂</ci><ci id="S4.F2.13.6.m1.1.1.3a.cmml" xref="S4.F2.13.6.m1.1.1.3"><mtext id="S4.F2.13.6.m1.1.1.3.cmml" xref="S4.F2.13.6.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.13.6.m1.1d">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.F2.13.6.m1.1e">typewriter_S -agent</annotation></semantics></math></span>, enabling <span class="ltx_text" id="S4.F2.14.7"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.F2.14.7.m1.1"><semantics id="S4.F2.14.7.m1.1b"><mrow id="S4.F2.14.7.m1.1.1" xref="S4.F2.14.7.m1.1.1.cmml"><mi id="S4.F2.14.7.m1.1.1.2" xref="S4.F2.14.7.m1.1.1.2.cmml">𝚂</mi><mo id="S4.F2.14.7.m1.1.1.1" xref="S4.F2.14.7.m1.1.1.1.cmml">⁢</mo><mtext id="S4.F2.14.7.m1.1.1.3" xref="S4.F2.14.7.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.14.7.m1.1c"><apply id="S4.F2.14.7.m1.1.1.cmml" xref="S4.F2.14.7.m1.1.1"><times id="S4.F2.14.7.m1.1.1.1.cmml" xref="S4.F2.14.7.m1.1.1.1"></times><ci id="S4.F2.14.7.m1.1.1.2.cmml" xref="S4.F2.14.7.m1.1.1.2">𝚂</ci><ci id="S4.F2.14.7.m1.1.1.3a.cmml" xref="S4.F2.14.7.m1.1.1.3"><mtext id="S4.F2.14.7.m1.1.1.3.cmml" xref="S4.F2.14.7.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.14.7.m1.1d">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.F2.14.7.m1.1e">typewriter_S -agent</annotation></semantics></math></span> to engage in a self-training loop that iteratively improves its capability for conversational planning.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.21">For the <math alttext="t" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.1.m1.1d">italic_t</annotation></semantics></math>-th turn, we define the state <math alttext="s_{t}\in\mathcal{S}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><msub id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1"><in id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1"></in><apply id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.2">𝑠</ci><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.1c">s_{t}\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_S</annotation></semantics></math> as a triplet <math alttext="s_{t}=(\mathcal{P}^{+}_{t},\mathcal{P}^{-}_{t},\mathcal{V}^{-}_{t})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.3.m3.3"><semantics id="S4.SS1.SSS0.Px1.p1.3.m3.3a"><mrow id="S4.SS1.SSS0.Px1.p1.3.m3.3.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.cmml"><msub id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5.cmml"><mi id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.4" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.4.cmml">=</mo><mrow id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.4.cmml"><mo id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.4" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.4.cmml">(</mo><msubsup id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.2.cmml">𝒫</mi><mi id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.cmml">t</mi><mo id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.3.cmml">+</mo></msubsup><mo id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.5" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.4.cmml">,</mo><msubsup id="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2.2.cmml">𝒫</mi><mi id="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.3.cmml">t</mi><mo id="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2.3.cmml">−</mo></msubsup><mo id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.6" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.4.cmml">,</mo><msubsup id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.2.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.3.cmml">t</mi><mo id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.2.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.2.3.cmml">−</mo></msubsup><mo id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.7" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.3.m3.3b"><apply id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3"><eq id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.4.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.4"></eq><apply id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5.2">𝑠</ci><ci id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.5.3">𝑡</ci></apply><vector id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.4.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3"><apply id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.2">𝒫</ci><plus id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.3"></plus></apply><ci id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2.2">𝒫</ci><minus id="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.2.3"></minus></apply><ci id="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.2.2">𝒱</ci><minus id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.2.3"></minus></apply><ci id="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.3.3.3.3.3.3">𝑡</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.3.m3.3c">s_{t}=(\mathcal{P}^{+}_{t},\mathcal{P}^{-}_{t},\mathcal{V}^{-}_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.3.m3.3d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( caligraphic_P start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_P start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_V start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\mathcal{P}^{+}_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px1.p1.4.m4.1a"><msubsup id="S4.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.2.cmml">𝒫</mi><mi id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml">t</mi><mo id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.2">𝒫</ci><plus id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.3"></plus></apply><ci id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.4.m4.1c">\mathcal{P}^{+}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.4.m4.1d">caligraphic_P start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes all the attribute values that the user has accepted until the <math alttext="t" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.5.m5.1"><semantics id="S4.SS1.SSS0.Px1.p1.5.m5.1a"><mi id="S4.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.5.m5.1b"><ci id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.5.m5.1d">italic_t</annotation></semantics></math>-th turn, <math alttext="\mathcal{P}^{-}_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.6.m6.1"><semantics id="S4.SS1.SSS0.Px1.p1.6.m6.1a"><msubsup id="S4.SS1.SSS0.Px1.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.2.cmml">𝒫</mi><mi id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.3" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.3.cmml">t</mi><mo id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.6.m6.1b"><apply id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.2">𝒫</ci><minus id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.3"></minus></apply><ci id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.6.m6.1c">\mathcal{P}^{-}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.6.m6.1d">caligraphic_P start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{V}^{-}_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.7.m7.1"><semantics id="S4.SS1.SSS0.Px1.p1.7.m7.1a"><msubsup id="S4.SS1.SSS0.Px1.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.3" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml">t</mi><mo id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.7.m7.1b"><apply id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.2">𝒱</ci><minus id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.3"></minus></apply><ci id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.7.m7.1c">\mathcal{V}^{-}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.7.m7.1d">caligraphic_V start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denote all the attribute values and items that the user has rejected until the <math alttext="t" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.8.m8.1"><semantics id="S4.SS1.SSS0.Px1.p1.8.m8.1a"><mi id="S4.SS1.SSS0.Px1.p1.8.m8.1.1" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.8.m8.1b"><ci id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.8.m8.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.8.m8.1d">italic_t</annotation></semantics></math>-th turn.
As the conversation continues until the user accepts a recommended item or the conversation terminates, the accepted item set <math alttext="\mathcal{V}^{+}_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.9.m9.1"><semantics id="S4.SS1.SSS0.Px1.p1.9.m9.1a"><msubsup id="S4.SS1.SSS0.Px1.p1.9.m9.1.1" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.3" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.3.cmml">t</mi><mo id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.9.m9.1b"><apply id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.2">𝒱</ci><plus id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.2.3"></plus></apply><ci id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.9.m9.1c">\mathcal{V}^{+}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.9.m9.1d">caligraphic_V start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is always empty during the conversation, and hence we do not need <math alttext="\mathcal{V}^{+}_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.10.m10.1"><semantics id="S4.SS1.SSS0.Px1.p1.10.m10.1a"><msubsup id="S4.SS1.SSS0.Px1.p1.10.m10.1.1" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.3" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.3.cmml">t</mi><mo id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.10.m10.1b"><apply id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2.2">𝒱</ci><plus id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.2.3"></plus></apply><ci id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.10.m10.1c">\mathcal{V}^{+}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.10.m10.1d">caligraphic_V start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in the state.
Besides, the <span class="ltx_text" id="S4.SS1.SSS0.Px1.p1.11.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.11.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p1.11.1.m1.1a"><mrow id="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.2" xref="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.1" xref="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.3" xref="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.11.1.m1.1b"><apply id="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1"><times id="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.1"></times><ci id="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.2">𝚂</ci><ci id="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.3a.cmml" xref="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.3"><mtext id="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.11.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.11.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.11.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> also has access to all the information about the user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.12.m11.1"><semantics id="S4.SS1.SSS0.Px1.p1.12.m11.1a"><mi id="S4.SS1.SSS0.Px1.p1.12.m11.1.1" xref="S4.SS1.SSS0.Px1.p1.12.m11.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.12.m11.1b"><ci id="S4.SS1.SSS0.Px1.p1.12.m11.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.12.m11.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.12.m11.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.12.m11.1d">italic_u</annotation></semantics></math>
and the global information graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.13.m12.1"><semantics id="S4.SS1.SSS0.Px1.p1.13.m12.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.13.m12.1.1" xref="S4.SS1.SSS0.Px1.p1.13.m12.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.13.m12.1b"><ci id="S4.SS1.SSS0.Px1.p1.13.m12.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m12.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.13.m12.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.13.m12.1d">caligraphic_G</annotation></semantics></math> (a tripartite graph that represents all the interactions between users and items and all the associations between items and attribute
values).
The state is initialized as <math alttext="s_{0}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.14.m13.1"><semantics id="S4.SS1.SSS0.Px1.p1.14.m13.1a"><msub id="S4.SS1.SSS0.Px1.p1.14.m13.1.1" xref="S4.SS1.SSS0.Px1.p1.14.m13.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.14.m13.1.1.2" xref="S4.SS1.SSS0.Px1.p1.14.m13.1.1.2.cmml">s</mi><mn id="S4.SS1.SSS0.Px1.p1.14.m13.1.1.3" xref="S4.SS1.SSS0.Px1.p1.14.m13.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.14.m13.1b"><apply id="S4.SS1.SSS0.Px1.p1.14.m13.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.14.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.14.m13.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.14.m13.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.14.m13.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.14.m13.1.1.2">𝑠</ci><cn id="S4.SS1.SSS0.Px1.p1.14.m13.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.14.m13.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.14.m13.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.14.m13.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> when the user specifies preference on an attribute type <math alttext="y_{0}\in\mathcal{Y}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.15.m14.1"><semantics id="S4.SS1.SSS0.Px1.p1.15.m14.1a"><mrow id="S4.SS1.SSS0.Px1.p1.15.m14.1.1" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1.cmml"><msub id="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2.2.cmml">y</mi><mn id="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2.3.cmml">0</mn></msub><mo id="S4.SS1.SSS0.Px1.p1.15.m14.1.1.1" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.15.m14.1.1.3" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.15.m14.1b"><apply id="S4.SS1.SSS0.Px1.p1.15.m14.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1"><in id="S4.SS1.SSS0.Px1.p1.15.m14.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1.1"></in><apply id="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2.2">𝑦</ci><cn id="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2.3.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1.2.3">0</cn></apply><ci id="S4.SS1.SSS0.Px1.p1.15.m14.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.15.m14.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.15.m14.1c">y_{0}\in\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.15.m14.1d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ caligraphic_Y</annotation></semantics></math> and its corresponding attribute value <math alttext="p_{0}\in\mathcal{P}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.16.m15.1"><semantics id="S4.SS1.SSS0.Px1.p1.16.m15.1a"><mrow id="S4.SS1.SSS0.Px1.p1.16.m15.1.1" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1.cmml"><msub id="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2.2.cmml">p</mi><mn id="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2.3.cmml">0</mn></msub><mo id="S4.SS1.SSS0.Px1.p1.16.m15.1.1.1" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.16.m15.1.1.3" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1.3.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.16.m15.1b"><apply id="S4.SS1.SSS0.Px1.p1.16.m15.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1"><in id="S4.SS1.SSS0.Px1.p1.16.m15.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1.1"></in><apply id="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2.2">𝑝</ci><cn id="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2.3.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1.2.3">0</cn></apply><ci id="S4.SS1.SSS0.Px1.p1.16.m15.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.16.m15.1.1.3">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.16.m15.1c">p_{0}\in\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.16.m15.1d">italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ caligraphic_P</annotation></semantics></math>,
and transitions to the next states as the conversation continues.
The candidate attribute value set <math alttext="\mathcal{P}^{c}_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.17.m16.1"><semantics id="S4.SS1.SSS0.Px1.p1.17.m16.1a"><msubsup id="S4.SS1.SSS0.Px1.p1.17.m16.1.1" xref="S4.SS1.SSS0.Px1.p1.17.m16.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.17.m16.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.17.m16.1.1.2.2.cmml">𝒫</mi><mi id="S4.SS1.SSS0.Px1.p1.17.m16.1.1.3" xref="S4.SS1.SSS0.Px1.p1.17.m16.1.1.3.cmml">t</mi><mi id="S4.SS1.SSS0.Px1.p1.17.m16.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.17.m16.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.17.m16.1b"><apply id="S4.SS1.SSS0.Px1.p1.17.m16.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.17.m16.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.17.m16.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.17.m16.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.17.m16.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.17.m16.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.17.m16.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.17.m16.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.17.m16.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.17.m16.1.1.2.2">𝒫</ci><ci id="S4.SS1.SSS0.Px1.p1.17.m16.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.17.m16.1.1.2.3">𝑐</ci></apply><ci id="S4.SS1.SSS0.Px1.p1.17.m16.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.17.m16.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.17.m16.1c">\mathcal{P}^{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.17.m16.1d">caligraphic_P start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and candidate item set <math alttext="\mathcal{V}^{c}_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.18.m17.1"><semantics id="S4.SS1.SSS0.Px1.p1.18.m17.1a"><msubsup id="S4.SS1.SSS0.Px1.p1.18.m17.1.1" xref="S4.SS1.SSS0.Px1.p1.18.m17.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.18.m17.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.18.m17.1.1.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS0.Px1.p1.18.m17.1.1.3" xref="S4.SS1.SSS0.Px1.p1.18.m17.1.1.3.cmml">t</mi><mi id="S4.SS1.SSS0.Px1.p1.18.m17.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.18.m17.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.18.m17.1b"><apply id="S4.SS1.SSS0.Px1.p1.18.m17.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.18.m17.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.18.m17.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.18.m17.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.18.m17.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.18.m17.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.18.m17.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.18.m17.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.18.m17.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.18.m17.1.1.2.2">𝒱</ci><ci id="S4.SS1.SSS0.Px1.p1.18.m17.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.18.m17.1.1.2.3">𝑐</ci></apply><ci id="S4.SS1.SSS0.Px1.p1.18.m17.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.18.m17.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.18.m17.1c">\mathcal{V}^{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.18.m17.1d">caligraphic_V start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are updated according to <math alttext="\mathcal{P}^{+}_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.19.m18.1"><semantics id="S4.SS1.SSS0.Px1.p1.19.m18.1a"><msubsup id="S4.SS1.SSS0.Px1.p1.19.m18.1.1" xref="S4.SS1.SSS0.Px1.p1.19.m18.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.19.m18.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.19.m18.1.1.2.2.cmml">𝒫</mi><mi id="S4.SS1.SSS0.Px1.p1.19.m18.1.1.3" xref="S4.SS1.SSS0.Px1.p1.19.m18.1.1.3.cmml">t</mi><mo id="S4.SS1.SSS0.Px1.p1.19.m18.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.19.m18.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.19.m18.1b"><apply id="S4.SS1.SSS0.Px1.p1.19.m18.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.19.m18.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.19.m18.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.19.m18.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.19.m18.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.19.m18.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.19.m18.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.19.m18.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.19.m18.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.19.m18.1.1.2.2">𝒫</ci><plus id="S4.SS1.SSS0.Px1.p1.19.m18.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.19.m18.1.1.2.3"></plus></apply><ci id="S4.SS1.SSS0.Px1.p1.19.m18.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.19.m18.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.19.m18.1c">\mathcal{P}^{+}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.19.m18.1d">caligraphic_P start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathcal{P}^{-}_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.20.m19.1"><semantics id="S4.SS1.SSS0.Px1.p1.20.m19.1a"><msubsup id="S4.SS1.SSS0.Px1.p1.20.m19.1.1" xref="S4.SS1.SSS0.Px1.p1.20.m19.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.20.m19.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.20.m19.1.1.2.2.cmml">𝒫</mi><mi id="S4.SS1.SSS0.Px1.p1.20.m19.1.1.3" xref="S4.SS1.SSS0.Px1.p1.20.m19.1.1.3.cmml">t</mi><mo id="S4.SS1.SSS0.Px1.p1.20.m19.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.20.m19.1.1.2.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.20.m19.1b"><apply id="S4.SS1.SSS0.Px1.p1.20.m19.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.20.m19.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.20.m19.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.20.m19.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.20.m19.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.20.m19.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.20.m19.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.20.m19.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.20.m19.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.20.m19.1.1.2.2">𝒫</ci><minus id="S4.SS1.SSS0.Px1.p1.20.m19.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.20.m19.1.1.2.3"></minus></apply><ci id="S4.SS1.SSS0.Px1.p1.20.m19.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.20.m19.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.20.m19.1c">\mathcal{P}^{-}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.20.m19.1d">caligraphic_P start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{V}^{-}_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.21.m20.1"><semantics id="S4.SS1.SSS0.Px1.p1.21.m20.1a"><msubsup id="S4.SS1.SSS0.Px1.p1.21.m20.1.1" xref="S4.SS1.SSS0.Px1.p1.21.m20.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.21.m20.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.21.m20.1.1.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS0.Px1.p1.21.m20.1.1.3" xref="S4.SS1.SSS0.Px1.p1.21.m20.1.1.3.cmml">t</mi><mo id="S4.SS1.SSS0.Px1.p1.21.m20.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.21.m20.1.1.2.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.21.m20.1b"><apply id="S4.SS1.SSS0.Px1.p1.21.m20.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.21.m20.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.21.m20.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.21.m20.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.21.m20.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.21.m20.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.21.m20.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.21.m20.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.21.m20.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.21.m20.1.1.2.2">𝒱</ci><minus id="S4.SS1.SSS0.Px1.p1.21.m20.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.21.m20.1.1.2.3"></minus></apply><ci id="S4.SS1.SSS0.Px1.p1.21.m20.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.21.m20.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.21.m20.1c">\mathcal{V}^{-}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.21.m20.1d">caligraphic_V start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, which we will elaborate later
in the <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px1.p1.21.2">Transition</span> subparagraph.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Action</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.18">The action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.1a"><msub id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">a</mi><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2">𝑎</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> refers to asking for a specific attribute value (<math alttext="\mathtt{ask}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px2.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">𝚊𝚜𝚔</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1">𝚊𝚜𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.2.m2.1c">\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.2.m2.1d">typewriter_ask</annotation></semantics></math>)
or recommending a specific item (<math alttext="\mathtt{rec}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px2.p1.3.m3.1a"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">𝚛𝚎𝚌</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.3.m3.1b"><ci id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1">𝚛𝚎𝚌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.3.m3.1c">\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.3.m3.1d">typewriter_rec</annotation></semantics></math>) at the <math alttext="t" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px2.p1.4.m4.1a"><mi id="S4.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.4.m4.1b"><ci id="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.4.m4.1d">italic_t</annotation></semantics></math>-th turn.
Here, we adopt a hierarchical action selection process:
we first use a new policy network <math alttext="\pi_{\phi}(o_{t}|s_{t})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.5.m5.1"><semantics id="S4.SS1.SSS0.Px2.p1.5.m5.1a"><mrow id="S4.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.cmml"><msub id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.2.cmml">π</mi><mi id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.3" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.3.cmml">ϕ</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.cmml"><msub id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.2" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.3" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.cmml">|</mo><msub id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.3" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.5.m5.1b"><apply id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1"><times id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2"></times><apply id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.2">𝜋</ci><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.3">italic-ϕ</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.5.m5.1c">\pi_{\phi}(o_{t}|s_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.5.m5.1d">italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> to decide the action type <math alttext="o_{t}\in\{\mathtt{ask},\mathtt{rec}\}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.6.m6.2"><semantics id="S4.SS1.SSS0.Px2.p1.6.m6.2a"><mrow id="S4.SS1.SSS0.Px2.p1.6.m6.2.3" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.cmml"><msub id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2.3" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.1" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.1.cmml">∈</mo><mrow id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.3.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.3.1.cmml"><mo id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.3.1.cmml">{</mo><mi id="S4.SS1.SSS0.Px2.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml">𝚊𝚜𝚔</mi><mo id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.3.2.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p1.6.m6.2.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.2.cmml">𝚛𝚎𝚌</mi><mo id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.3.2.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.6.m6.2b"><apply id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3"><in id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.1"></in><apply id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.2.3">𝑡</ci></apply><set id="S4.SS1.SSS0.Px2.p1.6.m6.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.3.3.2"><ci id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1">𝚊𝚜𝚔</ci><ci id="S4.SS1.SSS0.Px2.p1.6.m6.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.2.2">𝚛𝚎𝚌</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.6.m6.2c">o_{t}\in\{\mathtt{ask},\mathtt{rec}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.6.m6.2d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ { typewriter_ask , typewriter_rec }</annotation></semantics></math> from the current state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.7.m7.1"><semantics id="S4.SS1.SSS0.Px2.p1.7.m7.1a"><msub id="S4.SS1.SSS0.Px2.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.2" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.3" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.7.m7.1b"><apply id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.7.m7.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.7.m7.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>,
and then use a new Q-network <math alttext="Q_{\theta}(a_{t}|s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.8.m8.1"><semantics id="S4.SS1.SSS0.Px2.p1.8.m8.1a"><mrow id="S4.SS1.SSS0.Px2.p1.8.m8.1.1" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.cmml"><msub id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.cmml">Q</mi><mi id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.3" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.2" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.cmml"><msub id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4.cmml"><mi id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4.2" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4.2.cmml">a</mi><mi id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4.3" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.3.cmml"><msub id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.3" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.8.m8.1b"><apply id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1"><times id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.2"></times><apply id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2">𝑄</ci><ci id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.3">𝜃</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.3">conditional</csymbol><apply id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4.2.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4.2">𝑎</ci><ci id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4.3.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2"><apply id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.8.m8.1c">Q_{\theta}(a_{t}|s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.8.m8.1d">italic_Q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> to decide the specific action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.9.m9.1"><semantics id="S4.SS1.SSS0.Px2.p1.9.m9.1a"><msub id="S4.SS1.SSS0.Px2.p1.9.m9.1.1" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.2" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.2.cmml">a</mi><mi id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.9.m9.1b"><apply id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.2">𝑎</ci><ci id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.9.m9.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.9.m9.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> according to the action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.10.m10.1"><semantics id="S4.SS1.SSS0.Px2.p1.10.m10.1a"><msub id="S4.SS1.SSS0.Px2.p1.10.m10.1.1" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.2" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.3" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.10.m10.1b"><apply id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.10.m10.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.10.m10.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
The action space (at the current state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.11.m11.1"><semantics id="S4.SS1.SSS0.Px2.p1.11.m11.1a"><msub id="S4.SS1.SSS0.Px2.p1.11.m11.1.1" xref="S4.SS1.SSS0.Px2.p1.11.m11.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.11.m11.1.1.2" xref="S4.SS1.SSS0.Px2.p1.11.m11.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px2.p1.11.m11.1.1.3" xref="S4.SS1.SSS0.Px2.p1.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.11.m11.1b"><apply id="S4.SS1.SSS0.Px2.p1.11.m11.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.11.m11.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.11.m11.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.11.m11.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.11.m11.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.11.m11.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.11.m11.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.11.m11.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>) <math alttext="\mathcal{A}_{s_{t}}{=}\{\mathcal{P}^{c}_{t},\mathcal{V}^{c}_{t}\}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.12.m12.2"><semantics id="S4.SS1.SSS0.Px2.p1.12.m12.2a"><mrow id="S4.SS1.SSS0.Px2.p1.12.m12.2.2" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.cmml"><msub id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.2" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.2.cmml">𝒜</mi><msub id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3.2" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3.3" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3.3.cmml">t</mi></msub></msub><mo id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.3" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.3.cmml">=</mo><mrow id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.3.cmml"><mo id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.3.cmml">{</mo><msubsup id="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.2.2" xref="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.2.2.cmml">𝒫</mi><mi id="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.3.cmml">t</mi><mi id="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.2.3" xref="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.2.3.cmml">c</mi></msubsup><mo id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.4" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.3.cmml">,</mo><msubsup id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.3.cmml">t</mi><mi id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.2.3.cmml">c</mi></msubsup><mo id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.5" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.12.m12.2b"><apply id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2"><eq id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.3"></eq><apply id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.1.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.2.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.2">𝒜</ci><apply id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3.2">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.4.3.3">𝑡</ci></apply></apply><set id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2"><apply id="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.2.2">𝒫</ci><ci id="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2">subscript</csymbol><apply id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.2.2">𝒱</ci><ci id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.2.3">𝑐</ci></apply><ci id="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.12.m12.2.2.2.2.2.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.12.m12.2c">\mathcal{A}_{s_{t}}{=}\{\mathcal{P}^{c}_{t},\mathcal{V}^{c}_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.12.m12.2d">caligraphic_A start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = { caligraphic_P start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_V start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> contains all the candidate items and attribute values.
The Q-network <math alttext="Q_{\theta}(a_{t}|s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.13.m13.1"><semantics id="S4.SS1.SSS0.Px2.p1.13.m13.1a"><mrow id="S4.SS1.SSS0.Px2.p1.13.m13.1.1" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.cmml"><msub id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3.2.cmml">Q</mi><mi id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3.3" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.2" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.cmml"><msub id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4.cmml"><mi id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4.2" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4.2.cmml">a</mi><mi id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4.3" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.3.cmml"><msub id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.3" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.13.m13.1b"><apply id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1"><times id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.2"></times><apply id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3.2">𝑄</ci><ci id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.3.3">𝜃</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.3">conditional</csymbol><apply id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4.1.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4.2.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4.2">𝑎</ci><ci id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4.3.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2"><apply id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.13.m13.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.13.m13.1c">Q_{\theta}(a_{t}|s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.13.m13.1d">italic_Q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> only selects an action from a sub action space <math alttext="\mathcal{A}_{s_{t},o_{t}}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.14.m14.2"><semantics id="S4.SS1.SSS0.Px2.p1.14.m14.2a"><msub id="S4.SS1.SSS0.Px2.p1.14.m14.2.3" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p1.14.m14.2.3.2" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.3.2.cmml">𝒜</mi><mrow id="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.3.cmml"><msub id="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2.3.cmml">t</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.14.m14.2b"><apply id="S4.SS1.SSS0.Px2.p1.14.m14.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.14.m14.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.14.m14.2.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.3.2">𝒜</ci><list id="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2"><apply id="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.14.m14.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.14.m14.2.2.2.2.2.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.14.m14.2c">\mathcal{A}_{s_{t},o_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.14.m14.2d">caligraphic_A start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>: when <math alttext="o_{t}{=}\mathtt{ask}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.15.m15.1"><semantics id="S4.SS1.SSS0.Px2.p1.15.m15.1a"><mrow id="S4.SS1.SSS0.Px2.p1.15.m15.1.1" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1.cmml"><msub id="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2.2" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2.3" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.15.m15.1.1.1" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1.1.cmml">=</mo><mi id="S4.SS1.SSS0.Px2.p1.15.m15.1.1.3" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1.3.cmml">𝚊𝚜𝚔</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.15.m15.1b"><apply id="S4.SS1.SSS0.Px2.p1.15.m15.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1"><eq id="S4.SS1.SSS0.Px2.p1.15.m15.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1.1"></eq><apply id="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1.2.3">𝑡</ci></apply><ci id="S4.SS1.SSS0.Px2.p1.15.m15.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.15.m15.1.1.3">𝚊𝚜𝚔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.15.m15.1c">o_{t}{=}\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.15.m15.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = typewriter_ask</annotation></semantics></math>, <math alttext="\mathcal{A}_{s_{t},o_{t}}{=}\mathcal{P}^{c}_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.16.m16.2"><semantics id="S4.SS1.SSS0.Px2.p1.16.m16.2a"><mrow id="S4.SS1.SSS0.Px2.p1.16.m16.2.3" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.cmml"><msub id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.2" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.2.2" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.2.2.cmml">𝒜</mi><mrow id="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.3.cmml"><msub id="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2.3.cmml">t</mi></msub></mrow></msub><mo id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.1" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.1.cmml">=</mo><msubsup id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.2.2" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.2.2.cmml">𝒫</mi><mi id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.3" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.3.cmml">t</mi><mi id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.2.3" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.2.3.cmml">c</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.16.m16.2b"><apply id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3"><eq id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.1"></eq><apply id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.2.2">𝒜</ci><list id="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2"><apply id="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.2.2.2.2.3">𝑡</ci></apply></list></apply><apply id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3">subscript</csymbol><apply id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.2.2">𝒫</ci><ci id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.2.3">𝑐</ci></apply><ci id="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.16.m16.2.3.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.16.m16.2c">\mathcal{A}_{s_{t},o_{t}}{=}\mathcal{P}^{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.16.m16.2d">caligraphic_A start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = caligraphic_P start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>; when <math alttext="o_{t}{=}\mathtt{rec}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.17.m17.1"><semantics id="S4.SS1.SSS0.Px2.p1.17.m17.1a"><mrow id="S4.SS1.SSS0.Px2.p1.17.m17.1.1" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1.cmml"><msub id="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2.2" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2.3" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.17.m17.1.1.1" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1.1.cmml">=</mo><mi id="S4.SS1.SSS0.Px2.p1.17.m17.1.1.3" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1.3.cmml">𝚛𝚎𝚌</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.17.m17.1b"><apply id="S4.SS1.SSS0.Px2.p1.17.m17.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1"><eq id="S4.SS1.SSS0.Px2.p1.17.m17.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1.1"></eq><apply id="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1.2.3">𝑡</ci></apply><ci id="S4.SS1.SSS0.Px2.p1.17.m17.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.17.m17.1.1.3">𝚛𝚎𝚌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.17.m17.1c">o_{t}{=}\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.17.m17.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = typewriter_rec</annotation></semantics></math>, <math alttext="\mathcal{A}_{s_{t},o_{t}}{=}\mathcal{V}^{c}_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.18.m18.2"><semantics id="S4.SS1.SSS0.Px2.p1.18.m18.2a"><mrow id="S4.SS1.SSS0.Px2.p1.18.m18.2.3" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.cmml"><msub id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.2" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.2.2" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.2.2.cmml">𝒜</mi><mrow id="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.3.cmml"><msub id="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2.3.cmml">t</mi></msub></mrow></msub><mo id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.1" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.1.cmml">=</mo><msubsup id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.2.2" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.2.2.cmml">𝒱</mi><mi id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.3" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.3.cmml">t</mi><mi id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.2.3" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.2.3.cmml">c</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.18.m18.2b"><apply id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3"><eq id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.1"></eq><apply id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.2.2">𝒜</ci><list id="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2"><apply id="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.2.2.2.2.3">𝑡</ci></apply></list></apply><apply id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3">subscript</csymbol><apply id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.2.2">𝒱</ci><ci id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.2.3">𝑐</ci></apply><ci id="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.18.m18.2.3.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.18.m18.2c">\mathcal{A}_{s_{t},o_{t}}{=}\mathcal{V}^{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.18.m18.2d">caligraphic_A start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = caligraphic_V start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Details on the policy network and the Q-network are available in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.SS2" title='4.2 𝚂⁢"-agent" ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search'><span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Transition</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.4">Transition occurs from the current state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px3.p1.1.m1.1a"><msub id="S4.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml">s</mi><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2">𝑠</ci><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.1.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to the next state <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px3.p1.2.m2.1a"><msub id="S4.SS1.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.2.cmml">s</mi><mrow id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.2" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.2.cmml">t</mi><mo id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.1" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.1.cmml">+</mo><mn id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.3" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.2">𝑠</ci><apply id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3"><plus id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.2">𝑡</ci><cn id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.2.m2.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> when the user responds
to the action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px3.p1.3.m3.1a"><msub id="S4.SS1.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml">a</mi><mi id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.2">𝑎</ci><ci id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.3.m3.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.3.m3.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (accepts or rejects items/attribute values).
Candidate item set are narrowed down to the remaining items that still satisfy the user’s preference requirement, and attribute values asked at turn <math alttext="t" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px3.p1.4.m4.1a"><mi id="S4.SS1.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.4.m4.1b"><ci id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.4.m4.1d">italic_t</annotation></semantics></math> are excluded from the candidate attribute value set. More details are in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A4" title="Appendix D Transition Function ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Reward</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px4.p1.3">We denote the immediate reward at the <math alttext="t" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px4.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px4.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.1.m1.1d">italic_t</annotation></semantics></math>-th conversational turn as <math alttext="r_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px4.p1.2.m2.1a"><msub id="S4.SS1.SSS0.Px4.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.cmml">r</mi><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2">𝑟</ci><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.2.m2.1c">r_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.2.m2.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and the cumulative reward for each conversation is calculated as <math alttext="\sum^{T}_{t=1}\gamma^{t}r_{t}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px4.p1.3.m3.1a"><mrow id="S4.SS1.SSS0.Px4.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.cmml"><msubsup id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.2.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.2.2.cmml">∑</mo><mrow id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.2.cmml">t</mi><mo id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.1" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.2.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.2.3.cmml">T</mi></msubsup><mrow id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.cmml"><msup id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.cmml"><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.2.cmml">γ</mi><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.3.cmml">t</mi></msup><mo id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.1" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.1.cmml">⁢</mo><msub id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.cmml"><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.2.cmml">r</mi><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1">superscript</csymbol><sum id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.2.2"></sum><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.2.3">𝑇</ci></apply><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3"><eq id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.1"></eq><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.2">𝑡</ci><cn id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2"><times id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.1"></times><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.2">𝛾</ci><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.2">𝑟</ci><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.3.m3.1c">\sum^{T}_{t=1}\gamma^{t}r_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.3.m3.1d">∑ start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
Intuitively, a positive reward is assigned when the user accepts the items or attribute values, and a negative reward is assigned when the user rejects the items or attribute values. Details on the reward function are available in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A5" title="Appendix E Reward Function ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span><span class="ltx_text" id="S4.SS2.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS2.1.1.m1.1"><semantics id="S4.SS2.1.1.m1.1b"><mrow id="S4.SS2.1.1.m1.1.1" xref="S4.SS2.1.1.m1.1.1.cmml"><mi id="S4.SS2.1.1.m1.1.1.2" xref="S4.SS2.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS2.1.1.m1.1.1.1" xref="S4.SS2.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS2.1.1.m1.1.1.3" xref="S4.SS2.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.1.1.m1.1c"><apply id="S4.SS2.1.1.m1.1.1.cmml" xref="S4.SS2.1.1.m1.1.1"><times id="S4.SS2.1.1.m1.1.1.1.cmml" xref="S4.SS2.1.1.m1.1.1.1"></times><ci id="S4.SS2.1.1.m1.1.1.2.cmml" xref="S4.SS2.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS2.1.1.m1.1.1.3a.cmml" xref="S4.SS2.1.1.m1.1.1.3"><mtext id="S4.SS2.1.1.m1.1.1.3.cmml" xref="S4.SS2.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.1.1.m1.1d">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.1.1.m1.1e">typewriter_S -agent</annotation></semantics></math></span>
</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1"><span class="ltx_text" id="S4.SS2.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS2.p1.1.1.m1.1"><semantics id="S4.SS2.p1.1.1.m1.1a"><mrow id="S4.SS2.p1.1.1.m1.1.1" xref="S4.SS2.p1.1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.1.m1.1.1.2" xref="S4.SS2.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS2.p1.1.1.m1.1.1.1" xref="S4.SS2.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS2.p1.1.1.m1.1.1.3" xref="S4.SS2.p1.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.1.m1.1b"><apply id="S4.SS2.p1.1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.1.m1.1.1"><times id="S4.SS2.p1.1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.1.m1.1.1.1"></times><ci id="S4.SS2.p1.1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS2.p1.1.1.m1.1.1.3a.cmml" xref="S4.SS2.p1.1.1.m1.1.1.3"><mtext id="S4.SS2.p1.1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> comprises three components: the state encoder, the policy network, and the Q-network. The state encoder adopts graph neural networks to generate the state representation. This state representation is then utilized by both the policy network and the Q-network to decide the action type and the specific actions in each conversational turn.</p>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">State Encoder</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.12">To include essential information about the conversation and the user, <span class="ltx_text" id="S4.SS2.SSS0.Px1.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.1.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.1.1.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1"><times id="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.1"></times><ci id="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.3a.cmml" xref="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.3"><mtext id="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> first uses a graph attention network <cite class="ltx_cite ltx_citemacro_cite">Brody et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib5" title="">2022</a>)</cite> to learn the representations of users, items, and attribute values out of the global information graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.2.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.2.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px1.p1.2.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m1.1b"><ci id="S4.SS2.SSS0.Px1.p1.2.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.2.m1.1d">caligraphic_G</annotation></semantics></math>.
Next, <span class="ltx_text" id="S4.SS2.SSS0.Px1.p1.3.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.3.2.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.3.2.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.3.2.m1.1b"><apply id="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1"><times id="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.1"></times><ci id="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.2">𝚂</ci><ci id="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.3a.cmml" xref="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.3"><mtext id="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.3.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.3.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.3.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> introduces two personalized graphs—positive feedback graph (denoted as <math alttext="\mathcal{G}^{+}_{t}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.4.m2.1"><semantics id="S4.SS2.SSS0.Px1.p1.4.m2.1a"><msubsup id="S4.SS2.SSS0.Px1.p1.4.m2.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2.2" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2.2.cmml">𝒢</mi><mi id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.3" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1.3.cmml">t</mi><mo id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2.3" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.4.m2.1b"><apply id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2.2">𝒢</ci><plus id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2.3"></plus></apply><ci id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.4.m2.1c">\mathcal{G}^{+}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.4.m2.1d">caligraphic_G start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>) and negative feedback graph (denoted as <math alttext="\mathcal{G}^{-}_{t}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.5.m3.1"><semantics id="S4.SS2.SSS0.Px1.p1.5.m3.1a"><msubsup id="S4.SS2.SSS0.Px1.p1.5.m3.1.1" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px1.p1.5.m3.1.1.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1.2.2.cmml">𝒢</mi><mi id="S4.SS2.SSS0.Px1.p1.5.m3.1.1.3" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1.3.cmml">t</mi><mo id="S4.SS2.SSS0.Px1.p1.5.m3.1.1.2.3" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1.2.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.5.m3.1b"><apply id="S4.SS2.SSS0.Px1.p1.5.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.5.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p1.5.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.5.m3.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.5.m3.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1.2.2">𝒢</ci><minus id="S4.SS2.SSS0.Px1.p1.5.m3.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1.2.3"></minus></apply><ci id="S4.SS2.SSS0.Px1.p1.5.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.5.m3.1c">\mathcal{G}^{-}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.5.m3.1d">caligraphic_G start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>)—to represent each user’s acceptance/rejection on attribute values until the <math alttext="t" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.6.m4.1"><semantics id="S4.SS2.SSS0.Px1.p1.6.m4.1a"><mi id="S4.SS2.SSS0.Px1.p1.6.m4.1.1" xref="S4.SS2.SSS0.Px1.p1.6.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.6.m4.1b"><ci id="S4.SS2.SSS0.Px1.p1.6.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.6.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.6.m4.1d">italic_t</annotation></semantics></math>-th turn, and uses two dedicated graph convolutional networks to learn the representations of users, items, and attribute values <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>)</cite> from the graphs.
Finally, <span class="ltx_text" id="S4.SS2.SSS0.Px1.p1.7.3"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.7.3.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.7.3.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.7.3.m1.1b"><apply id="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1"><times id="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.1"></times><ci id="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.2">𝚂</ci><ci id="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.3a.cmml" xref="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.3"><mtext id="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.7.3.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.7.3.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.7.3.m1.1d">typewriter_S -agent</annotation></semantics></math></span> aggregates the representations of items and attribute values from <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.8.m5.1"><semantics id="S4.SS2.SSS0.Px1.p1.8.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px1.p1.8.m5.1.1" xref="S4.SS2.SSS0.Px1.p1.8.m5.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.8.m5.1b"><ci id="S4.SS2.SSS0.Px1.p1.8.m5.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.8.m5.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.8.m5.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.8.m5.1d">caligraphic_G</annotation></semantics></math>, <math alttext="\mathcal{G}^{+}_{t}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.9.m6.1"><semantics id="S4.SS2.SSS0.Px1.p1.9.m6.1a"><msubsup id="S4.SS2.SSS0.Px1.p1.9.m6.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px1.p1.9.m6.1.1.2.2" xref="S4.SS2.SSS0.Px1.p1.9.m6.1.1.2.2.cmml">𝒢</mi><mi id="S4.SS2.SSS0.Px1.p1.9.m6.1.1.3" xref="S4.SS2.SSS0.Px1.p1.9.m6.1.1.3.cmml">t</mi><mo id="S4.SS2.SSS0.Px1.p1.9.m6.1.1.2.3" xref="S4.SS2.SSS0.Px1.p1.9.m6.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.9.m6.1b"><apply id="S4.SS2.SSS0.Px1.p1.9.m6.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.9.m6.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m6.1.1">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p1.9.m6.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.9.m6.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m6.1.1">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.9.m6.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m6.1.1.2.2">𝒢</ci><plus id="S4.SS2.SSS0.Px1.p1.9.m6.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m6.1.1.2.3"></plus></apply><ci id="S4.SS2.SSS0.Px1.p1.9.m6.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.9.m6.1c">\mathcal{G}^{+}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.9.m6.1d">caligraphic_G start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{G}^{-}_{t}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.10.m7.1"><semantics id="S4.SS2.SSS0.Px1.p1.10.m7.1a"><msubsup id="S4.SS2.SSS0.Px1.p1.10.m7.1.1" xref="S4.SS2.SSS0.Px1.p1.10.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px1.p1.10.m7.1.1.2.2" xref="S4.SS2.SSS0.Px1.p1.10.m7.1.1.2.2.cmml">𝒢</mi><mi id="S4.SS2.SSS0.Px1.p1.10.m7.1.1.3" xref="S4.SS2.SSS0.Px1.p1.10.m7.1.1.3.cmml">t</mi><mo id="S4.SS2.SSS0.Px1.p1.10.m7.1.1.2.3" xref="S4.SS2.SSS0.Px1.p1.10.m7.1.1.2.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.10.m7.1b"><apply id="S4.SS2.SSS0.Px1.p1.10.m7.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.10.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.10.m7.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.10.m7.1.1">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p1.10.m7.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.10.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.10.m7.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.10.m7.1.1">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.10.m7.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.10.m7.1.1.2.2">𝒢</ci><minus id="S4.SS2.SSS0.Px1.p1.10.m7.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.10.m7.1.1.2.3"></minus></apply><ci id="S4.SS2.SSS0.Px1.p1.10.m7.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.10.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.10.m7.1c">\mathcal{G}^{-}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.10.m7.1d">caligraphic_G start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> with a Transformer <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib44" title="">2017</a>)</cite>-based aggregator to model the action sequence in the conversation, and obtain the representation <math alttext="\mathbf{s}_{t}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.11.m8.1"><semantics id="S4.SS2.SSS0.Px1.p1.11.m8.1a"><msub id="S4.SS2.SSS0.Px1.p1.11.m8.1.1" xref="S4.SS2.SSS0.Px1.p1.11.m8.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.11.m8.1.1.2" xref="S4.SS2.SSS0.Px1.p1.11.m8.1.1.2.cmml">𝐬</mi><mi id="S4.SS2.SSS0.Px1.p1.11.m8.1.1.3" xref="S4.SS2.SSS0.Px1.p1.11.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.11.m8.1b"><apply id="S4.SS2.SSS0.Px1.p1.11.m8.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.11.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.11.m8.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.11.m8.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.11.m8.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.11.m8.1.1.2">𝐬</ci><ci id="S4.SS2.SSS0.Px1.p1.11.m8.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.11.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.11.m8.1c">\mathbf{s}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.11.m8.1d">bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> of the current state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.12.m9.1"><semantics id="S4.SS2.SSS0.Px1.p1.12.m9.1a"><msub id="S4.SS2.SSS0.Px1.p1.12.m9.1.1" xref="S4.SS2.SSS0.Px1.p1.12.m9.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.12.m9.1.1.2" xref="S4.SS2.SSS0.Px1.p1.12.m9.1.1.2.cmml">s</mi><mi id="S4.SS2.SSS0.Px1.p1.12.m9.1.1.3" xref="S4.SS2.SSS0.Px1.p1.12.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.12.m9.1b"><apply id="S4.SS2.SSS0.Px1.p1.12.m9.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.12.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.12.m9.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.12.m9.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.12.m9.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.12.m9.1.1.2">𝑠</ci><ci id="S4.SS2.SSS0.Px1.p1.12.m9.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.12.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.12.m9.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.12.m9.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Details on the state encoder are available in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A3" title="Appendix C Details of the State Encoder ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Policy network &amp; Q-network</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.7">Based on the state representation <math alttext="\mathbf{s}_{t}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px2.p1.1.m1.1a"><msub id="S4.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">𝐬</mi><mi id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2">𝐬</ci><ci id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.1.m1.1c">\mathbf{s}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.1.m1.1d">bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <span class="ltx_text" id="S4.SS2.SSS0.Px2.p1.2.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.2.1.m1.1"><semantics id="S4.SS2.SSS0.Px2.p1.2.1.m1.1a"><mrow id="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.2" xref="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.1" xref="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.3" xref="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.2.1.m1.1b"><apply id="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1"><times id="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.1"></times><ci id="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.2">𝚂</ci><ci id="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.3a.cmml" xref="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.3"><mtext id="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.2.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.2.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.2.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> adopts a policy network <math alttext="\pi_{\phi}(o_{t}|s_{t})" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.3.m2.1"><semantics id="S4.SS2.SSS0.Px2.p1.3.m2.1a"><mrow id="S4.SS2.SSS0.Px2.p1.3.m2.1.1" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.cmml"><msub id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3.2" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3.2.cmml">π</mi><mi id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3.3" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3.3.cmml">ϕ</mi></msub><mo id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.2" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.cmml"><msub id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2.2" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2.2.cmml">o</mi><mi id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2.3" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3.2" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3.2.cmml">s</mi><mi id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3.3" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.3.m2.1b"><apply id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1"><times id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.2"></times><apply id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3.2">𝜋</ci><ci id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.3.3">italic-ϕ</ci></apply><apply id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2.2">𝑜</ci><ci id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.3.m2.1c">\pi_{\phi}(o_{t}|s_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.3.m2.1d">italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> to decide action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.4.m3.1"><semantics id="S4.SS2.SSS0.Px2.p1.4.m3.1a"><msub id="S4.SS2.SSS0.Px2.p1.4.m3.1.1" xref="S4.SS2.SSS0.Px2.p1.4.m3.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p1.4.m3.1.1.2" xref="S4.SS2.SSS0.Px2.p1.4.m3.1.1.2.cmml">o</mi><mi id="S4.SS2.SSS0.Px2.p1.4.m3.1.1.3" xref="S4.SS2.SSS0.Px2.p1.4.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.4.m3.1b"><apply id="S4.SS2.SSS0.Px2.p1.4.m3.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.4.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.4.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.4.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.4.m3.1.1.2">𝑜</ci><ci id="S4.SS2.SSS0.Px2.p1.4.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.4.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.4.m3.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.4.m3.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and a Q-network <math alttext="Q_{\theta}(a_{t}|s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.5.m4.1"><semantics id="S4.SS2.SSS0.Px2.p1.5.m4.1a"><mrow id="S4.SS2.SSS0.Px2.p1.5.m4.1.1" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.cmml"><msub id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3.2" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3.2.cmml">Q</mi><mi id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3.3" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.2" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.cmml"><msub id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4.cmml"><mi id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4.2" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4.2.cmml">a</mi><mi id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4.3" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.3.cmml"><msub id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.3" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2.2" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2.2.cmml">o</mi><mi id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2.3" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.5.m4.1b"><apply id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1"><times id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.2"></times><apply id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3.2">𝑄</ci><ci id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.3.3">𝜃</ci></apply><apply id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.3">conditional</csymbol><apply id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4.1.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4.2.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4.2">𝑎</ci><ci id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4.3.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2"><apply id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2.2">𝑜</ci><ci id="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m4.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.5.m4.1c">Q_{\theta}(a_{t}|s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.5.m4.1d">italic_Q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> to decide the specific action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.6.m5.1"><semantics id="S4.SS2.SSS0.Px2.p1.6.m5.1a"><msub id="S4.SS2.SSS0.Px2.p1.6.m5.1.1" xref="S4.SS2.SSS0.Px2.p1.6.m5.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p1.6.m5.1.1.2" xref="S4.SS2.SSS0.Px2.p1.6.m5.1.1.2.cmml">a</mi><mi id="S4.SS2.SSS0.Px2.p1.6.m5.1.1.3" xref="S4.SS2.SSS0.Px2.p1.6.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.6.m5.1b"><apply id="S4.SS2.SSS0.Px2.p1.6.m5.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.6.m5.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.6.m5.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.6.m5.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.6.m5.1.1.2">𝑎</ci><ci id="S4.SS2.SSS0.Px2.p1.6.m5.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.6.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.6.m5.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.6.m5.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> according to the action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.7.m6.1"><semantics id="S4.SS2.SSS0.Px2.p1.7.m6.1a"><msub id="S4.SS2.SSS0.Px2.p1.7.m6.1.1" xref="S4.SS2.SSS0.Px2.p1.7.m6.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p1.7.m6.1.1.2" xref="S4.SS2.SSS0.Px2.p1.7.m6.1.1.2.cmml">o</mi><mi id="S4.SS2.SSS0.Px2.p1.7.m6.1.1.3" xref="S4.SS2.SSS0.Px2.p1.7.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.7.m6.1b"><apply id="S4.SS2.SSS0.Px2.p1.7.m6.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.7.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.7.m6.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.7.m6.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.7.m6.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.7.m6.1.1.2">𝑜</ci><ci id="S4.SS2.SSS0.Px2.p1.7.m6.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.7.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.7.m6.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.7.m6.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{gathered}\pi_{\phi}(o_{t}|s_{t})=\text{softmax}(\text{MLP}_{\pi}(%
\mathbf{s}_{t}))\\
Q_{\theta}(a_{t}|s_{t},o_{t})=\text{MLP}_{A}(\mathbf{s}_{t}||\mathbf{a}_{t})\!%
+\!\text{MLP}_{V}(\mathbf{s}_{t}),\end{gathered}" class="ltx_math_unparsed" display="block" id="S4.E1.m1.52"><semantics id="S4.E1.m1.52a"><mtable displaystyle="true" id="S4.E1.m1.52.52.2" rowspacing="0pt"><mtr id="S4.E1.m1.52.52.2a"><mtd id="S4.E1.m1.52.52.2b"><mrow id="S4.E1.m1.52.52.2.52.21.21"><mrow id="S4.E1.m1.51.51.1.51.20.20.20"><msub id="S4.E1.m1.51.51.1.51.20.20.20.3"><mi id="S4.E1.m1.1.1.1.1.1.1">π</mi><mi id="S4.E1.m1.2.2.2.2.2.2.1">ϕ</mi></msub><mo id="S4.E1.m1.51.51.1.51.20.20.20.2">⁢</mo><mrow id="S4.E1.m1.51.51.1.51.20.20.20.1.1"><mo id="S4.E1.m1.3.3.3.3.3.3" stretchy="false">(</mo><mrow id="S4.E1.m1.51.51.1.51.20.20.20.1.1.1"><msub id="S4.E1.m1.51.51.1.51.20.20.20.1.1.1.1"><mi id="S4.E1.m1.4.4.4.4.4.4">o</mi><mi id="S4.E1.m1.5.5.5.5.5.5.1">t</mi></msub><mo fence="false" id="S4.E1.m1.6.6.6.6.6.6">|</mo><msub id="S4.E1.m1.51.51.1.51.20.20.20.1.1.1.2"><mi id="S4.E1.m1.7.7.7.7.7.7">s</mi><mi id="S4.E1.m1.8.8.8.8.8.8.1">t</mi></msub></mrow><mo id="S4.E1.m1.9.9.9.9.9.9" stretchy="false">)</mo></mrow></mrow><mo id="S4.E1.m1.10.10.10.10.10.10">=</mo><mrow id="S4.E1.m1.52.52.2.52.21.21.21"><mtext id="S4.E1.m1.11.11.11.11.11.11">softmax</mtext><mo id="S4.E1.m1.52.52.2.52.21.21.21.2">⁢</mo><mrow id="S4.E1.m1.52.52.2.52.21.21.21.1.1"><mo id="S4.E1.m1.12.12.12.12.12.12" stretchy="false">(</mo><mrow id="S4.E1.m1.52.52.2.52.21.21.21.1.1.1"><msub id="S4.E1.m1.52.52.2.52.21.21.21.1.1.1.3"><mtext id="S4.E1.m1.13.13.13.13.13.13">MLP</mtext><mi id="S4.E1.m1.14.14.14.14.14.14.1">π</mi></msub><mo id="S4.E1.m1.52.52.2.52.21.21.21.1.1.1.2">⁢</mo><mrow id="S4.E1.m1.52.52.2.52.21.21.21.1.1.1.1.1"><mo id="S4.E1.m1.15.15.15.15.15.15" stretchy="false">(</mo><msub id="S4.E1.m1.52.52.2.52.21.21.21.1.1.1.1.1.1"><mi id="S4.E1.m1.16.16.16.16.16.16">𝐬</mi><mi id="S4.E1.m1.17.17.17.17.17.17.1">t</mi></msub><mo id="S4.E1.m1.18.18.18.18.18.18" stretchy="false">)</mo></mrow></mrow><mo id="S4.E1.m1.19.19.19.19.19.19" stretchy="false">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E1.m1.52.52.2c"><mtd id="S4.E1.m1.52.52.2d"><mrow id="S4.E1.m1.50.50.50.31.31"><msub id="S4.E1.m1.50.50.50.31.31.32"><mi id="S4.E1.m1.20.20.20.1.1.1">Q</mi><mi id="S4.E1.m1.21.21.21.2.2.2.1">θ</mi></msub><mrow id="S4.E1.m1.50.50.50.31.31.33"><mo id="S4.E1.m1.22.22.22.3.3.3" stretchy="false">(</mo><msub id="S4.E1.m1.50.50.50.31.31.33.1"><mi id="S4.E1.m1.23.23.23.4.4.4">a</mi><mi id="S4.E1.m1.24.24.24.5.5.5.1">t</mi></msub><mo fence="false" id="S4.E1.m1.25.25.25.6.6.6" rspace="0.167em" stretchy="false">|</mo><msub id="S4.E1.m1.50.50.50.31.31.33.2"><mi id="S4.E1.m1.26.26.26.7.7.7">s</mi><mi id="S4.E1.m1.27.27.27.8.8.8.1">t</mi></msub><mo id="S4.E1.m1.28.28.28.9.9.9">,</mo><msub id="S4.E1.m1.50.50.50.31.31.33.3"><mi id="S4.E1.m1.29.29.29.10.10.10">o</mi><mi id="S4.E1.m1.30.30.30.11.11.11.1">t</mi></msub><mo id="S4.E1.m1.31.31.31.12.12.12" stretchy="false">)</mo></mrow><mo id="S4.E1.m1.32.32.32.13.13.13">=</mo><msub id="S4.E1.m1.50.50.50.31.31.34"><mtext id="S4.E1.m1.33.33.33.14.14.14">MLP</mtext><mi id="S4.E1.m1.34.34.34.15.15.15.1">A</mi></msub><mrow id="S4.E1.m1.50.50.50.31.31.35"><mo id="S4.E1.m1.35.35.35.16.16.16" stretchy="false">(</mo><msub id="S4.E1.m1.50.50.50.31.31.35.1"><mi id="S4.E1.m1.36.36.36.17.17.17">𝐬</mi><mi id="S4.E1.m1.37.37.37.18.18.18.1">t</mi></msub><mo fence="false" id="S4.E1.m1.38.38.38.19.19.19" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S4.E1.m1.39.39.39.20.20.20" rspace="0.167em" stretchy="false">|</mo><msub id="S4.E1.m1.50.50.50.31.31.35.2"><mi id="S4.E1.m1.40.40.40.21.21.21">𝐚</mi><mi id="S4.E1.m1.41.41.41.22.22.22.1">t</mi></msub><mo id="S4.E1.m1.42.42.42.23.23.23" stretchy="false">)</mo></mrow><mo id="S4.E1.m1.43.43.43.24.24.24" lspace="0.052em" rspace="0.052em">+</mo><msub id="S4.E1.m1.50.50.50.31.31.36"><mtext id="S4.E1.m1.44.44.44.25.25.25">MLP</mtext><mi id="S4.E1.m1.45.45.45.26.26.26.1">V</mi></msub><mrow id="S4.E1.m1.50.50.50.31.31.37"><mo id="S4.E1.m1.46.46.46.27.27.27" stretchy="false">(</mo><msub id="S4.E1.m1.50.50.50.31.31.37.1"><mi id="S4.E1.m1.47.47.47.28.28.28">𝐬</mi><mi id="S4.E1.m1.48.48.48.29.29.29.1">t</mi></msub><mo id="S4.E1.m1.49.49.49.30.30.30" stretchy="false">)</mo></mrow><mo id="S4.E1.m1.50.50.50.31.31.31">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S4.E1.m1.52b">\begin{gathered}\pi_{\phi}(o_{t}|s_{t})=\text{softmax}(\text{MLP}_{\pi}(%
\mathbf{s}_{t}))\\
Q_{\theta}(a_{t}|s_{t},o_{t})=\text{MLP}_{A}(\mathbf{s}_{t}||\mathbf{a}_{t})\!%
+\!\text{MLP}_{V}(\mathbf{s}_{t}),\end{gathered}</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.52c">start_ROW start_CELL italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = softmax ( MLP start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT ( bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) end_CELL end_ROW start_ROW start_CELL italic_Q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = MLP start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT ( bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | | bold_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + MLP start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ( bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.12">where MLP denotes a two-layer perceptron, <math alttext="\mathbf{a}_{t}=\mathbf{e}_{p}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.8.m1.1"><semantics id="S4.SS2.SSS0.Px2.p1.8.m1.1a"><mrow id="S4.SS2.SSS0.Px2.p1.8.m1.1.1" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.cmml"><msub id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2.2" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2.2.cmml">𝐚</mi><mi id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2.3" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2.3.cmml">t</mi></msub><mo id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.1" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.1.cmml">=</mo><msub id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3.2" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3.2.cmml">𝐞</mi><mi id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3.3" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.8.m1.1b"><apply id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1"><eq id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.1"></eq><apply id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2.2">𝐚</ci><ci id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.2.3">𝑡</ci></apply><apply id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3.2">𝐞</ci><ci id="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p1.8.m1.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.8.m1.1c">\mathbf{a}_{t}=\mathbf{e}_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.8.m1.1d">bold_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = bold_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> or <math alttext="\mathbf{a}_{t}=\mathbf{e}_{v}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.9.m2.1"><semantics id="S4.SS2.SSS0.Px2.p1.9.m2.1a"><mrow id="S4.SS2.SSS0.Px2.p1.9.m2.1.1" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.cmml"><msub id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2.2" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2.2.cmml">𝐚</mi><mi id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2.3" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2.3.cmml">t</mi></msub><mo id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.1" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.1.cmml">=</mo><msub id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3.2" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3.2.cmml">𝐞</mi><mi id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3.3" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.9.m2.1b"><apply id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1"><eq id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.1"></eq><apply id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2.2">𝐚</ci><ci id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.2.3">𝑡</ci></apply><apply id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3.2">𝐞</ci><ci id="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p1.9.m2.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.9.m2.1c">\mathbf{a}_{t}=\mathbf{e}_{v}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.9.m2.1d">bold_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = bold_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> denotes the embedding of actions (attribute value or item) at the <math alttext="t" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.10.m3.1"><semantics id="S4.SS2.SSS0.Px2.p1.10.m3.1a"><mi id="S4.SS2.SSS0.Px2.p1.10.m3.1.1" xref="S4.SS2.SSS0.Px2.p1.10.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.10.m3.1b"><ci id="S4.SS2.SSS0.Px2.p1.10.m3.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.10.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.10.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.10.m3.1d">italic_t</annotation></semantics></math>-th turn, <math alttext="A" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.11.m4.1"><semantics id="S4.SS2.SSS0.Px2.p1.11.m4.1a"><mi id="S4.SS2.SSS0.Px2.p1.11.m4.1.1" xref="S4.SS2.SSS0.Px2.p1.11.m4.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.11.m4.1b"><ci id="S4.SS2.SSS0.Px2.p1.11.m4.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.11.m4.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.11.m4.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.11.m4.1d">italic_A</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.12.m5.1"><semantics id="S4.SS2.SSS0.Px2.p1.12.m5.1a"><mi id="S4.SS2.SSS0.Px2.p1.12.m5.1.1" xref="S4.SS2.SSS0.Px2.p1.12.m5.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.12.m5.1b"><ci id="S4.SS2.SSS0.Px2.p1.12.m5.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.12.m5.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.12.m5.1c">V</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.12.m5.1d">italic_V</annotation></semantics></math> denote the advantage and value function of the dueling Q-network <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib47" title="">2016</a>)</cite> respectively.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span><span class="ltx_text" id="S4.SS3.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS3.1.1.m1.1"><semantics id="S4.SS3.1.1.m1.1b"><mrow id="S4.SS3.1.1.m1.1.1" xref="S4.SS3.1.1.m1.1.1.cmml"><mi id="S4.SS3.1.1.m1.1.1.2" xref="S4.SS3.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS3.1.1.m1.1.1.1" xref="S4.SS3.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS3.1.1.m1.1.1.3" xref="S4.SS3.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.1.1.m1.1c"><apply id="S4.SS3.1.1.m1.1.1.cmml" xref="S4.SS3.1.1.m1.1.1"><times id="S4.SS3.1.1.m1.1.1.1.cmml" xref="S4.SS3.1.1.m1.1.1.1"></times><ci id="S4.SS3.1.1.m1.1.1.2.cmml" xref="S4.SS3.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS3.1.1.m1.1.1.3a.cmml" xref="S4.SS3.1.1.m1.1.1.3"><mtext id="S4.SS3.1.1.m1.1.1.3.cmml" xref="S4.SS3.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.1.1.m1.1d">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.1.1.m1.1e">typewriter_S -planner</annotation></semantics></math></span>
</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.28"><span class="ltx_text" id="S4.SS3.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS3.p1.1.1.m1.1"><semantics id="S4.SS3.p1.1.1.m1.1a"><mrow id="S4.SS3.p1.1.1.m1.1.1" xref="S4.SS3.p1.1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.1.m1.1.1.2" xref="S4.SS3.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS3.p1.1.1.m1.1.1.1" xref="S4.SS3.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS3.p1.1.1.m1.1.1.3" xref="S4.SS3.p1.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.1.m1.1b"><apply id="S4.SS3.p1.1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.1.m1.1.1"><times id="S4.SS3.p1.1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.1.m1.1.1.1"></times><ci id="S4.SS3.p1.1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS3.p1.1.1.m1.1.1.3a.cmml" xref="S4.SS3.p1.1.1.m1.1.1.3"><mtext id="S4.SS3.p1.1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> adopts an MCTS-based planning algorithm to simulate conversations and find the best conversation plan for each user, strategically balancing exploration and exploitation to efficiently expand a search tree <cite class="ltx_cite ltx_citemacro_cite">Kocsis and Szepesvári (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib23" title="">2006</a>); Coulom (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib10" title="">2007</a>)</cite>. Specifically, each node in the tree represents a state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m1.1"><semantics id="S4.SS3.p1.2.m1.1a"><msub id="S4.SS3.p1.2.m1.1.1" xref="S4.SS3.p1.2.m1.1.1.cmml"><mi id="S4.SS3.p1.2.m1.1.1.2" xref="S4.SS3.p1.2.m1.1.1.2.cmml">s</mi><mi id="S4.SS3.p1.2.m1.1.1.3" xref="S4.SS3.p1.2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m1.1b"><apply id="S4.SS3.p1.2.m1.1.1.cmml" xref="S4.SS3.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m1.1.1.1.cmml" xref="S4.SS3.p1.2.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m1.1.1.2.cmml" xref="S4.SS3.p1.2.m1.1.1.2">𝑠</ci><ci id="S4.SS3.p1.2.m1.1.1.3.cmml" xref="S4.SS3.p1.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, the root node <math alttext="s_{0}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m2.1"><semantics id="S4.SS3.p1.3.m2.1a"><msub id="S4.SS3.p1.3.m2.1.1" xref="S4.SS3.p1.3.m2.1.1.cmml"><mi id="S4.SS3.p1.3.m2.1.1.2" xref="S4.SS3.p1.3.m2.1.1.2.cmml">s</mi><mn id="S4.SS3.p1.3.m2.1.1.3" xref="S4.SS3.p1.3.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m2.1b"><apply id="S4.SS3.p1.3.m2.1.1.cmml" xref="S4.SS3.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m2.1.1.1.cmml" xref="S4.SS3.p1.3.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.3.m2.1.1.2.cmml" xref="S4.SS3.p1.3.m2.1.1.2">𝑠</ci><cn id="S4.SS3.p1.3.m2.1.1.3.cmml" type="integer" xref="S4.SS3.p1.3.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m2.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m2.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> represents the initial state where the user specifies preference on an attribute type and its corresponding value, and the leaf node represents the end of the conversation (success or fail). Each edge between nodes <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m3.1"><semantics id="S4.SS3.p1.4.m3.1a"><msub id="S4.SS3.p1.4.m3.1.1" xref="S4.SS3.p1.4.m3.1.1.cmml"><mi id="S4.SS3.p1.4.m3.1.1.2" xref="S4.SS3.p1.4.m3.1.1.2.cmml">s</mi><mi id="S4.SS3.p1.4.m3.1.1.3" xref="S4.SS3.p1.4.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m3.1b"><apply id="S4.SS3.p1.4.m3.1.1.cmml" xref="S4.SS3.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m3.1.1.1.cmml" xref="S4.SS3.p1.4.m3.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m3.1.1.2.cmml" xref="S4.SS3.p1.4.m3.1.1.2">𝑠</ci><ci id="S4.SS3.p1.4.m3.1.1.3.cmml" xref="S4.SS3.p1.4.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m3.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m3.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m4.1"><semantics id="S4.SS3.p1.5.m4.1a"><msub id="S4.SS3.p1.5.m4.1.1" xref="S4.SS3.p1.5.m4.1.1.cmml"><mi id="S4.SS3.p1.5.m4.1.1.2" xref="S4.SS3.p1.5.m4.1.1.2.cmml">s</mi><mrow id="S4.SS3.p1.5.m4.1.1.3" xref="S4.SS3.p1.5.m4.1.1.3.cmml"><mi id="S4.SS3.p1.5.m4.1.1.3.2" xref="S4.SS3.p1.5.m4.1.1.3.2.cmml">t</mi><mo id="S4.SS3.p1.5.m4.1.1.3.1" xref="S4.SS3.p1.5.m4.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p1.5.m4.1.1.3.3" xref="S4.SS3.p1.5.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m4.1b"><apply id="S4.SS3.p1.5.m4.1.1.cmml" xref="S4.SS3.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m4.1.1.1.cmml" xref="S4.SS3.p1.5.m4.1.1">subscript</csymbol><ci id="S4.SS3.p1.5.m4.1.1.2.cmml" xref="S4.SS3.p1.5.m4.1.1.2">𝑠</ci><apply id="S4.SS3.p1.5.m4.1.1.3.cmml" xref="S4.SS3.p1.5.m4.1.1.3"><plus id="S4.SS3.p1.5.m4.1.1.3.1.cmml" xref="S4.SS3.p1.5.m4.1.1.3.1"></plus><ci id="S4.SS3.p1.5.m4.1.1.3.2.cmml" xref="S4.SS3.p1.5.m4.1.1.3.2">𝑡</ci><cn id="S4.SS3.p1.5.m4.1.1.3.3.cmml" type="integer" xref="S4.SS3.p1.5.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m4.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.5.m4.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> represents an action type <math alttext="o_{t}\in\{\mathtt{ask}" class="ltx_math_unparsed" display="inline" id="S4.SS3.p1.6.m5.1"><semantics id="S4.SS3.p1.6.m5.1a"><mrow id="S4.SS3.p1.6.m5.1b"><msub id="S4.SS3.p1.6.m5.1.1"><mi id="S4.SS3.p1.6.m5.1.1.2">o</mi><mi id="S4.SS3.p1.6.m5.1.1.3">t</mi></msub><mo id="S4.SS3.p1.6.m5.1.2">∈</mo><mrow id="S4.SS3.p1.6.m5.1.3"><mo id="S4.SS3.p1.6.m5.1.3.1" stretchy="false">{</mo><mi id="S4.SS3.p1.6.m5.1.3.2">𝚊𝚜𝚔</mi></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m5.1c">o_{t}\in\{\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.6.m5.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ { typewriter_ask</annotation></semantics></math>, <math alttext="\mathtt{rec}\}" class="ltx_math_unparsed" display="inline" id="S4.SS3.p1.7.m6.1"><semantics id="S4.SS3.p1.7.m6.1a"><mrow id="S4.SS3.p1.7.m6.1b"><mi id="S4.SS3.p1.7.m6.1.1">𝚛𝚎𝚌</mi><mo id="S4.SS3.p1.7.m6.1.2" stretchy="false">}</mo></mrow><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m6.1c">\mathtt{rec}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.7.m6.1d">typewriter_rec }</annotation></semantics></math> and the transition from the current state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.8.m7.1"><semantics id="S4.SS3.p1.8.m7.1a"><msub id="S4.SS3.p1.8.m7.1.1" xref="S4.SS3.p1.8.m7.1.1.cmml"><mi id="S4.SS3.p1.8.m7.1.1.2" xref="S4.SS3.p1.8.m7.1.1.2.cmml">s</mi><mi id="S4.SS3.p1.8.m7.1.1.3" xref="S4.SS3.p1.8.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m7.1b"><apply id="S4.SS3.p1.8.m7.1.1.cmml" xref="S4.SS3.p1.8.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m7.1.1.1.cmml" xref="S4.SS3.p1.8.m7.1.1">subscript</csymbol><ci id="S4.SS3.p1.8.m7.1.1.2.cmml" xref="S4.SS3.p1.8.m7.1.1.2">𝑠</ci><ci id="S4.SS3.p1.8.m7.1.1.3.cmml" xref="S4.SS3.p1.8.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m7.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.8.m7.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to the next state <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S4.SS3.p1.9.m8.1"><semantics id="S4.SS3.p1.9.m8.1a"><msub id="S4.SS3.p1.9.m8.1.1" xref="S4.SS3.p1.9.m8.1.1.cmml"><mi id="S4.SS3.p1.9.m8.1.1.2" xref="S4.SS3.p1.9.m8.1.1.2.cmml">s</mi><mrow id="S4.SS3.p1.9.m8.1.1.3" xref="S4.SS3.p1.9.m8.1.1.3.cmml"><mi id="S4.SS3.p1.9.m8.1.1.3.2" xref="S4.SS3.p1.9.m8.1.1.3.2.cmml">t</mi><mo id="S4.SS3.p1.9.m8.1.1.3.1" xref="S4.SS3.p1.9.m8.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p1.9.m8.1.1.3.3" xref="S4.SS3.p1.9.m8.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m8.1b"><apply id="S4.SS3.p1.9.m8.1.1.cmml" xref="S4.SS3.p1.9.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m8.1.1.1.cmml" xref="S4.SS3.p1.9.m8.1.1">subscript</csymbol><ci id="S4.SS3.p1.9.m8.1.1.2.cmml" xref="S4.SS3.p1.9.m8.1.1.2">𝑠</ci><apply id="S4.SS3.p1.9.m8.1.1.3.cmml" xref="S4.SS3.p1.9.m8.1.1.3"><plus id="S4.SS3.p1.9.m8.1.1.3.1.cmml" xref="S4.SS3.p1.9.m8.1.1.3.1"></plus><ci id="S4.SS3.p1.9.m8.1.1.3.2.cmml" xref="S4.SS3.p1.9.m8.1.1.3.2">𝑡</ci><cn id="S4.SS3.p1.9.m8.1.1.3.3.cmml" type="integer" xref="S4.SS3.p1.9.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m8.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.9.m8.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> after choosing an action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.10.m9.1"><semantics id="S4.SS3.p1.10.m9.1a"><msub id="S4.SS3.p1.10.m9.1.1" xref="S4.SS3.p1.10.m9.1.1.cmml"><mi id="S4.SS3.p1.10.m9.1.1.2" xref="S4.SS3.p1.10.m9.1.1.2.cmml">o</mi><mi id="S4.SS3.p1.10.m9.1.1.3" xref="S4.SS3.p1.10.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m9.1b"><apply id="S4.SS3.p1.10.m9.1.1.cmml" xref="S4.SS3.p1.10.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m9.1.1.1.cmml" xref="S4.SS3.p1.10.m9.1.1">subscript</csymbol><ci id="S4.SS3.p1.10.m9.1.1.2.cmml" xref="S4.SS3.p1.10.m9.1.1.2">𝑜</ci><ci id="S4.SS3.p1.10.m9.1.1.3.cmml" xref="S4.SS3.p1.10.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m9.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.10.m9.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and a specific action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.11.m10.1"><semantics id="S4.SS3.p1.11.m10.1a"><msub id="S4.SS3.p1.11.m10.1.1" xref="S4.SS3.p1.11.m10.1.1.cmml"><mi id="S4.SS3.p1.11.m10.1.1.2" xref="S4.SS3.p1.11.m10.1.1.2.cmml">a</mi><mi id="S4.SS3.p1.11.m10.1.1.3" xref="S4.SS3.p1.11.m10.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m10.1b"><apply id="S4.SS3.p1.11.m10.1.1.cmml" xref="S4.SS3.p1.11.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.11.m10.1.1.1.cmml" xref="S4.SS3.p1.11.m10.1.1">subscript</csymbol><ci id="S4.SS3.p1.11.m10.1.1.2.cmml" xref="S4.SS3.p1.11.m10.1.1.2">𝑎</ci><ci id="S4.SS3.p1.11.m10.1.1.3.cmml" xref="S4.SS3.p1.11.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.11.m10.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.11.m10.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. For each action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.12.m11.1"><semantics id="S4.SS3.p1.12.m11.1a"><msub id="S4.SS3.p1.12.m11.1.1" xref="S4.SS3.p1.12.m11.1.1.cmml"><mi id="S4.SS3.p1.12.m11.1.1.2" xref="S4.SS3.p1.12.m11.1.1.2.cmml">o</mi><mi id="S4.SS3.p1.12.m11.1.1.3" xref="S4.SS3.p1.12.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.12.m11.1b"><apply id="S4.SS3.p1.12.m11.1.1.cmml" xref="S4.SS3.p1.12.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m11.1.1.1.cmml" xref="S4.SS3.p1.12.m11.1.1">subscript</csymbol><ci id="S4.SS3.p1.12.m11.1.1.2.cmml" xref="S4.SS3.p1.12.m11.1.1.2">𝑜</ci><ci id="S4.SS3.p1.12.m11.1.1.3.cmml" xref="S4.SS3.p1.12.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.12.m11.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.12.m11.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <span class="ltx_text" id="S4.SS3.p1.13.2"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS3.p1.13.2.m1.1"><semantics id="S4.SS3.p1.13.2.m1.1a"><mrow id="S4.SS3.p1.13.2.m1.1.1" xref="S4.SS3.p1.13.2.m1.1.1.cmml"><mi id="S4.SS3.p1.13.2.m1.1.1.2" xref="S4.SS3.p1.13.2.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS3.p1.13.2.m1.1.1.1" xref="S4.SS3.p1.13.2.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS3.p1.13.2.m1.1.1.3" xref="S4.SS3.p1.13.2.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.13.2.m1.1b"><apply id="S4.SS3.p1.13.2.m1.1.1.cmml" xref="S4.SS3.p1.13.2.m1.1.1"><times id="S4.SS3.p1.13.2.m1.1.1.1.cmml" xref="S4.SS3.p1.13.2.m1.1.1.1"></times><ci id="S4.SS3.p1.13.2.m1.1.1.2.cmml" xref="S4.SS3.p1.13.2.m1.1.1.2">𝚂</ci><ci id="S4.SS3.p1.13.2.m1.1.1.3a.cmml" xref="S4.SS3.p1.13.2.m1.1.1.3"><mtext id="S4.SS3.p1.13.2.m1.1.1.3.cmml" xref="S4.SS3.p1.13.2.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.13.2.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.13.2.m1.1d">typewriter_S -planner</annotation></semantics></math></span> maintains a function <math alttext="q(s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS3.p1.14.m12.2"><semantics id="S4.SS3.p1.14.m12.2a"><mrow id="S4.SS3.p1.14.m12.2.2" xref="S4.SS3.p1.14.m12.2.2.cmml"><mi id="S4.SS3.p1.14.m12.2.2.4" xref="S4.SS3.p1.14.m12.2.2.4.cmml">q</mi><mo id="S4.SS3.p1.14.m12.2.2.3" xref="S4.SS3.p1.14.m12.2.2.3.cmml">⁢</mo><mrow id="S4.SS3.p1.14.m12.2.2.2.2" xref="S4.SS3.p1.14.m12.2.2.2.3.cmml"><mo id="S4.SS3.p1.14.m12.2.2.2.2.3" stretchy="false" xref="S4.SS3.p1.14.m12.2.2.2.3.cmml">(</mo><msub id="S4.SS3.p1.14.m12.1.1.1.1.1" xref="S4.SS3.p1.14.m12.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.14.m12.1.1.1.1.1.2" xref="S4.SS3.p1.14.m12.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.p1.14.m12.1.1.1.1.1.3" xref="S4.SS3.p1.14.m12.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.p1.14.m12.2.2.2.2.4" xref="S4.SS3.p1.14.m12.2.2.2.3.cmml">,</mo><msub id="S4.SS3.p1.14.m12.2.2.2.2.2" xref="S4.SS3.p1.14.m12.2.2.2.2.2.cmml"><mi id="S4.SS3.p1.14.m12.2.2.2.2.2.2" xref="S4.SS3.p1.14.m12.2.2.2.2.2.2.cmml">o</mi><mi id="S4.SS3.p1.14.m12.2.2.2.2.2.3" xref="S4.SS3.p1.14.m12.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS3.p1.14.m12.2.2.2.2.5" stretchy="false" xref="S4.SS3.p1.14.m12.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.14.m12.2b"><apply id="S4.SS3.p1.14.m12.2.2.cmml" xref="S4.SS3.p1.14.m12.2.2"><times id="S4.SS3.p1.14.m12.2.2.3.cmml" xref="S4.SS3.p1.14.m12.2.2.3"></times><ci id="S4.SS3.p1.14.m12.2.2.4.cmml" xref="S4.SS3.p1.14.m12.2.2.4">𝑞</ci><interval closure="open" id="S4.SS3.p1.14.m12.2.2.2.3.cmml" xref="S4.SS3.p1.14.m12.2.2.2.2"><apply id="S4.SS3.p1.14.m12.1.1.1.1.1.cmml" xref="S4.SS3.p1.14.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.14.m12.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.14.m12.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.14.m12.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.14.m12.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.p1.14.m12.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.14.m12.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS3.p1.14.m12.2.2.2.2.2.cmml" xref="S4.SS3.p1.14.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.14.m12.2.2.2.2.2.1.cmml" xref="S4.SS3.p1.14.m12.2.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p1.14.m12.2.2.2.2.2.2.cmml" xref="S4.SS3.p1.14.m12.2.2.2.2.2.2">𝑜</ci><ci id="S4.SS3.p1.14.m12.2.2.2.2.2.3.cmml" xref="S4.SS3.p1.14.m12.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.14.m12.2c">q(s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.14.m12.2d">italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> of <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.15.m13.1"><semantics id="S4.SS3.p1.15.m13.1a"><msub id="S4.SS3.p1.15.m13.1.1" xref="S4.SS3.p1.15.m13.1.1.cmml"><mi id="S4.SS3.p1.15.m13.1.1.2" xref="S4.SS3.p1.15.m13.1.1.2.cmml">s</mi><mi id="S4.SS3.p1.15.m13.1.1.3" xref="S4.SS3.p1.15.m13.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.15.m13.1b"><apply id="S4.SS3.p1.15.m13.1.1.cmml" xref="S4.SS3.p1.15.m13.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.15.m13.1.1.1.cmml" xref="S4.SS3.p1.15.m13.1.1">subscript</csymbol><ci id="S4.SS3.p1.15.m13.1.1.2.cmml" xref="S4.SS3.p1.15.m13.1.1.2">𝑠</ci><ci id="S4.SS3.p1.15.m13.1.1.3.cmml" xref="S4.SS3.p1.15.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.15.m13.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.15.m13.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="o_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.16.m14.1"><semantics id="S4.SS3.p1.16.m14.1a"><msub id="S4.SS3.p1.16.m14.1.1" xref="S4.SS3.p1.16.m14.1.1.cmml"><mi id="S4.SS3.p1.16.m14.1.1.2" xref="S4.SS3.p1.16.m14.1.1.2.cmml">o</mi><mi id="S4.SS3.p1.16.m14.1.1.3" xref="S4.SS3.p1.16.m14.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.16.m14.1b"><apply id="S4.SS3.p1.16.m14.1.1.cmml" xref="S4.SS3.p1.16.m14.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.16.m14.1.1.1.cmml" xref="S4.SS3.p1.16.m14.1.1">subscript</csymbol><ci id="S4.SS3.p1.16.m14.1.1.2.cmml" xref="S4.SS3.p1.16.m14.1.1.2">𝑜</ci><ci id="S4.SS3.p1.16.m14.1.1.3.cmml" xref="S4.SS3.p1.16.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.16.m14.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.16.m14.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as the expected future reward of selecting action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.17.m15.1"><semantics id="S4.SS3.p1.17.m15.1a"><msub id="S4.SS3.p1.17.m15.1.1" xref="S4.SS3.p1.17.m15.1.1.cmml"><mi id="S4.SS3.p1.17.m15.1.1.2" xref="S4.SS3.p1.17.m15.1.1.2.cmml">o</mi><mi id="S4.SS3.p1.17.m15.1.1.3" xref="S4.SS3.p1.17.m15.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.17.m15.1b"><apply id="S4.SS3.p1.17.m15.1.1.cmml" xref="S4.SS3.p1.17.m15.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.17.m15.1.1.1.cmml" xref="S4.SS3.p1.17.m15.1.1">subscript</csymbol><ci id="S4.SS3.p1.17.m15.1.1.2.cmml" xref="S4.SS3.p1.17.m15.1.1.2">𝑜</ci><ci id="S4.SS3.p1.17.m15.1.1.3.cmml" xref="S4.SS3.p1.17.m15.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.17.m15.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.17.m15.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at the state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.18.m16.1"><semantics id="S4.SS3.p1.18.m16.1a"><msub id="S4.SS3.p1.18.m16.1.1" xref="S4.SS3.p1.18.m16.1.1.cmml"><mi id="S4.SS3.p1.18.m16.1.1.2" xref="S4.SS3.p1.18.m16.1.1.2.cmml">s</mi><mi id="S4.SS3.p1.18.m16.1.1.3" xref="S4.SS3.p1.18.m16.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.18.m16.1b"><apply id="S4.SS3.p1.18.m16.1.1.cmml" xref="S4.SS3.p1.18.m16.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.18.m16.1.1.1.cmml" xref="S4.SS3.p1.18.m16.1.1">subscript</csymbol><ci id="S4.SS3.p1.18.m16.1.1.2.cmml" xref="S4.SS3.p1.18.m16.1.1.2">𝑠</ci><ci id="S4.SS3.p1.18.m16.1.1.3.cmml" xref="S4.SS3.p1.18.m16.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.18.m16.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.18.m16.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. For each user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS3.p1.19.m17.1"><semantics id="S4.SS3.p1.19.m17.1a"><mi id="S4.SS3.p1.19.m17.1.1" xref="S4.SS3.p1.19.m17.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.19.m17.1b"><ci id="S4.SS3.p1.19.m17.1.1.cmml" xref="S4.SS3.p1.19.m17.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.19.m17.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.19.m17.1d">italic_u</annotation></semantics></math>, <span class="ltx_text" id="S4.SS3.p1.20.3"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS3.p1.20.3.m1.1"><semantics id="S4.SS3.p1.20.3.m1.1a"><mrow id="S4.SS3.p1.20.3.m1.1.1" xref="S4.SS3.p1.20.3.m1.1.1.cmml"><mi id="S4.SS3.p1.20.3.m1.1.1.2" xref="S4.SS3.p1.20.3.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS3.p1.20.3.m1.1.1.1" xref="S4.SS3.p1.20.3.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS3.p1.20.3.m1.1.1.3" xref="S4.SS3.p1.20.3.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.20.3.m1.1b"><apply id="S4.SS3.p1.20.3.m1.1.1.cmml" xref="S4.SS3.p1.20.3.m1.1.1"><times id="S4.SS3.p1.20.3.m1.1.1.1.cmml" xref="S4.SS3.p1.20.3.m1.1.1.1"></times><ci id="S4.SS3.p1.20.3.m1.1.1.2.cmml" xref="S4.SS3.p1.20.3.m1.1.1.2">𝚂</ci><ci id="S4.SS3.p1.20.3.m1.1.1.3a.cmml" xref="S4.SS3.p1.20.3.m1.1.1.3"><mtext id="S4.SS3.p1.20.3.m1.1.1.3.cmml" xref="S4.SS3.p1.20.3.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.20.3.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.20.3.m1.1d">typewriter_S -planner</annotation></semantics></math></span> simulates <math alttext="N" class="ltx_Math" display="inline" id="S4.SS3.p1.21.m18.1"><semantics id="S4.SS3.p1.21.m18.1a"><mi id="S4.SS3.p1.21.m18.1.1" xref="S4.SS3.p1.21.m18.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.21.m18.1b"><ci id="S4.SS3.p1.21.m18.1.1.cmml" xref="S4.SS3.p1.21.m18.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.21.m18.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.21.m18.1d">italic_N</annotation></semantics></math> different conversation plans (also referred to as trajectories), and the trajectory for the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS3.p1.22.m19.1"><semantics id="S4.SS3.p1.22.m19.1a"><mi id="S4.SS3.p1.22.m19.1.1" xref="S4.SS3.p1.22.m19.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.22.m19.1b"><ci id="S4.SS3.p1.22.m19.1.1.cmml" xref="S4.SS3.p1.22.m19.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.22.m19.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.22.m19.1d">italic_i</annotation></semantics></math>-th simulation is denoted as <math alttext="\tau_{i}^{(u)}" class="ltx_Math" display="inline" id="S4.SS3.p1.23.m20.1"><semantics id="S4.SS3.p1.23.m20.1a"><msubsup id="S4.SS3.p1.23.m20.1.2" xref="S4.SS3.p1.23.m20.1.2.cmml"><mi id="S4.SS3.p1.23.m20.1.2.2.2" xref="S4.SS3.p1.23.m20.1.2.2.2.cmml">τ</mi><mi id="S4.SS3.p1.23.m20.1.2.2.3" xref="S4.SS3.p1.23.m20.1.2.2.3.cmml">i</mi><mrow id="S4.SS3.p1.23.m20.1.1.1.3" xref="S4.SS3.p1.23.m20.1.2.cmml"><mo id="S4.SS3.p1.23.m20.1.1.1.3.1" stretchy="false" xref="S4.SS3.p1.23.m20.1.2.cmml">(</mo><mi id="S4.SS3.p1.23.m20.1.1.1.1" xref="S4.SS3.p1.23.m20.1.1.1.1.cmml">u</mi><mo id="S4.SS3.p1.23.m20.1.1.1.3.2" stretchy="false" xref="S4.SS3.p1.23.m20.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.23.m20.1b"><apply id="S4.SS3.p1.23.m20.1.2.cmml" xref="S4.SS3.p1.23.m20.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.23.m20.1.2.1.cmml" xref="S4.SS3.p1.23.m20.1.2">superscript</csymbol><apply id="S4.SS3.p1.23.m20.1.2.2.cmml" xref="S4.SS3.p1.23.m20.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.23.m20.1.2.2.1.cmml" xref="S4.SS3.p1.23.m20.1.2">subscript</csymbol><ci id="S4.SS3.p1.23.m20.1.2.2.2.cmml" xref="S4.SS3.p1.23.m20.1.2.2.2">𝜏</ci><ci id="S4.SS3.p1.23.m20.1.2.2.3.cmml" xref="S4.SS3.p1.23.m20.1.2.2.3">𝑖</ci></apply><ci id="S4.SS3.p1.23.m20.1.1.1.1.cmml" xref="S4.SS3.p1.23.m20.1.1.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.23.m20.1c">\tau_{i}^{(u)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.23.m20.1d">italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT</annotation></semantics></math>, which contains a sequence of state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.24.m21.1"><semantics id="S4.SS3.p1.24.m21.1a"><msub id="S4.SS3.p1.24.m21.1.1" xref="S4.SS3.p1.24.m21.1.1.cmml"><mi id="S4.SS3.p1.24.m21.1.1.2" xref="S4.SS3.p1.24.m21.1.1.2.cmml">s</mi><mi id="S4.SS3.p1.24.m21.1.1.3" xref="S4.SS3.p1.24.m21.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.24.m21.1b"><apply id="S4.SS3.p1.24.m21.1.1.cmml" xref="S4.SS3.p1.24.m21.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.24.m21.1.1.1.cmml" xref="S4.SS3.p1.24.m21.1.1">subscript</csymbol><ci id="S4.SS3.p1.24.m21.1.1.2.cmml" xref="S4.SS3.p1.24.m21.1.1.2">𝑠</ci><ci id="S4.SS3.p1.24.m21.1.1.3.cmml" xref="S4.SS3.p1.24.m21.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.24.m21.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.24.m21.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.25.m22.1"><semantics id="S4.SS3.p1.25.m22.1a"><msub id="S4.SS3.p1.25.m22.1.1" xref="S4.SS3.p1.25.m22.1.1.cmml"><mi id="S4.SS3.p1.25.m22.1.1.2" xref="S4.SS3.p1.25.m22.1.1.2.cmml">o</mi><mi id="S4.SS3.p1.25.m22.1.1.3" xref="S4.SS3.p1.25.m22.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.25.m22.1b"><apply id="S4.SS3.p1.25.m22.1.1.cmml" xref="S4.SS3.p1.25.m22.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.25.m22.1.1.1.cmml" xref="S4.SS3.p1.25.m22.1.1">subscript</csymbol><ci id="S4.SS3.p1.25.m22.1.1.2.cmml" xref="S4.SS3.p1.25.m22.1.1.2">𝑜</ci><ci id="S4.SS3.p1.25.m22.1.1.3.cmml" xref="S4.SS3.p1.25.m22.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.25.m22.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.25.m22.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.26.m23.1"><semantics id="S4.SS3.p1.26.m23.1a"><msub id="S4.SS3.p1.26.m23.1.1" xref="S4.SS3.p1.26.m23.1.1.cmml"><mi id="S4.SS3.p1.26.m23.1.1.2" xref="S4.SS3.p1.26.m23.1.1.2.cmml">a</mi><mi id="S4.SS3.p1.26.m23.1.1.3" xref="S4.SS3.p1.26.m23.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.26.m23.1b"><apply id="S4.SS3.p1.26.m23.1.1.cmml" xref="S4.SS3.p1.26.m23.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.26.m23.1.1.1.cmml" xref="S4.SS3.p1.26.m23.1.1">subscript</csymbol><ci id="S4.SS3.p1.26.m23.1.1.2.cmml" xref="S4.SS3.p1.26.m23.1.1.2">𝑎</ci><ci id="S4.SS3.p1.26.m23.1.1.3.cmml" xref="S4.SS3.p1.26.m23.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.26.m23.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.26.m23.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and immediate reward <math alttext="r_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.27.m24.1"><semantics id="S4.SS3.p1.27.m24.1a"><msub id="S4.SS3.p1.27.m24.1.1" xref="S4.SS3.p1.27.m24.1.1.cmml"><mi id="S4.SS3.p1.27.m24.1.1.2" xref="S4.SS3.p1.27.m24.1.1.2.cmml">r</mi><mi id="S4.SS3.p1.27.m24.1.1.3" xref="S4.SS3.p1.27.m24.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.27.m24.1b"><apply id="S4.SS3.p1.27.m24.1.1.cmml" xref="S4.SS3.p1.27.m24.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.27.m24.1.1.1.cmml" xref="S4.SS3.p1.27.m24.1.1">subscript</csymbol><ci id="S4.SS3.p1.27.m24.1.1.2.cmml" xref="S4.SS3.p1.27.m24.1.1.2">𝑟</ci><ci id="S4.SS3.p1.27.m24.1.1.3.cmml" xref="S4.SS3.p1.27.m24.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.27.m24.1c">r_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.27.m24.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at each conversational turn <math alttext="t" class="ltx_Math" display="inline" id="S4.SS3.p1.28.m25.1"><semantics id="S4.SS3.p1.28.m25.1a"><mi id="S4.SS3.p1.28.m25.1.1" xref="S4.SS3.p1.28.m25.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.28.m25.1b"><ci id="S4.SS3.p1.28.m25.1.1.cmml" xref="S4.SS3.p1.28.m25.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.28.m25.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.28.m25.1d">italic_t</annotation></semantics></math>.
The search tree is built in four stages:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">Trajectory selection:
<span class="ltx_text" id="S4.I1.i1.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.1.m1.1"><semantics id="S4.I1.i1.p1.1.1.m1.1a"><mrow id="S4.I1.i1.p1.1.1.m1.1.1" xref="S4.I1.i1.p1.1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.I1.i1.p1.1.1.m1.1.1.1" xref="S4.I1.i1.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.I1.i1.p1.1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.1.m1.1b"><apply id="S4.I1.i1.p1.1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.1.m1.1.1"><times id="S4.I1.i1.p1.1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.1.m1.1.1.1"></times><ci id="S4.I1.i1.p1.1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.I1.i1.p1.1.1.m1.1.1.3a.cmml" xref="S4.I1.i1.p1.1.1.m1.1.1.3"><mtext id="S4.I1.i1.p1.1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> traverses from the root to leaves over the current tree to select the most promising trajectory that is likely to obtain a high cumulative reward.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.3">Node expansion:
<span class="ltx_text" id="S4.I1.i2.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.1.m1.1"><semantics id="S4.I1.i2.p1.1.1.m1.1a"><mrow id="S4.I1.i2.p1.1.1.m1.1.1" xref="S4.I1.i2.p1.1.1.m1.1.1.cmml"><mi id="S4.I1.i2.p1.1.1.m1.1.1.2" xref="S4.I1.i2.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.I1.i2.p1.1.1.m1.1.1.1" xref="S4.I1.i2.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.I1.i2.p1.1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.1.m1.1b"><apply id="S4.I1.i2.p1.1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.1.m1.1.1"><times id="S4.I1.i2.p1.1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.1.m1.1.1.1"></times><ci id="S4.I1.i2.p1.1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.I1.i2.p1.1.1.m1.1.1.3a.cmml" xref="S4.I1.i2.p1.1.1.m1.1.1.3"><mtext id="S4.I1.i2.p1.1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> initializes two children nodes (<math alttext="\mathtt{ask}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m1.1"><semantics id="S4.I1.i2.p1.2.m1.1a"><mi id="S4.I1.i2.p1.2.m1.1.1" xref="S4.I1.i2.p1.2.m1.1.1.cmml">𝚊𝚜𝚔</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m1.1b"><ci id="S4.I1.i2.p1.2.m1.1.1.cmml" xref="S4.I1.i2.p1.2.m1.1.1">𝚊𝚜𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m1.1c">\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m1.1d">typewriter_ask</annotation></semantics></math> and <math alttext="\mathtt{rec}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m2.1"><semantics id="S4.I1.i2.p1.3.m2.1a"><mi id="S4.I1.i2.p1.3.m2.1.1" xref="S4.I1.i2.p1.3.m2.1.1.cmml">𝚛𝚎𝚌</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m2.1b"><ci id="S4.I1.i2.p1.3.m2.1.1.cmml" xref="S4.I1.i2.p1.3.m2.1.1">𝚛𝚎𝚌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m2.1c">\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.3.m2.1d">typewriter_rec</annotation></semantics></math>) to the leaf node
on the selected trajectory to expand the tree.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.2">Conversation simulation:
<span class="ltx_text" id="S4.I1.i3.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.1.m1.1"><semantics id="S4.I1.i3.p1.1.1.m1.1a"><mrow id="S4.I1.i3.p1.1.1.m1.1.1" xref="S4.I1.i3.p1.1.1.m1.1.1.cmml"><mi id="S4.I1.i3.p1.1.1.m1.1.1.2" xref="S4.I1.i3.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.I1.i3.p1.1.1.m1.1.1.1" xref="S4.I1.i3.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.I1.i3.p1.1.1.m1.1.1.3" xref="S4.I1.i3.p1.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.1.m1.1b"><apply id="S4.I1.i3.p1.1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.1.m1.1.1"><times id="S4.I1.i3.p1.1.1.m1.1.1.1.cmml" xref="S4.I1.i3.p1.1.1.m1.1.1.1"></times><ci id="S4.I1.i3.p1.1.1.m1.1.1.2.cmml" xref="S4.I1.i3.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.I1.i3.p1.1.1.m1.1.1.3a.cmml" xref="S4.I1.i3.p1.1.1.m1.1.1.3"><mtext id="S4.I1.i3.p1.1.1.m1.1.1.3.cmml" xref="S4.I1.i3.p1.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> simulates future conversations between <span class="ltx_text" id="S4.I1.i3.p1.2.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.I1.i3.p1.2.2.m1.1"><semantics id="S4.I1.i3.p1.2.2.m1.1a"><mrow id="S4.I1.i3.p1.2.2.m1.1.1" xref="S4.I1.i3.p1.2.2.m1.1.1.cmml"><mi id="S4.I1.i3.p1.2.2.m1.1.1.2" xref="S4.I1.i3.p1.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="S4.I1.i3.p1.2.2.m1.1.1.1" xref="S4.I1.i3.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S4.I1.i3.p1.2.2.m1.1.1.3" xref="S4.I1.i3.p1.2.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.2.m1.1b"><apply id="S4.I1.i3.p1.2.2.m1.1.1.cmml" xref="S4.I1.i3.p1.2.2.m1.1.1"><times id="S4.I1.i3.p1.2.2.m1.1.1.1.cmml" xref="S4.I1.i3.p1.2.2.m1.1.1.1"></times><ci id="S4.I1.i3.p1.2.2.m1.1.1.2.cmml" xref="S4.I1.i3.p1.2.2.m1.1.1.2">𝚂</ci><ci id="S4.I1.i3.p1.2.2.m1.1.1.3a.cmml" xref="S4.I1.i3.p1.2.2.m1.1.1.3"><mtext id="S4.I1.i3.p1.2.2.m1.1.1.3.cmml" xref="S4.I1.i3.p1.2.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.2.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> and the user, starting from the expanded node and foresees how the future conversation will unfold.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.3">Reward back-propagation: <span class="ltx_text" id="S4.I1.i4.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.I1.i4.p1.1.1.m1.1"><semantics id="S4.I1.i4.p1.1.1.m1.1a"><mrow id="S4.I1.i4.p1.1.1.m1.1.1" xref="S4.I1.i4.p1.1.1.m1.1.1.cmml"><mi id="S4.I1.i4.p1.1.1.m1.1.1.2" xref="S4.I1.i4.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.I1.i4.p1.1.1.m1.1.1.1" xref="S4.I1.i4.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.I1.i4.p1.1.1.m1.1.1.3" xref="S4.I1.i4.p1.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.1.1.m1.1b"><apply id="S4.I1.i4.p1.1.1.m1.1.1.cmml" xref="S4.I1.i4.p1.1.1.m1.1.1"><times id="S4.I1.i4.p1.1.1.m1.1.1.1.cmml" xref="S4.I1.i4.p1.1.1.m1.1.1.1"></times><ci id="S4.I1.i4.p1.1.1.m1.1.1.2.cmml" xref="S4.I1.i4.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.I1.i4.p1.1.1.m1.1.1.3a.cmml" xref="S4.I1.i4.p1.1.1.m1.1.1.3"><mtext id="S4.I1.i4.p1.1.1.m1.1.1.3.cmml" xref="S4.I1.i4.p1.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> updates the expected future reward <math alttext="q(s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.I1.i4.p1.2.m1.2"><semantics id="S4.I1.i4.p1.2.m1.2a"><mrow id="S4.I1.i4.p1.2.m1.2.2" xref="S4.I1.i4.p1.2.m1.2.2.cmml"><mi id="S4.I1.i4.p1.2.m1.2.2.4" xref="S4.I1.i4.p1.2.m1.2.2.4.cmml">q</mi><mo id="S4.I1.i4.p1.2.m1.2.2.3" xref="S4.I1.i4.p1.2.m1.2.2.3.cmml">⁢</mo><mrow id="S4.I1.i4.p1.2.m1.2.2.2.2" xref="S4.I1.i4.p1.2.m1.2.2.2.3.cmml"><mo id="S4.I1.i4.p1.2.m1.2.2.2.2.3" stretchy="false" xref="S4.I1.i4.p1.2.m1.2.2.2.3.cmml">(</mo><msub id="S4.I1.i4.p1.2.m1.1.1.1.1.1" xref="S4.I1.i4.p1.2.m1.1.1.1.1.1.cmml"><mi id="S4.I1.i4.p1.2.m1.1.1.1.1.1.2" xref="S4.I1.i4.p1.2.m1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.I1.i4.p1.2.m1.1.1.1.1.1.3" xref="S4.I1.i4.p1.2.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.I1.i4.p1.2.m1.2.2.2.2.4" xref="S4.I1.i4.p1.2.m1.2.2.2.3.cmml">,</mo><msub id="S4.I1.i4.p1.2.m1.2.2.2.2.2" xref="S4.I1.i4.p1.2.m1.2.2.2.2.2.cmml"><mi id="S4.I1.i4.p1.2.m1.2.2.2.2.2.2" xref="S4.I1.i4.p1.2.m1.2.2.2.2.2.2.cmml">o</mi><mi id="S4.I1.i4.p1.2.m1.2.2.2.2.2.3" xref="S4.I1.i4.p1.2.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.I1.i4.p1.2.m1.2.2.2.2.5" stretchy="false" xref="S4.I1.i4.p1.2.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.2.m1.2b"><apply id="S4.I1.i4.p1.2.m1.2.2.cmml" xref="S4.I1.i4.p1.2.m1.2.2"><times id="S4.I1.i4.p1.2.m1.2.2.3.cmml" xref="S4.I1.i4.p1.2.m1.2.2.3"></times><ci id="S4.I1.i4.p1.2.m1.2.2.4.cmml" xref="S4.I1.i4.p1.2.m1.2.2.4">𝑞</ci><interval closure="open" id="S4.I1.i4.p1.2.m1.2.2.2.3.cmml" xref="S4.I1.i4.p1.2.m1.2.2.2.2"><apply id="S4.I1.i4.p1.2.m1.1.1.1.1.1.cmml" xref="S4.I1.i4.p1.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.2.m1.1.1.1.1.1.1.cmml" xref="S4.I1.i4.p1.2.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.2.m1.1.1.1.1.1.2.cmml" xref="S4.I1.i4.p1.2.m1.1.1.1.1.1.2">𝑠</ci><ci id="S4.I1.i4.p1.2.m1.1.1.1.1.1.3.cmml" xref="S4.I1.i4.p1.2.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.I1.i4.p1.2.m1.2.2.2.2.2.cmml" xref="S4.I1.i4.p1.2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.I1.i4.p1.2.m1.2.2.2.2.2.1.cmml" xref="S4.I1.i4.p1.2.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.I1.i4.p1.2.m1.2.2.2.2.2.2.cmml" xref="S4.I1.i4.p1.2.m1.2.2.2.2.2.2">𝑜</ci><ci id="S4.I1.i4.p1.2.m1.2.2.2.2.2.3.cmml" xref="S4.I1.i4.p1.2.m1.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.2.m1.2c">q(s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.2.m1.2d">italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> of action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.3.m2.1"><semantics id="S4.I1.i4.p1.3.m2.1a"><msub id="S4.I1.i4.p1.3.m2.1.1" xref="S4.I1.i4.p1.3.m2.1.1.cmml"><mi id="S4.I1.i4.p1.3.m2.1.1.2" xref="S4.I1.i4.p1.3.m2.1.1.2.cmml">o</mi><mi id="S4.I1.i4.p1.3.m2.1.1.3" xref="S4.I1.i4.p1.3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.3.m2.1b"><apply id="S4.I1.i4.p1.3.m2.1.1.cmml" xref="S4.I1.i4.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.3.m2.1.1.1.cmml" xref="S4.I1.i4.p1.3.m2.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.3.m2.1.1.2.cmml" xref="S4.I1.i4.p1.3.m2.1.1.2">𝑜</ci><ci id="S4.I1.i4.p1.3.m2.1.1.3.cmml" xref="S4.I1.i4.p1.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.3.m2.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.3.m2.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> along the trajectory using the cumulative reward of the current conversation.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.3.1.1">Algorithm 1</span> </span> Training algorithm of <span class="ltx_ERROR undefined" id="alg1.4.2">\method</span></figcaption>
<div class="ltx_listing ltx_listing" id="alg1.5">
<div class="ltx_listingline" id="alg1.l1">conversational MDPs for all users <math alttext="\{\mathcal{M}(u)\}^{\mathcal{U}}_{u=1}" class="ltx_Math" display="inline" id="alg1.l1.m1.2"><semantics id="alg1.l1.m1.2a"><msubsup id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml"><mrow id="alg1.l1.m1.2.2.1.1.1" xref="alg1.l1.m1.2.2.1.1.2.cmml"><mo id="alg1.l1.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l1.m1.2.2.1.1.2.cmml">{</mo><mrow id="alg1.l1.m1.2.2.1.1.1.1" xref="alg1.l1.m1.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.2.2.1.1.1.1.2" xref="alg1.l1.m1.2.2.1.1.1.1.2.cmml">ℳ</mi><mo id="alg1.l1.m1.2.2.1.1.1.1.1" xref="alg1.l1.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l1.m1.2.2.1.1.1.1.3.2" xref="alg1.l1.m1.2.2.1.1.1.1.cmml"><mo id="alg1.l1.m1.2.2.1.1.1.1.3.2.1" stretchy="false" xref="alg1.l1.m1.2.2.1.1.1.1.cmml">(</mo><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">u</mi><mo id="alg1.l1.m1.2.2.1.1.1.1.3.2.2" stretchy="false" xref="alg1.l1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l1.m1.2.2.1.1.1.3" stretchy="false" xref="alg1.l1.m1.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m1.2.2.3" xref="alg1.l1.m1.2.2.3.cmml"><mi id="alg1.l1.m1.2.2.3.2" xref="alg1.l1.m1.2.2.3.2.cmml">u</mi><mo id="alg1.l1.m1.2.2.3.1" xref="alg1.l1.m1.2.2.3.1.cmml">=</mo><mn id="alg1.l1.m1.2.2.3.3" xref="alg1.l1.m1.2.2.3.3.cmml">1</mn></mrow><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.2.2.1.3" xref="alg1.l1.m1.2.2.1.3.cmml">𝒰</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.2b"><apply id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.cmml" xref="alg1.l1.m1.2.2">subscript</csymbol><apply id="alg1.l1.m1.2.2.1.cmml" xref="alg1.l1.m1.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.2.cmml" xref="alg1.l1.m1.2.2">superscript</csymbol><set id="alg1.l1.m1.2.2.1.1.2.cmml" xref="alg1.l1.m1.2.2.1.1.1"><apply id="alg1.l1.m1.2.2.1.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1"><times id="alg1.l1.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1"></times><ci id="alg1.l1.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.2">ℳ</ci><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑢</ci></apply></set><ci id="alg1.l1.m1.2.2.1.3.cmml" xref="alg1.l1.m1.2.2.1.3">𝒰</ci></apply><apply id="alg1.l1.m1.2.2.3.cmml" xref="alg1.l1.m1.2.2.3"><eq id="alg1.l1.m1.2.2.3.1.cmml" xref="alg1.l1.m1.2.2.3.1"></eq><ci id="alg1.l1.m1.2.2.3.2.cmml" xref="alg1.l1.m1.2.2.3.2">𝑢</ci><cn id="alg1.l1.m1.2.2.3.3.cmml" type="integer" xref="alg1.l1.m1.2.2.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.2c">\{\mathcal{M}(u)\}^{\mathcal{U}}_{u=1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.2d">{ caligraphic_M ( italic_u ) } start_POSTSUPERSCRIPT caligraphic_U end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u = 1 end_POSTSUBSCRIPT</annotation></semantics></math>, training steps <math alttext="E" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_E</annotation></semantics></math>, # of simulations <math alttext="N" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_N</annotation></semantics></math>, exploration factor <math alttext="w" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">w</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_w</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_text ltx_font_bold" id="alg1.l2.1">for</span> <math alttext="\text{step}\leftarrow 1,\cdots,E" class="ltx_Math" display="inline" id="alg1.l2.m1.3"><semantics id="alg1.l2.m1.3a"><mrow id="alg1.l2.m1.3.4" xref="alg1.l2.m1.3.4.cmml"><mtext id="alg1.l2.m1.3.4.2" xref="alg1.l2.m1.3.4.2a.cmml">step</mtext><mo id="alg1.l2.m1.3.4.1" stretchy="false" xref="alg1.l2.m1.3.4.1.cmml">←</mo><mrow id="alg1.l2.m1.3.4.3.2" xref="alg1.l2.m1.3.4.3.1.cmml"><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">1</mn><mo id="alg1.l2.m1.3.4.3.2.1" xref="alg1.l2.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l2.m1.2.2" mathvariant="normal" xref="alg1.l2.m1.2.2.cmml">⋯</mi><mo id="alg1.l2.m1.3.4.3.2.2" xref="alg1.l2.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.3b"><apply id="alg1.l2.m1.3.4.cmml" xref="alg1.l2.m1.3.4"><ci id="alg1.l2.m1.3.4.1.cmml" xref="alg1.l2.m1.3.4.1">←</ci><ci id="alg1.l2.m1.3.4.2a.cmml" xref="alg1.l2.m1.3.4.2"><mtext id="alg1.l2.m1.3.4.2.cmml" xref="alg1.l2.m1.3.4.2">step</mtext></ci><list id="alg1.l2.m1.3.4.3.1.cmml" xref="alg1.l2.m1.3.4.3.2"><cn id="alg1.l2.m1.1.1.cmml" type="integer" xref="alg1.l2.m1.1.1">1</cn><ci id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">⋯</ci><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.3c">\text{step}\leftarrow 1,\cdots,E</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.3d">step ← 1 , ⋯ , italic_E</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l2.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l3">   Sample a user <math alttext="u" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_u</annotation></semantics></math> from <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">caligraphic_U</annotation></semantics></math>, initialize the state as <math alttext="s_{0}" class="ltx_Math" display="inline" id="alg1.l3.m3.1"><semantics id="alg1.l3.m3.1a"><msub id="alg1.l3.m3.1.1" xref="alg1.l3.m3.1.1.cmml"><mi id="alg1.l3.m3.1.1.2" xref="alg1.l3.m3.1.1.2.cmml">s</mi><mn id="alg1.l3.m3.1.1.3" xref="alg1.l3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m3.1b"><apply id="alg1.l3.m3.1.1.cmml" xref="alg1.l3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l3.m3.1.1.1.cmml" xref="alg1.l3.m3.1.1">subscript</csymbol><ci id="alg1.l3.m3.1.1.2.cmml" xref="alg1.l3.m3.1.1.2">𝑠</ci><cn id="alg1.l3.m3.1.1.3.cmml" type="integer" xref="alg1.l3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m3.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m3.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">   <span class="ltx_text ltx_font_bold" id="alg1.l4.1">for</span> <math alttext="n\leftarrow 1,\cdots,N" class="ltx_Math" display="inline" id="alg1.l4.m1.3"><semantics id="alg1.l4.m1.3a"><mrow id="alg1.l4.m1.3.4" xref="alg1.l4.m1.3.4.cmml"><mi id="alg1.l4.m1.3.4.2" xref="alg1.l4.m1.3.4.2.cmml">n</mi><mo id="alg1.l4.m1.3.4.1" stretchy="false" xref="alg1.l4.m1.3.4.1.cmml">←</mo><mrow id="alg1.l4.m1.3.4.3.2" xref="alg1.l4.m1.3.4.3.1.cmml"><mn id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">1</mn><mo id="alg1.l4.m1.3.4.3.2.1" xref="alg1.l4.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l4.m1.2.2" mathvariant="normal" xref="alg1.l4.m1.2.2.cmml">⋯</mi><mo id="alg1.l4.m1.3.4.3.2.2" xref="alg1.l4.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.3b"><apply id="alg1.l4.m1.3.4.cmml" xref="alg1.l4.m1.3.4"><ci id="alg1.l4.m1.3.4.1.cmml" xref="alg1.l4.m1.3.4.1">←</ci><ci id="alg1.l4.m1.3.4.2.cmml" xref="alg1.l4.m1.3.4.2">𝑛</ci><list id="alg1.l4.m1.3.4.3.1.cmml" xref="alg1.l4.m1.3.4.3.2"><cn id="alg1.l4.m1.1.1.cmml" type="integer" xref="alg1.l4.m1.1.1">1</cn><ci id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">⋯</ci><ci id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.3c">n\leftarrow 1,\cdots,N</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.3d">italic_n ← 1 , ⋯ , italic_N</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l4.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">      Initialize the trajectory as <math alttext="\tau^{(u)}_{i}{\leftarrow}\{\}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.2" xref="alg1.l5.m1.1.2.cmml"><msubsup id="alg1.l5.m1.1.2.2" xref="alg1.l5.m1.1.2.2.cmml"><mi id="alg1.l5.m1.1.2.2.2.2" xref="alg1.l5.m1.1.2.2.2.2.cmml">τ</mi><mi id="alg1.l5.m1.1.2.2.3" xref="alg1.l5.m1.1.2.2.3.cmml">i</mi><mrow id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.2.2.cmml"><mo id="alg1.l5.m1.1.1.1.3.1" stretchy="false" xref="alg1.l5.m1.1.2.2.cmml">(</mo><mi id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml">u</mi><mo id="alg1.l5.m1.1.1.1.3.2" stretchy="false" xref="alg1.l5.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l5.m1.1.2.1" stretchy="false" xref="alg1.l5.m1.1.2.1.cmml">←</mo><mrow id="alg1.l5.m1.1.2.3.2" xref="alg1.l5.m1.1.2.cmml"><mo id="alg1.l5.m1.1.2.3.2.1" stretchy="false" xref="alg1.l5.m1.1.2.3.1.cmml">{</mo><mo id="alg1.l5.m1.1.2.3.2.2" stretchy="false" xref="alg1.l5.m1.1.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.2.cmml" xref="alg1.l5.m1.1.2"><ci id="alg1.l5.m1.1.2.1.cmml" xref="alg1.l5.m1.1.2.1">←</ci><apply id="alg1.l5.m1.1.2.2.cmml" xref="alg1.l5.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.2.1.cmml" xref="alg1.l5.m1.1.2.2">subscript</csymbol><apply id="alg1.l5.m1.1.2.2.2.cmml" xref="alg1.l5.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.2.2.1.cmml" xref="alg1.l5.m1.1.2.2">superscript</csymbol><ci id="alg1.l5.m1.1.2.2.2.2.cmml" xref="alg1.l5.m1.1.2.2.2.2">𝜏</ci><ci id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">𝑢</ci></apply><ci id="alg1.l5.m1.1.2.2.3.cmml" xref="alg1.l5.m1.1.2.2.3">𝑖</ci></apply><list id="alg1.l5.m1.1.2.3.1.cmml" xref="alg1.l5.m1.1.2.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\tau^{(u)}_{i}{\leftarrow}\{\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← { }</annotation></semantics></math>, <math alttext="t{\leftarrow}0" class="ltx_Math" display="inline" id="alg1.l5.m2.1"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">t</mi><mo id="alg1.l5.m2.1.1.1" stretchy="false" xref="alg1.l5.m2.1.1.1.cmml">←</mo><mn id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><ci id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1.1">←</ci><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝑡</ci><cn id="alg1.l5.m2.1.1.3.cmml" type="integer" xref="alg1.l5.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">t{\leftarrow}0</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">italic_t ← 0</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">      <span class="ltx_text ltx_font_bold" id="alg1.l6.2">while</span> <math alttext="s_{t}" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">s</mi><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑠</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> has children <span class="ltx_text ltx_font_bold" id="alg1.l6.1">do<span class="ltx_text ltx_font_medium" id="alg1.l6.1.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.1.m1.1"><semantics id="alg1.l6.1.1.m1.1a"><mo id="alg1.l6.1.1.m1.1.1" xref="alg1.l6.1.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.1.m1.1b"><ci id="alg1.l6.1.1.m1.1.1.cmml" xref="alg1.l6.1.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.1.m1.1d">▷</annotation></semantics></math> Trajectory Selection
</span></span>
</div>
<div class="ltx_listingline" id="alg1.l7">         Select an action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><msub id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">o</mi><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑜</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.E2" title='In Trajectory selection ‣ 4.3 𝚂⁢"-planner" ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search'><span class="ltx_text ltx_ref_tag">2</span></a>) and an action <math alttext="a_{t}" class="ltx_Math" display="inline" id="alg1.l7.m2.1"><semantics id="alg1.l7.m2.1a"><msub id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml"><mi id="alg1.l7.m2.1.1.2" xref="alg1.l7.m2.1.1.2.cmml">a</mi><mi id="alg1.l7.m2.1.1.3" xref="alg1.l7.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.1.cmml" xref="alg1.l7.m2.1.1">subscript</csymbol><ci id="alg1.l7.m2.1.1.2.cmml" xref="alg1.l7.m2.1.1.2">𝑎</ci><ci id="alg1.l7.m2.1.1.3.cmml" xref="alg1.l7.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m2.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.E3" title='In Trajectory selection ‣ 4.3 𝚂⁢"-planner" ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search'><span class="ltx_text ltx_ref_tag">3</span></a>)

</div>
<div class="ltx_listingline" id="alg1.l8">         Save <math alttext="s_{t}" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><msub id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">s</mi><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑠</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="\tau^{(u)}_{i}" class="ltx_Math" display="inline" id="alg1.l8.m2.1"><semantics id="alg1.l8.m2.1a"><msubsup id="alg1.l8.m2.1.2" xref="alg1.l8.m2.1.2.cmml"><mi id="alg1.l8.m2.1.2.2.2" xref="alg1.l8.m2.1.2.2.2.cmml">τ</mi><mi id="alg1.l8.m2.1.2.3" xref="alg1.l8.m2.1.2.3.cmml">i</mi><mrow id="alg1.l8.m2.1.1.1.3" xref="alg1.l8.m2.1.2.cmml"><mo id="alg1.l8.m2.1.1.1.3.1" stretchy="false" xref="alg1.l8.m2.1.2.cmml">(</mo><mi id="alg1.l8.m2.1.1.1.1" xref="alg1.l8.m2.1.1.1.1.cmml">u</mi><mo id="alg1.l8.m2.1.1.1.3.2" stretchy="false" xref="alg1.l8.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.2.cmml" xref="alg1.l8.m2.1.2"><csymbol cd="ambiguous" id="alg1.l8.m2.1.2.1.cmml" xref="alg1.l8.m2.1.2">subscript</csymbol><apply id="alg1.l8.m2.1.2.2.cmml" xref="alg1.l8.m2.1.2"><csymbol cd="ambiguous" id="alg1.l8.m2.1.2.2.1.cmml" xref="alg1.l8.m2.1.2">superscript</csymbol><ci id="alg1.l8.m2.1.2.2.2.cmml" xref="alg1.l8.m2.1.2.2.2">𝜏</ci><ci id="alg1.l8.m2.1.1.1.1.cmml" xref="alg1.l8.m2.1.1.1.1">𝑢</ci></apply><ci id="alg1.l8.m2.1.2.3.cmml" xref="alg1.l8.m2.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\tau^{(u)}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="s_{t+1}\leftarrow\mathcal{T}(s_{t},a_{t}),t{\mathrel{+}=}1" class="ltx_math_unparsed" display="inline" id="alg1.l8.m3.1"><semantics id="alg1.l8.m3.1a"><mrow id="alg1.l8.m3.1b"><msub id="alg1.l8.m3.1.2"><mi id="alg1.l8.m3.1.2.2">s</mi><mrow id="alg1.l8.m3.1.2.3"><mi id="alg1.l8.m3.1.2.3.2">t</mi><mo id="alg1.l8.m3.1.2.3.1">+</mo><mn id="alg1.l8.m3.1.2.3.3">1</mn></mrow></msub><mo id="alg1.l8.m3.1.3" stretchy="false">←</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m3.1.4">𝒯</mi><mrow id="alg1.l8.m3.1.5"><mo id="alg1.l8.m3.1.5.1" stretchy="false">(</mo><msub id="alg1.l8.m3.1.5.2"><mi id="alg1.l8.m3.1.5.2.2">s</mi><mi id="alg1.l8.m3.1.5.2.3">t</mi></msub><mo id="alg1.l8.m3.1.5.3">,</mo><msub id="alg1.l8.m3.1.5.4"><mi id="alg1.l8.m3.1.5.4.2">a</mi><mi id="alg1.l8.m3.1.5.4.3">t</mi></msub><mo id="alg1.l8.m3.1.5.5" stretchy="false">)</mo></mrow><mo id="alg1.l8.m3.1.6">,</mo><mi id="alg1.l8.m3.1.1">t</mi><mo id="alg1.l8.m3.1.7" lspace="0.278em" rspace="0em">+</mo><mo id="alg1.l8.m3.1.8" lspace="0em">=</mo><mn id="alg1.l8.m3.1.9">1</mn></mrow><annotation encoding="application/x-tex" id="alg1.l8.m3.1c">s_{t+1}\leftarrow\mathcal{T}(s_{t},a_{t}),t{\mathrel{+}=}1</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m3.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ← caligraphic_T ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) , italic_t + = 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">      <span class="ltx_text ltx_font_bold" id="alg1.l9.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l9.2">while</span>
</div>
<div class="ltx_listingline" id="alg1.l10">      <span class="ltx_text ltx_font_bold" id="alg1.l10.1">while</span> <math alttext="s_{t}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">s</mi><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑠</ci><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is not end of conversation <span class="ltx_text ltx_font_bold" id="alg1.l10.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l11">         Attach two children (<math alttext="\mathtt{ask}" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">𝚊𝚜𝚔</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝚊𝚜𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">typewriter_ask</annotation></semantics></math> and <math alttext="\mathtt{rec}" class="ltx_Math" display="inline" id="alg1.l11.m2.1"><semantics id="alg1.l11.m2.1a"><mi id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml">𝚛𝚎𝚌</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><ci id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1">𝚛𝚎𝚌</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m2.1d">typewriter_rec</annotation></semantics></math>) to <math alttext="s_{t}" class="ltx_Math" display="inline" id="alg1.l11.m3.1"><semantics id="alg1.l11.m3.1a"><msub id="alg1.l11.m3.1.1" xref="alg1.l11.m3.1.1.cmml"><mi id="alg1.l11.m3.1.1.2" xref="alg1.l11.m3.1.1.2.cmml">s</mi><mi id="alg1.l11.m3.1.1.3" xref="alg1.l11.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m3.1b"><apply id="alg1.l11.m3.1.1.cmml" xref="alg1.l11.m3.1.1"><csymbol cd="ambiguous" id="alg1.l11.m3.1.1.1.cmml" xref="alg1.l11.m3.1.1">subscript</csymbol><ci id="alg1.l11.m3.1.1.2.cmml" xref="alg1.l11.m3.1.1.2">𝑠</ci><ci id="alg1.l11.m3.1.1.3.cmml" xref="alg1.l11.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m3.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m3.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l11.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l11.1.m1.1"><semantics id="alg1.l11.1.m1.1a"><mo id="alg1.l11.1.m1.1.1" xref="alg1.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l11.1.m1.1b"><ci id="alg1.l11.1.m1.1.1.cmml" xref="alg1.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.1.m1.1d">▷</annotation></semantics></math> Node Expansion
</span>
</div>
<div class="ltx_listingline" id="alg1.l12">         Select <math alttext="o_{t}" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><msub id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">o</mi><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑜</ci><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="\pi_{\phi}(o_{t}|s_{t})" class="ltx_Math" display="inline" id="alg1.l12.m2.1"><semantics id="alg1.l12.m2.1a"><mrow id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><msub id="alg1.l12.m2.1.1.3" xref="alg1.l12.m2.1.1.3.cmml"><mi id="alg1.l12.m2.1.1.3.2" xref="alg1.l12.m2.1.1.3.2.cmml">π</mi><mi id="alg1.l12.m2.1.1.3.3" xref="alg1.l12.m2.1.1.3.3.cmml">ϕ</mi></msub><mo id="alg1.l12.m2.1.1.2" xref="alg1.l12.m2.1.1.2.cmml">⁢</mo><mrow id="alg1.l12.m2.1.1.1.1" xref="alg1.l12.m2.1.1.1.1.1.cmml"><mo id="alg1.l12.m2.1.1.1.1.2" stretchy="false" xref="alg1.l12.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l12.m2.1.1.1.1.1" xref="alg1.l12.m2.1.1.1.1.1.cmml"><msub id="alg1.l12.m2.1.1.1.1.1.2" xref="alg1.l12.m2.1.1.1.1.1.2.cmml"><mi id="alg1.l12.m2.1.1.1.1.1.2.2" xref="alg1.l12.m2.1.1.1.1.1.2.2.cmml">o</mi><mi id="alg1.l12.m2.1.1.1.1.1.2.3" xref="alg1.l12.m2.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="alg1.l12.m2.1.1.1.1.1.1" xref="alg1.l12.m2.1.1.1.1.1.1.cmml">|</mo><msub id="alg1.l12.m2.1.1.1.1.1.3" xref="alg1.l12.m2.1.1.1.1.1.3.cmml"><mi id="alg1.l12.m2.1.1.1.1.1.3.2" xref="alg1.l12.m2.1.1.1.1.1.3.2.cmml">s</mi><mi id="alg1.l12.m2.1.1.1.1.1.3.3" xref="alg1.l12.m2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="alg1.l12.m2.1.1.1.1.3" stretchy="false" xref="alg1.l12.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><times id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1.2"></times><apply id="alg1.l12.m2.1.1.3.cmml" xref="alg1.l12.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.3.1.cmml" xref="alg1.l12.m2.1.1.3">subscript</csymbol><ci id="alg1.l12.m2.1.1.3.2.cmml" xref="alg1.l12.m2.1.1.3.2">𝜋</ci><ci id="alg1.l12.m2.1.1.3.3.cmml" xref="alg1.l12.m2.1.1.3.3">italic-ϕ</ci></apply><apply id="alg1.l12.m2.1.1.1.1.1.cmml" xref="alg1.l12.m2.1.1.1.1"><csymbol cd="latexml" id="alg1.l12.m2.1.1.1.1.1.1.cmml" xref="alg1.l12.m2.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l12.m2.1.1.1.1.1.2.cmml" xref="alg1.l12.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.1.1.1.2.1.cmml" xref="alg1.l12.m2.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l12.m2.1.1.1.1.1.2.2.cmml" xref="alg1.l12.m2.1.1.1.1.1.2.2">𝑜</ci><ci id="alg1.l12.m2.1.1.1.1.1.2.3.cmml" xref="alg1.l12.m2.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l12.m2.1.1.1.1.1.3.cmml" xref="alg1.l12.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.1.1.1.3.1.cmml" xref="alg1.l12.m2.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l12.m2.1.1.1.1.1.3.2.cmml" xref="alg1.l12.m2.1.1.1.1.1.3.2">𝑠</ci><ci id="alg1.l12.m2.1.1.1.1.1.3.3.cmml" xref="alg1.l12.m2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">\pi_{\phi}(o_{t}|s_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m2.1d">italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l12.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l12.1.m1.1"><semantics id="alg1.l12.1.m1.1a"><mo id="alg1.l12.1.m1.1.1" xref="alg1.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.1.m1.1b"><ci id="alg1.l12.1.m1.1.1.cmml" xref="alg1.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.1.m1.1d">▷</annotation></semantics></math> Conversation Simulation
</span>
</div>
<div class="ltx_listingline" id="alg1.l13">         Select <math alttext="a_{t}" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><msub id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">a</mi><mi id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">𝑎</ci><ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="Q_{\theta}(a_{t}|s_{t},o_{t})" class="ltx_Math" display="inline" id="alg1.l13.m2.1"><semantics id="alg1.l13.m2.1a"><mrow id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml"><msub id="alg1.l13.m2.1.1.3" xref="alg1.l13.m2.1.1.3.cmml"><mi id="alg1.l13.m2.1.1.3.2" xref="alg1.l13.m2.1.1.3.2.cmml">Q</mi><mi id="alg1.l13.m2.1.1.3.3" xref="alg1.l13.m2.1.1.3.3.cmml">θ</mi></msub><mo id="alg1.l13.m2.1.1.2" xref="alg1.l13.m2.1.1.2.cmml">⁢</mo><mrow id="alg1.l13.m2.1.1.1.1" xref="alg1.l13.m2.1.1.1.1.1.cmml"><mo id="alg1.l13.m2.1.1.1.1.2" stretchy="false" xref="alg1.l13.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l13.m2.1.1.1.1.1" xref="alg1.l13.m2.1.1.1.1.1.cmml"><msub id="alg1.l13.m2.1.1.1.1.1.4" xref="alg1.l13.m2.1.1.1.1.1.4.cmml"><mi id="alg1.l13.m2.1.1.1.1.1.4.2" xref="alg1.l13.m2.1.1.1.1.1.4.2.cmml">a</mi><mi id="alg1.l13.m2.1.1.1.1.1.4.3" xref="alg1.l13.m2.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="alg1.l13.m2.1.1.1.1.1.3" xref="alg1.l13.m2.1.1.1.1.1.3.cmml">|</mo><mrow id="alg1.l13.m2.1.1.1.1.1.2.2" xref="alg1.l13.m2.1.1.1.1.1.2.3.cmml"><msub id="alg1.l13.m2.1.1.1.1.1.1.1.1" xref="alg1.l13.m2.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l13.m2.1.1.1.1.1.1.1.1.2" xref="alg1.l13.m2.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l13.m2.1.1.1.1.1.1.1.1.3" xref="alg1.l13.m2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l13.m2.1.1.1.1.1.2.2.3" xref="alg1.l13.m2.1.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l13.m2.1.1.1.1.1.2.2.2" xref="alg1.l13.m2.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l13.m2.1.1.1.1.1.2.2.2.2" xref="alg1.l13.m2.1.1.1.1.1.2.2.2.2.cmml">o</mi><mi id="alg1.l13.m2.1.1.1.1.1.2.2.2.3" xref="alg1.l13.m2.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="alg1.l13.m2.1.1.1.1.3" stretchy="false" xref="alg1.l13.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><apply id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1"><times id="alg1.l13.m2.1.1.2.cmml" xref="alg1.l13.m2.1.1.2"></times><apply id="alg1.l13.m2.1.1.3.cmml" xref="alg1.l13.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.3.1.cmml" xref="alg1.l13.m2.1.1.3">subscript</csymbol><ci id="alg1.l13.m2.1.1.3.2.cmml" xref="alg1.l13.m2.1.1.3.2">𝑄</ci><ci id="alg1.l13.m2.1.1.3.3.cmml" xref="alg1.l13.m2.1.1.3.3">𝜃</ci></apply><apply id="alg1.l13.m2.1.1.1.1.1.cmml" xref="alg1.l13.m2.1.1.1.1"><csymbol cd="latexml" id="alg1.l13.m2.1.1.1.1.1.3.cmml" xref="alg1.l13.m2.1.1.1.1.1.3">conditional</csymbol><apply id="alg1.l13.m2.1.1.1.1.1.4.cmml" xref="alg1.l13.m2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.1.1.1.4.1.cmml" xref="alg1.l13.m2.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l13.m2.1.1.1.1.1.4.2.cmml" xref="alg1.l13.m2.1.1.1.1.1.4.2">𝑎</ci><ci id="alg1.l13.m2.1.1.1.1.1.4.3.cmml" xref="alg1.l13.m2.1.1.1.1.1.4.3">𝑡</ci></apply><list id="alg1.l13.m2.1.1.1.1.1.2.3.cmml" xref="alg1.l13.m2.1.1.1.1.1.2.2"><apply id="alg1.l13.m2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m2.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m2.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l13.m2.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l13.m2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l13.m2.1.1.1.1.1.2.2.2.cmml" xref="alg1.l13.m2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l13.m2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l13.m2.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l13.m2.1.1.1.1.1.2.2.2.2">𝑜</ci><ci id="alg1.l13.m2.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l13.m2.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">Q_{\theta}(a_{t}|s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m2.1d">italic_Q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l14">         Save <math alttext="s_{t}" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><msub id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">s</mi><mi id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1">subscript</csymbol><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑠</ci><ci id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="\tau^{(u)}_{i}" class="ltx_Math" display="inline" id="alg1.l14.m2.1"><semantics id="alg1.l14.m2.1a"><msubsup id="alg1.l14.m2.1.2" xref="alg1.l14.m2.1.2.cmml"><mi id="alg1.l14.m2.1.2.2.2" xref="alg1.l14.m2.1.2.2.2.cmml">τ</mi><mi id="alg1.l14.m2.1.2.3" xref="alg1.l14.m2.1.2.3.cmml">i</mi><mrow id="alg1.l14.m2.1.1.1.3" xref="alg1.l14.m2.1.2.cmml"><mo id="alg1.l14.m2.1.1.1.3.1" stretchy="false" xref="alg1.l14.m2.1.2.cmml">(</mo><mi id="alg1.l14.m2.1.1.1.1" xref="alg1.l14.m2.1.1.1.1.cmml">u</mi><mo id="alg1.l14.m2.1.1.1.3.2" stretchy="false" xref="alg1.l14.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b"><apply id="alg1.l14.m2.1.2.cmml" xref="alg1.l14.m2.1.2"><csymbol cd="ambiguous" id="alg1.l14.m2.1.2.1.cmml" xref="alg1.l14.m2.1.2">subscript</csymbol><apply id="alg1.l14.m2.1.2.2.cmml" xref="alg1.l14.m2.1.2"><csymbol cd="ambiguous" id="alg1.l14.m2.1.2.2.1.cmml" xref="alg1.l14.m2.1.2">superscript</csymbol><ci id="alg1.l14.m2.1.2.2.2.cmml" xref="alg1.l14.m2.1.2.2.2">𝜏</ci><ci id="alg1.l14.m2.1.1.1.1.cmml" xref="alg1.l14.m2.1.1.1.1">𝑢</ci></apply><ci id="alg1.l14.m2.1.2.3.cmml" xref="alg1.l14.m2.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.1c">\tau^{(u)}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m2.1d">italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="s_{t+1}{\leftarrow}\mathcal{T}(s_{t},a_{t})" class="ltx_Math" display="inline" id="alg1.l14.m3.2"><semantics id="alg1.l14.m3.2a"><mrow id="alg1.l14.m3.2.2" xref="alg1.l14.m3.2.2.cmml"><msub id="alg1.l14.m3.2.2.4" xref="alg1.l14.m3.2.2.4.cmml"><mi id="alg1.l14.m3.2.2.4.2" xref="alg1.l14.m3.2.2.4.2.cmml">s</mi><mrow id="alg1.l14.m3.2.2.4.3" xref="alg1.l14.m3.2.2.4.3.cmml"><mi id="alg1.l14.m3.2.2.4.3.2" xref="alg1.l14.m3.2.2.4.3.2.cmml">t</mi><mo id="alg1.l14.m3.2.2.4.3.1" xref="alg1.l14.m3.2.2.4.3.1.cmml">+</mo><mn id="alg1.l14.m3.2.2.4.3.3" xref="alg1.l14.m3.2.2.4.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l14.m3.2.2.3" stretchy="false" xref="alg1.l14.m3.2.2.3.cmml">←</mo><mrow id="alg1.l14.m3.2.2.2" xref="alg1.l14.m3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m3.2.2.2.4" xref="alg1.l14.m3.2.2.2.4.cmml">𝒯</mi><mo id="alg1.l14.m3.2.2.2.3" xref="alg1.l14.m3.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l14.m3.2.2.2.2.2" xref="alg1.l14.m3.2.2.2.2.3.cmml"><mo id="alg1.l14.m3.2.2.2.2.2.3" stretchy="false" xref="alg1.l14.m3.2.2.2.2.3.cmml">(</mo><msub id="alg1.l14.m3.1.1.1.1.1.1" xref="alg1.l14.m3.1.1.1.1.1.1.cmml"><mi id="alg1.l14.m3.1.1.1.1.1.1.2" xref="alg1.l14.m3.1.1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l14.m3.1.1.1.1.1.1.3" xref="alg1.l14.m3.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l14.m3.2.2.2.2.2.4" xref="alg1.l14.m3.2.2.2.2.3.cmml">,</mo><msub id="alg1.l14.m3.2.2.2.2.2.2" xref="alg1.l14.m3.2.2.2.2.2.2.cmml"><mi id="alg1.l14.m3.2.2.2.2.2.2.2" xref="alg1.l14.m3.2.2.2.2.2.2.2.cmml">a</mi><mi id="alg1.l14.m3.2.2.2.2.2.2.3" xref="alg1.l14.m3.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l14.m3.2.2.2.2.2.5" stretchy="false" xref="alg1.l14.m3.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m3.2b"><apply id="alg1.l14.m3.2.2.cmml" xref="alg1.l14.m3.2.2"><ci id="alg1.l14.m3.2.2.3.cmml" xref="alg1.l14.m3.2.2.3">←</ci><apply id="alg1.l14.m3.2.2.4.cmml" xref="alg1.l14.m3.2.2.4"><csymbol cd="ambiguous" id="alg1.l14.m3.2.2.4.1.cmml" xref="alg1.l14.m3.2.2.4">subscript</csymbol><ci id="alg1.l14.m3.2.2.4.2.cmml" xref="alg1.l14.m3.2.2.4.2">𝑠</ci><apply id="alg1.l14.m3.2.2.4.3.cmml" xref="alg1.l14.m3.2.2.4.3"><plus id="alg1.l14.m3.2.2.4.3.1.cmml" xref="alg1.l14.m3.2.2.4.3.1"></plus><ci id="alg1.l14.m3.2.2.4.3.2.cmml" xref="alg1.l14.m3.2.2.4.3.2">𝑡</ci><cn id="alg1.l14.m3.2.2.4.3.3.cmml" type="integer" xref="alg1.l14.m3.2.2.4.3.3">1</cn></apply></apply><apply id="alg1.l14.m3.2.2.2.cmml" xref="alg1.l14.m3.2.2.2"><times id="alg1.l14.m3.2.2.2.3.cmml" xref="alg1.l14.m3.2.2.2.3"></times><ci id="alg1.l14.m3.2.2.2.4.cmml" xref="alg1.l14.m3.2.2.2.4">𝒯</ci><interval closure="open" id="alg1.l14.m3.2.2.2.2.3.cmml" xref="alg1.l14.m3.2.2.2.2.2"><apply id="alg1.l14.m3.1.1.1.1.1.1.cmml" xref="alg1.l14.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m3.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m3.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l14.m3.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m3.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l14.m3.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m3.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l14.m3.2.2.2.2.2.2.cmml" xref="alg1.l14.m3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m3.2.2.2.2.2.2.1.cmml" xref="alg1.l14.m3.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l14.m3.2.2.2.2.2.2.2.cmml" xref="alg1.l14.m3.2.2.2.2.2.2.2">𝑎</ci><ci id="alg1.l14.m3.2.2.2.2.2.2.3.cmml" xref="alg1.l14.m3.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m3.2c">s_{t+1}{\leftarrow}\mathcal{T}(s_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m3.2d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ← caligraphic_T ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, <math alttext="t{\mathrel{+}=}1" class="ltx_math_unparsed" display="inline" id="alg1.l14.m4.1"><semantics id="alg1.l14.m4.1a"><mrow id="alg1.l14.m4.1b"><mi id="alg1.l14.m4.1.1">t</mi><mo id="alg1.l14.m4.1.2" lspace="0.278em" rspace="0em">+</mo><mo id="alg1.l14.m4.1.3" lspace="0em">=</mo><mn id="alg1.l14.m4.1.4">1</mn></mrow><annotation encoding="application/x-tex" id="alg1.l14.m4.1c">t{\mathrel{+}=}1</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m4.1d">italic_t + = 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l15">      <span class="ltx_text ltx_font_bold" id="alg1.l15.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l15.2">while</span>
</div>
<div class="ltx_listingline" id="alg1.l16">      Initialize <math alttext="R(\tau^{(u)}_{i},t){\leftarrow}r_{t}" class="ltx_Math" display="inline" id="alg1.l16.m1.3"><semantics id="alg1.l16.m1.3a"><mrow id="alg1.l16.m1.3.3" xref="alg1.l16.m1.3.3.cmml"><mrow id="alg1.l16.m1.3.3.1" xref="alg1.l16.m1.3.3.1.cmml"><mi id="alg1.l16.m1.3.3.1.3" xref="alg1.l16.m1.3.3.1.3.cmml">R</mi><mo id="alg1.l16.m1.3.3.1.2" xref="alg1.l16.m1.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l16.m1.3.3.1.1.1" xref="alg1.l16.m1.3.3.1.1.2.cmml"><mo id="alg1.l16.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.l16.m1.3.3.1.1.2.cmml">(</mo><msubsup id="alg1.l16.m1.3.3.1.1.1.1" xref="alg1.l16.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l16.m1.3.3.1.1.1.1.2.2" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.cmml">τ</mi><mi id="alg1.l16.m1.3.3.1.1.1.1.3" xref="alg1.l16.m1.3.3.1.1.1.1.3.cmml">i</mi><mrow id="alg1.l16.m1.1.1.1.3" xref="alg1.l16.m1.3.3.1.1.1.1.cmml"><mo id="alg1.l16.m1.1.1.1.3.1" stretchy="false" xref="alg1.l16.m1.3.3.1.1.1.1.cmml">(</mo><mi id="alg1.l16.m1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.cmml">u</mi><mo id="alg1.l16.m1.1.1.1.3.2" stretchy="false" xref="alg1.l16.m1.3.3.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l16.m1.3.3.1.1.1.3" xref="alg1.l16.m1.3.3.1.1.2.cmml">,</mo><mi id="alg1.l16.m1.2.2" xref="alg1.l16.m1.2.2.cmml">t</mi><mo id="alg1.l16.m1.3.3.1.1.1.4" stretchy="false" xref="alg1.l16.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="alg1.l16.m1.3.3.2" stretchy="false" xref="alg1.l16.m1.3.3.2.cmml">←</mo><msub id="alg1.l16.m1.3.3.3" xref="alg1.l16.m1.3.3.3.cmml"><mi id="alg1.l16.m1.3.3.3.2" xref="alg1.l16.m1.3.3.3.2.cmml">r</mi><mi id="alg1.l16.m1.3.3.3.3" xref="alg1.l16.m1.3.3.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.3b"><apply id="alg1.l16.m1.3.3.cmml" xref="alg1.l16.m1.3.3"><ci id="alg1.l16.m1.3.3.2.cmml" xref="alg1.l16.m1.3.3.2">←</ci><apply id="alg1.l16.m1.3.3.1.cmml" xref="alg1.l16.m1.3.3.1"><times id="alg1.l16.m1.3.3.1.2.cmml" xref="alg1.l16.m1.3.3.1.2"></times><ci id="alg1.l16.m1.3.3.1.3.cmml" xref="alg1.l16.m1.3.3.1.3">𝑅</ci><interval closure="open" id="alg1.l16.m1.3.3.1.1.2.cmml" xref="alg1.l16.m1.3.3.1.1.1"><apply id="alg1.l16.m1.3.3.1.1.1.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1">subscript</csymbol><apply id="alg1.l16.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.1.1.1.1.2.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1">superscript</csymbol><ci id="alg1.l16.m1.3.3.1.1.1.1.2.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.2.2">𝜏</ci><ci id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1">𝑢</ci></apply><ci id="alg1.l16.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.3">𝑖</ci></apply><ci id="alg1.l16.m1.2.2.cmml" xref="alg1.l16.m1.2.2">𝑡</ci></interval></apply><apply id="alg1.l16.m1.3.3.3.cmml" xref="alg1.l16.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.3.1.cmml" xref="alg1.l16.m1.3.3.3">subscript</csymbol><ci id="alg1.l16.m1.3.3.3.2.cmml" xref="alg1.l16.m1.3.3.3.2">𝑟</ci><ci id="alg1.l16.m1.3.3.3.3.cmml" xref="alg1.l16.m1.3.3.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.3c">R(\tau^{(u)}_{i},t){\leftarrow}r_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.3d">italic_R ( italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_t ) ← italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l17">      <span class="ltx_text ltx_font_bold" id="alg1.l17.2">while</span> <math alttext="t\geq 0" class="ltx_Math" display="inline" id="alg1.l17.m1.1"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">t</mi><mo id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml">≥</mo><mn id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><geq id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"></geq><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">𝑡</ci><cn id="alg1.l17.m1.1.1.3.cmml" type="integer" xref="alg1.l17.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">t\geq 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.1d">italic_t ≥ 0</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l17.1">do<span class="ltx_text ltx_font_medium" id="alg1.l17.1.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l17.1.1.m1.1"><semantics id="alg1.l17.1.1.m1.1a"><mo id="alg1.l17.1.1.m1.1.1" xref="alg1.l17.1.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l17.1.1.m1.1b"><ci id="alg1.l17.1.1.m1.1.1.cmml" xref="alg1.l17.1.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.1.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.1.1.m1.1d">▷</annotation></semantics></math> Reward Back-Propagation
</span></span>
</div>
<div class="ltx_listingline" id="alg1.l18">         Update the Q-value <math alttext="q(s_{t},o_{t})" class="ltx_Math" display="inline" id="alg1.l18.m1.2"><semantics id="alg1.l18.m1.2a"><mrow id="alg1.l18.m1.2.2" xref="alg1.l18.m1.2.2.cmml"><mi id="alg1.l18.m1.2.2.4" xref="alg1.l18.m1.2.2.4.cmml">q</mi><mo id="alg1.l18.m1.2.2.3" xref="alg1.l18.m1.2.2.3.cmml">⁢</mo><mrow id="alg1.l18.m1.2.2.2.2" xref="alg1.l18.m1.2.2.2.3.cmml"><mo id="alg1.l18.m1.2.2.2.2.3" stretchy="false" xref="alg1.l18.m1.2.2.2.3.cmml">(</mo><msub id="alg1.l18.m1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l18.m1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l18.m1.2.2.2.2.4" xref="alg1.l18.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l18.m1.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.cmml"><mi id="alg1.l18.m1.2.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.2.cmml">o</mi><mi id="alg1.l18.m1.2.2.2.2.2.3" xref="alg1.l18.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l18.m1.2.2.2.2.5" stretchy="false" xref="alg1.l18.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.2b"><apply id="alg1.l18.m1.2.2.cmml" xref="alg1.l18.m1.2.2"><times id="alg1.l18.m1.2.2.3.cmml" xref="alg1.l18.m1.2.2.3"></times><ci id="alg1.l18.m1.2.2.4.cmml" xref="alg1.l18.m1.2.2.4">𝑞</ci><interval closure="open" id="alg1.l18.m1.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2"><apply id="alg1.l18.m1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l18.m1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l18.m1.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.2.2">𝑜</ci><ci id="alg1.l18.m1.2.2.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.2c">q(s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.2d">italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> with Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.E4" title='In Reward Back-propagation ‣ 4.3 𝚂⁢"-planner" ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search'><span class="ltx_text ltx_ref_tag">4</span></a>
</div>
<div class="ltx_listingline" id="alg1.l19">         <math alttext="R_{t}(\tau^{(u)}_{i}){\leftarrow}{\gamma}R_{t}(\tau^{(u)}_{i}){+}r_{t}" class="ltx_Math" display="inline" id="alg1.l19.m1.4"><semantics id="alg1.l19.m1.4a"><mrow id="alg1.l19.m1.4.4" xref="alg1.l19.m1.4.4.cmml"><mrow id="alg1.l19.m1.3.3.1" xref="alg1.l19.m1.3.3.1.cmml"><msub id="alg1.l19.m1.3.3.1.3" xref="alg1.l19.m1.3.3.1.3.cmml"><mi id="alg1.l19.m1.3.3.1.3.2" xref="alg1.l19.m1.3.3.1.3.2.cmml">R</mi><mi id="alg1.l19.m1.3.3.1.3.3" xref="alg1.l19.m1.3.3.1.3.3.cmml">t</mi></msub><mo id="alg1.l19.m1.3.3.1.2" xref="alg1.l19.m1.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l19.m1.3.3.1.1.1" xref="alg1.l19.m1.3.3.1.1.1.1.cmml"><mo id="alg1.l19.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.l19.m1.3.3.1.1.1.1.cmml">(</mo><msubsup id="alg1.l19.m1.3.3.1.1.1.1" xref="alg1.l19.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l19.m1.3.3.1.1.1.1.2.2" xref="alg1.l19.m1.3.3.1.1.1.1.2.2.cmml">τ</mi><mi id="alg1.l19.m1.3.3.1.1.1.1.3" xref="alg1.l19.m1.3.3.1.1.1.1.3.cmml">i</mi><mrow id="alg1.l19.m1.1.1.1.3" xref="alg1.l19.m1.3.3.1.1.1.1.cmml"><mo id="alg1.l19.m1.1.1.1.3.1" stretchy="false" xref="alg1.l19.m1.3.3.1.1.1.1.cmml">(</mo><mi id="alg1.l19.m1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.cmml">u</mi><mo id="alg1.l19.m1.1.1.1.3.2" stretchy="false" xref="alg1.l19.m1.3.3.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l19.m1.3.3.1.1.1.3" stretchy="false" xref="alg1.l19.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l19.m1.4.4.3" stretchy="false" xref="alg1.l19.m1.4.4.3.cmml">←</mo><mrow id="alg1.l19.m1.4.4.2" xref="alg1.l19.m1.4.4.2.cmml"><mrow id="alg1.l19.m1.4.4.2.1" xref="alg1.l19.m1.4.4.2.1.cmml"><mi id="alg1.l19.m1.4.4.2.1.3" xref="alg1.l19.m1.4.4.2.1.3.cmml">γ</mi><mo id="alg1.l19.m1.4.4.2.1.2" xref="alg1.l19.m1.4.4.2.1.2.cmml">⁢</mo><msub id="alg1.l19.m1.4.4.2.1.4" xref="alg1.l19.m1.4.4.2.1.4.cmml"><mi id="alg1.l19.m1.4.4.2.1.4.2" xref="alg1.l19.m1.4.4.2.1.4.2.cmml">R</mi><mi id="alg1.l19.m1.4.4.2.1.4.3" xref="alg1.l19.m1.4.4.2.1.4.3.cmml">t</mi></msub><mo id="alg1.l19.m1.4.4.2.1.2a" xref="alg1.l19.m1.4.4.2.1.2.cmml">⁢</mo><mrow id="alg1.l19.m1.4.4.2.1.1.1" xref="alg1.l19.m1.4.4.2.1.1.1.1.cmml"><mo id="alg1.l19.m1.4.4.2.1.1.1.2" stretchy="false" xref="alg1.l19.m1.4.4.2.1.1.1.1.cmml">(</mo><msubsup id="alg1.l19.m1.4.4.2.1.1.1.1" xref="alg1.l19.m1.4.4.2.1.1.1.1.cmml"><mi id="alg1.l19.m1.4.4.2.1.1.1.1.2.2" xref="alg1.l19.m1.4.4.2.1.1.1.1.2.2.cmml">τ</mi><mi id="alg1.l19.m1.4.4.2.1.1.1.1.3" xref="alg1.l19.m1.4.4.2.1.1.1.1.3.cmml">i</mi><mrow id="alg1.l19.m1.2.2.1.3" xref="alg1.l19.m1.4.4.2.1.1.1.1.cmml"><mo id="alg1.l19.m1.2.2.1.3.1" stretchy="false" xref="alg1.l19.m1.4.4.2.1.1.1.1.cmml">(</mo><mi id="alg1.l19.m1.2.2.1.1" xref="alg1.l19.m1.2.2.1.1.cmml">u</mi><mo id="alg1.l19.m1.2.2.1.3.2" stretchy="false" xref="alg1.l19.m1.4.4.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l19.m1.4.4.2.1.1.1.3" stretchy="false" xref="alg1.l19.m1.4.4.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l19.m1.4.4.2.2" xref="alg1.l19.m1.4.4.2.2.cmml">+</mo><msub id="alg1.l19.m1.4.4.2.3" xref="alg1.l19.m1.4.4.2.3.cmml"><mi id="alg1.l19.m1.4.4.2.3.2" xref="alg1.l19.m1.4.4.2.3.2.cmml">r</mi><mi id="alg1.l19.m1.4.4.2.3.3" xref="alg1.l19.m1.4.4.2.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.4b"><apply id="alg1.l19.m1.4.4.cmml" xref="alg1.l19.m1.4.4"><ci id="alg1.l19.m1.4.4.3.cmml" xref="alg1.l19.m1.4.4.3">←</ci><apply id="alg1.l19.m1.3.3.1.cmml" xref="alg1.l19.m1.3.3.1"><times id="alg1.l19.m1.3.3.1.2.cmml" xref="alg1.l19.m1.3.3.1.2"></times><apply id="alg1.l19.m1.3.3.1.3.cmml" xref="alg1.l19.m1.3.3.1.3"><csymbol cd="ambiguous" id="alg1.l19.m1.3.3.1.3.1.cmml" xref="alg1.l19.m1.3.3.1.3">subscript</csymbol><ci id="alg1.l19.m1.3.3.1.3.2.cmml" xref="alg1.l19.m1.3.3.1.3.2">𝑅</ci><ci id="alg1.l19.m1.3.3.1.3.3.cmml" xref="alg1.l19.m1.3.3.1.3.3">𝑡</ci></apply><apply id="alg1.l19.m1.3.3.1.1.1.1.cmml" xref="alg1.l19.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l19.m1.3.3.1.1.1">subscript</csymbol><apply id="alg1.l19.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l19.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.3.3.1.1.1.1.2.1.cmml" xref="alg1.l19.m1.3.3.1.1.1">superscript</csymbol><ci id="alg1.l19.m1.3.3.1.1.1.1.2.2.cmml" xref="alg1.l19.m1.3.3.1.1.1.1.2.2">𝜏</ci><ci id="alg1.l19.m1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1">𝑢</ci></apply><ci id="alg1.l19.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l19.m1.3.3.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg1.l19.m1.4.4.2.cmml" xref="alg1.l19.m1.4.4.2"><plus id="alg1.l19.m1.4.4.2.2.cmml" xref="alg1.l19.m1.4.4.2.2"></plus><apply id="alg1.l19.m1.4.4.2.1.cmml" xref="alg1.l19.m1.4.4.2.1"><times id="alg1.l19.m1.4.4.2.1.2.cmml" xref="alg1.l19.m1.4.4.2.1.2"></times><ci id="alg1.l19.m1.4.4.2.1.3.cmml" xref="alg1.l19.m1.4.4.2.1.3">𝛾</ci><apply id="alg1.l19.m1.4.4.2.1.4.cmml" xref="alg1.l19.m1.4.4.2.1.4"><csymbol cd="ambiguous" id="alg1.l19.m1.4.4.2.1.4.1.cmml" xref="alg1.l19.m1.4.4.2.1.4">subscript</csymbol><ci id="alg1.l19.m1.4.4.2.1.4.2.cmml" xref="alg1.l19.m1.4.4.2.1.4.2">𝑅</ci><ci id="alg1.l19.m1.4.4.2.1.4.3.cmml" xref="alg1.l19.m1.4.4.2.1.4.3">𝑡</ci></apply><apply id="alg1.l19.m1.4.4.2.1.1.1.1.cmml" xref="alg1.l19.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.4.4.2.1.1.1.1.1.cmml" xref="alg1.l19.m1.4.4.2.1.1.1">subscript</csymbol><apply id="alg1.l19.m1.4.4.2.1.1.1.1.2.cmml" xref="alg1.l19.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.4.4.2.1.1.1.1.2.1.cmml" xref="alg1.l19.m1.4.4.2.1.1.1">superscript</csymbol><ci id="alg1.l19.m1.4.4.2.1.1.1.1.2.2.cmml" xref="alg1.l19.m1.4.4.2.1.1.1.1.2.2">𝜏</ci><ci id="alg1.l19.m1.2.2.1.1.cmml" xref="alg1.l19.m1.2.2.1.1">𝑢</ci></apply><ci id="alg1.l19.m1.4.4.2.1.1.1.1.3.cmml" xref="alg1.l19.m1.4.4.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg1.l19.m1.4.4.2.3.cmml" xref="alg1.l19.m1.4.4.2.3"><csymbol cd="ambiguous" id="alg1.l19.m1.4.4.2.3.1.cmml" xref="alg1.l19.m1.4.4.2.3">subscript</csymbol><ci id="alg1.l19.m1.4.4.2.3.2.cmml" xref="alg1.l19.m1.4.4.2.3.2">𝑟</ci><ci id="alg1.l19.m1.4.4.2.3.3.cmml" xref="alg1.l19.m1.4.4.2.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.4c">R_{t}(\tau^{(u)}_{i}){\leftarrow}{\gamma}R_{t}(\tau^{(u)}_{i}){+}r_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.4d">italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ← italic_γ italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="V(s_{t})\!\mathrel{+}=\!1" class="ltx_math_unparsed" display="inline" id="alg1.l19.m2.1"><semantics id="alg1.l19.m2.1a"><mrow id="alg1.l19.m2.1b"><mi id="alg1.l19.m2.1.1">V</mi><mrow id="alg1.l19.m2.1.2"><mo id="alg1.l19.m2.1.2.1" stretchy="false">(</mo><msub id="alg1.l19.m2.1.2.2"><mi id="alg1.l19.m2.1.2.2.2">s</mi><mi id="alg1.l19.m2.1.2.2.3">t</mi></msub><mo id="alg1.l19.m2.1.2.3" stretchy="false">)</mo></mrow><mo id="alg1.l19.m2.1.3" lspace="0.108em" rspace="0em">+</mo><mo id="alg1.l19.m2.1.4" lspace="0em" rspace="0.108em">=</mo><mn id="alg1.l19.m2.1.5">1</mn></mrow><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">V(s_{t})\!\mathrel{+}=\!1</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m2.1d">italic_V ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + = 1</annotation></semantics></math>, <math alttext="t{\mathrel{-}=}1" class="ltx_math_unparsed" display="inline" id="alg1.l19.m3.1"><semantics id="alg1.l19.m3.1a"><mrow id="alg1.l19.m3.1b"><mi id="alg1.l19.m3.1.1">t</mi><mo id="alg1.l19.m3.1.2" lspace="0.278em" rspace="0em">-</mo><mo id="alg1.l19.m3.1.3" lspace="0em">=</mo><mn id="alg1.l19.m3.1.4">1</mn></mrow><annotation encoding="application/x-tex" id="alg1.l19.m3.1c">t{\mathrel{-}=}1</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m3.1d">italic_t - = 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l20">      <span class="ltx_text ltx_font_bold" id="alg1.l20.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l20.2">while</span>
</div>
<div class="ltx_listingline" id="alg1.l21">   <span class="ltx_text ltx_font_bold" id="alg1.l21.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l21.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l22">   Save the highest-rewarded trajectory to the memory<span class="ltx_text" id="alg1.l22.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l22.1.m1.1"><semantics id="alg1.l22.1.m1.1a"><mo id="alg1.l22.1.m1.1.1" xref="alg1.l22.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l22.1.m1.1b"><ci id="alg1.l22.1.m1.1.1.cmml" xref="alg1.l22.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.1.m1.1d">▷</annotation></semantics></math> Training
</span>
</div>
<div class="ltx_listingline" id="alg1.l23">   Sample a batch of experiences, update <math alttext="\pi_{\phi}(o_{t}|s_{t})" class="ltx_Math" display="inline" id="alg1.l23.m1.1"><semantics id="alg1.l23.m1.1a"><mrow id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml"><msub id="alg1.l23.m1.1.1.3" xref="alg1.l23.m1.1.1.3.cmml"><mi id="alg1.l23.m1.1.1.3.2" xref="alg1.l23.m1.1.1.3.2.cmml">π</mi><mi id="alg1.l23.m1.1.1.3.3" xref="alg1.l23.m1.1.1.3.3.cmml">ϕ</mi></msub><mo id="alg1.l23.m1.1.1.2" xref="alg1.l23.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l23.m1.1.1.1.1" xref="alg1.l23.m1.1.1.1.1.1.cmml"><mo id="alg1.l23.m1.1.1.1.1.2" stretchy="false" xref="alg1.l23.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l23.m1.1.1.1.1.1" xref="alg1.l23.m1.1.1.1.1.1.cmml"><msub id="alg1.l23.m1.1.1.1.1.1.2" xref="alg1.l23.m1.1.1.1.1.1.2.cmml"><mi id="alg1.l23.m1.1.1.1.1.1.2.2" xref="alg1.l23.m1.1.1.1.1.1.2.2.cmml">o</mi><mi id="alg1.l23.m1.1.1.1.1.1.2.3" xref="alg1.l23.m1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="alg1.l23.m1.1.1.1.1.1.1" xref="alg1.l23.m1.1.1.1.1.1.1.cmml">|</mo><msub id="alg1.l23.m1.1.1.1.1.1.3" xref="alg1.l23.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l23.m1.1.1.1.1.1.3.2" xref="alg1.l23.m1.1.1.1.1.1.3.2.cmml">s</mi><mi id="alg1.l23.m1.1.1.1.1.1.3.3" xref="alg1.l23.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="alg1.l23.m1.1.1.1.1.3" stretchy="false" xref="alg1.l23.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><apply id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1"><times id="alg1.l23.m1.1.1.2.cmml" xref="alg1.l23.m1.1.1.2"></times><apply id="alg1.l23.m1.1.1.3.cmml" xref="alg1.l23.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.3.1.cmml" xref="alg1.l23.m1.1.1.3">subscript</csymbol><ci id="alg1.l23.m1.1.1.3.2.cmml" xref="alg1.l23.m1.1.1.3.2">𝜋</ci><ci id="alg1.l23.m1.1.1.3.3.cmml" xref="alg1.l23.m1.1.1.3.3">italic-ϕ</ci></apply><apply id="alg1.l23.m1.1.1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1.1"><csymbol cd="latexml" id="alg1.l23.m1.1.1.1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l23.m1.1.1.1.1.1.2.cmml" xref="alg1.l23.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l23.m1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l23.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l23.m1.1.1.1.1.1.2.2">𝑜</ci><ci id="alg1.l23.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l23.m1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l23.m1.1.1.1.1.1.3.cmml" xref="alg1.l23.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l23.m1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l23.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l23.m1.1.1.1.1.1.3.2">𝑠</ci><ci id="alg1.l23.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l23.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">\pi_{\phi}(o_{t}|s_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m1.1d">italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="Q_{\theta}(a_{t}|s_{t},o_{t})" class="ltx_Math" display="inline" id="alg1.l23.m2.1"><semantics id="alg1.l23.m2.1a"><mrow id="alg1.l23.m2.1.1" xref="alg1.l23.m2.1.1.cmml"><msub id="alg1.l23.m2.1.1.3" xref="alg1.l23.m2.1.1.3.cmml"><mi id="alg1.l23.m2.1.1.3.2" xref="alg1.l23.m2.1.1.3.2.cmml">Q</mi><mi id="alg1.l23.m2.1.1.3.3" xref="alg1.l23.m2.1.1.3.3.cmml">θ</mi></msub><mo id="alg1.l23.m2.1.1.2" xref="alg1.l23.m2.1.1.2.cmml">⁢</mo><mrow id="alg1.l23.m2.1.1.1.1" xref="alg1.l23.m2.1.1.1.1.1.cmml"><mo id="alg1.l23.m2.1.1.1.1.2" stretchy="false" xref="alg1.l23.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l23.m2.1.1.1.1.1" xref="alg1.l23.m2.1.1.1.1.1.cmml"><msub id="alg1.l23.m2.1.1.1.1.1.4" xref="alg1.l23.m2.1.1.1.1.1.4.cmml"><mi id="alg1.l23.m2.1.1.1.1.1.4.2" xref="alg1.l23.m2.1.1.1.1.1.4.2.cmml">a</mi><mi id="alg1.l23.m2.1.1.1.1.1.4.3" xref="alg1.l23.m2.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="alg1.l23.m2.1.1.1.1.1.3" xref="alg1.l23.m2.1.1.1.1.1.3.cmml">|</mo><mrow id="alg1.l23.m2.1.1.1.1.1.2.2" xref="alg1.l23.m2.1.1.1.1.1.2.3.cmml"><msub id="alg1.l23.m2.1.1.1.1.1.1.1.1" xref="alg1.l23.m2.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l23.m2.1.1.1.1.1.1.1.1.2" xref="alg1.l23.m2.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l23.m2.1.1.1.1.1.1.1.1.3" xref="alg1.l23.m2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l23.m2.1.1.1.1.1.2.2.3" xref="alg1.l23.m2.1.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l23.m2.1.1.1.1.1.2.2.2" xref="alg1.l23.m2.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l23.m2.1.1.1.1.1.2.2.2.2" xref="alg1.l23.m2.1.1.1.1.1.2.2.2.2.cmml">o</mi><mi id="alg1.l23.m2.1.1.1.1.1.2.2.2.3" xref="alg1.l23.m2.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="alg1.l23.m2.1.1.1.1.3" stretchy="false" xref="alg1.l23.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m2.1b"><apply id="alg1.l23.m2.1.1.cmml" xref="alg1.l23.m2.1.1"><times id="alg1.l23.m2.1.1.2.cmml" xref="alg1.l23.m2.1.1.2"></times><apply id="alg1.l23.m2.1.1.3.cmml" xref="alg1.l23.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l23.m2.1.1.3.1.cmml" xref="alg1.l23.m2.1.1.3">subscript</csymbol><ci id="alg1.l23.m2.1.1.3.2.cmml" xref="alg1.l23.m2.1.1.3.2">𝑄</ci><ci id="alg1.l23.m2.1.1.3.3.cmml" xref="alg1.l23.m2.1.1.3.3">𝜃</ci></apply><apply id="alg1.l23.m2.1.1.1.1.1.cmml" xref="alg1.l23.m2.1.1.1.1"><csymbol cd="latexml" id="alg1.l23.m2.1.1.1.1.1.3.cmml" xref="alg1.l23.m2.1.1.1.1.1.3">conditional</csymbol><apply id="alg1.l23.m2.1.1.1.1.1.4.cmml" xref="alg1.l23.m2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l23.m2.1.1.1.1.1.4.1.cmml" xref="alg1.l23.m2.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l23.m2.1.1.1.1.1.4.2.cmml" xref="alg1.l23.m2.1.1.1.1.1.4.2">𝑎</ci><ci id="alg1.l23.m2.1.1.1.1.1.4.3.cmml" xref="alg1.l23.m2.1.1.1.1.1.4.3">𝑡</ci></apply><list id="alg1.l23.m2.1.1.1.1.1.2.3.cmml" xref="alg1.l23.m2.1.1.1.1.1.2.2"><apply id="alg1.l23.m2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l23.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l23.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l23.m2.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l23.m2.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l23.m2.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l23.m2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l23.m2.1.1.1.1.1.2.2.2.cmml" xref="alg1.l23.m2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l23.m2.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l23.m2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l23.m2.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l23.m2.1.1.1.1.1.2.2.2.2">𝑜</ci><ci id="alg1.l23.m2.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l23.m2.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m2.1c">Q_{\theta}(a_{t}|s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m2.1d">italic_Q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_text ltx_font_bold" id="alg1.l24.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l24.2">for</span>
</div>
</div>
</figure>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Trajectory selection</h4>
<div class="ltx_para" id="S4.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.6"><span class="ltx_text" id="S4.SS3.SSS0.Px1.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.1.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p1.1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.1" xref="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.1.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1"><times id="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.1"></times><ci id="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.3a.cmml" xref="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.3"><mtext id="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> selects the most promising trajectory from the root node to a leaf node
that is likely to obtain a high future reward <math alttext="q(s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.2.m1.2"><semantics id="S4.SS3.SSS0.Px1.p1.2.m1.2a"><mrow id="S4.SS3.SSS0.Px1.p1.2.m1.2.2" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.cmml"><mi id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.4" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.4.cmml">q</mi><mo id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.3" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.3.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.3.cmml"><mo id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.3" stretchy="false" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.3.cmml">(</mo><msub id="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1" xref="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.4" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.3.cmml">,</mo><msub id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2.cmml"><mi id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2.2" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2.2.cmml">o</mi><mi id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2.3" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.5" stretchy="false" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.2.m1.2b"><apply id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2"><times id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.3"></times><ci id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.4.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.4">𝑞</ci><interval closure="open" id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2"><apply id="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2.2">𝑜</ci><ci id="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m1.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.2.m1.2c">q(s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.2.m1.2d">italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, and the selected trajectory will be further expanded for conversation simulation later.
This selection process trades off between exploitation, measured by <math alttext="q(s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.3.m2.2"><semantics id="S4.SS3.SSS0.Px1.p1.3.m2.2a"><mrow id="S4.SS3.SSS0.Px1.p1.3.m2.2.2" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.cmml"><mi id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.4" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.4.cmml">q</mi><mo id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.3" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.3.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.3.cmml"><mo id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.3" stretchy="false" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.3.cmml">(</mo><msub id="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1" xref="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.4" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.3.cmml">,</mo><msub id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2.cmml"><mi id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2.2" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2.2.cmml">o</mi><mi id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2.3" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.5" stretchy="false" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.3.m2.2b"><apply id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2"><times id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.3"></times><ci id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.4.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.4">𝑞</ci><interval closure="open" id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2"><apply id="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m2.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2.2">𝑜</ci><ci id="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.3.m2.2c">q(s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.3.m2.2d">italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>,
against exploration, measured by how often the nodes are visited.
Particularly, <span class="ltx_text" id="S4.SS3.SSS0.Px1.p1.4.2"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.4.2.m1.1"><semantics id="S4.SS3.SSS0.Px1.p1.4.2.m1.1a"><mrow id="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.1" xref="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.4.2.m1.1b"><apply id="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1"><times id="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.1"></times><ci id="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.2">𝚂</ci><ci id="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.3a.cmml" xref="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.3"><mtext id="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.4.2.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.4.2.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.4.2.m1.1d">typewriter_S -planner</annotation></semantics></math></span> adapts the Upper Confidence bounds applied to Trees (UCT) approach <cite class="ltx_cite ltx_citemacro_cite">Kocsis and Szepesvári (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib23" title="">2006</a>)</cite> to achieve the trade-off between exploitation and exploration,
and at each node <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.5.m3.1"><semantics id="S4.SS3.SSS0.Px1.p1.5.m3.1a"><msub id="S4.SS3.SSS0.Px1.p1.5.m3.1.1" xref="S4.SS3.SSS0.Px1.p1.5.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.5.m3.1.1.2" xref="S4.SS3.SSS0.Px1.p1.5.m3.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS0.Px1.p1.5.m3.1.1.3" xref="S4.SS3.SSS0.Px1.p1.5.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.5.m3.1b"><apply id="S4.SS3.SSS0.Px1.p1.5.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.5.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m3.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.5.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m3.1.1.2">𝑠</ci><ci id="S4.SS3.SSS0.Px1.p1.5.m3.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.5.m3.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.5.m3.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, select action type <math alttext="o^{*}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.6.m4.1"><semantics id="S4.SS3.SSS0.Px1.p1.6.m4.1a"><msubsup id="S4.SS3.SSS0.Px1.p1.6.m4.1.1" xref="S4.SS3.SSS0.Px1.p1.6.m4.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.6.m4.1.1.2.2" xref="S4.SS3.SSS0.Px1.p1.6.m4.1.1.2.2.cmml">o</mi><mi id="S4.SS3.SSS0.Px1.p1.6.m4.1.1.3" xref="S4.SS3.SSS0.Px1.p1.6.m4.1.1.3.cmml">t</mi><mo id="S4.SS3.SSS0.Px1.p1.6.m4.1.1.2.3" xref="S4.SS3.SSS0.Px1.p1.6.m4.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.6.m4.1b"><apply id="S4.SS3.SSS0.Px1.p1.6.m4.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.6.m4.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m4.1.1">subscript</csymbol><apply id="S4.SS3.SSS0.Px1.p1.6.m4.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.6.m4.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m4.1.1">superscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.6.m4.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m4.1.1.2.2">𝑜</ci><times id="S4.SS3.SSS0.Px1.p1.6.m4.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m4.1.1.2.3"></times></apply><ci id="S4.SS3.SSS0.Px1.p1.6.m4.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.6.m4.1c">o^{*}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.6.m4.1d">italic_o start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> into the trajectory that maximizes the UCT value as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="o^{*}_{t}{\leftarrow}\!\operatorname*{argmax}\limits_{o_{t}\in\{\!\mathtt{ask}%
,\mathtt{rec}\!\}}\!\bigg{[}\!q(s_{t},o_{t})\!+\!w\!\sqrt{\frac{\log V\!(s_{t}%
)}{V\!(f(s_{t},o_{t}))}}\bigg{]},\vspace{-0.1cm}" class="ltx_Math" display="block" id="S4.E2.m1.5"><semantics id="S4.E2.m1.5a"><mrow id="S4.E2.m1.5.5.1" xref="S4.E2.m1.5.5.1.1.cmml"><mrow id="S4.E2.m1.5.5.1.1" xref="S4.E2.m1.5.5.1.1.cmml"><msubsup id="S4.E2.m1.5.5.1.1.4" xref="S4.E2.m1.5.5.1.1.4.cmml"><mi id="S4.E2.m1.5.5.1.1.4.2.2" xref="S4.E2.m1.5.5.1.1.4.2.2.cmml">o</mi><mi id="S4.E2.m1.5.5.1.1.4.3" xref="S4.E2.m1.5.5.1.1.4.3.cmml">t</mi><mo id="S4.E2.m1.5.5.1.1.4.2.3" xref="S4.E2.m1.5.5.1.1.4.2.3.cmml">∗</mo></msubsup><mo id="S4.E2.m1.5.5.1.1.3" rspace="0.0539em" stretchy="false" xref="S4.E2.m1.5.5.1.1.3.cmml">←</mo><mrow id="S4.E2.m1.5.5.1.1.2.2" xref="S4.E2.m1.5.5.1.1.2.3.cmml"><munder id="S4.E2.m1.5.5.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.cmml"><mo id="S4.E2.m1.5.5.1.1.1.1.1.2" lspace="0.0539em" rspace="0em" xref="S4.E2.m1.5.5.1.1.1.1.1.2.cmml">argmax</mo><mrow id="S4.E2.m1.2.2.2" xref="S4.E2.m1.2.2.2.cmml"><msub id="S4.E2.m1.2.2.2.4" xref="S4.E2.m1.2.2.2.4.cmml"><mi id="S4.E2.m1.2.2.2.4.2" xref="S4.E2.m1.2.2.2.4.2.cmml">o</mi><mi id="S4.E2.m1.2.2.2.4.3" xref="S4.E2.m1.2.2.2.4.3.cmml">t</mi></msub><mo id="S4.E2.m1.2.2.2.3" xref="S4.E2.m1.2.2.2.3.cmml">∈</mo><mrow id="S4.E2.m1.2.2.2.5.2" xref="S4.E2.m1.2.2.2.5.1.cmml"><mpadded width="0.330em"><mo id="S4.E2.m1.2.2.2.5.2.1" stretchy="false" xref="S4.E2.m1.2.2.2.5.1.cmml">{</mo></mpadded><mi id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml">𝚊𝚜𝚔</mi><mo id="S4.E2.m1.2.2.2.5.2.2" xref="S4.E2.m1.2.2.2.5.1.cmml">,</mo><mpadded width="2.080em"><mi id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.2.cmml">𝚛𝚎𝚌</mi></mpadded><mo id="S4.E2.m1.2.2.2.5.2.3" stretchy="false" xref="S4.E2.m1.2.2.2.5.1.cmml">}</mo></mrow></mrow></munder><mrow id="S4.E2.m1.5.5.1.1.2.2.2" xref="S4.E2.m1.5.5.1.1.2.3.cmml"><mpadded width="0.247em"><mo id="S4.E2.m1.5.5.1.1.2.2.2.2" maxsize="210%" minsize="210%" xref="S4.E2.m1.5.5.1.1.2.3.cmml">[</mo></mpadded><mrow id="S4.E2.m1.5.5.1.1.2.2.2.1" xref="S4.E2.m1.5.5.1.1.2.2.2.1.cmml"><mrow id="S4.E2.m1.5.5.1.1.2.2.2.1.2" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.cmml"><mi id="S4.E2.m1.5.5.1.1.2.2.2.1.2.4" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.4.cmml">q</mi><mo id="S4.E2.m1.5.5.1.1.2.2.2.1.2.3" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.3.cmml">⁢</mo><mrow id="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.3.cmml"><mo id="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.3" stretchy="false" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.3.cmml">(</mo><msub id="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1.cmml"><mi id="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1.2" xref="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1.2.cmml">s</mi><mi id="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1.3" xref="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.4" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.3.cmml">,</mo><msub id="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2.cmml"><mi id="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2.2" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2.2.cmml">o</mi><mi id="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2.3" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.5" stretchy="false" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.5.5.1.1.2.2.2.1.3" lspace="0.052em" rspace="0.052em" xref="S4.E2.m1.5.5.1.1.2.2.2.1.3.cmml">+</mo><mrow id="S4.E2.m1.5.5.1.1.2.2.2.1.4" xref="S4.E2.m1.5.5.1.1.2.2.2.1.4.cmml"><mpadded width="0.573em"><mi id="S4.E2.m1.5.5.1.1.2.2.2.1.4.2" xref="S4.E2.m1.5.5.1.1.2.2.2.1.4.2.cmml">w</mi></mpadded><mo id="S4.E2.m1.5.5.1.1.2.2.2.1.4.1" xref="S4.E2.m1.5.5.1.1.2.2.2.1.4.1.cmml">⁢</mo><msqrt id="S4.E2.m1.4.4" xref="S4.E2.m1.4.4.cmml"><mfrac id="S4.E2.m1.4.4.2" xref="S4.E2.m1.4.4.2.cmml"><mrow id="S4.E2.m1.3.3.1.1.1" xref="S4.E2.m1.3.3.1.1.1.cmml"><mrow id="S4.E2.m1.3.3.1.1.1.3" xref="S4.E2.m1.3.3.1.1.1.3.cmml"><mi id="S4.E2.m1.3.3.1.1.1.3.1" xref="S4.E2.m1.3.3.1.1.1.3.1.cmml">log</mi><mo id="S4.E2.m1.3.3.1.1.1.3a" lspace="0.167em" xref="S4.E2.m1.3.3.1.1.1.3.cmml">⁡</mo><mpadded width="0.636em"><mi id="S4.E2.m1.3.3.1.1.1.3.2" xref="S4.E2.m1.3.3.1.1.1.3.2.cmml">V</mi></mpadded></mrow><mo id="S4.E2.m1.3.3.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.3.3.1.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E2.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E2.m1.3.3.1.1.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.3.3.1.1.1.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.E2.m1.3.3.1.1.1.1.1.1.3" xref="S4.E2.m1.3.3.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E2.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E2.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E2.m1.4.4.2.2.2" xref="S4.E2.m1.4.4.2.2.2.cmml"><mpadded width="0.636em"><mi id="S4.E2.m1.4.4.2.2.2.3" xref="S4.E2.m1.4.4.2.2.2.3.cmml">V</mi></mpadded><mo id="S4.E2.m1.4.4.2.2.2.2" xref="S4.E2.m1.4.4.2.2.2.2.cmml">⁢</mo><mrow id="S4.E2.m1.4.4.2.2.2.1.1" xref="S4.E2.m1.4.4.2.2.2.1.1.1.cmml"><mo id="S4.E2.m1.4.4.2.2.2.1.1.2" stretchy="false" xref="S4.E2.m1.4.4.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.4.4.2.2.2.1.1.1" xref="S4.E2.m1.4.4.2.2.2.1.1.1.cmml"><mi id="S4.E2.m1.4.4.2.2.2.1.1.1.4" xref="S4.E2.m1.4.4.2.2.2.1.1.1.4.cmml">f</mi><mo id="S4.E2.m1.4.4.2.2.2.1.1.1.3" xref="S4.E2.m1.4.4.2.2.2.1.1.1.3.cmml">⁢</mo><mrow id="S4.E2.m1.4.4.2.2.2.1.1.1.2.2" xref="S4.E2.m1.4.4.2.2.2.1.1.1.2.3.cmml"><mo id="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.3" stretchy="false" xref="S4.E2.m1.4.4.2.2.2.1.1.1.2.3.cmml">(</mo><msub id="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1" xref="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1.2" xref="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1.3" xref="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.4" xref="S4.E2.m1.4.4.2.2.2.1.1.1.2.3.cmml">,</mo><msub id="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2" xref="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2.cmml"><mi id="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2.2" xref="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2.2.cmml">o</mi><mi id="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2.3" xref="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2.3.cmml">t</mi></msub><mo id="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.5" stretchy="false" xref="S4.E2.m1.4.4.2.2.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.4.4.2.2.2.1.1.3" stretchy="false" xref="S4.E2.m1.4.4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></msqrt></mrow></mrow><mo id="S4.E2.m1.5.5.1.1.2.2.2.3" maxsize="210%" minsize="210%" xref="S4.E2.m1.5.5.1.1.2.3.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E2.m1.5.5.1.2" xref="S4.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.5b"><apply id="S4.E2.m1.5.5.1.1.cmml" xref="S4.E2.m1.5.5.1"><ci id="S4.E2.m1.5.5.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.3">←</ci><apply id="S4.E2.m1.5.5.1.1.4.cmml" xref="S4.E2.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.4.1.cmml" xref="S4.E2.m1.5.5.1.1.4">subscript</csymbol><apply id="S4.E2.m1.5.5.1.1.4.2.cmml" xref="S4.E2.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.4.2.1.cmml" xref="S4.E2.m1.5.5.1.1.4">superscript</csymbol><ci id="S4.E2.m1.5.5.1.1.4.2.2.cmml" xref="S4.E2.m1.5.5.1.1.4.2.2">𝑜</ci><times id="S4.E2.m1.5.5.1.1.4.2.3.cmml" xref="S4.E2.m1.5.5.1.1.4.2.3"></times></apply><ci id="S4.E2.m1.5.5.1.1.4.3.cmml" xref="S4.E2.m1.5.5.1.1.4.3">𝑡</ci></apply><apply id="S4.E2.m1.5.5.1.1.2.3.cmml" xref="S4.E2.m1.5.5.1.1.2.2"><apply id="S4.E2.m1.5.5.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.2">argmax</ci><apply id="S4.E2.m1.2.2.2.cmml" xref="S4.E2.m1.2.2.2"><in id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.3"></in><apply id="S4.E2.m1.2.2.2.4.cmml" xref="S4.E2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.4.1.cmml" xref="S4.E2.m1.2.2.2.4">subscript</csymbol><ci id="S4.E2.m1.2.2.2.4.2.cmml" xref="S4.E2.m1.2.2.2.4.2">𝑜</ci><ci id="S4.E2.m1.2.2.2.4.3.cmml" xref="S4.E2.m1.2.2.2.4.3">𝑡</ci></apply><set id="S4.E2.m1.2.2.2.5.1.cmml" xref="S4.E2.m1.2.2.2.5.2"><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝚊𝚜𝚔</ci><ci id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2">𝚛𝚎𝚌</ci></set></apply></apply><apply id="S4.E2.m1.5.5.1.1.2.2.2.1.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1"><plus id="S4.E2.m1.5.5.1.1.2.2.2.1.3.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.3"></plus><apply id="S4.E2.m1.5.5.1.1.2.2.2.1.2.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2"><times id="S4.E2.m1.5.5.1.1.2.2.2.1.2.3.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.3"></times><ci id="S4.E2.m1.5.5.1.1.2.2.2.1.2.4.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.4">𝑞</ci><interval closure="open" id="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.3.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2"><apply id="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1.2">𝑠</ci><ci id="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2.1.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2">subscript</csymbol><ci id="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2.2.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2.2">𝑜</ci><ci id="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2.3.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S4.E2.m1.5.5.1.1.2.2.2.1.4.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.4"><times id="S4.E2.m1.5.5.1.1.2.2.2.1.4.1.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.4.1"></times><ci id="S4.E2.m1.5.5.1.1.2.2.2.1.4.2.cmml" xref="S4.E2.m1.5.5.1.1.2.2.2.1.4.2">𝑤</ci><apply id="S4.E2.m1.4.4.cmml" xref="S4.E2.m1.4.4"><root id="S4.E2.m1.4.4a.cmml" xref="S4.E2.m1.4.4"></root><apply id="S4.E2.m1.4.4.2.cmml" xref="S4.E2.m1.4.4.2"><divide id="S4.E2.m1.4.4.2.3.cmml" xref="S4.E2.m1.4.4.2"></divide><apply id="S4.E2.m1.3.3.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1"><times id="S4.E2.m1.3.3.1.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.1.2"></times><apply id="S4.E2.m1.3.3.1.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.1.3"><log id="S4.E2.m1.3.3.1.1.1.3.1.cmml" xref="S4.E2.m1.3.3.1.1.1.3.1"></log><ci id="S4.E2.m1.3.3.1.1.1.3.2.cmml" xref="S4.E2.m1.3.3.1.1.1.3.2">𝑉</ci></apply><apply id="S4.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.E2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S4.E2.m1.4.4.2.2.2.cmml" xref="S4.E2.m1.4.4.2.2.2"><times id="S4.E2.m1.4.4.2.2.2.2.cmml" xref="S4.E2.m1.4.4.2.2.2.2"></times><ci id="S4.E2.m1.4.4.2.2.2.3.cmml" xref="S4.E2.m1.4.4.2.2.2.3">𝑉</ci><apply id="S4.E2.m1.4.4.2.2.2.1.1.1.cmml" xref="S4.E2.m1.4.4.2.2.2.1.1"><times id="S4.E2.m1.4.4.2.2.2.1.1.1.3.cmml" xref="S4.E2.m1.4.4.2.2.2.1.1.1.3"></times><ci id="S4.E2.m1.4.4.2.2.2.1.1.1.4.cmml" xref="S4.E2.m1.4.4.2.2.2.1.1.1.4">𝑓</ci><interval closure="open" id="S4.E2.m1.4.4.2.2.2.1.1.1.2.3.cmml" xref="S4.E2.m1.4.4.2.2.2.1.1.1.2.2"><apply id="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.4.4.2.2.2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2.cmml" xref="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2.1.cmml" xref="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2.2.cmml" xref="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2.2">𝑜</ci><ci id="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2.3.cmml" xref="S4.E2.m1.4.4.2.2.2.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.5c">o^{*}_{t}{\leftarrow}\!\operatorname*{argmax}\limits_{o_{t}\in\{\!\mathtt{ask}%
,\mathtt{rec}\!\}}\!\bigg{[}\!q(s_{t},o_{t})\!+\!w\!\sqrt{\frac{\log V\!(s_{t}%
)}{V\!(f(s_{t},o_{t}))}}\bigg{]},\vspace{-0.1cm}</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.5d">italic_o start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← roman_argmax start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ { typewriter_ask , typewriter_rec } end_POSTSUBSCRIPT [ italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + italic_w square-root start_ARG divide start_ARG roman_log italic_V ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG start_ARG italic_V ( italic_f ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) end_ARG end_ARG ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.15">where <math alttext="w&gt;0" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.7.m1.1"><semantics id="S4.SS3.SSS0.Px1.p1.7.m1.1a"><mrow id="S4.SS3.SSS0.Px1.p1.7.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.7.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.7.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.7.m1.1.1.2.cmml">w</mi><mo id="S4.SS3.SSS0.Px1.p1.7.m1.1.1.1" xref="S4.SS3.SSS0.Px1.p1.7.m1.1.1.1.cmml">&gt;</mo><mn id="S4.SS3.SSS0.Px1.p1.7.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.7.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.7.m1.1b"><apply id="S4.SS3.SSS0.Px1.p1.7.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m1.1.1"><gt id="S4.SS3.SSS0.Px1.p1.7.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m1.1.1.1"></gt><ci id="S4.SS3.SSS0.Px1.p1.7.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m1.1.1.2">𝑤</ci><cn id="S4.SS3.SSS0.Px1.p1.7.m1.1.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px1.p1.7.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.7.m1.1c">w&gt;0</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.7.m1.1d">italic_w &gt; 0</annotation></semantics></math> is the exploration factor,
<math alttext="V(s_{t})" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.8.m2.1"><semantics id="S4.SS3.SSS0.Px1.p1.8.m2.1a"><mrow id="S4.SS3.SSS0.Px1.p1.8.m2.1.1" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.3" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.3.cmml">V</mi><mo id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.2" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.cmml"><mo id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.2" stretchy="false" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.cmml">(</mo><msub id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.3" stretchy="false" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.8.m2.1b"><apply id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1"><times id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.2"></times><ci id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.3">𝑉</ci><apply id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.8.m2.1c">V(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.8.m2.1d">italic_V ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> quantifies the visits on node <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.9.m3.1"><semantics id="S4.SS3.SSS0.Px1.p1.9.m3.1a"><msub id="S4.SS3.SSS0.Px1.p1.9.m3.1.1" xref="S4.SS3.SSS0.Px1.p1.9.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.9.m3.1.1.2" xref="S4.SS3.SSS0.Px1.p1.9.m3.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS0.Px1.p1.9.m3.1.1.3" xref="S4.SS3.SSS0.Px1.p1.9.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.9.m3.1b"><apply id="S4.SS3.SSS0.Px1.p1.9.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.9.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.9.m3.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.9.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.9.m3.1.1.2">𝑠</ci><ci id="S4.SS3.SSS0.Px1.p1.9.m3.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.9.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.9.m3.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.9.m3.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> during conversation simulations, and
<math alttext="f(s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.10.m4.2"><semantics id="S4.SS3.SSS0.Px1.p1.10.m4.2a"><mrow id="S4.SS3.SSS0.Px1.p1.10.m4.2.2" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.cmml"><mi id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.4" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.4.cmml">f</mi><mo id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.3" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.3.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.3.cmml"><mo id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.3" stretchy="false" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.3.cmml">(</mo><msub id="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1" xref="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.4" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.3.cmml">,</mo><msub id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2.cmml"><mi id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2.2" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2.2.cmml">o</mi><mi id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2.3" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.5" stretchy="false" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.10.m4.2b"><apply id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2"><times id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.3"></times><ci id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.4.cmml" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.4">𝑓</ci><interval closure="open" id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2"><apply id="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.10.m4.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2.1.cmml" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2.2">𝑜</ci><ci id="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.10.m4.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.10.m4.2c">f(s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.10.m4.2d">italic_f ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> represents the child node of <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.11.m5.1"><semantics id="S4.SS3.SSS0.Px1.p1.11.m5.1a"><msub id="S4.SS3.SSS0.Px1.p1.11.m5.1.1" xref="S4.SS3.SSS0.Px1.p1.11.m5.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.11.m5.1.1.2" xref="S4.SS3.SSS0.Px1.p1.11.m5.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS0.Px1.p1.11.m5.1.1.3" xref="S4.SS3.SSS0.Px1.p1.11.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.11.m5.1b"><apply id="S4.SS3.SSS0.Px1.p1.11.m5.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.11.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.11.m5.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.11.m5.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.11.m5.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.11.m5.1.1.2">𝑠</ci><ci id="S4.SS3.SSS0.Px1.p1.11.m5.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.11.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.11.m5.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.11.m5.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> after choosing the action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.12.m6.1"><semantics id="S4.SS3.SSS0.Px1.p1.12.m6.1a"><msub id="S4.SS3.SSS0.Px1.p1.12.m6.1.1" xref="S4.SS3.SSS0.Px1.p1.12.m6.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.12.m6.1.1.2" xref="S4.SS3.SSS0.Px1.p1.12.m6.1.1.2.cmml">o</mi><mi id="S4.SS3.SSS0.Px1.p1.12.m6.1.1.3" xref="S4.SS3.SSS0.Px1.p1.12.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.12.m6.1b"><apply id="S4.SS3.SSS0.Px1.p1.12.m6.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.12.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.12.m6.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.12.m6.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.12.m6.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.12.m6.1.1.2">𝑜</ci><ci id="S4.SS3.SSS0.Px1.p1.12.m6.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.12.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.12.m6.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.12.m6.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
Intuitively, the second term in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.E2" title='In Trajectory selection ‣ 4.3 𝚂⁢"-planner" ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search'><span class="ltx_text ltx_ref_tag">2</span></a> is larger if the child node is less visited,
encouraging more exploration.
After selecting the action type <math alttext="o_{t}^{*}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.13.m7.1"><semantics id="S4.SS3.SSS0.Px1.p1.13.m7.1a"><msubsup id="S4.SS3.SSS0.Px1.p1.13.m7.1.1" xref="S4.SS3.SSS0.Px1.p1.13.m7.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.13.m7.1.1.2.2" xref="S4.SS3.SSS0.Px1.p1.13.m7.1.1.2.2.cmml">o</mi><mi id="S4.SS3.SSS0.Px1.p1.13.m7.1.1.2.3" xref="S4.SS3.SSS0.Px1.p1.13.m7.1.1.2.3.cmml">t</mi><mo id="S4.SS3.SSS0.Px1.p1.13.m7.1.1.3" xref="S4.SS3.SSS0.Px1.p1.13.m7.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.13.m7.1b"><apply id="S4.SS3.SSS0.Px1.p1.13.m7.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.13.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.13.m7.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.13.m7.1.1">superscript</csymbol><apply id="S4.SS3.SSS0.Px1.p1.13.m7.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.13.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.13.m7.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px1.p1.13.m7.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.13.m7.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.13.m7.1.1.2.2">𝑜</ci><ci id="S4.SS3.SSS0.Px1.p1.13.m7.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.13.m7.1.1.2.3">𝑡</ci></apply><times id="S4.SS3.SSS0.Px1.p1.13.m7.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.13.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.13.m7.1c">o_{t}^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.13.m7.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, <span class="ltx_text" id="S4.SS3.SSS0.Px1.p1.14.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.14.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p1.14.1.m1.1a"><mrow id="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.1" xref="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.14.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1"><times id="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.1"></times><ci id="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.2">𝚂</ci><ci id="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.3a.cmml" xref="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.3"><mtext id="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.14.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.14.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.14.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> chooses the optimal action <math alttext="a^{*}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.15.m8.1"><semantics id="S4.SS3.SSS0.Px1.p1.15.m8.1a"><msubsup id="S4.SS3.SSS0.Px1.p1.15.m8.1.1" xref="S4.SS3.SSS0.Px1.p1.15.m8.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.15.m8.1.1.2.2" xref="S4.SS3.SSS0.Px1.p1.15.m8.1.1.2.2.cmml">a</mi><mi id="S4.SS3.SSS0.Px1.p1.15.m8.1.1.3" xref="S4.SS3.SSS0.Px1.p1.15.m8.1.1.3.cmml">t</mi><mo id="S4.SS3.SSS0.Px1.p1.15.m8.1.1.2.3" xref="S4.SS3.SSS0.Px1.p1.15.m8.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.15.m8.1b"><apply id="S4.SS3.SSS0.Px1.p1.15.m8.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.15.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.15.m8.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.15.m8.1.1">subscript</csymbol><apply id="S4.SS3.SSS0.Px1.p1.15.m8.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.15.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.15.m8.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px1.p1.15.m8.1.1">superscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.15.m8.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.15.m8.1.1.2.2">𝑎</ci><times id="S4.SS3.SSS0.Px1.p1.15.m8.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.15.m8.1.1.2.3"></times></apply><ci id="S4.SS3.SSS0.Px1.p1.15.m8.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.15.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.15.m8.1c">a^{*}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.15.m8.1d">italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> with the Q-network as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="a^{*}_{t}\leftarrow\operatorname*{argmax}\limits_{a_{t}\in\mathcal{A}_{s_{t},o%
^{*}_{t}}}Q_{\theta}(a_{t}|s_{t},o^{*}_{t})." class="ltx_Math" display="block" id="S4.E3.m1.3"><semantics id="S4.E3.m1.3a"><mrow id="S4.E3.m1.3.3.1" xref="S4.E3.m1.3.3.1.1.cmml"><mrow id="S4.E3.m1.3.3.1.1" xref="S4.E3.m1.3.3.1.1.cmml"><msubsup id="S4.E3.m1.3.3.1.1.3" xref="S4.E3.m1.3.3.1.1.3.cmml"><mi id="S4.E3.m1.3.3.1.1.3.2.2" xref="S4.E3.m1.3.3.1.1.3.2.2.cmml">a</mi><mi id="S4.E3.m1.3.3.1.1.3.3" xref="S4.E3.m1.3.3.1.1.3.3.cmml">t</mi><mo id="S4.E3.m1.3.3.1.1.3.2.3" xref="S4.E3.m1.3.3.1.1.3.2.3.cmml">∗</mo></msubsup><mo id="S4.E3.m1.3.3.1.1.2" rspace="0.1389em" stretchy="false" xref="S4.E3.m1.3.3.1.1.2.cmml">←</mo><mrow id="S4.E3.m1.3.3.1.1.1" xref="S4.E3.m1.3.3.1.1.1.cmml"><mrow id="S4.E3.m1.3.3.1.1.1.3" xref="S4.E3.m1.3.3.1.1.1.3.cmml"><munder id="S4.E3.m1.3.3.1.1.1.3.1" xref="S4.E3.m1.3.3.1.1.1.3.1.cmml"><mo id="S4.E3.m1.3.3.1.1.1.3.1.2" lspace="0.1389em" rspace="0.167em" xref="S4.E3.m1.3.3.1.1.1.3.1.2.cmml">argmax</mo><mrow id="S4.E3.m1.2.2.2" xref="S4.E3.m1.2.2.2.cmml"><msub id="S4.E3.m1.2.2.2.4" xref="S4.E3.m1.2.2.2.4.cmml"><mi id="S4.E3.m1.2.2.2.4.2" xref="S4.E3.m1.2.2.2.4.2.cmml">a</mi><mi id="S4.E3.m1.2.2.2.4.3" xref="S4.E3.m1.2.2.2.4.3.cmml">t</mi></msub><mo id="S4.E3.m1.2.2.2.3" xref="S4.E3.m1.2.2.2.3.cmml">∈</mo><msub id="S4.E3.m1.2.2.2.5" xref="S4.E3.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.2.2.2.5.2" xref="S4.E3.m1.2.2.2.5.2.cmml">𝒜</mi><mrow id="S4.E3.m1.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.3.cmml"><msub id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E3.m1.2.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.2.3.cmml">,</mo><msubsup id="S4.E3.m1.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.cmml">o</mi><mi id="S4.E3.m1.2.2.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.2.2.2.3.cmml">t</mi><mo id="S4.E3.m1.2.2.2.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.2.2.2.2.3.cmml">∗</mo></msubsup></mrow></msub></mrow></munder><msub id="S4.E3.m1.3.3.1.1.1.3.2" xref="S4.E3.m1.3.3.1.1.1.3.2.cmml"><mi id="S4.E3.m1.3.3.1.1.1.3.2.2" xref="S4.E3.m1.3.3.1.1.1.3.2.2.cmml">Q</mi><mi id="S4.E3.m1.3.3.1.1.1.3.2.3" xref="S4.E3.m1.3.3.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S4.E3.m1.3.3.1.1.1.2" xref="S4.E3.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3.m1.3.3.1.1.1.1.1" xref="S4.E3.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E3.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.3.3.1.1.1.1.1.1" xref="S4.E3.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S4.E3.m1.3.3.1.1.1.1.1.1.4" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.cmml"><mi id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.cmml">a</mi><mi id="S4.E3.m1.3.3.1.1.1.1.1.1.4.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S4.E3.m1.3.3.1.1.1.1.1.1.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml"><msub id="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.cmml">o</mi><mi id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml">t</mi><mo id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.cmml">∗</mo></msubsup></mrow></mrow><mo id="S4.E3.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E3.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.3.3.1.2" lspace="0em" xref="S4.E3.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.3b"><apply id="S4.E3.m1.3.3.1.1.cmml" xref="S4.E3.m1.3.3.1"><ci id="S4.E3.m1.3.3.1.1.2.cmml" xref="S4.E3.m1.3.3.1.1.2">←</ci><apply id="S4.E3.m1.3.3.1.1.3.cmml" xref="S4.E3.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.3.1.cmml" xref="S4.E3.m1.3.3.1.1.3">subscript</csymbol><apply id="S4.E3.m1.3.3.1.1.3.2.cmml" xref="S4.E3.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.3.2.1.cmml" xref="S4.E3.m1.3.3.1.1.3">superscript</csymbol><ci id="S4.E3.m1.3.3.1.1.3.2.2.cmml" xref="S4.E3.m1.3.3.1.1.3.2.2">𝑎</ci><times id="S4.E3.m1.3.3.1.1.3.2.3.cmml" xref="S4.E3.m1.3.3.1.1.3.2.3"></times></apply><ci id="S4.E3.m1.3.3.1.1.3.3.cmml" xref="S4.E3.m1.3.3.1.1.3.3">𝑡</ci></apply><apply id="S4.E3.m1.3.3.1.1.1.cmml" xref="S4.E3.m1.3.3.1.1.1"><times id="S4.E3.m1.3.3.1.1.1.2.cmml" xref="S4.E3.m1.3.3.1.1.1.2"></times><apply id="S4.E3.m1.3.3.1.1.1.3.cmml" xref="S4.E3.m1.3.3.1.1.1.3"><apply id="S4.E3.m1.3.3.1.1.1.3.1.cmml" xref="S4.E3.m1.3.3.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.1.3.1.1.cmml" xref="S4.E3.m1.3.3.1.1.1.3.1">subscript</csymbol><ci id="S4.E3.m1.3.3.1.1.1.3.1.2.cmml" xref="S4.E3.m1.3.3.1.1.1.3.1.2">argmax</ci><apply id="S4.E3.m1.2.2.2.cmml" xref="S4.E3.m1.2.2.2"><in id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.3"></in><apply id="S4.E3.m1.2.2.2.4.cmml" xref="S4.E3.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.4.1.cmml" xref="S4.E3.m1.2.2.2.4">subscript</csymbol><ci id="S4.E3.m1.2.2.2.4.2.cmml" xref="S4.E3.m1.2.2.2.4.2">𝑎</ci><ci id="S4.E3.m1.2.2.2.4.3.cmml" xref="S4.E3.m1.2.2.2.4.3">𝑡</ci></apply><apply id="S4.E3.m1.2.2.2.5.cmml" xref="S4.E3.m1.2.2.2.5"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.5.1.cmml" xref="S4.E3.m1.2.2.2.5">subscript</csymbol><ci id="S4.E3.m1.2.2.2.5.2.cmml" xref="S4.E3.m1.2.2.2.5.2">𝒜</ci><list id="S4.E3.m1.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2"><apply id="S4.E3.m1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.E3.m1.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2">subscript</csymbol><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2">𝑜</ci><times id="S4.E3.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.3"></times></apply><ci id="S4.E3.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.3">𝑡</ci></apply></list></apply></apply></apply><apply id="S4.E3.m1.3.3.1.1.1.3.2.cmml" xref="S4.E3.m1.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.1.3.2.1.cmml" xref="S4.E3.m1.3.3.1.1.1.3.2">subscript</csymbol><ci id="S4.E3.m1.3.3.1.1.1.3.2.2.cmml" xref="S4.E3.m1.3.3.1.1.1.3.2.2">𝑄</ci><ci id="S4.E3.m1.3.3.1.1.1.3.2.3.cmml" xref="S4.E3.m1.3.3.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S4.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.3">conditional</csymbol><apply id="S4.E3.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.1.1.1.1.4.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2">𝑎</ci><ci id="S4.E3.m1.3.3.1.1.1.1.1.1.4.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S4.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.2"><apply id="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.2">𝑜</ci><times id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.3"></times></apply><ci id="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.3c">a^{*}_{t}\leftarrow\operatorname*{argmax}\limits_{a_{t}\in\mathcal{A}_{s_{t},o%
^{*}_{t}}}Q_{\theta}(a_{t}|s_{t},o^{*}_{t}).</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.3d">italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← roman_argmax start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_A start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Node Expansion</h4>
<div class="ltx_para" id="S4.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.8">When a leaf node is reached,
<span class="ltx_text" id="S4.SS3.SSS0.Px2.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.1.1.m1.1"><semantics id="S4.SS3.SSS0.Px2.p1.1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.1.m1.1b"><apply id="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1"><times id="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.1"></times><ci id="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.3a.cmml" xref="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.3"><mtext id="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> expands the leaf node by attaching two children nodes (corresponding to two action types <math alttext="\mathtt{ask}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.2.m1.1"><semantics id="S4.SS3.SSS0.Px2.p1.2.m1.1a"><mi id="S4.SS3.SSS0.Px2.p1.2.m1.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m1.1.1.cmml">𝚊𝚜𝚔</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.2.m1.1b"><ci id="S4.SS3.SSS0.Px2.p1.2.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m1.1.1">𝚊𝚜𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.2.m1.1c">\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.2.m1.1d">typewriter_ask</annotation></semantics></math> and <math alttext="\mathtt{rec}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.3.m2.1"><semantics id="S4.SS3.SSS0.Px2.p1.3.m2.1a"><mi id="S4.SS3.SSS0.Px2.p1.3.m2.1.1" xref="S4.SS3.SSS0.Px2.p1.3.m2.1.1.cmml">𝚛𝚎𝚌</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.3.m2.1b"><ci id="S4.SS3.SSS0.Px2.p1.3.m2.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m2.1.1">𝚛𝚎𝚌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.3.m2.1c">\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.3.m2.1d">typewriter_rec</annotation></semantics></math>) to it.
The expected future reward <math alttext="q(s_{t+1},o_{t+1})" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.4.m3.2"><semantics id="S4.SS3.SSS0.Px2.p1.4.m3.2a"><mrow id="S4.SS3.SSS0.Px2.p1.4.m3.2.2" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.cmml"><mi id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.4" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.4.cmml">q</mi><mo id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.3" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.3.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.3.cmml"><mo id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.3" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.3.cmml">(</mo><msub id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.2.cmml">s</mi><mrow id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.2" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.2.cmml">t</mi><mo id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.1" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.3" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.4" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.3.cmml">,</mo><msub id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.cmml"><mi id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.2" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.2.cmml">o</mi><mrow id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.2" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.2.cmml">t</mi><mo id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.1" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.1.cmml">+</mo><mn id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.3" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.5" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.4.m3.2b"><apply id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2"><times id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.3.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.3"></times><ci id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.4.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.4">𝑞</ci><interval closure="open" id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2"><apply id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.2">𝑠</ci><apply id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3"><plus id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.1"></plus><ci id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.2">𝑡</ci><cn id="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.4.m3.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.1.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.2">𝑜</ci><apply id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3"><plus id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.1"></plus><ci id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.2">𝑡</ci><cn id="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.4.m3.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.4.m3.2c">q(s_{t+1},o_{t+1})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.4.m3.2d">italic_q ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math> of choosing <math alttext="o_{t+1}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.5.m4.1"><semantics id="S4.SS3.SSS0.Px2.p1.5.m4.1a"><msub id="S4.SS3.SSS0.Px2.p1.5.m4.1.1" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.5.m4.1.1.2" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1.2.cmml">o</mi><mrow id="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.2" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.2.cmml">t</mi><mo id="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.1" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.1.cmml">+</mo><mn id="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.3" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.5.m4.1b"><apply id="S4.SS3.SSS0.Px2.p1.5.m4.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.5.m4.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.5.m4.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1.2">𝑜</ci><apply id="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3"><plus id="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.1"></plus><ci id="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.2">𝑡</ci><cn id="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.5.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.5.m4.1c">o_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.5.m4.1d">italic_o start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> at the newly attached node <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.6.m5.1"><semantics id="S4.SS3.SSS0.Px2.p1.6.m5.1a"><msub id="S4.SS3.SSS0.Px2.p1.6.m5.1.1" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.6.m5.1.1.2" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1.2.cmml">s</mi><mrow id="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.2" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.2.cmml">t</mi><mo id="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.1" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.1.cmml">+</mo><mn id="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.3" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.6.m5.1b"><apply id="S4.SS3.SSS0.Px2.p1.6.m5.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.6.m5.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.6.m5.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1.2">𝑠</ci><apply id="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3"><plus id="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.1"></plus><ci id="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.2">𝑡</ci><cn id="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.6.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.6.m5.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.6.m5.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> is initialized as the highest value estimated by the Q-network <math alttext="Q_{\theta}(a_{t+1}|s_{t+1},o_{t+1})" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.7.m6.1"><semantics id="S4.SS3.SSS0.Px2.p1.7.m6.1a"><mrow id="S4.SS3.SSS0.Px2.p1.7.m6.1.1" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.cmml"><msub id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3.2" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3.2.cmml">Q</mi><mi id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3.3" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.2" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.cmml"><mo id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.2" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.cmml"><msub id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.cmml"><mi id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.2" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.2.cmml">a</mi><mrow id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.2" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.1" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.3" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.3.cmml"><msub id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.2" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.1" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.3" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.3" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.2" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.2.cmml">o</mi><mrow id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.2" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.1" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.1.cmml">+</mo><mn id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.3" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.3" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.7.m6.1b"><apply id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1"><times id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.2"></times><apply id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3.2">𝑄</ci><ci id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.3.3">𝜃</ci></apply><apply id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.3">conditional</csymbol><apply id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.2.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.2">𝑎</ci><apply id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3"><plus id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.1"></plus><ci id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.2">𝑡</ci><cn id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2"><apply id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.2">𝑠</ci><apply id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3"><plus id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.1"></plus><ci id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.2">𝑜</ci><apply id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3"><plus id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.1"></plus><ci id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.2">𝑡</ci><cn id="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.7.m6.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.7.m6.1c">Q_{\theta}(a_{t+1}|s_{t+1},o_{t+1})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.7.m6.1d">italic_Q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math>
among all the candidate actions in the sub action space <math alttext="\mathcal{A}_{s_{t+1},o_{t+1}}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.8.m7.2"><semantics id="S4.SS3.SSS0.Px2.p1.8.m7.2a"><msub id="S4.SS3.SSS0.Px2.p1.8.m7.2.3" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS0.Px2.p1.8.m7.2.3.2" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.3.2.cmml">𝒜</mi><mrow id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.3.cmml"><msub id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.2.cmml">s</mi><mrow id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.2" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.2.cmml">t</mi><mo id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.1" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.3" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.3" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.3.cmml">,</mo><msub id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.cmml"><mi id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.2" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.2.cmml">o</mi><mrow id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.2" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.2.cmml">t</mi><mo id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.1" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.1.cmml">+</mo><mn id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.3" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.8.m7.2b"><apply id="S4.SS3.SSS0.Px2.p1.8.m7.2.3.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.8.m7.2.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.3">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.8.m7.2.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.3.2">𝒜</ci><list id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2"><apply id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.2">𝑠</ci><apply id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3"><plus id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.1"></plus><ci id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.2">𝑡</ci><cn id="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.8.m7.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.1.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.2">𝑜</ci><apply id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3"><plus id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.1"></plus><ci id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.2">𝑡</ci><cn id="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.8.m7.2.2.2.2.2.3.3">1</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.8.m7.2c">\mathcal{A}_{s_{t+1},o_{t+1}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.8.m7.2d">caligraphic_A start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, serving as a heuristic guidance for the future tree search.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Conversation Simulation</h4>
<div class="ltx_para" id="S4.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px3.p1.2">To predict how the future conversation unfolds, <span class="ltx_text" id="S4.SS3.SSS0.Px3.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px3.p1.1.1.m1.1"><semantics id="S4.SS3.SSS0.Px3.p1.1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1" xref="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.1" xref="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.1.1.m1.1b"><apply id="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1"><times id="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.1"></times><ci id="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.3a.cmml" xref="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.3"><mtext id="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px3.p1.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> continues to simulate conversations between <span class="ltx_text" id="S4.SS3.SSS0.Px3.p1.2.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px3.p1.2.2.m1.1"><semantics id="S4.SS3.SSS0.Px3.p1.2.2.m1.1a"><mrow id="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1" xref="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.2" xref="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.1" xref="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.3" xref="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.2.2.m1.1b"><apply id="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1"><times id="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.1"></times><ci id="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.2">𝚂</ci><ci id="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.3a.cmml" xref="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.3"><mtext id="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.2.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.2.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px3.p1.2.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> and the user until the conversation succeeds or fails. Starting from the last expanded node, at each turn, the policy network decides the action type, while the Q-network decides the specific action.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Reward Back-propagation</h4>
<div class="ltx_para" id="S4.SS3.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px4.p1.5">Once the simulated conversation succeeds or fails, <span class="ltx_text" id="S4.SS3.SSS0.Px4.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px4.p1.1.1.m1.1"><semantics id="S4.SS3.SSS0.Px4.p1.1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1" xref="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.1" xref="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px4.p1.1.1.m1.1b"><apply id="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1"><times id="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.1"></times><ci id="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.3a.cmml" xref="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.3"><mtext id="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px4.p1.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px4.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px4.p1.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> back-propagates from the leaf node of the current trajectory <math alttext="\tau^{(u)}_{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px4.p1.2.m1.1"><semantics id="S4.SS3.SSS0.Px4.p1.2.m1.1a"><msubsup id="S4.SS3.SSS0.Px4.p1.2.m1.1.2" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.2.cmml"><mi id="S4.SS3.SSS0.Px4.p1.2.m1.1.2.2.2" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.2.2.2.cmml">τ</mi><mi id="S4.SS3.SSS0.Px4.p1.2.m1.1.2.3" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.2.3.cmml">i</mi><mrow id="S4.SS3.SSS0.Px4.p1.2.m1.1.1.1.3" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.2.cmml"><mo id="S4.SS3.SSS0.Px4.p1.2.m1.1.1.1.3.1" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.2.cmml">(</mo><mi id="S4.SS3.SSS0.Px4.p1.2.m1.1.1.1.1" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.1.1.1.cmml">u</mi><mo id="S4.SS3.SSS0.Px4.p1.2.m1.1.1.1.3.2" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px4.p1.2.m1.1b"><apply id="S4.SS3.SSS0.Px4.p1.2.m1.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.2.m1.1.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.2">subscript</csymbol><apply id="S4.SS3.SSS0.Px4.p1.2.m1.1.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.2.m1.1.2.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.2">superscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.2.m1.1.2.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.2.2.2">𝜏</ci><ci id="S4.SS3.SSS0.Px4.p1.2.m1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.1.1.1">𝑢</ci></apply><ci id="S4.SS3.SSS0.Px4.p1.2.m1.1.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.2.m1.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px4.p1.2.m1.1c">\tau^{(u)}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px4.p1.2.m1.1d">italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to the root to increase the visit count of each node along <math alttext="\tau^{(u)}_{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px4.p1.3.m2.1"><semantics id="S4.SS3.SSS0.Px4.p1.3.m2.1a"><msubsup id="S4.SS3.SSS0.Px4.p1.3.m2.1.2" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.2.cmml"><mi id="S4.SS3.SSS0.Px4.p1.3.m2.1.2.2.2" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.2.2.2.cmml">τ</mi><mi id="S4.SS3.SSS0.Px4.p1.3.m2.1.2.3" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.2.3.cmml">i</mi><mrow id="S4.SS3.SSS0.Px4.p1.3.m2.1.1.1.3" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.2.cmml"><mo id="S4.SS3.SSS0.Px4.p1.3.m2.1.1.1.3.1" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.2.cmml">(</mo><mi id="S4.SS3.SSS0.Px4.p1.3.m2.1.1.1.1" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.1.1.1.cmml">u</mi><mo id="S4.SS3.SSS0.Px4.p1.3.m2.1.1.1.3.2" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px4.p1.3.m2.1b"><apply id="S4.SS3.SSS0.Px4.p1.3.m2.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.3.m2.1.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.2">subscript</csymbol><apply id="S4.SS3.SSS0.Px4.p1.3.m2.1.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.3.m2.1.2.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.2">superscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.3.m2.1.2.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.2.2.2">𝜏</ci><ci id="S4.SS3.SSS0.Px4.p1.3.m2.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.1.1.1">𝑢</ci></apply><ci id="S4.SS3.SSS0.Px4.p1.3.m2.1.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.3.m2.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px4.p1.3.m2.1c">\tau^{(u)}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px4.p1.3.m2.1d">italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and update the expected future reward <math alttext="q(s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px4.p1.4.m3.2"><semantics id="S4.SS3.SSS0.Px4.p1.4.m3.2a"><mrow id="S4.SS3.SSS0.Px4.p1.4.m3.2.2" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.cmml"><mi id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.4" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.4.cmml">q</mi><mo id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.3" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.3.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.3.cmml"><mo id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.3" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.3.cmml">(</mo><msub id="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1" xref="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1.2" xref="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1.3" xref="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.4" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.3.cmml">,</mo><msub id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2.cmml"><mi id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2.2" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2.2.cmml">o</mi><mi id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2.3" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.5" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px4.p1.4.m3.2b"><apply id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2"><times id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.3"></times><ci id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.4.cmml" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.4">𝑞</ci><interval closure="open" id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2"><apply id="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px4.p1.4.m3.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2.2">𝑜</ci><ci id="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.4.m3.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px4.p1.4.m3.2c">q(s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px4.p1.4.m3.2d">italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> along <math alttext="\tau^{(u)}_{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px4.p1.5.m4.1"><semantics id="S4.SS3.SSS0.Px4.p1.5.m4.1a"><msubsup id="S4.SS3.SSS0.Px4.p1.5.m4.1.2" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.2.cmml"><mi id="S4.SS3.SSS0.Px4.p1.5.m4.1.2.2.2" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.2.2.2.cmml">τ</mi><mi id="S4.SS3.SSS0.Px4.p1.5.m4.1.2.3" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.2.3.cmml">i</mi><mrow id="S4.SS3.SSS0.Px4.p1.5.m4.1.1.1.3" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.2.cmml"><mo id="S4.SS3.SSS0.Px4.p1.5.m4.1.1.1.3.1" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.2.cmml">(</mo><mi id="S4.SS3.SSS0.Px4.p1.5.m4.1.1.1.1" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.1.1.1.cmml">u</mi><mo id="S4.SS3.SSS0.Px4.p1.5.m4.1.1.1.3.2" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px4.p1.5.m4.1b"><apply id="S4.SS3.SSS0.Px4.p1.5.m4.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.5.m4.1.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.2">subscript</csymbol><apply id="S4.SS3.SSS0.Px4.p1.5.m4.1.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.5.m4.1.2.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.2">superscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.5.m4.1.2.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.2.2.2">𝜏</ci><ci id="S4.SS3.SSS0.Px4.p1.5.m4.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.1.1.1">𝑢</ci></apply><ci id="S4.SS3.SSS0.Px4.p1.5.m4.1.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.5.m4.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px4.p1.5.m4.1c">\tau^{(u)}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px4.p1.5.m4.1d">italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\!q(\!s_{t},o_{t}\!){\leftarrow}q(\!s_{t},o_{t}\!)\!+\!\big{(}\!{R_{t}(\tau^{%
\!(u)\!}_{i})\!-\!q(\!s_{t},\!o_{t}\!)}\big{)}\!/{V\!(s_{t})},\!" class="ltx_Math" display="block" id="S4.E4.m1.2"><semantics id="S4.E4.m1.2a"><mrow id="S4.E4.m1.2.2.1" xref="S4.E4.m1.2.2.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1" xref="S4.E4.m1.2.2.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1.2" xref="S4.E4.m1.2.2.1.1.2.cmml"><mi id="S4.E4.m1.2.2.1.1.2.4" xref="S4.E4.m1.2.2.1.1.2.4.cmml">q</mi><mo id="S4.E4.m1.2.2.1.1.2.3" xref="S4.E4.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E4.m1.2.2.1.1.2.2.2" xref="S4.E4.m1.2.2.1.1.2.2.3.cmml"><mpadded width="0.288em"><mo id="S4.E4.m1.2.2.1.1.2.2.2.3" stretchy="false" xref="S4.E4.m1.2.2.1.1.2.2.3.cmml">(</mo></mpadded><msub id="S4.E4.m1.2.2.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.2.2.1.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.E4.m1.2.2.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E4.m1.2.2.1.1.2.2.2.4" xref="S4.E4.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S4.E4.m1.2.2.1.1.2.2.2.2" xref="S4.E4.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E4.m1.2.2.1.1.2.2.2.2.2" xref="S4.E4.m1.2.2.1.1.2.2.2.2.2.cmml">o</mi><mi id="S4.E4.m1.2.2.1.1.2.2.2.2.3" xref="S4.E4.m1.2.2.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.E4.m1.2.2.1.1.2.2.2.5" stretchy="false" xref="S4.E4.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.2.2.1.1.7" stretchy="false" xref="S4.E4.m1.2.2.1.1.7.cmml">←</mo><mrow id="S4.E4.m1.2.2.1.1.6" xref="S4.E4.m1.2.2.1.1.6.cmml"><mrow id="S4.E4.m1.2.2.1.1.4.2" xref="S4.E4.m1.2.2.1.1.4.2.cmml"><mi id="S4.E4.m1.2.2.1.1.4.2.4" xref="S4.E4.m1.2.2.1.1.4.2.4.cmml">q</mi><mo id="S4.E4.m1.2.2.1.1.4.2.3" xref="S4.E4.m1.2.2.1.1.4.2.3.cmml">⁢</mo><mrow id="S4.E4.m1.2.2.1.1.4.2.2.2" xref="S4.E4.m1.2.2.1.1.4.2.2.3.cmml"><mpadded width="0.288em"><mo id="S4.E4.m1.2.2.1.1.4.2.2.2.3" stretchy="false" xref="S4.E4.m1.2.2.1.1.4.2.2.3.cmml">(</mo></mpadded><msub id="S4.E4.m1.2.2.1.1.3.1.1.1.1" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.cmml"><mi id="S4.E4.m1.2.2.1.1.3.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.2.cmml">s</mi><mi id="S4.E4.m1.2.2.1.1.3.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E4.m1.2.2.1.1.4.2.2.2.4" xref="S4.E4.m1.2.2.1.1.4.2.2.3.cmml">,</mo><msub id="S4.E4.m1.2.2.1.1.4.2.2.2.2" xref="S4.E4.m1.2.2.1.1.4.2.2.2.2.cmml"><mi id="S4.E4.m1.2.2.1.1.4.2.2.2.2.2" xref="S4.E4.m1.2.2.1.1.4.2.2.2.2.2.cmml">o</mi><mi id="S4.E4.m1.2.2.1.1.4.2.2.2.2.3" xref="S4.E4.m1.2.2.1.1.4.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.E4.m1.2.2.1.1.4.2.2.2.5" stretchy="false" xref="S4.E4.m1.2.2.1.1.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.2.2.1.1.6.5" lspace="0.052em" rspace="0.052em" xref="S4.E4.m1.2.2.1.1.6.5.cmml">+</mo><mrow id="S4.E4.m1.2.2.1.1.6.4" xref="S4.E4.m1.2.2.1.1.6.4.cmml"><mrow id="S4.E4.m1.2.2.1.1.5.3.1" xref="S4.E4.m1.2.2.1.1.5.3.1.cmml"><mrow id="S4.E4.m1.2.2.1.1.5.3.1.1.1" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.cmml"><mpadded width="0.288em"><mo id="S4.E4.m1.2.2.1.1.5.3.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.cmml">(</mo></mpadded><mrow id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.cmml"><msub id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3.2" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3.2.cmml">R</mi><mi id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3.3" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.2.2.cmml">τ</mi><mi id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.3.cmml">i</mi><mrow id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E4.m1.1.1.1.3.1" stretchy="false" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">u</mi><mo id="S4.E4.m1.1.1.1.3.2" stretchy="false" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.4" lspace="0.052em" rspace="0.052em" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.4.cmml">−</mo><mrow id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.cmml"><mi id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.4" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.4.cmml">q</mi><mo id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.3" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.3.cmml">⁢</mo><mrow id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.3.cmml"><mpadded width="0.288em"><mo id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.3" stretchy="false" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.3.cmml">(</mo></mpadded><msub id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1.cmml"><mi id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1.2" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1.2.cmml">s</mi><mi id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1.3" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1.3.cmml">t</mi></msub><mpadded width="0.275em"><mo id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.4" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.3.cmml">,</mo></mpadded><msub id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2.cmml"><mi id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2.2" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2.2.cmml">o</mi><mi id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2.3" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2.3.cmml">t</mi></msub><mo id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.5" stretchy="false" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.2.2.1.1.5.3.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E4.m1.2.2.1.1.5.3.1.2" lspace="0.052em" xref="S4.E4.m1.2.2.1.1.5.3.1.2.cmml">/</mo><mpadded width="0.636em"><mi id="S4.E4.m1.2.2.1.1.5.3.1.3" xref="S4.E4.m1.2.2.1.1.5.3.1.3.cmml">V</mi></mpadded></mrow><mo id="S4.E4.m1.2.2.1.1.6.4.3" xref="S4.E4.m1.2.2.1.1.6.4.3.cmml">⁢</mo><mrow id="S4.E4.m1.2.2.1.1.6.4.2.1" xref="S4.E4.m1.2.2.1.1.6.4.2.1.1.cmml"><mo id="S4.E4.m1.2.2.1.1.6.4.2.1.2" stretchy="false" xref="S4.E4.m1.2.2.1.1.6.4.2.1.1.cmml">(</mo><msub id="S4.E4.m1.2.2.1.1.6.4.2.1.1" xref="S4.E4.m1.2.2.1.1.6.4.2.1.1.cmml"><mi id="S4.E4.m1.2.2.1.1.6.4.2.1.1.2" xref="S4.E4.m1.2.2.1.1.6.4.2.1.1.2.cmml">s</mi><mi id="S4.E4.m1.2.2.1.1.6.4.2.1.1.3" xref="S4.E4.m1.2.2.1.1.6.4.2.1.1.3.cmml">t</mi></msub><mo id="S4.E4.m1.2.2.1.1.6.4.2.1.3" stretchy="false" xref="S4.E4.m1.2.2.1.1.6.4.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E4.m1.2.2.1.2" xref="S4.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.2b"><apply id="S4.E4.m1.2.2.1.1.cmml" xref="S4.E4.m1.2.2.1"><ci id="S4.E4.m1.2.2.1.1.7.cmml" xref="S4.E4.m1.2.2.1.1.7">←</ci><apply id="S4.E4.m1.2.2.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.2"><times id="S4.E4.m1.2.2.1.1.2.3.cmml" xref="S4.E4.m1.2.2.1.1.2.3"></times><ci id="S4.E4.m1.2.2.1.1.2.4.cmml" xref="S4.E4.m1.2.2.1.1.2.4">𝑞</ci><interval closure="open" id="S4.E4.m1.2.2.1.1.2.2.3.cmml" xref="S4.E4.m1.2.2.1.1.2.2.2"><apply id="S4.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.E4.m1.2.2.1.1.2.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.2.2.2.2.2">𝑜</ci><ci id="S4.E4.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E4.m1.2.2.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S4.E4.m1.2.2.1.1.6.cmml" xref="S4.E4.m1.2.2.1.1.6"><plus id="S4.E4.m1.2.2.1.1.6.5.cmml" xref="S4.E4.m1.2.2.1.1.6.5"></plus><apply id="S4.E4.m1.2.2.1.1.4.2.cmml" xref="S4.E4.m1.2.2.1.1.4.2"><times id="S4.E4.m1.2.2.1.1.4.2.3.cmml" xref="S4.E4.m1.2.2.1.1.4.2.3"></times><ci id="S4.E4.m1.2.2.1.1.4.2.4.cmml" xref="S4.E4.m1.2.2.1.1.4.2.4">𝑞</ci><interval closure="open" id="S4.E4.m1.2.2.1.1.4.2.2.3.cmml" xref="S4.E4.m1.2.2.1.1.4.2.2.2"><apply id="S4.E4.m1.2.2.1.1.3.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.3.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.2">𝑠</ci><ci id="S4.E4.m1.2.2.1.1.3.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.3">𝑡</ci></apply><apply id="S4.E4.m1.2.2.1.1.4.2.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.4.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.1.1.4.2.2.2.2">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.4.2.2.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.4.2.2.2.2.2">𝑜</ci><ci id="S4.E4.m1.2.2.1.1.4.2.2.2.2.3.cmml" xref="S4.E4.m1.2.2.1.1.4.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S4.E4.m1.2.2.1.1.6.4.cmml" xref="S4.E4.m1.2.2.1.1.6.4"><times id="S4.E4.m1.2.2.1.1.6.4.3.cmml" xref="S4.E4.m1.2.2.1.1.6.4.3"></times><apply id="S4.E4.m1.2.2.1.1.5.3.1.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1"><divide id="S4.E4.m1.2.2.1.1.5.3.1.2.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.2"></divide><apply id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1"><minus id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.4.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.4"></minus><apply id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1"><times id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.2"></times><apply id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3.2">𝑅</ci><ci id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.2.2">𝜏</ci><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝑢</ci></apply><ci id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3"><times id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.3.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.3"></times><ci id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.4.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.4">𝑞</ci><interval closure="open" id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.3.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2"><apply id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1.2">𝑠</ci><ci id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.2.1.1.1.3">𝑡</ci></apply><apply id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2.1.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2.2">𝑜</ci><ci id="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2.3.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.1.1.1.3.2.2.2.3">𝑡</ci></apply></interval></apply></apply><ci id="S4.E4.m1.2.2.1.1.5.3.1.3.cmml" xref="S4.E4.m1.2.2.1.1.5.3.1.3">𝑉</ci></apply><apply id="S4.E4.m1.2.2.1.1.6.4.2.1.1.cmml" xref="S4.E4.m1.2.2.1.1.6.4.2.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.6.4.2.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.6.4.2.1">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.6.4.2.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.6.4.2.1.1.2">𝑠</ci><ci id="S4.E4.m1.2.2.1.1.6.4.2.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.6.4.2.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.2c">\!q(\!s_{t},o_{t}\!){\leftarrow}q(\!s_{t},o_{t}\!)\!+\!\big{(}\!{R_{t}(\tau^{%
\!(u)\!}_{i})\!-\!q(\!s_{t},\!o_{t}\!)}\big{)}\!/{V\!(s_{t})},\!</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.2d">italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ← italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + ( italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) / italic_V ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS0.Px4.p1.11">where <math alttext="R_{t}(\tau^{(u)\!}_{i}){=}\!\sum^{T}_{\hat{t}=t}\!\gamma^{\hat{t}-t}{r}_{\hat{%
t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px4.p1.6.m1.2"><semantics id="S4.SS3.SSS0.Px4.p1.6.m1.2a"><mrow id="S4.SS3.SSS0.Px4.p1.6.m1.2.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.cmml"><mrow id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.cmml"><msub id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3.cmml"><mi id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3.2.cmml">R</mi><mi id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3.3" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.cmml"><mo id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.2" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.cmml">(</mo><msubsup id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.2.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.2.2.cmml">τ</mi><mi id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.3" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.3.cmml">i</mi><mrow id="S4.SS3.SSS0.Px4.p1.6.m1.1.1.1.3" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.cmml"><mo id="S4.SS3.SSS0.Px4.p1.6.m1.1.1.1.3.1" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.cmml">(</mo><mi id="S4.SS3.SSS0.Px4.p1.6.m1.1.1.1.1" xref="S4.SS3.SSS0.Px4.p1.6.m1.1.1.1.1.cmml">u</mi><mo id="S4.SS3.SSS0.Px4.p1.6.m1.1.1.1.3.2" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.3" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.2" rspace="0.0539em" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.2.cmml">=</mo><mrow id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.cmml"><msubsup id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.cmml"><mo id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.2.2" lspace="0.0539em" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.2.2.cmml">∑</mo><mrow id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.cmml"><mover accent="true" id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.2.cmml"><mi id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.2.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.2.2.cmml">t</mi><mo id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.2.1" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.2.1.cmml">^</mo></mover><mo id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.1" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.1.cmml">=</mo><mi id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.3" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.3.cmml">t</mi></mrow><mi id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.2.3" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.2.3.cmml">T</mi></msubsup><mrow id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.cmml"><msup id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.cmml"><mi id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.2.cmml">γ</mi><mrow id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.cmml"><mover accent="true" id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.2.cmml"><mi id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.2.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.2.2.cmml">t</mi><mo id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.2.1" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.2.1.cmml">^</mo></mover><mo id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.1" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.1.cmml">−</mo><mi id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.3" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.3.cmml">t</mi></mrow></msup><mo id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.1" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.1.cmml">⁢</mo><msub id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.cmml"><mi id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.2.cmml">r</mi><mover accent="true" id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.3" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.3.cmml"><mi id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.3.2" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.3.2.cmml">t</mi><mo id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.3.1" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.3.1.cmml">^</mo></mover></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px4.p1.6.m1.2b"><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2"><eq id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.2"></eq><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1"><times id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.2"></times><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3">subscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3.2">𝑅</ci><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3.3.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.3.3">𝑡</ci></apply><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1">subscript</csymbol><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1">superscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.2.2">𝜏</ci><ci id="S4.SS3.SSS0.Px4.p1.6.m1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.1.1.1.1">𝑢</ci></apply><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3"><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1">subscript</csymbol><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1">superscript</csymbol><sum id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.2.2"></sum><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.2.3">𝑇</ci></apply><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3"><eq id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.1"></eq><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.2"><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.2.1">^</ci><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.2.2">𝑡</ci></apply><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.3.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.1.3.3">𝑡</ci></apply></apply><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2"><times id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.1"></times><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2">superscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.2">𝛾</ci><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3"><minus id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.1"></minus><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.2"><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.2.1">^</ci><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.2.2">𝑡</ci></apply><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.3.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.2.3.3">𝑡</ci></apply></apply><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3">subscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.2">𝑟</ci><apply id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.3.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.3"><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.3.1.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.3.1">^</ci><ci id="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.3.2.cmml" xref="S4.SS3.SSS0.Px4.p1.6.m1.2.2.3.2.3.3.2">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px4.p1.6.m1.2c">R_{t}(\tau^{(u)\!}_{i}){=}\!\sum^{T}_{\hat{t}=t}\!\gamma^{\hat{t}-t}{r}_{\hat{%
t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px4.p1.6.m1.2d">italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = ∑ start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT over^ start_ARG italic_t end_ARG = italic_t end_POSTSUBSCRIPT italic_γ start_POSTSUPERSCRIPT over^ start_ARG italic_t end_ARG - italic_t end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT over^ start_ARG italic_t end_ARG end_POSTSUBSCRIPT</annotation></semantics></math> is the cumulative reward from turn <math alttext="t" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px4.p1.7.m2.1"><semantics id="S4.SS3.SSS0.Px4.p1.7.m2.1a"><mi id="S4.SS3.SSS0.Px4.p1.7.m2.1.1" xref="S4.SS3.SSS0.Px4.p1.7.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px4.p1.7.m2.1b"><ci id="S4.SS3.SSS0.Px4.p1.7.m2.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.7.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px4.p1.7.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px4.p1.7.m2.1d">italic_t</annotation></semantics></math> to the final turn <math alttext="T" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px4.p1.8.m3.1"><semantics id="S4.SS3.SSS0.Px4.p1.8.m3.1a"><mi id="S4.SS3.SSS0.Px4.p1.8.m3.1.1" xref="S4.SS3.SSS0.Px4.p1.8.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px4.p1.8.m3.1b"><ci id="S4.SS3.SSS0.Px4.p1.8.m3.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.8.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px4.p1.8.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px4.p1.8.m3.1d">italic_T</annotation></semantics></math>.
Intuitively, this update rule is similar to stochastic gradient ascent: each time <math alttext="q(s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px4.p1.9.m4.2"><semantics id="S4.SS3.SSS0.Px4.p1.9.m4.2a"><mrow id="S4.SS3.SSS0.Px4.p1.9.m4.2.2" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.cmml"><mi id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.4" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.4.cmml">q</mi><mo id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.3" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.3.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.3.cmml"><mo id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.3" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.3.cmml">(</mo><msub id="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1" xref="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1.2" xref="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1.3" xref="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.4" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.3.cmml">,</mo><msub id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2.cmml"><mi id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2.2" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2.2.cmml">o</mi><mi id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2.3" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.5" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px4.p1.9.m4.2b"><apply id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2"><times id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.3"></times><ci id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.4.cmml" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.4">𝑞</ci><interval closure="open" id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2"><apply id="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px4.p1.9.m4.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2.2">𝑜</ci><ci id="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.9.m4.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px4.p1.9.m4.2c">q(s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px4.p1.9.m4.2d">italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is adjusted by step <math alttext="1/{V(s_{t})}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px4.p1.10.m5.1"><semantics id="S4.SS3.SSS0.Px4.p1.10.m5.1a"><mrow id="S4.SS3.SSS0.Px4.p1.10.m5.1.1" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.cmml"><mrow id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.cmml"><mn id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.2" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.2.cmml">1</mn><mo id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.1" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.1.cmml">/</mo><mi id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.3" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.3.cmml">V</mi></mrow><mo id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.2" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.cmml"><mo id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.2" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.cmml">(</mo><msub id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.2" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.3" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.3" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px4.p1.10.m5.1b"><apply id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1"><times id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.2"></times><apply id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.cmml" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3"><divide id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.1"></divide><cn id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.2.cmml" type="integer" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.2">1</cn><ci id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.3.3">𝑉</ci></apply><apply id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px4.p1.10.m5.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px4.p1.10.m5.1c">1/{V(s_{t})}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px4.p1.10.m5.1d">1 / italic_V ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> in the direction of the error <math alttext="R_{t}(\tau^{(u)}_{i})-q(s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px4.p1.11.m6.4"><semantics id="S4.SS3.SSS0.Px4.p1.11.m6.4a"><mrow id="S4.SS3.SSS0.Px4.p1.11.m6.4.4" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.cmml"><mrow id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.cmml"><msub id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3.cmml"><mi id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3.2" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3.2.cmml">R</mi><mi id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3.3" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.2" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.cmml"><mo id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.2" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.cmml">(</mo><msubsup id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.2.2" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.2.2.cmml">τ</mi><mi id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.3" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.3.cmml">i</mi><mrow id="S4.SS3.SSS0.Px4.p1.11.m6.1.1.1.3" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.cmml"><mo id="S4.SS3.SSS0.Px4.p1.11.m6.1.1.1.3.1" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.cmml">(</mo><mi id="S4.SS3.SSS0.Px4.p1.11.m6.1.1.1.1" xref="S4.SS3.SSS0.Px4.p1.11.m6.1.1.1.1.cmml">u</mi><mo id="S4.SS3.SSS0.Px4.p1.11.m6.1.1.1.3.2" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.3" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.4" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.4.cmml">−</mo><mrow id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.cmml"><mi id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.4" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.4.cmml">q</mi><mo id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.3" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.3.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.3.cmml"><mo id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.3" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.3.cmml">(</mo><msub id="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1" xref="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1.cmml"><mi id="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1.2" xref="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1.3" xref="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.4" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.3.cmml">,</mo><msub id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2.cmml"><mi id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2.2" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2.2.cmml">o</mi><mi id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2.3" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.5" stretchy="false" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px4.p1.11.m6.4b"><apply id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4"><minus id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.4.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.4"></minus><apply id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1"><times id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.2"></times><apply id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3.1.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3">subscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3.2.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3.2">𝑅</ci><ci id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3.3.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.3.3">𝑡</ci></apply><apply id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1">subscript</csymbol><apply id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1">superscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.2.2">𝜏</ci><ci id="S4.SS3.SSS0.Px4.p1.11.m6.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.1.1.1.1">𝑢</ci></apply><ci id="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.2.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3"><times id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.3.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.3"></times><ci id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.4.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.4">𝑞</ci><interval closure="open" id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2"><apply id="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1.2">𝑠</ci><ci id="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.3.3.2.1.1.1.3">𝑡</ci></apply><apply id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2.1.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2.2">𝑜</ci><ci id="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px4.p1.11.m6.4.4.3.2.2.2.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px4.p1.11.m6.4c">R_{t}(\tau^{(u)}_{i})-q(s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px4.p1.11.m6.4d">italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Guiding <span class="ltx_text" id="S4.SS4.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS4.1.1.m1.1"><semantics id="S4.SS4.1.1.m1.1b"><mrow id="S4.SS4.1.1.m1.1.1" xref="S4.SS4.1.1.m1.1.1.cmml"><mi id="S4.SS4.1.1.m1.1.1.2" xref="S4.SS4.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS4.1.1.m1.1.1.1" xref="S4.SS4.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS4.1.1.m1.1.1.3" xref="S4.SS4.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.1.1.m1.1c"><apply id="S4.SS4.1.1.m1.1.1.cmml" xref="S4.SS4.1.1.m1.1.1"><times id="S4.SS4.1.1.m1.1.1.1.cmml" xref="S4.SS4.1.1.m1.1.1.1"></times><ci id="S4.SS4.1.1.m1.1.1.2.cmml" xref="S4.SS4.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS4.1.1.m1.1.1.3a.cmml" xref="S4.SS4.1.1.m1.1.1.3"><mtext id="S4.SS4.1.1.m1.1.1.3.cmml" xref="S4.SS4.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.1.1.m1.1d">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.1.1.m1.1e">typewriter_S -agent</annotation></semantics></math></span> with <span class="ltx_text" id="S4.SS4.2.2"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS4.2.2.m1.1"><semantics id="S4.SS4.2.2.m1.1b"><mrow id="S4.SS4.2.2.m1.1.1" xref="S4.SS4.2.2.m1.1.1.cmml"><mi id="S4.SS4.2.2.m1.1.1.2" xref="S4.SS4.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS4.2.2.m1.1.1.1" xref="S4.SS4.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS4.2.2.m1.1.1.3" xref="S4.SS4.2.2.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.2.2.m1.1c"><apply id="S4.SS4.2.2.m1.1.1.cmml" xref="S4.SS4.2.2.m1.1.1"><times id="S4.SS4.2.2.m1.1.1.1.cmml" xref="S4.SS4.2.2.m1.1.1.1"></times><ci id="S4.SS4.2.2.m1.1.1.2.cmml" xref="S4.SS4.2.2.m1.1.1.2">𝚂</ci><ci id="S4.SS4.2.2.m1.1.1.3a.cmml" xref="S4.SS4.2.2.m1.1.1.3"><mtext id="S4.SS4.2.2.m1.1.1.3.cmml" xref="S4.SS4.2.2.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.2.2.m1.1d">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.2.2.m1.1e">typewriter_S -planner</annotation></semantics></math></span>
</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.9">To empower <span class="ltx_text" id="S4.SS4.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS4.p1.1.1.m1.1"><semantics id="S4.SS4.p1.1.1.m1.1a"><mrow id="S4.SS4.p1.1.1.m1.1.1" xref="S4.SS4.p1.1.1.m1.1.1.cmml"><mi id="S4.SS4.p1.1.1.m1.1.1.2" xref="S4.SS4.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS4.p1.1.1.m1.1.1.1" xref="S4.SS4.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS4.p1.1.1.m1.1.1.3" xref="S4.SS4.p1.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.1.m1.1b"><apply id="S4.SS4.p1.1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.1.m1.1.1"><times id="S4.SS4.p1.1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.1.m1.1.1.1"></times><ci id="S4.SS4.p1.1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS4.p1.1.1.m1.1.1.3a.cmml" xref="S4.SS4.p1.1.1.m1.1.1.3"><mtext id="S4.SS4.p1.1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> with advanced planning capability, we use the best conversation plan (the plan with the maximum cumulative reward) found by <span class="ltx_text" id="S4.SS4.p1.2.2"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS4.p1.2.2.m1.1"><semantics id="S4.SS4.p1.2.2.m1.1a"><mrow id="S4.SS4.p1.2.2.m1.1.1" xref="S4.SS4.p1.2.2.m1.1.1.cmml"><mi id="S4.SS4.p1.2.2.m1.1.1.2" xref="S4.SS4.p1.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS4.p1.2.2.m1.1.1.1" xref="S4.SS4.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS4.p1.2.2.m1.1.1.3" xref="S4.SS4.p1.2.2.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.2.m1.1b"><apply id="S4.SS4.p1.2.2.m1.1.1.cmml" xref="S4.SS4.p1.2.2.m1.1.1"><times id="S4.SS4.p1.2.2.m1.1.1.1.cmml" xref="S4.SS4.p1.2.2.m1.1.1.1"></times><ci id="S4.SS4.p1.2.2.m1.1.1.2.cmml" xref="S4.SS4.p1.2.2.m1.1.1.2">𝚂</ci><ci id="S4.SS4.p1.2.2.m1.1.1.3a.cmml" xref="S4.SS4.p1.2.2.m1.1.1.3"><mtext id="S4.SS4.p1.2.2.m1.1.1.3.cmml" xref="S4.SS4.p1.2.2.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.2.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.2.m1.1d">typewriter_S -planner</annotation></semantics></math></span> to guide the training of its policy network and the Q-network.
This process creates a self-training loop <cite class="ltx_cite ltx_citemacro_cite">Silver et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib40" title="">2017</a>)</cite> that enables <span class="ltx_text" id="S4.SS4.p1.3.3"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS4.p1.3.3.m1.1"><semantics id="S4.SS4.p1.3.3.m1.1a"><mrow id="S4.SS4.p1.3.3.m1.1.1" xref="S4.SS4.p1.3.3.m1.1.1.cmml"><mi id="S4.SS4.p1.3.3.m1.1.1.2" xref="S4.SS4.p1.3.3.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS4.p1.3.3.m1.1.1.1" xref="S4.SS4.p1.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS4.p1.3.3.m1.1.1.3" xref="S4.SS4.p1.3.3.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.3.m1.1b"><apply id="S4.SS4.p1.3.3.m1.1.1.cmml" xref="S4.SS4.p1.3.3.m1.1.1"><times id="S4.SS4.p1.3.3.m1.1.1.1.cmml" xref="S4.SS4.p1.3.3.m1.1.1.1"></times><ci id="S4.SS4.p1.3.3.m1.1.1.2.cmml" xref="S4.SS4.p1.3.3.m1.1.1.2">𝚂</ci><ci id="S4.SS4.p1.3.3.m1.1.1.3a.cmml" xref="S4.SS4.p1.3.3.m1.1.1.3"><mtext id="S4.SS4.p1.3.3.m1.1.1.3.cmml" xref="S4.SS4.p1.3.3.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.3.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.3.m1.1d">typewriter_S -agent</annotation></semantics></math></span> to iteratively improve its planning capability.
To avoid biased estimation from training on consecutive, temporally correlated actions <cite class="ltx_cite ltx_citemacro_cite">Mnih et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib32" title="">2015</a>)</cite>, we store the experiences <math alttext="e_{t}=(s_{t},o_{t},a_{t},r_{t},s_{t+1},o_{t+1})" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m1.6"><semantics id="S4.SS4.p1.4.m1.6a"><mrow id="S4.SS4.p1.4.m1.6.6" xref="S4.SS4.p1.4.m1.6.6.cmml"><msub id="S4.SS4.p1.4.m1.6.6.8" xref="S4.SS4.p1.4.m1.6.6.8.cmml"><mi id="S4.SS4.p1.4.m1.6.6.8.2" xref="S4.SS4.p1.4.m1.6.6.8.2.cmml">e</mi><mi id="S4.SS4.p1.4.m1.6.6.8.3" xref="S4.SS4.p1.4.m1.6.6.8.3.cmml">t</mi></msub><mo id="S4.SS4.p1.4.m1.6.6.7" xref="S4.SS4.p1.4.m1.6.6.7.cmml">=</mo><mrow id="S4.SS4.p1.4.m1.6.6.6.6" xref="S4.SS4.p1.4.m1.6.6.6.7.cmml"><mo id="S4.SS4.p1.4.m1.6.6.6.6.7" stretchy="false" xref="S4.SS4.p1.4.m1.6.6.6.7.cmml">(</mo><msub id="S4.SS4.p1.4.m1.1.1.1.1.1" xref="S4.SS4.p1.4.m1.1.1.1.1.1.cmml"><mi id="S4.SS4.p1.4.m1.1.1.1.1.1.2" xref="S4.SS4.p1.4.m1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS4.p1.4.m1.1.1.1.1.1.3" xref="S4.SS4.p1.4.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS4.p1.4.m1.6.6.6.6.8" xref="S4.SS4.p1.4.m1.6.6.6.7.cmml">,</mo><msub id="S4.SS4.p1.4.m1.2.2.2.2.2" xref="S4.SS4.p1.4.m1.2.2.2.2.2.cmml"><mi id="S4.SS4.p1.4.m1.2.2.2.2.2.2" xref="S4.SS4.p1.4.m1.2.2.2.2.2.2.cmml">o</mi><mi id="S4.SS4.p1.4.m1.2.2.2.2.2.3" xref="S4.SS4.p1.4.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS4.p1.4.m1.6.6.6.6.9" xref="S4.SS4.p1.4.m1.6.6.6.7.cmml">,</mo><msub id="S4.SS4.p1.4.m1.3.3.3.3.3" xref="S4.SS4.p1.4.m1.3.3.3.3.3.cmml"><mi id="S4.SS4.p1.4.m1.3.3.3.3.3.2" xref="S4.SS4.p1.4.m1.3.3.3.3.3.2.cmml">a</mi><mi id="S4.SS4.p1.4.m1.3.3.3.3.3.3" xref="S4.SS4.p1.4.m1.3.3.3.3.3.3.cmml">t</mi></msub><mo id="S4.SS4.p1.4.m1.6.6.6.6.10" xref="S4.SS4.p1.4.m1.6.6.6.7.cmml">,</mo><msub id="S4.SS4.p1.4.m1.4.4.4.4.4" xref="S4.SS4.p1.4.m1.4.4.4.4.4.cmml"><mi id="S4.SS4.p1.4.m1.4.4.4.4.4.2" xref="S4.SS4.p1.4.m1.4.4.4.4.4.2.cmml">r</mi><mi id="S4.SS4.p1.4.m1.4.4.4.4.4.3" xref="S4.SS4.p1.4.m1.4.4.4.4.4.3.cmml">t</mi></msub><mo id="S4.SS4.p1.4.m1.6.6.6.6.11" xref="S4.SS4.p1.4.m1.6.6.6.7.cmml">,</mo><msub id="S4.SS4.p1.4.m1.5.5.5.5.5" xref="S4.SS4.p1.4.m1.5.5.5.5.5.cmml"><mi id="S4.SS4.p1.4.m1.5.5.5.5.5.2" xref="S4.SS4.p1.4.m1.5.5.5.5.5.2.cmml">s</mi><mrow id="S4.SS4.p1.4.m1.5.5.5.5.5.3" xref="S4.SS4.p1.4.m1.5.5.5.5.5.3.cmml"><mi id="S4.SS4.p1.4.m1.5.5.5.5.5.3.2" xref="S4.SS4.p1.4.m1.5.5.5.5.5.3.2.cmml">t</mi><mo id="S4.SS4.p1.4.m1.5.5.5.5.5.3.1" xref="S4.SS4.p1.4.m1.5.5.5.5.5.3.1.cmml">+</mo><mn id="S4.SS4.p1.4.m1.5.5.5.5.5.3.3" xref="S4.SS4.p1.4.m1.5.5.5.5.5.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS4.p1.4.m1.6.6.6.6.12" xref="S4.SS4.p1.4.m1.6.6.6.7.cmml">,</mo><msub id="S4.SS4.p1.4.m1.6.6.6.6.6" xref="S4.SS4.p1.4.m1.6.6.6.6.6.cmml"><mi id="S4.SS4.p1.4.m1.6.6.6.6.6.2" xref="S4.SS4.p1.4.m1.6.6.6.6.6.2.cmml">o</mi><mrow id="S4.SS4.p1.4.m1.6.6.6.6.6.3" xref="S4.SS4.p1.4.m1.6.6.6.6.6.3.cmml"><mi id="S4.SS4.p1.4.m1.6.6.6.6.6.3.2" xref="S4.SS4.p1.4.m1.6.6.6.6.6.3.2.cmml">t</mi><mo id="S4.SS4.p1.4.m1.6.6.6.6.6.3.1" xref="S4.SS4.p1.4.m1.6.6.6.6.6.3.1.cmml">+</mo><mn id="S4.SS4.p1.4.m1.6.6.6.6.6.3.3" xref="S4.SS4.p1.4.m1.6.6.6.6.6.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS4.p1.4.m1.6.6.6.6.13" stretchy="false" xref="S4.SS4.p1.4.m1.6.6.6.7.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m1.6b"><apply id="S4.SS4.p1.4.m1.6.6.cmml" xref="S4.SS4.p1.4.m1.6.6"><eq id="S4.SS4.p1.4.m1.6.6.7.cmml" xref="S4.SS4.p1.4.m1.6.6.7"></eq><apply id="S4.SS4.p1.4.m1.6.6.8.cmml" xref="S4.SS4.p1.4.m1.6.6.8"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m1.6.6.8.1.cmml" xref="S4.SS4.p1.4.m1.6.6.8">subscript</csymbol><ci id="S4.SS4.p1.4.m1.6.6.8.2.cmml" xref="S4.SS4.p1.4.m1.6.6.8.2">𝑒</ci><ci id="S4.SS4.p1.4.m1.6.6.8.3.cmml" xref="S4.SS4.p1.4.m1.6.6.8.3">𝑡</ci></apply><vector id="S4.SS4.p1.4.m1.6.6.6.7.cmml" xref="S4.SS4.p1.4.m1.6.6.6.6"><apply id="S4.SS4.p1.4.m1.1.1.1.1.1.cmml" xref="S4.SS4.p1.4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m1.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.4.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p1.4.m1.1.1.1.1.1.2.cmml" xref="S4.SS4.p1.4.m1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS4.p1.4.m1.1.1.1.1.1.3.cmml" xref="S4.SS4.p1.4.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS4.p1.4.m1.2.2.2.2.2.cmml" xref="S4.SS4.p1.4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m1.2.2.2.2.2.1.cmml" xref="S4.SS4.p1.4.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.SS4.p1.4.m1.2.2.2.2.2.2.cmml" xref="S4.SS4.p1.4.m1.2.2.2.2.2.2">𝑜</ci><ci id="S4.SS4.p1.4.m1.2.2.2.2.2.3.cmml" xref="S4.SS4.p1.4.m1.2.2.2.2.2.3">𝑡</ci></apply><apply id="S4.SS4.p1.4.m1.3.3.3.3.3.cmml" xref="S4.SS4.p1.4.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m1.3.3.3.3.3.1.cmml" xref="S4.SS4.p1.4.m1.3.3.3.3.3">subscript</csymbol><ci id="S4.SS4.p1.4.m1.3.3.3.3.3.2.cmml" xref="S4.SS4.p1.4.m1.3.3.3.3.3.2">𝑎</ci><ci id="S4.SS4.p1.4.m1.3.3.3.3.3.3.cmml" xref="S4.SS4.p1.4.m1.3.3.3.3.3.3">𝑡</ci></apply><apply id="S4.SS4.p1.4.m1.4.4.4.4.4.cmml" xref="S4.SS4.p1.4.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m1.4.4.4.4.4.1.cmml" xref="S4.SS4.p1.4.m1.4.4.4.4.4">subscript</csymbol><ci id="S4.SS4.p1.4.m1.4.4.4.4.4.2.cmml" xref="S4.SS4.p1.4.m1.4.4.4.4.4.2">𝑟</ci><ci id="S4.SS4.p1.4.m1.4.4.4.4.4.3.cmml" xref="S4.SS4.p1.4.m1.4.4.4.4.4.3">𝑡</ci></apply><apply id="S4.SS4.p1.4.m1.5.5.5.5.5.cmml" xref="S4.SS4.p1.4.m1.5.5.5.5.5"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m1.5.5.5.5.5.1.cmml" xref="S4.SS4.p1.4.m1.5.5.5.5.5">subscript</csymbol><ci id="S4.SS4.p1.4.m1.5.5.5.5.5.2.cmml" xref="S4.SS4.p1.4.m1.5.5.5.5.5.2">𝑠</ci><apply id="S4.SS4.p1.4.m1.5.5.5.5.5.3.cmml" xref="S4.SS4.p1.4.m1.5.5.5.5.5.3"><plus id="S4.SS4.p1.4.m1.5.5.5.5.5.3.1.cmml" xref="S4.SS4.p1.4.m1.5.5.5.5.5.3.1"></plus><ci id="S4.SS4.p1.4.m1.5.5.5.5.5.3.2.cmml" xref="S4.SS4.p1.4.m1.5.5.5.5.5.3.2">𝑡</ci><cn id="S4.SS4.p1.4.m1.5.5.5.5.5.3.3.cmml" type="integer" xref="S4.SS4.p1.4.m1.5.5.5.5.5.3.3">1</cn></apply></apply><apply id="S4.SS4.p1.4.m1.6.6.6.6.6.cmml" xref="S4.SS4.p1.4.m1.6.6.6.6.6"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m1.6.6.6.6.6.1.cmml" xref="S4.SS4.p1.4.m1.6.6.6.6.6">subscript</csymbol><ci id="S4.SS4.p1.4.m1.6.6.6.6.6.2.cmml" xref="S4.SS4.p1.4.m1.6.6.6.6.6.2">𝑜</ci><apply id="S4.SS4.p1.4.m1.6.6.6.6.6.3.cmml" xref="S4.SS4.p1.4.m1.6.6.6.6.6.3"><plus id="S4.SS4.p1.4.m1.6.6.6.6.6.3.1.cmml" xref="S4.SS4.p1.4.m1.6.6.6.6.6.3.1"></plus><ci id="S4.SS4.p1.4.m1.6.6.6.6.6.3.2.cmml" xref="S4.SS4.p1.4.m1.6.6.6.6.6.3.2">𝑡</ci><cn id="S4.SS4.p1.4.m1.6.6.6.6.6.3.3.cmml" type="integer" xref="S4.SS4.p1.4.m1.6.6.6.6.6.3.3">1</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m1.6c">e_{t}=(s_{t},o_{t},a_{t},r_{t},s_{t+1},o_{t+1})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m1.6d">italic_e start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math> at each turn <math alttext="t" class="ltx_Math" display="inline" id="S4.SS4.p1.5.m2.1"><semantics id="S4.SS4.p1.5.m2.1a"><mi id="S4.SS4.p1.5.m2.1.1" xref="S4.SS4.p1.5.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m2.1b"><ci id="S4.SS4.p1.5.m2.1.1.cmml" xref="S4.SS4.p1.5.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.5.m2.1d">italic_t</annotation></semantics></math> (<math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S4.SS4.p1.6.m3.1"><semantics id="S4.SS4.p1.6.m3.1a"><msub id="S4.SS4.p1.6.m3.1.1" xref="S4.SS4.p1.6.m3.1.1.cmml"><mi id="S4.SS4.p1.6.m3.1.1.2" xref="S4.SS4.p1.6.m3.1.1.2.cmml">s</mi><mrow id="S4.SS4.p1.6.m3.1.1.3" xref="S4.SS4.p1.6.m3.1.1.3.cmml"><mi id="S4.SS4.p1.6.m3.1.1.3.2" xref="S4.SS4.p1.6.m3.1.1.3.2.cmml">t</mi><mo id="S4.SS4.p1.6.m3.1.1.3.1" xref="S4.SS4.p1.6.m3.1.1.3.1.cmml">+</mo><mn id="S4.SS4.p1.6.m3.1.1.3.3" xref="S4.SS4.p1.6.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m3.1b"><apply id="S4.SS4.p1.6.m3.1.1.cmml" xref="S4.SS4.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m3.1.1.1.cmml" xref="S4.SS4.p1.6.m3.1.1">subscript</csymbol><ci id="S4.SS4.p1.6.m3.1.1.2.cmml" xref="S4.SS4.p1.6.m3.1.1.2">𝑠</ci><apply id="S4.SS4.p1.6.m3.1.1.3.cmml" xref="S4.SS4.p1.6.m3.1.1.3"><plus id="S4.SS4.p1.6.m3.1.1.3.1.cmml" xref="S4.SS4.p1.6.m3.1.1.3.1"></plus><ci id="S4.SS4.p1.6.m3.1.1.3.2.cmml" xref="S4.SS4.p1.6.m3.1.1.3.2">𝑡</ci><cn id="S4.SS4.p1.6.m3.1.1.3.3.cmml" type="integer" xref="S4.SS4.p1.6.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m3.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.6.m3.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="o_{t+1}" class="ltx_Math" display="inline" id="S4.SS4.p1.7.m4.1"><semantics id="S4.SS4.p1.7.m4.1a"><msub id="S4.SS4.p1.7.m4.1.1" xref="S4.SS4.p1.7.m4.1.1.cmml"><mi id="S4.SS4.p1.7.m4.1.1.2" xref="S4.SS4.p1.7.m4.1.1.2.cmml">o</mi><mrow id="S4.SS4.p1.7.m4.1.1.3" xref="S4.SS4.p1.7.m4.1.1.3.cmml"><mi id="S4.SS4.p1.7.m4.1.1.3.2" xref="S4.SS4.p1.7.m4.1.1.3.2.cmml">t</mi><mo id="S4.SS4.p1.7.m4.1.1.3.1" xref="S4.SS4.p1.7.m4.1.1.3.1.cmml">+</mo><mn id="S4.SS4.p1.7.m4.1.1.3.3" xref="S4.SS4.p1.7.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.7.m4.1b"><apply id="S4.SS4.p1.7.m4.1.1.cmml" xref="S4.SS4.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.7.m4.1.1.1.cmml" xref="S4.SS4.p1.7.m4.1.1">subscript</csymbol><ci id="S4.SS4.p1.7.m4.1.1.2.cmml" xref="S4.SS4.p1.7.m4.1.1.2">𝑜</ci><apply id="S4.SS4.p1.7.m4.1.1.3.cmml" xref="S4.SS4.p1.7.m4.1.1.3"><plus id="S4.SS4.p1.7.m4.1.1.3.1.cmml" xref="S4.SS4.p1.7.m4.1.1.3.1"></plus><ci id="S4.SS4.p1.7.m4.1.1.3.2.cmml" xref="S4.SS4.p1.7.m4.1.1.3.2">𝑡</ci><cn id="S4.SS4.p1.7.m4.1.1.3.3.cmml" type="integer" xref="S4.SS4.p1.7.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.7.m4.1c">o_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.7.m4.1d">italic_o start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> are required for the target Q-network to estimate the Q value from the next state) from the best plans
to the memory <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS4.p1.8.m5.1"><semantics id="S4.SS4.p1.8.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.8.m5.1.1" xref="S4.SS4.p1.8.m5.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.8.m5.1b"><ci id="S4.SS4.p1.8.m5.1.1.cmml" xref="S4.SS4.p1.8.m5.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.8.m5.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.8.m5.1d">caligraphic_D</annotation></semantics></math>, and use Prioritized Experience Replay (PER) <cite class="ltx_cite ltx_citemacro_cite">Schaul et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib37" title="">2016</a>)</cite> to sample a batch of experiences from the memory <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS4.p1.9.m6.1"><semantics id="S4.SS4.p1.9.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.9.m6.1.1" xref="S4.SS4.p1.9.m6.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.9.m6.1b"><ci id="S4.SS4.p1.9.m6.1.1.cmml" xref="S4.SS4.p1.9.m6.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.9.m6.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.9.m6.1d">caligraphic_D</annotation></semantics></math> to update the policy network and the Q-network.</p>
</div>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Policy Network Update</h4>
<div class="ltx_para" id="S4.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px1.p1.1">The policy network is updated with the following supervised loss function to align its decision with guidance from <span class="ltx_text" id="S4.SS4.SSS0.Px1.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p1.1.1.m1.1"><semantics id="S4.SS4.SSS0.Px1.p1.1.1.m1.1a"><mrow id="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1" xref="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.2" xref="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.1" xref="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.3" xref="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p1.1.1.m1.1b"><apply id="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1"><times id="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.1"></times><ci id="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.3a.cmml" xref="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.3"><mtext id="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.3.cmml" xref="S4.SS4.SSS0.Px1.p1.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p1.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\phi}=\mathbb{E}_{e_{t}\sim\mathcal{D}}\left[-\log{\pi_{\phi}(o_{%
t}|s_{t})}\right]." class="ltx_Math" display="block" id="S4.E5.m1.1"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.3.2.cmml">ℒ</mi><mi id="S4.E5.m1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S4.E5.m1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.3.3.cmml"><msub id="S4.E5.m1.1.1.1.1.1.3.3.2" xref="S4.E5.m1.1.1.1.1.1.3.3.2.cmml"><mi id="S4.E5.m1.1.1.1.1.1.3.3.2.2" xref="S4.E5.m1.1.1.1.1.1.3.3.2.2.cmml">e</mi><mi id="S4.E5.m1.1.1.1.1.1.3.3.2.3" xref="S4.E5.m1.1.1.1.1.1.3.3.2.3.cmml">t</mi></msub><mo id="S4.E5.m1.1.1.1.1.1.3.3.1" xref="S4.E5.m1.1.1.1.1.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.1.1.1.1.1.3.3.3" xref="S4.E5.m1.1.1.1.1.1.3.3.3.cmml">𝒟</mi></mrow></msub><mo id="S4.E5.m1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.2.cmml"><mo id="S4.E5.m1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.1.1.1.1.1.1.1.1a" rspace="0.167em" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">π</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">o</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E5.m1.1.1.1.2" lspace="0em" xref="S4.E5.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2"></eq><apply id="S4.E5.m1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2">ℒ</ci><ci id="S4.E5.m1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.2"></times><apply id="S4.E5.m1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.3.2">𝔼</ci><apply id="S4.E5.m1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3.3"><csymbol cd="latexml" id="S4.E5.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.3.3.1">similar-to</csymbol><apply id="S4.E5.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.3.3.2.2">𝑒</ci><ci id="S4.E5.m1.1.1.1.1.1.3.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3.3.2.3">𝑡</ci></apply><ci id="S4.E5.m1.1.1.1.1.1.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3.3.3">𝒟</ci></apply></apply><apply id="S4.E5.m1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"><minus id="S4.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3"><log id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.1"></log><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝜋</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑜</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">\mathcal{L}_{\phi}=\mathbb{E}_{e_{t}\sim\mathcal{D}}\left[-\log{\pi_{\phi}(o_{%
t}|s_{t})}\right].</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_e start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ caligraphic_D end_POSTSUBSCRIPT [ - roman_log italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Q-Network Update</h4>
<div class="ltx_para" id="S4.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px2.p1.3">The Q-network is updated with double Q-learning <cite class="ltx_cite ltx_citemacro_cite">van Hasselt et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib43" title="">2016</a>)</cite>, which maintains a target network <math alttext="{Q}_{\tilde{\theta}}(a_{t}|s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS4.SSS0.Px2.p1.1.m1.1a"><mrow id="S4.SS4.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.cmml"><msub id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">Q</mi><mover accent="true" id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.cmml"><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml">θ</mi><mo id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.1" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml">~</mo></mover></msub><mo id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml"><msub id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4.cmml"><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4.2.cmml">a</mi><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.3.cmml"><msub id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml">o</mi><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1"><times id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2"></times><apply id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.2">𝑄</ci><apply id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3"><ci id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.1">~</ci><ci id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.2">𝜃</ci></apply></apply><apply id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.3">conditional</csymbol><apply id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4.2.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4.2">𝑎</ci><ci id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4.3.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2"><apply id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2.2">𝑜</ci><ci id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px2.p1.1.m1.1c">{Q}_{\tilde{\theta}}(a_{t}|s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px2.p1.1.m1.1d">italic_Q start_POSTSUBSCRIPT over~ start_ARG italic_θ end_ARG end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> as a periodic copy of the online network <math alttext="Q_{\theta}(a_{t}|s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS4.SSS0.Px2.p1.2.m2.1a"><mrow id="S4.SS4.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.cmml"><msub id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.2" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.2.cmml">Q</mi><mi id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.cmml"><msub id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4.cmml"><mi id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4.2" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4.2.cmml">a</mi><mi id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4.3" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.3" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.3.cmml"><msub id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.2" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.3" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.3" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2.2" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2.2.cmml">o</mi><mi id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2.3" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1"><times id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.2"></times><apply id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.2">𝑄</ci><ci id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3">𝜃</ci></apply><apply id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.3">conditional</csymbol><apply id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4">subscript</csymbol><ci id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4.2.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4.2">𝑎</ci><ci id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4.3.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2"><apply id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2.2">𝑜</ci><ci id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px2.p1.2.m2.1c">Q_{\theta}(a_{t}|s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px2.p1.2.m2.1d">italic_Q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> and trains <math alttext="Q_{\theta}(a_{t}|s_{t},o_{t})" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px2.p1.3.m3.1"><semantics id="S4.SS4.SSS0.Px2.p1.3.m3.1a"><mrow id="S4.SS4.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.cmml"><msub id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.2" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.2.cmml">Q</mi><mi id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.3" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.2" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml"><mo id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml"><msub id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4.cmml"><mi id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4.2" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4.2.cmml">a</mi><mi id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4.3" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.3" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.3.cmml"><msub id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.2" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.3" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.3" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2.2" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2.2.cmml">o</mi><mi id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2.3" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px2.p1.3.m3.1b"><apply id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1"><times id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.2"></times><apply id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.2">𝑄</ci><ci id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.3">𝜃</ci></apply><apply id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.3">conditional</csymbol><apply id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4.1.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4">subscript</csymbol><ci id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4.2.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4.2">𝑎</ci><ci id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4.3.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.3.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2"><apply id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2.2">𝑜</ci><ci id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px2.p1.3.m3.1c">Q_{\theta}(a_{t}|s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px2.p1.3.m3.1d">italic_Q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> to minimize the temporal difference error <cite class="ltx_cite ltx_citemacro_cite">Sutton (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib42" title="">1988</a>)</cite>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E6">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E6X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\theta}=\mathbb{E}_{e_{t}\sim\mathcal{D}}\Big{[}(Q_{%
\theta}(a_{t}|s_{t},o_{t})-r_{t}" class="ltx_math_unparsed" display="inline" id="S4.E6X.2.1.1.m1.1"><semantics id="S4.E6X.2.1.1.m1.1a"><mrow id="S4.E6X.2.1.1.m1.1b"><msub id="S4.E6X.2.1.1.m1.1.1"><mi class="ltx_font_mathcaligraphic" id="S4.E6X.2.1.1.m1.1.1.2">ℒ</mi><mi id="S4.E6X.2.1.1.m1.1.1.3">θ</mi></msub><mo id="S4.E6X.2.1.1.m1.1.2">=</mo><msub id="S4.E6X.2.1.1.m1.1.3"><mi id="S4.E6X.2.1.1.m1.1.3.2">𝔼</mi><mrow id="S4.E6X.2.1.1.m1.1.3.3"><msub id="S4.E6X.2.1.1.m1.1.3.3.2"><mi id="S4.E6X.2.1.1.m1.1.3.3.2.2">e</mi><mi id="S4.E6X.2.1.1.m1.1.3.3.2.3">t</mi></msub><mo id="S4.E6X.2.1.1.m1.1.3.3.1">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E6X.2.1.1.m1.1.3.3.3">𝒟</mi></mrow></msub><mrow id="S4.E6X.2.1.1.m1.1.4"><mo id="S4.E6X.2.1.1.m1.1.4.1" maxsize="160%" minsize="160%">[</mo><mrow id="S4.E6X.2.1.1.m1.1.4.2"><mo id="S4.E6X.2.1.1.m1.1.4.2.1" stretchy="false">(</mo><msub id="S4.E6X.2.1.1.m1.1.4.2.2"><mi id="S4.E6X.2.1.1.m1.1.4.2.2.2">Q</mi><mi id="S4.E6X.2.1.1.m1.1.4.2.2.3">θ</mi></msub><mrow id="S4.E6X.2.1.1.m1.1.4.2.3"><mo id="S4.E6X.2.1.1.m1.1.4.2.3.1" stretchy="false">(</mo><msub id="S4.E6X.2.1.1.m1.1.4.2.3.2"><mi id="S4.E6X.2.1.1.m1.1.4.2.3.2.2">a</mi><mi id="S4.E6X.2.1.1.m1.1.4.2.3.2.3">t</mi></msub><mo fence="false" id="S4.E6X.2.1.1.m1.1.4.2.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="S4.E6X.2.1.1.m1.1.4.2.3.4"><mi id="S4.E6X.2.1.1.m1.1.4.2.3.4.2">s</mi><mi id="S4.E6X.2.1.1.m1.1.4.2.3.4.3">t</mi></msub><mo id="S4.E6X.2.1.1.m1.1.4.2.3.5">,</mo><msub id="S4.E6X.2.1.1.m1.1.4.2.3.6"><mi id="S4.E6X.2.1.1.m1.1.4.2.3.6.2">o</mi><mi id="S4.E6X.2.1.1.m1.1.4.2.3.6.3">t</mi></msub><mo id="S4.E6X.2.1.1.m1.1.4.2.3.7" stretchy="false">)</mo></mrow><mo id="S4.E6X.2.1.1.m1.1.4.2.4">−</mo><msub id="S4.E6X.2.1.1.m1.1.4.2.5"><mi id="S4.E6X.2.1.1.m1.1.4.2.5.2">r</mi><mi id="S4.E6X.2.1.1.m1.1.4.2.5.3">t</mi></msub></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E6X.2.1.1.m1.1c">\displaystyle\mathcal{L}_{\theta}=\mathbb{E}_{e_{t}\sim\mathcal{D}}\Big{[}(Q_{%
\theta}(a_{t}|s_{t},o_{t})-r_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.E6X.2.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_e start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ caligraphic_D end_POSTSUBSCRIPT [ ( italic_Q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E6Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle-\gamma\max_{a_{t+1}\in\mathcal{A}_{s_{t+1},o_{t+1}}}Q_{\tilde{%
\theta}}(a_{t+1}|s_{t+1},o_{t+1}))^{2}\Big{]}," class="ltx_math_unparsed" display="inline" id="S4.E6Xa.2.1.1.m1.2"><semantics id="S4.E6Xa.2.1.1.m1.2a"><mrow id="S4.E6Xa.2.1.1.m1.2b"><msup id="S4.E6Xa.2.1.1.m1.2.3"><mrow id="S4.E6Xa.2.1.1.m1.2.3.2"><mo id="S4.E6Xa.2.1.1.m1.2.3.2.1">−</mo><mi id="S4.E6Xa.2.1.1.m1.2.3.2.2">γ</mi><munder id="S4.E6Xa.2.1.1.m1.2.3.2.3"><mi id="S4.E6Xa.2.1.1.m1.2.3.2.3.2">max</mi><mrow id="S4.E6Xa.2.1.1.m1.2.2.2"><msub id="S4.E6Xa.2.1.1.m1.2.2.2.4"><mi id="S4.E6Xa.2.1.1.m1.2.2.2.4.2">a</mi><mrow id="S4.E6Xa.2.1.1.m1.2.2.2.4.3"><mi id="S4.E6Xa.2.1.1.m1.2.2.2.4.3.2">t</mi><mo id="S4.E6Xa.2.1.1.m1.2.2.2.4.3.1">+</mo><mn id="S4.E6Xa.2.1.1.m1.2.2.2.4.3.3">1</mn></mrow></msub><mo id="S4.E6Xa.2.1.1.m1.2.2.2.3">∈</mo><msub id="S4.E6Xa.2.1.1.m1.2.2.2.5"><mi class="ltx_font_mathcaligraphic" id="S4.E6Xa.2.1.1.m1.2.2.2.5.2">𝒜</mi><mrow id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2"><msub id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.1"><mi id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.2">s</mi><mrow id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.3"><mi id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2">t</mi><mo id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1">+</mo><mn id="S4.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3">1</mn></mrow></msub><mo id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.3">,</mo><msub id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.2"><mi id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.2.2">o</mi><mrow id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.2.3"><mi id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.2.3.2">t</mi><mo id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.2.3.1">+</mo><mn id="S4.E6Xa.2.1.1.m1.2.2.2.2.2.2.2.3.3">1</mn></mrow></msub></mrow></msub></mrow></munder><msub id="S4.E6Xa.2.1.1.m1.2.3.2.4"><mi id="S4.E6Xa.2.1.1.m1.2.3.2.4.2">Q</mi><mover accent="true" id="S4.E6Xa.2.1.1.m1.2.3.2.4.3"><mi id="S4.E6Xa.2.1.1.m1.2.3.2.4.3.2">θ</mi><mo id="S4.E6Xa.2.1.1.m1.2.3.2.4.3.1">~</mo></mover></msub><mrow id="S4.E6Xa.2.1.1.m1.2.3.2.5"><mo id="S4.E6Xa.2.1.1.m1.2.3.2.5.1" stretchy="false">(</mo><msub id="S4.E6Xa.2.1.1.m1.2.3.2.5.2"><mi id="S4.E6Xa.2.1.1.m1.2.3.2.5.2.2">a</mi><mrow id="S4.E6Xa.2.1.1.m1.2.3.2.5.2.3"><mi id="S4.E6Xa.2.1.1.m1.2.3.2.5.2.3.2">t</mi><mo id="S4.E6Xa.2.1.1.m1.2.3.2.5.2.3.1">+</mo><mn id="S4.E6Xa.2.1.1.m1.2.3.2.5.2.3.3">1</mn></mrow></msub><mo fence="false" id="S4.E6Xa.2.1.1.m1.2.3.2.5.3" rspace="0.167em" stretchy="false">|</mo><msub id="S4.E6Xa.2.1.1.m1.2.3.2.5.4"><mi id="S4.E6Xa.2.1.1.m1.2.3.2.5.4.2">s</mi><mrow id="S4.E6Xa.2.1.1.m1.2.3.2.5.4.3"><mi id="S4.E6Xa.2.1.1.m1.2.3.2.5.4.3.2">t</mi><mo id="S4.E6Xa.2.1.1.m1.2.3.2.5.4.3.1">+</mo><mn id="S4.E6Xa.2.1.1.m1.2.3.2.5.4.3.3">1</mn></mrow></msub><mo id="S4.E6Xa.2.1.1.m1.2.3.2.5.5">,</mo><msub id="S4.E6Xa.2.1.1.m1.2.3.2.5.6"><mi id="S4.E6Xa.2.1.1.m1.2.3.2.5.6.2">o</mi><mrow id="S4.E6Xa.2.1.1.m1.2.3.2.5.6.3"><mi id="S4.E6Xa.2.1.1.m1.2.3.2.5.6.3.2">t</mi><mo id="S4.E6Xa.2.1.1.m1.2.3.2.5.6.3.1">+</mo><mn id="S4.E6Xa.2.1.1.m1.2.3.2.5.6.3.3">1</mn></mrow></msub><mo id="S4.E6Xa.2.1.1.m1.2.3.2.5.7" stretchy="false">)</mo></mrow><mo id="S4.E6Xa.2.1.1.m1.2.3.2.6" stretchy="false">)</mo></mrow><mn id="S4.E6Xa.2.1.1.m1.2.3.3">2</mn></msup><mo id="S4.E6Xa.2.1.1.m1.2.4" maxsize="160%" minsize="160%">]</mo><mo id="S4.E6Xa.2.1.1.m1.2.5">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E6Xa.2.1.1.m1.2c">\displaystyle-\gamma\max_{a_{t+1}\in\mathcal{A}_{s_{t+1},o_{t+1}}}Q_{\tilde{%
\theta}}(a_{t+1}|s_{t+1},o_{t+1}))^{2}\Big{]},</annotation><annotation encoding="application/x-llamapun" id="S4.E6Xa.2.1.1.m1.2d">- italic_γ roman_max start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∈ caligraphic_A start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT over~ start_ARG italic_θ end_ARG end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS4.SSS0.Px2.p1.4">where <math alttext="\gamma" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px2.p1.4.m1.1"><semantics id="S4.SS4.SSS0.Px2.p1.4.m1.1a"><mi id="S4.SS4.SSS0.Px2.p1.4.m1.1.1" xref="S4.SS4.SSS0.Px2.p1.4.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px2.p1.4.m1.1b"><ci id="S4.SS4.SSS0.Px2.p1.4.m1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.4.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px2.p1.4.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px2.p1.4.m1.1d">italic_γ</annotation></semantics></math> is the discount factor in MDP.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Improving Training Efficiency</h4>
<div class="ltx_para" id="S4.SS4.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px3.p1.4">This aforementioned training process guarantees the quality of training data by selecting only the high-rewarded trajectories, but may be inefficient because it requires a large number of simulations to collect enough high-rewarded trajectories.
To improve efficiency, we further propose a variant <span class="ltx_text" id="S4.SS4.SSS0.Px3.p1.1.1"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p1.1.1.m1.1"><semantics id="S4.SS4.SSS0.Px3.p1.1.1.m1.1a"><mrow id="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1" xref="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.2" xref="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.1" xref="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.3" xref="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p1.1.1.m1.1b"><apply id="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1"><times id="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.1"></times><ci id="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.2.cmml" xref="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.3a.cmml" xref="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.3"><mtext id="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.3.cmml" xref="S4.SS4.SSS0.Px3.p1.1.1.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p1.1.1.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p1.1.1.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span>. Instead of using only the highest-rewarded trajectories, <span class="ltx_text" id="S4.SS4.SSS0.Px3.p1.2.2"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p1.2.2.m1.1"><semantics id="S4.SS4.SSS0.Px3.p1.2.2.m1.1a"><mrow id="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1" xref="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.2" xref="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.1" xref="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.3" xref="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p1.2.2.m1.1b"><apply id="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1"><times id="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.1"></times><ci id="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.2.cmml" xref="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.3a.cmml" xref="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.3"><mtext id="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.3.cmml" xref="S4.SS4.SSS0.Px3.p1.2.2.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p1.2.2.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p1.2.2.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> makes full use of all the trajectories found by <span class="ltx_text" id="S4.SS4.SSS0.Px3.p1.3.3"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p1.3.3.m1.1"><semantics id="S4.SS4.SSS0.Px3.p1.3.3.m1.1a"><mrow id="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1" xref="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.2" xref="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.1" xref="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.3" xref="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p1.3.3.m1.1b"><apply id="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1"><times id="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.1"></times><ci id="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.2.cmml" xref="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.2">𝚂</ci><ci id="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.3a.cmml" xref="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.3"><mtext id="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.3.cmml" xref="S4.SS4.SSS0.Px3.p1.3.3.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p1.3.3.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p1.3.3.m1.1d">typewriter_S -planner</annotation></semantics></math></span>. As <span class="ltx_text" id="S4.SS4.SSS0.Px3.p1.4.4"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p1.4.4.m1.1"><semantics id="S4.SS4.SSS0.Px3.p1.4.4.m1.1a"><mrow id="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1" xref="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.2" xref="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.2.cmml">𝚂</mi><mo id="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.1" xref="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.3" xref="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p1.4.4.m1.1b"><apply id="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1"><times id="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.1"></times><ci id="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.2.cmml" xref="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.2">𝚂</ci><ci id="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.3a.cmml" xref="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.3"><mtext id="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.3.cmml" xref="S4.SS4.SSS0.Px3.p1.4.4.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p1.4.4.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p1.4.4.m1.1d">typewriter_S -agent</annotation></semantics></math></span> usually requires fixed number of training trajectories to converge, utilizing all the trajectories—rather than just a selected few—greatly reduces the cost of collecting trajectories and improves training efficiency.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS0.Px3.p2">
<p class="ltx_p" id="S4.SS4.SSS0.Px3.p2.6">Since some trajectories are good while others are suboptimal (e.g., user quits the conversation after <math alttext="T_{\text{max}}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p2.1.m1.1"><semantics id="S4.SS4.SSS0.Px3.p2.1.m1.1a"><msub id="S4.SS4.SSS0.Px3.p2.1.m1.1.1" xref="S4.SS4.SSS0.Px3.p2.1.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px3.p2.1.m1.1.1.2" xref="S4.SS4.SSS0.Px3.p2.1.m1.1.1.2.cmml">T</mi><mtext id="S4.SS4.SSS0.Px3.p2.1.m1.1.1.3" xref="S4.SS4.SSS0.Px3.p2.1.m1.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p2.1.m1.1b"><apply id="S4.SS4.SSS0.Px3.p2.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.1.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.1.m1.1.1.2.cmml" xref="S4.SS4.SSS0.Px3.p2.1.m1.1.1.2">𝑇</ci><ci id="S4.SS4.SSS0.Px3.p2.1.m1.1.1.3a.cmml" xref="S4.SS4.SSS0.Px3.p2.1.m1.1.1.3"><mtext id="S4.SS4.SSS0.Px3.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS4.SSS0.Px3.p2.1.m1.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p2.1.m1.1c">T_{\text{max}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p2.1.m1.1d">italic_T start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math> turns), we would like to encourage <math alttext="\pi_{\phi}(o_{t}|s_{t})" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p2.2.m2.1"><semantics id="S4.SS4.SSS0.Px3.p2.2.m2.1a"><mrow id="S4.SS4.SSS0.Px3.p2.2.m2.1.1" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.cmml"><msub id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3.2" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3.2.cmml">π</mi><mi id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3.3" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3.3.cmml">ϕ</mi></msub><mo id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.2" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.cmml"><msub id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2.cmml"><mi id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2.2" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2.2.cmml">o</mi><mi id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2.3" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.1" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3.2" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3.2.cmml">s</mi><mi id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3.3" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p2.2.m2.1b"><apply id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1"><times id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.2.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.2"></times><apply id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3.2.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3.2">𝜋</ci><ci id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.3.3">italic-ϕ</ci></apply><apply id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1"><csymbol cd="latexml" id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2.2">𝑜</ci><ci id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3.2.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px3.p2.2.m2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p2.2.m2.1c">\pi_{\phi}(o_{t}|s_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p2.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> to increase the likelihood for good trajectories and decrease the likelihood for the suboptimal ones.
To this end, we employ the Plackett-Luce model <cite class="ltx_cite ltx_citemacro_cite">Luce (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib30" title="">1959</a>); Plackett (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib35" title="">1975</a>)</cite> to train <math alttext="\pi_{\phi}(o_{t}|s_{t})" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p2.3.m3.1"><semantics id="S4.SS4.SSS0.Px3.p2.3.m3.1a"><mrow id="S4.SS4.SSS0.Px3.p2.3.m3.1.1" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.cmml"><msub id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3.2" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3.2.cmml">π</mi><mi id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3.3" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3.3.cmml">ϕ</mi></msub><mo id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.2" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.cmml"><mo id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.cmml"><msub id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2.cmml"><mi id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2.2" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2.2.cmml">o</mi><mi id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2.3" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.1" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.1.cmml">|</mo><msub id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3.2" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3.2.cmml">s</mi><mi id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3.3" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p2.3.m3.1b"><apply id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1"><times id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.2.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.2"></times><apply id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3.2.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3.2">𝜋</ci><ci id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.3.3">italic-ϕ</ci></apply><apply id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1"><csymbol cd="latexml" id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2.2">𝑜</ci><ci id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2.3.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3.2.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px3.p2.3.m3.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p2.3.m3.1c">\pi_{\phi}(o_{t}|s_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p2.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> with listwise likelihood estimations. For each user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p2.4.m4.1"><semantics id="S4.SS4.SSS0.Px3.p2.4.m4.1a"><mi id="S4.SS4.SSS0.Px3.p2.4.m4.1.1" xref="S4.SS4.SSS0.Px3.p2.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p2.4.m4.1b"><ci id="S4.SS4.SSS0.Px3.p2.4.m4.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p2.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p2.4.m4.1d">italic_u</annotation></semantics></math>, assuming all the <math alttext="N" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p2.5.m5.1"><semantics id="S4.SS4.SSS0.Px3.p2.5.m5.1a"><mi id="S4.SS4.SSS0.Px3.p2.5.m5.1.1" xref="S4.SS4.SSS0.Px3.p2.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p2.5.m5.1b"><ci id="S4.SS4.SSS0.Px3.p2.5.m5.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p2.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p2.5.m5.1d">italic_N</annotation></semantics></math> trajectories are ranked by their cumulative rewards in the order of <math alttext="\tau^{(u)}_{1},\tau^{(u)}_{2},\cdots,\tau^{(u)}_{N}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p2.6.m6.7"><semantics id="S4.SS4.SSS0.Px3.p2.6.m6.7a"><mrow id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.4.cmml"><msubsup id="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1" xref="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.cmml"><mi id="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.2.2" xref="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.2.2.cmml">τ</mi><mn id="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.3" xref="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.3.cmml">1</mn><mrow id="S4.SS4.SSS0.Px3.p2.6.m6.1.1.1.3" xref="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.cmml"><mo id="S4.SS4.SSS0.Px3.p2.6.m6.1.1.1.3.1" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.cmml">(</mo><mi id="S4.SS4.SSS0.Px3.p2.6.m6.1.1.1.1" xref="S4.SS4.SSS0.Px3.p2.6.m6.1.1.1.1.cmml">u</mi><mo id="S4.SS4.SSS0.Px3.p2.6.m6.1.1.1.3.2" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.4" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.4.cmml">,</mo><msubsup id="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2" xref="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.cmml"><mi id="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.2.2" xref="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.2.2.cmml">τ</mi><mn id="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.3" xref="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.3.cmml">2</mn><mrow id="S4.SS4.SSS0.Px3.p2.6.m6.2.2.1.3" xref="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.cmml"><mo id="S4.SS4.SSS0.Px3.p2.6.m6.2.2.1.3.1" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.cmml">(</mo><mi id="S4.SS4.SSS0.Px3.p2.6.m6.2.2.1.1" xref="S4.SS4.SSS0.Px3.p2.6.m6.2.2.1.1.cmml">u</mi><mo id="S4.SS4.SSS0.Px3.p2.6.m6.2.2.1.3.2" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.5" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.4.cmml">,</mo><mi id="S4.SS4.SSS0.Px3.p2.6.m6.4.4" mathvariant="normal" xref="S4.SS4.SSS0.Px3.p2.6.m6.4.4.cmml">⋯</mi><mo id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.6" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.4.cmml">,</mo><msubsup id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.cmml"><mi id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.2.2" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.2.2.cmml">τ</mi><mi id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.3" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.3.cmml">N</mi><mrow id="S4.SS4.SSS0.Px3.p2.6.m6.3.3.1.3" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.cmml"><mo id="S4.SS4.SSS0.Px3.p2.6.m6.3.3.1.3.1" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.cmml">(</mo><mi id="S4.SS4.SSS0.Px3.p2.6.m6.3.3.1.1" xref="S4.SS4.SSS0.Px3.p2.6.m6.3.3.1.1.cmml">u</mi><mo id="S4.SS4.SSS0.Px3.p2.6.m6.3.3.1.3.2" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p2.6.m6.7b"><list id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.4.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3"><apply id="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1">subscript</csymbol><apply id="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.2.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1">superscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.2.2">𝜏</ci><ci id="S4.SS4.SSS0.Px3.p2.6.m6.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.1.1.1.1">𝑢</ci></apply><cn id="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.3.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p2.6.m6.5.5.1.1.3">1</cn></apply><apply id="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2">subscript</csymbol><apply id="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2">superscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.2.2">𝜏</ci><ci id="S4.SS4.SSS0.Px3.p2.6.m6.2.2.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.2.2.1.1">𝑢</ci></apply><cn id="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.3.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p2.6.m6.6.6.2.2.3">2</cn></apply><ci id="S4.SS4.SSS0.Px3.p2.6.m6.4.4.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.4.4">⋯</ci><apply id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.1.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3">subscript</csymbol><apply id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.2.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3">superscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.2.2">𝜏</ci><ci id="S4.SS4.SSS0.Px3.p2.6.m6.3.3.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.3.3.1.1">𝑢</ci></apply><ci id="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.3.cmml" xref="S4.SS4.SSS0.Px3.p2.6.m6.7.7.3.3.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p2.6.m6.7c">\tau^{(u)}_{1},\tau^{(u)}_{2},\cdots,\tau^{(u)}_{N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p2.6.m6.7d">italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math>, the policy network is updated with the following loss function:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\phi}=\mathbb{E}_{u\sim\mathcal{U}}\left[-\log P(\tau_{1}^{(u)}%
\succ\tau_{2}^{(u)}\succ\cdots\succ\tau_{N}^{(u)})\right]" class="ltx_Math" display="block" id="S4.Ex1.m1.4"><semantics id="S4.Ex1.m1.4a"><mrow id="S4.Ex1.m1.4.4" xref="S4.Ex1.m1.4.4.cmml"><msub id="S4.Ex1.m1.4.4.3" xref="S4.Ex1.m1.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.4.4.3.2" xref="S4.Ex1.m1.4.4.3.2.cmml">ℒ</mi><mi id="S4.Ex1.m1.4.4.3.3" xref="S4.Ex1.m1.4.4.3.3.cmml">ϕ</mi></msub><mo id="S4.Ex1.m1.4.4.2" xref="S4.Ex1.m1.4.4.2.cmml">=</mo><mrow id="S4.Ex1.m1.4.4.1" xref="S4.Ex1.m1.4.4.1.cmml"><msub id="S4.Ex1.m1.4.4.1.3" xref="S4.Ex1.m1.4.4.1.3.cmml"><mi id="S4.Ex1.m1.4.4.1.3.2" xref="S4.Ex1.m1.4.4.1.3.2.cmml">𝔼</mi><mrow id="S4.Ex1.m1.4.4.1.3.3" xref="S4.Ex1.m1.4.4.1.3.3.cmml"><mi id="S4.Ex1.m1.4.4.1.3.3.2" xref="S4.Ex1.m1.4.4.1.3.3.2.cmml">u</mi><mo id="S4.Ex1.m1.4.4.1.3.3.1" xref="S4.Ex1.m1.4.4.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.4.4.1.3.3.3" xref="S4.Ex1.m1.4.4.1.3.3.3.cmml">𝒰</mi></mrow></msub><mo id="S4.Ex1.m1.4.4.1.2" xref="S4.Ex1.m1.4.4.1.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.4.4.1.1.1" xref="S4.Ex1.m1.4.4.1.1.2.cmml"><mo id="S4.Ex1.m1.4.4.1.1.1.2" xref="S4.Ex1.m1.4.4.1.1.2.1.cmml">[</mo><mrow id="S4.Ex1.m1.4.4.1.1.1.1" xref="S4.Ex1.m1.4.4.1.1.1.1.cmml"><mo id="S4.Ex1.m1.4.4.1.1.1.1a" rspace="0.167em" xref="S4.Ex1.m1.4.4.1.1.1.1.cmml">−</mo><mrow id="S4.Ex1.m1.4.4.1.1.1.1.1" xref="S4.Ex1.m1.4.4.1.1.1.1.1.cmml"><mrow id="S4.Ex1.m1.4.4.1.1.1.1.1.3" xref="S4.Ex1.m1.4.4.1.1.1.1.1.3.cmml"><mi id="S4.Ex1.m1.4.4.1.1.1.1.1.3.1" xref="S4.Ex1.m1.4.4.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.Ex1.m1.4.4.1.1.1.1.1.3a" lspace="0.167em" xref="S4.Ex1.m1.4.4.1.1.1.1.1.3.cmml">⁡</mo><mi id="S4.Ex1.m1.4.4.1.1.1.1.1.3.2" xref="S4.Ex1.m1.4.4.1.1.1.1.1.3.2.cmml">P</mi></mrow><mo id="S4.Ex1.m1.4.4.1.1.1.1.1.2" xref="S4.Ex1.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml">τ</mi><mn id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.3" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.cmml">1</mn><mrow id="S4.Ex1.m1.1.1.1.3" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.Ex1.m1.1.1.1.3.1" stretchy="false" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S4.Ex1.m1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.cmml">u</mi><mo id="S4.Ex1.m1.1.1.1.3.2" stretchy="false" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">≻</mo><msubsup id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.2.2" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.2.2.cmml">τ</mi><mn id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.2.3" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.2.3.cmml">2</mn><mrow id="S4.Ex1.m1.2.2.1.3" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.cmml"><mo id="S4.Ex1.m1.2.2.1.3.1" stretchy="false" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.cmml">(</mo><mi id="S4.Ex1.m1.2.2.1.1" xref="S4.Ex1.m1.2.2.1.1.cmml">u</mi><mo id="S4.Ex1.m1.2.2.1.3.2" stretchy="false" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.cmml">)</mo></mrow></msubsup><mo id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.5" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.5.cmml">≻</mo><mi id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.6" mathvariant="normal" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.6.cmml">⋯</mi><mo id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.7" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.7.cmml">≻</mo><msubsup id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.cmml"><mi id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.2.2" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.2.2.cmml">τ</mi><mi id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.2.3" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.2.3.cmml">N</mi><mrow id="S4.Ex1.m1.3.3.1.3" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.cmml"><mo id="S4.Ex1.m1.3.3.1.3.1" stretchy="false" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.cmml">(</mo><mi id="S4.Ex1.m1.3.3.1.1" xref="S4.Ex1.m1.3.3.1.1.cmml">u</mi><mo id="S4.Ex1.m1.3.3.1.3.2" stretchy="false" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex1.m1.4.4.1.1.1.3" xref="S4.Ex1.m1.4.4.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.4b"><apply id="S4.Ex1.m1.4.4.cmml" xref="S4.Ex1.m1.4.4"><eq id="S4.Ex1.m1.4.4.2.cmml" xref="S4.Ex1.m1.4.4.2"></eq><apply id="S4.Ex1.m1.4.4.3.cmml" xref="S4.Ex1.m1.4.4.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.3.1.cmml" xref="S4.Ex1.m1.4.4.3">subscript</csymbol><ci id="S4.Ex1.m1.4.4.3.2.cmml" xref="S4.Ex1.m1.4.4.3.2">ℒ</ci><ci id="S4.Ex1.m1.4.4.3.3.cmml" xref="S4.Ex1.m1.4.4.3.3">italic-ϕ</ci></apply><apply id="S4.Ex1.m1.4.4.1.cmml" xref="S4.Ex1.m1.4.4.1"><times id="S4.Ex1.m1.4.4.1.2.cmml" xref="S4.Ex1.m1.4.4.1.2"></times><apply id="S4.Ex1.m1.4.4.1.3.cmml" xref="S4.Ex1.m1.4.4.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.1.3.1.cmml" xref="S4.Ex1.m1.4.4.1.3">subscript</csymbol><ci id="S4.Ex1.m1.4.4.1.3.2.cmml" xref="S4.Ex1.m1.4.4.1.3.2">𝔼</ci><apply id="S4.Ex1.m1.4.4.1.3.3.cmml" xref="S4.Ex1.m1.4.4.1.3.3"><csymbol cd="latexml" id="S4.Ex1.m1.4.4.1.3.3.1.cmml" xref="S4.Ex1.m1.4.4.1.3.3.1">similar-to</csymbol><ci id="S4.Ex1.m1.4.4.1.3.3.2.cmml" xref="S4.Ex1.m1.4.4.1.3.3.2">𝑢</ci><ci id="S4.Ex1.m1.4.4.1.3.3.3.cmml" xref="S4.Ex1.m1.4.4.1.3.3.3">𝒰</ci></apply></apply><apply id="S4.Ex1.m1.4.4.1.1.2.cmml" xref="S4.Ex1.m1.4.4.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m1.4.4.1.1.2.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.2">delimited-[]</csymbol><apply id="S4.Ex1.m1.4.4.1.1.1.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1"><minus id="S4.Ex1.m1.4.4.1.1.1.1.2.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1"></minus><apply id="S4.Ex1.m1.4.4.1.1.1.1.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1"><times id="S4.Ex1.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.2"></times><apply id="S4.Ex1.m1.4.4.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.3"><log id="S4.Ex1.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.3.1"></log><ci id="S4.Ex1.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.3.2">𝑃</ci></apply><apply id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1"><and id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1a.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1"></and><apply id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1b.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.3">succeeds</csymbol><apply id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2">𝜏</ci><cn id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.2.2.3">1</cn></apply><ci id="S4.Ex1.m1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1">𝑢</ci></apply><apply id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4">superscript</csymbol><apply id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.2.2">𝜏</ci><cn id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.2.3.cmml" type="integer" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.2.3">2</cn></apply><ci id="S4.Ex1.m1.2.2.1.1.cmml" xref="S4.Ex1.m1.2.2.1.1">𝑢</ci></apply></apply><apply id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1c.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.5.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.5">succeeds</csymbol><share href="https://arxiv.org/html/2410.09580v1#S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.4.cmml" id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1d.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1"></share><ci id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.6.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.6">⋯</ci></apply><apply id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1e.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.7.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.7">succeeds</csymbol><share href="https://arxiv.org/html/2410.09580v1#S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.6.cmml" id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1f.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1"></share><apply id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8">superscript</csymbol><apply id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.2.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.2.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8">subscript</csymbol><ci id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.2.2.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.2.2">𝜏</ci><ci id="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.2.3.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.1.1.1.1.8.2.3">𝑁</ci></apply><ci id="S4.Ex1.m1.3.3.1.1.cmml" xref="S4.Ex1.m1.3.3.1.1">𝑢</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.4c">\mathcal{L}_{\phi}=\mathbb{E}_{u\sim\mathcal{U}}\left[-\log P(\tau_{1}^{(u)}%
\succ\tau_{2}^{(u)}\succ\cdots\succ\tau_{N}^{(u)})\right]</annotation><annotation encoding="application/x-llamapun" id="S4.Ex1.m1.4d">caligraphic_L start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_u ∼ caligraphic_U end_POSTSUBSCRIPT [ - roman_log italic_P ( italic_τ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT ≻ italic_τ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT ≻ ⋯ ≻ italic_τ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\!=\!\mathbb{E}_{u\sim\mathcal{U}}\!\Bigg{[}\!-\!\log\!\prod\limits^{N}_{n=1}%
\!\frac{\exp\big{(}\sum\limits_{\mathclap{\begin{subarray}{c}s_{t},o_{t}\in%
\tau_{n}^{\!(u)\!}\end{subarray}}}\log\pi_{\phi}(o_{t}|s_{t})\big{)}}{\sum%
\limits^{N}_{j=n}\!\exp\!\big{(}\!\sum\limits_{\mathclap{\begin{subarray}{c}s_%
{t},o_{t}\in\tau_{j}^{\!(u)\!}\end{subarray}}}\log\pi_{\phi}(o_{t}|s_{t})\big{%
)}\!}\Bigg{]}," class="ltx_Math" display="block" id="S4.E7.m1.7"><semantics id="S4.E7.m1.7a"><mrow id="S4.E7.m1.7.7.1" xref="S4.E7.m1.7.7.1.1.cmml"><mrow id="S4.E7.m1.7.7.1.1" xref="S4.E7.m1.7.7.1.1.cmml"><mi id="S4.E7.m1.7.7.1.1.3" xref="S4.E7.m1.7.7.1.1.3.cmml"></mi><mo id="S4.E7.m1.7.7.1.1.2" lspace="0.108em" rspace="0.108em" xref="S4.E7.m1.7.7.1.1.2.cmml">=</mo><mrow id="S4.E7.m1.7.7.1.1.1" xref="S4.E7.m1.7.7.1.1.1.cmml"><msub id="S4.E7.m1.7.7.1.1.1.3" xref="S4.E7.m1.7.7.1.1.1.3.cmml"><mi id="S4.E7.m1.7.7.1.1.1.3.2" xref="S4.E7.m1.7.7.1.1.1.3.2.cmml">𝔼</mi><mrow id="S4.E7.m1.7.7.1.1.1.3.3" xref="S4.E7.m1.7.7.1.1.1.3.3.cmml"><mi id="S4.E7.m1.7.7.1.1.1.3.3.2" xref="S4.E7.m1.7.7.1.1.1.3.3.2.cmml">u</mi><mo id="S4.E7.m1.7.7.1.1.1.3.3.1" xref="S4.E7.m1.7.7.1.1.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.7.7.1.1.1.3.3.3" xref="S4.E7.m1.7.7.1.1.1.3.3.3.cmml">𝒰</mi></mrow></msub><mo id="S4.E7.m1.7.7.1.1.1.2" xref="S4.E7.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.7.7.1.1.1.1.1" xref="S4.E7.m1.7.7.1.1.1.1.2.cmml"><mo id="S4.E7.m1.7.7.1.1.1.1.1.2" maxsize="260%" minsize="260%" xref="S4.E7.m1.7.7.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E7.m1.7.7.1.1.1.1.1.1" xref="S4.E7.m1.7.7.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.7.7.1.1.1.1.1.1a" rspace="0.167em" xref="S4.E7.m1.7.7.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E7.m1.7.7.1.1.1.1.1.1.2" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.cmml"><mpadded width="1.313em"><mi id="S4.E7.m1.7.7.1.1.1.1.1.1.2.2" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.2.cmml">log</mi></mpadded><mo id="S4.E7.m1.7.7.1.1.1.1.1.1.2.1" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.cmml"><munderover id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.cmml"><mo id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.2.2" movablelimits="false" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.2.2.cmml">∏</mo><mrow id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.cmml"><mi id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.2" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.2.cmml">n</mi><mo id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.1" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.1.cmml">=</mo><mn id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.3" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.3.cmml">1</mn></mrow><mi id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.2.3" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.2.3.cmml">N</mi></munderover><mfrac id="S4.E7.m1.6.6" xref="S4.E7.m1.6.6.cmml"><mrow id="S4.E7.m1.4.4.4.3" xref="S4.E7.m1.4.4.4.4.cmml"><mi id="S4.E7.m1.3.3.3.2" xref="S4.E7.m1.3.3.3.2.cmml">exp</mi><mo id="S4.E7.m1.4.4.4.3a" xref="S4.E7.m1.4.4.4.4.cmml">⁡</mo><mrow id="S4.E7.m1.4.4.4.3.1" xref="S4.E7.m1.4.4.4.4.cmml"><mo id="S4.E7.m1.4.4.4.3.1.2" maxsize="120%" minsize="120%" xref="S4.E7.m1.4.4.4.4.cmml">(</mo><mrow id="S4.E7.m1.4.4.4.3.1.1" xref="S4.E7.m1.4.4.4.3.1.1.cmml"><munder id="S4.E7.m1.4.4.4.3.1.1.2" xref="S4.E7.m1.4.4.4.3.1.1.2.cmml"><mo id="S4.E7.m1.4.4.4.3.1.1.2.2" lspace="0em" movablelimits="false" xref="S4.E7.m1.4.4.4.3.1.1.2.2.cmml">∑</mo><mpadded id="S4.E7.m1.1.1.1.1.1.1.1.1.1" lspace="-10.8pt" width="0pt" xref="S4.E7.m1.1.1.1.1.1.2.cmml"><mtable id="S4.E7.m1.1.1.1.1.1.1.1.1.1a" xref="S4.E7.m1.1.1.1.1.1.2.cmml"><mtr id="S4.E7.m1.1.1.1.1.1.1.1.1.1b" xref="S4.E7.m1.1.1.1.1.1.2.cmml"><mtd id="S4.E7.m1.1.1.1.1.1.1.1.1.1c" xref="S4.E7.m1.1.1.1.1.1.2.cmml"><mrow id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mrow id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.3.cmml"><msub id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.2.cmml">s</mi><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.3.cmml">t</mi></msub><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.3.cmml">,</mo><msub id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.2.cmml">o</mi><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.3.cmml">t</mi></msub></mrow><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.4" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.4.cmml">∈</mo><msubsup id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.2.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.2.2.cmml">τ</mi><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.2.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.2.3.cmml">n</mi><mrow id="S4.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.cmml"><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" stretchy="false" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.cmml">(</mo><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">u</mi><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" stretchy="false" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.cmml">)</mo></mrow></msubsup></mrow></mtd></mtr></mtable></mpadded></munder><mrow id="S4.E7.m1.4.4.4.3.1.1.1" xref="S4.E7.m1.4.4.4.3.1.1.1.cmml"><mrow id="S4.E7.m1.4.4.4.3.1.1.1.3" xref="S4.E7.m1.4.4.4.3.1.1.1.3.cmml"><mi id="S4.E7.m1.4.4.4.3.1.1.1.3.1" xref="S4.E7.m1.4.4.4.3.1.1.1.3.1.cmml">log</mi><mo id="S4.E7.m1.4.4.4.3.1.1.1.3a" lspace="0.167em" xref="S4.E7.m1.4.4.4.3.1.1.1.3.cmml">⁡</mo><msub id="S4.E7.m1.4.4.4.3.1.1.1.3.2" xref="S4.E7.m1.4.4.4.3.1.1.1.3.2.cmml"><mi id="S4.E7.m1.4.4.4.3.1.1.1.3.2.2" xref="S4.E7.m1.4.4.4.3.1.1.1.3.2.2.cmml">π</mi><mi id="S4.E7.m1.4.4.4.3.1.1.1.3.2.3" xref="S4.E7.m1.4.4.4.3.1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo id="S4.E7.m1.4.4.4.3.1.1.1.2" xref="S4.E7.m1.4.4.4.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.4.3.1.1.1.1.1" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.4.4.4.3.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.cmml"><msub id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2.2" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2.2.cmml">o</mi><mi id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2.3" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.1" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3.2" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3.3" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S4.E7.m1.4.4.4.3.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.4.4.4.3.1.3" maxsize="120%" minsize="120%" xref="S4.E7.m1.4.4.4.4.cmml">)</mo></mrow></mrow><mrow id="S4.E7.m1.6.6.6" xref="S4.E7.m1.6.6.6.cmml"><munderover id="S4.E7.m1.6.6.6.4" xref="S4.E7.m1.6.6.6.4.cmml"><mo id="S4.E7.m1.6.6.6.4.2.2" movablelimits="false" xref="S4.E7.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="S4.E7.m1.6.6.6.4.3" xref="S4.E7.m1.6.6.6.4.3.cmml"><mi id="S4.E7.m1.6.6.6.4.3.2" xref="S4.E7.m1.6.6.6.4.3.2.cmml">j</mi><mo id="S4.E7.m1.6.6.6.4.3.1" xref="S4.E7.m1.6.6.6.4.3.1.cmml">=</mo><mi id="S4.E7.m1.6.6.6.4.3.3" xref="S4.E7.m1.6.6.6.4.3.3.cmml">n</mi></mrow><mi id="S4.E7.m1.6.6.6.4.2.3" xref="S4.E7.m1.6.6.6.4.2.3.cmml">N</mi></munderover><mrow id="S4.E7.m1.6.6.6.3.1" xref="S4.E7.m1.6.6.6.3.2.cmml"><mpadded width="1.370em"><mi id="S4.E7.m1.5.5.5.2" xref="S4.E7.m1.5.5.5.2.cmml">exp</mi></mpadded><mo id="S4.E7.m1.6.6.6.3.1a" xref="S4.E7.m1.6.6.6.3.2.cmml">⁡</mo><mrow id="S4.E7.m1.6.6.6.3.1.1" xref="S4.E7.m1.6.6.6.3.2.cmml"><mpadded width="0.288em"><mo id="S4.E7.m1.6.6.6.3.1.1.2" maxsize="120%" minsize="120%" xref="S4.E7.m1.6.6.6.3.2.cmml">(</mo></mpadded><mrow id="S4.E7.m1.6.6.6.3.1.1.1" xref="S4.E7.m1.6.6.6.3.1.1.1.cmml"><munder id="S4.E7.m1.6.6.6.3.1.1.1.2" xref="S4.E7.m1.6.6.6.3.1.1.1.2.cmml"><mo id="S4.E7.m1.6.6.6.3.1.1.1.2.2" movablelimits="false" xref="S4.E7.m1.6.6.6.3.1.1.1.2.2.cmml">∑</mo><mpadded id="S4.E7.m1.2.2.2.1.1.1.1.1.1" lspace="-10.6pt" width="0pt" xref="S4.E7.m1.2.2.2.1.1.2.cmml"><mtable id="S4.E7.m1.2.2.2.1.1.1.1.1.1a" xref="S4.E7.m1.2.2.2.1.1.2.cmml"><mtr id="S4.E7.m1.2.2.2.1.1.1.1.1.1b" xref="S4.E7.m1.2.2.2.1.1.2.cmml"><mtd id="S4.E7.m1.2.2.2.1.1.1.1.1.1c" xref="S4.E7.m1.2.2.2.1.1.2.cmml"><mrow id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.cmml"><mrow id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.3.cmml"><msub id="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1.cmml"><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1.2.cmml">s</mi><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1.3.cmml">t</mi></msub><mo id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.3.cmml">,</mo><msub id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2.cmml"><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2.2.cmml">o</mi><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2.3.cmml">t</mi></msub></mrow><mo id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.4" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.4.cmml">∈</mo><msubsup id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.cmml"><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.2.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.2.2.cmml">τ</mi><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.2.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.2.3.cmml">j</mi><mrow id="S4.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.cmml"><mo id="S4.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.1" stretchy="false" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.cmml">(</mo><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">u</mi><mo id="S4.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2" stretchy="false" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.cmml">)</mo></mrow></msubsup></mrow></mtd></mtr></mtable></mpadded></munder><mrow id="S4.E7.m1.6.6.6.3.1.1.1.1" xref="S4.E7.m1.6.6.6.3.1.1.1.1.cmml"><mrow id="S4.E7.m1.6.6.6.3.1.1.1.1.3" xref="S4.E7.m1.6.6.6.3.1.1.1.1.3.cmml"><mi id="S4.E7.m1.6.6.6.3.1.1.1.1.3.1" xref="S4.E7.m1.6.6.6.3.1.1.1.1.3.1.cmml">log</mi><mo id="S4.E7.m1.6.6.6.3.1.1.1.1.3a" lspace="0.167em" xref="S4.E7.m1.6.6.6.3.1.1.1.1.3.cmml">⁡</mo><msub id="S4.E7.m1.6.6.6.3.1.1.1.1.3.2" xref="S4.E7.m1.6.6.6.3.1.1.1.1.3.2.cmml"><mi id="S4.E7.m1.6.6.6.3.1.1.1.1.3.2.2" xref="S4.E7.m1.6.6.6.3.1.1.1.1.3.2.2.cmml">π</mi><mi id="S4.E7.m1.6.6.6.3.1.1.1.1.3.2.3" xref="S4.E7.m1.6.6.6.3.1.1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo id="S4.E7.m1.6.6.6.3.1.1.1.1.2" xref="S4.E7.m1.6.6.6.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><msub id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2.2.cmml">o</mi><mi id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2.3" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.1" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3.2" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3.3" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.6.6.6.3.1.1.3" maxsize="120%" minsize="120%" xref="S4.E7.m1.6.6.6.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E7.m1.7.7.1.1.1.1.1.3" maxsize="260%" minsize="260%" xref="S4.E7.m1.7.7.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E7.m1.7.7.1.2" xref="S4.E7.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.7b"><apply id="S4.E7.m1.7.7.1.1.cmml" xref="S4.E7.m1.7.7.1"><eq id="S4.E7.m1.7.7.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.2"></eq><csymbol cd="latexml" id="S4.E7.m1.7.7.1.1.3.cmml" xref="S4.E7.m1.7.7.1.1.3">absent</csymbol><apply id="S4.E7.m1.7.7.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1"><times id="S4.E7.m1.7.7.1.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1.2"></times><apply id="S4.E7.m1.7.7.1.1.1.3.cmml" xref="S4.E7.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.3.1.cmml" xref="S4.E7.m1.7.7.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.7.7.1.1.1.3.2.cmml" xref="S4.E7.m1.7.7.1.1.1.3.2">𝔼</ci><apply id="S4.E7.m1.7.7.1.1.1.3.3.cmml" xref="S4.E7.m1.7.7.1.1.1.3.3"><csymbol cd="latexml" id="S4.E7.m1.7.7.1.1.1.3.3.1.cmml" xref="S4.E7.m1.7.7.1.1.1.3.3.1">similar-to</csymbol><ci id="S4.E7.m1.7.7.1.1.1.3.3.2.cmml" xref="S4.E7.m1.7.7.1.1.1.3.3.2">𝑢</ci><ci id="S4.E7.m1.7.7.1.1.1.3.3.3.cmml" xref="S4.E7.m1.7.7.1.1.1.3.3.3">𝒰</ci></apply></apply><apply id="S4.E7.m1.7.7.1.1.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.7.7.1.1.1.1.2.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E7.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1"><minus id="S4.E7.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1"></minus><apply id="S4.E7.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2"><times id="S4.E7.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.1"></times><log id="S4.E7.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.2"></log><apply id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3"><apply id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1">subscript</csymbol><apply id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.2.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1">superscript</csymbol><csymbol cd="latexml" id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.2.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.2.2">product</csymbol><ci id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.2.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.2.3">𝑁</ci></apply><apply id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3"><eq id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.1"></eq><ci id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.2">𝑛</ci><cn id="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.3.cmml" type="integer" xref="S4.E7.m1.7.7.1.1.1.1.1.1.2.3.1.3.3">1</cn></apply></apply><apply id="S4.E7.m1.6.6.cmml" xref="S4.E7.m1.6.6"><divide id="S4.E7.m1.6.6.7.cmml" xref="S4.E7.m1.6.6"></divide><apply id="S4.E7.m1.4.4.4.4.cmml" xref="S4.E7.m1.4.4.4.3"><exp id="S4.E7.m1.3.3.3.2.cmml" xref="S4.E7.m1.3.3.3.2"></exp><apply id="S4.E7.m1.4.4.4.3.1.1.cmml" xref="S4.E7.m1.4.4.4.3.1.1"><apply id="S4.E7.m1.4.4.4.3.1.1.2.cmml" xref="S4.E7.m1.4.4.4.3.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.3.1.1.2.1.cmml" xref="S4.E7.m1.4.4.4.3.1.1.2">subscript</csymbol><sum id="S4.E7.m1.4.4.4.3.1.1.2.2.cmml" xref="S4.E7.m1.4.4.4.3.1.1.2.2"></sum><list id="S4.E7.m1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1"><matrix id="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1"><matrixrow id="S4.E7.m1.1.1.1.1.1.1.1.1.1a.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1"><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3"><in id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.4.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.4"></in><list id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2"><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.2">𝑠</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.3">𝑡</ci></apply><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.2">𝑜</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.3">𝑡</ci></apply></list><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5">superscript</csymbol><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.2.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.2.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.2.2">𝜏</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.2.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.5.2.3">𝑛</ci></apply><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">𝑢</ci></apply></apply></matrixrow></matrix></list></apply><apply id="S4.E7.m1.4.4.4.3.1.1.1.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1"><times id="S4.E7.m1.4.4.4.3.1.1.1.2.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.2"></times><apply id="S4.E7.m1.4.4.4.3.1.1.1.3.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.3"><log id="S4.E7.m1.4.4.4.3.1.1.1.3.1.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.3.1"></log><apply id="S4.E7.m1.4.4.4.3.1.1.1.3.2.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.3.1.1.1.3.2.1.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.3.2">subscript</csymbol><ci id="S4.E7.m1.4.4.4.3.1.1.1.3.2.2.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.3.2.2">𝜋</ci><ci id="S4.E7.m1.4.4.4.3.1.1.1.3.2.3.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2.2">𝑜</ci><ci id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.4.4.4.3.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply><apply id="S4.E7.m1.6.6.6.cmml" xref="S4.E7.m1.6.6.6"><apply id="S4.E7.m1.6.6.6.4.cmml" xref="S4.E7.m1.6.6.6.4"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.6.4.1.cmml" xref="S4.E7.m1.6.6.6.4">subscript</csymbol><apply id="S4.E7.m1.6.6.6.4.2.cmml" xref="S4.E7.m1.6.6.6.4"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.6.4.2.1.cmml" xref="S4.E7.m1.6.6.6.4">superscript</csymbol><sum id="S4.E7.m1.6.6.6.4.2.2.cmml" xref="S4.E7.m1.6.6.6.4.2.2"></sum><ci id="S4.E7.m1.6.6.6.4.2.3.cmml" xref="S4.E7.m1.6.6.6.4.2.3">𝑁</ci></apply><apply id="S4.E7.m1.6.6.6.4.3.cmml" xref="S4.E7.m1.6.6.6.4.3"><eq id="S4.E7.m1.6.6.6.4.3.1.cmml" xref="S4.E7.m1.6.6.6.4.3.1"></eq><ci id="S4.E7.m1.6.6.6.4.3.2.cmml" xref="S4.E7.m1.6.6.6.4.3.2">𝑗</ci><ci id="S4.E7.m1.6.6.6.4.3.3.cmml" xref="S4.E7.m1.6.6.6.4.3.3">𝑛</ci></apply></apply><apply id="S4.E7.m1.6.6.6.3.2.cmml" xref="S4.E7.m1.6.6.6.3.1"><exp id="S4.E7.m1.5.5.5.2.cmml" xref="S4.E7.m1.5.5.5.2"></exp><apply id="S4.E7.m1.6.6.6.3.1.1.1.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1"><apply id="S4.E7.m1.6.6.6.3.1.1.1.2.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.6.3.1.1.1.2.1.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.2">subscript</csymbol><sum id="S4.E7.m1.6.6.6.3.1.1.1.2.2.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.2.2"></sum><list id="S4.E7.m1.2.2.2.1.1.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1"><matrix id="S4.E7.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1"><matrixrow id="S4.E7.m1.2.2.2.1.1.1.1.1.1a.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1"><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3"><in id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.4.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.4"></in><list id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2"><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1.2">𝑠</ci><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.1.3">𝑡</ci></apply><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2">subscript</csymbol><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2.2">𝑜</ci><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.3.2.2.3">𝑡</ci></apply></list><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5">superscript</csymbol><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5">subscript</csymbol><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.2.2">𝜏</ci><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.2.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.3.3.3.3.5.2.3">𝑗</ci></apply><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">𝑢</ci></apply></apply></matrixrow></matrix></list></apply><apply id="S4.E7.m1.6.6.6.3.1.1.1.1.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1"><times id="S4.E7.m1.6.6.6.3.1.1.1.1.2.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.2"></times><apply id="S4.E7.m1.6.6.6.3.1.1.1.1.3.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.3"><log id="S4.E7.m1.6.6.6.3.1.1.1.1.3.1.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.3.1"></log><apply id="S4.E7.m1.6.6.6.3.1.1.1.1.3.2.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.6.3.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E7.m1.6.6.6.3.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.3.2.2">𝜋</ci><ci id="S4.E7.m1.6.6.6.3.1.1.1.1.3.2.3.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2.2">𝑜</ci><ci id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.6.6.6.3.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.7c">\!=\!\mathbb{E}_{u\sim\mathcal{U}}\!\Bigg{[}\!-\!\log\!\prod\limits^{N}_{n=1}%
\!\frac{\exp\big{(}\sum\limits_{\mathclap{\begin{subarray}{c}s_{t},o_{t}\in%
\tau_{n}^{\!(u)\!}\end{subarray}}}\log\pi_{\phi}(o_{t}|s_{t})\big{)}}{\sum%
\limits^{N}_{j=n}\!\exp\!\big{(}\!\sum\limits_{\mathclap{\begin{subarray}{c}s_%
{t},o_{t}\in\tau_{j}^{\!(u)\!}\end{subarray}}}\log\pi_{\phi}(o_{t}|s_{t})\big{%
)}\!}\Bigg{]},</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.7d">= blackboard_E start_POSTSUBSCRIPT italic_u ∼ caligraphic_U end_POSTSUBSCRIPT [ - roman_log ∏ start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT divide start_ARG roman_exp ( ∑ start_POSTSUBSCRIPT start_ARG start_ROW start_CELL italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ italic_τ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT end_CELL end_ROW end_ARG end_POSTSUBSCRIPT roman_log italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) end_ARG start_ARG ∑ start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j = italic_n end_POSTSUBSCRIPT roman_exp ( ∑ start_POSTSUBSCRIPT start_ARG start_ROW start_CELL italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ italic_τ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT end_CELL end_ROW end_ARG end_POSTSUBSCRIPT roman_log italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) end_ARG ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.SSS0.Px3.p2.11">where <math alttext="\tau_{1}^{(u)}\succ\tau_{2}^{(u)}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p2.7.m1.2"><semantics id="S4.SS4.SSS0.Px3.p2.7.m1.2a"><mrow id="S4.SS4.SSS0.Px3.p2.7.m1.2.3" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.cmml"><msubsup id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.cmml"><mi id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.2.2" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.2.2.cmml">τ</mi><mn id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.2.3" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.2.3.cmml">1</mn><mrow id="S4.SS4.SSS0.Px3.p2.7.m1.1.1.1.3" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.cmml"><mo id="S4.SS4.SSS0.Px3.p2.7.m1.1.1.1.3.1" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.cmml">(</mo><mi id="S4.SS4.SSS0.Px3.p2.7.m1.1.1.1.1" xref="S4.SS4.SSS0.Px3.p2.7.m1.1.1.1.1.cmml">u</mi><mo id="S4.SS4.SSS0.Px3.p2.7.m1.1.1.1.3.2" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.1" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.1.cmml">≻</mo><msubsup id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.cmml"><mi id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.2.2" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.2.2.cmml">τ</mi><mn id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.2.3" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.2.3.cmml">2</mn><mrow id="S4.SS4.SSS0.Px3.p2.7.m1.2.2.1.3" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.cmml"><mo id="S4.SS4.SSS0.Px3.p2.7.m1.2.2.1.3.1" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.cmml">(</mo><mi id="S4.SS4.SSS0.Px3.p2.7.m1.2.2.1.1" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.2.1.1.cmml">u</mi><mo id="S4.SS4.SSS0.Px3.p2.7.m1.2.2.1.3.2" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p2.7.m1.2b"><apply id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3"><csymbol cd="latexml" id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.1.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.1">succeeds</csymbol><apply id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2">superscript</csymbol><apply id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2">subscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.2.2">𝜏</ci><cn id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.2.3.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.2.2.3">1</cn></apply><ci id="S4.SS4.SSS0.Px3.p2.7.m1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.1.1.1.1">𝑢</ci></apply><apply id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.1.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3">superscript</csymbol><apply id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.2.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.2.2">𝜏</ci><cn id="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.2.3.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.3.3.2.3">2</cn></apply><ci id="S4.SS4.SSS0.Px3.p2.7.m1.2.2.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.7.m1.2.2.1.1">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p2.7.m1.2c">\tau_{1}^{(u)}\succ\tau_{2}^{(u)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p2.7.m1.2d">italic_τ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT ≻ italic_τ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT</annotation></semantics></math> indicates <math alttext="\tau_{1}^{(u)}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p2.8.m2.1"><semantics id="S4.SS4.SSS0.Px3.p2.8.m2.1a"><msubsup id="S4.SS4.SSS0.Px3.p2.8.m2.1.2" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.2.cmml"><mi id="S4.SS4.SSS0.Px3.p2.8.m2.1.2.2.2" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.2.2.2.cmml">τ</mi><mn id="S4.SS4.SSS0.Px3.p2.8.m2.1.2.2.3" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.2.2.3.cmml">1</mn><mrow id="S4.SS4.SSS0.Px3.p2.8.m2.1.1.1.3" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.2.cmml"><mo id="S4.SS4.SSS0.Px3.p2.8.m2.1.1.1.3.1" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.2.cmml">(</mo><mi id="S4.SS4.SSS0.Px3.p2.8.m2.1.1.1.1" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.1.1.1.cmml">u</mi><mo id="S4.SS4.SSS0.Px3.p2.8.m2.1.1.1.3.2" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p2.8.m2.1b"><apply id="S4.SS4.SSS0.Px3.p2.8.m2.1.2.cmml" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.8.m2.1.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.2">superscript</csymbol><apply id="S4.SS4.SSS0.Px3.p2.8.m2.1.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.8.m2.1.2.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.2">subscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.8.m2.1.2.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.2.2.2">𝜏</ci><cn id="S4.SS4.SSS0.Px3.p2.8.m2.1.2.2.3.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.2.2.3">1</cn></apply><ci id="S4.SS4.SSS0.Px3.p2.8.m2.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.8.m2.1.1.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p2.8.m2.1c">\tau_{1}^{(u)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p2.8.m2.1d">italic_τ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT</annotation></semantics></math> has higher cumulative reward than <math alttext="\tau_{2}^{(u)}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p2.9.m3.1"><semantics id="S4.SS4.SSS0.Px3.p2.9.m3.1a"><msubsup id="S4.SS4.SSS0.Px3.p2.9.m3.1.2" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.2.cmml"><mi id="S4.SS4.SSS0.Px3.p2.9.m3.1.2.2.2" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.2.2.2.cmml">τ</mi><mn id="S4.SS4.SSS0.Px3.p2.9.m3.1.2.2.3" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.2.2.3.cmml">2</mn><mrow id="S4.SS4.SSS0.Px3.p2.9.m3.1.1.1.3" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.2.cmml"><mo id="S4.SS4.SSS0.Px3.p2.9.m3.1.1.1.3.1" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.2.cmml">(</mo><mi id="S4.SS4.SSS0.Px3.p2.9.m3.1.1.1.1" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.1.1.1.cmml">u</mi><mo id="S4.SS4.SSS0.Px3.p2.9.m3.1.1.1.3.2" stretchy="false" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p2.9.m3.1b"><apply id="S4.SS4.SSS0.Px3.p2.9.m3.1.2.cmml" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.9.m3.1.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.2">superscript</csymbol><apply id="S4.SS4.SSS0.Px3.p2.9.m3.1.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p2.9.m3.1.2.2.1.cmml" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.2">subscript</csymbol><ci id="S4.SS4.SSS0.Px3.p2.9.m3.1.2.2.2.cmml" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.2.2.2">𝜏</ci><cn id="S4.SS4.SSS0.Px3.p2.9.m3.1.2.2.3.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.2.2.3">2</cn></apply><ci id="S4.SS4.SSS0.Px3.p2.9.m3.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.9.m3.1.1.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p2.9.m3.1c">\tau_{2}^{(u)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p2.9.m3.1d">italic_τ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT</annotation></semantics></math>,
and the denominator sums the likelihood of all the trajectories with higher cumulative reward than the <math alttext="j" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p2.10.m4.1"><semantics id="S4.SS4.SSS0.Px3.p2.10.m4.1a"><mi id="S4.SS4.SSS0.Px3.p2.10.m4.1.1" xref="S4.SS4.SSS0.Px3.p2.10.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p2.10.m4.1b"><ci id="S4.SS4.SSS0.Px3.p2.10.m4.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.10.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p2.10.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p2.10.m4.1d">italic_j</annotation></semantics></math>-th trajectory.
The Q-network is still updated as in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.E6" title='In Q-Network Update ‣ 4.4 Guiding 𝚂⁢"-agent" with 𝚂⁢"-planner" ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search'><span class="ltx_text ltx_ref_tag">6</span></a> except that the sampled experiences come from all the trajectories instead of only the highest-rewarded trajectories. <span class="ltx_text" id="S4.SS4.SSS0.Px3.p2.11.1"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p2.11.1.m1.1"><semantics id="S4.SS4.SSS0.Px3.p2.11.1.m1.1a"><mrow id="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1" xref="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.2" xref="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.1" xref="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.3" xref="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p2.11.1.m1.1b"><apply id="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1"><times id="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.1"></times><ci id="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.2.cmml" xref="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.3a.cmml" xref="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.3"><mtext id="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.3.cmml" xref="S4.SS4.SSS0.Px3.p2.11.1.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p2.11.1.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p2.11.1.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> only performs slightly worse than <span class="ltx_ERROR undefined" id="S4.SS4.SSS0.Px3.p2.11.2">\method</span>and much better than baselines (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S6.SS1" title="6.1 Overall Performance Comparison ‣ 6 Experimental Results ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">6.1</span></a>), and can be viewed as a good trade-off between efficiency and performance.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.42" style="width:494.6pt;height:234pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.42.42">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.42.42.43.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T1.42.42.43.1.1" rowspan="2" style="padding:-1pt 3.0pt;"><span class="ltx_text" id="S4.T1.42.42.43.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.42.42.43.1.1.1.1">Models</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T1.42.42.43.1.2" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.42.42.43.1.2.1">Yelp</span></td>
<td class="ltx_td ltx_border_tt" id="S4.T1.42.42.43.1.3" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T1.42.42.43.1.4" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.42.42.43.1.4.1">LastFM</span></td>
<td class="ltx_td ltx_border_tt" id="S4.T1.42.42.43.1.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T1.42.42.43.1.6" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.42.42.43.1.6.1">Amazon-Book</span></td>
<td class="ltx_td ltx_border_tt" id="S4.T1.42.42.43.1.7" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T1.42.42.43.1.8" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.42.42.43.1.8.1">MovieLens</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.12.12">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1" style="padding:-1pt 3.0pt;">SR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.2.2" style="padding:-1pt 3.0pt;">AT<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.2.2.2.2.m1.1"><semantics id="S4.T1.2.2.2.2.m1.1a"><mo id="S4.T1.2.2.2.2.m1.1.1" stretchy="false" xref="S4.T1.2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.m1.1b"><ci id="S4.T1.2.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.2.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.3.3.3.3" style="padding:-1pt 3.0pt;">hDCG<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.3.3.3.3.m1.1"><semantics id="S4.T1.3.3.3.3.m1.1a"><mo id="S4.T1.3.3.3.3.m1.1.1" stretchy="false" xref="S4.T1.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.3.m1.1b"><ci id="S4.T1.3.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td" id="S4.T1.12.12.12.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.4.4.4" style="padding:-1pt 3.0pt;">SR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.4.4.4.4.m1.1"><semantics id="S4.T1.4.4.4.4.m1.1a"><mo id="S4.T1.4.4.4.4.m1.1.1" stretchy="false" xref="S4.T1.4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.4.m1.1b"><ci id="S4.T1.4.4.4.4.m1.1.1.cmml" xref="S4.T1.4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.5.5" style="padding:-1pt 3.0pt;">AT<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.5.5.5.5.m1.1"><semantics id="S4.T1.5.5.5.5.m1.1a"><mo id="S4.T1.5.5.5.5.m1.1.1" stretchy="false" xref="S4.T1.5.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.5.m1.1b"><ci id="S4.T1.5.5.5.5.m1.1.1.cmml" xref="S4.T1.5.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.6.6.6.6" style="padding:-1pt 3.0pt;">hDCG<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.6.6.6.6.m1.1"><semantics id="S4.T1.6.6.6.6.m1.1a"><mo id="S4.T1.6.6.6.6.m1.1.1" stretchy="false" xref="S4.T1.6.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.6.m1.1b"><ci id="S4.T1.6.6.6.6.m1.1.1.cmml" xref="S4.T1.6.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td" id="S4.T1.12.12.12.14" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.7.7" style="padding:-1pt 3.0pt;">SR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.7.7.7.7.m1.1"><semantics id="S4.T1.7.7.7.7.m1.1a"><mo id="S4.T1.7.7.7.7.m1.1.1" stretchy="false" xref="S4.T1.7.7.7.7.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.7.m1.1b"><ci id="S4.T1.7.7.7.7.m1.1.1.cmml" xref="S4.T1.7.7.7.7.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.7.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.7.7.7.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.8.8.8.8" style="padding:-1pt 3.0pt;">AT<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.8.8.8.8.m1.1"><semantics id="S4.T1.8.8.8.8.m1.1a"><mo id="S4.T1.8.8.8.8.m1.1.1" stretchy="false" xref="S4.T1.8.8.8.8.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.8.8.m1.1b"><ci id="S4.T1.8.8.8.8.m1.1.1.cmml" xref="S4.T1.8.8.8.8.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.8.8.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.8.8.8.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.9.9.9.9" style="padding:-1pt 3.0pt;">hDCG<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.9.9.9.9.m1.1"><semantics id="S4.T1.9.9.9.9.m1.1a"><mo id="S4.T1.9.9.9.9.m1.1.1" stretchy="false" xref="S4.T1.9.9.9.9.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.9.9.m1.1b"><ci id="S4.T1.9.9.9.9.m1.1.1.cmml" xref="S4.T1.9.9.9.9.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.9.9.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.9.9.9.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td" id="S4.T1.12.12.12.15" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.10.10.10.10" style="padding:-1pt 3.0pt;">SR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.10.10.10.10.m1.1"><semantics id="S4.T1.10.10.10.10.m1.1a"><mo id="S4.T1.10.10.10.10.m1.1.1" stretchy="false" xref="S4.T1.10.10.10.10.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.10.10.10.10.m1.1b"><ci id="S4.T1.10.10.10.10.m1.1.1.cmml" xref="S4.T1.10.10.10.10.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.10.10.10.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.10.10.10.10.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.11.11.11.11" style="padding:-1pt 3.0pt;">AT<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.11.11.11.11.m1.1"><semantics id="S4.T1.11.11.11.11.m1.1a"><mo id="S4.T1.11.11.11.11.m1.1.1" stretchy="false" xref="S4.T1.11.11.11.11.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.11.11.m1.1b"><ci id="S4.T1.11.11.11.11.m1.1.1.cmml" xref="S4.T1.11.11.11.11.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.11.11.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.11.11.11.11.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.12.12.12.12" style="padding:-1pt 3.0pt;">hDCG<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.12.12.12.12.m1.1"><semantics id="S4.T1.12.12.12.12.m1.1a"><mo id="S4.T1.12.12.12.12.m1.1.1" stretchy="false" xref="S4.T1.12.12.12.12.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.12.12.12.12.m1.1b"><ci id="S4.T1.12.12.12.12.m1.1.1.cmml" xref="S4.T1.12.12.12.12.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.12.12.12.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.12.12.12.12.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.13.13.13">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.1" style="padding:-1pt 3.0pt;"><span class="ltx_text" id="S4.T1.13.13.13.1.1"><math alttext="\mathop{\mathtt{Abs{\thinspace\thinspace}Greedy}}\limits" class="ltx_Math" display="inline" id="S4.T1.13.13.13.1.1.m1.1"><semantics id="S4.T1.13.13.13.1.1.m1.1a"><mrow id="S4.T1.13.13.13.1.1.m1.1.1" xref="S4.T1.13.13.13.1.1.m1.1.1.cmml"><mi id="S4.T1.13.13.13.1.1.m1.1.1.2" xref="S4.T1.13.13.13.1.1.m1.1.1.2.cmml">𝙰𝚋𝚜</mi><mo id="S4.T1.13.13.13.1.1.m1.1.1.1" lspace="0.330em" xref="S4.T1.13.13.13.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.T1.13.13.13.1.1.m1.1.1.3" xref="S4.T1.13.13.13.1.1.m1.1.1.3.cmml">𝙶𝚛𝚎𝚎𝚍𝚢</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.13.13.13.1.1.m1.1b"><apply id="S4.T1.13.13.13.1.1.m1.1.1.cmml" xref="S4.T1.13.13.13.1.1.m1.1.1"><times id="S4.T1.13.13.13.1.1.m1.1.1.1.cmml" xref="S4.T1.13.13.13.1.1.m1.1.1.1"></times><ci id="S4.T1.13.13.13.1.1.m1.1.1.2.cmml" xref="S4.T1.13.13.13.1.1.m1.1.1.2">𝙰𝚋𝚜</ci><ci id="S4.T1.13.13.13.1.1.m1.1.1.3.cmml" xref="S4.T1.13.13.13.1.1.m1.1.1.3">𝙶𝚛𝚎𝚎𝚍𝚢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.13.13.1.1.m1.1c">\mathop{\mathtt{Abs{\thinspace\thinspace}Greedy}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.T1.13.13.13.1.1.m1.1d">typewriter_Abs typewriter_Greedy</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.2" style="padding:-1pt 3.0pt;">0.195</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.3" style="padding:-1pt 3.0pt;">14.08</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.4" style="padding:-1pt 3.0pt;">0.069</td>
<td class="ltx_td ltx_border_t" id="S4.T1.13.13.13.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.6" style="padding:-1pt 3.0pt;">0.539</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.7" style="padding:-1pt 3.0pt;">10.92</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.8" style="padding:-1pt 3.0pt;">0.251</td>
<td class="ltx_td ltx_border_t" id="S4.T1.13.13.13.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.10" style="padding:-1pt 3.0pt;">0.214</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.11" style="padding:-1pt 3.0pt;">13.50</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.12" style="padding:-1pt 3.0pt;">0.092</td>
<td class="ltx_td ltx_border_t" id="S4.T1.13.13.13.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.14" style="padding:-1pt 3.0pt;">0.752</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.15" style="padding:-1pt 3.0pt;">4.94</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.13.13.13.16" style="padding:-1pt 3.0pt;">0.481</td>
</tr>
<tr class="ltx_tr" id="S4.T1.14.14.14">
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.1" style="padding:-1pt 3.0pt;"><span class="ltx_text" id="S4.T1.14.14.14.1.1"><math alttext="\mathop{\mathtt{Max{\thinspace\thinspace}Entropy}}\limits" class="ltx_Math" display="inline" id="S4.T1.14.14.14.1.1.m1.1"><semantics id="S4.T1.14.14.14.1.1.m1.1a"><mrow id="S4.T1.14.14.14.1.1.m1.1.1" xref="S4.T1.14.14.14.1.1.m1.1.1.cmml"><mi id="S4.T1.14.14.14.1.1.m1.1.1.2" xref="S4.T1.14.14.14.1.1.m1.1.1.2.cmml">𝙼𝚊𝚡</mi><mo id="S4.T1.14.14.14.1.1.m1.1.1.1" lspace="0.330em" xref="S4.T1.14.14.14.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.T1.14.14.14.1.1.m1.1.1.3" xref="S4.T1.14.14.14.1.1.m1.1.1.3.cmml">𝙴𝚗𝚝𝚛𝚘𝚙𝚢</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.14.14.14.1.1.m1.1b"><apply id="S4.T1.14.14.14.1.1.m1.1.1.cmml" xref="S4.T1.14.14.14.1.1.m1.1.1"><times id="S4.T1.14.14.14.1.1.m1.1.1.1.cmml" xref="S4.T1.14.14.14.1.1.m1.1.1.1"></times><ci id="S4.T1.14.14.14.1.1.m1.1.1.2.cmml" xref="S4.T1.14.14.14.1.1.m1.1.1.2">𝙼𝚊𝚡</ci><ci id="S4.T1.14.14.14.1.1.m1.1.1.3.cmml" xref="S4.T1.14.14.14.1.1.m1.1.1.3">𝙴𝚗𝚝𝚛𝚘𝚙𝚢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.14.14.1.1.m1.1c">\mathop{\mathtt{Max{\thinspace\thinspace}Entropy}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.T1.14.14.14.1.1.m1.1d">typewriter_Max typewriter_Entropy</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.2" style="padding:-1pt 3.0pt;">0.375</td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.3" style="padding:-1pt 3.0pt;">12.57</td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.4" style="padding:-1pt 3.0pt;">0.139</td>
<td class="ltx_td" id="S4.T1.14.14.14.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.6" style="padding:-1pt 3.0pt;">0.640</td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.7" style="padding:-1pt 3.0pt;">9.62</td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.8" style="padding:-1pt 3.0pt;">0.288</td>
<td class="ltx_td" id="S4.T1.14.14.14.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.10" style="padding:-1pt 3.0pt;">0.343</td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.11" style="padding:-1pt 3.0pt;">12.21</td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.12" style="padding:-1pt 3.0pt;">0.125</td>
<td class="ltx_td" id="S4.T1.14.14.14.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.14" style="padding:-1pt 3.0pt;">0.704</td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.15" style="padding:-1pt 3.0pt;">6.93</td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.14.14.16" style="padding:-1pt 3.0pt;">0.448</td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15.15">
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.1" style="padding:-1pt 3.0pt;"><span class="ltx_text" id="S4.T1.15.15.15.1.1"><math alttext="\mathop{\mathtt{CRM}}\limits" class="ltx_Math" display="inline" id="S4.T1.15.15.15.1.1.m1.1"><semantics id="S4.T1.15.15.15.1.1.m1.1a"><mo id="S4.T1.15.15.15.1.1.m1.1.1" movablelimits="false" xref="S4.T1.15.15.15.1.1.m1.1.1.cmml">𝙲𝚁𝙼</mo><annotation-xml encoding="MathML-Content" id="S4.T1.15.15.15.1.1.m1.1b"><ci id="S4.T1.15.15.15.1.1.m1.1.1.cmml" xref="S4.T1.15.15.15.1.1.m1.1.1">𝙲𝚁𝙼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.15.15.1.1.m1.1c">\mathop{\mathtt{CRM}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.T1.15.15.15.1.1.m1.1d">typewriter_CRM</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.2" style="padding:-1pt 3.0pt;">0.223</td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.3" style="padding:-1pt 3.0pt;">13.83</td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.4" style="padding:-1pt 3.0pt;">0.073</td>
<td class="ltx_td" id="S4.T1.15.15.15.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.6" style="padding:-1pt 3.0pt;">0.597</td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.7" style="padding:-1pt 3.0pt;">10.60</td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.8" style="padding:-1pt 3.0pt;">0.269</td>
<td class="ltx_td" id="S4.T1.15.15.15.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.10" style="padding:-1pt 3.0pt;">0.309</td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.11" style="padding:-1pt 3.0pt;">12.47</td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.12" style="padding:-1pt 3.0pt;">0.117</td>
<td class="ltx_td" id="S4.T1.15.15.15.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.14" style="padding:-1pt 3.0pt;">0.654</td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.15" style="padding:-1pt 3.0pt;">7.86</td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.15.16" style="padding:-1pt 3.0pt;">0.413</td>
</tr>
<tr class="ltx_tr" id="S4.T1.16.16.16">
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.1" style="padding:-1pt 3.0pt;"><span class="ltx_text" id="S4.T1.16.16.16.1.1"><math alttext="\mathop{\mathtt{EAR}}\limits" class="ltx_Math" display="inline" id="S4.T1.16.16.16.1.1.m1.1"><semantics id="S4.T1.16.16.16.1.1.m1.1a"><mo id="S4.T1.16.16.16.1.1.m1.1.1" movablelimits="false" xref="S4.T1.16.16.16.1.1.m1.1.1.cmml">𝙴𝙰𝚁</mo><annotation-xml encoding="MathML-Content" id="S4.T1.16.16.16.1.1.m1.1b"><ci id="S4.T1.16.16.16.1.1.m1.1.1.cmml" xref="S4.T1.16.16.16.1.1.m1.1.1">𝙴𝙰𝚁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.16.16.1.1.m1.1c">\mathop{\mathtt{EAR}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.T1.16.16.16.1.1.m1.1d">typewriter_EAR</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.2" style="padding:-1pt 3.0pt;">0.263</td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.3" style="padding:-1pt 3.0pt;">13.79</td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.4" style="padding:-1pt 3.0pt;">0.098</td>
<td class="ltx_td" id="S4.T1.16.16.16.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.6" style="padding:-1pt 3.0pt;">0.612</td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.7" style="padding:-1pt 3.0pt;">9.66</td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.8" style="padding:-1pt 3.0pt;">0.276</td>
<td class="ltx_td" id="S4.T1.16.16.16.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.10" style="padding:-1pt 3.0pt;">0.354</td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.11" style="padding:-1pt 3.0pt;">12.07</td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.12" style="padding:-1pt 3.0pt;">0.132</td>
<td class="ltx_td" id="S4.T1.16.16.16.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.14" style="padding:-1pt 3.0pt;">0.714</td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.15" style="padding:-1pt 3.0pt;">6.53</td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.16.16" style="padding:-1pt 3.0pt;">0.457</td>
</tr>
<tr class="ltx_tr" id="S4.T1.17.17.17">
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.1" style="padding:-1pt 3.0pt;"><span class="ltx_text" id="S4.T1.17.17.17.1.1"><math alttext="\mathop{\mathtt{SCPR}}\limits" class="ltx_Math" display="inline" id="S4.T1.17.17.17.1.1.m1.1"><semantics id="S4.T1.17.17.17.1.1.m1.1a"><mo id="S4.T1.17.17.17.1.1.m1.1.1" movablelimits="false" xref="S4.T1.17.17.17.1.1.m1.1.1.cmml">𝚂𝙲𝙿𝚁</mo><annotation-xml encoding="MathML-Content" id="S4.T1.17.17.17.1.1.m1.1b"><ci id="S4.T1.17.17.17.1.1.m1.1.1.cmml" xref="S4.T1.17.17.17.1.1.m1.1.1">𝚂𝙲𝙿𝚁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.17.17.1.1.m1.1c">\mathop{\mathtt{SCPR}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.T1.17.17.17.1.1.m1.1d">typewriter_SCPR</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.2" style="padding:-1pt 3.0pt;">0.413</td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.3" style="padding:-1pt 3.0pt;">12.45</td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.4" style="padding:-1pt 3.0pt;">0.149</td>
<td class="ltx_td" id="S4.T1.17.17.17.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.6" style="padding:-1pt 3.0pt;">0.751</td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.7" style="padding:-1pt 3.0pt;">8.52</td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.8" style="padding:-1pt 3.0pt;">0.339</td>
<td class="ltx_td" id="S4.T1.17.17.17.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.10" style="padding:-1pt 3.0pt;">0.428</td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.11" style="padding:-1pt 3.0pt;">11.50</td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.12" style="padding:-1pt 3.0pt;">0.159</td>
<td class="ltx_td" id="S4.T1.17.17.17.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.14" style="padding:-1pt 3.0pt;">0.812</td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.15" style="padding:-1pt 3.0pt;">4.03</td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.17.16" style="padding:-1pt 3.0pt;">0.547</td>
</tr>
<tr class="ltx_tr" id="S4.T1.18.18.18">
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.1" style="padding:-1pt 3.0pt;"><span class="ltx_text" id="S4.T1.18.18.18.1.1"><math alttext="\mathop{\mathtt{UNICORN}}\limits" class="ltx_Math" display="inline" id="S4.T1.18.18.18.1.1.m1.1"><semantics id="S4.T1.18.18.18.1.1.m1.1a"><mo id="S4.T1.18.18.18.1.1.m1.1.1" movablelimits="false" xref="S4.T1.18.18.18.1.1.m1.1.1.cmml">𝚄𝙽𝙸𝙲𝙾𝚁𝙽</mo><annotation-xml encoding="MathML-Content" id="S4.T1.18.18.18.1.1.m1.1b"><ci id="S4.T1.18.18.18.1.1.m1.1.1.cmml" xref="S4.T1.18.18.18.1.1.m1.1.1">𝚄𝙽𝙸𝙲𝙾𝚁𝙽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.18.18.18.1.1.m1.1c">\mathop{\mathtt{UNICORN}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.T1.18.18.18.1.1.m1.1d">typewriter_UNICORN</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.2" style="padding:-1pt 3.0pt;">0.438</td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.3" style="padding:-1pt 3.0pt;">12.28</td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.4" style="padding:-1pt 3.0pt;">0.151</td>
<td class="ltx_td" id="S4.T1.18.18.18.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.6" style="padding:-1pt 3.0pt;">0.843</td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.7" style="padding:-1pt 3.0pt;">7.25</td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.8" style="padding:-1pt 3.0pt;">0.363</td>
<td class="ltx_td" id="S4.T1.18.18.18.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.10" style="padding:-1pt 3.0pt;">0.466</td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.11" style="padding:-1pt 3.0pt;">11.24</td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.12" style="padding:-1pt 3.0pt;">0.170</td>
<td class="ltx_td" id="S4.T1.18.18.18.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.14" style="padding:-1pt 3.0pt;">0.836</td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.15" style="padding:-1pt 3.0pt;">3.82</td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.18.18.16" style="padding:-1pt 3.0pt;">0.576</td>
</tr>
<tr class="ltx_tr" id="S4.T1.19.19.19">
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.1" style="padding:-1pt 3.0pt;"><span class="ltx_text" id="S4.T1.19.19.19.1.1"><math alttext="\mathop{\mathtt{MCMIPL}}\limits" class="ltx_Math" display="inline" id="S4.T1.19.19.19.1.1.m1.1"><semantics id="S4.T1.19.19.19.1.1.m1.1a"><mo id="S4.T1.19.19.19.1.1.m1.1.1" movablelimits="false" xref="S4.T1.19.19.19.1.1.m1.1.1.cmml">𝙼𝙲𝙼𝙸𝙿𝙻</mo><annotation-xml encoding="MathML-Content" id="S4.T1.19.19.19.1.1.m1.1b"><ci id="S4.T1.19.19.19.1.1.m1.1.1.cmml" xref="S4.T1.19.19.19.1.1.m1.1.1">𝙼𝙲𝙼𝙸𝙿𝙻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.19.19.19.1.1.m1.1c">\mathop{\mathtt{MCMIPL}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.T1.19.19.19.1.1.m1.1d">typewriter_MCMIPL</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.2" style="padding:-1pt 3.0pt;">0.482</td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.3" style="padding:-1pt 3.0pt;">11.87</td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.4" style="padding:-1pt 3.0pt;">0.160</td>
<td class="ltx_td" id="S4.T1.19.19.19.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.6" style="padding:-1pt 3.0pt;">0.874</td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.7" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.19.19.19.7.1">6.35</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.8" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.19.19.19.8.1">0.396</span></td>
<td class="ltx_td" id="S4.T1.19.19.19.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.10" style="padding:-1pt 3.0pt;">0.545</td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.11" style="padding:-1pt 3.0pt;">10.83</td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.12" style="padding:-1pt 3.0pt;">0.223</td>
<td class="ltx_td" id="S4.T1.19.19.19.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.14" style="padding:-1pt 3.0pt;">0.882</td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.15" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.19.19.19.15.1">3.61</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.19.16" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.19.19.19.16.1">0.599</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.20.20.20">
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.1" style="padding:-1pt 3.0pt;"><span class="ltx_text" id="S4.T1.20.20.20.1.1"><math alttext="\mathop{\mathtt{HutCRS}}\limits" class="ltx_Math" display="inline" id="S4.T1.20.20.20.1.1.m1.1"><semantics id="S4.T1.20.20.20.1.1.m1.1a"><mo id="S4.T1.20.20.20.1.1.m1.1.1" movablelimits="false" xref="S4.T1.20.20.20.1.1.m1.1.1.cmml">𝙷𝚞𝚝𝙲𝚁𝚂</mo><annotation-xml encoding="MathML-Content" id="S4.T1.20.20.20.1.1.m1.1b"><ci id="S4.T1.20.20.20.1.1.m1.1.1.cmml" xref="S4.T1.20.20.20.1.1.m1.1.1">𝙷𝚞𝚝𝙲𝚁𝚂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.20.20.20.1.1.m1.1c">\mathop{\mathtt{HutCRS}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.T1.20.20.20.1.1.m1.1d">typewriter_HutCRS</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.2" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.20.20.20.2.1">0.528</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.3" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.20.20.20.3.1">11.33</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.4" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.20.20.20.4.1">0.175</span></td>
<td class="ltx_td" id="S4.T1.20.20.20.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.6" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.20.20.20.6.1">0.900</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.7" style="padding:-1pt 3.0pt;">6.52</td>
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.8" style="padding:-1pt 3.0pt;">0.348</td>
<td class="ltx_td" id="S4.T1.20.20.20.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.10" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.20.20.20.10.1">0.638</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.11" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.20.20.20.11.1">9.84</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.12" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.20.20.20.12.1">0.227</span></td>
<td class="ltx_td" id="S4.T1.20.20.20.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.14" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.20.20.20.14.1">0.902</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.15" style="padding:-1pt 3.0pt;">4.16</td>
<td class="ltx_td ltx_align_left" id="S4.T1.20.20.20.16" style="padding:-1pt 3.0pt;">0.475</td>
</tr>
<tr class="ltx_tr" id="S4.T1.21.21.21">
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.1" style="padding:-1pt 3.0pt;"><span class="ltx_text" id="S4.T1.21.21.21.1.1"><math alttext="\mathop{\mathtt{CORE}}\limits" class="ltx_Math" display="inline" id="S4.T1.21.21.21.1.1.m1.1"><semantics id="S4.T1.21.21.21.1.1.m1.1a"><mo id="S4.T1.21.21.21.1.1.m1.1.1" movablelimits="false" xref="S4.T1.21.21.21.1.1.m1.1.1.cmml">𝙲𝙾𝚁𝙴</mo><annotation-xml encoding="MathML-Content" id="S4.T1.21.21.21.1.1.m1.1b"><ci id="S4.T1.21.21.21.1.1.m1.1.1.cmml" xref="S4.T1.21.21.21.1.1.m1.1.1">𝙲𝙾𝚁𝙴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.21.21.21.1.1.m1.1c">\mathop{\mathtt{CORE}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.T1.21.21.21.1.1.m1.1d">typewriter_CORE</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.2" style="padding:-1pt 3.0pt;">0.210</td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.3" style="padding:-1pt 3.0pt;">12.82</td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.4" style="padding:-1pt 3.0pt;">0.166</td>
<td class="ltx_td" id="S4.T1.21.21.21.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.6" style="padding:-1pt 3.0pt;">0.862</td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.7" style="padding:-1pt 3.0pt;">7.05</td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.8" style="padding:-1pt 3.0pt;">0.356</td>
<td class="ltx_td" id="S4.T1.21.21.21.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.10" style="padding:-1pt 3.0pt;">0.462</td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.11" style="padding:-1pt 3.0pt;">11.49</td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.12" style="padding:-1pt 3.0pt;">0.182</td>
<td class="ltx_td" id="S4.T1.21.21.21.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.14" style="padding:-1pt 3.0pt;">0.810</td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.15" style="padding:-1pt 3.0pt;">6.51</td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.21.16" style="padding:-1pt 3.0pt;">0.429</td>
</tr>
<tr class="ltx_tr" id="S4.T1.31.31.31">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.22.22.22.1" style="padding:-1pt 3.0pt;"><span class="ltx_text" id="S4.T1.22.22.22.1.1"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S4.T1.22.22.22.1.1.m1.1"><semantics id="S4.T1.22.22.22.1.1.m1.1a"><mrow id="S4.T1.22.22.22.1.1.m1.1.1" xref="S4.T1.22.22.22.1.1.m1.1.1.cmml"><mi id="S4.T1.22.22.22.1.1.m1.1.1.2" xref="S4.T1.22.22.22.1.1.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S4.T1.22.22.22.1.1.m1.1.1.1" xref="S4.T1.22.22.22.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.T1.22.22.22.1.1.m1.1.1.3" xref="S4.T1.22.22.22.1.1.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.22.22.22.1.1.m1.1b"><apply id="S4.T1.22.22.22.1.1.m1.1.1.cmml" xref="S4.T1.22.22.22.1.1.m1.1.1"><times id="S4.T1.22.22.22.1.1.m1.1.1.1.cmml" xref="S4.T1.22.22.22.1.1.m1.1.1.1"></times><ci id="S4.T1.22.22.22.1.1.m1.1.1.2.cmml" xref="S4.T1.22.22.22.1.1.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S4.T1.22.22.22.1.1.m1.1.1.3a.cmml" xref="S4.T1.22.22.22.1.1.m1.1.1.3"><mtext id="S4.T1.22.22.22.1.1.m1.1.1.3.cmml" xref="S4.T1.22.22.22.1.1.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.22.22.22.1.1.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S4.T1.22.22.22.1.1.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.23.23.23.2" style="padding:-1pt 3.0pt;">0.612<sup class="ltx_sup" id="S4.T1.23.23.23.2.1"><span class="ltx_text ltx_font_italic" id="S4.T1.23.23.23.2.1.1">∗</span></sup>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.24.24.24.3" style="padding:-1pt 3.0pt;">10.41<sup class="ltx_sup" id="S4.T1.24.24.24.3.1"><span class="ltx_text ltx_font_italic" id="S4.T1.24.24.24.3.1.1">∗</span></sup>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.25.25.25.4" style="padding:-1pt 3.0pt;">0.208<sup class="ltx_sup" id="S4.T1.25.25.25.4.1"><span class="ltx_text ltx_font_italic" id="S4.T1.25.25.25.4.1.1">∗</span></sup>
</td>
<td class="ltx_td ltx_border_t" id="S4.T1.31.31.31.11" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.26.26.26.5" style="padding:-1pt 3.0pt;">0.922<sup class="ltx_sup" id="S4.T1.26.26.26.5.1"><span class="ltx_text ltx_font_italic" id="S4.T1.26.26.26.5.1.1">∗</span></sup>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.31.31.31.12" style="padding:-1pt 3.0pt;">6.32</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.31.31.31.13" style="padding:-1pt 3.0pt;">0.358</td>
<td class="ltx_td ltx_border_t" id="S4.T1.31.31.31.14" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.27.27.27.6" style="padding:-1pt 3.0pt;">0.682<sup class="ltx_sup" id="S4.T1.27.27.27.6.1"><span class="ltx_text ltx_font_italic" id="S4.T1.27.27.27.6.1.1">∗</span></sup>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.28.28.28.7" style="padding:-1pt 3.0pt;">9.51<sup class="ltx_sup" id="S4.T1.28.28.28.7.1"><span class="ltx_text ltx_font_italic" id="S4.T1.28.28.28.7.1.1">∗</span></sup>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.29.29.29.8" style="padding:-1pt 3.0pt;">0.239<sup class="ltx_sup" id="S4.T1.29.29.29.8.1"><span class="ltx_text ltx_font_italic" id="S4.T1.29.29.29.8.1.1">∗</span></sup>
</td>
<td class="ltx_td ltx_border_t" id="S4.T1.31.31.31.15" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.30.30.30.9" style="padding:-1pt 3.0pt;">0.928<sup class="ltx_sup" id="S4.T1.30.30.30.9.1"><span class="ltx_text ltx_font_italic" id="S4.T1.30.30.30.9.1.1">∗</span></sup>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.31.31.31.16" style="padding:-1pt 3.0pt;">3.76</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.31.31.31.10" style="padding:-1pt 3.0pt;">0.607<sup class="ltx_sup" id="S4.T1.31.31.31.10.1"><span class="ltx_text ltx_font_italic" id="S4.T1.31.31.31.10.1.1">∗</span></sup>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.42.42.42">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.42.42.42.12" style="padding:-1pt 3.0pt;"><span class="ltx_ERROR undefined" id="S4.T1.42.42.42.12.1">\method</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.32.32.32.1" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.32.32.32.1.1">0.622<sup class="ltx_sup" id="S4.T1.32.32.32.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.32.32.32.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.33.33.33.2" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.33.33.33.2.1">10.02<sup class="ltx_sup" id="S4.T1.33.33.33.2.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.33.33.33.2.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.34.34.34.3" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.34.34.34.3.1">0.229<sup class="ltx_sup" id="S4.T1.34.34.34.3.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.34.34.34.3.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_border_bb" id="S4.T1.42.42.42.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.35.35.35.4" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.35.35.35.4.1">0.928<sup class="ltx_sup" id="S4.T1.35.35.35.4.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.35.35.35.4.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.36.36.36.5" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.36.36.36.5.1">6.15<sup class="ltx_sup" id="S4.T1.36.36.36.5.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.36.36.36.5.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.42.42.42.14" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.42.42.42.14.1">0.398</span></td>
<td class="ltx_td ltx_border_bb" id="S4.T1.42.42.42.15" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.37.37.37.6" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.37.37.37.6.1">0.718<sup class="ltx_sup" id="S4.T1.37.37.37.6.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.37.37.37.6.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.38.38.38.7" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.38.38.38.7.1">9.28<sup class="ltx_sup" id="S4.T1.38.38.38.7.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.38.38.38.7.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.39.39.39.8" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.39.39.39.8.1">0.252<sup class="ltx_sup" id="S4.T1.39.39.39.8.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.39.39.39.8.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_border_bb" id="S4.T1.42.42.42.16" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.40.40.40.9" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.40.40.40.9.1">0.930<sup class="ltx_sup" id="S4.T1.40.40.40.9.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.40.40.40.9.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.41.41.41.10" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.41.41.41.10.1">3.48<sup class="ltx_sup" id="S4.T1.41.41.41.10.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.41.41.41.10.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.42.42.42.11" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.42.42.42.11.1">0.610<sup class="ltx_sup" id="S4.T1.42.42.42.11.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.42.42.42.11.1.1.1">∗</span></sup></span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Performances on benchmark datasets. The best performance of our method and the best baseline in each column is in bold and underlined respectively.
<math alttext="*" class="ltx_Math" display="inline" id="S4.T1.45.m1.1"><semantics id="S4.T1.45.m1.1b"><mo id="S4.T1.45.m1.1.1" xref="S4.T1.45.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S4.T1.45.m1.1c"><times id="S4.T1.45.m1.1.1.cmml" xref="S4.T1.45.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.45.m1.1d">*</annotation><annotation encoding="application/x-llamapun" id="S4.T1.45.m1.1e">∗</annotation></semantics></math> indicates the improvement is statistically significant (<math alttext="p&lt;0.01" class="ltx_Math" display="inline" id="S4.T1.46.m2.1"><semantics id="S4.T1.46.m2.1b"><mrow id="S4.T1.46.m2.1.1" xref="S4.T1.46.m2.1.1.cmml"><mi id="S4.T1.46.m2.1.1.2" xref="S4.T1.46.m2.1.1.2.cmml">p</mi><mo id="S4.T1.46.m2.1.1.1" xref="S4.T1.46.m2.1.1.1.cmml">&lt;</mo><mn id="S4.T1.46.m2.1.1.3" xref="S4.T1.46.m2.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.46.m2.1c"><apply id="S4.T1.46.m2.1.1.cmml" xref="S4.T1.46.m2.1.1"><lt id="S4.T1.46.m2.1.1.1.cmml" xref="S4.T1.46.m2.1.1.1"></lt><ci id="S4.T1.46.m2.1.1.2.cmml" xref="S4.T1.46.m2.1.1.2">𝑝</ci><cn id="S4.T1.46.m2.1.1.3.cmml" type="float" xref="S4.T1.46.m2.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.46.m2.1d">p&lt;0.01</annotation><annotation encoding="application/x-llamapun" id="S4.T1.46.m2.1e">italic_p &lt; 0.01</annotation></semantics></math>).</figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experimental Settings</h2>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Datasets</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px1.p1.1">We evaluate <span class="ltx_ERROR undefined" id="S5.SS0.SSS0.Px1.p1.1.1">\method</span>on 4 benchmark datasets: Yelp <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite>, LastFM <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite>, Amazon-Book <cite class="ltx_cite ltx_citemacro_cite">McAuley et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib31" title="">2015</a>)</cite> and MovieLens <cite class="ltx_cite ltx_citemacro_cite">Harper and Konstan (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib15" title="">2015</a>)</cite>. Dataset details are available in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS1" title="F.1 Dataset Details and Statistics ‣ Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">F.1</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">User Simulator</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px2.p1.1">Training and evaluating CRS with real-world user interactions can be impractically expensive at scale. To address this issue, we adopt the user simulator approach <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite> and simulate a conversation for each user as detailed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS2" title="F.2 Details of the User Simulator ‣ Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">F.2</span></a>.
Note that this user simulator is widely adopted in the literature <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>); Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>); Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib51" title="">2023</a>); Qian et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib36" title="">2023</a>)</cite> and studies show the simulations are of high quality and suitable for evaluation purposes <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib26" title="">2020a</a>); Zhang and Balog (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib49" title="">2020</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>)</cite>, allowing for large-scale evaluations at a relatively low cost.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Evaluation Metrics</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px3.p1.1">Following the literature <cite class="ltx_cite ltx_citemacro_cite">Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>)</cite>, the
Success Rate (SR) is adopted to measure the ratio of successful recommendations within <math alttext="T_{\text{max}}" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px3.p1.1.m1.1"><semantics id="S5.SS0.SSS0.Px3.p1.1.m1.1a"><msub id="S5.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S5.SS0.SSS0.Px3.p1.1.m1.1.1.2" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml">T</mi><mtext id="S5.SS0.SSS0.Px3.p1.1.m1.1.1.3" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.1.m1.1b"><apply id="S5.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1.2">𝑇</ci><ci id="S5.SS0.SSS0.Px3.p1.1.m1.1.1.3a.cmml" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1.3"><mtext id="S5.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.1.m1.1c">T_{\text{max}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px3.p1.1.m1.1d">italic_T start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math> turns; Average Turn (AT) to evaluate the average number of conversational turns; and hDCG <cite class="ltx_cite ltx_citemacro_cite">Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>)</cite> to evaluate the ranking order of the ground-truth item among the list of all the recommended items.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Baselines and Implementation Details</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px4.p1.1">We choose 9 state-of-the-art baselines for a comprehensive evaluation, including a Large Language Model (LLM)-powered baseline CORE <cite class="ltx_cite ltx_citemacro_cite">Jin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib20" title="">2023</a>)</cite>.
Baseline details are in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS4" title="F.4 Details of Baseline Methods ‣ Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">F.4</span></a>. Implementation details of <span class="ltx_ERROR undefined" id="S5.SS0.SSS0.Px4.p1.1.1">\method</span>are in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS5" title="F.5 Implementation Details ‣ Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">F.5</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experimental Results</h2>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Overall Performance Comparison</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">We compare <span class="ltx_ERROR undefined" id="S6.SS1.p1.1.1">\method</span>with 9 state-of-the-art baselines and report the experimental results in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S4.T1" title='Table 1 ‣ Improving Training Efficiency ‣ 4.4 Guiding 𝚂⁢"-agent" with 𝚂⁢"-planner" ‣ 4 Method ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search'><span class="ltx_text ltx_ref_tag">1</span></a>. We have the following observations:</p>
</div>
<div class="ltx_para" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.p2.1.1">(1)</span> <span class="ltx_ERROR undefined" id="S6.SS1.p2.1.2">\method</span><span class="ltx_text ltx_font_bold ltx_font_italic" id="S6.SS1.p2.1.3">achieves consistent improvement over baselines in terms of all metrics on all the datasets, with an average improvement of 9.1% (SR), 6.0% (AT) and 11.1% (hDCG) compared with the best baseline.</span> Different from baselines, which base their planning solely on the observation of current state without looking ahead, <span class="ltx_ERROR undefined" id="S6.SS1.p2.1.4">\method</span>foresees how the future conversation unfolds with an MCTS-based planning algorithm. This enables <span class="ltx_ERROR undefined" id="S6.SS1.p2.1.5">\method</span>to take actions that maximize the cumulative rewards instead of settling for the immediate reward, enabling strategic, non-myopic conversational planning and superior performances.</p>
</div>
<div class="ltx_para" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.p3.1.2">(2)</span> <span class="ltx_ERROR undefined" id="S6.SS1.p3.1.3">\method</span><span class="ltx_text ltx_font_bold ltx_font_italic" id="S6.SS1.p3.1.4">substantially outperforms baselines in datasets demanding strong strategic planning capability from the CRS.</span> The performance gain of <span class="ltx_ERROR undefined" id="S6.SS1.p3.1.5">\method</span>is higher on datasets with a larger AT (Yelp and Amazon-Book) compared to datasets with a smaller AT (LastFM and MovieLens), and higher AT in these datasets indicates the need for more strategic planning over long conversational turns. Compared with baselines, <span class="ltx_ERROR undefined" id="S6.SS1.p3.1.6">\method</span>is equipped with <span class="ltx_text" id="S6.SS1.p3.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S6.SS1.p3.1.1.m1.1"><semantics id="S6.SS1.p3.1.1.m1.1a"><mrow id="S6.SS1.p3.1.1.m1.1.1" xref="S6.SS1.p3.1.1.m1.1.1.cmml"><mi id="S6.SS1.p3.1.1.m1.1.1.2" xref="S6.SS1.p3.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S6.SS1.p3.1.1.m1.1.1.1" xref="S6.SS1.p3.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S6.SS1.p3.1.1.m1.1.1.3" xref="S6.SS1.p3.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.1.1.m1.1b"><apply id="S6.SS1.p3.1.1.m1.1.1.cmml" xref="S6.SS1.p3.1.1.m1.1.1"><times id="S6.SS1.p3.1.1.m1.1.1.1.cmml" xref="S6.SS1.p3.1.1.m1.1.1.1"></times><ci id="S6.SS1.p3.1.1.m1.1.1.2.cmml" xref="S6.SS1.p3.1.1.m1.1.1.2">𝚂</ci><ci id="S6.SS1.p3.1.1.m1.1.1.3a.cmml" xref="S6.SS1.p3.1.1.m1.1.1.3"><mtext id="S6.SS1.p3.1.1.m1.1.1.3.cmml" xref="S6.SS1.p3.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p3.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> and excels in conversational planning, hence showing remarkable improvements on these two datasets.</p>
</div>
<div class="ltx_para" id="S6.SS1.p4">
<p class="ltx_p" id="S6.SS1.p4.4"><span class="ltx_text ltx_font_bold" id="S6.SS1.p4.4.5">(3)</span> <span class="ltx_text ltx_font_bold ltx_font_italic" id="S6.SS1.p4.1.1"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S6.SS1.p4.1.1.m1.1"><semantics id="S6.SS1.p4.1.1.m1.1a"><mrow id="S6.SS1.p4.1.1.m1.1.1" xref="S6.SS1.p4.1.1.m1.1.1.cmml"><mi id="S6.SS1.p4.1.1.m1.1.1.2" xref="S6.SS1.p4.1.1.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S6.SS1.p4.1.1.m1.1.1.1" xref="S6.SS1.p4.1.1.m1.1.1.1.cmml">⁢</mo><mtext class="ltx_mathvariant_bold-italic" id="S6.SS1.p4.1.1.m1.1.1.3" xref="S6.SS1.p4.1.1.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.1.1.m1.1b"><apply id="S6.SS1.p4.1.1.m1.1.1.cmml" xref="S6.SS1.p4.1.1.m1.1.1"><times id="S6.SS1.p4.1.1.m1.1.1.1.cmml" xref="S6.SS1.p4.1.1.m1.1.1.1"></times><ci id="S6.SS1.p4.1.1.m1.1.1.2.cmml" xref="S6.SS1.p4.1.1.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S6.SS1.p4.1.1.m1.1.1.3a.cmml" xref="S6.SS1.p4.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold-italic" id="S6.SS1.p4.1.1.m1.1.1.3.cmml" xref="S6.SS1.p4.1.1.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.1.1.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.1.1.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span><span class="ltx_text ltx_font_bold ltx_font_italic" id="S6.SS1.p4.4.6"> outperforms all baselines on recommendation success rate.</span> Although the training data for <span class="ltx_text" id="S6.SS1.p4.2.2"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S6.SS1.p4.2.2.m1.1"><semantics id="S6.SS1.p4.2.2.m1.1a"><mrow id="S6.SS1.p4.2.2.m1.1.1" xref="S6.SS1.p4.2.2.m1.1.1.cmml"><mi id="S6.SS1.p4.2.2.m1.1.1.2" xref="S6.SS1.p4.2.2.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S6.SS1.p4.2.2.m1.1.1.1" xref="S6.SS1.p4.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S6.SS1.p4.2.2.m1.1.1.3" xref="S6.SS1.p4.2.2.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.2.2.m1.1b"><apply id="S6.SS1.p4.2.2.m1.1.1.cmml" xref="S6.SS1.p4.2.2.m1.1.1"><times id="S6.SS1.p4.2.2.m1.1.1.1.cmml" xref="S6.SS1.p4.2.2.m1.1.1.1"></times><ci id="S6.SS1.p4.2.2.m1.1.1.2.cmml" xref="S6.SS1.p4.2.2.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S6.SS1.p4.2.2.m1.1.1.3a.cmml" xref="S6.SS1.p4.2.2.m1.1.1.3"><mtext id="S6.SS1.p4.2.2.m1.1.1.3.cmml" xref="S6.SS1.p4.2.2.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.2.2.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.2.2.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> still contain a portion of low-quality trajectories, <span class="ltx_text" id="S6.SS1.p4.3.3"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S6.SS1.p4.3.3.m1.1"><semantics id="S6.SS1.p4.3.3.m1.1a"><mrow id="S6.SS1.p4.3.3.m1.1.1" xref="S6.SS1.p4.3.3.m1.1.1.cmml"><mi id="S6.SS1.p4.3.3.m1.1.1.2" xref="S6.SS1.p4.3.3.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S6.SS1.p4.3.3.m1.1.1.1" xref="S6.SS1.p4.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="S6.SS1.p4.3.3.m1.1.1.3" xref="S6.SS1.p4.3.3.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.3.3.m1.1b"><apply id="S6.SS1.p4.3.3.m1.1.1.cmml" xref="S6.SS1.p4.3.3.m1.1.1"><times id="S6.SS1.p4.3.3.m1.1.1.1.cmml" xref="S6.SS1.p4.3.3.m1.1.1.1"></times><ci id="S6.SS1.p4.3.3.m1.1.1.2.cmml" xref="S6.SS1.p4.3.3.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S6.SS1.p4.3.3.m1.1.1.3a.cmml" xref="S6.SS1.p4.3.3.m1.1.1.3"><mtext id="S6.SS1.p4.3.3.m1.1.1.3.cmml" xref="S6.SS1.p4.3.3.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.3.3.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.3.3.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> still significantly outperforms the best baselines across most metrics, indicating that <span class="ltx_text" id="S6.SS1.p4.4.4"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S6.SS1.p4.4.4.m1.1"><semantics id="S6.SS1.p4.4.4.m1.1a"><mrow id="S6.SS1.p4.4.4.m1.1.1" xref="S6.SS1.p4.4.4.m1.1.1.cmml"><mi id="S6.SS1.p4.4.4.m1.1.1.2" xref="S6.SS1.p4.4.4.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S6.SS1.p4.4.4.m1.1.1.1" xref="S6.SS1.p4.4.4.m1.1.1.1.cmml">⁢</mo><mtext id="S6.SS1.p4.4.4.m1.1.1.3" xref="S6.SS1.p4.4.4.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.4.4.m1.1b"><apply id="S6.SS1.p4.4.4.m1.1.1.cmml" xref="S6.SS1.p4.4.4.m1.1.1"><times id="S6.SS1.p4.4.4.m1.1.1.1.cmml" xref="S6.SS1.p4.4.4.m1.1.1.1"></times><ci id="S6.SS1.p4.4.4.m1.1.1.2.cmml" xref="S6.SS1.p4.4.4.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S6.SS1.p4.4.4.m1.1.1.3a.cmml" xref="S6.SS1.p4.4.4.m1.1.1.3"><mtext id="S6.SS1.p4.4.4.m1.1.1.3.cmml" xref="S6.SS1.p4.4.4.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.4.4.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.4.4.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> is a good trade-off between efficiency and performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Efficiency Analysis</h3>
<figure class="ltx_table" id="S6.T2">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S6.T2.16">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T2.16.17.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S6.T2.16.17.1.1" rowspan="2" style="padding:-1pt 3.0pt;"><span class="ltx_text" id="S6.T2.16.17.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T2.16.17.1.1.1.1">Models</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S6.T2.16.17.1.2" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.17.1.2.1">Yelp</span></td>
<td class="ltx_td ltx_border_tt" id="S6.T2.16.17.1.3" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S6.T2.16.17.1.4" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.17.1.4.1">LastFM</span></td>
<td class="ltx_td ltx_border_tt" id="S6.T2.16.17.1.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S6.T2.16.17.1.6" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.17.1.6.1">Amazon-Book</span></td>
<td class="ltx_td ltx_border_tt" id="S6.T2.16.17.1.7" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S6.T2.16.17.1.8" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.17.1.8.1">MovieLens</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.12.12">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.1.1" style="padding:-1pt 3.0pt;">SR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.1.1.1.m1.1"><semantics id="S6.T2.1.1.1.m1.1a"><mo id="S6.T2.1.1.1.m1.1.1" stretchy="false" xref="S6.T2.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T2.1.1.1.m1.1b"><ci id="S6.T2.1.1.1.m1.1.1.cmml" xref="S6.T2.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.2.2.2" style="padding:-1pt 3.0pt;">AT<math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T2.2.2.2.m1.1"><semantics id="S6.T2.2.2.2.m1.1a"><mo id="S6.T2.2.2.2.m1.1.1" stretchy="false" xref="S6.T2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T2.2.2.2.m1.1b"><ci id="S6.T2.2.2.2.m1.1.1.cmml" xref="S6.T2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.2.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.2.2.2.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.3.3.3" style="padding:-1pt 3.0pt;">hDCG<math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.3.3.3.m1.1"><semantics id="S6.T2.3.3.3.m1.1a"><mo id="S6.T2.3.3.3.m1.1.1" stretchy="false" xref="S6.T2.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T2.3.3.3.m1.1b"><ci id="S6.T2.3.3.3.m1.1.1.cmml" xref="S6.T2.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td" id="S6.T2.12.12.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.4.4.4" style="padding:-1pt 3.0pt;">SR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.4.4.4.m1.1"><semantics id="S6.T2.4.4.4.m1.1a"><mo id="S6.T2.4.4.4.m1.1.1" stretchy="false" xref="S6.T2.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T2.4.4.4.m1.1b"><ci id="S6.T2.4.4.4.m1.1.1.cmml" xref="S6.T2.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.5.5.5" style="padding:-1pt 3.0pt;">AT<math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T2.5.5.5.m1.1"><semantics id="S6.T2.5.5.5.m1.1a"><mo id="S6.T2.5.5.5.m1.1.1" stretchy="false" xref="S6.T2.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T2.5.5.5.m1.1b"><ci id="S6.T2.5.5.5.m1.1.1.cmml" xref="S6.T2.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.6.6.6" style="padding:-1pt 3.0pt;">hDCG<math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.6.6.6.m1.1"><semantics id="S6.T2.6.6.6.m1.1a"><mo id="S6.T2.6.6.6.m1.1.1" stretchy="false" xref="S6.T2.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T2.6.6.6.m1.1b"><ci id="S6.T2.6.6.6.m1.1.1.cmml" xref="S6.T2.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td" id="S6.T2.12.12.14" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.7.7.7" style="padding:-1pt 3.0pt;">SR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.7.7.7.m1.1"><semantics id="S6.T2.7.7.7.m1.1a"><mo id="S6.T2.7.7.7.m1.1.1" stretchy="false" xref="S6.T2.7.7.7.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T2.7.7.7.m1.1b"><ci id="S6.T2.7.7.7.m1.1.1.cmml" xref="S6.T2.7.7.7.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.7.7.7.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.7.7.7.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.8.8.8" style="padding:-1pt 3.0pt;">AT<math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T2.8.8.8.m1.1"><semantics id="S6.T2.8.8.8.m1.1a"><mo id="S6.T2.8.8.8.m1.1.1" stretchy="false" xref="S6.T2.8.8.8.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T2.8.8.8.m1.1b"><ci id="S6.T2.8.8.8.m1.1.1.cmml" xref="S6.T2.8.8.8.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.8.8.8.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.8.8.8.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.9.9.9" style="padding:-1pt 3.0pt;">hDCG<math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.9.9.9.m1.1"><semantics id="S6.T2.9.9.9.m1.1a"><mo id="S6.T2.9.9.9.m1.1.1" stretchy="false" xref="S6.T2.9.9.9.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T2.9.9.9.m1.1b"><ci id="S6.T2.9.9.9.m1.1.1.cmml" xref="S6.T2.9.9.9.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.9.9.9.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.9.9.9.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td" id="S6.T2.12.12.15" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.10.10.10" style="padding:-1pt 3.0pt;">SR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.10.10.10.m1.1"><semantics id="S6.T2.10.10.10.m1.1a"><mo id="S6.T2.10.10.10.m1.1.1" stretchy="false" xref="S6.T2.10.10.10.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T2.10.10.10.m1.1b"><ci id="S6.T2.10.10.10.m1.1.1.cmml" xref="S6.T2.10.10.10.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.10.10.10.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.10.10.10.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.11.11.11" style="padding:-1pt 3.0pt;">AT<math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T2.11.11.11.m1.1"><semantics id="S6.T2.11.11.11.m1.1a"><mo id="S6.T2.11.11.11.m1.1.1" stretchy="false" xref="S6.T2.11.11.11.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T2.11.11.11.m1.1b"><ci id="S6.T2.11.11.11.m1.1.1.cmml" xref="S6.T2.11.11.11.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.11.11.11.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.11.11.11.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.12.12.12" style="padding:-1pt 3.0pt;">hDCG<math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.12.12.12.m1.1"><semantics id="S6.T2.12.12.12.m1.1a"><mo id="S6.T2.12.12.12.m1.1.1" stretchy="false" xref="S6.T2.12.12.12.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T2.12.12.12.m1.1b"><ci id="S6.T2.12.12.12.m1.1.1.cmml" xref="S6.T2.12.12.12.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.12.12.12.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.12.12.12.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S6.T2.16.18.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.1" style="padding:-1pt 3.0pt;"><span class="ltx_ERROR undefined" id="S6.T2.16.18.2.1.1">\method</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.2" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.18.2.2.1">0.622</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.3" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.18.2.3.1">10.02</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.4" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.18.2.4.1">0.229</span></td>
<td class="ltx_td ltx_border_t" id="S6.T2.16.18.2.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.6" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.18.2.6.1">0.928</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.7" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.18.2.7.1">6.15</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.8" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.18.2.8.1">0.398</span></td>
<td class="ltx_td ltx_border_t" id="S6.T2.16.18.2.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.10" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.18.2.10.1">0.718</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.11" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.18.2.11.1">  9.28</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.12" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.18.2.12.1">0.252</span></td>
<td class="ltx_td ltx_border_t" id="S6.T2.16.18.2.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.14" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.18.2.14.1">0.930</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.15" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.18.2.15.1">3.48</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.18.2.16" style="padding:-1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.16.18.2.16.1">0.610</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.13.13">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.1" style="padding:-1pt 3.0pt;">w/o Global <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S6.T2.13.13.1.m1.1"><semantics id="S6.T2.13.13.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S6.T2.13.13.1.m1.1.1" xref="S6.T2.13.13.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S6.T2.13.13.1.m1.1b"><ci id="S6.T2.13.13.1.m1.1.1.cmml" xref="S6.T2.13.13.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.13.13.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S6.T2.13.13.1.m1.1d">caligraphic_G</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.2" style="padding:-1pt 3.0pt;">0.520</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.3" style="padding:-1pt 3.0pt;">11.39</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.4" style="padding:-1pt 3.0pt;">0.171</td>
<td class="ltx_td ltx_border_t" id="S6.T2.13.13.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.6" style="padding:-1pt 3.0pt;">0.906</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.7" style="padding:-1pt 3.0pt;">6.56</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.8" style="padding:-1pt 3.0pt;">0.345</td>
<td class="ltx_td ltx_border_t" id="S6.T2.13.13.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.10" style="padding:-1pt 3.0pt;">0.626</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.11" style="padding:-1pt 3.0pt;">10.15</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.12" style="padding:-1pt 3.0pt;">0.217</td>
<td class="ltx_td ltx_border_t" id="S6.T2.13.13.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.14" style="padding:-1pt 3.0pt;">0.878</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.15" style="padding:-1pt 3.0pt;">5.30</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.13.13.16" style="padding:-1pt 3.0pt;">0.397</td>
</tr>
<tr class="ltx_tr" id="S6.T2.14.14">
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.1" style="padding:-1pt 3.0pt;">w/o Positive <math alttext="\mathcal{G}^{+}" class="ltx_Math" display="inline" id="S6.T2.14.14.1.m1.1"><semantics id="S6.T2.14.14.1.m1.1a"><msup id="S6.T2.14.14.1.m1.1.1" xref="S6.T2.14.14.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.T2.14.14.1.m1.1.1.2" xref="S6.T2.14.14.1.m1.1.1.2.cmml">𝒢</mi><mo id="S6.T2.14.14.1.m1.1.1.3" xref="S6.T2.14.14.1.m1.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S6.T2.14.14.1.m1.1b"><apply id="S6.T2.14.14.1.m1.1.1.cmml" xref="S6.T2.14.14.1.m1.1.1"><csymbol cd="ambiguous" id="S6.T2.14.14.1.m1.1.1.1.cmml" xref="S6.T2.14.14.1.m1.1.1">superscript</csymbol><ci id="S6.T2.14.14.1.m1.1.1.2.cmml" xref="S6.T2.14.14.1.m1.1.1.2">𝒢</ci><plus id="S6.T2.14.14.1.m1.1.1.3.cmml" xref="S6.T2.14.14.1.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.14.14.1.m1.1c">\mathcal{G}^{+}</annotation><annotation encoding="application/x-llamapun" id="S6.T2.14.14.1.m1.1d">caligraphic_G start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.2" style="padding:-1pt 3.0pt;">0.482</td>
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.3" style="padding:-1pt 3.0pt;">11.56</td>
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.4" style="padding:-1pt 3.0pt;">0.163</td>
<td class="ltx_td" id="S6.T2.14.14.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.6" style="padding:-1pt 3.0pt;">0.862</td>
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.7" style="padding:-1pt 3.0pt;">7.53</td>
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.8" style="padding:-1pt 3.0pt;">0.313</td>
<td class="ltx_td" id="S6.T2.14.14.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.10" style="padding:-1pt 3.0pt;">0.560</td>
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.11" style="padding:-1pt 3.0pt;">11.15</td>
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.12" style="padding:-1pt 3.0pt;">0.184</td>
<td class="ltx_td" id="S6.T2.14.14.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.14" style="padding:-1pt 3.0pt;">0.886</td>
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.15" style="padding:-1pt 3.0pt;">4.17</td>
<td class="ltx_td ltx_align_left" id="S6.T2.14.14.16" style="padding:-1pt 3.0pt;">0.496</td>
</tr>
<tr class="ltx_tr" id="S6.T2.15.15">
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.1" style="padding:-1pt 3.0pt;">w/o Negative <math alttext="\mathcal{G}^{-}" class="ltx_Math" display="inline" id="S6.T2.15.15.1.m1.1"><semantics id="S6.T2.15.15.1.m1.1a"><msup id="S6.T2.15.15.1.m1.1.1" xref="S6.T2.15.15.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.T2.15.15.1.m1.1.1.2" xref="S6.T2.15.15.1.m1.1.1.2.cmml">𝒢</mi><mo id="S6.T2.15.15.1.m1.1.1.3" xref="S6.T2.15.15.1.m1.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S6.T2.15.15.1.m1.1b"><apply id="S6.T2.15.15.1.m1.1.1.cmml" xref="S6.T2.15.15.1.m1.1.1"><csymbol cd="ambiguous" id="S6.T2.15.15.1.m1.1.1.1.cmml" xref="S6.T2.15.15.1.m1.1.1">superscript</csymbol><ci id="S6.T2.15.15.1.m1.1.1.2.cmml" xref="S6.T2.15.15.1.m1.1.1.2">𝒢</ci><minus id="S6.T2.15.15.1.m1.1.1.3.cmml" xref="S6.T2.15.15.1.m1.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.15.15.1.m1.1c">\mathcal{G}^{-}</annotation><annotation encoding="application/x-llamapun" id="S6.T2.15.15.1.m1.1d">caligraphic_G start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.2" style="padding:-1pt 3.0pt;">0.532</td>
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.3" style="padding:-1pt 3.0pt;">10.80</td>
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.4" style="padding:-1pt 3.0pt;">0.185</td>
<td class="ltx_td" id="S6.T2.15.15.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.6" style="padding:-1pt 3.0pt;">0.905</td>
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.7" style="padding:-1pt 3.0pt;">6.92</td>
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.8" style="padding:-1pt 3.0pt;">0.336</td>
<td class="ltx_td" id="S6.T2.15.15.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.10" style="padding:-1pt 3.0pt;">0.656</td>
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.11" style="padding:-1pt 3.0pt;">10.01</td>
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.12" style="padding:-1pt 3.0pt;">0.227</td>
<td class="ltx_td" id="S6.T2.15.15.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.14" style="padding:-1pt 3.0pt;">0.860</td>
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.15" style="padding:-1pt 3.0pt;">5.42</td>
<td class="ltx_td ltx_align_left" id="S6.T2.15.15.16" style="padding:-1pt 3.0pt;">0.389</td>
</tr>
<tr class="ltx_tr" id="S6.T2.16.19.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.1" style="padding:-1pt 3.0pt;">w/o Pol. net.</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.2" style="padding:-1pt 3.0pt;">0.519</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.3" style="padding:-1pt 3.0pt;">11.08</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.4" style="padding:-1pt 3.0pt;">0.186</td>
<td class="ltx_td ltx_border_t" id="S6.T2.16.19.3.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.6" style="padding:-1pt 3.0pt;">0.894</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.7" style="padding:-1pt 3.0pt;">6.37</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.8" style="padding:-1pt 3.0pt;">0.361</td>
<td class="ltx_td ltx_border_t" id="S6.T2.16.19.3.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.10" style="padding:-1pt 3.0pt;">0.628</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.11" style="padding:-1pt 3.0pt;">  9.61</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.12" style="padding:-1pt 3.0pt;">0.240</td>
<td class="ltx_td ltx_border_t" id="S6.T2.16.19.3.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.14" style="padding:-1pt 3.0pt;">0.896</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.15" style="padding:-1pt 3.0pt;">4.59</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.16.19.3.16" style="padding:-1pt 3.0pt;">0.516</td>
</tr>
<tr class="ltx_tr" id="S6.T2.16.20.4">
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.1" style="padding:-1pt 3.0pt;">w/o Q-net.</td>
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.2" style="padding:-1pt 3.0pt;">0.582</td>
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.3" style="padding:-1pt 3.0pt;">10.69</td>
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.4" style="padding:-1pt 3.0pt;">0.190</td>
<td class="ltx_td" id="S6.T2.16.20.4.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.6" style="padding:-1pt 3.0pt;">0.808</td>
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.7" style="padding:-1pt 3.0pt;">7.92</td>
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.8" style="padding:-1pt 3.0pt;">0.332</td>
<td class="ltx_td" id="S6.T2.16.20.4.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.10" style="padding:-1pt 3.0pt;">0.594</td>
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.11" style="padding:-1pt 3.0pt;">10.62</td>
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.12" style="padding:-1pt 3.0pt;">0.198</td>
<td class="ltx_td" id="S6.T2.16.20.4.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.14" style="padding:-1pt 3.0pt;">0.866</td>
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.15" style="padding:-1pt 3.0pt;">5.47</td>
<td class="ltx_td ltx_align_left" id="S6.T2.16.20.4.16" style="padding:-1pt 3.0pt;">0.386</td>
</tr>
<tr class="ltx_tr" id="S6.T2.16.16">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.1" style="padding:-1pt 3.0pt;">w/o <span class="ltx_text" id="S6.T2.16.16.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S6.T2.16.16.1.1.m1.1"><semantics id="S6.T2.16.16.1.1.m1.1a"><mrow id="S6.T2.16.16.1.1.m1.1.1" xref="S6.T2.16.16.1.1.m1.1.1.cmml"><mi id="S6.T2.16.16.1.1.m1.1.1.2" xref="S6.T2.16.16.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S6.T2.16.16.1.1.m1.1.1.1" xref="S6.T2.16.16.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S6.T2.16.16.1.1.m1.1.1.3" xref="S6.T2.16.16.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.16.16.1.1.m1.1b"><apply id="S6.T2.16.16.1.1.m1.1.1.cmml" xref="S6.T2.16.16.1.1.m1.1.1"><times id="S6.T2.16.16.1.1.m1.1.1.1.cmml" xref="S6.T2.16.16.1.1.m1.1.1.1"></times><ci id="S6.T2.16.16.1.1.m1.1.1.2.cmml" xref="S6.T2.16.16.1.1.m1.1.1.2">𝚂</ci><ci id="S6.T2.16.16.1.1.m1.1.1.3a.cmml" xref="S6.T2.16.16.1.1.m1.1.1.3"><mtext id="S6.T2.16.16.1.1.m1.1.1.3.cmml" xref="S6.T2.16.16.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.16.16.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.T2.16.16.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span>
</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.2" style="padding:-1pt 3.0pt;">0.520</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.3" style="padding:-1pt 3.0pt;">11.06</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.4" style="padding:-1pt 3.0pt;">0.193</td>
<td class="ltx_td ltx_border_bb ltx_border_t" id="S6.T2.16.16.5" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.6" style="padding:-1pt 3.0pt;">0.902</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.7" style="padding:-1pt 3.0pt;">6.80</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.8" style="padding:-1pt 3.0pt;">0.335</td>
<td class="ltx_td ltx_border_bb ltx_border_t" id="S6.T2.16.16.9" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.10" style="padding:-1pt 3.0pt;">0.650</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.11" style="padding:-1pt 3.0pt;">10.20</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.12" style="padding:-1pt 3.0pt;">0.218</td>
<td class="ltx_td ltx_border_bb ltx_border_t" id="S6.T2.16.16.13" style="padding:-1pt 3.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.14" style="padding:-1pt 3.0pt;">0.860</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.15" style="padding:-1pt 3.0pt;">5.53</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T2.16.16.16" style="padding:-1pt 3.0pt;">0.396</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Ablation studies on benchmark datasets. The best performance in each column is in bold.</figcaption>
</figure>
<figure class="ltx_table" id="S6.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T3.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T3.4.5.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T3.4.5.1.1" style="padding:-1.25pt 1.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.4.5.1.1.1">Model</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S6.T3.4.5.1.2" style="padding:-1.25pt 1.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.4.5.1.2.1">Yelp</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S6.T3.4.5.1.3" style="padding:-1.25pt 1.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.4.5.1.3.1">LastFM</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S6.T3.4.5.1.4" style="padding:-1.25pt 1.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.4.5.1.4.1">Amazon-Book</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S6.T3.4.5.1.5" style="padding:-1.25pt 1.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.4.5.1.5.1">MovieLens</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T3.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T3.1.1.1" style="padding:-1.25pt 1.0pt;"><span class="ltx_text" id="S6.T3.1.1.1.1"><math alttext="\mathop{\mathtt{UNICORN}}\limits" class="ltx_Math" display="inline" id="S6.T3.1.1.1.1.m1.1"><semantics id="S6.T3.1.1.1.1.m1.1a"><mo id="S6.T3.1.1.1.1.m1.1.1" movablelimits="false" xref="S6.T3.1.1.1.1.m1.1.1.cmml">𝚄𝙽𝙸𝙲𝙾𝚁𝙽</mo><annotation-xml encoding="MathML-Content" id="S6.T3.1.1.1.1.m1.1b"><ci id="S6.T3.1.1.1.1.m1.1.1.cmml" xref="S6.T3.1.1.1.1.m1.1.1">𝚄𝙽𝙸𝙲𝙾𝚁𝙽</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.1.1.1.1.m1.1c">\mathop{\mathtt{UNICORN}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.T3.1.1.1.1.m1.1d">typewriter_UNICORN</annotation></semantics></math></span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" id="S6.T3.1.1.2" style="padding:-1.25pt 1.0pt;">16.15</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" id="S6.T3.1.1.3" style="padding:-1.25pt 1.0pt;">4.30</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" id="S6.T3.1.1.4" style="padding:-1.25pt 1.0pt;">6.03</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" id="S6.T3.1.1.5" style="padding:-1.25pt 1.0pt;">7.96</td>
</tr>
<tr class="ltx_tr" id="S6.T3.2.2">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S6.T3.2.2.1" style="padding:-1.25pt 1.0pt;"><span class="ltx_text" id="S6.T3.2.2.1.1"><math alttext="\mathop{\mathtt{MCMIPL}}\limits" class="ltx_Math" display="inline" id="S6.T3.2.2.1.1.m1.1"><semantics id="S6.T3.2.2.1.1.m1.1a"><mo id="S6.T3.2.2.1.1.m1.1.1" movablelimits="false" xref="S6.T3.2.2.1.1.m1.1.1.cmml">𝙼𝙲𝙼𝙸𝙿𝙻</mo><annotation-xml encoding="MathML-Content" id="S6.T3.2.2.1.1.m1.1b"><ci id="S6.T3.2.2.1.1.m1.1.1.cmml" xref="S6.T3.2.2.1.1.m1.1.1">𝙼𝙲𝙼𝙸𝙿𝙻</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.2.2.1.1.m1.1c">\mathop{\mathtt{MCMIPL}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.T3.2.2.1.1.m1.1d">typewriter_MCMIPL</annotation></semantics></math></span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S6.T3.2.2.2" style="padding:-1.25pt 1.0pt;">15.57</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S6.T3.2.2.3" style="padding:-1.25pt 1.0pt;">5.08</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S6.T3.2.2.4" style="padding:-1.25pt 1.0pt;">6.40</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S6.T3.2.2.5" style="padding:-1.25pt 1.0pt;">7.93</td>
</tr>
<tr class="ltx_tr" id="S6.T3.3.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S6.T3.3.3.1" style="padding:-1.25pt 1.0pt;"><span class="ltx_text" id="S6.T3.3.3.1.1"><math alttext="\mathop{\mathtt{HutCRS}}\limits" class="ltx_Math" display="inline" id="S6.T3.3.3.1.1.m1.1"><semantics id="S6.T3.3.3.1.1.m1.1a"><mo id="S6.T3.3.3.1.1.m1.1.1" movablelimits="false" xref="S6.T3.3.3.1.1.m1.1.1.cmml">𝙷𝚞𝚝𝙲𝚁𝚂</mo><annotation-xml encoding="MathML-Content" id="S6.T3.3.3.1.1.m1.1b"><ci id="S6.T3.3.3.1.1.m1.1.1.cmml" xref="S6.T3.3.3.1.1.m1.1.1">𝙷𝚞𝚝𝙲𝚁𝚂</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.3.3.1.1.m1.1c">\mathop{\mathtt{HutCRS}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.T3.3.3.1.1.m1.1d">typewriter_HutCRS</annotation></semantics></math></span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S6.T3.3.3.2" style="padding:-1.25pt 1.0pt;">14.05</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S6.T3.3.3.3" style="padding:-1.25pt 1.0pt;">4.66</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S6.T3.3.3.4" style="padding:-1.25pt 1.0pt;">5.83</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S6.T3.3.3.5" style="padding:-1.25pt 1.0pt;">8.40</td>
</tr>
<tr class="ltx_tr" id="S6.T3.4.4">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S6.T3.4.4.1" style="padding:-1.25pt 1.0pt;"><span class="ltx_text" id="S6.T3.4.4.1.1"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S6.T3.4.4.1.1.m1.1"><semantics id="S6.T3.4.4.1.1.m1.1a"><mrow id="S6.T3.4.4.1.1.m1.1.1" xref="S6.T3.4.4.1.1.m1.1.1.cmml"><mi id="S6.T3.4.4.1.1.m1.1.1.2" xref="S6.T3.4.4.1.1.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S6.T3.4.4.1.1.m1.1.1.1" xref="S6.T3.4.4.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S6.T3.4.4.1.1.m1.1.1.3" xref="S6.T3.4.4.1.1.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.T3.4.4.1.1.m1.1b"><apply id="S6.T3.4.4.1.1.m1.1.1.cmml" xref="S6.T3.4.4.1.1.m1.1.1"><times id="S6.T3.4.4.1.1.m1.1.1.1.cmml" xref="S6.T3.4.4.1.1.m1.1.1.1"></times><ci id="S6.T3.4.4.1.1.m1.1.1.2.cmml" xref="S6.T3.4.4.1.1.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S6.T3.4.4.1.1.m1.1.1.3a.cmml" xref="S6.T3.4.4.1.1.m1.1.1.3"><mtext id="S6.T3.4.4.1.1.m1.1.1.3.cmml" xref="S6.T3.4.4.1.1.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.4.4.1.1.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.T3.4.4.1.1.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S6.T3.4.4.2" style="padding:-1.25pt 1.0pt;">16.40</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S6.T3.4.4.3" style="padding:-1.25pt 1.0pt;">5.57</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S6.T3.4.4.4" style="padding:-1.25pt 1.0pt;">6.88</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S6.T3.4.4.5" style="padding:-1.25pt 1.0pt;">8.45</td>
</tr>
<tr class="ltx_tr" id="S6.T3.4.6.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T3.4.6.1.1" style="padding:-1.25pt 1.0pt;"><span class="ltx_ERROR undefined" id="S6.T3.4.6.1.1.1">\method</span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_bb" id="S6.T3.4.6.1.2" style="padding:-1.25pt 1.0pt;">38.15</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_bb" id="S6.T3.4.6.1.3" style="padding:-1.25pt 1.0pt;">11.07</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_bb" id="S6.T3.4.6.1.4" style="padding:-1.25pt 1.0pt;">13.21</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_bb" id="S6.T3.4.6.1.5" style="padding:-1.25pt 1.0pt;">20.97</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Training hours on a single Tesla V100 GPU .</figcaption>
</figure>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.2"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S6.SS2.p1.1.1">Training efficiency of <span class="ltx_ERROR undefined" id="S6.SS2.p1.1.1.2">\method</span>and <span class="ltx_text" id="S6.SS2.p1.1.1.1"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S6.SS2.p1.1.1.1.m1.1"><semantics id="S6.SS2.p1.1.1.1.m1.1a"><mrow id="S6.SS2.p1.1.1.1.m1.1.1" xref="S6.SS2.p1.1.1.1.m1.1.1.cmml"><mi id="S6.SS2.p1.1.1.1.m1.1.1.2" xref="S6.SS2.p1.1.1.1.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S6.SS2.p1.1.1.1.m1.1.1.1" xref="S6.SS2.p1.1.1.1.m1.1.1.1.cmml">⁢</mo><mtext class="ltx_mathvariant_bold-italic" id="S6.SS2.p1.1.1.1.m1.1.1.3" xref="S6.SS2.p1.1.1.1.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.1.1.m1.1b"><apply id="S6.SS2.p1.1.1.1.m1.1.1.cmml" xref="S6.SS2.p1.1.1.1.m1.1.1"><times id="S6.SS2.p1.1.1.1.m1.1.1.1.cmml" xref="S6.SS2.p1.1.1.1.m1.1.1.1"></times><ci id="S6.SS2.p1.1.1.1.m1.1.1.2.cmml" xref="S6.SS2.p1.1.1.1.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S6.SS2.p1.1.1.1.m1.1.1.3a.cmml" xref="S6.SS2.p1.1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold-italic" id="S6.SS2.p1.1.1.1.m1.1.1.3.cmml" xref="S6.SS2.p1.1.1.1.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.1.1.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.1.1.1.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> is highly comparable to the baselines.</span>
As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S6.T3" title="Table 3 ‣ 6.2 Efficiency Analysis ‣ 6 Experimental Results ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">3</span></a>, <span class="ltx_text" id="S6.SS2.p1.2.2"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S6.SS2.p1.2.2.m1.1"><semantics id="S6.SS2.p1.2.2.m1.1a"><mrow id="S6.SS2.p1.2.2.m1.1.1" xref="S6.SS2.p1.2.2.m1.1.1.cmml"><mi id="S6.SS2.p1.2.2.m1.1.1.2" xref="S6.SS2.p1.2.2.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S6.SS2.p1.2.2.m1.1.1.1" xref="S6.SS2.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S6.SS2.p1.2.2.m1.1.1.3" xref="S6.SS2.p1.2.2.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.2.2.m1.1b"><apply id="S6.SS2.p1.2.2.m1.1.1.cmml" xref="S6.SS2.p1.2.2.m1.1.1"><times id="S6.SS2.p1.2.2.m1.1.1.1.cmml" xref="S6.SS2.p1.2.2.m1.1.1.1"></times><ci id="S6.SS2.p1.2.2.m1.1.1.2.cmml" xref="S6.SS2.p1.2.2.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S6.SS2.p1.2.2.m1.1.1.3a.cmml" xref="S6.SS2.p1.2.2.m1.1.1.3"><mtext id="S6.SS2.p1.2.2.m1.1.1.3.cmml" xref="S6.SS2.p1.2.2.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.2.2.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.2.2.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> takes similar training time with baselines as it collects all the trajectories from MCTS and do not incur additional search cost.
Even with <span class="ltx_ERROR undefined" id="S6.SS2.p1.2.3">\method</span>, the training time is only about 2 times longer than baselines. This is because conversation simulation only requires forward propagation without gradient backward, so even conducting 20 rollouts per user will not significantly reduce efficiency.
Also note that during inference, the efficiency of <span class="ltx_ERROR undefined" id="S6.SS2.p1.2.4">\method</span>is comparable with baselines, as tree search is not required during inference.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Ablation Study</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">To validate the effectiveness of the key components, we conduct ablation studies and report the results in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S6.T2" title="Table 2 ‣ 6.2 Efficiency Analysis ‣ 6 Experimental Results ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">2</span></a>. We have the following observations:</p>
</div>
<div class="ltx_para" id="S6.SS3.p2">
<p class="ltx_p" id="S6.SS3.p2.6"><span class="ltx_text ltx_font_bold" id="S6.SS3.p2.6.4">(1)</span> <span class="ltx_text ltx_font_bold ltx_font_italic" id="S6.SS3.p2.2.2">Each graph—<math alttext="\mathcal{G},\mathcal{G}^{+}\!,\mathcal{G}^{-}" class="ltx_Math" display="inline" id="S6.SS3.p2.1.1.m1.3"><semantics id="S6.SS3.p2.1.1.m1.3a"><mrow id="S6.SS3.p2.1.1.m1.3.3.2" xref="S6.SS3.p2.1.1.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS3.p2.1.1.m1.1.1" xref="S6.SS3.p2.1.1.m1.1.1.cmml">𝒢</mi><mo id="S6.SS3.p2.1.1.m1.3.3.2.3" xref="S6.SS3.p2.1.1.m1.3.3.3.cmml">,</mo><msup id="S6.SS3.p2.1.1.m1.2.2.1.1" xref="S6.SS3.p2.1.1.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS3.p2.1.1.m1.2.2.1.1.2" xref="S6.SS3.p2.1.1.m1.2.2.1.1.2.cmml">𝒢</mi><mo id="S6.SS3.p2.1.1.m1.2.2.1.1.3" xref="S6.SS3.p2.1.1.m1.2.2.1.1.3.cmml">+</mo></msup><mo id="S6.SS3.p2.1.1.m1.3.3.2.4" xref="S6.SS3.p2.1.1.m1.3.3.3.cmml">,</mo><msup id="S6.SS3.p2.1.1.m1.3.3.2.2" xref="S6.SS3.p2.1.1.m1.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS3.p2.1.1.m1.3.3.2.2.2" xref="S6.SS3.p2.1.1.m1.3.3.2.2.2.cmml">𝒢</mi><mo id="S6.SS3.p2.1.1.m1.3.3.2.2.3" xref="S6.SS3.p2.1.1.m1.3.3.2.2.3.cmml">−</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.1.1.m1.3b"><list id="S6.SS3.p2.1.1.m1.3.3.3.cmml" xref="S6.SS3.p2.1.1.m1.3.3.2"><ci id="S6.SS3.p2.1.1.m1.1.1.cmml" xref="S6.SS3.p2.1.1.m1.1.1">𝒢</ci><apply id="S6.SS3.p2.1.1.m1.2.2.1.1.cmml" xref="S6.SS3.p2.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.1.1.m1.2.2.1.1.1.cmml" xref="S6.SS3.p2.1.1.m1.2.2.1.1">superscript</csymbol><ci id="S6.SS3.p2.1.1.m1.2.2.1.1.2.cmml" xref="S6.SS3.p2.1.1.m1.2.2.1.1.2">𝒢</ci><plus id="S6.SS3.p2.1.1.m1.2.2.1.1.3.cmml" xref="S6.SS3.p2.1.1.m1.2.2.1.1.3"></plus></apply><apply id="S6.SS3.p2.1.1.m1.3.3.2.2.cmml" xref="S6.SS3.p2.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S6.SS3.p2.1.1.m1.3.3.2.2.1.cmml" xref="S6.SS3.p2.1.1.m1.3.3.2.2">superscript</csymbol><ci id="S6.SS3.p2.1.1.m1.3.3.2.2.2.cmml" xref="S6.SS3.p2.1.1.m1.3.3.2.2.2">𝒢</ci><minus id="S6.SS3.p2.1.1.m1.3.3.2.2.3.cmml" xref="S6.SS3.p2.1.1.m1.3.3.2.2.3"></minus></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.1.1.m1.3c">\mathcal{G},\mathcal{G}^{+}\!,\mathcal{G}^{-}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.1.1.m1.3d">caligraphic_G , caligraphic_G start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , caligraphic_G start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> is vital for <span class="ltx_text" id="S6.SS3.p2.2.2.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S6.SS3.p2.2.2.1.m1.1"><semantics id="S6.SS3.p2.2.2.1.m1.1a"><mrow id="S6.SS3.p2.2.2.1.m1.1.1" xref="S6.SS3.p2.2.2.1.m1.1.1.cmml"><mi id="S6.SS3.p2.2.2.1.m1.1.1.2" xref="S6.SS3.p2.2.2.1.m1.1.1.2.cmml">𝚂</mi><mo id="S6.SS3.p2.2.2.1.m1.1.1.1" xref="S6.SS3.p2.2.2.1.m1.1.1.1.cmml">⁢</mo><mtext class="ltx_mathvariant_bold-italic" id="S6.SS3.p2.2.2.1.m1.1.1.3" xref="S6.SS3.p2.2.2.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.2.2.1.m1.1b"><apply id="S6.SS3.p2.2.2.1.m1.1.1.cmml" xref="S6.SS3.p2.2.2.1.m1.1.1"><times id="S6.SS3.p2.2.2.1.m1.1.1.1.cmml" xref="S6.SS3.p2.2.2.1.m1.1.1.1"></times><ci id="S6.SS3.p2.2.2.1.m1.1.1.2.cmml" xref="S6.SS3.p2.2.2.1.m1.1.1.2">𝚂</ci><ci id="S6.SS3.p2.2.2.1.m1.1.1.3a.cmml" xref="S6.SS3.p2.2.2.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold-italic" id="S6.SS3.p2.2.2.1.m1.1.1.3.cmml" xref="S6.SS3.p2.2.2.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.2.2.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.2.2.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> to encode the state information.</span> Removing each graph from <span class="ltx_text" id="S6.SS3.p2.3.3"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S6.SS3.p2.3.3.m1.1"><semantics id="S6.SS3.p2.3.3.m1.1a"><mrow id="S6.SS3.p2.3.3.m1.1.1" xref="S6.SS3.p2.3.3.m1.1.1.cmml"><mi id="S6.SS3.p2.3.3.m1.1.1.2" xref="S6.SS3.p2.3.3.m1.1.1.2.cmml">𝚂</mi><mo id="S6.SS3.p2.3.3.m1.1.1.1" xref="S6.SS3.p2.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="S6.SS3.p2.3.3.m1.1.1.3" xref="S6.SS3.p2.3.3.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.3.3.m1.1b"><apply id="S6.SS3.p2.3.3.m1.1.1.cmml" xref="S6.SS3.p2.3.3.m1.1.1"><times id="S6.SS3.p2.3.3.m1.1.1.1.cmml" xref="S6.SS3.p2.3.3.m1.1.1.1"></times><ci id="S6.SS3.p2.3.3.m1.1.1.2.cmml" xref="S6.SS3.p2.3.3.m1.1.1.2">𝚂</ci><ci id="S6.SS3.p2.3.3.m1.1.1.3a.cmml" xref="S6.SS3.p2.3.3.m1.1.1.3"><mtext id="S6.SS3.p2.3.3.m1.1.1.3.cmml" xref="S6.SS3.p2.3.3.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.3.3.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.3.3.m1.1d">typewriter_S -agent</annotation></semantics></math></span> degrades performance, verifying the necessity of each graph in state encoding: global information graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S6.SS3.p2.4.m1.1"><semantics id="S6.SS3.p2.4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S6.SS3.p2.4.m1.1.1" xref="S6.SS3.p2.4.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.4.m1.1b"><ci id="S6.SS3.p2.4.m1.1.1.cmml" xref="S6.SS3.p2.4.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.4.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.4.m1.1d">caligraphic_G</annotation></semantics></math> is crucial for mining user-item relations and item-attribute value associations, while positive (<math alttext="\mathcal{G}^{+}" class="ltx_Math" display="inline" id="S6.SS3.p2.5.m2.1"><semantics id="S6.SS3.p2.5.m2.1a"><msup id="S6.SS3.p2.5.m2.1.1" xref="S6.SS3.p2.5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS3.p2.5.m2.1.1.2" xref="S6.SS3.p2.5.m2.1.1.2.cmml">𝒢</mi><mo id="S6.SS3.p2.5.m2.1.1.3" xref="S6.SS3.p2.5.m2.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.5.m2.1b"><apply id="S6.SS3.p2.5.m2.1.1.cmml" xref="S6.SS3.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.5.m2.1.1.1.cmml" xref="S6.SS3.p2.5.m2.1.1">superscript</csymbol><ci id="S6.SS3.p2.5.m2.1.1.2.cmml" xref="S6.SS3.p2.5.m2.1.1.2">𝒢</ci><plus id="S6.SS3.p2.5.m2.1.1.3.cmml" xref="S6.SS3.p2.5.m2.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.5.m2.1c">\mathcal{G}^{+}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.5.m2.1d">caligraphic_G start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math>) and negative (<math alttext="\mathcal{G}^{-}" class="ltx_Math" display="inline" id="S6.SS3.p2.6.m3.1"><semantics id="S6.SS3.p2.6.m3.1a"><msup id="S6.SS3.p2.6.m3.1.1" xref="S6.SS3.p2.6.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS3.p2.6.m3.1.1.2" xref="S6.SS3.p2.6.m3.1.1.2.cmml">𝒢</mi><mo id="S6.SS3.p2.6.m3.1.1.3" xref="S6.SS3.p2.6.m3.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.6.m3.1b"><apply id="S6.SS3.p2.6.m3.1.1.cmml" xref="S6.SS3.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.6.m3.1.1.1.cmml" xref="S6.SS3.p2.6.m3.1.1">superscript</csymbol><ci id="S6.SS3.p2.6.m3.1.1.2.cmml" xref="S6.SS3.p2.6.m3.1.1.2">𝒢</ci><minus id="S6.SS3.p2.6.m3.1.1.3.cmml" xref="S6.SS3.p2.6.m3.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.6.m3.1c">\mathcal{G}^{-}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.6.m3.1d">caligraphic_G start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>) feedback graphs are vital for capturing users’ preferences (likes/dislikes on items and attribute values) expressed in the conversation.</p>
</div>
<div class="ltx_para" id="S6.SS3.p3">
<p class="ltx_p" id="S6.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S6.SS3.p3.1.1">(2)</span> <span class="ltx_text ltx_font_bold ltx_font_italic" id="S6.SS3.p3.1.2">Both the policy network and the Q-network are critical to conversational planning.</span> We design two variants: replacing the policy network with random action type selection (w/o Pol. net.); replacing the Q-network with entropy-based action selection (w/o Q-net.). Performance drops in both variants suggest both networks are crucial for hierarchical action selection, and the absence of an informed decision maker, either at the action type or the action level, leads to poor conversational planning.</p>
</div>
<div class="ltx_para" id="S6.SS3.p4">
<p class="ltx_p" id="S6.SS3.p4.6"><span class="ltx_text ltx_font_bold" id="S6.SS3.p4.6.7">(3)</span> <span class="ltx_text ltx_font_bold ltx_font_italic" id="S6.SS3.p4.2.2">Guidance from <span class="ltx_text" id="S6.SS3.p4.1.1.1"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S6.SS3.p4.1.1.1.m1.1"><semantics id="S6.SS3.p4.1.1.1.m1.1a"><mrow id="S6.SS3.p4.1.1.1.m1.1.1" xref="S6.SS3.p4.1.1.1.m1.1.1.cmml"><mi id="S6.SS3.p4.1.1.1.m1.1.1.2" xref="S6.SS3.p4.1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S6.SS3.p4.1.1.1.m1.1.1.1" xref="S6.SS3.p4.1.1.1.m1.1.1.1.cmml">⁢</mo><mtext class="ltx_mathvariant_bold-italic" id="S6.SS3.p4.1.1.1.m1.1.1.3" xref="S6.SS3.p4.1.1.1.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.1.1.1.m1.1b"><apply id="S6.SS3.p4.1.1.1.m1.1.1.cmml" xref="S6.SS3.p4.1.1.1.m1.1.1"><times id="S6.SS3.p4.1.1.1.m1.1.1.1.cmml" xref="S6.SS3.p4.1.1.1.m1.1.1.1"></times><ci id="S6.SS3.p4.1.1.1.m1.1.1.2.cmml" xref="S6.SS3.p4.1.1.1.m1.1.1.2">𝚂</ci><ci id="S6.SS3.p4.1.1.1.m1.1.1.3a.cmml" xref="S6.SS3.p4.1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold-italic" id="S6.SS3.p4.1.1.1.m1.1.1.3.cmml" xref="S6.SS3.p4.1.1.1.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.1.1.1.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p4.1.1.1.m1.1d">typewriter_S -planner</annotation></semantics></math></span> is crucial for <span class="ltx_text" id="S6.SS3.p4.2.2.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S6.SS3.p4.2.2.2.m1.1"><semantics id="S6.SS3.p4.2.2.2.m1.1a"><mrow id="S6.SS3.p4.2.2.2.m1.1.1" xref="S6.SS3.p4.2.2.2.m1.1.1.cmml"><mi id="S6.SS3.p4.2.2.2.m1.1.1.2" xref="S6.SS3.p4.2.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="S6.SS3.p4.2.2.2.m1.1.1.1" xref="S6.SS3.p4.2.2.2.m1.1.1.1.cmml">⁢</mo><mtext class="ltx_mathvariant_bold-italic" id="S6.SS3.p4.2.2.2.m1.1.1.3" xref="S6.SS3.p4.2.2.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.2.2.2.m1.1b"><apply id="S6.SS3.p4.2.2.2.m1.1.1.cmml" xref="S6.SS3.p4.2.2.2.m1.1.1"><times id="S6.SS3.p4.2.2.2.m1.1.1.1.cmml" xref="S6.SS3.p4.2.2.2.m1.1.1.1"></times><ci id="S6.SS3.p4.2.2.2.m1.1.1.2.cmml" xref="S6.SS3.p4.2.2.2.m1.1.1.2">𝚂</ci><ci id="S6.SS3.p4.2.2.2.m1.1.1.3a.cmml" xref="S6.SS3.p4.2.2.2.m1.1.1.3"><mtext class="ltx_mathvariant_bold-italic" id="S6.SS3.p4.2.2.2.m1.1.1.3.cmml" xref="S6.SS3.p4.2.2.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.2.2.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p4.2.2.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> to achieve strategic conversational planning.</span>
Removing <span class="ltx_text" id="S6.SS3.p4.3.3"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S6.SS3.p4.3.3.m1.1"><semantics id="S6.SS3.p4.3.3.m1.1a"><mrow id="S6.SS3.p4.3.3.m1.1.1" xref="S6.SS3.p4.3.3.m1.1.1.cmml"><mi id="S6.SS3.p4.3.3.m1.1.1.2" xref="S6.SS3.p4.3.3.m1.1.1.2.cmml">𝚂</mi><mo id="S6.SS3.p4.3.3.m1.1.1.1" xref="S6.SS3.p4.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="S6.SS3.p4.3.3.m1.1.1.3" xref="S6.SS3.p4.3.3.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.3.3.m1.1b"><apply id="S6.SS3.p4.3.3.m1.1.1.cmml" xref="S6.SS3.p4.3.3.m1.1.1"><times id="S6.SS3.p4.3.3.m1.1.1.1.cmml" xref="S6.SS3.p4.3.3.m1.1.1.1"></times><ci id="S6.SS3.p4.3.3.m1.1.1.2.cmml" xref="S6.SS3.p4.3.3.m1.1.1.2">𝚂</ci><ci id="S6.SS3.p4.3.3.m1.1.1.3a.cmml" xref="S6.SS3.p4.3.3.m1.1.1.3"><mtext id="S6.SS3.p4.3.3.m1.1.1.3.cmml" xref="S6.SS3.p4.3.3.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.3.3.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p4.3.3.m1.1d">typewriter_S -planner</annotation></semantics></math></span> and training <span class="ltx_text" id="S6.SS3.p4.4.4"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S6.SS3.p4.4.4.m1.1"><semantics id="S6.SS3.p4.4.4.m1.1a"><mrow id="S6.SS3.p4.4.4.m1.1.1" xref="S6.SS3.p4.4.4.m1.1.1.cmml"><mi id="S6.SS3.p4.4.4.m1.1.1.2" xref="S6.SS3.p4.4.4.m1.1.1.2.cmml">𝚂</mi><mo id="S6.SS3.p4.4.4.m1.1.1.1" xref="S6.SS3.p4.4.4.m1.1.1.1.cmml">⁢</mo><mtext id="S6.SS3.p4.4.4.m1.1.1.3" xref="S6.SS3.p4.4.4.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.4.4.m1.1b"><apply id="S6.SS3.p4.4.4.m1.1.1.cmml" xref="S6.SS3.p4.4.4.m1.1.1"><times id="S6.SS3.p4.4.4.m1.1.1.1.cmml" xref="S6.SS3.p4.4.4.m1.1.1.1"></times><ci id="S6.SS3.p4.4.4.m1.1.1.2.cmml" xref="S6.SS3.p4.4.4.m1.1.1.2">𝚂</ci><ci id="S6.SS3.p4.4.4.m1.1.1.3a.cmml" xref="S6.SS3.p4.4.4.m1.1.1.3"><mtext id="S6.SS3.p4.4.4.m1.1.1.3.cmml" xref="S6.SS3.p4.4.4.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.4.4.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p4.4.4.m1.1d">typewriter_S -agent</annotation></semantics></math></span> on sampled on-policy trajectories as in <cite class="ltx_cite ltx_citemacro_citet">Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>)</cite> degrades the performance, because sampled trajectories may bring cumulative errors and biased estimations <cite class="ltx_cite ltx_citemacro_cite">Kumar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib24" title="">2019</a>); Lan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib25" title="">2020</a>)</cite>, resulting in suboptimal conversational planning. By contrast, the high-rewarded conversation plans from <span class="ltx_text" id="S6.SS3.p4.5.5"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S6.SS3.p4.5.5.m1.1"><semantics id="S6.SS3.p4.5.5.m1.1a"><mrow id="S6.SS3.p4.5.5.m1.1.1" xref="S6.SS3.p4.5.5.m1.1.1.cmml"><mi id="S6.SS3.p4.5.5.m1.1.1.2" xref="S6.SS3.p4.5.5.m1.1.1.2.cmml">𝚂</mi><mo id="S6.SS3.p4.5.5.m1.1.1.1" xref="S6.SS3.p4.5.5.m1.1.1.1.cmml">⁢</mo><mtext id="S6.SS3.p4.5.5.m1.1.1.3" xref="S6.SS3.p4.5.5.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.5.5.m1.1b"><apply id="S6.SS3.p4.5.5.m1.1.1.cmml" xref="S6.SS3.p4.5.5.m1.1.1"><times id="S6.SS3.p4.5.5.m1.1.1.1.cmml" xref="S6.SS3.p4.5.5.m1.1.1.1"></times><ci id="S6.SS3.p4.5.5.m1.1.1.2.cmml" xref="S6.SS3.p4.5.5.m1.1.1.2">𝚂</ci><ci id="S6.SS3.p4.5.5.m1.1.1.3a.cmml" xref="S6.SS3.p4.5.5.m1.1.1.3"><mtext id="S6.SS3.p4.5.5.m1.1.1.3.cmml" xref="S6.SS3.p4.5.5.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.5.5.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p4.5.5.m1.1d">typewriter_S -planner</annotation></semantics></math></span> offers robust guidance for <span class="ltx_text" id="S6.SS3.p4.6.6"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S6.SS3.p4.6.6.m1.1"><semantics id="S6.SS3.p4.6.6.m1.1a"><mrow id="S6.SS3.p4.6.6.m1.1.1" xref="S6.SS3.p4.6.6.m1.1.1.cmml"><mi id="S6.SS3.p4.6.6.m1.1.1.2" xref="S6.SS3.p4.6.6.m1.1.1.2.cmml">𝚂</mi><mo id="S6.SS3.p4.6.6.m1.1.1.1" xref="S6.SS3.p4.6.6.m1.1.1.1.cmml">⁢</mo><mtext id="S6.SS3.p4.6.6.m1.1.1.3" xref="S6.SS3.p4.6.6.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.6.6.m1.1b"><apply id="S6.SS3.p4.6.6.m1.1.1.cmml" xref="S6.SS3.p4.6.6.m1.1.1"><times id="S6.SS3.p4.6.6.m1.1.1.1.cmml" xref="S6.SS3.p4.6.6.m1.1.1.1"></times><ci id="S6.SS3.p4.6.6.m1.1.1.2.cmml" xref="S6.SS3.p4.6.6.m1.1.1.2">𝚂</ci><ci id="S6.SS3.p4.6.6.m1.1.1.3a.cmml" xref="S6.SS3.p4.6.6.m1.1.1.3"><mtext id="S6.SS3.p4.6.6.m1.1.1.3.cmml" xref="S6.SS3.p4.6.6.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.6.6.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p4.6.6.m1.1d">typewriter_S -agent</annotation></semantics></math></span> and boosts its capability for strategic planning.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Hyperparameter Sensitivity</h3>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.10">We study <span class="ltx_ERROR undefined" id="S6.SS4.p1.10.4">\method</span>’s performance sensitivity to the exploration factor <math alttext="w" class="ltx_Math" display="inline" id="S6.SS4.p1.1.m1.1"><semantics id="S6.SS4.p1.1.m1.1a"><mi id="S6.SS4.p1.1.m1.1.1" xref="S6.SS4.p1.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.1.m1.1b"><ci id="S6.SS4.p1.1.m1.1.1.cmml" xref="S6.SS4.p1.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.1.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.1.m1.1d">italic_w</annotation></semantics></math> and the rollout number <math alttext="\!N\!" class="ltx_Math" display="inline" id="S6.SS4.p1.2.m2.1"><semantics id="S6.SS4.p1.2.m2.1a"><mi id="S6.SS4.p1.2.m2.1.1" xref="S6.SS4.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.2.m2.1b"><ci id="S6.SS4.p1.2.m2.1.1.cmml" xref="S6.SS4.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.2.m2.1c">\!N\!</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.2.m2.1d">italic_N</annotation></semantics></math>, as detailed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS6" title="F.6 Hyper-parameter Sensitivity ‣ Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">F.6</span></a>. Our major conclusions are: the performance remains robust to large <math alttext="w" class="ltx_Math" display="inline" id="S6.SS4.p1.3.m3.1"><semantics id="S6.SS4.p1.3.m3.1a"><mi id="S6.SS4.p1.3.m3.1.1" xref="S6.SS4.p1.3.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.3.m3.1b"><ci id="S6.SS4.p1.3.m3.1.1.cmml" xref="S6.SS4.p1.3.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.3.m3.1c">w</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.3.m3.1d">italic_w</annotation></semantics></math> but drops with small <math alttext="w" class="ltx_Math" display="inline" id="S6.SS4.p1.4.m4.1"><semantics id="S6.SS4.p1.4.m4.1a"><mi id="S6.SS4.p1.4.m4.1.1" xref="S6.SS4.p1.4.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.4.m4.1b"><ci id="S6.SS4.p1.4.m4.1.1.cmml" xref="S6.SS4.p1.4.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.4.m4.1c">w</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.4.m4.1d">italic_w</annotation></semantics></math>. <span class="ltx_text ltx_font_bold ltx_font_italic" id="S6.SS4.p1.10.5">This suggests that <span class="ltx_ERROR undefined" id="S6.SS4.p1.10.5.1">\method</span>favours exploration over exploitation during conversational tree search.</span> Additionally, the performance notably improves when increasing from <math alttext="N{=}1" class="ltx_Math" display="inline" id="S6.SS4.p1.5.m5.1"><semantics id="S6.SS4.p1.5.m5.1a"><mrow id="S6.SS4.p1.5.m5.1.1" xref="S6.SS4.p1.5.m5.1.1.cmml"><mi id="S6.SS4.p1.5.m5.1.1.2" xref="S6.SS4.p1.5.m5.1.1.2.cmml">N</mi><mo id="S6.SS4.p1.5.m5.1.1.1" xref="S6.SS4.p1.5.m5.1.1.1.cmml">=</mo><mn id="S6.SS4.p1.5.m5.1.1.3" xref="S6.SS4.p1.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.5.m5.1b"><apply id="S6.SS4.p1.5.m5.1.1.cmml" xref="S6.SS4.p1.5.m5.1.1"><eq id="S6.SS4.p1.5.m5.1.1.1.cmml" xref="S6.SS4.p1.5.m5.1.1.1"></eq><ci id="S6.SS4.p1.5.m5.1.1.2.cmml" xref="S6.SS4.p1.5.m5.1.1.2">𝑁</ci><cn id="S6.SS4.p1.5.m5.1.1.3.cmml" type="integer" xref="S6.SS4.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.5.m5.1c">N{=}1</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.5.m5.1d">italic_N = 1</annotation></semantics></math> to <math alttext="N{=}20" class="ltx_Math" display="inline" id="S6.SS4.p1.6.m6.1"><semantics id="S6.SS4.p1.6.m6.1a"><mrow id="S6.SS4.p1.6.m6.1.1" xref="S6.SS4.p1.6.m6.1.1.cmml"><mi id="S6.SS4.p1.6.m6.1.1.2" xref="S6.SS4.p1.6.m6.1.1.2.cmml">N</mi><mo id="S6.SS4.p1.6.m6.1.1.1" xref="S6.SS4.p1.6.m6.1.1.1.cmml">=</mo><mn id="S6.SS4.p1.6.m6.1.1.3" xref="S6.SS4.p1.6.m6.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.6.m6.1b"><apply id="S6.SS4.p1.6.m6.1.1.cmml" xref="S6.SS4.p1.6.m6.1.1"><eq id="S6.SS4.p1.6.m6.1.1.1.cmml" xref="S6.SS4.p1.6.m6.1.1.1"></eq><ci id="S6.SS4.p1.6.m6.1.1.2.cmml" xref="S6.SS4.p1.6.m6.1.1.2">𝑁</ci><cn id="S6.SS4.p1.6.m6.1.1.3.cmml" type="integer" xref="S6.SS4.p1.6.m6.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.6.m6.1c">N{=}20</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.6.m6.1d">italic_N = 20</annotation></semantics></math>, and remains stable and satisfactory after <math alttext="N{&gt;}20" class="ltx_Math" display="inline" id="S6.SS4.p1.7.m7.1"><semantics id="S6.SS4.p1.7.m7.1a"><mrow id="S6.SS4.p1.7.m7.1.1" xref="S6.SS4.p1.7.m7.1.1.cmml"><mi id="S6.SS4.p1.7.m7.1.1.2" xref="S6.SS4.p1.7.m7.1.1.2.cmml">N</mi><mo id="S6.SS4.p1.7.m7.1.1.1" xref="S6.SS4.p1.7.m7.1.1.1.cmml">&gt;</mo><mn id="S6.SS4.p1.7.m7.1.1.3" xref="S6.SS4.p1.7.m7.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.7.m7.1b"><apply id="S6.SS4.p1.7.m7.1.1.cmml" xref="S6.SS4.p1.7.m7.1.1"><gt id="S6.SS4.p1.7.m7.1.1.1.cmml" xref="S6.SS4.p1.7.m7.1.1.1"></gt><ci id="S6.SS4.p1.7.m7.1.1.2.cmml" xref="S6.SS4.p1.7.m7.1.1.2">𝑁</ci><cn id="S6.SS4.p1.7.m7.1.1.3.cmml" type="integer" xref="S6.SS4.p1.7.m7.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.7.m7.1c">N{&gt;}20</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.7.m7.1d">italic_N &gt; 20</annotation></semantics></math>. <span class="ltx_text ltx_font_bold ltx_font_italic" id="S6.SS4.p1.10.3">This suggests that setting <math alttext="N{=}20" class="ltx_Math" display="inline" id="S6.SS4.p1.8.1.m1.1"><semantics id="S6.SS4.p1.8.1.m1.1a"><mrow id="S6.SS4.p1.8.1.m1.1.1" xref="S6.SS4.p1.8.1.m1.1.1.cmml"><mi id="S6.SS4.p1.8.1.m1.1.1.2" mathvariant="normal" xref="S6.SS4.p1.8.1.m1.1.1.2.cmml">N</mi><mo id="S6.SS4.p1.8.1.m1.1.1.1" xref="S6.SS4.p1.8.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS4.p1.8.1.m1.1.1.3" xref="S6.SS4.p1.8.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.8.1.m1.1b"><apply id="S6.SS4.p1.8.1.m1.1.1.cmml" xref="S6.SS4.p1.8.1.m1.1.1"><eq id="S6.SS4.p1.8.1.m1.1.1.1.cmml" xref="S6.SS4.p1.8.1.m1.1.1.1"></eq><ci id="S6.SS4.p1.8.1.m1.1.1.2.cmml" xref="S6.SS4.p1.8.1.m1.1.1.2">N</ci><cn id="S6.SS4.p1.8.1.m1.1.1.3.cmml" type="integer" xref="S6.SS4.p1.8.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.8.1.m1.1c">N{=}20</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.8.1.m1.1d">italic_N = 20</annotation></semantics></math> can strike a good balance between efficiency (small <math alttext="N" class="ltx_Math" display="inline" id="S6.SS4.p1.9.2.m2.1"><semantics id="S6.SS4.p1.9.2.m2.1a"><mi id="S6.SS4.p1.9.2.m2.1.1" mathvariant="normal" xref="S6.SS4.p1.9.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.9.2.m2.1b"><ci id="S6.SS4.p1.9.2.m2.1.1.cmml" xref="S6.SS4.p1.9.2.m2.1.1">N</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.9.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.9.2.m2.1d">italic_N</annotation></semantics></math>) and performance (large <math alttext="N" class="ltx_Math" display="inline" id="S6.SS4.p1.10.3.m3.1"><semantics id="S6.SS4.p1.10.3.m3.1a"><mi id="S6.SS4.p1.10.3.m3.1.1" mathvariant="normal" xref="S6.SS4.p1.10.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.10.3.m3.1b"><ci id="S6.SS4.p1.10.3.m3.1.1.cmml" xref="S6.SS4.p1.10.3.m3.1.1">N</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.10.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.10.3.m3.1d">italic_N</annotation></semantics></math>).</span></p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.5 </span>Case Study</h3>
<div class="ltx_para" id="S6.SS5.p1">
<p class="ltx_p" id="S6.SS5.p1.1">To gain an insight into the conversational planning capability of <span class="ltx_ERROR undefined" id="S6.SS5.p1.1.1">\method</span>, we provide an analysis on the action strategies of <span class="ltx_ERROR undefined" id="S6.SS5.p1.1.2">\method</span>(Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.SS7" title="F.7 Additional Analysis on Action Strategies ‣ Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">F.7</span></a>) and a case study (Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.F4" title="Figure A4 ‣ F.8 Case Study ‣ Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">A4</span></a>) to show <span class="ltx_ERROR undefined" id="S6.SS5.p1.1.3">\method</span>can strategically take actions that are helpful for information seeking and recommendation success.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.5">We present <span class="ltx_ERROR undefined" id="S7.p1.5.6">\method</span>, a novel MCR framework with strategic and non-myopic conversational planning tactics. <span class="ltx_ERROR undefined" id="S7.p1.5.7">\method</span>adopts a hierarchical action selection process, builds a conversational search tree with MCTS, and selects the high-rewarded conversation plans to train <span class="ltx_text" id="S7.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S7.p1.1.1.m1.1"><semantics id="S7.p1.1.1.m1.1a"><mrow id="S7.p1.1.1.m1.1.1" xref="S7.p1.1.1.m1.1.1.cmml"><mi id="S7.p1.1.1.m1.1.1.2" xref="S7.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="S7.p1.1.1.m1.1.1.1" xref="S7.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S7.p1.1.1.m1.1.1.3" xref="S7.p1.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.1.1.m1.1b"><apply id="S7.p1.1.1.m1.1.1.cmml" xref="S7.p1.1.1.m1.1.1"><times id="S7.p1.1.1.m1.1.1.1.cmml" xref="S7.p1.1.1.m1.1.1.1"></times><ci id="S7.p1.1.1.m1.1.1.2.cmml" xref="S7.p1.1.1.m1.1.1.2">𝚂</ci><ci id="S7.p1.1.1.m1.1.1.3a.cmml" xref="S7.p1.1.1.m1.1.1.3"><mtext id="S7.p1.1.1.m1.1.1.3.cmml" xref="S7.p1.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S7.p1.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span>. During inference, <span class="ltx_text" id="S7.p1.2.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="S7.p1.2.2.m1.1"><semantics id="S7.p1.2.2.m1.1a"><mrow id="S7.p1.2.2.m1.1.1" xref="S7.p1.2.2.m1.1.1.cmml"><mi id="S7.p1.2.2.m1.1.1.2" xref="S7.p1.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="S7.p1.2.2.m1.1.1.1" xref="S7.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="S7.p1.2.2.m1.1.1.3" xref="S7.p1.2.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.2.2.m1.1b"><apply id="S7.p1.2.2.m1.1.1.cmml" xref="S7.p1.2.2.m1.1.1"><times id="S7.p1.2.2.m1.1.1.1.cmml" xref="S7.p1.2.2.m1.1.1.1"></times><ci id="S7.p1.2.2.m1.1.1.2.cmml" xref="S7.p1.2.2.m1.1.1.2">𝚂</ci><ci id="S7.p1.2.2.m1.1.1.3a.cmml" xref="S7.p1.2.2.m1.1.1.3"><mtext id="S7.p1.2.2.m1.1.1.3.cmml" xref="S7.p1.2.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.2.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="S7.p1.2.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> can make well-informed decisions without <span class="ltx_text" id="S7.p1.3.3"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S7.p1.3.3.m1.1"><semantics id="S7.p1.3.3.m1.1a"><mrow id="S7.p1.3.3.m1.1.1" xref="S7.p1.3.3.m1.1.1.cmml"><mi id="S7.p1.3.3.m1.1.1.2" xref="S7.p1.3.3.m1.1.1.2.cmml">𝚂</mi><mo id="S7.p1.3.3.m1.1.1.1" xref="S7.p1.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="S7.p1.3.3.m1.1.1.3" xref="S7.p1.3.3.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.3.3.m1.1b"><apply id="S7.p1.3.3.m1.1.1.cmml" xref="S7.p1.3.3.m1.1.1"><times id="S7.p1.3.3.m1.1.1.1.cmml" xref="S7.p1.3.3.m1.1.1.1"></times><ci id="S7.p1.3.3.m1.1.1.2.cmml" xref="S7.p1.3.3.m1.1.1.2">𝚂</ci><ci id="S7.p1.3.3.m1.1.1.3a.cmml" xref="S7.p1.3.3.m1.1.1.3"><mtext id="S7.p1.3.3.m1.1.1.3.cmml" xref="S7.p1.3.3.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.3.3.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S7.p1.3.3.m1.1d">typewriter_S -planner</annotation></semantics></math></span>, as it inherits <span class="ltx_text" id="S7.p1.4.4"><math alttext="\mathop{\mathtt{S}\text{-planner}}\limits" class="ltx_Math" display="inline" id="S7.p1.4.4.m1.1"><semantics id="S7.p1.4.4.m1.1a"><mrow id="S7.p1.4.4.m1.1.1" xref="S7.p1.4.4.m1.1.1.cmml"><mi id="S7.p1.4.4.m1.1.1.2" xref="S7.p1.4.4.m1.1.1.2.cmml">𝚂</mi><mo id="S7.p1.4.4.m1.1.1.1" xref="S7.p1.4.4.m1.1.1.1.cmml">⁢</mo><mtext id="S7.p1.4.4.m1.1.1.3" xref="S7.p1.4.4.m1.1.1.3a.cmml">-planner</mtext></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.4.4.m1.1b"><apply id="S7.p1.4.4.m1.1.1.cmml" xref="S7.p1.4.4.m1.1.1"><times id="S7.p1.4.4.m1.1.1.1.cmml" xref="S7.p1.4.4.m1.1.1.1"></times><ci id="S7.p1.4.4.m1.1.1.2.cmml" xref="S7.p1.4.4.m1.1.1.2">𝚂</ci><ci id="S7.p1.4.4.m1.1.1.3a.cmml" xref="S7.p1.4.4.m1.1.1.3"><mtext id="S7.p1.4.4.m1.1.1.3.cmml" xref="S7.p1.4.4.m1.1.1.3">-planner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.4.4.m1.1c">\mathop{\mathtt{S}\text{-planner}}\limits</annotation><annotation encoding="application/x-llamapun" id="S7.p1.4.4.m1.1d">typewriter_S -planner</annotation></semantics></math></span>’s expertise in strategic planning. Furthermore, we develop a variant <span class="ltx_text" id="S7.p1.5.5"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="S7.p1.5.5.m1.1"><semantics id="S7.p1.5.5.m1.1a"><mrow id="S7.p1.5.5.m1.1.1" xref="S7.p1.5.5.m1.1.1.cmml"><mi id="S7.p1.5.5.m1.1.1.2" xref="S7.p1.5.5.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="S7.p1.5.5.m1.1.1.1" xref="S7.p1.5.5.m1.1.1.1.cmml">⁢</mo><mtext id="S7.p1.5.5.m1.1.1.3" xref="S7.p1.5.5.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.5.5.m1.1b"><apply id="S7.p1.5.5.m1.1.1.cmml" xref="S7.p1.5.5.m1.1.1"><times id="S7.p1.5.5.m1.1.1.1.cmml" xref="S7.p1.5.5.m1.1.1.1"></times><ci id="S7.p1.5.5.m1.1.1.2.cmml" xref="S7.p1.5.5.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="S7.p1.5.5.m1.1.1.3a.cmml" xref="S7.p1.5.5.m1.1.1.3"><mtext id="S7.p1.5.5.m1.1.1.3.cmml" xref="S7.p1.5.5.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.5.5.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="S7.p1.5.5.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> to address the efficiency issue with MCTS. Extensive experiments on benchmark datasets verify the effectiveness of our framework.</p>
</div>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Limitations</h2>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.2">First, our framework only supports searching over two types of actions (<math alttext="\mathtt{ask}" class="ltx_Math" display="inline" id="S8.p1.1.m1.1"><semantics id="S8.p1.1.m1.1a"><mi id="S8.p1.1.m1.1.1" xref="S8.p1.1.m1.1.1.cmml">𝚊𝚜𝚔</mi><annotation-xml encoding="MathML-Content" id="S8.p1.1.m1.1b"><ci id="S8.p1.1.m1.1.1.cmml" xref="S8.p1.1.m1.1.1">𝚊𝚜𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.1.m1.1c">\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="S8.p1.1.m1.1d">typewriter_ask</annotation></semantics></math> and <math alttext="\mathtt{rec}" class="ltx_Math" display="inline" id="S8.p1.2.m2.1"><semantics id="S8.p1.2.m2.1a"><mi id="S8.p1.2.m2.1.1" xref="S8.p1.2.m2.1.1.cmml">𝚛𝚎𝚌</mi><annotation-xml encoding="MathML-Content" id="S8.p1.2.m2.1b"><ci id="S8.p1.2.m2.1.1.cmml" xref="S8.p1.2.m2.1.1">𝚛𝚎𝚌</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.2.m2.1c">\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="S8.p1.2.m2.1d">typewriter_rec</annotation></semantics></math>) so far, which cannot search at a more fine-grained level (e.g., defining action types as “recommending items with a five-star rating”, “recommending items with a three-star rating”, rather than just “recommending items”). For future work, we plan to adopt advanced action abstraction techniques <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib2" title="">2016</a>)</cite> to divide the search space at more fine-grained levels.
Second, training <span class="ltx_ERROR undefined" id="S8.p1.2.1">\method</span>requires conducting multiple simulated rollouts for each user, which introduces additional computational cost compared with existing methods. For future work, we plan to further improve the training efficiency of <span class="ltx_ERROR undefined" id="S8.p1.2.2">\method</span>by adopting parallel acceleration methods <cite class="ltx_cite ltx_citemacro_cite">Chaslot et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib6" title="">2008</a>)</cite> for MCTS.
Third, while the user simulator approach can provide high quality simulations for the conversation <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib26" title="">2020a</a>); Zhang and Balog (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib49" title="">2020</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>)</cite>, it may not fully represent the dynamics and complexities of user behaviors in the real-world situations. This issue may be partially addressed by developing an LLM-based user simulator that fully utilizes the human-likeliness of LLMs to better simulate user behaviors in the conversation for future work.</p>
</div>
<div class="ltx_para" id="S8.p2">
<p class="ltx_p" id="S8.p2.1">While it is our aspiration that CRS can provide personalized and user-friendly recommendations if correctly deployed, we also acknowledge that unintended uses of CRS may pose concerns on fairness and bias issues <cite class="ltx_cite ltx_citemacro_cite">Shen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib38" title="">2022</a>)</cite>, which may be a potential risk for CRS but can be mitigated with debiasing algorithms as in the literature <cite class="ltx_cite ltx_citemacro_cite">Fu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib12" title="">2021</a>); Lin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib29" title="">2022</a>)</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S9">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9 </span>Ethics Statement</h2>
<div class="ltx_para" id="S9.p1">
<p class="ltx_p" id="S9.p1.1">All datasets used in this research are from public benchmark open-access datasets, which are anonymized and do not pose privacy concerns.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anthony et al. (2017)</span>
<span class="ltx_bibblock">
Thomas Anthony, Zheng Tian, and David Barber. 2017.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/d8e1344e27a5b08cdfd5d027d9b8d6de-Paper.pdf" title="">Thinking fast and slow with deep learning and tree search</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Advances in Neural Information Processing Systems</em>, volume 30.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2016)</span>
<span class="ltx_bibblock">
Aijun Bai, Siddharth Srivastava, and Stuart Russell. 2016.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://www.ijcai.org/Proceedings/16/Papers/430.pdf" title="">Markovian state and action abstractions for MDPs via hierarchical MCTS</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the Twenty-Fifth International Joint Conference on Artificial Intelligence</em>, page 3029–3037.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bellman (1957)</span>
<span class="ltx_bibblock">
Richard Bellman. 1957.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://www.jstor.org/stable/24900506" title="">A Markovian decision process</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Journal of Mathematics and Mechanics</em>, pages 679–684.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bordes et al. (2013)</span>
<span class="ltx_bibblock">
Antoine Bordes, Nicolas Usunier, Alberto Garcia-Duran, Jason Weston, and Oksana Yakhnenko. 2013.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper_files/paper/2013/file/1cecc7a77928ca8133fa24680a88d2f9-Paper.pdf" title="">Translating embeddings for modeling multi-relational data</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Advances in Neural Information Processing Systems</em>, volume 26.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brody et al. (2022)</span>
<span class="ltx_bibblock">
Shaked Brody, Uri Alon, and Eran Yahav. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=F72ximsx7C1" title="">How attentive are graph attention networks?</a>
</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chaslot et al. (2008)</span>
<span class="ltx_bibblock">
Guillaume MJ B Chaslot, Mark HM Winands, and H Jaap van Den Herik. 2008.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://link.springer.com/chapter/10.1007/978-3-540-87608-3_6" title="">Parallel Monte-Carlo tree search</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Computers and Games: 6th International Conference, CG 2008, Beijing, China, September 29-October 1, 2008. Proceedings 6</em>, pages 60–71. Springer.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2019)</span>
<span class="ltx_bibblock">
Haokun Chen, Xinyi Dai, Han Cai, Weinan Zhang, Xuejian Wang, Ruiming Tang, Yuzhou Zhang, and Yong Yu. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1609/aaai.v33i01.33013312" title="">Large-scale interactive recommendation with tree-structured policy gradient</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the Thirty-Third AAAI Conference on Artificial Intelligence and Thirty-First Innovative Applications of Artificial Intelligence Conference and Ninth AAAI Symposium on Educational Advances in Artificial Intelligence</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Christakopoulou et al. (2016)</span>
<span class="ltx_bibblock">
Konstantina Christakopoulou, Filip Radlinski, and Katja Hofmann. 2016.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/2939672.2939746" title="">Towards conversational recommender systems</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>, pages 815–824.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohen et al. (2022)</span>
<span class="ltx_bibblock">
Deborah Cohen, Moonkyung Ryu, Yinlam Chow, Orgad Keller, Ido Greenberg, Avinatan Hassidim, Michael Fink, Yossi Matias, Idan Szpektor, Craig Boutilier, et al. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2208.02294" title="">Dynamic planning in open-ended dialogue using reinforcement learning</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2208.02294</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Coulom (2007)</span>
<span class="ltx_bibblock">
Rémi Coulom. 2007.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://link.springer.com/chapter/10.1007/978-3-540-75538-8_7" title="">Efficient selectivity and backup operators in Monte-Carlo tree search</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">International Conference on Computers and Games</em>, pages 72–83. Springer.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2021)</span>
<span class="ltx_bibblock">
Yang Deng, Yaliang Li, Fei Sun, Bolin Ding, and Wai Lam. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3404835.3462913" title="">Unified conversational recommendation policy learning via graph-based reinforcement learning</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the 44th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, pages 1431–1441.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al. (2021)</span>
<span class="ltx_bibblock">
Zuohui Fu, Yikun Xian, Shijie Geng, Gerard De Melo, and Yongfeng Zhang. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://dl.acm.org/doi/abs/10.1145/3459637.3482461" title="">Popcorn: Human-in-the-loop popularity debiasing in conversational recommender systems</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 30th ACM International Conference on Information &amp; Knowledge Management</em>, pages 494–503.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al. (2020)</span>
<span class="ltx_bibblock">
Zuohui Fu, Yikun Xian, Yongfeng Zhang, and Yi Zhang. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3383313.3411548" title="">Tutorial on conversational recommendation systems</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the 14th ACM Conference on Recommender Systems</em>, pages 751–753.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2018)</span>
<span class="ltx_bibblock">
Xu Han, Shulin Cao, Xin Lv, Yankai Lin, Zhiyuan Liu, Maosong Sun, and Juanzi Li. 2018.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/D18-2024/" title="">OpenKE: An open toolkit for knowledge embedding</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing: System Demonstrations</em>, pages 139–144.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harper and Konstan (2015)</span>
<span class="ltx_bibblock">
F Maxwell Harper and Joseph A Konstan. 2015.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://dl.acm.org/doi/abs/10.1145/2827872" title="">The movielens datasets: History and context</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Acm Transactions on Interactive Intelligent Systems (TIIS)</em>, 5(4):1–19.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and McAuley (2016)</span>
<span class="ltx_bibblock">
Ruining He and Julian McAuley. 2016.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://dl.acm.org/doi/abs/10.1145/2872427.2883037" title="">Ups and downs: Modeling the visual evolution of fashion trends with one-class collaborative filtering</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 25th International Conference on World Wide Web</em>, pages 507–517.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2024)</span>
<span class="ltx_bibblock">
Tao He, Lizi Liao, Yixin Cao, Yuanxing Liu, Ming Liu, Zerui Chen, and Bing Qin. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/2024.acl-long.262" title="">Planning like human: A dual-process framework for dialogue planning</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 62nd Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 4768–4791.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2023)</span>
<span class="ltx_bibblock">
Zhankui He, Zhouhang Xie, Rahul Jha, Harald Steck, Dawen Liang, Yesu Feng, Bodhisattwa Prasad Majumder, Nathan Kallus, and Julian Mcauley. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3583780.3614949" title="">Large language models as zero-shot conversational recommenders</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 32nd ACM International Conference on Information and Knowledge Management</em>, page 720–730.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jannach et al. (2021)</span>
<span class="ltx_bibblock">
Dietmar Jannach, Ahtsham Manzoor, Wanling Cai, and Li Chen. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3453154" title="">A survey on conversational recommender systems</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">ACM Computing Surveys (CSUR)</em>, 54(5):1–36.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al. (2023)</span>
<span class="ltx_bibblock">
Jiarui Jin, Xianyu Chen, Fanghua Ye, Mengyue Yang, Yue Feng, Weinan Zhang, Yong Yu, and Jun Wang. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper_files/paper/2023/file/58cd3b02902d79aea4b3b603fb0d0941-Paper-Conference.pdf" title="">Lending interaction wings to recommender systems with conversational agents</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Advances in Neural Information Processing Systems</em>, volume 36, pages 27951–27979.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2015)</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba. 2015.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/1412.6980" title="">Adam: A method for stochastic optimization</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kipf and Welling (2016)</span>
<span class="ltx_bibblock">
Thomas N Kipf and Max Welling. 2016.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=SJU4ayYgl" title="">Semi-supervised classification with graph convolutional networks</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kocsis and Szepesvári (2006)</span>
<span class="ltx_bibblock">
Levente Kocsis and Csaba Szepesvári. 2006.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://link.springer.com/chapter/10.1007/11871842_29" title="">Bandit based Monte-Carlo planning</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">European Conference on Machine Learning</em>, pages 282–293. Springer.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. (2019)</span>
<span class="ltx_bibblock">
Aviral Kumar, Justin Fu, Matthew Soh, George Tucker, and Sergey Levine. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper/2019/hash/c2073ffa77b5357a498057413bb09d3a-Abstract.html" title="">Stabilizing off-policy Q-learning via bootstrapping error reduction</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Advances in Neural Information Processing Systems</em>, volume 32.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lan et al. (2020)</span>
<span class="ltx_bibblock">
Qingfeng Lan, Yangchen Pan, Alona Fyshe, and Martha White. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=Bkg0u3Etwr" title="">Maxmin Q-learning: Controlling the estimation bias of Q-learning</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lei et al. (2020a)</span>
<span class="ltx_bibblock">
Wenqiang Lei, Xiangnan He, Maarten de Rijke, and Tat-Seng Chua. 2020a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3397271.3401419" title="">Conversational recommendation: Formulation, methods, and evaluation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, pages 2425–2428.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lei et al. (2020b)</span>
<span class="ltx_bibblock">
Wenqiang Lei, Xiangnan He, Yisong Miao, Qingyun Wu, Richang Hong, Min-Yen Kan, and Tat-Seng Chua. 2020b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3336191.3371769" title="">Estimation-action-reflection: Towards deep interaction between conversational and recommender systems</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the 13th International Conference on Web Search and Data Mining</em>, pages 304–312.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lei et al. (2020c)</span>
<span class="ltx_bibblock">
Wenqiang Lei, Gangyi Zhang, Xiangnan He, Yisong Miao, Xiang Wang, Liang Chen, and Tat-Seng Chua. 2020c.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3394486.3403258" title="">Interactive path reasoning on graph for conversational recommendation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>, pages 2073–2083.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2022)</span>
<span class="ltx_bibblock">
Allen Lin, Jianling Wang, Ziwei Zhu, and James Caverlee. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3511808.3557423" title="">Quantifying and mitigating popularity bias in conversational recommender systems</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the 31st ACM international conference on information &amp; knowledge management</em>, pages 1238–1247.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luce (1959)</span>
<span class="ltx_bibblock">
R Duncan Luce. 1959.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Individual choice behavior</em>, volume 4.

</span>
<span class="ltx_bibblock">Wiley New York.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McAuley et al. (2015)</span>
<span class="ltx_bibblock">
Julian McAuley, Christopher Targett, Qinfeng Shi, and Anton Van Den Hengel. 2015.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://dl.acm.org/doi/abs/10.1145/2766462.2767755" title="">Image-based recommendations on styles and substitutes</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 38th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, pages 43–52.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mnih et al. (2015)</span>
<span class="ltx_bibblock">
Volodymyr Mnih, Koray Kavukcuoglu, David Silver, Andrei A Rusu, Joel Veness, Marc G Bellemare, Alex Graves, Martin Riedmiller, Andreas K Fidjeland, Georg Ostrovski, et al. 2015.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://www.nature.com/articles/nature14236" title="">Human-level control through deep reinforcement learning</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Nature</em>, 518(7540):529–533.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Montazeralghaem et al. (2021)</span>
<span class="ltx_bibblock">
Ali Montazeralghaem, James Allan, and Philip S. Thomas. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3460231.3474271" title="">Large-scale interactive conversational recommendation system using actor-critic framework</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 15th ACM Conference on Recommender Systems</em>, page 220–229.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nachum et al. (2018)</span>
<span class="ltx_bibblock">
Ofir Nachum, Shixiang (Shane) Gu, Honglak Lee, and Sergey Levine. 2018.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper_files/paper/2018/file/e6384711491713d29bc63fc5eeb5ba4f-Paper.pdf" title="">Data-efficient hierarchical reinforcement learning</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Advances in Neural Information Processing Systems</em>, volume 31.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Plackett (1975)</span>
<span class="ltx_bibblock">
Robin L Plackett. 1975.

</span>
<span class="ltx_bibblock">The analysis of permutations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Journal of the Royal Statistical Society Series C: Applied Statistics</em>, 24(2):193–202.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qian et al. (2023)</span>
<span class="ltx_bibblock">
Mingjie Qian, Yongsen Zheng, Jinghui Qin, and Liang Lin. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/2023.emnlp-main.635" title="">HutCRS: Hierarchical user-interest tracking for conversational recommender system</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 10281–10290. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schaul et al. (2016)</span>
<span class="ltx_bibblock">
Tom Schaul, John Quan, Ioannis Antonoglou, and David Silver. 2016.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1511.05952" title="">Prioritized experience replay</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. (2022)</span>
<span class="ltx_bibblock">
Tianshu Shen, Jiaru Li, Mohamed Reda Bouadjenek, Zheda Mai, and Scott Sanner. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2201.06224" title="">Unintended bias in language model-driven conversational recommendation</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2201.06224</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Silver et al. (2016)</span>
<span class="ltx_bibblock">
David Silver, Aja Huang, Chris J Maddison, Arthur Guez, Laurent Sifre, George Van Den Driessche, Julian Schrittwieser, Ioannis Antonoglou, Veda Panneershelvam, Marc Lanctot, et al. 2016.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://www.nature.com/articles/nature16961" title="">Mastering the game of Go with deep neural networks and tree search</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Nature</em>, 529(7587):484–489.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Silver et al. (2017)</span>
<span class="ltx_bibblock">
David Silver, Julian Schrittwieser, Karen Simonyan, Ioannis Antonoglou, Aja Huang, Arthur Guez, Thomas Hubert, Lucas Baker, Matthew Lai, Adrian Bolton, et al. 2017.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://www.nature.com/articles/nature24270" title="">Mastering the game of Go without human knowledge</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Nature</em>, 550(7676):354–359.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun and Zhang (2018)</span>
<span class="ltx_bibblock">
Yueming Sun and Yi Zhang. 2018.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3209978.3210002" title="">Conversational recommender system</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">The 41st International ACM SIGIR Conference on Research &amp; Development in Information Retrieval</em>, pages 235–244.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutton (1988)</span>
<span class="ltx_bibblock">
Richard S Sutton. 1988.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://link.springer.com/article/10.1007/bf00115009" title="">Learning to predict by the methods of temporal differences</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Machine learning</em>, 3:9–44.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van Hasselt et al. (2016)</span>
<span class="ltx_bibblock">
Hado van Hasselt, Arthur Guez, and David Silver. 2016.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://ojs.aaai.org/index.php/AAAI/article/view/10295" title="">Deep reinforcement learning with double Q-learning</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the Thirtieth AAAI Conference on Artificial Intelligence</em>, volume 30, page 2094–2100.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf" title="">Attention is all you need</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Advances in Neural Information Processing Systems</em>, volume 30.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Veličković et al. (2018)</span>
<span class="ltx_bibblock">
Petar Veličković, Guillem Cucurull, Arantxa Casanova, Adriana Romero, Pietro Liò, and Yoshua Bengio. 2018.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=rJXMpikCZ" title="">Graph attention networks</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Xiang Wang, Xiangnan He, Yixin Cao, Meng Liu, and Tat-Seng Chua. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://dl.acm.org/doi/abs/10.1145/3292500.3330989" title="">KGAT: Knowledge graph attention network for recommendation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>, pages 950–958.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2016)</span>
<span class="ltx_bibblock">
Ziyu Wang, Tom Schaul, Matteo Hessel, Hado Hasselt, Marc Lanctot, and Nando Freitas. 2016.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.mlr.press/v48/wangf16.html" title="">Dueling network architectures for deep reinforcement learning</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Proceedings of The 33rd International Conference on Machine Learning</em>, volume 48, pages 1995–2003. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2023)</span>
<span class="ltx_bibblock">
Xiao Yu, Maximillian Chen, and Zhou Yu. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/2023.emnlp-main.439" title="">Prompt-based Monte-Carlo tree search for goal-oriented dialogue policy planning</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 7101–7125.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Balog (2020)</span>
<span class="ltx_bibblock">
Shuo Zhang and Krisztian Balog. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3394486.3403202" title="">Evaluating conversational recommender systems via user simulation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Proceedings of the 26th acm sigkdd international conference on knowledge discovery &amp; data mining</em>, pages 1512–1520.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Yiming Zhang, Lingfei Wu, Qi Shen, Yitong Pang, Zhihua Wei, Fangli Xu, Bo Long, and Jian Pei. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3485447.3512088" title="">Multiple choice questions based multi-interest policy learning for conversational recommendation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Proceedings of the ACM Web Conference 2022</em>, pages 2153–2162.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2023)</span>
<span class="ltx_bibblock">
Sen Zhao, Wei Wei, Xian-Ling Mao, Shuai Zhu, Minghui Yang, Zujie Wen, Dangyang Chen, and Feida Zhu. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://dl.acm.org/doi/abs/10.1145/3539618.3591737" title="">Multi-view hypergraph contrastive policy learning for conversational recommendation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, pages 654–664.

</span>
</li>
</ul>
</section>
<figure class="ltx_table" id="A0.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A0.T1.47">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A0.T1.47.48.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A0.T1.47.48.1.1" style="padding:-1.5pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="A0.T1.47.48.1.1.1">Notation</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A0.T1.47.48.1.2" style="padding:-1.5pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="A0.T1.47.48.1.2.1">Description</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A0.T1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A0.T1.1.1.1" style="padding:-1.5pt 2.0pt;"><math alttext="\mathcal{U},\mathcal{V},\mathcal{Y},\mathcal{P}" class="ltx_Math" display="inline" id="A0.T1.1.1.1.m1.4"><semantics id="A0.T1.1.1.1.m1.4a"><mrow id="A0.T1.1.1.1.m1.4.5.2" xref="A0.T1.1.1.1.m1.4.5.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A0.T1.1.1.1.m1.1.1" xref="A0.T1.1.1.1.m1.1.1.cmml">𝒰</mi><mo id="A0.T1.1.1.1.m1.4.5.2.1" xref="A0.T1.1.1.1.m1.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A0.T1.1.1.1.m1.2.2" xref="A0.T1.1.1.1.m1.2.2.cmml">𝒱</mi><mo id="A0.T1.1.1.1.m1.4.5.2.2" xref="A0.T1.1.1.1.m1.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A0.T1.1.1.1.m1.3.3" xref="A0.T1.1.1.1.m1.3.3.cmml">𝒴</mi><mo id="A0.T1.1.1.1.m1.4.5.2.3" xref="A0.T1.1.1.1.m1.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A0.T1.1.1.1.m1.4.4" xref="A0.T1.1.1.1.m1.4.4.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.1.1.1.m1.4b"><list id="A0.T1.1.1.1.m1.4.5.1.cmml" xref="A0.T1.1.1.1.m1.4.5.2"><ci id="A0.T1.1.1.1.m1.1.1.cmml" xref="A0.T1.1.1.1.m1.1.1">𝒰</ci><ci id="A0.T1.1.1.1.m1.2.2.cmml" xref="A0.T1.1.1.1.m1.2.2">𝒱</ci><ci id="A0.T1.1.1.1.m1.3.3.cmml" xref="A0.T1.1.1.1.m1.3.3">𝒴</ci><ci id="A0.T1.1.1.1.m1.4.4.cmml" xref="A0.T1.1.1.1.m1.4.4">𝒫</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.1.1.1.m1.4c">\mathcal{U},\mathcal{V},\mathcal{Y},\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.1.1.1.m1.4d">caligraphic_U , caligraphic_V , caligraphic_Y , caligraphic_P</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A0.T1.1.1.2" style="padding:-1.5pt 2.0pt;">the set of users, items, attribute types and attribute values</td>
</tr>
<tr class="ltx_tr" id="A0.T1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.2.2.1" style="padding:-1.5pt 2.0pt;"><math alttext="u,v,y,p" class="ltx_Math" display="inline" id="A0.T1.2.2.1.m1.4"><semantics id="A0.T1.2.2.1.m1.4a"><mrow id="A0.T1.2.2.1.m1.4.5.2" xref="A0.T1.2.2.1.m1.4.5.1.cmml"><mi id="A0.T1.2.2.1.m1.1.1" xref="A0.T1.2.2.1.m1.1.1.cmml">u</mi><mo id="A0.T1.2.2.1.m1.4.5.2.1" xref="A0.T1.2.2.1.m1.4.5.1.cmml">,</mo><mi id="A0.T1.2.2.1.m1.2.2" xref="A0.T1.2.2.1.m1.2.2.cmml">v</mi><mo id="A0.T1.2.2.1.m1.4.5.2.2" xref="A0.T1.2.2.1.m1.4.5.1.cmml">,</mo><mi id="A0.T1.2.2.1.m1.3.3" xref="A0.T1.2.2.1.m1.3.3.cmml">y</mi><mo id="A0.T1.2.2.1.m1.4.5.2.3" xref="A0.T1.2.2.1.m1.4.5.1.cmml">,</mo><mi id="A0.T1.2.2.1.m1.4.4" xref="A0.T1.2.2.1.m1.4.4.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.2.2.1.m1.4b"><list id="A0.T1.2.2.1.m1.4.5.1.cmml" xref="A0.T1.2.2.1.m1.4.5.2"><ci id="A0.T1.2.2.1.m1.1.1.cmml" xref="A0.T1.2.2.1.m1.1.1">𝑢</ci><ci id="A0.T1.2.2.1.m1.2.2.cmml" xref="A0.T1.2.2.1.m1.2.2">𝑣</ci><ci id="A0.T1.2.2.1.m1.3.3.cmml" xref="A0.T1.2.2.1.m1.3.3">𝑦</ci><ci id="A0.T1.2.2.1.m1.4.4.cmml" xref="A0.T1.2.2.1.m1.4.4">𝑝</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.2.2.1.m1.4c">u,v,y,p</annotation><annotation encoding="application/x-llamapun" id="A0.T1.2.2.1.m1.4d">italic_u , italic_v , italic_y , italic_p</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.2.2.2" style="padding:-1.5pt 2.0pt;">the index of user, item, attribute type and attribute value</td>
</tr>
<tr class="ltx_tr" id="A0.T1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.3.3.1" style="padding:-1.5pt 2.0pt;"><math alttext="t,T" class="ltx_Math" display="inline" id="A0.T1.3.3.1.m1.2"><semantics id="A0.T1.3.3.1.m1.2a"><mrow id="A0.T1.3.3.1.m1.2.3.2" xref="A0.T1.3.3.1.m1.2.3.1.cmml"><mi id="A0.T1.3.3.1.m1.1.1" xref="A0.T1.3.3.1.m1.1.1.cmml">t</mi><mo id="A0.T1.3.3.1.m1.2.3.2.1" xref="A0.T1.3.3.1.m1.2.3.1.cmml">,</mo><mi id="A0.T1.3.3.1.m1.2.2" xref="A0.T1.3.3.1.m1.2.2.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.3.3.1.m1.2b"><list id="A0.T1.3.3.1.m1.2.3.1.cmml" xref="A0.T1.3.3.1.m1.2.3.2"><ci id="A0.T1.3.3.1.m1.1.1.cmml" xref="A0.T1.3.3.1.m1.1.1">𝑡</ci><ci id="A0.T1.3.3.1.m1.2.2.cmml" xref="A0.T1.3.3.1.m1.2.2">𝑇</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.3.3.1.m1.2c">t,T</annotation><annotation encoding="application/x-llamapun" id="A0.T1.3.3.1.m1.2d">italic_t , italic_T</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.3.3.2" style="padding:-1.5pt 2.0pt;">the index of the current turn and the final turn of the conversation</td>
</tr>
<tr class="ltx_tr" id="A0.T1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.4.4.1" style="padding:-1.5pt 2.0pt;"><math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="A0.T1.4.4.1.m1.1"><semantics id="A0.T1.4.4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A0.T1.4.4.1.m1.1.1" xref="A0.T1.4.4.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="A0.T1.4.4.1.m1.1b"><ci id="A0.T1.4.4.1.m1.1.1.cmml" xref="A0.T1.4.4.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.4.4.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.4.4.1.m1.1d">caligraphic_G</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.4.4.2" style="padding:-1.5pt 2.0pt;">the global information graph</td>
</tr>
<tr class="ltx_tr" id="A0.T1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.5.5.1" style="padding:-1.5pt 2.0pt;"><math alttext="\mathcal{G}^{+}_{t},\mathcal{G}^{-}_{t}" class="ltx_Math" display="inline" id="A0.T1.5.5.1.m1.2"><semantics id="A0.T1.5.5.1.m1.2a"><mrow id="A0.T1.5.5.1.m1.2.2.2" xref="A0.T1.5.5.1.m1.2.2.3.cmml"><msubsup id="A0.T1.5.5.1.m1.1.1.1.1" xref="A0.T1.5.5.1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A0.T1.5.5.1.m1.1.1.1.1.2.2" xref="A0.T1.5.5.1.m1.1.1.1.1.2.2.cmml">𝒢</mi><mi id="A0.T1.5.5.1.m1.1.1.1.1.3" xref="A0.T1.5.5.1.m1.1.1.1.1.3.cmml">t</mi><mo id="A0.T1.5.5.1.m1.1.1.1.1.2.3" xref="A0.T1.5.5.1.m1.1.1.1.1.2.3.cmml">+</mo></msubsup><mo id="A0.T1.5.5.1.m1.2.2.2.3" xref="A0.T1.5.5.1.m1.2.2.3.cmml">,</mo><msubsup id="A0.T1.5.5.1.m1.2.2.2.2" xref="A0.T1.5.5.1.m1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A0.T1.5.5.1.m1.2.2.2.2.2.2" xref="A0.T1.5.5.1.m1.2.2.2.2.2.2.cmml">𝒢</mi><mi id="A0.T1.5.5.1.m1.2.2.2.2.3" xref="A0.T1.5.5.1.m1.2.2.2.2.3.cmml">t</mi><mo id="A0.T1.5.5.1.m1.2.2.2.2.2.3" xref="A0.T1.5.5.1.m1.2.2.2.2.2.3.cmml">−</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.5.5.1.m1.2b"><list id="A0.T1.5.5.1.m1.2.2.3.cmml" xref="A0.T1.5.5.1.m1.2.2.2"><apply id="A0.T1.5.5.1.m1.1.1.1.1.cmml" xref="A0.T1.5.5.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.5.5.1.m1.1.1.1.1.1.cmml" xref="A0.T1.5.5.1.m1.1.1.1.1">subscript</csymbol><apply id="A0.T1.5.5.1.m1.1.1.1.1.2.cmml" xref="A0.T1.5.5.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.5.5.1.m1.1.1.1.1.2.1.cmml" xref="A0.T1.5.5.1.m1.1.1.1.1">superscript</csymbol><ci id="A0.T1.5.5.1.m1.1.1.1.1.2.2.cmml" xref="A0.T1.5.5.1.m1.1.1.1.1.2.2">𝒢</ci><plus id="A0.T1.5.5.1.m1.1.1.1.1.2.3.cmml" xref="A0.T1.5.5.1.m1.1.1.1.1.2.3"></plus></apply><ci id="A0.T1.5.5.1.m1.1.1.1.1.3.cmml" xref="A0.T1.5.5.1.m1.1.1.1.1.3">𝑡</ci></apply><apply id="A0.T1.5.5.1.m1.2.2.2.2.cmml" xref="A0.T1.5.5.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A0.T1.5.5.1.m1.2.2.2.2.1.cmml" xref="A0.T1.5.5.1.m1.2.2.2.2">subscript</csymbol><apply id="A0.T1.5.5.1.m1.2.2.2.2.2.cmml" xref="A0.T1.5.5.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A0.T1.5.5.1.m1.2.2.2.2.2.1.cmml" xref="A0.T1.5.5.1.m1.2.2.2.2">superscript</csymbol><ci id="A0.T1.5.5.1.m1.2.2.2.2.2.2.cmml" xref="A0.T1.5.5.1.m1.2.2.2.2.2.2">𝒢</ci><minus id="A0.T1.5.5.1.m1.2.2.2.2.2.3.cmml" xref="A0.T1.5.5.1.m1.2.2.2.2.2.3"></minus></apply><ci id="A0.T1.5.5.1.m1.2.2.2.2.3.cmml" xref="A0.T1.5.5.1.m1.2.2.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.5.5.1.m1.2c">\mathcal{G}^{+}_{t},\mathcal{G}^{-}_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.5.5.1.m1.2d">caligraphic_G start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_G start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.6.6.2" style="padding:-1.5pt 2.0pt;">the user’s positive feedback graph and negative feedback graph at the <math alttext="t" class="ltx_Math" display="inline" id="A0.T1.6.6.2.m1.1"><semantics id="A0.T1.6.6.2.m1.1a"><mi id="A0.T1.6.6.2.m1.1.1" xref="A0.T1.6.6.2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A0.T1.6.6.2.m1.1b"><ci id="A0.T1.6.6.2.m1.1.1.cmml" xref="A0.T1.6.6.2.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.6.6.2.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="A0.T1.6.6.2.m1.1d">italic_t</annotation></semantics></math>-th turn</td>
</tr>
<tr class="ltx_tr" id="A0.T1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.7.7.1" style="padding:-1.5pt 2.0pt;"><math alttext="\mathcal{M}(u)" class="ltx_Math" display="inline" id="A0.T1.7.7.1.m1.1"><semantics id="A0.T1.7.7.1.m1.1a"><mrow id="A0.T1.7.7.1.m1.1.2" xref="A0.T1.7.7.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A0.T1.7.7.1.m1.1.2.2" xref="A0.T1.7.7.1.m1.1.2.2.cmml">ℳ</mi><mo id="A0.T1.7.7.1.m1.1.2.1" xref="A0.T1.7.7.1.m1.1.2.1.cmml">⁢</mo><mrow id="A0.T1.7.7.1.m1.1.2.3.2" xref="A0.T1.7.7.1.m1.1.2.cmml"><mo id="A0.T1.7.7.1.m1.1.2.3.2.1" stretchy="false" xref="A0.T1.7.7.1.m1.1.2.cmml">(</mo><mi id="A0.T1.7.7.1.m1.1.1" xref="A0.T1.7.7.1.m1.1.1.cmml">u</mi><mo id="A0.T1.7.7.1.m1.1.2.3.2.2" stretchy="false" xref="A0.T1.7.7.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.7.7.1.m1.1b"><apply id="A0.T1.7.7.1.m1.1.2.cmml" xref="A0.T1.7.7.1.m1.1.2"><times id="A0.T1.7.7.1.m1.1.2.1.cmml" xref="A0.T1.7.7.1.m1.1.2.1"></times><ci id="A0.T1.7.7.1.m1.1.2.2.cmml" xref="A0.T1.7.7.1.m1.1.2.2">ℳ</ci><ci id="A0.T1.7.7.1.m1.1.1.cmml" xref="A0.T1.7.7.1.m1.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.7.7.1.m1.1c">\mathcal{M}(u)</annotation><annotation encoding="application/x-llamapun" id="A0.T1.7.7.1.m1.1d">caligraphic_M ( italic_u )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.8.8.2" style="padding:-1.5pt 2.0pt;">the MDP environment for user <math alttext="u" class="ltx_Math" display="inline" id="A0.T1.8.8.2.m1.1"><semantics id="A0.T1.8.8.2.m1.1a"><mi id="A0.T1.8.8.2.m1.1.1" xref="A0.T1.8.8.2.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A0.T1.8.8.2.m1.1b"><ci id="A0.T1.8.8.2.m1.1.1.cmml" xref="A0.T1.8.8.2.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.8.8.2.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="A0.T1.8.8.2.m1.1d">italic_u</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A0.T1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.9.9.1" style="padding:-1.5pt 2.0pt;"><math alttext="\mathcal{S},\mathcal{A},\mathcal{T},\mathcal{R},\gamma" class="ltx_Math" display="inline" id="A0.T1.9.9.1.m1.5"><semantics id="A0.T1.9.9.1.m1.5a"><mrow id="A0.T1.9.9.1.m1.5.6.2" xref="A0.T1.9.9.1.m1.5.6.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A0.T1.9.9.1.m1.1.1" xref="A0.T1.9.9.1.m1.1.1.cmml">𝒮</mi><mo id="A0.T1.9.9.1.m1.5.6.2.1" xref="A0.T1.9.9.1.m1.5.6.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A0.T1.9.9.1.m1.2.2" xref="A0.T1.9.9.1.m1.2.2.cmml">𝒜</mi><mo id="A0.T1.9.9.1.m1.5.6.2.2" xref="A0.T1.9.9.1.m1.5.6.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A0.T1.9.9.1.m1.3.3" xref="A0.T1.9.9.1.m1.3.3.cmml">𝒯</mi><mo id="A0.T1.9.9.1.m1.5.6.2.3" xref="A0.T1.9.9.1.m1.5.6.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A0.T1.9.9.1.m1.4.4" xref="A0.T1.9.9.1.m1.4.4.cmml">ℛ</mi><mo id="A0.T1.9.9.1.m1.5.6.2.4" xref="A0.T1.9.9.1.m1.5.6.1.cmml">,</mo><mi id="A0.T1.9.9.1.m1.5.5" xref="A0.T1.9.9.1.m1.5.5.cmml">γ</mi></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.9.9.1.m1.5b"><list id="A0.T1.9.9.1.m1.5.6.1.cmml" xref="A0.T1.9.9.1.m1.5.6.2"><ci id="A0.T1.9.9.1.m1.1.1.cmml" xref="A0.T1.9.9.1.m1.1.1">𝒮</ci><ci id="A0.T1.9.9.1.m1.2.2.cmml" xref="A0.T1.9.9.1.m1.2.2">𝒜</ci><ci id="A0.T1.9.9.1.m1.3.3.cmml" xref="A0.T1.9.9.1.m1.3.3">𝒯</ci><ci id="A0.T1.9.9.1.m1.4.4.cmml" xref="A0.T1.9.9.1.m1.4.4">ℛ</ci><ci id="A0.T1.9.9.1.m1.5.5.cmml" xref="A0.T1.9.9.1.m1.5.5">𝛾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.9.9.1.m1.5c">\mathcal{S},\mathcal{A},\mathcal{T},\mathcal{R},\gamma</annotation><annotation encoding="application/x-llamapun" id="A0.T1.9.9.1.m1.5d">caligraphic_S , caligraphic_A , caligraphic_T , caligraphic_R , italic_γ</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.9.9.2" style="padding:-1.5pt 2.0pt;">the state, action, transition, reward and discount factor in MDP</td>
</tr>
<tr class="ltx_tr" id="A0.T1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.10.10.1" style="padding:-1.5pt 2.0pt;"><math alttext="s_{t},o_{t},a_{t},r_{t}" class="ltx_Math" display="inline" id="A0.T1.10.10.1.m1.4"><semantics id="A0.T1.10.10.1.m1.4a"><mrow id="A0.T1.10.10.1.m1.4.4.4" xref="A0.T1.10.10.1.m1.4.4.5.cmml"><msub id="A0.T1.10.10.1.m1.1.1.1.1" xref="A0.T1.10.10.1.m1.1.1.1.1.cmml"><mi id="A0.T1.10.10.1.m1.1.1.1.1.2" xref="A0.T1.10.10.1.m1.1.1.1.1.2.cmml">s</mi><mi id="A0.T1.10.10.1.m1.1.1.1.1.3" xref="A0.T1.10.10.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="A0.T1.10.10.1.m1.4.4.4.5" xref="A0.T1.10.10.1.m1.4.4.5.cmml">,</mo><msub id="A0.T1.10.10.1.m1.2.2.2.2" xref="A0.T1.10.10.1.m1.2.2.2.2.cmml"><mi id="A0.T1.10.10.1.m1.2.2.2.2.2" xref="A0.T1.10.10.1.m1.2.2.2.2.2.cmml">o</mi><mi id="A0.T1.10.10.1.m1.2.2.2.2.3" xref="A0.T1.10.10.1.m1.2.2.2.2.3.cmml">t</mi></msub><mo id="A0.T1.10.10.1.m1.4.4.4.6" xref="A0.T1.10.10.1.m1.4.4.5.cmml">,</mo><msub id="A0.T1.10.10.1.m1.3.3.3.3" xref="A0.T1.10.10.1.m1.3.3.3.3.cmml"><mi id="A0.T1.10.10.1.m1.3.3.3.3.2" xref="A0.T1.10.10.1.m1.3.3.3.3.2.cmml">a</mi><mi id="A0.T1.10.10.1.m1.3.3.3.3.3" xref="A0.T1.10.10.1.m1.3.3.3.3.3.cmml">t</mi></msub><mo id="A0.T1.10.10.1.m1.4.4.4.7" xref="A0.T1.10.10.1.m1.4.4.5.cmml">,</mo><msub id="A0.T1.10.10.1.m1.4.4.4.4" xref="A0.T1.10.10.1.m1.4.4.4.4.cmml"><mi id="A0.T1.10.10.1.m1.4.4.4.4.2" xref="A0.T1.10.10.1.m1.4.4.4.4.2.cmml">r</mi><mi id="A0.T1.10.10.1.m1.4.4.4.4.3" xref="A0.T1.10.10.1.m1.4.4.4.4.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.10.10.1.m1.4b"><list id="A0.T1.10.10.1.m1.4.4.5.cmml" xref="A0.T1.10.10.1.m1.4.4.4"><apply id="A0.T1.10.10.1.m1.1.1.1.1.cmml" xref="A0.T1.10.10.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.10.10.1.m1.1.1.1.1.1.cmml" xref="A0.T1.10.10.1.m1.1.1.1.1">subscript</csymbol><ci id="A0.T1.10.10.1.m1.1.1.1.1.2.cmml" xref="A0.T1.10.10.1.m1.1.1.1.1.2">𝑠</ci><ci id="A0.T1.10.10.1.m1.1.1.1.1.3.cmml" xref="A0.T1.10.10.1.m1.1.1.1.1.3">𝑡</ci></apply><apply id="A0.T1.10.10.1.m1.2.2.2.2.cmml" xref="A0.T1.10.10.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A0.T1.10.10.1.m1.2.2.2.2.1.cmml" xref="A0.T1.10.10.1.m1.2.2.2.2">subscript</csymbol><ci id="A0.T1.10.10.1.m1.2.2.2.2.2.cmml" xref="A0.T1.10.10.1.m1.2.2.2.2.2">𝑜</ci><ci id="A0.T1.10.10.1.m1.2.2.2.2.3.cmml" xref="A0.T1.10.10.1.m1.2.2.2.2.3">𝑡</ci></apply><apply id="A0.T1.10.10.1.m1.3.3.3.3.cmml" xref="A0.T1.10.10.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="A0.T1.10.10.1.m1.3.3.3.3.1.cmml" xref="A0.T1.10.10.1.m1.3.3.3.3">subscript</csymbol><ci id="A0.T1.10.10.1.m1.3.3.3.3.2.cmml" xref="A0.T1.10.10.1.m1.3.3.3.3.2">𝑎</ci><ci id="A0.T1.10.10.1.m1.3.3.3.3.3.cmml" xref="A0.T1.10.10.1.m1.3.3.3.3.3">𝑡</ci></apply><apply id="A0.T1.10.10.1.m1.4.4.4.4.cmml" xref="A0.T1.10.10.1.m1.4.4.4.4"><csymbol cd="ambiguous" id="A0.T1.10.10.1.m1.4.4.4.4.1.cmml" xref="A0.T1.10.10.1.m1.4.4.4.4">subscript</csymbol><ci id="A0.T1.10.10.1.m1.4.4.4.4.2.cmml" xref="A0.T1.10.10.1.m1.4.4.4.4.2">𝑟</ci><ci id="A0.T1.10.10.1.m1.4.4.4.4.3.cmml" xref="A0.T1.10.10.1.m1.4.4.4.4.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.10.10.1.m1.4c">s_{t},o_{t},a_{t},r_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.10.10.1.m1.4d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.11.11.2" style="padding:-1.5pt 2.0pt;">the state, action type, action and reward at the <math alttext="t" class="ltx_Math" display="inline" id="A0.T1.11.11.2.m1.1"><semantics id="A0.T1.11.11.2.m1.1a"><mi id="A0.T1.11.11.2.m1.1.1" xref="A0.T1.11.11.2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A0.T1.11.11.2.m1.1b"><ci id="A0.T1.11.11.2.m1.1.1.cmml" xref="A0.T1.11.11.2.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.11.11.2.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="A0.T1.11.11.2.m1.1d">italic_t</annotation></semantics></math>-th turn</td>
</tr>
<tr class="ltx_tr" id="A0.T1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.12.12.1" style="padding:-1.5pt 2.0pt;"><math alttext="\mathbf{s}_{t},\mathbf{a}_{t}" class="ltx_Math" display="inline" id="A0.T1.12.12.1.m1.2"><semantics id="A0.T1.12.12.1.m1.2a"><mrow id="A0.T1.12.12.1.m1.2.2.2" xref="A0.T1.12.12.1.m1.2.2.3.cmml"><msub id="A0.T1.12.12.1.m1.1.1.1.1" xref="A0.T1.12.12.1.m1.1.1.1.1.cmml"><mi id="A0.T1.12.12.1.m1.1.1.1.1.2" xref="A0.T1.12.12.1.m1.1.1.1.1.2.cmml">𝐬</mi><mi id="A0.T1.12.12.1.m1.1.1.1.1.3" xref="A0.T1.12.12.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="A0.T1.12.12.1.m1.2.2.2.3" xref="A0.T1.12.12.1.m1.2.2.3.cmml">,</mo><msub id="A0.T1.12.12.1.m1.2.2.2.2" xref="A0.T1.12.12.1.m1.2.2.2.2.cmml"><mi id="A0.T1.12.12.1.m1.2.2.2.2.2" xref="A0.T1.12.12.1.m1.2.2.2.2.2.cmml">𝐚</mi><mi id="A0.T1.12.12.1.m1.2.2.2.2.3" xref="A0.T1.12.12.1.m1.2.2.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.12.12.1.m1.2b"><list id="A0.T1.12.12.1.m1.2.2.3.cmml" xref="A0.T1.12.12.1.m1.2.2.2"><apply id="A0.T1.12.12.1.m1.1.1.1.1.cmml" xref="A0.T1.12.12.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.12.12.1.m1.1.1.1.1.1.cmml" xref="A0.T1.12.12.1.m1.1.1.1.1">subscript</csymbol><ci id="A0.T1.12.12.1.m1.1.1.1.1.2.cmml" xref="A0.T1.12.12.1.m1.1.1.1.1.2">𝐬</ci><ci id="A0.T1.12.12.1.m1.1.1.1.1.3.cmml" xref="A0.T1.12.12.1.m1.1.1.1.1.3">𝑡</ci></apply><apply id="A0.T1.12.12.1.m1.2.2.2.2.cmml" xref="A0.T1.12.12.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A0.T1.12.12.1.m1.2.2.2.2.1.cmml" xref="A0.T1.12.12.1.m1.2.2.2.2">subscript</csymbol><ci id="A0.T1.12.12.1.m1.2.2.2.2.2.cmml" xref="A0.T1.12.12.1.m1.2.2.2.2.2">𝐚</ci><ci id="A0.T1.12.12.1.m1.2.2.2.2.3.cmml" xref="A0.T1.12.12.1.m1.2.2.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.12.12.1.m1.2c">\mathbf{s}_{t},\mathbf{a}_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.12.12.1.m1.2d">bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.14.14.3" style="padding:-1.5pt 2.0pt;">the representation of the state <math alttext="s_{t}" class="ltx_Math" display="inline" id="A0.T1.13.13.2.m1.1"><semantics id="A0.T1.13.13.2.m1.1a"><msub id="A0.T1.13.13.2.m1.1.1" xref="A0.T1.13.13.2.m1.1.1.cmml"><mi id="A0.T1.13.13.2.m1.1.1.2" xref="A0.T1.13.13.2.m1.1.1.2.cmml">s</mi><mi id="A0.T1.13.13.2.m1.1.1.3" xref="A0.T1.13.13.2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.13.13.2.m1.1b"><apply id="A0.T1.13.13.2.m1.1.1.cmml" xref="A0.T1.13.13.2.m1.1.1"><csymbol cd="ambiguous" id="A0.T1.13.13.2.m1.1.1.1.cmml" xref="A0.T1.13.13.2.m1.1.1">subscript</csymbol><ci id="A0.T1.13.13.2.m1.1.1.2.cmml" xref="A0.T1.13.13.2.m1.1.1.2">𝑠</ci><ci id="A0.T1.13.13.2.m1.1.1.3.cmml" xref="A0.T1.13.13.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.13.13.2.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.13.13.2.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, the embedding of the action <math alttext="a_{t}" class="ltx_Math" display="inline" id="A0.T1.14.14.3.m2.1"><semantics id="A0.T1.14.14.3.m2.1a"><msub id="A0.T1.14.14.3.m2.1.1" xref="A0.T1.14.14.3.m2.1.1.cmml"><mi id="A0.T1.14.14.3.m2.1.1.2" xref="A0.T1.14.14.3.m2.1.1.2.cmml">a</mi><mi id="A0.T1.14.14.3.m2.1.1.3" xref="A0.T1.14.14.3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.14.14.3.m2.1b"><apply id="A0.T1.14.14.3.m2.1.1.cmml" xref="A0.T1.14.14.3.m2.1.1"><csymbol cd="ambiguous" id="A0.T1.14.14.3.m2.1.1.1.cmml" xref="A0.T1.14.14.3.m2.1.1">subscript</csymbol><ci id="A0.T1.14.14.3.m2.1.1.2.cmml" xref="A0.T1.14.14.3.m2.1.1.2">𝑎</ci><ci id="A0.T1.14.14.3.m2.1.1.3.cmml" xref="A0.T1.14.14.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.14.14.3.m2.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.14.14.3.m2.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A0.T1.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.15.15.1" style="padding:-1.5pt 2.0pt;"><math alttext="\mathcal{A}_{s_{t}}" class="ltx_Math" display="inline" id="A0.T1.15.15.1.m1.1"><semantics id="A0.T1.15.15.1.m1.1a"><msub id="A0.T1.15.15.1.m1.1.1" xref="A0.T1.15.15.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A0.T1.15.15.1.m1.1.1.2" xref="A0.T1.15.15.1.m1.1.1.2.cmml">𝒜</mi><msub id="A0.T1.15.15.1.m1.1.1.3" xref="A0.T1.15.15.1.m1.1.1.3.cmml"><mi id="A0.T1.15.15.1.m1.1.1.3.2" xref="A0.T1.15.15.1.m1.1.1.3.2.cmml">s</mi><mi id="A0.T1.15.15.1.m1.1.1.3.3" xref="A0.T1.15.15.1.m1.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="A0.T1.15.15.1.m1.1b"><apply id="A0.T1.15.15.1.m1.1.1.cmml" xref="A0.T1.15.15.1.m1.1.1"><csymbol cd="ambiguous" id="A0.T1.15.15.1.m1.1.1.1.cmml" xref="A0.T1.15.15.1.m1.1.1">subscript</csymbol><ci id="A0.T1.15.15.1.m1.1.1.2.cmml" xref="A0.T1.15.15.1.m1.1.1.2">𝒜</ci><apply id="A0.T1.15.15.1.m1.1.1.3.cmml" xref="A0.T1.15.15.1.m1.1.1.3"><csymbol cd="ambiguous" id="A0.T1.15.15.1.m1.1.1.3.1.cmml" xref="A0.T1.15.15.1.m1.1.1.3">subscript</csymbol><ci id="A0.T1.15.15.1.m1.1.1.3.2.cmml" xref="A0.T1.15.15.1.m1.1.1.3.2">𝑠</ci><ci id="A0.T1.15.15.1.m1.1.1.3.3.cmml" xref="A0.T1.15.15.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.15.15.1.m1.1c">\mathcal{A}_{s_{t}}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.15.15.1.m1.1d">caligraphic_A start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.16.16.2" style="padding:-1.5pt 2.0pt;">The action space at the state <math alttext="s_{t}" class="ltx_Math" display="inline" id="A0.T1.16.16.2.m1.1"><semantics id="A0.T1.16.16.2.m1.1a"><msub id="A0.T1.16.16.2.m1.1.1" xref="A0.T1.16.16.2.m1.1.1.cmml"><mi id="A0.T1.16.16.2.m1.1.1.2" xref="A0.T1.16.16.2.m1.1.1.2.cmml">s</mi><mi id="A0.T1.16.16.2.m1.1.1.3" xref="A0.T1.16.16.2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.16.16.2.m1.1b"><apply id="A0.T1.16.16.2.m1.1.1.cmml" xref="A0.T1.16.16.2.m1.1.1"><csymbol cd="ambiguous" id="A0.T1.16.16.2.m1.1.1.1.cmml" xref="A0.T1.16.16.2.m1.1.1">subscript</csymbol><ci id="A0.T1.16.16.2.m1.1.1.2.cmml" xref="A0.T1.16.16.2.m1.1.1.2">𝑠</ci><ci id="A0.T1.16.16.2.m1.1.1.3.cmml" xref="A0.T1.16.16.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.16.16.2.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.16.16.2.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A0.T1.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.17.17.1" style="padding:-1.5pt 2.0pt;"><math alttext="\mathcal{A}_{s_{t},o_{t}}" class="ltx_Math" display="inline" id="A0.T1.17.17.1.m1.2"><semantics id="A0.T1.17.17.1.m1.2a"><msub id="A0.T1.17.17.1.m1.2.3" xref="A0.T1.17.17.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A0.T1.17.17.1.m1.2.3.2" xref="A0.T1.17.17.1.m1.2.3.2.cmml">𝒜</mi><mrow id="A0.T1.17.17.1.m1.2.2.2.2" xref="A0.T1.17.17.1.m1.2.2.2.3.cmml"><msub id="A0.T1.17.17.1.m1.1.1.1.1.1" xref="A0.T1.17.17.1.m1.1.1.1.1.1.cmml"><mi id="A0.T1.17.17.1.m1.1.1.1.1.1.2" xref="A0.T1.17.17.1.m1.1.1.1.1.1.2.cmml">s</mi><mi id="A0.T1.17.17.1.m1.1.1.1.1.1.3" xref="A0.T1.17.17.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A0.T1.17.17.1.m1.2.2.2.2.3" xref="A0.T1.17.17.1.m1.2.2.2.3.cmml">,</mo><msub id="A0.T1.17.17.1.m1.2.2.2.2.2" xref="A0.T1.17.17.1.m1.2.2.2.2.2.cmml"><mi id="A0.T1.17.17.1.m1.2.2.2.2.2.2" xref="A0.T1.17.17.1.m1.2.2.2.2.2.2.cmml">o</mi><mi id="A0.T1.17.17.1.m1.2.2.2.2.2.3" xref="A0.T1.17.17.1.m1.2.2.2.2.2.3.cmml">t</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="A0.T1.17.17.1.m1.2b"><apply id="A0.T1.17.17.1.m1.2.3.cmml" xref="A0.T1.17.17.1.m1.2.3"><csymbol cd="ambiguous" id="A0.T1.17.17.1.m1.2.3.1.cmml" xref="A0.T1.17.17.1.m1.2.3">subscript</csymbol><ci id="A0.T1.17.17.1.m1.2.3.2.cmml" xref="A0.T1.17.17.1.m1.2.3.2">𝒜</ci><list id="A0.T1.17.17.1.m1.2.2.2.3.cmml" xref="A0.T1.17.17.1.m1.2.2.2.2"><apply id="A0.T1.17.17.1.m1.1.1.1.1.1.cmml" xref="A0.T1.17.17.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.17.17.1.m1.1.1.1.1.1.1.cmml" xref="A0.T1.17.17.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A0.T1.17.17.1.m1.1.1.1.1.1.2.cmml" xref="A0.T1.17.17.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="A0.T1.17.17.1.m1.1.1.1.1.1.3.cmml" xref="A0.T1.17.17.1.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A0.T1.17.17.1.m1.2.2.2.2.2.cmml" xref="A0.T1.17.17.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.T1.17.17.1.m1.2.2.2.2.2.1.cmml" xref="A0.T1.17.17.1.m1.2.2.2.2.2">subscript</csymbol><ci id="A0.T1.17.17.1.m1.2.2.2.2.2.2.cmml" xref="A0.T1.17.17.1.m1.2.2.2.2.2.2">𝑜</ci><ci id="A0.T1.17.17.1.m1.2.2.2.2.2.3.cmml" xref="A0.T1.17.17.1.m1.2.2.2.2.2.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.17.17.1.m1.2c">\mathcal{A}_{s_{t},o_{t}}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.17.17.1.m1.2d">caligraphic_A start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.19.19.3" style="padding:-1.5pt 2.0pt;">The sub action space at the state <math alttext="s_{t}" class="ltx_Math" display="inline" id="A0.T1.18.18.2.m1.1"><semantics id="A0.T1.18.18.2.m1.1a"><msub id="A0.T1.18.18.2.m1.1.1" xref="A0.T1.18.18.2.m1.1.1.cmml"><mi id="A0.T1.18.18.2.m1.1.1.2" xref="A0.T1.18.18.2.m1.1.1.2.cmml">s</mi><mi id="A0.T1.18.18.2.m1.1.1.3" xref="A0.T1.18.18.2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.18.18.2.m1.1b"><apply id="A0.T1.18.18.2.m1.1.1.cmml" xref="A0.T1.18.18.2.m1.1.1"><csymbol cd="ambiguous" id="A0.T1.18.18.2.m1.1.1.1.cmml" xref="A0.T1.18.18.2.m1.1.1">subscript</csymbol><ci id="A0.T1.18.18.2.m1.1.1.2.cmml" xref="A0.T1.18.18.2.m1.1.1.2">𝑠</ci><ci id="A0.T1.18.18.2.m1.1.1.3.cmml" xref="A0.T1.18.18.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.18.18.2.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.18.18.2.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> after choosing the action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="A0.T1.19.19.3.m2.1"><semantics id="A0.T1.19.19.3.m2.1a"><msub id="A0.T1.19.19.3.m2.1.1" xref="A0.T1.19.19.3.m2.1.1.cmml"><mi id="A0.T1.19.19.3.m2.1.1.2" xref="A0.T1.19.19.3.m2.1.1.2.cmml">o</mi><mi id="A0.T1.19.19.3.m2.1.1.3" xref="A0.T1.19.19.3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.19.19.3.m2.1b"><apply id="A0.T1.19.19.3.m2.1.1.cmml" xref="A0.T1.19.19.3.m2.1.1"><csymbol cd="ambiguous" id="A0.T1.19.19.3.m2.1.1.1.cmml" xref="A0.T1.19.19.3.m2.1.1">subscript</csymbol><ci id="A0.T1.19.19.3.m2.1.1.2.cmml" xref="A0.T1.19.19.3.m2.1.1.2">𝑜</ci><ci id="A0.T1.19.19.3.m2.1.1.3.cmml" xref="A0.T1.19.19.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.19.19.3.m2.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.19.19.3.m2.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A0.T1.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.20.20.1" style="padding:-1.5pt 2.0pt;"><math alttext="\mathcal{P}^{+}_{t},\mathcal{P}^{-}_{t},\mathcal{V}^{-}_{t}" class="ltx_Math" display="inline" id="A0.T1.20.20.1.m1.3"><semantics id="A0.T1.20.20.1.m1.3a"><mrow id="A0.T1.20.20.1.m1.3.3.3" xref="A0.T1.20.20.1.m1.3.3.4.cmml"><msubsup id="A0.T1.20.20.1.m1.1.1.1.1" xref="A0.T1.20.20.1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A0.T1.20.20.1.m1.1.1.1.1.2.2" xref="A0.T1.20.20.1.m1.1.1.1.1.2.2.cmml">𝒫</mi><mi id="A0.T1.20.20.1.m1.1.1.1.1.3" xref="A0.T1.20.20.1.m1.1.1.1.1.3.cmml">t</mi><mo id="A0.T1.20.20.1.m1.1.1.1.1.2.3" xref="A0.T1.20.20.1.m1.1.1.1.1.2.3.cmml">+</mo></msubsup><mo id="A0.T1.20.20.1.m1.3.3.3.4" xref="A0.T1.20.20.1.m1.3.3.4.cmml">,</mo><msubsup id="A0.T1.20.20.1.m1.2.2.2.2" xref="A0.T1.20.20.1.m1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A0.T1.20.20.1.m1.2.2.2.2.2.2" xref="A0.T1.20.20.1.m1.2.2.2.2.2.2.cmml">𝒫</mi><mi id="A0.T1.20.20.1.m1.2.2.2.2.3" xref="A0.T1.20.20.1.m1.2.2.2.2.3.cmml">t</mi><mo id="A0.T1.20.20.1.m1.2.2.2.2.2.3" xref="A0.T1.20.20.1.m1.2.2.2.2.2.3.cmml">−</mo></msubsup><mo id="A0.T1.20.20.1.m1.3.3.3.5" xref="A0.T1.20.20.1.m1.3.3.4.cmml">,</mo><msubsup id="A0.T1.20.20.1.m1.3.3.3.3" xref="A0.T1.20.20.1.m1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A0.T1.20.20.1.m1.3.3.3.3.2.2" xref="A0.T1.20.20.1.m1.3.3.3.3.2.2.cmml">𝒱</mi><mi id="A0.T1.20.20.1.m1.3.3.3.3.3" xref="A0.T1.20.20.1.m1.3.3.3.3.3.cmml">t</mi><mo id="A0.T1.20.20.1.m1.3.3.3.3.2.3" xref="A0.T1.20.20.1.m1.3.3.3.3.2.3.cmml">−</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.20.20.1.m1.3b"><list id="A0.T1.20.20.1.m1.3.3.4.cmml" xref="A0.T1.20.20.1.m1.3.3.3"><apply id="A0.T1.20.20.1.m1.1.1.1.1.cmml" xref="A0.T1.20.20.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.20.20.1.m1.1.1.1.1.1.cmml" xref="A0.T1.20.20.1.m1.1.1.1.1">subscript</csymbol><apply id="A0.T1.20.20.1.m1.1.1.1.1.2.cmml" xref="A0.T1.20.20.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.20.20.1.m1.1.1.1.1.2.1.cmml" xref="A0.T1.20.20.1.m1.1.1.1.1">superscript</csymbol><ci id="A0.T1.20.20.1.m1.1.1.1.1.2.2.cmml" xref="A0.T1.20.20.1.m1.1.1.1.1.2.2">𝒫</ci><plus id="A0.T1.20.20.1.m1.1.1.1.1.2.3.cmml" xref="A0.T1.20.20.1.m1.1.1.1.1.2.3"></plus></apply><ci id="A0.T1.20.20.1.m1.1.1.1.1.3.cmml" xref="A0.T1.20.20.1.m1.1.1.1.1.3">𝑡</ci></apply><apply id="A0.T1.20.20.1.m1.2.2.2.2.cmml" xref="A0.T1.20.20.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A0.T1.20.20.1.m1.2.2.2.2.1.cmml" xref="A0.T1.20.20.1.m1.2.2.2.2">subscript</csymbol><apply id="A0.T1.20.20.1.m1.2.2.2.2.2.cmml" xref="A0.T1.20.20.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A0.T1.20.20.1.m1.2.2.2.2.2.1.cmml" xref="A0.T1.20.20.1.m1.2.2.2.2">superscript</csymbol><ci id="A0.T1.20.20.1.m1.2.2.2.2.2.2.cmml" xref="A0.T1.20.20.1.m1.2.2.2.2.2.2">𝒫</ci><minus id="A0.T1.20.20.1.m1.2.2.2.2.2.3.cmml" xref="A0.T1.20.20.1.m1.2.2.2.2.2.3"></minus></apply><ci id="A0.T1.20.20.1.m1.2.2.2.2.3.cmml" xref="A0.T1.20.20.1.m1.2.2.2.2.3">𝑡</ci></apply><apply id="A0.T1.20.20.1.m1.3.3.3.3.cmml" xref="A0.T1.20.20.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="A0.T1.20.20.1.m1.3.3.3.3.1.cmml" xref="A0.T1.20.20.1.m1.3.3.3.3">subscript</csymbol><apply id="A0.T1.20.20.1.m1.3.3.3.3.2.cmml" xref="A0.T1.20.20.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="A0.T1.20.20.1.m1.3.3.3.3.2.1.cmml" xref="A0.T1.20.20.1.m1.3.3.3.3">superscript</csymbol><ci id="A0.T1.20.20.1.m1.3.3.3.3.2.2.cmml" xref="A0.T1.20.20.1.m1.3.3.3.3.2.2">𝒱</ci><minus id="A0.T1.20.20.1.m1.3.3.3.3.2.3.cmml" xref="A0.T1.20.20.1.m1.3.3.3.3.2.3"></minus></apply><ci id="A0.T1.20.20.1.m1.3.3.3.3.3.cmml" xref="A0.T1.20.20.1.m1.3.3.3.3.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.20.20.1.m1.3c">\mathcal{P}^{+}_{t},\mathcal{P}^{-}_{t},\mathcal{V}^{-}_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.20.20.1.m1.3d">caligraphic_P start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_P start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_V start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.21.21.2" style="padding:-1.5pt 2.0pt;">the accepted attribute values, the rejected attribute values and the rejected items at the <math alttext="t" class="ltx_Math" display="inline" id="A0.T1.21.21.2.m1.1"><semantics id="A0.T1.21.21.2.m1.1a"><mi id="A0.T1.21.21.2.m1.1.1" xref="A0.T1.21.21.2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A0.T1.21.21.2.m1.1b"><ci id="A0.T1.21.21.2.m1.1.1.cmml" xref="A0.T1.21.21.2.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.21.21.2.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="A0.T1.21.21.2.m1.1d">italic_t</annotation></semantics></math>-th turn</td>
</tr>
<tr class="ltx_tr" id="A0.T1.23.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.22.22.1" style="padding:-1.5pt 2.0pt;"><math alttext="\mathcal{P}^{c}_{t},\mathcal{V}^{c}_{t}" class="ltx_Math" display="inline" id="A0.T1.22.22.1.m1.2"><semantics id="A0.T1.22.22.1.m1.2a"><mrow id="A0.T1.22.22.1.m1.2.2.2" xref="A0.T1.22.22.1.m1.2.2.3.cmml"><msubsup id="A0.T1.22.22.1.m1.1.1.1.1" xref="A0.T1.22.22.1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A0.T1.22.22.1.m1.1.1.1.1.2.2" xref="A0.T1.22.22.1.m1.1.1.1.1.2.2.cmml">𝒫</mi><mi id="A0.T1.22.22.1.m1.1.1.1.1.3" xref="A0.T1.22.22.1.m1.1.1.1.1.3.cmml">t</mi><mi id="A0.T1.22.22.1.m1.1.1.1.1.2.3" xref="A0.T1.22.22.1.m1.1.1.1.1.2.3.cmml">c</mi></msubsup><mo id="A0.T1.22.22.1.m1.2.2.2.3" xref="A0.T1.22.22.1.m1.2.2.3.cmml">,</mo><msubsup id="A0.T1.22.22.1.m1.2.2.2.2" xref="A0.T1.22.22.1.m1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A0.T1.22.22.1.m1.2.2.2.2.2.2" xref="A0.T1.22.22.1.m1.2.2.2.2.2.2.cmml">𝒱</mi><mi id="A0.T1.22.22.1.m1.2.2.2.2.3" xref="A0.T1.22.22.1.m1.2.2.2.2.3.cmml">t</mi><mi id="A0.T1.22.22.1.m1.2.2.2.2.2.3" xref="A0.T1.22.22.1.m1.2.2.2.2.2.3.cmml">c</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.22.22.1.m1.2b"><list id="A0.T1.22.22.1.m1.2.2.3.cmml" xref="A0.T1.22.22.1.m1.2.2.2"><apply id="A0.T1.22.22.1.m1.1.1.1.1.cmml" xref="A0.T1.22.22.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.22.22.1.m1.1.1.1.1.1.cmml" xref="A0.T1.22.22.1.m1.1.1.1.1">subscript</csymbol><apply id="A0.T1.22.22.1.m1.1.1.1.1.2.cmml" xref="A0.T1.22.22.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.22.22.1.m1.1.1.1.1.2.1.cmml" xref="A0.T1.22.22.1.m1.1.1.1.1">superscript</csymbol><ci id="A0.T1.22.22.1.m1.1.1.1.1.2.2.cmml" xref="A0.T1.22.22.1.m1.1.1.1.1.2.2">𝒫</ci><ci id="A0.T1.22.22.1.m1.1.1.1.1.2.3.cmml" xref="A0.T1.22.22.1.m1.1.1.1.1.2.3">𝑐</ci></apply><ci id="A0.T1.22.22.1.m1.1.1.1.1.3.cmml" xref="A0.T1.22.22.1.m1.1.1.1.1.3">𝑡</ci></apply><apply id="A0.T1.22.22.1.m1.2.2.2.2.cmml" xref="A0.T1.22.22.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A0.T1.22.22.1.m1.2.2.2.2.1.cmml" xref="A0.T1.22.22.1.m1.2.2.2.2">subscript</csymbol><apply id="A0.T1.22.22.1.m1.2.2.2.2.2.cmml" xref="A0.T1.22.22.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A0.T1.22.22.1.m1.2.2.2.2.2.1.cmml" xref="A0.T1.22.22.1.m1.2.2.2.2">superscript</csymbol><ci id="A0.T1.22.22.1.m1.2.2.2.2.2.2.cmml" xref="A0.T1.22.22.1.m1.2.2.2.2.2.2">𝒱</ci><ci id="A0.T1.22.22.1.m1.2.2.2.2.2.3.cmml" xref="A0.T1.22.22.1.m1.2.2.2.2.2.3">𝑐</ci></apply><ci id="A0.T1.22.22.1.m1.2.2.2.2.3.cmml" xref="A0.T1.22.22.1.m1.2.2.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.22.22.1.m1.2c">\mathcal{P}^{c}_{t},\mathcal{V}^{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.22.22.1.m1.2d">caligraphic_P start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_V start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.23.23.2" style="padding:-1.5pt 2.0pt;">the candidate attribute values and the candidate items at the <math alttext="t" class="ltx_Math" display="inline" id="A0.T1.23.23.2.m1.1"><semantics id="A0.T1.23.23.2.m1.1a"><mi id="A0.T1.23.23.2.m1.1.1" xref="A0.T1.23.23.2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A0.T1.23.23.2.m1.1b"><ci id="A0.T1.23.23.2.m1.1.1.cmml" xref="A0.T1.23.23.2.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.23.23.2.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="A0.T1.23.23.2.m1.1d">italic_t</annotation></semantics></math>-th turn</td>
</tr>
<tr class="ltx_tr" id="A0.T1.26.26">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.24.24.1" style="padding:-1.5pt 2.0pt;"><math alttext="\pi_{\phi}(o_{t}|s_{t})" class="ltx_Math" display="inline" id="A0.T1.24.24.1.m1.1"><semantics id="A0.T1.24.24.1.m1.1a"><mrow id="A0.T1.24.24.1.m1.1.1" xref="A0.T1.24.24.1.m1.1.1.cmml"><msub id="A0.T1.24.24.1.m1.1.1.3" xref="A0.T1.24.24.1.m1.1.1.3.cmml"><mi id="A0.T1.24.24.1.m1.1.1.3.2" xref="A0.T1.24.24.1.m1.1.1.3.2.cmml">π</mi><mi id="A0.T1.24.24.1.m1.1.1.3.3" xref="A0.T1.24.24.1.m1.1.1.3.3.cmml">ϕ</mi></msub><mo id="A0.T1.24.24.1.m1.1.1.2" xref="A0.T1.24.24.1.m1.1.1.2.cmml">⁢</mo><mrow id="A0.T1.24.24.1.m1.1.1.1.1" xref="A0.T1.24.24.1.m1.1.1.1.1.1.cmml"><mo id="A0.T1.24.24.1.m1.1.1.1.1.2" stretchy="false" xref="A0.T1.24.24.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A0.T1.24.24.1.m1.1.1.1.1.1" xref="A0.T1.24.24.1.m1.1.1.1.1.1.cmml"><msub id="A0.T1.24.24.1.m1.1.1.1.1.1.2" xref="A0.T1.24.24.1.m1.1.1.1.1.1.2.cmml"><mi id="A0.T1.24.24.1.m1.1.1.1.1.1.2.2" xref="A0.T1.24.24.1.m1.1.1.1.1.1.2.2.cmml">o</mi><mi id="A0.T1.24.24.1.m1.1.1.1.1.1.2.3" xref="A0.T1.24.24.1.m1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A0.T1.24.24.1.m1.1.1.1.1.1.1" xref="A0.T1.24.24.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="A0.T1.24.24.1.m1.1.1.1.1.1.3" xref="A0.T1.24.24.1.m1.1.1.1.1.1.3.cmml"><mi id="A0.T1.24.24.1.m1.1.1.1.1.1.3.2" xref="A0.T1.24.24.1.m1.1.1.1.1.1.3.2.cmml">s</mi><mi id="A0.T1.24.24.1.m1.1.1.1.1.1.3.3" xref="A0.T1.24.24.1.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A0.T1.24.24.1.m1.1.1.1.1.3" stretchy="false" xref="A0.T1.24.24.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.24.24.1.m1.1b"><apply id="A0.T1.24.24.1.m1.1.1.cmml" xref="A0.T1.24.24.1.m1.1.1"><times id="A0.T1.24.24.1.m1.1.1.2.cmml" xref="A0.T1.24.24.1.m1.1.1.2"></times><apply id="A0.T1.24.24.1.m1.1.1.3.cmml" xref="A0.T1.24.24.1.m1.1.1.3"><csymbol cd="ambiguous" id="A0.T1.24.24.1.m1.1.1.3.1.cmml" xref="A0.T1.24.24.1.m1.1.1.3">subscript</csymbol><ci id="A0.T1.24.24.1.m1.1.1.3.2.cmml" xref="A0.T1.24.24.1.m1.1.1.3.2">𝜋</ci><ci id="A0.T1.24.24.1.m1.1.1.3.3.cmml" xref="A0.T1.24.24.1.m1.1.1.3.3">italic-ϕ</ci></apply><apply id="A0.T1.24.24.1.m1.1.1.1.1.1.cmml" xref="A0.T1.24.24.1.m1.1.1.1.1"><csymbol cd="latexml" id="A0.T1.24.24.1.m1.1.1.1.1.1.1.cmml" xref="A0.T1.24.24.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="A0.T1.24.24.1.m1.1.1.1.1.1.2.cmml" xref="A0.T1.24.24.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A0.T1.24.24.1.m1.1.1.1.1.1.2.1.cmml" xref="A0.T1.24.24.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A0.T1.24.24.1.m1.1.1.1.1.1.2.2.cmml" xref="A0.T1.24.24.1.m1.1.1.1.1.1.2.2">𝑜</ci><ci id="A0.T1.24.24.1.m1.1.1.1.1.1.2.3.cmml" xref="A0.T1.24.24.1.m1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A0.T1.24.24.1.m1.1.1.1.1.1.3.cmml" xref="A0.T1.24.24.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A0.T1.24.24.1.m1.1.1.1.1.1.3.1.cmml" xref="A0.T1.24.24.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A0.T1.24.24.1.m1.1.1.1.1.1.3.2.cmml" xref="A0.T1.24.24.1.m1.1.1.1.1.1.3.2">𝑠</ci><ci id="A0.T1.24.24.1.m1.1.1.1.1.1.3.3.cmml" xref="A0.T1.24.24.1.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.24.24.1.m1.1c">\pi_{\phi}(o_{t}|s_{t})</annotation><annotation encoding="application/x-llamapun" id="A0.T1.24.24.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.26.26.3" style="padding:-1.5pt 2.0pt;">the policy network that decides the action type <math alttext="o_{t}\in\{\mathtt{ask},\mathtt{rec}\}" class="ltx_Math" display="inline" id="A0.T1.25.25.2.m1.2"><semantics id="A0.T1.25.25.2.m1.2a"><mrow id="A0.T1.25.25.2.m1.2.3" xref="A0.T1.25.25.2.m1.2.3.cmml"><msub id="A0.T1.25.25.2.m1.2.3.2" xref="A0.T1.25.25.2.m1.2.3.2.cmml"><mi id="A0.T1.25.25.2.m1.2.3.2.2" xref="A0.T1.25.25.2.m1.2.3.2.2.cmml">o</mi><mi id="A0.T1.25.25.2.m1.2.3.2.3" xref="A0.T1.25.25.2.m1.2.3.2.3.cmml">t</mi></msub><mo id="A0.T1.25.25.2.m1.2.3.1" xref="A0.T1.25.25.2.m1.2.3.1.cmml">∈</mo><mrow id="A0.T1.25.25.2.m1.2.3.3.2" xref="A0.T1.25.25.2.m1.2.3.3.1.cmml"><mo id="A0.T1.25.25.2.m1.2.3.3.2.1" stretchy="false" xref="A0.T1.25.25.2.m1.2.3.3.1.cmml">{</mo><mi id="A0.T1.25.25.2.m1.1.1" xref="A0.T1.25.25.2.m1.1.1.cmml">𝚊𝚜𝚔</mi><mo id="A0.T1.25.25.2.m1.2.3.3.2.2" xref="A0.T1.25.25.2.m1.2.3.3.1.cmml">,</mo><mi id="A0.T1.25.25.2.m1.2.2" xref="A0.T1.25.25.2.m1.2.2.cmml">𝚛𝚎𝚌</mi><mo id="A0.T1.25.25.2.m1.2.3.3.2.3" stretchy="false" xref="A0.T1.25.25.2.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.25.25.2.m1.2b"><apply id="A0.T1.25.25.2.m1.2.3.cmml" xref="A0.T1.25.25.2.m1.2.3"><in id="A0.T1.25.25.2.m1.2.3.1.cmml" xref="A0.T1.25.25.2.m1.2.3.1"></in><apply id="A0.T1.25.25.2.m1.2.3.2.cmml" xref="A0.T1.25.25.2.m1.2.3.2"><csymbol cd="ambiguous" id="A0.T1.25.25.2.m1.2.3.2.1.cmml" xref="A0.T1.25.25.2.m1.2.3.2">subscript</csymbol><ci id="A0.T1.25.25.2.m1.2.3.2.2.cmml" xref="A0.T1.25.25.2.m1.2.3.2.2">𝑜</ci><ci id="A0.T1.25.25.2.m1.2.3.2.3.cmml" xref="A0.T1.25.25.2.m1.2.3.2.3">𝑡</ci></apply><set id="A0.T1.25.25.2.m1.2.3.3.1.cmml" xref="A0.T1.25.25.2.m1.2.3.3.2"><ci id="A0.T1.25.25.2.m1.1.1.cmml" xref="A0.T1.25.25.2.m1.1.1">𝚊𝚜𝚔</ci><ci id="A0.T1.25.25.2.m1.2.2.cmml" xref="A0.T1.25.25.2.m1.2.2">𝚛𝚎𝚌</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.25.25.2.m1.2c">o_{t}\in\{\mathtt{ask},\mathtt{rec}\}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.25.25.2.m1.2d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ { typewriter_ask , typewriter_rec }</annotation></semantics></math> from the current state <math alttext="s_{t}" class="ltx_Math" display="inline" id="A0.T1.26.26.3.m2.1"><semantics id="A0.T1.26.26.3.m2.1a"><msub id="A0.T1.26.26.3.m2.1.1" xref="A0.T1.26.26.3.m2.1.1.cmml"><mi id="A0.T1.26.26.3.m2.1.1.2" xref="A0.T1.26.26.3.m2.1.1.2.cmml">s</mi><mi id="A0.T1.26.26.3.m2.1.1.3" xref="A0.T1.26.26.3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.26.26.3.m2.1b"><apply id="A0.T1.26.26.3.m2.1.1.cmml" xref="A0.T1.26.26.3.m2.1.1"><csymbol cd="ambiguous" id="A0.T1.26.26.3.m2.1.1.1.cmml" xref="A0.T1.26.26.3.m2.1.1">subscript</csymbol><ci id="A0.T1.26.26.3.m2.1.1.2.cmml" xref="A0.T1.26.26.3.m2.1.1.2">𝑠</ci><ci id="A0.T1.26.26.3.m2.1.1.3.cmml" xref="A0.T1.26.26.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.26.26.3.m2.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.26.26.3.m2.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A0.T1.29.29">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.27.27.1" style="padding:-1.5pt 2.0pt;"><math alttext="Q_{\theta}(a_{t}|s_{t},o_{t})" class="ltx_Math" display="inline" id="A0.T1.27.27.1.m1.1"><semantics id="A0.T1.27.27.1.m1.1a"><mrow id="A0.T1.27.27.1.m1.1.1" xref="A0.T1.27.27.1.m1.1.1.cmml"><msub id="A0.T1.27.27.1.m1.1.1.3" xref="A0.T1.27.27.1.m1.1.1.3.cmml"><mi id="A0.T1.27.27.1.m1.1.1.3.2" xref="A0.T1.27.27.1.m1.1.1.3.2.cmml">Q</mi><mi id="A0.T1.27.27.1.m1.1.1.3.3" xref="A0.T1.27.27.1.m1.1.1.3.3.cmml">θ</mi></msub><mo id="A0.T1.27.27.1.m1.1.1.2" xref="A0.T1.27.27.1.m1.1.1.2.cmml">⁢</mo><mrow id="A0.T1.27.27.1.m1.1.1.1.1" xref="A0.T1.27.27.1.m1.1.1.1.1.1.cmml"><mo id="A0.T1.27.27.1.m1.1.1.1.1.2" stretchy="false" xref="A0.T1.27.27.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A0.T1.27.27.1.m1.1.1.1.1.1" xref="A0.T1.27.27.1.m1.1.1.1.1.1.cmml"><msub id="A0.T1.27.27.1.m1.1.1.1.1.1.4" xref="A0.T1.27.27.1.m1.1.1.1.1.1.4.cmml"><mi id="A0.T1.27.27.1.m1.1.1.1.1.1.4.2" xref="A0.T1.27.27.1.m1.1.1.1.1.1.4.2.cmml">a</mi><mi id="A0.T1.27.27.1.m1.1.1.1.1.1.4.3" xref="A0.T1.27.27.1.m1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="A0.T1.27.27.1.m1.1.1.1.1.1.3" xref="A0.T1.27.27.1.m1.1.1.1.1.1.3.cmml">|</mo><mrow id="A0.T1.27.27.1.m1.1.1.1.1.1.2.2" xref="A0.T1.27.27.1.m1.1.1.1.1.1.2.3.cmml"><msub id="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1" xref="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1.2" xref="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1.3" xref="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.3" xref="A0.T1.27.27.1.m1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2" xref="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2.cmml"><mi id="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2.2" xref="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2.2.cmml">o</mi><mi id="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2.3" xref="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="A0.T1.27.27.1.m1.1.1.1.1.3" stretchy="false" xref="A0.T1.27.27.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.27.27.1.m1.1b"><apply id="A0.T1.27.27.1.m1.1.1.cmml" xref="A0.T1.27.27.1.m1.1.1"><times id="A0.T1.27.27.1.m1.1.1.2.cmml" xref="A0.T1.27.27.1.m1.1.1.2"></times><apply id="A0.T1.27.27.1.m1.1.1.3.cmml" xref="A0.T1.27.27.1.m1.1.1.3"><csymbol cd="ambiguous" id="A0.T1.27.27.1.m1.1.1.3.1.cmml" xref="A0.T1.27.27.1.m1.1.1.3">subscript</csymbol><ci id="A0.T1.27.27.1.m1.1.1.3.2.cmml" xref="A0.T1.27.27.1.m1.1.1.3.2">𝑄</ci><ci id="A0.T1.27.27.1.m1.1.1.3.3.cmml" xref="A0.T1.27.27.1.m1.1.1.3.3">𝜃</ci></apply><apply id="A0.T1.27.27.1.m1.1.1.1.1.1.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1"><csymbol cd="latexml" id="A0.T1.27.27.1.m1.1.1.1.1.1.3.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.3">conditional</csymbol><apply id="A0.T1.27.27.1.m1.1.1.1.1.1.4.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A0.T1.27.27.1.m1.1.1.1.1.1.4.1.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.4">subscript</csymbol><ci id="A0.T1.27.27.1.m1.1.1.1.1.1.4.2.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.4.2">𝑎</ci><ci id="A0.T1.27.27.1.m1.1.1.1.1.1.4.3.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="A0.T1.27.27.1.m1.1.1.1.1.1.2.3.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.2.2"><apply id="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2.2">𝑜</ci><ci id="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="A0.T1.27.27.1.m1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.27.27.1.m1.1c">Q_{\theta}(a_{t}|s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="A0.T1.27.27.1.m1.1d">italic_Q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.29.29.3" style="padding:-1.5pt 2.0pt;">the Q-network that decides the specific action <math alttext="a_{t}" class="ltx_Math" display="inline" id="A0.T1.28.28.2.m1.1"><semantics id="A0.T1.28.28.2.m1.1a"><msub id="A0.T1.28.28.2.m1.1.1" xref="A0.T1.28.28.2.m1.1.1.cmml"><mi id="A0.T1.28.28.2.m1.1.1.2" xref="A0.T1.28.28.2.m1.1.1.2.cmml">a</mi><mi id="A0.T1.28.28.2.m1.1.1.3" xref="A0.T1.28.28.2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.28.28.2.m1.1b"><apply id="A0.T1.28.28.2.m1.1.1.cmml" xref="A0.T1.28.28.2.m1.1.1"><csymbol cd="ambiguous" id="A0.T1.28.28.2.m1.1.1.1.cmml" xref="A0.T1.28.28.2.m1.1.1">subscript</csymbol><ci id="A0.T1.28.28.2.m1.1.1.2.cmml" xref="A0.T1.28.28.2.m1.1.1.2">𝑎</ci><ci id="A0.T1.28.28.2.m1.1.1.3.cmml" xref="A0.T1.28.28.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.28.28.2.m1.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.28.28.2.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> according to the action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="A0.T1.29.29.3.m2.1"><semantics id="A0.T1.29.29.3.m2.1a"><msub id="A0.T1.29.29.3.m2.1.1" xref="A0.T1.29.29.3.m2.1.1.cmml"><mi id="A0.T1.29.29.3.m2.1.1.2" xref="A0.T1.29.29.3.m2.1.1.2.cmml">o</mi><mi id="A0.T1.29.29.3.m2.1.1.3" xref="A0.T1.29.29.3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.29.29.3.m2.1b"><apply id="A0.T1.29.29.3.m2.1.1.cmml" xref="A0.T1.29.29.3.m2.1.1"><csymbol cd="ambiguous" id="A0.T1.29.29.3.m2.1.1.1.cmml" xref="A0.T1.29.29.3.m2.1.1">subscript</csymbol><ci id="A0.T1.29.29.3.m2.1.1.2.cmml" xref="A0.T1.29.29.3.m2.1.1.2">𝑜</ci><ci id="A0.T1.29.29.3.m2.1.1.3.cmml" xref="A0.T1.29.29.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.29.29.3.m2.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.29.29.3.m2.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A0.T1.32.32">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.30.30.1" style="padding:-1.5pt 2.0pt;"><math alttext="q(s_{t},o_{t})" class="ltx_Math" display="inline" id="A0.T1.30.30.1.m1.2"><semantics id="A0.T1.30.30.1.m1.2a"><mrow id="A0.T1.30.30.1.m1.2.2" xref="A0.T1.30.30.1.m1.2.2.cmml"><mi id="A0.T1.30.30.1.m1.2.2.4" xref="A0.T1.30.30.1.m1.2.2.4.cmml">q</mi><mo id="A0.T1.30.30.1.m1.2.2.3" xref="A0.T1.30.30.1.m1.2.2.3.cmml">⁢</mo><mrow id="A0.T1.30.30.1.m1.2.2.2.2" xref="A0.T1.30.30.1.m1.2.2.2.3.cmml"><mo id="A0.T1.30.30.1.m1.2.2.2.2.3" stretchy="false" xref="A0.T1.30.30.1.m1.2.2.2.3.cmml">(</mo><msub id="A0.T1.30.30.1.m1.1.1.1.1.1" xref="A0.T1.30.30.1.m1.1.1.1.1.1.cmml"><mi id="A0.T1.30.30.1.m1.1.1.1.1.1.2" xref="A0.T1.30.30.1.m1.1.1.1.1.1.2.cmml">s</mi><mi id="A0.T1.30.30.1.m1.1.1.1.1.1.3" xref="A0.T1.30.30.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A0.T1.30.30.1.m1.2.2.2.2.4" xref="A0.T1.30.30.1.m1.2.2.2.3.cmml">,</mo><msub id="A0.T1.30.30.1.m1.2.2.2.2.2" xref="A0.T1.30.30.1.m1.2.2.2.2.2.cmml"><mi id="A0.T1.30.30.1.m1.2.2.2.2.2.2" xref="A0.T1.30.30.1.m1.2.2.2.2.2.2.cmml">o</mi><mi id="A0.T1.30.30.1.m1.2.2.2.2.2.3" xref="A0.T1.30.30.1.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="A0.T1.30.30.1.m1.2.2.2.2.5" stretchy="false" xref="A0.T1.30.30.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.30.30.1.m1.2b"><apply id="A0.T1.30.30.1.m1.2.2.cmml" xref="A0.T1.30.30.1.m1.2.2"><times id="A0.T1.30.30.1.m1.2.2.3.cmml" xref="A0.T1.30.30.1.m1.2.2.3"></times><ci id="A0.T1.30.30.1.m1.2.2.4.cmml" xref="A0.T1.30.30.1.m1.2.2.4">𝑞</ci><interval closure="open" id="A0.T1.30.30.1.m1.2.2.2.3.cmml" xref="A0.T1.30.30.1.m1.2.2.2.2"><apply id="A0.T1.30.30.1.m1.1.1.1.1.1.cmml" xref="A0.T1.30.30.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.30.30.1.m1.1.1.1.1.1.1.cmml" xref="A0.T1.30.30.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A0.T1.30.30.1.m1.1.1.1.1.1.2.cmml" xref="A0.T1.30.30.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="A0.T1.30.30.1.m1.1.1.1.1.1.3.cmml" xref="A0.T1.30.30.1.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A0.T1.30.30.1.m1.2.2.2.2.2.cmml" xref="A0.T1.30.30.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.T1.30.30.1.m1.2.2.2.2.2.1.cmml" xref="A0.T1.30.30.1.m1.2.2.2.2.2">subscript</csymbol><ci id="A0.T1.30.30.1.m1.2.2.2.2.2.2.cmml" xref="A0.T1.30.30.1.m1.2.2.2.2.2.2">𝑜</ci><ci id="A0.T1.30.30.1.m1.2.2.2.2.2.3.cmml" xref="A0.T1.30.30.1.m1.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.30.30.1.m1.2c">q(s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="A0.T1.30.30.1.m1.2d">italic_q ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.32.32.3" style="padding:-1.5pt 2.0pt;">the expected future reward of selecting action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="A0.T1.31.31.2.m1.1"><semantics id="A0.T1.31.31.2.m1.1a"><msub id="A0.T1.31.31.2.m1.1.1" xref="A0.T1.31.31.2.m1.1.1.cmml"><mi id="A0.T1.31.31.2.m1.1.1.2" xref="A0.T1.31.31.2.m1.1.1.2.cmml">o</mi><mi id="A0.T1.31.31.2.m1.1.1.3" xref="A0.T1.31.31.2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.31.31.2.m1.1b"><apply id="A0.T1.31.31.2.m1.1.1.cmml" xref="A0.T1.31.31.2.m1.1.1"><csymbol cd="ambiguous" id="A0.T1.31.31.2.m1.1.1.1.cmml" xref="A0.T1.31.31.2.m1.1.1">subscript</csymbol><ci id="A0.T1.31.31.2.m1.1.1.2.cmml" xref="A0.T1.31.31.2.m1.1.1.2">𝑜</ci><ci id="A0.T1.31.31.2.m1.1.1.3.cmml" xref="A0.T1.31.31.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.31.31.2.m1.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.31.31.2.m1.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at the state <math alttext="s_{t}" class="ltx_Math" display="inline" id="A0.T1.32.32.3.m2.1"><semantics id="A0.T1.32.32.3.m2.1a"><msub id="A0.T1.32.32.3.m2.1.1" xref="A0.T1.32.32.3.m2.1.1.cmml"><mi id="A0.T1.32.32.3.m2.1.1.2" xref="A0.T1.32.32.3.m2.1.1.2.cmml">s</mi><mi id="A0.T1.32.32.3.m2.1.1.3" xref="A0.T1.32.32.3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.32.32.3.m2.1b"><apply id="A0.T1.32.32.3.m2.1.1.cmml" xref="A0.T1.32.32.3.m2.1.1"><csymbol cd="ambiguous" id="A0.T1.32.32.3.m2.1.1.1.cmml" xref="A0.T1.32.32.3.m2.1.1">subscript</csymbol><ci id="A0.T1.32.32.3.m2.1.1.2.cmml" xref="A0.T1.32.32.3.m2.1.1.2">𝑠</ci><ci id="A0.T1.32.32.3.m2.1.1.3.cmml" xref="A0.T1.32.32.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.32.32.3.m2.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.32.32.3.m2.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A0.T1.35.35">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.33.33.1" style="padding:-1.5pt 2.0pt;"><math alttext="\tau^{(u)}_{i}" class="ltx_Math" display="inline" id="A0.T1.33.33.1.m1.1"><semantics id="A0.T1.33.33.1.m1.1a"><msubsup id="A0.T1.33.33.1.m1.1.2" xref="A0.T1.33.33.1.m1.1.2.cmml"><mi id="A0.T1.33.33.1.m1.1.2.2.2" xref="A0.T1.33.33.1.m1.1.2.2.2.cmml">τ</mi><mi id="A0.T1.33.33.1.m1.1.2.3" xref="A0.T1.33.33.1.m1.1.2.3.cmml">i</mi><mrow id="A0.T1.33.33.1.m1.1.1.1.3" xref="A0.T1.33.33.1.m1.1.2.cmml"><mo id="A0.T1.33.33.1.m1.1.1.1.3.1" stretchy="false" xref="A0.T1.33.33.1.m1.1.2.cmml">(</mo><mi id="A0.T1.33.33.1.m1.1.1.1.1" xref="A0.T1.33.33.1.m1.1.1.1.1.cmml">u</mi><mo id="A0.T1.33.33.1.m1.1.1.1.3.2" stretchy="false" xref="A0.T1.33.33.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A0.T1.33.33.1.m1.1b"><apply id="A0.T1.33.33.1.m1.1.2.cmml" xref="A0.T1.33.33.1.m1.1.2"><csymbol cd="ambiguous" id="A0.T1.33.33.1.m1.1.2.1.cmml" xref="A0.T1.33.33.1.m1.1.2">subscript</csymbol><apply id="A0.T1.33.33.1.m1.1.2.2.cmml" xref="A0.T1.33.33.1.m1.1.2"><csymbol cd="ambiguous" id="A0.T1.33.33.1.m1.1.2.2.1.cmml" xref="A0.T1.33.33.1.m1.1.2">superscript</csymbol><ci id="A0.T1.33.33.1.m1.1.2.2.2.cmml" xref="A0.T1.33.33.1.m1.1.2.2.2">𝜏</ci><ci id="A0.T1.33.33.1.m1.1.1.1.1.cmml" xref="A0.T1.33.33.1.m1.1.1.1.1">𝑢</ci></apply><ci id="A0.T1.33.33.1.m1.1.2.3.cmml" xref="A0.T1.33.33.1.m1.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.33.33.1.m1.1c">\tau^{(u)}_{i}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.33.33.1.m1.1d">italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.35.35.3" style="padding:-1.5pt 2.0pt;">the trajectory from the <math alttext="i" class="ltx_Math" display="inline" id="A0.T1.34.34.2.m1.1"><semantics id="A0.T1.34.34.2.m1.1a"><mi id="A0.T1.34.34.2.m1.1.1" xref="A0.T1.34.34.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A0.T1.34.34.2.m1.1b"><ci id="A0.T1.34.34.2.m1.1.1.cmml" xref="A0.T1.34.34.2.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.34.34.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A0.T1.34.34.2.m1.1d">italic_i</annotation></semantics></math>-th simulation for the user <math alttext="u" class="ltx_Math" display="inline" id="A0.T1.35.35.3.m2.1"><semantics id="A0.T1.35.35.3.m2.1a"><mi id="A0.T1.35.35.3.m2.1.1" xref="A0.T1.35.35.3.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A0.T1.35.35.3.m2.1b"><ci id="A0.T1.35.35.3.m2.1.1.cmml" xref="A0.T1.35.35.3.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.35.35.3.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="A0.T1.35.35.3.m2.1d">italic_u</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A0.T1.39.39">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.36.36.1" style="padding:-1.5pt 2.0pt;"><math alttext="R(\tau^{(u)}_{i},t)" class="ltx_Math" display="inline" id="A0.T1.36.36.1.m1.3"><semantics id="A0.T1.36.36.1.m1.3a"><mrow id="A0.T1.36.36.1.m1.3.3" xref="A0.T1.36.36.1.m1.3.3.cmml"><mi id="A0.T1.36.36.1.m1.3.3.3" xref="A0.T1.36.36.1.m1.3.3.3.cmml">R</mi><mo id="A0.T1.36.36.1.m1.3.3.2" xref="A0.T1.36.36.1.m1.3.3.2.cmml">⁢</mo><mrow id="A0.T1.36.36.1.m1.3.3.1.1" xref="A0.T1.36.36.1.m1.3.3.1.2.cmml"><mo id="A0.T1.36.36.1.m1.3.3.1.1.2" stretchy="false" xref="A0.T1.36.36.1.m1.3.3.1.2.cmml">(</mo><msubsup id="A0.T1.36.36.1.m1.3.3.1.1.1" xref="A0.T1.36.36.1.m1.3.3.1.1.1.cmml"><mi id="A0.T1.36.36.1.m1.3.3.1.1.1.2.2" xref="A0.T1.36.36.1.m1.3.3.1.1.1.2.2.cmml">τ</mi><mi id="A0.T1.36.36.1.m1.3.3.1.1.1.3" xref="A0.T1.36.36.1.m1.3.3.1.1.1.3.cmml">i</mi><mrow id="A0.T1.36.36.1.m1.1.1.1.3" xref="A0.T1.36.36.1.m1.3.3.1.1.1.cmml"><mo id="A0.T1.36.36.1.m1.1.1.1.3.1" stretchy="false" xref="A0.T1.36.36.1.m1.3.3.1.1.1.cmml">(</mo><mi id="A0.T1.36.36.1.m1.1.1.1.1" xref="A0.T1.36.36.1.m1.1.1.1.1.cmml">u</mi><mo id="A0.T1.36.36.1.m1.1.1.1.3.2" stretchy="false" xref="A0.T1.36.36.1.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A0.T1.36.36.1.m1.3.3.1.1.3" xref="A0.T1.36.36.1.m1.3.3.1.2.cmml">,</mo><mi id="A0.T1.36.36.1.m1.2.2" xref="A0.T1.36.36.1.m1.2.2.cmml">t</mi><mo id="A0.T1.36.36.1.m1.3.3.1.1.4" stretchy="false" xref="A0.T1.36.36.1.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.36.36.1.m1.3b"><apply id="A0.T1.36.36.1.m1.3.3.cmml" xref="A0.T1.36.36.1.m1.3.3"><times id="A0.T1.36.36.1.m1.3.3.2.cmml" xref="A0.T1.36.36.1.m1.3.3.2"></times><ci id="A0.T1.36.36.1.m1.3.3.3.cmml" xref="A0.T1.36.36.1.m1.3.3.3">𝑅</ci><interval closure="open" id="A0.T1.36.36.1.m1.3.3.1.2.cmml" xref="A0.T1.36.36.1.m1.3.3.1.1"><apply id="A0.T1.36.36.1.m1.3.3.1.1.1.cmml" xref="A0.T1.36.36.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A0.T1.36.36.1.m1.3.3.1.1.1.1.cmml" xref="A0.T1.36.36.1.m1.3.3.1.1.1">subscript</csymbol><apply id="A0.T1.36.36.1.m1.3.3.1.1.1.2.cmml" xref="A0.T1.36.36.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A0.T1.36.36.1.m1.3.3.1.1.1.2.1.cmml" xref="A0.T1.36.36.1.m1.3.3.1.1.1">superscript</csymbol><ci id="A0.T1.36.36.1.m1.3.3.1.1.1.2.2.cmml" xref="A0.T1.36.36.1.m1.3.3.1.1.1.2.2">𝜏</ci><ci id="A0.T1.36.36.1.m1.1.1.1.1.cmml" xref="A0.T1.36.36.1.m1.1.1.1.1">𝑢</ci></apply><ci id="A0.T1.36.36.1.m1.3.3.1.1.1.3.cmml" xref="A0.T1.36.36.1.m1.3.3.1.1.1.3">𝑖</ci></apply><ci id="A0.T1.36.36.1.m1.2.2.cmml" xref="A0.T1.36.36.1.m1.2.2">𝑡</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.36.36.1.m1.3c">R(\tau^{(u)}_{i},t)</annotation><annotation encoding="application/x-llamapun" id="A0.T1.36.36.1.m1.3d">italic_R ( italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_t )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.39.39.4" style="padding:-1.5pt 2.0pt;">the cumulative reward of trajectory <math alttext="\tau^{(u)}_{i}" class="ltx_Math" display="inline" id="A0.T1.37.37.2.m1.1"><semantics id="A0.T1.37.37.2.m1.1a"><msubsup id="A0.T1.37.37.2.m1.1.2" xref="A0.T1.37.37.2.m1.1.2.cmml"><mi id="A0.T1.37.37.2.m1.1.2.2.2" xref="A0.T1.37.37.2.m1.1.2.2.2.cmml">τ</mi><mi id="A0.T1.37.37.2.m1.1.2.3" xref="A0.T1.37.37.2.m1.1.2.3.cmml">i</mi><mrow id="A0.T1.37.37.2.m1.1.1.1.3" xref="A0.T1.37.37.2.m1.1.2.cmml"><mo id="A0.T1.37.37.2.m1.1.1.1.3.1" stretchy="false" xref="A0.T1.37.37.2.m1.1.2.cmml">(</mo><mi id="A0.T1.37.37.2.m1.1.1.1.1" xref="A0.T1.37.37.2.m1.1.1.1.1.cmml">u</mi><mo id="A0.T1.37.37.2.m1.1.1.1.3.2" stretchy="false" xref="A0.T1.37.37.2.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A0.T1.37.37.2.m1.1b"><apply id="A0.T1.37.37.2.m1.1.2.cmml" xref="A0.T1.37.37.2.m1.1.2"><csymbol cd="ambiguous" id="A0.T1.37.37.2.m1.1.2.1.cmml" xref="A0.T1.37.37.2.m1.1.2">subscript</csymbol><apply id="A0.T1.37.37.2.m1.1.2.2.cmml" xref="A0.T1.37.37.2.m1.1.2"><csymbol cd="ambiguous" id="A0.T1.37.37.2.m1.1.2.2.1.cmml" xref="A0.T1.37.37.2.m1.1.2">superscript</csymbol><ci id="A0.T1.37.37.2.m1.1.2.2.2.cmml" xref="A0.T1.37.37.2.m1.1.2.2.2">𝜏</ci><ci id="A0.T1.37.37.2.m1.1.1.1.1.cmml" xref="A0.T1.37.37.2.m1.1.1.1.1">𝑢</ci></apply><ci id="A0.T1.37.37.2.m1.1.2.3.cmml" xref="A0.T1.37.37.2.m1.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.37.37.2.m1.1c">\tau^{(u)}_{i}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.37.37.2.m1.1d">italic_τ start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from turn <math alttext="t" class="ltx_Math" display="inline" id="A0.T1.38.38.3.m2.1"><semantics id="A0.T1.38.38.3.m2.1a"><mi id="A0.T1.38.38.3.m2.1.1" xref="A0.T1.38.38.3.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A0.T1.38.38.3.m2.1b"><ci id="A0.T1.38.38.3.m2.1.1.cmml" xref="A0.T1.38.38.3.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.38.38.3.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="A0.T1.38.38.3.m2.1d">italic_t</annotation></semantics></math> to the final turn <math alttext="T" class="ltx_Math" display="inline" id="A0.T1.39.39.4.m3.1"><semantics id="A0.T1.39.39.4.m3.1a"><mi id="A0.T1.39.39.4.m3.1.1" xref="A0.T1.39.39.4.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A0.T1.39.39.4.m3.1b"><ci id="A0.T1.39.39.4.m3.1.1.cmml" xref="A0.T1.39.39.4.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.39.39.4.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="A0.T1.39.39.4.m3.1d">italic_T</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A0.T1.41.41">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.40.40.1" style="padding:-1.5pt 2.0pt;"><math alttext="V(s_{t})" class="ltx_Math" display="inline" id="A0.T1.40.40.1.m1.1"><semantics id="A0.T1.40.40.1.m1.1a"><mrow id="A0.T1.40.40.1.m1.1.1" xref="A0.T1.40.40.1.m1.1.1.cmml"><mi id="A0.T1.40.40.1.m1.1.1.3" xref="A0.T1.40.40.1.m1.1.1.3.cmml">V</mi><mo id="A0.T1.40.40.1.m1.1.1.2" xref="A0.T1.40.40.1.m1.1.1.2.cmml">⁢</mo><mrow id="A0.T1.40.40.1.m1.1.1.1.1" xref="A0.T1.40.40.1.m1.1.1.1.1.1.cmml"><mo id="A0.T1.40.40.1.m1.1.1.1.1.2" stretchy="false" xref="A0.T1.40.40.1.m1.1.1.1.1.1.cmml">(</mo><msub id="A0.T1.40.40.1.m1.1.1.1.1.1" xref="A0.T1.40.40.1.m1.1.1.1.1.1.cmml"><mi id="A0.T1.40.40.1.m1.1.1.1.1.1.2" xref="A0.T1.40.40.1.m1.1.1.1.1.1.2.cmml">s</mi><mi id="A0.T1.40.40.1.m1.1.1.1.1.1.3" xref="A0.T1.40.40.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A0.T1.40.40.1.m1.1.1.1.1.3" stretchy="false" xref="A0.T1.40.40.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.40.40.1.m1.1b"><apply id="A0.T1.40.40.1.m1.1.1.cmml" xref="A0.T1.40.40.1.m1.1.1"><times id="A0.T1.40.40.1.m1.1.1.2.cmml" xref="A0.T1.40.40.1.m1.1.1.2"></times><ci id="A0.T1.40.40.1.m1.1.1.3.cmml" xref="A0.T1.40.40.1.m1.1.1.3">𝑉</ci><apply id="A0.T1.40.40.1.m1.1.1.1.1.1.cmml" xref="A0.T1.40.40.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.40.40.1.m1.1.1.1.1.1.1.cmml" xref="A0.T1.40.40.1.m1.1.1.1.1">subscript</csymbol><ci id="A0.T1.40.40.1.m1.1.1.1.1.1.2.cmml" xref="A0.T1.40.40.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="A0.T1.40.40.1.m1.1.1.1.1.1.3.cmml" xref="A0.T1.40.40.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.40.40.1.m1.1c">V(s_{t})</annotation><annotation encoding="application/x-llamapun" id="A0.T1.40.40.1.m1.1d">italic_V ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.41.41.2" style="padding:-1.5pt 2.0pt;">the visit count of node <math alttext="s_{t}" class="ltx_Math" display="inline" id="A0.T1.41.41.2.m1.1"><semantics id="A0.T1.41.41.2.m1.1a"><msub id="A0.T1.41.41.2.m1.1.1" xref="A0.T1.41.41.2.m1.1.1.cmml"><mi id="A0.T1.41.41.2.m1.1.1.2" xref="A0.T1.41.41.2.m1.1.1.2.cmml">s</mi><mi id="A0.T1.41.41.2.m1.1.1.3" xref="A0.T1.41.41.2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.41.41.2.m1.1b"><apply id="A0.T1.41.41.2.m1.1.1.cmml" xref="A0.T1.41.41.2.m1.1.1"><csymbol cd="ambiguous" id="A0.T1.41.41.2.m1.1.1.1.cmml" xref="A0.T1.41.41.2.m1.1.1">subscript</csymbol><ci id="A0.T1.41.41.2.m1.1.1.2.cmml" xref="A0.T1.41.41.2.m1.1.1.2">𝑠</ci><ci id="A0.T1.41.41.2.m1.1.1.3.cmml" xref="A0.T1.41.41.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.41.41.2.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.41.41.2.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> during MCTS simulations</td>
</tr>
<tr class="ltx_tr" id="A0.T1.44.44">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.42.42.1" style="padding:-1.5pt 2.0pt;"><math alttext="f(s_{t},o_{t})" class="ltx_Math" display="inline" id="A0.T1.42.42.1.m1.2"><semantics id="A0.T1.42.42.1.m1.2a"><mrow id="A0.T1.42.42.1.m1.2.2" xref="A0.T1.42.42.1.m1.2.2.cmml"><mi id="A0.T1.42.42.1.m1.2.2.4" xref="A0.T1.42.42.1.m1.2.2.4.cmml">f</mi><mo id="A0.T1.42.42.1.m1.2.2.3" xref="A0.T1.42.42.1.m1.2.2.3.cmml">⁢</mo><mrow id="A0.T1.42.42.1.m1.2.2.2.2" xref="A0.T1.42.42.1.m1.2.2.2.3.cmml"><mo id="A0.T1.42.42.1.m1.2.2.2.2.3" stretchy="false" xref="A0.T1.42.42.1.m1.2.2.2.3.cmml">(</mo><msub id="A0.T1.42.42.1.m1.1.1.1.1.1" xref="A0.T1.42.42.1.m1.1.1.1.1.1.cmml"><mi id="A0.T1.42.42.1.m1.1.1.1.1.1.2" xref="A0.T1.42.42.1.m1.1.1.1.1.1.2.cmml">s</mi><mi id="A0.T1.42.42.1.m1.1.1.1.1.1.3" xref="A0.T1.42.42.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A0.T1.42.42.1.m1.2.2.2.2.4" xref="A0.T1.42.42.1.m1.2.2.2.3.cmml">,</mo><msub id="A0.T1.42.42.1.m1.2.2.2.2.2" xref="A0.T1.42.42.1.m1.2.2.2.2.2.cmml"><mi id="A0.T1.42.42.1.m1.2.2.2.2.2.2" xref="A0.T1.42.42.1.m1.2.2.2.2.2.2.cmml">o</mi><mi id="A0.T1.42.42.1.m1.2.2.2.2.2.3" xref="A0.T1.42.42.1.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="A0.T1.42.42.1.m1.2.2.2.2.5" stretchy="false" xref="A0.T1.42.42.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.T1.42.42.1.m1.2b"><apply id="A0.T1.42.42.1.m1.2.2.cmml" xref="A0.T1.42.42.1.m1.2.2"><times id="A0.T1.42.42.1.m1.2.2.3.cmml" xref="A0.T1.42.42.1.m1.2.2.3"></times><ci id="A0.T1.42.42.1.m1.2.2.4.cmml" xref="A0.T1.42.42.1.m1.2.2.4">𝑓</ci><interval closure="open" id="A0.T1.42.42.1.m1.2.2.2.3.cmml" xref="A0.T1.42.42.1.m1.2.2.2.2"><apply id="A0.T1.42.42.1.m1.1.1.1.1.1.cmml" xref="A0.T1.42.42.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A0.T1.42.42.1.m1.1.1.1.1.1.1.cmml" xref="A0.T1.42.42.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A0.T1.42.42.1.m1.1.1.1.1.1.2.cmml" xref="A0.T1.42.42.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="A0.T1.42.42.1.m1.1.1.1.1.1.3.cmml" xref="A0.T1.42.42.1.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A0.T1.42.42.1.m1.2.2.2.2.2.cmml" xref="A0.T1.42.42.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.T1.42.42.1.m1.2.2.2.2.2.1.cmml" xref="A0.T1.42.42.1.m1.2.2.2.2.2">subscript</csymbol><ci id="A0.T1.42.42.1.m1.2.2.2.2.2.2.cmml" xref="A0.T1.42.42.1.m1.2.2.2.2.2.2">𝑜</ci><ci id="A0.T1.42.42.1.m1.2.2.2.2.2.3.cmml" xref="A0.T1.42.42.1.m1.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.42.42.1.m1.2c">f(s_{t},o_{t})</annotation><annotation encoding="application/x-llamapun" id="A0.T1.42.42.1.m1.2d">italic_f ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.44.44.3" style="padding:-1.5pt 2.0pt;">the child node of <math alttext="s_{t}" class="ltx_Math" display="inline" id="A0.T1.43.43.2.m1.1"><semantics id="A0.T1.43.43.2.m1.1a"><msub id="A0.T1.43.43.2.m1.1.1" xref="A0.T1.43.43.2.m1.1.1.cmml"><mi id="A0.T1.43.43.2.m1.1.1.2" xref="A0.T1.43.43.2.m1.1.1.2.cmml">s</mi><mi id="A0.T1.43.43.2.m1.1.1.3" xref="A0.T1.43.43.2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.43.43.2.m1.1b"><apply id="A0.T1.43.43.2.m1.1.1.cmml" xref="A0.T1.43.43.2.m1.1.1"><csymbol cd="ambiguous" id="A0.T1.43.43.2.m1.1.1.1.cmml" xref="A0.T1.43.43.2.m1.1.1">subscript</csymbol><ci id="A0.T1.43.43.2.m1.1.1.2.cmml" xref="A0.T1.43.43.2.m1.1.1.2">𝑠</ci><ci id="A0.T1.43.43.2.m1.1.1.3.cmml" xref="A0.T1.43.43.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.43.43.2.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.43.43.2.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> after choosing the action type <math alttext="o_{t}" class="ltx_Math" display="inline" id="A0.T1.44.44.3.m2.1"><semantics id="A0.T1.44.44.3.m2.1a"><msub id="A0.T1.44.44.3.m2.1.1" xref="A0.T1.44.44.3.m2.1.1.cmml"><mi id="A0.T1.44.44.3.m2.1.1.2" xref="A0.T1.44.44.3.m2.1.1.2.cmml">o</mi><mi id="A0.T1.44.44.3.m2.1.1.3" xref="A0.T1.44.44.3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A0.T1.44.44.3.m2.1b"><apply id="A0.T1.44.44.3.m2.1.1.cmml" xref="A0.T1.44.44.3.m2.1.1"><csymbol cd="ambiguous" id="A0.T1.44.44.3.m2.1.1.1.cmml" xref="A0.T1.44.44.3.m2.1.1">subscript</csymbol><ci id="A0.T1.44.44.3.m2.1.1.2.cmml" xref="A0.T1.44.44.3.m2.1.1.2">𝑜</ci><ci id="A0.T1.44.44.3.m2.1.1.3.cmml" xref="A0.T1.44.44.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.44.44.3.m2.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="A0.T1.44.44.3.m2.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A0.T1.45.45">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.45.45.1" style="padding:-1.5pt 2.0pt;"><math alttext="E" class="ltx_Math" display="inline" id="A0.T1.45.45.1.m1.1"><semantics id="A0.T1.45.45.1.m1.1a"><mi id="A0.T1.45.45.1.m1.1.1" xref="A0.T1.45.45.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A0.T1.45.45.1.m1.1b"><ci id="A0.T1.45.45.1.m1.1.1.cmml" xref="A0.T1.45.45.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.45.45.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="A0.T1.45.45.1.m1.1d">italic_E</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.45.45.2" style="padding:-1.5pt 2.0pt;">training steps</td>
</tr>
<tr class="ltx_tr" id="A0.T1.46.46">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A0.T1.46.46.1" style="padding:-1.5pt 2.0pt;"><math alttext="N" class="ltx_Math" display="inline" id="A0.T1.46.46.1.m1.1"><semantics id="A0.T1.46.46.1.m1.1a"><mi id="A0.T1.46.46.1.m1.1.1" xref="A0.T1.46.46.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A0.T1.46.46.1.m1.1b"><ci id="A0.T1.46.46.1.m1.1.1.cmml" xref="A0.T1.46.46.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.46.46.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A0.T1.46.46.1.m1.1d">italic_N</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A0.T1.46.46.2" style="padding:-1.5pt 2.0pt;">the number of simulations in MCTS</td>
</tr>
<tr class="ltx_tr" id="A0.T1.47.47">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A0.T1.47.47.1" style="padding:-1.5pt 2.0pt;"><math alttext="w" class="ltx_Math" display="inline" id="A0.T1.47.47.1.m1.1"><semantics id="A0.T1.47.47.1.m1.1a"><mi id="A0.T1.47.47.1.m1.1.1" xref="A0.T1.47.47.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A0.T1.47.47.1.m1.1b"><ci id="A0.T1.47.47.1.m1.1.1.cmml" xref="A0.T1.47.47.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A0.T1.47.47.1.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="A0.T1.47.47.1.m1.1d">italic_w</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A0.T1.47.47.2" style="padding:-1.5pt 2.0pt;">the exploration factor in UCT</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table A1: </span>Table of notations.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Table of Notations</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A0.T1" title="Table A1 ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">A1</span></a> summarizes the notations in this paper.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional Related Works</h2>
<section class="ltx_paragraph" id="A2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Reinforcement Learning for CRS</h4>
<div class="ltx_para" id="A2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A2.SS0.SSS0.Px1.p1.1">Reinforcement Learning (RL) has achieved great success in tasks requiring strategic planning in complex and interactive environments, such as computer Go <cite class="ltx_cite ltx_citemacro_cite">Silver et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib39" title="">2016</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib40" title="">2017</a>)</cite> and dialogue planning <cite class="ltx_cite ltx_citemacro_cite">Yu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib48" title="">2023</a>); He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib17" title="">2024</a>)</cite>. RL is also employed to train CRS agents to make strategic actions, and current RL-based CRSs can be mainly categorized into two types of methods: <span class="ltx_text ltx_font_bold" id="A2.SS0.SSS0.Px1.p1.1.1">(1)</span> policy-based methods, which train a policy network that directly outputs the probability of taking each action <cite class="ltx_cite ltx_citemacro_cite">Sun and Zhang (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib41" title="">2018</a>); Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib26" title="">2020a</a>)</cite>, and <span class="ltx_text ltx_font_bold" id="A2.SS0.SSS0.Px1.p1.1.2">(2)</span> value-based methods, which train a Q-network <cite class="ltx_cite ltx_citemacro_cite">van Hasselt et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib43" title="">2016</a>)</cite> to estimate the Q-value of actions <cite class="ltx_cite ltx_citemacro_cite">Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>)</cite>.
Despite promising, these CRS methods may suffer from myopic conversational planning and suboptimal decisions due to their greedy action selection and sampling strategy.
<em class="ltx_emph ltx_font_italic" id="A2.SS0.SSS0.Px1.p1.1.3">In contrast to these methods, our new <span class="ltx_ERROR undefined" id="A2.SS0.SSS0.Px1.p1.1.3.1">\method</span>is able to achieve strategic and non-myopic conversational planning through an MCTS-based planning and self-training algorithm.</em></p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Details of the State Encoder</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.15"><span class="ltx_text ltx_font_bold" id="A3.p1.15.1">Global information graph encoder</span> captures the global relationships between similar users and items, as well as the correlations between items and attribute values from the global information graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="A3.p1.1.m1.1"><semantics id="A3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.1.m1.1d">caligraphic_G</annotation></semantics></math>. We build <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="A3.p1.2.m2.1"><semantics id="A3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><ci id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.2.m2.1d">caligraphic_G</annotation></semantics></math> with the following rules: an edge <math alttext="e_{u,v}\in\mathcal{E}_{\mathcal{U},\mathcal{V}}" class="ltx_Math" display="inline" id="A3.p1.3.m3.4"><semantics id="A3.p1.3.m3.4a"><mrow id="A3.p1.3.m3.4.5" xref="A3.p1.3.m3.4.5.cmml"><msub id="A3.p1.3.m3.4.5.2" xref="A3.p1.3.m3.4.5.2.cmml"><mi id="A3.p1.3.m3.4.5.2.2" xref="A3.p1.3.m3.4.5.2.2.cmml">e</mi><mrow id="A3.p1.3.m3.2.2.2.4" xref="A3.p1.3.m3.2.2.2.3.cmml"><mi id="A3.p1.3.m3.1.1.1.1" xref="A3.p1.3.m3.1.1.1.1.cmml">u</mi><mo id="A3.p1.3.m3.2.2.2.4.1" xref="A3.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="A3.p1.3.m3.2.2.2.2" xref="A3.p1.3.m3.2.2.2.2.cmml">v</mi></mrow></msub><mo id="A3.p1.3.m3.4.5.1" xref="A3.p1.3.m3.4.5.1.cmml">∈</mo><msub id="A3.p1.3.m3.4.5.3" xref="A3.p1.3.m3.4.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p1.3.m3.4.5.3.2" xref="A3.p1.3.m3.4.5.3.2.cmml">ℰ</mi><mrow id="A3.p1.3.m3.4.4.2.4" xref="A3.p1.3.m3.4.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p1.3.m3.3.3.1.1" xref="A3.p1.3.m3.3.3.1.1.cmml">𝒰</mi><mo id="A3.p1.3.m3.4.4.2.4.1" xref="A3.p1.3.m3.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A3.p1.3.m3.4.4.2.2" xref="A3.p1.3.m3.4.4.2.2.cmml">𝒱</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.4b"><apply id="A3.p1.3.m3.4.5.cmml" xref="A3.p1.3.m3.4.5"><in id="A3.p1.3.m3.4.5.1.cmml" xref="A3.p1.3.m3.4.5.1"></in><apply id="A3.p1.3.m3.4.5.2.cmml" xref="A3.p1.3.m3.4.5.2"><csymbol cd="ambiguous" id="A3.p1.3.m3.4.5.2.1.cmml" xref="A3.p1.3.m3.4.5.2">subscript</csymbol><ci id="A3.p1.3.m3.4.5.2.2.cmml" xref="A3.p1.3.m3.4.5.2.2">𝑒</ci><list id="A3.p1.3.m3.2.2.2.3.cmml" xref="A3.p1.3.m3.2.2.2.4"><ci id="A3.p1.3.m3.1.1.1.1.cmml" xref="A3.p1.3.m3.1.1.1.1">𝑢</ci><ci id="A3.p1.3.m3.2.2.2.2.cmml" xref="A3.p1.3.m3.2.2.2.2">𝑣</ci></list></apply><apply id="A3.p1.3.m3.4.5.3.cmml" xref="A3.p1.3.m3.4.5.3"><csymbol cd="ambiguous" id="A3.p1.3.m3.4.5.3.1.cmml" xref="A3.p1.3.m3.4.5.3">subscript</csymbol><ci id="A3.p1.3.m3.4.5.3.2.cmml" xref="A3.p1.3.m3.4.5.3.2">ℰ</ci><list id="A3.p1.3.m3.4.4.2.3.cmml" xref="A3.p1.3.m3.4.4.2.4"><ci id="A3.p1.3.m3.3.3.1.1.cmml" xref="A3.p1.3.m3.3.3.1.1">𝒰</ci><ci id="A3.p1.3.m3.4.4.2.2.cmml" xref="A3.p1.3.m3.4.4.2.2">𝒱</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.4c">e_{u,v}\in\mathcal{E}_{\mathcal{U},\mathcal{V}}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.3.m3.4d">italic_e start_POSTSUBSCRIPT italic_u , italic_v end_POSTSUBSCRIPT ∈ caligraphic_E start_POSTSUBSCRIPT caligraphic_U , caligraphic_V end_POSTSUBSCRIPT</annotation></semantics></math> exists between a user <math alttext="u" class="ltx_Math" display="inline" id="A3.p1.4.m4.1"><semantics id="A3.p1.4.m4.1a"><mi id="A3.p1.4.m4.1.1" xref="A3.p1.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A3.p1.4.m4.1b"><ci id="A3.p1.4.m4.1.1.cmml" xref="A3.p1.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="A3.p1.4.m4.1d">italic_u</annotation></semantics></math> and an item <math alttext="v" class="ltx_Math" display="inline" id="A3.p1.5.m5.1"><semantics id="A3.p1.5.m5.1a"><mi id="A3.p1.5.m5.1.1" xref="A3.p1.5.m5.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="A3.p1.5.m5.1b"><ci id="A3.p1.5.m5.1.1.cmml" xref="A3.p1.5.m5.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.5.m5.1c">v</annotation><annotation encoding="application/x-llamapun" id="A3.p1.5.m5.1d">italic_v</annotation></semantics></math> iff. the user <math alttext="u" class="ltx_Math" display="inline" id="A3.p1.6.m6.1"><semantics id="A3.p1.6.m6.1a"><mi id="A3.p1.6.m6.1.1" xref="A3.p1.6.m6.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A3.p1.6.m6.1b"><ci id="A3.p1.6.m6.1.1.cmml" xref="A3.p1.6.m6.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.6.m6.1c">u</annotation><annotation encoding="application/x-llamapun" id="A3.p1.6.m6.1d">italic_u</annotation></semantics></math> has interacted with item <math alttext="v" class="ltx_Math" display="inline" id="A3.p1.7.m7.1"><semantics id="A3.p1.7.m7.1a"><mi id="A3.p1.7.m7.1.1" xref="A3.p1.7.m7.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="A3.p1.7.m7.1b"><ci id="A3.p1.7.m7.1.1.cmml" xref="A3.p1.7.m7.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.7.m7.1c">v</annotation><annotation encoding="application/x-llamapun" id="A3.p1.7.m7.1d">italic_v</annotation></semantics></math>, and an edge <math alttext="e_{p,v}\in\mathcal{E}_{\mathcal{P},\mathcal{V}}" class="ltx_Math" display="inline" id="A3.p1.8.m8.4"><semantics id="A3.p1.8.m8.4a"><mrow id="A3.p1.8.m8.4.5" xref="A3.p1.8.m8.4.5.cmml"><msub id="A3.p1.8.m8.4.5.2" xref="A3.p1.8.m8.4.5.2.cmml"><mi id="A3.p1.8.m8.4.5.2.2" xref="A3.p1.8.m8.4.5.2.2.cmml">e</mi><mrow id="A3.p1.8.m8.2.2.2.4" xref="A3.p1.8.m8.2.2.2.3.cmml"><mi id="A3.p1.8.m8.1.1.1.1" xref="A3.p1.8.m8.1.1.1.1.cmml">p</mi><mo id="A3.p1.8.m8.2.2.2.4.1" xref="A3.p1.8.m8.2.2.2.3.cmml">,</mo><mi id="A3.p1.8.m8.2.2.2.2" xref="A3.p1.8.m8.2.2.2.2.cmml">v</mi></mrow></msub><mo id="A3.p1.8.m8.4.5.1" xref="A3.p1.8.m8.4.5.1.cmml">∈</mo><msub id="A3.p1.8.m8.4.5.3" xref="A3.p1.8.m8.4.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p1.8.m8.4.5.3.2" xref="A3.p1.8.m8.4.5.3.2.cmml">ℰ</mi><mrow id="A3.p1.8.m8.4.4.2.4" xref="A3.p1.8.m8.4.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p1.8.m8.3.3.1.1" xref="A3.p1.8.m8.3.3.1.1.cmml">𝒫</mi><mo id="A3.p1.8.m8.4.4.2.4.1" xref="A3.p1.8.m8.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A3.p1.8.m8.4.4.2.2" xref="A3.p1.8.m8.4.4.2.2.cmml">𝒱</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.8.m8.4b"><apply id="A3.p1.8.m8.4.5.cmml" xref="A3.p1.8.m8.4.5"><in id="A3.p1.8.m8.4.5.1.cmml" xref="A3.p1.8.m8.4.5.1"></in><apply id="A3.p1.8.m8.4.5.2.cmml" xref="A3.p1.8.m8.4.5.2"><csymbol cd="ambiguous" id="A3.p1.8.m8.4.5.2.1.cmml" xref="A3.p1.8.m8.4.5.2">subscript</csymbol><ci id="A3.p1.8.m8.4.5.2.2.cmml" xref="A3.p1.8.m8.4.5.2.2">𝑒</ci><list id="A3.p1.8.m8.2.2.2.3.cmml" xref="A3.p1.8.m8.2.2.2.4"><ci id="A3.p1.8.m8.1.1.1.1.cmml" xref="A3.p1.8.m8.1.1.1.1">𝑝</ci><ci id="A3.p1.8.m8.2.2.2.2.cmml" xref="A3.p1.8.m8.2.2.2.2">𝑣</ci></list></apply><apply id="A3.p1.8.m8.4.5.3.cmml" xref="A3.p1.8.m8.4.5.3"><csymbol cd="ambiguous" id="A3.p1.8.m8.4.5.3.1.cmml" xref="A3.p1.8.m8.4.5.3">subscript</csymbol><ci id="A3.p1.8.m8.4.5.3.2.cmml" xref="A3.p1.8.m8.4.5.3.2">ℰ</ci><list id="A3.p1.8.m8.4.4.2.3.cmml" xref="A3.p1.8.m8.4.4.2.4"><ci id="A3.p1.8.m8.3.3.1.1.cmml" xref="A3.p1.8.m8.3.3.1.1">𝒫</ci><ci id="A3.p1.8.m8.4.4.2.2.cmml" xref="A3.p1.8.m8.4.4.2.2">𝒱</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.8.m8.4c">e_{p,v}\in\mathcal{E}_{\mathcal{P},\mathcal{V}}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.8.m8.4d">italic_e start_POSTSUBSCRIPT italic_p , italic_v end_POSTSUBSCRIPT ∈ caligraphic_E start_POSTSUBSCRIPT caligraphic_P , caligraphic_V end_POSTSUBSCRIPT</annotation></semantics></math> exists between an attribute value <math alttext="p" class="ltx_Math" display="inline" id="A3.p1.9.m9.1"><semantics id="A3.p1.9.m9.1a"><mi id="A3.p1.9.m9.1.1" xref="A3.p1.9.m9.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A3.p1.9.m9.1b"><ci id="A3.p1.9.m9.1.1.cmml" xref="A3.p1.9.m9.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.9.m9.1c">p</annotation><annotation encoding="application/x-llamapun" id="A3.p1.9.m9.1d">italic_p</annotation></semantics></math> and an item <math alttext="v" class="ltx_Math" display="inline" id="A3.p1.10.m10.1"><semantics id="A3.p1.10.m10.1a"><mi id="A3.p1.10.m10.1.1" xref="A3.p1.10.m10.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="A3.p1.10.m10.1b"><ci id="A3.p1.10.m10.1.1.cmml" xref="A3.p1.10.m10.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.10.m10.1c">v</annotation><annotation encoding="application/x-llamapun" id="A3.p1.10.m10.1d">italic_v</annotation></semantics></math> iff. item <math alttext="v" class="ltx_Math" display="inline" id="A3.p1.11.m11.1"><semantics id="A3.p1.11.m11.1a"><mi id="A3.p1.11.m11.1.1" xref="A3.p1.11.m11.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="A3.p1.11.m11.1b"><ci id="A3.p1.11.m11.1.1.cmml" xref="A3.p1.11.m11.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.11.m11.1c">v</annotation><annotation encoding="application/x-llamapun" id="A3.p1.11.m11.1d">italic_v</annotation></semantics></math> is associated with attribute value <math alttext="v" class="ltx_Math" display="inline" id="A3.p1.12.m12.1"><semantics id="A3.p1.12.m12.1a"><mi id="A3.p1.12.m12.1.1" xref="A3.p1.12.m12.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="A3.p1.12.m12.1b"><ci id="A3.p1.12.m12.1.1.cmml" xref="A3.p1.12.m12.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.12.m12.1c">v</annotation><annotation encoding="application/x-llamapun" id="A3.p1.12.m12.1d">italic_v</annotation></semantics></math>. Next, let <math alttext="\mathbf{h}^{(0)}_{u}=\mathbf{e}_{u}" class="ltx_Math" display="inline" id="A3.p1.13.m13.1"><semantics id="A3.p1.13.m13.1a"><mrow id="A3.p1.13.m13.1.2" xref="A3.p1.13.m13.1.2.cmml"><msubsup id="A3.p1.13.m13.1.2.2" xref="A3.p1.13.m13.1.2.2.cmml"><mi id="A3.p1.13.m13.1.2.2.2.2" xref="A3.p1.13.m13.1.2.2.2.2.cmml">𝐡</mi><mi id="A3.p1.13.m13.1.2.2.3" xref="A3.p1.13.m13.1.2.2.3.cmml">u</mi><mrow id="A3.p1.13.m13.1.1.1.3" xref="A3.p1.13.m13.1.2.2.cmml"><mo id="A3.p1.13.m13.1.1.1.3.1" stretchy="false" xref="A3.p1.13.m13.1.2.2.cmml">(</mo><mn id="A3.p1.13.m13.1.1.1.1" xref="A3.p1.13.m13.1.1.1.1.cmml">0</mn><mo id="A3.p1.13.m13.1.1.1.3.2" stretchy="false" xref="A3.p1.13.m13.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A3.p1.13.m13.1.2.1" xref="A3.p1.13.m13.1.2.1.cmml">=</mo><msub id="A3.p1.13.m13.1.2.3" xref="A3.p1.13.m13.1.2.3.cmml"><mi id="A3.p1.13.m13.1.2.3.2" xref="A3.p1.13.m13.1.2.3.2.cmml">𝐞</mi><mi id="A3.p1.13.m13.1.2.3.3" xref="A3.p1.13.m13.1.2.3.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.13.m13.1b"><apply id="A3.p1.13.m13.1.2.cmml" xref="A3.p1.13.m13.1.2"><eq id="A3.p1.13.m13.1.2.1.cmml" xref="A3.p1.13.m13.1.2.1"></eq><apply id="A3.p1.13.m13.1.2.2.cmml" xref="A3.p1.13.m13.1.2.2"><csymbol cd="ambiguous" id="A3.p1.13.m13.1.2.2.1.cmml" xref="A3.p1.13.m13.1.2.2">subscript</csymbol><apply id="A3.p1.13.m13.1.2.2.2.cmml" xref="A3.p1.13.m13.1.2.2"><csymbol cd="ambiguous" id="A3.p1.13.m13.1.2.2.2.1.cmml" xref="A3.p1.13.m13.1.2.2">superscript</csymbol><ci id="A3.p1.13.m13.1.2.2.2.2.cmml" xref="A3.p1.13.m13.1.2.2.2.2">𝐡</ci><cn id="A3.p1.13.m13.1.1.1.1.cmml" type="integer" xref="A3.p1.13.m13.1.1.1.1">0</cn></apply><ci id="A3.p1.13.m13.1.2.2.3.cmml" xref="A3.p1.13.m13.1.2.2.3">𝑢</ci></apply><apply id="A3.p1.13.m13.1.2.3.cmml" xref="A3.p1.13.m13.1.2.3"><csymbol cd="ambiguous" id="A3.p1.13.m13.1.2.3.1.cmml" xref="A3.p1.13.m13.1.2.3">subscript</csymbol><ci id="A3.p1.13.m13.1.2.3.2.cmml" xref="A3.p1.13.m13.1.2.3.2">𝐞</ci><ci id="A3.p1.13.m13.1.2.3.3.cmml" xref="A3.p1.13.m13.1.2.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.13.m13.1c">\mathbf{h}^{(0)}_{u}=\mathbf{e}_{u}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.13.m13.1d">bold_h start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = bold_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{h}^{(0)}_{v}=\mathbf{e}_{v}" class="ltx_Math" display="inline" id="A3.p1.14.m14.1"><semantics id="A3.p1.14.m14.1a"><mrow id="A3.p1.14.m14.1.2" xref="A3.p1.14.m14.1.2.cmml"><msubsup id="A3.p1.14.m14.1.2.2" xref="A3.p1.14.m14.1.2.2.cmml"><mi id="A3.p1.14.m14.1.2.2.2.2" xref="A3.p1.14.m14.1.2.2.2.2.cmml">𝐡</mi><mi id="A3.p1.14.m14.1.2.2.3" xref="A3.p1.14.m14.1.2.2.3.cmml">v</mi><mrow id="A3.p1.14.m14.1.1.1.3" xref="A3.p1.14.m14.1.2.2.cmml"><mo id="A3.p1.14.m14.1.1.1.3.1" stretchy="false" xref="A3.p1.14.m14.1.2.2.cmml">(</mo><mn id="A3.p1.14.m14.1.1.1.1" xref="A3.p1.14.m14.1.1.1.1.cmml">0</mn><mo id="A3.p1.14.m14.1.1.1.3.2" stretchy="false" xref="A3.p1.14.m14.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A3.p1.14.m14.1.2.1" xref="A3.p1.14.m14.1.2.1.cmml">=</mo><msub id="A3.p1.14.m14.1.2.3" xref="A3.p1.14.m14.1.2.3.cmml"><mi id="A3.p1.14.m14.1.2.3.2" xref="A3.p1.14.m14.1.2.3.2.cmml">𝐞</mi><mi id="A3.p1.14.m14.1.2.3.3" xref="A3.p1.14.m14.1.2.3.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.14.m14.1b"><apply id="A3.p1.14.m14.1.2.cmml" xref="A3.p1.14.m14.1.2"><eq id="A3.p1.14.m14.1.2.1.cmml" xref="A3.p1.14.m14.1.2.1"></eq><apply id="A3.p1.14.m14.1.2.2.cmml" xref="A3.p1.14.m14.1.2.2"><csymbol cd="ambiguous" id="A3.p1.14.m14.1.2.2.1.cmml" xref="A3.p1.14.m14.1.2.2">subscript</csymbol><apply id="A3.p1.14.m14.1.2.2.2.cmml" xref="A3.p1.14.m14.1.2.2"><csymbol cd="ambiguous" id="A3.p1.14.m14.1.2.2.2.1.cmml" xref="A3.p1.14.m14.1.2.2">superscript</csymbol><ci id="A3.p1.14.m14.1.2.2.2.2.cmml" xref="A3.p1.14.m14.1.2.2.2.2">𝐡</ci><cn id="A3.p1.14.m14.1.1.1.1.cmml" type="integer" xref="A3.p1.14.m14.1.1.1.1">0</cn></apply><ci id="A3.p1.14.m14.1.2.2.3.cmml" xref="A3.p1.14.m14.1.2.2.3">𝑣</ci></apply><apply id="A3.p1.14.m14.1.2.3.cmml" xref="A3.p1.14.m14.1.2.3"><csymbol cd="ambiguous" id="A3.p1.14.m14.1.2.3.1.cmml" xref="A3.p1.14.m14.1.2.3">subscript</csymbol><ci id="A3.p1.14.m14.1.2.3.2.cmml" xref="A3.p1.14.m14.1.2.3.2">𝐞</ci><ci id="A3.p1.14.m14.1.2.3.3.cmml" xref="A3.p1.14.m14.1.2.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.14.m14.1c">\mathbf{h}^{(0)}_{v}=\mathbf{e}_{v}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.14.m14.1d">bold_h start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = bold_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{h}^{(0)}_{p}=\mathbf{e}_{p}" class="ltx_Math" display="inline" id="A3.p1.15.m15.1"><semantics id="A3.p1.15.m15.1a"><mrow id="A3.p1.15.m15.1.2" xref="A3.p1.15.m15.1.2.cmml"><msubsup id="A3.p1.15.m15.1.2.2" xref="A3.p1.15.m15.1.2.2.cmml"><mi id="A3.p1.15.m15.1.2.2.2.2" xref="A3.p1.15.m15.1.2.2.2.2.cmml">𝐡</mi><mi id="A3.p1.15.m15.1.2.2.3" xref="A3.p1.15.m15.1.2.2.3.cmml">p</mi><mrow id="A3.p1.15.m15.1.1.1.3" xref="A3.p1.15.m15.1.2.2.cmml"><mo id="A3.p1.15.m15.1.1.1.3.1" stretchy="false" xref="A3.p1.15.m15.1.2.2.cmml">(</mo><mn id="A3.p1.15.m15.1.1.1.1" xref="A3.p1.15.m15.1.1.1.1.cmml">0</mn><mo id="A3.p1.15.m15.1.1.1.3.2" stretchy="false" xref="A3.p1.15.m15.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A3.p1.15.m15.1.2.1" xref="A3.p1.15.m15.1.2.1.cmml">=</mo><msub id="A3.p1.15.m15.1.2.3" xref="A3.p1.15.m15.1.2.3.cmml"><mi id="A3.p1.15.m15.1.2.3.2" xref="A3.p1.15.m15.1.2.3.2.cmml">𝐞</mi><mi id="A3.p1.15.m15.1.2.3.3" xref="A3.p1.15.m15.1.2.3.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.15.m15.1b"><apply id="A3.p1.15.m15.1.2.cmml" xref="A3.p1.15.m15.1.2"><eq id="A3.p1.15.m15.1.2.1.cmml" xref="A3.p1.15.m15.1.2.1"></eq><apply id="A3.p1.15.m15.1.2.2.cmml" xref="A3.p1.15.m15.1.2.2"><csymbol cd="ambiguous" id="A3.p1.15.m15.1.2.2.1.cmml" xref="A3.p1.15.m15.1.2.2">subscript</csymbol><apply id="A3.p1.15.m15.1.2.2.2.cmml" xref="A3.p1.15.m15.1.2.2"><csymbol cd="ambiguous" id="A3.p1.15.m15.1.2.2.2.1.cmml" xref="A3.p1.15.m15.1.2.2">superscript</csymbol><ci id="A3.p1.15.m15.1.2.2.2.2.cmml" xref="A3.p1.15.m15.1.2.2.2.2">𝐡</ci><cn id="A3.p1.15.m15.1.1.1.1.cmml" type="integer" xref="A3.p1.15.m15.1.1.1.1">0</cn></apply><ci id="A3.p1.15.m15.1.2.2.3.cmml" xref="A3.p1.15.m15.1.2.2.3">𝑝</ci></apply><apply id="A3.p1.15.m15.1.2.3.cmml" xref="A3.p1.15.m15.1.2.3"><csymbol cd="ambiguous" id="A3.p1.15.m15.1.2.3.1.cmml" xref="A3.p1.15.m15.1.2.3">subscript</csymbol><ci id="A3.p1.15.m15.1.2.3.2.cmml" xref="A3.p1.15.m15.1.2.3.2">𝐞</ci><ci id="A3.p1.15.m15.1.2.3.3.cmml" xref="A3.p1.15.m15.1.2.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.15.m15.1c">\mathbf{h}^{(0)}_{p}=\mathbf{e}_{p}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.15.m15.1d">bold_h start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = bold_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> denote the embeddings of user, item and attribute value, we adopt a multi-head Graph Attention Network (GAT) <cite class="ltx_cite ltx_citemacro_cite">Veličković et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib45" title="">2018</a>); Brody et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib5" title="">2022</a>)</cite> to iteratively refine the node embeddings with neighbourhood information:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="A6.EGx1">
<tbody id="A3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{z}^{(l+1)}_{i}=\mathop{\Bigm{|}\Bigm{|}}\limits_{k=1}^{K}%
\sum_{j\in\mathcal{N}_{i}}\alpha^{k}_{ij}\mathbf{W}^{(l)}_{2,k}\mathbf{h}_{j}" class="ltx_math_unparsed" display="block" id="A3.Ex2.m1.4"><semantics id="A3.Ex2.m1.4a"><mrow id="A3.Ex2.m1.4.5"><msubsup id="A3.Ex2.m1.4.5.2"><mi id="A3.Ex2.m1.4.5.2.2.2">𝐳</mi><mi id="A3.Ex2.m1.4.5.2.3">i</mi><mrow id="A3.Ex2.m1.1.1.1.1"><mo id="A3.Ex2.m1.1.1.1.1.2" stretchy="false">(</mo><mrow id="A3.Ex2.m1.1.1.1.1.1"><mi id="A3.Ex2.m1.1.1.1.1.1.2">l</mi><mo id="A3.Ex2.m1.1.1.1.1.1.1">+</mo><mn id="A3.Ex2.m1.1.1.1.1.1.3">1</mn></mrow><mo id="A3.Ex2.m1.1.1.1.1.3" stretchy="false">)</mo></mrow></msubsup><mo id="A3.Ex2.m1.4.5.1" rspace="0.1389em">=</mo><mrow id="A3.Ex2.m1.4.5.3"><munderover id="A3.Ex2.m1.4.5.3.1"><mrow id="A3.Ex2.m1.4.5.3.1.2.2"><mo id="A3.Ex2.m1.4.5.3.1.2.2.1" lspace="0.1389em" mathsize="160%" rspace="0em">|</mo><mo id="A3.Ex2.m1.4.5.3.1.2.2.2" lspace="0em" mathsize="160%" rspace="0em">|</mo></mrow><mrow id="A3.Ex2.m1.4.5.3.1.2.3"><mi id="A3.Ex2.m1.4.5.3.1.2.3.2">k</mi><mo id="A3.Ex2.m1.4.5.3.1.2.3.1">=</mo><mn id="A3.Ex2.m1.4.5.3.1.2.3.3">1</mn></mrow><mi id="A3.Ex2.m1.4.5.3.1.3">K</mi></munderover><mrow id="A3.Ex2.m1.4.5.3.2"><munder id="A3.Ex2.m1.4.5.3.2.1"><mo id="A3.Ex2.m1.4.5.3.2.1.2" movablelimits="false">∑</mo><mrow id="A3.Ex2.m1.4.5.3.2.1.3"><mi id="A3.Ex2.m1.4.5.3.2.1.3.2">j</mi><mo id="A3.Ex2.m1.4.5.3.2.1.3.1">∈</mo><msub id="A3.Ex2.m1.4.5.3.2.1.3.3"><mi class="ltx_font_mathcaligraphic" id="A3.Ex2.m1.4.5.3.2.1.3.3.2">𝒩</mi><mi id="A3.Ex2.m1.4.5.3.2.1.3.3.3">i</mi></msub></mrow></munder><mrow id="A3.Ex2.m1.4.5.3.2.2"><msubsup id="A3.Ex2.m1.4.5.3.2.2.2"><mi id="A3.Ex2.m1.4.5.3.2.2.2.2.2">α</mi><mrow id="A3.Ex2.m1.4.5.3.2.2.2.3"><mi id="A3.Ex2.m1.4.5.3.2.2.2.3.2">i</mi><mo id="A3.Ex2.m1.4.5.3.2.2.2.3.1">⁢</mo><mi id="A3.Ex2.m1.4.5.3.2.2.2.3.3">j</mi></mrow><mi id="A3.Ex2.m1.4.5.3.2.2.2.2.3">k</mi></msubsup><mo id="A3.Ex2.m1.4.5.3.2.2.1">⁢</mo><msubsup id="A3.Ex2.m1.4.5.3.2.2.3"><mi id="A3.Ex2.m1.4.5.3.2.2.3.2.2">𝐖</mi><mrow id="A3.Ex2.m1.4.4.2.4"><mn id="A3.Ex2.m1.3.3.1.1">2</mn><mo id="A3.Ex2.m1.4.4.2.4.1">,</mo><mi id="A3.Ex2.m1.4.4.2.2">k</mi></mrow><mrow id="A3.Ex2.m1.2.2.1.3"><mo id="A3.Ex2.m1.2.2.1.3.1" stretchy="false">(</mo><mi id="A3.Ex2.m1.2.2.1.1">l</mi><mo id="A3.Ex2.m1.2.2.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="A3.Ex2.m1.4.5.3.2.2.1a">⁢</mo><msub id="A3.Ex2.m1.4.5.3.2.2.4"><mi id="A3.Ex2.m1.4.5.3.2.2.4.2">𝐡</mi><mi id="A3.Ex2.m1.4.5.3.2.2.4.3">j</mi></msub></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="A3.Ex2.m1.4b">\displaystyle\mathbf{z}^{(l+1)}_{i}=\mathop{\Bigm{|}\Bigm{|}}\limits_{k=1}^{K}%
\sum_{j\in\mathcal{N}_{i}}\alpha^{k}_{ij}\mathbf{W}^{(l)}_{2,k}\mathbf{h}_{j}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex2.m1.4c">bold_z start_POSTSUPERSCRIPT ( italic_l + 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = start_BIGOP | | end_BIGOP start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_α start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 , italic_k end_POSTSUBSCRIPT bold_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\alpha^{k}_{ij}=\frac{\exp({\mathbf{a}_{k}^{(l)}}^{\top}\sigma(%
\mathbf{W}_{1,k}^{(l)}\mathbf{h}_{i}+\mathbf{W}_{2,k}^{(l)}\mathbf{h}_{j}))}{%
\sum\limits_{j^{{}^{\prime}}\in\mathcal{N}_{i}}\exp({\mathbf{a}_{k}^{(l)}}^{%
\top}\sigma(\mathbf{W}_{1,k}^{(l)}\mathbf{h}_{i}+\mathbf{W}_{2,k}^{(l)}\mathbf%
{h}_{j^{{}^{\prime}}}))}" class="ltx_Math" display="block" id="A3.Ex3.m1.18"><semantics id="A3.Ex3.m1.18a"><mrow id="A3.Ex3.m1.18.19" xref="A3.Ex3.m1.18.19.cmml"><msubsup id="A3.Ex3.m1.18.19.2" xref="A3.Ex3.m1.18.19.2.cmml"><mi id="A3.Ex3.m1.18.19.2.2.2" xref="A3.Ex3.m1.18.19.2.2.2.cmml">α</mi><mrow id="A3.Ex3.m1.18.19.2.3" xref="A3.Ex3.m1.18.19.2.3.cmml"><mi id="A3.Ex3.m1.18.19.2.3.2" xref="A3.Ex3.m1.18.19.2.3.2.cmml">i</mi><mo id="A3.Ex3.m1.18.19.2.3.1" xref="A3.Ex3.m1.18.19.2.3.1.cmml">⁢</mo><mi id="A3.Ex3.m1.18.19.2.3.3" xref="A3.Ex3.m1.18.19.2.3.3.cmml">j</mi></mrow><mi id="A3.Ex3.m1.18.19.2.2.3" xref="A3.Ex3.m1.18.19.2.2.3.cmml">k</mi></msubsup><mo id="A3.Ex3.m1.18.19.1" xref="A3.Ex3.m1.18.19.1.cmml">=</mo><mfrac id="A3.Ex3.m1.18.18" xref="A3.Ex3.m1.18.18.cmml"><mrow id="A3.Ex3.m1.9.9.9.9" xref="A3.Ex3.m1.9.9.9.10.cmml"><mi id="A3.Ex3.m1.8.8.8.8" xref="A3.Ex3.m1.8.8.8.8.cmml">exp</mi><mo id="A3.Ex3.m1.9.9.9.9a" xref="A3.Ex3.m1.9.9.9.10.cmml">⁡</mo><mrow id="A3.Ex3.m1.9.9.9.9.1" xref="A3.Ex3.m1.9.9.9.10.cmml"><mo id="A3.Ex3.m1.9.9.9.9.1.2" stretchy="false" xref="A3.Ex3.m1.9.9.9.10.cmml">(</mo><mrow id="A3.Ex3.m1.9.9.9.9.1.1" xref="A3.Ex3.m1.9.9.9.9.1.1.cmml"><mmultiscripts id="A3.Ex3.m1.9.9.9.9.1.1.3" xref="A3.Ex3.m1.9.9.9.9.1.1.3.cmml"><mi id="A3.Ex3.m1.9.9.9.9.1.1.3.2.2.2" xref="A3.Ex3.m1.9.9.9.9.1.1.3.2.2.2.cmml">𝐚</mi><mi id="A3.Ex3.m1.9.9.9.9.1.1.3.2.2.3" xref="A3.Ex3.m1.9.9.9.9.1.1.3.2.2.3.cmml">k</mi><mrow id="A3.Ex3.m1.1.1.1.1.1.3" xref="A3.Ex3.m1.9.9.9.9.1.1.3.cmml"><mo id="A3.Ex3.m1.1.1.1.1.1.3.1" stretchy="false" xref="A3.Ex3.m1.9.9.9.9.1.1.3.cmml">(</mo><mi id="A3.Ex3.m1.1.1.1.1.1.1" xref="A3.Ex3.m1.1.1.1.1.1.1.cmml">l</mi><mo id="A3.Ex3.m1.1.1.1.1.1.3.2" stretchy="false" xref="A3.Ex3.m1.9.9.9.9.1.1.3.cmml">)</mo></mrow><mrow id="A3.Ex3.m1.9.9.9.9.1.1.3a" xref="A3.Ex3.m1.9.9.9.9.1.1.3.cmml"></mrow><mo id="A3.Ex3.m1.9.9.9.9.1.1.3.3" xref="A3.Ex3.m1.9.9.9.9.1.1.3.3.cmml">⊤</mo></mmultiscripts><mo id="A3.Ex3.m1.9.9.9.9.1.1.2" xref="A3.Ex3.m1.9.9.9.9.1.1.2.cmml">⁢</mo><mi id="A3.Ex3.m1.9.9.9.9.1.1.4" xref="A3.Ex3.m1.9.9.9.9.1.1.4.cmml">σ</mi><mo id="A3.Ex3.m1.9.9.9.9.1.1.2a" xref="A3.Ex3.m1.9.9.9.9.1.1.2.cmml">⁢</mo><mrow id="A3.Ex3.m1.9.9.9.9.1.1.1.1" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.cmml"><mo id="A3.Ex3.m1.9.9.9.9.1.1.1.1.2" stretchy="false" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.cmml"><mrow id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.cmml"><msubsup id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2.cmml"><mi id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2.2.2" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2.2.2.cmml">𝐖</mi><mrow id="A3.Ex3.m1.3.3.3.3.2.4" xref="A3.Ex3.m1.3.3.3.3.2.3.cmml"><mn id="A3.Ex3.m1.2.2.2.2.1.1" xref="A3.Ex3.m1.2.2.2.2.1.1.cmml">1</mn><mo id="A3.Ex3.m1.3.3.3.3.2.4.1" xref="A3.Ex3.m1.3.3.3.3.2.3.cmml">,</mo><mi id="A3.Ex3.m1.3.3.3.3.2.2" xref="A3.Ex3.m1.3.3.3.3.2.2.cmml">k</mi></mrow><mrow id="A3.Ex3.m1.4.4.4.4.1.3" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2.cmml"><mo id="A3.Ex3.m1.4.4.4.4.1.3.1" stretchy="false" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2.cmml">(</mo><mi id="A3.Ex3.m1.4.4.4.4.1.1" xref="A3.Ex3.m1.4.4.4.4.1.1.cmml">l</mi><mo id="A3.Ex3.m1.4.4.4.4.1.3.2" stretchy="false" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.1" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3.cmml"><mi id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3.2" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3.2.cmml">𝐡</mi><mi id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3.3" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.1" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.1.cmml">+</mo><mrow id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.cmml"><msubsup id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2.cmml"><mi id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2.2.2" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2.2.2.cmml">𝐖</mi><mrow id="A3.Ex3.m1.6.6.6.6.2.4" xref="A3.Ex3.m1.6.6.6.6.2.3.cmml"><mn id="A3.Ex3.m1.5.5.5.5.1.1" xref="A3.Ex3.m1.5.5.5.5.1.1.cmml">2</mn><mo id="A3.Ex3.m1.6.6.6.6.2.4.1" xref="A3.Ex3.m1.6.6.6.6.2.3.cmml">,</mo><mi id="A3.Ex3.m1.6.6.6.6.2.2" xref="A3.Ex3.m1.6.6.6.6.2.2.cmml">k</mi></mrow><mrow id="A3.Ex3.m1.7.7.7.7.1.3" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2.cmml"><mo id="A3.Ex3.m1.7.7.7.7.1.3.1" stretchy="false" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2.cmml">(</mo><mi id="A3.Ex3.m1.7.7.7.7.1.1" xref="A3.Ex3.m1.7.7.7.7.1.1.cmml">l</mi><mo id="A3.Ex3.m1.7.7.7.7.1.3.2" stretchy="false" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2.cmml">)</mo></mrow></msubsup><mo id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.1" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3.cmml"><mi id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3.2" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3.2.cmml">𝐡</mi><mi id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3.3" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3.3.cmml">j</mi></msub></mrow></mrow><mo id="A3.Ex3.m1.9.9.9.9.1.1.1.1.3" stretchy="false" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex3.m1.9.9.9.9.1.3" stretchy="false" xref="A3.Ex3.m1.9.9.9.10.cmml">)</mo></mrow></mrow><mrow id="A3.Ex3.m1.18.18.18" xref="A3.Ex3.m1.18.18.18.cmml"><munder id="A3.Ex3.m1.18.18.18.10" xref="A3.Ex3.m1.18.18.18.10.cmml"><mo id="A3.Ex3.m1.18.18.18.10.2" movablelimits="false" xref="A3.Ex3.m1.18.18.18.10.2.cmml">∑</mo><mrow id="A3.Ex3.m1.18.18.18.10.3" xref="A3.Ex3.m1.18.18.18.10.3.cmml"><msup id="A3.Ex3.m1.18.18.18.10.3.2" xref="A3.Ex3.m1.18.18.18.10.3.2.cmml"><mi id="A3.Ex3.m1.18.18.18.10.3.2.2" xref="A3.Ex3.m1.18.18.18.10.3.2.2.cmml">j</mi><msup id="A3.Ex3.m1.18.18.18.10.3.2.3" xref="A3.Ex3.m1.18.18.18.10.3.2.3.cmml"><mi id="A3.Ex3.m1.18.18.18.10.3.2.3a" xref="A3.Ex3.m1.18.18.18.10.3.2.3.cmml"></mi><mo id="A3.Ex3.m1.18.18.18.10.3.2.3.1" xref="A3.Ex3.m1.18.18.18.10.3.2.3.1.cmml">′</mo></msup></msup><mo id="A3.Ex3.m1.18.18.18.10.3.1" xref="A3.Ex3.m1.18.18.18.10.3.1.cmml">∈</mo><msub id="A3.Ex3.m1.18.18.18.10.3.3" xref="A3.Ex3.m1.18.18.18.10.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.Ex3.m1.18.18.18.10.3.3.2" xref="A3.Ex3.m1.18.18.18.10.3.3.2.cmml">𝒩</mi><mi id="A3.Ex3.m1.18.18.18.10.3.3.3" xref="A3.Ex3.m1.18.18.18.10.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="A3.Ex3.m1.18.18.18.9.1" xref="A3.Ex3.m1.18.18.18.9.2.cmml"><mi id="A3.Ex3.m1.17.17.17.8" xref="A3.Ex3.m1.17.17.17.8.cmml">exp</mi><mo id="A3.Ex3.m1.18.18.18.9.1a" xref="A3.Ex3.m1.18.18.18.9.2.cmml">⁡</mo><mrow id="A3.Ex3.m1.18.18.18.9.1.1" xref="A3.Ex3.m1.18.18.18.9.2.cmml"><mo id="A3.Ex3.m1.18.18.18.9.1.1.2" stretchy="false" xref="A3.Ex3.m1.18.18.18.9.2.cmml">(</mo><mrow id="A3.Ex3.m1.18.18.18.9.1.1.1" xref="A3.Ex3.m1.18.18.18.9.1.1.1.cmml"><mmultiscripts id="A3.Ex3.m1.18.18.18.9.1.1.1.3" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3.cmml"><mi id="A3.Ex3.m1.18.18.18.9.1.1.1.3.2.2.2" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3.2.2.2.cmml">𝐚</mi><mi id="A3.Ex3.m1.18.18.18.9.1.1.1.3.2.2.3" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3.2.2.3.cmml">k</mi><mrow id="A3.Ex3.m1.10.10.10.1.1.3" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3.cmml"><mo id="A3.Ex3.m1.10.10.10.1.1.3.1" stretchy="false" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3.cmml">(</mo><mi id="A3.Ex3.m1.10.10.10.1.1.1" xref="A3.Ex3.m1.10.10.10.1.1.1.cmml">l</mi><mo id="A3.Ex3.m1.10.10.10.1.1.3.2" stretchy="false" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3.cmml">)</mo></mrow><mrow id="A3.Ex3.m1.18.18.18.9.1.1.1.3a" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3.cmml"></mrow><mo id="A3.Ex3.m1.18.18.18.9.1.1.1.3.3" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3.3.cmml">⊤</mo></mmultiscripts><mo id="A3.Ex3.m1.18.18.18.9.1.1.1.2" xref="A3.Ex3.m1.18.18.18.9.1.1.1.2.cmml">⁢</mo><mi id="A3.Ex3.m1.18.18.18.9.1.1.1.4" xref="A3.Ex3.m1.18.18.18.9.1.1.1.4.cmml">σ</mi><mo id="A3.Ex3.m1.18.18.18.9.1.1.1.2a" xref="A3.Ex3.m1.18.18.18.9.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.cmml"><mo id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.2" stretchy="false" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.cmml"><mrow id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.cmml"><msubsup id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2.cmml"><mi id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2.2.2" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2.2.2.cmml">𝐖</mi><mrow id="A3.Ex3.m1.12.12.12.3.2.4" xref="A3.Ex3.m1.12.12.12.3.2.3.cmml"><mn id="A3.Ex3.m1.11.11.11.2.1.1" xref="A3.Ex3.m1.11.11.11.2.1.1.cmml">1</mn><mo id="A3.Ex3.m1.12.12.12.3.2.4.1" xref="A3.Ex3.m1.12.12.12.3.2.3.cmml">,</mo><mi id="A3.Ex3.m1.12.12.12.3.2.2" xref="A3.Ex3.m1.12.12.12.3.2.2.cmml">k</mi></mrow><mrow id="A3.Ex3.m1.13.13.13.4.1.3" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2.cmml"><mo id="A3.Ex3.m1.13.13.13.4.1.3.1" stretchy="false" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2.cmml">(</mo><mi id="A3.Ex3.m1.13.13.13.4.1.1" xref="A3.Ex3.m1.13.13.13.4.1.1.cmml">l</mi><mo id="A3.Ex3.m1.13.13.13.4.1.3.2" stretchy="false" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.1" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3.cmml"><mi id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3.2" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3.2.cmml">𝐡</mi><mi id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3.3" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.1" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.cmml"><msubsup id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2.cmml"><mi id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2.2.2" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2.2.2.cmml">𝐖</mi><mrow id="A3.Ex3.m1.15.15.15.6.2.4" xref="A3.Ex3.m1.15.15.15.6.2.3.cmml"><mn id="A3.Ex3.m1.14.14.14.5.1.1" xref="A3.Ex3.m1.14.14.14.5.1.1.cmml">2</mn><mo id="A3.Ex3.m1.15.15.15.6.2.4.1" xref="A3.Ex3.m1.15.15.15.6.2.3.cmml">,</mo><mi id="A3.Ex3.m1.15.15.15.6.2.2" xref="A3.Ex3.m1.15.15.15.6.2.2.cmml">k</mi></mrow><mrow id="A3.Ex3.m1.16.16.16.7.1.3" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2.cmml"><mo id="A3.Ex3.m1.16.16.16.7.1.3.1" stretchy="false" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2.cmml">(</mo><mi id="A3.Ex3.m1.16.16.16.7.1.1" xref="A3.Ex3.m1.16.16.16.7.1.1.cmml">l</mi><mo id="A3.Ex3.m1.16.16.16.7.1.3.2" stretchy="false" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2.cmml">)</mo></mrow></msubsup><mo id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.1" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.cmml"><mi id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.2" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.2.cmml">𝐡</mi><msup id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.cmml"><mi id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.2" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.2.cmml">j</mi><msup id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.3" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.3a" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.3.cmml"></mi><mo id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.3.1" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.3.1.cmml">′</mo></msup></msup></msub></mrow></mrow><mo id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.3" stretchy="false" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex3.m1.18.18.18.9.1.1.3" stretchy="false" xref="A3.Ex3.m1.18.18.18.9.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex3.m1.18b"><apply id="A3.Ex3.m1.18.19.cmml" xref="A3.Ex3.m1.18.19"><eq id="A3.Ex3.m1.18.19.1.cmml" xref="A3.Ex3.m1.18.19.1"></eq><apply id="A3.Ex3.m1.18.19.2.cmml" xref="A3.Ex3.m1.18.19.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.19.2.1.cmml" xref="A3.Ex3.m1.18.19.2">subscript</csymbol><apply id="A3.Ex3.m1.18.19.2.2.cmml" xref="A3.Ex3.m1.18.19.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.19.2.2.1.cmml" xref="A3.Ex3.m1.18.19.2">superscript</csymbol><ci id="A3.Ex3.m1.18.19.2.2.2.cmml" xref="A3.Ex3.m1.18.19.2.2.2">𝛼</ci><ci id="A3.Ex3.m1.18.19.2.2.3.cmml" xref="A3.Ex3.m1.18.19.2.2.3">𝑘</ci></apply><apply id="A3.Ex3.m1.18.19.2.3.cmml" xref="A3.Ex3.m1.18.19.2.3"><times id="A3.Ex3.m1.18.19.2.3.1.cmml" xref="A3.Ex3.m1.18.19.2.3.1"></times><ci id="A3.Ex3.m1.18.19.2.3.2.cmml" xref="A3.Ex3.m1.18.19.2.3.2">𝑖</ci><ci id="A3.Ex3.m1.18.19.2.3.3.cmml" xref="A3.Ex3.m1.18.19.2.3.3">𝑗</ci></apply></apply><apply id="A3.Ex3.m1.18.18.cmml" xref="A3.Ex3.m1.18.18"><divide id="A3.Ex3.m1.18.18.19.cmml" xref="A3.Ex3.m1.18.18"></divide><apply id="A3.Ex3.m1.9.9.9.10.cmml" xref="A3.Ex3.m1.9.9.9.9"><exp id="A3.Ex3.m1.8.8.8.8.cmml" xref="A3.Ex3.m1.8.8.8.8"></exp><apply id="A3.Ex3.m1.9.9.9.9.1.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1"><times id="A3.Ex3.m1.9.9.9.9.1.1.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.2"></times><apply id="A3.Ex3.m1.9.9.9.9.1.1.3.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.9.9.9.9.1.1.3.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.3">superscript</csymbol><apply id="A3.Ex3.m1.9.9.9.9.1.1.3.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.9.9.9.9.1.1.3.2.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.3">superscript</csymbol><apply id="A3.Ex3.m1.9.9.9.9.1.1.3.2.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.9.9.9.9.1.1.3.2.2.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.3">subscript</csymbol><ci id="A3.Ex3.m1.9.9.9.9.1.1.3.2.2.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.3.2.2.2">𝐚</ci><ci id="A3.Ex3.m1.9.9.9.9.1.1.3.2.2.3.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.3.2.2.3">𝑘</ci></apply><ci id="A3.Ex3.m1.1.1.1.1.1.1.cmml" xref="A3.Ex3.m1.1.1.1.1.1.1">𝑙</ci></apply><csymbol cd="latexml" id="A3.Ex3.m1.9.9.9.9.1.1.3.3.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.3.3">top</csymbol></apply><ci id="A3.Ex3.m1.9.9.9.9.1.1.4.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.4">𝜎</ci><apply id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1"><plus id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.1"></plus><apply id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2"><times id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.1"></times><apply id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2">superscript</csymbol><apply id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2.2.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2">subscript</csymbol><ci id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2.2.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.2.2.2">𝐖</ci><list id="A3.Ex3.m1.3.3.3.3.2.3.cmml" xref="A3.Ex3.m1.3.3.3.3.2.4"><cn id="A3.Ex3.m1.2.2.2.2.1.1.cmml" type="integer" xref="A3.Ex3.m1.2.2.2.2.1.1">1</cn><ci id="A3.Ex3.m1.3.3.3.3.2.2.cmml" xref="A3.Ex3.m1.3.3.3.3.2.2">𝑘</ci></list></apply><ci id="A3.Ex3.m1.4.4.4.4.1.1.cmml" xref="A3.Ex3.m1.4.4.4.4.1.1">𝑙</ci></apply><apply id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3">subscript</csymbol><ci id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3.2">𝐡</ci><ci id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3.3.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3"><times id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.1"></times><apply id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2">superscript</csymbol><apply id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2.2.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2">subscript</csymbol><ci id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2.2.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.2.2.2">𝐖</ci><list id="A3.Ex3.m1.6.6.6.6.2.3.cmml" xref="A3.Ex3.m1.6.6.6.6.2.4"><cn id="A3.Ex3.m1.5.5.5.5.1.1.cmml" type="integer" xref="A3.Ex3.m1.5.5.5.5.1.1">2</cn><ci id="A3.Ex3.m1.6.6.6.6.2.2.cmml" xref="A3.Ex3.m1.6.6.6.6.2.2">𝑘</ci></list></apply><ci id="A3.Ex3.m1.7.7.7.7.1.1.cmml" xref="A3.Ex3.m1.7.7.7.7.1.1">𝑙</ci></apply><apply id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3.1.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3">subscript</csymbol><ci id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3.2.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3.2">𝐡</ci><ci id="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3.3.cmml" xref="A3.Ex3.m1.9.9.9.9.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="A3.Ex3.m1.18.18.18.cmml" xref="A3.Ex3.m1.18.18.18"><apply id="A3.Ex3.m1.18.18.18.10.cmml" xref="A3.Ex3.m1.18.18.18.10"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.10.1.cmml" xref="A3.Ex3.m1.18.18.18.10">subscript</csymbol><sum id="A3.Ex3.m1.18.18.18.10.2.cmml" xref="A3.Ex3.m1.18.18.18.10.2"></sum><apply id="A3.Ex3.m1.18.18.18.10.3.cmml" xref="A3.Ex3.m1.18.18.18.10.3"><in id="A3.Ex3.m1.18.18.18.10.3.1.cmml" xref="A3.Ex3.m1.18.18.18.10.3.1"></in><apply id="A3.Ex3.m1.18.18.18.10.3.2.cmml" xref="A3.Ex3.m1.18.18.18.10.3.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.10.3.2.1.cmml" xref="A3.Ex3.m1.18.18.18.10.3.2">superscript</csymbol><ci id="A3.Ex3.m1.18.18.18.10.3.2.2.cmml" xref="A3.Ex3.m1.18.18.18.10.3.2.2">𝑗</ci><apply id="A3.Ex3.m1.18.18.18.10.3.2.3.cmml" xref="A3.Ex3.m1.18.18.18.10.3.2.3"><ci id="A3.Ex3.m1.18.18.18.10.3.2.3.1.cmml" xref="A3.Ex3.m1.18.18.18.10.3.2.3.1">′</ci></apply></apply><apply id="A3.Ex3.m1.18.18.18.10.3.3.cmml" xref="A3.Ex3.m1.18.18.18.10.3.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.10.3.3.1.cmml" xref="A3.Ex3.m1.18.18.18.10.3.3">subscript</csymbol><ci id="A3.Ex3.m1.18.18.18.10.3.3.2.cmml" xref="A3.Ex3.m1.18.18.18.10.3.3.2">𝒩</ci><ci id="A3.Ex3.m1.18.18.18.10.3.3.3.cmml" xref="A3.Ex3.m1.18.18.18.10.3.3.3">𝑖</ci></apply></apply></apply><apply id="A3.Ex3.m1.18.18.18.9.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1"><exp id="A3.Ex3.m1.17.17.17.8.cmml" xref="A3.Ex3.m1.17.17.17.8"></exp><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1"><times id="A3.Ex3.m1.18.18.18.9.1.1.1.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.2"></times><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.3.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.9.1.1.1.3.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3">superscript</csymbol><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.3.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.9.1.1.1.3.2.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3">superscript</csymbol><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.3.2.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.9.1.1.1.3.2.2.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3">subscript</csymbol><ci id="A3.Ex3.m1.18.18.18.9.1.1.1.3.2.2.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3.2.2.2">𝐚</ci><ci id="A3.Ex3.m1.18.18.18.9.1.1.1.3.2.2.3.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3.2.2.3">𝑘</ci></apply><ci id="A3.Ex3.m1.10.10.10.1.1.1.cmml" xref="A3.Ex3.m1.10.10.10.1.1.1">𝑙</ci></apply><csymbol cd="latexml" id="A3.Ex3.m1.18.18.18.9.1.1.1.3.3.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.3.3">top</csymbol></apply><ci id="A3.Ex3.m1.18.18.18.9.1.1.1.4.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.4">𝜎</ci><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1"><plus id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.1"></plus><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2"><times id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.1"></times><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2.2.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2.2.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.2.2.2">𝐖</ci><list id="A3.Ex3.m1.12.12.12.3.2.3.cmml" xref="A3.Ex3.m1.12.12.12.3.2.4"><cn id="A3.Ex3.m1.11.11.11.2.1.1.cmml" type="integer" xref="A3.Ex3.m1.11.11.11.2.1.1">1</cn><ci id="A3.Ex3.m1.12.12.12.3.2.2.cmml" xref="A3.Ex3.m1.12.12.12.3.2.2">𝑘</ci></list></apply><ci id="A3.Ex3.m1.13.13.13.4.1.1.cmml" xref="A3.Ex3.m1.13.13.13.4.1.1">𝑙</ci></apply><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3.2">𝐡</ci><ci id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3.3.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3"><times id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.1"></times><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2.2.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2.2.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.2.2.2">𝐖</ci><list id="A3.Ex3.m1.15.15.15.6.2.3.cmml" xref="A3.Ex3.m1.15.15.15.6.2.4"><cn id="A3.Ex3.m1.14.14.14.5.1.1.cmml" type="integer" xref="A3.Ex3.m1.14.14.14.5.1.1">2</cn><ci id="A3.Ex3.m1.15.15.15.6.2.2.cmml" xref="A3.Ex3.m1.15.15.15.6.2.2">𝑘</ci></list></apply><ci id="A3.Ex3.m1.16.16.16.7.1.1.cmml" xref="A3.Ex3.m1.16.16.16.7.1.1">𝑙</ci></apply><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.2">𝐡</ci><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3">superscript</csymbol><ci id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.2.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.2">𝑗</ci><apply id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.3.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.3"><ci id="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="A3.Ex3.m1.18.18.18.9.1.1.1.1.1.1.3.3.3.3.1">′</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex3.m1.18c">\displaystyle\alpha^{k}_{ij}=\frac{\exp({\mathbf{a}_{k}^{(l)}}^{\top}\sigma(%
\mathbf{W}_{1,k}^{(l)}\mathbf{h}_{i}+\mathbf{W}_{2,k}^{(l)}\mathbf{h}_{j}))}{%
\sum\limits_{j^{{}^{\prime}}\in\mathcal{N}_{i}}\exp({\mathbf{a}_{k}^{(l)}}^{%
\top}\sigma(\mathbf{W}_{1,k}^{(l)}\mathbf{h}_{i}+\mathbf{W}_{2,k}^{(l)}\mathbf%
{h}_{j^{{}^{\prime}}}))}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex3.m1.18d">italic_α start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = divide start_ARG roman_exp ( bold_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_σ ( bold_W start_POSTSUBSCRIPT 1 , italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + bold_W start_POSTSUBSCRIPT 2 , italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT bold_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_exp ( bold_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_σ ( bold_W start_POSTSUBSCRIPT 1 , italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + bold_W start_POSTSUBSCRIPT 2 , italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT bold_h start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathcal{N}_{i}=\left\{\begin{array}[]{ll}\{v\thinspace|%
\thinspace e_{i,v}\in\mathcal{E}_{\mathcal{U},\mathcal{V}}\},&amp;\mathrm{if}\quad
i%
\in\mathcal{U}\\
\{v\thinspace|\thinspace e_{i,v}\in\mathcal{E}_{\mathcal{P},\mathcal{V}}\},&amp;%
\mathrm{if}\quad i\in\mathcal{P}\\
\{u\thinspace|\thinspace e_{u,i}\in\mathcal{E}_{\mathcal{U},\mathcal{V}}\},&amp;%
\mathrm{if}\quad i\in\mathcal{V},\mathcal{N}_{i}\subset\mathcal{U}\\
\{p\thinspace|\thinspace e_{p,i}\in\mathcal{E}_{\mathcal{P},\mathcal{V}}\},&amp;%
\mathrm{if}\quad i\in\mathcal{V},\mathcal{N}_{i}\subset\mathcal{P}\\
\end{array}\right.," class="ltx_Math" display="block" id="A3.E12.m1.2"><semantics id="A3.E12.m1.2a"><mrow id="A3.E12.m1.2.2.1" xref="A3.E12.m1.2.2.1.1.cmml"><mrow id="A3.E12.m1.2.2.1.1" xref="A3.E12.m1.2.2.1.1.cmml"><msub id="A3.E12.m1.2.2.1.1.2" xref="A3.E12.m1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E12.m1.2.2.1.1.2.2" xref="A3.E12.m1.2.2.1.1.2.2.cmml">𝒩</mi><mi id="A3.E12.m1.2.2.1.1.2.3" xref="A3.E12.m1.2.2.1.1.2.3.cmml">i</mi></msub><mo id="A3.E12.m1.2.2.1.1.1" xref="A3.E12.m1.2.2.1.1.1.cmml">=</mo><mrow id="A3.E12.m1.2.2.1.1.3.2" xref="A3.E12.m1.2.2.1.1.3.1.cmml"><mo id="A3.E12.m1.2.2.1.1.3.2.1" xref="A3.E12.m1.2.2.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="A3.E12.m1.1.1" rowspacing="-3.0pt" xref="A3.E12.m1.1.1.cmml"><mtr id="A3.E12.m1.1.1a" xref="A3.E12.m1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E12.m1.1.1b" xref="A3.E12.m1.1.1.cmml"><mrow id="A3.E8.6.6.6" xref="A3.E12.m1.1.1.cmml"><mrow id="A3.E8.6.6.6.1.1" xref="A3.E8.6.6.6.1.2.cmml"><mo id="A3.E8.6.6.6.1.1.2" stretchy="false" xref="A3.E8.6.6.6.1.2.1.cmml">{</mo><mi id="A3.E8.5.5.5" xref="A3.E8.5.5.5.cmml">v</mi><mo id="A3.E8.6.6.6.1.1.3" lspace="0.170em" rspace="0.170em" xref="A3.E8.6.6.6.1.2.1.cmml">|</mo><mrow id="A3.E8.6.6.6.1.1.1" xref="A3.E8.6.6.6.1.1.1.cmml"><msub id="A3.E8.6.6.6.1.1.1.2" xref="A3.E8.6.6.6.1.1.1.2.cmml"><mi id="A3.E8.6.6.6.1.1.1.2.2" xref="A3.E8.6.6.6.1.1.1.2.2.cmml">e</mi><mrow id="A3.E8.2.2.2.2.4" xref="A3.E8.2.2.2.2.3.cmml"><mi id="A3.E8.1.1.1.1.1" xref="A3.E8.1.1.1.1.1.cmml">i</mi><mo id="A3.E8.2.2.2.2.4.1" xref="A3.E8.2.2.2.2.3.cmml">,</mo><mi id="A3.E8.2.2.2.2.2" xref="A3.E8.2.2.2.2.2.cmml">v</mi></mrow></msub><mo id="A3.E8.6.6.6.1.1.1.1" xref="A3.E8.6.6.6.1.1.1.1.cmml">∈</mo><msub id="A3.E8.6.6.6.1.1.1.3" xref="A3.E8.6.6.6.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E8.6.6.6.1.1.1.3.2" xref="A3.E8.6.6.6.1.1.1.3.2.cmml">ℰ</mi><mrow id="A3.E8.4.4.4.2.4" xref="A3.E8.4.4.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E8.3.3.3.1.1" xref="A3.E8.3.3.3.1.1.cmml">𝒰</mi><mo id="A3.E8.4.4.4.2.4.1" xref="A3.E8.4.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A3.E8.4.4.4.2.2" xref="A3.E8.4.4.4.2.2.cmml">𝒱</mi></mrow></msub></mrow><mo id="A3.E8.6.6.6.1.1.4" stretchy="false" xref="A3.E8.6.6.6.1.2.1.cmml">}</mo></mrow><mo id="A3.E8.6.6.6.2" xref="A3.E12.m1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A3.E12.m1.1.1c" xref="A3.E12.m1.1.1.cmml"><mrow id="A3.E8.8.2" xref="A3.E8.8.2.cmml"><mrow id="A3.E8.8.2.4.2" xref="A3.E8.8.2.4.1.cmml"><mi id="A3.E8.7.1.1" xref="A3.E8.7.1.1.cmml">if</mi><mspace id="A3.E8.8.2.4.2.1" width="1em" xref="A3.E8.8.2.4.1.cmml"></mspace><mi id="A3.E8.8.2.2" xref="A3.E8.8.2.2.cmml">i</mi></mrow><mo id="A3.E8.8.2.3" xref="A3.E8.8.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E8.8.2.5" xref="A3.E8.8.2.5.cmml">𝒰</mi></mrow></mtd></mtr><mtr id="A3.E12.m1.1.1d" xref="A3.E12.m1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E12.m1.1.1e" xref="A3.E12.m1.1.1.cmml"><mrow id="A3.E9.6.6.6" xref="A3.E12.m1.1.1.cmml"><mrow id="A3.E9.6.6.6.1.1" xref="A3.E9.6.6.6.1.2.cmml"><mo id="A3.E9.6.6.6.1.1.2" stretchy="false" xref="A3.E9.6.6.6.1.2.1.cmml">{</mo><mi id="A3.E9.5.5.5" xref="A3.E9.5.5.5.cmml">v</mi><mo id="A3.E9.6.6.6.1.1.3" lspace="0.170em" rspace="0.170em" xref="A3.E9.6.6.6.1.2.1.cmml">|</mo><mrow id="A3.E9.6.6.6.1.1.1" xref="A3.E9.6.6.6.1.1.1.cmml"><msub id="A3.E9.6.6.6.1.1.1.2" xref="A3.E9.6.6.6.1.1.1.2.cmml"><mi id="A3.E9.6.6.6.1.1.1.2.2" xref="A3.E9.6.6.6.1.1.1.2.2.cmml">e</mi><mrow id="A3.E9.2.2.2.2.4" xref="A3.E9.2.2.2.2.3.cmml"><mi id="A3.E9.1.1.1.1.1" xref="A3.E9.1.1.1.1.1.cmml">i</mi><mo id="A3.E9.2.2.2.2.4.1" xref="A3.E9.2.2.2.2.3.cmml">,</mo><mi id="A3.E9.2.2.2.2.2" xref="A3.E9.2.2.2.2.2.cmml">v</mi></mrow></msub><mo id="A3.E9.6.6.6.1.1.1.1" xref="A3.E9.6.6.6.1.1.1.1.cmml">∈</mo><msub id="A3.E9.6.6.6.1.1.1.3" xref="A3.E9.6.6.6.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E9.6.6.6.1.1.1.3.2" xref="A3.E9.6.6.6.1.1.1.3.2.cmml">ℰ</mi><mrow id="A3.E9.4.4.4.2.4" xref="A3.E9.4.4.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E9.3.3.3.1.1" xref="A3.E9.3.3.3.1.1.cmml">𝒫</mi><mo id="A3.E9.4.4.4.2.4.1" xref="A3.E9.4.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A3.E9.4.4.4.2.2" xref="A3.E9.4.4.4.2.2.cmml">𝒱</mi></mrow></msub></mrow><mo id="A3.E9.6.6.6.1.1.4" stretchy="false" xref="A3.E9.6.6.6.1.2.1.cmml">}</mo></mrow><mo id="A3.E9.6.6.6.2" xref="A3.E12.m1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A3.E12.m1.1.1f" xref="A3.E12.m1.1.1.cmml"><mrow id="A3.E9.8.2" xref="A3.E9.8.2.cmml"><mrow id="A3.E9.8.2.4.2" xref="A3.E9.8.2.4.1.cmml"><mi id="A3.E9.7.1.1" xref="A3.E9.7.1.1.cmml">if</mi><mspace id="A3.E9.8.2.4.2.1" width="1em" xref="A3.E9.8.2.4.1.cmml"></mspace><mi id="A3.E9.8.2.2" xref="A3.E9.8.2.2.cmml">i</mi></mrow><mo id="A3.E9.8.2.3" xref="A3.E9.8.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E9.8.2.5" xref="A3.E9.8.2.5.cmml">𝒫</mi></mrow></mtd></mtr><mtr id="A3.E12.m1.1.1g" xref="A3.E12.m1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E12.m1.1.1h" xref="A3.E12.m1.1.1.cmml"><mrow id="A3.E10.6.6.6" xref="A3.E12.m1.1.1.cmml"><mrow id="A3.E10.6.6.6.1.1" xref="A3.E10.6.6.6.1.2.cmml"><mo id="A3.E10.6.6.6.1.1.2" stretchy="false" xref="A3.E10.6.6.6.1.2.1.cmml">{</mo><mi id="A3.E10.5.5.5" xref="A3.E10.5.5.5.cmml">u</mi><mo id="A3.E10.6.6.6.1.1.3" lspace="0.170em" rspace="0.170em" xref="A3.E10.6.6.6.1.2.1.cmml">|</mo><mrow id="A3.E10.6.6.6.1.1.1" xref="A3.E10.6.6.6.1.1.1.cmml"><msub id="A3.E10.6.6.6.1.1.1.2" xref="A3.E10.6.6.6.1.1.1.2.cmml"><mi id="A3.E10.6.6.6.1.1.1.2.2" xref="A3.E10.6.6.6.1.1.1.2.2.cmml">e</mi><mrow id="A3.E10.2.2.2.2.4" xref="A3.E10.2.2.2.2.3.cmml"><mi id="A3.E10.1.1.1.1.1" xref="A3.E10.1.1.1.1.1.cmml">u</mi><mo id="A3.E10.2.2.2.2.4.1" xref="A3.E10.2.2.2.2.3.cmml">,</mo><mi id="A3.E10.2.2.2.2.2" xref="A3.E10.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="A3.E10.6.6.6.1.1.1.1" xref="A3.E10.6.6.6.1.1.1.1.cmml">∈</mo><msub id="A3.E10.6.6.6.1.1.1.3" xref="A3.E10.6.6.6.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E10.6.6.6.1.1.1.3.2" xref="A3.E10.6.6.6.1.1.1.3.2.cmml">ℰ</mi><mrow id="A3.E10.4.4.4.2.4" xref="A3.E10.4.4.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E10.3.3.3.1.1" xref="A3.E10.3.3.3.1.1.cmml">𝒰</mi><mo id="A3.E10.4.4.4.2.4.1" xref="A3.E10.4.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A3.E10.4.4.4.2.2" xref="A3.E10.4.4.4.2.2.cmml">𝒱</mi></mrow></msub></mrow><mo id="A3.E10.6.6.6.1.1.4" stretchy="false" xref="A3.E10.6.6.6.1.2.1.cmml">}</mo></mrow><mo id="A3.E10.6.6.6.2" xref="A3.E12.m1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A3.E12.m1.1.1i" xref="A3.E12.m1.1.1.cmml"><mrow id="A3.E10.10.4.4" xref="A3.E10.10.4.5.cmml"><mrow id="A3.E10.9.3.3.1" xref="A3.E10.9.3.3.1.cmml"><mrow id="A3.E10.9.3.3.1.2.2" xref="A3.E10.9.3.3.1.2.1.cmml"><mi id="A3.E10.7.1.1" xref="A3.E10.7.1.1.cmml">if</mi><mspace id="A3.E10.9.3.3.1.2.2.1" width="1em" xref="A3.E10.9.3.3.1.2.1.cmml"></mspace><mi id="A3.E10.8.2.2" xref="A3.E10.8.2.2.cmml">i</mi></mrow><mo id="A3.E10.9.3.3.1.1" xref="A3.E10.9.3.3.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E10.9.3.3.1.3" xref="A3.E10.9.3.3.1.3.cmml">𝒱</mi></mrow><mo id="A3.E10.10.4.4.3" xref="A3.E10.10.4.5a.cmml">,</mo><mrow id="A3.E10.10.4.4.2" xref="A3.E10.10.4.4.2.cmml"><msub id="A3.E10.10.4.4.2.2" xref="A3.E10.10.4.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E10.10.4.4.2.2.2" xref="A3.E10.10.4.4.2.2.2.cmml">𝒩</mi><mi id="A3.E10.10.4.4.2.2.3" xref="A3.E10.10.4.4.2.2.3.cmml">i</mi></msub><mo id="A3.E10.10.4.4.2.1" xref="A3.E10.10.4.4.2.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="A3.E10.10.4.4.2.3" xref="A3.E10.10.4.4.2.3.cmml">𝒰</mi></mrow></mrow></mtd></mtr><mtr id="A3.E12.m1.1.1j" xref="A3.E12.m1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E12.m1.1.1k" xref="A3.E12.m1.1.1.cmml"><mrow id="A3.E11.6.6.6" xref="A3.E12.m1.1.1.cmml"><mrow id="A3.E11.6.6.6.1.1" xref="A3.E11.6.6.6.1.2.cmml"><mo id="A3.E11.6.6.6.1.1.2" stretchy="false" xref="A3.E11.6.6.6.1.2.1.cmml">{</mo><mi id="A3.E11.5.5.5" xref="A3.E11.5.5.5.cmml">p</mi><mo id="A3.E11.6.6.6.1.1.3" lspace="0.170em" rspace="0.170em" xref="A3.E11.6.6.6.1.2.1.cmml">|</mo><mrow id="A3.E11.6.6.6.1.1.1" xref="A3.E11.6.6.6.1.1.1.cmml"><msub id="A3.E11.6.6.6.1.1.1.2" xref="A3.E11.6.6.6.1.1.1.2.cmml"><mi id="A3.E11.6.6.6.1.1.1.2.2" xref="A3.E11.6.6.6.1.1.1.2.2.cmml">e</mi><mrow id="A3.E11.2.2.2.2.4" xref="A3.E11.2.2.2.2.3.cmml"><mi id="A3.E11.1.1.1.1.1" xref="A3.E11.1.1.1.1.1.cmml">p</mi><mo id="A3.E11.2.2.2.2.4.1" xref="A3.E11.2.2.2.2.3.cmml">,</mo><mi id="A3.E11.2.2.2.2.2" xref="A3.E11.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="A3.E11.6.6.6.1.1.1.1" xref="A3.E11.6.6.6.1.1.1.1.cmml">∈</mo><msub id="A3.E11.6.6.6.1.1.1.3" xref="A3.E11.6.6.6.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E11.6.6.6.1.1.1.3.2" xref="A3.E11.6.6.6.1.1.1.3.2.cmml">ℰ</mi><mrow id="A3.E11.4.4.4.2.4" xref="A3.E11.4.4.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E11.3.3.3.1.1" xref="A3.E11.3.3.3.1.1.cmml">𝒫</mi><mo id="A3.E11.4.4.4.2.4.1" xref="A3.E11.4.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A3.E11.4.4.4.2.2" xref="A3.E11.4.4.4.2.2.cmml">𝒱</mi></mrow></msub></mrow><mo id="A3.E11.6.6.6.1.1.4" stretchy="false" xref="A3.E11.6.6.6.1.2.1.cmml">}</mo></mrow><mo id="A3.E11.6.6.6.2" xref="A3.E12.m1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A3.E12.m1.1.1l" xref="A3.E12.m1.1.1.cmml"><mrow id="A3.E11.10.4.4" xref="A3.E11.10.4.5.cmml"><mrow id="A3.E11.9.3.3.1" xref="A3.E11.9.3.3.1.cmml"><mrow id="A3.E11.9.3.3.1.2.2" xref="A3.E11.9.3.3.1.2.1.cmml"><mi id="A3.E11.7.1.1" xref="A3.E11.7.1.1.cmml">if</mi><mspace id="A3.E11.9.3.3.1.2.2.1" width="1em" xref="A3.E11.9.3.3.1.2.1.cmml"></mspace><mi id="A3.E11.8.2.2" xref="A3.E11.8.2.2.cmml">i</mi></mrow><mo id="A3.E11.9.3.3.1.1" xref="A3.E11.9.3.3.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E11.9.3.3.1.3" xref="A3.E11.9.3.3.1.3.cmml">𝒱</mi></mrow><mo id="A3.E11.10.4.4.3" xref="A3.E11.10.4.5a.cmml">,</mo><mrow id="A3.E11.10.4.4.2" xref="A3.E11.10.4.4.2.cmml"><msub id="A3.E11.10.4.4.2.2" xref="A3.E11.10.4.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E11.10.4.4.2.2.2" xref="A3.E11.10.4.4.2.2.2.cmml">𝒩</mi><mi id="A3.E11.10.4.4.2.2.3" xref="A3.E11.10.4.4.2.2.3.cmml">i</mi></msub><mo id="A3.E11.10.4.4.2.1" xref="A3.E11.10.4.4.2.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="A3.E11.10.4.4.2.3" xref="A3.E11.10.4.4.2.3.cmml">𝒫</mi></mrow></mrow></mtd></mtr></mtable><mi id="A3.E12.m1.2.2.1.1.3.2.2" xref="A3.E12.m1.2.2.1.1.3.1.1.cmml"></mi></mrow></mrow><mo id="A3.E12.m1.2.2.1.2" xref="A3.E12.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E12.m1.2b"><apply id="A3.E12.m1.2.2.1.1.cmml" xref="A3.E12.m1.2.2.1"><eq id="A3.E12.m1.2.2.1.1.1.cmml" xref="A3.E12.m1.2.2.1.1.1"></eq><apply id="A3.E12.m1.2.2.1.1.2.cmml" xref="A3.E12.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.E12.m1.2.2.1.1.2.1.cmml" xref="A3.E12.m1.2.2.1.1.2">subscript</csymbol><ci id="A3.E12.m1.2.2.1.1.2.2.cmml" xref="A3.E12.m1.2.2.1.1.2.2">𝒩</ci><ci id="A3.E12.m1.2.2.1.1.2.3.cmml" xref="A3.E12.m1.2.2.1.1.2.3">𝑖</ci></apply><apply id="A3.E12.m1.2.2.1.1.3.1.cmml" xref="A3.E12.m1.2.2.1.1.3.2"><csymbol cd="latexml" id="A3.E12.m1.2.2.1.1.3.1.1.cmml" xref="A3.E12.m1.2.2.1.1.3.2.1">cases</csymbol><matrix id="A3.E12.m1.1.1.cmml" xref="A3.E12.m1.1.1"><matrixrow id="A3.E12.m1.1.1a.cmml" xref="A3.E12.m1.1.1"><apply id="A3.E8.6.6.6.1.2.cmml" xref="A3.E8.6.6.6.1.1"><csymbol cd="latexml" id="A3.E8.6.6.6.1.2.1.cmml" xref="A3.E8.6.6.6.1.1.2">conditional-set</csymbol><ci id="A3.E8.5.5.5.cmml" xref="A3.E8.5.5.5">𝑣</ci><apply id="A3.E8.6.6.6.1.1.1.cmml" xref="A3.E8.6.6.6.1.1.1"><in id="A3.E8.6.6.6.1.1.1.1.cmml" xref="A3.E8.6.6.6.1.1.1.1"></in><apply id="A3.E8.6.6.6.1.1.1.2.cmml" xref="A3.E8.6.6.6.1.1.1.2"><csymbol cd="ambiguous" id="A3.E8.6.6.6.1.1.1.2.1.cmml" xref="A3.E8.6.6.6.1.1.1.2">subscript</csymbol><ci id="A3.E8.6.6.6.1.1.1.2.2.cmml" xref="A3.E8.6.6.6.1.1.1.2.2">𝑒</ci><list id="A3.E8.2.2.2.2.3.cmml" xref="A3.E8.2.2.2.2.4"><ci id="A3.E8.1.1.1.1.1.cmml" xref="A3.E8.1.1.1.1.1">𝑖</ci><ci id="A3.E8.2.2.2.2.2.cmml" xref="A3.E8.2.2.2.2.2">𝑣</ci></list></apply><apply id="A3.E8.6.6.6.1.1.1.3.cmml" xref="A3.E8.6.6.6.1.1.1.3"><csymbol cd="ambiguous" id="A3.E8.6.6.6.1.1.1.3.1.cmml" xref="A3.E8.6.6.6.1.1.1.3">subscript</csymbol><ci id="A3.E8.6.6.6.1.1.1.3.2.cmml" xref="A3.E8.6.6.6.1.1.1.3.2">ℰ</ci><list id="A3.E8.4.4.4.2.3.cmml" xref="A3.E8.4.4.4.2.4"><ci id="A3.E8.3.3.3.1.1.cmml" xref="A3.E8.3.3.3.1.1">𝒰</ci><ci id="A3.E8.4.4.4.2.2.cmml" xref="A3.E8.4.4.4.2.2">𝒱</ci></list></apply></apply></apply><apply id="A3.E8.8.2.cmml" xref="A3.E8.8.2"><in id="A3.E8.8.2.3.cmml" xref="A3.E8.8.2.3"></in><list id="A3.E8.8.2.4.1.cmml" xref="A3.E8.8.2.4.2"><ci id="A3.E8.7.1.1.cmml" xref="A3.E8.7.1.1">if</ci><ci id="A3.E8.8.2.2.cmml" xref="A3.E8.8.2.2">𝑖</ci></list><ci id="A3.E8.8.2.5.cmml" xref="A3.E8.8.2.5">𝒰</ci></apply></matrixrow><matrixrow id="A3.E12.m1.1.1b.cmml" xref="A3.E12.m1.1.1"><apply id="A3.E9.6.6.6.1.2.cmml" xref="A3.E9.6.6.6.1.1"><csymbol cd="latexml" id="A3.E9.6.6.6.1.2.1.cmml" xref="A3.E9.6.6.6.1.1.2">conditional-set</csymbol><ci id="A3.E9.5.5.5.cmml" xref="A3.E9.5.5.5">𝑣</ci><apply id="A3.E9.6.6.6.1.1.1.cmml" xref="A3.E9.6.6.6.1.1.1"><in id="A3.E9.6.6.6.1.1.1.1.cmml" xref="A3.E9.6.6.6.1.1.1.1"></in><apply id="A3.E9.6.6.6.1.1.1.2.cmml" xref="A3.E9.6.6.6.1.1.1.2"><csymbol cd="ambiguous" id="A3.E9.6.6.6.1.1.1.2.1.cmml" xref="A3.E9.6.6.6.1.1.1.2">subscript</csymbol><ci id="A3.E9.6.6.6.1.1.1.2.2.cmml" xref="A3.E9.6.6.6.1.1.1.2.2">𝑒</ci><list id="A3.E9.2.2.2.2.3.cmml" xref="A3.E9.2.2.2.2.4"><ci id="A3.E9.1.1.1.1.1.cmml" xref="A3.E9.1.1.1.1.1">𝑖</ci><ci id="A3.E9.2.2.2.2.2.cmml" xref="A3.E9.2.2.2.2.2">𝑣</ci></list></apply><apply id="A3.E9.6.6.6.1.1.1.3.cmml" xref="A3.E9.6.6.6.1.1.1.3"><csymbol cd="ambiguous" id="A3.E9.6.6.6.1.1.1.3.1.cmml" xref="A3.E9.6.6.6.1.1.1.3">subscript</csymbol><ci id="A3.E9.6.6.6.1.1.1.3.2.cmml" xref="A3.E9.6.6.6.1.1.1.3.2">ℰ</ci><list id="A3.E9.4.4.4.2.3.cmml" xref="A3.E9.4.4.4.2.4"><ci id="A3.E9.3.3.3.1.1.cmml" xref="A3.E9.3.3.3.1.1">𝒫</ci><ci id="A3.E9.4.4.4.2.2.cmml" xref="A3.E9.4.4.4.2.2">𝒱</ci></list></apply></apply></apply><apply id="A3.E9.8.2.cmml" xref="A3.E9.8.2"><in id="A3.E9.8.2.3.cmml" xref="A3.E9.8.2.3"></in><list id="A3.E9.8.2.4.1.cmml" xref="A3.E9.8.2.4.2"><ci id="A3.E9.7.1.1.cmml" xref="A3.E9.7.1.1">if</ci><ci id="A3.E9.8.2.2.cmml" xref="A3.E9.8.2.2">𝑖</ci></list><ci id="A3.E9.8.2.5.cmml" xref="A3.E9.8.2.5">𝒫</ci></apply></matrixrow><matrixrow id="A3.E12.m1.1.1c.cmml" xref="A3.E12.m1.1.1"><apply id="A3.E10.6.6.6.1.2.cmml" xref="A3.E10.6.6.6.1.1"><csymbol cd="latexml" id="A3.E10.6.6.6.1.2.1.cmml" xref="A3.E10.6.6.6.1.1.2">conditional-set</csymbol><ci id="A3.E10.5.5.5.cmml" xref="A3.E10.5.5.5">𝑢</ci><apply id="A3.E10.6.6.6.1.1.1.cmml" xref="A3.E10.6.6.6.1.1.1"><in id="A3.E10.6.6.6.1.1.1.1.cmml" xref="A3.E10.6.6.6.1.1.1.1"></in><apply id="A3.E10.6.6.6.1.1.1.2.cmml" xref="A3.E10.6.6.6.1.1.1.2"><csymbol cd="ambiguous" id="A3.E10.6.6.6.1.1.1.2.1.cmml" xref="A3.E10.6.6.6.1.1.1.2">subscript</csymbol><ci id="A3.E10.6.6.6.1.1.1.2.2.cmml" xref="A3.E10.6.6.6.1.1.1.2.2">𝑒</ci><list id="A3.E10.2.2.2.2.3.cmml" xref="A3.E10.2.2.2.2.4"><ci id="A3.E10.1.1.1.1.1.cmml" xref="A3.E10.1.1.1.1.1">𝑢</ci><ci id="A3.E10.2.2.2.2.2.cmml" xref="A3.E10.2.2.2.2.2">𝑖</ci></list></apply><apply id="A3.E10.6.6.6.1.1.1.3.cmml" xref="A3.E10.6.6.6.1.1.1.3"><csymbol cd="ambiguous" id="A3.E10.6.6.6.1.1.1.3.1.cmml" xref="A3.E10.6.6.6.1.1.1.3">subscript</csymbol><ci id="A3.E10.6.6.6.1.1.1.3.2.cmml" xref="A3.E10.6.6.6.1.1.1.3.2">ℰ</ci><list id="A3.E10.4.4.4.2.3.cmml" xref="A3.E10.4.4.4.2.4"><ci id="A3.E10.3.3.3.1.1.cmml" xref="A3.E10.3.3.3.1.1">𝒰</ci><ci id="A3.E10.4.4.4.2.2.cmml" xref="A3.E10.4.4.4.2.2">𝒱</ci></list></apply></apply></apply><apply id="A3.E10.10.4.5.cmml" xref="A3.E10.10.4.4"><csymbol cd="ambiguous" id="A3.E10.10.4.5a.cmml" xref="A3.E10.10.4.4.3">formulae-sequence</csymbol><apply id="A3.E10.9.3.3.1.cmml" xref="A3.E10.9.3.3.1"><in id="A3.E10.9.3.3.1.1.cmml" xref="A3.E10.9.3.3.1.1"></in><list id="A3.E10.9.3.3.1.2.1.cmml" xref="A3.E10.9.3.3.1.2.2"><ci id="A3.E10.7.1.1.cmml" xref="A3.E10.7.1.1">if</ci><ci id="A3.E10.8.2.2.cmml" xref="A3.E10.8.2.2">𝑖</ci></list><ci id="A3.E10.9.3.3.1.3.cmml" xref="A3.E10.9.3.3.1.3">𝒱</ci></apply><apply id="A3.E10.10.4.4.2.cmml" xref="A3.E10.10.4.4.2"><subset id="A3.E10.10.4.4.2.1.cmml" xref="A3.E10.10.4.4.2.1"></subset><apply id="A3.E10.10.4.4.2.2.cmml" xref="A3.E10.10.4.4.2.2"><csymbol cd="ambiguous" id="A3.E10.10.4.4.2.2.1.cmml" xref="A3.E10.10.4.4.2.2">subscript</csymbol><ci id="A3.E10.10.4.4.2.2.2.cmml" xref="A3.E10.10.4.4.2.2.2">𝒩</ci><ci id="A3.E10.10.4.4.2.2.3.cmml" xref="A3.E10.10.4.4.2.2.3">𝑖</ci></apply><ci id="A3.E10.10.4.4.2.3.cmml" xref="A3.E10.10.4.4.2.3">𝒰</ci></apply></apply></matrixrow><matrixrow id="A3.E12.m1.1.1d.cmml" xref="A3.E12.m1.1.1"><apply id="A3.E11.6.6.6.1.2.cmml" xref="A3.E11.6.6.6.1.1"><csymbol cd="latexml" id="A3.E11.6.6.6.1.2.1.cmml" xref="A3.E11.6.6.6.1.1.2">conditional-set</csymbol><ci id="A3.E11.5.5.5.cmml" xref="A3.E11.5.5.5">𝑝</ci><apply id="A3.E11.6.6.6.1.1.1.cmml" xref="A3.E11.6.6.6.1.1.1"><in id="A3.E11.6.6.6.1.1.1.1.cmml" xref="A3.E11.6.6.6.1.1.1.1"></in><apply id="A3.E11.6.6.6.1.1.1.2.cmml" xref="A3.E11.6.6.6.1.1.1.2"><csymbol cd="ambiguous" id="A3.E11.6.6.6.1.1.1.2.1.cmml" xref="A3.E11.6.6.6.1.1.1.2">subscript</csymbol><ci id="A3.E11.6.6.6.1.1.1.2.2.cmml" xref="A3.E11.6.6.6.1.1.1.2.2">𝑒</ci><list id="A3.E11.2.2.2.2.3.cmml" xref="A3.E11.2.2.2.2.4"><ci id="A3.E11.1.1.1.1.1.cmml" xref="A3.E11.1.1.1.1.1">𝑝</ci><ci id="A3.E11.2.2.2.2.2.cmml" xref="A3.E11.2.2.2.2.2">𝑖</ci></list></apply><apply id="A3.E11.6.6.6.1.1.1.3.cmml" xref="A3.E11.6.6.6.1.1.1.3"><csymbol cd="ambiguous" id="A3.E11.6.6.6.1.1.1.3.1.cmml" xref="A3.E11.6.6.6.1.1.1.3">subscript</csymbol><ci id="A3.E11.6.6.6.1.1.1.3.2.cmml" xref="A3.E11.6.6.6.1.1.1.3.2">ℰ</ci><list id="A3.E11.4.4.4.2.3.cmml" xref="A3.E11.4.4.4.2.4"><ci id="A3.E11.3.3.3.1.1.cmml" xref="A3.E11.3.3.3.1.1">𝒫</ci><ci id="A3.E11.4.4.4.2.2.cmml" xref="A3.E11.4.4.4.2.2">𝒱</ci></list></apply></apply></apply><apply id="A3.E11.10.4.5.cmml" xref="A3.E11.10.4.4"><csymbol cd="ambiguous" id="A3.E11.10.4.5a.cmml" xref="A3.E11.10.4.4.3">formulae-sequence</csymbol><apply id="A3.E11.9.3.3.1.cmml" xref="A3.E11.9.3.3.1"><in id="A3.E11.9.3.3.1.1.cmml" xref="A3.E11.9.3.3.1.1"></in><list id="A3.E11.9.3.3.1.2.1.cmml" xref="A3.E11.9.3.3.1.2.2"><ci id="A3.E11.7.1.1.cmml" xref="A3.E11.7.1.1">if</ci><ci id="A3.E11.8.2.2.cmml" xref="A3.E11.8.2.2">𝑖</ci></list><ci id="A3.E11.9.3.3.1.3.cmml" xref="A3.E11.9.3.3.1.3">𝒱</ci></apply><apply id="A3.E11.10.4.4.2.cmml" xref="A3.E11.10.4.4.2"><subset id="A3.E11.10.4.4.2.1.cmml" xref="A3.E11.10.4.4.2.1"></subset><apply id="A3.E11.10.4.4.2.2.cmml" xref="A3.E11.10.4.4.2.2"><csymbol cd="ambiguous" id="A3.E11.10.4.4.2.2.1.cmml" xref="A3.E11.10.4.4.2.2">subscript</csymbol><ci id="A3.E11.10.4.4.2.2.2.cmml" xref="A3.E11.10.4.4.2.2.2">𝒩</ci><ci id="A3.E11.10.4.4.2.2.3.cmml" xref="A3.E11.10.4.4.2.2.3">𝑖</ci></apply><ci id="A3.E11.10.4.4.2.3.cmml" xref="A3.E11.10.4.4.2.3">𝒫</ci></apply></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E12.m1.2c">\displaystyle\mathcal{N}_{i}=\left\{\begin{array}[]{ll}\{v\thinspace|%
\thinspace e_{i,v}\in\mathcal{E}_{\mathcal{U},\mathcal{V}}\},&amp;\mathrm{if}\quad
i%
\in\mathcal{U}\\
\{v\thinspace|\thinspace e_{i,v}\in\mathcal{E}_{\mathcal{P},\mathcal{V}}\},&amp;%
\mathrm{if}\quad i\in\mathcal{P}\\
\{u\thinspace|\thinspace e_{u,i}\in\mathcal{E}_{\mathcal{U},\mathcal{V}}\},&amp;%
\mathrm{if}\quad i\in\mathcal{V},\mathcal{N}_{i}\subset\mathcal{U}\\
\{p\thinspace|\thinspace e_{p,i}\in\mathcal{E}_{\mathcal{P},\mathcal{V}}\},&amp;%
\mathrm{if}\quad i\in\mathcal{V},\mathcal{N}_{i}\subset\mathcal{P}\\
\end{array}\right.,</annotation><annotation encoding="application/x-llamapun" id="A3.E12.m1.2d">caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { start_ARRAY start_ROW start_CELL { italic_v | italic_e start_POSTSUBSCRIPT italic_i , italic_v end_POSTSUBSCRIPT ∈ caligraphic_E start_POSTSUBSCRIPT caligraphic_U , caligraphic_V end_POSTSUBSCRIPT } , end_CELL start_CELL roman_if italic_i ∈ caligraphic_U end_CELL end_ROW start_ROW start_CELL { italic_v | italic_e start_POSTSUBSCRIPT italic_i , italic_v end_POSTSUBSCRIPT ∈ caligraphic_E start_POSTSUBSCRIPT caligraphic_P , caligraphic_V end_POSTSUBSCRIPT } , end_CELL start_CELL roman_if italic_i ∈ caligraphic_P end_CELL end_ROW start_ROW start_CELL { italic_u | italic_e start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT ∈ caligraphic_E start_POSTSUBSCRIPT caligraphic_U , caligraphic_V end_POSTSUBSCRIPT } , end_CELL start_CELL roman_if italic_i ∈ caligraphic_V , caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⊂ caligraphic_U end_CELL end_ROW start_ROW start_CELL { italic_p | italic_e start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT ∈ caligraphic_E start_POSTSUBSCRIPT caligraphic_P , caligraphic_V end_POSTSUBSCRIPT } , end_CELL start_CELL roman_if italic_i ∈ caligraphic_V , caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⊂ caligraphic_P end_CELL end_ROW end_ARRAY ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p1.31">where <math alttext="\mathbf{a}^{(l)}_{k}\in\mathbb{R}^{d/K}" class="ltx_Math" display="inline" id="A3.p1.16.m1.1"><semantics id="A3.p1.16.m1.1a"><mrow id="A3.p1.16.m1.1.2" xref="A3.p1.16.m1.1.2.cmml"><msubsup id="A3.p1.16.m1.1.2.2" xref="A3.p1.16.m1.1.2.2.cmml"><mi id="A3.p1.16.m1.1.2.2.2.2" xref="A3.p1.16.m1.1.2.2.2.2.cmml">𝐚</mi><mi id="A3.p1.16.m1.1.2.2.3" xref="A3.p1.16.m1.1.2.2.3.cmml">k</mi><mrow id="A3.p1.16.m1.1.1.1.3" xref="A3.p1.16.m1.1.2.2.cmml"><mo id="A3.p1.16.m1.1.1.1.3.1" stretchy="false" xref="A3.p1.16.m1.1.2.2.cmml">(</mo><mi id="A3.p1.16.m1.1.1.1.1" xref="A3.p1.16.m1.1.1.1.1.cmml">l</mi><mo id="A3.p1.16.m1.1.1.1.3.2" stretchy="false" xref="A3.p1.16.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A3.p1.16.m1.1.2.1" xref="A3.p1.16.m1.1.2.1.cmml">∈</mo><msup id="A3.p1.16.m1.1.2.3" xref="A3.p1.16.m1.1.2.3.cmml"><mi id="A3.p1.16.m1.1.2.3.2" xref="A3.p1.16.m1.1.2.3.2.cmml">ℝ</mi><mrow id="A3.p1.16.m1.1.2.3.3" xref="A3.p1.16.m1.1.2.3.3.cmml"><mi id="A3.p1.16.m1.1.2.3.3.2" xref="A3.p1.16.m1.1.2.3.3.2.cmml">d</mi><mo id="A3.p1.16.m1.1.2.3.3.1" xref="A3.p1.16.m1.1.2.3.3.1.cmml">/</mo><mi id="A3.p1.16.m1.1.2.3.3.3" xref="A3.p1.16.m1.1.2.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.16.m1.1b"><apply id="A3.p1.16.m1.1.2.cmml" xref="A3.p1.16.m1.1.2"><in id="A3.p1.16.m1.1.2.1.cmml" xref="A3.p1.16.m1.1.2.1"></in><apply id="A3.p1.16.m1.1.2.2.cmml" xref="A3.p1.16.m1.1.2.2"><csymbol cd="ambiguous" id="A3.p1.16.m1.1.2.2.1.cmml" xref="A3.p1.16.m1.1.2.2">subscript</csymbol><apply id="A3.p1.16.m1.1.2.2.2.cmml" xref="A3.p1.16.m1.1.2.2"><csymbol cd="ambiguous" id="A3.p1.16.m1.1.2.2.2.1.cmml" xref="A3.p1.16.m1.1.2.2">superscript</csymbol><ci id="A3.p1.16.m1.1.2.2.2.2.cmml" xref="A3.p1.16.m1.1.2.2.2.2">𝐚</ci><ci id="A3.p1.16.m1.1.1.1.1.cmml" xref="A3.p1.16.m1.1.1.1.1">𝑙</ci></apply><ci id="A3.p1.16.m1.1.2.2.3.cmml" xref="A3.p1.16.m1.1.2.2.3">𝑘</ci></apply><apply id="A3.p1.16.m1.1.2.3.cmml" xref="A3.p1.16.m1.1.2.3"><csymbol cd="ambiguous" id="A3.p1.16.m1.1.2.3.1.cmml" xref="A3.p1.16.m1.1.2.3">superscript</csymbol><ci id="A3.p1.16.m1.1.2.3.2.cmml" xref="A3.p1.16.m1.1.2.3.2">ℝ</ci><apply id="A3.p1.16.m1.1.2.3.3.cmml" xref="A3.p1.16.m1.1.2.3.3"><divide id="A3.p1.16.m1.1.2.3.3.1.cmml" xref="A3.p1.16.m1.1.2.3.3.1"></divide><ci id="A3.p1.16.m1.1.2.3.3.2.cmml" xref="A3.p1.16.m1.1.2.3.3.2">𝑑</ci><ci id="A3.p1.16.m1.1.2.3.3.3.cmml" xref="A3.p1.16.m1.1.2.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.16.m1.1c">\mathbf{a}^{(l)}_{k}\in\mathbb{R}^{d/K}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.16.m1.1d">bold_a start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d / italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{W}^{(l)}_{1,k}\in\mathbb{R}^{({d/K})\times{d}}" class="ltx_Math" display="inline" id="A3.p1.17.m2.4"><semantics id="A3.p1.17.m2.4a"><mrow id="A3.p1.17.m2.4.5" xref="A3.p1.17.m2.4.5.cmml"><msubsup id="A3.p1.17.m2.4.5.2" xref="A3.p1.17.m2.4.5.2.cmml"><mi id="A3.p1.17.m2.4.5.2.2.2" xref="A3.p1.17.m2.4.5.2.2.2.cmml">𝐖</mi><mrow id="A3.p1.17.m2.3.3.2.4" xref="A3.p1.17.m2.3.3.2.3.cmml"><mn id="A3.p1.17.m2.2.2.1.1" xref="A3.p1.17.m2.2.2.1.1.cmml">1</mn><mo id="A3.p1.17.m2.3.3.2.4.1" xref="A3.p1.17.m2.3.3.2.3.cmml">,</mo><mi id="A3.p1.17.m2.3.3.2.2" xref="A3.p1.17.m2.3.3.2.2.cmml">k</mi></mrow><mrow id="A3.p1.17.m2.1.1.1.3" xref="A3.p1.17.m2.4.5.2.cmml"><mo id="A3.p1.17.m2.1.1.1.3.1" stretchy="false" xref="A3.p1.17.m2.4.5.2.cmml">(</mo><mi id="A3.p1.17.m2.1.1.1.1" xref="A3.p1.17.m2.1.1.1.1.cmml">l</mi><mo id="A3.p1.17.m2.1.1.1.3.2" stretchy="false" xref="A3.p1.17.m2.4.5.2.cmml">)</mo></mrow></msubsup><mo id="A3.p1.17.m2.4.5.1" xref="A3.p1.17.m2.4.5.1.cmml">∈</mo><msup id="A3.p1.17.m2.4.5.3" xref="A3.p1.17.m2.4.5.3.cmml"><mi id="A3.p1.17.m2.4.5.3.2" xref="A3.p1.17.m2.4.5.3.2.cmml">ℝ</mi><mrow id="A3.p1.17.m2.4.4.1" xref="A3.p1.17.m2.4.4.1.cmml"><mrow id="A3.p1.17.m2.4.4.1.1.1" xref="A3.p1.17.m2.4.4.1.1.1.1.cmml"><mo id="A3.p1.17.m2.4.4.1.1.1.2" stretchy="false" xref="A3.p1.17.m2.4.4.1.1.1.1.cmml">(</mo><mrow id="A3.p1.17.m2.4.4.1.1.1.1" xref="A3.p1.17.m2.4.4.1.1.1.1.cmml"><mi id="A3.p1.17.m2.4.4.1.1.1.1.2" xref="A3.p1.17.m2.4.4.1.1.1.1.2.cmml">d</mi><mo id="A3.p1.17.m2.4.4.1.1.1.1.1" xref="A3.p1.17.m2.4.4.1.1.1.1.1.cmml">/</mo><mi id="A3.p1.17.m2.4.4.1.1.1.1.3" xref="A3.p1.17.m2.4.4.1.1.1.1.3.cmml">K</mi></mrow><mo id="A3.p1.17.m2.4.4.1.1.1.3" rspace="0.055em" stretchy="false" xref="A3.p1.17.m2.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="A3.p1.17.m2.4.4.1.2" rspace="0.222em" xref="A3.p1.17.m2.4.4.1.2.cmml">×</mo><mi id="A3.p1.17.m2.4.4.1.3" xref="A3.p1.17.m2.4.4.1.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.17.m2.4b"><apply id="A3.p1.17.m2.4.5.cmml" xref="A3.p1.17.m2.4.5"><in id="A3.p1.17.m2.4.5.1.cmml" xref="A3.p1.17.m2.4.5.1"></in><apply id="A3.p1.17.m2.4.5.2.cmml" xref="A3.p1.17.m2.4.5.2"><csymbol cd="ambiguous" id="A3.p1.17.m2.4.5.2.1.cmml" xref="A3.p1.17.m2.4.5.2">subscript</csymbol><apply id="A3.p1.17.m2.4.5.2.2.cmml" xref="A3.p1.17.m2.4.5.2"><csymbol cd="ambiguous" id="A3.p1.17.m2.4.5.2.2.1.cmml" xref="A3.p1.17.m2.4.5.2">superscript</csymbol><ci id="A3.p1.17.m2.4.5.2.2.2.cmml" xref="A3.p1.17.m2.4.5.2.2.2">𝐖</ci><ci id="A3.p1.17.m2.1.1.1.1.cmml" xref="A3.p1.17.m2.1.1.1.1">𝑙</ci></apply><list id="A3.p1.17.m2.3.3.2.3.cmml" xref="A3.p1.17.m2.3.3.2.4"><cn id="A3.p1.17.m2.2.2.1.1.cmml" type="integer" xref="A3.p1.17.m2.2.2.1.1">1</cn><ci id="A3.p1.17.m2.3.3.2.2.cmml" xref="A3.p1.17.m2.3.3.2.2">𝑘</ci></list></apply><apply id="A3.p1.17.m2.4.5.3.cmml" xref="A3.p1.17.m2.4.5.3"><csymbol cd="ambiguous" id="A3.p1.17.m2.4.5.3.1.cmml" xref="A3.p1.17.m2.4.5.3">superscript</csymbol><ci id="A3.p1.17.m2.4.5.3.2.cmml" xref="A3.p1.17.m2.4.5.3.2">ℝ</ci><apply id="A3.p1.17.m2.4.4.1.cmml" xref="A3.p1.17.m2.4.4.1"><times id="A3.p1.17.m2.4.4.1.2.cmml" xref="A3.p1.17.m2.4.4.1.2"></times><apply id="A3.p1.17.m2.4.4.1.1.1.1.cmml" xref="A3.p1.17.m2.4.4.1.1.1"><divide id="A3.p1.17.m2.4.4.1.1.1.1.1.cmml" xref="A3.p1.17.m2.4.4.1.1.1.1.1"></divide><ci id="A3.p1.17.m2.4.4.1.1.1.1.2.cmml" xref="A3.p1.17.m2.4.4.1.1.1.1.2">𝑑</ci><ci id="A3.p1.17.m2.4.4.1.1.1.1.3.cmml" xref="A3.p1.17.m2.4.4.1.1.1.1.3">𝐾</ci></apply><ci id="A3.p1.17.m2.4.4.1.3.cmml" xref="A3.p1.17.m2.4.4.1.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.17.m2.4c">\mathbf{W}^{(l)}_{1,k}\in\mathbb{R}^{({d/K})\times{d}}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.17.m2.4d">bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 , italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_d / italic_K ) × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>,<math alttext="\mathbf{W}^{(l)}_{2,k}\in\mathbb{R}^{{(d/K})\times{d}}" class="ltx_Math" display="inline" id="A3.p1.18.m3.4"><semantics id="A3.p1.18.m3.4a"><mrow id="A3.p1.18.m3.4.5" xref="A3.p1.18.m3.4.5.cmml"><msubsup id="A3.p1.18.m3.4.5.2" xref="A3.p1.18.m3.4.5.2.cmml"><mi id="A3.p1.18.m3.4.5.2.2.2" xref="A3.p1.18.m3.4.5.2.2.2.cmml">𝐖</mi><mrow id="A3.p1.18.m3.3.3.2.4" xref="A3.p1.18.m3.3.3.2.3.cmml"><mn id="A3.p1.18.m3.2.2.1.1" xref="A3.p1.18.m3.2.2.1.1.cmml">2</mn><mo id="A3.p1.18.m3.3.3.2.4.1" xref="A3.p1.18.m3.3.3.2.3.cmml">,</mo><mi id="A3.p1.18.m3.3.3.2.2" xref="A3.p1.18.m3.3.3.2.2.cmml">k</mi></mrow><mrow id="A3.p1.18.m3.1.1.1.3" xref="A3.p1.18.m3.4.5.2.cmml"><mo id="A3.p1.18.m3.1.1.1.3.1" stretchy="false" xref="A3.p1.18.m3.4.5.2.cmml">(</mo><mi id="A3.p1.18.m3.1.1.1.1" xref="A3.p1.18.m3.1.1.1.1.cmml">l</mi><mo id="A3.p1.18.m3.1.1.1.3.2" stretchy="false" xref="A3.p1.18.m3.4.5.2.cmml">)</mo></mrow></msubsup><mo id="A3.p1.18.m3.4.5.1" xref="A3.p1.18.m3.4.5.1.cmml">∈</mo><msup id="A3.p1.18.m3.4.5.3" xref="A3.p1.18.m3.4.5.3.cmml"><mi id="A3.p1.18.m3.4.5.3.2" xref="A3.p1.18.m3.4.5.3.2.cmml">ℝ</mi><mrow id="A3.p1.18.m3.4.4.1" xref="A3.p1.18.m3.4.4.1.cmml"><mrow id="A3.p1.18.m3.4.4.1.1.1" xref="A3.p1.18.m3.4.4.1.1.1.1.cmml"><mo id="A3.p1.18.m3.4.4.1.1.1.2" stretchy="false" xref="A3.p1.18.m3.4.4.1.1.1.1.cmml">(</mo><mrow id="A3.p1.18.m3.4.4.1.1.1.1" xref="A3.p1.18.m3.4.4.1.1.1.1.cmml"><mi id="A3.p1.18.m3.4.4.1.1.1.1.2" xref="A3.p1.18.m3.4.4.1.1.1.1.2.cmml">d</mi><mo id="A3.p1.18.m3.4.4.1.1.1.1.1" xref="A3.p1.18.m3.4.4.1.1.1.1.1.cmml">/</mo><mi id="A3.p1.18.m3.4.4.1.1.1.1.3" xref="A3.p1.18.m3.4.4.1.1.1.1.3.cmml">K</mi></mrow><mo id="A3.p1.18.m3.4.4.1.1.1.3" rspace="0.055em" stretchy="false" xref="A3.p1.18.m3.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="A3.p1.18.m3.4.4.1.2" rspace="0.222em" xref="A3.p1.18.m3.4.4.1.2.cmml">×</mo><mi id="A3.p1.18.m3.4.4.1.3" xref="A3.p1.18.m3.4.4.1.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.18.m3.4b"><apply id="A3.p1.18.m3.4.5.cmml" xref="A3.p1.18.m3.4.5"><in id="A3.p1.18.m3.4.5.1.cmml" xref="A3.p1.18.m3.4.5.1"></in><apply id="A3.p1.18.m3.4.5.2.cmml" xref="A3.p1.18.m3.4.5.2"><csymbol cd="ambiguous" id="A3.p1.18.m3.4.5.2.1.cmml" xref="A3.p1.18.m3.4.5.2">subscript</csymbol><apply id="A3.p1.18.m3.4.5.2.2.cmml" xref="A3.p1.18.m3.4.5.2"><csymbol cd="ambiguous" id="A3.p1.18.m3.4.5.2.2.1.cmml" xref="A3.p1.18.m3.4.5.2">superscript</csymbol><ci id="A3.p1.18.m3.4.5.2.2.2.cmml" xref="A3.p1.18.m3.4.5.2.2.2">𝐖</ci><ci id="A3.p1.18.m3.1.1.1.1.cmml" xref="A3.p1.18.m3.1.1.1.1">𝑙</ci></apply><list id="A3.p1.18.m3.3.3.2.3.cmml" xref="A3.p1.18.m3.3.3.2.4"><cn id="A3.p1.18.m3.2.2.1.1.cmml" type="integer" xref="A3.p1.18.m3.2.2.1.1">2</cn><ci id="A3.p1.18.m3.3.3.2.2.cmml" xref="A3.p1.18.m3.3.3.2.2">𝑘</ci></list></apply><apply id="A3.p1.18.m3.4.5.3.cmml" xref="A3.p1.18.m3.4.5.3"><csymbol cd="ambiguous" id="A3.p1.18.m3.4.5.3.1.cmml" xref="A3.p1.18.m3.4.5.3">superscript</csymbol><ci id="A3.p1.18.m3.4.5.3.2.cmml" xref="A3.p1.18.m3.4.5.3.2">ℝ</ci><apply id="A3.p1.18.m3.4.4.1.cmml" xref="A3.p1.18.m3.4.4.1"><times id="A3.p1.18.m3.4.4.1.2.cmml" xref="A3.p1.18.m3.4.4.1.2"></times><apply id="A3.p1.18.m3.4.4.1.1.1.1.cmml" xref="A3.p1.18.m3.4.4.1.1.1"><divide id="A3.p1.18.m3.4.4.1.1.1.1.1.cmml" xref="A3.p1.18.m3.4.4.1.1.1.1.1"></divide><ci id="A3.p1.18.m3.4.4.1.1.1.1.2.cmml" xref="A3.p1.18.m3.4.4.1.1.1.1.2">𝑑</ci><ci id="A3.p1.18.m3.4.4.1.1.1.1.3.cmml" xref="A3.p1.18.m3.4.4.1.1.1.1.3">𝐾</ci></apply><ci id="A3.p1.18.m3.4.4.1.3.cmml" xref="A3.p1.18.m3.4.4.1.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.18.m3.4c">\mathbf{W}^{(l)}_{2,k}\in\mathbb{R}^{{(d/K})\times{d}}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.18.m3.4d">bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 , italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_d / italic_K ) × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are the trainable parameters for the <math alttext="l" class="ltx_Math" display="inline" id="A3.p1.19.m4.1"><semantics id="A3.p1.19.m4.1a"><mi id="A3.p1.19.m4.1.1" xref="A3.p1.19.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A3.p1.19.m4.1b"><ci id="A3.p1.19.m4.1.1.cmml" xref="A3.p1.19.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.19.m4.1c">l</annotation><annotation encoding="application/x-llamapun" id="A3.p1.19.m4.1d">italic_l</annotation></semantics></math>-th layer, <math alttext="K" class="ltx_Math" display="inline" id="A3.p1.20.m5.1"><semantics id="A3.p1.20.m5.1a"><mi id="A3.p1.20.m5.1.1" xref="A3.p1.20.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.p1.20.m5.1b"><ci id="A3.p1.20.m5.1.1.cmml" xref="A3.p1.20.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.20.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="A3.p1.20.m5.1d">italic_K</annotation></semantics></math> denotes the number of attention heads, <math alttext="\sigma" class="ltx_Math" display="inline" id="A3.p1.21.m6.1"><semantics id="A3.p1.21.m6.1a"><mi id="A3.p1.21.m6.1.1" xref="A3.p1.21.m6.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="A3.p1.21.m6.1b"><ci id="A3.p1.21.m6.1.1.cmml" xref="A3.p1.21.m6.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.21.m6.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="A3.p1.21.m6.1d">italic_σ</annotation></semantics></math> denotes the LeakyReLU activation function, <math alttext="\mathop{||}" class="ltx_math_unparsed" display="inline" id="A3.p1.22.m7.1"><semantics id="A3.p1.22.m7.1a"><mrow id="A3.p1.22.m7.1.1"><mo fence="false" id="A3.p1.22.m7.1.1.1" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A3.p1.22.m7.1.1.2" stretchy="false">|</mo></mrow><annotation encoding="application/x-tex" id="A3.p1.22.m7.1b">\mathop{||}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.22.m7.1c">| |</annotation></semantics></math> denotes the concatenation operation. For the user and attribute value node, its hidden representation of the <math alttext="l{+}1" class="ltx_Math" display="inline" id="A3.p1.23.m8.1"><semantics id="A3.p1.23.m8.1a"><mrow id="A3.p1.23.m8.1.1" xref="A3.p1.23.m8.1.1.cmml"><mi id="A3.p1.23.m8.1.1.2" xref="A3.p1.23.m8.1.1.2.cmml">l</mi><mo id="A3.p1.23.m8.1.1.1" xref="A3.p1.23.m8.1.1.1.cmml">+</mo><mn id="A3.p1.23.m8.1.1.3" xref="A3.p1.23.m8.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.23.m8.1b"><apply id="A3.p1.23.m8.1.1.cmml" xref="A3.p1.23.m8.1.1"><plus id="A3.p1.23.m8.1.1.1.cmml" xref="A3.p1.23.m8.1.1.1"></plus><ci id="A3.p1.23.m8.1.1.2.cmml" xref="A3.p1.23.m8.1.1.2">𝑙</ci><cn id="A3.p1.23.m8.1.1.3.cmml" type="integer" xref="A3.p1.23.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.23.m8.1c">l{+}1</annotation><annotation encoding="application/x-llamapun" id="A3.p1.23.m8.1d">italic_l + 1</annotation></semantics></math>-th layer is obtain from <math alttext="\mathbf{h}_{u}^{(l+1)}=\sigma(\mathbf{z}^{(l+1)}_{u})" class="ltx_Math" display="inline" id="A3.p1.24.m9.3"><semantics id="A3.p1.24.m9.3a"><mrow id="A3.p1.24.m9.3.3" xref="A3.p1.24.m9.3.3.cmml"><msubsup id="A3.p1.24.m9.3.3.3" xref="A3.p1.24.m9.3.3.3.cmml"><mi id="A3.p1.24.m9.3.3.3.2.2" xref="A3.p1.24.m9.3.3.3.2.2.cmml">𝐡</mi><mi id="A3.p1.24.m9.3.3.3.2.3" xref="A3.p1.24.m9.3.3.3.2.3.cmml">u</mi><mrow id="A3.p1.24.m9.1.1.1.1" xref="A3.p1.24.m9.1.1.1.1.1.cmml"><mo id="A3.p1.24.m9.1.1.1.1.2" stretchy="false" xref="A3.p1.24.m9.1.1.1.1.1.cmml">(</mo><mrow id="A3.p1.24.m9.1.1.1.1.1" xref="A3.p1.24.m9.1.1.1.1.1.cmml"><mi id="A3.p1.24.m9.1.1.1.1.1.2" xref="A3.p1.24.m9.1.1.1.1.1.2.cmml">l</mi><mo id="A3.p1.24.m9.1.1.1.1.1.1" xref="A3.p1.24.m9.1.1.1.1.1.1.cmml">+</mo><mn id="A3.p1.24.m9.1.1.1.1.1.3" xref="A3.p1.24.m9.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A3.p1.24.m9.1.1.1.1.3" stretchy="false" xref="A3.p1.24.m9.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A3.p1.24.m9.3.3.2" xref="A3.p1.24.m9.3.3.2.cmml">=</mo><mrow id="A3.p1.24.m9.3.3.1" xref="A3.p1.24.m9.3.3.1.cmml"><mi id="A3.p1.24.m9.3.3.1.3" xref="A3.p1.24.m9.3.3.1.3.cmml">σ</mi><mo id="A3.p1.24.m9.3.3.1.2" xref="A3.p1.24.m9.3.3.1.2.cmml">⁢</mo><mrow id="A3.p1.24.m9.3.3.1.1.1" xref="A3.p1.24.m9.3.3.1.1.1.1.cmml"><mo id="A3.p1.24.m9.3.3.1.1.1.2" stretchy="false" xref="A3.p1.24.m9.3.3.1.1.1.1.cmml">(</mo><msubsup id="A3.p1.24.m9.3.3.1.1.1.1" xref="A3.p1.24.m9.3.3.1.1.1.1.cmml"><mi id="A3.p1.24.m9.3.3.1.1.1.1.2.2" xref="A3.p1.24.m9.3.3.1.1.1.1.2.2.cmml">𝐳</mi><mi id="A3.p1.24.m9.3.3.1.1.1.1.3" xref="A3.p1.24.m9.3.3.1.1.1.1.3.cmml">u</mi><mrow id="A3.p1.24.m9.2.2.1.1" xref="A3.p1.24.m9.2.2.1.1.1.cmml"><mo id="A3.p1.24.m9.2.2.1.1.2" stretchy="false" xref="A3.p1.24.m9.2.2.1.1.1.cmml">(</mo><mrow id="A3.p1.24.m9.2.2.1.1.1" xref="A3.p1.24.m9.2.2.1.1.1.cmml"><mi id="A3.p1.24.m9.2.2.1.1.1.2" xref="A3.p1.24.m9.2.2.1.1.1.2.cmml">l</mi><mo id="A3.p1.24.m9.2.2.1.1.1.1" xref="A3.p1.24.m9.2.2.1.1.1.1.cmml">+</mo><mn id="A3.p1.24.m9.2.2.1.1.1.3" xref="A3.p1.24.m9.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="A3.p1.24.m9.2.2.1.1.3" stretchy="false" xref="A3.p1.24.m9.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A3.p1.24.m9.3.3.1.1.1.3" stretchy="false" xref="A3.p1.24.m9.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.24.m9.3b"><apply id="A3.p1.24.m9.3.3.cmml" xref="A3.p1.24.m9.3.3"><eq id="A3.p1.24.m9.3.3.2.cmml" xref="A3.p1.24.m9.3.3.2"></eq><apply id="A3.p1.24.m9.3.3.3.cmml" xref="A3.p1.24.m9.3.3.3"><csymbol cd="ambiguous" id="A3.p1.24.m9.3.3.3.1.cmml" xref="A3.p1.24.m9.3.3.3">superscript</csymbol><apply id="A3.p1.24.m9.3.3.3.2.cmml" xref="A3.p1.24.m9.3.3.3"><csymbol cd="ambiguous" id="A3.p1.24.m9.3.3.3.2.1.cmml" xref="A3.p1.24.m9.3.3.3">subscript</csymbol><ci id="A3.p1.24.m9.3.3.3.2.2.cmml" xref="A3.p1.24.m9.3.3.3.2.2">𝐡</ci><ci id="A3.p1.24.m9.3.3.3.2.3.cmml" xref="A3.p1.24.m9.3.3.3.2.3">𝑢</ci></apply><apply id="A3.p1.24.m9.1.1.1.1.1.cmml" xref="A3.p1.24.m9.1.1.1.1"><plus id="A3.p1.24.m9.1.1.1.1.1.1.cmml" xref="A3.p1.24.m9.1.1.1.1.1.1"></plus><ci id="A3.p1.24.m9.1.1.1.1.1.2.cmml" xref="A3.p1.24.m9.1.1.1.1.1.2">𝑙</ci><cn id="A3.p1.24.m9.1.1.1.1.1.3.cmml" type="integer" xref="A3.p1.24.m9.1.1.1.1.1.3">1</cn></apply></apply><apply id="A3.p1.24.m9.3.3.1.cmml" xref="A3.p1.24.m9.3.3.1"><times id="A3.p1.24.m9.3.3.1.2.cmml" xref="A3.p1.24.m9.3.3.1.2"></times><ci id="A3.p1.24.m9.3.3.1.3.cmml" xref="A3.p1.24.m9.3.3.1.3">𝜎</ci><apply id="A3.p1.24.m9.3.3.1.1.1.1.cmml" xref="A3.p1.24.m9.3.3.1.1.1"><csymbol cd="ambiguous" id="A3.p1.24.m9.3.3.1.1.1.1.1.cmml" xref="A3.p1.24.m9.3.3.1.1.1">subscript</csymbol><apply id="A3.p1.24.m9.3.3.1.1.1.1.2.cmml" xref="A3.p1.24.m9.3.3.1.1.1"><csymbol cd="ambiguous" id="A3.p1.24.m9.3.3.1.1.1.1.2.1.cmml" xref="A3.p1.24.m9.3.3.1.1.1">superscript</csymbol><ci id="A3.p1.24.m9.3.3.1.1.1.1.2.2.cmml" xref="A3.p1.24.m9.3.3.1.1.1.1.2.2">𝐳</ci><apply id="A3.p1.24.m9.2.2.1.1.1.cmml" xref="A3.p1.24.m9.2.2.1.1"><plus id="A3.p1.24.m9.2.2.1.1.1.1.cmml" xref="A3.p1.24.m9.2.2.1.1.1.1"></plus><ci id="A3.p1.24.m9.2.2.1.1.1.2.cmml" xref="A3.p1.24.m9.2.2.1.1.1.2">𝑙</ci><cn id="A3.p1.24.m9.2.2.1.1.1.3.cmml" type="integer" xref="A3.p1.24.m9.2.2.1.1.1.3">1</cn></apply></apply><ci id="A3.p1.24.m9.3.3.1.1.1.1.3.cmml" xref="A3.p1.24.m9.3.3.1.1.1.1.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.24.m9.3c">\mathbf{h}_{u}^{(l+1)}=\sigma(\mathbf{z}^{(l+1)}_{u})</annotation><annotation encoding="application/x-llamapun" id="A3.p1.24.m9.3d">bold_h start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l + 1 ) end_POSTSUPERSCRIPT = italic_σ ( bold_z start_POSTSUPERSCRIPT ( italic_l + 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT )</annotation></semantics></math>, <math alttext="\mathbf{h}_{p}^{(l+1)}=\sigma(\mathbf{z}^{(l+1)}_{p})" class="ltx_Math" display="inline" id="A3.p1.25.m10.3"><semantics id="A3.p1.25.m10.3a"><mrow id="A3.p1.25.m10.3.3" xref="A3.p1.25.m10.3.3.cmml"><msubsup id="A3.p1.25.m10.3.3.3" xref="A3.p1.25.m10.3.3.3.cmml"><mi id="A3.p1.25.m10.3.3.3.2.2" xref="A3.p1.25.m10.3.3.3.2.2.cmml">𝐡</mi><mi id="A3.p1.25.m10.3.3.3.2.3" xref="A3.p1.25.m10.3.3.3.2.3.cmml">p</mi><mrow id="A3.p1.25.m10.1.1.1.1" xref="A3.p1.25.m10.1.1.1.1.1.cmml"><mo id="A3.p1.25.m10.1.1.1.1.2" stretchy="false" xref="A3.p1.25.m10.1.1.1.1.1.cmml">(</mo><mrow id="A3.p1.25.m10.1.1.1.1.1" xref="A3.p1.25.m10.1.1.1.1.1.cmml"><mi id="A3.p1.25.m10.1.1.1.1.1.2" xref="A3.p1.25.m10.1.1.1.1.1.2.cmml">l</mi><mo id="A3.p1.25.m10.1.1.1.1.1.1" xref="A3.p1.25.m10.1.1.1.1.1.1.cmml">+</mo><mn id="A3.p1.25.m10.1.1.1.1.1.3" xref="A3.p1.25.m10.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A3.p1.25.m10.1.1.1.1.3" stretchy="false" xref="A3.p1.25.m10.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A3.p1.25.m10.3.3.2" xref="A3.p1.25.m10.3.3.2.cmml">=</mo><mrow id="A3.p1.25.m10.3.3.1" xref="A3.p1.25.m10.3.3.1.cmml"><mi id="A3.p1.25.m10.3.3.1.3" xref="A3.p1.25.m10.3.3.1.3.cmml">σ</mi><mo id="A3.p1.25.m10.3.3.1.2" xref="A3.p1.25.m10.3.3.1.2.cmml">⁢</mo><mrow id="A3.p1.25.m10.3.3.1.1.1" xref="A3.p1.25.m10.3.3.1.1.1.1.cmml"><mo id="A3.p1.25.m10.3.3.1.1.1.2" stretchy="false" xref="A3.p1.25.m10.3.3.1.1.1.1.cmml">(</mo><msubsup id="A3.p1.25.m10.3.3.1.1.1.1" xref="A3.p1.25.m10.3.3.1.1.1.1.cmml"><mi id="A3.p1.25.m10.3.3.1.1.1.1.2.2" xref="A3.p1.25.m10.3.3.1.1.1.1.2.2.cmml">𝐳</mi><mi id="A3.p1.25.m10.3.3.1.1.1.1.3" xref="A3.p1.25.m10.3.3.1.1.1.1.3.cmml">p</mi><mrow id="A3.p1.25.m10.2.2.1.1" xref="A3.p1.25.m10.2.2.1.1.1.cmml"><mo id="A3.p1.25.m10.2.2.1.1.2" stretchy="false" xref="A3.p1.25.m10.2.2.1.1.1.cmml">(</mo><mrow id="A3.p1.25.m10.2.2.1.1.1" xref="A3.p1.25.m10.2.2.1.1.1.cmml"><mi id="A3.p1.25.m10.2.2.1.1.1.2" xref="A3.p1.25.m10.2.2.1.1.1.2.cmml">l</mi><mo id="A3.p1.25.m10.2.2.1.1.1.1" xref="A3.p1.25.m10.2.2.1.1.1.1.cmml">+</mo><mn id="A3.p1.25.m10.2.2.1.1.1.3" xref="A3.p1.25.m10.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="A3.p1.25.m10.2.2.1.1.3" stretchy="false" xref="A3.p1.25.m10.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A3.p1.25.m10.3.3.1.1.1.3" stretchy="false" xref="A3.p1.25.m10.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.25.m10.3b"><apply id="A3.p1.25.m10.3.3.cmml" xref="A3.p1.25.m10.3.3"><eq id="A3.p1.25.m10.3.3.2.cmml" xref="A3.p1.25.m10.3.3.2"></eq><apply id="A3.p1.25.m10.3.3.3.cmml" xref="A3.p1.25.m10.3.3.3"><csymbol cd="ambiguous" id="A3.p1.25.m10.3.3.3.1.cmml" xref="A3.p1.25.m10.3.3.3">superscript</csymbol><apply id="A3.p1.25.m10.3.3.3.2.cmml" xref="A3.p1.25.m10.3.3.3"><csymbol cd="ambiguous" id="A3.p1.25.m10.3.3.3.2.1.cmml" xref="A3.p1.25.m10.3.3.3">subscript</csymbol><ci id="A3.p1.25.m10.3.3.3.2.2.cmml" xref="A3.p1.25.m10.3.3.3.2.2">𝐡</ci><ci id="A3.p1.25.m10.3.3.3.2.3.cmml" xref="A3.p1.25.m10.3.3.3.2.3">𝑝</ci></apply><apply id="A3.p1.25.m10.1.1.1.1.1.cmml" xref="A3.p1.25.m10.1.1.1.1"><plus id="A3.p1.25.m10.1.1.1.1.1.1.cmml" xref="A3.p1.25.m10.1.1.1.1.1.1"></plus><ci id="A3.p1.25.m10.1.1.1.1.1.2.cmml" xref="A3.p1.25.m10.1.1.1.1.1.2">𝑙</ci><cn id="A3.p1.25.m10.1.1.1.1.1.3.cmml" type="integer" xref="A3.p1.25.m10.1.1.1.1.1.3">1</cn></apply></apply><apply id="A3.p1.25.m10.3.3.1.cmml" xref="A3.p1.25.m10.3.3.1"><times id="A3.p1.25.m10.3.3.1.2.cmml" xref="A3.p1.25.m10.3.3.1.2"></times><ci id="A3.p1.25.m10.3.3.1.3.cmml" xref="A3.p1.25.m10.3.3.1.3">𝜎</ci><apply id="A3.p1.25.m10.3.3.1.1.1.1.cmml" xref="A3.p1.25.m10.3.3.1.1.1"><csymbol cd="ambiguous" id="A3.p1.25.m10.3.3.1.1.1.1.1.cmml" xref="A3.p1.25.m10.3.3.1.1.1">subscript</csymbol><apply id="A3.p1.25.m10.3.3.1.1.1.1.2.cmml" xref="A3.p1.25.m10.3.3.1.1.1"><csymbol cd="ambiguous" id="A3.p1.25.m10.3.3.1.1.1.1.2.1.cmml" xref="A3.p1.25.m10.3.3.1.1.1">superscript</csymbol><ci id="A3.p1.25.m10.3.3.1.1.1.1.2.2.cmml" xref="A3.p1.25.m10.3.3.1.1.1.1.2.2">𝐳</ci><apply id="A3.p1.25.m10.2.2.1.1.1.cmml" xref="A3.p1.25.m10.2.2.1.1"><plus id="A3.p1.25.m10.2.2.1.1.1.1.cmml" xref="A3.p1.25.m10.2.2.1.1.1.1"></plus><ci id="A3.p1.25.m10.2.2.1.1.1.2.cmml" xref="A3.p1.25.m10.2.2.1.1.1.2">𝑙</ci><cn id="A3.p1.25.m10.2.2.1.1.1.3.cmml" type="integer" xref="A3.p1.25.m10.2.2.1.1.1.3">1</cn></apply></apply><ci id="A3.p1.25.m10.3.3.1.1.1.1.3.cmml" xref="A3.p1.25.m10.3.3.1.1.1.1.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.25.m10.3c">\mathbf{h}_{p}^{(l+1)}=\sigma(\mathbf{z}^{(l+1)}_{p})</annotation><annotation encoding="application/x-llamapun" id="A3.p1.25.m10.3d">bold_h start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l + 1 ) end_POSTSUPERSCRIPT = italic_σ ( bold_z start_POSTSUPERSCRIPT ( italic_l + 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT )</annotation></semantics></math>. While for the item node, its hidden representation of the <math alttext="l{+}1" class="ltx_Math" display="inline" id="A3.p1.26.m11.1"><semantics id="A3.p1.26.m11.1a"><mrow id="A3.p1.26.m11.1.1" xref="A3.p1.26.m11.1.1.cmml"><mi id="A3.p1.26.m11.1.1.2" xref="A3.p1.26.m11.1.1.2.cmml">l</mi><mo id="A3.p1.26.m11.1.1.1" xref="A3.p1.26.m11.1.1.1.cmml">+</mo><mn id="A3.p1.26.m11.1.1.3" xref="A3.p1.26.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.26.m11.1b"><apply id="A3.p1.26.m11.1.1.cmml" xref="A3.p1.26.m11.1.1"><plus id="A3.p1.26.m11.1.1.1.cmml" xref="A3.p1.26.m11.1.1.1"></plus><ci id="A3.p1.26.m11.1.1.2.cmml" xref="A3.p1.26.m11.1.1.2">𝑙</ci><cn id="A3.p1.26.m11.1.1.3.cmml" type="integer" xref="A3.p1.26.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.26.m11.1c">l{+}1</annotation><annotation encoding="application/x-llamapun" id="A3.p1.26.m11.1d">italic_l + 1</annotation></semantics></math>-th layer is obtained by aggregating the information from both its neighbourhood users and attribute values: <math alttext="\mathbf{h}_{v}^{(l+1)}=\sigma((\mathbf{z}^{(l+1)}_{v,\mathcal{N}_{v}\subset%
\mathcal{U}}+\mathbf{z}^{(l+1)}_{v,\mathcal{N}_{v}\subset\mathcal{P}})/2)" class="ltx_Math" display="inline" id="A3.p1.27.m12.8"><semantics id="A3.p1.27.m12.8a"><mrow id="A3.p1.27.m12.8.8" xref="A3.p1.27.m12.8.8.cmml"><msubsup id="A3.p1.27.m12.8.8.3" xref="A3.p1.27.m12.8.8.3.cmml"><mi id="A3.p1.27.m12.8.8.3.2.2" xref="A3.p1.27.m12.8.8.3.2.2.cmml">𝐡</mi><mi id="A3.p1.27.m12.8.8.3.2.3" xref="A3.p1.27.m12.8.8.3.2.3.cmml">v</mi><mrow id="A3.p1.27.m12.1.1.1.1" xref="A3.p1.27.m12.1.1.1.1.1.cmml"><mo id="A3.p1.27.m12.1.1.1.1.2" stretchy="false" xref="A3.p1.27.m12.1.1.1.1.1.cmml">(</mo><mrow id="A3.p1.27.m12.1.1.1.1.1" xref="A3.p1.27.m12.1.1.1.1.1.cmml"><mi id="A3.p1.27.m12.1.1.1.1.1.2" xref="A3.p1.27.m12.1.1.1.1.1.2.cmml">l</mi><mo id="A3.p1.27.m12.1.1.1.1.1.1" xref="A3.p1.27.m12.1.1.1.1.1.1.cmml">+</mo><mn id="A3.p1.27.m12.1.1.1.1.1.3" xref="A3.p1.27.m12.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A3.p1.27.m12.1.1.1.1.3" stretchy="false" xref="A3.p1.27.m12.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A3.p1.27.m12.8.8.2" xref="A3.p1.27.m12.8.8.2.cmml">=</mo><mrow id="A3.p1.27.m12.8.8.1" xref="A3.p1.27.m12.8.8.1.cmml"><mi id="A3.p1.27.m12.8.8.1.3" xref="A3.p1.27.m12.8.8.1.3.cmml">σ</mi><mo id="A3.p1.27.m12.8.8.1.2" xref="A3.p1.27.m12.8.8.1.2.cmml">⁢</mo><mrow id="A3.p1.27.m12.8.8.1.1.1" xref="A3.p1.27.m12.8.8.1.1.1.1.cmml"><mo id="A3.p1.27.m12.8.8.1.1.1.2" stretchy="false" xref="A3.p1.27.m12.8.8.1.1.1.1.cmml">(</mo><mrow id="A3.p1.27.m12.8.8.1.1.1.1" xref="A3.p1.27.m12.8.8.1.1.1.1.cmml"><mrow id="A3.p1.27.m12.8.8.1.1.1.1.1.1" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.cmml"><mo id="A3.p1.27.m12.8.8.1.1.1.1.1.1.2" stretchy="false" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.cmml"><msubsup id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2.cmml"><mi id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2.2.2" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2.2.2.cmml">𝐳</mi><mrow id="A3.p1.27.m12.4.4.2" xref="A3.p1.27.m12.4.4.2.cmml"><mrow id="A3.p1.27.m12.4.4.2.2.1" xref="A3.p1.27.m12.4.4.2.2.2.cmml"><mi id="A3.p1.27.m12.3.3.1.1" xref="A3.p1.27.m12.3.3.1.1.cmml">v</mi><mo id="A3.p1.27.m12.4.4.2.2.1.2" xref="A3.p1.27.m12.4.4.2.2.2.cmml">,</mo><msub id="A3.p1.27.m12.4.4.2.2.1.1" xref="A3.p1.27.m12.4.4.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p1.27.m12.4.4.2.2.1.1.2" xref="A3.p1.27.m12.4.4.2.2.1.1.2.cmml">𝒩</mi><mi id="A3.p1.27.m12.4.4.2.2.1.1.3" xref="A3.p1.27.m12.4.4.2.2.1.1.3.cmml">v</mi></msub></mrow><mo id="A3.p1.27.m12.4.4.2.3" xref="A3.p1.27.m12.4.4.2.3.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="A3.p1.27.m12.4.4.2.4" xref="A3.p1.27.m12.4.4.2.4.cmml">𝒰</mi></mrow><mrow id="A3.p1.27.m12.2.2.1.1" xref="A3.p1.27.m12.2.2.1.1.1.cmml"><mo id="A3.p1.27.m12.2.2.1.1.2" stretchy="false" xref="A3.p1.27.m12.2.2.1.1.1.cmml">(</mo><mrow id="A3.p1.27.m12.2.2.1.1.1" xref="A3.p1.27.m12.2.2.1.1.1.cmml"><mi id="A3.p1.27.m12.2.2.1.1.1.2" xref="A3.p1.27.m12.2.2.1.1.1.2.cmml">l</mi><mo id="A3.p1.27.m12.2.2.1.1.1.1" xref="A3.p1.27.m12.2.2.1.1.1.1.cmml">+</mo><mn id="A3.p1.27.m12.2.2.1.1.1.3" xref="A3.p1.27.m12.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="A3.p1.27.m12.2.2.1.1.3" stretchy="false" xref="A3.p1.27.m12.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.1" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3.cmml"><mi id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3.2.2" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3.2.2.cmml">𝐳</mi><mrow id="A3.p1.27.m12.7.7.2" xref="A3.p1.27.m12.7.7.2.cmml"><mrow id="A3.p1.27.m12.7.7.2.2.1" xref="A3.p1.27.m12.7.7.2.2.2.cmml"><mi id="A3.p1.27.m12.6.6.1.1" xref="A3.p1.27.m12.6.6.1.1.cmml">v</mi><mo id="A3.p1.27.m12.7.7.2.2.1.2" xref="A3.p1.27.m12.7.7.2.2.2.cmml">,</mo><msub id="A3.p1.27.m12.7.7.2.2.1.1" xref="A3.p1.27.m12.7.7.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p1.27.m12.7.7.2.2.1.1.2" xref="A3.p1.27.m12.7.7.2.2.1.1.2.cmml">𝒩</mi><mi id="A3.p1.27.m12.7.7.2.2.1.1.3" xref="A3.p1.27.m12.7.7.2.2.1.1.3.cmml">v</mi></msub></mrow><mo id="A3.p1.27.m12.7.7.2.3" xref="A3.p1.27.m12.7.7.2.3.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="A3.p1.27.m12.7.7.2.4" xref="A3.p1.27.m12.7.7.2.4.cmml">𝒫</mi></mrow><mrow id="A3.p1.27.m12.5.5.1.1" xref="A3.p1.27.m12.5.5.1.1.1.cmml"><mo id="A3.p1.27.m12.5.5.1.1.2" stretchy="false" xref="A3.p1.27.m12.5.5.1.1.1.cmml">(</mo><mrow id="A3.p1.27.m12.5.5.1.1.1" xref="A3.p1.27.m12.5.5.1.1.1.cmml"><mi id="A3.p1.27.m12.5.5.1.1.1.2" xref="A3.p1.27.m12.5.5.1.1.1.2.cmml">l</mi><mo id="A3.p1.27.m12.5.5.1.1.1.1" xref="A3.p1.27.m12.5.5.1.1.1.1.cmml">+</mo><mn id="A3.p1.27.m12.5.5.1.1.1.3" xref="A3.p1.27.m12.5.5.1.1.1.3.cmml">1</mn></mrow><mo id="A3.p1.27.m12.5.5.1.1.3" stretchy="false" xref="A3.p1.27.m12.5.5.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo id="A3.p1.27.m12.8.8.1.1.1.1.1.1.3" stretchy="false" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.p1.27.m12.8.8.1.1.1.1.2" xref="A3.p1.27.m12.8.8.1.1.1.1.2.cmml">/</mo><mn id="A3.p1.27.m12.8.8.1.1.1.1.3" xref="A3.p1.27.m12.8.8.1.1.1.1.3.cmml">2</mn></mrow><mo id="A3.p1.27.m12.8.8.1.1.1.3" stretchy="false" xref="A3.p1.27.m12.8.8.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.27.m12.8b"><apply id="A3.p1.27.m12.8.8.cmml" xref="A3.p1.27.m12.8.8"><eq id="A3.p1.27.m12.8.8.2.cmml" xref="A3.p1.27.m12.8.8.2"></eq><apply id="A3.p1.27.m12.8.8.3.cmml" xref="A3.p1.27.m12.8.8.3"><csymbol cd="ambiguous" id="A3.p1.27.m12.8.8.3.1.cmml" xref="A3.p1.27.m12.8.8.3">superscript</csymbol><apply id="A3.p1.27.m12.8.8.3.2.cmml" xref="A3.p1.27.m12.8.8.3"><csymbol cd="ambiguous" id="A3.p1.27.m12.8.8.3.2.1.cmml" xref="A3.p1.27.m12.8.8.3">subscript</csymbol><ci id="A3.p1.27.m12.8.8.3.2.2.cmml" xref="A3.p1.27.m12.8.8.3.2.2">𝐡</ci><ci id="A3.p1.27.m12.8.8.3.2.3.cmml" xref="A3.p1.27.m12.8.8.3.2.3">𝑣</ci></apply><apply id="A3.p1.27.m12.1.1.1.1.1.cmml" xref="A3.p1.27.m12.1.1.1.1"><plus id="A3.p1.27.m12.1.1.1.1.1.1.cmml" xref="A3.p1.27.m12.1.1.1.1.1.1"></plus><ci id="A3.p1.27.m12.1.1.1.1.1.2.cmml" xref="A3.p1.27.m12.1.1.1.1.1.2">𝑙</ci><cn id="A3.p1.27.m12.1.1.1.1.1.3.cmml" type="integer" xref="A3.p1.27.m12.1.1.1.1.1.3">1</cn></apply></apply><apply id="A3.p1.27.m12.8.8.1.cmml" xref="A3.p1.27.m12.8.8.1"><times id="A3.p1.27.m12.8.8.1.2.cmml" xref="A3.p1.27.m12.8.8.1.2"></times><ci id="A3.p1.27.m12.8.8.1.3.cmml" xref="A3.p1.27.m12.8.8.1.3">𝜎</ci><apply id="A3.p1.27.m12.8.8.1.1.1.1.cmml" xref="A3.p1.27.m12.8.8.1.1.1"><divide id="A3.p1.27.m12.8.8.1.1.1.1.2.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.2"></divide><apply id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1"><plus id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.1.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.1"></plus><apply id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2.1.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2.2.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.2.2.2">𝐳</ci><apply id="A3.p1.27.m12.2.2.1.1.1.cmml" xref="A3.p1.27.m12.2.2.1.1"><plus id="A3.p1.27.m12.2.2.1.1.1.1.cmml" xref="A3.p1.27.m12.2.2.1.1.1.1"></plus><ci id="A3.p1.27.m12.2.2.1.1.1.2.cmml" xref="A3.p1.27.m12.2.2.1.1.1.2">𝑙</ci><cn id="A3.p1.27.m12.2.2.1.1.1.3.cmml" type="integer" xref="A3.p1.27.m12.2.2.1.1.1.3">1</cn></apply></apply><apply id="A3.p1.27.m12.4.4.2.cmml" xref="A3.p1.27.m12.4.4.2"><subset id="A3.p1.27.m12.4.4.2.3.cmml" xref="A3.p1.27.m12.4.4.2.3"></subset><list id="A3.p1.27.m12.4.4.2.2.2.cmml" xref="A3.p1.27.m12.4.4.2.2.1"><ci id="A3.p1.27.m12.3.3.1.1.cmml" xref="A3.p1.27.m12.3.3.1.1">𝑣</ci><apply id="A3.p1.27.m12.4.4.2.2.1.1.cmml" xref="A3.p1.27.m12.4.4.2.2.1.1"><csymbol cd="ambiguous" id="A3.p1.27.m12.4.4.2.2.1.1.1.cmml" xref="A3.p1.27.m12.4.4.2.2.1.1">subscript</csymbol><ci id="A3.p1.27.m12.4.4.2.2.1.1.2.cmml" xref="A3.p1.27.m12.4.4.2.2.1.1.2">𝒩</ci><ci id="A3.p1.27.m12.4.4.2.2.1.1.3.cmml" xref="A3.p1.27.m12.4.4.2.2.1.1.3">𝑣</ci></apply></list><ci id="A3.p1.27.m12.4.4.2.4.cmml" xref="A3.p1.27.m12.4.4.2.4">𝒰</ci></apply></apply><apply id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3.1.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3.2.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3.2.1.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3.2.2.cmml" xref="A3.p1.27.m12.8.8.1.1.1.1.1.1.1.3.2.2">𝐳</ci><apply id="A3.p1.27.m12.5.5.1.1.1.cmml" xref="A3.p1.27.m12.5.5.1.1"><plus id="A3.p1.27.m12.5.5.1.1.1.1.cmml" xref="A3.p1.27.m12.5.5.1.1.1.1"></plus><ci id="A3.p1.27.m12.5.5.1.1.1.2.cmml" xref="A3.p1.27.m12.5.5.1.1.1.2">𝑙</ci><cn id="A3.p1.27.m12.5.5.1.1.1.3.cmml" type="integer" xref="A3.p1.27.m12.5.5.1.1.1.3">1</cn></apply></apply><apply id="A3.p1.27.m12.7.7.2.cmml" xref="A3.p1.27.m12.7.7.2"><subset id="A3.p1.27.m12.7.7.2.3.cmml" xref="A3.p1.27.m12.7.7.2.3"></subset><list id="A3.p1.27.m12.7.7.2.2.2.cmml" xref="A3.p1.27.m12.7.7.2.2.1"><ci id="A3.p1.27.m12.6.6.1.1.cmml" xref="A3.p1.27.m12.6.6.1.1">𝑣</ci><apply id="A3.p1.27.m12.7.7.2.2.1.1.cmml" xref="A3.p1.27.m12.7.7.2.2.1.1"><csymbol cd="ambiguous" id="A3.p1.27.m12.7.7.2.2.1.1.1.cmml" xref="A3.p1.27.m12.7.7.2.2.1.1">subscript</csymbol><ci id="A3.p1.27.m12.7.7.2.2.1.1.2.cmml" xref="A3.p1.27.m12.7.7.2.2.1.1.2">𝒩</ci><ci id="A3.p1.27.m12.7.7.2.2.1.1.3.cmml" xref="A3.p1.27.m12.7.7.2.2.1.1.3">𝑣</ci></apply></list><ci id="A3.p1.27.m12.7.7.2.4.cmml" xref="A3.p1.27.m12.7.7.2.4">𝒫</ci></apply></apply></apply><cn id="A3.p1.27.m12.8.8.1.1.1.1.3.cmml" type="integer" xref="A3.p1.27.m12.8.8.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.27.m12.8c">\mathbf{h}_{v}^{(l+1)}=\sigma((\mathbf{z}^{(l+1)}_{v,\mathcal{N}_{v}\subset%
\mathcal{U}}+\mathbf{z}^{(l+1)}_{v,\mathcal{N}_{v}\subset\mathcal{P}})/2)</annotation><annotation encoding="application/x-llamapun" id="A3.p1.27.m12.8d">bold_h start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l + 1 ) end_POSTSUPERSCRIPT = italic_σ ( ( bold_z start_POSTSUPERSCRIPT ( italic_l + 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v , caligraphic_N start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ⊂ caligraphic_U end_POSTSUBSCRIPT + bold_z start_POSTSUPERSCRIPT ( italic_l + 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v , caligraphic_N start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ⊂ caligraphic_P end_POSTSUBSCRIPT ) / 2 )</annotation></semantics></math>. We stack <math alttext="L_{g}" class="ltx_Math" display="inline" id="A3.p1.28.m13.1"><semantics id="A3.p1.28.m13.1a"><msub id="A3.p1.28.m13.1.1" xref="A3.p1.28.m13.1.1.cmml"><mi id="A3.p1.28.m13.1.1.2" xref="A3.p1.28.m13.1.1.2.cmml">L</mi><mi id="A3.p1.28.m13.1.1.3" xref="A3.p1.28.m13.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.28.m13.1b"><apply id="A3.p1.28.m13.1.1.cmml" xref="A3.p1.28.m13.1.1"><csymbol cd="ambiguous" id="A3.p1.28.m13.1.1.1.cmml" xref="A3.p1.28.m13.1.1">subscript</csymbol><ci id="A3.p1.28.m13.1.1.2.cmml" xref="A3.p1.28.m13.1.1.2">𝐿</ci><ci id="A3.p1.28.m13.1.1.3.cmml" xref="A3.p1.28.m13.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.28.m13.1c">L_{g}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.28.m13.1d">italic_L start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> layers of GATs and fetch the hidden representations <math alttext="\mathbf{h}^{(L_{g})}_{u}" class="ltx_Math" display="inline" id="A3.p1.29.m14.1"><semantics id="A3.p1.29.m14.1a"><msubsup id="A3.p1.29.m14.1.2" xref="A3.p1.29.m14.1.2.cmml"><mi id="A3.p1.29.m14.1.2.2.2" xref="A3.p1.29.m14.1.2.2.2.cmml">𝐡</mi><mi id="A3.p1.29.m14.1.2.3" xref="A3.p1.29.m14.1.2.3.cmml">u</mi><mrow id="A3.p1.29.m14.1.1.1.1" xref="A3.p1.29.m14.1.1.1.1.1.cmml"><mo id="A3.p1.29.m14.1.1.1.1.2" stretchy="false" xref="A3.p1.29.m14.1.1.1.1.1.cmml">(</mo><msub id="A3.p1.29.m14.1.1.1.1.1" xref="A3.p1.29.m14.1.1.1.1.1.cmml"><mi id="A3.p1.29.m14.1.1.1.1.1.2" xref="A3.p1.29.m14.1.1.1.1.1.2.cmml">L</mi><mi id="A3.p1.29.m14.1.1.1.1.1.3" xref="A3.p1.29.m14.1.1.1.1.1.3.cmml">g</mi></msub><mo id="A3.p1.29.m14.1.1.1.1.3" stretchy="false" xref="A3.p1.29.m14.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.p1.29.m14.1b"><apply id="A3.p1.29.m14.1.2.cmml" xref="A3.p1.29.m14.1.2"><csymbol cd="ambiguous" id="A3.p1.29.m14.1.2.1.cmml" xref="A3.p1.29.m14.1.2">subscript</csymbol><apply id="A3.p1.29.m14.1.2.2.cmml" xref="A3.p1.29.m14.1.2"><csymbol cd="ambiguous" id="A3.p1.29.m14.1.2.2.1.cmml" xref="A3.p1.29.m14.1.2">superscript</csymbol><ci id="A3.p1.29.m14.1.2.2.2.cmml" xref="A3.p1.29.m14.1.2.2.2">𝐡</ci><apply id="A3.p1.29.m14.1.1.1.1.1.cmml" xref="A3.p1.29.m14.1.1.1.1"><csymbol cd="ambiguous" id="A3.p1.29.m14.1.1.1.1.1.1.cmml" xref="A3.p1.29.m14.1.1.1.1">subscript</csymbol><ci id="A3.p1.29.m14.1.1.1.1.1.2.cmml" xref="A3.p1.29.m14.1.1.1.1.1.2">𝐿</ci><ci id="A3.p1.29.m14.1.1.1.1.1.3.cmml" xref="A3.p1.29.m14.1.1.1.1.1.3">𝑔</ci></apply></apply><ci id="A3.p1.29.m14.1.2.3.cmml" xref="A3.p1.29.m14.1.2.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.29.m14.1c">\mathbf{h}^{(L_{g})}_{u}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.29.m14.1d">bold_h start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{h}^{(L_{g})}_{v}" class="ltx_Math" display="inline" id="A3.p1.30.m15.1"><semantics id="A3.p1.30.m15.1a"><msubsup id="A3.p1.30.m15.1.2" xref="A3.p1.30.m15.1.2.cmml"><mi id="A3.p1.30.m15.1.2.2.2" xref="A3.p1.30.m15.1.2.2.2.cmml">𝐡</mi><mi id="A3.p1.30.m15.1.2.3" xref="A3.p1.30.m15.1.2.3.cmml">v</mi><mrow id="A3.p1.30.m15.1.1.1.1" xref="A3.p1.30.m15.1.1.1.1.1.cmml"><mo id="A3.p1.30.m15.1.1.1.1.2" stretchy="false" xref="A3.p1.30.m15.1.1.1.1.1.cmml">(</mo><msub id="A3.p1.30.m15.1.1.1.1.1" xref="A3.p1.30.m15.1.1.1.1.1.cmml"><mi id="A3.p1.30.m15.1.1.1.1.1.2" xref="A3.p1.30.m15.1.1.1.1.1.2.cmml">L</mi><mi id="A3.p1.30.m15.1.1.1.1.1.3" xref="A3.p1.30.m15.1.1.1.1.1.3.cmml">g</mi></msub><mo id="A3.p1.30.m15.1.1.1.1.3" stretchy="false" xref="A3.p1.30.m15.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.p1.30.m15.1b"><apply id="A3.p1.30.m15.1.2.cmml" xref="A3.p1.30.m15.1.2"><csymbol cd="ambiguous" id="A3.p1.30.m15.1.2.1.cmml" xref="A3.p1.30.m15.1.2">subscript</csymbol><apply id="A3.p1.30.m15.1.2.2.cmml" xref="A3.p1.30.m15.1.2"><csymbol cd="ambiguous" id="A3.p1.30.m15.1.2.2.1.cmml" xref="A3.p1.30.m15.1.2">superscript</csymbol><ci id="A3.p1.30.m15.1.2.2.2.cmml" xref="A3.p1.30.m15.1.2.2.2">𝐡</ci><apply id="A3.p1.30.m15.1.1.1.1.1.cmml" xref="A3.p1.30.m15.1.1.1.1"><csymbol cd="ambiguous" id="A3.p1.30.m15.1.1.1.1.1.1.cmml" xref="A3.p1.30.m15.1.1.1.1">subscript</csymbol><ci id="A3.p1.30.m15.1.1.1.1.1.2.cmml" xref="A3.p1.30.m15.1.1.1.1.1.2">𝐿</ci><ci id="A3.p1.30.m15.1.1.1.1.1.3.cmml" xref="A3.p1.30.m15.1.1.1.1.1.3">𝑔</ci></apply></apply><ci id="A3.p1.30.m15.1.2.3.cmml" xref="A3.p1.30.m15.1.2.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.30.m15.1c">\mathbf{h}^{(L_{g})}_{v}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.30.m15.1d">bold_h start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{h}^{(L_{g})}_{p}" class="ltx_Math" display="inline" id="A3.p1.31.m16.1"><semantics id="A3.p1.31.m16.1a"><msubsup id="A3.p1.31.m16.1.2" xref="A3.p1.31.m16.1.2.cmml"><mi id="A3.p1.31.m16.1.2.2.2" xref="A3.p1.31.m16.1.2.2.2.cmml">𝐡</mi><mi id="A3.p1.31.m16.1.2.3" xref="A3.p1.31.m16.1.2.3.cmml">p</mi><mrow id="A3.p1.31.m16.1.1.1.1" xref="A3.p1.31.m16.1.1.1.1.1.cmml"><mo id="A3.p1.31.m16.1.1.1.1.2" stretchy="false" xref="A3.p1.31.m16.1.1.1.1.1.cmml">(</mo><msub id="A3.p1.31.m16.1.1.1.1.1" xref="A3.p1.31.m16.1.1.1.1.1.cmml"><mi id="A3.p1.31.m16.1.1.1.1.1.2" xref="A3.p1.31.m16.1.1.1.1.1.2.cmml">L</mi><mi id="A3.p1.31.m16.1.1.1.1.1.3" xref="A3.p1.31.m16.1.1.1.1.1.3.cmml">g</mi></msub><mo id="A3.p1.31.m16.1.1.1.1.3" stretchy="false" xref="A3.p1.31.m16.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.p1.31.m16.1b"><apply id="A3.p1.31.m16.1.2.cmml" xref="A3.p1.31.m16.1.2"><csymbol cd="ambiguous" id="A3.p1.31.m16.1.2.1.cmml" xref="A3.p1.31.m16.1.2">subscript</csymbol><apply id="A3.p1.31.m16.1.2.2.cmml" xref="A3.p1.31.m16.1.2"><csymbol cd="ambiguous" id="A3.p1.31.m16.1.2.2.1.cmml" xref="A3.p1.31.m16.1.2">superscript</csymbol><ci id="A3.p1.31.m16.1.2.2.2.cmml" xref="A3.p1.31.m16.1.2.2.2">𝐡</ci><apply id="A3.p1.31.m16.1.1.1.1.1.cmml" xref="A3.p1.31.m16.1.1.1.1"><csymbol cd="ambiguous" id="A3.p1.31.m16.1.1.1.1.1.1.cmml" xref="A3.p1.31.m16.1.1.1.1">subscript</csymbol><ci id="A3.p1.31.m16.1.1.1.1.1.2.cmml" xref="A3.p1.31.m16.1.1.1.1.1.2">𝐿</ci><ci id="A3.p1.31.m16.1.1.1.1.1.3.cmml" xref="A3.p1.31.m16.1.1.1.1.1.3">𝑔</ci></apply></apply><ci id="A3.p1.31.m16.1.2.3.cmml" xref="A3.p1.31.m16.1.2.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.31.m16.1c">\mathbf{h}^{(L_{g})}_{p}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.31.m16.1d">bold_h start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> at the last layer as the output of the global information graph encoder.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.p2">
<p class="ltx_p" id="A3.p2.6"><span class="ltx_text ltx_font_bold" id="A3.p2.6.1">Positive feedback graph encoder</span> captures the user’s positive feedback on attribute values and their relations with candidate attribute values/items in the conversation history. For each user <math alttext="u" class="ltx_Math" display="inline" id="A3.p2.1.m1.1"><semantics id="A3.p2.1.m1.1a"><mi id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.1b"><ci id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="A3.p2.1.m1.1d">italic_u</annotation></semantics></math>, at the <math alttext="t" class="ltx_Math" display="inline" id="A3.p2.2.m2.1"><semantics id="A3.p2.2.m2.1a"><mi id="A3.p2.2.m2.1.1" xref="A3.p2.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A3.p2.2.m2.1b"><ci id="A3.p2.2.m2.1.1.cmml" xref="A3.p2.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="A3.p2.2.m2.1d">italic_t</annotation></semantics></math>-th conversational turn, we construct a local positive graph <math alttext="\mathcal{G}^{+}_{t}=&lt;(\{u\}\cup\mathcal{P}^{+}_{t}\cup\mathcal{P}^{c}_{t}\cup%
\mathcal{V}^{c}_{t}),\mathcal{E}^{+}_{t}&gt;" class="ltx_math_unparsed" display="inline" id="A3.p2.3.m3.1"><semantics id="A3.p2.3.m3.1a"><mrow id="A3.p2.3.m3.1b"><msubsup id="A3.p2.3.m3.1.2"><mi class="ltx_font_mathcaligraphic" id="A3.p2.3.m3.1.2.2.2">𝒢</mi><mi id="A3.p2.3.m3.1.2.3">t</mi><mo id="A3.p2.3.m3.1.2.2.3">+</mo></msubsup><mo id="A3.p2.3.m3.1.3" rspace="0em">=</mo><mo id="A3.p2.3.m3.1.4" lspace="0em">&lt;</mo><mrow id="A3.p2.3.m3.1.5"><mo id="A3.p2.3.m3.1.5.1" stretchy="false">(</mo><mrow id="A3.p2.3.m3.1.5.2"><mo id="A3.p2.3.m3.1.5.2.1" stretchy="false">{</mo><mi id="A3.p2.3.m3.1.1">u</mi><mo id="A3.p2.3.m3.1.5.2.2" stretchy="false">}</mo></mrow><mo id="A3.p2.3.m3.1.5.3">∪</mo><msubsup id="A3.p2.3.m3.1.5.4"><mi class="ltx_font_mathcaligraphic" id="A3.p2.3.m3.1.5.4.2.2">𝒫</mi><mi id="A3.p2.3.m3.1.5.4.3">t</mi><mo id="A3.p2.3.m3.1.5.4.2.3">+</mo></msubsup><mo id="A3.p2.3.m3.1.5.5">∪</mo><msubsup id="A3.p2.3.m3.1.5.6"><mi class="ltx_font_mathcaligraphic" id="A3.p2.3.m3.1.5.6.2.2">𝒫</mi><mi id="A3.p2.3.m3.1.5.6.3">t</mi><mi id="A3.p2.3.m3.1.5.6.2.3">c</mi></msubsup><mo id="A3.p2.3.m3.1.5.7">∪</mo><msubsup id="A3.p2.3.m3.1.5.8"><mi class="ltx_font_mathcaligraphic" id="A3.p2.3.m3.1.5.8.2.2">𝒱</mi><mi id="A3.p2.3.m3.1.5.8.3">t</mi><mi id="A3.p2.3.m3.1.5.8.2.3">c</mi></msubsup><mo id="A3.p2.3.m3.1.5.9" stretchy="false">)</mo></mrow><mo id="A3.p2.3.m3.1.6">,</mo><msubsup id="A3.p2.3.m3.1.7"><mi class="ltx_font_mathcaligraphic" id="A3.p2.3.m3.1.7.2.2">ℰ</mi><mi id="A3.p2.3.m3.1.7.3">t</mi><mo id="A3.p2.3.m3.1.7.2.3">+</mo></msubsup><mo id="A3.p2.3.m3.1.8">&gt;</mo></mrow><annotation encoding="application/x-tex" id="A3.p2.3.m3.1c">\mathcal{G}^{+}_{t}=&lt;(\{u\}\cup\mathcal{P}^{+}_{t}\cup\mathcal{P}^{c}_{t}\cup%
\mathcal{V}^{c}_{t}),\mathcal{E}^{+}_{t}&gt;</annotation><annotation encoding="application/x-llamapun" id="A3.p2.3.m3.1d">caligraphic_G start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = &lt; ( { italic_u } ∪ caligraphic_P start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∪ caligraphic_P start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∪ caligraphic_V start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) , caligraphic_E start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT &gt;</annotation></semantics></math>, where the weight of the edge <math alttext="\mathcal{E}^{+}_{t}(i,j)" class="ltx_Math" display="inline" id="A3.p2.4.m4.2"><semantics id="A3.p2.4.m4.2a"><mrow id="A3.p2.4.m4.2.3" xref="A3.p2.4.m4.2.3.cmml"><msubsup id="A3.p2.4.m4.2.3.2" xref="A3.p2.4.m4.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p2.4.m4.2.3.2.2.2" xref="A3.p2.4.m4.2.3.2.2.2.cmml">ℰ</mi><mi id="A3.p2.4.m4.2.3.2.3" xref="A3.p2.4.m4.2.3.2.3.cmml">t</mi><mo id="A3.p2.4.m4.2.3.2.2.3" xref="A3.p2.4.m4.2.3.2.2.3.cmml">+</mo></msubsup><mo id="A3.p2.4.m4.2.3.1" xref="A3.p2.4.m4.2.3.1.cmml">⁢</mo><mrow id="A3.p2.4.m4.2.3.3.2" xref="A3.p2.4.m4.2.3.3.1.cmml"><mo id="A3.p2.4.m4.2.3.3.2.1" stretchy="false" xref="A3.p2.4.m4.2.3.3.1.cmml">(</mo><mi id="A3.p2.4.m4.1.1" xref="A3.p2.4.m4.1.1.cmml">i</mi><mo id="A3.p2.4.m4.2.3.3.2.2" xref="A3.p2.4.m4.2.3.3.1.cmml">,</mo><mi id="A3.p2.4.m4.2.2" xref="A3.p2.4.m4.2.2.cmml">j</mi><mo id="A3.p2.4.m4.2.3.3.2.3" stretchy="false" xref="A3.p2.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.4.m4.2b"><apply id="A3.p2.4.m4.2.3.cmml" xref="A3.p2.4.m4.2.3"><times id="A3.p2.4.m4.2.3.1.cmml" xref="A3.p2.4.m4.2.3.1"></times><apply id="A3.p2.4.m4.2.3.2.cmml" xref="A3.p2.4.m4.2.3.2"><csymbol cd="ambiguous" id="A3.p2.4.m4.2.3.2.1.cmml" xref="A3.p2.4.m4.2.3.2">subscript</csymbol><apply id="A3.p2.4.m4.2.3.2.2.cmml" xref="A3.p2.4.m4.2.3.2"><csymbol cd="ambiguous" id="A3.p2.4.m4.2.3.2.2.1.cmml" xref="A3.p2.4.m4.2.3.2">superscript</csymbol><ci id="A3.p2.4.m4.2.3.2.2.2.cmml" xref="A3.p2.4.m4.2.3.2.2.2">ℰ</ci><plus id="A3.p2.4.m4.2.3.2.2.3.cmml" xref="A3.p2.4.m4.2.3.2.2.3"></plus></apply><ci id="A3.p2.4.m4.2.3.2.3.cmml" xref="A3.p2.4.m4.2.3.2.3">𝑡</ci></apply><interval closure="open" id="A3.p2.4.m4.2.3.3.1.cmml" xref="A3.p2.4.m4.2.3.3.2"><ci id="A3.p2.4.m4.1.1.cmml" xref="A3.p2.4.m4.1.1">𝑖</ci><ci id="A3.p2.4.m4.2.2.cmml" xref="A3.p2.4.m4.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.4.m4.2c">\mathcal{E}^{+}_{t}(i,j)</annotation><annotation encoding="application/x-llamapun" id="A3.p2.4.m4.2d">caligraphic_E start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_i , italic_j )</annotation></semantics></math> between node <math alttext="i" class="ltx_Math" display="inline" id="A3.p2.5.m5.1"><semantics id="A3.p2.5.m5.1a"><mi id="A3.p2.5.m5.1.1" xref="A3.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A3.p2.5.m5.1b"><ci id="A3.p2.5.m5.1.1.cmml" xref="A3.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="A3.p2.5.m5.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="A3.p2.6.m6.1"><semantics id="A3.p2.6.m6.1a"><mi id="A3.p2.6.m6.1.1" xref="A3.p2.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A3.p2.6.m6.1b"><ci id="A3.p2.6.m6.1.1.cmml" xref="A3.p2.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.6.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="A3.p2.6.m6.1d">italic_j</annotation></semantics></math> is constructed from the following rules:</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{E}^{+}_{t}(i,j)=\left\{\begin{array}[]{ll}w^{(t)}_{v},&amp;\mathrm{if}%
\quad i\in\mathcal{U},j\in\mathcal{V}\\
1,&amp;\mathrm{if}\quad i\in\mathcal{V},j\in\mathcal{P}\\
1,&amp;\mathrm{if}\quad i\in\mathcal{U},j\in\mathcal{P}^{+}_{t}\\
0,&amp;\mathrm{otherwise}\end{array}\right.," class="ltx_Math" display="block" id="A3.E13.m1.20"><semantics id="A3.E13.m1.20a"><mrow id="A3.E13.m1.20.20.1" xref="A3.E13.m1.20.20.1.1.cmml"><mrow id="A3.E13.m1.20.20.1.1" xref="A3.E13.m1.20.20.1.1.cmml"><mrow id="A3.E13.m1.20.20.1.1.2" xref="A3.E13.m1.20.20.1.1.2.cmml"><msubsup id="A3.E13.m1.20.20.1.1.2.2" xref="A3.E13.m1.20.20.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E13.m1.20.20.1.1.2.2.2.2" xref="A3.E13.m1.20.20.1.1.2.2.2.2.cmml">ℰ</mi><mi id="A3.E13.m1.20.20.1.1.2.2.3" xref="A3.E13.m1.20.20.1.1.2.2.3.cmml">t</mi><mo id="A3.E13.m1.20.20.1.1.2.2.2.3" xref="A3.E13.m1.20.20.1.1.2.2.2.3.cmml">+</mo></msubsup><mo id="A3.E13.m1.20.20.1.1.2.1" xref="A3.E13.m1.20.20.1.1.2.1.cmml">⁢</mo><mrow id="A3.E13.m1.20.20.1.1.2.3.2" xref="A3.E13.m1.20.20.1.1.2.3.1.cmml"><mo id="A3.E13.m1.20.20.1.1.2.3.2.1" stretchy="false" xref="A3.E13.m1.20.20.1.1.2.3.1.cmml">(</mo><mi id="A3.E13.m1.18.18" xref="A3.E13.m1.18.18.cmml">i</mi><mo id="A3.E13.m1.20.20.1.1.2.3.2.2" xref="A3.E13.m1.20.20.1.1.2.3.1.cmml">,</mo><mi id="A3.E13.m1.19.19" xref="A3.E13.m1.19.19.cmml">j</mi><mo id="A3.E13.m1.20.20.1.1.2.3.2.3" stretchy="false" xref="A3.E13.m1.20.20.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A3.E13.m1.20.20.1.1.1" xref="A3.E13.m1.20.20.1.1.1.cmml">=</mo><mrow id="A3.E13.m1.20.20.1.1.3.2" xref="A3.E13.m1.20.20.1.1.3.1.cmml"><mo id="A3.E13.m1.20.20.1.1.3.2.1" xref="A3.E13.m1.20.20.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="A3.E13.m1.17.17" rowspacing="-3.0pt" xref="A3.E13.m1.17.17.cmml"><mtr id="A3.E13.m1.17.17a" xref="A3.E13.m1.17.17.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E13.m1.17.17b" xref="A3.E13.m1.17.17.cmml"><mrow id="A3.E13.m1.2.2.2.2.2.2" xref="A3.E13.m1.2.2.2.2.2.2.1.cmml"><msubsup id="A3.E13.m1.2.2.2.2.2.2.1" xref="A3.E13.m1.2.2.2.2.2.2.1.cmml"><mi id="A3.E13.m1.2.2.2.2.2.2.1.2.2" xref="A3.E13.m1.2.2.2.2.2.2.1.2.2.cmml">w</mi><mi id="A3.E13.m1.2.2.2.2.2.2.1.3" xref="A3.E13.m1.2.2.2.2.2.2.1.3.cmml">v</mi><mrow id="A3.E13.m1.1.1.1.1.1.1.1.3" xref="A3.E13.m1.2.2.2.2.2.2.1.cmml"><mo id="A3.E13.m1.1.1.1.1.1.1.1.3.1" stretchy="false" xref="A3.E13.m1.2.2.2.2.2.2.1.cmml">(</mo><mi id="A3.E13.m1.1.1.1.1.1.1.1.1" xref="A3.E13.m1.1.1.1.1.1.1.1.1.cmml">t</mi><mo id="A3.E13.m1.1.1.1.1.1.1.1.3.2" stretchy="false" xref="A3.E13.m1.2.2.2.2.2.2.1.cmml">)</mo></mrow></msubsup><mo id="A3.E13.m1.2.2.2.2.2.2.2" xref="A3.E13.m1.2.2.2.2.2.2.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A3.E13.m1.17.17c" xref="A3.E13.m1.17.17.cmml"><mrow id="A3.E13.m1.6.6.6.6.4.4" xref="A3.E13.m1.6.6.6.6.4.5.cmml"><mrow id="A3.E13.m1.5.5.5.5.3.3.1" xref="A3.E13.m1.5.5.5.5.3.3.1.cmml"><mrow id="A3.E13.m1.5.5.5.5.3.3.1.2.2" xref="A3.E13.m1.5.5.5.5.3.3.1.2.1.cmml"><mi id="A3.E13.m1.3.3.3.3.1.1" xref="A3.E13.m1.3.3.3.3.1.1.cmml">if</mi><mspace id="A3.E13.m1.5.5.5.5.3.3.1.2.2.1" width="1em" xref="A3.E13.m1.5.5.5.5.3.3.1.2.1.cmml"></mspace><mi id="A3.E13.m1.4.4.4.4.2.2" xref="A3.E13.m1.4.4.4.4.2.2.cmml">i</mi></mrow><mo id="A3.E13.m1.5.5.5.5.3.3.1.1" xref="A3.E13.m1.5.5.5.5.3.3.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E13.m1.5.5.5.5.3.3.1.3" xref="A3.E13.m1.5.5.5.5.3.3.1.3.cmml">𝒰</mi></mrow><mo id="A3.E13.m1.6.6.6.6.4.4.3" xref="A3.E13.m1.6.6.6.6.4.5a.cmml">,</mo><mrow id="A3.E13.m1.6.6.6.6.4.4.2" xref="A3.E13.m1.6.6.6.6.4.4.2.cmml"><mi id="A3.E13.m1.6.6.6.6.4.4.2.2" xref="A3.E13.m1.6.6.6.6.4.4.2.2.cmml">j</mi><mo id="A3.E13.m1.6.6.6.6.4.4.2.1" xref="A3.E13.m1.6.6.6.6.4.4.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E13.m1.6.6.6.6.4.4.2.3" xref="A3.E13.m1.6.6.6.6.4.4.2.3.cmml">𝒱</mi></mrow></mrow></mtd></mtr><mtr id="A3.E13.m1.17.17d" xref="A3.E13.m1.17.17.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E13.m1.17.17e" xref="A3.E13.m1.17.17.cmml"><mrow id="A3.E13.m1.7.7.7.1.1.3" xref="A3.E13.m1.17.17.cmml"><mn id="A3.E13.m1.7.7.7.1.1.1" xref="A3.E13.m1.7.7.7.1.1.1.cmml">1</mn><mo id="A3.E13.m1.7.7.7.1.1.3.1" xref="A3.E13.m1.17.17.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A3.E13.m1.17.17f" xref="A3.E13.m1.17.17.cmml"><mrow id="A3.E13.m1.11.11.11.5.4.4" xref="A3.E13.m1.11.11.11.5.4.5.cmml"><mrow id="A3.E13.m1.10.10.10.4.3.3.1" xref="A3.E13.m1.10.10.10.4.3.3.1.cmml"><mrow id="A3.E13.m1.10.10.10.4.3.3.1.2.2" xref="A3.E13.m1.10.10.10.4.3.3.1.2.1.cmml"><mi id="A3.E13.m1.8.8.8.2.1.1" xref="A3.E13.m1.8.8.8.2.1.1.cmml">if</mi><mspace id="A3.E13.m1.10.10.10.4.3.3.1.2.2.1" width="1em" xref="A3.E13.m1.10.10.10.4.3.3.1.2.1.cmml"></mspace><mi id="A3.E13.m1.9.9.9.3.2.2" xref="A3.E13.m1.9.9.9.3.2.2.cmml">i</mi></mrow><mo id="A3.E13.m1.10.10.10.4.3.3.1.1" xref="A3.E13.m1.10.10.10.4.3.3.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E13.m1.10.10.10.4.3.3.1.3" xref="A3.E13.m1.10.10.10.4.3.3.1.3.cmml">𝒱</mi></mrow><mo id="A3.E13.m1.11.11.11.5.4.4.3" xref="A3.E13.m1.11.11.11.5.4.5a.cmml">,</mo><mrow id="A3.E13.m1.11.11.11.5.4.4.2" xref="A3.E13.m1.11.11.11.5.4.4.2.cmml"><mi id="A3.E13.m1.11.11.11.5.4.4.2.2" xref="A3.E13.m1.11.11.11.5.4.4.2.2.cmml">j</mi><mo id="A3.E13.m1.11.11.11.5.4.4.2.1" xref="A3.E13.m1.11.11.11.5.4.4.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E13.m1.11.11.11.5.4.4.2.3" xref="A3.E13.m1.11.11.11.5.4.4.2.3.cmml">𝒫</mi></mrow></mrow></mtd></mtr><mtr id="A3.E13.m1.17.17g" xref="A3.E13.m1.17.17.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E13.m1.17.17h" xref="A3.E13.m1.17.17.cmml"><mrow id="A3.E13.m1.12.12.12.1.1.3" xref="A3.E13.m1.17.17.cmml"><mn id="A3.E13.m1.12.12.12.1.1.1" xref="A3.E13.m1.12.12.12.1.1.1.cmml">1</mn><mo id="A3.E13.m1.12.12.12.1.1.3.1" xref="A3.E13.m1.17.17.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A3.E13.m1.17.17i" xref="A3.E13.m1.17.17.cmml"><mrow id="A3.E13.m1.16.16.16.5.4.4" xref="A3.E13.m1.16.16.16.5.4.5.cmml"><mrow id="A3.E13.m1.15.15.15.4.3.3.1" xref="A3.E13.m1.15.15.15.4.3.3.1.cmml"><mrow id="A3.E13.m1.15.15.15.4.3.3.1.2.2" xref="A3.E13.m1.15.15.15.4.3.3.1.2.1.cmml"><mi id="A3.E13.m1.13.13.13.2.1.1" xref="A3.E13.m1.13.13.13.2.1.1.cmml">if</mi><mspace id="A3.E13.m1.15.15.15.4.3.3.1.2.2.1" width="1em" xref="A3.E13.m1.15.15.15.4.3.3.1.2.1.cmml"></mspace><mi id="A3.E13.m1.14.14.14.3.2.2" xref="A3.E13.m1.14.14.14.3.2.2.cmml">i</mi></mrow><mo id="A3.E13.m1.15.15.15.4.3.3.1.1" xref="A3.E13.m1.15.15.15.4.3.3.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E13.m1.15.15.15.4.3.3.1.3" xref="A3.E13.m1.15.15.15.4.3.3.1.3.cmml">𝒰</mi></mrow><mo id="A3.E13.m1.16.16.16.5.4.4.3" xref="A3.E13.m1.16.16.16.5.4.5a.cmml">,</mo><mrow id="A3.E13.m1.16.16.16.5.4.4.2" xref="A3.E13.m1.16.16.16.5.4.4.2.cmml"><mi id="A3.E13.m1.16.16.16.5.4.4.2.2" xref="A3.E13.m1.16.16.16.5.4.4.2.2.cmml">j</mi><mo id="A3.E13.m1.16.16.16.5.4.4.2.1" xref="A3.E13.m1.16.16.16.5.4.4.2.1.cmml">∈</mo><msubsup id="A3.E13.m1.16.16.16.5.4.4.2.3" xref="A3.E13.m1.16.16.16.5.4.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E13.m1.16.16.16.5.4.4.2.3.2.2" xref="A3.E13.m1.16.16.16.5.4.4.2.3.2.2.cmml">𝒫</mi><mi id="A3.E13.m1.16.16.16.5.4.4.2.3.3" xref="A3.E13.m1.16.16.16.5.4.4.2.3.3.cmml">t</mi><mo id="A3.E13.m1.16.16.16.5.4.4.2.3.2.3" xref="A3.E13.m1.16.16.16.5.4.4.2.3.2.3.cmml">+</mo></msubsup></mrow></mrow></mtd></mtr><mtr id="A3.E13.m1.17.17j" xref="A3.E13.m1.17.17.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E13.m1.17.17k" xref="A3.E13.m1.17.17.cmml"><mrow id="A3.E13.m1.17.17.17.1.1.3" xref="A3.E13.m1.17.17.cmml"><mn id="A3.E13.m1.17.17.17.1.1.1" xref="A3.E13.m1.17.17.17.1.1.1.cmml">0</mn><mo id="A3.E13.m1.17.17.17.1.1.3.1" xref="A3.E13.m1.17.17.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A3.E13.m1.17.17l" xref="A3.E13.m1.17.17.cmml"><mi id="A3.E13.m1.17.17.17.2.1" xref="A3.E13.m1.17.17.17.2.1.cmml">otherwise</mi></mtd></mtr></mtable><mi id="A3.E13.m1.20.20.1.1.3.2.2" xref="A3.E13.m1.20.20.1.1.3.1.1.cmml"></mi></mrow></mrow><mo id="A3.E13.m1.20.20.1.2" xref="A3.E13.m1.20.20.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E13.m1.20b"><apply id="A3.E13.m1.20.20.1.1.cmml" xref="A3.E13.m1.20.20.1"><eq id="A3.E13.m1.20.20.1.1.1.cmml" xref="A3.E13.m1.20.20.1.1.1"></eq><apply id="A3.E13.m1.20.20.1.1.2.cmml" xref="A3.E13.m1.20.20.1.1.2"><times id="A3.E13.m1.20.20.1.1.2.1.cmml" xref="A3.E13.m1.20.20.1.1.2.1"></times><apply id="A3.E13.m1.20.20.1.1.2.2.cmml" xref="A3.E13.m1.20.20.1.1.2.2"><csymbol cd="ambiguous" id="A3.E13.m1.20.20.1.1.2.2.1.cmml" xref="A3.E13.m1.20.20.1.1.2.2">subscript</csymbol><apply id="A3.E13.m1.20.20.1.1.2.2.2.cmml" xref="A3.E13.m1.20.20.1.1.2.2"><csymbol cd="ambiguous" id="A3.E13.m1.20.20.1.1.2.2.2.1.cmml" xref="A3.E13.m1.20.20.1.1.2.2">superscript</csymbol><ci id="A3.E13.m1.20.20.1.1.2.2.2.2.cmml" xref="A3.E13.m1.20.20.1.1.2.2.2.2">ℰ</ci><plus id="A3.E13.m1.20.20.1.1.2.2.2.3.cmml" xref="A3.E13.m1.20.20.1.1.2.2.2.3"></plus></apply><ci id="A3.E13.m1.20.20.1.1.2.2.3.cmml" xref="A3.E13.m1.20.20.1.1.2.2.3">𝑡</ci></apply><interval closure="open" id="A3.E13.m1.20.20.1.1.2.3.1.cmml" xref="A3.E13.m1.20.20.1.1.2.3.2"><ci id="A3.E13.m1.18.18.cmml" xref="A3.E13.m1.18.18">𝑖</ci><ci id="A3.E13.m1.19.19.cmml" xref="A3.E13.m1.19.19">𝑗</ci></interval></apply><apply id="A3.E13.m1.20.20.1.1.3.1.cmml" xref="A3.E13.m1.20.20.1.1.3.2"><csymbol cd="latexml" id="A3.E13.m1.20.20.1.1.3.1.1.cmml" xref="A3.E13.m1.20.20.1.1.3.2.1">cases</csymbol><matrix id="A3.E13.m1.17.17.cmml" xref="A3.E13.m1.17.17"><matrixrow id="A3.E13.m1.17.17a.cmml" xref="A3.E13.m1.17.17"><apply id="A3.E13.m1.2.2.2.2.2.2.1.cmml" xref="A3.E13.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E13.m1.2.2.2.2.2.2.1.1.cmml" xref="A3.E13.m1.2.2.2.2.2.2">subscript</csymbol><apply id="A3.E13.m1.2.2.2.2.2.2.1.2.cmml" xref="A3.E13.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E13.m1.2.2.2.2.2.2.1.2.1.cmml" xref="A3.E13.m1.2.2.2.2.2.2">superscript</csymbol><ci id="A3.E13.m1.2.2.2.2.2.2.1.2.2.cmml" xref="A3.E13.m1.2.2.2.2.2.2.1.2.2">𝑤</ci><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1">𝑡</ci></apply><ci id="A3.E13.m1.2.2.2.2.2.2.1.3.cmml" xref="A3.E13.m1.2.2.2.2.2.2.1.3">𝑣</ci></apply><apply id="A3.E13.m1.6.6.6.6.4.5.cmml" xref="A3.E13.m1.6.6.6.6.4.4"><csymbol cd="ambiguous" id="A3.E13.m1.6.6.6.6.4.5a.cmml" xref="A3.E13.m1.6.6.6.6.4.4.3">formulae-sequence</csymbol><apply id="A3.E13.m1.5.5.5.5.3.3.1.cmml" xref="A3.E13.m1.5.5.5.5.3.3.1"><in id="A3.E13.m1.5.5.5.5.3.3.1.1.cmml" xref="A3.E13.m1.5.5.5.5.3.3.1.1"></in><list id="A3.E13.m1.5.5.5.5.3.3.1.2.1.cmml" xref="A3.E13.m1.5.5.5.5.3.3.1.2.2"><ci id="A3.E13.m1.3.3.3.3.1.1.cmml" xref="A3.E13.m1.3.3.3.3.1.1">if</ci><ci id="A3.E13.m1.4.4.4.4.2.2.cmml" xref="A3.E13.m1.4.4.4.4.2.2">𝑖</ci></list><ci id="A3.E13.m1.5.5.5.5.3.3.1.3.cmml" xref="A3.E13.m1.5.5.5.5.3.3.1.3">𝒰</ci></apply><apply id="A3.E13.m1.6.6.6.6.4.4.2.cmml" xref="A3.E13.m1.6.6.6.6.4.4.2"><in id="A3.E13.m1.6.6.6.6.4.4.2.1.cmml" xref="A3.E13.m1.6.6.6.6.4.4.2.1"></in><ci id="A3.E13.m1.6.6.6.6.4.4.2.2.cmml" xref="A3.E13.m1.6.6.6.6.4.4.2.2">𝑗</ci><ci id="A3.E13.m1.6.6.6.6.4.4.2.3.cmml" xref="A3.E13.m1.6.6.6.6.4.4.2.3">𝒱</ci></apply></apply></matrixrow><matrixrow id="A3.E13.m1.17.17b.cmml" xref="A3.E13.m1.17.17"><cn id="A3.E13.m1.7.7.7.1.1.1.cmml" type="integer" xref="A3.E13.m1.7.7.7.1.1.1">1</cn><apply id="A3.E13.m1.11.11.11.5.4.5.cmml" xref="A3.E13.m1.11.11.11.5.4.4"><csymbol cd="ambiguous" id="A3.E13.m1.11.11.11.5.4.5a.cmml" xref="A3.E13.m1.11.11.11.5.4.4.3">formulae-sequence</csymbol><apply id="A3.E13.m1.10.10.10.4.3.3.1.cmml" xref="A3.E13.m1.10.10.10.4.3.3.1"><in id="A3.E13.m1.10.10.10.4.3.3.1.1.cmml" xref="A3.E13.m1.10.10.10.4.3.3.1.1"></in><list id="A3.E13.m1.10.10.10.4.3.3.1.2.1.cmml" xref="A3.E13.m1.10.10.10.4.3.3.1.2.2"><ci id="A3.E13.m1.8.8.8.2.1.1.cmml" xref="A3.E13.m1.8.8.8.2.1.1">if</ci><ci id="A3.E13.m1.9.9.9.3.2.2.cmml" xref="A3.E13.m1.9.9.9.3.2.2">𝑖</ci></list><ci id="A3.E13.m1.10.10.10.4.3.3.1.3.cmml" xref="A3.E13.m1.10.10.10.4.3.3.1.3">𝒱</ci></apply><apply id="A3.E13.m1.11.11.11.5.4.4.2.cmml" xref="A3.E13.m1.11.11.11.5.4.4.2"><in id="A3.E13.m1.11.11.11.5.4.4.2.1.cmml" xref="A3.E13.m1.11.11.11.5.4.4.2.1"></in><ci id="A3.E13.m1.11.11.11.5.4.4.2.2.cmml" xref="A3.E13.m1.11.11.11.5.4.4.2.2">𝑗</ci><ci id="A3.E13.m1.11.11.11.5.4.4.2.3.cmml" xref="A3.E13.m1.11.11.11.5.4.4.2.3">𝒫</ci></apply></apply></matrixrow><matrixrow id="A3.E13.m1.17.17c.cmml" xref="A3.E13.m1.17.17"><cn id="A3.E13.m1.12.12.12.1.1.1.cmml" type="integer" xref="A3.E13.m1.12.12.12.1.1.1">1</cn><apply id="A3.E13.m1.16.16.16.5.4.5.cmml" xref="A3.E13.m1.16.16.16.5.4.4"><csymbol cd="ambiguous" id="A3.E13.m1.16.16.16.5.4.5a.cmml" xref="A3.E13.m1.16.16.16.5.4.4.3">formulae-sequence</csymbol><apply id="A3.E13.m1.15.15.15.4.3.3.1.cmml" xref="A3.E13.m1.15.15.15.4.3.3.1"><in id="A3.E13.m1.15.15.15.4.3.3.1.1.cmml" xref="A3.E13.m1.15.15.15.4.3.3.1.1"></in><list id="A3.E13.m1.15.15.15.4.3.3.1.2.1.cmml" xref="A3.E13.m1.15.15.15.4.3.3.1.2.2"><ci id="A3.E13.m1.13.13.13.2.1.1.cmml" xref="A3.E13.m1.13.13.13.2.1.1">if</ci><ci id="A3.E13.m1.14.14.14.3.2.2.cmml" xref="A3.E13.m1.14.14.14.3.2.2">𝑖</ci></list><ci id="A3.E13.m1.15.15.15.4.3.3.1.3.cmml" xref="A3.E13.m1.15.15.15.4.3.3.1.3">𝒰</ci></apply><apply id="A3.E13.m1.16.16.16.5.4.4.2.cmml" xref="A3.E13.m1.16.16.16.5.4.4.2"><in id="A3.E13.m1.16.16.16.5.4.4.2.1.cmml" xref="A3.E13.m1.16.16.16.5.4.4.2.1"></in><ci id="A3.E13.m1.16.16.16.5.4.4.2.2.cmml" xref="A3.E13.m1.16.16.16.5.4.4.2.2">𝑗</ci><apply id="A3.E13.m1.16.16.16.5.4.4.2.3.cmml" xref="A3.E13.m1.16.16.16.5.4.4.2.3"><csymbol cd="ambiguous" id="A3.E13.m1.16.16.16.5.4.4.2.3.1.cmml" xref="A3.E13.m1.16.16.16.5.4.4.2.3">subscript</csymbol><apply id="A3.E13.m1.16.16.16.5.4.4.2.3.2.cmml" xref="A3.E13.m1.16.16.16.5.4.4.2.3"><csymbol cd="ambiguous" id="A3.E13.m1.16.16.16.5.4.4.2.3.2.1.cmml" xref="A3.E13.m1.16.16.16.5.4.4.2.3">superscript</csymbol><ci id="A3.E13.m1.16.16.16.5.4.4.2.3.2.2.cmml" xref="A3.E13.m1.16.16.16.5.4.4.2.3.2.2">𝒫</ci><plus id="A3.E13.m1.16.16.16.5.4.4.2.3.2.3.cmml" xref="A3.E13.m1.16.16.16.5.4.4.2.3.2.3"></plus></apply><ci id="A3.E13.m1.16.16.16.5.4.4.2.3.3.cmml" xref="A3.E13.m1.16.16.16.5.4.4.2.3.3">𝑡</ci></apply></apply></apply></matrixrow><matrixrow id="A3.E13.m1.17.17d.cmml" xref="A3.E13.m1.17.17"><cn id="A3.E13.m1.17.17.17.1.1.1.cmml" type="integer" xref="A3.E13.m1.17.17.17.1.1.1">0</cn><ci id="A3.E13.m1.17.17.17.2.1.cmml" xref="A3.E13.m1.17.17.17.2.1">otherwise</ci></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E13.m1.20c">\mathcal{E}^{+}_{t}(i,j)=\left\{\begin{array}[]{ll}w^{(t)}_{v},&amp;\mathrm{if}%
\quad i\in\mathcal{U},j\in\mathcal{V}\\
1,&amp;\mathrm{if}\quad i\in\mathcal{V},j\in\mathcal{P}\\
1,&amp;\mathrm{if}\quad i\in\mathcal{U},j\in\mathcal{P}^{+}_{t}\\
0,&amp;\mathrm{otherwise}\end{array}\right.,</annotation><annotation encoding="application/x-llamapun" id="A3.E13.m1.20d">caligraphic_E start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_i , italic_j ) = { start_ARRAY start_ROW start_CELL italic_w start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , end_CELL start_CELL roman_if italic_i ∈ caligraphic_U , italic_j ∈ caligraphic_V end_CELL end_ROW start_ROW start_CELL 1 , end_CELL start_CELL roman_if italic_i ∈ caligraphic_V , italic_j ∈ caligraphic_P end_CELL end_ROW start_ROW start_CELL 1 , end_CELL start_CELL roman_if italic_i ∈ caligraphic_U , italic_j ∈ caligraphic_P start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL 0 , end_CELL start_CELL roman_otherwise end_CELL end_ROW end_ARRAY ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p2.13">where <math alttext="w^{(t)}_{v}=\mathrm{sigmoid}(\mathbf{e}^{\top}_{u}\mathbf{e}_{v}+\sum_{p\in%
\mathcal{P}^{+}_{t}}\mathbf{e}^{\top}_{v}\mathbf{e}_{p}-\sum_{p\in\mathcal{P}^%
{-}_{t}}\mathbf{e}^{\top}_{v}\mathbf{e}_{p})" class="ltx_Math" display="inline" id="A3.p2.7.m1.2"><semantics id="A3.p2.7.m1.2a"><mrow id="A3.p2.7.m1.2.2" xref="A3.p2.7.m1.2.2.cmml"><msubsup id="A3.p2.7.m1.2.2.3" xref="A3.p2.7.m1.2.2.3.cmml"><mi id="A3.p2.7.m1.2.2.3.2.2" xref="A3.p2.7.m1.2.2.3.2.2.cmml">w</mi><mi id="A3.p2.7.m1.2.2.3.3" xref="A3.p2.7.m1.2.2.3.3.cmml">v</mi><mrow id="A3.p2.7.m1.1.1.1.3" xref="A3.p2.7.m1.2.2.3.cmml"><mo id="A3.p2.7.m1.1.1.1.3.1" stretchy="false" xref="A3.p2.7.m1.2.2.3.cmml">(</mo><mi id="A3.p2.7.m1.1.1.1.1" xref="A3.p2.7.m1.1.1.1.1.cmml">t</mi><mo id="A3.p2.7.m1.1.1.1.3.2" stretchy="false" xref="A3.p2.7.m1.2.2.3.cmml">)</mo></mrow></msubsup><mo id="A3.p2.7.m1.2.2.2" xref="A3.p2.7.m1.2.2.2.cmml">=</mo><mrow id="A3.p2.7.m1.2.2.1" xref="A3.p2.7.m1.2.2.1.cmml"><mi id="A3.p2.7.m1.2.2.1.3" xref="A3.p2.7.m1.2.2.1.3.cmml">sigmoid</mi><mo id="A3.p2.7.m1.2.2.1.2" xref="A3.p2.7.m1.2.2.1.2.cmml">⁢</mo><mrow id="A3.p2.7.m1.2.2.1.1.1" xref="A3.p2.7.m1.2.2.1.1.1.1.cmml"><mo id="A3.p2.7.m1.2.2.1.1.1.2" stretchy="false" xref="A3.p2.7.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="A3.p2.7.m1.2.2.1.1.1.1" xref="A3.p2.7.m1.2.2.1.1.1.1.cmml"><mrow id="A3.p2.7.m1.2.2.1.1.1.1.2" xref="A3.p2.7.m1.2.2.1.1.1.1.2.cmml"><mrow id="A3.p2.7.m1.2.2.1.1.1.1.2.2" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.cmml"><msubsup id="A3.p2.7.m1.2.2.1.1.1.1.2.2.2" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.cmml"><mi id="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.2.2" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.2.2.cmml">𝐞</mi><mi id="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.3.cmml">u</mi><mo id="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.2.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.2.3.cmml">⊤</mo></msubsup><mo id="A3.p2.7.m1.2.2.1.1.1.1.2.2.1" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.1.cmml">⁢</mo><msub id="A3.p2.7.m1.2.2.1.1.1.1.2.2.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="A3.p2.7.m1.2.2.1.1.1.1.2.2.3.2" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.3.2.cmml">𝐞</mi><mi id="A3.p2.7.m1.2.2.1.1.1.1.2.2.3.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.3.3.cmml">v</mi></msub></mrow><mo id="A3.p2.7.m1.2.2.1.1.1.1.2.1" rspace="0.055em" xref="A3.p2.7.m1.2.2.1.1.1.1.2.1.cmml">+</mo><mrow id="A3.p2.7.m1.2.2.1.1.1.1.2.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.cmml"><msub id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.cmml"><mo id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.2" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.2.cmml">∑</mo><mrow id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.cmml"><mi id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.2" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.2.cmml">p</mi><mo id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.1" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.1.cmml">∈</mo><msubsup id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.2.2" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.2.2.cmml">𝒫</mi><mi id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.3.cmml">t</mi><mo id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.2.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.2.3.cmml">+</mo></msubsup></mrow></msub><mrow id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.cmml"><msubsup id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.cmml"><mi id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.2.2" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.2.2.cmml">𝐞</mi><mi id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.3.cmml">v</mi><mo id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.2.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.2.3.cmml">⊤</mo></msubsup><mo id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.1" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.1.cmml">⁢</mo><msub id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3.cmml"><mi id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3.2" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3.2.cmml">𝐞</mi><mi id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3.3" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3.3.cmml">p</mi></msub></mrow></mrow></mrow><mo id="A3.p2.7.m1.2.2.1.1.1.1.1" rspace="0.055em" xref="A3.p2.7.m1.2.2.1.1.1.1.1.cmml">−</mo><mrow id="A3.p2.7.m1.2.2.1.1.1.1.3" xref="A3.p2.7.m1.2.2.1.1.1.1.3.cmml"><msub id="A3.p2.7.m1.2.2.1.1.1.1.3.1" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.cmml"><mo id="A3.p2.7.m1.2.2.1.1.1.1.3.1.2" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.cmml"><mi id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.2" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.2.cmml">p</mi><mo id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.1" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.1.cmml">∈</mo><msubsup id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.2.2" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.2.2.cmml">𝒫</mi><mi id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.3" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.3.cmml">t</mi><mo id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.2.3" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.2.3.cmml">−</mo></msubsup></mrow></msub><mrow id="A3.p2.7.m1.2.2.1.1.1.1.3.2" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.cmml"><msubsup id="A3.p2.7.m1.2.2.1.1.1.1.3.2.2" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.cmml"><mi id="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.2.2" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.2.2.cmml">𝐞</mi><mi id="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.3" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.3.cmml">v</mi><mo id="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.2.3" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.2.3.cmml">⊤</mo></msubsup><mo id="A3.p2.7.m1.2.2.1.1.1.1.3.2.1" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="A3.p2.7.m1.2.2.1.1.1.1.3.2.3" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.3.cmml"><mi id="A3.p2.7.m1.2.2.1.1.1.1.3.2.3.2" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.3.2.cmml">𝐞</mi><mi id="A3.p2.7.m1.2.2.1.1.1.1.3.2.3.3" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.3.3.cmml">p</mi></msub></mrow></mrow></mrow><mo id="A3.p2.7.m1.2.2.1.1.1.3" stretchy="false" xref="A3.p2.7.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.7.m1.2b"><apply id="A3.p2.7.m1.2.2.cmml" xref="A3.p2.7.m1.2.2"><eq id="A3.p2.7.m1.2.2.2.cmml" xref="A3.p2.7.m1.2.2.2"></eq><apply id="A3.p2.7.m1.2.2.3.cmml" xref="A3.p2.7.m1.2.2.3"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.3.1.cmml" xref="A3.p2.7.m1.2.2.3">subscript</csymbol><apply id="A3.p2.7.m1.2.2.3.2.cmml" xref="A3.p2.7.m1.2.2.3"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.3.2.1.cmml" xref="A3.p2.7.m1.2.2.3">superscript</csymbol><ci id="A3.p2.7.m1.2.2.3.2.2.cmml" xref="A3.p2.7.m1.2.2.3.2.2">𝑤</ci><ci id="A3.p2.7.m1.1.1.1.1.cmml" xref="A3.p2.7.m1.1.1.1.1">𝑡</ci></apply><ci id="A3.p2.7.m1.2.2.3.3.cmml" xref="A3.p2.7.m1.2.2.3.3">𝑣</ci></apply><apply id="A3.p2.7.m1.2.2.1.cmml" xref="A3.p2.7.m1.2.2.1"><times id="A3.p2.7.m1.2.2.1.2.cmml" xref="A3.p2.7.m1.2.2.1.2"></times><ci id="A3.p2.7.m1.2.2.1.3.cmml" xref="A3.p2.7.m1.2.2.1.3">sigmoid</ci><apply id="A3.p2.7.m1.2.2.1.1.1.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1"><minus id="A3.p2.7.m1.2.2.1.1.1.1.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.1"></minus><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2"><plus id="A3.p2.7.m1.2.2.1.1.1.1.2.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.1"></plus><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2"><times id="A3.p2.7.m1.2.2.1.1.1.1.2.2.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.1"></times><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.2">subscript</csymbol><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.2.2">𝐞</ci><csymbol cd="latexml" id="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.2.3">top</csymbol></apply><ci id="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.2.3">𝑢</ci></apply><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.2.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.3">subscript</csymbol><ci id="A3.p2.7.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.3.2">𝐞</ci><ci id="A3.p2.7.m1.2.2.1.1.1.1.2.2.3.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.2.3.3">𝑣</ci></apply></apply><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3"><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1">subscript</csymbol><sum id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.2"></sum><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3"><in id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.1"></in><ci id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.2">𝑝</ci><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3">subscript</csymbol><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.2.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3">superscript</csymbol><ci id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.2.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.2.2">𝒫</ci><plus id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.2.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.2.3"></plus></apply><ci id="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2"><times id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.1"></times><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2">subscript</csymbol><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.2.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2">superscript</csymbol><ci id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.2.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.2.2">𝐞</ci><csymbol cd="latexml" id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.2.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.2.3">top</csymbol></apply><ci id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.2.3">𝑣</ci></apply><apply id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3">subscript</csymbol><ci id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3.2">𝐞</ci><ci id="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.2.3.2.3.3">𝑝</ci></apply></apply></apply></apply><apply id="A3.p2.7.m1.2.2.1.1.1.1.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3"><apply id="A3.p2.7.m1.2.2.1.1.1.1.3.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.3.1.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1">subscript</csymbol><sum id="A3.p2.7.m1.2.2.1.1.1.1.3.1.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.2"></sum><apply id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3"><in id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.1"></in><ci id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.2">𝑝</ci><apply id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3">subscript</csymbol><apply id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.2.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3">superscript</csymbol><ci id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.2.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.2.2">𝒫</ci><minus id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.2.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.2.3"></minus></apply><ci id="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="A3.p2.7.m1.2.2.1.1.1.1.3.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2"><times id="A3.p2.7.m1.2.2.1.1.1.1.3.2.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.1"></times><apply id="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.2">subscript</csymbol><apply id="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.2.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.2">superscript</csymbol><ci id="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.2.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.2.2">𝐞</ci><csymbol cd="latexml" id="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.2.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.2.3">top</csymbol></apply><ci id="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.2.3">𝑣</ci></apply><apply id="A3.p2.7.m1.2.2.1.1.1.1.3.2.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A3.p2.7.m1.2.2.1.1.1.1.3.2.3.1.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.3">subscript</csymbol><ci id="A3.p2.7.m1.2.2.1.1.1.1.3.2.3.2.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.3.2">𝐞</ci><ci id="A3.p2.7.m1.2.2.1.1.1.1.3.2.3.3.cmml" xref="A3.p2.7.m1.2.2.1.1.1.1.3.2.3.3">𝑝</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.7.m1.2c">w^{(t)}_{v}=\mathrm{sigmoid}(\mathbf{e}^{\top}_{u}\mathbf{e}_{v}+\sum_{p\in%
\mathcal{P}^{+}_{t}}\mathbf{e}^{\top}_{v}\mathbf{e}_{p}-\sum_{p\in\mathcal{P}^%
{-}_{t}}\mathbf{e}^{\top}_{v}\mathbf{e}_{p})</annotation><annotation encoding="application/x-llamapun" id="A3.p2.7.m1.2d">italic_w start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = roman_sigmoid ( bold_e start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT bold_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_p ∈ caligraphic_P start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT bold_e start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT bold_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT - ∑ start_POSTSUBSCRIPT italic_p ∈ caligraphic_P start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT bold_e start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT bold_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT )</annotation></semantics></math> denotes the dynamic matching score of the item <math alttext="v" class="ltx_Math" display="inline" id="A3.p2.8.m2.1"><semantics id="A3.p2.8.m2.1a"><mi id="A3.p2.8.m2.1.1" xref="A3.p2.8.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="A3.p2.8.m2.1b"><ci id="A3.p2.8.m2.1.1.cmml" xref="A3.p2.8.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.8.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="A3.p2.8.m2.1d">italic_v</annotation></semantics></math> at the current conversational turn <math alttext="t" class="ltx_Math" display="inline" id="A3.p2.9.m3.1"><semantics id="A3.p2.9.m3.1a"><mi id="A3.p2.9.m3.1.1" xref="A3.p2.9.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A3.p2.9.m3.1b"><ci id="A3.p2.9.m3.1.1.cmml" xref="A3.p2.9.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.9.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="A3.p2.9.m3.1d">italic_t</annotation></semantics></math>. Next, let <math alttext="\mathbf{e}^{(0)}_{u}=\mathbf{e}_{u}" class="ltx_Math" display="inline" id="A3.p2.10.m4.1"><semantics id="A3.p2.10.m4.1a"><mrow id="A3.p2.10.m4.1.2" xref="A3.p2.10.m4.1.2.cmml"><msubsup id="A3.p2.10.m4.1.2.2" xref="A3.p2.10.m4.1.2.2.cmml"><mi id="A3.p2.10.m4.1.2.2.2.2" xref="A3.p2.10.m4.1.2.2.2.2.cmml">𝐞</mi><mi id="A3.p2.10.m4.1.2.2.3" xref="A3.p2.10.m4.1.2.2.3.cmml">u</mi><mrow id="A3.p2.10.m4.1.1.1.3" xref="A3.p2.10.m4.1.2.2.cmml"><mo id="A3.p2.10.m4.1.1.1.3.1" stretchy="false" xref="A3.p2.10.m4.1.2.2.cmml">(</mo><mn id="A3.p2.10.m4.1.1.1.1" xref="A3.p2.10.m4.1.1.1.1.cmml">0</mn><mo id="A3.p2.10.m4.1.1.1.3.2" stretchy="false" xref="A3.p2.10.m4.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A3.p2.10.m4.1.2.1" xref="A3.p2.10.m4.1.2.1.cmml">=</mo><msub id="A3.p2.10.m4.1.2.3" xref="A3.p2.10.m4.1.2.3.cmml"><mi id="A3.p2.10.m4.1.2.3.2" xref="A3.p2.10.m4.1.2.3.2.cmml">𝐞</mi><mi id="A3.p2.10.m4.1.2.3.3" xref="A3.p2.10.m4.1.2.3.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.10.m4.1b"><apply id="A3.p2.10.m4.1.2.cmml" xref="A3.p2.10.m4.1.2"><eq id="A3.p2.10.m4.1.2.1.cmml" xref="A3.p2.10.m4.1.2.1"></eq><apply id="A3.p2.10.m4.1.2.2.cmml" xref="A3.p2.10.m4.1.2.2"><csymbol cd="ambiguous" id="A3.p2.10.m4.1.2.2.1.cmml" xref="A3.p2.10.m4.1.2.2">subscript</csymbol><apply id="A3.p2.10.m4.1.2.2.2.cmml" xref="A3.p2.10.m4.1.2.2"><csymbol cd="ambiguous" id="A3.p2.10.m4.1.2.2.2.1.cmml" xref="A3.p2.10.m4.1.2.2">superscript</csymbol><ci id="A3.p2.10.m4.1.2.2.2.2.cmml" xref="A3.p2.10.m4.1.2.2.2.2">𝐞</ci><cn id="A3.p2.10.m4.1.1.1.1.cmml" type="integer" xref="A3.p2.10.m4.1.1.1.1">0</cn></apply><ci id="A3.p2.10.m4.1.2.2.3.cmml" xref="A3.p2.10.m4.1.2.2.3">𝑢</ci></apply><apply id="A3.p2.10.m4.1.2.3.cmml" xref="A3.p2.10.m4.1.2.3"><csymbol cd="ambiguous" id="A3.p2.10.m4.1.2.3.1.cmml" xref="A3.p2.10.m4.1.2.3">subscript</csymbol><ci id="A3.p2.10.m4.1.2.3.2.cmml" xref="A3.p2.10.m4.1.2.3.2">𝐞</ci><ci id="A3.p2.10.m4.1.2.3.3.cmml" xref="A3.p2.10.m4.1.2.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.10.m4.1c">\mathbf{e}^{(0)}_{u}=\mathbf{e}_{u}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.10.m4.1d">bold_e start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = bold_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{e}^{(0)}_{v}=\mathbf{e}_{v}" class="ltx_Math" display="inline" id="A3.p2.11.m5.1"><semantics id="A3.p2.11.m5.1a"><mrow id="A3.p2.11.m5.1.2" xref="A3.p2.11.m5.1.2.cmml"><msubsup id="A3.p2.11.m5.1.2.2" xref="A3.p2.11.m5.1.2.2.cmml"><mi id="A3.p2.11.m5.1.2.2.2.2" xref="A3.p2.11.m5.1.2.2.2.2.cmml">𝐞</mi><mi id="A3.p2.11.m5.1.2.2.3" xref="A3.p2.11.m5.1.2.2.3.cmml">v</mi><mrow id="A3.p2.11.m5.1.1.1.3" xref="A3.p2.11.m5.1.2.2.cmml"><mo id="A3.p2.11.m5.1.1.1.3.1" stretchy="false" xref="A3.p2.11.m5.1.2.2.cmml">(</mo><mn id="A3.p2.11.m5.1.1.1.1" xref="A3.p2.11.m5.1.1.1.1.cmml">0</mn><mo id="A3.p2.11.m5.1.1.1.3.2" stretchy="false" xref="A3.p2.11.m5.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A3.p2.11.m5.1.2.1" xref="A3.p2.11.m5.1.2.1.cmml">=</mo><msub id="A3.p2.11.m5.1.2.3" xref="A3.p2.11.m5.1.2.3.cmml"><mi id="A3.p2.11.m5.1.2.3.2" xref="A3.p2.11.m5.1.2.3.2.cmml">𝐞</mi><mi id="A3.p2.11.m5.1.2.3.3" xref="A3.p2.11.m5.1.2.3.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.11.m5.1b"><apply id="A3.p2.11.m5.1.2.cmml" xref="A3.p2.11.m5.1.2"><eq id="A3.p2.11.m5.1.2.1.cmml" xref="A3.p2.11.m5.1.2.1"></eq><apply id="A3.p2.11.m5.1.2.2.cmml" xref="A3.p2.11.m5.1.2.2"><csymbol cd="ambiguous" id="A3.p2.11.m5.1.2.2.1.cmml" xref="A3.p2.11.m5.1.2.2">subscript</csymbol><apply id="A3.p2.11.m5.1.2.2.2.cmml" xref="A3.p2.11.m5.1.2.2"><csymbol cd="ambiguous" id="A3.p2.11.m5.1.2.2.2.1.cmml" xref="A3.p2.11.m5.1.2.2">superscript</csymbol><ci id="A3.p2.11.m5.1.2.2.2.2.cmml" xref="A3.p2.11.m5.1.2.2.2.2">𝐞</ci><cn id="A3.p2.11.m5.1.1.1.1.cmml" type="integer" xref="A3.p2.11.m5.1.1.1.1">0</cn></apply><ci id="A3.p2.11.m5.1.2.2.3.cmml" xref="A3.p2.11.m5.1.2.2.3">𝑣</ci></apply><apply id="A3.p2.11.m5.1.2.3.cmml" xref="A3.p2.11.m5.1.2.3"><csymbol cd="ambiguous" id="A3.p2.11.m5.1.2.3.1.cmml" xref="A3.p2.11.m5.1.2.3">subscript</csymbol><ci id="A3.p2.11.m5.1.2.3.2.cmml" xref="A3.p2.11.m5.1.2.3.2">𝐞</ci><ci id="A3.p2.11.m5.1.2.3.3.cmml" xref="A3.p2.11.m5.1.2.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.11.m5.1c">\mathbf{e}^{(0)}_{v}=\mathbf{e}_{v}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.11.m5.1d">bold_e start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = bold_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{e}^{(0)}_{p}=\mathbf{e}_{p}" class="ltx_Math" display="inline" id="A3.p2.12.m6.1"><semantics id="A3.p2.12.m6.1a"><mrow id="A3.p2.12.m6.1.2" xref="A3.p2.12.m6.1.2.cmml"><msubsup id="A3.p2.12.m6.1.2.2" xref="A3.p2.12.m6.1.2.2.cmml"><mi id="A3.p2.12.m6.1.2.2.2.2" xref="A3.p2.12.m6.1.2.2.2.2.cmml">𝐞</mi><mi id="A3.p2.12.m6.1.2.2.3" xref="A3.p2.12.m6.1.2.2.3.cmml">p</mi><mrow id="A3.p2.12.m6.1.1.1.3" xref="A3.p2.12.m6.1.2.2.cmml"><mo id="A3.p2.12.m6.1.1.1.3.1" stretchy="false" xref="A3.p2.12.m6.1.2.2.cmml">(</mo><mn id="A3.p2.12.m6.1.1.1.1" xref="A3.p2.12.m6.1.1.1.1.cmml">0</mn><mo id="A3.p2.12.m6.1.1.1.3.2" stretchy="false" xref="A3.p2.12.m6.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A3.p2.12.m6.1.2.1" xref="A3.p2.12.m6.1.2.1.cmml">=</mo><msub id="A3.p2.12.m6.1.2.3" xref="A3.p2.12.m6.1.2.3.cmml"><mi id="A3.p2.12.m6.1.2.3.2" xref="A3.p2.12.m6.1.2.3.2.cmml">𝐞</mi><mi id="A3.p2.12.m6.1.2.3.3" xref="A3.p2.12.m6.1.2.3.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.12.m6.1b"><apply id="A3.p2.12.m6.1.2.cmml" xref="A3.p2.12.m6.1.2"><eq id="A3.p2.12.m6.1.2.1.cmml" xref="A3.p2.12.m6.1.2.1"></eq><apply id="A3.p2.12.m6.1.2.2.cmml" xref="A3.p2.12.m6.1.2.2"><csymbol cd="ambiguous" id="A3.p2.12.m6.1.2.2.1.cmml" xref="A3.p2.12.m6.1.2.2">subscript</csymbol><apply id="A3.p2.12.m6.1.2.2.2.cmml" xref="A3.p2.12.m6.1.2.2"><csymbol cd="ambiguous" id="A3.p2.12.m6.1.2.2.2.1.cmml" xref="A3.p2.12.m6.1.2.2">superscript</csymbol><ci id="A3.p2.12.m6.1.2.2.2.2.cmml" xref="A3.p2.12.m6.1.2.2.2.2">𝐞</ci><cn id="A3.p2.12.m6.1.1.1.1.cmml" type="integer" xref="A3.p2.12.m6.1.1.1.1">0</cn></apply><ci id="A3.p2.12.m6.1.2.2.3.cmml" xref="A3.p2.12.m6.1.2.2.3">𝑝</ci></apply><apply id="A3.p2.12.m6.1.2.3.cmml" xref="A3.p2.12.m6.1.2.3"><csymbol cd="ambiguous" id="A3.p2.12.m6.1.2.3.1.cmml" xref="A3.p2.12.m6.1.2.3">subscript</csymbol><ci id="A3.p2.12.m6.1.2.3.2.cmml" xref="A3.p2.12.m6.1.2.3.2">𝐞</ci><ci id="A3.p2.12.m6.1.2.3.3.cmml" xref="A3.p2.12.m6.1.2.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.12.m6.1c">\mathbf{e}^{(0)}_{p}=\mathbf{e}_{p}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.12.m6.1d">bold_e start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = bold_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> denote the embeddings of user, item and attribute value, we then adopt a Graph Convolutional Network (GCN) <cite class="ltx_cite ltx_citemacro_cite">Kipf and Welling (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib22" title="">2016</a>)</cite> to propagate the message on the current dynamic graph, and calculate the hidden representation of the node at the <math alttext="l{+}1" class="ltx_Math" display="inline" id="A3.p2.13.m7.1"><semantics id="A3.p2.13.m7.1a"><mrow id="A3.p2.13.m7.1.1" xref="A3.p2.13.m7.1.1.cmml"><mi id="A3.p2.13.m7.1.1.2" xref="A3.p2.13.m7.1.1.2.cmml">l</mi><mo id="A3.p2.13.m7.1.1.1" xref="A3.p2.13.m7.1.1.1.cmml">+</mo><mn id="A3.p2.13.m7.1.1.3" xref="A3.p2.13.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.13.m7.1b"><apply id="A3.p2.13.m7.1.1.cmml" xref="A3.p2.13.m7.1.1"><plus id="A3.p2.13.m7.1.1.1.cmml" xref="A3.p2.13.m7.1.1.1"></plus><ci id="A3.p2.13.m7.1.1.2.cmml" xref="A3.p2.13.m7.1.1.2">𝑙</ci><cn id="A3.p2.13.m7.1.1.3.cmml" type="integer" xref="A3.p2.13.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.13.m7.1c">l{+}1</annotation><annotation encoding="application/x-llamapun" id="A3.p2.13.m7.1d">italic_l + 1</annotation></semantics></math>-th layer as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{e}^{\!(l\!+\!1\!)}_{i}{=}\sigma(\!\sum_{\!\{j|\mathcal{E}^{+}_{t}(i,j)%
&gt;0\}\!}\!\frac{\mathbf{W}_{a}^{(l)}\mathbf{e}^{(l)}_{j}}{\sqrt{\sum\limits_{%
\hat{j}}\!\mathcal{E}^{+}_{t}\!(i,\hat{j})\!\sum\limits_{\hat{j}}\!\mathcal{E}%
^{+}_{t}\!(j,\hat{j})}}+\mathbf{e}^{(l)}_{i})," class="ltx_Math" display="block" id="A3.E14.m1.13"><semantics id="A3.E14.m1.13a"><mrow id="A3.E14.m1.13.13.1" xref="A3.E14.m1.13.13.1.1.cmml"><mrow id="A3.E14.m1.13.13.1.1" xref="A3.E14.m1.13.13.1.1.cmml"><msubsup id="A3.E14.m1.13.13.1.1.3" xref="A3.E14.m1.13.13.1.1.3.cmml"><mi id="A3.E14.m1.13.13.1.1.3.2.2" xref="A3.E14.m1.13.13.1.1.3.2.2.cmml">𝐞</mi><mi id="A3.E14.m1.13.13.1.1.3.3" xref="A3.E14.m1.13.13.1.1.3.3.cmml">i</mi><mrow id="A3.E14.m1.1.1.1.1" xref="A3.E14.m1.1.1.1.1.1.cmml"><mo id="A3.E14.m1.1.1.1.1.2" stretchy="false" xref="A3.E14.m1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E14.m1.1.1.1.1.1" xref="A3.E14.m1.1.1.1.1.1.cmml"><mi id="A3.E14.m1.1.1.1.1.1.2" xref="A3.E14.m1.1.1.1.1.1.2.cmml">l</mi><mo id="A3.E14.m1.1.1.1.1.1.1" lspace="0.052em" rspace="0.052em" xref="A3.E14.m1.1.1.1.1.1.1.cmml">+</mo><mpadded width="0.330em"><mn id="A3.E14.m1.1.1.1.1.1.3" xref="A3.E14.m1.1.1.1.1.1.3.cmml">1</mn></mpadded></mrow><mo id="A3.E14.m1.1.1.1.1.3" stretchy="false" xref="A3.E14.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A3.E14.m1.13.13.1.1.2" xref="A3.E14.m1.13.13.1.1.2.cmml">=</mo><mrow id="A3.E14.m1.13.13.1.1.1" xref="A3.E14.m1.13.13.1.1.1.cmml"><mi id="A3.E14.m1.13.13.1.1.1.3" xref="A3.E14.m1.13.13.1.1.1.3.cmml">σ</mi><mo id="A3.E14.m1.13.13.1.1.1.2" xref="A3.E14.m1.13.13.1.1.1.2.cmml">⁢</mo><mrow id="A3.E14.m1.13.13.1.1.1.1.1" xref="A3.E14.m1.13.13.1.1.1.1.1.1.cmml"><mpadded width="0.288em"><mo id="A3.E14.m1.13.13.1.1.1.1.1.2" stretchy="false" xref="A3.E14.m1.13.13.1.1.1.1.1.1.cmml">(</mo></mpadded><mrow id="A3.E14.m1.13.13.1.1.1.1.1.1" xref="A3.E14.m1.13.13.1.1.1.1.1.1.cmml"><mrow id="A3.E14.m1.13.13.1.1.1.1.1.1.2" xref="A3.E14.m1.13.13.1.1.1.1.1.1.2.cmml"><munder id="A3.E14.m1.13.13.1.1.1.1.1.1.2.1" xref="A3.E14.m1.13.13.1.1.1.1.1.1.2.1.cmml"><mo id="A3.E14.m1.13.13.1.1.1.1.1.1.2.1.2" movablelimits="false" xref="A3.E14.m1.13.13.1.1.1.1.1.1.2.1.2.cmml">∑</mo><mrow id="A3.E14.m1.5.5.4.4" xref="A3.E14.m1.5.5.4.5.cmml"><mo id="A3.E14.m1.5.5.4.4.2" stretchy="false" xref="A3.E14.m1.5.5.4.5.1.cmml">{</mo><mi id="A3.E14.m1.4.4.3.3" xref="A3.E14.m1.4.4.3.3.cmml">j</mi><mo id="A3.E14.m1.5.5.4.4.3" lspace="0em" rspace="0em" xref="A3.E14.m1.5.5.4.5.1.cmml">|</mo><mrow id="A3.E14.m1.5.5.4.4.1" xref="A3.E14.m1.5.5.4.4.1.cmml"><mrow id="A3.E14.m1.5.5.4.4.1.2" xref="A3.E14.m1.5.5.4.4.1.2.cmml"><msubsup id="A3.E14.m1.5.5.4.4.1.2.2" xref="A3.E14.m1.5.5.4.4.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E14.m1.5.5.4.4.1.2.2.2.2" xref="A3.E14.m1.5.5.4.4.1.2.2.2.2.cmml">ℰ</mi><mi id="A3.E14.m1.5.5.4.4.1.2.2.3" xref="A3.E14.m1.5.5.4.4.1.2.2.3.cmml">t</mi><mo id="A3.E14.m1.5.5.4.4.1.2.2.2.3" xref="A3.E14.m1.5.5.4.4.1.2.2.2.3.cmml">+</mo></msubsup><mo id="A3.E14.m1.5.5.4.4.1.2.1" xref="A3.E14.m1.5.5.4.4.1.2.1.cmml">⁢</mo><mrow id="A3.E14.m1.5.5.4.4.1.2.3.2" xref="A3.E14.m1.5.5.4.4.1.2.3.1.cmml"><mo id="A3.E14.m1.5.5.4.4.1.2.3.2.1" stretchy="false" xref="A3.E14.m1.5.5.4.4.1.2.3.1.cmml">(</mo><mi id="A3.E14.m1.2.2.1.1" xref="A3.E14.m1.2.2.1.1.cmml">i</mi><mo id="A3.E14.m1.5.5.4.4.1.2.3.2.2" xref="A3.E14.m1.5.5.4.4.1.2.3.1.cmml">,</mo><mi id="A3.E14.m1.3.3.2.2" xref="A3.E14.m1.3.3.2.2.cmml">j</mi><mo id="A3.E14.m1.5.5.4.4.1.2.3.2.3" stretchy="false" xref="A3.E14.m1.5.5.4.4.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A3.E14.m1.5.5.4.4.1.1" xref="A3.E14.m1.5.5.4.4.1.1.cmml">&gt;</mo><mn id="A3.E14.m1.5.5.4.4.1.3" xref="A3.E14.m1.5.5.4.4.1.3.cmml">0</mn></mrow><mo id="A3.E14.m1.5.5.4.4.4" stretchy="false" xref="A3.E14.m1.5.5.4.5.1.cmml">}</mo></mrow></munder><mfrac id="A3.E14.m1.11.11" xref="A3.E14.m1.11.11.cmml"><mrow id="A3.E14.m1.7.7.2" xref="A3.E14.m1.7.7.2.cmml"><msubsup id="A3.E14.m1.7.7.2.4" xref="A3.E14.m1.7.7.2.4.cmml"><mi id="A3.E14.m1.7.7.2.4.2.2" xref="A3.E14.m1.7.7.2.4.2.2.cmml">𝐖</mi><mi id="A3.E14.m1.7.7.2.4.2.3" xref="A3.E14.m1.7.7.2.4.2.3.cmml">a</mi><mrow id="A3.E14.m1.6.6.1.1.1.3" xref="A3.E14.m1.7.7.2.4.cmml"><mo id="A3.E14.m1.6.6.1.1.1.3.1" stretchy="false" xref="A3.E14.m1.7.7.2.4.cmml">(</mo><mi id="A3.E14.m1.6.6.1.1.1.1" xref="A3.E14.m1.6.6.1.1.1.1.cmml">l</mi><mo id="A3.E14.m1.6.6.1.1.1.3.2" stretchy="false" xref="A3.E14.m1.7.7.2.4.cmml">)</mo></mrow></msubsup><mo id="A3.E14.m1.7.7.2.3" xref="A3.E14.m1.7.7.2.3.cmml">⁢</mo><msubsup id="A3.E14.m1.7.7.2.5" xref="A3.E14.m1.7.7.2.5.cmml"><mi id="A3.E14.m1.7.7.2.5.2.2" xref="A3.E14.m1.7.7.2.5.2.2.cmml">𝐞</mi><mi id="A3.E14.m1.7.7.2.5.3" xref="A3.E14.m1.7.7.2.5.3.cmml">j</mi><mrow id="A3.E14.m1.7.7.2.2.1.3" xref="A3.E14.m1.7.7.2.5.cmml"><mo id="A3.E14.m1.7.7.2.2.1.3.1" stretchy="false" xref="A3.E14.m1.7.7.2.5.cmml">(</mo><mi id="A3.E14.m1.7.7.2.2.1.1" xref="A3.E14.m1.7.7.2.2.1.1.cmml">l</mi><mo id="A3.E14.m1.7.7.2.2.1.3.2" stretchy="false" xref="A3.E14.m1.7.7.2.5.cmml">)</mo></mrow></msubsup></mrow><msqrt id="A3.E14.m1.11.11.6" xref="A3.E14.m1.11.11.6.cmml"><mrow id="A3.E14.m1.11.11.6.4.4" xref="A3.E14.m1.11.11.6.4.4.cmml"><munder id="A3.E14.m1.11.11.6.4.4.5" xref="A3.E14.m1.11.11.6.4.4.5.cmml"><mo id="A3.E14.m1.11.11.6.4.4.5.2" movablelimits="false" xref="A3.E14.m1.11.11.6.4.4.5.2.cmml">∑</mo><mover accent="true" id="A3.E14.m1.11.11.6.4.4.5.3" xref="A3.E14.m1.11.11.6.4.4.5.3.cmml"><mi id="A3.E14.m1.11.11.6.4.4.5.3.2" xref="A3.E14.m1.11.11.6.4.4.5.3.2.cmml">j</mi><mo id="A3.E14.m1.11.11.6.4.4.5.3.1" xref="A3.E14.m1.11.11.6.4.4.5.3.1.cmml">^</mo></mover></munder><mrow id="A3.E14.m1.11.11.6.4.4.6" xref="A3.E14.m1.11.11.6.4.4.6.cmml"><msubsup id="A3.E14.m1.11.11.6.4.4.6.2" xref="A3.E14.m1.11.11.6.4.4.6.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E14.m1.11.11.6.4.4.6.2.2.2" xref="A3.E14.m1.11.11.6.4.4.6.2.2.2.cmml">ℰ</mi><mi id="A3.E14.m1.11.11.6.4.4.6.2.3" xref="A3.E14.m1.11.11.6.4.4.6.2.3.cmml">t</mi><mo id="A3.E14.m1.11.11.6.4.4.6.2.2.3" xref="A3.E14.m1.11.11.6.4.4.6.2.2.3.cmml">+</mo></msubsup><mo id="A3.E14.m1.11.11.6.4.4.6.1" xref="A3.E14.m1.11.11.6.4.4.6.1.cmml">⁢</mo><mrow id="A3.E14.m1.11.11.6.4.4.6.3.2" xref="A3.E14.m1.11.11.6.4.4.6.3.1.cmml"><mo id="A3.E14.m1.11.11.6.4.4.6.3.2.1" stretchy="false" xref="A3.E14.m1.11.11.6.4.4.6.3.1.cmml">(</mo><mi id="A3.E14.m1.8.8.3.1.1.1" xref="A3.E14.m1.8.8.3.1.1.1.cmml">i</mi><mo id="A3.E14.m1.11.11.6.4.4.6.3.2.2" xref="A3.E14.m1.11.11.6.4.4.6.3.1.cmml">,</mo><mover accent="true" id="A3.E14.m1.9.9.4.2.2.2" xref="A3.E14.m1.9.9.4.2.2.2.cmml"><mi id="A3.E14.m1.9.9.4.2.2.2.2" xref="A3.E14.m1.9.9.4.2.2.2.2.cmml">j</mi><mo id="A3.E14.m1.9.9.4.2.2.2.1" xref="A3.E14.m1.9.9.4.2.2.2.1.cmml">^</mo></mover><mpadded width="0.455em"><mo id="A3.E14.m1.11.11.6.4.4.6.3.2.3" stretchy="false" xref="A3.E14.m1.11.11.6.4.4.6.3.1.cmml">)</mo></mpadded></mrow><mo id="A3.E14.m1.11.11.6.4.4.6.1a" xref="A3.E14.m1.11.11.6.4.4.6.1.cmml">⁢</mo><mrow id="A3.E14.m1.11.11.6.4.4.6.4" xref="A3.E14.m1.11.11.6.4.4.6.4.cmml"><munder id="A3.E14.m1.11.11.6.4.4.6.4.1" xref="A3.E14.m1.11.11.6.4.4.6.4.1.cmml"><mo id="A3.E14.m1.11.11.6.4.4.6.4.1.2" movablelimits="false" xref="A3.E14.m1.11.11.6.4.4.6.4.1.2.cmml">∑</mo><mover accent="true" id="A3.E14.m1.11.11.6.4.4.6.4.1.3" xref="A3.E14.m1.11.11.6.4.4.6.4.1.3.cmml"><mi id="A3.E14.m1.11.11.6.4.4.6.4.1.3.2" xref="A3.E14.m1.11.11.6.4.4.6.4.1.3.2.cmml">j</mi><mo id="A3.E14.m1.11.11.6.4.4.6.4.1.3.1" xref="A3.E14.m1.11.11.6.4.4.6.4.1.3.1.cmml">^</mo></mover></munder><mrow id="A3.E14.m1.11.11.6.4.4.6.4.2" xref="A3.E14.m1.11.11.6.4.4.6.4.2.cmml"><msubsup id="A3.E14.m1.11.11.6.4.4.6.4.2.2" xref="A3.E14.m1.11.11.6.4.4.6.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E14.m1.11.11.6.4.4.6.4.2.2.2.2" xref="A3.E14.m1.11.11.6.4.4.6.4.2.2.2.2.cmml">ℰ</mi><mi id="A3.E14.m1.11.11.6.4.4.6.4.2.2.3" xref="A3.E14.m1.11.11.6.4.4.6.4.2.2.3.cmml">t</mi><mo id="A3.E14.m1.11.11.6.4.4.6.4.2.2.2.3" xref="A3.E14.m1.11.11.6.4.4.6.4.2.2.2.3.cmml">+</mo></msubsup><mo id="A3.E14.m1.11.11.6.4.4.6.4.2.1" xref="A3.E14.m1.11.11.6.4.4.6.4.2.1.cmml">⁢</mo><mrow id="A3.E14.m1.11.11.6.4.4.6.4.2.3.2" xref="A3.E14.m1.11.11.6.4.4.6.4.2.3.1.cmml"><mo id="A3.E14.m1.11.11.6.4.4.6.4.2.3.2.1" stretchy="false" xref="A3.E14.m1.11.11.6.4.4.6.4.2.3.1.cmml">(</mo><mi id="A3.E14.m1.10.10.5.3.3.3" xref="A3.E14.m1.10.10.5.3.3.3.cmml">j</mi><mo id="A3.E14.m1.11.11.6.4.4.6.4.2.3.2.2" xref="A3.E14.m1.11.11.6.4.4.6.4.2.3.1.cmml">,</mo><mover accent="true" id="A3.E14.m1.11.11.6.4.4.4" xref="A3.E14.m1.11.11.6.4.4.4.cmml"><mi id="A3.E14.m1.11.11.6.4.4.4.2" xref="A3.E14.m1.11.11.6.4.4.4.2.cmml">j</mi><mo id="A3.E14.m1.11.11.6.4.4.4.1" xref="A3.E14.m1.11.11.6.4.4.4.1.cmml">^</mo></mover><mo id="A3.E14.m1.11.11.6.4.4.6.4.2.3.2.3" stretchy="false" xref="A3.E14.m1.11.11.6.4.4.6.4.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></msqrt></mfrac></mrow><mo id="A3.E14.m1.13.13.1.1.1.1.1.1.1" xref="A3.E14.m1.13.13.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="A3.E14.m1.13.13.1.1.1.1.1.1.3" xref="A3.E14.m1.13.13.1.1.1.1.1.1.3.cmml"><mi id="A3.E14.m1.13.13.1.1.1.1.1.1.3.2.2" xref="A3.E14.m1.13.13.1.1.1.1.1.1.3.2.2.cmml">𝐞</mi><mi id="A3.E14.m1.13.13.1.1.1.1.1.1.3.3" xref="A3.E14.m1.13.13.1.1.1.1.1.1.3.3.cmml">i</mi><mrow id="A3.E14.m1.12.12.1.3" xref="A3.E14.m1.13.13.1.1.1.1.1.1.3.cmml"><mo id="A3.E14.m1.12.12.1.3.1" stretchy="false" xref="A3.E14.m1.13.13.1.1.1.1.1.1.3.cmml">(</mo><mi id="A3.E14.m1.12.12.1.1" xref="A3.E14.m1.12.12.1.1.cmml">l</mi><mo id="A3.E14.m1.12.12.1.3.2" stretchy="false" xref="A3.E14.m1.13.13.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A3.E14.m1.13.13.1.1.1.1.1.3" stretchy="false" xref="A3.E14.m1.13.13.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E14.m1.13.13.1.2" xref="A3.E14.m1.13.13.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E14.m1.13b"><apply id="A3.E14.m1.13.13.1.1.cmml" xref="A3.E14.m1.13.13.1"><eq id="A3.E14.m1.13.13.1.1.2.cmml" xref="A3.E14.m1.13.13.1.1.2"></eq><apply id="A3.E14.m1.13.13.1.1.3.cmml" xref="A3.E14.m1.13.13.1.1.3"><csymbol cd="ambiguous" id="A3.E14.m1.13.13.1.1.3.1.cmml" xref="A3.E14.m1.13.13.1.1.3">subscript</csymbol><apply id="A3.E14.m1.13.13.1.1.3.2.cmml" xref="A3.E14.m1.13.13.1.1.3"><csymbol cd="ambiguous" id="A3.E14.m1.13.13.1.1.3.2.1.cmml" xref="A3.E14.m1.13.13.1.1.3">superscript</csymbol><ci id="A3.E14.m1.13.13.1.1.3.2.2.cmml" xref="A3.E14.m1.13.13.1.1.3.2.2">𝐞</ci><apply id="A3.E14.m1.1.1.1.1.1.cmml" xref="A3.E14.m1.1.1.1.1"><plus id="A3.E14.m1.1.1.1.1.1.1.cmml" xref="A3.E14.m1.1.1.1.1.1.1"></plus><ci id="A3.E14.m1.1.1.1.1.1.2.cmml" xref="A3.E14.m1.1.1.1.1.1.2">𝑙</ci><cn id="A3.E14.m1.1.1.1.1.1.3.cmml" type="integer" xref="A3.E14.m1.1.1.1.1.1.3">1</cn></apply></apply><ci id="A3.E14.m1.13.13.1.1.3.3.cmml" xref="A3.E14.m1.13.13.1.1.3.3">𝑖</ci></apply><apply id="A3.E14.m1.13.13.1.1.1.cmml" xref="A3.E14.m1.13.13.1.1.1"><times id="A3.E14.m1.13.13.1.1.1.2.cmml" xref="A3.E14.m1.13.13.1.1.1.2"></times><ci id="A3.E14.m1.13.13.1.1.1.3.cmml" xref="A3.E14.m1.13.13.1.1.1.3">𝜎</ci><apply id="A3.E14.m1.13.13.1.1.1.1.1.1.cmml" xref="A3.E14.m1.13.13.1.1.1.1.1"><plus id="A3.E14.m1.13.13.1.1.1.1.1.1.1.cmml" xref="A3.E14.m1.13.13.1.1.1.1.1.1.1"></plus><apply id="A3.E14.m1.13.13.1.1.1.1.1.1.2.cmml" xref="A3.E14.m1.13.13.1.1.1.1.1.1.2"><apply id="A3.E14.m1.13.13.1.1.1.1.1.1.2.1.cmml" xref="A3.E14.m1.13.13.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A3.E14.m1.13.13.1.1.1.1.1.1.2.1.1.cmml" xref="A3.E14.m1.13.13.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="A3.E14.m1.13.13.1.1.1.1.1.1.2.1.2.cmml" xref="A3.E14.m1.13.13.1.1.1.1.1.1.2.1.2"></sum><apply id="A3.E14.m1.5.5.4.5.cmml" xref="A3.E14.m1.5.5.4.4"><csymbol cd="latexml" id="A3.E14.m1.5.5.4.5.1.cmml" xref="A3.E14.m1.5.5.4.4.2">conditional-set</csymbol><ci id="A3.E14.m1.4.4.3.3.cmml" xref="A3.E14.m1.4.4.3.3">𝑗</ci><apply id="A3.E14.m1.5.5.4.4.1.cmml" xref="A3.E14.m1.5.5.4.4.1"><gt id="A3.E14.m1.5.5.4.4.1.1.cmml" xref="A3.E14.m1.5.5.4.4.1.1"></gt><apply id="A3.E14.m1.5.5.4.4.1.2.cmml" xref="A3.E14.m1.5.5.4.4.1.2"><times id="A3.E14.m1.5.5.4.4.1.2.1.cmml" xref="A3.E14.m1.5.5.4.4.1.2.1"></times><apply id="A3.E14.m1.5.5.4.4.1.2.2.cmml" xref="A3.E14.m1.5.5.4.4.1.2.2"><csymbol cd="ambiguous" id="A3.E14.m1.5.5.4.4.1.2.2.1.cmml" xref="A3.E14.m1.5.5.4.4.1.2.2">subscript</csymbol><apply id="A3.E14.m1.5.5.4.4.1.2.2.2.cmml" xref="A3.E14.m1.5.5.4.4.1.2.2"><csymbol cd="ambiguous" id="A3.E14.m1.5.5.4.4.1.2.2.2.1.cmml" xref="A3.E14.m1.5.5.4.4.1.2.2">superscript</csymbol><ci id="A3.E14.m1.5.5.4.4.1.2.2.2.2.cmml" xref="A3.E14.m1.5.5.4.4.1.2.2.2.2">ℰ</ci><plus id="A3.E14.m1.5.5.4.4.1.2.2.2.3.cmml" xref="A3.E14.m1.5.5.4.4.1.2.2.2.3"></plus></apply><ci id="A3.E14.m1.5.5.4.4.1.2.2.3.cmml" xref="A3.E14.m1.5.5.4.4.1.2.2.3">𝑡</ci></apply><interval closure="open" id="A3.E14.m1.5.5.4.4.1.2.3.1.cmml" xref="A3.E14.m1.5.5.4.4.1.2.3.2"><ci id="A3.E14.m1.2.2.1.1.cmml" xref="A3.E14.m1.2.2.1.1">𝑖</ci><ci id="A3.E14.m1.3.3.2.2.cmml" xref="A3.E14.m1.3.3.2.2">𝑗</ci></interval></apply><cn id="A3.E14.m1.5.5.4.4.1.3.cmml" type="integer" xref="A3.E14.m1.5.5.4.4.1.3">0</cn></apply></apply></apply><apply id="A3.E14.m1.11.11.cmml" xref="A3.E14.m1.11.11"><divide id="A3.E14.m1.11.11.7.cmml" xref="A3.E14.m1.11.11"></divide><apply id="A3.E14.m1.7.7.2.cmml" xref="A3.E14.m1.7.7.2"><times id="A3.E14.m1.7.7.2.3.cmml" xref="A3.E14.m1.7.7.2.3"></times><apply id="A3.E14.m1.7.7.2.4.cmml" xref="A3.E14.m1.7.7.2.4"><csymbol cd="ambiguous" id="A3.E14.m1.7.7.2.4.1.cmml" xref="A3.E14.m1.7.7.2.4">superscript</csymbol><apply id="A3.E14.m1.7.7.2.4.2.cmml" xref="A3.E14.m1.7.7.2.4"><csymbol cd="ambiguous" id="A3.E14.m1.7.7.2.4.2.1.cmml" xref="A3.E14.m1.7.7.2.4">subscript</csymbol><ci id="A3.E14.m1.7.7.2.4.2.2.cmml" xref="A3.E14.m1.7.7.2.4.2.2">𝐖</ci><ci id="A3.E14.m1.7.7.2.4.2.3.cmml" xref="A3.E14.m1.7.7.2.4.2.3">𝑎</ci></apply><ci id="A3.E14.m1.6.6.1.1.1.1.cmml" xref="A3.E14.m1.6.6.1.1.1.1">𝑙</ci></apply><apply id="A3.E14.m1.7.7.2.5.cmml" xref="A3.E14.m1.7.7.2.5"><csymbol cd="ambiguous" id="A3.E14.m1.7.7.2.5.1.cmml" xref="A3.E14.m1.7.7.2.5">subscript</csymbol><apply id="A3.E14.m1.7.7.2.5.2.cmml" xref="A3.E14.m1.7.7.2.5"><csymbol cd="ambiguous" id="A3.E14.m1.7.7.2.5.2.1.cmml" xref="A3.E14.m1.7.7.2.5">superscript</csymbol><ci id="A3.E14.m1.7.7.2.5.2.2.cmml" xref="A3.E14.m1.7.7.2.5.2.2">𝐞</ci><ci id="A3.E14.m1.7.7.2.2.1.1.cmml" xref="A3.E14.m1.7.7.2.2.1.1">𝑙</ci></apply><ci id="A3.E14.m1.7.7.2.5.3.cmml" xref="A3.E14.m1.7.7.2.5.3">𝑗</ci></apply></apply><apply id="A3.E14.m1.11.11.6.cmml" xref="A3.E14.m1.11.11.6"><root id="A3.E14.m1.11.11.6a.cmml" xref="A3.E14.m1.11.11.6"></root><apply id="A3.E14.m1.11.11.6.4.4.cmml" xref="A3.E14.m1.11.11.6.4.4"><apply id="A3.E14.m1.11.11.6.4.4.5.cmml" xref="A3.E14.m1.11.11.6.4.4.5"><csymbol cd="ambiguous" id="A3.E14.m1.11.11.6.4.4.5.1.cmml" xref="A3.E14.m1.11.11.6.4.4.5">subscript</csymbol><sum id="A3.E14.m1.11.11.6.4.4.5.2.cmml" xref="A3.E14.m1.11.11.6.4.4.5.2"></sum><apply id="A3.E14.m1.11.11.6.4.4.5.3.cmml" xref="A3.E14.m1.11.11.6.4.4.5.3"><ci id="A3.E14.m1.11.11.6.4.4.5.3.1.cmml" xref="A3.E14.m1.11.11.6.4.4.5.3.1">^</ci><ci id="A3.E14.m1.11.11.6.4.4.5.3.2.cmml" xref="A3.E14.m1.11.11.6.4.4.5.3.2">𝑗</ci></apply></apply><apply id="A3.E14.m1.11.11.6.4.4.6.cmml" xref="A3.E14.m1.11.11.6.4.4.6"><times id="A3.E14.m1.11.11.6.4.4.6.1.cmml" xref="A3.E14.m1.11.11.6.4.4.6.1"></times><apply id="A3.E14.m1.11.11.6.4.4.6.2.cmml" xref="A3.E14.m1.11.11.6.4.4.6.2"><csymbol cd="ambiguous" id="A3.E14.m1.11.11.6.4.4.6.2.1.cmml" xref="A3.E14.m1.11.11.6.4.4.6.2">subscript</csymbol><apply id="A3.E14.m1.11.11.6.4.4.6.2.2.cmml" xref="A3.E14.m1.11.11.6.4.4.6.2"><csymbol cd="ambiguous" id="A3.E14.m1.11.11.6.4.4.6.2.2.1.cmml" xref="A3.E14.m1.11.11.6.4.4.6.2">superscript</csymbol><ci id="A3.E14.m1.11.11.6.4.4.6.2.2.2.cmml" xref="A3.E14.m1.11.11.6.4.4.6.2.2.2">ℰ</ci><plus id="A3.E14.m1.11.11.6.4.4.6.2.2.3.cmml" xref="A3.E14.m1.11.11.6.4.4.6.2.2.3"></plus></apply><ci id="A3.E14.m1.11.11.6.4.4.6.2.3.cmml" xref="A3.E14.m1.11.11.6.4.4.6.2.3">𝑡</ci></apply><interval closure="open" id="A3.E14.m1.11.11.6.4.4.6.3.1.cmml" xref="A3.E14.m1.11.11.6.4.4.6.3.2"><ci id="A3.E14.m1.8.8.3.1.1.1.cmml" xref="A3.E14.m1.8.8.3.1.1.1">𝑖</ci><apply id="A3.E14.m1.9.9.4.2.2.2.cmml" xref="A3.E14.m1.9.9.4.2.2.2"><ci id="A3.E14.m1.9.9.4.2.2.2.1.cmml" xref="A3.E14.m1.9.9.4.2.2.2.1">^</ci><ci id="A3.E14.m1.9.9.4.2.2.2.2.cmml" xref="A3.E14.m1.9.9.4.2.2.2.2">𝑗</ci></apply></interval><apply id="A3.E14.m1.11.11.6.4.4.6.4.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4"><apply id="A3.E14.m1.11.11.6.4.4.6.4.1.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.1"><csymbol cd="ambiguous" id="A3.E14.m1.11.11.6.4.4.6.4.1.1.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.1">subscript</csymbol><sum id="A3.E14.m1.11.11.6.4.4.6.4.1.2.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.1.2"></sum><apply id="A3.E14.m1.11.11.6.4.4.6.4.1.3.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.1.3"><ci id="A3.E14.m1.11.11.6.4.4.6.4.1.3.1.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.1.3.1">^</ci><ci id="A3.E14.m1.11.11.6.4.4.6.4.1.3.2.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.1.3.2">𝑗</ci></apply></apply><apply id="A3.E14.m1.11.11.6.4.4.6.4.2.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.2"><times id="A3.E14.m1.11.11.6.4.4.6.4.2.1.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.2.1"></times><apply id="A3.E14.m1.11.11.6.4.4.6.4.2.2.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.2.2"><csymbol cd="ambiguous" id="A3.E14.m1.11.11.6.4.4.6.4.2.2.1.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.2.2">subscript</csymbol><apply id="A3.E14.m1.11.11.6.4.4.6.4.2.2.2.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.2.2"><csymbol cd="ambiguous" id="A3.E14.m1.11.11.6.4.4.6.4.2.2.2.1.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.2.2">superscript</csymbol><ci id="A3.E14.m1.11.11.6.4.4.6.4.2.2.2.2.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.2.2.2.2">ℰ</ci><plus id="A3.E14.m1.11.11.6.4.4.6.4.2.2.2.3.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.2.2.2.3"></plus></apply><ci id="A3.E14.m1.11.11.6.4.4.6.4.2.2.3.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.2.2.3">𝑡</ci></apply><interval closure="open" id="A3.E14.m1.11.11.6.4.4.6.4.2.3.1.cmml" xref="A3.E14.m1.11.11.6.4.4.6.4.2.3.2"><ci id="A3.E14.m1.10.10.5.3.3.3.cmml" xref="A3.E14.m1.10.10.5.3.3.3">𝑗</ci><apply id="A3.E14.m1.11.11.6.4.4.4.cmml" xref="A3.E14.m1.11.11.6.4.4.4"><ci id="A3.E14.m1.11.11.6.4.4.4.1.cmml" xref="A3.E14.m1.11.11.6.4.4.4.1">^</ci><ci id="A3.E14.m1.11.11.6.4.4.4.2.cmml" xref="A3.E14.m1.11.11.6.4.4.4.2">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply><apply id="A3.E14.m1.13.13.1.1.1.1.1.1.3.cmml" xref="A3.E14.m1.13.13.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E14.m1.13.13.1.1.1.1.1.1.3.1.cmml" xref="A3.E14.m1.13.13.1.1.1.1.1.1.3">subscript</csymbol><apply id="A3.E14.m1.13.13.1.1.1.1.1.1.3.2.cmml" xref="A3.E14.m1.13.13.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E14.m1.13.13.1.1.1.1.1.1.3.2.1.cmml" xref="A3.E14.m1.13.13.1.1.1.1.1.1.3">superscript</csymbol><ci id="A3.E14.m1.13.13.1.1.1.1.1.1.3.2.2.cmml" xref="A3.E14.m1.13.13.1.1.1.1.1.1.3.2.2">𝐞</ci><ci id="A3.E14.m1.12.12.1.1.cmml" xref="A3.E14.m1.12.12.1.1">𝑙</ci></apply><ci id="A3.E14.m1.13.13.1.1.1.1.1.1.3.3.cmml" xref="A3.E14.m1.13.13.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E14.m1.13c">\mathbf{e}^{\!(l\!+\!1\!)}_{i}{=}\sigma(\!\sum_{\!\{j|\mathcal{E}^{+}_{t}(i,j)%
&gt;0\}\!}\!\frac{\mathbf{W}_{a}^{(l)}\mathbf{e}^{(l)}_{j}}{\sqrt{\sum\limits_{%
\hat{j}}\!\mathcal{E}^{+}_{t}\!(i,\hat{j})\!\sum\limits_{\hat{j}}\!\mathcal{E}%
^{+}_{t}\!(j,\hat{j})}}+\mathbf{e}^{(l)}_{i}),</annotation><annotation encoding="application/x-llamapun" id="A3.E14.m1.13d">bold_e start_POSTSUPERSCRIPT ( italic_l + 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_σ ( ∑ start_POSTSUBSCRIPT { italic_j | caligraphic_E start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_i , italic_j ) &gt; 0 } end_POSTSUBSCRIPT divide start_ARG bold_W start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT bold_e start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG ∑ start_POSTSUBSCRIPT over^ start_ARG italic_j end_ARG end_POSTSUBSCRIPT caligraphic_E start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_i , over^ start_ARG italic_j end_ARG ) ∑ start_POSTSUBSCRIPT over^ start_ARG italic_j end_ARG end_POSTSUBSCRIPT caligraphic_E start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_j , over^ start_ARG italic_j end_ARG ) end_ARG end_ARG + bold_e start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p2.20">where <math alttext="\mathbf{W}_{a}^{(l)}\in\mathbb{R}^{d{\times}d}" class="ltx_Math" display="inline" id="A3.p2.14.m1.1"><semantics id="A3.p2.14.m1.1a"><mrow id="A3.p2.14.m1.1.2" xref="A3.p2.14.m1.1.2.cmml"><msubsup id="A3.p2.14.m1.1.2.2" xref="A3.p2.14.m1.1.2.2.cmml"><mi id="A3.p2.14.m1.1.2.2.2.2" xref="A3.p2.14.m1.1.2.2.2.2.cmml">𝐖</mi><mi id="A3.p2.14.m1.1.2.2.2.3" xref="A3.p2.14.m1.1.2.2.2.3.cmml">a</mi><mrow id="A3.p2.14.m1.1.1.1.3" xref="A3.p2.14.m1.1.2.2.cmml"><mo id="A3.p2.14.m1.1.1.1.3.1" stretchy="false" xref="A3.p2.14.m1.1.2.2.cmml">(</mo><mi id="A3.p2.14.m1.1.1.1.1" xref="A3.p2.14.m1.1.1.1.1.cmml">l</mi><mo id="A3.p2.14.m1.1.1.1.3.2" stretchy="false" xref="A3.p2.14.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A3.p2.14.m1.1.2.1" xref="A3.p2.14.m1.1.2.1.cmml">∈</mo><msup id="A3.p2.14.m1.1.2.3" xref="A3.p2.14.m1.1.2.3.cmml"><mi id="A3.p2.14.m1.1.2.3.2" xref="A3.p2.14.m1.1.2.3.2.cmml">ℝ</mi><mrow id="A3.p2.14.m1.1.2.3.3" xref="A3.p2.14.m1.1.2.3.3.cmml"><mi id="A3.p2.14.m1.1.2.3.3.2" xref="A3.p2.14.m1.1.2.3.3.2.cmml">d</mi><mo id="A3.p2.14.m1.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="A3.p2.14.m1.1.2.3.3.1.cmml">×</mo><mi id="A3.p2.14.m1.1.2.3.3.3" xref="A3.p2.14.m1.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.14.m1.1b"><apply id="A3.p2.14.m1.1.2.cmml" xref="A3.p2.14.m1.1.2"><in id="A3.p2.14.m1.1.2.1.cmml" xref="A3.p2.14.m1.1.2.1"></in><apply id="A3.p2.14.m1.1.2.2.cmml" xref="A3.p2.14.m1.1.2.2"><csymbol cd="ambiguous" id="A3.p2.14.m1.1.2.2.1.cmml" xref="A3.p2.14.m1.1.2.2">superscript</csymbol><apply id="A3.p2.14.m1.1.2.2.2.cmml" xref="A3.p2.14.m1.1.2.2"><csymbol cd="ambiguous" id="A3.p2.14.m1.1.2.2.2.1.cmml" xref="A3.p2.14.m1.1.2.2">subscript</csymbol><ci id="A3.p2.14.m1.1.2.2.2.2.cmml" xref="A3.p2.14.m1.1.2.2.2.2">𝐖</ci><ci id="A3.p2.14.m1.1.2.2.2.3.cmml" xref="A3.p2.14.m1.1.2.2.2.3">𝑎</ci></apply><ci id="A3.p2.14.m1.1.1.1.1.cmml" xref="A3.p2.14.m1.1.1.1.1">𝑙</ci></apply><apply id="A3.p2.14.m1.1.2.3.cmml" xref="A3.p2.14.m1.1.2.3"><csymbol cd="ambiguous" id="A3.p2.14.m1.1.2.3.1.cmml" xref="A3.p2.14.m1.1.2.3">superscript</csymbol><ci id="A3.p2.14.m1.1.2.3.2.cmml" xref="A3.p2.14.m1.1.2.3.2">ℝ</ci><apply id="A3.p2.14.m1.1.2.3.3.cmml" xref="A3.p2.14.m1.1.2.3.3"><times id="A3.p2.14.m1.1.2.3.3.1.cmml" xref="A3.p2.14.m1.1.2.3.3.1"></times><ci id="A3.p2.14.m1.1.2.3.3.2.cmml" xref="A3.p2.14.m1.1.2.3.3.2">𝑑</ci><ci id="A3.p2.14.m1.1.2.3.3.3.cmml" xref="A3.p2.14.m1.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.14.m1.1c">\mathbf{W}_{a}^{(l)}\in\mathbb{R}^{d{\times}d}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.14.m1.1d">bold_W start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are the trainable parameters for the <math alttext="l" class="ltx_Math" display="inline" id="A3.p2.15.m2.1"><semantics id="A3.p2.15.m2.1a"><mi id="A3.p2.15.m2.1.1" xref="A3.p2.15.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A3.p2.15.m2.1b"><ci id="A3.p2.15.m2.1.1.cmml" xref="A3.p2.15.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.15.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="A3.p2.15.m2.1d">italic_l</annotation></semantics></math>-th layer, <math alttext="\sigma" class="ltx_Math" display="inline" id="A3.p2.16.m3.1"><semantics id="A3.p2.16.m3.1a"><mi id="A3.p2.16.m3.1.1" xref="A3.p2.16.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="A3.p2.16.m3.1b"><ci id="A3.p2.16.m3.1.1.cmml" xref="A3.p2.16.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.16.m3.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="A3.p2.16.m3.1d">italic_σ</annotation></semantics></math> denotes the LeakyReLU activation function. We stack <math alttext="L_{a}" class="ltx_Math" display="inline" id="A3.p2.17.m4.1"><semantics id="A3.p2.17.m4.1a"><msub id="A3.p2.17.m4.1.1" xref="A3.p2.17.m4.1.1.cmml"><mi id="A3.p2.17.m4.1.1.2" xref="A3.p2.17.m4.1.1.2.cmml">L</mi><mi id="A3.p2.17.m4.1.1.3" xref="A3.p2.17.m4.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p2.17.m4.1b"><apply id="A3.p2.17.m4.1.1.cmml" xref="A3.p2.17.m4.1.1"><csymbol cd="ambiguous" id="A3.p2.17.m4.1.1.1.cmml" xref="A3.p2.17.m4.1.1">subscript</csymbol><ci id="A3.p2.17.m4.1.1.2.cmml" xref="A3.p2.17.m4.1.1.2">𝐿</ci><ci id="A3.p2.17.m4.1.1.3.cmml" xref="A3.p2.17.m4.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.17.m4.1c">L_{a}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.17.m4.1d">italic_L start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> layers of GCNs and fetch the hidden representation <math alttext="\mathbf{e}^{(L_{a})}_{u}" class="ltx_Math" display="inline" id="A3.p2.18.m5.1"><semantics id="A3.p2.18.m5.1a"><msubsup id="A3.p2.18.m5.1.2" xref="A3.p2.18.m5.1.2.cmml"><mi id="A3.p2.18.m5.1.2.2.2" xref="A3.p2.18.m5.1.2.2.2.cmml">𝐞</mi><mi id="A3.p2.18.m5.1.2.3" xref="A3.p2.18.m5.1.2.3.cmml">u</mi><mrow id="A3.p2.18.m5.1.1.1.1" xref="A3.p2.18.m5.1.1.1.1.1.cmml"><mo id="A3.p2.18.m5.1.1.1.1.2" stretchy="false" xref="A3.p2.18.m5.1.1.1.1.1.cmml">(</mo><msub id="A3.p2.18.m5.1.1.1.1.1" xref="A3.p2.18.m5.1.1.1.1.1.cmml"><mi id="A3.p2.18.m5.1.1.1.1.1.2" xref="A3.p2.18.m5.1.1.1.1.1.2.cmml">L</mi><mi id="A3.p2.18.m5.1.1.1.1.1.3" xref="A3.p2.18.m5.1.1.1.1.1.3.cmml">a</mi></msub><mo id="A3.p2.18.m5.1.1.1.1.3" stretchy="false" xref="A3.p2.18.m5.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.p2.18.m5.1b"><apply id="A3.p2.18.m5.1.2.cmml" xref="A3.p2.18.m5.1.2"><csymbol cd="ambiguous" id="A3.p2.18.m5.1.2.1.cmml" xref="A3.p2.18.m5.1.2">subscript</csymbol><apply id="A3.p2.18.m5.1.2.2.cmml" xref="A3.p2.18.m5.1.2"><csymbol cd="ambiguous" id="A3.p2.18.m5.1.2.2.1.cmml" xref="A3.p2.18.m5.1.2">superscript</csymbol><ci id="A3.p2.18.m5.1.2.2.2.cmml" xref="A3.p2.18.m5.1.2.2.2">𝐞</ci><apply id="A3.p2.18.m5.1.1.1.1.1.cmml" xref="A3.p2.18.m5.1.1.1.1"><csymbol cd="ambiguous" id="A3.p2.18.m5.1.1.1.1.1.1.cmml" xref="A3.p2.18.m5.1.1.1.1">subscript</csymbol><ci id="A3.p2.18.m5.1.1.1.1.1.2.cmml" xref="A3.p2.18.m5.1.1.1.1.1.2">𝐿</ci><ci id="A3.p2.18.m5.1.1.1.1.1.3.cmml" xref="A3.p2.18.m5.1.1.1.1.1.3">𝑎</ci></apply></apply><ci id="A3.p2.18.m5.1.2.3.cmml" xref="A3.p2.18.m5.1.2.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.18.m5.1c">\mathbf{e}^{(L_{a})}_{u}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.18.m5.1d">bold_e start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{e}^{(L_{a})}_{v}" class="ltx_Math" display="inline" id="A3.p2.19.m6.1"><semantics id="A3.p2.19.m6.1a"><msubsup id="A3.p2.19.m6.1.2" xref="A3.p2.19.m6.1.2.cmml"><mi id="A3.p2.19.m6.1.2.2.2" xref="A3.p2.19.m6.1.2.2.2.cmml">𝐞</mi><mi id="A3.p2.19.m6.1.2.3" xref="A3.p2.19.m6.1.2.3.cmml">v</mi><mrow id="A3.p2.19.m6.1.1.1.1" xref="A3.p2.19.m6.1.1.1.1.1.cmml"><mo id="A3.p2.19.m6.1.1.1.1.2" stretchy="false" xref="A3.p2.19.m6.1.1.1.1.1.cmml">(</mo><msub id="A3.p2.19.m6.1.1.1.1.1" xref="A3.p2.19.m6.1.1.1.1.1.cmml"><mi id="A3.p2.19.m6.1.1.1.1.1.2" xref="A3.p2.19.m6.1.1.1.1.1.2.cmml">L</mi><mi id="A3.p2.19.m6.1.1.1.1.1.3" xref="A3.p2.19.m6.1.1.1.1.1.3.cmml">a</mi></msub><mo id="A3.p2.19.m6.1.1.1.1.3" stretchy="false" xref="A3.p2.19.m6.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.p2.19.m6.1b"><apply id="A3.p2.19.m6.1.2.cmml" xref="A3.p2.19.m6.1.2"><csymbol cd="ambiguous" id="A3.p2.19.m6.1.2.1.cmml" xref="A3.p2.19.m6.1.2">subscript</csymbol><apply id="A3.p2.19.m6.1.2.2.cmml" xref="A3.p2.19.m6.1.2"><csymbol cd="ambiguous" id="A3.p2.19.m6.1.2.2.1.cmml" xref="A3.p2.19.m6.1.2">superscript</csymbol><ci id="A3.p2.19.m6.1.2.2.2.cmml" xref="A3.p2.19.m6.1.2.2.2">𝐞</ci><apply id="A3.p2.19.m6.1.1.1.1.1.cmml" xref="A3.p2.19.m6.1.1.1.1"><csymbol cd="ambiguous" id="A3.p2.19.m6.1.1.1.1.1.1.cmml" xref="A3.p2.19.m6.1.1.1.1">subscript</csymbol><ci id="A3.p2.19.m6.1.1.1.1.1.2.cmml" xref="A3.p2.19.m6.1.1.1.1.1.2">𝐿</ci><ci id="A3.p2.19.m6.1.1.1.1.1.3.cmml" xref="A3.p2.19.m6.1.1.1.1.1.3">𝑎</ci></apply></apply><ci id="A3.p2.19.m6.1.2.3.cmml" xref="A3.p2.19.m6.1.2.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.19.m6.1c">\mathbf{e}^{(L_{a})}_{v}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.19.m6.1d">bold_e start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>,<math alttext="\mathbf{e}^{(L_{a})}_{p}" class="ltx_Math" display="inline" id="A3.p2.20.m7.1"><semantics id="A3.p2.20.m7.1a"><msubsup id="A3.p2.20.m7.1.2" xref="A3.p2.20.m7.1.2.cmml"><mi id="A3.p2.20.m7.1.2.2.2" xref="A3.p2.20.m7.1.2.2.2.cmml">𝐞</mi><mi id="A3.p2.20.m7.1.2.3" xref="A3.p2.20.m7.1.2.3.cmml">p</mi><mrow id="A3.p2.20.m7.1.1.1.1" xref="A3.p2.20.m7.1.1.1.1.1.cmml"><mo id="A3.p2.20.m7.1.1.1.1.2" stretchy="false" xref="A3.p2.20.m7.1.1.1.1.1.cmml">(</mo><msub id="A3.p2.20.m7.1.1.1.1.1" xref="A3.p2.20.m7.1.1.1.1.1.cmml"><mi id="A3.p2.20.m7.1.1.1.1.1.2" xref="A3.p2.20.m7.1.1.1.1.1.2.cmml">L</mi><mi id="A3.p2.20.m7.1.1.1.1.1.3" xref="A3.p2.20.m7.1.1.1.1.1.3.cmml">a</mi></msub><mo id="A3.p2.20.m7.1.1.1.1.3" stretchy="false" xref="A3.p2.20.m7.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.p2.20.m7.1b"><apply id="A3.p2.20.m7.1.2.cmml" xref="A3.p2.20.m7.1.2"><csymbol cd="ambiguous" id="A3.p2.20.m7.1.2.1.cmml" xref="A3.p2.20.m7.1.2">subscript</csymbol><apply id="A3.p2.20.m7.1.2.2.cmml" xref="A3.p2.20.m7.1.2"><csymbol cd="ambiguous" id="A3.p2.20.m7.1.2.2.1.cmml" xref="A3.p2.20.m7.1.2">superscript</csymbol><ci id="A3.p2.20.m7.1.2.2.2.cmml" xref="A3.p2.20.m7.1.2.2.2">𝐞</ci><apply id="A3.p2.20.m7.1.1.1.1.1.cmml" xref="A3.p2.20.m7.1.1.1.1"><csymbol cd="ambiguous" id="A3.p2.20.m7.1.1.1.1.1.1.cmml" xref="A3.p2.20.m7.1.1.1.1">subscript</csymbol><ci id="A3.p2.20.m7.1.1.1.1.1.2.cmml" xref="A3.p2.20.m7.1.1.1.1.1.2">𝐿</ci><ci id="A3.p2.20.m7.1.1.1.1.1.3.cmml" xref="A3.p2.20.m7.1.1.1.1.1.3">𝑎</ci></apply></apply><ci id="A3.p2.20.m7.1.2.3.cmml" xref="A3.p2.20.m7.1.2.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.20.m7.1c">\mathbf{e}^{(L_{a})}_{p}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.20.m7.1d">bold_e start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> at the last layer as the output of the positive feedback graph encoder.</p>
</div>
<div class="ltx_para" id="A3.p3">
<p class="ltx_p" id="A3.p3.5"><span class="ltx_text ltx_font_bold" id="A3.p3.5.1">Negative feedback graph encoder</span> captures the user’s negative feedback on attribute values and their negative correlations with candidate attribute values/items in the conversation history. Similar to Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A3.E13" title="In Appendix C Details of the State Encoder ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">13</span></a>, for each user <math alttext="u" class="ltx_Math" display="inline" id="A3.p3.1.m1.1"><semantics id="A3.p3.1.m1.1a"><mi id="A3.p3.1.m1.1.1" xref="A3.p3.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A3.p3.1.m1.1b"><ci id="A3.p3.1.m1.1.1.cmml" xref="A3.p3.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="A3.p3.1.m1.1d">italic_u</annotation></semantics></math>, we construct a local negative graph <math alttext="\mathcal{G}^{-}_{t}=&lt;\{u\}\cup\mathcal{P}^{-}_{t}\cup\mathcal{V}^{-}_{t}\cup%
\mathcal{P}^{c}_{t}\cup\mathcal{V}^{c}_{t},\mathcal{E}^{-}_{t}&gt;" class="ltx_math_unparsed" display="inline" id="A3.p3.2.m2.1"><semantics id="A3.p3.2.m2.1a"><mrow id="A3.p3.2.m2.1b"><msubsup id="A3.p3.2.m2.1.2"><mi class="ltx_font_mathcaligraphic" id="A3.p3.2.m2.1.2.2.2">𝒢</mi><mi id="A3.p3.2.m2.1.2.3">t</mi><mo id="A3.p3.2.m2.1.2.2.3">−</mo></msubsup><mo id="A3.p3.2.m2.1.3" rspace="0em">=</mo><mo id="A3.p3.2.m2.1.4" lspace="0em">&lt;</mo><mrow id="A3.p3.2.m2.1.5"><mo id="A3.p3.2.m2.1.5.1" stretchy="false">{</mo><mi id="A3.p3.2.m2.1.1">u</mi><mo id="A3.p3.2.m2.1.5.2" stretchy="false">}</mo></mrow><mo id="A3.p3.2.m2.1.6">∪</mo><msubsup id="A3.p3.2.m2.1.7"><mi class="ltx_font_mathcaligraphic" id="A3.p3.2.m2.1.7.2.2">𝒫</mi><mi id="A3.p3.2.m2.1.7.3">t</mi><mo id="A3.p3.2.m2.1.7.2.3">−</mo></msubsup><mo id="A3.p3.2.m2.1.8">∪</mo><msubsup id="A3.p3.2.m2.1.9"><mi class="ltx_font_mathcaligraphic" id="A3.p3.2.m2.1.9.2.2">𝒱</mi><mi id="A3.p3.2.m2.1.9.3">t</mi><mo id="A3.p3.2.m2.1.9.2.3">−</mo></msubsup><mo id="A3.p3.2.m2.1.10">∪</mo><msubsup id="A3.p3.2.m2.1.11"><mi class="ltx_font_mathcaligraphic" id="A3.p3.2.m2.1.11.2.2">𝒫</mi><mi id="A3.p3.2.m2.1.11.3">t</mi><mi id="A3.p3.2.m2.1.11.2.3">c</mi></msubsup><mo id="A3.p3.2.m2.1.12">∪</mo><msubsup id="A3.p3.2.m2.1.13"><mi class="ltx_font_mathcaligraphic" id="A3.p3.2.m2.1.13.2.2">𝒱</mi><mi id="A3.p3.2.m2.1.13.3">t</mi><mi id="A3.p3.2.m2.1.13.2.3">c</mi></msubsup><mo id="A3.p3.2.m2.1.14">,</mo><msubsup id="A3.p3.2.m2.1.15"><mi class="ltx_font_mathcaligraphic" id="A3.p3.2.m2.1.15.2.2">ℰ</mi><mi id="A3.p3.2.m2.1.15.3">t</mi><mo id="A3.p3.2.m2.1.15.2.3">−</mo></msubsup><mo id="A3.p3.2.m2.1.16">&gt;</mo></mrow><annotation encoding="application/x-tex" id="A3.p3.2.m2.1c">\mathcal{G}^{-}_{t}=&lt;\{u\}\cup\mathcal{P}^{-}_{t}\cup\mathcal{V}^{-}_{t}\cup%
\mathcal{P}^{c}_{t}\cup\mathcal{V}^{c}_{t},\mathcal{E}^{-}_{t}&gt;</annotation><annotation encoding="application/x-llamapun" id="A3.p3.2.m2.1d">caligraphic_G start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = &lt; { italic_u } ∪ caligraphic_P start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∪ caligraphic_V start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∪ caligraphic_P start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∪ caligraphic_V start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_E start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT &gt;</annotation></semantics></math>, where the weight of the edge <math alttext="\mathcal{E}^{(t)}_{i,j}" class="ltx_Math" display="inline" id="A3.p3.3.m3.3"><semantics id="A3.p3.3.m3.3a"><msubsup id="A3.p3.3.m3.3.4" xref="A3.p3.3.m3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p3.3.m3.3.4.2.2" xref="A3.p3.3.m3.3.4.2.2.cmml">ℰ</mi><mrow id="A3.p3.3.m3.3.3.2.4" xref="A3.p3.3.m3.3.3.2.3.cmml"><mi id="A3.p3.3.m3.2.2.1.1" xref="A3.p3.3.m3.2.2.1.1.cmml">i</mi><mo id="A3.p3.3.m3.3.3.2.4.1" xref="A3.p3.3.m3.3.3.2.3.cmml">,</mo><mi id="A3.p3.3.m3.3.3.2.2" xref="A3.p3.3.m3.3.3.2.2.cmml">j</mi></mrow><mrow id="A3.p3.3.m3.1.1.1.3" xref="A3.p3.3.m3.3.4.cmml"><mo id="A3.p3.3.m3.1.1.1.3.1" stretchy="false" xref="A3.p3.3.m3.3.4.cmml">(</mo><mi id="A3.p3.3.m3.1.1.1.1" xref="A3.p3.3.m3.1.1.1.1.cmml">t</mi><mo id="A3.p3.3.m3.1.1.1.3.2" stretchy="false" xref="A3.p3.3.m3.3.4.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.p3.3.m3.3b"><apply id="A3.p3.3.m3.3.4.cmml" xref="A3.p3.3.m3.3.4"><csymbol cd="ambiguous" id="A3.p3.3.m3.3.4.1.cmml" xref="A3.p3.3.m3.3.4">subscript</csymbol><apply id="A3.p3.3.m3.3.4.2.cmml" xref="A3.p3.3.m3.3.4"><csymbol cd="ambiguous" id="A3.p3.3.m3.3.4.2.1.cmml" xref="A3.p3.3.m3.3.4">superscript</csymbol><ci id="A3.p3.3.m3.3.4.2.2.cmml" xref="A3.p3.3.m3.3.4.2.2">ℰ</ci><ci id="A3.p3.3.m3.1.1.1.1.cmml" xref="A3.p3.3.m3.1.1.1.1">𝑡</ci></apply><list id="A3.p3.3.m3.3.3.2.3.cmml" xref="A3.p3.3.m3.3.3.2.4"><ci id="A3.p3.3.m3.2.2.1.1.cmml" xref="A3.p3.3.m3.2.2.1.1">𝑖</ci><ci id="A3.p3.3.m3.3.3.2.2.cmml" xref="A3.p3.3.m3.3.3.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.3.m3.3c">\mathcal{E}^{(t)}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.3.m3.3d">caligraphic_E start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> between node <math alttext="i" class="ltx_Math" display="inline" id="A3.p3.4.m4.1"><semantics id="A3.p3.4.m4.1a"><mi id="A3.p3.4.m4.1.1" xref="A3.p3.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A3.p3.4.m4.1b"><ci id="A3.p3.4.m4.1.1.cmml" xref="A3.p3.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="A3.p3.4.m4.1d">italic_i</annotation></semantics></math> and node <math alttext="j" class="ltx_Math" display="inline" id="A3.p3.5.m5.1"><semantics id="A3.p3.5.m5.1a"><mi id="A3.p3.5.m5.1.1" xref="A3.p3.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A3.p3.5.m5.1b"><ci id="A3.p3.5.m5.1.1.cmml" xref="A3.p3.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.5.m5.1c">j</annotation><annotation encoding="application/x-llamapun" id="A3.p3.5.m5.1d">italic_j</annotation></semantics></math> is constructed from the following rules:</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{E}^{-}_{t}(i,j)=\left\{\begin{array}[]{ll}w^{(t)}_{v},&amp;\mathrm{if}%
\quad i\in\mathcal{U},j\in\mathcal{V}\\
1,&amp;\mathrm{if}\quad i\in\mathcal{V},j\in\mathcal{P}\\
1,&amp;\mathrm{if}\quad i\in\mathcal{U},j\in\mathcal{P}^{-}_{t}\\
0,&amp;\mathrm{otherwise}\end{array}\right.." class="ltx_Math" display="block" id="A3.E15.m1.20"><semantics id="A3.E15.m1.20a"><mrow id="A3.E15.m1.20.20.1" xref="A3.E15.m1.20.20.1.1.cmml"><mrow id="A3.E15.m1.20.20.1.1" xref="A3.E15.m1.20.20.1.1.cmml"><mrow id="A3.E15.m1.20.20.1.1.2" xref="A3.E15.m1.20.20.1.1.2.cmml"><msubsup id="A3.E15.m1.20.20.1.1.2.2" xref="A3.E15.m1.20.20.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E15.m1.20.20.1.1.2.2.2.2" xref="A3.E15.m1.20.20.1.1.2.2.2.2.cmml">ℰ</mi><mi id="A3.E15.m1.20.20.1.1.2.2.3" xref="A3.E15.m1.20.20.1.1.2.2.3.cmml">t</mi><mo id="A3.E15.m1.20.20.1.1.2.2.2.3" xref="A3.E15.m1.20.20.1.1.2.2.2.3.cmml">−</mo></msubsup><mo id="A3.E15.m1.20.20.1.1.2.1" xref="A3.E15.m1.20.20.1.1.2.1.cmml">⁢</mo><mrow id="A3.E15.m1.20.20.1.1.2.3.2" xref="A3.E15.m1.20.20.1.1.2.3.1.cmml"><mo id="A3.E15.m1.20.20.1.1.2.3.2.1" stretchy="false" xref="A3.E15.m1.20.20.1.1.2.3.1.cmml">(</mo><mi id="A3.E15.m1.18.18" xref="A3.E15.m1.18.18.cmml">i</mi><mo id="A3.E15.m1.20.20.1.1.2.3.2.2" xref="A3.E15.m1.20.20.1.1.2.3.1.cmml">,</mo><mi id="A3.E15.m1.19.19" xref="A3.E15.m1.19.19.cmml">j</mi><mo id="A3.E15.m1.20.20.1.1.2.3.2.3" stretchy="false" xref="A3.E15.m1.20.20.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A3.E15.m1.20.20.1.1.1" xref="A3.E15.m1.20.20.1.1.1.cmml">=</mo><mrow id="A3.E15.m1.20.20.1.1.3.2" xref="A3.E15.m1.20.20.1.1.3.1.cmml"><mo id="A3.E15.m1.20.20.1.1.3.2.1" xref="A3.E15.m1.20.20.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="A3.E15.m1.17.17" rowspacing="-3.0pt" xref="A3.E15.m1.17.17.cmml"><mtr id="A3.E15.m1.17.17a" xref="A3.E15.m1.17.17.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E15.m1.17.17b" xref="A3.E15.m1.17.17.cmml"><mrow id="A3.E15.m1.2.2.2.2.2.2" xref="A3.E15.m1.2.2.2.2.2.2.1.cmml"><msubsup id="A3.E15.m1.2.2.2.2.2.2.1" xref="A3.E15.m1.2.2.2.2.2.2.1.cmml"><mi id="A3.E15.m1.2.2.2.2.2.2.1.2.2" xref="A3.E15.m1.2.2.2.2.2.2.1.2.2.cmml">w</mi><mi id="A3.E15.m1.2.2.2.2.2.2.1.3" xref="A3.E15.m1.2.2.2.2.2.2.1.3.cmml">v</mi><mrow id="A3.E15.m1.1.1.1.1.1.1.1.3" xref="A3.E15.m1.2.2.2.2.2.2.1.cmml"><mo id="A3.E15.m1.1.1.1.1.1.1.1.3.1" stretchy="false" xref="A3.E15.m1.2.2.2.2.2.2.1.cmml">(</mo><mi id="A3.E15.m1.1.1.1.1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.1.1.1.1.cmml">t</mi><mo id="A3.E15.m1.1.1.1.1.1.1.1.3.2" stretchy="false" xref="A3.E15.m1.2.2.2.2.2.2.1.cmml">)</mo></mrow></msubsup><mo id="A3.E15.m1.2.2.2.2.2.2.2" xref="A3.E15.m1.2.2.2.2.2.2.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A3.E15.m1.17.17c" xref="A3.E15.m1.17.17.cmml"><mrow id="A3.E15.m1.6.6.6.6.4.4" xref="A3.E15.m1.6.6.6.6.4.5.cmml"><mrow id="A3.E15.m1.5.5.5.5.3.3.1" xref="A3.E15.m1.5.5.5.5.3.3.1.cmml"><mrow id="A3.E15.m1.5.5.5.5.3.3.1.2.2" xref="A3.E15.m1.5.5.5.5.3.3.1.2.1.cmml"><mi id="A3.E15.m1.3.3.3.3.1.1" xref="A3.E15.m1.3.3.3.3.1.1.cmml">if</mi><mspace id="A3.E15.m1.5.5.5.5.3.3.1.2.2.1" width="1em" xref="A3.E15.m1.5.5.5.5.3.3.1.2.1.cmml"></mspace><mi id="A3.E15.m1.4.4.4.4.2.2" xref="A3.E15.m1.4.4.4.4.2.2.cmml">i</mi></mrow><mo id="A3.E15.m1.5.5.5.5.3.3.1.1" xref="A3.E15.m1.5.5.5.5.3.3.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E15.m1.5.5.5.5.3.3.1.3" xref="A3.E15.m1.5.5.5.5.3.3.1.3.cmml">𝒰</mi></mrow><mo id="A3.E15.m1.6.6.6.6.4.4.3" xref="A3.E15.m1.6.6.6.6.4.5a.cmml">,</mo><mrow id="A3.E15.m1.6.6.6.6.4.4.2" xref="A3.E15.m1.6.6.6.6.4.4.2.cmml"><mi id="A3.E15.m1.6.6.6.6.4.4.2.2" xref="A3.E15.m1.6.6.6.6.4.4.2.2.cmml">j</mi><mo id="A3.E15.m1.6.6.6.6.4.4.2.1" xref="A3.E15.m1.6.6.6.6.4.4.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E15.m1.6.6.6.6.4.4.2.3" xref="A3.E15.m1.6.6.6.6.4.4.2.3.cmml">𝒱</mi></mrow></mrow></mtd></mtr><mtr id="A3.E15.m1.17.17d" xref="A3.E15.m1.17.17.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E15.m1.17.17e" xref="A3.E15.m1.17.17.cmml"><mrow id="A3.E15.m1.7.7.7.1.1.3" xref="A3.E15.m1.17.17.cmml"><mn id="A3.E15.m1.7.7.7.1.1.1" xref="A3.E15.m1.7.7.7.1.1.1.cmml">1</mn><mo id="A3.E15.m1.7.7.7.1.1.3.1" xref="A3.E15.m1.17.17.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A3.E15.m1.17.17f" xref="A3.E15.m1.17.17.cmml"><mrow id="A3.E15.m1.11.11.11.5.4.4" xref="A3.E15.m1.11.11.11.5.4.5.cmml"><mrow id="A3.E15.m1.10.10.10.4.3.3.1" xref="A3.E15.m1.10.10.10.4.3.3.1.cmml"><mrow id="A3.E15.m1.10.10.10.4.3.3.1.2.2" xref="A3.E15.m1.10.10.10.4.3.3.1.2.1.cmml"><mi id="A3.E15.m1.8.8.8.2.1.1" xref="A3.E15.m1.8.8.8.2.1.1.cmml">if</mi><mspace id="A3.E15.m1.10.10.10.4.3.3.1.2.2.1" width="1em" xref="A3.E15.m1.10.10.10.4.3.3.1.2.1.cmml"></mspace><mi id="A3.E15.m1.9.9.9.3.2.2" xref="A3.E15.m1.9.9.9.3.2.2.cmml">i</mi></mrow><mo id="A3.E15.m1.10.10.10.4.3.3.1.1" xref="A3.E15.m1.10.10.10.4.3.3.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E15.m1.10.10.10.4.3.3.1.3" xref="A3.E15.m1.10.10.10.4.3.3.1.3.cmml">𝒱</mi></mrow><mo id="A3.E15.m1.11.11.11.5.4.4.3" xref="A3.E15.m1.11.11.11.5.4.5a.cmml">,</mo><mrow id="A3.E15.m1.11.11.11.5.4.4.2" xref="A3.E15.m1.11.11.11.5.4.4.2.cmml"><mi id="A3.E15.m1.11.11.11.5.4.4.2.2" xref="A3.E15.m1.11.11.11.5.4.4.2.2.cmml">j</mi><mo id="A3.E15.m1.11.11.11.5.4.4.2.1" xref="A3.E15.m1.11.11.11.5.4.4.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E15.m1.11.11.11.5.4.4.2.3" xref="A3.E15.m1.11.11.11.5.4.4.2.3.cmml">𝒫</mi></mrow></mrow></mtd></mtr><mtr id="A3.E15.m1.17.17g" xref="A3.E15.m1.17.17.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E15.m1.17.17h" xref="A3.E15.m1.17.17.cmml"><mrow id="A3.E15.m1.12.12.12.1.1.3" xref="A3.E15.m1.17.17.cmml"><mn id="A3.E15.m1.12.12.12.1.1.1" xref="A3.E15.m1.12.12.12.1.1.1.cmml">1</mn><mo id="A3.E15.m1.12.12.12.1.1.3.1" xref="A3.E15.m1.17.17.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A3.E15.m1.17.17i" xref="A3.E15.m1.17.17.cmml"><mrow id="A3.E15.m1.16.16.16.5.4.4" xref="A3.E15.m1.16.16.16.5.4.5.cmml"><mrow id="A3.E15.m1.15.15.15.4.3.3.1" xref="A3.E15.m1.15.15.15.4.3.3.1.cmml"><mrow id="A3.E15.m1.15.15.15.4.3.3.1.2.2" xref="A3.E15.m1.15.15.15.4.3.3.1.2.1.cmml"><mi id="A3.E15.m1.13.13.13.2.1.1" xref="A3.E15.m1.13.13.13.2.1.1.cmml">if</mi><mspace id="A3.E15.m1.15.15.15.4.3.3.1.2.2.1" width="1em" xref="A3.E15.m1.15.15.15.4.3.3.1.2.1.cmml"></mspace><mi id="A3.E15.m1.14.14.14.3.2.2" xref="A3.E15.m1.14.14.14.3.2.2.cmml">i</mi></mrow><mo id="A3.E15.m1.15.15.15.4.3.3.1.1" xref="A3.E15.m1.15.15.15.4.3.3.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A3.E15.m1.15.15.15.4.3.3.1.3" xref="A3.E15.m1.15.15.15.4.3.3.1.3.cmml">𝒰</mi></mrow><mo id="A3.E15.m1.16.16.16.5.4.4.3" xref="A3.E15.m1.16.16.16.5.4.5a.cmml">,</mo><mrow id="A3.E15.m1.16.16.16.5.4.4.2" xref="A3.E15.m1.16.16.16.5.4.4.2.cmml"><mi id="A3.E15.m1.16.16.16.5.4.4.2.2" xref="A3.E15.m1.16.16.16.5.4.4.2.2.cmml">j</mi><mo id="A3.E15.m1.16.16.16.5.4.4.2.1" xref="A3.E15.m1.16.16.16.5.4.4.2.1.cmml">∈</mo><msubsup id="A3.E15.m1.16.16.16.5.4.4.2.3" xref="A3.E15.m1.16.16.16.5.4.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E15.m1.16.16.16.5.4.4.2.3.2.2" xref="A3.E15.m1.16.16.16.5.4.4.2.3.2.2.cmml">𝒫</mi><mi id="A3.E15.m1.16.16.16.5.4.4.2.3.3" xref="A3.E15.m1.16.16.16.5.4.4.2.3.3.cmml">t</mi><mo id="A3.E15.m1.16.16.16.5.4.4.2.3.2.3" xref="A3.E15.m1.16.16.16.5.4.4.2.3.2.3.cmml">−</mo></msubsup></mrow></mrow></mtd></mtr><mtr id="A3.E15.m1.17.17j" xref="A3.E15.m1.17.17.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E15.m1.17.17k" xref="A3.E15.m1.17.17.cmml"><mrow id="A3.E15.m1.17.17.17.1.1.3" xref="A3.E15.m1.17.17.cmml"><mn id="A3.E15.m1.17.17.17.1.1.1" xref="A3.E15.m1.17.17.17.1.1.1.cmml">0</mn><mo id="A3.E15.m1.17.17.17.1.1.3.1" xref="A3.E15.m1.17.17.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A3.E15.m1.17.17l" xref="A3.E15.m1.17.17.cmml"><mi id="A3.E15.m1.17.17.17.2.1" xref="A3.E15.m1.17.17.17.2.1.cmml">otherwise</mi></mtd></mtr></mtable><mi id="A3.E15.m1.20.20.1.1.3.2.2" xref="A3.E15.m1.20.20.1.1.3.1.1.cmml"></mi></mrow></mrow><mo id="A3.E15.m1.20.20.1.2" lspace="0em" xref="A3.E15.m1.20.20.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E15.m1.20b"><apply id="A3.E15.m1.20.20.1.1.cmml" xref="A3.E15.m1.20.20.1"><eq id="A3.E15.m1.20.20.1.1.1.cmml" xref="A3.E15.m1.20.20.1.1.1"></eq><apply id="A3.E15.m1.20.20.1.1.2.cmml" xref="A3.E15.m1.20.20.1.1.2"><times id="A3.E15.m1.20.20.1.1.2.1.cmml" xref="A3.E15.m1.20.20.1.1.2.1"></times><apply id="A3.E15.m1.20.20.1.1.2.2.cmml" xref="A3.E15.m1.20.20.1.1.2.2"><csymbol cd="ambiguous" id="A3.E15.m1.20.20.1.1.2.2.1.cmml" xref="A3.E15.m1.20.20.1.1.2.2">subscript</csymbol><apply id="A3.E15.m1.20.20.1.1.2.2.2.cmml" xref="A3.E15.m1.20.20.1.1.2.2"><csymbol cd="ambiguous" id="A3.E15.m1.20.20.1.1.2.2.2.1.cmml" xref="A3.E15.m1.20.20.1.1.2.2">superscript</csymbol><ci id="A3.E15.m1.20.20.1.1.2.2.2.2.cmml" xref="A3.E15.m1.20.20.1.1.2.2.2.2">ℰ</ci><minus id="A3.E15.m1.20.20.1.1.2.2.2.3.cmml" xref="A3.E15.m1.20.20.1.1.2.2.2.3"></minus></apply><ci id="A3.E15.m1.20.20.1.1.2.2.3.cmml" xref="A3.E15.m1.20.20.1.1.2.2.3">𝑡</ci></apply><interval closure="open" id="A3.E15.m1.20.20.1.1.2.3.1.cmml" xref="A3.E15.m1.20.20.1.1.2.3.2"><ci id="A3.E15.m1.18.18.cmml" xref="A3.E15.m1.18.18">𝑖</ci><ci id="A3.E15.m1.19.19.cmml" xref="A3.E15.m1.19.19">𝑗</ci></interval></apply><apply id="A3.E15.m1.20.20.1.1.3.1.cmml" xref="A3.E15.m1.20.20.1.1.3.2"><csymbol cd="latexml" id="A3.E15.m1.20.20.1.1.3.1.1.cmml" xref="A3.E15.m1.20.20.1.1.3.2.1">cases</csymbol><matrix id="A3.E15.m1.17.17.cmml" xref="A3.E15.m1.17.17"><matrixrow id="A3.E15.m1.17.17a.cmml" xref="A3.E15.m1.17.17"><apply id="A3.E15.m1.2.2.2.2.2.2.1.cmml" xref="A3.E15.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E15.m1.2.2.2.2.2.2.1.1.cmml" xref="A3.E15.m1.2.2.2.2.2.2">subscript</csymbol><apply id="A3.E15.m1.2.2.2.2.2.2.1.2.cmml" xref="A3.E15.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E15.m1.2.2.2.2.2.2.1.2.1.cmml" xref="A3.E15.m1.2.2.2.2.2.2">superscript</csymbol><ci id="A3.E15.m1.2.2.2.2.2.2.1.2.2.cmml" xref="A3.E15.m1.2.2.2.2.2.2.1.2.2">𝑤</ci><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1">𝑡</ci></apply><ci id="A3.E15.m1.2.2.2.2.2.2.1.3.cmml" xref="A3.E15.m1.2.2.2.2.2.2.1.3">𝑣</ci></apply><apply id="A3.E15.m1.6.6.6.6.4.5.cmml" xref="A3.E15.m1.6.6.6.6.4.4"><csymbol cd="ambiguous" id="A3.E15.m1.6.6.6.6.4.5a.cmml" xref="A3.E15.m1.6.6.6.6.4.4.3">formulae-sequence</csymbol><apply id="A3.E15.m1.5.5.5.5.3.3.1.cmml" xref="A3.E15.m1.5.5.5.5.3.3.1"><in id="A3.E15.m1.5.5.5.5.3.3.1.1.cmml" xref="A3.E15.m1.5.5.5.5.3.3.1.1"></in><list id="A3.E15.m1.5.5.5.5.3.3.1.2.1.cmml" xref="A3.E15.m1.5.5.5.5.3.3.1.2.2"><ci id="A3.E15.m1.3.3.3.3.1.1.cmml" xref="A3.E15.m1.3.3.3.3.1.1">if</ci><ci id="A3.E15.m1.4.4.4.4.2.2.cmml" xref="A3.E15.m1.4.4.4.4.2.2">𝑖</ci></list><ci id="A3.E15.m1.5.5.5.5.3.3.1.3.cmml" xref="A3.E15.m1.5.5.5.5.3.3.1.3">𝒰</ci></apply><apply id="A3.E15.m1.6.6.6.6.4.4.2.cmml" xref="A3.E15.m1.6.6.6.6.4.4.2"><in id="A3.E15.m1.6.6.6.6.4.4.2.1.cmml" xref="A3.E15.m1.6.6.6.6.4.4.2.1"></in><ci id="A3.E15.m1.6.6.6.6.4.4.2.2.cmml" xref="A3.E15.m1.6.6.6.6.4.4.2.2">𝑗</ci><ci id="A3.E15.m1.6.6.6.6.4.4.2.3.cmml" xref="A3.E15.m1.6.6.6.6.4.4.2.3">𝒱</ci></apply></apply></matrixrow><matrixrow id="A3.E15.m1.17.17b.cmml" xref="A3.E15.m1.17.17"><cn id="A3.E15.m1.7.7.7.1.1.1.cmml" type="integer" xref="A3.E15.m1.7.7.7.1.1.1">1</cn><apply id="A3.E15.m1.11.11.11.5.4.5.cmml" xref="A3.E15.m1.11.11.11.5.4.4"><csymbol cd="ambiguous" id="A3.E15.m1.11.11.11.5.4.5a.cmml" xref="A3.E15.m1.11.11.11.5.4.4.3">formulae-sequence</csymbol><apply id="A3.E15.m1.10.10.10.4.3.3.1.cmml" xref="A3.E15.m1.10.10.10.4.3.3.1"><in id="A3.E15.m1.10.10.10.4.3.3.1.1.cmml" xref="A3.E15.m1.10.10.10.4.3.3.1.1"></in><list id="A3.E15.m1.10.10.10.4.3.3.1.2.1.cmml" xref="A3.E15.m1.10.10.10.4.3.3.1.2.2"><ci id="A3.E15.m1.8.8.8.2.1.1.cmml" xref="A3.E15.m1.8.8.8.2.1.1">if</ci><ci id="A3.E15.m1.9.9.9.3.2.2.cmml" xref="A3.E15.m1.9.9.9.3.2.2">𝑖</ci></list><ci id="A3.E15.m1.10.10.10.4.3.3.1.3.cmml" xref="A3.E15.m1.10.10.10.4.3.3.1.3">𝒱</ci></apply><apply id="A3.E15.m1.11.11.11.5.4.4.2.cmml" xref="A3.E15.m1.11.11.11.5.4.4.2"><in id="A3.E15.m1.11.11.11.5.4.4.2.1.cmml" xref="A3.E15.m1.11.11.11.5.4.4.2.1"></in><ci id="A3.E15.m1.11.11.11.5.4.4.2.2.cmml" xref="A3.E15.m1.11.11.11.5.4.4.2.2">𝑗</ci><ci id="A3.E15.m1.11.11.11.5.4.4.2.3.cmml" xref="A3.E15.m1.11.11.11.5.4.4.2.3">𝒫</ci></apply></apply></matrixrow><matrixrow id="A3.E15.m1.17.17c.cmml" xref="A3.E15.m1.17.17"><cn id="A3.E15.m1.12.12.12.1.1.1.cmml" type="integer" xref="A3.E15.m1.12.12.12.1.1.1">1</cn><apply id="A3.E15.m1.16.16.16.5.4.5.cmml" xref="A3.E15.m1.16.16.16.5.4.4"><csymbol cd="ambiguous" id="A3.E15.m1.16.16.16.5.4.5a.cmml" xref="A3.E15.m1.16.16.16.5.4.4.3">formulae-sequence</csymbol><apply id="A3.E15.m1.15.15.15.4.3.3.1.cmml" xref="A3.E15.m1.15.15.15.4.3.3.1"><in id="A3.E15.m1.15.15.15.4.3.3.1.1.cmml" xref="A3.E15.m1.15.15.15.4.3.3.1.1"></in><list id="A3.E15.m1.15.15.15.4.3.3.1.2.1.cmml" xref="A3.E15.m1.15.15.15.4.3.3.1.2.2"><ci id="A3.E15.m1.13.13.13.2.1.1.cmml" xref="A3.E15.m1.13.13.13.2.1.1">if</ci><ci id="A3.E15.m1.14.14.14.3.2.2.cmml" xref="A3.E15.m1.14.14.14.3.2.2">𝑖</ci></list><ci id="A3.E15.m1.15.15.15.4.3.3.1.3.cmml" xref="A3.E15.m1.15.15.15.4.3.3.1.3">𝒰</ci></apply><apply id="A3.E15.m1.16.16.16.5.4.4.2.cmml" xref="A3.E15.m1.16.16.16.5.4.4.2"><in id="A3.E15.m1.16.16.16.5.4.4.2.1.cmml" xref="A3.E15.m1.16.16.16.5.4.4.2.1"></in><ci id="A3.E15.m1.16.16.16.5.4.4.2.2.cmml" xref="A3.E15.m1.16.16.16.5.4.4.2.2">𝑗</ci><apply id="A3.E15.m1.16.16.16.5.4.4.2.3.cmml" xref="A3.E15.m1.16.16.16.5.4.4.2.3"><csymbol cd="ambiguous" id="A3.E15.m1.16.16.16.5.4.4.2.3.1.cmml" xref="A3.E15.m1.16.16.16.5.4.4.2.3">subscript</csymbol><apply id="A3.E15.m1.16.16.16.5.4.4.2.3.2.cmml" xref="A3.E15.m1.16.16.16.5.4.4.2.3"><csymbol cd="ambiguous" id="A3.E15.m1.16.16.16.5.4.4.2.3.2.1.cmml" xref="A3.E15.m1.16.16.16.5.4.4.2.3">superscript</csymbol><ci id="A3.E15.m1.16.16.16.5.4.4.2.3.2.2.cmml" xref="A3.E15.m1.16.16.16.5.4.4.2.3.2.2">𝒫</ci><minus id="A3.E15.m1.16.16.16.5.4.4.2.3.2.3.cmml" xref="A3.E15.m1.16.16.16.5.4.4.2.3.2.3"></minus></apply><ci id="A3.E15.m1.16.16.16.5.4.4.2.3.3.cmml" xref="A3.E15.m1.16.16.16.5.4.4.2.3.3">𝑡</ci></apply></apply></apply></matrixrow><matrixrow id="A3.E15.m1.17.17d.cmml" xref="A3.E15.m1.17.17"><cn id="A3.E15.m1.17.17.17.1.1.1.cmml" type="integer" xref="A3.E15.m1.17.17.17.1.1.1">0</cn><ci id="A3.E15.m1.17.17.17.2.1.cmml" xref="A3.E15.m1.17.17.17.2.1">otherwise</ci></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E15.m1.20c">\mathcal{E}^{-}_{t}(i,j)=\left\{\begin{array}[]{ll}w^{(t)}_{v},&amp;\mathrm{if}%
\quad i\in\mathcal{U},j\in\mathcal{V}\\
1,&amp;\mathrm{if}\quad i\in\mathcal{V},j\in\mathcal{P}\\
1,&amp;\mathrm{if}\quad i\in\mathcal{U},j\in\mathcal{P}^{-}_{t}\\
0,&amp;\mathrm{otherwise}\end{array}\right..</annotation><annotation encoding="application/x-llamapun" id="A3.E15.m1.20d">caligraphic_E start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_i , italic_j ) = { start_ARRAY start_ROW start_CELL italic_w start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , end_CELL start_CELL roman_if italic_i ∈ caligraphic_U , italic_j ∈ caligraphic_V end_CELL end_ROW start_ROW start_CELL 1 , end_CELL start_CELL roman_if italic_i ∈ caligraphic_V , italic_j ∈ caligraphic_P end_CELL end_ROW start_ROW start_CELL 1 , end_CELL start_CELL roman_if italic_i ∈ caligraphic_U , italic_j ∈ caligraphic_P start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL 0 , end_CELL start_CELL roman_otherwise end_CELL end_ROW end_ARRAY .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p3.9">We then stack <math alttext="L_{n}" class="ltx_Math" display="inline" id="A3.p3.6.m1.1"><semantics id="A3.p3.6.m1.1a"><msub id="A3.p3.6.m1.1.1" xref="A3.p3.6.m1.1.1.cmml"><mi id="A3.p3.6.m1.1.1.2" xref="A3.p3.6.m1.1.1.2.cmml">L</mi><mi id="A3.p3.6.m1.1.1.3" xref="A3.p3.6.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p3.6.m1.1b"><apply id="A3.p3.6.m1.1.1.cmml" xref="A3.p3.6.m1.1.1"><csymbol cd="ambiguous" id="A3.p3.6.m1.1.1.1.cmml" xref="A3.p3.6.m1.1.1">subscript</csymbol><ci id="A3.p3.6.m1.1.1.2.cmml" xref="A3.p3.6.m1.1.1.2">𝐿</ci><ci id="A3.p3.6.m1.1.1.3.cmml" xref="A3.p3.6.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.6.m1.1c">L_{n}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.6.m1.1d">italic_L start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> layers of GCNs similar to Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A3.E14" title="In Appendix C Details of the State Encoder ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">14</span></a>, and fetch the hidden representation <math alttext="\mathbf{e}^{(L_{n})}_{u}" class="ltx_Math" display="inline" id="A3.p3.7.m2.1"><semantics id="A3.p3.7.m2.1a"><msubsup id="A3.p3.7.m2.1.2" xref="A3.p3.7.m2.1.2.cmml"><mi id="A3.p3.7.m2.1.2.2.2" xref="A3.p3.7.m2.1.2.2.2.cmml">𝐞</mi><mi id="A3.p3.7.m2.1.2.3" xref="A3.p3.7.m2.1.2.3.cmml">u</mi><mrow id="A3.p3.7.m2.1.1.1.1" xref="A3.p3.7.m2.1.1.1.1.1.cmml"><mo id="A3.p3.7.m2.1.1.1.1.2" stretchy="false" xref="A3.p3.7.m2.1.1.1.1.1.cmml">(</mo><msub id="A3.p3.7.m2.1.1.1.1.1" xref="A3.p3.7.m2.1.1.1.1.1.cmml"><mi id="A3.p3.7.m2.1.1.1.1.1.2" xref="A3.p3.7.m2.1.1.1.1.1.2.cmml">L</mi><mi id="A3.p3.7.m2.1.1.1.1.1.3" xref="A3.p3.7.m2.1.1.1.1.1.3.cmml">n</mi></msub><mo id="A3.p3.7.m2.1.1.1.1.3" stretchy="false" xref="A3.p3.7.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.p3.7.m2.1b"><apply id="A3.p3.7.m2.1.2.cmml" xref="A3.p3.7.m2.1.2"><csymbol cd="ambiguous" id="A3.p3.7.m2.1.2.1.cmml" xref="A3.p3.7.m2.1.2">subscript</csymbol><apply id="A3.p3.7.m2.1.2.2.cmml" xref="A3.p3.7.m2.1.2"><csymbol cd="ambiguous" id="A3.p3.7.m2.1.2.2.1.cmml" xref="A3.p3.7.m2.1.2">superscript</csymbol><ci id="A3.p3.7.m2.1.2.2.2.cmml" xref="A3.p3.7.m2.1.2.2.2">𝐞</ci><apply id="A3.p3.7.m2.1.1.1.1.1.cmml" xref="A3.p3.7.m2.1.1.1.1"><csymbol cd="ambiguous" id="A3.p3.7.m2.1.1.1.1.1.1.cmml" xref="A3.p3.7.m2.1.1.1.1">subscript</csymbol><ci id="A3.p3.7.m2.1.1.1.1.1.2.cmml" xref="A3.p3.7.m2.1.1.1.1.1.2">𝐿</ci><ci id="A3.p3.7.m2.1.1.1.1.1.3.cmml" xref="A3.p3.7.m2.1.1.1.1.1.3">𝑛</ci></apply></apply><ci id="A3.p3.7.m2.1.2.3.cmml" xref="A3.p3.7.m2.1.2.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.7.m2.1c">\mathbf{e}^{(L_{n})}_{u}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.7.m2.1d">bold_e start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{e}^{(L_{n})}_{v}" class="ltx_Math" display="inline" id="A3.p3.8.m3.1"><semantics id="A3.p3.8.m3.1a"><msubsup id="A3.p3.8.m3.1.2" xref="A3.p3.8.m3.1.2.cmml"><mi id="A3.p3.8.m3.1.2.2.2" xref="A3.p3.8.m3.1.2.2.2.cmml">𝐞</mi><mi id="A3.p3.8.m3.1.2.3" xref="A3.p3.8.m3.1.2.3.cmml">v</mi><mrow id="A3.p3.8.m3.1.1.1.1" xref="A3.p3.8.m3.1.1.1.1.1.cmml"><mo id="A3.p3.8.m3.1.1.1.1.2" stretchy="false" xref="A3.p3.8.m3.1.1.1.1.1.cmml">(</mo><msub id="A3.p3.8.m3.1.1.1.1.1" xref="A3.p3.8.m3.1.1.1.1.1.cmml"><mi id="A3.p3.8.m3.1.1.1.1.1.2" xref="A3.p3.8.m3.1.1.1.1.1.2.cmml">L</mi><mi id="A3.p3.8.m3.1.1.1.1.1.3" xref="A3.p3.8.m3.1.1.1.1.1.3.cmml">n</mi></msub><mo id="A3.p3.8.m3.1.1.1.1.3" stretchy="false" xref="A3.p3.8.m3.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.p3.8.m3.1b"><apply id="A3.p3.8.m3.1.2.cmml" xref="A3.p3.8.m3.1.2"><csymbol cd="ambiguous" id="A3.p3.8.m3.1.2.1.cmml" xref="A3.p3.8.m3.1.2">subscript</csymbol><apply id="A3.p3.8.m3.1.2.2.cmml" xref="A3.p3.8.m3.1.2"><csymbol cd="ambiguous" id="A3.p3.8.m3.1.2.2.1.cmml" xref="A3.p3.8.m3.1.2">superscript</csymbol><ci id="A3.p3.8.m3.1.2.2.2.cmml" xref="A3.p3.8.m3.1.2.2.2">𝐞</ci><apply id="A3.p3.8.m3.1.1.1.1.1.cmml" xref="A3.p3.8.m3.1.1.1.1"><csymbol cd="ambiguous" id="A3.p3.8.m3.1.1.1.1.1.1.cmml" xref="A3.p3.8.m3.1.1.1.1">subscript</csymbol><ci id="A3.p3.8.m3.1.1.1.1.1.2.cmml" xref="A3.p3.8.m3.1.1.1.1.1.2">𝐿</ci><ci id="A3.p3.8.m3.1.1.1.1.1.3.cmml" xref="A3.p3.8.m3.1.1.1.1.1.3">𝑛</ci></apply></apply><ci id="A3.p3.8.m3.1.2.3.cmml" xref="A3.p3.8.m3.1.2.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.8.m3.1c">\mathbf{e}^{(L_{n})}_{v}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.8.m3.1d">bold_e start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>,<math alttext="\mathbf{e}^{(L_{n})}_{p}" class="ltx_Math" display="inline" id="A3.p3.9.m4.1"><semantics id="A3.p3.9.m4.1a"><msubsup id="A3.p3.9.m4.1.2" xref="A3.p3.9.m4.1.2.cmml"><mi id="A3.p3.9.m4.1.2.2.2" xref="A3.p3.9.m4.1.2.2.2.cmml">𝐞</mi><mi id="A3.p3.9.m4.1.2.3" xref="A3.p3.9.m4.1.2.3.cmml">p</mi><mrow id="A3.p3.9.m4.1.1.1.1" xref="A3.p3.9.m4.1.1.1.1.1.cmml"><mo id="A3.p3.9.m4.1.1.1.1.2" stretchy="false" xref="A3.p3.9.m4.1.1.1.1.1.cmml">(</mo><msub id="A3.p3.9.m4.1.1.1.1.1" xref="A3.p3.9.m4.1.1.1.1.1.cmml"><mi id="A3.p3.9.m4.1.1.1.1.1.2" xref="A3.p3.9.m4.1.1.1.1.1.2.cmml">L</mi><mi id="A3.p3.9.m4.1.1.1.1.1.3" xref="A3.p3.9.m4.1.1.1.1.1.3.cmml">n</mi></msub><mo id="A3.p3.9.m4.1.1.1.1.3" stretchy="false" xref="A3.p3.9.m4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.p3.9.m4.1b"><apply id="A3.p3.9.m4.1.2.cmml" xref="A3.p3.9.m4.1.2"><csymbol cd="ambiguous" id="A3.p3.9.m4.1.2.1.cmml" xref="A3.p3.9.m4.1.2">subscript</csymbol><apply id="A3.p3.9.m4.1.2.2.cmml" xref="A3.p3.9.m4.1.2"><csymbol cd="ambiguous" id="A3.p3.9.m4.1.2.2.1.cmml" xref="A3.p3.9.m4.1.2">superscript</csymbol><ci id="A3.p3.9.m4.1.2.2.2.cmml" xref="A3.p3.9.m4.1.2.2.2">𝐞</ci><apply id="A3.p3.9.m4.1.1.1.1.1.cmml" xref="A3.p3.9.m4.1.1.1.1"><csymbol cd="ambiguous" id="A3.p3.9.m4.1.1.1.1.1.1.cmml" xref="A3.p3.9.m4.1.1.1.1">subscript</csymbol><ci id="A3.p3.9.m4.1.1.1.1.1.2.cmml" xref="A3.p3.9.m4.1.1.1.1.1.2">𝐿</ci><ci id="A3.p3.9.m4.1.1.1.1.1.3.cmml" xref="A3.p3.9.m4.1.1.1.1.1.3">𝑛</ci></apply></apply><ci id="A3.p3.9.m4.1.2.3.cmml" xref="A3.p3.9.m4.1.2.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.9.m4.1c">\mathbf{e}^{(L_{n})}_{p}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.9.m4.1d">bold_e start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> at the last layer as the output of the negative feedback graph encoder.</p>
</div>
<div class="ltx_para" id="A3.p4">
<p class="ltx_p" id="A3.p4.8"><span class="ltx_text ltx_font_bold" id="A3.p4.8.1">Transformer-based aggregator</span> fuses the information from the graph encoders, and captures the sequential relationships among items and attribute values mentioned in the conversation history. Specifically, for the accepted/rejected attribute values/items at previous conversational turns, we first project the accepted ones and rejected ones into different spaces to distinguish between the positive and the negative feedbacks:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="A6.EGx2">
<tbody id="A3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{e}^{{}^{\prime}}_{p}=\mathbf{W}_{a}\mathbf{e}^{(L_{a})}_{%
p}{+}\mathbf{b}_{a}\thinspace\thinspace\mathrm{or}\thinspace\thinspace\mathbf{%
e}^{{}^{\prime}}_{p}=\mathbf{W}_{n}\mathbf{e}^{(L_{n})}_{p}{+}\mathbf{b}_{n}" class="ltx_Math" display="block" id="A3.Ex4.m1.2"><semantics id="A3.Ex4.m1.2a"><mrow id="A3.Ex4.m1.2.3" xref="A3.Ex4.m1.2.3.cmml"><msubsup id="A3.Ex4.m1.2.3.2" xref="A3.Ex4.m1.2.3.2.cmml"><mi id="A3.Ex4.m1.2.3.2.2.2" xref="A3.Ex4.m1.2.3.2.2.2.cmml">𝐞</mi><mi id="A3.Ex4.m1.2.3.2.3" xref="A3.Ex4.m1.2.3.2.3.cmml">p</mi><msup id="A3.Ex4.m1.2.3.2.2.3" xref="A3.Ex4.m1.2.3.2.2.3.cmml"><mi id="A3.Ex4.m1.2.3.2.2.3a" xref="A3.Ex4.m1.2.3.2.2.3.cmml"></mi><mo id="A3.Ex4.m1.2.3.2.2.3.1" xref="A3.Ex4.m1.2.3.2.2.3.1.cmml">′</mo></msup></msubsup><mo id="A3.Ex4.m1.2.3.3" xref="A3.Ex4.m1.2.3.3.cmml">=</mo><mrow id="A3.Ex4.m1.2.3.4" xref="A3.Ex4.m1.2.3.4.cmml"><mrow id="A3.Ex4.m1.2.3.4.2" xref="A3.Ex4.m1.2.3.4.2.cmml"><msub id="A3.Ex4.m1.2.3.4.2.2" xref="A3.Ex4.m1.2.3.4.2.2.cmml"><mi id="A3.Ex4.m1.2.3.4.2.2.2" xref="A3.Ex4.m1.2.3.4.2.2.2.cmml">𝐖</mi><mi id="A3.Ex4.m1.2.3.4.2.2.3" xref="A3.Ex4.m1.2.3.4.2.2.3.cmml">a</mi></msub><mo id="A3.Ex4.m1.2.3.4.2.1" xref="A3.Ex4.m1.2.3.4.2.1.cmml">⁢</mo><msubsup id="A3.Ex4.m1.2.3.4.2.3" xref="A3.Ex4.m1.2.3.4.2.3.cmml"><mi id="A3.Ex4.m1.2.3.4.2.3.2.2" xref="A3.Ex4.m1.2.3.4.2.3.2.2.cmml">𝐞</mi><mi id="A3.Ex4.m1.2.3.4.2.3.3" xref="A3.Ex4.m1.2.3.4.2.3.3.cmml">p</mi><mrow id="A3.Ex4.m1.1.1.1.1" xref="A3.Ex4.m1.1.1.1.1.1.cmml"><mo id="A3.Ex4.m1.1.1.1.1.2" stretchy="false" xref="A3.Ex4.m1.1.1.1.1.1.cmml">(</mo><msub id="A3.Ex4.m1.1.1.1.1.1" xref="A3.Ex4.m1.1.1.1.1.1.cmml"><mi id="A3.Ex4.m1.1.1.1.1.1.2" xref="A3.Ex4.m1.1.1.1.1.1.2.cmml">L</mi><mi id="A3.Ex4.m1.1.1.1.1.1.3" xref="A3.Ex4.m1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="A3.Ex4.m1.1.1.1.1.3" stretchy="false" xref="A3.Ex4.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo id="A3.Ex4.m1.2.3.4.1" xref="A3.Ex4.m1.2.3.4.1.cmml">+</mo><mrow id="A3.Ex4.m1.2.3.4.3" xref="A3.Ex4.m1.2.3.4.3.cmml"><msub id="A3.Ex4.m1.2.3.4.3.2" xref="A3.Ex4.m1.2.3.4.3.2.cmml"><mi id="A3.Ex4.m1.2.3.4.3.2.2" xref="A3.Ex4.m1.2.3.4.3.2.2.cmml">𝐛</mi><mi id="A3.Ex4.m1.2.3.4.3.2.3" xref="A3.Ex4.m1.2.3.4.3.2.3.cmml">a</mi></msub><mo id="A3.Ex4.m1.2.3.4.3.1" xref="A3.Ex4.m1.2.3.4.3.1.cmml">⁢</mo><mi id="A3.Ex4.m1.2.3.4.3.3" xref="A3.Ex4.m1.2.3.4.3.3.cmml">or</mi><mo id="A3.Ex4.m1.2.3.4.3.1a" lspace="0.330em" xref="A3.Ex4.m1.2.3.4.3.1.cmml">⁢</mo><msubsup id="A3.Ex4.m1.2.3.4.3.4" xref="A3.Ex4.m1.2.3.4.3.4.cmml"><mi id="A3.Ex4.m1.2.3.4.3.4.2.2" xref="A3.Ex4.m1.2.3.4.3.4.2.2.cmml">𝐞</mi><mi id="A3.Ex4.m1.2.3.4.3.4.3" xref="A3.Ex4.m1.2.3.4.3.4.3.cmml">p</mi><msup id="A3.Ex4.m1.2.3.4.3.4.2.3" xref="A3.Ex4.m1.2.3.4.3.4.2.3.cmml"><mi id="A3.Ex4.m1.2.3.4.3.4.2.3a" xref="A3.Ex4.m1.2.3.4.3.4.2.3.cmml"></mi><mo id="A3.Ex4.m1.2.3.4.3.4.2.3.1" xref="A3.Ex4.m1.2.3.4.3.4.2.3.1.cmml">′</mo></msup></msubsup></mrow></mrow><mo id="A3.Ex4.m1.2.3.5" xref="A3.Ex4.m1.2.3.5.cmml">=</mo><mrow id="A3.Ex4.m1.2.3.6" xref="A3.Ex4.m1.2.3.6.cmml"><mrow id="A3.Ex4.m1.2.3.6.2" xref="A3.Ex4.m1.2.3.6.2.cmml"><msub id="A3.Ex4.m1.2.3.6.2.2" xref="A3.Ex4.m1.2.3.6.2.2.cmml"><mi id="A3.Ex4.m1.2.3.6.2.2.2" xref="A3.Ex4.m1.2.3.6.2.2.2.cmml">𝐖</mi><mi id="A3.Ex4.m1.2.3.6.2.2.3" xref="A3.Ex4.m1.2.3.6.2.2.3.cmml">n</mi></msub><mo id="A3.Ex4.m1.2.3.6.2.1" xref="A3.Ex4.m1.2.3.6.2.1.cmml">⁢</mo><msubsup id="A3.Ex4.m1.2.3.6.2.3" xref="A3.Ex4.m1.2.3.6.2.3.cmml"><mi id="A3.Ex4.m1.2.3.6.2.3.2.2" xref="A3.Ex4.m1.2.3.6.2.3.2.2.cmml">𝐞</mi><mi id="A3.Ex4.m1.2.3.6.2.3.3" xref="A3.Ex4.m1.2.3.6.2.3.3.cmml">p</mi><mrow id="A3.Ex4.m1.2.2.1.1" xref="A3.Ex4.m1.2.2.1.1.1.cmml"><mo id="A3.Ex4.m1.2.2.1.1.2" stretchy="false" xref="A3.Ex4.m1.2.2.1.1.1.cmml">(</mo><msub id="A3.Ex4.m1.2.2.1.1.1" xref="A3.Ex4.m1.2.2.1.1.1.cmml"><mi id="A3.Ex4.m1.2.2.1.1.1.2" xref="A3.Ex4.m1.2.2.1.1.1.2.cmml">L</mi><mi id="A3.Ex4.m1.2.2.1.1.1.3" xref="A3.Ex4.m1.2.2.1.1.1.3.cmml">n</mi></msub><mo id="A3.Ex4.m1.2.2.1.1.3" stretchy="false" xref="A3.Ex4.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo id="A3.Ex4.m1.2.3.6.1" xref="A3.Ex4.m1.2.3.6.1.cmml">+</mo><msub id="A3.Ex4.m1.2.3.6.3" xref="A3.Ex4.m1.2.3.6.3.cmml"><mi id="A3.Ex4.m1.2.3.6.3.2" xref="A3.Ex4.m1.2.3.6.3.2.cmml">𝐛</mi><mi id="A3.Ex4.m1.2.3.6.3.3" xref="A3.Ex4.m1.2.3.6.3.3.cmml">n</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex4.m1.2b"><apply id="A3.Ex4.m1.2.3.cmml" xref="A3.Ex4.m1.2.3"><and id="A3.Ex4.m1.2.3a.cmml" xref="A3.Ex4.m1.2.3"></and><apply id="A3.Ex4.m1.2.3b.cmml" xref="A3.Ex4.m1.2.3"><eq id="A3.Ex4.m1.2.3.3.cmml" xref="A3.Ex4.m1.2.3.3"></eq><apply id="A3.Ex4.m1.2.3.2.cmml" xref="A3.Ex4.m1.2.3.2"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.3.2.1.cmml" xref="A3.Ex4.m1.2.3.2">subscript</csymbol><apply id="A3.Ex4.m1.2.3.2.2.cmml" xref="A3.Ex4.m1.2.3.2"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.3.2.2.1.cmml" xref="A3.Ex4.m1.2.3.2">superscript</csymbol><ci id="A3.Ex4.m1.2.3.2.2.2.cmml" xref="A3.Ex4.m1.2.3.2.2.2">𝐞</ci><apply id="A3.Ex4.m1.2.3.2.2.3.cmml" xref="A3.Ex4.m1.2.3.2.2.3"><ci id="A3.Ex4.m1.2.3.2.2.3.1.cmml" xref="A3.Ex4.m1.2.3.2.2.3.1">′</ci></apply></apply><ci id="A3.Ex4.m1.2.3.2.3.cmml" xref="A3.Ex4.m1.2.3.2.3">𝑝</ci></apply><apply id="A3.Ex4.m1.2.3.4.cmml" xref="A3.Ex4.m1.2.3.4"><plus id="A3.Ex4.m1.2.3.4.1.cmml" xref="A3.Ex4.m1.2.3.4.1"></plus><apply id="A3.Ex4.m1.2.3.4.2.cmml" xref="A3.Ex4.m1.2.3.4.2"><times id="A3.Ex4.m1.2.3.4.2.1.cmml" xref="A3.Ex4.m1.2.3.4.2.1"></times><apply id="A3.Ex4.m1.2.3.4.2.2.cmml" xref="A3.Ex4.m1.2.3.4.2.2"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.3.4.2.2.1.cmml" xref="A3.Ex4.m1.2.3.4.2.2">subscript</csymbol><ci id="A3.Ex4.m1.2.3.4.2.2.2.cmml" xref="A3.Ex4.m1.2.3.4.2.2.2">𝐖</ci><ci id="A3.Ex4.m1.2.3.4.2.2.3.cmml" xref="A3.Ex4.m1.2.3.4.2.2.3">𝑎</ci></apply><apply id="A3.Ex4.m1.2.3.4.2.3.cmml" xref="A3.Ex4.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.3.4.2.3.1.cmml" xref="A3.Ex4.m1.2.3.4.2.3">subscript</csymbol><apply id="A3.Ex4.m1.2.3.4.2.3.2.cmml" xref="A3.Ex4.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.3.4.2.3.2.1.cmml" xref="A3.Ex4.m1.2.3.4.2.3">superscript</csymbol><ci id="A3.Ex4.m1.2.3.4.2.3.2.2.cmml" xref="A3.Ex4.m1.2.3.4.2.3.2.2">𝐞</ci><apply id="A3.Ex4.m1.1.1.1.1.1.cmml" xref="A3.Ex4.m1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex4.m1.1.1.1.1.1.1.cmml" xref="A3.Ex4.m1.1.1.1.1">subscript</csymbol><ci id="A3.Ex4.m1.1.1.1.1.1.2.cmml" xref="A3.Ex4.m1.1.1.1.1.1.2">𝐿</ci><ci id="A3.Ex4.m1.1.1.1.1.1.3.cmml" xref="A3.Ex4.m1.1.1.1.1.1.3">𝑎</ci></apply></apply><ci id="A3.Ex4.m1.2.3.4.2.3.3.cmml" xref="A3.Ex4.m1.2.3.4.2.3.3">𝑝</ci></apply></apply><apply id="A3.Ex4.m1.2.3.4.3.cmml" xref="A3.Ex4.m1.2.3.4.3"><times id="A3.Ex4.m1.2.3.4.3.1.cmml" xref="A3.Ex4.m1.2.3.4.3.1"></times><apply id="A3.Ex4.m1.2.3.4.3.2.cmml" xref="A3.Ex4.m1.2.3.4.3.2"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.3.4.3.2.1.cmml" xref="A3.Ex4.m1.2.3.4.3.2">subscript</csymbol><ci id="A3.Ex4.m1.2.3.4.3.2.2.cmml" xref="A3.Ex4.m1.2.3.4.3.2.2">𝐛</ci><ci id="A3.Ex4.m1.2.3.4.3.2.3.cmml" xref="A3.Ex4.m1.2.3.4.3.2.3">𝑎</ci></apply><ci id="A3.Ex4.m1.2.3.4.3.3.cmml" xref="A3.Ex4.m1.2.3.4.3.3">or</ci><apply id="A3.Ex4.m1.2.3.4.3.4.cmml" xref="A3.Ex4.m1.2.3.4.3.4"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.3.4.3.4.1.cmml" xref="A3.Ex4.m1.2.3.4.3.4">subscript</csymbol><apply id="A3.Ex4.m1.2.3.4.3.4.2.cmml" xref="A3.Ex4.m1.2.3.4.3.4"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.3.4.3.4.2.1.cmml" xref="A3.Ex4.m1.2.3.4.3.4">superscript</csymbol><ci id="A3.Ex4.m1.2.3.4.3.4.2.2.cmml" xref="A3.Ex4.m1.2.3.4.3.4.2.2">𝐞</ci><apply id="A3.Ex4.m1.2.3.4.3.4.2.3.cmml" xref="A3.Ex4.m1.2.3.4.3.4.2.3"><ci id="A3.Ex4.m1.2.3.4.3.4.2.3.1.cmml" xref="A3.Ex4.m1.2.3.4.3.4.2.3.1">′</ci></apply></apply><ci id="A3.Ex4.m1.2.3.4.3.4.3.cmml" xref="A3.Ex4.m1.2.3.4.3.4.3">𝑝</ci></apply></apply></apply></apply><apply id="A3.Ex4.m1.2.3c.cmml" xref="A3.Ex4.m1.2.3"><eq id="A3.Ex4.m1.2.3.5.cmml" xref="A3.Ex4.m1.2.3.5"></eq><share href="https://arxiv.org/html/2410.09580v1#A3.Ex4.m1.2.3.4.cmml" id="A3.Ex4.m1.2.3d.cmml" xref="A3.Ex4.m1.2.3"></share><apply id="A3.Ex4.m1.2.3.6.cmml" xref="A3.Ex4.m1.2.3.6"><plus id="A3.Ex4.m1.2.3.6.1.cmml" xref="A3.Ex4.m1.2.3.6.1"></plus><apply id="A3.Ex4.m1.2.3.6.2.cmml" xref="A3.Ex4.m1.2.3.6.2"><times id="A3.Ex4.m1.2.3.6.2.1.cmml" xref="A3.Ex4.m1.2.3.6.2.1"></times><apply id="A3.Ex4.m1.2.3.6.2.2.cmml" xref="A3.Ex4.m1.2.3.6.2.2"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.3.6.2.2.1.cmml" xref="A3.Ex4.m1.2.3.6.2.2">subscript</csymbol><ci id="A3.Ex4.m1.2.3.6.2.2.2.cmml" xref="A3.Ex4.m1.2.3.6.2.2.2">𝐖</ci><ci id="A3.Ex4.m1.2.3.6.2.2.3.cmml" xref="A3.Ex4.m1.2.3.6.2.2.3">𝑛</ci></apply><apply id="A3.Ex4.m1.2.3.6.2.3.cmml" xref="A3.Ex4.m1.2.3.6.2.3"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.3.6.2.3.1.cmml" xref="A3.Ex4.m1.2.3.6.2.3">subscript</csymbol><apply id="A3.Ex4.m1.2.3.6.2.3.2.cmml" xref="A3.Ex4.m1.2.3.6.2.3"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.3.6.2.3.2.1.cmml" xref="A3.Ex4.m1.2.3.6.2.3">superscript</csymbol><ci id="A3.Ex4.m1.2.3.6.2.3.2.2.cmml" xref="A3.Ex4.m1.2.3.6.2.3.2.2">𝐞</ci><apply id="A3.Ex4.m1.2.2.1.1.1.cmml" xref="A3.Ex4.m1.2.2.1.1"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.2.1.1.1.1.cmml" xref="A3.Ex4.m1.2.2.1.1">subscript</csymbol><ci id="A3.Ex4.m1.2.2.1.1.1.2.cmml" xref="A3.Ex4.m1.2.2.1.1.1.2">𝐿</ci><ci id="A3.Ex4.m1.2.2.1.1.1.3.cmml" xref="A3.Ex4.m1.2.2.1.1.1.3">𝑛</ci></apply></apply><ci id="A3.Ex4.m1.2.3.6.2.3.3.cmml" xref="A3.Ex4.m1.2.3.6.2.3.3">𝑝</ci></apply></apply><apply id="A3.Ex4.m1.2.3.6.3.cmml" xref="A3.Ex4.m1.2.3.6.3"><csymbol cd="ambiguous" id="A3.Ex4.m1.2.3.6.3.1.cmml" xref="A3.Ex4.m1.2.3.6.3">subscript</csymbol><ci id="A3.Ex4.m1.2.3.6.3.2.cmml" xref="A3.Ex4.m1.2.3.6.3.2">𝐛</ci><ci id="A3.Ex4.m1.2.3.6.3.3.cmml" xref="A3.Ex4.m1.2.3.6.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex4.m1.2c">\displaystyle\mathbf{e}^{{}^{\prime}}_{p}=\mathbf{W}_{a}\mathbf{e}^{(L_{a})}_{%
p}{+}\mathbf{b}_{a}\thinspace\thinspace\mathrm{or}\thinspace\thinspace\mathbf{%
e}^{{}^{\prime}}_{p}=\mathbf{W}_{n}\mathbf{e}^{(L_{n})}_{p}{+}\mathbf{b}_{n}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex4.m1.2d">bold_e start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = bold_W start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT bold_e start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT roman_or bold_e start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = bold_W start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT bold_e start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{e}^{{}^{\prime}}_{v}=\mathbf{W}_{n}\mathbf{e}^{(L_{n})}_{%
v}{+}\mathbf{b}_{n}," class="ltx_Math" display="block" id="A3.E16.m1.2"><semantics id="A3.E16.m1.2a"><mrow id="A3.E16.m1.2.2.1" xref="A3.E16.m1.2.2.1.1.cmml"><mrow id="A3.E16.m1.2.2.1.1" xref="A3.E16.m1.2.2.1.1.cmml"><msubsup id="A3.E16.m1.2.2.1.1.2" xref="A3.E16.m1.2.2.1.1.2.cmml"><mi id="A3.E16.m1.2.2.1.1.2.2.2" xref="A3.E16.m1.2.2.1.1.2.2.2.cmml">𝐞</mi><mi id="A3.E16.m1.2.2.1.1.2.3" xref="A3.E16.m1.2.2.1.1.2.3.cmml">v</mi><msup id="A3.E16.m1.2.2.1.1.2.2.3" xref="A3.E16.m1.2.2.1.1.2.2.3.cmml"><mi id="A3.E16.m1.2.2.1.1.2.2.3a" xref="A3.E16.m1.2.2.1.1.2.2.3.cmml"></mi><mo id="A3.E16.m1.2.2.1.1.2.2.3.1" xref="A3.E16.m1.2.2.1.1.2.2.3.1.cmml">′</mo></msup></msubsup><mo id="A3.E16.m1.2.2.1.1.1" xref="A3.E16.m1.2.2.1.1.1.cmml">=</mo><mrow id="A3.E16.m1.2.2.1.1.3" xref="A3.E16.m1.2.2.1.1.3.cmml"><mrow id="A3.E16.m1.2.2.1.1.3.2" xref="A3.E16.m1.2.2.1.1.3.2.cmml"><msub id="A3.E16.m1.2.2.1.1.3.2.2" xref="A3.E16.m1.2.2.1.1.3.2.2.cmml"><mi id="A3.E16.m1.2.2.1.1.3.2.2.2" xref="A3.E16.m1.2.2.1.1.3.2.2.2.cmml">𝐖</mi><mi id="A3.E16.m1.2.2.1.1.3.2.2.3" xref="A3.E16.m1.2.2.1.1.3.2.2.3.cmml">n</mi></msub><mo id="A3.E16.m1.2.2.1.1.3.2.1" xref="A3.E16.m1.2.2.1.1.3.2.1.cmml">⁢</mo><msubsup id="A3.E16.m1.2.2.1.1.3.2.3" xref="A3.E16.m1.2.2.1.1.3.2.3.cmml"><mi id="A3.E16.m1.2.2.1.1.3.2.3.2.2" xref="A3.E16.m1.2.2.1.1.3.2.3.2.2.cmml">𝐞</mi><mi id="A3.E16.m1.2.2.1.1.3.2.3.3" xref="A3.E16.m1.2.2.1.1.3.2.3.3.cmml">v</mi><mrow id="A3.E16.m1.1.1.1.1" xref="A3.E16.m1.1.1.1.1.1.cmml"><mo id="A3.E16.m1.1.1.1.1.2" stretchy="false" xref="A3.E16.m1.1.1.1.1.1.cmml">(</mo><msub id="A3.E16.m1.1.1.1.1.1" xref="A3.E16.m1.1.1.1.1.1.cmml"><mi id="A3.E16.m1.1.1.1.1.1.2" xref="A3.E16.m1.1.1.1.1.1.2.cmml">L</mi><mi id="A3.E16.m1.1.1.1.1.1.3" xref="A3.E16.m1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="A3.E16.m1.1.1.1.1.3" stretchy="false" xref="A3.E16.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo id="A3.E16.m1.2.2.1.1.3.1" xref="A3.E16.m1.2.2.1.1.3.1.cmml">+</mo><msub id="A3.E16.m1.2.2.1.1.3.3" xref="A3.E16.m1.2.2.1.1.3.3.cmml"><mi id="A3.E16.m1.2.2.1.1.3.3.2" xref="A3.E16.m1.2.2.1.1.3.3.2.cmml">𝐛</mi><mi id="A3.E16.m1.2.2.1.1.3.3.3" xref="A3.E16.m1.2.2.1.1.3.3.3.cmml">n</mi></msub></mrow></mrow><mo id="A3.E16.m1.2.2.1.2" xref="A3.E16.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E16.m1.2b"><apply id="A3.E16.m1.2.2.1.1.cmml" xref="A3.E16.m1.2.2.1"><eq id="A3.E16.m1.2.2.1.1.1.cmml" xref="A3.E16.m1.2.2.1.1.1"></eq><apply id="A3.E16.m1.2.2.1.1.2.cmml" xref="A3.E16.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.E16.m1.2.2.1.1.2.1.cmml" xref="A3.E16.m1.2.2.1.1.2">subscript</csymbol><apply id="A3.E16.m1.2.2.1.1.2.2.cmml" xref="A3.E16.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.E16.m1.2.2.1.1.2.2.1.cmml" xref="A3.E16.m1.2.2.1.1.2">superscript</csymbol><ci id="A3.E16.m1.2.2.1.1.2.2.2.cmml" xref="A3.E16.m1.2.2.1.1.2.2.2">𝐞</ci><apply id="A3.E16.m1.2.2.1.1.2.2.3.cmml" xref="A3.E16.m1.2.2.1.1.2.2.3"><ci id="A3.E16.m1.2.2.1.1.2.2.3.1.cmml" xref="A3.E16.m1.2.2.1.1.2.2.3.1">′</ci></apply></apply><ci id="A3.E16.m1.2.2.1.1.2.3.cmml" xref="A3.E16.m1.2.2.1.1.2.3">𝑣</ci></apply><apply id="A3.E16.m1.2.2.1.1.3.cmml" xref="A3.E16.m1.2.2.1.1.3"><plus id="A3.E16.m1.2.2.1.1.3.1.cmml" xref="A3.E16.m1.2.2.1.1.3.1"></plus><apply id="A3.E16.m1.2.2.1.1.3.2.cmml" xref="A3.E16.m1.2.2.1.1.3.2"><times id="A3.E16.m1.2.2.1.1.3.2.1.cmml" xref="A3.E16.m1.2.2.1.1.3.2.1"></times><apply id="A3.E16.m1.2.2.1.1.3.2.2.cmml" xref="A3.E16.m1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="A3.E16.m1.2.2.1.1.3.2.2.1.cmml" xref="A3.E16.m1.2.2.1.1.3.2.2">subscript</csymbol><ci id="A3.E16.m1.2.2.1.1.3.2.2.2.cmml" xref="A3.E16.m1.2.2.1.1.3.2.2.2">𝐖</ci><ci id="A3.E16.m1.2.2.1.1.3.2.2.3.cmml" xref="A3.E16.m1.2.2.1.1.3.2.2.3">𝑛</ci></apply><apply id="A3.E16.m1.2.2.1.1.3.2.3.cmml" xref="A3.E16.m1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="A3.E16.m1.2.2.1.1.3.2.3.1.cmml" xref="A3.E16.m1.2.2.1.1.3.2.3">subscript</csymbol><apply id="A3.E16.m1.2.2.1.1.3.2.3.2.cmml" xref="A3.E16.m1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="A3.E16.m1.2.2.1.1.3.2.3.2.1.cmml" xref="A3.E16.m1.2.2.1.1.3.2.3">superscript</csymbol><ci id="A3.E16.m1.2.2.1.1.3.2.3.2.2.cmml" xref="A3.E16.m1.2.2.1.1.3.2.3.2.2">𝐞</ci><apply id="A3.E16.m1.1.1.1.1.1.cmml" xref="A3.E16.m1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E16.m1.1.1.1.1.1.1.cmml" xref="A3.E16.m1.1.1.1.1">subscript</csymbol><ci id="A3.E16.m1.1.1.1.1.1.2.cmml" xref="A3.E16.m1.1.1.1.1.1.2">𝐿</ci><ci id="A3.E16.m1.1.1.1.1.1.3.cmml" xref="A3.E16.m1.1.1.1.1.1.3">𝑛</ci></apply></apply><ci id="A3.E16.m1.2.2.1.1.3.2.3.3.cmml" xref="A3.E16.m1.2.2.1.1.3.2.3.3">𝑣</ci></apply></apply><apply id="A3.E16.m1.2.2.1.1.3.3.cmml" xref="A3.E16.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A3.E16.m1.2.2.1.1.3.3.1.cmml" xref="A3.E16.m1.2.2.1.1.3.3">subscript</csymbol><ci id="A3.E16.m1.2.2.1.1.3.3.2.cmml" xref="A3.E16.m1.2.2.1.1.3.3.2">𝐛</ci><ci id="A3.E16.m1.2.2.1.1.3.3.3.cmml" xref="A3.E16.m1.2.2.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E16.m1.2c">\displaystyle\mathbf{e}^{{}^{\prime}}_{v}=\mathbf{W}_{n}\mathbf{e}^{(L_{n})}_{%
v}{+}\mathbf{b}_{n},</annotation><annotation encoding="application/x-llamapun" id="A3.E16.m1.2d">bold_e start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = bold_W start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT bold_e start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p4.2">where <math alttext="\mathbf{W}_{a},\mathbf{W}_{n}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="A3.p4.1.m1.2"><semantics id="A3.p4.1.m1.2a"><mrow id="A3.p4.1.m1.2.2" xref="A3.p4.1.m1.2.2.cmml"><mrow id="A3.p4.1.m1.2.2.2.2" xref="A3.p4.1.m1.2.2.2.3.cmml"><msub id="A3.p4.1.m1.1.1.1.1.1" xref="A3.p4.1.m1.1.1.1.1.1.cmml"><mi id="A3.p4.1.m1.1.1.1.1.1.2" xref="A3.p4.1.m1.1.1.1.1.1.2.cmml">𝐖</mi><mi id="A3.p4.1.m1.1.1.1.1.1.3" xref="A3.p4.1.m1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="A3.p4.1.m1.2.2.2.2.3" xref="A3.p4.1.m1.2.2.2.3.cmml">,</mo><msub id="A3.p4.1.m1.2.2.2.2.2" xref="A3.p4.1.m1.2.2.2.2.2.cmml"><mi id="A3.p4.1.m1.2.2.2.2.2.2" xref="A3.p4.1.m1.2.2.2.2.2.2.cmml">𝐖</mi><mi id="A3.p4.1.m1.2.2.2.2.2.3" xref="A3.p4.1.m1.2.2.2.2.2.3.cmml">n</mi></msub></mrow><mo id="A3.p4.1.m1.2.2.3" xref="A3.p4.1.m1.2.2.3.cmml">∈</mo><msup id="A3.p4.1.m1.2.2.4" xref="A3.p4.1.m1.2.2.4.cmml"><mi id="A3.p4.1.m1.2.2.4.2" xref="A3.p4.1.m1.2.2.4.2.cmml">ℝ</mi><mrow id="A3.p4.1.m1.2.2.4.3" xref="A3.p4.1.m1.2.2.4.3.cmml"><mi id="A3.p4.1.m1.2.2.4.3.2" xref="A3.p4.1.m1.2.2.4.3.2.cmml">d</mi><mo id="A3.p4.1.m1.2.2.4.3.1" lspace="0.222em" rspace="0.222em" xref="A3.p4.1.m1.2.2.4.3.1.cmml">×</mo><mi id="A3.p4.1.m1.2.2.4.3.3" xref="A3.p4.1.m1.2.2.4.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.p4.1.m1.2b"><apply id="A3.p4.1.m1.2.2.cmml" xref="A3.p4.1.m1.2.2"><in id="A3.p4.1.m1.2.2.3.cmml" xref="A3.p4.1.m1.2.2.3"></in><list id="A3.p4.1.m1.2.2.2.3.cmml" xref="A3.p4.1.m1.2.2.2.2"><apply id="A3.p4.1.m1.1.1.1.1.1.cmml" xref="A3.p4.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.p4.1.m1.1.1.1.1.1.1.cmml" xref="A3.p4.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A3.p4.1.m1.1.1.1.1.1.2.cmml" xref="A3.p4.1.m1.1.1.1.1.1.2">𝐖</ci><ci id="A3.p4.1.m1.1.1.1.1.1.3.cmml" xref="A3.p4.1.m1.1.1.1.1.1.3">𝑎</ci></apply><apply id="A3.p4.1.m1.2.2.2.2.2.cmml" xref="A3.p4.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.p4.1.m1.2.2.2.2.2.1.cmml" xref="A3.p4.1.m1.2.2.2.2.2">subscript</csymbol><ci id="A3.p4.1.m1.2.2.2.2.2.2.cmml" xref="A3.p4.1.m1.2.2.2.2.2.2">𝐖</ci><ci id="A3.p4.1.m1.2.2.2.2.2.3.cmml" xref="A3.p4.1.m1.2.2.2.2.2.3">𝑛</ci></apply></list><apply id="A3.p4.1.m1.2.2.4.cmml" xref="A3.p4.1.m1.2.2.4"><csymbol cd="ambiguous" id="A3.p4.1.m1.2.2.4.1.cmml" xref="A3.p4.1.m1.2.2.4">superscript</csymbol><ci id="A3.p4.1.m1.2.2.4.2.cmml" xref="A3.p4.1.m1.2.2.4.2">ℝ</ci><apply id="A3.p4.1.m1.2.2.4.3.cmml" xref="A3.p4.1.m1.2.2.4.3"><times id="A3.p4.1.m1.2.2.4.3.1.cmml" xref="A3.p4.1.m1.2.2.4.3.1"></times><ci id="A3.p4.1.m1.2.2.4.3.2.cmml" xref="A3.p4.1.m1.2.2.4.3.2">𝑑</ci><ci id="A3.p4.1.m1.2.2.4.3.3.cmml" xref="A3.p4.1.m1.2.2.4.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.1.m1.2c">\mathbf{W}_{a},\mathbf{W}_{n}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.1.m1.2d">bold_W start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , bold_W start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{b}_{a},\mathbf{b}_{n}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="A3.p4.2.m2.2"><semantics id="A3.p4.2.m2.2a"><mrow id="A3.p4.2.m2.2.2" xref="A3.p4.2.m2.2.2.cmml"><mrow id="A3.p4.2.m2.2.2.2.2" xref="A3.p4.2.m2.2.2.2.3.cmml"><msub id="A3.p4.2.m2.1.1.1.1.1" xref="A3.p4.2.m2.1.1.1.1.1.cmml"><mi id="A3.p4.2.m2.1.1.1.1.1.2" xref="A3.p4.2.m2.1.1.1.1.1.2.cmml">𝐛</mi><mi id="A3.p4.2.m2.1.1.1.1.1.3" xref="A3.p4.2.m2.1.1.1.1.1.3.cmml">a</mi></msub><mo id="A3.p4.2.m2.2.2.2.2.3" xref="A3.p4.2.m2.2.2.2.3.cmml">,</mo><msub id="A3.p4.2.m2.2.2.2.2.2" xref="A3.p4.2.m2.2.2.2.2.2.cmml"><mi id="A3.p4.2.m2.2.2.2.2.2.2" xref="A3.p4.2.m2.2.2.2.2.2.2.cmml">𝐛</mi><mi id="A3.p4.2.m2.2.2.2.2.2.3" xref="A3.p4.2.m2.2.2.2.2.2.3.cmml">n</mi></msub></mrow><mo id="A3.p4.2.m2.2.2.3" xref="A3.p4.2.m2.2.2.3.cmml">∈</mo><msup id="A3.p4.2.m2.2.2.4" xref="A3.p4.2.m2.2.2.4.cmml"><mi id="A3.p4.2.m2.2.2.4.2" xref="A3.p4.2.m2.2.2.4.2.cmml">ℝ</mi><mi id="A3.p4.2.m2.2.2.4.3" xref="A3.p4.2.m2.2.2.4.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.p4.2.m2.2b"><apply id="A3.p4.2.m2.2.2.cmml" xref="A3.p4.2.m2.2.2"><in id="A3.p4.2.m2.2.2.3.cmml" xref="A3.p4.2.m2.2.2.3"></in><list id="A3.p4.2.m2.2.2.2.3.cmml" xref="A3.p4.2.m2.2.2.2.2"><apply id="A3.p4.2.m2.1.1.1.1.1.cmml" xref="A3.p4.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.p4.2.m2.1.1.1.1.1.1.cmml" xref="A3.p4.2.m2.1.1.1.1.1">subscript</csymbol><ci id="A3.p4.2.m2.1.1.1.1.1.2.cmml" xref="A3.p4.2.m2.1.1.1.1.1.2">𝐛</ci><ci id="A3.p4.2.m2.1.1.1.1.1.3.cmml" xref="A3.p4.2.m2.1.1.1.1.1.3">𝑎</ci></apply><apply id="A3.p4.2.m2.2.2.2.2.2.cmml" xref="A3.p4.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.p4.2.m2.2.2.2.2.2.1.cmml" xref="A3.p4.2.m2.2.2.2.2.2">subscript</csymbol><ci id="A3.p4.2.m2.2.2.2.2.2.2.cmml" xref="A3.p4.2.m2.2.2.2.2.2.2">𝐛</ci><ci id="A3.p4.2.m2.2.2.2.2.2.3.cmml" xref="A3.p4.2.m2.2.2.2.2.2.3">𝑛</ci></apply></list><apply id="A3.p4.2.m2.2.2.4.cmml" xref="A3.p4.2.m2.2.2.4"><csymbol cd="ambiguous" id="A3.p4.2.m2.2.2.4.1.cmml" xref="A3.p4.2.m2.2.2.4">superscript</csymbol><ci id="A3.p4.2.m2.2.2.4.2.cmml" xref="A3.p4.2.m2.2.2.4.2">ℝ</ci><ci id="A3.p4.2.m2.2.2.4.3.cmml" xref="A3.p4.2.m2.2.2.4.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.2.m2.2c">\mathbf{b}_{a},\mathbf{b}_{n}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.2.m2.2d">bold_b start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , bold_b start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are trainable parameters. Next, the positive/negative feedbacks are fused with the representations from the global graph encoder with a gating mechanisms to capture the information from both the global relationships and the local conversation feedbacks:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="A6.EGx3">
<tbody id="A3.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{v}_{p}=\mathrm{gate}(\mathbf{h}^{(L_{g})}_{p},\mathbf{e}^%
{{}^{\prime}}_{p}),\thinspace\mathbf{v}_{v}=\mathrm{gate}(\mathbf{h}^{(L_{g})}%
_{v},\mathbf{e}^{{}^{\prime}}_{v})" class="ltx_Math" display="block" id="A3.Ex5.m1.4"><semantics id="A3.Ex5.m1.4a"><mrow id="A3.Ex5.m1.4.4.2" xref="A3.Ex5.m1.4.4.3.cmml"><mrow id="A3.Ex5.m1.3.3.1.1" xref="A3.Ex5.m1.3.3.1.1.cmml"><msub id="A3.Ex5.m1.3.3.1.1.4" xref="A3.Ex5.m1.3.3.1.1.4.cmml"><mi id="A3.Ex5.m1.3.3.1.1.4.2" xref="A3.Ex5.m1.3.3.1.1.4.2.cmml">𝐯</mi><mi id="A3.Ex5.m1.3.3.1.1.4.3" xref="A3.Ex5.m1.3.3.1.1.4.3.cmml">p</mi></msub><mo id="A3.Ex5.m1.3.3.1.1.3" xref="A3.Ex5.m1.3.3.1.1.3.cmml">=</mo><mrow id="A3.Ex5.m1.3.3.1.1.2" xref="A3.Ex5.m1.3.3.1.1.2.cmml"><mi id="A3.Ex5.m1.3.3.1.1.2.4" xref="A3.Ex5.m1.3.3.1.1.2.4.cmml">gate</mi><mo id="A3.Ex5.m1.3.3.1.1.2.3" xref="A3.Ex5.m1.3.3.1.1.2.3.cmml">⁢</mo><mrow id="A3.Ex5.m1.3.3.1.1.2.2.2" xref="A3.Ex5.m1.3.3.1.1.2.2.3.cmml"><mo id="A3.Ex5.m1.3.3.1.1.2.2.2.3" stretchy="false" xref="A3.Ex5.m1.3.3.1.1.2.2.3.cmml">(</mo><msubsup id="A3.Ex5.m1.3.3.1.1.1.1.1.1" xref="A3.Ex5.m1.3.3.1.1.1.1.1.1.cmml"><mi id="A3.Ex5.m1.3.3.1.1.1.1.1.1.2.2" xref="A3.Ex5.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="A3.Ex5.m1.3.3.1.1.1.1.1.1.3" xref="A3.Ex5.m1.3.3.1.1.1.1.1.1.3.cmml">p</mi><mrow id="A3.Ex5.m1.1.1.1.1" xref="A3.Ex5.m1.1.1.1.1.1.cmml"><mo id="A3.Ex5.m1.1.1.1.1.2" stretchy="false" xref="A3.Ex5.m1.1.1.1.1.1.cmml">(</mo><msub id="A3.Ex5.m1.1.1.1.1.1" xref="A3.Ex5.m1.1.1.1.1.1.cmml"><mi id="A3.Ex5.m1.1.1.1.1.1.2" xref="A3.Ex5.m1.1.1.1.1.1.2.cmml">L</mi><mi id="A3.Ex5.m1.1.1.1.1.1.3" xref="A3.Ex5.m1.1.1.1.1.1.3.cmml">g</mi></msub><mo id="A3.Ex5.m1.1.1.1.1.3" stretchy="false" xref="A3.Ex5.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A3.Ex5.m1.3.3.1.1.2.2.2.4" xref="A3.Ex5.m1.3.3.1.1.2.2.3.cmml">,</mo><msubsup id="A3.Ex5.m1.3.3.1.1.2.2.2.2" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2.cmml"><mi id="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.2" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.2.cmml">𝐞</mi><mi id="A3.Ex5.m1.3.3.1.1.2.2.2.2.3" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2.3.cmml">p</mi><msup id="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.3" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.3.cmml"><mi id="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.3a" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.3.cmml"></mi><mo id="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.3.1" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.3.1.cmml">′</mo></msup></msubsup><mo id="A3.Ex5.m1.3.3.1.1.2.2.2.5" stretchy="false" xref="A3.Ex5.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A3.Ex5.m1.4.4.2.3" rspace="0.337em" xref="A3.Ex5.m1.4.4.3a.cmml">,</mo><mrow id="A3.Ex5.m1.4.4.2.2" xref="A3.Ex5.m1.4.4.2.2.cmml"><msub id="A3.Ex5.m1.4.4.2.2.4" xref="A3.Ex5.m1.4.4.2.2.4.cmml"><mi id="A3.Ex5.m1.4.4.2.2.4.2" xref="A3.Ex5.m1.4.4.2.2.4.2.cmml">𝐯</mi><mi id="A3.Ex5.m1.4.4.2.2.4.3" xref="A3.Ex5.m1.4.4.2.2.4.3.cmml">v</mi></msub><mo id="A3.Ex5.m1.4.4.2.2.3" xref="A3.Ex5.m1.4.4.2.2.3.cmml">=</mo><mrow id="A3.Ex5.m1.4.4.2.2.2" xref="A3.Ex5.m1.4.4.2.2.2.cmml"><mi id="A3.Ex5.m1.4.4.2.2.2.4" xref="A3.Ex5.m1.4.4.2.2.2.4.cmml">gate</mi><mo id="A3.Ex5.m1.4.4.2.2.2.3" xref="A3.Ex5.m1.4.4.2.2.2.3.cmml">⁢</mo><mrow id="A3.Ex5.m1.4.4.2.2.2.2.2" xref="A3.Ex5.m1.4.4.2.2.2.2.3.cmml"><mo id="A3.Ex5.m1.4.4.2.2.2.2.2.3" stretchy="false" xref="A3.Ex5.m1.4.4.2.2.2.2.3.cmml">(</mo><msubsup id="A3.Ex5.m1.4.4.2.2.1.1.1.1" xref="A3.Ex5.m1.4.4.2.2.1.1.1.1.cmml"><mi id="A3.Ex5.m1.4.4.2.2.1.1.1.1.2.2" xref="A3.Ex5.m1.4.4.2.2.1.1.1.1.2.2.cmml">𝐡</mi><mi id="A3.Ex5.m1.4.4.2.2.1.1.1.1.3" xref="A3.Ex5.m1.4.4.2.2.1.1.1.1.3.cmml">v</mi><mrow id="A3.Ex5.m1.2.2.1.1" xref="A3.Ex5.m1.2.2.1.1.1.cmml"><mo id="A3.Ex5.m1.2.2.1.1.2" stretchy="false" xref="A3.Ex5.m1.2.2.1.1.1.cmml">(</mo><msub id="A3.Ex5.m1.2.2.1.1.1" xref="A3.Ex5.m1.2.2.1.1.1.cmml"><mi id="A3.Ex5.m1.2.2.1.1.1.2" xref="A3.Ex5.m1.2.2.1.1.1.2.cmml">L</mi><mi id="A3.Ex5.m1.2.2.1.1.1.3" xref="A3.Ex5.m1.2.2.1.1.1.3.cmml">g</mi></msub><mo id="A3.Ex5.m1.2.2.1.1.3" stretchy="false" xref="A3.Ex5.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A3.Ex5.m1.4.4.2.2.2.2.2.4" xref="A3.Ex5.m1.4.4.2.2.2.2.3.cmml">,</mo><msubsup id="A3.Ex5.m1.4.4.2.2.2.2.2.2" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2.cmml"><mi id="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.2" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.2.cmml">𝐞</mi><mi id="A3.Ex5.m1.4.4.2.2.2.2.2.2.3" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2.3.cmml">v</mi><msup id="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.3" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.3.cmml"><mi id="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.3a" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.3.cmml"></mi><mo id="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.3.1" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.3.1.cmml">′</mo></msup></msubsup><mo id="A3.Ex5.m1.4.4.2.2.2.2.2.5" stretchy="false" xref="A3.Ex5.m1.4.4.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex5.m1.4b"><apply id="A3.Ex5.m1.4.4.3.cmml" xref="A3.Ex5.m1.4.4.2"><csymbol cd="ambiguous" id="A3.Ex5.m1.4.4.3a.cmml" xref="A3.Ex5.m1.4.4.2.3">formulae-sequence</csymbol><apply id="A3.Ex5.m1.3.3.1.1.cmml" xref="A3.Ex5.m1.3.3.1.1"><eq id="A3.Ex5.m1.3.3.1.1.3.cmml" xref="A3.Ex5.m1.3.3.1.1.3"></eq><apply id="A3.Ex5.m1.3.3.1.1.4.cmml" xref="A3.Ex5.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="A3.Ex5.m1.3.3.1.1.4.1.cmml" xref="A3.Ex5.m1.3.3.1.1.4">subscript</csymbol><ci id="A3.Ex5.m1.3.3.1.1.4.2.cmml" xref="A3.Ex5.m1.3.3.1.1.4.2">𝐯</ci><ci id="A3.Ex5.m1.3.3.1.1.4.3.cmml" xref="A3.Ex5.m1.3.3.1.1.4.3">𝑝</ci></apply><apply id="A3.Ex5.m1.3.3.1.1.2.cmml" xref="A3.Ex5.m1.3.3.1.1.2"><times id="A3.Ex5.m1.3.3.1.1.2.3.cmml" xref="A3.Ex5.m1.3.3.1.1.2.3"></times><ci id="A3.Ex5.m1.3.3.1.1.2.4.cmml" xref="A3.Ex5.m1.3.3.1.1.2.4">gate</ci><interval closure="open" id="A3.Ex5.m1.3.3.1.1.2.2.3.cmml" xref="A3.Ex5.m1.3.3.1.1.2.2.2"><apply id="A3.Ex5.m1.3.3.1.1.1.1.1.1.cmml" xref="A3.Ex5.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A3.Ex5.m1.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="A3.Ex5.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A3.Ex5.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex5.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex5.m1.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="A3.Ex5.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex5.m1.3.3.1.1.1.1.1.1.2.2">𝐡</ci><apply id="A3.Ex5.m1.1.1.1.1.1.cmml" xref="A3.Ex5.m1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex5.m1.1.1.1.1.1.1.cmml" xref="A3.Ex5.m1.1.1.1.1">subscript</csymbol><ci id="A3.Ex5.m1.1.1.1.1.1.2.cmml" xref="A3.Ex5.m1.1.1.1.1.1.2">𝐿</ci><ci id="A3.Ex5.m1.1.1.1.1.1.3.cmml" xref="A3.Ex5.m1.1.1.1.1.1.3">𝑔</ci></apply></apply><ci id="A3.Ex5.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A3.Ex5.m1.3.3.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="A3.Ex5.m1.3.3.1.1.2.2.2.2.cmml" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.Ex5.m1.3.3.1.1.2.2.2.2.1.cmml" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2">subscript</csymbol><apply id="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.cmml" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2">superscript</csymbol><ci id="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.2">𝐞</ci><apply id="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.3"><ci id="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.3.1.cmml" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2.2.3.1">′</ci></apply></apply><ci id="A3.Ex5.m1.3.3.1.1.2.2.2.2.3.cmml" xref="A3.Ex5.m1.3.3.1.1.2.2.2.2.3">𝑝</ci></apply></interval></apply></apply><apply id="A3.Ex5.m1.4.4.2.2.cmml" xref="A3.Ex5.m1.4.4.2.2"><eq id="A3.Ex5.m1.4.4.2.2.3.cmml" xref="A3.Ex5.m1.4.4.2.2.3"></eq><apply id="A3.Ex5.m1.4.4.2.2.4.cmml" xref="A3.Ex5.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="A3.Ex5.m1.4.4.2.2.4.1.cmml" xref="A3.Ex5.m1.4.4.2.2.4">subscript</csymbol><ci id="A3.Ex5.m1.4.4.2.2.4.2.cmml" xref="A3.Ex5.m1.4.4.2.2.4.2">𝐯</ci><ci id="A3.Ex5.m1.4.4.2.2.4.3.cmml" xref="A3.Ex5.m1.4.4.2.2.4.3">𝑣</ci></apply><apply id="A3.Ex5.m1.4.4.2.2.2.cmml" xref="A3.Ex5.m1.4.4.2.2.2"><times id="A3.Ex5.m1.4.4.2.2.2.3.cmml" xref="A3.Ex5.m1.4.4.2.2.2.3"></times><ci id="A3.Ex5.m1.4.4.2.2.2.4.cmml" xref="A3.Ex5.m1.4.4.2.2.2.4">gate</ci><interval closure="open" id="A3.Ex5.m1.4.4.2.2.2.2.3.cmml" xref="A3.Ex5.m1.4.4.2.2.2.2.2"><apply id="A3.Ex5.m1.4.4.2.2.1.1.1.1.cmml" xref="A3.Ex5.m1.4.4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex5.m1.4.4.2.2.1.1.1.1.1.cmml" xref="A3.Ex5.m1.4.4.2.2.1.1.1.1">subscript</csymbol><apply id="A3.Ex5.m1.4.4.2.2.1.1.1.1.2.cmml" xref="A3.Ex5.m1.4.4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex5.m1.4.4.2.2.1.1.1.1.2.1.cmml" xref="A3.Ex5.m1.4.4.2.2.1.1.1.1">superscript</csymbol><ci id="A3.Ex5.m1.4.4.2.2.1.1.1.1.2.2.cmml" xref="A3.Ex5.m1.4.4.2.2.1.1.1.1.2.2">𝐡</ci><apply id="A3.Ex5.m1.2.2.1.1.1.cmml" xref="A3.Ex5.m1.2.2.1.1"><csymbol cd="ambiguous" id="A3.Ex5.m1.2.2.1.1.1.1.cmml" xref="A3.Ex5.m1.2.2.1.1">subscript</csymbol><ci id="A3.Ex5.m1.2.2.1.1.1.2.cmml" xref="A3.Ex5.m1.2.2.1.1.1.2">𝐿</ci><ci id="A3.Ex5.m1.2.2.1.1.1.3.cmml" xref="A3.Ex5.m1.2.2.1.1.1.3">𝑔</ci></apply></apply><ci id="A3.Ex5.m1.4.4.2.2.1.1.1.1.3.cmml" xref="A3.Ex5.m1.4.4.2.2.1.1.1.1.3">𝑣</ci></apply><apply id="A3.Ex5.m1.4.4.2.2.2.2.2.2.cmml" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.Ex5.m1.4.4.2.2.2.2.2.2.1.cmml" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2">subscript</csymbol><apply id="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.cmml" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.1.cmml" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2">superscript</csymbol><ci id="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.2.cmml" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.2">𝐞</ci><apply id="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.3.cmml" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.3"><ci id="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.3.1.cmml" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2.2.3.1">′</ci></apply></apply><ci id="A3.Ex5.m1.4.4.2.2.2.2.2.2.3.cmml" xref="A3.Ex5.m1.4.4.2.2.2.2.2.2.3">𝑣</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex5.m1.4c">\displaystyle\mathbf{v}_{p}=\mathrm{gate}(\mathbf{h}^{(L_{g})}_{p},\mathbf{e}^%
{{}^{\prime}}_{p}),\thinspace\mathbf{v}_{v}=\mathrm{gate}(\mathbf{h}^{(L_{g})}%
_{v},\mathbf{e}^{{}^{\prime}}_{v})</annotation><annotation encoding="application/x-llamapun" id="A3.Ex5.m1.4d">bold_v start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = roman_gate ( bold_h start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , bold_e start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) , bold_v start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = roman_gate ( bold_h start_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , bold_e start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathrm{gate}(\mathbf{x},\mathbf{y})=\xi\cdot\mathbf{x}+(1-\xi)%
\cdot\mathbf{y}" class="ltx_Math" display="block" id="A3.Ex6.m1.3"><semantics id="A3.Ex6.m1.3a"><mrow id="A3.Ex6.m1.3.3" xref="A3.Ex6.m1.3.3.cmml"><mrow id="A3.Ex6.m1.3.3.3" xref="A3.Ex6.m1.3.3.3.cmml"><mi id="A3.Ex6.m1.3.3.3.2" xref="A3.Ex6.m1.3.3.3.2.cmml">gate</mi><mo id="A3.Ex6.m1.3.3.3.1" xref="A3.Ex6.m1.3.3.3.1.cmml">⁢</mo><mrow id="A3.Ex6.m1.3.3.3.3.2" xref="A3.Ex6.m1.3.3.3.3.1.cmml"><mo id="A3.Ex6.m1.3.3.3.3.2.1" stretchy="false" xref="A3.Ex6.m1.3.3.3.3.1.cmml">(</mo><mi id="A3.Ex6.m1.1.1" xref="A3.Ex6.m1.1.1.cmml">𝐱</mi><mo id="A3.Ex6.m1.3.3.3.3.2.2" xref="A3.Ex6.m1.3.3.3.3.1.cmml">,</mo><mi id="A3.Ex6.m1.2.2" xref="A3.Ex6.m1.2.2.cmml">𝐲</mi><mo id="A3.Ex6.m1.3.3.3.3.2.3" stretchy="false" xref="A3.Ex6.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex6.m1.3.3.2" xref="A3.Ex6.m1.3.3.2.cmml">=</mo><mrow id="A3.Ex6.m1.3.3.1" xref="A3.Ex6.m1.3.3.1.cmml"><mrow id="A3.Ex6.m1.3.3.1.3" xref="A3.Ex6.m1.3.3.1.3.cmml"><mi id="A3.Ex6.m1.3.3.1.3.2" xref="A3.Ex6.m1.3.3.1.3.2.cmml">ξ</mi><mo id="A3.Ex6.m1.3.3.1.3.1" lspace="0.222em" rspace="0.222em" xref="A3.Ex6.m1.3.3.1.3.1.cmml">⋅</mo><mi id="A3.Ex6.m1.3.3.1.3.3" xref="A3.Ex6.m1.3.3.1.3.3.cmml">𝐱</mi></mrow><mo id="A3.Ex6.m1.3.3.1.2" xref="A3.Ex6.m1.3.3.1.2.cmml">+</mo><mrow id="A3.Ex6.m1.3.3.1.1" xref="A3.Ex6.m1.3.3.1.1.cmml"><mrow id="A3.Ex6.m1.3.3.1.1.1.1" xref="A3.Ex6.m1.3.3.1.1.1.1.1.cmml"><mo id="A3.Ex6.m1.3.3.1.1.1.1.2" stretchy="false" xref="A3.Ex6.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex6.m1.3.3.1.1.1.1.1" xref="A3.Ex6.m1.3.3.1.1.1.1.1.cmml"><mn id="A3.Ex6.m1.3.3.1.1.1.1.1.2" xref="A3.Ex6.m1.3.3.1.1.1.1.1.2.cmml">1</mn><mo id="A3.Ex6.m1.3.3.1.1.1.1.1.1" xref="A3.Ex6.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mi id="A3.Ex6.m1.3.3.1.1.1.1.1.3" xref="A3.Ex6.m1.3.3.1.1.1.1.1.3.cmml">ξ</mi></mrow><mo id="A3.Ex6.m1.3.3.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A3.Ex6.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex6.m1.3.3.1.1.2" rspace="0.222em" xref="A3.Ex6.m1.3.3.1.1.2.cmml">⋅</mo><mi id="A3.Ex6.m1.3.3.1.1.3" xref="A3.Ex6.m1.3.3.1.1.3.cmml">𝐲</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex6.m1.3b"><apply id="A3.Ex6.m1.3.3.cmml" xref="A3.Ex6.m1.3.3"><eq id="A3.Ex6.m1.3.3.2.cmml" xref="A3.Ex6.m1.3.3.2"></eq><apply id="A3.Ex6.m1.3.3.3.cmml" xref="A3.Ex6.m1.3.3.3"><times id="A3.Ex6.m1.3.3.3.1.cmml" xref="A3.Ex6.m1.3.3.3.1"></times><ci id="A3.Ex6.m1.3.3.3.2.cmml" xref="A3.Ex6.m1.3.3.3.2">gate</ci><interval closure="open" id="A3.Ex6.m1.3.3.3.3.1.cmml" xref="A3.Ex6.m1.3.3.3.3.2"><ci id="A3.Ex6.m1.1.1.cmml" xref="A3.Ex6.m1.1.1">𝐱</ci><ci id="A3.Ex6.m1.2.2.cmml" xref="A3.Ex6.m1.2.2">𝐲</ci></interval></apply><apply id="A3.Ex6.m1.3.3.1.cmml" xref="A3.Ex6.m1.3.3.1"><plus id="A3.Ex6.m1.3.3.1.2.cmml" xref="A3.Ex6.m1.3.3.1.2"></plus><apply id="A3.Ex6.m1.3.3.1.3.cmml" xref="A3.Ex6.m1.3.3.1.3"><ci id="A3.Ex6.m1.3.3.1.3.1.cmml" xref="A3.Ex6.m1.3.3.1.3.1">⋅</ci><ci id="A3.Ex6.m1.3.3.1.3.2.cmml" xref="A3.Ex6.m1.3.3.1.3.2">𝜉</ci><ci id="A3.Ex6.m1.3.3.1.3.3.cmml" xref="A3.Ex6.m1.3.3.1.3.3">𝐱</ci></apply><apply id="A3.Ex6.m1.3.3.1.1.cmml" xref="A3.Ex6.m1.3.3.1.1"><ci id="A3.Ex6.m1.3.3.1.1.2.cmml" xref="A3.Ex6.m1.3.3.1.1.2">⋅</ci><apply id="A3.Ex6.m1.3.3.1.1.1.1.1.cmml" xref="A3.Ex6.m1.3.3.1.1.1.1"><minus id="A3.Ex6.m1.3.3.1.1.1.1.1.1.cmml" xref="A3.Ex6.m1.3.3.1.1.1.1.1.1"></minus><cn id="A3.Ex6.m1.3.3.1.1.1.1.1.2.cmml" type="integer" xref="A3.Ex6.m1.3.3.1.1.1.1.1.2">1</cn><ci id="A3.Ex6.m1.3.3.1.1.1.1.1.3.cmml" xref="A3.Ex6.m1.3.3.1.1.1.1.1.3">𝜉</ci></apply><ci id="A3.Ex6.m1.3.3.1.1.3.cmml" xref="A3.Ex6.m1.3.3.1.1.3">𝐲</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex6.m1.3c">\displaystyle\mathrm{gate}(\mathbf{x},\mathbf{y})=\xi\cdot\mathbf{x}+(1-\xi)%
\cdot\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex6.m1.3d">roman_gate ( bold_x , bold_y ) = italic_ξ ⋅ bold_x + ( 1 - italic_ξ ) ⋅ bold_y</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\xi=\mathrm{sigmoid}(\mathbf{W}^{ga}_{1}\mathbf{x}+\mathbf{W}^{ga%
}_{2}\mathbf{y}+\mathbf{b}^{ga})," class="ltx_Math" display="block" id="A3.E17.m1.1"><semantics id="A3.E17.m1.1a"><mrow id="A3.E17.m1.1.1.1" xref="A3.E17.m1.1.1.1.1.cmml"><mrow id="A3.E17.m1.1.1.1.1" xref="A3.E17.m1.1.1.1.1.cmml"><mi id="A3.E17.m1.1.1.1.1.3" xref="A3.E17.m1.1.1.1.1.3.cmml">ξ</mi><mo id="A3.E17.m1.1.1.1.1.2" xref="A3.E17.m1.1.1.1.1.2.cmml">=</mo><mrow id="A3.E17.m1.1.1.1.1.1" xref="A3.E17.m1.1.1.1.1.1.cmml"><mi id="A3.E17.m1.1.1.1.1.1.3" xref="A3.E17.m1.1.1.1.1.1.3.cmml">sigmoid</mi><mo id="A3.E17.m1.1.1.1.1.1.2" xref="A3.E17.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E17.m1.1.1.1.1.1.1.1" xref="A3.E17.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E17.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E17.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E17.m1.1.1.1.1.1.1.1.1" xref="A3.E17.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A3.E17.m1.1.1.1.1.1.1.1.1.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.cmml"><msubsup id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐖</mi><mn id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">1</mn><mrow id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">g</mi><mo id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.1" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">a</mi></mrow></msubsup><mo id="A3.E17.m1.1.1.1.1.1.1.1.1.2.1" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="A3.E17.m1.1.1.1.1.1.1.1.1.2.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.3.cmml">𝐱</mi></mrow><mo id="A3.E17.m1.1.1.1.1.1.1.1.1.1" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A3.E17.m1.1.1.1.1.1.1.1.1.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.cmml"><msubsup id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">𝐖</mi><mn id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">2</mn><mrow id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.cmml"><mi id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.2.cmml">g</mi><mo id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.1" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.3.cmml">a</mi></mrow></msubsup><mo id="A3.E17.m1.1.1.1.1.1.1.1.1.3.1" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A3.E17.m1.1.1.1.1.1.1.1.1.3.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.3.cmml">𝐲</mi></mrow><mo id="A3.E17.m1.1.1.1.1.1.1.1.1.1a" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msup id="A3.E17.m1.1.1.1.1.1.1.1.1.4" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A3.E17.m1.1.1.1.1.1.1.1.1.4.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4.2.cmml">𝐛</mi><mrow id="A3.E17.m1.1.1.1.1.1.1.1.1.4.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.2.cmml">g</mi><mo id="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.1" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.3.cmml">a</mi></mrow></msup></mrow><mo id="A3.E17.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E17.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E17.m1.1.1.1.2" xref="A3.E17.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E17.m1.1b"><apply id="A3.E17.m1.1.1.1.1.cmml" xref="A3.E17.m1.1.1.1"><eq id="A3.E17.m1.1.1.1.1.2.cmml" xref="A3.E17.m1.1.1.1.1.2"></eq><ci id="A3.E17.m1.1.1.1.1.3.cmml" xref="A3.E17.m1.1.1.1.1.3">𝜉</ci><apply id="A3.E17.m1.1.1.1.1.1.cmml" xref="A3.E17.m1.1.1.1.1.1"><times id="A3.E17.m1.1.1.1.1.1.2.cmml" xref="A3.E17.m1.1.1.1.1.1.2"></times><ci id="A3.E17.m1.1.1.1.1.1.3.cmml" xref="A3.E17.m1.1.1.1.1.1.3">sigmoid</ci><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1"><plus id="A3.E17.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2"><times id="A3.E17.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝐖</ci><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3"><times id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.2">𝑔</ci><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.2.3.3">𝑎</ci></apply></apply><cn id="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.2.3">1</cn></apply><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.2.3">𝐱</ci></apply><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3"><times id="A3.E17.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.1"></times><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.2">𝐖</ci><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3"><times id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.1"></times><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.2">𝑔</ci><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.2.3.3">𝑎</ci></apply></apply><cn id="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.2.3">2</cn></apply><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.3.3">𝐲</ci></apply><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.4.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.E17.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4.2">𝐛</ci><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4.3"><times id="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.1"></times><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.2">𝑔</ci><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.4.3.3">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E17.m1.1c">\displaystyle\xi=\mathrm{sigmoid}(\mathbf{W}^{ga}_{1}\mathbf{x}+\mathbf{W}^{ga%
}_{2}\mathbf{y}+\mathbf{b}^{ga}),</annotation><annotation encoding="application/x-llamapun" id="A3.E17.m1.1d">italic_ξ = roman_sigmoid ( bold_W start_POSTSUPERSCRIPT italic_g italic_a end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_x + bold_W start_POSTSUPERSCRIPT italic_g italic_a end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT bold_y + bold_b start_POSTSUPERSCRIPT italic_g italic_a end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p4.5">where <math alttext="\mathbf{W}^{ga}_{1},\mathbf{W}^{ga}_{2}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="A3.p4.3.m1.2"><semantics id="A3.p4.3.m1.2a"><mrow id="A3.p4.3.m1.2.2" xref="A3.p4.3.m1.2.2.cmml"><mrow id="A3.p4.3.m1.2.2.2.2" xref="A3.p4.3.m1.2.2.2.3.cmml"><msubsup id="A3.p4.3.m1.1.1.1.1.1" xref="A3.p4.3.m1.1.1.1.1.1.cmml"><mi id="A3.p4.3.m1.1.1.1.1.1.2.2" xref="A3.p4.3.m1.1.1.1.1.1.2.2.cmml">𝐖</mi><mn id="A3.p4.3.m1.1.1.1.1.1.3" xref="A3.p4.3.m1.1.1.1.1.1.3.cmml">1</mn><mrow id="A3.p4.3.m1.1.1.1.1.1.2.3" xref="A3.p4.3.m1.1.1.1.1.1.2.3.cmml"><mi id="A3.p4.3.m1.1.1.1.1.1.2.3.2" xref="A3.p4.3.m1.1.1.1.1.1.2.3.2.cmml">g</mi><mo id="A3.p4.3.m1.1.1.1.1.1.2.3.1" xref="A3.p4.3.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="A3.p4.3.m1.1.1.1.1.1.2.3.3" xref="A3.p4.3.m1.1.1.1.1.1.2.3.3.cmml">a</mi></mrow></msubsup><mo id="A3.p4.3.m1.2.2.2.2.3" xref="A3.p4.3.m1.2.2.2.3.cmml">,</mo><msubsup id="A3.p4.3.m1.2.2.2.2.2" xref="A3.p4.3.m1.2.2.2.2.2.cmml"><mi id="A3.p4.3.m1.2.2.2.2.2.2.2" xref="A3.p4.3.m1.2.2.2.2.2.2.2.cmml">𝐖</mi><mn id="A3.p4.3.m1.2.2.2.2.2.3" xref="A3.p4.3.m1.2.2.2.2.2.3.cmml">2</mn><mrow id="A3.p4.3.m1.2.2.2.2.2.2.3" xref="A3.p4.3.m1.2.2.2.2.2.2.3.cmml"><mi id="A3.p4.3.m1.2.2.2.2.2.2.3.2" xref="A3.p4.3.m1.2.2.2.2.2.2.3.2.cmml">g</mi><mo id="A3.p4.3.m1.2.2.2.2.2.2.3.1" xref="A3.p4.3.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A3.p4.3.m1.2.2.2.2.2.2.3.3" xref="A3.p4.3.m1.2.2.2.2.2.2.3.3.cmml">a</mi></mrow></msubsup></mrow><mo id="A3.p4.3.m1.2.2.3" xref="A3.p4.3.m1.2.2.3.cmml">∈</mo><msup id="A3.p4.3.m1.2.2.4" xref="A3.p4.3.m1.2.2.4.cmml"><mi id="A3.p4.3.m1.2.2.4.2" xref="A3.p4.3.m1.2.2.4.2.cmml">ℝ</mi><mrow id="A3.p4.3.m1.2.2.4.3" xref="A3.p4.3.m1.2.2.4.3.cmml"><mi id="A3.p4.3.m1.2.2.4.3.2" xref="A3.p4.3.m1.2.2.4.3.2.cmml">d</mi><mo id="A3.p4.3.m1.2.2.4.3.1" lspace="0.222em" rspace="0.222em" xref="A3.p4.3.m1.2.2.4.3.1.cmml">×</mo><mi id="A3.p4.3.m1.2.2.4.3.3" xref="A3.p4.3.m1.2.2.4.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.p4.3.m1.2b"><apply id="A3.p4.3.m1.2.2.cmml" xref="A3.p4.3.m1.2.2"><in id="A3.p4.3.m1.2.2.3.cmml" xref="A3.p4.3.m1.2.2.3"></in><list id="A3.p4.3.m1.2.2.2.3.cmml" xref="A3.p4.3.m1.2.2.2.2"><apply id="A3.p4.3.m1.1.1.1.1.1.cmml" xref="A3.p4.3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.p4.3.m1.1.1.1.1.1.1.cmml" xref="A3.p4.3.m1.1.1.1.1.1">subscript</csymbol><apply id="A3.p4.3.m1.1.1.1.1.1.2.cmml" xref="A3.p4.3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.p4.3.m1.1.1.1.1.1.2.1.cmml" xref="A3.p4.3.m1.1.1.1.1.1">superscript</csymbol><ci id="A3.p4.3.m1.1.1.1.1.1.2.2.cmml" xref="A3.p4.3.m1.1.1.1.1.1.2.2">𝐖</ci><apply id="A3.p4.3.m1.1.1.1.1.1.2.3.cmml" xref="A3.p4.3.m1.1.1.1.1.1.2.3"><times id="A3.p4.3.m1.1.1.1.1.1.2.3.1.cmml" xref="A3.p4.3.m1.1.1.1.1.1.2.3.1"></times><ci id="A3.p4.3.m1.1.1.1.1.1.2.3.2.cmml" xref="A3.p4.3.m1.1.1.1.1.1.2.3.2">𝑔</ci><ci id="A3.p4.3.m1.1.1.1.1.1.2.3.3.cmml" xref="A3.p4.3.m1.1.1.1.1.1.2.3.3">𝑎</ci></apply></apply><cn id="A3.p4.3.m1.1.1.1.1.1.3.cmml" type="integer" xref="A3.p4.3.m1.1.1.1.1.1.3">1</cn></apply><apply id="A3.p4.3.m1.2.2.2.2.2.cmml" xref="A3.p4.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.p4.3.m1.2.2.2.2.2.1.cmml" xref="A3.p4.3.m1.2.2.2.2.2">subscript</csymbol><apply id="A3.p4.3.m1.2.2.2.2.2.2.cmml" xref="A3.p4.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.p4.3.m1.2.2.2.2.2.2.1.cmml" xref="A3.p4.3.m1.2.2.2.2.2">superscript</csymbol><ci id="A3.p4.3.m1.2.2.2.2.2.2.2.cmml" xref="A3.p4.3.m1.2.2.2.2.2.2.2">𝐖</ci><apply id="A3.p4.3.m1.2.2.2.2.2.2.3.cmml" xref="A3.p4.3.m1.2.2.2.2.2.2.3"><times id="A3.p4.3.m1.2.2.2.2.2.2.3.1.cmml" xref="A3.p4.3.m1.2.2.2.2.2.2.3.1"></times><ci id="A3.p4.3.m1.2.2.2.2.2.2.3.2.cmml" xref="A3.p4.3.m1.2.2.2.2.2.2.3.2">𝑔</ci><ci id="A3.p4.3.m1.2.2.2.2.2.2.3.3.cmml" xref="A3.p4.3.m1.2.2.2.2.2.2.3.3">𝑎</ci></apply></apply><cn id="A3.p4.3.m1.2.2.2.2.2.3.cmml" type="integer" xref="A3.p4.3.m1.2.2.2.2.2.3">2</cn></apply></list><apply id="A3.p4.3.m1.2.2.4.cmml" xref="A3.p4.3.m1.2.2.4"><csymbol cd="ambiguous" id="A3.p4.3.m1.2.2.4.1.cmml" xref="A3.p4.3.m1.2.2.4">superscript</csymbol><ci id="A3.p4.3.m1.2.2.4.2.cmml" xref="A3.p4.3.m1.2.2.4.2">ℝ</ci><apply id="A3.p4.3.m1.2.2.4.3.cmml" xref="A3.p4.3.m1.2.2.4.3"><times id="A3.p4.3.m1.2.2.4.3.1.cmml" xref="A3.p4.3.m1.2.2.4.3.1"></times><ci id="A3.p4.3.m1.2.2.4.3.2.cmml" xref="A3.p4.3.m1.2.2.4.3.2">𝑑</ci><ci id="A3.p4.3.m1.2.2.4.3.3.cmml" xref="A3.p4.3.m1.2.2.4.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.3.m1.2c">\mathbf{W}^{ga}_{1},\mathbf{W}^{ga}_{2}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.3.m1.2d">bold_W start_POSTSUPERSCRIPT italic_g italic_a end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_W start_POSTSUPERSCRIPT italic_g italic_a end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{b}^{ga}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="A3.p4.4.m2.1"><semantics id="A3.p4.4.m2.1a"><mrow id="A3.p4.4.m2.1.1" xref="A3.p4.4.m2.1.1.cmml"><msup id="A3.p4.4.m2.1.1.2" xref="A3.p4.4.m2.1.1.2.cmml"><mi id="A3.p4.4.m2.1.1.2.2" xref="A3.p4.4.m2.1.1.2.2.cmml">𝐛</mi><mrow id="A3.p4.4.m2.1.1.2.3" xref="A3.p4.4.m2.1.1.2.3.cmml"><mi id="A3.p4.4.m2.1.1.2.3.2" xref="A3.p4.4.m2.1.1.2.3.2.cmml">g</mi><mo id="A3.p4.4.m2.1.1.2.3.1" xref="A3.p4.4.m2.1.1.2.3.1.cmml">⁢</mo><mi id="A3.p4.4.m2.1.1.2.3.3" xref="A3.p4.4.m2.1.1.2.3.3.cmml">a</mi></mrow></msup><mo id="A3.p4.4.m2.1.1.1" xref="A3.p4.4.m2.1.1.1.cmml">∈</mo><msup id="A3.p4.4.m2.1.1.3" xref="A3.p4.4.m2.1.1.3.cmml"><mi id="A3.p4.4.m2.1.1.3.2" xref="A3.p4.4.m2.1.1.3.2.cmml">ℝ</mi><mi id="A3.p4.4.m2.1.1.3.3" xref="A3.p4.4.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.p4.4.m2.1b"><apply id="A3.p4.4.m2.1.1.cmml" xref="A3.p4.4.m2.1.1"><in id="A3.p4.4.m2.1.1.1.cmml" xref="A3.p4.4.m2.1.1.1"></in><apply id="A3.p4.4.m2.1.1.2.cmml" xref="A3.p4.4.m2.1.1.2"><csymbol cd="ambiguous" id="A3.p4.4.m2.1.1.2.1.cmml" xref="A3.p4.4.m2.1.1.2">superscript</csymbol><ci id="A3.p4.4.m2.1.1.2.2.cmml" xref="A3.p4.4.m2.1.1.2.2">𝐛</ci><apply id="A3.p4.4.m2.1.1.2.3.cmml" xref="A3.p4.4.m2.1.1.2.3"><times id="A3.p4.4.m2.1.1.2.3.1.cmml" xref="A3.p4.4.m2.1.1.2.3.1"></times><ci id="A3.p4.4.m2.1.1.2.3.2.cmml" xref="A3.p4.4.m2.1.1.2.3.2">𝑔</ci><ci id="A3.p4.4.m2.1.1.2.3.3.cmml" xref="A3.p4.4.m2.1.1.2.3.3">𝑎</ci></apply></apply><apply id="A3.p4.4.m2.1.1.3.cmml" xref="A3.p4.4.m2.1.1.3"><csymbol cd="ambiguous" id="A3.p4.4.m2.1.1.3.1.cmml" xref="A3.p4.4.m2.1.1.3">superscript</csymbol><ci id="A3.p4.4.m2.1.1.3.2.cmml" xref="A3.p4.4.m2.1.1.3.2">ℝ</ci><ci id="A3.p4.4.m2.1.1.3.3.cmml" xref="A3.p4.4.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.4.m2.1c">\mathbf{b}^{ga}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.4.m2.1d">bold_b start_POSTSUPERSCRIPT italic_g italic_a end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are trainable parameters. Finally, we adopt a Transformer encoder <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib44" title="">2017</a>)</cite> to capture the sequential relationships about the conversation history and obtain the current state representation <math alttext="\mathbf{s}_{t}" class="ltx_Math" display="inline" id="A3.p4.5.m3.1"><semantics id="A3.p4.5.m3.1a"><msub id="A3.p4.5.m3.1.1" xref="A3.p4.5.m3.1.1.cmml"><mi id="A3.p4.5.m3.1.1.2" xref="A3.p4.5.m3.1.1.2.cmml">𝐬</mi><mi id="A3.p4.5.m3.1.1.3" xref="A3.p4.5.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p4.5.m3.1b"><apply id="A3.p4.5.m3.1.1.cmml" xref="A3.p4.5.m3.1.1"><csymbol cd="ambiguous" id="A3.p4.5.m3.1.1.1.cmml" xref="A3.p4.5.m3.1.1">subscript</csymbol><ci id="A3.p4.5.m3.1.1.2.cmml" xref="A3.p4.5.m3.1.1.2">𝐬</ci><ci id="A3.p4.5.m3.1.1.3.cmml" xref="A3.p4.5.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.5.m3.1c">\mathbf{s}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.5.m3.1d">bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{s}_{t}=\mathrm{Meanpooling}(\mathrm{Transformer}(\mathbf{V}))," class="ltx_Math" display="block" id="A3.E18.m1.2"><semantics id="A3.E18.m1.2a"><mrow id="A3.E18.m1.2.2.1" xref="A3.E18.m1.2.2.1.1.cmml"><mrow id="A3.E18.m1.2.2.1.1" xref="A3.E18.m1.2.2.1.1.cmml"><msub id="A3.E18.m1.2.2.1.1.3" xref="A3.E18.m1.2.2.1.1.3.cmml"><mi id="A3.E18.m1.2.2.1.1.3.2" xref="A3.E18.m1.2.2.1.1.3.2.cmml">𝐬</mi><mi id="A3.E18.m1.2.2.1.1.3.3" xref="A3.E18.m1.2.2.1.1.3.3.cmml">t</mi></msub><mo id="A3.E18.m1.2.2.1.1.2" xref="A3.E18.m1.2.2.1.1.2.cmml">=</mo><mrow id="A3.E18.m1.2.2.1.1.1" xref="A3.E18.m1.2.2.1.1.1.cmml"><mi id="A3.E18.m1.2.2.1.1.1.3" xref="A3.E18.m1.2.2.1.1.1.3.cmml">Meanpooling</mi><mo id="A3.E18.m1.2.2.1.1.1.2" xref="A3.E18.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A3.E18.m1.2.2.1.1.1.1.1" xref="A3.E18.m1.2.2.1.1.1.1.1.1.cmml"><mo id="A3.E18.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="A3.E18.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E18.m1.2.2.1.1.1.1.1.1" xref="A3.E18.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A3.E18.m1.2.2.1.1.1.1.1.1.2" xref="A3.E18.m1.2.2.1.1.1.1.1.1.2.cmml">Transformer</mi><mo id="A3.E18.m1.2.2.1.1.1.1.1.1.1" xref="A3.E18.m1.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A3.E18.m1.2.2.1.1.1.1.1.1.3.2" xref="A3.E18.m1.2.2.1.1.1.1.1.1.cmml"><mo id="A3.E18.m1.2.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A3.E18.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mi id="A3.E18.m1.1.1" xref="A3.E18.m1.1.1.cmml">𝐕</mi><mo id="A3.E18.m1.2.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A3.E18.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E18.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="A3.E18.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E18.m1.2.2.1.2" xref="A3.E18.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E18.m1.2b"><apply id="A3.E18.m1.2.2.1.1.cmml" xref="A3.E18.m1.2.2.1"><eq id="A3.E18.m1.2.2.1.1.2.cmml" xref="A3.E18.m1.2.2.1.1.2"></eq><apply id="A3.E18.m1.2.2.1.1.3.cmml" xref="A3.E18.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.E18.m1.2.2.1.1.3.1.cmml" xref="A3.E18.m1.2.2.1.1.3">subscript</csymbol><ci id="A3.E18.m1.2.2.1.1.3.2.cmml" xref="A3.E18.m1.2.2.1.1.3.2">𝐬</ci><ci id="A3.E18.m1.2.2.1.1.3.3.cmml" xref="A3.E18.m1.2.2.1.1.3.3">𝑡</ci></apply><apply id="A3.E18.m1.2.2.1.1.1.cmml" xref="A3.E18.m1.2.2.1.1.1"><times id="A3.E18.m1.2.2.1.1.1.2.cmml" xref="A3.E18.m1.2.2.1.1.1.2"></times><ci id="A3.E18.m1.2.2.1.1.1.3.cmml" xref="A3.E18.m1.2.2.1.1.1.3">Meanpooling</ci><apply id="A3.E18.m1.2.2.1.1.1.1.1.1.cmml" xref="A3.E18.m1.2.2.1.1.1.1.1"><times id="A3.E18.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A3.E18.m1.2.2.1.1.1.1.1.1.1"></times><ci id="A3.E18.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A3.E18.m1.2.2.1.1.1.1.1.1.2">Transformer</ci><ci id="A3.E18.m1.1.1.cmml" xref="A3.E18.m1.1.1">𝐕</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E18.m1.2c">\mathbf{s}_{t}=\mathrm{Meanpooling}(\mathrm{Transformer}(\mathbf{V})),</annotation><annotation encoding="application/x-llamapun" id="A3.E18.m1.2d">bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = roman_Meanpooling ( roman_Transformer ( bold_V ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p4.7">where <math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="A3.p4.6.m1.1"><semantics id="A3.p4.6.m1.1a"><mi id="A3.p4.6.m1.1.1" xref="A3.p4.6.m1.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="A3.p4.6.m1.1b"><ci id="A3.p4.6.m1.1.1.cmml" xref="A3.p4.6.m1.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.6.m1.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.6.m1.1d">bold_V</annotation></semantics></math> is built using all the previously mentioned attribute values and items and in the conversation history: <math alttext="\mathbf{V}=\{\mathbf{v}_{p}|p\in\mathcal{P}^{+}_{t}\cup\mathcal{P}^{-}_{t}\}%
\cup\{\mathbf{v}_{v}|v\in\mathcal{V}^{-}_{t}\}" class="ltx_Math" display="inline" id="A3.p4.7.m2.4"><semantics id="A3.p4.7.m2.4a"><mrow id="A3.p4.7.m2.4.4" xref="A3.p4.7.m2.4.4.cmml"><mi id="A3.p4.7.m2.4.4.6" xref="A3.p4.7.m2.4.4.6.cmml">𝐕</mi><mo id="A3.p4.7.m2.4.4.5" xref="A3.p4.7.m2.4.4.5.cmml">=</mo><mrow id="A3.p4.7.m2.4.4.4" xref="A3.p4.7.m2.4.4.4.cmml"><mrow id="A3.p4.7.m2.2.2.2.2.2" xref="A3.p4.7.m2.2.2.2.2.3.cmml"><mo id="A3.p4.7.m2.2.2.2.2.2.3" stretchy="false" xref="A3.p4.7.m2.2.2.2.2.3.1.cmml">{</mo><msub id="A3.p4.7.m2.1.1.1.1.1.1" xref="A3.p4.7.m2.1.1.1.1.1.1.cmml"><mi id="A3.p4.7.m2.1.1.1.1.1.1.2" xref="A3.p4.7.m2.1.1.1.1.1.1.2.cmml">𝐯</mi><mi id="A3.p4.7.m2.1.1.1.1.1.1.3" xref="A3.p4.7.m2.1.1.1.1.1.1.3.cmml">p</mi></msub><mo id="A3.p4.7.m2.2.2.2.2.2.4" lspace="0em" rspace="0em" xref="A3.p4.7.m2.2.2.2.2.3.1.cmml">|</mo><mrow id="A3.p4.7.m2.2.2.2.2.2.2" xref="A3.p4.7.m2.2.2.2.2.2.2.cmml"><mi id="A3.p4.7.m2.2.2.2.2.2.2.2" xref="A3.p4.7.m2.2.2.2.2.2.2.2.cmml">p</mi><mo id="A3.p4.7.m2.2.2.2.2.2.2.1" xref="A3.p4.7.m2.2.2.2.2.2.2.1.cmml">∈</mo><mrow id="A3.p4.7.m2.2.2.2.2.2.2.3" xref="A3.p4.7.m2.2.2.2.2.2.2.3.cmml"><msubsup id="A3.p4.7.m2.2.2.2.2.2.2.3.2" xref="A3.p4.7.m2.2.2.2.2.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p4.7.m2.2.2.2.2.2.2.3.2.2.2" xref="A3.p4.7.m2.2.2.2.2.2.2.3.2.2.2.cmml">𝒫</mi><mi id="A3.p4.7.m2.2.2.2.2.2.2.3.2.3" xref="A3.p4.7.m2.2.2.2.2.2.2.3.2.3.cmml">t</mi><mo id="A3.p4.7.m2.2.2.2.2.2.2.3.2.2.3" xref="A3.p4.7.m2.2.2.2.2.2.2.3.2.2.3.cmml">+</mo></msubsup><mo id="A3.p4.7.m2.2.2.2.2.2.2.3.1" xref="A3.p4.7.m2.2.2.2.2.2.2.3.1.cmml">∪</mo><msubsup id="A3.p4.7.m2.2.2.2.2.2.2.3.3" xref="A3.p4.7.m2.2.2.2.2.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p4.7.m2.2.2.2.2.2.2.3.3.2.2" xref="A3.p4.7.m2.2.2.2.2.2.2.3.3.2.2.cmml">𝒫</mi><mi id="A3.p4.7.m2.2.2.2.2.2.2.3.3.3" xref="A3.p4.7.m2.2.2.2.2.2.2.3.3.3.cmml">t</mi><mo id="A3.p4.7.m2.2.2.2.2.2.2.3.3.2.3" xref="A3.p4.7.m2.2.2.2.2.2.2.3.3.2.3.cmml">−</mo></msubsup></mrow></mrow><mo id="A3.p4.7.m2.2.2.2.2.2.5" stretchy="false" xref="A3.p4.7.m2.2.2.2.2.3.1.cmml">}</mo></mrow><mo id="A3.p4.7.m2.4.4.4.5" xref="A3.p4.7.m2.4.4.4.5.cmml">∪</mo><mrow id="A3.p4.7.m2.4.4.4.4.2" xref="A3.p4.7.m2.4.4.4.4.3.cmml"><mo id="A3.p4.7.m2.4.4.4.4.2.3" stretchy="false" xref="A3.p4.7.m2.4.4.4.4.3.1.cmml">{</mo><msub id="A3.p4.7.m2.3.3.3.3.1.1" xref="A3.p4.7.m2.3.3.3.3.1.1.cmml"><mi id="A3.p4.7.m2.3.3.3.3.1.1.2" xref="A3.p4.7.m2.3.3.3.3.1.1.2.cmml">𝐯</mi><mi id="A3.p4.7.m2.3.3.3.3.1.1.3" xref="A3.p4.7.m2.3.3.3.3.1.1.3.cmml">v</mi></msub><mo id="A3.p4.7.m2.4.4.4.4.2.4" lspace="0em" rspace="0em" xref="A3.p4.7.m2.4.4.4.4.3.1.cmml">|</mo><mrow id="A3.p4.7.m2.4.4.4.4.2.2" xref="A3.p4.7.m2.4.4.4.4.2.2.cmml"><mi id="A3.p4.7.m2.4.4.4.4.2.2.2" xref="A3.p4.7.m2.4.4.4.4.2.2.2.cmml">v</mi><mo id="A3.p4.7.m2.4.4.4.4.2.2.1" xref="A3.p4.7.m2.4.4.4.4.2.2.1.cmml">∈</mo><msubsup id="A3.p4.7.m2.4.4.4.4.2.2.3" xref="A3.p4.7.m2.4.4.4.4.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p4.7.m2.4.4.4.4.2.2.3.2.2" xref="A3.p4.7.m2.4.4.4.4.2.2.3.2.2.cmml">𝒱</mi><mi id="A3.p4.7.m2.4.4.4.4.2.2.3.3" xref="A3.p4.7.m2.4.4.4.4.2.2.3.3.cmml">t</mi><mo id="A3.p4.7.m2.4.4.4.4.2.2.3.2.3" xref="A3.p4.7.m2.4.4.4.4.2.2.3.2.3.cmml">−</mo></msubsup></mrow><mo id="A3.p4.7.m2.4.4.4.4.2.5" stretchy="false" xref="A3.p4.7.m2.4.4.4.4.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p4.7.m2.4b"><apply id="A3.p4.7.m2.4.4.cmml" xref="A3.p4.7.m2.4.4"><eq id="A3.p4.7.m2.4.4.5.cmml" xref="A3.p4.7.m2.4.4.5"></eq><ci id="A3.p4.7.m2.4.4.6.cmml" xref="A3.p4.7.m2.4.4.6">𝐕</ci><apply id="A3.p4.7.m2.4.4.4.cmml" xref="A3.p4.7.m2.4.4.4"><union id="A3.p4.7.m2.4.4.4.5.cmml" xref="A3.p4.7.m2.4.4.4.5"></union><apply id="A3.p4.7.m2.2.2.2.2.3.cmml" xref="A3.p4.7.m2.2.2.2.2.2"><csymbol cd="latexml" id="A3.p4.7.m2.2.2.2.2.3.1.cmml" xref="A3.p4.7.m2.2.2.2.2.2.3">conditional-set</csymbol><apply id="A3.p4.7.m2.1.1.1.1.1.1.cmml" xref="A3.p4.7.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.p4.7.m2.1.1.1.1.1.1.1.cmml" xref="A3.p4.7.m2.1.1.1.1.1.1">subscript</csymbol><ci id="A3.p4.7.m2.1.1.1.1.1.1.2.cmml" xref="A3.p4.7.m2.1.1.1.1.1.1.2">𝐯</ci><ci id="A3.p4.7.m2.1.1.1.1.1.1.3.cmml" xref="A3.p4.7.m2.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="A3.p4.7.m2.2.2.2.2.2.2.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2"><in id="A3.p4.7.m2.2.2.2.2.2.2.1.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.1"></in><ci id="A3.p4.7.m2.2.2.2.2.2.2.2.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.2">𝑝</ci><apply id="A3.p4.7.m2.2.2.2.2.2.2.3.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3"><union id="A3.p4.7.m2.2.2.2.2.2.2.3.1.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.1"></union><apply id="A3.p4.7.m2.2.2.2.2.2.2.3.2.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A3.p4.7.m2.2.2.2.2.2.2.3.2.1.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.2">subscript</csymbol><apply id="A3.p4.7.m2.2.2.2.2.2.2.3.2.2.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A3.p4.7.m2.2.2.2.2.2.2.3.2.2.1.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.2">superscript</csymbol><ci id="A3.p4.7.m2.2.2.2.2.2.2.3.2.2.2.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.2.2.2">𝒫</ci><plus id="A3.p4.7.m2.2.2.2.2.2.2.3.2.2.3.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.2.2.3"></plus></apply><ci id="A3.p4.7.m2.2.2.2.2.2.2.3.2.3.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.2.3">𝑡</ci></apply><apply id="A3.p4.7.m2.2.2.2.2.2.2.3.3.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A3.p4.7.m2.2.2.2.2.2.2.3.3.1.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.3">subscript</csymbol><apply id="A3.p4.7.m2.2.2.2.2.2.2.3.3.2.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A3.p4.7.m2.2.2.2.2.2.2.3.3.2.1.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.3">superscript</csymbol><ci id="A3.p4.7.m2.2.2.2.2.2.2.3.3.2.2.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.3.2.2">𝒫</ci><minus id="A3.p4.7.m2.2.2.2.2.2.2.3.3.2.3.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.3.2.3"></minus></apply><ci id="A3.p4.7.m2.2.2.2.2.2.2.3.3.3.cmml" xref="A3.p4.7.m2.2.2.2.2.2.2.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="A3.p4.7.m2.4.4.4.4.3.cmml" xref="A3.p4.7.m2.4.4.4.4.2"><csymbol cd="latexml" id="A3.p4.7.m2.4.4.4.4.3.1.cmml" xref="A3.p4.7.m2.4.4.4.4.2.3">conditional-set</csymbol><apply id="A3.p4.7.m2.3.3.3.3.1.1.cmml" xref="A3.p4.7.m2.3.3.3.3.1.1"><csymbol cd="ambiguous" id="A3.p4.7.m2.3.3.3.3.1.1.1.cmml" xref="A3.p4.7.m2.3.3.3.3.1.1">subscript</csymbol><ci id="A3.p4.7.m2.3.3.3.3.1.1.2.cmml" xref="A3.p4.7.m2.3.3.3.3.1.1.2">𝐯</ci><ci id="A3.p4.7.m2.3.3.3.3.1.1.3.cmml" xref="A3.p4.7.m2.3.3.3.3.1.1.3">𝑣</ci></apply><apply id="A3.p4.7.m2.4.4.4.4.2.2.cmml" xref="A3.p4.7.m2.4.4.4.4.2.2"><in id="A3.p4.7.m2.4.4.4.4.2.2.1.cmml" xref="A3.p4.7.m2.4.4.4.4.2.2.1"></in><ci id="A3.p4.7.m2.4.4.4.4.2.2.2.cmml" xref="A3.p4.7.m2.4.4.4.4.2.2.2">𝑣</ci><apply id="A3.p4.7.m2.4.4.4.4.2.2.3.cmml" xref="A3.p4.7.m2.4.4.4.4.2.2.3"><csymbol cd="ambiguous" id="A3.p4.7.m2.4.4.4.4.2.2.3.1.cmml" xref="A3.p4.7.m2.4.4.4.4.2.2.3">subscript</csymbol><apply id="A3.p4.7.m2.4.4.4.4.2.2.3.2.cmml" xref="A3.p4.7.m2.4.4.4.4.2.2.3"><csymbol cd="ambiguous" id="A3.p4.7.m2.4.4.4.4.2.2.3.2.1.cmml" xref="A3.p4.7.m2.4.4.4.4.2.2.3">superscript</csymbol><ci id="A3.p4.7.m2.4.4.4.4.2.2.3.2.2.cmml" xref="A3.p4.7.m2.4.4.4.4.2.2.3.2.2">𝒱</ci><minus id="A3.p4.7.m2.4.4.4.4.2.2.3.2.3.cmml" xref="A3.p4.7.m2.4.4.4.4.2.2.3.2.3"></minus></apply><ci id="A3.p4.7.m2.4.4.4.4.2.2.3.3.cmml" xref="A3.p4.7.m2.4.4.4.4.2.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.7.m2.4c">\mathbf{V}=\{\mathbf{v}_{p}|p\in\mathcal{P}^{+}_{t}\cup\mathcal{P}^{-}_{t}\}%
\cup\{\mathbf{v}_{v}|v\in\mathcal{V}^{-}_{t}\}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.7.m2.4d">bold_V = { bold_v start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT | italic_p ∈ caligraphic_P start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∪ caligraphic_P start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } ∪ { bold_v start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT | italic_v ∈ caligraphic_V start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Transition Function</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.22">Transition occurs from the current state <math alttext="s_{t}" class="ltx_Math" display="inline" id="A4.p1.1.m1.1"><semantics id="A4.p1.1.m1.1a"><msub id="A4.p1.1.m1.1.1" xref="A4.p1.1.m1.1.1.cmml"><mi id="A4.p1.1.m1.1.1.2" xref="A4.p1.1.m1.1.1.2.cmml">s</mi><mi id="A4.p1.1.m1.1.1.3" xref="A4.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A4.p1.1.m1.1b"><apply id="A4.p1.1.m1.1.1.cmml" xref="A4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.p1.1.m1.1.1.1.cmml" xref="A4.p1.1.m1.1.1">subscript</csymbol><ci id="A4.p1.1.m1.1.1.2.cmml" xref="A4.p1.1.m1.1.1.2">𝑠</ci><ci id="A4.p1.1.m1.1.1.3.cmml" xref="A4.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.1.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to the next state <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="A4.p1.2.m2.1"><semantics id="A4.p1.2.m2.1a"><msub id="A4.p1.2.m2.1.1" xref="A4.p1.2.m2.1.1.cmml"><mi id="A4.p1.2.m2.1.1.2" xref="A4.p1.2.m2.1.1.2.cmml">s</mi><mrow id="A4.p1.2.m2.1.1.3" xref="A4.p1.2.m2.1.1.3.cmml"><mi id="A4.p1.2.m2.1.1.3.2" xref="A4.p1.2.m2.1.1.3.2.cmml">t</mi><mo id="A4.p1.2.m2.1.1.3.1" xref="A4.p1.2.m2.1.1.3.1.cmml">+</mo><mn id="A4.p1.2.m2.1.1.3.3" xref="A4.p1.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.p1.2.m2.1b"><apply id="A4.p1.2.m2.1.1.cmml" xref="A4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A4.p1.2.m2.1.1.1.cmml" xref="A4.p1.2.m2.1.1">subscript</csymbol><ci id="A4.p1.2.m2.1.1.2.cmml" xref="A4.p1.2.m2.1.1.2">𝑠</ci><apply id="A4.p1.2.m2.1.1.3.cmml" xref="A4.p1.2.m2.1.1.3"><plus id="A4.p1.2.m2.1.1.3.1.cmml" xref="A4.p1.2.m2.1.1.3.1"></plus><ci id="A4.p1.2.m2.1.1.3.2.cmml" xref="A4.p1.2.m2.1.1.3.2">𝑡</ci><cn id="A4.p1.2.m2.1.1.3.3.cmml" type="integer" xref="A4.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.2.m2.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> when the user responds
to the action <math alttext="a_{t}" class="ltx_Math" display="inline" id="A4.p1.3.m3.1"><semantics id="A4.p1.3.m3.1a"><msub id="A4.p1.3.m3.1.1" xref="A4.p1.3.m3.1.1.cmml"><mi id="A4.p1.3.m3.1.1.2" xref="A4.p1.3.m3.1.1.2.cmml">a</mi><mi id="A4.p1.3.m3.1.1.3" xref="A4.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A4.p1.3.m3.1b"><apply id="A4.p1.3.m3.1.1.cmml" xref="A4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A4.p1.3.m3.1.1.1.cmml" xref="A4.p1.3.m3.1.1">subscript</csymbol><ci id="A4.p1.3.m3.1.1.2.cmml" xref="A4.p1.3.m3.1.1.2">𝑎</ci><ci id="A4.p1.3.m3.1.1.3.cmml" xref="A4.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.3.m3.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.3.m3.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (accepts or rejects items/attribute values). The candidate items and attribute values are updated according to the user’s response.
Specifically, when the action is to ask a question on attribute values, we denote <math alttext="\widehat{\mathcal{P}}^{+}_{t}" class="ltx_Math" display="inline" id="A4.p1.4.m4.1"><semantics id="A4.p1.4.m4.1a"><msubsup id="A4.p1.4.m4.1.1" xref="A4.p1.4.m4.1.1.cmml"><mover accent="true" id="A4.p1.4.m4.1.1.2.2" xref="A4.p1.4.m4.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.4.m4.1.1.2.2.2" xref="A4.p1.4.m4.1.1.2.2.2.cmml">𝒫</mi><mo id="A4.p1.4.m4.1.1.2.2.1" xref="A4.p1.4.m4.1.1.2.2.1.cmml">^</mo></mover><mi id="A4.p1.4.m4.1.1.3" xref="A4.p1.4.m4.1.1.3.cmml">t</mi><mo id="A4.p1.4.m4.1.1.2.3" xref="A4.p1.4.m4.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="A4.p1.4.m4.1b"><apply id="A4.p1.4.m4.1.1.cmml" xref="A4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A4.p1.4.m4.1.1.1.cmml" xref="A4.p1.4.m4.1.1">subscript</csymbol><apply id="A4.p1.4.m4.1.1.2.cmml" xref="A4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A4.p1.4.m4.1.1.2.1.cmml" xref="A4.p1.4.m4.1.1">superscript</csymbol><apply id="A4.p1.4.m4.1.1.2.2.cmml" xref="A4.p1.4.m4.1.1.2.2"><ci id="A4.p1.4.m4.1.1.2.2.1.cmml" xref="A4.p1.4.m4.1.1.2.2.1">^</ci><ci id="A4.p1.4.m4.1.1.2.2.2.cmml" xref="A4.p1.4.m4.1.1.2.2.2">𝒫</ci></apply><plus id="A4.p1.4.m4.1.1.2.3.cmml" xref="A4.p1.4.m4.1.1.2.3"></plus></apply><ci id="A4.p1.4.m4.1.1.3.cmml" xref="A4.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.4.m4.1c">\widehat{\mathcal{P}}^{+}_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.4.m4.1d">over^ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\widehat{\mathcal{P}}^{-}_{t}" class="ltx_Math" display="inline" id="A4.p1.5.m5.1"><semantics id="A4.p1.5.m5.1a"><msubsup id="A4.p1.5.m5.1.1" xref="A4.p1.5.m5.1.1.cmml"><mover accent="true" id="A4.p1.5.m5.1.1.2.2" xref="A4.p1.5.m5.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.5.m5.1.1.2.2.2" xref="A4.p1.5.m5.1.1.2.2.2.cmml">𝒫</mi><mo id="A4.p1.5.m5.1.1.2.2.1" xref="A4.p1.5.m5.1.1.2.2.1.cmml">^</mo></mover><mi id="A4.p1.5.m5.1.1.3" xref="A4.p1.5.m5.1.1.3.cmml">t</mi><mo id="A4.p1.5.m5.1.1.2.3" xref="A4.p1.5.m5.1.1.2.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="A4.p1.5.m5.1b"><apply id="A4.p1.5.m5.1.1.cmml" xref="A4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A4.p1.5.m5.1.1.1.cmml" xref="A4.p1.5.m5.1.1">subscript</csymbol><apply id="A4.p1.5.m5.1.1.2.cmml" xref="A4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A4.p1.5.m5.1.1.2.1.cmml" xref="A4.p1.5.m5.1.1">superscript</csymbol><apply id="A4.p1.5.m5.1.1.2.2.cmml" xref="A4.p1.5.m5.1.1.2.2"><ci id="A4.p1.5.m5.1.1.2.2.1.cmml" xref="A4.p1.5.m5.1.1.2.2.1">^</ci><ci id="A4.p1.5.m5.1.1.2.2.2.cmml" xref="A4.p1.5.m5.1.1.2.2.2">𝒫</ci></apply><minus id="A4.p1.5.m5.1.1.2.3.cmml" xref="A4.p1.5.m5.1.1.2.3"></minus></apply><ci id="A4.p1.5.m5.1.1.3.cmml" xref="A4.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.5.m5.1c">\widehat{\mathcal{P}}^{-}_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.5.m5.1d">over^ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as the attribute values that the user accepts or rejects at the current turn <math alttext="t" class="ltx_Math" display="inline" id="A4.p1.6.m6.1"><semantics id="A4.p1.6.m6.1a"><mi id="A4.p1.6.m6.1.1" xref="A4.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A4.p1.6.m6.1b"><ci id="A4.p1.6.m6.1.1.cmml" xref="A4.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="A4.p1.6.m6.1d">italic_t</annotation></semantics></math>, the candidate attribute value set <math alttext="\mathcal{P}^{c}_{t+1}" class="ltx_Math" display="inline" id="A4.p1.7.m7.1"><semantics id="A4.p1.7.m7.1a"><msubsup id="A4.p1.7.m7.1.1" xref="A4.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.7.m7.1.1.2.2" xref="A4.p1.7.m7.1.1.2.2.cmml">𝒫</mi><mrow id="A4.p1.7.m7.1.1.3" xref="A4.p1.7.m7.1.1.3.cmml"><mi id="A4.p1.7.m7.1.1.3.2" xref="A4.p1.7.m7.1.1.3.2.cmml">t</mi><mo id="A4.p1.7.m7.1.1.3.1" xref="A4.p1.7.m7.1.1.3.1.cmml">+</mo><mn id="A4.p1.7.m7.1.1.3.3" xref="A4.p1.7.m7.1.1.3.3.cmml">1</mn></mrow><mi id="A4.p1.7.m7.1.1.2.3" xref="A4.p1.7.m7.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="A4.p1.7.m7.1b"><apply id="A4.p1.7.m7.1.1.cmml" xref="A4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A4.p1.7.m7.1.1.1.cmml" xref="A4.p1.7.m7.1.1">subscript</csymbol><apply id="A4.p1.7.m7.1.1.2.cmml" xref="A4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A4.p1.7.m7.1.1.2.1.cmml" xref="A4.p1.7.m7.1.1">superscript</csymbol><ci id="A4.p1.7.m7.1.1.2.2.cmml" xref="A4.p1.7.m7.1.1.2.2">𝒫</ci><ci id="A4.p1.7.m7.1.1.2.3.cmml" xref="A4.p1.7.m7.1.1.2.3">𝑐</ci></apply><apply id="A4.p1.7.m7.1.1.3.cmml" xref="A4.p1.7.m7.1.1.3"><plus id="A4.p1.7.m7.1.1.3.1.cmml" xref="A4.p1.7.m7.1.1.3.1"></plus><ci id="A4.p1.7.m7.1.1.3.2.cmml" xref="A4.p1.7.m7.1.1.3.2">𝑡</ci><cn id="A4.p1.7.m7.1.1.3.3.cmml" type="integer" xref="A4.p1.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.7.m7.1c">\mathcal{P}^{c}_{t+1}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.7.m7.1d">caligraphic_P start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> at the next turn <math alttext="t{+}1" class="ltx_Math" display="inline" id="A4.p1.8.m8.1"><semantics id="A4.p1.8.m8.1a"><mrow id="A4.p1.8.m8.1.1" xref="A4.p1.8.m8.1.1.cmml"><mi id="A4.p1.8.m8.1.1.2" xref="A4.p1.8.m8.1.1.2.cmml">t</mi><mo id="A4.p1.8.m8.1.1.1" xref="A4.p1.8.m8.1.1.1.cmml">+</mo><mn id="A4.p1.8.m8.1.1.3" xref="A4.p1.8.m8.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.8.m8.1b"><apply id="A4.p1.8.m8.1.1.cmml" xref="A4.p1.8.m8.1.1"><plus id="A4.p1.8.m8.1.1.1.cmml" xref="A4.p1.8.m8.1.1.1"></plus><ci id="A4.p1.8.m8.1.1.2.cmml" xref="A4.p1.8.m8.1.1.2">𝑡</ci><cn id="A4.p1.8.m8.1.1.3.cmml" type="integer" xref="A4.p1.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.8.m8.1c">t{+}1</annotation><annotation encoding="application/x-llamapun" id="A4.p1.8.m8.1d">italic_t + 1</annotation></semantics></math> is updated as <math alttext="\mathcal{P}^{c}_{t+1}=\mathcal{P}^{c}_{t}\setminus(\widehat{\mathcal{P}}^{+}_{%
t}\cup\widehat{\mathcal{P}}^{-}_{t})" class="ltx_Math" display="inline" id="A4.p1.9.m9.1"><semantics id="A4.p1.9.m9.1a"><mrow id="A4.p1.9.m9.1.1" xref="A4.p1.9.m9.1.1.cmml"><msubsup id="A4.p1.9.m9.1.1.3" xref="A4.p1.9.m9.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.9.m9.1.1.3.2.2" xref="A4.p1.9.m9.1.1.3.2.2.cmml">𝒫</mi><mrow id="A4.p1.9.m9.1.1.3.3" xref="A4.p1.9.m9.1.1.3.3.cmml"><mi id="A4.p1.9.m9.1.1.3.3.2" xref="A4.p1.9.m9.1.1.3.3.2.cmml">t</mi><mo id="A4.p1.9.m9.1.1.3.3.1" xref="A4.p1.9.m9.1.1.3.3.1.cmml">+</mo><mn id="A4.p1.9.m9.1.1.3.3.3" xref="A4.p1.9.m9.1.1.3.3.3.cmml">1</mn></mrow><mi id="A4.p1.9.m9.1.1.3.2.3" xref="A4.p1.9.m9.1.1.3.2.3.cmml">c</mi></msubsup><mo id="A4.p1.9.m9.1.1.2" xref="A4.p1.9.m9.1.1.2.cmml">=</mo><mrow id="A4.p1.9.m9.1.1.1" xref="A4.p1.9.m9.1.1.1.cmml"><msubsup id="A4.p1.9.m9.1.1.1.3" xref="A4.p1.9.m9.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.9.m9.1.1.1.3.2.2" xref="A4.p1.9.m9.1.1.1.3.2.2.cmml">𝒫</mi><mi id="A4.p1.9.m9.1.1.1.3.3" xref="A4.p1.9.m9.1.1.1.3.3.cmml">t</mi><mi id="A4.p1.9.m9.1.1.1.3.2.3" xref="A4.p1.9.m9.1.1.1.3.2.3.cmml">c</mi></msubsup><mo id="A4.p1.9.m9.1.1.1.2" xref="A4.p1.9.m9.1.1.1.2.cmml">∖</mo><mrow id="A4.p1.9.m9.1.1.1.1.1" xref="A4.p1.9.m9.1.1.1.1.1.1.cmml"><mo id="A4.p1.9.m9.1.1.1.1.1.2" stretchy="false" xref="A4.p1.9.m9.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.p1.9.m9.1.1.1.1.1.1" xref="A4.p1.9.m9.1.1.1.1.1.1.cmml"><msubsup id="A4.p1.9.m9.1.1.1.1.1.1.2" xref="A4.p1.9.m9.1.1.1.1.1.1.2.cmml"><mover accent="true" id="A4.p1.9.m9.1.1.1.1.1.1.2.2.2" xref="A4.p1.9.m9.1.1.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.9.m9.1.1.1.1.1.1.2.2.2.2" xref="A4.p1.9.m9.1.1.1.1.1.1.2.2.2.2.cmml">𝒫</mi><mo id="A4.p1.9.m9.1.1.1.1.1.1.2.2.2.1" xref="A4.p1.9.m9.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="A4.p1.9.m9.1.1.1.1.1.1.2.3" xref="A4.p1.9.m9.1.1.1.1.1.1.2.3.cmml">t</mi><mo id="A4.p1.9.m9.1.1.1.1.1.1.2.2.3" xref="A4.p1.9.m9.1.1.1.1.1.1.2.2.3.cmml">+</mo></msubsup><mo id="A4.p1.9.m9.1.1.1.1.1.1.1" xref="A4.p1.9.m9.1.1.1.1.1.1.1.cmml">∪</mo><msubsup id="A4.p1.9.m9.1.1.1.1.1.1.3" xref="A4.p1.9.m9.1.1.1.1.1.1.3.cmml"><mover accent="true" id="A4.p1.9.m9.1.1.1.1.1.1.3.2.2" xref="A4.p1.9.m9.1.1.1.1.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.9.m9.1.1.1.1.1.1.3.2.2.2" xref="A4.p1.9.m9.1.1.1.1.1.1.3.2.2.2.cmml">𝒫</mi><mo id="A4.p1.9.m9.1.1.1.1.1.1.3.2.2.1" xref="A4.p1.9.m9.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="A4.p1.9.m9.1.1.1.1.1.1.3.3" xref="A4.p1.9.m9.1.1.1.1.1.1.3.3.cmml">t</mi><mo id="A4.p1.9.m9.1.1.1.1.1.1.3.2.3" xref="A4.p1.9.m9.1.1.1.1.1.1.3.2.3.cmml">−</mo></msubsup></mrow><mo id="A4.p1.9.m9.1.1.1.1.1.3" stretchy="false" xref="A4.p1.9.m9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.9.m9.1b"><apply id="A4.p1.9.m9.1.1.cmml" xref="A4.p1.9.m9.1.1"><eq id="A4.p1.9.m9.1.1.2.cmml" xref="A4.p1.9.m9.1.1.2"></eq><apply id="A4.p1.9.m9.1.1.3.cmml" xref="A4.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="A4.p1.9.m9.1.1.3.1.cmml" xref="A4.p1.9.m9.1.1.3">subscript</csymbol><apply id="A4.p1.9.m9.1.1.3.2.cmml" xref="A4.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="A4.p1.9.m9.1.1.3.2.1.cmml" xref="A4.p1.9.m9.1.1.3">superscript</csymbol><ci id="A4.p1.9.m9.1.1.3.2.2.cmml" xref="A4.p1.9.m9.1.1.3.2.2">𝒫</ci><ci id="A4.p1.9.m9.1.1.3.2.3.cmml" xref="A4.p1.9.m9.1.1.3.2.3">𝑐</ci></apply><apply id="A4.p1.9.m9.1.1.3.3.cmml" xref="A4.p1.9.m9.1.1.3.3"><plus id="A4.p1.9.m9.1.1.3.3.1.cmml" xref="A4.p1.9.m9.1.1.3.3.1"></plus><ci id="A4.p1.9.m9.1.1.3.3.2.cmml" xref="A4.p1.9.m9.1.1.3.3.2">𝑡</ci><cn id="A4.p1.9.m9.1.1.3.3.3.cmml" type="integer" xref="A4.p1.9.m9.1.1.3.3.3">1</cn></apply></apply><apply id="A4.p1.9.m9.1.1.1.cmml" xref="A4.p1.9.m9.1.1.1"><setdiff id="A4.p1.9.m9.1.1.1.2.cmml" xref="A4.p1.9.m9.1.1.1.2"></setdiff><apply id="A4.p1.9.m9.1.1.1.3.cmml" xref="A4.p1.9.m9.1.1.1.3"><csymbol cd="ambiguous" id="A4.p1.9.m9.1.1.1.3.1.cmml" xref="A4.p1.9.m9.1.1.1.3">subscript</csymbol><apply id="A4.p1.9.m9.1.1.1.3.2.cmml" xref="A4.p1.9.m9.1.1.1.3"><csymbol cd="ambiguous" id="A4.p1.9.m9.1.1.1.3.2.1.cmml" xref="A4.p1.9.m9.1.1.1.3">superscript</csymbol><ci id="A4.p1.9.m9.1.1.1.3.2.2.cmml" xref="A4.p1.9.m9.1.1.1.3.2.2">𝒫</ci><ci id="A4.p1.9.m9.1.1.1.3.2.3.cmml" xref="A4.p1.9.m9.1.1.1.3.2.3">𝑐</ci></apply><ci id="A4.p1.9.m9.1.1.1.3.3.cmml" xref="A4.p1.9.m9.1.1.1.3.3">𝑡</ci></apply><apply id="A4.p1.9.m9.1.1.1.1.1.1.cmml" xref="A4.p1.9.m9.1.1.1.1.1"><union id="A4.p1.9.m9.1.1.1.1.1.1.1.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.1"></union><apply id="A4.p1.9.m9.1.1.1.1.1.1.2.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.p1.9.m9.1.1.1.1.1.1.2.1.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.2">subscript</csymbol><apply id="A4.p1.9.m9.1.1.1.1.1.1.2.2.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.p1.9.m9.1.1.1.1.1.1.2.2.1.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.2">superscript</csymbol><apply id="A4.p1.9.m9.1.1.1.1.1.1.2.2.2.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.2.2.2"><ci id="A4.p1.9.m9.1.1.1.1.1.1.2.2.2.1.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="A4.p1.9.m9.1.1.1.1.1.1.2.2.2.2.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.2.2.2.2">𝒫</ci></apply><plus id="A4.p1.9.m9.1.1.1.1.1.1.2.2.3.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.2.2.3"></plus></apply><ci id="A4.p1.9.m9.1.1.1.1.1.1.2.3.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A4.p1.9.m9.1.1.1.1.1.1.3.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.p1.9.m9.1.1.1.1.1.1.3.1.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.3">subscript</csymbol><apply id="A4.p1.9.m9.1.1.1.1.1.1.3.2.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.p1.9.m9.1.1.1.1.1.1.3.2.1.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.3">superscript</csymbol><apply id="A4.p1.9.m9.1.1.1.1.1.1.3.2.2.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.3.2.2"><ci id="A4.p1.9.m9.1.1.1.1.1.1.3.2.2.1.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.3.2.2.1">^</ci><ci id="A4.p1.9.m9.1.1.1.1.1.1.3.2.2.2.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.3.2.2.2">𝒫</ci></apply><minus id="A4.p1.9.m9.1.1.1.1.1.1.3.2.3.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.3.2.3"></minus></apply><ci id="A4.p1.9.m9.1.1.1.1.1.1.3.3.cmml" xref="A4.p1.9.m9.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.9.m9.1c">\mathcal{P}^{c}_{t+1}=\mathcal{P}^{c}_{t}\setminus(\widehat{\mathcal{P}}^{+}_{%
t}\cup\widehat{\mathcal{P}}^{-}_{t})</annotation><annotation encoding="application/x-llamapun" id="A4.p1.9.m9.1d">caligraphic_P start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = caligraphic_P start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∖ ( over^ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∪ over^ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, the set of all the attribute values that the user has rejected until the <math alttext="t{+}1" class="ltx_Math" display="inline" id="A4.p1.10.m10.1"><semantics id="A4.p1.10.m10.1a"><mrow id="A4.p1.10.m10.1.1" xref="A4.p1.10.m10.1.1.cmml"><mi id="A4.p1.10.m10.1.1.2" xref="A4.p1.10.m10.1.1.2.cmml">t</mi><mo id="A4.p1.10.m10.1.1.1" xref="A4.p1.10.m10.1.1.1.cmml">+</mo><mn id="A4.p1.10.m10.1.1.3" xref="A4.p1.10.m10.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.10.m10.1b"><apply id="A4.p1.10.m10.1.1.cmml" xref="A4.p1.10.m10.1.1"><plus id="A4.p1.10.m10.1.1.1.cmml" xref="A4.p1.10.m10.1.1.1"></plus><ci id="A4.p1.10.m10.1.1.2.cmml" xref="A4.p1.10.m10.1.1.2">𝑡</ci><cn id="A4.p1.10.m10.1.1.3.cmml" type="integer" xref="A4.p1.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.10.m10.1c">t{+}1</annotation><annotation encoding="application/x-llamapun" id="A4.p1.10.m10.1d">italic_t + 1</annotation></semantics></math>-th turn is updated as <math alttext="\mathcal{P}^{-}_{t+1}=\mathcal{P}^{-}_{t}\cup\widehat{\mathcal{P}}^{-}_{t}" class="ltx_Math" display="inline" id="A4.p1.11.m11.1"><semantics id="A4.p1.11.m11.1a"><mrow id="A4.p1.11.m11.1.1" xref="A4.p1.11.m11.1.1.cmml"><msubsup id="A4.p1.11.m11.1.1.2" xref="A4.p1.11.m11.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.11.m11.1.1.2.2.2" xref="A4.p1.11.m11.1.1.2.2.2.cmml">𝒫</mi><mrow id="A4.p1.11.m11.1.1.2.3" xref="A4.p1.11.m11.1.1.2.3.cmml"><mi id="A4.p1.11.m11.1.1.2.3.2" xref="A4.p1.11.m11.1.1.2.3.2.cmml">t</mi><mo id="A4.p1.11.m11.1.1.2.3.1" xref="A4.p1.11.m11.1.1.2.3.1.cmml">+</mo><mn id="A4.p1.11.m11.1.1.2.3.3" xref="A4.p1.11.m11.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.p1.11.m11.1.1.2.2.3" xref="A4.p1.11.m11.1.1.2.2.3.cmml">−</mo></msubsup><mo id="A4.p1.11.m11.1.1.1" xref="A4.p1.11.m11.1.1.1.cmml">=</mo><mrow id="A4.p1.11.m11.1.1.3" xref="A4.p1.11.m11.1.1.3.cmml"><msubsup id="A4.p1.11.m11.1.1.3.2" xref="A4.p1.11.m11.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.11.m11.1.1.3.2.2.2" xref="A4.p1.11.m11.1.1.3.2.2.2.cmml">𝒫</mi><mi id="A4.p1.11.m11.1.1.3.2.3" xref="A4.p1.11.m11.1.1.3.2.3.cmml">t</mi><mo id="A4.p1.11.m11.1.1.3.2.2.3" xref="A4.p1.11.m11.1.1.3.2.2.3.cmml">−</mo></msubsup><mo id="A4.p1.11.m11.1.1.3.1" xref="A4.p1.11.m11.1.1.3.1.cmml">∪</mo><msubsup id="A4.p1.11.m11.1.1.3.3" xref="A4.p1.11.m11.1.1.3.3.cmml"><mover accent="true" id="A4.p1.11.m11.1.1.3.3.2.2" xref="A4.p1.11.m11.1.1.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.11.m11.1.1.3.3.2.2.2" xref="A4.p1.11.m11.1.1.3.3.2.2.2.cmml">𝒫</mi><mo id="A4.p1.11.m11.1.1.3.3.2.2.1" xref="A4.p1.11.m11.1.1.3.3.2.2.1.cmml">^</mo></mover><mi id="A4.p1.11.m11.1.1.3.3.3" xref="A4.p1.11.m11.1.1.3.3.3.cmml">t</mi><mo id="A4.p1.11.m11.1.1.3.3.2.3" xref="A4.p1.11.m11.1.1.3.3.2.3.cmml">−</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.11.m11.1b"><apply id="A4.p1.11.m11.1.1.cmml" xref="A4.p1.11.m11.1.1"><eq id="A4.p1.11.m11.1.1.1.cmml" xref="A4.p1.11.m11.1.1.1"></eq><apply id="A4.p1.11.m11.1.1.2.cmml" xref="A4.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="A4.p1.11.m11.1.1.2.1.cmml" xref="A4.p1.11.m11.1.1.2">subscript</csymbol><apply id="A4.p1.11.m11.1.1.2.2.cmml" xref="A4.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="A4.p1.11.m11.1.1.2.2.1.cmml" xref="A4.p1.11.m11.1.1.2">superscript</csymbol><ci id="A4.p1.11.m11.1.1.2.2.2.cmml" xref="A4.p1.11.m11.1.1.2.2.2">𝒫</ci><minus id="A4.p1.11.m11.1.1.2.2.3.cmml" xref="A4.p1.11.m11.1.1.2.2.3"></minus></apply><apply id="A4.p1.11.m11.1.1.2.3.cmml" xref="A4.p1.11.m11.1.1.2.3"><plus id="A4.p1.11.m11.1.1.2.3.1.cmml" xref="A4.p1.11.m11.1.1.2.3.1"></plus><ci id="A4.p1.11.m11.1.1.2.3.2.cmml" xref="A4.p1.11.m11.1.1.2.3.2">𝑡</ci><cn id="A4.p1.11.m11.1.1.2.3.3.cmml" type="integer" xref="A4.p1.11.m11.1.1.2.3.3">1</cn></apply></apply><apply id="A4.p1.11.m11.1.1.3.cmml" xref="A4.p1.11.m11.1.1.3"><union id="A4.p1.11.m11.1.1.3.1.cmml" xref="A4.p1.11.m11.1.1.3.1"></union><apply id="A4.p1.11.m11.1.1.3.2.cmml" xref="A4.p1.11.m11.1.1.3.2"><csymbol cd="ambiguous" id="A4.p1.11.m11.1.1.3.2.1.cmml" xref="A4.p1.11.m11.1.1.3.2">subscript</csymbol><apply id="A4.p1.11.m11.1.1.3.2.2.cmml" xref="A4.p1.11.m11.1.1.3.2"><csymbol cd="ambiguous" id="A4.p1.11.m11.1.1.3.2.2.1.cmml" xref="A4.p1.11.m11.1.1.3.2">superscript</csymbol><ci id="A4.p1.11.m11.1.1.3.2.2.2.cmml" xref="A4.p1.11.m11.1.1.3.2.2.2">𝒫</ci><minus id="A4.p1.11.m11.1.1.3.2.2.3.cmml" xref="A4.p1.11.m11.1.1.3.2.2.3"></minus></apply><ci id="A4.p1.11.m11.1.1.3.2.3.cmml" xref="A4.p1.11.m11.1.1.3.2.3">𝑡</ci></apply><apply id="A4.p1.11.m11.1.1.3.3.cmml" xref="A4.p1.11.m11.1.1.3.3"><csymbol cd="ambiguous" id="A4.p1.11.m11.1.1.3.3.1.cmml" xref="A4.p1.11.m11.1.1.3.3">subscript</csymbol><apply id="A4.p1.11.m11.1.1.3.3.2.cmml" xref="A4.p1.11.m11.1.1.3.3"><csymbol cd="ambiguous" id="A4.p1.11.m11.1.1.3.3.2.1.cmml" xref="A4.p1.11.m11.1.1.3.3">superscript</csymbol><apply id="A4.p1.11.m11.1.1.3.3.2.2.cmml" xref="A4.p1.11.m11.1.1.3.3.2.2"><ci id="A4.p1.11.m11.1.1.3.3.2.2.1.cmml" xref="A4.p1.11.m11.1.1.3.3.2.2.1">^</ci><ci id="A4.p1.11.m11.1.1.3.3.2.2.2.cmml" xref="A4.p1.11.m11.1.1.3.3.2.2.2">𝒫</ci></apply><minus id="A4.p1.11.m11.1.1.3.3.2.3.cmml" xref="A4.p1.11.m11.1.1.3.3.2.3"></minus></apply><ci id="A4.p1.11.m11.1.1.3.3.3.cmml" xref="A4.p1.11.m11.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.11.m11.1c">\mathcal{P}^{-}_{t+1}=\mathcal{P}^{-}_{t}\cup\widehat{\mathcal{P}}^{-}_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.11.m11.1d">caligraphic_P start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = caligraphic_P start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∪ over^ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and the set of all the attribute values that the user has accepted until the <math alttext="t{+}1" class="ltx_Math" display="inline" id="A4.p1.12.m12.1"><semantics id="A4.p1.12.m12.1a"><mrow id="A4.p1.12.m12.1.1" xref="A4.p1.12.m12.1.1.cmml"><mi id="A4.p1.12.m12.1.1.2" xref="A4.p1.12.m12.1.1.2.cmml">t</mi><mo id="A4.p1.12.m12.1.1.1" xref="A4.p1.12.m12.1.1.1.cmml">+</mo><mn id="A4.p1.12.m12.1.1.3" xref="A4.p1.12.m12.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.12.m12.1b"><apply id="A4.p1.12.m12.1.1.cmml" xref="A4.p1.12.m12.1.1"><plus id="A4.p1.12.m12.1.1.1.cmml" xref="A4.p1.12.m12.1.1.1"></plus><ci id="A4.p1.12.m12.1.1.2.cmml" xref="A4.p1.12.m12.1.1.2">𝑡</ci><cn id="A4.p1.12.m12.1.1.3.cmml" type="integer" xref="A4.p1.12.m12.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.12.m12.1c">t{+}1</annotation><annotation encoding="application/x-llamapun" id="A4.p1.12.m12.1d">italic_t + 1</annotation></semantics></math>-th turn is updated as <math alttext="\mathcal{P}^{+}_{t+1}=\mathcal{P}^{+}_{t}\cup\widehat{\mathcal{P}}^{+}_{t}" class="ltx_Math" display="inline" id="A4.p1.13.m13.1"><semantics id="A4.p1.13.m13.1a"><mrow id="A4.p1.13.m13.1.1" xref="A4.p1.13.m13.1.1.cmml"><msubsup id="A4.p1.13.m13.1.1.2" xref="A4.p1.13.m13.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.13.m13.1.1.2.2.2" xref="A4.p1.13.m13.1.1.2.2.2.cmml">𝒫</mi><mrow id="A4.p1.13.m13.1.1.2.3" xref="A4.p1.13.m13.1.1.2.3.cmml"><mi id="A4.p1.13.m13.1.1.2.3.2" xref="A4.p1.13.m13.1.1.2.3.2.cmml">t</mi><mo id="A4.p1.13.m13.1.1.2.3.1" xref="A4.p1.13.m13.1.1.2.3.1.cmml">+</mo><mn id="A4.p1.13.m13.1.1.2.3.3" xref="A4.p1.13.m13.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.p1.13.m13.1.1.2.2.3" xref="A4.p1.13.m13.1.1.2.2.3.cmml">+</mo></msubsup><mo id="A4.p1.13.m13.1.1.1" xref="A4.p1.13.m13.1.1.1.cmml">=</mo><mrow id="A4.p1.13.m13.1.1.3" xref="A4.p1.13.m13.1.1.3.cmml"><msubsup id="A4.p1.13.m13.1.1.3.2" xref="A4.p1.13.m13.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.13.m13.1.1.3.2.2.2" xref="A4.p1.13.m13.1.1.3.2.2.2.cmml">𝒫</mi><mi id="A4.p1.13.m13.1.1.3.2.3" xref="A4.p1.13.m13.1.1.3.2.3.cmml">t</mi><mo id="A4.p1.13.m13.1.1.3.2.2.3" xref="A4.p1.13.m13.1.1.3.2.2.3.cmml">+</mo></msubsup><mo id="A4.p1.13.m13.1.1.3.1" xref="A4.p1.13.m13.1.1.3.1.cmml">∪</mo><msubsup id="A4.p1.13.m13.1.1.3.3" xref="A4.p1.13.m13.1.1.3.3.cmml"><mover accent="true" id="A4.p1.13.m13.1.1.3.3.2.2" xref="A4.p1.13.m13.1.1.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.13.m13.1.1.3.3.2.2.2" xref="A4.p1.13.m13.1.1.3.3.2.2.2.cmml">𝒫</mi><mo id="A4.p1.13.m13.1.1.3.3.2.2.1" xref="A4.p1.13.m13.1.1.3.3.2.2.1.cmml">^</mo></mover><mi id="A4.p1.13.m13.1.1.3.3.3" xref="A4.p1.13.m13.1.1.3.3.3.cmml">t</mi><mo id="A4.p1.13.m13.1.1.3.3.2.3" xref="A4.p1.13.m13.1.1.3.3.2.3.cmml">+</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.13.m13.1b"><apply id="A4.p1.13.m13.1.1.cmml" xref="A4.p1.13.m13.1.1"><eq id="A4.p1.13.m13.1.1.1.cmml" xref="A4.p1.13.m13.1.1.1"></eq><apply id="A4.p1.13.m13.1.1.2.cmml" xref="A4.p1.13.m13.1.1.2"><csymbol cd="ambiguous" id="A4.p1.13.m13.1.1.2.1.cmml" xref="A4.p1.13.m13.1.1.2">subscript</csymbol><apply id="A4.p1.13.m13.1.1.2.2.cmml" xref="A4.p1.13.m13.1.1.2"><csymbol cd="ambiguous" id="A4.p1.13.m13.1.1.2.2.1.cmml" xref="A4.p1.13.m13.1.1.2">superscript</csymbol><ci id="A4.p1.13.m13.1.1.2.2.2.cmml" xref="A4.p1.13.m13.1.1.2.2.2">𝒫</ci><plus id="A4.p1.13.m13.1.1.2.2.3.cmml" xref="A4.p1.13.m13.1.1.2.2.3"></plus></apply><apply id="A4.p1.13.m13.1.1.2.3.cmml" xref="A4.p1.13.m13.1.1.2.3"><plus id="A4.p1.13.m13.1.1.2.3.1.cmml" xref="A4.p1.13.m13.1.1.2.3.1"></plus><ci id="A4.p1.13.m13.1.1.2.3.2.cmml" xref="A4.p1.13.m13.1.1.2.3.2">𝑡</ci><cn id="A4.p1.13.m13.1.1.2.3.3.cmml" type="integer" xref="A4.p1.13.m13.1.1.2.3.3">1</cn></apply></apply><apply id="A4.p1.13.m13.1.1.3.cmml" xref="A4.p1.13.m13.1.1.3"><union id="A4.p1.13.m13.1.1.3.1.cmml" xref="A4.p1.13.m13.1.1.3.1"></union><apply id="A4.p1.13.m13.1.1.3.2.cmml" xref="A4.p1.13.m13.1.1.3.2"><csymbol cd="ambiguous" id="A4.p1.13.m13.1.1.3.2.1.cmml" xref="A4.p1.13.m13.1.1.3.2">subscript</csymbol><apply id="A4.p1.13.m13.1.1.3.2.2.cmml" xref="A4.p1.13.m13.1.1.3.2"><csymbol cd="ambiguous" id="A4.p1.13.m13.1.1.3.2.2.1.cmml" xref="A4.p1.13.m13.1.1.3.2">superscript</csymbol><ci id="A4.p1.13.m13.1.1.3.2.2.2.cmml" xref="A4.p1.13.m13.1.1.3.2.2.2">𝒫</ci><plus id="A4.p1.13.m13.1.1.3.2.2.3.cmml" xref="A4.p1.13.m13.1.1.3.2.2.3"></plus></apply><ci id="A4.p1.13.m13.1.1.3.2.3.cmml" xref="A4.p1.13.m13.1.1.3.2.3">𝑡</ci></apply><apply id="A4.p1.13.m13.1.1.3.3.cmml" xref="A4.p1.13.m13.1.1.3.3"><csymbol cd="ambiguous" id="A4.p1.13.m13.1.1.3.3.1.cmml" xref="A4.p1.13.m13.1.1.3.3">subscript</csymbol><apply id="A4.p1.13.m13.1.1.3.3.2.cmml" xref="A4.p1.13.m13.1.1.3.3"><csymbol cd="ambiguous" id="A4.p1.13.m13.1.1.3.3.2.1.cmml" xref="A4.p1.13.m13.1.1.3.3">superscript</csymbol><apply id="A4.p1.13.m13.1.1.3.3.2.2.cmml" xref="A4.p1.13.m13.1.1.3.3.2.2"><ci id="A4.p1.13.m13.1.1.3.3.2.2.1.cmml" xref="A4.p1.13.m13.1.1.3.3.2.2.1">^</ci><ci id="A4.p1.13.m13.1.1.3.3.2.2.2.cmml" xref="A4.p1.13.m13.1.1.3.3.2.2.2">𝒫</ci></apply><plus id="A4.p1.13.m13.1.1.3.3.2.3.cmml" xref="A4.p1.13.m13.1.1.3.3.2.3"></plus></apply><ci id="A4.p1.13.m13.1.1.3.3.3.cmml" xref="A4.p1.13.m13.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.13.m13.1c">\mathcal{P}^{+}_{t+1}=\mathcal{P}^{+}_{t}\cup\widehat{\mathcal{P}}^{+}_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.13.m13.1d">caligraphic_P start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = caligraphic_P start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∪ over^ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
When the action is to recommend items, if the user rejects all the recommended items, we denote <math alttext="\widehat{\mathcal{V}}^{-}_{t}" class="ltx_Math" display="inline" id="A4.p1.14.m14.1"><semantics id="A4.p1.14.m14.1a"><msubsup id="A4.p1.14.m14.1.1" xref="A4.p1.14.m14.1.1.cmml"><mover accent="true" id="A4.p1.14.m14.1.1.2.2" xref="A4.p1.14.m14.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.14.m14.1.1.2.2.2" xref="A4.p1.14.m14.1.1.2.2.2.cmml">𝒱</mi><mo id="A4.p1.14.m14.1.1.2.2.1" xref="A4.p1.14.m14.1.1.2.2.1.cmml">^</mo></mover><mi id="A4.p1.14.m14.1.1.3" xref="A4.p1.14.m14.1.1.3.cmml">t</mi><mo id="A4.p1.14.m14.1.1.2.3" xref="A4.p1.14.m14.1.1.2.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="A4.p1.14.m14.1b"><apply id="A4.p1.14.m14.1.1.cmml" xref="A4.p1.14.m14.1.1"><csymbol cd="ambiguous" id="A4.p1.14.m14.1.1.1.cmml" xref="A4.p1.14.m14.1.1">subscript</csymbol><apply id="A4.p1.14.m14.1.1.2.cmml" xref="A4.p1.14.m14.1.1"><csymbol cd="ambiguous" id="A4.p1.14.m14.1.1.2.1.cmml" xref="A4.p1.14.m14.1.1">superscript</csymbol><apply id="A4.p1.14.m14.1.1.2.2.cmml" xref="A4.p1.14.m14.1.1.2.2"><ci id="A4.p1.14.m14.1.1.2.2.1.cmml" xref="A4.p1.14.m14.1.1.2.2.1">^</ci><ci id="A4.p1.14.m14.1.1.2.2.2.cmml" xref="A4.p1.14.m14.1.1.2.2.2">𝒱</ci></apply><minus id="A4.p1.14.m14.1.1.2.3.cmml" xref="A4.p1.14.m14.1.1.2.3"></minus></apply><ci id="A4.p1.14.m14.1.1.3.cmml" xref="A4.p1.14.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.14.m14.1c">\widehat{\mathcal{V}}^{-}_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.14.m14.1d">over^ start_ARG caligraphic_V end_ARG start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as the set of the recommended items at the current turn <math alttext="t" class="ltx_Math" display="inline" id="A4.p1.15.m15.1"><semantics id="A4.p1.15.m15.1a"><mi id="A4.p1.15.m15.1.1" xref="A4.p1.15.m15.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A4.p1.15.m15.1b"><ci id="A4.p1.15.m15.1.1.cmml" xref="A4.p1.15.m15.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.15.m15.1c">t</annotation><annotation encoding="application/x-llamapun" id="A4.p1.15.m15.1d">italic_t</annotation></semantics></math> that are all rejected, and the set of all items that the user has accepted until the <math alttext="t{+}1" class="ltx_Math" display="inline" id="A4.p1.16.m16.1"><semantics id="A4.p1.16.m16.1a"><mrow id="A4.p1.16.m16.1.1" xref="A4.p1.16.m16.1.1.cmml"><mi id="A4.p1.16.m16.1.1.2" xref="A4.p1.16.m16.1.1.2.cmml">t</mi><mo id="A4.p1.16.m16.1.1.1" xref="A4.p1.16.m16.1.1.1.cmml">+</mo><mn id="A4.p1.16.m16.1.1.3" xref="A4.p1.16.m16.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.16.m16.1b"><apply id="A4.p1.16.m16.1.1.cmml" xref="A4.p1.16.m16.1.1"><plus id="A4.p1.16.m16.1.1.1.cmml" xref="A4.p1.16.m16.1.1.1"></plus><ci id="A4.p1.16.m16.1.1.2.cmml" xref="A4.p1.16.m16.1.1.2">𝑡</ci><cn id="A4.p1.16.m16.1.1.3.cmml" type="integer" xref="A4.p1.16.m16.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.16.m16.1c">t{+}1</annotation><annotation encoding="application/x-llamapun" id="A4.p1.16.m16.1d">italic_t + 1</annotation></semantics></math>-th turn is updated as <math alttext="\mathcal{V}^{-}_{t+1}=\mathcal{V}^{-}_{t}\cup\widehat{\mathcal{V}}^{-}_{t}" class="ltx_Math" display="inline" id="A4.p1.17.m17.1"><semantics id="A4.p1.17.m17.1a"><mrow id="A4.p1.17.m17.1.1" xref="A4.p1.17.m17.1.1.cmml"><msubsup id="A4.p1.17.m17.1.1.2" xref="A4.p1.17.m17.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.17.m17.1.1.2.2.2" xref="A4.p1.17.m17.1.1.2.2.2.cmml">𝒱</mi><mrow id="A4.p1.17.m17.1.1.2.3" xref="A4.p1.17.m17.1.1.2.3.cmml"><mi id="A4.p1.17.m17.1.1.2.3.2" xref="A4.p1.17.m17.1.1.2.3.2.cmml">t</mi><mo id="A4.p1.17.m17.1.1.2.3.1" xref="A4.p1.17.m17.1.1.2.3.1.cmml">+</mo><mn id="A4.p1.17.m17.1.1.2.3.3" xref="A4.p1.17.m17.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.p1.17.m17.1.1.2.2.3" xref="A4.p1.17.m17.1.1.2.2.3.cmml">−</mo></msubsup><mo id="A4.p1.17.m17.1.1.1" xref="A4.p1.17.m17.1.1.1.cmml">=</mo><mrow id="A4.p1.17.m17.1.1.3" xref="A4.p1.17.m17.1.1.3.cmml"><msubsup id="A4.p1.17.m17.1.1.3.2" xref="A4.p1.17.m17.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.17.m17.1.1.3.2.2.2" xref="A4.p1.17.m17.1.1.3.2.2.2.cmml">𝒱</mi><mi id="A4.p1.17.m17.1.1.3.2.3" xref="A4.p1.17.m17.1.1.3.2.3.cmml">t</mi><mo id="A4.p1.17.m17.1.1.3.2.2.3" xref="A4.p1.17.m17.1.1.3.2.2.3.cmml">−</mo></msubsup><mo id="A4.p1.17.m17.1.1.3.1" xref="A4.p1.17.m17.1.1.3.1.cmml">∪</mo><msubsup id="A4.p1.17.m17.1.1.3.3" xref="A4.p1.17.m17.1.1.3.3.cmml"><mover accent="true" id="A4.p1.17.m17.1.1.3.3.2.2" xref="A4.p1.17.m17.1.1.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.17.m17.1.1.3.3.2.2.2" xref="A4.p1.17.m17.1.1.3.3.2.2.2.cmml">𝒱</mi><mo id="A4.p1.17.m17.1.1.3.3.2.2.1" xref="A4.p1.17.m17.1.1.3.3.2.2.1.cmml">^</mo></mover><mi id="A4.p1.17.m17.1.1.3.3.3" xref="A4.p1.17.m17.1.1.3.3.3.cmml">t</mi><mo id="A4.p1.17.m17.1.1.3.3.2.3" xref="A4.p1.17.m17.1.1.3.3.2.3.cmml">−</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.17.m17.1b"><apply id="A4.p1.17.m17.1.1.cmml" xref="A4.p1.17.m17.1.1"><eq id="A4.p1.17.m17.1.1.1.cmml" xref="A4.p1.17.m17.1.1.1"></eq><apply id="A4.p1.17.m17.1.1.2.cmml" xref="A4.p1.17.m17.1.1.2"><csymbol cd="ambiguous" id="A4.p1.17.m17.1.1.2.1.cmml" xref="A4.p1.17.m17.1.1.2">subscript</csymbol><apply id="A4.p1.17.m17.1.1.2.2.cmml" xref="A4.p1.17.m17.1.1.2"><csymbol cd="ambiguous" id="A4.p1.17.m17.1.1.2.2.1.cmml" xref="A4.p1.17.m17.1.1.2">superscript</csymbol><ci id="A4.p1.17.m17.1.1.2.2.2.cmml" xref="A4.p1.17.m17.1.1.2.2.2">𝒱</ci><minus id="A4.p1.17.m17.1.1.2.2.3.cmml" xref="A4.p1.17.m17.1.1.2.2.3"></minus></apply><apply id="A4.p1.17.m17.1.1.2.3.cmml" xref="A4.p1.17.m17.1.1.2.3"><plus id="A4.p1.17.m17.1.1.2.3.1.cmml" xref="A4.p1.17.m17.1.1.2.3.1"></plus><ci id="A4.p1.17.m17.1.1.2.3.2.cmml" xref="A4.p1.17.m17.1.1.2.3.2">𝑡</ci><cn id="A4.p1.17.m17.1.1.2.3.3.cmml" type="integer" xref="A4.p1.17.m17.1.1.2.3.3">1</cn></apply></apply><apply id="A4.p1.17.m17.1.1.3.cmml" xref="A4.p1.17.m17.1.1.3"><union id="A4.p1.17.m17.1.1.3.1.cmml" xref="A4.p1.17.m17.1.1.3.1"></union><apply id="A4.p1.17.m17.1.1.3.2.cmml" xref="A4.p1.17.m17.1.1.3.2"><csymbol cd="ambiguous" id="A4.p1.17.m17.1.1.3.2.1.cmml" xref="A4.p1.17.m17.1.1.3.2">subscript</csymbol><apply id="A4.p1.17.m17.1.1.3.2.2.cmml" xref="A4.p1.17.m17.1.1.3.2"><csymbol cd="ambiguous" id="A4.p1.17.m17.1.1.3.2.2.1.cmml" xref="A4.p1.17.m17.1.1.3.2">superscript</csymbol><ci id="A4.p1.17.m17.1.1.3.2.2.2.cmml" xref="A4.p1.17.m17.1.1.3.2.2.2">𝒱</ci><minus id="A4.p1.17.m17.1.1.3.2.2.3.cmml" xref="A4.p1.17.m17.1.1.3.2.2.3"></minus></apply><ci id="A4.p1.17.m17.1.1.3.2.3.cmml" xref="A4.p1.17.m17.1.1.3.2.3">𝑡</ci></apply><apply id="A4.p1.17.m17.1.1.3.3.cmml" xref="A4.p1.17.m17.1.1.3.3"><csymbol cd="ambiguous" id="A4.p1.17.m17.1.1.3.3.1.cmml" xref="A4.p1.17.m17.1.1.3.3">subscript</csymbol><apply id="A4.p1.17.m17.1.1.3.3.2.cmml" xref="A4.p1.17.m17.1.1.3.3"><csymbol cd="ambiguous" id="A4.p1.17.m17.1.1.3.3.2.1.cmml" xref="A4.p1.17.m17.1.1.3.3">superscript</csymbol><apply id="A4.p1.17.m17.1.1.3.3.2.2.cmml" xref="A4.p1.17.m17.1.1.3.3.2.2"><ci id="A4.p1.17.m17.1.1.3.3.2.2.1.cmml" xref="A4.p1.17.m17.1.1.3.3.2.2.1">^</ci><ci id="A4.p1.17.m17.1.1.3.3.2.2.2.cmml" xref="A4.p1.17.m17.1.1.3.3.2.2.2">𝒱</ci></apply><minus id="A4.p1.17.m17.1.1.3.3.2.3.cmml" xref="A4.p1.17.m17.1.1.3.3.2.3"></minus></apply><ci id="A4.p1.17.m17.1.1.3.3.3.cmml" xref="A4.p1.17.m17.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.17.m17.1c">\mathcal{V}^{-}_{t+1}=\mathcal{V}^{-}_{t}\cup\widehat{\mathcal{V}}^{-}_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.17.m17.1d">caligraphic_V start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = caligraphic_V start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∪ over^ start_ARG caligraphic_V end_ARG start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>; otherwise the conversation successfully finishes since the user has accepted at least one recommended item, and no state information is updated.
Finally, we update the candidate item set <math alttext="\mathcal{V}^{c}_{t+1}" class="ltx_Math" display="inline" id="A4.p1.18.m18.1"><semantics id="A4.p1.18.m18.1a"><msubsup id="A4.p1.18.m18.1.1" xref="A4.p1.18.m18.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.18.m18.1.1.2.2" xref="A4.p1.18.m18.1.1.2.2.cmml">𝒱</mi><mrow id="A4.p1.18.m18.1.1.3" xref="A4.p1.18.m18.1.1.3.cmml"><mi id="A4.p1.18.m18.1.1.3.2" xref="A4.p1.18.m18.1.1.3.2.cmml">t</mi><mo id="A4.p1.18.m18.1.1.3.1" xref="A4.p1.18.m18.1.1.3.1.cmml">+</mo><mn id="A4.p1.18.m18.1.1.3.3" xref="A4.p1.18.m18.1.1.3.3.cmml">1</mn></mrow><mi id="A4.p1.18.m18.1.1.2.3" xref="A4.p1.18.m18.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="A4.p1.18.m18.1b"><apply id="A4.p1.18.m18.1.1.cmml" xref="A4.p1.18.m18.1.1"><csymbol cd="ambiguous" id="A4.p1.18.m18.1.1.1.cmml" xref="A4.p1.18.m18.1.1">subscript</csymbol><apply id="A4.p1.18.m18.1.1.2.cmml" xref="A4.p1.18.m18.1.1"><csymbol cd="ambiguous" id="A4.p1.18.m18.1.1.2.1.cmml" xref="A4.p1.18.m18.1.1">superscript</csymbol><ci id="A4.p1.18.m18.1.1.2.2.cmml" xref="A4.p1.18.m18.1.1.2.2">𝒱</ci><ci id="A4.p1.18.m18.1.1.2.3.cmml" xref="A4.p1.18.m18.1.1.2.3">𝑐</ci></apply><apply id="A4.p1.18.m18.1.1.3.cmml" xref="A4.p1.18.m18.1.1.3"><plus id="A4.p1.18.m18.1.1.3.1.cmml" xref="A4.p1.18.m18.1.1.3.1"></plus><ci id="A4.p1.18.m18.1.1.3.2.cmml" xref="A4.p1.18.m18.1.1.3.2">𝑡</ci><cn id="A4.p1.18.m18.1.1.3.3.cmml" type="integer" xref="A4.p1.18.m18.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.18.m18.1c">\mathcal{V}^{c}_{t+1}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.18.m18.1d">caligraphic_V start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> at the next turn <math alttext="t{+}1" class="ltx_Math" display="inline" id="A4.p1.19.m19.1"><semantics id="A4.p1.19.m19.1a"><mrow id="A4.p1.19.m19.1.1" xref="A4.p1.19.m19.1.1.cmml"><mi id="A4.p1.19.m19.1.1.2" xref="A4.p1.19.m19.1.1.2.cmml">t</mi><mo id="A4.p1.19.m19.1.1.1" xref="A4.p1.19.m19.1.1.1.cmml">+</mo><mn id="A4.p1.19.m19.1.1.3" xref="A4.p1.19.m19.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.19.m19.1b"><apply id="A4.p1.19.m19.1.1.cmml" xref="A4.p1.19.m19.1.1"><plus id="A4.p1.19.m19.1.1.1.cmml" xref="A4.p1.19.m19.1.1.1"></plus><ci id="A4.p1.19.m19.1.1.2.cmml" xref="A4.p1.19.m19.1.1.2">𝑡</ci><cn id="A4.p1.19.m19.1.1.3.cmml" type="integer" xref="A4.p1.19.m19.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.19.m19.1c">t{+}1</annotation><annotation encoding="application/x-llamapun" id="A4.p1.19.m19.1d">italic_t + 1</annotation></semantics></math> to include only those items that are still not rejected and whose attribute values have an intersection with the set of the accepted attribute values: <math alttext="\mathcal{V}^{c}_{t+1}=\{v|(v{\in}\mathcal{V}_{p_{0}}{\setminus}\mathcal{V}^{-}%
_{t+1})\wedge(\mathcal{P}(v)\cap\mathcal{P}^{+}_{t+1}{\neq}\emptyset)\wedge(%
\mathcal{P}(v)\cap\mathcal{P}^{-}_{t+1}{=}\emptyset)\}" class="ltx_Math" display="inline" id="A4.p1.20.m20.4"><semantics id="A4.p1.20.m20.4a"><mrow id="A4.p1.20.m20.4.4" xref="A4.p1.20.m20.4.4.cmml"><msubsup id="A4.p1.20.m20.4.4.3" xref="A4.p1.20.m20.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.20.m20.4.4.3.2.2" xref="A4.p1.20.m20.4.4.3.2.2.cmml">𝒱</mi><mrow id="A4.p1.20.m20.4.4.3.3" xref="A4.p1.20.m20.4.4.3.3.cmml"><mi id="A4.p1.20.m20.4.4.3.3.2" xref="A4.p1.20.m20.4.4.3.3.2.cmml">t</mi><mo id="A4.p1.20.m20.4.4.3.3.1" xref="A4.p1.20.m20.4.4.3.3.1.cmml">+</mo><mn id="A4.p1.20.m20.4.4.3.3.3" xref="A4.p1.20.m20.4.4.3.3.3.cmml">1</mn></mrow><mi id="A4.p1.20.m20.4.4.3.2.3" xref="A4.p1.20.m20.4.4.3.2.3.cmml">c</mi></msubsup><mo id="A4.p1.20.m20.4.4.2" xref="A4.p1.20.m20.4.4.2.cmml">=</mo><mrow id="A4.p1.20.m20.4.4.1.1" xref="A4.p1.20.m20.4.4.1.2.cmml"><mo id="A4.p1.20.m20.4.4.1.1.2" stretchy="false" xref="A4.p1.20.m20.4.4.1.2.1.cmml">{</mo><mi id="A4.p1.20.m20.3.3" xref="A4.p1.20.m20.3.3.cmml">v</mi><mo id="A4.p1.20.m20.4.4.1.1.3" lspace="0em" rspace="0em" xref="A4.p1.20.m20.4.4.1.2.1.cmml">|</mo><mrow id="A4.p1.20.m20.4.4.1.1.1" xref="A4.p1.20.m20.4.4.1.1.1.cmml"><mrow id="A4.p1.20.m20.4.4.1.1.1.1.1" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.cmml"><mo id="A4.p1.20.m20.4.4.1.1.1.1.1.2" stretchy="false" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.p1.20.m20.4.4.1.1.1.1.1.1" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.cmml"><mi id="A4.p1.20.m20.4.4.1.1.1.1.1.1.2" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.2.cmml">v</mi><mo id="A4.p1.20.m20.4.4.1.1.1.1.1.1.1" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.1.cmml">∈</mo><mrow id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.cmml"><msub id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.2" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.2.cmml">𝒱</mi><msub id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3.cmml"><mi id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3.2" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3.2.cmml">p</mi><mn id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3.3" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3.3.cmml">0</mn></msub></msub><mo id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.1" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.1.cmml">∖</mo><msubsup id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.2.2" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.2.2.cmml">𝒱</mi><mrow id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.cmml"><mi id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.2" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.1" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mn id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.3" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow><mo id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.2.3" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.2.3.cmml">−</mo></msubsup></mrow></mrow><mo id="A4.p1.20.m20.4.4.1.1.1.1.1.3" stretchy="false" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A4.p1.20.m20.4.4.1.1.1.4" xref="A4.p1.20.m20.4.4.1.1.1.4.cmml">∧</mo><mrow id="A4.p1.20.m20.4.4.1.1.1.2.1" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.cmml"><mo id="A4.p1.20.m20.4.4.1.1.1.2.1.2" stretchy="false" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.cmml">(</mo><mrow id="A4.p1.20.m20.4.4.1.1.1.2.1.1" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.cmml"><mrow id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.cmml"><mrow id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.2" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.2.cmml">𝒫</mi><mo id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.1" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.1.cmml">⁢</mo><mrow id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.3.2" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.cmml"><mo id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.3.2.1" stretchy="false" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.cmml">(</mo><mi id="A4.p1.20.m20.1.1" xref="A4.p1.20.m20.1.1.cmml">v</mi><mo id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.3.2.2" stretchy="false" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.cmml">)</mo></mrow></mrow><mo id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.1" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.1.cmml">∩</mo><msubsup id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.2.2" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.2.2.cmml">𝒫</mi><mrow id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.cmml"><mi id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.2" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.2.cmml">t</mi><mo id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.1" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.1.cmml">+</mo><mn id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.3" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.3.cmml">1</mn></mrow><mo id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.2.3" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.2.3.cmml">+</mo></msubsup></mrow><mo id="A4.p1.20.m20.4.4.1.1.1.2.1.1.1" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.1.cmml">≠</mo><mi id="A4.p1.20.m20.4.4.1.1.1.2.1.1.3" mathvariant="normal" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.3.cmml">∅</mi></mrow><mo id="A4.p1.20.m20.4.4.1.1.1.2.1.3" stretchy="false" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.cmml">)</mo></mrow><mo id="A4.p1.20.m20.4.4.1.1.1.4a" xref="A4.p1.20.m20.4.4.1.1.1.4.cmml">∧</mo><mrow id="A4.p1.20.m20.4.4.1.1.1.3.1" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.cmml"><mo id="A4.p1.20.m20.4.4.1.1.1.3.1.2" stretchy="false" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.cmml">(</mo><mrow id="A4.p1.20.m20.4.4.1.1.1.3.1.1" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.cmml"><mrow id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.cmml"><mrow id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.2" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.2.cmml">𝒫</mi><mo id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.1" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.1.cmml">⁢</mo><mrow id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.3.2" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.cmml"><mo id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.3.2.1" stretchy="false" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.cmml">(</mo><mi id="A4.p1.20.m20.2.2" xref="A4.p1.20.m20.2.2.cmml">v</mi><mo id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.3.2.2" stretchy="false" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.cmml">)</mo></mrow></mrow><mo id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.1" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.1.cmml">∩</mo><msubsup id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.2.2" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.2.2.cmml">𝒫</mi><mrow id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.cmml"><mi id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.2" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.2.cmml">t</mi><mo id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.1" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.1.cmml">+</mo><mn id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.3" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.3.cmml">1</mn></mrow><mo id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.2.3" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.2.3.cmml">−</mo></msubsup></mrow><mo id="A4.p1.20.m20.4.4.1.1.1.3.1.1.1" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.1.cmml">=</mo><mi id="A4.p1.20.m20.4.4.1.1.1.3.1.1.3" mathvariant="normal" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.3.cmml">∅</mi></mrow><mo id="A4.p1.20.m20.4.4.1.1.1.3.1.3" stretchy="false" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.cmml">)</mo></mrow></mrow><mo id="A4.p1.20.m20.4.4.1.1.4" stretchy="false" xref="A4.p1.20.m20.4.4.1.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.20.m20.4b"><apply id="A4.p1.20.m20.4.4.cmml" xref="A4.p1.20.m20.4.4"><eq id="A4.p1.20.m20.4.4.2.cmml" xref="A4.p1.20.m20.4.4.2"></eq><apply id="A4.p1.20.m20.4.4.3.cmml" xref="A4.p1.20.m20.4.4.3"><csymbol cd="ambiguous" id="A4.p1.20.m20.4.4.3.1.cmml" xref="A4.p1.20.m20.4.4.3">subscript</csymbol><apply id="A4.p1.20.m20.4.4.3.2.cmml" xref="A4.p1.20.m20.4.4.3"><csymbol cd="ambiguous" id="A4.p1.20.m20.4.4.3.2.1.cmml" xref="A4.p1.20.m20.4.4.3">superscript</csymbol><ci id="A4.p1.20.m20.4.4.3.2.2.cmml" xref="A4.p1.20.m20.4.4.3.2.2">𝒱</ci><ci id="A4.p1.20.m20.4.4.3.2.3.cmml" xref="A4.p1.20.m20.4.4.3.2.3">𝑐</ci></apply><apply id="A4.p1.20.m20.4.4.3.3.cmml" xref="A4.p1.20.m20.4.4.3.3"><plus id="A4.p1.20.m20.4.4.3.3.1.cmml" xref="A4.p1.20.m20.4.4.3.3.1"></plus><ci id="A4.p1.20.m20.4.4.3.3.2.cmml" xref="A4.p1.20.m20.4.4.3.3.2">𝑡</ci><cn id="A4.p1.20.m20.4.4.3.3.3.cmml" type="integer" xref="A4.p1.20.m20.4.4.3.3.3">1</cn></apply></apply><apply id="A4.p1.20.m20.4.4.1.2.cmml" xref="A4.p1.20.m20.4.4.1.1"><csymbol cd="latexml" id="A4.p1.20.m20.4.4.1.2.1.cmml" xref="A4.p1.20.m20.4.4.1.1.2">conditional-set</csymbol><ci id="A4.p1.20.m20.3.3.cmml" xref="A4.p1.20.m20.3.3">𝑣</ci><apply id="A4.p1.20.m20.4.4.1.1.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1"><and id="A4.p1.20.m20.4.4.1.1.1.4.cmml" xref="A4.p1.20.m20.4.4.1.1.1.4"></and><apply id="A4.p1.20.m20.4.4.1.1.1.1.1.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1"><in id="A4.p1.20.m20.4.4.1.1.1.1.1.1.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.1"></in><ci id="A4.p1.20.m20.4.4.1.1.1.1.1.1.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.2">𝑣</ci><apply id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3"><setdiff id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.1"></setdiff><apply id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.2">𝒱</ci><apply id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3.2">𝑝</ci><cn id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.2.3.3">0</cn></apply></apply><apply id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.2.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.2.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.2.2">𝒱</ci><minus id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.2.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.2.3"></minus></apply><apply id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3"><plus id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.1"></plus><ci id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn id="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="A4.p1.20.m20.4.4.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply><apply id="A4.p1.20.m20.4.4.1.1.1.2.1.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1"><neq id="A4.p1.20.m20.4.4.1.1.1.2.1.1.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.1"></neq><apply id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2"><intersect id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.1"></intersect><apply id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2"><times id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.1"></times><ci id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.2.2">𝒫</ci><ci id="A4.p1.20.m20.1.1.cmml" xref="A4.p1.20.m20.1.1">𝑣</ci></apply><apply id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3"><csymbol cd="ambiguous" id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3">subscript</csymbol><apply id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3"><csymbol cd="ambiguous" id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.2.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3">superscript</csymbol><ci id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.2.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.2.2">𝒫</ci><plus id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.2.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.2.3"></plus></apply><apply id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3"><plus id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.1"></plus><ci id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.2">𝑡</ci><cn id="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.3.cmml" type="integer" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.2.3.3.3">1</cn></apply></apply></apply><emptyset id="A4.p1.20.m20.4.4.1.1.1.2.1.1.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.2.1.1.3"></emptyset></apply><apply id="A4.p1.20.m20.4.4.1.1.1.3.1.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1"><eq id="A4.p1.20.m20.4.4.1.1.1.3.1.1.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.1"></eq><apply id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2"><intersect id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.1"></intersect><apply id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2"><times id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.1"></times><ci id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.2.2">𝒫</ci><ci id="A4.p1.20.m20.2.2.cmml" xref="A4.p1.20.m20.2.2">𝑣</ci></apply><apply id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3"><csymbol cd="ambiguous" id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3">subscript</csymbol><apply id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3"><csymbol cd="ambiguous" id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.2.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3">superscript</csymbol><ci id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.2.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.2.2">𝒫</ci><minus id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.2.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.2.3"></minus></apply><apply id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3"><plus id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.1.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.1"></plus><ci id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.2.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.2">𝑡</ci><cn id="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.3.cmml" type="integer" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.2.3.3.3">1</cn></apply></apply></apply><emptyset id="A4.p1.20.m20.4.4.1.1.1.3.1.1.3.cmml" xref="A4.p1.20.m20.4.4.1.1.1.3.1.1.3"></emptyset></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.20.m20.4c">\mathcal{V}^{c}_{t+1}=\{v|(v{\in}\mathcal{V}_{p_{0}}{\setminus}\mathcal{V}^{-}%
_{t+1})\wedge(\mathcal{P}(v)\cap\mathcal{P}^{+}_{t+1}{\neq}\emptyset)\wedge(%
\mathcal{P}(v)\cap\mathcal{P}^{-}_{t+1}{=}\emptyset)\}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.20.m20.4d">caligraphic_V start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = { italic_v | ( italic_v ∈ caligraphic_V start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∖ caligraphic_V start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ∧ ( caligraphic_P ( italic_v ) ∩ caligraphic_P start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ≠ ∅ ) ∧ ( caligraphic_P ( italic_v ) ∩ caligraphic_P start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = ∅ ) }</annotation></semantics></math>, where <math alttext="\mathcal{V}_{p_{0}}" class="ltx_Math" display="inline" id="A4.p1.21.m21.1"><semantics id="A4.p1.21.m21.1a"><msub id="A4.p1.21.m21.1.1" xref="A4.p1.21.m21.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.21.m21.1.1.2" xref="A4.p1.21.m21.1.1.2.cmml">𝒱</mi><msub id="A4.p1.21.m21.1.1.3" xref="A4.p1.21.m21.1.1.3.cmml"><mi id="A4.p1.21.m21.1.1.3.2" xref="A4.p1.21.m21.1.1.3.2.cmml">p</mi><mn id="A4.p1.21.m21.1.1.3.3" xref="A4.p1.21.m21.1.1.3.3.cmml">0</mn></msub></msub><annotation-xml encoding="MathML-Content" id="A4.p1.21.m21.1b"><apply id="A4.p1.21.m21.1.1.cmml" xref="A4.p1.21.m21.1.1"><csymbol cd="ambiguous" id="A4.p1.21.m21.1.1.1.cmml" xref="A4.p1.21.m21.1.1">subscript</csymbol><ci id="A4.p1.21.m21.1.1.2.cmml" xref="A4.p1.21.m21.1.1.2">𝒱</ci><apply id="A4.p1.21.m21.1.1.3.cmml" xref="A4.p1.21.m21.1.1.3"><csymbol cd="ambiguous" id="A4.p1.21.m21.1.1.3.1.cmml" xref="A4.p1.21.m21.1.1.3">subscript</csymbol><ci id="A4.p1.21.m21.1.1.3.2.cmml" xref="A4.p1.21.m21.1.1.3.2">𝑝</ci><cn id="A4.p1.21.m21.1.1.3.3.cmml" type="integer" xref="A4.p1.21.m21.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.21.m21.1c">\mathcal{V}_{p_{0}}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.21.m21.1d">caligraphic_V start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> denotes the set of items that are associated with the attribute value <math alttext="p_{0}" class="ltx_Math" display="inline" id="A4.p1.22.m22.1"><semantics id="A4.p1.22.m22.1a"><msub id="A4.p1.22.m22.1.1" xref="A4.p1.22.m22.1.1.cmml"><mi id="A4.p1.22.m22.1.1.2" xref="A4.p1.22.m22.1.1.2.cmml">p</mi><mn id="A4.p1.22.m22.1.1.3" xref="A4.p1.22.m22.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A4.p1.22.m22.1b"><apply id="A4.p1.22.m22.1.1.cmml" xref="A4.p1.22.m22.1.1"><csymbol cd="ambiguous" id="A4.p1.22.m22.1.1.1.cmml" xref="A4.p1.22.m22.1.1">subscript</csymbol><ci id="A4.p1.22.m22.1.1.2.cmml" xref="A4.p1.22.m22.1.1.2">𝑝</ci><cn id="A4.p1.22.m22.1.1.3.cmml" type="integer" xref="A4.p1.22.m22.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.22.m22.1c">p_{0}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.22.m22.1d">italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> specified by the user at the start of the conversation.</p>
</div>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Reward Function</h2>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.9">Following the literature <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib26" title="">2020a</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>)</cite>, for different conversation scenarios, we consider five kinds of immediate rewards at given conversational turn: (1) <math alttext="r^{+}_{\rm{rec}}=1" class="ltx_Math" display="inline" id="A5.p1.1.m1.1"><semantics id="A5.p1.1.m1.1a"><mrow id="A5.p1.1.m1.1.1" xref="A5.p1.1.m1.1.1.cmml"><msubsup id="A5.p1.1.m1.1.1.2" xref="A5.p1.1.m1.1.1.2.cmml"><mi id="A5.p1.1.m1.1.1.2.2.2" xref="A5.p1.1.m1.1.1.2.2.2.cmml">r</mi><mi id="A5.p1.1.m1.1.1.2.3" xref="A5.p1.1.m1.1.1.2.3.cmml">rec</mi><mo id="A5.p1.1.m1.1.1.2.2.3" xref="A5.p1.1.m1.1.1.2.2.3.cmml">+</mo></msubsup><mo id="A5.p1.1.m1.1.1.1" xref="A5.p1.1.m1.1.1.1.cmml">=</mo><mn id="A5.p1.1.m1.1.1.3" xref="A5.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.1.m1.1b"><apply id="A5.p1.1.m1.1.1.cmml" xref="A5.p1.1.m1.1.1"><eq id="A5.p1.1.m1.1.1.1.cmml" xref="A5.p1.1.m1.1.1.1"></eq><apply id="A5.p1.1.m1.1.1.2.cmml" xref="A5.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A5.p1.1.m1.1.1.2.1.cmml" xref="A5.p1.1.m1.1.1.2">subscript</csymbol><apply id="A5.p1.1.m1.1.1.2.2.cmml" xref="A5.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A5.p1.1.m1.1.1.2.2.1.cmml" xref="A5.p1.1.m1.1.1.2">superscript</csymbol><ci id="A5.p1.1.m1.1.1.2.2.2.cmml" xref="A5.p1.1.m1.1.1.2.2.2">𝑟</ci><plus id="A5.p1.1.m1.1.1.2.2.3.cmml" xref="A5.p1.1.m1.1.1.2.2.3"></plus></apply><ci id="A5.p1.1.m1.1.1.2.3.cmml" xref="A5.p1.1.m1.1.1.2.3">rec</ci></apply><cn id="A5.p1.1.m1.1.1.3.cmml" type="integer" xref="A5.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.1.m1.1c">r^{+}_{\rm{rec}}=1</annotation><annotation encoding="application/x-llamapun" id="A5.p1.1.m1.1d">italic_r start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_rec end_POSTSUBSCRIPT = 1</annotation></semantics></math>: a large positive value when the user accepts a recommended item; (2) <math alttext="r^{+}_{\rm{ask}}=0.01" class="ltx_Math" display="inline" id="A5.p1.2.m2.1"><semantics id="A5.p1.2.m2.1a"><mrow id="A5.p1.2.m2.1.1" xref="A5.p1.2.m2.1.1.cmml"><msubsup id="A5.p1.2.m2.1.1.2" xref="A5.p1.2.m2.1.1.2.cmml"><mi id="A5.p1.2.m2.1.1.2.2.2" xref="A5.p1.2.m2.1.1.2.2.2.cmml">r</mi><mi id="A5.p1.2.m2.1.1.2.3" xref="A5.p1.2.m2.1.1.2.3.cmml">ask</mi><mo id="A5.p1.2.m2.1.1.2.2.3" xref="A5.p1.2.m2.1.1.2.2.3.cmml">+</mo></msubsup><mo id="A5.p1.2.m2.1.1.1" xref="A5.p1.2.m2.1.1.1.cmml">=</mo><mn id="A5.p1.2.m2.1.1.3" xref="A5.p1.2.m2.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.2.m2.1b"><apply id="A5.p1.2.m2.1.1.cmml" xref="A5.p1.2.m2.1.1"><eq id="A5.p1.2.m2.1.1.1.cmml" xref="A5.p1.2.m2.1.1.1"></eq><apply id="A5.p1.2.m2.1.1.2.cmml" xref="A5.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A5.p1.2.m2.1.1.2.1.cmml" xref="A5.p1.2.m2.1.1.2">subscript</csymbol><apply id="A5.p1.2.m2.1.1.2.2.cmml" xref="A5.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A5.p1.2.m2.1.1.2.2.1.cmml" xref="A5.p1.2.m2.1.1.2">superscript</csymbol><ci id="A5.p1.2.m2.1.1.2.2.2.cmml" xref="A5.p1.2.m2.1.1.2.2.2">𝑟</ci><plus id="A5.p1.2.m2.1.1.2.2.3.cmml" xref="A5.p1.2.m2.1.1.2.2.3"></plus></apply><ci id="A5.p1.2.m2.1.1.2.3.cmml" xref="A5.p1.2.m2.1.1.2.3">ask</ci></apply><cn id="A5.p1.2.m2.1.1.3.cmml" type="float" xref="A5.p1.2.m2.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.2.m2.1c">r^{+}_{\rm{ask}}=0.01</annotation><annotation encoding="application/x-llamapun" id="A5.p1.2.m2.1d">italic_r start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ask end_POSTSUBSCRIPT = 0.01</annotation></semantics></math>: a small positive value when the user accepts an attribute value asked by <span class="ltx_text" id="A5.p1.3.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A5.p1.3.1.m1.1"><semantics id="A5.p1.3.1.m1.1a"><mrow id="A5.p1.3.1.m1.1.1" xref="A5.p1.3.1.m1.1.1.cmml"><mi id="A5.p1.3.1.m1.1.1.2" xref="A5.p1.3.1.m1.1.1.2.cmml">𝚂</mi><mo id="A5.p1.3.1.m1.1.1.1" xref="A5.p1.3.1.m1.1.1.1.cmml">⁢</mo><mtext id="A5.p1.3.1.m1.1.1.3" xref="A5.p1.3.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.3.1.m1.1b"><apply id="A5.p1.3.1.m1.1.1.cmml" xref="A5.p1.3.1.m1.1.1"><times id="A5.p1.3.1.m1.1.1.1.cmml" xref="A5.p1.3.1.m1.1.1.1"></times><ci id="A5.p1.3.1.m1.1.1.2.cmml" xref="A5.p1.3.1.m1.1.1.2">𝚂</ci><ci id="A5.p1.3.1.m1.1.1.3a.cmml" xref="A5.p1.3.1.m1.1.1.3"><mtext id="A5.p1.3.1.m1.1.1.3.cmml" xref="A5.p1.3.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.3.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A5.p1.3.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span>; (3) <math alttext="r^{-}_{\rm{rec}}=-0.1" class="ltx_Math" display="inline" id="A5.p1.4.m3.1"><semantics id="A5.p1.4.m3.1a"><mrow id="A5.p1.4.m3.1.1" xref="A5.p1.4.m3.1.1.cmml"><msubsup id="A5.p1.4.m3.1.1.2" xref="A5.p1.4.m3.1.1.2.cmml"><mi id="A5.p1.4.m3.1.1.2.2.2" xref="A5.p1.4.m3.1.1.2.2.2.cmml">r</mi><mi id="A5.p1.4.m3.1.1.2.3" xref="A5.p1.4.m3.1.1.2.3.cmml">rec</mi><mo id="A5.p1.4.m3.1.1.2.2.3" xref="A5.p1.4.m3.1.1.2.2.3.cmml">−</mo></msubsup><mo id="A5.p1.4.m3.1.1.1" xref="A5.p1.4.m3.1.1.1.cmml">=</mo><mrow id="A5.p1.4.m3.1.1.3" xref="A5.p1.4.m3.1.1.3.cmml"><mo id="A5.p1.4.m3.1.1.3a" xref="A5.p1.4.m3.1.1.3.cmml">−</mo><mn id="A5.p1.4.m3.1.1.3.2" xref="A5.p1.4.m3.1.1.3.2.cmml">0.1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.4.m3.1b"><apply id="A5.p1.4.m3.1.1.cmml" xref="A5.p1.4.m3.1.1"><eq id="A5.p1.4.m3.1.1.1.cmml" xref="A5.p1.4.m3.1.1.1"></eq><apply id="A5.p1.4.m3.1.1.2.cmml" xref="A5.p1.4.m3.1.1.2"><csymbol cd="ambiguous" id="A5.p1.4.m3.1.1.2.1.cmml" xref="A5.p1.4.m3.1.1.2">subscript</csymbol><apply id="A5.p1.4.m3.1.1.2.2.cmml" xref="A5.p1.4.m3.1.1.2"><csymbol cd="ambiguous" id="A5.p1.4.m3.1.1.2.2.1.cmml" xref="A5.p1.4.m3.1.1.2">superscript</csymbol><ci id="A5.p1.4.m3.1.1.2.2.2.cmml" xref="A5.p1.4.m3.1.1.2.2.2">𝑟</ci><minus id="A5.p1.4.m3.1.1.2.2.3.cmml" xref="A5.p1.4.m3.1.1.2.2.3"></minus></apply><ci id="A5.p1.4.m3.1.1.2.3.cmml" xref="A5.p1.4.m3.1.1.2.3">rec</ci></apply><apply id="A5.p1.4.m3.1.1.3.cmml" xref="A5.p1.4.m3.1.1.3"><minus id="A5.p1.4.m3.1.1.3.1.cmml" xref="A5.p1.4.m3.1.1.3"></minus><cn id="A5.p1.4.m3.1.1.3.2.cmml" type="float" xref="A5.p1.4.m3.1.1.3.2">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.4.m3.1c">r^{-}_{\rm{rec}}=-0.1</annotation><annotation encoding="application/x-llamapun" id="A5.p1.4.m3.1d">italic_r start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_rec end_POSTSUBSCRIPT = - 0.1</annotation></semantics></math>: a negative value when the user rejects a recommended item; (4) <math alttext="r^{-}_{\rm{ask}}=-0.1" class="ltx_Math" display="inline" id="A5.p1.5.m4.1"><semantics id="A5.p1.5.m4.1a"><mrow id="A5.p1.5.m4.1.1" xref="A5.p1.5.m4.1.1.cmml"><msubsup id="A5.p1.5.m4.1.1.2" xref="A5.p1.5.m4.1.1.2.cmml"><mi id="A5.p1.5.m4.1.1.2.2.2" xref="A5.p1.5.m4.1.1.2.2.2.cmml">r</mi><mi id="A5.p1.5.m4.1.1.2.3" xref="A5.p1.5.m4.1.1.2.3.cmml">ask</mi><mo id="A5.p1.5.m4.1.1.2.2.3" xref="A5.p1.5.m4.1.1.2.2.3.cmml">−</mo></msubsup><mo id="A5.p1.5.m4.1.1.1" xref="A5.p1.5.m4.1.1.1.cmml">=</mo><mrow id="A5.p1.5.m4.1.1.3" xref="A5.p1.5.m4.1.1.3.cmml"><mo id="A5.p1.5.m4.1.1.3a" xref="A5.p1.5.m4.1.1.3.cmml">−</mo><mn id="A5.p1.5.m4.1.1.3.2" xref="A5.p1.5.m4.1.1.3.2.cmml">0.1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.5.m4.1b"><apply id="A5.p1.5.m4.1.1.cmml" xref="A5.p1.5.m4.1.1"><eq id="A5.p1.5.m4.1.1.1.cmml" xref="A5.p1.5.m4.1.1.1"></eq><apply id="A5.p1.5.m4.1.1.2.cmml" xref="A5.p1.5.m4.1.1.2"><csymbol cd="ambiguous" id="A5.p1.5.m4.1.1.2.1.cmml" xref="A5.p1.5.m4.1.1.2">subscript</csymbol><apply id="A5.p1.5.m4.1.1.2.2.cmml" xref="A5.p1.5.m4.1.1.2"><csymbol cd="ambiguous" id="A5.p1.5.m4.1.1.2.2.1.cmml" xref="A5.p1.5.m4.1.1.2">superscript</csymbol><ci id="A5.p1.5.m4.1.1.2.2.2.cmml" xref="A5.p1.5.m4.1.1.2.2.2">𝑟</ci><minus id="A5.p1.5.m4.1.1.2.2.3.cmml" xref="A5.p1.5.m4.1.1.2.2.3"></minus></apply><ci id="A5.p1.5.m4.1.1.2.3.cmml" xref="A5.p1.5.m4.1.1.2.3">ask</ci></apply><apply id="A5.p1.5.m4.1.1.3.cmml" xref="A5.p1.5.m4.1.1.3"><minus id="A5.p1.5.m4.1.1.3.1.cmml" xref="A5.p1.5.m4.1.1.3"></minus><cn id="A5.p1.5.m4.1.1.3.2.cmml" type="float" xref="A5.p1.5.m4.1.1.3.2">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.5.m4.1c">r^{-}_{\rm{ask}}=-0.1</annotation><annotation encoding="application/x-llamapun" id="A5.p1.5.m4.1d">italic_r start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ask end_POSTSUBSCRIPT = - 0.1</annotation></semantics></math>: a negative value when the user rejects an attribute value asked by <span class="ltx_text" id="A5.p1.6.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A5.p1.6.2.m1.1"><semantics id="A5.p1.6.2.m1.1a"><mrow id="A5.p1.6.2.m1.1.1" xref="A5.p1.6.2.m1.1.1.cmml"><mi id="A5.p1.6.2.m1.1.1.2" xref="A5.p1.6.2.m1.1.1.2.cmml">𝚂</mi><mo id="A5.p1.6.2.m1.1.1.1" xref="A5.p1.6.2.m1.1.1.1.cmml">⁢</mo><mtext id="A5.p1.6.2.m1.1.1.3" xref="A5.p1.6.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.6.2.m1.1b"><apply id="A5.p1.6.2.m1.1.1.cmml" xref="A5.p1.6.2.m1.1.1"><times id="A5.p1.6.2.m1.1.1.1.cmml" xref="A5.p1.6.2.m1.1.1.1"></times><ci id="A5.p1.6.2.m1.1.1.2.cmml" xref="A5.p1.6.2.m1.1.1.2">𝚂</ci><ci id="A5.p1.6.2.m1.1.1.3a.cmml" xref="A5.p1.6.2.m1.1.1.3"><mtext id="A5.p1.6.2.m1.1.1.3.cmml" xref="A5.p1.6.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.6.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A5.p1.6.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> and (5) <math alttext="r_{\rm{quit}}=-0.3" class="ltx_Math" display="inline" id="A5.p1.7.m5.1"><semantics id="A5.p1.7.m5.1a"><mrow id="A5.p1.7.m5.1.1" xref="A5.p1.7.m5.1.1.cmml"><msub id="A5.p1.7.m5.1.1.2" xref="A5.p1.7.m5.1.1.2.cmml"><mi id="A5.p1.7.m5.1.1.2.2" xref="A5.p1.7.m5.1.1.2.2.cmml">r</mi><mi id="A5.p1.7.m5.1.1.2.3" xref="A5.p1.7.m5.1.1.2.3.cmml">quit</mi></msub><mo id="A5.p1.7.m5.1.1.1" xref="A5.p1.7.m5.1.1.1.cmml">=</mo><mrow id="A5.p1.7.m5.1.1.3" xref="A5.p1.7.m5.1.1.3.cmml"><mo id="A5.p1.7.m5.1.1.3a" xref="A5.p1.7.m5.1.1.3.cmml">−</mo><mn id="A5.p1.7.m5.1.1.3.2" xref="A5.p1.7.m5.1.1.3.2.cmml">0.3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.7.m5.1b"><apply id="A5.p1.7.m5.1.1.cmml" xref="A5.p1.7.m5.1.1"><eq id="A5.p1.7.m5.1.1.1.cmml" xref="A5.p1.7.m5.1.1.1"></eq><apply id="A5.p1.7.m5.1.1.2.cmml" xref="A5.p1.7.m5.1.1.2"><csymbol cd="ambiguous" id="A5.p1.7.m5.1.1.2.1.cmml" xref="A5.p1.7.m5.1.1.2">subscript</csymbol><ci id="A5.p1.7.m5.1.1.2.2.cmml" xref="A5.p1.7.m5.1.1.2.2">𝑟</ci><ci id="A5.p1.7.m5.1.1.2.3.cmml" xref="A5.p1.7.m5.1.1.2.3">quit</ci></apply><apply id="A5.p1.7.m5.1.1.3.cmml" xref="A5.p1.7.m5.1.1.3"><minus id="A5.p1.7.m5.1.1.3.1.cmml" xref="A5.p1.7.m5.1.1.3"></minus><cn id="A5.p1.7.m5.1.1.3.2.cmml" type="float" xref="A5.p1.7.m5.1.1.3.2">0.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.7.m5.1c">r_{\rm{quit}}=-0.3</annotation><annotation encoding="application/x-llamapun" id="A5.p1.7.m5.1d">italic_r start_POSTSUBSCRIPT roman_quit end_POSTSUBSCRIPT = - 0.3</annotation></semantics></math>: a large negative value if the conversation reaches the maximum number of turns <math alttext="T_{\text{max}}" class="ltx_Math" display="inline" id="A5.p1.8.m6.1"><semantics id="A5.p1.8.m6.1a"><msub id="A5.p1.8.m6.1.1" xref="A5.p1.8.m6.1.1.cmml"><mi id="A5.p1.8.m6.1.1.2" xref="A5.p1.8.m6.1.1.2.cmml">T</mi><mtext id="A5.p1.8.m6.1.1.3" xref="A5.p1.8.m6.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="A5.p1.8.m6.1b"><apply id="A5.p1.8.m6.1.1.cmml" xref="A5.p1.8.m6.1.1"><csymbol cd="ambiguous" id="A5.p1.8.m6.1.1.1.cmml" xref="A5.p1.8.m6.1.1">subscript</csymbol><ci id="A5.p1.8.m6.1.1.2.cmml" xref="A5.p1.8.m6.1.1.2">𝑇</ci><ci id="A5.p1.8.m6.1.1.3a.cmml" xref="A5.p1.8.m6.1.1.3"><mtext id="A5.p1.8.m6.1.1.3.cmml" mathsize="70%" xref="A5.p1.8.m6.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.8.m6.1c">T_{\text{max}}</annotation><annotation encoding="application/x-llamapun" id="A5.p1.8.m6.1d">italic_T start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math>. In addition, since we follow the multi-choice MCR setting, we sum up the positive and negative rewards for multiple attribute values specified in a multiple-choice question: <math alttext="r_{t}=\sum_{\widehat{\mathcal{P}}^{+}_{t}}r^{+}_{\mathrm{ask}}+\sum_{\widehat{%
\mathcal{P}}^{-}_{t}}r^{-}_{\mathrm{ask}}." class="ltx_Math" display="inline" id="A5.p1.9.m7.1"><semantics id="A5.p1.9.m7.1a"><mrow id="A5.p1.9.m7.1.1.1" xref="A5.p1.9.m7.1.1.1.1.cmml"><mrow id="A5.p1.9.m7.1.1.1.1" xref="A5.p1.9.m7.1.1.1.1.cmml"><msub id="A5.p1.9.m7.1.1.1.1.2" xref="A5.p1.9.m7.1.1.1.1.2.cmml"><mi id="A5.p1.9.m7.1.1.1.1.2.2" xref="A5.p1.9.m7.1.1.1.1.2.2.cmml">r</mi><mi id="A5.p1.9.m7.1.1.1.1.2.3" xref="A5.p1.9.m7.1.1.1.1.2.3.cmml">t</mi></msub><mo id="A5.p1.9.m7.1.1.1.1.1" rspace="0.111em" xref="A5.p1.9.m7.1.1.1.1.1.cmml">=</mo><mrow id="A5.p1.9.m7.1.1.1.1.3" xref="A5.p1.9.m7.1.1.1.1.3.cmml"><mrow id="A5.p1.9.m7.1.1.1.1.3.2" xref="A5.p1.9.m7.1.1.1.1.3.2.cmml"><msub id="A5.p1.9.m7.1.1.1.1.3.2.1" xref="A5.p1.9.m7.1.1.1.1.3.2.1.cmml"><mo id="A5.p1.9.m7.1.1.1.1.3.2.1.2" xref="A5.p1.9.m7.1.1.1.1.3.2.1.2.cmml">∑</mo><msubsup id="A5.p1.9.m7.1.1.1.1.3.2.1.3" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3.cmml"><mover accent="true" id="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.2" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.2.2" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.2.2.cmml">𝒫</mi><mo id="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.2.1" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.2.1.cmml">^</mo></mover><mi id="A5.p1.9.m7.1.1.1.1.3.2.1.3.3" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3.3.cmml">t</mi><mo id="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.3" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.3.cmml">+</mo></msubsup></msub><msubsup id="A5.p1.9.m7.1.1.1.1.3.2.2" xref="A5.p1.9.m7.1.1.1.1.3.2.2.cmml"><mi id="A5.p1.9.m7.1.1.1.1.3.2.2.2.2" xref="A5.p1.9.m7.1.1.1.1.3.2.2.2.2.cmml">r</mi><mi id="A5.p1.9.m7.1.1.1.1.3.2.2.3" xref="A5.p1.9.m7.1.1.1.1.3.2.2.3.cmml">ask</mi><mo id="A5.p1.9.m7.1.1.1.1.3.2.2.2.3" xref="A5.p1.9.m7.1.1.1.1.3.2.2.2.3.cmml">+</mo></msubsup></mrow><mo id="A5.p1.9.m7.1.1.1.1.3.1" rspace="0.055em" xref="A5.p1.9.m7.1.1.1.1.3.1.cmml">+</mo><mrow id="A5.p1.9.m7.1.1.1.1.3.3" xref="A5.p1.9.m7.1.1.1.1.3.3.cmml"><msub id="A5.p1.9.m7.1.1.1.1.3.3.1" xref="A5.p1.9.m7.1.1.1.1.3.3.1.cmml"><mo id="A5.p1.9.m7.1.1.1.1.3.3.1.2" xref="A5.p1.9.m7.1.1.1.1.3.3.1.2.cmml">∑</mo><msubsup id="A5.p1.9.m7.1.1.1.1.3.3.1.3" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3.cmml"><mover accent="true" id="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.2" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.2.2" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.2.2.cmml">𝒫</mi><mo id="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.2.1" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.2.1.cmml">^</mo></mover><mi id="A5.p1.9.m7.1.1.1.1.3.3.1.3.3" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3.3.cmml">t</mi><mo id="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.3" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.3.cmml">−</mo></msubsup></msub><msubsup id="A5.p1.9.m7.1.1.1.1.3.3.2" xref="A5.p1.9.m7.1.1.1.1.3.3.2.cmml"><mi id="A5.p1.9.m7.1.1.1.1.3.3.2.2.2" xref="A5.p1.9.m7.1.1.1.1.3.3.2.2.2.cmml">r</mi><mi id="A5.p1.9.m7.1.1.1.1.3.3.2.3" xref="A5.p1.9.m7.1.1.1.1.3.3.2.3.cmml">ask</mi><mo id="A5.p1.9.m7.1.1.1.1.3.3.2.2.3" xref="A5.p1.9.m7.1.1.1.1.3.3.2.2.3.cmml">−</mo></msubsup></mrow></mrow></mrow><mo id="A5.p1.9.m7.1.1.1.2" lspace="0em" xref="A5.p1.9.m7.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.9.m7.1b"><apply id="A5.p1.9.m7.1.1.1.1.cmml" xref="A5.p1.9.m7.1.1.1"><eq id="A5.p1.9.m7.1.1.1.1.1.cmml" xref="A5.p1.9.m7.1.1.1.1.1"></eq><apply id="A5.p1.9.m7.1.1.1.1.2.cmml" xref="A5.p1.9.m7.1.1.1.1.2"><csymbol cd="ambiguous" id="A5.p1.9.m7.1.1.1.1.2.1.cmml" xref="A5.p1.9.m7.1.1.1.1.2">subscript</csymbol><ci id="A5.p1.9.m7.1.1.1.1.2.2.cmml" xref="A5.p1.9.m7.1.1.1.1.2.2">𝑟</ci><ci id="A5.p1.9.m7.1.1.1.1.2.3.cmml" xref="A5.p1.9.m7.1.1.1.1.2.3">𝑡</ci></apply><apply id="A5.p1.9.m7.1.1.1.1.3.cmml" xref="A5.p1.9.m7.1.1.1.1.3"><plus id="A5.p1.9.m7.1.1.1.1.3.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.1"></plus><apply id="A5.p1.9.m7.1.1.1.1.3.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2"><apply id="A5.p1.9.m7.1.1.1.1.3.2.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="A5.p1.9.m7.1.1.1.1.3.2.1.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.1">subscript</csymbol><sum id="A5.p1.9.m7.1.1.1.1.3.2.1.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.1.2"></sum><apply id="A5.p1.9.m7.1.1.1.1.3.2.1.3.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3"><csymbol cd="ambiguous" id="A5.p1.9.m7.1.1.1.1.3.2.1.3.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3">subscript</csymbol><apply id="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3"><csymbol cd="ambiguous" id="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3">superscript</csymbol><apply id="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.2"><ci id="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.2.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.2.1">^</ci><ci id="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.2.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.2.2">𝒫</ci></apply><plus id="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.3.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3.2.3"></plus></apply><ci id="A5.p1.9.m7.1.1.1.1.3.2.1.3.3.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.1.3.3">𝑡</ci></apply></apply><apply id="A5.p1.9.m7.1.1.1.1.3.2.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="A5.p1.9.m7.1.1.1.1.3.2.2.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.2">subscript</csymbol><apply id="A5.p1.9.m7.1.1.1.1.3.2.2.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="A5.p1.9.m7.1.1.1.1.3.2.2.2.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.2">superscript</csymbol><ci id="A5.p1.9.m7.1.1.1.1.3.2.2.2.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.2.2.2">𝑟</ci><plus id="A5.p1.9.m7.1.1.1.1.3.2.2.2.3.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.2.2.3"></plus></apply><ci id="A5.p1.9.m7.1.1.1.1.3.2.2.3.cmml" xref="A5.p1.9.m7.1.1.1.1.3.2.2.3">ask</ci></apply></apply><apply id="A5.p1.9.m7.1.1.1.1.3.3.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3"><apply id="A5.p1.9.m7.1.1.1.1.3.3.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="A5.p1.9.m7.1.1.1.1.3.3.1.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.1">subscript</csymbol><sum id="A5.p1.9.m7.1.1.1.1.3.3.1.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.1.2"></sum><apply id="A5.p1.9.m7.1.1.1.1.3.3.1.3.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3"><csymbol cd="ambiguous" id="A5.p1.9.m7.1.1.1.1.3.3.1.3.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3">subscript</csymbol><apply id="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3"><csymbol cd="ambiguous" id="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3">superscript</csymbol><apply id="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.2"><ci id="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.2.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.2.1">^</ci><ci id="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.2.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.2.2">𝒫</ci></apply><minus id="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.3.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3.2.3"></minus></apply><ci id="A5.p1.9.m7.1.1.1.1.3.3.1.3.3.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.1.3.3">𝑡</ci></apply></apply><apply id="A5.p1.9.m7.1.1.1.1.3.3.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A5.p1.9.m7.1.1.1.1.3.3.2.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.2">subscript</csymbol><apply id="A5.p1.9.m7.1.1.1.1.3.3.2.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A5.p1.9.m7.1.1.1.1.3.3.2.2.1.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.2">superscript</csymbol><ci id="A5.p1.9.m7.1.1.1.1.3.3.2.2.2.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.2.2.2">𝑟</ci><minus id="A5.p1.9.m7.1.1.1.1.3.3.2.2.3.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.2.2.3"></minus></apply><ci id="A5.p1.9.m7.1.1.1.1.3.3.2.3.cmml" xref="A5.p1.9.m7.1.1.1.1.3.3.2.3">ask</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.9.m7.1c">r_{t}=\sum_{\widehat{\mathcal{P}}^{+}_{t}}r^{+}_{\mathrm{ask}}+\sum_{\widehat{%
\mathcal{P}}^{-}_{t}}r^{-}_{\mathrm{ask}}.</annotation><annotation encoding="application/x-llamapun" id="A5.p1.9.m7.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT over^ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ask end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT over^ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ask end_POSTSUBSCRIPT .</annotation></semantics></math></p>
</div>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Experimental Details</h2>
<section class="ltx_subsection" id="A6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.1 </span>Dataset Details and Statistics </h3>
<figure class="ltx_table" id="A6.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A6.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T2.1.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A6.T2.1.1.1.1" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T2.1.1.1.1.1">Dataset</span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" id="A6.T2.1.1.1.2" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T2.1.1.1.2.1">Yelp</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" id="A6.T2.1.1.1.3" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T2.1.1.1.3.1">LastFM</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" id="A6.T2.1.1.1.4" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T2.1.1.1.4.1">Amazon-</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" id="A6.T2.1.1.1.5" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T2.1.1.1.5.1">MovieLens</span></td>
</tr>
<tr class="ltx_tr" id="A6.T2.1.2.2">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="A6.T2.1.2.2.1" style="padding-left:1.0pt;padding-right:1.0pt;"></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r" id="A6.T2.1.2.2.2" style="padding-left:1.0pt;padding-right:1.0pt;"></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r" id="A6.T2.1.2.2.3" style="padding-left:1.0pt;padding-right:1.0pt;"></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.2.2.4" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T2.1.2.2.4.1">Book</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r" id="A6.T2.1.2.2.5" style="padding-left:1.0pt;padding-right:1.0pt;"></td>
</tr>
<tr class="ltx_tr" id="A6.T2.1.3.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A6.T2.1.3.3.1" style="padding-left:1.0pt;padding-right:1.0pt;">#Users</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A6.T2.1.3.3.2" style="padding-left:1.0pt;padding-right:1.0pt;">27,675</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A6.T2.1.3.3.3" style="padding-left:1.0pt;padding-right:1.0pt;">1,801</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A6.T2.1.3.3.4" style="padding-left:1.0pt;padding-right:1.0pt;">30,291</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A6.T2.1.3.3.5" style="padding-left:1.0pt;padding-right:1.0pt;">20,892</td>
</tr>
<tr class="ltx_tr" id="A6.T2.1.4.4">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="A6.T2.1.4.4.1" style="padding-left:1.0pt;padding-right:1.0pt;">#Items</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.4.4.2" style="padding-left:1.0pt;padding-right:1.0pt;">70,311</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.4.4.3" style="padding-left:1.0pt;padding-right:1.0pt;">7,432</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.4.4.4" style="padding-left:1.0pt;padding-right:1.0pt;">17,739</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.4.4.5" style="padding-left:1.0pt;padding-right:1.0pt;">16,482</td>
</tr>
<tr class="ltx_tr" id="A6.T2.1.5.5">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="A6.T2.1.5.5.1" style="padding-left:1.0pt;padding-right:1.0pt;">#Interactions</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.5.5.2" style="padding-left:1.0pt;padding-right:1.0pt;">1,368,609</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.5.5.3" style="padding-left:1.0pt;padding-right:1.0pt;">76,693</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.5.5.4" style="padding-left:1.0pt;padding-right:1.0pt;">478,099</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.5.5.5" style="padding-left:1.0pt;padding-right:1.0pt;">454,011</td>
</tr>
<tr class="ltx_tr" id="A6.T2.1.6.6">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="A6.T2.1.6.6.1" style="padding-left:1.0pt;padding-right:1.0pt;">#Attribute Values</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.6.6.2" style="padding-left:1.0pt;padding-right:1.0pt;">590</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.6.6.3" style="padding-left:1.0pt;padding-right:1.0pt;">8,438</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.6.6.4" style="padding-left:1.0pt;padding-right:1.0pt;">988</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.6.6.5" style="padding-left:1.0pt;padding-right:1.0pt;">1,498</td>
</tr>
<tr class="ltx_tr" id="A6.T2.1.7.7">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="A6.T2.1.7.7.1" style="padding-left:1.0pt;padding-right:1.0pt;">#Attribute types</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.7.7.2" style="padding-left:1.0pt;padding-right:1.0pt;">29</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.7.7.3" style="padding-left:1.0pt;padding-right:1.0pt;">34</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.7.7.4" style="padding-left:1.0pt;padding-right:1.0pt;">40</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.7.7.5" style="padding-left:1.0pt;padding-right:1.0pt;">21</td>
</tr>
<tr class="ltx_tr" id="A6.T2.1.8.8">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A6.T2.1.8.8.1" style="padding-left:1.0pt;padding-right:1.0pt;">#Entities</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A6.T2.1.8.8.2" style="padding-left:1.0pt;padding-right:1.0pt;">98,576</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A6.T2.1.8.8.3" style="padding-left:1.0pt;padding-right:1.0pt;">17,671</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A6.T2.1.8.8.4" style="padding-left:1.0pt;padding-right:1.0pt;">49,018</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A6.T2.1.8.8.5" style="padding-left:1.0pt;padding-right:1.0pt;">38,872</td>
</tr>
<tr class="ltx_tr" id="A6.T2.1.9.9">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="A6.T2.1.9.9.1" style="padding-left:1.0pt;padding-right:1.0pt;">#Relations</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.9.9.2" style="padding-left:1.0pt;padding-right:1.0pt;">3</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.9.9.3" style="padding-left:1.0pt;padding-right:1.0pt;">4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.9.9.4" style="padding-left:1.0pt;padding-right:1.0pt;">2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T2.1.9.9.5" style="padding-left:1.0pt;padding-right:1.0pt;">2</td>
</tr>
<tr class="ltx_tr" id="A6.T2.1.10.10">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A6.T2.1.10.10.1" style="padding-left:1.0pt;padding-right:1.0pt;">#Triplets</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A6.T2.1.10.10.2" style="padding-left:1.0pt;padding-right:1.0pt;">2,533,827</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A6.T2.1.10.10.3" style="padding-left:1.0pt;padding-right:1.0pt;">228,217</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A6.T2.1.10.10.4" style="padding-left:1.0pt;padding-right:1.0pt;">565,069</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A6.T2.1.10.10.5" style="padding-left:1.0pt;padding-right:1.0pt;">380,016</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table A2: </span>Statistics of datasets after preprocessing.</figcaption>
</figure>
<div class="ltx_para" id="A6.SS1.p1">
<p class="ltx_p" id="A6.SS1.p1.1">We evaluate <span class="ltx_ERROR undefined" id="A6.SS1.p1.1.1">\method</span>on four public benchmark recommendation datasets: Yelp <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite>, LastFM <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite>, Amazon-Book <cite class="ltx_cite ltx_citemacro_cite">McAuley et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib31" title="">2015</a>); He and McAuley (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib16" title="">2016</a>)</cite> and MovieLens <cite class="ltx_cite ltx_citemacro_cite">Harper and Konstan (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib15" title="">2015</a>)</cite>. The statistics of the datasets after preprocessing are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.T2" title="Table A2 ‣ F.1 Dataset Details and Statistics ‣ Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">A2</span></a> and the details of the datasets are introduced as follows:</p>
<ul class="ltx_itemize" id="A6.I1">
<li class="ltx_item" id="A6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I1.i1.p1">
<p class="ltx_p" id="A6.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I1.i1.p1.1.1">Yelp<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote1.1.1.1">1</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://www.yelp.com/dataset/" title="">https://www.yelp.com/dataset/</a></span></span></span></span>: This dataset contains users’ reviews on business venues such as restaurants and bars. <cite class="ltx_cite ltx_citemacro_citet">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite> build a 2-layer taxonomy for the original attribute values for this dataset, and we adopt the categories from the first layer as attribute types, the categories from the second layer as attribute values.</p>
</div>
</li>
<li class="ltx_item" id="A6.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I1.i2.p1">
<p class="ltx_p" id="A6.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I1.i2.p1.1.1">LastFM<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote2.1.1.1">2</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://grouplens.org/datasets/hetrec-2011/" title="">https://grouplens.org/datasets/hetrec-2011/</a></span></span></span></span>: This dataset contains users’ listen records for music artists from an online music platform. Following the literature <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib26" title="">2020a</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>)</cite>, we adopt a clustering algorithm to categorize the original attribute values into 34 attribute types.</p>
</div>
</li>
<li class="ltx_item" id="A6.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I1.i3.p1">
<p class="ltx_p" id="A6.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I1.i3.p1.1.1">Amazon-Book<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote3.1.1.1">3</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://jmcauley.ucsd.edu/data/amazon/" title="">https://jmcauley.ucsd.edu/data/amazon/</a></span></span></span></span>: The Amazon review dataset <cite class="ltx_cite ltx_citemacro_cite">McAuley et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib31" title="">2015</a>); He and McAuley (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib16" title="">2016</a>)</cite> is a large-scale collection of online shopping data featuring users’ product reviews across various domains. We select the book domain from this collection. Following the literature <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib46" title="">2019</a>)</cite> we choose relations and entities within the knowledge graph as attribute types and attribute values, and only retain entities associated with at least 10 items to ensure dataset quality.</p>
</div>
</li>
<li class="ltx_item" id="A6.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I1.i4.p1">
<p class="ltx_p" id="A6.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I1.i4.p1.1.1">MovieLens<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote4.1.1.1">4</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://grouplens.org/datasets/movielens/" title="">https://grouplens.org/datasets/movielens/</a></span></span></span><cite class="ltx_cite ltx_citemacro_cite">Harper and Konstan <span class="ltx_text ltx_font_medium" id="A6.I1.i4.p1.1.1.1.1.1.1">(</span><a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib15" title="">2015</a><span class="ltx_text ltx_font_medium" id="A6.I1.i4.p1.1.1.2.2.2.1">)</span></cite></span>: This dataset contains users’ activities in an online movie recommendation platform. We use the version with about 20M interactions, select entities and relations within the knowledge graph as attribute values, and only retain the user-item interactions with the user’s ratings greater than 3 to ensure the quality of the dataset.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="A6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.2 </span>Details of the User Simulator</h3>
<div class="ltx_para" id="A6.SS2.p1">
<p class="ltx_p" id="A6.SS2.p1.7">Training and evaluating CRS with real user interactions can be impractically expensive at scale. To address this issue, we follow the literature <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>); Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>); Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib51" title="">2023</a>); Qian et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib36" title="">2023</a>)</cite> and simulate a conversation session for each observed user-item set interaction pair <math alttext="(u,\mathcal{V}(u))" class="ltx_Math" display="inline" id="A6.SS2.p1.1.m1.3"><semantics id="A6.SS2.p1.1.m1.3a"><mrow id="A6.SS2.p1.1.m1.3.3.1" xref="A6.SS2.p1.1.m1.3.3.2.cmml"><mo id="A6.SS2.p1.1.m1.3.3.1.2" stretchy="false" xref="A6.SS2.p1.1.m1.3.3.2.cmml">(</mo><mi id="A6.SS2.p1.1.m1.2.2" xref="A6.SS2.p1.1.m1.2.2.cmml">u</mi><mo id="A6.SS2.p1.1.m1.3.3.1.3" xref="A6.SS2.p1.1.m1.3.3.2.cmml">,</mo><mrow id="A6.SS2.p1.1.m1.3.3.1.1" xref="A6.SS2.p1.1.m1.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.SS2.p1.1.m1.3.3.1.1.2" xref="A6.SS2.p1.1.m1.3.3.1.1.2.cmml">𝒱</mi><mo id="A6.SS2.p1.1.m1.3.3.1.1.1" xref="A6.SS2.p1.1.m1.3.3.1.1.1.cmml">⁢</mo><mrow id="A6.SS2.p1.1.m1.3.3.1.1.3.2" xref="A6.SS2.p1.1.m1.3.3.1.1.cmml"><mo id="A6.SS2.p1.1.m1.3.3.1.1.3.2.1" stretchy="false" xref="A6.SS2.p1.1.m1.3.3.1.1.cmml">(</mo><mi id="A6.SS2.p1.1.m1.1.1" xref="A6.SS2.p1.1.m1.1.1.cmml">u</mi><mo id="A6.SS2.p1.1.m1.3.3.1.1.3.2.2" stretchy="false" xref="A6.SS2.p1.1.m1.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="A6.SS2.p1.1.m1.3.3.1.4" stretchy="false" xref="A6.SS2.p1.1.m1.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.1.m1.3b"><interval closure="open" id="A6.SS2.p1.1.m1.3.3.2.cmml" xref="A6.SS2.p1.1.m1.3.3.1"><ci id="A6.SS2.p1.1.m1.2.2.cmml" xref="A6.SS2.p1.1.m1.2.2">𝑢</ci><apply id="A6.SS2.p1.1.m1.3.3.1.1.cmml" xref="A6.SS2.p1.1.m1.3.3.1.1"><times id="A6.SS2.p1.1.m1.3.3.1.1.1.cmml" xref="A6.SS2.p1.1.m1.3.3.1.1.1"></times><ci id="A6.SS2.p1.1.m1.3.3.1.1.2.cmml" xref="A6.SS2.p1.1.m1.3.3.1.1.2">𝒱</ci><ci id="A6.SS2.p1.1.m1.1.1.cmml" xref="A6.SS2.p1.1.m1.1.1">𝑢</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.1.m1.3c">(u,\mathcal{V}(u))</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.1.m1.3d">( italic_u , caligraphic_V ( italic_u ) )</annotation></semantics></math> in the dataset.
In each simulated conversation, we regard an item <math alttext="v_{i}\in\mathcal{V}(u)" class="ltx_Math" display="inline" id="A6.SS2.p1.2.m2.1"><semantics id="A6.SS2.p1.2.m2.1a"><mrow id="A6.SS2.p1.2.m2.1.2" xref="A6.SS2.p1.2.m2.1.2.cmml"><msub id="A6.SS2.p1.2.m2.1.2.2" xref="A6.SS2.p1.2.m2.1.2.2.cmml"><mi id="A6.SS2.p1.2.m2.1.2.2.2" xref="A6.SS2.p1.2.m2.1.2.2.2.cmml">v</mi><mi id="A6.SS2.p1.2.m2.1.2.2.3" xref="A6.SS2.p1.2.m2.1.2.2.3.cmml">i</mi></msub><mo id="A6.SS2.p1.2.m2.1.2.1" xref="A6.SS2.p1.2.m2.1.2.1.cmml">∈</mo><mrow id="A6.SS2.p1.2.m2.1.2.3" xref="A6.SS2.p1.2.m2.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.SS2.p1.2.m2.1.2.3.2" xref="A6.SS2.p1.2.m2.1.2.3.2.cmml">𝒱</mi><mo id="A6.SS2.p1.2.m2.1.2.3.1" xref="A6.SS2.p1.2.m2.1.2.3.1.cmml">⁢</mo><mrow id="A6.SS2.p1.2.m2.1.2.3.3.2" xref="A6.SS2.p1.2.m2.1.2.3.cmml"><mo id="A6.SS2.p1.2.m2.1.2.3.3.2.1" stretchy="false" xref="A6.SS2.p1.2.m2.1.2.3.cmml">(</mo><mi id="A6.SS2.p1.2.m2.1.1" xref="A6.SS2.p1.2.m2.1.1.cmml">u</mi><mo id="A6.SS2.p1.2.m2.1.2.3.3.2.2" stretchy="false" xref="A6.SS2.p1.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.2.m2.1b"><apply id="A6.SS2.p1.2.m2.1.2.cmml" xref="A6.SS2.p1.2.m2.1.2"><in id="A6.SS2.p1.2.m2.1.2.1.cmml" xref="A6.SS2.p1.2.m2.1.2.1"></in><apply id="A6.SS2.p1.2.m2.1.2.2.cmml" xref="A6.SS2.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="A6.SS2.p1.2.m2.1.2.2.1.cmml" xref="A6.SS2.p1.2.m2.1.2.2">subscript</csymbol><ci id="A6.SS2.p1.2.m2.1.2.2.2.cmml" xref="A6.SS2.p1.2.m2.1.2.2.2">𝑣</ci><ci id="A6.SS2.p1.2.m2.1.2.2.3.cmml" xref="A6.SS2.p1.2.m2.1.2.2.3">𝑖</ci></apply><apply id="A6.SS2.p1.2.m2.1.2.3.cmml" xref="A6.SS2.p1.2.m2.1.2.3"><times id="A6.SS2.p1.2.m2.1.2.3.1.cmml" xref="A6.SS2.p1.2.m2.1.2.3.1"></times><ci id="A6.SS2.p1.2.m2.1.2.3.2.cmml" xref="A6.SS2.p1.2.m2.1.2.3.2">𝒱</ci><ci id="A6.SS2.p1.2.m2.1.1.cmml" xref="A6.SS2.p1.2.m2.1.1">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.2.m2.1c">v_{i}\in\mathcal{V}(u)</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_V ( italic_u )</annotation></semantics></math> as the ground-truth target item.
Each conversation is initialized with a user specifying preference on an attribute value <math alttext="p_{0}" class="ltx_Math" display="inline" id="A6.SS2.p1.3.m3.1"><semantics id="A6.SS2.p1.3.m3.1a"><msub id="A6.SS2.p1.3.m3.1.1" xref="A6.SS2.p1.3.m3.1.1.cmml"><mi id="A6.SS2.p1.3.m3.1.1.2" xref="A6.SS2.p1.3.m3.1.1.2.cmml">p</mi><mn id="A6.SS2.p1.3.m3.1.1.3" xref="A6.SS2.p1.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.3.m3.1b"><apply id="A6.SS2.p1.3.m3.1.1.cmml" xref="A6.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A6.SS2.p1.3.m3.1.1.1.cmml" xref="A6.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="A6.SS2.p1.3.m3.1.1.2.cmml" xref="A6.SS2.p1.3.m3.1.1.2">𝑝</ci><cn id="A6.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="A6.SS2.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.3.m3.1c">p_{0}</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.3.m3.1d">italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> that this user clearly prefers, which is randomly chosen from the shared attribute values of all items in <math alttext="\mathcal{V}(u)" class="ltx_Math" display="inline" id="A6.SS2.p1.4.m4.1"><semantics id="A6.SS2.p1.4.m4.1a"><mrow id="A6.SS2.p1.4.m4.1.2" xref="A6.SS2.p1.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.SS2.p1.4.m4.1.2.2" xref="A6.SS2.p1.4.m4.1.2.2.cmml">𝒱</mi><mo id="A6.SS2.p1.4.m4.1.2.1" xref="A6.SS2.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="A6.SS2.p1.4.m4.1.2.3.2" xref="A6.SS2.p1.4.m4.1.2.cmml"><mo id="A6.SS2.p1.4.m4.1.2.3.2.1" stretchy="false" xref="A6.SS2.p1.4.m4.1.2.cmml">(</mo><mi id="A6.SS2.p1.4.m4.1.1" xref="A6.SS2.p1.4.m4.1.1.cmml">u</mi><mo id="A6.SS2.p1.4.m4.1.2.3.2.2" stretchy="false" xref="A6.SS2.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.4.m4.1b"><apply id="A6.SS2.p1.4.m4.1.2.cmml" xref="A6.SS2.p1.4.m4.1.2"><times id="A6.SS2.p1.4.m4.1.2.1.cmml" xref="A6.SS2.p1.4.m4.1.2.1"></times><ci id="A6.SS2.p1.4.m4.1.2.2.cmml" xref="A6.SS2.p1.4.m4.1.2.2">𝒱</ci><ci id="A6.SS2.p1.4.m4.1.1.cmml" xref="A6.SS2.p1.4.m4.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.4.m4.1c">\mathcal{V}(u)</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.4.m4.1d">caligraphic_V ( italic_u )</annotation></semantics></math>.
As the conversation continues, in each turn, the simulated user feedback follows these rules:
(1) when the CRS asks a question, the user will only accept attribute values associated with any item in <math alttext="\mathcal{V}(u)" class="ltx_Math" display="inline" id="A6.SS2.p1.5.m5.1"><semantics id="A6.SS2.p1.5.m5.1a"><mrow id="A6.SS2.p1.5.m5.1.2" xref="A6.SS2.p1.5.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.SS2.p1.5.m5.1.2.2" xref="A6.SS2.p1.5.m5.1.2.2.cmml">𝒱</mi><mo id="A6.SS2.p1.5.m5.1.2.1" xref="A6.SS2.p1.5.m5.1.2.1.cmml">⁢</mo><mrow id="A6.SS2.p1.5.m5.1.2.3.2" xref="A6.SS2.p1.5.m5.1.2.cmml"><mo id="A6.SS2.p1.5.m5.1.2.3.2.1" stretchy="false" xref="A6.SS2.p1.5.m5.1.2.cmml">(</mo><mi id="A6.SS2.p1.5.m5.1.1" xref="A6.SS2.p1.5.m5.1.1.cmml">u</mi><mo id="A6.SS2.p1.5.m5.1.2.3.2.2" stretchy="false" xref="A6.SS2.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.5.m5.1b"><apply id="A6.SS2.p1.5.m5.1.2.cmml" xref="A6.SS2.p1.5.m5.1.2"><times id="A6.SS2.p1.5.m5.1.2.1.cmml" xref="A6.SS2.p1.5.m5.1.2.1"></times><ci id="A6.SS2.p1.5.m5.1.2.2.cmml" xref="A6.SS2.p1.5.m5.1.2.2">𝒱</ci><ci id="A6.SS2.p1.5.m5.1.1.cmml" xref="A6.SS2.p1.5.m5.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.5.m5.1c">\mathcal{V}(u)</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.5.m5.1d">caligraphic_V ( italic_u )</annotation></semantics></math> and reject others;
(2) when the CRS recommends a list of items, the user will accept it only if at least one item in <math alttext="\mathcal{V}(u)" class="ltx_Math" display="inline" id="A6.SS2.p1.6.m6.1"><semantics id="A6.SS2.p1.6.m6.1a"><mrow id="A6.SS2.p1.6.m6.1.2" xref="A6.SS2.p1.6.m6.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.SS2.p1.6.m6.1.2.2" xref="A6.SS2.p1.6.m6.1.2.2.cmml">𝒱</mi><mo id="A6.SS2.p1.6.m6.1.2.1" xref="A6.SS2.p1.6.m6.1.2.1.cmml">⁢</mo><mrow id="A6.SS2.p1.6.m6.1.2.3.2" xref="A6.SS2.p1.6.m6.1.2.cmml"><mo id="A6.SS2.p1.6.m6.1.2.3.2.1" stretchy="false" xref="A6.SS2.p1.6.m6.1.2.cmml">(</mo><mi id="A6.SS2.p1.6.m6.1.1" xref="A6.SS2.p1.6.m6.1.1.cmml">u</mi><mo id="A6.SS2.p1.6.m6.1.2.3.2.2" stretchy="false" xref="A6.SS2.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.6.m6.1b"><apply id="A6.SS2.p1.6.m6.1.2.cmml" xref="A6.SS2.p1.6.m6.1.2"><times id="A6.SS2.p1.6.m6.1.2.1.cmml" xref="A6.SS2.p1.6.m6.1.2.1"></times><ci id="A6.SS2.p1.6.m6.1.2.2.cmml" xref="A6.SS2.p1.6.m6.1.2.2">𝒱</ci><ci id="A6.SS2.p1.6.m6.1.1.cmml" xref="A6.SS2.p1.6.m6.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.6.m6.1c">\mathcal{V}(u)</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.6.m6.1d">caligraphic_V ( italic_u )</annotation></semantics></math> is in the recommendation list;
(3) the user will become impatient after <math alttext="T_{\text{max}}=15" class="ltx_Math" display="inline" id="A6.SS2.p1.7.m7.1"><semantics id="A6.SS2.p1.7.m7.1a"><mrow id="A6.SS2.p1.7.m7.1.1" xref="A6.SS2.p1.7.m7.1.1.cmml"><msub id="A6.SS2.p1.7.m7.1.1.2" xref="A6.SS2.p1.7.m7.1.1.2.cmml"><mi id="A6.SS2.p1.7.m7.1.1.2.2" xref="A6.SS2.p1.7.m7.1.1.2.2.cmml">T</mi><mtext id="A6.SS2.p1.7.m7.1.1.2.3" xref="A6.SS2.p1.7.m7.1.1.2.3a.cmml">max</mtext></msub><mo id="A6.SS2.p1.7.m7.1.1.1" xref="A6.SS2.p1.7.m7.1.1.1.cmml">=</mo><mn id="A6.SS2.p1.7.m7.1.1.3" xref="A6.SS2.p1.7.m7.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.7.m7.1b"><apply id="A6.SS2.p1.7.m7.1.1.cmml" xref="A6.SS2.p1.7.m7.1.1"><eq id="A6.SS2.p1.7.m7.1.1.1.cmml" xref="A6.SS2.p1.7.m7.1.1.1"></eq><apply id="A6.SS2.p1.7.m7.1.1.2.cmml" xref="A6.SS2.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="A6.SS2.p1.7.m7.1.1.2.1.cmml" xref="A6.SS2.p1.7.m7.1.1.2">subscript</csymbol><ci id="A6.SS2.p1.7.m7.1.1.2.2.cmml" xref="A6.SS2.p1.7.m7.1.1.2.2">𝑇</ci><ci id="A6.SS2.p1.7.m7.1.1.2.3a.cmml" xref="A6.SS2.p1.7.m7.1.1.2.3"><mtext id="A6.SS2.p1.7.m7.1.1.2.3.cmml" mathsize="70%" xref="A6.SS2.p1.7.m7.1.1.2.3">max</mtext></ci></apply><cn id="A6.SS2.p1.7.m7.1.1.3.cmml" type="integer" xref="A6.SS2.p1.7.m7.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.7.m7.1c">T_{\text{max}}=15</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.7.m7.1d">italic_T start_POSTSUBSCRIPT max end_POSTSUBSCRIPT = 15</annotation></semantics></math> turns and quit the conversation.</p>
</div>
</section>
<section class="ltx_subsection" id="A6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.3 </span>Details of hDCG Calculation</h3>
<div class="ltx_para" id="A6.SS3.p1">
<p class="ltx_p" id="A6.SS3.p1.2">Normalized Discounted Cumulative Gain (NDCG) is a common ranking metric to evaluate the relevance of items recommended by a system. <cite class="ltx_cite ltx_citemacro_citet">Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>)</cite> extend the NDCG metric to a two-level hierarchical version to evaluate the ranking order of the ground-truth item among the list of all the items recommended by the CRS at each conversational turn. A higher value implies that the ground-truth item has a higher ranking, and hence indicates a better performance for the CRS. The hierarchical normalized Discounted Cumulative Gain<math alttext="@(T,K)" class="ltx_Math" display="inline" id="A6.SS3.p1.1.m1.2"><semantics id="A6.SS3.p1.1.m1.2a"><mrow id="A6.SS3.p1.1.m1.2.3" xref="A6.SS3.p1.1.m1.2.3.cmml"><mi id="A6.SS3.p1.1.m1.2.3.2" mathvariant="normal" xref="A6.SS3.p1.1.m1.2.3.2.cmml">@</mi><mo id="A6.SS3.p1.1.m1.2.3.1" xref="A6.SS3.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="A6.SS3.p1.1.m1.2.3.3.2" xref="A6.SS3.p1.1.m1.2.3.3.1.cmml"><mo id="A6.SS3.p1.1.m1.2.3.3.2.1" stretchy="false" xref="A6.SS3.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="A6.SS3.p1.1.m1.1.1" xref="A6.SS3.p1.1.m1.1.1.cmml">T</mi><mo id="A6.SS3.p1.1.m1.2.3.3.2.2" xref="A6.SS3.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="A6.SS3.p1.1.m1.2.2" xref="A6.SS3.p1.1.m1.2.2.cmml">K</mi><mo id="A6.SS3.p1.1.m1.2.3.3.2.3" stretchy="false" xref="A6.SS3.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.1.m1.2b"><apply id="A6.SS3.p1.1.m1.2.3.cmml" xref="A6.SS3.p1.1.m1.2.3"><times id="A6.SS3.p1.1.m1.2.3.1.cmml" xref="A6.SS3.p1.1.m1.2.3.1"></times><ci id="A6.SS3.p1.1.m1.2.3.2.cmml" xref="A6.SS3.p1.1.m1.2.3.2">@</ci><interval closure="open" id="A6.SS3.p1.1.m1.2.3.3.1.cmml" xref="A6.SS3.p1.1.m1.2.3.3.2"><ci id="A6.SS3.p1.1.m1.1.1.cmml" xref="A6.SS3.p1.1.m1.1.1">𝑇</ci><ci id="A6.SS3.p1.1.m1.2.2.cmml" xref="A6.SS3.p1.1.m1.2.2">𝐾</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.1.m1.2c">@(T,K)</annotation><annotation encoding="application/x-llamapun" id="A6.SS3.p1.1.m1.2d">@ ( italic_T , italic_K )</annotation></semantics></math> (hDCG<math alttext="@(T,K)" class="ltx_Math" display="inline" id="A6.SS3.p1.2.m2.2"><semantics id="A6.SS3.p1.2.m2.2a"><mrow id="A6.SS3.p1.2.m2.2.3" xref="A6.SS3.p1.2.m2.2.3.cmml"><mi id="A6.SS3.p1.2.m2.2.3.2" mathvariant="normal" xref="A6.SS3.p1.2.m2.2.3.2.cmml">@</mi><mo id="A6.SS3.p1.2.m2.2.3.1" xref="A6.SS3.p1.2.m2.2.3.1.cmml">⁢</mo><mrow id="A6.SS3.p1.2.m2.2.3.3.2" xref="A6.SS3.p1.2.m2.2.3.3.1.cmml"><mo id="A6.SS3.p1.2.m2.2.3.3.2.1" stretchy="false" xref="A6.SS3.p1.2.m2.2.3.3.1.cmml">(</mo><mi id="A6.SS3.p1.2.m2.1.1" xref="A6.SS3.p1.2.m2.1.1.cmml">T</mi><mo id="A6.SS3.p1.2.m2.2.3.3.2.2" xref="A6.SS3.p1.2.m2.2.3.3.1.cmml">,</mo><mi id="A6.SS3.p1.2.m2.2.2" xref="A6.SS3.p1.2.m2.2.2.cmml">K</mi><mo id="A6.SS3.p1.2.m2.2.3.3.2.3" stretchy="false" xref="A6.SS3.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.2.m2.2b"><apply id="A6.SS3.p1.2.m2.2.3.cmml" xref="A6.SS3.p1.2.m2.2.3"><times id="A6.SS3.p1.2.m2.2.3.1.cmml" xref="A6.SS3.p1.2.m2.2.3.1"></times><ci id="A6.SS3.p1.2.m2.2.3.2.cmml" xref="A6.SS3.p1.2.m2.2.3.2">@</ci><interval closure="open" id="A6.SS3.p1.2.m2.2.3.3.1.cmml" xref="A6.SS3.p1.2.m2.2.3.3.2"><ci id="A6.SS3.p1.2.m2.1.1.cmml" xref="A6.SS3.p1.2.m2.1.1">𝑇</ci><ci id="A6.SS3.p1.2.m2.2.2.cmml" xref="A6.SS3.p1.2.m2.2.2">𝐾</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.2.m2.2c">@(T,K)</annotation><annotation encoding="application/x-llamapun" id="A6.SS3.p1.2.m2.2d">@ ( italic_T , italic_K )</annotation></semantics></math>) is calculated as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A6.E19">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E19X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle hDCG@(T,K)=\sum^{T}_{t=1}\sum^{K}_{k=1}r(t,k)\bigg{[}\frac{1}{%
\log_{2}(t+2)}" class="ltx_math_unparsed" display="inline" id="A6.E19X.2.1.1.m1.6"><semantics id="A6.E19X.2.1.1.m1.6a"><mrow id="A6.E19X.2.1.1.m1.6b"><mi id="A6.E19X.2.1.1.m1.6.7">h</mi><mi id="A6.E19X.2.1.1.m1.6.8">D</mi><mi id="A6.E19X.2.1.1.m1.6.9">C</mi><mi id="A6.E19X.2.1.1.m1.6.10">G</mi><mi id="A6.E19X.2.1.1.m1.6.11" mathvariant="normal">@</mi><mrow id="A6.E19X.2.1.1.m1.6.12"><mo id="A6.E19X.2.1.1.m1.6.12.1" stretchy="false">(</mo><mi id="A6.E19X.2.1.1.m1.3.3">T</mi><mo id="A6.E19X.2.1.1.m1.6.12.2">,</mo><mi id="A6.E19X.2.1.1.m1.4.4">K</mi><mo id="A6.E19X.2.1.1.m1.6.12.3" stretchy="false">)</mo></mrow><mo id="A6.E19X.2.1.1.m1.6.13">=</mo><mstyle displaystyle="true" id="A6.E19X.2.1.1.m1.6.14"><munderover id="A6.E19X.2.1.1.m1.6.14a"><mo id="A6.E19X.2.1.1.m1.6.14.2.2" movablelimits="false">∑</mo><mrow id="A6.E19X.2.1.1.m1.6.14.3"><mi id="A6.E19X.2.1.1.m1.6.14.3.2">t</mi><mo id="A6.E19X.2.1.1.m1.6.14.3.1">=</mo><mn id="A6.E19X.2.1.1.m1.6.14.3.3">1</mn></mrow><mi id="A6.E19X.2.1.1.m1.6.14.2.3">T</mi></munderover></mstyle><mstyle displaystyle="true" id="A6.E19X.2.1.1.m1.6.15"><munderover id="A6.E19X.2.1.1.m1.6.15a"><mo id="A6.E19X.2.1.1.m1.6.15.2.2" movablelimits="false">∑</mo><mrow id="A6.E19X.2.1.1.m1.6.15.3"><mi id="A6.E19X.2.1.1.m1.6.15.3.2">k</mi><mo id="A6.E19X.2.1.1.m1.6.15.3.1">=</mo><mn id="A6.E19X.2.1.1.m1.6.15.3.3">1</mn></mrow><mi id="A6.E19X.2.1.1.m1.6.15.2.3">K</mi></munderover></mstyle><mi id="A6.E19X.2.1.1.m1.6.16">r</mi><mrow id="A6.E19X.2.1.1.m1.6.17"><mo id="A6.E19X.2.1.1.m1.6.17.1" stretchy="false">(</mo><mi id="A6.E19X.2.1.1.m1.5.5">t</mi><mo id="A6.E19X.2.1.1.m1.6.17.2">,</mo><mi id="A6.E19X.2.1.1.m1.6.6">k</mi><mo id="A6.E19X.2.1.1.m1.6.17.3" stretchy="false">)</mo></mrow><mrow id="A6.E19X.2.1.1.m1.6.18"><mo id="A6.E19X.2.1.1.m1.6.18.1" maxsize="210%" minsize="210%">[</mo><mstyle displaystyle="true" id="A6.E19X.2.1.1.m1.2.2"><mfrac id="A6.E19X.2.1.1.m1.2.2a"><mn id="A6.E19X.2.1.1.m1.2.2.4">1</mn><mrow id="A6.E19X.2.1.1.m1.2.2.2.2"><msub id="A6.E19X.2.1.1.m1.1.1.1.1.1"><mi id="A6.E19X.2.1.1.m1.1.1.1.1.1.2">log</mi><mn id="A6.E19X.2.1.1.m1.1.1.1.1.1.3">2</mn></msub><mo id="A6.E19X.2.1.1.m1.2.2.2.2a">⁡</mo><mrow id="A6.E19X.2.1.1.m1.2.2.2.2.2"><mo id="A6.E19X.2.1.1.m1.2.2.2.2.2.2" stretchy="false">(</mo><mrow id="A6.E19X.2.1.1.m1.2.2.2.2.2.1"><mi id="A6.E19X.2.1.1.m1.2.2.2.2.2.1.2">t</mi><mo id="A6.E19X.2.1.1.m1.2.2.2.2.2.1.1">+</mo><mn id="A6.E19X.2.1.1.m1.2.2.2.2.2.1.3">2</mn></mrow><mo id="A6.E19X.2.1.1.m1.2.2.2.2.2.3" stretchy="false">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation encoding="application/x-tex" id="A6.E19X.2.1.1.m1.6c">\displaystyle hDCG@(T,K)=\sum^{T}_{t=1}\sum^{K}_{k=1}r(t,k)\bigg{[}\frac{1}{%
\log_{2}(t+2)}</annotation><annotation encoding="application/x-llamapun" id="A6.E19X.2.1.1.m1.6d">italic_h italic_D italic_C italic_G @ ( italic_T , italic_K ) = ∑ start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT ∑ start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT italic_r ( italic_t , italic_k ) [ divide start_ARG 1 end_ARG start_ARG roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_t + 2 ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(19)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E19Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+\left(\frac{1}{\log_{2}(t+1)}-\frac{1}{\log_{2}(t+2)}\right)%
\frac{1}{\log_{2}(k+1)}\bigg{]}," class="ltx_math_unparsed" display="inline" id="A6.E19Xa.2.1.1.m1.6"><semantics id="A6.E19Xa.2.1.1.m1.6a"><mrow id="A6.E19Xa.2.1.1.m1.6b"><mo id="A6.E19Xa.2.1.1.m1.6.7">+</mo><mrow id="A6.E19Xa.2.1.1.m1.6.8"><mo id="A6.E19Xa.2.1.1.m1.6.8.1">(</mo><mstyle displaystyle="true" id="A6.E19Xa.2.1.1.m1.2.2"><mfrac id="A6.E19Xa.2.1.1.m1.2.2a"><mn id="A6.E19Xa.2.1.1.m1.2.2.4">1</mn><mrow id="A6.E19Xa.2.1.1.m1.2.2.2.2"><msub id="A6.E19Xa.2.1.1.m1.1.1.1.1.1"><mi id="A6.E19Xa.2.1.1.m1.1.1.1.1.1.2">log</mi><mn id="A6.E19Xa.2.1.1.m1.1.1.1.1.1.3">2</mn></msub><mo id="A6.E19Xa.2.1.1.m1.2.2.2.2a">⁡</mo><mrow id="A6.E19Xa.2.1.1.m1.2.2.2.2.2"><mo id="A6.E19Xa.2.1.1.m1.2.2.2.2.2.2" stretchy="false">(</mo><mrow id="A6.E19Xa.2.1.1.m1.2.2.2.2.2.1"><mi id="A6.E19Xa.2.1.1.m1.2.2.2.2.2.1.2">t</mi><mo id="A6.E19Xa.2.1.1.m1.2.2.2.2.2.1.1">+</mo><mn id="A6.E19Xa.2.1.1.m1.2.2.2.2.2.1.3">1</mn></mrow><mo id="A6.E19Xa.2.1.1.m1.2.2.2.2.2.3" stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo id="A6.E19Xa.2.1.1.m1.6.8.2">−</mo><mstyle displaystyle="true" id="A6.E19Xa.2.1.1.m1.4.4"><mfrac id="A6.E19Xa.2.1.1.m1.4.4a"><mn id="A6.E19Xa.2.1.1.m1.4.4.4">1</mn><mrow id="A6.E19Xa.2.1.1.m1.4.4.2.2"><msub id="A6.E19Xa.2.1.1.m1.3.3.1.1.1"><mi id="A6.E19Xa.2.1.1.m1.3.3.1.1.1.2">log</mi><mn id="A6.E19Xa.2.1.1.m1.3.3.1.1.1.3">2</mn></msub><mo id="A6.E19Xa.2.1.1.m1.4.4.2.2a">⁡</mo><mrow id="A6.E19Xa.2.1.1.m1.4.4.2.2.2"><mo id="A6.E19Xa.2.1.1.m1.4.4.2.2.2.2" stretchy="false">(</mo><mrow id="A6.E19Xa.2.1.1.m1.4.4.2.2.2.1"><mi id="A6.E19Xa.2.1.1.m1.4.4.2.2.2.1.2">t</mi><mo id="A6.E19Xa.2.1.1.m1.4.4.2.2.2.1.1">+</mo><mn id="A6.E19Xa.2.1.1.m1.4.4.2.2.2.1.3">2</mn></mrow><mo id="A6.E19Xa.2.1.1.m1.4.4.2.2.2.3" stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo id="A6.E19Xa.2.1.1.m1.6.8.3">)</mo></mrow><mstyle displaystyle="true" id="A6.E19Xa.2.1.1.m1.6.6"><mfrac id="A6.E19Xa.2.1.1.m1.6.6a"><mn id="A6.E19Xa.2.1.1.m1.6.6.4">1</mn><mrow id="A6.E19Xa.2.1.1.m1.6.6.2.2"><msub id="A6.E19Xa.2.1.1.m1.5.5.1.1.1"><mi id="A6.E19Xa.2.1.1.m1.5.5.1.1.1.2">log</mi><mn id="A6.E19Xa.2.1.1.m1.5.5.1.1.1.3">2</mn></msub><mo id="A6.E19Xa.2.1.1.m1.6.6.2.2a">⁡</mo><mrow id="A6.E19Xa.2.1.1.m1.6.6.2.2.2"><mo id="A6.E19Xa.2.1.1.m1.6.6.2.2.2.2" stretchy="false">(</mo><mrow id="A6.E19Xa.2.1.1.m1.6.6.2.2.2.1"><mi id="A6.E19Xa.2.1.1.m1.6.6.2.2.2.1.2">k</mi><mo id="A6.E19Xa.2.1.1.m1.6.6.2.2.2.1.1">+</mo><mn id="A6.E19Xa.2.1.1.m1.6.6.2.2.2.1.3">1</mn></mrow><mo id="A6.E19Xa.2.1.1.m1.6.6.2.2.2.3" stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo id="A6.E19Xa.2.1.1.m1.6.9" maxsize="210%" minsize="210%">]</mo><mo id="A6.E19Xa.2.1.1.m1.6.10">,</mo></mrow><annotation encoding="application/x-tex" id="A6.E19Xa.2.1.1.m1.6c">\displaystyle+\left(\frac{1}{\log_{2}(t+1)}-\frac{1}{\log_{2}(t+2)}\right)%
\frac{1}{\log_{2}(k+1)}\bigg{]},</annotation><annotation encoding="application/x-llamapun" id="A6.E19Xa.2.1.1.m1.6d">+ ( divide start_ARG 1 end_ARG start_ARG roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_t + 1 ) end_ARG - divide start_ARG 1 end_ARG start_ARG roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_t + 2 ) end_ARG ) divide start_ARG 1 end_ARG start_ARG roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_k + 1 ) end_ARG ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="A6.SS3.p1.12">where <math alttext="T" class="ltx_Math" display="inline" id="A6.SS3.p1.3.m1.1"><semantics id="A6.SS3.p1.3.m1.1a"><mi id="A6.SS3.p1.3.m1.1.1" xref="A6.SS3.p1.3.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.3.m1.1b"><ci id="A6.SS3.p1.3.m1.1.1.cmml" xref="A6.SS3.p1.3.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.3.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="A6.SS3.p1.3.m1.1d">italic_T</annotation></semantics></math> represents the number of conversational turns, <math alttext="K" class="ltx_Math" display="inline" id="A6.SS3.p1.4.m2.1"><semantics id="A6.SS3.p1.4.m2.1a"><mi id="A6.SS3.p1.4.m2.1.1" xref="A6.SS3.p1.4.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.4.m2.1b"><ci id="A6.SS3.p1.4.m2.1.1.cmml" xref="A6.SS3.p1.4.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.4.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="A6.SS3.p1.4.m2.1d">italic_K</annotation></semantics></math> represents the number of items recommended at each turn, <math alttext="r(t,k)" class="ltx_Math" display="inline" id="A6.SS3.p1.5.m3.2"><semantics id="A6.SS3.p1.5.m3.2a"><mrow id="A6.SS3.p1.5.m3.2.3" xref="A6.SS3.p1.5.m3.2.3.cmml"><mi id="A6.SS3.p1.5.m3.2.3.2" xref="A6.SS3.p1.5.m3.2.3.2.cmml">r</mi><mo id="A6.SS3.p1.5.m3.2.3.1" xref="A6.SS3.p1.5.m3.2.3.1.cmml">⁢</mo><mrow id="A6.SS3.p1.5.m3.2.3.3.2" xref="A6.SS3.p1.5.m3.2.3.3.1.cmml"><mo id="A6.SS3.p1.5.m3.2.3.3.2.1" stretchy="false" xref="A6.SS3.p1.5.m3.2.3.3.1.cmml">(</mo><mi id="A6.SS3.p1.5.m3.1.1" xref="A6.SS3.p1.5.m3.1.1.cmml">t</mi><mo id="A6.SS3.p1.5.m3.2.3.3.2.2" xref="A6.SS3.p1.5.m3.2.3.3.1.cmml">,</mo><mi id="A6.SS3.p1.5.m3.2.2" xref="A6.SS3.p1.5.m3.2.2.cmml">k</mi><mo id="A6.SS3.p1.5.m3.2.3.3.2.3" stretchy="false" xref="A6.SS3.p1.5.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.5.m3.2b"><apply id="A6.SS3.p1.5.m3.2.3.cmml" xref="A6.SS3.p1.5.m3.2.3"><times id="A6.SS3.p1.5.m3.2.3.1.cmml" xref="A6.SS3.p1.5.m3.2.3.1"></times><ci id="A6.SS3.p1.5.m3.2.3.2.cmml" xref="A6.SS3.p1.5.m3.2.3.2">𝑟</ci><interval closure="open" id="A6.SS3.p1.5.m3.2.3.3.1.cmml" xref="A6.SS3.p1.5.m3.2.3.3.2"><ci id="A6.SS3.p1.5.m3.1.1.cmml" xref="A6.SS3.p1.5.m3.1.1">𝑡</ci><ci id="A6.SS3.p1.5.m3.2.2.cmml" xref="A6.SS3.p1.5.m3.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.5.m3.2c">r(t,k)</annotation><annotation encoding="application/x-llamapun" id="A6.SS3.p1.5.m3.2d">italic_r ( italic_t , italic_k )</annotation></semantics></math> denotes the relevance of the result at turn <math alttext="t" class="ltx_Math" display="inline" id="A6.SS3.p1.6.m4.1"><semantics id="A6.SS3.p1.6.m4.1a"><mi id="A6.SS3.p1.6.m4.1.1" xref="A6.SS3.p1.6.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.6.m4.1b"><ci id="A6.SS3.p1.6.m4.1.1.cmml" xref="A6.SS3.p1.6.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.6.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="A6.SS3.p1.6.m4.1d">italic_t</annotation></semantics></math> and position <math alttext="k" class="ltx_Math" display="inline" id="A6.SS3.p1.7.m5.1"><semantics id="A6.SS3.p1.7.m5.1a"><mi id="A6.SS3.p1.7.m5.1.1" xref="A6.SS3.p1.7.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.7.m5.1b"><ci id="A6.SS3.p1.7.m5.1.1.cmml" xref="A6.SS3.p1.7.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.7.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="A6.SS3.p1.7.m5.1d">italic_k</annotation></semantics></math>. Since we have a maximum of <math alttext="T_{\text{max}}" class="ltx_Math" display="inline" id="A6.SS3.p1.8.m6.1"><semantics id="A6.SS3.p1.8.m6.1a"><msub id="A6.SS3.p1.8.m6.1.1" xref="A6.SS3.p1.8.m6.1.1.cmml"><mi id="A6.SS3.p1.8.m6.1.1.2" xref="A6.SS3.p1.8.m6.1.1.2.cmml">T</mi><mtext id="A6.SS3.p1.8.m6.1.1.3" xref="A6.SS3.p1.8.m6.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.8.m6.1b"><apply id="A6.SS3.p1.8.m6.1.1.cmml" xref="A6.SS3.p1.8.m6.1.1"><csymbol cd="ambiguous" id="A6.SS3.p1.8.m6.1.1.1.cmml" xref="A6.SS3.p1.8.m6.1.1">subscript</csymbol><ci id="A6.SS3.p1.8.m6.1.1.2.cmml" xref="A6.SS3.p1.8.m6.1.1.2">𝑇</ci><ci id="A6.SS3.p1.8.m6.1.1.3a.cmml" xref="A6.SS3.p1.8.m6.1.1.3"><mtext id="A6.SS3.p1.8.m6.1.1.3.cmml" mathsize="70%" xref="A6.SS3.p1.8.m6.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.8.m6.1c">T_{\text{max}}</annotation><annotation encoding="application/x-llamapun" id="A6.SS3.p1.8.m6.1d">italic_T start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math> conversational turns, and the CRS may recommend a maximum number of <math alttext="K_{v}" class="ltx_Math" display="inline" id="A6.SS3.p1.9.m7.1"><semantics id="A6.SS3.p1.9.m7.1a"><msub id="A6.SS3.p1.9.m7.1.1" xref="A6.SS3.p1.9.m7.1.1.cmml"><mi id="A6.SS3.p1.9.m7.1.1.2" xref="A6.SS3.p1.9.m7.1.1.2.cmml">K</mi><mi id="A6.SS3.p1.9.m7.1.1.3" xref="A6.SS3.p1.9.m7.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.9.m7.1b"><apply id="A6.SS3.p1.9.m7.1.1.cmml" xref="A6.SS3.p1.9.m7.1.1"><csymbol cd="ambiguous" id="A6.SS3.p1.9.m7.1.1.1.cmml" xref="A6.SS3.p1.9.m7.1.1">subscript</csymbol><ci id="A6.SS3.p1.9.m7.1.1.2.cmml" xref="A6.SS3.p1.9.m7.1.1.2">𝐾</ci><ci id="A6.SS3.p1.9.m7.1.1.3.cmml" xref="A6.SS3.p1.9.m7.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.9.m7.1c">K_{v}</annotation><annotation encoding="application/x-llamapun" id="A6.SS3.p1.9.m7.1d">italic_K start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> items, we report the metric <math alttext="hDCG(T,K)" class="ltx_Math" display="inline" id="A6.SS3.p1.10.m8.2"><semantics id="A6.SS3.p1.10.m8.2a"><mrow id="A6.SS3.p1.10.m8.2.3" xref="A6.SS3.p1.10.m8.2.3.cmml"><mi id="A6.SS3.p1.10.m8.2.3.2" xref="A6.SS3.p1.10.m8.2.3.2.cmml">h</mi><mo id="A6.SS3.p1.10.m8.2.3.1" xref="A6.SS3.p1.10.m8.2.3.1.cmml">⁢</mo><mi id="A6.SS3.p1.10.m8.2.3.3" xref="A6.SS3.p1.10.m8.2.3.3.cmml">D</mi><mo id="A6.SS3.p1.10.m8.2.3.1a" xref="A6.SS3.p1.10.m8.2.3.1.cmml">⁢</mo><mi id="A6.SS3.p1.10.m8.2.3.4" xref="A6.SS3.p1.10.m8.2.3.4.cmml">C</mi><mo id="A6.SS3.p1.10.m8.2.3.1b" xref="A6.SS3.p1.10.m8.2.3.1.cmml">⁢</mo><mi id="A6.SS3.p1.10.m8.2.3.5" xref="A6.SS3.p1.10.m8.2.3.5.cmml">G</mi><mo id="A6.SS3.p1.10.m8.2.3.1c" xref="A6.SS3.p1.10.m8.2.3.1.cmml">⁢</mo><mrow id="A6.SS3.p1.10.m8.2.3.6.2" xref="A6.SS3.p1.10.m8.2.3.6.1.cmml"><mo id="A6.SS3.p1.10.m8.2.3.6.2.1" stretchy="false" xref="A6.SS3.p1.10.m8.2.3.6.1.cmml">(</mo><mi id="A6.SS3.p1.10.m8.1.1" xref="A6.SS3.p1.10.m8.1.1.cmml">T</mi><mo id="A6.SS3.p1.10.m8.2.3.6.2.2" xref="A6.SS3.p1.10.m8.2.3.6.1.cmml">,</mo><mi id="A6.SS3.p1.10.m8.2.2" xref="A6.SS3.p1.10.m8.2.2.cmml">K</mi><mo id="A6.SS3.p1.10.m8.2.3.6.2.3" stretchy="false" xref="A6.SS3.p1.10.m8.2.3.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.10.m8.2b"><apply id="A6.SS3.p1.10.m8.2.3.cmml" xref="A6.SS3.p1.10.m8.2.3"><times id="A6.SS3.p1.10.m8.2.3.1.cmml" xref="A6.SS3.p1.10.m8.2.3.1"></times><ci id="A6.SS3.p1.10.m8.2.3.2.cmml" xref="A6.SS3.p1.10.m8.2.3.2">ℎ</ci><ci id="A6.SS3.p1.10.m8.2.3.3.cmml" xref="A6.SS3.p1.10.m8.2.3.3">𝐷</ci><ci id="A6.SS3.p1.10.m8.2.3.4.cmml" xref="A6.SS3.p1.10.m8.2.3.4">𝐶</ci><ci id="A6.SS3.p1.10.m8.2.3.5.cmml" xref="A6.SS3.p1.10.m8.2.3.5">𝐺</ci><interval closure="open" id="A6.SS3.p1.10.m8.2.3.6.1.cmml" xref="A6.SS3.p1.10.m8.2.3.6.2"><ci id="A6.SS3.p1.10.m8.1.1.cmml" xref="A6.SS3.p1.10.m8.1.1">𝑇</ci><ci id="A6.SS3.p1.10.m8.2.2.cmml" xref="A6.SS3.p1.10.m8.2.2">𝐾</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.10.m8.2c">hDCG(T,K)</annotation><annotation encoding="application/x-llamapun" id="A6.SS3.p1.10.m8.2d">italic_h italic_D italic_C italic_G ( italic_T , italic_K )</annotation></semantics></math> where <math alttext="T=T_{\text{max}}" class="ltx_Math" display="inline" id="A6.SS3.p1.11.m9.1"><semantics id="A6.SS3.p1.11.m9.1a"><mrow id="A6.SS3.p1.11.m9.1.1" xref="A6.SS3.p1.11.m9.1.1.cmml"><mi id="A6.SS3.p1.11.m9.1.1.2" xref="A6.SS3.p1.11.m9.1.1.2.cmml">T</mi><mo id="A6.SS3.p1.11.m9.1.1.1" xref="A6.SS3.p1.11.m9.1.1.1.cmml">=</mo><msub id="A6.SS3.p1.11.m9.1.1.3" xref="A6.SS3.p1.11.m9.1.1.3.cmml"><mi id="A6.SS3.p1.11.m9.1.1.3.2" xref="A6.SS3.p1.11.m9.1.1.3.2.cmml">T</mi><mtext id="A6.SS3.p1.11.m9.1.1.3.3" xref="A6.SS3.p1.11.m9.1.1.3.3a.cmml">max</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.11.m9.1b"><apply id="A6.SS3.p1.11.m9.1.1.cmml" xref="A6.SS3.p1.11.m9.1.1"><eq id="A6.SS3.p1.11.m9.1.1.1.cmml" xref="A6.SS3.p1.11.m9.1.1.1"></eq><ci id="A6.SS3.p1.11.m9.1.1.2.cmml" xref="A6.SS3.p1.11.m9.1.1.2">𝑇</ci><apply id="A6.SS3.p1.11.m9.1.1.3.cmml" xref="A6.SS3.p1.11.m9.1.1.3"><csymbol cd="ambiguous" id="A6.SS3.p1.11.m9.1.1.3.1.cmml" xref="A6.SS3.p1.11.m9.1.1.3">subscript</csymbol><ci id="A6.SS3.p1.11.m9.1.1.3.2.cmml" xref="A6.SS3.p1.11.m9.1.1.3.2">𝑇</ci><ci id="A6.SS3.p1.11.m9.1.1.3.3a.cmml" xref="A6.SS3.p1.11.m9.1.1.3.3"><mtext id="A6.SS3.p1.11.m9.1.1.3.3.cmml" mathsize="70%" xref="A6.SS3.p1.11.m9.1.1.3.3">max</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.11.m9.1c">T=T_{\text{max}}</annotation><annotation encoding="application/x-llamapun" id="A6.SS3.p1.11.m9.1d">italic_T = italic_T start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="K=K_{v}" class="ltx_Math" display="inline" id="A6.SS3.p1.12.m10.1"><semantics id="A6.SS3.p1.12.m10.1a"><mrow id="A6.SS3.p1.12.m10.1.1" xref="A6.SS3.p1.12.m10.1.1.cmml"><mi id="A6.SS3.p1.12.m10.1.1.2" xref="A6.SS3.p1.12.m10.1.1.2.cmml">K</mi><mo id="A6.SS3.p1.12.m10.1.1.1" xref="A6.SS3.p1.12.m10.1.1.1.cmml">=</mo><msub id="A6.SS3.p1.12.m10.1.1.3" xref="A6.SS3.p1.12.m10.1.1.3.cmml"><mi id="A6.SS3.p1.12.m10.1.1.3.2" xref="A6.SS3.p1.12.m10.1.1.3.2.cmml">K</mi><mi id="A6.SS3.p1.12.m10.1.1.3.3" xref="A6.SS3.p1.12.m10.1.1.3.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.12.m10.1b"><apply id="A6.SS3.p1.12.m10.1.1.cmml" xref="A6.SS3.p1.12.m10.1.1"><eq id="A6.SS3.p1.12.m10.1.1.1.cmml" xref="A6.SS3.p1.12.m10.1.1.1"></eq><ci id="A6.SS3.p1.12.m10.1.1.2.cmml" xref="A6.SS3.p1.12.m10.1.1.2">𝐾</ci><apply id="A6.SS3.p1.12.m10.1.1.3.cmml" xref="A6.SS3.p1.12.m10.1.1.3"><csymbol cd="ambiguous" id="A6.SS3.p1.12.m10.1.1.3.1.cmml" xref="A6.SS3.p1.12.m10.1.1.3">subscript</csymbol><ci id="A6.SS3.p1.12.m10.1.1.3.2.cmml" xref="A6.SS3.p1.12.m10.1.1.3.2">𝐾</ci><ci id="A6.SS3.p1.12.m10.1.1.3.3.cmml" xref="A6.SS3.p1.12.m10.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.12.m10.1c">K=K_{v}</annotation><annotation encoding="application/x-llamapun" id="A6.SS3.p1.12.m10.1d">italic_K = italic_K start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="A6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.4 </span>Details of Baseline Methods</h3>
<figure class="ltx_figure" id="A6.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="155" id="A6.F1.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure A1: </span>Success rate under different exploration factor <math alttext="w" class="ltx_Math" display="inline" id="A6.F1.2.m1.1"><semantics id="A6.F1.2.m1.1b"><mi id="A6.F1.2.m1.1.1" xref="A6.F1.2.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A6.F1.2.m1.1c"><ci id="A6.F1.2.m1.1.1.cmml" xref="A6.F1.2.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.F1.2.m1.1d">w</annotation><annotation encoding="application/x-llamapun" id="A6.F1.2.m1.1e">italic_w</annotation></semantics></math>.</figcaption>
</figure>
<figure class="ltx_figure" id="A6.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="145" id="A6.F2.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure A2: </span>Success rate and training time (per 100 gradient descent steps) under different rollout number <math alttext="N" class="ltx_Math" display="inline" id="A6.F2.2.m1.1"><semantics id="A6.F2.2.m1.1b"><mi id="A6.F2.2.m1.1.1" xref="A6.F2.2.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A6.F2.2.m1.1c"><ci id="A6.F2.2.m1.1.1.cmml" xref="A6.F2.2.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.F2.2.m1.1d">N</annotation><annotation encoding="application/x-llamapun" id="A6.F2.2.m1.1e">italic_N</annotation></semantics></math>. The dotted lines represent the success rate, and the bar charts represent the training time.</figcaption>
</figure>
<div class="ltx_para" id="A6.SS4.p1">
<p class="ltx_p" id="A6.SS4.p1.1">For a comprehensive evaluation, we compare <span class="ltx_ERROR undefined" id="A6.SS4.p1.1.1">\method</span>with the following baselines:</p>
<ul class="ltx_itemize" id="A6.I2">
<li class="ltx_item" id="A6.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I2.i1.p1">
<p class="ltx_p" id="A6.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I2.i1.p1.1.1">Max Entropy</span> <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite>. This method chooses to ask for attribute values with the maximum entropy among candidate items, or chooses to recommend the top-ranked items with certain probability.</p>
</div>
</li>
<li class="ltx_item" id="A6.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I2.i2.p1">
<p class="ltx_p" id="A6.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I2.i2.p1.1.1">Abs Greedy</span> <cite class="ltx_cite ltx_citemacro_cite">Christakopoulou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib8" title="">2016</a>)</cite>. This method only recommends items in each turn without asking questions. If the recommended items are rejected, the model updates by treating them as negative samples.</p>
</div>
</li>
<li class="ltx_item" id="A6.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I2.i3.p1">
<p class="ltx_p" id="A6.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I2.i3.p1.1.1">CRM</span> <cite class="ltx_cite ltx_citemacro_cite">Sun and Zhang (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib41" title="">2018</a>)</cite>. This method adopts a policy network to decide when and what to ask. As it is originally designed for single-turn CRS, we follow <cite class="ltx_cite ltx_citemacro_citet">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite> to adapt it to the MCR setting.</p>
</div>
</li>
<li class="ltx_item" id="A6.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I2.i4.p1">
<p class="ltx_p" id="A6.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I2.i4.p1.1.1">EAR</span> <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>)</cite>. This method designs a three-stage strategy to better converse with users. It first builds predictive models to estimate user preferences, then learns a policy network to take action, and finally updates the recommendation model with reflection mechanism.</p>
</div>
</li>
<li class="ltx_item" id="A6.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I2.i5.p1">
<p class="ltx_p" id="A6.I2.i5.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I2.i5.p1.1.1">SCPR</span> <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib28" title="">2020c</a>)</cite>. This method models CRS as an interactive path reasoning problem over the knowledge graph of users, items and attribute values. It leverages the graph structure to prune irrelevant candidate attribute values and adopts a policy network to choose actions.</p>
</div>
</li>
<li class="ltx_item" id="A6.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I2.i6.p1">
<p class="ltx_p" id="A6.I2.i6.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I2.i6.p1.1.1">UNICORN</span> <cite class="ltx_cite ltx_citemacro_cite">Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>)</cite>. This method designs a unified CRS policy learning framework with graph-based state representation learning and deep Q-learning.</p>
</div>
</li>
<li class="ltx_item" id="A6.I2.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I2.i7.p1">
<p class="ltx_p" id="A6.I2.i7.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I2.i7.p1.1.1">MCMIPL</span> <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>)</cite>. This method develops a multi-choice questions based multi-interest policy learning framework for CRS, which enables users to answer multi-choice questions in attribute combinations.</p>
</div>
</li>
<li class="ltx_item" id="A6.I2.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I2.i8.p1">
<p class="ltx_p" id="A6.I2.i8.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I2.i8.p1.1.1">HutCRS</span> <cite class="ltx_cite ltx_citemacro_cite">Qian et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib36" title="">2023</a>)</cite>. This method proposes a user interest tracking module integrated with the decision-making process of the CRS to better understand the preferences of the user.</p>
</div>
</li>
<li class="ltx_item" id="A6.I2.i9" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I2.i9.p1">
<p class="ltx_p" id="A6.I2.i9.p1.1"><span class="ltx_text ltx_font_bold" id="A6.I2.i9.p1.1.1">CORE</span> <cite class="ltx_cite ltx_citemacro_cite">Jin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib20" title="">2023</a>)</cite>. This method is a Large Language Model (LLM)-powered CRS chatbot with user-friendly prompts and interactive feedback mechanisms.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="A6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.5 </span>Implementation Details</h3>
<div class="ltx_para" id="A6.SS5.p1">
<p class="ltx_p" id="A6.SS5.p1.17">Following the literature <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>)</cite> for a more realistic multi-choice setting, if <span class="ltx_text" id="A6.SS5.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.SS5.p1.1.1.m1.1"><semantics id="A6.SS5.p1.1.1.m1.1a"><mrow id="A6.SS5.p1.1.1.m1.1.1" xref="A6.SS5.p1.1.1.m1.1.1.cmml"><mi id="A6.SS5.p1.1.1.m1.1.1.2" xref="A6.SS5.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="A6.SS5.p1.1.1.m1.1.1.1" xref="A6.SS5.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="A6.SS5.p1.1.1.m1.1.1.3" xref="A6.SS5.p1.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.1.1.m1.1b"><apply id="A6.SS5.p1.1.1.m1.1.1.cmml" xref="A6.SS5.p1.1.1.m1.1.1"><times id="A6.SS5.p1.1.1.m1.1.1.1.cmml" xref="A6.SS5.p1.1.1.m1.1.1.1"></times><ci id="A6.SS5.p1.1.1.m1.1.1.2.cmml" xref="A6.SS5.p1.1.1.m1.1.1.2">𝚂</ci><ci id="A6.SS5.p1.1.1.m1.1.1.3a.cmml" xref="A6.SS5.p1.1.1.m1.1.1.3"><mtext id="A6.SS5.p1.1.1.m1.1.1.3.cmml" xref="A6.SS5.p1.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> decides to ask, top-<math alttext="K_{p}" class="ltx_Math" display="inline" id="A6.SS5.p1.2.m1.1"><semantics id="A6.SS5.p1.2.m1.1a"><msub id="A6.SS5.p1.2.m1.1.1" xref="A6.SS5.p1.2.m1.1.1.cmml"><mi id="A6.SS5.p1.2.m1.1.1.2" xref="A6.SS5.p1.2.m1.1.1.2.cmml">K</mi><mi id="A6.SS5.p1.2.m1.1.1.3" xref="A6.SS5.p1.2.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.2.m1.1b"><apply id="A6.SS5.p1.2.m1.1.1.cmml" xref="A6.SS5.p1.2.m1.1.1"><csymbol cd="ambiguous" id="A6.SS5.p1.2.m1.1.1.1.cmml" xref="A6.SS5.p1.2.m1.1.1">subscript</csymbol><ci id="A6.SS5.p1.2.m1.1.1.2.cmml" xref="A6.SS5.p1.2.m1.1.1.2">𝐾</ci><ci id="A6.SS5.p1.2.m1.1.1.3.cmml" xref="A6.SS5.p1.2.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.2.m1.1c">K_{p}</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.2.m1.1d">italic_K start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> attribute values with the same attribute type will be asked from the candidate attribute value set <math alttext="\mathcal{P}^{c}_{t}" class="ltx_Math" display="inline" id="A6.SS5.p1.3.m2.1"><semantics id="A6.SS5.p1.3.m2.1a"><msubsup id="A6.SS5.p1.3.m2.1.1" xref="A6.SS5.p1.3.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.SS5.p1.3.m2.1.1.2.2" xref="A6.SS5.p1.3.m2.1.1.2.2.cmml">𝒫</mi><mi id="A6.SS5.p1.3.m2.1.1.3" xref="A6.SS5.p1.3.m2.1.1.3.cmml">t</mi><mi id="A6.SS5.p1.3.m2.1.1.2.3" xref="A6.SS5.p1.3.m2.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.3.m2.1b"><apply id="A6.SS5.p1.3.m2.1.1.cmml" xref="A6.SS5.p1.3.m2.1.1"><csymbol cd="ambiguous" id="A6.SS5.p1.3.m2.1.1.1.cmml" xref="A6.SS5.p1.3.m2.1.1">subscript</csymbol><apply id="A6.SS5.p1.3.m2.1.1.2.cmml" xref="A6.SS5.p1.3.m2.1.1"><csymbol cd="ambiguous" id="A6.SS5.p1.3.m2.1.1.2.1.cmml" xref="A6.SS5.p1.3.m2.1.1">superscript</csymbol><ci id="A6.SS5.p1.3.m2.1.1.2.2.cmml" xref="A6.SS5.p1.3.m2.1.1.2.2">𝒫</ci><ci id="A6.SS5.p1.3.m2.1.1.2.3.cmml" xref="A6.SS5.p1.3.m2.1.1.2.3">𝑐</ci></apply><ci id="A6.SS5.p1.3.m2.1.1.3.cmml" xref="A6.SS5.p1.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.3.m2.1c">\mathcal{P}^{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.3.m2.1d">caligraphic_P start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to form a multi-choice question; and if <span class="ltx_text" id="A6.SS5.p1.4.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.SS5.p1.4.2.m1.1"><semantics id="A6.SS5.p1.4.2.m1.1a"><mrow id="A6.SS5.p1.4.2.m1.1.1" xref="A6.SS5.p1.4.2.m1.1.1.cmml"><mi id="A6.SS5.p1.4.2.m1.1.1.2" xref="A6.SS5.p1.4.2.m1.1.1.2.cmml">𝚂</mi><mo id="A6.SS5.p1.4.2.m1.1.1.1" xref="A6.SS5.p1.4.2.m1.1.1.1.cmml">⁢</mo><mtext id="A6.SS5.p1.4.2.m1.1.1.3" xref="A6.SS5.p1.4.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.4.2.m1.1b"><apply id="A6.SS5.p1.4.2.m1.1.1.cmml" xref="A6.SS5.p1.4.2.m1.1.1"><times id="A6.SS5.p1.4.2.m1.1.1.1.cmml" xref="A6.SS5.p1.4.2.m1.1.1.1"></times><ci id="A6.SS5.p1.4.2.m1.1.1.2.cmml" xref="A6.SS5.p1.4.2.m1.1.1.2">𝚂</ci><ci id="A6.SS5.p1.4.2.m1.1.1.3a.cmml" xref="A6.SS5.p1.4.2.m1.1.1.3"><mtext id="A6.SS5.p1.4.2.m1.1.1.3.cmml" xref="A6.SS5.p1.4.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.4.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.4.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> decides to recommend, top-<math alttext="K_{v}" class="ltx_Math" display="inline" id="A6.SS5.p1.5.m3.1"><semantics id="A6.SS5.p1.5.m3.1a"><msub id="A6.SS5.p1.5.m3.1.1" xref="A6.SS5.p1.5.m3.1.1.cmml"><mi id="A6.SS5.p1.5.m3.1.1.2" xref="A6.SS5.p1.5.m3.1.1.2.cmml">K</mi><mi id="A6.SS5.p1.5.m3.1.1.3" xref="A6.SS5.p1.5.m3.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.5.m3.1b"><apply id="A6.SS5.p1.5.m3.1.1.cmml" xref="A6.SS5.p1.5.m3.1.1"><csymbol cd="ambiguous" id="A6.SS5.p1.5.m3.1.1.1.cmml" xref="A6.SS5.p1.5.m3.1.1">subscript</csymbol><ci id="A6.SS5.p1.5.m3.1.1.2.cmml" xref="A6.SS5.p1.5.m3.1.1.2">𝐾</ci><ci id="A6.SS5.p1.5.m3.1.1.3.cmml" xref="A6.SS5.p1.5.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.5.m3.1c">K_{v}</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.5.m3.1d">italic_K start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> items will be recommended from the candidate item set <math alttext="\mathcal{V}^{c}_{t}" class="ltx_Math" display="inline" id="A6.SS5.p1.6.m4.1"><semantics id="A6.SS5.p1.6.m4.1a"><msubsup id="A6.SS5.p1.6.m4.1.1" xref="A6.SS5.p1.6.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.SS5.p1.6.m4.1.1.2.2" xref="A6.SS5.p1.6.m4.1.1.2.2.cmml">𝒱</mi><mi id="A6.SS5.p1.6.m4.1.1.3" xref="A6.SS5.p1.6.m4.1.1.3.cmml">t</mi><mi id="A6.SS5.p1.6.m4.1.1.2.3" xref="A6.SS5.p1.6.m4.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.6.m4.1b"><apply id="A6.SS5.p1.6.m4.1.1.cmml" xref="A6.SS5.p1.6.m4.1.1"><csymbol cd="ambiguous" id="A6.SS5.p1.6.m4.1.1.1.cmml" xref="A6.SS5.p1.6.m4.1.1">subscript</csymbol><apply id="A6.SS5.p1.6.m4.1.1.2.cmml" xref="A6.SS5.p1.6.m4.1.1"><csymbol cd="ambiguous" id="A6.SS5.p1.6.m4.1.1.2.1.cmml" xref="A6.SS5.p1.6.m4.1.1">superscript</csymbol><ci id="A6.SS5.p1.6.m4.1.1.2.2.cmml" xref="A6.SS5.p1.6.m4.1.1.2.2">𝒱</ci><ci id="A6.SS5.p1.6.m4.1.1.2.3.cmml" xref="A6.SS5.p1.6.m4.1.1.2.3">𝑐</ci></apply><ci id="A6.SS5.p1.6.m4.1.1.3.cmml" xref="A6.SS5.p1.6.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.6.m4.1c">\mathcal{V}^{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.6.m4.1d">caligraphic_V start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Following the literature <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib28" title="">2020c</a>); Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>)</cite>, each dataset is randomly split into train, validation and test by a 7:1.5:1.5 ratio. We set the embedding dimension <math alttext="d" class="ltx_Math" display="inline" id="A6.SS5.p1.7.m5.1"><semantics id="A6.SS5.p1.7.m5.1a"><mi id="A6.SS5.p1.7.m5.1.1" xref="A6.SS5.p1.7.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.7.m5.1b"><ci id="A6.SS5.p1.7.m5.1.1.cmml" xref="A6.SS5.p1.7.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.7.m5.1c">d</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.7.m5.1d">italic_d</annotation></semantics></math> as 64, batch size as 128. We adopt an Adam optimizer <cite class="ltx_cite ltx_citemacro_cite">Kingma and Ba (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib21" title="">2015</a>)</cite> with a learning rate of 1e-4. We set the discount factor <math alttext="\gamma" class="ltx_Math" display="inline" id="A6.SS5.p1.8.m6.1"><semantics id="A6.SS5.p1.8.m6.1a"><mi id="A6.SS5.p1.8.m6.1.1" xref="A6.SS5.p1.8.m6.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.8.m6.1b"><ci id="A6.SS5.p1.8.m6.1.1.cmml" xref="A6.SS5.p1.8.m6.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.8.m6.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.8.m6.1d">italic_γ</annotation></semantics></math> as 0.999. The memory size of experience replay is set as 10000. For the state encoder, the number of the global information graph encoder layers <math alttext="L_{g}" class="ltx_Math" display="inline" id="A6.SS5.p1.9.m7.1"><semantics id="A6.SS5.p1.9.m7.1a"><msub id="A6.SS5.p1.9.m7.1.1" xref="A6.SS5.p1.9.m7.1.1.cmml"><mi id="A6.SS5.p1.9.m7.1.1.2" xref="A6.SS5.p1.9.m7.1.1.2.cmml">L</mi><mi id="A6.SS5.p1.9.m7.1.1.3" xref="A6.SS5.p1.9.m7.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.9.m7.1b"><apply id="A6.SS5.p1.9.m7.1.1.cmml" xref="A6.SS5.p1.9.m7.1.1"><csymbol cd="ambiguous" id="A6.SS5.p1.9.m7.1.1.1.cmml" xref="A6.SS5.p1.9.m7.1.1">subscript</csymbol><ci id="A6.SS5.p1.9.m7.1.1.2.cmml" xref="A6.SS5.p1.9.m7.1.1.2">𝐿</ci><ci id="A6.SS5.p1.9.m7.1.1.3.cmml" xref="A6.SS5.p1.9.m7.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.9.m7.1c">L_{g}</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.9.m7.1d">italic_L start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> is set as 2, and both the number of the positive feedback graph encoder layer <math alttext="L_{a}" class="ltx_Math" display="inline" id="A6.SS5.p1.10.m8.1"><semantics id="A6.SS5.p1.10.m8.1a"><msub id="A6.SS5.p1.10.m8.1.1" xref="A6.SS5.p1.10.m8.1.1.cmml"><mi id="A6.SS5.p1.10.m8.1.1.2" xref="A6.SS5.p1.10.m8.1.1.2.cmml">L</mi><mi id="A6.SS5.p1.10.m8.1.1.3" xref="A6.SS5.p1.10.m8.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.10.m8.1b"><apply id="A6.SS5.p1.10.m8.1.1.cmml" xref="A6.SS5.p1.10.m8.1.1"><csymbol cd="ambiguous" id="A6.SS5.p1.10.m8.1.1.1.cmml" xref="A6.SS5.p1.10.m8.1.1">subscript</csymbol><ci id="A6.SS5.p1.10.m8.1.1.2.cmml" xref="A6.SS5.p1.10.m8.1.1.2">𝐿</ci><ci id="A6.SS5.p1.10.m8.1.1.3.cmml" xref="A6.SS5.p1.10.m8.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.10.m8.1c">L_{a}</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.10.m8.1d">italic_L start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> and the number of the negative feedback graph encoder layer <math alttext="L_{n}" class="ltx_Math" display="inline" id="A6.SS5.p1.11.m9.1"><semantics id="A6.SS5.p1.11.m9.1a"><msub id="A6.SS5.p1.11.m9.1.1" xref="A6.SS5.p1.11.m9.1.1.cmml"><mi id="A6.SS5.p1.11.m9.1.1.2" xref="A6.SS5.p1.11.m9.1.1.2.cmml">L</mi><mi id="A6.SS5.p1.11.m9.1.1.3" xref="A6.SS5.p1.11.m9.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.11.m9.1b"><apply id="A6.SS5.p1.11.m9.1.1.cmml" xref="A6.SS5.p1.11.m9.1.1"><csymbol cd="ambiguous" id="A6.SS5.p1.11.m9.1.1.1.cmml" xref="A6.SS5.p1.11.m9.1.1">subscript</csymbol><ci id="A6.SS5.p1.11.m9.1.1.2.cmml" xref="A6.SS5.p1.11.m9.1.1.2">𝐿</ci><ci id="A6.SS5.p1.11.m9.1.1.3.cmml" xref="A6.SS5.p1.11.m9.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.11.m9.1c">L_{n}</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.11.m9.1d">italic_L start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> are set as 1, the number of the Transformer-based aggregator layers are set as 2, and we follow the literature <cite class="ltx_cite ltx_citemacro_cite">Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib50" title="">2022</a>)</cite> to adopt TranE <cite class="ltx_cite ltx_citemacro_cite">Bordes et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib4" title="">2013</a>)</cite> from OpenKE <cite class="ltx_cite ltx_citemacro_cite">Han et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib14" title="">2018</a>)</cite> to pretrain the node embeddings with the training set. Following the literature <cite class="ltx_cite ltx_citemacro_cite">Lei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib27" title="">2020b</a>); Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib11" title="">2021</a>)</cite>, we set the size of recommendation list <math alttext="K_{v}" class="ltx_Math" display="inline" id="A6.SS5.p1.12.m10.1"><semantics id="A6.SS5.p1.12.m10.1a"><msub id="A6.SS5.p1.12.m10.1.1" xref="A6.SS5.p1.12.m10.1.1.cmml"><mi id="A6.SS5.p1.12.m10.1.1.2" xref="A6.SS5.p1.12.m10.1.1.2.cmml">K</mi><mi id="A6.SS5.p1.12.m10.1.1.3" xref="A6.SS5.p1.12.m10.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.12.m10.1b"><apply id="A6.SS5.p1.12.m10.1.1.cmml" xref="A6.SS5.p1.12.m10.1.1"><csymbol cd="ambiguous" id="A6.SS5.p1.12.m10.1.1.1.cmml" xref="A6.SS5.p1.12.m10.1.1">subscript</csymbol><ci id="A6.SS5.p1.12.m10.1.1.2.cmml" xref="A6.SS5.p1.12.m10.1.1.2">𝐾</ci><ci id="A6.SS5.p1.12.m10.1.1.3.cmml" xref="A6.SS5.p1.12.m10.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.12.m10.1c">K_{v}</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.12.m10.1d">italic_K start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> as 10, the maximum number of turns <math alttext="T_{\text{max}}=15" class="ltx_Math" display="inline" id="A6.SS5.p1.13.m11.1"><semantics id="A6.SS5.p1.13.m11.1a"><mrow id="A6.SS5.p1.13.m11.1.1" xref="A6.SS5.p1.13.m11.1.1.cmml"><msub id="A6.SS5.p1.13.m11.1.1.2" xref="A6.SS5.p1.13.m11.1.1.2.cmml"><mi id="A6.SS5.p1.13.m11.1.1.2.2" xref="A6.SS5.p1.13.m11.1.1.2.2.cmml">T</mi><mtext id="A6.SS5.p1.13.m11.1.1.2.3" xref="A6.SS5.p1.13.m11.1.1.2.3a.cmml">max</mtext></msub><mo id="A6.SS5.p1.13.m11.1.1.1" xref="A6.SS5.p1.13.m11.1.1.1.cmml">=</mo><mn id="A6.SS5.p1.13.m11.1.1.3" xref="A6.SS5.p1.13.m11.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.13.m11.1b"><apply id="A6.SS5.p1.13.m11.1.1.cmml" xref="A6.SS5.p1.13.m11.1.1"><eq id="A6.SS5.p1.13.m11.1.1.1.cmml" xref="A6.SS5.p1.13.m11.1.1.1"></eq><apply id="A6.SS5.p1.13.m11.1.1.2.cmml" xref="A6.SS5.p1.13.m11.1.1.2"><csymbol cd="ambiguous" id="A6.SS5.p1.13.m11.1.1.2.1.cmml" xref="A6.SS5.p1.13.m11.1.1.2">subscript</csymbol><ci id="A6.SS5.p1.13.m11.1.1.2.2.cmml" xref="A6.SS5.p1.13.m11.1.1.2.2">𝑇</ci><ci id="A6.SS5.p1.13.m11.1.1.2.3a.cmml" xref="A6.SS5.p1.13.m11.1.1.2.3"><mtext id="A6.SS5.p1.13.m11.1.1.2.3.cmml" mathsize="70%" xref="A6.SS5.p1.13.m11.1.1.2.3">max</mtext></ci></apply><cn id="A6.SS5.p1.13.m11.1.1.3.cmml" type="integer" xref="A6.SS5.p1.13.m11.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.13.m11.1c">T_{\text{max}}=15</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.13.m11.1d">italic_T start_POSTSUBSCRIPT max end_POSTSUBSCRIPT = 15</annotation></semantics></math>. We set the default exploration factor <math alttext="w" class="ltx_Math" display="inline" id="A6.SS5.p1.14.m12.1"><semantics id="A6.SS5.p1.14.m12.1a"><mi id="A6.SS5.p1.14.m12.1.1" xref="A6.SS5.p1.14.m12.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.14.m12.1b"><ci id="A6.SS5.p1.14.m12.1.1.cmml" xref="A6.SS5.p1.14.m12.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.14.m12.1c">w</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.14.m12.1d">italic_w</annotation></semantics></math> as 1.5, the default number of rollouts <math alttext="N" class="ltx_Math" display="inline" id="A6.SS5.p1.15.m13.1"><semantics id="A6.SS5.p1.15.m13.1a"><mi id="A6.SS5.p1.15.m13.1.1" xref="A6.SS5.p1.15.m13.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.15.m13.1b"><ci id="A6.SS5.p1.15.m13.1.1.cmml" xref="A6.SS5.p1.15.m13.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.15.m13.1c">N</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.15.m13.1d">italic_N</annotation></semantics></math> as 20, and variants with different <math alttext="w" class="ltx_Math" display="inline" id="A6.SS5.p1.16.m14.1"><semantics id="A6.SS5.p1.16.m14.1a"><mi id="A6.SS5.p1.16.m14.1.1" xref="A6.SS5.p1.16.m14.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.16.m14.1b"><ci id="A6.SS5.p1.16.m14.1.1.cmml" xref="A6.SS5.p1.16.m14.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.16.m14.1c">w</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.16.m14.1d">italic_w</annotation></semantics></math> and <math alttext="N" class="ltx_Math" display="inline" id="A6.SS5.p1.17.m15.1"><semantics id="A6.SS5.p1.17.m15.1a"><mi id="A6.SS5.p1.17.m15.1.1" xref="A6.SS5.p1.17.m15.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A6.SS5.p1.17.m15.1b"><ci id="A6.SS5.p1.17.m15.1.1.cmml" xref="A6.SS5.p1.17.m15.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS5.p1.17.m15.1c">N</annotation><annotation encoding="application/x-llamapun" id="A6.SS5.p1.17.m15.1d">italic_N</annotation></semantics></math> are explored in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#S6.SS4" title="6.4 Hyperparameter Sensitivity ‣ 6 Experimental Results ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">6.4</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="A6.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.6 </span>Hyper-parameter Sensitivity</h3>
<section class="ltx_paragraph" id="A6.SS6.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Exploration and Exploitation</h4>
<div class="ltx_para" id="A6.SS6.SSS0.Px1.p1">
<p class="ltx_p" id="A6.SS6.SSS0.Px1.p1.4">The exploration factor <math alttext="w" class="ltx_Math" display="inline" id="A6.SS6.SSS0.Px1.p1.1.m1.1"><semantics id="A6.SS6.SSS0.Px1.p1.1.m1.1a"><mi id="A6.SS6.SSS0.Px1.p1.1.m1.1.1" xref="A6.SS6.SSS0.Px1.p1.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A6.SS6.SSS0.Px1.p1.1.m1.1b"><ci id="A6.SS6.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A6.SS6.SSS0.Px1.p1.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS6.SSS0.Px1.p1.1.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="A6.SS6.SSS0.Px1.p1.1.m1.1d">italic_w</annotation></semantics></math> controls the balance between exploration and exploitation. To study its impact, we set <math alttext="w" class="ltx_Math" display="inline" id="A6.SS6.SSS0.Px1.p1.2.m2.1"><semantics id="A6.SS6.SSS0.Px1.p1.2.m2.1a"><mi id="A6.SS6.SSS0.Px1.p1.2.m2.1.1" xref="A6.SS6.SSS0.Px1.p1.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A6.SS6.SSS0.Px1.p1.2.m2.1b"><ci id="A6.SS6.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A6.SS6.SSS0.Px1.p1.2.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS6.SSS0.Px1.p1.2.m2.1c">w</annotation><annotation encoding="application/x-llamapun" id="A6.SS6.SSS0.Px1.p1.2.m2.1d">italic_w</annotation></semantics></math> from 0.0 (exploitation only) to 5.0 (mostly favours exploration) and plot the success rate in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.F1" title="Figure A1 ‣ F.4 Details of Baseline Methods ‣ Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">A1</span></a>. We find that the performance remains stable and satisfactory with high exploration, but drops with only exploitation. This is probably because our conversational search tree has a very small search space (<math alttext="\mathtt{ask}" class="ltx_Math" display="inline" id="A6.SS6.SSS0.Px1.p1.3.m3.1"><semantics id="A6.SS6.SSS0.Px1.p1.3.m3.1a"><mi id="A6.SS6.SSS0.Px1.p1.3.m3.1.1" xref="A6.SS6.SSS0.Px1.p1.3.m3.1.1.cmml">𝚊𝚜𝚔</mi><annotation-xml encoding="MathML-Content" id="A6.SS6.SSS0.Px1.p1.3.m3.1b"><ci id="A6.SS6.SSS0.Px1.p1.3.m3.1.1.cmml" xref="A6.SS6.SSS0.Px1.p1.3.m3.1.1">𝚊𝚜𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS6.SSS0.Px1.p1.3.m3.1c">\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="A6.SS6.SSS0.Px1.p1.3.m3.1d">typewriter_ask</annotation></semantics></math> and <math alttext="\mathtt{rec}" class="ltx_Math" display="inline" id="A6.SS6.SSS0.Px1.p1.4.m4.1"><semantics id="A6.SS6.SSS0.Px1.p1.4.m4.1a"><mi id="A6.SS6.SSS0.Px1.p1.4.m4.1.1" xref="A6.SS6.SSS0.Px1.p1.4.m4.1.1.cmml">𝚛𝚎𝚌</mi><annotation-xml encoding="MathML-Content" id="A6.SS6.SSS0.Px1.p1.4.m4.1b"><ci id="A6.SS6.SSS0.Px1.p1.4.m4.1.1.cmml" xref="A6.SS6.SSS0.Px1.p1.4.m4.1.1">𝚛𝚎𝚌</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS6.SSS0.Px1.p1.4.m4.1c">\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="A6.SS6.SSS0.Px1.p1.4.m4.1d">typewriter_rec</annotation></semantics></math>), so high exploration does not incur much cost and also ensures thorough evaluation of different action strategies, while high exploitation may prevent the conversational search tree from discovering the optimal action strategy and lead to myopic conversational planning.</p>
</div>
</section>
<section class="ltx_paragraph" id="A6.SS6.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Influence of MCTS rollouts</h4>
<div class="ltx_para" id="A6.SS6.SSS0.Px2.p1">
<p class="ltx_p" id="A6.SS6.SSS0.Px2.p1.3">To study the influence of MCTS rollouts, we set <math alttext="N" class="ltx_Math" display="inline" id="A6.SS6.SSS0.Px2.p1.1.m1.1"><semantics id="A6.SS6.SSS0.Px2.p1.1.m1.1a"><mi id="A6.SS6.SSS0.Px2.p1.1.m1.1.1" xref="A6.SS6.SSS0.Px2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A6.SS6.SSS0.Px2.p1.1.m1.1b"><ci id="A6.SS6.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A6.SS6.SSS0.Px2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS6.SSS0.Px2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A6.SS6.SSS0.Px2.p1.1.m1.1d">italic_N</annotation></semantics></math> from 1 (equivalent to disabling MCTS, as there is no selection and reward back-propagation when <math alttext="N=1" class="ltx_Math" display="inline" id="A6.SS6.SSS0.Px2.p1.2.m2.1"><semantics id="A6.SS6.SSS0.Px2.p1.2.m2.1a"><mrow id="A6.SS6.SSS0.Px2.p1.2.m2.1.1" xref="A6.SS6.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="A6.SS6.SSS0.Px2.p1.2.m2.1.1.2" xref="A6.SS6.SSS0.Px2.p1.2.m2.1.1.2.cmml">N</mi><mo id="A6.SS6.SSS0.Px2.p1.2.m2.1.1.1" xref="A6.SS6.SSS0.Px2.p1.2.m2.1.1.1.cmml">=</mo><mn id="A6.SS6.SSS0.Px2.p1.2.m2.1.1.3" xref="A6.SS6.SSS0.Px2.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.SS6.SSS0.Px2.p1.2.m2.1b"><apply id="A6.SS6.SSS0.Px2.p1.2.m2.1.1.cmml" xref="A6.SS6.SSS0.Px2.p1.2.m2.1.1"><eq id="A6.SS6.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="A6.SS6.SSS0.Px2.p1.2.m2.1.1.1"></eq><ci id="A6.SS6.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="A6.SS6.SSS0.Px2.p1.2.m2.1.1.2">𝑁</ci><cn id="A6.SS6.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="A6.SS6.SSS0.Px2.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS6.SSS0.Px2.p1.2.m2.1c">N=1</annotation><annotation encoding="application/x-llamapun" id="A6.SS6.SSS0.Px2.p1.2.m2.1d">italic_N = 1</annotation></semantics></math>) from 50 and plot the success rate and training time (on a single Tesla V100 GPU) in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.F2" title="Figure A2 ‣ F.4 Details of Baseline Methods ‣ Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">A2</span></a>. Unsurprisingly, we find that more rollouts increases the chance of discovering the optimal trajectory and lead to better performance, while disabling MCTS shows the worst performance. Nevertheless, we should also note that more rollouts bring additional computational cost, and setting <math alttext="N=20" class="ltx_Math" display="inline" id="A6.SS6.SSS0.Px2.p1.3.m3.1"><semantics id="A6.SS6.SSS0.Px2.p1.3.m3.1a"><mrow id="A6.SS6.SSS0.Px2.p1.3.m3.1.1" xref="A6.SS6.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="A6.SS6.SSS0.Px2.p1.3.m3.1.1.2" xref="A6.SS6.SSS0.Px2.p1.3.m3.1.1.2.cmml">N</mi><mo id="A6.SS6.SSS0.Px2.p1.3.m3.1.1.1" xref="A6.SS6.SSS0.Px2.p1.3.m3.1.1.1.cmml">=</mo><mn id="A6.SS6.SSS0.Px2.p1.3.m3.1.1.3" xref="A6.SS6.SSS0.Px2.p1.3.m3.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.SS6.SSS0.Px2.p1.3.m3.1b"><apply id="A6.SS6.SSS0.Px2.p1.3.m3.1.1.cmml" xref="A6.SS6.SSS0.Px2.p1.3.m3.1.1"><eq id="A6.SS6.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="A6.SS6.SSS0.Px2.p1.3.m3.1.1.1"></eq><ci id="A6.SS6.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="A6.SS6.SSS0.Px2.p1.3.m3.1.1.2">𝑁</ci><cn id="A6.SS6.SSS0.Px2.p1.3.m3.1.1.3.cmml" type="integer" xref="A6.SS6.SSS0.Px2.p1.3.m3.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS6.SSS0.Px2.p1.3.m3.1c">N=20</annotation><annotation encoding="application/x-llamapun" id="A6.SS6.SSS0.Px2.p1.3.m3.1d">italic_N = 20</annotation></semantics></math> can achieve a good trade-off between efficiency and performance.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="A6.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.7 </span>Additional Analysis on Action Strategies</h3>
<figure class="ltx_figure" id="A6.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="342" id="A6.F3.sf1.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Yelp</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="342" id="A6.F3.sf2.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>LastFM</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="342" id="A6.F3.sf3.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Amazon-Book</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F3.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="342" id="A6.F3.sf4.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(d) </span>MovieLens</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure A3: </span>Common action strategies identified on four datasets. <span class="ltx_text" id="A6.F3.13.1" style="color:#0D3C9B;">A</span> stands for <math alttext="\mathtt{ask}" class="ltx_Math" display="inline" id="A6.F3.6.m1.1"><semantics id="A6.F3.6.m1.1b"><mi id="A6.F3.6.m1.1.1" xref="A6.F3.6.m1.1.1.cmml">𝚊𝚜𝚔</mi><annotation-xml encoding="MathML-Content" id="A6.F3.6.m1.1c"><ci id="A6.F3.6.m1.1.1.cmml" xref="A6.F3.6.m1.1.1">𝚊𝚜𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.F3.6.m1.1d">\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="A6.F3.6.m1.1e">typewriter_ask</annotation></semantics></math> while <span class="ltx_text" id="A6.F3.14.2" style="color:#A24A0E;">R</span> stands for <math alttext="\mathtt{rec}" class="ltx_Math" display="inline" id="A6.F3.7.m2.1"><semantics id="A6.F3.7.m2.1b"><mi id="A6.F3.7.m2.1.1" xref="A6.F3.7.m2.1.1.cmml">𝚛𝚎𝚌</mi><annotation-xml encoding="MathML-Content" id="A6.F3.7.m2.1c"><ci id="A6.F3.7.m2.1.1.cmml" xref="A6.F3.7.m2.1.1">𝚛𝚎𝚌</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.F3.7.m2.1d">\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="A6.F3.7.m2.1e">typewriter_rec</annotation></semantics></math>. The probability of <math alttext="\mathtt{ask}" class="ltx_Math" display="inline" id="A6.F3.8.m3.1"><semantics id="A6.F3.8.m3.1b"><mi id="A6.F3.8.m3.1.1" xref="A6.F3.8.m3.1.1.cmml">𝚊𝚜𝚔</mi><annotation-xml encoding="MathML-Content" id="A6.F3.8.m3.1c"><ci id="A6.F3.8.m3.1.1.cmml" xref="A6.F3.8.m3.1.1">𝚊𝚜𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.F3.8.m3.1d">\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="A6.F3.8.m3.1e">typewriter_ask</annotation></semantics></math> or <math alttext="\mathtt{rec}" class="ltx_Math" display="inline" id="A6.F3.9.m4.1"><semantics id="A6.F3.9.m4.1b"><mi id="A6.F3.9.m4.1.1" xref="A6.F3.9.m4.1.1.cmml">𝚛𝚎𝚌</mi><annotation-xml encoding="MathML-Content" id="A6.F3.9.m4.1c"><ci id="A6.F3.9.m4.1.1.cmml" xref="A6.F3.9.m4.1.1">𝚛𝚎𝚌</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.F3.9.m4.1d">\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="A6.F3.9.m4.1e">typewriter_rec</annotation></semantics></math> at each node and the frequency (measured by # of an action strategy<math alttext="/" class="ltx_Math" display="inline" id="A6.F3.10.m5.1"><semantics id="A6.F3.10.m5.1b"><mo id="A6.F3.10.m5.1.1" xref="A6.F3.10.m5.1.1.cmml">/</mo><annotation-xml encoding="MathML-Content" id="A6.F3.10.m5.1c"><divide id="A6.F3.10.m5.1.1.cmml" xref="A6.F3.10.m5.1.1"></divide></annotation-xml><annotation encoding="application/x-tex" id="A6.F3.10.m5.1d">/</annotation><annotation encoding="application/x-llamapun" id="A6.F3.10.m5.1e">/</annotation></semantics></math># of test users in this dataset) of each action strategy are also shown in the figure. The solid circle denotes the action type that is more likely to be selected, and the shadowed circle denotes the action type that is less likely to be selected.</figcaption>
</figure>
<div class="ltx_para" id="A6.SS7.p1">
<p class="ltx_p" id="A6.SS7.p1.2">To gain an insight into the strategic planning capability of <span class="ltx_ERROR undefined" id="A6.SS7.p1.2.1">\method</span>, we identify some typical action strategies of <span class="ltx_ERROR undefined" id="A6.SS7.p1.2.2">\method</span>in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.F3" title="Figure A3 ‣ F.7 Additional Analysis on Action Strategies ‣ Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">A3</span></a> that are helpful for information seeking and recommendation success in the conversation. We denote <span class="ltx_text ltx_font_bold" id="A6.SS7.p1.2.3" style="color:#0D3C9B;">A</span> as the action type <math alttext="\mathtt{ask}" class="ltx_Math" display="inline" id="A6.SS7.p1.1.m1.1"><semantics id="A6.SS7.p1.1.m1.1a"><mi id="A6.SS7.p1.1.m1.1.1" xref="A6.SS7.p1.1.m1.1.1.cmml">𝚊𝚜𝚔</mi><annotation-xml encoding="MathML-Content" id="A6.SS7.p1.1.m1.1b"><ci id="A6.SS7.p1.1.m1.1.1.cmml" xref="A6.SS7.p1.1.m1.1.1">𝚊𝚜𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS7.p1.1.m1.1c">\mathtt{ask}</annotation><annotation encoding="application/x-llamapun" id="A6.SS7.p1.1.m1.1d">typewriter_ask</annotation></semantics></math>, <span class="ltx_text ltx_font_bold" id="A6.SS7.p1.2.4" style="color:#A24A0E;">R</span> as the action type <math alttext="\mathtt{rec}" class="ltx_Math" display="inline" id="A6.SS7.p1.2.m2.1"><semantics id="A6.SS7.p1.2.m2.1a"><mi id="A6.SS7.p1.2.m2.1.1" xref="A6.SS7.p1.2.m2.1.1.cmml">𝚛𝚎𝚌</mi><annotation-xml encoding="MathML-Content" id="A6.SS7.p1.2.m2.1b"><ci id="A6.SS7.p1.2.m2.1.1.cmml" xref="A6.SS7.p1.2.m2.1.1">𝚛𝚎𝚌</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS7.p1.2.m2.1c">\mathtt{rec}</annotation><annotation encoding="application/x-llamapun" id="A6.SS7.p1.2.m2.1d">typewriter_rec</annotation></semantics></math>, <span class="ltx_text ltx_font_bold" id="A6.SS7.p1.2.5">…</span> as the continuation of the conversation, <span class="ltx_text ltx_font_bold" id="A6.SS7.p1.2.6">&lt;end&gt;</span> as the success of the conversation, and we find the following common action strategies:</p>
<ul class="ltx_itemize" id="A6.I3">
<li class="ltx_item" id="A6.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I3.i1.p1">
<p class="ltx_p" id="A6.I3.i1.p1.3"><span class="ltx_text ltx_font_bold" id="A6.I3.i1.p1.3.4">…<span class="ltx_text" id="A6.I3.i1.p1.3.4.1" style="color:#0D3C9B;">A<span class="ltx_text" id="A6.I3.i1.p1.3.4.1.1">A<span class="ltx_text" id="A6.I3.i1.p1.3.4.1.1.1" style="color:#A24A0E;">R<span class="ltx_text" id="A6.I3.i1.p1.3.4.1.1.1.1">R</span></span></span></span>…</span>: This action strategy occurs frequently during the conversation. <span class="ltx_text" id="A6.I3.i1.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.I3.i1.p1.1.1.m1.1"><semantics id="A6.I3.i1.p1.1.1.m1.1a"><mrow id="A6.I3.i1.p1.1.1.m1.1.1" xref="A6.I3.i1.p1.1.1.m1.1.1.cmml"><mi id="A6.I3.i1.p1.1.1.m1.1.1.2" xref="A6.I3.i1.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="A6.I3.i1.p1.1.1.m1.1.1.1" xref="A6.I3.i1.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="A6.I3.i1.p1.1.1.m1.1.1.3" xref="A6.I3.i1.p1.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.I3.i1.p1.1.1.m1.1b"><apply id="A6.I3.i1.p1.1.1.m1.1.1.cmml" xref="A6.I3.i1.p1.1.1.m1.1.1"><times id="A6.I3.i1.p1.1.1.m1.1.1.1.cmml" xref="A6.I3.i1.p1.1.1.m1.1.1.1"></times><ci id="A6.I3.i1.p1.1.1.m1.1.1.2.cmml" xref="A6.I3.i1.p1.1.1.m1.1.1.2">𝚂</ci><ci id="A6.I3.i1.p1.1.1.m1.1.1.3a.cmml" xref="A6.I3.i1.p1.1.1.m1.1.1.3"><mtext id="A6.I3.i1.p1.1.1.m1.1.1.3.cmml" xref="A6.I3.i1.p1.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.I3.i1.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.I3.i1.p1.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> first asks the user two questions consecutively to gather crucial information on user preference, and then quickly narrows down the candidate item list by making two targeted recommendation attempts. This strategy is highly effective because it allows the <span class="ltx_text" id="A6.I3.i1.p1.2.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.I3.i1.p1.2.2.m1.1"><semantics id="A6.I3.i1.p1.2.2.m1.1a"><mrow id="A6.I3.i1.p1.2.2.m1.1.1" xref="A6.I3.i1.p1.2.2.m1.1.1.cmml"><mi id="A6.I3.i1.p1.2.2.m1.1.1.2" xref="A6.I3.i1.p1.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="A6.I3.i1.p1.2.2.m1.1.1.1" xref="A6.I3.i1.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="A6.I3.i1.p1.2.2.m1.1.1.3" xref="A6.I3.i1.p1.2.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.I3.i1.p1.2.2.m1.1b"><apply id="A6.I3.i1.p1.2.2.m1.1.1.cmml" xref="A6.I3.i1.p1.2.2.m1.1.1"><times id="A6.I3.i1.p1.2.2.m1.1.1.1.cmml" xref="A6.I3.i1.p1.2.2.m1.1.1.1"></times><ci id="A6.I3.i1.p1.2.2.m1.1.1.2.cmml" xref="A6.I3.i1.p1.2.2.m1.1.1.2">𝚂</ci><ci id="A6.I3.i1.p1.2.2.m1.1.1.3a.cmml" xref="A6.I3.i1.p1.2.2.m1.1.1.3"><mtext id="A6.I3.i1.p1.2.2.m1.1.1.3.cmml" xref="A6.I3.i1.p1.2.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.I3.i1.p1.2.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.I3.i1.p1.2.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> to tailor its recommendations to the user’s preferences based on the key information obtained from the two questions. Furthermore, based on the user’s feedback from the two recommendation attempts, <span class="ltx_text" id="A6.I3.i1.p1.3.3"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.I3.i1.p1.3.3.m1.1"><semantics id="A6.I3.i1.p1.3.3.m1.1a"><mrow id="A6.I3.i1.p1.3.3.m1.1.1" xref="A6.I3.i1.p1.3.3.m1.1.1.cmml"><mi id="A6.I3.i1.p1.3.3.m1.1.1.2" xref="A6.I3.i1.p1.3.3.m1.1.1.2.cmml">𝚂</mi><mo id="A6.I3.i1.p1.3.3.m1.1.1.1" xref="A6.I3.i1.p1.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="A6.I3.i1.p1.3.3.m1.1.1.3" xref="A6.I3.i1.p1.3.3.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.I3.i1.p1.3.3.m1.1b"><apply id="A6.I3.i1.p1.3.3.m1.1.1.cmml" xref="A6.I3.i1.p1.3.3.m1.1.1"><times id="A6.I3.i1.p1.3.3.m1.1.1.1.cmml" xref="A6.I3.i1.p1.3.3.m1.1.1.1"></times><ci id="A6.I3.i1.p1.3.3.m1.1.1.2.cmml" xref="A6.I3.i1.p1.3.3.m1.1.1.2">𝚂</ci><ci id="A6.I3.i1.p1.3.3.m1.1.1.3a.cmml" xref="A6.I3.i1.p1.3.3.m1.1.1.3"><mtext id="A6.I3.i1.p1.3.3.m1.1.1.3.cmml" xref="A6.I3.i1.p1.3.3.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.I3.i1.p1.3.3.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.I3.i1.p1.3.3.m1.1d">typewriter_S -agent</annotation></semantics></math></span> can promptly reflect upon its action strategy and make necessary adjustments to its assessment of the user’s interests, thereby improving the recommendation success rate for future turns.</p>
</div>
</li>
<li class="ltx_item" id="A6.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I3.i2.p1">
<p class="ltx_p" id="A6.I3.i2.p1.3"><span class="ltx_text ltx_font_bold" id="A6.I3.i2.p1.3.4">…<span class="ltx_text" id="A6.I3.i2.p1.3.4.1" style="color:#A24A0E;">R<span class="ltx_text" id="A6.I3.i2.p1.3.4.1.1" style="color:#0D3C9B;">A<span class="ltx_text" id="A6.I3.i2.p1.3.4.1.1.1">A<span class="ltx_text" id="A6.I3.i2.p1.3.4.1.1.1.1" style="color:#A24A0E;">R</span></span></span></span>…</span> and <span class="ltx_text ltx_font_bold" id="A6.I3.i2.p1.3.5">…<span class="ltx_text" id="A6.I3.i2.p1.3.5.1" style="color:#A24A0E;">R<span class="ltx_text" id="A6.I3.i2.p1.3.5.1.1" style="color:#0D3C9B;">A<span class="ltx_text" id="A6.I3.i2.p1.3.5.1.1.1" style="color:#A24A0E;">R</span></span></span>…</span>: These are also two frequent action strategies during the conversation. In cases where an initial recommendation attempt fails, <span class="ltx_text" id="A6.I3.i2.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.I3.i2.p1.1.1.m1.1"><semantics id="A6.I3.i2.p1.1.1.m1.1a"><mrow id="A6.I3.i2.p1.1.1.m1.1.1" xref="A6.I3.i2.p1.1.1.m1.1.1.cmml"><mi id="A6.I3.i2.p1.1.1.m1.1.1.2" xref="A6.I3.i2.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="A6.I3.i2.p1.1.1.m1.1.1.1" xref="A6.I3.i2.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="A6.I3.i2.p1.1.1.m1.1.1.3" xref="A6.I3.i2.p1.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.I3.i2.p1.1.1.m1.1b"><apply id="A6.I3.i2.p1.1.1.m1.1.1.cmml" xref="A6.I3.i2.p1.1.1.m1.1.1"><times id="A6.I3.i2.p1.1.1.m1.1.1.1.cmml" xref="A6.I3.i2.p1.1.1.m1.1.1.1"></times><ci id="A6.I3.i2.p1.1.1.m1.1.1.2.cmml" xref="A6.I3.i2.p1.1.1.m1.1.1.2">𝚂</ci><ci id="A6.I3.i2.p1.1.1.m1.1.1.3a.cmml" xref="A6.I3.i2.p1.1.1.m1.1.1.3"><mtext id="A6.I3.i2.p1.1.1.m1.1.1.3.cmml" xref="A6.I3.i2.p1.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.I3.i2.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.I3.i2.p1.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> will adeptly adjust the action strategy by asking one or two additional questions to better understand the user’s preference, ensuring that subsequent recommendations are more aligned with the user’s needs. Interestingly, we find that on the LastFM dataset, <span class="ltx_text" id="A6.I3.i2.p1.2.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.I3.i2.p1.2.2.m1.1"><semantics id="A6.I3.i2.p1.2.2.m1.1a"><mrow id="A6.I3.i2.p1.2.2.m1.1.1" xref="A6.I3.i2.p1.2.2.m1.1.1.cmml"><mi id="A6.I3.i2.p1.2.2.m1.1.1.2" xref="A6.I3.i2.p1.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="A6.I3.i2.p1.2.2.m1.1.1.1" xref="A6.I3.i2.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="A6.I3.i2.p1.2.2.m1.1.1.3" xref="A6.I3.i2.p1.2.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.I3.i2.p1.2.2.m1.1b"><apply id="A6.I3.i2.p1.2.2.m1.1.1.cmml" xref="A6.I3.i2.p1.2.2.m1.1.1"><times id="A6.I3.i2.p1.2.2.m1.1.1.1.cmml" xref="A6.I3.i2.p1.2.2.m1.1.1.1"></times><ci id="A6.I3.i2.p1.2.2.m1.1.1.2.cmml" xref="A6.I3.i2.p1.2.2.m1.1.1.2">𝚂</ci><ci id="A6.I3.i2.p1.2.2.m1.1.1.3a.cmml" xref="A6.I3.i2.p1.2.2.m1.1.1.3"><mtext id="A6.I3.i2.p1.2.2.m1.1.1.3.cmml" xref="A6.I3.i2.p1.2.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.I3.i2.p1.2.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.I3.i2.p1.2.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> tends to ask two additional questions, while on the other datasets, <span class="ltx_text" id="A6.I3.i2.p1.3.3"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.I3.i2.p1.3.3.m1.1"><semantics id="A6.I3.i2.p1.3.3.m1.1a"><mrow id="A6.I3.i2.p1.3.3.m1.1.1" xref="A6.I3.i2.p1.3.3.m1.1.1.cmml"><mi id="A6.I3.i2.p1.3.3.m1.1.1.2" xref="A6.I3.i2.p1.3.3.m1.1.1.2.cmml">𝚂</mi><mo id="A6.I3.i2.p1.3.3.m1.1.1.1" xref="A6.I3.i2.p1.3.3.m1.1.1.1.cmml">⁢</mo><mtext id="A6.I3.i2.p1.3.3.m1.1.1.3" xref="A6.I3.i2.p1.3.3.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.I3.i2.p1.3.3.m1.1b"><apply id="A6.I3.i2.p1.3.3.m1.1.1.cmml" xref="A6.I3.i2.p1.3.3.m1.1.1"><times id="A6.I3.i2.p1.3.3.m1.1.1.1.cmml" xref="A6.I3.i2.p1.3.3.m1.1.1.1"></times><ci id="A6.I3.i2.p1.3.3.m1.1.1.2.cmml" xref="A6.I3.i2.p1.3.3.m1.1.1.2">𝚂</ci><ci id="A6.I3.i2.p1.3.3.m1.1.1.3a.cmml" xref="A6.I3.i2.p1.3.3.m1.1.1.3"><mtext id="A6.I3.i2.p1.3.3.m1.1.1.3.cmml" xref="A6.I3.i2.p1.3.3.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.I3.i2.p1.3.3.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.I3.i2.p1.3.3.m1.1d">typewriter_S -agent</annotation></semantics></math></span> typically asks only one additional question. This is probably because the LastFM dataset has a very large number of attribute values, so two additional questions are required to fully clarify the user’s preference.</p>
</div>
</li>
<li class="ltx_item" id="A6.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A6.I3.i3.p1">
<p class="ltx_p" id="A6.I3.i3.p1.2"><span class="ltx_text ltx_font_bold" id="A6.I3.i3.p1.2.3">…<span class="ltx_text" id="A6.I3.i3.p1.2.3.1" style="color:#0D3C9B;">A<span class="ltx_text" id="A6.I3.i3.p1.2.3.1.1" style="color:#A24A0E;">R<span class="ltx_text" id="A6.I3.i3.p1.2.3.1.1.1">R</span></span></span>&lt;end&gt;</span> and <span class="ltx_text ltx_font_bold" id="A6.I3.i3.p1.2.4">…<span class="ltx_text" id="A6.I3.i3.p1.2.4.1" style="color:#0D3C98;">A<span class="ltx_text" id="A6.I3.i3.p1.2.4.1.1">A<span class="ltx_text" id="A6.I3.i3.p1.2.4.1.1.1" style="color:#A24A0E;">R</span></span></span>&lt;end&gt;</span>: These two strategies occur frequently at the end of the conversation. Once <span class="ltx_text" id="A6.I3.i3.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.I3.i3.p1.1.1.m1.1"><semantics id="A6.I3.i3.p1.1.1.m1.1a"><mrow id="A6.I3.i3.p1.1.1.m1.1.1" xref="A6.I3.i3.p1.1.1.m1.1.1.cmml"><mi id="A6.I3.i3.p1.1.1.m1.1.1.2" xref="A6.I3.i3.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="A6.I3.i3.p1.1.1.m1.1.1.1" xref="A6.I3.i3.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="A6.I3.i3.p1.1.1.m1.1.1.3" xref="A6.I3.i3.p1.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.I3.i3.p1.1.1.m1.1b"><apply id="A6.I3.i3.p1.1.1.m1.1.1.cmml" xref="A6.I3.i3.p1.1.1.m1.1.1"><times id="A6.I3.i3.p1.1.1.m1.1.1.1.cmml" xref="A6.I3.i3.p1.1.1.m1.1.1.1"></times><ci id="A6.I3.i3.p1.1.1.m1.1.1.2.cmml" xref="A6.I3.i3.p1.1.1.m1.1.1.2">𝚂</ci><ci id="A6.I3.i3.p1.1.1.m1.1.1.3a.cmml" xref="A6.I3.i3.p1.1.1.m1.1.1.3"><mtext id="A6.I3.i3.p1.1.1.m1.1.1.3.cmml" xref="A6.I3.i3.p1.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.I3.i3.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.I3.i3.p1.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> has gathered sufficient information about the user’s preferences, it is able to reach successful recommendation with only one or two attempts. This strategy enables <span class="ltx_text" id="A6.I3.i3.p1.2.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.I3.i3.p1.2.2.m1.1"><semantics id="A6.I3.i3.p1.2.2.m1.1a"><mrow id="A6.I3.i3.p1.2.2.m1.1.1" xref="A6.I3.i3.p1.2.2.m1.1.1.cmml"><mi id="A6.I3.i3.p1.2.2.m1.1.1.2" xref="A6.I3.i3.p1.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="A6.I3.i3.p1.2.2.m1.1.1.1" xref="A6.I3.i3.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="A6.I3.i3.p1.2.2.m1.1.1.3" xref="A6.I3.i3.p1.2.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.I3.i3.p1.2.2.m1.1b"><apply id="A6.I3.i3.p1.2.2.m1.1.1.cmml" xref="A6.I3.i3.p1.2.2.m1.1.1"><times id="A6.I3.i3.p1.2.2.m1.1.1.1.cmml" xref="A6.I3.i3.p1.2.2.m1.1.1.1"></times><ci id="A6.I3.i3.p1.2.2.m1.1.1.2.cmml" xref="A6.I3.i3.p1.2.2.m1.1.1.2">𝚂</ci><ci id="A6.I3.i3.p1.2.2.m1.1.1.3a.cmml" xref="A6.I3.i3.p1.2.2.m1.1.1.3"><mtext id="A6.I3.i3.p1.2.2.m1.1.1.3.cmml" xref="A6.I3.i3.p1.2.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.I3.i3.p1.2.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.I3.i3.p1.2.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> to swiftly hit the target item, thereby shortening the conversation and reducing repeated recommendations.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="A6.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.8 </span>Case Study</h3>
<figure class="ltx_figure" id="A6.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="522" id="A6.F4.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure A4: </span>A case study of a user looking for a nightlife venue from the Yelp dataset.</figcaption>
</figure>
<div class="ltx_para" id="A6.SS8.p1">
<p class="ltx_p" id="A6.SS8.p1.2">We provide a case study on a randomly sampled user in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#A6.F4" title="Figure A4 ‣ F.8 Case Study ‣ Appendix F Experimental Details ‣ \method: Mastering Multi-turn Conversational Recommendation with Strategic Planning and Monte Carlo Tree Search"><span class="ltx_text ltx_ref_tag">A4</span></a> to demonstrate how <span class="ltx_ERROR undefined" id="A6.SS8.p1.2.3">\method</span>achieves strategic conversational planning.
The user, who has visited some Thai restaurants before, is now looking for a nightlife venue in this conversation.
<span class="ltx_ERROR undefined" id="A6.SS8.p1.2.4">\method</span>quickly grasps user preference by asking only three questions, and makes a successful recommendation on the first attempt. By comparison, HutCRS can also make successful recommendations but requires more questions and recommendation attempts, while MCMIPL repeatedly makes failed recommendations.
Owing to the global information graph encoder, <span class="ltx_text" id="A6.SS8.p1.1.1"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.SS8.p1.1.1.m1.1"><semantics id="A6.SS8.p1.1.1.m1.1a"><mrow id="A6.SS8.p1.1.1.m1.1.1" xref="A6.SS8.p1.1.1.m1.1.1.cmml"><mi id="A6.SS8.p1.1.1.m1.1.1.2" xref="A6.SS8.p1.1.1.m1.1.1.2.cmml">𝚂</mi><mo id="A6.SS8.p1.1.1.m1.1.1.1" xref="A6.SS8.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="A6.SS8.p1.1.1.m1.1.1.3" xref="A6.SS8.p1.1.1.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.SS8.p1.1.1.m1.1b"><apply id="A6.SS8.p1.1.1.m1.1.1.cmml" xref="A6.SS8.p1.1.1.m1.1.1"><times id="A6.SS8.p1.1.1.m1.1.1.1.cmml" xref="A6.SS8.p1.1.1.m1.1.1.1"></times><ci id="A6.SS8.p1.1.1.m1.1.1.2.cmml" xref="A6.SS8.p1.1.1.m1.1.1.2">𝚂</ci><ci id="A6.SS8.p1.1.1.m1.1.1.3a.cmml" xref="A6.SS8.p1.1.1.m1.1.1.3"><mtext id="A6.SS8.p1.1.1.m1.1.1.3.cmml" xref="A6.SS8.p1.1.1.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS8.p1.1.1.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.SS8.p1.1.1.m1.1d">typewriter_S -agent</annotation></semantics></math></span> can infer user preferences from historical visits (e.g, the user’s preference on Thai food) without the need for explicitly queries, thus reducing conversational turns and improving the comprehension of user preferences.
Moreover, the progression from broad questions (e.g., place type) to specific questions (e.g., nightlife type) exemplifies how <span class="ltx_ERROR undefined" id="A6.SS8.p1.2.5">\method</span>strategically plans conversations and asks information-seeking questions, with the policy network focusing on conversation strategy planning and the Q-network specializing in precise estimation of the attribute values.
This design helps <span class="ltx_text" id="A6.SS8.p1.2.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.SS8.p1.2.2.m1.1"><semantics id="A6.SS8.p1.2.2.m1.1a"><mrow id="A6.SS8.p1.2.2.m1.1.1" xref="A6.SS8.p1.2.2.m1.1.1.cmml"><mi id="A6.SS8.p1.2.2.m1.1.1.2" xref="A6.SS8.p1.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="A6.SS8.p1.2.2.m1.1.1.1" xref="A6.SS8.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="A6.SS8.p1.2.2.m1.1.1.3" xref="A6.SS8.p1.2.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.SS8.p1.2.2.m1.1b"><apply id="A6.SS8.p1.2.2.m1.1.1.cmml" xref="A6.SS8.p1.2.2.m1.1.1"><times id="A6.SS8.p1.2.2.m1.1.1.1.cmml" xref="A6.SS8.p1.2.2.m1.1.1.1"></times><ci id="A6.SS8.p1.2.2.m1.1.1.2.cmml" xref="A6.SS8.p1.2.2.m1.1.1.2">𝚂</ci><ci id="A6.SS8.p1.2.2.m1.1.1.3a.cmml" xref="A6.SS8.p1.2.2.m1.1.1.3"><mtext id="A6.SS8.p1.2.2.m1.1.1.3.cmml" xref="A6.SS8.p1.2.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS8.p1.2.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.SS8.p1.2.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> to quickly narrow down candidate items and improve the recommendation success rate.</p>
</div>
</section>
<section class="ltx_subsection" id="A6.SS9">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.9 </span>Additional Analysis on Efficiency</h3>
<div class="ltx_para" id="A6.SS9.p1">
<p class="ltx_p" id="A6.SS9.p1.2">Although training <span class="ltx_ERROR undefined" id="A6.SS9.p1.2.3">\method</span>requires conducting multiple simulated rollouts for each user, we find that such design will not significantly compromise efficiency compared with the baseline CRS methods.
Under the same training pipeline with a single Tesla V100 GPU, <span class="ltx_ERROR undefined" id="A6.SS9.p1.2.4">\method</span>with 20 rollouts per user takes 698 seconds per 100 gradient descent steps on the LastFM dataset and 1049 seconds per 100 gradient descent steps on the Amazon-Book dataset on average, which is about twice as slow as the two competitive baselines (HutCRS: 305 seconds/100 steps on LastFM, 465 seconds/100 steps on Amazon-Book; MCMIPL: 429 seconds/100 steps on LastFM, 548 seconds/100 steps on Amazon-Book).
This is because the simulation process only requires forward calculation without the need for gradient backward update, so even conducting 20 rollouts per user will only reduce the training speed by half.
Moreover, <span class="ltx_text" id="A6.SS9.p1.1.1"><math alttext="\mathop{\mathtt{SAPIENT\text{-e}}}\limits" class="ltx_Math" display="inline" id="A6.SS9.p1.1.1.m1.1"><semantics id="A6.SS9.p1.1.1.m1.1a"><mrow id="A6.SS9.p1.1.1.m1.1.1" xref="A6.SS9.p1.1.1.m1.1.1.cmml"><mi id="A6.SS9.p1.1.1.m1.1.1.2" xref="A6.SS9.p1.1.1.m1.1.1.2.cmml">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</mi><mo id="A6.SS9.p1.1.1.m1.1.1.1" xref="A6.SS9.p1.1.1.m1.1.1.1.cmml">⁢</mo><mtext id="A6.SS9.p1.1.1.m1.1.1.3" xref="A6.SS9.p1.1.1.m1.1.1.3a.cmml">-e</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.SS9.p1.1.1.m1.1b"><apply id="A6.SS9.p1.1.1.m1.1.1.cmml" xref="A6.SS9.p1.1.1.m1.1.1"><times id="A6.SS9.p1.1.1.m1.1.1.1.cmml" xref="A6.SS9.p1.1.1.m1.1.1.1"></times><ci id="A6.SS9.p1.1.1.m1.1.1.2.cmml" xref="A6.SS9.p1.1.1.m1.1.1.2">𝚂𝙰𝙿𝙸𝙴𝙽𝚃</ci><ci id="A6.SS9.p1.1.1.m1.1.1.3a.cmml" xref="A6.SS9.p1.1.1.m1.1.1.3"><mtext id="A6.SS9.p1.1.1.m1.1.1.3.cmml" xref="A6.SS9.p1.1.1.m1.1.1.3">-e</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS9.p1.1.1.m1.1c">\mathop{\mathtt{SAPIENT\text{-e}}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.SS9.p1.1.1.m1.1d">typewriter_SAPIENT -e</annotation></semantics></math></span> takes 397 seconds per 100 gradient descent steps on the LastFM dataset and 593 seconds per 100 gradient descent steps on the Amazon-Book dataset on average, which is highly comparable to baselines.
Furthermore, we note that during inference, the efficiency of <span class="ltx_ERROR undefined" id="A6.SS9.p1.2.5">\method</span>is comparable with baseline methods, because no tree search is required during inference, and the number of parameters for <span class="ltx_text" id="A6.SS9.p1.2.2"><math alttext="\mathop{\mathtt{S}\text{-agent}}\limits" class="ltx_Math" display="inline" id="A6.SS9.p1.2.2.m1.1"><semantics id="A6.SS9.p1.2.2.m1.1a"><mrow id="A6.SS9.p1.2.2.m1.1.1" xref="A6.SS9.p1.2.2.m1.1.1.cmml"><mi id="A6.SS9.p1.2.2.m1.1.1.2" xref="A6.SS9.p1.2.2.m1.1.1.2.cmml">𝚂</mi><mo id="A6.SS9.p1.2.2.m1.1.1.1" xref="A6.SS9.p1.2.2.m1.1.1.1.cmml">⁢</mo><mtext id="A6.SS9.p1.2.2.m1.1.1.3" xref="A6.SS9.p1.2.2.m1.1.1.3a.cmml">-agent</mtext></mrow><annotation-xml encoding="MathML-Content" id="A6.SS9.p1.2.2.m1.1b"><apply id="A6.SS9.p1.2.2.m1.1.1.cmml" xref="A6.SS9.p1.2.2.m1.1.1"><times id="A6.SS9.p1.2.2.m1.1.1.1.cmml" xref="A6.SS9.p1.2.2.m1.1.1.1"></times><ci id="A6.SS9.p1.2.2.m1.1.1.2.cmml" xref="A6.SS9.p1.2.2.m1.1.1.2">𝚂</ci><ci id="A6.SS9.p1.2.2.m1.1.1.3a.cmml" xref="A6.SS9.p1.2.2.m1.1.1.3"><mtext id="A6.SS9.p1.2.2.m1.1.1.3.cmml" xref="A6.SS9.p1.2.2.m1.1.1.3">-agent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS9.p1.2.2.m1.1c">\mathop{\mathtt{S}\text{-agent}}\limits</annotation><annotation encoding="application/x-llamapun" id="A6.SS9.p1.2.2.m1.1d">typewriter_S -agent</annotation></semantics></math></span> (1.30M on Yelp, 3.30M on LastFM, 2.65M on Amazon-Book, 6.48M on MovieLens) is also budget-friendly.
For these reasons, we think that it is worthwhile to introduce conversational tree search for CRS, because such design only slightly compromises efficiency during training, and the training efficiency can also be improved by adopting parallel acceleration methods for MCTS <cite class="ltx_cite ltx_citemacro_cite">Chaslot et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09580v1#bib.bib6" title="">2008</a>)</cite>.</p>
</div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Oct 12 16:19:25 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
