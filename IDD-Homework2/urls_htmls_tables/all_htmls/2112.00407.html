<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2112.00407] Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data</title><meta property="og:description" content="Federated Learning is a widely adopted method to train neural networks over distributed data. One main limitation is the performance degradation that occurs when data is heterogeneously distributed.
While many works ha…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2112.00407">

<!--Generated on Fri Mar  1 16:10:50 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Compare Where It Matters: Using Layer-Wise Regularization To 
<br class="ltx_break">Improve Federated Learning on Heterogeneous Data</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Ha Min Son,<sup id="id1.1.id1" class="ltx_sup">1</sup>
Moon Hyun Kim,<sup id="id2.2.id2" class="ltx_sup">1</sup>
Tai-Myoung Chung,<sup id="id3.3.id3" class="ltx_sup">1</sup>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Federated Learning is a widely adopted method to train neural networks over distributed data. One main limitation is the performance degradation that occurs when data is heterogeneously distributed.
While many works have attempted to address this problem, these methods under-perform because they are founded on a limited understanding of neural networks.
In this work, we verify that only certain important layers in a neural network require regularization for effective training. We additionally verify that Centered Kernel Alignment (CKA) most accurately calculates similarity between layers of neural networks trained on different data. By applying CKA-based regularization to important layers during training, we significantly improve performance in heterogeneous settings.
We present FedCKA: a simple framework that out-performs previous state-of-the-art methods on various deep learning tasks while also improving efficiency and scalability.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">The success of deep learning in a plethora of fields has led to a countless number of research conducted to leverage its strengths <cite class="ltx_cite ltx_citemacro_citep">(Lecun, Bengio, and Hinton <a href="#bib.bib11" title="" class="ltx_ref">2015</a>)</cite>.
One main outcome resulting from this success is the mass collection of data <cite class="ltx_cite ltx_citemacro_citep">(Sejnowski <a href="#bib.bib19" title="" class="ltx_ref">2018</a>)</cite>. As the collection of data increases at a rate much faster than that of the computing performance and storage capacity of consumer products, it is becoming progressively difficult to deploy trained state-of-the-art models within a reasonable budget.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib16" title="" class="ltx_ref">2017</a>)</cite> has been introduced as a method to train a neural network with massively distributed data. The most widely used and accepted approach for the training and aggregation process is FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib16" title="" class="ltx_ref">2017</a>)</cite>. FedAvg is appealing for many reasons, such as negating the cost of collecting data into a centralized location, and effective parallelization across computing units <cite class="ltx_cite ltx_citemacro_citep">(Verbraeken et al. <a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite>. Thus, it has been applied to a wide range of researches, including a distributed learning framework on vehicular networks <cite class="ltx_cite ltx_citemacro_citep">(Samarakoon et al. <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>, IoT devices <cite class="ltx_cite ltx_citemacro_citep">(Yang et al. <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite>, and
even as a privacy-preserving method for medical records <cite class="ltx_cite ltx_citemacro_citep">(Brisimi et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">One major issue with the application of FL is the performance degradation that occurs with heterogeneous data. This refers to settings in which data is not independent and identically distributed (non-IID) across clients. The drop in performance is seen to be caused by a disagreement in local optima. That is, because different clients train its copy of the neural network according to its individual local data, the resulting average can stray from the true optimum. Unfortunately, it is realistic to expect non-IID data in many real-world applications <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al. <a href="#bib.bib7" title="" class="ltx_ref">2021</a>; Hsu, Qi, and Brown <a href="#bib.bib5" title="" class="ltx_ref">2019a</a>)</cite>. In light of this, many works have attempted to address this problem by regularizing the entire model during the training process <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib14" title="" class="ltx_ref">2020</a>; Karimireddy et al. <a href="#bib.bib8" title="" class="ltx_ref">2020</a>; Li, He, and Song <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>. However, we argue that these works are based on a limited understanding of neural networks.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this work, we present FedCKA to address these limitations.
First, we show that regularizing the first two naturally similar layers are most important to improve performance in non-IID settings. Previous works had regularized each individual layers. Not only is this ineffective for training, it also limits scalability as the number of layers in a model increases.
By regularizing only these important layers, performance improves beyond previous works. Efficiency and scalability is also improved, as we do not need to calculate regularization terms for every layer.
Second, we show that Centered Kernel Alignment (CKA) is most accurate when comparing the representational similarity between layers of neural networks. Previous works added a regularization term by comparing the representation of neural networks with simple inner products such as the l2-distance (FedProx) or cosine similarity (MOON). By using CKA to more accurately compare and regularize local updates, we improve performance; hence the name FedCKA.
Our contributions are summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We improve performance in heterogeneous settings. By building on the most up-to-date understanding of neural networks, we apply layer-wise regularization to only important layers.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We improve the efficiency and scalability of regularization. By regularizing only important layers, we exclusively show training times that are comparable to FedAvg.</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2112.00407/assets/images/fedlearning_steps.jpg" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="524" height="171" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The typical steps of Federated Learning</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Layers in Neural Networks</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Understanding the function of layers in a neural network is an under-researched field of deep learning. It is, however, an important prerequisite for the application of layer-wise regularization. We build our work based on findings of two relevant papers.
</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">The first work <cite class="ltx_cite ltx_citemacro_citep">(Zhang, Bengio, and Singer <a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite> showed that there are certain ’critical’ layers that define a model’s performance. In particular, when layers were re-initialized back to their original weights, ’critical’ layers heavily decreased performance, while ’robust’ layers had minimal impact. This work drew several relevant conclusions. First, the very first layer of neural networks is most sensitive to re-initialization. Second, robustness is not correlated with the l2-norm or l<math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="\infty" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mi mathvariant="normal" id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">∞</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><infinity id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\infty</annotation></semantics></math>-norm between initial weights and trained weights.
Considering these conclusions, we understand that certain layers are not important in defining performance. Regularizing these non-important layers would be ineffective, and may even hurt performance.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">The second work <cite class="ltx_cite ltx_citemacro_citep">(Kornblith et al. <a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite> introduced Centered Kernel Alignment (CKA) as a metric for measuring the similarity between layers of neural networks. In particular, the work showed that metrics that calculate the similarity between representations of neural networks should be invariant to orthogonal transformations and isotropic scaling, while invertible to linear transformations. This work drew one very relevant conclusion. For neural networks trained on different datasets, early layers, but not late layers, learn similar representations.
Considering this conclusion, if we were to properly regularize neural networks trained on different datasets, we should focus on layers that are naturally similar, and not on those that are naturally different.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Federated Learning with Non-IID Data</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Federated Learning typically progresses with the repetition of four steps as shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. 1) a centralized or de-centralized server broadcasts a model (the global model) to each of its clients. 2) Each client trains its copy of the model (the local model) with its local data. 3) The client uploads its trained model to the server. 4) The server aggregates the trained model into a single model and prepares it to be broadcast in the next round. These steps are repeated until convergence or other criteria are met.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Works that improve performance on non-IID data generally falls into two categories. The first focuses on regularizing or modifying the client training process (step 2). The second focuses on modifying the aggregation process (step 4). Here, we focus on the former, as it is more closely related to our work. Namely, we focus on FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite>, SCAFFOLD <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al. <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>, and MOON <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>, all of which add a regularization term to the default FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib16" title="" class="ltx_ref">2017</a>)</cite> training process.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">FedAvg was the first work to introduce Federated Learning. Each client trains a model using a gradient descent loss function, and the server averages the trained model based on the number of data samples each client holds.
However, due to the performance degradation in non-IID settings, many works have added a regularization term to the default FedAvg training process. The objective of these methods is to decrease the disagreement in local optima by limiting local updates that stray too far from the global model.
FedProx adds a proximal regularization term that calculates the l2-distance between the local and global model.
SCAFFOLD adds a control variate regularization term that induces variance reduction on local updates based on the updates of other clients.
Most recent and most similar to our work is MOON. MOON adds a contrastive regularization term that calculates the cosine similarity between the MLP projections of the local and global model. The work takes inspiration from contrastive learning, in particular, SimCLR <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>. The intuition is that the global model is less biased than local models, thus local updates should be more similar to the global model than past local models. One difference to note is that while contrastive learning trains a model using the projections of one model on many different images (i.e. one model, different data), MOON regularizes a model using the projections of different models on the same images (i.e. three models, same data).</p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.1" class="ltx_p">Overall, these works add a regularization term by comparing all layers of the neural network. However, we argue that only important layers should be regularized. Late layers are naturally dissimilar when trained on different datasets. Regularizing a model based on these naturally dissimilar late layers would be ineffective. Rather, it may be beneficial to focus only on the earlier layers of the model.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>FedCKA</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Regularizing Naturally Similar Layers</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">FedCKA is designed on the principle that naturally similar, but not naturally dissimilar, layers should be regularized. This is based on the premise that early layers, but not late layers, develop similar representations when trained on different datasets <cite class="ltx_cite ltx_citemacro_citep">(Kornblith et al. <a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite>. We verify this in a Federated Learning environment. Using a small Convolutional Neural Network, we trained 10 clients for 20 communications rounds on independently and identically distributed (IID) subsets of the CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky <a href="#bib.bib10" title="" class="ltx_ref">2009</a>)</cite> dataset. After training, we viewed the similarity between each layer of the local and global models, calculated by the Centered Kernel Alignment <cite class="ltx_cite ltx_citemacro_citep">(Kornblith et al. <a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite> on the CIFAR-10 test set. The similarity of each layer between local and global models are shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2 Measuring Layer-wise Similarity ‣ 3 FedCKA ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We verify that early layers, but not late layers, develop similar representations even in the most optimal Federated Learning setting, where the distribution across data between clients are IID.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">The objective of regularizing local updates is to penalize updates that stray from the global model. However, late layers are naturally dissimilar even in optimal Federated Learning settings. If this is the case, regularizing these late layers would penalize updates that may have been beneficial to training. Thus, FedCKA regularizes only the first two naturally similar layers. For convolutional neural networks without residual blocks, the first two naturally similar layers are the two layers closest to the input. For ResNets <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a href="#bib.bib4" title="" class="ltx_ref">2016</a>)</cite>, it is the initial convolutional layer and first post-residual block. As also mentioned in <cite class="ltx_cite ltx_citemacro_citet">Kornblith et al. (<a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite>, post-residual layers, but not layers within residuals, develop similar representations. This is unique to previous works, which had regularized local updates based on all layers. This also allows FedCKA to be much more scalable than other methods. The computational overhead for previous works increases rapidly in proportion to the number of parameters, because all layers are regularized. FedCKA keeps the overhead nearly constant, as we regularize only two layers close to the input.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Measuring Layer-wise Similarity</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">FedCKA is designed to regularize dissimilar updates in layers that should naturally be similar.
However, there is currently no standard for measuring the similarity of layers between neural networks. While there are classical methods of applying univariate or multivariate analysis for comparing matrices, these methods are not suitable for comparing the similarity of layers and representations of different neural networks <cite class="ltx_cite ltx_citemacro_citep">(Kornblith et al. <a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite>. As for norms, <cite class="ltx_cite ltx_citemacro_citet">Zhang, Bengio, and Singer (<a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite> concluded that a layer’s robustness to re-initialization is not correlated with the l2-norm or l<math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\infty" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi mathvariant="normal" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">∞</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><infinity id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\infty</annotation></semantics></math>-norm. This suggests that using these norms to regularize dissimilar updates, as in previous works, may be inaccurate.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">Kornblith et al. (<a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite> concluded that similarity metrics for comparing the representation of different neural networks should be invariant to orthogonal transformations and isotropic scaling, while invertible to linear transformation. The work introduced Centered Kernel Alignment (CKA), and showed that the metric is most consistent in measuring the similarity between representation of neural networks. Thus, FedCKA regularizes local updates using the CKA metric as a similarity measure.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2112.00407/assets/images/round20_CKA.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="394" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>CKA similarity comparison between each client and the global model (Refer to <span id="S3.F2.2.1" class="ltx_text ltx_font_italic">Experimental Setup</span> for more information on setup)</figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Modifications to FedAvg</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">FedCKA adds a regularization term to the local training process of the default FedAvg algorithm, keeping the entire framework simple. Alg <a href="#alg1" title="Algorithm 1 ‣ 3.3 Modifications to FedAvg ‣ 3 FedCKA ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and Fig <a href="#S3.F3" title="Figure 3 ‣ 3.3 Modifications to FedAvg ‣ 3 FedCKA ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the FedCKA framework in algorithm and figure form, respectively. More formally, we add <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\ell_{cka}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.3.1" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.3.1a" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.1.3.4" xref="S3.SS3.p1.1.m1.1.1.3.4.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">ℓ</ci><apply id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><times id="S3.SS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3.1"></times><ci id="S3.SS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2">𝑐</ci><ci id="S3.SS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3">𝑘</ci><ci id="S3.SS3.p1.1.m1.1.1.3.4.cmml" xref="S3.SS3.p1.1.m1.1.1.3.4">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\ell_{cka}</annotation></semantics></math> as a regularization term to the FedAvg training algorithm. The local loss function is as shown in Eq <a href="#S3.E1" title="In 3.3 Modifications to FedAvg ‣ 3 FedCKA ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.6" class="ltx_Math" alttext="\ell=\ell_{sup}(w^{t}_{l_{i}};D^{i})+\mu\ell_{cka}(w^{t}_{l_{i}};w^{t}_{g};w^{t-1}_{l_{i}};D^{i})" display="block"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml"><mi mathvariant="normal" id="S3.E1.m1.6.6.8" xref="S3.E1.m1.6.6.8.cmml">ℓ</mi><mo id="S3.E1.m1.6.6.7" xref="S3.E1.m1.6.6.7.cmml">=</mo><mrow id="S3.E1.m1.6.6.6" xref="S3.E1.m1.6.6.6.cmml"><mrow id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml"><msub id="S3.E1.m1.2.2.2.2.4" xref="S3.E1.m1.2.2.2.2.4.cmml"><mi mathvariant="normal" id="S3.E1.m1.2.2.2.2.4.2" xref="S3.E1.m1.2.2.2.2.4.2.cmml">ℓ</mi><mrow id="S3.E1.m1.2.2.2.2.4.3" xref="S3.E1.m1.2.2.2.2.4.3.cmml"><mi id="S3.E1.m1.2.2.2.2.4.3.2" xref="S3.E1.m1.2.2.2.2.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.4.3.1" xref="S3.E1.m1.2.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.4.3.3" xref="S3.E1.m1.2.2.2.2.4.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.4.3.1a" xref="S3.E1.m1.2.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.4.3.4" xref="S3.E1.m1.2.2.2.2.4.3.4.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.3.cmml">(</mo><msubsup id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.2.2.cmml">w</mi><msub id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mi id="S3.E1.m1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.E1.m1.2.2.2.2.2.2.4" xref="S3.E1.m1.2.2.2.2.2.3.cmml">;</mo><msup id="S3.E1.m1.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.2.cmml">D</mi><mi id="S3.E1.m1.2.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E1.m1.2.2.2.2.2.2.5" xref="S3.E1.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.6.7" xref="S3.E1.m1.6.6.6.7.cmml">+</mo><mrow id="S3.E1.m1.6.6.6.6" xref="S3.E1.m1.6.6.6.6.cmml"><mi id="S3.E1.m1.6.6.6.6.6" xref="S3.E1.m1.6.6.6.6.6.cmml">μ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.6.6.5" xref="S3.E1.m1.6.6.6.6.5.cmml">​</mo><msub id="S3.E1.m1.6.6.6.6.7" xref="S3.E1.m1.6.6.6.6.7.cmml"><mi mathvariant="normal" id="S3.E1.m1.6.6.6.6.7.2" xref="S3.E1.m1.6.6.6.6.7.2.cmml">ℓ</mi><mrow id="S3.E1.m1.6.6.6.6.7.3" xref="S3.E1.m1.6.6.6.6.7.3.cmml"><mi id="S3.E1.m1.6.6.6.6.7.3.2" xref="S3.E1.m1.6.6.6.6.7.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.6.6.7.3.1" xref="S3.E1.m1.6.6.6.6.7.3.1.cmml">​</mo><mi id="S3.E1.m1.6.6.6.6.7.3.3" xref="S3.E1.m1.6.6.6.6.7.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.6.6.7.3.1a" xref="S3.E1.m1.6.6.6.6.7.3.1.cmml">​</mo><mi id="S3.E1.m1.6.6.6.6.7.3.4" xref="S3.E1.m1.6.6.6.6.7.3.4.cmml">a</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.6.6.5a" xref="S3.E1.m1.6.6.6.6.5.cmml">​</mo><mrow id="S3.E1.m1.6.6.6.6.4.4" xref="S3.E1.m1.6.6.6.6.4.5.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.6.6.4.4.5" xref="S3.E1.m1.6.6.6.6.4.5.cmml">(</mo><msubsup id="S3.E1.m1.3.3.3.3.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.1.cmml"><mi id="S3.E1.m1.3.3.3.3.1.1.1.2.2" xref="S3.E1.m1.3.3.3.3.1.1.1.2.2.cmml">w</mi><msub id="S3.E1.m1.3.3.3.3.1.1.1.3" xref="S3.E1.m1.3.3.3.3.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.3.3.1.1.1.3.2" xref="S3.E1.m1.3.3.3.3.1.1.1.3.2.cmml">l</mi><mi id="S3.E1.m1.3.3.3.3.1.1.1.3.3" xref="S3.E1.m1.3.3.3.3.1.1.1.3.3.cmml">i</mi></msub><mi id="S3.E1.m1.3.3.3.3.1.1.1.2.3" xref="S3.E1.m1.3.3.3.3.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.E1.m1.6.6.6.6.4.4.6" xref="S3.E1.m1.6.6.6.6.4.5.cmml">;</mo><msubsup id="S3.E1.m1.4.4.4.4.2.2.2" xref="S3.E1.m1.4.4.4.4.2.2.2.cmml"><mi id="S3.E1.m1.4.4.4.4.2.2.2.2.2" xref="S3.E1.m1.4.4.4.4.2.2.2.2.2.cmml">w</mi><mi id="S3.E1.m1.4.4.4.4.2.2.2.3" xref="S3.E1.m1.4.4.4.4.2.2.2.3.cmml">g</mi><mi id="S3.E1.m1.4.4.4.4.2.2.2.2.3" xref="S3.E1.m1.4.4.4.4.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.E1.m1.6.6.6.6.4.4.7" xref="S3.E1.m1.6.6.6.6.4.5.cmml">;</mo><msubsup id="S3.E1.m1.5.5.5.5.3.3.3" xref="S3.E1.m1.5.5.5.5.3.3.3.cmml"><mi id="S3.E1.m1.5.5.5.5.3.3.3.2.2" xref="S3.E1.m1.5.5.5.5.3.3.3.2.2.cmml">w</mi><msub id="S3.E1.m1.5.5.5.5.3.3.3.3" xref="S3.E1.m1.5.5.5.5.3.3.3.3.cmml"><mi id="S3.E1.m1.5.5.5.5.3.3.3.3.2" xref="S3.E1.m1.5.5.5.5.3.3.3.3.2.cmml">l</mi><mi id="S3.E1.m1.5.5.5.5.3.3.3.3.3" xref="S3.E1.m1.5.5.5.5.3.3.3.3.3.cmml">i</mi></msub><mrow id="S3.E1.m1.5.5.5.5.3.3.3.2.3" xref="S3.E1.m1.5.5.5.5.3.3.3.2.3.cmml"><mi id="S3.E1.m1.5.5.5.5.3.3.3.2.3.2" xref="S3.E1.m1.5.5.5.5.3.3.3.2.3.2.cmml">t</mi><mo id="S3.E1.m1.5.5.5.5.3.3.3.2.3.1" xref="S3.E1.m1.5.5.5.5.3.3.3.2.3.1.cmml">−</mo><mn id="S3.E1.m1.5.5.5.5.3.3.3.2.3.3" xref="S3.E1.m1.5.5.5.5.3.3.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E1.m1.6.6.6.6.4.4.8" xref="S3.E1.m1.6.6.6.6.4.5.cmml">;</mo><msup id="S3.E1.m1.6.6.6.6.4.4.4" xref="S3.E1.m1.6.6.6.6.4.4.4.cmml"><mi id="S3.E1.m1.6.6.6.6.4.4.4.2" xref="S3.E1.m1.6.6.6.6.4.4.4.2.cmml">D</mi><mi id="S3.E1.m1.6.6.6.6.4.4.4.3" xref="S3.E1.m1.6.6.6.6.4.4.4.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E1.m1.6.6.6.6.4.4.9" xref="S3.E1.m1.6.6.6.6.4.5.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><eq id="S3.E1.m1.6.6.7.cmml" xref="S3.E1.m1.6.6.7"></eq><ci id="S3.E1.m1.6.6.8.cmml" xref="S3.E1.m1.6.6.8">ℓ</ci><apply id="S3.E1.m1.6.6.6.cmml" xref="S3.E1.m1.6.6.6"><plus id="S3.E1.m1.6.6.6.7.cmml" xref="S3.E1.m1.6.6.6.7"></plus><apply id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2"><times id="S3.E1.m1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.3"></times><apply id="S3.E1.m1.2.2.2.2.4.cmml" xref="S3.E1.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.4.1.cmml" xref="S3.E1.m1.2.2.2.2.4">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.4.2.cmml" xref="S3.E1.m1.2.2.2.2.4.2">ℓ</ci><apply id="S3.E1.m1.2.2.2.2.4.3.cmml" xref="S3.E1.m1.2.2.2.2.4.3"><times id="S3.E1.m1.2.2.2.2.4.3.1.cmml" xref="S3.E1.m1.2.2.2.2.4.3.1"></times><ci id="S3.E1.m1.2.2.2.2.4.3.2.cmml" xref="S3.E1.m1.2.2.2.2.4.3.2">𝑠</ci><ci id="S3.E1.m1.2.2.2.2.4.3.3.cmml" xref="S3.E1.m1.2.2.2.2.4.3.3">𝑢</ci><ci id="S3.E1.m1.2.2.2.2.4.3.4.cmml" xref="S3.E1.m1.2.2.2.2.4.3.4">𝑝</ci></apply></apply><list id="S3.E1.m1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3.2">𝑙</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2.2">𝐷</ci><ci id="S3.E1.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply><apply id="S3.E1.m1.6.6.6.6.cmml" xref="S3.E1.m1.6.6.6.6"><times id="S3.E1.m1.6.6.6.6.5.cmml" xref="S3.E1.m1.6.6.6.6.5"></times><ci id="S3.E1.m1.6.6.6.6.6.cmml" xref="S3.E1.m1.6.6.6.6.6">𝜇</ci><apply id="S3.E1.m1.6.6.6.6.7.cmml" xref="S3.E1.m1.6.6.6.6.7"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.6.7.1.cmml" xref="S3.E1.m1.6.6.6.6.7">subscript</csymbol><ci id="S3.E1.m1.6.6.6.6.7.2.cmml" xref="S3.E1.m1.6.6.6.6.7.2">ℓ</ci><apply id="S3.E1.m1.6.6.6.6.7.3.cmml" xref="S3.E1.m1.6.6.6.6.7.3"><times id="S3.E1.m1.6.6.6.6.7.3.1.cmml" xref="S3.E1.m1.6.6.6.6.7.3.1"></times><ci id="S3.E1.m1.6.6.6.6.7.3.2.cmml" xref="S3.E1.m1.6.6.6.6.7.3.2">𝑐</ci><ci id="S3.E1.m1.6.6.6.6.7.3.3.cmml" xref="S3.E1.m1.6.6.6.6.7.3.3">𝑘</ci><ci id="S3.E1.m1.6.6.6.6.7.3.4.cmml" xref="S3.E1.m1.6.6.6.6.7.3.4">𝑎</ci></apply></apply><list id="S3.E1.m1.6.6.6.6.4.5.cmml" xref="S3.E1.m1.6.6.6.6.4.4"><apply id="S3.E1.m1.3.3.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1">subscript</csymbol><apply id="S3.E1.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1">superscript</csymbol><ci id="S3.E1.m1.3.3.3.3.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.2.2">𝑤</ci><ci id="S3.E1.m1.3.3.3.3.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E1.m1.3.3.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.3.3.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.3.2">𝑙</ci><ci id="S3.E1.m1.3.3.3.3.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.4.4.4.4.2.2.2.cmml" xref="S3.E1.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.4.2.2.2.1.cmml" xref="S3.E1.m1.4.4.4.4.2.2.2">subscript</csymbol><apply id="S3.E1.m1.4.4.4.4.2.2.2.2.cmml" xref="S3.E1.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.4.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.4.4.2.2.2">superscript</csymbol><ci id="S3.E1.m1.4.4.4.4.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.4.4.2.2.2.2.2">𝑤</ci><ci id="S3.E1.m1.4.4.4.4.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.4.4.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E1.m1.4.4.4.4.2.2.2.3.cmml" xref="S3.E1.m1.4.4.4.4.2.2.2.3">𝑔</ci></apply><apply id="S3.E1.m1.5.5.5.5.3.3.3.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.5.3.3.3.1.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3">subscript</csymbol><apply id="S3.E1.m1.5.5.5.5.3.3.3.2.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.5.3.3.3.2.1.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3">superscript</csymbol><ci id="S3.E1.m1.5.5.5.5.3.3.3.2.2.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3.2.2">𝑤</ci><apply id="S3.E1.m1.5.5.5.5.3.3.3.2.3.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3.2.3"><minus id="S3.E1.m1.5.5.5.5.3.3.3.2.3.1.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3.2.3.1"></minus><ci id="S3.E1.m1.5.5.5.5.3.3.3.2.3.2.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.5.5.5.5.3.3.3.2.3.3.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.5.5.5.5.3.3.3.3.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.5.3.3.3.3.1.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3.3">subscript</csymbol><ci id="S3.E1.m1.5.5.5.5.3.3.3.3.2.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3.3.2">𝑙</ci><ci id="S3.E1.m1.5.5.5.5.3.3.3.3.3.cmml" xref="S3.E1.m1.5.5.5.5.3.3.3.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.6.6.6.6.4.4.4.cmml" xref="S3.E1.m1.6.6.6.6.4.4.4"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.6.4.4.4.1.cmml" xref="S3.E1.m1.6.6.6.6.4.4.4">superscript</csymbol><ci id="S3.E1.m1.6.6.6.6.4.4.4.2.cmml" xref="S3.E1.m1.6.6.6.6.4.4.4.2">𝐷</ci><ci id="S3.E1.m1.6.6.6.6.4.4.4.3.cmml" xref="S3.E1.m1.6.6.6.6.4.4.4.3">𝑖</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">\ell=\ell_{sup}(w^{t}_{l_{i}};D^{i})+\mu\ell_{cka}(w^{t}_{l_{i}};w^{t}_{g};w^{t-1}_{l_{i}};D^{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.5" class="ltx_p">Here, <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\ell_{sup}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.1.3.1" xref="S3.SS3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.1.m1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.1.3.1a" xref="S3.SS3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.1.m1.1.1.3.4" xref="S3.SS3.p2.1.m1.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">ℓ</ci><apply id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><times id="S3.SS3.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3.1"></times><ci id="S3.SS3.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.2">𝑠</ci><ci id="S3.SS3.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3">𝑢</ci><ci id="S3.SS3.p2.1.m1.1.1.3.4.cmml" xref="S3.SS3.p2.1.m1.1.1.3.4">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\ell_{sup}</annotation></semantics></math> is the cross entropy loss, <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mu</annotation></semantics></math> is a hyper-parameter to control the strength of the regularization term, <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\ell_{cka}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.1.1.3.1" xref="S3.SS3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.1.1.3.1a" xref="S3.SS3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.3.m3.1.1.3.4" xref="S3.SS3.p2.3.m3.1.1.3.4.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">ℓ</ci><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><times id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.1"></times><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">𝑐</ci><ci id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3">𝑘</ci><ci id="S3.SS3.p2.3.m3.1.1.3.4.cmml" xref="S3.SS3.p2.3.m3.1.1.3.4">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\ell_{cka}</annotation></semantics></math>, in proportion to <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="\ell_{sup}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.4.m4.1.1.3.1" xref="S3.SS3.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.4.m4.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.4.m4.1.1.3.1a" xref="S3.SS3.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.4.m4.1.1.3.4" xref="S3.SS3.p2.4.m4.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">ℓ</ci><apply id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3"><times id="S3.SS3.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.3.1"></times><ci id="S3.SS3.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.3.2">𝑠</ci><ci id="S3.SS3.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3">𝑢</ci><ci id="S3.SS3.p2.4.m4.1.1.3.4.cmml" xref="S3.SS3.p2.4.m4.1.1.3.4">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\ell_{sup}</annotation></semantics></math>. <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="\ell_{cka}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml"><mi id="S3.SS3.p2.5.m5.1.1.3.2" xref="S3.SS3.p2.5.m5.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.5.m5.1.1.3.1" xref="S3.SS3.p2.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.5.m5.1.1.3.3" xref="S3.SS3.p2.5.m5.1.1.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.5.m5.1.1.3.1a" xref="S3.SS3.p2.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.5.m5.1.1.3.4" xref="S3.SS3.p2.5.m5.1.1.3.4.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">ℓ</ci><apply id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3"><times id="S3.SS3.p2.5.m5.1.1.3.1.cmml" xref="S3.SS3.p2.5.m5.1.1.3.1"></times><ci id="S3.SS3.p2.5.m5.1.1.3.2.cmml" xref="S3.SS3.p2.5.m5.1.1.3.2">𝑐</ci><ci id="S3.SS3.p2.5.m5.1.1.3.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3.3">𝑘</ci><ci id="S3.SS3.p2.5.m5.1.1.3.4.cmml" xref="S3.SS3.p2.5.m5.1.1.3.4">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\ell_{cka}</annotation></semantics></math> is shown in more detail in Eq <a href="#S3.E2" title="In 3.3 Modifications to FedAvg ‣ 3 FedCKA ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.14" class="ltx_p">The formula of <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\ell_{cka}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml"><mi id="S3.SS3.p3.1.m1.1.1.3.2" xref="S3.SS3.p3.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.1.1.3.1" xref="S3.SS3.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.1.m1.1.1.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.1.1.3.1a" xref="S3.SS3.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.1.m1.1.1.3.4" xref="S3.SS3.p3.1.m1.1.1.3.4.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">ℓ</ci><apply id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3"><times id="S3.SS3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3.1"></times><ci id="S3.SS3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2">𝑐</ci><ci id="S3.SS3.p3.1.m1.1.1.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3">𝑘</ci><ci id="S3.SS3.p3.1.m1.1.1.3.4.cmml" xref="S3.SS3.p3.1.m1.1.1.3.4">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\ell_{cka}</annotation></semantics></math> is a slight modification to the contrastive loss that is used in SimCLR <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>. There are four main differences.
First, SimCLR uses the representations of one model on different samples in a batch to calculate contrastive loss. FedCKA uses the representation of three models on the same samples in a batch to calculate <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="\ell_{cka}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.2" xref="S3.SS3.p3.2.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.1.1.3.1" xref="S3.SS3.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.2.m2.1.1.3.3" xref="S3.SS3.p3.2.m2.1.1.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.1.1.3.1a" xref="S3.SS3.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.2.m2.1.1.3.4" xref="S3.SS3.p3.2.m2.1.1.3.4.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">ℓ</ci><apply id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3"><times id="S3.SS3.p3.2.m2.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1"></times><ci id="S3.SS3.p3.2.m2.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2">𝑐</ci><ci id="S3.SS3.p3.2.m2.1.1.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3">𝑘</ci><ci id="S3.SS3.p3.2.m2.1.1.3.4.cmml" xref="S3.SS3.p3.2.m2.1.1.3.4">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\ell_{cka}</annotation></semantics></math>. <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="a^{t}_{l_{i}}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><msubsup id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2.2" xref="S3.SS3.p3.3.m3.1.1.2.2.cmml">a</mi><msub id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.2" xref="S3.SS3.p3.3.m3.1.1.3.2.cmml">l</mi><mi id="S3.SS3.p3.3.m3.1.1.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.cmml">i</mi></msub><mi id="S3.SS3.p3.3.m3.1.1.2.3" xref="S3.SS3.p3.3.m3.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2.2">𝑎</ci><ci id="S3.SS3.p3.3.m3.1.1.2.3.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3">𝑡</ci></apply><apply id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.2">𝑙</ci><ci id="S3.SS3.p3.3.m3.1.1.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">a^{t}_{l_{i}}</annotation></semantics></math>, <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="a^{t-1}_{l_{i}}" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><msubsup id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2.2" xref="S3.SS3.p3.4.m4.1.1.2.2.cmml">a</mi><msub id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml"><mi id="S3.SS3.p3.4.m4.1.1.3.2" xref="S3.SS3.p3.4.m4.1.1.3.2.cmml">l</mi><mi id="S3.SS3.p3.4.m4.1.1.3.3" xref="S3.SS3.p3.4.m4.1.1.3.3.cmml">i</mi></msub><mrow id="S3.SS3.p3.4.m4.1.1.2.3" xref="S3.SS3.p3.4.m4.1.1.2.3.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2.3.2" xref="S3.SS3.p3.4.m4.1.1.2.3.2.cmml">t</mi><mo id="S3.SS3.p3.4.m4.1.1.2.3.1" xref="S3.SS3.p3.4.m4.1.1.2.3.1.cmml">−</mo><mn id="S3.SS3.p3.4.m4.1.1.2.3.3" xref="S3.SS3.p3.4.m4.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">subscript</csymbol><apply id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.2.1.cmml" xref="S3.SS3.p3.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2.2">𝑎</ci><apply id="S3.SS3.p3.4.m4.1.1.2.3.cmml" xref="S3.SS3.p3.4.m4.1.1.2.3"><minus id="S3.SS3.p3.4.m4.1.1.2.3.1.cmml" xref="S3.SS3.p3.4.m4.1.1.2.3.1"></minus><ci id="S3.SS3.p3.4.m4.1.1.2.3.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p3.4.m4.1.1.2.3.3.cmml" xref="S3.SS3.p3.4.m4.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.3.1.cmml" xref="S3.SS3.p3.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.3.2.cmml" xref="S3.SS3.p3.4.m4.1.1.3.2">𝑙</ci><ci id="S3.SS3.p3.4.m4.1.1.3.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">a^{t-1}_{l_{i}}</annotation></semantics></math>, and <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="a^{t}_{g}" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><msubsup id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2.2" xref="S3.SS3.p3.5.m5.1.1.2.2.cmml">a</mi><mi id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml">g</mi><mi id="S3.SS3.p3.5.m5.1.1.2.3" xref="S3.SS3.p3.5.m5.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">subscript</csymbol><apply id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.2.1.cmml" xref="S3.SS3.p3.5.m5.1.1">superscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.2.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2.2">𝑎</ci><ci id="S3.SS3.p3.5.m5.1.1.2.3.cmml" xref="S3.SS3.p3.5.m5.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p3.5.m5.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">a^{t}_{g}</annotation></semantics></math> are the representations of client <math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><mi id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><ci id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">i</annotation></semantics></math>’s current local model, client <math id="S3.SS3.p3.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p3.7.m7.1a"><mi id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><ci id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">i</annotation></semantics></math>’s previous round local model, and the current global model, respectively.
Second, SimCLR uses the temperature parameter <math id="S3.SS3.p3.8.m8.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS3.p3.8.m8.1a"><mi id="S3.SS3.p3.8.m8.1.1" xref="S3.SS3.p3.8.m8.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.1b"><ci id="S3.SS3.p3.8.m8.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.1c">\tau</annotation></semantics></math> to increase performance on difficult samples. FedCKA excludes <math id="S3.SS3.p3.9.m9.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS3.p3.9.m9.1a"><mi id="S3.SS3.p3.9.m9.1.1" xref="S3.SS3.p3.9.m9.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m9.1b"><ci id="S3.SS3.p3.9.m9.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m9.1c">\tau</annotation></semantics></math>, as it was not seen to help performance.
Third, SimCLR uses cosine similarity to measure the similarity between the representations of difference datasets. FedCKA uses CKA as its measure of similarity.
Fourth, SimCLR calculates contrastive loss once per batch, using the representations of the projection head. FedCKA use calculates <math id="S3.SS3.p3.10.m10.1" class="ltx_Math" alttext="\ell_{cka}" display="inline"><semantics id="S3.SS3.p3.10.m10.1a"><msub id="S3.SS3.p3.10.m10.1.1" xref="S3.SS3.p3.10.m10.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p3.10.m10.1.1.2" xref="S3.SS3.p3.10.m10.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.p3.10.m10.1.1.3" xref="S3.SS3.p3.10.m10.1.1.3.cmml"><mi id="S3.SS3.p3.10.m10.1.1.3.2" xref="S3.SS3.p3.10.m10.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.10.m10.1.1.3.1" xref="S3.SS3.p3.10.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.10.m10.1.1.3.3" xref="S3.SS3.p3.10.m10.1.1.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.10.m10.1.1.3.1a" xref="S3.SS3.p3.10.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.10.m10.1.1.3.4" xref="S3.SS3.p3.10.m10.1.1.3.4.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m10.1b"><apply id="S3.SS3.p3.10.m10.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m10.1.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p3.10.m10.1.1.2.cmml" xref="S3.SS3.p3.10.m10.1.1.2">ℓ</ci><apply id="S3.SS3.p3.10.m10.1.1.3.cmml" xref="S3.SS3.p3.10.m10.1.1.3"><times id="S3.SS3.p3.10.m10.1.1.3.1.cmml" xref="S3.SS3.p3.10.m10.1.1.3.1"></times><ci id="S3.SS3.p3.10.m10.1.1.3.2.cmml" xref="S3.SS3.p3.10.m10.1.1.3.2">𝑐</ci><ci id="S3.SS3.p3.10.m10.1.1.3.3.cmml" xref="S3.SS3.p3.10.m10.1.1.3.3">𝑘</ci><ci id="S3.SS3.p3.10.m10.1.1.3.4.cmml" xref="S3.SS3.p3.10.m10.1.1.3.4">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m10.1c">\ell_{cka}</annotation></semantics></math> <math id="S3.SS3.p3.11.m11.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.p3.11.m11.1a"><mi id="S3.SS3.p3.11.m11.1.1" xref="S3.SS3.p3.11.m11.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m11.1b"><ci id="S3.SS3.p3.11.m11.1.1.cmml" xref="S3.SS3.p3.11.m11.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.11.m11.1c">M</annotation></semantics></math> times per batch, using the representations of the first <math id="S3.SS3.p3.12.m12.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.p3.12.m12.1a"><mi id="S3.SS3.p3.12.m12.1.1" xref="S3.SS3.p3.12.m12.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.12.m12.1b"><ci id="S3.SS3.p3.12.m12.1.1.cmml" xref="S3.SS3.p3.12.m12.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.12.m12.1c">M</annotation></semantics></math> naturally similar layers, indexed by <math id="S3.SS3.p3.13.m13.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS3.p3.13.m13.1a"><mi id="S3.SS3.p3.13.m13.1.1" xref="S3.SS3.p3.13.m13.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.13.m13.1b"><ci id="S3.SS3.p3.13.m13.1.1.cmml" xref="S3.SS3.p3.13.m13.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.13.m13.1c">n</annotation></semantics></math>, and averages the loss based on the number of layers to regularize. <math id="S3.SS3.p3.14.m14.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.p3.14.m14.1a"><mi id="S3.SS3.p3.14.m14.1.1" xref="S3.SS3.p3.14.m14.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.14.m14.1b"><ci id="S3.SS3.p3.14.m14.1.1.cmml" xref="S3.SS3.p3.14.m14.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.14.m14.1c">M</annotation></semantics></math> is set to two by default unless otherwise stated.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2112.00407/assets/images/training.jpg" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="538" height="520" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Training Process of FedCKA</figcaption>
</figure>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.5.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FedCKA</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.3" class="ltx_p ltx_figure_panel"><span id="alg1.3.1" class="ltx_text ltx_font_bold">Input</span>: number of communication rounds R, number of clients C, number of local epochs E, loss weighting variable <math id="alg1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">\mu</annotation></semantics></math>, learning rate <math id="alg1.2.m2.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.2.m2.1a"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">\eta</annotation></semantics></math> 
<br class="ltx_break"><span id="alg1.3.2" class="ltx_text ltx_font_bold">Output</span>: The trained model <math id="alg1.3.m3.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.3.m3.1a"><mi id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">w</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.6" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  Initialize <math id="alg1.l1.m1.1" class="ltx_Math" alttext="w^{0}_{g}" display="inline"><semantics id="alg1.l1.m1.1a"><msubsup id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2.2" xref="alg1.l1.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">g</mi><mn id="alg1.l1.m1.1.1.2.3" xref="alg1.l1.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><apply id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1">superscript</csymbol><ci id="alg1.l1.m1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.2.2">𝑤</ci><cn type="integer" id="alg1.l1.m1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.2.3">0</cn></apply><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">w^{0}_{g}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">for</span> each round <math id="alg1.l2.m1.2" class="ltx_Math" alttext="r\ \in\ [0,R-1]" display="inline"><semantics id="alg1.l2.m1.2a"><mrow id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml"><mi id="alg1.l2.m1.2.2.3" xref="alg1.l2.m1.2.2.3.cmml">r</mi><mo lspace="0.778em" rspace="0.778em" id="alg1.l2.m1.2.2.2" xref="alg1.l2.m1.2.2.2.cmml">∈</mo><mrow id="alg1.l2.m1.2.2.1.1" xref="alg1.l2.m1.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l2.m1.2.2.1.1.2" xref="alg1.l2.m1.2.2.1.2.cmml">[</mo><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">0</mn><mo id="alg1.l2.m1.2.2.1.1.3" xref="alg1.l2.m1.2.2.1.2.cmml">,</mo><mrow id="alg1.l2.m1.2.2.1.1.1" xref="alg1.l2.m1.2.2.1.1.1.cmml"><mi id="alg1.l2.m1.2.2.1.1.1.2" xref="alg1.l2.m1.2.2.1.1.1.2.cmml">R</mi><mo id="alg1.l2.m1.2.2.1.1.1.1" xref="alg1.l2.m1.2.2.1.1.1.1.cmml">−</mo><mn id="alg1.l2.m1.2.2.1.1.1.3" xref="alg1.l2.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l2.m1.2.2.1.1.4" xref="alg1.l2.m1.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><apply id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2"><in id="alg1.l2.m1.2.2.2.cmml" xref="alg1.l2.m1.2.2.2"></in><ci id="alg1.l2.m1.2.2.3.cmml" xref="alg1.l2.m1.2.2.3">𝑟</ci><interval closure="closed" id="alg1.l2.m1.2.2.1.2.cmml" xref="alg1.l2.m1.2.2.1.1"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">0</cn><apply id="alg1.l2.m1.2.2.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1.1"><minus id="alg1.l2.m1.2.2.1.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1.1.1"></minus><ci id="alg1.l2.m1.2.2.1.1.1.2.cmml" xref="alg1.l2.m1.2.2.1.1.1.2">𝑅</ci><cn type="integer" id="alg1.l2.m1.2.2.1.1.1.3.cmml" xref="alg1.l2.m1.2.2.1.1.1.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">r\ \in\ [0,R-1]</annotation></semantics></math> <span id="alg1.l2.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l3.m1.2" class="ltx_Math" alttext="i\ \in\ [0,C]" display="inline"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.3" xref="alg1.l3.m1.2.3.cmml"><mi id="alg1.l3.m1.2.3.2" xref="alg1.l3.m1.2.3.2.cmml">i</mi><mo lspace="0.778em" rspace="0.778em" id="alg1.l3.m1.2.3.1" xref="alg1.l3.m1.2.3.1.cmml">∈</mo><mrow id="alg1.l3.m1.2.3.3.2" xref="alg1.l3.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l3.m1.2.3.3.2.1" xref="alg1.l3.m1.2.3.3.1.cmml">[</mo><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">0</mn><mo id="alg1.l3.m1.2.3.3.2.2" xref="alg1.l3.m1.2.3.3.1.cmml">,</mo><mi id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">C</mi><mo stretchy="false" id="alg1.l3.m1.2.3.3.2.3" xref="alg1.l3.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.3.cmml" xref="alg1.l3.m1.2.3"><in id="alg1.l3.m1.2.3.1.cmml" xref="alg1.l3.m1.2.3.1"></in><ci id="alg1.l3.m1.2.3.2.cmml" xref="alg1.l3.m1.2.3.2">𝑖</ci><interval closure="closed" id="alg1.l3.m1.2.3.3.1.cmml" xref="alg1.l3.m1.2.3.3.2"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">0</cn><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">𝐶</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">i\ \in\ [0,C]</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>        <math id="alg1.l4.m1.1" class="ltx_Math" alttext="w^{t}_{l_{i}}\leftarrow" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msubsup id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2.2" xref="alg1.l4.m1.1.1.2.2.2.cmml">w</mi><msub id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml"><mi id="alg1.l4.m1.1.1.2.3.2" xref="alg1.l4.m1.1.1.2.3.2.cmml">l</mi><mi id="alg1.l4.m1.1.1.2.3.3" xref="alg1.l4.m1.1.1.2.3.3.cmml">i</mi></msub><mi id="alg1.l4.m1.1.1.2.2.3" xref="alg1.l4.m1.1.1.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">←</mo><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">←</ci><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2">subscript</csymbol><apply id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.2.1.cmml" xref="alg1.l4.m1.1.1.2">superscript</csymbol><ci id="alg1.l4.m1.1.1.2.2.2.cmml" xref="alg1.l4.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l4.m1.1.1.2.2.3.cmml" xref="alg1.l4.m1.1.1.2.2.3">𝑡</ci></apply><apply id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.3.1.cmml" xref="alg1.l4.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.3.2.cmml" xref="alg1.l4.m1.1.1.2.3.2">𝑙</ci><ci id="alg1.l4.m1.1.1.2.3.3.cmml" xref="alg1.l4.m1.1.1.2.3.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">w^{t}_{l_{i}}\leftarrow</annotation></semantics></math> LocalUpdate(<math id="alg1.l4.m2.1" class="ltx_Math" alttext="w^{t}_{g}" display="inline"><semantics id="alg1.l4.m2.1a"><msubsup id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><mi id="alg1.l4.m2.1.1.2.2" xref="alg1.l4.m2.1.1.2.2.cmml">w</mi><mi id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml">g</mi><mi id="alg1.l4.m2.1.1.2.3" xref="alg1.l4.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1">subscript</csymbol><apply id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.2.1.cmml" xref="alg1.l4.m2.1.1">superscript</csymbol><ci id="alg1.l4.m2.1.1.2.2.cmml" xref="alg1.l4.m2.1.1.2.2">𝑤</ci><ci id="alg1.l4.m2.1.1.2.3.cmml" xref="alg1.l4.m2.1.1.2.3">𝑡</ci></apply><ci id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">w^{t}_{g}</annotation></semantics></math>)

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <span id="alg1.l5.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math id="alg1.l6.m1.1" class="ltx_math_unparsed" alttext="W^{t}_{l}\leftarrow[w^{t}_{l_{0}}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1b"><msubsup id="alg1.l6.m1.1.1"><mi id="alg1.l6.m1.1.1.2.2">W</mi><mi id="alg1.l6.m1.1.1.3">l</mi><mi id="alg1.l6.m1.1.1.2.3">t</mi></msubsup><mo stretchy="false" id="alg1.l6.m1.1.2">←</mo><mrow id="alg1.l6.m1.1.3"><mo stretchy="false" id="alg1.l6.m1.1.3.1">[</mo><msubsup id="alg1.l6.m1.1.3.2"><mi id="alg1.l6.m1.1.3.2.2.2">w</mi><msub id="alg1.l6.m1.1.3.2.3"><mi id="alg1.l6.m1.1.3.2.3.2">l</mi><mn id="alg1.l6.m1.1.3.2.3.3">0</mn></msub><mi id="alg1.l6.m1.1.3.2.2.3">t</mi></msubsup></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">W^{t}_{l}\leftarrow[w^{t}_{l_{0}}</annotation></semantics></math>, <math id="alg1.l6.m2.1" class="ltx_Math" alttext="w^{t}_{l_{1}}" display="inline"><semantics id="alg1.l6.m2.1a"><msubsup id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2.2" xref="alg1.l6.m2.1.1.2.2.cmml">w</mi><msub id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml"><mi id="alg1.l6.m2.1.1.3.2" xref="alg1.l6.m2.1.1.3.2.cmml">l</mi><mn id="alg1.l6.m2.1.1.3.3" xref="alg1.l6.m2.1.1.3.3.cmml">1</mn></msub><mi id="alg1.l6.m2.1.1.2.3" xref="alg1.l6.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">subscript</csymbol><apply id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.2.1.cmml" xref="alg1.l6.m2.1.1">superscript</csymbol><ci id="alg1.l6.m2.1.1.2.2.cmml" xref="alg1.l6.m2.1.1.2.2">𝑤</ci><ci id="alg1.l6.m2.1.1.2.3.cmml" xref="alg1.l6.m2.1.1.2.3">𝑡</ci></apply><apply id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.3.1.cmml" xref="alg1.l6.m2.1.1.3">subscript</csymbol><ci id="alg1.l6.m2.1.1.3.2.cmml" xref="alg1.l6.m2.1.1.3.2">𝑙</ci><cn type="integer" id="alg1.l6.m2.1.1.3.3.cmml" xref="alg1.l6.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">w^{t}_{l_{1}}</annotation></semantics></math>, … , <math id="alg1.l6.m3.1" class="ltx_math_unparsed" alttext="w^{t}_{l_{C-1}}]" display="inline"><semantics id="alg1.l6.m3.1a"><mrow id="alg1.l6.m3.1b"><msubsup id="alg1.l6.m3.1.1"><mi id="alg1.l6.m3.1.1.2.2">w</mi><msub id="alg1.l6.m3.1.1.3"><mi id="alg1.l6.m3.1.1.3.2">l</mi><mrow id="alg1.l6.m3.1.1.3.3"><mi id="alg1.l6.m3.1.1.3.3.2">C</mi><mo id="alg1.l6.m3.1.1.3.3.1">−</mo><mn id="alg1.l6.m3.1.1.3.3.3">1</mn></mrow></msub><mi id="alg1.l6.m3.1.1.2.3">t</mi></msubsup><mo stretchy="false" id="alg1.l6.m3.1.2">]</mo></mrow><annotation encoding="application/x-tex" id="alg1.l6.m3.1c">w^{t}_{l_{C-1}}]</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math id="alg1.l7.m1.1" class="ltx_Math" alttext="w^{t}_{g}\leftarrow" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msubsup id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2.2" xref="alg1.l7.m1.1.1.2.2.2.cmml">w</mi><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">g</mi><mi id="alg1.l7.m1.1.1.2.2.3" xref="alg1.l7.m1.1.1.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><apply id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.2.1.cmml" xref="alg1.l7.m1.1.1.2">superscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.2.cmml" xref="alg1.l7.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l7.m1.1.1.2.2.3.cmml" xref="alg1.l7.m1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑔</ci></apply><csymbol cd="latexml" id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">w^{t}_{g}\leftarrow</annotation></semantics></math> WeightedAvg(<math id="alg1.l7.m2.1" class="ltx_Math" alttext="W^{t}_{l}" display="inline"><semantics id="alg1.l7.m2.1a"><msubsup id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml"><mi id="alg1.l7.m2.1.1.2.2" xref="alg1.l7.m2.1.1.2.2.cmml">W</mi><mi id="alg1.l7.m2.1.1.3" xref="alg1.l7.m2.1.1.3.cmml">l</mi><mi id="alg1.l7.m2.1.1.2.3" xref="alg1.l7.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.1.cmml" xref="alg1.l7.m2.1.1">subscript</csymbol><apply id="alg1.l7.m2.1.1.2.cmml" xref="alg1.l7.m2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.2.1.cmml" xref="alg1.l7.m2.1.1">superscript</csymbol><ci id="alg1.l7.m2.1.1.2.2.cmml" xref="alg1.l7.m2.1.1.2.2">𝑊</ci><ci id="alg1.l7.m2.1.1.2.3.cmml" xref="alg1.l7.m2.1.1.2.3">𝑡</ci></apply><ci id="alg1.l7.m2.1.1.3.cmml" xref="alg1.l7.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">W^{t}_{l}</annotation></semantics></math>)

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>  <span id="alg1.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>  <span id="alg1.l9.1" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l9.m1.1" class="ltx_Math" alttext="w^{t}_{g}" display="inline"><semantics id="alg1.l9.m1.1a"><msubsup id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">g</mi><mi id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1">superscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑤</ci><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">w^{t}_{g}</annotation></semantics></math>  
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>  <span id="alg1.l10.1" class="ltx_text ltx_font_bold">LocalUpdate</span>(<math id="alg1.l10.m1.1" class="ltx_Math" alttext="w^{t}_{g}" display="inline"><semantics id="alg1.l10.m1.1a"><msubsup id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">g</mi><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1">superscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝑤</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">w^{t}_{g}</annotation></semantics></math>):

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>  <math id="alg1.l11.m1.1" class="ltx_Math" alttext="w^{t}_{l_{i}}\leftarrow w^{t}_{g}" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><msubsup id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml"><mi id="alg1.l11.m1.1.1.2.2.2" xref="alg1.l11.m1.1.1.2.2.2.cmml">w</mi><msub id="alg1.l11.m1.1.1.2.3" xref="alg1.l11.m1.1.1.2.3.cmml"><mi id="alg1.l11.m1.1.1.2.3.2" xref="alg1.l11.m1.1.1.2.3.2.cmml">l</mi><mi id="alg1.l11.m1.1.1.2.3.3" xref="alg1.l11.m1.1.1.2.3.3.cmml">i</mi></msub><mi id="alg1.l11.m1.1.1.2.2.3" xref="alg1.l11.m1.1.1.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">←</mo><msubsup id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.3.2.2" xref="alg1.l11.m1.1.1.3.2.2.cmml">w</mi><mi id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">g</mi><mi id="alg1.l11.m1.1.1.3.2.3" xref="alg1.l11.m1.1.1.3.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">←</ci><apply id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.2">subscript</csymbol><apply id="alg1.l11.m1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.2.1.cmml" xref="alg1.l11.m1.1.1.2">superscript</csymbol><ci id="alg1.l11.m1.1.1.2.2.2.cmml" xref="alg1.l11.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l11.m1.1.1.2.2.3.cmml" xref="alg1.l11.m1.1.1.2.2.3">𝑡</ci></apply><apply id="alg1.l11.m1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.3.1.cmml" xref="alg1.l11.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.3.2.cmml" xref="alg1.l11.m1.1.1.2.3.2">𝑙</ci><ci id="alg1.l11.m1.1.1.2.3.3.cmml" xref="alg1.l11.m1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3">subscript</csymbol><apply id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.2.1.cmml" xref="alg1.l11.m1.1.1.3">superscript</csymbol><ci id="alg1.l11.m1.1.1.3.2.2.cmml" xref="alg1.l11.m1.1.1.3.2.2">𝑤</ci><ci id="alg1.l11.m1.1.1.3.2.3.cmml" xref="alg1.l11.m1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">w^{t}_{l_{i}}\leftarrow w^{t}_{g}</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>  <span id="alg1.l12.1" class="ltx_text ltx_font_bold">for</span> each epoch <math id="alg1.l12.m1.2" class="ltx_Math" alttext="e\ \in\ [0,E-1]" display="inline"><semantics id="alg1.l12.m1.2a"><mrow id="alg1.l12.m1.2.2" xref="alg1.l12.m1.2.2.cmml"><mi id="alg1.l12.m1.2.2.3" xref="alg1.l12.m1.2.2.3.cmml">e</mi><mo lspace="0.778em" rspace="0.778em" id="alg1.l12.m1.2.2.2" xref="alg1.l12.m1.2.2.2.cmml">∈</mo><mrow id="alg1.l12.m1.2.2.1.1" xref="alg1.l12.m1.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l12.m1.2.2.1.1.2" xref="alg1.l12.m1.2.2.1.2.cmml">[</mo><mn id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">0</mn><mo id="alg1.l12.m1.2.2.1.1.3" xref="alg1.l12.m1.2.2.1.2.cmml">,</mo><mrow id="alg1.l12.m1.2.2.1.1.1" xref="alg1.l12.m1.2.2.1.1.1.cmml"><mi id="alg1.l12.m1.2.2.1.1.1.2" xref="alg1.l12.m1.2.2.1.1.1.2.cmml">E</mi><mo id="alg1.l12.m1.2.2.1.1.1.1" xref="alg1.l12.m1.2.2.1.1.1.1.cmml">−</mo><mn id="alg1.l12.m1.2.2.1.1.1.3" xref="alg1.l12.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l12.m1.2.2.1.1.4" xref="alg1.l12.m1.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.2b"><apply id="alg1.l12.m1.2.2.cmml" xref="alg1.l12.m1.2.2"><in id="alg1.l12.m1.2.2.2.cmml" xref="alg1.l12.m1.2.2.2"></in><ci id="alg1.l12.m1.2.2.3.cmml" xref="alg1.l12.m1.2.2.3">𝑒</ci><interval closure="closed" id="alg1.l12.m1.2.2.1.2.cmml" xref="alg1.l12.m1.2.2.1.1"><cn type="integer" id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">0</cn><apply id="alg1.l12.m1.2.2.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1"><minus id="alg1.l12.m1.2.2.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1"></minus><ci id="alg1.l12.m1.2.2.1.1.1.2.cmml" xref="alg1.l12.m1.2.2.1.1.1.2">𝐸</ci><cn type="integer" id="alg1.l12.m1.2.2.1.1.1.3.cmml" xref="alg1.l12.m1.2.2.1.1.1.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.2c">e\ \in\ [0,E-1]</annotation></semantics></math> <span id="alg1.l12.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span id="alg1.l13.1" class="ltx_text ltx_font_bold">for</span> each batch <math id="alg1.l13.m1.1" class="ltx_Math" alttext="b\ \in\ D^{i}" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">b</mi><mo lspace="0.778em" rspace="0.778em" id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">∈</mo><msup id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">D</mi><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">i</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><in id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></in><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">𝑏</ci><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3">superscript</csymbol><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">𝐷</ci><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">b\ \in\ D^{i}</annotation></semantics></math> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>        <math id="alg1.l14.m1.2" class="ltx_Math" alttext="\ell_{sup}\leftarrow CrossEntropyLoss(w^{t}_{l_{i}};b)" display="inline"><semantics id="alg1.l14.m1.2a"><mrow id="alg1.l14.m1.2.2" xref="alg1.l14.m1.2.2.cmml"><msub id="alg1.l14.m1.2.2.3" xref="alg1.l14.m1.2.2.3.cmml"><mi mathvariant="normal" id="alg1.l14.m1.2.2.3.2" xref="alg1.l14.m1.2.2.3.2.cmml">ℓ</mi><mrow id="alg1.l14.m1.2.2.3.3" xref="alg1.l14.m1.2.2.3.3.cmml"><mi id="alg1.l14.m1.2.2.3.3.2" xref="alg1.l14.m1.2.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.3.3.1" xref="alg1.l14.m1.2.2.3.3.1.cmml">​</mo><mi id="alg1.l14.m1.2.2.3.3.3" xref="alg1.l14.m1.2.2.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.3.3.1a" xref="alg1.l14.m1.2.2.3.3.1.cmml">​</mo><mi id="alg1.l14.m1.2.2.3.3.4" xref="alg1.l14.m1.2.2.3.3.4.cmml">p</mi></mrow></msub><mo stretchy="false" id="alg1.l14.m1.2.2.2" xref="alg1.l14.m1.2.2.2.cmml">←</mo><mrow id="alg1.l14.m1.2.2.1" xref="alg1.l14.m1.2.2.1.cmml"><mi id="alg1.l14.m1.2.2.1.3" xref="alg1.l14.m1.2.2.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.4" xref="alg1.l14.m1.2.2.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2a" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.5" xref="alg1.l14.m1.2.2.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2b" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.6" xref="alg1.l14.m1.2.2.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2c" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.7" xref="alg1.l14.m1.2.2.1.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2d" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.8" xref="alg1.l14.m1.2.2.1.8.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2e" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.9" xref="alg1.l14.m1.2.2.1.9.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2f" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.10" xref="alg1.l14.m1.2.2.1.10.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2g" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.11" xref="alg1.l14.m1.2.2.1.11.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2h" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.12" xref="alg1.l14.m1.2.2.1.12.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2i" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.13" xref="alg1.l14.m1.2.2.1.13.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2j" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.14" xref="alg1.l14.m1.2.2.1.14.cmml">y</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2k" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.15" xref="alg1.l14.m1.2.2.1.15.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2l" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.16" xref="alg1.l14.m1.2.2.1.16.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2m" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.17" xref="alg1.l14.m1.2.2.1.17.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2n" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l14.m1.2.2.1.18" xref="alg1.l14.m1.2.2.1.18.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.1.2o" xref="alg1.l14.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.l14.m1.2.2.1.1.1" xref="alg1.l14.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l14.m1.2.2.1.1.1.2" xref="alg1.l14.m1.2.2.1.1.2.cmml">(</mo><msubsup id="alg1.l14.m1.2.2.1.1.1.1" xref="alg1.l14.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l14.m1.2.2.1.1.1.1.2.2" xref="alg1.l14.m1.2.2.1.1.1.1.2.2.cmml">w</mi><msub id="alg1.l14.m1.2.2.1.1.1.1.3" xref="alg1.l14.m1.2.2.1.1.1.1.3.cmml"><mi id="alg1.l14.m1.2.2.1.1.1.1.3.2" xref="alg1.l14.m1.2.2.1.1.1.1.3.2.cmml">l</mi><mi id="alg1.l14.m1.2.2.1.1.1.1.3.3" xref="alg1.l14.m1.2.2.1.1.1.1.3.3.cmml">i</mi></msub><mi id="alg1.l14.m1.2.2.1.1.1.1.2.3" xref="alg1.l14.m1.2.2.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.l14.m1.2.2.1.1.1.3" xref="alg1.l14.m1.2.2.1.1.2.cmml">;</mo><mi id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">b</mi><mo stretchy="false" id="alg1.l14.m1.2.2.1.1.1.4" xref="alg1.l14.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.2b"><apply id="alg1.l14.m1.2.2.cmml" xref="alg1.l14.m1.2.2"><ci id="alg1.l14.m1.2.2.2.cmml" xref="alg1.l14.m1.2.2.2">←</ci><apply id="alg1.l14.m1.2.2.3.cmml" xref="alg1.l14.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.3.1.cmml" xref="alg1.l14.m1.2.2.3">subscript</csymbol><ci id="alg1.l14.m1.2.2.3.2.cmml" xref="alg1.l14.m1.2.2.3.2">ℓ</ci><apply id="alg1.l14.m1.2.2.3.3.cmml" xref="alg1.l14.m1.2.2.3.3"><times id="alg1.l14.m1.2.2.3.3.1.cmml" xref="alg1.l14.m1.2.2.3.3.1"></times><ci id="alg1.l14.m1.2.2.3.3.2.cmml" xref="alg1.l14.m1.2.2.3.3.2">𝑠</ci><ci id="alg1.l14.m1.2.2.3.3.3.cmml" xref="alg1.l14.m1.2.2.3.3.3">𝑢</ci><ci id="alg1.l14.m1.2.2.3.3.4.cmml" xref="alg1.l14.m1.2.2.3.3.4">𝑝</ci></apply></apply><apply id="alg1.l14.m1.2.2.1.cmml" xref="alg1.l14.m1.2.2.1"><times id="alg1.l14.m1.2.2.1.2.cmml" xref="alg1.l14.m1.2.2.1.2"></times><ci id="alg1.l14.m1.2.2.1.3.cmml" xref="alg1.l14.m1.2.2.1.3">𝐶</ci><ci id="alg1.l14.m1.2.2.1.4.cmml" xref="alg1.l14.m1.2.2.1.4">𝑟</ci><ci id="alg1.l14.m1.2.2.1.5.cmml" xref="alg1.l14.m1.2.2.1.5">𝑜</ci><ci id="alg1.l14.m1.2.2.1.6.cmml" xref="alg1.l14.m1.2.2.1.6">𝑠</ci><ci id="alg1.l14.m1.2.2.1.7.cmml" xref="alg1.l14.m1.2.2.1.7">𝑠</ci><ci id="alg1.l14.m1.2.2.1.8.cmml" xref="alg1.l14.m1.2.2.1.8">𝐸</ci><ci id="alg1.l14.m1.2.2.1.9.cmml" xref="alg1.l14.m1.2.2.1.9">𝑛</ci><ci id="alg1.l14.m1.2.2.1.10.cmml" xref="alg1.l14.m1.2.2.1.10">𝑡</ci><ci id="alg1.l14.m1.2.2.1.11.cmml" xref="alg1.l14.m1.2.2.1.11">𝑟</ci><ci id="alg1.l14.m1.2.2.1.12.cmml" xref="alg1.l14.m1.2.2.1.12">𝑜</ci><ci id="alg1.l14.m1.2.2.1.13.cmml" xref="alg1.l14.m1.2.2.1.13">𝑝</ci><ci id="alg1.l14.m1.2.2.1.14.cmml" xref="alg1.l14.m1.2.2.1.14">𝑦</ci><ci id="alg1.l14.m1.2.2.1.15.cmml" xref="alg1.l14.m1.2.2.1.15">𝐿</ci><ci id="alg1.l14.m1.2.2.1.16.cmml" xref="alg1.l14.m1.2.2.1.16">𝑜</ci><ci id="alg1.l14.m1.2.2.1.17.cmml" xref="alg1.l14.m1.2.2.1.17">𝑠</ci><ci id="alg1.l14.m1.2.2.1.18.cmml" xref="alg1.l14.m1.2.2.1.18">𝑠</ci><list id="alg1.l14.m1.2.2.1.1.2.cmml" xref="alg1.l14.m1.2.2.1.1.1"><apply id="alg1.l14.m1.2.2.1.1.1.1.cmml" xref="alg1.l14.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l14.m1.2.2.1.1.1.1">subscript</csymbol><apply id="alg1.l14.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l14.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.2.2.1.1.1.1">superscript</csymbol><ci id="alg1.l14.m1.2.2.1.1.1.1.2.2.cmml" xref="alg1.l14.m1.2.2.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l14.m1.2.2.1.1.1.1.2.3.cmml" xref="alg1.l14.m1.2.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l14.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l14.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.1.1.1.1.3.1.cmml" xref="alg1.l14.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="alg1.l14.m1.2.2.1.1.1.1.3.2.cmml" xref="alg1.l14.m1.2.2.1.1.1.1.3.2">𝑙</ci><ci id="alg1.l14.m1.2.2.1.1.1.1.3.3.cmml" xref="alg1.l14.m1.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">𝑏</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.2c">\ell_{sup}\leftarrow CrossEntropyLoss(w^{t}_{l_{i}};b)</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>        <math id="alg1.l15.m1.4" class="ltx_Math" alttext="\ell_{cka}\leftarrow CKALoss(w^{t}_{l_{i}};w^{t-1}_{l_{i}};w^{t}_{l_{i}};b)" display="inline"><semantics id="alg1.l15.m1.4a"><mrow id="alg1.l15.m1.4.4" xref="alg1.l15.m1.4.4.cmml"><msub id="alg1.l15.m1.4.4.5" xref="alg1.l15.m1.4.4.5.cmml"><mi mathvariant="normal" id="alg1.l15.m1.4.4.5.2" xref="alg1.l15.m1.4.4.5.2.cmml">ℓ</mi><mrow id="alg1.l15.m1.4.4.5.3" xref="alg1.l15.m1.4.4.5.3.cmml"><mi id="alg1.l15.m1.4.4.5.3.2" xref="alg1.l15.m1.4.4.5.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.4.5.3.1" xref="alg1.l15.m1.4.4.5.3.1.cmml">​</mo><mi id="alg1.l15.m1.4.4.5.3.3" xref="alg1.l15.m1.4.4.5.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.4.5.3.1a" xref="alg1.l15.m1.4.4.5.3.1.cmml">​</mo><mi id="alg1.l15.m1.4.4.5.3.4" xref="alg1.l15.m1.4.4.5.3.4.cmml">a</mi></mrow></msub><mo stretchy="false" id="alg1.l15.m1.4.4.4" xref="alg1.l15.m1.4.4.4.cmml">←</mo><mrow id="alg1.l15.m1.4.4.3" xref="alg1.l15.m1.4.4.3.cmml"><mi id="alg1.l15.m1.4.4.3.5" xref="alg1.l15.m1.4.4.3.5.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.4.3.4" xref="alg1.l15.m1.4.4.3.4.cmml">​</mo><mi id="alg1.l15.m1.4.4.3.6" xref="alg1.l15.m1.4.4.3.6.cmml">K</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.4.3.4a" xref="alg1.l15.m1.4.4.3.4.cmml">​</mo><mi id="alg1.l15.m1.4.4.3.7" xref="alg1.l15.m1.4.4.3.7.cmml">A</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.4.3.4b" xref="alg1.l15.m1.4.4.3.4.cmml">​</mo><mi id="alg1.l15.m1.4.4.3.8" xref="alg1.l15.m1.4.4.3.8.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.4.3.4c" xref="alg1.l15.m1.4.4.3.4.cmml">​</mo><mi id="alg1.l15.m1.4.4.3.9" xref="alg1.l15.m1.4.4.3.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.4.3.4d" xref="alg1.l15.m1.4.4.3.4.cmml">​</mo><mi id="alg1.l15.m1.4.4.3.10" xref="alg1.l15.m1.4.4.3.10.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.4.3.4e" xref="alg1.l15.m1.4.4.3.4.cmml">​</mo><mi id="alg1.l15.m1.4.4.3.11" xref="alg1.l15.m1.4.4.3.11.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.4.3.4f" xref="alg1.l15.m1.4.4.3.4.cmml">​</mo><mrow id="alg1.l15.m1.4.4.3.3.3" xref="alg1.l15.m1.4.4.3.3.4.cmml"><mo stretchy="false" id="alg1.l15.m1.4.4.3.3.3.4" xref="alg1.l15.m1.4.4.3.3.4.cmml">(</mo><msubsup id="alg1.l15.m1.2.2.1.1.1.1" xref="alg1.l15.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l15.m1.2.2.1.1.1.1.2.2" xref="alg1.l15.m1.2.2.1.1.1.1.2.2.cmml">w</mi><msub id="alg1.l15.m1.2.2.1.1.1.1.3" xref="alg1.l15.m1.2.2.1.1.1.1.3.cmml"><mi id="alg1.l15.m1.2.2.1.1.1.1.3.2" xref="alg1.l15.m1.2.2.1.1.1.1.3.2.cmml">l</mi><mi id="alg1.l15.m1.2.2.1.1.1.1.3.3" xref="alg1.l15.m1.2.2.1.1.1.1.3.3.cmml">i</mi></msub><mi id="alg1.l15.m1.2.2.1.1.1.1.2.3" xref="alg1.l15.m1.2.2.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.l15.m1.4.4.3.3.3.5" xref="alg1.l15.m1.4.4.3.3.4.cmml">;</mo><msubsup id="alg1.l15.m1.3.3.2.2.2.2" xref="alg1.l15.m1.3.3.2.2.2.2.cmml"><mi id="alg1.l15.m1.3.3.2.2.2.2.2.2" xref="alg1.l15.m1.3.3.2.2.2.2.2.2.cmml">w</mi><msub id="alg1.l15.m1.3.3.2.2.2.2.3" xref="alg1.l15.m1.3.3.2.2.2.2.3.cmml"><mi id="alg1.l15.m1.3.3.2.2.2.2.3.2" xref="alg1.l15.m1.3.3.2.2.2.2.3.2.cmml">l</mi><mi id="alg1.l15.m1.3.3.2.2.2.2.3.3" xref="alg1.l15.m1.3.3.2.2.2.2.3.3.cmml">i</mi></msub><mrow id="alg1.l15.m1.3.3.2.2.2.2.2.3" xref="alg1.l15.m1.3.3.2.2.2.2.2.3.cmml"><mi id="alg1.l15.m1.3.3.2.2.2.2.2.3.2" xref="alg1.l15.m1.3.3.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l15.m1.3.3.2.2.2.2.2.3.1" xref="alg1.l15.m1.3.3.2.2.2.2.2.3.1.cmml">−</mo><mn id="alg1.l15.m1.3.3.2.2.2.2.2.3.3" xref="alg1.l15.m1.3.3.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l15.m1.4.4.3.3.3.6" xref="alg1.l15.m1.4.4.3.3.4.cmml">;</mo><msubsup id="alg1.l15.m1.4.4.3.3.3.3" xref="alg1.l15.m1.4.4.3.3.3.3.cmml"><mi id="alg1.l15.m1.4.4.3.3.3.3.2.2" xref="alg1.l15.m1.4.4.3.3.3.3.2.2.cmml">w</mi><msub id="alg1.l15.m1.4.4.3.3.3.3.3" xref="alg1.l15.m1.4.4.3.3.3.3.3.cmml"><mi id="alg1.l15.m1.4.4.3.3.3.3.3.2" xref="alg1.l15.m1.4.4.3.3.3.3.3.2.cmml">l</mi><mi id="alg1.l15.m1.4.4.3.3.3.3.3.3" xref="alg1.l15.m1.4.4.3.3.3.3.3.3.cmml">i</mi></msub><mi id="alg1.l15.m1.4.4.3.3.3.3.2.3" xref="alg1.l15.m1.4.4.3.3.3.3.2.3.cmml">t</mi></msubsup><mo id="alg1.l15.m1.4.4.3.3.3.7" xref="alg1.l15.m1.4.4.3.3.4.cmml">;</mo><mi id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">b</mi><mo stretchy="false" id="alg1.l15.m1.4.4.3.3.3.8" xref="alg1.l15.m1.4.4.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.4b"><apply id="alg1.l15.m1.4.4.cmml" xref="alg1.l15.m1.4.4"><ci id="alg1.l15.m1.4.4.4.cmml" xref="alg1.l15.m1.4.4.4">←</ci><apply id="alg1.l15.m1.4.4.5.cmml" xref="alg1.l15.m1.4.4.5"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.5.1.cmml" xref="alg1.l15.m1.4.4.5">subscript</csymbol><ci id="alg1.l15.m1.4.4.5.2.cmml" xref="alg1.l15.m1.4.4.5.2">ℓ</ci><apply id="alg1.l15.m1.4.4.5.3.cmml" xref="alg1.l15.m1.4.4.5.3"><times id="alg1.l15.m1.4.4.5.3.1.cmml" xref="alg1.l15.m1.4.4.5.3.1"></times><ci id="alg1.l15.m1.4.4.5.3.2.cmml" xref="alg1.l15.m1.4.4.5.3.2">𝑐</ci><ci id="alg1.l15.m1.4.4.5.3.3.cmml" xref="alg1.l15.m1.4.4.5.3.3">𝑘</ci><ci id="alg1.l15.m1.4.4.5.3.4.cmml" xref="alg1.l15.m1.4.4.5.3.4">𝑎</ci></apply></apply><apply id="alg1.l15.m1.4.4.3.cmml" xref="alg1.l15.m1.4.4.3"><times id="alg1.l15.m1.4.4.3.4.cmml" xref="alg1.l15.m1.4.4.3.4"></times><ci id="alg1.l15.m1.4.4.3.5.cmml" xref="alg1.l15.m1.4.4.3.5">𝐶</ci><ci id="alg1.l15.m1.4.4.3.6.cmml" xref="alg1.l15.m1.4.4.3.6">𝐾</ci><ci id="alg1.l15.m1.4.4.3.7.cmml" xref="alg1.l15.m1.4.4.3.7">𝐴</ci><ci id="alg1.l15.m1.4.4.3.8.cmml" xref="alg1.l15.m1.4.4.3.8">𝐿</ci><ci id="alg1.l15.m1.4.4.3.9.cmml" xref="alg1.l15.m1.4.4.3.9">𝑜</ci><ci id="alg1.l15.m1.4.4.3.10.cmml" xref="alg1.l15.m1.4.4.3.10">𝑠</ci><ci id="alg1.l15.m1.4.4.3.11.cmml" xref="alg1.l15.m1.4.4.3.11">𝑠</ci><list id="alg1.l15.m1.4.4.3.3.4.cmml" xref="alg1.l15.m1.4.4.3.3.3"><apply id="alg1.l15.m1.2.2.1.1.1.1.cmml" xref="alg1.l15.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l15.m1.2.2.1.1.1.1">subscript</csymbol><apply id="alg1.l15.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l15.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.1.1.1.1.2.1.cmml" xref="alg1.l15.m1.2.2.1.1.1.1">superscript</csymbol><ci id="alg1.l15.m1.2.2.1.1.1.1.2.2.cmml" xref="alg1.l15.m1.2.2.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l15.m1.2.2.1.1.1.1.2.3.cmml" xref="alg1.l15.m1.2.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l15.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l15.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.1.1.1.1.3.1.cmml" xref="alg1.l15.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.2.2.1.1.1.1.3.2.cmml" xref="alg1.l15.m1.2.2.1.1.1.1.3.2">𝑙</ci><ci id="alg1.l15.m1.2.2.1.1.1.1.3.3.cmml" xref="alg1.l15.m1.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="alg1.l15.m1.3.3.2.2.2.2.cmml" xref="alg1.l15.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l15.m1.3.3.2.2.2.2">subscript</csymbol><apply id="alg1.l15.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l15.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.2.2.2.2.2.1.cmml" xref="alg1.l15.m1.3.3.2.2.2.2">superscript</csymbol><ci id="alg1.l15.m1.3.3.2.2.2.2.2.2.cmml" xref="alg1.l15.m1.3.3.2.2.2.2.2.2">𝑤</ci><apply id="alg1.l15.m1.3.3.2.2.2.2.2.3.cmml" xref="alg1.l15.m1.3.3.2.2.2.2.2.3"><minus id="alg1.l15.m1.3.3.2.2.2.2.2.3.1.cmml" xref="alg1.l15.m1.3.3.2.2.2.2.2.3.1"></minus><ci id="alg1.l15.m1.3.3.2.2.2.2.2.3.2.cmml" xref="alg1.l15.m1.3.3.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l15.m1.3.3.2.2.2.2.2.3.3.cmml" xref="alg1.l15.m1.3.3.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l15.m1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.2.2.2.2.3.1.cmml" xref="alg1.l15.m1.3.3.2.2.2.2.3">subscript</csymbol><ci id="alg1.l15.m1.3.3.2.2.2.2.3.2.cmml" xref="alg1.l15.m1.3.3.2.2.2.2.3.2">𝑙</ci><ci id="alg1.l15.m1.3.3.2.2.2.2.3.3.cmml" xref="alg1.l15.m1.3.3.2.2.2.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l15.m1.4.4.3.3.3.3.cmml" xref="alg1.l15.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.3.3.3.3.1.cmml" xref="alg1.l15.m1.4.4.3.3.3.3">subscript</csymbol><apply id="alg1.l15.m1.4.4.3.3.3.3.2.cmml" xref="alg1.l15.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.3.3.3.3.2.1.cmml" xref="alg1.l15.m1.4.4.3.3.3.3">superscript</csymbol><ci id="alg1.l15.m1.4.4.3.3.3.3.2.2.cmml" xref="alg1.l15.m1.4.4.3.3.3.3.2.2">𝑤</ci><ci id="alg1.l15.m1.4.4.3.3.3.3.2.3.cmml" xref="alg1.l15.m1.4.4.3.3.3.3.2.3">𝑡</ci></apply><apply id="alg1.l15.m1.4.4.3.3.3.3.3.cmml" xref="alg1.l15.m1.4.4.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.3.3.3.3.3.1.cmml" xref="alg1.l15.m1.4.4.3.3.3.3.3">subscript</csymbol><ci id="alg1.l15.m1.4.4.3.3.3.3.3.2.cmml" xref="alg1.l15.m1.4.4.3.3.3.3.3.2">𝑙</ci><ci id="alg1.l15.m1.4.4.3.3.3.3.3.3.cmml" xref="alg1.l15.m1.4.4.3.3.3.3.3.3">𝑖</ci></apply></apply><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">𝑏</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.4c">\ell_{cka}\leftarrow CKALoss(w^{t}_{l_{i}};w^{t-1}_{l_{i}};w^{t}_{l_{i}};b)</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>        <math id="alg1.l16.m1.1" class="ltx_Math" alttext="\ell\leftarrow\ell_{sup}+\mu\ell_{cka}" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi mathvariant="normal" id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">ℓ</mi><mo stretchy="false" id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml">←</mo><mrow id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><msub id="alg1.l16.m1.1.1.3.2" xref="alg1.l16.m1.1.1.3.2.cmml"><mi mathvariant="normal" id="alg1.l16.m1.1.1.3.2.2" xref="alg1.l16.m1.1.1.3.2.2.cmml">ℓ</mi><mrow id="alg1.l16.m1.1.1.3.2.3" xref="alg1.l16.m1.1.1.3.2.3.cmml"><mi id="alg1.l16.m1.1.1.3.2.3.2" xref="alg1.l16.m1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.3.2.3.1" xref="alg1.l16.m1.1.1.3.2.3.1.cmml">​</mo><mi id="alg1.l16.m1.1.1.3.2.3.3" xref="alg1.l16.m1.1.1.3.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.3.2.3.1a" xref="alg1.l16.m1.1.1.3.2.3.1.cmml">​</mo><mi id="alg1.l16.m1.1.1.3.2.3.4" xref="alg1.l16.m1.1.1.3.2.3.4.cmml">p</mi></mrow></msub><mo id="alg1.l16.m1.1.1.3.1" xref="alg1.l16.m1.1.1.3.1.cmml">+</mo><mrow id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml"><mi id="alg1.l16.m1.1.1.3.3.2" xref="alg1.l16.m1.1.1.3.3.2.cmml">μ</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.3.3.1" xref="alg1.l16.m1.1.1.3.3.1.cmml">​</mo><msub id="alg1.l16.m1.1.1.3.3.3" xref="alg1.l16.m1.1.1.3.3.3.cmml"><mi mathvariant="normal" id="alg1.l16.m1.1.1.3.3.3.2" xref="alg1.l16.m1.1.1.3.3.3.2.cmml">ℓ</mi><mrow id="alg1.l16.m1.1.1.3.3.3.3" xref="alg1.l16.m1.1.1.3.3.3.3.cmml"><mi id="alg1.l16.m1.1.1.3.3.3.3.2" xref="alg1.l16.m1.1.1.3.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.3.3.3.3.1" xref="alg1.l16.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="alg1.l16.m1.1.1.3.3.3.3.3" xref="alg1.l16.m1.1.1.3.3.3.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.3.3.3.3.1a" xref="alg1.l16.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="alg1.l16.m1.1.1.3.3.3.3.4" xref="alg1.l16.m1.1.1.3.3.3.3.4.cmml">a</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1">←</ci><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">ℓ</ci><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><plus id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3.1"></plus><apply id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.2.1.cmml" xref="alg1.l16.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l16.m1.1.1.3.2.2.cmml" xref="alg1.l16.m1.1.1.3.2.2">ℓ</ci><apply id="alg1.l16.m1.1.1.3.2.3.cmml" xref="alg1.l16.m1.1.1.3.2.3"><times id="alg1.l16.m1.1.1.3.2.3.1.cmml" xref="alg1.l16.m1.1.1.3.2.3.1"></times><ci id="alg1.l16.m1.1.1.3.2.3.2.cmml" xref="alg1.l16.m1.1.1.3.2.3.2">𝑠</ci><ci id="alg1.l16.m1.1.1.3.2.3.3.cmml" xref="alg1.l16.m1.1.1.3.2.3.3">𝑢</ci><ci id="alg1.l16.m1.1.1.3.2.3.4.cmml" xref="alg1.l16.m1.1.1.3.2.3.4">𝑝</ci></apply></apply><apply id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3"><times id="alg1.l16.m1.1.1.3.3.1.cmml" xref="alg1.l16.m1.1.1.3.3.1"></times><ci id="alg1.l16.m1.1.1.3.3.2.cmml" xref="alg1.l16.m1.1.1.3.3.2">𝜇</ci><apply id="alg1.l16.m1.1.1.3.3.3.cmml" xref="alg1.l16.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.3.3.1.cmml" xref="alg1.l16.m1.1.1.3.3.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.3.3.3.2.cmml" xref="alg1.l16.m1.1.1.3.3.3.2">ℓ</ci><apply id="alg1.l16.m1.1.1.3.3.3.3.cmml" xref="alg1.l16.m1.1.1.3.3.3.3"><times id="alg1.l16.m1.1.1.3.3.3.3.1.cmml" xref="alg1.l16.m1.1.1.3.3.3.3.1"></times><ci id="alg1.l16.m1.1.1.3.3.3.3.2.cmml" xref="alg1.l16.m1.1.1.3.3.3.3.2">𝑐</ci><ci id="alg1.l16.m1.1.1.3.3.3.3.3.cmml" xref="alg1.l16.m1.1.1.3.3.3.3.3">𝑘</ci><ci id="alg1.l16.m1.1.1.3.3.3.3.4.cmml" xref="alg1.l16.m1.1.1.3.3.3.3.4">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\ell\leftarrow\ell_{sup}+\mu\ell_{cka}</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>        <math id="alg1.l17.m1.1" class="ltx_Math" alttext="w^{t}_{l_{i}}\leftarrow w^{t}_{l_{i}}-\eta\nabla\ell" display="inline"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><msubsup id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml"><mi id="alg1.l17.m1.1.1.2.2.2" xref="alg1.l17.m1.1.1.2.2.2.cmml">w</mi><msub id="alg1.l17.m1.1.1.2.3" xref="alg1.l17.m1.1.1.2.3.cmml"><mi id="alg1.l17.m1.1.1.2.3.2" xref="alg1.l17.m1.1.1.2.3.2.cmml">l</mi><mi id="alg1.l17.m1.1.1.2.3.3" xref="alg1.l17.m1.1.1.2.3.3.cmml">i</mi></msub><mi id="alg1.l17.m1.1.1.2.2.3" xref="alg1.l17.m1.1.1.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml">←</mo><mrow id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><msubsup id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml"><mi id="alg1.l17.m1.1.1.3.2.2.2" xref="alg1.l17.m1.1.1.3.2.2.2.cmml">w</mi><msub id="alg1.l17.m1.1.1.3.2.3" xref="alg1.l17.m1.1.1.3.2.3.cmml"><mi id="alg1.l17.m1.1.1.3.2.3.2" xref="alg1.l17.m1.1.1.3.2.3.2.cmml">l</mi><mi id="alg1.l17.m1.1.1.3.2.3.3" xref="alg1.l17.m1.1.1.3.2.3.3.cmml">i</mi></msub><mi id="alg1.l17.m1.1.1.3.2.2.3" xref="alg1.l17.m1.1.1.3.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l17.m1.1.1.3.1" xref="alg1.l17.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml"><mi id="alg1.l17.m1.1.1.3.3.2" xref="alg1.l17.m1.1.1.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l17.m1.1.1.3.3.1" xref="alg1.l17.m1.1.1.3.3.1.cmml">​</mo><mrow id="alg1.l17.m1.1.1.3.3.3" xref="alg1.l17.m1.1.1.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l17.m1.1.1.3.3.3.1" xref="alg1.l17.m1.1.1.3.3.3.1.cmml">∇</mo><mi mathvariant="normal" id="alg1.l17.m1.1.1.3.3.3.2" xref="alg1.l17.m1.1.1.3.3.3.2.cmml">ℓ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><ci id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1">←</ci><apply id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.2">subscript</csymbol><apply id="alg1.l17.m1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.2.2.1.cmml" xref="alg1.l17.m1.1.1.2">superscript</csymbol><ci id="alg1.l17.m1.1.1.2.2.2.cmml" xref="alg1.l17.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l17.m1.1.1.2.2.3.cmml" xref="alg1.l17.m1.1.1.2.2.3">𝑡</ci></apply><apply id="alg1.l17.m1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.2.3.1.cmml" xref="alg1.l17.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.2.3.2.cmml" xref="alg1.l17.m1.1.1.2.3.2">𝑙</ci><ci id="alg1.l17.m1.1.1.2.3.3.cmml" xref="alg1.l17.m1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><minus id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3.1"></minus><apply id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.2.1.cmml" xref="alg1.l17.m1.1.1.3.2">subscript</csymbol><apply id="alg1.l17.m1.1.1.3.2.2.cmml" xref="alg1.l17.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.2.2.1.cmml" xref="alg1.l17.m1.1.1.3.2">superscript</csymbol><ci id="alg1.l17.m1.1.1.3.2.2.2.cmml" xref="alg1.l17.m1.1.1.3.2.2.2">𝑤</ci><ci id="alg1.l17.m1.1.1.3.2.2.3.cmml" xref="alg1.l17.m1.1.1.3.2.2.3">𝑡</ci></apply><apply id="alg1.l17.m1.1.1.3.2.3.cmml" xref="alg1.l17.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.2.3.1.cmml" xref="alg1.l17.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.3.2.3.2.cmml" xref="alg1.l17.m1.1.1.3.2.3.2">𝑙</ci><ci id="alg1.l17.m1.1.1.3.2.3.3.cmml" xref="alg1.l17.m1.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3"><times id="alg1.l17.m1.1.1.3.3.1.cmml" xref="alg1.l17.m1.1.1.3.3.1"></times><ci id="alg1.l17.m1.1.1.3.3.2.cmml" xref="alg1.l17.m1.1.1.3.3.2">𝜂</ci><apply id="alg1.l17.m1.1.1.3.3.3.cmml" xref="alg1.l17.m1.1.1.3.3.3"><ci id="alg1.l17.m1.1.1.3.3.3.1.cmml" xref="alg1.l17.m1.1.1.3.3.3.1">∇</ci><ci id="alg1.l17.m1.1.1.3.3.3.2.cmml" xref="alg1.l17.m1.1.1.3.3.3.2">ℓ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">w^{t}_{l_{i}}\leftarrow w^{t}_{l_{i}}-\eta\nabla\ell</annotation></semantics></math>

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>     <span id="alg1.l18.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l18.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>  <span id="alg1.l19.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>  <span id="alg1.l20.1" class="ltx_text ltx_font_bold">return</span> solution  
</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span>  <span id="alg1.l21.1" class="ltx_text ltx_font_bold">WeightedAvg</span>(<math id="alg1.l21.m1.1" class="ltx_Math" alttext="W^{t}_{l}" display="inline"><semantics id="alg1.l21.m1.1a"><msubsup id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi id="alg1.l21.m1.1.1.2.2" xref="alg1.l21.m1.1.1.2.2.cmml">W</mi><mi id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml">l</mi><mi id="alg1.l21.m1.1.1.2.3" xref="alg1.l21.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1">subscript</csymbol><apply id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.2.1.cmml" xref="alg1.l21.m1.1.1">superscript</csymbol><ci id="alg1.l21.m1.1.1.2.2.cmml" xref="alg1.l21.m1.1.1.2.2">𝑊</ci><ci id="alg1.l21.m1.1.1.2.3.cmml" xref="alg1.l21.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">W^{t}_{l}</annotation></semantics></math>):

</div>
<div id="alg1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22:</span>  Initialize <math id="alg1.l22.m1.1" class="ltx_Math" alttext="w^{t}_{g}" display="inline"><semantics id="alg1.l22.m1.1a"><msubsup id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><mi id="alg1.l22.m1.1.1.2.2" xref="alg1.l22.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml">g</mi><mi id="alg1.l22.m1.1.1.2.3" xref="alg1.l22.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.1.cmml" xref="alg1.l22.m1.1.1">subscript</csymbol><apply id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.2.1.cmml" xref="alg1.l22.m1.1.1">superscript</csymbol><ci id="alg1.l22.m1.1.1.2.2.cmml" xref="alg1.l22.m1.1.1.2.2">𝑤</ci><ci id="alg1.l22.m1.1.1.2.3.cmml" xref="alg1.l22.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">w^{t}_{g}</annotation></semantics></math>

</div>
<div id="alg1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23:</span>  <span id="alg1.l23.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l23.m1.2" class="ltx_Math" alttext="i\ \in\ [0,C]" display="inline"><semantics id="alg1.l23.m1.2a"><mrow id="alg1.l23.m1.2.3" xref="alg1.l23.m1.2.3.cmml"><mi id="alg1.l23.m1.2.3.2" xref="alg1.l23.m1.2.3.2.cmml">i</mi><mo lspace="0.778em" rspace="0.778em" id="alg1.l23.m1.2.3.1" xref="alg1.l23.m1.2.3.1.cmml">∈</mo><mrow id="alg1.l23.m1.2.3.3.2" xref="alg1.l23.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l23.m1.2.3.3.2.1" xref="alg1.l23.m1.2.3.3.1.cmml">[</mo><mn id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml">0</mn><mo id="alg1.l23.m1.2.3.3.2.2" xref="alg1.l23.m1.2.3.3.1.cmml">,</mo><mi id="alg1.l23.m1.2.2" xref="alg1.l23.m1.2.2.cmml">C</mi><mo stretchy="false" id="alg1.l23.m1.2.3.3.2.3" xref="alg1.l23.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.2b"><apply id="alg1.l23.m1.2.3.cmml" xref="alg1.l23.m1.2.3"><in id="alg1.l23.m1.2.3.1.cmml" xref="alg1.l23.m1.2.3.1"></in><ci id="alg1.l23.m1.2.3.2.cmml" xref="alg1.l23.m1.2.3.2">𝑖</ci><interval closure="closed" id="alg1.l23.m1.2.3.3.1.cmml" xref="alg1.l23.m1.2.3.3.2"><cn type="integer" id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1">0</cn><ci id="alg1.l23.m1.2.2.cmml" xref="alg1.l23.m1.2.2">𝐶</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.2c">i\ \in\ [0,C]</annotation></semantics></math> <span id="alg1.l23.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24:</span>     <math id="alg1.l24.m1.2" class="ltx_math_unparsed" alttext="w^{t}_{g}\mathrel{+}=\frac{\left|D^{i}\right|}{\left|D\right|}W^{t}_{l_{i}}" display="inline"><semantics id="alg1.l24.m1.2a"><mrow id="alg1.l24.m1.2b"><msubsup id="alg1.l24.m1.2.3"><mi id="alg1.l24.m1.2.3.2.2">w</mi><mi id="alg1.l24.m1.2.3.3">g</mi><mi id="alg1.l24.m1.2.3.2.3">t</mi></msubsup><mo lspace="0.278em" rspace="0em" id="alg1.l24.m1.2.4">+</mo><mo lspace="0em" id="alg1.l24.m1.2.5">=</mo><mfrac id="alg1.l24.m1.2.2"><mrow id="alg1.l24.m1.1.1.1.1"><mo id="alg1.l24.m1.1.1.1.1.2">|</mo><msup id="alg1.l24.m1.1.1.1.1.1"><mi id="alg1.l24.m1.1.1.1.1.1.2">D</mi><mi id="alg1.l24.m1.1.1.1.1.1.3">i</mi></msup><mo id="alg1.l24.m1.1.1.1.1.3">|</mo></mrow><mrow id="alg1.l24.m1.2.2.2.3"><mo id="alg1.l24.m1.2.2.2.3.1">|</mo><mi id="alg1.l24.m1.2.2.2.1">D</mi><mo id="alg1.l24.m1.2.2.2.3.2">|</mo></mrow></mfrac><msubsup id="alg1.l24.m1.2.6"><mi id="alg1.l24.m1.2.6.2.2">W</mi><msub id="alg1.l24.m1.2.6.3"><mi id="alg1.l24.m1.2.6.3.2">l</mi><mi id="alg1.l24.m1.2.6.3.3">i</mi></msub><mi id="alg1.l24.m1.2.6.2.3">t</mi></msubsup></mrow><annotation encoding="application/x-tex" id="alg1.l24.m1.2c">w^{t}_{g}\mathrel{+}=\frac{\left|D^{i}\right|}{\left|D\right|}W^{t}_{l_{i}}</annotation></semantics></math>

</div>
<div id="alg1.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25:</span>  <span id="alg1.l25.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l25.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26:</span>  <span id="alg1.l26.1" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l26.m1.1" class="ltx_Math" alttext="w^{t}_{g}" display="inline"><semantics id="alg1.l26.m1.1a"><msubsup id="alg1.l26.m1.1.1" xref="alg1.l26.m1.1.1.cmml"><mi id="alg1.l26.m1.1.1.2.2" xref="alg1.l26.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l26.m1.1.1.3" xref="alg1.l26.m1.1.1.3.cmml">g</mi><mi id="alg1.l26.m1.1.1.2.3" xref="alg1.l26.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.1b"><apply id="alg1.l26.m1.1.1.cmml" xref="alg1.l26.m1.1.1"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.cmml" xref="alg1.l26.m1.1.1">subscript</csymbol><apply id="alg1.l26.m1.1.1.2.cmml" xref="alg1.l26.m1.1.1"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.2.1.cmml" xref="alg1.l26.m1.1.1">superscript</csymbol><ci id="alg1.l26.m1.1.1.2.2.cmml" xref="alg1.l26.m1.1.1.2.2">𝑤</ci><ci id="alg1.l26.m1.1.1.2.3.cmml" xref="alg1.l26.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l26.m1.1.1.3.cmml" xref="alg1.l26.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.1c">w^{t}_{g}</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
<div id="S3.SS3.p4" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.12" class="ltx_math_unparsed" alttext="\begin{multlined}\ell_{cka}=\\
\frac{1}{M}\sum_{n=1}^{M}-\log\left(\frac{e^{(CKA(a^{t}_{l_{i_{n}}},a^{t}_{g_{n}})}}{e^{(CKA(a^{t}_{l_{i_{n}}},a^{t}_{g_{n}}))}+e^{(CKA(a^{t}_{l_{i_{n}}},a^{t-1}_{l_{i_{n}}}))}}\right)\end{multlined}\ell_{cka}=\\
\frac{1}{M}\sum_{n=1}^{M}-\log\left(\frac{e^{(CKA(a^{t}_{l_{i_{n}}},a^{t}_{g_{n}})}}{e^{(CKA(a^{t}_{l_{i_{n}}},a^{t}_{g_{n}}))}+e^{(CKA(a^{t}_{l_{i_{n}}},a^{t-1}_{l_{i_{n}}}))}}\right)" display="block"><semantics id="S3.E2.m1.12a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E2.m1.12.12"><mtr id="S3.E2.m1.12.12a"><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.12.12b"><mrow id="S3.E2.m1.3.3.3.3.3"><msub id="S3.E2.m1.3.3.3.3.3.4"><mi mathvariant="normal" id="S3.E2.m1.1.1.1.1.1.1">ℓ</mi><mrow id="S3.E2.m1.2.2.2.2.2.2.1"><mi id="S3.E2.m1.2.2.2.2.2.2.1.2">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.2.2.1.1">​</mo><mi id="S3.E2.m1.2.2.2.2.2.2.1.3">k</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.2.2.1.1a">​</mo><mi id="S3.E2.m1.2.2.2.2.2.2.1.4">a</mi></mrow></msub><mo id="S3.E2.m1.3.3.3.3.3.3">=</mo><mi id="S3.E2.m1.3.3.3.3.3.5"></mi></mrow></mtd></mtr><mtr id="S3.E2.m1.12.12c"><mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.12.12d"><mrow id="S3.E2.m1.12.12.12.9.9"><mrow id="S3.E2.m1.12.12.12.9.9.10"><mfrac id="S3.E2.m1.4.4.4.1.1.1"><mn id="S3.E2.m1.4.4.4.1.1.1.2">1</mn><mi id="S3.E2.m1.4.4.4.1.1.1.3">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.12.12.12.9.9.10.1">​</mo><munderover id="S3.E2.m1.12.12.12.9.9.10.2"><mo movablelimits="false" rspace="0em" id="S3.E2.m1.5.5.5.2.2.2">∑</mo><mrow id="S3.E2.m1.6.6.6.3.3.3.1"><mi id="S3.E2.m1.6.6.6.3.3.3.1.2">n</mi><mo id="S3.E2.m1.6.6.6.3.3.3.1.1">=</mo><mn id="S3.E2.m1.6.6.6.3.3.3.1.3">1</mn></mrow><mi id="S3.E2.m1.7.7.7.4.4.4.1">M</mi></munderover></mrow><mo lspace="0em" id="S3.E2.m1.8.8.8.5.5.5">−</mo><mrow id="S3.E2.m1.12.12.12.9.9.11"><mi id="S3.E2.m1.9.9.9.6.6.6">log</mi><mo id="S3.E2.m1.12.12.12.9.9.11a">⁡</mo><mrow id="S3.E2.m1.12.12.12.9.9.11.1"><mo id="S3.E2.m1.10.10.10.7.7.7">(</mo><mfrac id="S3.E2.m1.11.11.11.8.8.8"><msup id="S3.E2.m1.11.11.11.8.8.8.4"><mi id="S3.E2.m1.11.11.11.8.8.8.4.2">e</mi><mrow id="S3.E2.m1.11.11.11.8.8.8.4.3"><mo stretchy="false" id="S3.E2.m1.11.11.11.8.8.8.4.3.1">(</mo><mi id="S3.E2.m1.11.11.11.8.8.8.4.3.2">C</mi><mi id="S3.E2.m1.11.11.11.8.8.8.4.3.3">K</mi><mi id="S3.E2.m1.11.11.11.8.8.8.4.3.4">A</mi><mrow id="S3.E2.m1.11.11.11.8.8.8.4.3.5"><mo stretchy="false" id="S3.E2.m1.11.11.11.8.8.8.4.3.5.1">(</mo><msubsup id="S3.E2.m1.11.11.11.8.8.8.4.3.5.2"><mi id="S3.E2.m1.11.11.11.8.8.8.4.3.5.2.2.2">a</mi><msub id="S3.E2.m1.11.11.11.8.8.8.4.3.5.2.3"><mi id="S3.E2.m1.11.11.11.8.8.8.4.3.5.2.3.2">l</mi><msub id="S3.E2.m1.11.11.11.8.8.8.4.3.5.2.3.3"><mi id="S3.E2.m1.11.11.11.8.8.8.4.3.5.2.3.3.2">i</mi><mi id="S3.E2.m1.11.11.11.8.8.8.4.3.5.2.3.3.3">n</mi></msub></msub><mi id="S3.E2.m1.11.11.11.8.8.8.4.3.5.2.2.3">t</mi></msubsup><mo id="S3.E2.m1.11.11.11.8.8.8.4.3.5.3">,</mo><msubsup id="S3.E2.m1.11.11.11.8.8.8.4.3.5.4"><mi id="S3.E2.m1.11.11.11.8.8.8.4.3.5.4.2.2">a</mi><msub id="S3.E2.m1.11.11.11.8.8.8.4.3.5.4.3"><mi id="S3.E2.m1.11.11.11.8.8.8.4.3.5.4.3.2">g</mi><mi id="S3.E2.m1.11.11.11.8.8.8.4.3.5.4.3.3">n</mi></msub><mi id="S3.E2.m1.11.11.11.8.8.8.4.3.5.4.2.3">t</mi></msubsup><mo stretchy="false" id="S3.E2.m1.11.11.11.8.8.8.4.3.5.5">)</mo></mrow></mrow></msup><mrow id="S3.E2.m1.11.11.11.8.8.8.2"><msup id="S3.E2.m1.11.11.11.8.8.8.2.4"><mi id="S3.E2.m1.11.11.11.8.8.8.2.4.2">e</mi><mrow id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1"><mo stretchy="false" id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.2">(</mo><mrow id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1"><mi id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.4">C</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.3">​</mo><mi id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.5">K</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.3a">​</mo><mi id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.6">A</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.3b">​</mo><mrow id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.2.2"><mo stretchy="false" id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.2.2.3">(</mo><msubsup id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.1.1.1"><mi id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.1.1.1.2.2">a</mi><msub id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.1.1.1.3"><mi id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.1.1.1.3.2">l</mi><msub id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.1.1.1.3.3"><mi id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.1.1.1.3.3.2">i</mi><mi id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.1.1.1.3.3.3">n</mi></msub></msub><mi id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.1.1.1.2.3">t</mi></msubsup><mo id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.2.2.4">,</mo><msubsup id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.2.2.2"><mi id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.2.2.2.2.2">a</mi><msub id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.2.2.2.3"><mi id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.2.2.2.3.2">g</mi><mi id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.2.2.2.3.3">n</mi></msub><mi id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.2.2.2.2.3">t</mi></msubsup><mo stretchy="false" id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.1.2.2.5">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.11.11.11.8.8.8.1.1.1.1.3">)</mo></mrow></msup><mo id="S3.E2.m1.11.11.11.8.8.8.2.3">+</mo><msup id="S3.E2.m1.11.11.11.8.8.8.2.5"><mi id="S3.E2.m1.11.11.11.8.8.8.2.5.2">e</mi><mrow id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1"><mo stretchy="false" id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.2">(</mo><mrow id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1"><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.4">C</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.3">​</mo><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.5">K</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.3a">​</mo><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.6">A</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.3b">​</mo><mrow id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2"><mo stretchy="false" id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.3">(</mo><msubsup id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.1.1.1"><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.1.1.1.2.2">a</mi><msub id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.1.1.1.3"><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.1.1.1.3.2">l</mi><msub id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.1.1.1.3.3"><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.1.1.1.3.3.2">i</mi><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.1.1.1.3.3.3">n</mi></msub></msub><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.1.1.1.2.3">t</mi></msubsup><mo id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.4">,</mo><msubsup id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.2"><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.2.2.2">a</mi><msub id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.2.3"><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.2.3.2">l</mi><msub id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.2.3.3"><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.2.3.3.2">i</mi><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.2.3.3.3">n</mi></msub></msub><mrow id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.2.2.3"><mi id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.2.2.3.2">t</mi><mo id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.2.2.3.1">−</mo><mn id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.2.2.3.3">1</mn></mrow></msubsup><mo stretchy="false" id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.1.2.2.5">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.11.11.11.8.8.8.2.2.1.1.3">)</mo></mrow></msup></mrow></mfrac><mo id="S3.E2.m1.12.12.12.9.9.9">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S3.E2.m1.12b">\begin{multlined}\ell_{cka}=\\
\frac{1}{M}\sum_{n=1}^{M}-\log\left(\frac{e^{(CKA(a^{t}_{l_{i_{n}}},a^{t}_{g_{n}})}}{e^{(CKA(a^{t}_{l_{i_{n}}},a^{t}_{g_{n}}))}+e^{(CKA(a^{t}_{l_{i_{n}}},a^{t-1}_{l_{i_{n}}}))}}\right)\end{multlined}\ell_{cka}=\\
\frac{1}{M}\sum_{n=1}^{M}-\log\left(\frac{e^{(CKA(a^{t}_{l_{i_{n}}},a^{t}_{g_{n}})}}{e^{(CKA(a^{t}_{l_{i_{n}}},a^{t}_{g_{n}}))}+e^{(CKA(a^{t}_{l_{i_{n}}},a^{t-1}_{l_{i_{n}}}))}}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p5" class="ltx_para ltx_noindent">
<p id="S3.SS3.p5.3" class="ltx_p">As per <cite class="ltx_cite ltx_citemacro_citet">Kornblith et al. (<a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite>, CKA is shown in Eq <a href="#S3.E3" title="In 3.3 Modifications to FedAvg ‣ 3 FedCKA ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Here, the <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><msup id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><mi id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml">i</mi><mrow id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3.cmml"><mi id="S3.SS3.p5.1.m1.1.1.3.2" xref="S3.SS3.p5.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.1.3.1" xref="S3.SS3.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.1.m1.1.1.3.3" xref="S3.SS3.p5.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2">𝑖</ci><apply id="S3.SS3.p5.1.m1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3"><times id="S3.SS3.p5.1.m1.1.1.3.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3.1"></times><ci id="S3.SS3.p5.1.m1.1.1.3.2.cmml" xref="S3.SS3.p5.1.m1.1.1.3.2">𝑡</ci><ci id="S3.SS3.p5.1.m1.1.1.3.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">i^{th}</annotation></semantics></math> eigenvalue of <math id="S3.SS3.p5.2.m2.1" class="ltx_Math" alttext="XX^{T}" display="inline"><semantics id="S3.SS3.p5.2.m2.1a"><mrow id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml"><mi id="S3.SS3.p5.2.m2.1.1.2" xref="S3.SS3.p5.2.m2.1.1.2.cmml">X</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.2.m2.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.cmml">​</mo><msup id="S3.SS3.p5.2.m2.1.1.3" xref="S3.SS3.p5.2.m2.1.1.3.cmml"><mi id="S3.SS3.p5.2.m2.1.1.3.2" xref="S3.SS3.p5.2.m2.1.1.3.2.cmml">X</mi><mi id="S3.SS3.p5.2.m2.1.1.3.3" xref="S3.SS3.p5.2.m2.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><apply id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1"><times id="S3.SS3.p5.2.m2.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1.1"></times><ci id="S3.SS3.p5.2.m2.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.2">𝑋</ci><apply id="S3.SS3.p5.2.m2.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.3.1.cmml" xref="S3.SS3.p5.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p5.2.m2.1.1.3.2.cmml" xref="S3.SS3.p5.2.m2.1.1.3.2">𝑋</ci><ci id="S3.SS3.p5.2.m2.1.1.3.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">XX^{T}</annotation></semantics></math> is <math id="S3.SS3.p5.3.m3.1" class="ltx_Math" alttext="\lambda^{i}_{X}" display="inline"><semantics id="S3.SS3.p5.3.m3.1a"><msubsup id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml"><mi id="S3.SS3.p5.3.m3.1.1.2.2" xref="S3.SS3.p5.3.m3.1.1.2.2.cmml">λ</mi><mi id="S3.SS3.p5.3.m3.1.1.3" xref="S3.SS3.p5.3.m3.1.1.3.cmml">X</mi><mi id="S3.SS3.p5.3.m3.1.1.2.3" xref="S3.SS3.p5.3.m3.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><apply id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.p5.3.m3.1.1.2.cmml" xref="S3.SS3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.2.1.cmml" xref="S3.SS3.p5.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.p5.3.m3.1.1.2.2.cmml" xref="S3.SS3.p5.3.m3.1.1.2.2">𝜆</ci><ci id="S3.SS3.p5.3.m3.1.1.2.3.cmml" xref="S3.SS3.p5.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.p5.3.m3.1.1.3.cmml" xref="S3.SS3.p5.3.m3.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">\lambda^{i}_{X}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.20" class="ltx_Math" alttext="\begin{multlined}CKA(XX^{T},YY^{T})=\frac{\left\|Y^{T}X\right\|^{2}_{F}}{\left\|X^{T}X\right\|_{F}\left\|Y^{T}Y\right\|_{F}}\\
=\frac{\sum_{i=1}^{p1}\sum_{j=1}^{p2}\lambda^{i}_{X}\lambda^{i}_{Y}\left\langle\textbf{u}^{i}_{X},\textbf{u}^{j}_{Y}\right\rangle^{2}}{\sqrt{\sum_{i=1}^{p1}(\lambda^{i}_{X})^{2}}\sqrt{\sum_{j=1}^{p2}(\lambda^{j}_{Y})^{2}}}\end{multlined}CKA(XX^{T},YY^{T})=\frac{\left\|Y^{T}X\right\|^{2}_{F}}{\left\|X^{T}X\right\|_{F}\left\|Y^{T}Y\right\|_{F}}\\
=\frac{\sum_{i=1}^{p1}\sum_{j=1}^{p2}\lambda^{i}_{X}\lambda^{i}_{Y}\left\langle\textbf{u}^{i}_{X},\textbf{u}^{j}_{Y}\right\rangle^{2}}{\sqrt{\sum_{i=1}^{p1}(\lambda^{i}_{X})^{2}}\sqrt{\sum_{j=1}^{p2}(\lambda^{j}_{Y})^{2}}}" display="block"><semantics id="S3.E3.m1.20a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E3.m1.20.20.4" xref="S3.E3.m1.18.18.2.cmml"><mtr id="S3.E3.m1.20.20.4a" xref="S3.E3.m1.18.18.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.20.20.4b" xref="S3.E3.m1.18.18.2.cmml"><mrow id="S3.E3.m1.20.20.4.18.16.16" xref="S3.E3.m1.18.18.2.cmml"><mrow id="S3.E3.m1.20.20.4.18.16.16.16" xref="S3.E3.m1.18.18.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.20.20.4.18.16.16.16.3" xref="S3.E3.m1.18.18.2a.cmml">​</mo><mi id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.20.20.4.18.16.16.16.3a" xref="S3.E3.m1.18.18.2a.cmml">​</mo><mi id="S3.E3.m1.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.20.20.4.18.16.16.16.3b" xref="S3.E3.m1.18.18.2a.cmml">​</mo><mrow id="S3.E3.m1.20.20.4.18.16.16.16.2.2" xref="S3.E3.m1.18.18.2.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.4.4.4.4" xref="S3.E3.m1.18.18.2a.cmml">(</mo><mrow id="S3.E3.m1.19.19.3.17.15.15.15.1.1.1" xref="S3.E3.m1.18.18.2.cmml"><mi id="S3.E3.m1.5.5.5.5.5.5" xref="S3.E3.m1.5.5.5.5.5.5.cmml">X</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.19.19.3.17.15.15.15.1.1.1.1" xref="S3.E3.m1.18.18.2a.cmml">​</mo><msup id="S3.E3.m1.19.19.3.17.15.15.15.1.1.1.2" xref="S3.E3.m1.18.18.2.cmml"><mi id="S3.E3.m1.6.6.6.6.6.6" xref="S3.E3.m1.6.6.6.6.6.6.cmml">X</mi><mi id="S3.E3.m1.7.7.7.7.7.7.1" xref="S3.E3.m1.7.7.7.7.7.7.1.cmml">T</mi></msup></mrow><mo id="S3.E3.m1.8.8.8.8.8.8" xref="S3.E3.m1.18.18.2a.cmml">,</mo><mrow id="S3.E3.m1.20.20.4.18.16.16.16.2.2.2" xref="S3.E3.m1.18.18.2.cmml"><mi id="S3.E3.m1.9.9.9.9.9.9" xref="S3.E3.m1.9.9.9.9.9.9.cmml">Y</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.20.20.4.18.16.16.16.2.2.2.1" xref="S3.E3.m1.18.18.2a.cmml">​</mo><msup id="S3.E3.m1.20.20.4.18.16.16.16.2.2.2.2" xref="S3.E3.m1.18.18.2.cmml"><mi id="S3.E3.m1.10.10.10.10.10.10" xref="S3.E3.m1.10.10.10.10.10.10.cmml">Y</mi><mi id="S3.E3.m1.11.11.11.11.11.11.1" xref="S3.E3.m1.11.11.11.11.11.11.1.cmml">T</mi></msup></mrow><mo stretchy="false" id="S3.E3.m1.12.12.12.12.12.12" xref="S3.E3.m1.18.18.2a.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.13.13.13.13.13.13" xref="S3.E3.m1.13.13.13.13.13.13.cmml">=</mo><mfrac id="S3.E3.m1.14.14.14.14.14.14" xref="S3.E3.m1.14.14.14.14.14.14.cmml"><msubsup id="S3.E3.m1.14.14.14.14.14.14.1" xref="S3.E3.m1.14.14.14.14.14.14.1.cmml"><mrow id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.2.cmml"><mo id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.2" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.cmml"><msup id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2.2" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.cmml">Y</mi><mi id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2.3" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.1" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.3" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.3" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.E3.m1.14.14.14.14.14.14.1.3" xref="S3.E3.m1.14.14.14.14.14.14.1.3.cmml">F</mi><mn id="S3.E3.m1.14.14.14.14.14.14.1.1.3" xref="S3.E3.m1.14.14.14.14.14.14.1.1.3.cmml">2</mn></msubsup><mrow id="S3.E3.m1.14.14.14.14.14.14.3" xref="S3.E3.m1.14.14.14.14.14.14.3.cmml"><msub id="S3.E3.m1.14.14.14.14.14.14.2.1" xref="S3.E3.m1.14.14.14.14.14.14.2.1.cmml"><mrow id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.2.cmml"><mo id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.2" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.2.1.cmml">‖</mo><mrow id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.cmml"><msup id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2.cmml"><mi id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2.2" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2.2.cmml">X</mi><mi id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2.3" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.1" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.1.cmml">​</mo><mi id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.3" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.3" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.E3.m1.14.14.14.14.14.14.2.1.3" xref="S3.E3.m1.14.14.14.14.14.14.2.1.3.cmml">F</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.14.14.14.14.14.14.3.3" xref="S3.E3.m1.14.14.14.14.14.14.3.3.cmml">​</mo><msub id="S3.E3.m1.14.14.14.14.14.14.3.2" xref="S3.E3.m1.14.14.14.14.14.14.3.2.cmml"><mrow id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.2.cmml"><mo id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.2" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.2.1.cmml">‖</mo><mrow id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.cmml"><msup id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2.cmml"><mi id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2.2" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2.2.cmml">Y</mi><mi id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2.3" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.1" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.1.cmml">​</mo><mi id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.3" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.3.cmml">Y</mi></mrow><mo id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.3" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.2.1.cmml">‖</mo></mrow><mi id="S3.E3.m1.14.14.14.14.14.14.3.2.3" xref="S3.E3.m1.14.14.14.14.14.14.3.2.3.cmml">F</mi></msub></mrow></mfrac></mrow></mtd></mtr><mtr id="S3.E3.m1.20.20.4c" xref="S3.E3.m1.18.18.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.20.20.4d" xref="S3.E3.m1.18.18.2.cmml"><mrow id="S3.E3.m1.16.16.16.2.2" xref="S3.E3.m1.18.18.2.cmml"><mi id="S3.E3.m1.16.16.16.2.2.3" xref="S3.E3.m1.18.18.2a.cmml"></mi><mo id="S3.E3.m1.15.15.15.1.1.1" xref="S3.E3.m1.15.15.15.1.1.1.cmml">=</mo><mfrac id="S3.E3.m1.16.16.16.2.2.2" xref="S3.E3.m1.16.16.16.2.2.2.cmml"><mrow id="S3.E3.m1.16.16.16.2.2.2.2" xref="S3.E3.m1.16.16.16.2.2.2.2.cmml"><msubsup id="S3.E3.m1.16.16.16.2.2.2.2.3" xref="S3.E3.m1.16.16.16.2.2.2.2.3.cmml"><mo id="S3.E3.m1.16.16.16.2.2.2.2.3.2.2" xref="S3.E3.m1.16.16.16.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.16.16.16.2.2.2.2.3.2.3" xref="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.cmml"><mi id="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.2" xref="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.1" xref="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.3" xref="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S3.E3.m1.16.16.16.2.2.2.2.3.3" xref="S3.E3.m1.16.16.16.2.2.2.2.3.3.cmml"><mi id="S3.E3.m1.16.16.16.2.2.2.2.3.3.2" xref="S3.E3.m1.16.16.16.2.2.2.2.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.16.16.16.2.2.2.2.3.3.1" xref="S3.E3.m1.16.16.16.2.2.2.2.3.3.1.cmml">​</mo><mn id="S3.E3.m1.16.16.16.2.2.2.2.3.3.3" xref="S3.E3.m1.16.16.16.2.2.2.2.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.E3.m1.16.16.16.2.2.2.2.2" xref="S3.E3.m1.16.16.16.2.2.2.2.2.cmml"><msubsup id="S3.E3.m1.16.16.16.2.2.2.2.2.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.cmml"><mo lspace="0.167em" id="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.2" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.cmml"><mi id="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.2" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.2.cmml">j</mi><mo id="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.1" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S3.E3.m1.16.16.16.2.2.2.2.2.3.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.cmml"><mi id="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.2" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.1" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.1.cmml">​</mo><mn id="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.3.cmml">2</mn></mrow></msubsup><mrow id="S3.E3.m1.16.16.16.2.2.2.2.2.2" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.cmml"><msubsup id="S3.E3.m1.16.16.16.2.2.2.2.2.2.4" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.cmml"><mi id="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.2.2" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.2.2.cmml">λ</mi><mi id="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.3.cmml">X</mi><mi id="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.2.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.2.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.16.16.16.2.2.2.2.2.2.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.3.cmml">​</mo><msubsup id="S3.E3.m1.16.16.16.2.2.2.2.2.2.5" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.cmml"><mi id="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.2.2" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.2.2.cmml">λ</mi><mi id="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.3.cmml">Y</mi><mi id="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.2.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.2.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.16.16.16.2.2.2.2.2.2.3a" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.3.cmml">​</mo><msup id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.cmml"><mrow id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.3.cmml"><mo id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.3.cmml">⟨</mo><msubsup id="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.2.2a.cmml">u</mtext><mi id="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.3.cmml">X</mi><mi id="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.4" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.2.2" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.2.2a.cmml">u</mtext><mi id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.3.cmml">Y</mi><mi id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.2.3" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.2.3.cmml">j</mi></msubsup><mo id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.5" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.3.cmml">⟩</mo></mrow><mn id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.4" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.4.cmml">2</mn></msup></mrow></mrow></mrow><mrow id="S3.E3.m1.16.16.16.2.2.2.4" xref="S3.E3.m1.16.16.16.2.2.2.4.cmml"><msqrt id="S3.E3.m1.16.16.16.2.2.2.3.1" xref="S3.E3.m1.16.16.16.2.2.2.3.1.cmml"><mrow id="S3.E3.m1.16.16.16.2.2.2.3.1.1" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.cmml"><msubsup id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.cmml"><mo id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.2" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.cmml"><mi id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.2" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.1" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.3" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.cmml"><mi id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.2" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.1" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.1.cmml">​</mo><mn id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.3" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.3.cmml">1</mn></mrow></msubsup><msup id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.cmml"><mrow id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.cmml"><mo lspace="0em" stretchy="false" id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.2" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.2.2" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.2.2.cmml">λ</mi><mi id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.3" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.3.cmml">X</mi><mi id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.2.3" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.3" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.3" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.3.cmml">2</mn></msup></mrow></msqrt><mo lspace="0em" rspace="0em" id="S3.E3.m1.16.16.16.2.2.2.4.3" xref="S3.E3.m1.16.16.16.2.2.2.4.3.cmml">​</mo><msqrt id="S3.E3.m1.16.16.16.2.2.2.4.2" xref="S3.E3.m1.16.16.16.2.2.2.4.2.cmml"><mrow id="S3.E3.m1.16.16.16.2.2.2.4.2.1" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.cmml"><msubsup id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.cmml"><mo id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.2" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.cmml"><mi id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.2" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.2.cmml">j</mi><mo id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.1" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.3" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.cmml"><mi id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.2" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.1" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.1.cmml">​</mo><mn id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.3" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.3.cmml">2</mn></mrow></msubsup><msup id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.cmml"><mrow id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.cmml"><mo lspace="0em" stretchy="false" id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.2" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.cmml"><mi id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.2.2" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.2.2.cmml">λ</mi><mi id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.3" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.3.cmml">Y</mi><mi id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.2.3" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.2.3.cmml">j</mi></msubsup><mo stretchy="false" id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.3" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.3" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.3.cmml">2</mn></msup></mrow></msqrt></mrow></mfrac></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E3.m1.20b"><apply id="S3.E3.m1.18.18.2.cmml" xref="S3.E3.m1.20.20.4"><and id="S3.E3.m1.18.18.2a.cmml" xref="S3.E3.m1.20.20.4.18.16.16.16.3"></and><apply id="S3.E3.m1.18.18.2b.cmml" xref="S3.E3.m1.20.20.4"><eq id="S3.E3.m1.13.13.13.13.13.13.cmml" xref="S3.E3.m1.13.13.13.13.13.13"></eq><apply id="S3.E3.m1.18.18.2.2.cmml" xref="S3.E3.m1.20.20.4"><times id="S3.E3.m1.18.18.2.2.3.cmml" xref="S3.E3.m1.20.20.4.18.16.16.16.3"></times><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">𝐶</ci><ci id="S3.E3.m1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2">𝐾</ci><ci id="S3.E3.m1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3">𝐴</ci><interval closure="open" id="S3.E3.m1.18.18.2.2.2.3.cmml" xref="S3.E3.m1.20.20.4"><apply id="S3.E3.m1.17.17.1.1.1.1.1.cmml" xref="S3.E3.m1.20.20.4"><times id="S3.E3.m1.17.17.1.1.1.1.1.1.cmml" xref="S3.E3.m1.20.20.4"></times><ci id="S3.E3.m1.5.5.5.5.5.5.cmml" xref="S3.E3.m1.5.5.5.5.5.5">𝑋</ci><apply id="S3.E3.m1.17.17.1.1.1.1.1.3.cmml" xref="S3.E3.m1.20.20.4"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.20.20.4">superscript</csymbol><ci id="S3.E3.m1.6.6.6.6.6.6.cmml" xref="S3.E3.m1.6.6.6.6.6.6">𝑋</ci><ci id="S3.E3.m1.7.7.7.7.7.7.1.cmml" xref="S3.E3.m1.7.7.7.7.7.7.1">𝑇</ci></apply></apply><apply id="S3.E3.m1.18.18.2.2.2.2.2.cmml" xref="S3.E3.m1.20.20.4"><times id="S3.E3.m1.18.18.2.2.2.2.2.1.cmml" xref="S3.E3.m1.20.20.4"></times><ci id="S3.E3.m1.9.9.9.9.9.9.cmml" xref="S3.E3.m1.9.9.9.9.9.9">𝑌</ci><apply id="S3.E3.m1.18.18.2.2.2.2.2.3.cmml" xref="S3.E3.m1.20.20.4"><csymbol cd="ambiguous" id="S3.E3.m1.18.18.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.20.20.4">superscript</csymbol><ci id="S3.E3.m1.10.10.10.10.10.10.cmml" xref="S3.E3.m1.10.10.10.10.10.10">𝑌</ci><ci id="S3.E3.m1.11.11.11.11.11.11.1.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1">𝑇</ci></apply></apply></interval></apply><apply id="S3.E3.m1.14.14.14.14.14.14.cmml" xref="S3.E3.m1.14.14.14.14.14.14"><divide id="S3.E3.m1.14.14.14.14.14.14.4.cmml" xref="S3.E3.m1.14.14.14.14.14.14"></divide><apply id="S3.E3.m1.14.14.14.14.14.14.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1"><csymbol cd="ambiguous" id="S3.E3.m1.14.14.14.14.14.14.1.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1">subscript</csymbol><apply id="S3.E3.m1.14.14.14.14.14.14.1.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1"><csymbol cd="ambiguous" id="S3.E3.m1.14.14.14.14.14.14.1.1.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1">superscript</csymbol><apply id="S3.E3.m1.14.14.14.14.14.14.1.1.1.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.14.14.14.14.14.14.1.1.1.2.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.2">norm</csymbol><apply id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1"><times id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.1"></times><apply id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2.2">𝑌</ci><ci id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.1.1.1.1.3">𝑋</ci></apply></apply><cn type="integer" id="S3.E3.m1.14.14.14.14.14.14.1.1.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.1.3">2</cn></apply><ci id="S3.E3.m1.14.14.14.14.14.14.1.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.3">𝐹</ci></apply><apply id="S3.E3.m1.14.14.14.14.14.14.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3"><times id="S3.E3.m1.14.14.14.14.14.14.3.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.3"></times><apply id="S3.E3.m1.14.14.14.14.14.14.2.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.14.14.14.14.14.14.2.1.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.2.1">subscript</csymbol><apply id="S3.E3.m1.14.14.14.14.14.14.2.1.1.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.14.14.14.14.14.14.2.1.1.2.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.2">norm</csymbol><apply id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1"><times id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.1"></times><apply id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2.2">𝑋</ci><ci id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.2.3">𝑇</ci></apply><ci id="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.2.1.1.1.1.3">𝑋</ci></apply></apply><ci id="S3.E3.m1.14.14.14.14.14.14.2.1.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.2.1.3">𝐹</ci></apply><apply id="S3.E3.m1.14.14.14.14.14.14.3.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.14.14.14.14.14.14.3.2.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.2">subscript</csymbol><apply id="S3.E3.m1.14.14.14.14.14.14.3.2.1.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1"><csymbol cd="latexml" id="S3.E3.m1.14.14.14.14.14.14.3.2.1.2.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.2">norm</csymbol><apply id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1"><times id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.1"></times><apply id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2.2">𝑌</ci><ci id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.2.3">𝑇</ci></apply><ci id="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.2.1.1.1.3">𝑌</ci></apply></apply><ci id="S3.E3.m1.14.14.14.14.14.14.3.2.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.3.2.3">𝐹</ci></apply></apply></apply></apply><apply id="S3.E3.m1.18.18.2c.cmml" xref="S3.E3.m1.20.20.4"><eq id="S3.E3.m1.15.15.15.1.1.1.cmml" xref="S3.E3.m1.15.15.15.1.1.1"></eq><share href="#S3.E3.m1.18.18.2.5.cmml" id="S3.E3.m1.18.18.2d.cmml" xref="S3.E3.m1.20.20.4.18.16.16.16.3"></share><apply id="S3.E3.m1.16.16.16.2.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2"><divide id="S3.E3.m1.16.16.16.2.2.2.5.cmml" xref="S3.E3.m1.16.16.16.2.2.2"></divide><apply id="S3.E3.m1.16.16.16.2.2.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2"><apply id="S3.E3.m1.16.16.16.2.2.2.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.2.3.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3">superscript</csymbol><apply id="S3.E3.m1.16.16.16.2.2.2.2.3.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.2.3.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3">subscript</csymbol><sum id="S3.E3.m1.16.16.16.2.2.2.2.3.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3.2.2"></sum><apply id="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3.2.3"><eq id="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.1"></eq><ci id="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.16.16.16.2.2.2.2.3.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3.3"><times id="S3.E3.m1.16.16.16.2.2.2.2.3.3.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3.3.1"></times><ci id="S3.E3.m1.16.16.16.2.2.2.2.3.3.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3.3.2">𝑝</ci><cn type="integer" id="S3.E3.m1.16.16.16.2.2.2.2.3.3.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.3.3.3">1</cn></apply></apply><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2"><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3">superscript</csymbol><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3">subscript</csymbol><sum id="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.2"></sum><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3"><eq id="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.1"></eq><ci id="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.2">𝑗</ci><cn type="integer" id="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.3"><times id="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.1"></times><ci id="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.2">𝑝</ci><cn type="integer" id="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.3.3.3">2</cn></apply></apply><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2"><times id="S3.E3.m1.16.16.16.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.3"></times><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.4">subscript</csymbol><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.4">superscript</csymbol><ci id="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.2.2">𝜆</ci><ci id="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.2.3">𝑖</ci></apply><ci id="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.4.3">𝑋</ci></apply><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.5"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.5">subscript</csymbol><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.5"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.5">superscript</csymbol><ci id="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.2.2">𝜆</ci><ci id="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.2.3">𝑖</ci></apply><ci id="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.5.3">𝑌</ci></apply><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2">superscript</csymbol><list id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2"><apply id="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.2.2">u</mtext></ci><ci id="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.1.1.1.1.1.1.1.3">𝑋</ci></apply><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.2.2a.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.2.2">u</mtext></ci><ci id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.2.2.2.3">𝑌</ci></apply></list><cn type="integer" id="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.4.cmml" xref="S3.E3.m1.16.16.16.2.2.2.2.2.2.2.4">2</cn></apply></apply></apply></apply><apply id="S3.E3.m1.16.16.16.2.2.2.4.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4"><times id="S3.E3.m1.16.16.16.2.2.2.4.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.3"></times><apply id="S3.E3.m1.16.16.16.2.2.2.3.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1"><root id="S3.E3.m1.16.16.16.2.2.2.3.1a.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1"></root><apply id="S3.E3.m1.16.16.16.2.2.2.3.1.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1"><apply id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2">superscript</csymbol><apply id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2">subscript</csymbol><sum id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.2"></sum><apply id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3"><eq id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.1"></eq><ci id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3"><times id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.1"></times><ci id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.2">𝑝</ci><cn type="integer" id="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1">superscript</csymbol><apply id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.2.2">𝜆</ci><ci id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.1.1.1.3">𝑋</ci></apply><cn type="integer" id="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.3.1.1.1.3">2</cn></apply></apply></apply><apply id="S3.E3.m1.16.16.16.2.2.2.4.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2"><root id="S3.E3.m1.16.16.16.2.2.2.4.2a.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2"></root><apply id="S3.E3.m1.16.16.16.2.2.2.4.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1"><apply id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2">superscript</csymbol><apply id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2">subscript</csymbol><sum id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.2"></sum><apply id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3"><eq id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.1"></eq><ci id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3"><times id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.1"></times><ci id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.2">𝑝</ci><cn type="integer" id="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.2.3.3">2</cn></apply></apply><apply id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1">superscript</csymbol><apply id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.2.2">𝜆</ci><ci id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.1.1.1.3">𝑌</ci></apply><cn type="integer" id="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.3.cmml" xref="S3.E3.m1.16.16.16.2.2.2.4.2.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.20c">\begin{multlined}CKA(XX^{T},YY^{T})=\frac{\left\|Y^{T}X\right\|^{2}_{F}}{\left\|X^{T}X\right\|_{F}\left\|Y^{T}Y\right\|_{F}}\\
=\frac{\sum_{i=1}^{p1}\sum_{j=1}^{p2}\lambda^{i}_{X}\lambda^{i}_{Y}\left\langle\textbf{u}^{i}_{X},\textbf{u}^{j}_{Y}\right\rangle^{2}}{\sqrt{\sum_{i=1}^{p1}(\lambda^{i}_{X})^{2}}\sqrt{\sum_{j=1}^{p2}(\lambda^{j}_{Y})^{2}}}\end{multlined}CKA(XX^{T},YY^{T})=\frac{\left\|Y^{T}X\right\|^{2}_{F}}{\left\|X^{T}X\right\|_{F}\left\|Y^{T}Y\right\|_{F}}\\
=\frac{\sum_{i=1}^{p1}\sum_{j=1}^{p2}\lambda^{i}_{X}\lambda^{i}_{Y}\left\langle\textbf{u}^{i}_{X},\textbf{u}^{j}_{Y}\right\rangle^{2}}{\sqrt{\sum_{i=1}^{p1}(\lambda^{i}_{X})^{2}}\sqrt{\sum_{j=1}^{p2}(\lambda^{j}_{Y})^{2}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p7" class="ltx_para ltx_noindent">
<p id="S3.SS3.p7.1" class="ltx_p">While <cite class="ltx_cite ltx_citemacro_citet">Kornblith et al. (<a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite> also presented a method to use kernels with CKA, we use the linear variant, as it is more computationally efficient, while having minimal impact on accuracy.</p>
</div>
<figure id="S3.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2112.00407/assets/images/dist_beta50.png" id="S3.F4.sf1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="698" height="595" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span><math id="S3.F4.sf1.2.m1.1" class="ltx_Math" alttext="\alpha=5.0" display="inline"><semantics id="S3.F4.sf1.2.m1.1b"><mrow id="S3.F4.sf1.2.m1.1.1" xref="S3.F4.sf1.2.m1.1.1.cmml"><mi id="S3.F4.sf1.2.m1.1.1.2" xref="S3.F4.sf1.2.m1.1.1.2.cmml">α</mi><mo id="S3.F4.sf1.2.m1.1.1.1" xref="S3.F4.sf1.2.m1.1.1.1.cmml">=</mo><mn id="S3.F4.sf1.2.m1.1.1.3" xref="S3.F4.sf1.2.m1.1.1.3.cmml">5.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.sf1.2.m1.1c"><apply id="S3.F4.sf1.2.m1.1.1.cmml" xref="S3.F4.sf1.2.m1.1.1"><eq id="S3.F4.sf1.2.m1.1.1.1.cmml" xref="S3.F4.sf1.2.m1.1.1.1"></eq><ci id="S3.F4.sf1.2.m1.1.1.2.cmml" xref="S3.F4.sf1.2.m1.1.1.2">𝛼</ci><cn type="float" id="S3.F4.sf1.2.m1.1.1.3.cmml" xref="S3.F4.sf1.2.m1.1.1.3">5.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.sf1.2.m1.1d">\alpha=5.0</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2112.00407/assets/images/dist_beta05.png" id="S3.F4.sf2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="698" height="600" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span><math id="S3.F4.sf2.2.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S3.F4.sf2.2.m1.1b"><mrow id="S3.F4.sf2.2.m1.1.1" xref="S3.F4.sf2.2.m1.1.1.cmml"><mi id="S3.F4.sf2.2.m1.1.1.2" xref="S3.F4.sf2.2.m1.1.1.2.cmml">α</mi><mo id="S3.F4.sf2.2.m1.1.1.1" xref="S3.F4.sf2.2.m1.1.1.1.cmml">=</mo><mn id="S3.F4.sf2.2.m1.1.1.3" xref="S3.F4.sf2.2.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.sf2.2.m1.1c"><apply id="S3.F4.sf2.2.m1.1.1.cmml" xref="S3.F4.sf2.2.m1.1.1"><eq id="S3.F4.sf2.2.m1.1.1.1.cmml" xref="S3.F4.sf2.2.m1.1.1.1"></eq><ci id="S3.F4.sf2.2.m1.1.1.2.cmml" xref="S3.F4.sf2.2.m1.1.1.2">𝛼</ci><cn type="float" id="S3.F4.sf2.2.m1.1.1.3.cmml" xref="S3.F4.sf2.2.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.sf2.2.m1.1d">\alpha=0.5</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F4.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2112.00407/assets/images/dist_beta01.png" id="S3.F4.sf3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="698" height="590" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span><math id="S3.F4.sf3.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S3.F4.sf3.2.m1.1b"><mrow id="S3.F4.sf3.2.m1.1.1" xref="S3.F4.sf3.2.m1.1.1.cmml"><mi id="S3.F4.sf3.2.m1.1.1.2" xref="S3.F4.sf3.2.m1.1.1.2.cmml">α</mi><mo id="S3.F4.sf3.2.m1.1.1.1" xref="S3.F4.sf3.2.m1.1.1.1.cmml">=</mo><mn id="S3.F4.sf3.2.m1.1.1.3" xref="S3.F4.sf3.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.sf3.2.m1.1c"><apply id="S3.F4.sf3.2.m1.1.1.cmml" xref="S3.F4.sf3.2.m1.1.1"><eq id="S3.F4.sf3.2.m1.1.1.1.cmml" xref="S3.F4.sf3.2.m1.1.1.1"></eq><ci id="S3.F4.sf3.2.m1.1.1.2.cmml" xref="S3.F4.sf3.2.m1.1.1.2">𝛼</ci><cn type="float" id="S3.F4.sf3.2.m1.1.1.3.cmml" xref="S3.F4.sf3.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.sf3.2.m1.1d">\alpha=0.1</annotation></semantics></math></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Distribution of the CIFAR-10 dataset across 10 clients according to the Dirichlet distribution. The x-axis shows the index of the client, and the y-axis shows the index of the class (label). As the parameter <math id="S3.F4.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.F4.2.m1.1b"><mi id="S3.F4.2.m1.1.1" xref="S3.F4.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.F4.2.m1.1c"><ci id="S3.F4.2.m1.1.1.cmml" xref="S3.F4.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.2.m1.1d">\alpha</annotation></semantics></math> approaches 0, there the heterogeneity of class distribution increases.</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Results and Analysis</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experiment Setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We compare FedCKA with the current state-of-the-art, MOON <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>, as well as FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib16" title="" class="ltx_ref">2017</a>)</cite>, FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite>, and SCAFFOLD <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al. <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>.
We purposefully use a similar experimental setup to MOON, both because it is the most recent work, and also reports the highest performance. In particular, the CIFAR-10, CIFAR-100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky <a href="#bib.bib10" title="" class="ltx_ref">2009</a>)</cite>, and Tiny ImageNet <cite class="ltx_cite ltx_citemacro_citep">(Li, Karpathy, and Johnson <a href="#bib.bib12" title="" class="ltx_ref">2014</a>)</cite> datasets are used to test the performance of all methods.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">For CIFAR-10, we use a small Convolutional Neural Network. Two 5x5 convolutional layers are the base encoder, with 16 and 32 channels respectively, and two 2x2 max-pooling layers following each convolutional layer. A projection head of four fully connected layers follow the encoder, with 120, 84, 84, and 256 neurons. The final layer is the output layer with the number of classes. Although FedCKA and other works can perform without this projection head, we include it because MOON shows a high discrepancy in performance without it.
For CIFAR-100 and Tiny ImageNet, we use ResNet-50 <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a href="#bib.bib4" title="" class="ltx_ref">2016</a>)</cite>. We also add the projection head before the output layer, as per MOON.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">We use the cross entropy loss, and SGD as our optimizer with a learning rate of 0.1, momentum of 0.9, and weight decay of 0.00001. Local epochs are set to 10. These are also the parameters used in MOON. Some small changes we made were with the batch size and communication rounds. We use a constant 128 for the batch size, and train for 100 communication rounds on CIFAR-10, and 40 communication rounds on CIFAR-100, and 20 communication rounds on Tiny ImageNet. We use a lower number of communication rounds for the latter two datasets, because the ResNet-50 model over-fit quite quickly.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.5" class="ltx_p">As with many previous works, we use the Dirichlet distribution to simulate heterogeneous settings <cite class="ltx_cite ltx_citemacro_citep">(Hsu, Qi, and Brown <a href="#bib.bib6" title="" class="ltx_ref">2019b</a>; Lin et al. <a href="#bib.bib15" title="" class="ltx_ref">2021</a>; Li, He, and Song <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>. The <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mi id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><ci id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">\alpha</annotation></semantics></math> parameter controls the strength of heterogeneity, with <math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="\alpha=0" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><mrow id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><mi id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml">α</mi><mo id="S4.SS1.p4.2.m2.1.1.1" xref="S4.SS1.p4.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.2.m2.1.1.3" xref="S4.SS1.p4.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><apply id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1"><eq id="S4.SS1.p4.2.m2.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1"></eq><ci id="S4.SS1.p4.2.m2.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2">𝛼</ci><cn type="integer" id="S4.SS1.p4.2.m2.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">\alpha=0</annotation></semantics></math> being most heterogeneous, and <math id="S4.SS1.p4.3.m3.1" class="ltx_Math" alttext="\alpha=\infty" display="inline"><semantics id="S4.SS1.p4.3.m3.1a"><mrow id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mi id="S4.SS1.p4.3.m3.1.1.2" xref="S4.SS1.p4.3.m3.1.1.2.cmml">α</mi><mo id="S4.SS1.p4.3.m3.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><eq id="S4.SS1.p4.3.m3.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1"></eq><ci id="S4.SS1.p4.3.m3.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2">𝛼</ci><infinity id="S4.SS1.p4.3.m3.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">\alpha=\infty</annotation></semantics></math> being non-heterogeneous. We report results for <math id="S4.SS1.p4.4.m4.3" class="ltx_Math" alttext="\alpha\in[5.0,0.5,0.1]" display="inline"><semantics id="S4.SS1.p4.4.m4.3a"><mrow id="S4.SS1.p4.4.m4.3.4" xref="S4.SS1.p4.4.m4.3.4.cmml"><mi id="S4.SS1.p4.4.m4.3.4.2" xref="S4.SS1.p4.4.m4.3.4.2.cmml">α</mi><mo id="S4.SS1.p4.4.m4.3.4.1" xref="S4.SS1.p4.4.m4.3.4.1.cmml">∈</mo><mrow id="S4.SS1.p4.4.m4.3.4.3.2" xref="S4.SS1.p4.4.m4.3.4.3.1.cmml"><mo stretchy="false" id="S4.SS1.p4.4.m4.3.4.3.2.1" xref="S4.SS1.p4.4.m4.3.4.3.1.cmml">[</mo><mn id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">5.0</mn><mo id="S4.SS1.p4.4.m4.3.4.3.2.2" xref="S4.SS1.p4.4.m4.3.4.3.1.cmml">,</mo><mn id="S4.SS1.p4.4.m4.2.2" xref="S4.SS1.p4.4.m4.2.2.cmml">0.5</mn><mo id="S4.SS1.p4.4.m4.3.4.3.2.3" xref="S4.SS1.p4.4.m4.3.4.3.1.cmml">,</mo><mn id="S4.SS1.p4.4.m4.3.3" xref="S4.SS1.p4.4.m4.3.3.cmml">0.1</mn><mo stretchy="false" id="S4.SS1.p4.4.m4.3.4.3.2.4" xref="S4.SS1.p4.4.m4.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.3b"><apply id="S4.SS1.p4.4.m4.3.4.cmml" xref="S4.SS1.p4.4.m4.3.4"><in id="S4.SS1.p4.4.m4.3.4.1.cmml" xref="S4.SS1.p4.4.m4.3.4.1"></in><ci id="S4.SS1.p4.4.m4.3.4.2.cmml" xref="S4.SS1.p4.4.m4.3.4.2">𝛼</ci><list id="S4.SS1.p4.4.m4.3.4.3.1.cmml" xref="S4.SS1.p4.4.m4.3.4.3.2"><cn type="float" id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">5.0</cn><cn type="float" id="S4.SS1.p4.4.m4.2.2.cmml" xref="S4.SS1.p4.4.m4.2.2">0.5</cn><cn type="float" id="S4.SS1.p4.4.m4.3.3.cmml" xref="S4.SS1.p4.4.m4.3.3">0.1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.3c">\alpha\in[5.0,0.5,0.1]</annotation></semantics></math>, similar to MOON. Figure <a href="#S3.F4" title="Figure 4 ‣ 3.3 Modifications to FedAvg ‣ 3 FedCKA ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the distribution of data across clients on the CIFAR-10 dataset with the different <math id="S4.SS1.p4.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p4.5.m5.1a"><mi id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b"><ci id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">\alpha</annotation></semantics></math>.
All experiments were conducted using the PyTorch <cite class="ltx_cite ltx_citemacro_citep">(Paszke et al. <a href="#bib.bib17" title="" class="ltx_ref">2019</a>)</cite> library on a single GTX Titan V and four Intel Xeon Gold 5115 processors.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Accuracy</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.8" class="ltx_p">FedCKA adds a hyperparameter <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mu</annotation></semantics></math> to control the strength of <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\ell_{cka}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><msub id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">ℓ</mi><mrow id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml"><mi id="S4.SS2.p1.2.m2.1.1.3.2" xref="S4.SS2.p1.2.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.2.m2.1.1.3.1" xref="S4.SS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.2.m2.1.1.3.3" xref="S4.SS2.p1.2.m2.1.1.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.2.m2.1.1.3.1a" xref="S4.SS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.2.m2.1.1.3.4" xref="S4.SS2.p1.2.m2.1.1.3.4.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">ℓ</ci><apply id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3"><times id="S4.SS2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.p1.2.m2.1.1.3.1"></times><ci id="S4.SS2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.p1.2.m2.1.1.3.2">𝑐</ci><ci id="S4.SS2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3.3">𝑘</ci><ci id="S4.SS2.p1.2.m2.1.1.3.4.cmml" xref="S4.SS2.p1.2.m2.1.1.3.4">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\ell_{cka}</annotation></semantics></math>. We tune <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\mu</annotation></semantics></math> from [3, 5, 10], and report the best results. MOON and FedProx also have a <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\mu</annotation></semantics></math> term. We also tune the hyperparameter <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\mu</annotation></semantics></math> with these methods. For MOON, we tune <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mi id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">\mu</annotation></semantics></math> from [0.1, 1, 5, 10] and for FedProx, we tune <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><mi id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><ci id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">\mu</annotation></semantics></math> from [0.001, 0.01, 0.1, 1], as used in each work. In addition, for MOON, we use <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="\tau=0.5" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><mrow id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml"><mi id="S4.SS2.p1.8.m8.1.1.2" xref="S4.SS2.p1.8.m8.1.1.2.cmml">τ</mi><mo id="S4.SS2.p1.8.m8.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.8.m8.1.1.3" xref="S4.SS2.p1.8.m8.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><apply id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1"><eq id="S4.SS2.p1.8.m8.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1"></eq><ci id="S4.SS2.p1.8.m8.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.2">𝜏</ci><cn type="float" id="S4.SS2.p1.8.m8.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">\tau=0.5</annotation></semantics></math> as reported in their work.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.3.1.1" class="ltx_tr">
<th id="S4.T1.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">Method</th>
<th id="S4.T1.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">CIFAR-10</th>
<th id="S4.T1.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">CIFAR-100</th>
<th id="S4.T1.3.1.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">
<table id="S4.T1.3.1.1.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.3.1.1.4.1.1" class="ltx_tr">
<td id="S4.T1.3.1.1.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">Tiny</td>
</tr>
<tr id="S4.T1.3.1.1.4.1.2" class="ltx_tr">
<td id="S4.T1.3.1.1.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">ImageNet</td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.3.2.1" class="ltx_tr">
<td id="S4.T1.3.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">FedAvg</td>
<td id="S4.T1.3.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">64.37%</td>
<td id="S4.T1.3.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">37.41%</td>
<td id="S4.T1.3.2.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">19.49%</td>
</tr>
<tr id="S4.T1.3.3.2" class="ltx_tr">
<td id="S4.T1.3.3.2.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">FedProx</td>
<td id="S4.T1.3.3.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">64.58%</td>
<td id="S4.T1.3.3.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">37.81%</td>
<td id="S4.T1.3.3.2.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">20.93%</td>
</tr>
<tr id="S4.T1.3.4.3" class="ltx_tr">
<td id="S4.T1.3.4.3.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">SCAFFOLD</td>
<td id="S4.T1.3.4.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">64.33%</td>
<td id="S4.T1.3.4.3.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">39.16%</td>
<td id="S4.T1.3.4.3.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">21.18%</td>
</tr>
<tr id="S4.T1.3.5.4" class="ltx_tr">
<td id="S4.T1.3.5.4.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">MOON</td>
<td id="S4.T1.3.5.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">65.25%</td>
<td id="S4.T1.3.5.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">38.37%</td>
<td id="S4.T1.3.5.4.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">21.29%</td>
</tr>
<tr id="S4.T1.3.6.5" class="ltx_tr">
<td id="S4.T1.3.6.5.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T1.3.6.5.1.1" class="ltx_text ltx_font_bold">FedCKA</span></td>
<td id="S4.T1.3.6.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T1.3.6.5.2.1" class="ltx_text ltx_font_bold">67.86%</span></td>
<td id="S4.T1.3.6.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T1.3.6.5.3.1" class="ltx_text ltx_font_bold">40.07%</span></td>
<td id="S4.T1.3.6.5.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T1.3.6.5.4.1" class="ltx_text ltx_font_bold">21.46%</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Accuracy across Datasets (<math id="S4.T1.2.m1.1" class="ltx_Math" alttext="\alpha=5.0" display="inline"><semantics id="S4.T1.2.m1.1b"><mrow id="S4.T1.2.m1.1.1" xref="S4.T1.2.m1.1.1.cmml"><mi id="S4.T1.2.m1.1.1.2" xref="S4.T1.2.m1.1.1.2.cmml">α</mi><mo id="S4.T1.2.m1.1.1.1" xref="S4.T1.2.m1.1.1.1.cmml">=</mo><mn id="S4.T1.2.m1.1.1.3" xref="S4.T1.2.m1.1.1.3.cmml">5.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.m1.1c"><apply id="S4.T1.2.m1.1.1.cmml" xref="S4.T1.2.m1.1.1"><eq id="S4.T1.2.m1.1.1.1.cmml" xref="S4.T1.2.m1.1.1.1"></eq><ci id="S4.T1.2.m1.1.1.2.cmml" xref="S4.T1.2.m1.1.1.2">𝛼</ci><cn type="float" id="S4.T1.2.m1.1.1.3.cmml" xref="S4.T1.2.m1.1.1.3">5.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.m1.1d">\alpha=5.0</annotation></semantics></math>)</figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.10" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4.2 Accuracy ‣ 4 Experimental Results and Analysis ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the performance across CIFAR-10, CIFAR-100, and Tiny ImageNet with <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\alpha=5.0" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">5.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></eq><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">5.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\alpha=5.0</annotation></semantics></math>. For FedProx, MOON, and FedCKA, we report performance with the best <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\mu</annotation></semantics></math>. For FedCKA, the best <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\mu</annotation></semantics></math> is 3, 10, and 3 for CIFAR-10, CIFAR-100, and Tiny ImageNet, respectively. For MOON, the best <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\mu</annotation></semantics></math> is 10, 5, and 0.1. For FedProx, the best <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mi id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><ci id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\mu</annotation></semantics></math> is 0.001, 0.1, and 0.1. Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Accuracy ‣ 4 Experimental Results and Analysis ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the performance across increasing heterogeneity on the CIFAR-10 dataset with <math id="S4.SS2.p2.6.m6.3" class="ltx_Math" alttext="\alpha\ \in\ [5.0,0.5,0.1]" display="inline"><semantics id="S4.SS2.p2.6.m6.3a"><mrow id="S4.SS2.p2.6.m6.3.4" xref="S4.SS2.p2.6.m6.3.4.cmml"><mi id="S4.SS2.p2.6.m6.3.4.2" xref="S4.SS2.p2.6.m6.3.4.2.cmml">α</mi><mo lspace="0.778em" rspace="0.778em" id="S4.SS2.p2.6.m6.3.4.1" xref="S4.SS2.p2.6.m6.3.4.1.cmml">∈</mo><mrow id="S4.SS2.p2.6.m6.3.4.3.2" xref="S4.SS2.p2.6.m6.3.4.3.1.cmml"><mo stretchy="false" id="S4.SS2.p2.6.m6.3.4.3.2.1" xref="S4.SS2.p2.6.m6.3.4.3.1.cmml">[</mo><mn id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">5.0</mn><mo id="S4.SS2.p2.6.m6.3.4.3.2.2" xref="S4.SS2.p2.6.m6.3.4.3.1.cmml">,</mo><mn id="S4.SS2.p2.6.m6.2.2" xref="S4.SS2.p2.6.m6.2.2.cmml">0.5</mn><mo id="S4.SS2.p2.6.m6.3.4.3.2.3" xref="S4.SS2.p2.6.m6.3.4.3.1.cmml">,</mo><mn id="S4.SS2.p2.6.m6.3.3" xref="S4.SS2.p2.6.m6.3.3.cmml">0.1</mn><mo stretchy="false" id="S4.SS2.p2.6.m6.3.4.3.2.4" xref="S4.SS2.p2.6.m6.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.3b"><apply id="S4.SS2.p2.6.m6.3.4.cmml" xref="S4.SS2.p2.6.m6.3.4"><in id="S4.SS2.p2.6.m6.3.4.1.cmml" xref="S4.SS2.p2.6.m6.3.4.1"></in><ci id="S4.SS2.p2.6.m6.3.4.2.cmml" xref="S4.SS2.p2.6.m6.3.4.2">𝛼</ci><list id="S4.SS2.p2.6.m6.3.4.3.1.cmml" xref="S4.SS2.p2.6.m6.3.4.3.2"><cn type="float" id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">5.0</cn><cn type="float" id="S4.SS2.p2.6.m6.2.2.cmml" xref="S4.SS2.p2.6.m6.2.2">0.5</cn><cn type="float" id="S4.SS2.p2.6.m6.3.3.cmml" xref="S4.SS2.p2.6.m6.3.3">0.1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.3c">\alpha\ \in\ [5.0,0.5,0.1]</annotation></semantics></math>. For FedCKA, the best <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><mi id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><ci id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">\mu</annotation></semantics></math> is 5, 3, and 3 for each <math id="S4.SS2.p2.8.m8.3" class="ltx_Math" alttext="\alpha\ \in\ [5.0,0.5,0.1]" display="inline"><semantics id="S4.SS2.p2.8.m8.3a"><mrow id="S4.SS2.p2.8.m8.3.4" xref="S4.SS2.p2.8.m8.3.4.cmml"><mi id="S4.SS2.p2.8.m8.3.4.2" xref="S4.SS2.p2.8.m8.3.4.2.cmml">α</mi><mo lspace="0.778em" rspace="0.778em" id="S4.SS2.p2.8.m8.3.4.1" xref="S4.SS2.p2.8.m8.3.4.1.cmml">∈</mo><mrow id="S4.SS2.p2.8.m8.3.4.3.2" xref="S4.SS2.p2.8.m8.3.4.3.1.cmml"><mo stretchy="false" id="S4.SS2.p2.8.m8.3.4.3.2.1" xref="S4.SS2.p2.8.m8.3.4.3.1.cmml">[</mo><mn id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml">5.0</mn><mo id="S4.SS2.p2.8.m8.3.4.3.2.2" xref="S4.SS2.p2.8.m8.3.4.3.1.cmml">,</mo><mn id="S4.SS2.p2.8.m8.2.2" xref="S4.SS2.p2.8.m8.2.2.cmml">0.5</mn><mo id="S4.SS2.p2.8.m8.3.4.3.2.3" xref="S4.SS2.p2.8.m8.3.4.3.1.cmml">,</mo><mn id="S4.SS2.p2.8.m8.3.3" xref="S4.SS2.p2.8.m8.3.3.cmml">0.1</mn><mo stretchy="false" id="S4.SS2.p2.8.m8.3.4.3.2.4" xref="S4.SS2.p2.8.m8.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.3b"><apply id="S4.SS2.p2.8.m8.3.4.cmml" xref="S4.SS2.p2.8.m8.3.4"><in id="S4.SS2.p2.8.m8.3.4.1.cmml" xref="S4.SS2.p2.8.m8.3.4.1"></in><ci id="S4.SS2.p2.8.m8.3.4.2.cmml" xref="S4.SS2.p2.8.m8.3.4.2">𝛼</ci><list id="S4.SS2.p2.8.m8.3.4.3.1.cmml" xref="S4.SS2.p2.8.m8.3.4.3.2"><cn type="float" id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1">5.0</cn><cn type="float" id="S4.SS2.p2.8.m8.2.2.cmml" xref="S4.SS2.p2.8.m8.2.2">0.5</cn><cn type="float" id="S4.SS2.p2.8.m8.3.3.cmml" xref="S4.SS2.p2.8.m8.3.3">0.1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.3c">\alpha\ \in\ [5.0,0.5,0.1]</annotation></semantics></math>, respectively. For MOON, the best <math id="S4.SS2.p2.9.m9.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p2.9.m9.1a"><mi id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><ci id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">\mu</annotation></semantics></math> is 0.1, 10, and 10. For FedProx, the best <math id="S4.SS2.p2.10.m10.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p2.10.m10.1a"><mi id="S4.SS2.p2.10.m10.1.1" xref="S4.SS2.p2.10.m10.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m10.1b"><ci id="S4.SS2.p2.10.m10.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m10.1c">\mu</annotation></semantics></math> is 0.001, 0.1, and 0.001.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.3.3" class="ltx_tr">
<th id="S4.T2.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.3.4.1" class="ltx_text">Method</span></th>
<th id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.1.1.1.1" class="ltx_text"><math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\alpha</annotation></semantics></math> = 5.0</span></th>
<th id="S4.T2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.2.2.2.1" class="ltx_text"><math id="S4.T2.2.2.2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T2.2.2.2.1.m1.1a"><mi id="S4.T2.2.2.2.1.m1.1.1" xref="S4.T2.2.2.2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.1.m1.1b"><ci id="S4.T2.2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.1.m1.1c">\alpha</annotation></semantics></math> = 0.5</span></th>
<th id="S4.T2.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.3.3.1" class="ltx_text"><math id="S4.T2.3.3.3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T2.3.3.3.1.m1.1a"><mi id="S4.T2.3.3.3.1.m1.1.1" xref="S4.T2.3.3.3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.1.m1.1b"><ci id="S4.T2.3.3.3.1.m1.1.1.cmml" xref="S4.T2.3.3.3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.1.m1.1c">\alpha</annotation></semantics></math> = 0.1</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.3.4.1" class="ltx_tr">
<td id="S4.T2.3.4.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">FedAvg</td>
<td id="S4.T2.3.4.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">64.37%</td>
<td id="S4.T2.3.4.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">59.81%</td>
<td id="S4.T2.3.4.1.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">50.43%</td>
</tr>
<tr id="S4.T2.3.5.2" class="ltx_tr">
<td id="S4.T2.3.5.2.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">FedProx</td>
<td id="S4.T2.3.5.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">64.58%</td>
<td id="S4.T2.3.5.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">59.98%</td>
<td id="S4.T2.3.5.2.4" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">51.07%</td>
</tr>
<tr id="S4.T2.3.6.3" class="ltx_tr">
<td id="S4.T2.3.6.3.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">SCAFFOLD</td>
<td id="S4.T2.3.6.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">64.33%</td>
<td id="S4.T2.3.6.3.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">59.47%</td>
<td id="S4.T2.3.6.3.4" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">40.53%</td>
</tr>
<tr id="S4.T2.3.7.4" class="ltx_tr">
<td id="S4.T2.3.7.4.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">MOON</td>
<td id="S4.T2.3.7.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">65.25%</td>
<td id="S4.T2.3.7.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">60.65%</td>
<td id="S4.T2.3.7.4.4" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">51.63%</td>
</tr>
<tr id="S4.T2.3.8.5" class="ltx_tr">
<td id="S4.T2.3.8.5.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.8.5.1.1" class="ltx_text ltx_font_bold">FedCKA</span></td>
<td id="S4.T2.3.8.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.8.5.2.1" class="ltx_text ltx_font_bold">67.86%</span></td>
<td id="S4.T2.3.8.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.8.5.3.1" class="ltx_text ltx_font_bold">61.13%</span></td>
<td id="S4.T2.3.8.5.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.8.5.4.1" class="ltx_text ltx_font_bold">52.35%</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Accuracy across <math id="S4.T2.5.m1.3" class="ltx_Math" alttext="\alpha\ \in\ [5.0,0.5,0.1]" display="inline"><semantics id="S4.T2.5.m1.3b"><mrow id="S4.T2.5.m1.3.4" xref="S4.T2.5.m1.3.4.cmml"><mi id="S4.T2.5.m1.3.4.2" xref="S4.T2.5.m1.3.4.2.cmml">α</mi><mo lspace="0.778em" rspace="0.778em" id="S4.T2.5.m1.3.4.1" xref="S4.T2.5.m1.3.4.1.cmml">∈</mo><mrow id="S4.T2.5.m1.3.4.3.2" xref="S4.T2.5.m1.3.4.3.1.cmml"><mo stretchy="false" id="S4.T2.5.m1.3.4.3.2.1" xref="S4.T2.5.m1.3.4.3.1.cmml">[</mo><mn id="S4.T2.5.m1.1.1" xref="S4.T2.5.m1.1.1.cmml">5.0</mn><mo id="S4.T2.5.m1.3.4.3.2.2" xref="S4.T2.5.m1.3.4.3.1.cmml">,</mo><mn id="S4.T2.5.m1.2.2" xref="S4.T2.5.m1.2.2.cmml">0.5</mn><mo id="S4.T2.5.m1.3.4.3.2.3" xref="S4.T2.5.m1.3.4.3.1.cmml">,</mo><mn id="S4.T2.5.m1.3.3" xref="S4.T2.5.m1.3.3.cmml">0.1</mn><mo stretchy="false" id="S4.T2.5.m1.3.4.3.2.4" xref="S4.T2.5.m1.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.m1.3c"><apply id="S4.T2.5.m1.3.4.cmml" xref="S4.T2.5.m1.3.4"><in id="S4.T2.5.m1.3.4.1.cmml" xref="S4.T2.5.m1.3.4.1"></in><ci id="S4.T2.5.m1.3.4.2.cmml" xref="S4.T2.5.m1.3.4.2">𝛼</ci><list id="S4.T2.5.m1.3.4.3.1.cmml" xref="S4.T2.5.m1.3.4.3.2"><cn type="float" id="S4.T2.5.m1.1.1.cmml" xref="S4.T2.5.m1.1.1">5.0</cn><cn type="float" id="S4.T2.5.m1.2.2.cmml" xref="S4.T2.5.m1.2.2">0.5</cn><cn type="float" id="S4.T2.5.m1.3.3.cmml" xref="S4.T2.5.m1.3.3">0.1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.m1.3d">\alpha\ \in\ [5.0,0.5,0.1]</annotation></semantics></math> (CIFAR-10)</figcaption>
</figure>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.2" class="ltx_p">We observe that FedCKA consistently outperforms previous methods across different datasets and across different <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\alpha</annotation></semantics></math>. FedCKA improves performance in heterogeneous settings owing to regularizing layers that are naturally similar, and not layers that are naturally dissimilar. It is also interesting to see that FedCKA performs better by a larger margin when <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\alpha</annotation></semantics></math> is larger. This is likely because the global model is less biased as data distribution approaches IID settings, thus can more effectively regularize updates. However, we also observe that other works consistently improve performance, albeit by a smaller margin than FedCKA. FedProx and SCAFFOLD improve performance likely owing to their inclusion of naturally similar layers in regularization. The performance gain is lower, as they also include naturally dissimilar layers in regularization. MOON improves performance compared to FedProx and SCAFFOLD likely owing to their use of a contrastive loss. That is, MOON shows that neural networks should be trained to be more similar to the global model <span id="S4.SS2.p3.2.1" class="ltx_text ltx_font_italic">than past local model</span>, rather than only be blindly similar the global model. By regularizing naturally similar layers using a contrastive loss based on CKA, FedCKA outperforms all methods.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">Note that across most methods and settings, there are discrepancies to the accuracy reported by MOON <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>. In particular, MOON reports higher accuracy across all methods although model architecture are similar, if not equivalent. We suspect that data augmentation was used to increase accuracy. We could not test these settings, as MOON did not record their parameters. We thus report result without data augmentation techniques.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Regularizing Only Important Layers</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.4" class="ltx_p">We study the effects of regularizing different number of layers. Using the CIFAR-10 dataset with <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\alpha=5.0" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS3.p1.1.m1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">5.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><eq id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1"></eq><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">5.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\alpha=5.0</annotation></semantics></math>, we change the number of layers to regularize through <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\ell_{cka}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">ℓ</mi><mrow id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3.2" xref="S4.SS3.p1.2.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.1.1.3.1" xref="S4.SS3.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.2.m2.1.1.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.1.1.3.1a" xref="S4.SS3.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.2.m2.1.1.3.4" xref="S4.SS3.p1.2.m2.1.1.3.4.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">ℓ</ci><apply id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3"><times id="S4.SS3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3.1"></times><ci id="S4.SS3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.2">𝑐</ci><ci id="S4.SS3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3">𝑘</ci><ci id="S4.SS3.p1.2.m2.1.1.3.4.cmml" xref="S4.SS3.p1.2.m2.1.1.3.4">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\ell_{cka}</annotation></semantics></math>. Formally, we change <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">M</annotation></semantics></math> in Eq <a href="#S3.E2" title="In 3.3 Modifications to FedAvg ‣ 3 FedCKA ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> by scaling <math id="S4.SS3.p1.4.m4.7" class="ltx_Math" alttext="M\ \in\ [1,2,3,4,5,6,7]" display="inline"><semantics id="S4.SS3.p1.4.m4.7a"><mrow id="S4.SS3.p1.4.m4.7.8" xref="S4.SS3.p1.4.m4.7.8.cmml"><mi id="S4.SS3.p1.4.m4.7.8.2" xref="S4.SS3.p1.4.m4.7.8.2.cmml">M</mi><mo lspace="0.778em" rspace="0.778em" id="S4.SS3.p1.4.m4.7.8.1" xref="S4.SS3.p1.4.m4.7.8.1.cmml">∈</mo><mrow id="S4.SS3.p1.4.m4.7.8.3.2" xref="S4.SS3.p1.4.m4.7.8.3.1.cmml"><mo stretchy="false" id="S4.SS3.p1.4.m4.7.8.3.2.1" xref="S4.SS3.p1.4.m4.7.8.3.1.cmml">[</mo><mn id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">1</mn><mo id="S4.SS3.p1.4.m4.7.8.3.2.2" xref="S4.SS3.p1.4.m4.7.8.3.1.cmml">,</mo><mn id="S4.SS3.p1.4.m4.2.2" xref="S4.SS3.p1.4.m4.2.2.cmml">2</mn><mo id="S4.SS3.p1.4.m4.7.8.3.2.3" xref="S4.SS3.p1.4.m4.7.8.3.1.cmml">,</mo><mn id="S4.SS3.p1.4.m4.3.3" xref="S4.SS3.p1.4.m4.3.3.cmml">3</mn><mo id="S4.SS3.p1.4.m4.7.8.3.2.4" xref="S4.SS3.p1.4.m4.7.8.3.1.cmml">,</mo><mn id="S4.SS3.p1.4.m4.4.4" xref="S4.SS3.p1.4.m4.4.4.cmml">4</mn><mo id="S4.SS3.p1.4.m4.7.8.3.2.5" xref="S4.SS3.p1.4.m4.7.8.3.1.cmml">,</mo><mn id="S4.SS3.p1.4.m4.5.5" xref="S4.SS3.p1.4.m4.5.5.cmml">5</mn><mo id="S4.SS3.p1.4.m4.7.8.3.2.6" xref="S4.SS3.p1.4.m4.7.8.3.1.cmml">,</mo><mn id="S4.SS3.p1.4.m4.6.6" xref="S4.SS3.p1.4.m4.6.6.cmml">6</mn><mo id="S4.SS3.p1.4.m4.7.8.3.2.7" xref="S4.SS3.p1.4.m4.7.8.3.1.cmml">,</mo><mn id="S4.SS3.p1.4.m4.7.7" xref="S4.SS3.p1.4.m4.7.7.cmml">7</mn><mo stretchy="false" id="S4.SS3.p1.4.m4.7.8.3.2.8" xref="S4.SS3.p1.4.m4.7.8.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.7b"><apply id="S4.SS3.p1.4.m4.7.8.cmml" xref="S4.SS3.p1.4.m4.7.8"><in id="S4.SS3.p1.4.m4.7.8.1.cmml" xref="S4.SS3.p1.4.m4.7.8.1"></in><ci id="S4.SS3.p1.4.m4.7.8.2.cmml" xref="S4.SS3.p1.4.m4.7.8.2">𝑀</ci><list id="S4.SS3.p1.4.m4.7.8.3.1.cmml" xref="S4.SS3.p1.4.m4.7.8.3.2"><cn type="integer" id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">1</cn><cn type="integer" id="S4.SS3.p1.4.m4.2.2.cmml" xref="S4.SS3.p1.4.m4.2.2">2</cn><cn type="integer" id="S4.SS3.p1.4.m4.3.3.cmml" xref="S4.SS3.p1.4.m4.3.3">3</cn><cn type="integer" id="S4.SS3.p1.4.m4.4.4.cmml" xref="S4.SS3.p1.4.m4.4.4">4</cn><cn type="integer" id="S4.SS3.p1.4.m4.5.5.cmml" xref="S4.SS3.p1.4.m4.5.5">5</cn><cn type="integer" id="S4.SS3.p1.4.m4.6.6.cmml" xref="S4.SS3.p1.4.m4.6.6">6</cn><cn type="integer" id="S4.SS3.p1.4.m4.7.7.cmml" xref="S4.SS3.p1.4.m4.7.7">7</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.7c">M\ \in\ [1,2,3,4,5,6,7]</annotation></semantics></math>, and report the accuracy in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.3 Regularizing Only Important Layers ‣ 4 Experimental Results and Analysis ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
Accuracy is highest when only the first two layers are regularized. This verifies our claim that only naturally similar, but not naturally dissimilar layers should be regularized (Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2 Measuring Layer-wise Similarity ‣ 3 FedCKA ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).
In addition, note the dotted line representing the upper bound for Federated Learning. When the same model is trained on a centralized server with the whole CIFAR-10 dataset, accuracy is 70%. FedCKA with regularization on the first two naturally similar layers nearly reaches this upper bound.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2112.00407/assets/images/accuracy_by_layer.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="389" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Accuracy with respect to the number of layers regularized on CIFAR-10 and <math id="S4.F5.2.m1.1" class="ltx_Math" alttext="\alpha=5.0" display="inline"><semantics id="S4.F5.2.m1.1b"><mrow id="S4.F5.2.m1.1.1" xref="S4.F5.2.m1.1.1.cmml"><mi id="S4.F5.2.m1.1.1.2" xref="S4.F5.2.m1.1.1.2.cmml">α</mi><mo id="S4.F5.2.m1.1.1.1" xref="S4.F5.2.m1.1.1.1.cmml">=</mo><mn id="S4.F5.2.m1.1.1.3" xref="S4.F5.2.m1.1.1.3.cmml">5.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.2.m1.1c"><apply id="S4.F5.2.m1.1.1.cmml" xref="S4.F5.2.m1.1.1"><eq id="S4.F5.2.m1.1.1.1.cmml" xref="S4.F5.2.m1.1.1.1"></eq><ci id="S4.F5.2.m1.1.1.2.cmml" xref="S4.F5.2.m1.1.1.2">𝛼</ci><cn type="float" id="S4.F5.2.m1.1.1.3.cmml" xref="S4.F5.2.m1.1.1.3">5.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.2.m1.1d">\alpha=5.0</annotation></semantics></math></figcaption>
</figure>
<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">Similarity Metric</th>
<th id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">Accuracy</th>
<th id="S4.T3.1.1.1.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:7.0pt;padding-right:7.0pt;">
<table id="S4.T3.1.1.1.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T3.1.1.1.3.1.1" class="ltx_tr">
<td id="S4.T3.1.1.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">Training</td>
</tr>
<tr id="S4.T3.1.1.1.3.1.2" class="ltx_tr">
<td id="S4.T3.1.1.1.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">Duration (s)</td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.2.1" class="ltx_tr">
<td id="S4.T3.1.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">None (FedAvg)</td>
<td id="S4.T3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">64.37%</td>
<td id="S4.T3.1.2.1.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;">54.82</td>
</tr>
<tr id="S4.T3.1.3.2" class="ltx_tr">
<td id="S4.T3.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">Frobenius Norm</td>
<td id="S4.T3.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">65.54%</td>
<td id="S4.T3.1.3.2.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">64.73</td>
</tr>
<tr id="S4.T3.1.4.3" class="ltx_tr">
<td id="S4.T3.1.4.3.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">Vectorized Cosine</td>
<td id="S4.T3.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">66.67%</td>
<td id="S4.T3.1.4.3.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">65.75</td>
</tr>
<tr id="S4.T3.1.5.4" class="ltx_tr">
<td id="S4.T3.1.5.4.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">Kernel CKA</td>
<td id="S4.T3.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">67.93%</td>
<td id="S4.T3.1.5.4.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;">122.41</td>
</tr>
<tr id="S4.T3.1.6.5" class="ltx_tr">
<td id="S4.T3.1.6.5.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">Linear CKA</td>
<td id="S4.T3.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:7.0pt;padding-right:7.0pt;">67.86%</td>
<td id="S4.T3.1.6.5.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:7.0pt;padding-right:7.0pt;">104.17</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Accuracy and training duration with FedCKA with different similarity metrics (CIFAR-10)</figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Using the Best Similarity Metric</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.6" class="ltx_p">We study the effects of regularizing the first two naturally similar layers with different similarity metrics. Using the CIFAR-10 dataset with <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="\alpha=5.0" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mrow id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS4.p1.1.m1.1.1.1" xref="S4.SS4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml">5.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><eq id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1.1"></eq><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3">5.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\alpha=5.0</annotation></semantics></math>, we change the similarity metric to regularize through <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="\ell_{cka}" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><msub id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">ℓ</mi><mrow id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml"><mi id="S4.SS4.p1.2.m2.1.1.3.2" xref="S4.SS4.p1.2.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.2.m2.1.1.3.1" xref="S4.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.2.m2.1.1.3.3" xref="S4.SS4.p1.2.m2.1.1.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.2.m2.1.1.3.1a" xref="S4.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.2.m2.1.1.3.4" xref="S4.SS4.p1.2.m2.1.1.3.4.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">ℓ</ci><apply id="S4.SS4.p1.2.m2.1.1.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3"><times id="S4.SS4.p1.2.m2.1.1.3.1.cmml" xref="S4.SS4.p1.2.m2.1.1.3.1"></times><ci id="S4.SS4.p1.2.m2.1.1.3.2.cmml" xref="S4.SS4.p1.2.m2.1.1.3.2">𝑐</ci><ci id="S4.SS4.p1.2.m2.1.1.3.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3.3">𝑘</ci><ci id="S4.SS4.p1.2.m2.1.1.3.4.cmml" xref="S4.SS4.p1.2.m2.1.1.3.4">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">\ell_{cka}</annotation></semantics></math>. Formally, we change <math id="S4.SS4.p1.3.m3.2" class="ltx_Math" alttext="CKA(a_{1},a_{2})" display="inline"><semantics id="S4.SS4.p1.3.m3.2a"><mrow id="S4.SS4.p1.3.m3.2.2" xref="S4.SS4.p1.3.m3.2.2.cmml"><mi id="S4.SS4.p1.3.m3.2.2.4" xref="S4.SS4.p1.3.m3.2.2.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.3.m3.2.2.3" xref="S4.SS4.p1.3.m3.2.2.3.cmml">​</mo><mi id="S4.SS4.p1.3.m3.2.2.5" xref="S4.SS4.p1.3.m3.2.2.5.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.3.m3.2.2.3a" xref="S4.SS4.p1.3.m3.2.2.3.cmml">​</mo><mi id="S4.SS4.p1.3.m3.2.2.6" xref="S4.SS4.p1.3.m3.2.2.6.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.3.m3.2.2.3b" xref="S4.SS4.p1.3.m3.2.2.3.cmml">​</mo><mrow id="S4.SS4.p1.3.m3.2.2.2.2" xref="S4.SS4.p1.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS4.p1.3.m3.2.2.2.2.3" xref="S4.SS4.p1.3.m3.2.2.2.3.cmml">(</mo><msub id="S4.SS4.p1.3.m3.1.1.1.1.1" xref="S4.SS4.p1.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.1.1.1.2" xref="S4.SS4.p1.3.m3.1.1.1.1.1.2.cmml">a</mi><mn id="S4.SS4.p1.3.m3.1.1.1.1.1.3" xref="S4.SS4.p1.3.m3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS4.p1.3.m3.2.2.2.2.4" xref="S4.SS4.p1.3.m3.2.2.2.3.cmml">,</mo><msub id="S4.SS4.p1.3.m3.2.2.2.2.2" xref="S4.SS4.p1.3.m3.2.2.2.2.2.cmml"><mi id="S4.SS4.p1.3.m3.2.2.2.2.2.2" xref="S4.SS4.p1.3.m3.2.2.2.2.2.2.cmml">a</mi><mn id="S4.SS4.p1.3.m3.2.2.2.2.2.3" xref="S4.SS4.p1.3.m3.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S4.SS4.p1.3.m3.2.2.2.2.5" xref="S4.SS4.p1.3.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.2b"><apply id="S4.SS4.p1.3.m3.2.2.cmml" xref="S4.SS4.p1.3.m3.2.2"><times id="S4.SS4.p1.3.m3.2.2.3.cmml" xref="S4.SS4.p1.3.m3.2.2.3"></times><ci id="S4.SS4.p1.3.m3.2.2.4.cmml" xref="S4.SS4.p1.3.m3.2.2.4">𝐶</ci><ci id="S4.SS4.p1.3.m3.2.2.5.cmml" xref="S4.SS4.p1.3.m3.2.2.5">𝐾</ci><ci id="S4.SS4.p1.3.m3.2.2.6.cmml" xref="S4.SS4.p1.3.m3.2.2.6">𝐴</ci><interval closure="open" id="S4.SS4.p1.3.m3.2.2.2.3.cmml" xref="S4.SS4.p1.3.m3.2.2.2.2"><apply id="S4.SS4.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p1.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.1.1.1.2">𝑎</ci><cn type="integer" id="S4.SS4.p1.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS4.p1.3.m3.1.1.1.1.1.3">1</cn></apply><apply id="S4.SS4.p1.3.m3.2.2.2.2.2.cmml" xref="S4.SS4.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.2.2.2.2.2.1.cmml" xref="S4.SS4.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S4.SS4.p1.3.m3.2.2.2.2.2.2.cmml" xref="S4.SS4.p1.3.m3.2.2.2.2.2.2">𝑎</ci><cn type="integer" id="S4.SS4.p1.3.m3.2.2.2.2.2.3.cmml" xref="S4.SS4.p1.3.m3.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.2c">CKA(a_{1},a_{2})</annotation></semantics></math> in Eq <a href="#S3.E2" title="In 3.3 Modifications to FedAvg ‣ 3 FedCKA ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> to three other similarity metrics. First, the kernel CKA, introduced in <cite class="ltx_cite ltx_citemacro_citet">Kornblith et al. (<a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite> (<math id="S4.SS4.p1.4.m4.2" class="ltx_Math" alttext="CKA_{k}(a_{1},a_{2})" display="inline"><semantics id="S4.SS4.p1.4.m4.2a"><mrow id="S4.SS4.p1.4.m4.2.2" xref="S4.SS4.p1.4.m4.2.2.cmml"><mi id="S4.SS4.p1.4.m4.2.2.4" xref="S4.SS4.p1.4.m4.2.2.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.4.m4.2.2.3" xref="S4.SS4.p1.4.m4.2.2.3.cmml">​</mo><mi id="S4.SS4.p1.4.m4.2.2.5" xref="S4.SS4.p1.4.m4.2.2.5.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.4.m4.2.2.3a" xref="S4.SS4.p1.4.m4.2.2.3.cmml">​</mo><msub id="S4.SS4.p1.4.m4.2.2.6" xref="S4.SS4.p1.4.m4.2.2.6.cmml"><mi id="S4.SS4.p1.4.m4.2.2.6.2" xref="S4.SS4.p1.4.m4.2.2.6.2.cmml">A</mi><mi id="S4.SS4.p1.4.m4.2.2.6.3" xref="S4.SS4.p1.4.m4.2.2.6.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.p1.4.m4.2.2.3b" xref="S4.SS4.p1.4.m4.2.2.3.cmml">​</mo><mrow id="S4.SS4.p1.4.m4.2.2.2.2" xref="S4.SS4.p1.4.m4.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS4.p1.4.m4.2.2.2.2.3" xref="S4.SS4.p1.4.m4.2.2.2.3.cmml">(</mo><msub id="S4.SS4.p1.4.m4.1.1.1.1.1" xref="S4.SS4.p1.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS4.p1.4.m4.1.1.1.1.1.2" xref="S4.SS4.p1.4.m4.1.1.1.1.1.2.cmml">a</mi><mn id="S4.SS4.p1.4.m4.1.1.1.1.1.3" xref="S4.SS4.p1.4.m4.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS4.p1.4.m4.2.2.2.2.4" xref="S4.SS4.p1.4.m4.2.2.2.3.cmml">,</mo><msub id="S4.SS4.p1.4.m4.2.2.2.2.2" xref="S4.SS4.p1.4.m4.2.2.2.2.2.cmml"><mi id="S4.SS4.p1.4.m4.2.2.2.2.2.2" xref="S4.SS4.p1.4.m4.2.2.2.2.2.2.cmml">a</mi><mn id="S4.SS4.p1.4.m4.2.2.2.2.2.3" xref="S4.SS4.p1.4.m4.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S4.SS4.p1.4.m4.2.2.2.2.5" xref="S4.SS4.p1.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.2b"><apply id="S4.SS4.p1.4.m4.2.2.cmml" xref="S4.SS4.p1.4.m4.2.2"><times id="S4.SS4.p1.4.m4.2.2.3.cmml" xref="S4.SS4.p1.4.m4.2.2.3"></times><ci id="S4.SS4.p1.4.m4.2.2.4.cmml" xref="S4.SS4.p1.4.m4.2.2.4">𝐶</ci><ci id="S4.SS4.p1.4.m4.2.2.5.cmml" xref="S4.SS4.p1.4.m4.2.2.5">𝐾</ci><apply id="S4.SS4.p1.4.m4.2.2.6.cmml" xref="S4.SS4.p1.4.m4.2.2.6"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.2.2.6.1.cmml" xref="S4.SS4.p1.4.m4.2.2.6">subscript</csymbol><ci id="S4.SS4.p1.4.m4.2.2.6.2.cmml" xref="S4.SS4.p1.4.m4.2.2.6.2">𝐴</ci><ci id="S4.SS4.p1.4.m4.2.2.6.3.cmml" xref="S4.SS4.p1.4.m4.2.2.6.3">𝑘</ci></apply><interval closure="open" id="S4.SS4.p1.4.m4.2.2.2.3.cmml" xref="S4.SS4.p1.4.m4.2.2.2.2"><apply id="S4.SS4.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p1.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.1.1.1.2">𝑎</ci><cn type="integer" id="S4.SS4.p1.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.1.1.1.3">1</cn></apply><apply id="S4.SS4.p1.4.m4.2.2.2.2.2.cmml" xref="S4.SS4.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.2.2.2.2.2.1.cmml" xref="S4.SS4.p1.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S4.SS4.p1.4.m4.2.2.2.2.2.2.cmml" xref="S4.SS4.p1.4.m4.2.2.2.2.2.2">𝑎</ci><cn type="integer" id="S4.SS4.p1.4.m4.2.2.2.2.2.3.cmml" xref="S4.SS4.p1.4.m4.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.2c">CKA_{k}(a_{1},a_{2})</annotation></semantics></math>). Second, the squared Frobenius norm (<math id="S4.SS4.p1.5.m5.1" class="ltx_Math" alttext="\left\|a_{1}-a_{2}\right\|_{F}^{2}" display="inline"><semantics id="S4.SS4.p1.5.m5.1a"><msubsup id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml"><mrow id="S4.SS4.p1.5.m5.1.1.1.1.1" xref="S4.SS4.p1.5.m5.1.1.1.1.2.cmml"><mo id="S4.SS4.p1.5.m5.1.1.1.1.1.2" xref="S4.SS4.p1.5.m5.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.SS4.p1.5.m5.1.1.1.1.1.1" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.cmml"><msub id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.cmml"><mi id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.2" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.2.cmml">a</mi><mn id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS4.p1.5.m5.1.1.1.1.1.1.1" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.cmml"><mi id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.cmml">a</mi><mn id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.3" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S4.SS4.p1.5.m5.1.1.1.1.1.3" xref="S4.SS4.p1.5.m5.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S4.SS4.p1.5.m5.1.1.1.3" xref="S4.SS4.p1.5.m5.1.1.1.3.cmml">F</mi><mn id="S4.SS4.p1.5.m5.1.1.3" xref="S4.SS4.p1.5.m5.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><apply id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m5.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1">superscript</csymbol><apply id="S4.SS4.p1.5.m5.1.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m5.1.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1">subscript</csymbol><apply id="S4.SS4.p1.5.m5.1.1.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS4.p1.5.m5.1.1.1.1.2.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.2">norm</csymbol><apply id="S4.SS4.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1"><minus id="S4.SS4.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.1"></minus><apply id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.2.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.2">𝑎</ci><cn type="integer" id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2">𝑎</ci><cn type="integer" id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.3.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply><ci id="S4.SS4.p1.5.m5.1.1.1.3.cmml" xref="S4.SS4.p1.5.m5.1.1.1.3">𝐹</ci></apply><cn type="integer" id="S4.SS4.p1.5.m5.1.1.3.cmml" xref="S4.SS4.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">\left\|a_{1}-a_{2}\right\|_{F}^{2}</annotation></semantics></math>). Third, the vectorized cosine similarity (<math id="S4.SS4.p1.6.m6.2" class="ltx_Math" alttext="\left\|vec(a_{1})\right\|\left\|vec(a_{2})\right\|\cos\theta" display="inline"><semantics id="S4.SS4.p1.6.m6.2a"><mrow id="S4.SS4.p1.6.m6.2.2" xref="S4.SS4.p1.6.m6.2.2.cmml"><mrow id="S4.SS4.p1.6.m6.1.1.1.1" xref="S4.SS4.p1.6.m6.1.1.1.2.cmml"><mo id="S4.SS4.p1.6.m6.1.1.1.1.2" xref="S4.SS4.p1.6.m6.1.1.1.2.1.cmml">‖</mo><mrow id="S4.SS4.p1.6.m6.1.1.1.1.1" xref="S4.SS4.p1.6.m6.1.1.1.1.1.cmml"><mi id="S4.SS4.p1.6.m6.1.1.1.1.1.3" xref="S4.SS4.p1.6.m6.1.1.1.1.1.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.6.m6.1.1.1.1.1.2" xref="S4.SS4.p1.6.m6.1.1.1.1.1.2.cmml">​</mo><mi id="S4.SS4.p1.6.m6.1.1.1.1.1.4" xref="S4.SS4.p1.6.m6.1.1.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.6.m6.1.1.1.1.1.2a" xref="S4.SS4.p1.6.m6.1.1.1.1.1.2.cmml">​</mo><mi id="S4.SS4.p1.6.m6.1.1.1.1.1.5" xref="S4.SS4.p1.6.m6.1.1.1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.6.m6.1.1.1.1.1.2b" xref="S4.SS4.p1.6.m6.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS4.p1.6.m6.1.1.1.1.1.1.1" xref="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.2" xref="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1" xref="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.2" xref="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.2.cmml">a</mi><mn id="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.3" xref="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.3" xref="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS4.p1.6.m6.1.1.1.1.3" xref="S4.SS4.p1.6.m6.1.1.1.2.1.cmml">‖</mo></mrow><mo lspace="0em" rspace="0em" id="S4.SS4.p1.6.m6.2.2.3" xref="S4.SS4.p1.6.m6.2.2.3.cmml">​</mo><mrow id="S4.SS4.p1.6.m6.2.2.2.1" xref="S4.SS4.p1.6.m6.2.2.2.2.cmml"><mo id="S4.SS4.p1.6.m6.2.2.2.1.2" xref="S4.SS4.p1.6.m6.2.2.2.2.1.cmml">‖</mo><mrow id="S4.SS4.p1.6.m6.2.2.2.1.1" xref="S4.SS4.p1.6.m6.2.2.2.1.1.cmml"><mi id="S4.SS4.p1.6.m6.2.2.2.1.1.3" xref="S4.SS4.p1.6.m6.2.2.2.1.1.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.6.m6.2.2.2.1.1.2" xref="S4.SS4.p1.6.m6.2.2.2.1.1.2.cmml">​</mo><mi id="S4.SS4.p1.6.m6.2.2.2.1.1.4" xref="S4.SS4.p1.6.m6.2.2.2.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.6.m6.2.2.2.1.1.2a" xref="S4.SS4.p1.6.m6.2.2.2.1.1.2.cmml">​</mo><mi id="S4.SS4.p1.6.m6.2.2.2.1.1.5" xref="S4.SS4.p1.6.m6.2.2.2.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.6.m6.2.2.2.1.1.2b" xref="S4.SS4.p1.6.m6.2.2.2.1.1.2.cmml">​</mo><mrow id="S4.SS4.p1.6.m6.2.2.2.1.1.1.1" xref="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.2" xref="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.cmml">(</mo><msub id="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1" xref="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.cmml"><mi id="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.2" xref="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.2.cmml">a</mi><mn id="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.3" xref="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.3" xref="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS4.p1.6.m6.2.2.2.1.3" xref="S4.SS4.p1.6.m6.2.2.2.2.1.cmml">‖</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.SS4.p1.6.m6.2.2.3a" xref="S4.SS4.p1.6.m6.2.2.3.cmml">​</mo><mrow id="S4.SS4.p1.6.m6.2.2.4" xref="S4.SS4.p1.6.m6.2.2.4.cmml"><mi id="S4.SS4.p1.6.m6.2.2.4.1" xref="S4.SS4.p1.6.m6.2.2.4.1.cmml">cos</mi><mo lspace="0.167em" id="S4.SS4.p1.6.m6.2.2.4a" xref="S4.SS4.p1.6.m6.2.2.4.cmml">⁡</mo><mi id="S4.SS4.p1.6.m6.2.2.4.2" xref="S4.SS4.p1.6.m6.2.2.4.2.cmml">θ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m6.2b"><apply id="S4.SS4.p1.6.m6.2.2.cmml" xref="S4.SS4.p1.6.m6.2.2"><times id="S4.SS4.p1.6.m6.2.2.3.cmml" xref="S4.SS4.p1.6.m6.2.2.3"></times><apply id="S4.SS4.p1.6.m6.1.1.1.2.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1"><csymbol cd="latexml" id="S4.SS4.p1.6.m6.1.1.1.2.1.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.2">norm</csymbol><apply id="S4.SS4.p1.6.m6.1.1.1.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1"><times id="S4.SS4.p1.6.m6.1.1.1.1.1.2.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.2"></times><ci id="S4.SS4.p1.6.m6.1.1.1.1.1.3.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.3">𝑣</ci><ci id="S4.SS4.p1.6.m6.1.1.1.1.1.4.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.4">𝑒</ci><ci id="S4.SS4.p1.6.m6.1.1.1.1.1.5.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.5">𝑐</ci><apply id="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.2">𝑎</ci><cn type="integer" id="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply><apply id="S4.SS4.p1.6.m6.2.2.2.2.cmml" xref="S4.SS4.p1.6.m6.2.2.2.1"><csymbol cd="latexml" id="S4.SS4.p1.6.m6.2.2.2.2.1.cmml" xref="S4.SS4.p1.6.m6.2.2.2.1.2">norm</csymbol><apply id="S4.SS4.p1.6.m6.2.2.2.1.1.cmml" xref="S4.SS4.p1.6.m6.2.2.2.1.1"><times id="S4.SS4.p1.6.m6.2.2.2.1.1.2.cmml" xref="S4.SS4.p1.6.m6.2.2.2.1.1.2"></times><ci id="S4.SS4.p1.6.m6.2.2.2.1.1.3.cmml" xref="S4.SS4.p1.6.m6.2.2.2.1.1.3">𝑣</ci><ci id="S4.SS4.p1.6.m6.2.2.2.1.1.4.cmml" xref="S4.SS4.p1.6.m6.2.2.2.1.1.4">𝑒</ci><ci id="S4.SS4.p1.6.m6.2.2.2.1.1.5.cmml" xref="S4.SS4.p1.6.m6.2.2.2.1.1.5">𝑐</ci><apply id="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.cmml" xref="S4.SS4.p1.6.m6.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.6.m6.2.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.2.cmml" xref="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.2">𝑎</ci><cn type="integer" id="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.3.cmml" xref="S4.SS4.p1.6.m6.2.2.2.1.1.1.1.1.3">2</cn></apply></apply></apply><apply id="S4.SS4.p1.6.m6.2.2.4.cmml" xref="S4.SS4.p1.6.m6.2.2.4"><cos id="S4.SS4.p1.6.m6.2.2.4.1.cmml" xref="S4.SS4.p1.6.m6.2.2.4.1"></cos><ci id="S4.SS4.p1.6.m6.2.2.4.2.cmml" xref="S4.SS4.p1.6.m6.2.2.4.2">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m6.2c">\left\|vec(a_{1})\right\|\left\|vec(a_{2})\right\|\cos\theta</annotation></semantics></math>). We compare the results with these different metrics as well as the baseline, FedAvg. The results are shown in Table <a href="#S4.T3" title="Table 3 ‣ 4.3 Regularizing Only Important Layers ‣ 4 Experimental Results and Analysis ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">We observe that performance is highest when CKA is used. This is likely owing to the accuracy of measuring similarity. Only truly dissimilar updates are penalized, thus improving performance. In addition, while kernel CKA slightly outperforms linear CKA, considering the computational overhead, we opt to use linear CKA.
We also observe that the squared Frobenius norm and vectorized cosine similarity decrease performance only slightly. These methods outperform most previous works. This verifies that while it is important to use an accurate similarity measure, it is more important to focus on regularizing naturally similar layers.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<table id="S4.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.1.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">Method</th>
<th id="S4.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">7 Layers</th>
<th id="S4.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">
<table id="S4.T4.1.1.1.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T4.1.1.1.3.1.1" class="ltx_tr">
<td id="S4.T4.1.1.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">Time</td>
</tr>
<tr id="S4.T4.1.1.1.3.1.2" class="ltx_tr">
<td id="S4.T4.1.1.1.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">Extended</td>
</tr>
</table>
</th>
<th id="S4.T4.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">50 Layers</th>
<th id="S4.T4.1.1.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">
<table id="S4.T4.1.1.1.5.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T4.1.1.1.5.1.1" class="ltx_tr">
<td id="S4.T4.1.1.1.5.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">Time</td>
</tr>
<tr id="S4.T4.1.1.1.5.1.2" class="ltx_tr">
<td id="S4.T4.1.1.1.5.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">Extended</td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.1.2.1" class="ltx_tr">
<th id="S4.T4.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">FedAvg</th>
<td id="S4.T4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">54.82</td>
<td id="S4.T4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">-</td>
<td id="S4.T4.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">638.79</td>
<td id="S4.T4.1.2.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">-</td>
</tr>
<tr id="S4.T4.1.3.2" class="ltx_tr">
<th id="S4.T4.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">SCAFFOLD</th>
<td id="S4.T4.1.3.2.2" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">57.19</td>
<td id="S4.T4.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">2.37</td>
<td id="S4.T4.1.3.2.4" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">967.04</td>
<td id="S4.T4.1.3.2.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">328.25</td>
</tr>
<tr id="S4.T4.1.4.3" class="ltx_tr">
<th id="S4.T4.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">FedProx</th>
<td id="S4.T4.1.4.3.2" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">57.20</td>
<td id="S4.T4.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">2.38</td>
<td id="S4.T4.1.4.3.4" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">862.12</td>
<td id="S4.T4.1.4.3.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">223.33</td>
</tr>
<tr id="S4.T4.1.5.4" class="ltx_tr">
<th id="S4.T4.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">MOON</th>
<td id="S4.T4.1.5.4.2" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">97.58</td>
<td id="S4.T4.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">42.76</td>
<td id="S4.T4.1.5.4.4" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">1689.28</td>
<td id="S4.T4.1.5.4.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">1050.49</td>
</tr>
<tr id="S4.T4.1.6.5" class="ltx_tr">
<th id="S4.T4.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T4.1.6.5.1.1" class="ltx_text ltx_font_bold">FedCKA</span></th>
<td id="S4.T4.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">104.17</td>
<td id="S4.T4.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T4.1.6.5.3.1" class="ltx_text ltx_font_bold">49.35</span></td>
<td id="S4.T4.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">750.97</td>
<td id="S4.T4.1.6.5.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S4.T4.1.6.5.5.1" class="ltx_text ltx_font_bold">112.18</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Average Training Duration Per Communication Round (in seconds)</figcaption>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Efficiency and Scalability</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">Efficient and scalable local training is an important engineering principle of Federated Learning. That is, for Federated Learning to be applied to real-world applications, we must assume that clients have limited computing resources. Thus, we analyze the local training time of all methods, as shown in Table <a href="#S4.T4" title="Table 4 ‣ 4.4 Using the Best Similarity Metric ‣ 4 Experimental Results and Analysis ‣ Compare Where It Matters: Using Layer-Wise Regularization To Improve Federated Learning on Heterogeneous Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
Note that FedAvg is the lower bound for training time, since all other methods add a regularization term.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.1" class="ltx_p">For a 7-layer CNN trained on CIFAR-10, the training time for all methods are fairly similar. FedCKA extends training by the largest amount, as the matrix multiplication operation to calculate the CKA similarity is proportionally expensive to the forward and back propagation of the small model.
However, for ResNet-50 trained on Tiny ImageNet, we see that the training time of FedProx, SCAFFOLD, and MOON have increased exponentially. Only FedCKA has comparable training times to FedAvg.
This is because FedProx and SCAFFOLD performs expensive operations on the weights of each layer, and MOON performs forward propagation on three models until the penultimate layer. All these operation scale exponentially as the number of layers increase.
While FedCKA also performs forward propagation on three models, the number of layers remains static, thus being most efficient with medium sized models.</p>
</div>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.1" class="ltx_p">We emphasize that regularization must remain scalable for Federated Learning to be applied to state-of-the-art models. Even on ResNet-50, which is no longer considered a large model, other Federated Learning regularization methods lack scalabililty. This causes difficulty to test these methods with the current state-of-the-art models such as ViT <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al. <a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite> having 1.843 billion parameters, or slightly older models such as EfficientNet-B7 <cite class="ltx_cite ltx_citemacro_citep">(Tan and Le <a href="#bib.bib20" title="" class="ltx_ref">2019</a>)</cite> having 813 layers.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion and Future Work</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Improving the performance of Federated Learning on heterogeneous data is a widely researched topic. However, many previous works have incorrectly suggested that regularizing every layer of neural networks during local training is the best method to increase performance.
We propose FedCKA, built on the most up-to-date understanding of neural networks.
By regularizing naturally similar, but not naturally dissimilar layers during local training, performance improves beyond previous works.
We also show that FedCKA is the only existing regularization method with adequate scalability when trained with a moderate sized model.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">FedCKA shows that the proper regularization of important layers improves the performance of Federated Learning on heterogeneous data. However, standardizing the comparison of neural networks is an important step in a deeper understanding of neural networks. Moreover, there are questions as to the accuracy of CKA in measuring similarity in models such as Transformers or Graph Neural Networks. These are some topics we leave for future works.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brisimi et al. (2018)</span>
<span class="ltx_bibblock">
Brisimi, T. S.; Chen, R.; Mela, T.; Olshevsky, A.; Paschalidis, I. C.; and Shi,
W. 2018.

</span>
<span class="ltx_bibblock">Federated learning of predictive models from federated Electronic
Health Records.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">International Journal of Medical Informatics</em>, 112: 59–67.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020)</span>
<span class="ltx_bibblock">
Chen, T.; Kornblith, S.; Norouzi, M.; and Hinton, G. 2020.

</span>
<span class="ltx_bibblock">A Simple Framework for Contrastive Learning of Visual
Representations.

</span>
<span class="ltx_bibblock">arXiv:2002.05709.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2021)</span>
<span class="ltx_bibblock">
Dosovitskiy, A.; Beyer, L.; Kolesnikov, A.; Weissenborn, D.; Zhai, X.;
Unterthiner, T.; Dehghani, M.; Minderer, M.; Heigold, G.; Gelly, S.;
Uszkoreit, J.; and Houlsby, N. 2021.

</span>
<span class="ltx_bibblock">An Image is Worth 16x16 Words: Transformers for Image Recognition at
Scale.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
He, K.; Zhang, X.; Ren, S.; and Sun, J. 2016.

</span>
<span class="ltx_bibblock">Deep Residual Learning for Image Recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition (CVPR 2016)</em>, 770–778.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu, Qi, and Brown (2019a)</span>
<span class="ltx_bibblock">
Hsu, T.-M. H.; Qi, H.; and Brown, M. 2019a.

</span>
<span class="ltx_bibblock">Measuring the Effects of Non-Identical Data Distribution for
Federated Visual Classification.

</span>
<span class="ltx_bibblock">arXiv:1909.06335.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu, Qi, and Brown (2019b)</span>
<span class="ltx_bibblock">
Hsu, T.-M. H.; Qi, H.; and Brown, M. 2019b.

</span>
<span class="ltx_bibblock">Measuring the Effects of Non-Identical Data Distribution for
Federated Visual Classification.

</span>
<span class="ltx_bibblock">arXiv:1909.06335.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Kairouz, P.; McMahan, H. B.; Avent, B.; Bellet, A.; Bennis, M.; Bhagoji, A. N.;
Bonawitz, K.; Charles, Z.; Cormode, G.; Cummings, R.; D’Oliveira, R. G. L.;
Eichner, H.; Rouayheb, S. E.; Evans, D.; Gardner, J.; Garrett, Z.; Gascón,
A.; Ghazi, B.; Gibbons, P. B.; Gruteser, M.; Harchaoui, Z.; He, C.; He, L.;
Huo, Z.; Hutchinson, B.; Hsu, J.; Jaggi, M.; Javidi, T.; Joshi, G.; Khodak,
M.; Konečný, J.; Korolova, A.; Koushanfar, F.; Koyejo, S.; Lepoint, T.;
Liu, Y.; Mittal, P.; Mohri, M.; Nock, R.; Özgür, A.; Pagh, R.; Raykova, M.;
Qi, H.; Ramage, D.; Raskar, R.; Song, D.; Song, W.; Stich, S. U.; Sun, Z.;
Suresh, A. T.; Tramèr, F.; Vepakomma, P.; Wang, J.; Xiong, L.; Xu, Z.; Yang,
Q.; Yu, F. X.; Yu, H.; and Zhao, S. 2021.

</span>
<span class="ltx_bibblock">Advances and Open Problems in Federated Learning.

</span>
<span class="ltx_bibblock">arXiv:1912.04977.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Karimireddy, S. P.; Kale, S.; Mohri, M.; Reddi, S.; Stich, S.; and Suresh,
A. T. 2020.

</span>
<span class="ltx_bibblock">SCAFFOLD: Stochastic Controlled Averaging for Federated Learning.

</span>
<span class="ltx_bibblock">In III, H. D.; and Singh, A., eds., <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 37th
International Conference on Machine Learning</em>, volume 119 of
<em id="bib.bib8.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, 5132–5143. PMLR.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kornblith et al. (2019)</span>
<span class="ltx_bibblock">
Kornblith, S.; Norouzi, M.; Lee, H.; and Hinton, G. 2019.

</span>
<span class="ltx_bibblock">Similarity of Neural Network Representations Revisited.

</span>
<span class="ltx_bibblock">In Chaudhuri, K.; and Salakhutdinov, R., eds., <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of
the 36th International Conference on Machine Learning</em>, volume 97 of
<em id="bib.bib9.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, 3519–3529. PMLR.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A. 2009.

</span>
<span class="ltx_bibblock">Learning Multiple Layers of Features from Tiny Images.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lecun, Bengio, and Hinton (2015)</span>
<span class="ltx_bibblock">
Lecun, Y.; Bengio, Y.; and Hinton, G. 2015.

</span>
<span class="ltx_bibblock">Deep Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Nature</em>, 521(7553): 436–444.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li, Karpathy, and Johnson (2014)</span>
<span class="ltx_bibblock">
Li, F.-F.; Karpathy, A.; and Johnson, J. 2014.

</span>
<span class="ltx_bibblock">Tiny ImageNet.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li, He, and Song (2021)</span>
<span class="ltx_bibblock">
Li, Q.; He, B.; and Song, D. 2021.

</span>
<span class="ltx_bibblock">Model-Contrastive Federated Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition (CVPR 2021)</em>, 10713–10722.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T.; Sahu, A. K.; Zaheer, M.; Sanjabi, M.; Talwalkar, A.; and Smith, V.
2020.

</span>
<span class="ltx_bibblock">Federated Optimization in Heterogeneous Networks.

</span>
<span class="ltx_bibblock">arXiv:1812.06127.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2021)</span>
<span class="ltx_bibblock">
Lin, T.; Kong, L.; Stich, S. U.; and Jaggi, M. 2021.

</span>
<span class="ltx_bibblock">Ensemble Distillation for Robust Model Fusion in Federated Learning.

</span>
<span class="ltx_bibblock">arXiv:2006.07242.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, H. B.; Moore, E.; Ramage, D.; Hampson, S.; and Arcas, B. A. Y. 2017.

</span>
<span class="ltx_bibblock">Communication-Efficient Learning of Deep Networks from Decentralized
Data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">AISTATS</em>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. (2019)</span>
<span class="ltx_bibblock">
Paszke, A.; Gross, S.; Massa, F.; Lerer, A.; Bradbury, J.; Chanan, G.; Killeen,
T.; Lin, Z.; Gimelshein, N.; Antiga, L.; Desmaison, A.; Kopf, A.; Yang, E.;
DeVito, Z.; Raison, M.; Tejani, A.; Chilamkurthy, S.; Steiner, B.; Fang, L.;
Bai, J.; and Chintala, S. 2019.

</span>
<span class="ltx_bibblock">PyTorch: An Imperative Style, High-Performance Deep Learning Library.

</span>
<span class="ltx_bibblock">In Wallach, H.; Larochelle, H.; Beygelzimer, A.; d'Alché-Buc, F.; Fox, E.; and Garnett, R., eds., <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Advances in Neural
Information Processing Systems 32</em>, 8024–8035. Curran Associates, Inc.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Samarakoon et al. (2020)</span>
<span class="ltx_bibblock">
Samarakoon, S.; Bennis, M.; Saad, W.; and Debbah, M. 2020.

</span>
<span class="ltx_bibblock">Distributed Federated Learning for Ultra-Reliable Low-Latency
Vehicular Communications.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Communications</em>, 68(2): 1146–1159.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sejnowski (2018)</span>
<span class="ltx_bibblock">
Sejnowski, T. J., ed. 2018.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">The Deep Learning Revolution</em>.

</span>
<span class="ltx_bibblock">Cambridge, Massachusetts: The MIT Press.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan and Le (2019)</span>
<span class="ltx_bibblock">
Tan, M.; and Le, Q. 2019.

</span>
<span class="ltx_bibblock">EfficientNet: Rethinking Model Scaling for Convolutional Neural
Networks.

</span>
<span class="ltx_bibblock">In Chaudhuri, K.; and Salakhutdinov, R., eds., <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of
the 36th International Conference on Machine Learning</em>, volume 97 of
<em id="bib.bib20.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, 6105–6114. PMLR.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Verbraeken et al. (2019)</span>
<span class="ltx_bibblock">
Verbraeken, J.; Wolting, M.; Katzy, J.; Kloppenburg, J.; Verbelen, T.; and
Rellermeyer, J. S. 2019.

</span>
<span class="ltx_bibblock">A Survey on Distributed Machine Learning.

</span>
<span class="ltx_bibblock">arXiv:1912.09789.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2020)</span>
<span class="ltx_bibblock">
Yang, K.; Jiang, T.; Shi, Y.; and Ding, Z. 2020.

</span>
<span class="ltx_bibblock">Federated Learning via Over-the-Air Computation.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Wireless Communications</em>, 19(3):
2022–2035.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang, Bengio, and Singer (2019)</span>
<span class="ltx_bibblock">
Zhang, C.; Bengio, S.; and Singer, Y. 2019.

</span>
<span class="ltx_bibblock">Are All Layers Created Equal?

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">ICML 2019 Workshop on Identifying and Understanding Deep
Learning Phenomena</em>. Long Beach, California, United States.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2112.00405" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2112.00407" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2112.00407">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2112.00407" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2112.00408" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 16:10:50 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
