<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1906.10770] Deep Modular Co-Attention Networks for Visual Question Answering</title><meta property="og:description" content="Visual Question Answering (VQA) requires a fine-grained and simultaneous understanding of both the visual content of images and the textual content of questions. Therefore, designing an effective ‘co-attention’ model t…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Deep Modular Co-Attention Networks for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Deep Modular Co-Attention Networks for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1906.10770">

<!--Generated on Sat Mar  2 15:42:50 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Deep Modular Co-Attention Networks for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Zhou Yu<sup id="id2.1.id1" class="ltx_sup">1</sup>  Jun Yu<sup id="id3.2.id2" class="ltx_sup">1</sup>  Yuhao Cui<sup id="id4.3.id3" class="ltx_sup">1</sup>  Dacheng Tao<sup id="id5.4.id4" class="ltx_sup">2</sup>  Qi Tian<sup id="id6.5.id5" class="ltx_sup">3</sup>

<br class="ltx_break"><sup id="id7.6.id6" class="ltx_sup">1</sup>Key Laboratory of Complex Systems Modeling and Simulation, 
<br class="ltx_break">School of Computer Science and Technology, Hangzhou Dianzi University, China.
<br class="ltx_break"><sup id="id8.7.id7" class="ltx_sup">2</sup>UBTECH Sydney AI Centre, School of Computer Science, FEIT, University of Sydney, Australia
<br class="ltx_break"><sup id="id9.8.id8" class="ltx_sup">3</sup>Noah’s Ark Lab, Huawei, China
<br class="ltx_break"><span id="id10.9.id9" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{yuz, yujun, cuiyh}@hdu.edu.cn, dacheng.tao@sydney.edu.au, tian.qi1@huawei.com
</span>
</span><span class="ltx_author_notes">Jun Yu is the corresponding author</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.1" class="ltx_p">Visual Question Answering (VQA) requires a fine-grained and simultaneous understanding of both the visual content of images and the textual content of questions. Therefore, designing an effective ‘co-attention’ model to associate key words in questions with key objects in images is central to VQA performance. So far, most successful attempts at co-attention learning have been achieved by using shallow models, and deep co-attention models show little improvement over their shallow counterparts. In this paper, we propose a deep Modular Co-Attention Network (MCAN) that consists of Modular Co-Attention (MCA) layers cascaded in depth. Each MCA layer models the self-attention of questions and images, as well as the guided-attention of images jointly using a modular composition of two basic attention units. We quantitatively and qualitatively evaluate MCAN on the benchmark VQA-v2 dataset and conduct extensive ablation studies to explore the reasons behind MCAN’s effectiveness. Experimental results demonstrate that MCAN significantly outperforms the previous state-of-the-art. Our best single model delivers 70.63<math id="id1.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="id1.1.m1.1a"><mo id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><csymbol cd="latexml" id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\%</annotation></semantics></math> overall accuracy on the test-dev set. Code is available at <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/MILVLG/mcan-vqa</span>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Multimodal learning to bridge vision and language has gained broad interest from both the computer vision and natural language processing communities. Significant progress has been made in many vision-language tasks, including image-text matching <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, visual captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, visual grounding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> and visual question answering (VQA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. Compared to other multimodal learning tasks, VQA is a more challenging task that requires fine-grained semantic understanding of both the image and the question, together with visual reasoning to predict an accurate answer.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1906.10770/assets/depth_acc_comp.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="274" height="223" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.6.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.7.2" class="ltx_text" style="font-size:90%;">Accuracies <span id="S1.F1.7.2.1" class="ltx_text ltx_font_italic">vs</span>. co-attention depth on VQA-v2 <em id="S1.F1.7.2.2" class="ltx_emph ltx_font_italic">val</em> split. We list most of the state-of-the-art approaches with (deep) co-attention models. Except for DCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> which uses the convolutional visual features and thus leads to inferior performance, all the compared methods (<em id="S1.F1.7.2.3" class="ltx_emph ltx_font_italic">i.e.</em>, MCAN, BAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and MFH <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>) use the same bottom-up attention visual features to represent images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">The attention mechanism is a recent advance in deep neural networks, that has successfully been applied to the unimodal tasks (<em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S1.p2.1.2" class="ltx_text"></span>, vision <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, language <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, and speech <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>),
as well as the aforementioned multimodal tasks.
The idea of learning visual attention on image regions from the input question in VQA was first proposed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, and it becomes a de-facto component of almost all VQA approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Along with visual attention, learning textual attention on the question key words is also very important. Recent works have shown that simultaneously learning co-attention for the visual and textual modalities can benefit the fine-grained representation of the image and question, leading to more accurate prediction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. However, these co-attention models learn the coarse interactions of multimodal instances, and the learned co-attention cannot infer the correlation between each image region and each question word. This results in a significant limitation of these co-attention models.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To overcome the problem of insufficient multimodal interactions, two dense co-attention models BAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and DCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> have been proposed to model dense interactions between any image region and any question word. The dense co-attention mechanism facilitates the understanding of image-question relationship to correctly answer questions. Interestingly, both of these dense co-attention models can be cascaded in depth, form deep co-attention models that support more complex visual reasoning, thereby potentially improving VQA performance. However, these deep models shows little improvement over their corresponding shallow counterparts or the coarse co-attention model MFH <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> (see Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). We think the bottleneck in these deep co-attention models is a deficiency of simultaneously modeling dense self-attention within each modality (<em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">i.e.</em>, word-to-word relationship for questions, and region-to-region relationship for images).</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Inspired by the Transformer model in machine translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, here we design two general attention units: a self-attention (SA) unit that can model the dense intra-modal interactions (word-to-word or region-to-region); and a guided-attention (GA) unit to model the dense inter-modal interactions (word-to-region). After that, by modular composition of the SA and GA units, we obtain different Modular Co-Attention (MCA) layers that can be cascaded in depth. Finally, we propose a deep Modular Co-Attention Network (MCAN) which consists of cascaded MCA layers. Results in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows that a deep MCAN model significantly outperforms existing state-of-the-art co-attention models on the benchmark VQA-v2 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, which verifies the synergy of self-attention and guided-attention in co-attention learning, and also highlights the potential of deep reasoning. Furthermore, we find that modeling self-attention for image regions can greatly improve the object counting performance, which is challenging for VQA.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">We briefly review previous studies on VQA, especially those studies that introduce co-attention models.

<br class="ltx_break"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Visual Question Answering (VQA).</span> VQA has been of increasing interest over the last few years.
The multimodal fusion of global features are the most straightforward VQA solutions. The image and question are first represented as global features and then fused by a multimodal fusion model to predict the answer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. Some approaches introduce a more complex model to learn better question representations with LSTM networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, or a better multimodal fusion model with residual networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">One limitation of the aforementioned multimodal fusion models is that the global feature representation of an image may lose critical information to correctly answer the questions about local image regions (<em id="S2.p2.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S2.p2.1.2" class="ltx_text"></span>, “what is in the woman’s left hand”). Therefore, recent approaches have introduced the visual attention mechanism into VQA by adaptively learning the attended image features for a given question, and then performing multimodal feature fusion to obtain the accurate prediction. Chen <em id="S2.p2.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.4" class="ltx_text"></span> proposed a question-guided attention map that projected the question embeddings into the visual space and formulated a configurable convolutional kernel to search the image attention region <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Yang <em id="S2.p2.1.5" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.6" class="ltx_text"></span> proposed a stacked attention network to learn the attention iteratively <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. Fukui <em id="S2.p2.1.7" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.8" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, Kim <em id="S2.p2.1.9" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.10" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, Yu <em id="S2.p2.1.11" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.12" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and Ben <em id="S2.p2.1.13" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.14" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> exploited different multimodal bilinear pooling methods to integrate the visual features from the image’s spatial grids with the textual features from the questions to predict the attention. Anderson <em id="S2.p2.1.15" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.16" class="ltx_text"></span> introduced a bottom-up and top-down attention mechanism to learn the attention on candidate objects rather than spatial grids <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.

<br class="ltx_break"><span id="S2.p2.1.17" class="ltx_text ltx_font_bold">Co-Attention Models.</span> Beyond understanding the visual contents of the image, VQA also requires to fully understand the semantics of the natural language question. Therefore, it is necessary to learn the textual attention for the question and the visual attention for the image simultaneously. Lu <em id="S2.p2.1.18" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.19" class="ltx_text"></span> proposed a co-attention learning framework to alternately learn the image attention and question attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. Yu <em id="S2.p2.1.20" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.21" class="ltx_text"></span> reduced the co-attention method into two steps, self-attention for a question embedding and the question-conditioned attention for a visual embedding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. Nam <em id="S2.p2.1.22" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.23" class="ltx_text"></span> proposed a multi-stage co-attention learning model to refine the attentions based on memory of previous attentions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. However, these co-attention models learn separate attention distributions for each modality (image or question), and neglect the dense interaction between each question word and each image region. This become a bottleneck for understanding fine-grained relationships of multimodal features. To address this issue, dense co-attention models have been proposed, which establish the complete interaction between each question word and each image region <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Compared to the previous co-attention models with coarse interactions, the dense co-attention models deliver significantly better VQA performance.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Modular Co-Attention Layer</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Before presenting the Modular Co-Attention Network, we first introduce its basic component, the Modular Co-Attention (MCA) layer. The MCA layer is a modular composition of the two basic attention units, <em id="S3.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.p1.1.2" class="ltx_text"></span>, the self-attention (SA) unit and the guided-attention (GA) unit, inspired by the <em id="S3.p1.1.3" class="ltx_emph ltx_font_italic">scaled dot-product attention</em> proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. Using different combinations, we obtain three MCA variants with different motivations.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Self-Attention and Guided-Attention Units</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.14" class="ltx_p">The input of scaled dot-product attention consists of queries and keys of dimension <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="d_{\mathrm{key}}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">d</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">key</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑑</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">key</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">d_{\mathrm{key}}</annotation></semantics></math>, and values of dimension <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="d_{\mathrm{value}}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">d</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">value</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑑</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">value</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">d_{\mathrm{value}}</annotation></semantics></math>. For simplicity, <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="d_{\mathrm{key}}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">d</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">key</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑑</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">key</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">d_{\mathrm{key}}</annotation></semantics></math> and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="d_{\mathrm{value}}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">d</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">value</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑑</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">value</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">d_{\mathrm{value}}</annotation></semantics></math> are usually set to the same number <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">d</annotation></semantics></math>. We calculate the dot products of the query with all keys, divide each by <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\sqrt{d}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msqrt id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">d</mi></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><root id="S3.SS1.p1.6.m6.1.1a.cmml" xref="S3.SS1.p1.6.m6.1.1"></root><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\sqrt{d}</annotation></semantics></math> and apply a softmax function to obtain the attention weights on the values. Given a query <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="q\in\mathbb{R}^{1\times d}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">q</mi><mo id="S3.SS1.p1.7.m7.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml"><mn id="S3.SS1.p1.7.m7.1.1.3.3.2" xref="S3.SS1.p1.7.m7.1.1.3.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.7.m7.1.1.3.3.1" xref="S3.SS1.p1.7.m7.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.7.m7.1.1.3.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><in id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1"></in><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑞</ci><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3"><times id="S3.SS1.p1.7.m7.1.1.3.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3.1"></times><cn type="integer" id="S3.SS1.p1.7.m7.1.1.3.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3.2">1</cn><ci id="S3.SS1.p1.7.m7.1.1.3.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">q\in\mathbb{R}^{1\times d}</annotation></semantics></math>, <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">n</annotation></semantics></math> key-value pairs (packed into a key matrix <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="K\in\mathbb{R}^{n\times d}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">K</mi><mo id="S3.SS1.p1.9.m9.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml"><mi id="S3.SS1.p1.9.m9.1.1.3.2" xref="S3.SS1.p1.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.9.m9.1.1.3.3" xref="S3.SS1.p1.9.m9.1.1.3.3.cmml"><mi id="S3.SS1.p1.9.m9.1.1.3.3.2" xref="S3.SS1.p1.9.m9.1.1.3.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.9.m9.1.1.3.3.1" xref="S3.SS1.p1.9.m9.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.9.m9.1.1.3.3.3" xref="S3.SS1.p1.9.m9.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><in id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1"></in><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝐾</ci><apply id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.9.m9.1.1.3.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.3"><times id="S3.SS1.p1.9.m9.1.1.3.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.3.1"></times><ci id="S3.SS1.p1.9.m9.1.1.3.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.3.2">𝑛</ci><ci id="S3.SS1.p1.9.m9.1.1.3.3.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">K\in\mathbb{R}^{n\times d}</annotation></semantics></math> and a value matrix <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="V\in\mathbb{R}^{n\times d}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><mrow id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">V</mi><mo id="S3.SS1.p1.10.m10.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.3.2" xref="S3.SS1.p1.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.10.m10.1.1.3.3" xref="S3.SS1.p1.10.m10.1.1.3.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.3.3.2" xref="S3.SS1.p1.10.m10.1.1.3.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.10.m10.1.1.3.3.1" xref="S3.SS1.p1.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.10.m10.1.1.3.3.3" xref="S3.SS1.p1.10.m10.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><in id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1"></in><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝑉</ci><apply id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.10.m10.1.1.3.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3.3"><times id="S3.SS1.p1.10.m10.1.1.3.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.3.3.1"></times><ci id="S3.SS1.p1.10.m10.1.1.3.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.3.3.2">𝑛</ci><ci id="S3.SS1.p1.10.m10.1.1.3.3.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">V\in\mathbb{R}^{n\times d}</annotation></semantics></math>), the attended feature <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="f\in\mathbb{R}^{1\times d}" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mrow id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml">f</mi><mo id="S3.SS1.p1.11.m11.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.3.2" xref="S3.SS1.p1.11.m11.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.11.m11.1.1.3.3" xref="S3.SS1.p1.11.m11.1.1.3.3.cmml"><mn id="S3.SS1.p1.11.m11.1.1.3.3.2" xref="S3.SS1.p1.11.m11.1.1.3.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.11.m11.1.1.3.3.1" xref="S3.SS1.p1.11.m11.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.11.m11.1.1.3.3.3" xref="S3.SS1.p1.11.m11.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><in id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1"></in><ci id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2">𝑓</ci><apply id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.11.m11.1.1.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3"><times id="S3.SS1.p1.11.m11.1.1.3.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.1"></times><cn type="integer" id="S3.SS1.p1.11.m11.1.1.3.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.2">1</cn><ci id="S3.SS1.p1.11.m11.1.1.3.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">f\in\mathbb{R}^{1\times d}</annotation></semantics></math> is obtained by weighted summation over all values <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><mi id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">V</annotation></semantics></math> with respect to the attention learned from <math id="S3.SS1.p1.13.m13.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.p1.13.m13.1a"><mi id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><ci id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">q</annotation></semantics></math> and <math id="S3.SS1.p1.14.m14.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.14.m14.1a"><mi id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><ci id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">K</annotation></semantics></math>:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="f=A(q,K,V)=\mathrm{softmax}(\frac{qK^{T}}{\sqrt{d}})V" display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.5" xref="S3.E1.m1.4.5.cmml"><mi id="S3.E1.m1.4.5.2" xref="S3.E1.m1.4.5.2.cmml">f</mi><mo id="S3.E1.m1.4.5.3" xref="S3.E1.m1.4.5.3.cmml">=</mo><mrow id="S3.E1.m1.4.5.4" xref="S3.E1.m1.4.5.4.cmml"><mi id="S3.E1.m1.4.5.4.2" xref="S3.E1.m1.4.5.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.5.4.1" xref="S3.E1.m1.4.5.4.1.cmml">​</mo><mrow id="S3.E1.m1.4.5.4.3.2" xref="S3.E1.m1.4.5.4.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.4.5.4.3.2.1" xref="S3.E1.m1.4.5.4.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">q</mi><mo id="S3.E1.m1.4.5.4.3.2.2" xref="S3.E1.m1.4.5.4.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">K</mi><mo id="S3.E1.m1.4.5.4.3.2.3" xref="S3.E1.m1.4.5.4.3.1.cmml">,</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">V</mi><mo stretchy="false" id="S3.E1.m1.4.5.4.3.2.4" xref="S3.E1.m1.4.5.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.5.5" xref="S3.E1.m1.4.5.5.cmml">=</mo><mrow id="S3.E1.m1.4.5.6" xref="S3.E1.m1.4.5.6.cmml"><mi id="S3.E1.m1.4.5.6.2" xref="S3.E1.m1.4.5.6.2.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.5.6.1" xref="S3.E1.m1.4.5.6.1.cmml">​</mo><mrow id="S3.E1.m1.4.5.6.3.2" xref="S3.E1.m1.4.4.cmml"><mo stretchy="false" id="S3.E1.m1.4.5.6.3.2.1" xref="S3.E1.m1.4.4.cmml">(</mo><mfrac id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mrow id="S3.E1.m1.4.4.2" xref="S3.E1.m1.4.4.2.cmml"><mi id="S3.E1.m1.4.4.2.2" xref="S3.E1.m1.4.4.2.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.2.1" xref="S3.E1.m1.4.4.2.1.cmml">​</mo><msup id="S3.E1.m1.4.4.2.3" xref="S3.E1.m1.4.4.2.3.cmml"><mi id="S3.E1.m1.4.4.2.3.2" xref="S3.E1.m1.4.4.2.3.2.cmml">K</mi><mi id="S3.E1.m1.4.4.2.3.3" xref="S3.E1.m1.4.4.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S3.E1.m1.4.4.3" xref="S3.E1.m1.4.4.3.cmml"><mi id="S3.E1.m1.4.4.3.2" xref="S3.E1.m1.4.4.3.2.cmml">d</mi></msqrt></mfrac><mo stretchy="false" id="S3.E1.m1.4.5.6.3.2.2" xref="S3.E1.m1.4.4.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.5.6.1a" xref="S3.E1.m1.4.5.6.1.cmml">​</mo><mi id="S3.E1.m1.4.5.6.4" xref="S3.E1.m1.4.5.6.4.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.5.cmml" xref="S3.E1.m1.4.5"><and id="S3.E1.m1.4.5a.cmml" xref="S3.E1.m1.4.5"></and><apply id="S3.E1.m1.4.5b.cmml" xref="S3.E1.m1.4.5"><eq id="S3.E1.m1.4.5.3.cmml" xref="S3.E1.m1.4.5.3"></eq><ci id="S3.E1.m1.4.5.2.cmml" xref="S3.E1.m1.4.5.2">𝑓</ci><apply id="S3.E1.m1.4.5.4.cmml" xref="S3.E1.m1.4.5.4"><times id="S3.E1.m1.4.5.4.1.cmml" xref="S3.E1.m1.4.5.4.1"></times><ci id="S3.E1.m1.4.5.4.2.cmml" xref="S3.E1.m1.4.5.4.2">𝐴</ci><vector id="S3.E1.m1.4.5.4.3.1.cmml" xref="S3.E1.m1.4.5.4.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑞</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐾</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑉</ci></vector></apply></apply><apply id="S3.E1.m1.4.5c.cmml" xref="S3.E1.m1.4.5"><eq id="S3.E1.m1.4.5.5.cmml" xref="S3.E1.m1.4.5.5"></eq><share href="#S3.E1.m1.4.5.4.cmml" id="S3.E1.m1.4.5d.cmml" xref="S3.E1.m1.4.5"></share><apply id="S3.E1.m1.4.5.6.cmml" xref="S3.E1.m1.4.5.6"><times id="S3.E1.m1.4.5.6.1.cmml" xref="S3.E1.m1.4.5.6.1"></times><ci id="S3.E1.m1.4.5.6.2.cmml" xref="S3.E1.m1.4.5.6.2">softmax</ci><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.5.6.3.2"><divide id="S3.E1.m1.4.4.1.cmml" xref="S3.E1.m1.4.5.6.3.2"></divide><apply id="S3.E1.m1.4.4.2.cmml" xref="S3.E1.m1.4.4.2"><times id="S3.E1.m1.4.4.2.1.cmml" xref="S3.E1.m1.4.4.2.1"></times><ci id="S3.E1.m1.4.4.2.2.cmml" xref="S3.E1.m1.4.4.2.2">𝑞</ci><apply id="S3.E1.m1.4.4.2.3.cmml" xref="S3.E1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.2.3.1.cmml" xref="S3.E1.m1.4.4.2.3">superscript</csymbol><ci id="S3.E1.m1.4.4.2.3.2.cmml" xref="S3.E1.m1.4.4.2.3.2">𝐾</ci><ci id="S3.E1.m1.4.4.2.3.3.cmml" xref="S3.E1.m1.4.4.2.3.3">𝑇</ci></apply></apply><apply id="S3.E1.m1.4.4.3.cmml" xref="S3.E1.m1.4.4.3"><root id="S3.E1.m1.4.4.3a.cmml" xref="S3.E1.m1.4.4.3"></root><ci id="S3.E1.m1.4.4.3.2.cmml" xref="S3.E1.m1.4.4.3.2">𝑑</ci></apply></apply><ci id="S3.E1.m1.4.5.6.4.cmml" xref="S3.E1.m1.4.5.6.4">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">f=A(q,K,V)=\mathrm{softmax}(\frac{qK^{T}}{\sqrt{d}})V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1906.10770/assets/x1.png" id="S3.F2.sf1.g1" class="ltx_graphics ltx_img_portrait" width="460" height="764" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S3.F2.sf1.3.2" class="ltx_text" style="font-size:90%;">Self-Attention (SA)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1906.10770/assets/x2.png" id="S3.F2.sf2.g1" class="ltx_graphics ltx_img_portrait" width="461" height="736" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S3.F2.sf2.3.2" class="ltx_text" style="font-size:90%;">Guided-Attention (GA)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.18.9.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.16.8" class="ltx_text" style="font-size:90%;">Two basic attention units with multi-head attention for different types of inputs. SA takes one group of input features <math id="S3.F2.9.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.F2.9.1.m1.1b"><mi id="S3.F2.9.1.m1.1.1" xref="S3.F2.9.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.F2.9.1.m1.1c"><ci id="S3.F2.9.1.m1.1.1.cmml" xref="S3.F2.9.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.9.1.m1.1d">X</annotation></semantics></math> and output the attended features <math id="S3.F2.10.2.m2.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S3.F2.10.2.m2.1b"><mi id="S3.F2.10.2.m2.1.1" xref="S3.F2.10.2.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.F2.10.2.m2.1c"><ci id="S3.F2.10.2.m2.1.1.cmml" xref="S3.F2.10.2.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.10.2.m2.1d">Z</annotation></semantics></math> for <math id="S3.F2.11.3.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.F2.11.3.m3.1b"><mi id="S3.F2.11.3.m3.1.1" xref="S3.F2.11.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.F2.11.3.m3.1c"><ci id="S3.F2.11.3.m3.1.1.cmml" xref="S3.F2.11.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.11.3.m3.1d">X</annotation></semantics></math>; GA takes two groups of input features <math id="S3.F2.12.4.m4.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.F2.12.4.m4.1b"><mi id="S3.F2.12.4.m4.1.1" xref="S3.F2.12.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.F2.12.4.m4.1c"><ci id="S3.F2.12.4.m4.1.1.cmml" xref="S3.F2.12.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.12.4.m4.1d">X</annotation></semantics></math> and <math id="S3.F2.13.5.m5.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S3.F2.13.5.m5.1b"><mi id="S3.F2.13.5.m5.1.1" xref="S3.F2.13.5.m5.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.F2.13.5.m5.1c"><ci id="S3.F2.13.5.m5.1.1.cmml" xref="S3.F2.13.5.m5.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.13.5.m5.1d">Y</annotation></semantics></math> and output the attended features <math id="S3.F2.14.6.m6.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S3.F2.14.6.m6.1b"><mi id="S3.F2.14.6.m6.1.1" xref="S3.F2.14.6.m6.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.F2.14.6.m6.1c"><ci id="S3.F2.14.6.m6.1.1.cmml" xref="S3.F2.14.6.m6.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.14.6.m6.1d">Z</annotation></semantics></math> for <math id="S3.F2.15.7.m7.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.F2.15.7.m7.1b"><mi id="S3.F2.15.7.m7.1.1" xref="S3.F2.15.7.m7.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.F2.15.7.m7.1c"><ci id="S3.F2.15.7.m7.1.1.cmml" xref="S3.F2.15.7.m7.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.15.7.m7.1d">X</annotation></semantics></math> guided by <math id="S3.F2.16.8.m8.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S3.F2.16.8.m8.1b"><mi id="S3.F2.16.8.m8.1.1" xref="S3.F2.16.8.m8.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.F2.16.8.m8.1c"><ci id="S3.F2.16.8.m8.1.1.cmml" xref="S3.F2.16.8.m8.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.16.8.m8.1d">Y</annotation></semantics></math>.</span></figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.2" class="ltx_p">To further improve the representation capacity of the attended features, <em id="S3.SS1.p2.2.1" class="ltx_emph ltx_font_italic">multi-head attention</em> is introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, which consists of <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">h</annotation></semantics></math> paralleled ‘heads’. Each head corresponds to an independent scaled dot-product attention function. The attended output features <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">f</annotation></semantics></math> is given by:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.7" class="ltx_Math" alttext="f=MA(q,K,V)=[\mathrm{head}_{1},\mathrm{head}_{2},...,\mathrm{head}_{h}]W^{o}" display="block"><semantics id="S3.E2.m1.7a"><mrow id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml"><mi id="S3.E2.m1.7.7.5" xref="S3.E2.m1.7.7.5.cmml">f</mi><mo id="S3.E2.m1.7.7.6" xref="S3.E2.m1.7.7.6.cmml">=</mo><mrow id="S3.E2.m1.7.7.7" xref="S3.E2.m1.7.7.7.cmml"><mi id="S3.E2.m1.7.7.7.2" xref="S3.E2.m1.7.7.7.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.7.1" xref="S3.E2.m1.7.7.7.1.cmml">​</mo><mi id="S3.E2.m1.7.7.7.3" xref="S3.E2.m1.7.7.7.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.7.1a" xref="S3.E2.m1.7.7.7.1.cmml">​</mo><mrow id="S3.E2.m1.7.7.7.4.2" xref="S3.E2.m1.7.7.7.4.1.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.7.4.2.1" xref="S3.E2.m1.7.7.7.4.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">q</mi><mo id="S3.E2.m1.7.7.7.4.2.2" xref="S3.E2.m1.7.7.7.4.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">K</mi><mo id="S3.E2.m1.7.7.7.4.2.3" xref="S3.E2.m1.7.7.7.4.1.cmml">,</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">V</mi><mo stretchy="false" id="S3.E2.m1.7.7.7.4.2.4" xref="S3.E2.m1.7.7.7.4.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.7.7.8" xref="S3.E2.m1.7.7.8.cmml">=</mo><mrow id="S3.E2.m1.7.7.3" xref="S3.E2.m1.7.7.3.cmml"><mrow id="S3.E2.m1.7.7.3.3.3" xref="S3.E2.m1.7.7.3.3.4.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.3.3.3.4" xref="S3.E2.m1.7.7.3.3.4.cmml">[</mo><msub id="S3.E2.m1.5.5.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.2.cmml">head</mi><mn id="S3.E2.m1.5.5.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E2.m1.7.7.3.3.3.5" xref="S3.E2.m1.7.7.3.3.4.cmml">,</mo><msub id="S3.E2.m1.6.6.2.2.2.2" xref="S3.E2.m1.6.6.2.2.2.2.cmml"><mi id="S3.E2.m1.6.6.2.2.2.2.2" xref="S3.E2.m1.6.6.2.2.2.2.2.cmml">head</mi><mn id="S3.E2.m1.6.6.2.2.2.2.3" xref="S3.E2.m1.6.6.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.E2.m1.7.7.3.3.3.6" xref="S3.E2.m1.7.7.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">…</mi><mo id="S3.E2.m1.7.7.3.3.3.7" xref="S3.E2.m1.7.7.3.3.4.cmml">,</mo><msub id="S3.E2.m1.7.7.3.3.3.3" xref="S3.E2.m1.7.7.3.3.3.3.cmml"><mi id="S3.E2.m1.7.7.3.3.3.3.2" xref="S3.E2.m1.7.7.3.3.3.3.2.cmml">head</mi><mi id="S3.E2.m1.7.7.3.3.3.3.3" xref="S3.E2.m1.7.7.3.3.3.3.3.cmml">h</mi></msub><mo stretchy="false" id="S3.E2.m1.7.7.3.3.3.8" xref="S3.E2.m1.7.7.3.3.4.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.3.4" xref="S3.E2.m1.7.7.3.4.cmml">​</mo><msup id="S3.E2.m1.7.7.3.5" xref="S3.E2.m1.7.7.3.5.cmml"><mi id="S3.E2.m1.7.7.3.5.2" xref="S3.E2.m1.7.7.3.5.2.cmml">W</mi><mi id="S3.E2.m1.7.7.3.5.3" xref="S3.E2.m1.7.7.3.5.3.cmml">o</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.7b"><apply id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7"><and id="S3.E2.m1.7.7a.cmml" xref="S3.E2.m1.7.7"></and><apply id="S3.E2.m1.7.7b.cmml" xref="S3.E2.m1.7.7"><eq id="S3.E2.m1.7.7.6.cmml" xref="S3.E2.m1.7.7.6"></eq><ci id="S3.E2.m1.7.7.5.cmml" xref="S3.E2.m1.7.7.5">𝑓</ci><apply id="S3.E2.m1.7.7.7.cmml" xref="S3.E2.m1.7.7.7"><times id="S3.E2.m1.7.7.7.1.cmml" xref="S3.E2.m1.7.7.7.1"></times><ci id="S3.E2.m1.7.7.7.2.cmml" xref="S3.E2.m1.7.7.7.2">𝑀</ci><ci id="S3.E2.m1.7.7.7.3.cmml" xref="S3.E2.m1.7.7.7.3">𝐴</ci><vector id="S3.E2.m1.7.7.7.4.1.cmml" xref="S3.E2.m1.7.7.7.4.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑞</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝐾</ci><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝑉</ci></vector></apply></apply><apply id="S3.E2.m1.7.7c.cmml" xref="S3.E2.m1.7.7"><eq id="S3.E2.m1.7.7.8.cmml" xref="S3.E2.m1.7.7.8"></eq><share href="#S3.E2.m1.7.7.7.cmml" id="S3.E2.m1.7.7d.cmml" xref="S3.E2.m1.7.7"></share><apply id="S3.E2.m1.7.7.3.cmml" xref="S3.E2.m1.7.7.3"><times id="S3.E2.m1.7.7.3.4.cmml" xref="S3.E2.m1.7.7.3.4"></times><list id="S3.E2.m1.7.7.3.3.4.cmml" xref="S3.E2.m1.7.7.3.3.3"><apply id="S3.E2.m1.5.5.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2">head</ci><cn type="integer" id="S3.E2.m1.5.5.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3">1</cn></apply><apply id="S3.E2.m1.6.6.2.2.2.2.cmml" xref="S3.E2.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.2.2.2.2.1.cmml" xref="S3.E2.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.6.6.2.2.2.2.2.cmml" xref="S3.E2.m1.6.6.2.2.2.2.2">head</ci><cn type="integer" id="S3.E2.m1.6.6.2.2.2.2.3.cmml" xref="S3.E2.m1.6.6.2.2.2.2.3">2</cn></apply><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">…</ci><apply id="S3.E2.m1.7.7.3.3.3.3.cmml" xref="S3.E2.m1.7.7.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.3.3.3.3.1.cmml" xref="S3.E2.m1.7.7.3.3.3.3">subscript</csymbol><ci id="S3.E2.m1.7.7.3.3.3.3.2.cmml" xref="S3.E2.m1.7.7.3.3.3.3.2">head</ci><ci id="S3.E2.m1.7.7.3.3.3.3.3.cmml" xref="S3.E2.m1.7.7.3.3.3.3.3">ℎ</ci></apply></list><apply id="S3.E2.m1.7.7.3.5.cmml" xref="S3.E2.m1.7.7.3.5"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.3.5.1.cmml" xref="S3.E2.m1.7.7.3.5">superscript</csymbol><ci id="S3.E2.m1.7.7.3.5.2.cmml" xref="S3.E2.m1.7.7.3.5.2">𝑊</ci><ci id="S3.E2.m1.7.7.3.5.3.cmml" xref="S3.E2.m1.7.7.3.5.3">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.7c">f=MA(q,K,V)=[\mathrm{head}_{1},\mathrm{head}_{2},...,\mathrm{head}_{h}]W^{o}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.3" class="ltx_Math" alttext="\mathrm{head}_{j}=A(qW_{j}^{Q},KW_{j}^{K},VW_{j}^{V})" display="block"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml"><msub id="S3.E3.m1.3.3.5" xref="S3.E3.m1.3.3.5.cmml"><mi id="S3.E3.m1.3.3.5.2" xref="S3.E3.m1.3.3.5.2.cmml">head</mi><mi id="S3.E3.m1.3.3.5.3" xref="S3.E3.m1.3.3.5.3.cmml">j</mi></msub><mo id="S3.E3.m1.3.3.4" xref="S3.E3.m1.3.3.4.cmml">=</mo><mrow id="S3.E3.m1.3.3.3" xref="S3.E3.m1.3.3.3.cmml"><mi id="S3.E3.m1.3.3.3.5" xref="S3.E3.m1.3.3.3.5.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.3.4" xref="S3.E3.m1.3.3.3.4.cmml">​</mo><mrow id="S3.E3.m1.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.4.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.3.3.3.4" xref="S3.E3.m1.3.3.3.3.4.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.cmml">j</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.3.cmml">Q</mi></msubsup></mrow><mo id="S3.E3.m1.3.3.3.3.3.5" xref="S3.E3.m1.3.3.3.3.4.cmml">,</mo><mrow id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.2.1.cmml">​</mo><msubsup id="S3.E3.m1.2.2.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.3.2.2" xref="S3.E3.m1.2.2.2.2.2.2.3.2.2.cmml">W</mi><mi id="S3.E3.m1.2.2.2.2.2.2.3.2.3" xref="S3.E3.m1.2.2.2.2.2.2.3.2.3.cmml">j</mi><mi id="S3.E3.m1.2.2.2.2.2.2.3.3" xref="S3.E3.m1.2.2.2.2.2.2.3.3.cmml">K</mi></msubsup></mrow><mo id="S3.E3.m1.3.3.3.3.3.6" xref="S3.E3.m1.3.3.3.3.4.cmml">,</mo><mrow id="S3.E3.m1.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.cmml"><mi id="S3.E3.m1.3.3.3.3.3.3.2" xref="S3.E3.m1.3.3.3.3.3.3.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.3.3.3.3.1" xref="S3.E3.m1.3.3.3.3.3.3.1.cmml">​</mo><msubsup id="S3.E3.m1.3.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.3.cmml"><mi id="S3.E3.m1.3.3.3.3.3.3.3.2.2" xref="S3.E3.m1.3.3.3.3.3.3.3.2.2.cmml">W</mi><mi id="S3.E3.m1.3.3.3.3.3.3.3.2.3" xref="S3.E3.m1.3.3.3.3.3.3.3.2.3.cmml">j</mi><mi id="S3.E3.m1.3.3.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.3.3.cmml">V</mi></msubsup></mrow><mo stretchy="false" id="S3.E3.m1.3.3.3.3.3.7" xref="S3.E3.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3"><eq id="S3.E3.m1.3.3.4.cmml" xref="S3.E3.m1.3.3.4"></eq><apply id="S3.E3.m1.3.3.5.cmml" xref="S3.E3.m1.3.3.5"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.5.1.cmml" xref="S3.E3.m1.3.3.5">subscript</csymbol><ci id="S3.E3.m1.3.3.5.2.cmml" xref="S3.E3.m1.3.3.5.2">head</ci><ci id="S3.E3.m1.3.3.5.3.cmml" xref="S3.E3.m1.3.3.5.3">𝑗</ci></apply><apply id="S3.E3.m1.3.3.3.cmml" xref="S3.E3.m1.3.3.3"><times id="S3.E3.m1.3.3.3.4.cmml" xref="S3.E3.m1.3.3.3.4"></times><ci id="S3.E3.m1.3.3.3.5.cmml" xref="S3.E3.m1.3.3.3.5">𝐴</ci><vector id="S3.E3.m1.3.3.3.3.4.cmml" xref="S3.E3.m1.3.3.3.3.3"><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">𝑞</ci><apply id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2">𝑊</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3">𝑗</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply><apply id="S3.E3.m1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2"><times id="S3.E3.m1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1"></times><ci id="S3.E3.m1.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.2">𝐾</ci><apply id="S3.E3.m1.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.3">superscript</csymbol><apply id="S3.E3.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.2.3.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.3.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.3.2.2">𝑊</ci><ci id="S3.E3.m1.2.2.2.2.2.2.3.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.3.2.3">𝑗</ci></apply><ci id="S3.E3.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.3.3">𝐾</ci></apply></apply><apply id="S3.E3.m1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3"><times id="S3.E3.m1.3.3.3.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1"></times><ci id="S3.E3.m1.3.3.3.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3.3.3.3.2">𝑉</ci><apply id="S3.E3.m1.3.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.3.3.3.3">superscript</csymbol><apply id="S3.E3.m1.3.3.3.3.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.3.3.3.2.1.cmml" xref="S3.E3.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.3.3.3.2.2.cmml" xref="S3.E3.m1.3.3.3.3.3.3.3.2.2">𝑊</ci><ci id="S3.E3.m1.3.3.3.3.3.3.3.2.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3.3.2.3">𝑗</ci></apply><ci id="S3.E3.m1.3.3.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3.3.3">𝑉</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\mathrm{head}_{j}=A(qW_{j}^{Q},KW_{j}^{K},VW_{j}^{V})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p3.10" class="ltx_p">where <math id="S3.SS1.p3.1.m1.3" class="ltx_Math" alttext="W_{j}^{Q},W_{j}^{K},W_{j}^{V}\in\mathbb{R}^{d\times d_{h}}" display="inline"><semantics id="S3.SS1.p3.1.m1.3a"><mrow id="S3.SS1.p3.1.m1.3.3" xref="S3.SS1.p3.1.m1.3.3.cmml"><mrow id="S3.SS1.p3.1.m1.3.3.3.3" xref="S3.SS1.p3.1.m1.3.3.3.4.cmml"><msubsup id="S3.SS1.p3.1.m1.1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.1.1.1.2.2" xref="S3.SS1.p3.1.m1.1.1.1.1.1.2.2.cmml">W</mi><mi id="S3.SS1.p3.1.m1.1.1.1.1.1.2.3" xref="S3.SS1.p3.1.m1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S3.SS1.p3.1.m1.1.1.1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.1.1.1.3.cmml">Q</mi></msubsup><mo id="S3.SS1.p3.1.m1.3.3.3.3.4" xref="S3.SS1.p3.1.m1.3.3.3.4.cmml">,</mo><msubsup id="S3.SS1.p3.1.m1.2.2.2.2.2" xref="S3.SS1.p3.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS1.p3.1.m1.2.2.2.2.2.2.2" xref="S3.SS1.p3.1.m1.2.2.2.2.2.2.2.cmml">W</mi><mi id="S3.SS1.p3.1.m1.2.2.2.2.2.2.3" xref="S3.SS1.p3.1.m1.2.2.2.2.2.2.3.cmml">j</mi><mi id="S3.SS1.p3.1.m1.2.2.2.2.2.3" xref="S3.SS1.p3.1.m1.2.2.2.2.2.3.cmml">K</mi></msubsup><mo id="S3.SS1.p3.1.m1.3.3.3.3.5" xref="S3.SS1.p3.1.m1.3.3.3.4.cmml">,</mo><msubsup id="S3.SS1.p3.1.m1.3.3.3.3.3" xref="S3.SS1.p3.1.m1.3.3.3.3.3.cmml"><mi id="S3.SS1.p3.1.m1.3.3.3.3.3.2.2" xref="S3.SS1.p3.1.m1.3.3.3.3.3.2.2.cmml">W</mi><mi id="S3.SS1.p3.1.m1.3.3.3.3.3.2.3" xref="S3.SS1.p3.1.m1.3.3.3.3.3.2.3.cmml">j</mi><mi id="S3.SS1.p3.1.m1.3.3.3.3.3.3" xref="S3.SS1.p3.1.m1.3.3.3.3.3.3.cmml">V</mi></msubsup></mrow><mo id="S3.SS1.p3.1.m1.3.3.4" xref="S3.SS1.p3.1.m1.3.3.4.cmml">∈</mo><msup id="S3.SS1.p3.1.m1.3.3.5" xref="S3.SS1.p3.1.m1.3.3.5.cmml"><mi id="S3.SS1.p3.1.m1.3.3.5.2" xref="S3.SS1.p3.1.m1.3.3.5.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.1.m1.3.3.5.3" xref="S3.SS1.p3.1.m1.3.3.5.3.cmml"><mi id="S3.SS1.p3.1.m1.3.3.5.3.2" xref="S3.SS1.p3.1.m1.3.3.5.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.1.m1.3.3.5.3.1" xref="S3.SS1.p3.1.m1.3.3.5.3.1.cmml">×</mo><msub id="S3.SS1.p3.1.m1.3.3.5.3.3" xref="S3.SS1.p3.1.m1.3.3.5.3.3.cmml"><mi id="S3.SS1.p3.1.m1.3.3.5.3.3.2" xref="S3.SS1.p3.1.m1.3.3.5.3.3.2.cmml">d</mi><mi id="S3.SS1.p3.1.m1.3.3.5.3.3.3" xref="S3.SS1.p3.1.m1.3.3.5.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.3b"><apply id="S3.SS1.p3.1.m1.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3"><in id="S3.SS1.p3.1.m1.3.3.4.cmml" xref="S3.SS1.p3.1.m1.3.3.4"></in><list id="S3.SS1.p3.1.m1.3.3.3.4.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3"><apply id="S3.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p3.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1.2.2">𝑊</ci><ci id="S3.SS1.p3.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS1.p3.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1.3">𝑄</ci></apply><apply id="S3.SS1.p3.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2">superscript</csymbol><apply id="S3.SS1.p3.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2.2.2">𝑊</ci><ci id="S3.SS1.p3.1.m1.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S3.SS1.p3.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2.3">𝐾</ci></apply><apply id="S3.SS1.p3.1.m1.3.3.3.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.3.3.3.3.3.1.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.3">superscript</csymbol><apply id="S3.SS1.p3.1.m1.3.3.3.3.3.2.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.3.3.3.3.3.2.1.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p3.1.m1.3.3.3.3.3.2.2.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.3.2.2">𝑊</ci><ci id="S3.SS1.p3.1.m1.3.3.3.3.3.2.3.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.3.2.3">𝑗</ci></apply><ci id="S3.SS1.p3.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.3.3">𝑉</ci></apply></list><apply id="S3.SS1.p3.1.m1.3.3.5.cmml" xref="S3.SS1.p3.1.m1.3.3.5"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.3.3.5.1.cmml" xref="S3.SS1.p3.1.m1.3.3.5">superscript</csymbol><ci id="S3.SS1.p3.1.m1.3.3.5.2.cmml" xref="S3.SS1.p3.1.m1.3.3.5.2">ℝ</ci><apply id="S3.SS1.p3.1.m1.3.3.5.3.cmml" xref="S3.SS1.p3.1.m1.3.3.5.3"><times id="S3.SS1.p3.1.m1.3.3.5.3.1.cmml" xref="S3.SS1.p3.1.m1.3.3.5.3.1"></times><ci id="S3.SS1.p3.1.m1.3.3.5.3.2.cmml" xref="S3.SS1.p3.1.m1.3.3.5.3.2">𝑑</ci><apply id="S3.SS1.p3.1.m1.3.3.5.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3.5.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.3.3.5.3.3.1.cmml" xref="S3.SS1.p3.1.m1.3.3.5.3.3">subscript</csymbol><ci id="S3.SS1.p3.1.m1.3.3.5.3.3.2.cmml" xref="S3.SS1.p3.1.m1.3.3.5.3.3.2">𝑑</ci><ci id="S3.SS1.p3.1.m1.3.3.5.3.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3.5.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.3c">W_{j}^{Q},W_{j}^{K},W_{j}^{V}\in\mathbb{R}^{d\times d_{h}}</annotation></semantics></math> are the projection matrices for the <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">j</annotation></semantics></math>-th head, and <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="W_{o}\in\mathbb{R}^{h*d_{h}\times d}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mrow id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><msub id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2.2" xref="S3.SS1.p3.3.m3.1.1.2.2.cmml">W</mi><mi id="S3.SS1.p3.3.m3.1.1.2.3" xref="S3.SS1.p3.3.m3.1.1.2.3.cmml">o</mi></msub><mo id="S3.SS1.p3.3.m3.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml"><mi id="S3.SS1.p3.3.m3.1.1.3.2" xref="S3.SS1.p3.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.3.m3.1.1.3.3" xref="S3.SS1.p3.3.m3.1.1.3.3.cmml"><mrow id="S3.SS1.p3.3.m3.1.1.3.3.2" xref="S3.SS1.p3.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS1.p3.3.m3.1.1.3.3.2.2" xref="S3.SS1.p3.3.m3.1.1.3.3.2.2.cmml">h</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.3.m3.1.1.3.3.2.1" xref="S3.SS1.p3.3.m3.1.1.3.3.2.1.cmml">∗</mo><msub id="S3.SS1.p3.3.m3.1.1.3.3.2.3" xref="S3.SS1.p3.3.m3.1.1.3.3.2.3.cmml"><mi id="S3.SS1.p3.3.m3.1.1.3.3.2.3.2" xref="S3.SS1.p3.3.m3.1.1.3.3.2.3.2.cmml">d</mi><mi id="S3.SS1.p3.3.m3.1.1.3.3.2.3.3" xref="S3.SS1.p3.3.m3.1.1.3.3.2.3.3.cmml">h</mi></msub></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.3.m3.1.1.3.3.1" xref="S3.SS1.p3.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.3.m3.1.1.3.3.3" xref="S3.SS1.p3.3.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><in id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1"></in><apply id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.2.1.cmml" xref="S3.SS1.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2.2">𝑊</ci><ci id="S3.SS1.p3.3.m3.1.1.2.3.cmml" xref="S3.SS1.p3.3.m3.1.1.2.3">𝑜</ci></apply><apply id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.3.1.cmml" xref="S3.SS1.p3.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.3.2.cmml" xref="S3.SS1.p3.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p3.3.m3.1.1.3.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3"><times id="S3.SS1.p3.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3.1"></times><apply id="S3.SS1.p3.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3.2"><times id="S3.SS1.p3.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3.2.1"></times><ci id="S3.SS1.p3.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3.2.2">ℎ</ci><apply id="S3.SS1.p3.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.3.3.2.3.1.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3.2.3">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.3.3.2.3.2.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3.2.3.2">𝑑</ci><ci id="S3.SS1.p3.3.m3.1.1.3.3.2.3.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3.2.3.3">ℎ</ci></apply></apply><ci id="S3.SS1.p3.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">W_{o}\in\mathbb{R}^{h*d_{h}\times d}</annotation></semantics></math>. <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="d_{h}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><msub id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml">d</mi><mi id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2">𝑑</ci><ci id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">d_{h}</annotation></semantics></math> is the dimensionality of the output features from each head. To prevent the multi-head attention model from becoming too large, we usually have <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="d_{h}=d/h" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mrow id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml"><msub id="S3.SS1.p3.5.m5.1.1.2" xref="S3.SS1.p3.5.m5.1.1.2.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2.2" xref="S3.SS1.p3.5.m5.1.1.2.2.cmml">d</mi><mi id="S3.SS1.p3.5.m5.1.1.2.3" xref="S3.SS1.p3.5.m5.1.1.2.3.cmml">h</mi></msub><mo id="S3.SS1.p3.5.m5.1.1.1" xref="S3.SS1.p3.5.m5.1.1.1.cmml">=</mo><mrow id="S3.SS1.p3.5.m5.1.1.3" xref="S3.SS1.p3.5.m5.1.1.3.cmml"><mi id="S3.SS1.p3.5.m5.1.1.3.2" xref="S3.SS1.p3.5.m5.1.1.3.2.cmml">d</mi><mo id="S3.SS1.p3.5.m5.1.1.3.1" xref="S3.SS1.p3.5.m5.1.1.3.1.cmml">/</mo><mi id="S3.SS1.p3.5.m5.1.1.3.3" xref="S3.SS1.p3.5.m5.1.1.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1"><eq id="S3.SS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1.1"></eq><apply id="S3.SS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.2.1.cmml" xref="S3.SS1.p3.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.2.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2.2">𝑑</ci><ci id="S3.SS1.p3.5.m5.1.1.2.3.cmml" xref="S3.SS1.p3.5.m5.1.1.2.3">ℎ</ci></apply><apply id="S3.SS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3"><divide id="S3.SS1.p3.5.m5.1.1.3.1.cmml" xref="S3.SS1.p3.5.m5.1.1.3.1"></divide><ci id="S3.SS1.p3.5.m5.1.1.3.2.cmml" xref="S3.SS1.p3.5.m5.1.1.3.2">𝑑</ci><ci id="S3.SS1.p3.5.m5.1.1.3.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">d_{h}=d/h</annotation></semantics></math>.
In practice, we can compute the attention function on a set of <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><mi id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><ci id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">m</annotation></semantics></math> queries <math id="S3.SS1.p3.7.m7.4" class="ltx_Math" alttext="Q=[q_{1};q_{2};...;q_{m}]\in\mathbb{R}^{m\times d}" display="inline"><semantics id="S3.SS1.p3.7.m7.4a"><mrow id="S3.SS1.p3.7.m7.4.4" xref="S3.SS1.p3.7.m7.4.4.cmml"><mi id="S3.SS1.p3.7.m7.4.4.5" xref="S3.SS1.p3.7.m7.4.4.5.cmml">Q</mi><mo id="S3.SS1.p3.7.m7.4.4.6" xref="S3.SS1.p3.7.m7.4.4.6.cmml">=</mo><mrow id="S3.SS1.p3.7.m7.4.4.3.3" xref="S3.SS1.p3.7.m7.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p3.7.m7.4.4.3.3.4" xref="S3.SS1.p3.7.m7.4.4.3.4.cmml">[</mo><msub id="S3.SS1.p3.7.m7.2.2.1.1.1" xref="S3.SS1.p3.7.m7.2.2.1.1.1.cmml"><mi id="S3.SS1.p3.7.m7.2.2.1.1.1.2" xref="S3.SS1.p3.7.m7.2.2.1.1.1.2.cmml">q</mi><mn id="S3.SS1.p3.7.m7.2.2.1.1.1.3" xref="S3.SS1.p3.7.m7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p3.7.m7.4.4.3.3.5" xref="S3.SS1.p3.7.m7.4.4.3.4.cmml">;</mo><msub id="S3.SS1.p3.7.m7.3.3.2.2.2" xref="S3.SS1.p3.7.m7.3.3.2.2.2.cmml"><mi id="S3.SS1.p3.7.m7.3.3.2.2.2.2" xref="S3.SS1.p3.7.m7.3.3.2.2.2.2.cmml">q</mi><mn id="S3.SS1.p3.7.m7.3.3.2.2.2.3" xref="S3.SS1.p3.7.m7.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p3.7.m7.4.4.3.3.6" xref="S3.SS1.p3.7.m7.4.4.3.4.cmml">;</mo><mi mathvariant="normal" id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml">…</mi><mo id="S3.SS1.p3.7.m7.4.4.3.3.7" xref="S3.SS1.p3.7.m7.4.4.3.4.cmml">;</mo><msub id="S3.SS1.p3.7.m7.4.4.3.3.3" xref="S3.SS1.p3.7.m7.4.4.3.3.3.cmml"><mi id="S3.SS1.p3.7.m7.4.4.3.3.3.2" xref="S3.SS1.p3.7.m7.4.4.3.3.3.2.cmml">q</mi><mi id="S3.SS1.p3.7.m7.4.4.3.3.3.3" xref="S3.SS1.p3.7.m7.4.4.3.3.3.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS1.p3.7.m7.4.4.3.3.8" xref="S3.SS1.p3.7.m7.4.4.3.4.cmml">]</mo></mrow><mo id="S3.SS1.p3.7.m7.4.4.7" xref="S3.SS1.p3.7.m7.4.4.7.cmml">∈</mo><msup id="S3.SS1.p3.7.m7.4.4.8" xref="S3.SS1.p3.7.m7.4.4.8.cmml"><mi id="S3.SS1.p3.7.m7.4.4.8.2" xref="S3.SS1.p3.7.m7.4.4.8.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.7.m7.4.4.8.3" xref="S3.SS1.p3.7.m7.4.4.8.3.cmml"><mi id="S3.SS1.p3.7.m7.4.4.8.3.2" xref="S3.SS1.p3.7.m7.4.4.8.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.7.m7.4.4.8.3.1" xref="S3.SS1.p3.7.m7.4.4.8.3.1.cmml">×</mo><mi id="S3.SS1.p3.7.m7.4.4.8.3.3" xref="S3.SS1.p3.7.m7.4.4.8.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.4b"><apply id="S3.SS1.p3.7.m7.4.4.cmml" xref="S3.SS1.p3.7.m7.4.4"><and id="S3.SS1.p3.7.m7.4.4a.cmml" xref="S3.SS1.p3.7.m7.4.4"></and><apply id="S3.SS1.p3.7.m7.4.4b.cmml" xref="S3.SS1.p3.7.m7.4.4"><eq id="S3.SS1.p3.7.m7.4.4.6.cmml" xref="S3.SS1.p3.7.m7.4.4.6"></eq><ci id="S3.SS1.p3.7.m7.4.4.5.cmml" xref="S3.SS1.p3.7.m7.4.4.5">𝑄</ci><list id="S3.SS1.p3.7.m7.4.4.3.4.cmml" xref="S3.SS1.p3.7.m7.4.4.3.3"><apply id="S3.SS1.p3.7.m7.2.2.1.1.1.cmml" xref="S3.SS1.p3.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.2.2.1.1.1.1.cmml" xref="S3.SS1.p3.7.m7.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.7.m7.2.2.1.1.1.2.cmml" xref="S3.SS1.p3.7.m7.2.2.1.1.1.2">𝑞</ci><cn type="integer" id="S3.SS1.p3.7.m7.2.2.1.1.1.3.cmml" xref="S3.SS1.p3.7.m7.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p3.7.m7.3.3.2.2.2.cmml" xref="S3.SS1.p3.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.3.3.2.2.2.1.cmml" xref="S3.SS1.p3.7.m7.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.7.m7.3.3.2.2.2.2.cmml" xref="S3.SS1.p3.7.m7.3.3.2.2.2.2">𝑞</ci><cn type="integer" id="S3.SS1.p3.7.m7.3.3.2.2.2.3.cmml" xref="S3.SS1.p3.7.m7.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">…</ci><apply id="S3.SS1.p3.7.m7.4.4.3.3.3.cmml" xref="S3.SS1.p3.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.4.4.3.3.3.1.cmml" xref="S3.SS1.p3.7.m7.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p3.7.m7.4.4.3.3.3.2.cmml" xref="S3.SS1.p3.7.m7.4.4.3.3.3.2">𝑞</ci><ci id="S3.SS1.p3.7.m7.4.4.3.3.3.3.cmml" xref="S3.SS1.p3.7.m7.4.4.3.3.3.3">𝑚</ci></apply></list></apply><apply id="S3.SS1.p3.7.m7.4.4c.cmml" xref="S3.SS1.p3.7.m7.4.4"><in id="S3.SS1.p3.7.m7.4.4.7.cmml" xref="S3.SS1.p3.7.m7.4.4.7"></in><share href="#S3.SS1.p3.7.m7.4.4.3.cmml" id="S3.SS1.p3.7.m7.4.4d.cmml" xref="S3.SS1.p3.7.m7.4.4"></share><apply id="S3.SS1.p3.7.m7.4.4.8.cmml" xref="S3.SS1.p3.7.m7.4.4.8"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.4.4.8.1.cmml" xref="S3.SS1.p3.7.m7.4.4.8">superscript</csymbol><ci id="S3.SS1.p3.7.m7.4.4.8.2.cmml" xref="S3.SS1.p3.7.m7.4.4.8.2">ℝ</ci><apply id="S3.SS1.p3.7.m7.4.4.8.3.cmml" xref="S3.SS1.p3.7.m7.4.4.8.3"><times id="S3.SS1.p3.7.m7.4.4.8.3.1.cmml" xref="S3.SS1.p3.7.m7.4.4.8.3.1"></times><ci id="S3.SS1.p3.7.m7.4.4.8.3.2.cmml" xref="S3.SS1.p3.7.m7.4.4.8.3.2">𝑚</ci><ci id="S3.SS1.p3.7.m7.4.4.8.3.3.cmml" xref="S3.SS1.p3.7.m7.4.4.8.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.4c">Q=[q_{1};q_{2};...;q_{m}]\in\mathbb{R}^{m\times d}</annotation></semantics></math> seamlessly by replacing <math id="S3.SS1.p3.8.m8.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.p3.8.m8.1a"><mi id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><ci id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">q</annotation></semantics></math> with <math id="S3.SS1.p3.9.m9.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p3.9.m9.1a"><mi id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><ci id="S3.SS1.p3.9.m9.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">Q</annotation></semantics></math> in Eq.(<a href="#S3.E2" title="In 3.1 Self-Attention and Guided-Attention Units ‣ 3 Modular Co-Attention Layer ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), to obtain the attended output features <math id="S3.SS1.p3.10.m10.1" class="ltx_Math" alttext="F\in\mathbb{R}^{m\times d}" display="inline"><semantics id="S3.SS1.p3.10.m10.1a"><mrow id="S3.SS1.p3.10.m10.1.1" xref="S3.SS1.p3.10.m10.1.1.cmml"><mi id="S3.SS1.p3.10.m10.1.1.2" xref="S3.SS1.p3.10.m10.1.1.2.cmml">F</mi><mo id="S3.SS1.p3.10.m10.1.1.1" xref="S3.SS1.p3.10.m10.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.10.m10.1.1.3" xref="S3.SS1.p3.10.m10.1.1.3.cmml"><mi id="S3.SS1.p3.10.m10.1.1.3.2" xref="S3.SS1.p3.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.10.m10.1.1.3.3" xref="S3.SS1.p3.10.m10.1.1.3.3.cmml"><mi id="S3.SS1.p3.10.m10.1.1.3.3.2" xref="S3.SS1.p3.10.m10.1.1.3.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.10.m10.1.1.3.3.1" xref="S3.SS1.p3.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.10.m10.1.1.3.3.3" xref="S3.SS1.p3.10.m10.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m10.1b"><apply id="S3.SS1.p3.10.m10.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1"><in id="S3.SS1.p3.10.m10.1.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1.1"></in><ci id="S3.SS1.p3.10.m10.1.1.2.cmml" xref="S3.SS1.p3.10.m10.1.1.2">𝐹</ci><apply id="S3.SS1.p3.10.m10.1.1.3.cmml" xref="S3.SS1.p3.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.10.m10.1.1.3.1.cmml" xref="S3.SS1.p3.10.m10.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.10.m10.1.1.3.2.cmml" xref="S3.SS1.p3.10.m10.1.1.3.2">ℝ</ci><apply id="S3.SS1.p3.10.m10.1.1.3.3.cmml" xref="S3.SS1.p3.10.m10.1.1.3.3"><times id="S3.SS1.p3.10.m10.1.1.3.3.1.cmml" xref="S3.SS1.p3.10.m10.1.1.3.3.1"></times><ci id="S3.SS1.p3.10.m10.1.1.3.3.2.cmml" xref="S3.SS1.p3.10.m10.1.1.3.3.2">𝑚</ci><ci id="S3.SS1.p3.10.m10.1.1.3.3.3.cmml" xref="S3.SS1.p3.10.m10.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m10.1c">F\in\mathbb{R}^{m\times d}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.16" class="ltx_p">We build two attention units on top of the multi-head attention to handle the multimodal input features for VQA, namely the <em id="S3.SS1.p4.16.1" class="ltx_emph ltx_font_italic">self-attention</em> (SA) unit and the <em id="S3.SS1.p4.16.2" class="ltx_emph ltx_font_italic">guided-attention</em> (GA) unit. The SA unit (see Figure <a href="#S3.F2.sf1" title="In Figure 2 ‣ 3.1 Self-Attention and Guided-Attention Units ‣ 3 Modular Co-Attention Layer ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a>) is composed of a multi-head attention layer and a pointwise feed-forward layer. Taking one group of input features <math id="S3.SS1.p4.1.m1.3" class="ltx_Math" alttext="X=[x_{1};...;x_{m}]\in\mathbb{R}^{m\times d_{x}}" display="inline"><semantics id="S3.SS1.p4.1.m1.3a"><mrow id="S3.SS1.p4.1.m1.3.3" xref="S3.SS1.p4.1.m1.3.3.cmml"><mi id="S3.SS1.p4.1.m1.3.3.4" xref="S3.SS1.p4.1.m1.3.3.4.cmml">X</mi><mo id="S3.SS1.p4.1.m1.3.3.5" xref="S3.SS1.p4.1.m1.3.3.5.cmml">=</mo><mrow id="S3.SS1.p4.1.m1.3.3.2.2" xref="S3.SS1.p4.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p4.1.m1.3.3.2.2.3" xref="S3.SS1.p4.1.m1.3.3.2.3.cmml">[</mo><msub id="S3.SS1.p4.1.m1.2.2.1.1.1" xref="S3.SS1.p4.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.2.2.1.1.1.2" xref="S3.SS1.p4.1.m1.2.2.1.1.1.2.cmml">x</mi><mn id="S3.SS1.p4.1.m1.2.2.1.1.1.3" xref="S3.SS1.p4.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p4.1.m1.3.3.2.2.4" xref="S3.SS1.p4.1.m1.3.3.2.3.cmml">;</mo><mi mathvariant="normal" id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p4.1.m1.3.3.2.2.5" xref="S3.SS1.p4.1.m1.3.3.2.3.cmml">;</mo><msub id="S3.SS1.p4.1.m1.3.3.2.2.2" xref="S3.SS1.p4.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p4.1.m1.3.3.2.2.2.2" xref="S3.SS1.p4.1.m1.3.3.2.2.2.2.cmml">x</mi><mi id="S3.SS1.p4.1.m1.3.3.2.2.2.3" xref="S3.SS1.p4.1.m1.3.3.2.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS1.p4.1.m1.3.3.2.2.6" xref="S3.SS1.p4.1.m1.3.3.2.3.cmml">]</mo></mrow><mo id="S3.SS1.p4.1.m1.3.3.6" xref="S3.SS1.p4.1.m1.3.3.6.cmml">∈</mo><msup id="S3.SS1.p4.1.m1.3.3.7" xref="S3.SS1.p4.1.m1.3.3.7.cmml"><mi id="S3.SS1.p4.1.m1.3.3.7.2" xref="S3.SS1.p4.1.m1.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.1.m1.3.3.7.3" xref="S3.SS1.p4.1.m1.3.3.7.3.cmml"><mi id="S3.SS1.p4.1.m1.3.3.7.3.2" xref="S3.SS1.p4.1.m1.3.3.7.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p4.1.m1.3.3.7.3.1" xref="S3.SS1.p4.1.m1.3.3.7.3.1.cmml">×</mo><msub id="S3.SS1.p4.1.m1.3.3.7.3.3" xref="S3.SS1.p4.1.m1.3.3.7.3.3.cmml"><mi id="S3.SS1.p4.1.m1.3.3.7.3.3.2" xref="S3.SS1.p4.1.m1.3.3.7.3.3.2.cmml">d</mi><mi id="S3.SS1.p4.1.m1.3.3.7.3.3.3" xref="S3.SS1.p4.1.m1.3.3.7.3.3.3.cmml">x</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.3b"><apply id="S3.SS1.p4.1.m1.3.3.cmml" xref="S3.SS1.p4.1.m1.3.3"><and id="S3.SS1.p4.1.m1.3.3a.cmml" xref="S3.SS1.p4.1.m1.3.3"></and><apply id="S3.SS1.p4.1.m1.3.3b.cmml" xref="S3.SS1.p4.1.m1.3.3"><eq id="S3.SS1.p4.1.m1.3.3.5.cmml" xref="S3.SS1.p4.1.m1.3.3.5"></eq><ci id="S3.SS1.p4.1.m1.3.3.4.cmml" xref="S3.SS1.p4.1.m1.3.3.4">𝑋</ci><list id="S3.SS1.p4.1.m1.3.3.2.3.cmml" xref="S3.SS1.p4.1.m1.3.3.2.2"><apply id="S3.SS1.p4.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p4.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.2.2.1.1.1.2">𝑥</ci><cn type="integer" id="S3.SS1.p4.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">…</ci><apply id="S3.SS1.p4.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p4.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p4.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p4.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p4.1.m1.3.3.2.2.2.2">𝑥</ci><ci id="S3.SS1.p4.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.p4.1.m1.3.3.2.2.2.3">𝑚</ci></apply></list></apply><apply id="S3.SS1.p4.1.m1.3.3c.cmml" xref="S3.SS1.p4.1.m1.3.3"><in id="S3.SS1.p4.1.m1.3.3.6.cmml" xref="S3.SS1.p4.1.m1.3.3.6"></in><share href="#S3.SS1.p4.1.m1.3.3.2.cmml" id="S3.SS1.p4.1.m1.3.3d.cmml" xref="S3.SS1.p4.1.m1.3.3"></share><apply id="S3.SS1.p4.1.m1.3.3.7.cmml" xref="S3.SS1.p4.1.m1.3.3.7"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.3.3.7.1.cmml" xref="S3.SS1.p4.1.m1.3.3.7">superscript</csymbol><ci id="S3.SS1.p4.1.m1.3.3.7.2.cmml" xref="S3.SS1.p4.1.m1.3.3.7.2">ℝ</ci><apply id="S3.SS1.p4.1.m1.3.3.7.3.cmml" xref="S3.SS1.p4.1.m1.3.3.7.3"><times id="S3.SS1.p4.1.m1.3.3.7.3.1.cmml" xref="S3.SS1.p4.1.m1.3.3.7.3.1"></times><ci id="S3.SS1.p4.1.m1.3.3.7.3.2.cmml" xref="S3.SS1.p4.1.m1.3.3.7.3.2">𝑚</ci><apply id="S3.SS1.p4.1.m1.3.3.7.3.3.cmml" xref="S3.SS1.p4.1.m1.3.3.7.3.3"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.3.3.7.3.3.1.cmml" xref="S3.SS1.p4.1.m1.3.3.7.3.3">subscript</csymbol><ci id="S3.SS1.p4.1.m1.3.3.7.3.3.2.cmml" xref="S3.SS1.p4.1.m1.3.3.7.3.3.2">𝑑</ci><ci id="S3.SS1.p4.1.m1.3.3.7.3.3.3.cmml" xref="S3.SS1.p4.1.m1.3.3.7.3.3.3">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.3c">X=[x_{1};...;x_{m}]\in\mathbb{R}^{m\times d_{x}}</annotation></semantics></math>, the multi-head attention learns the pairwise relationship between the paired sample <math id="S3.SS1.p4.2.m2.1" class="ltx_math_unparsed" alttext="&lt;x_{i},x_{j}&gt;" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1b"><mo id="S3.SS1.p4.2.m2.1.1">&lt;</mo><msub id="S3.SS1.p4.2.m2.1.2"><mi id="S3.SS1.p4.2.m2.1.2.2">x</mi><mi id="S3.SS1.p4.2.m2.1.2.3">i</mi></msub><mo id="S3.SS1.p4.2.m2.1.3">,</mo><msub id="S3.SS1.p4.2.m2.1.4"><mi id="S3.SS1.p4.2.m2.1.4.2">x</mi><mi id="S3.SS1.p4.2.m2.1.4.3">j</mi></msub><mo id="S3.SS1.p4.2.m2.1.5">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">&lt;x_{i},x_{j}&gt;</annotation></semantics></math> within <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">X</annotation></semantics></math> and outputs the attended output features <math id="S3.SS1.p4.4.m4.1" class="ltx_Math" alttext="Z\in\mathbb{R}^{m\times d}" display="inline"><semantics id="S3.SS1.p4.4.m4.1a"><mrow id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml"><mi id="S3.SS1.p4.4.m4.1.1.2" xref="S3.SS1.p4.4.m4.1.1.2.cmml">Z</mi><mo id="S3.SS1.p4.4.m4.1.1.1" xref="S3.SS1.p4.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.4.m4.1.1.3" xref="S3.SS1.p4.4.m4.1.1.3.cmml"><mi id="S3.SS1.p4.4.m4.1.1.3.2" xref="S3.SS1.p4.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.4.m4.1.1.3.3" xref="S3.SS1.p4.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.p4.4.m4.1.1.3.3.2" xref="S3.SS1.p4.4.m4.1.1.3.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p4.4.m4.1.1.3.3.1" xref="S3.SS1.p4.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p4.4.m4.1.1.3.3.3" xref="S3.SS1.p4.4.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><apply id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1"><in id="S3.SS1.p4.4.m4.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1.1"></in><ci id="S3.SS1.p4.4.m4.1.1.2.cmml" xref="S3.SS1.p4.4.m4.1.1.2">𝑍</ci><apply id="S3.SS1.p4.4.m4.1.1.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.1.1.3.1.cmml" xref="S3.SS1.p4.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.4.m4.1.1.3.2.cmml" xref="S3.SS1.p4.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS1.p4.4.m4.1.1.3.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3.3"><times id="S3.SS1.p4.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p4.4.m4.1.1.3.3.1"></times><ci id="S3.SS1.p4.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p4.4.m4.1.1.3.3.2">𝑚</ci><ci id="S3.SS1.p4.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">Z\in\mathbb{R}^{m\times d}</annotation></semantics></math> by weighted summation of all the instances in <math id="S3.SS1.p4.5.m5.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p4.5.m5.1a"><mi id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><ci id="S3.SS1.p4.5.m5.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">X</annotation></semantics></math>. The feed-forward layer takes the output features of the multi-head attention layer, and further transforms them through two fully-connected layers with ReLU activation and dropout (FC(<math id="S3.SS1.p4.6.m6.1" class="ltx_Math" alttext="4d" display="inline"><semantics id="S3.SS1.p4.6.m6.1a"><mrow id="S3.SS1.p4.6.m6.1.1" xref="S3.SS1.p4.6.m6.1.1.cmml"><mn id="S3.SS1.p4.6.m6.1.1.2" xref="S3.SS1.p4.6.m6.1.1.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S3.SS1.p4.6.m6.1.1.1" xref="S3.SS1.p4.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p4.6.m6.1.1.3" xref="S3.SS1.p4.6.m6.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m6.1b"><apply id="S3.SS1.p4.6.m6.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1"><times id="S3.SS1.p4.6.m6.1.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1.1"></times><cn type="integer" id="S3.SS1.p4.6.m6.1.1.2.cmml" xref="S3.SS1.p4.6.m6.1.1.2">4</cn><ci id="S3.SS1.p4.6.m6.1.1.3.cmml" xref="S3.SS1.p4.6.m6.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m6.1c">4d</annotation></semantics></math>)-ReLU-Dropout(0.1)-FC(<math id="S3.SS1.p4.7.m7.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.p4.7.m7.1a"><mi id="S3.SS1.p4.7.m7.1.1" xref="S3.SS1.p4.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.7.m7.1b"><ci id="S3.SS1.p4.7.m7.1.1.cmml" xref="S3.SS1.p4.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.7.m7.1c">d</annotation></semantics></math>)). Moreover, residual connection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> followed by layer normalization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> is applied to the outputs of the two layers to facilitate optimization.
The GA unit (see Figure <a href="#S3.F2.sf2" title="In Figure 2 ‣ 3.1 Self-Attention and Guided-Attention Units ‣ 3 Modular Co-Attention Layer ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(b)</span></a>) takes two groups of input features <math id="S3.SS1.p4.8.m8.1" class="ltx_Math" alttext="X\in\mathbb{R}^{m\times d_{x}}" display="inline"><semantics id="S3.SS1.p4.8.m8.1a"><mrow id="S3.SS1.p4.8.m8.1.1" xref="S3.SS1.p4.8.m8.1.1.cmml"><mi id="S3.SS1.p4.8.m8.1.1.2" xref="S3.SS1.p4.8.m8.1.1.2.cmml">X</mi><mo id="S3.SS1.p4.8.m8.1.1.1" xref="S3.SS1.p4.8.m8.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.8.m8.1.1.3" xref="S3.SS1.p4.8.m8.1.1.3.cmml"><mi id="S3.SS1.p4.8.m8.1.1.3.2" xref="S3.SS1.p4.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.8.m8.1.1.3.3" xref="S3.SS1.p4.8.m8.1.1.3.3.cmml"><mi id="S3.SS1.p4.8.m8.1.1.3.3.2" xref="S3.SS1.p4.8.m8.1.1.3.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p4.8.m8.1.1.3.3.1" xref="S3.SS1.p4.8.m8.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p4.8.m8.1.1.3.3.3" xref="S3.SS1.p4.8.m8.1.1.3.3.3.cmml"><mi id="S3.SS1.p4.8.m8.1.1.3.3.3.2" xref="S3.SS1.p4.8.m8.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS1.p4.8.m8.1.1.3.3.3.3" xref="S3.SS1.p4.8.m8.1.1.3.3.3.3.cmml">x</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.8.m8.1b"><apply id="S3.SS1.p4.8.m8.1.1.cmml" xref="S3.SS1.p4.8.m8.1.1"><in id="S3.SS1.p4.8.m8.1.1.1.cmml" xref="S3.SS1.p4.8.m8.1.1.1"></in><ci id="S3.SS1.p4.8.m8.1.1.2.cmml" xref="S3.SS1.p4.8.m8.1.1.2">𝑋</ci><apply id="S3.SS1.p4.8.m8.1.1.3.cmml" xref="S3.SS1.p4.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m8.1.1.3.1.cmml" xref="S3.SS1.p4.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.8.m8.1.1.3.2.cmml" xref="S3.SS1.p4.8.m8.1.1.3.2">ℝ</ci><apply id="S3.SS1.p4.8.m8.1.1.3.3.cmml" xref="S3.SS1.p4.8.m8.1.1.3.3"><times id="S3.SS1.p4.8.m8.1.1.3.3.1.cmml" xref="S3.SS1.p4.8.m8.1.1.3.3.1"></times><ci id="S3.SS1.p4.8.m8.1.1.3.3.2.cmml" xref="S3.SS1.p4.8.m8.1.1.3.3.2">𝑚</ci><apply id="S3.SS1.p4.8.m8.1.1.3.3.3.cmml" xref="S3.SS1.p4.8.m8.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m8.1.1.3.3.3.1.cmml" xref="S3.SS1.p4.8.m8.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p4.8.m8.1.1.3.3.3.2.cmml" xref="S3.SS1.p4.8.m8.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS1.p4.8.m8.1.1.3.3.3.3.cmml" xref="S3.SS1.p4.8.m8.1.1.3.3.3.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.8.m8.1c">X\in\mathbb{R}^{m\times d_{x}}</annotation></semantics></math> and <math id="S3.SS1.p4.9.m9.3" class="ltx_Math" alttext="Y=[y_{1};...;y_{n}]\in\mathbb{R}^{n\times d_{y}}" display="inline"><semantics id="S3.SS1.p4.9.m9.3a"><mrow id="S3.SS1.p4.9.m9.3.3" xref="S3.SS1.p4.9.m9.3.3.cmml"><mi id="S3.SS1.p4.9.m9.3.3.4" xref="S3.SS1.p4.9.m9.3.3.4.cmml">Y</mi><mo id="S3.SS1.p4.9.m9.3.3.5" xref="S3.SS1.p4.9.m9.3.3.5.cmml">=</mo><mrow id="S3.SS1.p4.9.m9.3.3.2.2" xref="S3.SS1.p4.9.m9.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p4.9.m9.3.3.2.2.3" xref="S3.SS1.p4.9.m9.3.3.2.3.cmml">[</mo><msub id="S3.SS1.p4.9.m9.2.2.1.1.1" xref="S3.SS1.p4.9.m9.2.2.1.1.1.cmml"><mi id="S3.SS1.p4.9.m9.2.2.1.1.1.2" xref="S3.SS1.p4.9.m9.2.2.1.1.1.2.cmml">y</mi><mn id="S3.SS1.p4.9.m9.2.2.1.1.1.3" xref="S3.SS1.p4.9.m9.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p4.9.m9.3.3.2.2.4" xref="S3.SS1.p4.9.m9.3.3.2.3.cmml">;</mo><mi mathvariant="normal" id="S3.SS1.p4.9.m9.1.1" xref="S3.SS1.p4.9.m9.1.1.cmml">…</mi><mo id="S3.SS1.p4.9.m9.3.3.2.2.5" xref="S3.SS1.p4.9.m9.3.3.2.3.cmml">;</mo><msub id="S3.SS1.p4.9.m9.3.3.2.2.2" xref="S3.SS1.p4.9.m9.3.3.2.2.2.cmml"><mi id="S3.SS1.p4.9.m9.3.3.2.2.2.2" xref="S3.SS1.p4.9.m9.3.3.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p4.9.m9.3.3.2.2.2.3" xref="S3.SS1.p4.9.m9.3.3.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS1.p4.9.m9.3.3.2.2.6" xref="S3.SS1.p4.9.m9.3.3.2.3.cmml">]</mo></mrow><mo id="S3.SS1.p4.9.m9.3.3.6" xref="S3.SS1.p4.9.m9.3.3.6.cmml">∈</mo><msup id="S3.SS1.p4.9.m9.3.3.7" xref="S3.SS1.p4.9.m9.3.3.7.cmml"><mi id="S3.SS1.p4.9.m9.3.3.7.2" xref="S3.SS1.p4.9.m9.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.9.m9.3.3.7.3" xref="S3.SS1.p4.9.m9.3.3.7.3.cmml"><mi id="S3.SS1.p4.9.m9.3.3.7.3.2" xref="S3.SS1.p4.9.m9.3.3.7.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p4.9.m9.3.3.7.3.1" xref="S3.SS1.p4.9.m9.3.3.7.3.1.cmml">×</mo><msub id="S3.SS1.p4.9.m9.3.3.7.3.3" xref="S3.SS1.p4.9.m9.3.3.7.3.3.cmml"><mi id="S3.SS1.p4.9.m9.3.3.7.3.3.2" xref="S3.SS1.p4.9.m9.3.3.7.3.3.2.cmml">d</mi><mi id="S3.SS1.p4.9.m9.3.3.7.3.3.3" xref="S3.SS1.p4.9.m9.3.3.7.3.3.3.cmml">y</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.9.m9.3b"><apply id="S3.SS1.p4.9.m9.3.3.cmml" xref="S3.SS1.p4.9.m9.3.3"><and id="S3.SS1.p4.9.m9.3.3a.cmml" xref="S3.SS1.p4.9.m9.3.3"></and><apply id="S3.SS1.p4.9.m9.3.3b.cmml" xref="S3.SS1.p4.9.m9.3.3"><eq id="S3.SS1.p4.9.m9.3.3.5.cmml" xref="S3.SS1.p4.9.m9.3.3.5"></eq><ci id="S3.SS1.p4.9.m9.3.3.4.cmml" xref="S3.SS1.p4.9.m9.3.3.4">𝑌</ci><list id="S3.SS1.p4.9.m9.3.3.2.3.cmml" xref="S3.SS1.p4.9.m9.3.3.2.2"><apply id="S3.SS1.p4.9.m9.2.2.1.1.1.cmml" xref="S3.SS1.p4.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.9.m9.2.2.1.1.1.1.cmml" xref="S3.SS1.p4.9.m9.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p4.9.m9.2.2.1.1.1.2.cmml" xref="S3.SS1.p4.9.m9.2.2.1.1.1.2">𝑦</ci><cn type="integer" id="S3.SS1.p4.9.m9.2.2.1.1.1.3.cmml" xref="S3.SS1.p4.9.m9.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p4.9.m9.1.1.cmml" xref="S3.SS1.p4.9.m9.1.1">…</ci><apply id="S3.SS1.p4.9.m9.3.3.2.2.2.cmml" xref="S3.SS1.p4.9.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.9.m9.3.3.2.2.2.1.cmml" xref="S3.SS1.p4.9.m9.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p4.9.m9.3.3.2.2.2.2.cmml" xref="S3.SS1.p4.9.m9.3.3.2.2.2.2">𝑦</ci><ci id="S3.SS1.p4.9.m9.3.3.2.2.2.3.cmml" xref="S3.SS1.p4.9.m9.3.3.2.2.2.3">𝑛</ci></apply></list></apply><apply id="S3.SS1.p4.9.m9.3.3c.cmml" xref="S3.SS1.p4.9.m9.3.3"><in id="S3.SS1.p4.9.m9.3.3.6.cmml" xref="S3.SS1.p4.9.m9.3.3.6"></in><share href="#S3.SS1.p4.9.m9.3.3.2.cmml" id="S3.SS1.p4.9.m9.3.3d.cmml" xref="S3.SS1.p4.9.m9.3.3"></share><apply id="S3.SS1.p4.9.m9.3.3.7.cmml" xref="S3.SS1.p4.9.m9.3.3.7"><csymbol cd="ambiguous" id="S3.SS1.p4.9.m9.3.3.7.1.cmml" xref="S3.SS1.p4.9.m9.3.3.7">superscript</csymbol><ci id="S3.SS1.p4.9.m9.3.3.7.2.cmml" xref="S3.SS1.p4.9.m9.3.3.7.2">ℝ</ci><apply id="S3.SS1.p4.9.m9.3.3.7.3.cmml" xref="S3.SS1.p4.9.m9.3.3.7.3"><times id="S3.SS1.p4.9.m9.3.3.7.3.1.cmml" xref="S3.SS1.p4.9.m9.3.3.7.3.1"></times><ci id="S3.SS1.p4.9.m9.3.3.7.3.2.cmml" xref="S3.SS1.p4.9.m9.3.3.7.3.2">𝑛</ci><apply id="S3.SS1.p4.9.m9.3.3.7.3.3.cmml" xref="S3.SS1.p4.9.m9.3.3.7.3.3"><csymbol cd="ambiguous" id="S3.SS1.p4.9.m9.3.3.7.3.3.1.cmml" xref="S3.SS1.p4.9.m9.3.3.7.3.3">subscript</csymbol><ci id="S3.SS1.p4.9.m9.3.3.7.3.3.2.cmml" xref="S3.SS1.p4.9.m9.3.3.7.3.3.2">𝑑</ci><ci id="S3.SS1.p4.9.m9.3.3.7.3.3.3.cmml" xref="S3.SS1.p4.9.m9.3.3.7.3.3.3">𝑦</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.9.m9.3c">Y=[y_{1};...;y_{n}]\in\mathbb{R}^{n\times d_{y}}</annotation></semantics></math>, where <math id="S3.SS1.p4.10.m10.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S3.SS1.p4.10.m10.1a"><mi id="S3.SS1.p4.10.m10.1.1" xref="S3.SS1.p4.10.m10.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.10.m10.1b"><ci id="S3.SS1.p4.10.m10.1.1.cmml" xref="S3.SS1.p4.10.m10.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.10.m10.1c">Y</annotation></semantics></math> guides the attention learning for <math id="S3.SS1.p4.11.m11.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p4.11.m11.1a"><mi id="S3.SS1.p4.11.m11.1.1" xref="S3.SS1.p4.11.m11.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.11.m11.1b"><ci id="S3.SS1.p4.11.m11.1.1.cmml" xref="S3.SS1.p4.11.m11.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.11.m11.1c">X</annotation></semantics></math>. Note that the shapes of <math id="S3.SS1.p4.12.m12.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p4.12.m12.1a"><mi id="S3.SS1.p4.12.m12.1.1" xref="S3.SS1.p4.12.m12.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.12.m12.1b"><ci id="S3.SS1.p4.12.m12.1.1.cmml" xref="S3.SS1.p4.12.m12.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.12.m12.1c">X</annotation></semantics></math> and <math id="S3.SS1.p4.13.m13.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S3.SS1.p4.13.m13.1a"><mi id="S3.SS1.p4.13.m13.1.1" xref="S3.SS1.p4.13.m13.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.13.m13.1b"><ci id="S3.SS1.p4.13.m13.1.1.cmml" xref="S3.SS1.p4.13.m13.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.13.m13.1c">Y</annotation></semantics></math> are flexible, so they can be used to represent the features for different modalities (<em id="S3.SS1.p4.16.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S3.SS1.p4.16.4" class="ltx_text"></span>, questions and images). The GA unit models the pairwise relationship between the each paired sample <math id="S3.SS1.p4.14.m14.1" class="ltx_math_unparsed" alttext="&lt;x_{i},y_{j}&gt;" display="inline"><semantics id="S3.SS1.p4.14.m14.1a"><mrow id="S3.SS1.p4.14.m14.1b"><mo id="S3.SS1.p4.14.m14.1.1">&lt;</mo><msub id="S3.SS1.p4.14.m14.1.2"><mi id="S3.SS1.p4.14.m14.1.2.2">x</mi><mi id="S3.SS1.p4.14.m14.1.2.3">i</mi></msub><mo id="S3.SS1.p4.14.m14.1.3">,</mo><msub id="S3.SS1.p4.14.m14.1.4"><mi id="S3.SS1.p4.14.m14.1.4.2">y</mi><mi id="S3.SS1.p4.14.m14.1.4.3">j</mi></msub><mo id="S3.SS1.p4.14.m14.1.5">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S3.SS1.p4.14.m14.1c">&lt;x_{i},y_{j}&gt;</annotation></semantics></math> from <math id="S3.SS1.p4.15.m15.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p4.15.m15.1a"><mi id="S3.SS1.p4.15.m15.1.1" xref="S3.SS1.p4.15.m15.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.15.m15.1b"><ci id="S3.SS1.p4.15.m15.1.1.cmml" xref="S3.SS1.p4.15.m15.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.15.m15.1c">X</annotation></semantics></math> and <math id="S3.SS1.p4.16.m16.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S3.SS1.p4.16.m16.1a"><mi id="S3.SS1.p4.16.m16.1.1" xref="S3.SS1.p4.16.m16.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.16.m16.1b"><ci id="S3.SS1.p4.16.m16.1.1.cmml" xref="S3.SS1.p4.16.m16.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.16.m16.1c">Y</annotation></semantics></math>, respectively.</p>
</div>
<figure id="S3.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1906.10770/assets/x3.png" id="S3.F3.sf1.g1" class="ltx_graphics ltx_img_square" width="461" height="520" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S3.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">ID(Y)-GA(X,Y)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1906.10770/assets/x4.png" id="S3.F3.sf2.g1" class="ltx_graphics ltx_img_square" width="461" height="537" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S3.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">SA(Y)-GA(X,Y)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F3.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1906.10770/assets/x5.png" id="S3.F3.sf3.g1" class="ltx_graphics ltx_img_square" width="462" height="534" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S3.F3.sf3.3.2" class="ltx_text" style="font-size:90%;">SA(Y)-SGA(X,Y)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.3.2" class="ltx_text" style="font-size:90%;">Flowcharts of three MCA variants for VQA. (Y) and (X) denote the question and image features respectively.</span></figcaption>
</figure>
<figure id="S3.F4" class="ltx_figure"><img src="/html/1906.10770/assets/x6.png" id="S3.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="502" height="167" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.5.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S3.F4.6.2" class="ltx_text" style="font-size:90%;">Overall flowchart of the deep Modular Co-Attention Networks (MCAN). In the Deep Co-attention Learning stage, we have two alternative strategies for deep co-attention learning, namely <em id="S3.F4.6.2.1" class="ltx_emph ltx_font_italic">stacking</em> and <em id="S3.F4.6.2.2" class="ltx_emph ltx_font_italic">encoder-decoder</em>.</span></figcaption>
</figure>
<div id="S3.SS1.p5" class="ltx_para ltx_noindent">
<p id="S3.SS1.p5.13" class="ltx_p"><span id="S3.SS1.p5.13.1" class="ltx_text ltx_font_bold">Interpretation:</span> Since the multi-head attention in Eq.(<a href="#S3.E2" title="In 3.1 Self-Attention and Guided-Attention Units ‣ 3 Modular Co-Attention Layer ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) plays a key role in the two attention units, we take a closer look at it to see how it works with respect to different types of inputs. For a SA unit with input features <math id="S3.SS1.p5.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p5.1.m1.1a"><mi id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">X</annotation></semantics></math>, for each <math id="S3.SS1.p5.2.m2.1" class="ltx_Math" alttext="x_{i}\in X" display="inline"><semantics id="S3.SS1.p5.2.m2.1a"><mrow id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml"><msub id="S3.SS1.p5.2.m2.1.1.2" xref="S3.SS1.p5.2.m2.1.1.2.cmml"><mi id="S3.SS1.p5.2.m2.1.1.2.2" xref="S3.SS1.p5.2.m2.1.1.2.2.cmml">x</mi><mi id="S3.SS1.p5.2.m2.1.1.2.3" xref="S3.SS1.p5.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p5.2.m2.1.1.1" xref="S3.SS1.p5.2.m2.1.1.1.cmml">∈</mo><mi id="S3.SS1.p5.2.m2.1.1.3" xref="S3.SS1.p5.2.m2.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><apply id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1"><in id="S3.SS1.p5.2.m2.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1.1"></in><apply id="S3.SS1.p5.2.m2.1.1.2.cmml" xref="S3.SS1.p5.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.1.1.2.1.cmml" xref="S3.SS1.p5.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p5.2.m2.1.1.2.2.cmml" xref="S3.SS1.p5.2.m2.1.1.2.2">𝑥</ci><ci id="S3.SS1.p5.2.m2.1.1.2.3.cmml" xref="S3.SS1.p5.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p5.2.m2.1.1.3.cmml" xref="S3.SS1.p5.2.m2.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">x_{i}\in X</annotation></semantics></math>, its attended feature <math id="S3.SS1.p5.3.m3.3" class="ltx_Math" alttext="f_{i}=\mathrm{MA}(x_{i},X,X)" display="inline"><semantics id="S3.SS1.p5.3.m3.3a"><mrow id="S3.SS1.p5.3.m3.3.3" xref="S3.SS1.p5.3.m3.3.3.cmml"><msub id="S3.SS1.p5.3.m3.3.3.3" xref="S3.SS1.p5.3.m3.3.3.3.cmml"><mi id="S3.SS1.p5.3.m3.3.3.3.2" xref="S3.SS1.p5.3.m3.3.3.3.2.cmml">f</mi><mi id="S3.SS1.p5.3.m3.3.3.3.3" xref="S3.SS1.p5.3.m3.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS1.p5.3.m3.3.3.2" xref="S3.SS1.p5.3.m3.3.3.2.cmml">=</mo><mrow id="S3.SS1.p5.3.m3.3.3.1" xref="S3.SS1.p5.3.m3.3.3.1.cmml"><mi id="S3.SS1.p5.3.m3.3.3.1.3" xref="S3.SS1.p5.3.m3.3.3.1.3.cmml">MA</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.3.m3.3.3.1.2" xref="S3.SS1.p5.3.m3.3.3.1.2.cmml">​</mo><mrow id="S3.SS1.p5.3.m3.3.3.1.1.1" xref="S3.SS1.p5.3.m3.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p5.3.m3.3.3.1.1.1.2" xref="S3.SS1.p5.3.m3.3.3.1.1.2.cmml">(</mo><msub id="S3.SS1.p5.3.m3.3.3.1.1.1.1" xref="S3.SS1.p5.3.m3.3.3.1.1.1.1.cmml"><mi id="S3.SS1.p5.3.m3.3.3.1.1.1.1.2" xref="S3.SS1.p5.3.m3.3.3.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p5.3.m3.3.3.1.1.1.1.3" xref="S3.SS1.p5.3.m3.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p5.3.m3.3.3.1.1.1.3" xref="S3.SS1.p5.3.m3.3.3.1.1.2.cmml">,</mo><mi id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml">X</mi><mo id="S3.SS1.p5.3.m3.3.3.1.1.1.4" xref="S3.SS1.p5.3.m3.3.3.1.1.2.cmml">,</mo><mi id="S3.SS1.p5.3.m3.2.2" xref="S3.SS1.p5.3.m3.2.2.cmml">X</mi><mo stretchy="false" id="S3.SS1.p5.3.m3.3.3.1.1.1.5" xref="S3.SS1.p5.3.m3.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.3b"><apply id="S3.SS1.p5.3.m3.3.3.cmml" xref="S3.SS1.p5.3.m3.3.3"><eq id="S3.SS1.p5.3.m3.3.3.2.cmml" xref="S3.SS1.p5.3.m3.3.3.2"></eq><apply id="S3.SS1.p5.3.m3.3.3.3.cmml" xref="S3.SS1.p5.3.m3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.3.3.3.1.cmml" xref="S3.SS1.p5.3.m3.3.3.3">subscript</csymbol><ci id="S3.SS1.p5.3.m3.3.3.3.2.cmml" xref="S3.SS1.p5.3.m3.3.3.3.2">𝑓</ci><ci id="S3.SS1.p5.3.m3.3.3.3.3.cmml" xref="S3.SS1.p5.3.m3.3.3.3.3">𝑖</ci></apply><apply id="S3.SS1.p5.3.m3.3.3.1.cmml" xref="S3.SS1.p5.3.m3.3.3.1"><times id="S3.SS1.p5.3.m3.3.3.1.2.cmml" xref="S3.SS1.p5.3.m3.3.3.1.2"></times><ci id="S3.SS1.p5.3.m3.3.3.1.3.cmml" xref="S3.SS1.p5.3.m3.3.3.1.3">MA</ci><vector id="S3.SS1.p5.3.m3.3.3.1.1.2.cmml" xref="S3.SS1.p5.3.m3.3.3.1.1.1"><apply id="S3.SS1.p5.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS1.p5.3.m3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p5.3.m3.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p5.3.m3.3.3.1.1.1.1.2.cmml" xref="S3.SS1.p5.3.m3.3.3.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p5.3.m3.3.3.1.1.1.1.3.cmml" xref="S3.SS1.p5.3.m3.3.3.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">𝑋</ci><ci id="S3.SS1.p5.3.m3.2.2.cmml" xref="S3.SS1.p5.3.m3.2.2">𝑋</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.3c">f_{i}=\mathrm{MA}(x_{i},X,X)</annotation></semantics></math> can be understood as <em id="S3.SS1.p5.13.2" class="ltx_emph ltx_font_italic">reconstructing</em> <math id="S3.SS1.p5.4.m4.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S3.SS1.p5.4.m4.1a"><msub id="S3.SS1.p5.4.m4.1.1" xref="S3.SS1.p5.4.m4.1.1.cmml"><mi id="S3.SS1.p5.4.m4.1.1.2" xref="S3.SS1.p5.4.m4.1.1.2.cmml">x</mi><mi id="S3.SS1.p5.4.m4.1.1.3" xref="S3.SS1.p5.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m4.1b"><apply id="S3.SS1.p5.4.m4.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.4.m4.1.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p5.4.m4.1.1.2.cmml" xref="S3.SS1.p5.4.m4.1.1.2">𝑥</ci><ci id="S3.SS1.p5.4.m4.1.1.3.cmml" xref="S3.SS1.p5.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m4.1c">x_{i}</annotation></semantics></math> by all the samples in <math id="S3.SS1.p5.5.m5.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p5.5.m5.1a"><mi id="S3.SS1.p5.5.m5.1.1" xref="S3.SS1.p5.5.m5.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.5.m5.1b"><ci id="S3.SS1.p5.5.m5.1.1.cmml" xref="S3.SS1.p5.5.m5.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.5.m5.1c">X</annotation></semantics></math> with respect to their normalized similarities to <math id="S3.SS1.p5.6.m6.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S3.SS1.p5.6.m6.1a"><msub id="S3.SS1.p5.6.m6.1.1" xref="S3.SS1.p5.6.m6.1.1.cmml"><mi id="S3.SS1.p5.6.m6.1.1.2" xref="S3.SS1.p5.6.m6.1.1.2.cmml">x</mi><mi id="S3.SS1.p5.6.m6.1.1.3" xref="S3.SS1.p5.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.6.m6.1b"><apply id="S3.SS1.p5.6.m6.1.1.cmml" xref="S3.SS1.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.6.m6.1.1.1.cmml" xref="S3.SS1.p5.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p5.6.m6.1.1.2.cmml" xref="S3.SS1.p5.6.m6.1.1.2">𝑥</ci><ci id="S3.SS1.p5.6.m6.1.1.3.cmml" xref="S3.SS1.p5.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.6.m6.1c">x_{i}</annotation></semantics></math>.
Analogously, for a GA unit with input features <math id="S3.SS1.p5.7.m7.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p5.7.m7.1a"><mi id="S3.SS1.p5.7.m7.1.1" xref="S3.SS1.p5.7.m7.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.7.m7.1b"><ci id="S3.SS1.p5.7.m7.1.1.cmml" xref="S3.SS1.p5.7.m7.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.7.m7.1c">X</annotation></semantics></math> and <math id="S3.SS1.p5.8.m8.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S3.SS1.p5.8.m8.1a"><mi id="S3.SS1.p5.8.m8.1.1" xref="S3.SS1.p5.8.m8.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.8.m8.1b"><ci id="S3.SS1.p5.8.m8.1.1.cmml" xref="S3.SS1.p5.8.m8.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.8.m8.1c">Y</annotation></semantics></math>, the attended feature <math id="S3.SS1.p5.9.m9.3" class="ltx_Math" alttext="f_{i}=\mathrm{MA}(x_{i},Y,Y)" display="inline"><semantics id="S3.SS1.p5.9.m9.3a"><mrow id="S3.SS1.p5.9.m9.3.3" xref="S3.SS1.p5.9.m9.3.3.cmml"><msub id="S3.SS1.p5.9.m9.3.3.3" xref="S3.SS1.p5.9.m9.3.3.3.cmml"><mi id="S3.SS1.p5.9.m9.3.3.3.2" xref="S3.SS1.p5.9.m9.3.3.3.2.cmml">f</mi><mi id="S3.SS1.p5.9.m9.3.3.3.3" xref="S3.SS1.p5.9.m9.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS1.p5.9.m9.3.3.2" xref="S3.SS1.p5.9.m9.3.3.2.cmml">=</mo><mrow id="S3.SS1.p5.9.m9.3.3.1" xref="S3.SS1.p5.9.m9.3.3.1.cmml"><mi id="S3.SS1.p5.9.m9.3.3.1.3" xref="S3.SS1.p5.9.m9.3.3.1.3.cmml">MA</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.9.m9.3.3.1.2" xref="S3.SS1.p5.9.m9.3.3.1.2.cmml">​</mo><mrow id="S3.SS1.p5.9.m9.3.3.1.1.1" xref="S3.SS1.p5.9.m9.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p5.9.m9.3.3.1.1.1.2" xref="S3.SS1.p5.9.m9.3.3.1.1.2.cmml">(</mo><msub id="S3.SS1.p5.9.m9.3.3.1.1.1.1" xref="S3.SS1.p5.9.m9.3.3.1.1.1.1.cmml"><mi id="S3.SS1.p5.9.m9.3.3.1.1.1.1.2" xref="S3.SS1.p5.9.m9.3.3.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p5.9.m9.3.3.1.1.1.1.3" xref="S3.SS1.p5.9.m9.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p5.9.m9.3.3.1.1.1.3" xref="S3.SS1.p5.9.m9.3.3.1.1.2.cmml">,</mo><mi id="S3.SS1.p5.9.m9.1.1" xref="S3.SS1.p5.9.m9.1.1.cmml">Y</mi><mo id="S3.SS1.p5.9.m9.3.3.1.1.1.4" xref="S3.SS1.p5.9.m9.3.3.1.1.2.cmml">,</mo><mi id="S3.SS1.p5.9.m9.2.2" xref="S3.SS1.p5.9.m9.2.2.cmml">Y</mi><mo stretchy="false" id="S3.SS1.p5.9.m9.3.3.1.1.1.5" xref="S3.SS1.p5.9.m9.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.9.m9.3b"><apply id="S3.SS1.p5.9.m9.3.3.cmml" xref="S3.SS1.p5.9.m9.3.3"><eq id="S3.SS1.p5.9.m9.3.3.2.cmml" xref="S3.SS1.p5.9.m9.3.3.2"></eq><apply id="S3.SS1.p5.9.m9.3.3.3.cmml" xref="S3.SS1.p5.9.m9.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p5.9.m9.3.3.3.1.cmml" xref="S3.SS1.p5.9.m9.3.3.3">subscript</csymbol><ci id="S3.SS1.p5.9.m9.3.3.3.2.cmml" xref="S3.SS1.p5.9.m9.3.3.3.2">𝑓</ci><ci id="S3.SS1.p5.9.m9.3.3.3.3.cmml" xref="S3.SS1.p5.9.m9.3.3.3.3">𝑖</ci></apply><apply id="S3.SS1.p5.9.m9.3.3.1.cmml" xref="S3.SS1.p5.9.m9.3.3.1"><times id="S3.SS1.p5.9.m9.3.3.1.2.cmml" xref="S3.SS1.p5.9.m9.3.3.1.2"></times><ci id="S3.SS1.p5.9.m9.3.3.1.3.cmml" xref="S3.SS1.p5.9.m9.3.3.1.3">MA</ci><vector id="S3.SS1.p5.9.m9.3.3.1.1.2.cmml" xref="S3.SS1.p5.9.m9.3.3.1.1.1"><apply id="S3.SS1.p5.9.m9.3.3.1.1.1.1.cmml" xref="S3.SS1.p5.9.m9.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.9.m9.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p5.9.m9.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p5.9.m9.3.3.1.1.1.1.2.cmml" xref="S3.SS1.p5.9.m9.3.3.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p5.9.m9.3.3.1.1.1.1.3.cmml" xref="S3.SS1.p5.9.m9.3.3.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS1.p5.9.m9.1.1.cmml" xref="S3.SS1.p5.9.m9.1.1">𝑌</ci><ci id="S3.SS1.p5.9.m9.2.2.cmml" xref="S3.SS1.p5.9.m9.2.2">𝑌</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.9.m9.3c">f_{i}=\mathrm{MA}(x_{i},Y,Y)</annotation></semantics></math> for <math id="S3.SS1.p5.10.m10.1" class="ltx_Math" alttext="x_{i}\in X" display="inline"><semantics id="S3.SS1.p5.10.m10.1a"><mrow id="S3.SS1.p5.10.m10.1.1" xref="S3.SS1.p5.10.m10.1.1.cmml"><msub id="S3.SS1.p5.10.m10.1.1.2" xref="S3.SS1.p5.10.m10.1.1.2.cmml"><mi id="S3.SS1.p5.10.m10.1.1.2.2" xref="S3.SS1.p5.10.m10.1.1.2.2.cmml">x</mi><mi id="S3.SS1.p5.10.m10.1.1.2.3" xref="S3.SS1.p5.10.m10.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p5.10.m10.1.1.1" xref="S3.SS1.p5.10.m10.1.1.1.cmml">∈</mo><mi id="S3.SS1.p5.10.m10.1.1.3" xref="S3.SS1.p5.10.m10.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.10.m10.1b"><apply id="S3.SS1.p5.10.m10.1.1.cmml" xref="S3.SS1.p5.10.m10.1.1"><in id="S3.SS1.p5.10.m10.1.1.1.cmml" xref="S3.SS1.p5.10.m10.1.1.1"></in><apply id="S3.SS1.p5.10.m10.1.1.2.cmml" xref="S3.SS1.p5.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p5.10.m10.1.1.2.1.cmml" xref="S3.SS1.p5.10.m10.1.1.2">subscript</csymbol><ci id="S3.SS1.p5.10.m10.1.1.2.2.cmml" xref="S3.SS1.p5.10.m10.1.1.2.2">𝑥</ci><ci id="S3.SS1.p5.10.m10.1.1.2.3.cmml" xref="S3.SS1.p5.10.m10.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p5.10.m10.1.1.3.cmml" xref="S3.SS1.p5.10.m10.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.10.m10.1c">x_{i}\in X</annotation></semantics></math> is obtained by reconstructing <math id="S3.SS1.p5.11.m11.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S3.SS1.p5.11.m11.1a"><msub id="S3.SS1.p5.11.m11.1.1" xref="S3.SS1.p5.11.m11.1.1.cmml"><mi id="S3.SS1.p5.11.m11.1.1.2" xref="S3.SS1.p5.11.m11.1.1.2.cmml">x</mi><mi id="S3.SS1.p5.11.m11.1.1.3" xref="S3.SS1.p5.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.11.m11.1b"><apply id="S3.SS1.p5.11.m11.1.1.cmml" xref="S3.SS1.p5.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.11.m11.1.1.1.cmml" xref="S3.SS1.p5.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p5.11.m11.1.1.2.cmml" xref="S3.SS1.p5.11.m11.1.1.2">𝑥</ci><ci id="S3.SS1.p5.11.m11.1.1.3.cmml" xref="S3.SS1.p5.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.11.m11.1c">x_{i}</annotation></semantics></math> by all the samples in <math id="S3.SS1.p5.12.m12.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S3.SS1.p5.12.m12.1a"><mi id="S3.SS1.p5.12.m12.1.1" xref="S3.SS1.p5.12.m12.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.12.m12.1b"><ci id="S3.SS1.p5.12.m12.1.1.cmml" xref="S3.SS1.p5.12.m12.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.12.m12.1c">Y</annotation></semantics></math> with respect to their normalized cross-modal similarity to <math id="S3.SS1.p5.13.m13.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S3.SS1.p5.13.m13.1a"><msub id="S3.SS1.p5.13.m13.1.1" xref="S3.SS1.p5.13.m13.1.1.cmml"><mi id="S3.SS1.p5.13.m13.1.1.2" xref="S3.SS1.p5.13.m13.1.1.2.cmml">x</mi><mi id="S3.SS1.p5.13.m13.1.1.3" xref="S3.SS1.p5.13.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.13.m13.1b"><apply id="S3.SS1.p5.13.m13.1.1.cmml" xref="S3.SS1.p5.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.13.m13.1.1.1.cmml" xref="S3.SS1.p5.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p5.13.m13.1.1.2.cmml" xref="S3.SS1.p5.13.m13.1.1.2">𝑥</ci><ci id="S3.SS1.p5.13.m13.1.1.3.cmml" xref="S3.SS1.p5.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.13.m13.1c">x_{i}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Modular Composition for VQA</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Based on the two basic attention units in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.1 Self-Attention and Guided-Attention Units ‣ 3 Modular Co-Attention Layer ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we composite them to obtain three modular co-attention (MCA) layers (see Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Self-Attention and Guided-Attention Units ‣ 3 Modular Co-Attention Layer ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) to handle the multimodal features for VQA. All three MCA layers can be cascaded in depth, such that the outputs of the previous MCA layer can be directly fed to the next MCA layer. This implies that the number of input features is equal to the number of output features without instance reduction.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.4" class="ltx_p">The ID(Y)-GA(X,Y) layer in Figure <a href="#S3.F3.sf1" title="In Figure 3 ‣ 3.1 Self-Attention and Guided-Attention Units ‣ 3 Modular Co-Attention Layer ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(a)</span></a> is our baseline. In ID(Y)-GA(X,Y), the input question features are directly passed through to the output features with an identity mapping, and the dense inter-modal interaction between each region <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="x_{i}\in X" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><msub id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2.2" xref="S3.SS2.p2.1.m1.1.1.2.2.cmml">x</mi><mi id="S3.SS2.p2.1.m1.1.1.2.3" xref="S3.SS2.p2.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml">∈</mo><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><in id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1"></in><apply id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2.2">𝑥</ci><ci id="S3.SS2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">x_{i}\in X</annotation></semantics></math> with each word <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="y_{i}\in Y" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><msub id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.2.2.cmml">y</mi><mi id="S3.SS2.p2.2.m2.1.1.2.3" xref="S3.SS2.p2.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p2.2.m2.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.cmml">∈</mo><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><in id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1"></in><apply id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2.2">𝑦</ci><ci id="S3.SS2.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.p2.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">y_{i}\in Y</annotation></semantics></math> is modeled in a GA(X,Y) unit. These interactions are further exploited to obtain the attended image features. Compared to the ID(Y)-GA(X,Y) layer, the SA(Y)-GA(X,Y) layer in Figure <a href="#S3.F3.sf2" title="In Figure 3 ‣ 3.1 Self-Attention and Guided-Attention Units ‣ 3 Modular Co-Attention Layer ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(b)</span></a> adds a SA(Y) unit to model the dense intra-modal interaction between each question word pair <math id="S3.SS2.p2.3.m3.2" class="ltx_Math" alttext="\{y_{i},y_{j}\}\in Y" display="inline"><semantics id="S3.SS2.p2.3.m3.2a"><mrow id="S3.SS2.p2.3.m3.2.2" xref="S3.SS2.p2.3.m3.2.2.cmml"><mrow id="S3.SS2.p2.3.m3.2.2.2.2" xref="S3.SS2.p2.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.3.m3.2.2.2.2.3" xref="S3.SS2.p2.3.m3.2.2.2.3.cmml">{</mo><msub id="S3.SS2.p2.3.m3.1.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.2" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.cmml">y</mi><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p2.3.m3.2.2.2.2.4" xref="S3.SS2.p2.3.m3.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.3.m3.2.2.2.2.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.3.m3.2.2.2.2.2.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS2.p2.3.m3.2.2.2.2.2.3" xref="S3.SS2.p2.3.m3.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.p2.3.m3.2.2.2.2.5" xref="S3.SS2.p2.3.m3.2.2.2.3.cmml">}</mo></mrow><mo id="S3.SS2.p2.3.m3.2.2.3" xref="S3.SS2.p2.3.m3.2.2.3.cmml">∈</mo><mi id="S3.SS2.p2.3.m3.2.2.4" xref="S3.SS2.p2.3.m3.2.2.4.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.2b"><apply id="S3.SS2.p2.3.m3.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2"><in id="S3.SS2.p2.3.m3.2.2.3.cmml" xref="S3.SS2.p2.3.m3.2.2.3"></in><set id="S3.SS2.p2.3.m3.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2"><apply id="S3.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2">𝑦</ci><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p2.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS2.p2.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.3">𝑗</ci></apply></set><ci id="S3.SS2.p2.3.m3.2.2.4.cmml" xref="S3.SS2.p2.3.m3.2.2.4">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.2c">\{y_{i},y_{j}\}\in Y</annotation></semantics></math>. The SA(Y)-SGA(X,Y) layer in Figure <a href="#S3.F3.sf3" title="In Figure 3 ‣ 3.1 Self-Attention and Guided-Attention Units ‣ 3 Modular Co-Attention Layer ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(c)</span></a> continues to add a SA(X) unit to the SA(Y)-GA(X,Y) layer to model the intra-modal interaction between each image region pairs <math id="S3.SS2.p2.4.m4.2" class="ltx_Math" alttext="\{x_{i},x_{j}\}\in X" display="inline"><semantics id="S3.SS2.p2.4.m4.2a"><mrow id="S3.SS2.p2.4.m4.2.2" xref="S3.SS2.p2.4.m4.2.2.cmml"><mrow id="S3.SS2.p2.4.m4.2.2.2.2" xref="S3.SS2.p2.4.m4.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.4.m4.2.2.2.2.3" xref="S3.SS2.p2.4.m4.2.2.2.3.cmml">{</mo><msub id="S3.SS2.p2.4.m4.1.1.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.1.1.1.2" xref="S3.SS2.p2.4.m4.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS2.p2.4.m4.1.1.1.1.1.3" xref="S3.SS2.p2.4.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p2.4.m4.2.2.2.2.4" xref="S3.SS2.p2.4.m4.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.4.m4.2.2.2.2.2" xref="S3.SS2.p2.4.m4.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.4.m4.2.2.2.2.2.2" xref="S3.SS2.p2.4.m4.2.2.2.2.2.2.cmml">x</mi><mi id="S3.SS2.p2.4.m4.2.2.2.2.2.3" xref="S3.SS2.p2.4.m4.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.p2.4.m4.2.2.2.2.5" xref="S3.SS2.p2.4.m4.2.2.2.3.cmml">}</mo></mrow><mo id="S3.SS2.p2.4.m4.2.2.3" xref="S3.SS2.p2.4.m4.2.2.3.cmml">∈</mo><mi id="S3.SS2.p2.4.m4.2.2.4" xref="S3.SS2.p2.4.m4.2.2.4.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.2b"><apply id="S3.SS2.p2.4.m4.2.2.cmml" xref="S3.SS2.p2.4.m4.2.2"><in id="S3.SS2.p2.4.m4.2.2.3.cmml" xref="S3.SS2.p2.4.m4.2.2.3"></in><set id="S3.SS2.p2.4.m4.2.2.2.3.cmml" xref="S3.SS2.p2.4.m4.2.2.2.2"><apply id="S3.SS2.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p2.4.m4.2.2.2.2.2.cmml" xref="S3.SS2.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.4.m4.2.2.2.2.2.2">𝑥</ci><ci id="S3.SS2.p2.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.4.m4.2.2.2.2.2.3">𝑗</ci></apply></set><ci id="S3.SS2.p2.4.m4.2.2.4.cmml" xref="S3.SS2.p2.4.m4.2.2.4">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.2c">\{x_{i},x_{j}\}\in X</annotation></semantics></math>.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>In our implementation, we omit the feed-forward layer and norm layer of the SA(X) unit to save memory costs.</span></span></span>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">Note that the three MCA layers above have not covered all the possible compositions. We have also explored other MCA variants like the symmetric architectures GA(X,Y)-GA(Y,X) and SGA(X,Y)-SGA(Y,X). However, these MCA variants do not report comparative performance, so we do not discuss them further due to space limitations.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Modular Co-Attention Networks</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we describe the Modular Co-Attention Networks (MCAN) architecture for VQA.
We first explain the image and question feature representation from the input question and image. Then, we propose two deep co-attention models, namely <em id="S4.p1.1.1" class="ltx_emph ltx_font_italic">stacking</em> and <em id="S4.p1.1.2" class="ltx_emph ltx_font_italic">encoder-decoder</em>, which consists of multiple MCA layers cascaded in depth to gradually refine the attended image and question features. As we obtained the attended image and question features, we design a simple multimodal fusion model to fuse the multimodal features and finally feed them to a multi-label classifier to predict answer. An overview flowchart of MCAN is shown in Figure <a href="#S3.F4" title="Figure 4 ‣ 3.1 Self-Attention and Guided-Attention Units ‣ 3 Modular Co-Attention Layer ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.5" class="ltx_p">We name the MCAN model with the stacking strategy as MCAN<sub id="S4.p2.5.1" class="ltx_sub"><span id="S4.p2.5.1.1" class="ltx_text ltx_font_italic">sk</span></sub>-<math id="S4.p2.2.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.p2.2.m2.1a"><mi id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><ci id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">L</annotation></semantics></math> and the MCAN model with the encoder-decoder strategy as MCAN<sub id="S4.p2.5.2" class="ltx_sub"><span id="S4.p2.5.2.1" class="ltx_text ltx_font_italic">ed</span></sub>-<math id="S4.p2.4.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.p2.4.m4.1a"><mi id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><ci id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">L</annotation></semantics></math>, where <math id="S4.p2.5.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.p2.5.m5.1a"><mi id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><ci id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">L</annotation></semantics></math> is the total number MCA layers cascaded in depth.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Question and Image Representations</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.4" class="ltx_p">The input image is represented as a set of regional visual features in a bottom-up manner <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. These features are the intermediate features extracted from a Faster R-CNN model (with ResNet-101 as its backbone) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> pre-trained on the Visual Genome dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. We set a confidence threshold to the probabilities of detected objects and obtain a dynamic number of objects <math id="S4.SS1.p1.1.m1.2" class="ltx_Math" alttext="m\in[10,100]" display="inline"><semantics id="S4.SS1.p1.1.m1.2a"><mrow id="S4.SS1.p1.1.m1.2.3" xref="S4.SS1.p1.1.m1.2.3.cmml"><mi id="S4.SS1.p1.1.m1.2.3.2" xref="S4.SS1.p1.1.m1.2.3.2.cmml">m</mi><mo id="S4.SS1.p1.1.m1.2.3.1" xref="S4.SS1.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p1.1.m1.2.3.3.2" xref="S4.SS1.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.1.m1.2.3.3.2.1" xref="S4.SS1.p1.1.m1.2.3.3.1.cmml">[</mo><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">10</mn><mo id="S4.SS1.p1.1.m1.2.3.3.2.2" xref="S4.SS1.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p1.1.m1.2.2" xref="S4.SS1.p1.1.m1.2.2.cmml">100</mn><mo stretchy="false" id="S4.SS1.p1.1.m1.2.3.3.2.3" xref="S4.SS1.p1.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.2b"><apply id="S4.SS1.p1.1.m1.2.3.cmml" xref="S4.SS1.p1.1.m1.2.3"><in id="S4.SS1.p1.1.m1.2.3.1.cmml" xref="S4.SS1.p1.1.m1.2.3.1"></in><ci id="S4.SS1.p1.1.m1.2.3.2.cmml" xref="S4.SS1.p1.1.m1.2.3.2">𝑚</ci><interval closure="closed" id="S4.SS1.p1.1.m1.2.3.3.1.cmml" xref="S4.SS1.p1.1.m1.2.3.3.2"><cn type="integer" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">10</cn><cn type="integer" id="S4.SS1.p1.1.m1.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2">100</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.2c">m\in[10,100]</annotation></semantics></math>. For the <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">i</annotation></semantics></math>-th object, it is represented as a feature <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="x_{i}\in\mathbb{R}^{d_{x}}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><msub id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2.2" xref="S4.SS1.p1.3.m3.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p1.3.m3.1.1.2.3" xref="S4.SS1.p1.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml"><mi id="S4.SS1.p1.3.m3.1.1.3.2" xref="S4.SS1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><msub id="S4.SS1.p1.3.m3.1.1.3.3" xref="S4.SS1.p1.3.m3.1.1.3.3.cmml"><mi id="S4.SS1.p1.3.m3.1.1.3.3.2" xref="S4.SS1.p1.3.m3.1.1.3.3.2.cmml">d</mi><mi id="S4.SS1.p1.3.m3.1.1.3.3.3" xref="S4.SS1.p1.3.m3.1.1.3.3.3.cmml">x</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><in id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1"></in><apply id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2.2">𝑥</ci><ci id="S4.SS1.p1.3.m3.1.1.2.3.cmml" xref="S4.SS1.p1.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.3.2.cmml" xref="S4.SS1.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.3.m3.1.1.3.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3.2">𝑑</ci><ci id="S4.SS1.p1.3.m3.1.1.3.3.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">x_{i}\in\mathbb{R}^{d_{x}}</annotation></semantics></math> by mean-pooling the convolutional feature from its detected region. Finally, the image is represented as a feature matrix <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="X\in\mathbb{R}^{m\times d_{x}}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">X</mi><mo id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.3.2" xref="S4.SS1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.4.m4.1.1.3.3" xref="S4.SS1.p1.4.m4.1.1.3.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.3.3.2" xref="S4.SS1.p1.4.m4.1.1.3.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.4.m4.1.1.3.3.1" xref="S4.SS1.p1.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S4.SS1.p1.4.m4.1.1.3.3.3" xref="S4.SS1.p1.4.m4.1.1.3.3.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.3.3.3.2" xref="S4.SS1.p1.4.m4.1.1.3.3.3.2.cmml">d</mi><mi id="S4.SS1.p1.4.m4.1.1.3.3.3.3" xref="S4.SS1.p1.4.m4.1.1.3.3.3.3.cmml">x</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><in id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"></in><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝑋</ci><apply id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.4.m4.1.1.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3"><times id="S4.SS1.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.1"></times><ci id="S4.SS1.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.2">𝑚</ci><apply id="S4.SS1.p1.4.m4.1.1.3.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.3.3.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.3.3.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="S4.SS1.p1.4.m4.1.1.3.3.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.3.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">X\in\mathbb{R}^{m\times d_{x}}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.4" class="ltx_p">The input question is first tokenized into words, and trimmed to a maximum of 14 words similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Each word in the question is further transformed into a vector using the 300-D GloVe word embeddings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> pre-trained on a large-scale corpus. This results in a sequence of words of size <math id="S4.SS1.p2.1.m1.1" class="ltx_math_unparsed" alttext="n\times" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1b"><mi id="S4.SS1.p2.1.m1.1.1">n</mi><mo lspace="0.222em" id="S4.SS1.p2.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">n\times</annotation></semantics></math>300, where <math id="S4.SS1.p2.2.m2.2" class="ltx_Math" alttext="n\in[1,14]" display="inline"><semantics id="S4.SS1.p2.2.m2.2a"><mrow id="S4.SS1.p2.2.m2.2.3" xref="S4.SS1.p2.2.m2.2.3.cmml"><mi id="S4.SS1.p2.2.m2.2.3.2" xref="S4.SS1.p2.2.m2.2.3.2.cmml">n</mi><mo id="S4.SS1.p2.2.m2.2.3.1" xref="S4.SS1.p2.2.m2.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p2.2.m2.2.3.3.2" xref="S4.SS1.p2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.2.m2.2.3.3.2.1" xref="S4.SS1.p2.2.m2.2.3.3.1.cmml">[</mo><mn id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">1</mn><mo id="S4.SS1.p2.2.m2.2.3.3.2.2" xref="S4.SS1.p2.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p2.2.m2.2.2" xref="S4.SS1.p2.2.m2.2.2.cmml">14</mn><mo stretchy="false" id="S4.SS1.p2.2.m2.2.3.3.2.3" xref="S4.SS1.p2.2.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.2b"><apply id="S4.SS1.p2.2.m2.2.3.cmml" xref="S4.SS1.p2.2.m2.2.3"><in id="S4.SS1.p2.2.m2.2.3.1.cmml" xref="S4.SS1.p2.2.m2.2.3.1"></in><ci id="S4.SS1.p2.2.m2.2.3.2.cmml" xref="S4.SS1.p2.2.m2.2.3.2">𝑛</ci><interval closure="closed" id="S4.SS1.p2.2.m2.2.3.3.1.cmml" xref="S4.SS1.p2.2.m2.2.3.3.2"><cn type="integer" id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">1</cn><cn type="integer" id="S4.SS1.p2.2.m2.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2">14</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.2c">n\in[1,14]</annotation></semantics></math> is the number of words in the question. The word embeddings are then passed through a one-layer LSTM network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> with <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="d_{y}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><msub id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">d</mi><mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝑑</ci><ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">d_{y}</annotation></semantics></math> hidden units. In contrast to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> which only uses the final state (<em id="S4.SS1.p2.4.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS1.p2.4.2" class="ltx_text"></span>, the output feature for the last word) as the question feature, we maintain the output features for all words and output a question feature matrix <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="Y\in\mathbb{R}^{n\times d_{y}}" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mrow id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">Y</mi><mo id="S4.SS1.p2.4.m4.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml"><mi id="S4.SS1.p2.4.m4.1.1.3.2" xref="S4.SS1.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p2.4.m4.1.1.3.3" xref="S4.SS1.p2.4.m4.1.1.3.3.cmml"><mi id="S4.SS1.p2.4.m4.1.1.3.3.2" xref="S4.SS1.p2.4.m4.1.1.3.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p2.4.m4.1.1.3.3.1" xref="S4.SS1.p2.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S4.SS1.p2.4.m4.1.1.3.3.3" xref="S4.SS1.p2.4.m4.1.1.3.3.3.cmml"><mi id="S4.SS1.p2.4.m4.1.1.3.3.3.2" xref="S4.SS1.p2.4.m4.1.1.3.3.3.2.cmml">d</mi><mi id="S4.SS1.p2.4.m4.1.1.3.3.3.3" xref="S4.SS1.p2.4.m4.1.1.3.3.3.3.cmml">y</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><in id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1"></in><ci id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">𝑌</ci><apply id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.3.1.cmml" xref="S4.SS1.p2.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.3.2.cmml" xref="S4.SS1.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S4.SS1.p2.4.m4.1.1.3.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3.3"><times id="S4.SS1.p2.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.p2.4.m4.1.1.3.3.1"></times><ci id="S4.SS1.p2.4.m4.1.1.3.3.2.cmml" xref="S4.SS1.p2.4.m4.1.1.3.3.2">𝑛</ci><apply id="S4.SS1.p2.4.m4.1.1.3.3.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.3.3.3.1.cmml" xref="S4.SS1.p2.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.3.3.3.2.cmml" xref="S4.SS1.p2.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="S4.SS1.p2.4.m4.1.1.3.3.3.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3.3.3.3">𝑦</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">Y\in\mathbb{R}^{n\times d_{y}}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.7" class="ltx_p">To deal with the variable number of objects <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">m</annotation></semantics></math> and variable question length <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">n</annotation></semantics></math>, we use zero-padding to fill <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">X</annotation></semantics></math> and <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><mi id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><ci id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">Y</annotation></semantics></math> to their maximum sizes (<em id="S4.SS1.p3.7.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS1.p3.7.2" class="ltx_text"></span>, <math id="S4.SS1.p3.5.m5.1" class="ltx_Math" alttext="m=100" display="inline"><semantics id="S4.SS1.p3.5.m5.1a"><mrow id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml">m</mi><mo id="S4.SS1.p3.5.m5.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><eq id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1"></eq><ci id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2">𝑚</ci><cn type="integer" id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">m=100</annotation></semantics></math> and <math id="S4.SS1.p3.6.m6.1" class="ltx_Math" alttext="n=14" display="inline"><semantics id="S4.SS1.p3.6.m6.1a"><mrow id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml">n</mi><mo id="S4.SS1.p3.6.m6.1.1.1" xref="S4.SS1.p3.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.p3.6.m6.1.1.3" xref="S4.SS1.p3.6.m6.1.1.3.cmml">14</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><eq id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1.1"></eq><ci id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2">𝑛</ci><cn type="integer" id="S4.SS1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">n=14</annotation></semantics></math>, respectively). During training, we mask the padding logits with <math id="S4.SS1.p3.7.m7.1" class="ltx_Math" alttext="-\infty" display="inline"><semantics id="S4.SS1.p3.7.m7.1a"><mrow id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml"><mo id="S4.SS1.p3.7.m7.1.1a" xref="S4.SS1.p3.7.m7.1.1.cmml">−</mo><mi mathvariant="normal" id="S4.SS1.p3.7.m7.1.1.2" xref="S4.SS1.p3.7.m7.1.1.2.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.1b"><apply id="S4.SS1.p3.7.m7.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1"><minus id="S4.SS1.p3.7.m7.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1"></minus><infinity id="S4.SS1.p3.7.m7.1.1.2.cmml" xref="S4.SS1.p3.7.m7.1.1.2"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.1c">-\infty</annotation></semantics></math> to get zero probability before every softmax layer to avoid the underflow problem.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Deep Co-Attention Learning</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.12" class="ltx_p">Taking the aforementioned image features <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">X</annotation></semantics></math> and the question features <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">Y</annotation></semantics></math> as inputs, we perform deep co-attention learning by passing the input features though a deep co-attention model consisting of <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">L</annotation></semantics></math> MCA layers cascaded in depth (denoted by MCA<sup id="S4.SS2.p1.12.1" class="ltx_sup"><span id="S4.SS2.p1.12.1.1" class="ltx_text ltx_font_italic">(1)</span></sup>, MCA<sup id="S4.SS2.p1.12.2" class="ltx_sup"><span id="S4.SS2.p1.12.2.1" class="ltx_text ltx_font_italic">(2)</span></sup> … MCA<sup id="S4.SS2.p1.12.3" class="ltx_sup"><span id="S4.SS2.p1.12.3.1" class="ltx_text ltx_font_italic">(L)</span></sup>). Denoting the input features for MCA<sup id="S4.SS2.p1.12.4" class="ltx_sup"><span id="S4.SS2.p1.12.4.1" class="ltx_text ltx_font_italic">(l)</span></sup> as <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="X^{(l-1)}" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><msup id="S4.SS2.p1.8.m8.1.2" xref="S4.SS2.p1.8.m8.1.2.cmml"><mi id="S4.SS2.p1.8.m8.1.2.2" xref="S4.SS2.p1.8.m8.1.2.2.cmml">X</mi><mrow id="S4.SS2.p1.8.m8.1.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.8.m8.1.1.1.1.2" xref="S4.SS2.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.8.m8.1.1.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.8.m8.1.1.1.1.1.2" xref="S4.SS2.p1.8.m8.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.p1.8.m8.1.1.1.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.p1.8.m8.1.1.1.1.1.3" xref="S4.SS2.p1.8.m8.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS2.p1.8.m8.1.1.1.1.3" xref="S4.SS2.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><apply id="S4.SS2.p1.8.m8.1.2.cmml" xref="S4.SS2.p1.8.m8.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.2.1.cmml" xref="S4.SS2.p1.8.m8.1.2">superscript</csymbol><ci id="S4.SS2.p1.8.m8.1.2.2.cmml" xref="S4.SS2.p1.8.m8.1.2.2">𝑋</ci><apply id="S4.SS2.p1.8.m8.1.1.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1"><minus id="S4.SS2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1"></minus><ci id="S4.SS2.p1.8.m8.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S4.SS2.p1.8.m8.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">X^{(l-1)}</annotation></semantics></math> and <math id="S4.SS2.p1.9.m9.1" class="ltx_Math" alttext="Y^{(l-1)}" display="inline"><semantics id="S4.SS2.p1.9.m9.1a"><msup id="S4.SS2.p1.9.m9.1.2" xref="S4.SS2.p1.9.m9.1.2.cmml"><mi id="S4.SS2.p1.9.m9.1.2.2" xref="S4.SS2.p1.9.m9.1.2.2.cmml">Y</mi><mrow id="S4.SS2.p1.9.m9.1.1.1.1" xref="S4.SS2.p1.9.m9.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.9.m9.1.1.1.1.2" xref="S4.SS2.p1.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.9.m9.1.1.1.1.1" xref="S4.SS2.p1.9.m9.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.9.m9.1.1.1.1.1.2" xref="S4.SS2.p1.9.m9.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.p1.9.m9.1.1.1.1.1.1" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.p1.9.m9.1.1.1.1.1.3" xref="S4.SS2.p1.9.m9.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS2.p1.9.m9.1.1.1.1.3" xref="S4.SS2.p1.9.m9.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><apply id="S4.SS2.p1.9.m9.1.2.cmml" xref="S4.SS2.p1.9.m9.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.1.2.1.cmml" xref="S4.SS2.p1.9.m9.1.2">superscript</csymbol><ci id="S4.SS2.p1.9.m9.1.2.2.cmml" xref="S4.SS2.p1.9.m9.1.2.2">𝑌</ci><apply id="S4.SS2.p1.9.m9.1.1.1.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1"><minus id="S4.SS2.p1.9.m9.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1"></minus><ci id="S4.SS2.p1.9.m9.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S4.SS2.p1.9.m9.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">Y^{(l-1)}</annotation></semantics></math> respectively, their output features are denoted by <math id="S4.SS2.p1.10.m10.1" class="ltx_Math" alttext="X^{(l)}" display="inline"><semantics id="S4.SS2.p1.10.m10.1a"><msup id="S4.SS2.p1.10.m10.1.2" xref="S4.SS2.p1.10.m10.1.2.cmml"><mi id="S4.SS2.p1.10.m10.1.2.2" xref="S4.SS2.p1.10.m10.1.2.2.cmml">X</mi><mrow id="S4.SS2.p1.10.m10.1.1.1.3" xref="S4.SS2.p1.10.m10.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.10.m10.1.1.1.3.1" xref="S4.SS2.p1.10.m10.1.2.cmml">(</mo><mi id="S4.SS2.p1.10.m10.1.1.1.1" xref="S4.SS2.p1.10.m10.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S4.SS2.p1.10.m10.1.1.1.3.2" xref="S4.SS2.p1.10.m10.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m10.1b"><apply id="S4.SS2.p1.10.m10.1.2.cmml" xref="S4.SS2.p1.10.m10.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m10.1.2.1.cmml" xref="S4.SS2.p1.10.m10.1.2">superscript</csymbol><ci id="S4.SS2.p1.10.m10.1.2.2.cmml" xref="S4.SS2.p1.10.m10.1.2.2">𝑋</ci><ci id="S4.SS2.p1.10.m10.1.1.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m10.1c">X^{(l)}</annotation></semantics></math> and <math id="S4.SS2.p1.11.m11.1" class="ltx_Math" alttext="Y^{(l)}" display="inline"><semantics id="S4.SS2.p1.11.m11.1a"><msup id="S4.SS2.p1.11.m11.1.2" xref="S4.SS2.p1.11.m11.1.2.cmml"><mi id="S4.SS2.p1.11.m11.1.2.2" xref="S4.SS2.p1.11.m11.1.2.2.cmml">Y</mi><mrow id="S4.SS2.p1.11.m11.1.1.1.3" xref="S4.SS2.p1.11.m11.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.11.m11.1.1.1.3.1" xref="S4.SS2.p1.11.m11.1.2.cmml">(</mo><mi id="S4.SS2.p1.11.m11.1.1.1.1" xref="S4.SS2.p1.11.m11.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S4.SS2.p1.11.m11.1.1.1.3.2" xref="S4.SS2.p1.11.m11.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m11.1b"><apply id="S4.SS2.p1.11.m11.1.2.cmml" xref="S4.SS2.p1.11.m11.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.11.m11.1.2.1.cmml" xref="S4.SS2.p1.11.m11.1.2">superscript</csymbol><ci id="S4.SS2.p1.11.m11.1.2.2.cmml" xref="S4.SS2.p1.11.m11.1.2.2">𝑌</ci><ci id="S4.SS2.p1.11.m11.1.1.1.1.cmml" xref="S4.SS2.p1.11.m11.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m11.1c">Y^{(l)}</annotation></semantics></math>, which are further fed to the MCA<sup id="S4.SS2.p1.12.5" class="ltx_sup"><span id="S4.SS2.p1.12.5.1" class="ltx_text ltx_font_italic">(l+1)</span></sup> as its inputs in a recursive manner.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.8" class="ltx_Math" alttext="[X^{(l)},Y^{(l)}]=\mathrm{MCA}^{(l)}([X^{(l-1)},Y^{(l-1)}])" display="block"><semantics id="S4.E4.m1.8a"><mrow id="S4.E4.m1.8.8" xref="S4.E4.m1.8.8.cmml"><mrow id="S4.E4.m1.7.7.2.2" xref="S4.E4.m1.7.7.2.3.cmml"><mo stretchy="false" id="S4.E4.m1.7.7.2.2.3" xref="S4.E4.m1.7.7.2.3.cmml">[</mo><msup id="S4.E4.m1.6.6.1.1.1" xref="S4.E4.m1.6.6.1.1.1.cmml"><mi id="S4.E4.m1.6.6.1.1.1.2" xref="S4.E4.m1.6.6.1.1.1.2.cmml">X</mi><mrow id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.6.6.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.1.1.1.3.1" xref="S4.E4.m1.6.6.1.1.1.cmml">(</mo><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S4.E4.m1.1.1.1.3.2" xref="S4.E4.m1.6.6.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.E4.m1.7.7.2.2.4" xref="S4.E4.m1.7.7.2.3.cmml">,</mo><msup id="S4.E4.m1.7.7.2.2.2" xref="S4.E4.m1.7.7.2.2.2.cmml"><mi id="S4.E4.m1.7.7.2.2.2.2" xref="S4.E4.m1.7.7.2.2.2.2.cmml">Y</mi><mrow id="S4.E4.m1.2.2.1.3" xref="S4.E4.m1.7.7.2.2.2.cmml"><mo stretchy="false" id="S4.E4.m1.2.2.1.3.1" xref="S4.E4.m1.7.7.2.2.2.cmml">(</mo><mi id="S4.E4.m1.2.2.1.1" xref="S4.E4.m1.2.2.1.1.cmml">l</mi><mo stretchy="false" id="S4.E4.m1.2.2.1.3.2" xref="S4.E4.m1.7.7.2.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="S4.E4.m1.7.7.2.2.5" xref="S4.E4.m1.7.7.2.3.cmml">]</mo></mrow><mo id="S4.E4.m1.8.8.4" xref="S4.E4.m1.8.8.4.cmml">=</mo><mrow id="S4.E4.m1.8.8.3" xref="S4.E4.m1.8.8.3.cmml"><msup id="S4.E4.m1.8.8.3.3" xref="S4.E4.m1.8.8.3.3.cmml"><mi id="S4.E4.m1.8.8.3.3.2" xref="S4.E4.m1.8.8.3.3.2.cmml">MCA</mi><mrow id="S4.E4.m1.3.3.1.3" xref="S4.E4.m1.8.8.3.3.cmml"><mo stretchy="false" id="S4.E4.m1.3.3.1.3.1" xref="S4.E4.m1.8.8.3.3.cmml">(</mo><mi id="S4.E4.m1.3.3.1.1" xref="S4.E4.m1.3.3.1.1.cmml">l</mi><mo stretchy="false" id="S4.E4.m1.3.3.1.3.2" xref="S4.E4.m1.8.8.3.3.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S4.E4.m1.8.8.3.2" xref="S4.E4.m1.8.8.3.2.cmml">​</mo><mrow id="S4.E4.m1.8.8.3.1.1" xref="S4.E4.m1.8.8.3.cmml"><mo stretchy="false" id="S4.E4.m1.8.8.3.1.1.2" xref="S4.E4.m1.8.8.3.cmml">(</mo><mrow id="S4.E4.m1.8.8.3.1.1.1.2" xref="S4.E4.m1.8.8.3.1.1.1.3.cmml"><mo stretchy="false" id="S4.E4.m1.8.8.3.1.1.1.2.3" xref="S4.E4.m1.8.8.3.1.1.1.3.cmml">[</mo><msup id="S4.E4.m1.8.8.3.1.1.1.1.1" xref="S4.E4.m1.8.8.3.1.1.1.1.1.cmml"><mi id="S4.E4.m1.8.8.3.1.1.1.1.1.2" xref="S4.E4.m1.8.8.3.1.1.1.1.1.2.cmml">X</mi><mrow id="S4.E4.m1.4.4.1.1" xref="S4.E4.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.4.4.1.1.2" xref="S4.E4.m1.4.4.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.4.4.1.1.1" xref="S4.E4.m1.4.4.1.1.1.cmml"><mi id="S4.E4.m1.4.4.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.2.cmml">l</mi><mo id="S4.E4.m1.4.4.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.cmml">−</mo><mn id="S4.E4.m1.4.4.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E4.m1.4.4.1.1.3" xref="S4.E4.m1.4.4.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.E4.m1.8.8.3.1.1.1.2.4" xref="S4.E4.m1.8.8.3.1.1.1.3.cmml">,</mo><msup id="S4.E4.m1.8.8.3.1.1.1.2.2" xref="S4.E4.m1.8.8.3.1.1.1.2.2.cmml"><mi id="S4.E4.m1.8.8.3.1.1.1.2.2.2" xref="S4.E4.m1.8.8.3.1.1.1.2.2.2.cmml">Y</mi><mrow id="S4.E4.m1.5.5.1.1" xref="S4.E4.m1.5.5.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.5.5.1.1.2" xref="S4.E4.m1.5.5.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.5.5.1.1.1" xref="S4.E4.m1.5.5.1.1.1.cmml"><mi id="S4.E4.m1.5.5.1.1.1.2" xref="S4.E4.m1.5.5.1.1.1.2.cmml">l</mi><mo id="S4.E4.m1.5.5.1.1.1.1" xref="S4.E4.m1.5.5.1.1.1.1.cmml">−</mo><mn id="S4.E4.m1.5.5.1.1.1.3" xref="S4.E4.m1.5.5.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E4.m1.5.5.1.1.3" xref="S4.E4.m1.5.5.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S4.E4.m1.8.8.3.1.1.1.2.5" xref="S4.E4.m1.8.8.3.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="S4.E4.m1.8.8.3.1.1.3" xref="S4.E4.m1.8.8.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.8b"><apply id="S4.E4.m1.8.8.cmml" xref="S4.E4.m1.8.8"><eq id="S4.E4.m1.8.8.4.cmml" xref="S4.E4.m1.8.8.4"></eq><interval closure="closed" id="S4.E4.m1.7.7.2.3.cmml" xref="S4.E4.m1.7.7.2.2"><apply id="S4.E4.m1.6.6.1.1.1.cmml" xref="S4.E4.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.6.6.1.1.1.1.cmml" xref="S4.E4.m1.6.6.1.1.1">superscript</csymbol><ci id="S4.E4.m1.6.6.1.1.1.2.cmml" xref="S4.E4.m1.6.6.1.1.1.2">𝑋</ci><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E4.m1.7.7.2.2.2.cmml" xref="S4.E4.m1.7.7.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.2.2.2.1.cmml" xref="S4.E4.m1.7.7.2.2.2">superscript</csymbol><ci id="S4.E4.m1.7.7.2.2.2.2.cmml" xref="S4.E4.m1.7.7.2.2.2.2">𝑌</ci><ci id="S4.E4.m1.2.2.1.1.cmml" xref="S4.E4.m1.2.2.1.1">𝑙</ci></apply></interval><apply id="S4.E4.m1.8.8.3.cmml" xref="S4.E4.m1.8.8.3"><times id="S4.E4.m1.8.8.3.2.cmml" xref="S4.E4.m1.8.8.3.2"></times><apply id="S4.E4.m1.8.8.3.3.cmml" xref="S4.E4.m1.8.8.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.8.8.3.3.1.cmml" xref="S4.E4.m1.8.8.3.3">superscript</csymbol><ci id="S4.E4.m1.8.8.3.3.2.cmml" xref="S4.E4.m1.8.8.3.3.2">MCA</ci><ci id="S4.E4.m1.3.3.1.1.cmml" xref="S4.E4.m1.3.3.1.1">𝑙</ci></apply><interval closure="closed" id="S4.E4.m1.8.8.3.1.1.1.3.cmml" xref="S4.E4.m1.8.8.3.1.1.1.2"><apply id="S4.E4.m1.8.8.3.1.1.1.1.1.cmml" xref="S4.E4.m1.8.8.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.8.8.3.1.1.1.1.1.1.cmml" xref="S4.E4.m1.8.8.3.1.1.1.1.1">superscript</csymbol><ci id="S4.E4.m1.8.8.3.1.1.1.1.1.2.cmml" xref="S4.E4.m1.8.8.3.1.1.1.1.1.2">𝑋</ci><apply id="S4.E4.m1.4.4.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1"><minus id="S4.E4.m1.4.4.1.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1"></minus><ci id="S4.E4.m1.4.4.1.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.1.2">𝑙</ci><cn type="integer" id="S4.E4.m1.4.4.1.1.1.3.cmml" xref="S4.E4.m1.4.4.1.1.1.3">1</cn></apply></apply><apply id="S4.E4.m1.8.8.3.1.1.1.2.2.cmml" xref="S4.E4.m1.8.8.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.8.8.3.1.1.1.2.2.1.cmml" xref="S4.E4.m1.8.8.3.1.1.1.2.2">superscript</csymbol><ci id="S4.E4.m1.8.8.3.1.1.1.2.2.2.cmml" xref="S4.E4.m1.8.8.3.1.1.1.2.2.2">𝑌</ci><apply id="S4.E4.m1.5.5.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1"><minus id="S4.E4.m1.5.5.1.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.1.1"></minus><ci id="S4.E4.m1.5.5.1.1.1.2.cmml" xref="S4.E4.m1.5.5.1.1.1.2">𝑙</ci><cn type="integer" id="S4.E4.m1.5.5.1.1.1.3.cmml" xref="S4.E4.m1.5.5.1.1.1.3">1</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.8c">[X^{(l)},Y^{(l)}]=\mathrm{MCA}^{(l)}([X^{(l-1)},Y^{(l-1)}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.3" class="ltx_p">For MCA<sup id="S4.SS2.p3.3.1" class="ltx_sup"><span id="S4.SS2.p3.3.1.1" class="ltx_text ltx_font_italic">(1)</span></sup>, we set its input features <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="X^{(0)}=X" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.2" xref="S4.SS2.p3.2.m2.1.2.cmml"><msup id="S4.SS2.p3.2.m2.1.2.2" xref="S4.SS2.p3.2.m2.1.2.2.cmml"><mi id="S4.SS2.p3.2.m2.1.2.2.2" xref="S4.SS2.p3.2.m2.1.2.2.2.cmml">X</mi><mrow id="S4.SS2.p3.2.m2.1.1.1.3" xref="S4.SS2.p3.2.m2.1.2.2.cmml"><mo stretchy="false" id="S4.SS2.p3.2.m2.1.1.1.3.1" xref="S4.SS2.p3.2.m2.1.2.2.cmml">(</mo><mn id="S4.SS2.p3.2.m2.1.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S4.SS2.p3.2.m2.1.1.1.3.2" xref="S4.SS2.p3.2.m2.1.2.2.cmml">)</mo></mrow></msup><mo id="S4.SS2.p3.2.m2.1.2.1" xref="S4.SS2.p3.2.m2.1.2.1.cmml">=</mo><mi id="S4.SS2.p3.2.m2.1.2.3" xref="S4.SS2.p3.2.m2.1.2.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.2.cmml" xref="S4.SS2.p3.2.m2.1.2"><eq id="S4.SS2.p3.2.m2.1.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.1"></eq><apply id="S4.SS2.p3.2.m2.1.2.2.cmml" xref="S4.SS2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.2.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.2">superscript</csymbol><ci id="S4.SS2.p3.2.m2.1.2.2.2.cmml" xref="S4.SS2.p3.2.m2.1.2.2.2">𝑋</ci><cn type="integer" id="S4.SS2.p3.2.m2.1.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1">0</cn></apply><ci id="S4.SS2.p3.2.m2.1.2.3.cmml" xref="S4.SS2.p3.2.m2.1.2.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">X^{(0)}=X</annotation></semantics></math> and <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="Y^{(0)}=Y" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.2" xref="S4.SS2.p3.3.m3.1.2.cmml"><msup id="S4.SS2.p3.3.m3.1.2.2" xref="S4.SS2.p3.3.m3.1.2.2.cmml"><mi id="S4.SS2.p3.3.m3.1.2.2.2" xref="S4.SS2.p3.3.m3.1.2.2.2.cmml">Y</mi><mrow id="S4.SS2.p3.3.m3.1.1.1.3" xref="S4.SS2.p3.3.m3.1.2.2.cmml"><mo stretchy="false" id="S4.SS2.p3.3.m3.1.1.1.3.1" xref="S4.SS2.p3.3.m3.1.2.2.cmml">(</mo><mn id="S4.SS2.p3.3.m3.1.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S4.SS2.p3.3.m3.1.1.1.3.2" xref="S4.SS2.p3.3.m3.1.2.2.cmml">)</mo></mrow></msup><mo id="S4.SS2.p3.3.m3.1.2.1" xref="S4.SS2.p3.3.m3.1.2.1.cmml">=</mo><mi id="S4.SS2.p3.3.m3.1.2.3" xref="S4.SS2.p3.3.m3.1.2.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.2.cmml" xref="S4.SS2.p3.3.m3.1.2"><eq id="S4.SS2.p3.3.m3.1.2.1.cmml" xref="S4.SS2.p3.3.m3.1.2.1"></eq><apply id="S4.SS2.p3.3.m3.1.2.2.cmml" xref="S4.SS2.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.2.2.1.cmml" xref="S4.SS2.p3.3.m3.1.2.2">superscript</csymbol><ci id="S4.SS2.p3.3.m3.1.2.2.2.cmml" xref="S4.SS2.p3.3.m3.1.2.2.2">𝑌</ci><cn type="integer" id="S4.SS2.p3.3.m3.1.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1.1">0</cn></apply><ci id="S4.SS2.p3.3.m3.1.2.3.cmml" xref="S4.SS2.p3.3.m3.1.2.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">Y^{(0)}=Y</annotation></semantics></math>, respectively.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">Taking the SA(Y)-SGA(X,Y) layer as an example (the other two MCA layers proceed in the same manner), we formulate two deep co-attention models in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.3 Multimodal Fusion and Output Classifier ‣ 4 Modular Co-Attention Networks ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.10" class="ltx_p">The <em id="S4.SS2.p5.10.1" class="ltx_emph ltx_font_italic">stacking</em> model (Figure <a href="#S4.F5.sf1" title="In Figure 5 ‣ 4.3 Multimodal Fusion and Output Classifier ‣ 4 Modular Co-Attention Networks ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5(a)</span></a>) simply stacks <math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><mi id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">L</annotation></semantics></math> MCA layers in depth and outputs <math id="S4.SS2.p5.2.m2.1" class="ltx_Math" alttext="X^{(L)}" display="inline"><semantics id="S4.SS2.p5.2.m2.1a"><msup id="S4.SS2.p5.2.m2.1.2" xref="S4.SS2.p5.2.m2.1.2.cmml"><mi id="S4.SS2.p5.2.m2.1.2.2" xref="S4.SS2.p5.2.m2.1.2.2.cmml">X</mi><mrow id="S4.SS2.p5.2.m2.1.1.1.3" xref="S4.SS2.p5.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p5.2.m2.1.1.1.3.1" xref="S4.SS2.p5.2.m2.1.2.cmml">(</mo><mi id="S4.SS2.p5.2.m2.1.1.1.1" xref="S4.SS2.p5.2.m2.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS2.p5.2.m2.1.1.1.3.2" xref="S4.SS2.p5.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.2.cmml" xref="S4.SS2.p5.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.2.1.cmml" xref="S4.SS2.p5.2.m2.1.2">superscript</csymbol><ci id="S4.SS2.p5.2.m2.1.2.2.cmml" xref="S4.SS2.p5.2.m2.1.2.2">𝑋</ci><ci id="S4.SS2.p5.2.m2.1.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">X^{(L)}</annotation></semantics></math> and <math id="S4.SS2.p5.3.m3.1" class="ltx_Math" alttext="Y^{(L)}" display="inline"><semantics id="S4.SS2.p5.3.m3.1a"><msup id="S4.SS2.p5.3.m3.1.2" xref="S4.SS2.p5.3.m3.1.2.cmml"><mi id="S4.SS2.p5.3.m3.1.2.2" xref="S4.SS2.p5.3.m3.1.2.2.cmml">Y</mi><mrow id="S4.SS2.p5.3.m3.1.1.1.3" xref="S4.SS2.p5.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p5.3.m3.1.1.1.3.1" xref="S4.SS2.p5.3.m3.1.2.cmml">(</mo><mi id="S4.SS2.p5.3.m3.1.1.1.1" xref="S4.SS2.p5.3.m3.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS2.p5.3.m3.1.1.1.3.2" xref="S4.SS2.p5.3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><apply id="S4.SS2.p5.3.m3.1.2.cmml" xref="S4.SS2.p5.3.m3.1.2"><csymbol cd="ambiguous" id="S4.SS2.p5.3.m3.1.2.1.cmml" xref="S4.SS2.p5.3.m3.1.2">superscript</csymbol><ci id="S4.SS2.p5.3.m3.1.2.2.cmml" xref="S4.SS2.p5.3.m3.1.2.2">𝑌</ci><ci id="S4.SS2.p5.3.m3.1.1.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">Y^{(L)}</annotation></semantics></math> as the final attended image and question features. The <em id="S4.SS2.p5.10.2" class="ltx_emph ltx_font_italic">encoder-decoder</em> model (Figure <a href="#S4.F5.sf2" title="In Figure 5 ‣ 4.3 Multimodal Fusion and Output Classifier ‣ 4 Modular Co-Attention Networks ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5(b)</span></a>) is inspired by the Transformer model proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. It slightly modifies the stacking model by replacing the input features <math id="S4.SS2.p5.4.m4.1" class="ltx_Math" alttext="Y^{(l)}" display="inline"><semantics id="S4.SS2.p5.4.m4.1a"><msup id="S4.SS2.p5.4.m4.1.2" xref="S4.SS2.p5.4.m4.1.2.cmml"><mi id="S4.SS2.p5.4.m4.1.2.2" xref="S4.SS2.p5.4.m4.1.2.2.cmml">Y</mi><mrow id="S4.SS2.p5.4.m4.1.1.1.3" xref="S4.SS2.p5.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS2.p5.4.m4.1.1.1.3.1" xref="S4.SS2.p5.4.m4.1.2.cmml">(</mo><mi id="S4.SS2.p5.4.m4.1.1.1.1" xref="S4.SS2.p5.4.m4.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S4.SS2.p5.4.m4.1.1.1.3.2" xref="S4.SS2.p5.4.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><apply id="S4.SS2.p5.4.m4.1.2.cmml" xref="S4.SS2.p5.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.p5.4.m4.1.2.1.cmml" xref="S4.SS2.p5.4.m4.1.2">superscript</csymbol><ci id="S4.SS2.p5.4.m4.1.2.2.cmml" xref="S4.SS2.p5.4.m4.1.2.2">𝑌</ci><ci id="S4.SS2.p5.4.m4.1.1.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">Y^{(l)}</annotation></semantics></math> of the GA unit in each MCA<sup id="S4.SS2.p5.10.3" class="ltx_sup"><span id="S4.SS2.p5.10.3.1" class="ltx_text ltx_font_italic">(l)</span></sup> with the question features <math id="S4.SS2.p5.6.m6.1" class="ltx_Math" alttext="Y^{(L)}" display="inline"><semantics id="S4.SS2.p5.6.m6.1a"><msup id="S4.SS2.p5.6.m6.1.2" xref="S4.SS2.p5.6.m6.1.2.cmml"><mi id="S4.SS2.p5.6.m6.1.2.2" xref="S4.SS2.p5.6.m6.1.2.2.cmml">Y</mi><mrow id="S4.SS2.p5.6.m6.1.1.1.3" xref="S4.SS2.p5.6.m6.1.2.cmml"><mo stretchy="false" id="S4.SS2.p5.6.m6.1.1.1.3.1" xref="S4.SS2.p5.6.m6.1.2.cmml">(</mo><mi id="S4.SS2.p5.6.m6.1.1.1.1" xref="S4.SS2.p5.6.m6.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS2.p5.6.m6.1.1.1.3.2" xref="S4.SS2.p5.6.m6.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.6.m6.1b"><apply id="S4.SS2.p5.6.m6.1.2.cmml" xref="S4.SS2.p5.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m6.1.2.1.cmml" xref="S4.SS2.p5.6.m6.1.2">superscript</csymbol><ci id="S4.SS2.p5.6.m6.1.2.2.cmml" xref="S4.SS2.p5.6.m6.1.2.2">𝑌</ci><ci id="S4.SS2.p5.6.m6.1.1.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.6.m6.1c">Y^{(L)}</annotation></semantics></math> from the last MCA layer. The encoder-decoder strategy can be understood as an encoder to learn the attended question features <math id="S4.SS2.p5.7.m7.1" class="ltx_Math" alttext="Y^{(L)}" display="inline"><semantics id="S4.SS2.p5.7.m7.1a"><msup id="S4.SS2.p5.7.m7.1.2" xref="S4.SS2.p5.7.m7.1.2.cmml"><mi id="S4.SS2.p5.7.m7.1.2.2" xref="S4.SS2.p5.7.m7.1.2.2.cmml">Y</mi><mrow id="S4.SS2.p5.7.m7.1.1.1.3" xref="S4.SS2.p5.7.m7.1.2.cmml"><mo stretchy="false" id="S4.SS2.p5.7.m7.1.1.1.3.1" xref="S4.SS2.p5.7.m7.1.2.cmml">(</mo><mi id="S4.SS2.p5.7.m7.1.1.1.1" xref="S4.SS2.p5.7.m7.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS2.p5.7.m7.1.1.1.3.2" xref="S4.SS2.p5.7.m7.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.7.m7.1b"><apply id="S4.SS2.p5.7.m7.1.2.cmml" xref="S4.SS2.p5.7.m7.1.2"><csymbol cd="ambiguous" id="S4.SS2.p5.7.m7.1.2.1.cmml" xref="S4.SS2.p5.7.m7.1.2">superscript</csymbol><ci id="S4.SS2.p5.7.m7.1.2.2.cmml" xref="S4.SS2.p5.7.m7.1.2.2">𝑌</ci><ci id="S4.SS2.p5.7.m7.1.1.1.1.cmml" xref="S4.SS2.p5.7.m7.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.7.m7.1c">Y^{(L)}</annotation></semantics></math> with <math id="S4.SS2.p5.8.m8.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS2.p5.8.m8.1a"><mi id="S4.SS2.p5.8.m8.1.1" xref="S4.SS2.p5.8.m8.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.8.m8.1b"><ci id="S4.SS2.p5.8.m8.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.8.m8.1c">L</annotation></semantics></math> stacked SA units and a decoder to use <math id="S4.SS2.p5.9.m9.1" class="ltx_Math" alttext="Y^{(L)}" display="inline"><semantics id="S4.SS2.p5.9.m9.1a"><msup id="S4.SS2.p5.9.m9.1.2" xref="S4.SS2.p5.9.m9.1.2.cmml"><mi id="S4.SS2.p5.9.m9.1.2.2" xref="S4.SS2.p5.9.m9.1.2.2.cmml">Y</mi><mrow id="S4.SS2.p5.9.m9.1.1.1.3" xref="S4.SS2.p5.9.m9.1.2.cmml"><mo stretchy="false" id="S4.SS2.p5.9.m9.1.1.1.3.1" xref="S4.SS2.p5.9.m9.1.2.cmml">(</mo><mi id="S4.SS2.p5.9.m9.1.1.1.1" xref="S4.SS2.p5.9.m9.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS2.p5.9.m9.1.1.1.3.2" xref="S4.SS2.p5.9.m9.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.9.m9.1b"><apply id="S4.SS2.p5.9.m9.1.2.cmml" xref="S4.SS2.p5.9.m9.1.2"><csymbol cd="ambiguous" id="S4.SS2.p5.9.m9.1.2.1.cmml" xref="S4.SS2.p5.9.m9.1.2">superscript</csymbol><ci id="S4.SS2.p5.9.m9.1.2.2.cmml" xref="S4.SS2.p5.9.m9.1.2.2">𝑌</ci><ci id="S4.SS2.p5.9.m9.1.1.1.1.cmml" xref="S4.SS2.p5.9.m9.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.9.m9.1c">Y^{(L)}</annotation></semantics></math> to learn the attended image features <math id="S4.SS2.p5.10.m10.1" class="ltx_Math" alttext="X^{(L)}" display="inline"><semantics id="S4.SS2.p5.10.m10.1a"><msup id="S4.SS2.p5.10.m10.1.2" xref="S4.SS2.p5.10.m10.1.2.cmml"><mi id="S4.SS2.p5.10.m10.1.2.2" xref="S4.SS2.p5.10.m10.1.2.2.cmml">X</mi><mrow id="S4.SS2.p5.10.m10.1.1.1.3" xref="S4.SS2.p5.10.m10.1.2.cmml"><mo stretchy="false" id="S4.SS2.p5.10.m10.1.1.1.3.1" xref="S4.SS2.p5.10.m10.1.2.cmml">(</mo><mi id="S4.SS2.p5.10.m10.1.1.1.1" xref="S4.SS2.p5.10.m10.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS2.p5.10.m10.1.1.1.3.2" xref="S4.SS2.p5.10.m10.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.10.m10.1b"><apply id="S4.SS2.p5.10.m10.1.2.cmml" xref="S4.SS2.p5.10.m10.1.2"><csymbol cd="ambiguous" id="S4.SS2.p5.10.m10.1.2.1.cmml" xref="S4.SS2.p5.10.m10.1.2">superscript</csymbol><ci id="S4.SS2.p5.10.m10.1.2.2.cmml" xref="S4.SS2.p5.10.m10.1.2.2">𝑋</ci><ci id="S4.SS2.p5.10.m10.1.1.1.1.cmml" xref="S4.SS2.p5.10.m10.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.10.m10.1c">X^{(L)}</annotation></semantics></math> with stacked SGA units.</p>
</div>
<div id="S4.SS2.p6" class="ltx_para">
<p id="S4.SS2.p6.2" class="ltx_p">The two deep models are of the same size with the same <math id="S4.SS2.p6.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS2.p6.1.m1.1a"><mi id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><ci id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">L</annotation></semantics></math>. As a special case that <math id="S4.SS2.p6.2.m2.1" class="ltx_Math" alttext="L=1" display="inline"><semantics id="S4.SS2.p6.2.m2.1a"><mrow id="S4.SS2.p6.2.m2.1.1" xref="S4.SS2.p6.2.m2.1.1.cmml"><mi id="S4.SS2.p6.2.m2.1.1.2" xref="S4.SS2.p6.2.m2.1.1.2.cmml">L</mi><mo id="S4.SS2.p6.2.m2.1.1.1" xref="S4.SS2.p6.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p6.2.m2.1.1.3" xref="S4.SS2.p6.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.2.m2.1b"><apply id="S4.SS2.p6.2.m2.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1"><eq id="S4.SS2.p6.2.m2.1.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1.1"></eq><ci id="S4.SS2.p6.2.m2.1.1.2.cmml" xref="S4.SS2.p6.2.m2.1.1.2">𝐿</ci><cn type="integer" id="S4.SS2.p6.2.m2.1.1.3.cmml" xref="S4.SS2.p6.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.2.m2.1c">L=1</annotation></semantics></math>, the two models are strictly equivalent to each other.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Multimodal Fusion and Output Classifier</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.9" class="ltx_p">After the deep co-attention learning stage, the output image features <math id="S4.SS3.p1.1.m1.6" class="ltx_Math" alttext="X^{(L)}=[x_{1}^{(L)};...;x_{m}^{(L)}]\in\mathbb{R}^{m\times d}" display="inline"><semantics id="S4.SS3.p1.1.m1.6a"><mrow id="S4.SS3.p1.1.m1.6.6" xref="S4.SS3.p1.1.m1.6.6.cmml"><msup id="S4.SS3.p1.1.m1.6.6.4" xref="S4.SS3.p1.1.m1.6.6.4.cmml"><mi id="S4.SS3.p1.1.m1.6.6.4.2" xref="S4.SS3.p1.1.m1.6.6.4.2.cmml">X</mi><mrow id="S4.SS3.p1.1.m1.1.1.1.3" xref="S4.SS3.p1.1.m1.6.6.4.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m1.1.1.1.3.1" xref="S4.SS3.p1.1.m1.6.6.4.cmml">(</mo><mi id="S4.SS3.p1.1.m1.1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS3.p1.1.m1.1.1.1.3.2" xref="S4.SS3.p1.1.m1.6.6.4.cmml">)</mo></mrow></msup><mo id="S4.SS3.p1.1.m1.6.6.5" xref="S4.SS3.p1.1.m1.6.6.5.cmml">=</mo><mrow id="S4.SS3.p1.1.m1.6.6.2.2" xref="S4.SS3.p1.1.m1.6.6.2.3.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m1.6.6.2.2.3" xref="S4.SS3.p1.1.m1.6.6.2.3.cmml">[</mo><msubsup id="S4.SS3.p1.1.m1.5.5.1.1.1" xref="S4.SS3.p1.1.m1.5.5.1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.5.5.1.1.1.2.2" xref="S4.SS3.p1.1.m1.5.5.1.1.1.2.2.cmml">x</mi><mn id="S4.SS3.p1.1.m1.5.5.1.1.1.2.3" xref="S4.SS3.p1.1.m1.5.5.1.1.1.2.3.cmml">1</mn><mrow id="S4.SS3.p1.1.m1.2.2.1.3" xref="S4.SS3.p1.1.m1.5.5.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m1.2.2.1.3.1" xref="S4.SS3.p1.1.m1.5.5.1.1.1.cmml">(</mo><mi id="S4.SS3.p1.1.m1.2.2.1.1" xref="S4.SS3.p1.1.m1.2.2.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS3.p1.1.m1.2.2.1.3.2" xref="S4.SS3.p1.1.m1.5.5.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS3.p1.1.m1.6.6.2.2.4" xref="S4.SS3.p1.1.m1.6.6.2.3.cmml">;</mo><mi mathvariant="normal" id="S4.SS3.p1.1.m1.4.4" xref="S4.SS3.p1.1.m1.4.4.cmml">…</mi><mo id="S4.SS3.p1.1.m1.6.6.2.2.5" xref="S4.SS3.p1.1.m1.6.6.2.3.cmml">;</mo><msubsup id="S4.SS3.p1.1.m1.6.6.2.2.2" xref="S4.SS3.p1.1.m1.6.6.2.2.2.cmml"><mi id="S4.SS3.p1.1.m1.6.6.2.2.2.2.2" xref="S4.SS3.p1.1.m1.6.6.2.2.2.2.2.cmml">x</mi><mi id="S4.SS3.p1.1.m1.6.6.2.2.2.2.3" xref="S4.SS3.p1.1.m1.6.6.2.2.2.2.3.cmml">m</mi><mrow id="S4.SS3.p1.1.m1.3.3.1.3" xref="S4.SS3.p1.1.m1.6.6.2.2.2.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m1.3.3.1.3.1" xref="S4.SS3.p1.1.m1.6.6.2.2.2.cmml">(</mo><mi id="S4.SS3.p1.1.m1.3.3.1.1" xref="S4.SS3.p1.1.m1.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS3.p1.1.m1.3.3.1.3.2" xref="S4.SS3.p1.1.m1.6.6.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S4.SS3.p1.1.m1.6.6.2.2.6" xref="S4.SS3.p1.1.m1.6.6.2.3.cmml">]</mo></mrow><mo id="S4.SS3.p1.1.m1.6.6.6" xref="S4.SS3.p1.1.m1.6.6.6.cmml">∈</mo><msup id="S4.SS3.p1.1.m1.6.6.7" xref="S4.SS3.p1.1.m1.6.6.7.cmml"><mi id="S4.SS3.p1.1.m1.6.6.7.2" xref="S4.SS3.p1.1.m1.6.6.7.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.1.m1.6.6.7.3" xref="S4.SS3.p1.1.m1.6.6.7.3.cmml"><mi id="S4.SS3.p1.1.m1.6.6.7.3.2" xref="S4.SS3.p1.1.m1.6.6.7.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p1.1.m1.6.6.7.3.1" xref="S4.SS3.p1.1.m1.6.6.7.3.1.cmml">×</mo><mi id="S4.SS3.p1.1.m1.6.6.7.3.3" xref="S4.SS3.p1.1.m1.6.6.7.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.6b"><apply id="S4.SS3.p1.1.m1.6.6.cmml" xref="S4.SS3.p1.1.m1.6.6"><and id="S4.SS3.p1.1.m1.6.6a.cmml" xref="S4.SS3.p1.1.m1.6.6"></and><apply id="S4.SS3.p1.1.m1.6.6b.cmml" xref="S4.SS3.p1.1.m1.6.6"><eq id="S4.SS3.p1.1.m1.6.6.5.cmml" xref="S4.SS3.p1.1.m1.6.6.5"></eq><apply id="S4.SS3.p1.1.m1.6.6.4.cmml" xref="S4.SS3.p1.1.m1.6.6.4"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.6.6.4.1.cmml" xref="S4.SS3.p1.1.m1.6.6.4">superscript</csymbol><ci id="S4.SS3.p1.1.m1.6.6.4.2.cmml" xref="S4.SS3.p1.1.m1.6.6.4.2">𝑋</ci><ci id="S4.SS3.p1.1.m1.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1">𝐿</ci></apply><list id="S4.SS3.p1.1.m1.6.6.2.3.cmml" xref="S4.SS3.p1.1.m1.6.6.2.2"><apply id="S4.SS3.p1.1.m1.5.5.1.1.1.cmml" xref="S4.SS3.p1.1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.5.5.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.5.5.1.1.1">superscript</csymbol><apply id="S4.SS3.p1.1.m1.5.5.1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.5.5.1.1.1.2.1.cmml" xref="S4.SS3.p1.1.m1.5.5.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.5.5.1.1.1.2.2.cmml" xref="S4.SS3.p1.1.m1.5.5.1.1.1.2.2">𝑥</ci><cn type="integer" id="S4.SS3.p1.1.m1.5.5.1.1.1.2.3.cmml" xref="S4.SS3.p1.1.m1.5.5.1.1.1.2.3">1</cn></apply><ci id="S4.SS3.p1.1.m1.2.2.1.1.cmml" xref="S4.SS3.p1.1.m1.2.2.1.1">𝐿</ci></apply><ci id="S4.SS3.p1.1.m1.4.4.cmml" xref="S4.SS3.p1.1.m1.4.4">…</ci><apply id="S4.SS3.p1.1.m1.6.6.2.2.2.cmml" xref="S4.SS3.p1.1.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.6.6.2.2.2.1.cmml" xref="S4.SS3.p1.1.m1.6.6.2.2.2">superscript</csymbol><apply id="S4.SS3.p1.1.m1.6.6.2.2.2.2.cmml" xref="S4.SS3.p1.1.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.6.6.2.2.2.2.1.cmml" xref="S4.SS3.p1.1.m1.6.6.2.2.2">subscript</csymbol><ci id="S4.SS3.p1.1.m1.6.6.2.2.2.2.2.cmml" xref="S4.SS3.p1.1.m1.6.6.2.2.2.2.2">𝑥</ci><ci id="S4.SS3.p1.1.m1.6.6.2.2.2.2.3.cmml" xref="S4.SS3.p1.1.m1.6.6.2.2.2.2.3">𝑚</ci></apply><ci id="S4.SS3.p1.1.m1.3.3.1.1.cmml" xref="S4.SS3.p1.1.m1.3.3.1.1">𝐿</ci></apply></list></apply><apply id="S4.SS3.p1.1.m1.6.6c.cmml" xref="S4.SS3.p1.1.m1.6.6"><in id="S4.SS3.p1.1.m1.6.6.6.cmml" xref="S4.SS3.p1.1.m1.6.6.6"></in><share href="#S4.SS3.p1.1.m1.6.6.2.cmml" id="S4.SS3.p1.1.m1.6.6d.cmml" xref="S4.SS3.p1.1.m1.6.6"></share><apply id="S4.SS3.p1.1.m1.6.6.7.cmml" xref="S4.SS3.p1.1.m1.6.6.7"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.6.6.7.1.cmml" xref="S4.SS3.p1.1.m1.6.6.7">superscript</csymbol><ci id="S4.SS3.p1.1.m1.6.6.7.2.cmml" xref="S4.SS3.p1.1.m1.6.6.7.2">ℝ</ci><apply id="S4.SS3.p1.1.m1.6.6.7.3.cmml" xref="S4.SS3.p1.1.m1.6.6.7.3"><times id="S4.SS3.p1.1.m1.6.6.7.3.1.cmml" xref="S4.SS3.p1.1.m1.6.6.7.3.1"></times><ci id="S4.SS3.p1.1.m1.6.6.7.3.2.cmml" xref="S4.SS3.p1.1.m1.6.6.7.3.2">𝑚</ci><ci id="S4.SS3.p1.1.m1.6.6.7.3.3.cmml" xref="S4.SS3.p1.1.m1.6.6.7.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.6c">X^{(L)}=[x_{1}^{(L)};...;x_{m}^{(L)}]\in\mathbb{R}^{m\times d}</annotation></semantics></math> and question features <math id="S4.SS3.p1.2.m2.6" class="ltx_Math" alttext="Y^{(L)}=[y_{1}^{(L)};...;y_{n}^{(L)}]\in\mathbb{R}^{n\times d}" display="inline"><semantics id="S4.SS3.p1.2.m2.6a"><mrow id="S4.SS3.p1.2.m2.6.6" xref="S4.SS3.p1.2.m2.6.6.cmml"><msup id="S4.SS3.p1.2.m2.6.6.4" xref="S4.SS3.p1.2.m2.6.6.4.cmml"><mi id="S4.SS3.p1.2.m2.6.6.4.2" xref="S4.SS3.p1.2.m2.6.6.4.2.cmml">Y</mi><mrow id="S4.SS3.p1.2.m2.1.1.1.3" xref="S4.SS3.p1.2.m2.6.6.4.cmml"><mo stretchy="false" id="S4.SS3.p1.2.m2.1.1.1.3.1" xref="S4.SS3.p1.2.m2.6.6.4.cmml">(</mo><mi id="S4.SS3.p1.2.m2.1.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS3.p1.2.m2.1.1.1.3.2" xref="S4.SS3.p1.2.m2.6.6.4.cmml">)</mo></mrow></msup><mo id="S4.SS3.p1.2.m2.6.6.5" xref="S4.SS3.p1.2.m2.6.6.5.cmml">=</mo><mrow id="S4.SS3.p1.2.m2.6.6.2.2" xref="S4.SS3.p1.2.m2.6.6.2.3.cmml"><mo stretchy="false" id="S4.SS3.p1.2.m2.6.6.2.2.3" xref="S4.SS3.p1.2.m2.6.6.2.3.cmml">[</mo><msubsup id="S4.SS3.p1.2.m2.5.5.1.1.1" xref="S4.SS3.p1.2.m2.5.5.1.1.1.cmml"><mi id="S4.SS3.p1.2.m2.5.5.1.1.1.2.2" xref="S4.SS3.p1.2.m2.5.5.1.1.1.2.2.cmml">y</mi><mn id="S4.SS3.p1.2.m2.5.5.1.1.1.2.3" xref="S4.SS3.p1.2.m2.5.5.1.1.1.2.3.cmml">1</mn><mrow id="S4.SS3.p1.2.m2.2.2.1.3" xref="S4.SS3.p1.2.m2.5.5.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p1.2.m2.2.2.1.3.1" xref="S4.SS3.p1.2.m2.5.5.1.1.1.cmml">(</mo><mi id="S4.SS3.p1.2.m2.2.2.1.1" xref="S4.SS3.p1.2.m2.2.2.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS3.p1.2.m2.2.2.1.3.2" xref="S4.SS3.p1.2.m2.5.5.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS3.p1.2.m2.6.6.2.2.4" xref="S4.SS3.p1.2.m2.6.6.2.3.cmml">;</mo><mi mathvariant="normal" id="S4.SS3.p1.2.m2.4.4" xref="S4.SS3.p1.2.m2.4.4.cmml">…</mi><mo id="S4.SS3.p1.2.m2.6.6.2.2.5" xref="S4.SS3.p1.2.m2.6.6.2.3.cmml">;</mo><msubsup id="S4.SS3.p1.2.m2.6.6.2.2.2" xref="S4.SS3.p1.2.m2.6.6.2.2.2.cmml"><mi id="S4.SS3.p1.2.m2.6.6.2.2.2.2.2" xref="S4.SS3.p1.2.m2.6.6.2.2.2.2.2.cmml">y</mi><mi id="S4.SS3.p1.2.m2.6.6.2.2.2.2.3" xref="S4.SS3.p1.2.m2.6.6.2.2.2.2.3.cmml">n</mi><mrow id="S4.SS3.p1.2.m2.3.3.1.3" xref="S4.SS3.p1.2.m2.6.6.2.2.2.cmml"><mo stretchy="false" id="S4.SS3.p1.2.m2.3.3.1.3.1" xref="S4.SS3.p1.2.m2.6.6.2.2.2.cmml">(</mo><mi id="S4.SS3.p1.2.m2.3.3.1.1" xref="S4.SS3.p1.2.m2.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS3.p1.2.m2.3.3.1.3.2" xref="S4.SS3.p1.2.m2.6.6.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S4.SS3.p1.2.m2.6.6.2.2.6" xref="S4.SS3.p1.2.m2.6.6.2.3.cmml">]</mo></mrow><mo id="S4.SS3.p1.2.m2.6.6.6" xref="S4.SS3.p1.2.m2.6.6.6.cmml">∈</mo><msup id="S4.SS3.p1.2.m2.6.6.7" xref="S4.SS3.p1.2.m2.6.6.7.cmml"><mi id="S4.SS3.p1.2.m2.6.6.7.2" xref="S4.SS3.p1.2.m2.6.6.7.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.2.m2.6.6.7.3" xref="S4.SS3.p1.2.m2.6.6.7.3.cmml"><mi id="S4.SS3.p1.2.m2.6.6.7.3.2" xref="S4.SS3.p1.2.m2.6.6.7.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p1.2.m2.6.6.7.3.1" xref="S4.SS3.p1.2.m2.6.6.7.3.1.cmml">×</mo><mi id="S4.SS3.p1.2.m2.6.6.7.3.3" xref="S4.SS3.p1.2.m2.6.6.7.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.6b"><apply id="S4.SS3.p1.2.m2.6.6.cmml" xref="S4.SS3.p1.2.m2.6.6"><and id="S4.SS3.p1.2.m2.6.6a.cmml" xref="S4.SS3.p1.2.m2.6.6"></and><apply id="S4.SS3.p1.2.m2.6.6b.cmml" xref="S4.SS3.p1.2.m2.6.6"><eq id="S4.SS3.p1.2.m2.6.6.5.cmml" xref="S4.SS3.p1.2.m2.6.6.5"></eq><apply id="S4.SS3.p1.2.m2.6.6.4.cmml" xref="S4.SS3.p1.2.m2.6.6.4"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.6.6.4.1.cmml" xref="S4.SS3.p1.2.m2.6.6.4">superscript</csymbol><ci id="S4.SS3.p1.2.m2.6.6.4.2.cmml" xref="S4.SS3.p1.2.m2.6.6.4.2">𝑌</ci><ci id="S4.SS3.p1.2.m2.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1">𝐿</ci></apply><list id="S4.SS3.p1.2.m2.6.6.2.3.cmml" xref="S4.SS3.p1.2.m2.6.6.2.2"><apply id="S4.SS3.p1.2.m2.5.5.1.1.1.cmml" xref="S4.SS3.p1.2.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.5.5.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.5.5.1.1.1">superscript</csymbol><apply id="S4.SS3.p1.2.m2.5.5.1.1.1.2.cmml" xref="S4.SS3.p1.2.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.5.5.1.1.1.2.1.cmml" xref="S4.SS3.p1.2.m2.5.5.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.5.5.1.1.1.2.2.cmml" xref="S4.SS3.p1.2.m2.5.5.1.1.1.2.2">𝑦</ci><cn type="integer" id="S4.SS3.p1.2.m2.5.5.1.1.1.2.3.cmml" xref="S4.SS3.p1.2.m2.5.5.1.1.1.2.3">1</cn></apply><ci id="S4.SS3.p1.2.m2.2.2.1.1.cmml" xref="S4.SS3.p1.2.m2.2.2.1.1">𝐿</ci></apply><ci id="S4.SS3.p1.2.m2.4.4.cmml" xref="S4.SS3.p1.2.m2.4.4">…</ci><apply id="S4.SS3.p1.2.m2.6.6.2.2.2.cmml" xref="S4.SS3.p1.2.m2.6.6.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.6.6.2.2.2.1.cmml" xref="S4.SS3.p1.2.m2.6.6.2.2.2">superscript</csymbol><apply id="S4.SS3.p1.2.m2.6.6.2.2.2.2.cmml" xref="S4.SS3.p1.2.m2.6.6.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.6.6.2.2.2.2.1.cmml" xref="S4.SS3.p1.2.m2.6.6.2.2.2">subscript</csymbol><ci id="S4.SS3.p1.2.m2.6.6.2.2.2.2.2.cmml" xref="S4.SS3.p1.2.m2.6.6.2.2.2.2.2">𝑦</ci><ci id="S4.SS3.p1.2.m2.6.6.2.2.2.2.3.cmml" xref="S4.SS3.p1.2.m2.6.6.2.2.2.2.3">𝑛</ci></apply><ci id="S4.SS3.p1.2.m2.3.3.1.1.cmml" xref="S4.SS3.p1.2.m2.3.3.1.1">𝐿</ci></apply></list></apply><apply id="S4.SS3.p1.2.m2.6.6c.cmml" xref="S4.SS3.p1.2.m2.6.6"><in id="S4.SS3.p1.2.m2.6.6.6.cmml" xref="S4.SS3.p1.2.m2.6.6.6"></in><share href="#S4.SS3.p1.2.m2.6.6.2.cmml" id="S4.SS3.p1.2.m2.6.6d.cmml" xref="S4.SS3.p1.2.m2.6.6"></share><apply id="S4.SS3.p1.2.m2.6.6.7.cmml" xref="S4.SS3.p1.2.m2.6.6.7"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.6.6.7.1.cmml" xref="S4.SS3.p1.2.m2.6.6.7">superscript</csymbol><ci id="S4.SS3.p1.2.m2.6.6.7.2.cmml" xref="S4.SS3.p1.2.m2.6.6.7.2">ℝ</ci><apply id="S4.SS3.p1.2.m2.6.6.7.3.cmml" xref="S4.SS3.p1.2.m2.6.6.7.3"><times id="S4.SS3.p1.2.m2.6.6.7.3.1.cmml" xref="S4.SS3.p1.2.m2.6.6.7.3.1"></times><ci id="S4.SS3.p1.2.m2.6.6.7.3.2.cmml" xref="S4.SS3.p1.2.m2.6.6.7.3.2">𝑛</ci><ci id="S4.SS3.p1.2.m2.6.6.7.3.3.cmml" xref="S4.SS3.p1.2.m2.6.6.7.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.6c">Y^{(L)}=[y_{1}^{(L)};...;y_{n}^{(L)}]\in\mathbb{R}^{n\times d}</annotation></semantics></math> already contain rich information about the attention weights over the question words and image regions. Therefore, we design an attentional reduction model with a two-layer MLP (FC(<math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">d</annotation></semantics></math>)-ReLU-Dropout(0.1)-FC(1)) for <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="Y^{(L)}" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><msup id="S4.SS3.p1.4.m4.1.2" xref="S4.SS3.p1.4.m4.1.2.cmml"><mi id="S4.SS3.p1.4.m4.1.2.2" xref="S4.SS3.p1.4.m4.1.2.2.cmml">Y</mi><mrow id="S4.SS3.p1.4.m4.1.1.1.3" xref="S4.SS3.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.4.m4.1.1.1.3.1" xref="S4.SS3.p1.4.m4.1.2.cmml">(</mo><mi id="S4.SS3.p1.4.m4.1.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS3.p1.4.m4.1.1.1.3.2" xref="S4.SS3.p1.4.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.2.cmml" xref="S4.SS3.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.2.1.cmml" xref="S4.SS3.p1.4.m4.1.2">superscript</csymbol><ci id="S4.SS3.p1.4.m4.1.2.2.cmml" xref="S4.SS3.p1.4.m4.1.2.2">𝑌</ci><ci id="S4.SS3.p1.4.m4.1.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">Y^{(L)}</annotation></semantics></math> (or <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="X^{(L)}" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><msup id="S4.SS3.p1.5.m5.1.2" xref="S4.SS3.p1.5.m5.1.2.cmml"><mi id="S4.SS3.p1.5.m5.1.2.2" xref="S4.SS3.p1.5.m5.1.2.2.cmml">X</mi><mrow id="S4.SS3.p1.5.m5.1.1.1.3" xref="S4.SS3.p1.5.m5.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.5.m5.1.1.1.3.1" xref="S4.SS3.p1.5.m5.1.2.cmml">(</mo><mi id="S4.SS3.p1.5.m5.1.1.1.1" xref="S4.SS3.p1.5.m5.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS3.p1.5.m5.1.1.1.3.2" xref="S4.SS3.p1.5.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.2.cmml" xref="S4.SS3.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.2.1.cmml" xref="S4.SS3.p1.5.m5.1.2">superscript</csymbol><ci id="S4.SS3.p1.5.m5.1.2.2.cmml" xref="S4.SS3.p1.5.m5.1.2.2">𝑋</ci><ci id="S4.SS3.p1.5.m5.1.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">X^{(L)}</annotation></semantics></math>) to obtain its attended feature <math id="S4.SS3.p1.6.m6.1" class="ltx_Math" alttext="\tilde{y}" display="inline"><semantics id="S4.SS3.p1.6.m6.1a"><mover accent="true" id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml"><mi id="S4.SS3.p1.6.m6.1.1.2" xref="S4.SS3.p1.6.m6.1.1.2.cmml">y</mi><mo id="S4.SS3.p1.6.m6.1.1.1" xref="S4.SS3.p1.6.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><ci id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1.1">~</ci><ci id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">\tilde{y}</annotation></semantics></math> (or <math id="S4.SS3.p1.7.m7.1" class="ltx_Math" alttext="\tilde{x}" display="inline"><semantics id="S4.SS3.p1.7.m7.1a"><mover accent="true" id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml"><mi id="S4.SS3.p1.7.m7.1.1.2" xref="S4.SS3.p1.7.m7.1.1.2.cmml">x</mi><mo id="S4.SS3.p1.7.m7.1.1.1" xref="S4.SS3.p1.7.m7.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.1b"><apply id="S4.SS3.p1.7.m7.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1"><ci id="S4.SS3.p1.7.m7.1.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1.1">~</ci><ci id="S4.SS3.p1.7.m7.1.1.2.cmml" xref="S4.SS3.p1.7.m7.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.1c">\tilde{x}</annotation></semantics></math>). Taking <math id="S4.SS3.p1.8.m8.1" class="ltx_Math" alttext="X^{(L)}" display="inline"><semantics id="S4.SS3.p1.8.m8.1a"><msup id="S4.SS3.p1.8.m8.1.2" xref="S4.SS3.p1.8.m8.1.2.cmml"><mi id="S4.SS3.p1.8.m8.1.2.2" xref="S4.SS3.p1.8.m8.1.2.2.cmml">X</mi><mrow id="S4.SS3.p1.8.m8.1.1.1.3" xref="S4.SS3.p1.8.m8.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.8.m8.1.1.1.3.1" xref="S4.SS3.p1.8.m8.1.2.cmml">(</mo><mi id="S4.SS3.p1.8.m8.1.1.1.1" xref="S4.SS3.p1.8.m8.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS3.p1.8.m8.1.1.1.3.2" xref="S4.SS3.p1.8.m8.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m8.1b"><apply id="S4.SS3.p1.8.m8.1.2.cmml" xref="S4.SS3.p1.8.m8.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.2.1.cmml" xref="S4.SS3.p1.8.m8.1.2">superscript</csymbol><ci id="S4.SS3.p1.8.m8.1.2.2.cmml" xref="S4.SS3.p1.8.m8.1.2.2">𝑋</ci><ci id="S4.SS3.p1.8.m8.1.1.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m8.1c">X^{(L)}</annotation></semantics></math> as an example, the attended feature <math id="S4.SS3.p1.9.m9.1" class="ltx_Math" alttext="\tilde{x}" display="inline"><semantics id="S4.SS3.p1.9.m9.1a"><mover accent="true" id="S4.SS3.p1.9.m9.1.1" xref="S4.SS3.p1.9.m9.1.1.cmml"><mi id="S4.SS3.p1.9.m9.1.1.2" xref="S4.SS3.p1.9.m9.1.1.2.cmml">x</mi><mo id="S4.SS3.p1.9.m9.1.1.1" xref="S4.SS3.p1.9.m9.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m9.1b"><apply id="S4.SS3.p1.9.m9.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1"><ci id="S4.SS3.p1.9.m9.1.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1.1">~</ci><ci id="S4.SS3.p1.9.m9.1.1.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m9.1c">\tilde{x}</annotation></semantics></math> is obtained as follows:</p>
<table id="S4.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E5X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\alpha" display="inline"><semantics id="S4.E5X.2.1.1.m1.1a"><mi id="S4.E5X.2.1.1.m1.1.1" xref="S4.E5X.2.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.E5X.2.1.1.m1.1b"><ci id="S4.E5X.2.1.1.m1.1.1.cmml" xref="S4.E5X.2.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.E5X.2.1.1.m1.1c">\displaystyle\alpha</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E5X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\mathrm{softmax}(\mathrm{MLP}(X^{(L)}))" display="inline"><semantics id="S4.E5X.3.2.2.m1.2a"><mrow id="S4.E5X.3.2.2.m1.2.2" xref="S4.E5X.3.2.2.m1.2.2.cmml"><mi id="S4.E5X.3.2.2.m1.2.2.3" xref="S4.E5X.3.2.2.m1.2.2.3.cmml"></mi><mo id="S4.E5X.3.2.2.m1.2.2.2" xref="S4.E5X.3.2.2.m1.2.2.2.cmml">=</mo><mrow id="S4.E5X.3.2.2.m1.2.2.1" xref="S4.E5X.3.2.2.m1.2.2.1.cmml"><mi id="S4.E5X.3.2.2.m1.2.2.1.3" xref="S4.E5X.3.2.2.m1.2.2.1.3.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S4.E5X.3.2.2.m1.2.2.1.2" xref="S4.E5X.3.2.2.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E5X.3.2.2.m1.2.2.1.1.1" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5X.3.2.2.m1.2.2.1.1.1.2" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E5X.3.2.2.m1.2.2.1.1.1.1" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.cmml"><mi id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.3" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.3.cmml">MLP</mi><mo lspace="0em" rspace="0em" id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.2" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">X</mi><mrow id="S4.E5X.3.2.2.m1.1.1.1.3" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5X.3.2.2.m1.1.1.1.3.1" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E5X.3.2.2.m1.1.1.1.1" xref="S4.E5X.3.2.2.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.E5X.3.2.2.m1.1.1.1.3.2" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E5X.3.2.2.m1.2.2.1.1.1.3" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5X.3.2.2.m1.2b"><apply id="S4.E5X.3.2.2.m1.2.2.cmml" xref="S4.E5X.3.2.2.m1.2.2"><eq id="S4.E5X.3.2.2.m1.2.2.2.cmml" xref="S4.E5X.3.2.2.m1.2.2.2"></eq><csymbol cd="latexml" id="S4.E5X.3.2.2.m1.2.2.3.cmml" xref="S4.E5X.3.2.2.m1.2.2.3">absent</csymbol><apply id="S4.E5X.3.2.2.m1.2.2.1.cmml" xref="S4.E5X.3.2.2.m1.2.2.1"><times id="S4.E5X.3.2.2.m1.2.2.1.2.cmml" xref="S4.E5X.3.2.2.m1.2.2.1.2"></times><ci id="S4.E5X.3.2.2.m1.2.2.1.3.cmml" xref="S4.E5X.3.2.2.m1.2.2.1.3">softmax</ci><apply id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S4.E5X.3.2.2.m1.2.2.1.1.1"><times id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.2"></times><ci id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.3">MLP</ci><apply id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S4.E5X.3.2.2.m1.1.1.1.1.cmml" xref="S4.E5X.3.2.2.m1.1.1.1.1">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5X.3.2.2.m1.2c">\displaystyle=\mathrm{softmax}(\mathrm{MLP}(X^{(L)}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S4.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E5Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\tilde{x}" display="inline"><semantics id="S4.E5Xa.2.1.1.m1.1a"><mover accent="true" id="S4.E5Xa.2.1.1.m1.1.1" xref="S4.E5Xa.2.1.1.m1.1.1.cmml"><mi id="S4.E5Xa.2.1.1.m1.1.1.2" xref="S4.E5Xa.2.1.1.m1.1.1.2.cmml">x</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.1" xref="S4.E5Xa.2.1.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.E5Xa.2.1.1.m1.1b"><apply id="S4.E5Xa.2.1.1.m1.1.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1"><ci id="S4.E5Xa.2.1.1.m1.1.1.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1">~</ci><ci id="S4.E5Xa.2.1.1.m1.1.1.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5Xa.2.1.1.m1.1c">\displaystyle\tilde{x}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E5Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{m}\alpha_{i}x_{i}^{(L)}" display="inline"><semantics id="S4.E5Xa.3.2.2.m1.1a"><mrow id="S4.E5Xa.3.2.2.m1.1.2" xref="S4.E5Xa.3.2.2.m1.1.2.cmml"><mi id="S4.E5Xa.3.2.2.m1.1.2.2" xref="S4.E5Xa.3.2.2.m1.1.2.2.cmml"></mi><mo id="S4.E5Xa.3.2.2.m1.1.2.1" xref="S4.E5Xa.3.2.2.m1.1.2.1.cmml">=</mo><mrow id="S4.E5Xa.3.2.2.m1.1.2.3" xref="S4.E5Xa.3.2.2.m1.1.2.3.cmml"><mstyle displaystyle="true" id="S4.E5Xa.3.2.2.m1.1.2.3.1" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.cmml"><munderover id="S4.E5Xa.3.2.2.m1.1.2.3.1a" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.cmml"><mo movablelimits="false" id="S4.E5Xa.3.2.2.m1.1.2.3.1.2.2" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.2.2.cmml">∑</mo><mrow id="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.cmml"><mi id="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.2" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.2.cmml">i</mi><mo id="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.1" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.3" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E5Xa.3.2.2.m1.1.2.3.1.3" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.3.cmml">m</mi></munderover></mstyle><mrow id="S4.E5Xa.3.2.2.m1.1.2.3.2" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.cmml"><msub id="S4.E5Xa.3.2.2.m1.1.2.3.2.2" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.2.cmml"><mi id="S4.E5Xa.3.2.2.m1.1.2.3.2.2.2" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.2.2.cmml">α</mi><mi id="S4.E5Xa.3.2.2.m1.1.2.3.2.2.3" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5Xa.3.2.2.m1.1.2.3.2.1" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.1.cmml">​</mo><msubsup id="S4.E5Xa.3.2.2.m1.1.2.3.2.3" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.3.cmml"><mi id="S4.E5Xa.3.2.2.m1.1.2.3.2.3.2.2" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.3.2.2.cmml">x</mi><mi id="S4.E5Xa.3.2.2.m1.1.2.3.2.3.2.3" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.3.2.3.cmml">i</mi><mrow id="S4.E5Xa.3.2.2.m1.1.1.1.3" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.3.cmml"><mo stretchy="false" id="S4.E5Xa.3.2.2.m1.1.1.1.3.1" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.3.cmml">(</mo><mi id="S4.E5Xa.3.2.2.m1.1.1.1.1" xref="S4.E5Xa.3.2.2.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.E5Xa.3.2.2.m1.1.1.1.3.2" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5Xa.3.2.2.m1.1b"><apply id="S4.E5Xa.3.2.2.m1.1.2.cmml" xref="S4.E5Xa.3.2.2.m1.1.2"><eq id="S4.E5Xa.3.2.2.m1.1.2.1.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.1"></eq><csymbol cd="latexml" id="S4.E5Xa.3.2.2.m1.1.2.2.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.2">absent</csymbol><apply id="S4.E5Xa.3.2.2.m1.1.2.3.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3"><apply id="S4.E5Xa.3.2.2.m1.1.2.3.1.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.1"><csymbol cd="ambiguous" id="S4.E5Xa.3.2.2.m1.1.2.3.1.1.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.1">superscript</csymbol><apply id="S4.E5Xa.3.2.2.m1.1.2.3.1.2.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.1"><csymbol cd="ambiguous" id="S4.E5Xa.3.2.2.m1.1.2.3.1.2.1.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.1">subscript</csymbol><sum id="S4.E5Xa.3.2.2.m1.1.2.3.1.2.2.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.2.2"></sum><apply id="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3"><eq id="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.1.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.1"></eq><ci id="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.2.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.3.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E5Xa.3.2.2.m1.1.2.3.1.3.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.1.3">𝑚</ci></apply><apply id="S4.E5Xa.3.2.2.m1.1.2.3.2.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.2"><times id="S4.E5Xa.3.2.2.m1.1.2.3.2.1.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.1"></times><apply id="S4.E5Xa.3.2.2.m1.1.2.3.2.2.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.E5Xa.3.2.2.m1.1.2.3.2.2.1.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.2">subscript</csymbol><ci id="S4.E5Xa.3.2.2.m1.1.2.3.2.2.2.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.2.2">𝛼</ci><ci id="S4.E5Xa.3.2.2.m1.1.2.3.2.2.3.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.2.3">𝑖</ci></apply><apply id="S4.E5Xa.3.2.2.m1.1.2.3.2.3.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S4.E5Xa.3.2.2.m1.1.2.3.2.3.1.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.3">superscript</csymbol><apply id="S4.E5Xa.3.2.2.m1.1.2.3.2.3.2.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S4.E5Xa.3.2.2.m1.1.2.3.2.3.2.1.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.3">subscript</csymbol><ci id="S4.E5Xa.3.2.2.m1.1.2.3.2.3.2.2.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.3.2.2">𝑥</ci><ci id="S4.E5Xa.3.2.2.m1.1.2.3.2.3.2.3.cmml" xref="S4.E5Xa.3.2.2.m1.1.2.3.2.3.2.3">𝑖</ci></apply><ci id="S4.E5Xa.3.2.2.m1.1.1.1.1.cmml" xref="S4.E5Xa.3.2.2.m1.1.1.1.1">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5Xa.3.2.2.m1.1c">\displaystyle=\sum_{i=1}^{m}\alpha_{i}x_{i}^{(L)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S4.SS3.p1.12" class="ltx_p">where <math id="S4.SS3.p1.10.m1.4" class="ltx_Math" alttext="\alpha=[\alpha_{1},\alpha_{2},...,\alpha_{m}]\in\mathbb{R}^{m}" display="inline"><semantics id="S4.SS3.p1.10.m1.4a"><mrow id="S4.SS3.p1.10.m1.4.4" xref="S4.SS3.p1.10.m1.4.4.cmml"><mi id="S4.SS3.p1.10.m1.4.4.5" xref="S4.SS3.p1.10.m1.4.4.5.cmml">α</mi><mo id="S4.SS3.p1.10.m1.4.4.6" xref="S4.SS3.p1.10.m1.4.4.6.cmml">=</mo><mrow id="S4.SS3.p1.10.m1.4.4.3.3" xref="S4.SS3.p1.10.m1.4.4.3.4.cmml"><mo stretchy="false" id="S4.SS3.p1.10.m1.4.4.3.3.4" xref="S4.SS3.p1.10.m1.4.4.3.4.cmml">[</mo><msub id="S4.SS3.p1.10.m1.2.2.1.1.1" xref="S4.SS3.p1.10.m1.2.2.1.1.1.cmml"><mi id="S4.SS3.p1.10.m1.2.2.1.1.1.2" xref="S4.SS3.p1.10.m1.2.2.1.1.1.2.cmml">α</mi><mn id="S4.SS3.p1.10.m1.2.2.1.1.1.3" xref="S4.SS3.p1.10.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p1.10.m1.4.4.3.3.5" xref="S4.SS3.p1.10.m1.4.4.3.4.cmml">,</mo><msub id="S4.SS3.p1.10.m1.3.3.2.2.2" xref="S4.SS3.p1.10.m1.3.3.2.2.2.cmml"><mi id="S4.SS3.p1.10.m1.3.3.2.2.2.2" xref="S4.SS3.p1.10.m1.3.3.2.2.2.2.cmml">α</mi><mn id="S4.SS3.p1.10.m1.3.3.2.2.2.3" xref="S4.SS3.p1.10.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS3.p1.10.m1.4.4.3.3.6" xref="S4.SS3.p1.10.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS3.p1.10.m1.1.1" xref="S4.SS3.p1.10.m1.1.1.cmml">…</mi><mo id="S4.SS3.p1.10.m1.4.4.3.3.7" xref="S4.SS3.p1.10.m1.4.4.3.4.cmml">,</mo><msub id="S4.SS3.p1.10.m1.4.4.3.3.3" xref="S4.SS3.p1.10.m1.4.4.3.3.3.cmml"><mi id="S4.SS3.p1.10.m1.4.4.3.3.3.2" xref="S4.SS3.p1.10.m1.4.4.3.3.3.2.cmml">α</mi><mi id="S4.SS3.p1.10.m1.4.4.3.3.3.3" xref="S4.SS3.p1.10.m1.4.4.3.3.3.3.cmml">m</mi></msub><mo stretchy="false" id="S4.SS3.p1.10.m1.4.4.3.3.8" xref="S4.SS3.p1.10.m1.4.4.3.4.cmml">]</mo></mrow><mo id="S4.SS3.p1.10.m1.4.4.7" xref="S4.SS3.p1.10.m1.4.4.7.cmml">∈</mo><msup id="S4.SS3.p1.10.m1.4.4.8" xref="S4.SS3.p1.10.m1.4.4.8.cmml"><mi id="S4.SS3.p1.10.m1.4.4.8.2" xref="S4.SS3.p1.10.m1.4.4.8.2.cmml">ℝ</mi><mi id="S4.SS3.p1.10.m1.4.4.8.3" xref="S4.SS3.p1.10.m1.4.4.8.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m1.4b"><apply id="S4.SS3.p1.10.m1.4.4.cmml" xref="S4.SS3.p1.10.m1.4.4"><and id="S4.SS3.p1.10.m1.4.4a.cmml" xref="S4.SS3.p1.10.m1.4.4"></and><apply id="S4.SS3.p1.10.m1.4.4b.cmml" xref="S4.SS3.p1.10.m1.4.4"><eq id="S4.SS3.p1.10.m1.4.4.6.cmml" xref="S4.SS3.p1.10.m1.4.4.6"></eq><ci id="S4.SS3.p1.10.m1.4.4.5.cmml" xref="S4.SS3.p1.10.m1.4.4.5">𝛼</ci><list id="S4.SS3.p1.10.m1.4.4.3.4.cmml" xref="S4.SS3.p1.10.m1.4.4.3.3"><apply id="S4.SS3.p1.10.m1.2.2.1.1.1.cmml" xref="S4.SS3.p1.10.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m1.2.2.1.1.1.1.cmml" xref="S4.SS3.p1.10.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.10.m1.2.2.1.1.1.2.cmml" xref="S4.SS3.p1.10.m1.2.2.1.1.1.2">𝛼</ci><cn type="integer" id="S4.SS3.p1.10.m1.2.2.1.1.1.3.cmml" xref="S4.SS3.p1.10.m1.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS3.p1.10.m1.3.3.2.2.2.cmml" xref="S4.SS3.p1.10.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m1.3.3.2.2.2.1.cmml" xref="S4.SS3.p1.10.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS3.p1.10.m1.3.3.2.2.2.2.cmml" xref="S4.SS3.p1.10.m1.3.3.2.2.2.2">𝛼</ci><cn type="integer" id="S4.SS3.p1.10.m1.3.3.2.2.2.3.cmml" xref="S4.SS3.p1.10.m1.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS3.p1.10.m1.1.1.cmml" xref="S4.SS3.p1.10.m1.1.1">…</ci><apply id="S4.SS3.p1.10.m1.4.4.3.3.3.cmml" xref="S4.SS3.p1.10.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m1.4.4.3.3.3.1.cmml" xref="S4.SS3.p1.10.m1.4.4.3.3.3">subscript</csymbol><ci id="S4.SS3.p1.10.m1.4.4.3.3.3.2.cmml" xref="S4.SS3.p1.10.m1.4.4.3.3.3.2">𝛼</ci><ci id="S4.SS3.p1.10.m1.4.4.3.3.3.3.cmml" xref="S4.SS3.p1.10.m1.4.4.3.3.3.3">𝑚</ci></apply></list></apply><apply id="S4.SS3.p1.10.m1.4.4c.cmml" xref="S4.SS3.p1.10.m1.4.4"><in id="S4.SS3.p1.10.m1.4.4.7.cmml" xref="S4.SS3.p1.10.m1.4.4.7"></in><share href="#S4.SS3.p1.10.m1.4.4.3.cmml" id="S4.SS3.p1.10.m1.4.4d.cmml" xref="S4.SS3.p1.10.m1.4.4"></share><apply id="S4.SS3.p1.10.m1.4.4.8.cmml" xref="S4.SS3.p1.10.m1.4.4.8"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m1.4.4.8.1.cmml" xref="S4.SS3.p1.10.m1.4.4.8">superscript</csymbol><ci id="S4.SS3.p1.10.m1.4.4.8.2.cmml" xref="S4.SS3.p1.10.m1.4.4.8.2">ℝ</ci><ci id="S4.SS3.p1.10.m1.4.4.8.3.cmml" xref="S4.SS3.p1.10.m1.4.4.8.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m1.4c">\alpha=[\alpha_{1},\alpha_{2},...,\alpha_{m}]\in\mathbb{R}^{m}</annotation></semantics></math> are the learned attention weights. We can obtain the attended feature <math id="S4.SS3.p1.11.m2.1" class="ltx_Math" alttext="\tilde{y}" display="inline"><semantics id="S4.SS3.p1.11.m2.1a"><mover accent="true" id="S4.SS3.p1.11.m2.1.1" xref="S4.SS3.p1.11.m2.1.1.cmml"><mi id="S4.SS3.p1.11.m2.1.1.2" xref="S4.SS3.p1.11.m2.1.1.2.cmml">y</mi><mo id="S4.SS3.p1.11.m2.1.1.1" xref="S4.SS3.p1.11.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m2.1b"><apply id="S4.SS3.p1.11.m2.1.1.cmml" xref="S4.SS3.p1.11.m2.1.1"><ci id="S4.SS3.p1.11.m2.1.1.1.cmml" xref="S4.SS3.p1.11.m2.1.1.1">~</ci><ci id="S4.SS3.p1.11.m2.1.1.2.cmml" xref="S4.SS3.p1.11.m2.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.11.m2.1c">\tilde{y}</annotation></semantics></math> for <math id="S4.SS3.p1.12.m3.1" class="ltx_Math" alttext="Y^{(L)}" display="inline"><semantics id="S4.SS3.p1.12.m3.1a"><msup id="S4.SS3.p1.12.m3.1.2" xref="S4.SS3.p1.12.m3.1.2.cmml"><mi id="S4.SS3.p1.12.m3.1.2.2" xref="S4.SS3.p1.12.m3.1.2.2.cmml">Y</mi><mrow id="S4.SS3.p1.12.m3.1.1.1.3" xref="S4.SS3.p1.12.m3.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.12.m3.1.1.1.3.1" xref="S4.SS3.p1.12.m3.1.2.cmml">(</mo><mi id="S4.SS3.p1.12.m3.1.1.1.1" xref="S4.SS3.p1.12.m3.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS3.p1.12.m3.1.1.1.3.2" xref="S4.SS3.p1.12.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.12.m3.1b"><apply id="S4.SS3.p1.12.m3.1.2.cmml" xref="S4.SS3.p1.12.m3.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m3.1.2.1.cmml" xref="S4.SS3.p1.12.m3.1.2">superscript</csymbol><ci id="S4.SS3.p1.12.m3.1.2.2.cmml" xref="S4.SS3.p1.12.m3.1.2.2">𝑌</ci><ci id="S4.SS3.p1.12.m3.1.1.1.1.cmml" xref="S4.SS3.p1.12.m3.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.12.m3.1c">Y^{(L)}</annotation></semantics></math> using an independent attentional reduction model by analogy.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.2" class="ltx_p">Using the computed <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="\tilde{y}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mover accent="true" id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">y</mi><mo id="S4.SS3.p2.1.m1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><ci id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1">~</ci><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\tilde{y}</annotation></semantics></math> and <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="\tilde{x}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mover accent="true" id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">x</mi><mo id="S4.SS3.p2.2.m2.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><ci id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1">~</ci><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\tilde{x}</annotation></semantics></math>, we design the linear multimodal fusion function as follows:</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.1" class="ltx_Math" alttext="z=\mathrm{LayerNorm}(W_{x}^{T}\tilde{x}+W_{y}^{T}\tilde{y})" display="block"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><mi id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3.cmml">z</mi><mo id="S4.E6.m1.1.1.2" xref="S4.E6.m1.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.3" xref="S4.E6.m1.1.1.1.3.cmml">LayerNorm</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.2.cmml"><msubsup id="S4.E6.m1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2" xref="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.cmml">W</mi><mi id="S4.E6.m1.1.1.1.1.1.1.2.2.2.3" xref="S4.E6.m1.1.1.1.1.1.1.2.2.2.3.cmml">x</mi><mi id="S4.E6.m1.1.1.1.1.1.1.2.2.3" xref="S4.E6.m1.1.1.1.1.1.1.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.1.1.2.1" xref="S4.E6.m1.1.1.1.1.1.1.2.1.cmml">​</mo><mover accent="true" id="S4.E6.m1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.2.3.2" xref="S4.E6.m1.1.1.1.1.1.1.2.3.2.cmml">x</mi><mo id="S4.E6.m1.1.1.1.1.1.1.2.3.1" xref="S4.E6.m1.1.1.1.1.1.1.2.3.1.cmml">~</mo></mover></mrow><mo id="S4.E6.m1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.3.cmml"><msubsup id="S4.E6.m1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.3.2.2.2" xref="S4.E6.m1.1.1.1.1.1.1.3.2.2.2.cmml">W</mi><mi id="S4.E6.m1.1.1.1.1.1.1.3.2.2.3" xref="S4.E6.m1.1.1.1.1.1.1.3.2.2.3.cmml">y</mi><mi id="S4.E6.m1.1.1.1.1.1.1.3.2.3" xref="S4.E6.m1.1.1.1.1.1.1.3.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.1.1.3.1" xref="S4.E6.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mover accent="true" id="S4.E6.m1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.3.3.2" xref="S4.E6.m1.1.1.1.1.1.1.3.3.2.cmml">y</mi><mo id="S4.E6.m1.1.1.1.1.1.1.3.3.1" xref="S4.E6.m1.1.1.1.1.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><eq id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1.2"></eq><ci id="S4.E6.m1.1.1.3.cmml" xref="S4.E6.m1.1.1.3">𝑧</ci><apply id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><times id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.2"></times><ci id="S4.E6.m1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.3">LayerNorm</ci><apply id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><plus id="S4.E6.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1"></plus><apply id="S4.E6.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2"><times id="S4.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.1"></times><apply id="S4.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2.2.2">𝑊</ci><ci id="S4.E6.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2.2.3">𝑥</ci></apply><ci id="S4.E6.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2.3">𝑇</ci></apply><apply id="S4.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3"><ci id="S4.E6.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3.1">~</ci><ci id="S4.E6.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3.2">𝑥</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3"><times id="S4.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.1"></times><apply id="S4.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.2.2.2">𝑊</ci><ci id="S4.E6.m1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.2.2.3">𝑦</ci></apply><ci id="S4.E6.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.2.3">𝑇</ci></apply><apply id="S4.E6.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.3"><ci id="S4.E6.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.3.1">~</ci><ci id="S4.E6.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.3.2">𝑦</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">z=\mathrm{LayerNorm}(W_{x}^{T}\tilde{x}+W_{y}^{T}\tilde{y})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.5" class="ltx_p">where <math id="S4.SS3.p2.3.m1.2" class="ltx_Math" alttext="W_{x},W_{y}\in\mathbb{R}^{d\times d_{z}}" display="inline"><semantics id="S4.SS3.p2.3.m1.2a"><mrow id="S4.SS3.p2.3.m1.2.2" xref="S4.SS3.p2.3.m1.2.2.cmml"><mrow id="S4.SS3.p2.3.m1.2.2.2.2" xref="S4.SS3.p2.3.m1.2.2.2.3.cmml"><msub id="S4.SS3.p2.3.m1.1.1.1.1.1" xref="S4.SS3.p2.3.m1.1.1.1.1.1.cmml"><mi id="S4.SS3.p2.3.m1.1.1.1.1.1.2" xref="S4.SS3.p2.3.m1.1.1.1.1.1.2.cmml">W</mi><mi id="S4.SS3.p2.3.m1.1.1.1.1.1.3" xref="S4.SS3.p2.3.m1.1.1.1.1.1.3.cmml">x</mi></msub><mo id="S4.SS3.p2.3.m1.2.2.2.2.3" xref="S4.SS3.p2.3.m1.2.2.2.3.cmml">,</mo><msub id="S4.SS3.p2.3.m1.2.2.2.2.2" xref="S4.SS3.p2.3.m1.2.2.2.2.2.cmml"><mi id="S4.SS3.p2.3.m1.2.2.2.2.2.2" xref="S4.SS3.p2.3.m1.2.2.2.2.2.2.cmml">W</mi><mi id="S4.SS3.p2.3.m1.2.2.2.2.2.3" xref="S4.SS3.p2.3.m1.2.2.2.2.2.3.cmml">y</mi></msub></mrow><mo id="S4.SS3.p2.3.m1.2.2.3" xref="S4.SS3.p2.3.m1.2.2.3.cmml">∈</mo><msup id="S4.SS3.p2.3.m1.2.2.4" xref="S4.SS3.p2.3.m1.2.2.4.cmml"><mi id="S4.SS3.p2.3.m1.2.2.4.2" xref="S4.SS3.p2.3.m1.2.2.4.2.cmml">ℝ</mi><mrow id="S4.SS3.p2.3.m1.2.2.4.3" xref="S4.SS3.p2.3.m1.2.2.4.3.cmml"><mi id="S4.SS3.p2.3.m1.2.2.4.3.2" xref="S4.SS3.p2.3.m1.2.2.4.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p2.3.m1.2.2.4.3.1" xref="S4.SS3.p2.3.m1.2.2.4.3.1.cmml">×</mo><msub id="S4.SS3.p2.3.m1.2.2.4.3.3" xref="S4.SS3.p2.3.m1.2.2.4.3.3.cmml"><mi id="S4.SS3.p2.3.m1.2.2.4.3.3.2" xref="S4.SS3.p2.3.m1.2.2.4.3.3.2.cmml">d</mi><mi id="S4.SS3.p2.3.m1.2.2.4.3.3.3" xref="S4.SS3.p2.3.m1.2.2.4.3.3.3.cmml">z</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m1.2b"><apply id="S4.SS3.p2.3.m1.2.2.cmml" xref="S4.SS3.p2.3.m1.2.2"><in id="S4.SS3.p2.3.m1.2.2.3.cmml" xref="S4.SS3.p2.3.m1.2.2.3"></in><list id="S4.SS3.p2.3.m1.2.2.2.3.cmml" xref="S4.SS3.p2.3.m1.2.2.2.2"><apply id="S4.SS3.p2.3.m1.1.1.1.1.1.cmml" xref="S4.SS3.p2.3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.3.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m1.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.3.m1.1.1.1.1.1.2">𝑊</ci><ci id="S4.SS3.p2.3.m1.1.1.1.1.1.3.cmml" xref="S4.SS3.p2.3.m1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S4.SS3.p2.3.m1.2.2.2.2.2.cmml" xref="S4.SS3.p2.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m1.2.2.2.2.2.1.cmml" xref="S4.SS3.p2.3.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p2.3.m1.2.2.2.2.2.2.cmml" xref="S4.SS3.p2.3.m1.2.2.2.2.2.2">𝑊</ci><ci id="S4.SS3.p2.3.m1.2.2.2.2.2.3.cmml" xref="S4.SS3.p2.3.m1.2.2.2.2.2.3">𝑦</ci></apply></list><apply id="S4.SS3.p2.3.m1.2.2.4.cmml" xref="S4.SS3.p2.3.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m1.2.2.4.1.cmml" xref="S4.SS3.p2.3.m1.2.2.4">superscript</csymbol><ci id="S4.SS3.p2.3.m1.2.2.4.2.cmml" xref="S4.SS3.p2.3.m1.2.2.4.2">ℝ</ci><apply id="S4.SS3.p2.3.m1.2.2.4.3.cmml" xref="S4.SS3.p2.3.m1.2.2.4.3"><times id="S4.SS3.p2.3.m1.2.2.4.3.1.cmml" xref="S4.SS3.p2.3.m1.2.2.4.3.1"></times><ci id="S4.SS3.p2.3.m1.2.2.4.3.2.cmml" xref="S4.SS3.p2.3.m1.2.2.4.3.2">𝑑</ci><apply id="S4.SS3.p2.3.m1.2.2.4.3.3.cmml" xref="S4.SS3.p2.3.m1.2.2.4.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m1.2.2.4.3.3.1.cmml" xref="S4.SS3.p2.3.m1.2.2.4.3.3">subscript</csymbol><ci id="S4.SS3.p2.3.m1.2.2.4.3.3.2.cmml" xref="S4.SS3.p2.3.m1.2.2.4.3.3.2">𝑑</ci><ci id="S4.SS3.p2.3.m1.2.2.4.3.3.3.cmml" xref="S4.SS3.p2.3.m1.2.2.4.3.3.3">𝑧</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m1.2c">W_{x},W_{y}\in\mathbb{R}^{d\times d_{z}}</annotation></semantics></math> are two linear projection matrices. <math id="S4.SS3.p2.4.m2.1" class="ltx_Math" alttext="d_{z}" display="inline"><semantics id="S4.SS3.p2.4.m2.1a"><msub id="S4.SS3.p2.4.m2.1.1" xref="S4.SS3.p2.4.m2.1.1.cmml"><mi id="S4.SS3.p2.4.m2.1.1.2" xref="S4.SS3.p2.4.m2.1.1.2.cmml">d</mi><mi id="S4.SS3.p2.4.m2.1.1.3" xref="S4.SS3.p2.4.m2.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m2.1b"><apply id="S4.SS3.p2.4.m2.1.1.cmml" xref="S4.SS3.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m2.1.1.1.cmml" xref="S4.SS3.p2.4.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.4.m2.1.1.2.cmml" xref="S4.SS3.p2.4.m2.1.1.2">𝑑</ci><ci id="S4.SS3.p2.4.m2.1.1.3.cmml" xref="S4.SS3.p2.4.m2.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m2.1c">d_{z}</annotation></semantics></math> is the common dimensionality of the fused feature. <math id="S4.SS3.p2.5.m3.1" class="ltx_Math" alttext="\mathrm{LayerNorm}" display="inline"><semantics id="S4.SS3.p2.5.m3.1a"><mi id="S4.SS3.p2.5.m3.1.1" xref="S4.SS3.p2.5.m3.1.1.cmml">LayerNorm</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m3.1b"><ci id="S4.SS3.p2.5.m3.1.1.cmml" xref="S4.SS3.p2.5.m3.1.1">LayerNorm</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m3.1c">\mathrm{LayerNorm}</annotation></semantics></math> is used here to stabilize training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.5" class="ltx_p">The fused feature <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">z</annotation></semantics></math> is projected into a vector <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="s\in\mathbb{R}^{N}" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><mrow id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">s</mi><mo id="S4.SS3.p3.2.m2.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.3.2" xref="S4.SS3.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS3.p3.2.m2.1.1.3.3" xref="S4.SS3.p3.2.m2.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><in id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1"></in><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">𝑠</ci><apply id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2">ℝ</ci><ci id="S4.SS3.p3.2.m2.1.1.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">s\in\mathbb{R}^{N}</annotation></semantics></math> followed by a sigmoid function, where <math id="S4.SS3.p3.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS3.p3.3.m3.1a"><mi id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><ci id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">N</annotation></semantics></math> is the number of the most frequent answers in the training set. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, we use binary cross-entropy (BCE) as the loss function to train an <math id="S4.SS3.p3.4.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS3.p3.4.m4.1a"><mi id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><ci id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">N</annotation></semantics></math>-way classifier on top of the fused feature <math id="S4.SS3.p3.5.m5.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS3.p3.5.m5.1a"><mi id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><ci id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">z</annotation></semantics></math>.</p>
</div>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1906.10770/assets/x7.png" id="S4.F5.sf1.g1" class="ltx_graphics ltx_img_portrait" width="460" height="792" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F5.sf1.3.2" class="ltx_text" style="font-size:90%;">Stacking</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1906.10770/assets/x8.png" id="S4.F5.sf2.g1" class="ltx_graphics ltx_img_portrait" width="460" height="792" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F5.sf2.3.2" class="ltx_text" style="font-size:90%;">Encoder-Decoder</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.4.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.5.2" class="ltx_text" style="font-size:90%;">Two deep co-attention models based on a cascade of MCA layers (<em id="S4.F5.5.2.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.F5.5.2.2" class="ltx_text"></span>, SA(Y)-SGA(X,Y)).</span></figcaption>
</figure>
<figure id="S4.T1" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T1.st1" class="ltx_table ltx_figure_panel">
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.st1.8.1.1" class="ltx_text" style="font-size:129%;">(a)</span> </span><span id="S4.T1.st1.9.2" class="ltx_text ltx_font_bold" style="font-size:129%;">MCA Variants:<span id="S4.T1.st1.9.2.1" class="ltx_text ltx_font_medium"> Accuracies of the MCAN model with different MCA variants under </span>one<span id="S4.T1.st1.9.2.2" class="ltx_text ltx_font_medium"> layer. ID(Y)-GA(X,Y), SA(Y)-GA(X,Y) and SA(Y)-SGA(X,Y) denote the three MCA variants w/ or w/o the SA units for image and question (see Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Self-Attention and Guided-Attention Units ‣ 3 Modular Co-Attention Layer ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). Since the stacking and the encoder-decoder strategies are equivalent under one layer, we do not distinguish them.</span></span></figcaption>
<table id="S4.T1.st1.10" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.st1.10.1" class="ltx_tr">
<td id="S4.T1.st1.10.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T1.st1.10.1.1.1" class="ltx_text" style="font-size:70%;">Model</span></td>
<td id="S4.T1.st1.10.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.st1.10.1.2.1" class="ltx_text" style="font-size:70%;">All</span></td>
<td id="S4.T1.st1.10.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.st1.10.1.3.1" class="ltx_text" style="font-size:70%;">Y/N</span></td>
<td id="S4.T1.st1.10.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.st1.10.1.4.1" class="ltx_text" style="font-size:70%;">Num</span></td>
<td id="S4.T1.st1.10.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.st1.10.1.5.1" class="ltx_text" style="font-size:70%;">Other</span></td>
</tr>
<tr id="S4.T1.st1.10.2" class="ltx_tr">
<td id="S4.T1.st1.10.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T1.st1.10.2.1.1" class="ltx_text" style="font-size:70%;">ID(Y)-GA(X,Y)</span></td>
<td id="S4.T1.st1.10.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.st1.10.2.2.1" class="ltx_text" style="font-size:70%;">64.8</span></td>
<td id="S4.T1.st1.10.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.st1.10.2.3.1" class="ltx_text" style="font-size:70%;">82.5</span></td>
<td id="S4.T1.st1.10.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.st1.10.2.4.1" class="ltx_text" style="font-size:70%;">44.7</span></td>
<td id="S4.T1.st1.10.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.st1.10.2.5.1" class="ltx_text" style="font-size:70%;">56.7</span></td>
</tr>
<tr id="S4.T1.st1.10.3" class="ltx_tr">
<td id="S4.T1.st1.10.3.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S4.T1.st1.10.3.1.1" class="ltx_text" style="font-size:70%;">SA(Y)-GA(X,Y)</span></td>
<td id="S4.T1.st1.10.3.2" class="ltx_td ltx_align_center"><span id="S4.T1.st1.10.3.2.1" class="ltx_text" style="font-size:70%;">65.2</span></td>
<td id="S4.T1.st1.10.3.3" class="ltx_td ltx_align_center"><span id="S4.T1.st1.10.3.3.1" class="ltx_text" style="font-size:70%;">82.9</span></td>
<td id="S4.T1.st1.10.3.4" class="ltx_td ltx_align_center"><span id="S4.T1.st1.10.3.4.1" class="ltx_text" style="font-size:70%;">44.8</span></td>
<td id="S4.T1.st1.10.3.5" class="ltx_td ltx_align_center"><span id="S4.T1.st1.10.3.5.1" class="ltx_text" style="font-size:70%;">57.1</span></td>
</tr>
<tr id="S4.T1.st1.10.4" class="ltx_tr">
<td id="S4.T1.st1.10.4.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><span id="S4.T1.st1.10.4.1.1" class="ltx_text" style="font-size:70%;">SA(Y)-SGA(X,Y)</span></td>
<td id="S4.T1.st1.10.4.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.st1.10.4.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">65.4</span></td>
<td id="S4.T1.st1.10.4.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.st1.10.4.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">83.2</span></td>
<td id="S4.T1.st1.10.4.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.st1.10.4.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">44.9</span></td>
<td id="S4.T1.st1.10.4.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.st1.10.4.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">57.2</span></td>
</tr>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T1.st2" class="ltx_table ltx_figure_panel">
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.st2.32.7.1" class="ltx_text" style="font-size:129%;">(b)</span> </span><span id="S4.T1.st2.12.6" class="ltx_text ltx_font_bold" style="font-size:129%;">Stacking <span id="S4.T1.st2.12.6.7" class="ltx_text ltx_font_italic">vs.</span> Encoder-decoder:<span id="S4.T1.st2.12.6.6" class="ltx_text ltx_font_medium"> Overall accuracies and model sizes (<em id="S4.T1.st2.12.6.6.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.T1.st2.12.6.6.2" class="ltx_text"></span>, number of parameters) of the MCAN<sub id="S4.T1.st2.12.6.6.3" class="ltx_sub"><span id="S4.T1.st2.12.6.6.3.1" class="ltx_text ltx_font_italic">sk</span></sub>-<math id="S4.T1.st2.8.2.2.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.T1.st2.8.2.2.m2.1b"><mi id="S4.T1.st2.8.2.2.m2.1.1" xref="S4.T1.st2.8.2.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.T1.st2.8.2.2.m2.1c"><ci id="S4.T1.st2.8.2.2.m2.1.1.cmml" xref="S4.T1.st2.8.2.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st2.8.2.2.m2.1d">L</annotation></semantics></math> models and the MCAN<sub id="S4.T1.st2.12.6.6.4" class="ltx_sub"><span id="S4.T1.st2.12.6.6.4.1" class="ltx_text ltx_font_italic">ed</span></sub>-<math id="S4.T1.st2.10.4.4.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.T1.st2.10.4.4.m4.1b"><mi id="S4.T1.st2.10.4.4.m4.1.1" xref="S4.T1.st2.10.4.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.T1.st2.10.4.4.m4.1c"><ci id="S4.T1.st2.10.4.4.m4.1.1.cmml" xref="S4.T1.st2.10.4.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st2.10.4.4.m4.1d">L</annotation></semantics></math> models, where number of layers <math id="S4.T1.st2.11.5.5.m5.4" class="ltx_Math" alttext="L\in\{2,4,6,8\}" display="inline"><semantics id="S4.T1.st2.11.5.5.m5.4b"><mrow id="S4.T1.st2.11.5.5.m5.4.5" xref="S4.T1.st2.11.5.5.m5.4.5.cmml"><mi id="S4.T1.st2.11.5.5.m5.4.5.2" xref="S4.T1.st2.11.5.5.m5.4.5.2.cmml">L</mi><mo id="S4.T1.st2.11.5.5.m5.4.5.1" xref="S4.T1.st2.11.5.5.m5.4.5.1.cmml">∈</mo><mrow id="S4.T1.st2.11.5.5.m5.4.5.3.2" xref="S4.T1.st2.11.5.5.m5.4.5.3.1.cmml"><mo stretchy="false" id="S4.T1.st2.11.5.5.m5.4.5.3.2.1" xref="S4.T1.st2.11.5.5.m5.4.5.3.1.cmml">{</mo><mn id="S4.T1.st2.11.5.5.m5.1.1" xref="S4.T1.st2.11.5.5.m5.1.1.cmml">2</mn><mo id="S4.T1.st2.11.5.5.m5.4.5.3.2.2" xref="S4.T1.st2.11.5.5.m5.4.5.3.1.cmml">,</mo><mn id="S4.T1.st2.11.5.5.m5.2.2" xref="S4.T1.st2.11.5.5.m5.2.2.cmml">4</mn><mo id="S4.T1.st2.11.5.5.m5.4.5.3.2.3" xref="S4.T1.st2.11.5.5.m5.4.5.3.1.cmml">,</mo><mn id="S4.T1.st2.11.5.5.m5.3.3" xref="S4.T1.st2.11.5.5.m5.3.3.cmml">6</mn><mo id="S4.T1.st2.11.5.5.m5.4.5.3.2.4" xref="S4.T1.st2.11.5.5.m5.4.5.3.1.cmml">,</mo><mn id="S4.T1.st2.11.5.5.m5.4.4" xref="S4.T1.st2.11.5.5.m5.4.4.cmml">8</mn><mo stretchy="false" id="S4.T1.st2.11.5.5.m5.4.5.3.2.5" xref="S4.T1.st2.11.5.5.m5.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.st2.11.5.5.m5.4c"><apply id="S4.T1.st2.11.5.5.m5.4.5.cmml" xref="S4.T1.st2.11.5.5.m5.4.5"><in id="S4.T1.st2.11.5.5.m5.4.5.1.cmml" xref="S4.T1.st2.11.5.5.m5.4.5.1"></in><ci id="S4.T1.st2.11.5.5.m5.4.5.2.cmml" xref="S4.T1.st2.11.5.5.m5.4.5.2">𝐿</ci><set id="S4.T1.st2.11.5.5.m5.4.5.3.1.cmml" xref="S4.T1.st2.11.5.5.m5.4.5.3.2"><cn type="integer" id="S4.T1.st2.11.5.5.m5.1.1.cmml" xref="S4.T1.st2.11.5.5.m5.1.1">2</cn><cn type="integer" id="S4.T1.st2.11.5.5.m5.2.2.cmml" xref="S4.T1.st2.11.5.5.m5.2.2">4</cn><cn type="integer" id="S4.T1.st2.11.5.5.m5.3.3.cmml" xref="S4.T1.st2.11.5.5.m5.3.3">6</cn><cn type="integer" id="S4.T1.st2.11.5.5.m5.4.4.cmml" xref="S4.T1.st2.11.5.5.m5.4.4">8</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st2.11.5.5.m5.4d">L\in\{2,4,6,8\}</annotation></semantics></math>. With the same <math id="S4.T1.st2.12.6.6.m6.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.T1.st2.12.6.6.m6.1b"><mi id="S4.T1.st2.12.6.6.m6.1.1" xref="S4.T1.st2.12.6.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.T1.st2.12.6.6.m6.1c"><ci id="S4.T1.st2.12.6.6.m6.1.1.cmml" xref="S4.T1.st2.12.6.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st2.12.6.6.m6.1d">L</annotation></semantics></math>, the sizes of the two models are equal.</span></span></figcaption>
<table id="S4.T1.st2.15" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.st2.15.3" class="ltx_tr">
<td id="S4.T1.st2.13.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><math id="S4.T1.st2.13.1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.T1.st2.13.1.1.m1.1a"><mi mathsize="70%" id="S4.T1.st2.13.1.1.m1.1.1" xref="S4.T1.st2.13.1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.T1.st2.13.1.1.m1.1b"><ci id="S4.T1.st2.13.1.1.m1.1.1.cmml" xref="S4.T1.st2.13.1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st2.13.1.1.m1.1c">L</annotation></semantics></math></td>
<td id="S4.T1.st2.14.2.2" class="ltx_td ltx_align_center ltx_border_tt">
<span id="S4.T1.st2.14.2.2.1" class="ltx_text" style="font-size:70%;">MCAN</span><sub id="S4.T1.st2.14.2.2.2" class="ltx_sub"><span id="S4.T1.st2.14.2.2.2.1" class="ltx_text ltx_font_italic" style="font-size:70%;">sk</span></sub>
</td>
<td id="S4.T1.st2.15.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<span id="S4.T1.st2.15.3.3.1" class="ltx_text" style="font-size:70%;">MCAN</span><sub id="S4.T1.st2.15.3.3.2" class="ltx_sub"><span id="S4.T1.st2.15.3.3.2.1" class="ltx_text ltx_font_italic" style="font-size:70%;">ed</span></sub>
</td>
<td id="S4.T1.st2.15.3.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.st2.15.3.4.1" class="ltx_text" style="font-size:70%;">Size</span></td>
</tr>
<tr id="S4.T1.st2.15.4" class="ltx_tr">
<td id="S4.T1.st2.15.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T1.st2.15.4.1.1" class="ltx_text" style="font-size:70%;">2</span></td>
<td id="S4.T1.st2.15.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.st2.15.4.2.1" class="ltx_text" style="font-size:70%;">66.1</span></td>
<td id="S4.T1.st2.15.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.st2.15.4.3.1" class="ltx_text" style="font-size:70%;">66.2</span></td>
<td id="S4.T1.st2.15.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.st2.15.4.4.1" class="ltx_text" style="font-size:70%;">27M</span></td>
</tr>
<tr id="S4.T1.st2.15.5" class="ltx_tr">
<td id="S4.T1.st2.15.5.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S4.T1.st2.15.5.1.1" class="ltx_text" style="font-size:70%;">4</span></td>
<td id="S4.T1.st2.15.5.2" class="ltx_td ltx_align_center"><span id="S4.T1.st2.15.5.2.1" class="ltx_text" style="font-size:70%;">66.7</span></td>
<td id="S4.T1.st2.15.5.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.st2.15.5.3.1" class="ltx_text" style="font-size:70%;">66.9</span></td>
<td id="S4.T1.st2.15.5.4" class="ltx_td ltx_align_center"><span id="S4.T1.st2.15.5.4.1" class="ltx_text" style="font-size:70%;">41M</span></td>
</tr>
<tr id="S4.T1.st2.15.6" class="ltx_tr">
<td id="S4.T1.st2.15.6.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S4.T1.st2.15.6.1.1" class="ltx_text" style="font-size:70%;">6</span></td>
<td id="S4.T1.st2.15.6.2" class="ltx_td ltx_align_center"><span id="S4.T1.st2.15.6.2.1" class="ltx_text" style="font-size:70%;">66.8</span></td>
<td id="S4.T1.st2.15.6.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.st2.15.6.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">67.2</span></td>
<td id="S4.T1.st2.15.6.4" class="ltx_td ltx_align_center"><span id="S4.T1.st2.15.6.4.1" class="ltx_text" style="font-size:70%;">56M</span></td>
</tr>
<tr id="S4.T1.st2.15.7" class="ltx_tr">
<td id="S4.T1.st2.15.7.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><span id="S4.T1.st2.15.7.1.1" class="ltx_text" style="font-size:70%;">8</span></td>
<td id="S4.T1.st2.15.7.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.st2.15.7.2.1" class="ltx_text" style="font-size:70%;">66.8</span></td>
<td id="S4.T1.st2.15.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T1.st2.15.7.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">67.2</span></td>
<td id="S4.T1.st2.15.7.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.st2.15.7.4.1" class="ltx_text" style="font-size:70%;">68M</span></td>
</tr>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T1.st3" class="ltx_table ltx_figure_panel">
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.st3.32.6.1" class="ltx_text" style="font-size:129%;">(c)</span> </span><span id="S4.T1.st3.10.5" class="ltx_text ltx_font_bold" style="font-size:129%;">Question Representations:<span id="S4.T1.st3.10.5.5" class="ltx_text ltx_font_medium"> Accuracies of the MCAN<sub id="S4.T1.st3.10.5.5.1" class="ltx_sub"><span id="S4.T1.st3.10.5.5.1.1" class="ltx_text ltx_font_italic">ed</span></sub>-6 model with different question representations. Rand<sub id="S4.T1.st3.10.5.5.2" class="ltx_sub"><span id="S4.T1.st3.10.5.5.2.1" class="ltx_text ltx_font_italic">ft</span></sub> means the word embeddings are initialized randomly and then fine-tuned. PE denotes the positional encoding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. GloVe<sub id="S4.T1.st3.10.5.5.3" class="ltx_sub"><span id="S4.T1.st3.10.5.5.3.1" class="ltx_text ltx_font_italic">pt+ft</span></sub> and GloVe<sub id="S4.T1.st3.10.5.5.4" class="ltx_sub"><span id="S4.T1.st3.10.5.5.4.1" class="ltx_text ltx_font_italic">pt</span></sub> mean the word embeddings are pre-trained with GloVe, while GloVe<sub id="S4.T1.st3.10.5.5.5" class="ltx_sub"><span id="S4.T1.st3.10.5.5.5.1" class="ltx_text ltx_font_italic">pt+ft</span></sub> is additionally fine-tuned.</span></span></figcaption>
<table id="S4.T1.st3.14" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.st3.14.5" class="ltx_tr">
<td id="S4.T1.st3.14.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T1.st3.14.5.1.1" class="ltx_text" style="font-size:70%;">Model</span></td>
<td id="S4.T1.st3.14.5.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.st3.14.5.2.1" class="ltx_text" style="font-size:70%;">All</span></td>
<td id="S4.T1.st3.14.5.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.st3.14.5.3.1" class="ltx_text" style="font-size:70%;">Y/N</span></td>
<td id="S4.T1.st3.14.5.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.st3.14.5.4.1" class="ltx_text" style="font-size:70%;">Num</span></td>
<td id="S4.T1.st3.14.5.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.st3.14.5.5.1" class="ltx_text" style="font-size:70%;">Other</span></td>
</tr>
<tr id="S4.T1.st3.11.1" class="ltx_tr">
<td id="S4.T1.st3.11.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<span id="S4.T1.st3.11.1.1.1" class="ltx_text" style="font-size:70%;">Rand</span><sub id="S4.T1.st3.11.1.1.2" class="ltx_sub"><span id="S4.T1.st3.11.1.1.2.1" class="ltx_text ltx_font_italic" style="font-size:70%;">ft</span></sub><span id="S4.T1.st3.11.1.1.3" class="ltx_text" style="font-size:70%;"> + PE</span>
</td>
<td id="S4.T1.st3.11.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.st3.11.1.2.1" class="ltx_text" style="font-size:70%;">65.6</span></td>
<td id="S4.T1.st3.11.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.st3.11.1.3.1" class="ltx_text" style="font-size:70%;">83.0</span></td>
<td id="S4.T1.st3.11.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.st3.11.1.4.1" class="ltx_text" style="font-size:70%;">47.9</span></td>
<td id="S4.T1.st3.11.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.st3.11.1.5.1" class="ltx_text" style="font-size:70%;">57.1</span></td>
</tr>
<tr id="S4.T1.st3.12.2" class="ltx_tr">
<td id="S4.T1.st3.12.2.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S4.T1.st3.12.2.1.1" class="ltx_text" style="font-size:70%;">GloVe</span><sub id="S4.T1.st3.12.2.1.2" class="ltx_sub"><span id="S4.T1.st3.12.2.1.2.1" class="ltx_text ltx_font_italic" style="font-size:70%;">pt</span></sub><span id="S4.T1.st3.12.2.1.3" class="ltx_text" style="font-size:70%;"> + PE</span>
</td>
<td id="S4.T1.st3.12.2.2" class="ltx_td ltx_align_center"><span id="S4.T1.st3.12.2.2.1" class="ltx_text" style="font-size:70%;">67.0</span></td>
<td id="S4.T1.st3.12.2.3" class="ltx_td ltx_align_center"><span id="S4.T1.st3.12.2.3.1" class="ltx_text" style="font-size:70%;">84.6</span></td>
<td id="S4.T1.st3.12.2.4" class="ltx_td ltx_align_center"><span id="S4.T1.st3.12.2.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">49.4</span></td>
<td id="S4.T1.st3.12.2.5" class="ltx_td ltx_align_center"><span id="S4.T1.st3.12.2.5.1" class="ltx_text" style="font-size:70%;">58.2</span></td>
</tr>
<tr id="S4.T1.st3.13.3" class="ltx_tr">
<td id="S4.T1.st3.13.3.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S4.T1.st3.13.3.1.1" class="ltx_text" style="font-size:70%;">GloVe</span><sub id="S4.T1.st3.13.3.1.2" class="ltx_sub"><span id="S4.T1.st3.13.3.1.2.1" class="ltx_text ltx_font_italic" style="font-size:70%;">pt</span></sub><span id="S4.T1.st3.13.3.1.3" class="ltx_text" style="font-size:70%;"> + LSTM</span>
</td>
<td id="S4.T1.st3.13.3.2" class="ltx_td ltx_align_center"><span id="S4.T1.st3.13.3.2.1" class="ltx_text" style="font-size:70%;">67.1</span></td>
<td id="S4.T1.st3.13.3.3" class="ltx_td ltx_align_center"><span id="S4.T1.st3.13.3.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">84.8</span></td>
<td id="S4.T1.st3.13.3.4" class="ltx_td ltx_align_center"><span id="S4.T1.st3.13.3.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">49.4</span></td>
<td id="S4.T1.st3.13.3.5" class="ltx_td ltx_align_center"><span id="S4.T1.st3.13.3.5.1" class="ltx_text" style="font-size:70%;">58.4</span></td>
</tr>
<tr id="S4.T1.st3.14.4" class="ltx_tr">
<td id="S4.T1.st3.14.4.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r">
<span id="S4.T1.st3.14.4.1.1" class="ltx_text" style="font-size:70%;">GloVe</span><sub id="S4.T1.st3.14.4.1.2" class="ltx_sub"><span id="S4.T1.st3.14.4.1.2.1" class="ltx_text ltx_font_italic" style="font-size:70%;">pt+ft</span></sub><span id="S4.T1.st3.14.4.1.3" class="ltx_text" style="font-size:70%;"> + LSTM</span>
</td>
<td id="S4.T1.st3.14.4.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.st3.14.4.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">67.2</span></td>
<td id="S4.T1.st3.14.4.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.st3.14.4.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">84.8</span></td>
<td id="S4.T1.st3.14.4.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.st3.14.4.4.1" class="ltx_text" style="font-size:70%;">49.3</span></td>
<td id="S4.T1.st3.14.4.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.st3.14.4.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">58.6</span></td>
</tr>
</table>
</figure>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.6.1.1" class="ltx_text" style="font-size:129%;">Table 1</span>: </span><span id="S4.T1.7.2" class="ltx_text" style="font-size:129%;">Ablation experiments for MCAN. All the reported results are evaluated on the <em id="S4.T1.7.2.1" class="ltx_emph ltx_font_italic">val</em> split.</span></figcaption>
</figure>
<figure id="S4.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1906.10770/assets/overall.png" id="S4.F6.sf1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="452" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F6.sf1.3.2" class="ltx_text" style="font-size:90%;">All</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1906.10770/assets/yesno.png" id="S4.F6.sf2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="452" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F6.sf2.3.2" class="ltx_text" style="font-size:90%;">Y/N</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F6.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1906.10770/assets/number.png" id="S4.F6.sf3.g1" class="ltx_graphics ltx_img_landscape" width="598" height="444" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S4.F6.sf3.3.2" class="ltx_text" style="font-size:90%;">Num</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F6.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1906.10770/assets/other.png" id="S4.F6.sf4.g1" class="ltx_graphics ltx_img_landscape" width="598" height="452" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf4.2.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="S4.F6.sf4.3.2" class="ltx_text" style="font-size:90%;">Other</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.10.4.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S4.F6.6.3" class="ltx_text" style="font-size:90%;">The overall and per-type accuracies of the MCAN<sub id="S4.F6.6.3.1" class="ltx_sub"><span id="S4.F6.6.3.1.1" class="ltx_text ltx_font_italic">ed</span></sub>-<math id="S4.F6.5.2.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.F6.5.2.m2.1b"><mi id="S4.F6.5.2.m2.1.1" xref="S4.F6.5.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.F6.5.2.m2.1c"><ci id="S4.F6.5.2.m2.1.1.cmml" xref="S4.F6.5.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.5.2.m2.1d">L</annotation></semantics></math> models equipped with different MCA variants, where the number of layers <math id="S4.F6.6.3.m3.4" class="ltx_Math" alttext="L\in\{1,2,4,6\}" display="inline"><semantics id="S4.F6.6.3.m3.4b"><mrow id="S4.F6.6.3.m3.4.5" xref="S4.F6.6.3.m3.4.5.cmml"><mi id="S4.F6.6.3.m3.4.5.2" xref="S4.F6.6.3.m3.4.5.2.cmml">L</mi><mo id="S4.F6.6.3.m3.4.5.1" xref="S4.F6.6.3.m3.4.5.1.cmml">∈</mo><mrow id="S4.F6.6.3.m3.4.5.3.2" xref="S4.F6.6.3.m3.4.5.3.1.cmml"><mo stretchy="false" id="S4.F6.6.3.m3.4.5.3.2.1" xref="S4.F6.6.3.m3.4.5.3.1.cmml">{</mo><mn id="S4.F6.6.3.m3.1.1" xref="S4.F6.6.3.m3.1.1.cmml">1</mn><mo id="S4.F6.6.3.m3.4.5.3.2.2" xref="S4.F6.6.3.m3.4.5.3.1.cmml">,</mo><mn id="S4.F6.6.3.m3.2.2" xref="S4.F6.6.3.m3.2.2.cmml">2</mn><mo id="S4.F6.6.3.m3.4.5.3.2.3" xref="S4.F6.6.3.m3.4.5.3.1.cmml">,</mo><mn id="S4.F6.6.3.m3.3.3" xref="S4.F6.6.3.m3.3.3.cmml">4</mn><mo id="S4.F6.6.3.m3.4.5.3.2.4" xref="S4.F6.6.3.m3.4.5.3.1.cmml">,</mo><mn id="S4.F6.6.3.m3.4.4" xref="S4.F6.6.3.m3.4.4.cmml">6</mn><mo stretchy="false" id="S4.F6.6.3.m3.4.5.3.2.5" xref="S4.F6.6.3.m3.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.6.3.m3.4c"><apply id="S4.F6.6.3.m3.4.5.cmml" xref="S4.F6.6.3.m3.4.5"><in id="S4.F6.6.3.m3.4.5.1.cmml" xref="S4.F6.6.3.m3.4.5.1"></in><ci id="S4.F6.6.3.m3.4.5.2.cmml" xref="S4.F6.6.3.m3.4.5.2">𝐿</ci><set id="S4.F6.6.3.m3.4.5.3.1.cmml" xref="S4.F6.6.3.m3.4.5.3.2"><cn type="integer" id="S4.F6.6.3.m3.1.1.cmml" xref="S4.F6.6.3.m3.1.1">1</cn><cn type="integer" id="S4.F6.6.3.m3.2.2.cmml" xref="S4.F6.6.3.m3.2.2">2</cn><cn type="integer" id="S4.F6.6.3.m3.3.3.cmml" xref="S4.F6.6.3.m3.3.3">4</cn><cn type="integer" id="S4.F6.6.3.m3.4.4.cmml" xref="S4.F6.6.3.m3.4.4">6</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.6.3.m3.4d">L\in\{1,2,4,6\}</annotation></semantics></math>. All the reported results are evaluated on the <em id="S4.F6.6.3.2" class="ltx_emph ltx_font_italic">val</em> split.</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we conduct experiments to evaluate the performance of our MCAN models on the largest VQA benchmark dataset, VQA-v2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Since the different MCA variants and deep co-attention models may influence final performance, we perform extensive quantitative and qualitative ablation studies to explore the reasons why MCAN performs well. Finally, with the optimal hyper-parameters, we compare our best model with current state-of-the-art models under the same settings.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Datasets</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p"><span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">VQA-v2</span> is the most commonly used VQA benchmark dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. It contains human-annotated question-answer pairs relating to the images from the MS-COCO dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, with 3 questions per image and 10 answers per question. The dataset is split into three: <em id="S5.SS1.p1.1.2" class="ltx_emph ltx_font_italic">train</em> (80k images and 444k QA pairs); <em id="S5.SS1.p1.1.3" class="ltx_emph ltx_font_italic">val</em> (40k images and 214k QA pairs); and <em id="S5.SS1.p1.1.4" class="ltx_emph ltx_font_italic">test</em> (80k images and 448k QA pairs). Additionally, there are two test subsets called <em id="S5.SS1.p1.1.5" class="ltx_emph ltx_font_italic">test-dev</em> and <em id="S5.SS1.p1.1.6" class="ltx_emph ltx_font_italic">test-standard</em> to evaluate model performance online. The results consist of three per-type accuracies (<em id="S5.SS1.p1.1.7" class="ltx_emph ltx_font_italic">Yes/No</em>, <em id="S5.SS1.p1.1.8" class="ltx_emph ltx_font_italic">Number</em>, and <em id="S5.SS1.p1.1.9" class="ltx_emph ltx_font_italic">Other</em>) and an overall accuracy.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Implementation Details</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.8" class="ltx_p">The hyper-parameters of our model used in the experiments are as follows. The dimensionality of input image features <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="d_{x}" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><msub id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.p1.1.m1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.2.cmml">d</mi><mi id="S5.SS2.p1.1.m1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.2">𝑑</ci><ci id="S5.SS2.p1.1.m1.1.1.3.cmml" xref="S5.SS2.p1.1.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">d_{x}</annotation></semantics></math>, input question features <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="d_{y}" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><msub id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mi id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml">d</mi><mi id="S5.SS2.p1.2.m2.1.1.3" xref="S5.SS2.p1.2.m2.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2">𝑑</ci><ci id="S5.SS2.p1.2.m2.1.1.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">d_{y}</annotation></semantics></math>, and fused multimodal features <math id="S5.SS2.p1.3.m3.1" class="ltx_Math" alttext="d_{z}" display="inline"><semantics id="S5.SS2.p1.3.m3.1a"><msub id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml"><mi id="S5.SS2.p1.3.m3.1.1.2" xref="S5.SS2.p1.3.m3.1.1.2.cmml">d</mi><mi id="S5.SS2.p1.3.m3.1.1.3" xref="S5.SS2.p1.3.m3.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><apply id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.3.m3.1.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS2.p1.3.m3.1.1.2.cmml" xref="S5.SS2.p1.3.m3.1.1.2">𝑑</ci><ci id="S5.SS2.p1.3.m3.1.1.3.cmml" xref="S5.SS2.p1.3.m3.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">d_{z}</annotation></semantics></math> are 2,048, 512, and 1,024, respectively. Following the suggestions in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, the latent dimensionality <math id="S5.SS2.p1.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S5.SS2.p1.4.m4.1a"><mi id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><ci id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">d</annotation></semantics></math> in the multi-head attention is 512, the number of heads <math id="S5.SS2.p1.5.m5.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S5.SS2.p1.5.m5.1a"><mi id="S5.SS2.p1.5.m5.1.1" xref="S5.SS2.p1.5.m5.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m5.1b"><ci id="S5.SS2.p1.5.m5.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m5.1c">h</annotation></semantics></math> is set to 8, and the latent dimensionality for each head is <math id="S5.SS2.p1.6.m6.1" class="ltx_Math" alttext="d_{h}=d/h=64" display="inline"><semantics id="S5.SS2.p1.6.m6.1a"><mrow id="S5.SS2.p1.6.m6.1.1" xref="S5.SS2.p1.6.m6.1.1.cmml"><msub id="S5.SS2.p1.6.m6.1.1.2" xref="S5.SS2.p1.6.m6.1.1.2.cmml"><mi id="S5.SS2.p1.6.m6.1.1.2.2" xref="S5.SS2.p1.6.m6.1.1.2.2.cmml">d</mi><mi id="S5.SS2.p1.6.m6.1.1.2.3" xref="S5.SS2.p1.6.m6.1.1.2.3.cmml">h</mi></msub><mo id="S5.SS2.p1.6.m6.1.1.3" xref="S5.SS2.p1.6.m6.1.1.3.cmml">=</mo><mrow id="S5.SS2.p1.6.m6.1.1.4" xref="S5.SS2.p1.6.m6.1.1.4.cmml"><mi id="S5.SS2.p1.6.m6.1.1.4.2" xref="S5.SS2.p1.6.m6.1.1.4.2.cmml">d</mi><mo id="S5.SS2.p1.6.m6.1.1.4.1" xref="S5.SS2.p1.6.m6.1.1.4.1.cmml">/</mo><mi id="S5.SS2.p1.6.m6.1.1.4.3" xref="S5.SS2.p1.6.m6.1.1.4.3.cmml">h</mi></mrow><mo id="S5.SS2.p1.6.m6.1.1.5" xref="S5.SS2.p1.6.m6.1.1.5.cmml">=</mo><mn id="S5.SS2.p1.6.m6.1.1.6" xref="S5.SS2.p1.6.m6.1.1.6.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.6.m6.1b"><apply id="S5.SS2.p1.6.m6.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1"><and id="S5.SS2.p1.6.m6.1.1a.cmml" xref="S5.SS2.p1.6.m6.1.1"></and><apply id="S5.SS2.p1.6.m6.1.1b.cmml" xref="S5.SS2.p1.6.m6.1.1"><eq id="S5.SS2.p1.6.m6.1.1.3.cmml" xref="S5.SS2.p1.6.m6.1.1.3"></eq><apply id="S5.SS2.p1.6.m6.1.1.2.cmml" xref="S5.SS2.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p1.6.m6.1.1.2.1.cmml" xref="S5.SS2.p1.6.m6.1.1.2">subscript</csymbol><ci id="S5.SS2.p1.6.m6.1.1.2.2.cmml" xref="S5.SS2.p1.6.m6.1.1.2.2">𝑑</ci><ci id="S5.SS2.p1.6.m6.1.1.2.3.cmml" xref="S5.SS2.p1.6.m6.1.1.2.3">ℎ</ci></apply><apply id="S5.SS2.p1.6.m6.1.1.4.cmml" xref="S5.SS2.p1.6.m6.1.1.4"><divide id="S5.SS2.p1.6.m6.1.1.4.1.cmml" xref="S5.SS2.p1.6.m6.1.1.4.1"></divide><ci id="S5.SS2.p1.6.m6.1.1.4.2.cmml" xref="S5.SS2.p1.6.m6.1.1.4.2">𝑑</ci><ci id="S5.SS2.p1.6.m6.1.1.4.3.cmml" xref="S5.SS2.p1.6.m6.1.1.4.3">ℎ</ci></apply></apply><apply id="S5.SS2.p1.6.m6.1.1c.cmml" xref="S5.SS2.p1.6.m6.1.1"><eq id="S5.SS2.p1.6.m6.1.1.5.cmml" xref="S5.SS2.p1.6.m6.1.1.5"></eq><share href="#S5.SS2.p1.6.m6.1.1.4.cmml" id="S5.SS2.p1.6.m6.1.1d.cmml" xref="S5.SS2.p1.6.m6.1.1"></share><cn type="integer" id="S5.SS2.p1.6.m6.1.1.6.cmml" xref="S5.SS2.p1.6.m6.1.1.6">64</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.6.m6.1c">d_{h}=d/h=64</annotation></semantics></math>. The size of the answer vocabulary is set to <math id="S5.SS2.p1.7.m7.2" class="ltx_Math" alttext="N=3,129" display="inline"><semantics id="S5.SS2.p1.7.m7.2a"><mrow id="S5.SS2.p1.7.m7.2.3" xref="S5.SS2.p1.7.m7.2.3.cmml"><mi id="S5.SS2.p1.7.m7.2.3.2" xref="S5.SS2.p1.7.m7.2.3.2.cmml">N</mi><mo id="S5.SS2.p1.7.m7.2.3.1" xref="S5.SS2.p1.7.m7.2.3.1.cmml">=</mo><mrow id="S5.SS2.p1.7.m7.2.3.3.2" xref="S5.SS2.p1.7.m7.2.3.3.1.cmml"><mn id="S5.SS2.p1.7.m7.1.1" xref="S5.SS2.p1.7.m7.1.1.cmml">3</mn><mo id="S5.SS2.p1.7.m7.2.3.3.2.1" xref="S5.SS2.p1.7.m7.2.3.3.1.cmml">,</mo><mn id="S5.SS2.p1.7.m7.2.2" xref="S5.SS2.p1.7.m7.2.2.cmml">129</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.7.m7.2b"><apply id="S5.SS2.p1.7.m7.2.3.cmml" xref="S5.SS2.p1.7.m7.2.3"><eq id="S5.SS2.p1.7.m7.2.3.1.cmml" xref="S5.SS2.p1.7.m7.2.3.1"></eq><ci id="S5.SS2.p1.7.m7.2.3.2.cmml" xref="S5.SS2.p1.7.m7.2.3.2">𝑁</ci><list id="S5.SS2.p1.7.m7.2.3.3.1.cmml" xref="S5.SS2.p1.7.m7.2.3.3.2"><cn type="integer" id="S5.SS2.p1.7.m7.1.1.cmml" xref="S5.SS2.p1.7.m7.1.1">3</cn><cn type="integer" id="S5.SS2.p1.7.m7.2.2.cmml" xref="S5.SS2.p1.7.m7.2.2">129</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.7.m7.2c">N=3,129</annotation></semantics></math> using the strategy in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. The number of MCA layers is <math id="S5.SS2.p1.8.m8.5" class="ltx_Math" alttext="L\in\{1,2,4,6,8\}" display="inline"><semantics id="S5.SS2.p1.8.m8.5a"><mrow id="S5.SS2.p1.8.m8.5.6" xref="S5.SS2.p1.8.m8.5.6.cmml"><mi id="S5.SS2.p1.8.m8.5.6.2" xref="S5.SS2.p1.8.m8.5.6.2.cmml">L</mi><mo id="S5.SS2.p1.8.m8.5.6.1" xref="S5.SS2.p1.8.m8.5.6.1.cmml">∈</mo><mrow id="S5.SS2.p1.8.m8.5.6.3.2" xref="S5.SS2.p1.8.m8.5.6.3.1.cmml"><mo stretchy="false" id="S5.SS2.p1.8.m8.5.6.3.2.1" xref="S5.SS2.p1.8.m8.5.6.3.1.cmml">{</mo><mn id="S5.SS2.p1.8.m8.1.1" xref="S5.SS2.p1.8.m8.1.1.cmml">1</mn><mo id="S5.SS2.p1.8.m8.5.6.3.2.2" xref="S5.SS2.p1.8.m8.5.6.3.1.cmml">,</mo><mn id="S5.SS2.p1.8.m8.2.2" xref="S5.SS2.p1.8.m8.2.2.cmml">2</mn><mo id="S5.SS2.p1.8.m8.5.6.3.2.3" xref="S5.SS2.p1.8.m8.5.6.3.1.cmml">,</mo><mn id="S5.SS2.p1.8.m8.3.3" xref="S5.SS2.p1.8.m8.3.3.cmml">4</mn><mo id="S5.SS2.p1.8.m8.5.6.3.2.4" xref="S5.SS2.p1.8.m8.5.6.3.1.cmml">,</mo><mn id="S5.SS2.p1.8.m8.4.4" xref="S5.SS2.p1.8.m8.4.4.cmml">6</mn><mo id="S5.SS2.p1.8.m8.5.6.3.2.5" xref="S5.SS2.p1.8.m8.5.6.3.1.cmml">,</mo><mn id="S5.SS2.p1.8.m8.5.5" xref="S5.SS2.p1.8.m8.5.5.cmml">8</mn><mo stretchy="false" id="S5.SS2.p1.8.m8.5.6.3.2.6" xref="S5.SS2.p1.8.m8.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.8.m8.5b"><apply id="S5.SS2.p1.8.m8.5.6.cmml" xref="S5.SS2.p1.8.m8.5.6"><in id="S5.SS2.p1.8.m8.5.6.1.cmml" xref="S5.SS2.p1.8.m8.5.6.1"></in><ci id="S5.SS2.p1.8.m8.5.6.2.cmml" xref="S5.SS2.p1.8.m8.5.6.2">𝐿</ci><set id="S5.SS2.p1.8.m8.5.6.3.1.cmml" xref="S5.SS2.p1.8.m8.5.6.3.2"><cn type="integer" id="S5.SS2.p1.8.m8.1.1.cmml" xref="S5.SS2.p1.8.m8.1.1">1</cn><cn type="integer" id="S5.SS2.p1.8.m8.2.2.cmml" xref="S5.SS2.p1.8.m8.2.2">2</cn><cn type="integer" id="S5.SS2.p1.8.m8.3.3.cmml" xref="S5.SS2.p1.8.m8.3.3">4</cn><cn type="integer" id="S5.SS2.p1.8.m8.4.4.cmml" xref="S5.SS2.p1.8.m8.4.4">6</cn><cn type="integer" id="S5.SS2.p1.8.m8.5.5.cmml" xref="S5.SS2.p1.8.m8.5.5">8</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.8.m8.5c">L\in\{1,2,4,6,8\}</annotation></semantics></math>.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.4" class="ltx_p">To train the MCAN model, we use the Adam solver <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> with <math id="S5.SS2.p2.1.m1.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S5.SS2.p2.1.m1.1a"><mrow id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml"><msub id="S5.SS2.p2.1.m1.1.1.2" xref="S5.SS2.p2.1.m1.1.1.2.cmml"><mi id="S5.SS2.p2.1.m1.1.1.2.2" xref="S5.SS2.p2.1.m1.1.1.2.2.cmml">β</mi><mn id="S5.SS2.p2.1.m1.1.1.2.3" xref="S5.SS2.p2.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS2.p2.1.m1.1.1.1" xref="S5.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.p2.1.m1.1.1.3" xref="S5.SS2.p2.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><apply id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1"><eq id="S5.SS2.p2.1.m1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1"></eq><apply id="S5.SS2.p2.1.m1.1.1.2.cmml" xref="S5.SS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p2.1.m1.1.1.2.1.cmml" xref="S5.SS2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS2.p2.1.m1.1.1.2.2.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2">𝛽</ci><cn type="integer" id="S5.SS2.p2.1.m1.1.1.2.3.cmml" xref="S5.SS2.p2.1.m1.1.1.2.3">1</cn></apply><cn type="float" id="S5.SS2.p2.1.m1.1.1.3.cmml" xref="S5.SS2.p2.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">\beta_{1}=0.9</annotation></semantics></math> and <math id="S5.SS2.p2.2.m2.1" class="ltx_Math" alttext="\beta_{2}=0.98" display="inline"><semantics id="S5.SS2.p2.2.m2.1a"><mrow id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml"><msub id="S5.SS2.p2.2.m2.1.1.2" xref="S5.SS2.p2.2.m2.1.1.2.cmml"><mi id="S5.SS2.p2.2.m2.1.1.2.2" xref="S5.SS2.p2.2.m2.1.1.2.2.cmml">β</mi><mn id="S5.SS2.p2.2.m2.1.1.2.3" xref="S5.SS2.p2.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S5.SS2.p2.2.m2.1.1.1" xref="S5.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.p2.2.m2.1.1.3" xref="S5.SS2.p2.2.m2.1.1.3.cmml">0.98</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><apply id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1"><eq id="S5.SS2.p2.2.m2.1.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1.1"></eq><apply id="S5.SS2.p2.2.m2.1.1.2.cmml" xref="S5.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p2.2.m2.1.1.2.1.cmml" xref="S5.SS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS2.p2.2.m2.1.1.2.2.cmml" xref="S5.SS2.p2.2.m2.1.1.2.2">𝛽</ci><cn type="integer" id="S5.SS2.p2.2.m2.1.1.2.3.cmml" xref="S5.SS2.p2.2.m2.1.1.2.3">2</cn></apply><cn type="float" id="S5.SS2.p2.2.m2.1.1.3.cmml" xref="S5.SS2.p2.2.m2.1.1.3">0.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">\beta_{2}=0.98</annotation></semantics></math>. The base learning rate is set to <math id="S5.SS2.p2.3.m3.2" class="ltx_Math" alttext="\mathrm{min}(2.5te^{-5},1e^{-4})" display="inline"><semantics id="S5.SS2.p2.3.m3.2a"><mrow id="S5.SS2.p2.3.m3.2.2" xref="S5.SS2.p2.3.m3.2.2.cmml"><mi id="S5.SS2.p2.3.m3.2.2.4" xref="S5.SS2.p2.3.m3.2.2.4.cmml">min</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p2.3.m3.2.2.3" xref="S5.SS2.p2.3.m3.2.2.3.cmml">​</mo><mrow id="S5.SS2.p2.3.m3.2.2.2.2" xref="S5.SS2.p2.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S5.SS2.p2.3.m3.2.2.2.2.3" xref="S5.SS2.p2.3.m3.2.2.2.3.cmml">(</mo><mrow id="S5.SS2.p2.3.m3.1.1.1.1.1" xref="S5.SS2.p2.3.m3.1.1.1.1.1.cmml"><mn id="S5.SS2.p2.3.m3.1.1.1.1.1.2" xref="S5.SS2.p2.3.m3.1.1.1.1.1.2.cmml">2.5</mn><mo lspace="0em" rspace="0em" id="S5.SS2.p2.3.m3.1.1.1.1.1.1" xref="S5.SS2.p2.3.m3.1.1.1.1.1.1.cmml">​</mo><mi id="S5.SS2.p2.3.m3.1.1.1.1.1.3" xref="S5.SS2.p2.3.m3.1.1.1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p2.3.m3.1.1.1.1.1.1a" xref="S5.SS2.p2.3.m3.1.1.1.1.1.1.cmml">​</mo><msup id="S5.SS2.p2.3.m3.1.1.1.1.1.4" xref="S5.SS2.p2.3.m3.1.1.1.1.1.4.cmml"><mi id="S5.SS2.p2.3.m3.1.1.1.1.1.4.2" xref="S5.SS2.p2.3.m3.1.1.1.1.1.4.2.cmml">e</mi><mrow id="S5.SS2.p2.3.m3.1.1.1.1.1.4.3" xref="S5.SS2.p2.3.m3.1.1.1.1.1.4.3.cmml"><mo id="S5.SS2.p2.3.m3.1.1.1.1.1.4.3a" xref="S5.SS2.p2.3.m3.1.1.1.1.1.4.3.cmml">−</mo><mn id="S5.SS2.p2.3.m3.1.1.1.1.1.4.3.2" xref="S5.SS2.p2.3.m3.1.1.1.1.1.4.3.2.cmml">5</mn></mrow></msup></mrow><mo id="S5.SS2.p2.3.m3.2.2.2.2.4" xref="S5.SS2.p2.3.m3.2.2.2.3.cmml">,</mo><mrow id="S5.SS2.p2.3.m3.2.2.2.2.2" xref="S5.SS2.p2.3.m3.2.2.2.2.2.cmml"><mn id="S5.SS2.p2.3.m3.2.2.2.2.2.2" xref="S5.SS2.p2.3.m3.2.2.2.2.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.SS2.p2.3.m3.2.2.2.2.2.1" xref="S5.SS2.p2.3.m3.2.2.2.2.2.1.cmml">​</mo><msup id="S5.SS2.p2.3.m3.2.2.2.2.2.3" xref="S5.SS2.p2.3.m3.2.2.2.2.2.3.cmml"><mi id="S5.SS2.p2.3.m3.2.2.2.2.2.3.2" xref="S5.SS2.p2.3.m3.2.2.2.2.2.3.2.cmml">e</mi><mrow id="S5.SS2.p2.3.m3.2.2.2.2.2.3.3" xref="S5.SS2.p2.3.m3.2.2.2.2.2.3.3.cmml"><mo id="S5.SS2.p2.3.m3.2.2.2.2.2.3.3a" xref="S5.SS2.p2.3.m3.2.2.2.2.2.3.3.cmml">−</mo><mn id="S5.SS2.p2.3.m3.2.2.2.2.2.3.3.2" xref="S5.SS2.p2.3.m3.2.2.2.2.2.3.3.2.cmml">4</mn></mrow></msup></mrow><mo stretchy="false" id="S5.SS2.p2.3.m3.2.2.2.2.5" xref="S5.SS2.p2.3.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.2b"><apply id="S5.SS2.p2.3.m3.2.2.cmml" xref="S5.SS2.p2.3.m3.2.2"><times id="S5.SS2.p2.3.m3.2.2.3.cmml" xref="S5.SS2.p2.3.m3.2.2.3"></times><ci id="S5.SS2.p2.3.m3.2.2.4.cmml" xref="S5.SS2.p2.3.m3.2.2.4">min</ci><interval closure="open" id="S5.SS2.p2.3.m3.2.2.2.3.cmml" xref="S5.SS2.p2.3.m3.2.2.2.2"><apply id="S5.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1.1.1.1"><times id="S5.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1.1.1.1.1"></times><cn type="float" id="S5.SS2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S5.SS2.p2.3.m3.1.1.1.1.1.2">2.5</cn><ci id="S5.SS2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S5.SS2.p2.3.m3.1.1.1.1.1.3">𝑡</ci><apply id="S5.SS2.p2.3.m3.1.1.1.1.1.4.cmml" xref="S5.SS2.p2.3.m3.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S5.SS2.p2.3.m3.1.1.1.1.1.4.1.cmml" xref="S5.SS2.p2.3.m3.1.1.1.1.1.4">superscript</csymbol><ci id="S5.SS2.p2.3.m3.1.1.1.1.1.4.2.cmml" xref="S5.SS2.p2.3.m3.1.1.1.1.1.4.2">𝑒</ci><apply id="S5.SS2.p2.3.m3.1.1.1.1.1.4.3.cmml" xref="S5.SS2.p2.3.m3.1.1.1.1.1.4.3"><minus id="S5.SS2.p2.3.m3.1.1.1.1.1.4.3.1.cmml" xref="S5.SS2.p2.3.m3.1.1.1.1.1.4.3"></minus><cn type="integer" id="S5.SS2.p2.3.m3.1.1.1.1.1.4.3.2.cmml" xref="S5.SS2.p2.3.m3.1.1.1.1.1.4.3.2">5</cn></apply></apply></apply><apply id="S5.SS2.p2.3.m3.2.2.2.2.2.cmml" xref="S5.SS2.p2.3.m3.2.2.2.2.2"><times id="S5.SS2.p2.3.m3.2.2.2.2.2.1.cmml" xref="S5.SS2.p2.3.m3.2.2.2.2.2.1"></times><cn type="integer" id="S5.SS2.p2.3.m3.2.2.2.2.2.2.cmml" xref="S5.SS2.p2.3.m3.2.2.2.2.2.2">1</cn><apply id="S5.SS2.p2.3.m3.2.2.2.2.2.3.cmml" xref="S5.SS2.p2.3.m3.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS2.p2.3.m3.2.2.2.2.2.3.1.cmml" xref="S5.SS2.p2.3.m3.2.2.2.2.2.3">superscript</csymbol><ci id="S5.SS2.p2.3.m3.2.2.2.2.2.3.2.cmml" xref="S5.SS2.p2.3.m3.2.2.2.2.2.3.2">𝑒</ci><apply id="S5.SS2.p2.3.m3.2.2.2.2.2.3.3.cmml" xref="S5.SS2.p2.3.m3.2.2.2.2.2.3.3"><minus id="S5.SS2.p2.3.m3.2.2.2.2.2.3.3.1.cmml" xref="S5.SS2.p2.3.m3.2.2.2.2.2.3.3"></minus><cn type="integer" id="S5.SS2.p2.3.m3.2.2.2.2.2.3.3.2.cmml" xref="S5.SS2.p2.3.m3.2.2.2.2.2.3.3.2">4</cn></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.2c">\mathrm{min}(2.5te^{-5},1e^{-4})</annotation></semantics></math>, where <math id="S5.SS2.p2.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS2.p2.4.m4.1a"><mi id="S5.SS2.p2.4.m4.1.1" xref="S5.SS2.p2.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.4.m4.1b"><ci id="S5.SS2.p2.4.m4.1.1.cmml" xref="S5.SS2.p2.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.4.m4.1c">t</annotation></semantics></math> is the current epoch number starting from 1. After 10 epochs, the learning rate is decayed by 1/5 every 2 epochs. All the models are trained up to 13 epochs with the same batch size 64. For the results on the <em id="S5.SS2.p2.4.1" class="ltx_emph ltx_font_italic">val</em> split, only the <em id="S5.SS2.p2.4.2" class="ltx_emph ltx_font_italic">train</em> split is used for training. For the results on the <em id="S5.SS2.p2.4.3" class="ltx_emph ltx_font_italic">test-dev</em> or <em id="S5.SS2.p2.4.4" class="ltx_emph ltx_font_italic">test-standard</em> splits, both <em id="S5.SS2.p2.4.5" class="ltx_emph ltx_font_italic">train</em> and <em id="S5.SS2.p2.4.6" class="ltx_emph ltx_font_italic">val</em> splits are used for training, and a subset of VQA samples from Visual Genome <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> is also used as the augmented dataset to facilitate training.</p>
</div>
<figure id="S5.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F7.1" class="ltx_figure ltx_figure_panel"><img src="/html/1906.10770/assets/x9.png" id="S5.F7.1.g1" class="ltx_graphics ltx_img_portrait" width="461" height="884" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F7.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/1906.10770/assets/x10.png" id="S5.F7.sf1.g1" class="ltx_graphics ltx_img_portrait" width="461" height="733" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.sf1.3.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F7.sf1.4.2" class="ltx_text" style="font-size:90%;">Encoder-Decoder   (<span id="S5.F7.sf1.4.2.1" class="ltx_text ltx_font_bold">P</span>: 3)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F7.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/1906.10770/assets/x11.png" id="S5.F7.sf2.g1" class="ltx_graphics ltx_img_portrait" width="461" height="646" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.sf2.3.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F7.sf2.4.2" class="ltx_text" style="font-size:90%;">Stacking   (<span id="S5.F7.sf2.4.2.1" class="ltx_text ltx_font_bold">P</span>: 3)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.15.6.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S5.F7.11.5" class="ltx_text" style="font-size:90%;">Visualizations of the learned attention maps (<math id="S5.F7.7.1.m1.1" class="ltx_Math" alttext="\mathrm{softmax}(qK/\sqrt{d})" display="inline"><semantics id="S5.F7.7.1.m1.1b"><mrow id="S5.F7.7.1.m1.1.1" xref="S5.F7.7.1.m1.1.1.cmml"><mi id="S5.F7.7.1.m1.1.1.3" xref="S5.F7.7.1.m1.1.1.3.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S5.F7.7.1.m1.1.1.2" xref="S5.F7.7.1.m1.1.1.2.cmml">​</mo><mrow id="S5.F7.7.1.m1.1.1.1.1" xref="S5.F7.7.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.F7.7.1.m1.1.1.1.1.2" xref="S5.F7.7.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.F7.7.1.m1.1.1.1.1.1" xref="S5.F7.7.1.m1.1.1.1.1.1.cmml"><mrow id="S5.F7.7.1.m1.1.1.1.1.1.2" xref="S5.F7.7.1.m1.1.1.1.1.1.2.cmml"><mi id="S5.F7.7.1.m1.1.1.1.1.1.2.2" xref="S5.F7.7.1.m1.1.1.1.1.1.2.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S5.F7.7.1.m1.1.1.1.1.1.2.1" xref="S5.F7.7.1.m1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S5.F7.7.1.m1.1.1.1.1.1.2.3" xref="S5.F7.7.1.m1.1.1.1.1.1.2.3.cmml">K</mi></mrow><mo id="S5.F7.7.1.m1.1.1.1.1.1.1" xref="S5.F7.7.1.m1.1.1.1.1.1.1.cmml">/</mo><msqrt id="S5.F7.7.1.m1.1.1.1.1.1.3" xref="S5.F7.7.1.m1.1.1.1.1.1.3.cmml"><mi id="S5.F7.7.1.m1.1.1.1.1.1.3.2" xref="S5.F7.7.1.m1.1.1.1.1.1.3.2.cmml">d</mi></msqrt></mrow><mo stretchy="false" id="S5.F7.7.1.m1.1.1.1.1.3" xref="S5.F7.7.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.7.1.m1.1c"><apply id="S5.F7.7.1.m1.1.1.cmml" xref="S5.F7.7.1.m1.1.1"><times id="S5.F7.7.1.m1.1.1.2.cmml" xref="S5.F7.7.1.m1.1.1.2"></times><ci id="S5.F7.7.1.m1.1.1.3.cmml" xref="S5.F7.7.1.m1.1.1.3">softmax</ci><apply id="S5.F7.7.1.m1.1.1.1.1.1.cmml" xref="S5.F7.7.1.m1.1.1.1.1"><divide id="S5.F7.7.1.m1.1.1.1.1.1.1.cmml" xref="S5.F7.7.1.m1.1.1.1.1.1.1"></divide><apply id="S5.F7.7.1.m1.1.1.1.1.1.2.cmml" xref="S5.F7.7.1.m1.1.1.1.1.1.2"><times id="S5.F7.7.1.m1.1.1.1.1.1.2.1.cmml" xref="S5.F7.7.1.m1.1.1.1.1.1.2.1"></times><ci id="S5.F7.7.1.m1.1.1.1.1.1.2.2.cmml" xref="S5.F7.7.1.m1.1.1.1.1.1.2.2">𝑞</ci><ci id="S5.F7.7.1.m1.1.1.1.1.1.2.3.cmml" xref="S5.F7.7.1.m1.1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S5.F7.7.1.m1.1.1.1.1.1.3.cmml" xref="S5.F7.7.1.m1.1.1.1.1.1.3"><root id="S5.F7.7.1.m1.1.1.1.1.1.3a.cmml" xref="S5.F7.7.1.m1.1.1.1.1.1.3"></root><ci id="S5.F7.7.1.m1.1.1.1.1.1.3.2.cmml" xref="S5.F7.7.1.m1.1.1.1.1.1.3.2">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.7.1.m1.1d">\mathrm{softmax}(qK/\sqrt{d})</annotation></semantics></math>) of the attention units from typical layers. SA(Y)-<math id="S5.F7.8.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S5.F7.8.2.m2.1b"><mi id="S5.F7.8.2.m2.1.1" xref="S5.F7.8.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S5.F7.8.2.m2.1c"><ci id="S5.F7.8.2.m2.1.1.cmml" xref="S5.F7.8.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.8.2.m2.1d">l</annotation></semantics></math>, SA(X)-<math id="S5.F7.9.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S5.F7.9.3.m3.1b"><mi id="S5.F7.9.3.m3.1.1" xref="S5.F7.9.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S5.F7.9.3.m3.1c"><ci id="S5.F7.9.3.m3.1.1.cmml" xref="S5.F7.9.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.9.3.m3.1d">l</annotation></semantics></math> and GA(X,Y)-<math id="S5.F7.10.4.m4.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S5.F7.10.4.m4.1b"><mi id="S5.F7.10.4.m4.1.1" xref="S5.F7.10.4.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S5.F7.10.4.m4.1c"><ci id="S5.F7.10.4.m4.1.1.cmml" xref="S5.F7.10.4.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.10.4.m4.1d">l</annotation></semantics></math> denote the question self-attention, image self-attention, and image guided-attention from the <math id="S5.F7.11.5.m5.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S5.F7.11.5.m5.1b"><mi id="S5.F7.11.5.m5.1.1" xref="S5.F7.11.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S5.F7.11.5.m5.1c"><ci id="S5.F7.11.5.m5.1.1.cmml" xref="S5.F7.11.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.11.5.m5.1d">l</annotation></semantics></math>-th layer, respectively. Q, A, P denote the question, answer and prediction respectively. The index within [0-19] shown on the axes of the attention maps corresponds to each object in the image (20 objects in total) . For better visualization effect, we highlight three objects in the image that are related to the answer (<em id="S5.F7.11.5.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.F7.11.5.2" class="ltx_text"></span>, sheep).</span></figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Ablation Studies</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.13" class="ltx_p">We run a number of ablations to investigate the reasons why MCAN is effective. The results shown in Table <a href="#S4.T1" title="Table 1 ‣ 4.3 Multimodal Fusion and Output Classifier ‣ 4 Modular Co-Attention Networks ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and Figure <a href="#S4.F6" title="Figure 6 ‣ 4.3 Multimodal Fusion and Output Classifier ‣ 4 Modular Co-Attention Networks ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> are discussed in detail below.

<br class="ltx_break"><span id="S5.SS3.p1.13.1" class="ltx_text ltx_font_bold">MCA Variants:</span> From the results in Table <a href="#S4.T1.st1" title="In Table 1 ‣ 4.3 Multimodal Fusion and Output Classifier ‣ 4 Modular Co-Attention Networks ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(a)</span></a>, we can see that SA(Y)-GA(X,Y) outperforms ID(Y)-GA(X,Y) for all answer types. This verifies that modeling self-attention for question features benefits VQA performance, which is consistent with previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. Moreover, we can see that SA(Y)-SGA(X,Y) also outperforms SA(Y)-GA(X,Y). This reveals, for the first time, that modeling self-attention for image features is meaningful. Therefore, we use SA(Y)-SGA(X,Y) as our default MCA in the following experiments unless otherwise stated.

<br class="ltx_break"><span id="S5.SS3.p1.13.2" class="ltx_text ltx_font_bold">Stacking <span id="S5.SS3.p1.13.2.1" class="ltx_text ltx_font_italic">vs.</span> Encoder-Decoder:</span> From the results in Table <a href="#S4.T1.st2" title="In Table 1 ‣ 4.3 Multimodal Fusion and Output Classifier ‣ 4 Modular Co-Attention Networks ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(b)</span></a>, we can see that with increasing <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mi id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><ci id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">L</annotation></semantics></math>, the performances of both deep co-attention models steadily improve and finally saturate at <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="L=6" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">L</mi><mo id="S5.SS3.p1.2.m2.1.1.1" xref="S5.SS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><eq id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1.1"></eq><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">𝐿</ci><cn type="integer" id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">L=6</annotation></semantics></math>. The saturation can be explained by the unstable gradients during training when <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="L&gt;6" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mrow id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml"><mi id="S5.SS3.p1.3.m3.1.1.2" xref="S5.SS3.p1.3.m3.1.1.2.cmml">L</mi><mo id="S5.SS3.p1.3.m3.1.1.1" xref="S5.SS3.p1.3.m3.1.1.1.cmml">&gt;</mo><mn id="S5.SS3.p1.3.m3.1.1.3" xref="S5.SS3.p1.3.m3.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><apply id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1"><gt id="S5.SS3.p1.3.m3.1.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1.1"></gt><ci id="S5.SS3.p1.3.m3.1.1.2.cmml" xref="S5.SS3.p1.3.m3.1.1.2">𝐿</ci><cn type="integer" id="S5.SS3.p1.3.m3.1.1.3.cmml" xref="S5.SS3.p1.3.m3.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">L&gt;6</annotation></semantics></math>, which makes the optimization difficult. Similar observations are also reported by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Furthermore, the encoder-decoder model steadily outperforms the stacking model, especially when <math id="S5.SS3.p1.4.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S5.SS3.p1.4.m4.1a"><mi id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><ci id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">L</annotation></semantics></math> is large. This is because the learned self-attention from an early SA(Y) unit is inaccurate compared to that from the last SA(Y) unit. Directly feeding it to a GA(X,Y) unit may damage the learned guided-attention for images. The visualization in <math id="S5.SS3.p1.5.m5.1" class="ltx_Math" alttext="\S" display="inline"><semantics id="S5.SS3.p1.5.m5.1a"><mi mathvariant="normal" id="S5.SS3.p1.5.m5.1.1" xref="S5.SS3.p1.5.m5.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m5.1b"><ci id="S5.SS3.p1.5.m5.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m5.1c">\S</annotation></semantics></math><a href="#S5.SS4" title="5.4 Qualitative Analysis ‣ 5 Experiments ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></a> supports this explanation. Finally, MCAN is much more parametric-efficient than other approaches, with MCAN<sub id="S5.SS3.p1.13.3" class="ltx_sub"><span id="S5.SS3.p1.13.3.1" class="ltx_text ltx_font_italic">ed</span></sub>-2 (27M) reporting a 66.2<math id="S5.SS3.p1.7.m7.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.SS3.p1.7.m7.1a"><mo id="S5.SS3.p1.7.m7.1.1" xref="S5.SS3.p1.7.m7.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.7.m7.1b"><csymbol cd="latexml" id="S5.SS3.p1.7.m7.1.1.cmml" xref="S5.SS3.p1.7.m7.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.7.m7.1c">\%</annotation></semantics></math> accuracy, BAN-4 (45M) a 65.8<math id="S5.SS3.p1.8.m8.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.SS3.p1.8.m8.1a"><mo id="S5.SS3.p1.8.m8.1.1" xref="S5.SS3.p1.8.m8.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.8.m8.1b"><csymbol cd="latexml" id="S5.SS3.p1.8.m8.1.1.cmml" xref="S5.SS3.p1.8.m8.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.8.m8.1c">\%</annotation></semantics></math> accuracy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, and MFH (116M) a 65.7<math id="S5.SS3.p1.9.m9.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.SS3.p1.9.m9.1a"><mo id="S5.SS3.p1.9.m9.1.1" xref="S5.SS3.p1.9.m9.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.9.m9.1b"><csymbol cd="latexml" id="S5.SS3.p1.9.m9.1.1.cmml" xref="S5.SS3.p1.9.m9.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.9.m9.1c">\%</annotation></semantics></math> accuracy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. More in-depth comparisons can be found in the supplementary material.

<br class="ltx_break"><span id="S5.SS3.p1.13.4" class="ltx_text ltx_font_bold">MCA <span id="S5.SS3.p1.13.4.1" class="ltx_text ltx_font_italic">vs.</span> Depth:</span> In Figure <a href="#S4.F6" title="Figure 6 ‣ 4.3 Multimodal Fusion and Output Classifier ‣ 4 Modular Co-Attention Networks ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we show the detailed performance of MCAN<sub id="S5.SS3.p1.13.5" class="ltx_sub"><span id="S5.SS3.p1.13.5.1" class="ltx_text ltx_font_italic">ed</span></sub>-<math id="S5.SS3.p1.11.m11.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S5.SS3.p1.11.m11.1a"><mi id="S5.SS3.p1.11.m11.1.1" xref="S5.SS3.p1.11.m11.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.11.m11.1b"><ci id="S5.SS3.p1.11.m11.1.1.cmml" xref="S5.SS3.p1.11.m11.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.11.m11.1c">L</annotation></semantics></math> with different MCA variants. With increasing <math id="S5.SS3.p1.12.m12.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S5.SS3.p1.12.m12.1a"><mi id="S5.SS3.p1.12.m12.1.1" xref="S5.SS3.p1.12.m12.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.12.m12.1b"><ci id="S5.SS3.p1.12.m12.1.1.cmml" xref="S5.SS3.p1.12.m12.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.12.m12.1c">L</annotation></semantics></math>, the performance gaps between the three variants increases. Furthermore, an interesting phenomenon occurs in Figure <a href="#S4.F6.sf3" title="In Figure 6 ‣ 4.3 Multimodal Fusion and Output Classifier ‣ 4 Modular Co-Attention Networks ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6(c)</span></a>. When <math id="S5.SS3.p1.13.m13.1" class="ltx_Math" alttext="L=6" display="inline"><semantics id="S5.SS3.p1.13.m13.1a"><mrow id="S5.SS3.p1.13.m13.1.1" xref="S5.SS3.p1.13.m13.1.1.cmml"><mi id="S5.SS3.p1.13.m13.1.1.2" xref="S5.SS3.p1.13.m13.1.1.2.cmml">L</mi><mo id="S5.SS3.p1.13.m13.1.1.1" xref="S5.SS3.p1.13.m13.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.13.m13.1.1.3" xref="S5.SS3.p1.13.m13.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.13.m13.1b"><apply id="S5.SS3.p1.13.m13.1.1.cmml" xref="S5.SS3.p1.13.m13.1.1"><eq id="S5.SS3.p1.13.m13.1.1.1.cmml" xref="S5.SS3.p1.13.m13.1.1.1"></eq><ci id="S5.SS3.p1.13.m13.1.1.2.cmml" xref="S5.SS3.p1.13.m13.1.1.2">𝐿</ci><cn type="integer" id="S5.SS3.p1.13.m13.1.1.3.cmml" xref="S5.SS3.p1.13.m13.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.13.m13.1c">L=6</annotation></semantics></math>, the <em id="S5.SS3.p1.13.6" class="ltx_emph ltx_font_italic">number</em> type accuracy of the ID(Y)-GA(X,Y) and SA(Y)-GA(X,Y) models are nearly identical, while the SA(Y)-SGA(X,Y) model reports a 4.5-point improvement over them. This verifies that self-attention for images plays a key role in object counting.

<br class="ltx_break"><span id="S5.SS3.p1.13.7" class="ltx_text ltx_font_bold">Question Representations:</span> Table <a href="#S4.T1.st3" title="In Table 1 ‣ 4.3 Multimodal Fusion and Output Classifier ‣ 4 Modular Co-Attention Networks ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(c)</span></a> summarizes ablation experiments on different question representations. We can see that using the word embeddings pre-trained by GloVe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> significantly outperforms that by random initialization. Other trick like fine-tuning the GloVe embeddings or replacing the position encoding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> with a LSTM network to model the temporal information can slightly improve the performance further.</p>
</div>
<figure id="S5.F8" class="ltx_figure"><img src="/html/1906.10770/assets/x12.png" id="S5.F8.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="523" height="93" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F8.3.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="S5.F8.4.2" class="ltx_text" style="font-size:90%;">Typical examples of the learned image and question attentions by Eq.(<a href="#S4.E5" title="In 4.3 Multimodal Fusion and Output Classifier ‣ 4 Modular Co-Attention Networks ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). For each example, the image, question (Q) and answer (A) are presented on the left; the learned image attention, question attention and prediction (P) are presented next to them. The brightness of regions and darkness of words represent their importance in the attention weights.</span></figcaption>
</figure>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Qualitative Analysis</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.3" class="ltx_p">In Figure <a href="#S5.F7" title="Figure 7 ‣ 5.2 Implementation Details ‣ 5 Experiments ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, we visualize the learned attentions from MCAN<sub id="S5.SS4.p1.3.1" class="ltx_sub"><span id="S5.SS4.p1.3.1.1" class="ltx_text ltx_font_italic">sk</span></sub>-6 and MCAN<sub id="S5.SS4.p1.3.2" class="ltx_sub"><span id="S5.SS4.p1.3.2.1" class="ltx_text ltx_font_italic">ed</span></sub>-6. Due to space limitations, we only show one example and visualize six attention maps from different attention units and different layers. More visualizations can be found in the supplementary material. From the results, we have the following observations.

<br class="ltx_break"><span id="S5.SS4.p1.3.3" class="ltx_text ltx_font_bold">Question Self-Attention SA(Y):</span> The attention maps of SA(Y)-1 form vertical stripes, and the words like ‘how’ and ‘see’ obtain large attention weights. This unit acts as a question type classifier. Besides, the large values in the attention maps of SA(Y)-6 occur in the column ‘sheep’. This reveals that all the attended features tend to use the feature of ‘sheep’ for reconstruction. That is to say, the keyword ‘sheep’ is identified correctly.

<br class="ltx_break"><span id="S5.SS4.p1.3.4" class="ltx_text ltx_font_bold">Image Self-Attention SA(X):</span> Values in the attention maps of SA(X)-1 are uniformly distributed, suggesting that the key objects for sheep are unclear. The large values in the attention maps of SA(X)-6 occur on the 1st, 3rd, and 11th columns, which correspond to the three sheep in the image. This explains why introducing SA(X) can greatly improve object counting performance.

<br class="ltx_break"><span id="S5.SS4.p1.3.5" class="ltx_text ltx_font_bold">Question Guided-Attention GA(X,Y):</span> The attention maps of GA(X,Y)-1 do not focus on the current objects in the image; and the attention maps of GA(X,Y)-6 tend to focus on all values in the ‘sheep’ column. This can be explained by the fact that the input features have been reconstructed by the sheep features in SA(X)-6. Moreover, the GA(X,Y) units of the stacking model contain much more noise than the encoder-decoder model. This verifies our hypothesis presented in <math id="S5.SS4.p1.3.m3.1" class="ltx_Math" alttext="\S" display="inline"><semantics id="S5.SS4.p1.3.m3.1a"><mi mathvariant="normal" id="S5.SS4.p1.3.m3.1.1" xref="S5.SS4.p1.3.m3.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.3.m3.1b"><ci id="S5.SS4.p1.3.m3.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.3.m3.1c">\S</annotation></semantics></math><a href="#S5.SS3" title="5.3 Ablation Studies ‣ 5 Experiments ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.3</span></a>.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">In Figure <a href="#S5.F8" title="Figure 8 ‣ 5.3 Ablation Studies ‣ 5 Experiments ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, we also visualize the final image and question attentions learned by Eq.(<a href="#S4.E5" title="In 4.3 Multimodal Fusion and Output Classifier ‣ 4 Modular Co-Attention Networks ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). For the correctly predicted examples, the learned question and image attentions are usually closely focus on the key words and the most relevant image regions (<em id="S5.SS4.p2.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS4.p2.1.2" class="ltx_text"></span>, the word ‘holding’ and the region of ‘hand’ in the first example, and the word ‘vegetable’ and the region of ‘broccoli’ in the second example). From the incorrect examples, we can draw some weaknesses of our approach. For example, it occasionally makes mistakes in distinguishing the key words in questions (<em id="S5.SS4.p2.1.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS4.p2.1.4" class="ltx_text"></span>, the word ‘left’ in the third example and the word ‘catcher’ in the last example). These observations are useful to guide further improvements in the future.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.18.1.1" class="ltx_text" style="font-size:113%;">Table 2</span>: </span><span id="S5.T2.19.2" class="ltx_text" style="font-size:113%;">Accuracies of <span id="S5.T2.19.2.1" class="ltx_text ltx_font_bold">single-model</span> on the <em id="S5.T2.19.2.2" class="ltx_emph ltx_font_italic">test-dev</em> and <em id="S5.T2.19.2.3" class="ltx_emph ltx_font_italic">test-standard</em> splits to compare with the state-of-the-art methods. All the methods use the same bottom-up attention visual features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, and are trained on the <em id="S5.T2.19.2.4" class="ltx_emph ltx_font_italic">train+val+vg</em> sets (<em id="S5.T2.19.2.5" class="ltx_emph ltx_font_italic">vg</em> denotes the augmented VQA samples from Visual Genome). The best results on both splits are bolded.</span></figcaption>
<table id="S5.T2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T2.1.2" class="ltx_tr">
<td id="S5.T2.1.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" rowspan="2"><span id="S5.T2.1.2.1.1" class="ltx_text" style="font-size:80%;">Model</span></td>
<td id="S5.T2.1.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="4"><span id="S5.T2.1.2.2.1" class="ltx_text" style="font-size:80%;">Test-dev</span></td>
<td id="S5.T2.1.2.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.2.3.1" class="ltx_text" style="font-size:80%;">Test-std</span></td>
</tr>
<tr id="S5.T2.1.3" class="ltx_tr">
<td id="S5.T2.1.3.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.3.1.1" class="ltx_text" style="font-size:80%;">All</span></td>
<td id="S5.T2.1.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.3.2.1" class="ltx_text" style="font-size:80%;">Y/N</span></td>
<td id="S5.T2.1.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.3.3.1" class="ltx_text" style="font-size:80%;">Num</span></td>
<td id="S5.T2.1.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.1.3.4.1" class="ltx_text" style="font-size:80%;">Other</span></td>
<td id="S5.T2.1.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.3.5.1" class="ltx_text" style="font-size:80%;">All</span></td>
</tr>
<tr id="S5.T2.1.4" class="ltx_tr">
<td id="S5.T2.1.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<span id="S5.T2.1.4.1.1" class="ltx_text" style="font-size:80%;">Bottom-Up </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.1.4.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib28" title="" class="ltx_ref">28</a><span id="S5.T2.1.4.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S5.T2.1.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.4.2.1" class="ltx_text" style="font-size:80%;">65.32</span></td>
<td id="S5.T2.1.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.4.3.1" class="ltx_text" style="font-size:80%;">81.82</span></td>
<td id="S5.T2.1.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.4.4.1" class="ltx_text" style="font-size:80%;">44.21</span></td>
<td id="S5.T2.1.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.1.4.5.1" class="ltx_text" style="font-size:80%;">56.05</span></td>
<td id="S5.T2.1.4.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.4.6.1" class="ltx_text" style="font-size:80%;">65.67</span></td>
</tr>
<tr id="S5.T2.1.5" class="ltx_tr">
<td id="S5.T2.1.5.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S5.T2.1.5.1.1" class="ltx_text" style="font-size:80%;">MFH </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.1.5.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib33" title="" class="ltx_ref">33</a><span id="S5.T2.1.5.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S5.T2.1.5.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.5.2.1" class="ltx_text" style="font-size:80%;">68.76</span></td>
<td id="S5.T2.1.5.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.5.3.1" class="ltx_text" style="font-size:80%;">84.27</span></td>
<td id="S5.T2.1.5.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.5.4.1" class="ltx_text" style="font-size:80%;">49.56</span></td>
<td id="S5.T2.1.5.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.1.5.5.1" class="ltx_text" style="font-size:80%;">59.89</span></td>
<td id="S5.T2.1.5.6" class="ltx_td ltx_align_center"><span id="S5.T2.1.5.6.1" class="ltx_text" style="font-size:80%;">-</span></td>
</tr>
<tr id="S5.T2.1.6" class="ltx_tr">
<td id="S5.T2.1.6.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S5.T2.1.6.1.1" class="ltx_text" style="font-size:80%;">BAN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.1.6.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib14" title="" class="ltx_ref">14</a><span id="S5.T2.1.6.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S5.T2.1.6.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.6.2.1" class="ltx_text" style="font-size:80%;">69.52</span></td>
<td id="S5.T2.1.6.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.6.3.1" class="ltx_text" style="font-size:80%;">85.31</span></td>
<td id="S5.T2.1.6.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.6.4.1" class="ltx_text" style="font-size:80%;">50.93</span></td>
<td id="S5.T2.1.6.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.1.6.5.1" class="ltx_text" style="font-size:80%;">60.26</span></td>
<td id="S5.T2.1.6.6" class="ltx_td ltx_align_center"><span id="S5.T2.1.6.6.1" class="ltx_text" style="font-size:80%;">-</span></td>
</tr>
<tr id="S5.T2.1.7" class="ltx_tr">
<td id="S5.T2.1.7.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S5.T2.1.7.1.1" class="ltx_text" style="font-size:80%;">BAN+Counter </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.1.7.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib14" title="" class="ltx_ref">14</a><span id="S5.T2.1.7.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S5.T2.1.7.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.7.2.1" class="ltx_text" style="font-size:80%;">70.04</span></td>
<td id="S5.T2.1.7.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.7.3.1" class="ltx_text" style="font-size:80%;">85.42</span></td>
<td id="S5.T2.1.7.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.7.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">54.04</span></td>
<td id="S5.T2.1.7.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.1.7.5.1" class="ltx_text" style="font-size:80%;">60.52</span></td>
<td id="S5.T2.1.7.6" class="ltx_td ltx_align_center"><span id="S5.T2.1.7.6.1" class="ltx_text" style="font-size:80%;">70.35</span></td>
</tr>
<tr id="S5.T2.1.1" class="ltx_tr">
<td id="S5.T2.1.1.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t">
<span id="S5.T2.1.1.1.1" class="ltx_text" style="font-size:80%;">MCAN</span><sub id="S5.T2.1.1.1.2" class="ltx_sub"><span id="S5.T2.1.1.1.2.1" class="ltx_text ltx_font_italic" style="font-size:80%;">ed</span></sub><span id="S5.T2.1.1.1.3" class="ltx_text" style="font-size:80%;">-6</span>
</td>
<td id="S5.T2.1.1.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S5.T2.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">70.63</span></td>
<td id="S5.T2.1.1.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S5.T2.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">86.82</span></td>
<td id="S5.T2.1.1.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S5.T2.1.1.4.1" class="ltx_text" style="font-size:80%;">53.26</span></td>
<td id="S5.T2.1.1.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S5.T2.1.1.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">60.72</span></td>
<td id="S5.T2.1.1.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S5.T2.1.1.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">70.90</span></td>
</tr>
</table>
</figure>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Comparison with State-of-the-Art</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.2" class="ltx_p">By taking the ablation results into account, we compare our best single model MCAN<sub id="S5.SS5.p1.2.1" class="ltx_sub"><span id="S5.SS5.p1.2.1.1" class="ltx_text ltx_font_italic">ed</span></sub>-6 with the current state-of-the-art methods in Table <a href="#A3.T3" title="Table 3 ‣ Appendix C More Visualized Results ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Using the same bottom-up attention visual features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, MCAN<sub id="S5.SS5.p1.2.2" class="ltx_sub"><span id="S5.SS5.p1.2.2.1" class="ltx_text ltx_font_italic">ed</span></sub>-6 significantly outperforms the current best approach BAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> by 1.1 points in terms of overall accuracy. Compared to BAN+Counter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, which additionally introduces the counting module <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> to significantly improve object counting performance, our model is still 0.6 points higher. Moreover, our method obtains comparable object counting performance (<em id="S5.SS5.p1.2.3" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS5.p1.2.4" class="ltx_text"></span>, the number type) to BAN+Counter, and in doing so does not use any auxiliary information like the bounding-box coordinates of each object <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. This suggests that MCAN is more general that can naturally learn to <em id="S5.SS5.p1.2.5" class="ltx_emph ltx_font_italic">deduplicate</em> the redundant objects based on the visual features alone. The comparative results with model ensembling are demonstrated in the supplementary material.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we present a novel deep Modular Co-Attention Network (MCAN) for VQA. MCAN consists of a cascade of modular co-attention (MCA) layers, each of which consists of the self-attention and guided-attention units to model the intra- and inter-modal interactions synergistically. By stacking MCA layers in depth using the encoder-decoder strategy, we obtain a deep MCAN model that achieves new state-of-the-art performance for VQA.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work was supported in part by National Natural Science Foundation
of China under Grant 61702143, Grant 61836002, Grant 61622205, and in part by the Australian Research Council Projects under Grant FL-170100117, Grant DP-180103424 and Grant IH-180100002.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Peter Anderson, Xiaodong He, Chris Buehler, Damien Teney, Mark Johnson, Stephen
Gould, and Lei Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Bottom-up and top-down attention for image captioning and visual
question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span><span id="bib.bib1.4.2" class="ltx_text" style="font-size:90%;">, pages 6077–6086, 2018.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Stanislaw Antol, Aishwarya Agrawal, Jiasen Lu, Margaret Mitchell, Dhruv Batra,
C Lawrence Zitnick, and Devi Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Vqa: Visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Computer Vision (ICCV)</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, pages
2425–2433, 2015.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Jimmy Lei Ba, Jamie Ryan Kiros, and Geoffrey E Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Layer normalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1607.06450</span><span id="bib.bib3.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Neural machine translation by jointly learning to align and
translate.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1409.0473</span><span id="bib.bib4.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Ankur Bapna, Mia Xu Chen, Orhan Firat, Yuan Cao, and Yonghui Wu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Training deeper neural machine translation models with transparent
attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1808.07561</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Hedi Ben-Younes, Rémi Cadene, Matthieu Cord, and Nicolas Thome.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Mutan: Multimodal tucker fusion for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Computer Vision (ICCV)</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, pages
2612–2620, 2017.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Kan Chen, Jiang Wang, Liang-Chieh Chen, Haoyuan Gao, Wei Xu, and Ram Nevatia.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Abc-cnn: An attention based convolutional neural network for visual
question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1511.05960</span><span id="bib.bib7.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Jan K Chorowski, Dzmitry Bahdanau, Dmitriy Serdyuk, Kyunghyun Cho, and Yoshua
Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Attention-based models for speech recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems (NIPS)</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">,
pages 577–585, 2015.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Jeffrey Donahue, Lisa Anne Hendricks, Sergio Guadarrama, Marcus Rohrbach,
Subhashini Venugopalan, Kate Saenko, and Trevor Darrell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Long-term recurrent convolutional networks for visual recognition and
description.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, pages 2625–2634, 2015.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Akira Fukui, Dong Huk Park, Daylen Yang, Anna Rohrbach, Trevor Darrell, and
Marcus Rohrbach.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Multimodal compact bilinear pooling for visual question answering and
visual grounding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1606.01847</span><span id="bib.bib10.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Yash Goyal, Tejas Khot, Douglas Summers-Stay, Dhruv Batra, and Devi Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Making the v in vqa matter: Elevating the role of image understanding
in visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span><span id="bib.bib11.4.2" class="ltx_text" style="font-size:90%;">, pages 6904–6913, 2017.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">, pages 770–778, 2016.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Sepp Hochreiter and Jürgen Schmidhuber.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Long short-term memory.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Neural computation</span><span id="bib.bib13.4.2" class="ltx_text" style="font-size:90%;">, 9(8):1735–1780, 1997.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Jin-Hwa Kim, Jaehyun Jun, and Byoung-Tak Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Bilinear attention networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems (NIPS)</span><span id="bib.bib14.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Jin-Hwa Kim, Sang-Woo Lee, Donghyun Kwak, Min-Oh Heo, Jeonghee Kim, Jung-Woo
Ha, and Byoung-Tak Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Multimodal residual learning for visual qa.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems (NIPS)</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">,
pages 361–369, 2016.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Jin-Hwa Kim, Kyoung Woon On, Woosang Lim, Jeonghee Kim, Jung-Woo Ha, and
Byoung-Tak Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Hadamard Product for Low-rank Bilinear Pooling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representation (ICLR)</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">,
2017.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Diederik P Kingma and Jimmy Ba.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Adam: A method for stochastic optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1412.6980</span><span id="bib.bib17.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson, Kenji Hata, Joshua
Kravitz, Stephanie Chen, Yannis Kalantidis, Li-Jia Li, David A Shamma, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Visual genome: Connecting language and vision using crowdsourced
dense image annotations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1602.07332</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva
Ramanan, Piotr Dollár, and C Lawrence Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Microsoft coco: Common objects in context.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European Conference on Computer Vision (ECCV)</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, pages
740–755, 2014.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Jiasen Lu, Jianwei Yang, Dhruv Batra, and Devi Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Hierarchical question-image co-attention for visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems (NIPS)</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">,
pages 289–297, 2016.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Mateusz Malinowski and Mario Fritz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">A multi-world approach to question answering about real-world scenes
based on uncertain input.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems (NIPS)</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">,
pages 1682–1690, 2014.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Volodymyr Mnih, Nicolas Heess, Alex Graves, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Recurrent models of visual attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems (NIPS)</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">,
pages 2204–2212, 2014.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Hyeonseob Nam, Jung-Woo Ha, and Jeonghee Kim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Dual attention networks for multimodal reasoning and matching.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1611.00471</span><span id="bib.bib23.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Duy-Kien Nguyen and Takayuki Okatani.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Improved fusion of visual and language representations by dense
symmetric co-attention for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span><span id="bib.bib24.4.2" class="ltx_text" style="font-size:90%;">, pages 6087–6096, 2018.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Jeffrey Pennington, Richard Socher, and Christopher D Manning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Glove: Global vectors for word representation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">EMNLP</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, pages 1532–1543, 2014.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Faster r-cnn: Towards real-time object detection with region proposal
networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems (NIPS)</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">,
pages 91–99, 2015.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Kevin J Shih, Saurabh Singh, and Derek Hoiem.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Where to look: Focus regions for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, pages 4613–4621, 2016.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Damien Teney, Peter Anderson, Xiaodong He, and Anton van den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Tips and tricks for visual question answering: Learnings from the
2017 challenge.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1708.02711</span><span id="bib.bib28.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Attention is all you need.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, pages
6000–6010, 2017.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Kelvin Xu, Jimmy Ba, Ryan Kiros, Kyunghyun Cho, Aaron C Courville, Ruslan
Salakhutdinov, Richard S Zemel, and Yoshua Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Show, attend and tell: Neural image caption generation with visual
attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning (ICML)</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">,
volume 14, pages 77–81, 2015.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Zichao Yang, Xiaodong He, Jianfeng Gao, Li Deng, and Alex Smola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Stacked attention networks for image question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, pages 21–29, 2016.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Zhou Yu, Jun Yu, Jianping Fan, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Multi-modal factorized bilinear pooling with co-attention learning
for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE International Conference on Computer Vision (ICCV)</span><span id="bib.bib32.4.2" class="ltx_text" style="font-size:90%;">, pages
1839–1848, 2017.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Zhou Yu, Jun Yu, Chenchao Xiang, Jianping Fan, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Beyond bilinear: Generalized multimodal factorized high-order pooling
for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Neural Networks and Learning Systems</span><span id="bib.bib33.4.2" class="ltx_text" style="font-size:90%;">,
29(12):5947–5959, 2018.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Zhou Yu, Jun Yu, Chenchao Xiang, Zhou Zhao, Qi Tian, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Rethinking diversified and discriminative proposal generation for
visual grounding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">International Joint Conference on Artificial Intelligence
(IJCAI)</span><span id="bib.bib34.4.2" class="ltx_text" style="font-size:90%;">, pages 1114–1120, 2018.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Yan Zhang, Jonathon Hare, and Adam Prügel-Bennett.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Learning to count objects in natural images for visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representation (ICLR)</span><span id="bib.bib35.4.2" class="ltx_text" style="font-size:90%;">,
2018.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Zhou Zhao, Zhu Zhang, Shuwen Xiao, Zhou Yu, Jun Yu, Deng Cai, Fei Wu, and
Yueting Zhuang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Open-ended long-form video question answering via adaptive
hierarchical reinforced networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib36.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Joint Conference on Artificial Intelligence
(IJCAI)</span><span id="bib.bib36.5.3" class="ltx_text" style="font-size:90%;">, pages 3683–3689, 2018.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Bolei Zhou, Yuandong Tian, Sainbayar Sukhbaatar, Arthur Szlam, and Rob Fergus.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Simple baseline for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1512.02167</span><span id="bib.bib37.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
</ul>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Appendix</h2>

</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Model Ensembling</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">To compare MCAN to the best results on VQA-v2 leaderboard<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://visualqa.org/roe.html</span></span></span></span>, we train 4 MCAN<sub id="A1.p1.1.1" class="ltx_sub"><span id="A1.p1.1.1.1" class="ltx_text ltx_font_italic">ed</span></sub>-6 models with slightly different hyper-parameters for ensemble. The comparative results in Table <a href="#A3.T3" title="Table 3 ‣ Appendix C More Visualized Results ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> indicate that MCAN surpasses the top most solutions on the leaderboard. It is worth noting that our solution only use the basic bottom-up attention visual features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and much fewer models for ensemble.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Comparisons of Model Stability and Computational Costs</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.3" class="ltx_p">We compare MCAN<sub id="A2.p1.3.1" class="ltx_sub"><span id="A2.p1.3.1.1" class="ltx_text ltx_font_italic">ed</span></sub>-6 with the best two approaches (MFH <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and BAN-8 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>) in Table <a href="#A3.T4" title="Table 4 ‣ Appendix C More Visualized Results ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> in terms of overall accuracy <math id="A2.p1.2.m2.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A2.p1.2.m2.1a"><mo id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><csymbol cd="latexml" id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">\pm</annotation></semantics></math>std, number of parameters and FLOPs, respectively. The accuracies are reported on the <em id="A2.p1.3.2" class="ltx_emph ltx_font_italic">val</em> split, and the standard deviation for each method is calculated by training three models with the same architecture but different initializations. The FLOPs are calculated for one testing sample. We can see that MCAN<sub id="A2.p1.3.3" class="ltx_sub"><span id="A2.p1.3.3.1" class="ltx_text ltx_font_italic">ed</span></sub>-6 outperforms the counterparts in both accuracy and stability, and is more parameteric- and computational-efficient at the same time.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>More Visualized Results</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">Similar to Figure <a href="#S5.F7" title="Figure 7 ‣ 5.2 Implementation Details ‣ 5 Experiments ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> in the main text, we visualize the learned attentions of two more examples from MCAN<sub id="A3.p1.1.1" class="ltx_sub"><span id="A3.p1.1.1.1" class="ltx_text ltx_font_italic">ed</span></sub>-6 in Figure <a href="#A3.F9" title="Figure 9 ‣ Appendix C More Visualized Results ‣ Deep Modular Co-Attention Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. For each example, we visualize the attention maps from three attention units (SA(X), SA(Y), GA(X,Y)) and from two layers (1st and 6th). For each unit, we show the attention maps from 2 parallel heads (8 heads in total). From the results, we have the similar observations and explanations to those in the main text. The visualized attentions can well explain the reasoning process of MCAN to predict the correct answers. Furthermore, we find that different heads may provide complementary information to benefit VQA performance, which is similar to the ‘multi-glimpses’ strategy in existing VQA approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>.</p>
</div>
<figure id="A3.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span id="A3.T3.12.2.1" class="ltx_text" style="font-size:113%;">Table 3</span>: </span><span id="A3.T3.2.1" class="ltx_text" style="font-size:113%;">Accuracies of <span id="A3.T3.2.1.1" class="ltx_text ltx_font_bold">model ensembling</span> on the <em id="A3.T3.2.1.2" class="ltx_emph ltx_font_italic">test-standard</em> split to compare with the best solutions in VQA-Challenge 2018. <math id="A3.T3.2.1.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="A3.T3.2.1.m1.1b"><mi id="A3.T3.2.1.m1.1.1" xref="A3.T3.2.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="A3.T3.2.1.m1.1c"><ci id="A3.T3.2.1.m1.1.1.cmml" xref="A3.T3.2.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.2.1.m1.1d">R</annotation></semantics></math> denotes the rank of the corresponding team. # denotes the number of used models for ensembling.</span></figcaption>
<table id="A3.T3.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A3.T3.3.1" class="ltx_tr">
<td id="A3.T3.3.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><math id="A3.T3.3.1.1.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="A3.T3.3.1.1.m1.1a"><mi mathsize="80%" id="A3.T3.3.1.1.m1.1.1" xref="A3.T3.3.1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="A3.T3.3.1.1.m1.1b"><ci id="A3.T3.3.1.1.m1.1.1.cmml" xref="A3.T3.3.1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.3.1.1.m1.1c">R</annotation></semantics></math></td>
<td id="A3.T3.3.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="A3.T3.3.1.2.1" class="ltx_text" style="font-size:80%;">Team Name</span></td>
<td id="A3.T3.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="A3.T3.3.1.3.1" class="ltx_text" style="font-size:80%;">#</span></td>
<td id="A3.T3.3.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="A3.T3.3.1.4.1" class="ltx_text" style="font-size:80%;">All</span></td>
<td id="A3.T3.3.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="A3.T3.3.1.5.1" class="ltx_text" style="font-size:80%;">Y/N</span></td>
<td id="A3.T3.3.1.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="A3.T3.3.1.6.1" class="ltx_text" style="font-size:80%;">Num</span></td>
<td id="A3.T3.3.1.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="A3.T3.3.1.7.1" class="ltx_text" style="font-size:80%;">Other</span></td>
</tr>
<tr id="A3.T3.3.2" class="ltx_tr">
<td id="A3.T3.3.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A3.T3.3.2.1.1" class="ltx_text" style="font-size:80%;">5</span></td>
<td id="A3.T3.3.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A3.T3.3.2.2.1" class="ltx_text" style="font-size:80%;">MIL-UT</span></td>
<td id="A3.T3.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A3.T3.3.2.3.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="A3.T3.3.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="A3.T3.3.2.4.1" class="ltx_text" style="font-size:80%;">71.16</span></td>
<td id="A3.T3.3.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="A3.T3.3.2.5.1" class="ltx_text" style="font-size:80%;">87.00</span></td>
<td id="A3.T3.3.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="A3.T3.3.2.6.1" class="ltx_text" style="font-size:80%;">52.6</span></td>
<td id="A3.T3.3.2.7" class="ltx_td ltx_align_center ltx_border_t"><span id="A3.T3.3.2.7.1" class="ltx_text" style="font-size:80%;">61.62</span></td>
</tr>
<tr id="A3.T3.3.3" class="ltx_tr">
<td id="A3.T3.3.3.1" class="ltx_td ltx_align_center ltx_border_r"><span id="A3.T3.3.3.1.1" class="ltx_text" style="font-size:80%;">4</span></td>
<td id="A3.T3.3.3.2" class="ltx_td ltx_align_left ltx_border_r"><span id="A3.T3.3.3.2.1" class="ltx_text" style="font-size:80%;">CASIA-IVA</span></td>
<td id="A3.T3.3.3.3" class="ltx_td ltx_align_center ltx_border_r"><span id="A3.T3.3.3.3.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="A3.T3.3.3.4" class="ltx_td ltx_align_center"><span id="A3.T3.3.3.4.1" class="ltx_text" style="font-size:80%;">71.31</span></td>
<td id="A3.T3.3.3.5" class="ltx_td ltx_align_center"><span id="A3.T3.3.3.5.1" class="ltx_text" style="font-size:80%;">86.98</span></td>
<td id="A3.T3.3.3.6" class="ltx_td ltx_align_center"><span id="A3.T3.3.3.6.1" class="ltx_text" style="font-size:80%;">51.05</span></td>
<td id="A3.T3.3.3.7" class="ltx_td ltx_align_center"><span id="A3.T3.3.3.7.1" class="ltx_text" style="font-size:80%;">62.31</span></td>
</tr>
<tr id="A3.T3.3.4" class="ltx_tr">
<td id="A3.T3.3.4.1" class="ltx_td ltx_align_center ltx_border_r"><span id="A3.T3.3.4.1.1" class="ltx_text" style="font-size:80%;">3</span></td>
<td id="A3.T3.3.4.2" class="ltx_td ltx_align_left ltx_border_r"><span id="A3.T3.3.4.2.1" class="ltx_text" style="font-size:80%;">SNU-BI</span></td>
<td id="A3.T3.3.4.3" class="ltx_td ltx_align_center ltx_border_r"><span id="A3.T3.3.4.3.1" class="ltx_text" style="font-size:80%;">15</span></td>
<td id="A3.T3.3.4.4" class="ltx_td ltx_align_center"><span id="A3.T3.3.4.4.1" class="ltx_text" style="font-size:80%;">71.84</span></td>
<td id="A3.T3.3.4.5" class="ltx_td ltx_align_center"><span id="A3.T3.3.4.5.1" class="ltx_text" style="font-size:80%;">87.22</span></td>
<td id="A3.T3.3.4.6" class="ltx_td ltx_align_center"><span id="A3.T3.3.4.6.1" class="ltx_text" style="font-size:80%;">54.37</span></td>
<td id="A3.T3.3.4.7" class="ltx_td ltx_align_center"><span id="A3.T3.3.4.7.1" class="ltx_text" style="font-size:80%;">62.45</span></td>
</tr>
<tr id="A3.T3.3.5" class="ltx_tr">
<td id="A3.T3.3.5.1" class="ltx_td ltx_align_center ltx_border_r"><span id="A3.T3.3.5.1.1" class="ltx_text" style="font-size:80%;">2</span></td>
<td id="A3.T3.3.5.2" class="ltx_td ltx_align_left ltx_border_r"><span id="A3.T3.3.5.2.1" class="ltx_text" style="font-size:80%;">HDU-UCAS-USYD</span></td>
<td id="A3.T3.3.5.3" class="ltx_td ltx_align_center ltx_border_r"><span id="A3.T3.3.5.3.1" class="ltx_text" style="font-size:80%;">12</span></td>
<td id="A3.T3.3.5.4" class="ltx_td ltx_align_center"><span id="A3.T3.3.5.4.1" class="ltx_text" style="font-size:80%;">72.09</span></td>
<td id="A3.T3.3.5.5" class="ltx_td ltx_align_center"><span id="A3.T3.3.5.5.1" class="ltx_text" style="font-size:80%;">87.61</span></td>
<td id="A3.T3.3.5.6" class="ltx_td ltx_align_center"><span id="A3.T3.3.5.6.1" class="ltx_text" style="font-size:80%;">51.92</span></td>
<td id="A3.T3.3.5.7" class="ltx_td ltx_align_center"><span id="A3.T3.3.5.7.1" class="ltx_text" style="font-size:80%;">63.19</span></td>
</tr>
<tr id="A3.T3.3.6" class="ltx_tr">
<td id="A3.T3.3.6.1" class="ltx_td ltx_align_center ltx_border_r"><span id="A3.T3.3.6.1.1" class="ltx_text" style="font-size:80%;">1</span></td>
<td id="A3.T3.3.6.2" class="ltx_td ltx_align_left ltx_border_r"><span id="A3.T3.3.6.2.1" class="ltx_text" style="font-size:80%;">FAIR A-STAR</span></td>
<td id="A3.T3.3.6.3" class="ltx_td ltx_align_center ltx_border_r"><span id="A3.T3.3.6.3.1" class="ltx_text" style="font-size:80%;">30</span></td>
<td id="A3.T3.3.6.4" class="ltx_td ltx_align_center"><span id="A3.T3.3.6.4.1" class="ltx_text" style="font-size:80%;">72.25</span></td>
<td id="A3.T3.3.6.5" class="ltx_td ltx_align_center"><span id="A3.T3.3.6.5.1" class="ltx_text" style="font-size:80%;">87.82</span></td>
<td id="A3.T3.3.6.6" class="ltx_td ltx_align_center"><span id="A3.T3.3.6.6.1" class="ltx_text" style="font-size:80%;">51.59</span></td>
<td id="A3.T3.3.6.7" class="ltx_td ltx_align_center"><span id="A3.T3.3.6.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">63.43</span></td>
</tr>
<tr id="A3.T3.3.7" class="ltx_tr">
<td id="A3.T3.3.7.1" class="ltx_td ltx_border_bb ltx_border_r ltx_border_t"></td>
<td id="A3.T3.3.7.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t"><span id="A3.T3.3.7.2.1" class="ltx_text" style="font-size:80%;">MCAN (Ours)</span></td>
<td id="A3.T3.3.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="A3.T3.3.7.3.1" class="ltx_text" style="font-size:80%;">4</span></td>
<td id="A3.T3.3.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T3.3.7.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">72.45</span></td>
<td id="A3.T3.3.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T3.3.7.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">88.29</span></td>
<td id="A3.T3.3.7.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T3.3.7.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">54.38</span></td>
<td id="A3.T3.3.7.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T3.3.7.7.1" class="ltx_text" style="font-size:80%;">62.80</span></td>
</tr>
</table>
</figure>
<figure id="A3.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comparison of model stability and computational costs to the state-of-the-art on <em id="A3.T4.13.1" class="ltx_emph ltx_font_italic">val</em> split of VQA-v2.</figcaption>
<table id="A3.T4.7" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A3.T4.1.1" class="ltx_tr">
<td id="A3.T4.1.1.2" class="ltx_td ltx_border_r ltx_border_tt"></td>
<td id="A3.T4.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<span id="A3.T4.1.1.3.1" class="ltx_text" style="font-size:90%;">MFH </span><cite class="ltx_cite ltx_citemacro_cite"><span id="A3.T4.1.1.3.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib33" title="" class="ltx_ref">33</a><span id="A3.T4.1.1.3.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="A3.T4.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<span id="A3.T4.1.1.4.1" class="ltx_text" style="font-size:90%;">BAN-8 </span><cite class="ltx_cite ltx_citemacro_cite"><span id="A3.T4.1.1.4.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib14" title="" class="ltx_ref">14</a><span id="A3.T4.1.1.4.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="A3.T4.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">
<span id="A3.T4.1.1.1.1" class="ltx_text" style="font-size:90%;">MCAN</span><sub id="A3.T4.1.1.1.2" class="ltx_sub"><span id="A3.T4.1.1.1.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ed</span></sub><span id="A3.T4.1.1.1.3" class="ltx_text" style="font-size:90%;">-6</span>
</td>
</tr>
<tr id="A3.T4.5.5" class="ltx_tr">
<td id="A3.T4.2.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="A3.T4.2.2.1.1" class="ltx_text" style="font-size:90%;">Acc. </span><math id="A3.T4.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A3.T4.2.2.1.m1.1a"><mo mathsize="90%" id="A3.T4.2.2.1.m1.1.1" xref="A3.T4.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A3.T4.2.2.1.m1.1b"><csymbol cd="latexml" id="A3.T4.2.2.1.m1.1.1.cmml" xref="A3.T4.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.2.2.1.m1.1c">\pm</annotation></semantics></math><span id="A3.T4.2.2.1.2" class="ltx_text" style="font-size:90%;"> std. (%)</span>
</td>
<td id="A3.T4.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="A3.T4.3.3.2.1" class="ltx_text" style="font-size:90%;">65.65</span><math id="A3.T4.3.3.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A3.T4.3.3.2.m1.1a"><mo mathsize="90%" id="A3.T4.3.3.2.m1.1.1" xref="A3.T4.3.3.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A3.T4.3.3.2.m1.1b"><csymbol cd="latexml" id="A3.T4.3.3.2.m1.1.1.cmml" xref="A3.T4.3.3.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.3.3.2.m1.1c">\pm</annotation></semantics></math><span id="A3.T4.3.3.2.2" class="ltx_text" style="font-size:90%;">0.05</span>
</td>
<td id="A3.T4.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="A3.T4.4.4.3.1" class="ltx_text" style="font-size:90%;">66.04</span><math id="A3.T4.4.4.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A3.T4.4.4.3.m1.1a"><mo mathsize="90%" id="A3.T4.4.4.3.m1.1.1" xref="A3.T4.4.4.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A3.T4.4.4.3.m1.1b"><csymbol cd="latexml" id="A3.T4.4.4.3.m1.1.1.cmml" xref="A3.T4.4.4.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.4.4.3.m1.1c">\pm</annotation></semantics></math><span id="A3.T4.4.4.3.2" class="ltx_text" style="font-size:90%;">0.08</span>
</td>
<td id="A3.T4.5.5.4" class="ltx_td ltx_align_center ltx_border_t">
<span id="A3.T4.5.5.4.1" class="ltx_text" style="font-size:90%;">67.23</span><math id="A3.T4.5.5.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A3.T4.5.5.4.m1.1a"><mo mathsize="90%" id="A3.T4.5.5.4.m1.1.1" xref="A3.T4.5.5.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A3.T4.5.5.4.m1.1b"><csymbol cd="latexml" id="A3.T4.5.5.4.m1.1.1.cmml" xref="A3.T4.5.5.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.5.5.4.m1.1c">\pm</annotation></semantics></math><span id="A3.T4.5.5.4.2" class="ltx_text" style="font-size:90%;">0.01</span>
</td>
</tr>
<tr id="A3.T4.6.6" class="ltx_tr">
<td id="A3.T4.6.6.1" class="ltx_td ltx_align_center ltx_border_r">
<span id="A3.T4.6.6.1.1" class="ltx_text" style="font-size:90%;">#Params (</span><math id="A3.T4.6.6.1.m1.1" class="ltx_Math" alttext="\times 10^{6}" display="inline"><semantics id="A3.T4.6.6.1.m1.1a"><mrow id="A3.T4.6.6.1.m1.1.1" xref="A3.T4.6.6.1.m1.1.1.cmml"><mi id="A3.T4.6.6.1.m1.1.1.2" xref="A3.T4.6.6.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="A3.T4.6.6.1.m1.1.1.1" xref="A3.T4.6.6.1.m1.1.1.1.cmml">×</mo><msup id="A3.T4.6.6.1.m1.1.1.3" xref="A3.T4.6.6.1.m1.1.1.3.cmml"><mn mathsize="90%" id="A3.T4.6.6.1.m1.1.1.3.2" xref="A3.T4.6.6.1.m1.1.1.3.2.cmml">10</mn><mn mathsize="90%" id="A3.T4.6.6.1.m1.1.1.3.3" xref="A3.T4.6.6.1.m1.1.1.3.3.cmml">6</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T4.6.6.1.m1.1b"><apply id="A3.T4.6.6.1.m1.1.1.cmml" xref="A3.T4.6.6.1.m1.1.1"><times id="A3.T4.6.6.1.m1.1.1.1.cmml" xref="A3.T4.6.6.1.m1.1.1.1"></times><csymbol cd="latexml" id="A3.T4.6.6.1.m1.1.1.2.cmml" xref="A3.T4.6.6.1.m1.1.1.2">absent</csymbol><apply id="A3.T4.6.6.1.m1.1.1.3.cmml" xref="A3.T4.6.6.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T4.6.6.1.m1.1.1.3.1.cmml" xref="A3.T4.6.6.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="A3.T4.6.6.1.m1.1.1.3.2.cmml" xref="A3.T4.6.6.1.m1.1.1.3.2">10</cn><cn type="integer" id="A3.T4.6.6.1.m1.1.1.3.3.cmml" xref="A3.T4.6.6.1.m1.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.6.6.1.m1.1c">\times 10^{6}</annotation></semantics></math><span id="A3.T4.6.6.1.2" class="ltx_text" style="font-size:90%;">)</span>
</td>
<td id="A3.T4.6.6.2" class="ltx_td ltx_align_center ltx_border_r"><span id="A3.T4.6.6.2.1" class="ltx_text" style="font-size:90%;">116</span></td>
<td id="A3.T4.6.6.3" class="ltx_td ltx_align_center ltx_border_r"><span id="A3.T4.6.6.3.1" class="ltx_text" style="font-size:90%;">79</span></td>
<td id="A3.T4.6.6.4" class="ltx_td ltx_align_center"><span id="A3.T4.6.6.4.1" class="ltx_text" style="font-size:90%;">56</span></td>
</tr>
<tr id="A3.T4.7.7" class="ltx_tr">
<td id="A3.T4.7.7.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">
<span id="A3.T4.7.7.1.1" class="ltx_text" style="font-size:90%;">FLOPs (</span><math id="A3.T4.7.7.1.m1.1" class="ltx_Math" alttext="\times 10^{9}" display="inline"><semantics id="A3.T4.7.7.1.m1.1a"><mrow id="A3.T4.7.7.1.m1.1.1" xref="A3.T4.7.7.1.m1.1.1.cmml"><mi id="A3.T4.7.7.1.m1.1.1.2" xref="A3.T4.7.7.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="A3.T4.7.7.1.m1.1.1.1" xref="A3.T4.7.7.1.m1.1.1.1.cmml">×</mo><msup id="A3.T4.7.7.1.m1.1.1.3" xref="A3.T4.7.7.1.m1.1.1.3.cmml"><mn mathsize="90%" id="A3.T4.7.7.1.m1.1.1.3.2" xref="A3.T4.7.7.1.m1.1.1.3.2.cmml">10</mn><mn mathsize="90%" id="A3.T4.7.7.1.m1.1.1.3.3" xref="A3.T4.7.7.1.m1.1.1.3.3.cmml">9</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T4.7.7.1.m1.1b"><apply id="A3.T4.7.7.1.m1.1.1.cmml" xref="A3.T4.7.7.1.m1.1.1"><times id="A3.T4.7.7.1.m1.1.1.1.cmml" xref="A3.T4.7.7.1.m1.1.1.1"></times><csymbol cd="latexml" id="A3.T4.7.7.1.m1.1.1.2.cmml" xref="A3.T4.7.7.1.m1.1.1.2">absent</csymbol><apply id="A3.T4.7.7.1.m1.1.1.3.cmml" xref="A3.T4.7.7.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T4.7.7.1.m1.1.1.3.1.cmml" xref="A3.T4.7.7.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="A3.T4.7.7.1.m1.1.1.3.2.cmml" xref="A3.T4.7.7.1.m1.1.1.3.2">10</cn><cn type="integer" id="A3.T4.7.7.1.m1.1.1.3.3.cmml" xref="A3.T4.7.7.1.m1.1.1.3.3">9</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.7.7.1.m1.1c">\times 10^{9}</annotation></semantics></math><span id="A3.T4.7.7.1.2" class="ltx_text" style="font-size:90%;">)</span>
</td>
<td id="A3.T4.7.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="A3.T4.7.7.2.1" class="ltx_text" style="font-size:90%;">4.4</span></td>
<td id="A3.T4.7.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="A3.T4.7.7.3.1" class="ltx_text" style="font-size:90%;">3.3</span></td>
<td id="A3.T4.7.7.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="A3.T4.7.7.4.1" class="ltx_text" style="font-size:90%;">2.8</span></td>
</tr>
</table>
</figure>
<figure id="A3.F9" class="ltx_figure"><img src="/html/1906.10770/assets/x13.png" id="A3.F9.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="523" height="598" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F9.3.1.1" class="ltx_text" style="font-size:90%;">Figure 9</span>: </span><span id="A3.F9.4.2" class="ltx_text" style="font-size:90%;">Two examples of the learned attention maps from typical attention units and layers. For each attention unit (within the box), we show two attention maps from different heads.</span></figcaption>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1906.10769" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1906.10770" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1906.10770">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1906.10770" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1906.10771" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  2 15:42:50 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
