<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1808.00300] Learning Visual Question Answering by Bootstrapping Hard Attention</title><meta property="og:description" content="Attention mechanisms in biological perception are thought to select subsets of perceptual information for more sophisticated processing which would be prohibitive to perform on all sensory inputs. In computer vision, h…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Learning Visual Question Answering by Bootstrapping Hard Attention">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Learning Visual Question Answering by Bootstrapping Hard Attention">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1808.00300">

<!--Generated on Fri Mar 15 19:45:34 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Visual Question Answering,  Visual Turing Test,  Attention">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="id1" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>DeepMind, London, United Kingdom 
<br class="ltx_break"></span></span></span>
<h1 class="ltx_title ltx_title_document">Learning Visual Question Answering by Bootstrapping Hard Attention</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mateusz Malinowski
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Carl Doersch
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Adam Santoro
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Peter Battaglia
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Attention mechanisms in biological perception are thought to select subsets of perceptual information for more sophisticated processing which would be prohibitive to perform on all sensory inputs. In computer vision, however, there has been relatively little exploration of <em id="id1.id1.1" class="ltx_emph ltx_font_italic">hard</em> attention, where some information is selectively ignored, in spite of the success of <em id="id1.id1.2" class="ltx_emph ltx_font_italic">soft</em> attention, where information is re-weighted and aggregated, but never filtered out.
Here, we introduce
a new approach for hard attention and find it achieves
very competitive performance on a recently-released visual question answering datasets, equalling and in some cases surpassing similar soft attention architectures while entirely ignoring some features.
Even though the hard attention mechanism is thought to be non-differentiable,
we found that the feature magnitudes correlate with semantic relevance, and provide a useful signal for our mechanism’s attentional selection criterion.
Because hard attention selects important features of the input information, it can also be more efficient than analogous soft attention mechanisms. This is especially important for recent approaches that use <em id="id1.id1.3" class="ltx_emph ltx_font_italic">non-local pairwise</em> operations, whereby computational and memory costs are quadratic in the size of the set of features.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Visual Question Answering, Visual Turing Test, Attention
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/1808.00300/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="111" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.4.2" class="ltx_text" style="font-size:90%;">Given a natural image and a textual question as input, our Visual QA architecture outputs an answer. It uses a hard attention mechanism that selects only the important visual features for the task for further processing. We base our architecture on the premise that the norm of the visual features correlates with their relevance, and that those feature vectors with high magnitudes correspond to image regions which contain important semantic content.</span></figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Visual attention is instrumental to many aspects of complex visual reasoning in humans <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>.
For example, when asked to identify a dog’s owner among a group of people,
the human visual system adaptively allocates greater computational resources to processing visual information associated with the dog and potential owners, versus other aspects of the scene.
The perceptual effects can be so dramatic that prominent entities may not even rise to the level of awareness when the viewer is attending to other things in the scene <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
Yet attention has not been a transformative force in computer vision, possibly because many standard computer vision tasks like detection, segmentation, and classification do not involve the sort of complex reasoning which attention is thought to facilitate.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Answering detailed questions about an image is a type of task which requires more sophisticated patterns of reasoning, and there has been a rapid recent proliferation of computer vision approaches for tackling the <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">visual question answering</span> (Visual QA) task <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.
Successful Visual QA architectures must be able to handle many objects and their complex relations while also integrating rich background knowledge, and attention has emerged as a promising strategy for achieving good performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">We recognize a broad distinction between types of attention in computer vision and machine learning – <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">soft</span> versus <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">hard</span> attention.
Existing attention models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
are predominantly based on soft attention, in which all information is adaptively re-weighted before being aggregated.
This can improve accuracy by isolating important information and avoiding interference from unimportant information. Learning becomes more data efficient as the complexity of the interactions among different pieces of information reduces; this, loosely speaking, allows for more unambiguous credit assignment.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">By contrast, hard attention, in which only a subset of information is selected for further processing, is much less widely used. Like soft attention, it has the potential to improve accuracy and learning efficiency by focusing computation on the important parts of an image.
But beyond this, it offers better computational efficiency because it only fully processes the information deemed most relevant.
However, there is a key downside of hard attention within a gradient-based learning framework, such as deep learning: because the choice of which information to process is discrete and thus non-differentiable, gradients cannot be backpropagated into the selection mechanism to support gradient-based optimization.
There have been various efforts to address this shortcoming in visual attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, attention to text <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, and more general machine learning domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, but this is still a very active area of research.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Here we explore a simple approach to hard attention that bootstraps on an interesting phenomenon <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> in the feature representations of convolutional neural networks (CNNs): learned features often carry an easily accessible signal for hard attentional selection. In particular, selecting those feature vectors with the greatest <math id="S1.p5.1.m1.1" class="ltx_Math" alttext="L2" display="inline"><semantics id="S1.p5.1.m1.1a"><mrow id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml"><mi id="S1.p5.1.m1.1.1.2" xref="S1.p5.1.m1.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S1.p5.1.m1.1.1.1" xref="S1.p5.1.m1.1.1.1.cmml">​</mo><mn id="S1.p5.1.m1.1.1.3" xref="S1.p5.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><apply id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1"><times id="S1.p5.1.m1.1.1.1.cmml" xref="S1.p5.1.m1.1.1.1"></times><ci id="S1.p5.1.m1.1.1.2.cmml" xref="S1.p5.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S1.p5.1.m1.1.1.3.cmml" xref="S1.p5.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">L2</annotation></semantics></math>-norm values proves to be a heuristic that can facilitate hard attention – and provide the performance and efficiency benefits associated with – without requiring specialized learning procedures (see <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 1</span></a>). This attentional signal results indirectly from a standard supervised task loss, and does not require explicit supervision to incentivize norms to be proportional to object presence, salience, or other potentially meaningful measures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">We rely on a canonical Visual QA pipeline <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> augmented with a hard attention mechanism that uses the <math id="S1.p6.1.m1.1" class="ltx_Math" alttext="L2" display="inline"><semantics id="S1.p6.1.m1.1a"><mrow id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml"><mi id="S1.p6.1.m1.1.1.2" xref="S1.p6.1.m1.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S1.p6.1.m1.1.1.1" xref="S1.p6.1.m1.1.1.1.cmml">​</mo><mn id="S1.p6.1.m1.1.1.3" xref="S1.p6.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><apply id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1"><times id="S1.p6.1.m1.1.1.1.cmml" xref="S1.p6.1.m1.1.1.1"></times><ci id="S1.p6.1.m1.1.1.2.cmml" xref="S1.p6.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S1.p6.1.m1.1.1.3.cmml" xref="S1.p6.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">L2</annotation></semantics></math>-norms of the feature vectors to select subsets of the information for further processing. The first version, called the Hard Attention Network (HAN), selects a fixed number of feature vectors by choosing those with the top norms. The second version, called the Adaptive Hard Attention Network (AdaHAN), selects a variable number of feature vectors that depends on the input.
Our results show that our algorithm can actually outperform comparable soft attention architectures on a challenging Visual QA task.
This approach also produces interpretable hard attention masks, where the image regions which correspond to the selected features often contain semantically meaningful information, such as coherent objects.
We also show strong performance when combined with a form of
non-local pairwise model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. This algorithm computes features over pairs of input features and thus scale quadratically with number of vectors in the feature map, highlighting the importance of feature selection.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Visual question answering,
or more broadly the Visual Turing Test, asks “Can machines understand a visual scene only from answering questions?” <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>.
Creating a good Visual QA dataset has proved non-trivial: biases in the early datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> rewarded algorithms for exploiting spurious correlations, rather than tackling the reasoning problem head-on <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>.
Thus, we focus on the recently-introduced VQA-CP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and CLEVR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> datasets, which aim to reduce the dataset biases, providing a more difficult challenge for rich visual reasoning.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">One of the core challenges of Visual QA is the problem of <span id="S2.p2.1.1" class="ltx_text ltx_font_italic">grounding language</span>: that is, associating the meaning of a language term with a specific perceptual input <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>.
Many works have tackled this problem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, enforcing that language terms be grounded in the image.
In contrast, our algorithm does not directly use correspondence between modalities to enforce such grounding but instead relies on learning to find a discrete representation that captures the required information from the raw visual input, and question-answer pairs.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">The most successful Visual QA architectures build multimodal representations with a combined CNN+LSTM architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, and recently have begun including attention mechanisms inspired by soft and hard attention for image captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>.
However, only soft attention is used in the majority of Visual QA works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib51" title="" class="ltx_ref">51</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>.
In these architectures, a full-frame CNN representation is used to compute a spatial weighting (attention) over the CNN grid cells.
The visual representation is then the weighted-sum of the input tensor across space.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">The alternative is to select CNN grid cells in a discrete way, but due to many challenges in training non-differentiable architectures, such hard attention alternatives are severely under-explored.
Notable exceptions include <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>, but these run state-of-the-art object detectors or proposals to compute the hard attention maps.
We argue that relying on such external tools is fundamentally limited: it requires costly annotations, and cannot easily adapt to new visual concepts that aren’t previously labeled.
Outside Visual QA and captioning, some prior work in vision has explored limited forms of hard attention. One line of work on discriminative patches builds a representation by selecting some patches and ignoring others, which has proved useful for object detection and classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>, <a href="#bib.bib57" title="" class="ltx_ref">57</a>, <a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>, and especially visualization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite>.
However, such methods have recently been largely supplanted by end-to-end feature learning for practical vision problems. In deep learning, spatial transformers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> are one method for selecting an image regions while ignoring the rest, although these have proved challenging to train in practice.
Recent work on compressing neural networks (e.g. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>) uses magnitudes to remove weights of neural networks. However it prunes permanently based on weight magnitudes, not dynamically based on activation norms, and has no direct connection to hard-attention or Visual QA.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">Attention has also been studied outside of vision. While the focus on soft attention predominates these works as well, there are a few examples of hard attention mechanisms and other forms of discrete gating <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. In such works the decision of <em id="S2.p5.1.1" class="ltx_emph ltx_font_italic">where to look</em> is seen as a discrete variable that had been optimized either by reinforce loss or various other approximations (e.g. straight-through). However, due to the high variance of these gradients, learning can be inefficient, and soft attention mechanisms usually perform better.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<figure id="S3.F2" class="ltx_figure"><img src="/html/1808.00300/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="106" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.3.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.4.2" class="ltx_text" style="font-size:90%;">Our hard attention replaces commonly used soft attention mechanism. Otherwise, we follow the canonical Visual QA pipeline <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. Questions and images are encoded into their vector representations. Next, the spatial encoding of the visual features is unraveled, and the question embedding is broadcasted and concatenated (or added) accordingly to form a multimodal representation of the inputs. Our attention mechanism selectively chooses a subset of the multimodal vectors that are next aggregated and processed by the answering module.</span></figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.3" class="ltx_p">Answering questions about images is often formulated in terms of predictive models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. These architectures maximize a conditional distribution over answers <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">a</annotation></semantics></math>, given questions <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">q</annotation></semantics></math> and images <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">x</annotation></semantics></math>:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\hat{a}=\operatorname*{arg\,max}_{a\in\mathcal{A}}p(a|x,q)" display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><mover accent="true" id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml"><mi id="S3.E1.m1.3.3.3.2" xref="S3.E1.m1.3.3.3.2.cmml">a</mi><mo id="S3.E1.m1.3.3.3.1" xref="S3.E1.m1.3.3.3.1.cmml">^</mo></mover><mo id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.cmml"><mrow id="S3.E1.m1.3.3.1.3" xref="S3.E1.m1.3.3.1.3.cmml"><munder id="S3.E1.m1.3.3.1.3.1" xref="S3.E1.m1.3.3.1.3.1.cmml"><mrow id="S3.E1.m1.3.3.1.3.1.2" xref="S3.E1.m1.3.3.1.3.1.2.cmml"><mi id="S3.E1.m1.3.3.1.3.1.2.2" xref="S3.E1.m1.3.3.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E1.m1.3.3.1.3.1.2.1" xref="S3.E1.m1.3.3.1.3.1.2.1.cmml">​</mo><mi id="S3.E1.m1.3.3.1.3.1.2.3" xref="S3.E1.m1.3.3.1.3.1.2.3.cmml">max</mi></mrow><mrow id="S3.E1.m1.3.3.1.3.1.3" xref="S3.E1.m1.3.3.1.3.1.3.cmml"><mi id="S3.E1.m1.3.3.1.3.1.3.2" xref="S3.E1.m1.3.3.1.3.1.3.2.cmml">a</mi><mo id="S3.E1.m1.3.3.1.3.1.3.1" xref="S3.E1.m1.3.3.1.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.3.1.3.3" xref="S3.E1.m1.3.3.1.3.1.3.3.cmml">𝒜</mi></mrow></munder><mo id="S3.E1.m1.3.3.1.3a" xref="S3.E1.m1.3.3.1.3.cmml">⁡</mo><mi id="S3.E1.m1.3.3.1.3.2" xref="S3.E1.m1.3.3.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml">|</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.1.cmml"><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">x</mi><mo id="S3.E1.m1.3.3.1.1.1.1.3.2.1" xref="S3.E1.m1.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">q</mi></mrow></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><eq id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2"></eq><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"><ci id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.1">^</ci><ci id="S3.E1.m1.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.2">𝑎</ci></apply><apply id="S3.E1.m1.3.3.1.cmml" xref="S3.E1.m1.3.3.1"><times id="S3.E1.m1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.2"></times><apply id="S3.E1.m1.3.3.1.3.cmml" xref="S3.E1.m1.3.3.1.3"><apply id="S3.E1.m1.3.3.1.3.1.cmml" xref="S3.E1.m1.3.3.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.3.1.1.cmml" xref="S3.E1.m1.3.3.1.3.1">subscript</csymbol><apply id="S3.E1.m1.3.3.1.3.1.2.cmml" xref="S3.E1.m1.3.3.1.3.1.2"><times id="S3.E1.m1.3.3.1.3.1.2.1.cmml" xref="S3.E1.m1.3.3.1.3.1.2.1"></times><ci id="S3.E1.m1.3.3.1.3.1.2.2.cmml" xref="S3.E1.m1.3.3.1.3.1.2.2">arg</ci><ci id="S3.E1.m1.3.3.1.3.1.2.3.cmml" xref="S3.E1.m1.3.3.1.3.1.2.3">max</ci></apply><apply id="S3.E1.m1.3.3.1.3.1.3.cmml" xref="S3.E1.m1.3.3.1.3.1.3"><in id="S3.E1.m1.3.3.1.3.1.3.1.cmml" xref="S3.E1.m1.3.3.1.3.1.3.1"></in><ci id="S3.E1.m1.3.3.1.3.1.3.2.cmml" xref="S3.E1.m1.3.3.1.3.1.3.2">𝑎</ci><ci id="S3.E1.m1.3.3.1.3.1.3.3.cmml" xref="S3.E1.m1.3.3.1.3.1.3.3">𝒜</ci></apply></apply><ci id="S3.E1.m1.3.3.1.3.2.cmml" xref="S3.E1.m1.3.3.1.3.2">𝑝</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1">conditional</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">𝑎</ci><list id="S3.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑥</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑞</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\hat{a}=\operatorname*{arg\,max}_{a\in\mathcal{A}}p(a|x,q)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.5" class="ltx_p">where <math id="S3.p1.4.m1.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S3.p1.4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.4.m1.1.1" xref="S3.p1.4.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m1.1b"><ci id="S3.p1.4.m1.1.1.cmml" xref="S3.p1.4.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m1.1c">\mathcal{A}</annotation></semantics></math> is a countable set of all possible answers.
As is common in question answering <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, the question is a sequence of words <math id="S3.p1.5.m2.3" class="ltx_Math" alttext="q=\left[q_{1},...,q_{n}\right]" display="inline"><semantics id="S3.p1.5.m2.3a"><mrow id="S3.p1.5.m2.3.3" xref="S3.p1.5.m2.3.3.cmml"><mi id="S3.p1.5.m2.3.3.4" xref="S3.p1.5.m2.3.3.4.cmml">q</mi><mo id="S3.p1.5.m2.3.3.3" xref="S3.p1.5.m2.3.3.3.cmml">=</mo><mrow id="S3.p1.5.m2.3.3.2.2" xref="S3.p1.5.m2.3.3.2.3.cmml"><mo id="S3.p1.5.m2.3.3.2.2.3" xref="S3.p1.5.m2.3.3.2.3.cmml">[</mo><msub id="S3.p1.5.m2.2.2.1.1.1" xref="S3.p1.5.m2.2.2.1.1.1.cmml"><mi id="S3.p1.5.m2.2.2.1.1.1.2" xref="S3.p1.5.m2.2.2.1.1.1.2.cmml">q</mi><mn id="S3.p1.5.m2.2.2.1.1.1.3" xref="S3.p1.5.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.5.m2.3.3.2.2.4" xref="S3.p1.5.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.5.m2.1.1" xref="S3.p1.5.m2.1.1.cmml">…</mi><mo id="S3.p1.5.m2.3.3.2.2.5" xref="S3.p1.5.m2.3.3.2.3.cmml">,</mo><msub id="S3.p1.5.m2.3.3.2.2.2" xref="S3.p1.5.m2.3.3.2.2.2.cmml"><mi id="S3.p1.5.m2.3.3.2.2.2.2" xref="S3.p1.5.m2.3.3.2.2.2.2.cmml">q</mi><mi id="S3.p1.5.m2.3.3.2.2.2.3" xref="S3.p1.5.m2.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S3.p1.5.m2.3.3.2.2.6" xref="S3.p1.5.m2.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m2.3b"><apply id="S3.p1.5.m2.3.3.cmml" xref="S3.p1.5.m2.3.3"><eq id="S3.p1.5.m2.3.3.3.cmml" xref="S3.p1.5.m2.3.3.3"></eq><ci id="S3.p1.5.m2.3.3.4.cmml" xref="S3.p1.5.m2.3.3.4">𝑞</ci><list id="S3.p1.5.m2.3.3.2.3.cmml" xref="S3.p1.5.m2.3.3.2.2"><apply id="S3.p1.5.m2.2.2.1.1.1.cmml" xref="S3.p1.5.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.5.m2.2.2.1.1.1.1.cmml" xref="S3.p1.5.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.5.m2.2.2.1.1.1.2.cmml" xref="S3.p1.5.m2.2.2.1.1.1.2">𝑞</ci><cn type="integer" id="S3.p1.5.m2.2.2.1.1.1.3.cmml" xref="S3.p1.5.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.p1.5.m2.1.1.cmml" xref="S3.p1.5.m2.1.1">…</ci><apply id="S3.p1.5.m2.3.3.2.2.2.cmml" xref="S3.p1.5.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p1.5.m2.3.3.2.2.2.1.cmml" xref="S3.p1.5.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.p1.5.m2.3.3.2.2.2.2.cmml" xref="S3.p1.5.m2.3.3.2.2.2.2">𝑞</ci><ci id="S3.p1.5.m2.3.3.2.2.2.3.cmml" xref="S3.p1.5.m2.3.3.2.2.2.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m2.3c">q=\left[q_{1},...,q_{n}\right]</annotation></semantics></math>, while the output is reduced to a classification problem between a set of common answers (this is limited compared to approaches that generate answers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, but works better in practice).
Our architecture for learning a mapping from image and question, to answer, is shown in <a href="#S3.F2" title="Figure 2 ‣ 3 Method ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a>.
We encode the image with a CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite> (in our case, a pre-trained ResNet-101 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>, or a small CNN trained from scratch),
and encode the question to a fixed-length vector representation with an LSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>.
We compute a combined representation by copying the question representation to every spatial location in the CNN, and concatenating it with (or simply adding it to) the visual features, like previous work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
After a few layers of combined processing, we apply attention over spatial locations,
following previous works which often apply soft attention mechanisms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> at this point in the architecture.
Finally, we aggregate features, using either sum-pooling, or relational <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite> modules.
We train the whole network end-to-end with a standard logistic regression loss over answer categories.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Attention Mechanisms</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.15" class="ltx_p">Here, we describe prior work on soft attention, and our approach to hard attention.

<br class="ltx_break"><span id="S3.SS1.p1.15.1" class="ltx_text ltx_font_bold">Soft Attention.</span>
In most prior work, soft attention is implemented as a weighted mask over the spatial cells of the CNN representation.
Let <math id="S3.SS1.p1.1.m1.4" class="ltx_Math" alttext="\boldsymbol{x}:=CNN(x),\boldsymbol{q}:=LSTM(q)" display="inline"><semantics id="S3.SS1.p1.1.m1.4a"><mrow id="S3.SS1.p1.1.m1.4.4.2" xref="S3.SS1.p1.1.m1.4.4.3.cmml"><mrow id="S3.SS1.p1.1.m1.3.3.1.1" xref="S3.SS1.p1.1.m1.3.3.1.1.cmml"><mi id="S3.SS1.p1.1.m1.3.3.1.1.2" xref="S3.SS1.p1.1.m1.3.3.1.1.2.cmml">𝒙</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p1.1.m1.3.3.1.1.1" xref="S3.SS1.p1.1.m1.3.3.1.1.1.cmml">:=</mo><mrow id="S3.SS1.p1.1.m1.3.3.1.1.3" xref="S3.SS1.p1.1.m1.3.3.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.3.3.1.1.3.2" xref="S3.SS1.p1.1.m1.3.3.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.1.m1.3.3.1.1.3.1" xref="S3.SS1.p1.1.m1.3.3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.1.m1.3.3.1.1.3.3" xref="S3.SS1.p1.1.m1.3.3.1.1.3.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.1.m1.3.3.1.1.3.1a" xref="S3.SS1.p1.1.m1.3.3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.1.m1.3.3.1.1.3.4" xref="S3.SS1.p1.1.m1.3.3.1.1.3.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.1.m1.3.3.1.1.3.1b" xref="S3.SS1.p1.1.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.SS1.p1.1.m1.3.3.1.1.3.5.2" xref="S3.SS1.p1.1.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.3.3.1.1.3.5.2.1" xref="S3.SS1.p1.1.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.p1.1.m1.3.3.1.1.3.5.2.2" xref="S3.SS1.p1.1.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS1.p1.1.m1.4.4.2.3" xref="S3.SS1.p1.1.m1.4.4.3a.cmml">,</mo><mrow id="S3.SS1.p1.1.m1.4.4.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.cmml"><mi id="S3.SS1.p1.1.m1.4.4.2.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.cmml">𝒒</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p1.1.m1.4.4.2.2.1" xref="S3.SS1.p1.1.m1.4.4.2.2.1.cmml">:=</mo><mrow id="S3.SS1.p1.1.m1.4.4.2.2.3" xref="S3.SS1.p1.1.m1.4.4.2.2.3.cmml"><mi id="S3.SS1.p1.1.m1.4.4.2.2.3.2" xref="S3.SS1.p1.1.m1.4.4.2.2.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.1.m1.4.4.2.2.3.1" xref="S3.SS1.p1.1.m1.4.4.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.1.m1.4.4.2.2.3.3" xref="S3.SS1.p1.1.m1.4.4.2.2.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.1.m1.4.4.2.2.3.1a" xref="S3.SS1.p1.1.m1.4.4.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.1.m1.4.4.2.2.3.4" xref="S3.SS1.p1.1.m1.4.4.2.2.3.4.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.1.m1.4.4.2.2.3.1b" xref="S3.SS1.p1.1.m1.4.4.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.1.m1.4.4.2.2.3.5" xref="S3.SS1.p1.1.m1.4.4.2.2.3.5.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.1.m1.4.4.2.2.3.1c" xref="S3.SS1.p1.1.m1.4.4.2.2.3.1.cmml">​</mo><mrow id="S3.SS1.p1.1.m1.4.4.2.2.3.6.2" xref="S3.SS1.p1.1.m1.4.4.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.4.4.2.2.3.6.2.1" xref="S3.SS1.p1.1.m1.4.4.2.2.3.cmml">(</mo><mi id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml">q</mi><mo stretchy="false" id="S3.SS1.p1.1.m1.4.4.2.2.3.6.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.4b"><apply id="S3.SS1.p1.1.m1.4.4.3.cmml" xref="S3.SS1.p1.1.m1.4.4.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.3a.cmml" xref="S3.SS1.p1.1.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p1.1.m1.3.3.1.1.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1"><csymbol cd="latexml" id="S3.SS1.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1">assign</csymbol><ci id="S3.SS1.p1.1.m1.3.3.1.1.2.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.2">𝒙</ci><apply id="S3.SS1.p1.1.m1.3.3.1.1.3.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.3"><times id="S3.SS1.p1.1.m1.3.3.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.3.1"></times><ci id="S3.SS1.p1.1.m1.3.3.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.3.2">𝐶</ci><ci id="S3.SS1.p1.1.m1.3.3.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.3.3">𝑁</ci><ci id="S3.SS1.p1.1.m1.3.3.1.1.3.4.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.3.4">𝑁</ci><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑥</ci></apply></apply><apply id="S3.SS1.p1.1.m1.4.4.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2"><csymbol cd="latexml" id="S3.SS1.p1.1.m1.4.4.2.2.1.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.1">assign</csymbol><ci id="S3.SS1.p1.1.m1.4.4.2.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2">𝒒</ci><apply id="S3.SS1.p1.1.m1.4.4.2.2.3.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.3"><times id="S3.SS1.p1.1.m1.4.4.2.2.3.1.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.3.1"></times><ci id="S3.SS1.p1.1.m1.4.4.2.2.3.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.3.2">𝐿</ci><ci id="S3.SS1.p1.1.m1.4.4.2.2.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.3.3">𝑆</ci><ci id="S3.SS1.p1.1.m1.4.4.2.2.3.4.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.3.4">𝑇</ci><ci id="S3.SS1.p1.1.m1.4.4.2.2.3.5.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.3.5">𝑀</ci><ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.4c">\boldsymbol{x}:=CNN(x),\boldsymbol{q}:=LSTM(q)</annotation></semantics></math> for image <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">x</annotation></semantics></math> and question <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">q</annotation></semantics></math>.
We compute a weight <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="w_{ij}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">w</mi><mrow id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.1.1.3.1" xref="S3.SS1.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.4.m4.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑤</ci><apply id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><times id="S3.SS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3.1"></times><ci id="S3.SS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.2">𝑖</ci><ci id="S3.SS1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">w_{ij}</annotation></semantics></math> for every <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\boldsymbol{x}_{ij}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">𝒙</mi><mrow id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.5.m5.1.1.3.1" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝒙</ci><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><times id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1"></times><ci id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">𝑖</ci><ci id="S3.SS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\boldsymbol{x}_{ij}</annotation></semantics></math> (where <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">i</annotation></semantics></math> and <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">j</annotation></semantics></math> index spatial locations), using a neural network that takes <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="\boldsymbol{x}_{ij}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">𝒙</mi><mrow id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml"><mi id="S3.SS1.p1.8.m8.1.1.3.2" xref="S3.SS1.p1.8.m8.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m8.1.1.3.1" xref="S3.SS1.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.8.m8.1.1.3.3" xref="S3.SS1.p1.8.m8.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝒙</ci><apply id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3"><times id="S3.SS1.p1.8.m8.1.1.3.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.1"></times><ci id="S3.SS1.p1.8.m8.1.1.3.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2">𝑖</ci><ci id="S3.SS1.p1.8.m8.1.1.3.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\boldsymbol{x}_{ij}</annotation></semantics></math> and <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="\boldsymbol{q}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\boldsymbol{q}</annotation></semantics></math> as input.
Intuitively, weight <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="w_{ij}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><msub id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">w</mi><mrow id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.3.2" xref="S3.SS1.p1.10.m10.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.10.m10.1.1.3.1" xref="S3.SS1.p1.10.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.10.m10.1.1.3.3" xref="S3.SS1.p1.10.m10.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝑤</ci><apply id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3"><times id="S3.SS1.p1.10.m10.1.1.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.3.1"></times><ci id="S3.SS1.p1.10.m10.1.1.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.3.2">𝑖</ci><ci id="S3.SS1.p1.10.m10.1.1.3.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">w_{ij}</annotation></semantics></math> measures the “relevance” of the cell to the input question.
<math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">w</annotation></semantics></math> is nonnegative and normalized to sum to 1 across the image (generally with softmax).
Thus, <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><mi id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">w</annotation></semantics></math> is applied to the visual input via
<math id="S3.SS1.p1.13.m13.1" class="ltx_Math" alttext="\hat{\boldsymbol{h}_{ij}}:=w_{ij}\boldsymbol{x}_{ij}" display="inline"><semantics id="S3.SS1.p1.13.m13.1a"><mrow id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mover accent="true" id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml"><msub id="S3.SS1.p1.13.m13.1.1.2.2" xref="S3.SS1.p1.13.m13.1.1.2.2.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2.2.2" xref="S3.SS1.p1.13.m13.1.1.2.2.2.cmml">𝒉</mi><mrow id="S3.SS1.p1.13.m13.1.1.2.2.3" xref="S3.SS1.p1.13.m13.1.1.2.2.3.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2.2.3.2" xref="S3.SS1.p1.13.m13.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.13.m13.1.1.2.2.3.1" xref="S3.SS1.p1.13.m13.1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.13.m13.1.1.2.2.3.3" xref="S3.SS1.p1.13.m13.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS1.p1.13.m13.1.1.2.1" xref="S3.SS1.p1.13.m13.1.1.2.1.cmml">^</mo></mover><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p1.13.m13.1.1.1" xref="S3.SS1.p1.13.m13.1.1.1.cmml">:=</mo><mrow id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml"><msub id="S3.SS1.p1.13.m13.1.1.3.2" xref="S3.SS1.p1.13.m13.1.1.3.2.cmml"><mi id="S3.SS1.p1.13.m13.1.1.3.2.2" xref="S3.SS1.p1.13.m13.1.1.3.2.2.cmml">w</mi><mrow id="S3.SS1.p1.13.m13.1.1.3.2.3" xref="S3.SS1.p1.13.m13.1.1.3.2.3.cmml"><mi id="S3.SS1.p1.13.m13.1.1.3.2.3.2" xref="S3.SS1.p1.13.m13.1.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.13.m13.1.1.3.2.3.1" xref="S3.SS1.p1.13.m13.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.13.m13.1.1.3.2.3.3" xref="S3.SS1.p1.13.m13.1.1.3.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.13.m13.1.1.3.1" xref="S3.SS1.p1.13.m13.1.1.3.1.cmml">​</mo><msub id="S3.SS1.p1.13.m13.1.1.3.3" xref="S3.SS1.p1.13.m13.1.1.3.3.cmml"><mi id="S3.SS1.p1.13.m13.1.1.3.3.2" xref="S3.SS1.p1.13.m13.1.1.3.3.2.cmml">𝒙</mi><mrow id="S3.SS1.p1.13.m13.1.1.3.3.3" xref="S3.SS1.p1.13.m13.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.13.m13.1.1.3.3.3.2" xref="S3.SS1.p1.13.m13.1.1.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.13.m13.1.1.3.3.3.1" xref="S3.SS1.p1.13.m13.1.1.3.3.3.1.cmml">​</mo><mi id="S3.SS1.p1.13.m13.1.1.3.3.3.3" xref="S3.SS1.p1.13.m13.1.1.3.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="latexml" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1">assign</csymbol><apply id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2"><ci id="S3.SS1.p1.13.m13.1.1.2.1.cmml" xref="S3.SS1.p1.13.m13.1.1.2.1">^</ci><apply id="S3.SS1.p1.13.m13.1.1.2.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.2.2.1.cmml" xref="S3.SS1.p1.13.m13.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.2.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2.2.2">𝒉</ci><apply id="S3.SS1.p1.13.m13.1.1.2.2.3.cmml" xref="S3.SS1.p1.13.m13.1.1.2.2.3"><times id="S3.SS1.p1.13.m13.1.1.2.2.3.1.cmml" xref="S3.SS1.p1.13.m13.1.1.2.2.3.1"></times><ci id="S3.SS1.p1.13.m13.1.1.2.2.3.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2.2.3.2">𝑖</ci><ci id="S3.SS1.p1.13.m13.1.1.2.2.3.3.cmml" xref="S3.SS1.p1.13.m13.1.1.2.2.3.3">𝑗</ci></apply></apply></apply><apply id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3"><times id="S3.SS1.p1.13.m13.1.1.3.1.cmml" xref="S3.SS1.p1.13.m13.1.1.3.1"></times><apply id="S3.SS1.p1.13.m13.1.1.3.2.cmml" xref="S3.SS1.p1.13.m13.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.3.2.1.cmml" xref="S3.SS1.p1.13.m13.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.3.2.2.cmml" xref="S3.SS1.p1.13.m13.1.1.3.2.2">𝑤</ci><apply id="S3.SS1.p1.13.m13.1.1.3.2.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3.2.3"><times id="S3.SS1.p1.13.m13.1.1.3.2.3.1.cmml" xref="S3.SS1.p1.13.m13.1.1.3.2.3.1"></times><ci id="S3.SS1.p1.13.m13.1.1.3.2.3.2.cmml" xref="S3.SS1.p1.13.m13.1.1.3.2.3.2">𝑖</ci><ci id="S3.SS1.p1.13.m13.1.1.3.2.3.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.p1.13.m13.1.1.3.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.3.3.1.cmml" xref="S3.SS1.p1.13.m13.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.3.3.2.cmml" xref="S3.SS1.p1.13.m13.1.1.3.3.2">𝒙</ci><apply id="S3.SS1.p1.13.m13.1.1.3.3.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3.3.3"><times id="S3.SS1.p1.13.m13.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.13.m13.1.1.3.3.3.1"></times><ci id="S3.SS1.p1.13.m13.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.13.m13.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS1.p1.13.m13.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3.3.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">\hat{\boldsymbol{h}_{ij}}:=w_{ij}\boldsymbol{x}_{ij}</annotation></semantics></math>
to build the multi-modal representation.
This approach has some advantages, including conceptual simplicity and differentiability.
The disadvantage is that the weights, in practice, are never 0.
Irrelevant background can affect the output, no features can be dropped from potential further processing, and credit assignment is
still
challenging.

<br class="ltx_break"><span id="S3.SS1.p1.15.2" class="ltx_text ltx_font_bold">Hard Attention.</span>
Our main contribution is a new mechanism for hard attention. It produces a binary mask over spatial locations, which determines which features are passed on to further processing.
We call our method the Hard Attention Network (HAN).
The key idea is to use the <math id="S3.SS1.p1.14.m14.1" class="ltx_Math" alttext="L2" display="inline"><semantics id="S3.SS1.p1.14.m14.1a"><mrow id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m14.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.cmml">​</mo><mn id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><times id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1"></times><ci id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2">𝐿</ci><cn type="integer" id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">L2</annotation></semantics></math>-norm of the activations at each spatial location as a proxy for relevance at that location.
The correlation between <math id="S3.SS1.p1.15.m15.1" class="ltx_Math" alttext="L2" display="inline"><semantics id="S3.SS1.p1.15.m15.1a"><mrow id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml"><mi id="S3.SS1.p1.15.m15.1.1.2" xref="S3.SS1.p1.15.m15.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.15.m15.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.cmml">​</mo><mn id="S3.SS1.p1.15.m15.1.1.3" xref="S3.SS1.p1.15.m15.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1"><times id="S3.SS1.p1.15.m15.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1"></times><ci id="S3.SS1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.2">𝐿</ci><cn type="integer" id="S3.SS1.p1.15.m15.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">L2</annotation></semantics></math>-norm and relevance is an emergent property of the trained CNN features, which requires no additional constraints or objectives.
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> recently found something related: in an ImageNet-pretrained representation of an image of a cat and a dog, the largest feature norms appear above the cat and dog face, even though the representation was trained purely for classification.
Our architecture bootstraps on this phenomenon without explicitly training the network to have it.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.6" class="ltx_p">As above, let <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\boldsymbol{x}_{ij}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">𝒙</mi><mrow id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝒙</ci><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><times id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.1"></times><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\boldsymbol{x}_{ij}</annotation></semantics></math> and <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\boldsymbol{q}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\boldsymbol{q}</annotation></semantics></math> be a CNN cell at the spatial position <math id="S3.SS1.p2.3.m3.2" class="ltx_Math" alttext="i,j" display="inline"><semantics id="S3.SS1.p2.3.m3.2a"><mrow id="S3.SS1.p2.3.m3.2.3.2" xref="S3.SS1.p2.3.m3.2.3.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">i</mi><mo id="S3.SS1.p2.3.m3.2.3.2.1" xref="S3.SS1.p2.3.m3.2.3.1.cmml">,</mo><mi id="S3.SS1.p2.3.m3.2.2" xref="S3.SS1.p2.3.m3.2.2.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.2b"><list id="S3.SS1.p2.3.m3.2.3.1.cmml" xref="S3.SS1.p2.3.m3.2.3.2"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑖</ci><ci id="S3.SS1.p2.3.m3.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2">𝑗</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.2c">i,j</annotation></semantics></math>, and a question representation respectively.
We first embed <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="\boldsymbol{q}\in\mathbb{R}^{q}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">𝒒</mi><mo id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml">q</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><in id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"></in><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝒒</ci><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2">ℝ</ci><ci id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\boldsymbol{q}\in\mathbb{R}^{q}</annotation></semantics></math> and <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="\boldsymbol{x}\in\mathbb{R}^{x}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">𝒙</mi><mo id="S3.SS1.p2.5.m5.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.5.m5.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.cmml">x</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><in id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1"></in><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝒙</ci><apply id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2">ℝ</ci><ci id="S3.SS1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\boldsymbol{x}\in\mathbb{R}^{x}</annotation></semantics></math> into two feature spaces that share the same dimensionality <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">d</annotation></semantics></math>, i.e.<span id="S3.SS1.p2.6.1" class="ltx_text"></span>,</p>
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle\boldsymbol{\hat{x}}" display="inline"><semantics id="S3.E2.m1.1a"><mover accent="true" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><ci id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1">bold-^</ci><ci id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle\boldsymbol{\hat{x}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2.m2.2" class="ltx_Math" alttext="\displaystyle:=CNN^{1\times 1}(\boldsymbol{x};\theta_{x})\in\mathbb{R}^{w\times h\times d}" display="inline"><semantics id="S3.E2.m2.2a"><mrow id="S3.E2.m2.2.2" xref="S3.E2.m2.2.2.cmml"><mi id="S3.E2.m2.2.2.3" xref="S3.E2.m2.2.2.3.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S3.E2.m2.2.2.4" xref="S3.E2.m2.2.2.4.cmml">:=</mo><mrow id="S3.E2.m2.2.2.1" xref="S3.E2.m2.2.2.1.cmml"><mi id="S3.E2.m2.2.2.1.3" xref="S3.E2.m2.2.2.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E2.m2.2.2.1.2" xref="S3.E2.m2.2.2.1.2.cmml">​</mo><mi id="S3.E2.m2.2.2.1.4" xref="S3.E2.m2.2.2.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E2.m2.2.2.1.2a" xref="S3.E2.m2.2.2.1.2.cmml">​</mo><msup id="S3.E2.m2.2.2.1.5" xref="S3.E2.m2.2.2.1.5.cmml"><mi id="S3.E2.m2.2.2.1.5.2" xref="S3.E2.m2.2.2.1.5.2.cmml">N</mi><mrow id="S3.E2.m2.2.2.1.5.3" xref="S3.E2.m2.2.2.1.5.3.cmml"><mn id="S3.E2.m2.2.2.1.5.3.2" xref="S3.E2.m2.2.2.1.5.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m2.2.2.1.5.3.1" xref="S3.E2.m2.2.2.1.5.3.1.cmml">×</mo><mn id="S3.E2.m2.2.2.1.5.3.3" xref="S3.E2.m2.2.2.1.5.3.3.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S3.E2.m2.2.2.1.2b" xref="S3.E2.m2.2.2.1.2.cmml">​</mo><mrow id="S3.E2.m2.2.2.1.1.1" xref="S3.E2.m2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m2.2.2.1.1.1.2" xref="S3.E2.m2.2.2.1.1.2.cmml">(</mo><mi id="S3.E2.m2.1.1" xref="S3.E2.m2.1.1.cmml">𝒙</mi><mo id="S3.E2.m2.2.2.1.1.1.3" xref="S3.E2.m2.2.2.1.1.2.cmml">;</mo><msub id="S3.E2.m2.2.2.1.1.1.1" xref="S3.E2.m2.2.2.1.1.1.1.cmml"><mi id="S3.E2.m2.2.2.1.1.1.1.2" xref="S3.E2.m2.2.2.1.1.1.1.2.cmml">θ</mi><mi id="S3.E2.m2.2.2.1.1.1.1.3" xref="S3.E2.m2.2.2.1.1.1.1.3.cmml">x</mi></msub><mo stretchy="false" id="S3.E2.m2.2.2.1.1.1.4" xref="S3.E2.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m2.2.2.5" xref="S3.E2.m2.2.2.5.cmml">∈</mo><msup id="S3.E2.m2.2.2.6" xref="S3.E2.m2.2.2.6.cmml"><mi id="S3.E2.m2.2.2.6.2" xref="S3.E2.m2.2.2.6.2.cmml">ℝ</mi><mrow id="S3.E2.m2.2.2.6.3" xref="S3.E2.m2.2.2.6.3.cmml"><mi id="S3.E2.m2.2.2.6.3.2" xref="S3.E2.m2.2.2.6.3.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m2.2.2.6.3.1" xref="S3.E2.m2.2.2.6.3.1.cmml">×</mo><mi id="S3.E2.m2.2.2.6.3.3" xref="S3.E2.m2.2.2.6.3.3.cmml">h</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m2.2.2.6.3.1a" xref="S3.E2.m2.2.2.6.3.1.cmml">×</mo><mi id="S3.E2.m2.2.2.6.3.4" xref="S3.E2.m2.2.2.6.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m2.2b"><apply id="S3.E2.m2.2.2.cmml" xref="S3.E2.m2.2.2"><and id="S3.E2.m2.2.2a.cmml" xref="S3.E2.m2.2.2"></and><apply id="S3.E2.m2.2.2b.cmml" xref="S3.E2.m2.2.2"><csymbol cd="latexml" id="S3.E2.m2.2.2.4.cmml" xref="S3.E2.m2.2.2.4">assign</csymbol><csymbol cd="latexml" id="S3.E2.m2.2.2.3.cmml" xref="S3.E2.m2.2.2.3">absent</csymbol><apply id="S3.E2.m2.2.2.1.cmml" xref="S3.E2.m2.2.2.1"><times id="S3.E2.m2.2.2.1.2.cmml" xref="S3.E2.m2.2.2.1.2"></times><ci id="S3.E2.m2.2.2.1.3.cmml" xref="S3.E2.m2.2.2.1.3">𝐶</ci><ci id="S3.E2.m2.2.2.1.4.cmml" xref="S3.E2.m2.2.2.1.4">𝑁</ci><apply id="S3.E2.m2.2.2.1.5.cmml" xref="S3.E2.m2.2.2.1.5"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.1.5.1.cmml" xref="S3.E2.m2.2.2.1.5">superscript</csymbol><ci id="S3.E2.m2.2.2.1.5.2.cmml" xref="S3.E2.m2.2.2.1.5.2">𝑁</ci><apply id="S3.E2.m2.2.2.1.5.3.cmml" xref="S3.E2.m2.2.2.1.5.3"><times id="S3.E2.m2.2.2.1.5.3.1.cmml" xref="S3.E2.m2.2.2.1.5.3.1"></times><cn type="integer" id="S3.E2.m2.2.2.1.5.3.2.cmml" xref="S3.E2.m2.2.2.1.5.3.2">1</cn><cn type="integer" id="S3.E2.m2.2.2.1.5.3.3.cmml" xref="S3.E2.m2.2.2.1.5.3.3">1</cn></apply></apply><list id="S3.E2.m2.2.2.1.1.2.cmml" xref="S3.E2.m2.2.2.1.1.1"><ci id="S3.E2.m2.1.1.cmml" xref="S3.E2.m2.1.1">𝒙</ci><apply id="S3.E2.m2.2.2.1.1.1.1.cmml" xref="S3.E2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.1.1.1.1.1.cmml" xref="S3.E2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E2.m2.2.2.1.1.1.1.2.cmml" xref="S3.E2.m2.2.2.1.1.1.1.2">𝜃</ci><ci id="S3.E2.m2.2.2.1.1.1.1.3.cmml" xref="S3.E2.m2.2.2.1.1.1.1.3">𝑥</ci></apply></list></apply></apply><apply id="S3.E2.m2.2.2c.cmml" xref="S3.E2.m2.2.2"><in id="S3.E2.m2.2.2.5.cmml" xref="S3.E2.m2.2.2.5"></in><share href="#S3.E2.m2.2.2.1.cmml" id="S3.E2.m2.2.2d.cmml" xref="S3.E2.m2.2.2"></share><apply id="S3.E2.m2.2.2.6.cmml" xref="S3.E2.m2.2.2.6"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.6.1.cmml" xref="S3.E2.m2.2.2.6">superscript</csymbol><ci id="S3.E2.m2.2.2.6.2.cmml" xref="S3.E2.m2.2.2.6.2">ℝ</ci><apply id="S3.E2.m2.2.2.6.3.cmml" xref="S3.E2.m2.2.2.6.3"><times id="S3.E2.m2.2.2.6.3.1.cmml" xref="S3.E2.m2.2.2.6.3.1"></times><ci id="S3.E2.m2.2.2.6.3.2.cmml" xref="S3.E2.m2.2.2.6.3.2">𝑤</ci><ci id="S3.E2.m2.2.2.6.3.3.cmml" xref="S3.E2.m2.2.2.6.3.3">ℎ</ci><ci id="S3.E2.m2.2.2.6.3.4.cmml" xref="S3.E2.m2.2.2.6.3.4">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.2c">\displaystyle:=CNN^{1\times 1}(\boldsymbol{x};\theta_{x})\in\mathbb{R}^{w\times h\times d}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\displaystyle\boldsymbol{\hat{q}}" display="inline"><semantics id="S3.E3.m1.1a"><mover accent="true" id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mi id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml">𝒒</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><ci id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1">bold-^</ci><ci id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2">𝒒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle\boldsymbol{\hat{q}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3.m2.2" class="ltx_Math" alttext="\displaystyle:=MLP(\boldsymbol{q};\theta_{q})\in\mathbb{R}^{d}" display="inline"><semantics id="S3.E3.m2.2a"><mrow id="S3.E3.m2.2.2" xref="S3.E3.m2.2.2.cmml"><mi id="S3.E3.m2.2.2.3" xref="S3.E3.m2.2.2.3.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S3.E3.m2.2.2.4" xref="S3.E3.m2.2.2.4.cmml">:=</mo><mrow id="S3.E3.m2.2.2.1" xref="S3.E3.m2.2.2.1.cmml"><mi id="S3.E3.m2.2.2.1.3" xref="S3.E3.m2.2.2.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E3.m2.2.2.1.2" xref="S3.E3.m2.2.2.1.2.cmml">​</mo><mi id="S3.E3.m2.2.2.1.4" xref="S3.E3.m2.2.2.1.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E3.m2.2.2.1.2a" xref="S3.E3.m2.2.2.1.2.cmml">​</mo><mi id="S3.E3.m2.2.2.1.5" xref="S3.E3.m2.2.2.1.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E3.m2.2.2.1.2b" xref="S3.E3.m2.2.2.1.2.cmml">​</mo><mrow id="S3.E3.m2.2.2.1.1.1" xref="S3.E3.m2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m2.2.2.1.1.1.2" xref="S3.E3.m2.2.2.1.1.2.cmml">(</mo><mi id="S3.E3.m2.1.1" xref="S3.E3.m2.1.1.cmml">𝒒</mi><mo id="S3.E3.m2.2.2.1.1.1.3" xref="S3.E3.m2.2.2.1.1.2.cmml">;</mo><msub id="S3.E3.m2.2.2.1.1.1.1" xref="S3.E3.m2.2.2.1.1.1.1.cmml"><mi id="S3.E3.m2.2.2.1.1.1.1.2" xref="S3.E3.m2.2.2.1.1.1.1.2.cmml">θ</mi><mi id="S3.E3.m2.2.2.1.1.1.1.3" xref="S3.E3.m2.2.2.1.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S3.E3.m2.2.2.1.1.1.4" xref="S3.E3.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m2.2.2.5" xref="S3.E3.m2.2.2.5.cmml">∈</mo><msup id="S3.E3.m2.2.2.6" xref="S3.E3.m2.2.2.6.cmml"><mi id="S3.E3.m2.2.2.6.2" xref="S3.E3.m2.2.2.6.2.cmml">ℝ</mi><mi id="S3.E3.m2.2.2.6.3" xref="S3.E3.m2.2.2.6.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.2b"><apply id="S3.E3.m2.2.2.cmml" xref="S3.E3.m2.2.2"><and id="S3.E3.m2.2.2a.cmml" xref="S3.E3.m2.2.2"></and><apply id="S3.E3.m2.2.2b.cmml" xref="S3.E3.m2.2.2"><csymbol cd="latexml" id="S3.E3.m2.2.2.4.cmml" xref="S3.E3.m2.2.2.4">assign</csymbol><csymbol cd="latexml" id="S3.E3.m2.2.2.3.cmml" xref="S3.E3.m2.2.2.3">absent</csymbol><apply id="S3.E3.m2.2.2.1.cmml" xref="S3.E3.m2.2.2.1"><times id="S3.E3.m2.2.2.1.2.cmml" xref="S3.E3.m2.2.2.1.2"></times><ci id="S3.E3.m2.2.2.1.3.cmml" xref="S3.E3.m2.2.2.1.3">𝑀</ci><ci id="S3.E3.m2.2.2.1.4.cmml" xref="S3.E3.m2.2.2.1.4">𝐿</ci><ci id="S3.E3.m2.2.2.1.5.cmml" xref="S3.E3.m2.2.2.1.5">𝑃</ci><list id="S3.E3.m2.2.2.1.1.2.cmml" xref="S3.E3.m2.2.2.1.1.1"><ci id="S3.E3.m2.1.1.cmml" xref="S3.E3.m2.1.1">𝒒</ci><apply id="S3.E3.m2.2.2.1.1.1.1.cmml" xref="S3.E3.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m2.2.2.1.1.1.1.1.cmml" xref="S3.E3.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E3.m2.2.2.1.1.1.1.2.cmml" xref="S3.E3.m2.2.2.1.1.1.1.2">𝜃</ci><ci id="S3.E3.m2.2.2.1.1.1.1.3.cmml" xref="S3.E3.m2.2.2.1.1.1.1.3">𝑞</ci></apply></list></apply></apply><apply id="S3.E3.m2.2.2c.cmml" xref="S3.E3.m2.2.2"><in id="S3.E3.m2.2.2.5.cmml" xref="S3.E3.m2.2.2.5"></in><share href="#S3.E3.m2.2.2.1.cmml" id="S3.E3.m2.2.2d.cmml" xref="S3.E3.m2.2.2"></share><apply id="S3.E3.m2.2.2.6.cmml" xref="S3.E3.m2.2.2.6"><csymbol cd="ambiguous" id="S3.E3.m2.2.2.6.1.cmml" xref="S3.E3.m2.2.2.6">superscript</csymbol><ci id="S3.E3.m2.2.2.6.2.cmml" xref="S3.E3.m2.2.2.6.2">ℝ</ci><ci id="S3.E3.m2.2.2.6.3.cmml" xref="S3.E3.m2.2.2.6.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.2c">\displaystyle:=MLP(\boldsymbol{q};\theta_{q})\in\mathbb{R}^{d}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.10" class="ltx_p">where <math id="S3.SS1.p2.7.m1.1" class="ltx_Math" alttext="CNN^{1\times 1}" display="inline"><semantics id="S3.SS1.p2.7.m1.1a"><mrow id="S3.SS1.p2.7.m1.1.1" xref="S3.SS1.p2.7.m1.1.1.cmml"><mi id="S3.SS1.p2.7.m1.1.1.2" xref="S3.SS1.p2.7.m1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.7.m1.1.1.1" xref="S3.SS1.p2.7.m1.1.1.1.cmml">​</mo><mi id="S3.SS1.p2.7.m1.1.1.3" xref="S3.SS1.p2.7.m1.1.1.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.7.m1.1.1.1a" xref="S3.SS1.p2.7.m1.1.1.1.cmml">​</mo><msup id="S3.SS1.p2.7.m1.1.1.4" xref="S3.SS1.p2.7.m1.1.1.4.cmml"><mi id="S3.SS1.p2.7.m1.1.1.4.2" xref="S3.SS1.p2.7.m1.1.1.4.2.cmml">N</mi><mrow id="S3.SS1.p2.7.m1.1.1.4.3" xref="S3.SS1.p2.7.m1.1.1.4.3.cmml"><mn id="S3.SS1.p2.7.m1.1.1.4.3.2" xref="S3.SS1.p2.7.m1.1.1.4.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.7.m1.1.1.4.3.1" xref="S3.SS1.p2.7.m1.1.1.4.3.1.cmml">×</mo><mn id="S3.SS1.p2.7.m1.1.1.4.3.3" xref="S3.SS1.p2.7.m1.1.1.4.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m1.1b"><apply id="S3.SS1.p2.7.m1.1.1.cmml" xref="S3.SS1.p2.7.m1.1.1"><times id="S3.SS1.p2.7.m1.1.1.1.cmml" xref="S3.SS1.p2.7.m1.1.1.1"></times><ci id="S3.SS1.p2.7.m1.1.1.2.cmml" xref="S3.SS1.p2.7.m1.1.1.2">𝐶</ci><ci id="S3.SS1.p2.7.m1.1.1.3.cmml" xref="S3.SS1.p2.7.m1.1.1.3">𝑁</ci><apply id="S3.SS1.p2.7.m1.1.1.4.cmml" xref="S3.SS1.p2.7.m1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m1.1.1.4.1.cmml" xref="S3.SS1.p2.7.m1.1.1.4">superscript</csymbol><ci id="S3.SS1.p2.7.m1.1.1.4.2.cmml" xref="S3.SS1.p2.7.m1.1.1.4.2">𝑁</ci><apply id="S3.SS1.p2.7.m1.1.1.4.3.cmml" xref="S3.SS1.p2.7.m1.1.1.4.3"><times id="S3.SS1.p2.7.m1.1.1.4.3.1.cmml" xref="S3.SS1.p2.7.m1.1.1.4.3.1"></times><cn type="integer" id="S3.SS1.p2.7.m1.1.1.4.3.2.cmml" xref="S3.SS1.p2.7.m1.1.1.4.3.2">1</cn><cn type="integer" id="S3.SS1.p2.7.m1.1.1.4.3.3.cmml" xref="S3.SS1.p2.7.m1.1.1.4.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m1.1c">CNN^{1\times 1}</annotation></semantics></math> stands for a <math id="S3.SS1.p2.8.m2.1" class="ltx_Math" alttext="1\times 1" display="inline"><semantics id="S3.SS1.p2.8.m2.1a"><mrow id="S3.SS1.p2.8.m2.1.1" xref="S3.SS1.p2.8.m2.1.1.cmml"><mn id="S3.SS1.p2.8.m2.1.1.2" xref="S3.SS1.p2.8.m2.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.8.m2.1.1.1" xref="S3.SS1.p2.8.m2.1.1.1.cmml">×</mo><mn id="S3.SS1.p2.8.m2.1.1.3" xref="S3.SS1.p2.8.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m2.1b"><apply id="S3.SS1.p2.8.m2.1.1.cmml" xref="S3.SS1.p2.8.m2.1.1"><times id="S3.SS1.p2.8.m2.1.1.1.cmml" xref="S3.SS1.p2.8.m2.1.1.1"></times><cn type="integer" id="S3.SS1.p2.8.m2.1.1.2.cmml" xref="S3.SS1.p2.8.m2.1.1.2">1</cn><cn type="integer" id="S3.SS1.p2.8.m2.1.1.3.cmml" xref="S3.SS1.p2.8.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m2.1c">1\times 1</annotation></semantics></math> convolutional network and <math id="S3.SS1.p2.9.m3.1" class="ltx_Math" alttext="MLP" display="inline"><semantics id="S3.SS1.p2.9.m3.1a"><mrow id="S3.SS1.p2.9.m3.1.1" xref="S3.SS1.p2.9.m3.1.1.cmml"><mi id="S3.SS1.p2.9.m3.1.1.2" xref="S3.SS1.p2.9.m3.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.9.m3.1.1.1" xref="S3.SS1.p2.9.m3.1.1.1.cmml">​</mo><mi id="S3.SS1.p2.9.m3.1.1.3" xref="S3.SS1.p2.9.m3.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.9.m3.1.1.1a" xref="S3.SS1.p2.9.m3.1.1.1.cmml">​</mo><mi id="S3.SS1.p2.9.m3.1.1.4" xref="S3.SS1.p2.9.m3.1.1.4.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m3.1b"><apply id="S3.SS1.p2.9.m3.1.1.cmml" xref="S3.SS1.p2.9.m3.1.1"><times id="S3.SS1.p2.9.m3.1.1.1.cmml" xref="S3.SS1.p2.9.m3.1.1.1"></times><ci id="S3.SS1.p2.9.m3.1.1.2.cmml" xref="S3.SS1.p2.9.m3.1.1.2">𝑀</ci><ci id="S3.SS1.p2.9.m3.1.1.3.cmml" xref="S3.SS1.p2.9.m3.1.1.3">𝐿</ci><ci id="S3.SS1.p2.9.m3.1.1.4.cmml" xref="S3.SS1.p2.9.m3.1.1.4">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m3.1c">MLP</annotation></semantics></math> stands for a multilayer perceptron.
We then combine both the convolutional image features with the question features into a shared <em id="S3.SS1.p2.10.1" class="ltx_emph ltx_font_italic">multimodal</em> embedding by first broadcasting the question features to match the <math id="S3.SS1.p2.10.m4.1" class="ltx_Math" alttext="w\times d" display="inline"><semantics id="S3.SS1.p2.10.m4.1a"><mrow id="S3.SS1.p2.10.m4.1.1" xref="S3.SS1.p2.10.m4.1.1.cmml"><mi id="S3.SS1.p2.10.m4.1.1.2" xref="S3.SS1.p2.10.m4.1.1.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.10.m4.1.1.1" xref="S3.SS1.p2.10.m4.1.1.1.cmml">×</mo><mi id="S3.SS1.p2.10.m4.1.1.3" xref="S3.SS1.p2.10.m4.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m4.1b"><apply id="S3.SS1.p2.10.m4.1.1.cmml" xref="S3.SS1.p2.10.m4.1.1"><times id="S3.SS1.p2.10.m4.1.1.1.cmml" xref="S3.SS1.p2.10.m4.1.1.1"></times><ci id="S3.SS1.p2.10.m4.1.1.2.cmml" xref="S3.SS1.p2.10.m4.1.1.2">𝑤</ci><ci id="S3.SS1.p2.10.m4.1.1.3.cmml" xref="S3.SS1.p2.10.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m4.1c">w\times d</annotation></semantics></math> shape of the image feature map, and then performing element-wise addition (1x1 conv net/MLP in Figure <a href="#S3.F2" title="Figure 2 ‣ 3 Method ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>):</p>
<table id="S5.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\displaystyle\boldsymbol{m}_{ij}:=\boldsymbol{\hat{x}}_{ij}\oplus\boldsymbol{\hat{q}}\text{\ , where }\boldsymbol{m}:=\left[\boldsymbol{m}_{ij}\right]_{ij}\in\mathbb{R}^{w\times h\times d}" display="inline"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><msub id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml">𝒎</mi><mrow id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.3.3.2" xref="S3.E4.m1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.3.3.1" xref="S3.E4.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.3.3.3" xref="S3.E4.m1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo lspace="0.278em" rspace="0.278em" id="S3.E4.m1.1.1.4" xref="S3.E4.m1.1.1.4.cmml">:=</mo><mrow id="S3.E4.m1.1.1.5" xref="S3.E4.m1.1.1.5.cmml"><msub id="S3.E4.m1.1.1.5.2" xref="S3.E4.m1.1.1.5.2.cmml"><mover accent="true" id="S3.E4.m1.1.1.5.2.2" xref="S3.E4.m1.1.1.5.2.2.cmml"><mi id="S3.E4.m1.1.1.5.2.2.2" xref="S3.E4.m1.1.1.5.2.2.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E4.m1.1.1.5.2.2.1" xref="S3.E4.m1.1.1.5.2.2.1.cmml">^</mo></mover><mrow id="S3.E4.m1.1.1.5.2.3" xref="S3.E4.m1.1.1.5.2.3.cmml"><mi id="S3.E4.m1.1.1.5.2.3.2" xref="S3.E4.m1.1.1.5.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.5.2.3.1" xref="S3.E4.m1.1.1.5.2.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.5.2.3.3" xref="S3.E4.m1.1.1.5.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E4.m1.1.1.5.1" xref="S3.E4.m1.1.1.5.1.cmml">⊕</mo><mrow id="S3.E4.m1.1.1.5.3" xref="S3.E4.m1.1.1.5.3.cmml"><mover accent="true" id="S3.E4.m1.1.1.5.3.2" xref="S3.E4.m1.1.1.5.3.2.cmml"><mi id="S3.E4.m1.1.1.5.3.2.2" xref="S3.E4.m1.1.1.5.3.2.2.cmml">𝒒</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E4.m1.1.1.5.3.2.1" xref="S3.E4.m1.1.1.5.3.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.5.3.1" xref="S3.E4.m1.1.1.5.3.1.cmml">​</mo><mtext id="S3.E4.m1.1.1.5.3.3" xref="S3.E4.m1.1.1.5.3.3a.cmml"> , where </mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.5.3.1a" xref="S3.E4.m1.1.1.5.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.5.3.4" xref="S3.E4.m1.1.1.5.3.4.cmml">𝒎</mi></mrow></mrow><mo lspace="0.278em" rspace="0.278em" id="S3.E4.m1.1.1.6" xref="S3.E4.m1.1.1.6.cmml">:=</mo><msub id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.1.cmml">[</mo><msub id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">𝒎</mi><mrow id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.E4.m1.1.1.7" xref="S3.E4.m1.1.1.7.cmml">∈</mo><msup id="S3.E4.m1.1.1.8" xref="S3.E4.m1.1.1.8.cmml"><mi id="S3.E4.m1.1.1.8.2" xref="S3.E4.m1.1.1.8.2.cmml">ℝ</mi><mrow id="S3.E4.m1.1.1.8.3" xref="S3.E4.m1.1.1.8.3.cmml"><mi id="S3.E4.m1.1.1.8.3.2" xref="S3.E4.m1.1.1.8.3.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.1.1.8.3.1" xref="S3.E4.m1.1.1.8.3.1.cmml">×</mo><mi id="S3.E4.m1.1.1.8.3.3" xref="S3.E4.m1.1.1.8.3.3.cmml">h</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.1.1.8.3.1a" xref="S3.E4.m1.1.1.8.3.1.cmml">×</mo><mi id="S3.E4.m1.1.1.8.3.4" xref="S3.E4.m1.1.1.8.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><and id="S3.E4.m1.1.1a.cmml" xref="S3.E4.m1.1.1"></and><apply id="S3.E4.m1.1.1b.cmml" xref="S3.E4.m1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.4.cmml" xref="S3.E4.m1.1.1.4">assign</csymbol><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2">𝒎</ci><apply id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3"><times id="S3.E4.m1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3.1"></times><ci id="S3.E4.m1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.2">𝑖</ci><ci id="S3.E4.m1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.E4.m1.1.1.5.cmml" xref="S3.E4.m1.1.1.5"><csymbol cd="latexml" id="S3.E4.m1.1.1.5.1.cmml" xref="S3.E4.m1.1.1.5.1">direct-sum</csymbol><apply id="S3.E4.m1.1.1.5.2.cmml" xref="S3.E4.m1.1.1.5.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.5.2.1.cmml" xref="S3.E4.m1.1.1.5.2">subscript</csymbol><apply id="S3.E4.m1.1.1.5.2.2.cmml" xref="S3.E4.m1.1.1.5.2.2"><ci id="S3.E4.m1.1.1.5.2.2.1.cmml" xref="S3.E4.m1.1.1.5.2.2.1">bold-^</ci><ci id="S3.E4.m1.1.1.5.2.2.2.cmml" xref="S3.E4.m1.1.1.5.2.2.2">𝒙</ci></apply><apply id="S3.E4.m1.1.1.5.2.3.cmml" xref="S3.E4.m1.1.1.5.2.3"><times id="S3.E4.m1.1.1.5.2.3.1.cmml" xref="S3.E4.m1.1.1.5.2.3.1"></times><ci id="S3.E4.m1.1.1.5.2.3.2.cmml" xref="S3.E4.m1.1.1.5.2.3.2">𝑖</ci><ci id="S3.E4.m1.1.1.5.2.3.3.cmml" xref="S3.E4.m1.1.1.5.2.3.3">𝑗</ci></apply></apply><apply id="S3.E4.m1.1.1.5.3.cmml" xref="S3.E4.m1.1.1.5.3"><times id="S3.E4.m1.1.1.5.3.1.cmml" xref="S3.E4.m1.1.1.5.3.1"></times><apply id="S3.E4.m1.1.1.5.3.2.cmml" xref="S3.E4.m1.1.1.5.3.2"><ci id="S3.E4.m1.1.1.5.3.2.1.cmml" xref="S3.E4.m1.1.1.5.3.2.1">bold-^</ci><ci id="S3.E4.m1.1.1.5.3.2.2.cmml" xref="S3.E4.m1.1.1.5.3.2.2">𝒒</ci></apply><ci id="S3.E4.m1.1.1.5.3.3a.cmml" xref="S3.E4.m1.1.1.5.3.3"><mtext id="S3.E4.m1.1.1.5.3.3.cmml" xref="S3.E4.m1.1.1.5.3.3"> , where </mtext></ci><ci id="S3.E4.m1.1.1.5.3.4.cmml" xref="S3.E4.m1.1.1.5.3.4">𝒎</ci></apply></apply></apply><apply id="S3.E4.m1.1.1c.cmml" xref="S3.E4.m1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.6.cmml" xref="S3.E4.m1.1.1.6">assign</csymbol><share href="#S3.E4.m1.1.1.5.cmml" id="S3.E4.m1.1.1d.cmml" xref="S3.E4.m1.1.1"></share><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">𝒎</ci><apply id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3"><times id="S3.E4.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.E4.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E4.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3"><times id="S3.E4.m1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.3.1"></times><ci id="S3.E4.m1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.3.2">𝑖</ci><ci id="S3.E4.m1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E4.m1.1.1e.cmml" xref="S3.E4.m1.1.1"><in id="S3.E4.m1.1.1.7.cmml" xref="S3.E4.m1.1.1.7"></in><share href="#S3.E4.m1.1.1.1.cmml" id="S3.E4.m1.1.1f.cmml" xref="S3.E4.m1.1.1"></share><apply id="S3.E4.m1.1.1.8.cmml" xref="S3.E4.m1.1.1.8"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.8.1.cmml" xref="S3.E4.m1.1.1.8">superscript</csymbol><ci id="S3.E4.m1.1.1.8.2.cmml" xref="S3.E4.m1.1.1.8.2">ℝ</ci><apply id="S3.E4.m1.1.1.8.3.cmml" xref="S3.E4.m1.1.1.8.3"><times id="S3.E4.m1.1.1.8.3.1.cmml" xref="S3.E4.m1.1.1.8.3.1"></times><ci id="S3.E4.m1.1.1.8.3.2.cmml" xref="S3.E4.m1.1.1.8.3.2">𝑤</ci><ci id="S3.E4.m1.1.1.8.3.3.cmml" xref="S3.E4.m1.1.1.8.3.3">ℎ</ci><ci id="S3.E4.m1.1.1.8.3.4.cmml" xref="S3.E4.m1.1.1.8.3.4">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\displaystyle\boldsymbol{m}_{ij}:=\boldsymbol{\hat{x}}_{ij}\oplus\boldsymbol{\hat{q}}\text{\ , where }\boldsymbol{m}:=\left[\boldsymbol{m}_{ij}\right]_{ij}\in\mathbb{R}^{w\times h\times d}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.11" class="ltx_p">Element-wise addition keeps the dimensionality of each input, as opposed to concatenation, yet is still effective <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.
Next, we compute the <em id="S3.SS1.p2.11.1" class="ltx_emph ltx_font_italic">presence vector</em>,
<math id="S3.SS1.p2.11.m1.1" class="ltx_Math" alttext="\boldsymbol{p}:=\left[p_{ij}\right]_{ij}\in\mathbb{R}^{w\times h}" display="inline"><semantics id="S3.SS1.p2.11.m1.1a"><mrow id="S3.SS1.p2.11.m1.1.1" xref="S3.SS1.p2.11.m1.1.1.cmml"><mi id="S3.SS1.p2.11.m1.1.1.3" xref="S3.SS1.p2.11.m1.1.1.3.cmml">𝒑</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.11.m1.1.1.4" xref="S3.SS1.p2.11.m1.1.1.4.cmml">:=</mo><msub id="S3.SS1.p2.11.m1.1.1.1" xref="S3.SS1.p2.11.m1.1.1.1.cmml"><mrow id="S3.SS1.p2.11.m1.1.1.1.1.1" xref="S3.SS1.p2.11.m1.1.1.1.1.2.cmml"><mo id="S3.SS1.p2.11.m1.1.1.1.1.1.2" xref="S3.SS1.p2.11.m1.1.1.1.1.2.1.cmml">[</mo><msub id="S3.SS1.p2.11.m1.1.1.1.1.1.1" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.11.m1.1.1.1.1.1.1.2" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1.2.cmml">p</mi><mrow id="S3.SS1.p2.11.m1.1.1.1.1.1.1.3" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.2" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.1" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.3" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS1.p2.11.m1.1.1.1.1.1.3" xref="S3.SS1.p2.11.m1.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS1.p2.11.m1.1.1.1.3" xref="S3.SS1.p2.11.m1.1.1.1.3.cmml"><mi id="S3.SS1.p2.11.m1.1.1.1.3.2" xref="S3.SS1.p2.11.m1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.11.m1.1.1.1.3.1" xref="S3.SS1.p2.11.m1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.11.m1.1.1.1.3.3" xref="S3.SS1.p2.11.m1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS1.p2.11.m1.1.1.5" xref="S3.SS1.p2.11.m1.1.1.5.cmml">∈</mo><msup id="S3.SS1.p2.11.m1.1.1.6" xref="S3.SS1.p2.11.m1.1.1.6.cmml"><mi id="S3.SS1.p2.11.m1.1.1.6.2" xref="S3.SS1.p2.11.m1.1.1.6.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.11.m1.1.1.6.3" xref="S3.SS1.p2.11.m1.1.1.6.3.cmml"><mi id="S3.SS1.p2.11.m1.1.1.6.3.2" xref="S3.SS1.p2.11.m1.1.1.6.3.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.11.m1.1.1.6.3.1" xref="S3.SS1.p2.11.m1.1.1.6.3.1.cmml">×</mo><mi id="S3.SS1.p2.11.m1.1.1.6.3.3" xref="S3.SS1.p2.11.m1.1.1.6.3.3.cmml">h</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m1.1b"><apply id="S3.SS1.p2.11.m1.1.1.cmml" xref="S3.SS1.p2.11.m1.1.1"><and id="S3.SS1.p2.11.m1.1.1a.cmml" xref="S3.SS1.p2.11.m1.1.1"></and><apply id="S3.SS1.p2.11.m1.1.1b.cmml" xref="S3.SS1.p2.11.m1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.11.m1.1.1.4.cmml" xref="S3.SS1.p2.11.m1.1.1.4">assign</csymbol><ci id="S3.SS1.p2.11.m1.1.1.3.cmml" xref="S3.SS1.p2.11.m1.1.1.3">𝒑</ci><apply id="S3.SS1.p2.11.m1.1.1.1.cmml" xref="S3.SS1.p2.11.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m1.1.1.1.2.cmml" xref="S3.SS1.p2.11.m1.1.1.1">subscript</csymbol><apply id="S3.SS1.p2.11.m1.1.1.1.1.2.cmml" xref="S3.SS1.p2.11.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.11.m1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.11.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p2.11.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1.2">𝑝</ci><apply id="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1.3"><times id="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.11.m1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.SS1.p2.11.m1.1.1.1.3.cmml" xref="S3.SS1.p2.11.m1.1.1.1.3"><times id="S3.SS1.p2.11.m1.1.1.1.3.1.cmml" xref="S3.SS1.p2.11.m1.1.1.1.3.1"></times><ci id="S3.SS1.p2.11.m1.1.1.1.3.2.cmml" xref="S3.SS1.p2.11.m1.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p2.11.m1.1.1.1.3.3.cmml" xref="S3.SS1.p2.11.m1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.SS1.p2.11.m1.1.1c.cmml" xref="S3.SS1.p2.11.m1.1.1"><in id="S3.SS1.p2.11.m1.1.1.5.cmml" xref="S3.SS1.p2.11.m1.1.1.5"></in><share href="#S3.SS1.p2.11.m1.1.1.1.cmml" id="S3.SS1.p2.11.m1.1.1d.cmml" xref="S3.SS1.p2.11.m1.1.1"></share><apply id="S3.SS1.p2.11.m1.1.1.6.cmml" xref="S3.SS1.p2.11.m1.1.1.6"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m1.1.1.6.1.cmml" xref="S3.SS1.p2.11.m1.1.1.6">superscript</csymbol><ci id="S3.SS1.p2.11.m1.1.1.6.2.cmml" xref="S3.SS1.p2.11.m1.1.1.6.2">ℝ</ci><apply id="S3.SS1.p2.11.m1.1.1.6.3.cmml" xref="S3.SS1.p2.11.m1.1.1.6.3"><times id="S3.SS1.p2.11.m1.1.1.6.3.1.cmml" xref="S3.SS1.p2.11.m1.1.1.6.3.1"></times><ci id="S3.SS1.p2.11.m1.1.1.6.3.2.cmml" xref="S3.SS1.p2.11.m1.1.1.6.3.2">𝑤</ci><ci id="S3.SS1.p2.11.m1.1.1.6.3.3.cmml" xref="S3.SS1.p2.11.m1.1.1.6.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m1.1c">\boldsymbol{p}:=\left[p_{ij}\right]_{ij}\in\mathbb{R}^{w\times h}</annotation></semantics></math> which measures the relevance of entities given the question:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="p_{ij}:=||\boldsymbol{m}_{ij}||_{2}\in\mathbb{R}" display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><msub id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml">p</mi><mrow id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.3.3.2" xref="S3.E5.m1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.3.1" xref="S3.E5.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.3.3.3" xref="S3.E5.m1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo lspace="0.278em" rspace="0.278em" id="S3.E5.m1.1.1.4" xref="S3.E5.m1.1.1.4.cmml">:=</mo><msub id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml">𝒎</mi><mrow id="S3.E5.m1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E5.m1.1.1.5" xref="S3.E5.m1.1.1.5.cmml">∈</mo><mi id="S3.E5.m1.1.1.6" xref="S3.E5.m1.1.1.6.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><and id="S3.E5.m1.1.1a.cmml" xref="S3.E5.m1.1.1"></and><apply id="S3.E5.m1.1.1b.cmml" xref="S3.E5.m1.1.1"><csymbol cd="latexml" id="S3.E5.m1.1.1.4.cmml" xref="S3.E5.m1.1.1.4">assign</csymbol><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2">𝑝</ci><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><times id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3.1"></times><ci id="S3.E5.m1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.2">𝑖</ci><ci id="S3.E5.m1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2">𝒎</ci><apply id="S3.E5.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3"><times id="S3.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><cn type="integer" id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3">2</cn></apply></apply><apply id="S3.E5.m1.1.1c.cmml" xref="S3.E5.m1.1.1"><in id="S3.E5.m1.1.1.5.cmml" xref="S3.E5.m1.1.1.5"></in><share href="#S3.E5.m1.1.1.1.cmml" id="S3.E5.m1.1.1d.cmml" xref="S3.E5.m1.1.1"></share><ci id="S3.E5.m1.1.1.6.cmml" xref="S3.E5.m1.1.1.6">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">p_{ij}:=||\boldsymbol{m}_{ij}||_{2}\in\mathbb{R}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.19" class="ltx_p">where <math id="S3.SS1.p2.12.m1.1" class="ltx_math_unparsed" alttext="||\cdot||_{2}" display="inline"><semantics id="S3.SS1.p2.12.m1.1a"><mrow id="S3.SS1.p2.12.m1.1b"><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS1.p2.12.m1.1.1">|</mo><mo fence="false" stretchy="false" id="S3.SS1.p2.12.m1.1.2">|</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p2.12.m1.1.3">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS1.p2.12.m1.1.4">|</mo><msub id="S3.SS1.p2.12.m1.1.5"><mo fence="false" stretchy="false" id="S3.SS1.p2.12.m1.1.5.2">|</mo><mn id="S3.SS1.p2.12.m1.1.5.3">2</mn></msub></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m1.1c">||\cdot||_{2}</annotation></semantics></math> denotes <math id="S3.SS1.p2.13.m2.1" class="ltx_Math" alttext="L2" display="inline"><semantics id="S3.SS1.p2.13.m2.1a"><mrow id="S3.SS1.p2.13.m2.1.1" xref="S3.SS1.p2.13.m2.1.1.cmml"><mi id="S3.SS1.p2.13.m2.1.1.2" xref="S3.SS1.p2.13.m2.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.13.m2.1.1.1" xref="S3.SS1.p2.13.m2.1.1.1.cmml">​</mo><mn id="S3.SS1.p2.13.m2.1.1.3" xref="S3.SS1.p2.13.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m2.1b"><apply id="S3.SS1.p2.13.m2.1.1.cmml" xref="S3.SS1.p2.13.m2.1.1"><times id="S3.SS1.p2.13.m2.1.1.1.cmml" xref="S3.SS1.p2.13.m2.1.1.1"></times><ci id="S3.SS1.p2.13.m2.1.1.2.cmml" xref="S3.SS1.p2.13.m2.1.1.2">𝐿</ci><cn type="integer" id="S3.SS1.p2.13.m2.1.1.3.cmml" xref="S3.SS1.p2.13.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m2.1c">L2</annotation></semantics></math>-norm.
To select <math id="S3.SS1.p2.14.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p2.14.m3.1a"><mi id="S3.SS1.p2.14.m3.1.1" xref="S3.SS1.p2.14.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m3.1b"><ci id="S3.SS1.p2.14.m3.1.1.cmml" xref="S3.SS1.p2.14.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m3.1c">k</annotation></semantics></math> entities from <math id="S3.SS1.p2.15.m4.1" class="ltx_Math" alttext="\boldsymbol{m}" display="inline"><semantics id="S3.SS1.p2.15.m4.1a"><mi id="S3.SS1.p2.15.m4.1.1" xref="S3.SS1.p2.15.m4.1.1.cmml">𝒎</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m4.1b"><ci id="S3.SS1.p2.15.m4.1.1.cmml" xref="S3.SS1.p2.15.m4.1.1">𝒎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m4.1c">\boldsymbol{m}</annotation></semantics></math> for further processing, the indices of the top <math id="S3.SS1.p2.16.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p2.16.m5.1a"><mi id="S3.SS1.p2.16.m5.1.1" xref="S3.SS1.p2.16.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.16.m5.1b"><ci id="S3.SS1.p2.16.m5.1.1.cmml" xref="S3.SS1.p2.16.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.16.m5.1c">k</annotation></semantics></math> entries in <math id="S3.SS1.p2.17.m6.1" class="ltx_Math" alttext="\boldsymbol{p}" display="inline"><semantics id="S3.SS1.p2.17.m6.1a"><mi id="S3.SS1.p2.17.m6.1.1" xref="S3.SS1.p2.17.m6.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.17.m6.1b"><ci id="S3.SS1.p2.17.m6.1.1.cmml" xref="S3.SS1.p2.17.m6.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.17.m6.1c">\boldsymbol{p}</annotation></semantics></math>, denoted <math id="S3.SS1.p2.18.m7.3" class="ltx_Math" alttext="\boldsymbol{l}=\left[l_{1},\dots,l_{k}\right]" display="inline"><semantics id="S3.SS1.p2.18.m7.3a"><mrow id="S3.SS1.p2.18.m7.3.3" xref="S3.SS1.p2.18.m7.3.3.cmml"><mi id="S3.SS1.p2.18.m7.3.3.4" xref="S3.SS1.p2.18.m7.3.3.4.cmml">𝒍</mi><mo id="S3.SS1.p2.18.m7.3.3.3" xref="S3.SS1.p2.18.m7.3.3.3.cmml">=</mo><mrow id="S3.SS1.p2.18.m7.3.3.2.2" xref="S3.SS1.p2.18.m7.3.3.2.3.cmml"><mo id="S3.SS1.p2.18.m7.3.3.2.2.3" xref="S3.SS1.p2.18.m7.3.3.2.3.cmml">[</mo><msub id="S3.SS1.p2.18.m7.2.2.1.1.1" xref="S3.SS1.p2.18.m7.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.18.m7.2.2.1.1.1.2" xref="S3.SS1.p2.18.m7.2.2.1.1.1.2.cmml">l</mi><mn id="S3.SS1.p2.18.m7.2.2.1.1.1.3" xref="S3.SS1.p2.18.m7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.18.m7.3.3.2.2.4" xref="S3.SS1.p2.18.m7.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.18.m7.1.1" xref="S3.SS1.p2.18.m7.1.1.cmml">…</mi><mo id="S3.SS1.p2.18.m7.3.3.2.2.5" xref="S3.SS1.p2.18.m7.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p2.18.m7.3.3.2.2.2" xref="S3.SS1.p2.18.m7.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.18.m7.3.3.2.2.2.2" xref="S3.SS1.p2.18.m7.3.3.2.2.2.2.cmml">l</mi><mi id="S3.SS1.p2.18.m7.3.3.2.2.2.3" xref="S3.SS1.p2.18.m7.3.3.2.2.2.3.cmml">k</mi></msub><mo id="S3.SS1.p2.18.m7.3.3.2.2.6" xref="S3.SS1.p2.18.m7.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.18.m7.3b"><apply id="S3.SS1.p2.18.m7.3.3.cmml" xref="S3.SS1.p2.18.m7.3.3"><eq id="S3.SS1.p2.18.m7.3.3.3.cmml" xref="S3.SS1.p2.18.m7.3.3.3"></eq><ci id="S3.SS1.p2.18.m7.3.3.4.cmml" xref="S3.SS1.p2.18.m7.3.3.4">𝒍</ci><list id="S3.SS1.p2.18.m7.3.3.2.3.cmml" xref="S3.SS1.p2.18.m7.3.3.2.2"><apply id="S3.SS1.p2.18.m7.2.2.1.1.1.cmml" xref="S3.SS1.p2.18.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.18.m7.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.18.m7.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.18.m7.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.18.m7.2.2.1.1.1.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.18.m7.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.18.m7.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p2.18.m7.1.1.cmml" xref="S3.SS1.p2.18.m7.1.1">…</ci><apply id="S3.SS1.p2.18.m7.3.3.2.2.2.cmml" xref="S3.SS1.p2.18.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.18.m7.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.18.m7.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.18.m7.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.18.m7.3.3.2.2.2.2">𝑙</ci><ci id="S3.SS1.p2.18.m7.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.18.m7.3.3.2.2.2.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.18.m7.3c">\boldsymbol{l}=\left[l_{1},\dots,l_{k}\right]</annotation></semantics></math> are used to form <math id="S3.SS1.p2.19.m8.3" class="ltx_Math" alttext="\hat{\boldsymbol{m}}^{k}=\left[\boldsymbol{m}_{l_{1}},...,\boldsymbol{m}_{l_{k}}\right]\in\mathbb{R}^{k\times d}" display="inline"><semantics id="S3.SS1.p2.19.m8.3a"><mrow id="S3.SS1.p2.19.m8.3.3" xref="S3.SS1.p2.19.m8.3.3.cmml"><msup id="S3.SS1.p2.19.m8.3.3.4" xref="S3.SS1.p2.19.m8.3.3.4.cmml"><mover accent="true" id="S3.SS1.p2.19.m8.3.3.4.2" xref="S3.SS1.p2.19.m8.3.3.4.2.cmml"><mi id="S3.SS1.p2.19.m8.3.3.4.2.2" xref="S3.SS1.p2.19.m8.3.3.4.2.2.cmml">𝒎</mi><mo id="S3.SS1.p2.19.m8.3.3.4.2.1" xref="S3.SS1.p2.19.m8.3.3.4.2.1.cmml">^</mo></mover><mi id="S3.SS1.p2.19.m8.3.3.4.3" xref="S3.SS1.p2.19.m8.3.3.4.3.cmml">k</mi></msup><mo id="S3.SS1.p2.19.m8.3.3.5" xref="S3.SS1.p2.19.m8.3.3.5.cmml">=</mo><mrow id="S3.SS1.p2.19.m8.3.3.2.2" xref="S3.SS1.p2.19.m8.3.3.2.3.cmml"><mo id="S3.SS1.p2.19.m8.3.3.2.2.3" xref="S3.SS1.p2.19.m8.3.3.2.3.cmml">[</mo><msub id="S3.SS1.p2.19.m8.2.2.1.1.1" xref="S3.SS1.p2.19.m8.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.19.m8.2.2.1.1.1.2" xref="S3.SS1.p2.19.m8.2.2.1.1.1.2.cmml">𝒎</mi><msub id="S3.SS1.p2.19.m8.2.2.1.1.1.3" xref="S3.SS1.p2.19.m8.2.2.1.1.1.3.cmml"><mi id="S3.SS1.p2.19.m8.2.2.1.1.1.3.2" xref="S3.SS1.p2.19.m8.2.2.1.1.1.3.2.cmml">l</mi><mn id="S3.SS1.p2.19.m8.2.2.1.1.1.3.3" xref="S3.SS1.p2.19.m8.2.2.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S3.SS1.p2.19.m8.3.3.2.2.4" xref="S3.SS1.p2.19.m8.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.19.m8.1.1" xref="S3.SS1.p2.19.m8.1.1.cmml">…</mi><mo id="S3.SS1.p2.19.m8.3.3.2.2.5" xref="S3.SS1.p2.19.m8.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p2.19.m8.3.3.2.2.2" xref="S3.SS1.p2.19.m8.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.19.m8.3.3.2.2.2.2" xref="S3.SS1.p2.19.m8.3.3.2.2.2.2.cmml">𝒎</mi><msub id="S3.SS1.p2.19.m8.3.3.2.2.2.3" xref="S3.SS1.p2.19.m8.3.3.2.2.2.3.cmml"><mi id="S3.SS1.p2.19.m8.3.3.2.2.2.3.2" xref="S3.SS1.p2.19.m8.3.3.2.2.2.3.2.cmml">l</mi><mi id="S3.SS1.p2.19.m8.3.3.2.2.2.3.3" xref="S3.SS1.p2.19.m8.3.3.2.2.2.3.3.cmml">k</mi></msub></msub><mo id="S3.SS1.p2.19.m8.3.3.2.2.6" xref="S3.SS1.p2.19.m8.3.3.2.3.cmml">]</mo></mrow><mo id="S3.SS1.p2.19.m8.3.3.6" xref="S3.SS1.p2.19.m8.3.3.6.cmml">∈</mo><msup id="S3.SS1.p2.19.m8.3.3.7" xref="S3.SS1.p2.19.m8.3.3.7.cmml"><mi id="S3.SS1.p2.19.m8.3.3.7.2" xref="S3.SS1.p2.19.m8.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.19.m8.3.3.7.3" xref="S3.SS1.p2.19.m8.3.3.7.3.cmml"><mi id="S3.SS1.p2.19.m8.3.3.7.3.2" xref="S3.SS1.p2.19.m8.3.3.7.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.19.m8.3.3.7.3.1" xref="S3.SS1.p2.19.m8.3.3.7.3.1.cmml">×</mo><mi id="S3.SS1.p2.19.m8.3.3.7.3.3" xref="S3.SS1.p2.19.m8.3.3.7.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.19.m8.3b"><apply id="S3.SS1.p2.19.m8.3.3.cmml" xref="S3.SS1.p2.19.m8.3.3"><and id="S3.SS1.p2.19.m8.3.3a.cmml" xref="S3.SS1.p2.19.m8.3.3"></and><apply id="S3.SS1.p2.19.m8.3.3b.cmml" xref="S3.SS1.p2.19.m8.3.3"><eq id="S3.SS1.p2.19.m8.3.3.5.cmml" xref="S3.SS1.p2.19.m8.3.3.5"></eq><apply id="S3.SS1.p2.19.m8.3.3.4.cmml" xref="S3.SS1.p2.19.m8.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.19.m8.3.3.4.1.cmml" xref="S3.SS1.p2.19.m8.3.3.4">superscript</csymbol><apply id="S3.SS1.p2.19.m8.3.3.4.2.cmml" xref="S3.SS1.p2.19.m8.3.3.4.2"><ci id="S3.SS1.p2.19.m8.3.3.4.2.1.cmml" xref="S3.SS1.p2.19.m8.3.3.4.2.1">^</ci><ci id="S3.SS1.p2.19.m8.3.3.4.2.2.cmml" xref="S3.SS1.p2.19.m8.3.3.4.2.2">𝒎</ci></apply><ci id="S3.SS1.p2.19.m8.3.3.4.3.cmml" xref="S3.SS1.p2.19.m8.3.3.4.3">𝑘</ci></apply><list id="S3.SS1.p2.19.m8.3.3.2.3.cmml" xref="S3.SS1.p2.19.m8.3.3.2.2"><apply id="S3.SS1.p2.19.m8.2.2.1.1.1.cmml" xref="S3.SS1.p2.19.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.19.m8.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.19.m8.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.19.m8.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.19.m8.2.2.1.1.1.2">𝒎</ci><apply id="S3.SS1.p2.19.m8.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.19.m8.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.19.m8.2.2.1.1.1.3.1.cmml" xref="S3.SS1.p2.19.m8.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.19.m8.2.2.1.1.1.3.2.cmml" xref="S3.SS1.p2.19.m8.2.2.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.19.m8.2.2.1.1.1.3.3.cmml" xref="S3.SS1.p2.19.m8.2.2.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.19.m8.1.1.cmml" xref="S3.SS1.p2.19.m8.1.1">…</ci><apply id="S3.SS1.p2.19.m8.3.3.2.2.2.cmml" xref="S3.SS1.p2.19.m8.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.19.m8.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.19.m8.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.19.m8.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.19.m8.3.3.2.2.2.2">𝒎</ci><apply id="S3.SS1.p2.19.m8.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.19.m8.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.19.m8.3.3.2.2.2.3.1.cmml" xref="S3.SS1.p2.19.m8.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS1.p2.19.m8.3.3.2.2.2.3.2.cmml" xref="S3.SS1.p2.19.m8.3.3.2.2.2.3.2">𝑙</ci><ci id="S3.SS1.p2.19.m8.3.3.2.2.2.3.3.cmml" xref="S3.SS1.p2.19.m8.3.3.2.2.2.3.3">𝑘</ci></apply></apply></list></apply><apply id="S3.SS1.p2.19.m8.3.3c.cmml" xref="S3.SS1.p2.19.m8.3.3"><in id="S3.SS1.p2.19.m8.3.3.6.cmml" xref="S3.SS1.p2.19.m8.3.3.6"></in><share href="#S3.SS1.p2.19.m8.3.3.2.cmml" id="S3.SS1.p2.19.m8.3.3d.cmml" xref="S3.SS1.p2.19.m8.3.3"></share><apply id="S3.SS1.p2.19.m8.3.3.7.cmml" xref="S3.SS1.p2.19.m8.3.3.7"><csymbol cd="ambiguous" id="S3.SS1.p2.19.m8.3.3.7.1.cmml" xref="S3.SS1.p2.19.m8.3.3.7">superscript</csymbol><ci id="S3.SS1.p2.19.m8.3.3.7.2.cmml" xref="S3.SS1.p2.19.m8.3.3.7.2">ℝ</ci><apply id="S3.SS1.p2.19.m8.3.3.7.3.cmml" xref="S3.SS1.p2.19.m8.3.3.7.3"><times id="S3.SS1.p2.19.m8.3.3.7.3.1.cmml" xref="S3.SS1.p2.19.m8.3.3.7.3.1"></times><ci id="S3.SS1.p2.19.m8.3.3.7.3.2.cmml" xref="S3.SS1.p2.19.m8.3.3.7.3.2">𝑘</ci><ci id="S3.SS1.p2.19.m8.3.3.7.3.3.cmml" xref="S3.SS1.p2.19.m8.3.3.7.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.19.m8.3c">\hat{\boldsymbol{m}}^{k}=\left[\boldsymbol{m}_{l_{1}},...,\boldsymbol{m}_{l_{k}}\right]\in\mathbb{R}^{k\times d}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">This set of features is passed to the decoder module and gradients will flow back to the weights of the CNN/MLP through the selected features.
Our assumption is that important outputs of the CNN/MLP will tend to grow in norm, and therefore are likely to be selected. Intuitively if less useful features are selected, the gradients will push the norm of these features down, making them less likely to be selected again.
But there is nothing in our framework which explicitly incorporates this behavior into a loss.
Despite its simplicity, our experiments (Section <a href="#S4" title="4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) show the HAN is very competitive with canonical soft attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> while also offering interpretability and efficiency.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.6" class="ltx_p">Thus far, we have assumed that we can fix the number of features <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">k</annotation></semantics></math> that are passed through the attention mechanism.
However, it is likely that different questions require different spatial support within the image.
Thus, we also introduce a second approach which adaptively chooses the number of entities to attend to (termed Adaptive-HAN, or AdaHAN) as a function of the inputs, rather than using a fixed <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">k</annotation></semantics></math>.
The key idea is to make the presence vector <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="\boldsymbol{p}" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">\boldsymbol{p}</annotation></semantics></math> (the norm of the embedding at each spatial location) “compete” against a threshold <math id="S3.SS1.p4.4.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p4.4.m4.1a"><mi id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><ci id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">\tau</annotation></semantics></math>.
However, since the norm is unbounded from above, to avoid trivial solutions in which the network sets the presence vector very high and selects all entities, we apply a softmax operator to <math id="S3.SS1.p4.5.m5.1" class="ltx_Math" alttext="\boldsymbol{p}" display="inline"><semantics id="S3.SS1.p4.5.m5.1a"><mi id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><ci id="S3.SS1.p4.5.m5.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">\boldsymbol{p}</annotation></semantics></math>. We put both parts into the competition by only selecting those elements of <math id="S3.SS1.p4.6.m6.1" class="ltx_Math" alttext="\boldsymbol{m}" display="inline"><semantics id="S3.SS1.p4.6.m6.1a"><mi id="S3.SS1.p4.6.m6.1.1" xref="S3.SS1.p4.6.m6.1.1.cmml">𝒎</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m6.1b"><ci id="S3.SS1.p4.6.m6.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1">𝒎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m6.1c">\boldsymbol{m}</annotation></semantics></math> whose presence values exceed the threshold,</p>
<table id="S5.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.5" class="ltx_Math" alttext="\displaystyle\boldsymbol{\hat{m}}^{k}=\left[\boldsymbol{m}_{l_{1}},...,\boldsymbol{m}_{l_{k}}\right]\in\mathbb{R}^{k\times d}\text{\ , where }\{l_{i}:\text{softmax}(\boldsymbol{p}_{l_{i}})&gt;\tau\}" display="inline"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml"><msup id="S3.E6.m1.5.5.6" xref="S3.E6.m1.5.5.6.cmml"><mover accent="true" id="S3.E6.m1.5.5.6.2" xref="S3.E6.m1.5.5.6.2.cmml"><mi id="S3.E6.m1.5.5.6.2.2" xref="S3.E6.m1.5.5.6.2.2.cmml">𝒎</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E6.m1.5.5.6.2.1" xref="S3.E6.m1.5.5.6.2.1.cmml">^</mo></mover><mi id="S3.E6.m1.5.5.6.3" xref="S3.E6.m1.5.5.6.3.cmml">k</mi></msup><mo id="S3.E6.m1.5.5.7" xref="S3.E6.m1.5.5.7.cmml">=</mo><mrow id="S3.E6.m1.3.3.2.2" xref="S3.E6.m1.3.3.2.3.cmml"><mo id="S3.E6.m1.3.3.2.2.3" xref="S3.E6.m1.3.3.2.3.cmml">[</mo><msub id="S3.E6.m1.2.2.1.1.1" xref="S3.E6.m1.2.2.1.1.1.cmml"><mi id="S3.E6.m1.2.2.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.2.cmml">𝒎</mi><msub id="S3.E6.m1.2.2.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.1.3.2.cmml">l</mi><mn id="S3.E6.m1.2.2.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S3.E6.m1.3.3.2.2.4" xref="S3.E6.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">…</mi><mo id="S3.E6.m1.3.3.2.2.5" xref="S3.E6.m1.3.3.2.3.cmml">,</mo><msub id="S3.E6.m1.3.3.2.2.2" xref="S3.E6.m1.3.3.2.2.2.cmml"><mi id="S3.E6.m1.3.3.2.2.2.2" xref="S3.E6.m1.3.3.2.2.2.2.cmml">𝒎</mi><msub id="S3.E6.m1.3.3.2.2.2.3" xref="S3.E6.m1.3.3.2.2.2.3.cmml"><mi id="S3.E6.m1.3.3.2.2.2.3.2" xref="S3.E6.m1.3.3.2.2.2.3.2.cmml">l</mi><mi id="S3.E6.m1.3.3.2.2.2.3.3" xref="S3.E6.m1.3.3.2.2.2.3.3.cmml">k</mi></msub></msub><mo id="S3.E6.m1.3.3.2.2.6" xref="S3.E6.m1.3.3.2.3.cmml">]</mo></mrow><mo id="S3.E6.m1.5.5.8" xref="S3.E6.m1.5.5.8.cmml">∈</mo><mrow id="S3.E6.m1.5.5.4" xref="S3.E6.m1.5.5.4.cmml"><msup id="S3.E6.m1.5.5.4.4" xref="S3.E6.m1.5.5.4.4.cmml"><mi id="S3.E6.m1.5.5.4.4.2" xref="S3.E6.m1.5.5.4.4.2.cmml">ℝ</mi><mrow id="S3.E6.m1.5.5.4.4.3" xref="S3.E6.m1.5.5.4.4.3.cmml"><mi id="S3.E6.m1.5.5.4.4.3.2" xref="S3.E6.m1.5.5.4.4.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.5.5.4.4.3.1" xref="S3.E6.m1.5.5.4.4.3.1.cmml">×</mo><mi id="S3.E6.m1.5.5.4.4.3.3" xref="S3.E6.m1.5.5.4.4.3.3.cmml">d</mi></mrow></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.4.3" xref="S3.E6.m1.5.5.4.3.cmml">​</mo><mtext id="S3.E6.m1.5.5.4.5" xref="S3.E6.m1.5.5.4.5a.cmml"> , where </mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.4.3a" xref="S3.E6.m1.5.5.4.3.cmml">​</mo><mrow id="S3.E6.m1.5.5.4.2.2" xref="S3.E6.m1.5.5.4.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.4.2.2.3" xref="S3.E6.m1.5.5.4.2.3.1.cmml">{</mo><msub id="S3.E6.m1.4.4.3.1.1.1" xref="S3.E6.m1.4.4.3.1.1.1.cmml"><mi id="S3.E6.m1.4.4.3.1.1.1.2" xref="S3.E6.m1.4.4.3.1.1.1.2.cmml">l</mi><mi id="S3.E6.m1.4.4.3.1.1.1.3" xref="S3.E6.m1.4.4.3.1.1.1.3.cmml">i</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.E6.m1.5.5.4.2.2.4" xref="S3.E6.m1.5.5.4.2.3.1.cmml">:</mo><mrow id="S3.E6.m1.5.5.4.2.2.2" xref="S3.E6.m1.5.5.4.2.2.2.cmml"><mrow id="S3.E6.m1.5.5.4.2.2.2.1" xref="S3.E6.m1.5.5.4.2.2.2.1.cmml"><mtext id="S3.E6.m1.5.5.4.2.2.2.1.3" xref="S3.E6.m1.5.5.4.2.2.2.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.4.2.2.2.1.2" xref="S3.E6.m1.5.5.4.2.2.2.1.2.cmml">​</mo><mrow id="S3.E6.m1.5.5.4.2.2.2.1.1.1" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.4.2.2.2.1.1.1.2" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.5.5.4.2.2.2.1.1.1.1" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.cmml"><mi id="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.2" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.2.cmml">𝒑</mi><msub id="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3.cmml"><mi id="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3.2" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3.2.cmml">l</mi><mi id="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3.3" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo stretchy="false" id="S3.E6.m1.5.5.4.2.2.2.1.1.1.3" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.5.5.4.2.2.2.2" xref="S3.E6.m1.5.5.4.2.2.2.2.cmml">&gt;</mo><mi id="S3.E6.m1.5.5.4.2.2.2.3" xref="S3.E6.m1.5.5.4.2.2.2.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E6.m1.5.5.4.2.2.5" xref="S3.E6.m1.5.5.4.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5"><and id="S3.E6.m1.5.5a.cmml" xref="S3.E6.m1.5.5"></and><apply id="S3.E6.m1.5.5b.cmml" xref="S3.E6.m1.5.5"><eq id="S3.E6.m1.5.5.7.cmml" xref="S3.E6.m1.5.5.7"></eq><apply id="S3.E6.m1.5.5.6.cmml" xref="S3.E6.m1.5.5.6"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.6.1.cmml" xref="S3.E6.m1.5.5.6">superscript</csymbol><apply id="S3.E6.m1.5.5.6.2.cmml" xref="S3.E6.m1.5.5.6.2"><ci id="S3.E6.m1.5.5.6.2.1.cmml" xref="S3.E6.m1.5.5.6.2.1">bold-^</ci><ci id="S3.E6.m1.5.5.6.2.2.cmml" xref="S3.E6.m1.5.5.6.2.2">𝒎</ci></apply><ci id="S3.E6.m1.5.5.6.3.cmml" xref="S3.E6.m1.5.5.6.3">𝑘</ci></apply><list id="S3.E6.m1.3.3.2.3.cmml" xref="S3.E6.m1.3.3.2.2"><apply id="S3.E6.m1.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.2">𝒎</ci><apply id="S3.E6.m1.2.2.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.E6.m1.2.2.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">…</ci><apply id="S3.E6.m1.3.3.2.2.2.cmml" xref="S3.E6.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.2.2.2.1.cmml" xref="S3.E6.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.E6.m1.3.3.2.2.2.2.cmml" xref="S3.E6.m1.3.3.2.2.2.2">𝒎</ci><apply id="S3.E6.m1.3.3.2.2.2.3.cmml" xref="S3.E6.m1.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.2.2.2.3.1.cmml" xref="S3.E6.m1.3.3.2.2.2.3">subscript</csymbol><ci id="S3.E6.m1.3.3.2.2.2.3.2.cmml" xref="S3.E6.m1.3.3.2.2.2.3.2">𝑙</ci><ci id="S3.E6.m1.3.3.2.2.2.3.3.cmml" xref="S3.E6.m1.3.3.2.2.2.3.3">𝑘</ci></apply></apply></list></apply><apply id="S3.E6.m1.5.5c.cmml" xref="S3.E6.m1.5.5"><in id="S3.E6.m1.5.5.8.cmml" xref="S3.E6.m1.5.5.8"></in><share href="#S3.E6.m1.3.3.2.cmml" id="S3.E6.m1.5.5d.cmml" xref="S3.E6.m1.5.5"></share><apply id="S3.E6.m1.5.5.4.cmml" xref="S3.E6.m1.5.5.4"><times id="S3.E6.m1.5.5.4.3.cmml" xref="S3.E6.m1.5.5.4.3"></times><apply id="S3.E6.m1.5.5.4.4.cmml" xref="S3.E6.m1.5.5.4.4"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.4.4.1.cmml" xref="S3.E6.m1.5.5.4.4">superscript</csymbol><ci id="S3.E6.m1.5.5.4.4.2.cmml" xref="S3.E6.m1.5.5.4.4.2">ℝ</ci><apply id="S3.E6.m1.5.5.4.4.3.cmml" xref="S3.E6.m1.5.5.4.4.3"><times id="S3.E6.m1.5.5.4.4.3.1.cmml" xref="S3.E6.m1.5.5.4.4.3.1"></times><ci id="S3.E6.m1.5.5.4.4.3.2.cmml" xref="S3.E6.m1.5.5.4.4.3.2">𝑘</ci><ci id="S3.E6.m1.5.5.4.4.3.3.cmml" xref="S3.E6.m1.5.5.4.4.3.3">𝑑</ci></apply></apply><ci id="S3.E6.m1.5.5.4.5a.cmml" xref="S3.E6.m1.5.5.4.5"><mtext id="S3.E6.m1.5.5.4.5.cmml" xref="S3.E6.m1.5.5.4.5"> , where </mtext></ci><apply id="S3.E6.m1.5.5.4.2.3.cmml" xref="S3.E6.m1.5.5.4.2.2"><csymbol cd="latexml" id="S3.E6.m1.5.5.4.2.3.1.cmml" xref="S3.E6.m1.5.5.4.2.2.3">conditional-set</csymbol><apply id="S3.E6.m1.4.4.3.1.1.1.cmml" xref="S3.E6.m1.4.4.3.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.3.1.1.1.1.cmml" xref="S3.E6.m1.4.4.3.1.1.1">subscript</csymbol><ci id="S3.E6.m1.4.4.3.1.1.1.2.cmml" xref="S3.E6.m1.4.4.3.1.1.1.2">𝑙</ci><ci id="S3.E6.m1.4.4.3.1.1.1.3.cmml" xref="S3.E6.m1.4.4.3.1.1.1.3">𝑖</ci></apply><apply id="S3.E6.m1.5.5.4.2.2.2.cmml" xref="S3.E6.m1.5.5.4.2.2.2"><gt id="S3.E6.m1.5.5.4.2.2.2.2.cmml" xref="S3.E6.m1.5.5.4.2.2.2.2"></gt><apply id="S3.E6.m1.5.5.4.2.2.2.1.cmml" xref="S3.E6.m1.5.5.4.2.2.2.1"><times id="S3.E6.m1.5.5.4.2.2.2.1.2.cmml" xref="S3.E6.m1.5.5.4.2.2.2.1.2"></times><ci id="S3.E6.m1.5.5.4.2.2.2.1.3a.cmml" xref="S3.E6.m1.5.5.4.2.2.2.1.3"><mtext id="S3.E6.m1.5.5.4.2.2.2.1.3.cmml" xref="S3.E6.m1.5.5.4.2.2.2.1.3">softmax</mtext></ci><apply id="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.cmml" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.2">𝒑</ci><apply id="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3.cmml" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3.2">𝑙</ci><ci id="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E6.m1.5.5.4.2.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><ci id="S3.E6.m1.5.5.4.2.2.2.3.cmml" xref="S3.E6.m1.5.5.4.2.2.2.3">𝜏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">\displaystyle\boldsymbol{\hat{m}}^{k}=\left[\boldsymbol{m}_{l_{1}},...,\boldsymbol{m}_{l_{k}}\right]\in\mathbb{R}^{k\times d}\text{\ , where }\{l_{i}:\text{softmax}(\boldsymbol{p}_{l_{i}})&gt;\tau\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p4.17" class="ltx_p">Note that due to the properties of softmax, the competition is encouraged not only between both sides of the inequality, but also between the spatially distributed elements of the presence vector <math id="S3.SS1.p4.7.m1.1" class="ltx_Math" alttext="\boldsymbol{p}" display="inline"><semantics id="S3.SS1.p4.7.m1.1a"><mi id="S3.SS1.p4.7.m1.1.1" xref="S3.SS1.p4.7.m1.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.7.m1.1b"><ci id="S3.SS1.p4.7.m1.1.1.cmml" xref="S3.SS1.p4.7.m1.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.7.m1.1c">\boldsymbol{p}</annotation></semantics></math>.
Although <math id="S3.SS1.p4.8.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p4.8.m2.1a"><mi id="S3.SS1.p4.8.m2.1.1" xref="S3.SS1.p4.8.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.8.m2.1b"><ci id="S3.SS1.p4.8.m2.1.1.cmml" xref="S3.SS1.p4.8.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.8.m2.1c">\tau</annotation></semantics></math> could be chosen through the hyper-parameter selection, we decide to use <math id="S3.SS1.p4.9.m3.1" class="ltx_Math" alttext="\tau:=\frac{1}{w\cdot h}" display="inline"><semantics id="S3.SS1.p4.9.m3.1a"><mrow id="S3.SS1.p4.9.m3.1.1" xref="S3.SS1.p4.9.m3.1.1.cmml"><mi id="S3.SS1.p4.9.m3.1.1.2" xref="S3.SS1.p4.9.m3.1.1.2.cmml">τ</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p4.9.m3.1.1.1" xref="S3.SS1.p4.9.m3.1.1.1.cmml">:=</mo><mfrac id="S3.SS1.p4.9.m3.1.1.3" xref="S3.SS1.p4.9.m3.1.1.3.cmml"><mn id="S3.SS1.p4.9.m3.1.1.3.2" xref="S3.SS1.p4.9.m3.1.1.3.2.cmml">1</mn><mrow id="S3.SS1.p4.9.m3.1.1.3.3" xref="S3.SS1.p4.9.m3.1.1.3.3.cmml"><mi id="S3.SS1.p4.9.m3.1.1.3.3.2" xref="S3.SS1.p4.9.m3.1.1.3.3.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p4.9.m3.1.1.3.3.1" xref="S3.SS1.p4.9.m3.1.1.3.3.1.cmml">⋅</mo><mi id="S3.SS1.p4.9.m3.1.1.3.3.3" xref="S3.SS1.p4.9.m3.1.1.3.3.3.cmml">h</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.9.m3.1b"><apply id="S3.SS1.p4.9.m3.1.1.cmml" xref="S3.SS1.p4.9.m3.1.1"><csymbol cd="latexml" id="S3.SS1.p4.9.m3.1.1.1.cmml" xref="S3.SS1.p4.9.m3.1.1.1">assign</csymbol><ci id="S3.SS1.p4.9.m3.1.1.2.cmml" xref="S3.SS1.p4.9.m3.1.1.2">𝜏</ci><apply id="S3.SS1.p4.9.m3.1.1.3.cmml" xref="S3.SS1.p4.9.m3.1.1.3"><divide id="S3.SS1.p4.9.m3.1.1.3.1.cmml" xref="S3.SS1.p4.9.m3.1.1.3"></divide><cn type="integer" id="S3.SS1.p4.9.m3.1.1.3.2.cmml" xref="S3.SS1.p4.9.m3.1.1.3.2">1</cn><apply id="S3.SS1.p4.9.m3.1.1.3.3.cmml" xref="S3.SS1.p4.9.m3.1.1.3.3"><ci id="S3.SS1.p4.9.m3.1.1.3.3.1.cmml" xref="S3.SS1.p4.9.m3.1.1.3.3.1">⋅</ci><ci id="S3.SS1.p4.9.m3.1.1.3.3.2.cmml" xref="S3.SS1.p4.9.m3.1.1.3.3.2">𝑤</ci><ci id="S3.SS1.p4.9.m3.1.1.3.3.3.cmml" xref="S3.SS1.p4.9.m3.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.9.m3.1c">\tau:=\frac{1}{w\cdot h}</annotation></semantics></math> where <math id="S3.SS1.p4.10.m4.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p4.10.m4.1a"><mi id="S3.SS1.p4.10.m4.1.1" xref="S3.SS1.p4.10.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.10.m4.1b"><ci id="S3.SS1.p4.10.m4.1.1.cmml" xref="S3.SS1.p4.10.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.10.m4.1c">w</annotation></semantics></math> and <math id="S3.SS1.p4.11.m5.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS1.p4.11.m5.1a"><mi id="S3.SS1.p4.11.m5.1.1" xref="S3.SS1.p4.11.m5.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.11.m5.1b"><ci id="S3.SS1.p4.11.m5.1.1.cmml" xref="S3.SS1.p4.11.m5.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.11.m5.1c">h</annotation></semantics></math> are spatial dimensions of the input vector <math id="S3.SS1.p4.12.m6.1" class="ltx_Math" alttext="x_{ij}" display="inline"><semantics id="S3.SS1.p4.12.m6.1a"><msub id="S3.SS1.p4.12.m6.1.1" xref="S3.SS1.p4.12.m6.1.1.cmml"><mi id="S3.SS1.p4.12.m6.1.1.2" xref="S3.SS1.p4.12.m6.1.1.2.cmml">x</mi><mrow id="S3.SS1.p4.12.m6.1.1.3" xref="S3.SS1.p4.12.m6.1.1.3.cmml"><mi id="S3.SS1.p4.12.m6.1.1.3.2" xref="S3.SS1.p4.12.m6.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.12.m6.1.1.3.1" xref="S3.SS1.p4.12.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.12.m6.1.1.3.3" xref="S3.SS1.p4.12.m6.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.12.m6.1b"><apply id="S3.SS1.p4.12.m6.1.1.cmml" xref="S3.SS1.p4.12.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.12.m6.1.1.1.cmml" xref="S3.SS1.p4.12.m6.1.1">subscript</csymbol><ci id="S3.SS1.p4.12.m6.1.1.2.cmml" xref="S3.SS1.p4.12.m6.1.1.2">𝑥</ci><apply id="S3.SS1.p4.12.m6.1.1.3.cmml" xref="S3.SS1.p4.12.m6.1.1.3"><times id="S3.SS1.p4.12.m6.1.1.3.1.cmml" xref="S3.SS1.p4.12.m6.1.1.3.1"></times><ci id="S3.SS1.p4.12.m6.1.1.3.2.cmml" xref="S3.SS1.p4.12.m6.1.1.3.2">𝑖</ci><ci id="S3.SS1.p4.12.m6.1.1.3.3.cmml" xref="S3.SS1.p4.12.m6.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.12.m6.1c">x_{ij}</annotation></semantics></math>.
Such value for <math id="S3.SS1.p4.13.m7.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p4.13.m7.1a"><mi id="S3.SS1.p4.13.m7.1.1" xref="S3.SS1.p4.13.m7.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.13.m7.1b"><ci id="S3.SS1.p4.13.m7.1.1.cmml" xref="S3.SS1.p4.13.m7.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.13.m7.1c">\tau</annotation></semantics></math> has an interesting interpretation. If each spatial location of the input were equally important, we would sample the locations from a uniform probability distribution <math id="S3.SS1.p4.14.m8.1" class="ltx_Math" alttext="p(\cdot):=\tau=\frac{1}{w\cdot h}" display="inline"><semantics id="S3.SS1.p4.14.m8.1a"><mrow id="S3.SS1.p4.14.m8.1.2" xref="S3.SS1.p4.14.m8.1.2.cmml"><mrow id="S3.SS1.p4.14.m8.1.2.2" xref="S3.SS1.p4.14.m8.1.2.2.cmml"><mi id="S3.SS1.p4.14.m8.1.2.2.2" xref="S3.SS1.p4.14.m8.1.2.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.14.m8.1.2.2.1" xref="S3.SS1.p4.14.m8.1.2.2.1.cmml">​</mo><mrow id="S3.SS1.p4.14.m8.1.2.2.3.2" xref="S3.SS1.p4.14.m8.1.2.2.cmml"><mo stretchy="false" id="S3.SS1.p4.14.m8.1.2.2.3.2.1" xref="S3.SS1.p4.14.m8.1.2.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p4.14.m8.1.1" xref="S3.SS1.p4.14.m8.1.1.cmml">⋅</mo><mo rspace="0.278em" stretchy="false" id="S3.SS1.p4.14.m8.1.2.2.3.2.2" xref="S3.SS1.p4.14.m8.1.2.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.SS1.p4.14.m8.1.2.3" xref="S3.SS1.p4.14.m8.1.2.3.cmml">:=</mo><mi id="S3.SS1.p4.14.m8.1.2.4" xref="S3.SS1.p4.14.m8.1.2.4.cmml">τ</mi><mo id="S3.SS1.p4.14.m8.1.2.5" xref="S3.SS1.p4.14.m8.1.2.5.cmml">=</mo><mfrac id="S3.SS1.p4.14.m8.1.2.6" xref="S3.SS1.p4.14.m8.1.2.6.cmml"><mn id="S3.SS1.p4.14.m8.1.2.6.2" xref="S3.SS1.p4.14.m8.1.2.6.2.cmml">1</mn><mrow id="S3.SS1.p4.14.m8.1.2.6.3" xref="S3.SS1.p4.14.m8.1.2.6.3.cmml"><mi id="S3.SS1.p4.14.m8.1.2.6.3.2" xref="S3.SS1.p4.14.m8.1.2.6.3.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p4.14.m8.1.2.6.3.1" xref="S3.SS1.p4.14.m8.1.2.6.3.1.cmml">⋅</mo><mi id="S3.SS1.p4.14.m8.1.2.6.3.3" xref="S3.SS1.p4.14.m8.1.2.6.3.3.cmml">h</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.14.m8.1b"><apply id="S3.SS1.p4.14.m8.1.2.cmml" xref="S3.SS1.p4.14.m8.1.2"><and id="S3.SS1.p4.14.m8.1.2a.cmml" xref="S3.SS1.p4.14.m8.1.2"></and><apply id="S3.SS1.p4.14.m8.1.2b.cmml" xref="S3.SS1.p4.14.m8.1.2"><csymbol cd="latexml" id="S3.SS1.p4.14.m8.1.2.3.cmml" xref="S3.SS1.p4.14.m8.1.2.3">assign</csymbol><apply id="S3.SS1.p4.14.m8.1.2.2.cmml" xref="S3.SS1.p4.14.m8.1.2.2"><times id="S3.SS1.p4.14.m8.1.2.2.1.cmml" xref="S3.SS1.p4.14.m8.1.2.2.1"></times><ci id="S3.SS1.p4.14.m8.1.2.2.2.cmml" xref="S3.SS1.p4.14.m8.1.2.2.2">𝑝</ci><ci id="S3.SS1.p4.14.m8.1.1.cmml" xref="S3.SS1.p4.14.m8.1.1">⋅</ci></apply><ci id="S3.SS1.p4.14.m8.1.2.4.cmml" xref="S3.SS1.p4.14.m8.1.2.4">𝜏</ci></apply><apply id="S3.SS1.p4.14.m8.1.2c.cmml" xref="S3.SS1.p4.14.m8.1.2"><eq id="S3.SS1.p4.14.m8.1.2.5.cmml" xref="S3.SS1.p4.14.m8.1.2.5"></eq><share href="#S3.SS1.p4.14.m8.1.2.4.cmml" id="S3.SS1.p4.14.m8.1.2d.cmml" xref="S3.SS1.p4.14.m8.1.2"></share><apply id="S3.SS1.p4.14.m8.1.2.6.cmml" xref="S3.SS1.p4.14.m8.1.2.6"><divide id="S3.SS1.p4.14.m8.1.2.6.1.cmml" xref="S3.SS1.p4.14.m8.1.2.6"></divide><cn type="integer" id="S3.SS1.p4.14.m8.1.2.6.2.cmml" xref="S3.SS1.p4.14.m8.1.2.6.2">1</cn><apply id="S3.SS1.p4.14.m8.1.2.6.3.cmml" xref="S3.SS1.p4.14.m8.1.2.6.3"><ci id="S3.SS1.p4.14.m8.1.2.6.3.1.cmml" xref="S3.SS1.p4.14.m8.1.2.6.3.1">⋅</ci><ci id="S3.SS1.p4.14.m8.1.2.6.3.2.cmml" xref="S3.SS1.p4.14.m8.1.2.6.3.2">𝑤</ci><ci id="S3.SS1.p4.14.m8.1.2.6.3.3.cmml" xref="S3.SS1.p4.14.m8.1.2.6.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.14.m8.1c">p(\cdot):=\tau=\frac{1}{w\cdot h}</annotation></semantics></math>. This is equivalent to a probability distribution induced by the presence vector of a neural network with uniformly distributed spatial representation, i.e.<span id="S3.SS1.p4.17.1" class="ltx_text"></span> <math id="S3.SS1.p4.15.m9.1" class="ltx_Math" alttext="\tau=\text{softmax}(\boldsymbol{p}_{\text{uniform}})" display="inline"><semantics id="S3.SS1.p4.15.m9.1a"><mrow id="S3.SS1.p4.15.m9.1.1" xref="S3.SS1.p4.15.m9.1.1.cmml"><mi id="S3.SS1.p4.15.m9.1.1.3" xref="S3.SS1.p4.15.m9.1.1.3.cmml">τ</mi><mo id="S3.SS1.p4.15.m9.1.1.2" xref="S3.SS1.p4.15.m9.1.1.2.cmml">=</mo><mrow id="S3.SS1.p4.15.m9.1.1.1" xref="S3.SS1.p4.15.m9.1.1.1.cmml"><mtext id="S3.SS1.p4.15.m9.1.1.1.3" xref="S3.SS1.p4.15.m9.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.p4.15.m9.1.1.1.2" xref="S3.SS1.p4.15.m9.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p4.15.m9.1.1.1.1.1" xref="S3.SS1.p4.15.m9.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p4.15.m9.1.1.1.1.1.2" xref="S3.SS1.p4.15.m9.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p4.15.m9.1.1.1.1.1.1" xref="S3.SS1.p4.15.m9.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p4.15.m9.1.1.1.1.1.1.2" xref="S3.SS1.p4.15.m9.1.1.1.1.1.1.2.cmml">𝒑</mi><mtext id="S3.SS1.p4.15.m9.1.1.1.1.1.1.3" xref="S3.SS1.p4.15.m9.1.1.1.1.1.1.3a.cmml">uniform</mtext></msub><mo stretchy="false" id="S3.SS1.p4.15.m9.1.1.1.1.1.3" xref="S3.SS1.p4.15.m9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.15.m9.1b"><apply id="S3.SS1.p4.15.m9.1.1.cmml" xref="S3.SS1.p4.15.m9.1.1"><eq id="S3.SS1.p4.15.m9.1.1.2.cmml" xref="S3.SS1.p4.15.m9.1.1.2"></eq><ci id="S3.SS1.p4.15.m9.1.1.3.cmml" xref="S3.SS1.p4.15.m9.1.1.3">𝜏</ci><apply id="S3.SS1.p4.15.m9.1.1.1.cmml" xref="S3.SS1.p4.15.m9.1.1.1"><times id="S3.SS1.p4.15.m9.1.1.1.2.cmml" xref="S3.SS1.p4.15.m9.1.1.1.2"></times><ci id="S3.SS1.p4.15.m9.1.1.1.3a.cmml" xref="S3.SS1.p4.15.m9.1.1.1.3"><mtext id="S3.SS1.p4.15.m9.1.1.1.3.cmml" xref="S3.SS1.p4.15.m9.1.1.1.3">softmax</mtext></ci><apply id="S3.SS1.p4.15.m9.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.15.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.15.m9.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.15.m9.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p4.15.m9.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.15.m9.1.1.1.1.1.1.2">𝒑</ci><ci id="S3.SS1.p4.15.m9.1.1.1.1.1.1.3a.cmml" xref="S3.SS1.p4.15.m9.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.SS1.p4.15.m9.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.15.m9.1.1.1.1.1.1.3">uniform</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.15.m9.1c">\tau=\text{softmax}(\boldsymbol{p}_{\text{uniform}})</annotation></semantics></math>, and hence the trained network with the presence vector <math id="S3.SS1.p4.16.m10.1" class="ltx_Math" alttext="\boldsymbol{p}" display="inline"><semantics id="S3.SS1.p4.16.m10.1a"><mi id="S3.SS1.p4.16.m10.1.1" xref="S3.SS1.p4.16.m10.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.16.m10.1b"><ci id="S3.SS1.p4.16.m10.1.1.cmml" xref="S3.SS1.p4.16.m10.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.16.m10.1c">\boldsymbol{p}</annotation></semantics></math> has to “win” against the <math id="S3.SS1.p4.17.m11.1" class="ltx_Math" alttext="\boldsymbol{p}_{\text{uniform}}" display="inline"><semantics id="S3.SS1.p4.17.m11.1a"><msub id="S3.SS1.p4.17.m11.1.1" xref="S3.SS1.p4.17.m11.1.1.cmml"><mi id="S3.SS1.p4.17.m11.1.1.2" xref="S3.SS1.p4.17.m11.1.1.2.cmml">𝒑</mi><mtext id="S3.SS1.p4.17.m11.1.1.3" xref="S3.SS1.p4.17.m11.1.1.3a.cmml">uniform</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.17.m11.1b"><apply id="S3.SS1.p4.17.m11.1.1.cmml" xref="S3.SS1.p4.17.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.17.m11.1.1.1.cmml" xref="S3.SS1.p4.17.m11.1.1">subscript</csymbol><ci id="S3.SS1.p4.17.m11.1.1.2.cmml" xref="S3.SS1.p4.17.m11.1.1.2">𝒑</ci><ci id="S3.SS1.p4.17.m11.1.1.3a.cmml" xref="S3.SS1.p4.17.m11.1.1.3"><mtext mathsize="70%" id="S3.SS1.p4.17.m11.1.1.3.cmml" xref="S3.SS1.p4.17.m11.1.1.3">uniform</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.17.m11.1c">\boldsymbol{p}_{\text{uniform}}</annotation></semantics></math> of the random network in order to select right input features by shifting the probability mass accordingly.
It also naturally encourages higher selectivity as the increase in the probability mass at one location would result in decrease in another location.</p>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<p id="S3.SS1.p5.1" class="ltx_p">In contrast to the commonly used soft-attention mechanism, our approaches do not require extra learnable parameters. HAN requires a single extra but interpretable hyper-parameter: a fraction of input cells to use, which trades off speed for accuracy. AdaHAN requires no extra hyper-parameters.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Feature Aggregation</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.10" class="ltx_p"><span id="S3.SS2.p1.10.1" class="ltx_text ltx_font_bold">Sum Pooling.</span> A simple way to reduce the set of feature vectors after attention is to sum pool them into a constant length vector.
In the case of a soft attention module with an attention weight vector <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">w</annotation></semantics></math>, it is straightforward to compute a pooled vector as <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\sum_{ij}w_{ij}\boldsymbol{x}_{ij}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msub id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml"><mo id="S3.SS2.p1.2.m2.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.2.cmml">∑</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.1.3.1" xref="S3.SS2.p1.2.m2.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.2.m2.1.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.1.3.3.cmml">j</mi></mrow></msub><mrow id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml"><msub id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.2.cmml">w</mi><mrow id="S3.SS2.p1.2.m2.1.1.2.2.3" xref="S3.SS2.p1.2.m2.1.1.2.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2.3.2" xref="S3.SS2.p1.2.m2.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.2.2.3.1" xref="S3.SS2.p1.2.m2.1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.2.m2.1.1.2.2.3.3" xref="S3.SS2.p1.2.m2.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.2.1" xref="S3.SS2.p1.2.m2.1.1.2.1.cmml">​</mo><msub id="S3.SS2.p1.2.m2.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.3.2" xref="S3.SS2.p1.2.m2.1.1.2.3.2.cmml">𝒙</mi><mrow id="S3.SS2.p1.2.m2.1.1.2.3.3" xref="S3.SS2.p1.2.m2.1.1.2.3.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.3.3.2" xref="S3.SS2.p1.2.m2.1.1.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.2.3.3.1" xref="S3.SS2.p1.2.m2.1.1.2.3.3.1.cmml">​</mo><mi id="S3.SS2.p1.2.m2.1.1.2.3.3.3" xref="S3.SS2.p1.2.m2.1.1.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><apply id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1">subscript</csymbol><sum id="S3.SS2.p1.2.m2.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.2"></sum><apply id="S3.SS2.p1.2.m2.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3"><times id="S3.SS2.p1.2.m2.1.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.2.m2.1.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"><times id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2.1"></times><apply id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2.2">𝑤</ci><apply id="S3.SS2.p1.2.m2.1.1.2.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2.3"><times id="S3.SS2.p1.2.m2.1.1.2.2.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.2.2.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2.3.2">𝑖</ci><ci id="S3.SS2.p1.2.m2.1.1.2.2.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.2">𝒙</ci><apply id="S3.SS2.p1.2.m2.1.1.2.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.3"><times id="S3.SS2.p1.2.m2.1.1.2.3.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.2.3.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.3.2">𝑖</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\sum_{ij}w_{ij}\boldsymbol{x}_{ij}</annotation></semantics></math>.
Given features selected with hard attention, an analogous pooling can be written as <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\sum_{\kappa=1}^{k}\boldsymbol{m}_{l_{\kappa}}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><msubsup id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml"><mo id="S3.SS2.p1.3.m3.1.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p1.3.m3.1.1.1.2.3" xref="S3.SS2.p1.3.m3.1.1.1.2.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.1.2.3.2" xref="S3.SS2.p1.3.m3.1.1.1.2.3.2.cmml">κ</mi><mo id="S3.SS2.p1.3.m3.1.1.1.2.3.1" xref="S3.SS2.p1.3.m3.1.1.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p1.3.m3.1.1.1.2.3.3" xref="S3.SS2.p1.3.m3.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p1.3.m3.1.1.1.3" xref="S3.SS2.p1.3.m3.1.1.1.3.cmml">k</mi></msubsup><msub id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">𝒎</mi><msub id="S3.SS2.p1.3.m3.1.1.2.3" xref="S3.SS2.p1.3.m3.1.1.2.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.3.2" xref="S3.SS2.p1.3.m3.1.1.2.3.2.cmml">l</mi><mi id="S3.SS2.p1.3.m3.1.1.2.3.3" xref="S3.SS2.p1.3.m3.1.1.2.3.3.cmml">κ</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><apply id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.3.m3.1.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1">subscript</csymbol><sum id="S3.SS2.p1.3.m3.1.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.1.2.2"></sum><apply id="S3.SS2.p1.3.m3.1.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.1.2.3"><eq id="S3.SS2.p1.3.m3.1.1.1.2.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1.2.3.1"></eq><ci id="S3.SS2.p1.3.m3.1.1.1.2.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.1.2.3.2">𝜅</ci><cn type="integer" id="S3.SS2.p1.3.m3.1.1.1.2.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p1.3.m3.1.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.1.3">𝑘</ci></apply><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">𝒎</ci><apply id="S3.SS2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.2.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3.2">𝑙</ci><ci id="S3.SS2.p1.3.m3.1.1.2.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3.3">𝜅</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\sum_{\kappa=1}^{k}\boldsymbol{m}_{l_{\kappa}}</annotation></semantics></math>.

<br class="ltx_break"><span id="S3.SS2.p1.10.2" class="ltx_text ltx_font_bold">Non-local Pairwise Operator.</span>
To improve on sum pooling, we explore an approach which performs reasoning through non-local and pairwise computations, one of a family of similar architectures which has shown promising results for question-answering and video understanding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.
An important aspect of these non-local pairwise methods is that the computation is quadratic in the number of features, and thus hard attention can provide significant computational savings.
Given some set of embedding vectors (such as the spatial cells of the output of a convolutional layer) <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\boldsymbol{x}_{ij}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">𝒙</mi><mrow id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m4.1.1.3.1" xref="S3.SS2.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝒙</ci><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><times id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.1"></times><ci id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\boldsymbol{x}_{ij}</annotation></semantics></math>, one can use three simple linear projections to produce a matrix of queries, <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\boldsymbol{q}_{ij}:=\boldsymbol{W}_{q}\boldsymbol{x}_{ij}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><msub id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2.2" xref="S3.SS2.p1.5.m5.1.1.2.2.cmml">𝒒</mi><mrow id="S3.SS2.p1.5.m5.1.1.2.3" xref="S3.SS2.p1.5.m5.1.1.2.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2.3.2" xref="S3.SS2.p1.5.m5.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.2.3.1" xref="S3.SS2.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.5.m5.1.1.2.3.3" xref="S3.SS2.p1.5.m5.1.1.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p1.5.m5.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.cmml">:=</mo><mrow id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml"><msub id="S3.SS2.p1.5.m5.1.1.3.2" xref="S3.SS2.p1.5.m5.1.1.3.2.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.2.2" xref="S3.SS2.p1.5.m5.1.1.3.2.2.cmml">𝑾</mi><mi id="S3.SS2.p1.5.m5.1.1.3.2.3" xref="S3.SS2.p1.5.m5.1.1.3.2.3.cmml">q</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.3.1" xref="S3.SS2.p1.5.m5.1.1.3.1.cmml">​</mo><msub id="S3.SS2.p1.5.m5.1.1.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.3.2" xref="S3.SS2.p1.5.m5.1.1.3.3.2.cmml">𝒙</mi><mrow id="S3.SS2.p1.5.m5.1.1.3.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.3.3.2" xref="S3.SS2.p1.5.m5.1.1.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.3.3.3.1" xref="S3.SS2.p1.5.m5.1.1.3.3.3.1.cmml">​</mo><mi id="S3.SS2.p1.5.m5.1.1.3.3.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="latexml" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1">assign</csymbol><apply id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2">𝒒</ci><apply id="S3.SS2.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3"><times id="S3.SS2.p1.5.m5.1.1.2.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3.1"></times><ci id="S3.SS2.p1.5.m5.1.1.2.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3.2">𝑖</ci><ci id="S3.SS2.p1.5.m5.1.1.2.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><times id="S3.SS2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3.1"></times><apply id="S3.SS2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.3.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.3.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2.2">𝑾</ci><ci id="S3.SS2.p1.5.m5.1.1.3.2.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2.3">𝑞</ci></apply><apply id="S3.SS2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.3.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.3.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3.2">𝒙</ci><apply id="S3.SS2.p1.5.m5.1.1.3.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3.3"><times id="S3.SS2.p1.5.m5.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3.3.1"></times><ci id="S3.SS2.p1.5.m5.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.p1.5.m5.1.1.3.3.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\boldsymbol{q}_{ij}:=\boldsymbol{W}_{q}\boldsymbol{x}_{ij}</annotation></semantics></math>, keys, <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\boldsymbol{k}_{ij}:=\boldsymbol{W}_{k}\boldsymbol{x}_{ij}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mrow id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><msub id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2.2" xref="S3.SS2.p1.6.m6.1.1.2.2.cmml">𝒌</mi><mrow id="S3.SS2.p1.6.m6.1.1.2.3" xref="S3.SS2.p1.6.m6.1.1.2.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2.3.2" xref="S3.SS2.p1.6.m6.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.1.1.2.3.1" xref="S3.SS2.p1.6.m6.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.6.m6.1.1.2.3.3" xref="S3.SS2.p1.6.m6.1.1.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p1.6.m6.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.cmml">:=</mo><mrow id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml"><msub id="S3.SS2.p1.6.m6.1.1.3.2" xref="S3.SS2.p1.6.m6.1.1.3.2.cmml"><mi id="S3.SS2.p1.6.m6.1.1.3.2.2" xref="S3.SS2.p1.6.m6.1.1.3.2.2.cmml">𝑾</mi><mi id="S3.SS2.p1.6.m6.1.1.3.2.3" xref="S3.SS2.p1.6.m6.1.1.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.1.1.3.1" xref="S3.SS2.p1.6.m6.1.1.3.1.cmml">​</mo><msub id="S3.SS2.p1.6.m6.1.1.3.3" xref="S3.SS2.p1.6.m6.1.1.3.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.3.3.2" xref="S3.SS2.p1.6.m6.1.1.3.3.2.cmml">𝒙</mi><mrow id="S3.SS2.p1.6.m6.1.1.3.3.3" xref="S3.SS2.p1.6.m6.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.3.3.3.2" xref="S3.SS2.p1.6.m6.1.1.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.1.1.3.3.3.1" xref="S3.SS2.p1.6.m6.1.1.3.3.3.1.cmml">​</mo><mi id="S3.SS2.p1.6.m6.1.1.3.3.3.3" xref="S3.SS2.p1.6.m6.1.1.3.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="latexml" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1">assign</csymbol><apply id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2.2">𝒌</ci><apply id="S3.SS2.p1.6.m6.1.1.2.3.cmml" xref="S3.SS2.p1.6.m6.1.1.2.3"><times id="S3.SS2.p1.6.m6.1.1.2.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.2.3.1"></times><ci id="S3.SS2.p1.6.m6.1.1.2.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2.3.2">𝑖</ci><ci id="S3.SS2.p1.6.m6.1.1.2.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3"><times id="S3.SS2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.3.1"></times><apply id="S3.SS2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.3.2.1.cmml" xref="S3.SS2.p1.6.m6.1.1.3.2">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.3.2.2.cmml" xref="S3.SS2.p1.6.m6.1.1.3.2.2">𝑾</ci><ci id="S3.SS2.p1.6.m6.1.1.3.2.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3.2.3">𝑘</ci></apply><apply id="S3.SS2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.3.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.3.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3.2">𝒙</ci><apply id="S3.SS2.p1.6.m6.1.1.3.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3.3"><times id="S3.SS2.p1.6.m6.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3.3.1"></times><ci id="S3.SS2.p1.6.m6.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.p1.6.m6.1.1.3.3.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\boldsymbol{k}_{ij}:=\boldsymbol{W}_{k}\boldsymbol{x}_{ij}</annotation></semantics></math>, and values, <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\boldsymbol{v}_{ij}=\boldsymbol{W}_{v}\boldsymbol{x}_{ij}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mrow id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><msub id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2.2" xref="S3.SS2.p1.7.m7.1.1.2.2.cmml">𝒗</mi><mrow id="S3.SS2.p1.7.m7.1.1.2.3" xref="S3.SS2.p1.7.m7.1.1.2.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2.3.2" xref="S3.SS2.p1.7.m7.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m7.1.1.2.3.1" xref="S3.SS2.p1.7.m7.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.7.m7.1.1.2.3.3" xref="S3.SS2.p1.7.m7.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS2.p1.7.m7.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.cmml">=</mo><mrow id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml"><msub id="S3.SS2.p1.7.m7.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.3.2.cmml"><mi id="S3.SS2.p1.7.m7.1.1.3.2.2" xref="S3.SS2.p1.7.m7.1.1.3.2.2.cmml">𝑾</mi><mi id="S3.SS2.p1.7.m7.1.1.3.2.3" xref="S3.SS2.p1.7.m7.1.1.3.2.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m7.1.1.3.1" xref="S3.SS2.p1.7.m7.1.1.3.1.cmml">​</mo><msub id="S3.SS2.p1.7.m7.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.3.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.3.3.2" xref="S3.SS2.p1.7.m7.1.1.3.3.2.cmml">𝒙</mi><mrow id="S3.SS2.p1.7.m7.1.1.3.3.3" xref="S3.SS2.p1.7.m7.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.3.3.3.2" xref="S3.SS2.p1.7.m7.1.1.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m7.1.1.3.3.3.1" xref="S3.SS2.p1.7.m7.1.1.3.3.3.1.cmml">​</mo><mi id="S3.SS2.p1.7.m7.1.1.3.3.3.3" xref="S3.SS2.p1.7.m7.1.1.3.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><eq id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1"></eq><apply id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.2.1.cmml" xref="S3.SS2.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2.2">𝒗</ci><apply id="S3.SS2.p1.7.m7.1.1.2.3.cmml" xref="S3.SS2.p1.7.m7.1.1.2.3"><times id="S3.SS2.p1.7.m7.1.1.2.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.2.3.1"></times><ci id="S3.SS2.p1.7.m7.1.1.2.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2.3.2">𝑖</ci><ci id="S3.SS2.p1.7.m7.1.1.2.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3"><times id="S3.SS2.p1.7.m7.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3.1"></times><apply id="S3.SS2.p1.7.m7.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.3.2.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.3.2.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2.2">𝑾</ci><ci id="S3.SS2.p1.7.m7.1.1.3.2.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2.3">𝑣</ci></apply><apply id="S3.SS2.p1.7.m7.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.3.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.3.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3.2">𝒙</ci><apply id="S3.SS2.p1.7.m7.1.1.3.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3.3"><times id="S3.SS2.p1.7.m7.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3.3.1"></times><ci id="S3.SS2.p1.7.m7.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.p1.7.m7.1.1.3.3.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\boldsymbol{v}_{ij}=\boldsymbol{W}_{v}\boldsymbol{x}_{ij}</annotation></semantics></math> at each spatial location.
Then, for each spatial location <math id="S3.SS2.p1.8.m8.2" class="ltx_Math" alttext="i,j" display="inline"><semantics id="S3.SS2.p1.8.m8.2a"><mrow id="S3.SS2.p1.8.m8.2.3.2" xref="S3.SS2.p1.8.m8.2.3.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">i</mi><mo id="S3.SS2.p1.8.m8.2.3.2.1" xref="S3.SS2.p1.8.m8.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.8.m8.2.2" xref="S3.SS2.p1.8.m8.2.2.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.2b"><list id="S3.SS2.p1.8.m8.2.3.1.cmml" xref="S3.SS2.p1.8.m8.2.3.2"><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">𝑖</ci><ci id="S3.SS2.p1.8.m8.2.2.cmml" xref="S3.SS2.p1.8.m8.2.2">𝑗</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.2c">i,j</annotation></semantics></math>, we compare the query <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="q_{ij}" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><msub id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><mi id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml">q</mi><mrow id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml"><mi id="S3.SS2.p1.9.m9.1.1.3.2" xref="S3.SS2.p1.9.m9.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.9.m9.1.1.3.1" xref="S3.SS2.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.9.m9.1.1.3.3" xref="S3.SS2.p1.9.m9.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2">𝑞</ci><apply id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3"><times id="S3.SS2.p1.9.m9.1.1.3.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.1"></times><ci id="S3.SS2.p1.9.m9.1.1.3.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.9.m9.1.1.3.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">q_{ij}</annotation></semantics></math> with the keys at all other locations, and sum the values <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><mi id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><ci id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">v</annotation></semantics></math> weighted by the similarity.
Mathematically, we compute</p>
<table id="S5.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\displaystyle\tilde{\boldsymbol{x}}_{lk}=\sum_{ij}\text{softmax}\left(\boldsymbol{q}_{lk}^{T}\boldsymbol{k}_{ij}\right)\boldsymbol{v}_{ij}" display="inline"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><msub id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml"><mover accent="true" id="S3.E7.m1.1.1.3.2" xref="S3.E7.m1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.3.2.2" xref="S3.E7.m1.1.1.3.2.2.cmml">𝒙</mi><mo id="S3.E7.m1.1.1.3.2.1" xref="S3.E7.m1.1.1.3.2.1.cmml">~</mo></mover><mrow id="S3.E7.m1.1.1.3.3" xref="S3.E7.m1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.3.3.2" xref="S3.E7.m1.1.1.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.3.3.1" xref="S3.E7.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.3.3.3" xref="S3.E7.m1.1.1.3.3.3.cmml">k</mi></mrow></msub><mo id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.2.cmml"><munder id="S3.E7.m1.1.1.1.2a" xref="S3.E7.m1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E7.m1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.1.1.1.2.3.2" xref="S3.E7.m1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.2.3.1" xref="S3.E7.m1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.2.3.3" xref="S3.E7.m1.1.1.1.2.3.3.cmml">j</mi></mrow></munder></mstyle><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mtext id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E7.m1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.cmml">𝒒</mi><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.cmml">k</mi></mrow><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.3.2.cmml">𝒌</mi><mrow id="S3.E7.m1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.3.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.3.3.1" xref="S3.E7.m1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1.3.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.2a" xref="S3.E7.m1.1.1.1.1.2.cmml">​</mo><msub id="S3.E7.m1.1.1.1.1.4" xref="S3.E7.m1.1.1.1.1.4.cmml"><mi id="S3.E7.m1.1.1.1.1.4.2" xref="S3.E7.m1.1.1.1.1.4.2.cmml">𝒗</mi><mrow id="S3.E7.m1.1.1.1.1.4.3" xref="S3.E7.m1.1.1.1.1.4.3.cmml"><mi id="S3.E7.m1.1.1.1.1.4.3.2" xref="S3.E7.m1.1.1.1.1.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.4.3.1" xref="S3.E7.m1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.4.3.3" xref="S3.E7.m1.1.1.1.1.4.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><eq id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2"></eq><apply id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.3">subscript</csymbol><apply id="S3.E7.m1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.3.2"><ci id="S3.E7.m1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.3.2.1">~</ci><ci id="S3.E7.m1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.3.2.2">𝒙</ci></apply><apply id="S3.E7.m1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.3.3"><times id="S3.E7.m1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.3.3.1"></times><ci id="S3.E7.m1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.3.3.2">𝑙</ci><ci id="S3.E7.m1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><apply id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.2.2"></sum><apply id="S3.E7.m1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.2.3"><times id="S3.E7.m1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.1.1.1.2.3.1"></times><ci id="S3.E7.m1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E7.m1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.1.3a.cmml" xref="S3.E7.m1.1.1.1.1.3"><mtext id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3">softmax</mtext></ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1"></times><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2">𝒒</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3"><times id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2">𝑙</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3.2">𝒌</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3.3"><times id="S3.E7.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E7.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E7.m1.1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.4.1.cmml" xref="S3.E7.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.4.2.cmml" xref="S3.E7.m1.1.1.1.1.4.2">𝒗</ci><apply id="S3.E7.m1.1.1.1.1.4.3.cmml" xref="S3.E7.m1.1.1.1.1.4.3"><times id="S3.E7.m1.1.1.1.1.4.3.1.cmml" xref="S3.E7.m1.1.1.1.1.4.3.1"></times><ci id="S3.E7.m1.1.1.1.1.4.3.2.cmml" xref="S3.E7.m1.1.1.1.1.4.3.2">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.4.3.3.cmml" xref="S3.E7.m1.1.1.1.1.4.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle\tilde{\boldsymbol{x}}_{lk}=\sum_{ij}\text{softmax}\left(\boldsymbol{q}_{lk}^{T}\boldsymbol{k}_{ij}\right)\boldsymbol{v}_{ij}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.12" class="ltx_p">Here, the softmax operates over all <math id="S3.SS2.p1.11.m1.2" class="ltx_Math" alttext="i,j" display="inline"><semantics id="S3.SS2.p1.11.m1.2a"><mrow id="S3.SS2.p1.11.m1.2.3.2" xref="S3.SS2.p1.11.m1.2.3.1.cmml"><mi id="S3.SS2.p1.11.m1.1.1" xref="S3.SS2.p1.11.m1.1.1.cmml">i</mi><mo id="S3.SS2.p1.11.m1.2.3.2.1" xref="S3.SS2.p1.11.m1.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.11.m1.2.2" xref="S3.SS2.p1.11.m1.2.2.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m1.2b"><list id="S3.SS2.p1.11.m1.2.3.1.cmml" xref="S3.SS2.p1.11.m1.2.3.2"><ci id="S3.SS2.p1.11.m1.1.1.cmml" xref="S3.SS2.p1.11.m1.1.1">𝑖</ci><ci id="S3.SS2.p1.11.m1.2.2.cmml" xref="S3.SS2.p1.11.m1.2.2">𝑗</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m1.2c">i,j</annotation></semantics></math> locations. The final representation of the input is computed by summarizing all <math id="S3.SS2.p1.12.m2.1" class="ltx_Math" alttext="\tilde{\boldsymbol{x}}_{lk}" display="inline"><semantics id="S3.SS2.p1.12.m2.1a"><msub id="S3.SS2.p1.12.m2.1.1" xref="S3.SS2.p1.12.m2.1.1.cmml"><mover accent="true" id="S3.SS2.p1.12.m2.1.1.2" xref="S3.SS2.p1.12.m2.1.1.2.cmml"><mi id="S3.SS2.p1.12.m2.1.1.2.2" xref="S3.SS2.p1.12.m2.1.1.2.2.cmml">𝒙</mi><mo id="S3.SS2.p1.12.m2.1.1.2.1" xref="S3.SS2.p1.12.m2.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS2.p1.12.m2.1.1.3" xref="S3.SS2.p1.12.m2.1.1.3.cmml"><mi id="S3.SS2.p1.12.m2.1.1.3.2" xref="S3.SS2.p1.12.m2.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.12.m2.1.1.3.1" xref="S3.SS2.p1.12.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.12.m2.1.1.3.3" xref="S3.SS2.p1.12.m2.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m2.1b"><apply id="S3.SS2.p1.12.m2.1.1.cmml" xref="S3.SS2.p1.12.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m2.1.1.1.cmml" xref="S3.SS2.p1.12.m2.1.1">subscript</csymbol><apply id="S3.SS2.p1.12.m2.1.1.2.cmml" xref="S3.SS2.p1.12.m2.1.1.2"><ci id="S3.SS2.p1.12.m2.1.1.2.1.cmml" xref="S3.SS2.p1.12.m2.1.1.2.1">~</ci><ci id="S3.SS2.p1.12.m2.1.1.2.2.cmml" xref="S3.SS2.p1.12.m2.1.1.2.2">𝒙</ci></apply><apply id="S3.SS2.p1.12.m2.1.1.3.cmml" xref="S3.SS2.p1.12.m2.1.1.3"><times id="S3.SS2.p1.12.m2.1.1.3.1.cmml" xref="S3.SS2.p1.12.m2.1.1.3.1"></times><ci id="S3.SS2.p1.12.m2.1.1.3.2.cmml" xref="S3.SS2.p1.12.m2.1.1.3.2">𝑙</ci><ci id="S3.SS2.p1.12.m2.1.1.3.3.cmml" xref="S3.SS2.p1.12.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m2.1c">\tilde{\boldsymbol{x}}_{lk}</annotation></semantics></math> representations, e.g. we use sum-pooling to achieve this goal.
Thus, the mechanism computes non-local <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> pairwise relations between embeddings, independent of spatial or temporal proximity.
The separation between keys, queries, and values allows semantic information about each object to remain separated from the information that binds objects together across space.
The result is an effective, if somewhat expensive, spatial reasoning mechanism.
Although expensive, similar mechanism has been shown useful in various tasks, from synthetic visual question <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, to machine translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, to video recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.
Hard attention can help to reduce the set of comparisons that must be considered, and thus we aim to test whether the features selected by hard attention are compatible with this operator.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">To show the importance of hard attention for Visual QA, we first compare HAN to existing soft attention (SAN) architectures on VQA-CP v2, and exploring the effect of varying degrees of hard attention by directly controlling the number of attended spatial cells in the convolutional map.
We then examine AdaHAN, which adaptively chooses the number of attended cells, and briefly investigate the effect of network depth and pretraining.
Finally, we present qualitative results, and also provide results on CLEVR to show the method’s generality.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">VQA-CP v2.</span> This dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
consists of about 121K (98K) images, 438K (220K) questions, and 4.4M (2.2M) answers in the train (test) set; and it is created so that the distribution of the answers between train and test splits differ, and hence the models cannot excessively rely on the language prior <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. As expected, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> show that performance of all Visual QA approaches they tested drops significantly between train to test sets.
The dataset provides a standard train-test split, and also breaks questions into different question types: those where the answer is yes/no, those where the answer is a number, and those where the answer is something else. Thus, we report accuracy on each question type as well as the overall accuracy for each network architecture.

<br class="ltx_break"><span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_bold">CLEVR.</span> This synthetic dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> consists of 100K images of 3D rendered objects like spheres and cylinders, and roughly 1m questions that were automatically generated with a procedural engine. While the visual task is relatively simple, solving this dataset requires reasoning over complex relationships between many objects.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Effect of Hard Attention</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.8" class="ltx_p">We begin with the most basic hard attention architecture, which applies hard attention and then does sum pooling over the attended cells, followed by a small MLP.
For each experiment, we take the top <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">k</annotation></semantics></math> cells, out of <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mn id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><cn type="integer" id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">100</annotation></semantics></math>, according to our <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="L2" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">​</mo><mn id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><times id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></times><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝐿</ci><cn type="integer" id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">L2</annotation></semantics></math>-norm criterion, where <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">k</annotation></semantics></math> ranges from <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mn id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><cn type="integer" id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">16</annotation></semantics></math> to <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mn id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><cn type="integer" id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">100</annotation></semantics></math> (with <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><mn id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><cn type="integer" id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">100</annotation></semantics></math>, there is no attention, and the whole image is summed).
Results are shown in the top of Table <a href="#S4.T1" title="Table 1 ‣ 4.2 Effect of Hard Attention ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
Considering that the hard attention
selects only a subset of the input cells,
we might expect that the algorithm would lose important information and be unable to recover.
In fact, however, the performance is almost the same with less than half of the units attended.
Even with just <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><mn id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><cn type="integer" id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">16</annotation></semantics></math> units, the performance loss is less than 1%, suggesting that hard attention is quite capable of capturing the important parts of the image.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.2.1.1" class="ltx_tr">
<th id="S4.T1.2.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"></th>
<th id="S4.T1.2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Percentage</th>
<td id="S4.T1.2.1.1.3" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Overall</td>
<td id="S4.T1.2.1.1.4" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Yes/No</td>
<td id="S4.T1.2.1.1.5" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Number</td>
<td id="S4.T1.2.1.1.6" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Other</td>
</tr>
<tr id="S4.T1.2.2.2" class="ltx_tr">
<th id="S4.T1.2.2.2.1" class="ltx_td ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;"></th>
<th id="S4.T1.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">of cells</th>
<td id="S4.T1.2.2.2.3" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T1.2.2.2.4" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T1.2.2.2.5" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T1.2.2.2.6" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
<tr id="S4.T1.2.3.3" class="ltx_tr">
<th id="S4.T1.2.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">HAN+sum</th>
<th id="S4.T1.2.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">16%</th>
<td id="S4.T1.2.3.3.3" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">26.99</td>
<td id="S4.T1.2.3.3.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">40.53</td>
<td id="S4.T1.2.3.3.5" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">11.38</td>
<td id="S4.T1.2.3.3.6" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">24.15</td>
</tr>
<tr id="S4.T1.2.4.4" class="ltx_tr">
<th id="S4.T1.2.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HAN+sum</th>
<th id="S4.T1.2.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">32%</th>
<td id="S4.T1.2.4.4.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">27.43</td>
<td id="S4.T1.2.4.4.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">41.05</td>
<td id="S4.T1.2.4.4.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">11.38</td>
<td id="S4.T1.2.4.4.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">24.68</td>
</tr>
<tr id="S4.T1.2.5.5" class="ltx_tr">
<th id="S4.T1.2.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HAN+sum</th>
<th id="S4.T1.2.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">48%</th>
<td id="S4.T1.2.5.5.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">27.94</td>
<td id="S4.T1.2.5.5.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">41.35</td>
<td id="S4.T1.2.5.5.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">11.93</td>
<td id="S4.T1.2.5.5.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">25.27</td>
</tr>
<tr id="S4.T1.2.6.6" class="ltx_tr">
<th id="S4.T1.2.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HAN+sum</th>
<th id="S4.T1.2.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">64%</th>
<td id="S4.T1.2.6.6.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">27.80</td>
<td id="S4.T1.2.6.6.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">40.74</td>
<td id="S4.T1.2.6.6.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">11.29</td>
<td id="S4.T1.2.6.6.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">25.52</td>
</tr>
<tr id="S4.T1.2.7.7" class="ltx_tr">
<th id="S4.T1.2.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">sum</th>
<th id="S4.T1.2.7.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">100%</th>
<td id="S4.T1.2.7.7.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">27.96</td>
<td id="S4.T1.2.7.7.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">43.23</td>
<td id="S4.T1.2.7.7.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">12.09</td>
<td id="S4.T1.2.7.7.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">24.29</td>
</tr>
<tr id="S4.T1.2.8.8" class="ltx_tr">
<th id="S4.T1.2.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">HAN+pairwise</th>
<th id="S4.T1.2.8.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">16%</th>
<td id="S4.T1.2.8.8.3" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">26.81</td>
<td id="S4.T1.2.8.8.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">41.24</td>
<td id="S4.T1.2.8.8.5" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">10.87</td>
<td id="S4.T1.2.8.8.6" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">23.61</td>
</tr>
<tr id="S4.T1.2.9.9" class="ltx_tr">
<th id="S4.T1.2.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HAN+pairwise</th>
<th id="S4.T1.2.9.9.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">32%</th>
<td id="S4.T1.2.9.9.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">27.45</td>
<td id="S4.T1.2.9.9.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">40.91</td>
<td id="S4.T1.2.9.9.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">11.48</td>
<td id="S4.T1.2.9.9.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">24.75</td>
</tr>
<tr id="S4.T1.2.10.10" class="ltx_tr">
<th id="S4.T1.2.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HAN+pairwise</th>
<th id="S4.T1.2.10.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">48%</th>
<td id="S4.T1.2.10.10.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">28.23</td>
<td id="S4.T1.2.10.10.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">41.23</td>
<td id="S4.T1.2.10.10.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">11.40</td>
<td id="S4.T1.2.10.10.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">25.98</td>
</tr>
<tr id="S4.T1.2.11.11" class="ltx_tr">
<th id="S4.T1.2.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">Pairwise</th>
<th id="S4.T1.2.11.11.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">100%</th>
<td id="S4.T1.2.11.11.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">28.06</td>
<td id="S4.T1.2.11.11.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">44.10</td>
<td id="S4.T1.2.11.11.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">13.20</td>
<td id="S4.T1.2.11.11.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">23.71</td>
</tr>
<tr id="S4.T1.2.12.12" class="ltx_tr">
<th id="S4.T1.2.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">SAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>
</th>
<th id="S4.T1.2.12.12.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">-</th>
<td id="S4.T1.2.12.12.3" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">24.96</td>
<td id="S4.T1.2.12.12.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">38.35</td>
<td id="S4.T1.2.12.12.5" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">11.14</td>
<td id="S4.T1.2.12.12.6" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">21.74</td>
</tr>
<tr id="S4.T1.2.13.13" class="ltx_tr">
<th id="S4.T1.2.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">SAN (ours)</th>
<th id="S4.T1.2.13.13.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">-</th>
<td id="S4.T1.2.13.13.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">26.60</td>
<td id="S4.T1.2.13.13.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">39.69</td>
<td id="S4.T1.2.13.13.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">11.25</td>
<td id="S4.T1.2.13.13.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">23.92</td>
</tr>
<tr id="S4.T1.2.14.14" class="ltx_tr">
<th id="S4.T1.2.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">SAN+pos (ours)</th>
<th id="S4.T1.2.14.14.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">-</th>
<td id="S4.T1.2.14.14.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">27.77</td>
<td id="S4.T1.2.14.14.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">40.73</td>
<td id="S4.T1.2.14.14.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">11.31</td>
<td id="S4.T1.2.14.14.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">25.47</td>
</tr>
<tr id="S4.T1.2.15.15" class="ltx_tr">
<th id="S4.T1.2.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">GVQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</th>
<th id="S4.T1.2.15.15.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">-</th>
<td id="S4.T1.2.15.15.3" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">31.30</td>
<td id="S4.T1.2.15.15.4" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">57.99</td>
<td id="S4.T1.2.15.15.5" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">13.68</td>
<td id="S4.T1.2.15.15.6" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">22.14</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.3.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.4.2" class="ltx_text" style="font-size:90%;">
Comparison between different number of attended cells (percentage of the whole input), and aggregation operation. We consider a simple summation, and non-local pairwise computations as the aggregation tool.
</span></figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">The fact that hard attention can work is interesting itself, but it should be especially useful for models that devote significant processing to each attended cell.
We therefore repeat the above experiment with the non-local pairwise aggregation mechanism described in <a href="#S3" title="3 Method ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 3</span></a>, which computes activations for every pair of attended cells, and therefore scales quadratically with the number of attended cells.
These results are shown in the middle of Table <a href="#S4.T1" title="Table 1 ‣ 4.2 Effect of Hard Attention ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, where we can see that hard attention (48 entitties) actually boosts performance over an analogous model without hard attention.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">Finally, we compare standard soft attention baselines in the bottom of <a href="#S4.T1" title="Table 1 ‣ 4.2 Effect of Hard Attention ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 1</span></a>.
In particular, we include previous results using a basic soft attention network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, as well as our own re-implementation of the soft attention pooling algorithm presented in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> with the same features used in other experiments.
Surprisingly, soft attention does not outperform basic sum pooling, even with careful implementation that outperforms the previously reported results with the same method on this dataset; in fact, it performs slightly worse.
The non-local pairwise aggregation performs better than SAN on its own, although the best result includes hard attention.
Our results overall are somewhat worse than the state-of-the-art <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, but this is likely due to several architectural decisions not included here, such as a split pathway for different kinds of questions, special question embeddings, and the use of the question extractor.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.4.1.1" class="ltx_tr">
<th id="S4.T2.4.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"></th>
<th id="S4.T2.4.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Percentage</th>
<td id="S4.T2.4.1.1.3" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Overall</td>
<td id="S4.T2.4.1.1.4" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Yes/No</td>
<td id="S4.T2.4.1.1.5" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Number</td>
<td id="S4.T2.4.1.1.6" class="ltx_td ltx_align_right ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Other</td>
</tr>
<tr id="S4.T2.4.2.2" class="ltx_tr">
<th id="S4.T2.4.2.2.1" class="ltx_td ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;"></th>
<th id="S4.T2.4.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">of cells</th>
<td id="S4.T2.4.2.2.3" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T2.4.2.2.4" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T2.4.2.2.5" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T2.4.2.2.6" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
<tr id="S4.T2.4.3.3" class="ltx_tr">
<th id="S4.T2.4.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">AdaHAN+sum</th>
<th id="S4.T2.4.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">25.66%</th>
<td id="S4.T2.4.3.3.3" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">27.40</td>
<td id="S4.T2.4.3.3.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">40.70</td>
<td id="S4.T2.4.3.3.5" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">11.13</td>
<td id="S4.T2.4.3.3.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">24.86</td>
</tr>
<tr id="S4.T2.4.4.4" class="ltx_tr">
<th id="S4.T2.4.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">AdaHAN+pairwise</th>
<th id="S4.T2.4.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">32.63%</th>
<td id="S4.T2.4.4.4.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">28.65</td>
<td id="S4.T2.4.4.4.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">52.25</td>
<td id="S4.T2.4.4.4.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">13.79</td>
<td id="S4.T2.4.4.4.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">20.33</td>
</tr>
<tr id="S4.T2.4.5.5" class="ltx_tr">
<th id="S4.T2.4.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">HAN+sum</th>
<th id="S4.T2.4.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">32%</th>
<td id="S4.T2.4.5.5.3" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">27.43</td>
<td id="S4.T2.4.5.5.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">41.05</td>
<td id="S4.T2.4.5.5.5" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">11.38</td>
<td id="S4.T2.4.5.5.6" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">24.68</td>
</tr>
<tr id="S4.T2.4.6.6" class="ltx_tr">
<th id="S4.T2.4.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HAN+sum</th>
<th id="S4.T2.4.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">48%</th>
<td id="S4.T2.4.6.6.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">27.94</td>
<td id="S4.T2.4.6.6.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">41.35</td>
<td id="S4.T2.4.6.6.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">11.93</td>
<td id="S4.T2.4.6.6.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">25.27</td>
</tr>
<tr id="S4.T2.4.7.7" class="ltx_tr">
<th id="S4.T2.4.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HAN+pairwise</th>
<th id="S4.T2.4.7.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">32%</th>
<td id="S4.T2.4.7.7.3" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">27.45</td>
<td id="S4.T2.4.7.7.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">40.91</td>
<td id="S4.T2.4.7.7.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">11.48</td>
<td id="S4.T2.4.7.7.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">24.75</td>
</tr>
<tr id="S4.T2.4.8.8" class="ltx_tr">
<th id="S4.T2.4.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">HAN+pairwise</th>
<th id="S4.T2.4.8.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">48%</th>
<td id="S4.T2.4.8.8.3" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">28.23</td>
<td id="S4.T2.4.8.8.4" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">41.23</td>
<td id="S4.T2.4.8.8.5" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">11.40</td>
<td id="S4.T2.4.8.8.6" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">25.98</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.5.2.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.2.1" class="ltx_text" style="font-size:90%;">
Comparison between different adaptive hard-attention techniques with average number of attended parts, and aggregation operation. We consider a simple summation, and the non-local pairwise aggregation.
Since AdaHAN adaptively selects relevant features, based on the fixed threshold <math id="S4.T2.2.1.m1.1" class="ltx_Math" alttext="\frac{1}{w*h}" display="inline"><semantics id="S4.T2.2.1.m1.1b"><mfrac id="S4.T2.2.1.m1.1.1" xref="S4.T2.2.1.m1.1.1.cmml"><mn id="S4.T2.2.1.m1.1.1.2" xref="S4.T2.2.1.m1.1.1.2.cmml">1</mn><mrow id="S4.T2.2.1.m1.1.1.3" xref="S4.T2.2.1.m1.1.1.3.cmml"><mi id="S4.T2.2.1.m1.1.1.3.2" xref="S4.T2.2.1.m1.1.1.3.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S4.T2.2.1.m1.1.1.3.1" xref="S4.T2.2.1.m1.1.1.3.1.cmml">∗</mo><mi id="S4.T2.2.1.m1.1.1.3.3" xref="S4.T2.2.1.m1.1.1.3.3.cmml">h</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S4.T2.2.1.m1.1c"><apply id="S4.T2.2.1.m1.1.1.cmml" xref="S4.T2.2.1.m1.1.1"><divide id="S4.T2.2.1.m1.1.1.1.cmml" xref="S4.T2.2.1.m1.1.1"></divide><cn type="integer" id="S4.T2.2.1.m1.1.1.2.cmml" xref="S4.T2.2.1.m1.1.1.2">1</cn><apply id="S4.T2.2.1.m1.1.1.3.cmml" xref="S4.T2.2.1.m1.1.1.3"><times id="S4.T2.2.1.m1.1.1.3.1.cmml" xref="S4.T2.2.1.m1.1.1.3.1"></times><ci id="S4.T2.2.1.m1.1.1.3.2.cmml" xref="S4.T2.2.1.m1.1.1.3.2">𝑤</ci><ci id="S4.T2.2.1.m1.1.1.3.3.cmml" xref="S4.T2.2.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.1.m1.1d">\frac{1}{w*h}</annotation></semantics></math>, we report here the average number of attended parts.
</span></figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Adaptive hard attention</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Thus far, our experiments have dealt with networks that have a fixed threshold for all images.
However, some images and questions may require reasoning about more entities than others.
Therefore, we explore a simple adaptive method, where the network chooses how many cells to attend to for each image.
Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Effect of Hard Attention ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows results, where AdaHAN refers to our adaptive mechanism. We can see that on average, the adaptive mechanism uses surprisingly few cells: 25.66 out of 100 when sum pooling is used, and 32.63 whenever the non-local pairwise aggregation mechanism is used.
For sum pooling, this is on-par with a non-adaptive network that uses more cells on average (HAN+sum 32); for the non-local pairwise aggregation mechanism, just 32.63 cells are enough to outperform our best non-adaptive model, which uses roughly <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mn id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">50</mn><mo id="S4.SS3.p1.1.m1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">50\%</annotation></semantics></math> more cells.
This shows that even very simple methods of adapting hard attention to the image and the question can lead to both computation and performance gains, suggesting that more sophisticated methods will be an important direction for future work.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Effects of network depth</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">In this section, we briefly analyze an important architectural choice: the number of layers used on top of the pretrained embeddings.
That is, before the question and image representations are combined, we perform a small amount of processing to “align” the information, so that the embedding can easily tell the relevance of the visual information to the question.
Table <a href="#S4.T3" title="Table 3 ‣ 4.4 Effects of network depth ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the results of removing the two layers which perform this function.
We consistently see a drop of about 1% without the layers, suggesting that deciding which cells to attend to requires different information than the classification-tuned ResNet is designed to provide.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.2.1.1" class="ltx_tr">
<th id="S4.T3.2.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"></th>
<th id="S4.T3.2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Percentage</th>
<th id="S4.T3.2.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Number</th>
<th id="S4.T3.2.1.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Overall</th>
<th id="S4.T3.2.1.1.5" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Yes/No</th>
<th id="S4.T3.2.1.1.6" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Number</th>
<th id="S4.T3.2.1.1.7" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Other</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.2.2.1" class="ltx_tr">
<th id="S4.T3.2.2.1.1" class="ltx_td ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;"></th>
<th id="S4.T3.2.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">of cells</th>
<th id="S4.T3.2.2.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">of layers</th>
<th id="S4.T3.2.2.1.4" class="ltx_td ltx_th ltx_th_column" style="padding-top:1pt;padding-bottom:1pt;"></th>
<th id="S4.T3.2.2.1.5" class="ltx_td ltx_th ltx_th_column" style="padding-top:1pt;padding-bottom:1pt;"></th>
<th id="S4.T3.2.2.1.6" class="ltx_td ltx_th ltx_th_column" style="padding-top:1pt;padding-bottom:1pt;"></th>
<td id="S4.T3.2.2.1.7" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
<tr id="S4.T3.2.3.2" class="ltx_tr">
<th id="S4.T3.2.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">HAN+sum</th>
<th id="S4.T3.2.3.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">25%</th>
<th id="S4.T3.2.3.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">0</th>
<td id="S4.T3.2.3.2.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">26.38</td>
<td id="S4.T3.2.3.2.5" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">43.21</td>
<td id="S4.T3.2.3.2.6" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">13.12</td>
<td id="S4.T3.2.3.2.7" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">21.17</td>
</tr>
<tr id="S4.T3.2.4.3" class="ltx_tr">
<th id="S4.T3.2.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HAN+sum</th>
<th id="S4.T3.2.4.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">50%</th>
<th id="S4.T3.2.4.3.3" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">0</th>
<td id="S4.T3.2.4.3.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">26.75</td>
<td id="S4.T3.2.4.3.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">41.42</td>
<td id="S4.T3.2.4.3.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">10.94</td>
<td id="S4.T3.2.4.3.7" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">23.38</td>
</tr>
<tr id="S4.T3.2.5.4" class="ltx_tr">
<th id="S4.T3.2.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HAN+sum</th>
<th id="S4.T3.2.5.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">75%</th>
<th id="S4.T3.2.5.4.3" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">0</th>
<td id="S4.T3.2.5.4.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">26.82</td>
<td id="S4.T3.2.5.4.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">41.30</td>
<td id="S4.T3.2.5.4.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">11.48</td>
<td id="S4.T3.2.5.4.7" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">23.42</td>
</tr>
<tr id="S4.T3.2.6.5" class="ltx_tr">
<th id="S4.T3.2.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">HAN+sum</th>
<th id="S4.T3.2.6.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">25%</th>
<th id="S4.T3.2.6.5.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">2</th>
<td id="S4.T3.2.6.5.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">26.99</td>
<td id="S4.T3.2.6.5.5" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">40.53</td>
<td id="S4.T3.2.6.5.6" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">11.38</td>
<td id="S4.T3.2.6.5.7" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">24.15</td>
</tr>
<tr id="S4.T3.2.7.6" class="ltx_tr">
<th id="S4.T3.2.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">HAN+sum</th>
<th id="S4.T3.2.7.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">50%</th>
<th id="S4.T3.2.7.6.3" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;">2</th>
<td id="S4.T3.2.7.6.4" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">27.43</td>
<td id="S4.T3.2.7.6.5" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">41.05</td>
<td id="S4.T3.2.7.6.6" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">11.38</td>
<td id="S4.T3.2.7.6.7" class="ltx_td ltx_align_right" style="padding-top:1pt;padding-bottom:1pt;">24.68</td>
</tr>
<tr id="S4.T3.2.8.7" class="ltx_tr">
<th id="S4.T3.2.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">HAN+sum</th>
<th id="S4.T3.2.8.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">75%</th>
<th id="S4.T3.2.8.7.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">2</th>
<td id="S4.T3.2.8.7.4" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">27.94</td>
<td id="S4.T3.2.8.7.5" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">41.35</td>
<td id="S4.T3.2.8.7.6" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">11.93</td>
<td id="S4.T3.2.8.7.7" class="ltx_td ltx_align_right ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">25.27</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.3.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.4.2" class="ltx_text" style="font-size:90%;">
Comparison between different number of the attended
cells as the percentage of the whole input. The results are reported on VQA-CP v2. The second column denotes the
percentage of the attended input.
The third column denotes number of layers of the MLP (Equations <a href="#S3.E2" title="In 3.1 Attention Mechanisms ‣ 3 Method ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#S3.E3" title="In 3.1 Attention Mechanisms ‣ 3 Method ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
</span></figcaption>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Implementation Details.</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.5" class="ltx_p">All our models use the same LSTM size <math id="S4.SS5.p1.1.m1.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.SS5.p1.1.m1.1a"><mn id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><cn type="integer" id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">512</annotation></semantics></math> for questions embeddings, and the last convolutional layer of the ImageNet pre-trained ResNet-101 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite> (yielding 10-by-10 spatial representation, each with <math id="S4.SS5.p1.2.m2.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="S4.SS5.p1.2.m2.1a"><mn id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><cn type="integer" id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">2048</annotation></semantics></math> dimensional cells) for image embedding. We also use MLP with <math id="S4.SS5.p1.3.m3.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S4.SS5.p1.3.m3.1a"><mn id="S4.SS5.p1.3.m3.1.1" xref="S4.SS5.p1.3.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.1b"><cn type="integer" id="S4.SS5.p1.3.m3.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.1c">3</annotation></semantics></math> layers of sizes: <math id="S4.SS5.p1.4.m4.3" class="ltx_Math" alttext="1024,2048,1000" display="inline"><semantics id="S4.SS5.p1.4.m4.3a"><mrow id="S4.SS5.p1.4.m4.3.4.2" xref="S4.SS5.p1.4.m4.3.4.1.cmml"><mn id="S4.SS5.p1.4.m4.1.1" xref="S4.SS5.p1.4.m4.1.1.cmml">1024</mn><mo id="S4.SS5.p1.4.m4.3.4.2.1" xref="S4.SS5.p1.4.m4.3.4.1.cmml">,</mo><mn id="S4.SS5.p1.4.m4.2.2" xref="S4.SS5.p1.4.m4.2.2.cmml">2048</mn><mo id="S4.SS5.p1.4.m4.3.4.2.2" xref="S4.SS5.p1.4.m4.3.4.1.cmml">,</mo><mn id="S4.SS5.p1.4.m4.3.3" xref="S4.SS5.p1.4.m4.3.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.4.m4.3b"><list id="S4.SS5.p1.4.m4.3.4.1.cmml" xref="S4.SS5.p1.4.m4.3.4.2"><cn type="integer" id="S4.SS5.p1.4.m4.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1">1024</cn><cn type="integer" id="S4.SS5.p1.4.m4.2.2.cmml" xref="S4.SS5.p1.4.m4.2.2">2048</cn><cn type="integer" id="S4.SS5.p1.4.m4.3.3.cmml" xref="S4.SS5.p1.4.m4.3.3">1000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.4.m4.3c">1024,2048,1000</annotation></semantics></math>, as a classification module. We use ADAM for optimization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite>. We use a distributed setting with two workers computing a gradient over a batch of <math id="S4.SS5.p1.5.m5.1" class="ltx_Math" alttext="128" display="inline"><semantics id="S4.SS5.p1.5.m5.1a"><mn id="S4.SS5.p1.5.m5.1.1" xref="S4.SS5.p1.5.m5.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.5.m5.1b"><cn type="integer" id="S4.SS5.p1.5.m5.1.1.cmml" xref="S4.SS5.p1.5.m5.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.5.m5.1c">128</annotation></semantics></math> elements each. We normalize images by dividing them by their norm. We do not perform a hyper-parameter search as there is no separated validation set available. Instead, we rather choose default hyper-parameters based on our prior experience on Visual QA datasets. We trained our models until we notice a saturation on the training set. Then we evaluate these models on the test set. Our tables show the performance of all the methods wrt. the second digits precision obtained by rounding.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.5" class="ltx_p"><a href="#S4.T1" title="Table 1 ‣ 4.2 Effect of Hard Attention ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 1</span></a> shows SAN’s <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> results reported by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> together with our in-house implementation (denoted as “ours”). Our implementation has 2 attention hops, <math id="S4.SS5.p2.1.m1.1" class="ltx_Math" alttext="1024" display="inline"><semantics id="S4.SS5.p2.1.m1.1a"><mn id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.1b"><cn type="integer" id="S4.SS5.p2.1.m1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">1024</annotation></semantics></math> dimensional multimodal embedding size, a fixed learning rate <math id="S4.SS5.p2.2.m2.1" class="ltx_Math" alttext="0.0001" display="inline"><semantics id="S4.SS5.p2.2.m2.1a"><mn id="S4.SS5.p2.2.m2.1.1" xref="S4.SS5.p2.2.m2.1.1.cmml">0.0001</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.2.m2.1b"><cn type="float" id="S4.SS5.p2.2.m2.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1">0.0001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.2.m2.1c">0.0001</annotation></semantics></math>, and ResNet-101. In these experiments we pool the attended representations by weighted average with the attention weights.
Our in-house implementation of the non-local pairwise mechanism strongly resembles implementations of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. We use <math id="S4.SS5.p2.3.m3.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S4.SS5.p2.3.m3.1a"><mn id="S4.SS5.p2.3.m3.1.1" xref="S4.SS5.p2.3.m3.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.3.m3.1b"><cn type="integer" id="S4.SS5.p2.3.m3.1.1.cmml" xref="S4.SS5.p2.3.m3.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.3.m3.1c">2</annotation></semantics></math> heads, with embedding size <math id="S4.SS5.p2.4.m4.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.SS5.p2.4.m4.1a"><mn id="S4.SS5.p2.4.m4.1.1" xref="S4.SS5.p2.4.m4.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.4.m4.1b"><cn type="integer" id="S4.SS5.p2.4.m4.1.1.cmml" xref="S4.SS5.p2.4.m4.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.4.m4.1c">512</annotation></semantics></math>.
In <a href="#S3.E2" title="2 ‣ 3.1 Attention Mechanisms ‣ 3 Method ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 2</span></a> and <a href="#S3.E3" title="3 ‣ 3.1 Attention Mechanisms ‣ 3 Method ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 3</span></a>, we use <math id="S4.SS5.p2.5.m5.1" class="ltx_Math" alttext="d:=2048" display="inline"><semantics id="S4.SS5.p2.5.m5.1a"><mrow id="S4.SS5.p2.5.m5.1.1" xref="S4.SS5.p2.5.m5.1.1.cmml"><mi id="S4.SS5.p2.5.m5.1.1.2" xref="S4.SS5.p2.5.m5.1.1.2.cmml">d</mi><mo lspace="0.278em" rspace="0.278em" id="S4.SS5.p2.5.m5.1.1.1" xref="S4.SS5.p2.5.m5.1.1.1.cmml">:=</mo><mn id="S4.SS5.p2.5.m5.1.1.3" xref="S4.SS5.p2.5.m5.1.1.3.cmml">2048</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.5.m5.1b"><apply id="S4.SS5.p2.5.m5.1.1.cmml" xref="S4.SS5.p2.5.m5.1.1"><csymbol cd="latexml" id="S4.SS5.p2.5.m5.1.1.1.cmml" xref="S4.SS5.p2.5.m5.1.1.1">assign</csymbol><ci id="S4.SS5.p2.5.m5.1.1.2.cmml" xref="S4.SS5.p2.5.m5.1.1.2">𝑑</ci><cn type="integer" id="S4.SS5.p2.5.m5.1.1.3.cmml" xref="S4.SS5.p2.5.m5.1.1.3">2048</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.5.m5.1c">d:=2048</annotation></semantics></math> (the same as dimensionality as the image encoding) and two linear layers with RELU that follows up each layer.</p>
</div>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Qualitative Results.</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.1" class="ltx_p">One advantage of our formulation is that it is straightforward to visualize the masks of attended cells given questions and images, which we show in <a href="#S4.F3" title="Figure 3 ‣ 4.6 Qualitative Results. ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 3</span></a> and <a href="#S4.F4" title="Figure 4 ‣ 4.6 Qualitative Results. ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 4</span></a>.
In general, relevant objects are usually attended, and that significant portions of the irrelevant background is suppressed. Although some background might be kept, we hypothesize the context matters in answering some questions.</p>
</div>
<div id="S4.SS6.p2" class="ltx_para">
<p id="S4.SS6.p2.1" class="ltx_p">In <a href="#S4.F3" title="Figure 3 ‣ 4.6 Qualitative Results. ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 3</span></a>, we show results with our different hard-attention mechanisms (HAN or AdaHAN), and different aggregation operations (summation or pairwise). We can see that the important objects are attended together with some context, which we hypothesize can also be important in correctly answering questions. These masks
are occasionally useful for diagnosing behavior. For instance, as row 2 and column 3 suggest, the network may answer the question correctly but likely for wrong reasons.
We can also see broad differences between the network architectures. For instance, the sum pooling method (row 2) is much more spatially constrained than the pairwise pooling version (row 1), even though the adaptive attention can select an arbitrarily large region. We hypothesize that more visual features may unnecessarily interfere during the summation, and hence a more spatially sparse representation is preferred, or that sum pooling struggles to integrate across complex scenes. The support is also not always contiguous: non-adaptive hard attention with 16 entities (row 4) in particular distributes its attention widely.</p>
</div>
<div id="S4.SS6.p3" class="ltx_para">
<p id="S4.SS6.p3.1" class="ltx_p">In <a href="#S4.F4" title="Figure 4 ‣ 4.6 Qualitative Results. ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 4</span></a>, we show results with our best-performing model on VQA-CP: adaptive hard attention mechanism tied with a non-local, pairwise aggregation mechanism (AdaHAN+pairwise). The qualitative behaviour of this mechanism subsumes various fixed hard-attention variants, and with a variable spatial support tends to be better qualitatively and quantitatively than others.
Interestingly, the topology of the attended parts of AdaHAN+pairwise differs from image to image. For instance, for the question “Are this lions?” (1st row, 1st column), the two attended regions are separated and quite localized. However, for “Is that an airplane in image?” (1st row, 2nd column), the attended regions are contiguous and cover almost whole image. The shape of the train in the image (1st row, 3rd column), despite of its elongated shape, is quite well captured by our method. Similarly, we can observe that the attended regions overlap with the shape of a boat (1st row, 4th column), even though the method ultimately gets the question wrong.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<table id="S4.F3.16.16" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.F3.16.16.17.1" class="ltx_tr">
<th id="S4.F3.16.16.17.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;"></th>
<td id="S4.F3.16.16.17.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Are those drinking</td>
<td id="S4.F3.16.16.17.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Can cars cross</td>
<td id="S4.F3.16.16.17.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">What color is</td>
<td id="S4.F3.16.16.17.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">What is building</td>
</tr>
<tr id="S4.F3.16.16.18.2" class="ltx_tr">
<th id="S4.F3.16.16.18.2.1" class="ltx_td ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;"></th>
<td id="S4.F3.16.16.18.2.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">glasses next to</td>
<td id="S4.F3.16.16.18.2.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">this bridge?</td>
<td id="S4.F3.16.16.18.2.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">her skirt?</td>
<td id="S4.F3.16.16.18.2.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">facade made</td>
</tr>
<tr id="S4.F3.16.16.19.3" class="ltx_tr">
<th id="S4.F3.16.16.19.3.1" class="ltx_td ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;"></th>
<td id="S4.F3.16.16.19.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">flower pot?</td>
<td id="S4.F3.16.16.19.3.3" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.F3.16.16.19.3.4" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.F3.16.16.19.3.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">from?</td>
</tr>
<tr id="S4.F3.4.4.4" class="ltx_tr">
<th id="S4.F3.4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<div id="S4.F3.4.4.4.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:68.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:68.4pt;transform:translate(-29.74pt,-28.76pt) rotate(-90deg) ;">
<p id="S4.F3.4.4.4.5.1.1" class="ltx_p">AdaHAN+pair.</p>
</span></div>
</th>
<td id="S4.F3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-are_those_drinking_glasses_next_to_flower_pot-yes-yes__yes-1.png" id="S4.F3.1.1.1.1.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F3.2.2.2.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-can_cars_cross_this_bridge-no-no__no-1.png" id="S4.F3.2.2.2.2.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F3.3.3.3.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-what_color_is_her_skirt-white-white__white-1.png" id="S4.F3.3.3.3.3.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F3.4.4.4.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-what_is_building_facade_made_from-brick-brick__brick-1.png" id="S4.F3.4.4.4.4.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
</tr>
<tr id="S4.F3.16.16.20.4" class="ltx_tr">
<th id="S4.F3.16.16.20.4.1" class="ltx_td ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;"></th>
<td id="S4.F3.16.16.20.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.20.4.2.1" class="ltx_text" style="color:#008000;">yes</span></td>
<td id="S4.F3.16.16.20.4.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.20.4.3.1" class="ltx_text" style="color:#008000;">no</span></td>
<td id="S4.F3.16.16.20.4.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.20.4.4.1" class="ltx_text" style="color:#008000;">white</span></td>
<td id="S4.F3.16.16.20.4.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.20.4.5.1" class="ltx_text" style="color:#008000;">brick</span></td>
</tr>
<tr id="S4.F3.8.8.8" class="ltx_tr">
<th id="S4.F3.8.8.8.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<div id="S4.F3.8.8.8.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:7.8pt;height:66.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:66.2pt;transform:translate(-29.19pt,-28.78pt) rotate(-90deg) ;">
<p id="S4.F3.8.8.8.5.1.1" class="ltx_p">AdaHAN+sum</p>
</span></div>
</th>
<td id="S4.F3.5.5.5.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/adah-sum/609494-2-are_those_drinking_glasses_next_to_flower_pot-no-yes__yes-0.png" id="S4.F3.5.5.5.1.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F3.6.6.6.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/adah-sum/609494-2-can_cars_cross_this_bridge-yes-no__no-0.png" id="S4.F3.6.6.6.2.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F3.7.7.7.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/adah-sum/609494-2-what_color_is_her_skirt-white-white__white-1.png" id="S4.F3.7.7.7.3.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F3.8.8.8.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/adah-sum/609494-2-what_is_building_facade_made_from-brick-brick__brick-1.png" id="S4.F3.8.8.8.4.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
</tr>
<tr id="S4.F3.16.16.21.5" class="ltx_tr">
<th id="S4.F3.16.16.21.5.1" class="ltx_td ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;"></th>
<td id="S4.F3.16.16.21.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.21.5.2.1" class="ltx_text" style="color:#FF0000;">no</span></td>
<td id="S4.F3.16.16.21.5.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.21.5.3.1" class="ltx_text" style="color:#FF0000;">yes</span></td>
<td id="S4.F3.16.16.21.5.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.21.5.4.1" class="ltx_text" style="color:#008000;">white</span></td>
<td id="S4.F3.16.16.21.5.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.21.5.5.1" class="ltx_text" style="color:#008000;">brick</span></td>
</tr>
<tr id="S4.F3.12.12.12" class="ltx_tr">
<th id="S4.F3.12.12.12.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<div id="S4.F3.12.12.12.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:10.0pt;height:71.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:71.4pt;transform:translate(-30.71pt,-29.46pt) rotate(-90deg) ;">
<p id="S4.F3.12.12.12.5.1.1" class="ltx_p">HAN+pair. (32)</p>
</span></div>
</th>
<td id="S4.F3.9.9.9.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/han-32-rn/606906-4-are_those_drinking_glasses_next_to_flower_pot-yes-yes__yes-1.png" id="S4.F3.9.9.9.1.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F3.10.10.10.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/han-32-rn/606906-4-can_cars_cross_this_bridge-no-no__no-1.png" id="S4.F3.10.10.10.2.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F3.11.11.11.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/han-32-rn/606906-4-what_color_is_her_skirt-black-white__white-0.png" id="S4.F3.11.11.11.3.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F3.12.12.12.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/han-32-rn/606906-4-what_is_building_facade_made_from-stone-brick__brick-0.png" id="S4.F3.12.12.12.4.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
</tr>
<tr id="S4.F3.16.16.22.6" class="ltx_tr">
<th id="S4.F3.16.16.22.6.1" class="ltx_td ltx_th ltx_th_row" style="padding-top:1pt;padding-bottom:1pt;"></th>
<td id="S4.F3.16.16.22.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.22.6.2.1" class="ltx_text" style="color:#008000;">yes</span></td>
<td id="S4.F3.16.16.22.6.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.22.6.3.1" class="ltx_text" style="color:#008000;">no</span></td>
<td id="S4.F3.16.16.22.6.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.22.6.4.1" class="ltx_text" style="color:#FF0000;">black</span></td>
<td id="S4.F3.16.16.22.6.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.22.6.5.1" class="ltx_text" style="color:#FF8000;">stone</span></td>
</tr>
<tr id="S4.F3.16.16.16" class="ltx_tr">
<th id="S4.F3.16.16.16.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<div id="S4.F3.16.16.16.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:10.0pt;height:71.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:71.4pt;transform:translate(-30.71pt,-29.46pt) rotate(-90deg) ;">
<p id="S4.F3.16.16.16.5.1.1" class="ltx_p">HAN+pair. (16)</p>
</span></div>
</th>
<td id="S4.F3.13.13.13.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/han-16-rn/606906-3-are_those_drinking_glasses_next_to_flower_pot-yes-yes__yes-1.png" id="S4.F3.13.13.13.1.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F3.14.14.14.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/han-16-rn/606906-3-can_cars_cross_this_bridge-no-no__no-1.png" id="S4.F3.14.14.14.2.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F3.15.15.15.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/han-16-rn/606906-3-what_color_is_her_skirt-blue-white__white-0.png" id="S4.F3.15.15.15.3.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F3.16.16.16.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><img src="/html/1808.00300/assets/fig/han-16-rn/606906-3-what_is_building_facade_made_from-stone-brick__brick-0.png" id="S4.F3.16.16.16.4.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
</tr>
<tr id="S4.F3.16.16.23.7" class="ltx_tr">
<th id="S4.F3.16.16.23.7.1" class="ltx_td ltx_th ltx_th_row ltx_border_bb ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;"></th>
<td id="S4.F3.16.16.23.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.23.7.2.1" class="ltx_text" style="color:#008000;">yes</span></td>
<td id="S4.F3.16.16.23.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.23.7.3.1" class="ltx_text" style="color:#008000;">no</span></td>
<td id="S4.F3.16.16.23.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.23.7.4.1" class="ltx_text" style="color:#FF0000;">blue</span></td>
<td id="S4.F3.16.16.23.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.F3.16.16.23.7.5.1" class="ltx_text" style="color:#FF8000;">stone</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.22.3.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.20.2" class="ltx_text" style="font-size:90%;">
Qualitative comparison between our variants of the hard attention mechanism together with different aggregation methods. The first row shows AdaHAN+pairwise (AdaHAN+pair. in the figure), the second row shows AdaHAN+sum, the third row shows HAN+pairwise with fixed <math id="S4.F3.19.1.m1.1" class="ltx_Math" alttext="32" display="inline"><semantics id="S4.F3.19.1.m1.1b"><mn id="S4.F3.19.1.m1.1.1" xref="S4.F3.19.1.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S4.F3.19.1.m1.1c"><cn type="integer" id="S4.F3.19.1.m1.1.1.cmml" xref="S4.F3.19.1.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.19.1.m1.1d">32</annotation></semantics></math> entities,
and the last row shows HAN+pairwise with fixed <math id="S4.F3.20.2.m2.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S4.F3.20.2.m2.1b"><mn id="S4.F3.20.2.m2.1.1" xref="S4.F3.20.2.m2.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.F3.20.2.m2.1c"><cn type="integer" id="S4.F3.20.2.m2.1.1.cmml" xref="S4.F3.20.2.m2.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.20.2.m2.1d">16</annotation></semantics></math> entities, covering 32% and 16% of the input respectively. In the images, attended regions are highlighted while unattended are darkened. The green denotes correct answers, the red incorrect, and orange denotes partial consensus between the human answers. This figure illustrates various strengths of the proposed methods. Best viewed on a display.
</span></figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure">
<table id="S4.F4.16.16" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.F4.16.16.17.1" class="ltx_tr">
<th id="S4.F4.16.16.17.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S4.F4.16.16.17.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.F4.16.16.17.1.2.1" class="ltx_text" style="font-size:80%;">Are this lions?</span></td>
<td id="S4.F4.16.16.17.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.F4.16.16.17.1.3.1" class="ltx_text" style="font-size:80%;">Is that</span></td>
<td id="S4.F4.16.16.17.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.F4.16.16.17.1.4.1" class="ltx_text" style="font-size:80%;">How many</span></td>
<td id="S4.F4.16.16.17.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.F4.16.16.17.1.5.1" class="ltx_text" style="font-size:80%;">How many boats</span></td>
</tr>
<tr id="S4.F4.16.16.18.2" class="ltx_tr">
<th id="S4.F4.16.16.18.2.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.F4.16.16.18.2.2" class="ltx_td"></td>
<td id="S4.F4.16.16.18.2.3" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.18.2.3.1" class="ltx_text" style="font-size:80%;">an airplane</span></td>
<td id="S4.F4.16.16.18.2.4" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.18.2.4.1" class="ltx_text" style="font-size:80%;">cars are on</span></td>
<td id="S4.F4.16.16.18.2.5" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.18.2.5.1" class="ltx_text" style="font-size:80%;">are there?</span></td>
</tr>
<tr id="S4.F4.16.16.19.3" class="ltx_tr">
<th id="S4.F4.16.16.19.3.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.F4.16.16.19.3.2" class="ltx_td"></td>
<td id="S4.F4.16.16.19.3.3" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.19.3.3.1" class="ltx_text" style="font-size:80%;">in image?</span></td>
<td id="S4.F4.16.16.19.3.4" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.19.3.4.1" class="ltx_text" style="font-size:80%;">train tracks?</span></td>
<td id="S4.F4.16.16.19.3.5" class="ltx_td"></td>
</tr>
<tr id="S4.F4.4.4.4" class="ltx_tr">
<th id="S4.F4.4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<div id="S4.F4.4.4.4.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:68.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:68.4pt;transform:translate(-29.74pt,-28.76pt) rotate(-90deg) ;">
<p id="S4.F4.4.4.4.5.1.1" class="ltx_p">AdaHAN+pair.</p>
</span></div>
</th>
<td id="S4.F4.1.1.1.1" class="ltx_td ltx_nopad_l ltx_align_left"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-are_this_lions-no-no__no-1.png" id="S4.F4.1.1.1.1.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F4.2.2.2.2" class="ltx_td ltx_nopad_l ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-is_that_an_airplane_in_image-no-no__no-1.png" id="S4.F4.2.2.2.2.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F4.3.3.3.3" class="ltx_td ltx_nopad_l ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-how_many_cars_are_on_train_tracks-2-1__0-0.png" id="S4.F4.3.3.3.3.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F4.4.4.4.4" class="ltx_td ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-how_many_boats_are_there-2-1__1-0.png" id="S4.F4.4.4.4.4.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
</tr>
<tr id="S4.F4.16.16.20.4" class="ltx_tr">
<th id="S4.F4.16.16.20.4.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.F4.16.16.20.4.2" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.20.4.2.1" class="ltx_text" style="color:#008000;">no</span></td>
<td id="S4.F4.16.16.20.4.3" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.20.4.3.1" class="ltx_text" style="color:#008000;">no</span></td>
<td id="S4.F4.16.16.20.4.4" class="ltx_td ltx_align_center">
<span id="S4.F4.16.16.20.4.4.1" class="ltx_text" style="color:#FF0000;">2</span> (1)</td>
<td id="S4.F4.16.16.20.4.5" class="ltx_td ltx_align_center">
<span id="S4.F4.16.16.20.4.5.1" class="ltx_text" style="color:#FF0000;">2</span> (1)</td>
</tr>
<tr id="S4.F4.16.16.21.5" class="ltx_tr">
<th id="S4.F4.16.16.21.5.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<td id="S4.F4.16.16.21.5.2" class="ltx_td ltx_align_center ltx_border_t">About how high</td>
<td id="S4.F4.16.16.21.5.3" class="ltx_td ltx_align_center ltx_border_t">Any chains on</td>
<td id="S4.F4.16.16.21.5.4" class="ltx_td ltx_align_center ltx_border_t">About how old</td>
<td id="S4.F4.16.16.21.5.5" class="ltx_td ltx_align_center ltx_border_t">What color is</td>
</tr>
<tr id="S4.F4.16.16.22.6" class="ltx_tr">
<th id="S4.F4.16.16.22.6.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.F4.16.16.22.6.2" class="ltx_td ltx_align_center">is man jumping?</td>
<td id="S4.F4.16.16.22.6.3" class="ltx_td ltx_align_center">hydrant?</td>
<td id="S4.F4.16.16.22.6.4" class="ltx_td ltx_align_center">is boy on</td>
<td id="S4.F4.16.16.22.6.5" class="ltx_td ltx_align_center">this train?</td>
</tr>
<tr id="S4.F4.16.16.23.7" class="ltx_tr">
<th id="S4.F4.16.16.23.7.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.F4.16.16.23.7.2" class="ltx_td"></td>
<td id="S4.F4.16.16.23.7.3" class="ltx_td"></td>
<td id="S4.F4.16.16.23.7.4" class="ltx_td ltx_align_center">surfboard?</td>
<td id="S4.F4.16.16.23.7.5" class="ltx_td"></td>
</tr>
<tr id="S4.F4.8.8.8" class="ltx_tr">
<th id="S4.F4.8.8.8.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<div id="S4.F4.8.8.8.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:68.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:68.4pt;transform:translate(-29.74pt,-28.76pt) rotate(-90deg) ;">
<p id="S4.F4.8.8.8.5.1.1" class="ltx_p">AdaHAN+pair.</p>
</span></div>
</th>
<td id="S4.F4.5.5.5.1" class="ltx_td ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-about_how_high_is_man_jumping-3_feet-6_feet__2_ft-1.png" id="S4.F4.5.5.5.1.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F4.6.6.6.2" class="ltx_td ltx_nopad_l ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-any_chains_on_hydrant-no-no__no-1.png" id="S4.F4.6.6.6.2.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F4.7.7.7.3" class="ltx_td ltx_nopad_l ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-about_how_old_is_boy_on_surfboard-4-4__3-0_6.png" id="S4.F4.7.7.7.3.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F4.8.8.8.4" class="ltx_td ltx_nopad_l ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-what_color_is_this_train-green-yellow__red_and_yellow-0_6.png" id="S4.F4.8.8.8.4.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
</tr>
<tr id="S4.F4.16.16.24.8" class="ltx_tr">
<th id="S4.F4.16.16.24.8.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.F4.16.16.24.8.2" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.24.8.2.1" class="ltx_text" style="color:#008000;">3 feet</span></td>
<td id="S4.F4.16.16.24.8.3" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.24.8.3.1" class="ltx_text" style="color:#008000;">no</span></td>
<td id="S4.F4.16.16.24.8.4" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.24.8.4.1" class="ltx_text" style="color:#FF8000;">4</span></td>
<td id="S4.F4.16.16.24.8.5" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.24.8.5.1" class="ltx_text" style="color:#FF8000;">yellow</span></td>
</tr>
<tr id="S4.F4.16.16.25.9" class="ltx_tr">
<th id="S4.F4.16.16.25.9.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<td id="S4.F4.16.16.25.9.2" class="ltx_td ltx_align_center ltx_border_t">Would this type</td>
<td id="S4.F4.16.16.25.9.3" class="ltx_td ltx_align_center ltx_border_t">What is</td>
<td id="S4.F4.16.16.25.9.4" class="ltx_td ltx_align_center ltx_border_t">What is he</td>
<td id="S4.F4.16.16.25.9.5" class="ltx_td ltx_align_center ltx_border_t">What time does</td>
</tr>
<tr id="S4.F4.16.16.26.10" class="ltx_tr">
<th id="S4.F4.16.16.26.10.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.F4.16.16.26.10.2" class="ltx_td ltx_align_center">of train be used</td>
<td id="S4.F4.16.16.26.10.3" class="ltx_td ltx_align_center">in his hand?</td>
<td id="S4.F4.16.16.26.10.4" class="ltx_td ltx_align_center">holding up?</td>
<td id="S4.F4.16.16.26.10.5" class="ltx_td ltx_align_center">clock read?</td>
</tr>
<tr id="S4.F4.16.16.27.11" class="ltx_tr">
<th id="S4.F4.16.16.27.11.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.F4.16.16.27.11.2" class="ltx_td ltx_align_center">as commuter?</td>
<td id="S4.F4.16.16.27.11.3" class="ltx_td"></td>
<td id="S4.F4.16.16.27.11.4" class="ltx_td"></td>
<td id="S4.F4.16.16.27.11.5" class="ltx_td"></td>
</tr>
<tr id="S4.F4.12.12.12" class="ltx_tr">
<th id="S4.F4.12.12.12.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<div id="S4.F4.12.12.12.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:68.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:68.4pt;transform:translate(-29.74pt,-28.76pt) rotate(-90deg) ;">
<p id="S4.F4.12.12.12.5.1.1" class="ltx_p">AdaHAN+pair.</p>
</span></div>
</th>
<td id="S4.F4.9.9.9.1" class="ltx_td ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-would_this_type_of_train_be_used_as_commuter-no-no__no-1.png" id="S4.F4.9.9.9.1.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F4.10.10.10.2" class="ltx_td ltx_nopad_l ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-what_is_in_his_hand-phone-phone__phone-1.png" id="S4.F4.10.10.10.2.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F4.11.11.11.3" class="ltx_td ltx_nopad_l ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-what_is_he_holding_up-fruit-fruit__piece_of_fruit-0_9.png" id="S4.F4.11.11.11.3.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F4.12.12.12.4" class="ltx_td ltx_nopad_l ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-what_time_does_clock_read-noon-425__425-0.png" id="S4.F4.12.12.12.4.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
</tr>
<tr id="S4.F4.16.16.28.12" class="ltx_tr">
<th id="S4.F4.16.16.28.12.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.F4.16.16.28.12.2" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.28.12.2.1" class="ltx_text" style="color:#008000;">no</span></td>
<td id="S4.F4.16.16.28.12.3" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.28.12.3.1" class="ltx_text" style="color:#008000;">phone</span></td>
<td id="S4.F4.16.16.28.12.4" class="ltx_td ltx_align_center"><span id="S4.F4.16.16.28.12.4.1" class="ltx_text" style="color:#FF8000;">fruit</span></td>
<td id="S4.F4.16.16.28.12.5" class="ltx_td ltx_align_center">
<span id="S4.F4.16.16.28.12.5.1" class="ltx_text" style="color:#FF0000;">noon</span> (4:25)</td>
</tr>
<tr id="S4.F4.16.16.29.13" class="ltx_tr">
<th id="S4.F4.16.16.29.13.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<td id="S4.F4.16.16.29.13.2" class="ltx_td ltx_align_center ltx_border_t">What is girl</td>
<td id="S4.F4.16.16.29.13.3" class="ltx_td ltx_align_center ltx_border_t">Are people</td>
<td id="S4.F4.16.16.29.13.4" class="ltx_td ltx_align_center ltx_border_t">Are all these</td>
<td id="S4.F4.16.16.29.13.5" class="ltx_td ltx_align_center ltx_border_t">What kind</td>
</tr>
<tr id="S4.F4.16.16.30.14" class="ltx_tr">
<th id="S4.F4.16.16.30.14.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.F4.16.16.30.14.2" class="ltx_td ltx_align_center">trying to catch?</td>
<td id="S4.F4.16.16.30.14.3" class="ltx_td ltx_align_center">sunbathing at</td>
<td id="S4.F4.16.16.30.14.4" class="ltx_td ltx_align_center">people moving?</td>
<td id="S4.F4.16.16.30.14.5" class="ltx_td ltx_align_center">of animals</td>
</tr>
<tr id="S4.F4.16.16.31.15" class="ltx_tr">
<th id="S4.F4.16.16.31.15.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.F4.16.16.31.15.2" class="ltx_td"></td>
<td id="S4.F4.16.16.31.15.3" class="ltx_td ltx_align_center">beach in photo?</td>
<td id="S4.F4.16.16.31.15.4" class="ltx_td"></td>
<td id="S4.F4.16.16.31.15.5" class="ltx_td ltx_align_center">are these?</td>
</tr>
<tr id="S4.F4.16.16.16" class="ltx_tr">
<th id="S4.F4.16.16.16.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<div id="S4.F4.16.16.16.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:68.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:68.4pt;transform:translate(-29.74pt,-28.76pt) rotate(-90deg) ;">
<p id="S4.F4.16.16.16.5.1.1" class="ltx_p">AdaHAN+pair.</p>
</span></div>
</th>
<td id="S4.F4.13.13.13.1" class="ltx_td ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-what_is_girl_trying_to_catch-kite-kite__kite-1.png" id="S4.F4.13.13.13.1.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F4.14.14.14.2" class="ltx_td ltx_nopad_l ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-are_people_sunbathing_at_beach_in_photo-no-no__no-1.png" id="S4.F4.14.14.14.2.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F4.15.15.15.3" class="ltx_td ltx_nopad_l ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-are_all_these_people_moving-yes-yes__no-1.png" id="S4.F4.15.15.15.3.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
<td id="S4.F4.16.16.16.4" class="ltx_td ltx_nopad_l ltx_align_center"><img src="/html/1808.00300/assets/fig/adah-rn/609494-3-what_kind_of_animals_are_these-bear-bears__bear-0_9.png" id="S4.F4.16.16.16.4.g1" class="ltx_graphics ltx_img_square" width="120" height="120" alt="Refer to caption"></td>
</tr>
<tr id="S4.F4.16.16.32.16" class="ltx_tr">
<th id="S4.F4.16.16.32.16.1" class="ltx_td ltx_th ltx_th_row ltx_border_bb ltx_border_b"></th>
<td id="S4.F4.16.16.32.16.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.F4.16.16.32.16.2.1" class="ltx_text" style="color:#008000;">kite</span></td>
<td id="S4.F4.16.16.32.16.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.F4.16.16.32.16.3.1" class="ltx_text" style="color:#008000;">no</span></td>
<td id="S4.F4.16.16.32.16.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.F4.16.16.32.16.4.1" class="ltx_text" style="color:#008000;">yes</span></td>
<td id="S4.F4.16.16.32.16.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.F4.16.16.32.16.5.1" class="ltx_text" style="color:#FF8000;">bear</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.18.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.19.2" class="ltx_text" style="font-size:90%;">
We show additional results with our AdaHAN+pairwise. In the images, the attended regions are highlighted while the unattended are darkened. Green denotes correct, and red incorrect answers. Orange denotes partial consensus. Best viewed on display.
</span></figcaption>
</figure>
</section>
<section id="S4.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>End-to-end Training.</h3>

<div id="S4.SS7.p1" class="ltx_para">
<p id="S4.SS7.p1.2" class="ltx_p">Since our network uses hard attention, which has zero gradients almost everywhere, one might suspect that it will become more difficult to train the lower-level features, or worse, that untrained features might prevent us from bootstrapping the attention mechanism.
Therefore, we also trained HAN+sum (with 16% of the input cells) end-to-end together with a relatively small convolutional neural network initialized from scratch.
We compare our method against our implementation of the SAN method trained using the same simple convolutional neural network.
We call the models: simple-SAN, and simple-HAN.

<br class="ltx_break"><span id="S4.SS7.p1.2.1" class="ltx_text ltx_font_bold">Analysis.</span>
In our experiments, simple-SAN achieves about <math id="S4.SS7.p1.1.m1.1" class="ltx_Math" alttext="21\%" display="inline"><semantics id="S4.SS7.p1.1.m1.1a"><mrow id="S4.SS7.p1.1.m1.1.1" xref="S4.SS7.p1.1.m1.1.1.cmml"><mn id="S4.SS7.p1.1.m1.1.1.2" xref="S4.SS7.p1.1.m1.1.1.2.cmml">21</mn><mo id="S4.SS7.p1.1.m1.1.1.1" xref="S4.SS7.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.1.m1.1b"><apply id="S4.SS7.p1.1.m1.1.1.cmml" xref="S4.SS7.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS7.p1.1.m1.1.1.1.cmml" xref="S4.SS7.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS7.p1.1.m1.1.1.2.cmml" xref="S4.SS7.p1.1.m1.1.1.2">21</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.1.m1.1c">21\%</annotation></semantics></math> performance on the test set. Surprisingly, simple-HAN+sum achieves about <math id="S4.SS7.p1.2.m2.1" class="ltx_Math" alttext="24\%" display="inline"><semantics id="S4.SS7.p1.2.m2.1a"><mrow id="S4.SS7.p1.2.m2.1.1" xref="S4.SS7.p1.2.m2.1.1.cmml"><mn id="S4.SS7.p1.2.m2.1.1.2" xref="S4.SS7.p1.2.m2.1.1.2.cmml">24</mn><mo id="S4.SS7.p1.2.m2.1.1.1" xref="S4.SS7.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.2.m2.1b"><apply id="S4.SS7.p1.2.m2.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS7.p1.2.m2.1.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS7.p1.2.m2.1.1.2.cmml" xref="S4.SS7.p1.2.m2.1.1.2">24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.2.m2.1c">24\%</annotation></semantics></math> performance on the same split, on-par with the performance of normal SAN that uses more complex and deeper visual architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib67" title="" class="ltx_ref">67</a>]</cite>; the results are reported by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. This result shows that the hard attention mechanism can indeed be tightly coupled within the training process, and that the whole procedure does not rely heavily on the properties of the ImageNet pre-trained networks.
In a sense, we see that a discrete notion of entities also “emerges” through the learning process, leading to efficient training.

<br class="ltx_break"><span id="S4.SS7.p1.2.2" class="ltx_text ltx_font_bold">Implementation Details.</span>
In our experiments we use a simple CNN built of: 1 layer with 64 filters and 7-by-7 filter size followed up by 2 layers with 256 filters and 2 layers with 512 filters, all with 3-by-3 filter size. We use strides 2 for all the layers.</p>
</div>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1808.00300/assets/x3.png" id="S4.F5.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="370" height="251" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F5.sf1.3.2" class="ltx_text" style="font-size:90%;">HAN+RN (purple), RN (green)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1808.00300/assets/fig/hard_attention-vs-st.png" id="S4.F5.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="521" height="329" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F5.sf2.3.2" class="ltx_text" style="font-size:90%;">HAN+RN (orange), ST+RN (blue)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.4.2.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.2.1" class="ltx_text" style="font-size:90%;">Validation accuracy plots on CLEVR of the methods under the same hyper-parameters setting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. (a) HAN+RN (<math id="S4.F5.2.1.m1.1" class="ltx_Math" alttext="0.25" display="inline"><semantics id="S4.F5.2.1.m1.1b"><mn id="S4.F5.2.1.m1.1.1" xref="S4.F5.2.1.m1.1.1.cmml">0.25</mn><annotation-xml encoding="MathML-Content" id="S4.F5.2.1.m1.1c"><cn type="float" id="S4.F5.2.1.m1.1.1.cmml" xref="S4.F5.2.1.m1.1.1">0.25</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.2.1.m1.1d">0.25</annotation></semantics></math> of the input cells) and standard RN (all input cells) trained for 12 hours to measure the efficiency of the methods. (b) Our approaches to hard attention: the proposed one (orange), and the straight-through estimator (blue). </span></figcaption>
</figure>
</section>
<section id="S4.SS8" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.8 </span>CLEVR</h3>

<div id="S4.SS8.p1" class="ltx_para">
<p id="S4.SS8.p1.4" class="ltx_p">To demonstrate the generality of our hard attention method, particularly in domains that are visually different from the VQA images,
we experiment with a synthetic Visual QA dataset termed CLEVR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, using a setup similar to the one used for VQA-CP and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
Due to the visual simplicity of CLEVR, we follow up the work of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, and instead of relying on the ImageNet pre-trained features, we train our HAN+sum and HAN+RN (hard attention with relation network) architectures end-to-end together with a relatively small CNN (following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>).

<br class="ltx_break"><span id="S4.SS8.p1.4.1" class="ltx_text ltx_font_bold">Analysis.</span>
As reported in prior work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, the soft attention mechanism used in SAN does not perform well on the CLEVR dataset, and achieves only <math id="S4.SS8.p1.1.m1.1" class="ltx_Math" alttext="68.5\%" display="inline"><semantics id="S4.SS8.p1.1.m1.1a"><mrow id="S4.SS8.p1.1.m1.1.1" xref="S4.SS8.p1.1.m1.1.1.cmml"><mn id="S4.SS8.p1.1.m1.1.1.2" xref="S4.SS8.p1.1.m1.1.1.2.cmml">68.5</mn><mo id="S4.SS8.p1.1.m1.1.1.1" xref="S4.SS8.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.1.m1.1b"><apply id="S4.SS8.p1.1.m1.1.1.cmml" xref="S4.SS8.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS8.p1.1.m1.1.1.1.cmml" xref="S4.SS8.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS8.p1.1.m1.1.1.2.cmml" xref="S4.SS8.p1.1.m1.1.1.2">68.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p1.1.m1.1c">68.5\%</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> (or <math id="S4.SS8.p1.2.m2.1" class="ltx_Math" alttext="76.6\%" display="inline"><semantics id="S4.SS8.p1.2.m2.1a"><mrow id="S4.SS8.p1.2.m2.1.1" xref="S4.SS8.p1.2.m2.1.1.cmml"><mn id="S4.SS8.p1.2.m2.1.1.2" xref="S4.SS8.p1.2.m2.1.1.2.cmml">76.6</mn><mo id="S4.SS8.p1.2.m2.1.1.1" xref="S4.SS8.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.2.m2.1b"><apply id="S4.SS8.p1.2.m2.1.1.cmml" xref="S4.SS8.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS8.p1.2.m2.1.1.1.cmml" xref="S4.SS8.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS8.p1.2.m2.1.1.2.cmml" xref="S4.SS8.p1.2.m2.1.1.2">76.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p1.2.m2.1c">76.6\%</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>) performance. In contrast, relation network, which also realizes a non-local and pairwise computational model, essentially solves this task, achieving <math id="S4.SS8.p1.3.m3.1" class="ltx_Math" alttext="95.5\%" display="inline"><semantics id="S4.SS8.p1.3.m3.1a"><mrow id="S4.SS8.p1.3.m3.1.1" xref="S4.SS8.p1.3.m3.1.1.cmml"><mn id="S4.SS8.p1.3.m3.1.1.2" xref="S4.SS8.p1.3.m3.1.1.2.cmml">95.5</mn><mo id="S4.SS8.p1.3.m3.1.1.1" xref="S4.SS8.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.3.m3.1b"><apply id="S4.SS8.p1.3.m3.1.1.cmml" xref="S4.SS8.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS8.p1.3.m3.1.1.1.cmml" xref="S4.SS8.p1.3.m3.1.1.1">percent</csymbol><cn type="float" id="S4.SS8.p1.3.m3.1.1.2.cmml" xref="S4.SS8.p1.3.m3.1.1.2">95.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p1.3.m3.1c">95.5\%</annotation></semantics></math> performance on the test set.
Surprisingly, our HAN+sum achieves
89.7%
performance even without a relation network, and HAN+RN (i.e.<span id="S4.SS8.p1.4.2" class="ltx_text"></span>, relation network is used as an aggregation mechanism) achieves
<math id="S4.SS8.p1.4.m4.1" class="ltx_Math" alttext="93.9\%" display="inline"><semantics id="S4.SS8.p1.4.m4.1a"><mrow id="S4.SS8.p1.4.m4.1.1" xref="S4.SS8.p1.4.m4.1.1.cmml"><mn id="S4.SS8.p1.4.m4.1.1.2" xref="S4.SS8.p1.4.m4.1.1.2.cmml">93.9</mn><mo id="S4.SS8.p1.4.m4.1.1.1" xref="S4.SS8.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.4.m4.1b"><apply id="S4.SS8.p1.4.m4.1.1.cmml" xref="S4.SS8.p1.4.m4.1.1"><csymbol cd="latexml" id="S4.SS8.p1.4.m4.1.1.1.cmml" xref="S4.SS8.p1.4.m4.1.1.1">percent</csymbol><cn type="float" id="S4.SS8.p1.4.m4.1.1.2.cmml" xref="S4.SS8.p1.4.m4.1.1.2">93.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p1.4.m4.1c">93.9\%</annotation></semantics></math> on the test set.
These results show the mechanism can readily be used with other architectures on another dataset with different visuals. Training with HAN requires far less computation than the original relation network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, although performance is slightly below relation network’s 95.5%. <a href="#S4.F5.sf1" title="5(a) ‣ Figure 5 ‣ 4.7 End-to-end Training. ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">5(a)</span></a> compares computation time: HAN+RN and relation network are trained for 12 hours under the same hyper-parameter set-up. Here, HAN+RN achieves around 90% validation accuracy, whereas relation network only 70%.</p>
</div>
<div id="S4.SS8.p2" class="ltx_para">
<p id="S4.SS8.p2.12" class="ltx_p">Owing to hard-attention, we are able to train larger models, which we call HAN+sum<sup id="S4.SS8.p2.12.1" class="ltx_sup"><span id="S4.SS8.p2.12.1.1" class="ltx_text ltx_font_italic">+</span></sup>, HAN+RN<sup id="S4.SS8.p2.12.2" class="ltx_sup"><span id="S4.SS8.p2.12.2.1" class="ltx_text ltx_font_italic">+</span></sup>, and HAN+RN<sup id="S4.SS8.p2.12.3" class="ltx_sup"><span id="S4.SS8.p2.12.3.1" class="ltx_text ltx_font_italic">++</span></sup>.
These models use larger CNN and LSTM, and HAN+RN<sup id="S4.SS8.p2.12.4" class="ltx_sup"><span id="S4.SS8.p2.12.4.1" class="ltx_text ltx_font_italic">++</span></sup> also uses higher resolution of the input (see Implementation Details below). The models
achieve 94.7%, 96.9% and 98.8% respectively.
The relation network with hard attention operates on <math id="S4.SS8.p2.5.m5.1" class="ltx_Math" alttext="k^{2}" display="inline"><semantics id="S4.SS8.p2.5.m5.1a"><msup id="S4.SS8.p2.5.m5.1.1" xref="S4.SS8.p2.5.m5.1.1.cmml"><mi id="S4.SS8.p2.5.m5.1.1.2" xref="S4.SS8.p2.5.m5.1.1.2.cmml">k</mi><mn id="S4.SS8.p2.5.m5.1.1.3" xref="S4.SS8.p2.5.m5.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS8.p2.5.m5.1b"><apply id="S4.SS8.p2.5.m5.1.1.cmml" xref="S4.SS8.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS8.p2.5.m5.1.1.1.cmml" xref="S4.SS8.p2.5.m5.1.1">superscript</csymbol><ci id="S4.SS8.p2.5.m5.1.1.2.cmml" xref="S4.SS8.p2.5.m5.1.1.2">𝑘</ci><cn type="integer" id="S4.SS8.p2.5.m5.1.1.3.cmml" xref="S4.SS8.p2.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p2.5.m5.1c">k^{2}</annotation></semantics></math> selected input cells, instead of all <math id="S4.SS8.p2.6.m6.1" class="ltx_Math" alttext="n^{2}" display="inline"><semantics id="S4.SS8.p2.6.m6.1a"><msup id="S4.SS8.p2.6.m6.1.1" xref="S4.SS8.p2.6.m6.1.1.cmml"><mi id="S4.SS8.p2.6.m6.1.1.2" xref="S4.SS8.p2.6.m6.1.1.2.cmml">n</mi><mn id="S4.SS8.p2.6.m6.1.1.3" xref="S4.SS8.p2.6.m6.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS8.p2.6.m6.1b"><apply id="S4.SS8.p2.6.m6.1.1.cmml" xref="S4.SS8.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS8.p2.6.m6.1.1.1.cmml" xref="S4.SS8.p2.6.m6.1.1">superscript</csymbol><ci id="S4.SS8.p2.6.m6.1.1.2.cmml" xref="S4.SS8.p2.6.m6.1.1.2">𝑛</ci><cn type="integer" id="S4.SS8.p2.6.m6.1.1.3.cmml" xref="S4.SS8.p2.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p2.6.m6.1c">n^{2}</annotation></semantics></math> cells of the original RN.
All our experiments except HAN+RN<sup id="S4.SS8.p2.12.5" class="ltx_sup"><span id="S4.SS8.p2.12.5.1" class="ltx_text ltx_font_italic">++</span></sup> use only one fourth of the input cells (<math id="S4.SS8.p2.8.m8.1" class="ltx_Math" alttext="\frac{k}{n}=0.25" display="inline"><semantics id="S4.SS8.p2.8.m8.1a"><mrow id="S4.SS8.p2.8.m8.1.1" xref="S4.SS8.p2.8.m8.1.1.cmml"><mfrac id="S4.SS8.p2.8.m8.1.1.2" xref="S4.SS8.p2.8.m8.1.1.2.cmml"><mi id="S4.SS8.p2.8.m8.1.1.2.2" xref="S4.SS8.p2.8.m8.1.1.2.2.cmml">k</mi><mi id="S4.SS8.p2.8.m8.1.1.2.3" xref="S4.SS8.p2.8.m8.1.1.2.3.cmml">n</mi></mfrac><mo id="S4.SS8.p2.8.m8.1.1.1" xref="S4.SS8.p2.8.m8.1.1.1.cmml">=</mo><mn id="S4.SS8.p2.8.m8.1.1.3" xref="S4.SS8.p2.8.m8.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p2.8.m8.1b"><apply id="S4.SS8.p2.8.m8.1.1.cmml" xref="S4.SS8.p2.8.m8.1.1"><eq id="S4.SS8.p2.8.m8.1.1.1.cmml" xref="S4.SS8.p2.8.m8.1.1.1"></eq><apply id="S4.SS8.p2.8.m8.1.1.2.cmml" xref="S4.SS8.p2.8.m8.1.1.2"><divide id="S4.SS8.p2.8.m8.1.1.2.1.cmml" xref="S4.SS8.p2.8.m8.1.1.2"></divide><ci id="S4.SS8.p2.8.m8.1.1.2.2.cmml" xref="S4.SS8.p2.8.m8.1.1.2.2">𝑘</ci><ci id="S4.SS8.p2.8.m8.1.1.2.3.cmml" xref="S4.SS8.p2.8.m8.1.1.2.3">𝑛</ci></apply><cn type="float" id="S4.SS8.p2.8.m8.1.1.3.cmml" xref="S4.SS8.p2.8.m8.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p2.8.m8.1c">\frac{k}{n}=0.25</annotation></semantics></math>, where <math id="S4.SS8.p2.9.m9.1" class="ltx_Math" alttext="n=64" display="inline"><semantics id="S4.SS8.p2.9.m9.1a"><mrow id="S4.SS8.p2.9.m9.1.1" xref="S4.SS8.p2.9.m9.1.1.cmml"><mi id="S4.SS8.p2.9.m9.1.1.2" xref="S4.SS8.p2.9.m9.1.1.2.cmml">n</mi><mo id="S4.SS8.p2.9.m9.1.1.1" xref="S4.SS8.p2.9.m9.1.1.1.cmml">=</mo><mn id="S4.SS8.p2.9.m9.1.1.3" xref="S4.SS8.p2.9.m9.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p2.9.m9.1b"><apply id="S4.SS8.p2.9.m9.1.1.cmml" xref="S4.SS8.p2.9.m9.1.1"><eq id="S4.SS8.p2.9.m9.1.1.1.cmml" xref="S4.SS8.p2.9.m9.1.1.1"></eq><ci id="S4.SS8.p2.9.m9.1.1.2.cmml" xref="S4.SS8.p2.9.m9.1.1.2">𝑛</ci><cn type="integer" id="S4.SS8.p2.9.m9.1.1.3.cmml" xref="S4.SS8.p2.9.m9.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p2.9.m9.1c">n=64</annotation></semantics></math>). HAN+RN<sup id="S4.SS8.p2.12.6" class="ltx_sup"><span id="S4.SS8.p2.12.6.1" class="ltx_text ltx_font_italic">++</span></sup> uses a larger spatial tensor (14x14), and the same number of input cells as the original RN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, with <math id="S4.SS8.p2.11.m11.1" class="ltx_Math" alttext="k=64" display="inline"><semantics id="S4.SS8.p2.11.m11.1a"><mrow id="S4.SS8.p2.11.m11.1.1" xref="S4.SS8.p2.11.m11.1.1.cmml"><mi id="S4.SS8.p2.11.m11.1.1.2" xref="S4.SS8.p2.11.m11.1.1.2.cmml">k</mi><mo id="S4.SS8.p2.11.m11.1.1.1" xref="S4.SS8.p2.11.m11.1.1.1.cmml">=</mo><mn id="S4.SS8.p2.11.m11.1.1.3" xref="S4.SS8.p2.11.m11.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p2.11.m11.1b"><apply id="S4.SS8.p2.11.m11.1.1.cmml" xref="S4.SS8.p2.11.m11.1.1"><eq id="S4.SS8.p2.11.m11.1.1.1.cmml" xref="S4.SS8.p2.11.m11.1.1.1"></eq><ci id="S4.SS8.p2.11.m11.1.1.2.cmml" xref="S4.SS8.p2.11.m11.1.1.2">𝑘</ci><cn type="integer" id="S4.SS8.p2.11.m11.1.1.3.cmml" xref="S4.SS8.p2.11.m11.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p2.11.m11.1c">k=64</annotation></semantics></math> yielding (<math id="S4.SS8.p2.12.m12.1" class="ltx_math_unparsed" alttext="\frac{k}{n}=\frac{64}{196})" display="inline"><semantics id="S4.SS8.p2.12.m12.1a"><mrow id="S4.SS8.p2.12.m12.1b"><mfrac id="S4.SS8.p2.12.m12.1.1"><mi id="S4.SS8.p2.12.m12.1.1.2">k</mi><mi id="S4.SS8.p2.12.m12.1.1.3">n</mi></mfrac><mo id="S4.SS8.p2.12.m12.1.2">=</mo><mfrac id="S4.SS8.p2.12.m12.1.3"><mn id="S4.SS8.p2.12.m12.1.3.2">64</mn><mn id="S4.SS8.p2.12.m12.1.3.3">196</mn></mfrac><mo stretchy="false" id="S4.SS8.p2.12.m12.1.4">)</mo></mrow><annotation encoding="application/x-tex" id="S4.SS8.p2.12.m12.1c">\frac{k}{n}=\frac{64}{196})</annotation></semantics></math> around 33% of the input cells. Dealing with only the fraction of the input data helps the whole network to train faster.</p>
</div>
<div id="S4.SS8.p3" class="ltx_para">
<p id="S4.SS8.p3.4" class="ltx_p"><a href="#S4.T4" title="Table 4 ‣ 4.8 CLEVR ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 4</span></a> gives more context regarding the results on the CLEVR dataset that we are aware of, and compares our method with other approaches to answer questions about CLEVR images. Our best performing method, denoted by HAN+RN<sup id="S4.SS8.p3.4.1" class="ltx_sup"><span id="S4.SS8.p3.4.1.1" class="ltx_text ltx_font_italic">++</span></sup> that uses a deeper model and operates on larger input tensor than the original RN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, is very competitive to alternative approaches such us FiLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, TbD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>, or MAC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>; and as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> (TbD+hres) have noted increasing the spatial resolution definitely helps in achieving better performance.
As we can see in <a href="#S4.T4" title="Table 4 ‣ 4.8 CLEVR ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 4</span></a>, all the approaches seem to struggle with difficult counting questions, and RN is significantly worse on the <span id="S4.SS8.p3.4.2" class="ltx_text ltx_font_italic">Compare Numbers</span> questions. In the remaining question types, HAN+RN<sup id="S4.SS8.p3.4.3" class="ltx_sup"><span id="S4.SS8.p3.4.3.1" class="ltx_text ltx_font_italic">++</span></sup> is either on par or even better than TbD+hres that uses larger spatial resolution, deep pre-trained image CNN, more specialized modules, and requires an “expert layout” <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>.
Here, we keep the conceptual simplicity of the original RN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> coupled with our simple mechanism of selecting important features, as well as we trained the whole architecture end-to-end and from scratch.
Finally, through a visual inspection, we have observed that the fraction of input cells that we have experimented with (<math id="S4.SS8.p3.3.m3.1" class="ltx_Math" alttext="k=16" display="inline"><semantics id="S4.SS8.p3.3.m3.1a"><mrow id="S4.SS8.p3.3.m3.1.1" xref="S4.SS8.p3.3.m3.1.1.cmml"><mi id="S4.SS8.p3.3.m3.1.1.2" xref="S4.SS8.p3.3.m3.1.1.2.cmml">k</mi><mo id="S4.SS8.p3.3.m3.1.1.1" xref="S4.SS8.p3.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS8.p3.3.m3.1.1.3" xref="S4.SS8.p3.3.m3.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p3.3.m3.1b"><apply id="S4.SS8.p3.3.m3.1.1.cmml" xref="S4.SS8.p3.3.m3.1.1"><eq id="S4.SS8.p3.3.m3.1.1.1.cmml" xref="S4.SS8.p3.3.m3.1.1.1"></eq><ci id="S4.SS8.p3.3.m3.1.1.2.cmml" xref="S4.SS8.p3.3.m3.1.1.2">𝑘</ci><cn type="integer" id="S4.SS8.p3.3.m3.1.1.3.cmml" xref="S4.SS8.p3.3.m3.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p3.3.m3.1c">k=16</annotation></semantics></math> for 8x8 spatial tensor, and <math id="S4.SS8.p3.4.m4.1" class="ltx_Math" alttext="k=64" display="inline"><semantics id="S4.SS8.p3.4.m4.1a"><mrow id="S4.SS8.p3.4.m4.1.1" xref="S4.SS8.p3.4.m4.1.1.cmml"><mi id="S4.SS8.p3.4.m4.1.1.2" xref="S4.SS8.p3.4.m4.1.1.2.cmml">k</mi><mo id="S4.SS8.p3.4.m4.1.1.1" xref="S4.SS8.p3.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS8.p3.4.m4.1.1.3" xref="S4.SS8.p3.4.m4.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p3.4.m4.1b"><apply id="S4.SS8.p3.4.m4.1.1.cmml" xref="S4.SS8.p3.4.m4.1.1"><eq id="S4.SS8.p3.4.m4.1.1.1.cmml" xref="S4.SS8.p3.4.m4.1.1.1"></eq><ci id="S4.SS8.p3.4.m4.1.1.2.cmml" xref="S4.SS8.p3.4.m4.1.1.2">𝑘</ci><cn type="integer" id="S4.SS8.p3.4.m4.1.1.3.cmml" xref="S4.SS8.p3.4.m4.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p3.4.m4.1c">k=64</annotation></semantics></math> for 14x14 spatial tensor) is sufficient to cover all the important objects in the image, and thus the mechanism resembles more the saliency mechanism. It is worth noting, the hard-attention mechanism often selects a few cells that correspond to the object as this is sufficient to recognize the object’s properties such as size, material, color, type, and spatial location.</p>
</div>
<div id="S4.SS8.p4" class="ltx_para ltx_noindent">
<p id="S4.SS8.p4.3" class="ltx_p"><span id="S4.SS8.p4.3.1" class="ltx_text ltx_font_bold">Straight-Through Estimator.</span>
As an alternative to our hard attention, we have also implemented a few variants of the straight-through estimator <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, which is a method introduced to deal with non-differentiable neural modules.
In a nutshell, during the forward pass we employ steps that are non-differentiable or have gradients that are zero almost everywhere (e.g., hard thresholding), but in the backward pass, we introduce skip-connections that the back-propagation mechanism uses to bypass these steps.
For the purpose of gracefully implementing this mechanism in TensorFlow, we have implemented the estimator as follows<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Credit goes to Sergey Ioffe for pointing out the general expression that we have adapted for our purpose.</span></span></span>. Let <math id="S4.SS8.p4.1.m1.1" class="ltx_Math" alttext="\boldsymbol{x}\in\mathbb{R}^{n\times d}" display="inline"><semantics id="S4.SS8.p4.1.m1.1a"><mrow id="S4.SS8.p4.1.m1.1.1" xref="S4.SS8.p4.1.m1.1.1.cmml"><mi id="S4.SS8.p4.1.m1.1.1.2" xref="S4.SS8.p4.1.m1.1.1.2.cmml">𝒙</mi><mo id="S4.SS8.p4.1.m1.1.1.1" xref="S4.SS8.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS8.p4.1.m1.1.1.3" xref="S4.SS8.p4.1.m1.1.1.3.cmml"><mi id="S4.SS8.p4.1.m1.1.1.3.2" xref="S4.SS8.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS8.p4.1.m1.1.1.3.3" xref="S4.SS8.p4.1.m1.1.1.3.3.cmml"><mi id="S4.SS8.p4.1.m1.1.1.3.3.2" xref="S4.SS8.p4.1.m1.1.1.3.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS8.p4.1.m1.1.1.3.3.1" xref="S4.SS8.p4.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS8.p4.1.m1.1.1.3.3.3" xref="S4.SS8.p4.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.1.m1.1b"><apply id="S4.SS8.p4.1.m1.1.1.cmml" xref="S4.SS8.p4.1.m1.1.1"><in id="S4.SS8.p4.1.m1.1.1.1.cmml" xref="S4.SS8.p4.1.m1.1.1.1"></in><ci id="S4.SS8.p4.1.m1.1.1.2.cmml" xref="S4.SS8.p4.1.m1.1.1.2">𝒙</ci><apply id="S4.SS8.p4.1.m1.1.1.3.cmml" xref="S4.SS8.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS8.p4.1.m1.1.1.3.1.cmml" xref="S4.SS8.p4.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS8.p4.1.m1.1.1.3.2.cmml" xref="S4.SS8.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS8.p4.1.m1.1.1.3.3.cmml" xref="S4.SS8.p4.1.m1.1.1.3.3"><times id="S4.SS8.p4.1.m1.1.1.3.3.1.cmml" xref="S4.SS8.p4.1.m1.1.1.3.3.1"></times><ci id="S4.SS8.p4.1.m1.1.1.3.3.2.cmml" xref="S4.SS8.p4.1.m1.1.1.3.3.2">𝑛</ci><ci id="S4.SS8.p4.1.m1.1.1.3.3.3.cmml" xref="S4.SS8.p4.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.1.m1.1c">\boldsymbol{x}\in\mathbb{R}^{n\times d}</annotation></semantics></math> be spatial input, with <math id="S4.SS8.p4.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS8.p4.2.m2.1a"><mi id="S4.SS8.p4.2.m2.1.1" xref="S4.SS8.p4.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.2.m2.1b"><ci id="S4.SS8.p4.2.m2.1.1.cmml" xref="S4.SS8.p4.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.2.m2.1c">n</annotation></semantics></math> spatial cells, each <math id="S4.SS8.p4.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS8.p4.3.m3.1a"><mi id="S4.SS8.p4.3.m3.1.1" xref="S4.SS8.p4.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.3.m3.1b"><ci id="S4.SS8.p4.3.m3.1.1.cmml" xref="S4.SS8.p4.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.3.m3.1c">d</annotation></semantics></math>-dimensional. All our estimators have the form</p>
<table id="S5.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex1.m1.6" class="ltx_Math" alttext="\displaystyle\boldsymbol{x}\cdot(g(\boldsymbol{x})+\text{stop}(\mathbbm{1}\left\{g(\boldsymbol{x})&gt;t(g(\boldsymbol{x}),k)\right\}-g(\boldsymbol{x})))" display="inline"><semantics id="S4.Ex1.m1.6a"><mrow id="S4.Ex1.m1.6.6" xref="S4.Ex1.m1.6.6.cmml"><mi id="S4.Ex1.m1.6.6.3" xref="S4.Ex1.m1.6.6.3.cmml">𝒙</mi><mo lspace="0.222em" rspace="0.222em" id="S4.Ex1.m1.6.6.2" xref="S4.Ex1.m1.6.6.2.cmml">⋅</mo><mrow id="S4.Ex1.m1.6.6.1.1" xref="S4.Ex1.m1.6.6.1.1.1.cmml"><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.2" xref="S4.Ex1.m1.6.6.1.1.1.cmml">(</mo><mrow id="S4.Ex1.m1.6.6.1.1.1" xref="S4.Ex1.m1.6.6.1.1.1.cmml"><mrow id="S4.Ex1.m1.6.6.1.1.1.3" xref="S4.Ex1.m1.6.6.1.1.1.3.cmml"><mi id="S4.Ex1.m1.6.6.1.1.1.3.2" xref="S4.Ex1.m1.6.6.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.6.6.1.1.1.3.1" xref="S4.Ex1.m1.6.6.1.1.1.3.1.cmml">​</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.3.3.2" xref="S4.Ex1.m1.6.6.1.1.1.3.cmml"><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.1.3.3.2.1" xref="S4.Ex1.m1.6.6.1.1.1.3.cmml">(</mo><mi id="S4.Ex1.m1.1.1" xref="S4.Ex1.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.1.3.3.2.2" xref="S4.Ex1.m1.6.6.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.Ex1.m1.6.6.1.1.1.2" xref="S4.Ex1.m1.6.6.1.1.1.2.cmml">+</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.1" xref="S4.Ex1.m1.6.6.1.1.1.1.cmml"><mtext id="S4.Ex1.m1.6.6.1.1.1.1.3" xref="S4.Ex1.m1.6.6.1.1.1.1.3a.cmml">stop</mtext><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.6.6.1.1.1.1.2" xref="S4.Ex1.m1.6.6.1.1.1.1.2.cmml">​</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.cmml"><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mn id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">𝟙</mn><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.Ex1.m1.2.2" xref="S4.Ex1.m1.2.2.cmml">𝒙</mi><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml">&gt;</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.Ex1.m1.3.3" xref="S4.Ex1.m1.3.3.cmml">𝒙</mi><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S4.Ex1.m1.4.4" xref="S4.Ex1.m1.4.4.cmml">k</mi><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.3.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.3.2.1" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.Ex1.m1.5.5" xref="S4.Ex1.m1.5.5.cmml">𝒙</mi><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.3.2.2" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.3" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.Ex1.m1.6.6.1.1.3" xref="S4.Ex1.m1.6.6.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.6b"><apply id="S4.Ex1.m1.6.6.cmml" xref="S4.Ex1.m1.6.6"><ci id="S4.Ex1.m1.6.6.2.cmml" xref="S4.Ex1.m1.6.6.2">⋅</ci><ci id="S4.Ex1.m1.6.6.3.cmml" xref="S4.Ex1.m1.6.6.3">𝒙</ci><apply id="S4.Ex1.m1.6.6.1.1.1.cmml" xref="S4.Ex1.m1.6.6.1.1"><plus id="S4.Ex1.m1.6.6.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.1.1.1.2"></plus><apply id="S4.Ex1.m1.6.6.1.1.1.3.cmml" xref="S4.Ex1.m1.6.6.1.1.1.3"><times id="S4.Ex1.m1.6.6.1.1.1.3.1.cmml" xref="S4.Ex1.m1.6.6.1.1.1.3.1"></times><ci id="S4.Ex1.m1.6.6.1.1.1.3.2.cmml" xref="S4.Ex1.m1.6.6.1.1.1.3.2">𝑔</ci><ci id="S4.Ex1.m1.1.1.cmml" xref="S4.Ex1.m1.1.1">𝒙</ci></apply><apply id="S4.Ex1.m1.6.6.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1"><times id="S4.Ex1.m1.6.6.1.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.2"></times><ci id="S4.Ex1.m1.6.6.1.1.1.1.3a.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.3"><mtext id="S4.Ex1.m1.6.6.1.1.1.1.3.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.3">stop</mtext></ci><apply id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1"><minus id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.2"></minus><apply id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1"><times id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.2"></times><cn type="integer" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.3">1</cn><set id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1"><apply id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><gt id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2"></gt><apply id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="S4.Ex1.m1.2.2.cmml" xref="S4.Ex1.m1.2.2">𝒙</ci></apply><apply id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci><interval closure="open" id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑔</ci><ci id="S4.Ex1.m1.3.3.cmml" xref="S4.Ex1.m1.3.3">𝒙</ci></apply><ci id="S4.Ex1.m1.4.4.cmml" xref="S4.Ex1.m1.4.4">𝑘</ci></interval></apply></apply></set></apply><apply id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3"><times id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.1"></times><ci id="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex1.m1.6.6.1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="S4.Ex1.m1.5.5.cmml" xref="S4.Ex1.m1.5.5">𝒙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.6c">\displaystyle\boldsymbol{x}\cdot(g(\boldsymbol{x})+\text{stop}(\mathbbm{1}\left\{g(\boldsymbol{x})&gt;t(g(\boldsymbol{x}),k)\right\}-g(\boldsymbol{x})))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS8.p4.19" class="ltx_p">Here, <math id="S4.SS8.p4.4.m1.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="S4.SS8.p4.4.m1.1a"><mo id="S4.SS8.p4.4.m1.1.1" xref="S4.SS8.p4.4.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.4.m1.1b"><ci id="S4.SS8.p4.4.m1.1.1.cmml" xref="S4.SS8.p4.4.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.4.m1.1c">\cdot</annotation></semantics></math> is the element-wise multiplication, <math id="S4.SS8.p4.5.m2.1" class="ltx_Math" alttext="\text{stop}(\boldsymbol{y})" display="inline"><semantics id="S4.SS8.p4.5.m2.1a"><mrow id="S4.SS8.p4.5.m2.1.2" xref="S4.SS8.p4.5.m2.1.2.cmml"><mtext id="S4.SS8.p4.5.m2.1.2.2" xref="S4.SS8.p4.5.m2.1.2.2a.cmml">stop</mtext><mo lspace="0em" rspace="0em" id="S4.SS8.p4.5.m2.1.2.1" xref="S4.SS8.p4.5.m2.1.2.1.cmml">​</mo><mrow id="S4.SS8.p4.5.m2.1.2.3.2" xref="S4.SS8.p4.5.m2.1.2.cmml"><mo stretchy="false" id="S4.SS8.p4.5.m2.1.2.3.2.1" xref="S4.SS8.p4.5.m2.1.2.cmml">(</mo><mi id="S4.SS8.p4.5.m2.1.1" xref="S4.SS8.p4.5.m2.1.1.cmml">𝒚</mi><mo stretchy="false" id="S4.SS8.p4.5.m2.1.2.3.2.2" xref="S4.SS8.p4.5.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.5.m2.1b"><apply id="S4.SS8.p4.5.m2.1.2.cmml" xref="S4.SS8.p4.5.m2.1.2"><times id="S4.SS8.p4.5.m2.1.2.1.cmml" xref="S4.SS8.p4.5.m2.1.2.1"></times><ci id="S4.SS8.p4.5.m2.1.2.2a.cmml" xref="S4.SS8.p4.5.m2.1.2.2"><mtext id="S4.SS8.p4.5.m2.1.2.2.cmml" xref="S4.SS8.p4.5.m2.1.2.2">stop</mtext></ci><ci id="S4.SS8.p4.5.m2.1.1.cmml" xref="S4.SS8.p4.5.m2.1.1">𝒚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.5.m2.1c">\text{stop}(\boldsymbol{y})</annotation></semantics></math> prevents from propagating the gradient through <math id="S4.SS8.p4.6.m3.1" class="ltx_Math" alttext="\boldsymbol{y}" display="inline"><semantics id="S4.SS8.p4.6.m3.1a"><mi id="S4.SS8.p4.6.m3.1.1" xref="S4.SS8.p4.6.m3.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.6.m3.1b"><ci id="S4.SS8.p4.6.m3.1.1.cmml" xref="S4.SS8.p4.6.m3.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.6.m3.1c">\boldsymbol{y}</annotation></semantics></math>, <math id="S4.SS8.p4.7.m4.2" class="ltx_Math" alttext="t(\boldsymbol{y},k)" display="inline"><semantics id="S4.SS8.p4.7.m4.2a"><mrow id="S4.SS8.p4.7.m4.2.3" xref="S4.SS8.p4.7.m4.2.3.cmml"><mi id="S4.SS8.p4.7.m4.2.3.2" xref="S4.SS8.p4.7.m4.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS8.p4.7.m4.2.3.1" xref="S4.SS8.p4.7.m4.2.3.1.cmml">​</mo><mrow id="S4.SS8.p4.7.m4.2.3.3.2" xref="S4.SS8.p4.7.m4.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS8.p4.7.m4.2.3.3.2.1" xref="S4.SS8.p4.7.m4.2.3.3.1.cmml">(</mo><mi id="S4.SS8.p4.7.m4.1.1" xref="S4.SS8.p4.7.m4.1.1.cmml">𝒚</mi><mo id="S4.SS8.p4.7.m4.2.3.3.2.2" xref="S4.SS8.p4.7.m4.2.3.3.1.cmml">,</mo><mi id="S4.SS8.p4.7.m4.2.2" xref="S4.SS8.p4.7.m4.2.2.cmml">k</mi><mo stretchy="false" id="S4.SS8.p4.7.m4.2.3.3.2.3" xref="S4.SS8.p4.7.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.7.m4.2b"><apply id="S4.SS8.p4.7.m4.2.3.cmml" xref="S4.SS8.p4.7.m4.2.3"><times id="S4.SS8.p4.7.m4.2.3.1.cmml" xref="S4.SS8.p4.7.m4.2.3.1"></times><ci id="S4.SS8.p4.7.m4.2.3.2.cmml" xref="S4.SS8.p4.7.m4.2.3.2">𝑡</ci><interval closure="open" id="S4.SS8.p4.7.m4.2.3.3.1.cmml" xref="S4.SS8.p4.7.m4.2.3.3.2"><ci id="S4.SS8.p4.7.m4.1.1.cmml" xref="S4.SS8.p4.7.m4.1.1">𝒚</ci><ci id="S4.SS8.p4.7.m4.2.2.cmml" xref="S4.SS8.p4.7.m4.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.7.m4.2c">t(\boldsymbol{y},k)</annotation></semantics></math> returns the <math id="S4.SS8.p4.8.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS8.p4.8.m5.1a"><mi id="S4.SS8.p4.8.m5.1.1" xref="S4.SS8.p4.8.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.8.m5.1b"><ci id="S4.SS8.p4.8.m5.1.1.cmml" xref="S4.SS8.p4.8.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.8.m5.1c">k</annotation></semantics></math>-th largest element of the vector <math id="S4.SS8.p4.9.m6.1" class="ltx_Math" alttext="\boldsymbol{y}" display="inline"><semantics id="S4.SS8.p4.9.m6.1a"><mi id="S4.SS8.p4.9.m6.1.1" xref="S4.SS8.p4.9.m6.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.9.m6.1b"><ci id="S4.SS8.p4.9.m6.1.1.cmml" xref="S4.SS8.p4.9.m6.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.9.m6.1c">\boldsymbol{y}</annotation></semantics></math>, <math id="S4.SS8.p4.10.m7.1" class="ltx_Math" alttext="\mathbbm{1}\left\{\mathcal{P}\right\}" display="inline"><semantics id="S4.SS8.p4.10.m7.1a"><mrow id="S4.SS8.p4.10.m7.1.2" xref="S4.SS8.p4.10.m7.1.2.cmml"><mn id="S4.SS8.p4.10.m7.1.2.2" xref="S4.SS8.p4.10.m7.1.2.2.cmml">𝟙</mn><mo lspace="0em" rspace="0em" id="S4.SS8.p4.10.m7.1.2.1" xref="S4.SS8.p4.10.m7.1.2.1.cmml">​</mo><mrow id="S4.SS8.p4.10.m7.1.2.3.2" xref="S4.SS8.p4.10.m7.1.2.3.1.cmml"><mo id="S4.SS8.p4.10.m7.1.2.3.2.1" xref="S4.SS8.p4.10.m7.1.2.3.1.cmml">{</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS8.p4.10.m7.1.1" xref="S4.SS8.p4.10.m7.1.1.cmml">𝒫</mi><mo id="S4.SS8.p4.10.m7.1.2.3.2.2" xref="S4.SS8.p4.10.m7.1.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.10.m7.1b"><apply id="S4.SS8.p4.10.m7.1.2.cmml" xref="S4.SS8.p4.10.m7.1.2"><times id="S4.SS8.p4.10.m7.1.2.1.cmml" xref="S4.SS8.p4.10.m7.1.2.1"></times><cn type="integer" id="S4.SS8.p4.10.m7.1.2.2.cmml" xref="S4.SS8.p4.10.m7.1.2.2">1</cn><set id="S4.SS8.p4.10.m7.1.2.3.1.cmml" xref="S4.SS8.p4.10.m7.1.2.3.2"><ci id="S4.SS8.p4.10.m7.1.1.cmml" xref="S4.SS8.p4.10.m7.1.1">𝒫</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.10.m7.1c">\mathbbm{1}\left\{\mathcal{P}\right\}</annotation></semantics></math> outputs 1 if the predicate <math id="S4.SS8.p4.11.m8.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S4.SS8.p4.11.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS8.p4.11.m8.1.1" xref="S4.SS8.p4.11.m8.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.11.m8.1b"><ci id="S4.SS8.p4.11.m8.1.1.cmml" xref="S4.SS8.p4.11.m8.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.11.m8.1c">\mathcal{P}</annotation></semantics></math> is true and 0 otherwise, and <math id="S4.SS8.p4.12.m9.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.SS8.p4.12.m9.1a"><mi id="S4.SS8.p4.12.m9.1.1" xref="S4.SS8.p4.12.m9.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.12.m9.1b"><ci id="S4.SS8.p4.12.m9.1.1.cmml" xref="S4.SS8.p4.12.m9.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.12.m9.1c">g</annotation></semantics></math> produces a spatial mask similar to the soft attention mask, i.e. <math id="S4.SS8.p4.13.m10.1" class="ltx_Math" alttext="g(\boldsymbol{y})\in\mathbb{R}^{n\times 1}" display="inline"><semantics id="S4.SS8.p4.13.m10.1a"><mrow id="S4.SS8.p4.13.m10.1.2" xref="S4.SS8.p4.13.m10.1.2.cmml"><mrow id="S4.SS8.p4.13.m10.1.2.2" xref="S4.SS8.p4.13.m10.1.2.2.cmml"><mi id="S4.SS8.p4.13.m10.1.2.2.2" xref="S4.SS8.p4.13.m10.1.2.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS8.p4.13.m10.1.2.2.1" xref="S4.SS8.p4.13.m10.1.2.2.1.cmml">​</mo><mrow id="S4.SS8.p4.13.m10.1.2.2.3.2" xref="S4.SS8.p4.13.m10.1.2.2.cmml"><mo stretchy="false" id="S4.SS8.p4.13.m10.1.2.2.3.2.1" xref="S4.SS8.p4.13.m10.1.2.2.cmml">(</mo><mi id="S4.SS8.p4.13.m10.1.1" xref="S4.SS8.p4.13.m10.1.1.cmml">𝒚</mi><mo stretchy="false" id="S4.SS8.p4.13.m10.1.2.2.3.2.2" xref="S4.SS8.p4.13.m10.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS8.p4.13.m10.1.2.1" xref="S4.SS8.p4.13.m10.1.2.1.cmml">∈</mo><msup id="S4.SS8.p4.13.m10.1.2.3" xref="S4.SS8.p4.13.m10.1.2.3.cmml"><mi id="S4.SS8.p4.13.m10.1.2.3.2" xref="S4.SS8.p4.13.m10.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS8.p4.13.m10.1.2.3.3" xref="S4.SS8.p4.13.m10.1.2.3.3.cmml"><mi id="S4.SS8.p4.13.m10.1.2.3.3.2" xref="S4.SS8.p4.13.m10.1.2.3.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS8.p4.13.m10.1.2.3.3.1" xref="S4.SS8.p4.13.m10.1.2.3.3.1.cmml">×</mo><mn id="S4.SS8.p4.13.m10.1.2.3.3.3" xref="S4.SS8.p4.13.m10.1.2.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.13.m10.1b"><apply id="S4.SS8.p4.13.m10.1.2.cmml" xref="S4.SS8.p4.13.m10.1.2"><in id="S4.SS8.p4.13.m10.1.2.1.cmml" xref="S4.SS8.p4.13.m10.1.2.1"></in><apply id="S4.SS8.p4.13.m10.1.2.2.cmml" xref="S4.SS8.p4.13.m10.1.2.2"><times id="S4.SS8.p4.13.m10.1.2.2.1.cmml" xref="S4.SS8.p4.13.m10.1.2.2.1"></times><ci id="S4.SS8.p4.13.m10.1.2.2.2.cmml" xref="S4.SS8.p4.13.m10.1.2.2.2">𝑔</ci><ci id="S4.SS8.p4.13.m10.1.1.cmml" xref="S4.SS8.p4.13.m10.1.1">𝒚</ci></apply><apply id="S4.SS8.p4.13.m10.1.2.3.cmml" xref="S4.SS8.p4.13.m10.1.2.3"><csymbol cd="ambiguous" id="S4.SS8.p4.13.m10.1.2.3.1.cmml" xref="S4.SS8.p4.13.m10.1.2.3">superscript</csymbol><ci id="S4.SS8.p4.13.m10.1.2.3.2.cmml" xref="S4.SS8.p4.13.m10.1.2.3.2">ℝ</ci><apply id="S4.SS8.p4.13.m10.1.2.3.3.cmml" xref="S4.SS8.p4.13.m10.1.2.3.3"><times id="S4.SS8.p4.13.m10.1.2.3.3.1.cmml" xref="S4.SS8.p4.13.m10.1.2.3.3.1"></times><ci id="S4.SS8.p4.13.m10.1.2.3.3.2.cmml" xref="S4.SS8.p4.13.m10.1.2.3.3.2">𝑛</ci><cn type="integer" id="S4.SS8.p4.13.m10.1.2.3.3.3.cmml" xref="S4.SS8.p4.13.m10.1.2.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.13.m10.1c">g(\boldsymbol{y})\in\mathbb{R}^{n\times 1}</annotation></semantics></math>. In all our experiments, <math id="S4.SS8.p4.14.m11.1" class="ltx_Math" alttext="g=\mu\circ f" display="inline"><semantics id="S4.SS8.p4.14.m11.1a"><mrow id="S4.SS8.p4.14.m11.1.1" xref="S4.SS8.p4.14.m11.1.1.cmml"><mi id="S4.SS8.p4.14.m11.1.1.2" xref="S4.SS8.p4.14.m11.1.1.2.cmml">g</mi><mo id="S4.SS8.p4.14.m11.1.1.1" xref="S4.SS8.p4.14.m11.1.1.1.cmml">=</mo><mrow id="S4.SS8.p4.14.m11.1.1.3" xref="S4.SS8.p4.14.m11.1.1.3.cmml"><mi id="S4.SS8.p4.14.m11.1.1.3.2" xref="S4.SS8.p4.14.m11.1.1.3.2.cmml">μ</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS8.p4.14.m11.1.1.3.1" xref="S4.SS8.p4.14.m11.1.1.3.1.cmml">∘</mo><mi id="S4.SS8.p4.14.m11.1.1.3.3" xref="S4.SS8.p4.14.m11.1.1.3.3.cmml">f</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.14.m11.1b"><apply id="S4.SS8.p4.14.m11.1.1.cmml" xref="S4.SS8.p4.14.m11.1.1"><eq id="S4.SS8.p4.14.m11.1.1.1.cmml" xref="S4.SS8.p4.14.m11.1.1.1"></eq><ci id="S4.SS8.p4.14.m11.1.1.2.cmml" xref="S4.SS8.p4.14.m11.1.1.2">𝑔</ci><apply id="S4.SS8.p4.14.m11.1.1.3.cmml" xref="S4.SS8.p4.14.m11.1.1.3"><compose id="S4.SS8.p4.14.m11.1.1.3.1.cmml" xref="S4.SS8.p4.14.m11.1.1.3.1"></compose><ci id="S4.SS8.p4.14.m11.1.1.3.2.cmml" xref="S4.SS8.p4.14.m11.1.1.3.2">𝜇</ci><ci id="S4.SS8.p4.14.m11.1.1.3.3.cmml" xref="S4.SS8.p4.14.m11.1.1.3.3">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.14.m11.1c">g=\mu\circ f</annotation></semantics></math> is the composition of the normalization function (e.g. softmax) <math id="S4.SS8.p4.15.m12.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS8.p4.15.m12.1a"><mi id="S4.SS8.p4.15.m12.1.1" xref="S4.SS8.p4.15.m12.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.15.m12.1b"><ci id="S4.SS8.p4.15.m12.1.1.cmml" xref="S4.SS8.p4.15.m12.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.15.m12.1c">\mu</annotation></semantics></math> and an MLP <math id="S4.SS8.p4.16.m13.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S4.SS8.p4.16.m13.1a"><mi id="S4.SS8.p4.16.m13.1.1" xref="S4.SS8.p4.16.m13.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.16.m13.1b"><ci id="S4.SS8.p4.16.m13.1.1.cmml" xref="S4.SS8.p4.16.m13.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.16.m13.1c">f</annotation></semantics></math> with one hidden layer of dimension <math id="S4.SS8.p4.17.m14.1" class="ltx_Math" alttext="\frac{d}{2}" display="inline"><semantics id="S4.SS8.p4.17.m14.1a"><mfrac id="S4.SS8.p4.17.m14.1.1" xref="S4.SS8.p4.17.m14.1.1.cmml"><mi id="S4.SS8.p4.17.m14.1.1.2" xref="S4.SS8.p4.17.m14.1.1.2.cmml">d</mi><mn id="S4.SS8.p4.17.m14.1.1.3" xref="S4.SS8.p4.17.m14.1.1.3.cmml">2</mn></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.17.m14.1b"><apply id="S4.SS8.p4.17.m14.1.1.cmml" xref="S4.SS8.p4.17.m14.1.1"><divide id="S4.SS8.p4.17.m14.1.1.1.cmml" xref="S4.SS8.p4.17.m14.1.1"></divide><ci id="S4.SS8.p4.17.m14.1.1.2.cmml" xref="S4.SS8.p4.17.m14.1.1.2">𝑑</ci><cn type="integer" id="S4.SS8.p4.17.m14.1.1.3.cmml" xref="S4.SS8.p4.17.m14.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.17.m14.1c">\frac{d}{2}</annotation></semantics></math>, and one ReLU between the hidden and the output layers. For <math id="S4.SS8.p4.18.m15.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS8.p4.18.m15.1a"><mi id="S4.SS8.p4.18.m15.1.1" xref="S4.SS8.p4.18.m15.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.18.m15.1b"><ci id="S4.SS8.p4.18.m15.1.1.cmml" xref="S4.SS8.p4.18.m15.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.18.m15.1c">\mu</annotation></semantics></math>, we investigate identity, sigmoid or softmax. Only the latter two yield results significantly better than <math id="S4.SS8.p4.19.m16.1" class="ltx_Math" alttext="60\%" display="inline"><semantics id="S4.SS8.p4.19.m16.1a"><mrow id="S4.SS8.p4.19.m16.1.1" xref="S4.SS8.p4.19.m16.1.1.cmml"><mn id="S4.SS8.p4.19.m16.1.1.2" xref="S4.SS8.p4.19.m16.1.1.2.cmml">60</mn><mo id="S4.SS8.p4.19.m16.1.1.1" xref="S4.SS8.p4.19.m16.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p4.19.m16.1b"><apply id="S4.SS8.p4.19.m16.1.1.cmml" xref="S4.SS8.p4.19.m16.1.1"><csymbol cd="latexml" id="S4.SS8.p4.19.m16.1.1.1.cmml" xref="S4.SS8.p4.19.m16.1.1.1">percent</csymbol><cn type="integer" id="S4.SS8.p4.19.m16.1.1.2.cmml" xref="S4.SS8.p4.19.m16.1.1.2">60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p4.19.m16.1c">60\%</annotation></semantics></math>, but we still find the results either under-performing to our hard-attention approach, or very unstable. For instance, <a href="#S4.F5.sf2" title="5(b) ‣ Figure 5 ‣ 4.7 End-to-end Training. ‣ 4 Results ‣ Learning Visual Question Answering by Bootstrapping Hard Attention" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">5(b)</span></a> shows our best results (accuracy- and stability-wise) with straight-through. Moreover, our formulation of the straight-through still requires to have gradients back-propagated through all the cells, even though they are ignored in the forward-pass, and hence the method lacks the computational benefits of our hard-attention mechanism.</p>
</div>
<div id="S4.SS8.p5" class="ltx_para ltx_noindent">
<p id="S4.SS8.p5.10" class="ltx_p"><span id="S4.SS8.p5.10.1" class="ltx_text ltx_font_bold">Implementation Details.</span>
In the experiments with HAN+Sum, and HAN+RN we follow the same setup as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. However, we have made slight changes with our larger models: HAN+Sum<sup id="S4.SS8.p5.10.2" class="ltx_sup"><span id="S4.SS8.p5.10.2.1" class="ltx_text ltx_font_italic">+</span></sup>, HAN+RN<sup id="S4.SS8.p5.10.3" class="ltx_sup"><span id="S4.SS8.p5.10.3.1" class="ltx_text ltx_font_italic">+</span></sup>, and HAN+RN<sup id="S4.SS8.p5.10.4" class="ltx_sup"><span id="S4.SS8.p5.10.4.1" class="ltx_text ltx_font_italic">++</span></sup>.
HAN+Sum<sup id="S4.SS8.p5.10.5" class="ltx_sup"><span id="S4.SS8.p5.10.5.1" class="ltx_text ltx_font_italic">+</span></sup>, HAN+RN<sup id="S4.SS8.p5.10.6" class="ltx_sup"><span id="S4.SS8.p5.10.6.1" class="ltx_text ltx_font_italic">+</span></sup>, and HAN+RN<sup id="S4.SS8.p5.10.7" class="ltx_sup"><span id="S4.SS8.p5.10.7.1" class="ltx_text ltx_font_italic">++</span></sup> use an LSTM with 256 hidden units and 64 dimensional word embedding (jointly trained from scratch together with the whole architecture) for language. For the image, we use a CNN with 4 layers, each with stride 2, 3x3 kernel size, ReLU non-linearities, and 128 features at each spatial cell. Our classifier is an MLP with a single hidden layer (1024 dimensional), drop-out 50%, and a single ReLU. Function <math id="S4.SS8.p5.7.m7.1" class="ltx_Math" alttext="g_{\theta}" display="inline"><semantics id="S4.SS8.p5.7.m7.1a"><msub id="S4.SS8.p5.7.m7.1.1" xref="S4.SS8.p5.7.m7.1.1.cmml"><mi id="S4.SS8.p5.7.m7.1.1.2" xref="S4.SS8.p5.7.m7.1.1.2.cmml">g</mi><mi id="S4.SS8.p5.7.m7.1.1.3" xref="S4.SS8.p5.7.m7.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS8.p5.7.m7.1b"><apply id="S4.SS8.p5.7.m7.1.1.cmml" xref="S4.SS8.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS8.p5.7.m7.1.1.1.cmml" xref="S4.SS8.p5.7.m7.1.1">subscript</csymbol><ci id="S4.SS8.p5.7.m7.1.1.2.cmml" xref="S4.SS8.p5.7.m7.1.1.2">𝑔</ci><ci id="S4.SS8.p5.7.m7.1.1.3.cmml" xref="S4.SS8.p5.7.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p5.7.m7.1c">g_{\theta}</annotation></semantics></math> defined in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> is an MLP with four hidden layers (each 256 dimensional) and ReLUs. We also find that, before the sum-pooling in HAN+Sum<sup id="S4.SS8.p5.10.8" class="ltx_sup"><span id="S4.SS8.p5.10.8.1" class="ltx_text ltx_font_italic">+</span></sup>, and before the pairwise aggregation in HAN+RN<sup id="S4.SS8.p5.10.9" class="ltx_sup"><span id="S4.SS8.p5.10.9.1" class="ltx_text ltx_font_italic">+/++</span></sup> it is worthwhile to process the multimodal embedding with a 1-by-1 convolution (we use 4 layers, with ReLUs, and 256 features). We use <math id="S4.SS8.p5.10.m10.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="S4.SS8.p5.10.m10.1a"><msub id="S4.SS8.p5.10.m10.1.1" xref="S4.SS8.p5.10.m10.1.1.cmml"><mi id="S4.SS8.p5.10.m10.1.1.2" xref="S4.SS8.p5.10.m10.1.1.2.cmml">l</mi><mn id="S4.SS8.p5.10.m10.1.1.3" xref="S4.SS8.p5.10.m10.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS8.p5.10.m10.1b"><apply id="S4.SS8.p5.10.m10.1.1.cmml" xref="S4.SS8.p5.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS8.p5.10.m10.1.1.1.cmml" xref="S4.SS8.p5.10.m10.1.1">subscript</csymbol><ci id="S4.SS8.p5.10.m10.1.1.2.cmml" xref="S4.SS8.p5.10.m10.1.1.2">𝑙</ci><cn type="integer" id="S4.SS8.p5.10.m10.1.1.3.cmml" xref="S4.SS8.p5.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p5.10.m10.1c">l_{2}</annotation></semantics></math>-norm on all the weights as the regularization. For hard-attention, we have also found batch-normalization in the image CNN to be crucial to achieve a good performance. Moreover, batch-normalization before 1-by-1 convolutions is also helpful, but not critical. The other hyper-parameters are identical to the ones presented in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<table id="S4.T4.8" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.8.9.1" class="ltx_tr">
<th id="S4.T4.8.9.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Model</th>
<th id="S4.T4.8.9.1.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.9.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.9.1.2.1.1" class="ltx_p"><span id="S4.T4.8.9.1.2.1.1.1" class="ltx_text ltx_font_bold">Overall</span></span>
</span>
</th>
<td id="S4.T4.8.9.1.3" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_tt" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.9.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.9.1.3.1.1" class="ltx_p">Count</span>
</span>
</td>
<td id="S4.T4.8.9.1.4" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_tt" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.9.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.9.1.4.1.1" class="ltx_p">Exist</span>
</span>
</td>
<td id="S4.T4.8.9.1.5" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_tt" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.9.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.9.1.5.1.1" class="ltx_p">Compare Numbers</span>
</span>
</td>
<td id="S4.T4.8.9.1.6" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_tt" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.9.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.9.1.6.1.1" class="ltx_p">Query Attribute</span>
</span>
</td>
<td id="S4.T4.8.9.1.7" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_tt" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.9.1.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.9.1.7.1.1" class="ltx_p">Compare Attribute</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.10.2" class="ltx_tr">
<th id="S4.T4.8.10.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Human <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>
</th>
<th id="S4.T4.8.10.2.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r ltx_border_t" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.10.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.10.2.2.1.1" class="ltx_p">92.6</span>
</span>
</th>
<td id="S4.T4.8.10.2.3" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.10.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.10.2.3.1.1" class="ltx_p">86.7</span>
</span>
</td>
<td id="S4.T4.8.10.2.4" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.10.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.10.2.4.1.1" class="ltx_p">96.6</span>
</span>
</td>
<td id="S4.T4.8.10.2.5" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.10.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.10.2.5.1.1" class="ltx_p">86.5</span>
</span>
</td>
<td id="S4.T4.8.10.2.6" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.10.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.10.2.6.1.1" class="ltx_p">95.0</span>
</span>
</td>
<td id="S4.T4.8.10.2.7" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.10.2.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.10.2.7.1.1" class="ltx_p">96.0</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.11.3" class="ltx_tr">
<th id="S4.T4.8.11.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Q-type baseline <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>
</th>
<th id="S4.T4.8.11.3.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r ltx_border_t" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.11.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.11.3.2.1.1" class="ltx_p">41.8</span>
</span>
</th>
<td id="S4.T4.8.11.3.3" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.11.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.11.3.3.1.1" class="ltx_p">34.6</span>
</span>
</td>
<td id="S4.T4.8.11.3.4" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.11.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.11.3.4.1.1" class="ltx_p">50.2</span>
</span>
</td>
<td id="S4.T4.8.11.3.5" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.11.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.11.3.5.1.1" class="ltx_p">51.0</span>
</span>
</td>
<td id="S4.T4.8.11.3.6" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.11.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.11.3.6.1.1" class="ltx_p">36.0</span>
</span>
</td>
<td id="S4.T4.8.11.3.7" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.11.3.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.11.3.7.1.1" class="ltx_p">51.3</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.12.4" class="ltx_tr">
<th id="S4.T4.8.12.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">LSTM-only <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>
</th>
<th id="S4.T4.8.12.4.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.12.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.12.4.2.1.1" class="ltx_p">46.8</span>
</span>
</th>
<td id="S4.T4.8.12.4.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.12.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.12.4.3.1.1" class="ltx_p">41.7</span>
</span>
</td>
<td id="S4.T4.8.12.4.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.12.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.12.4.4.1.1" class="ltx_p">61.1</span>
</span>
</td>
<td id="S4.T4.8.12.4.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.12.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.12.4.5.1.1" class="ltx_p">69.8</span>
</span>
</td>
<td id="S4.T4.8.12.4.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.12.4.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.12.4.6.1.1" class="ltx_p">36.8</span>
</span>
</td>
<td id="S4.T4.8.12.4.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.12.4.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.12.4.7.1.1" class="ltx_p">51.8</span>
</span>
</td>
</tr>
<tr id="S4.T4.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">CNN<math id="S4.T4.1.1.1.m1.1" class="ltx_Math" alttext="+" display="inline"><semantics id="S4.T4.1.1.1.m1.1a"><mo id="S4.T4.1.1.1.m1.1.1" xref="S4.T4.1.1.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.m1.1b"><plus id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.m1.1c">+</annotation></semantics></math>LSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>
</th>
<th id="S4.T4.1.1.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.1.2.1.1" class="ltx_p">52.3</span>
</span>
</th>
<td id="S4.T4.1.1.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.1.3.1.1" class="ltx_p">43.7</span>
</span>
</td>
<td id="S4.T4.1.1.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.1.4.1.1" class="ltx_p">65.2</span>
</span>
</td>
<td id="S4.T4.1.1.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.1.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.1.5.1.1" class="ltx_p">67.1</span>
</span>
</td>
<td id="S4.T4.1.1.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.1.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.1.6.1.1" class="ltx_p">49.3</span>
</span>
</td>
<td id="S4.T4.1.1.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.1.1.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.1.7.1.1" class="ltx_p">53.0</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.13.5" class="ltx_tr">
<th id="S4.T4.8.13.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">SAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>
</th>
<th id="S4.T4.8.13.5.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.13.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.13.5.2.1.1" class="ltx_p">68.5</span>
</span>
</th>
<td id="S4.T4.8.13.5.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.13.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.13.5.3.1.1" class="ltx_p">52.2</span>
</span>
</td>
<td id="S4.T4.8.13.5.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.13.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.13.5.4.1.1" class="ltx_p">71.1</span>
</span>
</td>
<td id="S4.T4.8.13.5.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.13.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.13.5.5.1.1" class="ltx_p">73.5</span>
</span>
</td>
<td id="S4.T4.8.13.5.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.13.5.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.13.5.6.1.1" class="ltx_p">85.3</span>
</span>
</td>
<td id="S4.T4.8.13.5.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.13.5.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.13.5.7.1.1" class="ltx_p">52.3</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.14.6" class="ltx_tr">
<th id="S4.T4.8.14.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">SAN* <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>
</th>
<th id="S4.T4.8.14.6.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.14.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.14.6.2.1.1" class="ltx_p">76.6</span>
</span>
</th>
<td id="S4.T4.8.14.6.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.14.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.14.6.3.1.1" class="ltx_p">64.4</span>
</span>
</td>
<td id="S4.T4.8.14.6.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.14.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.14.6.4.1.1" class="ltx_p">82.7</span>
</span>
</td>
<td id="S4.T4.8.14.6.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.14.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.14.6.5.1.1" class="ltx_p">77.4</span>
</span>
</td>
<td id="S4.T4.8.14.6.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.14.6.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.14.6.6.1.1" class="ltx_p">82.6</span>
</span>
</td>
<td id="S4.T4.8.14.6.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.14.6.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.14.6.7.1.1" class="ltx_p">75.4</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.15.7" class="ltx_tr">
<th id="S4.T4.8.15.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">LBP-SIG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>
</th>
<th id="S4.T4.8.15.7.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.15.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.15.7.2.1.1" class="ltx_p">78.0</span>
</span>
</th>
<td id="S4.T4.8.15.7.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.15.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.15.7.3.1.1" class="ltx_p">61.3</span>
</span>
</td>
<td id="S4.T4.8.15.7.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.15.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.15.7.4.1.1" class="ltx_p">79.6</span>
</span>
</td>
<td id="S4.T4.8.15.7.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.15.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.15.7.5.1.1" class="ltx_p">80.7</span>
</span>
</td>
<td id="S4.T4.8.15.7.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.15.7.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.15.7.6.1.1" class="ltx_p">88.6</span>
</span>
</td>
<td id="S4.T4.8.15.7.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.15.7.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.15.7.7.1.1" class="ltx_p">76.3</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.16.8" class="ltx_tr">
<th id="S4.T4.8.16.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">N2NMN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite>
</th>
<th id="S4.T4.8.16.8.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.16.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.16.8.2.1.1" class="ltx_p">83.7</span>
</span>
</th>
<td id="S4.T4.8.16.8.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.16.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.16.8.3.1.1" class="ltx_p">68.5</span>
</span>
</td>
<td id="S4.T4.8.16.8.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.16.8.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.16.8.4.1.1" class="ltx_p">85.7</span>
</span>
</td>
<td id="S4.T4.8.16.8.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.16.8.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.16.8.5.1.1" class="ltx_p">85.0</span>
</span>
</td>
<td id="S4.T4.8.16.8.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.16.8.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.16.8.6.1.1" class="ltx_p">90.0</span>
</span>
</td>
<td id="S4.T4.8.16.8.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.16.8.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.16.8.7.1.1" class="ltx_p">88.9</span>
</span>
</td>
</tr>
<tr id="S4.T4.2.2" class="ltx_tr">
<th id="S4.T4.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">PG+EE (700k)<sup id="S4.T4.2.2.1.1" class="ltx_sup">-</sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib70" title="" class="ltx_ref">70</a>]</cite>
</th>
<th id="S4.T4.2.2.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.2.2.2.1.1" class="ltx_p">96.9</span>
</span>
</th>
<td id="S4.T4.2.2.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.2.2.3.1.1" class="ltx_p">92.7</span>
</span>
</td>
<td id="S4.T4.2.2.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.2.2.4.1.1" class="ltx_p">97.1</span>
</span>
</td>
<td id="S4.T4.2.2.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.2.2.5.1.1" class="ltx_p">98.7</span>
</span>
</td>
<td id="S4.T4.2.2.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.2.2.6.1.1" class="ltx_p">98.1</span>
</span>
</td>
<td id="S4.T4.2.2.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.2.2.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.2.2.7.1.1" class="ltx_p">98.9</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.17.9" class="ltx_tr">
<th id="S4.T4.8.17.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">RN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</th>
<th id="S4.T4.8.17.9.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.17.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.17.9.2.1.1" class="ltx_p">95.5</span>
</span>
</th>
<td id="S4.T4.8.17.9.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.17.9.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.17.9.3.1.1" class="ltx_p">90.1</span>
</span>
</td>
<td id="S4.T4.8.17.9.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.17.9.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.17.9.4.1.1" class="ltx_p">97.8</span>
</span>
</td>
<td id="S4.T4.8.17.9.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.17.9.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.17.9.5.1.1" class="ltx_p">93.6</span>
</span>
</td>
<td id="S4.T4.8.17.9.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.17.9.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.17.9.6.1.1" class="ltx_p">97.9</span>
</span>
</td>
<td id="S4.T4.8.17.9.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.17.9.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.17.9.7.1.1" class="ltx_p">97.1</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.18.10" class="ltx_tr">
<th id="S4.T4.8.18.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Hyperbolic RN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>
</th>
<th id="S4.T4.8.18.10.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.18.10.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.18.10.2.1.1" class="ltx_p">95.7</span>
</span>
</th>
<td id="S4.T4.8.18.10.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.18.10.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.18.10.3.1.1" class="ltx_p">-</span>
</span>
</td>
<td id="S4.T4.8.18.10.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.18.10.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.18.10.4.1.1" class="ltx_p">-</span>
</span>
</td>
<td id="S4.T4.8.18.10.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.18.10.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.18.10.5.1.1" class="ltx_p">-</span>
</span>
</td>
<td id="S4.T4.8.18.10.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.18.10.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.18.10.6.1.1" class="ltx_p">-</span>
</span>
</td>
<td id="S4.T4.8.18.10.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.18.10.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.18.10.7.1.1" class="ltx_p">-</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.19.11" class="ltx_tr">
<th id="S4.T4.8.19.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Object RN** <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>
</th>
<th id="S4.T4.8.19.11.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.19.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.19.11.2.1.1" class="ltx_p">94.5</span>
</span>
</th>
<td id="S4.T4.8.19.11.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.19.11.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.19.11.3.1.1" class="ltx_p">93.6</span>
</span>
</td>
<td id="S4.T4.8.19.11.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.19.11.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.19.11.4.1.1" class="ltx_p">94.7</span>
</span>
</td>
<td id="S4.T4.8.19.11.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.19.11.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.19.11.5.1.1" class="ltx_p">93.3</span>
</span>
</td>
<td id="S4.T4.8.19.11.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.19.11.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.19.11.6.1.1" class="ltx_p">95.2</span>
</span>
</td>
<td id="S4.T4.8.19.11.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.19.11.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.19.11.7.1.1" class="ltx_p">94.4</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.20.12" class="ltx_tr">
<th id="S4.T4.8.20.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Stack-NMNs** <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>
</th>
<th id="S4.T4.8.20.12.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.20.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.20.12.2.1.1" class="ltx_p">96.6 (93.0)</span>
</span>
</th>
<td id="S4.T4.8.20.12.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.20.12.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.20.12.3.1.1" class="ltx_p">-</span>
</span>
</td>
<td id="S4.T4.8.20.12.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.20.12.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.20.12.4.1.1" class="ltx_p">-</span>
</span>
</td>
<td id="S4.T4.8.20.12.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.20.12.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.20.12.5.1.1" class="ltx_p">-</span>
</span>
</td>
<td id="S4.T4.8.20.12.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.20.12.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.20.12.6.1.1" class="ltx_p">-</span>
</span>
</td>
<td id="S4.T4.8.20.12.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.20.12.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.20.12.7.1.1" class="ltx_p">-</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.21.13" class="ltx_tr">
<th id="S4.T4.8.21.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">FiLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
</th>
<th id="S4.T4.8.21.13.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.21.13.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.21.13.2.1.1" class="ltx_p">97.6</span>
</span>
</th>
<td id="S4.T4.8.21.13.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.21.13.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.21.13.3.1.1" class="ltx_p">94.5</span>
</span>
</td>
<td id="S4.T4.8.21.13.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.21.13.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.21.13.4.1.1" class="ltx_p">99.2</span>
</span>
</td>
<td id="S4.T4.8.21.13.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.21.13.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.21.13.5.1.1" class="ltx_p">93.8</span>
</span>
</td>
<td id="S4.T4.8.21.13.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.21.13.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.21.13.6.1.1" class="ltx_p">99.2</span>
</span>
</td>
<td id="S4.T4.8.21.13.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.21.13.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.21.13.7.1.1" class="ltx_p">99.0</span>
</span>
</td>
</tr>
<tr id="S4.T4.3.3" class="ltx_tr">
<th id="S4.T4.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">DDRprog<sup id="S4.T4.3.3.1.1" class="ltx_sup">-</sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib71" title="" class="ltx_ref">71</a>]</cite>
</th>
<th id="S4.T4.3.3.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.3.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.3.3.2.1.1" class="ltx_p">98.3</span>
</span>
</th>
<td id="S4.T4.3.3.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.3.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.3.3.3.1.1" class="ltx_p">96.5</span>
</span>
</td>
<td id="S4.T4.3.3.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.3.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.3.3.4.1.1" class="ltx_p">98.8</span>
</span>
</td>
<td id="S4.T4.3.3.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.3.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.3.3.5.1.1" class="ltx_p">98.4</span>
</span>
</td>
<td id="S4.T4.3.3.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.3.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.3.3.6.1.1" class="ltx_p">99.1</span>
</span>
</td>
<td id="S4.T4.3.3.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.3.3.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.3.3.7.1.1" class="ltx_p">99.0</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.22.14" class="ltx_tr">
<th id="S4.T4.8.22.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">MAC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>
</th>
<th id="S4.T4.8.22.14.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.22.14.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.22.14.2.1.1" class="ltx_p">98.9</span>
</span>
</th>
<td id="S4.T4.8.22.14.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.22.14.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.22.14.3.1.1" class="ltx_p">97.2</span>
</span>
</td>
<td id="S4.T4.8.22.14.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.22.14.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.22.14.4.1.1" class="ltx_p">99.5</span>
</span>
</td>
<td id="S4.T4.8.22.14.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.22.14.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.22.14.5.1.1" class="ltx_p">99.4</span>
</span>
</td>
<td id="S4.T4.8.22.14.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.22.14.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.22.14.6.1.1" class="ltx_p">99.3</span>
</span>
</td>
<td id="S4.T4.8.22.14.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.22.14.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.22.14.7.1.1" class="ltx_p">99.5</span>
</span>
</td>
</tr>
<tr id="S4.T4.4.4" class="ltx_tr">
<th id="S4.T4.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">TbD<sup id="S4.T4.4.4.1.1" class="ltx_sup"><span id="S4.T4.4.4.1.1.1" class="ltx_text ltx_font_italic">-</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>
</th>
<th id="S4.T4.4.4.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.4.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.4.4.2.1.1" class="ltx_p">98.7</span>
</span>
</th>
<td id="S4.T4.4.4.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.4.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.4.4.3.1.1" class="ltx_p">96.8</span>
</span>
</td>
<td id="S4.T4.4.4.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.4.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.4.4.4.1.1" class="ltx_p">98.9</span>
</span>
</td>
<td id="S4.T4.4.4.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.4.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.4.4.5.1.1" class="ltx_p">99.1</span>
</span>
</td>
<td id="S4.T4.4.4.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.4.4.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.4.4.6.1.1" class="ltx_p">99.4</span>
</span>
</td>
<td id="S4.T4.4.4.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.4.4.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.4.4.7.1.1" class="ltx_p">99.2</span>
</span>
</td>
</tr>
<tr id="S4.T4.5.5" class="ltx_tr">
<th id="S4.T4.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">TbD+hres<sup id="S4.T4.5.5.1.1" class="ltx_sup"><span id="S4.T4.5.5.1.1.1" class="ltx_text ltx_font_italic">-</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>
</th>
<th id="S4.T4.5.5.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.5.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.5.5.2.1.1" class="ltx_p">99.1</span>
</span>
</th>
<td id="S4.T4.5.5.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.5.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.5.5.3.1.1" class="ltx_p">97.6</span>
</span>
</td>
<td id="S4.T4.5.5.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.5.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.5.5.4.1.1" class="ltx_p">99.2</span>
</span>
</td>
<td id="S4.T4.5.5.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.5.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.5.5.5.1.1" class="ltx_p">99.4</span>
</span>
</td>
<td id="S4.T4.5.5.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.5.5.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.5.5.6.1.1" class="ltx_p">99.5</span>
</span>
</td>
<td id="S4.T4.5.5.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.5.5.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.5.5.7.1.1" class="ltx_p">99.6</span>
</span>
</td>
</tr>
<tr id="S4.T4.6.6" class="ltx_tr">
<th id="S4.T4.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">HAN+Sum<sup id="S4.T4.6.6.1.1" class="ltx_sup"><span id="S4.T4.6.6.1.1.1" class="ltx_text ltx_font_italic">+</span></sup> (Ours)</th>
<th id="S4.T4.6.6.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r ltx_border_t" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.6.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.6.6.2.1.1" class="ltx_p">94.7</span>
</span>
</th>
<td id="S4.T4.6.6.3" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.6.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.6.6.3.1.1" class="ltx_p">88.9</span>
</span>
</td>
<td id="S4.T4.6.6.4" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.6.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.6.6.4.1.1" class="ltx_p">97.3</span>
</span>
</td>
<td id="S4.T4.6.6.5" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.6.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.6.6.5.1.1" class="ltx_p">88.0</span>
</span>
</td>
<td id="S4.T4.6.6.6" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.6.6.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.6.6.6.1.1" class="ltx_p">98.1</span>
</span>
</td>
<td id="S4.T4.6.6.7" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.6.6.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.6.6.7.1.1" class="ltx_p">97.0</span>
</span>
</td>
</tr>
<tr id="S4.T4.7.7" class="ltx_tr">
<th id="S4.T4.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">HAN+RN<sup id="S4.T4.7.7.1.1" class="ltx_sup"><span id="S4.T4.7.7.1.1.1" class="ltx_text ltx_font_italic">+</span></sup> (Ours)</th>
<th id="S4.T4.7.7.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.7.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.7.7.2.1.1" class="ltx_p">96.9</span>
</span>
</th>
<td id="S4.T4.7.7.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.7.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.7.7.3.1.1" class="ltx_p">92.8</span>
</span>
</td>
<td id="S4.T4.7.7.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.7.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.7.7.4.1.1" class="ltx_p">98.6</span>
</span>
</td>
<td id="S4.T4.7.7.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.7.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.7.7.5.1.1" class="ltx_p">94.9</span>
</span>
</td>
<td id="S4.T4.7.7.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.7.7.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.7.7.6.1.1" class="ltx_p">98.9</span>
</span>
</td>
<td id="S4.T4.7.7.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.7.7.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.7.7.7.1.1" class="ltx_p">98.2</span>
</span>
</td>
</tr>
<tr id="S4.T4.8.8" class="ltx_tr">
<th id="S4.T4.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">HAN+RN<sup id="S4.T4.8.8.1.1" class="ltx_sup"><span id="S4.T4.8.8.1.1.1" class="ltx_text ltx_font_italic">++</span></sup> (Ours)</th>
<th id="S4.T4.8.8.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.8.2.1.1" class="ltx_p">98.8</span>
</span>
</th>
<td id="S4.T4.8.8.3" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.8.3.1.1" class="ltx_p">97.2</span>
</span>
</td>
<td id="S4.T4.8.8.4" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:28.5pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.8.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.8.4.1.1" class="ltx_p">99.6</span>
</span>
</td>
<td id="S4.T4.8.8.5" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.8.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.8.5.1.1" class="ltx_p">96.9</span>
</span>
</td>
<td id="S4.T4.8.8.6" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.8.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.8.6.1.1" class="ltx_p">99.6</span>
</span>
</td>
<td id="S4.T4.8.8.7" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:39.8pt;padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.8.8.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.8.7.1.1" class="ltx_p">99.6</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.33.9.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S4.T4.24.8" class="ltx_text" style="font-size:90%;">Results, in <math id="S4.T4.17.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S4.T4.17.1.m1.1b"><mo id="S4.T4.17.1.m1.1.1" xref="S4.T4.17.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T4.17.1.m1.1c"><csymbol cd="latexml" id="S4.T4.17.1.m1.1.1.cmml" xref="S4.T4.17.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.17.1.m1.1d">\%</annotation></semantics></math>, on CLEVR.
SAN denotes the SAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> implementation of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>.
SAN* denotes the SAN implementation of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
Object RN** <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> and Stack-NMNs** <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> report the results only on the validation set, whereas others report on the test set. Overall performance of Stack-NMNs** <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> is measured with the “expert layout” (similar to N2NMN) yielding 96.6 and without it (93.0).
DDRprog<sup id="S4.T4.24.8.1" class="ltx_sup">-</sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib71" title="" class="ltx_ref">71</a>]</cite>, PG+EE (700k)<sup id="S4.T4.24.8.2" class="ltx_sup">-</sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib70" title="" class="ltx_ref">70</a>]</cite>, TbD<sup id="S4.T4.24.8.3" class="ltx_sup">-</sup>, and TbD+hres<sup id="S4.T4.24.8.4" class="ltx_sup">-</sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> are trained with a privileged state-description, while others are trained directly from images-questions-answers. TbD+hres <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> uses high-resolution (28x28) spatial tensor, while majority uses either 8x8 or 14x14.
HAN+Sum/RN<sup id="S4.T4.24.8.5" class="ltx_sup"><span id="S4.T4.24.8.5.1" class="ltx_text ltx_font_italic">+</span></sup> denotes a larger relational model, or a different hyper-parameters setup, than the model of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
HAN+RN<sup id="S4.T4.24.8.6" class="ltx_sup"><span id="S4.T4.24.8.6.1" class="ltx_text ltx_font_italic">++</span></sup> denotes HAN+RN<sup id="S4.T4.24.8.7" class="ltx_sup"><span id="S4.T4.24.8.7.1" class="ltx_text ltx_font_italic">+</span></sup> with larger input images with spatial dimensions 224x224 as opposed to 128x128, and larger image tensors with spatial dimension 14x14 as opposed to 8x8.
</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Summary</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We have introduced a new approach for hard attention in computer vision that
selects a subset of the
feature vectors for further processing based on the their magnitudes.
We explored two models, one which selects subsets with a pre-specified number of vectors (HAN), and the other one that adaptively chooses the subset size as a function of the inputs (AdaHAN).
Hard attention is often avoided in the literature because
it poses a challenge for gradient-based methods due to non-differentiability.
However, since we found our feature vectors’ magnitudes correlate with relevant information, our hard attention mechanism exploits this property to perform the selection.
Our results showed our HAN and AdaHAN gave competitive performance on challenging Visual QA datasets.
Our approaches
seem to be at least as good as
a more commonly used soft attention mechanism while providing additional computational efficiency benefits.
This is especially important for the increasingly popular class of non-local approaches, which often require computations and memory which are quadratic in the number of the input vectors. Finally, our approach also provides interpretable representations, as the spatial locations of the selected features correspond most strongly to those parts of the image which contributed most strongly.</p>
</div>
<section id="S5.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Acknowledgments</h3>

<div id="S5.SSx1.p1" class="ltx_para">
<p id="S5.SSx1.p1.1" class="ltx_p">We would like to thank Aishwarya Agrawal, Relja Arandjelovic, David G.T. Barrett, Joao Carreira, Timothy Lillicrap, Razvan Pascanu, David Raposo, and many others on the DeepMind team for critical feedback and discussions.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Çukur, T., Nishimoto, S., Huth, A.G., Gallant, J.L.:

</span>
<span class="ltx_bibblock">Attention during natural vision warps semantic representation across
the human brain.

</span>
<span class="ltx_bibblock">Nature neuroscience <span id="bib.bib1.1.1" class="ltx_text ltx_font_bold">16</span>(6) (2013) 763

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Sheinberg, D.L., Logothetis, N.K.:

</span>
<span class="ltx_bibblock">Noticing familiar objects in real world scenes: the role of temporal
cortical neurons in natural vision.

</span>
<span class="ltx_bibblock">Journal of Neuroscience <span id="bib.bib2.1.1" class="ltx_text ltx_font_bold">21</span>(4) (2001) 1340–1350

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Simons, D.J., Rensink, R.A.:

</span>
<span class="ltx_bibblock">Change blindness: Past, present, and future.

</span>
<span class="ltx_bibblock">Trends in cognitive sciences <span id="bib.bib3.1.1" class="ltx_text ltx_font_bold">9</span>(1) (2005) 16–20

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Mack, A., Rock, I.:

</span>
<span class="ltx_bibblock">Inattentional blindness. Volume 33.

</span>
<span class="ltx_bibblock">MIT press Cambridge, MA (1998)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Simons, D.J., Chabris, C.F.:

</span>
<span class="ltx_bibblock">Gorillas in our midst: Sustained inattentional blindness for dynamic
events.

</span>
<span class="ltx_bibblock">Perception <span id="bib.bib5.1.1" class="ltx_text ltx_font_bold">28</span>(9) (1999) 1059–1074

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Malinowski, M., Fritz, M.:

</span>
<span class="ltx_bibblock">A multi-world approach to question answering about real-world scenes
based on uncertain input.

</span>
<span class="ltx_bibblock">In: Advances in Neural Information Processing Systems (NIPS). (2014)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Agrawal, A., Batra, D., Parikh, D., Kembhavi, A.:

</span>
<span class="ltx_bibblock">Don’t just assume; look and answer: Overcoming priors for visual
question answering.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1712.00377 (2017)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Xu, H., Saenko, K.:

</span>
<span class="ltx_bibblock">Ask, attend and answer: Exploring question-guided spatial attention
for visual question answering.

</span>
<span class="ltx_bibblock">arXiv:1511.05234 (2015)

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Yang, Z., He, X., Gao, J., Deng, L., Smola, A.:

</span>
<span class="ltx_bibblock">Stacked attention networks for image question answering.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR). (2016)

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Fukui, A., Park, D.H., Yang, D., Rohrbach, A., Darrell, T., Rohrbach, M.:

</span>
<span class="ltx_bibblock">Multimodal compact bilinear pooling for visual question answering and
visual grounding.

</span>
<span class="ltx_bibblock">In: Proceedings of the Conference on Empirical Methods in Natural
Language Processing (EMNLP). (2016)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Perez, E., Strub, F., De Vries, H., Dumoulin, V., Courville, A.:

</span>
<span class="ltx_bibblock">Film: Visual reasoning with a general conditioning layer.

</span>
<span class="ltx_bibblock">In: Proceedings of the Conference on Artificial Intelligence (AAAI).
(2018)

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Kazemi, V., Elqursh, A.:

</span>
<span class="ltx_bibblock">Show, ask, attend, and answer: A strong baseline for visual question
answering.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1704.03162 (2017)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Teney, D., Anderson, P., He, X., Hengel, A.v.d.:

</span>
<span class="ltx_bibblock">Tips and tricks for visual question answering: Learnings from the
2017 challenge.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1708.02711 (2017)

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Ilievski, I., Yan, S., Feng, J.:

</span>
<span class="ltx_bibblock">A focused dynamic attention model for visual question answering.

</span>
<span class="ltx_bibblock">arXiv:1604.01485 (2016)

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Mnih, V., Heess, N., Graves, A., et al.:

</span>
<span class="ltx_bibblock">Recurrent models of visual attention.

</span>
<span class="ltx_bibblock">In: Advances in neural information processing systems. (2014)
2204–2212

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Gulcehre, C., Chandar, S., Cho, K., Bengio, Y.:

</span>
<span class="ltx_bibblock">Dynamic neural turing machine with soft and hard addressing schemes.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1607.00036 (2016)

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Bengio, Y., Léonard, N., Courville, A.:

</span>
<span class="ltx_bibblock">Estimating or propagating gradients through stochastic neurons for
conditional computation.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1308.3432 (2013)

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Jang, E., Gu, S., Poole, B.:

</span>
<span class="ltx_bibblock">Categorical reparameterization with gumbel-softmax.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1611.01144 (2016)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Maddison, C.J., Mnih, A., Teh, Y.W.:

</span>
<span class="ltx_bibblock">The concrete distribution: A continuous relaxation of discrete random
variables.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1611.00712 (2016)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Olah, C., Satyanarayan, A., Johnson, I., Carter, S., Schubert, L., Ye, K.,
Mordvintsev, A.:

</span>
<span class="ltx_bibblock">The building blocks of interpretability.

</span>
<span class="ltx_bibblock">Distill (2018)

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Oliva, A., Torralba, A., Castelhano, M.S., Henderson, J.M.:

</span>
<span class="ltx_bibblock">Top-down control of visual attention in object detection.

</span>
<span class="ltx_bibblock">In: Image processing, 2003. icip 2003. proceedings. 2003
international conference on. Volume 1., IEEE (2003) I–253

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Ren, M., Kiros, R., Zemel, R.:

</span>
<span class="ltx_bibblock">Image question answering: A visual semantic embedding model and a new
dataset.

</span>
<span class="ltx_bibblock">In: Advances in Neural Information Processing Systems (NIPS). (2015)

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Antol, S., Agrawal, A., Lu, J., Mitchell, M., Batra, D., Zitnick, C.L., Parikh,
D.:

</span>
<span class="ltx_bibblock">Vqa: Visual question answering.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE International Conference on Computer
Vision (ICCV). (2015)

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Malinowski, M., Rohrbach, M., Fritz, M.:

</span>
<span class="ltx_bibblock">Ask your neurons: A deep learning approach to visual question
answering.

</span>
<span class="ltx_bibblock">International Journal of Computer Vision (IJCV) <span id="bib.bib24.1.1" class="ltx_text ltx_font_bold">125</span>(1-3)
(2017) 110–135

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Santoro, A., Raposo, D., Barrett, D.G., Malinowski, M., Pascanu, R., Battaglia,
P., Lillicrap, T.:

</span>
<span class="ltx_bibblock">A simple neural network module for relational reasoning.

</span>
<span class="ltx_bibblock">In: Advances in Neural Information Processing Systems (NIPS). (2017)
4974–4983

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Wang, X., Girshick, R., Gupta, A., He, K.:

</span>
<span class="ltx_bibblock">Non-local neural networks.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1711.07971 (2017)

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A.N.,
Kaiser, Ł., Polosukhin, I.:

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In: Advances in Neural Information Processing Systems. (2017)
6000–6010

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Shaw, P., Uszkoreit, J., Vaswani, A.:

</span>
<span class="ltx_bibblock">Self-attention with relative position representations.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1803.02155 (2018)

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Malinowski, M., Fritz, M.:

</span>
<span class="ltx_bibblock">Towards a visual turing challenge.

</span>
<span class="ltx_bibblock">In: Learning Semantics (NIPS workshop). (2014)

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Malinowski, M., Fritz, M.:

</span>
<span class="ltx_bibblock">Hard to cheat: A turing test based on answering questions about
images.

</span>
<span class="ltx_bibblock">AAAI Workshop: Beyond the Turing Test (2015)

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Malinowski, M.:

</span>
<span class="ltx_bibblock">Towards holistic machines: From visual recognition to question
answering about real-world images.

</span>
<span class="ltx_bibblock">PhD Thesis (2017)

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Geman, D., Geman, S., Hallonquist, N., Younes, L.:

</span>
<span class="ltx_bibblock">Visual turing test for computer vision systems.

</span>
<span class="ltx_bibblock">In: Proceedings of the National Academy of Sciences, National Academy
of Sciences (2015)

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Gao, H., Mao, J., Zhou, J., Huang, Z., Wang, L., Xu, W.:

</span>
<span class="ltx_bibblock">Are you talking to a machine? dataset and methods for multilingual
image question answering.

</span>
<span class="ltx_bibblock">In: Advances in Neural Information Processing Systems (NIPS). (2015)

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Johnson, J., Hariharan, B., van der Maaten, L., Fei-Fei, L., Zitnick, C.L.,
Girshick, R.:

</span>
<span class="ltx_bibblock">Clevr: A diagnostic dataset for compositional language and elementary
visual reasoning.

</span>
<span class="ltx_bibblock">In: Computer Vision and Pattern Recognition (CVPR), 2017 IEEE
Conference on, IEEE (2017) 1988–1997

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Goyal, Y., Khot, T., Summers-Stay, D., Batra, D., Parikh, D.:

</span>
<span class="ltx_bibblock">Making the v in vqa matter: Elevating the role of image understanding
in visual question answering.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR). (2017)

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Harnad, S.:

</span>
<span class="ltx_bibblock">The symbol grounding problem.

</span>
<span class="ltx_bibblock">Physica D: Nonlinear Phenomena <span id="bib.bib36.1.1" class="ltx_text ltx_font_bold">42</span>(1) (1990) 335–346

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Guadarrama, S., Riano, L., Golland, D., Gouhring, D., Jia, Y., Klein, D.,
Abbeel, P., Darrell, T.:

</span>
<span class="ltx_bibblock">Grounding spatial relations for human-robot interaction.

</span>
<span class="ltx_bibblock">In: IROS. (2013)

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Kong, C., Lin, D., Bansal, M., Urtasun, R., Fidler, S.:

</span>
<span class="ltx_bibblock">What are you talking about? text-to-image coreference.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR). (2014)

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Karpathy, A., Fei-Fei, L.:

</span>
<span class="ltx_bibblock">Deep visual-semantic alignments for generating image descriptions.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR). (2015)

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Rohrbach, A., Rohrbach, M., Hu, R., Darrell, T., Schiele, B.:

</span>
<span class="ltx_bibblock">Grounding of textual phrases in images by reconstruction.

</span>
<span class="ltx_bibblock">In: European Conference on Computer Vision, Springer (2016) 817–834

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Malinowski, M., Rohrbach, M., Fritz, M.:

</span>
<span class="ltx_bibblock">Ask your neurons: A neural-based approach to answering questions
about images.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE International Conference on Computer
Vision (ICCV). (2015) 1–9

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Xu, K., Ba, J., Kiros, R., Courville, A., Salakhutdinov, R., Zemel, R., Bengio,
Y.:

</span>
<span class="ltx_bibblock">Show, attend and tell: Neural image caption generation with visual
attention.

</span>
<span class="ltx_bibblock">Proceedings of the International Conference on Machine Learning
(ICML) (2015)

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Xiong, C., Merity, S., Socher, R.:

</span>
<span class="ltx_bibblock">Dynamic memory networks for visual and textual question answering.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1603.01417 (2016)

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
De Vries, H., Strub, F., Mary, J., Larochelle, H., Pietquin, O., Courville,
A.C.:

</span>
<span class="ltx_bibblock">Modulating early visual processing by language.

</span>
<span class="ltx_bibblock">In: Advances in Neural Information Processing Systems. (2017)
6597–6607

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Zhu, Y., Groth, O., Bernstein, M., Fei-Fei, L.:

</span>
<span class="ltx_bibblock">Visual7W: Grounded Question Answering in Images.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR). (2016)

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Chen, K., Wang, J., Chen, L.C., Gao, H., Xu, W., Nevatia, R.:

</span>
<span class="ltx_bibblock">Abc-cnn: An attention based convolutional neural network for visual
question answering.

</span>
<span class="ltx_bibblock">arXiv:1511.05960 (2015)

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Shih, K.J., Singh, S., Hoiem, D.:

</span>
<span class="ltx_bibblock">Where to look: Focus regions for visual question answering.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR). (2016)

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Gulcehre, C., Denil, M., Malinowski, M., Razavi, A., Pascanu, R., Hermann,
K.M., Battaglia, P., Bapst, V., Raposo, D., Santoro, A., et al.:

</span>
<span class="ltx_bibblock">Hyperbolic attention networks.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1805.09786 (2018)

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Hudson, D.A., Manning, C.D.:

</span>
<span class="ltx_bibblock">Compositional attention networks for machine reasoning.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1803.03067 (2018)

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Mascharka, D., Tran, P., Soklaski, R., Majumdar, A.:

</span>
<span class="ltx_bibblock">Transparency by design: Closing the gap between performance and
interpretability in visual reasoning.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR). (2018) 4942–4950

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Kim, Y., Denton, C., Hoang, L., Rush, A.M.:

</span>
<span class="ltx_bibblock">Structured attention networks.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1702.00887 (2017)

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Hu, R., Andreas, J., Darrell, T., Saenko, K.:

</span>
<span class="ltx_bibblock">Explainable Neural Computation via Stack Neural Module Networks.

</span>
<span class="ltx_bibblock">In: Proceedings of the European Conference on Computer Vision (ECCV).
(2018)

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Mokarian, A., Malinowski, M., Fritz, M.:

</span>
<span class="ltx_bibblock">Mean box pooling: A rich image representation and output embedding
for the visual madlibs task.

</span>
<span class="ltx_bibblock">In: Proceedings of the British Machine Vision Conference (BMVC).
(2016)

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Tommasi, T., Mallya, A., Plummer, B., Lazebnik, S., Berg, A.C., Berg, T.L.:

</span>
<span class="ltx_bibblock">Solving visual madlibs with multiple cues.

</span>
<span class="ltx_bibblock">In: Proceedings of the British Machine Vision Conference (BMVC).
(2016)

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Desta, M.T., Chen, L., Kornuta, T.:

</span>
<span class="ltx_bibblock">Object-based reasoning in vqa.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1801.09718 (2018)

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Singh, S., Gupta, A., Efros, A.A.:

</span>
<span class="ltx_bibblock">Unsupervised discovery of mid-level discriminative patches.

</span>
<span class="ltx_bibblock">In: Proceedings of the European Conference on Computer Vision (ECCV).

</span>
<span class="ltx_bibblock">Springer (2012) 73–86

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Doersch, C., Gupta, A., Efros, A.A.:

</span>
<span class="ltx_bibblock">Mid-level visual element discovery as discriminative mode seeking.

</span>
<span class="ltx_bibblock">In: Advances in Neural Information Processing Systems (NIPS). (2013)
494–502

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Juneja, M., Vedaldi, A., Jawahar, C., Zisserman, A.:

</span>
<span class="ltx_bibblock">Blocks that shout: Distinctive parts for scene classification.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), IEEE (2013) 923–930

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Doersch, C., Singh, S., Gupta, A., Sivic, J., Efros, A.:

</span>
<span class="ltx_bibblock">What makes Paris look like Paris?

</span>
<span class="ltx_bibblock">SIGGRAPH (2012)

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Jaderberg, M., Simonyan, K., Zisserman, A., et al.:

</span>
<span class="ltx_bibblock">Spatial transformer networks.

</span>
<span class="ltx_bibblock">In: Advances in Neural Information Processing Systems (NIPS). (2015)
2017–2025

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
Mallya, A., Lazebnik, S.:

</span>
<span class="ltx_bibblock">Packnet: Adding multiple tasks to a single network by iterative
pruning.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), IEEE (2018)

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
Krizhevsky, A., Sutskever, I., Hinton, G.E.:

</span>
<span class="ltx_bibblock">Imagenet classification with deep convolutional neural networks.

</span>
<span class="ltx_bibblock">In: Advances in Neural Information Processing Systems (NIPS). (2012)

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., Sun, J.:

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">arXiv:1512.03385 (2015)

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
Hochreiter, S., Schmidhuber, J.:

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock">Neural Computation (1997)

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
Battaglia, P.W., Hamrick, J.B., Bapst, V., Sanchez-Gonzalez, A., Zambaldi, V.,
Malinowski, M., Tacchetti, A., Raposo, D., Santoro, A., Faulkner, R.,
et al.:

</span>
<span class="ltx_bibblock">Relational inductive biases, deep learning, and graph networks.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1806.01261 (2018)

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
Kingma, D., Ba, J.:

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">arXiv:1412.6980 (2014)

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
Simonyan, K., Zisserman, A.:

</span>
<span class="ltx_bibblock">Very deep convolutional networks for large-scale image recognition.

</span>
<span class="ltx_bibblock">arXiv:1409.1556 (2014)

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
Chen, Z., Yanpeng, Z., Shuaiyi, H., Kewei, T., Yi, M.:

</span>
<span class="ltx_bibblock">Structured attentions for visual question answering.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE International Conference on Computer
Vision (ICCV). (2017)

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
Hu, R., Andreas, J., Rohrbach, M., Darrell, T., Saenko, K.:

</span>
<span class="ltx_bibblock">Learning to reason: End-to-end module networks for visual question
answering.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE International Conference on Computer
Vision (ICCV). (2017)

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
Johnson, J., Hariharan, B., van der Maaten, L., Hoffman, J., Fei-Fei, L.,
Zitnick, C.L., Girshick, R.B.:

</span>
<span class="ltx_bibblock">Inferring and executing programs for visual reasoning.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE International Conference on Computer
Vision (ICCV). (2017)

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock">
Suarez, J., Johnson, J., Li, F.F.:

</span>
<span class="ltx_bibblock">Ddrprog: A clevr differentiable dynamic reasoning programmer.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1803.11361 (2018)

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1808.00299" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1808.00300" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1808.00300">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1808.00300" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1808.00302" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar 15 19:45:34 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
