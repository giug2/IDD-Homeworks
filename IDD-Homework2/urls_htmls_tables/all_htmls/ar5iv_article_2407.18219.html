<article class="ltx_document ltx_authors_1line ltx_fleqn">
 <div class="ltx_para" id="p1">
  <span class="ltx_ERROR undefined" id="p1.1">
   \correspondingauthor
  </span>
  <p class="ltx_p" id="p1.2">
   yuxiaoq@andrew.cmu.edu; This work was done at Carnegie Mellon University.
  </p>
 </div>
 <h1 class="ltx_title ltx_title_document">
  Recursive Introspection: Teaching Language Model Agents
  <em class="ltx_emph ltx_font_italic" id="id1.id1">
   How
  </em>
  to
  <em class="ltx_emph ltx_font_italic" id="id2.id2">
   Self-Improve
  </em>
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Yuxiao Qu
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
     Carnegie Mellon University
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Tianjun Zhang
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
     UC Berkeley
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Naman Garg
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
     MultiOn
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Aviral Kumar
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
     Carnegie Mellon University
    </span>
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id3.id1">
   A central piece in enabling intelligent agentic behavior in foundation models is to make them capable of introspecting upon their behavior, reasoning, and correcting their mistakes as more computation or interaction is available. Even the strongest proprietary large language models (LLMs) do not quite exhibit the ability of continually improving their responses sequentially, even in scenarios where they are explicitly told that they are making a mistake. In this paper, we develop
   <span class="ltx_text ltx_font_bold" id="id3.id1.1">
    RISE:
   </span>
   <em class="ltx_emph ltx_font_italic" id="id3.id1.2">
    <span class="ltx_text ltx_font_bold" id="id3.id1.2.1">
     R
    </span>
    ecursive
    <span class="ltx_text ltx_font_bold" id="id3.id1.2.2">
     I
    </span>
    ntro
    <span class="ltx_text ltx_font_bold" id="id3.id1.2.3">
     S
    </span>
    p
    <span class="ltx_text ltx_font_bold" id="id3.id1.2.4">
     E
    </span>
    ction
   </em>
   , an approach for fine-tuning LLMs to introduce this capability, despite prior work hypothesizing that this capability may not be possible to attain. Our approach prescribes an iterative fine-tuning procedure, which attempts to teach the model how to alter its response after having executed previously unsuccessful attempts to solve a hard test-time problem, with optionally additional environment feedback. RISE poses fine-tuning for a single-turn prompt as solving a multi-turn Markov decision process (MDP), where the initial state is the prompt. Inspired by principles in online imitation learning and reinforcement learning, we propose strategies for multi-turn data collection and training so as to imbue an LLM with the capability to recursively detect and correct its previous mistakes in subsequent iterations. Our experiments show that RISE enables Llama2, Llama3, and Mistral models to improve themselves with more turns on math reasoning tasks, outperforming several single-turn strategies given an equal amount of inference-time computation. We also find that RISE scales well, often attaining larger benefits with more capable models. Our analysis shows that RISE makes meaningful improvements to responses to arrive at the correct solution for challenging prompts, without disrupting one-turn abilities as a result of expressing more complex distributions.
  </p>
 </div>
 <section class="ltx_section" id="S1" lang="en">
  <h3 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h3>
  <div class="ltx_para ltx_noindent" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    A promising approach to utilizing and deploying foundation models, and in particular, large language models (LLMs), is to treat them as general-purpose decision-making machines, or ”agents”. To be successful, an LLM agent must not just provide plausible completions for input text, but must exhibit interactive, goal-directed behavior to accomplish a given task. Put in abstract terms, this requires mastering two qualities:
    <span class="ltx_text ltx_font_bold" id="S1.p1.1.1">
     (a)
    </span>
    producing responses that explicitly seek information about the task, followed by
    <span class="ltx_text ltx_font_bold" id="S1.p1.1.2">
     (b)
    </span>
    making decisions and improving them by ”thinking” and verifying them at inference time. For instance, to succeed in using a new coding library, an effective LLM agent should first synthesize programs, then try the most promising subset against a compiler, use the resulting feedback to improve the program, and repeat the process for multiple turns. Having the ability to successfully improve a response in sequential attempts is equivalent to a form of ”self-improvement”, at test time.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    To enable test-time self-improvement, recent approaches attempt to repurpose the knowledge already stored in pre-trained models via few-shot prompting
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib15" title="">
      15
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib31" title="">
      31
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib52" title="">
      52
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib64" title="">
      64
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib7" title="">
      7
     </a>
     ]
    </cite>
    . Although prompt tuning in conjunction with feedback is effective in eliciting improved responses from capable models, it fails to produce models that can succeed in complex tasks by correcting their own mistakes, such as those that require logical reasoning
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib21" title="">
      21
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib55" title="">
      55
     </a>
     ]
    </cite>
    . In many of these problems, models contain the “knowledge” needed to answer a challenging prompt, but are not able to elicit that knowledge even when asked to sequentially correct their mistakes. Fine-tuning the LLM on domain-specific question-answering data
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib39" title="">
      39
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib6" title="">
      6
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib29" title="">
      29
     </a>
     ]
    </cite>
    can help, but it still does not teach the agent a test-time improvement strategy (see Section
    <a class="ltx_ref" href="#S6" title="6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      6
     </span>
    </a>
    ). A strategy for improving responses over sequential attempts at test time is crucial for tackling challenging prompts, where directly attempting the problem in one shot may largely be futile.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">
     Can we train models to be capable of improving their
     <em class="ltx_emph ltx_font_italic" id="S1.p3.1.1.1">
      own
     </em>
     responses?
    </span>
    If done correctly and on a diverse set of problems and scenarios, this could introduce in an LLM, a general procedure for
    <em class="ltx_emph ltx_font_italic" id="S1.p3.1.2">
     “how”
    </em>
    it can tackle a hard prompt by improving itself as opposed to supervising it with “what” to respond with, which may not generalize as the test prompt becomes out of distribution. Although one straightforward approach to inducing this capability into a model would be to generate data that showcase improvements over multiple sequential turns (potentially from highly capable models), we find that simply imitating these data is not sufficient to enable this capability (Section
    <a class="ltx_ref" href="#S6.SS4" title="6.4 What Data Compositions and Data Quantity are Crucial for RISE? ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      6.4
     </span>
    </a>
    ). Quite well, this is due to two reasons: First, multi-turn data from a different model would not show improvements in the kinds of errors the learner would make, thereby being irrelevant to the learner
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib24" title="">
      24
     </a>
     ]
    </cite>
    . Second, often sequential multi-turn data collected from proprietary models is also not of high quality since these models are typically not good at proposing meaningful improvements to their own errors
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib21" title="">
      21
     </a>
     ]
    </cite>
    even though they can still provide useful responses to the problem at hand. Therefore, we need a different strategy to endow models with a self-improvement capability. Our key insight is to supervise improvements to the learner’s own responses in an iterative fashion, taking inspiration from methods in online imitation learning
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib36" title="">
      36
     </a>
     ]
    </cite>
    and reinforcement learning (RL)
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib45" title="">
      45
     </a>
     ]
    </cite>
    .
This supervision can be in the form of oracle responses to the prompt sampled i.i.d. from more capable models, or be generated from the learner itself.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    Our contribution is an algorithm
    <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">
     RISE:
    </span>
    <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">
     Recursive Introspection
    </span>
    (Figure
    <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    ) that utilizes these insights to improve the self-improvement capability of an LLM over the course of multiple attempts at a given prompt. In each iteration, our approach bootstraps on-policy rollouts from the learner with better responses at the next turn obtained by running best-of-N (using a success indicator on the task) on multiple revision candidates obtained by sampling from the learner itself or using responses from a more capable model, whichever is more convenient. In this way, we are able to construct rollouts that demonstrate the learner how it can improve its responses under its own distribution. Then, we fine-tune the learner on these data using a reward-weighted regression (RWR
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib35" title="">
      35
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib34" title="">
      34
     </a>
     ]
    </cite>
    ) objective, that is able to learn from both high- and low-quality parts of such rollouts. By iteratively repeating this procedure, we are able to instill a general self-improvement capability into an LLM. Our results show that LLMs trained via RISE can produce correct responses on more prompts, improving over turns for more challenging prompts.
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F1">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="170" id="S1.F1.g1" src="/html/2407.18219/assets/overview.png" width="509"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S1.F1.4.1.1" style="font-size:90%;">
      Figure 1
     </span>
     :
    </span>
    <span class="ltx_text" id="S1.F1.5.2" style="font-size:90%;">
     <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S1.F1.5.2.1" style="font-size:89%;">
      Recursive Introspection (RISE).
     </em>
     <span class="ltx_text" id="S1.F1.5.2.2" style="font-size:89%;">
      Using iterative multi-round training on on-policy rollouts and supervision from a reward function, RISE trains models that are capable of improving themselves over multiple turns. At inference, we run majority voting on candidate outputs from different turns to obtain the final response.
     </span>
    </span>
   </figcaption>
  </figure>
  <div class="ltx_para ltx_noindent" id="S1.p5">
   <p class="ltx_p" id="S1.p5.1">
    Even though strong base and intruction-tuned LLMs
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib23" title="">
      23
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib58" title="">
      58
     </a>
     ]
    </cite>
    often fail to improve their responses over multiple sequential attempts (even when explicitly told about their mistakes previously),
    <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">
     RISE
    </span>
    successfully endows similarly-sized LLMs with self-improvement capabilities, resulting in monotonically increasing task performance after each turn. Specifically, on the GSM8K
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib11" title="">
      11
     </a>
     ]
    </cite>
    dataset, RISE demonstrates significant improvement over various models. RISE improves the performance of LLaMa3-8B by 8.2% and Mistral-7B by 6.6%, entirely using their own data. RISE attains a 17.7% improvement for LLaMa2-7B over the course of 5-turn introspection (outperforming parallel sampling from the first turn), and a 23.9% improvement for Mistral-7B. In contrast, GPT-3.5 itself only improves by 4.6% over five turns. We see similar trends on the MATH dataset
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib18" title="">
      18
     </a>
     ]
    </cite>
    , where RISE improves LLaMa2-7B by 4.6% and Mistral-7B by 11.1% over five turns. We also study why and how RISE is able to induce self-improvement abilities and show that this ability generalizes to out-of-distribution prompts as well. These results consistently demonstrate RISE’s effectiveness in enhancing mathematical reasoning capabilities for different models.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S2" lang="en">
  <h3 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Related Work
  </h3>
  <div class="ltx_para ltx_noindent" id="S2.p1">
   <p class="ltx_p" id="S2.p1.1">
    Several prior works build techniques to improve reasoning and thinking capabilities of foundation models for downstream applications. Typically these works focus on building prompting techniques for effective multi-turn interaction with external tools
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib54" title="">
      54
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib7" title="">
      7
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib5" title="">
      5
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib32" title="">
      32
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib56" title="">
      56
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib49" title="">
      49
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib14" title="">
      14
     </a>
     ]
    </cite>
    , sequentially refining predictions by reflecting on actions
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib7" title="">
      7
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib15" title="">
      15
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib63" title="">
      63
     </a>
     ]
    </cite>
    , asking the model to verbalize its thoughts
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib52" title="">
      52
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib33" title="">
      33
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib65" title="">
      65
     </a>
     ]
    </cite>
    , asking the model to critique and revise itself
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib31" title="">
      31
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib40" title="">
      40
     </a>
     ]
    </cite>
    or by using other models to critique a primary model’s responses
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib12" title="">
      12
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib54" title="">
      54
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib2" title="">
      2
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib20" title="">
      20
     </a>
     ]
    </cite>
    . Although a subset of this work does improve its own responses, this self-correction ability often requires access to detailed error traces (e.g., execution traces from code compilers
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib31" title="">
      31
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib7" title="">
      7
     </a>
     ]
    </cite>
    ) in order to succeed. In fact,
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib21" title="">
      21
     </a>
     ]
    </cite>
    and Table
    <a class="ltx_ref" href="#S6.T1" title="Table 1 ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    both indicate that self-improvement guided by the LLM itself (i.e., “intrinsic self-correction”) is often infeasible for off-the-shelf LLMs even when they contain the knowledge required to tackle the prompt given,
    <span class="ltx_text ltx_font_bold" id="S2.p1.1.1">
     but fine-tuning with RISE induces this capability
    </span>
    as we show in this paper.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S2.p2">
   <p class="ltx_p" id="S2.p2.1">
    Beyond prompting, previous work also attempts to fine-tune LLM to obtain self-improvement capabilities
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib39" title="">
      39
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib6" title="">
      6
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib62" title="">
      62
     </a>
     ]
    </cite>
    . These works attempt to improve reasoning performance by training on self-generated responses
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib58" title="">
      58
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib60" title="">
      60
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib30" title="">
      30
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib46" title="">
      46
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib57" title="">
      57
     </a>
     ]
    </cite>
    . To achieve this, these works use a combination of learned verifiers
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib50" title="">
      50
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib28" title="">
      28
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib47" title="">
      47
     </a>
     ]
    </cite>
    , search
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib26" title="">
      26
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib33" title="">
      33
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib13" title="">
      13
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib38" title="">
      38
     </a>
     ]
    </cite>
    , contrastive prompting on negative data
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib9" title="">
      9
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib48" title="">
      48
     </a>
     ]
    </cite>
    , and iterated supervised or reinforcement learning (RL)
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib8" title="">
      8
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib59" title="">
      59
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib37" title="">
      37
     </a>
     ]
    </cite>
    . Although our approach also trains on model-generated data, we aim to introduce a complementary capability to improve performance over sequential turns of interaction, rather than to improve single-turn performance alone.
Other work fine-tunes LLMs for multi-turn interaction directly via RL
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib41" title="">
      41
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib66" title="">
      66
     </a>
     ]
    </cite>
    : while this is indeed related, single-turn problems posed in multi-turn scenarios require addressing distinct challenges than generic multi-turn RL:
    <span class="ltx_text ltx_font_bold" id="S2.p2.1.1">
     (i)
    </span>
    sample-efficiency is not a concern since the entire environment is fully characterized by the training dataset of prompts and oracle answers and dynamics are deterministic, and
    <span class="ltx_text ltx_font_bold" id="S2.p2.1.2">
     (ii)
    </span>
    we need to generalize to novel test prompts. Multi-turn RL focuses on sample efficiency, which is not as critical in our setting, though of course learning to generalize from a limited number of initial states would be appealing. Our main focus is to show that it is possible to train models for self-improvement via appropriately designing multi-turn fine-tuning objectives. This is orthogonal from the choice of training approach (RL or not).
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S2.p3">
   <p class="ltx_p" id="S2.p3.1">
    The most related to our work are GLoRE
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib17" title="">
      17
     </a>
     ]
    </cite>
    and Self-Correct
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib53" title="">
      53
     </a>
     ]
    </cite>
    , which train separate models to identify errors and refine incorrect answers of other LLMs. Unlike these works, our approach trains a single model to produce answers and improve them over more than two turns, which is the maximal number of turns studied in these works. We show that doing so successfully requires careful design choices: an iterative on-policy data generation strategy along with a training objective that can learn from both successful and unsuccessful rollouts. From an algorithmic point of view, RISE is similar to online imitation learning
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib36" title="">
      36
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib44" title="">
      44
     </a>
     ]
    </cite>
    , in that it queries expert supervision on states attained by on-policy rollouts. On-policy distillation for LLMs
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib1" title="">
      1
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib4" title="">
      4
     </a>
     ]
    </cite>
    utilizes this idea, but queries an expert to provide completions on partial responses instead of sequential attempts, that we do in this work.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S3" lang="en">
  <h3 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Problem Setup and Preliminaries
  </h3>
  <div class="ltx_para ltx_noindent" id="S3.p1">
   <p class="ltx_p" id="S3.p1.7">
    The goal of our work is to improve LLM performance over sequential attempts / turns at a given problem. Concretely, given a dataset
    <math alttext="\mathcal{D}=\{(\mathbf{x}_{i},\mathbf{y}^{*}_{i})\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1">
     <semantics id="S3.p1.1.m1.1a">
      <mrow id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">
       <mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml">
        𝒟
       </mi>
       <mo id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">
        =
       </mo>
       <msubsup id="S3.p1.1.m1.1.1.1" xref="S3.p1.1.m1.1.1.1.cmml">
        <mrow id="S3.p1.1.m1.1.1.1.1.1.1" xref="S3.p1.1.m1.1.1.1.1.1.2.cmml">
         <mo id="S3.p1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.p1.1.m1.1.1.1.1.1.2.cmml">
          {
         </mo>
         <mrow id="S3.p1.1.m1.1.1.1.1.1.1.1.2" xref="S3.p1.1.m1.1.1.1.1.1.1.1.3.cmml">
          <mo id="S3.p1.1.m1.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S3.p1.1.m1.1.1.1.1.1.1.1.3.cmml">
           (
          </mo>
          <msub id="S3.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml">
           <mi id="S3.p1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">
            𝐱
           </mi>
           <mi id="S3.p1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">
            i
           </mi>
          </msub>
          <mo id="S3.p1.1.m1.1.1.1.1.1.1.1.2.4" xref="S3.p1.1.m1.1.1.1.1.1.1.1.3.cmml">
           ,
          </mo>
          <msubsup id="S3.p1.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml">
           <mi id="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.2.cmml">
            𝐲
           </mi>
           <mi id="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">
            i
           </mi>
           <mo id="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">
            ∗
           </mo>
          </msubsup>
          <mo id="S3.p1.1.m1.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S3.p1.1.m1.1.1.1.1.1.1.1.3.cmml">
           )
          </mo>
         </mrow>
         <mo id="S3.p1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.p1.1.m1.1.1.1.1.1.2.cmml">
          }
         </mo>
        </mrow>
        <mrow id="S3.p1.1.m1.1.1.1.1.3" xref="S3.p1.1.m1.1.1.1.1.3.cmml">
         <mi id="S3.p1.1.m1.1.1.1.1.3.2" xref="S3.p1.1.m1.1.1.1.1.3.2.cmml">
          i
         </mi>
         <mo id="S3.p1.1.m1.1.1.1.1.3.1" xref="S3.p1.1.m1.1.1.1.1.3.1.cmml">
          =
         </mo>
         <mn id="S3.p1.1.m1.1.1.1.1.3.3" xref="S3.p1.1.m1.1.1.1.1.3.3.cmml">
          1
         </mn>
        </mrow>
        <mi id="S3.p1.1.m1.1.1.1.3" xref="S3.p1.1.m1.1.1.1.3.cmml">
         N
        </mi>
       </msubsup>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b">
       <apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">
        <eq id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">
        </eq>
        <ci id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3">
         𝒟
        </ci>
        <apply id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1">
         <csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.1">
          superscript
         </csymbol>
         <apply id="S3.p1.1.m1.1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1">
          <csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.1">
           subscript
          </csymbol>
          <set id="S3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1">
           <interval closure="open" id="S3.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2">
            <apply id="S3.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.1.1.2">
              𝐱
             </ci>
             <ci id="S3.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.1.1.3">
              𝑖
             </ci>
            </apply>
            <apply id="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2.2">
             <csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2.2">
              subscript
             </csymbol>
             <apply id="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2.2">
              <csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2.2">
               superscript
              </csymbol>
              <ci id="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.2">
               𝐲
              </ci>
              <times id="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.3">
              </times>
             </apply>
             <ci id="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2.2.3">
              𝑖
             </ci>
            </apply>
           </interval>
          </set>
          <apply id="S3.p1.1.m1.1.1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.1.1.3">
           <eq id="S3.p1.1.m1.1.1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.1.1.3.1">
           </eq>
           <ci id="S3.p1.1.m1.1.1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.1.1.3.2">
            𝑖
           </ci>
           <cn id="S3.p1.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="S3.p1.1.m1.1.1.1.1.3.3">
            1
           </cn>
          </apply>
         </apply>
         <ci id="S3.p1.1.m1.1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.1.3">
          𝑁
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">
       \mathcal{D}=\{(\mathbf{x}_{i},\mathbf{y}^{*}_{i})\}_{i=1}^{N}
      </annotation>
     </semantics>
    </math>
    of problems
    <math alttext="\mathbf{x}_{i}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1">
     <semantics id="S3.p1.2.m2.1a">
      <msub id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">
       <mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">
        𝐱
       </mi>
       <mi id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">
        i
       </mi>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b">
       <apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">
        <csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">
         subscript
        </csymbol>
        <ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">
         𝐱
        </ci>
        <ci id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">
         𝑖
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">
       \mathbf{x}_{i}
      </annotation>
     </semantics>
    </math>
    and oracle responses
    <math alttext="\mathbf{y}^{*}_{i}" class="ltx_Math" display="inline" id="S3.p1.3.m3.1">
     <semantics id="S3.p1.3.m3.1a">
      <msubsup id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">
       <mi id="S3.p1.3.m3.1.1.2.2" xref="S3.p1.3.m3.1.1.2.2.cmml">
        𝐲
       </mi>
       <mi id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml">
        i
       </mi>
       <mo id="S3.p1.3.m3.1.1.2.3" xref="S3.p1.3.m3.1.1.2.3.cmml">
        ∗
       </mo>
      </msubsup>
      <annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b">
       <apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">
        <csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1">
         subscript
        </csymbol>
        <apply id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1">
         <csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.2.1.cmml" xref="S3.p1.3.m3.1.1">
          superscript
         </csymbol>
         <ci id="S3.p1.3.m3.1.1.2.2.cmml" xref="S3.p1.3.m3.1.1.2.2">
          𝐲
         </ci>
         <times id="S3.p1.3.m3.1.1.2.3.cmml" xref="S3.p1.3.m3.1.1.2.3">
         </times>
        </apply>
        <ci id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3">
         𝑖
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">
       \mathbf{y}^{*}_{i}
      </annotation>
     </semantics>
    </math>
    , our goal is to obtain an LLM
    <math alttext="\pi_{\theta}(\cdot|[\mathbf{x},\hat{\mathbf{y}}_{1:t},p_{1:t}])" class="ltx_math_unparsed" display="inline" id="S3.p1.4.m4.1">
     <semantics id="S3.p1.4.m4.1a">
      <mrow id="S3.p1.4.m4.1b">
       <msub id="S3.p1.4.m4.1.1">
        <mi id="S3.p1.4.m4.1.1.2">
         π
        </mi>
        <mi id="S3.p1.4.m4.1.1.3">
         θ
        </mi>
       </msub>
       <mrow id="S3.p1.4.m4.1.2">
        <mo id="S3.p1.4.m4.1.2.1" stretchy="false">
         (
        </mo>
        <mo id="S3.p1.4.m4.1.2.2" lspace="0em" rspace="0em">
         ⋅
        </mo>
        <mo fence="false" id="S3.p1.4.m4.1.2.3" rspace="0.167em" stretchy="false">
         |
        </mo>
        <mrow id="S3.p1.4.m4.1.2.4">
         <mo id="S3.p1.4.m4.1.2.4.1" stretchy="false">
          [
         </mo>
         <mi id="S3.p1.4.m4.1.2.4.2">
          𝐱
         </mi>
         <mo id="S3.p1.4.m4.1.2.4.3">
          ,
         </mo>
         <msub id="S3.p1.4.m4.1.2.4.4">
          <mover accent="true" id="S3.p1.4.m4.1.2.4.4.2">
           <mi id="S3.p1.4.m4.1.2.4.4.2.2">
            𝐲
           </mi>
           <mo id="S3.p1.4.m4.1.2.4.4.2.1">
            ^
           </mo>
          </mover>
          <mrow id="S3.p1.4.m4.1.2.4.4.3">
           <mn id="S3.p1.4.m4.1.2.4.4.3.2">
            1
           </mn>
           <mo id="S3.p1.4.m4.1.2.4.4.3.1" lspace="0.278em" rspace="0.278em">
            :
           </mo>
           <mi id="S3.p1.4.m4.1.2.4.4.3.3">
            t
           </mi>
          </mrow>
         </msub>
         <mo id="S3.p1.4.m4.1.2.4.5">
          ,
         </mo>
         <msub id="S3.p1.4.m4.1.2.4.6">
          <mi id="S3.p1.4.m4.1.2.4.6.2">
           p
          </mi>
          <mrow id="S3.p1.4.m4.1.2.4.6.3">
           <mn id="S3.p1.4.m4.1.2.4.6.3.2">
            1
           </mn>
           <mo id="S3.p1.4.m4.1.2.4.6.3.1" lspace="0.278em" rspace="0.278em">
            :
           </mo>
           <mi id="S3.p1.4.m4.1.2.4.6.3.3">
            t
           </mi>
          </mrow>
         </msub>
         <mo id="S3.p1.4.m4.1.2.4.7" stretchy="false">
          ]
         </mo>
        </mrow>
        <mo id="S3.p1.4.m4.1.2.5" stretchy="false">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">
       \pi_{\theta}(\cdot|[\mathbf{x},\hat{\mathbf{y}}_{1:t},p_{1:t}])
      </annotation>
     </semantics>
    </math>
    that, given the problem
    <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.p1.5.m5.1">
     <semantics id="S3.p1.5.m5.1a">
      <mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">
       𝐱
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b">
       <ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">
        𝐱
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">
       \mathbf{x}
      </annotation>
     </semantics>
    </math>
    , previous model attempts
    <math alttext="\hat{\mathbf{y}}_{1:t}" class="ltx_Math" display="inline" id="S3.p1.6.m6.1">
     <semantics id="S3.p1.6.m6.1a">
      <msub id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">
       <mover accent="true" id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml">
        <mi id="S3.p1.6.m6.1.1.2.2" xref="S3.p1.6.m6.1.1.2.2.cmml">
         𝐲
        </mi>
        <mo id="S3.p1.6.m6.1.1.2.1" xref="S3.p1.6.m6.1.1.2.1.cmml">
         ^
        </mo>
       </mover>
       <mrow id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">
        <mn id="S3.p1.6.m6.1.1.3.2" xref="S3.p1.6.m6.1.1.3.2.cmml">
         1
        </mn>
        <mo id="S3.p1.6.m6.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.p1.6.m6.1.1.3.1.cmml">
         :
        </mo>
        <mi id="S3.p1.6.m6.1.1.3.3" xref="S3.p1.6.m6.1.1.3.3.cmml">
         t
        </mi>
       </mrow>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b">
       <apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">
        <csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1">
         subscript
        </csymbol>
        <apply id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2">
         <ci id="S3.p1.6.m6.1.1.2.1.cmml" xref="S3.p1.6.m6.1.1.2.1">
          ^
         </ci>
         <ci id="S3.p1.6.m6.1.1.2.2.cmml" xref="S3.p1.6.m6.1.1.2.2">
          𝐲
         </ci>
        </apply>
        <apply id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3">
         <ci id="S3.p1.6.m6.1.1.3.1.cmml" xref="S3.p1.6.m6.1.1.3.1">
          :
         </ci>
         <cn id="S3.p1.6.m6.1.1.3.2.cmml" type="integer" xref="S3.p1.6.m6.1.1.3.2">
          1
         </cn>
         <ci id="S3.p1.6.m6.1.1.3.3.cmml" xref="S3.p1.6.m6.1.1.3.3">
          𝑡
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">
       \hat{\mathbf{y}}_{1:t}
      </annotation>
     </semantics>
    </math>
    at the problem, and auxiliary instructions
    <math alttext="p_{1:t}" class="ltx_Math" display="inline" id="S3.p1.7.m7.1">
     <semantics id="S3.p1.7.m7.1a">
      <msub id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">
       <mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">
        p
       </mi>
       <mrow id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml">
        <mn id="S3.p1.7.m7.1.1.3.2" xref="S3.p1.7.m7.1.1.3.2.cmml">
         1
        </mn>
        <mo id="S3.p1.7.m7.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.p1.7.m7.1.1.3.1.cmml">
         :
        </mo>
        <mi id="S3.p1.7.m7.1.1.3.3" xref="S3.p1.7.m7.1.1.3.3.cmml">
         t
        </mi>
       </mrow>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b">
       <apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">
        <csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1">
         subscript
        </csymbol>
        <ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">
         𝑝
        </ci>
        <apply id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3">
         <ci id="S3.p1.7.m7.1.1.3.1.cmml" xref="S3.p1.7.m7.1.1.3.1">
          :
         </ci>
         <cn id="S3.p1.7.m7.1.1.3.2.cmml" type="integer" xref="S3.p1.7.m7.1.1.3.2">
          1
         </cn>
         <ci id="S3.p1.7.m7.1.1.3.3.cmml" xref="S3.p1.7.m7.1.1.3.3">
          𝑡
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">
       p_{1:t}
      </annotation>
     </semantics>
    </math>
    (e.g., instruction to find a mistake and improve the response; or additional compiler feedback from the environment) solves a given problem as correctly as possible. To this end, we encode this goal into the following learning objective that we wish to optimize:
   </p>
   <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx1">
    <tbody id="S3.E1">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_left_padleft">
      </td>
      <td class="ltx_td ltx_align_right ltx_eqn_cell">
       <math alttext="\displaystyle\max_{\pi_{\theta}}\leavevmode\nobreak\ \leavevmode\nobreak\ \sum_{i=1}^{L}\mathbb{E}_{\mathbf{x},\mathbf{y}^{*}\sim\mathcal{D},\hat{\mathbf{y}}_{i}\sim\pi_{\theta}(\cdot|[\mathbf{x},\hat{\mathbf{y}}_{1:i-1},p_{1:i-1}])}\left[\mathbb{I}\left(\hat{\mathbf{y}}_{i}==\mathbf{y}^{*}\right)\right]." class="ltx_math_unparsed" display="inline" id="S3.E1.m1.2">
        <semantics id="S3.E1.m1.2a">
         <mrow id="S3.E1.m1.2b">
          <munder id="S3.E1.m1.2.3">
           <mi id="S3.E1.m1.2.3.2">
            max
           </mi>
           <msub id="S3.E1.m1.2.3.3">
            <mi id="S3.E1.m1.2.3.3.2">
             π
            </mi>
            <mi id="S3.E1.m1.2.3.3.3">
             θ
            </mi>
           </msub>
          </munder>
          <mspace id="S3.E1.m1.2.4" width="1.167em">
          </mspace>
          <mstyle displaystyle="true" id="S3.E1.m1.2.5">
           <munderover id="S3.E1.m1.2.5a">
            <mo id="S3.E1.m1.2.5.2.2" movablelimits="false">
             ∑
            </mo>
            <mrow id="S3.E1.m1.2.5.2.3">
             <mi id="S3.E1.m1.2.5.2.3.2">
              i
             </mi>
             <mo id="S3.E1.m1.2.5.2.3.1">
              =
             </mo>
             <mn id="S3.E1.m1.2.5.2.3.3">
              1
             </mn>
            </mrow>
            <mi id="S3.E1.m1.2.5.3">
             L
            </mi>
           </munderover>
          </mstyle>
          <msub id="S3.E1.m1.2.6">
           <mi id="S3.E1.m1.2.6.2">
            𝔼
           </mi>
           <mrow id="S3.E1.m1.2.2.2">
            <mi id="S3.E1.m1.1.1.1.1">
             𝐱
            </mi>
            <mo id="S3.E1.m1.2.2.2.3">
             ,
            </mo>
            <msup id="S3.E1.m1.2.2.2.4">
             <mi id="S3.E1.m1.2.2.2.4.2">
              𝐲
             </mi>
             <mo id="S3.E1.m1.2.2.2.4.3">
              ∗
             </mo>
            </msup>
            <mo id="S3.E1.m1.2.2.2.5">
             ∼
            </mo>
            <mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.2.6">
             𝒟
            </mi>
            <mo id="S3.E1.m1.2.2.2.7">
             ,
            </mo>
            <msub id="S3.E1.m1.2.2.2.8">
             <mover accent="true" id="S3.E1.m1.2.2.2.8.2">
              <mi id="S3.E1.m1.2.2.2.8.2.2">
               𝐲
              </mi>
              <mo id="S3.E1.m1.2.2.2.8.2.1">
               ^
              </mo>
             </mover>
             <mi id="S3.E1.m1.2.2.2.8.3">
              i
             </mi>
            </msub>
            <mo id="S3.E1.m1.2.2.2.9">
             ∼
            </mo>
            <msub id="S3.E1.m1.2.2.2.10">
             <mi id="S3.E1.m1.2.2.2.10.2">
              π
             </mi>
             <mi id="S3.E1.m1.2.2.2.10.3">
              θ
             </mi>
            </msub>
            <mrow id="S3.E1.m1.2.2.2.11">
             <mo id="S3.E1.m1.2.2.2.11.1" stretchy="false">
              (
             </mo>
             <mo id="S3.E1.m1.2.2.2.11.2" lspace="0em" rspace="0em">
              ⋅
             </mo>
             <mo fence="false" id="S3.E1.m1.2.2.2.11.3" rspace="0.167em" stretchy="false">
              |
             </mo>
             <mrow id="S3.E1.m1.2.2.2.11.4">
              <mo id="S3.E1.m1.2.2.2.11.4.1" stretchy="false">
               [
              </mo>
              <mi id="S3.E1.m1.2.2.2.2">
               𝐱
              </mi>
              <mo id="S3.E1.m1.2.2.2.11.4.2">
               ,
              </mo>
              <msub id="S3.E1.m1.2.2.2.11.4.3">
               <mover accent="true" id="S3.E1.m1.2.2.2.11.4.3.2">
                <mi id="S3.E1.m1.2.2.2.11.4.3.2.2">
                 𝐲
                </mi>
                <mo id="S3.E1.m1.2.2.2.11.4.3.2.1">
                 ^
                </mo>
               </mover>
               <mrow id="S3.E1.m1.2.2.2.11.4.3.3">
                <mn id="S3.E1.m1.2.2.2.11.4.3.3.2">
                 1
                </mn>
                <mo id="S3.E1.m1.2.2.2.11.4.3.3.1" lspace="0.278em" rspace="0.278em">
                 :
                </mo>
                <mrow id="S3.E1.m1.2.2.2.11.4.3.3.3">
                 <mi id="S3.E1.m1.2.2.2.11.4.3.3.3.2">
                  i
                 </mi>
                 <mo id="S3.E1.m1.2.2.2.11.4.3.3.3.1">
                  −
                 </mo>
                 <mn id="S3.E1.m1.2.2.2.11.4.3.3.3.3">
                  1
                 </mn>
                </mrow>
               </mrow>
              </msub>
              <mo id="S3.E1.m1.2.2.2.11.4.4">
               ,
              </mo>
              <msub id="S3.E1.m1.2.2.2.11.4.5">
               <mi id="S3.E1.m1.2.2.2.11.4.5.2">
                p
               </mi>
               <mrow id="S3.E1.m1.2.2.2.11.4.5.3">
                <mn id="S3.E1.m1.2.2.2.11.4.5.3.2">
                 1
                </mn>
                <mo id="S3.E1.m1.2.2.2.11.4.5.3.1" lspace="0.278em" rspace="0.278em">
                 :
                </mo>
                <mrow id="S3.E1.m1.2.2.2.11.4.5.3.3">
                 <mi id="S3.E1.m1.2.2.2.11.4.5.3.3.2">
                  i
                 </mi>
                 <mo id="S3.E1.m1.2.2.2.11.4.5.3.3.1">
                  −
                 </mo>
                 <mn id="S3.E1.m1.2.2.2.11.4.5.3.3.3">
                  1
                 </mn>
                </mrow>
               </mrow>
              </msub>
              <mo id="S3.E1.m1.2.2.2.11.4.6" stretchy="false">
               ]
              </mo>
             </mrow>
             <mo id="S3.E1.m1.2.2.2.11.5" stretchy="false">
              )
             </mo>
            </mrow>
           </mrow>
          </msub>
          <mrow id="S3.E1.m1.2.7">
           <mo id="S3.E1.m1.2.7.1">
            [
           </mo>
           <mi id="S3.E1.m1.2.7.2">
            𝕀
           </mi>
           <mrow id="S3.E1.m1.2.7.3">
            <mo id="S3.E1.m1.2.7.3.1">
             (
            </mo>
            <msub id="S3.E1.m1.2.7.3.2">
             <mover accent="true" id="S3.E1.m1.2.7.3.2.2">
              <mi id="S3.E1.m1.2.7.3.2.2.2">
               𝐲
              </mi>
              <mo id="S3.E1.m1.2.7.3.2.2.1">
               ^
              </mo>
             </mover>
             <mi id="S3.E1.m1.2.7.3.2.3">
              i
             </mi>
            </msub>
            <mo id="S3.E1.m1.2.7.3.3" rspace="0em">
             =
            </mo>
            <mo id="S3.E1.m1.2.7.3.4" lspace="0em">
             =
            </mo>
            <msup id="S3.E1.m1.2.7.3.5">
             <mi id="S3.E1.m1.2.7.3.5.2">
              𝐲
             </mi>
             <mo id="S3.E1.m1.2.7.3.5.3">
              ∗
             </mo>
            </msup>
            <mo id="S3.E1.m1.2.7.3.6">
             )
            </mo>
           </mrow>
           <mo id="S3.E1.m1.2.7.4">
            ]
           </mo>
          </mrow>
          <mo id="S3.E1.m1.2.8" lspace="0em">
           .
          </mo>
         </mrow>
         <annotation encoding="application/x-tex" id="S3.E1.m1.2c">
          \displaystyle\max_{\pi_{\theta}}\leavevmode\nobreak\ \leavevmode\nobreak\ \sum_{i=1}^{L}\mathbb{E}_{\mathbf{x},\mathbf{y}^{*}\sim\mathcal{D},\hat{\mathbf{y}}_{i}\sim\pi_{\theta}(\cdot|[\mathbf{x},\hat{\mathbf{y}}_{1:i-1},p_{1:i-1}])}\left[\mathbb{I}\left(\hat{\mathbf{y}}_{i}==\mathbf{y}^{*}\right)\right].
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_left_padright">
      </td>
      <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
       <span class="ltx_tag ltx_tag_equation ltx_align_right">
        (3.1)
       </span>
      </td>
     </tr>
    </tbody>
   </table>
   <p class="ltx_p" id="S3.p1.16">
    Unlike standard supervised fine-tuning that trains the model
    <math alttext="\pi" class="ltx_Math" display="inline" id="S3.p1.8.m1.1">
     <semantics id="S3.p1.8.m1.1a">
      <mi id="S3.p1.8.m1.1.1" xref="S3.p1.8.m1.1.1.cmml">
       π
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p1.8.m1.1b">
       <ci id="S3.p1.8.m1.1.1.cmml" xref="S3.p1.8.m1.1.1">
        𝜋
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.8.m1.1c">
       \pi
      </annotation>
     </semantics>
    </math>
    to produce a single response
    <math alttext="\hat{\mathbf{y}}" class="ltx_Math" display="inline" id="S3.p1.9.m2.1">
     <semantics id="S3.p1.9.m2.1a">
      <mover accent="true" id="S3.p1.9.m2.1.1" xref="S3.p1.9.m2.1.1.cmml">
       <mi id="S3.p1.9.m2.1.1.2" xref="S3.p1.9.m2.1.1.2.cmml">
        𝐲
       </mi>
       <mo id="S3.p1.9.m2.1.1.1" xref="S3.p1.9.m2.1.1.1.cmml">
        ^
       </mo>
      </mover>
      <annotation-xml encoding="MathML-Content" id="S3.p1.9.m2.1b">
       <apply id="S3.p1.9.m2.1.1.cmml" xref="S3.p1.9.m2.1.1">
        <ci id="S3.p1.9.m2.1.1.1.cmml" xref="S3.p1.9.m2.1.1.1">
         ^
        </ci>
        <ci id="S3.p1.9.m2.1.1.2.cmml" xref="S3.p1.9.m2.1.1.2">
         𝐲
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.9.m2.1c">
       \hat{\mathbf{y}}
      </annotation>
     </semantics>
    </math>
    given
    <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.p1.10.m3.1">
     <semantics id="S3.p1.10.m3.1a">
      <mi id="S3.p1.10.m3.1.1" xref="S3.p1.10.m3.1.1.cmml">
       𝐱
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p1.10.m3.1b">
       <ci id="S3.p1.10.m3.1.1.cmml" xref="S3.p1.10.m3.1.1">
        𝐱
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.10.m3.1c">
       \mathbf{x}
      </annotation>
     </semantics>
    </math>
    , Equation
    <a class="ltx_ref" href="#S3.E1" title="Equation 3.1 ‣ 3 Problem Setup and Preliminaries ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      3.1
     </span>
    </a>
    trains
    <math alttext="\pi" class="ltx_Math" display="inline" id="S3.p1.11.m4.1">
     <semantics id="S3.p1.11.m4.1a">
      <mi id="S3.p1.11.m4.1.1" xref="S3.p1.11.m4.1.1.cmml">
       π
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p1.11.m4.1b">
       <ci id="S3.p1.11.m4.1.1.cmml" xref="S3.p1.11.m4.1.1">
        𝜋
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.11.m4.1c">
       \pi
      </annotation>
     </semantics>
    </math>
    to also appropriately react to a given history of responses from its own previous attempts
    <math alttext="\hat{\mathbf{y}}_{1:i-1}" class="ltx_Math" display="inline" id="S3.p1.12.m5.1">
     <semantics id="S3.p1.12.m5.1a">
      <msub id="S3.p1.12.m5.1.1" xref="S3.p1.12.m5.1.1.cmml">
       <mover accent="true" id="S3.p1.12.m5.1.1.2" xref="S3.p1.12.m5.1.1.2.cmml">
        <mi id="S3.p1.12.m5.1.1.2.2" xref="S3.p1.12.m5.1.1.2.2.cmml">
         𝐲
        </mi>
        <mo id="S3.p1.12.m5.1.1.2.1" xref="S3.p1.12.m5.1.1.2.1.cmml">
         ^
        </mo>
       </mover>
       <mrow id="S3.p1.12.m5.1.1.3" xref="S3.p1.12.m5.1.1.3.cmml">
        <mn id="S3.p1.12.m5.1.1.3.2" xref="S3.p1.12.m5.1.1.3.2.cmml">
         1
        </mn>
        <mo id="S3.p1.12.m5.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.p1.12.m5.1.1.3.1.cmml">
         :
        </mo>
        <mrow id="S3.p1.12.m5.1.1.3.3" xref="S3.p1.12.m5.1.1.3.3.cmml">
         <mi id="S3.p1.12.m5.1.1.3.3.2" xref="S3.p1.12.m5.1.1.3.3.2.cmml">
          i
         </mi>
         <mo id="S3.p1.12.m5.1.1.3.3.1" xref="S3.p1.12.m5.1.1.3.3.1.cmml">
          −
         </mo>
         <mn id="S3.p1.12.m5.1.1.3.3.3" xref="S3.p1.12.m5.1.1.3.3.3.cmml">
          1
         </mn>
        </mrow>
       </mrow>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p1.12.m5.1b">
       <apply id="S3.p1.12.m5.1.1.cmml" xref="S3.p1.12.m5.1.1">
        <csymbol cd="ambiguous" id="S3.p1.12.m5.1.1.1.cmml" xref="S3.p1.12.m5.1.1">
         subscript
        </csymbol>
        <apply id="S3.p1.12.m5.1.1.2.cmml" xref="S3.p1.12.m5.1.1.2">
         <ci id="S3.p1.12.m5.1.1.2.1.cmml" xref="S3.p1.12.m5.1.1.2.1">
          ^
         </ci>
         <ci id="S3.p1.12.m5.1.1.2.2.cmml" xref="S3.p1.12.m5.1.1.2.2">
          𝐲
         </ci>
        </apply>
        <apply id="S3.p1.12.m5.1.1.3.cmml" xref="S3.p1.12.m5.1.1.3">
         <ci id="S3.p1.12.m5.1.1.3.1.cmml" xref="S3.p1.12.m5.1.1.3.1">
          :
         </ci>
         <cn id="S3.p1.12.m5.1.1.3.2.cmml" type="integer" xref="S3.p1.12.m5.1.1.3.2">
          1
         </cn>
         <apply id="S3.p1.12.m5.1.1.3.3.cmml" xref="S3.p1.12.m5.1.1.3.3">
          <minus id="S3.p1.12.m5.1.1.3.3.1.cmml" xref="S3.p1.12.m5.1.1.3.3.1">
          </minus>
          <ci id="S3.p1.12.m5.1.1.3.3.2.cmml" xref="S3.p1.12.m5.1.1.3.3.2">
           𝑖
          </ci>
          <cn id="S3.p1.12.m5.1.1.3.3.3.cmml" type="integer" xref="S3.p1.12.m5.1.1.3.3.3">
           1
          </cn>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.12.m5.1c">
       \hat{\mathbf{y}}_{1:i-1}
      </annotation>
     </semantics>
    </math>
    . Equation
    <a class="ltx_ref" href="#S3.E1" title="Equation 3.1 ‣ 3 Problem Setup and Preliminaries ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      3.1
     </span>
    </a>
    most closely resembles an RL objective, and we will indeed develop our approach by converting a single-turn problem into a multi-turn MDP. Finally, note that prompting-based methods such as Self-Refine
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib31" title="">
      31
     </a>
     ]
    </cite>
    can still be viewed as training
    <math alttext="\pi" class="ltx_Math" display="inline" id="S3.p1.13.m6.1">
     <semantics id="S3.p1.13.m6.1a">
      <mi id="S3.p1.13.m6.1.1" xref="S3.p1.13.m6.1.1.cmml">
       π
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p1.13.m6.1b">
       <ci id="S3.p1.13.m6.1.1.cmml" xref="S3.p1.13.m6.1.1">
        𝜋
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.13.m6.1c">
       \pi
      </annotation>
     </semantics>
    </math>
    to optimize
    <math alttext="\pi(\mathbf{y}^{*}|\mathbf{x})" class="ltx_Math" display="inline" id="S3.p1.14.m7.1">
     <semantics id="S3.p1.14.m7.1a">
      <mrow id="S3.p1.14.m7.1.1" xref="S3.p1.14.m7.1.1.cmml">
       <mi id="S3.p1.14.m7.1.1.3" xref="S3.p1.14.m7.1.1.3.cmml">
        π
       </mi>
       <mo id="S3.p1.14.m7.1.1.2" lspace="0em" rspace="0em" xref="S3.p1.14.m7.1.1.2.cmml">
        ​
       </mo>
       <mrow id="S3.p1.14.m7.1.1.1.1" xref="S3.p1.14.m7.1.1.1.1.1.cmml">
        <mo id="S3.p1.14.m7.1.1.1.1.2" stretchy="false" xref="S3.p1.14.m7.1.1.1.1.1.cmml">
         (
        </mo>
        <mrow id="S3.p1.14.m7.1.1.1.1.1" xref="S3.p1.14.m7.1.1.1.1.1.cmml">
         <msup id="S3.p1.14.m7.1.1.1.1.1.2" xref="S3.p1.14.m7.1.1.1.1.1.2.cmml">
          <mi id="S3.p1.14.m7.1.1.1.1.1.2.2" xref="S3.p1.14.m7.1.1.1.1.1.2.2.cmml">
           𝐲
          </mi>
          <mo id="S3.p1.14.m7.1.1.1.1.1.2.3" xref="S3.p1.14.m7.1.1.1.1.1.2.3.cmml">
           ∗
          </mo>
         </msup>
         <mo fence="false" id="S3.p1.14.m7.1.1.1.1.1.1" xref="S3.p1.14.m7.1.1.1.1.1.1.cmml">
          |
         </mo>
         <mi id="S3.p1.14.m7.1.1.1.1.1.3" xref="S3.p1.14.m7.1.1.1.1.1.3.cmml">
          𝐱
         </mi>
        </mrow>
        <mo id="S3.p1.14.m7.1.1.1.1.3" stretchy="false" xref="S3.p1.14.m7.1.1.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.14.m7.1b">
       <apply id="S3.p1.14.m7.1.1.cmml" xref="S3.p1.14.m7.1.1">
        <times id="S3.p1.14.m7.1.1.2.cmml" xref="S3.p1.14.m7.1.1.2">
        </times>
        <ci id="S3.p1.14.m7.1.1.3.cmml" xref="S3.p1.14.m7.1.1.3">
         𝜋
        </ci>
        <apply id="S3.p1.14.m7.1.1.1.1.1.cmml" xref="S3.p1.14.m7.1.1.1.1">
         <csymbol cd="latexml" id="S3.p1.14.m7.1.1.1.1.1.1.cmml" xref="S3.p1.14.m7.1.1.1.1.1.1">
          conditional
         </csymbol>
         <apply id="S3.p1.14.m7.1.1.1.1.1.2.cmml" xref="S3.p1.14.m7.1.1.1.1.1.2">
          <csymbol cd="ambiguous" id="S3.p1.14.m7.1.1.1.1.1.2.1.cmml" xref="S3.p1.14.m7.1.1.1.1.1.2">
           superscript
          </csymbol>
          <ci id="S3.p1.14.m7.1.1.1.1.1.2.2.cmml" xref="S3.p1.14.m7.1.1.1.1.1.2.2">
           𝐲
          </ci>
          <times id="S3.p1.14.m7.1.1.1.1.1.2.3.cmml" xref="S3.p1.14.m7.1.1.1.1.1.2.3">
          </times>
         </apply>
         <ci id="S3.p1.14.m7.1.1.1.1.1.3.cmml" xref="S3.p1.14.m7.1.1.1.1.1.3">
          𝐱
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.14.m7.1c">
       \pi(\mathbf{y}^{*}|\mathbf{x})
      </annotation>
     </semantics>
    </math>
    but only when only allowed to modulate the prompt
    <math alttext="p_{i}" class="ltx_Math" display="inline" id="S3.p1.15.m8.1">
     <semantics id="S3.p1.15.m8.1a">
      <msub id="S3.p1.15.m8.1.1" xref="S3.p1.15.m8.1.1.cmml">
       <mi id="S3.p1.15.m8.1.1.2" xref="S3.p1.15.m8.1.1.2.cmml">
        p
       </mi>
       <mi id="S3.p1.15.m8.1.1.3" xref="S3.p1.15.m8.1.1.3.cmml">
        i
       </mi>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p1.15.m8.1b">
       <apply id="S3.p1.15.m8.1.1.cmml" xref="S3.p1.15.m8.1.1">
        <csymbol cd="ambiguous" id="S3.p1.15.m8.1.1.1.cmml" xref="S3.p1.15.m8.1.1">
         subscript
        </csymbol>
        <ci id="S3.p1.15.m8.1.1.2.cmml" xref="S3.p1.15.m8.1.1.2">
         𝑝
        </ci>
        <ci id="S3.p1.15.m8.1.1.3.cmml" xref="S3.p1.15.m8.1.1.3">
         𝑖
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.15.m8.1c">
       p_{i}
      </annotation>
     </semantics>
    </math>
    to optimize Equation
    <a class="ltx_ref" href="#S3.E1" title="Equation 3.1 ‣ 3 Problem Setup and Preliminaries ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      3.1
     </span>
    </a>
    . Naturally, since the parameters
    <math alttext="\theta" class="ltx_Math" display="inline" id="S3.p1.16.m9.1">
     <semantics id="S3.p1.16.m9.1a">
      <mi id="S3.p1.16.m9.1.1" xref="S3.p1.16.m9.1.1.cmml">
       θ
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p1.16.m9.1b">
       <ci id="S3.p1.16.m9.1.1.cmml" xref="S3.p1.16.m9.1.1">
        𝜃
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.16.m9.1c">
       \theta
      </annotation>
     </semantics>
    </math>
    are unchanged, this would not be effective in optimizing the objective fully.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S4" lang="en">
  <h3 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   RISE: Recursive Introspection for Self-Improvement
  </h3>
  <div class="ltx_para ltx_noindent" id="S4.p1">
   <p class="ltx_p" id="S4.p1.1">
    Since even strong off-the-shelf models do not exhibit an effective ability to improve themselves when provided with sequential attempts at a given problem
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib21" title="">
      21
     </a>
     ]
    </cite>
    , a natural next step is to ask how to train models to induce this capability. In this section, we will develop our approach,
    <span class="ltx_text ltx_font_bold" id="S4.p1.1.1">
     RISE
    </span>
    , for fine-tuning foundation models towards improving their own predictions over multiple turns. Our approach will first convert a problem into a multi-turn MDP, then collect data, and finally run offline reward-weighted supervised learning in this multi-turn MDP to induce this capability.
   </p>
  </div>
  <figure class="ltx_figure" id="S4.F2">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="160" id="S4.F2.g1" src="/html/2407.18219/assets/problem_formulation_data_collection.png" width="538"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S4.F2.5.2.1" style="font-size:90%;">
      Figure 2
     </span>
     :
    </span>
    <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S4.F2.6.3" style="font-size:80%;">
     Left: Problem formulation.
    </em>
    <span class="ltx_text" id="S4.F2.2.1" style="font-size:80%;">
     We convert single-turn problems into multi-turn MDPs as discussed in Section
     <a class="ltx_ref" href="#S4.SS1" title="4.1 Converting Single-Turn Problems into a Multi-Turn Markov Decision Process (MDP) ‣ 4 RISE: Recursive Introspection for Self-Improvement ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       4.1
      </span>
     </a>
     . The state is given by the prompt, history of prior attempts, and optional feedback from the environment. An action is a response generated from the LLM given the state of multi-turn interaction so far.
     <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S4.F2.2.1.1">
      Right: Data collection.
     </em>
     We collect data by unrolling the current model
     <math alttext="k-1" class="ltx_Math" display="inline" id="S4.F2.2.1.m1.1">
      <semantics id="S4.F2.2.1.m1.1b">
       <mrow id="S4.F2.2.1.m1.1.1" xref="S4.F2.2.1.m1.1.1.cmml">
        <mi id="S4.F2.2.1.m1.1.1.2" xref="S4.F2.2.1.m1.1.1.2.cmml">
         k
        </mi>
        <mo id="S4.F2.2.1.m1.1.1.1" xref="S4.F2.2.1.m1.1.1.1.cmml">
         −
        </mo>
        <mn id="S4.F2.2.1.m1.1.1.3" xref="S4.F2.2.1.m1.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.F2.2.1.m1.1c">
        <apply id="S4.F2.2.1.m1.1.1.cmml" xref="S4.F2.2.1.m1.1.1">
         <minus id="S4.F2.2.1.m1.1.1.1.cmml" xref="S4.F2.2.1.m1.1.1.1">
         </minus>
         <ci id="S4.F2.2.1.m1.1.1.2.cmml" xref="S4.F2.2.1.m1.1.1.2">
          𝑘
         </ci>
         <cn id="S4.F2.2.1.m1.1.1.3.cmml" type="integer" xref="S4.F2.2.1.m1.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.F2.2.1.m1.1d">
        k-1
       </annotation>
      </semantics>
     </math>
     times followed by an improved version of the response, which is obtained by either (1)
     <span class="ltx_text ltx_font_bold" id="S4.F2.2.1.2">
      self-distillation
     </span>
     : sample multiple responses from the current model, and use the best response, or (2)
     <span class="ltx_text ltx_font_bold" id="S4.F2.2.1.3">
      distillation
     </span>
     : obtain oracle responses by querying a more capable model. In either case, RISE then trains on the generated data.
    </span>
   </figcaption>
  </figure>
  <section class="ltx_subsection" id="S4.SS1">
   <h4 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    Converting Single-Turn Problems into a Multi-Turn Markov Decision Process (MDP)
   </h4>
   <div class="ltx_para ltx_noindent" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.15">
     The first step in building our approach is to procedurally construct a multi-turn MDP out of a single-turn dataset of prompts and oracle responses (Figure
     <a class="ltx_ref" href="#S4.F2" title="Figure 2 ‣ 4 RISE: Recursive Introspection for Self-Improvement ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     , Left). Given a dataset,
     <math alttext="\mathcal{D}=\{(\mathbf{x}_{i},\mathbf{y}^{*}_{i})\}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1">
      <semantics id="S4.SS1.p1.1.m1.1a">
       <mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">
         𝒟
        </mi>
        <mo id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">
         =
        </mo>
        <mrow id="S4.SS1.p1.1.m1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.2.cmml">
         <mo id="S4.SS1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.1.2.cmml">
          {
         </mo>
         <mrow id="S4.SS1.p1.1.m1.1.1.1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.1.1.1.3.cmml">
          <mo id="S4.SS1.p1.1.m1.1.1.1.1.1.2.3" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.1.1.1.3.cmml">
           (
          </mo>
          <msub id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml">
           <mi id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.2.cmml">
            𝐱
           </mi>
           <mi id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.3.cmml">
            i
           </mi>
          </msub>
          <mo id="S4.SS1.p1.1.m1.1.1.1.1.1.2.4" xref="S4.SS1.p1.1.m1.1.1.1.1.1.3.cmml">
           ,
          </mo>
          <msubsup id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.cmml">
           <mi id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2.2" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml">
            𝐲
           </mi>
           <mi id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.cmml">
            i
           </mi>
           <mo id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml">
            ∗
           </mo>
          </msubsup>
          <mo id="S4.SS1.p1.1.m1.1.1.1.1.1.2.5" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.1.1.1.3.cmml">
           )
          </mo>
         </mrow>
         <mo id="S4.SS1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.1.2.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b">
        <apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">
         <eq id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">
         </eq>
         <ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">
          𝒟
         </ci>
         <set id="S4.SS1.p1.1.m1.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1">
          <interval closure="open" id="S4.SS1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2">
           <apply id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.2">
             𝐱
            </ci>
            <ci id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.3">
             𝑖
            </ci>
           </apply>
           <apply id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2">
            <csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2">
             subscript
            </csymbol>
            <apply id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2">
             <csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2">
              superscript
             </csymbol>
             <ci id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2.2">
              𝐲
             </ci>
             <times id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3">
             </times>
            </apply>
            <ci id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3">
             𝑖
            </ci>
           </apply>
          </interval>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">
        \mathcal{D}=\{(\mathbf{x}_{i},\mathbf{y}^{*}_{i})\}
       </annotation>
      </semantics>
     </math>
     , consisting of prompts
     <math alttext="\mathbf{x}_{i}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1">
      <semantics id="S4.SS1.p1.2.m2.1a">
       <msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">
        <mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">
         𝐱
        </mi>
        <mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b">
        <apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">
          𝐱
         </ci>
         <ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">
        \mathbf{x}_{i}
       </annotation>
      </semantics>
     </math>
     and corresponding oracle responses
     <math alttext="\mathbf{y}_{i}^{*}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1">
      <semantics id="S4.SS1.p1.3.m3.1a">
       <msubsup id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">
        <mi id="S4.SS1.p1.3.m3.1.1.2.2" xref="S4.SS1.p1.3.m3.1.1.2.2.cmml">
         𝐲
        </mi>
        <mi id="S4.SS1.p1.3.m3.1.1.2.3" xref="S4.SS1.p1.3.m3.1.1.2.3.cmml">
         i
        </mi>
        <mo id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">
         ∗
        </mo>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b">
        <apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">
          superscript
         </csymbol>
         <apply id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1">
          <csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.p1.3.m3.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS1.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2.2">
           𝐲
          </ci>
          <ci id="S4.SS1.p1.3.m3.1.1.2.3.cmml" xref="S4.SS1.p1.3.m3.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <times id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3">
         </times>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">
        \mathbf{y}_{i}^{*}
       </annotation>
      </semantics>
     </math>
     (e.g., math questions and natural language responses to those questions), we will construct an
     <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.15.1">
      induced
     </em>
     MDP
     <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1">
      <semantics id="S4.SS1.p1.4.m4.1a">
       <mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">
        ℳ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b">
        <ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">
         ℳ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">
        \mathcal{M}
       </annotation>
      </semantics>
     </math>
     from
     <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1">
      <semantics id="S4.SS1.p1.5.m5.1a">
       <mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">
        𝒟
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b">
        <ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">
         𝒟
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">
        \mathcal{D}
       </annotation>
      </semantics>
     </math>
     , and then learn policies in this MDP. An initial state in this MDP is a possible prompt
     <math alttext="\mathbf{x}_{i}\in\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1">
      <semantics id="S4.SS1.p1.6.m6.1a">
       <mrow id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">
        <msub id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml">
         <mi id="S4.SS1.p1.6.m6.1.1.2.2" xref="S4.SS1.p1.6.m6.1.1.2.2.cmml">
          𝐱
         </mi>
         <mi id="S4.SS1.p1.6.m6.1.1.2.3" xref="S4.SS1.p1.6.m6.1.1.2.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S4.SS1.p1.6.m6.1.1.1" xref="S4.SS1.p1.6.m6.1.1.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml">
         𝒟
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b">
        <apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">
         <in id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1">
         </in>
         <apply id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2">
          <csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.2.1.cmml" xref="S4.SS1.p1.6.m6.1.1.2">
           subscript
          </csymbol>
          <ci id="S4.SS1.p1.6.m6.1.1.2.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2.2">
           𝐱
          </ci>
          <ci id="S4.SS1.p1.6.m6.1.1.2.3.cmml" xref="S4.SS1.p1.6.m6.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3">
          𝒟
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">
        \mathbf{x}_{i}\in\mathcal{D}
       </annotation>
      </semantics>
     </math>
     . We denote the output response from the foundation model as action
     <math alttext="\mathbf{a}" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1">
      <semantics id="S4.SS1.p1.7.m7.1a">
       <mi id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">
        𝐚
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b">
        <ci id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">
         𝐚
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">
        \mathbf{a}
       </annotation>
      </semantics>
     </math>
     . Given a state
     <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m8.1">
      <semantics id="S4.SS1.p1.8.m8.1a">
       <mi id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">
        𝐬
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b">
        <ci id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">
         𝐬
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">
        \mathbf{s}
       </annotation>
      </semantics>
     </math>
     , the next state can be obtained by concatenating the tokens representing
     <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m9.1">
      <semantics id="S4.SS1.p1.9.m9.1a">
       <mi id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml">
        𝐬
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b">
        <ci id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">
         𝐬
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">
        \mathbf{s}
       </annotation>
      </semantics>
     </math>
     with the action
     <math alttext="\mathbf{a}" class="ltx_Math" display="inline" id="S4.SS1.p1.10.m10.1">
      <semantics id="S4.SS1.p1.10.m10.1a">
       <mi id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml">
        𝐚
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b">
        <ci id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1">
         𝐚
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">
        \mathbf{a}
       </annotation>
      </semantics>
     </math>
     proposed by the model, and an additional fixed prompt
     <math alttext="\mathbf{f}" class="ltx_Math" display="inline" id="S4.SS1.p1.11.m11.1">
      <semantics id="S4.SS1.p1.11.m11.1a">
       <mi id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml">
        𝐟
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b">
        <ci id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1">
         𝐟
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">
        \mathbf{f}
       </annotation>
      </semantics>
     </math>
     that asks the model to introspect, e.g.,
     <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.15.2">
      “this response is not correct, please introspect and correct your answer.”
     </em>
     (the exact prompt is shown in Appendix
     <a class="ltx_ref" href="#A4.SS4" title="D.4 Prompts used for seeding RISE on the GSM8K and MATH tasks ‣ Appendix D Experimental Details ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       D.4
      </span>
     </a>
     ). The reward function is a sparse binary indicator of answer correctness at a given state
     <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S4.SS1.p1.12.m12.1">
      <semantics id="S4.SS1.p1.12.m12.1a">
       <mi id="S4.SS1.p1.12.m12.1.1" xref="S4.SS1.p1.12.m12.1.1.cmml">
        𝐬
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.1b">
        <ci id="S4.SS1.p1.12.m12.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1">
         𝐬
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.1c">
        \mathbf{s}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="r([\mathbf{x}_{i},\cdots],\mathbf{a})=1\text{\leavevmode\nobreak\ if and only if\leavevmode\nobreak\ }\mathbf{a}=\mathbf{y}^{*}_{i}" class="ltx_Math" display="inline" id="S4.SS1.p1.13.m13.3">
      <semantics id="S4.SS1.p1.13.m13.3a">
       <mrow id="S4.SS1.p1.13.m13.3.3" xref="S4.SS1.p1.13.m13.3.3.cmml">
        <mrow id="S4.SS1.p1.13.m13.3.3.1" xref="S4.SS1.p1.13.m13.3.3.1.cmml">
         <mi id="S4.SS1.p1.13.m13.3.3.1.3" xref="S4.SS1.p1.13.m13.3.3.1.3.cmml">
          r
         </mi>
         <mo id="S4.SS1.p1.13.m13.3.3.1.2" lspace="0em" rspace="0em" xref="S4.SS1.p1.13.m13.3.3.1.2.cmml">
          ​
         </mo>
         <mrow id="S4.SS1.p1.13.m13.3.3.1.1.1" xref="S4.SS1.p1.13.m13.3.3.1.1.2.cmml">
          <mo id="S4.SS1.p1.13.m13.3.3.1.1.1.2" stretchy="false" xref="S4.SS1.p1.13.m13.3.3.1.1.2.cmml">
           (
          </mo>
          <mrow id="S4.SS1.p1.13.m13.3.3.1.1.1.1.1" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.2.cmml">
           <mo id="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.2.cmml">
            [
           </mo>
           <msub id="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1.cmml">
            <mi id="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1.2" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1.2.cmml">
             𝐱
            </mi>
            <mi id="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1.3" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1.3.cmml">
             i
            </mi>
           </msub>
           <mo id="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.3" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.2.cmml">
            ,
           </mo>
           <mi id="S4.SS1.p1.13.m13.1.1" mathvariant="normal" xref="S4.SS1.p1.13.m13.1.1.cmml">
            ⋯
           </mi>
           <mo id="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.4" stretchy="false" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.2.cmml">
            ]
           </mo>
          </mrow>
          <mo id="S4.SS1.p1.13.m13.3.3.1.1.1.3" xref="S4.SS1.p1.13.m13.3.3.1.1.2.cmml">
           ,
          </mo>
          <mi id="S4.SS1.p1.13.m13.2.2" xref="S4.SS1.p1.13.m13.2.2.cmml">
           𝐚
          </mi>
          <mo id="S4.SS1.p1.13.m13.3.3.1.1.1.4" stretchy="false" xref="S4.SS1.p1.13.m13.3.3.1.1.2.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S4.SS1.p1.13.m13.3.3.3" xref="S4.SS1.p1.13.m13.3.3.3.cmml">
         =
        </mo>
        <mrow id="S4.SS1.p1.13.m13.3.3.4" xref="S4.SS1.p1.13.m13.3.3.4.cmml">
         <mn id="S4.SS1.p1.13.m13.3.3.4.2" xref="S4.SS1.p1.13.m13.3.3.4.2.cmml">
          1
         </mn>
         <mo id="S4.SS1.p1.13.m13.3.3.4.1" lspace="0em" rspace="0em" xref="S4.SS1.p1.13.m13.3.3.4.1.cmml">
          ​
         </mo>
         <mtext id="S4.SS1.p1.13.m13.3.3.4.3" xref="S4.SS1.p1.13.m13.3.3.4.3a.cmml">
          if and only if
         </mtext>
         <mo id="S4.SS1.p1.13.m13.3.3.4.1a" lspace="0em" rspace="0em" xref="S4.SS1.p1.13.m13.3.3.4.1.cmml">
          ​
         </mo>
         <mi id="S4.SS1.p1.13.m13.3.3.4.4" xref="S4.SS1.p1.13.m13.3.3.4.4.cmml">
          𝐚
         </mi>
        </mrow>
        <mo id="S4.SS1.p1.13.m13.3.3.5" xref="S4.SS1.p1.13.m13.3.3.5.cmml">
         =
        </mo>
        <msubsup id="S4.SS1.p1.13.m13.3.3.6" xref="S4.SS1.p1.13.m13.3.3.6.cmml">
         <mi id="S4.SS1.p1.13.m13.3.3.6.2.2" xref="S4.SS1.p1.13.m13.3.3.6.2.2.cmml">
          𝐲
         </mi>
         <mi id="S4.SS1.p1.13.m13.3.3.6.3" xref="S4.SS1.p1.13.m13.3.3.6.3.cmml">
          i
         </mi>
         <mo id="S4.SS1.p1.13.m13.3.3.6.2.3" xref="S4.SS1.p1.13.m13.3.3.6.2.3.cmml">
          ∗
         </mo>
        </msubsup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.3b">
        <apply id="S4.SS1.p1.13.m13.3.3.cmml" xref="S4.SS1.p1.13.m13.3.3">
         <and id="S4.SS1.p1.13.m13.3.3a.cmml" xref="S4.SS1.p1.13.m13.3.3">
         </and>
         <apply id="S4.SS1.p1.13.m13.3.3b.cmml" xref="S4.SS1.p1.13.m13.3.3">
          <eq id="S4.SS1.p1.13.m13.3.3.3.cmml" xref="S4.SS1.p1.13.m13.3.3.3">
          </eq>
          <apply id="S4.SS1.p1.13.m13.3.3.1.cmml" xref="S4.SS1.p1.13.m13.3.3.1">
           <times id="S4.SS1.p1.13.m13.3.3.1.2.cmml" xref="S4.SS1.p1.13.m13.3.3.1.2">
           </times>
           <ci id="S4.SS1.p1.13.m13.3.3.1.3.cmml" xref="S4.SS1.p1.13.m13.3.3.1.3">
            𝑟
           </ci>
           <interval closure="open" id="S4.SS1.p1.13.m13.3.3.1.1.2.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1">
            <interval closure="closed" id="S4.SS1.p1.13.m13.3.3.1.1.1.1.2.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.1">
             <apply id="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1.2">
               𝐱
              </ci>
              <ci id="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.1.3">
               𝑖
              </ci>
             </apply>
             <ci id="S4.SS1.p1.13.m13.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1">
              ⋯
             </ci>
            </interval>
            <ci id="S4.SS1.p1.13.m13.2.2.cmml" xref="S4.SS1.p1.13.m13.2.2">
             𝐚
            </ci>
           </interval>
          </apply>
          <apply id="S4.SS1.p1.13.m13.3.3.4.cmml" xref="S4.SS1.p1.13.m13.3.3.4">
           <times id="S4.SS1.p1.13.m13.3.3.4.1.cmml" xref="S4.SS1.p1.13.m13.3.3.4.1">
           </times>
           <cn id="S4.SS1.p1.13.m13.3.3.4.2.cmml" type="integer" xref="S4.SS1.p1.13.m13.3.3.4.2">
            1
           </cn>
           <ci id="S4.SS1.p1.13.m13.3.3.4.3a.cmml" xref="S4.SS1.p1.13.m13.3.3.4.3">
            <mtext id="S4.SS1.p1.13.m13.3.3.4.3.cmml" xref="S4.SS1.p1.13.m13.3.3.4.3">
             if and only if
            </mtext>
           </ci>
           <ci id="S4.SS1.p1.13.m13.3.3.4.4.cmml" xref="S4.SS1.p1.13.m13.3.3.4.4">
            𝐚
           </ci>
          </apply>
         </apply>
         <apply id="S4.SS1.p1.13.m13.3.3c.cmml" xref="S4.SS1.p1.13.m13.3.3">
          <eq id="S4.SS1.p1.13.m13.3.3.5.cmml" xref="S4.SS1.p1.13.m13.3.3.5">
          </eq>
          <share href="#S4.SS1.p1.13.m13.3.3.4.cmml" id="S4.SS1.p1.13.m13.3.3d.cmml" xref="S4.SS1.p1.13.m13.3.3">
          </share>
          <apply id="S4.SS1.p1.13.m13.3.3.6.cmml" xref="S4.SS1.p1.13.m13.3.3.6">
           <csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.3.3.6.1.cmml" xref="S4.SS1.p1.13.m13.3.3.6">
            subscript
           </csymbol>
           <apply id="S4.SS1.p1.13.m13.3.3.6.2.cmml" xref="S4.SS1.p1.13.m13.3.3.6">
            <csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.3.3.6.2.1.cmml" xref="S4.SS1.p1.13.m13.3.3.6">
             superscript
            </csymbol>
            <ci id="S4.SS1.p1.13.m13.3.3.6.2.2.cmml" xref="S4.SS1.p1.13.m13.3.3.6.2.2">
             𝐲
            </ci>
            <times id="S4.SS1.p1.13.m13.3.3.6.2.3.cmml" xref="S4.SS1.p1.13.m13.3.3.6.2.3">
            </times>
           </apply>
           <ci id="S4.SS1.p1.13.m13.3.3.6.3.cmml" xref="S4.SS1.p1.13.m13.3.3.6.3">
            𝑖
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.3c">
        r([\mathbf{x}_{i},\cdots],\mathbf{a})=1\text{\leavevmode\nobreak\ if and only if\leavevmode\nobreak\ }\mathbf{a}=\mathbf{y}^{*}_{i}
       </annotation>
      </semantics>
     </math>
     and is obtained from an answer checking function. This construction from dataset
     <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS1.p1.14.m14.1">
      <semantics id="S4.SS1.p1.14.m14.1a">
       <mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.14.m14.1.1" xref="S4.SS1.p1.14.m14.1.1.cmml">
        𝒟
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m14.1b">
        <ci id="S4.SS1.p1.14.m14.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1">
         𝒟
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.14.m14.1c">
        \mathcal{D}
       </annotation>
      </semantics>
     </math>
     to MDP
     <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S4.SS1.p1.15.m15.1">
      <semantics id="S4.SS1.p1.15.m15.1a">
       <mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.15.m15.1.1" xref="S4.SS1.p1.15.m15.1.1.cmml">
        ℳ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.15.m15.1b">
        <ci id="S4.SS1.p1.15.m15.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1">
         ℳ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.15.m15.1c">
        \mathcal{M}
       </annotation>
      </semantics>
     </math>
     is shown below:
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS1.p2">
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx2">
     <tbody id="S4.E1">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_left_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{D}=\{\left(\mathbf{x}_{i},\mathbf{y}^{*}_{i}\right)\}\leavevmode\nobreak\ \leavevmode\nobreak\ \rightarrow\leavevmode\nobreak\ \leavevmode\nobreak\ \mathcal{M}:\leavevmode\nobreak\ \leavevmode\nobreak\ " class="ltx_Math" display="inline" id="S4.E1.m1.3">
         <semantics id="S4.E1.m1.3a">
          <mrow id="S4.E1.m1.3.3.1" xref="S4.E1.m1.3.3.1.1.cmml">
           <mrow id="S4.E1.m1.3.3.1.1" xref="S4.E1.m1.3.3.1.1.cmml">
            <mrow id="S4.E1.m1.3.3.1.1.1" xref="S4.E1.m1.3.3.1.1.1.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.3.3.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.3.cmml">
              𝒟
             </mi>
             <mo id="S4.E1.m1.3.3.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.2.cmml">
              =
             </mo>
             <mrow id="S4.E1.m1.3.3.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.2.cmml">
              <mrow id="S4.E1.m1.3.3.1.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml">
               <mo id="S4.E1.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml">
                {
               </mo>
               <mrow id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">
                <mo id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">
                 (
                </mo>
                <msub id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">
                 <mi id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">
                  𝐱
                 </mi>
                 <mi id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">
                  i
                 </mi>
                </msub>
                <mo id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.4" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">
                 ,
                </mo>
                <msubsup id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml">
                 <mi id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml">
                  𝐲
                 </mi>
                 <mi id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml">
                  i
                 </mi>
                 <mo id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml">
                  ∗
                 </mo>
                </msubsup>
                <mo id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.5" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">
                 )
                </mo>
               </mrow>
               <mo id="S4.E1.m1.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml">
                }
               </mo>
              </mrow>
              <mspace id="S4.E1.m1.3.3.1.1.1.1.1.2" width="1em" xref="S4.E1.m1.3.3.1.1.1.1.2.cmml">
              </mspace>
              <mo id="S4.E1.m1.1.1" stretchy="false" xref="S4.E1.m1.1.1.cmml">
               →
              </mo>
              <mspace id="S4.E1.m1.3.3.1.1.1.1.1.3" width="1em" xref="S4.E1.m1.3.3.1.1.1.1.2.cmml">
              </mspace>
              <mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">
               ℳ
              </mi>
             </mrow>
            </mrow>
            <mo id="S4.E1.m1.3.3.1.1.2" lspace="0.278em" rspace="0.278em" xref="S4.E1.m1.3.3.1.1.2.cmml">
             :
            </mo>
            <mi id="S4.E1.m1.3.3.1.1.3" xref="S4.E1.m1.3.3.1.1.3.cmml">
            </mi>
           </mrow>
           <mspace id="S4.E1.m1.3.3.1.2" width="1em" xref="S4.E1.m1.3.3.1.1.cmml">
           </mspace>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E1.m1.3b">
           <apply id="S4.E1.m1.3.3.1.1.cmml" xref="S4.E1.m1.3.3.1">
            <ci id="S4.E1.m1.3.3.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.2">
             :
            </ci>
            <apply id="S4.E1.m1.3.3.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1">
             <eq id="S4.E1.m1.3.3.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.2">
             </eq>
             <ci id="S4.E1.m1.3.3.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.3">
              𝒟
             </ci>
             <list id="S4.E1.m1.3.3.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1">
              <set id="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1">
               <interval closure="open" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2">
                <apply id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">
                  𝐱
                 </ci>
                 <ci id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">
                  𝑖
                 </ci>
                </apply>
                <apply id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2">
                 <csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2">
                  subscript
                 </csymbol>
                 <apply id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2">
                  <csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2">
                   superscript
                  </csymbol>
                  <ci id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2">
                   𝐲
                  </ci>
                  <times id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3">
                  </times>
                 </apply>
                 <ci id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.3">
                  𝑖
                 </ci>
                </apply>
               </interval>
              </set>
              <ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">
               →
              </ci>
              <ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">
               ℳ
              </ci>
             </list>
            </apply>
            <csymbol cd="latexml" id="S4.E1.m1.3.3.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.3">
             absent
            </csymbol>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E1.m1.3c">
           \displaystyle\mathcal{D}=\{\left(\mathbf{x}_{i},\mathbf{y}^{*}_{i}\right)\}\leavevmode\nobreak\ \leavevmode\nobreak\ \rightarrow\leavevmode\nobreak\ \leavevmode\nobreak\ \mathcal{M}:\leavevmode\nobreak\ \leavevmode\nobreak\
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\rho(\mathbf{s}_{0})=\text{Unif}(\mathbf{x}_{1},\mathbf{x}_{2},\cdots,\mathbf{x}_{N})" class="ltx_Math" display="inline" id="S4.E1.m2.5">
         <semantics id="S4.E1.m2.5a">
          <mrow id="S4.E1.m2.5.5" xref="S4.E1.m2.5.5.cmml">
           <mrow id="S4.E1.m2.2.2.1" xref="S4.E1.m2.2.2.1.cmml">
            <mi id="S4.E1.m2.2.2.1.3" xref="S4.E1.m2.2.2.1.3.cmml">
             ρ
            </mi>
            <mo id="S4.E1.m2.2.2.1.2" lspace="0em" rspace="0em" xref="S4.E1.m2.2.2.1.2.cmml">
             ​
            </mo>
            <mrow id="S4.E1.m2.2.2.1.1.1" xref="S4.E1.m2.2.2.1.1.1.1.cmml">
             <mo id="S4.E1.m2.2.2.1.1.1.2" stretchy="false" xref="S4.E1.m2.2.2.1.1.1.1.cmml">
              (
             </mo>
             <msub id="S4.E1.m2.2.2.1.1.1.1" xref="S4.E1.m2.2.2.1.1.1.1.cmml">
              <mi id="S4.E1.m2.2.2.1.1.1.1.2" xref="S4.E1.m2.2.2.1.1.1.1.2.cmml">
               𝐬
              </mi>
              <mn id="S4.E1.m2.2.2.1.1.1.1.3" xref="S4.E1.m2.2.2.1.1.1.1.3.cmml">
               0
              </mn>
             </msub>
             <mo id="S4.E1.m2.2.2.1.1.1.3" stretchy="false" xref="S4.E1.m2.2.2.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S4.E1.m2.5.5.5" xref="S4.E1.m2.5.5.5.cmml">
            =
           </mo>
           <mrow id="S4.E1.m2.5.5.4" xref="S4.E1.m2.5.5.4.cmml">
            <mtext id="S4.E1.m2.5.5.4.5" xref="S4.E1.m2.5.5.4.5a.cmml">
             Unif
            </mtext>
            <mo id="S4.E1.m2.5.5.4.4" lspace="0em" rspace="0em" xref="S4.E1.m2.5.5.4.4.cmml">
             ​
            </mo>
            <mrow id="S4.E1.m2.5.5.4.3.3" xref="S4.E1.m2.5.5.4.3.4.cmml">
             <mo id="S4.E1.m2.5.5.4.3.3.4" stretchy="false" xref="S4.E1.m2.5.5.4.3.4.cmml">
              (
             </mo>
             <msub id="S4.E1.m2.3.3.2.1.1.1" xref="S4.E1.m2.3.3.2.1.1.1.cmml">
              <mi id="S4.E1.m2.3.3.2.1.1.1.2" xref="S4.E1.m2.3.3.2.1.1.1.2.cmml">
               𝐱
              </mi>
              <mn id="S4.E1.m2.3.3.2.1.1.1.3" xref="S4.E1.m2.3.3.2.1.1.1.3.cmml">
               1
              </mn>
             </msub>
             <mo id="S4.E1.m2.5.5.4.3.3.5" xref="S4.E1.m2.5.5.4.3.4.cmml">
              ,
             </mo>
             <msub id="S4.E1.m2.4.4.3.2.2.2" xref="S4.E1.m2.4.4.3.2.2.2.cmml">
              <mi id="S4.E1.m2.4.4.3.2.2.2.2" xref="S4.E1.m2.4.4.3.2.2.2.2.cmml">
               𝐱
              </mi>
              <mn id="S4.E1.m2.4.4.3.2.2.2.3" xref="S4.E1.m2.4.4.3.2.2.2.3.cmml">
               2
              </mn>
             </msub>
             <mo id="S4.E1.m2.5.5.4.3.3.6" xref="S4.E1.m2.5.5.4.3.4.cmml">
              ,
             </mo>
             <mi id="S4.E1.m2.1.1" mathvariant="normal" xref="S4.E1.m2.1.1.cmml">
              ⋯
             </mi>
             <mo id="S4.E1.m2.5.5.4.3.3.7" xref="S4.E1.m2.5.5.4.3.4.cmml">
              ,
             </mo>
             <msub id="S4.E1.m2.5.5.4.3.3.3" xref="S4.E1.m2.5.5.4.3.3.3.cmml">
              <mi id="S4.E1.m2.5.5.4.3.3.3.2" xref="S4.E1.m2.5.5.4.3.3.3.2.cmml">
               𝐱
              </mi>
              <mi id="S4.E1.m2.5.5.4.3.3.3.3" xref="S4.E1.m2.5.5.4.3.3.3.3.cmml">
               N
              </mi>
             </msub>
             <mo id="S4.E1.m2.5.5.4.3.3.8" stretchy="false" xref="S4.E1.m2.5.5.4.3.4.cmml">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E1.m2.5b">
           <apply id="S4.E1.m2.5.5.cmml" xref="S4.E1.m2.5.5">
            <eq id="S4.E1.m2.5.5.5.cmml" xref="S4.E1.m2.5.5.5">
            </eq>
            <apply id="S4.E1.m2.2.2.1.cmml" xref="S4.E1.m2.2.2.1">
             <times id="S4.E1.m2.2.2.1.2.cmml" xref="S4.E1.m2.2.2.1.2">
             </times>
             <ci id="S4.E1.m2.2.2.1.3.cmml" xref="S4.E1.m2.2.2.1.3">
              𝜌
             </ci>
             <apply id="S4.E1.m2.2.2.1.1.1.1.cmml" xref="S4.E1.m2.2.2.1.1.1">
              <csymbol cd="ambiguous" id="S4.E1.m2.2.2.1.1.1.1.1.cmml" xref="S4.E1.m2.2.2.1.1.1">
               subscript
              </csymbol>
              <ci id="S4.E1.m2.2.2.1.1.1.1.2.cmml" xref="S4.E1.m2.2.2.1.1.1.1.2">
               𝐬
              </ci>
              <cn id="S4.E1.m2.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.E1.m2.2.2.1.1.1.1.3">
               0
              </cn>
             </apply>
            </apply>
            <apply id="S4.E1.m2.5.5.4.cmml" xref="S4.E1.m2.5.5.4">
             <times id="S4.E1.m2.5.5.4.4.cmml" xref="S4.E1.m2.5.5.4.4">
             </times>
             <ci id="S4.E1.m2.5.5.4.5a.cmml" xref="S4.E1.m2.5.5.4.5">
              <mtext id="S4.E1.m2.5.5.4.5.cmml" xref="S4.E1.m2.5.5.4.5">
               Unif
              </mtext>
             </ci>
             <vector id="S4.E1.m2.5.5.4.3.4.cmml" xref="S4.E1.m2.5.5.4.3.3">
              <apply id="S4.E1.m2.3.3.2.1.1.1.cmml" xref="S4.E1.m2.3.3.2.1.1.1">
               <csymbol cd="ambiguous" id="S4.E1.m2.3.3.2.1.1.1.1.cmml" xref="S4.E1.m2.3.3.2.1.1.1">
                subscript
               </csymbol>
               <ci id="S4.E1.m2.3.3.2.1.1.1.2.cmml" xref="S4.E1.m2.3.3.2.1.1.1.2">
                𝐱
               </ci>
               <cn id="S4.E1.m2.3.3.2.1.1.1.3.cmml" type="integer" xref="S4.E1.m2.3.3.2.1.1.1.3">
                1
               </cn>
              </apply>
              <apply id="S4.E1.m2.4.4.3.2.2.2.cmml" xref="S4.E1.m2.4.4.3.2.2.2">
               <csymbol cd="ambiguous" id="S4.E1.m2.4.4.3.2.2.2.1.cmml" xref="S4.E1.m2.4.4.3.2.2.2">
                subscript
               </csymbol>
               <ci id="S4.E1.m2.4.4.3.2.2.2.2.cmml" xref="S4.E1.m2.4.4.3.2.2.2.2">
                𝐱
               </ci>
               <cn id="S4.E1.m2.4.4.3.2.2.2.3.cmml" type="integer" xref="S4.E1.m2.4.4.3.2.2.2.3">
                2
               </cn>
              </apply>
              <ci id="S4.E1.m2.1.1.cmml" xref="S4.E1.m2.1.1">
               ⋯
              </ci>
              <apply id="S4.E1.m2.5.5.4.3.3.3.cmml" xref="S4.E1.m2.5.5.4.3.3.3">
               <csymbol cd="ambiguous" id="S4.E1.m2.5.5.4.3.3.3.1.cmml" xref="S4.E1.m2.5.5.4.3.3.3">
                subscript
               </csymbol>
               <ci id="S4.E1.m2.5.5.4.3.3.3.2.cmml" xref="S4.E1.m2.5.5.4.3.3.3.2">
                𝐱
               </ci>
               <ci id="S4.E1.m2.5.5.4.3.3.3.3.cmml" xref="S4.E1.m2.5.5.4.3.3.3.3">
                𝑁
               </ci>
              </apply>
             </vector>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E1.m2.5c">
           \displaystyle\rho(\mathbf{s}_{0})=\text{Unif}(\mathbf{x}_{1},\mathbf{x}_{2},\cdots,\mathbf{x}_{N})
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_left_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (4.1)
        </span>
       </td>
      </tr>
     </tbody>
     <tbody id="S4.E2">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_left_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle P(\mathbf{s}^{\prime}|\mathbf{s},\mathbf{a})=\delta\left(\mathbf{s}^{\prime}=\text{concat}[\mathbf{s},\mathbf{a},\mathbf{f}]\right)" class="ltx_Math" display="inline" id="S4.E2.m1.7">
         <semantics id="S4.E2.m1.7a">
          <mrow id="S4.E2.m1.7.7" xref="S4.E2.m1.7.7.cmml">
           <mrow id="S4.E2.m1.6.6.1" xref="S4.E2.m1.6.6.1.cmml">
            <mi id="S4.E2.m1.6.6.1.3" xref="S4.E2.m1.6.6.1.3.cmml">
             P
            </mi>
            <mo id="S4.E2.m1.6.6.1.2" lspace="0em" rspace="0em" xref="S4.E2.m1.6.6.1.2.cmml">
             ​
            </mo>
            <mrow id="S4.E2.m1.6.6.1.1.1" xref="S4.E2.m1.6.6.1.1.1.1.cmml">
             <mo id="S4.E2.m1.6.6.1.1.1.2" stretchy="false" xref="S4.E2.m1.6.6.1.1.1.1.cmml">
              (
             </mo>
             <mrow id="S4.E2.m1.6.6.1.1.1.1" xref="S4.E2.m1.6.6.1.1.1.1.cmml">
              <msup id="S4.E2.m1.6.6.1.1.1.1.2" xref="S4.E2.m1.6.6.1.1.1.1.2.cmml">
               <mi id="S4.E2.m1.6.6.1.1.1.1.2.2" xref="S4.E2.m1.6.6.1.1.1.1.2.2.cmml">
                𝐬
               </mi>
               <mo id="S4.E2.m1.6.6.1.1.1.1.2.3" xref="S4.E2.m1.6.6.1.1.1.1.2.3.cmml">
                ′
               </mo>
              </msup>
              <mo fence="false" id="S4.E2.m1.6.6.1.1.1.1.1" xref="S4.E2.m1.6.6.1.1.1.1.1.cmml">
               |
              </mo>
              <mrow id="S4.E2.m1.6.6.1.1.1.1.3.2" xref="S4.E2.m1.6.6.1.1.1.1.3.1.cmml">
               <mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">
                𝐬
               </mi>
               <mo id="S4.E2.m1.6.6.1.1.1.1.3.2.1" xref="S4.E2.m1.6.6.1.1.1.1.3.1.cmml">
                ,
               </mo>
               <mi id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml">
                𝐚
               </mi>
              </mrow>
             </mrow>
             <mo id="S4.E2.m1.6.6.1.1.1.3" stretchy="false" xref="S4.E2.m1.6.6.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S4.E2.m1.7.7.3" xref="S4.E2.m1.7.7.3.cmml">
            =
           </mo>
           <mrow id="S4.E2.m1.7.7.2" xref="S4.E2.m1.7.7.2.cmml">
            <mi id="S4.E2.m1.7.7.2.3" xref="S4.E2.m1.7.7.2.3.cmml">
             δ
            </mi>
            <mo id="S4.E2.m1.7.7.2.2" lspace="0em" rspace="0em" xref="S4.E2.m1.7.7.2.2.cmml">
             ​
            </mo>
            <mrow id="S4.E2.m1.7.7.2.1.1" xref="S4.E2.m1.7.7.2.1.1.1.cmml">
             <mo id="S4.E2.m1.7.7.2.1.1.2" xref="S4.E2.m1.7.7.2.1.1.1.cmml">
              (
             </mo>
             <mrow id="S4.E2.m1.7.7.2.1.1.1" xref="S4.E2.m1.7.7.2.1.1.1.cmml">
              <msup id="S4.E2.m1.7.7.2.1.1.1.2" xref="S4.E2.m1.7.7.2.1.1.1.2.cmml">
               <mi id="S4.E2.m1.7.7.2.1.1.1.2.2" xref="S4.E2.m1.7.7.2.1.1.1.2.2.cmml">
                𝐬
               </mi>
               <mo id="S4.E2.m1.7.7.2.1.1.1.2.3" xref="S4.E2.m1.7.7.2.1.1.1.2.3.cmml">
                ′
               </mo>
              </msup>
              <mo id="S4.E2.m1.7.7.2.1.1.1.1" xref="S4.E2.m1.7.7.2.1.1.1.1.cmml">
               =
              </mo>
              <mrow id="S4.E2.m1.7.7.2.1.1.1.3" xref="S4.E2.m1.7.7.2.1.1.1.3.cmml">
               <mtext id="S4.E2.m1.7.7.2.1.1.1.3.2" xref="S4.E2.m1.7.7.2.1.1.1.3.2a.cmml">
                concat
               </mtext>
               <mo id="S4.E2.m1.7.7.2.1.1.1.3.1" lspace="0em" rspace="0em" xref="S4.E2.m1.7.7.2.1.1.1.3.1.cmml">
                ​
               </mo>
               <mrow id="S4.E2.m1.7.7.2.1.1.1.3.3.2" xref="S4.E2.m1.7.7.2.1.1.1.3.3.1.cmml">
                <mo id="S4.E2.m1.7.7.2.1.1.1.3.3.2.1" stretchy="false" xref="S4.E2.m1.7.7.2.1.1.1.3.3.1.cmml">
                 [
                </mo>
                <mi id="S4.E2.m1.3.3" xref="S4.E2.m1.3.3.cmml">
                 𝐬
                </mi>
                <mo id="S4.E2.m1.7.7.2.1.1.1.3.3.2.2" xref="S4.E2.m1.7.7.2.1.1.1.3.3.1.cmml">
                 ,
                </mo>
                <mi id="S4.E2.m1.4.4" xref="S4.E2.m1.4.4.cmml">
                 𝐚
                </mi>
                <mo id="S4.E2.m1.7.7.2.1.1.1.3.3.2.3" xref="S4.E2.m1.7.7.2.1.1.1.3.3.1.cmml">
                 ,
                </mo>
                <mi id="S4.E2.m1.5.5" xref="S4.E2.m1.5.5.cmml">
                 𝐟
                </mi>
                <mo id="S4.E2.m1.7.7.2.1.1.1.3.3.2.4" stretchy="false" xref="S4.E2.m1.7.7.2.1.1.1.3.3.1.cmml">
                 ]
                </mo>
               </mrow>
              </mrow>
             </mrow>
             <mo id="S4.E2.m1.7.7.2.1.1.3" xref="S4.E2.m1.7.7.2.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E2.m1.7b">
           <apply id="S4.E2.m1.7.7.cmml" xref="S4.E2.m1.7.7">
            <eq id="S4.E2.m1.7.7.3.cmml" xref="S4.E2.m1.7.7.3">
            </eq>
            <apply id="S4.E2.m1.6.6.1.cmml" xref="S4.E2.m1.6.6.1">
             <times id="S4.E2.m1.6.6.1.2.cmml" xref="S4.E2.m1.6.6.1.2">
             </times>
             <ci id="S4.E2.m1.6.6.1.3.cmml" xref="S4.E2.m1.6.6.1.3">
              𝑃
             </ci>
             <apply id="S4.E2.m1.6.6.1.1.1.1.cmml" xref="S4.E2.m1.6.6.1.1.1">
              <csymbol cd="latexml" id="S4.E2.m1.6.6.1.1.1.1.1.cmml" xref="S4.E2.m1.6.6.1.1.1.1.1">
               conditional
              </csymbol>
              <apply id="S4.E2.m1.6.6.1.1.1.1.2.cmml" xref="S4.E2.m1.6.6.1.1.1.1.2">
               <csymbol cd="ambiguous" id="S4.E2.m1.6.6.1.1.1.1.2.1.cmml" xref="S4.E2.m1.6.6.1.1.1.1.2">
                superscript
               </csymbol>
               <ci id="S4.E2.m1.6.6.1.1.1.1.2.2.cmml" xref="S4.E2.m1.6.6.1.1.1.1.2.2">
                𝐬
               </ci>
               <ci id="S4.E2.m1.6.6.1.1.1.1.2.3.cmml" xref="S4.E2.m1.6.6.1.1.1.1.2.3">
                ′
               </ci>
              </apply>
              <list id="S4.E2.m1.6.6.1.1.1.1.3.1.cmml" xref="S4.E2.m1.6.6.1.1.1.1.3.2">
               <ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">
                𝐬
               </ci>
               <ci id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2">
                𝐚
               </ci>
              </list>
             </apply>
            </apply>
            <apply id="S4.E2.m1.7.7.2.cmml" xref="S4.E2.m1.7.7.2">
             <times id="S4.E2.m1.7.7.2.2.cmml" xref="S4.E2.m1.7.7.2.2">
             </times>
             <ci id="S4.E2.m1.7.7.2.3.cmml" xref="S4.E2.m1.7.7.2.3">
              𝛿
             </ci>
             <apply id="S4.E2.m1.7.7.2.1.1.1.cmml" xref="S4.E2.m1.7.7.2.1.1">
              <eq id="S4.E2.m1.7.7.2.1.1.1.1.cmml" xref="S4.E2.m1.7.7.2.1.1.1.1">
              </eq>
              <apply id="S4.E2.m1.7.7.2.1.1.1.2.cmml" xref="S4.E2.m1.7.7.2.1.1.1.2">
               <csymbol cd="ambiguous" id="S4.E2.m1.7.7.2.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.2.1.1.1.2">
                superscript
               </csymbol>
               <ci id="S4.E2.m1.7.7.2.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.2.1.1.1.2.2">
                𝐬
               </ci>
               <ci id="S4.E2.m1.7.7.2.1.1.1.2.3.cmml" xref="S4.E2.m1.7.7.2.1.1.1.2.3">
                ′
               </ci>
              </apply>
              <apply id="S4.E2.m1.7.7.2.1.1.1.3.cmml" xref="S4.E2.m1.7.7.2.1.1.1.3">
               <times id="S4.E2.m1.7.7.2.1.1.1.3.1.cmml" xref="S4.E2.m1.7.7.2.1.1.1.3.1">
               </times>
               <ci id="S4.E2.m1.7.7.2.1.1.1.3.2a.cmml" xref="S4.E2.m1.7.7.2.1.1.1.3.2">
                <mtext id="S4.E2.m1.7.7.2.1.1.1.3.2.cmml" xref="S4.E2.m1.7.7.2.1.1.1.3.2">
                 concat
                </mtext>
               </ci>
               <list id="S4.E2.m1.7.7.2.1.1.1.3.3.1.cmml" xref="S4.E2.m1.7.7.2.1.1.1.3.3.2">
                <ci id="S4.E2.m1.3.3.cmml" xref="S4.E2.m1.3.3">
                 𝐬
                </ci>
                <ci id="S4.E2.m1.4.4.cmml" xref="S4.E2.m1.4.4">
                 𝐚
                </ci>
                <ci id="S4.E2.m1.5.5.cmml" xref="S4.E2.m1.5.5">
                 𝐟
                </ci>
               </list>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E2.m1.7c">
           \displaystyle P(\mathbf{s}^{\prime}|\mathbf{s},\mathbf{a})=\delta\left(\mathbf{s}^{\prime}=\text{concat}[\mathbf{s},\mathbf{a},\mathbf{f}]\right)
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_left_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (4.2)
        </span>
       </td>
      </tr>
     </tbody>
     <tbody id="S4.E3">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_left_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle r(\mathbf{s},\mathbf{a})=\mathbf{1}\left(\mathbf{a}=\mathbf{y}^{*}_{i}\text{\leavevmode\nobreak\ if\leavevmode\nobreak\ }\mathbf{x}_{i}\in\mathbf{s}\right)." class="ltx_Math" display="inline" id="S4.E3.m1.3">
         <semantics id="S4.E3.m1.3a">
          <mrow id="S4.E3.m1.3.3.1" xref="S4.E3.m1.3.3.1.1.cmml">
           <mrow id="S4.E3.m1.3.3.1.1" xref="S4.E3.m1.3.3.1.1.cmml">
            <mrow id="S4.E3.m1.3.3.1.1.3" xref="S4.E3.m1.3.3.1.1.3.cmml">
             <mi id="S4.E3.m1.3.3.1.1.3.2" xref="S4.E3.m1.3.3.1.1.3.2.cmml">
              r
             </mi>
             <mo id="S4.E3.m1.3.3.1.1.3.1" lspace="0em" rspace="0em" xref="S4.E3.m1.3.3.1.1.3.1.cmml">
              ​
             </mo>
             <mrow id="S4.E3.m1.3.3.1.1.3.3.2" xref="S4.E3.m1.3.3.1.1.3.3.1.cmml">
              <mo id="S4.E3.m1.3.3.1.1.3.3.2.1" stretchy="false" xref="S4.E3.m1.3.3.1.1.3.3.1.cmml">
               (
              </mo>
              <mi id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml">
               𝐬
              </mi>
              <mo id="S4.E3.m1.3.3.1.1.3.3.2.2" xref="S4.E3.m1.3.3.1.1.3.3.1.cmml">
               ,
              </mo>
              <mi id="S4.E3.m1.2.2" xref="S4.E3.m1.2.2.cmml">
               𝐚
              </mi>
              <mo id="S4.E3.m1.3.3.1.1.3.3.2.3" stretchy="false" xref="S4.E3.m1.3.3.1.1.3.3.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
            <mo id="S4.E3.m1.3.3.1.1.2" xref="S4.E3.m1.3.3.1.1.2.cmml">
             =
            </mo>
            <mrow id="S4.E3.m1.3.3.1.1.1" xref="S4.E3.m1.3.3.1.1.1.cmml">
             <mn id="S4.E3.m1.3.3.1.1.1.3" xref="S4.E3.m1.3.3.1.1.1.3.cmml">
              𝟏
             </mn>
             <mo id="S4.E3.m1.3.3.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E3.m1.3.3.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="S4.E3.m1.3.3.1.1.1.1.1" xref="S4.E3.m1.3.3.1.1.1.1.1.1.cmml">
              <mo id="S4.E3.m1.3.3.1.1.1.1.1.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="S4.E3.m1.3.3.1.1.1.1.1.1" xref="S4.E3.m1.3.3.1.1.1.1.1.1.cmml">
               <mi id="S4.E3.m1.3.3.1.1.1.1.1.1.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2.cmml">
                𝐚
               </mi>
               <mo id="S4.E3.m1.3.3.1.1.1.1.1.1.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.3.cmml">
                =
               </mo>
               <mrow id="S4.E3.m1.3.3.1.1.1.1.1.1.4" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.cmml">
                <msubsup id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.cmml">
                 <mi id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.2.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.2.2.cmml">
                  𝐲
                 </mi>
                 <mi id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.3.cmml">
                  i
                 </mi>
                 <mo id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.2.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.2.3.cmml">
                  ∗
                 </mo>
                </msubsup>
                <mo id="S4.E3.m1.3.3.1.1.1.1.1.1.4.1" lspace="0em" rspace="0em" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.1.cmml">
                 ​
                </mo>
                <mtext id="S4.E3.m1.3.3.1.1.1.1.1.1.4.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.3a.cmml">
                 if
                </mtext>
                <mo id="S4.E3.m1.3.3.1.1.1.1.1.1.4.1a" lspace="0em" rspace="0em" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.1.cmml">
                 ​
                </mo>
                <msub id="S4.E3.m1.3.3.1.1.1.1.1.1.4.4" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.4.cmml">
                 <mi id="S4.E3.m1.3.3.1.1.1.1.1.1.4.4.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.4.2.cmml">
                  𝐱
                 </mi>
                 <mi id="S4.E3.m1.3.3.1.1.1.1.1.1.4.4.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.4.3.cmml">
                  i
                 </mi>
                </msub>
               </mrow>
               <mo id="S4.E3.m1.3.3.1.1.1.1.1.1.5" xref="S4.E3.m1.3.3.1.1.1.1.1.1.5.cmml">
                ∈
               </mo>
               <mi id="S4.E3.m1.3.3.1.1.1.1.1.1.6" xref="S4.E3.m1.3.3.1.1.1.1.1.1.6.cmml">
                𝐬
               </mi>
              </mrow>
              <mo id="S4.E3.m1.3.3.1.1.1.1.1.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E3.m1.3.3.1.2" lspace="0em" xref="S4.E3.m1.3.3.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E3.m1.3b">
           <apply id="S4.E3.m1.3.3.1.1.cmml" xref="S4.E3.m1.3.3.1">
            <eq id="S4.E3.m1.3.3.1.1.2.cmml" xref="S4.E3.m1.3.3.1.1.2">
            </eq>
            <apply id="S4.E3.m1.3.3.1.1.3.cmml" xref="S4.E3.m1.3.3.1.1.3">
             <times id="S4.E3.m1.3.3.1.1.3.1.cmml" xref="S4.E3.m1.3.3.1.1.3.1">
             </times>
             <ci id="S4.E3.m1.3.3.1.1.3.2.cmml" xref="S4.E3.m1.3.3.1.1.3.2">
              𝑟
             </ci>
             <interval closure="open" id="S4.E3.m1.3.3.1.1.3.3.1.cmml" xref="S4.E3.m1.3.3.1.1.3.3.2">
              <ci id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1">
               𝐬
              </ci>
              <ci id="S4.E3.m1.2.2.cmml" xref="S4.E3.m1.2.2">
               𝐚
              </ci>
             </interval>
            </apply>
            <apply id="S4.E3.m1.3.3.1.1.1.cmml" xref="S4.E3.m1.3.3.1.1.1">
             <times id="S4.E3.m1.3.3.1.1.1.2.cmml" xref="S4.E3.m1.3.3.1.1.1.2">
             </times>
             <cn id="S4.E3.m1.3.3.1.1.1.3.cmml" type="integer" xref="S4.E3.m1.3.3.1.1.1.3">
              1
             </cn>
             <apply id="S4.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1">
              <and id="S4.E3.m1.3.3.1.1.1.1.1.1a.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1">
              </and>
              <apply id="S4.E3.m1.3.3.1.1.1.1.1.1b.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1">
               <eq id="S4.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.3">
               </eq>
               <ci id="S4.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.2">
                𝐚
               </ci>
               <apply id="S4.E3.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4">
                <times id="S4.E3.m1.3.3.1.1.1.1.1.1.4.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.1">
                </times>
                <apply id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2">
                 <csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2">
                  subscript
                 </csymbol>
                 <apply id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2">
                  <csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.2.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2">
                   superscript
                  </csymbol>
                  <ci id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.2.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.2.2">
                   𝐲
                  </ci>
                  <times id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.2.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.2.3">
                  </times>
                 </apply>
                 <ci id="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.2.3">
                  𝑖
                 </ci>
                </apply>
                <ci id="S4.E3.m1.3.3.1.1.1.1.1.1.4.3a.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.3">
                 <mtext id="S4.E3.m1.3.3.1.1.1.1.1.1.4.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.3">
                  if
                 </mtext>
                </ci>
                <apply id="S4.E3.m1.3.3.1.1.1.1.1.1.4.4.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.4">
                 <csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.1.1.1.1.4.4.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.4">
                  subscript
                 </csymbol>
                 <ci id="S4.E3.m1.3.3.1.1.1.1.1.1.4.4.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.4.2">
                  𝐱
                 </ci>
                 <ci id="S4.E3.m1.3.3.1.1.1.1.1.1.4.4.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.4.4.3">
                  𝑖
                 </ci>
                </apply>
               </apply>
              </apply>
              <apply id="S4.E3.m1.3.3.1.1.1.1.1.1c.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1">
               <in id="S4.E3.m1.3.3.1.1.1.1.1.1.5.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.5">
               </in>
               <share href="#S4.E3.m1.3.3.1.1.1.1.1.1.4.cmml" id="S4.E3.m1.3.3.1.1.1.1.1.1d.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1">
               </share>
               <ci id="S4.E3.m1.3.3.1.1.1.1.1.1.6.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.6">
                𝐬
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E3.m1.3c">
           \displaystyle r(\mathbf{s},\mathbf{a})=\mathbf{1}\left(\mathbf{a}=\mathbf{y}^{*}_{i}\text{\leavevmode\nobreak\ if\leavevmode\nobreak\ }\mathbf{x}_{i}\in\mathbf{s}\right).
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_left_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (4.3)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS2">
   <h4 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.2
    </span>
    Learning in the Multi-Turn MDP
   </h4>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p1">
    <p class="ltx_p" id="S4.SS2.p1.1">
     With the MDP construction in place, the next step involves training a model to improve itself over the course of a rollout. We subscribe to an offline approach to learning that we describe in the following.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p2">
    <p class="ltx_p" id="S4.SS2.p2.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">
      Step 1: Data collection for self-improvement.
     </span>
     To ensure that rollout data from this multi-turn MDP is useful for teaching the model how to self-improve, it must satisfy a few desiderata:
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.2">
      (1)
     </span>
     it must illustrate the mistakes that the learner is likely to make and showcase how to improve upon them in the next attempt,
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.3">
      (2)
     </span>
     the data must illustrate responses that are relevant to the model given the problem and previous attempts in context, and
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.4">
      (3)
     </span>
     it must not contain any rollout that degrades in a subsequent turn. Our data collection strategy (Figure
     <a class="ltx_ref" href="#S4.F2" title="Figure 2 ‣ 4 RISE: Recursive Introspection for Self-Improvement ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     , Right) satisfies these desiderata.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p3">
    <p class="ltx_p" id="S4.SS2.p3.8">
     In a given round
     <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1">
      <semantics id="S4.SS2.p3.1.m1.1a">
       <mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b">
        <ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">
        k
       </annotation>
      </semantics>
     </math>
     , for a given problem
     <math alttext="\mathbf{x}_{i}" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1">
      <semantics id="S4.SS2.p3.2.m2.1a">
       <msub id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">
        <mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">
         𝐱
        </mi>
        <mi id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b">
        <apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">
          𝐱
         </ci>
         <ci id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">
        \mathbf{x}_{i}
       </annotation>
      </semantics>
     </math>
     , we unroll the
     <em class="ltx_emph ltx_font_italic" id="S4.SS2.p3.8.1">
      current
     </em>
     model
     <math alttext="\pi_{\theta_{k}}(\cdot|\cdot)" class="ltx_math_unparsed" display="inline" id="S4.SS2.p3.3.m3.1">
      <semantics id="S4.SS2.p3.3.m3.1a">
       <mrow id="S4.SS2.p3.3.m3.1b">
        <msub id="S4.SS2.p3.3.m3.1.1">
         <mi id="S4.SS2.p3.3.m3.1.1.2">
          π
         </mi>
         <msub id="S4.SS2.p3.3.m3.1.1.3">
          <mi id="S4.SS2.p3.3.m3.1.1.3.2">
           θ
          </mi>
          <mi id="S4.SS2.p3.3.m3.1.1.3.3">
           k
          </mi>
         </msub>
        </msub>
        <mrow id="S4.SS2.p3.3.m3.1.2">
         <mo id="S4.SS2.p3.3.m3.1.2.1" stretchy="false">
          (
         </mo>
         <mo id="S4.SS2.p3.3.m3.1.2.2" lspace="0em" rspace="0em">
          ⋅
         </mo>
         <mo fence="false" id="S4.SS2.p3.3.m3.1.2.3" stretchy="false">
          |
         </mo>
         <mo id="S4.SS2.p3.3.m3.1.2.4" lspace="0em" rspace="0em">
          ⋅
         </mo>
         <mo id="S4.SS2.p3.3.m3.1.2.5" stretchy="false">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">
        \pi_{\theta_{k}}(\cdot|\cdot)
       </annotation>
      </semantics>
     </math>
     to produce multiple sequential attempts, denoted by
     <math alttext="\mathbf{y}^{i}_{t}\sim\pi_{\theta_{k}}(\cdot|\mathbf{s}^{i}_{t})" class="ltx_math_unparsed" display="inline" id="S4.SS2.p3.4.m4.1">
      <semantics id="S4.SS2.p3.4.m4.1a">
       <mrow id="S4.SS2.p3.4.m4.1b">
        <msubsup id="S4.SS2.p3.4.m4.1.1">
         <mi id="S4.SS2.p3.4.m4.1.1.2.2">
          𝐲
         </mi>
         <mi id="S4.SS2.p3.4.m4.1.1.3">
          t
         </mi>
         <mi id="S4.SS2.p3.4.m4.1.1.2.3">
          i
         </mi>
        </msubsup>
        <mo id="S4.SS2.p3.4.m4.1.2">
         ∼
        </mo>
        <msub id="S4.SS2.p3.4.m4.1.3">
         <mi id="S4.SS2.p3.4.m4.1.3.2">
          π
         </mi>
         <msub id="S4.SS2.p3.4.m4.1.3.3">
          <mi id="S4.SS2.p3.4.m4.1.3.3.2">
           θ
          </mi>
          <mi id="S4.SS2.p3.4.m4.1.3.3.3">
           k
          </mi>
         </msub>
        </msub>
        <mrow id="S4.SS2.p3.4.m4.1.4">
         <mo id="S4.SS2.p3.4.m4.1.4.1" stretchy="false">
          (
         </mo>
         <mo id="S4.SS2.p3.4.m4.1.4.2" lspace="0em" rspace="0em">
          ⋅
         </mo>
         <mo fence="false" id="S4.SS2.p3.4.m4.1.4.3" rspace="0.167em" stretchy="false">
          |
         </mo>
         <msubsup id="S4.SS2.p3.4.m4.1.4.4">
          <mi id="S4.SS2.p3.4.m4.1.4.4.2.2">
           𝐬
          </mi>
          <mi id="S4.SS2.p3.4.m4.1.4.4.3">
           t
          </mi>
          <mi id="S4.SS2.p3.4.m4.1.4.4.2.3">
           i
          </mi>
         </msubsup>
         <mo id="S4.SS2.p3.4.m4.1.4.5" stretchy="false">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">
        \mathbf{y}^{i}_{t}\sim\pi_{\theta_{k}}(\cdot|\mathbf{s}^{i}_{t})
       </annotation>
      </semantics>
     </math>
     . In problems, where external input (e.g., compiler feedback) is available, we also observe a variable-length, natural language external input,
     <math alttext="f_{t}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.1">
      <semantics id="S4.SS2.p3.5.m5.1a">
       <msubsup id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">
        <mi id="S4.SS2.p3.5.m5.1.1.2.2" xref="S4.SS2.p3.5.m5.1.1.2.2.cmml">
         f
        </mi>
        <mi id="S4.SS2.p3.5.m5.1.1.2.3" xref="S4.SS2.p3.5.m5.1.1.2.3.cmml">
         t
        </mi>
        <mi id="S4.SS2.p3.5.m5.1.1.3" xref="S4.SS2.p3.5.m5.1.1.3.cmml">
         i
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b">
        <apply id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">
          superscript
         </csymbol>
         <apply id="S4.SS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1">
          <csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.2.1.cmml" xref="S4.SS2.p3.5.m5.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS2.p3.5.m5.1.1.2.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2.2">
           𝑓
          </ci>
          <ci id="S4.SS2.p3.5.m5.1.1.2.3.cmml" xref="S4.SS2.p3.5.m5.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <ci id="S4.SS2.p3.5.m5.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">
        f_{t}^{i}
       </annotation>
      </semantics>
     </math>
     (e.g., in math problems we ask the model to correct itself). We also observe a scalar reward value
     <math alttext="r(\mathbf{s}^{i}_{t},\mathbf{y}^{i}_{t})" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m6.2">
      <semantics id="S4.SS2.p3.6.m6.2a">
       <mrow id="S4.SS2.p3.6.m6.2.2" xref="S4.SS2.p3.6.m6.2.2.cmml">
        <mi id="S4.SS2.p3.6.m6.2.2.4" xref="S4.SS2.p3.6.m6.2.2.4.cmml">
         r
        </mi>
        <mo id="S4.SS2.p3.6.m6.2.2.3" lspace="0em" rspace="0em" xref="S4.SS2.p3.6.m6.2.2.3.cmml">
         ​
        </mo>
        <mrow id="S4.SS2.p3.6.m6.2.2.2.2" xref="S4.SS2.p3.6.m6.2.2.2.3.cmml">
         <mo id="S4.SS2.p3.6.m6.2.2.2.2.3" stretchy="false" xref="S4.SS2.p3.6.m6.2.2.2.3.cmml">
          (
         </mo>
         <msubsup id="S4.SS2.p3.6.m6.1.1.1.1.1" xref="S4.SS2.p3.6.m6.1.1.1.1.1.cmml">
          <mi id="S4.SS2.p3.6.m6.1.1.1.1.1.2.2" xref="S4.SS2.p3.6.m6.1.1.1.1.1.2.2.cmml">
           𝐬
          </mi>
          <mi id="S4.SS2.p3.6.m6.1.1.1.1.1.3" xref="S4.SS2.p3.6.m6.1.1.1.1.1.3.cmml">
           t
          </mi>
          <mi id="S4.SS2.p3.6.m6.1.1.1.1.1.2.3" xref="S4.SS2.p3.6.m6.1.1.1.1.1.2.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="S4.SS2.p3.6.m6.2.2.2.2.4" xref="S4.SS2.p3.6.m6.2.2.2.3.cmml">
          ,
         </mo>
         <msubsup id="S4.SS2.p3.6.m6.2.2.2.2.2" xref="S4.SS2.p3.6.m6.2.2.2.2.2.cmml">
          <mi id="S4.SS2.p3.6.m6.2.2.2.2.2.2.2" xref="S4.SS2.p3.6.m6.2.2.2.2.2.2.2.cmml">
           𝐲
          </mi>
          <mi id="S4.SS2.p3.6.m6.2.2.2.2.2.3" xref="S4.SS2.p3.6.m6.2.2.2.2.2.3.cmml">
           t
          </mi>
          <mi id="S4.SS2.p3.6.m6.2.2.2.2.2.2.3" xref="S4.SS2.p3.6.m6.2.2.2.2.2.2.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="S4.SS2.p3.6.m6.2.2.2.2.5" stretchy="false" xref="S4.SS2.p3.6.m6.2.2.2.3.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.2b">
        <apply id="S4.SS2.p3.6.m6.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2">
         <times id="S4.SS2.p3.6.m6.2.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.3">
         </times>
         <ci id="S4.SS2.p3.6.m6.2.2.4.cmml" xref="S4.SS2.p3.6.m6.2.2.4">
          𝑟
         </ci>
         <interval closure="open" id="S4.SS2.p3.6.m6.2.2.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.2.2">
          <apply id="S4.SS2.p3.6.m6.1.1.1.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1.1.1.1">
            subscript
           </csymbol>
           <apply id="S4.SS2.p3.6.m6.1.1.1.1.1.2.cmml" xref="S4.SS2.p3.6.m6.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p3.6.m6.1.1.1.1.1">
             superscript
            </csymbol>
            <ci id="S4.SS2.p3.6.m6.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p3.6.m6.1.1.1.1.1.2.2">
             𝐬
            </ci>
            <ci id="S4.SS2.p3.6.m6.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p3.6.m6.1.1.1.1.1.2.3">
             𝑖
            </ci>
           </apply>
           <ci id="S4.SS2.p3.6.m6.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.6.m6.1.1.1.1.1.3">
            𝑡
           </ci>
          </apply>
          <apply id="S4.SS2.p3.6.m6.2.2.2.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.2.2.2">
           <csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.2.2.2.1.cmml" xref="S4.SS2.p3.6.m6.2.2.2.2.2">
            subscript
           </csymbol>
           <apply id="S4.SS2.p3.6.m6.2.2.2.2.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.2.2.2">
            <csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.2.2.2.2.1.cmml" xref="S4.SS2.p3.6.m6.2.2.2.2.2">
             superscript
            </csymbol>
            <ci id="S4.SS2.p3.6.m6.2.2.2.2.2.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.2.2.2.2.2">
             𝐲
            </ci>
            <ci id="S4.SS2.p3.6.m6.2.2.2.2.2.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.2.2.2.2.3">
             𝑖
            </ci>
           </apply>
           <ci id="S4.SS2.p3.6.m6.2.2.2.2.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.2.2.2.3">
            𝑡
           </ci>
          </apply>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.2c">
        r(\mathbf{s}^{i}_{t},\mathbf{y}^{i}_{t})
       </annotation>
      </semantics>
     </math>
     , denoted as
     <math alttext="r_{t}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p3.7.m7.1">
      <semantics id="S4.SS2.p3.7.m7.1a">
       <msubsup id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml">
        <mi id="S4.SS2.p3.7.m7.1.1.2.2" xref="S4.SS2.p3.7.m7.1.1.2.2.cmml">
         r
        </mi>
        <mi id="S4.SS2.p3.7.m7.1.1.2.3" xref="S4.SS2.p3.7.m7.1.1.2.3.cmml">
         t
        </mi>
        <mi id="S4.SS2.p3.7.m7.1.1.3" xref="S4.SS2.p3.7.m7.1.1.3.cmml">
         i
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.1b">
        <apply id="S4.SS2.p3.7.m7.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p3.7.m7.1.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1">
          superscript
         </csymbol>
         <apply id="S4.SS2.p3.7.m7.1.1.2.cmml" xref="S4.SS2.p3.7.m7.1.1">
          <csymbol cd="ambiguous" id="S4.SS2.p3.7.m7.1.1.2.1.cmml" xref="S4.SS2.p3.7.m7.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS2.p3.7.m7.1.1.2.2.cmml" xref="S4.SS2.p3.7.m7.1.1.2.2">
           𝑟
          </ci>
          <ci id="S4.SS2.p3.7.m7.1.1.2.3.cmml" xref="S4.SS2.p3.7.m7.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <ci id="S4.SS2.p3.7.m7.1.1.3.cmml" xref="S4.SS2.p3.7.m7.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.1c">
        r_{t}^{i}
       </annotation>
      </semantics>
     </math>
     in short. Let us denote this dataset of “on-policy” model rollouts as
     <math alttext="\mathcal{D}_{\text{on-policy}}:=\{(\mathbf{s}^{i}_{t},\mathbf{y}^{i}_{t},f^{i}_{t},r^{i}_{t})_{t=1}^{T}\}" class="ltx_Math" display="inline" id="S4.SS2.p3.8.m8.1">
      <semantics id="S4.SS2.p3.8.m8.1a">
       <mrow id="S4.SS2.p3.8.m8.1.1" xref="S4.SS2.p3.8.m8.1.1.cmml">
        <msub id="S4.SS2.p3.8.m8.1.1.3" xref="S4.SS2.p3.8.m8.1.1.3.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.8.m8.1.1.3.2" xref="S4.SS2.p3.8.m8.1.1.3.2.cmml">
          𝒟
         </mi>
         <mtext id="S4.SS2.p3.8.m8.1.1.3.3" xref="S4.SS2.p3.8.m8.1.1.3.3a.cmml">
          on-policy
         </mtext>
        </msub>
        <mo id="S4.SS2.p3.8.m8.1.1.2" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p3.8.m8.1.1.2.cmml">
         :=
        </mo>
        <mrow id="S4.SS2.p3.8.m8.1.1.1.1" xref="S4.SS2.p3.8.m8.1.1.1.2.cmml">
         <mo id="S4.SS2.p3.8.m8.1.1.1.1.2" stretchy="false" xref="S4.SS2.p3.8.m8.1.1.1.2.cmml">
          {
         </mo>
         <msubsup id="S4.SS2.p3.8.m8.1.1.1.1.1" xref="S4.SS2.p3.8.m8.1.1.1.1.1.cmml">
          <mrow id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.5.cmml">
           <mo id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.5" stretchy="false" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.5.cmml">
            (
           </mo>
           <msubsup id="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.cmml">
            <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.2.2" xref="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.2.2.cmml">
             𝐬
            </mi>
            <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.3.cmml">
             t
            </mi>
            <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.2.3" xref="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.2.3.cmml">
             i
            </mi>
           </msubsup>
           <mo id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.6" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.5.cmml">
            ,
           </mo>
           <msubsup id="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2" xref="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.cmml">
            <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.2.2" xref="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.2.2.cmml">
             𝐲
            </mi>
            <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.3" xref="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.3.cmml">
             t
            </mi>
            <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.2.3" xref="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.2.3.cmml">
             i
            </mi>
           </msubsup>
           <mo id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.7" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.5.cmml">
            ,
           </mo>
           <msubsup id="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3" xref="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.cmml">
            <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.2.2" xref="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.2.2.cmml">
             f
            </mi>
            <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.3" xref="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.3.cmml">
             t
            </mi>
            <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.2.3" xref="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.2.3.cmml">
             i
            </mi>
           </msubsup>
           <mo id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.8" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.5.cmml">
            ,
           </mo>
           <msubsup id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.cmml">
            <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.2.2" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.2.2.cmml">
             r
            </mi>
            <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.3" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.3.cmml">
             t
            </mi>
            <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.2.3" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.2.3.cmml">
             i
            </mi>
           </msubsup>
           <mo id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.9" stretchy="false" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.5.cmml">
            )
           </mo>
          </mrow>
          <mrow id="S4.SS2.p3.8.m8.1.1.1.1.1.4.6" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.cmml">
           <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.2" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.2.cmml">
            t
           </mi>
           <mo id="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.1" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.1.cmml">
            =
           </mo>
           <mn id="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.3" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.3.cmml">
            1
           </mn>
          </mrow>
          <mi id="S4.SS2.p3.8.m8.1.1.1.1.1.6" xref="S4.SS2.p3.8.m8.1.1.1.1.1.6.cmml">
           T
          </mi>
         </msubsup>
         <mo id="S4.SS2.p3.8.m8.1.1.1.1.3" stretchy="false" xref="S4.SS2.p3.8.m8.1.1.1.2.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m8.1b">
        <apply id="S4.SS2.p3.8.m8.1.1.cmml" xref="S4.SS2.p3.8.m8.1.1">
         <csymbol cd="latexml" id="S4.SS2.p3.8.m8.1.1.2.cmml" xref="S4.SS2.p3.8.m8.1.1.2">
          assign
         </csymbol>
         <apply id="S4.SS2.p3.8.m8.1.1.3.cmml" xref="S4.SS2.p3.8.m8.1.1.3">
          <csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.3.1.cmml" xref="S4.SS2.p3.8.m8.1.1.3">
           subscript
          </csymbol>
          <ci id="S4.SS2.p3.8.m8.1.1.3.2.cmml" xref="S4.SS2.p3.8.m8.1.1.3.2">
           𝒟
          </ci>
          <ci id="S4.SS2.p3.8.m8.1.1.3.3a.cmml" xref="S4.SS2.p3.8.m8.1.1.3.3">
           <mtext id="S4.SS2.p3.8.m8.1.1.3.3.cmml" mathsize="70%" xref="S4.SS2.p3.8.m8.1.1.3.3">
            on-policy
           </mtext>
          </ci>
         </apply>
         <set id="S4.SS2.p3.8.m8.1.1.1.2.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1">
          <apply id="S4.SS2.p3.8.m8.1.1.1.1.1.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.1.1.1.5.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1">
            superscript
           </csymbol>
           <apply id="S4.SS2.p3.8.m8.1.1.1.1.1.4.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.1.1.1.4.5.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1">
             subscript
            </csymbol>
            <vector id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.5.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4">
             <apply id="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1">
               subscript
              </csymbol>
              <apply id="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1">
                superscript
               </csymbol>
               <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.2.2">
                𝐬
               </ci>
               <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.2.3">
                𝑖
               </ci>
              </apply>
              <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2">
              <csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2">
               subscript
              </csymbol>
              <apply id="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2">
               <csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2">
                superscript
               </csymbol>
               <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.2.2">
                𝐲
               </ci>
               <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.2.3">
                𝑖
               </ci>
              </apply>
              <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.2.2.2.2.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3">
              <csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.1.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3">
               subscript
              </csymbol>
              <apply id="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.2.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3">
               <csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.2.1.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3">
                superscript
               </csymbol>
               <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.2.2.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.2.2">
                𝑓
               </ci>
               <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.2.3.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.2.3">
                𝑖
               </ci>
              </apply>
              <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.3.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.3.3.3.3.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4">
              <csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.1.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4">
               subscript
              </csymbol>
              <apply id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.2.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4">
               <csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.2.1.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4">
                superscript
               </csymbol>
               <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.2.2.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.2.2">
                𝑟
               </ci>
               <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.2.3.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.2.3">
                𝑖
               </ci>
              </apply>
              <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.3.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.4.4.4.3">
               𝑡
              </ci>
             </apply>
            </vector>
            <apply id="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.6">
             <eq id="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.1.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.1">
             </eq>
             <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.2.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.2">
              𝑡
             </ci>
             <cn id="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.3.cmml" type="integer" xref="S4.SS2.p3.8.m8.1.1.1.1.1.4.6.3">
              1
             </cn>
            </apply>
           </apply>
           <ci id="S4.SS2.p3.8.m8.1.1.1.1.1.6.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1.1.6">
            𝑇
           </ci>
          </apply>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.8.m8.1c">
        \mathcal{D}_{\text{on-policy}}:=\{(\mathbf{s}^{i}_{t},\mathbf{y}^{i}_{t},f^{i}_{t},r^{i}_{t})_{t=1}^{T}\}
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p4">
    <p class="ltx_p" id="S4.SS2.p4.8">
     For each time-step, we construct an improved version of the response
     <math alttext="\mathbf{y}^{i}_{t}" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1">
      <semantics id="S4.SS2.p4.1.m1.1a">
       <msubsup id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">
        <mi id="S4.SS2.p4.1.m1.1.1.2.2" xref="S4.SS2.p4.1.m1.1.1.2.2.cmml">
         𝐲
        </mi>
        <mi id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">
         t
        </mi>
        <mi id="S4.SS2.p4.1.m1.1.1.2.3" xref="S4.SS2.p4.1.m1.1.1.2.3.cmml">
         i
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b">
        <apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1">
          <csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.2.1.cmml" xref="S4.SS2.p4.1.m1.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS2.p4.1.m1.1.1.2.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2.2">
           𝐲
          </ci>
          <ci id="S4.SS2.p4.1.m1.1.1.2.3.cmml" xref="S4.SS2.p4.1.m1.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">
        \mathbf{y}^{i}_{t}
       </annotation>
      </semantics>
     </math>
     that we will denote by
     <math alttext="\tilde{\mathbf{y}}^{i}_{t}" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1">
      <semantics id="S4.SS2.p4.2.m2.1a">
       <msubsup id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">
        <mover accent="true" id="S4.SS2.p4.2.m2.1.1.2.2" xref="S4.SS2.p4.2.m2.1.1.2.2.cmml">
         <mi id="S4.SS2.p4.2.m2.1.1.2.2.2" mathcolor="#0000FF" xref="S4.SS2.p4.2.m2.1.1.2.2.2.cmml">
          𝐲
         </mi>
         <mo id="S4.SS2.p4.2.m2.1.1.2.2.1" mathcolor="#0000FF" xref="S4.SS2.p4.2.m2.1.1.2.2.1.cmml">
          ~
         </mo>
        </mover>
        <mi id="S4.SS2.p4.2.m2.1.1.3" mathcolor="#0000FF" xref="S4.SS2.p4.2.m2.1.1.3.cmml">
         t
        </mi>
        <mi id="S4.SS2.p4.2.m2.1.1.2.3" mathcolor="#0000FF" xref="S4.SS2.p4.2.m2.1.1.2.3.cmml">
         i
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b">
        <apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1">
          <csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.2.1.cmml" xref="S4.SS2.p4.2.m2.1.1">
           superscript
          </csymbol>
          <apply id="S4.SS2.p4.2.m2.1.1.2.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2.2">
           <ci id="S4.SS2.p4.2.m2.1.1.2.2.1.cmml" xref="S4.SS2.p4.2.m2.1.1.2.2.1">
            ~
           </ci>
           <ci id="S4.SS2.p4.2.m2.1.1.2.2.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2.2.2">
            𝐲
           </ci>
          </apply>
          <ci id="S4.SS2.p4.2.m2.1.1.2.3.cmml" xref="S4.SS2.p4.2.m2.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">
        \tilde{\mathbf{y}}^{i}_{t}
       </annotation>
      </semantics>
     </math>
     . We also record the reward score associated with this improved response as
     <math alttext="r(\mathbf{s}_{t}^{i},\tilde{\mathbf{y}}_{t}^{i})" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.2">
      <semantics id="S4.SS2.p4.3.m3.2a">
       <mrow id="S4.SS2.p4.3.m3.2.2" xref="S4.SS2.p4.3.m3.2.2.cmml">
        <mi id="S4.SS2.p4.3.m3.2.2.4" xref="S4.SS2.p4.3.m3.2.2.4.cmml">
         r
        </mi>
        <mo id="S4.SS2.p4.3.m3.2.2.3" lspace="0em" rspace="0em" xref="S4.SS2.p4.3.m3.2.2.3.cmml">
         ​
        </mo>
        <mrow id="S4.SS2.p4.3.m3.2.2.2.2" xref="S4.SS2.p4.3.m3.2.2.2.3.cmml">
         <mo id="S4.SS2.p4.3.m3.2.2.2.2.3" stretchy="false" xref="S4.SS2.p4.3.m3.2.2.2.3.cmml">
          (
         </mo>
         <msubsup id="S4.SS2.p4.3.m3.1.1.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.1.1.cmml">
          <mi id="S4.SS2.p4.3.m3.1.1.1.1.1.2.2" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.2.cmml">
           𝐬
          </mi>
          <mi id="S4.SS2.p4.3.m3.1.1.1.1.1.2.3" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.3.cmml">
           t
          </mi>
          <mi id="S4.SS2.p4.3.m3.1.1.1.1.1.3" xref="S4.SS2.p4.3.m3.1.1.1.1.1.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="S4.SS2.p4.3.m3.2.2.2.2.4" xref="S4.SS2.p4.3.m3.2.2.2.3.cmml">
          ,
         </mo>
         <msubsup id="S4.SS2.p4.3.m3.2.2.2.2.2" xref="S4.SS2.p4.3.m3.2.2.2.2.2.cmml">
          <mover accent="true" id="S4.SS2.p4.3.m3.2.2.2.2.2.2.2" xref="S4.SS2.p4.3.m3.2.2.2.2.2.2.2.cmml">
           <mi id="S4.SS2.p4.3.m3.2.2.2.2.2.2.2.2" xref="S4.SS2.p4.3.m3.2.2.2.2.2.2.2.2.cmml">
            𝐲
           </mi>
           <mo id="S4.SS2.p4.3.m3.2.2.2.2.2.2.2.1" xref="S4.SS2.p4.3.m3.2.2.2.2.2.2.2.1.cmml">
            ~
           </mo>
          </mover>
          <mi id="S4.SS2.p4.3.m3.2.2.2.2.2.2.3" xref="S4.SS2.p4.3.m3.2.2.2.2.2.2.3.cmml">
           t
          </mi>
          <mi id="S4.SS2.p4.3.m3.2.2.2.2.2.3" xref="S4.SS2.p4.3.m3.2.2.2.2.2.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="S4.SS2.p4.3.m3.2.2.2.2.5" stretchy="false" xref="S4.SS2.p4.3.m3.2.2.2.3.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.2b">
        <apply id="S4.SS2.p4.3.m3.2.2.cmml" xref="S4.SS2.p4.3.m3.2.2">
         <times id="S4.SS2.p4.3.m3.2.2.3.cmml" xref="S4.SS2.p4.3.m3.2.2.3">
         </times>
         <ci id="S4.SS2.p4.3.m3.2.2.4.cmml" xref="S4.SS2.p4.3.m3.2.2.4">
          𝑟
         </ci>
         <interval closure="open" id="S4.SS2.p4.3.m3.2.2.2.3.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2">
          <apply id="S4.SS2.p4.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1">
            superscript
           </csymbol>
           <apply id="S4.SS2.p4.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="S4.SS2.p4.3.m3.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.2">
             𝐬
            </ci>
            <ci id="S4.SS2.p4.3.m3.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.3">
             𝑡
            </ci>
           </apply>
           <ci id="S4.SS2.p4.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.3">
            𝑖
           </ci>
          </apply>
          <apply id="S4.SS2.p4.3.m3.2.2.2.2.2.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.2">
           <csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.2.2.2.2.2.1.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.2">
            superscript
           </csymbol>
           <apply id="S4.SS2.p4.3.m3.2.2.2.2.2.2.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.2">
            <csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.2.2.2.2.2.2.1.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.2">
             subscript
            </csymbol>
            <apply id="S4.SS2.p4.3.m3.2.2.2.2.2.2.2.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.2.2.2">
             <ci id="S4.SS2.p4.3.m3.2.2.2.2.2.2.2.1.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.2.2.2.1">
              ~
             </ci>
             <ci id="S4.SS2.p4.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.2.2.2.2">
              𝐲
             </ci>
            </apply>
            <ci id="S4.SS2.p4.3.m3.2.2.2.2.2.2.3.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.2.2.3">
             𝑡
            </ci>
           </apply>
           <ci id="S4.SS2.p4.3.m3.2.2.2.2.2.3.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.2.3">
            𝑖
           </ci>
          </apply>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.2c">
        r(\mathbf{s}_{t}^{i},\tilde{\mathbf{y}}_{t}^{i})
       </annotation>
      </semantics>
     </math>
     , or
     <math alttext="\tilde{r}_{t}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p4.4.m4.1">
      <semantics id="S4.SS2.p4.4.m4.1a">
       <msubsup id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml">
        <mover accent="true" id="S4.SS2.p4.4.m4.1.1.2.2" xref="S4.SS2.p4.4.m4.1.1.2.2.cmml">
         <mi id="S4.SS2.p4.4.m4.1.1.2.2.2" xref="S4.SS2.p4.4.m4.1.1.2.2.2.cmml">
          r
         </mi>
         <mo id="S4.SS2.p4.4.m4.1.1.2.2.1" xref="S4.SS2.p4.4.m4.1.1.2.2.1.cmml">
          ~
         </mo>
        </mover>
        <mi id="S4.SS2.p4.4.m4.1.1.2.3" xref="S4.SS2.p4.4.m4.1.1.2.3.cmml">
         t
        </mi>
        <mi id="S4.SS2.p4.4.m4.1.1.3" xref="S4.SS2.p4.4.m4.1.1.3.cmml">
         i
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b">
        <apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">
          superscript
         </csymbol>
         <apply id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1">
          <csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.1.1.2.1.cmml" xref="S4.SS2.p4.4.m4.1.1">
           subscript
          </csymbol>
          <apply id="S4.SS2.p4.4.m4.1.1.2.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2.2">
           <ci id="S4.SS2.p4.4.m4.1.1.2.2.1.cmml" xref="S4.SS2.p4.4.m4.1.1.2.2.1">
            ~
           </ci>
           <ci id="S4.SS2.p4.4.m4.1.1.2.2.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2.2.2">
            𝑟
           </ci>
          </apply>
          <ci id="S4.SS2.p4.4.m4.1.1.2.3.cmml" xref="S4.SS2.p4.4.m4.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <ci id="S4.SS2.p4.4.m4.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">
        \tilde{r}_{t}^{i}
       </annotation>
      </semantics>
     </math>
     in short. To obtain an improved version of a response
     <math alttext="\mathbf{y}^{i}_{t}" class="ltx_Math" display="inline" id="S4.SS2.p4.5.m5.1">
      <semantics id="S4.SS2.p4.5.m5.1a">
       <msubsup id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml">
        <mi id="S4.SS2.p4.5.m5.1.1.2.2" xref="S4.SS2.p4.5.m5.1.1.2.2.cmml">
         𝐲
        </mi>
        <mi id="S4.SS2.p4.5.m5.1.1.3" xref="S4.SS2.p4.5.m5.1.1.3.cmml">
         t
        </mi>
        <mi id="S4.SS2.p4.5.m5.1.1.2.3" xref="S4.SS2.p4.5.m5.1.1.2.3.cmml">
         i
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b">
        <apply id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p4.5.m5.1.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS2.p4.5.m5.1.1.2.cmml" xref="S4.SS2.p4.5.m5.1.1">
          <csymbol cd="ambiguous" id="S4.SS2.p4.5.m5.1.1.2.1.cmml" xref="S4.SS2.p4.5.m5.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS2.p4.5.m5.1.1.2.2.cmml" xref="S4.SS2.p4.5.m5.1.1.2.2">
           𝐲
          </ci>
          <ci id="S4.SS2.p4.5.m5.1.1.2.3.cmml" xref="S4.SS2.p4.5.m5.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S4.SS2.p4.5.m5.1.1.3.cmml" xref="S4.SS2.p4.5.m5.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">
        \mathbf{y}^{i}_{t}
       </annotation>
      </semantics>
     </math>
     , we can employ several strategies. Perhaps the most straightforward approach is to query an off-the-shelf more capable model to provide a correct response given the prompt
     <math alttext="\mathbf{x}_{i}" class="ltx_Math" display="inline" id="S4.SS2.p4.6.m6.1">
      <semantics id="S4.SS2.p4.6.m6.1a">
       <msub id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml">
        <mi id="S4.SS2.p4.6.m6.1.1.2" xref="S4.SS2.p4.6.m6.1.1.2.cmml">
         𝐱
        </mi>
        <mi id="S4.SS2.p4.6.m6.1.1.3" xref="S4.SS2.p4.6.m6.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b">
        <apply id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p4.6.m6.1.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p4.6.m6.1.1.2.cmml" xref="S4.SS2.p4.6.m6.1.1.2">
          𝐱
         </ci>
         <ci id="S4.SS2.p4.6.m6.1.1.3.cmml" xref="S4.SS2.p4.6.m6.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">
        \mathbf{x}_{i}
       </annotation>
      </semantics>
     </math>
     , the previous response
     <math alttext="\mathbf{y}^{i}_{t}" class="ltx_Math" display="inline" id="S4.SS2.p4.7.m7.1">
      <semantics id="S4.SS2.p4.7.m7.1a">
       <msubsup id="S4.SS2.p4.7.m7.1.1" xref="S4.SS2.p4.7.m7.1.1.cmml">
        <mi id="S4.SS2.p4.7.m7.1.1.2.2" xref="S4.SS2.p4.7.m7.1.1.2.2.cmml">
         𝐲
        </mi>
        <mi id="S4.SS2.p4.7.m7.1.1.3" xref="S4.SS2.p4.7.m7.1.1.3.cmml">
         t
        </mi>
        <mi id="S4.SS2.p4.7.m7.1.1.2.3" xref="S4.SS2.p4.7.m7.1.1.2.3.cmml">
         i
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.1b">
        <apply id="S4.SS2.p4.7.m7.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p4.7.m7.1.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS2.p4.7.m7.1.1.2.cmml" xref="S4.SS2.p4.7.m7.1.1">
          <csymbol cd="ambiguous" id="S4.SS2.p4.7.m7.1.1.2.1.cmml" xref="S4.SS2.p4.7.m7.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS2.p4.7.m7.1.1.2.2.cmml" xref="S4.SS2.p4.7.m7.1.1.2.2">
           𝐲
          </ci>
          <ci id="S4.SS2.p4.7.m7.1.1.2.3.cmml" xref="S4.SS2.p4.7.m7.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S4.SS2.p4.7.m7.1.1.3.cmml" xref="S4.SS2.p4.7.m7.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.1c">
        \mathbf{y}^{i}_{t}
       </annotation>
      </semantics>
     </math>
     , and an optional external feedback
     <math alttext="f^{i}_{t}" class="ltx_Math" display="inline" id="S4.SS2.p4.8.m8.1">
      <semantics id="S4.SS2.p4.8.m8.1a">
       <msubsup id="S4.SS2.p4.8.m8.1.1" xref="S4.SS2.p4.8.m8.1.1.cmml">
        <mi id="S4.SS2.p4.8.m8.1.1.2.2" xref="S4.SS2.p4.8.m8.1.1.2.2.cmml">
         f
        </mi>
        <mi id="S4.SS2.p4.8.m8.1.1.3" xref="S4.SS2.p4.8.m8.1.1.3.cmml">
         t
        </mi>
        <mi id="S4.SS2.p4.8.m8.1.1.2.3" xref="S4.SS2.p4.8.m8.1.1.2.3.cmml">
         i
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.8.m8.1b">
        <apply id="S4.SS2.p4.8.m8.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p4.8.m8.1.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS2.p4.8.m8.1.1.2.cmml" xref="S4.SS2.p4.8.m8.1.1">
          <csymbol cd="ambiguous" id="S4.SS2.p4.8.m8.1.1.2.1.cmml" xref="S4.SS2.p4.8.m8.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS2.p4.8.m8.1.1.2.2.cmml" xref="S4.SS2.p4.8.m8.1.1.2.2">
           𝑓
          </ci>
          <ci id="S4.SS2.p4.8.m8.1.1.2.3.cmml" xref="S4.SS2.p4.8.m8.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S4.SS2.p4.8.m8.1.1.3.cmml" xref="S4.SS2.p4.8.m8.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.8.m8.1c">
        f^{i}_{t}
       </annotation>
      </semantics>
     </math>
     . We refer to this as the
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p4.8.1">
      distillation
     </span>
     variant of our approach, since it uses a strong “teacher” model to guide self-improvement (note that this is different from the classic notion of knowledge distillation, and we will in fact show results in Section
     <a class="ltx_ref" href="#S6.SS1" title="6.1 Does RISE improve performance over multiple turns compared to other approaches? ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       6.1
      </span>
     </a>
     that will help understand the differences).
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx3">
     <tbody id="S4.E4">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_left_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\tilde{\mathcal{D}}_{\text{on-policy + distill}}:=\left\{\left\{\left(\mathbf{s}^{i}_{t},{\color[rgb]{0,0,1}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,1}\tilde{\mathbf{y}}^{i}_{t}},f^{i}_{t},{\color[rgb]{0,0,1}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,1}\tilde{r}^{i}_{t}}\right)\right\}_{t=1}^{T}\right\}_{i=1}^{|\mathcal{D}|}." class="ltx_Math" display="inline" id="S4.E4.m1.2">
         <semantics id="S4.E4.m1.2a">
          <mrow id="S4.E4.m1.2.2.1" xref="S4.E4.m1.2.2.1.1.cmml">
           <mrow id="S4.E4.m1.2.2.1.1" xref="S4.E4.m1.2.2.1.1.cmml">
            <msub id="S4.E4.m1.2.2.1.1.3" xref="S4.E4.m1.2.2.1.1.3.cmml">
             <mover accent="true" id="S4.E4.m1.2.2.1.1.3.2" xref="S4.E4.m1.2.2.1.1.3.2.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.2.2.1.1.3.2.2" xref="S4.E4.m1.2.2.1.1.3.2.2.cmml">
               𝒟
              </mi>
              <mo id="S4.E4.m1.2.2.1.1.3.2.1" xref="S4.E4.m1.2.2.1.1.3.2.1.cmml">
               ~
              </mo>
             </mover>
             <mtext id="S4.E4.m1.2.2.1.1.3.3" xref="S4.E4.m1.2.2.1.1.3.3a.cmml">
              on-policy + distill
             </mtext>
            </msub>
            <mo id="S4.E4.m1.2.2.1.1.2" lspace="0.278em" rspace="0.278em" xref="S4.E4.m1.2.2.1.1.2.cmml">
             :=
            </mo>
            <msubsup id="S4.E4.m1.2.2.1.1.1" xref="S4.E4.m1.2.2.1.1.1.cmml">
             <mrow id="S4.E4.m1.2.2.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.2.cmml">
              <mo id="S4.E4.m1.2.2.1.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.1.1.2.cmml">
               {
              </mo>
              <msubsup id="S4.E4.m1.2.2.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.cmml">
               <mrow id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">
                <mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">
                 {
                </mo>
                <mrow id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.5.cmml">
                 <mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.5" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.5.cmml">
                  (
                 </mo>
                 <msubsup id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">
                   𝐬
                  </mi>
                  <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                   t
                  </mi>
                  <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                   i
                  </mi>
                 </msubsup>
                 <mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.6" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.5.cmml">
                  ,
                 </mo>
                 <msubsup id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">
                  <mover accent="true" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">
                   <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" mathcolor="#0000FF" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">
                    𝐲
                   </mi>
                   <mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1" mathcolor="#0000FF" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml">
                    ~
                   </mo>
                  </mover>
                  <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3" mathcolor="#0000FF" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">
                   t
                  </mi>
                  <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" mathcolor="#0000FF" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">
                   i
                  </mi>
                 </msubsup>
                 <mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.7" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.5.cmml">
                  ,
                 </mo>
                 <msubsup id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                  <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">
                   f
                  </mi>
                  <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">
                   t
                  </mi>
                  <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">
                   i
                  </mi>
                 </msubsup>
                 <mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.8" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.5.cmml">
                  ,
                 </mo>
                 <msubsup id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.cmml">
                  <mover accent="true" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.cmml">
                   <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2" mathcolor="#0000FF" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2.cmml">
                    r
                   </mi>
                   <mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.1" mathcolor="#0000FF" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.1.cmml">
                    ~
                   </mo>
                  </mover>
                  <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.3" mathcolor="#0000FF" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.3.cmml">
                   t
                  </mi>
                  <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.3" mathcolor="#0000FF" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.3.cmml">
                   i
                  </mi>
                 </msubsup>
                 <mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.9" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.5.cmml">
                  )
                 </mo>
                </mrow>
                <mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">
                 }
                </mo>
               </mrow>
               <mrow id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">
                <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">
                 t
                </mi>
                <mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">
                 =
                </mo>
                <mn id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">
                 1
                </mn>
               </mrow>
               <mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.3.cmml">
                T
               </mi>
              </msubsup>
              <mo id="S4.E4.m1.2.2.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.2.cmml">
               }
              </mo>
             </mrow>
             <mrow id="S4.E4.m1.2.2.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.3.cmml">
              <mi id="S4.E4.m1.2.2.1.1.1.1.3.2" xref="S4.E4.m1.2.2.1.1.1.1.3.2.cmml">
               i
              </mi>
              <mo id="S4.E4.m1.2.2.1.1.1.1.3.1" xref="S4.E4.m1.2.2.1.1.1.1.3.1.cmml">
               =
              </mo>
              <mn id="S4.E4.m1.2.2.1.1.1.1.3.3" xref="S4.E4.m1.2.2.1.1.1.1.3.3.cmml">
               1
              </mn>
             </mrow>
             <mrow id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.1.1.1.2.cmml">
              <mo id="S4.E4.m1.1.1.1.3.1" stretchy="false" xref="S4.E4.m1.1.1.1.2.1.cmml">
               |
              </mo>
              <mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">
               𝒟
              </mi>
              <mo id="S4.E4.m1.1.1.1.3.2" stretchy="false" xref="S4.E4.m1.1.1.1.2.1.cmml">
               |
              </mo>
             </mrow>
            </msubsup>
           </mrow>
           <mo id="S4.E4.m1.2.2.1.2" lspace="0em" xref="S4.E4.m1.2.2.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E4.m1.2b">
           <apply id="S4.E4.m1.2.2.1.1.cmml" xref="S4.E4.m1.2.2.1">
            <csymbol cd="latexml" id="S4.E4.m1.2.2.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.2">
             assign
            </csymbol>
            <apply id="S4.E4.m1.2.2.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.3">
             <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.3.1.cmml" xref="S4.E4.m1.2.2.1.1.3">
              subscript
             </csymbol>
             <apply id="S4.E4.m1.2.2.1.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.3.2">
              <ci id="S4.E4.m1.2.2.1.1.3.2.1.cmml" xref="S4.E4.m1.2.2.1.1.3.2.1">
               ~
              </ci>
              <ci id="S4.E4.m1.2.2.1.1.3.2.2.cmml" xref="S4.E4.m1.2.2.1.1.3.2.2">
               𝒟
              </ci>
             </apply>
             <ci id="S4.E4.m1.2.2.1.1.3.3a.cmml" xref="S4.E4.m1.2.2.1.1.3.3">
              <mtext id="S4.E4.m1.2.2.1.1.3.3.cmml" mathsize="70%" xref="S4.E4.m1.2.2.1.1.3.3">
               on-policy + distill
              </mtext>
             </ci>
            </apply>
            <apply id="S4.E4.m1.2.2.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1">
             <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1">
              superscript
             </csymbol>
             <apply id="S4.E4.m1.2.2.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1">
              <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1">
               subscript
              </csymbol>
              <set id="S4.E4.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1">
               <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1">
                 superscript
                </csymbol>
                <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <set id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1">
                  <vector id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4">
                   <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">
                    <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">
                     subscript
                    </csymbol>
                    <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">
                     <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">
                      superscript
                     </csymbol>
                     <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">
                      𝐬
                     </ci>
                     <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">
                      𝑖
                     </ci>
                    </apply>
                    <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                     𝑡
                    </ci>
                   </apply>
                   <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">
                    <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">
                     subscript
                    </csymbol>
                    <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">
                     <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">
                      superscript
                     </csymbol>
                     <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">
                      <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1">
                       ~
                      </ci>
                      <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">
                       𝐲
                      </ci>
                     </apply>
                     <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">
                      𝑖
                     </ci>
                    </apply>
                    <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3">
                     𝑡
                    </ci>
                   </apply>
                   <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">
                    <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">
                     subscript
                    </csymbol>
                    <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">
                     <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">
                      superscript
                     </csymbol>
                     <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2">
                      𝑓
                     </ci>
                     <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3">
                      𝑖
                     </ci>
                    </apply>
                    <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.3">
                     𝑡
                    </ci>
                   </apply>
                   <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4">
                    <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4">
                     subscript
                    </csymbol>
                    <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4">
                     <csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4">
                      superscript
                     </csymbol>
                     <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2">
                      <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.1">
                       ~
                      </ci>
                      <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2">
                       𝑟
                      </ci>
                     </apply>
                     <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.2.3">
                      𝑖
                     </ci>
                    </apply>
                    <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.4.4.3">
                     𝑡
                    </ci>
                   </apply>
                  </vector>
                 </set>
                 <apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3">
                  <eq id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.1">
                  </eq>
                  <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.2">
                   𝑡
                  </ci>
                  <cn id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3.3">
                   1
                  </cn>
                 </apply>
                </apply>
                <ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.3">
                 𝑇
                </ci>
               </apply>
              </set>
              <apply id="S4.E4.m1.2.2.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.3">
               <eq id="S4.E4.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.3.1">
               </eq>
               <ci id="S4.E4.m1.2.2.1.1.1.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.3.2">
                𝑖
               </ci>
               <cn id="S4.E4.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S4.E4.m1.2.2.1.1.1.1.3.3">
                1
               </cn>
              </apply>
             </apply>
             <apply id="S4.E4.m1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.3">
              <abs id="S4.E4.m1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.3.1">
              </abs>
              <ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">
               𝒟
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E4.m1.2c">
           \displaystyle\tilde{\mathcal{D}}_{\text{on-policy + distill}}:=\left\{\left\{\left(\mathbf{s}^{i}_{t},{\color[rgb]{0,0,1}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,1}\tilde{\mathbf{y}}^{i}_{t}},f^{i}_{t},{\color[rgb]{0,0,1}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,1}\tilde{r}^{i}_{t}}\right)\right\}_{t=1}^{T}\right\}_{i=1}^{|\mathcal{D}|}.
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_left_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (4.4)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS2.p4.18">
     The second variant of our approach, which alleviates the need for a teacher model, involves constructing an improved response by sampling multiple times from the learner itself. We refer to this approach as the
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p4.18.1">
      self-distillation
     </span>
     variant. Concretely, for each state in the dataset,
     <math alttext="\mathbf{s}^{i}_{t}\in\mathcal{D}_{\text{on-policy}}" class="ltx_Math" display="inline" id="S4.SS2.p4.9.m1.1">
      <semantics id="S4.SS2.p4.9.m1.1a">
       <mrow id="S4.SS2.p4.9.m1.1.1" xref="S4.SS2.p4.9.m1.1.1.cmml">
        <msubsup id="S4.SS2.p4.9.m1.1.1.2" xref="S4.SS2.p4.9.m1.1.1.2.cmml">
         <mi id="S4.SS2.p4.9.m1.1.1.2.2.2" xref="S4.SS2.p4.9.m1.1.1.2.2.2.cmml">
          𝐬
         </mi>
         <mi id="S4.SS2.p4.9.m1.1.1.2.3" xref="S4.SS2.p4.9.m1.1.1.2.3.cmml">
          t
         </mi>
         <mi id="S4.SS2.p4.9.m1.1.1.2.2.3" xref="S4.SS2.p4.9.m1.1.1.2.2.3.cmml">
          i
         </mi>
        </msubsup>
        <mo id="S4.SS2.p4.9.m1.1.1.1" xref="S4.SS2.p4.9.m1.1.1.1.cmml">
         ∈
        </mo>
        <msub id="S4.SS2.p4.9.m1.1.1.3" xref="S4.SS2.p4.9.m1.1.1.3.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.9.m1.1.1.3.2" xref="S4.SS2.p4.9.m1.1.1.3.2.cmml">
          𝒟
         </mi>
         <mtext id="S4.SS2.p4.9.m1.1.1.3.3" xref="S4.SS2.p4.9.m1.1.1.3.3a.cmml">
          on-policy
         </mtext>
        </msub>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.9.m1.1b">
        <apply id="S4.SS2.p4.9.m1.1.1.cmml" xref="S4.SS2.p4.9.m1.1.1">
         <in id="S4.SS2.p4.9.m1.1.1.1.cmml" xref="S4.SS2.p4.9.m1.1.1.1">
         </in>
         <apply id="S4.SS2.p4.9.m1.1.1.2.cmml" xref="S4.SS2.p4.9.m1.1.1.2">
          <csymbol cd="ambiguous" id="S4.SS2.p4.9.m1.1.1.2.1.cmml" xref="S4.SS2.p4.9.m1.1.1.2">
           subscript
          </csymbol>
          <apply id="S4.SS2.p4.9.m1.1.1.2.2.cmml" xref="S4.SS2.p4.9.m1.1.1.2">
           <csymbol cd="ambiguous" id="S4.SS2.p4.9.m1.1.1.2.2.1.cmml" xref="S4.SS2.p4.9.m1.1.1.2">
            superscript
           </csymbol>
           <ci id="S4.SS2.p4.9.m1.1.1.2.2.2.cmml" xref="S4.SS2.p4.9.m1.1.1.2.2.2">
            𝐬
           </ci>
           <ci id="S4.SS2.p4.9.m1.1.1.2.2.3.cmml" xref="S4.SS2.p4.9.m1.1.1.2.2.3">
            𝑖
           </ci>
          </apply>
          <ci id="S4.SS2.p4.9.m1.1.1.2.3.cmml" xref="S4.SS2.p4.9.m1.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <apply id="S4.SS2.p4.9.m1.1.1.3.cmml" xref="S4.SS2.p4.9.m1.1.1.3">
          <csymbol cd="ambiguous" id="S4.SS2.p4.9.m1.1.1.3.1.cmml" xref="S4.SS2.p4.9.m1.1.1.3">
           subscript
          </csymbol>
          <ci id="S4.SS2.p4.9.m1.1.1.3.2.cmml" xref="S4.SS2.p4.9.m1.1.1.3.2">
           𝒟
          </ci>
          <ci id="S4.SS2.p4.9.m1.1.1.3.3a.cmml" xref="S4.SS2.p4.9.m1.1.1.3.3">
           <mtext id="S4.SS2.p4.9.m1.1.1.3.3.cmml" mathsize="70%" xref="S4.SS2.p4.9.m1.1.1.3.3">
            on-policy
           </mtext>
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.9.m1.1c">
        \mathbf{s}^{i}_{t}\in\mathcal{D}_{\text{on-policy}}
       </annotation>
      </semantics>
     </math>
     , we sample
     <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.p4.10.m2.1">
      <semantics id="S4.SS2.p4.10.m2.1a">
       <mi id="S4.SS2.p4.10.m2.1.1" xref="S4.SS2.p4.10.m2.1.1.cmml">
        N
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.10.m2.1b">
        <ci id="S4.SS2.p4.10.m2.1.1.cmml" xref="S4.SS2.p4.10.m2.1.1">
         𝑁
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.10.m2.1c">
        N
       </annotation>
      </semantics>
     </math>
     responses
     <math alttext="\tilde{\mathbf{y}}^{i}_{t}[0],\tilde{\mathbf{y}}^{i}_{t}[1],\cdots,\tilde{\mathbf{y}}^{i}_{t}[N]\sim\pi_{\theta}(\cdot|\mathbf{s}^{i}_{t})" class="ltx_math_unparsed" display="inline" id="S4.SS2.p4.11.m3.4">
      <semantics id="S4.SS2.p4.11.m3.4a">
       <mrow id="S4.SS2.p4.11.m3.4b">
        <msubsup id="S4.SS2.p4.11.m3.4.5">
         <mover accent="true" id="S4.SS2.p4.11.m3.4.5.2.2">
          <mi id="S4.SS2.p4.11.m3.4.5.2.2.2">
           𝐲
          </mi>
          <mo id="S4.SS2.p4.11.m3.4.5.2.2.1">
           ~
          </mo>
         </mover>
         <mi id="S4.SS2.p4.11.m3.4.5.3">
          t
         </mi>
         <mi id="S4.SS2.p4.11.m3.4.5.2.3">
          i
         </mi>
        </msubsup>
        <mrow id="S4.SS2.p4.11.m3.4.6">
         <mo id="S4.SS2.p4.11.m3.4.6.1" stretchy="false">
          [
         </mo>
         <mn id="S4.SS2.p4.11.m3.1.1">
          0
         </mn>
         <mo id="S4.SS2.p4.11.m3.4.6.2" stretchy="false">
          ]
         </mo>
        </mrow>
        <mo id="S4.SS2.p4.11.m3.4.7">
         ,
        </mo>
        <msubsup id="S4.SS2.p4.11.m3.4.8">
         <mover accent="true" id="S4.SS2.p4.11.m3.4.8.2.2">
          <mi id="S4.SS2.p4.11.m3.4.8.2.2.2">
           𝐲
          </mi>
          <mo id="S4.SS2.p4.11.m3.4.8.2.2.1">
           ~
          </mo>
         </mover>
         <mi id="S4.SS2.p4.11.m3.4.8.3">
          t
         </mi>
         <mi id="S4.SS2.p4.11.m3.4.8.2.3">
          i
         </mi>
        </msubsup>
        <mrow id="S4.SS2.p4.11.m3.4.9">
         <mo id="S4.SS2.p4.11.m3.4.9.1" stretchy="false">
          [
         </mo>
         <mn id="S4.SS2.p4.11.m3.2.2">
          1
         </mn>
         <mo id="S4.SS2.p4.11.m3.4.9.2" stretchy="false">
          ]
         </mo>
        </mrow>
        <mo id="S4.SS2.p4.11.m3.4.10">
         ,
        </mo>
        <mi id="S4.SS2.p4.11.m3.4.4" mathvariant="normal">
         ⋯
        </mi>
        <mo id="S4.SS2.p4.11.m3.4.11">
         ,
        </mo>
        <msubsup id="S4.SS2.p4.11.m3.4.12">
         <mover accent="true" id="S4.SS2.p4.11.m3.4.12.2.2">
          <mi id="S4.SS2.p4.11.m3.4.12.2.2.2">
           𝐲
          </mi>
          <mo id="S4.SS2.p4.11.m3.4.12.2.2.1">
           ~
          </mo>
         </mover>
         <mi id="S4.SS2.p4.11.m3.4.12.3">
          t
         </mi>
         <mi id="S4.SS2.p4.11.m3.4.12.2.3">
          i
         </mi>
        </msubsup>
        <mrow id="S4.SS2.p4.11.m3.4.13">
         <mo id="S4.SS2.p4.11.m3.4.13.1" stretchy="false">
          [
         </mo>
         <mi id="S4.SS2.p4.11.m3.3.3">
          N
         </mi>
         <mo id="S4.SS2.p4.11.m3.4.13.2" stretchy="false">
          ]
         </mo>
        </mrow>
        <mo id="S4.SS2.p4.11.m3.4.14">
         ∼
        </mo>
        <msub id="S4.SS2.p4.11.m3.4.15">
         <mi id="S4.SS2.p4.11.m3.4.15.2">
          π
         </mi>
         <mi id="S4.SS2.p4.11.m3.4.15.3">
          θ
         </mi>
        </msub>
        <mrow id="S4.SS2.p4.11.m3.4.16">
         <mo id="S4.SS2.p4.11.m3.4.16.1" stretchy="false">
          (
         </mo>
         <mo id="S4.SS2.p4.11.m3.4.16.2" lspace="0em" rspace="0em">
          ⋅
         </mo>
         <mo fence="false" id="S4.SS2.p4.11.m3.4.16.3" rspace="0.167em" stretchy="false">
          |
         </mo>
         <msubsup id="S4.SS2.p4.11.m3.4.16.4">
          <mi id="S4.SS2.p4.11.m3.4.16.4.2.2">
           𝐬
          </mi>
          <mi id="S4.SS2.p4.11.m3.4.16.4.3">
           t
          </mi>
          <mi id="S4.SS2.p4.11.m3.4.16.4.2.3">
           i
          </mi>
         </msubsup>
         <mo id="S4.SS2.p4.11.m3.4.16.5" stretchy="false">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.11.m3.4c">
        \tilde{\mathbf{y}}^{i}_{t}[0],\tilde{\mathbf{y}}^{i}_{t}[1],\cdots,\tilde{\mathbf{y}}^{i}_{t}[N]\sim\pi_{\theta}(\cdot|\mathbf{s}^{i}_{t})
       </annotation>
      </semantics>
     </math>
     , and use the best response from these
     <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.p4.12.m4.1">
      <semantics id="S4.SS2.p4.12.m4.1a">
       <mi id="S4.SS2.p4.12.m4.1.1" xref="S4.SS2.p4.12.m4.1.1.cmml">
        N
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.12.m4.1b">
        <ci id="S4.SS2.p4.12.m4.1.1.cmml" xref="S4.SS2.p4.12.m4.1.1">
         𝑁
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.12.m4.1c">
        N
       </annotation>
      </semantics>
     </math>
     candidates (as measured by the associated reward values
     <math alttext="\tilde{r}_{t}^{i}[0],\cdots,\tilde{r}_{t}^{i}[N]" class="ltx_Math" display="inline" id="S4.SS2.p4.13.m5.5">
      <semantics id="S4.SS2.p4.13.m5.5a">
       <mrow id="S4.SS2.p4.13.m5.5.5.2" xref="S4.SS2.p4.13.m5.5.5.3.cmml">
        <mrow id="S4.SS2.p4.13.m5.4.4.1.1" xref="S4.SS2.p4.13.m5.4.4.1.1.cmml">
         <msubsup id="S4.SS2.p4.13.m5.4.4.1.1.2" xref="S4.SS2.p4.13.m5.4.4.1.1.2.cmml">
          <mover accent="true" id="S4.SS2.p4.13.m5.4.4.1.1.2.2.2" xref="S4.SS2.p4.13.m5.4.4.1.1.2.2.2.cmml">
           <mi id="S4.SS2.p4.13.m5.4.4.1.1.2.2.2.2" xref="S4.SS2.p4.13.m5.4.4.1.1.2.2.2.2.cmml">
            r
           </mi>
           <mo id="S4.SS2.p4.13.m5.4.4.1.1.2.2.2.1" xref="S4.SS2.p4.13.m5.4.4.1.1.2.2.2.1.cmml">
            ~
           </mo>
          </mover>
          <mi id="S4.SS2.p4.13.m5.4.4.1.1.2.2.3" xref="S4.SS2.p4.13.m5.4.4.1.1.2.2.3.cmml">
           t
          </mi>
          <mi id="S4.SS2.p4.13.m5.4.4.1.1.2.3" xref="S4.SS2.p4.13.m5.4.4.1.1.2.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="S4.SS2.p4.13.m5.4.4.1.1.1" lspace="0em" rspace="0em" xref="S4.SS2.p4.13.m5.4.4.1.1.1.cmml">
          ​
         </mo>
         <mrow id="S4.SS2.p4.13.m5.4.4.1.1.3.2" xref="S4.SS2.p4.13.m5.4.4.1.1.3.1.cmml">
          <mo id="S4.SS2.p4.13.m5.4.4.1.1.3.2.1" stretchy="false" xref="S4.SS2.p4.13.m5.4.4.1.1.3.1.1.cmml">
           [
          </mo>
          <mn id="S4.SS2.p4.13.m5.1.1" xref="S4.SS2.p4.13.m5.1.1.cmml">
           0
          </mn>
          <mo id="S4.SS2.p4.13.m5.4.4.1.1.3.2.2" stretchy="false" xref="S4.SS2.p4.13.m5.4.4.1.1.3.1.1.cmml">
           ]
          </mo>
         </mrow>
        </mrow>
        <mo id="S4.SS2.p4.13.m5.5.5.2.3" xref="S4.SS2.p4.13.m5.5.5.3.cmml">
         ,
        </mo>
        <mi id="S4.SS2.p4.13.m5.3.3" mathvariant="normal" xref="S4.SS2.p4.13.m5.3.3.cmml">
         ⋯
        </mi>
        <mo id="S4.SS2.p4.13.m5.5.5.2.4" xref="S4.SS2.p4.13.m5.5.5.3.cmml">
         ,
        </mo>
        <mrow id="S4.SS2.p4.13.m5.5.5.2.2" xref="S4.SS2.p4.13.m5.5.5.2.2.cmml">
         <msubsup id="S4.SS2.p4.13.m5.5.5.2.2.2" xref="S4.SS2.p4.13.m5.5.5.2.2.2.cmml">
          <mover accent="true" id="S4.SS2.p4.13.m5.5.5.2.2.2.2.2" xref="S4.SS2.p4.13.m5.5.5.2.2.2.2.2.cmml">
           <mi id="S4.SS2.p4.13.m5.5.5.2.2.2.2.2.2" xref="S4.SS2.p4.13.m5.5.5.2.2.2.2.2.2.cmml">
            r
           </mi>
           <mo id="S4.SS2.p4.13.m5.5.5.2.2.2.2.2.1" xref="S4.SS2.p4.13.m5.5.5.2.2.2.2.2.1.cmml">
            ~
           </mo>
          </mover>
          <mi id="S4.SS2.p4.13.m5.5.5.2.2.2.2.3" xref="S4.SS2.p4.13.m5.5.5.2.2.2.2.3.cmml">
           t
          </mi>
          <mi id="S4.SS2.p4.13.m5.5.5.2.2.2.3" xref="S4.SS2.p4.13.m5.5.5.2.2.2.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="S4.SS2.p4.13.m5.5.5.2.2.1" lspace="0em" rspace="0em" xref="S4.SS2.p4.13.m5.5.5.2.2.1.cmml">
          ​
         </mo>
         <mrow id="S4.SS2.p4.13.m5.5.5.2.2.3.2" xref="S4.SS2.p4.13.m5.5.5.2.2.3.1.cmml">
          <mo id="S4.SS2.p4.13.m5.5.5.2.2.3.2.1" stretchy="false" xref="S4.SS2.p4.13.m5.5.5.2.2.3.1.1.cmml">
           [
          </mo>
          <mi id="S4.SS2.p4.13.m5.2.2" xref="S4.SS2.p4.13.m5.2.2.cmml">
           N
          </mi>
          <mo id="S4.SS2.p4.13.m5.5.5.2.2.3.2.2" stretchy="false" xref="S4.SS2.p4.13.m5.5.5.2.2.3.1.1.cmml">
           ]
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.13.m5.5b">
        <list id="S4.SS2.p4.13.m5.5.5.3.cmml" xref="S4.SS2.p4.13.m5.5.5.2">
         <apply id="S4.SS2.p4.13.m5.4.4.1.1.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1">
          <times id="S4.SS2.p4.13.m5.4.4.1.1.1.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1.1">
          </times>
          <apply id="S4.SS2.p4.13.m5.4.4.1.1.2.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1.2">
           <csymbol cd="ambiguous" id="S4.SS2.p4.13.m5.4.4.1.1.2.1.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1.2">
            superscript
           </csymbol>
           <apply id="S4.SS2.p4.13.m5.4.4.1.1.2.2.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1.2">
            <csymbol cd="ambiguous" id="S4.SS2.p4.13.m5.4.4.1.1.2.2.1.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1.2">
             subscript
            </csymbol>
            <apply id="S4.SS2.p4.13.m5.4.4.1.1.2.2.2.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1.2.2.2">
             <ci id="S4.SS2.p4.13.m5.4.4.1.1.2.2.2.1.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1.2.2.2.1">
              ~
             </ci>
             <ci id="S4.SS2.p4.13.m5.4.4.1.1.2.2.2.2.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1.2.2.2.2">
              𝑟
             </ci>
            </apply>
            <ci id="S4.SS2.p4.13.m5.4.4.1.1.2.2.3.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1.2.2.3">
             𝑡
            </ci>
           </apply>
           <ci id="S4.SS2.p4.13.m5.4.4.1.1.2.3.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <apply id="S4.SS2.p4.13.m5.4.4.1.1.3.1.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1.3.2">
           <csymbol cd="latexml" id="S4.SS2.p4.13.m5.4.4.1.1.3.1.1.cmml" xref="S4.SS2.p4.13.m5.4.4.1.1.3.2.1">
            delimited-[]
           </csymbol>
           <cn id="S4.SS2.p4.13.m5.1.1.cmml" type="integer" xref="S4.SS2.p4.13.m5.1.1">
            0
           </cn>
          </apply>
         </apply>
         <ci id="S4.SS2.p4.13.m5.3.3.cmml" xref="S4.SS2.p4.13.m5.3.3">
          ⋯
         </ci>
         <apply id="S4.SS2.p4.13.m5.5.5.2.2.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2">
          <times id="S4.SS2.p4.13.m5.5.5.2.2.1.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2.1">
          </times>
          <apply id="S4.SS2.p4.13.m5.5.5.2.2.2.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2.2">
           <csymbol cd="ambiguous" id="S4.SS2.p4.13.m5.5.5.2.2.2.1.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2.2">
            superscript
           </csymbol>
           <apply id="S4.SS2.p4.13.m5.5.5.2.2.2.2.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2.2">
            <csymbol cd="ambiguous" id="S4.SS2.p4.13.m5.5.5.2.2.2.2.1.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2.2">
             subscript
            </csymbol>
            <apply id="S4.SS2.p4.13.m5.5.5.2.2.2.2.2.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2.2.2.2">
             <ci id="S4.SS2.p4.13.m5.5.5.2.2.2.2.2.1.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2.2.2.2.1">
              ~
             </ci>
             <ci id="S4.SS2.p4.13.m5.5.5.2.2.2.2.2.2.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2.2.2.2.2">
              𝑟
             </ci>
            </apply>
            <ci id="S4.SS2.p4.13.m5.5.5.2.2.2.2.3.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2.2.2.3">
             𝑡
            </ci>
           </apply>
           <ci id="S4.SS2.p4.13.m5.5.5.2.2.2.3.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2.2.3">
            𝑖
           </ci>
          </apply>
          <apply id="S4.SS2.p4.13.m5.5.5.2.2.3.1.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2.3.2">
           <csymbol cd="latexml" id="S4.SS2.p4.13.m5.5.5.2.2.3.1.1.cmml" xref="S4.SS2.p4.13.m5.5.5.2.2.3.2.1">
            delimited-[]
           </csymbol>
           <ci id="S4.SS2.p4.13.m5.2.2.cmml" xref="S4.SS2.p4.13.m5.2.2">
            𝑁
           </ci>
          </apply>
         </apply>
        </list>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.13.m5.5c">
        \tilde{r}_{t}^{i}[0],\cdots,\tilde{r}_{t}^{i}[N]
       </annotation>
      </semantics>
     </math>
     ) to relabel the model response at the next step
     <math alttext="t+1" class="ltx_Math" display="inline" id="S4.SS2.p4.14.m6.1">
      <semantics id="S4.SS2.p4.14.m6.1a">
       <mrow id="S4.SS2.p4.14.m6.1.1" xref="S4.SS2.p4.14.m6.1.1.cmml">
        <mi id="S4.SS2.p4.14.m6.1.1.2" xref="S4.SS2.p4.14.m6.1.1.2.cmml">
         t
        </mi>
        <mo id="S4.SS2.p4.14.m6.1.1.1" xref="S4.SS2.p4.14.m6.1.1.1.cmml">
         +
        </mo>
        <mn id="S4.SS2.p4.14.m6.1.1.3" xref="S4.SS2.p4.14.m6.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.14.m6.1b">
        <apply id="S4.SS2.p4.14.m6.1.1.cmml" xref="S4.SS2.p4.14.m6.1.1">
         <plus id="S4.SS2.p4.14.m6.1.1.1.cmml" xref="S4.SS2.p4.14.m6.1.1.1">
         </plus>
         <ci id="S4.SS2.p4.14.m6.1.1.2.cmml" xref="S4.SS2.p4.14.m6.1.1.2">
          𝑡
         </ci>
         <cn id="S4.SS2.p4.14.m6.1.1.3.cmml" type="integer" xref="S4.SS2.p4.14.m6.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.14.m6.1c">
        t+1
       </annotation>
      </semantics>
     </math>
     in an improvement trajectory. Formally, say
     <math alttext="\tilde{\mathbf{y}}^{i}_{t}[m]=\arg\max_{j\in[N]}r(\mathbf{s}_{i},\tilde{\mathbf{y}}^{i}_{t}[j])" class="ltx_Math" display="inline" id="S4.SS2.p4.15.m7.5">
      <semantics id="S4.SS2.p4.15.m7.5a">
       <mrow id="S4.SS2.p4.15.m7.5.5" xref="S4.SS2.p4.15.m7.5.5.cmml">
        <mrow id="S4.SS2.p4.15.m7.5.5.4" xref="S4.SS2.p4.15.m7.5.5.4.cmml">
         <msubsup id="S4.SS2.p4.15.m7.5.5.4.2" xref="S4.SS2.p4.15.m7.5.5.4.2.cmml">
          <mover accent="true" id="S4.SS2.p4.15.m7.5.5.4.2.2.2" xref="S4.SS2.p4.15.m7.5.5.4.2.2.2.cmml">
           <mi id="S4.SS2.p4.15.m7.5.5.4.2.2.2.2" xref="S4.SS2.p4.15.m7.5.5.4.2.2.2.2.cmml">
            𝐲
           </mi>
           <mo id="S4.SS2.p4.15.m7.5.5.4.2.2.2.1" xref="S4.SS2.p4.15.m7.5.5.4.2.2.2.1.cmml">
            ~
           </mo>
          </mover>
          <mi id="S4.SS2.p4.15.m7.5.5.4.2.3" xref="S4.SS2.p4.15.m7.5.5.4.2.3.cmml">
           t
          </mi>
          <mi id="S4.SS2.p4.15.m7.5.5.4.2.2.3" xref="S4.SS2.p4.15.m7.5.5.4.2.2.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="S4.SS2.p4.15.m7.5.5.4.1" lspace="0em" rspace="0em" xref="S4.SS2.p4.15.m7.5.5.4.1.cmml">
          ​
         </mo>
         <mrow id="S4.SS2.p4.15.m7.5.5.4.3.2" xref="S4.SS2.p4.15.m7.5.5.4.3.1.cmml">
          <mo id="S4.SS2.p4.15.m7.5.5.4.3.2.1" stretchy="false" xref="S4.SS2.p4.15.m7.5.5.4.3.1.1.cmml">
           [
          </mo>
          <mi id="S4.SS2.p4.15.m7.2.2" xref="S4.SS2.p4.15.m7.2.2.cmml">
           m
          </mi>
          <mo id="S4.SS2.p4.15.m7.5.5.4.3.2.2" stretchy="false" xref="S4.SS2.p4.15.m7.5.5.4.3.1.1.cmml">
           ]
          </mo>
         </mrow>
        </mrow>
        <mo id="S4.SS2.p4.15.m7.5.5.3" xref="S4.SS2.p4.15.m7.5.5.3.cmml">
         =
        </mo>
        <mrow id="S4.SS2.p4.15.m7.5.5.2" xref="S4.SS2.p4.15.m7.5.5.2.cmml">
         <mrow id="S4.SS2.p4.15.m7.5.5.2.4" xref="S4.SS2.p4.15.m7.5.5.2.4.cmml">
          <mi id="S4.SS2.p4.15.m7.5.5.2.4.1" xref="S4.SS2.p4.15.m7.5.5.2.4.1.cmml">
           arg
          </mi>
          <mo id="S4.SS2.p4.15.m7.5.5.2.4a" lspace="0.167em" xref="S4.SS2.p4.15.m7.5.5.2.4.cmml">
           ⁡
          </mo>
          <mrow id="S4.SS2.p4.15.m7.5.5.2.4.2" xref="S4.SS2.p4.15.m7.5.5.2.4.2.cmml">
           <msub id="S4.SS2.p4.15.m7.5.5.2.4.2.1" xref="S4.SS2.p4.15.m7.5.5.2.4.2.1.cmml">
            <mi id="S4.SS2.p4.15.m7.5.5.2.4.2.1.2" xref="S4.SS2.p4.15.m7.5.5.2.4.2.1.2.cmml">
             max
            </mi>
            <mrow id="S4.SS2.p4.15.m7.1.1.1" xref="S4.SS2.p4.15.m7.1.1.1.cmml">
             <mi id="S4.SS2.p4.15.m7.1.1.1.3" xref="S4.SS2.p4.15.m7.1.1.1.3.cmml">
              j
             </mi>
             <mo id="S4.SS2.p4.15.m7.1.1.1.2" xref="S4.SS2.p4.15.m7.1.1.1.2.cmml">
              ∈
             </mo>
             <mrow id="S4.SS2.p4.15.m7.1.1.1.4.2" xref="S4.SS2.p4.15.m7.1.1.1.4.1.cmml">
              <mo id="S4.SS2.p4.15.m7.1.1.1.4.2.1" stretchy="false" xref="S4.SS2.p4.15.m7.1.1.1.4.1.1.cmml">
               [
              </mo>
              <mi id="S4.SS2.p4.15.m7.1.1.1.1" xref="S4.SS2.p4.15.m7.1.1.1.1.cmml">
               N
              </mi>
              <mo id="S4.SS2.p4.15.m7.1.1.1.4.2.2" stretchy="false" xref="S4.SS2.p4.15.m7.1.1.1.4.1.1.cmml">
               ]
              </mo>
             </mrow>
            </mrow>
           </msub>
           <mo id="S4.SS2.p4.15.m7.5.5.2.4.2a" lspace="0.167em" xref="S4.SS2.p4.15.m7.5.5.2.4.2.cmml">
            ⁡
           </mo>
           <mi id="S4.SS2.p4.15.m7.5.5.2.4.2.2" xref="S4.SS2.p4.15.m7.5.5.2.4.2.2.cmml">
            r
           </mi>
          </mrow>
         </mrow>
         <mo id="S4.SS2.p4.15.m7.5.5.2.3" lspace="0em" rspace="0em" xref="S4.SS2.p4.15.m7.5.5.2.3.cmml">
          ​
         </mo>
         <mrow id="S4.SS2.p4.15.m7.5.5.2.2.2" xref="S4.SS2.p4.15.m7.5.5.2.2.3.cmml">
          <mo id="S4.SS2.p4.15.m7.5.5.2.2.2.3" stretchy="false" xref="S4.SS2.p4.15.m7.5.5.2.2.3.cmml">
           (
          </mo>
          <msub id="S4.SS2.p4.15.m7.4.4.1.1.1.1" xref="S4.SS2.p4.15.m7.4.4.1.1.1.1.cmml">
           <mi id="S4.SS2.p4.15.m7.4.4.1.1.1.1.2" xref="S4.SS2.p4.15.m7.4.4.1.1.1.1.2.cmml">
            𝐬
           </mi>
           <mi id="S4.SS2.p4.15.m7.4.4.1.1.1.1.3" xref="S4.SS2.p4.15.m7.4.4.1.1.1.1.3.cmml">
            i
           </mi>
          </msub>
          <mo id="S4.SS2.p4.15.m7.5.5.2.2.2.4" xref="S4.SS2.p4.15.m7.5.5.2.2.3.cmml">
           ,
          </mo>
          <mrow id="S4.SS2.p4.15.m7.5.5.2.2.2.2" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.cmml">
           <msubsup id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.cmml">
            <mover accent="true" id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.2" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.2.cmml">
             <mi id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.2.2" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.2.2.cmml">
              𝐲
             </mi>
             <mo id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.2.1" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.2.1.cmml">
              ~
             </mo>
            </mover>
            <mi id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.3" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.3.cmml">
             t
            </mi>
            <mi id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.3" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.3.cmml">
             i
            </mi>
           </msubsup>
           <mo id="S4.SS2.p4.15.m7.5.5.2.2.2.2.1" lspace="0em" rspace="0em" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.1.cmml">
            ​
           </mo>
           <mrow id="S4.SS2.p4.15.m7.5.5.2.2.2.2.3.2" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.3.1.cmml">
            <mo id="S4.SS2.p4.15.m7.5.5.2.2.2.2.3.2.1" stretchy="false" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.3.1.1.cmml">
             [
            </mo>
            <mi id="S4.SS2.p4.15.m7.3.3" xref="S4.SS2.p4.15.m7.3.3.cmml">
             j
            </mi>
            <mo id="S4.SS2.p4.15.m7.5.5.2.2.2.2.3.2.2" stretchy="false" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.3.1.1.cmml">
             ]
            </mo>
           </mrow>
          </mrow>
          <mo id="S4.SS2.p4.15.m7.5.5.2.2.2.5" stretchy="false" xref="S4.SS2.p4.15.m7.5.5.2.2.3.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.15.m7.5b">
        <apply id="S4.SS2.p4.15.m7.5.5.cmml" xref="S4.SS2.p4.15.m7.5.5">
         <eq id="S4.SS2.p4.15.m7.5.5.3.cmml" xref="S4.SS2.p4.15.m7.5.5.3">
         </eq>
         <apply id="S4.SS2.p4.15.m7.5.5.4.cmml" xref="S4.SS2.p4.15.m7.5.5.4">
          <times id="S4.SS2.p4.15.m7.5.5.4.1.cmml" xref="S4.SS2.p4.15.m7.5.5.4.1">
          </times>
          <apply id="S4.SS2.p4.15.m7.5.5.4.2.cmml" xref="S4.SS2.p4.15.m7.5.5.4.2">
           <csymbol cd="ambiguous" id="S4.SS2.p4.15.m7.5.5.4.2.1.cmml" xref="S4.SS2.p4.15.m7.5.5.4.2">
            subscript
           </csymbol>
           <apply id="S4.SS2.p4.15.m7.5.5.4.2.2.cmml" xref="S4.SS2.p4.15.m7.5.5.4.2">
            <csymbol cd="ambiguous" id="S4.SS2.p4.15.m7.5.5.4.2.2.1.cmml" xref="S4.SS2.p4.15.m7.5.5.4.2">
             superscript
            </csymbol>
            <apply id="S4.SS2.p4.15.m7.5.5.4.2.2.2.cmml" xref="S4.SS2.p4.15.m7.5.5.4.2.2.2">
             <ci id="S4.SS2.p4.15.m7.5.5.4.2.2.2.1.cmml" xref="S4.SS2.p4.15.m7.5.5.4.2.2.2.1">
              ~
             </ci>
             <ci id="S4.SS2.p4.15.m7.5.5.4.2.2.2.2.cmml" xref="S4.SS2.p4.15.m7.5.5.4.2.2.2.2">
              𝐲
             </ci>
            </apply>
            <ci id="S4.SS2.p4.15.m7.5.5.4.2.2.3.cmml" xref="S4.SS2.p4.15.m7.5.5.4.2.2.3">
             𝑖
            </ci>
           </apply>
           <ci id="S4.SS2.p4.15.m7.5.5.4.2.3.cmml" xref="S4.SS2.p4.15.m7.5.5.4.2.3">
            𝑡
           </ci>
          </apply>
          <apply id="S4.SS2.p4.15.m7.5.5.4.3.1.cmml" xref="S4.SS2.p4.15.m7.5.5.4.3.2">
           <csymbol cd="latexml" id="S4.SS2.p4.15.m7.5.5.4.3.1.1.cmml" xref="S4.SS2.p4.15.m7.5.5.4.3.2.1">
            delimited-[]
           </csymbol>
           <ci id="S4.SS2.p4.15.m7.2.2.cmml" xref="S4.SS2.p4.15.m7.2.2">
            𝑚
           </ci>
          </apply>
         </apply>
         <apply id="S4.SS2.p4.15.m7.5.5.2.cmml" xref="S4.SS2.p4.15.m7.5.5.2">
          <times id="S4.SS2.p4.15.m7.5.5.2.3.cmml" xref="S4.SS2.p4.15.m7.5.5.2.3">
          </times>
          <apply id="S4.SS2.p4.15.m7.5.5.2.4.cmml" xref="S4.SS2.p4.15.m7.5.5.2.4">
           <arg id="S4.SS2.p4.15.m7.5.5.2.4.1.cmml" xref="S4.SS2.p4.15.m7.5.5.2.4.1">
           </arg>
           <apply id="S4.SS2.p4.15.m7.5.5.2.4.2.cmml" xref="S4.SS2.p4.15.m7.5.5.2.4.2">
            <apply id="S4.SS2.p4.15.m7.5.5.2.4.2.1.cmml" xref="S4.SS2.p4.15.m7.5.5.2.4.2.1">
             <csymbol cd="ambiguous" id="S4.SS2.p4.15.m7.5.5.2.4.2.1.1.cmml" xref="S4.SS2.p4.15.m7.5.5.2.4.2.1">
              subscript
             </csymbol>
             <max id="S4.SS2.p4.15.m7.5.5.2.4.2.1.2.cmml" xref="S4.SS2.p4.15.m7.5.5.2.4.2.1.2">
             </max>
             <apply id="S4.SS2.p4.15.m7.1.1.1.cmml" xref="S4.SS2.p4.15.m7.1.1.1">
              <in id="S4.SS2.p4.15.m7.1.1.1.2.cmml" xref="S4.SS2.p4.15.m7.1.1.1.2">
              </in>
              <ci id="S4.SS2.p4.15.m7.1.1.1.3.cmml" xref="S4.SS2.p4.15.m7.1.1.1.3">
               𝑗
              </ci>
              <apply id="S4.SS2.p4.15.m7.1.1.1.4.1.cmml" xref="S4.SS2.p4.15.m7.1.1.1.4.2">
               <csymbol cd="latexml" id="S4.SS2.p4.15.m7.1.1.1.4.1.1.cmml" xref="S4.SS2.p4.15.m7.1.1.1.4.2.1">
                delimited-[]
               </csymbol>
               <ci id="S4.SS2.p4.15.m7.1.1.1.1.cmml" xref="S4.SS2.p4.15.m7.1.1.1.1">
                𝑁
               </ci>
              </apply>
             </apply>
            </apply>
            <ci id="S4.SS2.p4.15.m7.5.5.2.4.2.2.cmml" xref="S4.SS2.p4.15.m7.5.5.2.4.2.2">
             𝑟
            </ci>
           </apply>
          </apply>
          <interval closure="open" id="S4.SS2.p4.15.m7.5.5.2.2.3.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2">
           <apply id="S4.SS2.p4.15.m7.4.4.1.1.1.1.cmml" xref="S4.SS2.p4.15.m7.4.4.1.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS2.p4.15.m7.4.4.1.1.1.1.1.cmml" xref="S4.SS2.p4.15.m7.4.4.1.1.1.1">
             subscript
            </csymbol>
            <ci id="S4.SS2.p4.15.m7.4.4.1.1.1.1.2.cmml" xref="S4.SS2.p4.15.m7.4.4.1.1.1.1.2">
             𝐬
            </ci>
            <ci id="S4.SS2.p4.15.m7.4.4.1.1.1.1.3.cmml" xref="S4.SS2.p4.15.m7.4.4.1.1.1.1.3">
             𝑖
            </ci>
           </apply>
           <apply id="S4.SS2.p4.15.m7.5.5.2.2.2.2.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2">
            <times id="S4.SS2.p4.15.m7.5.5.2.2.2.2.1.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.1">
            </times>
            <apply id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2">
             <csymbol cd="ambiguous" id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.1.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2">
              subscript
             </csymbol>
             <apply id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2">
              <csymbol cd="ambiguous" id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.1.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2">
               superscript
              </csymbol>
              <apply id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.2.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.2">
               <ci id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.2.1.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.2.1">
                ~
               </ci>
               <ci id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.2.2.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.2.2">
                𝐲
               </ci>
              </apply>
              <ci id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.3.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.2.3">
               𝑖
              </ci>
             </apply>
             <ci id="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.3.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.2.3">
              𝑡
             </ci>
            </apply>
            <apply id="S4.SS2.p4.15.m7.5.5.2.2.2.2.3.1.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.3.2">
             <csymbol cd="latexml" id="S4.SS2.p4.15.m7.5.5.2.2.2.2.3.1.1.cmml" xref="S4.SS2.p4.15.m7.5.5.2.2.2.2.3.2.1">
              delimited-[]
             </csymbol>
             <ci id="S4.SS2.p4.15.m7.3.3.cmml" xref="S4.SS2.p4.15.m7.3.3">
              𝑗
             </ci>
            </apply>
           </apply>
          </interval>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.15.m7.5c">
        \tilde{\mathbf{y}}^{i}_{t}[m]=\arg\max_{j\in[N]}r(\mathbf{s}_{i},\tilde{\mathbf{y}}^{i}_{t}[j])
       </annotation>
      </semantics>
     </math>
     , then we label the responses in the dataset
     <math alttext="\mathcal{D}_{\text{on-policy}}" class="ltx_Math" display="inline" id="S4.SS2.p4.16.m8.1">
      <semantics id="S4.SS2.p4.16.m8.1a">
       <msub id="S4.SS2.p4.16.m8.1.1" xref="S4.SS2.p4.16.m8.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.16.m8.1.1.2" xref="S4.SS2.p4.16.m8.1.1.2.cmml">
         𝒟
        </mi>
        <mtext id="S4.SS2.p4.16.m8.1.1.3" xref="S4.SS2.p4.16.m8.1.1.3a.cmml">
         on-policy
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.16.m8.1b">
        <apply id="S4.SS2.p4.16.m8.1.1.cmml" xref="S4.SS2.p4.16.m8.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p4.16.m8.1.1.1.cmml" xref="S4.SS2.p4.16.m8.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p4.16.m8.1.1.2.cmml" xref="S4.SS2.p4.16.m8.1.1.2">
          𝒟
         </ci>
         <ci id="S4.SS2.p4.16.m8.1.1.3a.cmml" xref="S4.SS2.p4.16.m8.1.1.3">
          <mtext id="S4.SS2.p4.16.m8.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p4.16.m8.1.1.3">
           on-policy
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.16.m8.1c">
        \mathcal{D}_{\text{on-policy}}
       </annotation>
      </semantics>
     </math>
     at step
     <math alttext="t+1" class="ltx_Math" display="inline" id="S4.SS2.p4.17.m9.1">
      <semantics id="S4.SS2.p4.17.m9.1a">
       <mrow id="S4.SS2.p4.17.m9.1.1" xref="S4.SS2.p4.17.m9.1.1.cmml">
        <mi id="S4.SS2.p4.17.m9.1.1.2" xref="S4.SS2.p4.17.m9.1.1.2.cmml">
         t
        </mi>
        <mo id="S4.SS2.p4.17.m9.1.1.1" xref="S4.SS2.p4.17.m9.1.1.1.cmml">
         +
        </mo>
        <mn id="S4.SS2.p4.17.m9.1.1.3" xref="S4.SS2.p4.17.m9.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.17.m9.1b">
        <apply id="S4.SS2.p4.17.m9.1.1.cmml" xref="S4.SS2.p4.17.m9.1.1">
         <plus id="S4.SS2.p4.17.m9.1.1.1.cmml" xref="S4.SS2.p4.17.m9.1.1.1">
         </plus>
         <ci id="S4.SS2.p4.17.m9.1.1.2.cmml" xref="S4.SS2.p4.17.m9.1.1.2">
          𝑡
         </ci>
         <cn id="S4.SS2.p4.17.m9.1.1.3.cmml" type="integer" xref="S4.SS2.p4.17.m9.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.17.m9.1c">
        t+1
       </annotation>
      </semantics>
     </math>
     with the improved response and its associated reward value
     <math alttext="\tilde{r}_{t}^{i}[m]" class="ltx_Math" display="inline" id="S4.SS2.p4.18.m10.1">
      <semantics id="S4.SS2.p4.18.m10.1a">
       <mrow id="S4.SS2.p4.18.m10.1.2" xref="S4.SS2.p4.18.m10.1.2.cmml">
        <msubsup id="S4.SS2.p4.18.m10.1.2.2" xref="S4.SS2.p4.18.m10.1.2.2.cmml">
         <mover accent="true" id="S4.SS2.p4.18.m10.1.2.2.2.2" xref="S4.SS2.p4.18.m10.1.2.2.2.2.cmml">
          <mi id="S4.SS2.p4.18.m10.1.2.2.2.2.2" xref="S4.SS2.p4.18.m10.1.2.2.2.2.2.cmml">
           r
          </mi>
          <mo id="S4.SS2.p4.18.m10.1.2.2.2.2.1" xref="S4.SS2.p4.18.m10.1.2.2.2.2.1.cmml">
           ~
          </mo>
         </mover>
         <mi id="S4.SS2.p4.18.m10.1.2.2.2.3" xref="S4.SS2.p4.18.m10.1.2.2.2.3.cmml">
          t
         </mi>
         <mi id="S4.SS2.p4.18.m10.1.2.2.3" xref="S4.SS2.p4.18.m10.1.2.2.3.cmml">
          i
         </mi>
        </msubsup>
        <mo id="S4.SS2.p4.18.m10.1.2.1" lspace="0em" rspace="0em" xref="S4.SS2.p4.18.m10.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S4.SS2.p4.18.m10.1.2.3.2" xref="S4.SS2.p4.18.m10.1.2.3.1.cmml">
         <mo id="S4.SS2.p4.18.m10.1.2.3.2.1" stretchy="false" xref="S4.SS2.p4.18.m10.1.2.3.1.1.cmml">
          [
         </mo>
         <mi id="S4.SS2.p4.18.m10.1.1" xref="S4.SS2.p4.18.m10.1.1.cmml">
          m
         </mi>
         <mo id="S4.SS2.p4.18.m10.1.2.3.2.2" stretchy="false" xref="S4.SS2.p4.18.m10.1.2.3.1.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p4.18.m10.1b">
        <apply id="S4.SS2.p4.18.m10.1.2.cmml" xref="S4.SS2.p4.18.m10.1.2">
         <times id="S4.SS2.p4.18.m10.1.2.1.cmml" xref="S4.SS2.p4.18.m10.1.2.1">
         </times>
         <apply id="S4.SS2.p4.18.m10.1.2.2.cmml" xref="S4.SS2.p4.18.m10.1.2.2">
          <csymbol cd="ambiguous" id="S4.SS2.p4.18.m10.1.2.2.1.cmml" xref="S4.SS2.p4.18.m10.1.2.2">
           superscript
          </csymbol>
          <apply id="S4.SS2.p4.18.m10.1.2.2.2.cmml" xref="S4.SS2.p4.18.m10.1.2.2">
           <csymbol cd="ambiguous" id="S4.SS2.p4.18.m10.1.2.2.2.1.cmml" xref="S4.SS2.p4.18.m10.1.2.2">
            subscript
           </csymbol>
           <apply id="S4.SS2.p4.18.m10.1.2.2.2.2.cmml" xref="S4.SS2.p4.18.m10.1.2.2.2.2">
            <ci id="S4.SS2.p4.18.m10.1.2.2.2.2.1.cmml" xref="S4.SS2.p4.18.m10.1.2.2.2.2.1">
             ~
            </ci>
            <ci id="S4.SS2.p4.18.m10.1.2.2.2.2.2.cmml" xref="S4.SS2.p4.18.m10.1.2.2.2.2.2">
             𝑟
            </ci>
           </apply>
           <ci id="S4.SS2.p4.18.m10.1.2.2.2.3.cmml" xref="S4.SS2.p4.18.m10.1.2.2.2.3">
            𝑡
           </ci>
          </apply>
          <ci id="S4.SS2.p4.18.m10.1.2.2.3.cmml" xref="S4.SS2.p4.18.m10.1.2.2.3">
           𝑖
          </ci>
         </apply>
         <apply id="S4.SS2.p4.18.m10.1.2.3.1.cmml" xref="S4.SS2.p4.18.m10.1.2.3.2">
          <csymbol cd="latexml" id="S4.SS2.p4.18.m10.1.2.3.1.1.cmml" xref="S4.SS2.p4.18.m10.1.2.3.2.1">
           delimited-[]
          </csymbol>
          <ci id="S4.SS2.p4.18.m10.1.1.cmml" xref="S4.SS2.p4.18.m10.1.1">
           𝑚
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p4.18.m10.1c">
        \tilde{r}_{t}^{i}[m]
       </annotation>
      </semantics>
     </math>
     :
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx4">
     <tbody id="S4.E5">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_left_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\tilde{\mathcal{D}}_{\text{on-policy + self-distillation}}:=\left\{\left\{\left(\mathbf{s}^{i}_{t+1},{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}\tilde{\mathbf{y}}^{i}_{t}[m]},f^{i}_{t+1},{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}\tilde{r}_{t}^{i}[m]}\right)\right\}_{t=0}^{T-1}\right\}_{i=1}^{|\mathcal{D}|}." class="ltx_Math" display="inline" id="S4.E5.m1.4">
         <semantics id="S4.E5.m1.4a">
          <mrow id="S4.E5.m1.4.4.1" xref="S4.E5.m1.4.4.1.1.cmml">
           <mrow id="S4.E5.m1.4.4.1.1" xref="S4.E5.m1.4.4.1.1.cmml">
            <msub id="S4.E5.m1.4.4.1.1.3" xref="S4.E5.m1.4.4.1.1.3.cmml">
             <mover accent="true" id="S4.E5.m1.4.4.1.1.3.2" xref="S4.E5.m1.4.4.1.1.3.2.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.4.4.1.1.3.2.2" xref="S4.E5.m1.4.4.1.1.3.2.2.cmml">
               𝒟
              </mi>
              <mo id="S4.E5.m1.4.4.1.1.3.2.1" xref="S4.E5.m1.4.4.1.1.3.2.1.cmml">
               ~
              </mo>
             </mover>
             <mtext id="S4.E5.m1.4.4.1.1.3.3" xref="S4.E5.m1.4.4.1.1.3.3a.cmml">
              on-policy + self-distillation
             </mtext>
            </msub>
            <mo id="S4.E5.m1.4.4.1.1.2" lspace="0.278em" rspace="0.278em" xref="S4.E5.m1.4.4.1.1.2.cmml">
             :=
            </mo>
            <msubsup id="S4.E5.m1.4.4.1.1.1" xref="S4.E5.m1.4.4.1.1.1.cmml">
             <mrow id="S4.E5.m1.4.4.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.2.cmml">
              <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.2.cmml">
               {
              </mo>
              <msubsup id="S4.E5.m1.4.4.1.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.cmml">
               <mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">
                <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">
                 {
                </mo>
                <mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.5.cmml">
                 <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.5" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.5.cmml">
                  (
                 </mo>
                 <msubsup id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">
                   𝐬
                  </mi>
                  <mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                   <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                    t
                   </mi>
                   <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">
                    +
                   </mo>
                   <mn id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                    1
                   </mn>
                  </mrow>
                  <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                   i
                  </mi>
                 </msubsup>
                 <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.6" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.5.cmml">
                  ,
                 </mo>
                 <mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">
                  <msubsup id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">
                   <mover accent="true" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">
                    <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2" mathcolor="#FF0000" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml">
                     𝐲
                    </mi>
                    <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1" mathcolor="#FF0000" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml">
                     ~
                    </mo>
                   </mover>
                   <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" mathcolor="#FF0000" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">
                    t
                   </mi>
                   <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3" mathcolor="#FF0000" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">
                    i
                   </mi>
                  </msubsup>
                  <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.1" lspace="0em" rspace="0em" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">
                   ​
                  </mo>
                  <mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">
                   <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.1" mathcolor="#FF0000" stretchy="false" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.1.cmml">
                    [
                   </mo>
                   <mi id="S4.E5.m1.2.2" mathcolor="#FF0000" xref="S4.E5.m1.2.2.cmml">
                    m
                   </mi>
                   <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2" mathcolor="#FF0000" stretchy="false" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.1.cmml">
                    ]
                   </mo>
                  </mrow>
                 </mrow>
                 <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.7" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.5.cmml">
                  ,
                 </mo>
                 <msubsup id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                  <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">
                   f
                  </mi>
                  <mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">
                   <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">
                    t
                   </mi>
                   <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">
                    +
                   </mo>
                   <mn id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">
                    1
                   </mn>
                  </mrow>
                  <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">
                   i
                  </mi>
                 </msubsup>
                 <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.8" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.5.cmml">
                  ,
                 </mo>
                 <mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.cmml">
                  <msubsup id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.cmml">
                   <mover accent="true" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2.cmml">
                    <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2.2" mathcolor="#FF0000" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2.2.cmml">
                     r
                    </mi>
                    <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2.1" mathcolor="#FF0000" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2.1.cmml">
                     ~
                    </mo>
                   </mover>
                   <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.3" mathcolor="#FF0000" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.3.cmml">
                    t
                   </mi>
                   <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.3" mathcolor="#FF0000" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.3.cmml">
                    i
                   </mi>
                  </msubsup>
                  <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.1" lspace="0em" rspace="0em" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.1.cmml">
                   ​
                  </mo>
                  <mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.3.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.3.1.cmml">
                   <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.3.2.1" mathcolor="#FF0000" stretchy="false" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.3.1.1.cmml">
                    [
                   </mo>
                   <mi id="S4.E5.m1.3.3" mathcolor="#FF0000" xref="S4.E5.m1.3.3.cmml">
                    m
                   </mi>
                   <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.3.2.2" mathcolor="#FF0000" stretchy="false" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.3.1.1.cmml">
                    ]
                   </mo>
                  </mrow>
                 </mrow>
                 <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.9" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.5.cmml">
                  )
                 </mo>
                </mrow>
                <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">
                 }
                </mo>
               </mrow>
               <mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">
                <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml">
                 t
                </mi>
                <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml">
                 =
                </mo>
                <mn id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml">
                 0
                </mn>
               </mrow>
               <mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.cmml">
                <mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">
                 T
                </mi>
                <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">
                 −
                </mo>
                <mn id="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.3.cmml">
                 1
                </mn>
               </mrow>
              </msubsup>
              <mo id="S4.E5.m1.4.4.1.1.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.1.2.cmml">
               }
              </mo>
             </mrow>
             <mrow id="S4.E5.m1.4.4.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.3.cmml">
              <mi id="S4.E5.m1.4.4.1.1.1.1.3.2" xref="S4.E5.m1.4.4.1.1.1.1.3.2.cmml">
               i
              </mi>
              <mo id="S4.E5.m1.4.4.1.1.1.1.3.1" xref="S4.E5.m1.4.4.1.1.1.1.3.1.cmml">
               =
              </mo>
              <mn id="S4.E5.m1.4.4.1.1.1.1.3.3" xref="S4.E5.m1.4.4.1.1.1.1.3.3.cmml">
               1
              </mn>
             </mrow>
             <mrow id="S4.E5.m1.1.1.1.3" xref="S4.E5.m1.1.1.1.2.cmml">
              <mo id="S4.E5.m1.1.1.1.3.1" stretchy="false" xref="S4.E5.m1.1.1.1.2.1.cmml">
               |
              </mo>
              <mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">
               𝒟
              </mi>
              <mo id="S4.E5.m1.1.1.1.3.2" stretchy="false" xref="S4.E5.m1.1.1.1.2.1.cmml">
               |
              </mo>
             </mrow>
            </msubsup>
           </mrow>
           <mo id="S4.E5.m1.4.4.1.2" lspace="0em" xref="S4.E5.m1.4.4.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E5.m1.4b">
           <apply id="S4.E5.m1.4.4.1.1.cmml" xref="S4.E5.m1.4.4.1">
            <csymbol cd="latexml" id="S4.E5.m1.4.4.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.2">
             assign
            </csymbol>
            <apply id="S4.E5.m1.4.4.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.3">
             <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.3">
              subscript
             </csymbol>
             <apply id="S4.E5.m1.4.4.1.1.3.2.cmml" xref="S4.E5.m1.4.4.1.1.3.2">
              <ci id="S4.E5.m1.4.4.1.1.3.2.1.cmml" xref="S4.E5.m1.4.4.1.1.3.2.1">
               ~
              </ci>
              <ci id="S4.E5.m1.4.4.1.1.3.2.2.cmml" xref="S4.E5.m1.4.4.1.1.3.2.2">
               𝒟
              </ci>
             </apply>
             <ci id="S4.E5.m1.4.4.1.1.3.3a.cmml" xref="S4.E5.m1.4.4.1.1.3.3">
              <mtext id="S4.E5.m1.4.4.1.1.3.3.cmml" mathsize="70%" xref="S4.E5.m1.4.4.1.1.3.3">
               on-policy + self-distillation
              </mtext>
             </ci>
            </apply>
            <apply id="S4.E5.m1.4.4.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1">
             <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1">
              superscript
             </csymbol>
             <apply id="S4.E5.m1.4.4.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1">
              <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1">
               subscript
              </csymbol>
              <set id="S4.E5.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1">
               <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1">
                 superscript
                </csymbol>
                <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <set id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1">
                  <vector id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4">
                   <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1">
                    <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1">
                     subscript
                    </csymbol>
                    <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1">
                     <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1">
                      superscript
                     </csymbol>
                     <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">
                      𝐬
                     </ci>
                     <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">
                      𝑖
                     </ci>
                    </apply>
                    <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                     <plus id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1">
                     </plus>
                     <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">
                      𝑡
                     </ci>
                     <cn id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">
                      1
                     </cn>
                    </apply>
                   </apply>
                   <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2">
                    <times id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.1">
                    </times>
                    <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2">
                     <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2">
                      subscript
                     </csymbol>
                     <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2">
                      <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2">
                       superscript
                      </csymbol>
                      <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">
                       <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1">
                        ~
                       </ci>
                       <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2">
                        𝐲
                       </ci>
                      </apply>
                      <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3">
                       𝑖
                      </ci>
                     </apply>
                     <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">
                      𝑡
                     </ci>
                    </apply>
                    <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2">
                     <csymbol cd="latexml" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.1">
                      delimited-[]
                     </csymbol>
                     <ci id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">
                      𝑚
                     </ci>
                    </apply>
                   </apply>
                   <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3">
                    <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3">
                     subscript
                    </csymbol>
                    <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3">
                     <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3">
                      superscript
                     </csymbol>
                     <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2">
                      𝑓
                     </ci>
                     <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3">
                      𝑖
                     </ci>
                    </apply>
                    <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3">
                     <plus id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1">
                     </plus>
                     <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2">
                      𝑡
                     </ci>
                     <cn id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.3">
                      1
                     </cn>
                    </apply>
                   </apply>
                   <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4">
                    <times id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.1">
                    </times>
                    <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2">
                     <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2">
                      superscript
                     </csymbol>
                     <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2">
                      <csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2">
                       subscript
                      </csymbol>
                      <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2">
                       <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2.1">
                        ~
                       </ci>
                       <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.2.2">
                        𝑟
                       </ci>
                      </apply>
                      <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.2.3">
                       𝑡
                      </ci>
                     </apply>
                     <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.2.3">
                      𝑖
                     </ci>
                    </apply>
                    <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.3.2">
                     <csymbol cd="latexml" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.3.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4.4.3.2.1">
                      delimited-[]
                     </csymbol>
                     <ci id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3">
                      𝑚
                     </ci>
                    </apply>
                   </apply>
                  </vector>
                 </set>
                 <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3">
                  <eq id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.1">
                  </eq>
                  <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.2">
                   𝑡
                  </ci>
                  <cn id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.3">
                   0
                  </cn>
                 </apply>
                </apply>
                <apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.3">
                 <minus id="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.1">
                 </minus>
                 <ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.2">
                  𝑇
                 </ci>
                 <cn id="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.3">
                  1
                 </cn>
                </apply>
               </apply>
              </set>
              <apply id="S4.E5.m1.4.4.1.1.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3">
               <eq id="S4.E5.m1.4.4.1.1.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.1">
               </eq>
               <ci id="S4.E5.m1.4.4.1.1.1.1.3.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2">
                𝑖
               </ci>
               <cn id="S4.E5.m1.4.4.1.1.1.1.3.3.cmml" type="integer" xref="S4.E5.m1.4.4.1.1.1.1.3.3">
                1
               </cn>
              </apply>
             </apply>
             <apply id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.3">
              <abs id="S4.E5.m1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.3.1">
              </abs>
              <ci id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1">
               𝒟
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E5.m1.4c">
           \displaystyle\tilde{\mathcal{D}}_{\text{on-policy + self-distillation}}:=\left\{\left\{\left(\mathbf{s}^{i}_{t+1},{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}\tilde{\mathbf{y}}^{i}_{t}[m]},f^{i}_{t+1},{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}\tilde{r}_{t}^{i}[m]}\right)\right\}_{t=0}^{T-1}\right\}_{i=1}^{|\mathcal{D}|}.
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_left_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (4.5)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p5">
    <p class="ltx_p" id="S4.SS2.p5.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p5.1.1">
      Step 2: Policy improvement.
     </span>
     With the aforementioned data construction schemes, we can now train a model on these datasets. While in general, any offline RL approach can be used to train on these data, in our experiments we adopt an approach based on weighted supervised learning
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib35" title="">
       35
      </a>
      ]
     </cite>
     due to ease of experimentation and its simplicity. In particular, we perform a weighted supervised regression, where the weights are given by the exponential transformation of the reward values in
     <math alttext="\tilde{\mathcal{D}}" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1">
      <semantics id="S4.SS2.p5.1.m1.1a">
       <mover accent="true" id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.1.m1.1.1.2" xref="S4.SS2.p5.1.m1.1.1.2.cmml">
         𝒟
        </mi>
        <mo id="S4.SS2.p5.1.m1.1.1.1" xref="S4.SS2.p5.1.m1.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b">
        <apply id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">
         <ci id="S4.SS2.p5.1.m1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1.1">
          ~
         </ci>
         <ci id="S4.SS2.p5.1.m1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.1.2">
          𝒟
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">
        \tilde{\mathcal{D}}
       </annotation>
      </semantics>
     </math>
     .
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx5">
     <tbody id="S4.E6">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_left_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\text{Reward-weighted RL:}\leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \max_{\theta}\leavevmode\nobreak\ \leavevmode\nobreak\ \mathbb{E}_{\mathbf{x}_{i}\sim\tilde{\mathcal{D}}}\left[\sum_{t=1}^{T}\log\pi_{\theta}(\tilde{\mathbf{y}}^{i}_{t}|\mathbf{s}_{t}^{i})\cdot\exp(r^{t}_{i}/\tau)\right]," class="ltx_Math" display="inline" id="S4.E6.m1.3">
         <semantics id="S4.E6.m1.3a">
          <mrow id="S4.E6.m1.3.3.1">
           <mrow id="S4.E6.m1.3.3.1.1.2" xref="S4.E6.m1.3.3.1.1.3.cmml">
            <mtext id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2a.cmml">
             Reward-weighted RL:
            </mtext>
            <mspace id="S4.E6.m1.3.3.1.1.2.3" width="2.167em" xref="S4.E6.m1.3.3.1.1.3.cmml">
            </mspace>
            <munder id="S4.E6.m1.3.3.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.cmml">
             <mi id="S4.E6.m1.3.3.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.2.cmml">
              max
             </mi>
             <mi id="S4.E6.m1.3.3.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.1.3.cmml">
              θ
             </mi>
            </munder>
            <mspace id="S4.E6.m1.3.3.1.1.2.4" width="1.167em" xref="S4.E6.m1.3.3.1.1.3.cmml">
            </mspace>
            <mrow id="S4.E6.m1.3.3.1.1.2.2" xref="S4.E6.m1.3.3.1.1.2.2.cmml">
             <msub id="S4.E6.m1.3.3.1.1.2.2.3" xref="S4.E6.m1.3.3.1.1.2.2.3.cmml">
              <mi id="S4.E6.m1.3.3.1.1.2.2.3.2" xref="S4.E6.m1.3.3.1.1.2.2.3.2.cmml">
               𝔼
              </mi>
              <mrow id="S4.E6.m1.3.3.1.1.2.2.3.3" xref="S4.E6.m1.3.3.1.1.2.2.3.3.cmml">
               <msub id="S4.E6.m1.3.3.1.1.2.2.3.3.2" xref="S4.E6.m1.3.3.1.1.2.2.3.3.2.cmml">
                <mi id="S4.E6.m1.3.3.1.1.2.2.3.3.2.2" xref="S4.E6.m1.3.3.1.1.2.2.3.3.2.2.cmml">
                 𝐱
                </mi>
                <mi id="S4.E6.m1.3.3.1.1.2.2.3.3.2.3" xref="S4.E6.m1.3.3.1.1.2.2.3.3.2.3.cmml">
                 i
                </mi>
               </msub>
               <mo id="S4.E6.m1.3.3.1.1.2.2.3.3.1" xref="S4.E6.m1.3.3.1.1.2.2.3.3.1.cmml">
                ∼
               </mo>
               <mover accent="true" id="S4.E6.m1.3.3.1.1.2.2.3.3.3" xref="S4.E6.m1.3.3.1.1.2.2.3.3.3.cmml">
                <mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.3.3.1.1.2.2.3.3.3.2" xref="S4.E6.m1.3.3.1.1.2.2.3.3.3.2.cmml">
                 𝒟
                </mi>
                <mo id="S4.E6.m1.3.3.1.1.2.2.3.3.3.1" xref="S4.E6.m1.3.3.1.1.2.2.3.3.3.1.cmml">
                 ~
                </mo>
               </mover>
              </mrow>
             </msub>
             <mo id="S4.E6.m1.3.3.1.1.2.2.2" lspace="0em" rspace="0em" xref="S4.E6.m1.3.3.1.1.2.2.2.cmml">
              ​
             </mo>
             <mrow id="S4.E6.m1.3.3.1.1.2.2.1.1" xref="S4.E6.m1.3.3.1.1.2.2.1.2.cmml">
              <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.2" xref="S4.E6.m1.3.3.1.1.2.2.1.2.1.cmml">
               [
              </mo>
              <mrow id="S4.E6.m1.3.3.1.1.2.2.1.1.1" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.cmml">
               <mstyle displaystyle="true" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.cmml">
                <munderover id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3a" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.cmml">
                 <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.2" movablelimits="false" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.2.cmml">
                  ∑
                 </mo>
                 <mrow id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.cmml">
                  <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.2" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.2.cmml">
                   t
                  </mi>
                  <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.1" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.1.cmml">
                   =
                  </mo>
                  <mn id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.3.cmml">
                   1
                  </mn>
                 </mrow>
                 <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.3.cmml">
                  T
                 </mi>
                </munderover>
               </mstyle>
               <mrow id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.cmml">
                <mrow id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.cmml">
                 <mrow id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.cmml">
                  <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.1" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.1.cmml">
                   log
                  </mi>
                  <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3a" lspace="0.167em" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.cmml">
                   ⁡
                  </mo>
                  <msub id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.cmml">
                   <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.2" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.2.cmml">
                    π
                   </mi>
                   <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.3.cmml">
                    θ
                   </mi>
                  </msub>
                 </mrow>
                 <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.2.cmml">
                  ​
                 </mo>
                 <mrow id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml">
                  <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml">
                   (
                  </mo>
                  <mrow id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml">
                   <msubsup id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml">
                    <mover accent="true" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml">
                     <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml">
                      𝐲
                     </mi>
                     <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.1" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml">
                      ~
                     </mo>
                    </mover>
                    <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">
                     t
                    </mi>
                    <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml">
                     i
                    </mi>
                   </msubsup>
                   <mo fence="false" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">
                    |
                   </mo>
                   <msubsup id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml">
                    <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml">
                     𝐬
                    </mi>
                    <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml">
                     t
                    </mi>
                    <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">
                     i
                    </mi>
                   </msubsup>
                  </mrow>
                  <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.3" rspace="0.222em" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.3.cmml">
                 ⋅
                </mo>
                <mrow id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.2.cmml">
                 <mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">
                  exp
                 </mi>
                 <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1a" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.2.cmml">
                  ⁡
                 </mo>
                 <mrow id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.2.cmml">
                  <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.2.cmml">
                   (
                  </mo>
                  <mrow id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.cmml">
                   <msubsup id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.cmml">
                    <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.2.2" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.2.2.cmml">
                     r
                    </mi>
                    <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.3.cmml">
                     i
                    </mi>
                    <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.2.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.2.3.cmml">
                     t
                    </mi>
                   </msubsup>
                   <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.1" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.1.cmml">
                    /
                   </mo>
                   <mi id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.3" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.3.cmml">
                    τ
                   </mi>
                  </mrow>
                  <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.3" stretchy="false" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.2.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
              </mrow>
              <mo id="S4.E6.m1.3.3.1.1.2.2.1.1.3" xref="S4.E6.m1.3.3.1.1.2.2.1.2.1.cmml">
               ]
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E6.m1.3.3.1.2">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E6.m1.3b">
           <list id="S4.E6.m1.3.3.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.2">
            <ci id="S4.E6.m1.2.2a.cmml" xref="S4.E6.m1.2.2">
             <mtext id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">
              Reward-weighted RL:
             </mtext>
            </ci>
            <apply id="S4.E6.m1.3.3.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1">
             <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1">
              subscript
             </csymbol>
             <max id="S4.E6.m1.3.3.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.2">
             </max>
             <ci id="S4.E6.m1.3.3.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.3">
              𝜃
             </ci>
            </apply>
            <apply id="S4.E6.m1.3.3.1.1.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2">
             <times id="S4.E6.m1.3.3.1.1.2.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.2">
             </times>
             <apply id="S4.E6.m1.3.3.1.1.2.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3">
              <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.3.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3">
               subscript
              </csymbol>
              <ci id="S4.E6.m1.3.3.1.1.2.2.3.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3.2">
               𝔼
              </ci>
              <apply id="S4.E6.m1.3.3.1.1.2.2.3.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3.3">
               <csymbol cd="latexml" id="S4.E6.m1.3.3.1.1.2.2.3.3.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3.3.1">
                similar-to
               </csymbol>
               <apply id="S4.E6.m1.3.3.1.1.2.2.3.3.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3.3.2">
                <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.3.3.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3.3.2">
                 subscript
                </csymbol>
                <ci id="S4.E6.m1.3.3.1.1.2.2.3.3.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3.3.2.2">
                 𝐱
                </ci>
                <ci id="S4.E6.m1.3.3.1.1.2.2.3.3.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3.3.2.3">
                 𝑖
                </ci>
               </apply>
               <apply id="S4.E6.m1.3.3.1.1.2.2.3.3.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3.3.3">
                <ci id="S4.E6.m1.3.3.1.1.2.2.3.3.3.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3.3.3.1">
                 ~
                </ci>
                <ci id="S4.E6.m1.3.3.1.1.2.2.3.3.3.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3.3.3.2">
                 𝒟
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="S4.E6.m1.3.3.1.1.2.2.1.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1">
              <csymbol cd="latexml" id="S4.E6.m1.3.3.1.1.2.2.1.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.2">
               delimited-[]
              </csymbol>
              <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1">
               <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3">
                <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3">
                 superscript
                </csymbol>
                <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3">
                 <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3">
                  subscript
                 </csymbol>
                 <sum id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.2">
                 </sum>
                 <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3">
                  <eq id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.1">
                  </eq>
                  <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.2">
                   𝑡
                  </ci>
                  <cn id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.3.cmml" type="integer" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.2.3.3">
                   1
                  </cn>
                 </apply>
                </apply>
                <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.3.3">
                 𝑇
                </ci>
               </apply>
               <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2">
                <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.3">
                 ⋅
                </ci>
                <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1">
                 <times id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.2">
                 </times>
                 <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3">
                  <log id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.1">
                  </log>
                  <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2">
                   <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2">
                    subscript
                   </csymbol>
                   <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.2">
                    𝜋
                   </ci>
                   <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.3">
                    𝜃
                   </ci>
                  </apply>
                 </apply>
                 <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1">
                  <csymbol cd="latexml" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1">
                   conditional
                  </csymbol>
                  <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2">
                   <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2">
                    subscript
                   </csymbol>
                   <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2">
                    <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2">
                     superscript
                    </csymbol>
                    <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2">
                     <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.1">
                      ~
                     </ci>
                     <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.2">
                      𝐲
                     </ci>
                    </apply>
                    <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3">
                     𝑖
                    </ci>
                   </apply>
                   <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.3">
                    𝑡
                   </ci>
                  </apply>
                  <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3">
                   <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3">
                    superscript
                   </csymbol>
                   <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3">
                    <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3">
                     subscript
                    </csymbol>
                    <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.2">
                     𝐬
                    </ci>
                    <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.3">
                     𝑡
                    </ci>
                   </apply>
                   <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3">
                    𝑖
                   </ci>
                  </apply>
                 </apply>
                </apply>
                <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1">
                 <exp id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">
                 </exp>
                 <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1">
                  <divide id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.1">
                  </divide>
                  <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2">
                   <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2">
                    subscript
                   </csymbol>
                   <apply id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2">
                    <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2">
                     superscript
                    </csymbol>
                    <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.2.2">
                     𝑟
                    </ci>
                    <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.2.3">
                     𝑡
                    </ci>
                   </apply>
                   <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.2.3">
                    𝑖
                   </ci>
                  </apply>
                  <ci id="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.1.1.1.2.2.1.1.1.3">
                   𝜏
                  </ci>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </list>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E6.m1.3c">
           \displaystyle\text{Reward-weighted RL:}\leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \max_{\theta}\leavevmode\nobreak\ \leavevmode\nobreak\ \mathbb{E}_{\mathbf{x}_{i}\sim\tilde{\mathcal{D}}}\left[\sum_{t=1}^{T}\log\pi_{\theta}(\tilde{\mathbf{y}}^{i}_{t}|\mathbf{s}_{t}^{i})\cdot\exp(r^{t}_{i}/\tau)\right],
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_left_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (4.6)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS2.p5.2">
     where
     <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m1.1">
      <semantics id="S4.SS2.p5.2.m1.1a">
       <mi id="S4.SS2.p5.2.m1.1.1" xref="S4.SS2.p5.2.m1.1.1.cmml">
        τ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m1.1b">
        <ci id="S4.SS2.p5.2.m1.1.1.cmml" xref="S4.SS2.p5.2.m1.1.1">
         𝜏
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p5.2.m1.1c">
        \tau
       </annotation>
      </semantics>
     </math>
     is a temperature parameter to further expand or narrow the difference between good and bad actions. In our preliminary experiments, we found that Equation
     <a class="ltx_ref" href="#S4.E6" title="Equation 4.6 ‣ 4.2 Learning in the Multi-Turn MDP ‣ 4 RISE: Recursive Introspection for Self-Improvement ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       4.6
      </span>
     </a>
     can often induce a bias towards increasing log likelihoods of responses where rewards are high, prioritizing updates on easy problems where rewards are already high. To address this issue, we apply a slight modification to Equation
     <a class="ltx_ref" href="#S4.E6" title="Equation 4.6 ‣ 4.2 Learning in the Multi-Turn MDP ‣ 4 RISE: Recursive Introspection for Self-Improvement ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       4.6
      </span>
     </a>
     and center the exponentiated rewards around the mean value averaged across all attempts on a given prompt, akin to advantage-weighted regression
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib34" title="">
       34
      </a>
      ]
     </cite>
     . We find that the use of advantages in place of rewards helps us avoid the “rich-gets-richer” phenomenon with easy problems.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS3">
   <h4 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.3
    </span>
    Inference at Deployment Time
   </h4>
   <div class="ltx_para ltx_noindent" id="S4.SS3.p1">
    <p class="ltx_p" id="S4.SS3.p1.4">
     RISE can be run in two modes at inference time. Perhaps the most straightforward way to run the policy
     <math alttext="\pi_{\theta}(\cdot|\cdot)" class="ltx_math_unparsed" display="inline" id="S4.SS3.p1.1.m1.1">
      <semantics id="S4.SS3.p1.1.m1.1a">
       <mrow id="S4.SS3.p1.1.m1.1b">
        <msub id="S4.SS3.p1.1.m1.1.1">
         <mi id="S4.SS3.p1.1.m1.1.1.2">
          π
         </mi>
         <mi id="S4.SS3.p1.1.m1.1.1.3">
          θ
         </mi>
        </msub>
        <mrow id="S4.SS3.p1.1.m1.1.2">
         <mo id="S4.SS3.p1.1.m1.1.2.1" stretchy="false">
          (
         </mo>
         <mo id="S4.SS3.p1.1.m1.1.2.2" lspace="0em" rspace="0em">
          ⋅
         </mo>
         <mo fence="false" id="S4.SS3.p1.1.m1.1.2.3" stretchy="false">
          |
         </mo>
         <mo id="S4.SS3.p1.1.m1.1.2.4" lspace="0em" rspace="0em">
          ⋅
         </mo>
         <mo id="S4.SS3.p1.1.m1.1.2.5" stretchy="false">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">
        \pi_{\theta}(\cdot|\cdot)
       </annotation>
      </semantics>
     </math>
     trained by RISE is within a multi-turn rollout, where the model samples a new response conditioned on the past context (i.e., state in the multi-turn MDP). This past context consists of the external feedback
     <math alttext="p^{\text{test}}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1">
      <semantics id="S4.SS3.p1.2.m2.1a">
       <msubsup id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">
        <mi id="S4.SS3.p1.2.m2.1.1.2.2" xref="S4.SS3.p1.2.m2.1.1.2.2.cmml">
         p
        </mi>
        <mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">
         i
        </mi>
        <mtext id="S4.SS3.p1.2.m2.1.1.2.3" xref="S4.SS3.p1.2.m2.1.1.2.3a.cmml">
         test
        </mtext>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b">
        <apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.2.1.cmml" xref="S4.SS3.p1.2.m2.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS3.p1.2.m2.1.1.2.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2.2">
           𝑝
          </ci>
          <ci id="S4.SS3.p1.2.m2.1.1.2.3a.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3">
           <mtext id="S4.SS3.p1.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S4.SS3.p1.2.m2.1.1.2.3">
            test
           </mtext>
          </ci>
         </apply>
         <ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">
        p^{\text{test}}_{i}
       </annotation>
      </semantics>
     </math>
     concerning the response
     <math alttext="\mathbf{y}^{\text{test}}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1">
      <semantics id="S4.SS3.p1.3.m3.1a">
       <msubsup id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">
        <mi id="S4.SS3.p1.3.m3.1.1.2.2" xref="S4.SS3.p1.3.m3.1.1.2.2.cmml">
         𝐲
        </mi>
        <mi id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">
         i
        </mi>
        <mtext id="S4.SS3.p1.3.m3.1.1.2.3" xref="S4.SS3.p1.3.m3.1.1.2.3a.cmml">
         test
        </mtext>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b">
        <apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.2.1.cmml" xref="S4.SS3.p1.3.m3.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS3.p1.3.m3.1.1.2.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2.2">
           𝐲
          </ci>
          <ci id="S4.SS3.p1.3.m3.1.1.2.3a.cmml" xref="S4.SS3.p1.3.m3.1.1.2.3">
           <mtext id="S4.SS3.p1.3.m3.1.1.2.3.cmml" mathsize="70%" xref="S4.SS3.p1.3.m3.1.1.2.3">
            test
           </mtext>
          </ci>
         </apply>
         <ci id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">
        \mathbf{y}^{\text{test}}_{i}
       </annotation>
      </semantics>
     </math>
     and the rollout terminates as soon as the current response is judged to be correct according to the environment’s answer verification function. Put in other words, we terminate the rollout as soon as the reward is equal to the reward for the oracle response:
     <math alttext="r(\mathbf{x},\mathbf{y}^{\text{test}}_{i})=r(\mathbf{x},\mathbf{y}^{*})" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.4">
      <semantics id="S4.SS3.p1.4.m4.4a">
       <mrow id="S4.SS3.p1.4.m4.4.4" xref="S4.SS3.p1.4.m4.4.4.cmml">
        <mrow id="S4.SS3.p1.4.m4.3.3.1" xref="S4.SS3.p1.4.m4.3.3.1.cmml">
         <mi id="S4.SS3.p1.4.m4.3.3.1.3" xref="S4.SS3.p1.4.m4.3.3.1.3.cmml">
          r
         </mi>
         <mo id="S4.SS3.p1.4.m4.3.3.1.2" lspace="0em" rspace="0em" xref="S4.SS3.p1.4.m4.3.3.1.2.cmml">
          ​
         </mo>
         <mrow id="S4.SS3.p1.4.m4.3.3.1.1.1" xref="S4.SS3.p1.4.m4.3.3.1.1.2.cmml">
          <mo id="S4.SS3.p1.4.m4.3.3.1.1.1.2" stretchy="false" xref="S4.SS3.p1.4.m4.3.3.1.1.2.cmml">
           (
          </mo>
          <mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">
           𝐱
          </mi>
          <mo id="S4.SS3.p1.4.m4.3.3.1.1.1.3" xref="S4.SS3.p1.4.m4.3.3.1.1.2.cmml">
           ,
          </mo>
          <msubsup id="S4.SS3.p1.4.m4.3.3.1.1.1.1" xref="S4.SS3.p1.4.m4.3.3.1.1.1.1.cmml">
           <mi id="S4.SS3.p1.4.m4.3.3.1.1.1.1.2.2" xref="S4.SS3.p1.4.m4.3.3.1.1.1.1.2.2.cmml">
            𝐲
           </mi>
           <mi id="S4.SS3.p1.4.m4.3.3.1.1.1.1.3" xref="S4.SS3.p1.4.m4.3.3.1.1.1.1.3.cmml">
            i
           </mi>
           <mtext id="S4.SS3.p1.4.m4.3.3.1.1.1.1.2.3" xref="S4.SS3.p1.4.m4.3.3.1.1.1.1.2.3a.cmml">
            test
           </mtext>
          </msubsup>
          <mo id="S4.SS3.p1.4.m4.3.3.1.1.1.4" stretchy="false" xref="S4.SS3.p1.4.m4.3.3.1.1.2.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S4.SS3.p1.4.m4.4.4.3" xref="S4.SS3.p1.4.m4.4.4.3.cmml">
         =
        </mo>
        <mrow id="S4.SS3.p1.4.m4.4.4.2" xref="S4.SS3.p1.4.m4.4.4.2.cmml">
         <mi id="S4.SS3.p1.4.m4.4.4.2.3" xref="S4.SS3.p1.4.m4.4.4.2.3.cmml">
          r
         </mi>
         <mo id="S4.SS3.p1.4.m4.4.4.2.2" lspace="0em" rspace="0em" xref="S4.SS3.p1.4.m4.4.4.2.2.cmml">
          ​
         </mo>
         <mrow id="S4.SS3.p1.4.m4.4.4.2.1.1" xref="S4.SS3.p1.4.m4.4.4.2.1.2.cmml">
          <mo id="S4.SS3.p1.4.m4.4.4.2.1.1.2" stretchy="false" xref="S4.SS3.p1.4.m4.4.4.2.1.2.cmml">
           (
          </mo>
          <mi id="S4.SS3.p1.4.m4.2.2" xref="S4.SS3.p1.4.m4.2.2.cmml">
           𝐱
          </mi>
          <mo id="S4.SS3.p1.4.m4.4.4.2.1.1.3" xref="S4.SS3.p1.4.m4.4.4.2.1.2.cmml">
           ,
          </mo>
          <msup id="S4.SS3.p1.4.m4.4.4.2.1.1.1" xref="S4.SS3.p1.4.m4.4.4.2.1.1.1.cmml">
           <mi id="S4.SS3.p1.4.m4.4.4.2.1.1.1.2" xref="S4.SS3.p1.4.m4.4.4.2.1.1.1.2.cmml">
            𝐲
           </mi>
           <mo id="S4.SS3.p1.4.m4.4.4.2.1.1.1.3" xref="S4.SS3.p1.4.m4.4.4.2.1.1.1.3.cmml">
            ∗
           </mo>
          </msup>
          <mo id="S4.SS3.p1.4.m4.4.4.2.1.1.4" stretchy="false" xref="S4.SS3.p1.4.m4.4.4.2.1.2.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.4b">
        <apply id="S4.SS3.p1.4.m4.4.4.cmml" xref="S4.SS3.p1.4.m4.4.4">
         <eq id="S4.SS3.p1.4.m4.4.4.3.cmml" xref="S4.SS3.p1.4.m4.4.4.3">
         </eq>
         <apply id="S4.SS3.p1.4.m4.3.3.1.cmml" xref="S4.SS3.p1.4.m4.3.3.1">
          <times id="S4.SS3.p1.4.m4.3.3.1.2.cmml" xref="S4.SS3.p1.4.m4.3.3.1.2">
          </times>
          <ci id="S4.SS3.p1.4.m4.3.3.1.3.cmml" xref="S4.SS3.p1.4.m4.3.3.1.3">
           𝑟
          </ci>
          <interval closure="open" id="S4.SS3.p1.4.m4.3.3.1.1.2.cmml" xref="S4.SS3.p1.4.m4.3.3.1.1.1">
           <ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">
            𝐱
           </ci>
           <apply id="S4.SS3.p1.4.m4.3.3.1.1.1.1.cmml" xref="S4.SS3.p1.4.m4.3.3.1.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.3.3.1.1.1.1.1.cmml" xref="S4.SS3.p1.4.m4.3.3.1.1.1.1">
             subscript
            </csymbol>
            <apply id="S4.SS3.p1.4.m4.3.3.1.1.1.1.2.cmml" xref="S4.SS3.p1.4.m4.3.3.1.1.1.1">
             <csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.3.3.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.4.m4.3.3.1.1.1.1">
              superscript
             </csymbol>
             <ci id="S4.SS3.p1.4.m4.3.3.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.4.m4.3.3.1.1.1.1.2.2">
              𝐲
             </ci>
             <ci id="S4.SS3.p1.4.m4.3.3.1.1.1.1.2.3a.cmml" xref="S4.SS3.p1.4.m4.3.3.1.1.1.1.2.3">
              <mtext id="S4.SS3.p1.4.m4.3.3.1.1.1.1.2.3.cmml" mathsize="70%" xref="S4.SS3.p1.4.m4.3.3.1.1.1.1.2.3">
               test
              </mtext>
             </ci>
            </apply>
            <ci id="S4.SS3.p1.4.m4.3.3.1.1.1.1.3.cmml" xref="S4.SS3.p1.4.m4.3.3.1.1.1.1.3">
             𝑖
            </ci>
           </apply>
          </interval>
         </apply>
         <apply id="S4.SS3.p1.4.m4.4.4.2.cmml" xref="S4.SS3.p1.4.m4.4.4.2">
          <times id="S4.SS3.p1.4.m4.4.4.2.2.cmml" xref="S4.SS3.p1.4.m4.4.4.2.2">
          </times>
          <ci id="S4.SS3.p1.4.m4.4.4.2.3.cmml" xref="S4.SS3.p1.4.m4.4.4.2.3">
           𝑟
          </ci>
          <interval closure="open" id="S4.SS3.p1.4.m4.4.4.2.1.2.cmml" xref="S4.SS3.p1.4.m4.4.4.2.1.1">
           <ci id="S4.SS3.p1.4.m4.2.2.cmml" xref="S4.SS3.p1.4.m4.2.2">
            𝐱
           </ci>
           <apply id="S4.SS3.p1.4.m4.4.4.2.1.1.1.cmml" xref="S4.SS3.p1.4.m4.4.4.2.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.4.4.2.1.1.1.1.cmml" xref="S4.SS3.p1.4.m4.4.4.2.1.1.1">
             superscript
            </csymbol>
            <ci id="S4.SS3.p1.4.m4.4.4.2.1.1.1.2.cmml" xref="S4.SS3.p1.4.m4.4.4.2.1.1.1.2">
             𝐲
            </ci>
            <times id="S4.SS3.p1.4.m4.4.4.2.1.1.1.3.cmml" xref="S4.SS3.p1.4.m4.4.4.2.1.1.1.3">
            </times>
           </apply>
          </interval>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.4c">
        r(\mathbf{x},\mathbf{y}^{\text{test}}_{i})=r(\mathbf{x},\mathbf{y}^{*})
       </annotation>
      </semantics>
     </math>
     . This protocol invokes queries to the reward function after each turn in the rollout. Since several reward function queries are performed, we refer to this approach as
     <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.4.1">
      “with oracle”
     </span>
     .
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS3.p2">
    <p class="ltx_p" id="S4.SS3.p2.3">
     RISE can also be run in a mode that avoids the need to query the answer checker or the reward function within a rollout. In this case, we run full-length rollouts by forcing the model to retry, ignoring the correctness of the response. We then utilize a self-consistency mechanism
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib51" title="">
       51
      </a>
      ]
     </cite>
     based on majority voting to decide the candidate response at the end of each turn. Concretely, at the end of each turn
     <math alttext="j" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1">
      <semantics id="S4.SS3.p2.1.m1.1a">
       <mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">
        j
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b">
        <ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">
         𝑗
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">
        j
       </annotation>
      </semantics>
     </math>
     , we identify the response by running a majority vote over all response candidates from the previous turns (
     <math alttext="\mathrm{maj}\left(\mathbf{y}^{\text{test}}_{1},\mathbf{y}^{\text{test}}_{2},\cdots,\mathbf{y}^{\text{test}}_{j}\right)" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.4">
      <semantics id="S4.SS3.p2.2.m2.4a">
       <mrow id="S4.SS3.p2.2.m2.4.4" xref="S4.SS3.p2.2.m2.4.4.cmml">
        <mi id="S4.SS3.p2.2.m2.4.4.5" xref="S4.SS3.p2.2.m2.4.4.5.cmml">
         maj
        </mi>
        <mo id="S4.SS3.p2.2.m2.4.4.4" lspace="0em" rspace="0em" xref="S4.SS3.p2.2.m2.4.4.4.cmml">
         ​
        </mo>
        <mrow id="S4.SS3.p2.2.m2.4.4.3.3" xref="S4.SS3.p2.2.m2.4.4.3.4.cmml">
         <mo id="S4.SS3.p2.2.m2.4.4.3.3.4" xref="S4.SS3.p2.2.m2.4.4.3.4.cmml">
          (
         </mo>
         <msubsup id="S4.SS3.p2.2.m2.2.2.1.1.1" xref="S4.SS3.p2.2.m2.2.2.1.1.1.cmml">
          <mi id="S4.SS3.p2.2.m2.2.2.1.1.1.2.2" xref="S4.SS3.p2.2.m2.2.2.1.1.1.2.2.cmml">
           𝐲
          </mi>
          <mn id="S4.SS3.p2.2.m2.2.2.1.1.1.3" xref="S4.SS3.p2.2.m2.2.2.1.1.1.3.cmml">
           1
          </mn>
          <mtext id="S4.SS3.p2.2.m2.2.2.1.1.1.2.3" xref="S4.SS3.p2.2.m2.2.2.1.1.1.2.3a.cmml">
           test
          </mtext>
         </msubsup>
         <mo id="S4.SS3.p2.2.m2.4.4.3.3.5" xref="S4.SS3.p2.2.m2.4.4.3.4.cmml">
          ,
         </mo>
         <msubsup id="S4.SS3.p2.2.m2.3.3.2.2.2" xref="S4.SS3.p2.2.m2.3.3.2.2.2.cmml">
          <mi id="S4.SS3.p2.2.m2.3.3.2.2.2.2.2" xref="S4.SS3.p2.2.m2.3.3.2.2.2.2.2.cmml">
           𝐲
          </mi>
          <mn id="S4.SS3.p2.2.m2.3.3.2.2.2.3" xref="S4.SS3.p2.2.m2.3.3.2.2.2.3.cmml">
           2
          </mn>
          <mtext id="S4.SS3.p2.2.m2.3.3.2.2.2.2.3" xref="S4.SS3.p2.2.m2.3.3.2.2.2.2.3a.cmml">
           test
          </mtext>
         </msubsup>
         <mo id="S4.SS3.p2.2.m2.4.4.3.3.6" xref="S4.SS3.p2.2.m2.4.4.3.4.cmml">
          ,
         </mo>
         <mi id="S4.SS3.p2.2.m2.1.1" mathvariant="normal" xref="S4.SS3.p2.2.m2.1.1.cmml">
          ⋯
         </mi>
         <mo id="S4.SS3.p2.2.m2.4.4.3.3.7" xref="S4.SS3.p2.2.m2.4.4.3.4.cmml">
          ,
         </mo>
         <msubsup id="S4.SS3.p2.2.m2.4.4.3.3.3" xref="S4.SS3.p2.2.m2.4.4.3.3.3.cmml">
          <mi id="S4.SS3.p2.2.m2.4.4.3.3.3.2.2" xref="S4.SS3.p2.2.m2.4.4.3.3.3.2.2.cmml">
           𝐲
          </mi>
          <mi id="S4.SS3.p2.2.m2.4.4.3.3.3.3" xref="S4.SS3.p2.2.m2.4.4.3.3.3.3.cmml">
           j
          </mi>
          <mtext id="S4.SS3.p2.2.m2.4.4.3.3.3.2.3" xref="S4.SS3.p2.2.m2.4.4.3.3.3.2.3a.cmml">
           test
          </mtext>
         </msubsup>
         <mo id="S4.SS3.p2.2.m2.4.4.3.3.8" xref="S4.SS3.p2.2.m2.4.4.3.4.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.4b">
        <apply id="S4.SS3.p2.2.m2.4.4.cmml" xref="S4.SS3.p2.2.m2.4.4">
         <times id="S4.SS3.p2.2.m2.4.4.4.cmml" xref="S4.SS3.p2.2.m2.4.4.4">
         </times>
         <ci id="S4.SS3.p2.2.m2.4.4.5.cmml" xref="S4.SS3.p2.2.m2.4.4.5">
          maj
         </ci>
         <vector id="S4.SS3.p2.2.m2.4.4.3.4.cmml" xref="S4.SS3.p2.2.m2.4.4.3.3">
          <apply id="S4.SS3.p2.2.m2.2.2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.2.2.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS3.p2.2.m2.2.2.1.1.1">
            subscript
           </csymbol>
           <apply id="S4.SS3.p2.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS3.p2.2.m2.2.2.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.2.2.1.1.1.2.1.cmml" xref="S4.SS3.p2.2.m2.2.2.1.1.1">
             superscript
            </csymbol>
            <ci id="S4.SS3.p2.2.m2.2.2.1.1.1.2.2.cmml" xref="S4.SS3.p2.2.m2.2.2.1.1.1.2.2">
             𝐲
            </ci>
            <ci id="S4.SS3.p2.2.m2.2.2.1.1.1.2.3a.cmml" xref="S4.SS3.p2.2.m2.2.2.1.1.1.2.3">
             <mtext id="S4.SS3.p2.2.m2.2.2.1.1.1.2.3.cmml" mathsize="70%" xref="S4.SS3.p2.2.m2.2.2.1.1.1.2.3">
              test
             </mtext>
            </ci>
           </apply>
           <cn id="S4.SS3.p2.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS3.p2.2.m2.2.2.1.1.1.3">
            1
           </cn>
          </apply>
          <apply id="S4.SS3.p2.2.m2.3.3.2.2.2.cmml" xref="S4.SS3.p2.2.m2.3.3.2.2.2">
           <csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS3.p2.2.m2.3.3.2.2.2">
            subscript
           </csymbol>
           <apply id="S4.SS3.p2.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS3.p2.2.m2.3.3.2.2.2">
            <csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.3.3.2.2.2.2.1.cmml" xref="S4.SS3.p2.2.m2.3.3.2.2.2">
             superscript
            </csymbol>
            <ci id="S4.SS3.p2.2.m2.3.3.2.2.2.2.2.cmml" xref="S4.SS3.p2.2.m2.3.3.2.2.2.2.2">
             𝐲
            </ci>
            <ci id="S4.SS3.p2.2.m2.3.3.2.2.2.2.3a.cmml" xref="S4.SS3.p2.2.m2.3.3.2.2.2.2.3">
             <mtext id="S4.SS3.p2.2.m2.3.3.2.2.2.2.3.cmml" mathsize="70%" xref="S4.SS3.p2.2.m2.3.3.2.2.2.2.3">
              test
             </mtext>
            </ci>
           </apply>
           <cn id="S4.SS3.p2.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS3.p2.2.m2.3.3.2.2.2.3">
            2
           </cn>
          </apply>
          <ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">
           ⋯
          </ci>
          <apply id="S4.SS3.p2.2.m2.4.4.3.3.3.cmml" xref="S4.SS3.p2.2.m2.4.4.3.3.3">
           <csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.4.4.3.3.3.1.cmml" xref="S4.SS3.p2.2.m2.4.4.3.3.3">
            subscript
           </csymbol>
           <apply id="S4.SS3.p2.2.m2.4.4.3.3.3.2.cmml" xref="S4.SS3.p2.2.m2.4.4.3.3.3">
            <csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.4.4.3.3.3.2.1.cmml" xref="S4.SS3.p2.2.m2.4.4.3.3.3">
             superscript
            </csymbol>
            <ci id="S4.SS3.p2.2.m2.4.4.3.3.3.2.2.cmml" xref="S4.SS3.p2.2.m2.4.4.3.3.3.2.2">
             𝐲
            </ci>
            <ci id="S4.SS3.p2.2.m2.4.4.3.3.3.2.3a.cmml" xref="S4.SS3.p2.2.m2.4.4.3.3.3.2.3">
             <mtext id="S4.SS3.p2.2.m2.4.4.3.3.3.2.3.cmml" mathsize="70%" xref="S4.SS3.p2.2.m2.4.4.3.3.3.2.3">
              test
             </mtext>
            </ci>
           </apply>
           <ci id="S4.SS3.p2.2.m2.4.4.3.3.3.3.cmml" xref="S4.SS3.p2.2.m2.4.4.3.3.3.3">
            𝑗
           </ci>
          </apply>
         </vector>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.4c">
        \mathrm{maj}\left(\mathbf{y}^{\text{test}}_{1},\mathbf{y}^{\text{test}}_{2},\cdots,\mathbf{y}^{\text{test}}_{j}\right)
       </annotation>
      </semantics>
     </math>
     ), including turn
     <math alttext="j" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1">
      <semantics id="S4.SS3.p2.3.m3.1a">
       <mi id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">
        j
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b">
        <ci id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">
         𝑗
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">
        j
       </annotation>
      </semantics>
     </math>
     . We call this
     <span class="ltx_text ltx_font_bold" id="S4.SS3.p2.3.1">
      “without oracle”
     </span>
     . A schematic illustration of these approach is shown in Figure
     <a class="ltx_ref" href="#S4.F3" title="Figure 3 ‣ 4.3 Inference at Deployment Time ‣ 4 RISE: Recursive Introspection for Self-Improvement ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     . Most of our evaluations use no oracle.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS3.p3">
    <p class="ltx_p" id="S4.SS3.p3.7">
     At iteration
     <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1">
      <semantics id="S4.SS3.p3.1.m1.1a">
       <mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b">
        <ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">
        k
       </annotation>
      </semantics>
     </math>
     , since the agent is able to improve its own response from
     <math alttext="j" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1">
      <semantics id="S4.SS3.p3.2.m2.1a">
       <mi id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">
        j
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b">
        <ci id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">
         𝑗
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">
        j
       </annotation>
      </semantics>
     </math>
     to
     <math alttext="j+1" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.1">
      <semantics id="S4.SS3.p3.3.m3.1a">
       <mrow id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">
        <mi id="S4.SS3.p3.3.m3.1.1.2" xref="S4.SS3.p3.3.m3.1.1.2.cmml">
         j
        </mi>
        <mo id="S4.SS3.p3.3.m3.1.1.1" xref="S4.SS3.p3.3.m3.1.1.1.cmml">
         +
        </mo>
        <mn id="S4.SS3.p3.3.m3.1.1.3" xref="S4.SS3.p3.3.m3.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b">
        <apply id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">
         <plus id="S4.SS3.p3.3.m3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1">
         </plus>
         <ci id="S4.SS3.p3.3.m3.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.2">
          𝑗
         </ci>
         <cn id="S4.SS3.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.SS3.p3.3.m3.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">
        j+1
       </annotation>
      </semantics>
     </math>
     when
     <math alttext="j\leq k" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m4.1">
      <semantics id="S4.SS3.p3.4.m4.1a">
       <mrow id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml">
        <mi id="S4.SS3.p3.4.m4.1.1.2" xref="S4.SS3.p3.4.m4.1.1.2.cmml">
         j
        </mi>
        <mo id="S4.SS3.p3.4.m4.1.1.1" xref="S4.SS3.p3.4.m4.1.1.1.cmml">
         ≤
        </mo>
        <mi id="S4.SS3.p3.4.m4.1.1.3" xref="S4.SS3.p3.4.m4.1.1.3.cmml">
         k
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b">
        <apply id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">
         <leq id="S4.SS3.p3.4.m4.1.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1.1">
         </leq>
         <ci id="S4.SS3.p3.4.m4.1.1.2.cmml" xref="S4.SS3.p3.4.m4.1.1.2">
          𝑗
         </ci>
         <ci id="S4.SS3.p3.4.m4.1.1.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3">
          𝑘
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">
        j\leq k
       </annotation>
      </semantics>
     </math>
     , to avoid test time distribution shift, in both modes, we use a size
     <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p3.5.m5.1">
      <semantics id="S4.SS3.p3.5.m5.1a">
       <mi id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b">
        <ci id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">
        k
       </annotation>
      </semantics>
     </math>
     shift window to store the most recent conversation history when the turn number
     <math alttext="j" class="ltx_Math" display="inline" id="S4.SS3.p3.6.m6.1">
      <semantics id="S4.SS3.p3.6.m6.1a">
       <mi id="S4.SS3.p3.6.m6.1.1" xref="S4.SS3.p3.6.m6.1.1.cmml">
        j
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.1b">
        <ci id="S4.SS3.p3.6.m6.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1">
         𝑗
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.1c">
        j
       </annotation>
      </semantics>
     </math>
     is larger than the iteration number
     <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p3.7.m7.1">
      <semantics id="S4.SS3.p3.7.m7.1a">
       <mi id="S4.SS3.p3.7.m7.1.1" xref="S4.SS3.p3.7.m7.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m7.1b">
        <ci id="S4.SS3.p3.7.m7.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p3.7.m7.1c">
        k
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
   <figure class="ltx_figure" id="S4.F3">
    <div class="ltx_flex_figure">
     <div class="ltx_flex_cell ltx_flex_size_2">
      <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="216" id="S4.F3.g1" src="/html/2407.18219/assets/inference_w_oracle.png" width="269"/>
     </div>
     <div class="ltx_flex_cell ltx_flex_size_2">
      <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="214" id="S4.F3.g2" src="/html/2407.18219/assets/inference_wo_oracle.png" width="269"/>
     </div>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="S4.F3.9.4.1" style="font-size:90%;">
       Figure 3
      </span>
      :
     </span>
     <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S4.F3.10.5" style="font-size:80%;">
      RISE Inference.
     </em>
     <span class="ltx_text" id="S4.F3.6.3" style="font-size:80%;">
      There are two ways to query the model trained via RISE upon inference:
      <span class="ltx_text ltx_font_bold" id="S4.F3.6.3.1">
       (1)
      </span>
      <span class="ltx_text ltx_font_bold" id="S4.F3.6.3.2">
       with oracle (
       <em class="ltx_emph ltx_font_italic" id="S4.F3.6.3.2.1">
        Left
       </em>
       )
      </span>
      : each time the model improves its response, it is allowed to check its answer against an environment and terminate early as soon as a correct answer is found; or
      <span class="ltx_text ltx_font_bold" id="S4.F3.6.3.3">
       (2)
      </span>
      <span class="ltx_text ltx_font_bold" id="S4.F3.6.3.4">
       without oracle (
       <em class="ltx_emph ltx_font_italic" id="S4.F3.6.3.4.1">
        Right
       </em>
       )
      </span>
      : we ask the model to sequentially revise its own responses j times, and perform majority voting on all candidate outputs from different turns to obtain the final response. If the turn number
      <math alttext="j" class="ltx_Math" display="inline" id="S4.F3.4.1.m1.1">
       <semantics id="S4.F3.4.1.m1.1b">
        <mi id="S4.F3.4.1.m1.1.1" xref="S4.F3.4.1.m1.1.1.cmml">
         j
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.F3.4.1.m1.1c">
         <ci id="S4.F3.4.1.m1.1.1.cmml" xref="S4.F3.4.1.m1.1.1">
          𝑗
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.F3.4.1.m1.1d">
         j
        </annotation>
       </semantics>
      </math>
      is larger than the iteration number
      <math alttext="k" class="ltx_Math" display="inline" id="S4.F3.5.2.m2.1">
       <semantics id="S4.F3.5.2.m2.1b">
        <mi id="S4.F3.5.2.m2.1.1" xref="S4.F3.5.2.m2.1.1.cmml">
         k
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.F3.5.2.m2.1c">
         <ci id="S4.F3.5.2.m2.1.1.cmml" xref="S4.F3.5.2.m2.1.1">
          𝑘
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.F3.5.2.m2.1d">
         k
        </annotation>
       </semantics>
      </math>
      , the agent only keeps the most recent history with
      <math alttext="k" class="ltx_Math" display="inline" id="S4.F3.6.3.m3.1">
       <semantics id="S4.F3.6.3.m3.1b">
        <mi id="S4.F3.6.3.m3.1.1" xref="S4.F3.6.3.m3.1.1.cmml">
         k
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.F3.6.3.m3.1c">
         <ci id="S4.F3.6.3.m3.1.1.cmml" xref="S4.F3.6.3.m3.1.1">
          𝑘
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.F3.6.3.m3.1d">
         k
        </annotation>
       </semantics>
      </math>
      interactions to avoid test-time distribution shift.
     </span>
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="S4.SS4">
   <h4 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.4
    </span>
    Practical Algorithm and Implementation Details
   </h4>
   <div class="ltx_para ltx_noindent" id="S4.SS4.p1">
    <p class="ltx_p" id="S4.SS4.p1.1">
     A complete algorithmic pseudocode for each approach is shown in Appendix
     <a class="ltx_ref" href="#A3" title="Appendix C Pseudocode ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       C
      </span>
     </a>
     . We trained 7B models via RISE and found that these models often could not adhere to response style and instructions for improving their responses when generating on-policy data. As a result, before running on-policy data collection, we find it often useful to run an initial phase of supervised fine-tuning on in-domain, multi-turn rollouts generated from a capable model to provide style and instruction-following information to the learner. We call this the “knowledge boosting” stage. We then run on-policy rollouts starting from a boosted model. In each iteration, we generate 1 trajectory for each unique problem. We then run fine-tuning, with hyperparameters and details in Appendix
     <a class="ltx_ref" href="#A4" title="Appendix D Experimental Details ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       D
      </span>
     </a>
     . For iterative fine-tuning, we find that starting from the
     <em class="ltx_emph ltx_font_italic" id="S4.SS4.p1.1.1">
      base
     </em>
     model but training on data from all iterations thus far is more beneficial than continued fine-tuning from the checkpoint obtained in the previous iteration.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S5" lang="en">
  <h3 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   When and Why is Self-Improvement Over Turns Possible?
  </h3>
  <div class="ltx_para ltx_noindent" id="S5.p1">
   <p class="ltx_p" id="S5.p1.1">
    A natural question to ask is why self-improvement with
    <span class="ltx_text ltx_font_bold" id="S5.p1.1.1">
     RISE
    </span>
    even possible. One might surmise that the model may simply not have enough knowledge to correct its
    <em class="ltx_emph ltx_font_italic" id="S5.p1.1.2">
     own
    </em>
    mistakes if it is unable to correctly answer the problem in the first turn. Then, why is it possible to teach the model to correct its own mistakes? In this section, we provide the reason why this kind of self-improvement is possible, supported with empirical evidence to justify our hypotheses.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S5.p2">
   <p class="ltx_p" id="S5.p2.5">
    Iteratively teaching a model how to make updates on a given response can be crucial when representing the target distribution
    <math alttext="p^{*}(\mathbf{y}|\mathbf{x})" class="ltx_Math" display="inline" id="S5.p2.1.m1.1">
     <semantics id="S5.p2.1.m1.1a">
      <mrow id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml">
       <msup id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3.cmml">
        <mi id="S5.p2.1.m1.1.1.3.2" xref="S5.p2.1.m1.1.1.3.2.cmml">
         p
        </mi>
        <mo id="S5.p2.1.m1.1.1.3.3" xref="S5.p2.1.m1.1.1.3.3.cmml">
         ∗
        </mo>
       </msup>
       <mo id="S5.p2.1.m1.1.1.2" lspace="0em" rspace="0em" xref="S5.p2.1.m1.1.1.2.cmml">
        ​
       </mo>
       <mrow id="S5.p2.1.m1.1.1.1.1" xref="S5.p2.1.m1.1.1.1.1.1.cmml">
        <mo id="S5.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S5.p2.1.m1.1.1.1.1.1.cmml">
         (
        </mo>
        <mrow id="S5.p2.1.m1.1.1.1.1.1" xref="S5.p2.1.m1.1.1.1.1.1.cmml">
         <mi id="S5.p2.1.m1.1.1.1.1.1.2" xref="S5.p2.1.m1.1.1.1.1.1.2.cmml">
          𝐲
         </mi>
         <mo fence="false" id="S5.p2.1.m1.1.1.1.1.1.1" xref="S5.p2.1.m1.1.1.1.1.1.1.cmml">
          |
         </mo>
         <mi id="S5.p2.1.m1.1.1.1.1.1.3" xref="S5.p2.1.m1.1.1.1.1.1.3.cmml">
          𝐱
         </mi>
        </mrow>
        <mo id="S5.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S5.p2.1.m1.1.1.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b">
       <apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1">
        <times id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">
        </times>
        <apply id="S5.p2.1.m1.1.1.3.cmml" xref="S5.p2.1.m1.1.1.3">
         <csymbol cd="ambiguous" id="S5.p2.1.m1.1.1.3.1.cmml" xref="S5.p2.1.m1.1.1.3">
          superscript
         </csymbol>
         <ci id="S5.p2.1.m1.1.1.3.2.cmml" xref="S5.p2.1.m1.1.1.3.2">
          𝑝
         </ci>
         <times id="S5.p2.1.m1.1.1.3.3.cmml" xref="S5.p2.1.m1.1.1.3.3">
         </times>
        </apply>
        <apply id="S5.p2.1.m1.1.1.1.1.1.cmml" xref="S5.p2.1.m1.1.1.1.1">
         <csymbol cd="latexml" id="S5.p2.1.m1.1.1.1.1.1.1.cmml" xref="S5.p2.1.m1.1.1.1.1.1.1">
          conditional
         </csymbol>
         <ci id="S5.p2.1.m1.1.1.1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.1.1.1.2">
          𝐲
         </ci>
         <ci id="S5.p2.1.m1.1.1.1.1.1.3.cmml" xref="S5.p2.1.m1.1.1.1.1.1.3">
          𝐱
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">
       p^{*}(\mathbf{y}|\mathbf{x})
      </annotation>
     </semantics>
    </math>
    requires more capacity than what the model
    <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S5.p2.2.m2.1">
     <semantics id="S5.p2.2.m2.1a">
      <msub id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml">
       <mi id="S5.p2.2.m2.1.1.2" xref="S5.p2.2.m2.1.1.2.cmml">
        π
       </mi>
       <mi id="S5.p2.2.m2.1.1.3" xref="S5.p2.2.m2.1.1.3.cmml">
        θ
       </mi>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b">
       <apply id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1">
        <csymbol cd="ambiguous" id="S5.p2.2.m2.1.1.1.cmml" xref="S5.p2.2.m2.1.1">
         subscript
        </csymbol>
        <ci id="S5.p2.2.m2.1.1.2.cmml" xref="S5.p2.2.m2.1.1.2">
         𝜋
        </ci>
        <ci id="S5.p2.2.m2.1.1.3.cmml" xref="S5.p2.2.m2.1.1.3">
         𝜃
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">
       \pi_{\theta}
      </annotation>
     </semantics>
    </math>
    affords by conditioning on only the input prompt tokens. When the target distribution requires greater capacity, learning a sequence of conditionals,
    <math alttext="\pi_{\theta}(\mathbf{y}_{i+1}|\mathbf{x},\mathbf{y}_{0:i})" class="ltx_Math" display="inline" id="S5.p2.3.m3.2">
     <semantics id="S5.p2.3.m3.2a">
      <mrow id="S5.p2.3.m3.2.2" xref="S5.p2.3.m3.2.2.cmml">
       <msub id="S5.p2.3.m3.2.2.3" xref="S5.p2.3.m3.2.2.3.cmml">
        <mi id="S5.p2.3.m3.2.2.3.2" xref="S5.p2.3.m3.2.2.3.2.cmml">
         π
        </mi>
        <mi id="S5.p2.3.m3.2.2.3.3" xref="S5.p2.3.m3.2.2.3.3.cmml">
         θ
        </mi>
       </msub>
       <mo id="S5.p2.3.m3.2.2.2" lspace="0em" rspace="0em" xref="S5.p2.3.m3.2.2.2.cmml">
        ​
       </mo>
       <mrow id="S5.p2.3.m3.2.2.1.1" xref="S5.p2.3.m3.2.2.1.1.1.cmml">
        <mo id="S5.p2.3.m3.2.2.1.1.2" stretchy="false" xref="S5.p2.3.m3.2.2.1.1.1.cmml">
         (
        </mo>
        <mrow id="S5.p2.3.m3.2.2.1.1.1" xref="S5.p2.3.m3.2.2.1.1.1.cmml">
         <msub id="S5.p2.3.m3.2.2.1.1.1.3" xref="S5.p2.3.m3.2.2.1.1.1.3.cmml">
          <mi id="S5.p2.3.m3.2.2.1.1.1.3.2" xref="S5.p2.3.m3.2.2.1.1.1.3.2.cmml">
           𝐲
          </mi>
          <mrow id="S5.p2.3.m3.2.2.1.1.1.3.3" xref="S5.p2.3.m3.2.2.1.1.1.3.3.cmml">
           <mi id="S5.p2.3.m3.2.2.1.1.1.3.3.2" xref="S5.p2.3.m3.2.2.1.1.1.3.3.2.cmml">
            i
           </mi>
           <mo id="S5.p2.3.m3.2.2.1.1.1.3.3.1" xref="S5.p2.3.m3.2.2.1.1.1.3.3.1.cmml">
            +
           </mo>
           <mn id="S5.p2.3.m3.2.2.1.1.1.3.3.3" xref="S5.p2.3.m3.2.2.1.1.1.3.3.3.cmml">
            1
           </mn>
          </mrow>
         </msub>
         <mo fence="false" id="S5.p2.3.m3.2.2.1.1.1.2" xref="S5.p2.3.m3.2.2.1.1.1.2.cmml">
          |
         </mo>
         <mrow id="S5.p2.3.m3.2.2.1.1.1.1.1" xref="S5.p2.3.m3.2.2.1.1.1.1.2.cmml">
          <mi id="S5.p2.3.m3.1.1" xref="S5.p2.3.m3.1.1.cmml">
           𝐱
          </mi>
          <mo id="S5.p2.3.m3.2.2.1.1.1.1.1.2" xref="S5.p2.3.m3.2.2.1.1.1.1.2.cmml">
           ,
          </mo>
          <msub id="S5.p2.3.m3.2.2.1.1.1.1.1.1" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1.cmml">
           <mi id="S5.p2.3.m3.2.2.1.1.1.1.1.1.2" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1.2.cmml">
            𝐲
           </mi>
           <mrow id="S5.p2.3.m3.2.2.1.1.1.1.1.1.3" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.cmml">
            <mn id="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.2" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.2.cmml">
             0
            </mn>
            <mo id="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.1.cmml">
             :
            </mo>
            <mi id="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.3" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.3.cmml">
             i
            </mi>
           </mrow>
          </msub>
         </mrow>
        </mrow>
        <mo id="S5.p2.3.m3.2.2.1.1.3" stretchy="false" xref="S5.p2.3.m3.2.2.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p2.3.m3.2b">
       <apply id="S5.p2.3.m3.2.2.cmml" xref="S5.p2.3.m3.2.2">
        <times id="S5.p2.3.m3.2.2.2.cmml" xref="S5.p2.3.m3.2.2.2">
        </times>
        <apply id="S5.p2.3.m3.2.2.3.cmml" xref="S5.p2.3.m3.2.2.3">
         <csymbol cd="ambiguous" id="S5.p2.3.m3.2.2.3.1.cmml" xref="S5.p2.3.m3.2.2.3">
          subscript
         </csymbol>
         <ci id="S5.p2.3.m3.2.2.3.2.cmml" xref="S5.p2.3.m3.2.2.3.2">
          𝜋
         </ci>
         <ci id="S5.p2.3.m3.2.2.3.3.cmml" xref="S5.p2.3.m3.2.2.3.3">
          𝜃
         </ci>
        </apply>
        <apply id="S5.p2.3.m3.2.2.1.1.1.cmml" xref="S5.p2.3.m3.2.2.1.1">
         <csymbol cd="latexml" id="S5.p2.3.m3.2.2.1.1.1.2.cmml" xref="S5.p2.3.m3.2.2.1.1.1.2">
          conditional
         </csymbol>
         <apply id="S5.p2.3.m3.2.2.1.1.1.3.cmml" xref="S5.p2.3.m3.2.2.1.1.1.3">
          <csymbol cd="ambiguous" id="S5.p2.3.m3.2.2.1.1.1.3.1.cmml" xref="S5.p2.3.m3.2.2.1.1.1.3">
           subscript
          </csymbol>
          <ci id="S5.p2.3.m3.2.2.1.1.1.3.2.cmml" xref="S5.p2.3.m3.2.2.1.1.1.3.2">
           𝐲
          </ci>
          <apply id="S5.p2.3.m3.2.2.1.1.1.3.3.cmml" xref="S5.p2.3.m3.2.2.1.1.1.3.3">
           <plus id="S5.p2.3.m3.2.2.1.1.1.3.3.1.cmml" xref="S5.p2.3.m3.2.2.1.1.1.3.3.1">
           </plus>
           <ci id="S5.p2.3.m3.2.2.1.1.1.3.3.2.cmml" xref="S5.p2.3.m3.2.2.1.1.1.3.3.2">
            𝑖
           </ci>
           <cn id="S5.p2.3.m3.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S5.p2.3.m3.2.2.1.1.1.3.3.3">
            1
           </cn>
          </apply>
         </apply>
         <list id="S5.p2.3.m3.2.2.1.1.1.1.2.cmml" xref="S5.p2.3.m3.2.2.1.1.1.1.1">
          <ci id="S5.p2.3.m3.1.1.cmml" xref="S5.p2.3.m3.1.1">
           𝐱
          </ci>
          <apply id="S5.p2.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S5.p2.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S5.p2.3.m3.2.2.1.1.1.1.1.1.2.cmml" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1.2">
            𝐲
           </ci>
           <apply id="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.cmml" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1.3">
            <ci id="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.1.cmml" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.1">
             :
            </ci>
            <cn id="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.2">
             0
            </cn>
            <ci id="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.3.cmml" xref="S5.p2.3.m3.2.2.1.1.1.1.1.1.3.3">
             𝑖
            </ci>
           </apply>
          </apply>
         </list>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p2.3.m3.2c">
       \pi_{\theta}(\mathbf{y}_{i+1}|\mathbf{x},\mathbf{y}_{0:i})
      </annotation>
     </semantics>
    </math>
    followed by marginalization is expected to induce a more flexible marginal distribution over
    <math alttext="\mathbf{y}_{T}" class="ltx_Math" display="inline" id="S5.p2.4.m4.1">
     <semantics id="S5.p2.4.m4.1a">
      <msub id="S5.p2.4.m4.1.1" xref="S5.p2.4.m4.1.1.cmml">
       <mi id="S5.p2.4.m4.1.1.2" xref="S5.p2.4.m4.1.1.2.cmml">
        𝐲
       </mi>
       <mi id="S5.p2.4.m4.1.1.3" xref="S5.p2.4.m4.1.1.3.cmml">
        T
       </mi>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S5.p2.4.m4.1b">
       <apply id="S5.p2.4.m4.1.1.cmml" xref="S5.p2.4.m4.1.1">
        <csymbol cd="ambiguous" id="S5.p2.4.m4.1.1.1.cmml" xref="S5.p2.4.m4.1.1">
         subscript
        </csymbol>
        <ci id="S5.p2.4.m4.1.1.2.cmml" xref="S5.p2.4.m4.1.1.2">
         𝐲
        </ci>
        <ci id="S5.p2.4.m4.1.1.3.cmml" xref="S5.p2.4.m4.1.1.3">
         𝑇
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p2.4.m4.1c">
       \mathbf{y}_{T}
      </annotation>
     </semantics>
    </math>
    given
    <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S5.p2.5.m5.1">
     <semantics id="S5.p2.5.m5.1a">
      <mi id="S5.p2.5.m5.1.1" xref="S5.p2.5.m5.1.1.cmml">
       𝐱
      </mi>
      <annotation-xml encoding="MathML-Content" id="S5.p2.5.m5.1b">
       <ci id="S5.p2.5.m5.1.1.cmml" xref="S5.p2.5.m5.1.1">
        𝐱
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p2.5.m5.1c">
       \mathbf{x}
      </annotation>
     </semantics>
    </math>
    . This hypothesis is akin to the difference between diffusion models
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib42" title="">
      42
     </a>
     ]
    </cite>
    and variational autoencoders (VAEs)
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib25" title="">
      25
     </a>
     ]
    </cite>
    in image generation: iteratively fitting a sequence of generative distributions over intermediate noisy inputs in a diffusion model gives rise to a more flexible distribution
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib43" title="">
      43
     </a>
     ]
    </cite>
    than monolithic variational auto-encoding, even though diffusion models still utilize an evidence lower-bound objective(ELBO). While the diffusion process utilizes hand-designed noise schedules, RISE utilizes the base model itself to induce iterative improvements.
   </p>
  </div>
  <div class="ltx_para" id="S5.p3">
   <p class="ltx_p" id="S5.p3.7">
    To verify if this hypothesis is true, we tracked the training un-weighted, negative log-likelihood loss (NLL) values for the oracle response
    <math alttext="\mathbf{y}^{*}" class="ltx_Math" display="inline" id="S5.p3.1.m1.1">
     <semantics id="S5.p3.1.m1.1a">
      <msup id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml">
       <mi id="S5.p3.1.m1.1.1.2" xref="S5.p3.1.m1.1.1.2.cmml">
        𝐲
       </mi>
       <mo id="S5.p3.1.m1.1.1.3" xref="S5.p3.1.m1.1.1.3.cmml">
        ∗
       </mo>
      </msup>
      <annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b">
       <apply id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1">
        <csymbol cd="ambiguous" id="S5.p3.1.m1.1.1.1.cmml" xref="S5.p3.1.m1.1.1">
         superscript
        </csymbol>
        <ci id="S5.p3.1.m1.1.1.2.cmml" xref="S5.p3.1.m1.1.1.2">
         𝐲
        </ci>
        <times id="S5.p3.1.m1.1.1.3.cmml" xref="S5.p3.1.m1.1.1.3">
        </times>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">
       \mathbf{y}^{*}
      </annotation>
     </semantics>
    </math>
    given the input prompt
    <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S5.p3.2.m2.1">
     <semantics id="S5.p3.2.m2.1a">
      <mi id="S5.p3.2.m2.1.1" xref="S5.p3.2.m2.1.1.cmml">
       𝐱
      </mi>
      <annotation-xml encoding="MathML-Content" id="S5.p3.2.m2.1b">
       <ci id="S5.p3.2.m2.1.1.cmml" xref="S5.p3.2.m2.1.1">
        𝐱
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p3.2.m2.1c">
       \mathbf{x}
      </annotation>
     </semantics>
    </math>
    marginalized over intermediate steps in a multi-turn rollout, and compared it against the NLL values
    <math alttext="-\log p_{\theta}(\mathbf{y}^{*}|\mathbf{x})" class="ltx_Math" display="inline" id="S5.p3.3.m3.1">
     <semantics id="S5.p3.3.m3.1a">
      <mrow id="S5.p3.3.m3.1.1" xref="S5.p3.3.m3.1.1.cmml">
       <mo id="S5.p3.3.m3.1.1a" rspace="0.167em" xref="S5.p3.3.m3.1.1.cmml">
        −
       </mo>
       <mrow id="S5.p3.3.m3.1.1.1" xref="S5.p3.3.m3.1.1.1.cmml">
        <mrow id="S5.p3.3.m3.1.1.1.3" xref="S5.p3.3.m3.1.1.1.3.cmml">
         <mi id="S5.p3.3.m3.1.1.1.3.1" xref="S5.p3.3.m3.1.1.1.3.1.cmml">
          log
         </mi>
         <mo id="S5.p3.3.m3.1.1.1.3a" lspace="0.167em" xref="S5.p3.3.m3.1.1.1.3.cmml">
          ⁡
         </mo>
         <msub id="S5.p3.3.m3.1.1.1.3.2" xref="S5.p3.3.m3.1.1.1.3.2.cmml">
          <mi id="S5.p3.3.m3.1.1.1.3.2.2" xref="S5.p3.3.m3.1.1.1.3.2.2.cmml">
           p
          </mi>
          <mi id="S5.p3.3.m3.1.1.1.3.2.3" xref="S5.p3.3.m3.1.1.1.3.2.3.cmml">
           θ
          </mi>
         </msub>
        </mrow>
        <mo id="S5.p3.3.m3.1.1.1.2" lspace="0em" rspace="0em" xref="S5.p3.3.m3.1.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S5.p3.3.m3.1.1.1.1.1" xref="S5.p3.3.m3.1.1.1.1.1.1.cmml">
         <mo id="S5.p3.3.m3.1.1.1.1.1.2" stretchy="false" xref="S5.p3.3.m3.1.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S5.p3.3.m3.1.1.1.1.1.1" xref="S5.p3.3.m3.1.1.1.1.1.1.cmml">
          <msup id="S5.p3.3.m3.1.1.1.1.1.1.2" xref="S5.p3.3.m3.1.1.1.1.1.1.2.cmml">
           <mi id="S5.p3.3.m3.1.1.1.1.1.1.2.2" xref="S5.p3.3.m3.1.1.1.1.1.1.2.2.cmml">
            𝐲
           </mi>
           <mo id="S5.p3.3.m3.1.1.1.1.1.1.2.3" xref="S5.p3.3.m3.1.1.1.1.1.1.2.3.cmml">
            ∗
           </mo>
          </msup>
          <mo fence="false" id="S5.p3.3.m3.1.1.1.1.1.1.1" xref="S5.p3.3.m3.1.1.1.1.1.1.1.cmml">
           |
          </mo>
          <mi id="S5.p3.3.m3.1.1.1.1.1.1.3" xref="S5.p3.3.m3.1.1.1.1.1.1.3.cmml">
           𝐱
          </mi>
         </mrow>
         <mo id="S5.p3.3.m3.1.1.1.1.1.3" stretchy="false" xref="S5.p3.3.m3.1.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p3.3.m3.1b">
       <apply id="S5.p3.3.m3.1.1.cmml" xref="S5.p3.3.m3.1.1">
        <minus id="S5.p3.3.m3.1.1.2.cmml" xref="S5.p3.3.m3.1.1">
        </minus>
        <apply id="S5.p3.3.m3.1.1.1.cmml" xref="S5.p3.3.m3.1.1.1">
         <times id="S5.p3.3.m3.1.1.1.2.cmml" xref="S5.p3.3.m3.1.1.1.2">
         </times>
         <apply id="S5.p3.3.m3.1.1.1.3.cmml" xref="S5.p3.3.m3.1.1.1.3">
          <log id="S5.p3.3.m3.1.1.1.3.1.cmml" xref="S5.p3.3.m3.1.1.1.3.1">
          </log>
          <apply id="S5.p3.3.m3.1.1.1.3.2.cmml" xref="S5.p3.3.m3.1.1.1.3.2">
           <csymbol cd="ambiguous" id="S5.p3.3.m3.1.1.1.3.2.1.cmml" xref="S5.p3.3.m3.1.1.1.3.2">
            subscript
           </csymbol>
           <ci id="S5.p3.3.m3.1.1.1.3.2.2.cmml" xref="S5.p3.3.m3.1.1.1.3.2.2">
            𝑝
           </ci>
           <ci id="S5.p3.3.m3.1.1.1.3.2.3.cmml" xref="S5.p3.3.m3.1.1.1.3.2.3">
            𝜃
           </ci>
          </apply>
         </apply>
         <apply id="S5.p3.3.m3.1.1.1.1.1.1.cmml" xref="S5.p3.3.m3.1.1.1.1.1">
          <csymbol cd="latexml" id="S5.p3.3.m3.1.1.1.1.1.1.1.cmml" xref="S5.p3.3.m3.1.1.1.1.1.1.1">
           conditional
          </csymbol>
          <apply id="S5.p3.3.m3.1.1.1.1.1.1.2.cmml" xref="S5.p3.3.m3.1.1.1.1.1.1.2">
           <csymbol cd="ambiguous" id="S5.p3.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S5.p3.3.m3.1.1.1.1.1.1.2">
            superscript
           </csymbol>
           <ci id="S5.p3.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S5.p3.3.m3.1.1.1.1.1.1.2.2">
            𝐲
           </ci>
           <times id="S5.p3.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S5.p3.3.m3.1.1.1.1.1.1.2.3">
           </times>
          </apply>
          <ci id="S5.p3.3.m3.1.1.1.1.1.1.3.cmml" xref="S5.p3.3.m3.1.1.1.1.1.1.3">
           𝐱
          </ci>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p3.3.m3.1c">
       -\log p_{\theta}(\mathbf{y}^{*}|\mathbf{x})
      </annotation>
     </semantics>
    </math>
    attained by directly attempting to predict the final response in Figure
    <a class="ltx_ref" href="#S5.F5" title="Figure 5 ‣ 5 When and Why is Self-Improvement Over Turns Possible? ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      5
     </span>
    </a>
    (labeled as “Classic”). Concretely, we sampled 256 prompts
    <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S5.p3.4.m4.1">
     <semantics id="S5.p3.4.m4.1a">
      <mi id="S5.p3.4.m4.1.1" xref="S5.p3.4.m4.1.1.cmml">
       𝐱
      </mi>
      <annotation-xml encoding="MathML-Content" id="S5.p3.4.m4.1b">
       <ci id="S5.p3.4.m4.1.1.cmml" xref="S5.p3.4.m4.1.1">
        𝐱
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p3.4.m4.1c">
       \mathbf{x}
      </annotation>
     </semantics>
    </math>
    and their oracle responses
    <math alttext="\mathbf{y}^{*}" class="ltx_Math" display="inline" id="S5.p3.5.m5.1">
     <semantics id="S5.p3.5.m5.1a">
      <msup id="S5.p3.5.m5.1.1" xref="S5.p3.5.m5.1.1.cmml">
       <mi id="S5.p3.5.m5.1.1.2" xref="S5.p3.5.m5.1.1.2.cmml">
        𝐲
       </mi>
       <mo id="S5.p3.5.m5.1.1.3" xref="S5.p3.5.m5.1.1.3.cmml">
        ∗
       </mo>
      </msup>
      <annotation-xml encoding="MathML-Content" id="S5.p3.5.m5.1b">
       <apply id="S5.p3.5.m5.1.1.cmml" xref="S5.p3.5.m5.1.1">
        <csymbol cd="ambiguous" id="S5.p3.5.m5.1.1.1.cmml" xref="S5.p3.5.m5.1.1">
         superscript
        </csymbol>
        <ci id="S5.p3.5.m5.1.1.2.cmml" xref="S5.p3.5.m5.1.1.2">
         𝐲
        </ci>
        <times id="S5.p3.5.m5.1.1.3.cmml" xref="S5.p3.5.m5.1.1.3">
        </times>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p3.5.m5.1c">
       \mathbf{y}^{*}
      </annotation>
     </semantics>
    </math>
    and computed the average
    <math alttext="-\log p_{\theta}(\mathbf{y}^{*}|\mathbf{x})" class="ltx_Math" display="inline" id="S5.p3.6.m6.1">
     <semantics id="S5.p3.6.m6.1a">
      <mrow id="S5.p3.6.m6.1.1" xref="S5.p3.6.m6.1.1.cmml">
       <mo id="S5.p3.6.m6.1.1a" rspace="0.167em" xref="S5.p3.6.m6.1.1.cmml">
        −
       </mo>
       <mrow id="S5.p3.6.m6.1.1.1" xref="S5.p3.6.m6.1.1.1.cmml">
        <mrow id="S5.p3.6.m6.1.1.1.3" xref="S5.p3.6.m6.1.1.1.3.cmml">
         <mi id="S5.p3.6.m6.1.1.1.3.1" xref="S5.p3.6.m6.1.1.1.3.1.cmml">
          log
         </mi>
         <mo id="S5.p3.6.m6.1.1.1.3a" lspace="0.167em" xref="S5.p3.6.m6.1.1.1.3.cmml">
          ⁡
         </mo>
         <msub id="S5.p3.6.m6.1.1.1.3.2" xref="S5.p3.6.m6.1.1.1.3.2.cmml">
          <mi id="S5.p3.6.m6.1.1.1.3.2.2" xref="S5.p3.6.m6.1.1.1.3.2.2.cmml">
           p
          </mi>
          <mi id="S5.p3.6.m6.1.1.1.3.2.3" xref="S5.p3.6.m6.1.1.1.3.2.3.cmml">
           θ
          </mi>
         </msub>
        </mrow>
        <mo id="S5.p3.6.m6.1.1.1.2" lspace="0em" rspace="0em" xref="S5.p3.6.m6.1.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S5.p3.6.m6.1.1.1.1.1" xref="S5.p3.6.m6.1.1.1.1.1.1.cmml">
         <mo id="S5.p3.6.m6.1.1.1.1.1.2" stretchy="false" xref="S5.p3.6.m6.1.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S5.p3.6.m6.1.1.1.1.1.1" xref="S5.p3.6.m6.1.1.1.1.1.1.cmml">
          <msup id="S5.p3.6.m6.1.1.1.1.1.1.2" xref="S5.p3.6.m6.1.1.1.1.1.1.2.cmml">
           <mi id="S5.p3.6.m6.1.1.1.1.1.1.2.2" xref="S5.p3.6.m6.1.1.1.1.1.1.2.2.cmml">
            𝐲
           </mi>
           <mo id="S5.p3.6.m6.1.1.1.1.1.1.2.3" xref="S5.p3.6.m6.1.1.1.1.1.1.2.3.cmml">
            ∗
           </mo>
          </msup>
          <mo fence="false" id="S5.p3.6.m6.1.1.1.1.1.1.1" xref="S5.p3.6.m6.1.1.1.1.1.1.1.cmml">
           |
          </mo>
          <mi id="S5.p3.6.m6.1.1.1.1.1.1.3" xref="S5.p3.6.m6.1.1.1.1.1.1.3.cmml">
           𝐱
          </mi>
         </mrow>
         <mo id="S5.p3.6.m6.1.1.1.1.1.3" stretchy="false" xref="S5.p3.6.m6.1.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p3.6.m6.1b">
       <apply id="S5.p3.6.m6.1.1.cmml" xref="S5.p3.6.m6.1.1">
        <minus id="S5.p3.6.m6.1.1.2.cmml" xref="S5.p3.6.m6.1.1">
        </minus>
        <apply id="S5.p3.6.m6.1.1.1.cmml" xref="S5.p3.6.m6.1.1.1">
         <times id="S5.p3.6.m6.1.1.1.2.cmml" xref="S5.p3.6.m6.1.1.1.2">
         </times>
         <apply id="S5.p3.6.m6.1.1.1.3.cmml" xref="S5.p3.6.m6.1.1.1.3">
          <log id="S5.p3.6.m6.1.1.1.3.1.cmml" xref="S5.p3.6.m6.1.1.1.3.1">
          </log>
          <apply id="S5.p3.6.m6.1.1.1.3.2.cmml" xref="S5.p3.6.m6.1.1.1.3.2">
           <csymbol cd="ambiguous" id="S5.p3.6.m6.1.1.1.3.2.1.cmml" xref="S5.p3.6.m6.1.1.1.3.2">
            subscript
           </csymbol>
           <ci id="S5.p3.6.m6.1.1.1.3.2.2.cmml" xref="S5.p3.6.m6.1.1.1.3.2.2">
            𝑝
           </ci>
           <ci id="S5.p3.6.m6.1.1.1.3.2.3.cmml" xref="S5.p3.6.m6.1.1.1.3.2.3">
            𝜃
           </ci>
          </apply>
         </apply>
         <apply id="S5.p3.6.m6.1.1.1.1.1.1.cmml" xref="S5.p3.6.m6.1.1.1.1.1">
          <csymbol cd="latexml" id="S5.p3.6.m6.1.1.1.1.1.1.1.cmml" xref="S5.p3.6.m6.1.1.1.1.1.1.1">
           conditional
          </csymbol>
          <apply id="S5.p3.6.m6.1.1.1.1.1.1.2.cmml" xref="S5.p3.6.m6.1.1.1.1.1.1.2">
           <csymbol cd="ambiguous" id="S5.p3.6.m6.1.1.1.1.1.1.2.1.cmml" xref="S5.p3.6.m6.1.1.1.1.1.1.2">
            superscript
           </csymbol>
           <ci id="S5.p3.6.m6.1.1.1.1.1.1.2.2.cmml" xref="S5.p3.6.m6.1.1.1.1.1.1.2.2">
            𝐲
           </ci>
           <times id="S5.p3.6.m6.1.1.1.1.1.1.2.3.cmml" xref="S5.p3.6.m6.1.1.1.1.1.1.2.3">
           </times>
          </apply>
          <ci id="S5.p3.6.m6.1.1.1.1.1.1.3.cmml" xref="S5.p3.6.m6.1.1.1.1.1.1.3">
           𝐱
          </ci>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p3.6.m6.1c">
       -\log p_{\theta}(\mathbf{y}^{*}|\mathbf{x})
      </annotation>
     </semantics>
    </math>
    across all
    <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S5.p3.7.m7.1">
     <semantics id="S5.p3.7.m7.1a">
      <mi id="S5.p3.7.m7.1.1" xref="S5.p3.7.m7.1.1.cmml">
       𝐱
      </mi>
      <annotation-xml encoding="MathML-Content" id="S5.p3.7.m7.1b">
       <ci id="S5.p3.7.m7.1.1.cmml" xref="S5.p3.7.m7.1.1">
        𝐱
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p3.7.m7.1c">
       \mathbf{x}
      </annotation>
     </semantics>
    </math>
    , along with a 95% confidence interval for different checkpoints during training. We find that for any given number of epochs (including fractional number of epochs on the x-axis), the NLL value is lower when conditioning on multi-turn data that RISE generates in comparison with oracle responses to the prompts obtained from an expert. This suggests that RISE is able to utilize the computation of tokens from previous turns to model the target distribution. We also measure the average NLL loss on all samples through training, sampled i.i.d. from the training dataset for RISE and classic fine-tuning and observe a similar trend: RISE is able to reduce loss more than the standard approach, attaining lower perplexity values (Figure
    <a class="ltx_ref" href="#S5.F5" title="Figure 5 ‣ 5 When and Why is Self-Improvement Over Turns Possible? ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      5
     </span>
    </a>
    ).
   </p>
  </div>
  <figure class="ltx_figure" id="S5.F5">
   <div class="ltx_flex_figure">
    <div class="ltx_flex_cell ltx_flex_size_2">
     <figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="S5.F5.1" style="width:208.1pt;">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="444" id="S5.F5.1.g1" src="/html/2407.18219/assets/measure_nll.png" width="592"/>
      <figcaption class="ltx_caption ltx_centering">
       <span class="ltx_tag ltx_tag_figure">
        <span class="ltx_text" id="S5.F5.1.3.1.1" style="font-size:90%;">
         Figure 4
        </span>
        :
       </span>
       <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S5.F5.1.4.2" style="font-size:80%;">
        The probability of the true answer given the prompt.
       </em>
       <span class="ltx_text" id="S5.F5.1.5.3" style="font-size:80%;">
        Observe that model trained with RISE has higher probability for the true answer.
       </span>
      </figcaption>
     </figure>
    </div>
    <div class="ltx_flex_cell ltx_flex_size_2">
     <figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="S5.F5.2" style="width:208.1pt;">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="444" id="S5.F5.2.g1" src="/html/2407.18219/assets/loss_vs_epoch.png" width="592"/>
      <figcaption class="ltx_caption ltx_centering">
       <span class="ltx_tag ltx_tag_figure">
        <span class="ltx_text" id="S5.F5.2.3.1.1" style="font-size:90%;">
         Figure 5
        </span>
        :
       </span>
       <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S5.F5.2.4.2" style="font-size:80%;">
        The training perplexity (loss) of fitting only the oracle answer or a sequence of answers.
       </em>
       <span class="ltx_text" id="S5.F5.2.5.3" style="font-size:80%;">
        Observe that fitting a sequence of answers (RISE) reduces the loss more than fitting only the oracle answer (Classic).
       </span>
      </figcaption>
     </figure>
    </div>
   </div>
  </figure>
  <div class="ltx_para ltx_noindent" id="S5.p4">
   <p class="ltx_p" id="S5.p4.6">
    Of course, in problems that require “knowledge-based” question answering, it is not possible for the model to produce any meaningful improvements because learning
    <math alttext="p^{*}(\mathbf{y}|\mathbf{x})" class="ltx_Math" display="inline" id="S5.p4.1.m1.1">
     <semantics id="S5.p4.1.m1.1a">
      <mrow id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml">
       <msup id="S5.p4.1.m1.1.1.3" xref="S5.p4.1.m1.1.1.3.cmml">
        <mi id="S5.p4.1.m1.1.1.3.2" xref="S5.p4.1.m1.1.1.3.2.cmml">
         p
        </mi>
        <mo id="S5.p4.1.m1.1.1.3.3" xref="S5.p4.1.m1.1.1.3.3.cmml">
         ∗
        </mo>
       </msup>
       <mo id="S5.p4.1.m1.1.1.2" lspace="0em" rspace="0em" xref="S5.p4.1.m1.1.1.2.cmml">
        ​
       </mo>
       <mrow id="S5.p4.1.m1.1.1.1.1" xref="S5.p4.1.m1.1.1.1.1.1.cmml">
        <mo id="S5.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S5.p4.1.m1.1.1.1.1.1.cmml">
         (
        </mo>
        <mrow id="S5.p4.1.m1.1.1.1.1.1" xref="S5.p4.1.m1.1.1.1.1.1.cmml">
         <mi id="S5.p4.1.m1.1.1.1.1.1.2" xref="S5.p4.1.m1.1.1.1.1.1.2.cmml">
          𝐲
         </mi>
         <mo fence="false" id="S5.p4.1.m1.1.1.1.1.1.1" xref="S5.p4.1.m1.1.1.1.1.1.1.cmml">
          |
         </mo>
         <mi id="S5.p4.1.m1.1.1.1.1.1.3" xref="S5.p4.1.m1.1.1.1.1.1.3.cmml">
          𝐱
         </mi>
        </mrow>
        <mo id="S5.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S5.p4.1.m1.1.1.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p4.1.m1.1b">
       <apply id="S5.p4.1.m1.1.1.cmml" xref="S5.p4.1.m1.1.1">
        <times id="S5.p4.1.m1.1.1.2.cmml" xref="S5.p4.1.m1.1.1.2">
        </times>
        <apply id="S5.p4.1.m1.1.1.3.cmml" xref="S5.p4.1.m1.1.1.3">
         <csymbol cd="ambiguous" id="S5.p4.1.m1.1.1.3.1.cmml" xref="S5.p4.1.m1.1.1.3">
          superscript
         </csymbol>
         <ci id="S5.p4.1.m1.1.1.3.2.cmml" xref="S5.p4.1.m1.1.1.3.2">
          𝑝
         </ci>
         <times id="S5.p4.1.m1.1.1.3.3.cmml" xref="S5.p4.1.m1.1.1.3.3">
         </times>
        </apply>
        <apply id="S5.p4.1.m1.1.1.1.1.1.cmml" xref="S5.p4.1.m1.1.1.1.1">
         <csymbol cd="latexml" id="S5.p4.1.m1.1.1.1.1.1.1.cmml" xref="S5.p4.1.m1.1.1.1.1.1.1">
          conditional
         </csymbol>
         <ci id="S5.p4.1.m1.1.1.1.1.1.2.cmml" xref="S5.p4.1.m1.1.1.1.1.1.2">
          𝐲
         </ci>
         <ci id="S5.p4.1.m1.1.1.1.1.1.3.cmml" xref="S5.p4.1.m1.1.1.1.1.1.3">
          𝐱
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p4.1.m1.1c">
       p^{*}(\mathbf{y}|\mathbf{x})
      </annotation>
     </semantics>
    </math>
    is not bounded by insufficient capacity of
    <math alttext="\pi_{\theta}(\mathbf{y}|\mathbf{x})" class="ltx_Math" display="inline" id="S5.p4.2.m2.1">
     <semantics id="S5.p4.2.m2.1a">
      <mrow id="S5.p4.2.m2.1.1" xref="S5.p4.2.m2.1.1.cmml">
       <msub id="S5.p4.2.m2.1.1.3" xref="S5.p4.2.m2.1.1.3.cmml">
        <mi id="S5.p4.2.m2.1.1.3.2" xref="S5.p4.2.m2.1.1.3.2.cmml">
         π
        </mi>
        <mi id="S5.p4.2.m2.1.1.3.3" xref="S5.p4.2.m2.1.1.3.3.cmml">
         θ
        </mi>
       </msub>
       <mo id="S5.p4.2.m2.1.1.2" lspace="0em" rspace="0em" xref="S5.p4.2.m2.1.1.2.cmml">
        ​
       </mo>
       <mrow id="S5.p4.2.m2.1.1.1.1" xref="S5.p4.2.m2.1.1.1.1.1.cmml">
        <mo id="S5.p4.2.m2.1.1.1.1.2" stretchy="false" xref="S5.p4.2.m2.1.1.1.1.1.cmml">
         (
        </mo>
        <mrow id="S5.p4.2.m2.1.1.1.1.1" xref="S5.p4.2.m2.1.1.1.1.1.cmml">
         <mi id="S5.p4.2.m2.1.1.1.1.1.2" xref="S5.p4.2.m2.1.1.1.1.1.2.cmml">
          𝐲
         </mi>
         <mo fence="false" id="S5.p4.2.m2.1.1.1.1.1.1" xref="S5.p4.2.m2.1.1.1.1.1.1.cmml">
          |
         </mo>
         <mi id="S5.p4.2.m2.1.1.1.1.1.3" xref="S5.p4.2.m2.1.1.1.1.1.3.cmml">
          𝐱
         </mi>
        </mrow>
        <mo id="S5.p4.2.m2.1.1.1.1.3" stretchy="false" xref="S5.p4.2.m2.1.1.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S5.p4.2.m2.1b">
       <apply id="S5.p4.2.m2.1.1.cmml" xref="S5.p4.2.m2.1.1">
        <times id="S5.p4.2.m2.1.1.2.cmml" xref="S5.p4.2.m2.1.1.2">
        </times>
        <apply id="S5.p4.2.m2.1.1.3.cmml" xref="S5.p4.2.m2.1.1.3">
         <csymbol cd="ambiguous" id="S5.p4.2.m2.1.1.3.1.cmml" xref="S5.p4.2.m2.1.1.3">
          subscript
         </csymbol>
         <ci id="S5.p4.2.m2.1.1.3.2.cmml" xref="S5.p4.2.m2.1.1.3.2">
          𝜋
         </ci>
         <ci id="S5.p4.2.m2.1.1.3.3.cmml" xref="S5.p4.2.m2.1.1.3.3">
          𝜃
         </ci>
        </apply>
        <apply id="S5.p4.2.m2.1.1.1.1.1.cmml" xref="S5.p4.2.m2.1.1.1.1">
         <csymbol cd="latexml" id="S5.p4.2.m2.1.1.1.1.1.1.cmml" xref="S5.p4.2.m2.1.1.1.1.1.1">
          conditional
         </csymbol>
         <ci id="S5.p4.2.m2.1.1.1.1.1.2.cmml" xref="S5.p4.2.m2.1.1.1.1.1.2">
          𝐲
         </ci>
         <ci id="S5.p4.2.m2.1.1.1.1.1.3.cmml" xref="S5.p4.2.m2.1.1.1.1.1.3">
          𝐱
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p4.2.m2.1c">
       \pi_{\theta}(\mathbf{y}|\mathbf{x})
      </annotation>
     </semantics>
    </math>
    , but is rather unable to match
    <math alttext="p^{*}" class="ltx_Math" display="inline" id="S5.p4.3.m3.1">
     <semantics id="S5.p4.3.m3.1a">
      <msup id="S5.p4.3.m3.1.1" xref="S5.p4.3.m3.1.1.cmml">
       <mi id="S5.p4.3.m3.1.1.2" xref="S5.p4.3.m3.1.1.2.cmml">
        p
       </mi>
       <mo id="S5.p4.3.m3.1.1.3" xref="S5.p4.3.m3.1.1.3.cmml">
        ∗
       </mo>
      </msup>
      <annotation-xml encoding="MathML-Content" id="S5.p4.3.m3.1b">
       <apply id="S5.p4.3.m3.1.1.cmml" xref="S5.p4.3.m3.1.1">
        <csymbol cd="ambiguous" id="S5.p4.3.m3.1.1.1.cmml" xref="S5.p4.3.m3.1.1">
         superscript
        </csymbol>
        <ci id="S5.p4.3.m3.1.1.2.cmml" xref="S5.p4.3.m3.1.1.2">
         𝑝
        </ci>
        <times id="S5.p4.3.m3.1.1.3.cmml" xref="S5.p4.3.m3.1.1.3">
        </times>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p4.3.m3.1c">
       p^{*}
      </annotation>
     </semantics>
    </math>
    due to the absence of features that are critical to learn
the correct mapping from
    <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S5.p4.4.m4.1">
     <semantics id="S5.p4.4.m4.1a">
      <mi id="S5.p4.4.m4.1.1" xref="S5.p4.4.m4.1.1.cmml">
       𝐱
      </mi>
      <annotation-xml encoding="MathML-Content" id="S5.p4.4.m4.1b">
       <ci id="S5.p4.4.m4.1.1.cmml" xref="S5.p4.4.m4.1.1">
        𝐱
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p4.4.m4.1c">
       \mathbf{x}
      </annotation>
     </semantics>
    </math>
    to
    <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S5.p4.5.m5.1">
     <semantics id="S5.p4.5.m5.1a">
      <mi id="S5.p4.5.m5.1.1" xref="S5.p4.5.m5.1.1.cmml">
       𝐲
      </mi>
      <annotation-xml encoding="MathML-Content" id="S5.p4.5.m5.1b">
       <ci id="S5.p4.5.m5.1.1.cmml" xref="S5.p4.5.m5.1.1">
        𝐲
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p4.5.m5.1c">
       \mathbf{y}
      </annotation>
     </semantics>
    </math>
    . We expect that training with RISE would only incentivize hallucinations in this case
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib24" title="">
      24
     </a>
     ]
    </cite>
    , since more input tokens appearing from previous attempts would only provide easier ways to pick up on spurious correlations. However, this is not the failure mode on reasoning problems
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib27" title="">
      27
     </a>
     ]
    </cite>
    , where maj@K rates at turn 1 tend to be higher than pass@1 as we find in our experiments (indicating that performance can be improved by sampling the model itself). In fact, in Figure
    <a class="ltx_ref" href="#S5.F6" title="Figure 6 ‣ 5 When and Why is Self-Improvement Over Turns Possible? ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      6
     </span>
    </a>
    we also show that the sequential procedure learned by RISE can even solve a significant fraction of problems that were unsolved by pass@B for much larger
    <math alttext="B" class="ltx_Math" display="inline" id="S5.p4.6.m6.1">
     <semantics id="S5.p4.6.m6.1a">
      <mi id="S5.p4.6.m6.1.1" xref="S5.p4.6.m6.1.1.cmml">
       B
      </mi>
      <annotation-xml encoding="MathML-Content" id="S5.p4.6.m6.1b">
       <ci id="S5.p4.6.m6.1.1.cmml" xref="S5.p4.6.m6.1.1">
        𝐵
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p4.6.m6.1c">
       B
      </annotation>
     </semantics>
    </math>
    in the first turn, indicating that it learns to index into the pre-trained knowledge of the model in a different manner as opposed to simply translating the pass@K performance into the pass@1 performance of the model, that majority of single-turn approaches are believed to be doing.
   </p>
  </div>
  <figure class="ltx_figure" id="S5.F6">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="225" id="S5.F6.g1" src="/html/2407.18219/assets/success_rate_unsolved.png" width="299"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S5.F6.7.3.1" style="font-size:90%;">
      Figure 6
     </span>
     :
    </span>
    <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S5.F6.8.4" style="font-size:80%;">
     Fraction of problems unsolved by pass@B at the first turn that sequential 5-turn sampling from RISE solves,
    </em>
    <span class="ltx_text" id="S5.F6.4.2" style="font-size:80%;">
     where
     <math alttext="B=5\times k" class="ltx_Math" display="inline" id="S5.F6.3.1.m1.1">
      <semantics id="S5.F6.3.1.m1.1b">
       <mrow id="S5.F6.3.1.m1.1.1" xref="S5.F6.3.1.m1.1.1.cmml">
        <mi id="S5.F6.3.1.m1.1.1.2" xref="S5.F6.3.1.m1.1.1.2.cmml">
         B
        </mi>
        <mo id="S5.F6.3.1.m1.1.1.1" xref="S5.F6.3.1.m1.1.1.1.cmml">
         =
        </mo>
        <mrow id="S5.F6.3.1.m1.1.1.3" xref="S5.F6.3.1.m1.1.1.3.cmml">
         <mn id="S5.F6.3.1.m1.1.1.3.2" xref="S5.F6.3.1.m1.1.1.3.2.cmml">
          5
         </mn>
         <mo id="S5.F6.3.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S5.F6.3.1.m1.1.1.3.1.cmml">
          ×
         </mo>
         <mi id="S5.F6.3.1.m1.1.1.3.3" xref="S5.F6.3.1.m1.1.1.3.3.cmml">
          k
         </mi>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.F6.3.1.m1.1c">
        <apply id="S5.F6.3.1.m1.1.1.cmml" xref="S5.F6.3.1.m1.1.1">
         <eq id="S5.F6.3.1.m1.1.1.1.cmml" xref="S5.F6.3.1.m1.1.1.1">
         </eq>
         <ci id="S5.F6.3.1.m1.1.1.2.cmml" xref="S5.F6.3.1.m1.1.1.2">
          𝐵
         </ci>
         <apply id="S5.F6.3.1.m1.1.1.3.cmml" xref="S5.F6.3.1.m1.1.1.3">
          <times id="S5.F6.3.1.m1.1.1.3.1.cmml" xref="S5.F6.3.1.m1.1.1.3.1">
          </times>
          <cn id="S5.F6.3.1.m1.1.1.3.2.cmml" type="integer" xref="S5.F6.3.1.m1.1.1.3.2">
           5
          </cn>
          <ci id="S5.F6.3.1.m1.1.1.3.3.cmml" xref="S5.F6.3.1.m1.1.1.3.3">
           𝑘
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.F6.3.1.m1.1d">
        B=5\times k
       </annotation>
      </semantics>
     </math>
     (
     <math alttext="k" class="ltx_Math" display="inline" id="S5.F6.4.2.m2.1">
      <semantics id="S5.F6.4.2.m2.1b">
       <mi id="S5.F6.4.2.m2.1.1" xref="S5.F6.4.2.m2.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.F6.4.2.m2.1c">
        <ci id="S5.F6.4.2.m2.1.1.cmml" xref="S5.F6.4.2.m2.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.F6.4.2.m2.1d">
        k
       </annotation>
      </semantics>
     </math>
     is the x-axis). RISE can solve several challenging problems that sampling at the first turn with much larger budgets cannot solve.
    </span>
   </figcaption>
  </figure>
 </section>
 <section class="ltx_section" id="S6" lang="en">
  <h3 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    6
   </span>
   Experimental Evaluation
  </h3>
  <div class="ltx_para ltx_noindent" id="S6.p1">
   <p class="ltx_p" id="S6.p1.1">
    The goal of our experiments is to demonstrate the efficacy of RISE in instilling language models with the ability to self-improve their responses over turns. Our experiments answer the following questions:
    <span class="ltx_text ltx_font_bold" id="S6.p1.1.1">
     (1)
    </span>
    How effectively can RISE improve performance over multiple sequential attempts (i.e., turns) at a given prompt?;
    <span class="ltx_text ltx_font_bold" id="S6.p1.1.2">
     (2)
    </span>
    Does the performance of RISE improve with more rounds of iterative training?;
    <span class="ltx_text ltx_font_bold" id="S6.p1.1.3">
     (3)
    </span>
    Does the self-improvement strategy induced by RISE generalize to novel problems that are out of the training domain? and finally;
    <span class="ltx_text ltx_font_bold" id="S6.p1.1.4">
     (4)
    </span>
    What is the best data composition for training RISE?
To this end, we compare RISE to other prior and baseline approaches, and perform ablations on GSM8K
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib11" title="">
      11
     </a>
     ]
    </cite>
    and MATH
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib18" title="">
      18
     </a>
     ]
    </cite>
    .
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S6.p2">
   <p class="ltx_p" id="S6.p2.1">
    <span class="ltx_text ltx_font_bold" id="S6.p2.1.1">
     Baselines, comparisons, and evaluation.
    </span>
    We compare RISE to several prior methods that attempt to induce similar self-improvement capabilities:
    <span class="ltx_text ltx_font_bold" id="S6.p2.1.2">
     (a)
    </span>
    <span class="ltx_text ltx_font_bold" id="S6.p2.1.3">
     self-refine
    </span>
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib31" title="">
      31
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib21" title="">
      21
     </a>
     ]
    </cite>
    that prompts a base model to critique and revise its mistakes;
    <span class="ltx_text ltx_font_bold" id="S6.p2.1.4">
     (b)
    </span>
    <span class="ltx_text ltx_font_bold" id="S6.p2.1.5">
     GloRE
    </span>
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib17" title="">
      17
     </a>
     ]
    </cite>
    , which trains a separate reward model to locate errors and a refinement model to improve responses of a base LLM; and
    <span class="ltx_text ltx_font_bold" id="S6.p2.1.6">
     (c)
    </span>
    <span class="ltx_text ltx_font_bold" id="S6.p2.1.7">
     self-consistency
    </span>
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib51" title="">
      51
     </a>
     ]
    </cite>
    , which runs majority voting on multiple responses from the first turn as a baseline to compare to our sequential strategy. We tried to construct fair comparisons between RISE and these methods by using a similar-sized model
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib58" title="">
      58
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib23" title="">
      23
     </a>
     ]
    </cite>
    , but differences in the base model, training data, and evaluation setups still prohibits us from performing an apples-to-apples comparison in some cases. Nonetheless, we can still hope to understand the ballpark of improvement by contextualizing our results with these prior works. We also compare to V-STaR
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib19" title="">
      19
     </a>
     ]
    </cite>
    , but since this is not an fair comparison, we defer it to Appendix
    <a class="ltx_ref" href="#A2" title="Appendix B Additional Results ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      B
     </span>
    </a>
    .
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S6.p3">
   <p class="ltx_p" id="S6.p3.1">
    We evaluate RISE in both modes at inference time: with and without an oracle (Section
    <a class="ltx_ref" href="#S4.SS3" title="4.3 Inference at Deployment Time ‣ 4 RISE: Recursive Introspection for Self-Improvement ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      4.3
     </span>
    </a>
    ) at the end of five turns. Concretely, these metrics are defined as follows:
   </p>
   <ul class="ltx_itemize" id="S6.I1">
    <li class="ltx_item" id="S6.I1.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S6.I1.i1.p1">
      <p class="ltx_p" id="S6.I1.i1.p1.1">
       <span class="ltx_text ltx_font_bold" id="S6.I1.i1.p1.1.1">
        with oracle, “
        <span class="ltx_text" id="S6.I1.i1.p1.1.1.1" style="color:#3F007D;">
         p1@t5
        </span>
        ”
       </span>
       : this run terminates the rollout as soon as the response is correct. In other words, this metric allows queries to the final answer verifier at the end of each turn.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S6.I1.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para ltx_noindent" id="S6.I1.i2.p1">
      <p class="ltx_p" id="S6.I1.i2.p1.1">
       <span class="ltx_text ltx_font_bold" id="S6.I1.i2.p1.1.1">
        without oracle, “
        <span class="ltx_text" id="S6.I1.i2.p1.1.1.1" style="color:#662506;">
         m1@t5
        </span>
        ”
       </span>
       : this run does not terminate the rollout before five turns, and we compute the maj@1 performance on the candidates produced in each turn as detailed in Section
       <a class="ltx_ref" href="#S4.SS3" title="4.3 Inference at Deployment Time ‣ 4 RISE: Recursive Introspection for Self-Improvement ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
        <span class="ltx_text ltx_ref_tag">
         4.3
        </span>
       </a>
       .
      </p>
     </div>
    </li>
   </ul>
   <p class="ltx_p" id="S6.p3.2">
    We also compare maj@K performance at the first turn for all the models we train (“m1@t1”, “
    <span class="ltx_text" id="S6.p3.2.1" style="color:#084081;">
     m5@t1
    </span>
    ”).
   </p>
  </div>
  <figure class="ltx_table" id="S6.T1">
   <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T1.10" style="width:422.8pt;height:436.2pt;vertical-align:-0.0pt;">
    <span class="ltx_transformed_inner" style="transform:translate(-15.4pt,15.9pt) scale(0.93200070866828,0.93200070866828) ;">
     <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T1.10.10">
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="S6.T1.10.10.11.1">
        <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S6.T1.10.10.11.1.1" rowspan="2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.11.1.1.1" style="font-size:80%;">
          Approach
         </span>
        </th>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="4" id="S6.T1.10.10.11.1.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.11.1.2.1" style="font-size:80%;">
          GSM8K
         </span>
         <span class="ltx_text" id="S6.T1.10.10.11.1.2.2" style="font-size:80%;">
         </span>
         <cite class="ltx_cite ltx_citemacro_citep">
          <span class="ltx_text" id="S6.T1.10.10.11.1.2.3.1" style="font-size:80%;">
           [
          </span>
          <a class="ltx_ref" href="#bib.bib10" title="">
           10
          </a>
          <span class="ltx_text" id="S6.T1.10.10.11.1.2.4.2" style="font-size:80%;">
           ]
          </span>
         </cite>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S6.T1.10.10.11.1.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.11.1.3.1" style="font-size:80%;">
          MATH
         </span>
         <span class="ltx_text" id="S6.T1.10.10.11.1.3.2" style="font-size:80%;">
         </span>
         <cite class="ltx_cite ltx_citemacro_citep">
          <span class="ltx_text" id="S6.T1.10.10.11.1.3.3.1" style="font-size:80%;">
           [
          </span>
          <a class="ltx_ref" href="#bib.bib18" title="">
           18
          </a>
          <span class="ltx_text" id="S6.T1.10.10.11.1.3.4.2" style="font-size:80%;">
           ]
          </span>
         </cite>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.12.2">
        <td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="S6.T1.10.10.12.2.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.12.2.1.1" style="font-size:80%;">
          w/o oracle
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.12.2.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.12.2.2.1" style="font-size:80%;">
          w/ oracle
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="S6.T1.10.10.12.2.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.12.2.3.1" style="font-size:80%;">
          w/o oracle
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.12.2.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.12.2.4.1" style="font-size:80%;">
          w/ oracle
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.4.4.4">
        <th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S6.T1.4.4.4.5" style="padding:-0.05pt 3.4pt;">
        </th>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.4.4.4.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.4.4.4.6.1" style="font-size:80%;">
          m1@t1
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.1.1.1.1" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T1.1.1.1.1.m1.1">
          <semantics id="S6.T1.1.1.1.1.m1.1a">
           <mo id="S6.T1.1.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T1.1.1.1.1.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T1.1.1.1.1.m1.1b">
            <ci id="S6.T1.1.1.1.1.m1.1.1.cmml" xref="S6.T1.1.1.1.1.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T1.1.1.1.1.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="S6.T1.1.1.1.1.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.1.1.1.1.2" style="font-size:80%;color:#084081;">
          m5@t1
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T1.2.2.2.2" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T1.2.2.2.2.m1.1">
          <semantics id="S6.T1.2.2.2.2.m1.1a">
           <mo id="S6.T1.2.2.2.2.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T1.2.2.2.2.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T1.2.2.2.2.m1.1b">
            <ci id="S6.T1.2.2.2.2.m1.1.1.cmml" xref="S6.T1.2.2.2.2.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T1.2.2.2.2.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="S6.T1.2.2.2.2.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.2.2.2.2.2" style="font-size:80%;color:#662506;">
          m1@t5
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.4.4.4.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.4.4.4.7.1" style="font-size:80%;color:#3F007D;">
          p1@t5
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.4.4.4.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.4.4.4.8.1" style="font-size:80%;">
          m1@t1
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.3.3.3.3" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T1.3.3.3.3.m1.1">
          <semantics id="S6.T1.3.3.3.3.m1.1a">
           <mo id="S6.T1.3.3.3.3.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T1.3.3.3.3.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T1.3.3.3.3.m1.1b">
            <ci id="S6.T1.3.3.3.3.m1.1.1.cmml" xref="S6.T1.3.3.3.3.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T1.3.3.3.3.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="S6.T1.3.3.3.3.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.3.3.3.3.2" style="font-size:80%;color:#084081;">
          m5@t1
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T1.4.4.4.4" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T1.4.4.4.4.m1.1">
          <semantics id="S6.T1.4.4.4.4.m1.1a">
           <mo id="S6.T1.4.4.4.4.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T1.4.4.4.4.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T1.4.4.4.4.m1.1b">
            <ci id="S6.T1.4.4.4.4.m1.1.1.cmml" xref="S6.T1.4.4.4.4.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T1.4.4.4.4.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="S6.T1.4.4.4.4.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.4.4.4.4.2" style="font-size:80%;color:#662506;">
          m1@t5
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.4.4.4.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.4.4.4.9.1" style="font-size:80%;color:#3F007D;">
          p1@t5
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.13.3">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T1.10.10.13.3.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.13.3.1.1" style="font-size:80%;">
          RISE (Ours)
         </span>
        </th>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.13.3.2" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.13.3.3" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.13.3.4" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.13.3.5" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.13.3.6" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.13.3.7" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.13.3.8" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.13.3.9" style="padding:-0.05pt 3.4pt;">
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.14.4">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.14.4.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.14.4.1.1" style="font-size:80%;">
          Llama2 Base
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.14.4.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.14.4.2.1" style="font-size:80%;">
          10.5
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.14.4.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.14.4.3.1" style="font-size:80%;color:#2B8CBE;">
          22.8
         </span>
         <span class="ltx_text" id="S6.T1.10.10.14.4.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.14.4.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.14.4.3.3.1" style="color:#084081;">
           +12.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.14.4.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.14.4.4.1" style="font-size:80%;color:#D95F0E;">
          11.1
         </span>
         <span class="ltx_text" id="S6.T1.10.10.14.4.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.14.4.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.14.4.4.3.1" style="color:#662506;">
           +0.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.14.4.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.14.4.5.1" style="font-size:80%;color:#6A51A3;">
          13.9
         </span>
         <span class="ltx_text" id="S6.T1.10.10.14.4.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.14.4.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.14.4.5.3.1" style="color:#3F007D;">
           +3.4
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.14.4.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.14.4.6.1" style="font-size:80%;">
          1.9
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.14.4.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.14.4.7.1" style="font-size:80%;color:#2B8CBE;">
          5.1
         </span>
         <span class="ltx_text" id="S6.T1.10.10.14.4.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.14.4.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.14.4.7.3.1" style="color:#084081;">
           +3.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.14.4.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.14.4.8.1" style="font-size:80%;color:#D95F0E;">
          1.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.14.4.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.14.4.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.14.4.8.3.1" style="color:#662506;">
           -0.5
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.14.4.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.14.4.9.1" style="font-size:80%;color:#6A51A3;">
          2.3
         </span>
         <span class="ltx_text" id="S6.T1.10.10.14.4.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.14.4.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.14.4.9.3.1" style="color:#3F007D;">
           +0.4
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.15.5">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.15.5.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.15.5.1.1" style="font-size:80%;">
          +Boost
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.15.5.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.15.5.2.1" style="font-size:80%;">
          32.9
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.15.5.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.15.5.3.1" style="font-size:80%;color:#2B8CBE;">
          45.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.15.5.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.15.5.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.15.5.3.3.1" style="color:#084081;">
           +12.5
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.15.5.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.15.5.4.1" style="font-size:80%;color:#D95F0E;">
          39.2
         </span>
         <span class="ltx_text" id="S6.T1.10.10.15.5.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.15.5.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.15.5.4.3.1" style="color:#662506;">
           +6.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.15.5.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.15.5.5.1" style="font-size:80%;color:#6A51A3;">
          55.5
         </span>
         <span class="ltx_text" id="S6.T1.10.10.15.5.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.15.5.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.15.5.5.3.1" style="color:#3F007D;">
           +22.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.15.5.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.15.5.6.1" style="font-size:80%;">
          5.5
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.15.5.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.15.5.7.1" style="font-size:80%;color:#2B8CBE;">
          6.8
         </span>
         <span class="ltx_text" id="S6.T1.10.10.15.5.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.15.5.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.15.5.7.3.1" style="color:#084081;">
           +1.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.15.5.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.15.5.8.1" style="font-size:80%;color:#D95F0E;">
          5.5
         </span>
         <span class="ltx_text" id="S6.T1.10.10.15.5.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.15.5.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.15.5.8.3.1" style="color:#662506;">
           0.0
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.15.5.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.15.5.9.1" style="font-size:80%;color:#6A51A3;">
          14.6
         </span>
         <span class="ltx_text" id="S6.T1.10.10.15.5.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.15.5.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.15.5.9.3.1" style="color:#3F007D;">
           +9.1
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.16.6">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.16.6.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.16.6.1.1" style="font-size:80%;">
          +Iteration 1
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.16.6.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.16.6.2.1" style="font-size:80%;">
          35.6
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.16.6.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.16.6.3.1" style="font-size:80%;color:#2B8CBE;">
          49.7
         </span>
         <span class="ltx_text" id="S6.T1.10.10.16.6.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.16.6.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.16.6.3.3.1" style="color:#084081;">
           +14.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.16.6.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.16.6.4.1" style="font-size:80%;color:#D95F0E;">
          50.7
         </span>
         <span class="ltx_text" id="S6.T1.10.10.16.6.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.16.6.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.16.6.4.3.1" style="color:#662506;">
           +15.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.16.6.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.16.6.5.1" style="font-size:80%;color:#6A51A3;">
          63.9
         </span>
         <span class="ltx_text" id="S6.T1.10.10.16.6.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.16.6.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.16.6.5.3.1" style="color:#3F007D;">
           +28.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.16.6.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.16.6.6.1" style="font-size:80%;">
          6.3
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.16.6.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.16.6.7.1" style="font-size:80%;color:#2B8CBE;">
          8.8
         </span>
         <span class="ltx_text" id="S6.T1.10.10.16.6.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.16.6.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.16.6.7.3.1" style="color:#084081;">
           +2.5
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.16.6.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.16.6.8.1" style="font-size:80%;color:#D95F0E;">
          9.7
         </span>
         <span class="ltx_text" id="S6.T1.10.10.16.6.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.16.6.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.16.6.8.3.1" style="color:#662506;">
           +3.4
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.16.6.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.16.6.9.1" style="font-size:80%;color:#6A51A3;">
          19.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.16.6.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.16.6.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.16.6.9.3.1" style="color:#3F007D;">
           +13.1
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.17.7">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.17.7.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.17.7.1.1" style="font-size:80%;">
          +Iteration 2
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.17.7.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.17.7.2.1" style="font-size:80%;">
          37.3
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.17.7.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.17.7.3.1" style="font-size:80%;color:#2B8CBE;">
          51.0
         </span>
         <span class="ltx_text" id="S6.T1.10.10.17.7.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.17.7.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.17.7.3.3.1" style="color:#084081;">
           +13.7
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.17.7.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.17.7.4.1" style="font-size:80%;color:#D95F0E;">
          55.0
         </span>
         <span class="ltx_text" id="S6.T1.10.10.17.7.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.17.7.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.17.7.4.3.1" style="color:#662506;">
           +17.7
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.17.7.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.17.7.5.1" style="font-size:80%;color:#6A51A3;">
          68.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.17.7.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.17.7.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.17.7.5.3.1" style="color:#3F007D;">
           +31.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.17.7.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.17.7.6.1" style="font-size:80%;">
          5.8
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.17.7.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.17.7.7.1" style="font-size:80%;color:#2B8CBE;">
          10.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.17.7.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.17.7.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.17.7.7.3.1" style="color:#084081;">
           +4.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.17.7.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.17.7.8.1" style="font-size:80%;color:#D95F0E;">
          10.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.17.7.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.17.7.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.17.7.8.3.1" style="color:#662506;">
           +4.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.17.7.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.17.7.9.1" style="font-size:80%;color:#6A51A3;">
          19.8
         </span>
         <span class="ltx_text" id="S6.T1.10.10.17.7.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.17.7.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.17.7.9.3.1" style="color:#3F007D;">
           +14.0
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.18.8">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T1.10.10.18.8.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.18.8.1.1" style="font-size:80%;">
          SFT on oracle data
         </span>
        </th>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.18.8.2" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.18.8.3" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.18.8.4" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.18.8.5" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.18.8.6" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.18.8.7" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.18.8.8" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.18.8.9" style="padding:-0.05pt 3.4pt;">
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.19.9">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.19.9.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.19.9.1.1" style="font-size:80%;">
          Only correct data
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.19.9.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.19.9.2.1" style="font-size:80%;">
          27.4
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.19.9.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.19.9.3.1" style="font-size:80%;color:#2B8CBE;">
          42.2
         </span>
         <span class="ltx_text" id="S6.T1.10.10.19.9.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.19.9.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.19.9.3.3.1" style="color:#084081;">
           +14.9
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.19.9.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.19.9.4.1" style="font-size:80%;color:#D95F0E;">
          34.0
         </span>
         <span class="ltx_text" id="S6.T1.10.10.19.9.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.19.9.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.19.9.4.3.1" style="color:#662506;">
           +6.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.19.9.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.19.9.5.1" style="font-size:80%;color:#6A51A3;">
          43.6
         </span>
         <span class="ltx_text" id="S6.T1.10.10.19.9.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.19.9.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.19.9.5.3.1" style="color:#3F007D;">
           +16.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.19.9.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.19.9.6.1" style="font-size:80%;">
          5.8
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.19.9.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.19.9.7.1" style="font-size:80%;color:#2B8CBE;">
          7.9
         </span>
         <span class="ltx_text" id="S6.T1.10.10.19.9.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.19.9.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.19.9.7.3.1" style="color:#084081;">
           +2.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.19.9.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.19.9.8.1" style="font-size:80%;color:#D95F0E;">
          5.5
         </span>
         <span class="ltx_text" id="S6.T1.10.10.19.9.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.19.9.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.19.9.8.3.1" style="color:#662506;">
           -0.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.19.9.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.19.9.9.1" style="font-size:80%;color:#6A51A3;">
          12.1
         </span>
         <span class="ltx_text" id="S6.T1.10.10.19.9.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.19.9.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.19.9.9.3.1" style="color:#3F007D;">
           +6.2
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.20.10">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.20.10.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.20.10.1.1" style="font-size:80%;">
          Correct and incorrect
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.20.10.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.20.10.2.1" style="font-size:80%;">
          25.7
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.20.10.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.20.10.3.1" style="font-size:80%;color:#2B8CBE;">
          41.8
         </span>
         <span class="ltx_text" id="S6.T1.10.10.20.10.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.20.10.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.20.10.3.3.1" style="color:#084081;">
           +16.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.20.10.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.20.10.4.1" style="font-size:80%;color:#D95F0E;">
          31.2
         </span>
         <span class="ltx_text" id="S6.T1.10.10.20.10.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.20.10.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.20.10.4.3.1" style="color:#662506;">
           +5.5
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.20.10.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.20.10.5.1" style="font-size:80%;color:#6A51A3;">
          41.5
         </span>
         <span class="ltx_text" id="S6.T1.10.10.20.10.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.20.10.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.20.10.5.3.1" style="color:#3F007D;">
           +15.8
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.20.10.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.20.10.6.1" style="font-size:80%;">
          5.0
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.20.10.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.20.10.7.1" style="font-size:80%;color:#2B8CBE;">
          5.2
         </span>
         <span class="ltx_text" id="S6.T1.10.10.20.10.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.20.10.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.20.10.7.3.1" style="color:#084081;">
           +0.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.20.10.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.20.10.8.1" style="font-size:80%;color:#D95F0E;">
          5.0
         </span>
         <span class="ltx_text" id="S6.T1.10.10.20.10.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.20.10.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.20.10.8.3.1" style="color:#662506;">
           +0.0
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.20.10.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.20.10.9.1" style="font-size:80%;color:#6A51A3;">
          13.1
         </span>
         <span class="ltx_text" id="S6.T1.10.10.20.10.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.20.10.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.20.10.9.3.1" style="color:#3F007D;">
           +8.1
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.21.11">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T1.10.10.21.11.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.21.11.1.1" style="font-size:80%;">
          RISE (Ours)
         </span>
        </th>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.21.11.2" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.21.11.3" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.21.11.4" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.21.11.5" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.21.11.6" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.21.11.7" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.21.11.8" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.21.11.9" style="padding:-0.05pt 3.4pt;">
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.22.12">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.22.12.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.22.12.1.1" style="font-size:80%;">
          Mistral-7B
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.22.12.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.22.12.2.1" style="font-size:80%;">
          33.7
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.22.12.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.22.12.3.1" style="font-size:80%;color:#2B8CBE;">
          49.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.22.12.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.22.12.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.22.12.3.3.1" style="color:#084081;">
           +15.7
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.22.12.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.22.12.4.1" style="font-size:80%;color:#D95F0E;">
          39.0
         </span>
         <span class="ltx_text" id="S6.T1.10.10.22.12.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.22.12.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.22.12.4.3.1" style="color:#662506;">
           +5.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.22.12.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.22.12.5.1" style="font-size:80%;color:#6A51A3;">
          46.9
         </span>
         <span class="ltx_text" id="S6.T1.10.10.22.12.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.22.12.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.22.12.5.3.1" style="color:#3F007D;">
           +13.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.22.12.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.22.12.6.1" style="font-size:80%;">
          7.5
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.22.12.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.22.12.7.1" style="font-size:80%;color:#2B8CBE;">
          13.0
         </span>
         <span class="ltx_text" id="S6.T1.10.10.22.12.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.22.12.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.22.12.7.3.1" style="color:#084081;">
           +5.5
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.22.12.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.22.12.8.1" style="font-size:80%;color:#D95F0E;">
          8.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.22.12.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.22.12.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.22.12.8.3.1" style="color:#662506;">
           +0.9
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.22.12.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.22.12.9.1" style="font-size:80%;color:#6A51A3;">
          13.0
         </span>
         <span class="ltx_text" id="S6.T1.10.10.22.12.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.22.12.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.22.12.9.3.1" style="color:#3F007D;">
           +5.5
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.23.13">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.23.13.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.23.13.1.1" style="font-size:80%;">
          + Iteration 1
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.23.13.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.23.13.2.1" style="font-size:80%;">
          35.3
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.23.13.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.23.13.3.1" style="font-size:80%;color:#2B8CBE;">
          50.6
         </span>
         <span class="ltx_text" id="S6.T1.10.10.23.13.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.23.13.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.23.13.3.3.1" style="color:#084081;">
           +15.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.23.13.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.23.13.4.1" style="font-size:80%;color:#D95F0E;">
          59.2
         </span>
         <span class="ltx_text" id="S6.T1.10.10.23.13.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.23.13.4.3" style="font-size:70%;">
          (
          <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.23.13.4.3.1" style="color:#662506;">
           +23.9
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.23.13.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.23.13.5.1" style="font-size:80%;color:#6A51A3;">
          68.6
         </span>
         <span class="ltx_text" id="S6.T1.10.10.23.13.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.23.13.5.3" style="font-size:70%;">
          (
          <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.23.13.5.3.1" style="color:#3F007D;">
           +33.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.23.13.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.23.13.6.1" style="font-size:80%;">
          6.7
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.23.13.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.23.13.7.1" style="font-size:80%;color:#2B8CBE;">
          9.5
         </span>
         <span class="ltx_text" id="S6.T1.10.10.23.13.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.23.13.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.23.13.7.3.1" style="color:#084081;">
           +2.8
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.23.13.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.23.13.8.1" style="font-size:80%;color:#D95F0E;">
          18.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.23.13.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.23.13.8.3" style="font-size:70%;">
          (
          <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.23.13.8.3.1" style="color:#662506;">
           +11.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.23.13.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.23.13.9.1" style="font-size:80%;color:#6A51A3;">
          29.7
         </span>
         <span class="ltx_text" id="S6.T1.10.10.23.13.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.23.13.9.3" style="font-size:70%;">
          (
          <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.23.13.9.3.1" style="color:#3F007D;">
           +22.4
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.24.14">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T1.10.10.24.14.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.24.14.1.1" style="font-size:80%;">
          7B SoTA
          <cite class="ltx_cite ltx_citemacro_citep">
           [
           <a class="ltx_ref" href="#bib.bib58" title="">
            58
           </a>
           ]
          </cite>
         </span>
        </th>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.24.14.2" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.24.14.3" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.24.14.4" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.24.14.5" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.24.14.6" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.24.14.7" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.24.14.8" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.24.14.9" style="padding:-0.05pt 3.4pt;">
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.25.15">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.25.15.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.25.15.1.1" style="font-size:80%;">
          Eurus-7B-SFT
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.25.15.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.25.15.2.1" style="font-size:80%;">
          36.3
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.25.15.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.25.15.3.1" style="font-size:80%;color:#2B8CBE;">
          66.3
         </span>
         <span class="ltx_text" id="S6.T1.10.10.25.15.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.25.15.3.3" style="font-size:70%;">
          (
          <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.25.15.3.3.1" style="color:#084081;">
           +30.0
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.25.15.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.25.15.4.1" style="font-size:80%;color:#D95F0E;">
          47.9
         </span>
         <span class="ltx_text" id="S6.T1.10.10.25.15.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.25.15.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.25.15.4.3.1" style="color:#662506;">
           +11.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.25.15.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.25.15.5.1" style="font-size:80%;color:#6A51A3;">
          53.1
         </span>
         <span class="ltx_text" id="S6.T1.10.10.25.15.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.25.15.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.25.15.5.3.1" style="color:#3F007D;">
           +16.8
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.25.15.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.25.15.6.1" style="font-size:80%;">
          12.3
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.25.15.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.25.15.7.1" style="font-size:80%;color:#2B8CBE;">
          19.8
         </span>
         <span class="ltx_text" id="S6.T1.10.10.25.15.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.25.15.7.3" style="font-size:70%;">
          (
          <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.25.15.7.3.1" style="color:#084081;">
           +7.5
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.25.15.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.25.15.8.1" style="font-size:80%;color:#D95F0E;">
          16.3
         </span>
         <span class="ltx_text" id="S6.T1.10.10.25.15.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.25.15.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.25.15.8.3.1" style="color:#662506;">
           +4.0
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.25.15.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.25.15.9.1" style="font-size:80%;color:#6A51A3;">
          22.9
         </span>
         <span class="ltx_text" id="S6.T1.10.10.25.15.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.25.15.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.25.15.9.3.1" style="color:#3F007D;">
           +10.6
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.8.8.8">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T1.8.8.8.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.8.8.8.5.1" style="font-size:80%;">
          Self-Refine
          <cite class="ltx_cite ltx_citemacro_citep">
           [
           <a class="ltx_ref" href="#bib.bib31" title="">
            31
           </a>
           ]
          </cite>
         </span>
        </th>
        <td class="ltx_td ltx_border_t" id="S6.T1.8.8.8.6" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.8.8.8.7" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T1.5.5.5.1" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T1.5.5.5.1.m1.1">
          <semantics id="S6.T1.5.5.5.1.m1.1a">
           <mo id="S6.T1.5.5.5.1.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T1.5.5.5.1.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T1.5.5.5.1.m1.1b">
            <ci id="S6.T1.5.5.5.1.m1.1.1.cmml" xref="S6.T1.5.5.5.1.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T1.5.5.5.1.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="S6.T1.5.5.5.1.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.5.5.5.1.2" style="font-size:80%;color:#662506;">
          m1@t3
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T1.6.6.6.2" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T1.6.6.6.2.m1.1">
          <semantics id="S6.T1.6.6.6.2.m1.1a">
           <mo id="S6.T1.6.6.6.2.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T1.6.6.6.2.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T1.6.6.6.2.m1.1b">
            <ci id="S6.T1.6.6.6.2.m1.1.1.cmml" xref="S6.T1.6.6.6.2.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T1.6.6.6.2.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="S6.T1.6.6.6.2.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.6.6.6.2.2" style="font-size:80%;color:#3F007D;">
          p1@t3
         </span>
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.8.8.8.8" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.8.8.8.9" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T1.7.7.7.3" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T1.7.7.7.3.m1.1">
          <semantics id="S6.T1.7.7.7.3.m1.1a">
           <mo id="S6.T1.7.7.7.3.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T1.7.7.7.3.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T1.7.7.7.3.m1.1b">
            <ci id="S6.T1.7.7.7.3.m1.1.1.cmml" xref="S6.T1.7.7.7.3.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T1.7.7.7.3.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="S6.T1.7.7.7.3.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.7.7.7.3.2" style="font-size:80%;color:#662506;">
          m1@t3
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.8.8.8.4" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T1.8.8.8.4.m1.1">
          <semantics id="S6.T1.8.8.8.4.m1.1a">
           <mo id="S6.T1.8.8.8.4.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T1.8.8.8.4.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T1.8.8.8.4.m1.1b">
            <ci id="S6.T1.8.8.8.4.m1.1.1.cmml" xref="S6.T1.8.8.8.4.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T1.8.8.8.4.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="S6.T1.8.8.8.4.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.8.8.8.4.2" style="font-size:80%;color:#3F007D;">
          p1@t3
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.26.16">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.26.16.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.26.16.1.1" style="font-size:80%;">
          Base
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.26.16.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.26.16.2.1" style="font-size:80%;">
          10.5
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.26.16.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.26.16.3.1" style="font-size:80%;color:#2B8CBE;">
          22.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.26.16.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.26.16.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.26.16.3.3.1" style="color:#084081;">
           +11.9
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.26.16.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.26.16.4.1" style="font-size:80%;color:#D95F0E;">
          7.1
         </span>
         <span class="ltx_text" id="S6.T1.10.10.26.16.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.26.16.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.26.16.4.3.1" style="color:#662506;">
           -3.4
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.26.16.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.26.16.5.1" style="font-size:80%;color:#6A51A3;">
          13.0
         </span>
         <span class="ltx_text" id="S6.T1.10.10.26.16.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.26.16.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.26.16.5.3.1" style="color:#3F007D;">
           +2.5
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.26.16.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.26.16.6.1" style="font-size:80%;">
          1.9
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.26.16.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.26.16.7.1" style="font-size:80%;color:#2B8CBE;">
          5.1
         </span>
         <span class="ltx_text" id="S6.T1.10.10.26.16.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.26.16.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.26.16.7.3.1" style="color:#084081;">
           +3.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.26.16.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.26.16.8.1" style="font-size:80%;color:#D95F0E;">
          1.9
         </span>
         <span class="ltx_text" id="S6.T1.10.10.26.16.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.26.16.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.26.16.8.3.1" style="color:#662506;">
           0.0
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.26.16.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.26.16.9.1" style="font-size:80%;color:#6A51A3;">
          3.1
         </span>
         <span class="ltx_text" id="S6.T1.10.10.26.16.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.26.16.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.26.16.9.3.1" style="color:#3F007D;">
           +1.2
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.27.17">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.27.17.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.27.17.1.1" style="font-size:80%;">
          +Iteration 2
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.27.17.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.27.17.2.1" style="font-size:80%;">
          37.3
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.27.17.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.27.17.3.1" style="font-size:80%;color:#2B8CBE;">
          50.5
         </span>
         <span class="ltx_text" id="S6.T1.10.10.27.17.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.27.17.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.27.17.3.3.1" style="color:#084081;">
           +13.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.27.17.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.27.17.4.1" style="font-size:80%;color:#D95F0E;">
          33.3
         </span>
         <span class="ltx_text" id="S6.T1.10.10.27.17.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.27.17.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.27.17.4.3.1" style="color:#662506;">
           -4.0
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.27.17.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.27.17.5.1" style="font-size:80%;color:#6A51A3;">
          44.5
         </span>
         <span class="ltx_text" id="S6.T1.10.10.27.17.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.27.17.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.27.17.5.3.1" style="color:#3F007D;">
           +7.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.27.17.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.27.17.6.1" style="font-size:80%;">
          5.8
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.27.17.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.27.17.7.1" style="font-size:80%;color:#2B8CBE;">
          9.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.27.17.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.27.17.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.27.17.7.3.1" style="color:#084081;">
           +3.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.27.17.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.27.17.8.1" style="font-size:80%;color:#D95F0E;">
          5.7
         </span>
         <span class="ltx_text" id="S6.T1.10.10.27.17.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.27.17.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.27.17.8.3.1" style="color:#662506;">
           -0.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.27.17.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.27.17.9.1" style="font-size:80%;color:#6A51A3;">
          9.5
         </span>
         <span class="ltx_text" id="S6.T1.10.10.27.17.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.27.17.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.27.17.9.3.1" style="color:#3F007D;">
           +3.7
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.28.18">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.28.18.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.28.18.1.1" style="font-size:80%;">
          GPT-3.5
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.28.18.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.28.18.2.1" style="font-size:80%;">
          66.4
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.28.18.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.28.18.3.1" style="font-size:80%;color:#2B8CBE;">
          80.2
         </span>
         <span class="ltx_text" id="S6.T1.10.10.28.18.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.28.18.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.28.18.3.3.1" style="color:#084081;">
           +13.8
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.28.18.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.28.18.4.1" style="font-size:80%;color:#D95F0E;">
          61.0
         </span>
         <span class="ltx_text" id="S6.T1.10.10.28.18.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.28.18.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.28.18.4.3.1" style="color:#662506;">
           -5.4
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.28.18.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.28.18.5.1" style="font-size:80%;color:#6A51A3;">
          71.6
         </span>
         <span class="ltx_text" id="S6.T1.10.10.28.18.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.28.18.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.28.18.5.3.1" style="color:#3F007D;">
           +5.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.28.18.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.28.18.6.1" style="font-size:80%;">
          39.7
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.28.18.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.28.18.7.1" style="font-size:80%;color:#2B8CBE;">
          46.5
         </span>
         <span class="ltx_text" id="S6.T1.10.10.28.18.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.28.18.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.28.18.7.3.1" style="color:#084081;">
           +6.8
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.28.18.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.28.18.8.1" style="font-size:80%;color:#D95F0E;">
          36.5
         </span>
         <span class="ltx_text" id="S6.T1.10.10.28.18.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.28.18.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.28.18.8.3.1" style="color:#662506;">
           -3.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.28.18.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.28.18.9.1" style="font-size:80%;color:#6A51A3;">
          46.7
         </span>
         <span class="ltx_text" id="S6.T1.10.10.28.18.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.28.18.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.28.18.9.3.1" style="color:#3F007D;">
           +7.0
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.29.19">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.29.19.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.29.19.1.1" style="font-size:80%;">
          Mistral-7B
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.29.19.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.29.19.2.1" style="font-size:80%;">
          33.7
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.29.19.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.29.19.3.1" style="font-size:80%;color:#2B8CBE;">
          48.5
         </span>
         <span class="ltx_text" id="S6.T1.10.10.29.19.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.29.19.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.29.19.3.3.1" style="color:#084081;">
           +14.8
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.29.19.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.29.19.4.1" style="font-size:80%;color:#D95F0E;">
          21.2
         </span>
         <span class="ltx_text" id="S6.T1.10.10.29.19.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.29.19.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.29.19.4.3.1" style="color:#662506;">
           -12.5
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.29.19.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.29.19.5.1" style="font-size:80%;color:#6A51A3;">
          37.9
         </span>
         <span class="ltx_text" id="S6.T1.10.10.29.19.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.29.19.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.29.19.5.3.1" style="color:#3F007D;">
           +4.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.29.19.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.29.19.6.1" style="font-size:80%;">
          7.5
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.29.19.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.29.19.7.1" style="font-size:80%;color:#2B8CBE;">
          12.3
         </span>
         <span class="ltx_text" id="S6.T1.10.10.29.19.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.29.19.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.29.19.7.3.1" style="color:#084081;">
           +4.8
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.29.19.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.29.19.8.1" style="font-size:80%;color:#D95F0E;">
          7.1
         </span>
         <span class="ltx_text" id="S6.T1.10.10.29.19.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.29.19.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.29.19.8.3.1" style="color:#662506;">
           -0.4
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.29.19.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.29.19.9.1" style="font-size:80%;color:#6A51A3;">
          11.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.29.19.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.29.19.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.29.19.9.3.1" style="color:#3F007D;">
           +3.9
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.30.20">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.30.20.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.30.20.1.1" style="font-size:80%;">
          Eurus-7B-SFT
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.30.20.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.30.20.2.1" style="font-size:80%;">
          36.3
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.30.20.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.30.20.3.1" style="font-size:80%;color:#2B8CBE;">
          65.9
         </span>
         <span class="ltx_text" id="S6.T1.10.10.30.20.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.30.20.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.30.20.3.3.1" style="color:#084081;">
           +29.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.30.20.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.30.20.4.1" style="font-size:80%;color:#D95F0E;">
          26.2
         </span>
         <span class="ltx_text" id="S6.T1.10.10.30.20.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.30.20.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.30.20.4.3.1" style="color:#662506;">
           -10.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.30.20.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.30.20.5.1" style="font-size:80%;color:#6A51A3;">
          42.8
         </span>
         <span class="ltx_text" id="S6.T1.10.10.30.20.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.30.20.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.30.20.5.3.1" style="color:#3F007D;">
           +6.5
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.30.20.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.30.20.6.1" style="font-size:80%;">
          12.3
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.30.20.7" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.30.20.7.1" style="font-size:80%;color:#2B8CBE;">
          19.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.30.20.7.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.30.20.7.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.30.20.7.3.1" style="color:#084081;">
           +7.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.30.20.8" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.30.20.8.1" style="font-size:80%;color:#D95F0E;">
          9.0
         </span>
         <span class="ltx_text" id="S6.T1.10.10.30.20.8.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.30.20.8.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.30.20.8.3.1" style="color:#662506;">
           -3.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.30.20.9" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.30.20.9.1" style="font-size:80%;color:#6A51A3;">
          15.1
         </span>
         <span class="ltx_text" id="S6.T1.10.10.30.20.9.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.30.20.9.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.30.20.9.3.1" style="color:#3F007D;">
           +2.8
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.10">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T1.10.10.10.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T1.10.10.10.3.1" style="font-size:80%;">
          GloRE
          <cite class="ltx_cite ltx_citemacro_citep">
           [
           <a class="ltx_ref" href="#bib.bib17" title="">
            17
           </a>
           ]
          </cite>
         </span>
        </th>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.10.4" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.10.5" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T1.9.9.9.1" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T1.9.9.9.1.m1.1">
          <semantics id="S6.T1.9.9.9.1.m1.1a">
           <mo id="S6.T1.9.9.9.1.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T1.9.9.9.1.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T1.9.9.9.1.m1.1b">
            <ci id="S6.T1.9.9.9.1.m1.1.1.cmml" xref="S6.T1.9.9.9.1.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T1.9.9.9.1.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="S6.T1.9.9.9.1.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.9.9.9.1.2" style="font-size:80%;color:#662506;">
          m1@t3
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T1.10.10.10.2" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T1.10.10.10.2.m1.1">
          <semantics id="S6.T1.10.10.10.2.m1.1a">
           <mo id="S6.T1.10.10.10.2.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T1.10.10.10.2.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T1.10.10.10.2.m1.1b">
            <ci id="S6.T1.10.10.10.2.m1.1.1.cmml" xref="S6.T1.10.10.10.2.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T1.10.10.10.2.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="S6.T1.10.10.10.2.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.10.2.2" style="font-size:80%;color:#3F007D;">
          p1@t3
         </span>
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.10.6" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.10.7" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.10.8" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_t" id="S6.T1.10.10.10.9" style="padding:-0.05pt 3.4pt;">
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.31.21">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.31.21.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.31.21.1.1" style="font-size:80%;">
          +ORM
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.31.21.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.31.21.2.1" style="font-size:80%;">
          48.2
         </span>
        </td>
        <td class="ltx_td" id="S6.T1.10.10.31.21.3" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.31.21.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.31.21.4.1" style="font-size:80%;color:#D95F0E;">
          49.5
         </span>
         <span class="ltx_text" id="S6.T1.10.10.31.21.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.31.21.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.31.21.4.3.1" style="color:#662506;">
           +1.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.31.21.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.31.21.5.1" style="font-size:80%;color:#6A51A3;">
          57.1
         </span>
         <span class="ltx_text" id="S6.T1.10.10.31.21.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.31.21.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.31.21.5.3.1" style="color:#3F007D;">
           +8.9
          </span>
          )
         </span>
        </td>
        <td class="ltx_td" id="S6.T1.10.10.31.21.6" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td" id="S6.T1.10.10.31.21.7" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td" id="S6.T1.10.10.31.21.8" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td" id="S6.T1.10.10.31.21.9" style="padding:-0.05pt 3.4pt;">
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.32.22">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T1.10.10.32.22.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.32.22.1.1" style="font-size:80%;">
          +SORM
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T1.10.10.32.22.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.32.22.2.1" style="font-size:80%;">
          48.2
         </span>
        </td>
        <td class="ltx_td" id="S6.T1.10.10.32.22.3" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.32.22.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.32.22.4.1" style="font-size:80%;color:#D95F0E;">
          51.6
         </span>
         <span class="ltx_text" id="S6.T1.10.10.32.22.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.32.22.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.32.22.4.3.1" style="color:#662506;">
           +3.4
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.10.10.32.22.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.32.22.5.1" style="font-size:80%;color:#6A51A3;">
          59.7
         </span>
         <span class="ltx_text" id="S6.T1.10.10.32.22.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.32.22.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.32.22.5.3.1" style="color:#3F007D;">
           +11.5
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" colspan="4" id="S6.T1.10.10.32.22.6" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.32.22.6.1" style="font-size:80%;">
          Not studied in
         </span>
         <cite class="ltx_cite ltx_citemacro_citep">
          <span class="ltx_text" id="S6.T1.10.10.32.22.6.2.1" style="font-size:80%;">
           [
          </span>
          <a class="ltx_ref" href="#bib.bib17" title="">
           17
          </a>
          <span class="ltx_text" id="S6.T1.10.10.32.22.6.3.2" style="font-size:80%;">
           ]
          </span>
         </cite>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T1.10.10.33.23">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S6.T1.10.10.33.23.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.33.23.1.1" style="font-size:80%;">
          +Direct
         </span>
        </th>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T1.10.10.33.23.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.33.23.2.1" style="font-size:80%;">
          48.2
         </span>
        </td>
        <td class="ltx_td ltx_border_bb" id="S6.T1.10.10.33.23.3" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T1.10.10.33.23.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.33.23.4.1" style="font-size:80%;color:#D95F0E;">
          47.4
         </span>
         <span class="ltx_text" id="S6.T1.10.10.33.23.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.33.23.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.33.23.4.3.1" style="color:#662506;">
           -0.8
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T1.10.10.33.23.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T1.10.10.33.23.5.1" style="font-size:80%;color:#6A51A3;">
          59.2
         </span>
         <span class="ltx_text" id="S6.T1.10.10.33.23.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T1.10.10.33.23.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T1.10.10.33.23.5.3.1" style="color:#3F007D;">
           +11.0
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_border_bb" id="S6.T1.10.10.33.23.6" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_bb" id="S6.T1.10.10.33.23.7" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_bb" id="S6.T1.10.10.33.23.8" style="padding:-0.05pt 3.4pt;">
        </td>
        <td class="ltx_td ltx_border_bb" id="S6.T1.10.10.33.23.9" style="padding:-0.05pt 3.4pt;">
        </td>
       </tr>
      </tbody>
     </table>
    </span>
   </div>
   <figcaption class="ltx_caption ltx_centering" style="font-size:80%;">
    <span class="ltx_tag ltx_tag_table">
     <span class="ltx_text" id="S6.T1.24.1.1" style="font-size:113%;">
      Table 1
     </span>
     :
    </span>
    <span class="ltx_text ltx_font_bold" id="S6.T1.25.2">
     RISE vs. other approaches (Self-Refine, GLoRE) and baselines.
    </span>
    Observe that RISE attains the biggest performance improvement (in
    <span class="ltx_text" id="S6.T1.26.3" style="color:#662506;">
     brown
    </span>
    ) between 1-turn (m5@t1) and 5-turn (m1@t5) performance w/o an oracle on both GSM8K and MATH. This performance gap is even larger when oracle early termination is allowed (p1@t5 w/ oracle). Self-Refine
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib31" title="">
      31
     </a>
     ]
    </cite>
    degrades performance across the board when used without an oracle, and attains minor performance improvements when used with an oracle. GLoRE trains a separate refinement model, but still performs worse than RISE; more details about it are in Appendix
    <a class="ltx_ref" href="#A2" title="Appendix B Additional Results ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
     <span class="ltx_text ltx_ref_tag">
      B
     </span>
    </a>
    . Using RISE on top of a better base model (Mistral-7B) is also effective (positive improvements with multiple turns), and note the m1@t5 performance of Mistral-7B exceeds even state-of-the-art math models such as Eurus-7B-SFT
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib58" title="">
      58
     </a>
     ]
    </cite>
    . Simply running single-turn SFT on data utilized by RISE is not effective at inducing a self-improvement capability, implying that the algorithmic design choices in RISE are crucial for performance. Color coding indicates numbers that can be compared to each other.
   </figcaption>
  </figure>
  <section class="ltx_subsection" id="S6.SS1">
   <h4 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     6.1
    </span>
    Does RISE improve performance over multiple turns compared to other approaches?
   </h4>
   <div class="ltx_para ltx_noindent" id="S6.SS1.p1">
    <p class="ltx_p" id="S6.SS1.p1.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS1.p1.1.1">
      Main results.
     </span>
     We present the comparisons in Table
     <a class="ltx_ref" href="#S6.T1" title="Table 1 ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     . First, note that RISE (“Iteration 1” and “Iteration 2”) boosts up the LLama2 base model’s five-turn performance by 15.1% and 17.7% respectively with each iteration on GSM8K and 3.4% and 4.6% on MATH, w/o any oracle.
Interestingly, we found using prompting-only self-refine
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib31" title="">
       31
      </a>
      ]
     </cite>
     largely degrades performance across the board, even with a strong proprietary model, GPT-3.5. The strongest 7B base models, Mistral-7B and Eurus-7B-SFT
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib58" title="">
       58
      </a>
      ]
     </cite>
     , when coupled with standard prompting, are only able to improve their performance, but only by 5.3% / 11.6% and 0.9% / 4.0% respectively on GSM8K and MATH, which is significantly lower than our approach. The performance of GLoRE improves only by 3.4% on GSM8K (over two turns), but this is still lower than our approach, which improves by 6.3% in two turns and 13.4% in three turns (see Appendix
     <a class="ltx_ref" href="#A2.SS1" title="B.1 Complete Comparisons and Discussion: Extended Version of Table 1 ‣ Appendix B Additional Results ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       B.1
      </span>
     </a>
     ). This indicates that RISE is effective in teaching models how to improve their own errors.
     <span class="ltx_text ltx_font_bold" id="S6.SS1.p1.1.2">
      To summarize,
     </span>
     training with RISE gives the largest performance improvement gains compared to other approaches both with and without the use of an oracle, and these gains are transferred to other base models.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S6.SS1.p2">
    <p class="ltx_p" id="S6.SS1.p2.1">
     One might also hypothesize that the performance gains with RISE here are largely a result of utilizing queries to an off-the-shelf more capable model for providing supervision and not the algorithmic approach for data collection and training. To address this hypothesis, we store all the data generated by RISE from more capable models and train on this data via standard single-turn SFT (“
     <span class="ltx_text ltx_font_bold" id="S6.SS1.p2.1.1">
      SFT on oracle data
     </span>
     ). Since not all of this data are guaranteed to be correct, we also run this experiment on only the correct responses in these oracle data. Observe in Table
     <a class="ltx_ref" href="#S6.T1" title="Table 1 ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     that this procedure does not still instill self-improvement capabilities, largely preserving or degrading sequential (“
     <span class="ltx_text ltx_font_bold" id="S6.SS1.p2.1.2" style="color:#662506;">
      maj@1@turn5
     </span>
     ”) performance compared to simply sampling one response in the first turn. This means that the algorithmic design of RISE is critical in enabling it to learn self-improvement capabilities, as opposed to simply the use of expert supervision.
    </p>
   </div>
   <section class="ltx_subsubsection" id="S6.SS1.SSS1">
    <h5 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      6.1.1
     </span>
     Can RISE Effectively Make Use of Mistakes and Correct Them?
    </h5>
    <div class="ltx_para ltx_noindent" id="S6.SS1.SSS1.p1">
     <p class="ltx_p" id="S6.SS1.SSS1.p1.1">
      One concern that arises from prior results on self-refinement or self-correction is whether the model can truly correct itself over turns or whether the improvement comes from the effect of sampling more answers and picking the best one.
In Table
      <a class="ltx_ref" href="#S6.T1" title="Table 1 ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        1
       </span>
      </a>
      , we see that sequentially improving responses via RISE (“
      <span class="ltx_text ltx_font_bold" id="S6.SS1.SSS1.p1.1.1" style="color:#662506;">
       maj@1@turn5
      </span>
      ”) outperforms sampling 5 responses in parallel at the first turn and applying a majority vote on them (“
      <span class="ltx_text ltx_font_bold" id="S6.SS1.SSS1.p1.1.2" style="color:#084081;">
       maj@5@turn1
      </span>
      ”). Please note that this comparison utilizes an equal number of samples, with the only difference being that these samples are drawn in parallel at the first turn in one case and sequentially at the end of five turns in the other. Comparing maj@5 performance at the end of
      <span class="ltx_text" id="S6.SS1.SSS1.p1.1.3" style="color:#084081;">
       1 turn
      </span>
      and
      <span class="ltx_text" id="S6.SS1.SSS1.p1.1.4" style="color:#662506;">
       5 turns
      </span>
      , we observe a consistent 4% to 8% improvement on GSM8K and an 6.5% improvement on MATH (with Mistral-7B model). This means that RISE can imbue models with a self-improvement ability, while running parallel sampling alone on any model cannot endow the same ability. Even the
      <span class="ltx_text ltx_font_bold" id="S6.SS1.SSS1.p1.1.5" style="color:#084081;">
       maj@5@turn1
      </span>
      performance of standard single-turn SFT on the data used by RISE is substantially worse than the sequential
      <span class="ltx_text ltx_font_bold" id="S6.SS1.SSS1.p1.1.6" style="color:#662506;">
       maj@1@turn5
      </span>
      performance of RISE, implying that the algorithmic protocol of RISE plays a critical underlying role. Finally, we also remark that in Figure
      <a class="ltx_ref" href="#S5.F6" title="Figure 6 ‣ 5 When and Why is Self-Improvement Over Turns Possible? ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        6
       </span>
      </a>
      , we showed that the sequential procedure learned by RISE over five turns could solve a significant fraction of problems that were unsolved by pass@B for much larger values of
      <math alttext="B\gg 5" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p1.1.m1.1">
       <semantics id="S6.SS1.SSS1.p1.1.m1.1a">
        <mrow id="S6.SS1.SSS1.p1.1.m1.1.1" xref="S6.SS1.SSS1.p1.1.m1.1.1.cmml">
         <mi id="S6.SS1.SSS1.p1.1.m1.1.1.2" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.cmml">
          B
         </mi>
         <mo id="S6.SS1.SSS1.p1.1.m1.1.1.1" xref="S6.SS1.SSS1.p1.1.m1.1.1.1.cmml">
          ≫
         </mo>
         <mn id="S6.SS1.SSS1.p1.1.m1.1.1.3" xref="S6.SS1.SSS1.p1.1.m1.1.1.3.cmml">
          5
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p1.1.m1.1b">
         <apply id="S6.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1">
          <csymbol cd="latexml" id="S6.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.1">
           much-greater-than
          </csymbol>
          <ci id="S6.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.2">
           𝐵
          </ci>
          <cn id="S6.SS1.SSS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS1.SSS1.p1.1.m1.1.1.3">
           5
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S6.SS1.SSS1.p1.1.m1.1c">
         B\gg 5
        </annotation>
       </semantics>
      </math>
      in the first turn, implying that sequential RISE can actually tackle prompts that were not solvable by simply sampling more responses in the first turn.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="S6.SS1.SSS1.p2">
     <p class="ltx_p" id="S6.SS1.SSS1.p2.1">
      One might also speculate if these improvements in sequential improvement ability largely come at a cost of reduced improvements in first turn performance. In addition, we also observe that running multiple iterations of RISE still preserves the first turn performance while improving the 5-turn performance.
     </p>
    </div>
   </section>
   <section class="ltx_subsubsection" id="S6.SS1.SSS2">
    <h5 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      6.1.2
     </span>
     How Does the Base Model Affect RISE?
    </h5>
    <div class="ltx_para ltx_noindent" id="S6.SS1.SSS2.p1">
     <p class="ltx_p" id="S6.SS1.SSS2.p1.1">
      The performance of RISE with Llama2-7B on an absolute scale is lower than the best models specifically fine-tuned on math data (e.g., Eurus-7B-SFT or Mistral-7B). However, we find that RISE is still effective on top of Mistral-7B base model. In fact,
      <em class="ltx_emph ltx_font_italic" id="S6.SS1.SSS2.p1.1.1">
       our performance at the end of five turns outperforms one of the best 7B SFT models, customized to math reasoning
      </em>
      . Compare the
      <span class="ltx_text" id="S6.SS1.SSS2.p1.1.2" style="color:#662506;">
       m1@t5
      </span>
      performance of Eurus-7B-SFT and Mistral-7B in RISE (ours), to find that Mistral-7B + RISE outperforms Eurus-7B-SFT.
     </p>
    </div>
    <figure class="ltx_table" id="S6.T2">
     <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T2.2">
      <thead class="ltx_thead">
       <tr class="ltx_tr" id="S6.T2.2.3.1">
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S6.T2.2.3.1.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T2.2.3.1.1.1" style="font-size:80%;">
          RISE (Self)
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="3" id="S6.T2.2.3.1.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T2.2.3.1.2.1" style="font-size:80%;">
          w/o oracle
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.2.3.1.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="S6.T2.2.3.1.3.1" style="font-size:80%;">
          w/ oracle
         </span>
        </th>
       </tr>
       <tr class="ltx_tr" id="S6.T2.2.2">
        <th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S6.T2.2.2.3" style="padding:-0.05pt 3.4pt;">
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T2.2.2.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.2.4.1" style="font-size:80%;">
          m1@t1
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T2.1.1.1" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T2.1.1.1.m1.1">
          <semantics id="S6.T2.1.1.1.m1.1a">
           <mo id="S6.T2.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T2.1.1.1.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T2.1.1.1.m1.1b">
            <ci id="S6.T2.1.1.1.m1.1.1.cmml" xref="S6.T2.1.1.1.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T2.1.1.1.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="S6.T2.1.1.1.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.1.1.1.2" style="font-size:80%;color:#084081;">
          m5@t1
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T2.2.2.2" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T2.2.2.2.m1.1">
          <semantics id="S6.T2.2.2.2.m1.1a">
           <mo id="S6.T2.2.2.2.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T2.2.2.2.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="S6.T2.2.2.2.m1.1b">
            <ci id="S6.T2.2.2.2.m1.1.1.cmml" xref="S6.T2.2.2.2.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S6.T2.2.2.2.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="S6.T2.2.2.2.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.2.2.2" style="font-size:80%;color:#662506;">
          m1@t5
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S6.T2.2.2.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.2.5.1" style="font-size:80%;color:#3F007D;">
          p1@t5
         </span>
        </th>
       </tr>
      </thead>
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="S6.T2.2.4.1">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T2.2.4.1.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.4.1.1.1" style="font-size:80%;">
          Mistral-7B
         </span>
        </th>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.2.4.1.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.4.1.2.1" style="font-size:80%;">
          33.7
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.2.4.1.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.4.1.3.1" style="font-size:80%;color:#2B8CBE;">
          49.4
         </span>
         <span class="ltx_text" id="S6.T2.2.4.1.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.4.1.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T2.2.4.1.3.3.1" style="color:#084081;">
           +15.7
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.2.4.1.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.4.1.4.1" style="font-size:80%;color:#D95F0E;">
          39.0
         </span>
         <span class="ltx_text" id="S6.T2.2.4.1.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.4.1.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T2.2.4.1.4.3.1" style="color:#662506;">
           +5.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.2.4.1.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.4.1.5.1" style="font-size:80%;color:#6A51A3;">
          46.9
         </span>
         <span class="ltx_text" id="S6.T2.2.4.1.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.4.1.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T2.2.4.1.5.3.1" style="color:#3F007D;">
           +13.2
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T2.2.5.2">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T2.2.5.2.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.5.2.1.1" style="font-size:80%;">
          + Iteration 1
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S6.T2.2.5.2.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.5.2.2.1" style="font-size:80%;">
          36.8
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T2.2.5.2.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.5.2.3.1" style="font-size:80%;color:#2B8CBE;">
          44.4
         </span>
         <span class="ltx_text" id="S6.T2.2.5.2.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.5.2.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T2.2.5.2.3.3.1" style="color:#084081;">
           +7.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.5.2.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.5.2.4.1" style="font-size:80%;color:#D95F0E;">
          39.5
         </span>
         <span class="ltx_text" id="S6.T2.2.5.2.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.5.2.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T2.2.5.2.4.3.1" style="color:#662506;">
           +6.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S6.T2.2.5.2.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.5.2.5.1" style="font-size:80%;color:#6A51A3;">
          48.7
         </span>
         <span class="ltx_text" id="S6.T2.2.5.2.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.5.2.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T2.2.5.2.5.3.1" style="color:#3F007D;">
           +15.9
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T2.2.6.3">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T2.2.6.3.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.6.3.1.1" style="font-size:80%;">
          Llama-3-8B
         </span>
        </th>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.2.6.3.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.6.3.2.1" style="font-size:80%;">
          45.3
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.2.6.3.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.6.3.3.1" style="font-size:80%;color:#2B8CBE;">
          69.7
         </span>
         <span class="ltx_text" id="S6.T2.2.6.3.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.6.3.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T2.2.6.3.3.3.1" style="color:#084081;">
           +24.4
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.2.6.3.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.6.3.4.1" style="font-size:80%;color:#D95F0E;">
          52.5
         </span>
         <span class="ltx_text" id="S6.T2.2.6.3.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.6.3.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T2.2.6.3.4.3.1" style="color:#662506;">
           +7.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.2.6.3.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.6.3.5.1" style="font-size:80%;color:#6A51A3;">
          61.0
         </span>
         <span class="ltx_text" id="S6.T2.2.6.3.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.6.3.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T2.2.6.3.5.3.1" style="color:#3F007D;">
           +15.7
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S6.T2.2.7.4">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S6.T2.2.7.4.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.7.4.1.1" style="font-size:80%;">
          + Iteration 1
         </span>
        </th>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.2.7.4.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.7.4.2.1" style="font-size:80%;">
          65.6
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.2.7.4.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.7.4.3.1" style="font-size:80%;color:#2B8CBE;">
          80.7
         </span>
         <span class="ltx_text" id="S6.T2.2.7.4.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.7.4.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T2.2.7.4.3.3.1" style="color:#084081;">
           +15.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T2.2.7.4.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.7.4.4.1" style="font-size:80%;color:#D95F0E;">
          73.8
         </span>
         <span class="ltx_text" id="S6.T2.2.7.4.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.7.4.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T2.2.7.4.4.3.1" style="color:#662506;">
           +8.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.2.7.4.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="S6.T2.2.7.4.5.1" style="font-size:80%;color:#6A51A3;">
          81.2
         </span>
         <span class="ltx_text" id="S6.T2.2.7.4.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="S6.T2.2.7.4.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="S6.T2.2.7.4.5.3.1" style="color:#3F007D;">
           +15.6
          </span>
          )
         </span>
        </td>
       </tr>
      </tbody>
     </table>
     <figcaption class="ltx_caption ltx_centering" style="font-size:80%;">
      <span class="ltx_tag ltx_tag_table">
       <span class="ltx_text" id="S6.T2.9.1.1" style="font-size:113%;">
        Table 2
       </span>
       :
      </span>
      <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S6.T2.10.2">
       RISE with self-distillation on GSM8K.
      </em>
      RISE is able to improve
      <span class="ltx_text" id="S6.T2.11.3" style="color:#662506;">
       5-turn maj@1
      </span>
      performance of the model with entirely self-generated data and supervision, despite the fact that the base Mistral-7B model does not produce correct answers for several problems.
     </figcaption>
    </figure>
   </section>
   <section class="ltx_subsubsection" id="S6.SS1.SSS3">
    <h5 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      6.1.3
     </span>
     Self-Distillation Version of RISE
    </h5>
    <div class="ltx_para ltx_noindent" id="S6.SS1.SSS3.p1">
     <p class="ltx_p" id="S6.SS1.SSS3.p1.1">
      We also compare the performance of RISE with entirely self-generated data and supervision (Equation
      <a class="ltx_ref" href="#S4.E4" title="Equation 4.4 ‣ 4.2 Learning in the Multi-Turn MDP ‣ 4 RISE: Recursive Introspection for Self-Improvement ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        4.4
       </span>
      </a>
      ,
      <math alttext="N=16" class="ltx_Math" display="inline" id="S6.SS1.SSS3.p1.1.m1.1">
       <semantics id="S6.SS1.SSS3.p1.1.m1.1a">
        <mrow id="S6.SS1.SSS3.p1.1.m1.1.1" xref="S6.SS1.SSS3.p1.1.m1.1.1.cmml">
         <mi id="S6.SS1.SSS3.p1.1.m1.1.1.2" xref="S6.SS1.SSS3.p1.1.m1.1.1.2.cmml">
          N
         </mi>
         <mo id="S6.SS1.SSS3.p1.1.m1.1.1.1" xref="S6.SS1.SSS3.p1.1.m1.1.1.1.cmml">
          =
         </mo>
         <mn id="S6.SS1.SSS3.p1.1.m1.1.1.3" xref="S6.SS1.SSS3.p1.1.m1.1.1.3.cmml">
          16
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="S6.SS1.SSS3.p1.1.m1.1b">
         <apply id="S6.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S6.SS1.SSS3.p1.1.m1.1.1">
          <eq id="S6.SS1.SSS3.p1.1.m1.1.1.1.cmml" xref="S6.SS1.SSS3.p1.1.m1.1.1.1">
          </eq>
          <ci id="S6.SS1.SSS3.p1.1.m1.1.1.2.cmml" xref="S6.SS1.SSS3.p1.1.m1.1.1.2">
           𝑁
          </ci>
          <cn id="S6.SS1.SSS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS1.SSS3.p1.1.m1.1.1.3">
           16
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S6.SS1.SSS3.p1.1.m1.1c">
         N=16
        </annotation>
       </semantics>
      </math>
      ) after one iteration directly on top of more capable models: Mistral-7B and Llama-3-8B on GSM8K in Table
      <a class="ltx_ref" href="#S6.T2" title="Table 2 ‣ 6.1.2 How Does the Base Model Affect RISE? ‣ 6.1 Does RISE improve performance over multiple turns compared to other approaches? ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        2
       </span>
      </a>
      , without any knowledge boosting phase. We find that this variant also improves the 5-turn performance of the base model compared to the first turn: compare “m1@t5” vs “m1@t1” for both the models Llama-3-8B and Mistral-7B, where RISE boosts the sequential self-improvement performance by more than 1% compared to turn 1 performance w/o any oracle.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="S6.SS1.SSS3.p2">
     <p class="ltx_p" id="S6.SS1.SSS3.p2.1">
      Of course, we also note that this version of RISE does not outperform the “m5@t1” performance of the fine-tuned model. We expect this to be largely a function of one single iteration of training. Since the self-distillation version of RISE utilizes best-of-N sampling against the same model to produce supervision for self-improvement, RISE would first have to match the performance of best-of-N sampling before it can start to improve over it via reward maximization. Due to the significant gap between the base model’s m5@t1 and m1@t5 performance, we expect that this will take quite a few iterations or a fully online RL algorithm. We did not have computational resources and infrastructure to run multiple iterations, but this is an interesting avenue for future work. In this self-distillation setting, we could also divide the computation between sequential and parallel sampling strategies to get the best results at the end of five turns. Nonetheless, this result shows that even by training on self-generated samples, RISE can actually amplify the sequential sampling performance of the base model.
     </p>
    </div>
   </section>
  </section>
  <section class="ltx_subsection" id="S6.SS2">
   <h4 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     6.2
    </span>
    Does the Performance of RISE Improve with Iterative Training?
   </h4>
   <div class="ltx_para ltx_noindent" id="S6.SS2.p1">
    <p class="ltx_p" id="S6.SS2.p1.1">
     Next, we attempt to understand if RISE improves with multiple rounds of training on on-policy data. As shown in Tables
     <a class="ltx_ref" href="#S6.T1" title="Table 1 ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     and
     <a class="ltx_ref" href="#S6.T2" title="Table 2 ‣ 6.1.2 How Does the Base Model Affect RISE? ‣ 6.1 Does RISE improve performance over multiple turns compared to other approaches? ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     , the performance of RISE improves from iteration to iteration constantly. The 5-turn performance of RISE, both with and without an oracle, exhibits a clear improvement with more rounds. This implies that iterative self-training procedures of the form of STaR
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib61" title="">
       61
      </a>
      ]
     </cite>
     can also be combined with RISE to train models for self-improvement. This also perhaps serves as a strong hint towards the potential utility of full online reinforcement learning (RL) techniques.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S6.SS3">
   <h4 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     6.3
    </span>
    Does RISE Also Improve Sequential Performance on Out-of-Distribution Prompts?
   </h4>
   <div class="ltx_para ltx_noindent" id="S6.SS3.p1">
    <p class="ltx_p" id="S6.SS3.p1.1">
     In Table
     <a class="ltx_ref" href="#S6.T3" title="Table 3 ‣ 6.3 Does RISE Also Improve Sequential Performance on Out-of-Distribution Prompts? ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     , our aim is to evaluate the robustness of the strategy induced by RISE on new, unseen prompts. Specifically, we compare the performance of the RISE model trained with a dataset on evaluation prompts from another dataset. Note in Table
     <a class="ltx_ref" href="#S6.T3" title="Table 3 ‣ 6.3 Does RISE Also Improve Sequential Performance on Out-of-Distribution Prompts? ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     , these datasets include MATH, GSM8K, and SVAMP. Generally, we observe that the model trained on one dataset is still able to improve the base model’s performance on another dataset over the course of sequential five turns. More concretely, while the base Llama2 model largely degrades its turn 1 performance over turn 5 performance, model’s trained with RISE enable a positive performance improvement on these out-of-distribution prompts. This means that even though these models have not seen queries similar to the evaluation dataset, simply training with RISE on
     <em class="ltx_emph ltx_font_italic" id="S6.SS3.p1.1.1">
      some
     </em>
     kind of mathematical prompts still boosts the efficacy of the self-improvement strategy on a new distribution of test prompts. This finding suggests that RISE is capable of instilling self-improvement procedures that can generalize beyond the distribution of prompts in the fine-tuning data.
    </p>
   </div>
   <figure class="ltx_table" id="S6.T3">
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T3.1">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S6.T3.1.2.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S6.T3.1.2.1.1" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text ltx_font_bold" id="S6.T3.1.2.1.1.1" style="font-size:80%;">
         RISE
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S6.T3.1.2.1.2" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text ltx_font_bold" id="S6.T3.1.2.1.2.1" style="font-size:80%;">
         w/o oracle
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.1.2.1.3" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text ltx_font_bold" id="S6.T3.1.2.1.3.1" style="font-size:80%;">
         w/ oracle
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T3.1.1">
       <th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S6.T3.1.1.2" style="padding:-0.05pt 3.4pt;">
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.3" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.1.3.1" style="font-size:80%;">
         m1@t1
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.1.1.1" style="padding:-0.05pt 3.4pt;">
        <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T3.1.1.1.m1.1">
         <semantics id="S6.T3.1.1.1.m1.1a">
          <mo id="S6.T3.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T3.1.1.1.m1.1.1.cmml">
           →
          </mo>
          <annotation-xml encoding="MathML-Content" id="S6.T3.1.1.1.m1.1b">
           <ci id="S6.T3.1.1.1.m1.1.1.cmml" xref="S6.T3.1.1.1.m1.1.1">
            →
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S6.T3.1.1.1.m1.1c">
           \rightarrow
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text" id="S6.T3.1.1.1.1" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.1.1.2" style="font-size:80%;color:#662506;">
         m1@t5
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.1.4" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.1.4.1" style="font-size:80%;color:#3F007D;">
         p1@t5
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T3.1.3.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T3.1.3.2.1" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text ltx_font_bold" id="S6.T3.1.3.2.1.1" style="font-size:80%;">
         GSM8K
        </span>
       </th>
       <td class="ltx_td ltx_border_t" id="S6.T3.1.3.2.2" style="padding:-0.05pt 3.4pt;">
       </td>
       <td class="ltx_td ltx_border_t" id="S6.T3.1.3.2.3" style="padding:-0.05pt 3.4pt;">
       </td>
       <td class="ltx_td ltx_border_t" id="S6.T3.1.3.2.4" style="padding:-0.05pt 3.4pt;">
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T3.1.4.3">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T3.1.4.3.1" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.4.3.1.1" style="font-size:80%;">
         Llama2 Base
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.4.3.2" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.4.3.2.1" style="font-size:80%;">
         10.5
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.1.4.3.3" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.4.3.3.1" style="font-size:80%;color:#D95F0E;">
         11.1
        </span>
        <span class="ltx_text" id="S6.T3.1.4.3.3.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.4.3.3.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.4.3.3.3.1" style="color:#662506;">
          +0.6
         </span>
         )
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.4.3.4" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.4.3.4.1" style="font-size:80%;color:#6A51A3;">
         13.9
        </span>
        <span class="ltx_text" id="S6.T3.1.4.3.4.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.4.3.4.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.4.3.4.3.1" style="color:#3F007D;">
          +3.4
         </span>
         )
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T3.1.5.4">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T3.1.5.4.1" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.5.4.1.1" style="font-size:80%;">
         Iteration 1 RISE Model trained on MATH
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.5.4.2" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.5.4.2.1" style="font-size:80%;">
         19.3
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.1.5.4.3" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.5.4.3.1" style="font-size:80%;color:#D95F0E;">
         32.6
        </span>
        <span class="ltx_text" id="S6.T3.1.5.4.3.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.5.4.3.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.5.4.3.3.1" style="color:#662506;">
          +13.3
         </span>
         )
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.5.4.4" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.5.4.4.1" style="font-size:80%;color:#6A51A3;">
         48.4
        </span>
        <span class="ltx_text" id="S6.T3.1.5.4.4.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.5.4.4.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.5.4.4.3.1" style="color:#3F007D;">
          +29.1
         </span>
         )
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T3.1.6.5">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T3.1.6.5.1" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text ltx_font_bold" id="S6.T3.1.6.5.1.1" style="font-size:80%;">
         MATH
        </span>
       </th>
       <td class="ltx_td ltx_border_t" id="S6.T3.1.6.5.2" style="padding:-0.05pt 3.4pt;">
       </td>
       <td class="ltx_td ltx_border_t" id="S6.T3.1.6.5.3" style="padding:-0.05pt 3.4pt;">
       </td>
       <td class="ltx_td ltx_border_t" id="S6.T3.1.6.5.4" style="padding:-0.05pt 3.4pt;">
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T3.1.7.6">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T3.1.7.6.1" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.7.6.1.1" style="font-size:80%;">
         Llama2 Base
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.7.6.2" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.7.6.2.1" style="font-size:80%;">
         1.9
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.1.7.6.3" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.7.6.3.1" style="font-size:80%;color:#D95F0E;">
         1.4
        </span>
        <span class="ltx_text" id="S6.T3.1.7.6.3.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.7.6.3.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.7.6.3.3.1" style="color:#662506;">
          -0.5
         </span>
         )
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.7.6.4" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.7.6.4.1" style="font-size:80%;color:#6A51A3;">
         2.3
        </span>
        <span class="ltx_text" id="S6.T3.1.7.6.4.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.7.6.4.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.7.6.4.3.1" style="color:#3F007D;">
          +0.4
         </span>
         )
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T3.1.8.7">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T3.1.8.7.1" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.8.7.1.1" style="font-size:80%;">
         Iteration 1 RISE Model trained on GSM8K
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.8.7.2" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.8.7.2.1" style="font-size:80%;">
         4.3
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.1.8.7.3" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.8.7.3.1" style="font-size:80%;color:#D95F0E;">
         4.4
        </span>
        <span class="ltx_text" id="S6.T3.1.8.7.3.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.8.7.3.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.8.7.3.3.1" style="color:#662506;">
          +0.1
         </span>
         )
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.8.7.4" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.8.7.4.1" style="font-size:80%;color:#6A51A3;">
         12.1
        </span>
        <span class="ltx_text" id="S6.T3.1.8.7.4.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.8.7.4.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.8.7.4.3.1" style="color:#3F007D;">
          +7.8
         </span>
         )
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T3.1.9.8">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T3.1.9.8.1" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text ltx_font_bold" id="S6.T3.1.9.8.1.1" style="font-size:80%;">
         SVAMP
        </span>
       </th>
       <td class="ltx_td ltx_border_t" id="S6.T3.1.9.8.2" style="padding:-0.05pt 3.4pt;">
       </td>
       <td class="ltx_td ltx_border_t" id="S6.T3.1.9.8.3" style="padding:-0.05pt 3.4pt;">
       </td>
       <td class="ltx_td ltx_border_t" id="S6.T3.1.9.8.4" style="padding:-0.05pt 3.4pt;">
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T3.1.10.9">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T3.1.10.9.1" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.10.9.1.1" style="font-size:80%;">
         Llama2 Base
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.10.9.2" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.10.9.2.1" style="font-size:80%;">
         29.2
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.1.10.9.3" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.10.9.3.1" style="font-size:80%;color:#D95F0E;">
         30.5
        </span>
        <span class="ltx_text" id="S6.T3.1.10.9.3.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.10.9.3.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.10.9.3.3.1" style="color:#662506;">
          +1.3
         </span>
         )
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.10.9.4" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.10.9.4.1" style="font-size:80%;color:#6A51A3;">
         34.0
        </span>
        <span class="ltx_text" id="S6.T3.1.10.9.4.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.10.9.4.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.10.9.4.3.1" style="color:#3F007D;">
          +4.8
         </span>
         )
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T3.1.11.10">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T3.1.11.10.1" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.11.10.1.1" style="font-size:80%;">
         Iteration 1 RISE Model trained on MATH
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.11.10.2" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.11.10.2.1" style="font-size:80%;">
         30.1
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.1.11.10.3" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.11.10.3.1" style="font-size:80%;color:#D95F0E;">
         31.4
        </span>
        <span class="ltx_text" id="S6.T3.1.11.10.3.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.11.10.3.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.11.10.3.3.1" style="color:#662506;">
          +1.2
         </span>
         )
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S6.T3.1.11.10.4" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.11.10.4.1" style="font-size:80%;color:#6A51A3;">
         45.9
        </span>
        <span class="ltx_text" id="S6.T3.1.11.10.4.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.11.10.4.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.11.10.4.3.1" style="color:#3F007D;">
          +15.8
         </span>
         )
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S6.T3.1.12.11">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S6.T3.1.12.11.1" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.12.11.1.1" style="font-size:80%;">
         Iteration 1 RISE Model trained on GSM8K
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.12.11.2" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.12.11.2.1" style="font-size:80%;">
         42.2
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T3.1.12.11.3" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.12.11.3.1" style="font-size:80%;color:#D95F0E;">
         50.0
        </span>
        <span class="ltx_text" id="S6.T3.1.12.11.3.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.12.11.3.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.12.11.3.3.1" style="color:#662506;">
          +7.8
         </span>
         )
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.12.11.4" style="padding:-0.05pt 3.4pt;">
        <span class="ltx_text" id="S6.T3.1.12.11.4.1" style="font-size:80%;color:#6A51A3;">
         63.6
        </span>
        <span class="ltx_text" id="S6.T3.1.12.11.4.2" style="font-size:80%;">
        </span>
        <span class="ltx_text" id="S6.T3.1.12.11.4.3" style="font-size:70%;">
         (
         <span class="ltx_text" id="S6.T3.1.12.11.4.3.1" style="color:#3F007D;">
          +21.4
         </span>
         )
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <figcaption class="ltx_caption ltx_centering" style="font-size:80%;">
     <span class="ltx_tag ltx_tag_table">
      <span class="ltx_text" id="S6.T3.6.1.1" style="font-size:113%;">
       Table 3
      </span>
      :
     </span>
     <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S6.T3.7.2">
      Out-of-distribution generalization of RISE.
     </em>
     We evaluate model fine-tuned on MATH on the GSM8K test set; model fine-tuned GSM8K on MATH; and the model fine-tuned on a mixture of GSM8K and MATH on the SVAMP data. Observe even though we train on OOD prompts, RISE can still improve sequential performance.
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="S6.SS4">
   <h4 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     6.4
    </span>
    What Data Compositions and Data Quantity are Crucial for RISE?
   </h4>
   <div class="ltx_para" id="S6.SS4.p1">
    <p class="ltx_p" id="S6.SS4.p1.1">
     We now study how different data compositions affect the performance of RISE with the goal of answering questions such as
     <em class="ltx_emph ltx_font_italic" id="S6.SS4.p1.1.1">
      should we collect on-policy error correction data like DAgger
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib36" title="">
        36
       </a>
       ]
      </cite>
      or should we bias towards high-quality off-policy data?
     </em>
     . To understand the utility of different data compositions, we enlist the three aspects RISE:
     <span class="ltx_text ltx_font_bold" id="S6.SS4.p1.1.2">
      (a)
     </span>
     the use of multi-turn rollout data for fine-tuning,
     <span class="ltx_text ltx_font_bold" id="S6.SS4.p1.1.3">
      (b)
     </span>
     the use of unsuccessful / suboptimal rollouts via weighted supervised fine-tuning compared to naïve supervised learning, which only utilizes successful rollouts for fine-tuning; and
     <span class="ltx_text ltx_font_bold" id="S6.SS4.p1.1.4">
      (c)
     </span>
     the use of on-policy rollouts and self-generated or oracle data. We will now perform controlled experiments to understand the effect of each of these factors on the overall performance of RISE.
    </p>
   </div>
   <figure class="ltx_figure" id="S6.F7">
    <div class="ltx_flex_figure">
     <div class="ltx_flex_cell ltx_flex_size_2">
      <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="189" id="S6.F7.g1" src="/html/2407.18219/assets/a_multi_turn_interaction.png" width="252"/>
     </div>
     <div class="ltx_flex_cell ltx_flex_size_2">
      <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="189" id="S6.F7.g2" src="/html/2407.18219/assets/b_fail_samples.png" width="252"/>
     </div>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="S6.F7.4.1.1" style="font-size:90%;">
       Figure 7
      </span>
      :
     </span>
     <span class="ltx_text" id="S6.F7.5.2" style="font-size:90%;">
      <em class="ltx_emph ltx_font_italic" id="S6.F7.5.2.1" style="font-size:89%;">
       <span class="ltx_text ltx_font_bold" id="S6.F7.5.2.1.1">
        Left:
       </span>
       <span class="ltx_text ltx_font_bold" id="S6.F7.5.2.1.2">
        The importance of multi-turn interaction history and weighted objectives for training RISE.
       </span>
      </em>
      <span class="ltx_text" id="S6.F7.5.2.2" style="font-size:89%;">
       Note that training with multi-turn data leads to better self-improvement performance at the end of 5 turns, than one-turn data obtained from the original dataset with oracle answers from another model; also observe that using a weighted objective performs better.
       <em class="ltx_emph ltx_font_italic" id="S6.F7.5.2.2.1">
        <span class="ltx_text ltx_font_bold" id="S6.F7.5.2.2.1.1">
         Right:
        </span>
        <span class="ltx_text ltx_font_bold" id="S6.F7.5.2.2.1.2">
         The importance of using all rollouts for learning
        </span>
       </em>
       , instead of only successful rollouts or only successful responses in the data. Using all data performs best in our results.
      </span>
     </span>
    </figcaption>
   </figure>
   <div class="ltx_para ltx_noindent" id="S6.SS4.p2">
    <p class="ltx_p" id="S6.SS4.p2.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS4.p2.1.1">
      (a) Data composition for fine-tuning.
     </span>
     We first study the necessity of using the interaction of error correction history for training RISE in Figure
     <a class="ltx_ref" href="#S6.F7" title="Figure 7 ‣ 6.4 What Data Compositions and Data Quantity are Crucial for RISE? ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     (Left). We compare two approaches: model trained with oracle answers shown right after the query (“1-turn”) and oracle answers shown after intermediate failed attempts (“Multi-turn”) in Figure
     <a class="ltx_ref" href="#S6.F7" title="Figure 7 ‣ 6.4 What Data Compositions and Data Quantity are Crucial for RISE? ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     (Left). Even though the latter trains on intermediate responses that may not always be correct, it attains a higher performance than simply training on the correct response for a given prompt. This highlights the importance of training on contexts that include a multi-turn interaction history depicting mistakes from the learner to improve self-improvement capabilities.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S6.SS4.p3">
    <p class="ltx_p" id="S6.SS4.p3.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS4.p3.1.1">
      (b) Weighted supervised learning vs unweighted supervised learning.
     </span>
     Next, we investigate the effect of reward-weighted RL on multi-turn data in RISE as opposed to simply imitating filtered successful data. We find that using all the data leads to improved performance over simply filtering good datain Figure
     <a class="ltx_ref" href="#S6.F7" title="Figure 7 ‣ 6.4 What Data Compositions and Data Quantity are Crucial for RISE? ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     (Right), which reduces sample size. In Figure
     <a class="ltx_ref" href="#S6.F7" title="Figure 7 ‣ 6.4 What Data Compositions and Data Quantity are Crucial for RISE? ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     (Left), we find that reward-weighted training improves performance on later turns, allowing us to better leverage all the sub-optimal data.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S6.SS4.p4">
    <p class="ltx_p" id="S6.SS4.p4.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS4.p4.1.1">
      (c) On-policy vs off-policy data; self-generated vs. expert data.
     </span>
     RISE runs on-policy rollouts and seeks improvements on responses that the learner produces. As shown in Figure
     <a class="ltx_ref" href="#S6.F8" title="Figure 8 ‣ 6.4 What Data Compositions and Data Quantity are Crucial for RISE? ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       8
      </span>
     </a>
     (Left), a “DAgger
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib36" title="">
       36
      </a>
      ]
     </cite>
     ”-style approach that seeks improvements on responses appearing in on-policy rollouts improves performance (green/orange) compared to using expert data alone (blue/pink). Conceptually, this addresses the train-test mismatch between the distribution of context tokens, enabling imitation learning methods to now target the correct distribution. In addition, recent work
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib24" title="">
       24
      </a>
      ]
     </cite>
     has shown that LLMs often memorize “unfamiliar” examples generated by oracle models; by training on on-policy rollouts, we should be able to eliminate any such potential issues. Thus, while the model trained via offline imitation is able to reduce loss, these improvements do not generalize to new problems.
    </p>
   </div>
   <figure class="ltx_figure" id="S6.F8">
    <div class="ltx_flex_figure">
     <div class="ltx_flex_cell ltx_flex_size_2">
      <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="189" id="S6.F8.g1" src="/html/2407.18219/assets/c_iterative_ablation.png" width="252"/>
     </div>
     <div class="ltx_flex_cell ltx_flex_size_2">
      <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="189" id="S6.F8.g2" src="/html/2407.18219/assets/pass_vs_seq.png" width="252"/>
     </div>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="S6.F8.11.5.1" style="font-size:90%;">
       Figure 8
      </span>
      :
     </span>
     <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S6.F8.12.6" style="font-size:80%;">
      Left: The importance of data sources used for training.
     </em>
     <span class="ltx_text" id="S6.F8.8.4" style="font-size:80%;">
      We study the performance of the iteration 1 of RISE on GSM8K with different data sources. “Expert” refers to the use of an oracle model, “On-policy” corresponds to sampling from the learner, and “Best-of-N” means using the best sample out of
      <math alttext="N" class="ltx_Math" display="inline" id="S6.F8.5.1.m1.1">
       <semantics id="S6.F8.5.1.m1.1b">
        <mi id="S6.F8.5.1.m1.1.1" xref="S6.F8.5.1.m1.1.1.cmml">
         N
        </mi>
        <annotation-xml encoding="MathML-Content" id="S6.F8.5.1.m1.1c">
         <ci id="S6.F8.5.1.m1.1.1.cmml" xref="S6.F8.5.1.m1.1.1">
          𝑁
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S6.F8.5.1.m1.1d">
         N
        </annotation>
       </semantics>
      </math>
      from the learner (here
      <math alttext="N=16" class="ltx_Math" display="inline" id="S6.F8.6.2.m2.1">
       <semantics id="S6.F8.6.2.m2.1b">
        <mrow id="S6.F8.6.2.m2.1.1" xref="S6.F8.6.2.m2.1.1.cmml">
         <mi id="S6.F8.6.2.m2.1.1.2" xref="S6.F8.6.2.m2.1.1.2.cmml">
          N
         </mi>
         <mo id="S6.F8.6.2.m2.1.1.1" xref="S6.F8.6.2.m2.1.1.1.cmml">
          =
         </mo>
         <mn id="S6.F8.6.2.m2.1.1.3" xref="S6.F8.6.2.m2.1.1.3.cmml">
          16
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="S6.F8.6.2.m2.1c">
         <apply id="S6.F8.6.2.m2.1.1.cmml" xref="S6.F8.6.2.m2.1.1">
          <eq id="S6.F8.6.2.m2.1.1.1.cmml" xref="S6.F8.6.2.m2.1.1.1">
          </eq>
          <ci id="S6.F8.6.2.m2.1.1.2.cmml" xref="S6.F8.6.2.m2.1.1.2">
           𝑁
          </ci>
          <cn id="S6.F8.6.2.m2.1.1.3.cmml" type="integer" xref="S6.F8.6.2.m2.1.1.3">
           16
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S6.F8.6.2.m2.1d">
         N=16
        </annotation>
       </semantics>
      </math>
      ).
      <em class="ltx_emph ltx_font_italic" id="S6.F8.8.4.1">
       <span class="ltx_text ltx_font_bold" id="S6.F8.8.4.1.1">
        Right:
       </span>
       <span class="ltx_text ltx_font_bold" id="S6.F8.8.4.1.2">
        Comparing RISE with oracle error feedback (pass@1 @ turn k; solid lines) to parallel sampling of 5 responses at turn 1 (pass@k @ turn 1; dashed lines)
       </span>
      </em>
      over number of turns
      <math alttext="k" class="ltx_Math" display="inline" id="S6.F8.7.3.m3.1">
       <semantics id="S6.F8.7.3.m3.1b">
        <mi id="S6.F8.7.3.m3.1.1" xref="S6.F8.7.3.m3.1.1.cmml">
         k
        </mi>
        <annotation-xml encoding="MathML-Content" id="S6.F8.7.3.m3.1c">
         <ci id="S6.F8.7.3.m3.1.1.cmml" xref="S6.F8.7.3.m3.1.1">
          𝑘
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S6.F8.7.3.m3.1d">
         k
        </annotation>
       </semantics>
      </math>
      on the x-axis on GSM8K. Observe that sequential sampling with Iteration 1 and Iteration 2 RISE models consistently outperforms parallel sampling for all values of turn
      <math alttext="k" class="ltx_Math" display="inline" id="S6.F8.8.4.m4.1">
       <semantics id="S6.F8.8.4.m4.1b">
        <mi id="S6.F8.8.4.m4.1.1" xref="S6.F8.8.4.m4.1.1.cmml">
         k
        </mi>
        <annotation-xml encoding="MathML-Content" id="S6.F8.8.4.m4.1c">
         <ci id="S6.F8.8.4.m4.1.1.cmml" xref="S6.F8.8.4.m4.1.1">
          𝑘
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S6.F8.8.4.m4.1d">
         k
        </annotation>
       </semantics>
      </math>
      ; and the gap grows as the number of iterations increases. In contrast, this trend is absent for base and SFT models.
     </span>
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="S6.SS5">
   <h4 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     6.5
    </span>
    Pass@K vs Sequential Sampling via RISE
   </h4>
   <div class="ltx_para ltx_noindent" id="S6.SS5.p1">
    <p class="ltx_p" id="S6.SS5.p1.1">
     We now study the performance of sequential sampling with oracle feedback in GSM8K, unlike relying on majority voting as in Table
     <a class="ltx_ref" href="#S6.T1" title="Table 1 ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     . Specifically, we compare the performance of RISE with early termination of evaluation rollouts against pass@5 (not maj@5) performance of the RISE model at the first turn (which makes an equal number of queries to the ground-truth correctness indicator). Access to ground-truth correctness indicator is expected to improve performance for both parallel and sequential sampling unsurprisingly, but we see in Figure
     <a class="ltx_ref" href="#S6.F8" title="Figure 8 ‣ 6.4 What Data Compositions and Data Quantity are Crucial for RISE? ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       8
      </span>
     </a>
     (Right) that RISE is able to improve performance more beyond simply sampling more samples at the first turn and computing pass@K, despite this strong assumption of access to an oracle final answer verifier made by the parallel sampling approach.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S6.SS5.p2">
    <p class="ltx_p" id="S6.SS5.p2.1">
     We would expect parallel sampling via pass@K to be most performant when provided access to oracle answer checking as the model can choose to simply sample
     <math alttext="K" class="ltx_Math" display="inline" id="S6.SS5.p2.1.m1.1">
      <semantics id="S6.SS5.p2.1.m1.1a">
       <mi id="S6.SS5.p2.1.m1.1.1" xref="S6.SS5.p2.1.m1.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S6.SS5.p2.1.m1.1b">
        <ci id="S6.SS5.p2.1.m1.1.1.cmml" xref="S6.SS5.p2.1.m1.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S6.SS5.p2.1.m1.1c">
        K
       </annotation>
      </semantics>
     </math>
     <em class="ltx_emph ltx_font_italic" id="S6.SS5.p2.1.1">
      independent
     </em>
     responses, if the base model accuracy on this task is reasonable. Pass@K @ turn 1 also upper bounds the first turn accuracy of any procedure that does not query the oracle (e.g., with verifiers, with majority voting, etc.). Hence, access to oracle answer checking for each individual response presents the strongest result one
     <em class="ltx_emph ltx_font_italic" id="S6.SS5.p2.1.2">
      could
     </em>
     expect out of parallel sampling, in one turn. On the other hand, sequential sampling produces
     <em class="ltx_emph ltx_font_italic" id="S6.SS5.p2.1.3">
      correlated
     </em>
     samples and hence should, in principle, not be able to improve over parallel sampling,
     <em class="ltx_emph ltx_font_italic" id="S6.SS5.p2.1.4">
      unless
     </em>
     the model is unable to use the additional tokens and computation provided by the feedback self-improvement prompt to meaningfully correct itself. Since the sequential performance of the model is larger than the parallel performance above, this means that RISE indeed does this successfully.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S6.SS6">
   <h4 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     6.6
    </span>
    Error Analysis of RISE over Turns
   </h4>
   <div class="ltx_para ltx_noindent" id="S6.SS6.p1">
    <p class="ltx_p" id="S6.SS6.p1.1">
     Following the protocol of
     <cite class="ltx_cite ltx_citemacro_citet">
      Huang et al. [
      <a class="ltx_ref" href="#bib.bib21" title="">
       21
      </a>
      ]
     </cite>
     , in this section, we perform an error analysis of the improvement performed by RISE (without any oracle feedback) to understand how the fraction of incorrect and correct responses changes over turns, when
     <span class="ltx_text ltx_font_bold" id="S6.SS6.p1.1.1">
      no oracle
     </span>
     is used for early termination. We demonstrate this in the form of Venn diagrams in Figure
     <a class="ltx_ref" href="#S6.F9" title="Figure 9 ‣ 6.6 Error Analysis of RISE over Turns ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
     . First note that there is a consistent increase in the portion of problems that stay correct and a consistent decrease in the portion of problems that stay incorrect, which means that the model is able to answer more and more problems as we increase the number of turns. Second, there is a consistent decrease in the number of problems that change from being correct to incorrect, which is often also not the case for strong proprietary LLMs such as GPT in
     <cite class="ltx_cite ltx_citemacro_citet">
      Huang et al. [
      <a class="ltx_ref" href="#bib.bib21" title="">
       21
      </a>
      ]
     </cite>
     . We also note that there is a decrease in the total number of incorrect problems that become correct in the subsequent turn, but this is a direct consequence of a shrinkage in the size of the incorrect response set as more problems become correct over turns. This indicates that one can induce “intrinsic” self-improvement (per the terminology of
     <cite class="ltx_cite ltx_citemacro_citet">
      Huang et al. [
      <a class="ltx_ref" href="#bib.bib21" title="">
       21
      </a>
      ]
     </cite>
     ) via fine-tuning with RISE, even though no external environment input is provided during evaluation.
    </p>
   </div>
   <figure class="ltx_figure" id="S6.F9">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="148" id="S6.F9.g1" src="/html/2407.18219/assets/turn_correctness_change_gsm8k.png" width="592"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="S6.F9.9.4.1" style="font-size:90%;">
       Figure 9
      </span>
      :
     </span>
     <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S6.F9.10.5" style="font-size:80%;">
      Change in the fraction of responses that transition their correctness values over the course of multi-turn rollouts from RISE, w/o oracle.
     </em>
     <span class="ltx_text" id="S6.F9.6.3" style="font-size:80%;">
      Observe that in general, the fraction of Correct
      <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.F9.4.1.m1.1">
       <semantics id="S6.F9.4.1.m1.1b">
        <mo id="S6.F9.4.1.m1.1.1" stretchy="false" xref="S6.F9.4.1.m1.1.1.cmml">
         →
        </mo>
        <annotation-xml encoding="MathML-Content" id="S6.F9.4.1.m1.1c">
         <ci id="S6.F9.4.1.m1.1.1.cmml" xref="S6.F9.4.1.m1.1.1">
          →
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S6.F9.4.1.m1.1d">
         \rightarrow
        </annotation>
       </semantics>
      </math>
      Correct responses increases; Incorrect
      <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.F9.5.2.m2.1">
       <semantics id="S6.F9.5.2.m2.1b">
        <mo id="S6.F9.5.2.m2.1.1" stretchy="false" xref="S6.F9.5.2.m2.1.1.cmml">
         →
        </mo>
        <annotation-xml encoding="MathML-Content" id="S6.F9.5.2.m2.1c">
         <ci id="S6.F9.5.2.m2.1.1.cmml" xref="S6.F9.5.2.m2.1.1">
          →
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S6.F9.5.2.m2.1d">
         \rightarrow
        </annotation>
       </semantics>
      </math>
      Incorrect responses decreases; and the fraction of Correct
      <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.F9.6.3.m3.1">
       <semantics id="S6.F9.6.3.m3.1b">
        <mo id="S6.F9.6.3.m3.1.1" stretchy="false" xref="S6.F9.6.3.m3.1.1.cmml">
         →
        </mo>
        <annotation-xml encoding="MathML-Content" id="S6.F9.6.3.m3.1c">
         <ci id="S6.F9.6.3.m3.1.1.cmml" xref="S6.F9.6.3.m3.1.1">
          →
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S6.F9.6.3.m3.1d">
         \rightarrow
        </annotation>
       </semantics>
      </math>
      Incorrect responses also decreases, indicating that RISE (w/o any oracle) is able to iteratively improve its responses.
     </span>
    </figcaption>
   </figure>
   <div class="ltx_para ltx_noindent" id="S6.SS6.p2">
    <p class="ltx_p" id="S6.SS6.p2.1">
     <span class="ltx_text ltx_font_bold" id="S6.SS6.p2.1.1">
      Qualitative examples.
     </span>
     We also inspect several examples from the GSM8K test set to qualitatively understand the behavior of RISE over turns and observe different behavior patterns, that we show in Appendix
     <a class="ltx_ref" href="#A2.SS2" title="B.2 Qualitative Examples from RISE ‣ Appendix B Additional Results ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       B.2
      </span>
     </a>
     . For instance, the trained model may choose to completely rewrite its previous response if it is totally incorrect in order to get to the correct answer or make small edits if the previous response is mostly correct. Another interesting pattern we note is that the model implicitly has the ability to locate errors in previous responses and only refine the erroneous steps. Additionally, the model is tolerant of noisy environmental feedback when there is no oracle-assisted early termination.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S7" lang="en">
  <h3 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    7
   </span>
   Discussion, Future Directions, and Limitations
  </h3>
  <div class="ltx_para ltx_noindent" id="S7.p1">
   <p class="ltx_p" id="S7.p1.1">
    We presented RISE, an approach for fine-tuning LLMs to be able to improve their own responses over multiple turns sequentially. RISE prescribes an iterative RL recipe on top of on-policy rollout data, with expert or self-generated supervision to steer self-improvement. RISE significantly improves the self-improvement abilities of 7B models on reasoning tasks (GSM8K and MATH), attaining an improvement over turns that previous work
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib21" title="">
      21
     </a>
     ]
    </cite>
    has not observed in strong proprietary models. In addition, RISE outperforms prior approaches that attempt to tackle similar problems of refinement and correction, while being simpler in that it does not require running multiple models and works well with just one model.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S7.p2">
   <p class="ltx_p" id="S7.p2.1">
    Despite these good results, there are still many open questions and limitations. Due to computational constraints, we were not able to perform more than two iterations of training with RISE, and no more than one iteration when the supervision comes from the learner itself. Improving with self-generated supervision will likely require more computation and more iterations, since it will be slower than when using an off-the-shelf expert model. RISE requires running manual iterations and hence, a more “online” variant of RISE is likely the solution in the long run, especially when we wish to scale on-policy learning in a data-efficient manner. Additionally, while our work fine-tunes models on one task at a time, it will be certainly interesting to include data from the protocols specified by RISE into general instruction tuning and post-training pipelines. Given the results that fine-tuning on data prescribed by RISE does not hurt the first-turn performance of any model we trained, we hypothesize that adding this sort of data in general instruction-tuning pipelines should not hurt either, while enabling the sequential self-improvement capability that is largely absent from models today.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="Sx1" lang="en">
  <h3 class="ltx_title ltx_title_section">
   Acknowledgements
  </h3>
  <div class="ltx_para ltx_noindent" id="Sx1.p1">
   <p class="ltx_p" id="Sx1.p1.1">
    This work was done at CMU. We thank Fahim Tajwar, Abitha Thankaraj, Amrith Setlur, and Charlie Snell for their feedback and informative discussions. This work was supported by ONR under N000142412206, OpenAI superalignment fast grants, and used the Delta system and JetStream2
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib16" title="">
      16
     </a>
     ]
    </cite>
    at the National Center for Supercomputing Applications through CIS240249 and CIS230278, supported by the National Science Foundation. We thank OpenAI for providing GPT-4 credits for academic use.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib" lang="en">
  <h3 class="ltx_title ltx_title_bibliography">
   References
  </h3>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Agarwal et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Rishabh Agarwal, Nino Vieillard, Piotr Stanczyk, Sabela Ramos, Matthieu Geist, and Olivier Bachem.
    </span>
    <span class="ltx_bibblock">
     Gkd: Generalized knowledge distillation for auto-regressive sequence models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">
      arXiv preprint arXiv:2306.13649
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bai et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Yuntao Bai, Saurav Kadavath, Sandipan Kundu, Amanda Askell, Jackson Kernion, Andy Jones, Anna Chen, Anna Goldie, Azalia Mirhoseini, Cameron McKinnon, et al.
    </span>
    <span class="ltx_bibblock">
     Constitutional ai: Harmlessness from ai feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">
      arXiv preprint arXiv:2212.08073
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Burns et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Collin Burns, Pavel Izmailov, Jan Hendrik Kirchner, Bowen Baker, Leo Gao, Leopold Aschenbrenner, Yining Chen, Adrien Ecoffet, Manas Joglekar, Jan Leike, Ilya Sutskever, and Jeff Wu.
    </span>
    <span class="ltx_bibblock">
     Weak-to-strong generalization: Eliciting strong capabilities with weak supervision, 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2312.09390" target="_blank" title="">
      https://arxiv.org/abs/2312.09390
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chang et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Jonathan D Chang, Wenhao Shan, Owen Oertell, Kianté Brantley, Dipendra Misra, Jason D Lee, and Wen Sun.
    </span>
    <span class="ltx_bibblock">
     Dataset reset policy optimization for rlhf.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">
      arXiv preprint arXiv:2404.08495
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Charalambous et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Yiannis Charalambous, Norbert Tihanyi, Ridhi Jain, Youcheng Sun, Mohamed Amine Ferrag, and Lucas C Cordeiro.
    </span>
    <span class="ltx_bibblock">
     A new era in software security: Towards self-healing software via large language models and formal verification.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">
      arXiv preprint arXiv:2305.14752
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al. [2023a]
    </span>
    <span class="ltx_bibblock">
     Baian Chen, Chang Shu, Ehsan Shareghi, Nigel Collier, Karthik Narasimhan, and Shunyu Yao.
    </span>
    <span class="ltx_bibblock">
     Fireact: Toward language agent fine-tuning, 2023a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al. [2023b]
    </span>
    <span class="ltx_bibblock">
     Xinyun Chen, Maxwell Lin, Nathanael Schärli, and Denny Zhou.
    </span>
    <span class="ltx_bibblock">
     Teaching large language models to self-debug.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">
      arXiv preprint arXiv:2304.05128
     </em>
     , 2023b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Zixiang Chen, Yihe Deng, Huizhuo Yuan, Kaixuan Ji, and Quanquan Gu.
    </span>
    <span class="ltx_bibblock">
     Self-play fine-tuning converts weak language models to strong language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">
      arXiv preprint arXiv:2401.01335
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chia et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Yew Ken Chia, Guizhen Chen, Luu Anh Tuan, Soujanya Poria, and Lidong Bing.
    </span>
    <span class="ltx_bibblock">
     Contrastive chain-of-thought prompting.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">
      arXiv preprint arXiv:2311.09277
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cobbe et al. [2019]
    </span>
    <span class="ltx_bibblock">
     Karl Cobbe, Christopher Hesse, Jacob Hilton, and John Schulman.
    </span>
    <span class="ltx_bibblock">
     Leveraging procedural generation to benchmark reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">
      arXiv preprint arXiv:1912.01588
     </em>
     , 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cobbe et al. [2021]
    </span>
    <span class="ltx_bibblock">
     Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Mark Chen, Heewoo Jun, Lukasz Kaiser, Matthias Plappert, Jerry Tworek, Jacob Hilton, Reiichiro Nakano, Christopher Hesse, and John Schulman.
    </span>
    <span class="ltx_bibblock">
     Training verifiers to solve math word problems.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">
      arXiv preprint arXiv:2110.14168
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Du et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Yilun Du, Shuang Li, Antonio Torralba, Joshua B Tenenbaum, and Igor Mordatch.
    </span>
    <span class="ltx_bibblock">
     Improving factuality and reasoning in language models through multiagent debate.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">
      arXiv preprint arXiv:2305.14325
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Gandhi et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Kanishk Gandhi, Denise Lee, Gabriel Grand, Muxin Liu, Winson Cheng, Archit Sharma, and Noah D Goodman.
    </span>
    <span class="ltx_bibblock">
     Stream of search (sos): Learning to search in language.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">
      arXiv preprint arXiv:2404.03683
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Gao et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Luyu Gao, Aman Madaan, Shuyan Zhou, Uri Alon, Pengfei Liu, Yiming Yang, Jamie Callan, and Graham Neubig.
    </span>
    <span class="ltx_bibblock">
     Pal: Program-aided language models.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">
      International Conference on Machine Learning
     </em>
     , pages 10764–10799. PMLR, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Gou et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Zhibin Gou, Zhihong Shao, Yeyun Gong, Yelong Shen, Yujiu Yang, Nan Duan, and Weizhu Chen.
    </span>
    <span class="ltx_bibblock">
     Critic: Large Language Models can Self-Correct with Tool-Interactive Critiquing.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">
      arXiv preprint arXiv:2305.11738
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hancock et al. [2021]
    </span>
    <span class="ltx_bibblock">
     David Y. Hancock, Jeremy Fischer, John Michael Lowe, Winona Snapp-Childs, Marlon Pierce, Suresh Marru, J. Eric Coulter, Matthew Vaughn, Brian Beck, Nirav Merchant, Edwin Skidmore, and Gwen Jacobs.
    </span>
    <span class="ltx_bibblock">
     Jetstream2: Accelerating cloud computing via jetstream.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">
      Practice and Experience in Advanced Research Computing
     </em>
     , PEARC ’21, New York, NY, USA, 2021. Association for Computing Machinery.
    </span>
    <span class="ltx_bibblock">
     ISBN 9781450382922.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref" href="https:/doi.org/10.1145/3437359.3465565" target="_blank" title="">
      10.1145/3437359.3465565
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3437359.3465565" target="_blank" title="">
      https://doi.org/10.1145/3437359.3465565
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Havrilla et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Alex Havrilla, Sharath Raparthy, Christoforus Nalmpantis, Jane Dwivedi-Yu, Maksym Zhuravinskyi, Eric Hambro, and Roberta Railneau.
    </span>
    <span class="ltx_bibblock">
     Glore: When, where, and how to improve llm reasoning via global and local refinements.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">
      arXiv preprint arXiv:2402.10963
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hendrycks et al. [2021]
    </span>
    <span class="ltx_bibblock">
     Dan Hendrycks, Collin Burns, Saurav Kadavath, Akul Arora, Steven Basart, Eric Tang, Dawn Song, and Jacob Steinhardt.
    </span>
    <span class="ltx_bibblock">
     Measuring mathematical problem solving with the math dataset.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">
      NeurIPS
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hosseini et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Arian Hosseini, Xingdi Yuan, Nikolay Malkin, Aaron Courville, Alessandro Sordoni, and Rishabh Agarwal.
    </span>
    <span class="ltx_bibblock">
     V-star: Training verifiers for self-taught reasoners.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">
      arXiv preprint arXiv:2402.06457
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Huang et al. [2023a]
    </span>
    <span class="ltx_bibblock">
     Dong Huang, Qingwen Bu, Jie M Zhang, Michael Luck, and Heming Cui.
    </span>
    <span class="ltx_bibblock">
     Agentcoder: Multi-agent-based code generation with iterative testing and optimisation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">
      arXiv preprint arXiv:2312.13010
     </em>
     , 2023a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Huang et al. [2023b]
    </span>
    <span class="ltx_bibblock">
     Jie Huang, Xinyun Chen, Swaroop Mishra, Huaixiu Steven Zheng, Adams Wei Yu, Xinying Song, and Denny Zhou.
    </span>
    <span class="ltx_bibblock">
     Large language models cannot self-correct reasoning yet.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">
      arXiv preprint arXiv:2310.01798
     </em>
     , 2023b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Huang et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Wenlong Huang, Pieter Abbeel, Deepak Pathak, and Igor Mordatch.
    </span>
    <span class="ltx_bibblock">
     Language models as zero-shot planners: Extracting actionable knowledge for embodied agents.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">
      International Conference on Machine Learning
     </em>
     , pages 9118–9147. PMLR, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jiang et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Albert Q Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, et al.
    </span>
    <span class="ltx_bibblock">
     Mistral 7b.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">
      arXiv preprint arXiv:2310.06825
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kang et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Katie Kang, Eric Wallace, Claire Tomlin, Aviral Kumar, and Sergey Levine.
    </span>
    <span class="ltx_bibblock">
     Unfamiliar finetuning examples control how language models hallucinate, 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kingma and Welling [2022]
    </span>
    <span class="ltx_bibblock">
     Diederik P Kingma and Max Welling.
    </span>
    <span class="ltx_bibblock">
     Auto-encoding variational bayes, 2022.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1312.6114" target="_blank" title="">
      https://arxiv.org/abs/1312.6114
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lehnert et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Lucas Lehnert, Sainbayar Sukhbaatar, Paul Mcvay, Michael Rabbat, and Yuandong Tian.
    </span>
    <span class="ltx_bibblock">
     Beyond a*: Better planning with transformers via search dynamics bootstrapping.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">
      arXiv preprint arXiv:2402.14083
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Chen Li, Weiqi Wang, Jingcheng Hu, Yixuan Wei, Nanning Zheng, Han Hu, Zheng Zhang, and Houwen Peng.
    </span>
    <span class="ltx_bibblock">
     Common 7b language models already possess strong math capabilities.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">
      arXiv preprint arXiv:2403.04706
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lightman et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Hunter Lightman, Vineet Kosaraju, Yura Burda, Harri Edwards, Bowen Baker, Teddy Lee, Jan Leike, John Schulman, Ilya Sutskever, and Karl Cobbe.
    </span>
    <span class="ltx_bibblock">
     Let’s verify step by step.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">
      arXiv preprint arXiv:2305.20050
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Liu et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Xiao Liu, Hao Yu, Hanchen Zhang, Yifan Xu, Xuanyu Lei, Hanyu Lai, Yu Gu, Hangliang Ding, Kaiwen Men, Kejuan Yang, et al.
    </span>
    <span class="ltx_bibblock">
     Agentbench: Evaluating llms as agents.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">
      arXiv preprint arXiv:2308.03688
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Luo et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Haipeng Luo, Qingfeng Sun, Can Xu, Pu Zhao, Jianguang Lou, Chongyang Tao, Xiubo Geng, Qingwei Lin, Shifeng Chen, and Dongmei Zhang.
    </span>
    <span class="ltx_bibblock">
     Wizardmath: Empowering mathematical reasoning for large language models via reinforced evol-instruct.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">
      arXiv preprint arXiv:2308.09583
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Madaan et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Aman Madaan, Niket Tandon, Prakhar Gupta, Skyler Hallinan, Luyu Gao, Sarah Wiegreffe, Uri Alon, Nouha Dziri, Shrimai Prabhumoye, Yiming Yang, et al.
    </span>
    <span class="ltx_bibblock">
     Self-refine: Iterative refinement with self-feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">
      arXiv preprint arXiv:2303.17651
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Nijkamp et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Erik Nijkamp, Bo Pang, Hiroaki Hayashi, Lifu Tu, Huan Wang, Yingbo Zhou, Silvio Savarese, and Caiming Xiong.
    </span>
    <span class="ltx_bibblock">
     CodeGen: An Open Large Language Model for Code with Multi-Turn Program Synthesis.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">
      ICLR
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Nye et al. [2021]
    </span>
    <span class="ltx_bibblock">
     Maxwell Nye, Anders Johan Andreassen, Guy Gur-Ari, Henryk Michalewski, Jacob Austin, David Bieber, David Dohan, Aitor Lewkowycz, Maarten Bosma, David Luan, et al.
    </span>
    <span class="ltx_bibblock">
     Show your work: Scratchpads for intermediate computation with language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">
      arXiv preprint arXiv:2112.00114
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Peng et al. [2019]
    </span>
    <span class="ltx_bibblock">
     Xue Bin Peng, Aviral Kumar, Grace Zhang, and Sergey Levine.
    </span>
    <span class="ltx_bibblock">
     Advantage-weighted regression: Simple and scalable off-policy reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">
      arXiv preprint arXiv:1910.00177
     </em>
     , 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Peters and Schaal [2007]
    </span>
    <span class="ltx_bibblock">
     Jan Peters and Stefan Schaal.
    </span>
    <span class="ltx_bibblock">
     Reinforcement learning by reward-weighted regression for operational space control.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">
      Proceedings of the 24th international conference on Machine learning
     </em>
     , pages 745–750. ACM, 2007.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ross et al. [2011]
    </span>
    <span class="ltx_bibblock">
     Stephane Ross, Geoffrey Gordon, and Drew Bagnell.
    </span>
    <span class="ltx_bibblock">
     A reduction of imitation learning and structured prediction to no-regret online learning.
    </span>
    <span class="ltx_bibblock">
     In Geoffrey Gordon, David Dunson, and Miroslav Dudík, editors,
     <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">
      Proceedings of the Fourteenth International Conference on Artificial Intelligence and Statistics
     </em>
     , volume 15 of
     <em class="ltx_emph ltx_font_italic" id="bib.bib36.2.2">
      Proceedings of Machine Learning Research
     </em>
     , pages 627–635, Fort Lauderdale, FL, USA, 11–13 Apr 2011. PMLR.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://proceedings.mlr.press/v15/ross11a.html" target="_blank" title="">
      http://proceedings.mlr.press/v15/ross11a.html
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Rosset et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Corby Rosset, Ching-An Cheng, Arindam Mitra, Michael Santacroce, Ahmed Awadallah, and Tengyang Xie.
    </span>
    <span class="ltx_bibblock">
     Direct nash optimization: Teaching language models to self-improve with general preferences.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">
      arXiv preprint arXiv:2404.03715
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Saha et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Swarnadeep Saha, Omer Levy, Asli Celikyilmaz, Mohit Bansal, Jason Weston, and Xian Li.
    </span>
    <span class="ltx_bibblock">
     Branch-solve-merge improves large language model evaluation and generation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">
      arXiv preprint arXiv:2310.15123
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Schick et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Timo Schick, Jane Dwivedi-Yu, Roberto Dessì, Roberta Raileanu, Maria Lomeli, Luke Zettlemoyer, Nicola Cancedda, and Thomas Scialom.
    </span>
    <span class="ltx_bibblock">
     Toolformer: Language models can teach themselves to use tools.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">
      arXiv preprint arXiv:2302.04761
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib40">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shinn et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Noah Shinn, Beck Labash, and Ashwin Gopinath.
    </span>
    <span class="ltx_bibblock">
     Reflexion: an autonomous agent with dynamic memory and self-reflection.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">
      arXiv preprint arXiv:2303.11366
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib41">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Snell et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Charlie Snell, Ilya Kostrikov, Yi Su, Mengjiao Yang, and Sergey Levine.
    </span>
    <span class="ltx_bibblock">
     Offline rl for natural language generation with implicit language q learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">
      arXiv preprint arXiv:2206.11871
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib42">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Sohl-Dickstein et al. [2015]
    </span>
    <span class="ltx_bibblock">
     Jascha Sohl-Dickstein, Eric A. Weiss, Niru Maheswaranathan, and Surya Ganguli.
    </span>
    <span class="ltx_bibblock">
     Deep unsupervised learning using nonequilibrium thermodynamics, 2015.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1503.03585" target="_blank" title="">
      https://arxiv.org/abs/1503.03585
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib43">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Song and Kingma [2021]
    </span>
    <span class="ltx_bibblock">
     Yang Song and Diederik P. Kingma.
    </span>
    <span class="ltx_bibblock">
     How to train your energy-based models, 2021.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2101.03288" target="_blank" title="">
      https://arxiv.org/abs/2101.03288
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib44">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Sun et al. [2018]
    </span>
    <span class="ltx_bibblock">
     Liting Sun, Cheng Peng, Wei Zhan, and Masayoshi Tomizuka.
    </span>
    <span class="ltx_bibblock">
     A fast integrated planning and control framework for autonomous driving via imitation learning.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">
      Dynamic Systems and Control Conference
     </em>
     , volume 51913, page V003T37A012. American Society of Mechanical Engineers, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib45">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Swamy et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Gokul Swamy, Sanjiban Choudhury, J. Andrew Bagnell, and Zhiwei Steven Wu.
    </span>
    <span class="ltx_bibblock">
     Inverse reinforcement learning without reinforcement learning, 2024.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2303.14623" target="_blank" title="">
      https://arxiv.org/abs/2303.14623
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib46">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Toshniwal et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Shubham Toshniwal, Ivan Moshkov, Sean Narenthiran, Daria Gitman, Fei Jia, and Igor Gitman.
    </span>
    <span class="ltx_bibblock">
     Openmathinstruct-1: A 1.8 million math instruction tuning dataset.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">
      arXiv preprint arXiv:2402.10176
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib47">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Uesato et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Jonathan Uesato, Nate Kushman, Ramana Kumar, Francis Song, Noah Siegel, Lisa Wang, Antonia Creswell, Geoffrey Irving, and Irina Higgins.
    </span>
    <span class="ltx_bibblock">
     Solving math word problems with process-and outcome-based feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">
      arXiv preprint arXiv:2211.14275
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib48">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2022a]
    </span>
    <span class="ltx_bibblock">
     Boshi Wang, Sewon Min, Xiang Deng, Jiaming Shen, You Wu, Luke Zettlemoyer, and Huan Sun.
    </span>
    <span class="ltx_bibblock">
     Towards understanding chain-of-thought prompting: An empirical study of what matters.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">
      arXiv preprint arXiv:2212.10001
     </em>
     , 2022a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib49">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2023a]
    </span>
    <span class="ltx_bibblock">
     Guanzhi Wang, Yuqi Xie, Yunfan Jiang, Ajay Mandlekar, Chaowei Xiao, Yuke Zhu, Linxi Fan, and Anima Anandkumar.
    </span>
    <span class="ltx_bibblock">
     Voyager: An open-ended embodied agent with large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">
      arXiv preprint arXiv: Arxiv-2305.16291
     </em>
     , 2023a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib50">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2023b]
    </span>
    <span class="ltx_bibblock">
     Peiyi Wang, Lei Li, Zhihong Shao, RX Xu, Damai Dai, Yifei Li, Deli Chen, Y Wu, and Zhifang Sui.
    </span>
    <span class="ltx_bibblock">
     Math-shepherd: Verify and reinforce llms step-by-step without human annotations.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">
      CoRR, abs/2312.08935
     </em>
     , 2023b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib51">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2022b]
    </span>
    <span class="ltx_bibblock">
     Xuezhi Wang, Jason Wei, Dale Schuurmans, Quoc Le, Ed Chi, Sharan Narang, Aakanksha Chowdhery, and Denny Zhou.
    </span>
    <span class="ltx_bibblock">
     Self-consistency improves chain of thought reasoning in language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">
      arXiv preprint arXiv:2203.11171
     </em>
     , 2022b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib52">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wei et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Fei Xia, Ed Chi, Quoc V Le, Denny Zhou, et al.
    </span>
    <span class="ltx_bibblock">
     Chain-of-Thought Prompting Elicits Reasoning in Large Language Models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">
      NeurIPS
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib53">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Welleck et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Sean Welleck, Ximing Lu, Peter West, Faeze Brahman, Tianxiao Shen, Daniel Khashabi, and Yejin Choi.
    </span>
    <span class="ltx_bibblock">
     Generating sequences by learning to self-correct.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">
      The Eleventh International Conference on Learning Representations
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=hH36JeQZDaO" target="_blank" title="">
      https://openreview.net/forum?id=hH36JeQZDaO
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib54">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yang et al. [2023a]
    </span>
    <span class="ltx_bibblock">
     Hui Yang, Sifu Yue, and Yunzhong He.
    </span>
    <span class="ltx_bibblock">
     Auto-gpt for online decision making: Benchmarks and additional opinions.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">
      arXiv preprint arXiv:2306.02224
     </em>
     , 2023a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib55">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yang et al. [2023b]
    </span>
    <span class="ltx_bibblock">
     Kaiyu Yang, Aidan M Swope, Alex Gu, Rahul Chalamala, Peiyang Song, Shixing Yu, Saad Godil, Ryan Prenger, and Anima Anandkumar.
    </span>
    <span class="ltx_bibblock">
     LeanDojo: Theorem Proving with Retrieval-Augmented Language Models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">
      arXiv preprint arXiv:2306.15626
     </em>
     , 2023b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib56">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yao et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Shunyu Yao, Jeffrey Zhao, Dian Yu, Nan Du, Izhak Shafran, Karthik Narasimhan, and Yuan Cao.
    </span>
    <span class="ltx_bibblock">
     React: Synergizing reasoning and acting in language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">
      arXiv preprint arXiv:2210.03629
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib57">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yu et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Longhui Yu, Weisen Jiang, Han Shi, Jincheng Yu, Zhengying Liu, Yu Zhang, James T Kwok, Zhenguo Li, Adrian Weller, and Weiyang Liu.
    </span>
    <span class="ltx_bibblock">
     Metamath: Bootstrap your own mathematical questions for large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">
      arXiv preprint arXiv:2309.12284
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib58">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yuan et al. [2024a]
    </span>
    <span class="ltx_bibblock">
     Lifan Yuan, Ganqu Cui, Hanbin Wang, Ning Ding, Xingyao Wang, Jia Deng, Boji Shan, Huimin Chen, Ruobing Xie, Yankai Lin, et al.
    </span>
    <span class="ltx_bibblock">
     Advancing llm reasoning generalists with preference trees.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">
      arXiv preprint arXiv:2404.02078
     </em>
     , 2024a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib59">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yuan et al. [2024b]
    </span>
    <span class="ltx_bibblock">
     Weizhe Yuan, Richard Yuanzhe Pang, Kyunghyun Cho, Sainbayar Sukhbaatar, Jing Xu, and Jason Weston.
    </span>
    <span class="ltx_bibblock">
     Self-rewarding language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">
      arXiv preprint arXiv:2401.10020
     </em>
     , 2024b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib60">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yue et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Xiang Yue, Xingwei Qu, Ge Zhang, Yao Fu, Wenhao Huang, Huan Sun, Yu Su, and Wenhu Chen.
    </span>
    <span class="ltx_bibblock">
     Mammoth: Building math generalist models through hybrid instruction tuning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">
      arXiv preprint arXiv:2309.05653
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib61">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zelikman et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Eric Zelikman, Yuhuai Wu, Jesse Mu, and Noah Goodman.
    </span>
    <span class="ltx_bibblock">
     Star: Bootstrapping reasoning with reasoning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 35:15476–15488, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib62">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zeng et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Aohan Zeng, Mingdao Liu, Rui Lu, Bowen Wang, Xiao Liu, Yuxiao Dong, and Jie Tang.
    </span>
    <span class="ltx_bibblock">
     Agenttuning: Enabling generalized agent abilities for llms.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">
      arXiv preprint arXiv:2310.12823
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib63">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhang et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Tianjun Zhang, Xuezhi Wang, Denny Zhou, Dale Schuurmans, and Joseph E Gonzalez.
    </span>
    <span class="ltx_bibblock">
     Tempera: Test-time prompting via reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">
      arXiv preprint arXiv:2211.11890
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib64">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhang et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Tianjun Zhang, Aman Madaan, Luyu Gao, Steven Zheng, Swaroop Mishra, Yiming Yang, Niket Tandon, and Uri Alon.
    </span>
    <span class="ltx_bibblock">
     In-context principle learning from mistakes.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">
      arXiv preprint arXiv:2402.05403
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib65">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhou et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Andy Zhou, Kai Yan, Michal Shlapentokh-Rothman, Haohan Wang, and Yu-Xiong Wang.
    </span>
    <span class="ltx_bibblock">
     Language agent tree search unifies reasoning acting and planning in language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">
      arXiv preprint arXiv:2310.04406
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib66">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhou et al. [2024]
    </span>
    <span class="ltx_bibblock">
     Yifei Zhou, Andrea Zanette, Jiayi Pan, Sergey Levine, and Aviral Kumar.
    </span>
    <span class="ltx_bibblock">
     Archer: Training language model agents via hierarchical multi-turn rl.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">
      arXiv preprint arXiv:2402.19446
     </em>
     , 2024.
    </span>
   </li>
  </ul>
 </section>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <section class="ltx_part" id="Ptx1" lang="en">
  <h2 class="ltx_title ltx_title_part">
   Appendices
  </h2>
  <section class="ltx_appendix" id="A1">
   <h3 class="ltx_title ltx_title_appendix">
    <span class="ltx_tag ltx_tag_appendix">
     Appendix A
    </span>
    Additional Ablations on Data Composition and Weak-to-Strong Generalization
   </h3>
   <section class="ltx_subsection" id="A1.SS1">
    <h4 class="ltx_title ltx_title_subsection">
     <span class="ltx_tag ltx_tag_subsection">
      A.1
     </span>
     Inclusion of Correct-to-Correct Data
    </h4>
    <div class="ltx_para ltx_noindent" id="A1.SS1.p1">
     <p class="ltx_p" id="A1.SS1.p1.1">
      Intuitively, self-improvement over turns is largely only possible when the model can learn to verify the correctness of its previous response and decide to appropriately modify its response toward correctness. Thus far, the RISE has only trained on data that showed how to convert incorrect responses to correct responses but never illustrated how the model could act on correct responses. To understand if performance can be boosted by also illustrating examples of how the model could act on correct responses, we ran a number of ablations. We took the RISE data generated during Iteration 1 of training on GSM8K with Llama2-7B and modified the multi-turn rollouts to create several cases. First, we duplicated the correct response appearing at the end of every successful multi-turn rollout and trained for one extra turn. This should teach the model that correct responses should not be modified, unlike incorrect responses appearing in previous turns in the rollout. Second, we also ran a variant in which the correct response appearing at the end of every successful rollout is followed by a
      <em class="ltx_emph ltx_font_italic" id="A1.SS1.p1.1.1">
       different
      </em>
      correct response. This variant should teach the model that if it chooses to modify a correct response, it must still produce another correct response.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="A1.SS1.p2">
     <p class="ltx_p" id="A1.SS1.p2.1">
      As shown in Table
      <a class="ltx_ref" href="#A1.T4" title="Table 4 ‣ A.1 Inclusion of Correct-to-Correct Data ‣ Appendix A Additional Ablations on Data Composition and Weak-to-Strong Generalization ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        4
       </span>
      </a>
      , all methods improved performance over the base model, though only appending with a successful rollout with a novel correct response leads to best performance. The default design of RISE in the main paper attains a close second position, and repeating a correct response at the end of a successful rollout largely reduces performance. We suspect that the poor performance of repeating the same correct response is largely a result of inducing spurious correlations due to data duplication.
     </p>
    </div>
    <figure class="ltx_table" id="A1.T4">
     <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T4.2">
      <thead class="ltx_thead">
       <tr class="ltx_tr" id="A1.T4.2.3.1">
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A1.T4.2.3.1.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="A1.T4.2.3.1.1.1" style="font-size:80%;">
          RISE (Llama2)
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="3" id="A1.T4.2.3.1.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="A1.T4.2.3.1.2.1" style="font-size:80%;">
          w/o oracle
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.2.3.1.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="A1.T4.2.3.1.3.1" style="font-size:80%;">
          w/ oracle
         </span>
        </th>
       </tr>
       <tr class="ltx_tr" id="A1.T4.2.2">
        <th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r" id="A1.T4.2.2.3" style="padding:-0.05pt 3.4pt;">
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T4.2.2.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.2.4.1" style="font-size:80%;">
          m1@t1
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T4.1.1.1" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.T4.1.1.1.m1.1">
          <semantics id="A1.T4.1.1.1.m1.1a">
           <mo id="A1.T4.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="A1.T4.1.1.1.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="A1.T4.1.1.1.m1.1b">
            <ci id="A1.T4.1.1.1.m1.1.1.cmml" xref="A1.T4.1.1.1.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="A1.T4.1.1.1.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="A1.T4.1.1.1.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.1.1.1.2" style="font-size:80%;color:#084081;">
          m5@t1
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T4.2.2.2" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.T4.2.2.2.m1.1">
          <semantics id="A1.T4.2.2.2.m1.1a">
           <mo id="A1.T4.2.2.2.m1.1.1" mathsize="80%" stretchy="false" xref="A1.T4.2.2.2.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="A1.T4.2.2.2.m1.1b">
            <ci id="A1.T4.2.2.2.m1.1.1.cmml" xref="A1.T4.2.2.2.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="A1.T4.2.2.2.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="A1.T4.2.2.2.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.2.2.2" style="font-size:80%;color:#662506;">
          m1@t5
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T4.2.2.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.2.5.1" style="font-size:80%;color:#3F007D;">
          p1@t5
         </span>
        </th>
       </tr>
      </thead>
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="A1.T4.2.4.1">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T4.2.4.1.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.4.1.1.1" style="font-size:80%;">
          Boost
         </span>
        </th>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.2.4.1.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.4.1.2.1" style="font-size:80%;">
          32.9
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.2.4.1.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.4.1.3.1" style="font-size:80%;color:#2B8CBE;">
          45.3
         </span>
         <span class="ltx_text" id="A1.T4.2.4.1.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.4.1.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T4.2.4.1.3.3.1" style="color:#084081;">
           +12.4
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T4.2.4.1.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.4.1.4.1" style="font-size:80%;color:#D95F0E;">
          26.5
         </span>
         <span class="ltx_text" id="A1.T4.2.4.1.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.4.1.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T4.2.4.1.4.3.1" style="color:#662506;">
           -6.4
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.2.4.1.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.4.1.5.1" style="font-size:80%;color:#6A51A3;">
          40.9
         </span>
         <span class="ltx_text" id="A1.T4.2.4.1.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.4.1.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T4.2.4.1.5.3.1" style="color:#3F007D;">
           +8.0
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="A1.T4.2.5.2">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T4.2.5.2.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.5.2.1.1" style="font-size:80%;">
          +RISE (default)
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="A1.T4.2.5.2.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.5.2.2.1" style="font-size:80%;">
          35.6
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A1.T4.2.5.2.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.5.2.3.1" style="font-size:80%;color:#2B8CBE;">
          49.7
         </span>
         <span class="ltx_text" id="A1.T4.2.5.2.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.5.2.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T4.2.5.2.3.3.1" style="color:#084081;">
           +14.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.2.5.2.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.5.2.4.1" style="font-size:80%;color:#D95F0E;">
          50.7
         </span>
         <span class="ltx_text" id="A1.T4.2.5.2.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.5.2.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T4.2.5.2.4.3.1" style="color:#662506;">
           +15.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A1.T4.2.5.2.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.5.2.5.1" style="font-size:80%;color:#6A51A3;">
          63.9
         </span>
         <span class="ltx_text" id="A1.T4.2.5.2.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.5.2.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T4.2.5.2.5.3.1" style="color:#3F007D;">
           +28.3
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="A1.T4.2.6.3">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T4.2.6.3.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.6.3.1.1" style="font-size:80%;">
          +Repeating a correct response
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="A1.T4.2.6.3.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.6.3.2.1" style="font-size:80%;">
          34.2
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A1.T4.2.6.3.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.6.3.3.1" style="font-size:80%;color:#2B8CBE;">
          48.9
         </span>
         <span class="ltx_text" id="A1.T4.2.6.3.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.6.3.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T4.2.6.3.3.3.1" style="color:#084081;">
           +14.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.2.6.3.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.6.3.4.1" style="font-size:80%;color:#D95F0E;">
          46.2
         </span>
         <span class="ltx_text" id="A1.T4.2.6.3.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.6.3.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T4.2.6.3.4.3.1" style="color:#662506;">
           +12.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A1.T4.2.6.3.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.6.3.5.1" style="font-size:80%;color:#6A51A3;">
          57.7
         </span>
         <span class="ltx_text" id="A1.T4.2.6.3.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.6.3.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T4.2.6.3.5.3.1" style="color:#3F007D;">
           +23.5
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="A1.T4.2.7.4">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A1.T4.2.7.4.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.7.4.1.1" style="font-size:80%;">
          +Appending a different correct response
         </span>
        </th>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.2.7.4.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.7.4.2.1" style="font-size:80%;">
          33.1
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.2.7.4.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.7.4.3.1" style="font-size:80%;color:#2B8CBE;">
          49.3
         </span>
         <span class="ltx_text" id="A1.T4.2.7.4.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.7.4.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T4.2.7.4.3.3.1" style="color:#084081;">
           +16.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A1.T4.2.7.4.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.7.4.4.1" style="font-size:80%;color:#D95F0E;">
          51.1
         </span>
         <span class="ltx_text" id="A1.T4.2.7.4.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.7.4.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T4.2.7.4.4.3.1" style="color:#662506;">
           +18.0
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.2.7.4.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T4.2.7.4.5.1" style="font-size:80%;color:#6A51A3;">
          64.9
         </span>
         <span class="ltx_text" id="A1.T4.2.7.4.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T4.2.7.4.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T4.2.7.4.5.3.1" style="color:#3F007D;">
           +31.8
          </span>
          )
         </span>
        </td>
       </tr>
      </tbody>
     </table>
     <figcaption class="ltx_caption ltx_centering" style="font-size:80%;">
      <span class="ltx_tag ltx_tag_table">
       <span class="ltx_text" id="A1.T4.7.1.1" style="font-size:113%;">
        Table 4
       </span>
       :
      </span>
      <em class="ltx_emph ltx_font_bold ltx_font_italic" id="A1.T4.8.2">
       Comparison of model performance on GSM8K with different mechanisms of adding correct-to-correct data in RISE.
      </em>
      Values in parentheses indicate improvement over m1@t1, note that appending a successful rollout with a a novel correct response leads to the highest performance gains.
     </figcaption>
    </figure>
    <div class="ltx_para ltx_noindent" id="A1.SS1.p3">
     <p class="ltx_p" id="A1.SS1.p3.2">
      To further investigate self-improvement capabilities, we analyzed the percentage of correct responses changing to incorrect responses in consecutive turns (T
      <math alttext="i" class="ltx_Math" display="inline" id="A1.SS1.p3.1.m1.1">
       <semantics id="A1.SS1.p3.1.m1.1a">
        <mi id="A1.SS1.p3.1.m1.1.1" xref="A1.SS1.p3.1.m1.1.1.cmml">
         i
        </mi>
        <annotation-xml encoding="MathML-Content" id="A1.SS1.p3.1.m1.1b">
         <ci id="A1.SS1.p3.1.m1.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1">
          𝑖
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A1.SS1.p3.1.m1.1c">
         i
        </annotation>
       </semantics>
      </math>
      to T
      <math alttext="{i+1}" class="ltx_Math" display="inline" id="A1.SS1.p3.2.m2.1">
       <semantics id="A1.SS1.p3.2.m2.1a">
        <mrow id="A1.SS1.p3.2.m2.1.1" xref="A1.SS1.p3.2.m2.1.1.cmml">
         <mi id="A1.SS1.p3.2.m2.1.1.2" xref="A1.SS1.p3.2.m2.1.1.2.cmml">
          i
         </mi>
         <mo id="A1.SS1.p3.2.m2.1.1.1" xref="A1.SS1.p3.2.m2.1.1.1.cmml">
          +
         </mo>
         <mn id="A1.SS1.p3.2.m2.1.1.3" xref="A1.SS1.p3.2.m2.1.1.3.cmml">
          1
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="A1.SS1.p3.2.m2.1b">
         <apply id="A1.SS1.p3.2.m2.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1">
          <plus id="A1.SS1.p3.2.m2.1.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1.1">
          </plus>
          <ci id="A1.SS1.p3.2.m2.1.1.2.cmml" xref="A1.SS1.p3.2.m2.1.1.2">
           𝑖
          </ci>
          <cn id="A1.SS1.p3.2.m2.1.1.3.cmml" type="integer" xref="A1.SS1.p3.2.m2.1.1.3">
           1
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A1.SS1.p3.2.m2.1c">
         {i+1}
        </annotation>
       </semantics>
      </math>
      ), as illustrated in Figure
      <a class="ltx_ref" href="#A1.F10" title="Figure 10 ‣ A.1 Inclusion of Correct-to-Correct Data ‣ Appendix A Additional Ablations on Data Composition and Weak-to-Strong Generalization ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        10
       </span>
      </a>
      . Generally, a decreasing trend suggests better self-improvement, while lower absolute values indicate better resistance to noisy feedback. The results reveal unexpected patterns across configurations.
The Boost configuration shows the poorest performance, with the highest overall percentages and an increase from turn 4 to 5, suggesting that it struggles to consistently maintain correct responses. Repeating a correct response shows the lowest initial percentage (6.3%) but increases from turn 3 onward, indicating potential issues in extended interactions. Both Default RISE and appending a different correct response demonstrate a favorable trend, steadily decreasing from 12.3% to 3.9% and from 9.8% to 3.3%, respectively, suggesting a good balance between maintaining correct responses and allowing improvements. These findings provide nuanced insights into the stability and self-improvement capabilities of RISE and align with our earlier observation of its superior performance in overall accuracy.
     </p>
    </div>
    <figure class="ltx_figure" id="A1.F10">
     <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="180" id="A1.F10.g1" src="/html/2407.18219/assets/correct_to_correct.png" width="240"/>
     <figcaption class="ltx_caption ltx_centering">
      <span class="ltx_tag ltx_tag_figure">
       <span class="ltx_text" id="A1.F10.10.5.1" style="font-size:90%;">
        Figure 10
       </span>
       :
      </span>
      <em class="ltx_emph ltx_font_bold ltx_font_italic" id="A1.F10.6.2" style="font-size:80%;">
       Percentage of correct responses in turn T
       <sub class="ltx_sub" id="A1.F10.6.2.3">
        <span class="ltx_text ltx_font_medium" id="A1.F10.6.2.3.1">
         i
        </span>
       </sub>
       that change to being incorrect in turn T
       <sub class="ltx_sub" id="A1.F10.6.2.4">
        <span class="ltx_text ltx_font_medium" id="A1.F10.6.2.4.1">
         i+1
        </span>
       </sub>
       .
      </em>
      <span class="ltx_text" id="A1.F10.8.4" style="font-size:80%;">
       This figure illustrates the percentage of correct responses that change to incorrect responses across consecutive turns (T
       <sub class="ltx_sub" id="A1.F10.8.4.1">
        <span class="ltx_text ltx_font_italic" id="A1.F10.8.4.1.1">
         i
        </span>
       </sub>
       to T
       <sub class="ltx_sub" id="A1.F10.8.4.2">
        <span class="ltx_text ltx_font_italic" id="A1.F10.8.4.2.1">
         i+1
        </span>
       </sub>
       ) for different model configurations. A continuously decreasing trend suggests better self-improvement performance.
      </span>
     </figcaption>
    </figure>
   </section>
   <section class="ltx_subsection" id="A1.SS2">
    <h4 class="ltx_title ltx_title_subsection">
     <span class="ltx_tag ltx_tag_subsection">
      A.2
     </span>
     Weak-to-Strong Generalization: RISE on Weak Model Data Improves Strong Models
    </h4>
    <div class="ltx_para ltx_noindent" id="A1.SS2.p1">
     <p class="ltx_p" id="A1.SS2.p1.1">
      In this section, we compare the performance of Llama2 and Mistral-7B with RISE in the weak-to-strong setting
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib3" title="">
        3
       </a>
       ]
      </cite>
      . Concretely, we are interested in using data generated via RISE with a weak model (Llama2-7B) to train a strong model (Mistral-7B). Our analysis reveals intriguing insights into the transferability of RISE-generated data across models of different capabilities.
     </p>
    </div>
    <figure class="ltx_table" id="A1.T5">
     <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T5.2">
      <thead class="ltx_thead">
       <tr class="ltx_tr" id="A1.T5.2.3.1">
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A1.T5.2.3.1.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="A1.T5.2.3.1.1.1" style="font-size:80%;">
          RISE
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="3" id="A1.T5.2.3.1.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="A1.T5.2.3.1.2.1" style="font-size:80%;">
          w/o oracle
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T5.2.3.1.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text ltx_font_bold" id="A1.T5.2.3.1.3.1" style="font-size:80%;">
          w/ oracle
         </span>
        </th>
       </tr>
       <tr class="ltx_tr" id="A1.T5.2.2">
        <th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r" id="A1.T5.2.2.3" style="padding:-0.05pt 3.4pt;">
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T5.2.2.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.2.4.1" style="font-size:80%;">
          m1@t1
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T5.1.1.1" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.T5.1.1.1.m1.1">
          <semantics id="A1.T5.1.1.1.m1.1a">
           <mo id="A1.T5.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="A1.T5.1.1.1.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="A1.T5.1.1.1.m1.1b">
            <ci id="A1.T5.1.1.1.m1.1.1.cmml" xref="A1.T5.1.1.1.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="A1.T5.1.1.1.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="A1.T5.1.1.1.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.1.1.1.2" style="font-size:80%;color:#084081;">
          m5@t1
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T5.2.2.2" style="padding:-0.05pt 3.4pt;">
         <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.T5.2.2.2.m1.1">
          <semantics id="A1.T5.2.2.2.m1.1a">
           <mo id="A1.T5.2.2.2.m1.1.1" mathsize="80%" stretchy="false" xref="A1.T5.2.2.2.m1.1.1.cmml">
            →
           </mo>
           <annotation-xml encoding="MathML-Content" id="A1.T5.2.2.2.m1.1b">
            <ci id="A1.T5.2.2.2.m1.1.1.cmml" xref="A1.T5.2.2.2.m1.1.1">
             →
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="A1.T5.2.2.2.m1.1c">
            \rightarrow
           </annotation>
          </semantics>
         </math>
         <span class="ltx_text" id="A1.T5.2.2.2.1" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.2.2.2" style="font-size:80%;color:#662506;">
          m1@t5
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T5.2.2.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.2.5.1" style="font-size:80%;color:#3F007D;">
          p1@t5
         </span>
        </th>
       </tr>
      </thead>
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="A1.T5.2.4.1">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T5.2.4.1.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.4.1.1.1" style="font-size:80%;">
          Llama2-7B
         </span>
        </th>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T5.2.4.1.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.4.1.2.1" style="font-size:80%;">
          10.5
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T5.2.4.1.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.4.1.3.1" style="font-size:80%;color:#2B8CBE;">
          22.8
         </span>
         <span class="ltx_text" id="A1.T5.2.4.1.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.4.1.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.4.1.3.3.1" style="color:#084081;">
           +12.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T5.2.4.1.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.4.1.4.1" style="font-size:80%;color:#D95F0E;">
          11.1
         </span>
         <span class="ltx_text" id="A1.T5.2.4.1.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.4.1.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.4.1.4.3.1" style="color:#662506;">
           +0.6
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T5.2.4.1.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.4.1.5.1" style="font-size:80%;color:#6A51A3;">
          13.9
         </span>
         <span class="ltx_text" id="A1.T5.2.4.1.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.4.1.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.4.1.5.3.1" style="color:#3F007D;">
           +3.4
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="A1.T5.2.5.2">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T5.2.5.2.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.5.2.1.1" style="font-size:80%;">
          + Iteration 1
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="A1.T5.2.5.2.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.5.2.2.1" style="font-size:80%;">
          35.6
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A1.T5.2.5.2.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.5.2.3.1" style="font-size:80%;color:#2B8CBE;">
          49.7
         </span>
         <span class="ltx_text" id="A1.T5.2.5.2.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.5.2.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.5.2.3.3.1" style="color:#084081;">
           +14.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.2.5.2.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.5.2.4.1" style="font-size:80%;color:#D95F0E;">
          50.7
         </span>
         <span class="ltx_text" id="A1.T5.2.5.2.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.5.2.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.5.2.4.3.1" style="color:#662506;">
           +15.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A1.T5.2.5.2.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.5.2.5.1" style="font-size:80%;color:#6A51A3;">
          63.9
         </span>
         <span class="ltx_text" id="A1.T5.2.5.2.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.5.2.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.5.2.5.3.1" style="color:#3F007D;">
           +28.3
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="A1.T5.2.6.3">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T5.2.6.3.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.6.3.1.1" style="font-size:80%;">
          + Iteration 1 (Mistral-7B)
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="A1.T5.2.6.3.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.6.3.2.1" style="font-size:80%;">
          27.1
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A1.T5.2.6.3.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.6.3.3.1" style="font-size:80%;color:#2B8CBE;">
          40.1
         </span>
         <span class="ltx_text" id="A1.T5.2.6.3.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.6.3.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.6.3.3.3.1" style="color:#084081;">
           +13.0
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.2.6.3.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.6.3.4.1" style="font-size:80%;color:#D95F0E;">
          45.2
         </span>
         <span class="ltx_text" id="A1.T5.2.6.3.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.6.3.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.6.3.4.3.1" style="color:#662506;">
           +18.1
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A1.T5.2.6.3.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.6.3.5.1" style="font-size:80%;color:#6A51A3;">
          59.1
         </span>
         <span class="ltx_text" id="A1.T5.2.6.3.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.6.3.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.6.3.5.3.1" style="color:#3F007D;">
           +32.0
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="A1.T5.2.7.4">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T5.2.7.4.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.7.4.1.1" style="font-size:80%;">
          Mistral-7B
         </span>
        </th>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T5.2.7.4.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.7.4.2.1" style="font-size:80%;">
          33.7
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T5.2.7.4.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.7.4.3.1" style="font-size:80%;color:#2B8CBE;">
          49.4
         </span>
         <span class="ltx_text" id="A1.T5.2.7.4.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.7.4.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.7.4.3.3.1" style="color:#084081;">
           +15.7
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T5.2.7.4.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.7.4.4.1" style="font-size:80%;color:#D95F0E;">
          39.0
         </span>
         <span class="ltx_text" id="A1.T5.2.7.4.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.7.4.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.7.4.4.3.1" style="color:#662506;">
           +5.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T5.2.7.4.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.7.4.5.1" style="font-size:80%;color:#6A51A3;">
          46.9
         </span>
         <span class="ltx_text" id="A1.T5.2.7.4.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.7.4.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.7.4.5.3.1" style="color:#3F007D;">
           +13.2
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="A1.T5.2.8.5">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T5.2.8.5.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.8.5.1.1" style="font-size:80%;">
          + Iteration 1
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="A1.T5.2.8.5.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.8.5.2.1" style="font-size:80%;">
          35.3
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A1.T5.2.8.5.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.8.5.3.1" style="font-size:80%;color:#2B8CBE;">
          50.6
         </span>
         <span class="ltx_text" id="A1.T5.2.8.5.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.8.5.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.8.5.3.3.1" style="color:#084081;">
           +15.3
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.2.8.5.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.8.5.4.1" style="font-size:80%;color:#D95F0E;">
          59.2
         </span>
         <span class="ltx_text" id="A1.T5.2.8.5.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.8.5.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.8.5.4.3.1" style="color:#662506;">
           +23.9
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A1.T5.2.8.5.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.8.5.5.1" style="font-size:80%;color:#6A51A3;">
          68.6
         </span>
         <span class="ltx_text" id="A1.T5.2.8.5.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.8.5.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.8.5.5.3.1" style="color:#3F007D;">
           +33.3
          </span>
          )
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="A1.T5.2.9.6">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A1.T5.2.9.6.1" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.9.6.1.1" style="font-size:80%;">
          + Iteration 1 (Llama2-7B)
         </span>
        </th>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T5.2.9.6.2" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.9.6.2.1" style="font-size:80%;">
          38.2
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T5.2.9.6.3" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.9.6.3.1" style="font-size:80%;color:#2B8CBE;">
          55.4
         </span>
         <span class="ltx_text" id="A1.T5.2.9.6.3.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.9.6.3.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.9.6.3.3.1" style="color:#084081;">
           +17.2
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A1.T5.2.9.6.4" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.9.6.4.1" style="font-size:80%;color:#D95F0E;">
          62.7
         </span>
         <span class="ltx_text" id="A1.T5.2.9.6.4.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.9.6.4.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.9.6.4.3.1" style="color:#662506;">
           +24.5
          </span>
          )
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T5.2.9.6.5" style="padding:-0.05pt 3.4pt;">
         <span class="ltx_text" id="A1.T5.2.9.6.5.1" style="font-size:80%;color:#6A51A3;">
          73.5
         </span>
         <span class="ltx_text" id="A1.T5.2.9.6.5.2" style="font-size:80%;">
         </span>
         <span class="ltx_text" id="A1.T5.2.9.6.5.3" style="font-size:70%;">
          (
          <span class="ltx_text" id="A1.T5.2.9.6.5.3.1" style="color:#3F007D;">
           +35.3
          </span>
          )
         </span>
        </td>
       </tr>
      </tbody>
     </table>
     <figcaption class="ltx_caption ltx_centering" style="font-size:80%;">
      <span class="ltx_tag ltx_tag_table">
       <span class="ltx_text" id="A1.T5.7.1.1" style="font-size:113%;">
        Table 5
       </span>
       :
      </span>
      <em class="ltx_emph ltx_font_bold ltx_font_italic" id="A1.T5.8.2">
       Weak-to-strong generalization on GSM8K.
      </em>
      Comparing performance of RISE when training on rollouts generated by Llama2-7B vs Mistral-7B. Note that training the Mistral-7B model on rollouts generated by the weaker Llama2-7B with RISE improves performance compared to using data generated by the Mistral-7B model itself. However, the reverse is not true: training the Llama2 model on Mistral’s mistakes leads to worse performance, likely because errors from the Mistral-7B model are harder to comprehend for a worse base model. All values are in % accuracy, and values in parentheses indicate improvement over m1@t1.
     </figcaption>
    </figure>
    <div class="ltx_para ltx_noindent" id="A1.SS2.p2">
     <p class="ltx_p" id="A1.SS2.p2.1">
      As shown in Table
      <a class="ltx_ref" href="#A1.T5" title="Table 5 ‣ A.2 Weak-to-Strong Generalization: RISE on Weak Model Data Improves Strong Models ‣ Appendix A Additional Ablations on Data Composition and Weak-to-Strong Generalization ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        5
       </span>
      </a>
      , we find that Mistral-7B + Iteration 1 data generated from Llama2 outperforms training the Llama2-7B model itself on these data (i.e., Llama2-7B + Iteration1) on all the metrics reported with particularly significant improvements in multi-turn reasoning (m1@t5). In fact, training on multi-turn rollouts from Llama2-7B also outperforms training on on-policy Mistral-7B rollouts as well. Interestingly, we observed that training Llama2-7B on multi-turn rollouts from Mistral-7B performs worse than training on on-policy Llama2-7B rollouts, suggesting that Llama2-7B, despite its lower absolute performance, demonstrates more informative mistakes that can be leveraged to better boost the self-improvement capability. This phenomenon underscores the importance of the quality and nature of errors in the training data, rather than just the overall performance of the model that generates them. These findings collectively suggest that the data generated from a weaker Llama2 model can still be used to induce a self-improvement capability in a stronger model, although the reverse is not true (as is also evident from the fact that using GPT-3.5 rollouts in the boosting phase for training does not improve performance for any model in Table
      <a class="ltx_ref" href="#S6.T1" title="Table 1 ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        1
       </span>
      </a>
      ). We suspect that this is becaue the reverse poses a much harder learning problem since a weak model need to internalize the mistakes of a stronger model, resulting in hallucinations and memorization
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib24" title="">
        24
       </a>
       ]
      </cite>
      . Note that training on these data does not degrade single-turn performance either. This hints at an added benefit of training with RISE: weak-to-strong generalization, which can be quite useful in practice when rolling out stronger models is expensive.
     </p>
    </div>
   </section>
  </section>
  <section class="ltx_appendix" id="A2">
   <h3 class="ltx_title ltx_title_appendix">
    <span class="ltx_tag ltx_tag_appendix">
     Appendix B
    </span>
    Additional Results
   </h3>
   <section class="ltx_subsection" id="A2.SS1">
    <h4 class="ltx_title ltx_title_subsection">
     <span class="ltx_tag ltx_tag_subsection">
      B.1
     </span>
     Complete Comparisons and Discussion: Extended Version of Table
     <a class="ltx_ref" href="#S6.T1" title="Table 1 ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
    </h4>
    <div class="ltx_para ltx_noindent" id="A2.SS1.p1">
     <p class="ltx_p" id="A2.SS1.p1.1">
      We provide an extended version of Table
      <a class="ltx_ref" href="#S6.T1" title="Table 1 ‣ 6 Experimental Evaluation ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        1
       </span>
      </a>
      , with a clear explanation of how we implement baselines and a discussion of comparisons.
     </p>
    </div>
    <figure class="ltx_table" id="A2.T6">
     <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A2.T6.11" style="width:422.8pt;height:570.4pt;vertical-align:-0.0pt;">
      <span class="ltx_transformed_inner" style="transform:translate(-15.4pt,20.8pt) scale(0.93200070866828,0.93200070866828) ;">
       <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A2.T6.11.11">
        <tbody class="ltx_tbody">
         <tr class="ltx_tr" id="A2.T6.11.11.12.1">
          <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A2.T6.11.11.12.1.1" rowspan="2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.11.11.12.1.1.1" style="font-size:80%;">
            Approach
           </span>
          </th>
          <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="4" id="A2.T6.11.11.12.1.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.11.11.12.1.2.1" style="font-size:80%;">
            GSM8K
           </span>
           <span class="ltx_text" id="A2.T6.11.11.12.1.2.2" style="font-size:80%;">
           </span>
           <cite class="ltx_cite ltx_citemacro_citep">
            <span class="ltx_text" id="A2.T6.11.11.12.1.2.3.1" style="font-size:80%;">
             [
            </span>
            <a class="ltx_ref" href="#bib.bib10" title="">
             10
            </a>
            <span class="ltx_text" id="A2.T6.11.11.12.1.2.4.2" style="font-size:80%;">
             ]
            </span>
           </cite>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="A2.T6.11.11.12.1.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.11.11.12.1.3.1" style="font-size:80%;">
            MATH
           </span>
           <span class="ltx_text" id="A2.T6.11.11.12.1.3.2" style="font-size:80%;">
           </span>
           <cite class="ltx_cite ltx_citemacro_citep">
            <span class="ltx_text" id="A2.T6.11.11.12.1.3.3.1" style="font-size:80%;">
             [
            </span>
            <a class="ltx_ref" href="#bib.bib18" title="">
             18
            </a>
            <span class="ltx_text" id="A2.T6.11.11.12.1.3.4.2" style="font-size:80%;">
             ]
            </span>
           </cite>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.13.2">
          <td class="ltx_td" id="A2.T6.11.11.13.2.1" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center" colspan="2" id="A2.T6.11.11.13.2.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.11.11.13.2.2.1" style="font-size:80%;">
            w/o oracle
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.13.2.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.11.11.13.2.3.1" style="font-size:80%;">
            w/ oracle
           </span>
          </td>
          <td class="ltx_td" id="A2.T6.11.11.13.2.4" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center" colspan="2" id="A2.T6.11.11.13.2.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.11.11.13.2.5.1" style="font-size:80%;">
            w/o oracle
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.13.2.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.11.11.13.2.6.1" style="font-size:80%;">
            w/ oracle
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.4.4.4">
          <th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A2.T6.4.4.4.5" style="padding:-0.05pt 3.4pt;">
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.4.4.4.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.4.4.4.6.1" style="font-size:80%;">
            m1@t1
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T6.1.1.1.1" style="padding:-0.05pt 3.4pt;">
           <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.T6.1.1.1.1.m1.1">
            <semantics id="A2.T6.1.1.1.1.m1.1a">
             <mo id="A2.T6.1.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="A2.T6.1.1.1.1.m1.1.1.cmml">
              →
             </mo>
             <annotation-xml encoding="MathML-Content" id="A2.T6.1.1.1.1.m1.1b">
              <ci id="A2.T6.1.1.1.1.m1.1.1.cmml" xref="A2.T6.1.1.1.1.m1.1.1">
               →
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="A2.T6.1.1.1.1.m1.1c">
              \rightarrow
             </annotation>
            </semantics>
           </math>
           <span class="ltx_text" id="A2.T6.1.1.1.1.1" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.1.1.1.1.2" style="font-size:80%;color:#084081;">
            m5@t1
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T6.2.2.2.2" style="padding:-0.05pt 3.4pt;">
           <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.T6.2.2.2.2.m1.1">
            <semantics id="A2.T6.2.2.2.2.m1.1a">
             <mo id="A2.T6.2.2.2.2.m1.1.1" mathsize="80%" stretchy="false" xref="A2.T6.2.2.2.2.m1.1.1.cmml">
              →
             </mo>
             <annotation-xml encoding="MathML-Content" id="A2.T6.2.2.2.2.m1.1b">
              <ci id="A2.T6.2.2.2.2.m1.1.1.cmml" xref="A2.T6.2.2.2.2.m1.1.1">
               →
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="A2.T6.2.2.2.2.m1.1c">
              \rightarrow
             </annotation>
            </semantics>
           </math>
           <span class="ltx_text" id="A2.T6.2.2.2.2.1" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.2.2.2.2.2" style="font-size:80%;color:#662506;">
            m1@t5
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.4.4.4.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.4.4.4.7.1" style="font-size:80%;color:#3F007D;">
            p1@t5
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.4.4.4.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.4.4.4.8.1" style="font-size:80%;">
            m1@t1
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T6.3.3.3.3" style="padding:-0.05pt 3.4pt;">
           <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.T6.3.3.3.3.m1.1">
            <semantics id="A2.T6.3.3.3.3.m1.1a">
             <mo id="A2.T6.3.3.3.3.m1.1.1" mathsize="80%" stretchy="false" xref="A2.T6.3.3.3.3.m1.1.1.cmml">
              →
             </mo>
             <annotation-xml encoding="MathML-Content" id="A2.T6.3.3.3.3.m1.1b">
              <ci id="A2.T6.3.3.3.3.m1.1.1.cmml" xref="A2.T6.3.3.3.3.m1.1.1">
               →
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="A2.T6.3.3.3.3.m1.1c">
              \rightarrow
             </annotation>
            </semantics>
           </math>
           <span class="ltx_text" id="A2.T6.3.3.3.3.1" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.3.3.3.3.2" style="font-size:80%;color:#084081;">
            m5@t1
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T6.4.4.4.4" style="padding:-0.05pt 3.4pt;">
           <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.T6.4.4.4.4.m1.1">
            <semantics id="A2.T6.4.4.4.4.m1.1a">
             <mo id="A2.T6.4.4.4.4.m1.1.1" mathsize="80%" stretchy="false" xref="A2.T6.4.4.4.4.m1.1.1.cmml">
              →
             </mo>
             <annotation-xml encoding="MathML-Content" id="A2.T6.4.4.4.4.m1.1b">
              <ci id="A2.T6.4.4.4.4.m1.1.1.cmml" xref="A2.T6.4.4.4.4.m1.1.1">
               →
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="A2.T6.4.4.4.4.m1.1c">
              \rightarrow
             </annotation>
            </semantics>
           </math>
           <span class="ltx_text" id="A2.T6.4.4.4.4.1" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.4.4.4.4.2" style="font-size:80%;color:#662506;">
            m1@t5
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.4.4.4.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.4.4.4.9.1" style="font-size:80%;color:#3F007D;">
            p1@t5
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.14.3">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T6.11.11.14.3.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.11.11.14.3.1.1" style="font-size:80%;">
            RISE (Ours)
           </span>
          </th>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.14.3.2" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.14.3.3" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.14.3.4" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.14.3.5" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.14.3.6" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.14.3.7" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.14.3.8" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.14.3.9" style="padding:-0.05pt 3.4pt;">
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.15.4">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.15.4.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.15.4.1.1" style="font-size:80%;">
            Llama2 Base
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.15.4.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.15.4.2.1" style="font-size:80%;">
            10.5
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.15.4.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.15.4.3.1" style="font-size:80%;color:#2B8CBE;">
            22.8
           </span>
           <span class="ltx_text" id="A2.T6.11.11.15.4.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.15.4.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.15.4.3.3.1" style="color:#084081;">
             +12.3
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.15.4.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.15.4.4.1" style="font-size:80%;color:#D95F0E;">
            11.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.15.4.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.15.4.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.15.4.4.3.1" style="color:#662506;">
             +0.6
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.15.4.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.15.4.5.1" style="font-size:80%;color:#6A51A3;">
            13.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.15.4.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.15.4.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.15.4.5.3.1" style="color:#3F007D;">
             +3.4
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.15.4.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.15.4.6.1" style="font-size:80%;">
            1.9
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.15.4.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.15.4.7.1" style="font-size:80%;color:#2B8CBE;">
            5.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.15.4.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.15.4.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.15.4.7.3.1" style="color:#084081;">
             +3.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.15.4.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.15.4.8.1" style="font-size:80%;color:#D95F0E;">
            1.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.15.4.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.15.4.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.15.4.8.3.1" style="color:#662506;">
             -0.5
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.15.4.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.15.4.9.1" style="font-size:80%;color:#6A51A3;">
            2.3
           </span>
           <span class="ltx_text" id="A2.T6.11.11.15.4.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.15.4.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.15.4.9.3.1" style="color:#3F007D;">
             +0.4
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.16.5">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.16.5.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.16.5.1.1" style="font-size:80%;">
            +Boost
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.16.5.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.16.5.2.1" style="font-size:80%;">
            32.9
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.16.5.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.16.5.3.1" style="font-size:80%;color:#2B8CBE;">
            45.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.16.5.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.16.5.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.16.5.3.3.1" style="color:#084081;">
             +12.5
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.16.5.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.16.5.4.1" style="font-size:80%;color:#D95F0E;">
            39.2
           </span>
           <span class="ltx_text" id="A2.T6.11.11.16.5.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.16.5.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.16.5.4.3.1" style="color:#662506;">
             +6.3
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.16.5.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.16.5.5.1" style="font-size:80%;color:#6A51A3;">
            55.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.16.5.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.16.5.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.16.5.5.3.1" style="color:#3F007D;">
             +22.6
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.16.5.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.16.5.6.1" style="font-size:80%;">
            5.5
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.16.5.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.16.5.7.1" style="font-size:80%;color:#2B8CBE;">
            6.8
           </span>
           <span class="ltx_text" id="A2.T6.11.11.16.5.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.16.5.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.16.5.7.3.1" style="color:#084081;">
             +1.3
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.16.5.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.16.5.8.1" style="font-size:80%;color:#D95F0E;">
            5.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.16.5.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.16.5.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.16.5.8.3.1" style="color:#662506;">
             +0.0
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.16.5.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.16.5.9.1" style="font-size:80%;color:#6A51A3;">
            14.6
           </span>
           <span class="ltx_text" id="A2.T6.11.11.16.5.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.16.5.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.16.5.9.3.1" style="color:#3F007D;">
             +9.1
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.17.6">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.17.6.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.17.6.1.1" style="font-size:80%;">
            +Iteration 1
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.17.6.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.17.6.2.1" style="font-size:80%;">
            35.6
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.17.6.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.17.6.3.1" style="font-size:80%;color:#2B8CBE;">
            49.7
           </span>
           <span class="ltx_text" id="A2.T6.11.11.17.6.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.17.6.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.17.6.3.3.1" style="color:#084081;">
             +14.1
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.17.6.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.17.6.4.1" style="font-size:80%;color:#D95F0E;">
            50.7
           </span>
           <span class="ltx_text" id="A2.T6.11.11.17.6.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.17.6.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.17.6.4.3.1" style="color:#662506;">
             +15.1
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.17.6.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.17.6.5.1" style="font-size:80%;color:#6A51A3;">
            63.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.17.6.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.17.6.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.17.6.5.3.1" style="color:#3F007D;">
             +28.3
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.17.6.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.17.6.6.1" style="font-size:80%;">
            6.3
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.17.6.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.17.6.7.1" style="font-size:80%;color:#2B8CBE;">
            8.8
           </span>
           <span class="ltx_text" id="A2.T6.11.11.17.6.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.17.6.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.17.6.7.3.1" style="color:#084081;">
             +2.5
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.17.6.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.17.6.8.1" style="font-size:80%;color:#D95F0E;">
            9.7
           </span>
           <span class="ltx_text" id="A2.T6.11.11.17.6.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.17.6.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.17.6.8.3.1" style="color:#662506;">
             +3.4
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.17.6.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.17.6.9.1" style="font-size:80%;color:#6A51A3;">
            19.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.17.6.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.17.6.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.17.6.9.3.1" style="color:#3F007D;">
             +13.1
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.18.7">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.18.7.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.18.7.1.1" style="font-size:80%;">
            +Iteration 2
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.18.7.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.18.7.2.1" style="font-size:80%;">
            37.3
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.18.7.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.18.7.3.1" style="font-size:80%;color:#2B8CBE;">
            51.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.18.7.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.18.7.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.18.7.3.3.1" style="color:#084081;">
             +13.7
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.18.7.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.18.7.4.1" style="font-size:80%;color:#D95F0E;">
            55.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.18.7.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.18.7.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.18.7.4.3.1" style="color:#662506;">
             +17.7
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.18.7.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.18.7.5.1" style="font-size:80%;color:#6A51A3;">
            68.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.18.7.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.18.7.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.18.7.5.3.1" style="color:#3F007D;">
             +31.1
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.18.7.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.18.7.6.1" style="font-size:80%;">
            5.8
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.18.7.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.18.7.7.1" style="font-size:80%;color:#2B8CBE;">
            10.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.18.7.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.18.7.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.18.7.7.3.1" style="color:#084081;">
             +4.6
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.18.7.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.18.7.8.1" style="font-size:80%;color:#D95F0E;">
            10.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.18.7.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.18.7.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.18.7.8.3.1" style="color:#662506;">
             +4.6
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.18.7.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.18.7.9.1" style="font-size:80%;color:#6A51A3;">
            19.8
           </span>
           <span class="ltx_text" id="A2.T6.11.11.18.7.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.18.7.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.18.7.9.3.1" style="color:#3F007D;">
             +14.0
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.19.8">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T6.11.11.19.8.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.11.11.19.8.1.1" style="font-size:80%;">
            RISE (Ours)
           </span>
          </th>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.19.8.2" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.19.8.3" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.19.8.4" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.19.8.5" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.19.8.6" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.19.8.7" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.19.8.8" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.19.8.9" style="padding:-0.05pt 3.4pt;">
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.20.9">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.20.9.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.20.9.1.1" style="font-size:80%;">
            Mistral-7B
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.20.9.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.20.9.2.1" style="font-size:80%;">
            33.7
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.20.9.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.20.9.3.1" style="font-size:80%;color:#2B8CBE;">
            49.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.20.9.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.20.9.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.20.9.3.3.1" style="color:#084081;">
             +15.7
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.20.9.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.20.9.4.1" style="font-size:80%;color:#D95F0E;">
            39.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.20.9.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.20.9.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.20.9.4.3.1" style="color:#662506;">
             +5.3
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.20.9.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.20.9.5.1" style="font-size:80%;color:#6A51A3;">
            46.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.20.9.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.20.9.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.20.9.5.3.1" style="color:#3F007D;">
             +13.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.20.9.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.20.9.6.1" style="font-size:80%;">
            7.5
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.20.9.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.20.9.7.1" style="font-size:80%;color:#2B8CBE;">
            13.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.20.9.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.20.9.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.20.9.7.3.1" style="color:#084081;">
             +5.5
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.20.9.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.20.9.8.1" style="font-size:80%;color:#D95F0E;">
            8.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.20.9.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.20.9.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.20.9.8.3.1" style="color:#662506;">
             +0.9
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.20.9.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.20.9.9.1" style="font-size:80%;color:#6A51A3;">
            13.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.20.9.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.20.9.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.20.9.9.3.1" style="color:#3F007D;">
             +5.5
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.21.10">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.21.10.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.21.10.1.1" style="font-size:80%;">
            + Iteration 1
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.21.10.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.21.10.2.1" style="font-size:80%;">
            35.3
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.21.10.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.21.10.3.1" style="font-size:80%;color:#2B8CBE;">
            50.6
           </span>
           <span class="ltx_text" id="A2.T6.11.11.21.10.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.21.10.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.21.10.3.3.1" style="color:#084081;">
             +15.3
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.21.10.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.21.10.4.1" style="font-size:80%;color:#D95F0E;">
            59.2
           </span>
           <span class="ltx_text" id="A2.T6.11.11.21.10.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.21.10.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.21.10.4.3.1" style="color:#662506;">
             +23.9
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.21.10.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.21.10.5.1" style="font-size:80%;color:#6A51A3;">
            68.6
           </span>
           <span class="ltx_text" id="A2.T6.11.11.21.10.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.21.10.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.21.10.5.3.1" style="color:#3F007D;">
             +33.3
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.21.10.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.21.10.6.1" style="font-size:80%;">
            6.7
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.21.10.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.21.10.7.1" style="font-size:80%;color:#2B8CBE;">
            9.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.21.10.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.21.10.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.21.10.7.3.1" style="color:#084081;">
             +2.8
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.21.10.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.21.10.8.1" style="font-size:80%;color:#D95F0E;">
            18.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.21.10.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.21.10.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.21.10.8.3.1" style="color:#662506;">
             +11.1
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.21.10.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.21.10.9.1" style="font-size:80%;color:#6A51A3;">
            29.7
           </span>
           <span class="ltx_text" id="A2.T6.11.11.21.10.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.21.10.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.21.10.9.3.1" style="color:#3F007D;">
             +22.4
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.22.11">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T6.11.11.22.11.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.11.11.22.11.1.1" style="font-size:80%;">
            SFT on oracle data
           </span>
          </th>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.22.11.2" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.22.11.3" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.22.11.4" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.22.11.5" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.22.11.6" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.22.11.7" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.22.11.8" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.22.11.9" style="padding:-0.05pt 3.4pt;">
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.23.12">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.23.12.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.23.12.1.1" style="font-size:80%;">
            Only correct data
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.23.12.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.23.12.2.1" style="font-size:80%;">
            27.4
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.23.12.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.23.12.3.1" style="font-size:80%;color:#2B8CBE;">
            42.2
           </span>
           <span class="ltx_text" id="A2.T6.11.11.23.12.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.23.12.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.23.12.3.3.1" style="color:#084081;">
             +14.9
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.23.12.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.23.12.4.1" style="font-size:80%;color:#D95F0E;">
            34.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.23.12.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.23.12.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.23.12.4.3.1" style="color:#662506;">
             +6.6
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.23.12.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.23.12.5.1" style="font-size:80%;color:#6A51A3;">
            43.6
           </span>
           <span class="ltx_text" id="A2.T6.11.11.23.12.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.23.12.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.23.12.5.3.1" style="color:#3F007D;">
             +16.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.23.12.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.23.12.6.1" style="font-size:80%;">
            5.8
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.23.12.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.23.12.7.1" style="font-size:80%;color:#2B8CBE;">
            7.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.23.12.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.23.12.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.23.12.7.3.1" style="color:#084081;">
             +2.1
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.23.12.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.23.12.8.1" style="font-size:80%;color:#D95F0E;">
            5.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.23.12.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.23.12.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.23.12.8.3.1" style="color:#662506;">
             -0.3
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.23.12.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.23.12.9.1" style="font-size:80%;color:#6A51A3;">
            12.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.23.12.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.23.12.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.23.12.9.3.1" style="color:#3F007D;">
             +6.2
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.24.13">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.24.13.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.24.13.1.1" style="font-size:80%;">
            Correct and incorrect
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.24.13.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.24.13.2.1" style="font-size:80%;">
            25.7
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.24.13.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.24.13.3.1" style="font-size:80%;color:#2B8CBE;">
            41.8
           </span>
           <span class="ltx_text" id="A2.T6.11.11.24.13.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.24.13.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.24.13.3.3.1" style="color:#084081;">
             +16.1
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.24.13.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.24.13.4.1" style="font-size:80%;color:#D95F0E;">
            31.2
           </span>
           <span class="ltx_text" id="A2.T6.11.11.24.13.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.24.13.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.24.13.4.3.1" style="color:#662506;">
             +5.5
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.24.13.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.24.13.5.1" style="font-size:80%;color:#6A51A3;">
            41.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.24.13.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.24.13.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.24.13.5.3.1" style="color:#3F007D;">
             +15.8
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.24.13.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.24.13.6.1" style="font-size:80%;">
            5.0
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.24.13.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.24.13.7.1" style="font-size:80%;color:#2B8CBE;">
            5.2
           </span>
           <span class="ltx_text" id="A2.T6.11.11.24.13.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.24.13.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.24.13.7.3.1" style="color:#084081;">
             +0.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.24.13.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.24.13.8.1" style="font-size:80%;color:#D95F0E;">
            5.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.24.13.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.24.13.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.24.13.8.3.1" style="color:#662506;">
             +0.0
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.24.13.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.24.13.9.1" style="font-size:80%;color:#6A51A3;">
            13.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.24.13.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.24.13.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.24.13.9.3.1" style="color:#3F007D;">
             +8.1
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.25.14">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T6.11.11.25.14.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.11.11.25.14.1.1" style="font-size:80%;">
            Baselines
           </span>
          </th>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.25.14.2" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.25.14.3" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.25.14.4" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.25.14.5" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.25.14.6" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.25.14.7" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.25.14.8" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.25.14.9" style="padding:-0.05pt 3.4pt;">
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.26.15">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.26.15.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.26.15.1.1" style="font-size:80%;">
            GPT-3.5
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.26.15.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.26.15.2.1" style="font-size:80%;">
            66.4
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.26.15.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.26.15.3.1" style="font-size:80%;color:#2B8CBE;">
            80.6
           </span>
           <span class="ltx_text" id="A2.T6.11.11.26.15.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.26.15.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.26.15.3.3.1" style="color:#084081;">
             +14.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.26.15.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.26.15.4.1" style="font-size:80%;color:#D95F0E;">
            71.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.26.15.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.26.15.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.26.15.4.3.1" style="color:#662506;">
             +4.6
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.26.15.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.26.15.5.1" style="font-size:80%;color:#6A51A3;">
            74.7
           </span>
           <span class="ltx_text" id="A2.T6.11.11.26.15.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.26.15.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.26.15.5.3.1" style="color:#3F007D;">
             +8.3
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.26.15.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.26.15.6.1" style="font-size:80%;">
            39.7
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.26.15.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.26.15.7.1" style="font-size:80%;color:#2B8CBE;">
            47.8
           </span>
           <span class="ltx_text" id="A2.T6.11.11.26.15.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.26.15.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.26.15.7.3.1" style="color:#084081;">
             +8.1
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.26.15.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.26.15.8.1" style="font-size:80%;color:#D95F0E;">
            45.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.26.15.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.26.15.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.26.15.8.3.1" style="color:#662506;">
             +5.4
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.26.15.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.26.15.9.1" style="font-size:80%;color:#6A51A3;">
            54.3
           </span>
           <span class="ltx_text" id="A2.T6.11.11.26.15.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.26.15.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.26.15.9.3.1" style="color:#3F007D;">
             +14.6
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.27.16">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.27.16.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.27.16.1.1" style="font-size:80%;">
            Mistral-7B
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.27.16.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.27.16.2.1" style="font-size:80%;">
            33.7
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.27.16.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.27.16.3.1" style="font-size:80%;color:#2B8CBE;">
            49.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.27.16.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.27.16.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.27.16.3.3.1" style="color:#084081;">
             +15.7
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.27.16.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.27.16.4.1" style="font-size:80%;color:#D95F0E;">
            39.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.27.16.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.27.16.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.27.16.4.3.1" style="color:#662506;">
             +5.3
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.27.16.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.27.16.5.1" style="font-size:80%;color:#6A51A3;">
            46.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.27.16.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.27.16.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.27.16.5.3.1" style="color:#3F007D;">
             +13.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.27.16.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.27.16.6.1" style="font-size:80%;">
            7.5
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.27.16.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.27.16.7.1" style="font-size:80%;color:#2B8CBE;">
            13.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.27.16.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.27.16.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.27.16.7.3.1" style="color:#084081;">
             +5.5
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.27.16.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.27.16.8.1" style="font-size:80%;color:#D95F0E;">
            8.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.27.16.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.27.16.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.27.16.8.3.1" style="color:#662506;">
             +0.9
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.27.16.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.27.16.9.1" style="font-size:80%;color:#6A51A3;">
            13.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.27.16.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.27.16.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.27.16.9.3.1" style="color:#3F007D;">
             +5.5
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.28.17">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.28.17.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.28.17.1.1" style="font-size:80%;">
            Eurus-7b-SFT
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.28.17.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.28.17.2.1" style="font-size:80%;">
            36.3
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.28.17.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.28.17.3.1" style="font-size:80%;color:#2B8CBE;">
            66.3
           </span>
           <span class="ltx_text" id="A2.T6.11.11.28.17.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.28.17.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.28.17.3.3.1" style="color:#084081;">
             +30.0
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.28.17.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.28.17.4.1" style="font-size:80%;color:#D95F0E;">
            47.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.28.17.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.28.17.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.28.17.4.3.1" style="color:#662506;">
             +11.6
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.28.17.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.28.17.5.1" style="font-size:80%;color:#6A51A3;">
            53.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.28.17.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.28.17.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.28.17.5.3.1" style="color:#3F007D;">
             +16.8
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.28.17.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.28.17.6.1" style="font-size:80%;">
            12.3
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.28.17.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.28.17.7.1" style="font-size:80%;color:#2B8CBE;">
            19.8
           </span>
           <span class="ltx_text" id="A2.T6.11.11.28.17.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.28.17.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.28.17.7.3.1" style="color:#084081;">
             +7.5
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.28.17.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.28.17.8.1" style="font-size:80%;color:#D95F0E;">
            16.3
           </span>
           <span class="ltx_text" id="A2.T6.11.11.28.17.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.28.17.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.28.17.8.3.1" style="color:#662506;">
             +4.0
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.28.17.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.28.17.9.1" style="font-size:80%;color:#6A51A3;">
            22.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.28.17.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.28.17.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.28.17.9.3.1" style="color:#3F007D;">
             +10.6
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.8.8.8">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T6.8.8.8.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.8.8.8.5.1" style="font-size:80%;">
            Self-Refine
           </span>
          </th>
          <td class="ltx_td ltx_border_t" id="A2.T6.8.8.8.6" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.8.8.8.7" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T6.5.5.5.1" style="padding:-0.05pt 3.4pt;">
           <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.T6.5.5.5.1.m1.1">
            <semantics id="A2.T6.5.5.5.1.m1.1a">
             <mo id="A2.T6.5.5.5.1.m1.1.1" mathsize="80%" stretchy="false" xref="A2.T6.5.5.5.1.m1.1.1.cmml">
              →
             </mo>
             <annotation-xml encoding="MathML-Content" id="A2.T6.5.5.5.1.m1.1b">
              <ci id="A2.T6.5.5.5.1.m1.1.1.cmml" xref="A2.T6.5.5.5.1.m1.1.1">
               →
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="A2.T6.5.5.5.1.m1.1c">
              \rightarrow
             </annotation>
            </semantics>
           </math>
           <span class="ltx_text" id="A2.T6.5.5.5.1.1" style="font-size:80%;">
            m1@t3
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A2.T6.6.6.6.2" style="padding:-0.05pt 3.4pt;">
           <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.T6.6.6.6.2.m1.1">
            <semantics id="A2.T6.6.6.6.2.m1.1a">
             <mo id="A2.T6.6.6.6.2.m1.1.1" mathsize="80%" stretchy="false" xref="A2.T6.6.6.6.2.m1.1.1.cmml">
              →
             </mo>
             <annotation-xml encoding="MathML-Content" id="A2.T6.6.6.6.2.m1.1b">
              <ci id="A2.T6.6.6.6.2.m1.1.1.cmml" xref="A2.T6.6.6.6.2.m1.1.1">
               →
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="A2.T6.6.6.6.2.m1.1c">
              \rightarrow
             </annotation>
            </semantics>
           </math>
           <span class="ltx_text" id="A2.T6.6.6.6.2.1" style="font-size:80%;">
            p1@t3
           </span>
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.8.8.8.8" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.8.8.8.9" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T6.7.7.7.3" style="padding:-0.05pt 3.4pt;">
           <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.T6.7.7.7.3.m1.1">
            <semantics id="A2.T6.7.7.7.3.m1.1a">
             <mo id="A2.T6.7.7.7.3.m1.1.1" mathsize="80%" stretchy="false" xref="A2.T6.7.7.7.3.m1.1.1.cmml">
              →
             </mo>
             <annotation-xml encoding="MathML-Content" id="A2.T6.7.7.7.3.m1.1b">
              <ci id="A2.T6.7.7.7.3.m1.1.1.cmml" xref="A2.T6.7.7.7.3.m1.1.1">
               →
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="A2.T6.7.7.7.3.m1.1c">
              \rightarrow
             </annotation>
            </semantics>
           </math>
           <span class="ltx_text" id="A2.T6.7.7.7.3.1" style="font-size:80%;">
            m1@t3
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T6.8.8.8.4" style="padding:-0.05pt 3.4pt;">
           <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.T6.8.8.8.4.m1.1">
            <semantics id="A2.T6.8.8.8.4.m1.1a">
             <mo id="A2.T6.8.8.8.4.m1.1.1" mathsize="80%" stretchy="false" xref="A2.T6.8.8.8.4.m1.1.1.cmml">
              →
             </mo>
             <annotation-xml encoding="MathML-Content" id="A2.T6.8.8.8.4.m1.1b">
              <ci id="A2.T6.8.8.8.4.m1.1.1.cmml" xref="A2.T6.8.8.8.4.m1.1.1">
               →
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="A2.T6.8.8.8.4.m1.1c">
              \rightarrow
             </annotation>
            </semantics>
           </math>
           <span class="ltx_text" id="A2.T6.8.8.8.4.1" style="font-size:80%;">
            p1@t3
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.29.18">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.29.18.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.29.18.1.1" style="font-size:80%;">
            Base
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.29.18.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.29.18.2.1" style="font-size:80%;">
            10.5
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.29.18.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.29.18.3.1" style="font-size:80%;color:#2B8CBE;">
            22.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.29.18.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.29.18.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.29.18.3.3.1" style="color:#084081;">
             +11.9
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.29.18.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.29.18.4.1" style="font-size:80%;color:#D95F0E;">
            7.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.29.18.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.29.18.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.29.18.4.3.1" style="color:#662506;">
             -3.4
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.29.18.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.29.18.5.1" style="font-size:80%;color:#6A51A3;">
            13.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.29.18.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.29.18.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.29.18.5.3.1" style="color:#3F007D;">
             +2.5
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.29.18.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.29.18.6.1" style="font-size:80%;">
            1.9
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.29.18.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.29.18.7.1" style="font-size:80%;color:#2B8CBE;">
            5.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.29.18.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.29.18.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.29.18.7.3.1" style="color:#084081;">
             +3.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.29.18.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.29.18.8.1" style="font-size:80%;color:#D95F0E;">
            1.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.29.18.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.29.18.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.29.18.8.3.1" style="color:#662506;">
             0.0
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.29.18.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.29.18.9.1" style="font-size:80%;color:#6A51A3;">
            3.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.29.18.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.29.18.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.29.18.9.3.1" style="color:#3F007D;">
             +1.2
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.30.19">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.30.19.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.30.19.1.1" style="font-size:80%;">
            +Boost
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.30.19.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.30.19.2.1" style="font-size:80%;">
            32.9
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.30.19.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.30.19.3.1" style="font-size:80%;color:#2B8CBE;">
            45.3
           </span>
           <span class="ltx_text" id="A2.T6.11.11.30.19.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.30.19.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.30.19.3.3.1" style="color:#084081;">
             +12.4
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.30.19.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.30.19.4.1" style="font-size:80%;color:#D95F0E;">
            26.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.30.19.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.30.19.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.30.19.4.3.1" style="color:#662506;">
             -6.4
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.30.19.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.30.19.5.1" style="font-size:80%;color:#6A51A3;">
            40.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.30.19.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.30.19.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.30.19.5.3.1" style="color:#3F007D;">
             +8.0
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.30.19.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.30.19.6.1" style="font-size:80%;">
            5.5
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.30.19.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.30.19.7.1" style="font-size:80%;color:#2B8CBE;">
            6.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.30.19.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.30.19.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.30.19.7.3.1" style="color:#084081;">
             +1.0
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.30.19.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.30.19.8.1" style="font-size:80%;color:#D95F0E;">
            2.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.30.19.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.30.19.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.30.19.8.3.1" style="color:#662506;">
             -2.6
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.30.19.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.30.19.9.1" style="font-size:80%;color:#6A51A3;">
            7.2
           </span>
           <span class="ltx_text" id="A2.T6.11.11.30.19.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.30.19.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.30.19.9.3.1" style="color:#3F007D;">
             +1.7
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.31.20">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.31.20.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.31.20.1.1" style="font-size:80%;">
            +Iteration1
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.31.20.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.31.20.2.1" style="font-size:80%;">
            35.6
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.31.20.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.31.20.3.1" style="font-size:80%;color:#2B8CBE;">
            49.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.31.20.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.31.20.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.31.20.3.3.1" style="color:#084081;">
             +13.9
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.31.20.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.31.20.4.1" style="font-size:80%;color:#D95F0E;">
            31.7
           </span>
           <span class="ltx_text" id="A2.T6.11.11.31.20.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.31.20.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.31.20.4.3.1" style="color:#662506;">
             -3.9
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.31.20.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.31.20.5.1" style="font-size:80%;color:#6A51A3;">
            43.7
           </span>
           <span class="ltx_text" id="A2.T6.11.11.31.20.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.31.20.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.31.20.5.3.1" style="color:#3F007D;">
             +8.1
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.31.20.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.31.20.6.1" style="font-size:80%;">
            6.3
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.31.20.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.31.20.7.1" style="font-size:80%;color:#2B8CBE;">
            8.7
           </span>
           <span class="ltx_text" id="A2.T6.11.11.31.20.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.31.20.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.31.20.7.3.1" style="color:#084081;">
             +2.4
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.31.20.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.31.20.8.1" style="font-size:80%;color:#D95F0E;">
            5.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.31.20.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.31.20.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.31.20.8.3.1" style="color:#662506;">
             -0.4
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.31.20.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.31.20.9.1" style="font-size:80%;color:#6A51A3;">
            9.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.31.20.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.31.20.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.31.20.9.3.1" style="color:#3F007D;">
             +3.6
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.32.21">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.32.21.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.32.21.1.1" style="font-size:80%;">
            +Iteration2
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.32.21.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.32.21.2.1" style="font-size:80%;">
            37.3
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.32.21.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.32.21.3.1" style="font-size:80%;color:#2B8CBE;">
            50.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.32.21.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.32.21.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.32.21.3.3.1" style="color:#084081;">
             +13.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.32.21.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.32.21.4.1" style="font-size:80%;color:#D95F0E;">
            33.3
           </span>
           <span class="ltx_text" id="A2.T6.11.11.32.21.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.32.21.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.32.21.4.3.1" style="color:#662506;">
             -4.0
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.32.21.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.32.21.5.1" style="font-size:80%;color:#6A51A3;">
            44.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.32.21.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.32.21.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.32.21.5.3.1" style="color:#3F007D;">
             +7.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.32.21.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.32.21.6.1" style="font-size:80%;">
            5.8
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.32.21.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.32.21.7.1" style="font-size:80%;color:#2B8CBE;">
            9.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.32.21.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.32.21.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.32.21.7.3.1" style="color:#084081;">
             +3.6
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.32.21.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.32.21.8.1" style="font-size:80%;color:#D95F0E;">
            5.7
           </span>
           <span class="ltx_text" id="A2.T6.11.11.32.21.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.32.21.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.32.21.8.3.1" style="color:#662506;">
             -0.1
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.32.21.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.32.21.9.1" style="font-size:80%;color:#6A51A3;">
            9.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.32.21.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.32.21.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.32.21.9.3.1" style="color:#3F007D;">
             +3.7
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.33.22">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.33.22.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.33.22.1.1" style="font-size:80%;">
            GPT-3.5
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.33.22.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.33.22.2.1" style="font-size:80%;">
            66.4
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.33.22.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.33.22.3.1" style="font-size:80%;color:#2B8CBE;">
            80.2
           </span>
           <span class="ltx_text" id="A2.T6.11.11.33.22.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.33.22.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.33.22.3.3.1" style="color:#084081;">
             +13.8
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.33.22.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.33.22.4.1" style="font-size:80%;color:#D95F0E;">
            61.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.33.22.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.33.22.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.33.22.4.3.1" style="color:#662506;">
             -5.4
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.33.22.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.33.22.5.1" style="font-size:80%;color:#6A51A3;">
            71.6
           </span>
           <span class="ltx_text" id="A2.T6.11.11.33.22.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.33.22.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.33.22.5.3.1" style="color:#3F007D;">
             +5.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.33.22.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.33.22.6.1" style="font-size:80%;">
            39.7
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.33.22.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.33.22.7.1" style="font-size:80%;color:#2B8CBE;">
            46.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.33.22.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.33.22.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.33.22.7.3.1" style="color:#084081;">
             +6.8
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.33.22.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.33.22.8.1" style="font-size:80%;color:#D95F0E;">
            36.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.33.22.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.33.22.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.33.22.8.3.1" style="color:#662506;">
             -3.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.33.22.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.33.22.9.1" style="font-size:80%;color:#6A51A3;">
            46.7
           </span>
           <span class="ltx_text" id="A2.T6.11.11.33.22.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.33.22.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.33.22.9.3.1" style="color:#3F007D;">
             +7.0
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.34.23">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.34.23.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.34.23.1.1" style="font-size:80%;">
            Mistral-7B
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.34.23.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.34.23.2.1" style="font-size:80%;">
            33.7
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.34.23.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.34.23.3.1" style="font-size:80%;color:#2B8CBE;">
            48.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.34.23.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.34.23.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.34.23.3.3.1" style="color:#084081;">
             +14.8
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.34.23.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.34.23.4.1" style="font-size:80%;color:#D95F0E;">
            21.2
           </span>
           <span class="ltx_text" id="A2.T6.11.11.34.23.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.34.23.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.34.23.4.3.1" style="color:#662506;">
             -12.5
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.34.23.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.34.23.5.1" style="font-size:80%;color:#6A51A3;">
            37.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.34.23.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.34.23.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.34.23.5.3.1" style="color:#3F007D;">
             +4.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.34.23.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.34.23.6.1" style="font-size:80%;">
            7.5
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.34.23.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.34.23.7.1" style="font-size:80%;color:#2B8CBE;">
            12.3
           </span>
           <span class="ltx_text" id="A2.T6.11.11.34.23.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.34.23.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.34.23.7.3.1" style="color:#084081;">
             +4.8
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.34.23.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.34.23.8.1" style="font-size:80%;color:#D95F0E;">
            7.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.34.23.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.34.23.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.34.23.8.3.1" style="color:#662506;">
             -0.4
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.34.23.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.34.23.9.1" style="font-size:80%;color:#6A51A3;">
            11.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.34.23.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.34.23.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.34.23.9.3.1" style="color:#3F007D;">
             +3.9
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.35.24">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.35.24.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.35.24.1.1" style="font-size:80%;">
            Eurus-7b-SFT
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.35.24.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.35.24.2.1" style="font-size:80%;">
            36.3
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.35.24.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.35.24.3.1" style="font-size:80%;color:#2B8CBE;">
            65.9
           </span>
           <span class="ltx_text" id="A2.T6.11.11.35.24.3.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.35.24.3.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.35.24.3.3.1" style="color:#084081;">
             +29.6
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.35.24.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.35.24.4.1" style="font-size:80%;color:#D95F0E;">
            26.2
           </span>
           <span class="ltx_text" id="A2.T6.11.11.35.24.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.35.24.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.35.24.4.3.1" style="color:#662506;">
             -10.1
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.35.24.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.35.24.5.1" style="font-size:80%;color:#6A51A3;">
            42.8
           </span>
           <span class="ltx_text" id="A2.T6.11.11.35.24.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.35.24.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.35.24.5.3.1" style="color:#3F007D;">
             +6.5
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.35.24.6" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.35.24.6.1" style="font-size:80%;">
            12.3
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.35.24.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.35.24.7.1" style="font-size:80%;color:#2B8CBE;">
            19.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.35.24.7.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.35.24.7.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.35.24.7.3.1" style="color:#084081;">
             +7.1
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.35.24.8" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.35.24.8.1" style="font-size:80%;color:#D95F0E;">
            9.0
           </span>
           <span class="ltx_text" id="A2.T6.11.11.35.24.8.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.35.24.8.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.35.24.8.3.1" style="color:#662506;">
             -3.3
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.35.24.9" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.35.24.9.1" style="font-size:80%;color:#6A51A3;">
            15.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.35.24.9.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.35.24.9.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.35.24.9.3.1" style="color:#3F007D;">
             +2.8
            </span>
            )
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.10.10.10">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T6.10.10.10.3" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.10.10.10.3.1" style="font-size:80%;">
            GloRE
           </span>
          </th>
          <td class="ltx_td ltx_border_t" id="A2.T6.10.10.10.4" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.10.10.10.5" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T6.9.9.9.1" style="padding:-0.05pt 3.4pt;">
           <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.T6.9.9.9.1.m1.1">
            <semantics id="A2.T6.9.9.9.1.m1.1a">
             <mo id="A2.T6.9.9.9.1.m1.1.1" mathsize="80%" stretchy="false" xref="A2.T6.9.9.9.1.m1.1.1.cmml">
              →
             </mo>
             <annotation-xml encoding="MathML-Content" id="A2.T6.9.9.9.1.m1.1b">
              <ci id="A2.T6.9.9.9.1.m1.1.1.cmml" xref="A2.T6.9.9.9.1.m1.1.1">
               →
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="A2.T6.9.9.9.1.m1.1c">
              \rightarrow
             </annotation>
            </semantics>
           </math>
           <span class="ltx_text" id="A2.T6.9.9.9.1.1" style="font-size:80%;">
            m1@t3
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A2.T6.10.10.10.2" style="padding:-0.05pt 3.4pt;">
           <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.T6.10.10.10.2.m1.1">
            <semantics id="A2.T6.10.10.10.2.m1.1a">
             <mo id="A2.T6.10.10.10.2.m1.1.1" mathsize="80%" stretchy="false" xref="A2.T6.10.10.10.2.m1.1.1.cmml">
              →
             </mo>
             <annotation-xml encoding="MathML-Content" id="A2.T6.10.10.10.2.m1.1b">
              <ci id="A2.T6.10.10.10.2.m1.1.1.cmml" xref="A2.T6.10.10.10.2.m1.1.1">
               →
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="A2.T6.10.10.10.2.m1.1c">
              \rightarrow
             </annotation>
            </semantics>
           </math>
           <span class="ltx_text" id="A2.T6.10.10.10.2.1" style="font-size:80%;">
            p1@t3
           </span>
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.10.10.10.6" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.10.10.10.7" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.10.10.10.8" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.10.10.10.9" style="padding:-0.05pt 3.4pt;">
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.36.25">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.36.25.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.36.25.1.1" style="font-size:80%;">
            +ORM
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.36.25.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.36.25.2.1" style="font-size:80%;">
            48.2
           </span>
          </td>
          <td class="ltx_td" id="A2.T6.11.11.36.25.3" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.36.25.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.36.25.4.1" style="font-size:80%;color:#D95F0E;">
            49.5
           </span>
           <span class="ltx_text" id="A2.T6.11.11.36.25.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.36.25.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.36.25.4.3.1" style="color:#662506;">
             +1.3
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.36.25.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.36.25.5.1" style="font-size:80%;color:#6A51A3;">
            57.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.36.25.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.36.25.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.36.25.5.3.1" style="color:#3F007D;">
             +8.9
            </span>
            )
           </span>
          </td>
          <td class="ltx_td" id="A2.T6.11.11.36.25.6" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td" id="A2.T6.11.11.36.25.7" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td" id="A2.T6.11.11.36.25.8" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td" id="A2.T6.11.11.36.25.9" style="padding:-0.05pt 3.4pt;">
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.37.26">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.37.26.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.37.26.1.1" style="font-size:80%;">
            +SORM
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.37.26.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.37.26.2.1" style="font-size:80%;">
            48.2
           </span>
          </td>
          <td class="ltx_td" id="A2.T6.11.11.37.26.3" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.37.26.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.37.26.4.1" style="font-size:80%;color:#D95F0E;">
            51.6
           </span>
           <span class="ltx_text" id="A2.T6.11.11.37.26.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.37.26.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.37.26.4.3.1" style="color:#662506;">
             +3.4
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.37.26.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.37.26.5.1" style="font-size:80%;color:#6A51A3;">
            59.7
           </span>
           <span class="ltx_text" id="A2.T6.11.11.37.26.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.37.26.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.37.26.5.3.1" style="color:#3F007D;">
             +11.5
            </span>
            )
           </span>
          </td>
          <td class="ltx_td" id="A2.T6.11.11.37.26.6" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center" colspan="2" id="A2.T6.11.11.37.26.7" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.37.26.7.1" style="font-size:80%;">
            N/A
           </span>
          </td>
          <td class="ltx_td" id="A2.T6.11.11.37.26.8" style="padding:-0.05pt 3.4pt;">
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.38.27">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.38.27.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.38.27.1.1" style="font-size:80%;">
            +Direct
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.38.27.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.38.27.2.1" style="font-size:80%;">
            48.2
           </span>
          </td>
          <td class="ltx_td" id="A2.T6.11.11.38.27.3" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.38.27.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.38.27.4.1" style="font-size:80%;color:#D95F0E;">
            47.4
           </span>
           <span class="ltx_text" id="A2.T6.11.11.38.27.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.38.27.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.38.27.4.3.1" style="color:#662506;">
             -0.8
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.38.27.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.38.27.5.1" style="font-size:80%;color:#6A51A3;">
            59.2
           </span>
           <span class="ltx_text" id="A2.T6.11.11.38.27.5.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.38.27.5.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.38.27.5.3.1" style="color:#3F007D;">
             +11.0
            </span>
            )
           </span>
          </td>
          <td class="ltx_td" id="A2.T6.11.11.38.27.6" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td" id="A2.T6.11.11.38.27.7" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td" id="A2.T6.11.11.38.27.8" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td" id="A2.T6.11.11.38.27.9" style="padding:-0.05pt 3.4pt;">
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.11">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T6.11.11.11.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text ltx_font_bold" id="A2.T6.11.11.11.2.1" style="font-size:80%;">
            V-STaR
           </span>
          </th>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.11.3" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.11.4" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A2.T6.11.11.11.1" style="padding:-0.05pt 3.4pt;">
           <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.T6.11.11.11.1.m1.1">
            <semantics id="A2.T6.11.11.11.1.m1.1a">
             <mo id="A2.T6.11.11.11.1.m1.1.1" mathsize="80%" stretchy="false" xref="A2.T6.11.11.11.1.m1.1.1.cmml">
              →
             </mo>
             <annotation-xml encoding="MathML-Content" id="A2.T6.11.11.11.1.m1.1b">
              <ci id="A2.T6.11.11.11.1.m1.1.1.cmml" xref="A2.T6.11.11.11.1.m1.1.1">
               →
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="A2.T6.11.11.11.1.m1.1c">
              \rightarrow
             </annotation>
            </semantics>
           </math>
           <span class="ltx_text" id="A2.T6.11.11.11.1.1" style="font-size:80%;">
            m64@t1
           </span>
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.11.5" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.11.6" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.11.7" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.11.8" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_t" id="A2.T6.11.11.11.9" style="padding:-0.05pt 3.4pt;">
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.39.28">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.39.28.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.39.28.1.1" style="font-size:80%;">
            +STaR
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.39.28.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.39.28.2.1" style="font-size:80%;">
            28.0
           </span>
          </td>
          <td class="ltx_td" id="A2.T6.11.11.39.28.3" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.39.28.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.39.28.4.1" style="font-size:80%;color:#D95F0E;">
            46.1
           </span>
           <span class="ltx_text" id="A2.T6.11.11.39.28.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.39.28.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.39.28.4.3.1" style="color:#662506;">
             +18.1
            </span>
            )
           </span>
          </td>
          <td class="ltx_td" id="A2.T6.11.11.39.28.5" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td" id="A2.T6.11.11.39.28.6" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td" id="A2.T6.11.11.39.28.7" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td" id="A2.T6.11.11.39.28.8" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td" id="A2.T6.11.11.39.28.9" style="padding:-0.05pt 3.4pt;">
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.40.29">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T6.11.11.40.29.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.40.29.1.1" style="font-size:80%;">
            +Verification
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="A2.T6.11.11.40.29.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.40.29.2.1" style="font-size:80%;">
            28.0
           </span>
          </td>
          <td class="ltx_td" id="A2.T6.11.11.40.29.3" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.40.29.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.40.29.4.1" style="font-size:80%;color:#D95F0E;">
            56.2
           </span>
           <span class="ltx_text" id="A2.T6.11.11.40.29.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.40.29.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.40.29.4.3.1" style="color:#662506;">
             +28.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_align_center" colspan="5" id="A2.T6.11.11.40.29.5" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.40.29.5.1" style="font-size:80%;">
            N/A
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="A2.T6.11.11.41.30">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A2.T6.11.11.41.30.1" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.41.30.1.1" style="font-size:80%;">
            +V-STaR
           </span>
          </th>
          <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T6.11.11.41.30.2" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.41.30.2.1" style="font-size:80%;">
            28.0
           </span>
          </td>
          <td class="ltx_td ltx_border_bb" id="A2.T6.11.11.41.30.3" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A2.T6.11.11.41.30.4" style="padding:-0.05pt 3.4pt;">
           <span class="ltx_text" id="A2.T6.11.11.41.30.4.1" style="font-size:80%;color:#D95F0E;">
            63.2
           </span>
           <span class="ltx_text" id="A2.T6.11.11.41.30.4.2" style="font-size:80%;">
           </span>
           <span class="ltx_text" id="A2.T6.11.11.41.30.4.3" style="font-size:70%;">
            (
            <span class="ltx_text" id="A2.T6.11.11.41.30.4.3.1" style="color:#662506;">
             +35.2
            </span>
            )
           </span>
          </td>
          <td class="ltx_td ltx_border_bb" id="A2.T6.11.11.41.30.5" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_bb" id="A2.T6.11.11.41.30.6" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_bb" id="A2.T6.11.11.41.30.7" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_bb" id="A2.T6.11.11.41.30.8" style="padding:-0.05pt 3.4pt;">
          </td>
          <td class="ltx_td ltx_border_bb" id="A2.T6.11.11.41.30.9" style="padding:-0.05pt 3.4pt;">
          </td>
         </tr>
        </tbody>
       </table>
      </span>
     </div>
     <figcaption class="ltx_caption ltx_centering" style="font-size:80%;">
      <span class="ltx_tag ltx_tag_table">
       <span class="ltx_text" id="A2.T6.16.1.1" style="font-size:113%;">
        Table 6
       </span>
       :
      </span>
      <span class="ltx_text ltx_font_bold" id="A2.T6.17.2">
       Comparing RISE with other approaches (Self-Refine, GLoRE, and V-STaR) and other baseline approaches.
      </span>
      Observe that RISE attains the biggest performance improvements between 1-turn and 5-turn performance without the use of an oracle on both GSM8K and MATH. This performance gap is even larger when oracle early termination is allowed (5-turn w/ oracle). Self-Refine largely degrades performance across the board. GLoRE trains a separate refinement model, but still performs worse than RISE.
     </figcaption>
    </figure>
    <div class="ltx_para ltx_noindent" id="A2.SS1.p2">
     <p class="ltx_p" id="A2.SS1.p2.1">
      <span class="ltx_text ltx_font_bold" id="A2.SS1.p2.1.1">
       Comparison with Self-Refine
       <cite class="ltx_cite ltx_citemacro_citep">
        [
        <a class="ltx_ref" href="#bib.bib31" title="">
         31
        </a>
        ]
       </cite>
       .
      </span>
      To build a self-refine baseline
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib31" title="">
        31
       </a>
       ]
      </cite>
      evaluation, we slightly modified our evaluation pipeline following the self-refine approach. In this setup (Figure
      <a class="ltx_ref" href="#A2.F11" title="Figure 11 ‣ B.1 Complete Comparisons and Discussion: Extended Version of Table 1 ‣ Appendix B Additional Results ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        11
       </span>
      </a>
      ), the model generates an initial response, and then the environment prompts the model to locate errors in the generated solution and refine its answer based on the initial response and the identified error.
     </p>
    </div>
    <figure class="ltx_figure" id="A2.F11">
     <svg class="ltx_picture" height="45341.08" id="A2.F11.pic1" overflow="visible" version="1.1" width="45341.08">
      <g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,45341.08) matrix(1 0 0 -1 0 0) translate(22670.54,0) translate(0,22670.54)">
       <clippath id="pgfcp1">
        <path d="M -22670.54 -22670.54 L 22670.54 -22670.54 L 22670.54 22670.54 L -22670.54 22670.54 Z M 0 5.91 L 0 262.67 C 0 265.93 2.64 268.58 5.91 268.58 L 594.09 268.58 C 597.36 268.58 600 265.93 600 262.67 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z">
        </path>
       </clippath>
       <g fill-rule="evenodd">
        <g fill="#0000BF" fill-opacity="1.0">
         <path d="M 0 5.91 L 0 262.67 C 0 265.93 2.64 268.58 5.91 268.58 L 594.09 268.58 C 597.36 268.58 600 265.93 600 262.67 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z M 1.97 5.91 L 1.97 241.19 L 598.03 241.19 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
         </path>
        </g>
        <g fill="#FFFFFF" fill-opacity="1.0">
         <path d="M 1.97 5.91 L 1.97 241.19 L 598.03 241.19 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
         </path>
        </g>
        <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 250.08)">
         <foreignobject color="#FFFFFF" height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
          <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.F11.pic1.14.14.14.14.1.1" style="width:410.8pt;">
           <span class="ltx_p" id="A2.F11.pic1.14.14.14.14.1.1.1">
            <span class="ltx_text ltx_font_bold" id="A2.F11.pic1.14.14.14.14.1.1.1.1">
             Self-Refine
            </span>
           </span>
          </span>
         </foreignobject>
        </g>
        <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 15.81)">
         <foreignobject color="#000000" height="211.55" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
          <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13" style="width:410.8pt;">
           <span class="ltx_p" id="A2.F11.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3">
            <span class="ltx_text ltx_font_bold" id="A2.F11.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1">
             System
            </span>
            : You are an AI language model designed to assist with math problem-solving. In this task, I will provide you with math problems. Your goal is to solve the problem step-by-step, showing your reasoning at each step. After you have finished solving the problem, present your final answer as
            <math alttext="\backslash" class="ltx_Math" display="inline" id="A2.F11.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1">
             <semantics id="A2.F11.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a">
              <mo id="A2.F11.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="A2.F11.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
               \
              </mo>
              <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b">
               <ci id="A2.F11.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A2.F11.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
                \
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A2.F11.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">
               \backslash
              </annotation>
             </semantics>
            </math>
            boxed
            <math alttext="\{" class="ltx_Math" display="inline" id="A2.F11.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1">
             <semantics id="A2.F11.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1a">
              <mo id="A2.F11.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1" stretchy="false" xref="A2.F11.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.cmml">
               {
              </mo>
              <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1b">
               <ci id="A2.F11.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.cmml" xref="A2.F11.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1">
                {
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A2.F11.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1c">
               \{
              </annotation>
             </semantics>
            </math>
            Your Answer
            <math alttext="\}" class="ltx_Math" display="inline" id="A2.F11.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1">
             <semantics id="A2.F11.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1a">
              <mo id="A2.F11.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1" stretchy="false" xref="A2.F11.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1.cmml">
               }
              </mo>
              <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1b">
               <ci id="A2.F11.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1.cmml" xref="A2.F11.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1">
                }
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A2.F11.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1c">
               \}
              </annotation>
             </semantics>
            </math>
            .
           </span>
           <span class="ltx_p" id="A2.F11.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5">
            <math alttext="&lt;" class="ltx_Math" display="inline" id="A2.F11.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1">
             <semantics id="A2.F11.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1a">
              <mo id="A2.F11.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1.1" xref="A2.F11.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1.1.cmml">
               &lt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1b">
               <lt id="A2.F11.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1.1.cmml" xref="A2.F11.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1.1">
               </lt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A2.F11.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1c">
               &lt;
              </annotation>
             </semantics>
            </math>
            <span class="ltx_text ltx_font_bold" id="A2.F11.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1">
             One-shot Example
             <a class="ltx_ref" href="#A4.F17" title="Figure 17 ‣ D.5 One-shot Example ‣ Appendix D Experimental Details ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
              <span class="ltx_text ltx_ref_tag">
               17
              </span>
             </a>
             <math alttext="&gt;" class="ltx_Math" display="inline" id="A2.F11.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1">
              <semantics id="A2.F11.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1a">
               <mo id="A2.F11.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1" xref="A2.F11.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1.cmml">
                &gt;
               </mo>
               <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1b">
                <gt id="A2.F11.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1.cmml" xref="A2.F11.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1">
                </gt>
               </annotation-xml>
               <annotation encoding="application/x-tex" id="A2.F11.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1c">
                &gt;
               </annotation>
              </semantics>
             </math>
            </span>
           </span>
           <span class="ltx_p" id="A2.F11.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7">
            <span class="ltx_text ltx_font_bold" id="A2.F11.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.1">
             User
            </span>
            :
            <math alttext="&lt;" class="ltx_Math" display="inline" id="A2.F11.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1">
             <semantics id="A2.F11.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1a">
              <mo id="A2.F11.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1.1" xref="A2.F11.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1.1.cmml">
               &lt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1b">
               <lt id="A2.F11.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1.1.cmml" xref="A2.F11.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1.1">
               </lt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A2.F11.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1c">
               &lt;
              </annotation>
             </semantics>
            </math>
            Query
            <math alttext="&gt;" class="ltx_Math" display="inline" id="A2.F11.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1">
             <semantics id="A2.F11.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1a">
              <mo id="A2.F11.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1.1" xref="A2.F11.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1.1.cmml">
               &gt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1b">
               <gt id="A2.F11.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1.1.cmml" xref="A2.F11.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1.1">
               </gt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A2.F11.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1c">
               &gt;
              </annotation>
             </semantics>
            </math>
           </span>
           <span class="ltx_p" id="A2.F11.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9">
            <span class="ltx_text ltx_font_bold" id="A2.F11.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.1">
             Agent
            </span>
            :
            <math alttext="&lt;" class="ltx_Math" display="inline" id="A2.F11.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1">
             <semantics id="A2.F11.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1a">
              <mo id="A2.F11.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1.1" xref="A2.F11.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1.1.cmml">
               &lt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1b">
               <lt id="A2.F11.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1.1.cmml" xref="A2.F11.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1.1">
               </lt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A2.F11.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1c">
               &lt;
              </annotation>
             </semantics>
            </math>
            Initial Answer
            <math alttext="&gt;" class="ltx_Math" display="inline" id="A2.F11.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1">
             <semantics id="A2.F11.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1a">
              <mo id="A2.F11.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1.1" xref="A2.F11.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1.1.cmml">
               &gt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1b">
               <gt id="A2.F11.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1.1.cmml" xref="A2.F11.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1.1">
               </gt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A2.F11.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1c">
               &gt;
              </annotation>
             </semantics>
            </math>
           </span>
           <span class="ltx_p" id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.14">
            <span class="ltx_text ltx_font_bold" id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.14.1">
             User
            </span>
            : There is an error in the solution above because of lack of understanding of the question. What is the error? To find the error, go through each step of the solution, and check if everything looks good.
           </span>
           <span class="ltx_p" id="A2.F11.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11">
            <span class="ltx_text ltx_font_bold" id="A2.F11.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.1">
             Agent
            </span>
            :
            <math alttext="&lt;" class="ltx_Math" display="inline" id="A2.F11.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1">
             <semantics id="A2.F11.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1a">
              <mo id="A2.F11.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1.1" xref="A2.F11.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1.1.cmml">
               &lt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1b">
               <lt id="A2.F11.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1.1.cmml" xref="A2.F11.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1.1">
               </lt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A2.F11.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1c">
               &lt;
              </annotation>
             </semantics>
            </math>
            Critic
            <math alttext="&gt;" class="ltx_Math" display="inline" id="A2.F11.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1">
             <semantics id="A2.F11.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1a">
              <mo id="A2.F11.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1.1" xref="A2.F11.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1.1.cmml">
               &gt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1b">
               <gt id="A2.F11.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1.1.cmml" xref="A2.F11.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1.1">
               </gt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A2.F11.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1c">
               &gt;
              </annotation>
             </semantics>
            </math>
           </span>
           <span class="ltx_p" id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.15">
            <span class="ltx_text ltx_font_bold" id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.15.1">
             User
            </span>
            : Now, rewrite the solution in the required format:
           </span>
           <span class="ltx_p" id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13">
            <span class="ltx_text ltx_font_bold" id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1">
             Agent
            </span>
            :
            <math alttext="&lt;" class="ltx_Math" display="inline" id="A2.F11.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1">
             <semantics id="A2.F11.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1a">
              <mo id="A2.F11.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1.1" xref="A2.F11.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1.1.cmml">
               &lt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1b">
               <lt id="A2.F11.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1.1.cmml" xref="A2.F11.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1.1">
               </lt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A2.F11.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1c">
               &lt;
              </annotation>
             </semantics>
            </math>
            Refined Answer
            <math alttext="&gt;" class="ltx_Math" display="inline" id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1">
             <semantics id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1a">
              <mo id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1.1" xref="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1.1.cmml">
               &gt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1b">
               <gt id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1.1.cmml" xref="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1.1">
               </gt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A2.F11.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1c">
               &gt;
              </annotation>
             </semantics>
            </math>
           </span>
          </span>
         </foreignobject>
        </g>
       </g>
      </g>
     </svg>
     <figcaption class="ltx_caption">
      <span class="ltx_tag ltx_tag_figure">
       <span class="ltx_text" id="A2.F11.3.1.1" style="font-size:90%;">
        Figure 11
       </span>
       :
      </span>
      <span class="ltx_text ltx_font_bold" id="A2.F11.4.2" style="font-size:90%;">
       Prompt for Self-Refine
       <span class="ltx_text ltx_font_medium" id="A2.F11.4.2.1">
        : We follow the standard pipeline of the original paper, prompt the LLM to refine and correct its previous mistakes.
       </span>
      </span>
     </figcaption>
    </figure>
    <div class="ltx_para ltx_noindent" id="A2.SS1.p3">
     <p class="ltx_p" id="A2.SS1.p3.1">
      However, our experiments show that without any oracle hint from the environment or human feedback, the self-refine approach leads to a degradation in performance across all models. Only when oracle feedback is available to assist with early termination does the self-refine approach provide a slight performance boost. This highlights the limitation of the self-refine structure in effectively improving model performance without external guidance, which is also observed in
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib22" title="">
        22
       </a>
       ]
      </cite>
      .
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="A2.SS1.p4">
     <p class="ltx_p" id="A2.SS1.p4.1">
      In contrast, the model trained with RISE can attain consistent performance improvements without relying on an oracle. By training the model to iteratively refine its responses, our method enables the model to self-correct and improve its performance over multiple turns. This showcases the effectiveness of our approach in comparison to the self-refine baseline, as it allows for more robust and consistent performance gains without the need for the oracle assistance.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="A2.SS1.p5">
     <p class="ltx_p" id="A2.SS1.p5.1">
      <span class="ltx_text ltx_font_bold" id="A2.SS1.p5.1.1">
       Comparison with GLoRE
       <cite class="ltx_cite ltx_citemacro_citep">
        [
        <a class="ltx_ref" href="#bib.bib17" title="">
         17
        </a>
        ]
       </cite>
       .
      </span>
      GLoRE is a multi-model system that relies on a student model to propose drafts, an Outcome-based Reward Model (ORM) or Step-wise ORM to locate errors at different granularity levels, and a Global or Local Refinement Model for adjusting these errors. Since no code was openly available for this approach, in our experiments, we compared to the numbers from the main paper
      <cite class="ltx_cite ltx_citemacro_citet">
       Havrilla et al. [
       <a class="ltx_ref" href="#bib.bib17" title="">
        17
       </a>
       ]
      </cite>
      . While the comparison against GLoRE is already apples-to-oranges since our method only trains a single end-to-end model, while GLoRE trains multiple models. Performance-wise, GLoRE’s global and local refinement models show little to no improvement in overall accuracy without an oracle, and even exhibit decreasing accuracy in some cases. However, when an oracle is used to guide the refinement process, GLoRE demonstrates a 10% improvement on the 7B model in the GSM8K dataset.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="A2.SS1.p6">
     <p class="ltx_p" id="A2.SS1.p6.1">
      As anticipated, since we run RISE from a less advanced base model (Llama2 7B), we observe a slightly lower absolute performance compared to GLoRE. However, RISE demonstrates its effectiveness in self-improvement by sequentially enhancing its performance by an impressive 13.4% within just 3 turns without an oracle feedback, and by a remarkable 23.4% with an oracle on GSM8K. This showcase of RISE’s capabilities is particularly noteworthy considering that GLoRE utilizes 3 independent models - one for generating candidate solutions, one reward model for locating errors, and one refinement model for refinement.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="A2.SS1.p7">
     <p class="ltx_p" id="A2.SS1.p7.1">
      <span class="ltx_text ltx_font_bold" id="A2.SS1.p7.1.1">
       Comparison with V-STaR
       <cite class="ltx_cite ltx_citemacro_citep">
        [
        <a class="ltx_ref" href="#bib.bib19" title="">
         19
        </a>
        ]
       </cite>
       .
      </span>
      V-STaR requires training an additional verifier model to rank candidate answers generated by the targeted model, but it does not make any sequential revisions or improvements to a response. While comparing RISE to using a verifier for re-ranking the top 5 responses at the first turn (as a base comparison) would have been informative, we were unable to find this specific result in the original V-STaR paper. The results presented in the official table
      <a class="ltx_ref" href="#A2.T6" title="Table 6 ‣ B.1 Complete Comparisons and Discussion: Extended Version of Table 1 ‣ Appendix B Additional Results ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        6
       </span>
      </a>
      for V-STaR correspond to running 64 samples, which improves the base model’s performance by 35.2% for each prompt during evaluation. In contrast, our method, RISE, after the same amount of finetuning iterations (3 iterations) and using only 5 samples, improves upon the base model by 44.5% (calculated as 55.0% - 10.5% = 44.5%). This comparison highlights RISE’s efficiency in achieving significant improvements with fewer samples and iterations compared to V-STaR’s approach of using a large number of samples without sequential refinement.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="A2.SS1.p8">
     <p class="ltx_p" id="A2.SS1.p8.1">
      Moreover, V-STaR’s performance is inherently bounded by the candidate generator’s performance. As discussed in Section 5, if there is no correct response among the generated candidates, the problem remains unsolved. In contrast, we show in Figure
      <a class="ltx_ref" href="#S5.F6" title="Figure 6 ‣ 5 When and Why is Self-Improvement Over Turns Possible? ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        6
       </span>
      </a>
      that RISE can also solve problems that were not solved by majority voting with a much higher budget in the first turn. Furthermore, we believe that combining V-STaR with RISE could lead to even better performance, as RISE can generate better models and a verifier can be complementarily used for filtering.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="A2.SS1.p9">
     <p class="ltx_p" id="A2.SS1.p9.1">
      <span class="ltx_text ltx_font_bold" id="A2.SS1.p9.1.1">
       Comparison with other base models.
      </span>
      Mistral-7B
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib23" title="">
        23
       </a>
       ]
      </cite>
      and Eurus-7B-SFT
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib58" title="">
        58
       </a>
       ]
      </cite>
      are models that exhibit comparable performance to our method in terms of the absolute maj@5 performance. However, it is crucial to note that these base models are fine-tuned using a vast amount of data, including data specifically tuned for math reasoning performance
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib58" title="">
        58
       </a>
       ]
      </cite>
      , while our model is fine-tuned on a single domain. That said, we do show that fine-tuning with RISE can still enhance the performance of Mistral-7B models.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="A2.SS1.p10">
     <p class="ltx_p" id="A2.SS1.p10.1">
      <span class="ltx_text ltx_font_bold" id="A2.SS1.p10.1.1">
       To summarize,
      </span>
      our method offers several advantages over GLoRE and V-STaR, such as end-to-end error correction with a single model, superior performance with fewer samples, and the ability to solve problems that cannot be solved by random sampling in the first turn. Although our maj@1 performance is lower than GLoRE’s base model EI, which is an apples-to-oranges comparison our ultimate 5-turn performance surpasses their best absolute performance in both oracle and non-oracle scenarios.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="A2.SS1.p11">
     <p class="ltx_p" id="A2.SS1.p11.1">
      Compared to other base models like Mistral-7B and Eurus-7B-SFT, our method achieves comparable performance while being fine-tuned on a single domain, and it can be generalized to better base models.
     </p>
    </div>
   </section>
   <section class="ltx_subsection" id="A2.SS2">
    <h4 class="ltx_title ltx_title_subsection">
     <span class="ltx_tag ltx_tag_subsection">
      B.2
     </span>
     Qualitative Examples from RISE
    </h4>
    <div class="ltx_para ltx_noindent" id="A2.SS2.p1">
     <p class="ltx_p" id="A2.SS2.p1.1">
      In this section, we provide some qualitative examples showing the nature of edits made by RISE on various datasets that we train on. We utilize the model from iteration 2 of RISE.
     </p>
    </div>
    <figure class="ltx_figure" id="A2.F12">
     <div class="ltx_flex_figure">
      <div class="ltx_flex_cell ltx_flex_size_1">
       <svg class="ltx_picture ltx_figure_panel" height="45341.08" id="A2.F12.pic1" overflow="visible" version="1.1" width="45341.08">
        <g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,45341.08) matrix(1 0 0 -1 0 0) translate(22670.54,0) translate(0,22670.54)">
         <clippath id="pgfcp2">
          <path d="M -22670.54 -22670.54 L 22670.54 -22670.54 L 22670.54 22670.54 L -22670.54 22670.54 Z M 0 5.91 L 0 233.66 C 0 236.92 2.64 239.57 5.91 239.57 L 594.09 239.57 C 597.36 239.57 600 236.92 600 233.66 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z">
          </path>
         </clippath>
         <g fill-rule="evenodd">
          <g fill="#0000BF" fill-opacity="1.0">
           <path d="M 0 5.91 L 0 233.66 C 0 236.92 2.64 239.57 5.91 239.57 L 594.09 239.57 C 597.36 239.57 600 236.92 600 233.66 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z M 1.97 5.91 L 1.97 207.96 L 598.03 207.96 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
           </path>
          </g>
          <g fill="#FFFFFF" fill-opacity="1.0">
           <path d="M 1.97 5.91 L 1.97 207.96 L 598.03 207.96 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
           </path>
          </g>
          <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 216.84)">
           <foreignobject color="#FFFFFF" height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
            <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.F12.pic1.3.3.3.3.1.1" style="width:410.8pt;">
             <span class="ltx_p" id="A2.F12.pic1.3.3.3.3.1.1.1">
              <span class="ltx_text ltx_font_bold" id="A2.F12.pic1.3.3.3.3.1.1.1.1">
               RISE Example (Small Edits)
              </span>
             </span>
            </span>
           </foreignobject>
          </g>
          <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 15.81)">
           <foreignobject color="#000000" height="178.31" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
            <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2" style="width:410.8pt;">
             <span class="ltx_p" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.3">
              <span class="ltx_text ltx_font_bold" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.3.1">
               Query
              </span>
              :
Mike plays ping pong for 40 minutes. In the first 20 minutes, he scores 4 points. In the second 20 minutes, he scores 25% more points. How many total points did he score?
             </span>
             <span class="ltx_p" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.4">
              <span class="ltx_text ltx_font_bold" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.4.1">
               Turn-1 Response
              </span>
              :
             </span>
             <span class="ltx_p" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.5">
              Step 1: In the first 20 minutes, Mike scores 4 points.
             </span>
             <span class="ltx_p" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.6">
              Step 2: In the second 20 minutes, Mike scores 25% more points than he did in the first 20 minutes.
              <span class="ltx_text" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.6.1" style="background-color:#FFB3B3;">
               So, Mike scores 4 + 4 = 8 points in the second 20 minutes.
              </span>
             </span>
             <span class="ltx_p" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.7">
              Step 3: To find the total points, we need to add the points scored in the first and second 20 minutes. total_points = 4 + 8 = 12.
             </span>
             <span class="ltx_p" id="A2.F12.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
              Answer:
              <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F12.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1">
               <semantics id="A2.F12.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a">
                <mn id="A2.F12.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="A2.F12.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
                 12
                </mn>
                <annotation-xml encoding="MathML-Content" id="A2.F12.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b">
                 <cn id="A2.F12.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="integer" xref="A2.F12.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
                  12
                 </cn>
                </annotation-xml>
               </semantics>
              </math>
              ✗
             </span>
             <span class="ltx_p" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.8">
              <span class="ltx_text ltx_font_bold" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.8.1">
               Turn-2 Response
              </span>
              :
             </span>
             <span class="ltx_p" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.9">
              I apologize for the mistake. Let’s solve the problem step by step.
             </span>
             <span class="ltx_p" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.10">
              Step 1: In the first 20 minutes, Mike scores 4 points.
             </span>
             <span class="ltx_p" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.11">
              Step 2: In the second 20 minutes, Mike scores 25% more points than he did in the first 20 minutes.
              <span class="ltx_text" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.11.1" style="background-color:#B3FFB3;">
               This means he scores 4 + 4 * 25% = 4 + 1 = 5 points in the second 20 minutes.
              </span>
             </span>
             <span class="ltx_p" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.12">
              Step 3: To find the total points, we add the points scored in the first and second 20 minutes: 4 + 5 = 9 points.
             </span>
             <span class="ltx_p" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2">
              Answer:
              <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1">
               <semantics id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1a">
                <mn id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1" xref="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.cmml">
                 9
                </mn>
                <annotation-xml encoding="MathML-Content" id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1b">
                 <cn id="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.cmml" type="integer" xref="A2.F12.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1">
                  9
                 </cn>
                </annotation-xml>
               </semantics>
              </math>
              ✓
             </span>
            </span>
           </foreignobject>
          </g>
         </g>
        </g>
       </svg>
      </div>
      <div class="ltx_flex_break">
      </div>
      <div class="ltx_flex_cell ltx_flex_size_1">
       <svg class="ltx_picture ltx_figure_panel" height="45341.08" id="A2.F12.pic2" overflow="visible" version="1.1" width="45341.08">
        <g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,45341.08) matrix(1 0 0 -1 0 0) translate(22670.54,0) translate(0,22670.54)">
         <clippath id="pgfcp3">
          <path d="M -22670.54 -22670.54 L 22670.54 -22670.54 L 22670.54 22670.54 L -22670.54 22670.54 Z M 0 5.91 L 0 261.26 C 0 264.52 2.64 267.16 5.91 267.16 L 594.09 267.16 C 597.36 267.16 600 264.52 600 261.26 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z">
          </path>
         </clippath>
         <g fill-rule="evenodd">
          <g fill="#0000BF" fill-opacity="1.0">
           <path d="M 0 5.91 L 0 261.26 C 0 264.52 2.64 267.16 5.91 267.16 L 594.09 267.16 C 597.36 267.16 600 264.52 600 261.26 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z M 1.97 5.91 L 1.97 235.55 L 598.03 235.55 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
           </path>
          </g>
          <g fill="#FFFFFF" fill-opacity="1.0">
           <path d="M 1.97 5.91 L 1.97 235.55 L 598.03 235.55 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
           </path>
          </g>
          <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 244.44)">
           <foreignobject color="#FFFFFF" height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
            <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.F12.pic2.3.3.3.3.1.1" style="width:410.8pt;">
             <span class="ltx_p" id="A2.F12.pic2.3.3.3.3.1.1.1">
              <span class="ltx_text ltx_font_bold" id="A2.F12.pic2.3.3.3.3.1.1.1.1">
               RISE Example (Big Edits)
              </span>
             </span>
            </span>
           </foreignobject>
          </g>
          <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 15.81)">
           <foreignobject color="#000000" height="205.91" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
            <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2" style="width:410.8pt;">
             <span class="ltx_p" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.3">
              <span class="ltx_text ltx_font_bold" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.3.1">
               Query
              </span>
              : In a candy machine, there are 22 more than four times the number of pink gumballs as there are blue gumballs. If there are 12 blue gumballs how many pink ones are there?
             </span>
             <span class="ltx_p" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.4">
              <span class="ltx_text ltx_font_bold" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.4.1">
               Turn-1 Response
              </span>
              :
             </span>
             <span class="ltx_p" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.5">
              Step 1: Let’s assume the number of blue gumballs as x. Step 2: According to the given information, there are 22 more than four times the number of pink gumballs as there are blue gumballs. So, the number of pink gumballs can be expressed as 4x + 22.
              <span class="ltx_text" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.5.1" style="background-color:#FFB3B3;">
               Step 3: We are given that there are 12 blue gumballs, so let’s substitute x with 12 in the equation.
              </span>
             </span>
             <span class="ltx_p" id="A2.F12.pic2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
              Answer:
              <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F12.pic2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1">
               <semantics id="A2.F12.pic2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a">
                <mn id="A2.F12.pic2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="A2.F12.pic2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
                 54
                </mn>
                <annotation-xml encoding="MathML-Content" id="A2.F12.pic2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b">
                 <cn id="A2.F12.pic2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="integer" xref="A2.F12.pic2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
                  54
                 </cn>
                </annotation-xml>
               </semantics>
              </math>
              ✗
             </span>
             <span class="ltx_p" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.6">
              <span class="ltx_text ltx_font_bold" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.6.1">
               Turn-2 Response
              </span>
              :
             </span>
             <span class="ltx_p" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.7">
              Let’s solve the problem step by step: Step 1: Let’s denote the number of blue gumballs as x. Step 2: We are given that the number of pink gumballs is 22 more than four times the number of blue gumballs. So, the number of pink gumballs can be expressed as 4x + 22.
              <span class="ltx_text" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.7.1" style="background-color:#B3FFB3;">
               Step 3: We are also given that there are 12 blue gumballs, so we can substitute x = 12 into the expression for the number of pink gumballs: 4 * 12 + 22 = 48 + 22 = 70 Therefore, there are
               <br class="ltx_break"/>
               boxed70 pink gumballs.
              </span>
             </span>
             <span class="ltx_p" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2">
              Answer:
              <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1">
               <semantics id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1a">
                <mn id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1" xref="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.cmml">
                 70
                </mn>
                <annotation-xml encoding="MathML-Content" id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1b">
                 <cn id="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.cmml" type="integer" xref="A2.F12.pic2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1">
                  70
                 </cn>
                </annotation-xml>
               </semantics>
              </math>
              ✓
             </span>
            </span>
           </foreignobject>
          </g>
         </g>
        </g>
       </svg>
      </div>
     </div>
     <figcaption class="ltx_caption">
      <span class="ltx_tag ltx_tag_figure">
       <span class="ltx_text" id="A2.F12.3.1.1" style="font-size:90%;">
        Figure 12
       </span>
       :
      </span>
      <span class="ltx_text" id="A2.F12.4.2" style="font-size:80%;">
       Examples of RISE correct its previous behavior in different modes. Some only make changes to a small part (small edits), some may directly rewrite most of its previous answers (big edits) because the first step in the previous answer is wrong. The mistaken steps of different turns are highlighted in
       <span class="ltx_text" id="A2.F12.4.2.1" style="background-color:#FFB3B3;">
        red
       </span>
       ,
and the correct are highlighted in
       <span class="ltx_text" id="A2.F12.4.2.2" style="background-color:#B3FFB3;">
        green
       </span>
       .
This demonstrates shows how RISE can correct its previous answers and finally get to a correct answer.
      </span>
     </figcaption>
    </figure>
    <figure class="ltx_figure" id="A2.F13">
     <svg class="ltx_picture ltx_centering" height="45341.08" id="A2.F13.pic1" overflow="visible" version="1.1" width="45341.08">
      <g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,45341.08) matrix(1 0 0 -1 0 0) translate(22670.54,0) translate(0,22670.54)">
       <clippath id="pgfcp4">
        <path d="M -22670.54 -22670.54 L 22670.54 -22670.54 L 22670.54 22670.54 L -22670.54 22670.54 Z M 0 5.91 L 0 437.25 C 0 440.51 2.64 443.15 5.91 443.15 L 594.09 443.15 C 597.36 443.15 600 440.51 600 437.25 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z">
        </path>
       </clippath>
       <g fill-rule="evenodd">
        <g fill="#0000BF" fill-opacity="1.0">
         <path d="M 0 5.91 L 0 437.25 C 0 440.51 2.64 443.15 5.91 443.15 L 594.09 443.15 C 597.36 443.15 600 440.51 600 437.25 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z M 1.97 5.91 L 1.97 411.54 L 598.03 411.54 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
         </path>
        </g>
        <g fill="#FFFFFF" fill-opacity="1.0">
         <path d="M 1.97 5.91 L 1.97 411.54 L 598.03 411.54 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
         </path>
        </g>
        <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 420.43)">
         <foreignobject color="#FFFFFF" height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
          <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.F13.pic1.6.6.6.6.1.1" style="width:410.8pt;">
           <span class="ltx_p" id="A2.F13.pic1.6.6.6.6.1.1.1">
            <span class="ltx_text ltx_font_bold" id="A2.F13.pic1.6.6.6.6.1.1.1.1">
             RISE Example (Noise Tolerance)
            </span>
           </span>
          </span>
         </foreignobject>
        </g>
        <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 15.81)">
         <foreignobject color="#000000" height="381.9" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
          <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5" style="width:410.8pt;">
           <span class="ltx_p" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.6">
            <span class="ltx_text ltx_font_bold" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.6.1" style="font-size:80%;">
             Query
             <span class="ltx_text ltx_font_medium" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.6.1.1">
              : Ryan plants 2 flowers a day in his garden. After 15 days, how many flowers does he have if 5 did not grow?
              <br class="ltx_break"/>
             </span>
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.7">
            <span class="ltx_text ltx_font_bold" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.7.1" style="font-size:80%;">
             Turn-1 Response
             <span class="ltx_text ltx_font_medium" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.7.1.1">
              :
             </span>
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.8">
            <span class="ltx_text" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.8.1" style="font-size:80%;">
             Step 1: Ryan plants 2 flowers a day for 15 days, so he plants a total of 2 flowers/day * 15 days = 30 flowers in his garden. Step 2: However, 5 flowers did not grow, so we need to subtract these non-growing flowers from the total count. Step 3: Calculate the number of flowers that actually grew in Ryan’s garden. flowers_grew = 30 flowers - 5 flowers = 25 flowers.
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
            <span class="ltx_text" id="A2.F13.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" style="font-size:80%;">
             Answer:
             <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F13.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1">
              <semantics id="A2.F13.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a">
               <mn id="A2.F13.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="A2.F13.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
                25
               </mn>
               <annotation-xml encoding="MathML-Content" id="A2.F13.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b">
                <cn id="A2.F13.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="integer" xref="A2.F13.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
                 25
                </cn>
               </annotation-xml>
              </semantics>
             </math>
             ✓
             <br class="ltx_break"/>
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.9">
            <span class="ltx_text ltx_font_bold" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.9.1" style="font-size:80%;">
             Turn-2 Response
             <span class="ltx_text ltx_font_medium" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.9.1.1">
              :
             </span>
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.10">
            <span class="ltx_text" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.10.1" style="font-size:80%;">
             Apologies for the mistake. Let’s correct the solution. Step 1: In 15 days, Ryan plants 2 flowers a day, so he plants a total of 2 flowers/day * 15 days = 30 flowers in his garden. Step 2: Since 5 flowers did not grow, we need to subtract these non-growing flowers from the total count. Step 3: Calculate the number of flowers that actually grew in Ryan’s garden. flowers_grew = 30 flowers - 5 flowers = 25 flowers.
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2">
            <span class="ltx_text" id="A2.F13.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1" style="font-size:80%;">
             Answer:
             <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F13.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1">
              <semantics id="A2.F13.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1a">
               <mn id="A2.F13.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1.1" xref="A2.F13.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1.1.cmml">
                25
               </mn>
               <annotation-xml encoding="MathML-Content" id="A2.F13.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1b">
                <cn id="A2.F13.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1.1.cmml" type="integer" xref="A2.F13.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1.1">
                 25
                </cn>
               </annotation-xml>
              </semantics>
             </math>
             ✓
             <br class="ltx_break"/>
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.11">
            <span class="ltx_text ltx_font_bold" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.11.1" style="font-size:80%;">
             Turn-3 Response
             <span class="ltx_text ltx_font_medium" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.11.1.1">
              :
             </span>
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.12">
            <span class="ltx_text" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.12.1" style="font-size:80%;">
             Let’s reevaluate the solution. Step 1: Ryan plants 2 flowers a day for 15 days, so he plants a total of 2 flowers/day * 15 days = 30 flowers in his garden. Step 2: However, 5 flowers did not grow, so we need to add these flowers to the total count, as they were planted but did not grow.
             <span class="ltx_text" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.12.1.1" style="background-color:#FFB3B3;">
              Step 3: Calculate the total number of flowers in Ryan’s garden. total_flowers = 30 flowers + 5 flowers = 35 flowers
             </span>
             .
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3">
            <span class="ltx_text" id="A2.F13.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1" style="font-size:80%;">
             Answer:
             <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F13.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.1">
              <semantics id="A2.F13.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.1a">
               <mn id="A2.F13.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.1.1" xref="A2.F13.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.1.1.cmml">
                35
               </mn>
               <annotation-xml encoding="MathML-Content" id="A2.F13.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.1b">
                <cn id="A2.F13.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.1.1.cmml" type="integer" xref="A2.F13.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.1.1">
                 35
                </cn>
               </annotation-xml>
              </semantics>
             </math>
             ✗
             <br class="ltx_break"/>
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.13">
            <span class="ltx_text ltx_font_bold" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.13.1" style="font-size:80%;">
             Turn-4 Response
             <span class="ltx_text ltx_font_medium" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.13.1.1">
             </span>
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.14">
            <span class="ltx_text" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.14.1" style="font-size:80%;">
             Let’s correct the solution. Step 1: In 15 days, Ryan plants 2 flowers a day, so he plants a total of 2 flowers/day * 15 days = 30 flowers in his garden. Step 2: Since 5 flowers did not grow, we need to subtract these non-growing flowers from the total count. Step 3: Calculate the total number of flowers in Ryan’s garden after subtracting the non-growing flowers. total_flowers = total_planted_flowers - non_growing_flowers = 30 flowers - 5 flowers=
             <br class="ltx_break"/>
             boxed25 flowers.
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4">
            <span class="ltx_text" id="A2.F13.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1" style="font-size:80%;">
             Answer:
             <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F13.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1">
              <semantics id="A2.F13.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1a">
               <mn id="A2.F13.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1" xref="A2.F13.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.cmml">
                25
               </mn>
               <annotation-xml encoding="MathML-Content" id="A2.F13.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1b">
                <cn id="A2.F13.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.cmml" type="integer" xref="A2.F13.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1">
                 25
                </cn>
               </annotation-xml>
              </semantics>
             </math>
             ✓
             <br class="ltx_break"/>
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.15">
            <span class="ltx_text ltx_font_bold" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.15.1" style="font-size:80%;">
             Turn-5 Response
             <span class="ltx_text ltx_font_medium" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.15.1.1">
             </span>
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.16">
            <span class="ltx_text" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.16.1" style="font-size:80%;">
             Let’s reevaluate the solution. Step 1: In 15 days, Ryan plants 2 flowers a day, which is 2 flowers/day * 15 days = 30 flowers in total. Step 2: However, 5 flowers did not grow, so we have to subtract these 5 flowers from the total. Step 3: Therefore, the total number of flowers Ryan has is 30 flowers (total planted) - 5 flowers (did not grow) =
             <br class="ltx_break"/>
             boxed25 flowers.
            </span>
           </span>
           <span class="ltx_p" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5">
            <span class="ltx_text" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1" style="font-size:80%;">
             Answer:
             <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1">
              <semantics id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1a">
               <mn id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1" xref="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1.cmml">
                25
               </mn>
               <annotation-xml encoding="MathML-Content" id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1b">
                <cn id="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1.cmml" type="integer" xref="A2.F13.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1">
                 25
                </cn>
               </annotation-xml>
              </semantics>
             </math>
             ✓
             <br class="ltx_break"/>
            </span>
           </span>
          </span>
         </foreignobject>
        </g>
       </g>
      </g>
     </svg>
     <figcaption class="ltx_caption ltx_centering">
      <span class="ltx_tag ltx_tag_figure">
       <span class="ltx_text" id="A2.F13.6.3.1" style="font-size:90%;">
        Figure 13
       </span>
       :
      </span>
      <span class="ltx_text" id="A2.F13.4.2" style="font-size:80%;">
       Examples of RISE’s
       <span class="ltx_text ltx_font_bold" id="A2.F13.4.2.1">
        tolerance of noisy feedback
       </span>
       . In the evaluation where there is no oracle, we use a verifier that always tells the model, "The answer is incorrect. Please try again. Here’s the question:
       <math alttext="&lt;" class="ltx_Math" display="inline" id="A2.F13.3.1.m1.1">
        <semantics id="A2.F13.3.1.m1.1b">
         <mo id="A2.F13.3.1.m1.1.1" xref="A2.F13.3.1.m1.1.1.cmml">
          &lt;
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.F13.3.1.m1.1c">
          <lt id="A2.F13.3.1.m1.1.1.cmml" xref="A2.F13.3.1.m1.1.1">
          </lt>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.F13.3.1.m1.1d">
          &lt;
         </annotation>
        </semantics>
       </math>
       Query
       <math alttext="&gt;" class="ltx_Math" display="inline" id="A2.F13.4.2.m2.1">
        <semantics id="A2.F13.4.2.m2.1b">
         <mo id="A2.F13.4.2.m2.1.1" xref="A2.F13.4.2.m2.1.1.cmml">
          &gt;
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.F13.4.2.m2.1c">
          <gt id="A2.F13.4.2.m2.1.1.cmml" xref="A2.F13.4.2.m2.1.1">
          </gt>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.F13.4.2.m2.1d">
          &gt;
         </annotation>
        </semantics>
       </math>
       ". We observe that from turn 2 to turn 5, the model is still able to output the correct answer in 3 out of 4 turns. In the response at turn 4, the model performs half of the solution correctly, and only the last step is wrong. In addition, in the turns where the model still outputs the correct answer, it doesn’t directly copy the answer from the previous turn but instead comes up with a new paraphrase. This demonstrates that RISE provides the model with tolerance to noisy feedback and does not randomly change its behavior upon receiving a revisiting request. The mistaken steps of different turns are highlighted in
       <span class="ltx_text" id="A2.F13.4.2.2" style="background-color:#FFB3B3;">
        red
       </span>
      </span>
     </figcaption>
    </figure>
    <figure class="ltx_figure" id="A2.F14">
     <svg class="ltx_picture ltx_centering" height="45341.08" id="A2.F14.pic1" overflow="visible" version="1.1" width="45341.08">
      <g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,45341.08) matrix(1 0 0 -1 0 0) translate(22670.54,0) translate(0,22670.54)">
       <clippath id="pgfcp5">
        <path d="M -22670.54 -22670.54 L 22670.54 -22670.54 L 22670.54 22670.54 L -22670.54 22670.54 Z M 0 5.91 L 0 546.87 C 0 550.13 2.64 552.77 5.91 552.77 L 594.09 552.77 C 597.36 552.77 600 550.13 600 546.87 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z">
        </path>
       </clippath>
       <g fill-rule="evenodd">
        <g fill="#0000BF" fill-opacity="1.0">
         <path d="M 0 5.91 L 0 546.87 C 0 550.13 2.64 552.77 5.91 552.77 L 594.09 552.77 C 597.36 552.77 600 550.13 600 546.87 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z M 1.97 5.91 L 1.97 521.16 L 598.03 521.16 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
         </path>
        </g>
        <g fill="#FFFFFF" fill-opacity="1.0">
         <path d="M 1.97 5.91 L 1.97 521.16 L 598.03 521.16 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
         </path>
        </g>
        <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 530.05)">
         <foreignobject color="#FFFFFF" height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
          <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.F14.pic1.6.6.6.6.1.1" style="width:410.8pt;">
           <span class="ltx_p" id="A2.F14.pic1.6.6.6.6.1.1.1">
            <span class="ltx_text ltx_font_bold" id="A2.F14.pic1.6.6.6.6.1.1.1.1">
             RISE Example (Error Localization)
            </span>
           </span>
          </span>
         </foreignobject>
        </g>
        <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 15.81)">
         <foreignobject color="#000000" height="491.52" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
          <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5" style="width:410.8pt;">
           <span class="ltx_p" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.6">
            <span class="ltx_text ltx_font_bold" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.6.1" style="font-size:80%;">
             Query
             <span class="ltx_text ltx_font_medium" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.6.1.1">
              :
Josh decides to try flipping a house. He buys a house for $80,000 and then puts in $50,000 in repairs. This increased the value of the house by 150%. How much profit did he make?
             </span>
            </span>
           </span>
           <span class="ltx_p" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.7">
            <span class="ltx_text ltx_font_bold" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.7.1" style="font-size:80%;">
             Turn-1 Response
             <span class="ltx_text ltx_font_medium" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.7.1.1">
              :
             </span>
            </span>
           </span>
           <span class="ltx_p" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.8">
            <span class="ltx_text" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.8.1" style="font-size:80%;">
             Step 1: Josh buys a house for $80,000. Step 2: He puts in $50,000 in repairs, which increases the value of the house by 150%. Step 3: To calculate the increase in value, we multiply the cost of the house by 150% and add it to the cost of the house. increase_in_value = $80,000 * 150% = $120,000.
             <span class="ltx_text" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.8.1.1" style="background-color:#FFB3B3;">
              Step 4: To calculate the profit, we subtract the cost of the house from its new value. profit = increase_in_value - $80,000 = $120,000 - $80,000 = $40,000
             </span>
             .
            </span>
           </span>
           <span class="ltx_p" id="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
            <span class="ltx_text" id="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" style="font-size:80%;">
             Answer:
             <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2">
              <semantics id="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2a">
               <mrow id="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2" xref="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.1.cmml">
                <mn id="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
                 40
                </mn>
                <mo id="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.1" xref="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.1.cmml">
                 ,
                </mo>
                <mn id="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2" xref="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.cmml">
                 000
                </mn>
               </mrow>
               <annotation-xml encoding="MathML-Content" id="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2b">
                <list id="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.1.cmml" xref="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2">
                 <cn id="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="integer" xref="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
                  40
                 </cn>
                 <cn id="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.cmml" type="integer" xref="A2.F14.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2">
                  000
                 </cn>
                </list>
               </annotation-xml>
              </semantics>
             </math>
             ✗
             <br class="ltx_break"/>
            </span>
           </span>
           <span class="ltx_p" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.9">
            <span class="ltx_text ltx_font_bold" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.9.1" style="font-size:80%;">
             Turn-2 Response
             <span class="ltx_text ltx_font_medium" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.9.1.1">
              :
             </span>
            </span>
           </span>
           <span class="ltx_p" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.10">
            <span class="ltx_text" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.10.1" style="font-size:80%;">
             Let’s solve the problem step-by-step: Step 1: Josh buys a house for $80,000. Step 2: He puts in $50,000 in repairs, and this increases the value of the house by 150%. Step 3: The percentage increase in value is 150% of $80,000, which is $120,000 (80,000 * 1.5 = $120,000).
             <span class="ltx_text" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.10.1.1" style="background-color:#B3FFB3;">
              Step 4: To find the actual amount that would be added to the house’s value after repairs, we need to subtract the amount he spent on repairs from the increased value, which is $120,000 - $50,000 = $70,000
             </span>
             .
             <span class="ltx_text" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.10.1.2" style="background-color:#FFB3B3;">
              Step 5: The profit Josh would make is the difference between the cost of buying the house and the increased value after repairs, which is $70,000 - $80,000 = -$10,000 ($10,000 less than the initial cost)
             </span>
             .
            </span>
           </span>
           <span class="ltx_p" id="A2.F14.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2">
            <span class="ltx_text" id="A2.F14.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1" style="font-size:80%;">
             Answer:
             <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F14.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1">
              <semantics id="A2.F14.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1a">
               <mn id="A2.F14.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1.1" xref="A2.F14.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1.1.cmml">
                0
               </mn>
               <annotation-xml encoding="MathML-Content" id="A2.F14.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1b">
                <cn id="A2.F14.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1.1.cmml" type="integer" xref="A2.F14.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.m1.1.1">
                 0
                </cn>
               </annotation-xml>
              </semantics>
             </math>
             ✗
             <br class="ltx_break"/>
            </span>
           </span>
           <span class="ltx_p" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.11">
            <span class="ltx_text ltx_font_bold" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.11.1" style="font-size:80%;">
             Turn-3 Response
             <span class="ltx_text ltx_font_medium" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.11.1.1">
              :
Let’s solve the problem step-by-step: Step 1: Josh buys a house for $80,000. Step 2: He puts in $50,000 in repairs. Step 3: This increases the value of the house by 150%. Step 4: To find the increase in value, we calculate 150% of the original price of the house: 150% of $80,000 = $120,000.
              <span class="ltx_text" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.11.1.1.1" style="background-color:#FFB3B3;">
               Step 5: The increase in value after repairs is the original price plus 150% of the original price: $80,000 + $120,000 = $200,000. Step 6: Josh sells the house for $200,000 and made a profit of $200,000 - $80,000 = $120,000.
              </span>
             </span>
            </span>
           </span>
           <span class="ltx_p" id="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3">
            <span class="ltx_text" id="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1" style="font-size:80%;">
             Answer:
             <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2">
              <semantics id="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2a">
               <mrow id="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2.3.2" xref="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2.3.1.cmml">
                <mn id="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.1.1" xref="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.1.1.cmml">
                 120
                </mn>
                <mo id="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2.3.2.1" xref="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2.3.1.cmml">
                 ,
                </mo>
                <mn id="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2.2" xref="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2.2.cmml">
                 000
                </mn>
               </mrow>
               <annotation-xml encoding="MathML-Content" id="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2b">
                <list id="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2.3.1.cmml" xref="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2.3.2">
                 <cn id="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.1.1.cmml" type="integer" xref="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.1.1">
                  120
                 </cn>
                 <cn id="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2.2.cmml" type="integer" xref="A2.F14.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.m1.2.2">
                  000
                 </cn>
                </list>
               </annotation-xml>
              </semantics>
             </math>
             ✗
             <br class="ltx_break"/>
            </span>
           </span>
           <span class="ltx_p" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.12">
            <span class="ltx_text ltx_font_bold" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.12.1" style="font-size:80%;">
             Turn-4 Response
             <span class="ltx_text ltx_font_medium" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.12.1.1">
              :
Let’s solve the problem step-by-step: Step 1: Josh buys a house for $80,000. Step 2: He puts in $50,000 in repairs, increasing the value of the house by 150%. Step 3: The increase in value is 150% of $80,000, which is $120,000 (80,000 * 1.5 = $120,000).
              <span class="ltx_text" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.12.1.1.1" style="background-color:#FFB3B3;">
               Step 4: The total amount spent, including the purchase of the house and the repairs, is $80,000 + $50,000 = $130,000. Step 5: The profit Josh made is the increase in value after repairs minus the total amount spent, which is $120,000 - $130,000 = -$10,000. Therefore, Josh made a
               <br class="ltx_break"/>
               boxed0 profit.
              </span>
             </span>
            </span>
           </span>
           <span class="ltx_p" id="A2.F14.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4">
            <span class="ltx_text" id="A2.F14.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1" style="font-size:80%;">
             Answer:
             <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F14.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1">
              <semantics id="A2.F14.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1a">
               <mn id="A2.F14.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1" xref="A2.F14.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.cmml">
                0
               </mn>
               <annotation-xml encoding="MathML-Content" id="A2.F14.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1b">
                <cn id="A2.F14.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1.cmml" type="integer" xref="A2.F14.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.m1.1.1">
                 0
                </cn>
               </annotation-xml>
              </semantics>
             </math>
             ✗
             <br class="ltx_break"/>
            </span>
           </span>
           <span class="ltx_p" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.13">
            <span class="ltx_text ltx_font_bold" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.13.1" style="font-size:80%;">
             Turn-5 Response
             <span class="ltx_text ltx_font_medium" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.13.1.1">
              :
Let’s solve the problem step-by-step: Step 1: Josh buys a house for $80,000. Step 2: He puts in $50,000 in repairs. Step 3: The repairs increase the value of the house by 150%. Step 4: The increase in value is $50,000, which is 150% of $33,333 (50,000 / 1.5 = $33,333). Step 5: The repairs cost $50,000, and the increase in value is $33,333. Step 6: Therefore, Josh’s profit is $33,333 - $50,000 = -$16,667. Therefore, Josh made a 16676 profit.
             </span>
            </span>
           </span>
           <span class="ltx_p" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5">
            <span class="ltx_text" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1" style="font-size:80%;">
             Answer:
             <math class="ltx_Math ltx_framed ltx_framed_rectangle" display="block" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1">
              <semantics id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1a">
               <mn id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1" xref="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1.cmml">
                16676
               </mn>
               <annotation-xml encoding="MathML-Content" id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1b">
                <cn id="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1.cmml" type="integer" xref="A2.F14.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1">
                 16676
                </cn>
               </annotation-xml>
              </semantics>
             </math>
             ✗
             <br class="ltx_break"/>
            </span>
           </span>
          </span>
         </foreignobject>
        </g>
       </g>
      </g>
     </svg>
     <figcaption class="ltx_caption ltx_centering">
      <span class="ltx_tag ltx_tag_figure">
       <span class="ltx_text" id="A2.F14.3.1.1" style="font-size:90%;">
        Figure 14
       </span>
       :
      </span>
      <span class="ltx_text" id="A2.F14.4.2" style="font-size:80%;">
       Examples of RISE not being able to correct its error within 5 steps but demonstrating meaningful
       <span class="ltx_text ltx_font_bold" id="A2.F14.4.2.1">
        error localization behavior
       </span>
       . Even in turn 2, it has already solved the problem at step 4 but mistakenly takes another step and reaches the wrong answer. The following turns are unable to correct this small error. Though this problem remains unsolved, we observe that (1) the model is able to stick to the correct steps, where all responses reach an intermediate step of 12000 correctly, except for the last response, where the model tries to modify the answer from one step ahead; (2) the model doesn’t repeat its responses, which is a behavior we notice when evaluating some off-the-shelf models; and (3) the model is making meaningful changes to the incorrect steps. In summary, although the final answer is still incorrect, we observe that through RISE, the model is able to locate the error and perform local computation correctly. The mistaken steps of different turns are highlighted in
       <span class="ltx_text" id="A2.F14.4.2.2" style="background-color:#FFB3B3;">
        red
       </span>
       , and the correct steps in turn 2 is highlighted in
       <span class="ltx_text" id="A2.F14.4.2.3" style="background-color:#B3FFB3;">
        green
       </span>
       .
      </span>
     </figcaption>
    </figure>
    <div class="ltx_pagination ltx_role_newpage">
    </div>
   </section>
  </section>
  <section class="ltx_appendix" id="A3">
   <h3 class="ltx_title ltx_title_appendix">
    <span class="ltx_tag ltx_tag_appendix">
     Appendix C
    </span>
    Pseudocode
   </h3>
   <figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_float">
      <span class="ltx_text ltx_font_bold" id="alg1.4.1.1">
       Algorithm 1
      </span>
     </span>
     Data Collection at Iteration
     <math alttext="T" class="ltx_Math" display="inline" id="alg1.2.m1.1">
      <semantics id="alg1.2.m1.1b">
       <mi id="alg1.2.m1.1.1" xref="alg1.2.m1.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="alg1.2.m1.1c">
        <ci id="alg1.2.m1.1.1.cmml" xref="alg1.2.m1.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="alg1.2.m1.1d">
        T
       </annotation>
      </semantics>
     </math>
    </figcaption>
    <div class="ltx_listing ltx_listing" id="alg1.5">
     <div class="ltx_listingline" id="alg1.l1">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">
        1:
       </span>
      </span>
      <math alttext="\mathcal{D}^{\prime}_{T}\leftarrow\mathcal{D}^{\prime}_{T-1}" class="ltx_Math" display="inline" id="alg1.l1.m1.1">
       <semantics id="alg1.l1.m1.1a">
        <mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">
         <msubsup id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">
          <mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1.2.2.2" xref="alg1.l1.m1.1.1.2.2.2.cmml">
           𝒟
          </mi>
          <mi id="alg1.l1.m1.1.1.2.3" xref="alg1.l1.m1.1.1.2.3.cmml">
           T
          </mi>
          <mo id="alg1.l1.m1.1.1.2.2.3" xref="alg1.l1.m1.1.1.2.2.3.cmml">
           ′
          </mo>
         </msubsup>
         <mo id="alg1.l1.m1.1.1.1" stretchy="false" xref="alg1.l1.m1.1.1.1.cmml">
          ←
         </mo>
         <msubsup id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">
          <mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1.3.2.2" xref="alg1.l1.m1.1.1.3.2.2.cmml">
           𝒟
          </mi>
          <mrow id="alg1.l1.m1.1.1.3.3" xref="alg1.l1.m1.1.1.3.3.cmml">
           <mi id="alg1.l1.m1.1.1.3.3.2" xref="alg1.l1.m1.1.1.3.3.2.cmml">
            T
           </mi>
           <mo id="alg1.l1.m1.1.1.3.3.1" xref="alg1.l1.m1.1.1.3.3.1.cmml">
            −
           </mo>
           <mn id="alg1.l1.m1.1.1.3.3.3" xref="alg1.l1.m1.1.1.3.3.3.cmml">
            1
           </mn>
          </mrow>
          <mo id="alg1.l1.m1.1.1.3.2.3" xref="alg1.l1.m1.1.1.3.2.3.cmml">
           ′
          </mo>
         </msubsup>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b">
         <apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">
          <ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">
           ←
          </ci>
          <apply id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">
           <csymbol cd="ambiguous" id="alg1.l1.m1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1.2">
            subscript
           </csymbol>
           <apply id="alg1.l1.m1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.2">
            <csymbol cd="ambiguous" id="alg1.l1.m1.1.1.2.2.1.cmml" xref="alg1.l1.m1.1.1.2">
             superscript
            </csymbol>
            <ci id="alg1.l1.m1.1.1.2.2.2.cmml" xref="alg1.l1.m1.1.1.2.2.2">
             𝒟
            </ci>
            <ci id="alg1.l1.m1.1.1.2.2.3.cmml" xref="alg1.l1.m1.1.1.2.2.3">
             ′
            </ci>
           </apply>
           <ci id="alg1.l1.m1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.2.3">
            𝑇
           </ci>
          </apply>
          <apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">
           <csymbol cd="ambiguous" id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3">
            subscript
           </csymbol>
           <apply id="alg1.l1.m1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.3">
            <csymbol cd="ambiguous" id="alg1.l1.m1.1.1.3.2.1.cmml" xref="alg1.l1.m1.1.1.3">
             superscript
            </csymbol>
            <ci id="alg1.l1.m1.1.1.3.2.2.cmml" xref="alg1.l1.m1.1.1.3.2.2">
             𝒟
            </ci>
            <ci id="alg1.l1.m1.1.1.3.2.3.cmml" xref="alg1.l1.m1.1.1.3.2.3">
             ′
            </ci>
           </apply>
           <apply id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3">
            <minus id="alg1.l1.m1.1.1.3.3.1.cmml" xref="alg1.l1.m1.1.1.3.3.1">
            </minus>
            <ci id="alg1.l1.m1.1.1.3.3.2.cmml" xref="alg1.l1.m1.1.1.3.3.2">
             𝑇
            </ci>
            <cn id="alg1.l1.m1.1.1.3.3.3.cmml" type="integer" xref="alg1.l1.m1.1.1.3.3.3">
             1
            </cn>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l1.m1.1c">
         \mathcal{D}^{\prime}_{T}\leftarrow\mathcal{D}^{\prime}_{T-1}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l2">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">
        2:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l2.2">
       for
      </span>
      index
      <math alttext="i" class="ltx_Math" display="inline" id="alg1.l2.m1.1">
       <semantics id="alg1.l2.m1.1a">
        <mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">
         i
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b">
         <ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">
          𝑖
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m1.1c">
         i
        </annotation>
       </semantics>
      </math>
      in
      <math alttext="\left\{1,\ldots,|\mathcal{D}|\right\}" class="ltx_Math" display="inline" id="alg1.l2.m2.4">
       <semantics id="alg1.l2.m2.4a">
        <mrow id="alg1.l2.m2.4.4.1" xref="alg1.l2.m2.4.4.2.cmml">
         <mo id="alg1.l2.m2.4.4.1.2" xref="alg1.l2.m2.4.4.2.cmml">
          {
         </mo>
         <mn id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">
          1
         </mn>
         <mo id="alg1.l2.m2.4.4.1.3" xref="alg1.l2.m2.4.4.2.cmml">
          ,
         </mo>
         <mi id="alg1.l2.m2.2.2" mathvariant="normal" xref="alg1.l2.m2.2.2.cmml">
          …
         </mi>
         <mo id="alg1.l2.m2.4.4.1.4" xref="alg1.l2.m2.4.4.2.cmml">
          ,
         </mo>
         <mrow id="alg1.l2.m2.4.4.1.1.2" xref="alg1.l2.m2.4.4.1.1.1.cmml">
          <mo id="alg1.l2.m2.4.4.1.1.2.1" stretchy="false" xref="alg1.l2.m2.4.4.1.1.1.1.cmml">
           |
          </mo>
          <mi class="ltx_font_mathcaligraphic" id="alg1.l2.m2.3.3" xref="alg1.l2.m2.3.3.cmml">
           𝒟
          </mi>
          <mo id="alg1.l2.m2.4.4.1.1.2.2" stretchy="false" xref="alg1.l2.m2.4.4.1.1.1.1.cmml">
           |
          </mo>
         </mrow>
         <mo id="alg1.l2.m2.4.4.1.5" xref="alg1.l2.m2.4.4.2.cmml">
          }
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m2.4b">
         <set id="alg1.l2.m2.4.4.2.cmml" xref="alg1.l2.m2.4.4.1">
          <cn id="alg1.l2.m2.1.1.cmml" type="integer" xref="alg1.l2.m2.1.1">
           1
          </cn>
          <ci id="alg1.l2.m2.2.2.cmml" xref="alg1.l2.m2.2.2">
           …
          </ci>
          <apply id="alg1.l2.m2.4.4.1.1.1.cmml" xref="alg1.l2.m2.4.4.1.1.2">
           <abs id="alg1.l2.m2.4.4.1.1.1.1.cmml" xref="alg1.l2.m2.4.4.1.1.2.1">
           </abs>
           <ci id="alg1.l2.m2.3.3.cmml" xref="alg1.l2.m2.3.3">
            𝒟
           </ci>
          </apply>
         </set>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m2.4c">
         \left\{1,\ldots,|\mathcal{D}|\right\}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l2.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l3">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">
        3:
       </span>
      </span>
      <math alttext="\mathbf{s}_{1}\leftarrow\mathbf{x}^{i}" class="ltx_Math" display="inline" id="alg1.l3.m1.1">
       <semantics id="alg1.l3.m1.1a">
        <mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">
         <msub id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">
          <mi id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">
           𝐬
          </mi>
          <mn id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">
           1
          </mn>
         </msub>
         <mo id="alg1.l3.m1.1.1.1" stretchy="false" xref="alg1.l3.m1.1.1.1.cmml">
          ←
         </mo>
         <msup id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">
          <mi id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">
           𝐱
          </mi>
          <mi id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml">
           i
          </mi>
         </msup>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b">
         <apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">
          <ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">
           ←
          </ci>
          <apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">
           <csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2">
            subscript
           </csymbol>
           <ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">
            𝐬
           </ci>
           <cn id="alg1.l3.m1.1.1.2.3.cmml" type="integer" xref="alg1.l3.m1.1.1.2.3">
            1
           </cn>
          </apply>
          <apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">
           <csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3">
            superscript
           </csymbol>
           <ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">
            𝐱
           </ci>
           <ci id="alg1.l3.m1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.3.3">
            𝑖
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l3.m1.1c">
         \mathbf{s}_{1}\leftarrow\mathbf{x}^{i}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l4">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">
        4:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l4.2">
       for
      </span>
      step
      <math alttext="T^{\prime}" class="ltx_Math" display="inline" id="alg1.l4.m1.1">
       <semantics id="alg1.l4.m1.1a">
        <msup id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">
         <mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">
          T
         </mi>
         <mo id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">
          ′
         </mo>
        </msup>
        <annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b">
         <apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">
           superscript
          </csymbol>
          <ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">
           𝑇
          </ci>
          <ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">
           ′
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l4.m1.1c">
         T^{\prime}
        </annotation>
       </semantics>
      </math>
      in
      <math alttext="\left\{1,\ldots,T-1\right\}" class="ltx_Math" display="inline" id="alg1.l4.m2.3">
       <semantics id="alg1.l4.m2.3a">
        <mrow id="alg1.l4.m2.3.3.1" xref="alg1.l4.m2.3.3.2.cmml">
         <mo id="alg1.l4.m2.3.3.1.2" xref="alg1.l4.m2.3.3.2.cmml">
          {
         </mo>
         <mn id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">
          1
         </mn>
         <mo id="alg1.l4.m2.3.3.1.3" xref="alg1.l4.m2.3.3.2.cmml">
          ,
         </mo>
         <mi id="alg1.l4.m2.2.2" mathvariant="normal" xref="alg1.l4.m2.2.2.cmml">
          …
         </mi>
         <mo id="alg1.l4.m2.3.3.1.4" xref="alg1.l4.m2.3.3.2.cmml">
          ,
         </mo>
         <mrow id="alg1.l4.m2.3.3.1.1" xref="alg1.l4.m2.3.3.1.1.cmml">
          <mi id="alg1.l4.m2.3.3.1.1.2" xref="alg1.l4.m2.3.3.1.1.2.cmml">
           T
          </mi>
          <mo id="alg1.l4.m2.3.3.1.1.1" xref="alg1.l4.m2.3.3.1.1.1.cmml">
           −
          </mo>
          <mn id="alg1.l4.m2.3.3.1.1.3" xref="alg1.l4.m2.3.3.1.1.3.cmml">
           1
          </mn>
         </mrow>
         <mo id="alg1.l4.m2.3.3.1.5" xref="alg1.l4.m2.3.3.2.cmml">
          }
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l4.m2.3b">
         <set id="alg1.l4.m2.3.3.2.cmml" xref="alg1.l4.m2.3.3.1">
          <cn id="alg1.l4.m2.1.1.cmml" type="integer" xref="alg1.l4.m2.1.1">
           1
          </cn>
          <ci id="alg1.l4.m2.2.2.cmml" xref="alg1.l4.m2.2.2">
           …
          </ci>
          <apply id="alg1.l4.m2.3.3.1.1.cmml" xref="alg1.l4.m2.3.3.1.1">
           <minus id="alg1.l4.m2.3.3.1.1.1.cmml" xref="alg1.l4.m2.3.3.1.1.1">
           </minus>
           <ci id="alg1.l4.m2.3.3.1.1.2.cmml" xref="alg1.l4.m2.3.3.1.1.2">
            𝑇
           </ci>
           <cn id="alg1.l4.m2.3.3.1.1.3.cmml" type="integer" xref="alg1.l4.m2.3.3.1.1.3">
            1
           </cn>
          </apply>
         </set>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l4.m2.3c">
         \left\{1,\ldots,T-1\right\}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l4.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l5">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">
        5:
       </span>
      </span>
      <math alttext="\mathbf{y}_{T^{\prime}}^{i}\leftarrow\arg\max\pi_{\theta_{T-1}}(\cdot|(\mathbf{s}_{t}^{i},\mathbf{y}_{t}^{i},\mathbf{f}^{i})_{t=1}^{T^{\prime}-1}+\mathbf{s}_{T^{\prime}})" class="ltx_math_unparsed" display="inline" id="alg1.l5.m1.1">
       <semantics id="alg1.l5.m1.1a">
        <mrow id="alg1.l5.m1.1b">
         <msubsup id="alg1.l5.m1.1.1">
          <mi id="alg1.l5.m1.1.1.2.2">
           𝐲
          </mi>
          <msup id="alg1.l5.m1.1.1.2.3">
           <mi id="alg1.l5.m1.1.1.2.3.2">
            T
           </mi>
           <mo id="alg1.l5.m1.1.1.2.3.3">
            ′
           </mo>
          </msup>
          <mi id="alg1.l5.m1.1.1.3">
           i
          </mi>
         </msubsup>
         <mo id="alg1.l5.m1.1.2" stretchy="false">
          ←
         </mo>
         <mi id="alg1.l5.m1.1.3">
          arg
         </mi>
         <mi id="alg1.l5.m1.1.4">
          max
         </mi>
         <msub id="alg1.l5.m1.1.5">
          <mi id="alg1.l5.m1.1.5.2">
           π
          </mi>
          <msub id="alg1.l5.m1.1.5.3">
           <mi id="alg1.l5.m1.1.5.3.2">
            θ
           </mi>
           <mrow id="alg1.l5.m1.1.5.3.3">
            <mi id="alg1.l5.m1.1.5.3.3.2">
             T
            </mi>
            <mo id="alg1.l5.m1.1.5.3.3.1">
             −
            </mo>
            <mn id="alg1.l5.m1.1.5.3.3.3">
             1
            </mn>
           </mrow>
          </msub>
         </msub>
         <mrow id="alg1.l5.m1.1.6">
          <mo id="alg1.l5.m1.1.6.1" stretchy="false">
           (
          </mo>
          <mo id="alg1.l5.m1.1.6.2" lspace="0em" rspace="0em">
           ⋅
          </mo>
          <mo fence="false" id="alg1.l5.m1.1.6.3" rspace="0.167em" stretchy="false">
           |
          </mo>
          <msubsup id="alg1.l5.m1.1.6.4">
           <mrow id="alg1.l5.m1.1.6.4.2.2">
            <mo id="alg1.l5.m1.1.6.4.2.2.1" stretchy="false">
             (
            </mo>
            <msubsup id="alg1.l5.m1.1.6.4.2.2.2">
             <mi id="alg1.l5.m1.1.6.4.2.2.2.2.2">
              𝐬
             </mi>
             <mi id="alg1.l5.m1.1.6.4.2.2.2.2.3">
              t
             </mi>
             <mi id="alg1.l5.m1.1.6.4.2.2.2.3">
              i
             </mi>
            </msubsup>
            <mo id="alg1.l5.m1.1.6.4.2.2.3">
             ,
            </mo>
            <msubsup id="alg1.l5.m1.1.6.4.2.2.4">
             <mi id="alg1.l5.m1.1.6.4.2.2.4.2.2">
              𝐲
             </mi>
             <mi id="alg1.l5.m1.1.6.4.2.2.4.2.3">
              t
             </mi>
             <mi id="alg1.l5.m1.1.6.4.2.2.4.3">
              i
             </mi>
            </msubsup>
            <mo id="alg1.l5.m1.1.6.4.2.2.5">
             ,
            </mo>
            <msup id="alg1.l5.m1.1.6.4.2.2.6">
             <mi id="alg1.l5.m1.1.6.4.2.2.6.2">
              𝐟
             </mi>
             <mi id="alg1.l5.m1.1.6.4.2.2.6.3">
              i
             </mi>
            </msup>
            <mo id="alg1.l5.m1.1.6.4.2.2.7" stretchy="false">
             )
            </mo>
           </mrow>
           <mrow id="alg1.l5.m1.1.6.4.2.3">
            <mi id="alg1.l5.m1.1.6.4.2.3.2">
             t
            </mi>
            <mo id="alg1.l5.m1.1.6.4.2.3.1">
             =
            </mo>
            <mn id="alg1.l5.m1.1.6.4.2.3.3">
             1
            </mn>
           </mrow>
           <mrow id="alg1.l5.m1.1.6.4.3">
            <msup id="alg1.l5.m1.1.6.4.3.2">
             <mi id="alg1.l5.m1.1.6.4.3.2.2">
              T
             </mi>
             <mo id="alg1.l5.m1.1.6.4.3.2.3">
              ′
             </mo>
            </msup>
            <mo id="alg1.l5.m1.1.6.4.3.1">
             −
            </mo>
            <mn id="alg1.l5.m1.1.6.4.3.3">
             1
            </mn>
           </mrow>
          </msubsup>
          <mo id="alg1.l5.m1.1.6.5">
           +
          </mo>
          <msub id="alg1.l5.m1.1.6.6">
           <mi id="alg1.l5.m1.1.6.6.2">
            𝐬
           </mi>
           <msup id="alg1.l5.m1.1.6.6.3">
            <mi id="alg1.l5.m1.1.6.6.3.2">
             T
            </mi>
            <mo id="alg1.l5.m1.1.6.6.3.3">
             ′
            </mo>
           </msup>
          </msub>
          <mo id="alg1.l5.m1.1.6.7" stretchy="false">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex" id="alg1.l5.m1.1c">
         \mathbf{y}_{T^{\prime}}^{i}\leftarrow\arg\max\pi_{\theta_{T-1}}(\cdot|(\mathbf{s}_{t}^{i},\mathbf{y}_{t}^{i},\mathbf{f}^{i})_{t=1}^{T^{\prime}-1}+\mathbf{s}_{T^{\prime}})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l6">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">
        6:
       </span>
      </span>
      <math alttext="\mathbf{s}_{T^{\prime}+1}^{i}" class="ltx_Math" display="inline" id="alg1.l6.m1.1">
       <semantics id="alg1.l6.m1.1a">
        <msubsup id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">
         <mi id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">
          𝐬
         </mi>
         <mrow id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">
          <msup id="alg1.l6.m1.1.1.2.3.2" xref="alg1.l6.m1.1.1.2.3.2.cmml">
           <mi id="alg1.l6.m1.1.1.2.3.2.2" xref="alg1.l6.m1.1.1.2.3.2.2.cmml">
            T
           </mi>
           <mo id="alg1.l6.m1.1.1.2.3.2.3" xref="alg1.l6.m1.1.1.2.3.2.3.cmml">
            ′
           </mo>
          </msup>
          <mo id="alg1.l6.m1.1.1.2.3.1" xref="alg1.l6.m1.1.1.2.3.1.cmml">
           +
          </mo>
          <mn id="alg1.l6.m1.1.1.2.3.3" xref="alg1.l6.m1.1.1.2.3.3.cmml">
           1
          </mn>
         </mrow>
         <mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">
          i
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b">
         <apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">
           superscript
          </csymbol>
          <apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1">
           <csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1">
            subscript
           </csymbol>
           <ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">
            𝐬
           </ci>
           <apply id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">
            <plus id="alg1.l6.m1.1.1.2.3.1.cmml" xref="alg1.l6.m1.1.1.2.3.1">
            </plus>
            <apply id="alg1.l6.m1.1.1.2.3.2.cmml" xref="alg1.l6.m1.1.1.2.3.2">
             <csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.3.2.1.cmml" xref="alg1.l6.m1.1.1.2.3.2">
              superscript
             </csymbol>
             <ci id="alg1.l6.m1.1.1.2.3.2.2.cmml" xref="alg1.l6.m1.1.1.2.3.2.2">
              𝑇
             </ci>
             <ci id="alg1.l6.m1.1.1.2.3.2.3.cmml" xref="alg1.l6.m1.1.1.2.3.2.3">
              ′
             </ci>
            </apply>
            <cn id="alg1.l6.m1.1.1.2.3.3.cmml" type="integer" xref="alg1.l6.m1.1.1.2.3.3">
             1
            </cn>
           </apply>
          </apply>
          <ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">
           𝑖
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l6.m1.1c">
         \mathbf{s}_{T^{\prime}+1}^{i}
        </annotation>
       </semantics>
      </math>
      ,
      <math alttext="\mathbf{r}_{T^{\prime}}^{i}\leftarrow\text{env.step}(\mathbf{s}_{T^{\prime}}^{i},\mathbf{y}_{T^{\prime}}^{i})" class="ltx_Math" display="inline" id="alg1.l6.m2.2">
       <semantics id="alg1.l6.m2.2a">
        <mrow id="alg1.l6.m2.2.2" xref="alg1.l6.m2.2.2.cmml">
         <msubsup id="alg1.l6.m2.2.2.4" xref="alg1.l6.m2.2.2.4.cmml">
          <mi id="alg1.l6.m2.2.2.4.2.2" xref="alg1.l6.m2.2.2.4.2.2.cmml">
           𝐫
          </mi>
          <msup id="alg1.l6.m2.2.2.4.2.3" xref="alg1.l6.m2.2.2.4.2.3.cmml">
           <mi id="alg1.l6.m2.2.2.4.2.3.2" xref="alg1.l6.m2.2.2.4.2.3.2.cmml">
            T
           </mi>
           <mo id="alg1.l6.m2.2.2.4.2.3.3" xref="alg1.l6.m2.2.2.4.2.3.3.cmml">
            ′
           </mo>
          </msup>
          <mi id="alg1.l6.m2.2.2.4.3" xref="alg1.l6.m2.2.2.4.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="alg1.l6.m2.2.2.3" stretchy="false" xref="alg1.l6.m2.2.2.3.cmml">
          ←
         </mo>
         <mrow id="alg1.l6.m2.2.2.2" xref="alg1.l6.m2.2.2.2.cmml">
          <mtext id="alg1.l6.m2.2.2.2.4" xref="alg1.l6.m2.2.2.2.4a.cmml">
           env.step
          </mtext>
          <mo id="alg1.l6.m2.2.2.2.3" lspace="0em" rspace="0em" xref="alg1.l6.m2.2.2.2.3.cmml">
           ​
          </mo>
          <mrow id="alg1.l6.m2.2.2.2.2.2" xref="alg1.l6.m2.2.2.2.2.3.cmml">
           <mo id="alg1.l6.m2.2.2.2.2.2.3" stretchy="false" xref="alg1.l6.m2.2.2.2.2.3.cmml">
            (
           </mo>
           <msubsup id="alg1.l6.m2.1.1.1.1.1.1" xref="alg1.l6.m2.1.1.1.1.1.1.cmml">
            <mi id="alg1.l6.m2.1.1.1.1.1.1.2.2" xref="alg1.l6.m2.1.1.1.1.1.1.2.2.cmml">
             𝐬
            </mi>
            <msup id="alg1.l6.m2.1.1.1.1.1.1.2.3" xref="alg1.l6.m2.1.1.1.1.1.1.2.3.cmml">
             <mi id="alg1.l6.m2.1.1.1.1.1.1.2.3.2" xref="alg1.l6.m2.1.1.1.1.1.1.2.3.2.cmml">
              T
             </mi>
             <mo id="alg1.l6.m2.1.1.1.1.1.1.2.3.3" xref="alg1.l6.m2.1.1.1.1.1.1.2.3.3.cmml">
              ′
             </mo>
            </msup>
            <mi id="alg1.l6.m2.1.1.1.1.1.1.3" xref="alg1.l6.m2.1.1.1.1.1.1.3.cmml">
             i
            </mi>
           </msubsup>
           <mo id="alg1.l6.m2.2.2.2.2.2.4" xref="alg1.l6.m2.2.2.2.2.3.cmml">
            ,
           </mo>
           <msubsup id="alg1.l6.m2.2.2.2.2.2.2" xref="alg1.l6.m2.2.2.2.2.2.2.cmml">
            <mi id="alg1.l6.m2.2.2.2.2.2.2.2.2" xref="alg1.l6.m2.2.2.2.2.2.2.2.2.cmml">
             𝐲
            </mi>
            <msup id="alg1.l6.m2.2.2.2.2.2.2.2.3" xref="alg1.l6.m2.2.2.2.2.2.2.2.3.cmml">
             <mi id="alg1.l6.m2.2.2.2.2.2.2.2.3.2" xref="alg1.l6.m2.2.2.2.2.2.2.2.3.2.cmml">
              T
             </mi>
             <mo id="alg1.l6.m2.2.2.2.2.2.2.2.3.3" xref="alg1.l6.m2.2.2.2.2.2.2.2.3.3.cmml">
              ′
             </mo>
            </msup>
            <mi id="alg1.l6.m2.2.2.2.2.2.2.3" xref="alg1.l6.m2.2.2.2.2.2.2.3.cmml">
             i
            </mi>
           </msubsup>
           <mo id="alg1.l6.m2.2.2.2.2.2.5" stretchy="false" xref="alg1.l6.m2.2.2.2.2.3.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l6.m2.2b">
         <apply id="alg1.l6.m2.2.2.cmml" xref="alg1.l6.m2.2.2">
          <ci id="alg1.l6.m2.2.2.3.cmml" xref="alg1.l6.m2.2.2.3">
           ←
          </ci>
          <apply id="alg1.l6.m2.2.2.4.cmml" xref="alg1.l6.m2.2.2.4">
           <csymbol cd="ambiguous" id="alg1.l6.m2.2.2.4.1.cmml" xref="alg1.l6.m2.2.2.4">
            superscript
           </csymbol>
           <apply id="alg1.l6.m2.2.2.4.2.cmml" xref="alg1.l6.m2.2.2.4">
            <csymbol cd="ambiguous" id="alg1.l6.m2.2.2.4.2.1.cmml" xref="alg1.l6.m2.2.2.4">
             subscript
            </csymbol>
            <ci id="alg1.l6.m2.2.2.4.2.2.cmml" xref="alg1.l6.m2.2.2.4.2.2">
             𝐫
            </ci>
            <apply id="alg1.l6.m2.2.2.4.2.3.cmml" xref="alg1.l6.m2.2.2.4.2.3">
             <csymbol cd="ambiguous" id="alg1.l6.m2.2.2.4.2.3.1.cmml" xref="alg1.l6.m2.2.2.4.2.3">
              superscript
             </csymbol>
             <ci id="alg1.l6.m2.2.2.4.2.3.2.cmml" xref="alg1.l6.m2.2.2.4.2.3.2">
              𝑇
             </ci>
             <ci id="alg1.l6.m2.2.2.4.2.3.3.cmml" xref="alg1.l6.m2.2.2.4.2.3.3">
              ′
             </ci>
            </apply>
           </apply>
           <ci id="alg1.l6.m2.2.2.4.3.cmml" xref="alg1.l6.m2.2.2.4.3">
            𝑖
           </ci>
          </apply>
          <apply id="alg1.l6.m2.2.2.2.cmml" xref="alg1.l6.m2.2.2.2">
           <times id="alg1.l6.m2.2.2.2.3.cmml" xref="alg1.l6.m2.2.2.2.3">
           </times>
           <ci id="alg1.l6.m2.2.2.2.4a.cmml" xref="alg1.l6.m2.2.2.2.4">
            <mtext id="alg1.l6.m2.2.2.2.4.cmml" xref="alg1.l6.m2.2.2.2.4">
             env.step
            </mtext>
           </ci>
           <interval closure="open" id="alg1.l6.m2.2.2.2.2.3.cmml" xref="alg1.l6.m2.2.2.2.2.2">
            <apply id="alg1.l6.m2.1.1.1.1.1.1.cmml" xref="alg1.l6.m2.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m2.1.1.1.1.1.1">
              superscript
             </csymbol>
             <apply id="alg1.l6.m2.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m2.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m2.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="alg1.l6.m2.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.2.2">
               𝐬
              </ci>
              <apply id="alg1.l6.m2.1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.2.3">
               <csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.2.3">
                superscript
               </csymbol>
               <ci id="alg1.l6.m2.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.2.3.2">
                𝑇
               </ci>
               <ci id="alg1.l6.m2.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.2.3.3">
                ′
               </ci>
              </apply>
             </apply>
             <ci id="alg1.l6.m2.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.3">
              𝑖
             </ci>
            </apply>
            <apply id="alg1.l6.m2.2.2.2.2.2.2.cmml" xref="alg1.l6.m2.2.2.2.2.2.2">
             <csymbol cd="ambiguous" id="alg1.l6.m2.2.2.2.2.2.2.1.cmml" xref="alg1.l6.m2.2.2.2.2.2.2">
              superscript
             </csymbol>
             <apply id="alg1.l6.m2.2.2.2.2.2.2.2.cmml" xref="alg1.l6.m2.2.2.2.2.2.2">
              <csymbol cd="ambiguous" id="alg1.l6.m2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l6.m2.2.2.2.2.2.2">
               subscript
              </csymbol>
              <ci id="alg1.l6.m2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l6.m2.2.2.2.2.2.2.2.2">
               𝐲
              </ci>
              <apply id="alg1.l6.m2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l6.m2.2.2.2.2.2.2.2.3">
               <csymbol cd="ambiguous" id="alg1.l6.m2.2.2.2.2.2.2.2.3.1.cmml" xref="alg1.l6.m2.2.2.2.2.2.2.2.3">
                superscript
               </csymbol>
               <ci id="alg1.l6.m2.2.2.2.2.2.2.2.3.2.cmml" xref="alg1.l6.m2.2.2.2.2.2.2.2.3.2">
                𝑇
               </ci>
               <ci id="alg1.l6.m2.2.2.2.2.2.2.2.3.3.cmml" xref="alg1.l6.m2.2.2.2.2.2.2.2.3.3">
                ′
               </ci>
              </apply>
             </apply>
             <ci id="alg1.l6.m2.2.2.2.2.2.2.3.cmml" xref="alg1.l6.m2.2.2.2.2.2.2.3">
              𝑖
             </ci>
            </apply>
           </interval>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l6.m2.2c">
         \mathbf{r}_{T^{\prime}}^{i}\leftarrow\text{env.step}(\mathbf{s}_{T^{\prime}}^{i},\mathbf{y}_{T^{\prime}}^{i})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l7">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">
        7:
       </span>
      </span>
      <math alttext="f_{T^{\prime}}^{i}=\text{retry message}+x^{i}" class="ltx_Math" display="inline" id="alg1.l7.m1.1">
       <semantics id="alg1.l7.m1.1a">
        <mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">
         <msubsup id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">
          <mi id="alg1.l7.m1.1.1.2.2.2" xref="alg1.l7.m1.1.1.2.2.2.cmml">
           f
          </mi>
          <msup id="alg1.l7.m1.1.1.2.2.3" xref="alg1.l7.m1.1.1.2.2.3.cmml">
           <mi id="alg1.l7.m1.1.1.2.2.3.2" xref="alg1.l7.m1.1.1.2.2.3.2.cmml">
            T
           </mi>
           <mo id="alg1.l7.m1.1.1.2.2.3.3" xref="alg1.l7.m1.1.1.2.2.3.3.cmml">
            ′
           </mo>
          </msup>
          <mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">
          =
         </mo>
         <mrow id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">
          <mtext id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2a.cmml">
           retry message
          </mtext>
          <mo id="alg1.l7.m1.1.1.3.1" xref="alg1.l7.m1.1.1.3.1.cmml">
           +
          </mo>
          <msup id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">
           <mi id="alg1.l7.m1.1.1.3.3.2" xref="alg1.l7.m1.1.1.3.3.2.cmml">
            x
           </mi>
           <mi id="alg1.l7.m1.1.1.3.3.3" xref="alg1.l7.m1.1.1.3.3.3.cmml">
            i
           </mi>
          </msup>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b">
         <apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">
          <eq id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">
          </eq>
          <apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">
           <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">
            superscript
           </csymbol>
           <apply id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2">
            <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.2.1.cmml" xref="alg1.l7.m1.1.1.2">
             subscript
            </csymbol>
            <ci id="alg1.l7.m1.1.1.2.2.2.cmml" xref="alg1.l7.m1.1.1.2.2.2">
             𝑓
            </ci>
            <apply id="alg1.l7.m1.1.1.2.2.3.cmml" xref="alg1.l7.m1.1.1.2.2.3">
             <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.2.3.1.cmml" xref="alg1.l7.m1.1.1.2.2.3">
              superscript
             </csymbol>
             <ci id="alg1.l7.m1.1.1.2.2.3.2.cmml" xref="alg1.l7.m1.1.1.2.2.3.2">
              𝑇
             </ci>
             <ci id="alg1.l7.m1.1.1.2.2.3.3.cmml" xref="alg1.l7.m1.1.1.2.2.3.3">
              ′
             </ci>
            </apply>
           </apply>
           <ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">
           <plus id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3.1">
           </plus>
           <ci id="alg1.l7.m1.1.1.3.2a.cmml" xref="alg1.l7.m1.1.1.3.2">
            <mtext id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">
             retry message
            </mtext>
           </ci>
           <apply id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">
            <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.3.1.cmml" xref="alg1.l7.m1.1.1.3.3">
             superscript
            </csymbol>
            <ci id="alg1.l7.m1.1.1.3.3.2.cmml" xref="alg1.l7.m1.1.1.3.3.2">
             𝑥
            </ci>
            <ci id="alg1.l7.m1.1.1.3.3.3.cmml" xref="alg1.l7.m1.1.1.3.3.3">
             𝑖
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l7.m1.1c">
         f_{T^{\prime}}^{i}=\text{retry message}+x^{i}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l8">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">
        8:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l8.2">
       if
      </span>
      <math alttext="r_{T^{\prime}}^{i}=1" class="ltx_Math" display="inline" id="alg1.l8.m1.1">
       <semantics id="alg1.l8.m1.1a">
        <mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">
         <msubsup id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">
          <mi id="alg1.l8.m1.1.1.2.2.2" xref="alg1.l8.m1.1.1.2.2.2.cmml">
           r
          </mi>
          <msup id="alg1.l8.m1.1.1.2.2.3" xref="alg1.l8.m1.1.1.2.2.3.cmml">
           <mi id="alg1.l8.m1.1.1.2.2.3.2" xref="alg1.l8.m1.1.1.2.2.3.2.cmml">
            T
           </mi>
           <mo id="alg1.l8.m1.1.1.2.2.3.3" xref="alg1.l8.m1.1.1.2.2.3.3.cmml">
            ′
           </mo>
          </msup>
          <mi id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">
          =
         </mo>
         <mn id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">
          1
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b">
         <apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">
          <eq id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">
          </eq>
          <apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">
           <csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">
            superscript
           </csymbol>
           <apply id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2">
            <csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.2.1.cmml" xref="alg1.l8.m1.1.1.2">
             subscript
            </csymbol>
            <ci id="alg1.l8.m1.1.1.2.2.2.cmml" xref="alg1.l8.m1.1.1.2.2.2">
             𝑟
            </ci>
            <apply id="alg1.l8.m1.1.1.2.2.3.cmml" xref="alg1.l8.m1.1.1.2.2.3">
             <csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.2.3.1.cmml" xref="alg1.l8.m1.1.1.2.2.3">
              superscript
             </csymbol>
             <ci id="alg1.l8.m1.1.1.2.2.3.2.cmml" xref="alg1.l8.m1.1.1.2.2.3.2">
              𝑇
             </ci>
             <ci id="alg1.l8.m1.1.1.2.2.3.3.cmml" xref="alg1.l8.m1.1.1.2.2.3.3">
              ′
             </ci>
            </apply>
           </apply>
           <ci id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <cn id="alg1.l8.m1.1.1.3.cmml" type="integer" xref="alg1.l8.m1.1.1.3">
           1
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l8.m1.1c">
         r_{T^{\prime}}^{i}=1
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l8.3">
       then
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l9">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">
        9:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l9.2">
       break
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l10">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">
        10:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l10.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l10.3">
       if
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l11">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">
        11:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l11.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l11.3">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l12">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">
        12:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l12.2">
       if
      </span>
      <math alttext="r_{T^{\prime}}^{i}\neq 1" class="ltx_Math" display="inline" id="alg1.l12.m1.1">
       <semantics id="alg1.l12.m1.1a">
        <mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">
         <msubsup id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">
          <mi id="alg1.l12.m1.1.1.2.2.2" xref="alg1.l12.m1.1.1.2.2.2.cmml">
           r
          </mi>
          <msup id="alg1.l12.m1.1.1.2.2.3" xref="alg1.l12.m1.1.1.2.2.3.cmml">
           <mi id="alg1.l12.m1.1.1.2.2.3.2" xref="alg1.l12.m1.1.1.2.2.3.2.cmml">
            T
           </mi>
           <mo id="alg1.l12.m1.1.1.2.2.3.3" xref="alg1.l12.m1.1.1.2.2.3.3.cmml">
            ′
           </mo>
          </msup>
          <mi id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">
          ≠
         </mo>
         <mn id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">
          1
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b">
         <apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">
          <neq id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">
          </neq>
          <apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">
           <csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2">
            superscript
           </csymbol>
           <apply id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2">
            <csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.2.1.cmml" xref="alg1.l12.m1.1.1.2">
             subscript
            </csymbol>
            <ci id="alg1.l12.m1.1.1.2.2.2.cmml" xref="alg1.l12.m1.1.1.2.2.2">
             𝑟
            </ci>
            <apply id="alg1.l12.m1.1.1.2.2.3.cmml" xref="alg1.l12.m1.1.1.2.2.3">
             <csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.2.3.1.cmml" xref="alg1.l12.m1.1.1.2.2.3">
              superscript
             </csymbol>
             <ci id="alg1.l12.m1.1.1.2.2.3.2.cmml" xref="alg1.l12.m1.1.1.2.2.3.2">
              𝑇
             </ci>
             <ci id="alg1.l12.m1.1.1.2.2.3.3.cmml" xref="alg1.l12.m1.1.1.2.2.3.3">
              ′
             </ci>
            </apply>
           </apply>
           <ci id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <cn id="alg1.l12.m1.1.1.3.cmml" type="integer" xref="alg1.l12.m1.1.1.3">
           1
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l12.m1.1c">
         r_{T^{\prime}}^{i}\neq 1
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l12.3">
       then
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l13">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">
        13:
       </span>
      </span>
      <math alttext="T^{\prime}\leftarrow T^{\prime}+1" class="ltx_Math" display="inline" id="alg1.l13.m1.1">
       <semantics id="alg1.l13.m1.1a">
        <mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">
         <msup id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">
          <mi id="alg1.l13.m1.1.1.2.2" xref="alg1.l13.m1.1.1.2.2.cmml">
           T
          </mi>
          <mo id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3.cmml">
           ′
          </mo>
         </msup>
         <mo id="alg1.l13.m1.1.1.1" stretchy="false" xref="alg1.l13.m1.1.1.1.cmml">
          ←
         </mo>
         <mrow id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">
          <msup id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">
           <mi id="alg1.l13.m1.1.1.3.2.2" xref="alg1.l13.m1.1.1.3.2.2.cmml">
            T
           </mi>
           <mo id="alg1.l13.m1.1.1.3.2.3" xref="alg1.l13.m1.1.1.3.2.3.cmml">
            ′
           </mo>
          </msup>
          <mo id="alg1.l13.m1.1.1.3.1" xref="alg1.l13.m1.1.1.3.1.cmml">
           +
          </mo>
          <mn id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">
           1
          </mn>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b">
         <apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">
          <ci id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1">
           ←
          </ci>
          <apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">
           <csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.2">
            superscript
           </csymbol>
           <ci id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2.2">
            𝑇
           </ci>
           <ci id="alg1.l13.m1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.2.3">
            ′
           </ci>
          </apply>
          <apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">
           <plus id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1">
           </plus>
           <apply id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">
            <csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.2.1.cmml" xref="alg1.l13.m1.1.1.3.2">
             superscript
            </csymbol>
            <ci id="alg1.l13.m1.1.1.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.2.2">
             𝑇
            </ci>
            <ci id="alg1.l13.m1.1.1.3.2.3.cmml" xref="alg1.l13.m1.1.1.3.2.3">
             ′
            </ci>
           </apply>
           <cn id="alg1.l13.m1.1.1.3.3.cmml" type="integer" xref="alg1.l13.m1.1.1.3.3">
            1
           </cn>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l13.m1.1c">
         T^{\prime}\leftarrow T^{\prime}+1
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l14">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">
        14:
       </span>
      </span>
      <math alttext="\mathbf{y}_{T^{\prime}}^{i}\leftarrow\arg\max\tilde{\pi}(\cdot|(\mathbf{s}_{t}^{i},\mathbf{y}_{t}^{i},\mathbf{f}^{i})_{t=1}^{T^{\prime}-1}+\mathbf{s}_{T^{\prime}})" class="ltx_math_unparsed" display="inline" id="alg1.l14.m1.1">
       <semantics id="alg1.l14.m1.1a">
        <mrow id="alg1.l14.m1.1b">
         <msubsup id="alg1.l14.m1.1.1">
          <mi id="alg1.l14.m1.1.1.2.2">
           𝐲
          </mi>
          <msup id="alg1.l14.m1.1.1.2.3">
           <mi id="alg1.l14.m1.1.1.2.3.2">
            T
           </mi>
           <mo id="alg1.l14.m1.1.1.2.3.3">
            ′
           </mo>
          </msup>
          <mi id="alg1.l14.m1.1.1.3">
           i
          </mi>
         </msubsup>
         <mo id="alg1.l14.m1.1.2" stretchy="false">
          ←
         </mo>
         <mi id="alg1.l14.m1.1.3">
          arg
         </mi>
         <mi id="alg1.l14.m1.1.4">
          max
         </mi>
         <mover accent="true" id="alg1.l14.m1.1.5">
          <mi id="alg1.l14.m1.1.5.2">
           π
          </mi>
          <mo id="alg1.l14.m1.1.5.1">
           ~
          </mo>
         </mover>
         <mrow id="alg1.l14.m1.1.6">
          <mo id="alg1.l14.m1.1.6.1" stretchy="false">
           (
          </mo>
          <mo id="alg1.l14.m1.1.6.2" lspace="0em" rspace="0em">
           ⋅
          </mo>
          <mo fence="false" id="alg1.l14.m1.1.6.3" rspace="0.167em" stretchy="false">
           |
          </mo>
          <msubsup id="alg1.l14.m1.1.6.4">
           <mrow id="alg1.l14.m1.1.6.4.2.2">
            <mo id="alg1.l14.m1.1.6.4.2.2.1" stretchy="false">
             (
            </mo>
            <msubsup id="alg1.l14.m1.1.6.4.2.2.2">
             <mi id="alg1.l14.m1.1.6.4.2.2.2.2.2">
              𝐬
             </mi>
             <mi id="alg1.l14.m1.1.6.4.2.2.2.2.3">
              t
             </mi>
             <mi id="alg1.l14.m1.1.6.4.2.2.2.3">
              i
             </mi>
            </msubsup>
            <mo id="alg1.l14.m1.1.6.4.2.2.3">
             ,
            </mo>
            <msubsup id="alg1.l14.m1.1.6.4.2.2.4">
             <mi id="alg1.l14.m1.1.6.4.2.2.4.2.2">
              𝐲
             </mi>
             <mi id="alg1.l14.m1.1.6.4.2.2.4.2.3">
              t
             </mi>
             <mi id="alg1.l14.m1.1.6.4.2.2.4.3">
              i
             </mi>
            </msubsup>
            <mo id="alg1.l14.m1.1.6.4.2.2.5">
             ,
            </mo>
            <msup id="alg1.l14.m1.1.6.4.2.2.6">
             <mi id="alg1.l14.m1.1.6.4.2.2.6.2">
              𝐟
             </mi>
             <mi id="alg1.l14.m1.1.6.4.2.2.6.3">
              i
             </mi>
            </msup>
            <mo id="alg1.l14.m1.1.6.4.2.2.7" stretchy="false">
             )
            </mo>
           </mrow>
           <mrow id="alg1.l14.m1.1.6.4.2.3">
            <mi id="alg1.l14.m1.1.6.4.2.3.2">
             t
            </mi>
            <mo id="alg1.l14.m1.1.6.4.2.3.1">
             =
            </mo>
            <mn id="alg1.l14.m1.1.6.4.2.3.3">
             1
            </mn>
           </mrow>
           <mrow id="alg1.l14.m1.1.6.4.3">
            <msup id="alg1.l14.m1.1.6.4.3.2">
             <mi id="alg1.l14.m1.1.6.4.3.2.2">
              T
             </mi>
             <mo id="alg1.l14.m1.1.6.4.3.2.3">
              ′
             </mo>
            </msup>
            <mo id="alg1.l14.m1.1.6.4.3.1">
             −
            </mo>
            <mn id="alg1.l14.m1.1.6.4.3.3">
             1
            </mn>
           </mrow>
          </msubsup>
          <mo id="alg1.l14.m1.1.6.5">
           +
          </mo>
          <msub id="alg1.l14.m1.1.6.6">
           <mi id="alg1.l14.m1.1.6.6.2">
            𝐬
           </mi>
           <msup id="alg1.l14.m1.1.6.6.3">
            <mi id="alg1.l14.m1.1.6.6.3.2">
             T
            </mi>
            <mo id="alg1.l14.m1.1.6.6.3.3">
             ′
            </mo>
           </msup>
          </msub>
          <mo id="alg1.l14.m1.1.6.7" stretchy="false">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex" id="alg1.l14.m1.1c">
         \mathbf{y}_{T^{\prime}}^{i}\leftarrow\arg\max\tilde{\pi}(\cdot|(\mathbf{s}_{t}^{i},\mathbf{y}_{t}^{i},\mathbf{f}^{i})_{t=1}^{T^{\prime}-1}+\mathbf{s}_{T^{\prime}})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l15">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">
        15:
       </span>
      </span>
      <math alttext="\mathbf{s}_{T^{\prime}+1}^{i}" class="ltx_Math" display="inline" id="alg1.l15.m1.1">
       <semantics id="alg1.l15.m1.1a">
        <msubsup id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">
         <mi id="alg1.l15.m1.1.1.2.2" xref="alg1.l15.m1.1.1.2.2.cmml">
          𝐬
         </mi>
         <mrow id="alg1.l15.m1.1.1.2.3" xref="alg1.l15.m1.1.1.2.3.cmml">
          <msup id="alg1.l15.m1.1.1.2.3.2" xref="alg1.l15.m1.1.1.2.3.2.cmml">
           <mi id="alg1.l15.m1.1.1.2.3.2.2" xref="alg1.l15.m1.1.1.2.3.2.2.cmml">
            T
           </mi>
           <mo id="alg1.l15.m1.1.1.2.3.2.3" xref="alg1.l15.m1.1.1.2.3.2.3.cmml">
            ′
           </mo>
          </msup>
          <mo id="alg1.l15.m1.1.1.2.3.1" xref="alg1.l15.m1.1.1.2.3.1.cmml">
           +
          </mo>
          <mn id="alg1.l15.m1.1.1.2.3.3" xref="alg1.l15.m1.1.1.2.3.3.cmml">
           1
          </mn>
         </mrow>
         <mi id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">
          i
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b">
         <apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1">
           superscript
          </csymbol>
          <apply id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1">
           <csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1">
            subscript
           </csymbol>
           <ci id="alg1.l15.m1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.2.2">
            𝐬
           </ci>
           <apply id="alg1.l15.m1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.2.3">
            <plus id="alg1.l15.m1.1.1.2.3.1.cmml" xref="alg1.l15.m1.1.1.2.3.1">
            </plus>
            <apply id="alg1.l15.m1.1.1.2.3.2.cmml" xref="alg1.l15.m1.1.1.2.3.2">
             <csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.3.2.1.cmml" xref="alg1.l15.m1.1.1.2.3.2">
              superscript
             </csymbol>
             <ci id="alg1.l15.m1.1.1.2.3.2.2.cmml" xref="alg1.l15.m1.1.1.2.3.2.2">
              𝑇
             </ci>
             <ci id="alg1.l15.m1.1.1.2.3.2.3.cmml" xref="alg1.l15.m1.1.1.2.3.2.3">
              ′
             </ci>
            </apply>
            <cn id="alg1.l15.m1.1.1.2.3.3.cmml" type="integer" xref="alg1.l15.m1.1.1.2.3.3">
             1
            </cn>
           </apply>
          </apply>
          <ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">
           𝑖
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l15.m1.1c">
         \mathbf{s}_{T^{\prime}+1}^{i}
        </annotation>
       </semantics>
      </math>
      ,
      <math alttext="\mathbf{r}_{T^{\prime}}^{i}\leftarrow\text{env.step}(\mathbf{s}_{T^{\prime}}^{i},\mathbf{y}_{T^{\prime}}^{i})" class="ltx_Math" display="inline" id="alg1.l15.m2.2">
       <semantics id="alg1.l15.m2.2a">
        <mrow id="alg1.l15.m2.2.2" xref="alg1.l15.m2.2.2.cmml">
         <msubsup id="alg1.l15.m2.2.2.4" xref="alg1.l15.m2.2.2.4.cmml">
          <mi id="alg1.l15.m2.2.2.4.2.2" xref="alg1.l15.m2.2.2.4.2.2.cmml">
           𝐫
          </mi>
          <msup id="alg1.l15.m2.2.2.4.2.3" xref="alg1.l15.m2.2.2.4.2.3.cmml">
           <mi id="alg1.l15.m2.2.2.4.2.3.2" xref="alg1.l15.m2.2.2.4.2.3.2.cmml">
            T
           </mi>
           <mo id="alg1.l15.m2.2.2.4.2.3.3" xref="alg1.l15.m2.2.2.4.2.3.3.cmml">
            ′
           </mo>
          </msup>
          <mi id="alg1.l15.m2.2.2.4.3" xref="alg1.l15.m2.2.2.4.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="alg1.l15.m2.2.2.3" stretchy="false" xref="alg1.l15.m2.2.2.3.cmml">
          ←
         </mo>
         <mrow id="alg1.l15.m2.2.2.2" xref="alg1.l15.m2.2.2.2.cmml">
          <mtext id="alg1.l15.m2.2.2.2.4" xref="alg1.l15.m2.2.2.2.4a.cmml">
           env.step
          </mtext>
          <mo id="alg1.l15.m2.2.2.2.3" lspace="0em" rspace="0em" xref="alg1.l15.m2.2.2.2.3.cmml">
           ​
          </mo>
          <mrow id="alg1.l15.m2.2.2.2.2.2" xref="alg1.l15.m2.2.2.2.2.3.cmml">
           <mo id="alg1.l15.m2.2.2.2.2.2.3" stretchy="false" xref="alg1.l15.m2.2.2.2.2.3.cmml">
            (
           </mo>
           <msubsup id="alg1.l15.m2.1.1.1.1.1.1" xref="alg1.l15.m2.1.1.1.1.1.1.cmml">
            <mi id="alg1.l15.m2.1.1.1.1.1.1.2.2" xref="alg1.l15.m2.1.1.1.1.1.1.2.2.cmml">
             𝐬
            </mi>
            <msup id="alg1.l15.m2.1.1.1.1.1.1.2.3" xref="alg1.l15.m2.1.1.1.1.1.1.2.3.cmml">
             <mi id="alg1.l15.m2.1.1.1.1.1.1.2.3.2" xref="alg1.l15.m2.1.1.1.1.1.1.2.3.2.cmml">
              T
             </mi>
             <mo id="alg1.l15.m2.1.1.1.1.1.1.2.3.3" xref="alg1.l15.m2.1.1.1.1.1.1.2.3.3.cmml">
              ′
             </mo>
            </msup>
            <mi id="alg1.l15.m2.1.1.1.1.1.1.3" xref="alg1.l15.m2.1.1.1.1.1.1.3.cmml">
             i
            </mi>
           </msubsup>
           <mo id="alg1.l15.m2.2.2.2.2.2.4" xref="alg1.l15.m2.2.2.2.2.3.cmml">
            ,
           </mo>
           <msubsup id="alg1.l15.m2.2.2.2.2.2.2" xref="alg1.l15.m2.2.2.2.2.2.2.cmml">
            <mi id="alg1.l15.m2.2.2.2.2.2.2.2.2" xref="alg1.l15.m2.2.2.2.2.2.2.2.2.cmml">
             𝐲
            </mi>
            <msup id="alg1.l15.m2.2.2.2.2.2.2.2.3" xref="alg1.l15.m2.2.2.2.2.2.2.2.3.cmml">
             <mi id="alg1.l15.m2.2.2.2.2.2.2.2.3.2" xref="alg1.l15.m2.2.2.2.2.2.2.2.3.2.cmml">
              T
             </mi>
             <mo id="alg1.l15.m2.2.2.2.2.2.2.2.3.3" xref="alg1.l15.m2.2.2.2.2.2.2.2.3.3.cmml">
              ′
             </mo>
            </msup>
            <mi id="alg1.l15.m2.2.2.2.2.2.2.3" xref="alg1.l15.m2.2.2.2.2.2.2.3.cmml">
             i
            </mi>
           </msubsup>
           <mo id="alg1.l15.m2.2.2.2.2.2.5" stretchy="false" xref="alg1.l15.m2.2.2.2.2.3.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l15.m2.2b">
         <apply id="alg1.l15.m2.2.2.cmml" xref="alg1.l15.m2.2.2">
          <ci id="alg1.l15.m2.2.2.3.cmml" xref="alg1.l15.m2.2.2.3">
           ←
          </ci>
          <apply id="alg1.l15.m2.2.2.4.cmml" xref="alg1.l15.m2.2.2.4">
           <csymbol cd="ambiguous" id="alg1.l15.m2.2.2.4.1.cmml" xref="alg1.l15.m2.2.2.4">
            superscript
           </csymbol>
           <apply id="alg1.l15.m2.2.2.4.2.cmml" xref="alg1.l15.m2.2.2.4">
            <csymbol cd="ambiguous" id="alg1.l15.m2.2.2.4.2.1.cmml" xref="alg1.l15.m2.2.2.4">
             subscript
            </csymbol>
            <ci id="alg1.l15.m2.2.2.4.2.2.cmml" xref="alg1.l15.m2.2.2.4.2.2">
             𝐫
            </ci>
            <apply id="alg1.l15.m2.2.2.4.2.3.cmml" xref="alg1.l15.m2.2.2.4.2.3">
             <csymbol cd="ambiguous" id="alg1.l15.m2.2.2.4.2.3.1.cmml" xref="alg1.l15.m2.2.2.4.2.3">
              superscript
             </csymbol>
             <ci id="alg1.l15.m2.2.2.4.2.3.2.cmml" xref="alg1.l15.m2.2.2.4.2.3.2">
              𝑇
             </ci>
             <ci id="alg1.l15.m2.2.2.4.2.3.3.cmml" xref="alg1.l15.m2.2.2.4.2.3.3">
              ′
             </ci>
            </apply>
           </apply>
           <ci id="alg1.l15.m2.2.2.4.3.cmml" xref="alg1.l15.m2.2.2.4.3">
            𝑖
           </ci>
          </apply>
          <apply id="alg1.l15.m2.2.2.2.cmml" xref="alg1.l15.m2.2.2.2">
           <times id="alg1.l15.m2.2.2.2.3.cmml" xref="alg1.l15.m2.2.2.2.3">
           </times>
           <ci id="alg1.l15.m2.2.2.2.4a.cmml" xref="alg1.l15.m2.2.2.2.4">
            <mtext id="alg1.l15.m2.2.2.2.4.cmml" xref="alg1.l15.m2.2.2.2.4">
             env.step
            </mtext>
           </ci>
           <interval closure="open" id="alg1.l15.m2.2.2.2.2.3.cmml" xref="alg1.l15.m2.2.2.2.2.2">
            <apply id="alg1.l15.m2.1.1.1.1.1.1.cmml" xref="alg1.l15.m2.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="alg1.l15.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m2.1.1.1.1.1.1">
              superscript
             </csymbol>
             <apply id="alg1.l15.m2.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m2.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="alg1.l15.m2.1.1.1.1.1.1.2.1.cmml" xref="alg1.l15.m2.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="alg1.l15.m2.1.1.1.1.1.1.2.2.cmml" xref="alg1.l15.m2.1.1.1.1.1.1.2.2">
               𝐬
              </ci>
              <apply id="alg1.l15.m2.1.1.1.1.1.1.2.3.cmml" xref="alg1.l15.m2.1.1.1.1.1.1.2.3">
               <csymbol cd="ambiguous" id="alg1.l15.m2.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l15.m2.1.1.1.1.1.1.2.3">
                superscript
               </csymbol>
               <ci id="alg1.l15.m2.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l15.m2.1.1.1.1.1.1.2.3.2">
                𝑇
               </ci>
               <ci id="alg1.l15.m2.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l15.m2.1.1.1.1.1.1.2.3.3">
                ′
               </ci>
              </apply>
             </apply>
             <ci id="alg1.l15.m2.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m2.1.1.1.1.1.1.3">
              𝑖
             </ci>
            </apply>
            <apply id="alg1.l15.m2.2.2.2.2.2.2.cmml" xref="alg1.l15.m2.2.2.2.2.2.2">
             <csymbol cd="ambiguous" id="alg1.l15.m2.2.2.2.2.2.2.1.cmml" xref="alg1.l15.m2.2.2.2.2.2.2">
              superscript
             </csymbol>
             <apply id="alg1.l15.m2.2.2.2.2.2.2.2.cmml" xref="alg1.l15.m2.2.2.2.2.2.2">
              <csymbol cd="ambiguous" id="alg1.l15.m2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l15.m2.2.2.2.2.2.2">
               subscript
              </csymbol>
              <ci id="alg1.l15.m2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l15.m2.2.2.2.2.2.2.2.2">
               𝐲
              </ci>
              <apply id="alg1.l15.m2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l15.m2.2.2.2.2.2.2.2.3">
               <csymbol cd="ambiguous" id="alg1.l15.m2.2.2.2.2.2.2.2.3.1.cmml" xref="alg1.l15.m2.2.2.2.2.2.2.2.3">
                superscript
               </csymbol>
               <ci id="alg1.l15.m2.2.2.2.2.2.2.2.3.2.cmml" xref="alg1.l15.m2.2.2.2.2.2.2.2.3.2">
                𝑇
               </ci>
               <ci id="alg1.l15.m2.2.2.2.2.2.2.2.3.3.cmml" xref="alg1.l15.m2.2.2.2.2.2.2.2.3.3">
                ′
               </ci>
              </apply>
             </apply>
             <ci id="alg1.l15.m2.2.2.2.2.2.2.3.cmml" xref="alg1.l15.m2.2.2.2.2.2.2.3">
              𝑖
             </ci>
            </apply>
           </interval>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l15.m2.2c">
         \mathbf{r}_{T^{\prime}}^{i}\leftarrow\text{env.step}(\mathbf{s}_{T^{\prime}}^{i},\mathbf{y}_{T^{\prime}}^{i})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l16">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">
        16:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l16.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l16.3">
       if
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l17">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">
        17:
       </span>
      </span>
      <math alttext="\mathcal{D}^{\prime}_{T}\leftarrow\mathcal{D}^{\prime}_{T}\cup\left\{\left(\mathbf{s}_{t}^{i},\mathbf{y}_{t}^{i},\mathbf{f}_{t}^{i},\mathbf{r}_{t}^{i}\right)\right\}_{t=1}^{T^{\prime}}" class="ltx_Math" display="inline" id="alg1.l17.m1.1">
       <semantics id="alg1.l17.m1.1a">
        <mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml">
         <msubsup id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml">
          <mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.1.1.3.2.2" xref="alg1.l17.m1.1.1.3.2.2.cmml">
           𝒟
          </mi>
          <mi id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml">
           T
          </mi>
          <mo id="alg1.l17.m1.1.1.3.2.3" xref="alg1.l17.m1.1.1.3.2.3.cmml">
           ′
          </mo>
         </msubsup>
         <mo id="alg1.l17.m1.1.1.2" stretchy="false" xref="alg1.l17.m1.1.1.2.cmml">
          ←
         </mo>
         <mrow id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml">
          <msubsup id="alg1.l17.m1.1.1.1.3" xref="alg1.l17.m1.1.1.1.3.cmml">
           <mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.1.1.1.3.2.2" xref="alg1.l17.m1.1.1.1.3.2.2.cmml">
            𝒟
           </mi>
           <mi id="alg1.l17.m1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.3.3.cmml">
            T
           </mi>
           <mo id="alg1.l17.m1.1.1.1.3.2.3" xref="alg1.l17.m1.1.1.1.3.2.3.cmml">
            ′
           </mo>
          </msubsup>
          <mo id="alg1.l17.m1.1.1.1.2" xref="alg1.l17.m1.1.1.1.2.cmml">
           ∪
          </mo>
          <msubsup id="alg1.l17.m1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.cmml">
           <mrow id="alg1.l17.m1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.2.cmml">
            <mo id="alg1.l17.m1.1.1.1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.1.1.2.cmml">
             {
            </mo>
            <mrow id="alg1.l17.m1.1.1.1.1.1.1.1.1.4" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.5.cmml">
             <mo id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.5" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.5.cmml">
              (
             </mo>
             <msubsup id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.cmml">
              <mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">
               𝐬
              </mi>
              <mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">
               t
              </mi>
              <mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">
               i
              </mi>
             </msubsup>
             <mo id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.6" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.5.cmml">
              ,
             </mo>
             <msubsup id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.cmml">
              <mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">
               𝐲
              </mi>
              <mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">
               t
              </mi>
              <mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">
               i
              </mi>
             </msubsup>
             <mo id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.7" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.5.cmml">
              ,
             </mo>
             <msubsup id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.cmml">
              <mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">
               𝐟
              </mi>
              <mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">
               t
              </mi>
              <mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">
               i
              </mi>
             </msubsup>
             <mo id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.8" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.5.cmml">
              ,
             </mo>
             <msubsup id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.cmml">
              <mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.2.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.2.2.cmml">
               𝐫
              </mi>
              <mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.2.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.2.3.cmml">
               t
              </mi>
              <mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.3.cmml">
               i
              </mi>
             </msubsup>
             <mo id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.9" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.5.cmml">
              )
             </mo>
            </mrow>
            <mo id="alg1.l17.m1.1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.2.cmml">
             }
            </mo>
           </mrow>
           <mrow id="alg1.l17.m1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.3.cmml">
            <mi id="alg1.l17.m1.1.1.1.1.1.3.2" xref="alg1.l17.m1.1.1.1.1.1.3.2.cmml">
             t
            </mi>
            <mo id="alg1.l17.m1.1.1.1.1.1.3.1" xref="alg1.l17.m1.1.1.1.1.1.3.1.cmml">
             =
            </mo>
            <mn id="alg1.l17.m1.1.1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.1.1.3.3.cmml">
             1
            </mn>
           </mrow>
           <msup id="alg1.l17.m1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.3.cmml">
            <mi id="alg1.l17.m1.1.1.1.1.3.2" xref="alg1.l17.m1.1.1.1.1.3.2.cmml">
             T
            </mi>
            <mo id="alg1.l17.m1.1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.1.3.3.cmml">
             ′
            </mo>
           </msup>
          </msubsup>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b">
         <apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1">
          <ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">
           ←
          </ci>
          <apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3">
           <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3">
            subscript
           </csymbol>
           <apply id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3">
            <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.2.1.cmml" xref="alg1.l17.m1.1.1.3">
             superscript
            </csymbol>
            <ci id="alg1.l17.m1.1.1.3.2.2.cmml" xref="alg1.l17.m1.1.1.3.2.2">
             𝒟
            </ci>
            <ci id="alg1.l17.m1.1.1.3.2.3.cmml" xref="alg1.l17.m1.1.1.3.2.3">
             ′
            </ci>
           </apply>
           <ci id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3">
            𝑇
           </ci>
          </apply>
          <apply id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1">
           <union id="alg1.l17.m1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.2">
           </union>
           <apply id="alg1.l17.m1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.3">
            <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.3">
             subscript
            </csymbol>
            <apply id="alg1.l17.m1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.3">
             <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.3.2.1.cmml" xref="alg1.l17.m1.1.1.1.3">
              superscript
             </csymbol>
             <ci id="alg1.l17.m1.1.1.1.3.2.2.cmml" xref="alg1.l17.m1.1.1.1.3.2.2">
              𝒟
             </ci>
             <ci id="alg1.l17.m1.1.1.1.3.2.3.cmml" xref="alg1.l17.m1.1.1.1.3.2.3">
              ′
             </ci>
            </apply>
            <ci id="alg1.l17.m1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.3.3">
             𝑇
            </ci>
           </apply>
           <apply id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1">
            <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1">
             superscript
            </csymbol>
            <apply id="alg1.l17.m1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1">
             <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1">
              subscript
             </csymbol>
             <set id="alg1.l17.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1">
              <vector id="alg1.l17.m1.1.1.1.1.1.1.1.1.5.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.4">
               <apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1">
                 superscript
                </csymbol>
                <apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2.2">
                  𝐬
                 </ci>
                 <ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2.3">
                  𝑡
                 </ci>
                </apply>
                <ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.3">
                 𝑖
                </ci>
               </apply>
               <apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2">
                <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2">
                 superscript
                </csymbol>
                <apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2">
                 <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2">
                  subscript
                 </csymbol>
                 <ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.2.2">
                  𝐲
                 </ci>
                 <ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.2.3">
                  𝑡
                 </ci>
                </apply>
                <ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.3">
                 𝑖
                </ci>
               </apply>
               <apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3">
                <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3">
                 superscript
                </csymbol>
                <apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3">
                 <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3">
                  subscript
                 </csymbol>
                 <ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2.2">
                  𝐟
                 </ci>
                 <ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2.3">
                  𝑡
                 </ci>
                </apply>
                <ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.3">
                 𝑖
                </ci>
               </apply>
               <apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4">
                <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4">
                 superscript
                </csymbol>
                <apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4">
                 <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4">
                  subscript
                 </csymbol>
                 <ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.2.2">
                  𝐫
                 </ci>
                 <ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.2.3">
                  𝑡
                 </ci>
                </apply>
                <ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.4.4.3">
                 𝑖
                </ci>
               </apply>
              </vector>
             </set>
             <apply id="alg1.l17.m1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.3">
              <eq id="alg1.l17.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.1">
              </eq>
              <ci id="alg1.l17.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.2">
               𝑡
              </ci>
              <cn id="alg1.l17.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l17.m1.1.1.1.1.1.3.3">
               1
              </cn>
             </apply>
            </apply>
            <apply id="alg1.l17.m1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.3">
             <csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.3">
              superscript
             </csymbol>
             <ci id="alg1.l17.m1.1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.3.2">
              𝑇
             </ci>
             <ci id="alg1.l17.m1.1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.3.3">
              ′
             </ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l17.m1.1c">
         \mathcal{D}^{\prime}_{T}\leftarrow\mathcal{D}^{\prime}_{T}\cup\left\{\left(\mathbf{s}_{t}^{i},\mathbf{y}_{t}^{i},\mathbf{f}_{t}^{i},\mathbf{r}_{t}^{i}\right)\right\}_{t=1}^{T^{\prime}}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l18">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">
        18:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l18.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l18.3">
       for
      </span>
     </div>
    </div>
   </figure>
   <figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_float">
      <span class="ltx_text ltx_font_bold" id="alg2.4.1.1">
       Algorithm 2
      </span>
     </span>
     Inference at iteration
     <math alttext="T" class="ltx_Math" display="inline" id="alg2.2.m1.1">
      <semantics id="alg2.2.m1.1b">
       <mi id="alg2.2.m1.1.1" xref="alg2.2.m1.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="alg2.2.m1.1c">
        <ci id="alg2.2.m1.1.1.cmml" xref="alg2.2.m1.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="alg2.2.m1.1d">
        T
       </annotation>
      </semantics>
     </math>
    </figcaption>
    <div class="ltx_listing ltx_listing" id="alg2.5">
     <div class="ltx_listingline" id="alg2.l1">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">
        1:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l1.2">
       for
      </span>
      index
      <math alttext="i" class="ltx_Math" display="inline" id="alg2.l1.m1.1">
       <semantics id="alg2.l1.m1.1a">
        <mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">
         i
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b">
         <ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">
          𝑖
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l1.m1.1c">
         i
        </annotation>
       </semantics>
      </math>
      in
      <math alttext="\left\{1,\ldots,|\mathcal{D}|\right\}" class="ltx_Math" display="inline" id="alg2.l1.m2.4">
       <semantics id="alg2.l1.m2.4a">
        <mrow id="alg2.l1.m2.4.4.1" xref="alg2.l1.m2.4.4.2.cmml">
         <mo id="alg2.l1.m2.4.4.1.2" xref="alg2.l1.m2.4.4.2.cmml">
          {
         </mo>
         <mn id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml">
          1
         </mn>
         <mo id="alg2.l1.m2.4.4.1.3" xref="alg2.l1.m2.4.4.2.cmml">
          ,
         </mo>
         <mi id="alg2.l1.m2.2.2" mathvariant="normal" xref="alg2.l1.m2.2.2.cmml">
          …
         </mi>
         <mo id="alg2.l1.m2.4.4.1.4" xref="alg2.l1.m2.4.4.2.cmml">
          ,
         </mo>
         <mrow id="alg2.l1.m2.4.4.1.1.2" xref="alg2.l1.m2.4.4.1.1.1.cmml">
          <mo id="alg2.l1.m2.4.4.1.1.2.1" stretchy="false" xref="alg2.l1.m2.4.4.1.1.1.1.cmml">
           |
          </mo>
          <mi class="ltx_font_mathcaligraphic" id="alg2.l1.m2.3.3" xref="alg2.l1.m2.3.3.cmml">
           𝒟
          </mi>
          <mo id="alg2.l1.m2.4.4.1.1.2.2" stretchy="false" xref="alg2.l1.m2.4.4.1.1.1.1.cmml">
           |
          </mo>
         </mrow>
         <mo id="alg2.l1.m2.4.4.1.5" xref="alg2.l1.m2.4.4.2.cmml">
          }
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l1.m2.4b">
         <set id="alg2.l1.m2.4.4.2.cmml" xref="alg2.l1.m2.4.4.1">
          <cn id="alg2.l1.m2.1.1.cmml" type="integer" xref="alg2.l1.m2.1.1">
           1
          </cn>
          <ci id="alg2.l1.m2.2.2.cmml" xref="alg2.l1.m2.2.2">
           …
          </ci>
          <apply id="alg2.l1.m2.4.4.1.1.1.cmml" xref="alg2.l1.m2.4.4.1.1.2">
           <abs id="alg2.l1.m2.4.4.1.1.1.1.cmml" xref="alg2.l1.m2.4.4.1.1.2.1">
           </abs>
           <ci id="alg2.l1.m2.3.3.cmml" xref="alg2.l1.m2.3.3">
            𝒟
           </ci>
          </apply>
         </set>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l1.m2.4c">
         \left\{1,\ldots,|\mathcal{D}|\right\}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg2.l1.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg2.l2">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">
        2:
       </span>
      </span>
      <math alttext="\mathbf{s}_{1}\leftarrow\mathbf{x}^{i}" class="ltx_Math" display="inline" id="alg2.l2.m1.1">
       <semantics id="alg2.l2.m1.1a">
        <mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">
         <msub id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">
          <mi id="alg2.l2.m1.1.1.2.2" xref="alg2.l2.m1.1.1.2.2.cmml">
           𝐬
          </mi>
          <mn id="alg2.l2.m1.1.1.2.3" xref="alg2.l2.m1.1.1.2.3.cmml">
           1
          </mn>
         </msub>
         <mo id="alg2.l2.m1.1.1.1" stretchy="false" xref="alg2.l2.m1.1.1.1.cmml">
          ←
         </mo>
         <msup id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">
          <mi id="alg2.l2.m1.1.1.3.2" xref="alg2.l2.m1.1.1.3.2.cmml">
           𝐱
          </mi>
          <mi id="alg2.l2.m1.1.1.3.3" xref="alg2.l2.m1.1.1.3.3.cmml">
           i
          </mi>
         </msup>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b">
         <apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">
          <ci id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1">
           ←
          </ci>
          <apply id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">
           <csymbol cd="ambiguous" id="alg2.l2.m1.1.1.2.1.cmml" xref="alg2.l2.m1.1.1.2">
            subscript
           </csymbol>
           <ci id="alg2.l2.m1.1.1.2.2.cmml" xref="alg2.l2.m1.1.1.2.2">
            𝐬
           </ci>
           <cn id="alg2.l2.m1.1.1.2.3.cmml" type="integer" xref="alg2.l2.m1.1.1.2.3">
            1
           </cn>
          </apply>
          <apply id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">
           <csymbol cd="ambiguous" id="alg2.l2.m1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.3">
            superscript
           </csymbol>
           <ci id="alg2.l2.m1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.3.2">
            𝐱
           </ci>
           <ci id="alg2.l2.m1.1.1.3.3.cmml" xref="alg2.l2.m1.1.1.3.3">
            𝑖
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l2.m1.1c">
         \mathbf{s}_{1}\leftarrow\mathbf{x}^{i}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg2.l3">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">
        3:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l3.2">
       for
      </span>
      step
      <math alttext="T^{\prime}" class="ltx_Math" display="inline" id="alg2.l3.m1.1">
       <semantics id="alg2.l3.m1.1a">
        <msup id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">
         <mi id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">
          T
         </mi>
         <mo id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">
          ′
         </mo>
        </msup>
        <annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b">
         <apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">
          <csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1">
           superscript
          </csymbol>
          <ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">
           𝑇
          </ci>
          <ci id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">
           ′
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l3.m1.1c">
         T^{\prime}
        </annotation>
       </semantics>
      </math>
      in
      <math alttext="\left\{1,\ldots,N\right\}" class="ltx_Math" display="inline" id="alg2.l3.m2.3">
       <semantics id="alg2.l3.m2.3a">
        <mrow id="alg2.l3.m2.3.4.2" xref="alg2.l3.m2.3.4.1.cmml">
         <mo id="alg2.l3.m2.3.4.2.1" xref="alg2.l3.m2.3.4.1.cmml">
          {
         </mo>
         <mn id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml">
          1
         </mn>
         <mo id="alg2.l3.m2.3.4.2.2" xref="alg2.l3.m2.3.4.1.cmml">
          ,
         </mo>
         <mi id="alg2.l3.m2.2.2" mathvariant="normal" xref="alg2.l3.m2.2.2.cmml">
          …
         </mi>
         <mo id="alg2.l3.m2.3.4.2.3" xref="alg2.l3.m2.3.4.1.cmml">
          ,
         </mo>
         <mi id="alg2.l3.m2.3.3" xref="alg2.l3.m2.3.3.cmml">
          N
         </mi>
         <mo id="alg2.l3.m2.3.4.2.4" xref="alg2.l3.m2.3.4.1.cmml">
          }
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l3.m2.3b">
         <set id="alg2.l3.m2.3.4.1.cmml" xref="alg2.l3.m2.3.4.2">
          <cn id="alg2.l3.m2.1.1.cmml" type="integer" xref="alg2.l3.m2.1.1">
           1
          </cn>
          <ci id="alg2.l3.m2.2.2.cmml" xref="alg2.l3.m2.2.2">
           …
          </ci>
          <ci id="alg2.l3.m2.3.3.cmml" xref="alg2.l3.m2.3.3">
           𝑁
          </ci>
         </set>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l3.m2.3c">
         \left\{1,\ldots,N\right\}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg2.l3.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg2.l4">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l4.1.1.1" style="font-size:80%;">
        4:
       </span>
      </span>
      <math alttext="\mathbf{y}_{T^{\prime}}^{i}\leftarrow\arg\max\pi_{\theta_{T}}(\cdot|(\mathbf{s}_{t}^{i},\mathbf{y}_{t}^{i},\mathbf{f}^{i})_{t=\max\left\{1,T^{\prime}-T\right\}}^{T^{\prime}-1}+\mathbf{s}_{T^{\prime}})" class="ltx_math_unparsed" display="inline" id="alg2.l4.m1.3">
       <semantics id="alg2.l4.m1.3a">
        <mrow id="alg2.l4.m1.3b">
         <msubsup id="alg2.l4.m1.3.4">
          <mi id="alg2.l4.m1.3.4.2.2">
           𝐲
          </mi>
          <msup id="alg2.l4.m1.3.4.2.3">
           <mi id="alg2.l4.m1.3.4.2.3.2">
            T
           </mi>
           <mo id="alg2.l4.m1.3.4.2.3.3">
            ′
           </mo>
          </msup>
          <mi id="alg2.l4.m1.3.4.3">
           i
          </mi>
         </msubsup>
         <mo id="alg2.l4.m1.3.5" stretchy="false">
          ←
         </mo>
         <mi id="alg2.l4.m1.3.6">
          arg
         </mi>
         <mi id="alg2.l4.m1.3.7">
          max
         </mi>
         <msub id="alg2.l4.m1.3.8">
          <mi id="alg2.l4.m1.3.8.2">
           π
          </mi>
          <msub id="alg2.l4.m1.3.8.3">
           <mi id="alg2.l4.m1.3.8.3.2">
            θ
           </mi>
           <mi id="alg2.l4.m1.3.8.3.3">
            T
           </mi>
          </msub>
         </msub>
         <mrow id="alg2.l4.m1.3.9">
          <mo id="alg2.l4.m1.3.9.1" stretchy="false">
           (
          </mo>
          <mo id="alg2.l4.m1.3.9.2" lspace="0em" rspace="0em">
           ⋅
          </mo>
          <mo fence="false" id="alg2.l4.m1.3.9.3" rspace="0.167em" stretchy="false">
           |
          </mo>
          <msubsup id="alg2.l4.m1.3.9.4">
           <mrow id="alg2.l4.m1.3.9.4.2.2">
            <mo id="alg2.l4.m1.3.9.4.2.2.1" stretchy="false">
             (
            </mo>
            <msubsup id="alg2.l4.m1.3.9.4.2.2.2">
             <mi id="alg2.l4.m1.3.9.4.2.2.2.2.2">
              𝐬
             </mi>
             <mi id="alg2.l4.m1.3.9.4.2.2.2.2.3">
              t
             </mi>
             <mi id="alg2.l4.m1.3.9.4.2.2.2.3">
              i
             </mi>
            </msubsup>
            <mo id="alg2.l4.m1.3.9.4.2.2.3">
             ,
            </mo>
            <msubsup id="alg2.l4.m1.3.9.4.2.2.4">
             <mi id="alg2.l4.m1.3.9.4.2.2.4.2.2">
              𝐲
             </mi>
             <mi id="alg2.l4.m1.3.9.4.2.2.4.2.3">
              t
             </mi>
             <mi id="alg2.l4.m1.3.9.4.2.2.4.3">
              i
             </mi>
            </msubsup>
            <mo id="alg2.l4.m1.3.9.4.2.2.5">
             ,
            </mo>
            <msup id="alg2.l4.m1.3.9.4.2.2.6">
             <mi id="alg2.l4.m1.3.9.4.2.2.6.2">
              𝐟
             </mi>
             <mi id="alg2.l4.m1.3.9.4.2.2.6.3">
              i
             </mi>
            </msup>
            <mo id="alg2.l4.m1.3.9.4.2.2.7" stretchy="false">
             )
            </mo>
           </mrow>
           <mrow id="alg2.l4.m1.3.3.3">
            <mi id="alg2.l4.m1.3.3.3.5">
             t
            </mi>
            <mo id="alg2.l4.m1.3.3.3.4">
             =
            </mo>
            <mrow id="alg2.l4.m1.3.3.3.3.1">
             <mi id="alg2.l4.m1.1.1.1.1">
              max
             </mi>
             <mo id="alg2.l4.m1.3.3.3.3.1a">
              ⁡
             </mo>
             <mrow id="alg2.l4.m1.3.3.3.3.1.1">
              <mo id="alg2.l4.m1.3.3.3.3.1.1.2">
               {
              </mo>
              <mn id="alg2.l4.m1.2.2.2.2">
               1
              </mn>
              <mo id="alg2.l4.m1.3.3.3.3.1.1.3">
               ,
              </mo>
              <mrow id="alg2.l4.m1.3.3.3.3.1.1.1">
               <msup id="alg2.l4.m1.3.3.3.3.1.1.1.2">
                <mi id="alg2.l4.m1.3.3.3.3.1.1.1.2.2">
                 T
                </mi>
                <mo id="alg2.l4.m1.3.3.3.3.1.1.1.2.3">
                 ′
                </mo>
               </msup>
               <mo id="alg2.l4.m1.3.3.3.3.1.1.1.1">
                −
               </mo>
               <mi id="alg2.l4.m1.3.3.3.3.1.1.1.3">
                T
               </mi>
              </mrow>
              <mo id="alg2.l4.m1.3.3.3.3.1.1.4">
               }
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mrow id="alg2.l4.m1.3.9.4.3">
            <msup id="alg2.l4.m1.3.9.4.3.2">
             <mi id="alg2.l4.m1.3.9.4.3.2.2">
              T
             </mi>
             <mo id="alg2.l4.m1.3.9.4.3.2.3">
              ′
             </mo>
            </msup>
            <mo id="alg2.l4.m1.3.9.4.3.1">
             −
            </mo>
            <mn id="alg2.l4.m1.3.9.4.3.3">
             1
            </mn>
           </mrow>
          </msubsup>
          <mo id="alg2.l4.m1.3.9.5">
           +
          </mo>
          <msub id="alg2.l4.m1.3.9.6">
           <mi id="alg2.l4.m1.3.9.6.2">
            𝐬
           </mi>
           <msup id="alg2.l4.m1.3.9.6.3">
            <mi id="alg2.l4.m1.3.9.6.3.2">
             T
            </mi>
            <mo id="alg2.l4.m1.3.9.6.3.3">
             ′
            </mo>
           </msup>
          </msub>
          <mo id="alg2.l4.m1.3.9.7" stretchy="false">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex" id="alg2.l4.m1.3c">
         \mathbf{y}_{T^{\prime}}^{i}\leftarrow\arg\max\pi_{\theta_{T}}(\cdot|(\mathbf{s}_{t}^{i},\mathbf{y}_{t}^{i},\mathbf{f}^{i})_{t=\max\left\{1,T^{\prime}-T\right\}}^{T^{\prime}-1}+\mathbf{s}_{T^{\prime}})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg2.l5">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l5.1.1.1" style="font-size:80%;">
        5:
       </span>
      </span>
      <math alttext="\mathbf{s}_{T^{\prime}+1}^{i}" class="ltx_Math" display="inline" id="alg2.l5.m1.1">
       <semantics id="alg2.l5.m1.1a">
        <msubsup id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">
         <mi id="alg2.l5.m1.1.1.2.2" xref="alg2.l5.m1.1.1.2.2.cmml">
          𝐬
         </mi>
         <mrow id="alg2.l5.m1.1.1.2.3" xref="alg2.l5.m1.1.1.2.3.cmml">
          <msup id="alg2.l5.m1.1.1.2.3.2" xref="alg2.l5.m1.1.1.2.3.2.cmml">
           <mi id="alg2.l5.m1.1.1.2.3.2.2" xref="alg2.l5.m1.1.1.2.3.2.2.cmml">
            T
           </mi>
           <mo id="alg2.l5.m1.1.1.2.3.2.3" xref="alg2.l5.m1.1.1.2.3.2.3.cmml">
            ′
           </mo>
          </msup>
          <mo id="alg2.l5.m1.1.1.2.3.1" xref="alg2.l5.m1.1.1.2.3.1.cmml">
           +
          </mo>
          <mn id="alg2.l5.m1.1.1.2.3.3" xref="alg2.l5.m1.1.1.2.3.3.cmml">
           1
          </mn>
         </mrow>
         <mi id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">
          i
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b">
         <apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">
          <csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1">
           superscript
          </csymbol>
          <apply id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1">
           <csymbol cd="ambiguous" id="alg2.l5.m1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1">
            subscript
           </csymbol>
           <ci id="alg2.l5.m1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.2.2">
            𝐬
           </ci>
           <apply id="alg2.l5.m1.1.1.2.3.cmml" xref="alg2.l5.m1.1.1.2.3">
            <plus id="alg2.l5.m1.1.1.2.3.1.cmml" xref="alg2.l5.m1.1.1.2.3.1">
            </plus>
            <apply id="alg2.l5.m1.1.1.2.3.2.cmml" xref="alg2.l5.m1.1.1.2.3.2">
             <csymbol cd="ambiguous" id="alg2.l5.m1.1.1.2.3.2.1.cmml" xref="alg2.l5.m1.1.1.2.3.2">
              superscript
             </csymbol>
             <ci id="alg2.l5.m1.1.1.2.3.2.2.cmml" xref="alg2.l5.m1.1.1.2.3.2.2">
              𝑇
             </ci>
             <ci id="alg2.l5.m1.1.1.2.3.2.3.cmml" xref="alg2.l5.m1.1.1.2.3.2.3">
              ′
             </ci>
            </apply>
            <cn id="alg2.l5.m1.1.1.2.3.3.cmml" type="integer" xref="alg2.l5.m1.1.1.2.3.3">
             1
            </cn>
           </apply>
          </apply>
          <ci id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">
           𝑖
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l5.m1.1c">
         \mathbf{s}_{T^{\prime}+1}^{i}
        </annotation>
       </semantics>
      </math>
      ,
      <math alttext="\mathbf{r}_{T^{\prime}}^{i}\leftarrow\text{env.step}(\mathbf{s}_{T^{\prime}}^{i},\mathbf{y}_{T^{\prime}}^{i})" class="ltx_Math" display="inline" id="alg2.l5.m2.2">
       <semantics id="alg2.l5.m2.2a">
        <mrow id="alg2.l5.m2.2.2" xref="alg2.l5.m2.2.2.cmml">
         <msubsup id="alg2.l5.m2.2.2.4" xref="alg2.l5.m2.2.2.4.cmml">
          <mi id="alg2.l5.m2.2.2.4.2.2" xref="alg2.l5.m2.2.2.4.2.2.cmml">
           𝐫
          </mi>
          <msup id="alg2.l5.m2.2.2.4.2.3" xref="alg2.l5.m2.2.2.4.2.3.cmml">
           <mi id="alg2.l5.m2.2.2.4.2.3.2" xref="alg2.l5.m2.2.2.4.2.3.2.cmml">
            T
           </mi>
           <mo id="alg2.l5.m2.2.2.4.2.3.3" xref="alg2.l5.m2.2.2.4.2.3.3.cmml">
            ′
           </mo>
          </msup>
          <mi id="alg2.l5.m2.2.2.4.3" xref="alg2.l5.m2.2.2.4.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="alg2.l5.m2.2.2.3" stretchy="false" xref="alg2.l5.m2.2.2.3.cmml">
          ←
         </mo>
         <mrow id="alg2.l5.m2.2.2.2" xref="alg2.l5.m2.2.2.2.cmml">
          <mtext id="alg2.l5.m2.2.2.2.4" xref="alg2.l5.m2.2.2.2.4a.cmml">
           env.step
          </mtext>
          <mo id="alg2.l5.m2.2.2.2.3" lspace="0em" rspace="0em" xref="alg2.l5.m2.2.2.2.3.cmml">
           ​
          </mo>
          <mrow id="alg2.l5.m2.2.2.2.2.2" xref="alg2.l5.m2.2.2.2.2.3.cmml">
           <mo id="alg2.l5.m2.2.2.2.2.2.3" stretchy="false" xref="alg2.l5.m2.2.2.2.2.3.cmml">
            (
           </mo>
           <msubsup id="alg2.l5.m2.1.1.1.1.1.1" xref="alg2.l5.m2.1.1.1.1.1.1.cmml">
            <mi id="alg2.l5.m2.1.1.1.1.1.1.2.2" xref="alg2.l5.m2.1.1.1.1.1.1.2.2.cmml">
             𝐬
            </mi>
            <msup id="alg2.l5.m2.1.1.1.1.1.1.2.3" xref="alg2.l5.m2.1.1.1.1.1.1.2.3.cmml">
             <mi id="alg2.l5.m2.1.1.1.1.1.1.2.3.2" xref="alg2.l5.m2.1.1.1.1.1.1.2.3.2.cmml">
              T
             </mi>
             <mo id="alg2.l5.m2.1.1.1.1.1.1.2.3.3" xref="alg2.l5.m2.1.1.1.1.1.1.2.3.3.cmml">
              ′
             </mo>
            </msup>
            <mi id="alg2.l5.m2.1.1.1.1.1.1.3" xref="alg2.l5.m2.1.1.1.1.1.1.3.cmml">
             i
            </mi>
           </msubsup>
           <mo id="alg2.l5.m2.2.2.2.2.2.4" xref="alg2.l5.m2.2.2.2.2.3.cmml">
            ,
           </mo>
           <msubsup id="alg2.l5.m2.2.2.2.2.2.2" xref="alg2.l5.m2.2.2.2.2.2.2.cmml">
            <mi id="alg2.l5.m2.2.2.2.2.2.2.2.2" xref="alg2.l5.m2.2.2.2.2.2.2.2.2.cmml">
             𝐲
            </mi>
            <msup id="alg2.l5.m2.2.2.2.2.2.2.2.3" xref="alg2.l5.m2.2.2.2.2.2.2.2.3.cmml">
             <mi id="alg2.l5.m2.2.2.2.2.2.2.2.3.2" xref="alg2.l5.m2.2.2.2.2.2.2.2.3.2.cmml">
              T
             </mi>
             <mo id="alg2.l5.m2.2.2.2.2.2.2.2.3.3" xref="alg2.l5.m2.2.2.2.2.2.2.2.3.3.cmml">
              ′
             </mo>
            </msup>
            <mi id="alg2.l5.m2.2.2.2.2.2.2.3" xref="alg2.l5.m2.2.2.2.2.2.2.3.cmml">
             i
            </mi>
           </msubsup>
           <mo id="alg2.l5.m2.2.2.2.2.2.5" stretchy="false" xref="alg2.l5.m2.2.2.2.2.3.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l5.m2.2b">
         <apply id="alg2.l5.m2.2.2.cmml" xref="alg2.l5.m2.2.2">
          <ci id="alg2.l5.m2.2.2.3.cmml" xref="alg2.l5.m2.2.2.3">
           ←
          </ci>
          <apply id="alg2.l5.m2.2.2.4.cmml" xref="alg2.l5.m2.2.2.4">
           <csymbol cd="ambiguous" id="alg2.l5.m2.2.2.4.1.cmml" xref="alg2.l5.m2.2.2.4">
            superscript
           </csymbol>
           <apply id="alg2.l5.m2.2.2.4.2.cmml" xref="alg2.l5.m2.2.2.4">
            <csymbol cd="ambiguous" id="alg2.l5.m2.2.2.4.2.1.cmml" xref="alg2.l5.m2.2.2.4">
             subscript
            </csymbol>
            <ci id="alg2.l5.m2.2.2.4.2.2.cmml" xref="alg2.l5.m2.2.2.4.2.2">
             𝐫
            </ci>
            <apply id="alg2.l5.m2.2.2.4.2.3.cmml" xref="alg2.l5.m2.2.2.4.2.3">
             <csymbol cd="ambiguous" id="alg2.l5.m2.2.2.4.2.3.1.cmml" xref="alg2.l5.m2.2.2.4.2.3">
              superscript
             </csymbol>
             <ci id="alg2.l5.m2.2.2.4.2.3.2.cmml" xref="alg2.l5.m2.2.2.4.2.3.2">
              𝑇
             </ci>
             <ci id="alg2.l5.m2.2.2.4.2.3.3.cmml" xref="alg2.l5.m2.2.2.4.2.3.3">
              ′
             </ci>
            </apply>
           </apply>
           <ci id="alg2.l5.m2.2.2.4.3.cmml" xref="alg2.l5.m2.2.2.4.3">
            𝑖
           </ci>
          </apply>
          <apply id="alg2.l5.m2.2.2.2.cmml" xref="alg2.l5.m2.2.2.2">
           <times id="alg2.l5.m2.2.2.2.3.cmml" xref="alg2.l5.m2.2.2.2.3">
           </times>
           <ci id="alg2.l5.m2.2.2.2.4a.cmml" xref="alg2.l5.m2.2.2.2.4">
            <mtext id="alg2.l5.m2.2.2.2.4.cmml" xref="alg2.l5.m2.2.2.2.4">
             env.step
            </mtext>
           </ci>
           <interval closure="open" id="alg2.l5.m2.2.2.2.2.3.cmml" xref="alg2.l5.m2.2.2.2.2.2">
            <apply id="alg2.l5.m2.1.1.1.1.1.1.cmml" xref="alg2.l5.m2.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="alg2.l5.m2.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m2.1.1.1.1.1.1">
              superscript
             </csymbol>
             <apply id="alg2.l5.m2.1.1.1.1.1.1.2.cmml" xref="alg2.l5.m2.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="alg2.l5.m2.1.1.1.1.1.1.2.1.cmml" xref="alg2.l5.m2.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="alg2.l5.m2.1.1.1.1.1.1.2.2.cmml" xref="alg2.l5.m2.1.1.1.1.1.1.2.2">
               𝐬
              </ci>
              <apply id="alg2.l5.m2.1.1.1.1.1.1.2.3.cmml" xref="alg2.l5.m2.1.1.1.1.1.1.2.3">
               <csymbol cd="ambiguous" id="alg2.l5.m2.1.1.1.1.1.1.2.3.1.cmml" xref="alg2.l5.m2.1.1.1.1.1.1.2.3">
                superscript
               </csymbol>
               <ci id="alg2.l5.m2.1.1.1.1.1.1.2.3.2.cmml" xref="alg2.l5.m2.1.1.1.1.1.1.2.3.2">
                𝑇
               </ci>
               <ci id="alg2.l5.m2.1.1.1.1.1.1.2.3.3.cmml" xref="alg2.l5.m2.1.1.1.1.1.1.2.3.3">
                ′
               </ci>
              </apply>
             </apply>
             <ci id="alg2.l5.m2.1.1.1.1.1.1.3.cmml" xref="alg2.l5.m2.1.1.1.1.1.1.3">
              𝑖
             </ci>
            </apply>
            <apply id="alg2.l5.m2.2.2.2.2.2.2.cmml" xref="alg2.l5.m2.2.2.2.2.2.2">
             <csymbol cd="ambiguous" id="alg2.l5.m2.2.2.2.2.2.2.1.cmml" xref="alg2.l5.m2.2.2.2.2.2.2">
              superscript
             </csymbol>
             <apply id="alg2.l5.m2.2.2.2.2.2.2.2.cmml" xref="alg2.l5.m2.2.2.2.2.2.2">
              <csymbol cd="ambiguous" id="alg2.l5.m2.2.2.2.2.2.2.2.1.cmml" xref="alg2.l5.m2.2.2.2.2.2.2">
               subscript
              </csymbol>
              <ci id="alg2.l5.m2.2.2.2.2.2.2.2.2.cmml" xref="alg2.l5.m2.2.2.2.2.2.2.2.2">
               𝐲
              </ci>
              <apply id="alg2.l5.m2.2.2.2.2.2.2.2.3.cmml" xref="alg2.l5.m2.2.2.2.2.2.2.2.3">
               <csymbol cd="ambiguous" id="alg2.l5.m2.2.2.2.2.2.2.2.3.1.cmml" xref="alg2.l5.m2.2.2.2.2.2.2.2.3">
                superscript
               </csymbol>
               <ci id="alg2.l5.m2.2.2.2.2.2.2.2.3.2.cmml" xref="alg2.l5.m2.2.2.2.2.2.2.2.3.2">
                𝑇
               </ci>
               <ci id="alg2.l5.m2.2.2.2.2.2.2.2.3.3.cmml" xref="alg2.l5.m2.2.2.2.2.2.2.2.3.3">
                ′
               </ci>
              </apply>
             </apply>
             <ci id="alg2.l5.m2.2.2.2.2.2.2.3.cmml" xref="alg2.l5.m2.2.2.2.2.2.2.3">
              𝑖
             </ci>
            </apply>
           </interval>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l5.m2.2c">
         \mathbf{r}_{T^{\prime}}^{i}\leftarrow\text{env.step}(\mathbf{s}_{T^{\prime}}^{i},\mathbf{y}_{T^{\prime}}^{i})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg2.l6">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l6.1.1.1" style="font-size:80%;">
        6:
       </span>
      </span>
      <math alttext="f_{T^{\prime}}^{i}=\text{retry message}+x^{i}" class="ltx_Math" display="inline" id="alg2.l6.m1.1">
       <semantics id="alg2.l6.m1.1a">
        <mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">
         <msubsup id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml">
          <mi id="alg2.l6.m1.1.1.2.2.2" xref="alg2.l6.m1.1.1.2.2.2.cmml">
           f
          </mi>
          <msup id="alg2.l6.m1.1.1.2.2.3" xref="alg2.l6.m1.1.1.2.2.3.cmml">
           <mi id="alg2.l6.m1.1.1.2.2.3.2" xref="alg2.l6.m1.1.1.2.2.3.2.cmml">
            T
           </mi>
           <mo id="alg2.l6.m1.1.1.2.2.3.3" xref="alg2.l6.m1.1.1.2.2.3.3.cmml">
            ′
           </mo>
          </msup>
          <mi id="alg2.l6.m1.1.1.2.3" xref="alg2.l6.m1.1.1.2.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="alg2.l6.m1.1.1.1" xref="alg2.l6.m1.1.1.1.cmml">
          =
         </mo>
         <mrow id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml">
          <mtext id="alg2.l6.m1.1.1.3.2" xref="alg2.l6.m1.1.1.3.2a.cmml">
           retry message
          </mtext>
          <mo id="alg2.l6.m1.1.1.3.1" xref="alg2.l6.m1.1.1.3.1.cmml">
           +
          </mo>
          <msup id="alg2.l6.m1.1.1.3.3" xref="alg2.l6.m1.1.1.3.3.cmml">
           <mi id="alg2.l6.m1.1.1.3.3.2" xref="alg2.l6.m1.1.1.3.3.2.cmml">
            x
           </mi>
           <mi id="alg2.l6.m1.1.1.3.3.3" xref="alg2.l6.m1.1.1.3.3.3.cmml">
            i
           </mi>
          </msup>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b">
         <apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">
          <eq id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1">
          </eq>
          <apply id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2">
           <csymbol cd="ambiguous" id="alg2.l6.m1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1.2">
            superscript
           </csymbol>
           <apply id="alg2.l6.m1.1.1.2.2.cmml" xref="alg2.l6.m1.1.1.2">
            <csymbol cd="ambiguous" id="alg2.l6.m1.1.1.2.2.1.cmml" xref="alg2.l6.m1.1.1.2">
             subscript
            </csymbol>
            <ci id="alg2.l6.m1.1.1.2.2.2.cmml" xref="alg2.l6.m1.1.1.2.2.2">
             𝑓
            </ci>
            <apply id="alg2.l6.m1.1.1.2.2.3.cmml" xref="alg2.l6.m1.1.1.2.2.3">
             <csymbol cd="ambiguous" id="alg2.l6.m1.1.1.2.2.3.1.cmml" xref="alg2.l6.m1.1.1.2.2.3">
              superscript
             </csymbol>
             <ci id="alg2.l6.m1.1.1.2.2.3.2.cmml" xref="alg2.l6.m1.1.1.2.2.3.2">
              𝑇
             </ci>
             <ci id="alg2.l6.m1.1.1.2.2.3.3.cmml" xref="alg2.l6.m1.1.1.2.2.3.3">
              ′
             </ci>
            </apply>
           </apply>
           <ci id="alg2.l6.m1.1.1.2.3.cmml" xref="alg2.l6.m1.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <apply id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">
           <plus id="alg2.l6.m1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.3.1">
           </plus>
           <ci id="alg2.l6.m1.1.1.3.2a.cmml" xref="alg2.l6.m1.1.1.3.2">
            <mtext id="alg2.l6.m1.1.1.3.2.cmml" xref="alg2.l6.m1.1.1.3.2">
             retry message
            </mtext>
           </ci>
           <apply id="alg2.l6.m1.1.1.3.3.cmml" xref="alg2.l6.m1.1.1.3.3">
            <csymbol cd="ambiguous" id="alg2.l6.m1.1.1.3.3.1.cmml" xref="alg2.l6.m1.1.1.3.3">
             superscript
            </csymbol>
            <ci id="alg2.l6.m1.1.1.3.3.2.cmml" xref="alg2.l6.m1.1.1.3.3.2">
             𝑥
            </ci>
            <ci id="alg2.l6.m1.1.1.3.3.3.cmml" xref="alg2.l6.m1.1.1.3.3.3">
             𝑖
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l6.m1.1c">
         f_{T^{\prime}}^{i}=\text{retry message}+x^{i}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg2.l7">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l7.1.1.1" style="font-size:80%;">
        7:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l7.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l7.3">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg2.l8">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l8.1.1.1" style="font-size:80%;">
        8:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l8.2">
       for
      </span>
      step
      <math alttext="T^{\prime}" class="ltx_Math" display="inline" id="alg2.l8.m1.1">
       <semantics id="alg2.l8.m1.1a">
        <msup id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml">
         <mi id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">
          T
         </mi>
         <mo id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml">
          ′
         </mo>
        </msup>
        <annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b">
         <apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">
          <csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1">
           superscript
          </csymbol>
          <ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">
           𝑇
          </ci>
          <ci id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3">
           ′
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l8.m1.1c">
         T^{\prime}
        </annotation>
       </semantics>
      </math>
      in
      <math alttext="\left\{1,\ldots,N\right\}" class="ltx_Math" display="inline" id="alg2.l8.m2.3">
       <semantics id="alg2.l8.m2.3a">
        <mrow id="alg2.l8.m2.3.4.2" xref="alg2.l8.m2.3.4.1.cmml">
         <mo id="alg2.l8.m2.3.4.2.1" xref="alg2.l8.m2.3.4.1.cmml">
          {
         </mo>
         <mn id="alg2.l8.m2.1.1" xref="alg2.l8.m2.1.1.cmml">
          1
         </mn>
         <mo id="alg2.l8.m2.3.4.2.2" xref="alg2.l8.m2.3.4.1.cmml">
          ,
         </mo>
         <mi id="alg2.l8.m2.2.2" mathvariant="normal" xref="alg2.l8.m2.2.2.cmml">
          …
         </mi>
         <mo id="alg2.l8.m2.3.4.2.3" xref="alg2.l8.m2.3.4.1.cmml">
          ,
         </mo>
         <mi id="alg2.l8.m2.3.3" xref="alg2.l8.m2.3.3.cmml">
          N
         </mi>
         <mo id="alg2.l8.m2.3.4.2.4" xref="alg2.l8.m2.3.4.1.cmml">
          }
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l8.m2.3b">
         <set id="alg2.l8.m2.3.4.1.cmml" xref="alg2.l8.m2.3.4.2">
          <cn id="alg2.l8.m2.1.1.cmml" type="integer" xref="alg2.l8.m2.1.1">
           1
          </cn>
          <ci id="alg2.l8.m2.2.2.cmml" xref="alg2.l8.m2.2.2">
           …
          </ci>
          <ci id="alg2.l8.m2.3.3.cmml" xref="alg2.l8.m2.3.3">
           𝑁
          </ci>
         </set>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l8.m2.3c">
         \left\{1,\ldots,N\right\}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg2.l8.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg2.l9">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l9.1.1.1" style="font-size:80%;">
        9:
       </span>
      </span>
      <math alttext="\tilde{y}_{T^{\prime}}^{i}\leftarrow\text{majority voting}\{y_{t}^{i}\}_{t=1}^{T^{\prime}}" class="ltx_Math" display="inline" id="alg2.l9.m1.1">
       <semantics id="alg2.l9.m1.1a">
        <mrow id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml">
         <msubsup id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml">
          <mover accent="true" id="alg2.l9.m1.1.1.3.2.2" xref="alg2.l9.m1.1.1.3.2.2.cmml">
           <mi id="alg2.l9.m1.1.1.3.2.2.2" xref="alg2.l9.m1.1.1.3.2.2.2.cmml">
            y
           </mi>
           <mo id="alg2.l9.m1.1.1.3.2.2.1" xref="alg2.l9.m1.1.1.3.2.2.1.cmml">
            ~
           </mo>
          </mover>
          <msup id="alg2.l9.m1.1.1.3.2.3" xref="alg2.l9.m1.1.1.3.2.3.cmml">
           <mi id="alg2.l9.m1.1.1.3.2.3.2" xref="alg2.l9.m1.1.1.3.2.3.2.cmml">
            T
           </mi>
           <mo id="alg2.l9.m1.1.1.3.2.3.3" xref="alg2.l9.m1.1.1.3.2.3.3.cmml">
            ′
           </mo>
          </msup>
          <mi id="alg2.l9.m1.1.1.3.3" xref="alg2.l9.m1.1.1.3.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="alg2.l9.m1.1.1.2" stretchy="false" xref="alg2.l9.m1.1.1.2.cmml">
          ←
         </mo>
         <mrow id="alg2.l9.m1.1.1.1" xref="alg2.l9.m1.1.1.1.cmml">
          <mtext id="alg2.l9.m1.1.1.1.3" xref="alg2.l9.m1.1.1.1.3a.cmml">
           majority voting
          </mtext>
          <mo id="alg2.l9.m1.1.1.1.2" lspace="0em" rspace="0em" xref="alg2.l9.m1.1.1.1.2.cmml">
           ​
          </mo>
          <msubsup id="alg2.l9.m1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.cmml">
           <mrow id="alg2.l9.m1.1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.2.cmml">
            <mo id="alg2.l9.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg2.l9.m1.1.1.1.1.1.1.2.cmml">
             {
            </mo>
            <msubsup id="alg2.l9.m1.1.1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.cmml">
             <mi id="alg2.l9.m1.1.1.1.1.1.1.1.1.2.2" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.2.2.cmml">
              y
             </mi>
             <mi id="alg2.l9.m1.1.1.1.1.1.1.1.1.2.3" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.2.3.cmml">
              t
             </mi>
             <mi id="alg2.l9.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.3.cmml">
              i
             </mi>
            </msubsup>
            <mo id="alg2.l9.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg2.l9.m1.1.1.1.1.1.1.2.cmml">
             }
            </mo>
           </mrow>
           <mrow id="alg2.l9.m1.1.1.1.1.1.3" xref="alg2.l9.m1.1.1.1.1.1.3.cmml">
            <mi id="alg2.l9.m1.1.1.1.1.1.3.2" xref="alg2.l9.m1.1.1.1.1.1.3.2.cmml">
             t
            </mi>
            <mo id="alg2.l9.m1.1.1.1.1.1.3.1" xref="alg2.l9.m1.1.1.1.1.1.3.1.cmml">
             =
            </mo>
            <mn id="alg2.l9.m1.1.1.1.1.1.3.3" xref="alg2.l9.m1.1.1.1.1.1.3.3.cmml">
             1
            </mn>
           </mrow>
           <msup id="alg2.l9.m1.1.1.1.1.3" xref="alg2.l9.m1.1.1.1.1.3.cmml">
            <mi id="alg2.l9.m1.1.1.1.1.3.2" xref="alg2.l9.m1.1.1.1.1.3.2.cmml">
             T
            </mi>
            <mo id="alg2.l9.m1.1.1.1.1.3.3" xref="alg2.l9.m1.1.1.1.1.3.3.cmml">
             ′
            </mo>
           </msup>
          </msubsup>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b">
         <apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1">
          <ci id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2">
           ←
          </ci>
          <apply id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3">
           <csymbol cd="ambiguous" id="alg2.l9.m1.1.1.3.1.cmml" xref="alg2.l9.m1.1.1.3">
            superscript
           </csymbol>
           <apply id="alg2.l9.m1.1.1.3.2.cmml" xref="alg2.l9.m1.1.1.3">
            <csymbol cd="ambiguous" id="alg2.l9.m1.1.1.3.2.1.cmml" xref="alg2.l9.m1.1.1.3">
             subscript
            </csymbol>
            <apply id="alg2.l9.m1.1.1.3.2.2.cmml" xref="alg2.l9.m1.1.1.3.2.2">
             <ci id="alg2.l9.m1.1.1.3.2.2.1.cmml" xref="alg2.l9.m1.1.1.3.2.2.1">
              ~
             </ci>
             <ci id="alg2.l9.m1.1.1.3.2.2.2.cmml" xref="alg2.l9.m1.1.1.3.2.2.2">
              𝑦
             </ci>
            </apply>
            <apply id="alg2.l9.m1.1.1.3.2.3.cmml" xref="alg2.l9.m1.1.1.3.2.3">
             <csymbol cd="ambiguous" id="alg2.l9.m1.1.1.3.2.3.1.cmml" xref="alg2.l9.m1.1.1.3.2.3">
              superscript
             </csymbol>
             <ci id="alg2.l9.m1.1.1.3.2.3.2.cmml" xref="alg2.l9.m1.1.1.3.2.3.2">
              𝑇
             </ci>
             <ci id="alg2.l9.m1.1.1.3.2.3.3.cmml" xref="alg2.l9.m1.1.1.3.2.3.3">
              ′
             </ci>
            </apply>
           </apply>
           <ci id="alg2.l9.m1.1.1.3.3.cmml" xref="alg2.l9.m1.1.1.3.3">
            𝑖
           </ci>
          </apply>
          <apply id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1">
           <times id="alg2.l9.m1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.2">
           </times>
           <ci id="alg2.l9.m1.1.1.1.3a.cmml" xref="alg2.l9.m1.1.1.1.3">
            <mtext id="alg2.l9.m1.1.1.1.3.cmml" xref="alg2.l9.m1.1.1.1.3">
             majority voting
            </mtext>
           </ci>
           <apply id="alg2.l9.m1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1">
            <csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1">
             superscript
            </csymbol>
            <apply id="alg2.l9.m1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1">
             <csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1">
              subscript
             </csymbol>
             <set id="alg2.l9.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1">
              <apply id="alg2.l9.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1">
                superscript
               </csymbol>
               <apply id="alg2.l9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1">
                 subscript
                </csymbol>
                <ci id="alg2.l9.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.2.2">
                 𝑦
                </ci>
                <ci id="alg2.l9.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.2.3">
                 𝑡
                </ci>
               </apply>
               <ci id="alg2.l9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.3">
                𝑖
               </ci>
              </apply>
             </set>
             <apply id="alg2.l9.m1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.3">
              <eq id="alg2.l9.m1.1.1.1.1.1.3.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.3.1">
              </eq>
              <ci id="alg2.l9.m1.1.1.1.1.1.3.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.3.2">
               𝑡
              </ci>
              <cn id="alg2.l9.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg2.l9.m1.1.1.1.1.1.3.3">
               1
              </cn>
             </apply>
            </apply>
            <apply id="alg2.l9.m1.1.1.1.1.3.cmml" xref="alg2.l9.m1.1.1.1.1.3">
             <csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.3.1.cmml" xref="alg2.l9.m1.1.1.1.1.3">
              superscript
             </csymbol>
             <ci id="alg2.l9.m1.1.1.1.1.3.2.cmml" xref="alg2.l9.m1.1.1.1.1.3.2">
              𝑇
             </ci>
             <ci id="alg2.l9.m1.1.1.1.1.3.3.cmml" xref="alg2.l9.m1.1.1.1.1.3.3">
              ′
             </ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l9.m1.1c">
         \tilde{y}_{T^{\prime}}^{i}\leftarrow\text{majority voting}\{y_{t}^{i}\}_{t=1}^{T^{\prime}}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg2.l10">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l10.1.1.1" style="font-size:80%;">
        10:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l10.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l10.3">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg2.l11">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l11.1.1.1" style="font-size:80%;">
        11:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l11.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l11.3">
       for
      </span>
     </div>
    </div>
   </figure>
   <div class="ltx_pagination ltx_role_newpage">
   </div>
  </section>
  <section class="ltx_appendix" id="A4">
   <h3 class="ltx_title ltx_title_appendix">
    <span class="ltx_tag ltx_tag_appendix">
     Appendix D
    </span>
    Experimental Details
   </h3>
   <section class="ltx_subsection" id="A4.SS1">
    <h4 class="ltx_title ltx_title_subsection">
     <span class="ltx_tag ltx_tag_subsection">
      D.1
     </span>
     Hyperparameters for Fine-Tuning with RISE
    </h4>
    <div class="ltx_para ltx_noindent" id="A4.SS1.p1">
     <p class="ltx_p" id="A4.SS1.p1.1">
      For finetuning, we utilize the
      <a class="ltx_ref ltx_href" href="https://github.com/lm-sys/FastChat" target="_blank" title="">
       FastChat
      </a>
      codebase, but we customize the loss function to be weighted by reward. The base models are directly loaded from Hugging Face: hrefhttps://huggingface.co/meta-llama/Llama-2-7b-hfLlama-2-7b-chat-hf and
      <a class="ltx_ref ltx_href" href="https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2" target="_blank" title="">
       Mistral-7B-Instruct-v0.2
      </a>
      . The hyperparameters used for finetuning are specified in Table
      <a class="ltx_ref" href="#A4.T7" title="Table 7 ‣ D.1 Hyperparameters for Fine-Tuning with RISE ‣ Appendix D Experimental Details ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        7
       </span>
      </a>
      .
     </p>
    </div>
    <figure class="ltx_table" id="A4.T7">
     <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T7.2">
      <thead class="ltx_thead">
       <tr class="ltx_tr" id="A4.T7.2.1.1">
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A4.T7.2.1.1.1">
         <span class="ltx_text ltx_font_bold" id="A4.T7.2.1.1.1.1">
          Hyperparameter
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T7.2.1.1.2">
         <span class="ltx_text ltx_font_bold" id="A4.T7.2.1.1.2.1">
          Values
         </span>
        </th>
       </tr>
      </thead>
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="A4.T7.2.2.1">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A4.T7.2.2.1.1">
         bf16
        </th>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A4.T7.2.2.1.2">
         True
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T7.2.3.2">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T7.2.3.2.1">
         epochs
        </th>
        <td class="ltx_td ltx_align_center" id="A4.T7.2.3.2.2">
         2
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T7.2.4.3">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T7.2.4.3.1">
         per device train batch size
        </th>
        <td class="ltx_td ltx_align_center" id="A4.T7.2.4.3.2">
         1
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T7.2.5.4">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T7.2.5.4.1">
         gpus
        </th>
        <td class="ltx_td ltx_align_center" id="A4.T7.2.5.4.2">
         4xA40
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T7.2.6.5">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T7.2.6.5.1">
         gradient accumulation steps
        </th>
        <td class="ltx_td ltx_align_center" id="A4.T7.2.6.5.2">
         16
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T7.2.7.6">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T7.2.7.6.1">
         learning rate
        </th>
        <td class="ltx_td ltx_align_center" id="A4.T7.2.7.6.2">
         1e-5
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T7.2.8.7">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T7.2.8.7.1">
         weighted decay
        </th>
        <td class="ltx_td ltx_align_center" id="A4.T7.2.8.7.2">
         0
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T7.2.9.8">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T7.2.9.8.1">
         warmup ratio
        </th>
        <td class="ltx_td ltx_align_center" id="A4.T7.2.9.8.2">
         0.04
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T7.2.10.9">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T7.2.10.9.1">
         learning rate scheduler trype
        </th>
        <td class="ltx_td ltx_align_center" id="A4.T7.2.10.9.2">
         cosince
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T7.2.11.10">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T7.2.11.10.1">
         tf32
        </th>
        <td class="ltx_td ltx_align_center" id="A4.T7.2.11.10.2">
         True
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T7.2.12.11">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A4.T7.2.12.11.1">
         model max length
        </th>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.2.12.11.2">
         2048
        </td>
       </tr>
      </tbody>
     </table>
     <figcaption class="ltx_caption ltx_centering">
      <span class="ltx_tag ltx_tag_table">
       <span class="ltx_text" id="A4.T7.3.1.1" style="font-size:90%;">
        Table 7
       </span>
       :
      </span>
      <span class="ltx_text" id="A4.T7.4.2" style="font-size:90%;">
       Hyperparameters used for RISE
      </span>
     </figcaption>
    </figure>
   </section>
   <section class="ltx_subsection" id="A4.SS2">
    <h4 class="ltx_title ltx_title_subsection">
     <span class="ltx_tag ltx_tag_subsection">
      D.2
     </span>
     Inference Hyperparameters
    </h4>
    <div class="ltx_para ltx_noindent" id="A4.SS2.p1">
     <p class="ltx_p" id="A4.SS2.p1.1">
      For API-based models, such as GPT-3.5, we directly query the official web API provided by OpenAI. In the case of open-source models, we utilize
      <a class="ltx_ref ltx_href" href="https://github.com/lm-sys/FastChat" target="_blank" title="">
       FastChat
      </a>
      to serve the model as a web API and interact with the environment through API calls. Serving a 7B model requires a single A100 or A40 GPU. To control the randomness and length of answers generated by the LLMs, we employ the hyperparameters specified in Table
      <a class="ltx_ref" href="#A4.T8" title="Table 8 ‣ D.2 Inference Hyperparameters ‣ Appendix D Experimental Details ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
       <span class="ltx_text ltx_ref_tag">
        8
       </span>
      </a>
      .
     </p>
    </div>
    <figure class="ltx_table" id="A4.T8">
     <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T8.2">
      <thead class="ltx_thead">
       <tr class="ltx_tr" id="A4.T8.2.1.1">
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A4.T8.2.1.1.1">
         <span class="ltx_text ltx_font_bold" id="A4.T8.2.1.1.1.1">
          Hyperparameters/Description
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A4.T8.2.1.1.2">
         <span class="ltx_text ltx_font_bold" id="A4.T8.2.1.1.2.1">
          Open-source
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T8.2.1.1.3">
         <span class="ltx_text ltx_font_bold" id="A4.T8.2.1.1.3.1">
          GPT
         </span>
        </th>
       </tr>
      </thead>
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="A4.T8.2.2.1">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A4.T8.2.2.1.1">
         temperature
        </th>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T8.2.2.1.2">
         1.0
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A4.T8.2.2.1.3">
         0.7
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T8.2.3.2">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T8.2.3.2.1">
         top_p
        </th>
        <td class="ltx_td ltx_align_center ltx_border_r" id="A4.T8.2.3.2.2">
         1.0
        </td>
        <td class="ltx_td ltx_align_center" id="A4.T8.2.3.2.3">
         1
        </td>
       </tr>
       <tr class="ltx_tr" id="A4.T8.2.4.3">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A4.T8.2.4.3.1">
         max_new_tokens
        </th>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A4.T8.2.4.3.2">
         1000
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T8.2.4.3.3">
         512
        </td>
       </tr>
      </tbody>
     </table>
     <figcaption class="ltx_caption ltx_centering">
      <span class="ltx_tag ltx_tag_table">
       <span class="ltx_text" id="A4.T8.3.1.1" style="font-size:90%;">
        Table 8
       </span>
       :
      </span>
      <span class="ltx_text" id="A4.T8.4.2" style="font-size:90%;">
       The hyperparameter settings used for generating responses from open-source and the GPT models.
      </span>
     </figcaption>
    </figure>
   </section>
   <section class="ltx_subsection" id="A4.SS3">
    <h4 class="ltx_title ltx_title_subsection">
     <span class="ltx_tag ltx_tag_subsection">
      D.3
     </span>
     Datasets
    </h4>
    <div class="ltx_para ltx_noindent" id="A4.SS3.p1">
     <p class="ltx_p" id="A4.SS3.p1.1">
      The GSM8K dataset consists of 7,473 problems in the training portion and 1,319 problems in the testing portion. Similarly, the MATH dataset is divided into 7,500 problems for training and 1,000 problems for testing. The training portions of both datasets are used to generate trajectories in each iteration of the RISE method, while the testing portions are held out for evaluating the performance of the models. Additionally, the SVAMP dataset, containing 1,000 problems, is used solely for evaluation purposes to demonstrate the generalizability of our method.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="A4.SS3.p2">
     <p class="ltx_p" id="A4.SS3.p2.2">
      For generating training trajectories, at iteration
      <math alttext="i" class="ltx_Math" display="inline" id="A4.SS3.p2.1.m1.1">
       <semantics id="A4.SS3.p2.1.m1.1a">
        <mi id="A4.SS3.p2.1.m1.1.1" xref="A4.SS3.p2.1.m1.1.1.cmml">
         i
        </mi>
        <annotation-xml encoding="MathML-Content" id="A4.SS3.p2.1.m1.1b">
         <ci id="A4.SS3.p2.1.m1.1.1.cmml" xref="A4.SS3.p2.1.m1.1.1">
          𝑖
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A4.SS3.p2.1.m1.1c">
         i
        </annotation>
       </semantics>
      </math>
      , the current model is rolled out for a maximum of
      <math alttext="i" class="ltx_Math" display="inline" id="A4.SS3.p2.2.m2.1">
       <semantics id="A4.SS3.p2.2.m2.1a">
        <mi id="A4.SS3.p2.2.m2.1.1" xref="A4.SS3.p2.2.m2.1.1.cmml">
         i
        </mi>
        <annotation-xml encoding="MathML-Content" id="A4.SS3.p2.2.m2.1b">
         <ci id="A4.SS3.p2.2.m2.1.1.cmml" xref="A4.SS3.p2.2.m2.1.1">
          𝑖
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A4.SS3.p2.2.m2.1c">
         i
        </annotation>
       </semantics>
      </math>
      steps. Subsequently, an expert model, such as GPT-3.5, is employed to take the conversation history between the current model and the environment and sample 5 responses. Among these responses, the one with the highest reward is chosen, with arbitrary tie-breaking in case of multiple responses with the same highest reward.
     </p>
    </div>
   </section>
   <section class="ltx_subsection" id="A4.SS4">
    <h4 class="ltx_title ltx_title_subsection">
     <span class="ltx_tag ltx_tag_subsection">
      D.4
     </span>
     Prompts used for seeding RISE on the GSM8K and MATH tasks
    </h4>
    <div class="ltx_para ltx_noindent" id="A4.SS4.p1">
     <p class="ltx_p" id="A4.SS4.p1.1">
      Here we show the prompt we used for data generation and model evaluation:
     </p>
    </div>
    <figure class="ltx_figure" id="A4.F15">
     <svg class="ltx_picture" height="45341.08" id="A4.F15.pic1" overflow="visible" version="1.1" width="45341.08">
      <g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,45341.08) matrix(1 0 0 -1 0 0) translate(22670.54,0) translate(0,22670.54)">
       <clippath id="pgfcp6">
        <path d="M -22670.54 -22670.54 L 22670.54 -22670.54 L 22670.54 22670.54 L -22670.54 22670.54 Z M 0 5.91 L 0 217.01 C 0 220.27 2.64 222.92 5.91 222.92 L 594.09 222.92 C 597.36 222.92 600 220.27 600 217.01 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z">
        </path>
       </clippath>
       <g fill-rule="evenodd">
        <g fill="#0000BF" fill-opacity="1.0">
         <path d="M 0 5.91 L 0 217.01 C 0 220.27 2.64 222.92 5.91 222.92 L 594.09 222.92 C 597.36 222.92 600 220.27 600 217.01 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z M 1.97 5.91 L 1.97 195.69 L 598.03 195.69 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
         </path>
        </g>
        <g fill="#FFFFFF" fill-opacity="1.0">
         <path d="M 1.97 5.91 L 1.97 195.69 L 598.03 195.69 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
         </path>
        </g>
        <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 204.57)">
         <foreignobject color="#FFFFFF" height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
          <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.F15.pic1.15.15.15.15.1.1" style="width:410.8pt;">
           <span class="ltx_p" id="A4.F15.pic1.15.15.15.15.1.1.1">
            <span class="ltx_text ltx_font_bold" id="A4.F15.pic1.15.15.15.15.1.1.1.1">
             RISE
            </span>
           </span>
          </span>
         </foreignobject>
        </g>
        <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 15.81)">
         <foreignobject color="#000000" height="166.04" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
          <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.F15.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14" style="width:410.8pt;">
           <span class="ltx_p" id="A4.F15.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3">
            <span class="ltx_text ltx_font_bold" id="A4.F15.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1">
             System
            </span>
            : You are an AI language model designed to assist with math problem-solving. In this task, I will provide you with math problems. Your goal is to solve the problem step-by-step, showing your reasoning at each step. After you have finished solving the problem, present your final answer as
            <math alttext="\backslash" class="ltx_Math" display="inline" id="A4.F15.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1">
             <semantics id="A4.F15.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a">
              <mo id="A4.F15.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="A4.F15.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
               \
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b">
               <ci id="A4.F15.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A4.F15.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
                \
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">
               \backslash
              </annotation>
             </semantics>
            </math>
            boxed
            <math alttext="\{" class="ltx_Math" display="inline" id="A4.F15.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1">
             <semantics id="A4.F15.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1a">
              <mo id="A4.F15.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1" stretchy="false" xref="A4.F15.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.cmml">
               {
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1b">
               <ci id="A4.F15.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.cmml" xref="A4.F15.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1">
                {
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1c">
               \{
              </annotation>
             </semantics>
            </math>
            Your Answer
            <math alttext="\}" class="ltx_Math" display="inline" id="A4.F15.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1">
             <semantics id="A4.F15.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1a">
              <mo id="A4.F15.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1" stretchy="false" xref="A4.F15.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1.cmml">
               }
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1b">
               <ci id="A4.F15.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1.cmml" xref="A4.F15.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1">
                }
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1c">
               \}
              </annotation>
             </semantics>
            </math>
            .
           </span>
           <span class="ltx_p" id="A4.F15.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5">
            <math alttext="&lt;" class="ltx_Math" display="inline" id="A4.F15.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1">
             <semantics id="A4.F15.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1a">
              <mo id="A4.F15.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1.1" xref="A4.F15.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1.1.cmml">
               &lt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1b">
               <lt id="A4.F15.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1.1.cmml" xref="A4.F15.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1.1">
               </lt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1c">
               &lt;
              </annotation>
             </semantics>
            </math>
            <span class="ltx_text ltx_font_bold" id="A4.F15.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1">
             One-shot Example
             <a class="ltx_ref" href="#A4.F16" title="Figure 16 ‣ D.5 One-shot Example ‣ Appendix D Experimental Details ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
              <span class="ltx_text ltx_ref_tag">
               16
              </span>
             </a>
             <math alttext="&gt;" class="ltx_Math" display="inline" id="A4.F15.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1">
              <semantics id="A4.F15.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1a">
               <mo id="A4.F15.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1" xref="A4.F15.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1.cmml">
                &gt;
               </mo>
               <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1b">
                <gt id="A4.F15.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1.cmml" xref="A4.F15.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1">
                </gt>
               </annotation-xml>
               <annotation encoding="application/x-tex" id="A4.F15.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1c">
                &gt;
               </annotation>
              </semantics>
             </math>
            </span>
           </span>
           <span class="ltx_p" id="A4.F15.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7">
            <span class="ltx_text ltx_font_bold" id="A4.F15.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.1">
             User
            </span>
            :
            <math alttext="&lt;" class="ltx_Math" display="inline" id="A4.F15.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1">
             <semantics id="A4.F15.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1a">
              <mo id="A4.F15.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1.1" xref="A4.F15.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1.1.cmml">
               &lt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1b">
               <lt id="A4.F15.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1.1.cmml" xref="A4.F15.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1.1">
               </lt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1c">
               &lt;
              </annotation>
             </semantics>
            </math>
            Query
            <math alttext="&gt;" class="ltx_Math" display="inline" id="A4.F15.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1">
             <semantics id="A4.F15.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1a">
              <mo id="A4.F15.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1.1" xref="A4.F15.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1.1.cmml">
               &gt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1b">
               <gt id="A4.F15.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1.1.cmml" xref="A4.F15.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1.1">
               </gt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m2.1c">
               &gt;
              </annotation>
             </semantics>
            </math>
           </span>
           <span class="ltx_p" id="A4.F15.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9">
            <span class="ltx_text ltx_font_bold" id="A4.F15.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.1">
             Agent
            </span>
            :
            <math alttext="&lt;" class="ltx_Math" display="inline" id="A4.F15.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1">
             <semantics id="A4.F15.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1a">
              <mo id="A4.F15.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1.1" xref="A4.F15.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1.1.cmml">
               &lt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1b">
               <lt id="A4.F15.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1.1.cmml" xref="A4.F15.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1.1">
               </lt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.m1.1c">
               &lt;
              </annotation>
             </semantics>
            </math>
            Answer
            <math alttext="&gt;" class="ltx_Math" display="inline" id="A4.F15.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1">
             <semantics id="A4.F15.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1a">
              <mo id="A4.F15.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1.1" xref="A4.F15.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1.1.cmml">
               &gt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1b">
               <gt id="A4.F15.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1.1.cmml" xref="A4.F15.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1.1">
               </gt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.m2.1c">
               &gt;
              </annotation>
             </semantics>
            </math>
           </span>
           <span class="ltx_p" id="A4.F15.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11">
            <span class="ltx_text ltx_font_bold" id="A4.F15.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.1">
             User
            </span>
            : The answer is incorrect. Please try again. Here’s the question:
            <math alttext="&lt;" class="ltx_Math" display="inline" id="A4.F15.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1">
             <semantics id="A4.F15.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1a">
              <mo id="A4.F15.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1.1" xref="A4.F15.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1.1.cmml">
               &lt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1b">
               <lt id="A4.F15.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1.1.cmml" xref="A4.F15.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1.1">
               </lt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.m1.1c">
               &lt;
              </annotation>
             </semantics>
            </math>
            Query
            <math alttext="&gt;" class="ltx_Math" display="inline" id="A4.F15.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1">
             <semantics id="A4.F15.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1a">
              <mo id="A4.F15.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1.1" xref="A4.F15.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1.1.cmml">
               &gt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1b">
               <gt id="A4.F15.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1.1.cmml" xref="A4.F15.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1.1">
               </gt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.m2.1c">
               &gt;
              </annotation>
             </semantics>
            </math>
           </span>
           <span class="ltx_p" id="A4.F15.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13">
            <span class="ltx_text ltx_font_bold" id="A4.F15.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1">
             Agent
            </span>
            :
            <math alttext="&lt;" class="ltx_Math" display="inline" id="A4.F15.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1">
             <semantics id="A4.F15.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1a">
              <mo id="A4.F15.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1.1" xref="A4.F15.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1.1.cmml">
               &lt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1b">
               <lt id="A4.F15.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1.1.cmml" xref="A4.F15.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1.1">
               </lt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.m1.1c">
               &lt;
              </annotation>
             </semantics>
            </math>
            Answer
            <math alttext="&gt;" class="ltx_Math" display="inline" id="A4.F15.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1">
             <semantics id="A4.F15.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1a">
              <mo id="A4.F15.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1.1" xref="A4.F15.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1.1.cmml">
               &gt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1b">
               <gt id="A4.F15.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1.1.cmml" xref="A4.F15.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1.1">
               </gt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.m2.1c">
               &gt;
              </annotation>
             </semantics>
            </math>
           </span>
           <span class="ltx_p" id="A4.F15.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14">
            <math alttext="\cdots" class="ltx_Math" display="inline" id="A4.F15.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.m1.1">
             <semantics id="A4.F15.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.m1.1a">
              <mi id="A4.F15.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.m1.1.1" mathvariant="normal" xref="A4.F15.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.m1.1.1.cmml">
               ⋯
              </mi>
              <annotation-xml encoding="MathML-Content" id="A4.F15.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.m1.1b">
               <ci id="A4.F15.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.m1.1.1.cmml" xref="A4.F15.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.m1.1.1">
                ⋯
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F15.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.m1.1c">
               \cdots
              </annotation>
             </semantics>
            </math>
           </span>
          </span>
         </foreignobject>
        </g>
       </g>
      </g>
     </svg>
     <figcaption class="ltx_caption">
      <span class="ltx_tag ltx_tag_figure">
       <span class="ltx_text" id="A4.F15.3.1.1" style="font-size:90%;">
        Figure 15
       </span>
       :
      </span>
      <span class="ltx_text ltx_font_bold" id="A4.F15.4.2" style="font-size:90%;">
       Prompt for RISE
       <span class="ltx_text ltx_font_medium" id="A4.F15.4.2.1">
        : We follow the standard pipeline of math problem solving, prompt the LLM to solve the problem and retry untill exceeds the maximum number of turns
       </span>
      </span>
     </figcaption>
    </figure>
    <div class="ltx_pagination ltx_role_newpage">
    </div>
   </section>
   <section class="ltx_subsection" id="A4.SS5">
    <h4 class="ltx_title ltx_title_subsection">
     <span class="ltx_tag ltx_tag_subsection">
      D.5
     </span>
     One-shot Example
    </h4>
    <figure class="ltx_figure" id="A4.F16">
     <svg class="ltx_picture" height="45341.08" id="A4.F16.pic1" overflow="visible" version="1.1" width="45341.08">
      <g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,45341.08) matrix(1 0 0 -1 0 0) translate(22670.54,0) translate(0,22670.54)">
       <clippath id="pgfcp7">
        <path d="M -22670.54 -22670.54 L 22670.54 -22670.54 L 22670.54 22670.54 L -22670.54 22670.54 Z M 0 5.91 L 0 333.32 C 0 336.58 2.64 339.22 5.91 339.22 L 594.09 339.22 C 597.36 339.22 600 336.58 600 333.32 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z">
        </path>
       </clippath>
       <g fill-rule="evenodd">
        <g fill="#0000BF" fill-opacity="1.0">
         <path d="M 0 5.91 L 0 333.32 C 0 336.58 2.64 339.22 5.91 339.22 L 594.09 339.22 C 597.36 339.22 600 336.58 600 333.32 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z M 1.97 5.91 L 1.97 309.15 L 598.03 309.15 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
         </path>
        </g>
        <g fill="#FFFFFF" fill-opacity="1.0">
         <path d="M 1.97 5.91 L 1.97 309.15 L 598.03 309.15 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
         </path>
        </g>
        <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 318.04)">
         <foreignobject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
          <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.F16.pic1.5.5.5.5.1.1" style="width:410.8pt;">
           <span class="ltx_p" id="A4.F16.pic1.5.5.5.5.1.1.1">
            <span class="ltx_text ltx_font_bold" id="A4.F16.pic1.5.5.5.5.1.1.1.1">
             RISE One-shot example
            </span>
           </span>
          </span>
         </foreignobject>
        </g>
        <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 15.81)">
         <foreignobject color="#000000" height="279.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
          <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4" style="width:410.8pt;">
           <span class="ltx_p" id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.5">
            <span class="ltx_text ltx_font_bold" id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.5.1">
             User
            </span>
            : Of the 60 students in the drama club, 36 take mathematics, 27 take physics and 20 students take both mathematics and physics. How many drama club students take neither mathematics nor physics?
           </span>
           <span class="ltx_p" id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.6">
            <span class="ltx_text ltx_font_bold" id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.6.1">
             Agent
            </span>
            : 
Step 1: To find the number of drama club students who take neither mathematics nor physics, we first need to determine the number of students taking only math, only physics, and both math and physics.
           </span>
           <span class="ltx_p" id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.7">
            Step 2: Out of the 60 students in the drama club, 36 take mathematics and 27 take physics, and 20 students take both mathematics and physics.
           </span>
           <span class="ltx_p" id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.8">
            Step 3: To calculate the number of students taking only math, we subtract the number of students taking both from the total taking math: $36 - 20 = 16$.
           </span>
           <span class="ltx_p" id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.9">
            Step 4: Similarly, to calculate the number of students taking only physics, we subtract the number of students taking both from the total taking physics: $27 - 20 = 7$.
           </span>
           <span class="ltx_p" id="A4.F16.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
            Step 5: Now, to find the number of students taking neither math nor physics, we subtract the total number of students taking only math, only physics, and both from the total number of students in the drama club. This gives us $60 - 16 - 7 - 20 =
            <math alttext="\backslash" class="ltx_Math" display="inline" id="A4.F16.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1">
             <semantics id="A4.F16.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a">
              <mo id="A4.F16.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="A4.F16.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
               \
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F16.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b">
               <ci id="A4.F16.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A4.F16.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
                \
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F16.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">
               \backslash
              </annotation>
             </semantics>
            </math>
            boxed{17}$ students taking neither.
           </span>
           <span class="ltx_p" id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4">
            Answer:
            <math alttext="\backslash" class="ltx_Math" display="inline" id="A4.F16.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1">
             <semantics id="A4.F16.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1a">
              <mo id="A4.F16.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1" xref="A4.F16.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.cmml">
               \
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F16.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1b">
               <ci id="A4.F16.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.cmml" xref="A4.F16.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1">
                \
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F16.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1c">
               \backslash
              </annotation>
             </semantics>
            </math>
            boxed
            <math alttext="\{" class="ltx_Math" display="inline" id="A4.F16.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1">
             <semantics id="A4.F16.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1a">
              <mo id="A4.F16.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1.1" stretchy="false" xref="A4.F16.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1.1.cmml">
               {
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F16.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1b">
               <ci id="A4.F16.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1.1.cmml" xref="A4.F16.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1.1">
                {
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F16.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1c">
               \{
              </annotation>
             </semantics>
            </math>
            17
            <math alttext="\}" class="ltx_Math" display="inline" id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1">
             <semantics id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1a">
              <mo id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1.1" stretchy="false" xref="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1.1.cmml">
               }
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1b">
               <ci id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1.1.cmml" xref="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1.1">
                }
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F16.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1c">
               \}
              </annotation>
             </semantics>
            </math>
           </span>
          </span>
         </foreignobject>
        </g>
       </g>
      </g>
     </svg>
     <figcaption class="ltx_caption">
      <span class="ltx_tag ltx_tag_figure">
       <span class="ltx_text" id="A4.F16.3.1.1" style="font-size:90%;">
        Figure 16
       </span>
       :
      </span>
      <span class="ltx_text ltx_font_bold" id="A4.F16.4.2" style="font-size:90%;">
       One-shot Example
       <span class="ltx_text ltx_font_medium" id="A4.F16.4.2.1">
        : Demonstrates how to solve a math problem step-by-step and the expected answer format.
       </span>
      </span>
     </figcaption>
    </figure>
    <figure class="ltx_figure" id="A4.F17">
     <svg class="ltx_picture" height="45341.08" id="A4.F17.pic1" overflow="visible" version="1.1" width="45341.08">
      <g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,45341.08) matrix(1 0 0 -1 0 0) translate(22670.54,0) translate(0,22670.54)">
       <clippath id="pgfcp8">
        <path d="M -22670.54 -22670.54 L 22670.54 -22670.54 L 22670.54 22670.54 L -22670.54 22670.54 Z M 0 5.91 L 0 532.57 C 0 535.83 2.64 538.48 5.91 538.48 L 594.09 538.48 C 597.36 538.48 600 535.83 600 532.57 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z">
        </path>
       </clippath>
       <g fill-rule="evenodd">
        <g fill="#0000BF" fill-opacity="1.0">
         <path d="M 0 5.91 L 0 532.57 C 0 535.83 2.64 538.48 5.91 538.48 L 594.09 538.48 C 597.36 538.48 600 535.83 600 532.57 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z M 1.97 5.91 L 1.97 508.4 L 598.03 508.4 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
         </path>
        </g>
        <g fill="#FFFFFF" fill-opacity="1.0">
         <path d="M 1.97 5.91 L 1.97 508.4 L 598.03 508.4 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none">
         </path>
        </g>
        <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 517.29)">
         <foreignobject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
          <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.F17.pic1.7.7.7.7.1.1" style="width:410.8pt;">
           <span class="ltx_p" id="A4.F17.pic1.7.7.7.7.1.1.1">
            <span class="ltx_text ltx_font_bold" id="A4.F17.pic1.7.7.7.7.1.1.1.1">
             Self-Refine One-shot example
            </span>
           </span>
          </span>
         </foreignobject>
        </g>
        <g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 15.81 15.81)">
         <foreignobject color="#000000" height="478.76" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="568.39">
          <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6" style="width:410.8pt;">
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.7">
            <span class="ltx_text ltx_font_bold" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.7.1">
             User
            </span>
            : Of the 60 students in the drama club, 36 take mathematics, 27 take physics and 20 students take both mathematics and physics. How many drama club students take neither mathematics nor physics?
           </span>
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.8">
            <span class="ltx_text ltx_font_bold" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.8.1">
             Agent
            </span>
            :
Step 1: To find the number of drama club students who take neither mathematics nor physics, we first need to determine the number of students taking only math, only physics, and both math and physics.
           </span>
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.9">
            Step 2: Out of the 60 students in the drama club, 36 take mathematics and 27 take physics, and 20 students take both mathematics and physics.
           </span>
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.10">
            Step 3: To calculate the number of students taking only math, we subtract the number of students taking both from the total taking math: $36 - 20 = 16$.
           </span>
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.11">
            Step 4: Similarly, to calculate the number of students taking only physics, we subtract the number of students taking both from the total taking physics: $27 - 20 = 7$.
           </span>
           <span class="ltx_p" id="A4.F17.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
            Step 5: Now, to find the number of students taking neither math nor physics, we add the number of students taking only math and only physics, then subtract this sum from the total number of students in the drama club. This gives us $60 - (16 + 7) =
            <math alttext="\backslash" class="ltx_Math" display="inline" id="A4.F17.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1">
             <semantics id="A4.F17.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a">
              <mo id="A4.F17.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="A4.F17.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
               \
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F17.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b">
               <ci id="A4.F17.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A4.F17.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
                \
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F17.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">
               \backslash
              </annotation>
             </semantics>
            </math>
            boxed{37}$ students taking neither.
           </span>
           <span class="ltx_p" id="A4.F17.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4">
            Answer:
            <math alttext="\backslash" class="ltx_Math" display="inline" id="A4.F17.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1">
             <semantics id="A4.F17.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1a">
              <mo id="A4.F17.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1" xref="A4.F17.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.cmml">
               \
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F17.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1b">
               <ci id="A4.F17.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.cmml" xref="A4.F17.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1">
                \
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F17.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1c">
               \backslash
              </annotation>
             </semantics>
            </math>
            boxed
            <math alttext="\{" class="ltx_Math" display="inline" id="A4.F17.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1">
             <semantics id="A4.F17.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1a">
              <mo id="A4.F17.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1.1" stretchy="false" xref="A4.F17.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1.1.cmml">
               {
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F17.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1b">
               <ci id="A4.F17.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1.1.cmml" xref="A4.F17.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1.1">
                {
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F17.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m2.1c">
               \{
              </annotation>
             </semantics>
            </math>
            37
            <math alttext="\}" class="ltx_Math" display="inline" id="A4.F17.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1">
             <semantics id="A4.F17.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1a">
              <mo id="A4.F17.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1.1" stretchy="false" xref="A4.F17.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1.1.cmml">
               }
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F17.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1b">
               <ci id="A4.F17.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1.1.cmml" xref="A4.F17.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1.1">
                }
               </ci>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F17.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m3.1c">
               \}
              </annotation>
             </semantics>
            </math>
           </span>
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.12">
            <span class="ltx_text ltx_font_bold" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.12.1">
             User
            </span>
            : There is an error in the solution above because of lack of understanding of the question. What is the error? To find the error, go through each step of the solution, and check if everything looks good.
           </span>
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.13">
            <span class="ltx_text ltx_font_bold" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.13.1">
             Agent
            </span>
            :
Step 1: Correct. We need to find the number of students taking neither math nor physics.
           </span>
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.14">
            Step 2: Correct. The given information is accurately stated.
           </span>
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.15">
            Step 3: Correct. The calculation of students taking only math is correct.
           </span>
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.16">
            Step 4: Correct. The calculation of students taking only physics is correct.
           </span>
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.17">
            Step 5: Incorrect. The solution adds the number of students taking only math and only physics, but this does not account for the students taking both subjects. By subtracting this sum from the total number of students, the solution double-counts the students who take both math and physics.
           </span>
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.18">
            <span class="ltx_text ltx_font_bold" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.18.1">
             User
            </span>
            : Now, rewrite the solution in the required format:
           </span>
           <span class="ltx_p" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6">
            <span class="ltx_text ltx_font_bold" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.1">
             Agent
            </span>
            :
            <math alttext="&lt;" class="ltx_Math" display="inline" id="A4.F17.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m1.1">
             <semantics id="A4.F17.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m1.1a">
              <mo id="A4.F17.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m1.1.1" xref="A4.F17.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m1.1.1.cmml">
               &lt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F17.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m1.1b">
               <lt id="A4.F17.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m1.1.1.cmml" xref="A4.F17.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m1.1.1">
               </lt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F17.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m1.1c">
               &lt;
              </annotation>
             </semantics>
            </math>
            Same as
            <a class="ltx_ref" href="#A4.F16" title="Figure 16 ‣ D.5 One-shot Example ‣ Appendix D Experimental Details ‣ Appendices ‣ Recursive Introspection: Teaching Language Model Agents How to Self-Improve">
             <span class="ltx_text ltx_ref_tag">
              16
             </span>
            </a>
            <math alttext="&gt;" class="ltx_Math" display="inline" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m2.1">
             <semantics id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m2.1a">
              <mo id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m2.1.1" xref="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m2.1.1.cmml">
               &gt;
              </mo>
              <annotation-xml encoding="MathML-Content" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m2.1b">
               <gt id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m2.1.1.cmml" xref="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m2.1.1">
               </gt>
              </annotation-xml>
              <annotation encoding="application/x-tex" id="A4.F17.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m2.1c">
               &gt;
              </annotation>
             </semantics>
            </math>
           </span>
          </span>
         </foreignobject>
        </g>
       </g>
      </g>
     </svg>
     <figcaption class="ltx_caption">
      <span class="ltx_tag ltx_tag_figure">
       <span class="ltx_text" id="A4.F17.3.1.1" style="font-size:90%;">
        Figure 17
       </span>
       :
      </span>
      <span class="ltx_text ltx_font_bold" id="A4.F17.4.2" style="font-size:90%;">
       One-shot Example
       <span class="ltx_text ltx_font_medium" id="A4.F17.4.2.1">
        : Demonstrates the process of self-critique and error correction based on the self-critique.
       </span>
      </span>
     </figcaption>
    </figure>
    <div class="ltx_pagination ltx_role_newpage">
    </div>
   </section>
  </section>
 </section>
</article>
