<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2203.10474] Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data</title><meta property="og:description" content="In portraits, eyeglasses may occlude facial regions and generate cast shadows on faces, which degrades the performance of many techniques like face verification and expression recognition.
Portrait eyeglasses removal i…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2203.10474">

<!--Generated on Thu Feb 29 03:35:58 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Junfeng Lyu Zhibo Wang Feng Xu
<br class="ltx_break">School of Software and BNRist, Tsinghua University
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">In portraits, eyeglasses may occlude facial regions and generate cast shadows on faces, which degrades the performance of many techniques like face verification and expression recognition.
Portrait eyeglasses removal is critical in handling these problems. However, completely removing the eyeglasses is challenging because the lighting effects (<em id="id1.id1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="id1.id1.2" class="ltx_text"></span>, cast shadows) caused by them are often complex.
In this paper, we propose a novel framework to remove eyeglasses as well as their cast shadows from face images.
The method works in a detect-then-remove manner, in which eyeglasses and cast shadows are both detected and then removed from images. Due to the lack of paired data for supervised training, we present a new synthetic portrait dataset with both intermediate and final supervisions for both the detection and removal tasks. Furthermore, we apply a cross-domain technique to fill the gap between the synthetic and real data.
To the best of our knowledge, the proposed technique is the first to remove eyeglasses and their cast shadows simultaneously. The code and synthetic dataset are available at <a target="_blank" href="https://github.com/StoryMY/take-off-eyeglasses" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/StoryMY/take-off-eyeglasses</a>.</p>
</div>
<figure id="S0.F1" class="ltx_figure"><img src="/html/2203.10474/assets/opendoor-v9.jpg" id="S0.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="686" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S0.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S0.F1.3.2" class="ltx_text" style="font-size:90%;">Our method allows to remove eyeglasses and their shadows simultaneously. It produces photo-realistic results under various illuminations, head poses and eyeglasses with different shapes and textures.</span></figcaption>
</figure>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">A large portion of people wears eyeglasses in their daily lives. In their face photos, eyeglasses usually bring unwanted occlusions and cast shadows on faces, which lead to inaccuracy in many useful techniques like image-based face verification<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, expression recognition<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>, fatigue detection<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">etc</em>.
Besides, in photography, removing eyeglasses from portraits could be needed for aesthetic reasons, giving users a choice to edit their portraits. Therefore, it is beneficial to develop an automatic technique for portrait eyeglasses removal.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">However, completely removing eyeglasses suffers some key challenges. First, to recover the occluded facial region and keep it consistent with the remaining regions is a difficult task as facial skin has rich details and complex reflectance. Second, only recovering the occluded region cannot ensure visually convincing results as eyeglasses also bring various lighting effects (<em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S1.p2.1.2" class="ltx_text"></span>, cast shadows, reflections and distortions) on face regions.
Explicitly modeling these effects is extremely difficult as the physical rules to generate these effects are complicated. And it requires a delicate perception of the eyeglasses geometry, face geometry and lighting conditions, which are also difficult to obtain from a single portrait.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Recently, deep learning<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> has shown its great potential in handling tasks related to face editing<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, and has been successfully applied to portrait eyeglasses removal<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> with the help of the face datasets<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> containing eyeglasses labels. However, these techniques only focus on the eyeglasses but not the corresponding lighting effects.
ByeGlassesGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> constructs paired data containing some lighting effects for training. However, as it uses 2D methods to synthesize the data, the quality and realism are quite limited. Also, it does not take cast shadows into consideration.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we propose a novel eyeglasses removal technique using a synthetic dataset which considers 3D shadows and uses a cross-domain training strategy to fill the gap between synthetic and real data.
This method jointly removes eyeglasses and their cast shadows, generating more visually plausible results compared to the previous state-of-the-art methods.
In order to facilitate learning the relation between eyeglasses and cast shadows, we introduce a novel mask-guided multi-step network architecture for eyeglasses removal.
The proposed network first detects two masks for both eyeglasses and their cast shadows. Then, the estimated masks are used as guidance in the multi-step eyeglasses removal.
We observe that the shadows to be removed are caused by the eyeglasses, and we use this fact to carefully construct our network where the eyeglasses and shadows are handled in well-designed orders in both the detection and removal tasks. In this way, the network can well take eyeglasses as an important prior when dealing with the shadows.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">For training this network, we build a photo-realistic synthetic dataset using high-quality face scans collected by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> and 3D eyeglasses models made by artists, with principled BSDF<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> to achieve high rendering quality. This dataset contains a large amount of data for supervised training, covering various identities, expressions, eyeglasses, and illuminations. Another benefit of using the synthetic dataset is that we can synthesize images that cannot be captured in real world, i.e., images with eyeglasses but no shadows and images with shadows but no eyeglasses. These images can be used as intermediate supervisions to train the proposed network.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Although the accurate 3D information and the high-end rendering technique improve the photo-realism of our synthetic data, the network still cannot generalize well to real images due to the gap between the synthetic and real domain. Inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>, we develop a cross-domain segmentation module that leverages a real image dataset to build a uniform domain for both the real and synthetic images. This helps to prevent the proposed network from using domain-specific information to detect eyeglasses and their cast shadows.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">In summary, our main contributions are listed as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We design a novel mask-guided multi-step network architecture which is the first attempt in the literature to remove both eyeglasses and their cast shadows from portraits and achieves high realism.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We present a high-quality synthetic portrait dataset which provides both intermediate and final supervisions for training eyeglasses/shadows detection and removal networks.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We introduce a cross-domain segmentation module to enhance the generalization capability on real face images.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Eyeglasses Removal.</span> Early works<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib59" title="" class="ltx_ref">59</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> remove eyeglasses by statistical learning. The key assumption of these works is that the facial regions occluded by eyeglasses can be reconstructed from other faces without eyeglasses. However, these methods usually assume frontal faces and controlled environments, which limits their applications. Later works, <em id="S2.p1.1.2" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S2.p1.1.3" class="ltx_text"></span>, ERGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> and ByeGlassesGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, use deep neural networks in eyeglasses removal.
ERGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> proposes an unsupervised architecture for eyeglasses removal in the wild, while ByeGlassesGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> manually constructs paired data and propose a multi-task framework for eyeglasses detection and removal. These methods can successfully remove eyeglasses in more general application scenarios. However, cast shadows caused by eyeglasses are often ignored in both methods as they do not explore the connections between eyeglasses and cast shadows. Unlike these methods, we found that by developing an architecture to learn this connection, the network can remove the eyeglasses and their cast shadows at the same time, generating more visually convincing results.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2203.10474/assets/datasyn-v6.jpg" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="586" height="163" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.14.7.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S2.F2.12.6" class="ltx_text" style="font-size:90%;">Illustration of portrait synthesis. We define two fix nodes (red), two floating nodes (blue) on the registered face model and their corresponding vertices on each eyeglasses model. With node-based registration, we compute a plausible pose to align the eyeglasses model with the face scan. Then, we combine them with a HDR lighting to render our synthetic data: <math id="S2.F2.7.1.m1.1" class="ltx_Math" alttext="I_{syn}" display="inline"><semantics id="S2.F2.7.1.m1.1b"><msub id="S2.F2.7.1.m1.1.1" xref="S2.F2.7.1.m1.1.1.cmml"><mi id="S2.F2.7.1.m1.1.1.2" xref="S2.F2.7.1.m1.1.1.2.cmml">I</mi><mrow id="S2.F2.7.1.m1.1.1.3" xref="S2.F2.7.1.m1.1.1.3.cmml"><mi id="S2.F2.7.1.m1.1.1.3.2" xref="S2.F2.7.1.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F2.7.1.m1.1.1.3.1" xref="S2.F2.7.1.m1.1.1.3.1.cmml">​</mo><mi id="S2.F2.7.1.m1.1.1.3.3" xref="S2.F2.7.1.m1.1.1.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S2.F2.7.1.m1.1.1.3.1b" xref="S2.F2.7.1.m1.1.1.3.1.cmml">​</mo><mi id="S2.F2.7.1.m1.1.1.3.4" xref="S2.F2.7.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.F2.7.1.m1.1c"><apply id="S2.F2.7.1.m1.1.1.cmml" xref="S2.F2.7.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.7.1.m1.1.1.1.cmml" xref="S2.F2.7.1.m1.1.1">subscript</csymbol><ci id="S2.F2.7.1.m1.1.1.2.cmml" xref="S2.F2.7.1.m1.1.1.2">𝐼</ci><apply id="S2.F2.7.1.m1.1.1.3.cmml" xref="S2.F2.7.1.m1.1.1.3"><times id="S2.F2.7.1.m1.1.1.3.1.cmml" xref="S2.F2.7.1.m1.1.1.3.1"></times><ci id="S2.F2.7.1.m1.1.1.3.2.cmml" xref="S2.F2.7.1.m1.1.1.3.2">𝑠</ci><ci id="S2.F2.7.1.m1.1.1.3.3.cmml" xref="S2.F2.7.1.m1.1.1.3.3">𝑦</ci><ci id="S2.F2.7.1.m1.1.1.3.4.cmml" xref="S2.F2.7.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.7.1.m1.1d">I_{syn}</annotation></semantics></math>, <math id="S2.F2.8.2.m2.1" class="ltx_Math" alttext="I_{syn}^{g}" display="inline"><semantics id="S2.F2.8.2.m2.1b"><msubsup id="S2.F2.8.2.m2.1.1" xref="S2.F2.8.2.m2.1.1.cmml"><mi id="S2.F2.8.2.m2.1.1.2.2" xref="S2.F2.8.2.m2.1.1.2.2.cmml">I</mi><mrow id="S2.F2.8.2.m2.1.1.2.3" xref="S2.F2.8.2.m2.1.1.2.3.cmml"><mi id="S2.F2.8.2.m2.1.1.2.3.2" xref="S2.F2.8.2.m2.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F2.8.2.m2.1.1.2.3.1" xref="S2.F2.8.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S2.F2.8.2.m2.1.1.2.3.3" xref="S2.F2.8.2.m2.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S2.F2.8.2.m2.1.1.2.3.1b" xref="S2.F2.8.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S2.F2.8.2.m2.1.1.2.3.4" xref="S2.F2.8.2.m2.1.1.2.3.4.cmml">n</mi></mrow><mi id="S2.F2.8.2.m2.1.1.3" xref="S2.F2.8.2.m2.1.1.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.8.2.m2.1c"><apply id="S2.F2.8.2.m2.1.1.cmml" xref="S2.F2.8.2.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.8.2.m2.1.1.1.cmml" xref="S2.F2.8.2.m2.1.1">superscript</csymbol><apply id="S2.F2.8.2.m2.1.1.2.cmml" xref="S2.F2.8.2.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.8.2.m2.1.1.2.1.cmml" xref="S2.F2.8.2.m2.1.1">subscript</csymbol><ci id="S2.F2.8.2.m2.1.1.2.2.cmml" xref="S2.F2.8.2.m2.1.1.2.2">𝐼</ci><apply id="S2.F2.8.2.m2.1.1.2.3.cmml" xref="S2.F2.8.2.m2.1.1.2.3"><times id="S2.F2.8.2.m2.1.1.2.3.1.cmml" xref="S2.F2.8.2.m2.1.1.2.3.1"></times><ci id="S2.F2.8.2.m2.1.1.2.3.2.cmml" xref="S2.F2.8.2.m2.1.1.2.3.2">𝑠</ci><ci id="S2.F2.8.2.m2.1.1.2.3.3.cmml" xref="S2.F2.8.2.m2.1.1.2.3.3">𝑦</ci><ci id="S2.F2.8.2.m2.1.1.2.3.4.cmml" xref="S2.F2.8.2.m2.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S2.F2.8.2.m2.1.1.3.cmml" xref="S2.F2.8.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.2.m2.1d">I_{syn}^{g}</annotation></semantics></math>, <math id="S2.F2.9.3.m3.1" class="ltx_Math" alttext="I_{syn}^{s}" display="inline"><semantics id="S2.F2.9.3.m3.1b"><msubsup id="S2.F2.9.3.m3.1.1" xref="S2.F2.9.3.m3.1.1.cmml"><mi id="S2.F2.9.3.m3.1.1.2.2" xref="S2.F2.9.3.m3.1.1.2.2.cmml">I</mi><mrow id="S2.F2.9.3.m3.1.1.2.3" xref="S2.F2.9.3.m3.1.1.2.3.cmml"><mi id="S2.F2.9.3.m3.1.1.2.3.2" xref="S2.F2.9.3.m3.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F2.9.3.m3.1.1.2.3.1" xref="S2.F2.9.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S2.F2.9.3.m3.1.1.2.3.3" xref="S2.F2.9.3.m3.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S2.F2.9.3.m3.1.1.2.3.1b" xref="S2.F2.9.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S2.F2.9.3.m3.1.1.2.3.4" xref="S2.F2.9.3.m3.1.1.2.3.4.cmml">n</mi></mrow><mi id="S2.F2.9.3.m3.1.1.3" xref="S2.F2.9.3.m3.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.9.3.m3.1c"><apply id="S2.F2.9.3.m3.1.1.cmml" xref="S2.F2.9.3.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.9.3.m3.1.1.1.cmml" xref="S2.F2.9.3.m3.1.1">superscript</csymbol><apply id="S2.F2.9.3.m3.1.1.2.cmml" xref="S2.F2.9.3.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.9.3.m3.1.1.2.1.cmml" xref="S2.F2.9.3.m3.1.1">subscript</csymbol><ci id="S2.F2.9.3.m3.1.1.2.2.cmml" xref="S2.F2.9.3.m3.1.1.2.2">𝐼</ci><apply id="S2.F2.9.3.m3.1.1.2.3.cmml" xref="S2.F2.9.3.m3.1.1.2.3"><times id="S2.F2.9.3.m3.1.1.2.3.1.cmml" xref="S2.F2.9.3.m3.1.1.2.3.1"></times><ci id="S2.F2.9.3.m3.1.1.2.3.2.cmml" xref="S2.F2.9.3.m3.1.1.2.3.2">𝑠</ci><ci id="S2.F2.9.3.m3.1.1.2.3.3.cmml" xref="S2.F2.9.3.m3.1.1.2.3.3">𝑦</ci><ci id="S2.F2.9.3.m3.1.1.2.3.4.cmml" xref="S2.F2.9.3.m3.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S2.F2.9.3.m3.1.1.3.cmml" xref="S2.F2.9.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.9.3.m3.1d">I_{syn}^{s}</annotation></semantics></math>, <math id="S2.F2.10.4.m4.1" class="ltx_Math" alttext="I_{syn}^{f}" display="inline"><semantics id="S2.F2.10.4.m4.1b"><msubsup id="S2.F2.10.4.m4.1.1" xref="S2.F2.10.4.m4.1.1.cmml"><mi id="S2.F2.10.4.m4.1.1.2.2" xref="S2.F2.10.4.m4.1.1.2.2.cmml">I</mi><mrow id="S2.F2.10.4.m4.1.1.2.3" xref="S2.F2.10.4.m4.1.1.2.3.cmml"><mi id="S2.F2.10.4.m4.1.1.2.3.2" xref="S2.F2.10.4.m4.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F2.10.4.m4.1.1.2.3.1" xref="S2.F2.10.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S2.F2.10.4.m4.1.1.2.3.3" xref="S2.F2.10.4.m4.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S2.F2.10.4.m4.1.1.2.3.1b" xref="S2.F2.10.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S2.F2.10.4.m4.1.1.2.3.4" xref="S2.F2.10.4.m4.1.1.2.3.4.cmml">n</mi></mrow><mi id="S2.F2.10.4.m4.1.1.3" xref="S2.F2.10.4.m4.1.1.3.cmml">f</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.10.4.m4.1c"><apply id="S2.F2.10.4.m4.1.1.cmml" xref="S2.F2.10.4.m4.1.1"><csymbol cd="ambiguous" id="S2.F2.10.4.m4.1.1.1.cmml" xref="S2.F2.10.4.m4.1.1">superscript</csymbol><apply id="S2.F2.10.4.m4.1.1.2.cmml" xref="S2.F2.10.4.m4.1.1"><csymbol cd="ambiguous" id="S2.F2.10.4.m4.1.1.2.1.cmml" xref="S2.F2.10.4.m4.1.1">subscript</csymbol><ci id="S2.F2.10.4.m4.1.1.2.2.cmml" xref="S2.F2.10.4.m4.1.1.2.2">𝐼</ci><apply id="S2.F2.10.4.m4.1.1.2.3.cmml" xref="S2.F2.10.4.m4.1.1.2.3"><times id="S2.F2.10.4.m4.1.1.2.3.1.cmml" xref="S2.F2.10.4.m4.1.1.2.3.1"></times><ci id="S2.F2.10.4.m4.1.1.2.3.2.cmml" xref="S2.F2.10.4.m4.1.1.2.3.2">𝑠</ci><ci id="S2.F2.10.4.m4.1.1.2.3.3.cmml" xref="S2.F2.10.4.m4.1.1.2.3.3">𝑦</ci><ci id="S2.F2.10.4.m4.1.1.2.3.4.cmml" xref="S2.F2.10.4.m4.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S2.F2.10.4.m4.1.1.3.cmml" xref="S2.F2.10.4.m4.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.10.4.m4.1d">I_{syn}^{f}</annotation></semantics></math>, <math id="S2.F2.11.5.m5.1" class="ltx_Math" alttext="M_{syn}^{g}" display="inline"><semantics id="S2.F2.11.5.m5.1b"><msubsup id="S2.F2.11.5.m5.1.1" xref="S2.F2.11.5.m5.1.1.cmml"><mi id="S2.F2.11.5.m5.1.1.2.2" xref="S2.F2.11.5.m5.1.1.2.2.cmml">M</mi><mrow id="S2.F2.11.5.m5.1.1.2.3" xref="S2.F2.11.5.m5.1.1.2.3.cmml"><mi id="S2.F2.11.5.m5.1.1.2.3.2" xref="S2.F2.11.5.m5.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F2.11.5.m5.1.1.2.3.1" xref="S2.F2.11.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S2.F2.11.5.m5.1.1.2.3.3" xref="S2.F2.11.5.m5.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S2.F2.11.5.m5.1.1.2.3.1b" xref="S2.F2.11.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S2.F2.11.5.m5.1.1.2.3.4" xref="S2.F2.11.5.m5.1.1.2.3.4.cmml">n</mi></mrow><mi id="S2.F2.11.5.m5.1.1.3" xref="S2.F2.11.5.m5.1.1.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.11.5.m5.1c"><apply id="S2.F2.11.5.m5.1.1.cmml" xref="S2.F2.11.5.m5.1.1"><csymbol cd="ambiguous" id="S2.F2.11.5.m5.1.1.1.cmml" xref="S2.F2.11.5.m5.1.1">superscript</csymbol><apply id="S2.F2.11.5.m5.1.1.2.cmml" xref="S2.F2.11.5.m5.1.1"><csymbol cd="ambiguous" id="S2.F2.11.5.m5.1.1.2.1.cmml" xref="S2.F2.11.5.m5.1.1">subscript</csymbol><ci id="S2.F2.11.5.m5.1.1.2.2.cmml" xref="S2.F2.11.5.m5.1.1.2.2">𝑀</ci><apply id="S2.F2.11.5.m5.1.1.2.3.cmml" xref="S2.F2.11.5.m5.1.1.2.3"><times id="S2.F2.11.5.m5.1.1.2.3.1.cmml" xref="S2.F2.11.5.m5.1.1.2.3.1"></times><ci id="S2.F2.11.5.m5.1.1.2.3.2.cmml" xref="S2.F2.11.5.m5.1.1.2.3.2">𝑠</ci><ci id="S2.F2.11.5.m5.1.1.2.3.3.cmml" xref="S2.F2.11.5.m5.1.1.2.3.3">𝑦</ci><ci id="S2.F2.11.5.m5.1.1.2.3.4.cmml" xref="S2.F2.11.5.m5.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S2.F2.11.5.m5.1.1.3.cmml" xref="S2.F2.11.5.m5.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.11.5.m5.1d">M_{syn}^{g}</annotation></semantics></math> and <math id="S2.F2.12.6.m6.1" class="ltx_Math" alttext="M_{syn}^{s}" display="inline"><semantics id="S2.F2.12.6.m6.1b"><msubsup id="S2.F2.12.6.m6.1.1" xref="S2.F2.12.6.m6.1.1.cmml"><mi id="S2.F2.12.6.m6.1.1.2.2" xref="S2.F2.12.6.m6.1.1.2.2.cmml">M</mi><mrow id="S2.F2.12.6.m6.1.1.2.3" xref="S2.F2.12.6.m6.1.1.2.3.cmml"><mi id="S2.F2.12.6.m6.1.1.2.3.2" xref="S2.F2.12.6.m6.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F2.12.6.m6.1.1.2.3.1" xref="S2.F2.12.6.m6.1.1.2.3.1.cmml">​</mo><mi id="S2.F2.12.6.m6.1.1.2.3.3" xref="S2.F2.12.6.m6.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S2.F2.12.6.m6.1.1.2.3.1b" xref="S2.F2.12.6.m6.1.1.2.3.1.cmml">​</mo><mi id="S2.F2.12.6.m6.1.1.2.3.4" xref="S2.F2.12.6.m6.1.1.2.3.4.cmml">n</mi></mrow><mi id="S2.F2.12.6.m6.1.1.3" xref="S2.F2.12.6.m6.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.12.6.m6.1c"><apply id="S2.F2.12.6.m6.1.1.cmml" xref="S2.F2.12.6.m6.1.1"><csymbol cd="ambiguous" id="S2.F2.12.6.m6.1.1.1.cmml" xref="S2.F2.12.6.m6.1.1">superscript</csymbol><apply id="S2.F2.12.6.m6.1.1.2.cmml" xref="S2.F2.12.6.m6.1.1"><csymbol cd="ambiguous" id="S2.F2.12.6.m6.1.1.2.1.cmml" xref="S2.F2.12.6.m6.1.1">subscript</csymbol><ci id="S2.F2.12.6.m6.1.1.2.2.cmml" xref="S2.F2.12.6.m6.1.1.2.2">𝑀</ci><apply id="S2.F2.12.6.m6.1.1.2.3.cmml" xref="S2.F2.12.6.m6.1.1.2.3"><times id="S2.F2.12.6.m6.1.1.2.3.1.cmml" xref="S2.F2.12.6.m6.1.1.2.3.1"></times><ci id="S2.F2.12.6.m6.1.1.2.3.2.cmml" xref="S2.F2.12.6.m6.1.1.2.3.2">𝑠</ci><ci id="S2.F2.12.6.m6.1.1.2.3.3.cmml" xref="S2.F2.12.6.m6.1.1.2.3.3">𝑦</ci><ci id="S2.F2.12.6.m6.1.1.2.3.4.cmml" xref="S2.F2.12.6.m6.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S2.F2.12.6.m6.1.1.3.cmml" xref="S2.F2.12.6.m6.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.12.6.m6.1d">M_{syn}^{s}</annotation></semantics></math>.</span></figcaption>
</figure>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Face Attributes Manipulation.</span> Facial image manipulation techniques <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> have been developed rapidly in recent years. Most of them jointly solve multi-label<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> or multi-style<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> issues. DFI<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> manipulates face attributes via interpolation of different feature vectors. AttGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> manipulates facial images via attribute classification constraint and reconstruction learning. STGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> incorporates difference attribute vector and selective transfer units (STUs) for arbitrary attribute editing. HiSD<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> proposes a hierarchical style disentanglement framework for image-to-image translation, which organizes the labels using a hierarchical tree structure and overcomes the disadvantages of previous joint methods<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib51" title="" class="ltx_ref">51</a>, <a href="#bib.bib60" title="" class="ltx_ref">60</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>, <a href="#bib.bib62" title="" class="ltx_ref">62</a>, <a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>. Additionally, some works<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> combine 3D Morphable Model (3DMM) with StyleGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> to control facial images semantically. We found that manipulating external attributes (<em id="S2.p2.1.2" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S2.p2.1.3" class="ltx_text"></span>, hats or eyeglasses) is more difficult than manipulating internal attributes of faces as facial accessories often lead to occlusions or extra lighting effects (<em id="S2.p2.1.4" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S2.p2.1.5" class="ltx_text"></span>, cast shadows).
Unlike the previous works, we focus on eyeglasses removal and aim to remove not only the eyeglasses but also their corresponding cast shadows.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Domain Adaptation for Segmentation.</span> The majority of works in this task are usually designed for urban scenes. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> combines both global and local alignment with a domain adversarial training. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite> uses curriculum learning to address the domain adaptation. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> proposes an unsupervised method to adapt segmenters across different cities. Other works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> apply discriminators on the output space to align source and target segmentation, while <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite> utilizes a conservative loss to naturally seek the domain-invariant representations. FDA<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite> proposes a novel method that solves the domain adaptation via a simple Fourier Transform and its inverse. Based on the aforementioned methods, we additionally consider the relevance between the eyeglasses and cast shadows, and successfully bridge the gap between synthetic and real face images.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Portrait Synthesis with Eyeglasses</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In order to build paired data for supervised training, we use 3D rendering to generate synthetic images. As shown in <a href="#S2.F2" title="In 2 Related Works ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, we first make the face scan “wear” the 3D eyeglasses via node-based registration. Then, we render the scan with eyeglasses under a randomly chosen illumination. By setting the eyeglasses or their cast shadows to be visible or invisible, we can get four different types of rendered images. The masks of the eyeglasses and the cast shadows are also generated. Details are described as follows.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Data Preparation</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">For 3D face data, we directly use the dataset collected by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>. This dataset contains the face scans of 438 subjects with 20 expressions, varying from male to female and young to old. In addition to raw scans, we also acquire the registered face models with the same topology. For 3D eyeglasses models, we ask professional artists to create 21 eyeglasses models, which contain various shapes and textures.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Eyeglasses Alignment</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.5" class="ltx_p">In order to put eyeglasses on the plausible positions of the face, we manually label four anchor nodes (<math id="S3.SS2.p1.1.m1.6" class="ltx_Math" alttext="\boldsymbol{A}_{i},i\in\{1,2,3,4\}" display="inline"><semantics id="S3.SS2.p1.1.m1.6a"><mrow id="S3.SS2.p1.1.m1.6.6" xref="S3.SS2.p1.1.m1.6.6.cmml"><mrow id="S3.SS2.p1.1.m1.6.6.1.1" xref="S3.SS2.p1.1.m1.6.6.1.2.cmml"><msub id="S3.SS2.p1.1.m1.6.6.1.1.1" xref="S3.SS2.p1.1.m1.6.6.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.6.6.1.1.1.2" xref="S3.SS2.p1.1.m1.6.6.1.1.1.2.cmml">𝑨</mi><mi id="S3.SS2.p1.1.m1.6.6.1.1.1.3" xref="S3.SS2.p1.1.m1.6.6.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p1.1.m1.6.6.1.1.2" xref="S3.SS2.p1.1.m1.6.6.1.2.cmml">,</mo><mi id="S3.SS2.p1.1.m1.5.5" xref="S3.SS2.p1.1.m1.5.5.cmml">i</mi></mrow><mo id="S3.SS2.p1.1.m1.6.6.2" xref="S3.SS2.p1.1.m1.6.6.2.cmml">∈</mo><mrow id="S3.SS2.p1.1.m1.6.6.3.2" xref="S3.SS2.p1.1.m1.6.6.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.6.6.3.2.1" xref="S3.SS2.p1.1.m1.6.6.3.1.cmml">{</mo><mn id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">1</mn><mo id="S3.SS2.p1.1.m1.6.6.3.2.2" xref="S3.SS2.p1.1.m1.6.6.3.1.cmml">,</mo><mn id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml">2</mn><mo id="S3.SS2.p1.1.m1.6.6.3.2.3" xref="S3.SS2.p1.1.m1.6.6.3.1.cmml">,</mo><mn id="S3.SS2.p1.1.m1.3.3" xref="S3.SS2.p1.1.m1.3.3.cmml">3</mn><mo id="S3.SS2.p1.1.m1.6.6.3.2.4" xref="S3.SS2.p1.1.m1.6.6.3.1.cmml">,</mo><mn id="S3.SS2.p1.1.m1.4.4" xref="S3.SS2.p1.1.m1.4.4.cmml">4</mn><mo stretchy="false" id="S3.SS2.p1.1.m1.6.6.3.2.5" xref="S3.SS2.p1.1.m1.6.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.6b"><apply id="S3.SS2.p1.1.m1.6.6.cmml" xref="S3.SS2.p1.1.m1.6.6"><in id="S3.SS2.p1.1.m1.6.6.2.cmml" xref="S3.SS2.p1.1.m1.6.6.2"></in><list id="S3.SS2.p1.1.m1.6.6.1.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1"><apply id="S3.SS2.p1.1.m1.6.6.1.1.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.6.6.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.6.6.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.1.2">𝑨</ci><ci id="S3.SS2.p1.1.m1.6.6.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.p1.1.m1.5.5.cmml" xref="S3.SS2.p1.1.m1.5.5">𝑖</ci></list><set id="S3.SS2.p1.1.m1.6.6.3.1.cmml" xref="S3.SS2.p1.1.m1.6.6.3.2"><cn type="integer" id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">1</cn><cn type="integer" id="S3.SS2.p1.1.m1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2">2</cn><cn type="integer" id="S3.SS2.p1.1.m1.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3">3</cn><cn type="integer" id="S3.SS2.p1.1.m1.4.4.cmml" xref="S3.SS2.p1.1.m1.4.4">4</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.6c">\boldsymbol{A}_{i},i\in\{1,2,3,4\}</annotation></semantics></math>) on each eyeglasses model and their corresponding vertices (<math id="S3.SS2.p1.2.m2.6" class="ltx_Math" alttext="\boldsymbol{V}_{i},i\in\{1,2,3,4\}" display="inline"><semantics id="S3.SS2.p1.2.m2.6a"><mrow id="S3.SS2.p1.2.m2.6.6" xref="S3.SS2.p1.2.m2.6.6.cmml"><mrow id="S3.SS2.p1.2.m2.6.6.1.1" xref="S3.SS2.p1.2.m2.6.6.1.2.cmml"><msub id="S3.SS2.p1.2.m2.6.6.1.1.1" xref="S3.SS2.p1.2.m2.6.6.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.6.6.1.1.1.2" xref="S3.SS2.p1.2.m2.6.6.1.1.1.2.cmml">𝑽</mi><mi id="S3.SS2.p1.2.m2.6.6.1.1.1.3" xref="S3.SS2.p1.2.m2.6.6.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p1.2.m2.6.6.1.1.2" xref="S3.SS2.p1.2.m2.6.6.1.2.cmml">,</mo><mi id="S3.SS2.p1.2.m2.5.5" xref="S3.SS2.p1.2.m2.5.5.cmml">i</mi></mrow><mo id="S3.SS2.p1.2.m2.6.6.2" xref="S3.SS2.p1.2.m2.6.6.2.cmml">∈</mo><mrow id="S3.SS2.p1.2.m2.6.6.3.2" xref="S3.SS2.p1.2.m2.6.6.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.6.6.3.2.1" xref="S3.SS2.p1.2.m2.6.6.3.1.cmml">{</mo><mn id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">1</mn><mo id="S3.SS2.p1.2.m2.6.6.3.2.2" xref="S3.SS2.p1.2.m2.6.6.3.1.cmml">,</mo><mn id="S3.SS2.p1.2.m2.2.2" xref="S3.SS2.p1.2.m2.2.2.cmml">2</mn><mo id="S3.SS2.p1.2.m2.6.6.3.2.3" xref="S3.SS2.p1.2.m2.6.6.3.1.cmml">,</mo><mn id="S3.SS2.p1.2.m2.3.3" xref="S3.SS2.p1.2.m2.3.3.cmml">3</mn><mo id="S3.SS2.p1.2.m2.6.6.3.2.4" xref="S3.SS2.p1.2.m2.6.6.3.1.cmml">,</mo><mn id="S3.SS2.p1.2.m2.4.4" xref="S3.SS2.p1.2.m2.4.4.cmml">4</mn><mo stretchy="false" id="S3.SS2.p1.2.m2.6.6.3.2.5" xref="S3.SS2.p1.2.m2.6.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.6b"><apply id="S3.SS2.p1.2.m2.6.6.cmml" xref="S3.SS2.p1.2.m2.6.6"><in id="S3.SS2.p1.2.m2.6.6.2.cmml" xref="S3.SS2.p1.2.m2.6.6.2"></in><list id="S3.SS2.p1.2.m2.6.6.1.2.cmml" xref="S3.SS2.p1.2.m2.6.6.1.1"><apply id="S3.SS2.p1.2.m2.6.6.1.1.1.cmml" xref="S3.SS2.p1.2.m2.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.6.6.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.6.6.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.6.6.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.6.6.1.1.1.2">𝑽</ci><ci id="S3.SS2.p1.2.m2.6.6.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.6.6.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.p1.2.m2.5.5.cmml" xref="S3.SS2.p1.2.m2.5.5">𝑖</ci></list><set id="S3.SS2.p1.2.m2.6.6.3.1.cmml" xref="S3.SS2.p1.2.m2.6.6.3.2"><cn type="integer" id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">1</cn><cn type="integer" id="S3.SS2.p1.2.m2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2">2</cn><cn type="integer" id="S3.SS2.p1.2.m2.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3">3</cn><cn type="integer" id="S3.SS2.p1.2.m2.4.4.cmml" xref="S3.SS2.p1.2.m2.4.4">4</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.6c">\boldsymbol{V}_{i},i\in\{1,2,3,4\}</annotation></semantics></math>) on the template face model used for registration. Specifically, these four nodes consist of two fixed nodes on the face temples and two floating nodes on both sides of the nose as shown in <a href="#S2.F2" title="In 2 Related Works ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.
Then, we compute the rotation <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\boldsymbol{R}\in SO(3)" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.2" xref="S3.SS2.p1.3.m3.1.2.cmml"><mi id="S3.SS2.p1.3.m3.1.2.2" xref="S3.SS2.p1.3.m3.1.2.2.cmml">𝑹</mi><mo id="S3.SS2.p1.3.m3.1.2.1" xref="S3.SS2.p1.3.m3.1.2.1.cmml">∈</mo><mrow id="S3.SS2.p1.3.m3.1.2.3" xref="S3.SS2.p1.3.m3.1.2.3.cmml"><mi id="S3.SS2.p1.3.m3.1.2.3.2" xref="S3.SS2.p1.3.m3.1.2.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m3.1.2.3.1" xref="S3.SS2.p1.3.m3.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.3.m3.1.2.3.3" xref="S3.SS2.p1.3.m3.1.2.3.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m3.1.2.3.1a" xref="S3.SS2.p1.3.m3.1.2.3.1.cmml">​</mo><mrow id="S3.SS2.p1.3.m3.1.2.3.4.2" xref="S3.SS2.p1.3.m3.1.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.3.m3.1.2.3.4.2.1" xref="S3.SS2.p1.3.m3.1.2.3.cmml">(</mo><mn id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">3</mn><mo stretchy="false" id="S3.SS2.p1.3.m3.1.2.3.4.2.2" xref="S3.SS2.p1.3.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.2.cmml" xref="S3.SS2.p1.3.m3.1.2"><in id="S3.SS2.p1.3.m3.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.2.1"></in><ci id="S3.SS2.p1.3.m3.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.2.2">𝑹</ci><apply id="S3.SS2.p1.3.m3.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.2.3"><times id="S3.SS2.p1.3.m3.1.2.3.1.cmml" xref="S3.SS2.p1.3.m3.1.2.3.1"></times><ci id="S3.SS2.p1.3.m3.1.2.3.2.cmml" xref="S3.SS2.p1.3.m3.1.2.3.2">𝑆</ci><ci id="S3.SS2.p1.3.m3.1.2.3.3.cmml" xref="S3.SS2.p1.3.m3.1.2.3.3">𝑂</ci><cn type="integer" id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\boldsymbol{R}\in SO(3)</annotation></semantics></math>, the translation <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\boldsymbol{t}\in\mathbb{R}^{3}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">𝒕</mi><mo id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mn id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><in id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"></in><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝒕</ci><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2">ℝ</ci><cn type="integer" id="S3.SS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\boldsymbol{t}\in\mathbb{R}^{3}</annotation></semantics></math> and the scaling <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="s\in\mathbb{R}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">s</mi><mo id="S3.SS2.p1.5.m5.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.cmml">∈</mo><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><in id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1"></in><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝑠</ci><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">s\in\mathbb{R}</annotation></semantics></math> by minimizing the distance between the nodes and their corresponding vertices using Singular Value Decomposition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, expressed as</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="E(\boldsymbol{R},\boldsymbol{t},s;\boldsymbol{A}_{i},\boldsymbol{V}_{i})=\sum_{i=1}^{4}\|s\cdot\boldsymbol{R}\boldsymbol{A}_{i}+\boldsymbol{t}-\boldsymbol{V}_{i}\|^{2}_{2}." display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4.1" xref="S3.E1.m1.4.4.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml"><mi id="S3.E1.m1.4.4.1.1.2.4" xref="S3.E1.m1.4.4.1.1.2.4.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.3" xref="S3.E1.m1.4.4.1.1.2.3.cmml">​</mo><mrow id="S3.E1.m1.4.4.1.1.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.1.1.2.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝑹</mi><mo id="S3.E1.m1.4.4.1.1.2.2.2.4" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝒕</mi><mo id="S3.E1.m1.4.4.1.1.2.2.2.5" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml">,</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">s</mi><mo id="S3.E1.m1.4.4.1.1.2.2.2.6" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml">;</mo><msub id="S3.E1.m1.4.4.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.cmml">𝑨</mi><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.4.4.1.1.2.2.2.7" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml">,</mo><msub id="S3.E1.m1.4.4.1.1.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml">𝑽</mi><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.4.4.1.1.2.2.2.8" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E1.m1.4.4.1.1.4" xref="S3.E1.m1.4.4.1.1.4.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.3" xref="S3.E1.m1.4.4.1.1.3.cmml"><munderover id="S3.E1.m1.4.4.1.1.3.2" xref="S3.E1.m1.4.4.1.1.3.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E1.m1.4.4.1.1.3.2.2.2" xref="S3.E1.m1.4.4.1.1.3.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.4.4.1.1.3.2.2.3" xref="S3.E1.m1.4.4.1.1.3.2.2.3.cmml"><mi id="S3.E1.m1.4.4.1.1.3.2.2.3.2" xref="S3.E1.m1.4.4.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.4.4.1.1.3.2.2.3.1" xref="S3.E1.m1.4.4.1.1.3.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.4.4.1.1.3.2.2.3.3" xref="S3.E1.m1.4.4.1.1.3.2.2.3.3.cmml">1</mn></mrow><mn id="S3.E1.m1.4.4.1.1.3.2.3" xref="S3.E1.m1.4.4.1.1.3.2.3.cmml">4</mn></munderover><msubsup id="S3.E1.m1.4.4.1.1.3.1" xref="S3.E1.m1.4.4.1.1.3.1.cmml"><mrow id="S3.E1.m1.4.4.1.1.3.1.1.1.1" xref="S3.E1.m1.4.4.1.1.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.1.1.3.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.3.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.cmml"><mrow id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.cmml"><mrow id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.2.cmml">s</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.1" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.1.cmml">⋅</mo><mi id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.3.cmml">𝑹</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.1" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.1.cmml">​</mo><msub id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3.2" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3.2.cmml">𝑨</mi><mi id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.1" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.1.cmml">+</mo><mi id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.3" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.3.cmml">𝒕</mi></mrow><mo id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3.2" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3.2.cmml">𝑽</mi><mi id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3.3" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E1.m1.4.4.1.1.3.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1.m1.4.4.1.1.3.1.3" xref="S3.E1.m1.4.4.1.1.3.1.3.cmml">2</mn><mn id="S3.E1.m1.4.4.1.1.3.1.1.3" xref="S3.E1.m1.4.4.1.1.3.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo lspace="0em" id="S3.E1.m1.4.4.1.2" xref="S3.E1.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1"><eq id="S3.E1.m1.4.4.1.1.4.cmml" xref="S3.E1.m1.4.4.1.1.4"></eq><apply id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2"><times id="S3.E1.m1.4.4.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.3"></times><ci id="S3.E1.m1.4.4.1.1.2.4.cmml" xref="S3.E1.m1.4.4.1.1.2.4">𝐸</ci><vector id="S3.E1.m1.4.4.1.1.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑹</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝒕</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑠</ci><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2">𝑨</ci><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2">𝑽</ci><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.3">𝑖</ci></apply></vector></apply><apply id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3"><apply id="S3.E1.m1.4.4.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.2">superscript</csymbol><apply id="S3.E1.m1.4.4.1.1.3.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.2">subscript</csymbol><sum id="S3.E1.m1.4.4.1.1.3.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2.2.2"></sum><apply id="S3.E1.m1.4.4.1.1.3.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.3.2.2.3"><eq id="S3.E1.m1.4.4.1.1.3.2.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.2.2.3.1"></eq><ci id="S3.E1.m1.4.4.1.1.3.2.2.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.4.4.1.1.3.2.2.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.2.2.3.3">1</cn></apply></apply><cn type="integer" id="S3.E1.m1.4.4.1.1.3.2.3.cmml" xref="S3.E1.m1.4.4.1.1.3.2.3">4</cn></apply><apply id="S3.E1.m1.4.4.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.1.2.cmml" xref="S3.E1.m1.4.4.1.1.3.1">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.3.1.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.3.1">superscript</csymbol><apply id="S3.E1.m1.4.4.1.1.3.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.4.4.1.1.3.1.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1"><minus id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2"><plus id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.1"></plus><apply id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2"><times id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.1"></times><apply id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2"><ci id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.1">⋅</ci><ci id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.2">𝑠</ci><ci id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.2.3">𝑹</ci></apply><apply id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3.2">𝑨</ci><ci id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.2.3">𝒕</ci></apply><apply id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3.2">𝑽</ci><ci id="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.E1.m1.4.4.1.1.3.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3.1.1.3">2</cn></apply><cn type="integer" id="S3.E1.m1.4.4.1.1.3.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">E(\boldsymbol{R},\boldsymbol{t},s;\boldsymbol{A}_{i},\boldsymbol{V}_{i})=\sum_{i=1}^{4}\|s\cdot\boldsymbol{R}\boldsymbol{A}_{i}+\boldsymbol{t}-\boldsymbol{V}_{i}\|^{2}_{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">According to our observation, people put their eyeglasses on different nose positions. To enrich the wearing styles of our synthetic data, we define various candidate pairs of floating nodes in the nose region of the face template and randomly choose one pair for eyeglasses alignment. Also, we randomly change the color of eyeglasses to enrich their textures.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2203.10474/assets/pipeline2-v11.jpg" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="186" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.4.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.5.2" class="ltx_text" style="font-size:90%;">Illustration of the proposed network architecture.
<span id="S3.F3.5.2.1" class="ltx_text ltx_font_bold">(A)</span> Our network includes two stages: mask prediction stage and item removal stage. The mask prediction stage aims to estimate the eyeglasses mask and shadow mask via a cross-domain segmentation module. In the item removal stage, we successively employ a De-Shadow Network and a De-Glass Network to remove cast shadows and eyeglasses with the guidance of the two predicted masks.
<span id="S3.F3.5.2.2" class="ltx_text ltx_font_bold">(B)</span> In the cross-domain segmentation module, the Domain Adaptation (DA) Network normalizes the input images to uniform feature maps with the help of a discriminator. Then, the Glass Mask Network and Shadow Mask Network take the uniform feature maps to predict eyeglasses and shadows masks, respectively.
</span></figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Rendering Setting</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">The data variety and photo-realism are well considered in the portrait rendering. In detail, we first collect 367 HDR lightings from <span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_italic">Poly Heaven<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span id="footnote1.1.1.1" class="ltx_text ltx_font_upright">1</span></span><a target="_blank" href="https://polyhaven.com/" title="" class="ltx_ref ltx_href ltx_font_upright">https://polyhaven.com/</a></span></span></span></span> to increase the diversity of illuminations. During the rendering, the lighting variation is further augmented by setting a random rotation of the global scene. Besides, we render each face scan which randomly “wears” a pair of eyeglasses by a random head pose.
For photo-realistic synthesis, we use the principled BSDF implementation in Blender to render our synthetic data with the rendering setting empirically adjusted by a professional artist.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.6" class="ltx_p">For each rendering sample, we render four kinds of images with different visibility combinations of the eyeglasses and their cast shadows: <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="I_{syn}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">I</mi><mrow id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.1.3.1" xref="S3.SS3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.1.m1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.1.3.1a" xref="S3.SS3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.1.m1.1.1.3.4" xref="S3.SS3.p2.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝐼</ci><apply id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><times id="S3.SS3.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3.1"></times><ci id="S3.SS3.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.2">𝑠</ci><ci id="S3.SS3.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3">𝑦</ci><ci id="S3.SS3.p2.1.m1.1.1.3.4.cmml" xref="S3.SS3.p2.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">I_{syn}</annotation></semantics></math>, <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="I_{syn}^{g}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msubsup id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2.2" xref="S3.SS3.p2.2.m2.1.1.2.2.cmml">I</mi><mrow id="S3.SS3.p2.2.m2.1.1.2.3" xref="S3.SS3.p2.2.m2.1.1.2.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2.3.2" xref="S3.SS3.p2.2.m2.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.1.1.2.3.1" xref="S3.SS3.p2.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.2.m2.1.1.2.3.3" xref="S3.SS3.p2.2.m2.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.1.1.2.3.1a" xref="S3.SS3.p2.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.2.m2.1.1.2.3.4" xref="S3.SS3.p2.2.m2.1.1.2.3.4.cmml">n</mi></mrow><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">superscript</csymbol><apply id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2">𝐼</ci><apply id="S3.SS3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3"><times id="S3.SS3.p2.2.m2.1.1.2.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3.1"></times><ci id="S3.SS3.p2.2.m2.1.1.2.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3.2">𝑠</ci><ci id="S3.SS3.p2.2.m2.1.1.2.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3.3">𝑦</ci><ci id="S3.SS3.p2.2.m2.1.1.2.3.4.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">I_{syn}^{g}</annotation></semantics></math>, <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="I_{syn}^{s}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msubsup id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml">I</mi><mrow id="S3.SS3.p2.3.m3.1.1.2.3" xref="S3.SS3.p2.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.3.2" xref="S3.SS3.p2.3.m3.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.1.1.2.3.1" xref="S3.SS3.p2.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.3.m3.1.1.2.3.3" xref="S3.SS3.p2.3.m3.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.1.1.2.3.1a" xref="S3.SS3.p2.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.3.m3.1.1.2.3.4" xref="S3.SS3.p2.3.m3.1.1.2.3.4.cmml">n</mi></mrow><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">𝐼</ci><apply id="S3.SS3.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.3"><times id="S3.SS3.p2.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2.3.1"></times><ci id="S3.SS3.p2.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.3.2">𝑠</ci><ci id="S3.SS3.p2.3.m3.1.1.2.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.3.3">𝑦</ci><ci id="S3.SS3.p2.3.m3.1.1.2.3.4.cmml" xref="S3.SS3.p2.3.m3.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">I_{syn}^{s}</annotation></semantics></math>, <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="I_{syn}^{f}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msubsup id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2.2" xref="S3.SS3.p2.4.m4.1.1.2.2.cmml">I</mi><mrow id="S3.SS3.p2.4.m4.1.1.2.3" xref="S3.SS3.p2.4.m4.1.1.2.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2.3.2" xref="S3.SS3.p2.4.m4.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.4.m4.1.1.2.3.1" xref="S3.SS3.p2.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.4.m4.1.1.2.3.3" xref="S3.SS3.p2.4.m4.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.4.m4.1.1.2.3.1a" xref="S3.SS3.p2.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.4.m4.1.1.2.3.4" xref="S3.SS3.p2.4.m4.1.1.2.3.4.cmml">n</mi></mrow><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">f</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">superscript</csymbol><apply id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.2.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2.2">𝐼</ci><apply id="S3.SS3.p2.4.m4.1.1.2.3.cmml" xref="S3.SS3.p2.4.m4.1.1.2.3"><times id="S3.SS3.p2.4.m4.1.1.2.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.2.3.1"></times><ci id="S3.SS3.p2.4.m4.1.1.2.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2.3.2">𝑠</ci><ci id="S3.SS3.p2.4.m4.1.1.2.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.2.3.3">𝑦</ci><ci id="S3.SS3.p2.4.m4.1.1.2.3.4.cmml" xref="S3.SS3.p2.4.m4.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">I_{syn}^{f}</annotation></semantics></math>. The eyeglasses mask <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="M_{syn}^{g}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msubsup id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2.2" xref="S3.SS3.p2.5.m5.1.1.2.2.cmml">M</mi><mrow id="S3.SS3.p2.5.m5.1.1.2.3" xref="S3.SS3.p2.5.m5.1.1.2.3.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2.3.2" xref="S3.SS3.p2.5.m5.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.5.m5.1.1.2.3.1" xref="S3.SS3.p2.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.5.m5.1.1.2.3.3" xref="S3.SS3.p2.5.m5.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.5.m5.1.1.2.3.1a" xref="S3.SS3.p2.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.5.m5.1.1.2.3.4" xref="S3.SS3.p2.5.m5.1.1.2.3.4.cmml">n</mi></mrow><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">superscript</csymbol><apply id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.2.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2.2">𝑀</ci><apply id="S3.SS3.p2.5.m5.1.1.2.3.cmml" xref="S3.SS3.p2.5.m5.1.1.2.3"><times id="S3.SS3.p2.5.m5.1.1.2.3.1.cmml" xref="S3.SS3.p2.5.m5.1.1.2.3.1"></times><ci id="S3.SS3.p2.5.m5.1.1.2.3.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2.3.2">𝑠</ci><ci id="S3.SS3.p2.5.m5.1.1.2.3.3.cmml" xref="S3.SS3.p2.5.m5.1.1.2.3.3">𝑦</ci><ci id="S3.SS3.p2.5.m5.1.1.2.3.4.cmml" xref="S3.SS3.p2.5.m5.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">M_{syn}^{g}</annotation></semantics></math> and the shadow mask <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="M_{syn}^{s}" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><msubsup id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2.2" xref="S3.SS3.p2.6.m6.1.1.2.2.cmml">M</mi><mrow id="S3.SS3.p2.6.m6.1.1.2.3" xref="S3.SS3.p2.6.m6.1.1.2.3.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2.3.2" xref="S3.SS3.p2.6.m6.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.1.1.2.3.1" xref="S3.SS3.p2.6.m6.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.6.m6.1.1.2.3.3" xref="S3.SS3.p2.6.m6.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.1.1.2.3.1a" xref="S3.SS3.p2.6.m6.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.6.m6.1.1.2.3.4" xref="S3.SS3.p2.6.m6.1.1.2.3.4.cmml">n</mi></mrow><mi id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">superscript</csymbol><apply id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.2.1.cmml" xref="S3.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2.2">𝑀</ci><apply id="S3.SS3.p2.6.m6.1.1.2.3.cmml" xref="S3.SS3.p2.6.m6.1.1.2.3"><times id="S3.SS3.p2.6.m6.1.1.2.3.1.cmml" xref="S3.SS3.p2.6.m6.1.1.2.3.1"></times><ci id="S3.SS3.p2.6.m6.1.1.2.3.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2.3.2">𝑠</ci><ci id="S3.SS3.p2.6.m6.1.1.2.3.3.cmml" xref="S3.SS3.p2.6.m6.1.1.2.3.3">𝑦</ci><ci id="S3.SS3.p2.6.m6.1.1.2.3.4.cmml" xref="S3.SS3.p2.6.m6.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">M_{syn}^{s}</annotation></semantics></math> are also synthesized in the rendering.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Portrait Eyeglasses Removal Network</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The architecture of the proposed network is illustrated in <a href="#S3.F3" title="In 3.2 Eyeglasses Alignment ‣ 3 Portrait Synthesis with Eyeglasses ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>. Our network is designed based on the following considerations:
<span id="S4.p1.1.1" class="ltx_text ltx_font_italic">1)</span> ByeGlassesGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> improves eyeglasses removal with a parallel segmentation task, which has demonstrated the importance of mask prediction in eyeglasses removal.
Inspired by their method, we remove the eyeglasses in a more natural way by first explicitly detecting the eyeglasses in a <span id="S4.p1.1.2" class="ltx_text ltx_font_italic">mask prediction stage</span> and then removing eyeglasses with the guidance of predicted masks in an <span id="S4.p1.1.3" class="ltx_text ltx_font_italic">item removal stage</span>.
<span id="S4.p1.1.4" class="ltx_text ltx_font_italic">2)</span> We further enhance the eyeglasses removal performance by using a multi-step strategy in both above stages to treat the eyeglasses and their cast shadows in sequential order. Considering that the shadows to be removed are caused by eyeglasses, the eyeglasses should be a guidance in both shadow mask prediction and shadow removal.
<span id="S4.p1.1.5" class="ltx_text ltx_font_italic">3)</span> The proposed network is trained to remove eyeglasses using the synthetic dataset. To make it generalized to real images, we use a Domain Adaptation (DA) Network to convert the input images into uniform feature maps. The uniform feature maps eliminate the domain-specific information to confuse a discriminator but retain the structural information for eyeglasses and shadow mask prediction.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Mask Prediction Stage</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.3" class="ltx_p">Given an input portrait <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">I</annotation></semantics></math> with eyeglasses, our method estimates the eyeglasses mask <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\hat{M}^{g}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msup id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mover accent="true" id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.cmml">M</mi><mo id="S4.SS1.p1.2.m2.1.1.2.1" xref="S4.SS1.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">superscript</csymbol><apply id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"><ci id="S4.SS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2.1">^</ci><ci id="S4.SS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2">𝑀</ci></apply><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\hat{M}^{g}</annotation></semantics></math> and shadows mask <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="\hat{M}^{s}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><msup id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mover accent="true" id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2.2" xref="S4.SS1.p1.3.m3.1.1.2.2.cmml">M</mi><mo id="S4.SS1.p1.3.m3.1.1.2.1" xref="S4.SS1.p1.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">superscript</csymbol><apply id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2"><ci id="S4.SS1.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.p1.3.m3.1.1.2.1">^</ci><ci id="S4.SS1.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2.2">𝑀</ci></apply><ci id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\hat{M}^{s}</annotation></semantics></math> in the mask prediction stage using a cross-domain segmentation module. This module is composed of a DA Network, a Glass Mask Network and a Shadow Mask Network.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.5" class="ltx_p">In order to tackle the gap between synthetic and real domain, the DA Network is trained to transfer the input image <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">I</annotation></semantics></math> to a uniform domain, outputting the uniform feature map <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="\hat{F}" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mover accent="true" id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">F</mi><mo id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><ci id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1">^</ci><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\hat{F}</annotation></semantics></math>. Inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>, we apply adversarial learning to find the uniform domain assisted with a discriminator <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\mathcal{D}</annotation></semantics></math>. This discriminator <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">\mathcal{D}</annotation></semantics></math> is trained to distinguish whether the feature map <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="\hat{F}" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><mover accent="true" id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">F</mi><mo id="S4.SS1.p2.5.m5.1.1.1" xref="S4.SS1.p2.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><ci id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1.1">^</ci><ci id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">\hat{F}</annotation></semantics></math> is from a real image or a synthetic image while the DA Network aims to fool the discriminator. We utilize
LSGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite> for more stable training:</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.1" class="ltx_Math" alttext="\mathcal{L}^{\mathcal{D}}_{adv}=(\mathcal{D}(\hat{F}_{syn}))^{2}+(\mathcal{D}(\hat{F}_{real})-1)^{2}," display="block"><semantics id="S4.E2.m1.1a"><mrow id="S4.E2.m1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml"><msubsup id="S4.E2.m1.1.1.1.1.4" xref="S4.E2.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.1.1.1.1.4.2.2" xref="S4.E2.m1.1.1.1.1.4.2.2.cmml">ℒ</mi><mrow id="S4.E2.m1.1.1.1.1.4.3" xref="S4.E2.m1.1.1.1.1.4.3.cmml"><mi id="S4.E2.m1.1.1.1.1.4.3.2" xref="S4.E2.m1.1.1.1.1.4.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.4.3.1" xref="S4.E2.m1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.4.3.3" xref="S4.E2.m1.1.1.1.1.4.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.4.3.1a" xref="S4.E2.m1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.4.3.4" xref="S4.E2.m1.1.1.1.1.4.3.4.cmml">v</mi></mrow><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.1.1.1.1.4.2.3" xref="S4.E2.m1.1.1.1.1.4.2.3.cmml">𝒟</mi></msubsup><mo id="S4.E2.m1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E2.m1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.2.cmml"><msup id="S4.E2.m1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">F</mi><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1a" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">n</mi></mrow></msub><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E2.m1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E2.m1.1.1.1.1.2.3" xref="S4.E2.m1.1.1.1.1.2.3.cmml">+</mo><msup id="S4.E2.m1.1.1.1.1.2.2" xref="S4.E2.m1.1.1.1.1.2.2.cmml"><mrow id="S4.E2.m1.1.1.1.1.2.2.1.1" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.2.2.1.1.2" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.1.1.1.1.2.2.1.1.1" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.3.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.2.2" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.2.2.cmml">F</mi><mo id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.2.1" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.1" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.1a" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.4" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.1b" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.5" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.5.cmml">l</mi></mrow></msub><mo stretchy="false" id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.1.1.1.1.2.2.1.1.1.2" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.2.cmml">−</mo><mn id="S4.E2.m1.1.1.1.1.2.2.1.1.1.3" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E2.m1.1.1.1.1.2.2.1.1.3" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow><mn id="S4.E2.m1.1.1.1.1.2.2.3" xref="S4.E2.m1.1.1.1.1.2.2.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.E2.m1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><apply id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1"><eq id="S4.E2.m1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.3"></eq><apply id="S4.E2.m1.1.1.1.1.4.cmml" xref="S4.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.4.1.cmml" xref="S4.E2.m1.1.1.1.1.4">subscript</csymbol><apply id="S4.E2.m1.1.1.1.1.4.2.cmml" xref="S4.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.4.2.1.cmml" xref="S4.E2.m1.1.1.1.1.4">superscript</csymbol><ci id="S4.E2.m1.1.1.1.1.4.2.2.cmml" xref="S4.E2.m1.1.1.1.1.4.2.2">ℒ</ci><ci id="S4.E2.m1.1.1.1.1.4.2.3.cmml" xref="S4.E2.m1.1.1.1.1.4.2.3">𝒟</ci></apply><apply id="S4.E2.m1.1.1.1.1.4.3.cmml" xref="S4.E2.m1.1.1.1.1.4.3"><times id="S4.E2.m1.1.1.1.1.4.3.1.cmml" xref="S4.E2.m1.1.1.1.1.4.3.1"></times><ci id="S4.E2.m1.1.1.1.1.4.3.2.cmml" xref="S4.E2.m1.1.1.1.1.4.3.2">𝑎</ci><ci id="S4.E2.m1.1.1.1.1.4.3.3.cmml" xref="S4.E2.m1.1.1.1.1.4.3.3">𝑑</ci><ci id="S4.E2.m1.1.1.1.1.4.3.4.cmml" xref="S4.E2.m1.1.1.1.1.4.3.4">𝑣</ci></apply></apply><apply id="S4.E2.m1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.2"><plus id="S4.E2.m1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.1.1.1.1.2.3"></plus><apply id="S4.E2.m1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1"><times id="S4.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.3">𝒟</ci><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐹</ci></apply><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑦</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4">𝑛</ci></apply></apply></apply><cn type="integer" id="S4.E2.m1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.3">2</cn></apply><apply id="S4.E2.m1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.2.2">superscript</csymbol><apply id="S4.E2.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1"><minus id="S4.E2.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.2"></minus><apply id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1"><times id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.2"></times><ci id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.3">𝒟</ci><apply id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.2"><ci id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.2.2">𝐹</ci></apply><apply id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3"><times id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.4">𝑎</ci><ci id="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.5.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.5">𝑙</ci></apply></apply></apply><cn type="integer" id="S4.E2.m1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.2.2.1.1.1.3">1</cn></apply><cn type="integer" id="S4.E2.m1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.1.1.1.1.2.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">\mathcal{L}^{\mathcal{D}}_{adv}=(\mathcal{D}(\hat{F}_{syn}))^{2}+(\mathcal{D}(\hat{F}_{real})-1)^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.1" class="ltx_Math" alttext="\mathcal{L}^{\mathcal{G}}_{adv}=(\mathcal{D}(\hat{F}_{syn})-1)^{2}," display="block"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><msubsup id="S4.E3.m1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.1.1.1.1.3.2.2" xref="S4.E3.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S4.E3.m1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.3.3.cmml"><mi id="S4.E3.m1.1.1.1.1.3.3.2" xref="S4.E3.m1.1.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.3.3.1" xref="S4.E3.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E3.m1.1.1.1.1.3.3.3" xref="S4.E3.m1.1.1.1.1.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.3.3.1a" xref="S4.E3.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E3.m1.1.1.1.1.3.3.4" xref="S4.E3.m1.1.1.1.1.3.3.4.cmml">v</mi></mrow><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.1.1.1.1.3.2.3" xref="S4.E3.m1.1.1.1.1.3.2.3.cmml">𝒢</mi></msubsup><mo id="S4.E3.m1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.2.cmml">=</mo><msup id="S4.E3.m1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">F</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1a" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">n</mi></mrow></msub><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mn id="S4.E3.m1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E3.m1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><eq id="S4.E3.m1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.2"></eq><apply id="S4.E3.m1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3">subscript</csymbol><apply id="S4.E3.m1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.2.1.cmml" xref="S4.E3.m1.1.1.1.1.3">superscript</csymbol><ci id="S4.E3.m1.1.1.1.1.3.2.2.cmml" xref="S4.E3.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S4.E3.m1.1.1.1.1.3.2.3.cmml" xref="S4.E3.m1.1.1.1.1.3.2.3">𝒢</ci></apply><apply id="S4.E3.m1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3"><times id="S4.E3.m1.1.1.1.1.3.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3.3.1"></times><ci id="S4.E3.m1.1.1.1.1.3.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3.3.2">𝑎</ci><ci id="S4.E3.m1.1.1.1.1.3.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3">𝑑</ci><ci id="S4.E3.m1.1.1.1.1.3.3.4.cmml" xref="S4.E3.m1.1.1.1.1.3.3.4">𝑣</ci></apply></apply><apply id="S4.E3.m1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1"><minus id="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2"></minus><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1"><times id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3">𝒟</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐹</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑦</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4">𝑛</ci></apply></apply></apply><cn type="integer" id="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3">1</cn></apply><cn type="integer" id="S4.E3.m1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\mathcal{L}^{\mathcal{G}}_{adv}=(\mathcal{D}(\hat{F}_{syn})-1)^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.7" class="ltx_p">where <math id="S4.SS1.p2.6.m1.1" class="ltx_Math" alttext="\hat{F}_{real}" display="inline"><semantics id="S4.SS1.p2.6.m1.1a"><msub id="S4.SS1.p2.6.m1.1.1" xref="S4.SS1.p2.6.m1.1.1.cmml"><mover accent="true" id="S4.SS1.p2.6.m1.1.1.2" xref="S4.SS1.p2.6.m1.1.1.2.cmml"><mi id="S4.SS1.p2.6.m1.1.1.2.2" xref="S4.SS1.p2.6.m1.1.1.2.2.cmml">F</mi><mo id="S4.SS1.p2.6.m1.1.1.2.1" xref="S4.SS1.p2.6.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S4.SS1.p2.6.m1.1.1.3" xref="S4.SS1.p2.6.m1.1.1.3.cmml"><mi id="S4.SS1.p2.6.m1.1.1.3.2" xref="S4.SS1.p2.6.m1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.6.m1.1.1.3.1" xref="S4.SS1.p2.6.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p2.6.m1.1.1.3.3" xref="S4.SS1.p2.6.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.6.m1.1.1.3.1a" xref="S4.SS1.p2.6.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p2.6.m1.1.1.3.4" xref="S4.SS1.p2.6.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.6.m1.1.1.3.1b" xref="S4.SS1.p2.6.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p2.6.m1.1.1.3.5" xref="S4.SS1.p2.6.m1.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m1.1b"><apply id="S4.SS1.p2.6.m1.1.1.cmml" xref="S4.SS1.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m1.1.1.1.cmml" xref="S4.SS1.p2.6.m1.1.1">subscript</csymbol><apply id="S4.SS1.p2.6.m1.1.1.2.cmml" xref="S4.SS1.p2.6.m1.1.1.2"><ci id="S4.SS1.p2.6.m1.1.1.2.1.cmml" xref="S4.SS1.p2.6.m1.1.1.2.1">^</ci><ci id="S4.SS1.p2.6.m1.1.1.2.2.cmml" xref="S4.SS1.p2.6.m1.1.1.2.2">𝐹</ci></apply><apply id="S4.SS1.p2.6.m1.1.1.3.cmml" xref="S4.SS1.p2.6.m1.1.1.3"><times id="S4.SS1.p2.6.m1.1.1.3.1.cmml" xref="S4.SS1.p2.6.m1.1.1.3.1"></times><ci id="S4.SS1.p2.6.m1.1.1.3.2.cmml" xref="S4.SS1.p2.6.m1.1.1.3.2">𝑟</ci><ci id="S4.SS1.p2.6.m1.1.1.3.3.cmml" xref="S4.SS1.p2.6.m1.1.1.3.3">𝑒</ci><ci id="S4.SS1.p2.6.m1.1.1.3.4.cmml" xref="S4.SS1.p2.6.m1.1.1.3.4">𝑎</ci><ci id="S4.SS1.p2.6.m1.1.1.3.5.cmml" xref="S4.SS1.p2.6.m1.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m1.1c">\hat{F}_{real}</annotation></semantics></math> and <math id="S4.SS1.p2.7.m2.1" class="ltx_Math" alttext="\hat{F}_{syn}" display="inline"><semantics id="S4.SS1.p2.7.m2.1a"><msub id="S4.SS1.p2.7.m2.1.1" xref="S4.SS1.p2.7.m2.1.1.cmml"><mover accent="true" id="S4.SS1.p2.7.m2.1.1.2" xref="S4.SS1.p2.7.m2.1.1.2.cmml"><mi id="S4.SS1.p2.7.m2.1.1.2.2" xref="S4.SS1.p2.7.m2.1.1.2.2.cmml">F</mi><mo id="S4.SS1.p2.7.m2.1.1.2.1" xref="S4.SS1.p2.7.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S4.SS1.p2.7.m2.1.1.3" xref="S4.SS1.p2.7.m2.1.1.3.cmml"><mi id="S4.SS1.p2.7.m2.1.1.3.2" xref="S4.SS1.p2.7.m2.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.7.m2.1.1.3.1" xref="S4.SS1.p2.7.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p2.7.m2.1.1.3.3" xref="S4.SS1.p2.7.m2.1.1.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.7.m2.1.1.3.1a" xref="S4.SS1.p2.7.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p2.7.m2.1.1.3.4" xref="S4.SS1.p2.7.m2.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m2.1b"><apply id="S4.SS1.p2.7.m2.1.1.cmml" xref="S4.SS1.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m2.1.1.1.cmml" xref="S4.SS1.p2.7.m2.1.1">subscript</csymbol><apply id="S4.SS1.p2.7.m2.1.1.2.cmml" xref="S4.SS1.p2.7.m2.1.1.2"><ci id="S4.SS1.p2.7.m2.1.1.2.1.cmml" xref="S4.SS1.p2.7.m2.1.1.2.1">^</ci><ci id="S4.SS1.p2.7.m2.1.1.2.2.cmml" xref="S4.SS1.p2.7.m2.1.1.2.2">𝐹</ci></apply><apply id="S4.SS1.p2.7.m2.1.1.3.cmml" xref="S4.SS1.p2.7.m2.1.1.3"><times id="S4.SS1.p2.7.m2.1.1.3.1.cmml" xref="S4.SS1.p2.7.m2.1.1.3.1"></times><ci id="S4.SS1.p2.7.m2.1.1.3.2.cmml" xref="S4.SS1.p2.7.m2.1.1.3.2">𝑠</ci><ci id="S4.SS1.p2.7.m2.1.1.3.3.cmml" xref="S4.SS1.p2.7.m2.1.1.3.3">𝑦</ci><ci id="S4.SS1.p2.7.m2.1.1.3.4.cmml" xref="S4.SS1.p2.7.m2.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m2.1c">\hat{F}_{syn}</annotation></semantics></math> are the corresponding feature maps of real and synthetic data. Specifically, the DA Network consists of the first layer of
a pre-trained VGG encoder<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> with fixed parameters, combined with six trainable ResNet blocks<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> with instance normalization.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.9" class="ltx_p">We use a multi-step strategy to predict the eyeglasses mask <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\hat{M}^{g}" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><msup id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mover accent="true" id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2.2" xref="S4.SS1.p3.1.m1.1.1.2.2.cmml">M</mi><mo id="S4.SS1.p3.1.m1.1.1.2.1" xref="S4.SS1.p3.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2"><ci id="S4.SS1.p3.1.m1.1.1.2.1.cmml" xref="S4.SS1.p3.1.m1.1.1.2.1">^</ci><ci id="S4.SS1.p3.1.m1.1.1.2.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2.2">𝑀</ci></apply><ci id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\hat{M}^{g}</annotation></semantics></math> and the corresponding shadow mask <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="\hat{M}^{s}" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><msup id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mover accent="true" id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2.2" xref="S4.SS1.p3.2.m2.1.1.2.2.cmml">M</mi><mo id="S4.SS1.p3.2.m2.1.1.2.1" xref="S4.SS1.p3.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">superscript</csymbol><apply id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2"><ci id="S4.SS1.p3.2.m2.1.1.2.1.cmml" xref="S4.SS1.p3.2.m2.1.1.2.1">^</ci><ci id="S4.SS1.p3.2.m2.1.1.2.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2.2">𝑀</ci></apply><ci id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\hat{M}^{s}</annotation></semantics></math> from the uniform domain feature <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="\hat{F}" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mover accent="true" id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">F</mi><mo id="S4.SS1.p3.3.m3.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><ci id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1">^</ci><ci id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">\hat{F}</annotation></semantics></math>. Instead of extracting these two masks together using a single network, we first estimate the eyeglasses mask <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="\hat{M}^{g}" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><msup id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mover accent="true" id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2.2" xref="S4.SS1.p3.4.m4.1.1.2.2.cmml">M</mi><mo id="S4.SS1.p3.4.m4.1.1.2.1" xref="S4.SS1.p3.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">superscript</csymbol><apply id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2"><ci id="S4.SS1.p3.4.m4.1.1.2.1.cmml" xref="S4.SS1.p3.4.m4.1.1.2.1">^</ci><ci id="S4.SS1.p3.4.m4.1.1.2.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2.2">𝑀</ci></apply><ci id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">\hat{M}^{g}</annotation></semantics></math> using a Glass Mask Network. Then, the previous outputs <math id="S4.SS1.p3.5.m5.1" class="ltx_Math" alttext="\hat{F}" display="inline"><semantics id="S4.SS1.p3.5.m5.1a"><mover accent="true" id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml">F</mi><mo id="S4.SS1.p3.5.m5.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><ci id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1">^</ci><ci id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">\hat{F}</annotation></semantics></math> and <math id="S4.SS1.p3.6.m6.1" class="ltx_Math" alttext="\hat{M}^{g}" display="inline"><semantics id="S4.SS1.p3.6.m6.1a"><msup id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><mover accent="true" id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml"><mi id="S4.SS1.p3.6.m6.1.1.2.2" xref="S4.SS1.p3.6.m6.1.1.2.2.cmml">M</mi><mo id="S4.SS1.p3.6.m6.1.1.2.1" xref="S4.SS1.p3.6.m6.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p3.6.m6.1.1.3" xref="S4.SS1.p3.6.m6.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">superscript</csymbol><apply id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2"><ci id="S4.SS1.p3.6.m6.1.1.2.1.cmml" xref="S4.SS1.p3.6.m6.1.1.2.1">^</ci><ci id="S4.SS1.p3.6.m6.1.1.2.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2.2">𝑀</ci></apply><ci id="S4.SS1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">\hat{M}^{g}</annotation></semantics></math> are together fed into a Shadow Mask Network to predict the shadow mask <math id="S4.SS1.p3.7.m7.1" class="ltx_Math" alttext="\hat{M}^{s}" display="inline"><semantics id="S4.SS1.p3.7.m7.1a"><msup id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml"><mover accent="true" id="S4.SS1.p3.7.m7.1.1.2" xref="S4.SS1.p3.7.m7.1.1.2.cmml"><mi id="S4.SS1.p3.7.m7.1.1.2.2" xref="S4.SS1.p3.7.m7.1.1.2.2.cmml">M</mi><mo id="S4.SS1.p3.7.m7.1.1.2.1" xref="S4.SS1.p3.7.m7.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p3.7.m7.1.1.3" xref="S4.SS1.p3.7.m7.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.1b"><apply id="S4.SS1.p3.7.m7.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1">superscript</csymbol><apply id="S4.SS1.p3.7.m7.1.1.2.cmml" xref="S4.SS1.p3.7.m7.1.1.2"><ci id="S4.SS1.p3.7.m7.1.1.2.1.cmml" xref="S4.SS1.p3.7.m7.1.1.2.1">^</ci><ci id="S4.SS1.p3.7.m7.1.1.2.2.cmml" xref="S4.SS1.p3.7.m7.1.1.2.2">𝑀</ci></apply><ci id="S4.SS1.p3.7.m7.1.1.3.cmml" xref="S4.SS1.p3.7.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.1c">\hat{M}^{s}</annotation></semantics></math>, with the consideration that the eyeglasses masks could be a guidance in the shadow mask prediction.
We learn the eyeglasses mask <math id="S4.SS1.p3.8.m8.1" class="ltx_Math" alttext="M^{g}" display="inline"><semantics id="S4.SS1.p3.8.m8.1a"><msup id="S4.SS1.p3.8.m8.1.1" xref="S4.SS1.p3.8.m8.1.1.cmml"><mi id="S4.SS1.p3.8.m8.1.1.2" xref="S4.SS1.p3.8.m8.1.1.2.cmml">M</mi><mi id="S4.SS1.p3.8.m8.1.1.3" xref="S4.SS1.p3.8.m8.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m8.1b"><apply id="S4.SS1.p3.8.m8.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m8.1.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1">superscript</csymbol><ci id="S4.SS1.p3.8.m8.1.1.2.cmml" xref="S4.SS1.p3.8.m8.1.1.2">𝑀</ci><ci id="S4.SS1.p3.8.m8.1.1.3.cmml" xref="S4.SS1.p3.8.m8.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m8.1c">M^{g}</annotation></semantics></math> and the cast shadow mask <math id="S4.SS1.p3.9.m9.1" class="ltx_Math" alttext="M^{s}" display="inline"><semantics id="S4.SS1.p3.9.m9.1a"><msup id="S4.SS1.p3.9.m9.1.1" xref="S4.SS1.p3.9.m9.1.1.cmml"><mi id="S4.SS1.p3.9.m9.1.1.2" xref="S4.SS1.p3.9.m9.1.1.2.cmml">M</mi><mi id="S4.SS1.p3.9.m9.1.1.3" xref="S4.SS1.p3.9.m9.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.9.m9.1b"><apply id="S4.SS1.p3.9.m9.1.1.cmml" xref="S4.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m9.1.1.1.cmml" xref="S4.SS1.p3.9.m9.1.1">superscript</csymbol><ci id="S4.SS1.p3.9.m9.1.1.2.cmml" xref="S4.SS1.p3.9.m9.1.1.2">𝑀</ci><ci id="S4.SS1.p3.9.m9.1.1.3.cmml" xref="S4.SS1.p3.9.m9.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.9.m9.1c">M^{s}</annotation></semantics></math> in a supervised manner as follows,</p>
<table id="A5.EGx1" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E4.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{mask}^{g}=L_{\mathcal{E}}(M_{syn}^{g},\hat{M}_{syn}^{g})," display="inline"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><msubsup id="S4.E4.m1.1.1.1.1.4" xref="S4.E4.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.1.1.1.1.4.2.2" xref="S4.E4.m1.1.1.1.1.4.2.2.cmml">ℒ</mi><mrow id="S4.E4.m1.1.1.1.1.4.2.3" xref="S4.E4.m1.1.1.1.1.4.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.4.2.3.2" xref="S4.E4.m1.1.1.1.1.4.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.4.2.3.1" xref="S4.E4.m1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.4.2.3.3" xref="S4.E4.m1.1.1.1.1.4.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.4.2.3.1a" xref="S4.E4.m1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.4.2.3.4" xref="S4.E4.m1.1.1.1.1.4.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.4.2.3.1b" xref="S4.E4.m1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.4.2.3.5" xref="S4.E4.m1.1.1.1.1.4.2.3.5.cmml">k</mi></mrow><mi id="S4.E4.m1.1.1.1.1.4.3" xref="S4.E4.m1.1.1.1.1.4.3.cmml">g</mi></msubsup><mo id="S4.E4.m1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E4.m1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.cmml"><msub id="S4.E4.m1.1.1.1.1.2.4" xref="S4.E4.m1.1.1.1.1.2.4.cmml"><mi id="S4.E4.m1.1.1.1.1.2.4.2" xref="S4.E4.m1.1.1.1.1.2.4.2.cmml">L</mi><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.1.1.1.1.2.4.3" xref="S4.E4.m1.1.1.1.1.2.4.3.cmml">ℰ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E4.m1.1.1.1.1.2.2.2" xref="S4.E4.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E4.m1.1.1.1.1.2.2.2.3" xref="S4.E4.m1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E4.m1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml">M</mi><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.1a" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.4" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.4.cmml">n</mi></mrow><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.cmml">g</mi></msubsup><mo id="S4.E4.m1.1.1.1.1.2.2.2.4" xref="S4.E4.m1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E4.m1.1.1.1.1.2.2.2.2" xref="S4.E4.m1.1.1.1.1.2.2.2.2.cmml"><mover accent="true" id="S4.E4.m1.1.1.1.1.2.2.2.2.2.2" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">M</mi><mo id="S4.E4.m1.1.1.1.1.2.2.2.2.2.2.1" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.2" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.1" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.3" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.1a" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.4" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.4.cmml">n</mi></mrow><mi id="S4.E4.m1.1.1.1.1.2.2.2.2.3" xref="S4.E4.m1.1.1.1.1.2.2.2.2.3.cmml">g</mi></msubsup><mo stretchy="false" id="S4.E4.m1.1.1.1.1.2.2.2.5" xref="S4.E4.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><eq id="S4.E4.m1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3"></eq><apply id="S4.E4.m1.1.1.1.1.4.cmml" xref="S4.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.4.1.cmml" xref="S4.E4.m1.1.1.1.1.4">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.4.2.cmml" xref="S4.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.4.2.1.cmml" xref="S4.E4.m1.1.1.1.1.4">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.4.2.2.cmml" xref="S4.E4.m1.1.1.1.1.4.2.2">ℒ</ci><apply id="S4.E4.m1.1.1.1.1.4.2.3.cmml" xref="S4.E4.m1.1.1.1.1.4.2.3"><times id="S4.E4.m1.1.1.1.1.4.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.4.2.3.1"></times><ci id="S4.E4.m1.1.1.1.1.4.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.4.2.3.2">𝑚</ci><ci id="S4.E4.m1.1.1.1.1.4.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.4.2.3.3">𝑎</ci><ci id="S4.E4.m1.1.1.1.1.4.2.3.4.cmml" xref="S4.E4.m1.1.1.1.1.4.2.3.4">𝑠</ci><ci id="S4.E4.m1.1.1.1.1.4.2.3.5.cmml" xref="S4.E4.m1.1.1.1.1.4.2.3.5">𝑘</ci></apply></apply><ci id="S4.E4.m1.1.1.1.1.4.3.cmml" xref="S4.E4.m1.1.1.1.1.4.3">𝑔</ci></apply><apply id="S4.E4.m1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2"><times id="S4.E4.m1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.3"></times><apply id="S4.E4.m1.1.1.1.1.2.4.cmml" xref="S4.E4.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.4.1.cmml" xref="S4.E4.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.4.2.cmml" xref="S4.E4.m1.1.1.1.1.2.4.2">𝐿</ci><ci id="S4.E4.m1.1.1.1.1.2.4.3.cmml" xref="S4.E4.m1.1.1.1.1.2.4.3">ℰ</ci></apply><interval closure="open" id="S4.E4.m1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2"><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.2">𝑀</ci><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3"><times id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.3">𝑦</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3">𝑔</ci></apply><apply id="S4.E4.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.2"><ci id="S4.E4.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.2.1">^</ci><ci id="S4.E4.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.2.2">𝑀</ci></apply><apply id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3"><times id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.1"></times><ci id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.2">𝑠</ci><ci id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.3">𝑦</ci><ci id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.4.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.4">𝑛</ci></apply></apply><ci id="S4.E4.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.3">𝑔</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\displaystyle\mathcal{L}_{mask}^{g}=L_{\mathcal{E}}(M_{syn}^{g},\hat{M}_{syn}^{g}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E5.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{mask}^{s}=L_{\mathcal{E}}(M_{syn}^{s},\hat{M}_{syn}^{s})," display="inline"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><msubsup id="S4.E5.m1.1.1.1.1.4" xref="S4.E5.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.1.1.1.1.4.2.2" xref="S4.E5.m1.1.1.1.1.4.2.2.cmml">ℒ</mi><mrow id="S4.E5.m1.1.1.1.1.4.2.3" xref="S4.E5.m1.1.1.1.1.4.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.4.2.3.2" xref="S4.E5.m1.1.1.1.1.4.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.4.2.3.1" xref="S4.E5.m1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.4.2.3.3" xref="S4.E5.m1.1.1.1.1.4.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.4.2.3.1a" xref="S4.E5.m1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.4.2.3.4" xref="S4.E5.m1.1.1.1.1.4.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.4.2.3.1b" xref="S4.E5.m1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.4.2.3.5" xref="S4.E5.m1.1.1.1.1.4.2.3.5.cmml">k</mi></mrow><mi id="S4.E5.m1.1.1.1.1.4.3" xref="S4.E5.m1.1.1.1.1.4.3.cmml">s</mi></msubsup><mo id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.cmml"><msub id="S4.E5.m1.1.1.1.1.2.4" xref="S4.E5.m1.1.1.1.1.2.4.cmml"><mi id="S4.E5.m1.1.1.1.1.2.4.2" xref="S4.E5.m1.1.1.1.1.2.4.2.cmml">L</mi><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.1.1.1.1.2.4.3" xref="S4.E5.m1.1.1.1.1.2.4.3.cmml">ℰ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.2.2.2" xref="S4.E5.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.2.2.2.3" xref="S4.E5.m1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E5.m1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml">M</mi><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.1a" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.4" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.4.cmml">n</mi></mrow><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo id="S4.E5.m1.1.1.1.1.2.2.2.4" xref="S4.E5.m1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E5.m1.1.1.1.1.2.2.2.2" xref="S4.E5.m1.1.1.1.1.2.2.2.2.cmml"><mover accent="true" id="S4.E5.m1.1.1.1.1.2.2.2.2.2.2" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S4.E5.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">M</mi><mo id="S4.E5.m1.1.1.1.1.2.2.2.2.2.2.1" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E5.m1.1.1.1.1.2.2.2.2.2.3" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.2" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.1" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.3" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.1a" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.4" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.4.cmml">n</mi></mrow><mi id="S4.E5.m1.1.1.1.1.2.2.2.2.3" xref="S4.E5.m1.1.1.1.1.2.2.2.2.3.cmml">s</mi></msubsup><mo stretchy="false" id="S4.E5.m1.1.1.1.1.2.2.2.5" xref="S4.E5.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3"></eq><apply id="S4.E5.m1.1.1.1.1.4.cmml" xref="S4.E5.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.4.1.cmml" xref="S4.E5.m1.1.1.1.1.4">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.4.2.cmml" xref="S4.E5.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.4.2.1.cmml" xref="S4.E5.m1.1.1.1.1.4">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.4.2.2.cmml" xref="S4.E5.m1.1.1.1.1.4.2.2">ℒ</ci><apply id="S4.E5.m1.1.1.1.1.4.2.3.cmml" xref="S4.E5.m1.1.1.1.1.4.2.3"><times id="S4.E5.m1.1.1.1.1.4.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.4.2.3.1"></times><ci id="S4.E5.m1.1.1.1.1.4.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.4.2.3.2">𝑚</ci><ci id="S4.E5.m1.1.1.1.1.4.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.4.2.3.3">𝑎</ci><ci id="S4.E5.m1.1.1.1.1.4.2.3.4.cmml" xref="S4.E5.m1.1.1.1.1.4.2.3.4">𝑠</ci><ci id="S4.E5.m1.1.1.1.1.4.2.3.5.cmml" xref="S4.E5.m1.1.1.1.1.4.2.3.5">𝑘</ci></apply></apply><ci id="S4.E5.m1.1.1.1.1.4.3.cmml" xref="S4.E5.m1.1.1.1.1.4.3">𝑠</ci></apply><apply id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2"><times id="S4.E5.m1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.3"></times><apply id="S4.E5.m1.1.1.1.1.2.4.cmml" xref="S4.E5.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.4.1.cmml" xref="S4.E5.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.2.4.2.cmml" xref="S4.E5.m1.1.1.1.1.2.4.2">𝐿</ci><ci id="S4.E5.m1.1.1.1.1.2.4.3.cmml" xref="S4.E5.m1.1.1.1.1.2.4.3">ℰ</ci></apply><interval closure="open" id="S4.E5.m1.1.1.1.1.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2"><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.2">𝑀</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3"><times id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3">𝑦</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S4.E5.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E5.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.2"><ci id="S4.E5.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.2.1">^</ci><ci id="S4.E5.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.2.2">𝑀</ci></apply><apply id="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.3"><times id="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.1"></times><ci id="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.2">𝑠</ci><ci id="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.3">𝑦</ci><ci id="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.4.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.2.3.4">𝑛</ci></apply></apply><ci id="S4.E5.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2.2.3">𝑠</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">\displaystyle\mathcal{L}_{mask}^{s}=L_{\mathcal{E}}(M_{syn}^{s},\hat{M}_{syn}^{s}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E6.m1.4" class="ltx_Math" alttext="\displaystyle L_{\mathcal{E}}(M,\hat{M})=-M\log\hat{M}-(1-M)\log(1-\hat{M})," display="inline"><semantics id="S4.E6.m1.4a"><mrow id="S4.E6.m1.4.4.1" xref="S4.E6.m1.4.4.1.1.cmml"><mrow id="S4.E6.m1.4.4.1.1" xref="S4.E6.m1.4.4.1.1.cmml"><mrow id="S4.E6.m1.4.4.1.1.4" xref="S4.E6.m1.4.4.1.1.4.cmml"><msub id="S4.E6.m1.4.4.1.1.4.2" xref="S4.E6.m1.4.4.1.1.4.2.cmml"><mi id="S4.E6.m1.4.4.1.1.4.2.2" xref="S4.E6.m1.4.4.1.1.4.2.2.cmml">L</mi><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.4.4.1.1.4.2.3" xref="S4.E6.m1.4.4.1.1.4.2.3.cmml">ℰ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.4.4.1.1.4.1" xref="S4.E6.m1.4.4.1.1.4.1.cmml">​</mo><mrow id="S4.E6.m1.4.4.1.1.4.3.2" xref="S4.E6.m1.4.4.1.1.4.3.1.cmml"><mo stretchy="false" id="S4.E6.m1.4.4.1.1.4.3.2.1" xref="S4.E6.m1.4.4.1.1.4.3.1.cmml">(</mo><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">M</mi><mo id="S4.E6.m1.4.4.1.1.4.3.2.2" xref="S4.E6.m1.4.4.1.1.4.3.1.cmml">,</mo><mover accent="true" id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml"><mi id="S4.E6.m1.2.2.2" xref="S4.E6.m1.2.2.2.cmml">M</mi><mo id="S4.E6.m1.2.2.1" xref="S4.E6.m1.2.2.1.cmml">^</mo></mover><mo stretchy="false" id="S4.E6.m1.4.4.1.1.4.3.2.3" xref="S4.E6.m1.4.4.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.4.4.1.1.3" xref="S4.E6.m1.4.4.1.1.3.cmml">=</mo><mrow id="S4.E6.m1.4.4.1.1.2" xref="S4.E6.m1.4.4.1.1.2.cmml"><mrow id="S4.E6.m1.4.4.1.1.2.4" xref="S4.E6.m1.4.4.1.1.2.4.cmml"><mo id="S4.E6.m1.4.4.1.1.2.4a" xref="S4.E6.m1.4.4.1.1.2.4.cmml">−</mo><mrow id="S4.E6.m1.4.4.1.1.2.4.2" xref="S4.E6.m1.4.4.1.1.2.4.2.cmml"><mi id="S4.E6.m1.4.4.1.1.2.4.2.2" xref="S4.E6.m1.4.4.1.1.2.4.2.2.cmml">M</mi><mo lspace="0.167em" rspace="0em" id="S4.E6.m1.4.4.1.1.2.4.2.1" xref="S4.E6.m1.4.4.1.1.2.4.2.1.cmml">​</mo><mrow id="S4.E6.m1.4.4.1.1.2.4.2.3" xref="S4.E6.m1.4.4.1.1.2.4.2.3.cmml"><mi id="S4.E6.m1.4.4.1.1.2.4.2.3.1" xref="S4.E6.m1.4.4.1.1.2.4.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E6.m1.4.4.1.1.2.4.2.3a" xref="S4.E6.m1.4.4.1.1.2.4.2.3.cmml">⁡</mo><mover accent="true" id="S4.E6.m1.4.4.1.1.2.4.2.3.2" xref="S4.E6.m1.4.4.1.1.2.4.2.3.2.cmml"><mi id="S4.E6.m1.4.4.1.1.2.4.2.3.2.2" xref="S4.E6.m1.4.4.1.1.2.4.2.3.2.2.cmml">M</mi><mo id="S4.E6.m1.4.4.1.1.2.4.2.3.2.1" xref="S4.E6.m1.4.4.1.1.2.4.2.3.2.1.cmml">^</mo></mover></mrow></mrow></mrow><mo id="S4.E6.m1.4.4.1.1.2.3" xref="S4.E6.m1.4.4.1.1.2.3.cmml">−</mo><mrow id="S4.E6.m1.4.4.1.1.2.2" xref="S4.E6.m1.4.4.1.1.2.2.cmml"><mrow id="S4.E6.m1.4.4.1.1.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.4.4.1.1.1.1.1.1.2" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.4.4.1.1.1.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml"><mn id="S4.E6.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E6.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E6.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.3.cmml">M</mi></mrow><mo stretchy="false" id="S4.E6.m1.4.4.1.1.1.1.1.1.3" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.E6.m1.4.4.1.1.2.2.3" xref="S4.E6.m1.4.4.1.1.2.2.3.cmml">​</mo><mrow id="S4.E6.m1.4.4.1.1.2.2.2.1" xref="S4.E6.m1.4.4.1.1.2.2.2.2.cmml"><mi id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml">log</mi><mo id="S4.E6.m1.4.4.1.1.2.2.2.1a" xref="S4.E6.m1.4.4.1.1.2.2.2.2.cmml">⁡</mo><mrow id="S4.E6.m1.4.4.1.1.2.2.2.1.1" xref="S4.E6.m1.4.4.1.1.2.2.2.2.cmml"><mo stretchy="false" id="S4.E6.m1.4.4.1.1.2.2.2.1.1.2" xref="S4.E6.m1.4.4.1.1.2.2.2.2.cmml">(</mo><mrow id="S4.E6.m1.4.4.1.1.2.2.2.1.1.1" xref="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.cmml"><mn id="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.2" xref="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.2.cmml">1</mn><mo id="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.1" xref="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.1.cmml">−</mo><mover accent="true" id="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.3" xref="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.3.cmml"><mi id="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.3.2" xref="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.3.2.cmml">M</mi><mo id="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.3.1" xref="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.3.1.cmml">^</mo></mover></mrow><mo stretchy="false" id="S4.E6.m1.4.4.1.1.2.2.2.1.1.3" xref="S4.E6.m1.4.4.1.1.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E6.m1.4.4.1.2" xref="S4.E6.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.4b"><apply id="S4.E6.m1.4.4.1.1.cmml" xref="S4.E6.m1.4.4.1"><eq id="S4.E6.m1.4.4.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.3"></eq><apply id="S4.E6.m1.4.4.1.1.4.cmml" xref="S4.E6.m1.4.4.1.1.4"><times id="S4.E6.m1.4.4.1.1.4.1.cmml" xref="S4.E6.m1.4.4.1.1.4.1"></times><apply id="S4.E6.m1.4.4.1.1.4.2.cmml" xref="S4.E6.m1.4.4.1.1.4.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.4.2.1.cmml" xref="S4.E6.m1.4.4.1.1.4.2">subscript</csymbol><ci id="S4.E6.m1.4.4.1.1.4.2.2.cmml" xref="S4.E6.m1.4.4.1.1.4.2.2">𝐿</ci><ci id="S4.E6.m1.4.4.1.1.4.2.3.cmml" xref="S4.E6.m1.4.4.1.1.4.2.3">ℰ</ci></apply><interval closure="open" id="S4.E6.m1.4.4.1.1.4.3.1.cmml" xref="S4.E6.m1.4.4.1.1.4.3.2"><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">𝑀</ci><apply id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2"><ci id="S4.E6.m1.2.2.1.cmml" xref="S4.E6.m1.2.2.1">^</ci><ci id="S4.E6.m1.2.2.2.cmml" xref="S4.E6.m1.2.2.2">𝑀</ci></apply></interval></apply><apply id="S4.E6.m1.4.4.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.2"><minus id="S4.E6.m1.4.4.1.1.2.3.cmml" xref="S4.E6.m1.4.4.1.1.2.3"></minus><apply id="S4.E6.m1.4.4.1.1.2.4.cmml" xref="S4.E6.m1.4.4.1.1.2.4"><minus id="S4.E6.m1.4.4.1.1.2.4.1.cmml" xref="S4.E6.m1.4.4.1.1.2.4"></minus><apply id="S4.E6.m1.4.4.1.1.2.4.2.cmml" xref="S4.E6.m1.4.4.1.1.2.4.2"><times id="S4.E6.m1.4.4.1.1.2.4.2.1.cmml" xref="S4.E6.m1.4.4.1.1.2.4.2.1"></times><ci id="S4.E6.m1.4.4.1.1.2.4.2.2.cmml" xref="S4.E6.m1.4.4.1.1.2.4.2.2">𝑀</ci><apply id="S4.E6.m1.4.4.1.1.2.4.2.3.cmml" xref="S4.E6.m1.4.4.1.1.2.4.2.3"><log id="S4.E6.m1.4.4.1.1.2.4.2.3.1.cmml" xref="S4.E6.m1.4.4.1.1.2.4.2.3.1"></log><apply id="S4.E6.m1.4.4.1.1.2.4.2.3.2.cmml" xref="S4.E6.m1.4.4.1.1.2.4.2.3.2"><ci id="S4.E6.m1.4.4.1.1.2.4.2.3.2.1.cmml" xref="S4.E6.m1.4.4.1.1.2.4.2.3.2.1">^</ci><ci id="S4.E6.m1.4.4.1.1.2.4.2.3.2.2.cmml" xref="S4.E6.m1.4.4.1.1.2.4.2.3.2.2">𝑀</ci></apply></apply></apply></apply><apply id="S4.E6.m1.4.4.1.1.2.2.cmml" xref="S4.E6.m1.4.4.1.1.2.2"><times id="S4.E6.m1.4.4.1.1.2.2.3.cmml" xref="S4.E6.m1.4.4.1.1.2.2.3"></times><apply id="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1"><minus id="S4.E6.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.2">1</cn><ci id="S4.E6.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S4.E6.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E6.m1.4.4.1.1.2.2.2.1"><log id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.3.3"></log><apply id="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.2.2.2.1.1.1"><minus id="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.1"></minus><cn type="integer" id="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.2">1</cn><apply id="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.3"><ci id="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.3.1.cmml" xref="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.3.1">^</ci><ci id="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.3.2.cmml" xref="S4.E6.m1.4.4.1.1.2.2.2.1.1.1.3.2">𝑀</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.4c">\displaystyle L_{\mathcal{E}}(M,\hat{M})=-M\log\hat{M}-(1-M)\log(1-\hat{M}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p3.12" class="ltx_p">where <math id="S4.SS1.p3.10.m1.1" class="ltx_Math" alttext="L_{\mathcal{E}}" display="inline"><semantics id="S4.SS1.p3.10.m1.1a"><msub id="S4.SS1.p3.10.m1.1.1" xref="S4.SS1.p3.10.m1.1.1.cmml"><mi id="S4.SS1.p3.10.m1.1.1.2" xref="S4.SS1.p3.10.m1.1.1.2.cmml">L</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.10.m1.1.1.3" xref="S4.SS1.p3.10.m1.1.1.3.cmml">ℰ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.10.m1.1b"><apply id="S4.SS1.p3.10.m1.1.1.cmml" xref="S4.SS1.p3.10.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m1.1.1.1.cmml" xref="S4.SS1.p3.10.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.10.m1.1.1.2.cmml" xref="S4.SS1.p3.10.m1.1.1.2">𝐿</ci><ci id="S4.SS1.p3.10.m1.1.1.3.cmml" xref="S4.SS1.p3.10.m1.1.1.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.10.m1.1c">L_{\mathcal{E}}</annotation></semantics></math> is the widely used binary cross entropy (BCE) loss. Experiments in <a href="#S5.SS2" title="5.2 Ablation Study ‣ 5 Experiments ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5.2</span></a> demonstrate that with the guidance of the estimated eyeglasses mask <math id="S4.SS1.p3.11.m2.1" class="ltx_Math" alttext="\hat{M}^{g}" display="inline"><semantics id="S4.SS1.p3.11.m2.1a"><msup id="S4.SS1.p3.11.m2.1.1" xref="S4.SS1.p3.11.m2.1.1.cmml"><mover accent="true" id="S4.SS1.p3.11.m2.1.1.2" xref="S4.SS1.p3.11.m2.1.1.2.cmml"><mi id="S4.SS1.p3.11.m2.1.1.2.2" xref="S4.SS1.p3.11.m2.1.1.2.2.cmml">M</mi><mo id="S4.SS1.p3.11.m2.1.1.2.1" xref="S4.SS1.p3.11.m2.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p3.11.m2.1.1.3" xref="S4.SS1.p3.11.m2.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.11.m2.1b"><apply id="S4.SS1.p3.11.m2.1.1.cmml" xref="S4.SS1.p3.11.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.11.m2.1.1.1.cmml" xref="S4.SS1.p3.11.m2.1.1">superscript</csymbol><apply id="S4.SS1.p3.11.m2.1.1.2.cmml" xref="S4.SS1.p3.11.m2.1.1.2"><ci id="S4.SS1.p3.11.m2.1.1.2.1.cmml" xref="S4.SS1.p3.11.m2.1.1.2.1">^</ci><ci id="S4.SS1.p3.11.m2.1.1.2.2.cmml" xref="S4.SS1.p3.11.m2.1.1.2.2">𝑀</ci></apply><ci id="S4.SS1.p3.11.m2.1.1.3.cmml" xref="S4.SS1.p3.11.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.11.m2.1c">\hat{M}^{g}</annotation></semantics></math>, the predicted shadow mask <math id="S4.SS1.p3.12.m3.1" class="ltx_Math" alttext="\hat{M}^{s}" display="inline"><semantics id="S4.SS1.p3.12.m3.1a"><msup id="S4.SS1.p3.12.m3.1.1" xref="S4.SS1.p3.12.m3.1.1.cmml"><mover accent="true" id="S4.SS1.p3.12.m3.1.1.2" xref="S4.SS1.p3.12.m3.1.1.2.cmml"><mi id="S4.SS1.p3.12.m3.1.1.2.2" xref="S4.SS1.p3.12.m3.1.1.2.2.cmml">M</mi><mo id="S4.SS1.p3.12.m3.1.1.2.1" xref="S4.SS1.p3.12.m3.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p3.12.m3.1.1.3" xref="S4.SS1.p3.12.m3.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.12.m3.1b"><apply id="S4.SS1.p3.12.m3.1.1.cmml" xref="S4.SS1.p3.12.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.12.m3.1.1.1.cmml" xref="S4.SS1.p3.12.m3.1.1">superscript</csymbol><apply id="S4.SS1.p3.12.m3.1.1.2.cmml" xref="S4.SS1.p3.12.m3.1.1.2"><ci id="S4.SS1.p3.12.m3.1.1.2.1.cmml" xref="S4.SS1.p3.12.m3.1.1.2.1">^</ci><ci id="S4.SS1.p3.12.m3.1.1.2.2.cmml" xref="S4.SS1.p3.12.m3.1.1.2.2">𝑀</ci></apply><ci id="S4.SS1.p3.12.m3.1.1.3.cmml" xref="S4.SS1.p3.12.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.12.m3.1c">\hat{M}^{s}</annotation></semantics></math> will be more complete.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.3" class="ltx_p">Overall, the training loss for the mask prediction stage is formulated as</p>
<table id="S4.E7" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E7X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E7X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{predict}" display="inline"><semantics id="S4.E7X.2.1.1.m1.1a"><msub id="S4.E7X.2.1.1.m1.1.1" xref="S4.E7X.2.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7X.2.1.1.m1.1.1.2" xref="S4.E7X.2.1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.E7X.2.1.1.m1.1.1.3" xref="S4.E7X.2.1.1.m1.1.1.3.cmml"><mi id="S4.E7X.2.1.1.m1.1.1.3.2" xref="S4.E7X.2.1.1.m1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E7X.2.1.1.m1.1.1.3.1" xref="S4.E7X.2.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.E7X.2.1.1.m1.1.1.3.3" xref="S4.E7X.2.1.1.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E7X.2.1.1.m1.1.1.3.1a" xref="S4.E7X.2.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.E7X.2.1.1.m1.1.1.3.4" xref="S4.E7X.2.1.1.m1.1.1.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E7X.2.1.1.m1.1.1.3.1b" xref="S4.E7X.2.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.E7X.2.1.1.m1.1.1.3.5" xref="S4.E7X.2.1.1.m1.1.1.3.5.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E7X.2.1.1.m1.1.1.3.1c" xref="S4.E7X.2.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.E7X.2.1.1.m1.1.1.3.6" xref="S4.E7X.2.1.1.m1.1.1.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E7X.2.1.1.m1.1.1.3.1d" xref="S4.E7X.2.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.E7X.2.1.1.m1.1.1.3.7" xref="S4.E7X.2.1.1.m1.1.1.3.7.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E7X.2.1.1.m1.1.1.3.1e" xref="S4.E7X.2.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.E7X.2.1.1.m1.1.1.3.8" xref="S4.E7X.2.1.1.m1.1.1.3.8.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.E7X.2.1.1.m1.1b"><apply id="S4.E7X.2.1.1.m1.1.1.cmml" xref="S4.E7X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.1.1">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.1.1.2.cmml" xref="S4.E7X.2.1.1.m1.1.1.2">ℒ</ci><apply id="S4.E7X.2.1.1.m1.1.1.3.cmml" xref="S4.E7X.2.1.1.m1.1.1.3"><times id="S4.E7X.2.1.1.m1.1.1.3.1.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.1"></times><ci id="S4.E7X.2.1.1.m1.1.1.3.2.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.2">𝑝</ci><ci id="S4.E7X.2.1.1.m1.1.1.3.3.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.3">𝑟</ci><ci id="S4.E7X.2.1.1.m1.1.1.3.4.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.4">𝑒</ci><ci id="S4.E7X.2.1.1.m1.1.1.3.5.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.5">𝑑</ci><ci id="S4.E7X.2.1.1.m1.1.1.3.6.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.6">𝑖</ci><ci id="S4.E7X.2.1.1.m1.1.1.3.7.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.7">𝑐</ci><ci id="S4.E7X.2.1.1.m1.1.1.3.8.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.8">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7X.2.1.1.m1.1c">\displaystyle\mathcal{L}_{predict}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E7X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\lambda_{adv}\mathcal{L}^{\mathcal{D}}_{adv}+\lambda_{adv}\mathcal{L}^{\mathcal{G}}_{adv}" display="inline"><semantics id="S4.E7X.3.2.2.m1.1a"><mrow id="S4.E7X.3.2.2.m1.1.1" xref="S4.E7X.3.2.2.m1.1.1.cmml"><mi id="S4.E7X.3.2.2.m1.1.1.2" xref="S4.E7X.3.2.2.m1.1.1.2.cmml"></mi><mo id="S4.E7X.3.2.2.m1.1.1.1" xref="S4.E7X.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="S4.E7X.3.2.2.m1.1.1.3" xref="S4.E7X.3.2.2.m1.1.1.3.cmml"><mrow id="S4.E7X.3.2.2.m1.1.1.3.2" xref="S4.E7X.3.2.2.m1.1.1.3.2.cmml"><msub id="S4.E7X.3.2.2.m1.1.1.3.2.2" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.cmml"><mi id="S4.E7X.3.2.2.m1.1.1.3.2.2.2" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.2.cmml">λ</mi><mrow id="S4.E7X.3.2.2.m1.1.1.3.2.2.3" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.3.cmml"><mi id="S4.E7X.3.2.2.m1.1.1.3.2.2.3.2" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E7X.3.2.2.m1.1.1.3.2.2.3.1" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.3.1.cmml">​</mo><mi id="S4.E7X.3.2.2.m1.1.1.3.2.2.3.3" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E7X.3.2.2.m1.1.1.3.2.2.3.1a" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.3.1.cmml">​</mo><mi id="S4.E7X.3.2.2.m1.1.1.3.2.2.3.4" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.3.4.cmml">v</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E7X.3.2.2.m1.1.1.3.2.1" xref="S4.E7X.3.2.2.m1.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E7X.3.2.2.m1.1.1.3.2.3" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7X.3.2.2.m1.1.1.3.2.3.2.2" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.2.2.cmml">ℒ</mi><mrow id="S4.E7X.3.2.2.m1.1.1.3.2.3.3" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.3.cmml"><mi id="S4.E7X.3.2.2.m1.1.1.3.2.3.3.2" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E7X.3.2.2.m1.1.1.3.2.3.3.1" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S4.E7X.3.2.2.m1.1.1.3.2.3.3.3" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E7X.3.2.2.m1.1.1.3.2.3.3.1a" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S4.E7X.3.2.2.m1.1.1.3.2.3.3.4" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.3.4.cmml">v</mi></mrow><mi class="ltx_font_mathcaligraphic" id="S4.E7X.3.2.2.m1.1.1.3.2.3.2.3" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.2.3.cmml">𝒟</mi></msubsup></mrow><mo id="S4.E7X.3.2.2.m1.1.1.3.1" xref="S4.E7X.3.2.2.m1.1.1.3.1.cmml">+</mo><mrow id="S4.E7X.3.2.2.m1.1.1.3.3" xref="S4.E7X.3.2.2.m1.1.1.3.3.cmml"><msub id="S4.E7X.3.2.2.m1.1.1.3.3.2" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.cmml"><mi id="S4.E7X.3.2.2.m1.1.1.3.3.2.2" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.2.cmml">λ</mi><mrow id="S4.E7X.3.2.2.m1.1.1.3.3.2.3" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.3.cmml"><mi id="S4.E7X.3.2.2.m1.1.1.3.3.2.3.2" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E7X.3.2.2.m1.1.1.3.3.2.3.1" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S4.E7X.3.2.2.m1.1.1.3.3.2.3.3" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E7X.3.2.2.m1.1.1.3.3.2.3.1a" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S4.E7X.3.2.2.m1.1.1.3.3.2.3.4" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.3.4.cmml">v</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E7X.3.2.2.m1.1.1.3.3.1" xref="S4.E7X.3.2.2.m1.1.1.3.3.1.cmml">​</mo><msubsup id="S4.E7X.3.2.2.m1.1.1.3.3.3" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7X.3.2.2.m1.1.1.3.3.3.2.2" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.2.2.cmml">ℒ</mi><mrow id="S4.E7X.3.2.2.m1.1.1.3.3.3.3" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.3.cmml"><mi id="S4.E7X.3.2.2.m1.1.1.3.3.3.3.2" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E7X.3.2.2.m1.1.1.3.3.3.3.1" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S4.E7X.3.2.2.m1.1.1.3.3.3.3.3" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E7X.3.2.2.m1.1.1.3.3.3.3.1a" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S4.E7X.3.2.2.m1.1.1.3.3.3.3.4" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.3.4.cmml">v</mi></mrow><mi class="ltx_font_mathcaligraphic" id="S4.E7X.3.2.2.m1.1.1.3.3.3.2.3" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.2.3.cmml">𝒢</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7X.3.2.2.m1.1b"><apply id="S4.E7X.3.2.2.m1.1.1.cmml" xref="S4.E7X.3.2.2.m1.1.1"><eq id="S4.E7X.3.2.2.m1.1.1.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="S4.E7X.3.2.2.m1.1.1.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.2">absent</csymbol><apply id="S4.E7X.3.2.2.m1.1.1.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3"><plus id="S4.E7X.3.2.2.m1.1.1.3.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.1"></plus><apply id="S4.E7X.3.2.2.m1.1.1.3.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2"><times id="S4.E7X.3.2.2.m1.1.1.3.2.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.1"></times><apply id="S4.E7X.3.2.2.m1.1.1.3.2.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.1.1.3.2.2.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.2">subscript</csymbol><ci id="S4.E7X.3.2.2.m1.1.1.3.2.2.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.2">𝜆</ci><apply id="S4.E7X.3.2.2.m1.1.1.3.2.2.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.3"><times id="S4.E7X.3.2.2.m1.1.1.3.2.2.3.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.3.1"></times><ci id="S4.E7X.3.2.2.m1.1.1.3.2.2.3.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.3.2">𝑎</ci><ci id="S4.E7X.3.2.2.m1.1.1.3.2.2.3.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.3.3">𝑑</ci><ci id="S4.E7X.3.2.2.m1.1.1.3.2.2.3.4.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.2.3.4">𝑣</ci></apply></apply><apply id="S4.E7X.3.2.2.m1.1.1.3.2.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.1.1.3.2.3.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.3">subscript</csymbol><apply id="S4.E7X.3.2.2.m1.1.1.3.2.3.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.1.1.3.2.3.2.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.3">superscript</csymbol><ci id="S4.E7X.3.2.2.m1.1.1.3.2.3.2.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.2.2">ℒ</ci><ci id="S4.E7X.3.2.2.m1.1.1.3.2.3.2.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.2.3">𝒟</ci></apply><apply id="S4.E7X.3.2.2.m1.1.1.3.2.3.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.3"><times id="S4.E7X.3.2.2.m1.1.1.3.2.3.3.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.3.1"></times><ci id="S4.E7X.3.2.2.m1.1.1.3.2.3.3.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.3.2">𝑎</ci><ci id="S4.E7X.3.2.2.m1.1.1.3.2.3.3.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.3.3">𝑑</ci><ci id="S4.E7X.3.2.2.m1.1.1.3.2.3.3.4.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.2.3.3.4">𝑣</ci></apply></apply></apply><apply id="S4.E7X.3.2.2.m1.1.1.3.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3"><times id="S4.E7X.3.2.2.m1.1.1.3.3.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.1"></times><apply id="S4.E7X.3.2.2.m1.1.1.3.3.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.1.1.3.3.2.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.2">subscript</csymbol><ci id="S4.E7X.3.2.2.m1.1.1.3.3.2.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.2">𝜆</ci><apply id="S4.E7X.3.2.2.m1.1.1.3.3.2.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.3"><times id="S4.E7X.3.2.2.m1.1.1.3.3.2.3.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.3.1"></times><ci id="S4.E7X.3.2.2.m1.1.1.3.3.2.3.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.3.2">𝑎</ci><ci id="S4.E7X.3.2.2.m1.1.1.3.3.2.3.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.3.3">𝑑</ci><ci id="S4.E7X.3.2.2.m1.1.1.3.3.2.3.4.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.2.3.4">𝑣</ci></apply></apply><apply id="S4.E7X.3.2.2.m1.1.1.3.3.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.1.1.3.3.3.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.3">subscript</csymbol><apply id="S4.E7X.3.2.2.m1.1.1.3.3.3.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.1.1.3.3.3.2.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.3">superscript</csymbol><ci id="S4.E7X.3.2.2.m1.1.1.3.3.3.2.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.2.2">ℒ</ci><ci id="S4.E7X.3.2.2.m1.1.1.3.3.3.2.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.2.3">𝒢</ci></apply><apply id="S4.E7X.3.2.2.m1.1.1.3.3.3.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.3"><times id="S4.E7X.3.2.2.m1.1.1.3.3.3.3.1.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.3.1"></times><ci id="S4.E7X.3.2.2.m1.1.1.3.3.3.3.2.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.3.2">𝑎</ci><ci id="S4.E7X.3.2.2.m1.1.1.3.3.3.3.3.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.3.3">𝑑</ci><ci id="S4.E7X.3.2.2.m1.1.1.3.3.3.3.4.cmml" xref="S4.E7X.3.2.2.m1.1.1.3.3.3.3.4">𝑣</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7X.3.2.2.m1.1c">\displaystyle=\lambda_{adv}\mathcal{L}^{\mathcal{D}}_{adv}+\lambda_{adv}\mathcal{L}^{\mathcal{G}}_{adv}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr id="S4.E7Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E7Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle+\lambda_{mask}\mathcal{L}_{mask}^{g}+\lambda_{mask}\mathcal{L}_{mask}^{s}," display="inline"><semantics id="S4.E7Xa.2.1.1.m1.1a"><mrow id="S4.E7Xa.2.1.1.m1.1.1.1" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S4.E7Xa.2.1.1.m1.1.1.1.1" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S4.E7Xa.2.1.1.m1.1.1.1.1.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.cmml"><mo id="S4.E7Xa.2.1.1.m1.1.1.1.1.2a" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.cmml"><msub id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml"><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.2.cmml">λ</mi><mrow id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml"><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.1" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.1a" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.4" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.1b" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.5" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.5.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.1" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.1.cmml">​</mo><msubsup id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.2.cmml">ℒ</mi><mrow id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.1" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.1.cmml">​</mo><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.1a" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.1.cmml">​</mo><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.4" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.1b" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.1.cmml">​</mo><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.5" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.5.cmml">k</mi></mrow><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.3.cmml">g</mi></msubsup></mrow></mrow><mo id="S4.E7Xa.2.1.1.m1.1.1.1.1.1" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.1.cmml">+</mo><mrow id="S4.E7Xa.2.1.1.m1.1.1.1.1.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.cmml"><msub id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.cmml"><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml">λ</mi><mrow id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.1" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.1a" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.4" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.1b" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.5" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.5.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.1" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.2.cmml">ℒ</mi><mrow id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.cmml"><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1a" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.4" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1b" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.5" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.5.cmml">k</mi></mrow><mi id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.3" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml">s</mi></msubsup></mrow></mrow><mo id="S4.E7Xa.2.1.1.m1.1.1.1.2" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7Xa.2.1.1.m1.1b"><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1"><plus id="S4.E7Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.1"></plus><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2"><plus id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2"></plus><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2"><times id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.1"></times><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.2">𝜆</ci><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3"><times id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.1"></times><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2">𝑚</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.3">𝑎</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.4.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.4">𝑠</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.5.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.2.3.5">𝑘</ci></apply></apply><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.2">ℒ</ci><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3"><times id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.1"></times><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.2">𝑚</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.3">𝑎</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.4.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.4">𝑠</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.5.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.5">𝑘</ci></apply></apply><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.2.2.3.3">𝑔</ci></apply></apply></apply><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3"><times id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.1"></times><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.2">𝜆</ci><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3"><times id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.1"></times><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.2">𝑚</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.3">𝑎</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.4.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.4">𝑠</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.5.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.5">𝑘</ci></apply></apply><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.2">ℒ</ci><apply id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3"><times id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1"></times><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.2">𝑚</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.3">𝑎</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.4.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.4">𝑠</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.5.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.3.5">𝑘</ci></apply></apply><ci id="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.1.1.3.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7Xa.2.1.1.m1.1c">\displaystyle+\lambda_{mask}\mathcal{L}_{mask}^{g}+\lambda_{mask}\mathcal{L}_{mask}^{s},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S4.SS1.p4.2" class="ltx_p">where <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="\lambda_{adv}" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><msub id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">λ</mi><mrow id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml"><mi id="S4.SS1.p4.1.m1.1.1.3.2" xref="S4.SS1.p4.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.1.m1.1.1.3.1" xref="S4.SS1.p4.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p4.1.m1.1.1.3.3" xref="S4.SS1.p4.1.m1.1.1.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.1.m1.1.1.3.1a" xref="S4.SS1.p4.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p4.1.m1.1.1.3.4" xref="S4.SS1.p4.1.m1.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">𝜆</ci><apply id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3"><times id="S4.SS1.p4.1.m1.1.1.3.1.cmml" xref="S4.SS1.p4.1.m1.1.1.3.1"></times><ci id="S4.SS1.p4.1.m1.1.1.3.2.cmml" xref="S4.SS1.p4.1.m1.1.1.3.2">𝑎</ci><ci id="S4.SS1.p4.1.m1.1.1.3.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3.3">𝑑</ci><ci id="S4.SS1.p4.1.m1.1.1.3.4.cmml" xref="S4.SS1.p4.1.m1.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">\lambda_{adv}</annotation></semantics></math> and <math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="\lambda_{mask}" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><msub id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><mi id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml">λ</mi><mrow id="S4.SS1.p4.2.m2.1.1.3" xref="S4.SS1.p4.2.m2.1.1.3.cmml"><mi id="S4.SS1.p4.2.m2.1.1.3.2" xref="S4.SS1.p4.2.m2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.2.m2.1.1.3.1" xref="S4.SS1.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p4.2.m2.1.1.3.3" xref="S4.SS1.p4.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.2.m2.1.1.3.1a" xref="S4.SS1.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p4.2.m2.1.1.3.4" xref="S4.SS1.p4.2.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.2.m2.1.1.3.1b" xref="S4.SS1.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p4.2.m2.1.1.3.5" xref="S4.SS1.p4.2.m2.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><apply id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p4.2.m2.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2">𝜆</ci><apply id="S4.SS1.p4.2.m2.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3"><times id="S4.SS1.p4.2.m2.1.1.3.1.cmml" xref="S4.SS1.p4.2.m2.1.1.3.1"></times><ci id="S4.SS1.p4.2.m2.1.1.3.2.cmml" xref="S4.SS1.p4.2.m2.1.1.3.2">𝑚</ci><ci id="S4.SS1.p4.2.m2.1.1.3.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3.3">𝑎</ci><ci id="S4.SS1.p4.2.m2.1.1.3.4.cmml" xref="S4.SS1.p4.2.m2.1.1.3.4">𝑠</ci><ci id="S4.SS1.p4.2.m2.1.1.3.5.cmml" xref="S4.SS1.p4.2.m2.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">\lambda_{mask}</annotation></semantics></math> are the weights for adversarial learning and mask prediction, respectively.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Item Removal Stage</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">This stage aims to remove eyeglasses and cast shadows, and we call it <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">item removal stage</span> for short. It takes the two predicted masks as clues to achieve clean eyeglasses and shadow removal. When removing these items, we also apply the multi-step strategy. However, different from the multi-step setup used in the mask prediction stage, in which our method first handles eyeglasses and then shadows, we deal with eyeglasses and shadows in an inverse order in this stage.
This is because if we first remove the eyeglasses, the network will lose the abundant indications of shadow intensity and locations.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.5" class="ltx_p">With an input image <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">I</annotation></semantics></math>, we first use a De-Shadow Network to remove the cast shadows of the eyeglasses. To help the network better locate the cast shadows to be removed, the estimated eyeglasses mask <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\hat{M}^{g}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><msup id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mover accent="true" id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2.2" xref="S4.SS2.p2.2.m2.1.1.2.2.cmml">M</mi><mo id="S4.SS2.p2.2.m2.1.1.2.1" xref="S4.SS2.p2.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">superscript</csymbol><apply id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2"><ci id="S4.SS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.2.1">^</ci><ci id="S4.SS2.p2.2.m2.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2.2">𝑀</ci></apply><ci id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\hat{M}^{g}</annotation></semantics></math> and shadow mask <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\hat{M}^{s}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><msup id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mover accent="true" id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2.cmml">M</mi><mo id="S4.SS2.p2.3.m3.1.1.2.1" xref="S4.SS2.p2.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">superscript</csymbol><apply id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2"><ci id="S4.SS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2.1">^</ci><ci id="S4.SS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2">𝑀</ci></apply><ci id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\hat{M}^{s}</annotation></semantics></math> are also fed to the De-shadow Network. In order to learn the shadow-removed image <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="I^{g}" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><msup id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">I</mi><mi id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">superscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝐼</ci><ci id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">I^{g}</annotation></semantics></math>, we employ a <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="L_{1}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><msub id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">L</mi><mn id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">𝐿</ci><cn type="integer" id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">L_{1}</annotation></semantics></math> regression loss, written as</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.1" class="ltx_Math" alttext="\mathcal{L}_{de-s}=\|\hat{I}_{syn}^{g}-I_{syn}^{g}\|_{1}," display="block"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><mrow id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><msub id="S4.E8.m1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E8.m1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.3.3.cmml"><mrow id="S4.E8.m1.1.1.1.1.3.3.2" xref="S4.E8.m1.1.1.1.1.3.3.2.cmml"><mi id="S4.E8.m1.1.1.1.1.3.3.2.2" xref="S4.E8.m1.1.1.1.1.3.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.3.2.1" xref="S4.E8.m1.1.1.1.1.3.3.2.1.cmml">​</mo><mi id="S4.E8.m1.1.1.1.1.3.3.2.3" xref="S4.E8.m1.1.1.1.1.3.3.2.3.cmml">e</mi></mrow><mo id="S4.E8.m1.1.1.1.1.3.3.1" xref="S4.E8.m1.1.1.1.1.3.3.1.cmml">−</mo><mi id="S4.E8.m1.1.1.1.1.3.3.3" xref="S4.E8.m1.1.1.1.1.3.3.3.cmml">s</mi></mrow></msub><mo id="S4.E8.m1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.2.cmml">=</mo><msub id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E8.m1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">I</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.1a" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.4" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.4.cmml">n</mi></mrow><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.3.cmml">g</mi></msubsup><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.E8.m1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">I</mi><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.1a" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.4" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.4.cmml">n</mi></mrow><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.3.cmml">g</mi></msubsup></mrow><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.3.cmml">1</mn></msub></mrow><mo id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><eq id="S4.E8.m1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.2"></eq><apply id="S4.E8.m1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.2">ℒ</ci><apply id="S4.E8.m1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3"><minus id="S4.E8.m1.1.1.1.1.3.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3.3.1"></minus><apply id="S4.E8.m1.1.1.1.1.3.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.3.2"><times id="S4.E8.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E8.m1.1.1.1.1.3.3.2.1"></times><ci id="S4.E8.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E8.m1.1.1.1.1.3.3.2.2">𝑑</ci><ci id="S4.E8.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3.2.3">𝑒</ci></apply><ci id="S4.E8.m1.1.1.1.1.3.3.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S4.E8.m1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1">subscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1"><minus id="S4.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2"><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝐼</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3"><times id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.2">𝑠</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.3">𝑦</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.4.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.4">𝑛</ci></apply></apply><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.3">𝑔</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.2">𝐼</ci><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3"><times id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.2">𝑠</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.3">𝑦</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.4">𝑛</ci></apply></apply><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.3">𝑔</ci></apply></apply></apply><cn type="integer" id="S4.E8.m1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\mathcal{L}_{de-s}=\|\hat{I}_{syn}^{g}-I_{syn}^{g}\|_{1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.6" class="ltx_p">where <math id="S4.SS2.p2.6.m1.1" class="ltx_Math" alttext="\hat{I}_{syn}^{g}" display="inline"><semantics id="S4.SS2.p2.6.m1.1a"><msubsup id="S4.SS2.p2.6.m1.1.1" xref="S4.SS2.p2.6.m1.1.1.cmml"><mover accent="true" id="S4.SS2.p2.6.m1.1.1.2.2" xref="S4.SS2.p2.6.m1.1.1.2.2.cmml"><mi id="S4.SS2.p2.6.m1.1.1.2.2.2" xref="S4.SS2.p2.6.m1.1.1.2.2.2.cmml">I</mi><mo id="S4.SS2.p2.6.m1.1.1.2.2.1" xref="S4.SS2.p2.6.m1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.SS2.p2.6.m1.1.1.2.3" xref="S4.SS2.p2.6.m1.1.1.2.3.cmml"><mi id="S4.SS2.p2.6.m1.1.1.2.3.2" xref="S4.SS2.p2.6.m1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m1.1.1.2.3.1" xref="S4.SS2.p2.6.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p2.6.m1.1.1.2.3.3" xref="S4.SS2.p2.6.m1.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m1.1.1.2.3.1a" xref="S4.SS2.p2.6.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p2.6.m1.1.1.2.3.4" xref="S4.SS2.p2.6.m1.1.1.2.3.4.cmml">n</mi></mrow><mi id="S4.SS2.p2.6.m1.1.1.3" xref="S4.SS2.p2.6.m1.1.1.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m1.1b"><apply id="S4.SS2.p2.6.m1.1.1.cmml" xref="S4.SS2.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m1.1.1.1.cmml" xref="S4.SS2.p2.6.m1.1.1">superscript</csymbol><apply id="S4.SS2.p2.6.m1.1.1.2.cmml" xref="S4.SS2.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m1.1.1.2.1.cmml" xref="S4.SS2.p2.6.m1.1.1">subscript</csymbol><apply id="S4.SS2.p2.6.m1.1.1.2.2.cmml" xref="S4.SS2.p2.6.m1.1.1.2.2"><ci id="S4.SS2.p2.6.m1.1.1.2.2.1.cmml" xref="S4.SS2.p2.6.m1.1.1.2.2.1">^</ci><ci id="S4.SS2.p2.6.m1.1.1.2.2.2.cmml" xref="S4.SS2.p2.6.m1.1.1.2.2.2">𝐼</ci></apply><apply id="S4.SS2.p2.6.m1.1.1.2.3.cmml" xref="S4.SS2.p2.6.m1.1.1.2.3"><times id="S4.SS2.p2.6.m1.1.1.2.3.1.cmml" xref="S4.SS2.p2.6.m1.1.1.2.3.1"></times><ci id="S4.SS2.p2.6.m1.1.1.2.3.2.cmml" xref="S4.SS2.p2.6.m1.1.1.2.3.2">𝑠</ci><ci id="S4.SS2.p2.6.m1.1.1.2.3.3.cmml" xref="S4.SS2.p2.6.m1.1.1.2.3.3">𝑦</ci><ci id="S4.SS2.p2.6.m1.1.1.2.3.4.cmml" xref="S4.SS2.p2.6.m1.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S4.SS2.p2.6.m1.1.1.3.cmml" xref="S4.SS2.p2.6.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m1.1c">\hat{I}_{syn}^{g}</annotation></semantics></math> indicates the output of our De-Shadow Network.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.5" class="ltx_p">After removing the cast shadows, we use a De-Glass Network to further remove the eyeglasses in the next step. The large variety of eyeglasses textures in real world will lower the performance of eyeglasses removal.
To enhance the robustness of our method, we adopt a mask operation to set the pixel values of the eyeglasses regions to <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\boldsymbol{0}" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mn id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><cn type="integer" id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\boldsymbol{0}</annotation></semantics></math>. This operation eliminates the texture of eyeglasses from <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="\hat{I}^{g}" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><msup id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mover accent="true" id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2.2" xref="S4.SS2.p3.2.m2.1.1.2.2.cmml">I</mi><mo id="S4.SS2.p3.2.m2.1.1.2.1" xref="S4.SS2.p3.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">superscript</csymbol><apply id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2"><ci id="S4.SS2.p3.2.m2.1.1.2.1.cmml" xref="S4.SS2.p3.2.m2.1.1.2.1">^</ci><ci id="S4.SS2.p3.2.m2.1.1.2.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2.2">𝐼</ci></apply><ci id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\hat{I}^{g}</annotation></semantics></math>, forcing the De-Glass Network to remove the eyeglasses only according to the structure instead of textures.
Finally, the De-Glass Network takes the masked shadow-removed result <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="\hat{I}^{mg}" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><msup id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mover accent="true" id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2.2" xref="S4.SS2.p3.3.m3.1.1.2.2.cmml">I</mi><mo id="S4.SS2.p3.3.m3.1.1.2.1" xref="S4.SS2.p3.3.m3.1.1.2.1.cmml">^</mo></mover><mrow id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml"><mi id="S4.SS2.p3.3.m3.1.1.3.2" xref="S4.SS2.p3.3.m3.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.3.m3.1.1.3.1" xref="S4.SS2.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p3.3.m3.1.1.3.3" xref="S4.SS2.p3.3.m3.1.1.3.3.cmml">g</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">superscript</csymbol><apply id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2"><ci id="S4.SS2.p3.3.m3.1.1.2.1.cmml" xref="S4.SS2.p3.3.m3.1.1.2.1">^</ci><ci id="S4.SS2.p3.3.m3.1.1.2.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2.2">𝐼</ci></apply><apply id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3"><times id="S4.SS2.p3.3.m3.1.1.3.1.cmml" xref="S4.SS2.p3.3.m3.1.1.3.1"></times><ci id="S4.SS2.p3.3.m3.1.1.3.2.cmml" xref="S4.SS2.p3.3.m3.1.1.3.2">𝑚</ci><ci id="S4.SS2.p3.3.m3.1.1.3.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\hat{I}^{mg}</annotation></semantics></math> and the estimated eyeglasses mask <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="\hat{M}^{g}" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><msup id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mover accent="true" id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml"><mi id="S4.SS2.p3.4.m4.1.1.2.2" xref="S4.SS2.p3.4.m4.1.1.2.2.cmml">M</mi><mo id="S4.SS2.p3.4.m4.1.1.2.1" xref="S4.SS2.p3.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">superscript</csymbol><apply id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2"><ci id="S4.SS2.p3.4.m4.1.1.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.1">^</ci><ci id="S4.SS2.p3.4.m4.1.1.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2">𝑀</ci></apply><ci id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\hat{M}^{g}</annotation></semantics></math> as input and learns the eyeglasses-removed image <math id="S4.SS2.p3.5.m5.1" class="ltx_Math" alttext="I^{f}" display="inline"><semantics id="S4.SS2.p3.5.m5.1a"><msup id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml"><mi id="S4.SS2.p3.5.m5.1.1.2" xref="S4.SS2.p3.5.m5.1.1.2.cmml">I</mi><mi id="S4.SS2.p3.5.m5.1.1.3" xref="S4.SS2.p3.5.m5.1.1.3.cmml">f</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><apply id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">superscript</csymbol><ci id="S4.SS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2">𝐼</ci><ci id="S4.SS2.p3.5.m5.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">I^{f}</annotation></semantics></math> via the following constraint:</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\mathit{de-g}}=\|\hat{I}_{syn}^{f}-I_{syn}^{f}\|_{1}." display="block"><semantics id="S4.E9.m1.1a"><mrow id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><msub id="S4.E9.m1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E9.m1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.3.3.cmml"><mi id="S4.E9.m1.1.1.1.1.3.3.2" xref="S4.E9.m1.1.1.1.1.3.3.2.cmml">𝑑𝑒</mi><mo id="S4.E9.m1.1.1.1.1.3.3.1" xref="S4.E9.m1.1.1.1.1.3.3.1.cmml">−</mo><mi id="S4.E9.m1.1.1.1.1.3.3.3" xref="S4.E9.m1.1.1.1.1.3.3.3.cmml">g</mi></mrow></msub><mo id="S4.E9.m1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.2.cmml">=</mo><msub id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E9.m1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E9.m1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">I</mi><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.1a" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.4" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.4.cmml">n</mi></mrow><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.3.cmml">f</mi></msubsup><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.E9.m1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">I</mi><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.1a" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.4" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.4.cmml">n</mi></mrow><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml">f</mi></msubsup></mrow><mo stretchy="false" id="S4.E9.m1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E9.m1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.3.cmml">1</mn></msub></mrow><mo lspace="0em" id="S4.E9.m1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"><eq id="S4.E9.m1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.2"></eq><apply id="S4.E9.m1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.3.2">ℒ</ci><apply id="S4.E9.m1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.3.3"><minus id="S4.E9.m1.1.1.1.1.3.3.1.cmml" xref="S4.E9.m1.1.1.1.1.3.3.1"></minus><ci id="S4.E9.m1.1.1.1.1.3.3.2.cmml" xref="S4.E9.m1.1.1.1.1.3.3.2">𝑑𝑒</ci><ci id="S4.E9.m1.1.1.1.1.3.3.3.cmml" xref="S4.E9.m1.1.1.1.1.3.3.3">𝑔</ci></apply></apply><apply id="S4.E9.m1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1">subscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1"><minus id="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.2"><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝐼</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3"><times id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.2">𝑠</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.3">𝑦</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.4.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.3.4">𝑛</ci></apply></apply><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.3">𝑓</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.2">𝐼</ci><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3"><times id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.2">𝑠</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.3">𝑦</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.3.4">𝑛</ci></apply></apply><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3">𝑓</ci></apply></apply></apply><cn type="integer" id="S4.E9.m1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">\mathcal{L}_{\mathit{de-g}}=\|\hat{I}_{syn}^{f}-I_{syn}^{f}\|_{1}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p3.6" class="ltx_p">where <math id="S4.SS2.p3.6.m1.1" class="ltx_Math" alttext="\hat{I}^{f}_{syn}" display="inline"><semantics id="S4.SS2.p3.6.m1.1a"><msubsup id="S4.SS2.p3.6.m1.1.1" xref="S4.SS2.p3.6.m1.1.1.cmml"><mover accent="true" id="S4.SS2.p3.6.m1.1.1.2.2" xref="S4.SS2.p3.6.m1.1.1.2.2.cmml"><mi id="S4.SS2.p3.6.m1.1.1.2.2.2" xref="S4.SS2.p3.6.m1.1.1.2.2.2.cmml">I</mi><mo id="S4.SS2.p3.6.m1.1.1.2.2.1" xref="S4.SS2.p3.6.m1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.SS2.p3.6.m1.1.1.3" xref="S4.SS2.p3.6.m1.1.1.3.cmml"><mi id="S4.SS2.p3.6.m1.1.1.3.2" xref="S4.SS2.p3.6.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.6.m1.1.1.3.1" xref="S4.SS2.p3.6.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p3.6.m1.1.1.3.3" xref="S4.SS2.p3.6.m1.1.1.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.6.m1.1.1.3.1a" xref="S4.SS2.p3.6.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p3.6.m1.1.1.3.4" xref="S4.SS2.p3.6.m1.1.1.3.4.cmml">n</mi></mrow><mi id="S4.SS2.p3.6.m1.1.1.2.3" xref="S4.SS2.p3.6.m1.1.1.2.3.cmml">f</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m1.1b"><apply id="S4.SS2.p3.6.m1.1.1.cmml" xref="S4.SS2.p3.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m1.1.1.1.cmml" xref="S4.SS2.p3.6.m1.1.1">subscript</csymbol><apply id="S4.SS2.p3.6.m1.1.1.2.cmml" xref="S4.SS2.p3.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m1.1.1.2.1.cmml" xref="S4.SS2.p3.6.m1.1.1">superscript</csymbol><apply id="S4.SS2.p3.6.m1.1.1.2.2.cmml" xref="S4.SS2.p3.6.m1.1.1.2.2"><ci id="S4.SS2.p3.6.m1.1.1.2.2.1.cmml" xref="S4.SS2.p3.6.m1.1.1.2.2.1">^</ci><ci id="S4.SS2.p3.6.m1.1.1.2.2.2.cmml" xref="S4.SS2.p3.6.m1.1.1.2.2.2">𝐼</ci></apply><ci id="S4.SS2.p3.6.m1.1.1.2.3.cmml" xref="S4.SS2.p3.6.m1.1.1.2.3">𝑓</ci></apply><apply id="S4.SS2.p3.6.m1.1.1.3.cmml" xref="S4.SS2.p3.6.m1.1.1.3"><times id="S4.SS2.p3.6.m1.1.1.3.1.cmml" xref="S4.SS2.p3.6.m1.1.1.3.1"></times><ci id="S4.SS2.p3.6.m1.1.1.3.2.cmml" xref="S4.SS2.p3.6.m1.1.1.3.2">𝑠</ci><ci id="S4.SS2.p3.6.m1.1.1.3.3.cmml" xref="S4.SS2.p3.6.m1.1.1.3.3">𝑦</ci><ci id="S4.SS2.p3.6.m1.1.1.3.4.cmml" xref="S4.SS2.p3.6.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m1.1c">\hat{I}^{f}_{syn}</annotation></semantics></math> represents the output of our De-Glass Network.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.3" class="ltx_p">To sum up, the training loss for the item removal stage is formulated as</p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E10.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\mathit{remove}}=\lambda_{de-s}\mathcal{L}_{de-s}+\lambda_{de-g}\mathcal{L}_{de-g}," display="block"><semantics id="S4.E10.m1.1a"><mrow id="S4.E10.m1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml"><mrow id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml"><msub id="S4.E10.m1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.1.1.1.1.2.2" xref="S4.E10.m1.1.1.1.1.2.2.cmml">ℒ</mi><mi id="S4.E10.m1.1.1.1.1.2.3" xref="S4.E10.m1.1.1.1.1.2.3.cmml">𝑟𝑒𝑚𝑜𝑣𝑒</mi></msub><mo id="S4.E10.m1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E10.m1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.3.cmml"><mrow id="S4.E10.m1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.3.2.cmml"><msub id="S4.E10.m1.1.1.1.1.3.2.2" xref="S4.E10.m1.1.1.1.1.3.2.2.cmml"><mi id="S4.E10.m1.1.1.1.1.3.2.2.2" xref="S4.E10.m1.1.1.1.1.3.2.2.2.cmml">λ</mi><mrow id="S4.E10.m1.1.1.1.1.3.2.2.3" xref="S4.E10.m1.1.1.1.1.3.2.2.3.cmml"><mrow id="S4.E10.m1.1.1.1.1.3.2.2.3.2" xref="S4.E10.m1.1.1.1.1.3.2.2.3.2.cmml"><mi id="S4.E10.m1.1.1.1.1.3.2.2.3.2.2" xref="S4.E10.m1.1.1.1.1.3.2.2.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.3.2.2.3.2.1" xref="S4.E10.m1.1.1.1.1.3.2.2.3.2.1.cmml">​</mo><mi id="S4.E10.m1.1.1.1.1.3.2.2.3.2.3" xref="S4.E10.m1.1.1.1.1.3.2.2.3.2.3.cmml">e</mi></mrow><mo id="S4.E10.m1.1.1.1.1.3.2.2.3.1" xref="S4.E10.m1.1.1.1.1.3.2.2.3.1.cmml">−</mo><mi id="S4.E10.m1.1.1.1.1.3.2.2.3.3" xref="S4.E10.m1.1.1.1.1.3.2.2.3.3.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.3.2.1" xref="S4.E10.m1.1.1.1.1.3.2.1.cmml">​</mo><msub id="S4.E10.m1.1.1.1.1.3.2.3" xref="S4.E10.m1.1.1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.1.1.1.1.3.2.3.2" xref="S4.E10.m1.1.1.1.1.3.2.3.2.cmml">ℒ</mi><mrow id="S4.E10.m1.1.1.1.1.3.2.3.3" xref="S4.E10.m1.1.1.1.1.3.2.3.3.cmml"><mrow id="S4.E10.m1.1.1.1.1.3.2.3.3.2" xref="S4.E10.m1.1.1.1.1.3.2.3.3.2.cmml"><mi id="S4.E10.m1.1.1.1.1.3.2.3.3.2.2" xref="S4.E10.m1.1.1.1.1.3.2.3.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.3.2.3.3.2.1" xref="S4.E10.m1.1.1.1.1.3.2.3.3.2.1.cmml">​</mo><mi id="S4.E10.m1.1.1.1.1.3.2.3.3.2.3" xref="S4.E10.m1.1.1.1.1.3.2.3.3.2.3.cmml">e</mi></mrow><mo id="S4.E10.m1.1.1.1.1.3.2.3.3.1" xref="S4.E10.m1.1.1.1.1.3.2.3.3.1.cmml">−</mo><mi id="S4.E10.m1.1.1.1.1.3.2.3.3.3" xref="S4.E10.m1.1.1.1.1.3.2.3.3.3.cmml">s</mi></mrow></msub></mrow><mo id="S4.E10.m1.1.1.1.1.3.1" xref="S4.E10.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E10.m1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.3.3.cmml"><msub id="S4.E10.m1.1.1.1.1.3.3.2" xref="S4.E10.m1.1.1.1.1.3.3.2.cmml"><mi id="S4.E10.m1.1.1.1.1.3.3.2.2" xref="S4.E10.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mrow id="S4.E10.m1.1.1.1.1.3.3.2.3" xref="S4.E10.m1.1.1.1.1.3.3.2.3.cmml"><mrow id="S4.E10.m1.1.1.1.1.3.3.2.3.2" xref="S4.E10.m1.1.1.1.1.3.3.2.3.2.cmml"><mi id="S4.E10.m1.1.1.1.1.3.3.2.3.2.2" xref="S4.E10.m1.1.1.1.1.3.3.2.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.3.3.2.3.2.1" xref="S4.E10.m1.1.1.1.1.3.3.2.3.2.1.cmml">​</mo><mi id="S4.E10.m1.1.1.1.1.3.3.2.3.2.3" xref="S4.E10.m1.1.1.1.1.3.3.2.3.2.3.cmml">e</mi></mrow><mo id="S4.E10.m1.1.1.1.1.3.3.2.3.1" xref="S4.E10.m1.1.1.1.1.3.3.2.3.1.cmml">−</mo><mi id="S4.E10.m1.1.1.1.1.3.3.2.3.3" xref="S4.E10.m1.1.1.1.1.3.3.2.3.3.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.3.3.1" xref="S4.E10.m1.1.1.1.1.3.3.1.cmml">​</mo><msub id="S4.E10.m1.1.1.1.1.3.3.3" xref="S4.E10.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.1.1.1.1.3.3.3.2" xref="S4.E10.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S4.E10.m1.1.1.1.1.3.3.3.3" xref="S4.E10.m1.1.1.1.1.3.3.3.3.cmml"><mrow id="S4.E10.m1.1.1.1.1.3.3.3.3.2" xref="S4.E10.m1.1.1.1.1.3.3.3.3.2.cmml"><mi id="S4.E10.m1.1.1.1.1.3.3.3.3.2.2" xref="S4.E10.m1.1.1.1.1.3.3.3.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.3.3.3.3.2.1" xref="S4.E10.m1.1.1.1.1.3.3.3.3.2.1.cmml">​</mo><mi id="S4.E10.m1.1.1.1.1.3.3.3.3.2.3" xref="S4.E10.m1.1.1.1.1.3.3.3.3.2.3.cmml">e</mi></mrow><mo id="S4.E10.m1.1.1.1.1.3.3.3.3.1" xref="S4.E10.m1.1.1.1.1.3.3.3.3.1.cmml">−</mo><mi id="S4.E10.m1.1.1.1.1.3.3.3.3.3" xref="S4.E10.m1.1.1.1.1.3.3.3.3.3.cmml">g</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.E10.m1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.1b"><apply id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1"><eq id="S4.E10.m1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1"></eq><apply id="S4.E10.m1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.1.1.1.1.2.2">ℒ</ci><ci id="S4.E10.m1.1.1.1.1.2.3.cmml" xref="S4.E10.m1.1.1.1.1.2.3">𝑟𝑒𝑚𝑜𝑣𝑒</ci></apply><apply id="S4.E10.m1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.3"><plus id="S4.E10.m1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3.1"></plus><apply id="S4.E10.m1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2"><times id="S4.E10.m1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.3.2.1"></times><apply id="S4.E10.m1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2.2">𝜆</ci><apply id="S4.E10.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2.3"><minus id="S4.E10.m1.1.1.1.1.3.2.2.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2.3.1"></minus><apply id="S4.E10.m1.1.1.1.1.3.2.2.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2.3.2"><times id="S4.E10.m1.1.1.1.1.3.2.2.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2.3.2.1"></times><ci id="S4.E10.m1.1.1.1.1.3.2.2.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2.3.2.2">𝑑</ci><ci id="S4.E10.m1.1.1.1.1.3.2.2.3.2.3.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2.3.2.3">𝑒</ci></apply><ci id="S4.E10.m1.1.1.1.1.3.2.2.3.3.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2.3.3">𝑠</ci></apply></apply><apply id="S4.E10.m1.1.1.1.1.3.2.3.cmml" xref="S4.E10.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2.3.2">ℒ</ci><apply id="S4.E10.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E10.m1.1.1.1.1.3.2.3.3"><minus id="S4.E10.m1.1.1.1.1.3.2.3.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3.2.3.3.1"></minus><apply id="S4.E10.m1.1.1.1.1.3.2.3.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2.3.3.2"><times id="S4.E10.m1.1.1.1.1.3.2.3.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.3.2.3.3.2.1"></times><ci id="S4.E10.m1.1.1.1.1.3.2.3.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2.3.3.2.2">𝑑</ci><ci id="S4.E10.m1.1.1.1.1.3.2.3.3.2.3.cmml" xref="S4.E10.m1.1.1.1.1.3.2.3.3.2.3">𝑒</ci></apply><ci id="S4.E10.m1.1.1.1.1.3.2.3.3.3.cmml" xref="S4.E10.m1.1.1.1.1.3.2.3.3.3">𝑠</ci></apply></apply></apply><apply id="S4.E10.m1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.1.3.3"><times id="S4.E10.m1.1.1.1.1.3.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3.3.1"></times><apply id="S4.E10.m1.1.1.1.1.3.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.3.3.2.2">𝜆</ci><apply id="S4.E10.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E10.m1.1.1.1.1.3.3.2.3"><minus id="S4.E10.m1.1.1.1.1.3.3.2.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3.3.2.3.1"></minus><apply id="S4.E10.m1.1.1.1.1.3.3.2.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3.3.2.3.2"><times id="S4.E10.m1.1.1.1.1.3.3.2.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.3.3.2.3.2.1"></times><ci id="S4.E10.m1.1.1.1.1.3.3.2.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.3.3.2.3.2.2">𝑑</ci><ci id="S4.E10.m1.1.1.1.1.3.3.2.3.2.3.cmml" xref="S4.E10.m1.1.1.1.1.3.3.2.3.2.3">𝑒</ci></apply><ci id="S4.E10.m1.1.1.1.1.3.3.2.3.3.cmml" xref="S4.E10.m1.1.1.1.1.3.3.2.3.3">𝑔</ci></apply></apply><apply id="S4.E10.m1.1.1.1.1.3.3.3.cmml" xref="S4.E10.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.3.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.3.3.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="S4.E10.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.E10.m1.1.1.1.1.3.3.3.3"><minus id="S4.E10.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3.3.3.3.1"></minus><apply id="S4.E10.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3.3.3.3.2"><times id="S4.E10.m1.1.1.1.1.3.3.3.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.3.3.3.3.2.1"></times><ci id="S4.E10.m1.1.1.1.1.3.3.3.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.3.3.3.3.2.2">𝑑</ci><ci id="S4.E10.m1.1.1.1.1.3.3.3.3.2.3.cmml" xref="S4.E10.m1.1.1.1.1.3.3.3.3.2.3">𝑒</ci></apply><ci id="S4.E10.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S4.E10.m1.1.1.1.1.3.3.3.3.3">𝑔</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.1c">\mathcal{L}_{\mathit{remove}}=\lambda_{de-s}\mathcal{L}_{de-s}+\lambda_{de-g}\mathcal{L}_{de-g},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p4.2" class="ltx_p">where <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="\lambda_{de-s}" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><msub id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">λ</mi><mrow id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml"><mrow id="S4.SS2.p4.1.m1.1.1.3.2" xref="S4.SS2.p4.1.m1.1.1.3.2.cmml"><mi id="S4.SS2.p4.1.m1.1.1.3.2.2" xref="S4.SS2.p4.1.m1.1.1.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.1.m1.1.1.3.2.1" xref="S4.SS2.p4.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S4.SS2.p4.1.m1.1.1.3.2.3" xref="S4.SS2.p4.1.m1.1.1.3.2.3.cmml">e</mi></mrow><mo id="S4.SS2.p4.1.m1.1.1.3.1" xref="S4.SS2.p4.1.m1.1.1.3.1.cmml">−</mo><mi id="S4.SS2.p4.1.m1.1.1.3.3" xref="S4.SS2.p4.1.m1.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">𝜆</ci><apply id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3"><minus id="S4.SS2.p4.1.m1.1.1.3.1.cmml" xref="S4.SS2.p4.1.m1.1.1.3.1"></minus><apply id="S4.SS2.p4.1.m1.1.1.3.2.cmml" xref="S4.SS2.p4.1.m1.1.1.3.2"><times id="S4.SS2.p4.1.m1.1.1.3.2.1.cmml" xref="S4.SS2.p4.1.m1.1.1.3.2.1"></times><ci id="S4.SS2.p4.1.m1.1.1.3.2.2.cmml" xref="S4.SS2.p4.1.m1.1.1.3.2.2">𝑑</ci><ci id="S4.SS2.p4.1.m1.1.1.3.2.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3.2.3">𝑒</ci></apply><ci id="S4.SS2.p4.1.m1.1.1.3.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\lambda_{de-s}</annotation></semantics></math> and <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="\lambda_{de-g}" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><msub id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">λ</mi><mrow id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml"><mrow id="S4.SS2.p4.2.m2.1.1.3.2" xref="S4.SS2.p4.2.m2.1.1.3.2.cmml"><mi id="S4.SS2.p4.2.m2.1.1.3.2.2" xref="S4.SS2.p4.2.m2.1.1.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.2.m2.1.1.3.2.1" xref="S4.SS2.p4.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S4.SS2.p4.2.m2.1.1.3.2.3" xref="S4.SS2.p4.2.m2.1.1.3.2.3.cmml">e</mi></mrow><mo id="S4.SS2.p4.2.m2.1.1.3.1" xref="S4.SS2.p4.2.m2.1.1.3.1.cmml">−</mo><mi id="S4.SS2.p4.2.m2.1.1.3.3" xref="S4.SS2.p4.2.m2.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">𝜆</ci><apply id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3"><minus id="S4.SS2.p4.2.m2.1.1.3.1.cmml" xref="S4.SS2.p4.2.m2.1.1.3.1"></minus><apply id="S4.SS2.p4.2.m2.1.1.3.2.cmml" xref="S4.SS2.p4.2.m2.1.1.3.2"><times id="S4.SS2.p4.2.m2.1.1.3.2.1.cmml" xref="S4.SS2.p4.2.m2.1.1.3.2.1"></times><ci id="S4.SS2.p4.2.m2.1.1.3.2.2.cmml" xref="S4.SS2.p4.2.m2.1.1.3.2.2">𝑑</ci><ci id="S4.SS2.p4.2.m2.1.1.3.2.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3.2.3">𝑒</ci></apply><ci id="S4.SS2.p4.2.m2.1.1.3.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\lambda_{de-g}</annotation></semantics></math> are the weights for shadow and eyeglasses removal, respectively.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we first describe the datasets and our implementation details. Then, we compare our method with the state-of-the-art eyeglasses removal and image-to-image translation methods qualitatively and quantitatively.
Finally, we evaluate the key contributions of the proposed method via ablation study. Note that besides the results in <a href="#S0.F1" title="In Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, we will show more various results in our supplementary material.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Dataset.</span> We use our synthetic dataset described in <a href="#S3" title="3 Portrait Synthesis with Eyeglasses ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">3</span></a> and CelebA<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> to train the proposed network.
For synthetic dataset, we randomly sample 73 identities of the 438 identities. Each identity contains 20 face scans with different expressions. We combine the face scans randomly with 5 eyeglasses and 4 HDR lightings, finally generating 29,200 training samples.
CelebA is a real-world portrait dataset that contains 202,599 face images of 10,177 identities and is annotated with 5 landmarks and 40 binary attributes for each image. Using the attributes labels, we split 13,193 images with eyeglasses and 189,406 images without eyeglasses from it. Additionally, we adopt FFHQ<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> and MeGlass<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> for testing. FFHQ contains 70,000 high-quality portraits and it also covers accessories like eyeglasses. Using face parsing<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, we roughly split 11,778 images with eyeglasses from it. MeGlass is a dataset containing 1,710 identities and each identity has images with and without eyeglasses. This dataset is essential for identity preservation validation in <a href="#S5.SS1.SSS2" title="5.1.2 Quantitative Results ‣ 5.1 Comparison with State-of-the-art Methods ‣ 5 Experiments ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5.1.2</span></a>. We refer to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> to align all the images to a size of <math id="S5.p2.1.m1.1" class="ltx_Math" alttext="256\times 256" display="inline"><semantics id="S5.p2.1.m1.1a"><mrow id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml"><mn id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2.cmml">256</mn><mo lspace="0.222em" rspace="0.222em" id="S5.p2.1.m1.1.1.1" xref="S5.p2.1.m1.1.1.1.cmml">×</mo><mn id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1"><times id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1.1"></times><cn type="integer" id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">256</cn><cn type="integer" id="S5.p2.1.m1.1.1.3.cmml" xref="S5.p2.1.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">256\times 256</annotation></semantics></math> using facial landmarks.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.6" class="ltx_p"><span id="S5.p3.6.1" class="ltx_text ltx_font_bold">Implementation Details.</span> Our method is implemented with PyTorch. We use Adam optimizer<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> with <math id="S5.p3.1.m1.1" class="ltx_Math" alttext="\beta_{1}=0.5" display="inline"><semantics id="S5.p3.1.m1.1a"><mrow id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml"><msub id="S5.p3.1.m1.1.1.2" xref="S5.p3.1.m1.1.1.2.cmml"><mi id="S5.p3.1.m1.1.1.2.2" xref="S5.p3.1.m1.1.1.2.2.cmml">β</mi><mn id="S5.p3.1.m1.1.1.2.3" xref="S5.p3.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S5.p3.1.m1.1.1.1" xref="S5.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.p3.1.m1.1.1.3" xref="S5.p3.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><apply id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1"><eq id="S5.p3.1.m1.1.1.1.cmml" xref="S5.p3.1.m1.1.1.1"></eq><apply id="S5.p3.1.m1.1.1.2.cmml" xref="S5.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.p3.1.m1.1.1.2.1.cmml" xref="S5.p3.1.m1.1.1.2">subscript</csymbol><ci id="S5.p3.1.m1.1.1.2.2.cmml" xref="S5.p3.1.m1.1.1.2.2">𝛽</ci><cn type="integer" id="S5.p3.1.m1.1.1.2.3.cmml" xref="S5.p3.1.m1.1.1.2.3">1</cn></apply><cn type="float" id="S5.p3.1.m1.1.1.3.cmml" xref="S5.p3.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">\beta_{1}=0.5</annotation></semantics></math> and <math id="S5.p3.2.m2.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S5.p3.2.m2.1a"><mrow id="S5.p3.2.m2.1.1" xref="S5.p3.2.m2.1.1.cmml"><msub id="S5.p3.2.m2.1.1.2" xref="S5.p3.2.m2.1.1.2.cmml"><mi id="S5.p3.2.m2.1.1.2.2" xref="S5.p3.2.m2.1.1.2.2.cmml">β</mi><mn id="S5.p3.2.m2.1.1.2.3" xref="S5.p3.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S5.p3.2.m2.1.1.1" xref="S5.p3.2.m2.1.1.1.cmml">=</mo><mn id="S5.p3.2.m2.1.1.3" xref="S5.p3.2.m2.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.2.m2.1b"><apply id="S5.p3.2.m2.1.1.cmml" xref="S5.p3.2.m2.1.1"><eq id="S5.p3.2.m2.1.1.1.cmml" xref="S5.p3.2.m2.1.1.1"></eq><apply id="S5.p3.2.m2.1.1.2.cmml" xref="S5.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.p3.2.m2.1.1.2.1.cmml" xref="S5.p3.2.m2.1.1.2">subscript</csymbol><ci id="S5.p3.2.m2.1.1.2.2.cmml" xref="S5.p3.2.m2.1.1.2.2">𝛽</ci><cn type="integer" id="S5.p3.2.m2.1.1.2.3.cmml" xref="S5.p3.2.m2.1.1.2.3">2</cn></apply><cn type="float" id="S5.p3.2.m2.1.1.3.cmml" xref="S5.p3.2.m2.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.2.m2.1c">\beta_{2}=0.999</annotation></semantics></math>. The learning rate is 0.0001 and the batch size is 8. For the weights in the objective functions in <a href="#S4.E7" title="In 4.1 Mask Prediction Stage ‣ 4 Portrait Eyeglasses Removal Network ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">7</span></a> and <a href="#S4.E10" title="In 4.2 Item Removal Stage ‣ 4 Portrait Eyeglasses Removal Network ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">10</span></a>, we set <math id="S5.p3.3.m3.1" class="ltx_Math" alttext="\lambda_{adv}=0.1" display="inline"><semantics id="S5.p3.3.m3.1a"><mrow id="S5.p3.3.m3.1.1" xref="S5.p3.3.m3.1.1.cmml"><msub id="S5.p3.3.m3.1.1.2" xref="S5.p3.3.m3.1.1.2.cmml"><mi id="S5.p3.3.m3.1.1.2.2" xref="S5.p3.3.m3.1.1.2.2.cmml">λ</mi><mrow id="S5.p3.3.m3.1.1.2.3" xref="S5.p3.3.m3.1.1.2.3.cmml"><mi id="S5.p3.3.m3.1.1.2.3.2" xref="S5.p3.3.m3.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.p3.3.m3.1.1.2.3.1" xref="S5.p3.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S5.p3.3.m3.1.1.2.3.3" xref="S5.p3.3.m3.1.1.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.p3.3.m3.1.1.2.3.1a" xref="S5.p3.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S5.p3.3.m3.1.1.2.3.4" xref="S5.p3.3.m3.1.1.2.3.4.cmml">v</mi></mrow></msub><mo id="S5.p3.3.m3.1.1.1" xref="S5.p3.3.m3.1.1.1.cmml">=</mo><mn id="S5.p3.3.m3.1.1.3" xref="S5.p3.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.3.m3.1b"><apply id="S5.p3.3.m3.1.1.cmml" xref="S5.p3.3.m3.1.1"><eq id="S5.p3.3.m3.1.1.1.cmml" xref="S5.p3.3.m3.1.1.1"></eq><apply id="S5.p3.3.m3.1.1.2.cmml" xref="S5.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S5.p3.3.m3.1.1.2.1.cmml" xref="S5.p3.3.m3.1.1.2">subscript</csymbol><ci id="S5.p3.3.m3.1.1.2.2.cmml" xref="S5.p3.3.m3.1.1.2.2">𝜆</ci><apply id="S5.p3.3.m3.1.1.2.3.cmml" xref="S5.p3.3.m3.1.1.2.3"><times id="S5.p3.3.m3.1.1.2.3.1.cmml" xref="S5.p3.3.m3.1.1.2.3.1"></times><ci id="S5.p3.3.m3.1.1.2.3.2.cmml" xref="S5.p3.3.m3.1.1.2.3.2">𝑎</ci><ci id="S5.p3.3.m3.1.1.2.3.3.cmml" xref="S5.p3.3.m3.1.1.2.3.3">𝑑</ci><ci id="S5.p3.3.m3.1.1.2.3.4.cmml" xref="S5.p3.3.m3.1.1.2.3.4">𝑣</ci></apply></apply><cn type="float" id="S5.p3.3.m3.1.1.3.cmml" xref="S5.p3.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.3.m3.1c">\lambda_{adv}=0.1</annotation></semantics></math>, <math id="S5.p3.4.m4.1" class="ltx_Math" alttext="\lambda_{mask}=1" display="inline"><semantics id="S5.p3.4.m4.1a"><mrow id="S5.p3.4.m4.1.1" xref="S5.p3.4.m4.1.1.cmml"><msub id="S5.p3.4.m4.1.1.2" xref="S5.p3.4.m4.1.1.2.cmml"><mi id="S5.p3.4.m4.1.1.2.2" xref="S5.p3.4.m4.1.1.2.2.cmml">λ</mi><mrow id="S5.p3.4.m4.1.1.2.3" xref="S5.p3.4.m4.1.1.2.3.cmml"><mi id="S5.p3.4.m4.1.1.2.3.2" xref="S5.p3.4.m4.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S5.p3.4.m4.1.1.2.3.1" xref="S5.p3.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S5.p3.4.m4.1.1.2.3.3" xref="S5.p3.4.m4.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.p3.4.m4.1.1.2.3.1a" xref="S5.p3.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S5.p3.4.m4.1.1.2.3.4" xref="S5.p3.4.m4.1.1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.p3.4.m4.1.1.2.3.1b" xref="S5.p3.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S5.p3.4.m4.1.1.2.3.5" xref="S5.p3.4.m4.1.1.2.3.5.cmml">k</mi></mrow></msub><mo id="S5.p3.4.m4.1.1.1" xref="S5.p3.4.m4.1.1.1.cmml">=</mo><mn id="S5.p3.4.m4.1.1.3" xref="S5.p3.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.4.m4.1b"><apply id="S5.p3.4.m4.1.1.cmml" xref="S5.p3.4.m4.1.1"><eq id="S5.p3.4.m4.1.1.1.cmml" xref="S5.p3.4.m4.1.1.1"></eq><apply id="S5.p3.4.m4.1.1.2.cmml" xref="S5.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S5.p3.4.m4.1.1.2.1.cmml" xref="S5.p3.4.m4.1.1.2">subscript</csymbol><ci id="S5.p3.4.m4.1.1.2.2.cmml" xref="S5.p3.4.m4.1.1.2.2">𝜆</ci><apply id="S5.p3.4.m4.1.1.2.3.cmml" xref="S5.p3.4.m4.1.1.2.3"><times id="S5.p3.4.m4.1.1.2.3.1.cmml" xref="S5.p3.4.m4.1.1.2.3.1"></times><ci id="S5.p3.4.m4.1.1.2.3.2.cmml" xref="S5.p3.4.m4.1.1.2.3.2">𝑚</ci><ci id="S5.p3.4.m4.1.1.2.3.3.cmml" xref="S5.p3.4.m4.1.1.2.3.3">𝑎</ci><ci id="S5.p3.4.m4.1.1.2.3.4.cmml" xref="S5.p3.4.m4.1.1.2.3.4">𝑠</ci><ci id="S5.p3.4.m4.1.1.2.3.5.cmml" xref="S5.p3.4.m4.1.1.2.3.5">𝑘</ci></apply></apply><cn type="integer" id="S5.p3.4.m4.1.1.3.cmml" xref="S5.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.4.m4.1c">\lambda_{mask}=1</annotation></semantics></math>, <math id="S5.p3.5.m5.1" class="ltx_Math" alttext="\lambda_{de-s}=1" display="inline"><semantics id="S5.p3.5.m5.1a"><mrow id="S5.p3.5.m5.1.1" xref="S5.p3.5.m5.1.1.cmml"><msub id="S5.p3.5.m5.1.1.2" xref="S5.p3.5.m5.1.1.2.cmml"><mi id="S5.p3.5.m5.1.1.2.2" xref="S5.p3.5.m5.1.1.2.2.cmml">λ</mi><mrow id="S5.p3.5.m5.1.1.2.3" xref="S5.p3.5.m5.1.1.2.3.cmml"><mrow id="S5.p3.5.m5.1.1.2.3.2" xref="S5.p3.5.m5.1.1.2.3.2.cmml"><mi id="S5.p3.5.m5.1.1.2.3.2.2" xref="S5.p3.5.m5.1.1.2.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.p3.5.m5.1.1.2.3.2.1" xref="S5.p3.5.m5.1.1.2.3.2.1.cmml">​</mo><mi id="S5.p3.5.m5.1.1.2.3.2.3" xref="S5.p3.5.m5.1.1.2.3.2.3.cmml">e</mi></mrow><mo id="S5.p3.5.m5.1.1.2.3.1" xref="S5.p3.5.m5.1.1.2.3.1.cmml">−</mo><mi id="S5.p3.5.m5.1.1.2.3.3" xref="S5.p3.5.m5.1.1.2.3.3.cmml">s</mi></mrow></msub><mo id="S5.p3.5.m5.1.1.1" xref="S5.p3.5.m5.1.1.1.cmml">=</mo><mn id="S5.p3.5.m5.1.1.3" xref="S5.p3.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.5.m5.1b"><apply id="S5.p3.5.m5.1.1.cmml" xref="S5.p3.5.m5.1.1"><eq id="S5.p3.5.m5.1.1.1.cmml" xref="S5.p3.5.m5.1.1.1"></eq><apply id="S5.p3.5.m5.1.1.2.cmml" xref="S5.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.p3.5.m5.1.1.2.1.cmml" xref="S5.p3.5.m5.1.1.2">subscript</csymbol><ci id="S5.p3.5.m5.1.1.2.2.cmml" xref="S5.p3.5.m5.1.1.2.2">𝜆</ci><apply id="S5.p3.5.m5.1.1.2.3.cmml" xref="S5.p3.5.m5.1.1.2.3"><minus id="S5.p3.5.m5.1.1.2.3.1.cmml" xref="S5.p3.5.m5.1.1.2.3.1"></minus><apply id="S5.p3.5.m5.1.1.2.3.2.cmml" xref="S5.p3.5.m5.1.1.2.3.2"><times id="S5.p3.5.m5.1.1.2.3.2.1.cmml" xref="S5.p3.5.m5.1.1.2.3.2.1"></times><ci id="S5.p3.5.m5.1.1.2.3.2.2.cmml" xref="S5.p3.5.m5.1.1.2.3.2.2">𝑑</ci><ci id="S5.p3.5.m5.1.1.2.3.2.3.cmml" xref="S5.p3.5.m5.1.1.2.3.2.3">𝑒</ci></apply><ci id="S5.p3.5.m5.1.1.2.3.3.cmml" xref="S5.p3.5.m5.1.1.2.3.3">𝑠</ci></apply></apply><cn type="integer" id="S5.p3.5.m5.1.1.3.cmml" xref="S5.p3.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.5.m5.1c">\lambda_{de-s}=1</annotation></semantics></math>, and <math id="S5.p3.6.m6.1" class="ltx_Math" alttext="\lambda_{de-g}=1" display="inline"><semantics id="S5.p3.6.m6.1a"><mrow id="S5.p3.6.m6.1.1" xref="S5.p3.6.m6.1.1.cmml"><msub id="S5.p3.6.m6.1.1.2" xref="S5.p3.6.m6.1.1.2.cmml"><mi id="S5.p3.6.m6.1.1.2.2" xref="S5.p3.6.m6.1.1.2.2.cmml">λ</mi><mrow id="S5.p3.6.m6.1.1.2.3" xref="S5.p3.6.m6.1.1.2.3.cmml"><mrow id="S5.p3.6.m6.1.1.2.3.2" xref="S5.p3.6.m6.1.1.2.3.2.cmml"><mi id="S5.p3.6.m6.1.1.2.3.2.2" xref="S5.p3.6.m6.1.1.2.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.p3.6.m6.1.1.2.3.2.1" xref="S5.p3.6.m6.1.1.2.3.2.1.cmml">​</mo><mi id="S5.p3.6.m6.1.1.2.3.2.3" xref="S5.p3.6.m6.1.1.2.3.2.3.cmml">e</mi></mrow><mo id="S5.p3.6.m6.1.1.2.3.1" xref="S5.p3.6.m6.1.1.2.3.1.cmml">−</mo><mi id="S5.p3.6.m6.1.1.2.3.3" xref="S5.p3.6.m6.1.1.2.3.3.cmml">g</mi></mrow></msub><mo id="S5.p3.6.m6.1.1.1" xref="S5.p3.6.m6.1.1.1.cmml">=</mo><mn id="S5.p3.6.m6.1.1.3" xref="S5.p3.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.6.m6.1b"><apply id="S5.p3.6.m6.1.1.cmml" xref="S5.p3.6.m6.1.1"><eq id="S5.p3.6.m6.1.1.1.cmml" xref="S5.p3.6.m6.1.1.1"></eq><apply id="S5.p3.6.m6.1.1.2.cmml" xref="S5.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S5.p3.6.m6.1.1.2.1.cmml" xref="S5.p3.6.m6.1.1.2">subscript</csymbol><ci id="S5.p3.6.m6.1.1.2.2.cmml" xref="S5.p3.6.m6.1.1.2.2">𝜆</ci><apply id="S5.p3.6.m6.1.1.2.3.cmml" xref="S5.p3.6.m6.1.1.2.3"><minus id="S5.p3.6.m6.1.1.2.3.1.cmml" xref="S5.p3.6.m6.1.1.2.3.1"></minus><apply id="S5.p3.6.m6.1.1.2.3.2.cmml" xref="S5.p3.6.m6.1.1.2.3.2"><times id="S5.p3.6.m6.1.1.2.3.2.1.cmml" xref="S5.p3.6.m6.1.1.2.3.2.1"></times><ci id="S5.p3.6.m6.1.1.2.3.2.2.cmml" xref="S5.p3.6.m6.1.1.2.3.2.2">𝑑</ci><ci id="S5.p3.6.m6.1.1.2.3.2.3.cmml" xref="S5.p3.6.m6.1.1.2.3.2.3">𝑒</ci></apply><ci id="S5.p3.6.m6.1.1.2.3.3.cmml" xref="S5.p3.6.m6.1.1.2.3.3">𝑔</ci></apply></apply><cn type="integer" id="S5.p3.6.m6.1.1.3.cmml" xref="S5.p3.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.6.m6.1c">\lambda_{de-g}=1</annotation></semantics></math>. Apart from the DA Network and the discriminator, all the other networks utilize the architecture in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. In practice, we first train the cross-domain segmentation module for 30 epochs and fix it when training networks in the item removal stage, which needs 80 epochs. The total training process costs about two days on a single GTX 1080 GPU.</p>
</div>
<figure id="S5.F4" class="ltx_figure"><img src="/html/2203.10474/assets/cmp-v4.jpg" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="586" height="463" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.3.2" class="ltx_text" style="font-size:90%;">Qualitative cross-dataset results of different methods on FFHQ dataset (top) and MeGlass (bottom). </span></figcaption>
</figure>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Comparison with State-of-the-art Methods</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We compare our method with state-of-the-art eyeglasses removal methods: ERGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> and ByeGlassesGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, as well as image-to-image translation methods including CycleGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>, StarGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, ELEGANT<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>, pix2pix<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and HiSD<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>.
To ensure fair comparisons, all these methods and our method are not trained on the testing dataset. Specifically, to compare with ERGAN and HiSD, we directly use their released models which are trained on CelebA and CelebA-HQ<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, respectively. For CycleGAN, StarGAN and ELEGANT, we train them on the task of eyeglasses removal using their codes and the CelebA dataset.
As pix2pix needs paired data, we train it on our synthetic data using the released code. As we cannot reach the authors of ByeGlassesGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> to conduct a comparison experiment, we just show qualitative comparison using the images posted in their paper. Note that the purpose of the comparisons is not to purely compare different methods in the same setting but to demonstrate which solution better solves the problem.</p>
</div>
<section id="S5.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Qualitative Comparison</h4>

<div id="S5.SS1.SSS1.p1" class="ltx_para">
<p id="S5.SS1.SSS1.p1.1" class="ltx_p">We first compare the visual quality of our method with prior works on various images from FFHQ and MeGlass, covering different ages, genders, head poses, illuminations, eyeglasses shapes and textures.
As shown in <a href="#S5.F4" title="In 5 Experiments ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, our method achieves the best quality compared to the previous works.
ELEGANT fails to remove the frames of the eyeglasses on all the test images. ERGAN can remove eyeglasses, but the eyeglasses regions are always blurred. CycleGAN, StarGAN and pix2pix preserve the high-frequency details in the whole eyeglasses regions, but they cannot completely remove eyeglasses for some samples. HiSD seems competitive to ours on some easy samples, but it fails to remove sharp cast shadows (1st row) as well as
eyeglasses with unusual shape (5th row) and texture (2nd row). Benefiting from the mask-guided learning and our synthetic data, our method can remove various eyeglasses and the corresponding cast shadows. In addition, it generates photo-realistic contents in the regions occluded by eyeglasses or shadows, and retains the consistency with the global illumination and the skin texture of the surrounding regions.
For ByeGlassesGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, we only perform the comparison using the images posted in their paper. Results are shown in <a href="#S5.F5" title="In 5.1.1 Qualitative Comparison ‣ 5.1 Comparison with State-of-the-art Methods ‣ 5 Experiments ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> and we can see that our method outperforms theirs in the shadow removal.</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="/html/2203.10474/assets/cmp_bgg-v4.jpg" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="550" height="357" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S5.F5.3.2" class="ltx_text" style="font-size:90%;">Qualitative comparison with ByeGlassesGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> using images from their paper. </span></figcaption>
</figure>
</section>
<section id="S5.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Quantitative Results</h4>

<div id="S5.SS1.SSS2.p1" class="ltx_para">
<p id="S5.SS1.SSS2.p1.1" class="ltx_p">For quantitative comparisons, we first use Fréchet Inception Distance (FID)<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> to evaluate the realism of the generated images. Then, we apply face recognition technique to evaluate the ability of identity preservation. Finally, we adopt a user study to further evaluate the visual quality of eyeglasses removal.</p>
</div>
<div id="S5.SS1.SSS2.p2" class="ltx_para">
<p id="S5.SS1.SSS2.p2.1" class="ltx_p"><span id="S5.SS1.SSS2.p2.1.1" class="ltx_text ltx_font_bold">Realism.</span>
First, we process the images with eyegalsses in FFHQ by different methods. Then, we compute the FID between the eyeglasses-removed results and the images without eyeglasses in FFHQ. The results (<a href="#S5.T1" title="In 5.1.2 Quantitative Results ‣ 5.1 Comparison with State-of-the-art Methods ‣ 5 Experiments ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, 1st col) show that our method is competitive with HiSD and outperforms the other methods. This indicates that images generated by ours and HiSD are probably close to the real images without eyeglasses. Note that realism is a subjective measurement that can not be fully represented by FID. For further evaluation, we adopt a <span id="S5.SS1.SSS2.p2.1.2" class="ltx_text ltx_font_bold">user study</span> later.</p>
</div>
<div id="S5.SS1.SSS2.p3" class="ltx_para">
<p id="S5.SS1.SSS2.p3.1" class="ltx_p"><span id="S5.SS1.SSS2.p3.1.1" class="ltx_text ltx_font_bold">Identity Preservation.</span>
To evaluate the identity preservation ability, we use some metrics commonly used in face recognition<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, including the True Accept Rate at False Accept Rate (TAR@FAR) and Rank-1. To compute these metrics, we first collect 1,227 image triplets from MeGlass dataset. Each triplet contains three images of the same identity: two without eyeglasses and one with eyeglasses. Then, we input the image with eyeglasses into different methods to acquire corresponding eyeglasses-removed results. Finally, we select the first eyeglasses-free image in the triplet as the gallery and all the other images as probes to compute the metrics based on a pre-trained face recognition network<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. As shown in <a href="#S5.T1" title="In 5.1.2 Quantitative Results ‣ 5.1 Comparison with State-of-the-art Methods ‣ 5 Experiments ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, the second eyeglasses-free image in the triplet (<span id="S5.SS1.SSS2.p3.1.2" class="ltx_text ltx_font_italic">noglass</span>) achieves high face recognition accuracy as it is a real image containing full identity information. However, the accuracy will degrade when taking the images with eyeglasses as the probe (<span id="S5.SS1.SSS2.p3.1.3" class="ltx_text ltx_font_italic">glass</span>), indicating the negative effects of eyeglasses in face recognition. ERGAN, CycleGAN, ELEGANT and pix2pix lead to the further degradation of face recognition after eyeglasses removal while StarGAN and HiSD enhance the metrics. Our method exhibits the most significant increase, which stands for the best ability of eyeglasses removal and identity preservation.</p>
</div>
<div id="S5.SS1.SSS2.p4" class="ltx_para">
<p id="S5.SS1.SSS2.p4.1" class="ltx_p"><span id="S5.SS1.SSS2.p4.1.1" class="ltx_text ltx_font_bold">User Study.</span> A user study is conducted to further evaluate the visual quality of eyeglasses removal. In detail, we combine the results of different methods together with the input image to construct a “question”. Participants are asked to give their opinions based on the visual quality, scoring different results from 1 to 5 (1 for the worst, 5 for the best). In total, we invite 40 participants and each participant is asked to answer 20 randomly sampled “questions”. As shown in <a href="#S5.T1" title="In 5.1.2 Quantitative Results ‣ 5.1 Comparison with State-of-the-art Methods ‣ 5 Experiments ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, our method has the highest Mean Opinion Score (MOS), indicating the superiority of our technique.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<table id="S5.T1.6" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T1.4.4" class="ltx_tr">
<td id="S5.T1.4.4.5" class="ltx_td ltx_border_r ltx_border_tt" rowspan="2"></td>
<td id="S5.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S5.T1.1.1.1.1" class="ltx_text" style="font-size:80%;">FID<math id="S5.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T1.1.1.1.1.m1.1a"><mo stretchy="false" id="S5.T1.1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.1.m1.1b"><ci id="S5.T1.1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S5.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S5.T1.2.2.2.1" class="ltx_text" style="font-size:80%;">MOS<math id="S5.T1.2.2.2.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.2.2.2.1.m1.1a"><mo stretchy="false" id="S5.T1.2.2.2.1.m1.1.1" xref="S5.T1.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.2.1.m1.1b"><ci id="S5.T1.2.2.2.1.m1.1.1.cmml" xref="S5.T1.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.2.1.m1.1c">\uparrow</annotation></semantics></math></span></td>
<td id="S5.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">
<span id="S5.T1.3.3.3.1" class="ltx_text" style="font-size:80%;">TAR@FAR</span><math id="S5.T1.3.3.3.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.3.3.3.m1.1a"><mo mathsize="80%" stretchy="false" id="S5.T1.3.3.3.m1.1.1" xref="S5.T1.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.3.3.3.m1.1b"><ci id="S5.T1.3.3.3.m1.1.1.cmml" xref="S5.T1.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.3.3.m1.1c">\uparrow</annotation></semantics></math>
</td>
<td id="S5.T1.4.4.4" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S5.T1.4.4.4.1" class="ltx_text" style="font-size:80%;">Rank-1<math id="S5.T1.4.4.4.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.4.4.4.1.m1.1a"><mo stretchy="false" id="S5.T1.4.4.4.1.m1.1.1" xref="S5.T1.4.4.4.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.4.4.4.1.m1.1b"><ci id="S5.T1.4.4.4.1.m1.1.1.cmml" xref="S5.T1.4.4.4.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.4.4.1.m1.1c">\uparrow</annotation></semantics></math></span></td>
</tr>
<tr id="S5.T1.6.6" class="ltx_tr">
<td id="S5.T1.5.5.1" class="ltx_td ltx_align_center"><math id="S5.T1.5.5.1.m1.1" class="ltx_Math" alttext="1e^{-2}" display="inline"><semantics id="S5.T1.5.5.1.m1.1a"><mrow id="S5.T1.5.5.1.m1.1.1" xref="S5.T1.5.5.1.m1.1.1.cmml"><mn mathsize="80%" id="S5.T1.5.5.1.m1.1.1.2" xref="S5.T1.5.5.1.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.T1.5.5.1.m1.1.1.1" xref="S5.T1.5.5.1.m1.1.1.1.cmml">​</mo><msup id="S5.T1.5.5.1.m1.1.1.3" xref="S5.T1.5.5.1.m1.1.1.3.cmml"><mi mathsize="80%" id="S5.T1.5.5.1.m1.1.1.3.2" xref="S5.T1.5.5.1.m1.1.1.3.2.cmml">e</mi><mrow id="S5.T1.5.5.1.m1.1.1.3.3" xref="S5.T1.5.5.1.m1.1.1.3.3.cmml"><mo mathsize="80%" id="S5.T1.5.5.1.m1.1.1.3.3a" xref="S5.T1.5.5.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="80%" id="S5.T1.5.5.1.m1.1.1.3.3.2" xref="S5.T1.5.5.1.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.5.5.1.m1.1b"><apply id="S5.T1.5.5.1.m1.1.1.cmml" xref="S5.T1.5.5.1.m1.1.1"><times id="S5.T1.5.5.1.m1.1.1.1.cmml" xref="S5.T1.5.5.1.m1.1.1.1"></times><cn type="integer" id="S5.T1.5.5.1.m1.1.1.2.cmml" xref="S5.T1.5.5.1.m1.1.1.2">1</cn><apply id="S5.T1.5.5.1.m1.1.1.3.cmml" xref="S5.T1.5.5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T1.5.5.1.m1.1.1.3.1.cmml" xref="S5.T1.5.5.1.m1.1.1.3">superscript</csymbol><ci id="S5.T1.5.5.1.m1.1.1.3.2.cmml" xref="S5.T1.5.5.1.m1.1.1.3.2">𝑒</ci><apply id="S5.T1.5.5.1.m1.1.1.3.3.cmml" xref="S5.T1.5.5.1.m1.1.1.3.3"><minus id="S5.T1.5.5.1.m1.1.1.3.3.1.cmml" xref="S5.T1.5.5.1.m1.1.1.3.3"></minus><cn type="integer" id="S5.T1.5.5.1.m1.1.1.3.3.2.cmml" xref="S5.T1.5.5.1.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.5.1.m1.1c">1e^{-2}</annotation></semantics></math></td>
<td id="S5.T1.6.6.2" class="ltx_td ltx_align_center"><math id="S5.T1.6.6.2.m1.1" class="ltx_Math" alttext="1e^{-3}" display="inline"><semantics id="S5.T1.6.6.2.m1.1a"><mrow id="S5.T1.6.6.2.m1.1.1" xref="S5.T1.6.6.2.m1.1.1.cmml"><mn mathsize="80%" id="S5.T1.6.6.2.m1.1.1.2" xref="S5.T1.6.6.2.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.T1.6.6.2.m1.1.1.1" xref="S5.T1.6.6.2.m1.1.1.1.cmml">​</mo><msup id="S5.T1.6.6.2.m1.1.1.3" xref="S5.T1.6.6.2.m1.1.1.3.cmml"><mi mathsize="80%" id="S5.T1.6.6.2.m1.1.1.3.2" xref="S5.T1.6.6.2.m1.1.1.3.2.cmml">e</mi><mrow id="S5.T1.6.6.2.m1.1.1.3.3" xref="S5.T1.6.6.2.m1.1.1.3.3.cmml"><mo mathsize="80%" id="S5.T1.6.6.2.m1.1.1.3.3a" xref="S5.T1.6.6.2.m1.1.1.3.3.cmml">−</mo><mn mathsize="80%" id="S5.T1.6.6.2.m1.1.1.3.3.2" xref="S5.T1.6.6.2.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.6.6.2.m1.1b"><apply id="S5.T1.6.6.2.m1.1.1.cmml" xref="S5.T1.6.6.2.m1.1.1"><times id="S5.T1.6.6.2.m1.1.1.1.cmml" xref="S5.T1.6.6.2.m1.1.1.1"></times><cn type="integer" id="S5.T1.6.6.2.m1.1.1.2.cmml" xref="S5.T1.6.6.2.m1.1.1.2">1</cn><apply id="S5.T1.6.6.2.m1.1.1.3.cmml" xref="S5.T1.6.6.2.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T1.6.6.2.m1.1.1.3.1.cmml" xref="S5.T1.6.6.2.m1.1.1.3">superscript</csymbol><ci id="S5.T1.6.6.2.m1.1.1.3.2.cmml" xref="S5.T1.6.6.2.m1.1.1.3.2">𝑒</ci><apply id="S5.T1.6.6.2.m1.1.1.3.3.cmml" xref="S5.T1.6.6.2.m1.1.1.3.3"><minus id="S5.T1.6.6.2.m1.1.1.3.3.1.cmml" xref="S5.T1.6.6.2.m1.1.1.3.3"></minus><cn type="integer" id="S5.T1.6.6.2.m1.1.1.3.3.2.cmml" xref="S5.T1.6.6.2.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.6.2.m1.1c">1e^{-3}</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.6.7" class="ltx_tr">
<td id="S5.T1.6.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.6.7.1.1" class="ltx_text ltx_font_italic" style="font-size:80%;">glass</span></td>
<td id="S5.T1.6.7.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.7.2.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S5.T1.6.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.7.3.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S5.T1.6.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.7.4.1" class="ltx_text" style="font-size:80%;">0.6025</span></td>
<td id="S5.T1.6.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.7.5.1" class="ltx_text" style="font-size:80%;">0.3349</span></td>
<td id="S5.T1.6.7.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.7.6.1" class="ltx_text" style="font-size:80%;">0.3716</span></td>
</tr>
<tr id="S5.T1.6.8" class="ltx_tr">
<td id="S5.T1.6.8.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S5.T1.6.8.1.1" class="ltx_text" style="font-size:80%;">ERGAN</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T1.6.8.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib22" title="" class="ltx_ref">22</a><span id="S5.T1.6.8.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S5.T1.6.8.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.8.2.1" class="ltx_text" style="font-size:80%;">38.61</span></td>
<td id="S5.T1.6.8.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.8.3.1" class="ltx_text" style="font-size:80%;">1.10</span></td>
<td id="S5.T1.6.8.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.8.4.1" class="ltx_text" style="font-size:80%;">0.2839</span></td>
<td id="S5.T1.6.8.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.8.5.1" class="ltx_text" style="font-size:80%;">0.1005</span></td>
<td id="S5.T1.6.8.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.8.6.1" class="ltx_text" style="font-size:80%;">0.1439</span></td>
</tr>
<tr id="S5.T1.6.9" class="ltx_tr">
<td id="S5.T1.6.9.1" class="ltx_td ltx_align_center ltx_border_r">
<span id="S5.T1.6.9.1.1" class="ltx_text" style="font-size:80%;">CycleGAN</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T1.6.9.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib63" title="" class="ltx_ref">63</a><span id="S5.T1.6.9.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S5.T1.6.9.2" class="ltx_td ltx_align_center"><span id="S5.T1.6.9.2.1" class="ltx_text" style="font-size:80%;">38.10</span></td>
<td id="S5.T1.6.9.3" class="ltx_td ltx_align_center"><span id="S5.T1.6.9.3.1" class="ltx_text" style="font-size:80%;">2.21</span></td>
<td id="S5.T1.6.9.4" class="ltx_td ltx_align_center"><span id="S5.T1.6.9.4.1" class="ltx_text" style="font-size:80%;">0.5856</span></td>
<td id="S5.T1.6.9.5" class="ltx_td ltx_align_center"><span id="S5.T1.6.9.5.1" class="ltx_text" style="font-size:80%;">0.3186</span></td>
<td id="S5.T1.6.9.6" class="ltx_td ltx_align_center"><span id="S5.T1.6.9.6.1" class="ltx_text" style="font-size:80%;">0.3431</span></td>
</tr>
<tr id="S5.T1.6.10" class="ltx_tr">
<td id="S5.T1.6.10.1" class="ltx_td ltx_align_center ltx_border_r">
<span id="S5.T1.6.10.1.1" class="ltx_text" style="font-size:80%;">ELEGANT</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T1.6.10.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib57" title="" class="ltx_ref">57</a><span id="S5.T1.6.10.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S5.T1.6.10.2" class="ltx_td ltx_align_center"><span id="S5.T1.6.10.2.1" class="ltx_text" style="font-size:80%;">43.13</span></td>
<td id="S5.T1.6.10.3" class="ltx_td ltx_align_center"><span id="S5.T1.6.10.3.1" class="ltx_text" style="font-size:80%;">1.12</span></td>
<td id="S5.T1.6.10.4" class="ltx_td ltx_align_center"><span id="S5.T1.6.10.4.1" class="ltx_text" style="font-size:80%;">0.3531</span></td>
<td id="S5.T1.6.10.5" class="ltx_td ltx_align_center"><span id="S5.T1.6.10.5.1" class="ltx_text" style="font-size:80%;">0.1507</span></td>
<td id="S5.T1.6.10.6" class="ltx_td ltx_align_center"><span id="S5.T1.6.10.6.1" class="ltx_text" style="font-size:80%;">0.1862</span></td>
</tr>
<tr id="S5.T1.6.11" class="ltx_tr">
<td id="S5.T1.6.11.1" class="ltx_td ltx_align_center ltx_border_r">
<span id="S5.T1.6.11.1.1" class="ltx_text" style="font-size:80%;">StarGAN</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T1.6.11.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib9" title="" class="ltx_ref">9</a><span id="S5.T1.6.11.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S5.T1.6.11.2" class="ltx_td ltx_align_center"><span id="S5.T1.6.11.2.1" class="ltx_text" style="font-size:80%;">40.93</span></td>
<td id="S5.T1.6.11.3" class="ltx_td ltx_align_center"><span id="S5.T1.6.11.3.1" class="ltx_text" style="font-size:80%;">1.51</span></td>
<td id="S5.T1.6.11.4" class="ltx_td ltx_align_center"><span id="S5.T1.6.11.4.1" class="ltx_text" style="font-size:80%;">0.6435</span></td>
<td id="S5.T1.6.11.5" class="ltx_td ltx_align_center"><span id="S5.T1.6.11.5.1" class="ltx_text" style="font-size:80%;">0.3773</span></td>
<td id="S5.T1.6.11.6" class="ltx_td ltx_align_center"><span id="S5.T1.6.11.6.1" class="ltx_text" style="font-size:80%;">0.4107</span></td>
</tr>
<tr id="S5.T1.6.12" class="ltx_tr">
<td id="S5.T1.6.12.1" class="ltx_td ltx_align_center ltx_border_r">
<span id="S5.T1.6.12.1.1" class="ltx_text" style="font-size:80%;">HiSD</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T1.6.12.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib33" title="" class="ltx_ref">33</a><span id="S5.T1.6.12.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S5.T1.6.12.2" class="ltx_td ltx_align_center"><span id="S5.T1.6.12.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">26.74</span></td>
<td id="S5.T1.6.12.3" class="ltx_td ltx_align_center"><span id="S5.T1.6.12.3.1" class="ltx_text" style="font-size:80%;">3.17</span></td>
<td id="S5.T1.6.12.4" class="ltx_td ltx_align_center"><span id="S5.T1.6.12.4.1" class="ltx_text" style="font-size:80%;">0.6329</span></td>
<td id="S5.T1.6.12.5" class="ltx_td ltx_align_center"><span id="S5.T1.6.12.5.1" class="ltx_text" style="font-size:80%;">0.3757</span></td>
<td id="S5.T1.6.12.6" class="ltx_td ltx_align_center"><span id="S5.T1.6.12.6.1" class="ltx_text" style="font-size:80%;">0.3903</span></td>
</tr>
<tr id="S5.T1.6.13" class="ltx_tr">
<td id="S5.T1.6.13.1" class="ltx_td ltx_align_center ltx_border_r">
<span id="S5.T1.6.13.1.1" class="ltx_text" style="font-size:80%;">pix2pix</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T1.6.13.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib25" title="" class="ltx_ref">25</a><span id="S5.T1.6.13.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S5.T1.6.13.2" class="ltx_td ltx_align_center"><span id="S5.T1.6.13.2.1" class="ltx_text" style="font-size:80%;">41.42</span></td>
<td id="S5.T1.6.13.3" class="ltx_td ltx_align_center"><span id="S5.T1.6.13.3.1" class="ltx_text" style="font-size:80%;">1.52</span></td>
<td id="S5.T1.6.13.4" class="ltx_td ltx_align_center"><span id="S5.T1.6.13.4.1" class="ltx_text" style="font-size:80%;">0.5687</span></td>
<td id="S5.T1.6.13.5" class="ltx_td ltx_align_center"><span id="S5.T1.6.13.5.1" class="ltx_text" style="font-size:80%;">0.3015</span></td>
<td id="S5.T1.6.13.6" class="ltx_td ltx_align_center"><span id="S5.T1.6.13.6.1" class="ltx_text" style="font-size:80%;">0.3422</span></td>
</tr>
<tr id="S5.T1.6.14" class="ltx_tr">
<td id="S5.T1.6.14.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T1.6.14.1.1" class="ltx_text" style="font-size:80%;">Ours</span></td>
<td id="S5.T1.6.14.2" class="ltx_td ltx_align_center"><span id="S5.T1.6.14.2.1" class="ltx_text" style="font-size:80%;">26.89</span></td>
<td id="S5.T1.6.14.3" class="ltx_td ltx_align_center"><span id="S5.T1.6.14.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">4.43</span></td>
<td id="S5.T1.6.14.4" class="ltx_td ltx_align_center"><span id="S5.T1.6.14.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">0.6702</span></td>
<td id="S5.T1.6.14.5" class="ltx_td ltx_align_center"><span id="S5.T1.6.14.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">0.4315</span></td>
<td id="S5.T1.6.14.6" class="ltx_td ltx_align_center"><span id="S5.T1.6.14.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">0.4621</span></td>
</tr>
<tr id="S5.T1.6.15" class="ltx_tr">
<td id="S5.T1.6.15.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S5.T1.6.15.1.1" class="ltx_text ltx_font_italic" style="font-size:80%;">noglass</span></td>
<td id="S5.T1.6.15.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S5.T1.6.15.2.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S5.T1.6.15.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S5.T1.6.15.3.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S5.T1.6.15.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S5.T1.6.15.4.1" class="ltx_text" style="font-size:80%;">0.8295</span></td>
<td id="S5.T1.6.15.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S5.T1.6.15.5.1" class="ltx_text" style="font-size:80%;">0.6430</span></td>
<td id="S5.T1.6.15.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S5.T1.6.15.6.1" class="ltx_text" style="font-size:80%;">0.6625</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.10.1.1" class="ltx_text" style="font-size:113%;">Table 1</span>: </span><span id="S5.T1.11.2" class="ltx_text" style="font-size:113%;">Quantitative results of different methods.</span></figcaption>
</figure>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Ablation Study</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">In this subsection, we evaluate the performance of our key contributions in the mask prediction stage and the item removal stage.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p"><span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">Mask Prediction.</span>
We first conduct ablation studies for the mask prediction stage.
The first ablation removes the DA Network with two new segmentation networks trained on synthetic data only and tested on real data directly (<span id="S5.SS2.p2.1.2" class="ltx_text ltx_font_italic">w/o DA</span>). Results in <a href="#S5.F6" title="In 5.2 Ablation Study ‣ 5 Experiments ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a> show that without domain adaptation, the estimated eyeglasses masks are sometimes incomplete and thus lead the shadow mask prediction to produce even worse results.
The second ablation removes the multi-step strategy (in mask prediction) by using a single network to estimate the masks of eyeglasses and shadows together (<span id="S5.SS2.p2.1.3" class="ltx_text ltx_font_italic">w/o multi-step</span>). With the help of the DA network, the eyeglasses masks are properly estimated. However, as the eyeglasses masks can not help the shadow masks estimation in the single-step setting, the estimated shadow masks still have noticeable artifacts.
To further evaluate our assumption that the eyeglasses mask can guide the task of shadow mask prediction as shadows are caused by eyeglasses, we further conduct another ablation setting where the shadow mask is first predicted and then used as guidance in the eyeglasses mask prediction (<span id="S5.SS2.p2.1.4" class="ltx_text ltx_font_italic">SM-guided GM</span>). Its results
show that this multi-step setup will lead to worse shadow mask estimation. This further indicates the correctness of our assumption, and the order of the two tasks is important due to the causality between eyeglasses and shadows.</p>
</div>
<figure id="S5.F6" class="ltx_figure"><img src="/html/2203.10474/assets/abs2-v4.jpg" id="S5.F6.g1" class="ltx_graphics ltx_centering ltx_img_square" width="586" height="504" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S5.F6.3.2" class="ltx_text" style="font-size:90%;">Visualization of eyeglasses masks (green) and shadow masks (blue) of different ablations in the mask prediction stage. </span></figcaption>
</figure>
<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.5" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T2.3.3" class="ltx_tr">
<td id="S5.T2.3.3.4" class="ltx_td ltx_border_r ltx_border_tt" rowspan="2"></td>
<td id="S5.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S5.T2.1.1.1.1" class="ltx_text" style="font-size:80%;">FID<math id="S5.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.1.1.1.1.m1.1a"><mo stretchy="false" id="S5.T2.1.1.1.1.m1.1.1" xref="S5.T2.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.1.m1.1b"><ci id="S5.T2.1.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S5.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">
<span id="S5.T2.2.2.2.1" class="ltx_text" style="font-size:80%;">TAR@FAR</span><math id="S5.T2.2.2.2.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.2.2.2.m1.1a"><mo mathsize="80%" stretchy="false" id="S5.T2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><ci id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">\uparrow</annotation></semantics></math>
</td>
<td id="S5.T2.3.3.3" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S5.T2.3.3.3.1" class="ltx_text" style="font-size:80%;">Rank-1<math id="S5.T2.3.3.3.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.3.3.3.1.m1.1a"><mo stretchy="false" id="S5.T2.3.3.3.1.m1.1.1" xref="S5.T2.3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.1.m1.1b"><ci id="S5.T2.3.3.3.1.m1.1.1.cmml" xref="S5.T2.3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.1.m1.1c">\uparrow</annotation></semantics></math></span></td>
</tr>
<tr id="S5.T2.5.5" class="ltx_tr">
<td id="S5.T2.4.4.1" class="ltx_td ltx_align_center"><math id="S5.T2.4.4.1.m1.1" class="ltx_Math" alttext="1e^{-2}" display="inline"><semantics id="S5.T2.4.4.1.m1.1a"><mrow id="S5.T2.4.4.1.m1.1.1" xref="S5.T2.4.4.1.m1.1.1.cmml"><mn mathsize="80%" id="S5.T2.4.4.1.m1.1.1.2" xref="S5.T2.4.4.1.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.T2.4.4.1.m1.1.1.1" xref="S5.T2.4.4.1.m1.1.1.1.cmml">​</mo><msup id="S5.T2.4.4.1.m1.1.1.3" xref="S5.T2.4.4.1.m1.1.1.3.cmml"><mi mathsize="80%" id="S5.T2.4.4.1.m1.1.1.3.2" xref="S5.T2.4.4.1.m1.1.1.3.2.cmml">e</mi><mrow id="S5.T2.4.4.1.m1.1.1.3.3" xref="S5.T2.4.4.1.m1.1.1.3.3.cmml"><mo mathsize="80%" id="S5.T2.4.4.1.m1.1.1.3.3a" xref="S5.T2.4.4.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="80%" id="S5.T2.4.4.1.m1.1.1.3.3.2" xref="S5.T2.4.4.1.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.1.m1.1b"><apply id="S5.T2.4.4.1.m1.1.1.cmml" xref="S5.T2.4.4.1.m1.1.1"><times id="S5.T2.4.4.1.m1.1.1.1.cmml" xref="S5.T2.4.4.1.m1.1.1.1"></times><cn type="integer" id="S5.T2.4.4.1.m1.1.1.2.cmml" xref="S5.T2.4.4.1.m1.1.1.2">1</cn><apply id="S5.T2.4.4.1.m1.1.1.3.cmml" xref="S5.T2.4.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T2.4.4.1.m1.1.1.3.1.cmml" xref="S5.T2.4.4.1.m1.1.1.3">superscript</csymbol><ci id="S5.T2.4.4.1.m1.1.1.3.2.cmml" xref="S5.T2.4.4.1.m1.1.1.3.2">𝑒</ci><apply id="S5.T2.4.4.1.m1.1.1.3.3.cmml" xref="S5.T2.4.4.1.m1.1.1.3.3"><minus id="S5.T2.4.4.1.m1.1.1.3.3.1.cmml" xref="S5.T2.4.4.1.m1.1.1.3.3"></minus><cn type="integer" id="S5.T2.4.4.1.m1.1.1.3.3.2.cmml" xref="S5.T2.4.4.1.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.1.m1.1c">1e^{-2}</annotation></semantics></math></td>
<td id="S5.T2.5.5.2" class="ltx_td ltx_align_center"><math id="S5.T2.5.5.2.m1.1" class="ltx_Math" alttext="1e^{-3}" display="inline"><semantics id="S5.T2.5.5.2.m1.1a"><mrow id="S5.T2.5.5.2.m1.1.1" xref="S5.T2.5.5.2.m1.1.1.cmml"><mn mathsize="80%" id="S5.T2.5.5.2.m1.1.1.2" xref="S5.T2.5.5.2.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.T2.5.5.2.m1.1.1.1" xref="S5.T2.5.5.2.m1.1.1.1.cmml">​</mo><msup id="S5.T2.5.5.2.m1.1.1.3" xref="S5.T2.5.5.2.m1.1.1.3.cmml"><mi mathsize="80%" id="S5.T2.5.5.2.m1.1.1.3.2" xref="S5.T2.5.5.2.m1.1.1.3.2.cmml">e</mi><mrow id="S5.T2.5.5.2.m1.1.1.3.3" xref="S5.T2.5.5.2.m1.1.1.3.3.cmml"><mo mathsize="80%" id="S5.T2.5.5.2.m1.1.1.3.3a" xref="S5.T2.5.5.2.m1.1.1.3.3.cmml">−</mo><mn mathsize="80%" id="S5.T2.5.5.2.m1.1.1.3.3.2" xref="S5.T2.5.5.2.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.2.m1.1b"><apply id="S5.T2.5.5.2.m1.1.1.cmml" xref="S5.T2.5.5.2.m1.1.1"><times id="S5.T2.5.5.2.m1.1.1.1.cmml" xref="S5.T2.5.5.2.m1.1.1.1"></times><cn type="integer" id="S5.T2.5.5.2.m1.1.1.2.cmml" xref="S5.T2.5.5.2.m1.1.1.2">1</cn><apply id="S5.T2.5.5.2.m1.1.1.3.cmml" xref="S5.T2.5.5.2.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T2.5.5.2.m1.1.1.3.1.cmml" xref="S5.T2.5.5.2.m1.1.1.3">superscript</csymbol><ci id="S5.T2.5.5.2.m1.1.1.3.2.cmml" xref="S5.T2.5.5.2.m1.1.1.3.2">𝑒</ci><apply id="S5.T2.5.5.2.m1.1.1.3.3.cmml" xref="S5.T2.5.5.2.m1.1.1.3.3"><minus id="S5.T2.5.5.2.m1.1.1.3.3.1.cmml" xref="S5.T2.5.5.2.m1.1.1.3.3"></minus><cn type="integer" id="S5.T2.5.5.2.m1.1.1.3.3.2.cmml" xref="S5.T2.5.5.2.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.2.m1.1c">1e^{-3}</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.5.6" class="ltx_tr">
<td id="S5.T2.5.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.5.6.1.1" class="ltx_text" style="font-size:80%;">w/o DA</span></td>
<td id="S5.T2.5.6.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.5.6.2.1" class="ltx_text" style="font-size:80%;">27.45</span></td>
<td id="S5.T2.5.6.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.5.6.3.1" class="ltx_text" style="font-size:80%;">0.6463</span></td>
<td id="S5.T2.5.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.5.6.4.1" class="ltx_text" style="font-size:80%;">0.3977</span></td>
<td id="S5.T2.5.6.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.5.6.5.1" class="ltx_text" style="font-size:80%;">0.4392</span></td>
</tr>
<tr id="S5.T2.5.7" class="ltx_tr">
<td id="S5.T2.5.7.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.5.7.1.1" class="ltx_text" style="font-size:80%;">w/o multi-step</span></td>
<td id="S5.T2.5.7.2" class="ltx_td ltx_align_center"><span id="S5.T2.5.7.2.1" class="ltx_text" style="font-size:80%;">27.18</span></td>
<td id="S5.T2.5.7.3" class="ltx_td ltx_align_center"><span id="S5.T2.5.7.3.1" class="ltx_text" style="font-size:80%;">0.6683</span></td>
<td id="S5.T2.5.7.4" class="ltx_td ltx_align_center"><span id="S5.T2.5.7.4.1" class="ltx_text" style="font-size:80%;">0.4262</span></td>
<td id="S5.T2.5.7.5" class="ltx_td ltx_align_center"><span id="S5.T2.5.7.5.1" class="ltx_text" style="font-size:80%;">0.4458</span></td>
</tr>
<tr id="S5.T2.5.8" class="ltx_tr">
<td id="S5.T2.5.8.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.5.8.1.1" class="ltx_text" style="font-size:80%;">SM-guided GM</span></td>
<td id="S5.T2.5.8.2" class="ltx_td ltx_align_center"><span id="S5.T2.5.8.2.1" class="ltx_text" style="font-size:80%;">27.30</span></td>
<td id="S5.T2.5.8.3" class="ltx_td ltx_align_center"><span id="S5.T2.5.8.3.1" class="ltx_text" style="font-size:80%;">0.6641</span></td>
<td id="S5.T2.5.8.4" class="ltx_td ltx_align_center"><span id="S5.T2.5.8.4.1" class="ltx_text" style="font-size:80%;">0.4201</span></td>
<td id="S5.T2.5.8.5" class="ltx_td ltx_align_center"><span id="S5.T2.5.8.5.1" class="ltx_text" style="font-size:80%;">0.4523</span></td>
</tr>
<tr id="S5.T2.5.9" class="ltx_tr">
<td id="S5.T2.5.9.1" class="ltx_td ltx_align_center ltx_border_r">
<span id="S5.T2.5.9.1.1" class="ltx_text"></span><span id="S5.T2.5.9.1.2" class="ltx_text" style="font-size:80%;"> </span><span id="S5.T2.5.9.1.3" class="ltx_text" style="font-size:80%;">
<span id="S5.T2.5.9.1.3.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.5.9.1.3.1.1" class="ltx_tr">
<span id="S5.T2.5.9.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">GM-guided SM (ours)</span></span>
</span></span><span id="S5.T2.5.9.1.4" class="ltx_text"></span><span id="S5.T2.5.9.1.5" class="ltx_text" style="font-size:80%;"></span>
</td>
<td id="S5.T2.5.9.2" class="ltx_td ltx_align_center"><span id="S5.T2.5.9.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">26.89</span></td>
<td id="S5.T2.5.9.3" class="ltx_td ltx_align_center"><span id="S5.T2.5.9.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">0.6702</span></td>
<td id="S5.T2.5.9.4" class="ltx_td ltx_align_center"><span id="S5.T2.5.9.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">0.4315</span></td>
<td id="S5.T2.5.9.5" class="ltx_td ltx_align_center"><span id="S5.T2.5.9.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">0.4621</span></td>
</tr>
<tr id="S5.T2.5.10" class="ltx_tr">
<td id="S5.T2.5.10.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.5.10.1.1" class="ltx_text" style="font-size:80%;">w/o SM</span></td>
<td id="S5.T2.5.10.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.5.10.2.1" class="ltx_text" style="font-size:80%;">33.89</span></td>
<td id="S5.T2.5.10.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.5.10.3.1" class="ltx_text" style="font-size:80%;">0.6586</span></td>
<td id="S5.T2.5.10.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.5.10.4.1" class="ltx_text" style="font-size:80%;">0.3989</span></td>
<td id="S5.T2.5.10.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.5.10.5.1" class="ltx_text" style="font-size:80%;">0.4327</span></td>
</tr>
<tr id="S5.T2.5.11" class="ltx_tr">
<td id="S5.T2.5.11.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.5.11.1.1" class="ltx_text" style="font-size:80%;">w/o GM</span></td>
<td id="S5.T2.5.11.2" class="ltx_td ltx_align_center"><span id="S5.T2.5.11.2.1" class="ltx_text" style="font-size:80%;">42.80</span></td>
<td id="S5.T2.5.11.3" class="ltx_td ltx_align_center"><span id="S5.T2.5.11.3.1" class="ltx_text" style="font-size:80%;">0.6567</span></td>
<td id="S5.T2.5.11.4" class="ltx_td ltx_align_center"><span id="S5.T2.5.11.4.1" class="ltx_text" style="font-size:80%;">0.3846</span></td>
<td id="S5.T2.5.11.5" class="ltx_td ltx_align_center"><span id="S5.T2.5.11.5.1" class="ltx_text" style="font-size:80%;">0.4221</span></td>
</tr>
<tr id="S5.T2.5.12" class="ltx_tr">
<td id="S5.T2.5.12.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.5.12.1.1" class="ltx_text" style="font-size:80%;">w/o multi-step</span></td>
<td id="S5.T2.5.12.2" class="ltx_td ltx_align_center"><span id="S5.T2.5.12.2.1" class="ltx_text" style="font-size:80%;">28.66</span></td>
<td id="S5.T2.5.12.3" class="ltx_td ltx_align_center"><span id="S5.T2.5.12.3.1" class="ltx_text" style="font-size:80%;">0.6675</span></td>
<td id="S5.T2.5.12.4" class="ltx_td ltx_align_center"><span id="S5.T2.5.12.4.1" class="ltx_text" style="font-size:80%;">0.4197</span></td>
<td id="S5.T2.5.12.5" class="ltx_td ltx_align_center"><span id="S5.T2.5.12.5.1" class="ltx_text" style="font-size:80%;">0.4498</span></td>
</tr>
<tr id="S5.T2.5.13" class="ltx_tr">
<td id="S5.T2.5.13.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.5.13.1.1" class="ltx_text" style="font-size:80%;">De-Glass First</span></td>
<td id="S5.T2.5.13.2" class="ltx_td ltx_align_center"><span id="S5.T2.5.13.2.1" class="ltx_text" style="font-size:80%;">29.58</span></td>
<td id="S5.T2.5.13.3" class="ltx_td ltx_align_center"><span id="S5.T2.5.13.3.1" class="ltx_text" style="font-size:80%;">0.6590</span></td>
<td id="S5.T2.5.13.4" class="ltx_td ltx_align_center"><span id="S5.T2.5.13.4.1" class="ltx_text" style="font-size:80%;">0.4115</span></td>
<td id="S5.T2.5.13.5" class="ltx_td ltx_align_center"><span id="S5.T2.5.13.5.1" class="ltx_text" style="font-size:80%;">0.4417</span></td>
</tr>
<tr id="S5.T2.5.14" class="ltx_tr">
<td id="S5.T2.5.14.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">
<span id="S5.T2.5.14.1.1" class="ltx_text"></span><span id="S5.T2.5.14.1.2" class="ltx_text" style="font-size:80%;"> </span><span id="S5.T2.5.14.1.3" class="ltx_text" style="font-size:80%;">
<span id="S5.T2.5.14.1.3.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.5.14.1.3.1.1" class="ltx_tr">
<span id="S5.T2.5.14.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">De-Shadow First (ours)</span></span>
</span></span><span id="S5.T2.5.14.1.4" class="ltx_text"></span><span id="S5.T2.5.14.1.5" class="ltx_text" style="font-size:80%;"></span>
</td>
<td id="S5.T2.5.14.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.5.14.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">26.89</span></td>
<td id="S5.T2.5.14.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.5.14.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">0.6702</span></td>
<td id="S5.T2.5.14.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.5.14.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">0.4315</span></td>
<td id="S5.T2.5.14.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.5.14.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">0.4621</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.9.1.1" class="ltx_text" style="font-size:113%;">Table 2</span>: </span><span id="S5.T2.10.2" class="ltx_text" style="font-size:113%;">Quantitative comparison of different ablations in the mask prediction stage (top) and item removal stage (bottom).</span></figcaption>
</figure>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p"><span id="S5.SS2.p3.1.1" class="ltx_text ltx_font_bold">Item Removal.</span> Here, we evaluate the effect of mask guidance and the multi-step strategy (in item removal) by comparing different ablation settings.
We first train two ablation settings without using the shadow mask or the eyeglasses mask (<span id="S5.SS2.p3.1.2" class="ltx_text ltx_font_italic">w/o SM</span> and <span id="S5.SS2.p3.1.3" class="ltx_text ltx_font_italic">w/o GM</span>), respectively.
We also remove eyeglasses and shadows using one network to construct the third ablation setting (<span id="S5.SS2.p3.1.4" class="ltx_text ltx_font_italic">w/o multi-step</span>).
Similar to the mask prediction stage, we also invert the order of De-Shadow and De-Glass Network to get the fourth setting (<span id="S5.SS2.p3.1.5" class="ltx_text ltx_font_italic">De-Glass First</span>).
Qualitative results in <a href="#S5.F7" title="In 5.2 Ablation Study ‣ 5 Experiments ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a> obviously show that <span id="S5.SS2.p3.1.6" class="ltx_text ltx_font_italic">w/o SM</span> is weak at shadow removal while <span id="S5.SS2.p3.1.7" class="ltx_text ltx_font_italic">w/o GM</span> fails to remove the complete eyeglasses. Besides, <span id="S5.SS2.p3.1.8" class="ltx_text ltx_font_italic">w/o multi-step</span> and <span id="S5.SS2.p3.1.9" class="ltx_text ltx_font_italic">De-Glass First</span> also have noticeable degradation compared to the proposed method. Quantitative results in <a href="#S5.T2" title="In 5.2 Ablation Study ‣ 5 Experiments ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a> also manifest the advantages of the proposed method.</p>
</div>
<figure id="S5.F7" class="ltx_figure"><img src="/html/2203.10474/assets/abs1-v10.jpg" id="S5.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="586" height="339" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.2.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S5.F7.3.2" class="ltx_text" style="font-size:90%;">Qualitative results of different ablations in the item removal stage. </span></figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Limitations</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">Extensive experiments have shown that the proposed method achieves promising performance on real-world images across age, gender, head pose, illumination and eyeglasses. However, it currently does not perform well on images with extreme head pose or eyeglasses with colored lenses as shown in <a href="#S6.F8" title="In 6 Limitations ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">8</span></a>. A large head pose often results in extreme lens distortion, which is expensive to simulate in the portrait synthesis.
Eyeglasses with colored lenses, <em id="S6.p1.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S6.p1.1.2" class="ltx_text"></span> sunglasses, are still difficult to remove due to the complete occlusions of eyes.
A possible solution is to add more samples of these cases into the training dataset, which will be included in our future work.</p>
</div>
<figure id="S6.F8" class="ltx_figure"><img src="/html/2203.10474/assets/limitation3.jpg" id="S6.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="586" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F8.2.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="S6.F8.3.2" class="ltx_text" style="font-size:90%;">Limitations. Extreme head pose with effects of lenses (left) and colored lenses (right). These cases are difficult for most of the existing methods. Here, we only show comparisons to the most competitive method (HiSD). </span></figcaption>
</figure>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In this paper, we introduce a novel eyeglasses removal technique that first detects and then removes the eyeglasses using the mask-guided multi-step network architecture. To our best knowledge, the proposed method is the first attempt to remove the eyeglasses and their cast shadows simultaneously from a single portrait. Besides, we build a high-quality synthetic portrait dataset, which provides intermediate and final supervisions. In order to fill the gap between the synthetic and real domain, we apply the cross-domain segmentation module to predict the masks of eyeglasses and their cast shadows from a uniform domain for removal guidance. Both qualitative and quantitative experiments demonstrate that our method better preserves the original identity and achieves high realism on real portraits.</p>
</div>
<div id="S7.p2" class="ltx_para ltx_noindent">
<p id="S7.p2.1" class="ltx_p"><span id="S7.p2.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Acknowledgements.<span id="S7.p2.1.1.1" class="ltx_text ltx_font_medium"> We thank SenseTime Group Limited for providing computing resources. This work was supported by Beijing Natural Science Foundation (JQ19015), the NSFC (No.61727808, 62021002), the National Key R&amp;D Program of China 2018YFA0704000. This work was supported by the THUIBCS and BLBCI. Feng Xu is the corresponding author.</span></span></p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
</span><a target="_blank" href="https://github.com/zllrunning/face-parsing.PyTorch" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:90%;">https://github.com/zllrunning/face-parsing.PyTorch</a><span id="bib.bib1.2.2" class="ltx_text" style="font-size:90%;">.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
</span><a target="_blank" href="https://github.com/timesler/facenet-pytorch" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:90%;">https://github.com/timesler/facenet-pytorch</a><span id="bib.bib2.2.2" class="ltx_text" style="font-size:90%;">.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Amjad Almahairi, Sai Rajeshwar, Alessandro Sordoni, Philip Bachman, and Aaron
Courville.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Augmented cyclegan: Learning many-to-many mappings from unpaired
data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, pages
195–204. PMLR, 2018.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Jianmin Bao, Dong Chen, Fang Wen, Houqiang Li, and Gang Hua.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Towards open-set identity preserving face synthesis.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, pages 6713–6722, 2018.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Lacey Best-Rowden, Hu Han, Charles Otto, Brendan F Klare, and Anil K Jain.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Unconstrained face recognition: Identifying a person of interest from
a media collection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Information Forensics and Security</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">,
9(12):2144–2157, 2014.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Jui-Shan Chan, Gee-Sern Jison Hsu, Hung-Cheng Shie, and Yan-Xiang Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Face recognition by facial attribute assisted network.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2017 IEEE International Conference on Image Processing
(ICIP)</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, pages 3825–3829, 2017.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Yuhua Chen, Wen Li, Xiaoran Chen, and Luc Van Gool.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Learning semantic segmentation from synthetic data: A geometrically
guided input-output adaptation approach.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, pages 1841–1850, 2019.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Yi-Hsin Chen, Wei-Yu Chen, Yu-Ting Chen, Bo-Cheng Tsai, Yu-Chiang Frank Wang,
and Min Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">No more discrimination: Cross city adaptation of road scene
segmenters.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE International Conference on Computer
Vision</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, pages 1992–2001, 2017.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Yunjey Choi, Minje Choi, Munyoung Kim, Jung-Woo Ha, Sunghun Kim, and Jaegul
Choo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Stargan: Unified generative adversarial networks for multi-domain
image-to-image translation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Yunjey Choi, Youngjung Uh, Jaejun Yoo, and Jung-Woo Ha.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Stargan v2: Diverse image synthesis for multiple domains.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
M. De Smet, R. Fransens, and L. Van Gool.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">A generalized em approach for 3d model based face recognition under
occlusions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2006 IEEE Computer Society Conference on Computer Vision and
Pattern Recognition (CVPR’06)</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, volume 2, pages 1423–1430, 2006.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Yu Deng, Jiaolong Yang, Dong Chen, Fang Wen, and Xin Tong.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Disentangled and controllable face image generation via 3d
imitative-contrastive learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, pages 5154–5163, 2020.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Kartik Dwivedi, Kumar Biswaranjan, and Amit Sethi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Drowsy driver detection using representation learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2014 IEEE international advance computing conference (IACC)</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">,
pages 995–999. IEEE, 2014.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Yue Gao, Fangyun Wei, Jianmin Bao, Shuyang Gu, Dong Chen, Fang Wen, and Zhouhui
Lian.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">High-fidelity and arbitrary face editing.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, pages 16115–16124, 2021.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Jingtao Guo, Zhenzhen Qian, Zuowei Zhou, and Yi Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Mulgan: Facial attribute editing by exemplar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1912.12396</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Jianzhu Guo, Xiangyu Zhu, Zhen Lei, and Stan Z Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Face synthesis for eyeglass-robust face recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1806.01196</span><span id="bib.bib16.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Mehdi Hajinoroozi, Zijing Mao, and Yufei Huang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Prediction of driver’s drowsy and alert states from eeg signals with
deep learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2015 IEEE 6th international workshop on computational
advances in multi-sensor adaptive processing (CAMSAP)</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, pages 493–496. IEEE,
2015.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, pages 770–778, 2016.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Z. He, W. Zuo, M. Kan, S. Shan, and X. Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Attgan: Facial attribute editing by only changing what you want.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Image Processing</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 28(11):5464–5478, Nov
2019.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Martin Heusel, Hubert Ramsauer, Thomas Unterthiner, Bernhard Nessler, and Sepp
Hochreiter.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Gans trained by a two time-scale update rule converge to a local nash
equilibrium.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib20.4.2" class="ltx_text" style="font-size:90%;">, 30, 2017.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Judy Hoffman, Dequan Wang, Fisher Yu, and Trevor Darrell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Fcns in the wild: Pixel-level adversarial and constraint-based
adaptation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1612.02649</span><span id="bib.bib21.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Bingwen Hu, Zhedong Zheng, Ping Liu, Wankou Yang, and Mingwu Ren.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Unsupervised eyeglasses removal in the wild.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Cybernetics</span><span id="bib.bib22.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Xun Huang and Serge Belongie.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Arbitrary style transfer in real-time with adaptive instance
normalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE International Conference on Computer
Vision</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, pages 1501–1510, 2017.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Xun Huang, Ming-Yu Liu, Serge Belongie, and Jan Kautz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Multimodal unsupervised image-to-image translation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Phillip Isola, Jun-Yan Zhu, Tinghui Zhou, and Alexei A Efros.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Image-to-image translation with conditional adversarial networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision and Pattern Recognition (CVPR), 2017 IEEE
Conference on</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Justin Johnson, Alexandre Alahi, and Li Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Perceptual losses for real-time style transfer and super-resolution.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European Conference on Computer Vision</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Tero Karras, Timo Aila, Samuli Laine, and Jaakko Lehtinen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Progressive growing of GANs for improved quality, stability, and
variation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Tero Karras, Samuli Laine, and Timo Aila.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">A style-based generator architecture for generative adversarial
networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, pages 4401–4410, 2019.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Diederik P Kingma and Jimmy Ba.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Adam: A method for stochastic optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1412.6980</span><span id="bib.bib29.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Alex Krizhevsky, Ilya Sutskever, and Geoffrey E Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Imagenet classification with deep convolutional neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib30.4.2" class="ltx_text" style="font-size:90%;">,
25:1097–1105, 2012.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Hsin-Ying Lee, Hung-Yu Tseng, Jia-Bin Huang, Maneesh Singh, and Ming-Hsuan
Yang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Diverse image-to-image translation via disentangled representations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European conference on computer vision
(ECCV)</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, pages 35–51, 2018.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Yu-Hui Lee and Shang-Hong Lai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Byeglassesgan: Identity preserving eyeglasses removal for face
images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European Conference on Computer Vision</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, pages 243–258.
Springer, 2020.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Xinyang Li, Shengchuan Zhang, Jie Hu, Liujuan Cao, Xiaopeng Hong, Xudong Mao,
Feiyue Huang, Yongjian Wu, and Rongrong Ji.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Image-to-image translation via hierarchical style disentanglement.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib33.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib33.5.3" class="ltx_text" style="font-size:90%;">, pages 8639–8648, June 2021.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Ming Liu, Yukang Ding, Min Xia, Xiao Liu, Errui Ding, Wangmeng Zuo, and Shilei
Wen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Stgan: A unified selective transfer network for arbitrary image
attribute editing.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib34.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span><span id="bib.bib34.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Ziwei Liu, Ping Luo, Xiaogang Wang, and Xiaoou Tang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Deep learning face attributes in the wild.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib35.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of International Conference on Computer Vision
(ICCV)</span><span id="bib.bib35.5.3" class="ltx_text" style="font-size:90%;">, December 2015.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Xudong Mao, Qing Li, Haoran Xie, Raymond YK Lau, Zhen Wang, and Stephen
Paul Smolley.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Least squares generative adversarial networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib36.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE international conference on computer
vision</span><span id="bib.bib36.5.3" class="ltx_text" style="font-size:90%;">, pages 2794–2802, 2017.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Stephen McAuley, Stephen Hill, Naty Hoffman, Yoshiharu Gotanda, Brian Smits,
Brent Burley, and Adam Martinez.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Practical physically-based shading in film and game production.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib37.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM SIGGRAPH 2012 Courses</span><span id="bib.bib37.5.3" class="ltx_text" style="font-size:90%;">, pages 1–7. 2012.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Jeong-Seon Park, You Hwa Oh, Sang Chul Ahn, and Seong-Whan Lee.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Glasses removal from facial image using recursive error compensation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Pattern Analysis and Machine Intelligence</span><span id="bib.bib38.4.2" class="ltx_text" style="font-size:90%;">,
27(5):805–811, 2005.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Long Quan and Zhongdan Lan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Linear n-point camera pose determination.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on pattern analysis and machine intelligence</span><span id="bib.bib39.4.2" class="ltx_text" style="font-size:90%;">,
21(8):774–780, 1999.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Akshay Rangesh, Bowen Zhang, and Mohan M. Trivedi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Driver gaze estimation in the real world: Overcoming the eyeglass
challenge.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib40.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2020 IEEE Intelligent Vehicles Symposium (IV)</span><span id="bib.bib40.5.3" class="ltx_text" style="font-size:90%;">, pages
1054–1059, 2020.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Andrés Romero, Pablo Arbeláez, Luc Van Gool, and Radu Timofte.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Smit: Stochastic multi-label image-to-image translation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib41.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on
Computer Vision Workshops</span><span id="bib.bib41.5.3" class="ltx_text" style="font-size:90%;">, pages 0–0, 2019.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Florian Schroff, Dmitry Kalenichenko, and James Philbin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">Facenet: A unified embedding for face recognition and clustering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib42.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib42.5.3" class="ltx_text" style="font-size:90%;">, pages 815–823, 2015.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Wei Shen and Rujie Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Learning residual images for face attribute manipulation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib43.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib43.5.3" class="ltx_text" style="font-size:90%;">, pages 4030–4038, 2017.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Karen Simonyan and Andrew Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Very deep convolutional networks for large-scale image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1409.1556</span><span id="bib.bib44.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
K. Simonyan and A. Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Very deep convolutional networks for large-scale image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib45.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib45.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Yaniv Taigman, Ming Yang, Marc’Aurelio Ranzato, and Lior Wolf.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">Deepface: Closing the gap to human-level performance in face
verification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib46.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib46.5.3" class="ltx_text" style="font-size:90%;">, pages 1701–1708, 2014.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text" style="font-size:90%;">
Yichuan Tang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.2.1" class="ltx_text" style="font-size:90%;">Deep learning using linear support vector machines.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1306.0239</span><span id="bib.bib47.4.2" class="ltx_text" style="font-size:90%;">, 2013.
</span>
</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text" style="font-size:90%;">
Ayush Tewari, Mohamed Elgharib, Gaurav Bharaj, Florian Bernard, Hans-Peter
Seidel, Patrick Pérez, Michael Zollhofer, and Christian Theobalt.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.2.1" class="ltx_text" style="font-size:90%;">Stylerig: Rigging stylegan for 3d control over portrait images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib48.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib48.5.3" class="ltx_text" style="font-size:90%;">, pages 6142–6151, 2020.
</span>
</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text" style="font-size:90%;">
Yi-Hsuan Tsai, Wei-Chih Hung, Samuel Schulter, Kihyuk Sohn, Ming-Hsuan Yang,
and Manmohan Chandraker.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.2.1" class="ltx_text" style="font-size:90%;">Learning to adapt structured output space for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib49.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib49.5.3" class="ltx_text" style="font-size:90%;">, pages 7472–7481, 2018.
</span>
</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text" style="font-size:90%;">
Paul Upchurch, Jacob Gardner, Geoff Pleiss, Robert Pless, Noah Snavely, Kavita
Bala, and Kilian Weinberger.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.2.1" class="ltx_text" style="font-size:90%;">Deep feature interpolation for image content changes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib50.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib50.5.3" class="ltx_text" style="font-size:90%;">, pages 7064–7073, 2017.
</span>
</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text" style="font-size:90%;">
Yaxing Wang, Abel Gonzalez-Garcia, Joost van de Weijer, and Luis Herranz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.2.1" class="ltx_text" style="font-size:90%;">Sdit: Scalable and diverse cross-domain image translation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib51.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 27th ACM International Conference on
Multimedia</span><span id="bib.bib51.5.3" class="ltx_text" style="font-size:90%;">, pages 1267–1276, 2019.
</span>
</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock"><span id="bib.bib52.1.1" class="ltx_text" style="font-size:90%;">
Zhibo Wang, Xin Yu, Ming Lu, Quan Wang, Chen Qian, and Feng Xu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.2.1" class="ltx_text" style="font-size:90%;">Single image portrait relighting via explicit multiple reflectance
channel modeling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM Trans. Graph.</span><span id="bib.bib52.4.2" class="ltx_text" style="font-size:90%;">, 39(6), Nov. 2020.
</span>
</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock"><span id="bib.bib53.1.1" class="ltx_text" style="font-size:90%;">
Wai Keung Wong and Haitao Zhao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.2.1" class="ltx_text" style="font-size:90%;">Eyeglasses removal of thermal image based on visible information.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Information Fusion</span><span id="bib.bib53.4.2" class="ltx_text" style="font-size:90%;">, 14(2):163–176, 2013.
</span>
</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock"><span id="bib.bib54.1.1" class="ltx_text" style="font-size:90%;">
Chenyu Wu, Ce Liu, Heung-Yueng Shum, Ying-Qing Xy, and Zhengyou Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.2.1" class="ltx_text" style="font-size:90%;">Automatic eyeglasses removal from face images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Pattern Analysis and Machine Intelligence</span><span id="bib.bib54.4.2" class="ltx_text" style="font-size:90%;">,
26(3):322–336, 2004.
</span>
</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock"><span id="bib.bib55.1.1" class="ltx_text" style="font-size:90%;">
Po-Wei Wu, Yu-Jing Lin, Che-Han Chang, Edward Y. Chang, and Shih-Wei Liao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.2.1" class="ltx_text" style="font-size:90%;">Relgan: Multi-domain image-to-image translation via relative
attributes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">2019 IEEE/CVF International Conference on Computer Vision
(ICCV)</span><span id="bib.bib55.4.2" class="ltx_text" style="font-size:90%;">, pages 5913–5921, 2019.
</span>
</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock"><span id="bib.bib56.1.1" class="ltx_text" style="font-size:90%;">
Taihong Xiao, Jiapeng Hong, and Jinwen Ma.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.2.1" class="ltx_text" style="font-size:90%;">Dna-gan: Learning disentangled representations from multi-attribute
images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1711.05415</span><span id="bib.bib56.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock"><span id="bib.bib57.1.1" class="ltx_text" style="font-size:90%;">
Taihong Xiao, Jiapeng Hong, and Jinwen Ma.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.2.1" class="ltx_text" style="font-size:90%;">Elegant: Exchanging latent encodings with gan for transferring
multiple face attributes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib57.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision
(ECCV)</span><span id="bib.bib57.5.3" class="ltx_text" style="font-size:90%;">, pages 172–187, September 2018.
</span>
</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock"><span id="bib.bib58.1.1" class="ltx_text" style="font-size:90%;">
Yanchao Yang and Stefano Soatto.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib58.2.1" class="ltx_text" style="font-size:90%;">Fda: Fourier domain adaptation for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib58.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib58.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib58.5.3" class="ltx_text" style="font-size:90%;">, pages 4085–4095, 2020.
</span>
</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock"><span id="bib.bib59.1.1" class="ltx_text" style="font-size:90%;">
Dong Yi and Stan Z Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib59.2.1" class="ltx_text" style="font-size:90%;">Learning sparse feature for eyeglasses problem in face recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib59.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib59.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2011 IEEE International Conference on Automatic Face &amp;
Gesture Recognition (FG)</span><span id="bib.bib59.5.3" class="ltx_text" style="font-size:90%;">, pages 430–435. IEEE, 2011.
</span>
</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock"><span id="bib.bib60.1.1" class="ltx_text" style="font-size:90%;">
Xiaoming Yu, Yuanqi Chen, Shan Liu, Thomas Li, and Ge Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib60.2.1" class="ltx_text" style="font-size:90%;">Multi-mapping image-to-image translation via learning
disentanglement.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib60.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib60.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib60.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock"><span id="bib.bib61.1.1" class="ltx_text" style="font-size:90%;">
Yang Zhang, Philip David, and Boqing Gong.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib61.2.1" class="ltx_text" style="font-size:90%;">Curriculum domain adaptation for semantic segmentation of urban
scenes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib61.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib61.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE international conference on computer
vision</span><span id="bib.bib61.5.3" class="ltx_text" style="font-size:90%;">, pages 2020–2030, 2017.
</span>
</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock"><span id="bib.bib62.1.1" class="ltx_text" style="font-size:90%;">
Shuchang Zhou, Taihong Xiao, Yi Yang, Dieqiao Feng, Qinyao He, and Weiran He.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib62.2.1" class="ltx_text" style="font-size:90%;">Genegan: Learning object transfiguration and attribute subspace from
unpaired data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib62.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1705.04932</span><span id="bib.bib62.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock"><span id="bib.bib63.1.1" class="ltx_text" style="font-size:90%;">
Jun-Yan Zhu, Taesung Park, Phillip Isola, and Alexei A Efros.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib63.2.1" class="ltx_text" style="font-size:90%;">Unpaired image-to-image translation using cycle-consistent
adversarial networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib63.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib63.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision (ICCV), 2017 IEEE International Conference
on</span><span id="bib.bib63.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock"><span id="bib.bib64.1.1" class="ltx_text" style="font-size:90%;">
Jun-Yan Zhu, Richard Zhang, Deepak Pathak, Trevor Darrell, Alexei A Efros,
Oliver Wang, and Eli Shechtman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib64.2.1" class="ltx_text" style="font-size:90%;">Multimodal image-to-image translation by enforcing bi-cycle
consistency.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib64.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib64.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib64.5.3" class="ltx_text" style="font-size:90%;">, pages
465–476, 2017.
</span>
</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock"><span id="bib.bib65.1.1" class="ltx_text" style="font-size:90%;">
Xinge Zhu, Hui Zhou, Ceyuan Yang, Jianping Shi, and Dahua Lin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib65.2.1" class="ltx_text" style="font-size:90%;">Penalizing top performers: Conservative loss for semantic
segmentation adaptation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib65.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib65.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision
(ECCV)</span><span id="bib.bib65.5.3" class="ltx_text" style="font-size:90%;">, pages 568–583, 2018.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Ablation Study for Mask Operation</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">To further evaluate the effect of mask operation in the item removal stage, we additionally train an ablation that directly feeds the shadow-removed results <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="\hat{I}_{syn}^{g}" display="inline"><semantics id="A1.p1.1.m1.1a"><msubsup id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><mover accent="true" id="A1.p1.1.m1.1.1.2.2" xref="A1.p1.1.m1.1.1.2.2.cmml"><mi id="A1.p1.1.m1.1.1.2.2.2" xref="A1.p1.1.m1.1.1.2.2.2.cmml">I</mi><mo id="A1.p1.1.m1.1.1.2.2.1" xref="A1.p1.1.m1.1.1.2.2.1.cmml">^</mo></mover><mrow id="A1.p1.1.m1.1.1.2.3" xref="A1.p1.1.m1.1.1.2.3.cmml"><mi id="A1.p1.1.m1.1.1.2.3.2" xref="A1.p1.1.m1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.p1.1.m1.1.1.2.3.1" xref="A1.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="A1.p1.1.m1.1.1.2.3.3" xref="A1.p1.1.m1.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="A1.p1.1.m1.1.1.2.3.1a" xref="A1.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="A1.p1.1.m1.1.1.2.3.4" xref="A1.p1.1.m1.1.1.2.3.4.cmml">n</mi></mrow><mi id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.1.cmml" xref="A1.p1.1.m1.1.1">superscript</csymbol><apply id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.2.1.cmml" xref="A1.p1.1.m1.1.1">subscript</csymbol><apply id="A1.p1.1.m1.1.1.2.2.cmml" xref="A1.p1.1.m1.1.1.2.2"><ci id="A1.p1.1.m1.1.1.2.2.1.cmml" xref="A1.p1.1.m1.1.1.2.2.1">^</ci><ci id="A1.p1.1.m1.1.1.2.2.2.cmml" xref="A1.p1.1.m1.1.1.2.2.2">𝐼</ci></apply><apply id="A1.p1.1.m1.1.1.2.3.cmml" xref="A1.p1.1.m1.1.1.2.3"><times id="A1.p1.1.m1.1.1.2.3.1.cmml" xref="A1.p1.1.m1.1.1.2.3.1"></times><ci id="A1.p1.1.m1.1.1.2.3.2.cmml" xref="A1.p1.1.m1.1.1.2.3.2">𝑠</ci><ci id="A1.p1.1.m1.1.1.2.3.3.cmml" xref="A1.p1.1.m1.1.1.2.3.3">𝑦</ci><ci id="A1.p1.1.m1.1.1.2.3.4.cmml" xref="A1.p1.1.m1.1.1.2.3.4">𝑛</ci></apply></apply><ci id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">\hat{I}_{syn}^{g}</annotation></semantics></math> (<span id="A1.p1.1.1" class="ltx_text ltx_font_italic">w/o MO</span>) to the De-Glass Network.
Qualitative results in <a href="#A2.F9" title="In Appendix B More Results ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">9</span></a> show that without mask operation, the network has worse results on real-world portraits with unusual eyeglasses textures.
Quantitative results in <a href="#A1.T3" title="In Appendix A Ablation Study for Mask Operation ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a> also show degradation of the realism metric FID and the identity preservation metrics without the mask operation.</p>
</div>
<figure id="A1.T3" class="ltx_table">
<table id="A1.T3.5" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A1.T3.3.3" class="ltx_tr">
<td id="A1.T3.3.3.4" class="ltx_td ltx_border_r ltx_border_tt" rowspan="2"></td>
<td id="A1.T3.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="A1.T3.1.1.1.1" class="ltx_text">FID<math id="A1.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A1.T3.1.1.1.1.m1.1a"><mo stretchy="false" id="A1.T3.1.1.1.1.m1.1.1" xref="A1.T3.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T3.1.1.1.1.m1.1b"><ci id="A1.T3.1.1.1.1.m1.1.1.cmml" xref="A1.T3.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="A1.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">TAR@FAR<math id="A1.T3.2.2.2.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A1.T3.2.2.2.m1.1a"><mo stretchy="false" id="A1.T3.2.2.2.m1.1.1" xref="A1.T3.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T3.2.2.2.m1.1b"><ci id="A1.T3.2.2.2.m1.1.1.cmml" xref="A1.T3.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.2.2.m1.1c">\uparrow</annotation></semantics></math>
</td>
<td id="A1.T3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="A1.T3.3.3.3.1" class="ltx_text">Rank-1<math id="A1.T3.3.3.3.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A1.T3.3.3.3.1.m1.1a"><mo stretchy="false" id="A1.T3.3.3.3.1.m1.1.1" xref="A1.T3.3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T3.3.3.3.1.m1.1b"><ci id="A1.T3.3.3.3.1.m1.1.1.cmml" xref="A1.T3.3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.3.3.3.1.m1.1c">\uparrow</annotation></semantics></math></span></td>
</tr>
<tr id="A1.T3.5.5" class="ltx_tr">
<td id="A1.T3.4.4.1" class="ltx_td ltx_align_center"><math id="A1.T3.4.4.1.m1.1" class="ltx_Math" alttext="1e^{-2}" display="inline"><semantics id="A1.T3.4.4.1.m1.1a"><mrow id="A1.T3.4.4.1.m1.1.1" xref="A1.T3.4.4.1.m1.1.1.cmml"><mn id="A1.T3.4.4.1.m1.1.1.2" xref="A1.T3.4.4.1.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.T3.4.4.1.m1.1.1.1" xref="A1.T3.4.4.1.m1.1.1.1.cmml">​</mo><msup id="A1.T3.4.4.1.m1.1.1.3" xref="A1.T3.4.4.1.m1.1.1.3.cmml"><mi id="A1.T3.4.4.1.m1.1.1.3.2" xref="A1.T3.4.4.1.m1.1.1.3.2.cmml">e</mi><mrow id="A1.T3.4.4.1.m1.1.1.3.3" xref="A1.T3.4.4.1.m1.1.1.3.3.cmml"><mo id="A1.T3.4.4.1.m1.1.1.3.3a" xref="A1.T3.4.4.1.m1.1.1.3.3.cmml">−</mo><mn id="A1.T3.4.4.1.m1.1.1.3.3.2" xref="A1.T3.4.4.1.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.4.4.1.m1.1b"><apply id="A1.T3.4.4.1.m1.1.1.cmml" xref="A1.T3.4.4.1.m1.1.1"><times id="A1.T3.4.4.1.m1.1.1.1.cmml" xref="A1.T3.4.4.1.m1.1.1.1"></times><cn type="integer" id="A1.T3.4.4.1.m1.1.1.2.cmml" xref="A1.T3.4.4.1.m1.1.1.2">1</cn><apply id="A1.T3.4.4.1.m1.1.1.3.cmml" xref="A1.T3.4.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.T3.4.4.1.m1.1.1.3.1.cmml" xref="A1.T3.4.4.1.m1.1.1.3">superscript</csymbol><ci id="A1.T3.4.4.1.m1.1.1.3.2.cmml" xref="A1.T3.4.4.1.m1.1.1.3.2">𝑒</ci><apply id="A1.T3.4.4.1.m1.1.1.3.3.cmml" xref="A1.T3.4.4.1.m1.1.1.3.3"><minus id="A1.T3.4.4.1.m1.1.1.3.3.1.cmml" xref="A1.T3.4.4.1.m1.1.1.3.3"></minus><cn type="integer" id="A1.T3.4.4.1.m1.1.1.3.3.2.cmml" xref="A1.T3.4.4.1.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.4.4.1.m1.1c">1e^{-2}</annotation></semantics></math></td>
<td id="A1.T3.5.5.2" class="ltx_td ltx_align_center"><math id="A1.T3.5.5.2.m1.1" class="ltx_Math" alttext="1e^{-3}" display="inline"><semantics id="A1.T3.5.5.2.m1.1a"><mrow id="A1.T3.5.5.2.m1.1.1" xref="A1.T3.5.5.2.m1.1.1.cmml"><mn id="A1.T3.5.5.2.m1.1.1.2" xref="A1.T3.5.5.2.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.T3.5.5.2.m1.1.1.1" xref="A1.T3.5.5.2.m1.1.1.1.cmml">​</mo><msup id="A1.T3.5.5.2.m1.1.1.3" xref="A1.T3.5.5.2.m1.1.1.3.cmml"><mi id="A1.T3.5.5.2.m1.1.1.3.2" xref="A1.T3.5.5.2.m1.1.1.3.2.cmml">e</mi><mrow id="A1.T3.5.5.2.m1.1.1.3.3" xref="A1.T3.5.5.2.m1.1.1.3.3.cmml"><mo id="A1.T3.5.5.2.m1.1.1.3.3a" xref="A1.T3.5.5.2.m1.1.1.3.3.cmml">−</mo><mn id="A1.T3.5.5.2.m1.1.1.3.3.2" xref="A1.T3.5.5.2.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.5.5.2.m1.1b"><apply id="A1.T3.5.5.2.m1.1.1.cmml" xref="A1.T3.5.5.2.m1.1.1"><times id="A1.T3.5.5.2.m1.1.1.1.cmml" xref="A1.T3.5.5.2.m1.1.1.1"></times><cn type="integer" id="A1.T3.5.5.2.m1.1.1.2.cmml" xref="A1.T3.5.5.2.m1.1.1.2">1</cn><apply id="A1.T3.5.5.2.m1.1.1.3.cmml" xref="A1.T3.5.5.2.m1.1.1.3"><csymbol cd="ambiguous" id="A1.T3.5.5.2.m1.1.1.3.1.cmml" xref="A1.T3.5.5.2.m1.1.1.3">superscript</csymbol><ci id="A1.T3.5.5.2.m1.1.1.3.2.cmml" xref="A1.T3.5.5.2.m1.1.1.3.2">𝑒</ci><apply id="A1.T3.5.5.2.m1.1.1.3.3.cmml" xref="A1.T3.5.5.2.m1.1.1.3.3"><minus id="A1.T3.5.5.2.m1.1.1.3.3.1.cmml" xref="A1.T3.5.5.2.m1.1.1.3.3"></minus><cn type="integer" id="A1.T3.5.5.2.m1.1.1.3.3.2.cmml" xref="A1.T3.5.5.2.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.5.5.2.m1.1c">1e^{-3}</annotation></semantics></math></td>
</tr>
<tr id="A1.T3.5.6" class="ltx_tr">
<td id="A1.T3.5.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">w/o MO</td>
<td id="A1.T3.5.6.2" class="ltx_td ltx_align_center ltx_border_t">27.57</td>
<td id="A1.T3.5.6.3" class="ltx_td ltx_align_center ltx_border_t">0.6540</td>
<td id="A1.T3.5.6.4" class="ltx_td ltx_align_center ltx_border_t">0.4095</td>
<td id="A1.T3.5.6.5" class="ltx_td ltx_align_center ltx_border_t">0.4311</td>
</tr>
<tr id="A1.T3.5.7" class="ltx_tr">
<td id="A1.T3.5.7.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">w/ MO (ours)</td>
<td id="A1.T3.5.7.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T3.5.7.2.1" class="ltx_text ltx_font_bold">26.89</span></td>
<td id="A1.T3.5.7.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T3.5.7.3.1" class="ltx_text ltx_font_bold">0.6702</span></td>
<td id="A1.T3.5.7.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T3.5.7.4.1" class="ltx_text ltx_font_bold">0.4315</span></td>
<td id="A1.T3.5.7.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T3.5.7.5.1" class="ltx_text ltx_font_bold">0.4621</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A1.T3.7.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="A1.T3.8.2" class="ltx_text" style="font-size:90%;">Quantitative comparison.</span></figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>More Results</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">To demonstrate the robustness of our proposed method, we show more qualitative results for illuminations (<a href="#A5.F11" title="In Appendix E Potential Negative Impact ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">11</span></a>), head poses (<a href="#A5.F12" title="In Appendix E Potential Negative Impact ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">12</span></a>) and eyeglasses variation (<a href="#A5.F13" title="In Appendix E Potential Negative Impact ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">13</span></a>).</p>
</div>
<figure id="A2.F9" class="ltx_figure"><img src="/html/2203.10474/assets/ablation_mo-v4.jpg" id="A2.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="449" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F9.2.1.1" class="ltx_text" style="font-size:90%;">Figure 9</span>: </span><span id="A2.F9.3.2" class="ltx_text" style="font-size:90%;">Evaluations on the mask operation.</span></figcaption>
</figure>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Qualitative Comparison on CelebA</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">Some methods in the previous comparisons, <em id="A3.p1.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="A3.p1.1.2" class="ltx_text"></span>, ELEGANT<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>, show limited performance in the task of eyeglasses removal. To validate the correct usage of their released code, we also show qualitative results on the testing set of CelebA<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> using the same trained models.
Results in <a href="#A5.F14" title="In Appendix E Potential Negative Impact ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">14</span></a> show that most of the methods, <em id="A3.p1.1.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="A3.p1.1.4" class="ltx_text"></span>, ELEGANT, have better performance compared to their results on FFHQ<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> or MeGlass<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Eyeglasses Removal via StarGANv2</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.1" class="ltx_p">StarGANv2<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> learns mixed style to transfer images of one domain to diverse images of a target domain. Although it inherits the assumption of StarGAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, the behaviour of the two networks is quite different.
In practice, we adopt StarGANv2 to the task of eyeglasses removal
via two ways: reference-guided and latent-guided.
The results in <a href="#A5.F10" title="In Appendix E Potential Negative Impact ‣ Portrait Eyeglasses and Shadow Removal by Leveraging 3D Synthetic Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">10</span></a> show that StarGANv2 prefers to change other facial attributes, <em id="A4.p1.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="A4.p1.1.2" class="ltx_text"></span>, skin color and hairstyle, when removing the eyeglasses. Similar phenomena are also mentioned in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. Based on these experiments, it seems inappropriate to compare StarGANv2 on the task of eyeglasses removal. Therefore, we make comparisons with StarGAN as replace in our paper.</p>
</div>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Potential Negative Impact</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">Although our method hardly changes identity, it still requires people’s consent to edit their portraits for public usage. The potential negative impact might include abuse of our method without any consent. Besides, applying the technique at sufficiently large scale may cause unintended societal effects. For example, it could worsen the already widespread stigmatization of corrective eyewear. This technique should be applied in a correct way, and removing eyeglasses or not should be considered as a personal choice.</p>
</div>
<figure id="A5.F10" class="ltx_figure"><img src="/html/2203.10474/assets/stargan2-v2.jpg" id="A5.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="397" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F10.2.1.1" class="ltx_text" style="font-size:90%;">Figure 10</span>: </span><span id="A5.F10.3.2" class="ltx_text" style="font-size:90%;">Comparison with StarGANv2 on the task of eyeglasses removal.</span></figcaption>
</figure>
<figure id="A5.F11" class="ltx_figure"><img src="/html/2203.10474/assets/shadows-v3.jpg" id="A5.F11.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="617" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F11.2.1.1" class="ltx_text" style="font-size:90%;">Figure 11</span>: </span><span id="A5.F11.3.2" class="ltx_text" style="font-size:90%;">More results of different illuminations.</span></figcaption>
</figure>
<figure id="A5.F12" class="ltx_figure"><img src="/html/2203.10474/assets/headpose-v2.jpg" id="A5.F12.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="617" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F12.2.1.1" class="ltx_text" style="font-size:90%;">Figure 12</span>: </span><span id="A5.F12.3.2" class="ltx_text" style="font-size:90%;">More results of different head poses.</span></figcaption>
</figure>
<figure id="A5.F13" class="ltx_figure"><img src="/html/2203.10474/assets/shapetexture-v2.jpg" id="A5.F13.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="617" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F13.2.1.1" class="ltx_text" style="font-size:90%;">Figure 13</span>: </span><span id="A5.F13.3.2" class="ltx_text" style="font-size:90%;">More results of eyeglasses with different shapes and textures.</span></figcaption>
</figure>
<figure id="A5.F14" class="ltx_figure"><img src="/html/2203.10474/assets/celeba-v2.jpg" id="A5.F14.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="617" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F14.2.1.1" class="ltx_text" style="font-size:90%;">Figure 14</span>: </span><span id="A5.F14.3.2" class="ltx_text" style="font-size:90%;">Qualitative comparisons on CelebA.</span></figcaption>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2203.10473" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2203.10474" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2203.10474">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2203.10474" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2203.10476" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 03:35:58 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
