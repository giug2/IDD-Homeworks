<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2206.08671] FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification</title><meta property="og:description" content="Modern deep learning systems are increasingly deployed in situations such as personalization and federated learning where it is necessary to support i) learning on small amounts of data, and ii) communication efficient…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2206.08671">

<!--Generated on Mon Mar 11 17:30:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p">*[inlinelist,1]label=(),</p>
</div>
<h1 class="ltx_title ltx_title_document">
<span id="id2.id1" class="ltx_text ltx_font_smallcaps">FiT</span>: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated 
<br class="ltx_break">Image Classification</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Aliaksandra Shysheya 
<br class="ltx_break">University of Cambridge
<br class="ltx_break"><span id="id3.1.id1" class="ltx_text ltx_font_typewriter">as2975@cam.ac.uk</span> 
<br class="ltx_break">&amp;John Bronskill<span id="footnotex1" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span> 
<br class="ltx_break">University of Cambridge
<br class="ltx_break"><span id="id4.2.id2" class="ltx_text ltx_font_typewriter">jfb54@cam.ac.uk</span> 
<br class="ltx_break">&amp;Massimiliano Patacchiola
<br class="ltx_break">University of Cambridge
<br class="ltx_break"><span id="id5.3.id3" class="ltx_text ltx_font_typewriter">mp2008@cam.ac.uk</span> 
<br class="ltx_break">&amp;Sebastian Nowozin 
<br class="ltx_break"><span id="id6.4.id4" class="ltx_text ltx_font_typewriter">nowozin@gmail.com</span> 
<br class="ltx_break">&amp;Richard E. Turner 
<br class="ltx_break">University of Cambridge 
<br class="ltx_break"><span id="id7.5.id5" class="ltx_text ltx_font_typewriter">ret26@cam.ac.uk</span>
</span><span class="ltx_author_notes">Authors contributed equally.Work performed while at Microsoft Research.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.1" class="ltx_p">Modern deep learning systems are increasingly deployed in situations such as personalization and federated learning where it is necessary to support i) learning on small amounts of data, and ii) communication efficient distributed training protocols.
In this work, we develop FiLM Transfer (<span id="id1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>) which fulfills these requirements in the image classification setting by combining ideas from transfer learning (fixed pretrained backbones and fine-tuned FiLM adapter layers) and meta-learning (automatically configured Naive Bayes classifiers and episodic training) to yield parameter efficient models with superior classification accuracy at low-shot.
The resulting parameter efficiency is key for enabling few-shot learning, inexpensive model updates for personalization, and communication efficient federated learning.
We experiment with <span id="id1.1.2" class="ltx_text ltx_font_smallcaps">FiT</span> on a wide range of downstream datasets and show that it achieves better classification accuracy than the leading Big Transfer (BiT) algorithm at low-shot and achieves state-of-the art accuracy on the challenging VTAB-1k benchmark, with fewer than 1<math id="id1.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="id1.1.m1.1a"><mo id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><csymbol cd="latexml" id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\%</annotation></semantics></math> of the updateable parameters.
Finally, we demonstrate the parameter efficiency and superior accuracy of <span id="id1.1.3" class="ltx_text ltx_font_smallcaps">FiT</span> in distributed low-shot applications including model personalization and federated learning where model update size is an important performance metric.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">With the success of the commercial application of deep learning in many fields such as computer vision <cite class="ltx_cite ltx_citemacro_citep">(Schroff et al., <a href="#bib.bib52" title="" class="ltx_ref">2015</a>)</cite>, natural language processing <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite>, speech recognition <cite class="ltx_cite ltx_citemacro_citep">(Xiong et al., <a href="#bib.bib62" title="" class="ltx_ref">2018</a>)</cite>, and language translation <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a href="#bib.bib60" title="" class="ltx_ref">2016</a>)</cite>, an increasing number of models are being trained on central servers and then deployed on remote devices, often to personalize a model to a specific user’s needs.
Personalization requires models that can be updated inexpensively by minimizing the number of parameters that need to be stored and / or transmitted and frequently calls for few-shot learning methods as the amount of training data from an individual user may be small <cite class="ltx_cite ltx_citemacro_citep">(Massiceti et al., <a href="#bib.bib35" title="" class="ltx_ref">2021</a>)</cite>.
At the same time, for privacy, security, and performance reasons, it can be advantageous to use federated learning where a model is trained on an array of remote devices, each with different data, and share gradient or parameter updates instead of training data with a central server <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib37" title="" class="ltx_ref">2017</a>)</cite>.
In the federated learning setting, in order to minimize communication cost with the server, it is also beneficial to have models with a small number of parameters that need to be updated for each training round conducted by remote clients.
The amount of training data available to the clients is often small, again necessitating few-shot learning approaches.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">In order to develop data-efficient and parameter-efficient learning systems, we draw on ideas developed by the few-shot learning community. Few-shot learning approaches can be characterized in terms of shared and updateable parameters.
From a statistical perspective, shared parameters capture similarities between datasets, while updateable parameters capture the differences. Updateable parameters are those that are either recomputed or learned as the model is updated or retrained, whereas shared parameters are fixed. In personalized or federated settings, it is key to minimize the number of updateable parameters, while still retaining the capacity to adapt.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">Broadly, there are two different approaches to few-shot learning: meta-learning <cite class="ltx_cite ltx_citemacro_citep">(Hospedales et al., <a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite> and transfer learning (fine-tuning) <cite class="ltx_cite ltx_citemacro_citep">(Yosinski et al., <a href="#bib.bib63" title="" class="ltx_ref">2014</a>)</cite>. Meta-learning approaches provide methods that have a small number of updatable parameters <cite class="ltx_cite ltx_citemacro_citep">(Requeima et al., <a href="#bib.bib50" title="" class="ltx_ref">2019</a>)</cite>. However, while meta-learners can perform strongly on datasets that are similar to those they are meta-trained on, their accuracy suffers when tested on datasets that are significantly different <cite class="ltx_cite ltx_citemacro_citep">(Dumoulin et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>. Transfer learning algorithms often outperform meta-learners, especially on diverse datasets and even at low-shot <cite class="ltx_cite ltx_citemacro_citep">(Dumoulin et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>; Tian et al., <a href="#bib.bib56" title="" class="ltx_ref">2020</a>)</cite>. However, the leading Big Transfer (BiT) <cite class="ltx_cite ltx_citemacro_citep">(Dumoulin et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>; Kolesnikov et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite> algorithm requires every parameter in a large network to be updated. In summary, performant transfer learners are parameter-inefficient, and parameter-efficient few-shot learners perform relatively poorly.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">In this work we propose FiLM Transfer or FiT, a novel method that synthesizes ideas from both the transfer learning and meta-learning communities in order to achieve the best of both worlds – parameter efficiency without sacrificing accuracy, even when there are only a small number of training examples available.
From transfer learning, we take advantage of backbones pretrained on large image datasets and the use of fine-tuned parameter efficient adapters.
From meta-learning, we take advantage of metric learning based final layer classifiers trained with episodic protocols that we show are more effective than the conventional linear layer classifier.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We experiment with <span id="S1.p5.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> on a wide range of downstream datasets and show that it achieves better classification accuracy at low-shot with two orders of magnitude fewer updateable parameters when compared to BiT <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite> and competitive accuracy when more data are available.
We also demonstrate the benefits of <span id="S1.p5.1.2" class="ltx_text ltx_font_smallcaps">FiT</span> on a low-shot real-world model personalization application and in a demanding few-shot federated learning scenario. A summary of our results is shown in <a href="#S1.F1" title="In 1 Introduction ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, where we see that <span id="S1.p5.1.3" class="ltx_text ltx_font_smallcaps">FiT</span> has superior parameter efficiency and classification accuracy compared to BiT in multiple settings.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2206.08671/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="98" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S1.F1.6.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FiT<span id="S1.F1.6.1.1" class="ltx_text ltx_font_upright"> is significantly more parameter efficient than BiT.</span></span> Results summary for <span id="S1.F1.7.2" class="ltx_text ltx_font_smallcaps">FiT</span> and BiT in classification, personalization, and federated learning scenarios using the BiT-M-R50x1 backbone. The <span id="S1.F1.8.3" class="ltx_text ltx_font_italic">Parameters</span> plots refer to the typical number of updateable parameters in each model, while the <span id="S1.F1.9.4" class="ltx_text ltx_font_italic">Cost</span> plot refers to the total client-server communication cost during federated training. In all settings, <span id="S1.F1.10.5" class="ltx_text ltx_font_smallcaps">FiT</span> achieves similar or better classification accuracy using orders of magnitude fewer updateable parameters and communication cost. Refer to <a href="#S4.T2" title="In 4.2 VTAB-1k Results ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">2</span></a>, <a href="#S4.T4" title="In 4.3 Personalization ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">4</span></a>, and <a href="#S4.T5" title="In 4.4 Few-shot Federated Learning ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">5</span></a> for more detail.</figcaption>
</figure>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">Our contributions:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">A parameter and data efficient network architecture for low-shot transfer learning that 
<span id="S1.I1.i1.I1" class="ltx_inline-enumerate">
<span id="S1.I1.i1.I1.i1" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item">1</span> <span id="S1.I1.i1.I1.i1.1" class="ltx_text">utilizes frozen backbones pretrained on large image datasets;
</span></span>
<span id="S1.I1.i1.I1.i2" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item">2</span> <span id="S1.I1.i1.I1.i2.1" class="ltx_text">augments the backbone with parameter efficient FiLM <cite class="ltx_cite ltx_citemacro_citep">(Perez et al., <a href="#bib.bib45" title="" class="ltx_ref">2018</a>)</cite> layers in order to adapt to a new task; and
</span></span>
<span id="S1.I1.i1.I1.i3" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item">3</span> <span id="S1.I1.i1.I1.i3.1" class="ltx_text">makes novel use of an automatically configured Naive Bayes final layer classifier instead of the usual linear layer, saving a large number of updateable parameters, yet improving classification performance;
</span></span>
</span></p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">A meta-learning inspired episodic training protocol for low-shot fine-tuning requiring no data augmentation, no regularization, and a minimal set of hyper-parameters;</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Superior classification accuracy at low-shot on standard downstream datasets and state-of-the-art results on the challenging VTAB-1k benchmark (74.9% for backbones pretrained on ImageNet-21k) while using <math id="S1.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\approx 1\%" display="inline"><semantics id="S1.I1.i3.p1.1.m1.1a"><mrow id="S1.I1.i3.p1.1.m1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.cmml"><mi id="S1.I1.i3.p1.1.m1.1.1.2" xref="S1.I1.i3.p1.1.m1.1.1.2.cmml"></mi><mo id="S1.I1.i3.p1.1.m1.1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.1.cmml">≈</mo><mrow id="S1.I1.i3.p1.1.m1.1.1.3" xref="S1.I1.i3.p1.1.m1.1.1.3.cmml"><mn id="S1.I1.i3.p1.1.m1.1.1.3.2" xref="S1.I1.i3.p1.1.m1.1.1.3.2.cmml">1</mn><mo id="S1.I1.i3.p1.1.m1.1.1.3.1" xref="S1.I1.i3.p1.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.m1.1b"><apply id="S1.I1.i3.p1.1.m1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1"><approx id="S1.I1.i3.p1.1.m1.1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1.1"></approx><csymbol cd="latexml" id="S1.I1.i3.p1.1.m1.1.1.2.cmml" xref="S1.I1.i3.p1.1.m1.1.1.2">absent</csymbol><apply id="S1.I1.i3.p1.1.m1.1.1.3.cmml" xref="S1.I1.i3.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S1.I1.i3.p1.1.m1.1.1.3.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S1.I1.i3.p1.1.m1.1.1.3.2.cmml" xref="S1.I1.i3.p1.1.m1.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">\approx 1\%</annotation></semantics></math> of the updateable parameters when compared to the leading method BiT;</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="S1.I1.i4.p1.1" class="ltx_p">Demonstration of superior parameter efficiency and classification accuracy in distributed low-shot personalization and federated learning applications where model update size is a key performance metric. We show that the <span id="S1.I1.i4.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> communication cost is more than 3 orders of magnitude lower than BiT (7M versus 14B parameters transmitted) in our CIFAR100 federated learning experiment.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>FiLM Transfer (<span id="S2.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>)</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">In this section we detail the <span id="S2.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> algorithm focusing on the few-shot image classification scenario.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.17" class="ltx_p"><span id="S2.p2.17.1" class="ltx_text ltx_font_bold">Preliminaries</span>
We denote input images <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="{\bm{x}}\in{\mathbb{R}}^{ch\times W\times H}" display="inline"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">𝒙</mi><mo id="S2.p2.1.m1.1.1.1" xref="S2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml"><mi id="S2.p2.1.m1.1.1.3.2" xref="S2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p2.1.m1.1.1.3.3" xref="S2.p2.1.m1.1.1.3.3.cmml"><mrow id="S2.p2.1.m1.1.1.3.3.2" xref="S2.p2.1.m1.1.1.3.3.2.cmml"><mi id="S2.p2.1.m1.1.1.3.3.2.2" xref="S2.p2.1.m1.1.1.3.3.2.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.p2.1.m1.1.1.3.3.2.1" xref="S2.p2.1.m1.1.1.3.3.2.1.cmml">​</mo><mi id="S2.p2.1.m1.1.1.3.3.2.3" xref="S2.p2.1.m1.1.1.3.3.2.3.cmml">h</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S2.p2.1.m1.1.1.3.3.1" xref="S2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.p2.1.m1.1.1.3.3.3" xref="S2.p2.1.m1.1.1.3.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p2.1.m1.1.1.3.3.1a" xref="S2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.p2.1.m1.1.1.3.3.4" xref="S2.p2.1.m1.1.1.3.3.4.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><in id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1"></in><ci id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">𝒙</ci><apply id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.3.1.cmml" xref="S2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S2.p2.1.m1.1.1.3.2.cmml" xref="S2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S2.p2.1.m1.1.1.3.3.cmml" xref="S2.p2.1.m1.1.1.3.3"><times id="S2.p2.1.m1.1.1.3.3.1.cmml" xref="S2.p2.1.m1.1.1.3.3.1"></times><apply id="S2.p2.1.m1.1.1.3.3.2.cmml" xref="S2.p2.1.m1.1.1.3.3.2"><times id="S2.p2.1.m1.1.1.3.3.2.1.cmml" xref="S2.p2.1.m1.1.1.3.3.2.1"></times><ci id="S2.p2.1.m1.1.1.3.3.2.2.cmml" xref="S2.p2.1.m1.1.1.3.3.2.2">𝑐</ci><ci id="S2.p2.1.m1.1.1.3.3.2.3.cmml" xref="S2.p2.1.m1.1.1.3.3.2.3">ℎ</ci></apply><ci id="S2.p2.1.m1.1.1.3.3.3.cmml" xref="S2.p2.1.m1.1.1.3.3.3">𝑊</ci><ci id="S2.p2.1.m1.1.1.3.3.4.cmml" xref="S2.p2.1.m1.1.1.3.3.4">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">{\bm{x}}\in{\mathbb{R}}^{ch\times W\times H}</annotation></semantics></math> where <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">W</annotation></semantics></math> is the width, <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S2.p2.3.m3.1a"><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">H</annotation></semantics></math> the height, <math id="S2.p2.4.m4.1" class="ltx_Math" alttext="ch" display="inline"><semantics id="S2.p2.4.m4.1a"><mrow id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><mi id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.p2.4.m4.1.1.1" xref="S2.p2.4.m4.1.1.1.cmml">​</mo><mi id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><times id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1.1"></times><ci id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2">𝑐</ci><ci id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">ch</annotation></semantics></math> the number of channels and image labels <math id="S2.p2.5.m5.3" class="ltx_Math" alttext="y\in\{1,\ldots,C\}" display="inline"><semantics id="S2.p2.5.m5.3a"><mrow id="S2.p2.5.m5.3.4" xref="S2.p2.5.m5.3.4.cmml"><mi id="S2.p2.5.m5.3.4.2" xref="S2.p2.5.m5.3.4.2.cmml">y</mi><mo id="S2.p2.5.m5.3.4.1" xref="S2.p2.5.m5.3.4.1.cmml">∈</mo><mrow id="S2.p2.5.m5.3.4.3.2" xref="S2.p2.5.m5.3.4.3.1.cmml"><mo stretchy="false" id="S2.p2.5.m5.3.4.3.2.1" xref="S2.p2.5.m5.3.4.3.1.cmml">{</mo><mn id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml">1</mn><mo id="S2.p2.5.m5.3.4.3.2.2" xref="S2.p2.5.m5.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.p2.5.m5.2.2" xref="S2.p2.5.m5.2.2.cmml">…</mi><mo id="S2.p2.5.m5.3.4.3.2.3" xref="S2.p2.5.m5.3.4.3.1.cmml">,</mo><mi id="S2.p2.5.m5.3.3" xref="S2.p2.5.m5.3.3.cmml">C</mi><mo stretchy="false" id="S2.p2.5.m5.3.4.3.2.4" xref="S2.p2.5.m5.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.3b"><apply id="S2.p2.5.m5.3.4.cmml" xref="S2.p2.5.m5.3.4"><in id="S2.p2.5.m5.3.4.1.cmml" xref="S2.p2.5.m5.3.4.1"></in><ci id="S2.p2.5.m5.3.4.2.cmml" xref="S2.p2.5.m5.3.4.2">𝑦</ci><set id="S2.p2.5.m5.3.4.3.1.cmml" xref="S2.p2.5.m5.3.4.3.2"><cn type="integer" id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1">1</cn><ci id="S2.p2.5.m5.2.2.cmml" xref="S2.p2.5.m5.2.2">…</ci><ci id="S2.p2.5.m5.3.3.cmml" xref="S2.p2.5.m5.3.3">𝐶</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.3c">y\in\{1,\ldots,C\}</annotation></semantics></math> where <math id="S2.p2.6.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S2.p2.6.m6.1a"><mi id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><ci id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">C</annotation></semantics></math> is the number of image classes indexed by <math id="S2.p2.7.m7.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.p2.7.m7.1a"><mi id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b"><ci id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">c</annotation></semantics></math>.
Assume that we have access to a model <math id="S2.p2.8.m8.3" class="ltx_Math" alttext="f({\bm{x}})=h_{\bm{\phi}}(b_{\bm{\theta}}({\bm{x}}))" display="inline"><semantics id="S2.p2.8.m8.3a"><mrow id="S2.p2.8.m8.3.3" xref="S2.p2.8.m8.3.3.cmml"><mrow id="S2.p2.8.m8.3.3.3" xref="S2.p2.8.m8.3.3.3.cmml"><mi id="S2.p2.8.m8.3.3.3.2" xref="S2.p2.8.m8.3.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.p2.8.m8.3.3.3.1" xref="S2.p2.8.m8.3.3.3.1.cmml">​</mo><mrow id="S2.p2.8.m8.3.3.3.3.2" xref="S2.p2.8.m8.3.3.3.cmml"><mo stretchy="false" id="S2.p2.8.m8.3.3.3.3.2.1" xref="S2.p2.8.m8.3.3.3.cmml">(</mo><mi id="S2.p2.8.m8.1.1" xref="S2.p2.8.m8.1.1.cmml">𝒙</mi><mo stretchy="false" id="S2.p2.8.m8.3.3.3.3.2.2" xref="S2.p2.8.m8.3.3.3.cmml">)</mo></mrow></mrow><mo id="S2.p2.8.m8.3.3.2" xref="S2.p2.8.m8.3.3.2.cmml">=</mo><mrow id="S2.p2.8.m8.3.3.1" xref="S2.p2.8.m8.3.3.1.cmml"><msub id="S2.p2.8.m8.3.3.1.3" xref="S2.p2.8.m8.3.3.1.3.cmml"><mi id="S2.p2.8.m8.3.3.1.3.2" xref="S2.p2.8.m8.3.3.1.3.2.cmml">h</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.p2.8.m8.3.3.1.3.3" xref="S2.p2.8.m8.3.3.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.p2.8.m8.3.3.1.2" xref="S2.p2.8.m8.3.3.1.2.cmml">​</mo><mrow id="S2.p2.8.m8.3.3.1.1.1" xref="S2.p2.8.m8.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.p2.8.m8.3.3.1.1.1.2" xref="S2.p2.8.m8.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.p2.8.m8.3.3.1.1.1.1" xref="S2.p2.8.m8.3.3.1.1.1.1.cmml"><msub id="S2.p2.8.m8.3.3.1.1.1.1.2" xref="S2.p2.8.m8.3.3.1.1.1.1.2.cmml"><mi id="S2.p2.8.m8.3.3.1.1.1.1.2.2" xref="S2.p2.8.m8.3.3.1.1.1.1.2.2.cmml">b</mi><mi id="S2.p2.8.m8.3.3.1.1.1.1.2.3" xref="S2.p2.8.m8.3.3.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S2.p2.8.m8.3.3.1.1.1.1.1" xref="S2.p2.8.m8.3.3.1.1.1.1.1.cmml">​</mo><mrow id="S2.p2.8.m8.3.3.1.1.1.1.3.2" xref="S2.p2.8.m8.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.p2.8.m8.3.3.1.1.1.1.3.2.1" xref="S2.p2.8.m8.3.3.1.1.1.1.cmml">(</mo><mi id="S2.p2.8.m8.2.2" xref="S2.p2.8.m8.2.2.cmml">𝒙</mi><mo stretchy="false" id="S2.p2.8.m8.3.3.1.1.1.1.3.2.2" xref="S2.p2.8.m8.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.p2.8.m8.3.3.1.1.1.3" xref="S2.p2.8.m8.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.3b"><apply id="S2.p2.8.m8.3.3.cmml" xref="S2.p2.8.m8.3.3"><eq id="S2.p2.8.m8.3.3.2.cmml" xref="S2.p2.8.m8.3.3.2"></eq><apply id="S2.p2.8.m8.3.3.3.cmml" xref="S2.p2.8.m8.3.3.3"><times id="S2.p2.8.m8.3.3.3.1.cmml" xref="S2.p2.8.m8.3.3.3.1"></times><ci id="S2.p2.8.m8.3.3.3.2.cmml" xref="S2.p2.8.m8.3.3.3.2">𝑓</ci><ci id="S2.p2.8.m8.1.1.cmml" xref="S2.p2.8.m8.1.1">𝒙</ci></apply><apply id="S2.p2.8.m8.3.3.1.cmml" xref="S2.p2.8.m8.3.3.1"><times id="S2.p2.8.m8.3.3.1.2.cmml" xref="S2.p2.8.m8.3.3.1.2"></times><apply id="S2.p2.8.m8.3.3.1.3.cmml" xref="S2.p2.8.m8.3.3.1.3"><csymbol cd="ambiguous" id="S2.p2.8.m8.3.3.1.3.1.cmml" xref="S2.p2.8.m8.3.3.1.3">subscript</csymbol><ci id="S2.p2.8.m8.3.3.1.3.2.cmml" xref="S2.p2.8.m8.3.3.1.3.2">ℎ</ci><ci id="S2.p2.8.m8.3.3.1.3.3.cmml" xref="S2.p2.8.m8.3.3.1.3.3">bold-italic-ϕ</ci></apply><apply id="S2.p2.8.m8.3.3.1.1.1.1.cmml" xref="S2.p2.8.m8.3.3.1.1.1"><times id="S2.p2.8.m8.3.3.1.1.1.1.1.cmml" xref="S2.p2.8.m8.3.3.1.1.1.1.1"></times><apply id="S2.p2.8.m8.3.3.1.1.1.1.2.cmml" xref="S2.p2.8.m8.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p2.8.m8.3.3.1.1.1.1.2.1.cmml" xref="S2.p2.8.m8.3.3.1.1.1.1.2">subscript</csymbol><ci id="S2.p2.8.m8.3.3.1.1.1.1.2.2.cmml" xref="S2.p2.8.m8.3.3.1.1.1.1.2.2">𝑏</ci><ci id="S2.p2.8.m8.3.3.1.1.1.1.2.3.cmml" xref="S2.p2.8.m8.3.3.1.1.1.1.2.3">𝜽</ci></apply><ci id="S2.p2.8.m8.2.2.cmml" xref="S2.p2.8.m8.2.2">𝒙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m8.3c">f({\bm{x}})=h_{\bm{\phi}}(b_{\bm{\theta}}({\bm{x}}))</annotation></semantics></math> that outputs class-probabilities for an image <math id="S2.p2.9.m9.4" class="ltx_Math" alttext="p(y=c|{\bm{x}},{\bm{\theta}},{\bm{\phi}})" display="inline"><semantics id="S2.p2.9.m9.4a"><mrow id="S2.p2.9.m9.4.4" xref="S2.p2.9.m9.4.4.cmml"><mi id="S2.p2.9.m9.4.4.3" xref="S2.p2.9.m9.4.4.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.p2.9.m9.4.4.2" xref="S2.p2.9.m9.4.4.2.cmml">​</mo><mrow id="S2.p2.9.m9.4.4.1.1" xref="S2.p2.9.m9.4.4.1.1.1.cmml"><mo stretchy="false" id="S2.p2.9.m9.4.4.1.1.2" xref="S2.p2.9.m9.4.4.1.1.1.cmml">(</mo><mrow id="S2.p2.9.m9.4.4.1.1.1" xref="S2.p2.9.m9.4.4.1.1.1.cmml"><mi id="S2.p2.9.m9.4.4.1.1.1.2" xref="S2.p2.9.m9.4.4.1.1.1.2.cmml">y</mi><mo id="S2.p2.9.m9.4.4.1.1.1.1" xref="S2.p2.9.m9.4.4.1.1.1.1.cmml">=</mo><mrow id="S2.p2.9.m9.4.4.1.1.1.3" xref="S2.p2.9.m9.4.4.1.1.1.3.cmml"><mi id="S2.p2.9.m9.4.4.1.1.1.3.2" xref="S2.p2.9.m9.4.4.1.1.1.3.2.cmml">c</mi><mo fence="false" id="S2.p2.9.m9.4.4.1.1.1.3.1" xref="S2.p2.9.m9.4.4.1.1.1.3.1.cmml">|</mo><mrow id="S2.p2.9.m9.4.4.1.1.1.3.3.2" xref="S2.p2.9.m9.4.4.1.1.1.3.3.1.cmml"><mi id="S2.p2.9.m9.1.1" xref="S2.p2.9.m9.1.1.cmml">𝒙</mi><mo id="S2.p2.9.m9.4.4.1.1.1.3.3.2.1" xref="S2.p2.9.m9.4.4.1.1.1.3.3.1.cmml">,</mo><mi id="S2.p2.9.m9.2.2" xref="S2.p2.9.m9.2.2.cmml">𝜽</mi><mo id="S2.p2.9.m9.4.4.1.1.1.3.3.2.2" xref="S2.p2.9.m9.4.4.1.1.1.3.3.1.cmml">,</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.p2.9.m9.3.3" xref="S2.p2.9.m9.3.3.cmml">ϕ</mi></mrow></mrow></mrow><mo stretchy="false" id="S2.p2.9.m9.4.4.1.1.3" xref="S2.p2.9.m9.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.9.m9.4b"><apply id="S2.p2.9.m9.4.4.cmml" xref="S2.p2.9.m9.4.4"><times id="S2.p2.9.m9.4.4.2.cmml" xref="S2.p2.9.m9.4.4.2"></times><ci id="S2.p2.9.m9.4.4.3.cmml" xref="S2.p2.9.m9.4.4.3">𝑝</ci><apply id="S2.p2.9.m9.4.4.1.1.1.cmml" xref="S2.p2.9.m9.4.4.1.1"><eq id="S2.p2.9.m9.4.4.1.1.1.1.cmml" xref="S2.p2.9.m9.4.4.1.1.1.1"></eq><ci id="S2.p2.9.m9.4.4.1.1.1.2.cmml" xref="S2.p2.9.m9.4.4.1.1.1.2">𝑦</ci><apply id="S2.p2.9.m9.4.4.1.1.1.3.cmml" xref="S2.p2.9.m9.4.4.1.1.1.3"><csymbol cd="latexml" id="S2.p2.9.m9.4.4.1.1.1.3.1.cmml" xref="S2.p2.9.m9.4.4.1.1.1.3.1">conditional</csymbol><ci id="S2.p2.9.m9.4.4.1.1.1.3.2.cmml" xref="S2.p2.9.m9.4.4.1.1.1.3.2">𝑐</ci><list id="S2.p2.9.m9.4.4.1.1.1.3.3.1.cmml" xref="S2.p2.9.m9.4.4.1.1.1.3.3.2"><ci id="S2.p2.9.m9.1.1.cmml" xref="S2.p2.9.m9.1.1">𝒙</ci><ci id="S2.p2.9.m9.2.2.cmml" xref="S2.p2.9.m9.2.2">𝜽</ci><ci id="S2.p2.9.m9.3.3.cmml" xref="S2.p2.9.m9.3.3">bold-italic-ϕ</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m9.4c">p(y=c|{\bm{x}},{\bm{\theta}},{\bm{\phi}})</annotation></semantics></math> for <math id="S2.p2.10.m10.3" class="ltx_Math" alttext="c=1,\ldots,C" display="inline"><semantics id="S2.p2.10.m10.3a"><mrow id="S2.p2.10.m10.3.4" xref="S2.p2.10.m10.3.4.cmml"><mi id="S2.p2.10.m10.3.4.2" xref="S2.p2.10.m10.3.4.2.cmml">c</mi><mo id="S2.p2.10.m10.3.4.1" xref="S2.p2.10.m10.3.4.1.cmml">=</mo><mrow id="S2.p2.10.m10.3.4.3.2" xref="S2.p2.10.m10.3.4.3.1.cmml"><mn id="S2.p2.10.m10.1.1" xref="S2.p2.10.m10.1.1.cmml">1</mn><mo id="S2.p2.10.m10.3.4.3.2.1" xref="S2.p2.10.m10.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.p2.10.m10.2.2" xref="S2.p2.10.m10.2.2.cmml">…</mi><mo id="S2.p2.10.m10.3.4.3.2.2" xref="S2.p2.10.m10.3.4.3.1.cmml">,</mo><mi id="S2.p2.10.m10.3.3" xref="S2.p2.10.m10.3.3.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.10.m10.3b"><apply id="S2.p2.10.m10.3.4.cmml" xref="S2.p2.10.m10.3.4"><eq id="S2.p2.10.m10.3.4.1.cmml" xref="S2.p2.10.m10.3.4.1"></eq><ci id="S2.p2.10.m10.3.4.2.cmml" xref="S2.p2.10.m10.3.4.2">𝑐</ci><list id="S2.p2.10.m10.3.4.3.1.cmml" xref="S2.p2.10.m10.3.4.3.2"><cn type="integer" id="S2.p2.10.m10.1.1.cmml" xref="S2.p2.10.m10.1.1">1</cn><ci id="S2.p2.10.m10.2.2.cmml" xref="S2.p2.10.m10.2.2">…</ci><ci id="S2.p2.10.m10.3.3.cmml" xref="S2.p2.10.m10.3.3">𝐶</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m10.3c">c=1,\ldots,C</annotation></semantics></math> and is comprised of a feature extractor backbone <math id="S2.p2.11.m11.1" class="ltx_Math" alttext="b_{\bm{\theta}}({\bm{x}})\in{\mathbb{R}}^{d_{b}}" display="inline"><semantics id="S2.p2.11.m11.1a"><mrow id="S2.p2.11.m11.1.2" xref="S2.p2.11.m11.1.2.cmml"><mrow id="S2.p2.11.m11.1.2.2" xref="S2.p2.11.m11.1.2.2.cmml"><msub id="S2.p2.11.m11.1.2.2.2" xref="S2.p2.11.m11.1.2.2.2.cmml"><mi id="S2.p2.11.m11.1.2.2.2.2" xref="S2.p2.11.m11.1.2.2.2.2.cmml">b</mi><mi id="S2.p2.11.m11.1.2.2.2.3" xref="S2.p2.11.m11.1.2.2.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S2.p2.11.m11.1.2.2.1" xref="S2.p2.11.m11.1.2.2.1.cmml">​</mo><mrow id="S2.p2.11.m11.1.2.2.3.2" xref="S2.p2.11.m11.1.2.2.cmml"><mo stretchy="false" id="S2.p2.11.m11.1.2.2.3.2.1" xref="S2.p2.11.m11.1.2.2.cmml">(</mo><mi id="S2.p2.11.m11.1.1" xref="S2.p2.11.m11.1.1.cmml">𝒙</mi><mo stretchy="false" id="S2.p2.11.m11.1.2.2.3.2.2" xref="S2.p2.11.m11.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.p2.11.m11.1.2.1" xref="S2.p2.11.m11.1.2.1.cmml">∈</mo><msup id="S2.p2.11.m11.1.2.3" xref="S2.p2.11.m11.1.2.3.cmml"><mi id="S2.p2.11.m11.1.2.3.2" xref="S2.p2.11.m11.1.2.3.2.cmml">ℝ</mi><msub id="S2.p2.11.m11.1.2.3.3" xref="S2.p2.11.m11.1.2.3.3.cmml"><mi id="S2.p2.11.m11.1.2.3.3.2" xref="S2.p2.11.m11.1.2.3.3.2.cmml">d</mi><mi id="S2.p2.11.m11.1.2.3.3.3" xref="S2.p2.11.m11.1.2.3.3.3.cmml">b</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.11.m11.1b"><apply id="S2.p2.11.m11.1.2.cmml" xref="S2.p2.11.m11.1.2"><in id="S2.p2.11.m11.1.2.1.cmml" xref="S2.p2.11.m11.1.2.1"></in><apply id="S2.p2.11.m11.1.2.2.cmml" xref="S2.p2.11.m11.1.2.2"><times id="S2.p2.11.m11.1.2.2.1.cmml" xref="S2.p2.11.m11.1.2.2.1"></times><apply id="S2.p2.11.m11.1.2.2.2.cmml" xref="S2.p2.11.m11.1.2.2.2"><csymbol cd="ambiguous" id="S2.p2.11.m11.1.2.2.2.1.cmml" xref="S2.p2.11.m11.1.2.2.2">subscript</csymbol><ci id="S2.p2.11.m11.1.2.2.2.2.cmml" xref="S2.p2.11.m11.1.2.2.2.2">𝑏</ci><ci id="S2.p2.11.m11.1.2.2.2.3.cmml" xref="S2.p2.11.m11.1.2.2.2.3">𝜽</ci></apply><ci id="S2.p2.11.m11.1.1.cmml" xref="S2.p2.11.m11.1.1">𝒙</ci></apply><apply id="S2.p2.11.m11.1.2.3.cmml" xref="S2.p2.11.m11.1.2.3"><csymbol cd="ambiguous" id="S2.p2.11.m11.1.2.3.1.cmml" xref="S2.p2.11.m11.1.2.3">superscript</csymbol><ci id="S2.p2.11.m11.1.2.3.2.cmml" xref="S2.p2.11.m11.1.2.3.2">ℝ</ci><apply id="S2.p2.11.m11.1.2.3.3.cmml" xref="S2.p2.11.m11.1.2.3.3"><csymbol cd="ambiguous" id="S2.p2.11.m11.1.2.3.3.1.cmml" xref="S2.p2.11.m11.1.2.3.3">subscript</csymbol><ci id="S2.p2.11.m11.1.2.3.3.2.cmml" xref="S2.p2.11.m11.1.2.3.3.2">𝑑</ci><ci id="S2.p2.11.m11.1.2.3.3.3.cmml" xref="S2.p2.11.m11.1.2.3.3.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m11.1c">b_{\bm{\theta}}({\bm{x}})\in{\mathbb{R}}^{d_{b}}</annotation></semantics></math> with parameters <math id="S2.p2.12.m12.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.p2.12.m12.1a"><mi id="S2.p2.12.m12.1.1" xref="S2.p2.12.m12.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.p2.12.m12.1b"><ci id="S2.p2.12.m12.1.1.cmml" xref="S2.p2.12.m12.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m12.1c">\theta</annotation></semantics></math> that has been pretrained on a large upstream dataset such as Imagenet where <math id="S2.p2.13.m13.1" class="ltx_Math" alttext="d_{b}" display="inline"><semantics id="S2.p2.13.m13.1a"><msub id="S2.p2.13.m13.1.1" xref="S2.p2.13.m13.1.1.cmml"><mi id="S2.p2.13.m13.1.1.2" xref="S2.p2.13.m13.1.1.2.cmml">d</mi><mi id="S2.p2.13.m13.1.1.3" xref="S2.p2.13.m13.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.13.m13.1b"><apply id="S2.p2.13.m13.1.1.cmml" xref="S2.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S2.p2.13.m13.1.1.1.cmml" xref="S2.p2.13.m13.1.1">subscript</csymbol><ci id="S2.p2.13.m13.1.1.2.cmml" xref="S2.p2.13.m13.1.1.2">𝑑</ci><ci id="S2.p2.13.m13.1.1.3.cmml" xref="S2.p2.13.m13.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.13.m13.1c">d_{b}</annotation></semantics></math> is the output feature dimension and a final layer classifier or head <math id="S2.p2.14.m14.1" class="ltx_Math" alttext="h_{\bm{\phi}}(\cdot)\in{\mathbb{R}}^{C}" display="inline"><semantics id="S2.p2.14.m14.1a"><mrow id="S2.p2.14.m14.1.2" xref="S2.p2.14.m14.1.2.cmml"><mrow id="S2.p2.14.m14.1.2.2" xref="S2.p2.14.m14.1.2.2.cmml"><msub id="S2.p2.14.m14.1.2.2.2" xref="S2.p2.14.m14.1.2.2.2.cmml"><mi id="S2.p2.14.m14.1.2.2.2.2" xref="S2.p2.14.m14.1.2.2.2.2.cmml">h</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.p2.14.m14.1.2.2.2.3" xref="S2.p2.14.m14.1.2.2.2.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.p2.14.m14.1.2.2.1" xref="S2.p2.14.m14.1.2.2.1.cmml">​</mo><mrow id="S2.p2.14.m14.1.2.2.3.2" xref="S2.p2.14.m14.1.2.2.cmml"><mo stretchy="false" id="S2.p2.14.m14.1.2.2.3.2.1" xref="S2.p2.14.m14.1.2.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p2.14.m14.1.1" xref="S2.p2.14.m14.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p2.14.m14.1.2.2.3.2.2" xref="S2.p2.14.m14.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.p2.14.m14.1.2.1" xref="S2.p2.14.m14.1.2.1.cmml">∈</mo><msup id="S2.p2.14.m14.1.2.3" xref="S2.p2.14.m14.1.2.3.cmml"><mi id="S2.p2.14.m14.1.2.3.2" xref="S2.p2.14.m14.1.2.3.2.cmml">ℝ</mi><mi id="S2.p2.14.m14.1.2.3.3" xref="S2.p2.14.m14.1.2.3.3.cmml">C</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.14.m14.1b"><apply id="S2.p2.14.m14.1.2.cmml" xref="S2.p2.14.m14.1.2"><in id="S2.p2.14.m14.1.2.1.cmml" xref="S2.p2.14.m14.1.2.1"></in><apply id="S2.p2.14.m14.1.2.2.cmml" xref="S2.p2.14.m14.1.2.2"><times id="S2.p2.14.m14.1.2.2.1.cmml" xref="S2.p2.14.m14.1.2.2.1"></times><apply id="S2.p2.14.m14.1.2.2.2.cmml" xref="S2.p2.14.m14.1.2.2.2"><csymbol cd="ambiguous" id="S2.p2.14.m14.1.2.2.2.1.cmml" xref="S2.p2.14.m14.1.2.2.2">subscript</csymbol><ci id="S2.p2.14.m14.1.2.2.2.2.cmml" xref="S2.p2.14.m14.1.2.2.2.2">ℎ</ci><ci id="S2.p2.14.m14.1.2.2.2.3.cmml" xref="S2.p2.14.m14.1.2.2.2.3">bold-italic-ϕ</ci></apply><ci id="S2.p2.14.m14.1.1.cmml" xref="S2.p2.14.m14.1.1">⋅</ci></apply><apply id="S2.p2.14.m14.1.2.3.cmml" xref="S2.p2.14.m14.1.2.3"><csymbol cd="ambiguous" id="S2.p2.14.m14.1.2.3.1.cmml" xref="S2.p2.14.m14.1.2.3">superscript</csymbol><ci id="S2.p2.14.m14.1.2.3.2.cmml" xref="S2.p2.14.m14.1.2.3.2">ℝ</ci><ci id="S2.p2.14.m14.1.2.3.3.cmml" xref="S2.p2.14.m14.1.2.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.14.m14.1c">h_{\bm{\phi}}(\cdot)\in{\mathbb{R}}^{C}</annotation></semantics></math> with weights <math id="S2.p2.15.m15.1" class="ltx_Math" alttext="{\bm{\phi}}" display="inline"><semantics id="S2.p2.15.m15.1a"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.p2.15.m15.1.1" xref="S2.p2.15.m15.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.p2.15.m15.1b"><ci id="S2.p2.15.m15.1.1.cmml" xref="S2.p2.15.m15.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.15.m15.1c">{\bm{\phi}}</annotation></semantics></math>.
Let <math id="S2.p2.16.m16.1" class="ltx_Math" alttext="\mathcal{D}=\{({\bm{x}}_{n},y_{n})\}_{n=1}^{N}" display="inline"><semantics id="S2.p2.16.m16.1a"><mrow id="S2.p2.16.m16.1.1" xref="S2.p2.16.m16.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.16.m16.1.1.3" xref="S2.p2.16.m16.1.1.3.cmml">𝒟</mi><mo id="S2.p2.16.m16.1.1.2" xref="S2.p2.16.m16.1.1.2.cmml">=</mo><msubsup id="S2.p2.16.m16.1.1.1" xref="S2.p2.16.m16.1.1.1.cmml"><mrow id="S2.p2.16.m16.1.1.1.1.1.1" xref="S2.p2.16.m16.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.p2.16.m16.1.1.1.1.1.1.2" xref="S2.p2.16.m16.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.p2.16.m16.1.1.1.1.1.1.1.2" xref="S2.p2.16.m16.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.p2.16.m16.1.1.1.1.1.1.1.2.3" xref="S2.p2.16.m16.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S2.p2.16.m16.1.1.1.1.1.1.1.1.1" xref="S2.p2.16.m16.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p2.16.m16.1.1.1.1.1.1.1.1.1.2" xref="S2.p2.16.m16.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.p2.16.m16.1.1.1.1.1.1.1.1.1.3" xref="S2.p2.16.m16.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S2.p2.16.m16.1.1.1.1.1.1.1.2.4" xref="S2.p2.16.m16.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S2.p2.16.m16.1.1.1.1.1.1.1.2.2" xref="S2.p2.16.m16.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.p2.16.m16.1.1.1.1.1.1.1.2.2.2" xref="S2.p2.16.m16.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S2.p2.16.m16.1.1.1.1.1.1.1.2.2.3" xref="S2.p2.16.m16.1.1.1.1.1.1.1.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="S2.p2.16.m16.1.1.1.1.1.1.1.2.5" xref="S2.p2.16.m16.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S2.p2.16.m16.1.1.1.1.1.1.3" xref="S2.p2.16.m16.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p2.16.m16.1.1.1.1.3" xref="S2.p2.16.m16.1.1.1.1.3.cmml"><mi id="S2.p2.16.m16.1.1.1.1.3.2" xref="S2.p2.16.m16.1.1.1.1.3.2.cmml">n</mi><mo id="S2.p2.16.m16.1.1.1.1.3.1" xref="S2.p2.16.m16.1.1.1.1.3.1.cmml">=</mo><mn id="S2.p2.16.m16.1.1.1.1.3.3" xref="S2.p2.16.m16.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p2.16.m16.1.1.1.3" xref="S2.p2.16.m16.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.16.m16.1b"><apply id="S2.p2.16.m16.1.1.cmml" xref="S2.p2.16.m16.1.1"><eq id="S2.p2.16.m16.1.1.2.cmml" xref="S2.p2.16.m16.1.1.2"></eq><ci id="S2.p2.16.m16.1.1.3.cmml" xref="S2.p2.16.m16.1.1.3">𝒟</ci><apply id="S2.p2.16.m16.1.1.1.cmml" xref="S2.p2.16.m16.1.1.1"><csymbol cd="ambiguous" id="S2.p2.16.m16.1.1.1.2.cmml" xref="S2.p2.16.m16.1.1.1">superscript</csymbol><apply id="S2.p2.16.m16.1.1.1.1.cmml" xref="S2.p2.16.m16.1.1.1"><csymbol cd="ambiguous" id="S2.p2.16.m16.1.1.1.1.2.cmml" xref="S2.p2.16.m16.1.1.1">subscript</csymbol><set id="S2.p2.16.m16.1.1.1.1.1.2.cmml" xref="S2.p2.16.m16.1.1.1.1.1.1"><interval closure="open" id="S2.p2.16.m16.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.16.m16.1.1.1.1.1.1.1.2"><apply id="S2.p2.16.m16.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.16.m16.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.16.m16.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.16.m16.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.16.m16.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.16.m16.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.p2.16.m16.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.16.m16.1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S2.p2.16.m16.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p2.16.m16.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.p2.16.m16.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.p2.16.m16.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.p2.16.m16.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.p2.16.m16.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S2.p2.16.m16.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.p2.16.m16.1.1.1.1.1.1.1.2.2.3">𝑛</ci></apply></interval></set><apply id="S2.p2.16.m16.1.1.1.1.3.cmml" xref="S2.p2.16.m16.1.1.1.1.3"><eq id="S2.p2.16.m16.1.1.1.1.3.1.cmml" xref="S2.p2.16.m16.1.1.1.1.3.1"></eq><ci id="S2.p2.16.m16.1.1.1.1.3.2.cmml" xref="S2.p2.16.m16.1.1.1.1.3.2">𝑛</ci><cn type="integer" id="S2.p2.16.m16.1.1.1.1.3.3.cmml" xref="S2.p2.16.m16.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p2.16.m16.1.1.1.3.cmml" xref="S2.p2.16.m16.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.16.m16.1c">\mathcal{D}=\{({\bm{x}}_{n},y_{n})\}_{n=1}^{N}</annotation></semantics></math> be the downstream dataset that we wish to fine-tune the model <math id="S2.p2.17.m17.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S2.p2.17.m17.1a"><mi id="S2.p2.17.m17.1.1" xref="S2.p2.17.m17.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.p2.17.m17.1b"><ci id="S2.p2.17.m17.1.1.cmml" xref="S2.p2.17.m17.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.17.m17.1c">f</annotation></semantics></math> to.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.13" class="ltx_p"><span id="S2.p3.13.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FiT<span id="S2.p3.13.1.1" class="ltx_text ltx_font_upright"> Backbone</span></span>

For the network backbone, we freeze the parameters <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.p3.1.m1.1a"><mi id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\theta</annotation></semantics></math> to the values learned during upstream pretraining. To enable parameter-efficient and flexible adaptation of the backbone, we add Feature-wise Linear Modulation (FiLM) <cite class="ltx_cite ltx_citemacro_citep">(Perez et al., <a href="#bib.bib45" title="" class="ltx_ref">2018</a>)</cite> layers with parameters <math id="S2.p3.2.m2.1" class="ltx_Math" alttext="{\bm{\psi}}" display="inline"><semantics id="S2.p3.2.m2.1a"><mi id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">𝝍</mi><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">𝝍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">{\bm{\psi}}</annotation></semantics></math> at strategic points within <math id="S2.p3.3.m3.1" class="ltx_Math" alttext="b_{\bm{\theta}}" display="inline"><semantics id="S2.p3.3.m3.1a"><msub id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml"><mi id="S2.p3.3.m3.1.1.2" xref="S2.p3.3.m3.1.1.2.cmml">b</mi><mi id="S2.p3.3.m3.1.1.3" xref="S2.p3.3.m3.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><apply id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.cmml" xref="S2.p3.3.m3.1.1">subscript</csymbol><ci id="S2.p3.3.m3.1.1.2.cmml" xref="S2.p3.3.m3.1.1.2">𝑏</ci><ci id="S2.p3.3.m3.1.1.3.cmml" xref="S2.p3.3.m3.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">b_{\bm{\theta}}</annotation></semantics></math>.
A FiLM layer scales and shifts the activations <math id="S2.p3.4.m4.1" class="ltx_Math" alttext="{\bm{a}}_{ij}" display="inline"><semantics id="S2.p3.4.m4.1a"><msub id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml"><mi id="S2.p3.4.m4.1.1.2" xref="S2.p3.4.m4.1.1.2.cmml">𝒂</mi><mrow id="S2.p3.4.m4.1.1.3" xref="S2.p3.4.m4.1.1.3.cmml"><mi id="S2.p3.4.m4.1.1.3.2" xref="S2.p3.4.m4.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p3.4.m4.1.1.3.1" xref="S2.p3.4.m4.1.1.3.1.cmml">​</mo><mi id="S2.p3.4.m4.1.1.3.3" xref="S2.p3.4.m4.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.1b"><apply id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p3.4.m4.1.1.1.cmml" xref="S2.p3.4.m4.1.1">subscript</csymbol><ci id="S2.p3.4.m4.1.1.2.cmml" xref="S2.p3.4.m4.1.1.2">𝒂</ci><apply id="S2.p3.4.m4.1.1.3.cmml" xref="S2.p3.4.m4.1.1.3"><times id="S2.p3.4.m4.1.1.3.1.cmml" xref="S2.p3.4.m4.1.1.3.1"></times><ci id="S2.p3.4.m4.1.1.3.2.cmml" xref="S2.p3.4.m4.1.1.3.2">𝑖</ci><ci id="S2.p3.4.m4.1.1.3.3.cmml" xref="S2.p3.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.1c">{\bm{a}}_{ij}</annotation></semantics></math> arising from the <math id="S2.p3.5.m5.1" class="ltx_Math" alttext="j^{th}" display="inline"><semantics id="S2.p3.5.m5.1a"><msup id="S2.p3.5.m5.1.1" xref="S2.p3.5.m5.1.1.cmml"><mi id="S2.p3.5.m5.1.1.2" xref="S2.p3.5.m5.1.1.2.cmml">j</mi><mrow id="S2.p3.5.m5.1.1.3" xref="S2.p3.5.m5.1.1.3.cmml"><mi id="S2.p3.5.m5.1.1.3.2" xref="S2.p3.5.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p3.5.m5.1.1.3.1" xref="S2.p3.5.m5.1.1.3.1.cmml">​</mo><mi id="S2.p3.5.m5.1.1.3.3" xref="S2.p3.5.m5.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.p3.5.m5.1b"><apply id="S2.p3.5.m5.1.1.cmml" xref="S2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p3.5.m5.1.1.1.cmml" xref="S2.p3.5.m5.1.1">superscript</csymbol><ci id="S2.p3.5.m5.1.1.2.cmml" xref="S2.p3.5.m5.1.1.2">𝑗</ci><apply id="S2.p3.5.m5.1.1.3.cmml" xref="S2.p3.5.m5.1.1.3"><times id="S2.p3.5.m5.1.1.3.1.cmml" xref="S2.p3.5.m5.1.1.3.1"></times><ci id="S2.p3.5.m5.1.1.3.2.cmml" xref="S2.p3.5.m5.1.1.3.2">𝑡</ci><ci id="S2.p3.5.m5.1.1.3.3.cmml" xref="S2.p3.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m5.1c">j^{th}</annotation></semantics></math> channel of a convolutional layer in the <math id="S2.p3.6.m6.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S2.p3.6.m6.1a"><msup id="S2.p3.6.m6.1.1" xref="S2.p3.6.m6.1.1.cmml"><mi id="S2.p3.6.m6.1.1.2" xref="S2.p3.6.m6.1.1.2.cmml">i</mi><mrow id="S2.p3.6.m6.1.1.3" xref="S2.p3.6.m6.1.1.3.cmml"><mi id="S2.p3.6.m6.1.1.3.2" xref="S2.p3.6.m6.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p3.6.m6.1.1.3.1" xref="S2.p3.6.m6.1.1.3.1.cmml">​</mo><mi id="S2.p3.6.m6.1.1.3.3" xref="S2.p3.6.m6.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.p3.6.m6.1b"><apply id="S2.p3.6.m6.1.1.cmml" xref="S2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p3.6.m6.1.1.1.cmml" xref="S2.p3.6.m6.1.1">superscript</csymbol><ci id="S2.p3.6.m6.1.1.2.cmml" xref="S2.p3.6.m6.1.1.2">𝑖</ci><apply id="S2.p3.6.m6.1.1.3.cmml" xref="S2.p3.6.m6.1.1.3"><times id="S2.p3.6.m6.1.1.3.1.cmml" xref="S2.p3.6.m6.1.1.3.1"></times><ci id="S2.p3.6.m6.1.1.3.2.cmml" xref="S2.p3.6.m6.1.1.3.2">𝑡</ci><ci id="S2.p3.6.m6.1.1.3.3.cmml" xref="S2.p3.6.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m6.1c">i^{th}</annotation></semantics></math> block of the backbone as <math id="S2.p3.7.m7.3" class="ltx_Math" alttext="\texttt{FiLM}({\bm{a}}_{ij},\gamma_{ij},\beta_{ij})=\gamma_{ij}{\bm{a}}_{ij}+\beta_{ij}" display="inline"><semantics id="S2.p3.7.m7.3a"><mrow id="S2.p3.7.m7.3.3" xref="S2.p3.7.m7.3.3.cmml"><mrow id="S2.p3.7.m7.3.3.3" xref="S2.p3.7.m7.3.3.3.cmml"><mtext class="ltx_mathvariant_monospace" id="S2.p3.7.m7.3.3.3.5" xref="S2.p3.7.m7.3.3.3.5a.cmml">FiLM</mtext><mo lspace="0em" rspace="0em" id="S2.p3.7.m7.3.3.3.4" xref="S2.p3.7.m7.3.3.3.4.cmml">​</mo><mrow id="S2.p3.7.m7.3.3.3.3.3" xref="S2.p3.7.m7.3.3.3.3.4.cmml"><mo stretchy="false" id="S2.p3.7.m7.3.3.3.3.3.4" xref="S2.p3.7.m7.3.3.3.3.4.cmml">(</mo><msub id="S2.p3.7.m7.1.1.1.1.1.1" xref="S2.p3.7.m7.1.1.1.1.1.1.cmml"><mi id="S2.p3.7.m7.1.1.1.1.1.1.2" xref="S2.p3.7.m7.1.1.1.1.1.1.2.cmml">𝒂</mi><mrow id="S2.p3.7.m7.1.1.1.1.1.1.3" xref="S2.p3.7.m7.1.1.1.1.1.1.3.cmml"><mi id="S2.p3.7.m7.1.1.1.1.1.1.3.2" xref="S2.p3.7.m7.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p3.7.m7.1.1.1.1.1.1.3.1" xref="S2.p3.7.m7.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.p3.7.m7.1.1.1.1.1.1.3.3" xref="S2.p3.7.m7.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S2.p3.7.m7.3.3.3.3.3.5" xref="S2.p3.7.m7.3.3.3.3.4.cmml">,</mo><msub id="S2.p3.7.m7.2.2.2.2.2.2" xref="S2.p3.7.m7.2.2.2.2.2.2.cmml"><mi id="S2.p3.7.m7.2.2.2.2.2.2.2" xref="S2.p3.7.m7.2.2.2.2.2.2.2.cmml">γ</mi><mrow id="S2.p3.7.m7.2.2.2.2.2.2.3" xref="S2.p3.7.m7.2.2.2.2.2.2.3.cmml"><mi id="S2.p3.7.m7.2.2.2.2.2.2.3.2" xref="S2.p3.7.m7.2.2.2.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p3.7.m7.2.2.2.2.2.2.3.1" xref="S2.p3.7.m7.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S2.p3.7.m7.2.2.2.2.2.2.3.3" xref="S2.p3.7.m7.2.2.2.2.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.p3.7.m7.3.3.3.3.3.6" xref="S2.p3.7.m7.3.3.3.3.4.cmml">,</mo><msub id="S2.p3.7.m7.3.3.3.3.3.3" xref="S2.p3.7.m7.3.3.3.3.3.3.cmml"><mi id="S2.p3.7.m7.3.3.3.3.3.3.2" xref="S2.p3.7.m7.3.3.3.3.3.3.2.cmml">β</mi><mrow id="S2.p3.7.m7.3.3.3.3.3.3.3" xref="S2.p3.7.m7.3.3.3.3.3.3.3.cmml"><mi id="S2.p3.7.m7.3.3.3.3.3.3.3.2" xref="S2.p3.7.m7.3.3.3.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p3.7.m7.3.3.3.3.3.3.3.1" xref="S2.p3.7.m7.3.3.3.3.3.3.3.1.cmml">​</mo><mi id="S2.p3.7.m7.3.3.3.3.3.3.3.3" xref="S2.p3.7.m7.3.3.3.3.3.3.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="S2.p3.7.m7.3.3.3.3.3.7" xref="S2.p3.7.m7.3.3.3.3.4.cmml">)</mo></mrow></mrow><mo id="S2.p3.7.m7.3.3.4" xref="S2.p3.7.m7.3.3.4.cmml">=</mo><mrow id="S2.p3.7.m7.3.3.5" xref="S2.p3.7.m7.3.3.5.cmml"><mrow id="S2.p3.7.m7.3.3.5.2" xref="S2.p3.7.m7.3.3.5.2.cmml"><msub id="S2.p3.7.m7.3.3.5.2.2" xref="S2.p3.7.m7.3.3.5.2.2.cmml"><mi id="S2.p3.7.m7.3.3.5.2.2.2" xref="S2.p3.7.m7.3.3.5.2.2.2.cmml">γ</mi><mrow id="S2.p3.7.m7.3.3.5.2.2.3" xref="S2.p3.7.m7.3.3.5.2.2.3.cmml"><mi id="S2.p3.7.m7.3.3.5.2.2.3.2" xref="S2.p3.7.m7.3.3.5.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p3.7.m7.3.3.5.2.2.3.1" xref="S2.p3.7.m7.3.3.5.2.2.3.1.cmml">​</mo><mi id="S2.p3.7.m7.3.3.5.2.2.3.3" xref="S2.p3.7.m7.3.3.5.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.p3.7.m7.3.3.5.2.1" xref="S2.p3.7.m7.3.3.5.2.1.cmml">​</mo><msub id="S2.p3.7.m7.3.3.5.2.3" xref="S2.p3.7.m7.3.3.5.2.3.cmml"><mi id="S2.p3.7.m7.3.3.5.2.3.2" xref="S2.p3.7.m7.3.3.5.2.3.2.cmml">𝒂</mi><mrow id="S2.p3.7.m7.3.3.5.2.3.3" xref="S2.p3.7.m7.3.3.5.2.3.3.cmml"><mi id="S2.p3.7.m7.3.3.5.2.3.3.2" xref="S2.p3.7.m7.3.3.5.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p3.7.m7.3.3.5.2.3.3.1" xref="S2.p3.7.m7.3.3.5.2.3.3.1.cmml">​</mo><mi id="S2.p3.7.m7.3.3.5.2.3.3.3" xref="S2.p3.7.m7.3.3.5.2.3.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S2.p3.7.m7.3.3.5.1" xref="S2.p3.7.m7.3.3.5.1.cmml">+</mo><msub id="S2.p3.7.m7.3.3.5.3" xref="S2.p3.7.m7.3.3.5.3.cmml"><mi id="S2.p3.7.m7.3.3.5.3.2" xref="S2.p3.7.m7.3.3.5.3.2.cmml">β</mi><mrow id="S2.p3.7.m7.3.3.5.3.3" xref="S2.p3.7.m7.3.3.5.3.3.cmml"><mi id="S2.p3.7.m7.3.3.5.3.3.2" xref="S2.p3.7.m7.3.3.5.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p3.7.m7.3.3.5.3.3.1" xref="S2.p3.7.m7.3.3.5.3.3.1.cmml">​</mo><mi id="S2.p3.7.m7.3.3.5.3.3.3" xref="S2.p3.7.m7.3.3.5.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.7.m7.3b"><apply id="S2.p3.7.m7.3.3.cmml" xref="S2.p3.7.m7.3.3"><eq id="S2.p3.7.m7.3.3.4.cmml" xref="S2.p3.7.m7.3.3.4"></eq><apply id="S2.p3.7.m7.3.3.3.cmml" xref="S2.p3.7.m7.3.3.3"><times id="S2.p3.7.m7.3.3.3.4.cmml" xref="S2.p3.7.m7.3.3.3.4"></times><ci id="S2.p3.7.m7.3.3.3.5a.cmml" xref="S2.p3.7.m7.3.3.3.5"><mtext class="ltx_mathvariant_monospace" id="S2.p3.7.m7.3.3.3.5.cmml" xref="S2.p3.7.m7.3.3.3.5">FiLM</mtext></ci><vector id="S2.p3.7.m7.3.3.3.3.4.cmml" xref="S2.p3.7.m7.3.3.3.3.3"><apply id="S2.p3.7.m7.1.1.1.1.1.1.cmml" xref="S2.p3.7.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.7.m7.1.1.1.1.1.1.1.cmml" xref="S2.p3.7.m7.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.7.m7.1.1.1.1.1.1.2.cmml" xref="S2.p3.7.m7.1.1.1.1.1.1.2">𝒂</ci><apply id="S2.p3.7.m7.1.1.1.1.1.1.3.cmml" xref="S2.p3.7.m7.1.1.1.1.1.1.3"><times id="S2.p3.7.m7.1.1.1.1.1.1.3.1.cmml" xref="S2.p3.7.m7.1.1.1.1.1.1.3.1"></times><ci id="S2.p3.7.m7.1.1.1.1.1.1.3.2.cmml" xref="S2.p3.7.m7.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S2.p3.7.m7.1.1.1.1.1.1.3.3.cmml" xref="S2.p3.7.m7.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S2.p3.7.m7.2.2.2.2.2.2.cmml" xref="S2.p3.7.m7.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p3.7.m7.2.2.2.2.2.2.1.cmml" xref="S2.p3.7.m7.2.2.2.2.2.2">subscript</csymbol><ci id="S2.p3.7.m7.2.2.2.2.2.2.2.cmml" xref="S2.p3.7.m7.2.2.2.2.2.2.2">𝛾</ci><apply id="S2.p3.7.m7.2.2.2.2.2.2.3.cmml" xref="S2.p3.7.m7.2.2.2.2.2.2.3"><times id="S2.p3.7.m7.2.2.2.2.2.2.3.1.cmml" xref="S2.p3.7.m7.2.2.2.2.2.2.3.1"></times><ci id="S2.p3.7.m7.2.2.2.2.2.2.3.2.cmml" xref="S2.p3.7.m7.2.2.2.2.2.2.3.2">𝑖</ci><ci id="S2.p3.7.m7.2.2.2.2.2.2.3.3.cmml" xref="S2.p3.7.m7.2.2.2.2.2.2.3.3">𝑗</ci></apply></apply><apply id="S2.p3.7.m7.3.3.3.3.3.3.cmml" xref="S2.p3.7.m7.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.p3.7.m7.3.3.3.3.3.3.1.cmml" xref="S2.p3.7.m7.3.3.3.3.3.3">subscript</csymbol><ci id="S2.p3.7.m7.3.3.3.3.3.3.2.cmml" xref="S2.p3.7.m7.3.3.3.3.3.3.2">𝛽</ci><apply id="S2.p3.7.m7.3.3.3.3.3.3.3.cmml" xref="S2.p3.7.m7.3.3.3.3.3.3.3"><times id="S2.p3.7.m7.3.3.3.3.3.3.3.1.cmml" xref="S2.p3.7.m7.3.3.3.3.3.3.3.1"></times><ci id="S2.p3.7.m7.3.3.3.3.3.3.3.2.cmml" xref="S2.p3.7.m7.3.3.3.3.3.3.3.2">𝑖</ci><ci id="S2.p3.7.m7.3.3.3.3.3.3.3.3.cmml" xref="S2.p3.7.m7.3.3.3.3.3.3.3.3">𝑗</ci></apply></apply></vector></apply><apply id="S2.p3.7.m7.3.3.5.cmml" xref="S2.p3.7.m7.3.3.5"><plus id="S2.p3.7.m7.3.3.5.1.cmml" xref="S2.p3.7.m7.3.3.5.1"></plus><apply id="S2.p3.7.m7.3.3.5.2.cmml" xref="S2.p3.7.m7.3.3.5.2"><times id="S2.p3.7.m7.3.3.5.2.1.cmml" xref="S2.p3.7.m7.3.3.5.2.1"></times><apply id="S2.p3.7.m7.3.3.5.2.2.cmml" xref="S2.p3.7.m7.3.3.5.2.2"><csymbol cd="ambiguous" id="S2.p3.7.m7.3.3.5.2.2.1.cmml" xref="S2.p3.7.m7.3.3.5.2.2">subscript</csymbol><ci id="S2.p3.7.m7.3.3.5.2.2.2.cmml" xref="S2.p3.7.m7.3.3.5.2.2.2">𝛾</ci><apply id="S2.p3.7.m7.3.3.5.2.2.3.cmml" xref="S2.p3.7.m7.3.3.5.2.2.3"><times id="S2.p3.7.m7.3.3.5.2.2.3.1.cmml" xref="S2.p3.7.m7.3.3.5.2.2.3.1"></times><ci id="S2.p3.7.m7.3.3.5.2.2.3.2.cmml" xref="S2.p3.7.m7.3.3.5.2.2.3.2">𝑖</ci><ci id="S2.p3.7.m7.3.3.5.2.2.3.3.cmml" xref="S2.p3.7.m7.3.3.5.2.2.3.3">𝑗</ci></apply></apply><apply id="S2.p3.7.m7.3.3.5.2.3.cmml" xref="S2.p3.7.m7.3.3.5.2.3"><csymbol cd="ambiguous" id="S2.p3.7.m7.3.3.5.2.3.1.cmml" xref="S2.p3.7.m7.3.3.5.2.3">subscript</csymbol><ci id="S2.p3.7.m7.3.3.5.2.3.2.cmml" xref="S2.p3.7.m7.3.3.5.2.3.2">𝒂</ci><apply id="S2.p3.7.m7.3.3.5.2.3.3.cmml" xref="S2.p3.7.m7.3.3.5.2.3.3"><times id="S2.p3.7.m7.3.3.5.2.3.3.1.cmml" xref="S2.p3.7.m7.3.3.5.2.3.3.1"></times><ci id="S2.p3.7.m7.3.3.5.2.3.3.2.cmml" xref="S2.p3.7.m7.3.3.5.2.3.3.2">𝑖</ci><ci id="S2.p3.7.m7.3.3.5.2.3.3.3.cmml" xref="S2.p3.7.m7.3.3.5.2.3.3.3">𝑗</ci></apply></apply></apply><apply id="S2.p3.7.m7.3.3.5.3.cmml" xref="S2.p3.7.m7.3.3.5.3"><csymbol cd="ambiguous" id="S2.p3.7.m7.3.3.5.3.1.cmml" xref="S2.p3.7.m7.3.3.5.3">subscript</csymbol><ci id="S2.p3.7.m7.3.3.5.3.2.cmml" xref="S2.p3.7.m7.3.3.5.3.2">𝛽</ci><apply id="S2.p3.7.m7.3.3.5.3.3.cmml" xref="S2.p3.7.m7.3.3.5.3.3"><times id="S2.p3.7.m7.3.3.5.3.3.1.cmml" xref="S2.p3.7.m7.3.3.5.3.3.1"></times><ci id="S2.p3.7.m7.3.3.5.3.3.2.cmml" xref="S2.p3.7.m7.3.3.5.3.3.2">𝑖</ci><ci id="S2.p3.7.m7.3.3.5.3.3.3.cmml" xref="S2.p3.7.m7.3.3.5.3.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m7.3c">\texttt{FiLM}({\bm{a}}_{ij},\gamma_{ij},\beta_{ij})=\gamma_{ij}{\bm{a}}_{ij}+\beta_{ij}</annotation></semantics></math>, where <math id="S2.p3.8.m8.1" class="ltx_Math" alttext="\gamma_{ij}" display="inline"><semantics id="S2.p3.8.m8.1a"><msub id="S2.p3.8.m8.1.1" xref="S2.p3.8.m8.1.1.cmml"><mi id="S2.p3.8.m8.1.1.2" xref="S2.p3.8.m8.1.1.2.cmml">γ</mi><mrow id="S2.p3.8.m8.1.1.3" xref="S2.p3.8.m8.1.1.3.cmml"><mi id="S2.p3.8.m8.1.1.3.2" xref="S2.p3.8.m8.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p3.8.m8.1.1.3.1" xref="S2.p3.8.m8.1.1.3.1.cmml">​</mo><mi id="S2.p3.8.m8.1.1.3.3" xref="S2.p3.8.m8.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p3.8.m8.1b"><apply id="S2.p3.8.m8.1.1.cmml" xref="S2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p3.8.m8.1.1.1.cmml" xref="S2.p3.8.m8.1.1">subscript</csymbol><ci id="S2.p3.8.m8.1.1.2.cmml" xref="S2.p3.8.m8.1.1.2">𝛾</ci><apply id="S2.p3.8.m8.1.1.3.cmml" xref="S2.p3.8.m8.1.1.3"><times id="S2.p3.8.m8.1.1.3.1.cmml" xref="S2.p3.8.m8.1.1.3.1"></times><ci id="S2.p3.8.m8.1.1.3.2.cmml" xref="S2.p3.8.m8.1.1.3.2">𝑖</ci><ci id="S2.p3.8.m8.1.1.3.3.cmml" xref="S2.p3.8.m8.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m8.1c">\gamma_{ij}</annotation></semantics></math> and <math id="S2.p3.9.m9.1" class="ltx_Math" alttext="\beta_{ij}" display="inline"><semantics id="S2.p3.9.m9.1a"><msub id="S2.p3.9.m9.1.1" xref="S2.p3.9.m9.1.1.cmml"><mi id="S2.p3.9.m9.1.1.2" xref="S2.p3.9.m9.1.1.2.cmml">β</mi><mrow id="S2.p3.9.m9.1.1.3" xref="S2.p3.9.m9.1.1.3.cmml"><mi id="S2.p3.9.m9.1.1.3.2" xref="S2.p3.9.m9.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p3.9.m9.1.1.3.1" xref="S2.p3.9.m9.1.1.3.1.cmml">​</mo><mi id="S2.p3.9.m9.1.1.3.3" xref="S2.p3.9.m9.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p3.9.m9.1b"><apply id="S2.p3.9.m9.1.1.cmml" xref="S2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p3.9.m9.1.1.1.cmml" xref="S2.p3.9.m9.1.1">subscript</csymbol><ci id="S2.p3.9.m9.1.1.2.cmml" xref="S2.p3.9.m9.1.1.2">𝛽</ci><apply id="S2.p3.9.m9.1.1.3.cmml" xref="S2.p3.9.m9.1.1.3"><times id="S2.p3.9.m9.1.1.3.1.cmml" xref="S2.p3.9.m9.1.1.3.1"></times><ci id="S2.p3.9.m9.1.1.3.2.cmml" xref="S2.p3.9.m9.1.1.3.2">𝑖</ci><ci id="S2.p3.9.m9.1.1.3.3.cmml" xref="S2.p3.9.m9.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.9.m9.1c">\beta_{ij}</annotation></semantics></math> are scalars.
The set of FiLM parameters <math id="S2.p3.10.m10.2" class="ltx_Math" alttext="{\bm{\psi}}=\{\gamma_{ij},\beta_{ij}\}" display="inline"><semantics id="S2.p3.10.m10.2a"><mrow id="S2.p3.10.m10.2.2" xref="S2.p3.10.m10.2.2.cmml"><mi id="S2.p3.10.m10.2.2.4" xref="S2.p3.10.m10.2.2.4.cmml">𝝍</mi><mo id="S2.p3.10.m10.2.2.3" xref="S2.p3.10.m10.2.2.3.cmml">=</mo><mrow id="S2.p3.10.m10.2.2.2.2" xref="S2.p3.10.m10.2.2.2.3.cmml"><mo stretchy="false" id="S2.p3.10.m10.2.2.2.2.3" xref="S2.p3.10.m10.2.2.2.3.cmml">{</mo><msub id="S2.p3.10.m10.1.1.1.1.1" xref="S2.p3.10.m10.1.1.1.1.1.cmml"><mi id="S2.p3.10.m10.1.1.1.1.1.2" xref="S2.p3.10.m10.1.1.1.1.1.2.cmml">γ</mi><mrow id="S2.p3.10.m10.1.1.1.1.1.3" xref="S2.p3.10.m10.1.1.1.1.1.3.cmml"><mi id="S2.p3.10.m10.1.1.1.1.1.3.2" xref="S2.p3.10.m10.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p3.10.m10.1.1.1.1.1.3.1" xref="S2.p3.10.m10.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.p3.10.m10.1.1.1.1.1.3.3" xref="S2.p3.10.m10.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S2.p3.10.m10.2.2.2.2.4" xref="S2.p3.10.m10.2.2.2.3.cmml">,</mo><msub id="S2.p3.10.m10.2.2.2.2.2" xref="S2.p3.10.m10.2.2.2.2.2.cmml"><mi id="S2.p3.10.m10.2.2.2.2.2.2" xref="S2.p3.10.m10.2.2.2.2.2.2.cmml">β</mi><mrow id="S2.p3.10.m10.2.2.2.2.2.3" xref="S2.p3.10.m10.2.2.2.2.2.3.cmml"><mi id="S2.p3.10.m10.2.2.2.2.2.3.2" xref="S2.p3.10.m10.2.2.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p3.10.m10.2.2.2.2.2.3.1" xref="S2.p3.10.m10.2.2.2.2.2.3.1.cmml">​</mo><mi id="S2.p3.10.m10.2.2.2.2.2.3.3" xref="S2.p3.10.m10.2.2.2.2.2.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="S2.p3.10.m10.2.2.2.2.5" xref="S2.p3.10.m10.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.10.m10.2b"><apply id="S2.p3.10.m10.2.2.cmml" xref="S2.p3.10.m10.2.2"><eq id="S2.p3.10.m10.2.2.3.cmml" xref="S2.p3.10.m10.2.2.3"></eq><ci id="S2.p3.10.m10.2.2.4.cmml" xref="S2.p3.10.m10.2.2.4">𝝍</ci><set id="S2.p3.10.m10.2.2.2.3.cmml" xref="S2.p3.10.m10.2.2.2.2"><apply id="S2.p3.10.m10.1.1.1.1.1.cmml" xref="S2.p3.10.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.10.m10.1.1.1.1.1.1.cmml" xref="S2.p3.10.m10.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.10.m10.1.1.1.1.1.2.cmml" xref="S2.p3.10.m10.1.1.1.1.1.2">𝛾</ci><apply id="S2.p3.10.m10.1.1.1.1.1.3.cmml" xref="S2.p3.10.m10.1.1.1.1.1.3"><times id="S2.p3.10.m10.1.1.1.1.1.3.1.cmml" xref="S2.p3.10.m10.1.1.1.1.1.3.1"></times><ci id="S2.p3.10.m10.1.1.1.1.1.3.2.cmml" xref="S2.p3.10.m10.1.1.1.1.1.3.2">𝑖</ci><ci id="S2.p3.10.m10.1.1.1.1.1.3.3.cmml" xref="S2.p3.10.m10.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S2.p3.10.m10.2.2.2.2.2.cmml" xref="S2.p3.10.m10.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p3.10.m10.2.2.2.2.2.1.cmml" xref="S2.p3.10.m10.2.2.2.2.2">subscript</csymbol><ci id="S2.p3.10.m10.2.2.2.2.2.2.cmml" xref="S2.p3.10.m10.2.2.2.2.2.2">𝛽</ci><apply id="S2.p3.10.m10.2.2.2.2.2.3.cmml" xref="S2.p3.10.m10.2.2.2.2.2.3"><times id="S2.p3.10.m10.2.2.2.2.2.3.1.cmml" xref="S2.p3.10.m10.2.2.2.2.2.3.1"></times><ci id="S2.p3.10.m10.2.2.2.2.2.3.2.cmml" xref="S2.p3.10.m10.2.2.2.2.2.3.2">𝑖</ci><ci id="S2.p3.10.m10.2.2.2.2.2.3.3.cmml" xref="S2.p3.10.m10.2.2.2.2.2.3.3">𝑗</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.10.m10.2c">{\bm{\psi}}=\{\gamma_{ij},\beta_{ij}\}</annotation></semantics></math> is learned during fine-tuning.
We add FiLM layers following the middle 3 <math id="S2.p3.11.m11.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S2.p3.11.m11.1a"><mo id="S2.p3.11.m11.1.1" xref="S2.p3.11.m11.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.p3.11.m11.1b"><times id="S2.p3.11.m11.1.1.cmml" xref="S2.p3.11.m11.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.11.m11.1c">\times</annotation></semantics></math> 3 convolutional layer in each ResNetV2 <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a href="#bib.bib18" title="" class="ltx_ref">2016b</a>)</cite> block and also one at the end of the backbone prior to the head.
<a href="#A1.F1.sf1" title="In Figure A.1 ‣ A.1 FiLM Layer Placement ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1(a)</span></a> illustrates a FiLM layer operating on a convolutional layer, and <a href="#A1.F1.sf2" title="In Figure A.1 ‣ A.1 FiLM Layer Placement ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1(b)</span></a> illustrates how a FiLM layer can be added to a ResNetV2 network block.
FiLM layers can be similarly added to other backbones.
An advantage of FiLM layers is that they enable expressive feature adaptation while adding only a small number of parameters <cite class="ltx_cite ltx_citemacro_citep">(Perez et al., <a href="#bib.bib45" title="" class="ltx_ref">2018</a>)</cite>.
For example, in a ResNet50 with a FiLM layer in every block, the set of FiLM parameters <math id="S2.p3.12.m12.1" class="ltx_Math" alttext="{\bm{\psi}}" display="inline"><semantics id="S2.p3.12.m12.1a"><mi id="S2.p3.12.m12.1.1" xref="S2.p3.12.m12.1.1.cmml">𝝍</mi><annotation-xml encoding="MathML-Content" id="S2.p3.12.m12.1b"><ci id="S2.p3.12.m12.1.1.cmml" xref="S2.p3.12.m12.1.1">𝝍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.12.m12.1c">{\bm{\psi}}</annotation></semantics></math> account for only 11648 parameters which is fewer than 0.05% of the parameters in <math id="S2.p3.13.m13.1" class="ltx_Math" alttext="b_{\bm{\theta}}" display="inline"><semantics id="S2.p3.13.m13.1a"><msub id="S2.p3.13.m13.1.1" xref="S2.p3.13.m13.1.1.cmml"><mi id="S2.p3.13.m13.1.1.2" xref="S2.p3.13.m13.1.1.2.cmml">b</mi><mi id="S2.p3.13.m13.1.1.3" xref="S2.p3.13.m13.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.13.m13.1b"><apply id="S2.p3.13.m13.1.1.cmml" xref="S2.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S2.p3.13.m13.1.1.1.cmml" xref="S2.p3.13.m13.1.1">subscript</csymbol><ci id="S2.p3.13.m13.1.1.2.cmml" xref="S2.p3.13.m13.1.1.2">𝑏</ci><ci id="S2.p3.13.m13.1.1.3.cmml" xref="S2.p3.13.m13.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.13.m13.1c">b_{\bm{\theta}}</annotation></semantics></math>.
We show in <a href="#S4" title="4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a> that FiLM layers allow the model to adapt to a broad class of datasets.
<a href="#A1.F2.sf1" title="In Figure A.2 ‣ A.7 FiLM Layer Parameter Variation ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(a)</span></a> and <a href="#A1.F2.sf2" title="In Figure A.2 ‣ A.7 FiLM Layer Parameter Variation ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(b)</span></a> show the magnitude of the FiLM parameters as a function of layer for FiT-LDA on CIFAR100 and SHVN, respectively. Refer to <a href="#A1.SS7" title="A.7 FiLM Layer Parameter Variation ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.7</span></a> for additional detail.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FiT<span id="S2.p4.1.1.1" class="ltx_text ltx_font_upright"> Head</span></span>
For the head of the network, we use a specially tailored Gaussian Naive Bayes classifier.
Unlike a linear head, this head can be automatically configured directly from data and has only a small number of free parameters which must be learned, ideal for few-shot, personalization and federated learning. We will also show that this head is often more accurate than a standard linear head.
The class probability for a test point <math id="S2.p4.1.m1.1" class="ltx_Math" alttext="{\bm{x}}^{*}" display="inline"><semantics id="S2.p4.1.m1.1a"><msup id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml"><mi id="S2.p4.1.m1.1.1.2" xref="S2.p4.1.m1.1.1.2.cmml">𝒙</mi><mo id="S2.p4.1.m1.1.1.3" xref="S2.p4.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p4.1.m1.1.1.1.cmml" xref="S2.p4.1.m1.1.1">superscript</csymbol><ci id="S2.p4.1.m1.1.1.2.cmml" xref="S2.p4.1.m1.1.1.2">𝒙</ci><times id="S2.p4.1.m1.1.1.3.cmml" xref="S2.p4.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">{\bm{x}}^{*}</annotation></semantics></math> is:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.11" class="ltx_math_unparsed" alttext="p(y^{*}=c|b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*}),{\bm{\pi}},{\bm{\mu}},{\bm{\Sigma}})=\dfrac{\pi_{c}\mathcal{N}(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})|\mu_{c},\Sigma_{c}))}{\sum_{c^{\prime}}^{C}\pi_{c^{\prime}}\mathcal{N}(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})|\mu_{c^{\prime}},\Sigma_{c^{\prime}})}" display="block"><semantics id="S2.E1.m1.11a"><mrow id="S2.E1.m1.11.11"><mrow id="S2.E1.m1.11.11.1"><mi id="S2.E1.m1.11.11.1.3">p</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.11.11.1.2">​</mo><mrow id="S2.E1.m1.11.11.1.1.1"><mo stretchy="false" id="S2.E1.m1.11.11.1.1.1.2">(</mo><mrow id="S2.E1.m1.11.11.1.1.1.1"><msup id="S2.E1.m1.11.11.1.1.1.1.3"><mi id="S2.E1.m1.11.11.1.1.1.1.3.2">y</mi><mo id="S2.E1.m1.11.11.1.1.1.1.3.3">∗</mo></msup><mo id="S2.E1.m1.11.11.1.1.1.1.2">=</mo><mrow id="S2.E1.m1.11.11.1.1.1.1.1"><mi id="S2.E1.m1.11.11.1.1.1.1.1.3">c</mi><mo fence="false" id="S2.E1.m1.11.11.1.1.1.1.1.2">|</mo><mrow id="S2.E1.m1.11.11.1.1.1.1.1.1.1"><mrow id="S2.E1.m1.11.11.1.1.1.1.1.1.1.1"><msub id="S2.E1.m1.11.11.1.1.1.1.1.1.1.1.3"><mi id="S2.E1.m1.11.11.1.1.1.1.1.1.1.1.3.2">b</mi><mrow id="S2.E1.m1.2.2.2.4"><mi id="S2.E1.m1.1.1.1.1">𝜽</mi><mo id="S2.E1.m1.2.2.2.4.1">,</mo><mi id="S2.E1.m1.2.2.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.11.11.1.1.1.1.1.1.1.1.2">​</mo><mrow id="S2.E1.m1.11.11.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S2.E1.m1.11.11.1.1.1.1.1.1.1.1.1.1.2">(</mo><msup id="S2.E1.m1.11.11.1.1.1.1.1.1.1.1.1.1.1"><mi id="S2.E1.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</mi><mo id="S2.E1.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.3">∗</mo></msup><mo stretchy="false" id="S2.E1.m1.11.11.1.1.1.1.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo id="S2.E1.m1.11.11.1.1.1.1.1.1.1.2">,</mo><mi id="S2.E1.m1.8.8">𝝅</mi><mo id="S2.E1.m1.11.11.1.1.1.1.1.1.1.3">,</mo><mi id="S2.E1.m1.9.9">𝝁</mi><mo id="S2.E1.m1.11.11.1.1.1.1.1.1.1.4">,</mo><mi id="S2.E1.m1.10.10">𝚺</mi></mrow></mrow></mrow><mo stretchy="false" id="S2.E1.m1.11.11.1.1.1.3">)</mo></mrow></mrow><mo id="S2.E1.m1.11.11.2">=</mo><mfrac id="S2.E1.m1.7.7"><mrow id="S2.E1.m1.4.4.2"><msub id="S2.E1.m1.4.4.2.3"><mi id="S2.E1.m1.4.4.2.3.2">π</mi><mi id="S2.E1.m1.4.4.2.3.3">c</mi></msub><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.4.4.2.4">𝒩</mi><mrow id="S2.E1.m1.4.4.2.5"><mo stretchy="false" id="S2.E1.m1.4.4.2.5.1">(</mo><msub id="S2.E1.m1.4.4.2.5.2"><mi id="S2.E1.m1.4.4.2.5.2.2">b</mi><mrow id="S2.E1.m1.4.4.2.2.2.4"><mi id="S2.E1.m1.3.3.1.1.1.1">𝜽</mi><mo id="S2.E1.m1.4.4.2.2.2.4.1">,</mo><mi id="S2.E1.m1.4.4.2.2.2.2">𝝍</mi></mrow></msub><mrow id="S2.E1.m1.4.4.2.5.3"><mo stretchy="false" id="S2.E1.m1.4.4.2.5.3.1">(</mo><msup id="S2.E1.m1.4.4.2.5.3.2"><mi id="S2.E1.m1.4.4.2.5.3.2.2">𝒙</mi><mo id="S2.E1.m1.4.4.2.5.3.2.3">∗</mo></msup><mo stretchy="false" id="S2.E1.m1.4.4.2.5.3.3">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E1.m1.4.4.2.5.4">|</mo><msub id="S2.E1.m1.4.4.2.5.5"><mi id="S2.E1.m1.4.4.2.5.5.2">μ</mi><mi id="S2.E1.m1.4.4.2.5.5.3">c</mi></msub><mo id="S2.E1.m1.4.4.2.5.6">,</mo><msub id="S2.E1.m1.4.4.2.5.7"><mi mathvariant="normal" id="S2.E1.m1.4.4.2.5.7.2">Σ</mi><mi id="S2.E1.m1.4.4.2.5.7.3">c</mi></msub><mo stretchy="false" id="S2.E1.m1.4.4.2.5.8">)</mo></mrow><mo stretchy="false" id="S2.E1.m1.4.4.2.6">)</mo></mrow><mrow id="S2.E1.m1.7.7.5"><msubsup id="S2.E1.m1.7.7.5.4"><mo id="S2.E1.m1.7.7.5.4.2.2">∑</mo><msup id="S2.E1.m1.7.7.5.4.2.3"><mi id="S2.E1.m1.7.7.5.4.2.3.2">c</mi><mo id="S2.E1.m1.7.7.5.4.2.3.3">′</mo></msup><mi id="S2.E1.m1.7.7.5.4.3">C</mi></msubsup><mrow id="S2.E1.m1.7.7.5.3"><msub id="S2.E1.m1.7.7.5.3.3"><mi id="S2.E1.m1.7.7.5.3.3.2">π</mi><msup id="S2.E1.m1.7.7.5.3.3.3"><mi id="S2.E1.m1.7.7.5.3.3.3.2">c</mi><mo id="S2.E1.m1.7.7.5.3.3.3.3">′</mo></msup></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.5.3.2">​</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.7.7.5.3.4">𝒩</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.5.3.2a">​</mo><mrow id="S2.E1.m1.7.7.5.3.1.1"><mo stretchy="false" id="S2.E1.m1.7.7.5.3.1.1.2">(</mo><mrow id="S2.E1.m1.7.7.5.3.1.1.1"><mrow id="S2.E1.m1.7.7.5.3.1.1.1.1"><msub id="S2.E1.m1.7.7.5.3.1.1.1.1.3"><mi id="S2.E1.m1.7.7.5.3.1.1.1.1.3.2">b</mi><mrow id="S2.E1.m1.6.6.4.2.2.4"><mi id="S2.E1.m1.5.5.3.1.1.1">𝜽</mi><mo id="S2.E1.m1.6.6.4.2.2.4.1">,</mo><mi id="S2.E1.m1.6.6.4.2.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.5.3.1.1.1.1.2">​</mo><mrow id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1"><mo stretchy="false" id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.2">(</mo><msup id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1"><mi id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.2">𝒙</mi><mo id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.3">∗</mo></msup><mo stretchy="false" id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo fence="false" id="S2.E1.m1.7.7.5.3.1.1.1.4">|</mo><mrow id="S2.E1.m1.7.7.5.3.1.1.1.3.2"><msub id="S2.E1.m1.7.7.5.3.1.1.1.2.1.1"><mi id="S2.E1.m1.7.7.5.3.1.1.1.2.1.1.2">μ</mi><msup id="S2.E1.m1.7.7.5.3.1.1.1.2.1.1.3"><mi id="S2.E1.m1.7.7.5.3.1.1.1.2.1.1.3.2">c</mi><mo id="S2.E1.m1.7.7.5.3.1.1.1.2.1.1.3.3">′</mo></msup></msub><mo id="S2.E1.m1.7.7.5.3.1.1.1.3.2.3">,</mo><msub id="S2.E1.m1.7.7.5.3.1.1.1.3.2.2"><mi mathvariant="normal" id="S2.E1.m1.7.7.5.3.1.1.1.3.2.2.2">Σ</mi><msup id="S2.E1.m1.7.7.5.3.1.1.1.3.2.2.3"><mi id="S2.E1.m1.7.7.5.3.1.1.1.3.2.2.3.2">c</mi><mo id="S2.E1.m1.7.7.5.3.1.1.1.3.2.2.3.3">′</mo></msup></msub></mrow></mrow><mo stretchy="false" id="S2.E1.m1.7.7.5.3.1.1.3">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex" id="S2.E1.m1.11b">p(y^{*}=c|b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*}),{\bm{\pi}},{\bm{\mu}},{\bm{\Sigma}})=\dfrac{\pi_{c}\mathcal{N}(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})|\mu_{c},\Sigma_{c}))}{\sum_{c^{\prime}}^{C}\pi_{c^{\prime}}\mathcal{N}(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})|\mu_{c^{\prime}},\Sigma_{c^{\prime}})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p4.4" class="ltx_p">where
<math id="S2.p4.2.m1.1" class="ltx_Math" alttext="\pi_{c}=\dfrac{N_{c}}{N}" display="inline"><semantics id="S2.p4.2.m1.1a"><mrow id="S2.p4.2.m1.1.1" xref="S2.p4.2.m1.1.1.cmml"><msub id="S2.p4.2.m1.1.1.2" xref="S2.p4.2.m1.1.1.2.cmml"><mi id="S2.p4.2.m1.1.1.2.2" xref="S2.p4.2.m1.1.1.2.2.cmml">π</mi><mi id="S2.p4.2.m1.1.1.2.3" xref="S2.p4.2.m1.1.1.2.3.cmml">c</mi></msub><mo id="S2.p4.2.m1.1.1.1" xref="S2.p4.2.m1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S2.p4.2.m1.1.1.3" xref="S2.p4.2.m1.1.1.3.cmml"><mfrac id="S2.p4.2.m1.1.1.3a" xref="S2.p4.2.m1.1.1.3.cmml"><msub id="S2.p4.2.m1.1.1.3.2" xref="S2.p4.2.m1.1.1.3.2.cmml"><mi id="S2.p4.2.m1.1.1.3.2.2" xref="S2.p4.2.m1.1.1.3.2.2.cmml">N</mi><mi id="S2.p4.2.m1.1.1.3.2.3" xref="S2.p4.2.m1.1.1.3.2.3.cmml">c</mi></msub><mi id="S2.p4.2.m1.1.1.3.3" xref="S2.p4.2.m1.1.1.3.3.cmml">N</mi></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.2.m1.1b"><apply id="S2.p4.2.m1.1.1.cmml" xref="S2.p4.2.m1.1.1"><eq id="S2.p4.2.m1.1.1.1.cmml" xref="S2.p4.2.m1.1.1.1"></eq><apply id="S2.p4.2.m1.1.1.2.cmml" xref="S2.p4.2.m1.1.1.2"><csymbol cd="ambiguous" id="S2.p4.2.m1.1.1.2.1.cmml" xref="S2.p4.2.m1.1.1.2">subscript</csymbol><ci id="S2.p4.2.m1.1.1.2.2.cmml" xref="S2.p4.2.m1.1.1.2.2">𝜋</ci><ci id="S2.p4.2.m1.1.1.2.3.cmml" xref="S2.p4.2.m1.1.1.2.3">𝑐</ci></apply><apply id="S2.p4.2.m1.1.1.3.cmml" xref="S2.p4.2.m1.1.1.3"><divide id="S2.p4.2.m1.1.1.3.1.cmml" xref="S2.p4.2.m1.1.1.3"></divide><apply id="S2.p4.2.m1.1.1.3.2.cmml" xref="S2.p4.2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.p4.2.m1.1.1.3.2.1.cmml" xref="S2.p4.2.m1.1.1.3.2">subscript</csymbol><ci id="S2.p4.2.m1.1.1.3.2.2.cmml" xref="S2.p4.2.m1.1.1.3.2.2">𝑁</ci><ci id="S2.p4.2.m1.1.1.3.2.3.cmml" xref="S2.p4.2.m1.1.1.3.2.3">𝑐</ci></apply><ci id="S2.p4.2.m1.1.1.3.3.cmml" xref="S2.p4.2.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m1.1c">\pi_{c}=\dfrac{N_{c}}{N}</annotation></semantics></math>, <math id="S2.p4.3.m2.3" class="ltx_Math" alttext="\mu_{c}=\dfrac{1}{N_{c}}\sum_{i=1}^{N_{c}}b_{{\bm{\theta}},{\bm{\psi}}}\left({\bm{x}}_{i}\right)" display="inline"><semantics id="S2.p4.3.m2.3a"><mrow id="S2.p4.3.m2.3.3" xref="S2.p4.3.m2.3.3.cmml"><msub id="S2.p4.3.m2.3.3.3" xref="S2.p4.3.m2.3.3.3.cmml"><mi id="S2.p4.3.m2.3.3.3.2" xref="S2.p4.3.m2.3.3.3.2.cmml">μ</mi><mi id="S2.p4.3.m2.3.3.3.3" xref="S2.p4.3.m2.3.3.3.3.cmml">c</mi></msub><mo id="S2.p4.3.m2.3.3.2" xref="S2.p4.3.m2.3.3.2.cmml">=</mo><mrow id="S2.p4.3.m2.3.3.1" xref="S2.p4.3.m2.3.3.1.cmml"><mstyle displaystyle="true" id="S2.p4.3.m2.3.3.1.3" xref="S2.p4.3.m2.3.3.1.3.cmml"><mfrac id="S2.p4.3.m2.3.3.1.3a" xref="S2.p4.3.m2.3.3.1.3.cmml"><mn id="S2.p4.3.m2.3.3.1.3.2" xref="S2.p4.3.m2.3.3.1.3.2.cmml">1</mn><msub id="S2.p4.3.m2.3.3.1.3.3" xref="S2.p4.3.m2.3.3.1.3.3.cmml"><mi id="S2.p4.3.m2.3.3.1.3.3.2" xref="S2.p4.3.m2.3.3.1.3.3.2.cmml">N</mi><mi id="S2.p4.3.m2.3.3.1.3.3.3" xref="S2.p4.3.m2.3.3.1.3.3.3.cmml">c</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.p4.3.m2.3.3.1.2" xref="S2.p4.3.m2.3.3.1.2.cmml">​</mo><mrow id="S2.p4.3.m2.3.3.1.1" xref="S2.p4.3.m2.3.3.1.1.cmml"><msubsup id="S2.p4.3.m2.3.3.1.1.2" xref="S2.p4.3.m2.3.3.1.1.2.cmml"><mo id="S2.p4.3.m2.3.3.1.1.2.2.2" xref="S2.p4.3.m2.3.3.1.1.2.2.2.cmml">∑</mo><mrow id="S2.p4.3.m2.3.3.1.1.2.2.3" xref="S2.p4.3.m2.3.3.1.1.2.2.3.cmml"><mi id="S2.p4.3.m2.3.3.1.1.2.2.3.2" xref="S2.p4.3.m2.3.3.1.1.2.2.3.2.cmml">i</mi><mo id="S2.p4.3.m2.3.3.1.1.2.2.3.1" xref="S2.p4.3.m2.3.3.1.1.2.2.3.1.cmml">=</mo><mn id="S2.p4.3.m2.3.3.1.1.2.2.3.3" xref="S2.p4.3.m2.3.3.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S2.p4.3.m2.3.3.1.1.2.3" xref="S2.p4.3.m2.3.3.1.1.2.3.cmml"><mi id="S2.p4.3.m2.3.3.1.1.2.3.2" xref="S2.p4.3.m2.3.3.1.1.2.3.2.cmml">N</mi><mi id="S2.p4.3.m2.3.3.1.1.2.3.3" xref="S2.p4.3.m2.3.3.1.1.2.3.3.cmml">c</mi></msub></msubsup><mrow id="S2.p4.3.m2.3.3.1.1.1" xref="S2.p4.3.m2.3.3.1.1.1.cmml"><msub id="S2.p4.3.m2.3.3.1.1.1.3" xref="S2.p4.3.m2.3.3.1.1.1.3.cmml"><mi id="S2.p4.3.m2.3.3.1.1.1.3.2" xref="S2.p4.3.m2.3.3.1.1.1.3.2.cmml">b</mi><mrow id="S2.p4.3.m2.2.2.2.4" xref="S2.p4.3.m2.2.2.2.3.cmml"><mi id="S2.p4.3.m2.1.1.1.1" xref="S2.p4.3.m2.1.1.1.1.cmml">𝜽</mi><mo id="S2.p4.3.m2.2.2.2.4.1" xref="S2.p4.3.m2.2.2.2.3.cmml">,</mo><mi id="S2.p4.3.m2.2.2.2.2" xref="S2.p4.3.m2.2.2.2.2.cmml">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.p4.3.m2.3.3.1.1.1.2" xref="S2.p4.3.m2.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.p4.3.m2.3.3.1.1.1.1.1" xref="S2.p4.3.m2.3.3.1.1.1.1.1.1.cmml"><mo id="S2.p4.3.m2.3.3.1.1.1.1.1.2" xref="S2.p4.3.m2.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S2.p4.3.m2.3.3.1.1.1.1.1.1" xref="S2.p4.3.m2.3.3.1.1.1.1.1.1.cmml"><mi id="S2.p4.3.m2.3.3.1.1.1.1.1.1.2" xref="S2.p4.3.m2.3.3.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.p4.3.m2.3.3.1.1.1.1.1.1.3" xref="S2.p4.3.m2.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p4.3.m2.3.3.1.1.1.1.1.3" xref="S2.p4.3.m2.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.3.m2.3b"><apply id="S2.p4.3.m2.3.3.cmml" xref="S2.p4.3.m2.3.3"><eq id="S2.p4.3.m2.3.3.2.cmml" xref="S2.p4.3.m2.3.3.2"></eq><apply id="S2.p4.3.m2.3.3.3.cmml" xref="S2.p4.3.m2.3.3.3"><csymbol cd="ambiguous" id="S2.p4.3.m2.3.3.3.1.cmml" xref="S2.p4.3.m2.3.3.3">subscript</csymbol><ci id="S2.p4.3.m2.3.3.3.2.cmml" xref="S2.p4.3.m2.3.3.3.2">𝜇</ci><ci id="S2.p4.3.m2.3.3.3.3.cmml" xref="S2.p4.3.m2.3.3.3.3">𝑐</ci></apply><apply id="S2.p4.3.m2.3.3.1.cmml" xref="S2.p4.3.m2.3.3.1"><times id="S2.p4.3.m2.3.3.1.2.cmml" xref="S2.p4.3.m2.3.3.1.2"></times><apply id="S2.p4.3.m2.3.3.1.3.cmml" xref="S2.p4.3.m2.3.3.1.3"><divide id="S2.p4.3.m2.3.3.1.3.1.cmml" xref="S2.p4.3.m2.3.3.1.3"></divide><cn type="integer" id="S2.p4.3.m2.3.3.1.3.2.cmml" xref="S2.p4.3.m2.3.3.1.3.2">1</cn><apply id="S2.p4.3.m2.3.3.1.3.3.cmml" xref="S2.p4.3.m2.3.3.1.3.3"><csymbol cd="ambiguous" id="S2.p4.3.m2.3.3.1.3.3.1.cmml" xref="S2.p4.3.m2.3.3.1.3.3">subscript</csymbol><ci id="S2.p4.3.m2.3.3.1.3.3.2.cmml" xref="S2.p4.3.m2.3.3.1.3.3.2">𝑁</ci><ci id="S2.p4.3.m2.3.3.1.3.3.3.cmml" xref="S2.p4.3.m2.3.3.1.3.3.3">𝑐</ci></apply></apply><apply id="S2.p4.3.m2.3.3.1.1.cmml" xref="S2.p4.3.m2.3.3.1.1"><apply id="S2.p4.3.m2.3.3.1.1.2.cmml" xref="S2.p4.3.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.p4.3.m2.3.3.1.1.2.1.cmml" xref="S2.p4.3.m2.3.3.1.1.2">superscript</csymbol><apply id="S2.p4.3.m2.3.3.1.1.2.2.cmml" xref="S2.p4.3.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.p4.3.m2.3.3.1.1.2.2.1.cmml" xref="S2.p4.3.m2.3.3.1.1.2">subscript</csymbol><sum id="S2.p4.3.m2.3.3.1.1.2.2.2.cmml" xref="S2.p4.3.m2.3.3.1.1.2.2.2"></sum><apply id="S2.p4.3.m2.3.3.1.1.2.2.3.cmml" xref="S2.p4.3.m2.3.3.1.1.2.2.3"><eq id="S2.p4.3.m2.3.3.1.1.2.2.3.1.cmml" xref="S2.p4.3.m2.3.3.1.1.2.2.3.1"></eq><ci id="S2.p4.3.m2.3.3.1.1.2.2.3.2.cmml" xref="S2.p4.3.m2.3.3.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.p4.3.m2.3.3.1.1.2.2.3.3.cmml" xref="S2.p4.3.m2.3.3.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.p4.3.m2.3.3.1.1.2.3.cmml" xref="S2.p4.3.m2.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S2.p4.3.m2.3.3.1.1.2.3.1.cmml" xref="S2.p4.3.m2.3.3.1.1.2.3">subscript</csymbol><ci id="S2.p4.3.m2.3.3.1.1.2.3.2.cmml" xref="S2.p4.3.m2.3.3.1.1.2.3.2">𝑁</ci><ci id="S2.p4.3.m2.3.3.1.1.2.3.3.cmml" xref="S2.p4.3.m2.3.3.1.1.2.3.3">𝑐</ci></apply></apply><apply id="S2.p4.3.m2.3.3.1.1.1.cmml" xref="S2.p4.3.m2.3.3.1.1.1"><times id="S2.p4.3.m2.3.3.1.1.1.2.cmml" xref="S2.p4.3.m2.3.3.1.1.1.2"></times><apply id="S2.p4.3.m2.3.3.1.1.1.3.cmml" xref="S2.p4.3.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.p4.3.m2.3.3.1.1.1.3.1.cmml" xref="S2.p4.3.m2.3.3.1.1.1.3">subscript</csymbol><ci id="S2.p4.3.m2.3.3.1.1.1.3.2.cmml" xref="S2.p4.3.m2.3.3.1.1.1.3.2">𝑏</ci><list id="S2.p4.3.m2.2.2.2.3.cmml" xref="S2.p4.3.m2.2.2.2.4"><ci id="S2.p4.3.m2.1.1.1.1.cmml" xref="S2.p4.3.m2.1.1.1.1">𝜽</ci><ci id="S2.p4.3.m2.2.2.2.2.cmml" xref="S2.p4.3.m2.2.2.2.2">𝝍</ci></list></apply><apply id="S2.p4.3.m2.3.3.1.1.1.1.1.1.cmml" xref="S2.p4.3.m2.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p4.3.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S2.p4.3.m2.3.3.1.1.1.1.1">subscript</csymbol><ci id="S2.p4.3.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S2.p4.3.m2.3.3.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.p4.3.m2.3.3.1.1.1.1.1.1.3.cmml" xref="S2.p4.3.m2.3.3.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m2.3c">\mu_{c}=\dfrac{1}{N_{c}}\sum_{i=1}^{N_{c}}b_{{\bm{\theta}},{\bm{\psi}}}\left({\bm{x}}_{i}\right)</annotation></semantics></math>, <math id="S2.p4.4.m3.6" class="ltx_Math" alttext="\Sigma_{c}=\dfrac{1}{N_{c}}\sum_{i=1}^{N_{c}}(b_{{\bm{\theta}},{\bm{\psi}}}\left({\bm{x}}_{i}\right)-\mu_{c})(b_{{\bm{\theta}},{\bm{\psi}}}\left({\bm{x}}_{i}\right)-\mu_{c})^{T}" display="inline"><semantics id="S2.p4.4.m3.6a"><mrow id="S2.p4.4.m3.6.6" xref="S2.p4.4.m3.6.6.cmml"><msub id="S2.p4.4.m3.6.6.4" xref="S2.p4.4.m3.6.6.4.cmml"><mi mathvariant="normal" id="S2.p4.4.m3.6.6.4.2" xref="S2.p4.4.m3.6.6.4.2.cmml">Σ</mi><mi id="S2.p4.4.m3.6.6.4.3" xref="S2.p4.4.m3.6.6.4.3.cmml">c</mi></msub><mo id="S2.p4.4.m3.6.6.3" xref="S2.p4.4.m3.6.6.3.cmml">=</mo><mrow id="S2.p4.4.m3.6.6.2" xref="S2.p4.4.m3.6.6.2.cmml"><mstyle displaystyle="true" id="S2.p4.4.m3.6.6.2.4" xref="S2.p4.4.m3.6.6.2.4.cmml"><mfrac id="S2.p4.4.m3.6.6.2.4a" xref="S2.p4.4.m3.6.6.2.4.cmml"><mn id="S2.p4.4.m3.6.6.2.4.2" xref="S2.p4.4.m3.6.6.2.4.2.cmml">1</mn><msub id="S2.p4.4.m3.6.6.2.4.3" xref="S2.p4.4.m3.6.6.2.4.3.cmml"><mi id="S2.p4.4.m3.6.6.2.4.3.2" xref="S2.p4.4.m3.6.6.2.4.3.2.cmml">N</mi><mi id="S2.p4.4.m3.6.6.2.4.3.3" xref="S2.p4.4.m3.6.6.2.4.3.3.cmml">c</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.p4.4.m3.6.6.2.3" xref="S2.p4.4.m3.6.6.2.3.cmml">​</mo><mrow id="S2.p4.4.m3.6.6.2.2" xref="S2.p4.4.m3.6.6.2.2.cmml"><msubsup id="S2.p4.4.m3.6.6.2.2.3" xref="S2.p4.4.m3.6.6.2.2.3.cmml"><mo rspace="0em" id="S2.p4.4.m3.6.6.2.2.3.2.2" xref="S2.p4.4.m3.6.6.2.2.3.2.2.cmml">∑</mo><mrow id="S2.p4.4.m3.6.6.2.2.3.2.3" xref="S2.p4.4.m3.6.6.2.2.3.2.3.cmml"><mi id="S2.p4.4.m3.6.6.2.2.3.2.3.2" xref="S2.p4.4.m3.6.6.2.2.3.2.3.2.cmml">i</mi><mo id="S2.p4.4.m3.6.6.2.2.3.2.3.1" xref="S2.p4.4.m3.6.6.2.2.3.2.3.1.cmml">=</mo><mn id="S2.p4.4.m3.6.6.2.2.3.2.3.3" xref="S2.p4.4.m3.6.6.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S2.p4.4.m3.6.6.2.2.3.3" xref="S2.p4.4.m3.6.6.2.2.3.3.cmml"><mi id="S2.p4.4.m3.6.6.2.2.3.3.2" xref="S2.p4.4.m3.6.6.2.2.3.3.2.cmml">N</mi><mi id="S2.p4.4.m3.6.6.2.2.3.3.3" xref="S2.p4.4.m3.6.6.2.2.3.3.3.cmml">c</mi></msub></msubsup><mrow id="S2.p4.4.m3.6.6.2.2.2" xref="S2.p4.4.m3.6.6.2.2.2.cmml"><mrow id="S2.p4.4.m3.5.5.1.1.1.1.1" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.p4.4.m3.5.5.1.1.1.1.1.2" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p4.4.m3.5.5.1.1.1.1.1.1" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.cmml"><mrow id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.cmml"><msub id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.3" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.3.2" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.3.2.cmml">b</mi><mrow id="S2.p4.4.m3.2.2.2.4" xref="S2.p4.4.m3.2.2.2.3.cmml"><mi id="S2.p4.4.m3.1.1.1.1" xref="S2.p4.4.m3.1.1.1.1.cmml">𝜽</mi><mo id="S2.p4.4.m3.2.2.2.4.1" xref="S2.p4.4.m3.2.2.2.3.cmml">,</mo><mi id="S2.p4.4.m3.2.2.2.2" xref="S2.p4.4.m3.2.2.2.2.cmml">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.2" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.2" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.3" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.p4.4.m3.5.5.1.1.1.1.1.1.2" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.2.cmml">−</mo><msub id="S2.p4.4.m3.5.5.1.1.1.1.1.1.3" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.3.cmml"><mi id="S2.p4.4.m3.5.5.1.1.1.1.1.1.3.2" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.3.2.cmml">μ</mi><mi id="S2.p4.4.m3.5.5.1.1.1.1.1.1.3.3" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.3.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="S2.p4.4.m3.5.5.1.1.1.1.1.3" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.p4.4.m3.6.6.2.2.2.3" xref="S2.p4.4.m3.6.6.2.2.2.3.cmml">​</mo><msup id="S2.p4.4.m3.6.6.2.2.2.2" xref="S2.p4.4.m3.6.6.2.2.2.2.cmml"><mrow id="S2.p4.4.m3.6.6.2.2.2.2.1.1" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.p4.4.m3.6.6.2.2.2.2.1.1.2" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.cmml"><mrow id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.cmml"><msub id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.3" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.3.cmml"><mi id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.3.2" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.3.2.cmml">b</mi><mrow id="S2.p4.4.m3.4.4.2.4" xref="S2.p4.4.m3.4.4.2.3.cmml"><mi id="S2.p4.4.m3.3.3.1.1" xref="S2.p4.4.m3.3.3.1.1.cmml">𝜽</mi><mo id="S2.p4.4.m3.4.4.2.4.1" xref="S2.p4.4.m3.4.4.2.3.cmml">,</mo><mi id="S2.p4.4.m3.4.4.2.2" xref="S2.p4.4.m3.4.4.2.2.cmml">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.2" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.2" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.2" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.3" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.3" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.2" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.2.cmml">−</mo><msub id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3.cmml"><mi id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3.2" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3.2.cmml">μ</mi><mi id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3.3" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="S2.p4.4.m3.6.6.2.2.2.2.1.1.3" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S2.p4.4.m3.6.6.2.2.2.2.3" xref="S2.p4.4.m3.6.6.2.2.2.2.3.cmml">T</mi></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.4.m3.6b"><apply id="S2.p4.4.m3.6.6.cmml" xref="S2.p4.4.m3.6.6"><eq id="S2.p4.4.m3.6.6.3.cmml" xref="S2.p4.4.m3.6.6.3"></eq><apply id="S2.p4.4.m3.6.6.4.cmml" xref="S2.p4.4.m3.6.6.4"><csymbol cd="ambiguous" id="S2.p4.4.m3.6.6.4.1.cmml" xref="S2.p4.4.m3.6.6.4">subscript</csymbol><ci id="S2.p4.4.m3.6.6.4.2.cmml" xref="S2.p4.4.m3.6.6.4.2">Σ</ci><ci id="S2.p4.4.m3.6.6.4.3.cmml" xref="S2.p4.4.m3.6.6.4.3">𝑐</ci></apply><apply id="S2.p4.4.m3.6.6.2.cmml" xref="S2.p4.4.m3.6.6.2"><times id="S2.p4.4.m3.6.6.2.3.cmml" xref="S2.p4.4.m3.6.6.2.3"></times><apply id="S2.p4.4.m3.6.6.2.4.cmml" xref="S2.p4.4.m3.6.6.2.4"><divide id="S2.p4.4.m3.6.6.2.4.1.cmml" xref="S2.p4.4.m3.6.6.2.4"></divide><cn type="integer" id="S2.p4.4.m3.6.6.2.4.2.cmml" xref="S2.p4.4.m3.6.6.2.4.2">1</cn><apply id="S2.p4.4.m3.6.6.2.4.3.cmml" xref="S2.p4.4.m3.6.6.2.4.3"><csymbol cd="ambiguous" id="S2.p4.4.m3.6.6.2.4.3.1.cmml" xref="S2.p4.4.m3.6.6.2.4.3">subscript</csymbol><ci id="S2.p4.4.m3.6.6.2.4.3.2.cmml" xref="S2.p4.4.m3.6.6.2.4.3.2">𝑁</ci><ci id="S2.p4.4.m3.6.6.2.4.3.3.cmml" xref="S2.p4.4.m3.6.6.2.4.3.3">𝑐</ci></apply></apply><apply id="S2.p4.4.m3.6.6.2.2.cmml" xref="S2.p4.4.m3.6.6.2.2"><apply id="S2.p4.4.m3.6.6.2.2.3.cmml" xref="S2.p4.4.m3.6.6.2.2.3"><csymbol cd="ambiguous" id="S2.p4.4.m3.6.6.2.2.3.1.cmml" xref="S2.p4.4.m3.6.6.2.2.3">superscript</csymbol><apply id="S2.p4.4.m3.6.6.2.2.3.2.cmml" xref="S2.p4.4.m3.6.6.2.2.3"><csymbol cd="ambiguous" id="S2.p4.4.m3.6.6.2.2.3.2.1.cmml" xref="S2.p4.4.m3.6.6.2.2.3">subscript</csymbol><sum id="S2.p4.4.m3.6.6.2.2.3.2.2.cmml" xref="S2.p4.4.m3.6.6.2.2.3.2.2"></sum><apply id="S2.p4.4.m3.6.6.2.2.3.2.3.cmml" xref="S2.p4.4.m3.6.6.2.2.3.2.3"><eq id="S2.p4.4.m3.6.6.2.2.3.2.3.1.cmml" xref="S2.p4.4.m3.6.6.2.2.3.2.3.1"></eq><ci id="S2.p4.4.m3.6.6.2.2.3.2.3.2.cmml" xref="S2.p4.4.m3.6.6.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S2.p4.4.m3.6.6.2.2.3.2.3.3.cmml" xref="S2.p4.4.m3.6.6.2.2.3.2.3.3">1</cn></apply></apply><apply id="S2.p4.4.m3.6.6.2.2.3.3.cmml" xref="S2.p4.4.m3.6.6.2.2.3.3"><csymbol cd="ambiguous" id="S2.p4.4.m3.6.6.2.2.3.3.1.cmml" xref="S2.p4.4.m3.6.6.2.2.3.3">subscript</csymbol><ci id="S2.p4.4.m3.6.6.2.2.3.3.2.cmml" xref="S2.p4.4.m3.6.6.2.2.3.3.2">𝑁</ci><ci id="S2.p4.4.m3.6.6.2.2.3.3.3.cmml" xref="S2.p4.4.m3.6.6.2.2.3.3.3">𝑐</ci></apply></apply><apply id="S2.p4.4.m3.6.6.2.2.2.cmml" xref="S2.p4.4.m3.6.6.2.2.2"><times id="S2.p4.4.m3.6.6.2.2.2.3.cmml" xref="S2.p4.4.m3.6.6.2.2.2.3"></times><apply id="S2.p4.4.m3.5.5.1.1.1.1.1.1.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1"><minus id="S2.p4.4.m3.5.5.1.1.1.1.1.1.2.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.2"></minus><apply id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1"><times id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.2.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.2"></times><apply id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.3.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.3.2">𝑏</ci><list id="S2.p4.4.m3.2.2.2.3.cmml" xref="S2.p4.4.m3.2.2.2.4"><ci id="S2.p4.4.m3.1.1.1.1.cmml" xref="S2.p4.4.m3.1.1.1.1">𝜽</ci><ci id="S2.p4.4.m3.2.2.2.2.cmml" xref="S2.p4.4.m3.2.2.2.2">𝝍</ci></list></apply><apply id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.p4.4.m3.5.5.1.1.1.1.1.1.3.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p4.4.m3.5.5.1.1.1.1.1.1.3.1.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p4.4.m3.5.5.1.1.1.1.1.1.3.2.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.3.2">𝜇</ci><ci id="S2.p4.4.m3.5.5.1.1.1.1.1.1.3.3.cmml" xref="S2.p4.4.m3.5.5.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply><apply id="S2.p4.4.m3.6.6.2.2.2.2.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S2.p4.4.m3.6.6.2.2.2.2.2.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2">superscript</csymbol><apply id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1"><minus id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.2.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.2"></minus><apply id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1"><times id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.2.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.2"></times><apply id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.3.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.3.1.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.3.2.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.3.2">𝑏</ci><list id="S2.p4.4.m3.4.4.2.3.cmml" xref="S2.p4.4.m3.4.4.2.4"><ci id="S2.p4.4.m3.3.3.1.1.cmml" xref="S2.p4.4.m3.3.3.1.1">𝜽</ci><ci id="S2.p4.4.m3.4.4.2.2.cmml" xref="S2.p4.4.m3.4.4.2.2">𝝍</ci></list></apply><apply id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3.1.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3.2.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3.2">𝜇</ci><ci id="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3.3.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.1.1.1.3.3">𝑐</ci></apply></apply><ci id="S2.p4.4.m3.6.6.2.2.2.2.3.cmml" xref="S2.p4.4.m3.6.6.2.2.2.2.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.m3.6c">\Sigma_{c}=\dfrac{1}{N_{c}}\sum_{i=1}^{N_{c}}(b_{{\bm{\theta}},{\bm{\psi}}}\left({\bm{x}}_{i}\right)-\mu_{c})(b_{{\bm{\theta}},{\bm{\psi}}}\left({\bm{x}}_{i}\right)-\mu_{c})^{T}</annotation></semantics></math></p>
</div>
<div id="S2.p5" class="ltx_para ltx_noindent">
<p id="S2.p5.7" class="ltx_p">are the maximum likelihood estimates, <math id="S2.p5.1.m1.1" class="ltx_Math" alttext="N_{c}" display="inline"><semantics id="S2.p5.1.m1.1a"><msub id="S2.p5.1.m1.1.1" xref="S2.p5.1.m1.1.1.cmml"><mi id="S2.p5.1.m1.1.1.2" xref="S2.p5.1.m1.1.1.2.cmml">N</mi><mi id="S2.p5.1.m1.1.1.3" xref="S2.p5.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.1b"><apply id="S2.p5.1.m1.1.1.cmml" xref="S2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p5.1.m1.1.1.1.cmml" xref="S2.p5.1.m1.1.1">subscript</csymbol><ci id="S2.p5.1.m1.1.1.2.cmml" xref="S2.p5.1.m1.1.1.2">𝑁</ci><ci id="S2.p5.1.m1.1.1.3.cmml" xref="S2.p5.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.1c">N_{c}</annotation></semantics></math> is the number of examples of class <math id="S2.p5.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.p5.2.m2.1a"><mi id="S2.p5.2.m2.1.1" xref="S2.p5.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.p5.2.m2.1b"><ci id="S2.p5.2.m2.1.1.cmml" xref="S2.p5.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.2.m2.1c">c</annotation></semantics></math> in <math id="S2.p5.3.m3.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.p5.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p5.3.m3.1.1" xref="S2.p5.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p5.3.m3.1b"><ci id="S2.p5.3.m3.1.1.cmml" xref="S2.p5.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.3.m3.1c">\mathcal{D}</annotation></semantics></math>, and <math id="S2.p5.4.m4.3" class="ltx_Math" alttext="\mathcal{N}(z|\mu,\Sigma)" display="inline"><semantics id="S2.p5.4.m4.3a"><mrow id="S2.p5.4.m4.3.3" xref="S2.p5.4.m4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p5.4.m4.3.3.3" xref="S2.p5.4.m4.3.3.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S2.p5.4.m4.3.3.2" xref="S2.p5.4.m4.3.3.2.cmml">​</mo><mrow id="S2.p5.4.m4.3.3.1.1" xref="S2.p5.4.m4.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.p5.4.m4.3.3.1.1.2" xref="S2.p5.4.m4.3.3.1.1.1.cmml">(</mo><mrow id="S2.p5.4.m4.3.3.1.1.1" xref="S2.p5.4.m4.3.3.1.1.1.cmml"><mi id="S2.p5.4.m4.3.3.1.1.1.2" xref="S2.p5.4.m4.3.3.1.1.1.2.cmml">z</mi><mo fence="false" id="S2.p5.4.m4.3.3.1.1.1.1" xref="S2.p5.4.m4.3.3.1.1.1.1.cmml">|</mo><mrow id="S2.p5.4.m4.3.3.1.1.1.3.2" xref="S2.p5.4.m4.3.3.1.1.1.3.1.cmml"><mi id="S2.p5.4.m4.1.1" xref="S2.p5.4.m4.1.1.cmml">μ</mi><mo id="S2.p5.4.m4.3.3.1.1.1.3.2.1" xref="S2.p5.4.m4.3.3.1.1.1.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.p5.4.m4.2.2" xref="S2.p5.4.m4.2.2.cmml">Σ</mi></mrow></mrow><mo stretchy="false" id="S2.p5.4.m4.3.3.1.1.3" xref="S2.p5.4.m4.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.4.m4.3b"><apply id="S2.p5.4.m4.3.3.cmml" xref="S2.p5.4.m4.3.3"><times id="S2.p5.4.m4.3.3.2.cmml" xref="S2.p5.4.m4.3.3.2"></times><ci id="S2.p5.4.m4.3.3.3.cmml" xref="S2.p5.4.m4.3.3.3">𝒩</ci><apply id="S2.p5.4.m4.3.3.1.1.1.cmml" xref="S2.p5.4.m4.3.3.1.1"><csymbol cd="latexml" id="S2.p5.4.m4.3.3.1.1.1.1.cmml" xref="S2.p5.4.m4.3.3.1.1.1.1">conditional</csymbol><ci id="S2.p5.4.m4.3.3.1.1.1.2.cmml" xref="S2.p5.4.m4.3.3.1.1.1.2">𝑧</ci><list id="S2.p5.4.m4.3.3.1.1.1.3.1.cmml" xref="S2.p5.4.m4.3.3.1.1.1.3.2"><ci id="S2.p5.4.m4.1.1.cmml" xref="S2.p5.4.m4.1.1">𝜇</ci><ci id="S2.p5.4.m4.2.2.cmml" xref="S2.p5.4.m4.2.2">Σ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.4.m4.3c">\mathcal{N}(z|\mu,\Sigma)</annotation></semantics></math> is a multivariate Gaussian over <math id="S2.p5.5.m5.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S2.p5.5.m5.1a"><mi id="S2.p5.5.m5.1.1" xref="S2.p5.5.m5.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.p5.5.m5.1b"><ci id="S2.p5.5.m5.1.1.cmml" xref="S2.p5.5.m5.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.5.m5.1c">z</annotation></semantics></math> with mean <math id="S2.p5.6.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S2.p5.6.m6.1a"><mi id="S2.p5.6.m6.1.1" xref="S2.p5.6.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S2.p5.6.m6.1b"><ci id="S2.p5.6.m6.1.1.cmml" xref="S2.p5.6.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.6.m6.1c">\mu</annotation></semantics></math> and covariance <math id="S2.p5.7.m7.1" class="ltx_Math" alttext="\Sigma" display="inline"><semantics id="S2.p5.7.m7.1a"><mi mathvariant="normal" id="S2.p5.7.m7.1.1" xref="S2.p5.7.m7.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="S2.p5.7.m7.1b"><ci id="S2.p5.7.m7.1.1.cmml" xref="S2.p5.7.m7.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.7.m7.1c">\Sigma</annotation></semantics></math>.</p>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.9" class="ltx_p">Estimating the mean <math id="S2.p6.1.m1.1" class="ltx_Math" alttext="\mu_{c}" display="inline"><semantics id="S2.p6.1.m1.1a"><msub id="S2.p6.1.m1.1.1" xref="S2.p6.1.m1.1.1.cmml"><mi id="S2.p6.1.m1.1.1.2" xref="S2.p6.1.m1.1.1.2.cmml">μ</mi><mi id="S2.p6.1.m1.1.1.3" xref="S2.p6.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.1b"><apply id="S2.p6.1.m1.1.1.cmml" xref="S2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p6.1.m1.1.1.1.cmml" xref="S2.p6.1.m1.1.1">subscript</csymbol><ci id="S2.p6.1.m1.1.1.2.cmml" xref="S2.p6.1.m1.1.1.2">𝜇</ci><ci id="S2.p6.1.m1.1.1.3.cmml" xref="S2.p6.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.1.m1.1c">\mu_{c}</annotation></semantics></math> for each class <math id="S2.p6.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.p6.2.m2.1a"><mi id="S2.p6.2.m2.1.1" xref="S2.p6.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.p6.2.m2.1b"><ci id="S2.p6.2.m2.1.1.cmml" xref="S2.p6.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.2.m2.1c">c</annotation></semantics></math> is straightforward and incurs a total storage cost of <math id="S2.p6.3.m3.1" class="ltx_Math" alttext="Cd_{b}" display="inline"><semantics id="S2.p6.3.m3.1a"><mrow id="S2.p6.3.m3.1.1" xref="S2.p6.3.m3.1.1.cmml"><mi id="S2.p6.3.m3.1.1.2" xref="S2.p6.3.m3.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.p6.3.m3.1.1.1" xref="S2.p6.3.m3.1.1.1.cmml">​</mo><msub id="S2.p6.3.m3.1.1.3" xref="S2.p6.3.m3.1.1.3.cmml"><mi id="S2.p6.3.m3.1.1.3.2" xref="S2.p6.3.m3.1.1.3.2.cmml">d</mi><mi id="S2.p6.3.m3.1.1.3.3" xref="S2.p6.3.m3.1.1.3.3.cmml">b</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.3.m3.1b"><apply id="S2.p6.3.m3.1.1.cmml" xref="S2.p6.3.m3.1.1"><times id="S2.p6.3.m3.1.1.1.cmml" xref="S2.p6.3.m3.1.1.1"></times><ci id="S2.p6.3.m3.1.1.2.cmml" xref="S2.p6.3.m3.1.1.2">𝐶</ci><apply id="S2.p6.3.m3.1.1.3.cmml" xref="S2.p6.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.p6.3.m3.1.1.3.1.cmml" xref="S2.p6.3.m3.1.1.3">subscript</csymbol><ci id="S2.p6.3.m3.1.1.3.2.cmml" xref="S2.p6.3.m3.1.1.3.2">𝑑</ci><ci id="S2.p6.3.m3.1.1.3.3.cmml" xref="S2.p6.3.m3.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.3.m3.1c">Cd_{b}</annotation></semantics></math>.
However, estimating the covariance <math id="S2.p6.4.m4.1" class="ltx_Math" alttext="\Sigma_{c}" display="inline"><semantics id="S2.p6.4.m4.1a"><msub id="S2.p6.4.m4.1.1" xref="S2.p6.4.m4.1.1.cmml"><mi mathvariant="normal" id="S2.p6.4.m4.1.1.2" xref="S2.p6.4.m4.1.1.2.cmml">Σ</mi><mi id="S2.p6.4.m4.1.1.3" xref="S2.p6.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.4.m4.1b"><apply id="S2.p6.4.m4.1.1.cmml" xref="S2.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p6.4.m4.1.1.1.cmml" xref="S2.p6.4.m4.1.1">subscript</csymbol><ci id="S2.p6.4.m4.1.1.2.cmml" xref="S2.p6.4.m4.1.1.2">Σ</ci><ci id="S2.p6.4.m4.1.1.3.cmml" xref="S2.p6.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.4.m4.1c">\Sigma_{c}</annotation></semantics></math> for each class <math id="S2.p6.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.p6.5.m5.1a"><mi id="S2.p6.5.m5.1.1" xref="S2.p6.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.p6.5.m5.1b"><ci id="S2.p6.5.m5.1.1.cmml" xref="S2.p6.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.5.m5.1c">c</annotation></semantics></math> is challenging when the number of examples per class <math id="S2.p6.6.m6.1" class="ltx_Math" alttext="N_{c}" display="inline"><semantics id="S2.p6.6.m6.1a"><msub id="S2.p6.6.m6.1.1" xref="S2.p6.6.m6.1.1.cmml"><mi id="S2.p6.6.m6.1.1.2" xref="S2.p6.6.m6.1.1.2.cmml">N</mi><mi id="S2.p6.6.m6.1.1.3" xref="S2.p6.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.6.m6.1b"><apply id="S2.p6.6.m6.1.1.cmml" xref="S2.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p6.6.m6.1.1.1.cmml" xref="S2.p6.6.m6.1.1">subscript</csymbol><ci id="S2.p6.6.m6.1.1.2.cmml" xref="S2.p6.6.m6.1.1.2">𝑁</ci><ci id="S2.p6.6.m6.1.1.3.cmml" xref="S2.p6.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.6.m6.1c">N_{c}</annotation></semantics></math> is small and the embedding dimension of the backbone <math id="S2.p6.7.m7.1" class="ltx_Math" alttext="d_{b}" display="inline"><semantics id="S2.p6.7.m7.1a"><msub id="S2.p6.7.m7.1.1" xref="S2.p6.7.m7.1.1.cmml"><mi id="S2.p6.7.m7.1.1.2" xref="S2.p6.7.m7.1.1.2.cmml">d</mi><mi id="S2.p6.7.m7.1.1.3" xref="S2.p6.7.m7.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.7.m7.1b"><apply id="S2.p6.7.m7.1.1.cmml" xref="S2.p6.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p6.7.m7.1.1.1.cmml" xref="S2.p6.7.m7.1.1">subscript</csymbol><ci id="S2.p6.7.m7.1.1.2.cmml" xref="S2.p6.7.m7.1.1.2">𝑑</ci><ci id="S2.p6.7.m7.1.1.3.cmml" xref="S2.p6.7.m7.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.7.m7.1c">d_{b}</annotation></semantics></math> is large.
In addition, the storage cost for the covariance matrices may be prohibitively high if <math id="S2.p6.8.m8.1" class="ltx_Math" alttext="d_{b}" display="inline"><semantics id="S2.p6.8.m8.1a"><msub id="S2.p6.8.m8.1.1" xref="S2.p6.8.m8.1.1.cmml"><mi id="S2.p6.8.m8.1.1.2" xref="S2.p6.8.m8.1.1.2.cmml">d</mi><mi id="S2.p6.8.m8.1.1.3" xref="S2.p6.8.m8.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.8.m8.1b"><apply id="S2.p6.8.m8.1.1.cmml" xref="S2.p6.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p6.8.m8.1.1.1.cmml" xref="S2.p6.8.m8.1.1">subscript</csymbol><ci id="S2.p6.8.m8.1.1.2.cmml" xref="S2.p6.8.m8.1.1.2">𝑑</ci><ci id="S2.p6.8.m8.1.1.3.cmml" xref="S2.p6.8.m8.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.8.m8.1c">d_{b}</annotation></semantics></math> is large.
Here, we use three different approximations to the covariance in place of <math id="S2.p6.9.m9.1" class="ltx_Math" alttext="\Sigma_{c}" display="inline"><semantics id="S2.p6.9.m9.1a"><msub id="S2.p6.9.m9.1.1" xref="S2.p6.9.m9.1.1.cmml"><mi mathvariant="normal" id="S2.p6.9.m9.1.1.2" xref="S2.p6.9.m9.1.1.2.cmml">Σ</mi><mi id="S2.p6.9.m9.1.1.3" xref="S2.p6.9.m9.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.9.m9.1b"><apply id="S2.p6.9.m9.1.1.cmml" xref="S2.p6.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p6.9.m9.1.1.1.cmml" xref="S2.p6.9.m9.1.1">subscript</csymbol><ci id="S2.p6.9.m9.1.1.2.cmml" xref="S2.p6.9.m9.1.1.2">Σ</ci><ci id="S2.p6.9.m9.1.1.3.cmml" xref="S2.p6.9.m9.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.9.m9.1c">\Sigma_{c}</annotation></semantics></math> in <a href="#S2.E1" title="In 2 FiLM Transfer (FiT) ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a> <cite class="ltx_cite ltx_citemacro_citep">(Fisher, <a href="#bib.bib15" title="" class="ltx_ref">1936</a>; Duda et al., <a href="#bib.bib12" title="" class="ltx_ref">2012</a>)</cite>:</p>
<ul id="S2.I1" class="ltx_itemize">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i1.p1" class="ltx_para">
<p id="S2.I1.i1.p1.1" class="ltx_p"><span id="S2.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Quadratic Discriminant Analysis (QDA)</span>: <math id="S2.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\Sigma_{\text{{QDA}}}=e_{1}\Sigma_{class}+e_{2}\Sigma_{task}+e_{3}{\bm{I}}" display="inline"><semantics id="S2.I1.i1.p1.1.m1.1a"><mrow id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml"><msub id="S2.I1.i1.p1.1.m1.1.1.2" xref="S2.I1.i1.p1.1.m1.1.1.2.cmml"><mi mathvariant="normal" id="S2.I1.i1.p1.1.m1.1.1.2.2" xref="S2.I1.i1.p1.1.m1.1.1.2.2.cmml">Σ</mi><mtext id="S2.I1.i1.p1.1.m1.1.1.2.3" xref="S2.I1.i1.p1.1.m1.1.1.2.3a.cmml">QDA</mtext></msub><mo id="S2.I1.i1.p1.1.m1.1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S2.I1.i1.p1.1.m1.1.1.3" xref="S2.I1.i1.p1.1.m1.1.1.3.cmml"><mrow id="S2.I1.i1.p1.1.m1.1.1.3.2" xref="S2.I1.i1.p1.1.m1.1.1.3.2.cmml"><msub id="S2.I1.i1.p1.1.m1.1.1.3.2.2" xref="S2.I1.i1.p1.1.m1.1.1.3.2.2.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.3.2.2.2" xref="S2.I1.i1.p1.1.m1.1.1.3.2.2.2.cmml">e</mi><mn id="S2.I1.i1.p1.1.m1.1.1.3.2.2.3" xref="S2.I1.i1.p1.1.m1.1.1.3.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.2.1" xref="S2.I1.i1.p1.1.m1.1.1.3.2.1.cmml">​</mo><msub id="S2.I1.i1.p1.1.m1.1.1.3.2.3" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.cmml"><mi mathvariant="normal" id="S2.I1.i1.p1.1.m1.1.1.3.2.3.2" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.2.cmml">Σ</mi><mrow id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.2" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.1" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.3" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.1a" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.4" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.1b" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.5" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.1c" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.6" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.6.cmml">s</mi></mrow></msub></mrow><mo id="S2.I1.i1.p1.1.m1.1.1.3.1" xref="S2.I1.i1.p1.1.m1.1.1.3.1.cmml">+</mo><mrow id="S2.I1.i1.p1.1.m1.1.1.3.3" xref="S2.I1.i1.p1.1.m1.1.1.3.3.cmml"><msub id="S2.I1.i1.p1.1.m1.1.1.3.3.2" xref="S2.I1.i1.p1.1.m1.1.1.3.3.2.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.3.3.2.2" xref="S2.I1.i1.p1.1.m1.1.1.3.3.2.2.cmml">e</mi><mn id="S2.I1.i1.p1.1.m1.1.1.3.3.2.3" xref="S2.I1.i1.p1.1.m1.1.1.3.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.3.1" xref="S2.I1.i1.p1.1.m1.1.1.3.3.1.cmml">​</mo><msub id="S2.I1.i1.p1.1.m1.1.1.3.3.3" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.cmml"><mi mathvariant="normal" id="S2.I1.i1.p1.1.m1.1.1.3.3.3.2" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.2.cmml">Σ</mi><mrow id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.2" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.1" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.3" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.1a" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.4" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.1b" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.5" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.5.cmml">k</mi></mrow></msub></mrow><mo id="S2.I1.i1.p1.1.m1.1.1.3.1a" xref="S2.I1.i1.p1.1.m1.1.1.3.1.cmml">+</mo><mrow id="S2.I1.i1.p1.1.m1.1.1.3.4" xref="S2.I1.i1.p1.1.m1.1.1.3.4.cmml"><msub id="S2.I1.i1.p1.1.m1.1.1.3.4.2" xref="S2.I1.i1.p1.1.m1.1.1.3.4.2.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.3.4.2.2" xref="S2.I1.i1.p1.1.m1.1.1.3.4.2.2.cmml">e</mi><mn id="S2.I1.i1.p1.1.m1.1.1.3.4.2.3" xref="S2.I1.i1.p1.1.m1.1.1.3.4.2.3.cmml">3</mn></msub><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.4.1" xref="S2.I1.i1.p1.1.m1.1.1.3.4.1.cmml">​</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.4.3" xref="S2.I1.i1.p1.1.m1.1.1.3.4.3.cmml">𝑰</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><apply id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1"><eq id="S2.I1.i1.p1.1.m1.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1"></eq><apply id="S2.I1.i1.p1.1.m1.1.1.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.2.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.2.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2.2">Σ</ci><ci id="S2.I1.i1.p1.1.m1.1.1.2.3a.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2.3"><mtext mathsize="70%" id="S2.I1.i1.p1.1.m1.1.1.2.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2.3">QDA</mtext></ci></apply><apply id="S2.I1.i1.p1.1.m1.1.1.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3"><plus id="S2.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.1"></plus><apply id="S2.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2"><times id="S2.I1.i1.p1.1.m1.1.1.3.2.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.1"></times><apply id="S2.I1.i1.p1.1.m1.1.1.3.2.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.3.2.2.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.3.2.2.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.2.2">𝑒</ci><cn type="integer" id="S2.I1.i1.p1.1.m1.1.1.3.2.2.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.2.3">1</cn></apply><apply id="S2.I1.i1.p1.1.m1.1.1.3.2.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.3.2.3.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.3.2.3.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.2">Σ</ci><apply id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3"><times id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.1"></times><ci id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.2">𝑐</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.3">𝑙</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.4.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.4">𝑎</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.5.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.5">𝑠</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.6.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2.3.3.6">𝑠</ci></apply></apply></apply><apply id="S2.I1.i1.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3"><times id="S2.I1.i1.p1.1.m1.1.1.3.3.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.1"></times><apply id="S2.I1.i1.p1.1.m1.1.1.3.3.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.3.3.2.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.3.3.2.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.2.2">𝑒</ci><cn type="integer" id="S2.I1.i1.p1.1.m1.1.1.3.3.2.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.2.3">2</cn></apply><apply id="S2.I1.i1.p1.1.m1.1.1.3.3.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.3.3.3.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.3.3.3.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.2">Σ</ci><apply id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3"><times id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.1"></times><ci id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.2">𝑡</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.3">𝑎</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.4.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.4">𝑠</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.5.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3.3.3.5">𝑘</ci></apply></apply></apply><apply id="S2.I1.i1.p1.1.m1.1.1.3.4.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.4"><times id="S2.I1.i1.p1.1.m1.1.1.3.4.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.4.1"></times><apply id="S2.I1.i1.p1.1.m1.1.1.3.4.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.4.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.3.4.2.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.4.2">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.3.4.2.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.4.2.2">𝑒</ci><cn type="integer" id="S2.I1.i1.p1.1.m1.1.1.3.4.2.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.4.2.3">3</cn></apply><ci id="S2.I1.i1.p1.1.m1.1.1.3.4.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.4.3">𝑰</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">\Sigma_{\text{{QDA}}}=e_{1}\Sigma_{class}+e_{2}\Sigma_{task}+e_{3}{\bm{I}}</annotation></semantics></math></p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i2.p1" class="ltx_para">
<p id="S2.I1.i2.p1.1" class="ltx_p"><span id="S2.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Linear Discriminant Analysis (LDA)</span>: <math id="S2.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\Sigma_{\text{{LDA}}}=e_{2}\Sigma_{task}+e_{3}{\bm{I}}" display="inline"><semantics id="S2.I1.i2.p1.1.m1.1a"><mrow id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml"><msub id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2.cmml"><mi mathvariant="normal" id="S2.I1.i2.p1.1.m1.1.1.2.2" xref="S2.I1.i2.p1.1.m1.1.1.2.2.cmml">Σ</mi><mtext id="S2.I1.i2.p1.1.m1.1.1.2.3" xref="S2.I1.i2.p1.1.m1.1.1.2.3a.cmml">LDA</mtext></msub><mo id="S2.I1.i2.p1.1.m1.1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3.cmml"><mrow id="S2.I1.i2.p1.1.m1.1.1.3.2" xref="S2.I1.i2.p1.1.m1.1.1.3.2.cmml"><msub id="S2.I1.i2.p1.1.m1.1.1.3.2.2" xref="S2.I1.i2.p1.1.m1.1.1.3.2.2.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.3.2.2.2" xref="S2.I1.i2.p1.1.m1.1.1.3.2.2.2.cmml">e</mi><mn id="S2.I1.i2.p1.1.m1.1.1.3.2.2.3" xref="S2.I1.i2.p1.1.m1.1.1.3.2.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S2.I1.i2.p1.1.m1.1.1.3.2.1" xref="S2.I1.i2.p1.1.m1.1.1.3.2.1.cmml">​</mo><msub id="S2.I1.i2.p1.1.m1.1.1.3.2.3" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.cmml"><mi mathvariant="normal" id="S2.I1.i2.p1.1.m1.1.1.3.2.3.2" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.2.cmml">Σ</mi><mrow id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.2" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.1" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.3" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.1a" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.4" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.1b" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.5" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.5.cmml">k</mi></mrow></msub></mrow><mo id="S2.I1.i2.p1.1.m1.1.1.3.1" xref="S2.I1.i2.p1.1.m1.1.1.3.1.cmml">+</mo><mrow id="S2.I1.i2.p1.1.m1.1.1.3.3" xref="S2.I1.i2.p1.1.m1.1.1.3.3.cmml"><msub id="S2.I1.i2.p1.1.m1.1.1.3.3.2" xref="S2.I1.i2.p1.1.m1.1.1.3.3.2.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.3.3.2.2" xref="S2.I1.i2.p1.1.m1.1.1.3.3.2.2.cmml">e</mi><mn id="S2.I1.i2.p1.1.m1.1.1.3.3.2.3" xref="S2.I1.i2.p1.1.m1.1.1.3.3.2.3.cmml">3</mn></msub><mo lspace="0em" rspace="0em" id="S2.I1.i2.p1.1.m1.1.1.3.3.1" xref="S2.I1.i2.p1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.I1.i2.p1.1.m1.1.1.3.3.3" xref="S2.I1.i2.p1.1.m1.1.1.3.3.3.cmml">𝑰</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1"><eq id="S2.I1.i2.p1.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1"></eq><apply id="S2.I1.i2.p1.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.2.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.2.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2.2">Σ</ci><ci id="S2.I1.i2.p1.1.m1.1.1.2.3a.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2.3"><mtext mathsize="70%" id="S2.I1.i2.p1.1.m1.1.1.2.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2.3">LDA</mtext></ci></apply><apply id="S2.I1.i2.p1.1.m1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3"><plus id="S2.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.1"></plus><apply id="S2.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2"><times id="S2.I1.i2.p1.1.m1.1.1.3.2.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.1"></times><apply id="S2.I1.i2.p1.1.m1.1.1.3.2.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.3.2.2.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.3.2.2.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.2.2">𝑒</ci><cn type="integer" id="S2.I1.i2.p1.1.m1.1.1.3.2.2.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.2.3">2</cn></apply><apply id="S2.I1.i2.p1.1.m1.1.1.3.2.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.3.2.3.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.3.2.3.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.2">Σ</ci><apply id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3"><times id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.1"></times><ci id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.2">𝑡</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.3">𝑎</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.4.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.4">𝑠</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.5.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2.3.3.5">𝑘</ci></apply></apply></apply><apply id="S2.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3"><times id="S2.I1.i2.p1.1.m1.1.1.3.3.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3.1"></times><apply id="S2.I1.i2.p1.1.m1.1.1.3.3.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.3.3.2.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.3.3.2.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3.2.2">𝑒</ci><cn type="integer" id="S2.I1.i2.p1.1.m1.1.1.3.3.2.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3.2.3">3</cn></apply><ci id="S2.I1.i2.p1.1.m1.1.1.3.3.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3.3">𝑰</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">\Sigma_{\text{{LDA}}}=e_{2}\Sigma_{task}+e_{3}{\bm{I}}</annotation></semantics></math></p>
</div>
</li>
<li id="S2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="S2.I1.i3.p1.3" class="ltx_p"><span id="S2.I1.i3.p1.3.1" class="ltx_text ltx_font_bold">ProtoNets</span> <cite class="ltx_cite ltx_citemacro_citep">(Snell et al., <a href="#bib.bib54" title="" class="ltx_ref">2017</a>)</cite>: <math id="S2.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\Sigma_{\text{{PN}}}={\bm{I}}" display="inline"><semantics id="S2.I1.i3.p1.1.m1.1a"><mrow id="S2.I1.i3.p1.1.m1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.cmml"><msub id="S2.I1.i3.p1.1.m1.1.1.2" xref="S2.I1.i3.p1.1.m1.1.1.2.cmml"><mi mathvariant="normal" id="S2.I1.i3.p1.1.m1.1.1.2.2" xref="S2.I1.i3.p1.1.m1.1.1.2.2.cmml">Σ</mi><mtext id="S2.I1.i3.p1.1.m1.1.1.2.3" xref="S2.I1.i3.p1.1.m1.1.1.2.3a.cmml">PN</mtext></msub><mo id="S2.I1.i3.p1.1.m1.1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.1.cmml">=</mo><mi id="S2.I1.i3.p1.1.m1.1.1.3" xref="S2.I1.i3.p1.1.m1.1.1.3.cmml">𝑰</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.1.m1.1b"><apply id="S2.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1"><eq id="S2.I1.i3.p1.1.m1.1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1.1"></eq><apply id="S2.I1.i3.p1.1.m1.1.1.2.cmml" xref="S2.I1.i3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.I1.i3.p1.1.m1.1.1.2.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1.2">subscript</csymbol><ci id="S2.I1.i3.p1.1.m1.1.1.2.2.cmml" xref="S2.I1.i3.p1.1.m1.1.1.2.2">Σ</ci><ci id="S2.I1.i3.p1.1.m1.1.1.2.3a.cmml" xref="S2.I1.i3.p1.1.m1.1.1.2.3"><mtext mathsize="70%" id="S2.I1.i3.p1.1.m1.1.1.2.3.cmml" xref="S2.I1.i3.p1.1.m1.1.1.2.3">PN</mtext></ci></apply><ci id="S2.I1.i3.p1.1.m1.1.1.3.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3">𝑰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.1.m1.1c">\Sigma_{\text{{PN}}}={\bm{I}}</annotation></semantics></math>; i.e. there is no covariance and the class representation is parameterized only by <math id="S2.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="\mu_{c}" display="inline"><semantics id="S2.I1.i3.p1.2.m2.1a"><msub id="S2.I1.i3.p1.2.m2.1.1" xref="S2.I1.i3.p1.2.m2.1.1.cmml"><mi id="S2.I1.i3.p1.2.m2.1.1.2" xref="S2.I1.i3.p1.2.m2.1.1.2.cmml">μ</mi><mi id="S2.I1.i3.p1.2.m2.1.1.3" xref="S2.I1.i3.p1.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.2.m2.1b"><apply id="S2.I1.i3.p1.2.m2.1.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m2.1.1.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.2.m2.1.1.2.cmml" xref="S2.I1.i3.p1.2.m2.1.1.2">𝜇</ci><ci id="S2.I1.i3.p1.2.m2.1.1.3.cmml" xref="S2.I1.i3.p1.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.2.m2.1c">\mu_{c}</annotation></semantics></math> and the classifier logits are formed by computing the squared Euclidean distance between the feature representation of a test point <math id="S2.I1.i3.p1.3.m3.3" class="ltx_Math" alttext="b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})" display="inline"><semantics id="S2.I1.i3.p1.3.m3.3a"><mrow id="S2.I1.i3.p1.3.m3.3.3" xref="S2.I1.i3.p1.3.m3.3.3.cmml"><msub id="S2.I1.i3.p1.3.m3.3.3.3" xref="S2.I1.i3.p1.3.m3.3.3.3.cmml"><mi id="S2.I1.i3.p1.3.m3.3.3.3.2" xref="S2.I1.i3.p1.3.m3.3.3.3.2.cmml">b</mi><mrow id="S2.I1.i3.p1.3.m3.2.2.2.4" xref="S2.I1.i3.p1.3.m3.2.2.2.3.cmml"><mi id="S2.I1.i3.p1.3.m3.1.1.1.1" xref="S2.I1.i3.p1.3.m3.1.1.1.1.cmml">𝜽</mi><mo id="S2.I1.i3.p1.3.m3.2.2.2.4.1" xref="S2.I1.i3.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S2.I1.i3.p1.3.m3.2.2.2.2" xref="S2.I1.i3.p1.3.m3.2.2.2.2.cmml">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.I1.i3.p1.3.m3.3.3.2" xref="S2.I1.i3.p1.3.m3.3.3.2.cmml">​</mo><mrow id="S2.I1.i3.p1.3.m3.3.3.1.1" xref="S2.I1.i3.p1.3.m3.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.I1.i3.p1.3.m3.3.3.1.1.2" xref="S2.I1.i3.p1.3.m3.3.3.1.1.1.cmml">(</mo><msup id="S2.I1.i3.p1.3.m3.3.3.1.1.1" xref="S2.I1.i3.p1.3.m3.3.3.1.1.1.cmml"><mi id="S2.I1.i3.p1.3.m3.3.3.1.1.1.2" xref="S2.I1.i3.p1.3.m3.3.3.1.1.1.2.cmml">𝒙</mi><mo id="S2.I1.i3.p1.3.m3.3.3.1.1.1.3" xref="S2.I1.i3.p1.3.m3.3.3.1.1.1.3.cmml">∗</mo></msup><mo stretchy="false" id="S2.I1.i3.p1.3.m3.3.3.1.1.3" xref="S2.I1.i3.p1.3.m3.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.3.m3.3b"><apply id="S2.I1.i3.p1.3.m3.3.3.cmml" xref="S2.I1.i3.p1.3.m3.3.3"><times id="S2.I1.i3.p1.3.m3.3.3.2.cmml" xref="S2.I1.i3.p1.3.m3.3.3.2"></times><apply id="S2.I1.i3.p1.3.m3.3.3.3.cmml" xref="S2.I1.i3.p1.3.m3.3.3.3"><csymbol cd="ambiguous" id="S2.I1.i3.p1.3.m3.3.3.3.1.cmml" xref="S2.I1.i3.p1.3.m3.3.3.3">subscript</csymbol><ci id="S2.I1.i3.p1.3.m3.3.3.3.2.cmml" xref="S2.I1.i3.p1.3.m3.3.3.3.2">𝑏</ci><list id="S2.I1.i3.p1.3.m3.2.2.2.3.cmml" xref="S2.I1.i3.p1.3.m3.2.2.2.4"><ci id="S2.I1.i3.p1.3.m3.1.1.1.1.cmml" xref="S2.I1.i3.p1.3.m3.1.1.1.1">𝜽</ci><ci id="S2.I1.i3.p1.3.m3.2.2.2.2.cmml" xref="S2.I1.i3.p1.3.m3.2.2.2.2">𝝍</ci></list></apply><apply id="S2.I1.i3.p1.3.m3.3.3.1.1.1.cmml" xref="S2.I1.i3.p1.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.3.m3.3.3.1.1.1.1.cmml" xref="S2.I1.i3.p1.3.m3.3.3.1.1">superscript</csymbol><ci id="S2.I1.i3.p1.3.m3.3.3.1.1.1.2.cmml" xref="S2.I1.i3.p1.3.m3.3.3.1.1.1.2">𝒙</ci><times id="S2.I1.i3.p1.3.m3.3.3.1.1.1.3.cmml" xref="S2.I1.i3.p1.3.m3.3.3.1.1.1.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.3.m3.3c">b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})</annotation></semantics></math> and each of the class means.</p>
</div>
</li>
</ul>
<p id="S2.p6.16" class="ltx_p">In the above, <math id="S2.p6.10.m1.1" class="ltx_Math" alttext="\Sigma_{class}" display="inline"><semantics id="S2.p6.10.m1.1a"><msub id="S2.p6.10.m1.1.1" xref="S2.p6.10.m1.1.1.cmml"><mi mathvariant="normal" id="S2.p6.10.m1.1.1.2" xref="S2.p6.10.m1.1.1.2.cmml">Σ</mi><mrow id="S2.p6.10.m1.1.1.3" xref="S2.p6.10.m1.1.1.3.cmml"><mi id="S2.p6.10.m1.1.1.3.2" xref="S2.p6.10.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.p6.10.m1.1.1.3.1" xref="S2.p6.10.m1.1.1.3.1.cmml">​</mo><mi id="S2.p6.10.m1.1.1.3.3" xref="S2.p6.10.m1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.p6.10.m1.1.1.3.1a" xref="S2.p6.10.m1.1.1.3.1.cmml">​</mo><mi id="S2.p6.10.m1.1.1.3.4" xref="S2.p6.10.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.p6.10.m1.1.1.3.1b" xref="S2.p6.10.m1.1.1.3.1.cmml">​</mo><mi id="S2.p6.10.m1.1.1.3.5" xref="S2.p6.10.m1.1.1.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.p6.10.m1.1.1.3.1c" xref="S2.p6.10.m1.1.1.3.1.cmml">​</mo><mi id="S2.p6.10.m1.1.1.3.6" xref="S2.p6.10.m1.1.1.3.6.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p6.10.m1.1b"><apply id="S2.p6.10.m1.1.1.cmml" xref="S2.p6.10.m1.1.1"><csymbol cd="ambiguous" id="S2.p6.10.m1.1.1.1.cmml" xref="S2.p6.10.m1.1.1">subscript</csymbol><ci id="S2.p6.10.m1.1.1.2.cmml" xref="S2.p6.10.m1.1.1.2">Σ</ci><apply id="S2.p6.10.m1.1.1.3.cmml" xref="S2.p6.10.m1.1.1.3"><times id="S2.p6.10.m1.1.1.3.1.cmml" xref="S2.p6.10.m1.1.1.3.1"></times><ci id="S2.p6.10.m1.1.1.3.2.cmml" xref="S2.p6.10.m1.1.1.3.2">𝑐</ci><ci id="S2.p6.10.m1.1.1.3.3.cmml" xref="S2.p6.10.m1.1.1.3.3">𝑙</ci><ci id="S2.p6.10.m1.1.1.3.4.cmml" xref="S2.p6.10.m1.1.1.3.4">𝑎</ci><ci id="S2.p6.10.m1.1.1.3.5.cmml" xref="S2.p6.10.m1.1.1.3.5">𝑠</ci><ci id="S2.p6.10.m1.1.1.3.6.cmml" xref="S2.p6.10.m1.1.1.3.6">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.10.m1.1c">\Sigma_{class}</annotation></semantics></math> is the computed covariance of the examples in class <math id="S2.p6.11.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.p6.11.m2.1a"><mi id="S2.p6.11.m2.1.1" xref="S2.p6.11.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.p6.11.m2.1b"><ci id="S2.p6.11.m2.1.1.cmml" xref="S2.p6.11.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.11.m2.1c">c</annotation></semantics></math> in <math id="S2.p6.12.m3.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.p6.12.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p6.12.m3.1.1" xref="S2.p6.12.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p6.12.m3.1b"><ci id="S2.p6.12.m3.1.1.cmml" xref="S2.p6.12.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.12.m3.1c">\mathcal{D}</annotation></semantics></math>, <math id="S2.p6.13.m4.1" class="ltx_Math" alttext="\Sigma_{task}" display="inline"><semantics id="S2.p6.13.m4.1a"><msub id="S2.p6.13.m4.1.1" xref="S2.p6.13.m4.1.1.cmml"><mi mathvariant="normal" id="S2.p6.13.m4.1.1.2" xref="S2.p6.13.m4.1.1.2.cmml">Σ</mi><mrow id="S2.p6.13.m4.1.1.3" xref="S2.p6.13.m4.1.1.3.cmml"><mi id="S2.p6.13.m4.1.1.3.2" xref="S2.p6.13.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p6.13.m4.1.1.3.1" xref="S2.p6.13.m4.1.1.3.1.cmml">​</mo><mi id="S2.p6.13.m4.1.1.3.3" xref="S2.p6.13.m4.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.p6.13.m4.1.1.3.1a" xref="S2.p6.13.m4.1.1.3.1.cmml">​</mo><mi id="S2.p6.13.m4.1.1.3.4" xref="S2.p6.13.m4.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.p6.13.m4.1.1.3.1b" xref="S2.p6.13.m4.1.1.3.1.cmml">​</mo><mi id="S2.p6.13.m4.1.1.3.5" xref="S2.p6.13.m4.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p6.13.m4.1b"><apply id="S2.p6.13.m4.1.1.cmml" xref="S2.p6.13.m4.1.1"><csymbol cd="ambiguous" id="S2.p6.13.m4.1.1.1.cmml" xref="S2.p6.13.m4.1.1">subscript</csymbol><ci id="S2.p6.13.m4.1.1.2.cmml" xref="S2.p6.13.m4.1.1.2">Σ</ci><apply id="S2.p6.13.m4.1.1.3.cmml" xref="S2.p6.13.m4.1.1.3"><times id="S2.p6.13.m4.1.1.3.1.cmml" xref="S2.p6.13.m4.1.1.3.1"></times><ci id="S2.p6.13.m4.1.1.3.2.cmml" xref="S2.p6.13.m4.1.1.3.2">𝑡</ci><ci id="S2.p6.13.m4.1.1.3.3.cmml" xref="S2.p6.13.m4.1.1.3.3">𝑎</ci><ci id="S2.p6.13.m4.1.1.3.4.cmml" xref="S2.p6.13.m4.1.1.3.4">𝑠</ci><ci id="S2.p6.13.m4.1.1.3.5.cmml" xref="S2.p6.13.m4.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.13.m4.1c">\Sigma_{task}</annotation></semantics></math> is the computed covariance of all the examples in <math id="S2.p6.14.m5.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.p6.14.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p6.14.m5.1.1" xref="S2.p6.14.m5.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p6.14.m5.1b"><ci id="S2.p6.14.m5.1.1.cmml" xref="S2.p6.14.m5.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.14.m5.1c">\mathcal{D}</annotation></semantics></math> assuming they arise from a single Gaussian with a single mean, <math id="S2.p6.15.m6.3" class="ltx_Math" alttext="{\bm{e}}=\{e_{1},e_{2},e_{3}\}" display="inline"><semantics id="S2.p6.15.m6.3a"><mrow id="S2.p6.15.m6.3.3" xref="S2.p6.15.m6.3.3.cmml"><mi id="S2.p6.15.m6.3.3.5" xref="S2.p6.15.m6.3.3.5.cmml">𝒆</mi><mo id="S2.p6.15.m6.3.3.4" xref="S2.p6.15.m6.3.3.4.cmml">=</mo><mrow id="S2.p6.15.m6.3.3.3.3" xref="S2.p6.15.m6.3.3.3.4.cmml"><mo stretchy="false" id="S2.p6.15.m6.3.3.3.3.4" xref="S2.p6.15.m6.3.3.3.4.cmml">{</mo><msub id="S2.p6.15.m6.1.1.1.1.1" xref="S2.p6.15.m6.1.1.1.1.1.cmml"><mi id="S2.p6.15.m6.1.1.1.1.1.2" xref="S2.p6.15.m6.1.1.1.1.1.2.cmml">e</mi><mn id="S2.p6.15.m6.1.1.1.1.1.3" xref="S2.p6.15.m6.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.p6.15.m6.3.3.3.3.5" xref="S2.p6.15.m6.3.3.3.4.cmml">,</mo><msub id="S2.p6.15.m6.2.2.2.2.2" xref="S2.p6.15.m6.2.2.2.2.2.cmml"><mi id="S2.p6.15.m6.2.2.2.2.2.2" xref="S2.p6.15.m6.2.2.2.2.2.2.cmml">e</mi><mn id="S2.p6.15.m6.2.2.2.2.2.3" xref="S2.p6.15.m6.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.p6.15.m6.3.3.3.3.6" xref="S2.p6.15.m6.3.3.3.4.cmml">,</mo><msub id="S2.p6.15.m6.3.3.3.3.3" xref="S2.p6.15.m6.3.3.3.3.3.cmml"><mi id="S2.p6.15.m6.3.3.3.3.3.2" xref="S2.p6.15.m6.3.3.3.3.3.2.cmml">e</mi><mn id="S2.p6.15.m6.3.3.3.3.3.3" xref="S2.p6.15.m6.3.3.3.3.3.3.cmml">3</mn></msub><mo stretchy="false" id="S2.p6.15.m6.3.3.3.3.7" xref="S2.p6.15.m6.3.3.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.15.m6.3b"><apply id="S2.p6.15.m6.3.3.cmml" xref="S2.p6.15.m6.3.3"><eq id="S2.p6.15.m6.3.3.4.cmml" xref="S2.p6.15.m6.3.3.4"></eq><ci id="S2.p6.15.m6.3.3.5.cmml" xref="S2.p6.15.m6.3.3.5">𝒆</ci><set id="S2.p6.15.m6.3.3.3.4.cmml" xref="S2.p6.15.m6.3.3.3.3"><apply id="S2.p6.15.m6.1.1.1.1.1.cmml" xref="S2.p6.15.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p6.15.m6.1.1.1.1.1.1.cmml" xref="S2.p6.15.m6.1.1.1.1.1">subscript</csymbol><ci id="S2.p6.15.m6.1.1.1.1.1.2.cmml" xref="S2.p6.15.m6.1.1.1.1.1.2">𝑒</ci><cn type="integer" id="S2.p6.15.m6.1.1.1.1.1.3.cmml" xref="S2.p6.15.m6.1.1.1.1.1.3">1</cn></apply><apply id="S2.p6.15.m6.2.2.2.2.2.cmml" xref="S2.p6.15.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p6.15.m6.2.2.2.2.2.1.cmml" xref="S2.p6.15.m6.2.2.2.2.2">subscript</csymbol><ci id="S2.p6.15.m6.2.2.2.2.2.2.cmml" xref="S2.p6.15.m6.2.2.2.2.2.2">𝑒</ci><cn type="integer" id="S2.p6.15.m6.2.2.2.2.2.3.cmml" xref="S2.p6.15.m6.2.2.2.2.2.3">2</cn></apply><apply id="S2.p6.15.m6.3.3.3.3.3.cmml" xref="S2.p6.15.m6.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.p6.15.m6.3.3.3.3.3.1.cmml" xref="S2.p6.15.m6.3.3.3.3.3">subscript</csymbol><ci id="S2.p6.15.m6.3.3.3.3.3.2.cmml" xref="S2.p6.15.m6.3.3.3.3.3.2">𝑒</ci><cn type="integer" id="S2.p6.15.m6.3.3.3.3.3.3.cmml" xref="S2.p6.15.m6.3.3.3.3.3.3">3</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.15.m6.3c">{\bm{e}}=\{e_{1},e_{2},e_{3}\}</annotation></semantics></math> are weights learned during training, and the identity matrix <math id="S2.p6.16.m7.1" class="ltx_Math" alttext="{\bm{I}}" display="inline"><semantics id="S2.p6.16.m7.1a"><mi id="S2.p6.16.m7.1.1" xref="S2.p6.16.m7.1.1.cmml">𝑰</mi><annotation-xml encoding="MathML-Content" id="S2.p6.16.m7.1b"><ci id="S2.p6.16.m7.1.1.cmml" xref="S2.p6.16.m7.1.1">𝑰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.16.m7.1c">{\bm{I}}</annotation></semantics></math> is used as a regularizer.
QDA mainly serves as a baseline since it has a very large set of updateable parameters arising from the fact that it stores a covariance matrix for each class in the dataset. LDA is far more parameter efficient than QDA, sharing a single covariance matrix across all classes. We show that LDA leads to very similar performance to QDA.
The number of model shared and updateable parameters for the three <span id="S2.p6.16.1" class="ltx_text ltx_font_smallcaps">FiT</span> variants as well as the BiT algorithm are detailed in <a href="#S2.T1" title="In 2 FiLM Transfer (FiT) ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>. Refer to <a href="#A1.SS2" title="A.2 Model Parameters ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.2</span></a> for details on the parameter calculations.</p>
</div>
<figure id="S2.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Shared and updateable parameters for the transfer learning methods considered. The Example column contains the updateable parameters for all methods using a BiT-M-R50x1 backbone with <math id="S2.T1.5.m1.4" class="ltx_Math" alttext="|{\bm{\theta}}|=23,500,352" display="inline"><semantics id="S2.T1.5.m1.4b"><mrow id="S2.T1.5.m1.4.5" xref="S2.T1.5.m1.4.5.cmml"><mrow id="S2.T1.5.m1.4.5.2.2" xref="S2.T1.5.m1.4.5.2.1.cmml"><mo stretchy="false" id="S2.T1.5.m1.4.5.2.2.1" xref="S2.T1.5.m1.4.5.2.1.1.cmml">|</mo><mi id="S2.T1.5.m1.1.1" xref="S2.T1.5.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S2.T1.5.m1.4.5.2.2.2" xref="S2.T1.5.m1.4.5.2.1.1.cmml">|</mo></mrow><mo id="S2.T1.5.m1.4.5.1" xref="S2.T1.5.m1.4.5.1.cmml">=</mo><mrow id="S2.T1.5.m1.4.5.3.2" xref="S2.T1.5.m1.4.5.3.1.cmml"><mn id="S2.T1.5.m1.2.2" xref="S2.T1.5.m1.2.2.cmml">23</mn><mo id="S2.T1.5.m1.4.5.3.2.1" xref="S2.T1.5.m1.4.5.3.1.cmml">,</mo><mn id="S2.T1.5.m1.3.3" xref="S2.T1.5.m1.3.3.cmml">500</mn><mo id="S2.T1.5.m1.4.5.3.2.2" xref="S2.T1.5.m1.4.5.3.1.cmml">,</mo><mn id="S2.T1.5.m1.4.4" xref="S2.T1.5.m1.4.4.cmml">352</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.5.m1.4c"><apply id="S2.T1.5.m1.4.5.cmml" xref="S2.T1.5.m1.4.5"><eq id="S2.T1.5.m1.4.5.1.cmml" xref="S2.T1.5.m1.4.5.1"></eq><apply id="S2.T1.5.m1.4.5.2.1.cmml" xref="S2.T1.5.m1.4.5.2.2"><abs id="S2.T1.5.m1.4.5.2.1.1.cmml" xref="S2.T1.5.m1.4.5.2.2.1"></abs><ci id="S2.T1.5.m1.1.1.cmml" xref="S2.T1.5.m1.1.1">𝜽</ci></apply><list id="S2.T1.5.m1.4.5.3.1.cmml" xref="S2.T1.5.m1.4.5.3.2"><cn type="integer" id="S2.T1.5.m1.2.2.cmml" xref="S2.T1.5.m1.2.2">23</cn><cn type="integer" id="S2.T1.5.m1.3.3.cmml" xref="S2.T1.5.m1.3.3">500</cn><cn type="integer" id="S2.T1.5.m1.4.4.cmml" xref="S2.T1.5.m1.4.4">352</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.5.m1.4d">|{\bm{\theta}}|=23,500,352</annotation></semantics></math>, <math id="S2.T1.6.m2.2" class="ltx_Math" alttext="{\bm{\psi}}=11,648" display="inline"><semantics id="S2.T1.6.m2.2b"><mrow id="S2.T1.6.m2.2.3" xref="S2.T1.6.m2.2.3.cmml"><mi id="S2.T1.6.m2.2.3.2" xref="S2.T1.6.m2.2.3.2.cmml">𝝍</mi><mo id="S2.T1.6.m2.2.3.1" xref="S2.T1.6.m2.2.3.1.cmml">=</mo><mrow id="S2.T1.6.m2.2.3.3.2" xref="S2.T1.6.m2.2.3.3.1.cmml"><mn id="S2.T1.6.m2.1.1" xref="S2.T1.6.m2.1.1.cmml">11</mn><mo id="S2.T1.6.m2.2.3.3.2.1" xref="S2.T1.6.m2.2.3.3.1.cmml">,</mo><mn id="S2.T1.6.m2.2.2" xref="S2.T1.6.m2.2.2.cmml">648</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.6.m2.2c"><apply id="S2.T1.6.m2.2.3.cmml" xref="S2.T1.6.m2.2.3"><eq id="S2.T1.6.m2.2.3.1.cmml" xref="S2.T1.6.m2.2.3.1"></eq><ci id="S2.T1.6.m2.2.3.2.cmml" xref="S2.T1.6.m2.2.3.2">𝝍</ci><list id="S2.T1.6.m2.2.3.3.1.cmml" xref="S2.T1.6.m2.2.3.3.2"><cn type="integer" id="S2.T1.6.m2.1.1.cmml" xref="S2.T1.6.m2.1.1">11</cn><cn type="integer" id="S2.T1.6.m2.2.2.cmml" xref="S2.T1.6.m2.2.2">648</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.6.m2.2d">{\bm{\psi}}=11,648</annotation></semantics></math>, <math id="S2.T1.7.m3.1" class="ltx_Math" alttext="d_{b}=2048" display="inline"><semantics id="S2.T1.7.m3.1b"><mrow id="S2.T1.7.m3.1.1" xref="S2.T1.7.m3.1.1.cmml"><msub id="S2.T1.7.m3.1.1.2" xref="S2.T1.7.m3.1.1.2.cmml"><mi id="S2.T1.7.m3.1.1.2.2" xref="S2.T1.7.m3.1.1.2.2.cmml">d</mi><mi id="S2.T1.7.m3.1.1.2.3" xref="S2.T1.7.m3.1.1.2.3.cmml">b</mi></msub><mo id="S2.T1.7.m3.1.1.1" xref="S2.T1.7.m3.1.1.1.cmml">=</mo><mn id="S2.T1.7.m3.1.1.3" xref="S2.T1.7.m3.1.1.3.cmml">2048</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.7.m3.1c"><apply id="S2.T1.7.m3.1.1.cmml" xref="S2.T1.7.m3.1.1"><eq id="S2.T1.7.m3.1.1.1.cmml" xref="S2.T1.7.m3.1.1.1"></eq><apply id="S2.T1.7.m3.1.1.2.cmml" xref="S2.T1.7.m3.1.1.2"><csymbol cd="ambiguous" id="S2.T1.7.m3.1.1.2.1.cmml" xref="S2.T1.7.m3.1.1.2">subscript</csymbol><ci id="S2.T1.7.m3.1.1.2.2.cmml" xref="S2.T1.7.m3.1.1.2.2">𝑑</ci><ci id="S2.T1.7.m3.1.1.2.3.cmml" xref="S2.T1.7.m3.1.1.2.3">𝑏</ci></apply><cn type="integer" id="S2.T1.7.m3.1.1.3.cmml" xref="S2.T1.7.m3.1.1.3">2048</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.7.m3.1d">d_{b}=2048</annotation></semantics></math>, and <math id="S2.T1.8.m4.1" class="ltx_Math" alttext="C=10" display="inline"><semantics id="S2.T1.8.m4.1b"><mrow id="S2.T1.8.m4.1.1" xref="S2.T1.8.m4.1.1.cmml"><mi id="S2.T1.8.m4.1.1.2" xref="S2.T1.8.m4.1.1.2.cmml">C</mi><mo id="S2.T1.8.m4.1.1.1" xref="S2.T1.8.m4.1.1.1.cmml">=</mo><mn id="S2.T1.8.m4.1.1.3" xref="S2.T1.8.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.8.m4.1c"><apply id="S2.T1.8.m4.1.1.cmml" xref="S2.T1.8.m4.1.1"><eq id="S2.T1.8.m4.1.1.1.cmml" xref="S2.T1.8.m4.1.1.1"></eq><ci id="S2.T1.8.m4.1.1.2.cmml" xref="S2.T1.8.m4.1.1.2">𝐶</ci><cn type="integer" id="S2.T1.8.m4.1.1.3.cmml" xref="S2.T1.8.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.8.m4.1d">C=10</annotation></semantics></math>.</figcaption>
<p id="S2.T1.16" class="ltx_p ltx_align_center"><span id="S2.T1.16.8" class="ltx_text">
<span id="S2.T1.16.8.8" class="ltx_inline-block ltx_transformed_outer" style="width:378.9pt;height:90pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S2.T1.16.8.8.8" class="ltx_p"><span id="S2.T1.16.8.8.8.8" class="ltx_text">
<span id="S2.T1.16.8.8.8.8.8" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S2.T1.16.8.8.8.8.8.9.1" class="ltx_tr">
<span id="S2.T1.16.8.8.8.8.8.9.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S2.T1.16.8.8.8.8.8.9.1.1.1" class="ltx_text ltx_font_bold">Method</span></span>
<span id="S2.T1.16.8.8.8.8.8.9.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S2.T1.16.8.8.8.8.8.9.1.2.1" class="ltx_text ltx_font_bold">Shared</span></span>
<span id="S2.T1.16.8.8.8.8.8.9.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S2.T1.16.8.8.8.8.8.9.1.3.1" class="ltx_text ltx_font_bold">Updateable</span></span>
<span id="S2.T1.16.8.8.8.8.8.9.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S2.T1.16.8.8.8.8.8.9.1.4.1" class="ltx_text ltx_font_bold">Example</span></span></span>
<span id="S2.T1.10.2.2.2.2.2.2" class="ltx_tr">
<span id="S2.T1.10.2.2.2.2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">BiT</span>
<span id="S2.T1.10.2.2.2.2.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">0</span>
<span id="S2.T1.10.2.2.2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S2.T1.9.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="|{\bm{\theta}}|" display="inline"><semantics id="S2.T1.9.1.1.1.1.1.1.1.m1.1a"><mrow id="S2.T1.9.1.1.1.1.1.1.1.m1.1.2.2" xref="S2.T1.9.1.1.1.1.1.1.1.m1.1.2.1.cmml"><mo stretchy="false" id="S2.T1.9.1.1.1.1.1.1.1.m1.1.2.2.1" xref="S2.T1.9.1.1.1.1.1.1.1.m1.1.2.1.1.cmml">|</mo><mi id="S2.T1.9.1.1.1.1.1.1.1.m1.1.1" xref="S2.T1.9.1.1.1.1.1.1.1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S2.T1.9.1.1.1.1.1.1.1.m1.1.2.2.2" xref="S2.T1.9.1.1.1.1.1.1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.9.1.1.1.1.1.1.1.m1.1b"><apply id="S2.T1.9.1.1.1.1.1.1.1.m1.1.2.1.cmml" xref="S2.T1.9.1.1.1.1.1.1.1.m1.1.2.2"><abs id="S2.T1.9.1.1.1.1.1.1.1.m1.1.2.1.1.cmml" xref="S2.T1.9.1.1.1.1.1.1.1.m1.1.2.2.1"></abs><ci id="S2.T1.9.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.T1.9.1.1.1.1.1.1.1.m1.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.9.1.1.1.1.1.1.1.m1.1c">|{\bm{\theta}}|</annotation></semantics></math> + <math id="S2.T1.10.2.2.2.2.2.2.2.m2.2" class="ltx_Math" alttext="|{\bm{\phi}}|=|{\bm{\theta}}|+Cd_{b}" display="inline"><semantics id="S2.T1.10.2.2.2.2.2.2.2.m2.2a"><mrow id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.cmml"><mrow id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.2.2" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.2.1.cmml"><mo stretchy="false" id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.2.2.1" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.2.1.1.cmml">|</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.T1.10.2.2.2.2.2.2.2.m2.1.1" xref="S2.T1.10.2.2.2.2.2.2.2.m2.1.1.cmml">ϕ</mi><mo stretchy="false" id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.2.2.2" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.2.1.1.cmml">|</mo></mrow><mo id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.1" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.1.cmml">=</mo><mrow id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.cmml"><mrow id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.2.2" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.2.1.cmml"><mo stretchy="false" id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.2.2.1" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.2.1.1.cmml">|</mo><mi id="S2.T1.10.2.2.2.2.2.2.2.m2.2.2" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.2.cmml">𝜽</mi><mo stretchy="false" id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.2.2.2" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.2.1.1.cmml">|</mo></mrow><mo id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.1" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.1.cmml">+</mo><mrow id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.cmml"><mi id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.2" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.1" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.1.cmml">​</mo><msub id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3.cmml"><mi id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3.2" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3.2.cmml">d</mi><mi id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3.3" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3.3.cmml">b</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.10.2.2.2.2.2.2.2.m2.2b"><apply id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3"><eq id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.1.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.1"></eq><apply id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.2.1.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.2.2"><abs id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.2.1.1.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.2.2.1"></abs><ci id="S2.T1.10.2.2.2.2.2.2.2.m2.1.1.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.1.1">bold-italic-ϕ</ci></apply><apply id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3"><plus id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.1.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.1"></plus><apply id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.2.1.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.2.2"><abs id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.2.1.1.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.2.2.1"></abs><ci id="S2.T1.10.2.2.2.2.2.2.2.m2.2.2.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.2">𝜽</ci></apply><apply id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3"><times id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.1.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.1"></times><ci id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.2.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.2">𝐶</ci><apply id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3"><csymbol cd="ambiguous" id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3.1.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3">subscript</csymbol><ci id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3.2.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3.2">𝑑</ci><ci id="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3.3.cmml" xref="S2.T1.10.2.2.2.2.2.2.2.m2.2.3.3.3.3.3">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.10.2.2.2.2.2.2.2.m2.2c">|{\bm{\phi}}|=|{\bm{\theta}}|+Cd_{b}</annotation></semantics></math></span>
<span id="S2.T1.10.2.2.2.2.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">23,520,832</span></span>
</span>
<span class="ltx_tbody">
<span id="S2.T1.12.4.4.4.4.4.4" class="ltx_tr">
<span id="S2.T1.12.4.4.4.4.4.4.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S2.T1.12.4.4.4.4.4.4.3.1" class="ltx_text ltx_font_smallcaps">FiT</span> - QDA</span>
<span id="S2.T1.11.3.3.3.3.3.3.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S2.T1.11.3.3.3.3.3.3.1.m1.1" class="ltx_Math" alttext="|{\bm{\theta}}|" display="inline"><semantics id="S2.T1.11.3.3.3.3.3.3.1.m1.1a"><mrow id="S2.T1.11.3.3.3.3.3.3.1.m1.1.2.2" xref="S2.T1.11.3.3.3.3.3.3.1.m1.1.2.1.cmml"><mo stretchy="false" id="S2.T1.11.3.3.3.3.3.3.1.m1.1.2.2.1" xref="S2.T1.11.3.3.3.3.3.3.1.m1.1.2.1.1.cmml">|</mo><mi id="S2.T1.11.3.3.3.3.3.3.1.m1.1.1" xref="S2.T1.11.3.3.3.3.3.3.1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S2.T1.11.3.3.3.3.3.3.1.m1.1.2.2.2" xref="S2.T1.11.3.3.3.3.3.3.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.11.3.3.3.3.3.3.1.m1.1b"><apply id="S2.T1.11.3.3.3.3.3.3.1.m1.1.2.1.cmml" xref="S2.T1.11.3.3.3.3.3.3.1.m1.1.2.2"><abs id="S2.T1.11.3.3.3.3.3.3.1.m1.1.2.1.1.cmml" xref="S2.T1.11.3.3.3.3.3.3.1.m1.1.2.2.1"></abs><ci id="S2.T1.11.3.3.3.3.3.3.1.m1.1.1.cmml" xref="S2.T1.11.3.3.3.3.3.3.1.m1.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.11.3.3.3.3.3.3.1.m1.1c">|{\bm{\theta}}|</annotation></semantics></math></span>
<span id="S2.T1.12.4.4.4.4.4.4.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S2.T1.12.4.4.4.4.4.4.2.m1.6" class="ltx_Math" alttext="|{\bm{\psi}}|+|{\bm{\mu}}|+|{\bm{\Sigma}}|+|e|=|{\bm{\psi}}|+Cd_{b}+C\frac{d_{b}(d_{b}+1)}{2}+3" display="inline"><semantics id="S2.T1.12.4.4.4.4.4.4.2.m1.6a"><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.cmml"><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.cmml"><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.2.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.2.1.cmml"><mo stretchy="false" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.2.2.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.2.1.1.cmml">|</mo><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.2.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.2.2.cmml">𝝍</mi><mo stretchy="false" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.2.2.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.2.1.1.cmml">|</mo></mrow><mo id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.1.cmml">+</mo><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.3.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.3.1.cmml"><mo stretchy="false" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.3.2.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.3.1.1.cmml">|</mo><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.3.3" xref="S2.T1.12.4.4.4.4.4.4.2.m1.3.3.cmml">𝝁</mi><mo stretchy="false" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.3.2.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.3.1.1.cmml">|</mo></mrow><mo id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.1a" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.1.cmml">+</mo><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.4.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.4.1.cmml"><mo stretchy="false" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.4.2.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.4.1.1.cmml">|</mo><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.4.4" xref="S2.T1.12.4.4.4.4.4.4.2.m1.4.4.cmml">𝚺</mi><mo stretchy="false" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.4.2.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.4.1.1.cmml">|</mo></mrow><mo id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.1b" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.1.cmml">+</mo><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.5.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.5.1.cmml"><mo stretchy="false" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.5.2.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.5.1.1.cmml">|</mo><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.5.5" xref="S2.T1.12.4.4.4.4.4.4.2.m1.5.5.cmml">e</mi><mo stretchy="false" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.5.2.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.5.1.1.cmml">|</mo></mrow></mrow><mo id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.1.cmml">=</mo><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.cmml"><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.2.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.2.1.cmml"><mo stretchy="false" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.2.2.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.2.1.1.cmml">|</mo><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.6.6" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.6.cmml">𝝍</mi><mo stretchy="false" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.2.2.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.2.1.1.cmml">|</mo></mrow><mo id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.1.cmml">+</mo><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.cmml"><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.1.cmml">​</mo><msub id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3.cmml"><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3.2.cmml">d</mi><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3.3" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3.3.cmml">b</mi></msub></mrow><mo id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.1a" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.1.cmml">+</mo><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.4" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.4.cmml"><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.4.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.4.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.4.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.4.1.cmml">​</mo><mfrac id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.cmml"><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.cmml"><msub id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3.cmml"><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3.2.cmml">d</mi><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3.3" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3.3.cmml">b</mi></msub><mo lspace="0em" rspace="0em" id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.2.cmml">​</mo><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.cmml"><msub id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2.2" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2.2.cmml">d</mi><mi id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2.3" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2.3.cmml">b</mi></msub><mo id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.1" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.3" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.3" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mn id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.3" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.3.cmml">2</mn></mfrac></mrow><mo id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.1b" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.1.cmml">+</mo><mn id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.5" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.5.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.12.4.4.4.4.4.4.2.m1.6b"><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7"><eq id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.1"></eq><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2"><plus id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.1"></plus><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.2.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.2.2"><abs id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.2.1.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.2.2.1"></abs><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.2.2.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.2.2">𝝍</ci></apply><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.3.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.3.2"><abs id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.3.1.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.3.2.1"></abs><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.3.3.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.3.3">𝝁</ci></apply><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.4.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.4.2"><abs id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.4.1.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.4.2.1"></abs><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.4.4.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.4.4">𝚺</ci></apply><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.5.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.5.2"><abs id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.5.1.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.2.5.2.1"></abs><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.5.5.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.5.5">𝑒</ci></apply></apply><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3"><plus id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.1"></plus><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.2.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.2.2"><abs id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.2.1.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.2.2.1"></abs><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.6.6.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.6">𝝍</ci></apply><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3"><times id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.1"></times><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.2.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.2">𝐶</ci><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3"><csymbol cd="ambiguous" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3">subscript</csymbol><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3.2.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3.2">𝑑</ci><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3.3.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.3.3.3">𝑏</ci></apply></apply><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.4.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.4"><times id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.4.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.4.1"></times><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.4.2.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.4.2">𝐶</ci><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1"><divide id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.2.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1"></divide><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1"><times id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.2.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.2"></times><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3">subscript</csymbol><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3.2.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3.2">𝑑</ci><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3.3.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.3.3">𝑏</ci></apply><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1"><plus id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.1"></plus><apply id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2.2">𝑑</ci><ci id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.2.3">𝑏</ci></apply><cn type="integer" id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.3.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.1.1.1.1.3">1</cn></apply></apply><cn type="integer" id="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.3.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.1.1.3">2</cn></apply></apply><cn type="integer" id="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.5.cmml" xref="S2.T1.12.4.4.4.4.4.4.2.m1.6.7.3.5">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.12.4.4.4.4.4.4.2.m1.6c">|{\bm{\psi}}|+|{\bm{\mu}}|+|{\bm{\Sigma}}|+|e|=|{\bm{\psi}}|+Cd_{b}+C\frac{d_{b}(d_{b}+1)}{2}+3</annotation></semantics></math></span>
<span id="S2.T1.12.4.4.4.4.4.4.4" class="ltx_td ltx_align_center ltx_border_t">21,013,891</span></span>
<span id="S2.T1.14.6.6.6.6.6.6" class="ltx_tr">
<span id="S2.T1.14.6.6.6.6.6.6.3" class="ltx_td ltx_align_left"><span id="S2.T1.14.6.6.6.6.6.6.3.1" class="ltx_text ltx_font_smallcaps">FiT</span> - LDA</span>
<span id="S2.T1.13.5.5.5.5.5.5.1" class="ltx_td ltx_align_center"><math id="S2.T1.13.5.5.5.5.5.5.1.m1.1" class="ltx_Math" alttext="|{\bm{\theta}}|" display="inline"><semantics id="S2.T1.13.5.5.5.5.5.5.1.m1.1a"><mrow id="S2.T1.13.5.5.5.5.5.5.1.m1.1.2.2" xref="S2.T1.13.5.5.5.5.5.5.1.m1.1.2.1.cmml"><mo stretchy="false" id="S2.T1.13.5.5.5.5.5.5.1.m1.1.2.2.1" xref="S2.T1.13.5.5.5.5.5.5.1.m1.1.2.1.1.cmml">|</mo><mi id="S2.T1.13.5.5.5.5.5.5.1.m1.1.1" xref="S2.T1.13.5.5.5.5.5.5.1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S2.T1.13.5.5.5.5.5.5.1.m1.1.2.2.2" xref="S2.T1.13.5.5.5.5.5.5.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.13.5.5.5.5.5.5.1.m1.1b"><apply id="S2.T1.13.5.5.5.5.5.5.1.m1.1.2.1.cmml" xref="S2.T1.13.5.5.5.5.5.5.1.m1.1.2.2"><abs id="S2.T1.13.5.5.5.5.5.5.1.m1.1.2.1.1.cmml" xref="S2.T1.13.5.5.5.5.5.5.1.m1.1.2.2.1"></abs><ci id="S2.T1.13.5.5.5.5.5.5.1.m1.1.1.cmml" xref="S2.T1.13.5.5.5.5.5.5.1.m1.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.13.5.5.5.5.5.5.1.m1.1c">|{\bm{\theta}}|</annotation></semantics></math></span>
<span id="S2.T1.14.6.6.6.6.6.6.2" class="ltx_td ltx_align_center"><math id="S2.T1.14.6.6.6.6.6.6.2.m1.7" class="ltx_Math" alttext="|{\bm{\psi}}|+(|{\bm{\mu}}|+|{\bm{\Sigma}}|)+|e|=|{\bm{\psi}}|+C(d_{b}+1)+2" display="inline"><semantics id="S2.T1.14.6.6.6.6.6.6.2.m1.7a"><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.cmml"><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.cmml"><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.3.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.3.1.cmml"><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.3.2.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.3.1.1.cmml">|</mo><mi id="S2.T1.14.6.6.6.6.6.6.2.m1.1.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.1.1.cmml">𝝍</mi><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.3.2.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.3.1.1.cmml">|</mo></mrow><mo id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.2.cmml">+</mo><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.cmml"><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.cmml"><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.2.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.2.1.cmml"><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.2.2.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.2.1.1.cmml">|</mo><mi id="S2.T1.14.6.6.6.6.6.6.2.m1.2.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.2.2.cmml">𝝁</mi><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.2.2.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.1.cmml">+</mo><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.3.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.3.2.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.3.1.1.cmml">|</mo><mi id="S2.T1.14.6.6.6.6.6.6.2.m1.3.3" xref="S2.T1.14.6.6.6.6.6.6.2.m1.3.3.cmml">𝚺</mi><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.3.2.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.3.1.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.3" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.2a" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.2.cmml">+</mo><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.4.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.4.1.cmml"><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.4.2.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.4.1.1.cmml">|</mo><mi id="S2.T1.14.6.6.6.6.6.6.2.m1.4.4" xref="S2.T1.14.6.6.6.6.6.6.2.m1.4.4.cmml">e</mi><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.4.2.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.4.1.1.cmml">|</mo></mrow></mrow><mo id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.3" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.3.cmml">=</mo><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.cmml"><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.3.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.3.1.cmml"><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.3.2.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.3.1.1.cmml">|</mo><mi id="S2.T1.14.6.6.6.6.6.6.2.m1.5.5" xref="S2.T1.14.6.6.6.6.6.6.2.m1.5.5.cmml">𝝍</mi><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.3.2.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.3.1.1.cmml">|</mo></mrow><mo id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.2.cmml">+</mo><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.cmml"><mi id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.3" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.2.cmml">​</mo><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.cmml">(</mo><mrow id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.cmml"><msub id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2.cmml"><mi id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2.2" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2.2.cmml">d</mi><mi id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2.3" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2.3.cmml">b</mi></msub><mo id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.1" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.1.cmml">+</mo><mn id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.3" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.3" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.2a" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.2.cmml">+</mo><mn id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.4" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.4.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.14.6.6.6.6.6.6.2.m1.7b"><apply id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7"><eq id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.3.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.3"></eq><apply id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1"><plus id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.2.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.2"></plus><apply id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.3.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.3.2"><abs id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.3.1.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.3.2.1"></abs><ci id="S2.T1.14.6.6.6.6.6.6.2.m1.1.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.1.1">𝝍</ci></apply><apply id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1"><plus id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.1"></plus><apply id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.2.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.2.2"><abs id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.2.1.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.2.2.1"></abs><ci id="S2.T1.14.6.6.6.6.6.6.2.m1.2.2.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.2.2">𝝁</ci></apply><apply id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.3.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.3.2"><abs id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.3.1.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.1.1.1.3.2.1"></abs><ci id="S2.T1.14.6.6.6.6.6.6.2.m1.3.3.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.3.3">𝚺</ci></apply></apply><apply id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.4.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.4.2"><abs id="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.4.1.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.6.6.1.4.2.1"></abs><ci id="S2.T1.14.6.6.6.6.6.6.2.m1.4.4.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.4.4">𝑒</ci></apply></apply><apply id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2"><plus id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.2.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.2"></plus><apply id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.3.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.3.2"><abs id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.3.1.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.3.2.1"></abs><ci id="S2.T1.14.6.6.6.6.6.6.2.m1.5.5.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.5.5">𝝍</ci></apply><apply id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1"><times id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.2.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.2"></times><ci id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.3.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.3">𝐶</ci><apply id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1"><plus id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.1"></plus><apply id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2.1.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2">subscript</csymbol><ci id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2.2.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2.2">𝑑</ci><ci id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2.3.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.2.3">𝑏</ci></apply><cn type="integer" id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.3.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.1.1.1.1.3">1</cn></apply></apply><cn type="integer" id="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.4.cmml" xref="S2.T1.14.6.6.6.6.6.6.2.m1.7.7.2.4">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.14.6.6.6.6.6.6.2.m1.7c">|{\bm{\psi}}|+(|{\bm{\mu}}|+|{\bm{\Sigma}}|)+|e|=|{\bm{\psi}}|+C(d_{b}+1)+2</annotation></semantics></math></span>
<span id="S2.T1.14.6.6.6.6.6.6.4" class="ltx_td ltx_align_center">32,140</span></span>
<span id="S2.T1.16.8.8.8.8.8.8" class="ltx_tr">
<span id="S2.T1.16.8.8.8.8.8.8.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="S2.T1.16.8.8.8.8.8.8.3.1" class="ltx_text ltx_font_smallcaps">FiT</span> - ProtoNets</span>
<span id="S2.T1.15.7.7.7.7.7.7.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S2.T1.15.7.7.7.7.7.7.1.m1.1" class="ltx_Math" alttext="|{\bm{\theta}}|" display="inline"><semantics id="S2.T1.15.7.7.7.7.7.7.1.m1.1a"><mrow id="S2.T1.15.7.7.7.7.7.7.1.m1.1.2.2" xref="S2.T1.15.7.7.7.7.7.7.1.m1.1.2.1.cmml"><mo stretchy="false" id="S2.T1.15.7.7.7.7.7.7.1.m1.1.2.2.1" xref="S2.T1.15.7.7.7.7.7.7.1.m1.1.2.1.1.cmml">|</mo><mi id="S2.T1.15.7.7.7.7.7.7.1.m1.1.1" xref="S2.T1.15.7.7.7.7.7.7.1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S2.T1.15.7.7.7.7.7.7.1.m1.1.2.2.2" xref="S2.T1.15.7.7.7.7.7.7.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.15.7.7.7.7.7.7.1.m1.1b"><apply id="S2.T1.15.7.7.7.7.7.7.1.m1.1.2.1.cmml" xref="S2.T1.15.7.7.7.7.7.7.1.m1.1.2.2"><abs id="S2.T1.15.7.7.7.7.7.7.1.m1.1.2.1.1.cmml" xref="S2.T1.15.7.7.7.7.7.7.1.m1.1.2.2.1"></abs><ci id="S2.T1.15.7.7.7.7.7.7.1.m1.1.1.cmml" xref="S2.T1.15.7.7.7.7.7.7.1.m1.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.15.7.7.7.7.7.7.1.m1.1c">|{\bm{\theta}}|</annotation></semantics></math></span>
<span id="S2.T1.16.8.8.8.8.8.8.2" class="ltx_td ltx_align_center ltx_border_bb"><math id="S2.T1.16.8.8.8.8.8.8.2.m1.3" class="ltx_Math" alttext="|{\bm{\psi}}|+|{\bm{\mu}}|=|{\bm{\psi}}|+Cd_{b}" display="inline"><semantics id="S2.T1.16.8.8.8.8.8.8.2.m1.3a"><mrow id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.cmml"><mrow id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.cmml"><mrow id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.2.2" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.2.1.cmml"><mo stretchy="false" id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.2.2.1" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.2.1.1.cmml">|</mo><mi id="S2.T1.16.8.8.8.8.8.8.2.m1.1.1" xref="S2.T1.16.8.8.8.8.8.8.2.m1.1.1.cmml">𝝍</mi><mo stretchy="false" id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.2.2.2" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.2.1.1.cmml">|</mo></mrow><mo id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.1" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.1.cmml">+</mo><mrow id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.3.2" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.3.1.cmml"><mo stretchy="false" id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.3.2.1" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.3.1.1.cmml">|</mo><mi id="S2.T1.16.8.8.8.8.8.8.2.m1.2.2" xref="S2.T1.16.8.8.8.8.8.8.2.m1.2.2.cmml">𝝁</mi><mo stretchy="false" id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.3.2.2" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.3.1.1.cmml">|</mo></mrow></mrow><mo id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.1" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.1.cmml">=</mo><mrow id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.cmml"><mrow id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.2.2" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.2.1.cmml"><mo stretchy="false" id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.2.2.1" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.2.1.1.cmml">|</mo><mi id="S2.T1.16.8.8.8.8.8.8.2.m1.3.3" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.3.cmml">𝝍</mi><mo stretchy="false" id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.2.2.2" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.2.1.1.cmml">|</mo></mrow><mo id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.1" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.1.cmml">+</mo><mrow id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.cmml"><mi id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.2" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.1" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.1.cmml">​</mo><msub id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3.cmml"><mi id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3.2" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3.2.cmml">d</mi><mi id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3.3" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3.3.cmml">b</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.16.8.8.8.8.8.8.2.m1.3b"><apply id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4"><eq id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.1.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.1"></eq><apply id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2"><plus id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.1.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.1"></plus><apply id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.2.1.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.2.2"><abs id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.2.1.1.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.2.2.1"></abs><ci id="S2.T1.16.8.8.8.8.8.8.2.m1.1.1.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.1.1">𝝍</ci></apply><apply id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.3.1.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.3.2"><abs id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.3.1.1.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.2.3.2.1"></abs><ci id="S2.T1.16.8.8.8.8.8.8.2.m1.2.2.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.2.2">𝝁</ci></apply></apply><apply id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3"><plus id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.1.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.1"></plus><apply id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.2.1.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.2.2"><abs id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.2.1.1.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.2.2.1"></abs><ci id="S2.T1.16.8.8.8.8.8.8.2.m1.3.3.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.3">𝝍</ci></apply><apply id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3"><times id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.1.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.1"></times><ci id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.2.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.2">𝐶</ci><apply id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3"><csymbol cd="ambiguous" id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3.1.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3">subscript</csymbol><ci id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3.2.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3.2">𝑑</ci><ci id="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3.3.cmml" xref="S2.T1.16.8.8.8.8.8.8.2.m1.3.4.3.3.3.3">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.16.8.8.8.8.8.8.2.m1.3c">|{\bm{\psi}}|+|{\bm{\mu}}|=|{\bm{\psi}}|+Cd_{b}</annotation></semantics></math></span>
<span id="S2.T1.16.8.8.8.8.8.8.4" class="ltx_td ltx_align_center ltx_border_bb">32,128</span></span>
</span>
</span></span></span>
</span></span></span></p>
</figure>
<div id="S2.p7" class="ltx_para">
<p id="S2.p7.1" class="ltx_p">An empirical justification for the use of the <span id="S2.p7.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA head is shown in <a href="#S2.F2.sf1" title="In Figure 2 ‣ 2 FiLM Transfer (FiT) ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(a)</span></a> where it outperforms a linear head in the case of FiLM and when all the backbone parameters are learned.
Refer to <a href="#A1.T5" title="In A.5.1 VTAB-1k Task Ablations ‣ A.5 Additional VTAB-1k Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.5</span></a> for details.
In <a href="#S2.F2.sf2" title="In Figure 2 ‣ 2 FiLM Transfer (FiT) ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(b)</span></a>, we see for both datasets, <span id="S2.p7.1.2" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA converges significantly faster than BiT, which uses a linear head.
The primary limitation of the Naive Bayes head is the higher (versus linear) computational cost due to having to invert a <math id="S2.p7.1.m1.1" class="ltx_Math" alttext="d_{b}\times d_{b}" display="inline"><semantics id="S2.p7.1.m1.1a"><mrow id="S2.p7.1.m1.1.1" xref="S2.p7.1.m1.1.1.cmml"><msub id="S2.p7.1.m1.1.1.2" xref="S2.p7.1.m1.1.1.2.cmml"><mi id="S2.p7.1.m1.1.1.2.2" xref="S2.p7.1.m1.1.1.2.2.cmml">d</mi><mi id="S2.p7.1.m1.1.1.2.3" xref="S2.p7.1.m1.1.1.2.3.cmml">b</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.p7.1.m1.1.1.1" xref="S2.p7.1.m1.1.1.1.cmml">×</mo><msub id="S2.p7.1.m1.1.1.3" xref="S2.p7.1.m1.1.1.3.cmml"><mi id="S2.p7.1.m1.1.1.3.2" xref="S2.p7.1.m1.1.1.3.2.cmml">d</mi><mi id="S2.p7.1.m1.1.1.3.3" xref="S2.p7.1.m1.1.1.3.3.cmml">b</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p7.1.m1.1b"><apply id="S2.p7.1.m1.1.1.cmml" xref="S2.p7.1.m1.1.1"><times id="S2.p7.1.m1.1.1.1.cmml" xref="S2.p7.1.m1.1.1.1"></times><apply id="S2.p7.1.m1.1.1.2.cmml" xref="S2.p7.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.p7.1.m1.1.1.2.1.cmml" xref="S2.p7.1.m1.1.1.2">subscript</csymbol><ci id="S2.p7.1.m1.1.1.2.2.cmml" xref="S2.p7.1.m1.1.1.2.2">𝑑</ci><ci id="S2.p7.1.m1.1.1.2.3.cmml" xref="S2.p7.1.m1.1.1.2.3">𝑏</ci></apply><apply id="S2.p7.1.m1.1.1.3.cmml" xref="S2.p7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p7.1.m1.1.1.3.1.cmml" xref="S2.p7.1.m1.1.1.3">subscript</csymbol><ci id="S2.p7.1.m1.1.1.3.2.cmml" xref="S2.p7.1.m1.1.1.3.2">𝑑</ci><ci id="S2.p7.1.m1.1.1.3.3.cmml" xref="S2.p7.1.m1.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.1.m1.1c">d_{b}\times d_{b}</annotation></semantics></math> covariance matrix on each training iteration.</p>
</div>
<figure id="S2.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S2.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.08671/assets/x2.png" id="S2.F2.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="423" height="240" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>LDA outperforms linear head.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S2.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.08671/assets/x3.png" id="S2.F2.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="423" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span><span id="S2.F2.sf2.2.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA converges more quickly than BiT.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>(a) Average accuracy on VTAB-1k for linear and LDA heads versus learnable parameters in the backbone. (b) Test accuracy versus training iteration for CIFAR100 and SVHN on VTAB-1k.</figcaption>
</figure>
<div id="S2.p8" class="ltx_para ltx_noindent">
<p id="S2.p8.40" class="ltx_p"><span id="S2.p8.40.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FiT<span id="S2.p8.40.1.1" class="ltx_text ltx_font_upright"> Training</span></span>

We learn the FiLM parameters <math id="S2.p8.1.m1.1" class="ltx_Math" alttext="{\bm{\psi}}" display="inline"><semantics id="S2.p8.1.m1.1a"><mi id="S2.p8.1.m1.1.1" xref="S2.p8.1.m1.1.1.cmml">𝝍</mi><annotation-xml encoding="MathML-Content" id="S2.p8.1.m1.1b"><ci id="S2.p8.1.m1.1.1.cmml" xref="S2.p8.1.m1.1.1">𝝍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.1.m1.1c">{\bm{\psi}}</annotation></semantics></math> and the covariance weights <math id="S2.p8.2.m2.1" class="ltx_Math" alttext="{\bm{e}}" display="inline"><semantics id="S2.p8.2.m2.1a"><mi id="S2.p8.2.m2.1.1" xref="S2.p8.2.m2.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="S2.p8.2.m2.1b"><ci id="S2.p8.2.m2.1.1.cmml" xref="S2.p8.2.m2.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.2.m2.1c">{\bm{e}}</annotation></semantics></math> via fine-tuning (parameters <math id="S2.p8.3.m3.1" class="ltx_Math" alttext="{\bm{\theta}}" display="inline"><semantics id="S2.p8.3.m3.1a"><mi id="S2.p8.3.m3.1.1" xref="S2.p8.3.m3.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.p8.3.m3.1b"><ci id="S2.p8.3.m3.1.1.cmml" xref="S2.p8.3.m3.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.3.m3.1c">{\bm{\theta}}</annotation></semantics></math> are fixed from pretraining). One approach would be to apply standard batch training on the downstream dataset, however it was hard to balance under- and over-fitting using this setup. Instead, we found that an approach inspired by <span id="S2.p8.40.2" class="ltx_text ltx_font_italic">episodic training</span> <cite class="ltx_cite ltx_citemacro_citep">(Vinyals et al., <a href="#bib.bib59" title="" class="ltx_ref">2016</a>)</cite> that is often used in meta-learning yielded better performance. We refer to this approach as <span id="S2.p8.40.3" class="ltx_text ltx_font_italic">episodic fine tuning</span> and it works as follows.
Note that we require ‘training’ data to compute <math id="S2.p8.4.m4.1" class="ltx_Math" alttext="{\bm{\pi}}" display="inline"><semantics id="S2.p8.4.m4.1a"><mi id="S2.p8.4.m4.1.1" xref="S2.p8.4.m4.1.1.cmml">𝝅</mi><annotation-xml encoding="MathML-Content" id="S2.p8.4.m4.1b"><ci id="S2.p8.4.m4.1.1.cmml" xref="S2.p8.4.m4.1.1">𝝅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.4.m4.1c">{\bm{\pi}}</annotation></semantics></math>, <math id="S2.p8.5.m5.1" class="ltx_Math" alttext="{\bm{\mu}}" display="inline"><semantics id="S2.p8.5.m5.1a"><mi id="S2.p8.5.m5.1.1" xref="S2.p8.5.m5.1.1.cmml">𝝁</mi><annotation-xml encoding="MathML-Content" id="S2.p8.5.m5.1b"><ci id="S2.p8.5.m5.1.1.cmml" xref="S2.p8.5.m5.1.1">𝝁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.5.m5.1c">{\bm{\mu}}</annotation></semantics></math>, <math id="S2.p8.6.m6.1" class="ltx_Math" alttext="{\bm{\Sigma}}" display="inline"><semantics id="S2.p8.6.m6.1a"><mi id="S2.p8.6.m6.1.1" xref="S2.p8.6.m6.1.1.cmml">𝚺</mi><annotation-xml encoding="MathML-Content" id="S2.p8.6.m6.1b"><ci id="S2.p8.6.m6.1.1.cmml" xref="S2.p8.6.m6.1.1">𝚺</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.6.m6.1c">{\bm{\Sigma}}</annotation></semantics></math> to configure the head, and a ‘test’ set to optimize <math id="S2.p8.7.m7.1" class="ltx_Math" alttext="{\bm{\psi}}" display="inline"><semantics id="S2.p8.7.m7.1a"><mi id="S2.p8.7.m7.1.1" xref="S2.p8.7.m7.1.1.cmml">𝝍</mi><annotation-xml encoding="MathML-Content" id="S2.p8.7.m7.1b"><ci id="S2.p8.7.m7.1.1.cmml" xref="S2.p8.7.m7.1.1">𝝍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.7.m7.1c">{\bm{\psi}}</annotation></semantics></math> and <math id="S2.p8.8.m8.1" class="ltx_Math" alttext="{\bm{e}}" display="inline"><semantics id="S2.p8.8.m8.1a"><mi id="S2.p8.8.m8.1.1" xref="S2.p8.8.m8.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="S2.p8.8.m8.1b"><ci id="S2.p8.8.m8.1.1.cmml" xref="S2.p8.8.m8.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.8.m8.1c">{\bm{e}}</annotation></semantics></math> via gradient ascent.
Thus, from the downstream dataset <math id="S2.p8.9.m9.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.p8.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p8.9.m9.1.1" xref="S2.p8.9.m9.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p8.9.m9.1b"><ci id="S2.p8.9.m9.1.1.cmml" xref="S2.p8.9.m9.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.9.m9.1c">\mathcal{D}</annotation></semantics></math>, we derive two sets – <math id="S2.p8.10.m10.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="S2.p8.10.m10.1a"><msub id="S2.p8.10.m10.1.1" xref="S2.p8.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.10.m10.1.1.2" xref="S2.p8.10.m10.1.1.2.cmml">𝒟</mi><mrow id="S2.p8.10.m10.1.1.3" xref="S2.p8.10.m10.1.1.3.cmml"><mi id="S2.p8.10.m10.1.1.3.2" xref="S2.p8.10.m10.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.10.m10.1.1.3.1" xref="S2.p8.10.m10.1.1.3.1.cmml">​</mo><mi id="S2.p8.10.m10.1.1.3.3" xref="S2.p8.10.m10.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.p8.10.m10.1.1.3.1a" xref="S2.p8.10.m10.1.1.3.1.cmml">​</mo><mi id="S2.p8.10.m10.1.1.3.4" xref="S2.p8.10.m10.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.p8.10.m10.1.1.3.1b" xref="S2.p8.10.m10.1.1.3.1.cmml">​</mo><mi id="S2.p8.10.m10.1.1.3.5" xref="S2.p8.10.m10.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p8.10.m10.1.1.3.1c" xref="S2.p8.10.m10.1.1.3.1.cmml">​</mo><mi id="S2.p8.10.m10.1.1.3.6" xref="S2.p8.10.m10.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p8.10.m10.1b"><apply id="S2.p8.10.m10.1.1.cmml" xref="S2.p8.10.m10.1.1"><csymbol cd="ambiguous" id="S2.p8.10.m10.1.1.1.cmml" xref="S2.p8.10.m10.1.1">subscript</csymbol><ci id="S2.p8.10.m10.1.1.2.cmml" xref="S2.p8.10.m10.1.1.2">𝒟</ci><apply id="S2.p8.10.m10.1.1.3.cmml" xref="S2.p8.10.m10.1.1.3"><times id="S2.p8.10.m10.1.1.3.1.cmml" xref="S2.p8.10.m10.1.1.3.1"></times><ci id="S2.p8.10.m10.1.1.3.2.cmml" xref="S2.p8.10.m10.1.1.3.2">𝑡</ci><ci id="S2.p8.10.m10.1.1.3.3.cmml" xref="S2.p8.10.m10.1.1.3.3">𝑟</ci><ci id="S2.p8.10.m10.1.1.3.4.cmml" xref="S2.p8.10.m10.1.1.3.4">𝑎</ci><ci id="S2.p8.10.m10.1.1.3.5.cmml" xref="S2.p8.10.m10.1.1.3.5">𝑖</ci><ci id="S2.p8.10.m10.1.1.3.6.cmml" xref="S2.p8.10.m10.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.10.m10.1c">\mathcal{D}_{train}</annotation></semantics></math> and <math id="S2.p8.11.m11.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="S2.p8.11.m11.1a"><msub id="S2.p8.11.m11.1.1" xref="S2.p8.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.11.m11.1.1.2" xref="S2.p8.11.m11.1.1.2.cmml">𝒟</mi><mrow id="S2.p8.11.m11.1.1.3" xref="S2.p8.11.m11.1.1.3.cmml"><mi id="S2.p8.11.m11.1.1.3.2" xref="S2.p8.11.m11.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.11.m11.1.1.3.1" xref="S2.p8.11.m11.1.1.3.1.cmml">​</mo><mi id="S2.p8.11.m11.1.1.3.3" xref="S2.p8.11.m11.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.p8.11.m11.1.1.3.1a" xref="S2.p8.11.m11.1.1.3.1.cmml">​</mo><mi id="S2.p8.11.m11.1.1.3.4" xref="S2.p8.11.m11.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.p8.11.m11.1.1.3.1b" xref="S2.p8.11.m11.1.1.3.1.cmml">​</mo><mi id="S2.p8.11.m11.1.1.3.5" xref="S2.p8.11.m11.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p8.11.m11.1b"><apply id="S2.p8.11.m11.1.1.cmml" xref="S2.p8.11.m11.1.1"><csymbol cd="ambiguous" id="S2.p8.11.m11.1.1.1.cmml" xref="S2.p8.11.m11.1.1">subscript</csymbol><ci id="S2.p8.11.m11.1.1.2.cmml" xref="S2.p8.11.m11.1.1.2">𝒟</ci><apply id="S2.p8.11.m11.1.1.3.cmml" xref="S2.p8.11.m11.1.1.3"><times id="S2.p8.11.m11.1.1.3.1.cmml" xref="S2.p8.11.m11.1.1.3.1"></times><ci id="S2.p8.11.m11.1.1.3.2.cmml" xref="S2.p8.11.m11.1.1.3.2">𝑡</ci><ci id="S2.p8.11.m11.1.1.3.3.cmml" xref="S2.p8.11.m11.1.1.3.3">𝑒</ci><ci id="S2.p8.11.m11.1.1.3.4.cmml" xref="S2.p8.11.m11.1.1.3.4">𝑠</ci><ci id="S2.p8.11.m11.1.1.3.5.cmml" xref="S2.p8.11.m11.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.11.m11.1c">\mathcal{D}_{test}</annotation></semantics></math>.
If <math id="S2.p8.12.m12.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.p8.12.m12.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p8.12.m12.1.1" xref="S2.p8.12.m12.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p8.12.m12.1b"><ci id="S2.p8.12.m12.1.1.cmml" xref="S2.p8.12.m12.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.12.m12.1c">\mathcal{D}</annotation></semantics></math> is sufficiently large (<math id="S2.p8.13.m13.1" class="ltx_Math" alttext="|\mathcal{D}|\approx" display="inline"><semantics id="S2.p8.13.m13.1a"><mrow id="S2.p8.13.m13.1.2" xref="S2.p8.13.m13.1.2.cmml"><mrow id="S2.p8.13.m13.1.2.2.2" xref="S2.p8.13.m13.1.2.2.1.cmml"><mo stretchy="false" id="S2.p8.13.m13.1.2.2.2.1" xref="S2.p8.13.m13.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.p8.13.m13.1.1" xref="S2.p8.13.m13.1.1.cmml">𝒟</mi><mo stretchy="false" id="S2.p8.13.m13.1.2.2.2.2" xref="S2.p8.13.m13.1.2.2.1.1.cmml">|</mo></mrow><mo id="S2.p8.13.m13.1.2.1" xref="S2.p8.13.m13.1.2.1.cmml">≈</mo><mi id="S2.p8.13.m13.1.2.3" xref="S2.p8.13.m13.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.13.m13.1b"><apply id="S2.p8.13.m13.1.2.cmml" xref="S2.p8.13.m13.1.2"><approx id="S2.p8.13.m13.1.2.1.cmml" xref="S2.p8.13.m13.1.2.1"></approx><apply id="S2.p8.13.m13.1.2.2.1.cmml" xref="S2.p8.13.m13.1.2.2.2"><abs id="S2.p8.13.m13.1.2.2.1.1.cmml" xref="S2.p8.13.m13.1.2.2.2.1"></abs><ci id="S2.p8.13.m13.1.1.cmml" xref="S2.p8.13.m13.1.1">𝒟</ci></apply><csymbol cd="latexml" id="S2.p8.13.m13.1.2.3.cmml" xref="S2.p8.13.m13.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.13.m13.1c">|\mathcal{D}|\approx</annotation></semantics></math> 1000), such that overfitting is not an issue, we set <math id="S2.p8.14.m14.1" class="ltx_Math" alttext="\mathcal{D}_{train}=\mathcal{D}_{test}=\mathcal{D}" display="inline"><semantics id="S2.p8.14.m14.1a"><mrow id="S2.p8.14.m14.1.1" xref="S2.p8.14.m14.1.1.cmml"><msub id="S2.p8.14.m14.1.1.2" xref="S2.p8.14.m14.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.14.m14.1.1.2.2" xref="S2.p8.14.m14.1.1.2.2.cmml">𝒟</mi><mrow id="S2.p8.14.m14.1.1.2.3" xref="S2.p8.14.m14.1.1.2.3.cmml"><mi id="S2.p8.14.m14.1.1.2.3.2" xref="S2.p8.14.m14.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.14.m14.1.1.2.3.1" xref="S2.p8.14.m14.1.1.2.3.1.cmml">​</mo><mi id="S2.p8.14.m14.1.1.2.3.3" xref="S2.p8.14.m14.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.p8.14.m14.1.1.2.3.1a" xref="S2.p8.14.m14.1.1.2.3.1.cmml">​</mo><mi id="S2.p8.14.m14.1.1.2.3.4" xref="S2.p8.14.m14.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.p8.14.m14.1.1.2.3.1b" xref="S2.p8.14.m14.1.1.2.3.1.cmml">​</mo><mi id="S2.p8.14.m14.1.1.2.3.5" xref="S2.p8.14.m14.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p8.14.m14.1.1.2.3.1c" xref="S2.p8.14.m14.1.1.2.3.1.cmml">​</mo><mi id="S2.p8.14.m14.1.1.2.3.6" xref="S2.p8.14.m14.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="S2.p8.14.m14.1.1.3" xref="S2.p8.14.m14.1.1.3.cmml">=</mo><msub id="S2.p8.14.m14.1.1.4" xref="S2.p8.14.m14.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.14.m14.1.1.4.2" xref="S2.p8.14.m14.1.1.4.2.cmml">𝒟</mi><mrow id="S2.p8.14.m14.1.1.4.3" xref="S2.p8.14.m14.1.1.4.3.cmml"><mi id="S2.p8.14.m14.1.1.4.3.2" xref="S2.p8.14.m14.1.1.4.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.14.m14.1.1.4.3.1" xref="S2.p8.14.m14.1.1.4.3.1.cmml">​</mo><mi id="S2.p8.14.m14.1.1.4.3.3" xref="S2.p8.14.m14.1.1.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.p8.14.m14.1.1.4.3.1a" xref="S2.p8.14.m14.1.1.4.3.1.cmml">​</mo><mi id="S2.p8.14.m14.1.1.4.3.4" xref="S2.p8.14.m14.1.1.4.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.p8.14.m14.1.1.4.3.1b" xref="S2.p8.14.m14.1.1.4.3.1.cmml">​</mo><mi id="S2.p8.14.m14.1.1.4.3.5" xref="S2.p8.14.m14.1.1.4.3.5.cmml">t</mi></mrow></msub><mo id="S2.p8.14.m14.1.1.5" xref="S2.p8.14.m14.1.1.5.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S2.p8.14.m14.1.1.6" xref="S2.p8.14.m14.1.1.6.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.14.m14.1b"><apply id="S2.p8.14.m14.1.1.cmml" xref="S2.p8.14.m14.1.1"><and id="S2.p8.14.m14.1.1a.cmml" xref="S2.p8.14.m14.1.1"></and><apply id="S2.p8.14.m14.1.1b.cmml" xref="S2.p8.14.m14.1.1"><eq id="S2.p8.14.m14.1.1.3.cmml" xref="S2.p8.14.m14.1.1.3"></eq><apply id="S2.p8.14.m14.1.1.2.cmml" xref="S2.p8.14.m14.1.1.2"><csymbol cd="ambiguous" id="S2.p8.14.m14.1.1.2.1.cmml" xref="S2.p8.14.m14.1.1.2">subscript</csymbol><ci id="S2.p8.14.m14.1.1.2.2.cmml" xref="S2.p8.14.m14.1.1.2.2">𝒟</ci><apply id="S2.p8.14.m14.1.1.2.3.cmml" xref="S2.p8.14.m14.1.1.2.3"><times id="S2.p8.14.m14.1.1.2.3.1.cmml" xref="S2.p8.14.m14.1.1.2.3.1"></times><ci id="S2.p8.14.m14.1.1.2.3.2.cmml" xref="S2.p8.14.m14.1.1.2.3.2">𝑡</ci><ci id="S2.p8.14.m14.1.1.2.3.3.cmml" xref="S2.p8.14.m14.1.1.2.3.3">𝑟</ci><ci id="S2.p8.14.m14.1.1.2.3.4.cmml" xref="S2.p8.14.m14.1.1.2.3.4">𝑎</ci><ci id="S2.p8.14.m14.1.1.2.3.5.cmml" xref="S2.p8.14.m14.1.1.2.3.5">𝑖</ci><ci id="S2.p8.14.m14.1.1.2.3.6.cmml" xref="S2.p8.14.m14.1.1.2.3.6">𝑛</ci></apply></apply><apply id="S2.p8.14.m14.1.1.4.cmml" xref="S2.p8.14.m14.1.1.4"><csymbol cd="ambiguous" id="S2.p8.14.m14.1.1.4.1.cmml" xref="S2.p8.14.m14.1.1.4">subscript</csymbol><ci id="S2.p8.14.m14.1.1.4.2.cmml" xref="S2.p8.14.m14.1.1.4.2">𝒟</ci><apply id="S2.p8.14.m14.1.1.4.3.cmml" xref="S2.p8.14.m14.1.1.4.3"><times id="S2.p8.14.m14.1.1.4.3.1.cmml" xref="S2.p8.14.m14.1.1.4.3.1"></times><ci id="S2.p8.14.m14.1.1.4.3.2.cmml" xref="S2.p8.14.m14.1.1.4.3.2">𝑡</ci><ci id="S2.p8.14.m14.1.1.4.3.3.cmml" xref="S2.p8.14.m14.1.1.4.3.3">𝑒</ci><ci id="S2.p8.14.m14.1.1.4.3.4.cmml" xref="S2.p8.14.m14.1.1.4.3.4">𝑠</ci><ci id="S2.p8.14.m14.1.1.4.3.5.cmml" xref="S2.p8.14.m14.1.1.4.3.5">𝑡</ci></apply></apply></apply><apply id="S2.p8.14.m14.1.1c.cmml" xref="S2.p8.14.m14.1.1"><eq id="S2.p8.14.m14.1.1.5.cmml" xref="S2.p8.14.m14.1.1.5"></eq><share href="#S2.p8.14.m14.1.1.4.cmml" id="S2.p8.14.m14.1.1d.cmml" xref="S2.p8.14.m14.1.1"></share><ci id="S2.p8.14.m14.1.1.6.cmml" xref="S2.p8.14.m14.1.1.6">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.14.m14.1c">\mathcal{D}_{train}=\mathcal{D}_{test}=\mathcal{D}</annotation></semantics></math>.
Otherwise, in the few-shot scenario, we randomly split <math id="S2.p8.15.m15.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.p8.15.m15.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p8.15.m15.1.1" xref="S2.p8.15.m15.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p8.15.m15.1b"><ci id="S2.p8.15.m15.1.1.cmml" xref="S2.p8.15.m15.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.15.m15.1c">\mathcal{D}</annotation></semantics></math> into <math id="S2.p8.16.m16.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="S2.p8.16.m16.1a"><msub id="S2.p8.16.m16.1.1" xref="S2.p8.16.m16.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.16.m16.1.1.2" xref="S2.p8.16.m16.1.1.2.cmml">𝒟</mi><mrow id="S2.p8.16.m16.1.1.3" xref="S2.p8.16.m16.1.1.3.cmml"><mi id="S2.p8.16.m16.1.1.3.2" xref="S2.p8.16.m16.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.16.m16.1.1.3.1" xref="S2.p8.16.m16.1.1.3.1.cmml">​</mo><mi id="S2.p8.16.m16.1.1.3.3" xref="S2.p8.16.m16.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.p8.16.m16.1.1.3.1a" xref="S2.p8.16.m16.1.1.3.1.cmml">​</mo><mi id="S2.p8.16.m16.1.1.3.4" xref="S2.p8.16.m16.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.p8.16.m16.1.1.3.1b" xref="S2.p8.16.m16.1.1.3.1.cmml">​</mo><mi id="S2.p8.16.m16.1.1.3.5" xref="S2.p8.16.m16.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p8.16.m16.1.1.3.1c" xref="S2.p8.16.m16.1.1.3.1.cmml">​</mo><mi id="S2.p8.16.m16.1.1.3.6" xref="S2.p8.16.m16.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p8.16.m16.1b"><apply id="S2.p8.16.m16.1.1.cmml" xref="S2.p8.16.m16.1.1"><csymbol cd="ambiguous" id="S2.p8.16.m16.1.1.1.cmml" xref="S2.p8.16.m16.1.1">subscript</csymbol><ci id="S2.p8.16.m16.1.1.2.cmml" xref="S2.p8.16.m16.1.1.2">𝒟</ci><apply id="S2.p8.16.m16.1.1.3.cmml" xref="S2.p8.16.m16.1.1.3"><times id="S2.p8.16.m16.1.1.3.1.cmml" xref="S2.p8.16.m16.1.1.3.1"></times><ci id="S2.p8.16.m16.1.1.3.2.cmml" xref="S2.p8.16.m16.1.1.3.2">𝑡</ci><ci id="S2.p8.16.m16.1.1.3.3.cmml" xref="S2.p8.16.m16.1.1.3.3">𝑟</ci><ci id="S2.p8.16.m16.1.1.3.4.cmml" xref="S2.p8.16.m16.1.1.3.4">𝑎</ci><ci id="S2.p8.16.m16.1.1.3.5.cmml" xref="S2.p8.16.m16.1.1.3.5">𝑖</ci><ci id="S2.p8.16.m16.1.1.3.6.cmml" xref="S2.p8.16.m16.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.16.m16.1c">\mathcal{D}_{train}</annotation></semantics></math> and <math id="S2.p8.17.m17.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="S2.p8.17.m17.1a"><msub id="S2.p8.17.m17.1.1" xref="S2.p8.17.m17.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.17.m17.1.1.2" xref="S2.p8.17.m17.1.1.2.cmml">𝒟</mi><mrow id="S2.p8.17.m17.1.1.3" xref="S2.p8.17.m17.1.1.3.cmml"><mi id="S2.p8.17.m17.1.1.3.2" xref="S2.p8.17.m17.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.17.m17.1.1.3.1" xref="S2.p8.17.m17.1.1.3.1.cmml">​</mo><mi id="S2.p8.17.m17.1.1.3.3" xref="S2.p8.17.m17.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.p8.17.m17.1.1.3.1a" xref="S2.p8.17.m17.1.1.3.1.cmml">​</mo><mi id="S2.p8.17.m17.1.1.3.4" xref="S2.p8.17.m17.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.p8.17.m17.1.1.3.1b" xref="S2.p8.17.m17.1.1.3.1.cmml">​</mo><mi id="S2.p8.17.m17.1.1.3.5" xref="S2.p8.17.m17.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p8.17.m17.1b"><apply id="S2.p8.17.m17.1.1.cmml" xref="S2.p8.17.m17.1.1"><csymbol cd="ambiguous" id="S2.p8.17.m17.1.1.1.cmml" xref="S2.p8.17.m17.1.1">subscript</csymbol><ci id="S2.p8.17.m17.1.1.2.cmml" xref="S2.p8.17.m17.1.1.2">𝒟</ci><apply id="S2.p8.17.m17.1.1.3.cmml" xref="S2.p8.17.m17.1.1.3"><times id="S2.p8.17.m17.1.1.3.1.cmml" xref="S2.p8.17.m17.1.1.3.1"></times><ci id="S2.p8.17.m17.1.1.3.2.cmml" xref="S2.p8.17.m17.1.1.3.2">𝑡</ci><ci id="S2.p8.17.m17.1.1.3.3.cmml" xref="S2.p8.17.m17.1.1.3.3">𝑒</ci><ci id="S2.p8.17.m17.1.1.3.4.cmml" xref="S2.p8.17.m17.1.1.3.4">𝑠</ci><ci id="S2.p8.17.m17.1.1.3.5.cmml" xref="S2.p8.17.m17.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.17.m17.1c">\mathcal{D}_{test}</annotation></semantics></math> such that the number of examples or <span id="S2.p8.40.4" class="ltx_text ltx_font_italic">shots</span> in each class <math id="S2.p8.18.m18.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.p8.18.m18.1a"><mi id="S2.p8.18.m18.1.1" xref="S2.p8.18.m18.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.p8.18.m18.1b"><ci id="S2.p8.18.m18.1.1.cmml" xref="S2.p8.18.m18.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.18.m18.1c">c</annotation></semantics></math> are roughy equal in both partitions and that there is at least one example of each class in both.
Refer to <a href="#alg1" title="In A.10 FiT Training Algorithms ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">A.1</span></a> for details.
For each training iteration, we sample a task <math id="S2.p8.19.m19.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S2.p8.19.m19.1a"><mi id="S2.p8.19.m19.1.1" xref="S2.p8.19.m19.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S2.p8.19.m19.1b"><ci id="S2.p8.19.m19.1.1.cmml" xref="S2.p8.19.m19.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.19.m19.1c">\tau</annotation></semantics></math> consisting of a <span id="S2.p8.40.5" class="ltx_text ltx_font_italic">support</span> set <math id="S2.p8.20.m20.1" class="ltx_Math" alttext="\mathcal{D}_{S}^{\tau}" display="inline"><semantics id="S2.p8.20.m20.1a"><msubsup id="S2.p8.20.m20.1.1" xref="S2.p8.20.m20.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.20.m20.1.1.2.2" xref="S2.p8.20.m20.1.1.2.2.cmml">𝒟</mi><mi id="S2.p8.20.m20.1.1.2.3" xref="S2.p8.20.m20.1.1.2.3.cmml">S</mi><mi id="S2.p8.20.m20.1.1.3" xref="S2.p8.20.m20.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p8.20.m20.1b"><apply id="S2.p8.20.m20.1.1.cmml" xref="S2.p8.20.m20.1.1"><csymbol cd="ambiguous" id="S2.p8.20.m20.1.1.1.cmml" xref="S2.p8.20.m20.1.1">superscript</csymbol><apply id="S2.p8.20.m20.1.1.2.cmml" xref="S2.p8.20.m20.1.1"><csymbol cd="ambiguous" id="S2.p8.20.m20.1.1.2.1.cmml" xref="S2.p8.20.m20.1.1">subscript</csymbol><ci id="S2.p8.20.m20.1.1.2.2.cmml" xref="S2.p8.20.m20.1.1.2.2">𝒟</ci><ci id="S2.p8.20.m20.1.1.2.3.cmml" xref="S2.p8.20.m20.1.1.2.3">𝑆</ci></apply><ci id="S2.p8.20.m20.1.1.3.cmml" xref="S2.p8.20.m20.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.20.m20.1c">\mathcal{D}_{S}^{\tau}</annotation></semantics></math> drawn from <math id="S2.p8.21.m21.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="S2.p8.21.m21.1a"><msub id="S2.p8.21.m21.1.1" xref="S2.p8.21.m21.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.21.m21.1.1.2" xref="S2.p8.21.m21.1.1.2.cmml">𝒟</mi><mrow id="S2.p8.21.m21.1.1.3" xref="S2.p8.21.m21.1.1.3.cmml"><mi id="S2.p8.21.m21.1.1.3.2" xref="S2.p8.21.m21.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.21.m21.1.1.3.1" xref="S2.p8.21.m21.1.1.3.1.cmml">​</mo><mi id="S2.p8.21.m21.1.1.3.3" xref="S2.p8.21.m21.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.p8.21.m21.1.1.3.1a" xref="S2.p8.21.m21.1.1.3.1.cmml">​</mo><mi id="S2.p8.21.m21.1.1.3.4" xref="S2.p8.21.m21.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.p8.21.m21.1.1.3.1b" xref="S2.p8.21.m21.1.1.3.1.cmml">​</mo><mi id="S2.p8.21.m21.1.1.3.5" xref="S2.p8.21.m21.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p8.21.m21.1.1.3.1c" xref="S2.p8.21.m21.1.1.3.1.cmml">​</mo><mi id="S2.p8.21.m21.1.1.3.6" xref="S2.p8.21.m21.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p8.21.m21.1b"><apply id="S2.p8.21.m21.1.1.cmml" xref="S2.p8.21.m21.1.1"><csymbol cd="ambiguous" id="S2.p8.21.m21.1.1.1.cmml" xref="S2.p8.21.m21.1.1">subscript</csymbol><ci id="S2.p8.21.m21.1.1.2.cmml" xref="S2.p8.21.m21.1.1.2">𝒟</ci><apply id="S2.p8.21.m21.1.1.3.cmml" xref="S2.p8.21.m21.1.1.3"><times id="S2.p8.21.m21.1.1.3.1.cmml" xref="S2.p8.21.m21.1.1.3.1"></times><ci id="S2.p8.21.m21.1.1.3.2.cmml" xref="S2.p8.21.m21.1.1.3.2">𝑡</ci><ci id="S2.p8.21.m21.1.1.3.3.cmml" xref="S2.p8.21.m21.1.1.3.3">𝑟</ci><ci id="S2.p8.21.m21.1.1.3.4.cmml" xref="S2.p8.21.m21.1.1.3.4">𝑎</ci><ci id="S2.p8.21.m21.1.1.3.5.cmml" xref="S2.p8.21.m21.1.1.3.5">𝑖</ci><ci id="S2.p8.21.m21.1.1.3.6.cmml" xref="S2.p8.21.m21.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.21.m21.1c">\mathcal{D}_{train}</annotation></semantics></math> with <math id="S2.p8.22.m22.1" class="ltx_Math" alttext="S_{\tau}" display="inline"><semantics id="S2.p8.22.m22.1a"><msub id="S2.p8.22.m22.1.1" xref="S2.p8.22.m22.1.1.cmml"><mi id="S2.p8.22.m22.1.1.2" xref="S2.p8.22.m22.1.1.2.cmml">S</mi><mi id="S2.p8.22.m22.1.1.3" xref="S2.p8.22.m22.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p8.22.m22.1b"><apply id="S2.p8.22.m22.1.1.cmml" xref="S2.p8.22.m22.1.1"><csymbol cd="ambiguous" id="S2.p8.22.m22.1.1.1.cmml" xref="S2.p8.22.m22.1.1">subscript</csymbol><ci id="S2.p8.22.m22.1.1.2.cmml" xref="S2.p8.22.m22.1.1.2">𝑆</ci><ci id="S2.p8.22.m22.1.1.3.cmml" xref="S2.p8.22.m22.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.22.m22.1c">S_{\tau}</annotation></semantics></math> examples and a <span id="S2.p8.40.6" class="ltx_text ltx_font_italic">query</span> <math id="S2.p8.23.m23.1" class="ltx_Math" alttext="\mathcal{D}_{Q}^{\tau}" display="inline"><semantics id="S2.p8.23.m23.1a"><msubsup id="S2.p8.23.m23.1.1" xref="S2.p8.23.m23.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.23.m23.1.1.2.2" xref="S2.p8.23.m23.1.1.2.2.cmml">𝒟</mi><mi id="S2.p8.23.m23.1.1.2.3" xref="S2.p8.23.m23.1.1.2.3.cmml">Q</mi><mi id="S2.p8.23.m23.1.1.3" xref="S2.p8.23.m23.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p8.23.m23.1b"><apply id="S2.p8.23.m23.1.1.cmml" xref="S2.p8.23.m23.1.1"><csymbol cd="ambiguous" id="S2.p8.23.m23.1.1.1.cmml" xref="S2.p8.23.m23.1.1">superscript</csymbol><apply id="S2.p8.23.m23.1.1.2.cmml" xref="S2.p8.23.m23.1.1"><csymbol cd="ambiguous" id="S2.p8.23.m23.1.1.2.1.cmml" xref="S2.p8.23.m23.1.1">subscript</csymbol><ci id="S2.p8.23.m23.1.1.2.2.cmml" xref="S2.p8.23.m23.1.1.2.2">𝒟</ci><ci id="S2.p8.23.m23.1.1.2.3.cmml" xref="S2.p8.23.m23.1.1.2.3">𝑄</ci></apply><ci id="S2.p8.23.m23.1.1.3.cmml" xref="S2.p8.23.m23.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.23.m23.1c">\mathcal{D}_{Q}^{\tau}</annotation></semantics></math> set drawn from <math id="S2.p8.24.m24.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="S2.p8.24.m24.1a"><msub id="S2.p8.24.m24.1.1" xref="S2.p8.24.m24.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.24.m24.1.1.2" xref="S2.p8.24.m24.1.1.2.cmml">𝒟</mi><mrow id="S2.p8.24.m24.1.1.3" xref="S2.p8.24.m24.1.1.3.cmml"><mi id="S2.p8.24.m24.1.1.3.2" xref="S2.p8.24.m24.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.24.m24.1.1.3.1" xref="S2.p8.24.m24.1.1.3.1.cmml">​</mo><mi id="S2.p8.24.m24.1.1.3.3" xref="S2.p8.24.m24.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.p8.24.m24.1.1.3.1a" xref="S2.p8.24.m24.1.1.3.1.cmml">​</mo><mi id="S2.p8.24.m24.1.1.3.4" xref="S2.p8.24.m24.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.p8.24.m24.1.1.3.1b" xref="S2.p8.24.m24.1.1.3.1.cmml">​</mo><mi id="S2.p8.24.m24.1.1.3.5" xref="S2.p8.24.m24.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p8.24.m24.1b"><apply id="S2.p8.24.m24.1.1.cmml" xref="S2.p8.24.m24.1.1"><csymbol cd="ambiguous" id="S2.p8.24.m24.1.1.1.cmml" xref="S2.p8.24.m24.1.1">subscript</csymbol><ci id="S2.p8.24.m24.1.1.2.cmml" xref="S2.p8.24.m24.1.1.2">𝒟</ci><apply id="S2.p8.24.m24.1.1.3.cmml" xref="S2.p8.24.m24.1.1.3"><times id="S2.p8.24.m24.1.1.3.1.cmml" xref="S2.p8.24.m24.1.1.3.1"></times><ci id="S2.p8.24.m24.1.1.3.2.cmml" xref="S2.p8.24.m24.1.1.3.2">𝑡</ci><ci id="S2.p8.24.m24.1.1.3.3.cmml" xref="S2.p8.24.m24.1.1.3.3">𝑒</ci><ci id="S2.p8.24.m24.1.1.3.4.cmml" xref="S2.p8.24.m24.1.1.3.4">𝑠</ci><ci id="S2.p8.24.m24.1.1.3.5.cmml" xref="S2.p8.24.m24.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.24.m24.1c">\mathcal{D}_{test}</annotation></semantics></math> with <math id="S2.p8.25.m25.1" class="ltx_Math" alttext="Q_{\tau}" display="inline"><semantics id="S2.p8.25.m25.1a"><msub id="S2.p8.25.m25.1.1" xref="S2.p8.25.m25.1.1.cmml"><mi id="S2.p8.25.m25.1.1.2" xref="S2.p8.25.m25.1.1.2.cmml">Q</mi><mi id="S2.p8.25.m25.1.1.3" xref="S2.p8.25.m25.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p8.25.m25.1b"><apply id="S2.p8.25.m25.1.1.cmml" xref="S2.p8.25.m25.1.1"><csymbol cd="ambiguous" id="S2.p8.25.m25.1.1.1.cmml" xref="S2.p8.25.m25.1.1">subscript</csymbol><ci id="S2.p8.25.m25.1.1.2.cmml" xref="S2.p8.25.m25.1.1.2">𝑄</ci><ci id="S2.p8.25.m25.1.1.3.cmml" xref="S2.p8.25.m25.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.25.m25.1c">Q_{\tau}</annotation></semantics></math> examples.
First, <math id="S2.p8.26.m26.1" class="ltx_Math" alttext="\mathcal{D}_{S}^{\tau}" display="inline"><semantics id="S2.p8.26.m26.1a"><msubsup id="S2.p8.26.m26.1.1" xref="S2.p8.26.m26.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.26.m26.1.1.2.2" xref="S2.p8.26.m26.1.1.2.2.cmml">𝒟</mi><mi id="S2.p8.26.m26.1.1.2.3" xref="S2.p8.26.m26.1.1.2.3.cmml">S</mi><mi id="S2.p8.26.m26.1.1.3" xref="S2.p8.26.m26.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p8.26.m26.1b"><apply id="S2.p8.26.m26.1.1.cmml" xref="S2.p8.26.m26.1.1"><csymbol cd="ambiguous" id="S2.p8.26.m26.1.1.1.cmml" xref="S2.p8.26.m26.1.1">superscript</csymbol><apply id="S2.p8.26.m26.1.1.2.cmml" xref="S2.p8.26.m26.1.1"><csymbol cd="ambiguous" id="S2.p8.26.m26.1.1.2.1.cmml" xref="S2.p8.26.m26.1.1">subscript</csymbol><ci id="S2.p8.26.m26.1.1.2.2.cmml" xref="S2.p8.26.m26.1.1.2.2">𝒟</ci><ci id="S2.p8.26.m26.1.1.2.3.cmml" xref="S2.p8.26.m26.1.1.2.3">𝑆</ci></apply><ci id="S2.p8.26.m26.1.1.3.cmml" xref="S2.p8.26.m26.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.26.m26.1c">\mathcal{D}_{S}^{\tau}</annotation></semantics></math> is formed by randomly choosing a subset of classes selected from the range of available classes in <math id="S2.p8.27.m27.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="S2.p8.27.m27.1a"><msub id="S2.p8.27.m27.1.1" xref="S2.p8.27.m27.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.27.m27.1.1.2" xref="S2.p8.27.m27.1.1.2.cmml">𝒟</mi><mrow id="S2.p8.27.m27.1.1.3" xref="S2.p8.27.m27.1.1.3.cmml"><mi id="S2.p8.27.m27.1.1.3.2" xref="S2.p8.27.m27.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.27.m27.1.1.3.1" xref="S2.p8.27.m27.1.1.3.1.cmml">​</mo><mi id="S2.p8.27.m27.1.1.3.3" xref="S2.p8.27.m27.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.p8.27.m27.1.1.3.1a" xref="S2.p8.27.m27.1.1.3.1.cmml">​</mo><mi id="S2.p8.27.m27.1.1.3.4" xref="S2.p8.27.m27.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.p8.27.m27.1.1.3.1b" xref="S2.p8.27.m27.1.1.3.1.cmml">​</mo><mi id="S2.p8.27.m27.1.1.3.5" xref="S2.p8.27.m27.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p8.27.m27.1.1.3.1c" xref="S2.p8.27.m27.1.1.3.1.cmml">​</mo><mi id="S2.p8.27.m27.1.1.3.6" xref="S2.p8.27.m27.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p8.27.m27.1b"><apply id="S2.p8.27.m27.1.1.cmml" xref="S2.p8.27.m27.1.1"><csymbol cd="ambiguous" id="S2.p8.27.m27.1.1.1.cmml" xref="S2.p8.27.m27.1.1">subscript</csymbol><ci id="S2.p8.27.m27.1.1.2.cmml" xref="S2.p8.27.m27.1.1.2">𝒟</ci><apply id="S2.p8.27.m27.1.1.3.cmml" xref="S2.p8.27.m27.1.1.3"><times id="S2.p8.27.m27.1.1.3.1.cmml" xref="S2.p8.27.m27.1.1.3.1"></times><ci id="S2.p8.27.m27.1.1.3.2.cmml" xref="S2.p8.27.m27.1.1.3.2">𝑡</ci><ci id="S2.p8.27.m27.1.1.3.3.cmml" xref="S2.p8.27.m27.1.1.3.3">𝑟</ci><ci id="S2.p8.27.m27.1.1.3.4.cmml" xref="S2.p8.27.m27.1.1.3.4">𝑎</ci><ci id="S2.p8.27.m27.1.1.3.5.cmml" xref="S2.p8.27.m27.1.1.3.5">𝑖</ci><ci id="S2.p8.27.m27.1.1.3.6.cmml" xref="S2.p8.27.m27.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.27.m27.1c">\mathcal{D}_{train}</annotation></semantics></math>.
Second, the number of shots to use for each selected class is randomly selected from the range of available examples in each class of <math id="S2.p8.28.m28.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="S2.p8.28.m28.1a"><msub id="S2.p8.28.m28.1.1" xref="S2.p8.28.m28.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.28.m28.1.1.2" xref="S2.p8.28.m28.1.1.2.cmml">𝒟</mi><mrow id="S2.p8.28.m28.1.1.3" xref="S2.p8.28.m28.1.1.3.cmml"><mi id="S2.p8.28.m28.1.1.3.2" xref="S2.p8.28.m28.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.28.m28.1.1.3.1" xref="S2.p8.28.m28.1.1.3.1.cmml">​</mo><mi id="S2.p8.28.m28.1.1.3.3" xref="S2.p8.28.m28.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.p8.28.m28.1.1.3.1a" xref="S2.p8.28.m28.1.1.3.1.cmml">​</mo><mi id="S2.p8.28.m28.1.1.3.4" xref="S2.p8.28.m28.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.p8.28.m28.1.1.3.1b" xref="S2.p8.28.m28.1.1.3.1.cmml">​</mo><mi id="S2.p8.28.m28.1.1.3.5" xref="S2.p8.28.m28.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p8.28.m28.1.1.3.1c" xref="S2.p8.28.m28.1.1.3.1.cmml">​</mo><mi id="S2.p8.28.m28.1.1.3.6" xref="S2.p8.28.m28.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p8.28.m28.1b"><apply id="S2.p8.28.m28.1.1.cmml" xref="S2.p8.28.m28.1.1"><csymbol cd="ambiguous" id="S2.p8.28.m28.1.1.1.cmml" xref="S2.p8.28.m28.1.1">subscript</csymbol><ci id="S2.p8.28.m28.1.1.2.cmml" xref="S2.p8.28.m28.1.1.2">𝒟</ci><apply id="S2.p8.28.m28.1.1.3.cmml" xref="S2.p8.28.m28.1.1.3"><times id="S2.p8.28.m28.1.1.3.1.cmml" xref="S2.p8.28.m28.1.1.3.1"></times><ci id="S2.p8.28.m28.1.1.3.2.cmml" xref="S2.p8.28.m28.1.1.3.2">𝑡</ci><ci id="S2.p8.28.m28.1.1.3.3.cmml" xref="S2.p8.28.m28.1.1.3.3">𝑟</ci><ci id="S2.p8.28.m28.1.1.3.4.cmml" xref="S2.p8.28.m28.1.1.3.4">𝑎</ci><ci id="S2.p8.28.m28.1.1.3.5.cmml" xref="S2.p8.28.m28.1.1.3.5">𝑖</ci><ci id="S2.p8.28.m28.1.1.3.6.cmml" xref="S2.p8.28.m28.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.28.m28.1c">\mathcal{D}_{train}</annotation></semantics></math> with the goal of keeping the examples per class as equal as possible.
Third, <math id="S2.p8.29.m29.1" class="ltx_Math" alttext="\mathcal{D}_{Q}^{\tau}" display="inline"><semantics id="S2.p8.29.m29.1a"><msubsup id="S2.p8.29.m29.1.1" xref="S2.p8.29.m29.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.29.m29.1.1.2.2" xref="S2.p8.29.m29.1.1.2.2.cmml">𝒟</mi><mi id="S2.p8.29.m29.1.1.2.3" xref="S2.p8.29.m29.1.1.2.3.cmml">Q</mi><mi id="S2.p8.29.m29.1.1.3" xref="S2.p8.29.m29.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p8.29.m29.1b"><apply id="S2.p8.29.m29.1.1.cmml" xref="S2.p8.29.m29.1.1"><csymbol cd="ambiguous" id="S2.p8.29.m29.1.1.1.cmml" xref="S2.p8.29.m29.1.1">superscript</csymbol><apply id="S2.p8.29.m29.1.1.2.cmml" xref="S2.p8.29.m29.1.1"><csymbol cd="ambiguous" id="S2.p8.29.m29.1.1.2.1.cmml" xref="S2.p8.29.m29.1.1">subscript</csymbol><ci id="S2.p8.29.m29.1.1.2.2.cmml" xref="S2.p8.29.m29.1.1.2.2">𝒟</ci><ci id="S2.p8.29.m29.1.1.2.3.cmml" xref="S2.p8.29.m29.1.1.2.3">𝑄</ci></apply><ci id="S2.p8.29.m29.1.1.3.cmml" xref="S2.p8.29.m29.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.29.m29.1c">\mathcal{D}_{Q}^{\tau}</annotation></semantics></math> is formed by using the classes selected for <math id="S2.p8.30.m30.1" class="ltx_Math" alttext="\mathcal{D}_{S}^{\tau}" display="inline"><semantics id="S2.p8.30.m30.1a"><msubsup id="S2.p8.30.m30.1.1" xref="S2.p8.30.m30.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.30.m30.1.1.2.2" xref="S2.p8.30.m30.1.1.2.2.cmml">𝒟</mi><mi id="S2.p8.30.m30.1.1.2.3" xref="S2.p8.30.m30.1.1.2.3.cmml">S</mi><mi id="S2.p8.30.m30.1.1.3" xref="S2.p8.30.m30.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p8.30.m30.1b"><apply id="S2.p8.30.m30.1.1.cmml" xref="S2.p8.30.m30.1.1"><csymbol cd="ambiguous" id="S2.p8.30.m30.1.1.1.cmml" xref="S2.p8.30.m30.1.1">superscript</csymbol><apply id="S2.p8.30.m30.1.1.2.cmml" xref="S2.p8.30.m30.1.1"><csymbol cd="ambiguous" id="S2.p8.30.m30.1.1.2.1.cmml" xref="S2.p8.30.m30.1.1">subscript</csymbol><ci id="S2.p8.30.m30.1.1.2.2.cmml" xref="S2.p8.30.m30.1.1.2.2">𝒟</ci><ci id="S2.p8.30.m30.1.1.2.3.cmml" xref="S2.p8.30.m30.1.1.2.3">𝑆</ci></apply><ci id="S2.p8.30.m30.1.1.3.cmml" xref="S2.p8.30.m30.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.30.m30.1c">\mathcal{D}_{S}^{\tau}</annotation></semantics></math> and all available examples from <math id="S2.p8.31.m31.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="S2.p8.31.m31.1a"><msub id="S2.p8.31.m31.1.1" xref="S2.p8.31.m31.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.31.m31.1.1.2" xref="S2.p8.31.m31.1.1.2.cmml">𝒟</mi><mrow id="S2.p8.31.m31.1.1.3" xref="S2.p8.31.m31.1.1.3.cmml"><mi id="S2.p8.31.m31.1.1.3.2" xref="S2.p8.31.m31.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.31.m31.1.1.3.1" xref="S2.p8.31.m31.1.1.3.1.cmml">​</mo><mi id="S2.p8.31.m31.1.1.3.3" xref="S2.p8.31.m31.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.p8.31.m31.1.1.3.1a" xref="S2.p8.31.m31.1.1.3.1.cmml">​</mo><mi id="S2.p8.31.m31.1.1.3.4" xref="S2.p8.31.m31.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.p8.31.m31.1.1.3.1b" xref="S2.p8.31.m31.1.1.3.1.cmml">​</mo><mi id="S2.p8.31.m31.1.1.3.5" xref="S2.p8.31.m31.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p8.31.m31.1b"><apply id="S2.p8.31.m31.1.1.cmml" xref="S2.p8.31.m31.1.1"><csymbol cd="ambiguous" id="S2.p8.31.m31.1.1.1.cmml" xref="S2.p8.31.m31.1.1">subscript</csymbol><ci id="S2.p8.31.m31.1.1.2.cmml" xref="S2.p8.31.m31.1.1.2">𝒟</ci><apply id="S2.p8.31.m31.1.1.3.cmml" xref="S2.p8.31.m31.1.1.3"><times id="S2.p8.31.m31.1.1.3.1.cmml" xref="S2.p8.31.m31.1.1.3.1"></times><ci id="S2.p8.31.m31.1.1.3.2.cmml" xref="S2.p8.31.m31.1.1.3.2">𝑡</ci><ci id="S2.p8.31.m31.1.1.3.3.cmml" xref="S2.p8.31.m31.1.1.3.3">𝑒</ci><ci id="S2.p8.31.m31.1.1.3.4.cmml" xref="S2.p8.31.m31.1.1.3.4">𝑠</ci><ci id="S2.p8.31.m31.1.1.3.5.cmml" xref="S2.p8.31.m31.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.31.m31.1c">\mathcal{D}_{test}</annotation></semantics></math> in those classes up to a limit of 2000 examples.
Refer to <a href="#alg2" title="In A.10 FiT Training Algorithms ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">A.2</span></a> for details.
Episodic fine-tuning is crucial to achieving the best classification accuracy with the Naive Bayes head.
If all of <math id="S2.p8.32.m32.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="S2.p8.32.m32.1a"><msub id="S2.p8.32.m32.1.1" xref="S2.p8.32.m32.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.32.m32.1.1.2" xref="S2.p8.32.m32.1.1.2.cmml">𝒟</mi><mrow id="S2.p8.32.m32.1.1.3" xref="S2.p8.32.m32.1.1.3.cmml"><mi id="S2.p8.32.m32.1.1.3.2" xref="S2.p8.32.m32.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.32.m32.1.1.3.1" xref="S2.p8.32.m32.1.1.3.1.cmml">​</mo><mi id="S2.p8.32.m32.1.1.3.3" xref="S2.p8.32.m32.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.p8.32.m32.1.1.3.1a" xref="S2.p8.32.m32.1.1.3.1.cmml">​</mo><mi id="S2.p8.32.m32.1.1.3.4" xref="S2.p8.32.m32.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.p8.32.m32.1.1.3.1b" xref="S2.p8.32.m32.1.1.3.1.cmml">​</mo><mi id="S2.p8.32.m32.1.1.3.5" xref="S2.p8.32.m32.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p8.32.m32.1.1.3.1c" xref="S2.p8.32.m32.1.1.3.1.cmml">​</mo><mi id="S2.p8.32.m32.1.1.3.6" xref="S2.p8.32.m32.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p8.32.m32.1b"><apply id="S2.p8.32.m32.1.1.cmml" xref="S2.p8.32.m32.1.1"><csymbol cd="ambiguous" id="S2.p8.32.m32.1.1.1.cmml" xref="S2.p8.32.m32.1.1">subscript</csymbol><ci id="S2.p8.32.m32.1.1.2.cmml" xref="S2.p8.32.m32.1.1.2">𝒟</ci><apply id="S2.p8.32.m32.1.1.3.cmml" xref="S2.p8.32.m32.1.1.3"><times id="S2.p8.32.m32.1.1.3.1.cmml" xref="S2.p8.32.m32.1.1.3.1"></times><ci id="S2.p8.32.m32.1.1.3.2.cmml" xref="S2.p8.32.m32.1.1.3.2">𝑡</ci><ci id="S2.p8.32.m32.1.1.3.3.cmml" xref="S2.p8.32.m32.1.1.3.3">𝑟</ci><ci id="S2.p8.32.m32.1.1.3.4.cmml" xref="S2.p8.32.m32.1.1.3.4">𝑎</ci><ci id="S2.p8.32.m32.1.1.3.5.cmml" xref="S2.p8.32.m32.1.1.3.5">𝑖</ci><ci id="S2.p8.32.m32.1.1.3.6.cmml" xref="S2.p8.32.m32.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.32.m32.1c">\mathcal{D}_{train}</annotation></semantics></math> and <math id="S2.p8.33.m33.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="S2.p8.33.m33.1a"><msub id="S2.p8.33.m33.1.1" xref="S2.p8.33.m33.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.33.m33.1.1.2" xref="S2.p8.33.m33.1.1.2.cmml">𝒟</mi><mrow id="S2.p8.33.m33.1.1.3" xref="S2.p8.33.m33.1.1.3.cmml"><mi id="S2.p8.33.m33.1.1.3.2" xref="S2.p8.33.m33.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.p8.33.m33.1.1.3.1" xref="S2.p8.33.m33.1.1.3.1.cmml">​</mo><mi id="S2.p8.33.m33.1.1.3.3" xref="S2.p8.33.m33.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.p8.33.m33.1.1.3.1a" xref="S2.p8.33.m33.1.1.3.1.cmml">​</mo><mi id="S2.p8.33.m33.1.1.3.4" xref="S2.p8.33.m33.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.p8.33.m33.1.1.3.1b" xref="S2.p8.33.m33.1.1.3.1.cmml">​</mo><mi id="S2.p8.33.m33.1.1.3.5" xref="S2.p8.33.m33.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p8.33.m33.1b"><apply id="S2.p8.33.m33.1.1.cmml" xref="S2.p8.33.m33.1.1"><csymbol cd="ambiguous" id="S2.p8.33.m33.1.1.1.cmml" xref="S2.p8.33.m33.1.1">subscript</csymbol><ci id="S2.p8.33.m33.1.1.2.cmml" xref="S2.p8.33.m33.1.1.2">𝒟</ci><apply id="S2.p8.33.m33.1.1.3.cmml" xref="S2.p8.33.m33.1.1.3"><times id="S2.p8.33.m33.1.1.3.1.cmml" xref="S2.p8.33.m33.1.1.3.1"></times><ci id="S2.p8.33.m33.1.1.3.2.cmml" xref="S2.p8.33.m33.1.1.3.2">𝑡</ci><ci id="S2.p8.33.m33.1.1.3.3.cmml" xref="S2.p8.33.m33.1.1.3.3">𝑒</ci><ci id="S2.p8.33.m33.1.1.3.4.cmml" xref="S2.p8.33.m33.1.1.3.4">𝑠</ci><ci id="S2.p8.33.m33.1.1.3.5.cmml" xref="S2.p8.33.m33.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.33.m33.1c">\mathcal{D}_{test}</annotation></semantics></math> are used for every iteration, overfitting occurs, limiting accuracy (see <a href="#A1.T2" title="In A.4.2 Few-shot Task Ablations ‣ A.4 Additional Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.2</span></a> and <a href="#A1.T4" title="In A.5.1 VTAB-1k Task Ablations ‣ A.5 Additional VTAB-1k Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.4</span></a>).
The support set <math id="S2.p8.34.m34.1" class="ltx_Math" alttext="\mathcal{D}_{S}^{\tau}" display="inline"><semantics id="S2.p8.34.m34.1a"><msubsup id="S2.p8.34.m34.1.1" xref="S2.p8.34.m34.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.34.m34.1.1.2.2" xref="S2.p8.34.m34.1.1.2.2.cmml">𝒟</mi><mi id="S2.p8.34.m34.1.1.2.3" xref="S2.p8.34.m34.1.1.2.3.cmml">S</mi><mi id="S2.p8.34.m34.1.1.3" xref="S2.p8.34.m34.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p8.34.m34.1b"><apply id="S2.p8.34.m34.1.1.cmml" xref="S2.p8.34.m34.1.1"><csymbol cd="ambiguous" id="S2.p8.34.m34.1.1.1.cmml" xref="S2.p8.34.m34.1.1">superscript</csymbol><apply id="S2.p8.34.m34.1.1.2.cmml" xref="S2.p8.34.m34.1.1"><csymbol cd="ambiguous" id="S2.p8.34.m34.1.1.2.1.cmml" xref="S2.p8.34.m34.1.1">subscript</csymbol><ci id="S2.p8.34.m34.1.1.2.2.cmml" xref="S2.p8.34.m34.1.1.2.2">𝒟</ci><ci id="S2.p8.34.m34.1.1.2.3.cmml" xref="S2.p8.34.m34.1.1.2.3">𝑆</ci></apply><ci id="S2.p8.34.m34.1.1.3.cmml" xref="S2.p8.34.m34.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.34.m34.1c">\mathcal{D}_{S}^{\tau}</annotation></semantics></math> is then used to compute <math id="S2.p8.35.m35.1" class="ltx_Math" alttext="{\bm{\pi}}" display="inline"><semantics id="S2.p8.35.m35.1a"><mi id="S2.p8.35.m35.1.1" xref="S2.p8.35.m35.1.1.cmml">𝝅</mi><annotation-xml encoding="MathML-Content" id="S2.p8.35.m35.1b"><ci id="S2.p8.35.m35.1.1.cmml" xref="S2.p8.35.m35.1.1">𝝅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.35.m35.1c">{\bm{\pi}}</annotation></semantics></math>, <math id="S2.p8.36.m36.1" class="ltx_Math" alttext="{\bm{\mu}}" display="inline"><semantics id="S2.p8.36.m36.1a"><mi id="S2.p8.36.m36.1.1" xref="S2.p8.36.m36.1.1.cmml">𝝁</mi><annotation-xml encoding="MathML-Content" id="S2.p8.36.m36.1b"><ci id="S2.p8.36.m36.1.1.cmml" xref="S2.p8.36.m36.1.1">𝝁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.36.m36.1c">{\bm{\mu}}</annotation></semantics></math>, and <math id="S2.p8.37.m37.1" class="ltx_Math" alttext="{\bm{\Sigma}}" display="inline"><semantics id="S2.p8.37.m37.1a"><mi id="S2.p8.37.m37.1.1" xref="S2.p8.37.m37.1.1.cmml">𝚺</mi><annotation-xml encoding="MathML-Content" id="S2.p8.37.m37.1b"><ci id="S2.p8.37.m37.1.1.cmml" xref="S2.p8.37.m37.1.1">𝚺</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.37.m37.1c">{\bm{\Sigma}}</annotation></semantics></math> and we then use <math id="S2.p8.38.m38.5" class="ltx_Math" alttext="\mathcal{D}_{Q}=\{\{{\bm{x}}_{q}^{\tau\ast},y_{q}^{\tau\ast}\}_{q=1}^{Q_{\tau}}\}_{\tau=1}^{T}" display="inline"><semantics id="S2.p8.38.m38.5a"><mrow id="S2.p8.38.m38.5.5" xref="S2.p8.38.m38.5.5.cmml"><msub id="S2.p8.38.m38.5.5.3" xref="S2.p8.38.m38.5.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.38.m38.5.5.3.2" xref="S2.p8.38.m38.5.5.3.2.cmml">𝒟</mi><mi id="S2.p8.38.m38.5.5.3.3" xref="S2.p8.38.m38.5.5.3.3.cmml">Q</mi></msub><mo id="S2.p8.38.m38.5.5.2" xref="S2.p8.38.m38.5.5.2.cmml">=</mo><msubsup id="S2.p8.38.m38.5.5.1" xref="S2.p8.38.m38.5.5.1.cmml"><mrow id="S2.p8.38.m38.5.5.1.1.1.1" xref="S2.p8.38.m38.5.5.1.1.1.2.cmml"><mo stretchy="false" id="S2.p8.38.m38.5.5.1.1.1.1.2" xref="S2.p8.38.m38.5.5.1.1.1.2.cmml">{</mo><msubsup id="S2.p8.38.m38.5.5.1.1.1.1.1" xref="S2.p8.38.m38.5.5.1.1.1.1.1.cmml"><mrow id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.3" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.3.cmml">{</mo><msubsup id="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1" xref="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mi id="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.2.3" xref="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml">q</mi><mrow id="S2.p8.38.m38.2.2.2.4" xref="S2.p8.38.m38.2.2.2.3.cmml"><mi id="S2.p8.38.m38.1.1.1.1" xref="S2.p8.38.m38.1.1.1.1.cmml">τ</mi><mo lspace="0.222em" id="S2.p8.38.m38.2.2.2.4.1" xref="S2.p8.38.m38.2.2.2.3.cmml">⁣</mo><mo id="S2.p8.38.m38.2.2.2.2" xref="S2.p8.38.m38.2.2.2.2.cmml">∗</mo></mrow></msubsup><mo id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.4" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.2.2" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.2.2.cmml">y</mi><mi id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.2.3" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.2.3.cmml">q</mi><mrow id="S2.p8.38.m38.4.4.2.4" xref="S2.p8.38.m38.4.4.2.3.cmml"><mi id="S2.p8.38.m38.3.3.1.1" xref="S2.p8.38.m38.3.3.1.1.cmml">τ</mi><mo lspace="0.222em" id="S2.p8.38.m38.4.4.2.4.1" xref="S2.p8.38.m38.4.4.2.3.cmml">⁣</mo><mo id="S2.p8.38.m38.4.4.2.2" xref="S2.p8.38.m38.4.4.2.2.cmml">∗</mo></mrow></msubsup><mo stretchy="false" id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.5" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.3.cmml">}</mo></mrow><mrow id="S2.p8.38.m38.5.5.1.1.1.1.1.2.4" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.cmml"><mi id="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.2" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.2.cmml">q</mi><mo id="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.1" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.1.cmml">=</mo><mn id="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.3" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.3.cmml">1</mn></mrow><msub id="S2.p8.38.m38.5.5.1.1.1.1.1.4" xref="S2.p8.38.m38.5.5.1.1.1.1.1.4.cmml"><mi id="S2.p8.38.m38.5.5.1.1.1.1.1.4.2" xref="S2.p8.38.m38.5.5.1.1.1.1.1.4.2.cmml">Q</mi><mi id="S2.p8.38.m38.5.5.1.1.1.1.1.4.3" xref="S2.p8.38.m38.5.5.1.1.1.1.1.4.3.cmml">τ</mi></msub></msubsup><mo stretchy="false" id="S2.p8.38.m38.5.5.1.1.1.1.3" xref="S2.p8.38.m38.5.5.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p8.38.m38.5.5.1.1.3" xref="S2.p8.38.m38.5.5.1.1.3.cmml"><mi id="S2.p8.38.m38.5.5.1.1.3.2" xref="S2.p8.38.m38.5.5.1.1.3.2.cmml">τ</mi><mo id="S2.p8.38.m38.5.5.1.1.3.1" xref="S2.p8.38.m38.5.5.1.1.3.1.cmml">=</mo><mn id="S2.p8.38.m38.5.5.1.1.3.3" xref="S2.p8.38.m38.5.5.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p8.38.m38.5.5.1.3" xref="S2.p8.38.m38.5.5.1.3.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.38.m38.5b"><apply id="S2.p8.38.m38.5.5.cmml" xref="S2.p8.38.m38.5.5"><eq id="S2.p8.38.m38.5.5.2.cmml" xref="S2.p8.38.m38.5.5.2"></eq><apply id="S2.p8.38.m38.5.5.3.cmml" xref="S2.p8.38.m38.5.5.3"><csymbol cd="ambiguous" id="S2.p8.38.m38.5.5.3.1.cmml" xref="S2.p8.38.m38.5.5.3">subscript</csymbol><ci id="S2.p8.38.m38.5.5.3.2.cmml" xref="S2.p8.38.m38.5.5.3.2">𝒟</ci><ci id="S2.p8.38.m38.5.5.3.3.cmml" xref="S2.p8.38.m38.5.5.3.3">𝑄</ci></apply><apply id="S2.p8.38.m38.5.5.1.cmml" xref="S2.p8.38.m38.5.5.1"><csymbol cd="ambiguous" id="S2.p8.38.m38.5.5.1.2.cmml" xref="S2.p8.38.m38.5.5.1">superscript</csymbol><apply id="S2.p8.38.m38.5.5.1.1.cmml" xref="S2.p8.38.m38.5.5.1"><csymbol cd="ambiguous" id="S2.p8.38.m38.5.5.1.1.2.cmml" xref="S2.p8.38.m38.5.5.1">subscript</csymbol><set id="S2.p8.38.m38.5.5.1.1.1.2.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1"><apply id="S2.p8.38.m38.5.5.1.1.1.1.1.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p8.38.m38.5.5.1.1.1.1.1.3.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1">superscript</csymbol><apply id="S2.p8.38.m38.5.5.1.1.1.1.1.2.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p8.38.m38.5.5.1.1.1.1.1.2.3.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1">subscript</csymbol><set id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.3.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2"><apply id="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.1.1.1.1.2.3">𝑞</ci></apply><list id="S2.p8.38.m38.2.2.2.3.cmml" xref="S2.p8.38.m38.2.2.2.4"><ci id="S2.p8.38.m38.1.1.1.1.cmml" xref="S2.p8.38.m38.1.1.1.1">𝜏</ci><ci id="S2.p8.38.m38.2.2.2.2.cmml" xref="S2.p8.38.m38.2.2.2.2">∗</ci></list></apply><apply id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.2.2">𝑦</ci><ci id="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.2.2.2.2.3">𝑞</ci></apply><list id="S2.p8.38.m38.4.4.2.3.cmml" xref="S2.p8.38.m38.4.4.2.4"><ci id="S2.p8.38.m38.3.3.1.1.cmml" xref="S2.p8.38.m38.3.3.1.1">𝜏</ci><ci id="S2.p8.38.m38.4.4.2.2.cmml" xref="S2.p8.38.m38.4.4.2.2">∗</ci></list></apply></set><apply id="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.4"><eq id="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.1.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.1"></eq><ci id="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.2.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.2">𝑞</ci><cn type="integer" id="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.3.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.2.4.3">1</cn></apply></apply><apply id="S2.p8.38.m38.5.5.1.1.1.1.1.4.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.p8.38.m38.5.5.1.1.1.1.1.4.1.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.4">subscript</csymbol><ci id="S2.p8.38.m38.5.5.1.1.1.1.1.4.2.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.4.2">𝑄</ci><ci id="S2.p8.38.m38.5.5.1.1.1.1.1.4.3.cmml" xref="S2.p8.38.m38.5.5.1.1.1.1.1.4.3">𝜏</ci></apply></apply></set><apply id="S2.p8.38.m38.5.5.1.1.3.cmml" xref="S2.p8.38.m38.5.5.1.1.3"><eq id="S2.p8.38.m38.5.5.1.1.3.1.cmml" xref="S2.p8.38.m38.5.5.1.1.3.1"></eq><ci id="S2.p8.38.m38.5.5.1.1.3.2.cmml" xref="S2.p8.38.m38.5.5.1.1.3.2">𝜏</ci><cn type="integer" id="S2.p8.38.m38.5.5.1.1.3.3.cmml" xref="S2.p8.38.m38.5.5.1.1.3.3">1</cn></apply></apply><ci id="S2.p8.38.m38.5.5.1.3.cmml" xref="S2.p8.38.m38.5.5.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.38.m38.5c">\mathcal{D}_{Q}=\{\{{\bm{x}}_{q}^{\tau\ast},y_{q}^{\tau\ast}\}_{q=1}^{Q_{\tau}}\}_{\tau=1}^{T}</annotation></semantics></math> to train <math id="S2.p8.39.m39.1" class="ltx_Math" alttext="{\bm{\psi}}" display="inline"><semantics id="S2.p8.39.m39.1a"><mi id="S2.p8.39.m39.1.1" xref="S2.p8.39.m39.1.1.cmml">𝝍</mi><annotation-xml encoding="MathML-Content" id="S2.p8.39.m39.1b"><ci id="S2.p8.39.m39.1.1.cmml" xref="S2.p8.39.m39.1.1">𝝍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.39.m39.1c">{\bm{\psi}}</annotation></semantics></math> and <math id="S2.p8.40.m40.1" class="ltx_Math" alttext="{\bm{e}}" display="inline"><semantics id="S2.p8.40.m40.1a"><mi id="S2.p8.40.m40.1.1" xref="S2.p8.40.m40.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="S2.p8.40.m40.1b"><ci id="S2.p8.40.m40.1.1.cmml" xref="S2.p8.40.m40.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.40.m40.1c">{\bm{e}}</annotation></semantics></math> with maximum likelihood. We optimize the following:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.9" class="ltx_Math" alttext="\hat{\mathcal{L}}\left({\bm{\psi}},{\bm{e}}\right)=\sum_{\tau=1}^{T}\sum_{q=1}^{Q_{\tau}}\log p\left(y_{q}^{\tau\ast}|h_{e}(b_{\theta,\psi}({\bm{x}}_{q}^{\tau\ast})),{\bm{\pi}}(\mathcal{D}_{s}^{\tau}),{\bm{\mu}}(\mathcal{D}_{s}^{\tau}),{\bm{\Sigma}}(\mathcal{D}_{s}^{\tau})\right)." display="block"><semantics id="S2.E2.m1.9a"><mrow id="S2.E2.m1.9.9.1" xref="S2.E2.m1.9.9.1.1.cmml"><mrow id="S2.E2.m1.9.9.1.1" xref="S2.E2.m1.9.9.1.1.cmml"><mrow id="S2.E2.m1.9.9.1.1.3" xref="S2.E2.m1.9.9.1.1.3.cmml"><mover accent="true" id="S2.E2.m1.9.9.1.1.3.2" xref="S2.E2.m1.9.9.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.9.9.1.1.3.2.2" xref="S2.E2.m1.9.9.1.1.3.2.2.cmml">ℒ</mi><mo id="S2.E2.m1.9.9.1.1.3.2.1" xref="S2.E2.m1.9.9.1.1.3.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S2.E2.m1.9.9.1.1.3.1" xref="S2.E2.m1.9.9.1.1.3.1.cmml">​</mo><mrow id="S2.E2.m1.9.9.1.1.3.3.2" xref="S2.E2.m1.9.9.1.1.3.3.1.cmml"><mo id="S2.E2.m1.9.9.1.1.3.3.2.1" xref="S2.E2.m1.9.9.1.1.3.3.1.cmml">(</mo><mi id="S2.E2.m1.7.7" xref="S2.E2.m1.7.7.cmml">𝝍</mi><mo id="S2.E2.m1.9.9.1.1.3.3.2.2" xref="S2.E2.m1.9.9.1.1.3.3.1.cmml">,</mo><mi id="S2.E2.m1.8.8" xref="S2.E2.m1.8.8.cmml">𝒆</mi><mo id="S2.E2.m1.9.9.1.1.3.3.2.3" xref="S2.E2.m1.9.9.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.E2.m1.9.9.1.1.2" xref="S2.E2.m1.9.9.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.9.9.1.1.1" xref="S2.E2.m1.9.9.1.1.1.cmml"><munderover id="S2.E2.m1.9.9.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.E2.m1.9.9.1.1.1.2.2.2" xref="S2.E2.m1.9.9.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.9.9.1.1.1.2.2.3" xref="S2.E2.m1.9.9.1.1.1.2.2.3.cmml"><mi id="S2.E2.m1.9.9.1.1.1.2.2.3.2" xref="S2.E2.m1.9.9.1.1.1.2.2.3.2.cmml">τ</mi><mo id="S2.E2.m1.9.9.1.1.1.2.2.3.1" xref="S2.E2.m1.9.9.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.9.9.1.1.1.2.2.3.3" xref="S2.E2.m1.9.9.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.9.9.1.1.1.2.3" xref="S2.E2.m1.9.9.1.1.1.2.3.cmml">T</mi></munderover><mrow id="S2.E2.m1.9.9.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.cmml"><munderover id="S2.E2.m1.9.9.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E2.m1.9.9.1.1.1.1.2.2.2" xref="S2.E2.m1.9.9.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.2.2.3" xref="S2.E2.m1.9.9.1.1.1.1.2.2.3.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.2.2.3.2" xref="S2.E2.m1.9.9.1.1.1.1.2.2.3.2.cmml">q</mi><mo id="S2.E2.m1.9.9.1.1.1.1.2.2.3.1" xref="S2.E2.m1.9.9.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.9.9.1.1.1.1.2.2.3.3" xref="S2.E2.m1.9.9.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S2.E2.m1.9.9.1.1.1.1.2.3" xref="S2.E2.m1.9.9.1.1.1.1.2.3.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.2.3.2" xref="S2.E2.m1.9.9.1.1.1.1.2.3.2.cmml">Q</mi><mi id="S2.E2.m1.9.9.1.1.1.1.2.3.3" xref="S2.E2.m1.9.9.1.1.1.1.2.3.3.cmml">τ</mi></msub></munderover><mrow id="S2.E2.m1.9.9.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.9.9.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.3.1" xref="S2.E2.m1.9.9.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E2.m1.9.9.1.1.1.1.1.3a" xref="S2.E2.m1.9.9.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E2.m1.9.9.1.1.1.1.1.3.2" xref="S2.E2.m1.9.9.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.9.9.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.9.9.1.1.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.2.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.2.2.cmml">y</mi><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.2.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.2.3.cmml">q</mi><mrow id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">τ</mi><mo lspace="0.222em" id="S2.E2.m1.2.2.2.4.1" xref="S2.E2.m1.2.2.2.3.cmml">⁣</mo><mo id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">∗</mo></mrow></msubsup><mo fence="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.5" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.5.cmml">|</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.5.cmml"><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">h</mi><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mrow id="S2.E2.m1.4.4.2.4" xref="S2.E2.m1.4.4.2.3.cmml"><mi id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml">θ</mi><mo id="S2.E2.m1.4.4.2.4.1" xref="S2.E2.m1.4.4.2.3.cmml">,</mo><mi id="S2.E2.m1.4.4.2.2" xref="S2.E2.m1.4.4.2.2.cmml">ψ</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">q</mi><mrow id="S2.E2.m1.6.6.2.4" xref="S2.E2.m1.6.6.2.3.cmml"><mi id="S2.E2.m1.5.5.1.1" xref="S2.E2.m1.5.5.1.1.cmml">τ</mi><mo lspace="0.222em" id="S2.E2.m1.6.6.2.4.1" xref="S2.E2.m1.6.6.2.3.cmml">⁣</mo><mo id="S2.E2.m1.6.6.2.2" xref="S2.E2.m1.6.6.2.2.cmml">∗</mo></mrow></msubsup><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.5" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.3.cmml">𝝅</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.2.cmml">​</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><msubsup id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml">s</mi><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml">τ</mi></msubsup><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.6" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.3.cmml">𝝁</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.2.cmml">​</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml">(</mo><msubsup id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.3.cmml">s</mi><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3.cmml">τ</mi></msubsup><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.7" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.3.cmml">𝚺</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.2.cmml">​</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.cmml">(</mo><msubsup id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.2.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.2.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.2.3.cmml">s</mi><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.3.cmml">τ</mi></msubsup><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.9.9.1.1.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E2.m1.9.9.1.2" xref="S2.E2.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.9b"><apply id="S2.E2.m1.9.9.1.1.cmml" xref="S2.E2.m1.9.9.1"><eq id="S2.E2.m1.9.9.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.2"></eq><apply id="S2.E2.m1.9.9.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.3"><times id="S2.E2.m1.9.9.1.1.3.1.cmml" xref="S2.E2.m1.9.9.1.1.3.1"></times><apply id="S2.E2.m1.9.9.1.1.3.2.cmml" xref="S2.E2.m1.9.9.1.1.3.2"><ci id="S2.E2.m1.9.9.1.1.3.2.1.cmml" xref="S2.E2.m1.9.9.1.1.3.2.1">^</ci><ci id="S2.E2.m1.9.9.1.1.3.2.2.cmml" xref="S2.E2.m1.9.9.1.1.3.2.2">ℒ</ci></apply><interval closure="open" id="S2.E2.m1.9.9.1.1.3.3.1.cmml" xref="S2.E2.m1.9.9.1.1.3.3.2"><ci id="S2.E2.m1.7.7.cmml" xref="S2.E2.m1.7.7">𝝍</ci><ci id="S2.E2.m1.8.8.cmml" xref="S2.E2.m1.8.8">𝒆</ci></interval></apply><apply id="S2.E2.m1.9.9.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1"><apply id="S2.E2.m1.9.9.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.9.9.1.1.1.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.2.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.9.9.1.1.1.2.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.9.9.1.1.1.2.2.3.cmml" xref="S2.E2.m1.9.9.1.1.1.2.2.3"><eq id="S2.E2.m1.9.9.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.9.9.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.9.9.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.9.9.1.1.1.2.2.3.2">𝜏</ci><cn type="integer" id="S2.E2.m1.9.9.1.1.1.2.2.3.3.cmml" xref="S2.E2.m1.9.9.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.9.9.1.1.1.2.3.cmml" xref="S2.E2.m1.9.9.1.1.1.2.3">𝑇</ci></apply><apply id="S2.E2.m1.9.9.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1"><apply id="S2.E2.m1.9.9.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.9.9.1.1.1.1.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.9.9.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.9.9.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2.2.3"><eq id="S2.E2.m1.9.9.1.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.9.9.1.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2.2.3.2">𝑞</ci><cn type="integer" id="S2.E2.m1.9.9.1.1.1.1.2.2.3.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.9.9.1.1.1.1.2.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.1.1.2.3.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2.3.2">𝑄</ci><ci id="S2.E2.m1.9.9.1.1.1.1.2.3.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.2.3.3">𝜏</ci></apply></apply><apply id="S2.E2.m1.9.9.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1"><times id="S2.E2.m1.9.9.1.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.2"></times><apply id="S2.E2.m1.9.9.1.1.1.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.3"><log id="S2.E2.m1.9.9.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.3.1"></log><ci id="S2.E2.m1.9.9.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.5.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.5">conditional</csymbol><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6">superscript</csymbol><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.2.2">𝑦</ci><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.2.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.6.2.3">𝑞</ci></apply><list id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.4"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝜏</ci><ci id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2">∗</ci></list></apply><list id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.5.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4"><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2">ℎ</ci><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑒</ci></apply><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑏</ci><list id="S2.E2.m1.4.4.2.3.cmml" xref="S2.E2.m1.4.4.2.4"><ci id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1.1">𝜃</ci><ci id="S2.E2.m1.4.4.2.2.cmml" xref="S2.E2.m1.4.4.2.2">𝜓</ci></list></apply><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑞</ci></apply><list id="S2.E2.m1.6.6.2.3.cmml" xref="S2.E2.m1.6.6.2.4"><ci id="S2.E2.m1.5.5.1.1.cmml" xref="S2.E2.m1.5.5.1.1">𝜏</ci><ci id="S2.E2.m1.6.6.2.2.cmml" xref="S2.E2.m1.6.6.2.2">∗</ci></list></apply></apply></apply><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2"><times id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.2"></times><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.3">𝝅</ci><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1">superscript</csymbol><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2">𝒟</ci><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3">𝜏</ci></apply></apply><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3"><times id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.2"></times><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.3">𝝁</ci><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1">superscript</csymbol><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.2">𝒟</ci><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3">𝜏</ci></apply></apply><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4"><times id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.2"></times><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.3">𝚺</ci><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1">superscript</csymbol><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.2.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1">subscript</csymbol><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.2.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.2.2">𝒟</ci><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.2.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4.4.4.1.1.1.3">𝜏</ci></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.9c">\hat{\mathcal{L}}\left({\bm{\psi}},{\bm{e}}\right)=\sum_{\tau=1}^{T}\sum_{q=1}^{Q_{\tau}}\log p\left(y_{q}^{\tau\ast}|h_{e}(b_{\theta,\psi}({\bm{x}}_{q}^{\tau\ast})),{\bm{\pi}}(\mathcal{D}_{s}^{\tau}),{\bm{\mu}}(\mathcal{D}_{s}^{\tau}),{\bm{\Sigma}}(\mathcal{D}_{s}^{\tau})\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.p8.43" class="ltx_p"><span id="S2.p8.43.1" class="ltx_text ltx_font_smallcaps">FiT</span> training hyper-parameters include a learning rate, <math id="S2.p8.41.m1.1" class="ltx_Math" alttext="|\mathcal{D}_{S}^{\tau}|" display="inline"><semantics id="S2.p8.41.m1.1a"><mrow id="S2.p8.41.m1.1.1.1" xref="S2.p8.41.m1.1.1.2.cmml"><mo stretchy="false" id="S2.p8.41.m1.1.1.1.2" xref="S2.p8.41.m1.1.1.2.1.cmml">|</mo><msubsup id="S2.p8.41.m1.1.1.1.1" xref="S2.p8.41.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p8.41.m1.1.1.1.1.2.2" xref="S2.p8.41.m1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.p8.41.m1.1.1.1.1.2.3" xref="S2.p8.41.m1.1.1.1.1.2.3.cmml">S</mi><mi id="S2.p8.41.m1.1.1.1.1.3" xref="S2.p8.41.m1.1.1.1.1.3.cmml">τ</mi></msubsup><mo stretchy="false" id="S2.p8.41.m1.1.1.1.3" xref="S2.p8.41.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.41.m1.1b"><apply id="S2.p8.41.m1.1.1.2.cmml" xref="S2.p8.41.m1.1.1.1"><abs id="S2.p8.41.m1.1.1.2.1.cmml" xref="S2.p8.41.m1.1.1.1.2"></abs><apply id="S2.p8.41.m1.1.1.1.1.cmml" xref="S2.p8.41.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p8.41.m1.1.1.1.1.1.cmml" xref="S2.p8.41.m1.1.1.1.1">superscript</csymbol><apply id="S2.p8.41.m1.1.1.1.1.2.cmml" xref="S2.p8.41.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p8.41.m1.1.1.1.1.2.1.cmml" xref="S2.p8.41.m1.1.1.1.1">subscript</csymbol><ci id="S2.p8.41.m1.1.1.1.1.2.2.cmml" xref="S2.p8.41.m1.1.1.1.1.2.2">𝒟</ci><ci id="S2.p8.41.m1.1.1.1.1.2.3.cmml" xref="S2.p8.41.m1.1.1.1.1.2.3">𝑆</ci></apply><ci id="S2.p8.41.m1.1.1.1.1.3.cmml" xref="S2.p8.41.m1.1.1.1.1.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.41.m1.1c">|\mathcal{D}_{S}^{\tau}|</annotation></semantics></math>, and the number of training iterations.
For the transfer learning experiments in <a href="#S4" title="4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a> these are set to constant values across all datasets and do not need to be tuned based on a validation set.
We do not augment the training data. In the 1-shot case, we do not perform episodic fine-tuning and leave the FiLM parameters at their initial value of <math id="S2.p8.42.m2.2" class="ltx_Math" alttext="{\bm{\gamma}}=1,{\bm{\beta}}=0" display="inline"><semantics id="S2.p8.42.m2.2a"><mrow id="S2.p8.42.m2.2.2.2" xref="S2.p8.42.m2.2.2.3.cmml"><mrow id="S2.p8.42.m2.1.1.1.1" xref="S2.p8.42.m2.1.1.1.1.cmml"><mi id="S2.p8.42.m2.1.1.1.1.2" xref="S2.p8.42.m2.1.1.1.1.2.cmml">𝜸</mi><mo id="S2.p8.42.m2.1.1.1.1.1" xref="S2.p8.42.m2.1.1.1.1.1.cmml">=</mo><mn id="S2.p8.42.m2.1.1.1.1.3" xref="S2.p8.42.m2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.p8.42.m2.2.2.2.3" xref="S2.p8.42.m2.2.2.3a.cmml">,</mo><mrow id="S2.p8.42.m2.2.2.2.2" xref="S2.p8.42.m2.2.2.2.2.cmml"><mi id="S2.p8.42.m2.2.2.2.2.2" xref="S2.p8.42.m2.2.2.2.2.2.cmml">𝜷</mi><mo id="S2.p8.42.m2.2.2.2.2.1" xref="S2.p8.42.m2.2.2.2.2.1.cmml">=</mo><mn id="S2.p8.42.m2.2.2.2.2.3" xref="S2.p8.42.m2.2.2.2.2.3.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.42.m2.2b"><apply id="S2.p8.42.m2.2.2.3.cmml" xref="S2.p8.42.m2.2.2.2"><csymbol cd="ambiguous" id="S2.p8.42.m2.2.2.3a.cmml" xref="S2.p8.42.m2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.p8.42.m2.1.1.1.1.cmml" xref="S2.p8.42.m2.1.1.1.1"><eq id="S2.p8.42.m2.1.1.1.1.1.cmml" xref="S2.p8.42.m2.1.1.1.1.1"></eq><ci id="S2.p8.42.m2.1.1.1.1.2.cmml" xref="S2.p8.42.m2.1.1.1.1.2">𝜸</ci><cn type="integer" id="S2.p8.42.m2.1.1.1.1.3.cmml" xref="S2.p8.42.m2.1.1.1.1.3">1</cn></apply><apply id="S2.p8.42.m2.2.2.2.2.cmml" xref="S2.p8.42.m2.2.2.2.2"><eq id="S2.p8.42.m2.2.2.2.2.1.cmml" xref="S2.p8.42.m2.2.2.2.2.1"></eq><ci id="S2.p8.42.m2.2.2.2.2.2.cmml" xref="S2.p8.42.m2.2.2.2.2.2">𝜷</ci><cn type="integer" id="S2.p8.42.m2.2.2.2.2.3.cmml" xref="S2.p8.42.m2.2.2.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.42.m2.2c">{\bm{\gamma}}=1,{\bm{\beta}}=0</annotation></semantics></math> and <math id="S2.p8.43.m3.3" class="ltx_Math" alttext="{\bm{e}}=(0.5,0.5,1.0)" display="inline"><semantics id="S2.p8.43.m3.3a"><mrow id="S2.p8.43.m3.3.4" xref="S2.p8.43.m3.3.4.cmml"><mi id="S2.p8.43.m3.3.4.2" xref="S2.p8.43.m3.3.4.2.cmml">𝒆</mi><mo id="S2.p8.43.m3.3.4.1" xref="S2.p8.43.m3.3.4.1.cmml">=</mo><mrow id="S2.p8.43.m3.3.4.3.2" xref="S2.p8.43.m3.3.4.3.1.cmml"><mo stretchy="false" id="S2.p8.43.m3.3.4.3.2.1" xref="S2.p8.43.m3.3.4.3.1.cmml">(</mo><mn id="S2.p8.43.m3.1.1" xref="S2.p8.43.m3.1.1.cmml">0.5</mn><mo id="S2.p8.43.m3.3.4.3.2.2" xref="S2.p8.43.m3.3.4.3.1.cmml">,</mo><mn id="S2.p8.43.m3.2.2" xref="S2.p8.43.m3.2.2.cmml">0.5</mn><mo id="S2.p8.43.m3.3.4.3.2.3" xref="S2.p8.43.m3.3.4.3.1.cmml">,</mo><mn id="S2.p8.43.m3.3.3" xref="S2.p8.43.m3.3.3.cmml">1.0</mn><mo stretchy="false" id="S2.p8.43.m3.3.4.3.2.4" xref="S2.p8.43.m3.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.43.m3.3b"><apply id="S2.p8.43.m3.3.4.cmml" xref="S2.p8.43.m3.3.4"><eq id="S2.p8.43.m3.3.4.1.cmml" xref="S2.p8.43.m3.3.4.1"></eq><ci id="S2.p8.43.m3.3.4.2.cmml" xref="S2.p8.43.m3.3.4.2">𝒆</ci><vector id="S2.p8.43.m3.3.4.3.1.cmml" xref="S2.p8.43.m3.3.4.3.2"><cn type="float" id="S2.p8.43.m3.1.1.cmml" xref="S2.p8.43.m3.1.1">0.5</cn><cn type="float" id="S2.p8.43.m3.2.2.cmml" xref="S2.p8.43.m3.2.2">0.5</cn><cn type="float" id="S2.p8.43.m3.3.3.cmml" xref="S2.p8.43.m3.3.3">1.0</cn></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.43.m3.3c">{\bm{e}}=(0.5,0.5,1.0)</annotation></semantics></math> and predict as described next.
In <a href="#S4" title="4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a> we show this can yield results that better those when augmentation and training steps are taken on 1-shot data.</p>
</div>
<div id="S2.p9" class="ltx_para ltx_noindent">
<p id="S2.p9.7" class="ltx_p"><span id="S2.p9.7.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FiT<span id="S2.p9.7.1.1" class="ltx_text ltx_font_upright"> Prediction</span></span>

Once the FiLM parameters <math id="S2.p9.1.m1.1" class="ltx_Math" alttext="{\bm{\psi}}" display="inline"><semantics id="S2.p9.1.m1.1a"><mi id="S2.p9.1.m1.1.1" xref="S2.p9.1.m1.1.1.cmml">𝝍</mi><annotation-xml encoding="MathML-Content" id="S2.p9.1.m1.1b"><ci id="S2.p9.1.m1.1.1.cmml" xref="S2.p9.1.m1.1.1">𝝍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p9.1.m1.1c">{\bm{\psi}}</annotation></semantics></math> and covariance weights <math id="S2.p9.2.m2.1" class="ltx_Math" alttext="{\bm{e}}" display="inline"><semantics id="S2.p9.2.m2.1a"><mi id="S2.p9.2.m2.1.1" xref="S2.p9.2.m2.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="S2.p9.2.m2.1b"><ci id="S2.p9.2.m2.1.1.cmml" xref="S2.p9.2.m2.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p9.2.m2.1c">{\bm{e}}</annotation></semantics></math> have been learned, we use <math id="S2.p9.3.m3.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.p9.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p9.3.m3.1.1" xref="S2.p9.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p9.3.m3.1b"><ci id="S2.p9.3.m3.1.1.cmml" xref="S2.p9.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p9.3.m3.1c">\mathcal{D}</annotation></semantics></math> for the support set to compute <math id="S2.p9.4.m4.1" class="ltx_Math" alttext="\pi_{c}" display="inline"><semantics id="S2.p9.4.m4.1a"><msub id="S2.p9.4.m4.1.1" xref="S2.p9.4.m4.1.1.cmml"><mi id="S2.p9.4.m4.1.1.2" xref="S2.p9.4.m4.1.1.2.cmml">π</mi><mi id="S2.p9.4.m4.1.1.3" xref="S2.p9.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p9.4.m4.1b"><apply id="S2.p9.4.m4.1.1.cmml" xref="S2.p9.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p9.4.m4.1.1.1.cmml" xref="S2.p9.4.m4.1.1">subscript</csymbol><ci id="S2.p9.4.m4.1.1.2.cmml" xref="S2.p9.4.m4.1.1.2">𝜋</ci><ci id="S2.p9.4.m4.1.1.3.cmml" xref="S2.p9.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p9.4.m4.1c">\pi_{c}</annotation></semantics></math>, <math id="S2.p9.5.m5.1" class="ltx_Math" alttext="\mu_{c}" display="inline"><semantics id="S2.p9.5.m5.1a"><msub id="S2.p9.5.m5.1.1" xref="S2.p9.5.m5.1.1.cmml"><mi id="S2.p9.5.m5.1.1.2" xref="S2.p9.5.m5.1.1.2.cmml">μ</mi><mi id="S2.p9.5.m5.1.1.3" xref="S2.p9.5.m5.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p9.5.m5.1b"><apply id="S2.p9.5.m5.1.1.cmml" xref="S2.p9.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p9.5.m5.1.1.1.cmml" xref="S2.p9.5.m5.1.1">subscript</csymbol><ci id="S2.p9.5.m5.1.1.2.cmml" xref="S2.p9.5.m5.1.1.2">𝜇</ci><ci id="S2.p9.5.m5.1.1.3.cmml" xref="S2.p9.5.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p9.5.m5.1c">\mu_{c}</annotation></semantics></math>, and <math id="S2.p9.6.m6.1" class="ltx_Math" alttext="\Sigma_{c}" display="inline"><semantics id="S2.p9.6.m6.1a"><msub id="S2.p9.6.m6.1.1" xref="S2.p9.6.m6.1.1.cmml"><mi mathvariant="normal" id="S2.p9.6.m6.1.1.2" xref="S2.p9.6.m6.1.1.2.cmml">Σ</mi><mi id="S2.p9.6.m6.1.1.3" xref="S2.p9.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p9.6.m6.1b"><apply id="S2.p9.6.m6.1.1.cmml" xref="S2.p9.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p9.6.m6.1.1.1.cmml" xref="S2.p9.6.m6.1.1">subscript</csymbol><ci id="S2.p9.6.m6.1.1.2.cmml" xref="S2.p9.6.m6.1.1.2">Σ</ci><ci id="S2.p9.6.m6.1.1.3.cmml" xref="S2.p9.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p9.6.m6.1c">\Sigma_{c}</annotation></semantics></math> for each class <math id="S2.p9.7.m7.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.p9.7.m7.1a"><mi id="S2.p9.7.m7.1.1" xref="S2.p9.7.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.p9.7.m7.1b"><ci id="S2.p9.7.m7.1.1.cmml" xref="S2.p9.7.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p9.7.m7.1c">c</annotation></semantics></math> and then <a href="#S2.E1" title="In 2 FiLM Transfer (FiT) ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a> can be used to make a prediction for any unseen test input.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Related Work</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">We take inspiration from residual adapters <cite class="ltx_cite ltx_citemacro_citep">(Rebuffi et al., <a href="#bib.bib47" title="" class="ltx_ref">2017</a>; <a href="#bib.bib48" title="" class="ltx_ref">2018</a>)</cite> where parameter efficient adapters are inserted into a ResNet with frozen pretrained weights.
The adapter parameters and the final layer linear classifier are then learned via fine-tuning.
More recently, a myriad of additional parameter efficient adapters have been proposed including FiLM, Adapter <cite class="ltx_cite ltx_citemacro_citep">(Houlsby et al., <a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite>, LoRA <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite>, VPT <cite class="ltx_cite ltx_citemacro_citep">(Jia et al., <a href="#bib.bib23" title="" class="ltx_ref">2022</a>)</cite>, AdaptFormer <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib6" title="" class="ltx_ref">2022</a>)</cite>, NOAH <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib65" title="" class="ltx_ref">2022</a>)</cite>, Convpass <cite class="ltx_cite ltx_citemacro_citep">(Jie &amp; Deng, <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite>, <cite class="ltx_cite ltx_citemacro_citep">(Mudrakarta et al., <a href="#bib.bib39" title="" class="ltx_ref">2019</a>)</cite>, and CaSE <cite class="ltx_cite ltx_citemacro_citep">(Patacchiola et al., <a href="#bib.bib44" title="" class="ltx_ref">2022</a>)</cite>.
For <span id="S3.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> we use FiLM as it is the most parameter efficient adapter, yet it allows for expressive adaptation, and can be used in various backbone architectures including ConvNets and Transformers.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p">To date, transfer learning systems that employ adapters use a linear head for the final classification layer.
In meta-learning systems it is common to use metric learning heads (e.g. ProtoNets <cite class="ltx_cite ltx_citemacro_citep">(Snell et al., <a href="#bib.bib54" title="" class="ltx_ref">2017</a>)</cite>), which have no or few learnable parameters.
Meta-Learning systems that employ a metric learning head are normally trained with an episodic training regime <cite class="ltx_cite ltx_citemacro_citep">(Vinyals et al., <a href="#bib.bib59" title="" class="ltx_ref">2016</a>)</cite>.
Some of these approaches (e.g. TADAM <cite class="ltx_cite ltx_citemacro_citep">(Oreshkin et al., <a href="#bib.bib42" title="" class="ltx_ref">2018</a>)</cite>, FLUTE <cite class="ltx_cite ltx_citemacro_citep">(Triantafillou et al., <a href="#bib.bib57" title="" class="ltx_ref">2021</a>)</cite>, and Simple CNAPs <cite class="ltx_cite ltx_citemacro_citep">(Bateni et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite> use both a metric head and FiLM layers to adapt the backbone.
<span id="S3.p2.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> differs from all of the preceding approaches by using a powerful Naive Bayes metric head that uses episodic fine-tuning in the context of transfer learning, as opposed to the usual meta-learning.
We show in <a href="#S2.F2.sf1" title="In Figure 2 ‣ 2 FiLM Transfer (FiT) ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(a)</span></a> and <a href="#S4" title="4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a> that the episodically fine-tuned Naive Bayes head consistently outperforms a conventional batch trained linear head in the low-shot transfer learning setting.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">In this section, we evaluate the classification accuracy and updateable parameter efficiency of <span id="S4.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> in a series of challenging benchmarks and application scenarios.
In all experiments, we use Big Transfer (BiT) <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite>, a leading, scalable, general purpose transfer learning algorithm as a point of comparison.
First, we compare different variations of <span id="S4.p1.1.2" class="ltx_text ltx_font_smallcaps">FiT</span> to BiT on several standard downstream datasets in the few-shot regime.
Second, we evaluate <span id="S4.p1.1.3" class="ltx_text ltx_font_smallcaps">FiT</span> against BiT on VTAB-1k <cite class="ltx_cite ltx_citemacro_citep">(Zhai et al., <a href="#bib.bib64" title="" class="ltx_ref">2019</a>)</cite>, which is arguably the most challenging transfer learning benchmark.
Additionally, we compare <span id="S4.p1.1.4" class="ltx_text ltx_font_smallcaps">FiT</span> to the latest vision transformer based methods that have reported the highest accuracies on VTAB-1k to date.
Third, we show how <span id="S4.p1.1.5" class="ltx_text ltx_font_smallcaps">FiT</span> can be used in a personalization scenario on the ORBIT <cite class="ltx_cite ltx_citemacro_citep">(Massiceti et al., <a href="#bib.bib35" title="" class="ltx_ref">2021</a>)</cite> dataset, where a smaller updateable model is an important evaluation metric.
Finally, we apply <span id="S4.p1.1.6" class="ltx_text ltx_font_smallcaps">FiT</span> to a few-shot federated learning scenario where minimizing the number of parameter updates and their size is a key requirement.
Training and evaluation details are in <a href="#A1.SS11" title="A.11 Training and Evaluation Details ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.11</span></a>.
Source code for experiments can be found at: <a target="_blank" href="https://github.com/cambridge-mlg/fit" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/cambridge-mlg/fit</a>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Few-shot Results</h3>

<figure id="S4.F3" class="ltx_figure"><img src="/html/2206.08671/assets/x4.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="144" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S4.F3.3.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FiT<span id="S4.F3.3.1.1" class="ltx_text ltx_font_upright">-LDA outperforms BiT at low-shot.</span></span> Classification accuracy as a function of the number of updateable parameters (log scale) and shots per class for <span id="S4.F3.4.2" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA and BiT on four downstream datasets. Classification accuracy is on the vertical axis and is the average of 3 runs with different data sampling seeds. The dot size from smallest to largest indicates the number of shots per class — 1, 2, 5, 10, and All. A tabular version with results for additional variants is in <a href="#A1.T1" title="In A.4.1 Additional Few-shot Results ‣ A.4 Additional Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.1</span></a>.</figcaption>
</figure>
<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><a href="#S4.F3" title="In 4.1 Few-shot Results ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a> shows the classification accuracy as a function of updateable parameters for <span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA and BiT on four downstream datasets (CIFAR10, CIFAR100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib31" title="" class="ltx_ref">2009</a>)</cite>, Pets <cite class="ltx_cite ltx_citemacro_citep">(Parkhi et al., <a href="#bib.bib43" title="" class="ltx_ref">2012</a>)</cite>, and Flowers <cite class="ltx_cite ltx_citemacro_citep">(Nilsback &amp; Zisserman, <a href="#bib.bib41" title="" class="ltx_ref">2008</a>)</cite>) that were used to evaluate the performance of BiT <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite>.
<a href="#A1.T1" title="In A.4.1 Additional Few-shot Results ‣ A.4 Additional Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.1</span></a> contains complete tabular results with additional variants of <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_smallcaps">FiT</span> and BiT.
All methods use the BiT-M-R50x1 <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite> backbone that is pretrained on the ImageNet-21K <cite class="ltx_cite ltx_citemacro_citep">(Russakovsky et al., <a href="#bib.bib51" title="" class="ltx_ref">2015</a>)</cite> dataset.
The key observations from <a href="#S4.F3" title="In 4.1 Few-shot Results ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a> are:</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p">For <math id="S4.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\leq" display="inline"><semantics id="S4.I1.i1.p1.1.m1.1a"><mo id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml">≤</mo><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><leq id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"></leq></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">\leq</annotation></semantics></math>10 shots (except 1-shot on CIFAR100), <span id="S4.I1.i1.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA outperforms BiT, often by a large margin.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p">On 3 out of 4 datasets, <span id="S4.I1.i2.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA outperforms BiT even when all of <math id="S4.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S4.I1.i2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><ci id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">\mathcal{D}</annotation></semantics></math> is used for fine-tuning.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p"><span id="S4.I1.i3.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA outperforms BiT despite BiT having more than 100 times as many updateable parameters.</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="S4.I1.i4.p1.6" class="ltx_p">To avoid overfitting when <math id="S4.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S4.I1.i4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i4.p1.1.m1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.1.m1.1b"><ci id="S4.I1.i4.p1.1.m1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.1.m1.1c">\mathcal{D}</annotation></semantics></math> is small, <a href="#A1.T2" title="In A.4.2 Few-shot Task Ablations ‣ A.4 Additional Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.2</span></a> indicates that it is better to split <math id="S4.I1.i4.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S4.I1.i4.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i4.p1.2.m2.1.1" xref="S4.I1.i4.p1.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.2.m2.1b"><ci id="S4.I1.i4.p1.2.m2.1.1.cmml" xref="S4.I1.i4.p1.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.2.m2.1c">\mathcal{D}</annotation></semantics></math> into two disjoint partitions <math id="S4.I1.i4.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="S4.I1.i4.p1.3.m3.1a"><msub id="S4.I1.i4.p1.3.m3.1.1" xref="S4.I1.i4.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i4.p1.3.m3.1.1.2" xref="S4.I1.i4.p1.3.m3.1.1.2.cmml">𝒟</mi><mrow id="S4.I1.i4.p1.3.m3.1.1.3" xref="S4.I1.i4.p1.3.m3.1.1.3.cmml"><mi id="S4.I1.i4.p1.3.m3.1.1.3.2" xref="S4.I1.i4.p1.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.I1.i4.p1.3.m3.1.1.3.1" xref="S4.I1.i4.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.I1.i4.p1.3.m3.1.1.3.3" xref="S4.I1.i4.p1.3.m3.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.I1.i4.p1.3.m3.1.1.3.1a" xref="S4.I1.i4.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.I1.i4.p1.3.m3.1.1.3.4" xref="S4.I1.i4.p1.3.m3.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.I1.i4.p1.3.m3.1.1.3.1b" xref="S4.I1.i4.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.I1.i4.p1.3.m3.1.1.3.5" xref="S4.I1.i4.p1.3.m3.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.I1.i4.p1.3.m3.1.1.3.1c" xref="S4.I1.i4.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.I1.i4.p1.3.m3.1.1.3.6" xref="S4.I1.i4.p1.3.m3.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.3.m3.1b"><apply id="S4.I1.i4.p1.3.m3.1.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.3.m3.1.1.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.3.m3.1.1.2.cmml" xref="S4.I1.i4.p1.3.m3.1.1.2">𝒟</ci><apply id="S4.I1.i4.p1.3.m3.1.1.3.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3"><times id="S4.I1.i4.p1.3.m3.1.1.3.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.1"></times><ci id="S4.I1.i4.p1.3.m3.1.1.3.2.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S4.I1.i4.p1.3.m3.1.1.3.3.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.3">𝑟</ci><ci id="S4.I1.i4.p1.3.m3.1.1.3.4.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.4">𝑎</ci><ci id="S4.I1.i4.p1.3.m3.1.1.3.5.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.5">𝑖</ci><ci id="S4.I1.i4.p1.3.m3.1.1.3.6.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.3.m3.1c">\mathcal{D}_{train}</annotation></semantics></math> and <math id="S4.I1.i4.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="S4.I1.i4.p1.4.m4.1a"><msub id="S4.I1.i4.p1.4.m4.1.1" xref="S4.I1.i4.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i4.p1.4.m4.1.1.2" xref="S4.I1.i4.p1.4.m4.1.1.2.cmml">𝒟</mi><mrow id="S4.I1.i4.p1.4.m4.1.1.3" xref="S4.I1.i4.p1.4.m4.1.1.3.cmml"><mi id="S4.I1.i4.p1.4.m4.1.1.3.2" xref="S4.I1.i4.p1.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.I1.i4.p1.4.m4.1.1.3.1" xref="S4.I1.i4.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.I1.i4.p1.4.m4.1.1.3.3" xref="S4.I1.i4.p1.4.m4.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.I1.i4.p1.4.m4.1.1.3.1a" xref="S4.I1.i4.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.I1.i4.p1.4.m4.1.1.3.4" xref="S4.I1.i4.p1.4.m4.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.I1.i4.p1.4.m4.1.1.3.1b" xref="S4.I1.i4.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.I1.i4.p1.4.m4.1.1.3.5" xref="S4.I1.i4.p1.4.m4.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.4.m4.1b"><apply id="S4.I1.i4.p1.4.m4.1.1.cmml" xref="S4.I1.i4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.4.m4.1.1.1.cmml" xref="S4.I1.i4.p1.4.m4.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.4.m4.1.1.2.cmml" xref="S4.I1.i4.p1.4.m4.1.1.2">𝒟</ci><apply id="S4.I1.i4.p1.4.m4.1.1.3.cmml" xref="S4.I1.i4.p1.4.m4.1.1.3"><times id="S4.I1.i4.p1.4.m4.1.1.3.1.cmml" xref="S4.I1.i4.p1.4.m4.1.1.3.1"></times><ci id="S4.I1.i4.p1.4.m4.1.1.3.2.cmml" xref="S4.I1.i4.p1.4.m4.1.1.3.2">𝑡</ci><ci id="S4.I1.i4.p1.4.m4.1.1.3.3.cmml" xref="S4.I1.i4.p1.4.m4.1.1.3.3">𝑒</ci><ci id="S4.I1.i4.p1.4.m4.1.1.3.4.cmml" xref="S4.I1.i4.p1.4.m4.1.1.3.4">𝑠</ci><ci id="S4.I1.i4.p1.4.m4.1.1.3.5.cmml" xref="S4.I1.i4.p1.4.m4.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.4.m4.1c">\mathcal{D}_{test}</annotation></semantics></math> and that <math id="S4.I1.i4.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{S}^{\tau}" display="inline"><semantics id="S4.I1.i4.p1.5.m5.1a"><msubsup id="S4.I1.i4.p1.5.m5.1.1" xref="S4.I1.i4.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i4.p1.5.m5.1.1.2.2" xref="S4.I1.i4.p1.5.m5.1.1.2.2.cmml">𝒟</mi><mi id="S4.I1.i4.p1.5.m5.1.1.2.3" xref="S4.I1.i4.p1.5.m5.1.1.2.3.cmml">S</mi><mi id="S4.I1.i4.p1.5.m5.1.1.3" xref="S4.I1.i4.p1.5.m5.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.5.m5.1b"><apply id="S4.I1.i4.p1.5.m5.1.1.cmml" xref="S4.I1.i4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.5.m5.1.1.1.cmml" xref="S4.I1.i4.p1.5.m5.1.1">superscript</csymbol><apply id="S4.I1.i4.p1.5.m5.1.1.2.cmml" xref="S4.I1.i4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.5.m5.1.1.2.1.cmml" xref="S4.I1.i4.p1.5.m5.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.5.m5.1.1.2.2.cmml" xref="S4.I1.i4.p1.5.m5.1.1.2.2">𝒟</ci><ci id="S4.I1.i4.p1.5.m5.1.1.2.3.cmml" xref="S4.I1.i4.p1.5.m5.1.1.2.3">𝑆</ci></apply><ci id="S4.I1.i4.p1.5.m5.1.1.3.cmml" xref="S4.I1.i4.p1.5.m5.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.5.m5.1c">\mathcal{D}_{S}^{\tau}</annotation></semantics></math> and <math id="S4.I1.i4.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{Q}^{\tau}" display="inline"><semantics id="S4.I1.i4.p1.6.m6.1a"><msubsup id="S4.I1.i4.p1.6.m6.1.1" xref="S4.I1.i4.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i4.p1.6.m6.1.1.2.2" xref="S4.I1.i4.p1.6.m6.1.1.2.2.cmml">𝒟</mi><mi id="S4.I1.i4.p1.6.m6.1.1.2.3" xref="S4.I1.i4.p1.6.m6.1.1.2.3.cmml">Q</mi><mi id="S4.I1.i4.p1.6.m6.1.1.3" xref="S4.I1.i4.p1.6.m6.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.6.m6.1b"><apply id="S4.I1.i4.p1.6.m6.1.1.cmml" xref="S4.I1.i4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.6.m6.1.1.1.cmml" xref="S4.I1.i4.p1.6.m6.1.1">superscript</csymbol><apply id="S4.I1.i4.p1.6.m6.1.1.2.cmml" xref="S4.I1.i4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.6.m6.1.1.2.1.cmml" xref="S4.I1.i4.p1.6.m6.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.6.m6.1.1.2.2.cmml" xref="S4.I1.i4.p1.6.m6.1.1.2.2">𝒟</ci><ci id="S4.I1.i4.p1.6.m6.1.1.2.3.cmml" xref="S4.I1.i4.p1.6.m6.1.1.2.3">𝑄</ci></apply><ci id="S4.I1.i4.p1.6.m6.1.1.3.cmml" xref="S4.I1.i4.p1.6.m6.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.6.m6.1c">\mathcal{D}_{Q}^{\tau}</annotation></semantics></math> should be randomly sub-sampled as opposed to using all of the data in each training iteration.</p>
</div>
</li>
</ul>
<p id="S4.SS1.p1.2" class="ltx_p">The datasets used in this section were similar in content to the dataset used for pretraining and the performance of <span id="S4.SS1.p1.2.1" class="ltx_text ltx_font_smallcaps">FiT</span>-QDA and <span id="S4.SS1.p1.2.2" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA was similar, indicating that the covariance per class was not that useful for these datasets.
In the next section, we test on a wider variety of datasets, many of which differ greatly from the upstream data.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>VTAB-1k Results</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">The VTAB-1k benchmark <cite class="ltx_cite ltx_citemacro_citep">(Zhai et al., <a href="#bib.bib64" title="" class="ltx_ref">2019</a>)</cite> is a low to medium-shot transfer learning benchmark that consists of 19 datasets grouped into three distinct categories (natural, specialized, and structured).
From each dataset, 1000 examples are drawn at random from the training split to use for the downstream dataset <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mathcal{D}</annotation></semantics></math>.
After fine-tuning, the entire test split is used to evaluate classification performance.
<a href="#S4.T2" title="In 4.2 VTAB-1k Results ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">2</span></a> shows the classification accuracy and updateable parameter count for the three variants of <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> and BiT (see <a href="#A1.T3" title="In A.5 Additional VTAB-1k Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.3</span></a> for error bars).
The key observations from our results are:</p>
<ul id="S4.I2" class="ltx_itemize">
<li id="S4.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i1.p1" class="ltx_para">
<p id="S4.I2.i1.p1.1" class="ltx_p">Both <span id="S4.I2.i1.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-QDA and <span id="S4.I2.i1.p1.1.2" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA outperform BiT on VTAB-1k.</p>
</div>
</li>
<li id="S4.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i2.p1" class="ltx_para">
<p id="S4.I2.i2.p1.1" class="ltx_p">The <span id="S4.I2.i2.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-QDA variant has the best overall performance, showing that the class covariance is important to achieve superior results on datasets that differ from those used in upstream pretraining (e.g. the structured category of datasets). However, the updateable parameter cost is high.</p>
</div>
</li>
<li id="S4.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i3.p1" class="ltx_para">
<p id="S4.I2.i3.p1.1" class="ltx_p"><span id="S4.I2.i3.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA utilizes two orders of magnitude fewer updateable parameters compared to BiT, making it the preferred approach.</p>
</div>
</li>
<li id="S4.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i4.p1" class="ltx_para ltx_noindent">
<p id="S4.I2.i4.p1.5" class="ltx_p"><a href="#A1.T4" title="In A.5.1 VTAB-1k Task Ablations ‣ A.5 Additional VTAB-1k Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.4</span></a> shows that it is best to use all of <math id="S4.I2.i4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S4.I2.i4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.I2.i4.p1.1.m1.1.1" xref="S4.I2.i4.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.1.m1.1b"><ci id="S4.I2.i4.p1.1.m1.1.1.cmml" xref="S4.I2.i4.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.1.m1.1c">\mathcal{D}</annotation></semantics></math> for each of <math id="S4.I2.i4.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="S4.I2.i4.p1.2.m2.1a"><msub id="S4.I2.i4.p1.2.m2.1.1" xref="S4.I2.i4.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I2.i4.p1.2.m2.1.1.2" xref="S4.I2.i4.p1.2.m2.1.1.2.cmml">𝒟</mi><mrow id="S4.I2.i4.p1.2.m2.1.1.3" xref="S4.I2.i4.p1.2.m2.1.1.3.cmml"><mi id="S4.I2.i4.p1.2.m2.1.1.3.2" xref="S4.I2.i4.p1.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.I2.i4.p1.2.m2.1.1.3.1" xref="S4.I2.i4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.I2.i4.p1.2.m2.1.1.3.3" xref="S4.I2.i4.p1.2.m2.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.I2.i4.p1.2.m2.1.1.3.1a" xref="S4.I2.i4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.I2.i4.p1.2.m2.1.1.3.4" xref="S4.I2.i4.p1.2.m2.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.I2.i4.p1.2.m2.1.1.3.1b" xref="S4.I2.i4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.I2.i4.p1.2.m2.1.1.3.5" xref="S4.I2.i4.p1.2.m2.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.I2.i4.p1.2.m2.1.1.3.1c" xref="S4.I2.i4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.I2.i4.p1.2.m2.1.1.3.6" xref="S4.I2.i4.p1.2.m2.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.2.m2.1b"><apply id="S4.I2.i4.p1.2.m2.1.1.cmml" xref="S4.I2.i4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I2.i4.p1.2.m2.1.1.1.cmml" xref="S4.I2.i4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I2.i4.p1.2.m2.1.1.2.cmml" xref="S4.I2.i4.p1.2.m2.1.1.2">𝒟</ci><apply id="S4.I2.i4.p1.2.m2.1.1.3.cmml" xref="S4.I2.i4.p1.2.m2.1.1.3"><times id="S4.I2.i4.p1.2.m2.1.1.3.1.cmml" xref="S4.I2.i4.p1.2.m2.1.1.3.1"></times><ci id="S4.I2.i4.p1.2.m2.1.1.3.2.cmml" xref="S4.I2.i4.p1.2.m2.1.1.3.2">𝑡</ci><ci id="S4.I2.i4.p1.2.m2.1.1.3.3.cmml" xref="S4.I2.i4.p1.2.m2.1.1.3.3">𝑟</ci><ci id="S4.I2.i4.p1.2.m2.1.1.3.4.cmml" xref="S4.I2.i4.p1.2.m2.1.1.3.4">𝑎</ci><ci id="S4.I2.i4.p1.2.m2.1.1.3.5.cmml" xref="S4.I2.i4.p1.2.m2.1.1.3.5">𝑖</ci><ci id="S4.I2.i4.p1.2.m2.1.1.3.6.cmml" xref="S4.I2.i4.p1.2.m2.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.2.m2.1c">\mathcal{D}_{train}</annotation></semantics></math> and <math id="S4.I2.i4.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="S4.I2.i4.p1.3.m3.1a"><msub id="S4.I2.i4.p1.3.m3.1.1" xref="S4.I2.i4.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I2.i4.p1.3.m3.1.1.2" xref="S4.I2.i4.p1.3.m3.1.1.2.cmml">𝒟</mi><mrow id="S4.I2.i4.p1.3.m3.1.1.3" xref="S4.I2.i4.p1.3.m3.1.1.3.cmml"><mi id="S4.I2.i4.p1.3.m3.1.1.3.2" xref="S4.I2.i4.p1.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.I2.i4.p1.3.m3.1.1.3.1" xref="S4.I2.i4.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.I2.i4.p1.3.m3.1.1.3.3" xref="S4.I2.i4.p1.3.m3.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.I2.i4.p1.3.m3.1.1.3.1a" xref="S4.I2.i4.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.I2.i4.p1.3.m3.1.1.3.4" xref="S4.I2.i4.p1.3.m3.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.I2.i4.p1.3.m3.1.1.3.1b" xref="S4.I2.i4.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.I2.i4.p1.3.m3.1.1.3.5" xref="S4.I2.i4.p1.3.m3.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.3.m3.1b"><apply id="S4.I2.i4.p1.3.m3.1.1.cmml" xref="S4.I2.i4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I2.i4.p1.3.m3.1.1.1.cmml" xref="S4.I2.i4.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I2.i4.p1.3.m3.1.1.2.cmml" xref="S4.I2.i4.p1.3.m3.1.1.2">𝒟</ci><apply id="S4.I2.i4.p1.3.m3.1.1.3.cmml" xref="S4.I2.i4.p1.3.m3.1.1.3"><times id="S4.I2.i4.p1.3.m3.1.1.3.1.cmml" xref="S4.I2.i4.p1.3.m3.1.1.3.1"></times><ci id="S4.I2.i4.p1.3.m3.1.1.3.2.cmml" xref="S4.I2.i4.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S4.I2.i4.p1.3.m3.1.1.3.3.cmml" xref="S4.I2.i4.p1.3.m3.1.1.3.3">𝑒</ci><ci id="S4.I2.i4.p1.3.m3.1.1.3.4.cmml" xref="S4.I2.i4.p1.3.m3.1.1.3.4">𝑠</ci><ci id="S4.I2.i4.p1.3.m3.1.1.3.5.cmml" xref="S4.I2.i4.p1.3.m3.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.3.m3.1c">\mathcal{D}_{test}</annotation></semantics></math> (i.e. no split) and that <math id="S4.I2.i4.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{S}^{\tau}" display="inline"><semantics id="S4.I2.i4.p1.4.m4.1a"><msubsup id="S4.I2.i4.p1.4.m4.1.1" xref="S4.I2.i4.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I2.i4.p1.4.m4.1.1.2.2" xref="S4.I2.i4.p1.4.m4.1.1.2.2.cmml">𝒟</mi><mi id="S4.I2.i4.p1.4.m4.1.1.2.3" xref="S4.I2.i4.p1.4.m4.1.1.2.3.cmml">S</mi><mi id="S4.I2.i4.p1.4.m4.1.1.3" xref="S4.I2.i4.p1.4.m4.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.4.m4.1b"><apply id="S4.I2.i4.p1.4.m4.1.1.cmml" xref="S4.I2.i4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I2.i4.p1.4.m4.1.1.1.cmml" xref="S4.I2.i4.p1.4.m4.1.1">superscript</csymbol><apply id="S4.I2.i4.p1.4.m4.1.1.2.cmml" xref="S4.I2.i4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I2.i4.p1.4.m4.1.1.2.1.cmml" xref="S4.I2.i4.p1.4.m4.1.1">subscript</csymbol><ci id="S4.I2.i4.p1.4.m4.1.1.2.2.cmml" xref="S4.I2.i4.p1.4.m4.1.1.2.2">𝒟</ci><ci id="S4.I2.i4.p1.4.m4.1.1.2.3.cmml" xref="S4.I2.i4.p1.4.m4.1.1.2.3">𝑆</ci></apply><ci id="S4.I2.i4.p1.4.m4.1.1.3.cmml" xref="S4.I2.i4.p1.4.m4.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.4.m4.1c">\mathcal{D}_{S}^{\tau}</annotation></semantics></math> and <math id="S4.I2.i4.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{Q}^{\tau}" display="inline"><semantics id="S4.I2.i4.p1.5.m5.1a"><msubsup id="S4.I2.i4.p1.5.m5.1.1" xref="S4.I2.i4.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I2.i4.p1.5.m5.1.1.2.2" xref="S4.I2.i4.p1.5.m5.1.1.2.2.cmml">𝒟</mi><mi id="S4.I2.i4.p1.5.m5.1.1.2.3" xref="S4.I2.i4.p1.5.m5.1.1.2.3.cmml">Q</mi><mi id="S4.I2.i4.p1.5.m5.1.1.3" xref="S4.I2.i4.p1.5.m5.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.5.m5.1b"><apply id="S4.I2.i4.p1.5.m5.1.1.cmml" xref="S4.I2.i4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I2.i4.p1.5.m5.1.1.1.cmml" xref="S4.I2.i4.p1.5.m5.1.1">superscript</csymbol><apply id="S4.I2.i4.p1.5.m5.1.1.2.cmml" xref="S4.I2.i4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I2.i4.p1.5.m5.1.1.2.1.cmml" xref="S4.I2.i4.p1.5.m5.1.1">subscript</csymbol><ci id="S4.I2.i4.p1.5.m5.1.1.2.2.cmml" xref="S4.I2.i4.p1.5.m5.1.1.2.2">𝒟</ci><ci id="S4.I2.i4.p1.5.m5.1.1.2.3.cmml" xref="S4.I2.i4.p1.5.m5.1.1.2.3">𝑄</ci></apply><ci id="S4.I2.i4.p1.5.m5.1.1.3.cmml" xref="S4.I2.i4.p1.5.m5.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.5.m5.1c">\mathcal{D}_{Q}^{\tau}</annotation></semantics></math> should be episodically sub-sampled as opposed to using all of the data in each iteration.</p>
</div>
</li>
</ul>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span><span id="S4.T2.3.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FiT<span id="S4.T2.3.1.1" class="ltx_text ltx_font_upright"> outperforms BiT on VTAB-1k.</span></span> Classification accuracy and updateable parameter count (with 10 classes) for <span id="S4.T2.4.2" class="ltx_text ltx_font_smallcaps">FiT</span> variants and BiT on VTAB-1k with BiT-M-R50x1 backbone. Accuracy figures are percentages. Bold type indicates the highest scores. Green indicates summary columns.</figcaption>
<div id="S4.T2.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:88.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-152.0pt,34.0pt) scale(0.56655,0.56655) ;">
<p id="S4.T2.5.1" class="ltx_p"><span id="S4.T2.5.1.1" class="ltx_text">
<span id="S4.T2.5.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:701.6pt;height:156.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S4.T2.5.1.1.1.1" class="ltx_p"><span id="S4.T2.5.1.1.1.1.1" class="ltx_text">
<span id="S4.T2.5.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S4.T2.5.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S4.T2.5.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_tt"></span>
<span id="S4.T2.5.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="S4.T2.5.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="S4.T2.5.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_7"><span id="S4.T2.5.1.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">Natural</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_4"><span id="S4.T2.5.1.1.1.1.1.1.1.1.5.1" class="ltx_text ltx_font_bold">Specialized</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_8"><span id="S4.T2.5.1.1.1.1.1.1.1.1.6.1" class="ltx_text ltx_font_bold">Structured</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2" class="ltx_tr">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row">Method</span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.2.1" class="ltx_inline-block ltx_transformed_outer" style="width:10.0pt;height:61.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:61.3pt;transform:translate(-25.67pt,-24.42pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.2.1.1" class="ltx_p">Params (M) ↓</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.3.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:59.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:59.8pt;transform:translate(-25.43pt,-24.46pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.3.1.1" class="ltx_p">Overall Acc ↑</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.4.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:48.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:48.1pt;transform:translate(-20.56pt,-20.56pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.4.1.1" class="ltx_p">Caltech101</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:46.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:46.1pt;transform:translate(-19.64pt,-19.64pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.5.1.1" class="ltx_p">CIFAR100</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.6.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:48.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:48.3pt;transform:translate(-20.67pt,-20.67pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.6.1.1" class="ltx_p">Flowers102</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.7.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:18.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:18.8pt;transform:translate(-5.99pt,-5.99pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.7.1.1" class="ltx_p">Pets</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.8.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:31.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:31.7pt;transform:translate(-12.42pt,-12.42pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.8.1.1" class="ltx_p">Sun397</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.9.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:28.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:28.1pt;transform:translate(-10.61pt,-10.61pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.9.1.1" class="ltx_p">SVHN</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.10.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:22.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:22.5pt;transform:translate(-7.83pt,-7.83pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.10.1.1" class="ltx_p">DTD</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.11" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.11.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:40.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:40.7pt;transform:translate(-16.94pt,-16.94pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.11.1.1" class="ltx_p">EuroSAT</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.12" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.12.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:36.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:36.9pt;transform:translate(-15.04pt,-15.04pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.12.1.1" class="ltx_p">Resics45</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.13" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.13.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:43.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:43.3pt;transform:translate(-17.22pt,-16.25pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.13.1.1" class="ltx_p">Camelyon</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.14" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.14.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:54pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:54.0pt;transform:translate(-22.57pt,-21.6pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.14.1.1" class="ltx_p">Retinopathy</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.15" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.15.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:51.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:51.1pt;transform:translate(-22.1pt,-22.1pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.15.1.1" class="ltx_p">Clevr-count</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.16" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.16.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:43.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:43.1pt;transform:translate(-18.1pt,-18.1pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.16.1.1" class="ltx_p">Clevr-dist</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.17" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.17.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:51.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:51.5pt;transform:translate(-21.29pt,-20.32pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.17.1.1" class="ltx_p">dSprites-loc</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.18" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.18.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:50.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:50.7pt;transform:translate(-20.89pt,-19.92pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.18.1.1" class="ltx_p">dSprites-ori</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.19" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.19.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:49.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:49.2pt;transform:translate(-21.19pt,-21.19pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.19.1.1" class="ltx_p">sNORB-azi</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.20" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.20.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:53.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:53.9pt;transform:translate(-23.5pt,-23.5pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.20.1.1" class="ltx_p">sNORB-elev</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.21" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.21.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:33.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:33.6pt;transform:translate(-13.33pt,-13.33pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.21.1.1" class="ltx_p">DMLab</span>
</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.2.2.22" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.22.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:48.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:48.9pt;transform:translate(-21pt,-21pt) rotate(-90deg) ;">
<span id="S4.T2.5.1.1.1.1.1.1.2.2.22.1.1" class="ltx_p">KITTI-dist</span>
</span></span></span></span>
</span>
<span class="ltx_tbody">
<span id="S4.T2.5.1.1.1.1.1.1.3.1" class="ltx_tr">
<span id="S4.T2.5.1.1.1.1.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">BiT</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.1.1.1.1.1.1.3.1.2.1" class="ltx_text" style="color:#00B050;">23.5</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.1.1.1.1.1.1.3.1.3.1" class="ltx_text" style="color:#00B050;">68.3</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t">88.0</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t">70.1</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_t">98.6</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t">88.4</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.8" class="ltx_td ltx_align_center ltx_border_t">48.0</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.9" class="ltx_td ltx_align_center ltx_border_t">73.0</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.1.1.1.1.1.1.3.1.10.1" class="ltx_text ltx_font_bold">72.7</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.11" class="ltx_td ltx_align_center ltx_border_t">95.3</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.1.1.1.1.1.1.3.1.12.1" class="ltx_text ltx_font_bold">85.9</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.13" class="ltx_td ltx_align_center ltx_border_t">69.3</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.14" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.1.1.1.1.1.1.3.1.14.1" class="ltx_text ltx_font_bold">77.2</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.15" class="ltx_td ltx_align_center ltx_border_t">54.6</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.16" class="ltx_td ltx_align_center ltx_border_t">47.9</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.17" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.1.1.1.1.1.1.3.1.17.1" class="ltx_text ltx_font_bold">91.6</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.18" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.1.1.1.1.1.1.3.1.18.1" class="ltx_text ltx_font_bold">65.9</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.19" class="ltx_td ltx_align_center ltx_border_t">18.7</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.20" class="ltx_td ltx_align_center ltx_border_t">25.8</span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.21" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.1.1.1.1.1.1.3.1.21.1" class="ltx_text ltx_font_bold">47.1</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.3.1.22" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.5.1.1.1.1.1.1.3.1.22.1" class="ltx_text ltx_font_bold">80.1</span></span></span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2" class="ltx_tr">
<span id="S4.T2.5.1.1.1.1.1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FiT-QDA</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.2" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.4.2.2.1" class="ltx_text" style="color:#00B050;">21.0</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.3" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.4.2.3.1" class="ltx_text ltx_font_bold" style="color:#00B050;">70.6</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.4" class="ltx_td ltx_align_center">90.3</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.5" class="ltx_td ltx_align_center">74.1</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.6" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.4.2.6.1" class="ltx_text ltx_font_bold">99.1</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.7" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.4.2.7.1" class="ltx_text ltx_font_bold">91.0</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.8" class="ltx_td ltx_align_center">51.1</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.9" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.4.2.9.1" class="ltx_text ltx_font_bold">75.1</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.10" class="ltx_td ltx_align_center">70.9</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.11" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.4.2.11.1" class="ltx_text ltx_font_bold">95.6</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.12" class="ltx_td ltx_align_center">82.6</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.13" class="ltx_td ltx_align_center">80.7</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.14" class="ltx_td ltx_align_center">70.4</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.15" class="ltx_td ltx_align_center">87.1</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.16" class="ltx_td ltx_align_center">58.1</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.17" class="ltx_td ltx_align_center">77.1</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.18" class="ltx_td ltx_align_center">56.7</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.19" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.4.2.19.1" class="ltx_text ltx_font_bold">18.9</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.20" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.4.2.20.1" class="ltx_text ltx_font_bold">40.4</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.21" class="ltx_td ltx_align_center">43.8</span>
<span id="S4.T2.5.1.1.1.1.1.1.4.2.22" class="ltx_td ltx_align_center">77.5</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3" class="ltx_tr">
<span id="S4.T2.5.1.1.1.1.1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FiT-LDA</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.2" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.5.3.2.1" class="ltx_text" style="color:#00B050;">0.03</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.3" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.5.3.3.1" class="ltx_text" style="color:#00B050;">69.3</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.4" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.5.3.4.1" class="ltx_text ltx_font_bold">90.4</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.5" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.5.3.5.1" class="ltx_text ltx_font_bold">74.2</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.6" class="ltx_td ltx_align_center">99.0</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.7" class="ltx_td ltx_align_center">90.5</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.8" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.5.3.8.1" class="ltx_text ltx_font_bold">51.6</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.9" class="ltx_td ltx_align_center">74.2</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.10" class="ltx_td ltx_align_center">70.9</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.11" class="ltx_td ltx_align_center">95.1</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.12" class="ltx_td ltx_align_center">82.5</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.13" class="ltx_td ltx_align_center"><span id="S4.T2.5.1.1.1.1.1.1.5.3.13.1" class="ltx_text ltx_font_bold">82.5</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.14" class="ltx_td ltx_align_center">66.2</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.15" class="ltx_td ltx_align_center">85.6</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.16" class="ltx_td ltx_align_center">56.1</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.17" class="ltx_td ltx_align_center">74.8</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.18" class="ltx_td ltx_align_center">51.3</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.19" class="ltx_td ltx_align_center">16.2</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.20" class="ltx_td ltx_align_center">37.0</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.21" class="ltx_td ltx_align_center">41.6</span>
<span id="S4.T2.5.1.1.1.1.1.1.5.3.22" class="ltx_td ltx_align_center">77.7</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4" class="ltx_tr">
<span id="S4.T2.5.1.1.1.1.1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">FiT-ProtoNets</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.5.1.1.1.1.1.1.6.4.2.1" class="ltx_text" style="color:#00B050;">0.03</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.5.1.1.1.1.1.1.6.4.3.1" class="ltx_text" style="color:#00B050;">65.5</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.4" class="ltx_td ltx_align_center ltx_border_bb">89.6</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.5" class="ltx_td ltx_align_center ltx_border_bb">73.9</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.6" class="ltx_td ltx_align_center ltx_border_bb">98.6</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.7" class="ltx_td ltx_align_center ltx_border_bb">90.8</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.8" class="ltx_td ltx_align_center ltx_border_bb">51.5</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.9" class="ltx_td ltx_align_center ltx_border_bb">50.1</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.10" class="ltx_td ltx_align_center ltx_border_bb">68.2</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.11" class="ltx_td ltx_align_center ltx_border_bb">93.8</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.12" class="ltx_td ltx_align_center ltx_border_bb">77.0</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.13" class="ltx_td ltx_align_center ltx_border_bb">79.9</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.14" class="ltx_td ltx_align_center ltx_border_bb">57.9</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.15" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.5.1.1.1.1.1.1.6.4.15.1" class="ltx_text ltx_font_bold">88.7</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.16" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.5.1.1.1.1.1.1.6.4.16.1" class="ltx_text ltx_font_bold">58.3</span></span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.17" class="ltx_td ltx_align_center ltx_border_bb">68.6</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.18" class="ltx_td ltx_align_center ltx_border_bb">34.2</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.19" class="ltx_td ltx_align_center ltx_border_bb">13.5</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.20" class="ltx_td ltx_align_center ltx_border_bb">35.0</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.21" class="ltx_td ltx_align_center ltx_border_bb">39.3</span>
<span id="S4.T2.5.1.1.1.1.1.1.6.4.22" class="ltx_td ltx_align_center ltx_border_bb">75.3</span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p"><a href="#S4.T3" title="In 4.2 VTAB-1k Results ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">3</span></a> shows that <span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA achieves state-of-the-art classification accuracy when compared to leading transfer learning methods pretrained on ImageNet-21k, while requiring the smallest number of updateable parameters and using the smallest backbone.
All competing methods use a linear head.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span><span id="S4.T3.7.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FiT<span id="S4.T3.7.1.1" class="ltx_text ltx_font_upright"> achieves SOTA on VTAB-1k</span></span>. Classification accuracy (%) for the 3 VTAB-1k categories (<span id="S4.T3.8.2" class="ltx_text ltx_font_italic">Natural</span>, <span id="S4.T3.9.3" class="ltx_text ltx_font_italic">Specialized</span>, and <span id="S4.T3.10.4" class="ltx_text ltx_font_italic">Structured</span>) and mean accuracy over all 19 datasets (<span id="S4.T3.11.5" class="ltx_text ltx_font_italic">Overall Acc</span>) and updateable parameter count (<span id="S4.T3.12.6" class="ltx_text ltx_font_italic">Params</span>) for leading transfer learning methods using various backbones (backbone parameter count shown in parentheses) <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>; Dosovitskiy et al., <a href="#bib.bib11" title="" class="ltx_ref">2020</a>; Tan &amp; Le, <a href="#bib.bib55" title="" class="ltx_ref">2021</a>)</cite> pretrained on ImageNet-21k. ViT-Base-16 results from <cite class="ltx_cite ltx_citemacro_citep">(Jie &amp; Deng, <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite>. BiT results from <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib30" title="" class="ltx_ref">2020</a>)</cite>. Green indicates results summary columns.</figcaption>
<div id="S4.T3.13" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:93.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-185.0pt,43.4pt) scale(0.51784,0.51784) ;">
<p id="S4.T3.13.1" class="ltx_p"><span id="S4.T3.13.1.1" class="ltx_text">
<span id="S4.T3.13.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:767.6pt;height:180pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S4.T3.13.1.1.1.1" class="ltx_p"><span id="S4.T3.13.1.1.1.1.1" class="ltx_text">
<span id="S4.T3.13.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S4.T3.13.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S4.T3.13.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Method</span>
<span id="S4.T3.13.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt">Backbone</span>
<span id="S4.T3.13.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">
<span id="S4.T3.13.1.1.1.1.1.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.13.1.1.1.1.1.1.1.1.3.1.1" class="ltx_p" style="width:67.8pt;">Params (M) ↓</span>
</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Overall Acc ↑</span>
<span id="S4.T3.13.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Natural ↑</span>
<span id="S4.T3.13.1.1.1.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Specialized ↑</span>
<span id="S4.T3.13.1.1.1.1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Structured ↑</span></span>
</span>
<span class="ltx_tbody">
<span id="S4.T3.13.1.1.1.1.1.1.2.1" class="ltx_tr">
<span id="S4.T3.13.1.1.1.1.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">BiT <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite></span>
<span id="S4.T3.13.1.1.1.1.1.1.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">BiT-M-R101x3 (382M)</span>
<span id="S4.T3.13.1.1.1.1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S4.T3.13.1.1.1.1.1.1.2.1.3.1" class="ltx_text" style="color:#00B050;">382</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.13.1.1.1.1.1.1.2.1.4.1" class="ltx_text" style="color:#00B050;">72.7</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">80.3</span>
<span id="S4.T3.13.1.1.1.1.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.13.1.1.1.1.1.1.2.1.6.1" class="ltx_text ltx_font_bold">85.8</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t">59.4</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.3.2" class="ltx_tr">
<span id="S4.T3.13.1.1.1.1.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">BiT <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite></span>
<span id="S4.T3.13.1.1.1.1.1.1.3.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">BiT-M-R152x4 (928M)</span>
<span id="S4.T3.13.1.1.1.1.1.1.3.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T3.13.1.1.1.1.1.1.3.2.3.1" class="ltx_text" style="color:#00B050;">928</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.3.2.4" class="ltx_td ltx_align_center"><span id="S4.T3.13.1.1.1.1.1.1.3.2.4.1" class="ltx_text" style="color:#00B050;">73.5</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.3.2.5" class="ltx_td ltx_align_center">80.8</span>
<span id="S4.T3.13.1.1.1.1.1.1.3.2.6" class="ltx_td ltx_align_center">85.7</span>
<span id="S4.T3.13.1.1.1.1.1.1.3.2.7" class="ltx_td ltx_align_center">61.1</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.4.3" class="ltx_tr">
<span id="S4.T3.13.1.1.1.1.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">VPT <cite class="ltx_cite ltx_citemacro_citep">(Jia et al., <a href="#bib.bib23" title="" class="ltx_ref">2022</a>)</cite></span>
<span id="S4.T3.13.1.1.1.1.1.1.4.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">ViT-Base-16 (85.8M)</span>
<span id="S4.T3.13.1.1.1.1.1.1.4.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T3.13.1.1.1.1.1.1.4.3.3.1" class="ltx_text" style="color:#00B050;">0.5</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.4.3.4" class="ltx_td ltx_align_center"><span id="S4.T3.13.1.1.1.1.1.1.4.3.4.1" class="ltx_text" style="color:#00B050;">69.4</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.4.3.5" class="ltx_td ltx_align_center">78.5</span>
<span id="S4.T3.13.1.1.1.1.1.1.4.3.6" class="ltx_td ltx_align_center">82.4</span>
<span id="S4.T3.13.1.1.1.1.1.1.4.3.7" class="ltx_td ltx_align_center">55.0</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.5.4" class="ltx_tr">
<span id="S4.T3.13.1.1.1.1.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Adapter <cite class="ltx_cite ltx_citemacro_citep">(Houlsby et al., <a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite></span>
<span id="S4.T3.13.1.1.1.1.1.1.5.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">ViT-Base-16 (85.8M)</span>
<span id="S4.T3.13.1.1.1.1.1.1.5.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T3.13.1.1.1.1.1.1.5.4.3.1" class="ltx_text" style="color:#00B050;">0.2</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.5.4.4" class="ltx_td ltx_align_center"><span id="S4.T3.13.1.1.1.1.1.1.5.4.4.1" class="ltx_text" style="color:#00B050;">71.4</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.5.4.5" class="ltx_td ltx_align_center">79.0</span>
<span id="S4.T3.13.1.1.1.1.1.1.5.4.6" class="ltx_td ltx_align_center">84.1</span>
<span id="S4.T3.13.1.1.1.1.1.1.5.4.7" class="ltx_td ltx_align_center">58.5</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.6.5" class="ltx_tr">
<span id="S4.T3.13.1.1.1.1.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">AdaptFormer <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib6" title="" class="ltx_ref">2022</a>)</cite></span>
<span id="S4.T3.13.1.1.1.1.1.1.6.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">ViT-Base-16 (85.8M)</span>
<span id="S4.T3.13.1.1.1.1.1.1.6.5.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T3.13.1.1.1.1.1.1.6.5.3.1" class="ltx_text" style="color:#00B050;">0.2</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.6.5.4" class="ltx_td ltx_align_center"><span id="S4.T3.13.1.1.1.1.1.1.6.5.4.1" class="ltx_text" style="color:#00B050;">72.3</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.6.5.5" class="ltx_td ltx_align_center">80.6</span>
<span id="S4.T3.13.1.1.1.1.1.1.6.5.6" class="ltx_td ltx_align_center">84.9</span>
<span id="S4.T3.13.1.1.1.1.1.1.6.5.7" class="ltx_td ltx_align_center">58.8</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.7.6" class="ltx_tr">
<span id="S4.T3.13.1.1.1.1.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">LoRA <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite></span>
<span id="S4.T3.13.1.1.1.1.1.1.7.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">ViT-Base-16 (85.8M)</span>
<span id="S4.T3.13.1.1.1.1.1.1.7.6.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T3.13.1.1.1.1.1.1.7.6.3.1" class="ltx_text" style="color:#00B050;">0.3</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.7.6.4" class="ltx_td ltx_align_center"><span id="S4.T3.13.1.1.1.1.1.1.7.6.4.1" class="ltx_text" style="color:#00B050;">72.3</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.7.6.5" class="ltx_td ltx_align_center">79.5</span>
<span id="S4.T3.13.1.1.1.1.1.1.7.6.6" class="ltx_td ltx_align_center">84.6</span>
<span id="S4.T3.13.1.1.1.1.1.1.7.6.7" class="ltx_td ltx_align_center">59.8</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.8.7" class="ltx_tr">
<span id="S4.T3.13.1.1.1.1.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">NOAH <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib65" title="" class="ltx_ref">2022</a>)</cite></span>
<span id="S4.T3.13.1.1.1.1.1.1.8.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">ViT-Base-16 (85.8M)</span>
<span id="S4.T3.13.1.1.1.1.1.1.8.7.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T3.13.1.1.1.1.1.1.8.7.3.1" class="ltx_text" style="color:#00B050;">0.4</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.8.7.4" class="ltx_td ltx_align_center"><span id="S4.T3.13.1.1.1.1.1.1.8.7.4.1" class="ltx_text" style="color:#00B050;">73.2</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.8.7.5" class="ltx_td ltx_align_center">80.3</span>
<span id="S4.T3.13.1.1.1.1.1.1.8.7.6" class="ltx_td ltx_align_center">84.9</span>
<span id="S4.T3.13.1.1.1.1.1.1.8.7.7" class="ltx_td ltx_align_center">61.3</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.9.8" class="ltx_tr">
<span id="S4.T3.13.1.1.1.1.1.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Convpass <cite class="ltx_cite ltx_citemacro_citep">(Jie &amp; Deng, <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite></span>
<span id="S4.T3.13.1.1.1.1.1.1.9.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">ViT-Base-16 (85.8M)</span>
<span id="S4.T3.13.1.1.1.1.1.1.9.8.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T3.13.1.1.1.1.1.1.9.8.3.1" class="ltx_text" style="color:#00B050;">0.3</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.9.8.4" class="ltx_td ltx_align_center"><span id="S4.T3.13.1.1.1.1.1.1.9.8.4.1" class="ltx_text" style="color:#00B050;">74.4</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.9.8.5" class="ltx_td ltx_align_center">81.7</span>
<span id="S4.T3.13.1.1.1.1.1.1.9.8.6" class="ltx_td ltx_align_center">85.3</span>
<span id="S4.T3.13.1.1.1.1.1.1.9.8.7" class="ltx_td ltx_align_center">62.7</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.10.9" class="ltx_tr">
<span id="S4.T3.13.1.1.1.1.1.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">FiT-LDA (ours)</span>
<span id="S4.T3.13.1.1.1.1.1.1.10.9.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">EfficientNetV2-M (52.9M)</span>
<span id="S4.T3.13.1.1.1.1.1.1.10.9.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"><span id="S4.T3.13.1.1.1.1.1.1.10.9.3.1" class="ltx_text ltx_font_bold" style="color:#00B050;">0.15</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.10.9.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.13.1.1.1.1.1.1.10.9.4.1" class="ltx_text ltx_font_bold" style="color:#00B050;">74.9</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.10.9.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.13.1.1.1.1.1.1.10.9.5.1" class="ltx_text ltx_font_bold">82.2</span></span>
<span id="S4.T3.13.1.1.1.1.1.1.10.9.6" class="ltx_td ltx_align_center ltx_border_bb">84.3</span>
<span id="S4.T3.13.1.1.1.1.1.1.10.9.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.13.1.1.1.1.1.1.10.9.7.1" class="ltx_text ltx_font_bold">63.7</span></span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Personalization</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p">In the personalization experiments, we use ORBIT <cite class="ltx_cite ltx_citemacro_citep">(Massiceti et al., <a href="#bib.bib35" title="" class="ltx_ref">2021</a>)</cite>, a real-world few-shot video dataset recorded by people who are blind/low-vision.
A user collects a series of short videos of objects that they would like to recognize.
The collected videos and associated labels are then uploaded to a central service to train a personalized classification model for that user.
Once trained, the personalized model is downloaded to the user’s smartphone.
In this setting, models with a smaller number of updateable parameters are preferred in order to save model storage space on the central server and in transmitting any updated models to a user.
The personalization is performed by taking a large pretrained model and adapting it using user’s individual data.
We follow the object recognition benchmark task proposed by the authors, which tests a personalized model on two different video types: <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_italic">clean</span> where only a single object is present and <span id="S4.SS3.p1.1.2" class="ltx_text ltx_font_italic">clutter</span> where that object appears within a realistic, multi-object scene.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.2" class="ltx_p">In <a href="#S4.T4" title="In 4.3 Personalization ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">4</span></a>, we compare <span id="S4.SS3.p2.2.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA to several competitive transfer learning and meta-learning methods that benchmark on the ORBIT dataset.
We use the LDA variant of <span id="S4.SS3.p2.2.2" class="ltx_text ltx_font_smallcaps">FiT</span>, as it achieves higher accuracy in comparison to the ProtoNets variant, while using far fewer updateable parameters than QDA.
As baselines, for transfer learning, we include FineTuner <cite class="ltx_cite ltx_citemacro_citep">(Yosinski et al., <a href="#bib.bib63" title="" class="ltx_ref">2014</a>)</cite>, which freezes the weights in the backbone and fine-tunes only the linear classifier head on an individual’s data.
For meta-learning approaches, we include ProtoNets <cite class="ltx_cite ltx_citemacro_citep">(Snell et al., <a href="#bib.bib54" title="" class="ltx_ref">2017</a>)</cite> and Simple CNAPs <cite class="ltx_cite ltx_citemacro_citep">(Bateni et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>, which are meta-trained on Meta-Dataset <cite class="ltx_cite ltx_citemacro_citep">(Dumoulin et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>.
In the lower part of <a href="#S4.T4" title="In 4.3 Personalization ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">4</span></a>, we compare <span id="S4.SS3.p2.2.3" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA and BiT. Both models use the same BiT-M-R50x1 backbone pretrained on ImageNet-21K.
Training and evaluation details are in <a href="#A1.SS11.SSS2" title="A.11.2 Personalization on ORBIT Experiments ‣ A.11 Training and Evaluation Details ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.11.2</span></a>.
For this comparison, we show frame and video accuracy, averaged over all the videos from all tasks across all test users (<math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="17" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mn id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">17</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><cn type="integer" id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">17</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">17</annotation></semantics></math> test users, <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="85" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mn id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">85</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><cn type="integer" id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">85</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">85</annotation></semantics></math> tasks in total).
We also report the number of shared and individual updateable parameters required to be stored or transmitted.
The key observations from our results are:</p>
<ul id="S4.I3" class="ltx_itemize">
<li id="S4.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.i1.p1" class="ltx_para">
<p id="S4.I3.i1.p1.1" class="ltx_p"><span id="S4.I3.i1.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA outperforms competitive meta-learning methods, Simple CNAPs and ProtoNets.</p>
</div>
</li>
<li id="S4.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.i2.p1" class="ltx_para">
<p id="S4.I3.i2.p1.1" class="ltx_p"><span id="S4.I3.i2.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA also outperforms FineTuner in terms of the video accuracy and performs within error bars of it in terms of the frame accuracy.</p>
</div>
</li>
<li id="S4.I3.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.i3.p1" class="ltx_para">
<p id="S4.I3.i3.p1.1" class="ltx_p">The number of individual parameters for <span id="S4.I3.i3.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA is far fewer than in Simple CNAPs and BiT, and is of the same order of magnitude as FineTuner and ProtoNets.</p>
</div>
</li>
<li id="S4.I3.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.i4.p1" class="ltx_para ltx_noindent">
<p id="S4.I3.i4.p1.1" class="ltx_p"><span id="S4.I3.i4.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA pretrained on ImageNet-21K performs on par with BiT, while having orders of magnitude fewer updatable parameters.</p>
</div>
</li>
</ul>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span><span id="S4.T4.25.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FiT<span id="S4.T4.25.1.1" class="ltx_text ltx_font_upright"> outperforms competitive methods on ORBIT.</span></span> Average accuracy (95% confidence interval) over <math id="S4.T4.4.m1.1" class="ltx_Math" alttext="85" display="inline"><semantics id="S4.T4.4.m1.1b"><mn id="S4.T4.4.m1.1.1" xref="S4.T4.4.m1.1.1.cmml">85</mn><annotation-xml encoding="MathML-Content" id="S4.T4.4.m1.1c"><cn type="integer" id="S4.T4.4.m1.1.1.cmml" xref="S4.T4.4.m1.1.1">85</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.m1.1d">85</annotation></semantics></math> test tasks. <math id="S4.T4.5.m2.1" class="ltx_Math" alttext="b_{\bm{\theta}}({\bm{x}})" display="inline"><semantics id="S4.T4.5.m2.1b"><mrow id="S4.T4.5.m2.1.2" xref="S4.T4.5.m2.1.2.cmml"><msub id="S4.T4.5.m2.1.2.2" xref="S4.T4.5.m2.1.2.2.cmml"><mi id="S4.T4.5.m2.1.2.2.2" xref="S4.T4.5.m2.1.2.2.2.cmml">b</mi><mi id="S4.T4.5.m2.1.2.2.3" xref="S4.T4.5.m2.1.2.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.T4.5.m2.1.2.1" xref="S4.T4.5.m2.1.2.1.cmml">​</mo><mrow id="S4.T4.5.m2.1.2.3.2" xref="S4.T4.5.m2.1.2.cmml"><mo stretchy="false" id="S4.T4.5.m2.1.2.3.2.1" xref="S4.T4.5.m2.1.2.cmml">(</mo><mi id="S4.T4.5.m2.1.1" xref="S4.T4.5.m2.1.1.cmml">𝒙</mi><mo stretchy="false" id="S4.T4.5.m2.1.2.3.2.2" xref="S4.T4.5.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.5.m2.1c"><apply id="S4.T4.5.m2.1.2.cmml" xref="S4.T4.5.m2.1.2"><times id="S4.T4.5.m2.1.2.1.cmml" xref="S4.T4.5.m2.1.2.1"></times><apply id="S4.T4.5.m2.1.2.2.cmml" xref="S4.T4.5.m2.1.2.2"><csymbol cd="ambiguous" id="S4.T4.5.m2.1.2.2.1.cmml" xref="S4.T4.5.m2.1.2.2">subscript</csymbol><ci id="S4.T4.5.m2.1.2.2.2.cmml" xref="S4.T4.5.m2.1.2.2.2">𝑏</ci><ci id="S4.T4.5.m2.1.2.2.3.cmml" xref="S4.T4.5.m2.1.2.2.3">𝜽</ci></apply><ci id="S4.T4.5.m2.1.1.cmml" xref="S4.T4.5.m2.1.1">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.m2.1d">b_{\bm{\theta}}({\bm{x}})</annotation></semantics></math> is the backbone used. EN-1K(-MD) is EfficientNet-B0 pretrained on ImageNet (Meta-Dataset). RN-21K is BiT-M-R50x1 pretrained on ImageNet-21K. <span id="S4.T4.26.2" class="ltx_text ltx_font_italic">Shared</span> is the number of parameters shared among all users. <span id="S4.T4.27.3" class="ltx_text ltx_font_italic">Per User</span> is the number of parameters stored for each user with <math id="S4.T4.6.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T4.6.m3.1b"><mi id="S4.T4.6.m3.1.1" xref="S4.T4.6.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T4.6.m3.1c"><ci id="S4.T4.6.m3.1.1.cmml" xref="S4.T4.6.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.m3.1d">C</annotation></semantics></math> classes. <span id="S4.T4.28.4" class="ltx_text ltx_font_italic">Average</span> is the mean number of individual user parameters over ORBIT.
</figcaption>
<div id="S4.T4.20" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:105pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-75.6pt,19.8pt) scale(0.72431,0.72431) ;">
<p id="S4.T4.20.14" class="ltx_p"><span id="S4.T4.20.14.14" class="ltx_text">
<span id="S4.T4.20.14.14.14" class="ltx_inline-block ltx_transformed_outer" style="width:548.8pt;height:145pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S4.T4.20.14.14.14.14" class="ltx_p"><span id="S4.T4.20.14.14.14.14.14" class="ltx_text">
<span id="S4.T4.20.14.14.14.14.14.14" class="ltx_tabular ltx_align_middle">
<span class="ltx_tbody">
<span id="S4.T4.20.14.14.14.14.14.14.15.1" class="ltx_tr">
<span id="S4.T4.20.14.14.14.14.14.14.15.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.20.14.14.14.14.14.14.15.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.20.14.14.14.14.14.14.15.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.20.14.14.14.14.14.14.15.1.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_align_top ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-left:1.2pt;padding-right:1.2pt;"><span id="S4.T4.20.14.14.14.14.14.14.15.1.4.1" class="ltx_text ltx_font_bold">Clean Videos</span></span>
<span id="S4.T4.20.14.14.14.14.14.14.15.1.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.20.14.14.14.14.14.14.15.1.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_align_top ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-left:1.2pt;padding-right:1.2pt;"><span id="S4.T4.20.14.14.14.14.14.14.15.1.6.1" class="ltx_text ltx_font_bold">Clutter Videos</span></span>
<span id="S4.T4.20.14.14.14.14.14.14.15.1.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.20.14.14.14.14.14.14.15.1.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_align_top ltx_border_tt ltx_colspan ltx_colspan_3" style="padding-left:1.2pt;padding-right:1.2pt;"><span id="S4.T4.20.14.14.14.14.14.14.15.1.8.1" class="ltx_text ltx_font_bold">Parameters</span></span></span>
<span id="S4.T4.14.8.8.8.8.8.8.8" class="ltx_tr">
<span id="S4.T4.14.8.8.8.8.8.8.8.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-left:1.2pt;padding-right:1.2pt;"><span id="S4.T4.14.8.8.8.8.8.8.8.9.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">model</span></span>
<span id="S4.T4.7.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-left:1.2pt;padding-right:1.2pt;"><math id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="b_{\bm{\theta}}({\bm{x}})" display="inline"><semantics id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.cmml"><msub id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2.cmml"><mi id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2.2" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2.2.cmml">b</mi><mi id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2.3" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.1" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.3.2" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.3.2.1" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.cmml">(</mo><mi id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.3.2.2" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1b"><apply id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.cmml" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2"><times id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.1.cmml" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.1"></times><apply id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2.cmml" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2.1.cmml" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2">subscript</csymbol><ci id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2.2.cmml" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2.2">𝑏</ci><ci id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2.3.cmml" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.2.2.3">𝜽</ci></apply><ci id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T4.7.1.1.1.1.1.1.1.1.m1.1.1">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.1.1.1.1.1.1.1.1.m1.1c">b_{\bm{\theta}}({\bm{x}})</annotation></semantics></math></span>
<span id="S4.T4.14.8.8.8.8.8.8.8.10" class="ltx_td ltx_nopad_l ltx_nopad_r" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.8.2.2.2.2.2.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.8.2.2.2.2.2.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.8.2.2.2.2.2.2.2.2.1.1" class="ltx_p" style="width:59.8pt;"><span id="S4.T4.8.2.2.2.2.2.2.2.2.1.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">frame acc</span> <math id="S4.T4.8.2.2.2.2.2.2.2.2.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T4.8.2.2.2.2.2.2.2.2.1.1.m1.1a"><mo stretchy="false" id="S4.T4.8.2.2.2.2.2.2.2.2.1.1.m1.1.1" xref="S4.T4.8.2.2.2.2.2.2.2.2.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.8.2.2.2.2.2.2.2.2.1.1.m1.1b"><ci id="S4.T4.8.2.2.2.2.2.2.2.2.1.1.m1.1.1.cmml" xref="S4.T4.8.2.2.2.2.2.2.2.2.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.2.2.2.2.2.2.2.2.1.1.m1.1c">\uparrow</annotation></semantics></math></span>
</span></span>
<span id="S4.T4.9.3.3.3.3.3.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.9.3.3.3.3.3.3.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.9.3.3.3.3.3.3.3.3.1.1" class="ltx_p" style="width:56.9pt;"><span id="S4.T4.9.3.3.3.3.3.3.3.3.1.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">video acc</span> <math id="S4.T4.9.3.3.3.3.3.3.3.3.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T4.9.3.3.3.3.3.3.3.3.1.1.m1.1a"><mo stretchy="false" id="S4.T4.9.3.3.3.3.3.3.3.3.1.1.m1.1.1" xref="S4.T4.9.3.3.3.3.3.3.3.3.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.9.3.3.3.3.3.3.3.3.1.1.m1.1b"><ci id="S4.T4.9.3.3.3.3.3.3.3.3.1.1.m1.1.1.cmml" xref="S4.T4.9.3.3.3.3.3.3.3.3.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.9.3.3.3.3.3.3.3.3.1.1.m1.1c">\uparrow</annotation></semantics></math></span>
</span></span>
<span id="S4.T4.14.8.8.8.8.8.8.8.11" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.10.4.4.4.4.4.4.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.10.4.4.4.4.4.4.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.10.4.4.4.4.4.4.4.4.1.1" class="ltx_p" style="width:59.8pt;"><span id="S4.T4.10.4.4.4.4.4.4.4.4.1.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">frame acc</span> <math id="S4.T4.10.4.4.4.4.4.4.4.4.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T4.10.4.4.4.4.4.4.4.4.1.1.m1.1a"><mo stretchy="false" id="S4.T4.10.4.4.4.4.4.4.4.4.1.1.m1.1.1" xref="S4.T4.10.4.4.4.4.4.4.4.4.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.10.4.4.4.4.4.4.4.4.1.1.m1.1b"><ci id="S4.T4.10.4.4.4.4.4.4.4.4.1.1.m1.1.1.cmml" xref="S4.T4.10.4.4.4.4.4.4.4.4.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.10.4.4.4.4.4.4.4.4.1.1.m1.1c">\uparrow</annotation></semantics></math></span>
</span></span>
<span id="S4.T4.11.5.5.5.5.5.5.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.11.5.5.5.5.5.5.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.11.5.5.5.5.5.5.5.5.1.1" class="ltx_p" style="width:56.9pt;"><span id="S4.T4.11.5.5.5.5.5.5.5.5.1.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">video acc</span> <math id="S4.T4.11.5.5.5.5.5.5.5.5.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T4.11.5.5.5.5.5.5.5.5.1.1.m1.1a"><mo stretchy="false" id="S4.T4.11.5.5.5.5.5.5.5.5.1.1.m1.1.1" xref="S4.T4.11.5.5.5.5.5.5.5.5.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.11.5.5.5.5.5.5.5.5.1.1.m1.1b"><ci id="S4.T4.11.5.5.5.5.5.5.5.5.1.1.m1.1.1.cmml" xref="S4.T4.11.5.5.5.5.5.5.5.5.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.11.5.5.5.5.5.5.5.5.1.1.m1.1c">\uparrow</annotation></semantics></math></span>
</span></span>
<span id="S4.T4.14.8.8.8.8.8.8.8.12" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.12.6.6.6.6.6.6.6.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.12.6.6.6.6.6.6.6.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.12.6.6.6.6.6.6.6.6.1.1" class="ltx_p" style="width:51.2pt;"><span id="S4.T4.12.6.6.6.6.6.6.6.6.1.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">shared</span> <math id="S4.T4.12.6.6.6.6.6.6.6.6.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T4.12.6.6.6.6.6.6.6.6.1.1.m1.1a"><mo stretchy="false" id="S4.T4.12.6.6.6.6.6.6.6.6.1.1.m1.1.1" xref="S4.T4.12.6.6.6.6.6.6.6.6.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.12.6.6.6.6.6.6.6.6.1.1.m1.1b"><ci id="S4.T4.12.6.6.6.6.6.6.6.6.1.1.m1.1.1.cmml" xref="S4.T4.12.6.6.6.6.6.6.6.6.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.12.6.6.6.6.6.6.6.6.1.1.m1.1c">\downarrow</annotation></semantics></math></span>
</span></span>
<span id="S4.T4.13.7.7.7.7.7.7.7.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.13.7.7.7.7.7.7.7.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.13.7.7.7.7.7.7.7.7.1.1" class="ltx_p" style="width:65.4pt;"><span id="S4.T4.13.7.7.7.7.7.7.7.7.1.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">per user<span id="S4.T4.13.7.7.7.7.7.7.7.7.1.1.1.1" class="ltx_text ltx_font_medium"> <math id="S4.T4.13.7.7.7.7.7.7.7.7.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T4.13.7.7.7.7.7.7.7.7.1.1.1.1.m1.1a"><mo stretchy="false" id="S4.T4.13.7.7.7.7.7.7.7.7.1.1.1.1.m1.1.1" xref="S4.T4.13.7.7.7.7.7.7.7.7.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.13.7.7.7.7.7.7.7.7.1.1.1.1.m1.1b"><ci id="S4.T4.13.7.7.7.7.7.7.7.7.1.1.1.1.m1.1.1.cmml" xref="S4.T4.13.7.7.7.7.7.7.7.7.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.13.7.7.7.7.7.7.7.7.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math></span></span></span>
</span></span>
<span id="S4.T4.14.8.8.8.8.8.8.8.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.14.8.8.8.8.8.8.8.8.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.14.8.8.8.8.8.8.8.8.1.1" class="ltx_p" style="width:51.2pt;"><span id="S4.T4.14.8.8.8.8.8.8.8.8.1.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">average<span id="S4.T4.14.8.8.8.8.8.8.8.8.1.1.1.1" class="ltx_text ltx_font_medium"> <math id="S4.T4.14.8.8.8.8.8.8.8.8.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T4.14.8.8.8.8.8.8.8.8.1.1.1.1.m1.1a"><mo stretchy="false" id="S4.T4.14.8.8.8.8.8.8.8.8.1.1.1.1.m1.1.1" xref="S4.T4.14.8.8.8.8.8.8.8.8.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.14.8.8.8.8.8.8.8.8.1.1.1.1.m1.1b"><ci id="S4.T4.14.8.8.8.8.8.8.8.8.1.1.1.1.m1.1.1.cmml" xref="S4.T4.14.8.8.8.8.8.8.8.8.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.14.8.8.8.8.8.8.8.8.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math></span></span></span>
</span></span></span>
<span id="S4.T4.15.9.9.9.9.9.9.9" class="ltx_tr">
<span id="S4.T4.15.9.9.9.9.9.9.9.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">FineTuner</span>
<span id="S4.T4.15.9.9.9.9.9.9.9.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">EN-1K</span>
<span id="S4.T4.15.9.9.9.9.9.9.9.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.15.9.9.9.9.9.9.9.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.15.9.9.9.9.9.9.9.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.15.9.9.9.9.9.9.9.5.1.1" class="ltx_p" style="width:59.8pt;">78.1 (2.0)</span>
</span></span>
<span id="S4.T4.15.9.9.9.9.9.9.9.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.15.9.9.9.9.9.9.9.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.15.9.9.9.9.9.9.9.6.1.1" class="ltx_p" style="width:56.9pt;">85.9 (2.3)</span>
</span></span>
<span id="S4.T4.15.9.9.9.9.9.9.9.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.15.9.9.9.9.9.9.9.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.15.9.9.9.9.9.9.9.8.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.15.9.9.9.9.9.9.9.8.1.1" class="ltx_p" style="width:59.8pt;">63.1 (1.8)</span>
</span></span>
<span id="S4.T4.15.9.9.9.9.9.9.9.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.15.9.9.9.9.9.9.9.9.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.15.9.9.9.9.9.9.9.9.1.1" class="ltx_p" style="width:56.9pt;">66.9 (2.4)</span>
</span></span>
<span id="S4.T4.15.9.9.9.9.9.9.9.10" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.15.9.9.9.9.9.9.9.11" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.15.9.9.9.9.9.9.9.11.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.15.9.9.9.9.9.9.9.11.1.1" class="ltx_p" style="width:51.2pt;">4.01M</span>
</span></span>
<span id="S4.T4.15.9.9.9.9.9.9.9.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.15.9.9.9.9.9.9.9.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.15.9.9.9.9.9.9.9.1.1.1" class="ltx_p" style="width:65.4pt;"><math id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1" class="ltx_Math" alttext="(d_{b}+1)C" display="inline"><semantics id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1a"><mrow id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.cmml"><mrow id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.2" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.cmml"><msub id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2.cmml"><mi id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2.2" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mi id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2.3" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2.3.cmml">b</mi></msub><mo id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.1" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.3" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.3" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.2" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.2.cmml">​</mo><mi id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.3" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1b"><apply id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.cmml" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1"><times id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.2.cmml" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.2"></times><apply id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.cmml" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1"><plus id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.1"></plus><apply id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2.2">𝑑</ci><ci id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.2.3">𝑏</ci></apply><cn type="integer" id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.3.cmml" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.1.1.1.3">1</cn></apply><ci id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.3.cmml" xref="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.15.9.9.9.9.9.9.9.1.1.1.m1.1c">(d_{b}+1)C</annotation></semantics></math></span>
</span></span>
<span id="S4.T4.15.9.9.9.9.9.9.9.12" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.15.9.9.9.9.9.9.9.12.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.15.9.9.9.9.9.9.9.12.1.1" class="ltx_p" style="width:51.2pt;"><span id="S4.T4.15.9.9.9.9.9.9.9.12.1.1.1" class="ltx_text ltx_font_bold">0.01M</span></span>
</span></span></span>
<span id="S4.T4.16.10.10.10.10.10.10.10" class="ltx_tr">
<span id="S4.T4.16.10.10.10.10.10.10.10.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">Simple CNAPs</span>
<span id="S4.T4.16.10.10.10.10.10.10.10.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">EN-MD</span>
<span id="S4.T4.16.10.10.10.10.10.10.10.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.16.10.10.10.10.10.10.10.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.16.10.10.10.10.10.10.10.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.16.10.10.10.10.10.10.10.5.1.1" class="ltx_p" style="width:59.8pt;">73.1 (2.1)</span>
</span></span>
<span id="S4.T4.16.10.10.10.10.10.10.10.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.16.10.10.10.10.10.10.10.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.16.10.10.10.10.10.10.10.6.1.1" class="ltx_p" style="width:56.9pt;">80.7 (2.6)</span>
</span></span>
<span id="S4.T4.16.10.10.10.10.10.10.10.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.16.10.10.10.10.10.10.10.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.16.10.10.10.10.10.10.10.8.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.16.10.10.10.10.10.10.10.8.1.1" class="ltx_p" style="width:59.8pt;">61.6 (1.8)</span>
</span></span>
<span id="S4.T4.16.10.10.10.10.10.10.10.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.16.10.10.10.10.10.10.10.9.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.16.10.10.10.10.10.10.10.9.1.1" class="ltx_p" style="width:56.9pt;">67.1 (2.4)</span>
</span></span>
<span id="S4.T4.16.10.10.10.10.10.10.10.10" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.16.10.10.10.10.10.10.10.11" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.16.10.10.10.10.10.10.10.11.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.16.10.10.10.10.10.10.10.11.1.1" class="ltx_p" style="width:51.2pt;">5.67M</span>
</span></span>
<span id="S4.T4.16.10.10.10.10.10.10.10.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.16.10.10.10.10.10.10.10.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.16.10.10.10.10.10.10.10.1.1.1" class="ltx_p" style="width:65.4pt;"><math id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1" class="ltx_Math" alttext="\frac{d_{b}(d_{b}+3)}{2}C" display="inline"><semantics id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1a"><mrow id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.2" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.2.cmml"><mfrac id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.cmml"><mrow id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.cmml"><msub id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3.cmml"><mi id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3.2" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3.2.cmml">d</mi><mi id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3.3" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3.3.cmml">b</mi></msub><mo lspace="0em" rspace="0em" id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.2" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.2.cmml">​</mo><mrow id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.2" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.cmml"><msub id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2.2" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2.2.cmml">d</mi><mi id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2.3" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2.3.cmml">b</mi></msub><mo id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.1" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.3" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.3.cmml">3</mn></mrow><mo stretchy="false" id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.3" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mn id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.3" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.2.1" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.2.1.cmml">​</mo><mi id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.2.2" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.2.2.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1b"><apply id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.2.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.2"><times id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.2.1.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.2.1"></times><apply id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1"><divide id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.2.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1"></divide><apply id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1"><times id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.2.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.2"></times><apply id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3.1.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3">subscript</csymbol><ci id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3.2.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3.2">𝑑</ci><ci id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3.3.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.3.3">𝑏</ci></apply><apply id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1"><plus id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.1"></plus><apply id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2.2">𝑑</ci><ci id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.2.3">𝑏</ci></apply><cn type="integer" id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.1.1.1.1.3">3</cn></apply></apply><cn type="integer" id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.3.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.1.3">2</cn></apply><ci id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.2.2.cmml" xref="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1.2.2">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.16.10.10.10.10.10.10.10.1.1.1.m1.1c">\frac{d_{b}(d_{b}+3)}{2}C</annotation></semantics></math></span>
</span></span>
<span id="S4.T4.16.10.10.10.10.10.10.10.12" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.16.10.10.10.10.10.10.10.12.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.16.10.10.10.10.10.10.10.12.1.1" class="ltx_p" style="width:51.2pt;">7.63M</span>
</span></span></span>
<span id="S4.T4.17.11.11.11.11.11.11.11" class="ltx_tr">
<span id="S4.T4.17.11.11.11.11.11.11.11.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">ProtoNets</span>
<span id="S4.T4.17.11.11.11.11.11.11.11.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">EN-MD</span>
<span id="S4.T4.17.11.11.11.11.11.11.11.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.17.11.11.11.11.11.11.11.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.17.11.11.11.11.11.11.11.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.17.11.11.11.11.11.11.11.5.1.1" class="ltx_p" style="width:59.8pt;">71.6 (2.2)</span>
</span></span>
<span id="S4.T4.17.11.11.11.11.11.11.11.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.17.11.11.11.11.11.11.11.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.17.11.11.11.11.11.11.11.6.1.1" class="ltx_p" style="width:56.9pt;">78.9 (2.7)</span>
</span></span>
<span id="S4.T4.17.11.11.11.11.11.11.11.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.17.11.11.11.11.11.11.11.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.17.11.11.11.11.11.11.11.8.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.17.11.11.11.11.11.11.11.8.1.1" class="ltx_p" style="width:59.8pt;">63.0 (1.8)</span>
</span></span>
<span id="S4.T4.17.11.11.11.11.11.11.11.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.17.11.11.11.11.11.11.11.9.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.17.11.11.11.11.11.11.11.9.1.1" class="ltx_p" style="width:56.9pt;">67.3 (2.4)</span>
</span></span>
<span id="S4.T4.17.11.11.11.11.11.11.11.10" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.17.11.11.11.11.11.11.11.11" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.17.11.11.11.11.11.11.11.11.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.17.11.11.11.11.11.11.11.11.1.1" class="ltx_p" style="width:51.2pt;">4.01M</span>
</span></span>
<span id="S4.T4.17.11.11.11.11.11.11.11.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.17.11.11.11.11.11.11.11.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.17.11.11.11.11.11.11.11.1.1.1" class="ltx_p" style="width:65.4pt;"><math id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1" class="ltx_Math" alttext="d_{b}C" display="inline"><semantics id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1a"><mrow id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.cmml"><msub id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2.cmml"><mi id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2.2" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2.2.cmml">d</mi><mi id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2.3" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2.3.cmml">b</mi></msub><mo lspace="0em" rspace="0em" id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.1" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.1.cmml">​</mo><mi id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.3" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1b"><apply id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.cmml" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1"><times id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.1.cmml" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.1"></times><apply id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2.cmml" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2.1.cmml" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2">subscript</csymbol><ci id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2.2.cmml" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2.2">𝑑</ci><ci id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2.3.cmml" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.2.3">𝑏</ci></apply><ci id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.3.cmml" xref="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.17.11.11.11.11.11.11.11.1.1.1.m1.1c">d_{b}C</annotation></semantics></math></span>
</span></span>
<span id="S4.T4.17.11.11.11.11.11.11.11.12" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.17.11.11.11.11.11.11.11.12.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.17.11.11.11.11.11.11.11.12.1.1" class="ltx_p" style="width:51.2pt;"><span id="S4.T4.17.11.11.11.11.11.11.11.12.1.1.1" class="ltx_text ltx_font_bold">0.01M</span></span>
</span></span></span>
<span id="S4.T4.18.12.12.12.12.12.12.12" class="ltx_tr">
<span id="S4.T4.18.12.12.12.12.12.12.12.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"><span id="S4.T4.18.12.12.12.12.12.12.12.2.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA</span>
<span id="S4.T4.18.12.12.12.12.12.12.12.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">EN-1K</span>
<span id="S4.T4.18.12.12.12.12.12.12.12.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.18.12.12.12.12.12.12.12.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.18.12.12.12.12.12.12.12.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.18.12.12.12.12.12.12.12.5.1.1" class="ltx_p" style="width:59.8pt;">81.8 (1.8)</span>
</span></span>
<span id="S4.T4.18.12.12.12.12.12.12.12.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.18.12.12.12.12.12.12.12.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.18.12.12.12.12.12.12.12.6.1.1" class="ltx_p" style="width:56.9pt;">90.6 (1.9)</span>
</span></span>
<span id="S4.T4.18.12.12.12.12.12.12.12.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.18.12.12.12.12.12.12.12.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.18.12.12.12.12.12.12.12.8.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.18.12.12.12.12.12.12.12.8.1.1" class="ltx_p" style="width:59.8pt;">65.7 (1.8)</span>
</span></span>
<span id="S4.T4.18.12.12.12.12.12.12.12.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.18.12.12.12.12.12.12.12.9.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.18.12.12.12.12.12.12.12.9.1.1" class="ltx_p" style="width:56.9pt;">70.7 (2.3)</span>
</span></span>
<span id="S4.T4.18.12.12.12.12.12.12.12.10" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.18.12.12.12.12.12.12.12.11" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.18.12.12.12.12.12.12.12.11.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.18.12.12.12.12.12.12.12.11.1.1" class="ltx_p" style="width:51.2pt;">4.01M</span>
</span></span>
<span id="S4.T4.18.12.12.12.12.12.12.12.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.18.12.12.12.12.12.12.12.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.18.12.12.12.12.12.12.12.1.1.1" class="ltx_p" style="width:65.4pt;"><math id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2" class="ltx_Math" alttext="(d_{b}+1)C+|{\bm{\psi}}|" display="inline"><semantics id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2a"><mrow id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.cmml"><mrow id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.cmml"><mrow id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.2" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.cmml"><msub id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2.cmml"><mi id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2.2" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2.2.cmml">d</mi><mi id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2.3" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2.3.cmml">b</mi></msub><mo id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.1" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.1.cmml">+</mo><mn id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.3" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.3" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.2" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.2.cmml">​</mo><mi id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.3" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.3.cmml">C</mi></mrow><mo id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.2" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.2.cmml">+</mo><mrow id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.3.2" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.3.1.cmml"><mo stretchy="false" id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.3.2.1" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.3.1.1.cmml">|</mo><mi id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.1.1" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.1.1.cmml">𝝍</mi><mo stretchy="false" id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.3.2.2" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2b"><apply id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2"><plus id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.2.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.2"></plus><apply id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1"><times id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.2.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.2"></times><apply id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1"><plus id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.1"></plus><apply id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2.2.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2.2">𝑑</ci><ci id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2.3.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.2.3">𝑏</ci></apply><cn type="integer" id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.3.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.1.1.1.3">1</cn></apply><ci id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.3.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.1.3">𝐶</ci></apply><apply id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.3.1.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.3.2"><abs id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.3.1.1.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2.2.3.2.1"></abs><ci id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.1.1.cmml" xref="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.1.1">𝝍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.18.12.12.12.12.12.12.12.1.1.1.m1.2c">(d_{b}+1)C+|{\bm{\psi}}|</annotation></semantics></math></span>
</span></span>
<span id="S4.T4.18.12.12.12.12.12.12.12.12" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.18.12.12.12.12.12.12.12.12.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.18.12.12.12.12.12.12.12.12.1.1" class="ltx_p" style="width:51.2pt;"><span id="S4.T4.18.12.12.12.12.12.12.12.12.1.1.1" class="ltx_text ltx_font_bold">0.03M</span></span>
</span></span></span>
<span id="S4.T4.19.13.13.13.13.13.13.13" class="ltx_tr">
<span id="S4.T4.19.13.13.13.13.13.13.13.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;">BiT</span>
<span id="S4.T4.19.13.13.13.13.13.13.13.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;">RN-21K</span>
<span id="S4.T4.19.13.13.13.13.13.13.13.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.19.13.13.13.13.13.13.13.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.19.13.13.13.13.13.13.13.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.19.13.13.13.13.13.13.13.5.1.1" class="ltx_p" style="width:59.8pt;"><span id="S4.T4.19.13.13.13.13.13.13.13.5.1.1.1" class="ltx_text ltx_font_bold">82.4 (1.8)</span></span>
</span></span>
<span id="S4.T4.19.13.13.13.13.13.13.13.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.19.13.13.13.13.13.13.13.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.19.13.13.13.13.13.13.13.6.1.1" class="ltx_p" style="width:56.9pt;"><span id="S4.T4.19.13.13.13.13.13.13.13.6.1.1.1" class="ltx_text ltx_font_bold">89.7 (2.0)</span></span>
</span></span>
<span id="S4.T4.19.13.13.13.13.13.13.13.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.19.13.13.13.13.13.13.13.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.19.13.13.13.13.13.13.13.8.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.19.13.13.13.13.13.13.13.8.1.1" class="ltx_p" style="width:59.8pt;"><span id="S4.T4.19.13.13.13.13.13.13.13.8.1.1.1" class="ltx_text ltx_font_bold">67.7 (1.8)</span></span>
</span></span>
<span id="S4.T4.19.13.13.13.13.13.13.13.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.19.13.13.13.13.13.13.13.9.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.19.13.13.13.13.13.13.13.9.1.1" class="ltx_p" style="width:56.9pt;"><span id="S4.T4.19.13.13.13.13.13.13.13.9.1.1.1" class="ltx_text ltx_font_bold">73.9 (2.2)</span></span>
</span></span>
<span id="S4.T4.19.13.13.13.13.13.13.13.10" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.19.13.13.13.13.13.13.13.11" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.19.13.13.13.13.13.13.13.11.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.19.13.13.13.13.13.13.13.11.1.1" class="ltx_p" style="width:51.2pt;">0</span>
</span></span>
<span id="S4.T4.19.13.13.13.13.13.13.13.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.19.13.13.13.13.13.13.13.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.19.13.13.13.13.13.13.13.1.1.1" class="ltx_p" style="width:65.4pt;"><math id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2" class="ltx_Math" alttext="(d_{b}+1)C+|{\bm{\theta}}|" display="inline"><semantics id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2a"><mrow id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.cmml"><mrow id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.cmml"><mrow id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.2" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.cmml"><msub id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2.cmml"><mi id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2.2" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2.2.cmml">d</mi><mi id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2.3" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2.3.cmml">b</mi></msub><mo id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.1" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.1.cmml">+</mo><mn id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.3" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.3" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.2" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.2.cmml">​</mo><mi id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.3" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.3.cmml">C</mi></mrow><mo id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.2" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.2.cmml">+</mo><mrow id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.3.2" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.3.1.cmml"><mo stretchy="false" id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.3.2.1" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.3.1.1.cmml">|</mo><mi id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.1.1" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.3.2.2" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2b"><apply id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2"><plus id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.2.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.2"></plus><apply id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1"><times id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.2.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.2"></times><apply id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1"><plus id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.1"></plus><apply id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2.2.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2.2">𝑑</ci><ci id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2.3.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.2.3">𝑏</ci></apply><cn type="integer" id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.3.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.1.1.1.3">1</cn></apply><ci id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.3.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.1.3">𝐶</ci></apply><apply id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.3.1.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.3.2"><abs id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.3.1.1.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2.2.3.2.1"></abs><ci id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.1.1.cmml" xref="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.1.1">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.19.13.13.13.13.13.13.13.1.1.1.m1.2c">(d_{b}+1)C+|{\bm{\theta}}|</annotation></semantics></math></span>
</span></span>
<span id="S4.T4.19.13.13.13.13.13.13.13.12" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_tt" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.19.13.13.13.13.13.13.13.12.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.19.13.13.13.13.13.13.13.12.1.1" class="ltx_p" style="width:51.2pt;">23.5M</span>
</span></span></span>
<span id="S4.T4.20.14.14.14.14.14.14.14" class="ltx_tr">
<span id="S4.T4.20.14.14.14.14.14.14.14.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"><span id="S4.T4.20.14.14.14.14.14.14.14.2.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA</span>
<span id="S4.T4.20.14.14.14.14.14.14.14.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">RN-21K</span>
<span id="S4.T4.20.14.14.14.14.14.14.14.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_border_bb ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.20.14.14.14.14.14.14.14.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.20.14.14.14.14.14.14.14.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.20.14.14.14.14.14.14.14.5.1.1" class="ltx_p" style="width:59.8pt;"><span id="S4.T4.20.14.14.14.14.14.14.14.5.1.1.1" class="ltx_text ltx_font_bold">83.5 (1.7)</span></span>
</span></span>
<span id="S4.T4.20.14.14.14.14.14.14.14.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.20.14.14.14.14.14.14.14.6.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.20.14.14.14.14.14.14.14.6.1.1" class="ltx_p" style="width:56.9pt;"><span id="S4.T4.20.14.14.14.14.14.14.14.6.1.1.1" class="ltx_text ltx_font_bold">90.1 (2.0)</span></span>
</span></span>
<span id="S4.T4.20.14.14.14.14.14.14.14.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_bb ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.20.14.14.14.14.14.14.14.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.20.14.14.14.14.14.14.14.8.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.20.14.14.14.14.14.14.14.8.1.1" class="ltx_p" style="width:59.8pt;"><span id="S4.T4.20.14.14.14.14.14.14.14.8.1.1.1" class="ltx_text ltx_font_bold">67.4 (1.8)</span></span>
</span></span>
<span id="S4.T4.20.14.14.14.14.14.14.14.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.20.14.14.14.14.14.14.14.9.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.20.14.14.14.14.14.14.14.9.1.1" class="ltx_p" style="width:56.9pt;"><span id="S4.T4.20.14.14.14.14.14.14.14.9.1.1.1" class="ltx_text ltx_font_bold">73.5 (2.2)</span></span>
</span></span>
<span id="S4.T4.20.14.14.14.14.14.14.14.10" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_top ltx_border_bb ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;"></span>
<span id="S4.T4.20.14.14.14.14.14.14.14.11" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.20.14.14.14.14.14.14.14.11.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.20.14.14.14.14.14.14.14.11.1.1" class="ltx_p" style="width:51.2pt;">23.5M</span>
</span></span>
<span id="S4.T4.20.14.14.14.14.14.14.14.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.20.14.14.14.14.14.14.14.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.20.14.14.14.14.14.14.14.1.1.1" class="ltx_p" style="width:65.4pt;"><math id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2" class="ltx_Math" alttext="(d_{b}+1)C+|{\bm{\psi}}|" display="inline"><semantics id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2a"><mrow id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.cmml"><mrow id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.cmml"><mrow id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.2" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.cmml"><msub id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2.cmml"><mi id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2.2" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2.2.cmml">d</mi><mi id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2.3" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2.3.cmml">b</mi></msub><mo id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.1" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.1.cmml">+</mo><mn id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.3" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.3" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.2" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.2.cmml">​</mo><mi id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.3" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.3.cmml">C</mi></mrow><mo id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.2" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.2.cmml">+</mo><mrow id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.3.2" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.3.1.cmml"><mo stretchy="false" id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.3.2.1" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.3.1.1.cmml">|</mo><mi id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.1.1" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.1.1.cmml">𝝍</mi><mo stretchy="false" id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.3.2.2" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2b"><apply id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2"><plus id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.2.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.2"></plus><apply id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1"><times id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.2.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.2"></times><apply id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1"><plus id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.1"></plus><apply id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2.2.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2.2">𝑑</ci><ci id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2.3.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.2.3">𝑏</ci></apply><cn type="integer" id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.3.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.1.1.1.3">1</cn></apply><ci id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.3.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.1.3">𝐶</ci></apply><apply id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.3.1.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.3.2"><abs id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.3.1.1.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2.2.3.2.1"></abs><ci id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.1.1.cmml" xref="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.1.1">𝝍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.20.14.14.14.14.14.14.14.1.1.1.m1.2c">(d_{b}+1)C+|{\bm{\psi}}|</annotation></semantics></math></span>
</span></span>
<span id="S4.T4.20.14.14.14.14.14.14.14.12" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" style="padding-left:1.2pt;padding-right:1.2pt;">
<span id="S4.T4.20.14.14.14.14.14.14.14.12.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.20.14.14.14.14.14.14.14.12.1.1" class="ltx_p" style="width:51.2pt;"><span id="S4.T4.20.14.14.14.14.14.14.14.12.1.1.1" class="ltx_text ltx_font_bold">0.03M</span></span>
</span></span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Few-shot Federated Learning</h3>

<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.1" class="ltx_p">We now show how <span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> can be used in the few-shot federated learning setting, where training data are split between client nodes, e.g. mobile phones or personal laptops, and each client has only a handful of samples.
Model training is performed via numerous communication rounds between a server and clients.
In each round, the server selects a fraction of clients making updates and then sends the current model parameters to these clients.
Clients update models locally using only their personal data and then send their parameter updates back to the server.
Finally, the server aggregates information from all clients, updates the shared model parameters, and proceeds to the next round until convergence.
In this setting, models with a smaller number of updateable parameters are preferred in order to reduce the client-server communication cost which is typically bandwidth-limited.
The configuration and training protocol of <span id="S4.SS4.p1.1.2" class="ltx_text ltx_font_smallcaps">FiT</span> help significantly reduce communication cost compared to standard fine-tuning protocols, as i) only FiLM layers are transferred at each communication round, ii) in contrast to standard linear head, the Naive Bayes head is not transferred and is constructed locally for each client.
<a href="#S4.T5" title="In 4.4 Few-shot Federated Learning ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">5</span></a> shows communication parameters savings of <span id="S4.SS4.p1.1.3" class="ltx_text ltx_font_smallcaps">FiT</span> compared to BiT.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.p2.4" class="ltx_p"><span id="S4.SS4.p2.4.1" class="ltx_text ltx_font_bold">Experiments</span>
We use CIFAR100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib31" title="" class="ltx_ref">2009</a>)</cite>, a relatively large-scale dataset compared to those commonly used to benchmark federated learning methods <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a href="#bib.bib49" title="" class="ltx_ref">2021</a>; Shamsian et al., <a href="#bib.bib53" title="" class="ltx_ref">2021</a>)</cite>.
We employ the basic <span id="S4.SS4.p2.4.2" class="ltx_text ltx_font_typewriter">FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib38" title="" class="ltx_ref">2016</a>)</cite> algorithm, although other algorithms can also be used (<a href="#A1.T7" title="In A.8 Additional Few-shot Federated Learning Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.7</span></a>).
We train all models for <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="60" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><mn id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">60</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><cn type="integer" id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">60</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">60</annotation></semantics></math> communication rounds, with <math id="S4.SS4.p2.2.m2.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.SS4.p2.2.m2.1a"><mn id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><cn type="integer" id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">5</annotation></semantics></math> clients per round and <math id="S4.SS4.p2.3.m3.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS4.p2.3.m3.1a"><mn id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><cn type="integer" id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">10</annotation></semantics></math> update steps per client.
Each client has <math id="S4.SS4.p2.4.m4.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS4.p2.4.m4.1a"><mn id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><cn type="integer" id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">10</annotation></semantics></math> classes, which are sampled randomly before the start of training.
We use a ProtoNets head for simplicity, although QDA and LDA heads could also be used.
More specific training and evaluation details are in <a href="#A1.SS11.SSS3" title="A.11.3 Federated Learning Experiments ‣ A.11 Training and Evaluation Details ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.11.3</span></a>.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para ltx_noindent">
<p id="S4.SS4.p3.1" class="ltx_p">We evaluate <span id="S4.SS4.p3.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> in two scenarios, global and personalized.
In the global setting, the aim is to construct a global classifier and report accuracy on the CIFAR100 test set.
We assume that the server knows which classes belong to each client, and constructs a shared classifier by taking a mean over prototypes produced by clients for a particular class.
In the personalized scenario, we test a personalized model on test classes present in the individual’s training set and then report the mean accuracy over all clients.
As opposed to the personalization experiments on ORBIT, where a personalized model is trained using only the client’s local data, in this experiment we initialize a personalized model with the learned global FiLM parameters and then construct a ProtoNets classifier with an individual’s data.
Thus, the goal of the personalized setting is to estimate how advantageous distributed learning can be for training FiLM layers to build personalized few-shot models.</p>
</div>
<div id="S4.SS4.p4" class="ltx_para ltx_noindent">
<p id="S4.SS4.p4.1" class="ltx_p">To test the global scenario, we compare <span id="S4.SS4.p4.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> to BiT. As the training protocol used in BiT cannot be directly applied in the federated learning context, we trained BiT with a constant learning rate. We do not provide comparison on the personalized scenario, as BiT uses a linear classification head trained globally, as opposed to using only client’s local data.
As, to the best of our knowledge, there are no suitable federated learning systems to compare to, we define baselines which form an upper and lower bounds on the model performance.
For the global scenario, we take a <span id="S4.SS4.p4.1.2" class="ltx_text ltx_font_smallcaps">FiT</span> model trained centrally on all available data as the upper bound baseline.
To get the lower bound baseline, we train a <span id="S4.SS4.p4.1.3" class="ltx_text ltx_font_smallcaps">FiT</span> model for each client with their local data, then average FiLM parameters of these individual models and construct a global ProtoNets classifier using the resulting FiLM parameters.
The upper bound is therefore standard batch training, the performance of which we hope federated learning can approach. The lower bound is a simplistic version of federated learning with a single communication round which federated averaging should improve over.
For the personalized setting, the upper bound baseline is as in the global scenario from which we form a personalized classifier by taking a subset of classes belonging to a client from a global <math id="S4.SS4.p4.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS4.p4.1.m1.1a"><mn id="S4.SS4.p4.1.m1.1.1" xref="S4.SS4.p4.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.1.m1.1b"><cn type="integer" id="S4.SS4.p4.1.m1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.1.m1.1c">100</annotation></semantics></math>-way classifier. The lower bound baseline is set to a <span id="S4.SS4.p4.1.4" class="ltx_text ltx_font_smallcaps">FiT</span> model trained for each client individually. The upper bound is again standard batch training and the lower bound is derived from locally trained models which do not share information and therefore should be improved upon by federated learning.</p>
</div>
<div id="S4.SS4.p5" class="ltx_para">
<p id="S4.SS4.p5.1" class="ltx_p"><span id="S4.SS4.p5.1.1" class="ltx_text ltx_font_bold">Results</span>
<a href="#S4.T5" title="In 4.4 Few-shot Federated Learning ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">5</span></a> shows the comparison of <span id="S4.SS4.p5.1.2" class="ltx_text ltx_font_smallcaps">FiT</span> to BiT.
<a href="#S4.F4" title="In 4.4 Few-shot Federated Learning ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a> shows global and personalized classification accuracy as a function of communication cost for different numbers of clients and shots per client.
By communication cost we mean the number of parameters transmitted during training.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span><span id="S4.T5.11.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FiT<span id="S4.T5.11.1.1" class="ltx_text ltx_font_upright"> is significantly more parameter efficient than BiT for federated learning.</span></span> Comparison of BiT and <span id="S4.T5.12.2" class="ltx_text ltx_font_smallcaps">FiT</span> in few-shot federated setting on CIFAR100 for different numbers of clients and shots per client. Global setting is used. Accuracy figures are percentages and the <math id="S4.T5.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.4.m1.1b"><mo id="S4.T5.4.m1.1.1" xref="S4.T5.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.4.m1.1c"><csymbol cd="latexml" id="S4.T5.4.m1.1.1.cmml" xref="S4.T5.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.m1.1d">\pm</annotation></semantics></math> sign indicates the <math id="S4.T5.5.m2.1" class="ltx_Math" alttext="95\%" display="inline"><semantics id="S4.T5.5.m2.1b"><mrow id="S4.T5.5.m2.1.1" xref="S4.T5.5.m2.1.1.cmml"><mn id="S4.T5.5.m2.1.1.2" xref="S4.T5.5.m2.1.1.2.cmml">95</mn><mo id="S4.T5.5.m2.1.1.1" xref="S4.T5.5.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T5.5.m2.1c"><apply id="S4.T5.5.m2.1.1.cmml" xref="S4.T5.5.m2.1.1"><csymbol cd="latexml" id="S4.T5.5.m2.1.1.1.cmml" xref="S4.T5.5.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.T5.5.m2.1.1.2.cmml" xref="S4.T5.5.m2.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.m2.1d">95\%</annotation></semantics></math> confidence interval over <math id="S4.T5.6.m3.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S4.T5.6.m3.1b"><mn id="S4.T5.6.m3.1.1" xref="S4.T5.6.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.T5.6.m3.1c"><cn type="integer" id="S4.T5.6.m3.1.1.cmml" xref="S4.T5.6.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.6.m3.1d">3</annotation></semantics></math> runs. Parameter cost indicates the number of parameters sent in server-client communication. <span id="S4.T5.13.3" class="ltx_text ltx_font_italic">Per round</span> is the number of parameters transmitted in each communication round and <span id="S4.T5.14.4" class="ltx_text ltx_font_italic">Overall</span> is the number of parameters transmitted during the whole training.</figcaption>
<div id="S4.T5.15" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:45.1pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-123.1pt,13.8pt) scale(0.61753,0.61753) ;">
<p id="S4.T5.15.1" class="ltx_p"><span id="S4.T5.15.1.1" class="ltx_text">
<span id="S4.T5.15.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:643.7pt;height:73pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S4.T5.15.1.1.1.1" class="ltx_p"><span id="S4.T5.15.1.1.1.1.1" class="ltx_text">
<span id="S4.T5.15.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="S4.T5.15.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S4.T5.15.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_border_tt"></span>
<span id="S4.T5.15.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="S4.T5.15.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_2"><span id="S4.T5.15.1.1.1.1.1.1.1.1.3.1" class="ltx_text ltx_font_bold">Parameter cost</span></span>
<span id="S4.T5.15.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="S4.T5.15.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3"><span id="S4.T5.15.1.1.1.1.1.1.1.1.5.1" class="ltx_text ltx_font_bold">50 Clients</span></span>
<span id="S4.T5.15.1.1.1.1.1.1.1.1.6" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="S4.T5.15.1.1.1.1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3"><span id="S4.T5.15.1.1.1.1.1.1.1.1.7.1" class="ltx_text ltx_font_bold">100 Clients</span></span>
<span id="S4.T5.15.1.1.1.1.1.1.1.1.8" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="S4.T5.15.1.1.1.1.1.1.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3"><span id="S4.T5.15.1.1.1.1.1.1.1.1.9.1" class="ltx_text ltx_font_bold">500 Clients</span></span></span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2" class="ltx_tr">
<span id="S4.T5.15.1.1.1.1.1.1.2.2.1" class="ltx_td ltx_align_center">Models</span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.2" class="ltx_td"></span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">Per round</span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">Overall</span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.5" class="ltx_td"></span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">2-Shot</span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.7" class="ltx_td ltx_align_center ltx_border_t">5-Shot</span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.8" class="ltx_td ltx_align_center ltx_border_t">10-Shot</span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.9" class="ltx_td"></span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.10" class="ltx_td ltx_align_center ltx_border_t">2-Shot</span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.11" class="ltx_td ltx_align_center ltx_border_t">5-Shot</span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.12" class="ltx_td ltx_align_center ltx_border_t">10-Shot</span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.13" class="ltx_td"></span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.14" class="ltx_td ltx_align_center ltx_border_t">2-Shot</span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.15" class="ltx_td ltx_align_center ltx_border_t">5-Shot</span>
<span id="S4.T5.15.1.1.1.1.1.1.2.2.16" class="ltx_td ltx_align_center ltx_border_t">10-Shot</span></span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3" class="ltx_tr">
<span id="S4.T5.15.1.1.1.1.1.1.3.3.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.15.1.1.1.1.1.1.3.3.1.1" class="ltx_text ltx_font_smallcaps">FiT</span></span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.2" class="ltx_td ltx_border_t"></span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.15.1.1.1.1.1.1.3.3.3.1" class="ltx_text ltx_font_bold">0.1M</span></span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.15.1.1.1.1.1.1.3.3.4.1" class="ltx_text ltx_font_bold">7M</span></span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.5" class="ltx_td ltx_border_t"></span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">68.5±0.3</span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">73.8±0.7</span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">77.1±0.3</span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.9" class="ltx_td ltx_border_t"></span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.10" class="ltx_td ltx_align_center ltx_border_t">74.4±0.3</span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.11" class="ltx_td ltx_align_center ltx_border_t">76.5±0.2</span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.12" class="ltx_td ltx_align_center ltx_border_t">78.4±0.1</span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.13" class="ltx_td ltx_border_t"></span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.14" class="ltx_td ltx_align_center ltx_border_t">77.9±0.4</span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.15" class="ltx_td ltx_align_center ltx_border_t">77.6±0.1</span>
<span id="S4.T5.15.1.1.1.1.1.1.3.3.16" class="ltx_td ltx_align_center ltx_border_t">79.2±0.3</span></span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4" class="ltx_tr">
<span id="S4.T5.15.1.1.1.1.1.1.4.4.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">BiT</span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.2" class="ltx_td ltx_border_bb ltx_border_t"></span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">237M</span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">14B</span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.5" class="ltx_td ltx_border_bb ltx_border_t"></span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">69.0±1.4</span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">75.6±0.6</span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">78.9±0.6</span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.9" class="ltx_td ltx_border_bb ltx_border_t"></span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">73.2±1.9</span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.11" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">78.6±0.3</span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.12" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">80.2±0.3</span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.13" class="ltx_td ltx_border_bb ltx_border_t"></span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.14" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">69.9±0.3</span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.15" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">77.3±0.9</span>
<span id="S4.T5.15.1.1.1.1.1.1.4.4.16" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">78.6±1.3</span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</figure>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2206.08671/assets/x5.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="189" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Global and personalized classification accuracy as a function of communication cost over <math id="S4.F4.3.m1.1" class="ltx_Math" alttext="60" display="inline"><semantics id="S4.F4.3.m1.1b"><mn id="S4.F4.3.m1.1.1" xref="S4.F4.3.m1.1.1.cmml">60</mn><annotation-xml encoding="MathML-Content" id="S4.F4.3.m1.1c"><cn type="integer" id="S4.F4.3.m1.1.1.cmml" xref="S4.F4.3.m1.1.1">60</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.3.m1.1d">60</annotation></semantics></math> rounds for different numbers of clients and shots per client on CIFAR100. Classification accuracy is on the vertical axis and is the average of <math id="S4.F4.4.m2.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S4.F4.4.m2.1b"><mn id="S4.F4.4.m2.1.1" xref="S4.F4.4.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.F4.4.m2.1c"><cn type="integer" id="S4.F4.4.m2.1.1.cmml" xref="S4.F4.4.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.m2.1d">3</annotation></semantics></math> runs with different data sampling seeds. The color of the line indicates the number of shots per class. The solid line shows the federated learning model, while dashed and dotted lines indicate the upper and lower bounds baselines, respectively.</figcaption>
</figure>
<div id="S4.SS4.p6" class="ltx_para ltx_noindent">
<p id="S4.SS4.p6.1" class="ltx_p">The key observations from our results are:</p>
<ul id="S4.I4" class="ltx_itemize">
<li id="S4.I4.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I4.i1.p1" class="ltx_para">
<p id="S4.I4.i1.p1.2" class="ltx_p"><span id="S4.I4.i1.p1.2.1" class="ltx_text ltx_font_smallcaps">FiT</span> and BiT show comparable performance in terms of test accuracy, however <span id="S4.I4.i1.p1.2.2" class="ltx_text ltx_font_smallcaps">FiT</span> is much more parameter efficient and requires transmission of only <math id="S4.I4.i1.p1.1.m1.1" class="ltx_Math" alttext="7M" display="inline"><semantics id="S4.I4.i1.p1.1.m1.1a"><mrow id="S4.I4.i1.p1.1.m1.1.1" xref="S4.I4.i1.p1.1.m1.1.1.cmml"><mn id="S4.I4.i1.p1.1.m1.1.1.2" xref="S4.I4.i1.p1.1.m1.1.1.2.cmml">7</mn><mo lspace="0em" rspace="0em" id="S4.I4.i1.p1.1.m1.1.1.1" xref="S4.I4.i1.p1.1.m1.1.1.1.cmml">​</mo><mi id="S4.I4.i1.p1.1.m1.1.1.3" xref="S4.I4.i1.p1.1.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I4.i1.p1.1.m1.1b"><apply id="S4.I4.i1.p1.1.m1.1.1.cmml" xref="S4.I4.i1.p1.1.m1.1.1"><times id="S4.I4.i1.p1.1.m1.1.1.1.cmml" xref="S4.I4.i1.p1.1.m1.1.1.1"></times><cn type="integer" id="S4.I4.i1.p1.1.m1.1.1.2.cmml" xref="S4.I4.i1.p1.1.m1.1.1.2">7</cn><ci id="S4.I4.i1.p1.1.m1.1.1.3.cmml" xref="S4.I4.i1.p1.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I4.i1.p1.1.m1.1c">7M</annotation></semantics></math> parameters through training, in contrast to <math id="S4.I4.i1.p1.2.m2.1" class="ltx_Math" alttext="14B" display="inline"><semantics id="S4.I4.i1.p1.2.m2.1a"><mrow id="S4.I4.i1.p1.2.m2.1.1" xref="S4.I4.i1.p1.2.m2.1.1.cmml"><mn id="S4.I4.i1.p1.2.m2.1.1.2" xref="S4.I4.i1.p1.2.m2.1.1.2.cmml">14</mn><mo lspace="0em" rspace="0em" id="S4.I4.i1.p1.2.m2.1.1.1" xref="S4.I4.i1.p1.2.m2.1.1.1.cmml">​</mo><mi id="S4.I4.i1.p1.2.m2.1.1.3" xref="S4.I4.i1.p1.2.m2.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I4.i1.p1.2.m2.1b"><apply id="S4.I4.i1.p1.2.m2.1.1.cmml" xref="S4.I4.i1.p1.2.m2.1.1"><times id="S4.I4.i1.p1.2.m2.1.1.1.cmml" xref="S4.I4.i1.p1.2.m2.1.1.1"></times><cn type="integer" id="S4.I4.i1.p1.2.m2.1.1.2.cmml" xref="S4.I4.i1.p1.2.m2.1.1.2">14</cn><ci id="S4.I4.i1.p1.2.m2.1.1.3.cmml" xref="S4.I4.i1.p1.2.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I4.i1.p1.2.m2.1c">14B</annotation></semantics></math> parameters for BiT. This makes <span id="S4.I4.i1.p1.2.3" class="ltx_text ltx_font_smallcaps">FiT</span> highly suitable for federated learning applications.</p>
</div>
</li>
<li id="S4.I4.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I4.i2.p1" class="ltx_para">
<p id="S4.I4.i2.p1.1" class="ltx_p">In the global setting, the federated learning model is only slightly worse (<math id="S4.I4.i2.p1.1.m1.1" class="ltx_Math" alttext="3-5\%" display="inline"><semantics id="S4.I4.i2.p1.1.m1.1a"><mrow id="S4.I4.i2.p1.1.m1.1.1" xref="S4.I4.i2.p1.1.m1.1.1.cmml"><mn id="S4.I4.i2.p1.1.m1.1.1.2" xref="S4.I4.i2.p1.1.m1.1.1.2.cmml">3</mn><mo id="S4.I4.i2.p1.1.m1.1.1.1" xref="S4.I4.i2.p1.1.m1.1.1.1.cmml">−</mo><mrow id="S4.I4.i2.p1.1.m1.1.1.3" xref="S4.I4.i2.p1.1.m1.1.1.3.cmml"><mn id="S4.I4.i2.p1.1.m1.1.1.3.2" xref="S4.I4.i2.p1.1.m1.1.1.3.2.cmml">5</mn><mo id="S4.I4.i2.p1.1.m1.1.1.3.1" xref="S4.I4.i2.p1.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I4.i2.p1.1.m1.1b"><apply id="S4.I4.i2.p1.1.m1.1.1.cmml" xref="S4.I4.i2.p1.1.m1.1.1"><minus id="S4.I4.i2.p1.1.m1.1.1.1.cmml" xref="S4.I4.i2.p1.1.m1.1.1.1"></minus><cn type="integer" id="S4.I4.i2.p1.1.m1.1.1.2.cmml" xref="S4.I4.i2.p1.1.m1.1.1.2">3</cn><apply id="S4.I4.i2.p1.1.m1.1.1.3.cmml" xref="S4.I4.i2.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S4.I4.i2.p1.1.m1.1.1.3.1.cmml" xref="S4.I4.i2.p1.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.I4.i2.p1.1.m1.1.1.3.2.cmml" xref="S4.I4.i2.p1.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I4.i2.p1.1.m1.1c">3-5\%</annotation></semantics></math>) than the upper bound baseline, while outperforming the lower bound model, often by a large margin. This shows that <span id="S4.I4.i2.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> can be efficiently used in federated learning settings with different configurations.</p>
</div>
</li>
<li id="S4.I4.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I4.i3.p1" class="ltx_para ltx_noindent">
<p id="S4.I4.i3.p1.2" class="ltx_p">In the personalized scenario, for a sufficient number of clients (<math id="S4.I4.i3.p1.1.m1.1" class="ltx_Math" alttext="\geq 50" display="inline"><semantics id="S4.I4.i3.p1.1.m1.1a"><mrow id="S4.I4.i3.p1.1.m1.1.1" xref="S4.I4.i3.p1.1.m1.1.1.cmml"><mi id="S4.I4.i3.p1.1.m1.1.1.2" xref="S4.I4.i3.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.I4.i3.p1.1.m1.1.1.1" xref="S4.I4.i3.p1.1.m1.1.1.1.cmml">≥</mo><mn id="S4.I4.i3.p1.1.m1.1.1.3" xref="S4.I4.i3.p1.1.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I4.i3.p1.1.m1.1b"><apply id="S4.I4.i3.p1.1.m1.1.1.cmml" xref="S4.I4.i3.p1.1.m1.1.1"><geq id="S4.I4.i3.p1.1.m1.1.1.1.cmml" xref="S4.I4.i3.p1.1.m1.1.1.1"></geq><csymbol cd="latexml" id="S4.I4.i3.p1.1.m1.1.1.2.cmml" xref="S4.I4.i3.p1.1.m1.1.1.2">absent</csymbol><cn type="integer" id="S4.I4.i3.p1.1.m1.1.1.3.cmml" xref="S4.I4.i3.p1.1.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I4.i3.p1.1.m1.1c">\geq 50</annotation></semantics></math>) the gap between the federated learning model and the upper bound model is significantly reduced with the increase in number of shots. Federated training strongly outperforms the lower bound baseline, surprisingly even in the case of <math id="S4.I4.i3.p1.2.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.I4.i3.p1.2.m2.1a"><mn id="S4.I4.i3.p1.2.m2.1.1" xref="S4.I4.i3.p1.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.I4.i3.p1.2.m2.1b"><cn type="integer" id="S4.I4.i3.p1.2.m2.1.1.cmml" xref="S4.I4.i3.p1.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I4.i3.p1.2.m2.1c">10</annotation></semantics></math> clients with disjoint classes. This provides empirical evidence that collaborative distributed training can be helpful for improving personalized models in the few-shot data regime.</p>
</div>
</li>
</ul>
<p id="S4.SS4.p6.2" class="ltx_p">In <a href="#A1.SS8" title="A.8 Additional Few-shot Federated Learning Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.8</span></a>, we show that distributed training of a <span id="S4.SS4.p6.2.1" class="ltx_text ltx_font_smallcaps">FiT</span> model can be efficiently used to learn from more extreme, non-natural image datasets like Quickdraw <cite class="ltx_cite ltx_citemacro_citep">(Jongejan et al., <a href="#bib.bib26" title="" class="ltx_ref">2016</a>)</cite>.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">In this work, we proposed <span id="S5.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>, a parameter and data efficient few-shot transfer learning system that allows image classification models to be updated with only a small subset of the total model parameters.
We demonstrated that <span id="S5.p1.1.2" class="ltx_text ltx_font_smallcaps">FiT</span> can outperform BiT using fewer than 1% of the updateable parameters and achieve state-of-the-art accuracy on VTAB-1k.
We also showed the parameter efficiency benefits of employing <span id="S5.p1.1.3" class="ltx_text ltx_font_smallcaps">FiT</span> in model personalization and federated learning applications.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para ltx_noindent">
<p id="Sx1.p1.1" class="ltx_p">Aliaksandra Shysheya, John Bronskill, Massimiliano Patacchiola and Richard E. Turner are supported by an EPSRC Prosperity Partnership EP/T005386/1 between the EPSRC, Microsoft Research and the University of Cambridge.
This work has been performed using resources provided by the Cambridge Tier-2 system operated by the University of Cambridge Research Computing Service <a target="_blank" href="https://www.hpc.cam.ac.uk" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.hpc.cam.ac.uk</a> funded by EPSRC Tier-2 capital grant EP/P020259/1.
We thank the anonymous reviewers for key suggestions and insightful questions that significantly improved the quality of the paper.
We also thank Aristeidis Panos and Siddharth Swaroop for providing helpful comments and suggestions.</p>
</div>
<section id="Sx1.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Reproducibility Statement</h5>

<div id="Sx1.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="Sx1.SS0.SSS0.Px1.p1.1" class="ltx_p">Source code for experiments can be found at: <a target="_blank" href="https://github.com/cambridge-mlg/fit" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/cambridge-mlg/fit</a>. The README file details the data preparation steps and includes the command lines to configure and run the experiments. <a href="#A1.SS11" title="A.11 Training and Evaluation Details ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.11</span></a> details the training and evaluation procedures and hyperparameter settings for all of the experiments including few-shot and VTAB-1k transfer learning experiments, personalization on ORBIT experiments, and the federated learning experiments.</p>
</div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan et al. (2019)</span>
<span class="ltx_bibblock">
Manoj Ghuhan Arivazhagan, Vinay Aggarwal, Aaditya Kumar Singh, and Sunav
Choudhary.

</span>
<span class="ltx_bibblock">Federated learning with personalization layers.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1912.00818, 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1912.00818" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1912.00818</a>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bateni et al. (2020)</span>
<span class="ltx_bibblock">
Peyman Bateni, Raghav Goyal, Vaden Masrani, Frank Wood, and Leonid Sigal.

</span>
<span class="ltx_bibblock">Improved few-shot visual classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, pp.  14493–14502, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beattie et al. (2016)</span>
<span class="ltx_bibblock">
Charles Beattie, Joel Z Leibo, Denis Teplyashin, Tom Ward, Marcus Wainwright,
Heinrich Küttler, Andrew Lefrancq, Simon Green, Víctor Valdés,
Amir Sadik, et al.

</span>
<span class="ltx_bibblock">Deepmind lab.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1612.03801</em>, 2016.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bronskill et al. (2021)</span>
<span class="ltx_bibblock">
John F Bronskill, Daniela Massiceti, Massimiliano Patacchiola, Katja Hofmann,
Sebastian Nowozin, and Richard E Turner.

</span>
<span class="ltx_bibblock">Memory efficient meta-learning with large images.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Thirty-Fifth Conference on Neural Information Processing
Systems</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=x2pF7Tt_S5u" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=x2pF7Tt_S5u</a>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla
Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
et al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
33:1877–1901, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2022)</span>
<span class="ltx_bibblock">
Shoufa Chen, Chongjian Ge, Zhan Tong, Jiangliu Wang, Yibing Song, Jue Wang, and
Ping Luo.

</span>
<span class="ltx_bibblock">Adaptformer: Adapting vision transformers for scalable visual
recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2205.13535</em>, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al. (2017)</span>
<span class="ltx_bibblock">
Gong Cheng, Junwei Han, and Xiaoqiang Lu.

</span>
<span class="ltx_bibblock">Remote sensing image scene classification: Benchmark and state of the
art.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, 105(10):1865–1883, 2017.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cimpoi et al. (2014)</span>
<span class="ltx_bibblock">
Mircea Cimpoi, Subhransu Maji, Iasonas Kokkinos, Sammy Mohamed, and Andrea
Vedaldi.

</span>
<span class="ltx_bibblock">Describing textures in the wild.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pp.  3606–3613, 2014.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collins et al. (2021)</span>
<span class="ltx_bibblock">
Liam Collins, Hamed Hassani, Aryan Mokhtari, and Sanjay Shakkottai.

</span>
<span class="ltx_bibblock">Exploiting shared representations for personalized federated
learning.

</span>
<span class="ltx_bibblock">In Marina Meila and Tong Zhang (eds.), <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th
International Conference on Machine Learning</em>, volume 139 of
<em id="bib.bib9.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pp.  2089–2099. PMLR,
18–24 Jul 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v139/collins21a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v139/collins21a.html</a>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2009)</span>
<span class="ltx_bibblock">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">ImageNet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2009.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2020)</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, et al.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at
scale.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.11929</em>, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duda et al. (2012)</span>
<span class="ltx_bibblock">
Richard O Duda, Peter E Hart, and David G Stork.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Pattern classification</em>.

</span>
<span class="ltx_bibblock">John Wiley &amp; Sons, 2012.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dumoulin et al. (2021)</span>
<span class="ltx_bibblock">
Vincent Dumoulin, Neil Houlsby, Utku Evci, Xiaohua Zhai, Ross Goroshin, Sylvain
Gelly, and Hugo Larochelle.

</span>
<span class="ltx_bibblock">Comparing transfer and meta learning approaches on a unified few-shot
classification benchmark.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2104.02638</em>, 2021.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fei-Fei et al. (2006)</span>
<span class="ltx_bibblock">
Li Fei-Fei, Rob Fergus, and Pietro Perona.

</span>
<span class="ltx_bibblock">One-shot learning of object categories.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on pattern analysis and machine
intelligence</em>, 28(4):594–611, 2006.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fisher (1936)</span>
<span class="ltx_bibblock">
Ronald A Fisher.

</span>
<span class="ltx_bibblock">The use of multiple measurements in taxonomic problems.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Annals of eugenics</em>, 7(2):179–188, 1936.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geiger et al. (2013)</span>
<span class="ltx_bibblock">
Andreas Geiger, Philip Lenz, Christoph Stiller, and Raquel Urtasun.

</span>
<span class="ltx_bibblock">Vision meets robotics: The kitti dataset.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">The International Journal of Robotics Research</em>, 32(11):1231–1237, 2013.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016a)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, pp.  770–778, 2016a.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016b)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Identity mappings in deep residual networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">European conference on computer vision</em>, pp.  630–645.
Springer, 2016b.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Helber et al. (2019)</span>
<span class="ltx_bibblock">
Patrick Helber, Benjamin Bischke, Andreas Dengel, and Damian Borth.

</span>
<span class="ltx_bibblock">Eurosat: A novel dataset and deep learning benchmark for land use and
land cover classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IEEE Journal of Selected Topics in Applied Earth Observations
and Remote Sensing</em>, 12(7):2217–2226, 2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hospedales et al. (2020)</span>
<span class="ltx_bibblock">
Timothy Hospedales, Antreas Antoniou, Paul Micaelli, and Amos Storkey.

</span>
<span class="ltx_bibblock">Meta-learning in neural networks: A survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2004.05439</em>, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Houlsby et al. (2019)</span>
<span class="ltx_bibblock">
Neil Houlsby, Andrei Giurgiu, Stanislaw Jastrzebski, Bruna Morrone, Quentin
De Laroussilhe, Andrea Gesmundo, Mona Attariyan, and Sylvain Gelly.

</span>
<span class="ltx_bibblock">Parameter-efficient transfer learning for nlp.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 2790–2799. PMLR, 2019.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2021)</span>
<span class="ltx_bibblock">
Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean
Wang, Lu Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.09685</em>, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jia et al. (2022)</span>
<span class="ltx_bibblock">
Menglin Jia, Luming Tang, Bor-Chun Chen, Claire Cardie, Serge Belongie, Bharath
Hariharan, and Ser-Nam Lim.

</span>
<span class="ltx_bibblock">Visual prompt tuning.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.12119</em>, 2022.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jie &amp; Deng (2022)</span>
<span class="ltx_bibblock">
Shibo Jie and Zhi-Hong Deng.

</span>
<span class="ltx_bibblock">Convolutional bypasses are better vision transformer adapters.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2207.07039</em>, 2022.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al. (2017)</span>
<span class="ltx_bibblock">
Justin Johnson, Bharath Hariharan, Laurens Van Der Maaten, Li Fei-Fei,
C Lawrence Zitnick, and Ross Girshick.

</span>
<span class="ltx_bibblock">Clevr: A diagnostic dataset for compositional language and elementary
visual reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pp.  2901–2910, 2017.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jongejan et al. (2016)</span>
<span class="ltx_bibblock">
J. Jongejan, H. Rowley, T. Kawashima, J. Kim, and N. Fox-Gieg.

</span>
<span class="ltx_bibblock">The quick, draw! - a.i. experiment.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://quickdraw.withgoogle.com/data" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://quickdraw.withgoogle.com/data</a>, 2016.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaggle &amp; EyePacs (2015)</span>
<span class="ltx_bibblock">
Kaggle and EyePacs.

</span>
<span class="ltx_bibblock">Kaggle diabetic retinopathy detection.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://www.kaggle.com/c/diabetic-retinopathy-detection/data" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.kaggle.com/c/diabetic-retinopathy-detection/data</a>,
2015.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Ba (2015)</span>
<span class="ltx_bibblock">
Diederik Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 3rd International Conference on Learning Representations (ICLR)</em>, 2015.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kolesnikov et al. (2019)</span>
<span class="ltx_bibblock">
Alexander Kolesnikov, Lucas Beyer, Xiaohua Zhai, Joan Puigcerver, Jessica Yung,
Sylvain Gelly, and Neil Houlsby.

</span>
<span class="ltx_bibblock">Big transfer (bit): General visual representation learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.11370</em>, 6(2):8,
2019.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kolesnikov et al. (2020)</span>
<span class="ltx_bibblock">
Alexander Kolesnikov, Lucas Beyer, Xiaohua Zhai, Joan Puigcerver, Jessica Yung,
Sylvain Gelly, and Neil Houlsby.

</span>
<span class="ltx_bibblock">Official repository for the ”Big Transfer (BiT): General Visual
Representation Learning” paper.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/google-research/big_transfer" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/google-research/big_transfer</a>, 2020.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2009)</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Geoffrey Hinton, et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun et al. (2004)</span>
<span class="ltx_bibblock">
Yann LeCun, Fu Jie Huang, and Leon Bottou.

</span>
<span class="ltx_bibblock">Learning methods for generic object recognition with invariance to
pose and lighting.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2004 IEEE Computer Society Conference on
Computer Vision and Pattern Recognition, 2004. CVPR 2004.</em>, volume 2, pp. II–104. IEEE, 2004.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock">In I. Dhillon, D. Papailiopoulos, and V. Sze (eds.),
<em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, volume 2, pp.  429–450,
2020.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://proceedings.mlsys.org/paper/2020/file/38af86134b65d0f10fe33d30dd76442e-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlsys.org/paper/2020/file/38af86134b65d0f10fe33d30dd76442e-Paper.pdf</a>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. (2020)</span>
<span class="ltx_bibblock">
Paul Pu Liang, Terrance Liu, Ziyin Liu, Ruslan Salakhutdinov, and
Louis-Philippe Morency.

</span>
<span class="ltx_bibblock">Think locally, act globally: Federated learning with local and global
representations.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2001.01523, 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2001.01523" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2001.01523</a>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Massiceti et al. (2021)</span>
<span class="ltx_bibblock">
Daniela Massiceti, Luisa Zintgraf, John Bronskill, Lida Theodorou,
Matthew Tobias Harris, Edward Cutrell, Cecily Morrison, Katja Hofmann, and
Simone Stumpf.

</span>
<span class="ltx_bibblock">ORBIT: A Real-World Few-Shot Dataset for Teachable Object
Recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV)</em>, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Matthey et al. (2017)</span>
<span class="ltx_bibblock">
Loic Matthey, Irina Higgins, Demis Hassabis, and Alexander Lerchner.

</span>
<span class="ltx_bibblock">dsprites: Disentanglement testing sprites dataset, 2017.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2016)</span>
<span class="ltx_bibblock">
H. Brendan McMahan, Eider Moore, Daniel Ramage, and Blaise Agüera
y Arcas.

</span>
<span class="ltx_bibblock">Federated learning of deep networks using model averaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1602.05629, 2016.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1602.05629" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1602.05629</a>.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mudrakarta et al. (2019)</span>
<span class="ltx_bibblock">
Pramod Kaushik Mudrakarta, Mark Sandler, Andrey Zhmoginov, and Andrew Howard.

</span>
<span class="ltx_bibblock">K for the price of 1: Parameter efficient multi-task and transfer
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=BJxvEh0cFQ" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=BJxvEh0cFQ</a>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Netzer et al. (2011)</span>
<span class="ltx_bibblock">
Yuval Netzer, Tao Wang, Adam Coates, Alessandro Bissacco, Bo Wu, and Andrew Y
Ng.

</span>
<span class="ltx_bibblock">Reading digits in natural images with unsupervised feature learning.

</span>
<span class="ltx_bibblock">2011.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nilsback &amp; Zisserman (2008)</span>
<span class="ltx_bibblock">
Maria-Elena Nilsback and Andrew Zisserman.

</span>
<span class="ltx_bibblock">Automated flower classification over a large number of classes.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">2008 Sixth Indian Conference on Computer Vision, Graphics &amp;
Image Processing</em>, pp.  722–729. IEEE, 2008.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oreshkin et al. (2018)</span>
<span class="ltx_bibblock">
Boris Oreshkin, Pau Rodríguez López, and Alexandre Lacoste.

</span>
<span class="ltx_bibblock">Tadam: Task dependent adaptive metric for improved few-shot learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 31, 2018.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Parkhi et al. (2012)</span>
<span class="ltx_bibblock">
Omkar M Parkhi, Andrea Vedaldi, Andrew Zisserman, and CV Jawahar.

</span>
<span class="ltx_bibblock">Cats and dogs.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">2012 IEEE conference on computer vision and pattern
recognition</em>, pp.  3498–3505. IEEE, 2012.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Patacchiola et al. (2022)</span>
<span class="ltx_bibblock">
Massimiliano Patacchiola, John Bronskill, Aliaksandra Shysheya, Katja Hofmann,
Sebastian Nowozin, and Richard E Turner.

</span>
<span class="ltx_bibblock">Contextual squeeze-and-excitation for efficient few-shot image
classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.09843</em>, 2022.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Perez et al. (2018)</span>
<span class="ltx_bibblock">
Ethan Perez, Florian Strub, Harm De Vries, Vincent Dumoulin, and Aaron
Courville.

</span>
<span class="ltx_bibblock">FiLM: Visual reasoning with a general conditioning layer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 32nd AAAI Conference on Artificial Intelligence (AAAI)</em>, 2018.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pillutla et al. (2022)</span>
<span class="ltx_bibblock">
Krishna Pillutla, Kshitiz Malik, Abdel-Rahman Mohamed, Mike Rabbat, Maziar
Sanjabi, and Lin Xiao.

</span>
<span class="ltx_bibblock">Federated learning with partial model personalization.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri, Stefanie Jegelka, Le Song, Csaba Szepesvari,
Gang Niu, and Sivan Sabato (eds.), <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 39th
International Conference on Machine Learning</em>, volume 162 of
<em id="bib.bib46.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pp.  17716–17758. PMLR,
17–23 Jul 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v162/pillutla22a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v162/pillutla22a.html</a>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rebuffi et al. (2017)</span>
<span class="ltx_bibblock">
Sylvestre-Alvise Rebuffi, Hakan Bilen, and Andrea Vedaldi.

</span>
<span class="ltx_bibblock">Learning multiple visual domains with residual adapters.

</span>
<span class="ltx_bibblock">In <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, pp. 506–516, 2017.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rebuffi et al. (2018)</span>
<span class="ltx_bibblock">
Sylvestre-Alvise Rebuffi, Hakan Bilen, and Andrea Vedaldi.

</span>
<span class="ltx_bibblock">Efficient parametrization of multi-domain deep neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</em>, pp.  8119–8127, 2018.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2021)</span>
<span class="ltx_bibblock">
Sashank J. Reddi, Zachary Charles, Manzil Zaheer, Zachary Garrett, Keith Rush,
Jakub Konečný, Sanjiv Kumar, and Hugh Brendan McMahan.

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=LkFG3lB13U5" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=LkFG3lB13U5</a>.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Requeima et al. (2019)</span>
<span class="ltx_bibblock">
James Requeima, Jonathan Gordon, John Bronskill, Sebastian Nowozin, and
Richard E Turner.

</span>
<span class="ltx_bibblock">Fast and flexible multi-task classification using conditional neural
adaptive processes.

</span>
<span class="ltx_bibblock">In <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 33rd Annual Conference on Neural Information Processing Systems (NeurIPS)</em>, pp.  7957–7968, 2019.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Russakovsky et al. (2015)</span>
<span class="ltx_bibblock">
Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause, Sanjeev Satheesh, Sean Ma,
Zhiheng Huang, Andrej Karpathy, Aditya Khosla, Michael Bernstein,
Alexander C. Berg, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">ImageNet Large Scale Visual Recognition Challenge.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision (IJCV)</em>, 115(3):211–252, 2015.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1007/s11263-015-0816-y</span>.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schroff et al. (2015)</span>
<span class="ltx_bibblock">
Florian Schroff, Dmitry Kalenichenko, and James Philbin.

</span>
<span class="ltx_bibblock">Facenet: A unified embedding for face recognition and clustering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pp.  815–823, 2015.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shamsian et al. (2021)</span>
<span class="ltx_bibblock">
Aviv Shamsian, Aviv Navon, Ethan Fetaya, and Gal Chechik.

</span>
<span class="ltx_bibblock">Personalized federated learning using hypernetworks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2021.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Snell et al. (2017)</span>
<span class="ltx_bibblock">
Jake Snell, Kevin Swersky, and Richard Zemel.

</span>
<span class="ltx_bibblock">Prototypical networks for few-shot learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 31st Annual Conference on Neural Information Processing Systems (NeurIPS)</em>, pp.  4077–4087, 2017.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan &amp; Le (2021)</span>
<span class="ltx_bibblock">
Mingxing Tan and Quoc Le.

</span>
<span class="ltx_bibblock">Efficientnetv2: Smaller models and faster training.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 10096–10106. PMLR, 2021.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al. (2020)</span>
<span class="ltx_bibblock">
Yonglong Tian, Yue Wang, Dilip Krishnan, Joshua B. Tenenbaum, and Phillip
Isola.

</span>
<span class="ltx_bibblock">Rethinking few-shot image classification: a good embedding is all you
need?

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.11539</em>, 2020.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Triantafillou et al. (2021)</span>
<span class="ltx_bibblock">
Eleni Triantafillou, Hugo Larochelle, Richard Zemel, and Vincent Dumoulin.

</span>
<span class="ltx_bibblock">Learning a universal template for few-shot dataset generalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 10424–10433. PMLR, 2021.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Veeling et al. (2018)</span>
<span class="ltx_bibblock">
Bastiaan S Veeling, Jasper Linmans, Jim Winkens, Taco Cohen, and Max Welling.

</span>
<span class="ltx_bibblock">Rotation equivariant cnns for digital pathology.

</span>
<span class="ltx_bibblock">In <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">International Conference on Medical image computing and
computer-assisted intervention</em>, pp.  210–218. Springer, 2018.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vinyals et al. (2016)</span>
<span class="ltx_bibblock">
Oriol Vinyals, Charles Blundell, Timothy Lillicrap, Koray Kavukcuoglu, and Daan
Wierstra.

</span>
<span class="ltx_bibblock">Matching networks for one shot learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 30th Annual Conference on Neural Information Processing Systems (NeurIPS)</em>, pp.  3630–3638, 2016.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2016)</span>
<span class="ltx_bibblock">
Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V Le, Mohammad Norouzi, Wolfgang
Macherey, Maxim Krikun, Yuan Cao, Qin Gao, Klaus Macherey, et al.

</span>
<span class="ltx_bibblock">Google’s neural machine translation system: Bridging the gap between
human and machine translation.

</span>
<span class="ltx_bibblock"><em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1609.08144</em>, 2016.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2010)</span>
<span class="ltx_bibblock">
Jianxiong Xiao, James Hays, Krista A Ehinger, Aude Oliva, and Antonio Torralba.

</span>
<span class="ltx_bibblock">Sun database: Large-scale scene recognition from abbey to zoo.

</span>
<span class="ltx_bibblock">In <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">2010 IEEE computer society conference on computer vision and
pattern recognition</em>, pp.  3485–3492. IEEE, 2010.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et al. (2018)</span>
<span class="ltx_bibblock">
Wayne Xiong, Lingfeng Wu, Fil Alleva, Jasha Droppo, Xuedong Huang, and Andreas
Stolcke.

</span>
<span class="ltx_bibblock">The microsoft 2017 conversational speech recognition system.

</span>
<span class="ltx_bibblock">In <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">2018 IEEE international conference on acoustics, speech and
signal processing (ICASSP)</em>, pp.  5934–5938. IEEE, 2018.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yosinski et al. (2014)</span>
<span class="ltx_bibblock">
Jason Yosinski, Jeff Clune, Yoshua Bengio, and Hod Lipson.

</span>
<span class="ltx_bibblock">How transferable are features in deep neural networks?

</span>
<span class="ltx_bibblock">In <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 28th Annual Conference on Neural Information Processing Systems (NeurIPS)</em>, pp.  3320–3328, 2014.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhai et al. (2019)</span>
<span class="ltx_bibblock">
Xiaohua Zhai, Joan Puigcerver, Alexander Kolesnikov, Pierre Ruyssen, Carlos
Riquelme, Mario Lucic, Josip Djolonga, Andre Susano Pinto, Maxim Neumann,
Alexey Dosovitskiy, et al.

</span>
<span class="ltx_bibblock">A large-scale study of representation learning with the visual task
adaptation benchmark.

</span>
<span class="ltx_bibblock"><em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.04867</em>, 2019.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Yuanhan Zhang, Kaiyang Zhou, and Ziwei Liu.

</span>
<span class="ltx_bibblock">Neural prompt search.

</span>
<span class="ltx_bibblock"><em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.04673</em>, 2022.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>FiLM Layer Placement</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.1" class="ltx_p"><a href="#A1.F1.sf1" title="In Figure A.1 ‣ A.1 FiLM Layer Placement ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1(a)</span></a> illustrates a FiLM layer operating on a convolutional layer, and <a href="#A1.F1.sf2" title="In Figure A.1 ‣ A.1 FiLM Layer Placement ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1(b)</span></a> illustrates how a FiLM layer can be added to a ResNetV2 network block.
FiLM layers can be similarly added to EfficientNet based backbones, amongst others.</p>
</div>
<figure id="A1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.08671/assets/x6.png" id="A1.F1.sf1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="422" height="397" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>A FiLM layer.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.08671/assets/x7.png" id="A1.F1.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="68" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>A ResNet basic block with FiLM layers.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure A.1: </span>(Left) A FiLM layer operating on convolutional feature maps in layer <math id="A1.F1.5.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.F1.5.m1.1b"><mi id="A1.F1.5.m1.1.1" xref="A1.F1.5.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.F1.5.m1.1c"><ci id="A1.F1.5.m1.1.1.cmml" xref="A1.F1.5.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F1.5.m1.1d">i</annotation></semantics></math> and channel <math id="A1.F1.6.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="A1.F1.6.m2.1b"><mi id="A1.F1.6.m2.1.1" xref="A1.F1.6.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.F1.6.m2.1c"><ci id="A1.F1.6.m2.1.1.cmml" xref="A1.F1.6.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F1.6.m2.1d">j</annotation></semantics></math>. (Right) How a FiLM layer is placed within a basic Residual network block <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a href="#bib.bib17" title="" class="ltx_ref">2016a</a>)</cite>. GN is a Group Normalization layer, ReLU is a Rectified Linear Unit, and 1 <math id="A1.F1.7.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.F1.7.m3.1b"><mo id="A1.F1.7.m3.1.1" xref="A1.F1.7.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.F1.7.m3.1c"><times id="A1.F1.7.m3.1.1.cmml" xref="A1.F1.7.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.F1.7.m3.1d">\times</annotation></semantics></math> 1, and <math id="A1.F1.8.m4.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="A1.F1.8.m4.1b"><mrow id="A1.F1.8.m4.1.1" xref="A1.F1.8.m4.1.1.cmml"><mn id="A1.F1.8.m4.1.1.2" xref="A1.F1.8.m4.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A1.F1.8.m4.1.1.1" xref="A1.F1.8.m4.1.1.1.cmml">×</mo><mn id="A1.F1.8.m4.1.1.3" xref="A1.F1.8.m4.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F1.8.m4.1c"><apply id="A1.F1.8.m4.1.1.cmml" xref="A1.F1.8.m4.1.1"><times id="A1.F1.8.m4.1.1.1.cmml" xref="A1.F1.8.m4.1.1.1"></times><cn type="integer" id="A1.F1.8.m4.1.1.2.cmml" xref="A1.F1.8.m4.1.1.2">3</cn><cn type="integer" id="A1.F1.8.m4.1.1.3.cmml" xref="A1.F1.8.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F1.8.m4.1d">3\times 3</annotation></semantics></math> are 2D convolutional layers with the stated kernel size.</figcaption>
</figure>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Model Parameters</h3>

<div id="A1.SS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS2.p1.1" class="ltx_p">In this section, we provide details on the updateable parameter calculations for the LDA and QDA variants of BiT. Refer to <a href="#S2.T1" title="In 2 FiLM Transfer (FiT) ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="A1.SS2.p2" class="ltx_para ltx_noindent">
<p id="A1.SS2.p2.3" class="ltx_p">For <span id="A1.SS2.p2.3.1" class="ltx_text ltx_font_smallcaps">FiT</span>-QDA and <span id="A1.SS2.p2.3.2" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA, the means and covariances contribute to the updateable parameter count.
We use a mean for every class which contributes <math id="A1.SS2.p2.1.m1.1" class="ltx_Math" alttext="Cd_{b}" display="inline"><semantics id="A1.SS2.p2.1.m1.1a"><mrow id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml"><mi id="A1.SS2.p2.1.m1.1.1.2" xref="A1.SS2.p2.1.m1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p2.1.m1.1.1.1" xref="A1.SS2.p2.1.m1.1.1.1.cmml">​</mo><msub id="A1.SS2.p2.1.m1.1.1.3" xref="A1.SS2.p2.1.m1.1.1.3.cmml"><mi id="A1.SS2.p2.1.m1.1.1.3.2" xref="A1.SS2.p2.1.m1.1.1.3.2.cmml">d</mi><mi id="A1.SS2.p2.1.m1.1.1.3.3" xref="A1.SS2.p2.1.m1.1.1.3.3.cmml">b</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><apply id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1"><times id="A1.SS2.p2.1.m1.1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1.1"></times><ci id="A1.SS2.p2.1.m1.1.1.2.cmml" xref="A1.SS2.p2.1.m1.1.1.2">𝐶</ci><apply id="A1.SS2.p2.1.m1.1.1.3.cmml" xref="A1.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.1.1.3.1.cmml" xref="A1.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="A1.SS2.p2.1.m1.1.1.3.2.cmml" xref="A1.SS2.p2.1.m1.1.1.3.2">𝑑</ci><ci id="A1.SS2.p2.1.m1.1.1.3.3.cmml" xref="A1.SS2.p2.1.m1.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">Cd_{b}</annotation></semantics></math> updateable parameters.
A covariance matrix has <math id="A1.SS2.p2.2.m2.1" class="ltx_Math" alttext="d_{b}\times d_{b}" display="inline"><semantics id="A1.SS2.p2.2.m2.1a"><mrow id="A1.SS2.p2.2.m2.1.1" xref="A1.SS2.p2.2.m2.1.1.cmml"><msub id="A1.SS2.p2.2.m2.1.1.2" xref="A1.SS2.p2.2.m2.1.1.2.cmml"><mi id="A1.SS2.p2.2.m2.1.1.2.2" xref="A1.SS2.p2.2.m2.1.1.2.2.cmml">d</mi><mi id="A1.SS2.p2.2.m2.1.1.2.3" xref="A1.SS2.p2.2.m2.1.1.2.3.cmml">b</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.SS2.p2.2.m2.1.1.1" xref="A1.SS2.p2.2.m2.1.1.1.cmml">×</mo><msub id="A1.SS2.p2.2.m2.1.1.3" xref="A1.SS2.p2.2.m2.1.1.3.cmml"><mi id="A1.SS2.p2.2.m2.1.1.3.2" xref="A1.SS2.p2.2.m2.1.1.3.2.cmml">d</mi><mi id="A1.SS2.p2.2.m2.1.1.3.3" xref="A1.SS2.p2.2.m2.1.1.3.3.cmml">b</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.1b"><apply id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1"><times id="A1.SS2.p2.2.m2.1.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1.1"></times><apply id="A1.SS2.p2.2.m2.1.1.2.cmml" xref="A1.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m2.1.1.2.1.cmml" xref="A1.SS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="A1.SS2.p2.2.m2.1.1.2.2.cmml" xref="A1.SS2.p2.2.m2.1.1.2.2">𝑑</ci><ci id="A1.SS2.p2.2.m2.1.1.2.3.cmml" xref="A1.SS2.p2.2.m2.1.1.2.3">𝑏</ci></apply><apply id="A1.SS2.p2.2.m2.1.1.3.cmml" xref="A1.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m2.1.1.3.1.cmml" xref="A1.SS2.p2.2.m2.1.1.3">subscript</csymbol><ci id="A1.SS2.p2.2.m2.1.1.3.2.cmml" xref="A1.SS2.p2.2.m2.1.1.3.2">𝑑</ci><ci id="A1.SS2.p2.2.m2.1.1.3.3.cmml" xref="A1.SS2.p2.2.m2.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.1c">d_{b}\times d_{b}</annotation></semantics></math> values, however it can be represented in Cholesky factorized form which results in a lower triangular matrix and thus can be represented with <math id="A1.SS2.p2.3.m3.1" class="ltx_Math" alttext="d_{b}(d_{b}+1)/2" display="inline"><semantics id="A1.SS2.p2.3.m3.1a"><mrow id="A1.SS2.p2.3.m3.1.1" xref="A1.SS2.p2.3.m3.1.1.cmml"><mrow id="A1.SS2.p2.3.m3.1.1.1" xref="A1.SS2.p2.3.m3.1.1.1.cmml"><msub id="A1.SS2.p2.3.m3.1.1.1.3" xref="A1.SS2.p2.3.m3.1.1.1.3.cmml"><mi id="A1.SS2.p2.3.m3.1.1.1.3.2" xref="A1.SS2.p2.3.m3.1.1.1.3.2.cmml">d</mi><mi id="A1.SS2.p2.3.m3.1.1.1.3.3" xref="A1.SS2.p2.3.m3.1.1.1.3.3.cmml">b</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS2.p2.3.m3.1.1.1.2" xref="A1.SS2.p2.3.m3.1.1.1.2.cmml">​</mo><mrow id="A1.SS2.p2.3.m3.1.1.1.1.1" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS2.p2.3.m3.1.1.1.1.1.2" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.p2.3.m3.1.1.1.1.1.1" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.cmml"><msub id="A1.SS2.p2.3.m3.1.1.1.1.1.1.2" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.2.cmml"><mi id="A1.SS2.p2.3.m3.1.1.1.1.1.1.2.2" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.2.2.cmml">d</mi><mi id="A1.SS2.p2.3.m3.1.1.1.1.1.1.2.3" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.2.3.cmml">b</mi></msub><mo id="A1.SS2.p2.3.m3.1.1.1.1.1.1.1" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.cmml">+</mo><mn id="A1.SS2.p2.3.m3.1.1.1.1.1.1.3" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A1.SS2.p2.3.m3.1.1.1.1.1.3" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p2.3.m3.1.1.2" xref="A1.SS2.p2.3.m3.1.1.2.cmml">/</mo><mn id="A1.SS2.p2.3.m3.1.1.3" xref="A1.SS2.p2.3.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m3.1b"><apply id="A1.SS2.p2.3.m3.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1"><divide id="A1.SS2.p2.3.m3.1.1.2.cmml" xref="A1.SS2.p2.3.m3.1.1.2"></divide><apply id="A1.SS2.p2.3.m3.1.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1.1"><times id="A1.SS2.p2.3.m3.1.1.1.2.cmml" xref="A1.SS2.p2.3.m3.1.1.1.2"></times><apply id="A1.SS2.p2.3.m3.1.1.1.3.cmml" xref="A1.SS2.p2.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p2.3.m3.1.1.1.3.1.cmml" xref="A1.SS2.p2.3.m3.1.1.1.3">subscript</csymbol><ci id="A1.SS2.p2.3.m3.1.1.1.3.2.cmml" xref="A1.SS2.p2.3.m3.1.1.1.3.2">𝑑</ci><ci id="A1.SS2.p2.3.m3.1.1.1.3.3.cmml" xref="A1.SS2.p2.3.m3.1.1.1.3.3">𝑏</ci></apply><apply id="A1.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.1"><plus id="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.1"></plus><apply id="A1.SS2.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p2.3.m3.1.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.SS2.p2.3.m3.1.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.2.2">𝑑</ci><ci id="A1.SS2.p2.3.m3.1.1.1.1.1.1.2.3.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.2.3">𝑏</ci></apply><cn type="integer" id="A1.SS2.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.3">1</cn></apply></apply><cn type="integer" id="A1.SS2.p2.3.m3.1.1.3.cmml" xref="A1.SS2.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m3.1c">d_{b}(d_{b}+1)/2</annotation></semantics></math> values, with the rest being zeros.</p>
</div>
<div id="A1.SS2.p3" class="ltx_para ltx_noindent">
<p id="A1.SS2.p3.1" class="ltx_p">In the case of <span id="A1.SS2.p3.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA, where the covariance matrix is shared across all classes, a more compact representation is possible, resulting in considerable savings in updateable parameters:</p>
</div>
<div id="A1.SS2.p4" class="ltx_para ltx_noindent">
<table id="A1.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E1.m1.31" class="ltx_math_unparsed" alttext="\begin{split}&amp;p(y^{*}=c|b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*}),{\bm{\pi}},{\bm{\mu}},\Sigma_{LDA})=\dfrac{\pi_{c}\mathcal{N}(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})|\mu_{c},\Sigma_{LDA}))}{\sum_{c^{\prime}}^{C}\pi_{c^{\prime}}\mathcal{N}(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})|\mu_{c^{\prime}},\Sigma_{LDA})}\\
&amp;=\dfrac{\pi_{c}\det\left(2\pi\Sigma_{LDA}\right)^{-\frac{1}{2}}\exp\left(-\frac{1}{2}\left(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\mu_{c}\right)^{T}\Sigma_{LDA}^{-1}\left(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\mu_{c}\right)\right)}{\sum_{c^{\prime}}^{C}\pi_{c^{\prime}}\det\left(2\pi\Sigma_{LDA}\right)^{-\frac{1}{2}}\exp\left(-\frac{1}{2}\left(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\mu_{c^{\prime}}\right)^{T}\Sigma_{LDA}^{-1}\left(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\mu_{c^{\prime}}\right)\right)}\\
&amp;=\dfrac{\pi_{c}\exp\left(-\frac{1}{2}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})^{T}\Sigma_{LDA}^{-1}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})+\mu_{c}^{T}\Sigma_{LDA}^{-1}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\frac{1}{2}\mu_{c}^{T}\Sigma_{LDA}^{-1}\mu_{c}\right)}{\sum_{c^{\prime}}^{C}\pi_{c^{\prime}}\exp\left(-\frac{1}{2}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})^{T}\Sigma_{LDA}^{-1}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})+\mu_{c^{\prime}}^{T}\Sigma_{LDA}^{-1}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\frac{1}{2}\mu_{c^{\prime}}^{T}\Sigma_{LDA}^{-1}\mu_{c^{\prime}}\right)}\\
&amp;=\dfrac{\pi_{c}\exp\left(\mu_{c}^{T}\Sigma_{LDA}^{-1}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\frac{1}{2}\mu_{c}^{T}\Sigma_{LDA}^{-1}\mu_{c}\right)}{\sum_{c^{\prime}}^{C}\pi_{c^{\prime}}\exp\left(\mu_{c^{\prime}}^{T}\Sigma_{LDA}^{-1}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\frac{1}{2}\mu_{c^{\prime}}^{T}\Sigma_{LDA}^{-1}\mu_{c^{\prime}}\right)}\end{split}" display="block"><semantics id="A1.E1.m1.31a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="A1.E1.m1.31.31.2"><mtr id="A1.E1.m1.31.31.2a"><mtd id="A1.E1.m1.31.31.2b"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E1.m1.31.31.2c"><mrow id="A1.E1.m1.31.31.2.30.24.24"><mrow id="A1.E1.m1.31.31.2.30.24.24.24"><mi id="A1.E1.m1.1.1.1.1.1.1">p</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.31.31.2.30.24.24.24.2">​</mo><mrow id="A1.E1.m1.31.31.2.30.24.24.24.1.1"><mo stretchy="false" id="A1.E1.m1.2.2.2.2.2.2">(</mo><mrow id="A1.E1.m1.31.31.2.30.24.24.24.1.1.1"><msup id="A1.E1.m1.31.31.2.30.24.24.24.1.1.1.3"><mi id="A1.E1.m1.3.3.3.3.3.3">y</mi><mo id="A1.E1.m1.4.4.4.4.4.4.1">∗</mo></msup><mo id="A1.E1.m1.5.5.5.5.5.5">=</mo><mrow id="A1.E1.m1.31.31.2.30.24.24.24.1.1.1.2"><mi id="A1.E1.m1.6.6.6.6.6.6">c</mi><mo fence="false" id="A1.E1.m1.7.7.7.7.7.7">|</mo><mrow id="A1.E1.m1.31.31.2.30.24.24.24.1.1.1.2.2.2"><mrow id="A1.E1.m1.31.31.2.30.24.24.24.1.1.1.1.1.1.1"><msub id="A1.E1.m1.31.31.2.30.24.24.24.1.1.1.1.1.1.1.3"><mi id="A1.E1.m1.8.8.8.8.8.8">b</mi><mrow id="A1.E1.m1.9.9.9.9.9.9.1.4"><mi id="A1.E1.m1.9.9.9.9.9.9.1.1">𝜽</mi><mo id="A1.E1.m1.9.9.9.9.9.9.1.4.1">,</mo><mi id="A1.E1.m1.9.9.9.9.9.9.1.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.31.31.2.30.24.24.24.1.1.1.1.1.1.1.2">​</mo><mrow id="A1.E1.m1.31.31.2.30.24.24.24.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="A1.E1.m1.10.10.10.10.10.10">(</mo><msup id="A1.E1.m1.31.31.2.30.24.24.24.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E1.m1.11.11.11.11.11.11">𝒙</mi><mo id="A1.E1.m1.12.12.12.12.12.12.1">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.13.13.13.13.13.13">)</mo></mrow></mrow><mo id="A1.E1.m1.14.14.14.14.14.14">,</mo><mi id="A1.E1.m1.15.15.15.15.15.15">𝝅</mi><mo id="A1.E1.m1.16.16.16.16.16.16">,</mo><mi id="A1.E1.m1.17.17.17.17.17.17">𝝁</mi><mo id="A1.E1.m1.18.18.18.18.18.18">,</mo><msub id="A1.E1.m1.31.31.2.30.24.24.24.1.1.1.2.2.2.2"><mi mathvariant="normal" id="A1.E1.m1.19.19.19.19.19.19">Σ</mi><mrow id="A1.E1.m1.20.20.20.20.20.20.1"><mi id="A1.E1.m1.20.20.20.20.20.20.1.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.20.20.20.20.20.20.1.1">​</mo><mi id="A1.E1.m1.20.20.20.20.20.20.1.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.20.20.20.20.20.20.1.1a">​</mo><mi id="A1.E1.m1.20.20.20.20.20.20.1.4">A</mi></mrow></msub></mrow></mrow></mrow><mo stretchy="false" id="A1.E1.m1.21.21.21.21.21.21">)</mo></mrow></mrow><mo id="A1.E1.m1.22.22.22.22.22.22">=</mo><mfrac id="A1.E1.m1.23.23.23.23.23.23"><mrow id="A1.E1.m1.23.23.23.23.23.23.2"><msub id="A1.E1.m1.23.23.23.23.23.23.2.3"><mi id="A1.E1.m1.23.23.23.23.23.23.2.3.2">π</mi><mi id="A1.E1.m1.23.23.23.23.23.23.2.3.3">c</mi></msub><mi class="ltx_font_mathcaligraphic" id="A1.E1.m1.23.23.23.23.23.23.2.4">𝒩</mi><mrow id="A1.E1.m1.23.23.23.23.23.23.2.5"><mo stretchy="false" id="A1.E1.m1.23.23.23.23.23.23.2.5.1">(</mo><msub id="A1.E1.m1.23.23.23.23.23.23.2.5.2"><mi id="A1.E1.m1.23.23.23.23.23.23.2.5.2.2">b</mi><mrow id="A1.E1.m1.23.23.23.23.23.23.2.2.2.4"><mi id="A1.E1.m1.23.23.23.23.23.23.1.1.1.1">𝜽</mi><mo id="A1.E1.m1.23.23.23.23.23.23.2.2.2.4.1">,</mo><mi id="A1.E1.m1.23.23.23.23.23.23.2.2.2.2">𝝍</mi></mrow></msub><mrow id="A1.E1.m1.23.23.23.23.23.23.2.5.3"><mo stretchy="false" id="A1.E1.m1.23.23.23.23.23.23.2.5.3.1">(</mo><msup id="A1.E1.m1.23.23.23.23.23.23.2.5.3.2"><mi id="A1.E1.m1.23.23.23.23.23.23.2.5.3.2.2">𝒙</mi><mo id="A1.E1.m1.23.23.23.23.23.23.2.5.3.2.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.23.23.23.23.23.23.2.5.3.3">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="A1.E1.m1.23.23.23.23.23.23.2.5.4">|</mo><msub id="A1.E1.m1.23.23.23.23.23.23.2.5.5"><mi id="A1.E1.m1.23.23.23.23.23.23.2.5.5.2">μ</mi><mi id="A1.E1.m1.23.23.23.23.23.23.2.5.5.3">c</mi></msub><mo id="A1.E1.m1.23.23.23.23.23.23.2.5.6">,</mo><msub id="A1.E1.m1.23.23.23.23.23.23.2.5.7"><mi mathvariant="normal" id="A1.E1.m1.23.23.23.23.23.23.2.5.7.2">Σ</mi><mrow id="A1.E1.m1.23.23.23.23.23.23.2.5.7.3"><mi id="A1.E1.m1.23.23.23.23.23.23.2.5.7.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.23.23.23.23.23.23.2.5.7.3.1">​</mo><mi id="A1.E1.m1.23.23.23.23.23.23.2.5.7.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.23.23.23.23.23.23.2.5.7.3.1a">​</mo><mi id="A1.E1.m1.23.23.23.23.23.23.2.5.7.3.4">A</mi></mrow></msub><mo stretchy="false" id="A1.E1.m1.23.23.23.23.23.23.2.5.8">)</mo></mrow><mo stretchy="false" id="A1.E1.m1.23.23.23.23.23.23.2.6">)</mo></mrow><mrow id="A1.E1.m1.23.23.23.23.23.23.5"><msubsup id="A1.E1.m1.23.23.23.23.23.23.5.4"><mo id="A1.E1.m1.23.23.23.23.23.23.5.4.2.2">∑</mo><msup id="A1.E1.m1.23.23.23.23.23.23.5.4.2.3"><mi id="A1.E1.m1.23.23.23.23.23.23.5.4.2.3.2">c</mi><mo id="A1.E1.m1.23.23.23.23.23.23.5.4.2.3.3">′</mo></msup><mi id="A1.E1.m1.23.23.23.23.23.23.5.4.3">C</mi></msubsup><mrow id="A1.E1.m1.23.23.23.23.23.23.5.3"><msub id="A1.E1.m1.23.23.23.23.23.23.5.3.3"><mi id="A1.E1.m1.23.23.23.23.23.23.5.3.3.2">π</mi><msup id="A1.E1.m1.23.23.23.23.23.23.5.3.3.3"><mi id="A1.E1.m1.23.23.23.23.23.23.5.3.3.3.2">c</mi><mo id="A1.E1.m1.23.23.23.23.23.23.5.3.3.3.3">′</mo></msup></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.23.23.23.23.23.23.5.3.2">​</mo><mi class="ltx_font_mathcaligraphic" id="A1.E1.m1.23.23.23.23.23.23.5.3.4">𝒩</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.23.23.23.23.23.23.5.3.2a">​</mo><mrow id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1"><mo stretchy="false" id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.2">(</mo><mrow id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1"><mrow id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.1"><msub id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.1.3"><mi id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.1.3.2">b</mi><mrow id="A1.E1.m1.23.23.23.23.23.23.4.2.2.4"><mi id="A1.E1.m1.23.23.23.23.23.23.3.1.1.1">𝜽</mi><mo id="A1.E1.m1.23.23.23.23.23.23.4.2.2.4.1">,</mo><mi id="A1.E1.m1.23.23.23.23.23.23.4.2.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.1.2">​</mo><mrow id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.1.1.1"><mo stretchy="false" id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.1.1.1.2">(</mo><msup id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.1.1.1.1"><mi id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.1.1.1.1.2">𝒙</mi><mo id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.1.1.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo fence="false" id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.4">|</mo><mrow id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.3.2"><msub id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.2.1.1"><mi id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.2.1.1.2">μ</mi><msup id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.2.1.1.3"><mi id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.2.1.1.3.2">c</mi><mo id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.2.1.1.3.3">′</mo></msup></msub><mo id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.3.2.3">,</mo><msub id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.3.2.2"><mi mathvariant="normal" id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.3.2.2.2">Σ</mi><mrow id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.3.2.2.3"><mi id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.3.2.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.3.2.2.3.1">​</mo><mi id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.3.2.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.3.2.2.3.1a">​</mo><mi id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.1.3.2.2.3.4">A</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="A1.E1.m1.23.23.23.23.23.23.5.3.1.1.3">)</mo></mrow></mrow></mrow></mfrac></mrow></mtd></mtr><mtr id="A1.E1.m1.31.31.2d"><mtd id="A1.E1.m1.31.31.2e"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E1.m1.31.31.2f"><mrow id="A1.E1.m1.25.25.25.2.2"><mi id="A1.E1.m1.25.25.25.2.2.3"></mi><mo id="A1.E1.m1.24.24.24.1.1.1">=</mo><mfrac id="A1.E1.m1.25.25.25.2.2.2"><mrow id="A1.E1.m1.25.25.25.2.2.2.7"><msub id="A1.E1.m1.25.25.25.2.2.2.7.9"><mi id="A1.E1.m1.25.25.25.2.2.2.7.9.2">π</mi><mi id="A1.E1.m1.25.25.25.2.2.2.7.9.3">c</mi></msub><mo lspace="0.167em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.7.8">​</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7"><mo rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.7.7.3">det</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2"><msup id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1"><mrow id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1"><mo id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.2">(</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1"><mn id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1.2">2</mn><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1.1">​</mo><mi id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1.3">π</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1.1a">​</mo><msub id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1.4"><mi mathvariant="normal" id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1.4.2">Σ</mi><mrow id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1.4.3"><mi id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1.4.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1.4.3.1">​</mo><mi id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1.4.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1.4.3.1a">​</mo><mi id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.1.4.3.4">A</mi></mrow></msub></mrow><mo id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.1.1.3">)</mo></mrow><mrow id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.3"><mo id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.3a">−</mo><mfrac id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.3.2"><mn id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.3.2.2">1</mn><mn id="A1.E1.m1.25.25.25.2.2.2.6.6.1.1.3.2.3">2</mn></mfrac></mrow></msup><mo lspace="0.167em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.3">​</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1"><mi id="A1.E1.m1.25.25.25.2.2.2.5.5">exp</mi><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1a">⁡</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1"><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.2">(</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1"><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1a">−</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2"><mfrac id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.4"><mn id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.4.2">1</mn><mn id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.4.3">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.3">​</mo><msup id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1"><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1"><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.2">(</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1"><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.1"><msub id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.1.3"><mi id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.1.3.2">b</mi><mrow id="A1.E1.m1.25.25.25.2.2.2.2.2.2.4"><mi id="A1.E1.m1.25.25.25.2.2.2.1.1.1.1">𝜽</mi><mo id="A1.E1.m1.25.25.25.2.2.2.2.2.2.4.1">,</mo><mi id="A1.E1.m1.25.25.25.2.2.2.2.2.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.1.2">​</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.1.1.1.2">(</mo><msup id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</mi><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.2">−</mo><msub id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.3"><mi id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.3.2">μ</mi><mi id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.1.3.3">c</mi></msub></mrow><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.1.1.3">)</mo></mrow><mi id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.1.1.3">T</mi></msup><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.3a">​</mo><msubsup id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.5"><mi mathvariant="normal" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.5.2.2">Σ</mi><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.5.2.3"><mi id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.5.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.5.2.3.1">​</mo><mi id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.5.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.5.2.3.1a">​</mo><mi id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.5.2.3.4">A</mi></mrow><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.5.3"><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.5.3a">−</mo><mn id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.5.3.2">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.3b">​</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1"><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.2">(</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1"><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.1"><msub id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.1.3"><mi id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.1.3.2">b</mi><mrow id="A1.E1.m1.25.25.25.2.2.2.4.4.2.4"><mi id="A1.E1.m1.25.25.25.2.2.2.3.3.1.1">𝜽</mi><mo id="A1.E1.m1.25.25.25.2.2.2.4.4.2.4.1">,</mo><mi id="A1.E1.m1.25.25.25.2.2.2.4.4.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.1.2">​</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.1.1.1"><mo stretchy="false" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.1.1.1.2">(</mo><msup id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.1.1.1.1"><mi id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.1.1.1.1.2">𝒙</mi><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.1.1.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.1.1.1.3">)</mo></mrow></mrow><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.2">−</mo><msub id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.3"><mi id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.3.2">μ</mi><mi id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.1.3.3">c</mi></msub></mrow><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.1.2.2.1.3">)</mo></mrow></mrow></mrow><mo id="A1.E1.m1.25.25.25.2.2.2.7.7.2.2.1.1.3">)</mo></mrow></mrow></mrow></mrow></mrow><mrow id="A1.E1.m1.25.25.25.2.2.2.14"><msubsup id="A1.E1.m1.25.25.25.2.2.2.14.8"><mo id="A1.E1.m1.25.25.25.2.2.2.14.8.2.2">∑</mo><msup id="A1.E1.m1.25.25.25.2.2.2.14.8.2.3"><mi id="A1.E1.m1.25.25.25.2.2.2.14.8.2.3.2">c</mi><mo id="A1.E1.m1.25.25.25.2.2.2.14.8.2.3.3">′</mo></msup><mi id="A1.E1.m1.25.25.25.2.2.2.14.8.3">C</mi></msubsup><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7"><msub id="A1.E1.m1.25.25.25.2.2.2.14.7.4"><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.4.2">π</mi><msup id="A1.E1.m1.25.25.25.2.2.2.14.7.4.3"><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.4.3.2">c</mi><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.4.3.3">′</mo></msup></msub><mo lspace="0.167em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.14.7.3">​</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2"><mo rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.3">det</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2"><msup id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1"><mrow id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1"><mo id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.2">(</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1"><mn id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1.2">2</mn><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1.1">​</mo><mi id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1.3">π</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1.1a">​</mo><msub id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1.4"><mi mathvariant="normal" id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1.4.2">Σ</mi><mrow id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1.4.3"><mi id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1.4.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1.4.3.1">​</mo><mi id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1.4.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1.4.3.1a">​</mo><mi id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.1.4.3.4">A</mi></mrow></msub></mrow><mo id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.1.1.3">)</mo></mrow><mrow id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.3"><mo id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.3a">−</mo><mfrac id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.3.2"><mn id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.3.2.2">1</mn><mn id="A1.E1.m1.25.25.25.2.2.2.13.6.1.1.1.3.2.3">2</mn></mfrac></mrow></msup><mo lspace="0.167em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.3">​</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1"><mi id="A1.E1.m1.25.25.25.2.2.2.12.5">exp</mi><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1a">⁡</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1"><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.2">(</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1"><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1a">−</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2"><mfrac id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.4"><mn id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.4.2">1</mn><mn id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.4.3">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.3">​</mo><msup id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1"><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1"><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.2">(</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1"><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.1"><msub id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.1.3"><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.1.3.2">b</mi><mrow id="A1.E1.m1.25.25.25.2.2.2.9.2.2.4"><mi id="A1.E1.m1.25.25.25.2.2.2.8.1.1.1">𝜽</mi><mo id="A1.E1.m1.25.25.25.2.2.2.9.2.2.4.1">,</mo><mi id="A1.E1.m1.25.25.25.2.2.2.9.2.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.1.2">​</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2">(</mo><msup id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</mi><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.2">−</mo><msub id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.3"><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.3.2">μ</mi><msup id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.3.3"><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.3.3.2">c</mi><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.1.3.3.3">′</mo></msup></msub></mrow><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.1.1.3">)</mo></mrow><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.1.1.3">T</mi></msup><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.3a">​</mo><msubsup id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.5"><mi mathvariant="normal" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.5.2.2">Σ</mi><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.5.2.3"><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.5.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.5.2.3.1">​</mo><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.5.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.5.2.3.1a">​</mo><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.5.2.3.4">A</mi></mrow><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.5.3"><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.5.3a">−</mo><mn id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.5.3.2">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.3b">​</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1"><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.2">(</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1"><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.1"><msub id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.1.3"><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.1.3.2">b</mi><mrow id="A1.E1.m1.25.25.25.2.2.2.11.4.2.4"><mi id="A1.E1.m1.25.25.25.2.2.2.10.3.1.1">𝜽</mi><mo id="A1.E1.m1.25.25.25.2.2.2.11.4.2.4.1">,</mo><mi id="A1.E1.m1.25.25.25.2.2.2.11.4.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.1.2">​</mo><mrow id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.1.1.1"><mo stretchy="false" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.1.1.1.2">(</mo><msup id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.1.1.1.1"><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.1.1.1.1.2">𝒙</mi><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.1.1.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.1.1.1.3">)</mo></mrow></mrow><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.2">−</mo><msub id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.3"><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.3.2">μ</mi><msup id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.3.3"><mi id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.3.3.2">c</mi><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.1.3.3.3">′</mo></msup></msub></mrow><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.1.2.2.1.3">)</mo></mrow></mrow></mrow><mo id="A1.E1.m1.25.25.25.2.2.2.14.7.2.2.2.1.1.3">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mfrac></mrow></mtd></mtr><mtr id="A1.E1.m1.31.31.2g"><mtd id="A1.E1.m1.31.31.2h"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E1.m1.31.31.2i"><mrow id="A1.E1.m1.27.27.27.2.2"><mi id="A1.E1.m1.27.27.27.2.2.3"></mi><mo id="A1.E1.m1.26.26.26.1.1.1">=</mo><mfrac id="A1.E1.m1.27.27.27.2.2.2"><mrow id="A1.E1.m1.27.27.27.2.2.2.8"><msub id="A1.E1.m1.27.27.27.2.2.2.8.10"><mi id="A1.E1.m1.27.27.27.2.2.2.8.10.2">π</mi><mi id="A1.E1.m1.27.27.27.2.2.2.8.10.3">c</mi></msub><mo lspace="0.167em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.9">​</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1"><mi id="A1.E1.m1.27.27.27.2.2.2.7.7">exp</mi><mo id="A1.E1.m1.27.27.27.2.2.2.8.8.1a">⁡</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1"><mo id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.2">(</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1"><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3"><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2"><mo id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2a">−</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2"><mfrac id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.4"><mn id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.4.2">1</mn><mn id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.4.3">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.3">​</mo><msub id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.5"><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.5.2">b</mi><mrow id="A1.E1.m1.27.27.27.2.2.2.2.2.2.4"><mi id="A1.E1.m1.27.27.27.2.2.2.1.1.1.1">𝜽</mi><mo id="A1.E1.m1.27.27.27.2.2.2.2.2.2.4.1">,</mo><mi id="A1.E1.m1.27.27.27.2.2.2.2.2.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.3a">​</mo><msup id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.1.1.1.1"><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.1.1.1.1.1.1.2">(</mo><msup id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.1.1.1.1.1.1.1.2">𝒙</mi><mo id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.1.1.1.1.1.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.1.1.1.1.1.1.3">)</mo></mrow><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.1.1.1.1.3">T</mi></msup><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.3b">​</mo><msubsup id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.6"><mi mathvariant="normal" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.6.2.2">Σ</mi><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.6.2.3"><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.6.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.6.2.3.1">​</mo><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.6.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.6.2.3.1a">​</mo><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.6.2.3.4">A</mi></mrow><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.6.3"><mo id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.6.3a">−</mo><mn id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.6.3.2">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.3c">​</mo><msub id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.7"><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.7.2">b</mi><mrow id="A1.E1.m1.27.27.27.2.2.2.4.4.2.4"><mi id="A1.E1.m1.27.27.27.2.2.2.3.3.1.1">𝜽</mi><mo id="A1.E1.m1.27.27.27.2.2.2.4.4.2.4.1">,</mo><mi id="A1.E1.m1.27.27.27.2.2.2.4.4.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.3d">​</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.2.1"><mo stretchy="false" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.2.1.2">(</mo><msup id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.2.1.1"><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.2.1.1.2">𝒙</mi><mo id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.2.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.2.2.2.2.1.3">)</mo></mrow></mrow></mrow><mo id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.4">+</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3"><msubsup id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.3"><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.3.2.2">μ</mi><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.3.2.3">c</mi><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.3.3">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.2">​</mo><msubsup id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.4"><mi mathvariant="normal" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.4.2.2">Σ</mi><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.4.2.3"><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.4.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.4.2.3.1">​</mo><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.4.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.4.2.3.1a">​</mo><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.4.2.3.4">A</mi></mrow><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.4.3"><mo id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.4.3a">−</mo><mn id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.4.3.2">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.2a">​</mo><msub id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.5"><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.5.2">b</mi><mrow id="A1.E1.m1.27.27.27.2.2.2.6.6.2.4"><mi id="A1.E1.m1.27.27.27.2.2.2.5.5.1.1">𝜽</mi><mo id="A1.E1.m1.27.27.27.2.2.2.6.6.2.4.1">,</mo><mi id="A1.E1.m1.27.27.27.2.2.2.6.6.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.2b">​</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.1.1"><mo stretchy="false" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.1.1.2">(</mo><msup id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.1.1.1"><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.1.1.1.2">𝒙</mi><mo id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.1.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.3.3.1.1.3">)</mo></mrow></mrow></mrow><mo id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.4">−</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5"><mfrac id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.2"><mn id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.2.2">1</mn><mn id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.2.3">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.1">​</mo><msubsup id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.3"><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.3.2.2">μ</mi><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.3.2.3">c</mi><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.3.3">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.1a">​</mo><msubsup id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.4"><mi mathvariant="normal" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.4.2.2">Σ</mi><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.4.2.3"><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.4.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.4.2.3.1">​</mo><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.4.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.4.2.3.1a">​</mo><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.4.2.3.4">A</mi></mrow><mrow id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.4.3"><mo id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.4.3a">−</mo><mn id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.4.3.2">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.1b">​</mo><msub id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.5"><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.5.2">μ</mi><mi id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.1.5.5.3">c</mi></msub></mrow></mrow><mo id="A1.E1.m1.27.27.27.2.2.2.8.8.1.1.3">)</mo></mrow></mrow></mrow><mrow id="A1.E1.m1.27.27.27.2.2.2.16"><msubsup id="A1.E1.m1.27.27.27.2.2.2.16.9"><mo id="A1.E1.m1.27.27.27.2.2.2.16.9.2.2">∑</mo><msup id="A1.E1.m1.27.27.27.2.2.2.16.9.2.3"><mi id="A1.E1.m1.27.27.27.2.2.2.16.9.2.3.2">c</mi><mo id="A1.E1.m1.27.27.27.2.2.2.16.9.2.3.3">′</mo></msup><mi id="A1.E1.m1.27.27.27.2.2.2.16.9.3">C</mi></msubsup><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8"><msub id="A1.E1.m1.27.27.27.2.2.2.16.8.3"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.3.2">π</mi><msup id="A1.E1.m1.27.27.27.2.2.2.16.8.3.3"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.3.3.2">c</mi><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.3.3.3">′</mo></msup></msub><mo lspace="0.167em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.2">​</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1"><mi id="A1.E1.m1.27.27.27.2.2.2.15.7">exp</mi><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1a">⁡</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1"><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.2">(</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1"><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3"><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2"><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2a">−</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2"><mfrac id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.4"><mn id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.4.2">1</mn><mn id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.4.3">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.3">​</mo><msub id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.5"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.5.2">b</mi><mrow id="A1.E1.m1.27.27.27.2.2.2.10.2.2.4"><mi id="A1.E1.m1.27.27.27.2.2.2.9.1.1.1">𝜽</mi><mo id="A1.E1.m1.27.27.27.2.2.2.10.2.2.4.1">,</mo><mi id="A1.E1.m1.27.27.27.2.2.2.10.2.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.3a">​</mo><msup id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.1.1.1.1"><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.1.1.1.1.1.1.2">(</mo><msup id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</mi><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.1.1.1.1.1.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.1.1.1.1.1.1.3">)</mo></mrow><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.1.1.1.1.3">T</mi></msup><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.3b">​</mo><msubsup id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.6"><mi mathvariant="normal" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.6.2.2">Σ</mi><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.6.2.3"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.6.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.6.2.3.1">​</mo><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.6.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.6.2.3.1a">​</mo><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.6.2.3.4">A</mi></mrow><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.6.3"><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.6.3a">−</mo><mn id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.6.3.2">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.3c">​</mo><msub id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.7"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.7.2">b</mi><mrow id="A1.E1.m1.27.27.27.2.2.2.12.4.2.4"><mi id="A1.E1.m1.27.27.27.2.2.2.11.3.1.1">𝜽</mi><mo id="A1.E1.m1.27.27.27.2.2.2.12.4.2.4.1">,</mo><mi id="A1.E1.m1.27.27.27.2.2.2.12.4.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.3d">​</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.2.1"><mo stretchy="false" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.2.1.2">(</mo><msup id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.2.1.1"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.2.1.1.2">𝒙</mi><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.2.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.2.2.2.2.1.3">)</mo></mrow></mrow></mrow><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.4">+</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3"><msubsup id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.3"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.3.2.2">μ</mi><msup id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.3.2.3"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.3.2.3.2">c</mi><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.3.2.3.3">′</mo></msup><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.3.3">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.2">​</mo><msubsup id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.4"><mi mathvariant="normal" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.4.2.2">Σ</mi><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.4.2.3"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.4.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.4.2.3.1">​</mo><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.4.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.4.2.3.1a">​</mo><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.4.2.3.4">A</mi></mrow><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.4.3"><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.4.3a">−</mo><mn id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.4.3.2">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.2a">​</mo><msub id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.5"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.5.2">b</mi><mrow id="A1.E1.m1.27.27.27.2.2.2.14.6.2.4"><mi id="A1.E1.m1.27.27.27.2.2.2.13.5.1.1">𝜽</mi><mo id="A1.E1.m1.27.27.27.2.2.2.14.6.2.4.1">,</mo><mi id="A1.E1.m1.27.27.27.2.2.2.14.6.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.2b">​</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.1.1"><mo stretchy="false" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.1.1.2">(</mo><msup id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.1.1.1"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.1.1.1.2">𝒙</mi><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.1.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.3.3.1.1.3">)</mo></mrow></mrow></mrow><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.4">−</mo><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5"><mfrac id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.2"><mn id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.2.2">1</mn><mn id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.2.3">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.1">​</mo><msubsup id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.3"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.3.2.2">μ</mi><msup id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.3.2.3"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.3.2.3.2">c</mi><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.3.2.3.3">′</mo></msup><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.3.3">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.1a">​</mo><msubsup id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.4"><mi mathvariant="normal" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.4.2.2">Σ</mi><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.4.2.3"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.4.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.4.2.3.1">​</mo><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.4.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.4.2.3.1a">​</mo><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.4.2.3.4">A</mi></mrow><mrow id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.4.3"><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.4.3a">−</mo><mn id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.4.3.2">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.1b">​</mo><msub id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.5"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.5.2">μ</mi><msup id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.5.3"><mi id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.5.3.2">c</mi><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.1.5.5.3.3">′</mo></msup></msub></mrow></mrow><mo id="A1.E1.m1.27.27.27.2.2.2.16.8.1.1.1.3">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mtd></mtr><mtr id="A1.E1.m1.31.31.2j"><mtd id="A1.E1.m1.31.31.2k"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E1.m1.31.31.2l"><mrow id="A1.E1.m1.29.29.29.2.2"><mi id="A1.E1.m1.29.29.29.2.2.3"></mi><mo id="A1.E1.m1.28.28.28.1.1.1">=</mo><mfrac id="A1.E1.m1.29.29.29.2.2.2"><mrow id="A1.E1.m1.29.29.29.2.2.2.4"><msub id="A1.E1.m1.29.29.29.2.2.2.4.6"><mi id="A1.E1.m1.29.29.29.2.2.2.4.6.2">π</mi><mi id="A1.E1.m1.29.29.29.2.2.2.4.6.3">c</mi></msub><mo lspace="0.167em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.4.5">​</mo><mrow id="A1.E1.m1.29.29.29.2.2.2.4.4.1"><mi id="A1.E1.m1.29.29.29.2.2.2.3.3">exp</mi><mo id="A1.E1.m1.29.29.29.2.2.2.4.4.1a">⁡</mo><mrow id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1"><mo id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.2">(</mo><mrow id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1"><mrow id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1"><msubsup id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.3"><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.3.2.2">μ</mi><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.3.2.3">c</mi><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.3.3">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.2">​</mo><msubsup id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.4"><mi mathvariant="normal" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.4.2.2">Σ</mi><mrow id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.4.2.3"><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.4.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.4.2.3.1">​</mo><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.4.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.4.2.3.1a">​</mo><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.4.2.3.4">A</mi></mrow><mrow id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.4.3"><mo id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.4.3a">−</mo><mn id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.4.3.2">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.2a">​</mo><msub id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.5"><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.5.2">b</mi><mrow id="A1.E1.m1.29.29.29.2.2.2.2.2.2.4"><mi id="A1.E1.m1.29.29.29.2.2.2.1.1.1.1">𝜽</mi><mo id="A1.E1.m1.29.29.29.2.2.2.2.2.2.4.1">,</mo><mi id="A1.E1.m1.29.29.29.2.2.2.2.2.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.2b">​</mo><mrow id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.1.1"><mo stretchy="false" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.1.1.2">(</mo><msup id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.1.1.1"><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.1.1.1.2">𝒙</mi><mo id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.1.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.2">−</mo><mrow id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3"><mfrac id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.2"><mn id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.2.2">1</mn><mn id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.2.3">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.1">​</mo><msubsup id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.3"><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.3.2.2">μ</mi><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.3.2.3">c</mi><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.3.3">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.1a">​</mo><msubsup id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.4"><mi mathvariant="normal" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.4.2.2">Σ</mi><mrow id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.4.2.3"><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.4.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.4.2.3.1">​</mo><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.4.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.4.2.3.1a">​</mo><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.4.2.3.4">A</mi></mrow><mrow id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.4.3"><mo id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.4.3a">−</mo><mn id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.4.3.2">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.1b">​</mo><msub id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.5"><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.5.2">μ</mi><mi id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.1.3.5.3">c</mi></msub></mrow></mrow><mo id="A1.E1.m1.29.29.29.2.2.2.4.4.1.1.3">)</mo></mrow></mrow></mrow><mrow id="A1.E1.m1.29.29.29.2.2.2.8"><msubsup id="A1.E1.m1.29.29.29.2.2.2.8.5"><mo id="A1.E1.m1.29.29.29.2.2.2.8.5.2.2">∑</mo><msup id="A1.E1.m1.29.29.29.2.2.2.8.5.2.3"><mi id="A1.E1.m1.29.29.29.2.2.2.8.5.2.3.2">c</mi><mo id="A1.E1.m1.29.29.29.2.2.2.8.5.2.3.3">′</mo></msup><mi id="A1.E1.m1.29.29.29.2.2.2.8.5.3">C</mi></msubsup><mrow id="A1.E1.m1.29.29.29.2.2.2.8.4"><msub id="A1.E1.m1.29.29.29.2.2.2.8.4.3"><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.3.2">π</mi><msup id="A1.E1.m1.29.29.29.2.2.2.8.4.3.3"><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.3.3.2">c</mi><mo id="A1.E1.m1.29.29.29.2.2.2.8.4.3.3.3">′</mo></msup></msub><mo lspace="0.167em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.8.4.2">​</mo><mrow id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1"><mi id="A1.E1.m1.29.29.29.2.2.2.7.3">exp</mi><mo id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1a">⁡</mo><mrow id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1"><mo id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.2">(</mo><mrow id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1"><mrow id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1"><msubsup id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.3"><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.3.2.2">μ</mi><msup id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.3.2.3"><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.3.2.3.2">c</mi><mo id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.3.2.3.3">′</mo></msup><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.3.3">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.2">​</mo><msubsup id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.4"><mi mathvariant="normal" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.4.2.2">Σ</mi><mrow id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.4.2.3"><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.4.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.4.2.3.1">​</mo><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.4.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.4.2.3.1a">​</mo><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.4.2.3.4">A</mi></mrow><mrow id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.4.3"><mo id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.4.3a">−</mo><mn id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.4.3.2">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.2a">​</mo><msub id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.5"><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.5.2">b</mi><mrow id="A1.E1.m1.29.29.29.2.2.2.6.2.2.4"><mi id="A1.E1.m1.29.29.29.2.2.2.5.1.1.1">𝜽</mi><mo id="A1.E1.m1.29.29.29.2.2.2.6.2.2.4.1">,</mo><mi id="A1.E1.m1.29.29.29.2.2.2.6.2.2.2">𝝍</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.2b">​</mo><mrow id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.1.1"><mo stretchy="false" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.1.1.2">(</mo><msup id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.1.1.1"><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.1.1.1.2">𝒙</mi><mo id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.1.1.1.3">∗</mo></msup><mo stretchy="false" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.2">−</mo><mrow id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3"><mfrac id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.2"><mn id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.2.2">1</mn><mn id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.2.3">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.1">​</mo><msubsup id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.3"><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.3.2.2">μ</mi><msup id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.3.2.3"><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.3.2.3.2">c</mi><mo id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.3.2.3.3">′</mo></msup><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.3.3">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.1a">​</mo><msubsup id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.4"><mi mathvariant="normal" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.4.2.2">Σ</mi><mrow id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.4.2.3"><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.4.2.3.2">L</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.4.2.3.1">​</mo><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.4.2.3.3">D</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.4.2.3.1a">​</mo><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.4.2.3.4">A</mi></mrow><mrow id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.4.3"><mo id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.4.3a">−</mo><mn id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.4.3.2">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.1b">​</mo><msub id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.5"><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.5.2">μ</mi><msup id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.5.3"><mi id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.5.3.2">c</mi><mo id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.1.3.5.3.3">′</mo></msup></msub></mrow></mrow><mo id="A1.E1.m1.29.29.29.2.2.2.8.4.1.1.1.3">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="A1.E1.m1.31b">\begin{split}&amp;p(y^{*}=c|b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*}),{\bm{\pi}},{\bm{\mu}},\Sigma_{LDA})=\dfrac{\pi_{c}\mathcal{N}(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})|\mu_{c},\Sigma_{LDA}))}{\sum_{c^{\prime}}^{C}\pi_{c^{\prime}}\mathcal{N}(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})|\mu_{c^{\prime}},\Sigma_{LDA})}\\
&amp;=\dfrac{\pi_{c}\det\left(2\pi\Sigma_{LDA}\right)^{-\frac{1}{2}}\exp\left(-\frac{1}{2}\left(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\mu_{c}\right)^{T}\Sigma_{LDA}^{-1}\left(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\mu_{c}\right)\right)}{\sum_{c^{\prime}}^{C}\pi_{c^{\prime}}\det\left(2\pi\Sigma_{LDA}\right)^{-\frac{1}{2}}\exp\left(-\frac{1}{2}\left(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\mu_{c^{\prime}}\right)^{T}\Sigma_{LDA}^{-1}\left(b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\mu_{c^{\prime}}\right)\right)}\\
&amp;=\dfrac{\pi_{c}\exp\left(-\frac{1}{2}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})^{T}\Sigma_{LDA}^{-1}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})+\mu_{c}^{T}\Sigma_{LDA}^{-1}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\frac{1}{2}\mu_{c}^{T}\Sigma_{LDA}^{-1}\mu_{c}\right)}{\sum_{c^{\prime}}^{C}\pi_{c^{\prime}}\exp\left(-\frac{1}{2}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})^{T}\Sigma_{LDA}^{-1}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})+\mu_{c^{\prime}}^{T}\Sigma_{LDA}^{-1}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\frac{1}{2}\mu_{c^{\prime}}^{T}\Sigma_{LDA}^{-1}\mu_{c^{\prime}}\right)}\\
&amp;=\dfrac{\pi_{c}\exp\left(\mu_{c}^{T}\Sigma_{LDA}^{-1}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\frac{1}{2}\mu_{c}^{T}\Sigma_{LDA}^{-1}\mu_{c}\right)}{\sum_{c^{\prime}}^{C}\pi_{c^{\prime}}\exp\left(\mu_{c^{\prime}}^{T}\Sigma_{LDA}^{-1}b_{{\bm{\theta}},{\bm{\psi}}}({\bm{x}}^{*})-\frac{1}{2}\mu_{c^{\prime}}^{T}\Sigma_{LDA}^{-1}\mu_{c^{\prime}}\right)}\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.1)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.p4.6" class="ltx_p">From <a href="#A1.E1" title="In A.2 Model Parameters ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">A.1</span></a>, it follows that to compute the probability of classifying a test point <math id="A1.SS2.p4.1.m1.1" class="ltx_Math" alttext="{\bm{x}}^{*}" display="inline"><semantics id="A1.SS2.p4.1.m1.1a"><msup id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml"><mi id="A1.SS2.p4.1.m1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.2.cmml">𝒙</mi><mo id="A1.SS2.p4.1.m1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><apply id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p4.1.m1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1">superscript</csymbol><ci id="A1.SS2.p4.1.m1.1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.1.2">𝒙</ci><times id="A1.SS2.p4.1.m1.1.1.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">{\bm{x}}^{*}</annotation></semantics></math>, we need to store <math id="A1.SS2.p4.2.m2.1" class="ltx_Math" alttext="\mu_{c}^{T}\Sigma_{LDA}^{-1}" display="inline"><semantics id="A1.SS2.p4.2.m2.1a"><mrow id="A1.SS2.p4.2.m2.1.1" xref="A1.SS2.p4.2.m2.1.1.cmml"><msubsup id="A1.SS2.p4.2.m2.1.1.2" xref="A1.SS2.p4.2.m2.1.1.2.cmml"><mi id="A1.SS2.p4.2.m2.1.1.2.2.2" xref="A1.SS2.p4.2.m2.1.1.2.2.2.cmml">μ</mi><mi id="A1.SS2.p4.2.m2.1.1.2.2.3" xref="A1.SS2.p4.2.m2.1.1.2.2.3.cmml">c</mi><mi id="A1.SS2.p4.2.m2.1.1.2.3" xref="A1.SS2.p4.2.m2.1.1.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.SS2.p4.2.m2.1.1.1" xref="A1.SS2.p4.2.m2.1.1.1.cmml">​</mo><msubsup id="A1.SS2.p4.2.m2.1.1.3" xref="A1.SS2.p4.2.m2.1.1.3.cmml"><mi mathvariant="normal" id="A1.SS2.p4.2.m2.1.1.3.2.2" xref="A1.SS2.p4.2.m2.1.1.3.2.2.cmml">Σ</mi><mrow id="A1.SS2.p4.2.m2.1.1.3.2.3" xref="A1.SS2.p4.2.m2.1.1.3.2.3.cmml"><mi id="A1.SS2.p4.2.m2.1.1.3.2.3.2" xref="A1.SS2.p4.2.m2.1.1.3.2.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p4.2.m2.1.1.3.2.3.1" xref="A1.SS2.p4.2.m2.1.1.3.2.3.1.cmml">​</mo><mi id="A1.SS2.p4.2.m2.1.1.3.2.3.3" xref="A1.SS2.p4.2.m2.1.1.3.2.3.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p4.2.m2.1.1.3.2.3.1a" xref="A1.SS2.p4.2.m2.1.1.3.2.3.1.cmml">​</mo><mi id="A1.SS2.p4.2.m2.1.1.3.2.3.4" xref="A1.SS2.p4.2.m2.1.1.3.2.3.4.cmml">A</mi></mrow><mrow id="A1.SS2.p4.2.m2.1.1.3.3" xref="A1.SS2.p4.2.m2.1.1.3.3.cmml"><mo id="A1.SS2.p4.2.m2.1.1.3.3a" xref="A1.SS2.p4.2.m2.1.1.3.3.cmml">−</mo><mn id="A1.SS2.p4.2.m2.1.1.3.3.2" xref="A1.SS2.p4.2.m2.1.1.3.3.2.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.2.m2.1b"><apply id="A1.SS2.p4.2.m2.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1"><times id="A1.SS2.p4.2.m2.1.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1.1"></times><apply id="A1.SS2.p4.2.m2.1.1.2.cmml" xref="A1.SS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.2.m2.1.1.2.1.cmml" xref="A1.SS2.p4.2.m2.1.1.2">superscript</csymbol><apply id="A1.SS2.p4.2.m2.1.1.2.2.cmml" xref="A1.SS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.2.m2.1.1.2.2.1.cmml" xref="A1.SS2.p4.2.m2.1.1.2">subscript</csymbol><ci id="A1.SS2.p4.2.m2.1.1.2.2.2.cmml" xref="A1.SS2.p4.2.m2.1.1.2.2.2">𝜇</ci><ci id="A1.SS2.p4.2.m2.1.1.2.2.3.cmml" xref="A1.SS2.p4.2.m2.1.1.2.2.3">𝑐</ci></apply><ci id="A1.SS2.p4.2.m2.1.1.2.3.cmml" xref="A1.SS2.p4.2.m2.1.1.2.3">𝑇</ci></apply><apply id="A1.SS2.p4.2.m2.1.1.3.cmml" xref="A1.SS2.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p4.2.m2.1.1.3.1.cmml" xref="A1.SS2.p4.2.m2.1.1.3">superscript</csymbol><apply id="A1.SS2.p4.2.m2.1.1.3.2.cmml" xref="A1.SS2.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p4.2.m2.1.1.3.2.1.cmml" xref="A1.SS2.p4.2.m2.1.1.3">subscript</csymbol><ci id="A1.SS2.p4.2.m2.1.1.3.2.2.cmml" xref="A1.SS2.p4.2.m2.1.1.3.2.2">Σ</ci><apply id="A1.SS2.p4.2.m2.1.1.3.2.3.cmml" xref="A1.SS2.p4.2.m2.1.1.3.2.3"><times id="A1.SS2.p4.2.m2.1.1.3.2.3.1.cmml" xref="A1.SS2.p4.2.m2.1.1.3.2.3.1"></times><ci id="A1.SS2.p4.2.m2.1.1.3.2.3.2.cmml" xref="A1.SS2.p4.2.m2.1.1.3.2.3.2">𝐿</ci><ci id="A1.SS2.p4.2.m2.1.1.3.2.3.3.cmml" xref="A1.SS2.p4.2.m2.1.1.3.2.3.3">𝐷</ci><ci id="A1.SS2.p4.2.m2.1.1.3.2.3.4.cmml" xref="A1.SS2.p4.2.m2.1.1.3.2.3.4">𝐴</ci></apply></apply><apply id="A1.SS2.p4.2.m2.1.1.3.3.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3"><minus id="A1.SS2.p4.2.m2.1.1.3.3.1.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3"></minus><cn type="integer" id="A1.SS2.p4.2.m2.1.1.3.3.2.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.2.m2.1c">\mu_{c}^{T}\Sigma_{LDA}^{-1}</annotation></semantics></math> which has dimensionality <math id="A1.SS2.p4.3.m3.1" class="ltx_Math" alttext="d_{b}" display="inline"><semantics id="A1.SS2.p4.3.m3.1a"><msub id="A1.SS2.p4.3.m3.1.1" xref="A1.SS2.p4.3.m3.1.1.cmml"><mi id="A1.SS2.p4.3.m3.1.1.2" xref="A1.SS2.p4.3.m3.1.1.2.cmml">d</mi><mi id="A1.SS2.p4.3.m3.1.1.3" xref="A1.SS2.p4.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.3.m3.1b"><apply id="A1.SS2.p4.3.m3.1.1.cmml" xref="A1.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p4.3.m3.1.1.1.cmml" xref="A1.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="A1.SS2.p4.3.m3.1.1.2.cmml" xref="A1.SS2.p4.3.m3.1.1.2">𝑑</ci><ci id="A1.SS2.p4.3.m3.1.1.3.cmml" xref="A1.SS2.p4.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.3.m3.1c">d_{b}</annotation></semantics></math> and <math id="A1.SS2.p4.4.m4.1" class="ltx_Math" alttext="\mu_{c}^{T}\Sigma_{LDA}^{-1}\mu_{c}" display="inline"><semantics id="A1.SS2.p4.4.m4.1a"><mrow id="A1.SS2.p4.4.m4.1.1" xref="A1.SS2.p4.4.m4.1.1.cmml"><msubsup id="A1.SS2.p4.4.m4.1.1.2" xref="A1.SS2.p4.4.m4.1.1.2.cmml"><mi id="A1.SS2.p4.4.m4.1.1.2.2.2" xref="A1.SS2.p4.4.m4.1.1.2.2.2.cmml">μ</mi><mi id="A1.SS2.p4.4.m4.1.1.2.2.3" xref="A1.SS2.p4.4.m4.1.1.2.2.3.cmml">c</mi><mi id="A1.SS2.p4.4.m4.1.1.2.3" xref="A1.SS2.p4.4.m4.1.1.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.SS2.p4.4.m4.1.1.1" xref="A1.SS2.p4.4.m4.1.1.1.cmml">​</mo><msubsup id="A1.SS2.p4.4.m4.1.1.3" xref="A1.SS2.p4.4.m4.1.1.3.cmml"><mi mathvariant="normal" id="A1.SS2.p4.4.m4.1.1.3.2.2" xref="A1.SS2.p4.4.m4.1.1.3.2.2.cmml">Σ</mi><mrow id="A1.SS2.p4.4.m4.1.1.3.2.3" xref="A1.SS2.p4.4.m4.1.1.3.2.3.cmml"><mi id="A1.SS2.p4.4.m4.1.1.3.2.3.2" xref="A1.SS2.p4.4.m4.1.1.3.2.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p4.4.m4.1.1.3.2.3.1" xref="A1.SS2.p4.4.m4.1.1.3.2.3.1.cmml">​</mo><mi id="A1.SS2.p4.4.m4.1.1.3.2.3.3" xref="A1.SS2.p4.4.m4.1.1.3.2.3.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p4.4.m4.1.1.3.2.3.1a" xref="A1.SS2.p4.4.m4.1.1.3.2.3.1.cmml">​</mo><mi id="A1.SS2.p4.4.m4.1.1.3.2.3.4" xref="A1.SS2.p4.4.m4.1.1.3.2.3.4.cmml">A</mi></mrow><mrow id="A1.SS2.p4.4.m4.1.1.3.3" xref="A1.SS2.p4.4.m4.1.1.3.3.cmml"><mo id="A1.SS2.p4.4.m4.1.1.3.3a" xref="A1.SS2.p4.4.m4.1.1.3.3.cmml">−</mo><mn id="A1.SS2.p4.4.m4.1.1.3.3.2" xref="A1.SS2.p4.4.m4.1.1.3.3.2.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.SS2.p4.4.m4.1.1.1a" xref="A1.SS2.p4.4.m4.1.1.1.cmml">​</mo><msub id="A1.SS2.p4.4.m4.1.1.4" xref="A1.SS2.p4.4.m4.1.1.4.cmml"><mi id="A1.SS2.p4.4.m4.1.1.4.2" xref="A1.SS2.p4.4.m4.1.1.4.2.cmml">μ</mi><mi id="A1.SS2.p4.4.m4.1.1.4.3" xref="A1.SS2.p4.4.m4.1.1.4.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.4.m4.1b"><apply id="A1.SS2.p4.4.m4.1.1.cmml" xref="A1.SS2.p4.4.m4.1.1"><times id="A1.SS2.p4.4.m4.1.1.1.cmml" xref="A1.SS2.p4.4.m4.1.1.1"></times><apply id="A1.SS2.p4.4.m4.1.1.2.cmml" xref="A1.SS2.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.4.m4.1.1.2.1.cmml" xref="A1.SS2.p4.4.m4.1.1.2">superscript</csymbol><apply id="A1.SS2.p4.4.m4.1.1.2.2.cmml" xref="A1.SS2.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.4.m4.1.1.2.2.1.cmml" xref="A1.SS2.p4.4.m4.1.1.2">subscript</csymbol><ci id="A1.SS2.p4.4.m4.1.1.2.2.2.cmml" xref="A1.SS2.p4.4.m4.1.1.2.2.2">𝜇</ci><ci id="A1.SS2.p4.4.m4.1.1.2.2.3.cmml" xref="A1.SS2.p4.4.m4.1.1.2.2.3">𝑐</ci></apply><ci id="A1.SS2.p4.4.m4.1.1.2.3.cmml" xref="A1.SS2.p4.4.m4.1.1.2.3">𝑇</ci></apply><apply id="A1.SS2.p4.4.m4.1.1.3.cmml" xref="A1.SS2.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p4.4.m4.1.1.3.1.cmml" xref="A1.SS2.p4.4.m4.1.1.3">superscript</csymbol><apply id="A1.SS2.p4.4.m4.1.1.3.2.cmml" xref="A1.SS2.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p4.4.m4.1.1.3.2.1.cmml" xref="A1.SS2.p4.4.m4.1.1.3">subscript</csymbol><ci id="A1.SS2.p4.4.m4.1.1.3.2.2.cmml" xref="A1.SS2.p4.4.m4.1.1.3.2.2">Σ</ci><apply id="A1.SS2.p4.4.m4.1.1.3.2.3.cmml" xref="A1.SS2.p4.4.m4.1.1.3.2.3"><times id="A1.SS2.p4.4.m4.1.1.3.2.3.1.cmml" xref="A1.SS2.p4.4.m4.1.1.3.2.3.1"></times><ci id="A1.SS2.p4.4.m4.1.1.3.2.3.2.cmml" xref="A1.SS2.p4.4.m4.1.1.3.2.3.2">𝐿</ci><ci id="A1.SS2.p4.4.m4.1.1.3.2.3.3.cmml" xref="A1.SS2.p4.4.m4.1.1.3.2.3.3">𝐷</ci><ci id="A1.SS2.p4.4.m4.1.1.3.2.3.4.cmml" xref="A1.SS2.p4.4.m4.1.1.3.2.3.4">𝐴</ci></apply></apply><apply id="A1.SS2.p4.4.m4.1.1.3.3.cmml" xref="A1.SS2.p4.4.m4.1.1.3.3"><minus id="A1.SS2.p4.4.m4.1.1.3.3.1.cmml" xref="A1.SS2.p4.4.m4.1.1.3.3"></minus><cn type="integer" id="A1.SS2.p4.4.m4.1.1.3.3.2.cmml" xref="A1.SS2.p4.4.m4.1.1.3.3.2">1</cn></apply></apply><apply id="A1.SS2.p4.4.m4.1.1.4.cmml" xref="A1.SS2.p4.4.m4.1.1.4"><csymbol cd="ambiguous" id="A1.SS2.p4.4.m4.1.1.4.1.cmml" xref="A1.SS2.p4.4.m4.1.1.4">subscript</csymbol><ci id="A1.SS2.p4.4.m4.1.1.4.2.cmml" xref="A1.SS2.p4.4.m4.1.1.4.2">𝜇</ci><ci id="A1.SS2.p4.4.m4.1.1.4.3.cmml" xref="A1.SS2.p4.4.m4.1.1.4.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.4.m4.1c">\mu_{c}^{T}\Sigma_{LDA}^{-1}\mu_{c}</annotation></semantics></math> which has dimensionality 1 for each class <math id="A1.SS2.p4.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="A1.SS2.p4.5.m5.1a"><mi id="A1.SS2.p4.5.m5.1.1" xref="A1.SS2.p4.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.5.m5.1b"><ci id="A1.SS2.p4.5.m5.1.1.cmml" xref="A1.SS2.p4.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.5.m5.1c">c</annotation></semantics></math>, resulting in only <math id="A1.SS2.p4.6.m6.1" class="ltx_Math" alttext="C(d_{b}+1)" display="inline"><semantics id="A1.SS2.p4.6.m6.1a"><mrow id="A1.SS2.p4.6.m6.1.1" xref="A1.SS2.p4.6.m6.1.1.cmml"><mi id="A1.SS2.p4.6.m6.1.1.3" xref="A1.SS2.p4.6.m6.1.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p4.6.m6.1.1.2" xref="A1.SS2.p4.6.m6.1.1.2.cmml">​</mo><mrow id="A1.SS2.p4.6.m6.1.1.1.1" xref="A1.SS2.p4.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS2.p4.6.m6.1.1.1.1.2" xref="A1.SS2.p4.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.p4.6.m6.1.1.1.1.1" xref="A1.SS2.p4.6.m6.1.1.1.1.1.cmml"><msub id="A1.SS2.p4.6.m6.1.1.1.1.1.2" xref="A1.SS2.p4.6.m6.1.1.1.1.1.2.cmml"><mi id="A1.SS2.p4.6.m6.1.1.1.1.1.2.2" xref="A1.SS2.p4.6.m6.1.1.1.1.1.2.2.cmml">d</mi><mi id="A1.SS2.p4.6.m6.1.1.1.1.1.2.3" xref="A1.SS2.p4.6.m6.1.1.1.1.1.2.3.cmml">b</mi></msub><mo id="A1.SS2.p4.6.m6.1.1.1.1.1.1" xref="A1.SS2.p4.6.m6.1.1.1.1.1.1.cmml">+</mo><mn id="A1.SS2.p4.6.m6.1.1.1.1.1.3" xref="A1.SS2.p4.6.m6.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A1.SS2.p4.6.m6.1.1.1.1.3" xref="A1.SS2.p4.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.6.m6.1b"><apply id="A1.SS2.p4.6.m6.1.1.cmml" xref="A1.SS2.p4.6.m6.1.1"><times id="A1.SS2.p4.6.m6.1.1.2.cmml" xref="A1.SS2.p4.6.m6.1.1.2"></times><ci id="A1.SS2.p4.6.m6.1.1.3.cmml" xref="A1.SS2.p4.6.m6.1.1.3">𝐶</ci><apply id="A1.SS2.p4.6.m6.1.1.1.1.1.cmml" xref="A1.SS2.p4.6.m6.1.1.1.1"><plus id="A1.SS2.p4.6.m6.1.1.1.1.1.1.cmml" xref="A1.SS2.p4.6.m6.1.1.1.1.1.1"></plus><apply id="A1.SS2.p4.6.m6.1.1.1.1.1.2.cmml" xref="A1.SS2.p4.6.m6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.6.m6.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p4.6.m6.1.1.1.1.1.2">subscript</csymbol><ci id="A1.SS2.p4.6.m6.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p4.6.m6.1.1.1.1.1.2.2">𝑑</ci><ci id="A1.SS2.p4.6.m6.1.1.1.1.1.2.3.cmml" xref="A1.SS2.p4.6.m6.1.1.1.1.1.2.3">𝑏</ci></apply><cn type="integer" id="A1.SS2.p4.6.m6.1.1.1.1.1.3.cmml" xref="A1.SS2.p4.6.m6.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.6.m6.1c">C(d_{b}+1)</annotation></semantics></math> parameters required for the <span id="A1.SS2.p4.6.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA head. Since the covariance matrix is not shared in the case of <span id="A1.SS2.p4.6.2" class="ltx_text ltx_font_smallcaps">FiT</span>-QDA, no additional savings are possible in that case.</p>
</div>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>VTAB-1k Datasets</h3>

<div id="A1.SS3.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.p1.1" class="ltx_p">The VTAB-1k benchmark <cite class="ltx_cite ltx_citemacro_citep">(Zhai et al., <a href="#bib.bib64" title="" class="ltx_ref">2019</a>)</cite> is a low to medium-shot transfer learning benchmark that consists of 19 datasets grouped into three distinct categories (natural, specialized, and structured).</p>
</div>
<div id="A1.SS3.p2" class="ltx_para ltx_noindent">
<p id="A1.SS3.p2.1" class="ltx_p">The natural datasets are: Caltech101 <cite class="ltx_cite ltx_citemacro_citep">(Fei-Fei et al., <a href="#bib.bib14" title="" class="ltx_ref">2006</a>)</cite>, CIFAR100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib31" title="" class="ltx_ref">2009</a>)</cite>, Flowers102 <cite class="ltx_cite ltx_citemacro_citep">(Nilsback &amp; Zisserman, <a href="#bib.bib41" title="" class="ltx_ref">2008</a>)</cite>, Pets <cite class="ltx_cite ltx_citemacro_citep">(Parkhi et al., <a href="#bib.bib43" title="" class="ltx_ref">2012</a>)</cite>, Sun397 <cite class="ltx_cite ltx_citemacro_citep">(Xiao et al., <a href="#bib.bib61" title="" class="ltx_ref">2010</a>)</cite>, SVHN <cite class="ltx_cite ltx_citemacro_citep">(Netzer et al., <a href="#bib.bib40" title="" class="ltx_ref">2011</a>)</cite>, and DTD <cite class="ltx_cite ltx_citemacro_citep">(Cimpoi et al., <a href="#bib.bib8" title="" class="ltx_ref">2014</a>)</cite>.</p>
</div>
<div id="A1.SS3.p3" class="ltx_para ltx_noindent">
<p id="A1.SS3.p3.1" class="ltx_p">The specialized datasets are: EuroSAT <cite class="ltx_cite ltx_citemacro_citep">(Helber et al., <a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite>, Resics45 <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite>,Patch Camelyon <cite class="ltx_cite ltx_citemacro_citep">(Veeling et al., <a href="#bib.bib58" title="" class="ltx_ref">2018</a>)</cite>, and Retinopathy <cite class="ltx_cite ltx_citemacro_citep">(Kaggle &amp; EyePacs, <a href="#bib.bib27" title="" class="ltx_ref">2015</a>)</cite>.</p>
</div>
<div id="A1.SS3.p4" class="ltx_para ltx_noindent">
<p id="A1.SS3.p4.1" class="ltx_p">The structured datasets are: CLEVR-count <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite>, CLEVR-dist <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite>, dSprites-loc <cite class="ltx_cite ltx_citemacro_citep">(Matthey et al., <a href="#bib.bib36" title="" class="ltx_ref">2017</a>)</cite>, dSprites-ori <cite class="ltx_cite ltx_citemacro_citep">(Matthey et al., <a href="#bib.bib36" title="" class="ltx_ref">2017</a>)</cite>, SmallNORB-azi <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a href="#bib.bib32" title="" class="ltx_ref">2004</a>)</cite>, SmallNORB-elev <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a href="#bib.bib32" title="" class="ltx_ref">2004</a>)</cite>, DMLab <cite class="ltx_cite ltx_citemacro_citep">(Beattie et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>)</cite>, KITTI-dist <cite class="ltx_cite ltx_citemacro_citep">(Geiger et al., <a href="#bib.bib16" title="" class="ltx_ref">2013</a>)</cite>.</p>
</div>
</section>
<section id="A1.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Additional Results</h3>

<div id="A1.SS4.p1" class="ltx_para ltx_noindent">
<p id="A1.SS4.p1.1" class="ltx_p">This section contains additional results that would not fit into the main paper, including tabular versions of figures. Note, in some results, we use a new metric <span id="A1.SS4.p1.1.1" class="ltx_text ltx_font_italic">Relative Model Update Size</span> or RMUS, which is the ratio of the number of updateable parameters in one model to another. In our experiments, we measure RMUS relative to the number of updatable parameters in BiT model.</p>
</div>
<section id="A1.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.4.1 </span>Additional Few-shot Results</h4>

<div id="A1.SS4.SSS1.p1" class="ltx_para">
<p id="A1.SS4.SSS1.p1.3" class="ltx_p"><a href="#A1.T1" title="In A.4.1 Additional Few-shot Results ‣ A.4 Additional Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.1</span></a> shows the tabular version of <a href="#S4.F3" title="In 4.1 Few-shot Results ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>. In addition, <a href="#A1.T1" title="In A.4.1 Additional Few-shot Results ‣ A.4 Additional Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.1</span></a> includes results for an additional variant of BiT (BiT-FiLM), and two additional variants of <span id="A1.SS4.SSS1.p1.3.1" class="ltx_text ltx_font_smallcaps">FiT</span> (<span id="A1.SS4.SSS1.p1.3.2" class="ltx_text ltx_font_smallcaps">FiT</span>-QDA and <span id="A1.SS4.SSS1.p1.3.3" class="ltx_text ltx_font_smallcaps">FiT</span>-ProtoNets).
BiT-FiLM is a variant of BiT that uses the same training protocol as the standard version of BiT, but the backbone weights <math id="A1.SS4.SSS1.p1.1.m1.1" class="ltx_Math" alttext="{\bm{\theta}}" display="inline"><semantics id="A1.SS4.SSS1.p1.1.m1.1a"><mi id="A1.SS4.SSS1.p1.1.m1.1.1" xref="A1.SS4.SSS1.p1.1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS1.p1.1.m1.1b"><ci id="A1.SS4.SSS1.p1.1.m1.1.1.cmml" xref="A1.SS4.SSS1.p1.1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS1.p1.1.m1.1c">{\bm{\theta}}</annotation></semantics></math> are frozen and FiLM layers are added in the same manner as <span id="A1.SS4.SSS1.p1.3.4" class="ltx_text ltx_font_smallcaps">FiT</span>.
The FiLM parameters <math id="A1.SS4.SSS1.p1.2.m2.1" class="ltx_Math" alttext="{\bm{\psi}}" display="inline"><semantics id="A1.SS4.SSS1.p1.2.m2.1a"><mi id="A1.SS4.SSS1.p1.2.m2.1.1" xref="A1.SS4.SSS1.p1.2.m2.1.1.cmml">𝝍</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS1.p1.2.m2.1b"><ci id="A1.SS4.SSS1.p1.2.m2.1.1.cmml" xref="A1.SS4.SSS1.p1.2.m2.1.1">𝝍</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS1.p1.2.m2.1c">{\bm{\psi}}</annotation></semantics></math> and the linear head weights <math id="A1.SS4.SSS1.p1.3.m3.1" class="ltx_Math" alttext="{\bm{\phi}}" display="inline"><semantics id="A1.SS4.SSS1.p1.3.m3.1a"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A1.SS4.SSS1.p1.3.m3.1.1" xref="A1.SS4.SSS1.p1.3.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS1.p1.3.m3.1b"><ci id="A1.SS4.SSS1.p1.3.m3.1.1.cmml" xref="A1.SS4.SSS1.p1.3.m3.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS1.p1.3.m3.1c">{\bm{\phi}}</annotation></semantics></math> are learned during training. The results are shown in <a href="#A1.T1" title="In A.4.1 Additional Few-shot Results ‣ A.4 Additional Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.1</span></a> and the key observations are:</p>
<ul id="A1.I1" class="ltx_itemize">
<li id="A1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i1.p1" class="ltx_para">
<p id="A1.I1.i1.p1.1" class="ltx_p">In general, at low-shot, the standard version of BiT outperforms BiT-FiLM. However, as the shot increases, especially when training on all of <math id="A1.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="A1.I1.i1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.I1.i1.p1.1.m1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.1b"><ci id="A1.I1.i1.p1.1.m1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.1c">\mathcal{D}</annotation></semantics></math>, BiT-FiLM is equal in classification accuracy.</p>
</div>
</li>
<li id="A1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i2.p1" class="ltx_para">
<p id="A1.I1.i2.p1.1" class="ltx_p">The above implies that FiLM layers have sufficient capacity to accurately fine-tune to downstream datasets, but the <span id="A1.I1.i2.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> head and training protocol are needed to achieve superior results.</p>
</div>
</li>
<li id="A1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i3.p1" class="ltx_para">
<p id="A1.I1.i3.p1.1" class="ltx_p">While the accuracy of <span id="A1.I1.i3.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-QDA and <span id="A1.I1.i3.p1.1.2" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA is similar, the storage requirements for a covariance matrix for each class makes QDA impractical if model update size is an important consideration.</p>
</div>
</li>
<li id="A1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="A1.I1.i4.p1.1" class="ltx_p">The accuracy of <span id="A1.I1.i4.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-ProtoNets is slightly lower than <span id="A1.I1.i4.p1.1.2" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA, but often betters BiT, despite BiT having more than 100 times as many updateable parameters.</p>
</div>
</li>
</ul>
</div>
<figure id="A1.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table A.1: </span>Classification accuracy and Relative Model Update Size (RMUS) for all three variants of <span id="A1.T1.11.1" class="ltx_text ltx_font_smallcaps">FiT</span> and two variants of BiT on standard downstream datasets as a function of shots per class. The backbone is BiT-M-R50x1 with <math id="A1.T1.5.m1.4" class="ltx_Math" alttext="|{\bm{\theta}}|=23,500,352" display="inline"><semantics id="A1.T1.5.m1.4b"><mrow id="A1.T1.5.m1.4.5" xref="A1.T1.5.m1.4.5.cmml"><mrow id="A1.T1.5.m1.4.5.2.2" xref="A1.T1.5.m1.4.5.2.1.cmml"><mo stretchy="false" id="A1.T1.5.m1.4.5.2.2.1" xref="A1.T1.5.m1.4.5.2.1.1.cmml">|</mo><mi id="A1.T1.5.m1.1.1" xref="A1.T1.5.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="A1.T1.5.m1.4.5.2.2.2" xref="A1.T1.5.m1.4.5.2.1.1.cmml">|</mo></mrow><mo id="A1.T1.5.m1.4.5.1" xref="A1.T1.5.m1.4.5.1.cmml">=</mo><mrow id="A1.T1.5.m1.4.5.3.2" xref="A1.T1.5.m1.4.5.3.1.cmml"><mn id="A1.T1.5.m1.2.2" xref="A1.T1.5.m1.2.2.cmml">23</mn><mo id="A1.T1.5.m1.4.5.3.2.1" xref="A1.T1.5.m1.4.5.3.1.cmml">,</mo><mn id="A1.T1.5.m1.3.3" xref="A1.T1.5.m1.3.3.cmml">500</mn><mo id="A1.T1.5.m1.4.5.3.2.2" xref="A1.T1.5.m1.4.5.3.1.cmml">,</mo><mn id="A1.T1.5.m1.4.4" xref="A1.T1.5.m1.4.4.cmml">352</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T1.5.m1.4c"><apply id="A1.T1.5.m1.4.5.cmml" xref="A1.T1.5.m1.4.5"><eq id="A1.T1.5.m1.4.5.1.cmml" xref="A1.T1.5.m1.4.5.1"></eq><apply id="A1.T1.5.m1.4.5.2.1.cmml" xref="A1.T1.5.m1.4.5.2.2"><abs id="A1.T1.5.m1.4.5.2.1.1.cmml" xref="A1.T1.5.m1.4.5.2.2.1"></abs><ci id="A1.T1.5.m1.1.1.cmml" xref="A1.T1.5.m1.1.1">𝜽</ci></apply><list id="A1.T1.5.m1.4.5.3.1.cmml" xref="A1.T1.5.m1.4.5.3.2"><cn type="integer" id="A1.T1.5.m1.2.2.cmml" xref="A1.T1.5.m1.2.2">23</cn><cn type="integer" id="A1.T1.5.m1.3.3.cmml" xref="A1.T1.5.m1.3.3">500</cn><cn type="integer" id="A1.T1.5.m1.4.4.cmml" xref="A1.T1.5.m1.4.4">352</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.5.m1.4d">|{\bm{\theta}}|=23,500,352</annotation></semantics></math>, <math id="A1.T1.6.m2.2" class="ltx_Math" alttext="{\bm{\psi}}=11,648" display="inline"><semantics id="A1.T1.6.m2.2b"><mrow id="A1.T1.6.m2.2.3" xref="A1.T1.6.m2.2.3.cmml"><mi id="A1.T1.6.m2.2.3.2" xref="A1.T1.6.m2.2.3.2.cmml">𝝍</mi><mo id="A1.T1.6.m2.2.3.1" xref="A1.T1.6.m2.2.3.1.cmml">=</mo><mrow id="A1.T1.6.m2.2.3.3.2" xref="A1.T1.6.m2.2.3.3.1.cmml"><mn id="A1.T1.6.m2.1.1" xref="A1.T1.6.m2.1.1.cmml">11</mn><mo id="A1.T1.6.m2.2.3.3.2.1" xref="A1.T1.6.m2.2.3.3.1.cmml">,</mo><mn id="A1.T1.6.m2.2.2" xref="A1.T1.6.m2.2.2.cmml">648</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T1.6.m2.2c"><apply id="A1.T1.6.m2.2.3.cmml" xref="A1.T1.6.m2.2.3"><eq id="A1.T1.6.m2.2.3.1.cmml" xref="A1.T1.6.m2.2.3.1"></eq><ci id="A1.T1.6.m2.2.3.2.cmml" xref="A1.T1.6.m2.2.3.2">𝝍</ci><list id="A1.T1.6.m2.2.3.3.1.cmml" xref="A1.T1.6.m2.2.3.3.2"><cn type="integer" id="A1.T1.6.m2.1.1.cmml" xref="A1.T1.6.m2.1.1">11</cn><cn type="integer" id="A1.T1.6.m2.2.2.cmml" xref="A1.T1.6.m2.2.2">648</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.6.m2.2d">{\bm{\psi}}=11,648</annotation></semantics></math>, and <math id="A1.T1.7.m3.1" class="ltx_Math" alttext="d_{b}=2048" display="inline"><semantics id="A1.T1.7.m3.1b"><mrow id="A1.T1.7.m3.1.1" xref="A1.T1.7.m3.1.1.cmml"><msub id="A1.T1.7.m3.1.1.2" xref="A1.T1.7.m3.1.1.2.cmml"><mi id="A1.T1.7.m3.1.1.2.2" xref="A1.T1.7.m3.1.1.2.2.cmml">d</mi><mi id="A1.T1.7.m3.1.1.2.3" xref="A1.T1.7.m3.1.1.2.3.cmml">b</mi></msub><mo id="A1.T1.7.m3.1.1.1" xref="A1.T1.7.m3.1.1.1.cmml">=</mo><mn id="A1.T1.7.m3.1.1.3" xref="A1.T1.7.m3.1.1.3.cmml">2048</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T1.7.m3.1c"><apply id="A1.T1.7.m3.1.1.cmml" xref="A1.T1.7.m3.1.1"><eq id="A1.T1.7.m3.1.1.1.cmml" xref="A1.T1.7.m3.1.1.1"></eq><apply id="A1.T1.7.m3.1.1.2.cmml" xref="A1.T1.7.m3.1.1.2"><csymbol cd="ambiguous" id="A1.T1.7.m3.1.1.2.1.cmml" xref="A1.T1.7.m3.1.1.2">subscript</csymbol><ci id="A1.T1.7.m3.1.1.2.2.cmml" xref="A1.T1.7.m3.1.1.2.2">𝑑</ci><ci id="A1.T1.7.m3.1.1.2.3.cmml" xref="A1.T1.7.m3.1.1.2.3">𝑏</ci></apply><cn type="integer" id="A1.T1.7.m3.1.1.3.cmml" xref="A1.T1.7.m3.1.1.3">2048</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.7.m3.1d">d_{b}=2048</annotation></semantics></math>. Accuracy figures are percentages and the <math id="A1.T1.8.m4.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T1.8.m4.1b"><mo id="A1.T1.8.m4.1.1" xref="A1.T1.8.m4.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T1.8.m4.1c"><csymbol cd="latexml" id="A1.T1.8.m4.1.1.cmml" xref="A1.T1.8.m4.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.8.m4.1d">\pm</annotation></semantics></math> sign indicates the 95% confidence interval over 3 runs. Bold type indicates the highest scores (within the confidence interval).</figcaption>
<div id="A1.T1.9" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:204.8pt;vertical-align:-4.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-212.6pt,107.0pt) scale(0.48315,0.48315) ;">
<p id="A1.T1.9.1" class="ltx_p"><span id="A1.T1.9.1.1" class="ltx_text">
<span id="A1.T1.9.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:822.7pt;height:424pt;vertical-align:-10.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A1.T1.9.1.1.1.1" class="ltx_p"><span id="A1.T1.9.1.1.1.1.1" class="ltx_text">
<span id="A1.T1.9.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="A1.T1.9.1.1.1.1.1.1.2.1" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.2.1.1" class="ltx_td ltx_border_tt"></span>
<span id="A1.T1.9.1.1.1.1.1.1.2.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T1.9.1.1.1.1.1.1.2.1.3" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T1.9.1.1.1.1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_5"><span id="A1.T1.9.1.1.1.1.1.1.2.1.4.1" class="ltx_text ltx_font_bold">BiT</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.2.1.5" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T1.9.1.1.1.1.1.1.2.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_8"><span id="A1.T1.9.1.1.1.1.1.1.2.1.6.1" class="ltx_text ltx_font_bold">FiLM Transfer (FiT)</span></span></span>
<span id="A1.T1.9.1.1.1.1.1.1.3.2" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.3.2.1" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.3.2.2" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T1.9.1.1.1.1.1.1.3.2.3" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T1.9.1.1.1.1.1.1.3.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t ltx_colspan ltx_colspan_2"><span id="A1.T1.9.1.1.1.1.1.1.3.2.4.1" class="ltx_text ltx_font_bold">Standard</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.3.2.5" class="ltx_td ltx_th ltx_th_column ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.3.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t ltx_colspan ltx_colspan_2"><span id="A1.T1.9.1.1.1.1.1.1.3.2.6.1" class="ltx_text ltx_font_bold">FiLM</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.3.2.7" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T1.9.1.1.1.1.1.1.3.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t ltx_colspan ltx_colspan_2"><span id="A1.T1.9.1.1.1.1.1.1.3.2.8.1" class="ltx_text ltx_font_bold">QDA</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.3.2.9" class="ltx_td ltx_th ltx_th_column ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.3.2.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t ltx_colspan ltx_colspan_2"><span id="A1.T1.9.1.1.1.1.1.1.3.2.10.1" class="ltx_text ltx_font_bold">LDA</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.3.2.11" class="ltx_td ltx_th ltx_th_column ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.3.2.12" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t ltx_colspan ltx_colspan_2"><span id="A1.T1.9.1.1.1.1.1.1.3.2.12.1" class="ltx_text ltx_font_bold">ProtoNets</span></span></span>
<span id="A1.T1.9.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="A1.T1.9.1.1.1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Dataset</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column"><math id="A1.T1.9.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A1.T1.9.1.1.1.1.1.1.1.1.m1.1a"><mi id="A1.T1.9.1.1.1.1.1.1.1.1.m1.1.1" xref="A1.T1.9.1.1.1.1.1.1.1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.T1.9.1.1.1.1.1.1.1.1.m1.1b"><ci id="A1.T1.9.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A1.T1.9.1.1.1.1.1.1.1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.9.1.1.1.1.1.1.1.1.m1.1c">C</annotation></semantics></math></span>
<span id="A1.T1.9.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">Shot</span>
<span id="A1.T1.9.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy</span>
<span id="A1.T1.9.1.1.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">RMUS</span>
<span id="A1.T1.9.1.1.1.1.1.1.1.6" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T1.9.1.1.1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy</span>
<span id="A1.T1.9.1.1.1.1.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">RMUS</span>
<span id="A1.T1.9.1.1.1.1.1.1.1.9" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T1.9.1.1.1.1.1.1.1.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy</span>
<span id="A1.T1.9.1.1.1.1.1.1.1.11" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">RMUS</span>
<span id="A1.T1.9.1.1.1.1.1.1.1.12" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T1.9.1.1.1.1.1.1.1.13" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy</span>
<span id="A1.T1.9.1.1.1.1.1.1.1.14" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">RMUS</span>
<span id="A1.T1.9.1.1.1.1.1.1.1.15" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T1.9.1.1.1.1.1.1.1.16" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy</span>
<span id="A1.T1.9.1.1.1.1.1.1.1.17" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">RMUS</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.4.3.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_t">10</span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t">1</span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T1.9.1.1.1.1.1.1.4.3.4.1" class="ltx_text ltx_font_bold">52.7±3.9</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_t">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.6" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.7" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T1.9.1.1.1.1.1.1.4.3.7.1" class="ltx_text ltx_font_bold">47.0±14.2</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.8" class="ltx_td ltx_align_center ltx_border_t">0.0014</span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.9" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.10" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T1.9.1.1.1.1.1.1.4.3.10.1" class="ltx_text ltx_font_bold">54.0±5.7</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.11" class="ltx_td ltx_align_center ltx_border_t">0.893</span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.12" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.13" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T1.9.1.1.1.1.1.1.4.3.13.1" class="ltx_text ltx_font_bold">54.0±5.7</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.14" class="ltx_td ltx_align_center ltx_border_t">0.0014</span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.15" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.16" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T1.9.1.1.1.1.1.1.4.3.16.1" class="ltx_text ltx_font_bold">52.9±5.0</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.4.3.17" class="ltx_td ltx_align_center ltx_border_t">0.0014</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.5.4.1" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.3" class="ltx_td ltx_align_center">2</span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.4" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.5.4.4.1" class="ltx_text ltx_font_bold">69.9±2.6</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.7" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.5.4.7.1" class="ltx_text ltx_font_bold">63.4±3.6</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.8" class="ltx_td ltx_align_center">0.0014</span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.5.4.10.1" class="ltx_text ltx_font_bold">73.0±8.8</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.11" class="ltx_td ltx_align_center">0.893</span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.13" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.5.4.13.1" class="ltx_text ltx_font_bold">74.2±8.8</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.14" class="ltx_td ltx_align_center">0.0014</span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.16" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.5.4.16.1" class="ltx_text ltx_font_bold">68.9±9.4</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.5.4.17" class="ltx_td ltx_align_center">0.0014</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.6.5.1" class="ltx_td ltx_align_left">CIFAR10</span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.3" class="ltx_td ltx_align_center">5</span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.4" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.6.5.4.1" class="ltx_text ltx_font_bold">83.5±3.0</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.7" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.6.5.7.1" class="ltx_text ltx_font_bold">82.8±1.9</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.8" class="ltx_td ltx_align_center">0.0014</span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.6.5.10.1" class="ltx_text ltx_font_bold">85.4±3.9</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.11" class="ltx_td ltx_align_center">0.893</span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.13" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.6.5.13.1" class="ltx_text ltx_font_bold">86.4±4.2</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.14" class="ltx_td ltx_align_center">0.0014</span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.16" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.6.5.16.1" class="ltx_text ltx_font_bold">81.8±5.1</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.6.5.17" class="ltx_td ltx_align_center">0.0014</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.7.6.1" class="ltx_td ltx_align_left"><cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib31" title="" class="ltx_ref">2009</a>)</cite></span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.3" class="ltx_td ltx_align_center">10</span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.4" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.7.6.4.1" class="ltx_text ltx_font_bold">88.1±2.0</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.7" class="ltx_td ltx_align_center">46.1±39.7</span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.8" class="ltx_td ltx_align_center">0.0014</span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.7.6.10.1" class="ltx_text ltx_font_bold">89.5±1.3</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.11" class="ltx_td ltx_align_center">0.893</span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.13" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.7.6.13.1" class="ltx_text ltx_font_bold">90.6±1.0</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.14" class="ltx_td ltx_align_center">0.0014</span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.16" class="ltx_td ltx_align_center">87.3±2.3</span>
<span id="A1.T1.9.1.1.1.1.1.1.7.6.17" class="ltx_td ltx_align_center">0.0014</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.8.7.1" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.3" class="ltx_td ltx_align_center">All</span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.4" class="ltx_td ltx_align_center">95.9±0.2</span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.7" class="ltx_td ltx_align_center">96.0±0.2</span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.8" class="ltx_td ltx_align_center">0.0014</span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.8.7.10.1" class="ltx_text ltx_font_bold">96.4±0.0</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.11" class="ltx_td ltx_align_center">0.893</span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.13" class="ltx_td ltx_align_center">96.3±0.1</span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.14" class="ltx_td ltx_align_center">0.0014</span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.16" class="ltx_td ltx_align_center">96.0±0.1</span>
<span id="A1.T1.9.1.1.1.1.1.1.8.7.17" class="ltx_td ltx_align_center">0.0014</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.9.8.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.2" class="ltx_td ltx_align_center ltx_border_t">100</span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.3" class="ltx_td ltx_align_center ltx_border_t">1</span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T1.9.1.1.1.1.1.1.9.8.4.1" class="ltx_text ltx_font_bold">36.4±1.3</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.5" class="ltx_td ltx_align_center ltx_border_t">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.6" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.7" class="ltx_td ltx_align_center ltx_border_t">30.2±2.7</span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.8" class="ltx_td ltx_align_center ltx_border_t">0.0091</span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.9" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.10" class="ltx_td ltx_align_center ltx_border_t">33.8±0.8</span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.11" class="ltx_td ltx_align_center ltx_border_t">8.860</span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.12" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.13" class="ltx_td ltx_align_center ltx_border_t">33.8±0.8</span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.14" class="ltx_td ltx_align_center ltx_border_t">0.0091</span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.15" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.16" class="ltx_td ltx_align_center ltx_border_t">30.7±0.7</span>
<span id="A1.T1.9.1.1.1.1.1.1.9.8.17" class="ltx_td ltx_align_center ltx_border_t">0.0091</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.10.9.1" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.2" class="ltx_td ltx_align_center">100</span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.3" class="ltx_td ltx_align_center">2</span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.4" class="ltx_td ltx_align_center">48.8±0.2</span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.7" class="ltx_td ltx_align_center">43.0±2.9</span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.8" class="ltx_td ltx_align_center">0.0091</span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.10.9.10.1" class="ltx_text ltx_font_bold">55.1±1.1</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.11" class="ltx_td ltx_align_center">8.860</span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.13" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.10.9.13.1" class="ltx_text ltx_font_bold">54.5±1.0</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.14" class="ltx_td ltx_align_center">0.0091</span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.16" class="ltx_td ltx_align_center">50.6±1.8</span>
<span id="A1.T1.9.1.1.1.1.1.1.10.9.17" class="ltx_td ltx_align_center">0.0091</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.11.10.1" class="ltx_td ltx_align_left">CIFAR100</span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.2" class="ltx_td ltx_align_center">100</span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.3" class="ltx_td ltx_align_center">5</span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.4" class="ltx_td ltx_align_center">65.3±1.5</span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.7" class="ltx_td ltx_align_center">39.6±0.6</span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.8" class="ltx_td ltx_align_center">0.0091</span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.11.10.10.1" class="ltx_text ltx_font_bold">69.0±0.7</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.11" class="ltx_td ltx_align_center">8.860</span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.13" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.11.10.13.1" class="ltx_text ltx_font_bold">69.5±1.3</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.14" class="ltx_td ltx_align_center">0.0091</span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.16" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.11.10.16.1" class="ltx_text ltx_font_bold">67.9±0.7</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.11.10.17" class="ltx_td ltx_align_center">0.0091</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.12.11.1" class="ltx_td ltx_align_left"><cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib31" title="" class="ltx_ref">2009</a>)</cite></span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.2" class="ltx_td ltx_align_center">100</span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.3" class="ltx_td ltx_align_center">10</span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.4" class="ltx_td ltx_align_center">72.3±0.9</span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.7" class="ltx_td ltx_align_center">50.1±0.2</span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.8" class="ltx_td ltx_align_center">0.0091</span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.12.11.10.1" class="ltx_text ltx_font_bold">75.6±0.6</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.11" class="ltx_td ltx_align_center">8.860</span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.13" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.12.11.13.1" class="ltx_text ltx_font_bold">75.3±0.6</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.14" class="ltx_td ltx_align_center">0.0091</span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.16" class="ltx_td ltx_align_center">74.7±0.3</span>
<span id="A1.T1.9.1.1.1.1.1.1.12.11.17" class="ltx_td ltx_align_center">0.0091</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.13.12.1" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.2" class="ltx_td ltx_align_center">100</span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.3" class="ltx_td ltx_align_center">All</span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.4" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.13.12.4.1" class="ltx_text ltx_font_bold">86.1±0.1</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.7" class="ltx_td ltx_align_center">82.6±0.2</span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.8" class="ltx_td ltx_align_center">0.0091</span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.10" class="ltx_td ltx_align_center">82.1±0.1</span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.11" class="ltx_td ltx_align_center">8.860</span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.13" class="ltx_td ltx_align_center">82.6±0.2</span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.14" class="ltx_td ltx_align_center">0.0091</span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.16" class="ltx_td ltx_align_center">80.3±0.4</span>
<span id="A1.T1.9.1.1.1.1.1.1.13.12.17" class="ltx_td ltx_align_center">0.0091</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.14.13.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.2" class="ltx_td ltx_align_center ltx_border_t">102</span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.3" class="ltx_td ltx_align_center ltx_border_t">1</span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.4" class="ltx_td ltx_align_center ltx_border_t">79.8±0.7</span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.5" class="ltx_td ltx_align_center ltx_border_t">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.6" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.7" class="ltx_td ltx_align_center ltx_border_t">79.3±2.5</span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.8" class="ltx_td ltx_align_center ltx_border_t">0.0093</span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.9" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.10" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T1.9.1.1.1.1.1.1.14.13.10.1" class="ltx_text ltx_font_bold">89.6±0.9</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.11" class="ltx_td ltx_align_center ltx_border_t">9.036</span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.12" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.13" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T1.9.1.1.1.1.1.1.14.13.13.1" class="ltx_text ltx_font_bold">89.6±0.9</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.14" class="ltx_td ltx_align_center ltx_border_t">0.0093</span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.15" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.16" class="ltx_td ltx_align_center ltx_border_t">85.1±0.9</span>
<span id="A1.T1.9.1.1.1.1.1.1.14.13.17" class="ltx_td ltx_align_center ltx_border_t">0.0093</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.15.14.1" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.2" class="ltx_td ltx_align_center">102</span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.3" class="ltx_td ltx_align_center">2</span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.4" class="ltx_td ltx_align_center">89.6±1.4</span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.7" class="ltx_td ltx_align_center">91.7±0.8</span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.8" class="ltx_td ltx_align_center">0.0093</span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.15.14.10.1" class="ltx_text ltx_font_bold">95.6±0.5</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.11" class="ltx_td ltx_align_center">9.036</span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.13" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.15.14.13.1" class="ltx_text ltx_font_bold">95.6±0.7</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.14" class="ltx_td ltx_align_center">0.0093</span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.16" class="ltx_td ltx_align_center">93.0±0.9</span>
<span id="A1.T1.9.1.1.1.1.1.1.15.14.17" class="ltx_td ltx_align_center">0.0093</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.16.15.1" class="ltx_td ltx_align_left">Flowers102</span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.2" class="ltx_td ltx_align_center">102</span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.3" class="ltx_td ltx_align_center">5</span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.4" class="ltx_td ltx_align_center">96.8±0.7</span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.7" class="ltx_td ltx_align_center">96.3±0.2</span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.8" class="ltx_td ltx_align_center">0.0093</span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.16.15.10.1" class="ltx_text ltx_font_bold">98.3±0.3</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.11" class="ltx_td ltx_align_center">9.036</span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.13" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.16.15.13.1" class="ltx_text ltx_font_bold">98.4±0.3</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.14" class="ltx_td ltx_align_center">0.0093</span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.16" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.16.15.16.1" class="ltx_text ltx_font_bold">98.0±0.3</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.16.15.17" class="ltx_td ltx_align_center">0.0093</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.17.16.1" class="ltx_td ltx_align_left"><cite class="ltx_cite ltx_citemacro_citep">(Nilsback &amp; Zisserman, <a href="#bib.bib41" title="" class="ltx_ref">2008</a>)</cite></span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.2" class="ltx_td ltx_align_center">102</span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.3" class="ltx_td ltx_align_center">10</span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.4" class="ltx_td ltx_align_center">97.3±0.7</span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.7" class="ltx_td ltx_align_center">96.9±0.7</span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.8" class="ltx_td ltx_align_center">0.0093</span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.17.16.10.1" class="ltx_text ltx_font_bold">99.0±0.1</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.11" class="ltx_td ltx_align_center">9.036</span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.13" class="ltx_td ltx_align_center">98.8±0.1</span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.14" class="ltx_td ltx_align_center">0.0093</span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.16" class="ltx_td ltx_align_center">98.6±0.1</span>
<span id="A1.T1.9.1.1.1.1.1.1.17.16.17" class="ltx_td ltx_align_center">0.0093</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.18.17.1" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.2" class="ltx_td ltx_align_center">102</span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.3" class="ltx_td ltx_align_center">All</span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.4" class="ltx_td ltx_align_center">96.6±0.4</span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.7" class="ltx_td ltx_align_center">96.9±0.4</span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.8" class="ltx_td ltx_align_center">0.0093</span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.18.17.10.1" class="ltx_text ltx_font_bold">99.0±0.1</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.11" class="ltx_td ltx_align_center">9.036</span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.13" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.18.17.13.1" class="ltx_text ltx_font_bold">98.9±0.1</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.14" class="ltx_td ltx_align_center">0.0093</span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.16" class="ltx_td ltx_align_center">98.6±0.2</span>
<span id="A1.T1.9.1.1.1.1.1.1.18.17.17" class="ltx_td ltx_align_center">0.0093</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.19.18.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.2" class="ltx_td ltx_align_center ltx_border_t">37</span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.3" class="ltx_td ltx_align_center ltx_border_t">1</span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.4" class="ltx_td ltx_align_center ltx_border_t">38.3±2.3</span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.5" class="ltx_td ltx_align_center ltx_border_t">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.6" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.7" class="ltx_td ltx_align_center ltx_border_t">36.8±5.5</span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.8" class="ltx_td ltx_align_center ltx_border_t">0.0037</span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.9" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.10" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T1.9.1.1.1.1.1.1.19.18.10.1" class="ltx_text ltx_font_bold">50.2±2.8</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.11" class="ltx_td ltx_align_center ltx_border_t">3.297</span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.12" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.13" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T1.9.1.1.1.1.1.1.19.18.13.1" class="ltx_text ltx_font_bold">50.1±3.1</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.14" class="ltx_td ltx_align_center ltx_border_t">0.0037</span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.15" class="ltx_td ltx_border_t"></span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.16" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T1.9.1.1.1.1.1.1.19.18.16.1" class="ltx_text ltx_font_bold">46.6±2.0</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.19.18.17" class="ltx_td ltx_align_center ltx_border_t">0.0037</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.20.19.1" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.2" class="ltx_td ltx_align_center">37</span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.3" class="ltx_td ltx_align_center">2</span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.4" class="ltx_td ltx_align_center">61.2±2.6</span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.7" class="ltx_td ltx_align_center">60.1±3.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.8" class="ltx_td ltx_align_center">0.0037</span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.20.19.10.1" class="ltx_text ltx_font_bold">74.8±1.4</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.11" class="ltx_td ltx_align_center">3.297</span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.13" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.20.19.13.1" class="ltx_text ltx_font_bold">76.8±1.8</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.14" class="ltx_td ltx_align_center">0.0037</span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.16" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.20.19.16.1" class="ltx_text ltx_font_bold">72.8±2.7</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.20.19.17" class="ltx_td ltx_align_center">0.0037</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.21.20.1" class="ltx_td ltx_align_left">Pets</span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.2" class="ltx_td ltx_align_center">37</span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.3" class="ltx_td ltx_align_center">5</span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.4" class="ltx_td ltx_align_center">76.7±2.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.7" class="ltx_td ltx_align_center">76.8±1.5</span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.8" class="ltx_td ltx_align_center">0.0037</span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.10" class="ltx_td ltx_align_center">80.0±0.2</span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.11" class="ltx_td ltx_align_center">3.297</span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.13" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.21.20.13.1" class="ltx_text ltx_font_bold">82.5±0.4</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.14" class="ltx_td ltx_align_center">0.0037</span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.16" class="ltx_td ltx_align_center">78.4±0.7</span>
<span id="A1.T1.9.1.1.1.1.1.1.21.20.17" class="ltx_td ltx_align_center">0.0037</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.22.21.1" class="ltx_td ltx_align_left"><cite class="ltx_cite ltx_citemacro_citep">(Parkhi et al., <a href="#bib.bib43" title="" class="ltx_ref">2012</a>)</cite></span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.2" class="ltx_td ltx_align_center">37</span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.3" class="ltx_td ltx_align_center">10</span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.4" class="ltx_td ltx_align_center">78.6±5.3</span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.5" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.6" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.7" class="ltx_td ltx_align_center">79.2±4.4</span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.8" class="ltx_td ltx_align_center">0.0037</span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.9" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.10" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.22.21.10.1" class="ltx_text ltx_font_bold">86.2±1.0</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.11" class="ltx_td ltx_align_center">3.297</span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.12" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.13" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.22.21.13.1" class="ltx_text ltx_font_bold">86.9±1.5</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.14" class="ltx_td ltx_align_center">0.0037</span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.15" class="ltx_td"></span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.16" class="ltx_td ltx_align_center"><span id="A1.T1.9.1.1.1.1.1.1.22.21.16.1" class="ltx_text ltx_font_bold">85.8±0.4</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.22.21.17" class="ltx_td ltx_align_center">0.0037</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22" class="ltx_tr">
<span id="A1.T1.9.1.1.1.1.1.1.23.22.1" class="ltx_td ltx_border_bb"></span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.2" class="ltx_td ltx_align_center ltx_border_bb">37</span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.3" class="ltx_td ltx_align_center ltx_border_bb">All</span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.4" class="ltx_td ltx_align_center ltx_border_bb">90.1±0.6</span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.5" class="ltx_td ltx_align_center ltx_border_bb">1.0</span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.6" class="ltx_td ltx_border_bb"></span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.7" class="ltx_td ltx_align_center ltx_border_bb">90.1±0.2</span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.8" class="ltx_td ltx_align_center ltx_border_bb">0.0037</span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.9" class="ltx_td ltx_border_bb"></span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T1.9.1.1.1.1.1.1.23.22.10.1" class="ltx_text ltx_font_bold">91.7±0.3</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.11" class="ltx_td ltx_align_center ltx_border_bb">3.297</span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.12" class="ltx_td ltx_border_bb"></span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.13" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T1.9.1.1.1.1.1.1.23.22.13.1" class="ltx_text ltx_font_bold">91.9±0.3</span></span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.14" class="ltx_td ltx_align_center ltx_border_bb">0.0037</span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.15" class="ltx_td ltx_border_bb"></span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.16" class="ltx_td ltx_align_center ltx_border_bb">91.2±0.1</span>
<span id="A1.T1.9.1.1.1.1.1.1.23.22.17" class="ltx_td ltx_align_center ltx_border_bb">0.0037</span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</figure>
</section>
<section id="A1.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.4.2 </span>Few-shot Task Ablations</h4>

<div id="A1.SS4.SSS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS4.SSS2.p1.12" class="ltx_p"><a href="#A1.T2" title="In A.4.2 Few-shot Task Ablations ‣ A.4 Additional Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.2</span></a> shows the few-shot results for all three variants of <span id="A1.SS4.SSS2.p1.12.1" class="ltx_text ltx_font_smallcaps">FiT</span> with different ablations on how the downstream dataset <math id="A1.SS4.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="A1.SS4.SSS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.1.m1.1.1" xref="A1.SS4.SSS2.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS2.p1.1.m1.1b"><ci id="A1.SS4.SSS2.p1.1.m1.1.1.cmml" xref="A1.SS4.SSS2.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS2.p1.1.m1.1c">\mathcal{D}</annotation></semantics></math> is allocated during training.
<span id="A1.SS4.SSS2.p1.12.2" class="ltx_text ltx_font_italic">No Split</span> indicates that <math id="A1.SS4.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="A1.SS4.SSS2.p1.2.m2.1a"><msub id="A1.SS4.SSS2.p1.2.m2.1.1" xref="A1.SS4.SSS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.2.m2.1.1.2" xref="A1.SS4.SSS2.p1.2.m2.1.1.2.cmml">𝒟</mi><mrow id="A1.SS4.SSS2.p1.2.m2.1.1.3" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.cmml"><mi id="A1.SS4.SSS2.p1.2.m2.1.1.3.2" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.2.m2.1.1.3.1" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.2.m2.1.1.3.3" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.2.m2.1.1.3.1a" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.2.m2.1.1.3.4" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.2.m2.1.1.3.1b" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.2.m2.1.1.3.5" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.2.m2.1.1.3.1c" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.2.m2.1.1.3.6" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS2.p1.2.m2.1b"><apply id="A1.SS4.SSS2.p1.2.m2.1.1.cmml" xref="A1.SS4.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.2.m2.1.1.1.cmml" xref="A1.SS4.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS4.SSS2.p1.2.m2.1.1.2.cmml" xref="A1.SS4.SSS2.p1.2.m2.1.1.2">𝒟</ci><apply id="A1.SS4.SSS2.p1.2.m2.1.1.3.cmml" xref="A1.SS4.SSS2.p1.2.m2.1.1.3"><times id="A1.SS4.SSS2.p1.2.m2.1.1.3.1.cmml" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.1"></times><ci id="A1.SS4.SSS2.p1.2.m2.1.1.3.2.cmml" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.2">𝑡</ci><ci id="A1.SS4.SSS2.p1.2.m2.1.1.3.3.cmml" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.3">𝑟</ci><ci id="A1.SS4.SSS2.p1.2.m2.1.1.3.4.cmml" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.4">𝑎</ci><ci id="A1.SS4.SSS2.p1.2.m2.1.1.3.5.cmml" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.5">𝑖</ci><ci id="A1.SS4.SSS2.p1.2.m2.1.1.3.6.cmml" xref="A1.SS4.SSS2.p1.2.m2.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS2.p1.2.m2.1c">\mathcal{D}_{train}</annotation></semantics></math> is not split into two disjoint partitions and <math id="A1.SS4.SSS2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{train}=\mathcal{D}_{test}=\mathcal{D}" display="inline"><semantics id="A1.SS4.SSS2.p1.3.m3.1a"><mrow id="A1.SS4.SSS2.p1.3.m3.1.1" xref="A1.SS4.SSS2.p1.3.m3.1.1.cmml"><msub id="A1.SS4.SSS2.p1.3.m3.1.1.2" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.3.m3.1.1.2.2" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.2.cmml">𝒟</mi><mrow id="A1.SS4.SSS2.p1.3.m3.1.1.2.3" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.cmml"><mi id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.2" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.1" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.3" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.1a" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.4" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.1b" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.5" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.1c" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.6" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="A1.SS4.SSS2.p1.3.m3.1.1.3" xref="A1.SS4.SSS2.p1.3.m3.1.1.3.cmml">=</mo><msub id="A1.SS4.SSS2.p1.3.m3.1.1.4" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.3.m3.1.1.4.2" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.2.cmml">𝒟</mi><mrow id="A1.SS4.SSS2.p1.3.m3.1.1.4.3" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.cmml"><mi id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.2" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.1" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.3" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.1a" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.4" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.1b" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.5" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.5.cmml">t</mi></mrow></msub><mo id="A1.SS4.SSS2.p1.3.m3.1.1.5" xref="A1.SS4.SSS2.p1.3.m3.1.1.5.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.3.m3.1.1.6" xref="A1.SS4.SSS2.p1.3.m3.1.1.6.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS2.p1.3.m3.1b"><apply id="A1.SS4.SSS2.p1.3.m3.1.1.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1"><and id="A1.SS4.SSS2.p1.3.m3.1.1a.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1"></and><apply id="A1.SS4.SSS2.p1.3.m3.1.1b.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1"><eq id="A1.SS4.SSS2.p1.3.m3.1.1.3.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.3"></eq><apply id="A1.SS4.SSS2.p1.3.m3.1.1.2.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.3.m3.1.1.2.1.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="A1.SS4.SSS2.p1.3.m3.1.1.2.2.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.2">𝒟</ci><apply id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3"><times id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.1.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.1"></times><ci id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.2.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.2">𝑡</ci><ci id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.3.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.3">𝑟</ci><ci id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.4.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.4">𝑎</ci><ci id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.5.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.5">𝑖</ci><ci id="A1.SS4.SSS2.p1.3.m3.1.1.2.3.6.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.2.3.6">𝑛</ci></apply></apply><apply id="A1.SS4.SSS2.p1.3.m3.1.1.4.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.4"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.3.m3.1.1.4.1.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.4">subscript</csymbol><ci id="A1.SS4.SSS2.p1.3.m3.1.1.4.2.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.2">𝒟</ci><apply id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3"><times id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.1.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.1"></times><ci id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.2.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.2">𝑡</ci><ci id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.3.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.3">𝑒</ci><ci id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.4.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.4">𝑠</ci><ci id="A1.SS4.SSS2.p1.3.m3.1.1.4.3.5.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.4.3.5">𝑡</ci></apply></apply></apply><apply id="A1.SS4.SSS2.p1.3.m3.1.1c.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1"><eq id="A1.SS4.SSS2.p1.3.m3.1.1.5.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.5"></eq><share href="#A1.SS4.SSS2.p1.3.m3.1.1.4.cmml" id="A1.SS4.SSS2.p1.3.m3.1.1d.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1"></share><ci id="A1.SS4.SSS2.p1.3.m3.1.1.6.cmml" xref="A1.SS4.SSS2.p1.3.m3.1.1.6">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS2.p1.3.m3.1c">\mathcal{D}_{train}=\mathcal{D}_{test}=\mathcal{D}</annotation></semantics></math>.
However, <math id="A1.SS4.SSS2.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="A1.SS4.SSS2.p1.4.m4.1a"><msub id="A1.SS4.SSS2.p1.4.m4.1.1" xref="A1.SS4.SSS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.4.m4.1.1.2" xref="A1.SS4.SSS2.p1.4.m4.1.1.2.cmml">𝒟</mi><mrow id="A1.SS4.SSS2.p1.4.m4.1.1.3" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.cmml"><mi id="A1.SS4.SSS2.p1.4.m4.1.1.3.2" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.4.m4.1.1.3.1" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.4.m4.1.1.3.3" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.4.m4.1.1.3.1a" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.4.m4.1.1.3.4" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.4.m4.1.1.3.1b" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.4.m4.1.1.3.5" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.4.m4.1.1.3.1c" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.4.m4.1.1.3.6" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS2.p1.4.m4.1b"><apply id="A1.SS4.SSS2.p1.4.m4.1.1.cmml" xref="A1.SS4.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.4.m4.1.1.1.cmml" xref="A1.SS4.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS4.SSS2.p1.4.m4.1.1.2.cmml" xref="A1.SS4.SSS2.p1.4.m4.1.1.2">𝒟</ci><apply id="A1.SS4.SSS2.p1.4.m4.1.1.3.cmml" xref="A1.SS4.SSS2.p1.4.m4.1.1.3"><times id="A1.SS4.SSS2.p1.4.m4.1.1.3.1.cmml" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.1"></times><ci id="A1.SS4.SSS2.p1.4.m4.1.1.3.2.cmml" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.2">𝑡</ci><ci id="A1.SS4.SSS2.p1.4.m4.1.1.3.3.cmml" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.3">𝑟</ci><ci id="A1.SS4.SSS2.p1.4.m4.1.1.3.4.cmml" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.4">𝑎</ci><ci id="A1.SS4.SSS2.p1.4.m4.1.1.3.5.cmml" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.5">𝑖</ci><ci id="A1.SS4.SSS2.p1.4.m4.1.1.3.6.cmml" xref="A1.SS4.SSS2.p1.4.m4.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS2.p1.4.m4.1c">\mathcal{D}_{train}</annotation></semantics></math> and <math id="A1.SS4.SSS2.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="A1.SS4.SSS2.p1.5.m5.1a"><msub id="A1.SS4.SSS2.p1.5.m5.1.1" xref="A1.SS4.SSS2.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.5.m5.1.1.2" xref="A1.SS4.SSS2.p1.5.m5.1.1.2.cmml">𝒟</mi><mrow id="A1.SS4.SSS2.p1.5.m5.1.1.3" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.cmml"><mi id="A1.SS4.SSS2.p1.5.m5.1.1.3.2" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.5.m5.1.1.3.1" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.5.m5.1.1.3.3" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.5.m5.1.1.3.1a" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.5.m5.1.1.3.4" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.5.m5.1.1.3.1b" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.5.m5.1.1.3.5" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS2.p1.5.m5.1b"><apply id="A1.SS4.SSS2.p1.5.m5.1.1.cmml" xref="A1.SS4.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.5.m5.1.1.1.cmml" xref="A1.SS4.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="A1.SS4.SSS2.p1.5.m5.1.1.2.cmml" xref="A1.SS4.SSS2.p1.5.m5.1.1.2">𝒟</ci><apply id="A1.SS4.SSS2.p1.5.m5.1.1.3.cmml" xref="A1.SS4.SSS2.p1.5.m5.1.1.3"><times id="A1.SS4.SSS2.p1.5.m5.1.1.3.1.cmml" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.1"></times><ci id="A1.SS4.SSS2.p1.5.m5.1.1.3.2.cmml" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.2">𝑡</ci><ci id="A1.SS4.SSS2.p1.5.m5.1.1.3.3.cmml" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.3">𝑒</ci><ci id="A1.SS4.SSS2.p1.5.m5.1.1.3.4.cmml" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.4">𝑠</ci><ci id="A1.SS4.SSS2.p1.5.m5.1.1.3.5.cmml" xref="A1.SS4.SSS2.p1.5.m5.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS2.p1.5.m5.1c">\mathcal{D}_{test}</annotation></semantics></math> are sampled to form episodic fine-tuning tasks as detailed in <a href="#alg2" title="In A.10 FiT Training Algorithms ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">A.2</span></a>.
<span id="A1.SS4.SSS2.p1.12.3" class="ltx_text ltx_font_italic">Split</span> indicates that <math id="A1.SS4.SSS2.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="A1.SS4.SSS2.p1.6.m6.1a"><msub id="A1.SS4.SSS2.p1.6.m6.1.1" xref="A1.SS4.SSS2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.6.m6.1.1.2" xref="A1.SS4.SSS2.p1.6.m6.1.1.2.cmml">𝒟</mi><mrow id="A1.SS4.SSS2.p1.6.m6.1.1.3" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.cmml"><mi id="A1.SS4.SSS2.p1.6.m6.1.1.3.2" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.6.m6.1.1.3.1" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.6.m6.1.1.3.3" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.6.m6.1.1.3.1a" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.6.m6.1.1.3.4" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.6.m6.1.1.3.1b" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.6.m6.1.1.3.5" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.6.m6.1.1.3.1c" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.6.m6.1.1.3.6" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS2.p1.6.m6.1b"><apply id="A1.SS4.SSS2.p1.6.m6.1.1.cmml" xref="A1.SS4.SSS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.6.m6.1.1.1.cmml" xref="A1.SS4.SSS2.p1.6.m6.1.1">subscript</csymbol><ci id="A1.SS4.SSS2.p1.6.m6.1.1.2.cmml" xref="A1.SS4.SSS2.p1.6.m6.1.1.2">𝒟</ci><apply id="A1.SS4.SSS2.p1.6.m6.1.1.3.cmml" xref="A1.SS4.SSS2.p1.6.m6.1.1.3"><times id="A1.SS4.SSS2.p1.6.m6.1.1.3.1.cmml" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.1"></times><ci id="A1.SS4.SSS2.p1.6.m6.1.1.3.2.cmml" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.2">𝑡</ci><ci id="A1.SS4.SSS2.p1.6.m6.1.1.3.3.cmml" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.3">𝑟</ci><ci id="A1.SS4.SSS2.p1.6.m6.1.1.3.4.cmml" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.4">𝑎</ci><ci id="A1.SS4.SSS2.p1.6.m6.1.1.3.5.cmml" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.5">𝑖</ci><ci id="A1.SS4.SSS2.p1.6.m6.1.1.3.6.cmml" xref="A1.SS4.SSS2.p1.6.m6.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS2.p1.6.m6.1c">\mathcal{D}_{train}</annotation></semantics></math> is split into two disjoint partitions as detailed in <a href="#alg1" title="In A.10 FiT Training Algorithms ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">A.1</span></a> and then sampled into tasks as described in <a href="#alg2" title="In A.10 FiT Training Algorithms ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">A.2</span></a>.
<span id="A1.SS4.SSS2.p1.12.4" class="ltx_text ltx_font_italic">Use All</span> indicates that <math id="A1.SS4.SSS2.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{D}_{train}=\mathcal{D}_{test}=\mathcal{D}" display="inline"><semantics id="A1.SS4.SSS2.p1.7.m7.1a"><mrow id="A1.SS4.SSS2.p1.7.m7.1.1" xref="A1.SS4.SSS2.p1.7.m7.1.1.cmml"><msub id="A1.SS4.SSS2.p1.7.m7.1.1.2" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.7.m7.1.1.2.2" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.2.cmml">𝒟</mi><mrow id="A1.SS4.SSS2.p1.7.m7.1.1.2.3" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.cmml"><mi id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.2" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.1" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.3" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.1a" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.4" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.1b" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.5" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.1c" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.6" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="A1.SS4.SSS2.p1.7.m7.1.1.3" xref="A1.SS4.SSS2.p1.7.m7.1.1.3.cmml">=</mo><msub id="A1.SS4.SSS2.p1.7.m7.1.1.4" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.7.m7.1.1.4.2" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.2.cmml">𝒟</mi><mrow id="A1.SS4.SSS2.p1.7.m7.1.1.4.3" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.cmml"><mi id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.2" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.1" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.3" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.1a" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.4" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.1b" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.5" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.5.cmml">t</mi></mrow></msub><mo id="A1.SS4.SSS2.p1.7.m7.1.1.5" xref="A1.SS4.SSS2.p1.7.m7.1.1.5.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.7.m7.1.1.6" xref="A1.SS4.SSS2.p1.7.m7.1.1.6.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS2.p1.7.m7.1b"><apply id="A1.SS4.SSS2.p1.7.m7.1.1.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1"><and id="A1.SS4.SSS2.p1.7.m7.1.1a.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1"></and><apply id="A1.SS4.SSS2.p1.7.m7.1.1b.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1"><eq id="A1.SS4.SSS2.p1.7.m7.1.1.3.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.3"></eq><apply id="A1.SS4.SSS2.p1.7.m7.1.1.2.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.7.m7.1.1.2.1.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.2">subscript</csymbol><ci id="A1.SS4.SSS2.p1.7.m7.1.1.2.2.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.2">𝒟</ci><apply id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3"><times id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.1.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.1"></times><ci id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.2.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.2">𝑡</ci><ci id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.3.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.3">𝑟</ci><ci id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.4.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.4">𝑎</ci><ci id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.5.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.5">𝑖</ci><ci id="A1.SS4.SSS2.p1.7.m7.1.1.2.3.6.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.2.3.6">𝑛</ci></apply></apply><apply id="A1.SS4.SSS2.p1.7.m7.1.1.4.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.4"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.7.m7.1.1.4.1.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.4">subscript</csymbol><ci id="A1.SS4.SSS2.p1.7.m7.1.1.4.2.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.2">𝒟</ci><apply id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3"><times id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.1.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.1"></times><ci id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.2.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.2">𝑡</ci><ci id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.3.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.3">𝑒</ci><ci id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.4.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.4">𝑠</ci><ci id="A1.SS4.SSS2.p1.7.m7.1.1.4.3.5.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.4.3.5">𝑡</ci></apply></apply></apply><apply id="A1.SS4.SSS2.p1.7.m7.1.1c.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1"><eq id="A1.SS4.SSS2.p1.7.m7.1.1.5.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.5"></eq><share href="#A1.SS4.SSS2.p1.7.m7.1.1.4.cmml" id="A1.SS4.SSS2.p1.7.m7.1.1d.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1"></share><ci id="A1.SS4.SSS2.p1.7.m7.1.1.6.cmml" xref="A1.SS4.SSS2.p1.7.m7.1.1.6">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS2.p1.7.m7.1c">\mathcal{D}_{train}=\mathcal{D}_{test}=\mathcal{D}</annotation></semantics></math> (i.e. <math id="A1.SS4.SSS2.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="A1.SS4.SSS2.p1.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.8.m8.1.1" xref="A1.SS4.SSS2.p1.8.m8.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS2.p1.8.m8.1b"><ci id="A1.SS4.SSS2.p1.8.m8.1.1.cmml" xref="A1.SS4.SSS2.p1.8.m8.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS2.p1.8.m8.1c">\mathcal{D}</annotation></semantics></math> is not split) and that <math id="A1.SS4.SSS2.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="A1.SS4.SSS2.p1.9.m9.1a"><msub id="A1.SS4.SSS2.p1.9.m9.1.1" xref="A1.SS4.SSS2.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.9.m9.1.1.2" xref="A1.SS4.SSS2.p1.9.m9.1.1.2.cmml">𝒟</mi><mrow id="A1.SS4.SSS2.p1.9.m9.1.1.3" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.cmml"><mi id="A1.SS4.SSS2.p1.9.m9.1.1.3.2" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.9.m9.1.1.3.1" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.9.m9.1.1.3.3" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.9.m9.1.1.3.1a" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.9.m9.1.1.3.4" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.9.m9.1.1.3.1b" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.9.m9.1.1.3.5" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.9.m9.1.1.3.1c" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.9.m9.1.1.3.6" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS2.p1.9.m9.1b"><apply id="A1.SS4.SSS2.p1.9.m9.1.1.cmml" xref="A1.SS4.SSS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.9.m9.1.1.1.cmml" xref="A1.SS4.SSS2.p1.9.m9.1.1">subscript</csymbol><ci id="A1.SS4.SSS2.p1.9.m9.1.1.2.cmml" xref="A1.SS4.SSS2.p1.9.m9.1.1.2">𝒟</ci><apply id="A1.SS4.SSS2.p1.9.m9.1.1.3.cmml" xref="A1.SS4.SSS2.p1.9.m9.1.1.3"><times id="A1.SS4.SSS2.p1.9.m9.1.1.3.1.cmml" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.1"></times><ci id="A1.SS4.SSS2.p1.9.m9.1.1.3.2.cmml" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.2">𝑡</ci><ci id="A1.SS4.SSS2.p1.9.m9.1.1.3.3.cmml" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.3">𝑟</ci><ci id="A1.SS4.SSS2.p1.9.m9.1.1.3.4.cmml" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.4">𝑎</ci><ci id="A1.SS4.SSS2.p1.9.m9.1.1.3.5.cmml" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.5">𝑖</ci><ci id="A1.SS4.SSS2.p1.9.m9.1.1.3.6.cmml" xref="A1.SS4.SSS2.p1.9.m9.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS2.p1.9.m9.1c">\mathcal{D}_{train}</annotation></semantics></math> and <math id="A1.SS4.SSS2.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="A1.SS4.SSS2.p1.10.m10.1a"><msub id="A1.SS4.SSS2.p1.10.m10.1.1" xref="A1.SS4.SSS2.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.10.m10.1.1.2" xref="A1.SS4.SSS2.p1.10.m10.1.1.2.cmml">𝒟</mi><mrow id="A1.SS4.SSS2.p1.10.m10.1.1.3" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.cmml"><mi id="A1.SS4.SSS2.p1.10.m10.1.1.3.2" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.10.m10.1.1.3.1" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.10.m10.1.1.3.3" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.10.m10.1.1.3.1a" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.10.m10.1.1.3.4" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.SS4.SSS2.p1.10.m10.1.1.3.1b" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.1.cmml">​</mo><mi id="A1.SS4.SSS2.p1.10.m10.1.1.3.5" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS2.p1.10.m10.1b"><apply id="A1.SS4.SSS2.p1.10.m10.1.1.cmml" xref="A1.SS4.SSS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.10.m10.1.1.1.cmml" xref="A1.SS4.SSS2.p1.10.m10.1.1">subscript</csymbol><ci id="A1.SS4.SSS2.p1.10.m10.1.1.2.cmml" xref="A1.SS4.SSS2.p1.10.m10.1.1.2">𝒟</ci><apply id="A1.SS4.SSS2.p1.10.m10.1.1.3.cmml" xref="A1.SS4.SSS2.p1.10.m10.1.1.3"><times id="A1.SS4.SSS2.p1.10.m10.1.1.3.1.cmml" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.1"></times><ci id="A1.SS4.SSS2.p1.10.m10.1.1.3.2.cmml" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.2">𝑡</ci><ci id="A1.SS4.SSS2.p1.10.m10.1.1.3.3.cmml" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.3">𝑒</ci><ci id="A1.SS4.SSS2.p1.10.m10.1.1.3.4.cmml" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.4">𝑠</ci><ci id="A1.SS4.SSS2.p1.10.m10.1.1.3.5.cmml" xref="A1.SS4.SSS2.p1.10.m10.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS2.p1.10.m10.1c">\mathcal{D}_{test}</annotation></semantics></math> are not sampled and that <math id="A1.SS4.SSS2.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{D_{S}^{\tau}}=\mathcal{D_{Q}^{\tau}}=\mathcal{D}" display="inline"><semantics id="A1.SS4.SSS2.p1.11.m11.1a"><mrow id="A1.SS4.SSS2.p1.11.m11.1.1" xref="A1.SS4.SSS2.p1.11.m11.1.1.cmml"><msubsup id="A1.SS4.SSS2.p1.11.m11.1.1.2" xref="A1.SS4.SSS2.p1.11.m11.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.11.m11.1.1.2.2.2" xref="A1.SS4.SSS2.p1.11.m11.1.1.2.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.11.m11.1.1.2.2.3" xref="A1.SS4.SSS2.p1.11.m11.1.1.2.2.3.cmml">𝒮</mi><mi id="A1.SS4.SSS2.p1.11.m11.1.1.2.3" xref="A1.SS4.SSS2.p1.11.m11.1.1.2.3.cmml">τ</mi></msubsup><mo id="A1.SS4.SSS2.p1.11.m11.1.1.3" xref="A1.SS4.SSS2.p1.11.m11.1.1.3.cmml">=</mo><msubsup id="A1.SS4.SSS2.p1.11.m11.1.1.4" xref="A1.SS4.SSS2.p1.11.m11.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.11.m11.1.1.4.2.2" xref="A1.SS4.SSS2.p1.11.m11.1.1.4.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.11.m11.1.1.4.2.3" xref="A1.SS4.SSS2.p1.11.m11.1.1.4.2.3.cmml">𝒬</mi><mi id="A1.SS4.SSS2.p1.11.m11.1.1.4.3" xref="A1.SS4.SSS2.p1.11.m11.1.1.4.3.cmml">τ</mi></msubsup><mo id="A1.SS4.SSS2.p1.11.m11.1.1.5" xref="A1.SS4.SSS2.p1.11.m11.1.1.5.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS4.SSS2.p1.11.m11.1.1.6" xref="A1.SS4.SSS2.p1.11.m11.1.1.6.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS2.p1.11.m11.1b"><apply id="A1.SS4.SSS2.p1.11.m11.1.1.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1"><and id="A1.SS4.SSS2.p1.11.m11.1.1a.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1"></and><apply id="A1.SS4.SSS2.p1.11.m11.1.1b.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1"><eq id="A1.SS4.SSS2.p1.11.m11.1.1.3.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.3"></eq><apply id="A1.SS4.SSS2.p1.11.m11.1.1.2.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.11.m11.1.1.2.1.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.2">superscript</csymbol><apply id="A1.SS4.SSS2.p1.11.m11.1.1.2.2.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.11.m11.1.1.2.2.1.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.2">subscript</csymbol><ci id="A1.SS4.SSS2.p1.11.m11.1.1.2.2.2.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.2.2.2">𝒟</ci><ci id="A1.SS4.SSS2.p1.11.m11.1.1.2.2.3.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.2.2.3">𝒮</ci></apply><ci id="A1.SS4.SSS2.p1.11.m11.1.1.2.3.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.2.3">𝜏</ci></apply><apply id="A1.SS4.SSS2.p1.11.m11.1.1.4.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.4"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.11.m11.1.1.4.1.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.4">superscript</csymbol><apply id="A1.SS4.SSS2.p1.11.m11.1.1.4.2.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.4"><csymbol cd="ambiguous" id="A1.SS4.SSS2.p1.11.m11.1.1.4.2.1.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.4">subscript</csymbol><ci id="A1.SS4.SSS2.p1.11.m11.1.1.4.2.2.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.4.2.2">𝒟</ci><ci id="A1.SS4.SSS2.p1.11.m11.1.1.4.2.3.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.4.2.3">𝒬</ci></apply><ci id="A1.SS4.SSS2.p1.11.m11.1.1.4.3.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.4.3">𝜏</ci></apply></apply><apply id="A1.SS4.SSS2.p1.11.m11.1.1c.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1"><eq id="A1.SS4.SSS2.p1.11.m11.1.1.5.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.5"></eq><share href="#A1.SS4.SSS2.p1.11.m11.1.1.4.cmml" id="A1.SS4.SSS2.p1.11.m11.1.1d.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1"></share><ci id="A1.SS4.SSS2.p1.11.m11.1.1.6.cmml" xref="A1.SS4.SSS2.p1.11.m11.1.1.6">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS2.p1.11.m11.1c">\mathcal{D_{S}^{\tau}}=\mathcal{D_{Q}^{\tau}}=\mathcal{D}</annotation></semantics></math> for all tasks <math id="A1.SS4.SSS2.p1.12.m12.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="A1.SS4.SSS2.p1.12.m12.1a"><mi id="A1.SS4.SSS2.p1.12.m12.1.1" xref="A1.SS4.SSS2.p1.12.m12.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.SSS2.p1.12.m12.1b"><ci id="A1.SS4.SSS2.p1.12.m12.1.1.cmml" xref="A1.SS4.SSS2.p1.12.m12.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.SSS2.p1.12.m12.1c">\tau</annotation></semantics></math>.</p>
</div>
<div id="A1.SS4.SSS2.p2" class="ltx_para">
<p id="A1.SS4.SSS2.p2.1" class="ltx_p"><a href="#A1.T2" title="In A.4.2 Few-shot Task Ablations ‣ A.4 Additional Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.2</span></a> shows that <span id="A1.SS4.SSS2.p2.1.1" class="ltx_text ltx_font_italic">Use All</span> is consistently the worst option.
In general, in the few-shot case, <span id="A1.SS4.SSS2.p2.1.2" class="ltx_text ltx_font_italic">Split</span> either outperforms <span id="A1.SS4.SSS2.p2.1.3" class="ltx_text ltx_font_italic">No Split</span> (CIFAR10, Pets) or achieves the same level of performance (CIFAR100, Flowers102).
As a result, we use the <span id="A1.SS4.SSS2.p2.1.4" class="ltx_text ltx_font_italic">Split</span> option when reporting the few-shot results.</p>
</div>
<figure id="A1.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table A.2: </span>Classification accuracy for all three variants of <span id="A1.T2.12.1" class="ltx_text ltx_font_smallcaps">FiT</span> as a function of shots per class and how the downstream dataset <math id="A1.T2.6.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="A1.T2.6.m1.1b"><mi class="ltx_font_mathcaligraphic" id="A1.T2.6.m1.1.1" xref="A1.T2.6.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="A1.T2.6.m1.1c"><ci id="A1.T2.6.m1.1.1.cmml" xref="A1.T2.6.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.6.m1.1d">\mathcal{D}</annotation></semantics></math> is utilized during training on standard datasets. The backbone is BiT-M-R50x1 with <math id="A1.T2.7.m2.4" class="ltx_Math" alttext="|{\bm{\theta}}|=23,500,352" display="inline"><semantics id="A1.T2.7.m2.4b"><mrow id="A1.T2.7.m2.4.5" xref="A1.T2.7.m2.4.5.cmml"><mrow id="A1.T2.7.m2.4.5.2.2" xref="A1.T2.7.m2.4.5.2.1.cmml"><mo stretchy="false" id="A1.T2.7.m2.4.5.2.2.1" xref="A1.T2.7.m2.4.5.2.1.1.cmml">|</mo><mi id="A1.T2.7.m2.1.1" xref="A1.T2.7.m2.1.1.cmml">𝜽</mi><mo stretchy="false" id="A1.T2.7.m2.4.5.2.2.2" xref="A1.T2.7.m2.4.5.2.1.1.cmml">|</mo></mrow><mo id="A1.T2.7.m2.4.5.1" xref="A1.T2.7.m2.4.5.1.cmml">=</mo><mrow id="A1.T2.7.m2.4.5.3.2" xref="A1.T2.7.m2.4.5.3.1.cmml"><mn id="A1.T2.7.m2.2.2" xref="A1.T2.7.m2.2.2.cmml">23</mn><mo id="A1.T2.7.m2.4.5.3.2.1" xref="A1.T2.7.m2.4.5.3.1.cmml">,</mo><mn id="A1.T2.7.m2.3.3" xref="A1.T2.7.m2.3.3.cmml">500</mn><mo id="A1.T2.7.m2.4.5.3.2.2" xref="A1.T2.7.m2.4.5.3.1.cmml">,</mo><mn id="A1.T2.7.m2.4.4" xref="A1.T2.7.m2.4.4.cmml">352</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.7.m2.4c"><apply id="A1.T2.7.m2.4.5.cmml" xref="A1.T2.7.m2.4.5"><eq id="A1.T2.7.m2.4.5.1.cmml" xref="A1.T2.7.m2.4.5.1"></eq><apply id="A1.T2.7.m2.4.5.2.1.cmml" xref="A1.T2.7.m2.4.5.2.2"><abs id="A1.T2.7.m2.4.5.2.1.1.cmml" xref="A1.T2.7.m2.4.5.2.2.1"></abs><ci id="A1.T2.7.m2.1.1.cmml" xref="A1.T2.7.m2.1.1">𝜽</ci></apply><list id="A1.T2.7.m2.4.5.3.1.cmml" xref="A1.T2.7.m2.4.5.3.2"><cn type="integer" id="A1.T2.7.m2.2.2.cmml" xref="A1.T2.7.m2.2.2">23</cn><cn type="integer" id="A1.T2.7.m2.3.3.cmml" xref="A1.T2.7.m2.3.3">500</cn><cn type="integer" id="A1.T2.7.m2.4.4.cmml" xref="A1.T2.7.m2.4.4">352</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.7.m2.4d">|{\bm{\theta}}|=23,500,352</annotation></semantics></math>, <math id="A1.T2.8.m3.2" class="ltx_Math" alttext="{\bm{\psi}}=11,648" display="inline"><semantics id="A1.T2.8.m3.2b"><mrow id="A1.T2.8.m3.2.3" xref="A1.T2.8.m3.2.3.cmml"><mi id="A1.T2.8.m3.2.3.2" xref="A1.T2.8.m3.2.3.2.cmml">𝝍</mi><mo id="A1.T2.8.m3.2.3.1" xref="A1.T2.8.m3.2.3.1.cmml">=</mo><mrow id="A1.T2.8.m3.2.3.3.2" xref="A1.T2.8.m3.2.3.3.1.cmml"><mn id="A1.T2.8.m3.1.1" xref="A1.T2.8.m3.1.1.cmml">11</mn><mo id="A1.T2.8.m3.2.3.3.2.1" xref="A1.T2.8.m3.2.3.3.1.cmml">,</mo><mn id="A1.T2.8.m3.2.2" xref="A1.T2.8.m3.2.2.cmml">648</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.8.m3.2c"><apply id="A1.T2.8.m3.2.3.cmml" xref="A1.T2.8.m3.2.3"><eq id="A1.T2.8.m3.2.3.1.cmml" xref="A1.T2.8.m3.2.3.1"></eq><ci id="A1.T2.8.m3.2.3.2.cmml" xref="A1.T2.8.m3.2.3.2">𝝍</ci><list id="A1.T2.8.m3.2.3.3.1.cmml" xref="A1.T2.8.m3.2.3.3.2"><cn type="integer" id="A1.T2.8.m3.1.1.cmml" xref="A1.T2.8.m3.1.1">11</cn><cn type="integer" id="A1.T2.8.m3.2.2.cmml" xref="A1.T2.8.m3.2.2">648</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.8.m3.2d">{\bm{\psi}}=11,648</annotation></semantics></math>, and <math id="A1.T2.9.m4.1" class="ltx_Math" alttext="d_{b}=2048" display="inline"><semantics id="A1.T2.9.m4.1b"><mrow id="A1.T2.9.m4.1.1" xref="A1.T2.9.m4.1.1.cmml"><msub id="A1.T2.9.m4.1.1.2" xref="A1.T2.9.m4.1.1.2.cmml"><mi id="A1.T2.9.m4.1.1.2.2" xref="A1.T2.9.m4.1.1.2.2.cmml">d</mi><mi id="A1.T2.9.m4.1.1.2.3" xref="A1.T2.9.m4.1.1.2.3.cmml">b</mi></msub><mo id="A1.T2.9.m4.1.1.1" xref="A1.T2.9.m4.1.1.1.cmml">=</mo><mn id="A1.T2.9.m4.1.1.3" xref="A1.T2.9.m4.1.1.3.cmml">2048</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.9.m4.1c"><apply id="A1.T2.9.m4.1.1.cmml" xref="A1.T2.9.m4.1.1"><eq id="A1.T2.9.m4.1.1.1.cmml" xref="A1.T2.9.m4.1.1.1"></eq><apply id="A1.T2.9.m4.1.1.2.cmml" xref="A1.T2.9.m4.1.1.2"><csymbol cd="ambiguous" id="A1.T2.9.m4.1.1.2.1.cmml" xref="A1.T2.9.m4.1.1.2">subscript</csymbol><ci id="A1.T2.9.m4.1.1.2.2.cmml" xref="A1.T2.9.m4.1.1.2.2">𝑑</ci><ci id="A1.T2.9.m4.1.1.2.3.cmml" xref="A1.T2.9.m4.1.1.2.3">𝑏</ci></apply><cn type="integer" id="A1.T2.9.m4.1.1.3.cmml" xref="A1.T2.9.m4.1.1.3">2048</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.9.m4.1d">d_{b}=2048</annotation></semantics></math>. Accuracy figures are percentages and the <math id="A1.T2.10.m5.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T2.10.m5.1b"><mo id="A1.T2.10.m5.1.1" xref="A1.T2.10.m5.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T2.10.m5.1c"><csymbol cd="latexml" id="A1.T2.10.m5.1.1.cmml" xref="A1.T2.10.m5.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.10.m5.1d">\pm</annotation></semantics></math> sign indicates the 95% confidence interval over 3 runs.</figcaption>
<div id="A1.T2.13" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:214.9pt;vertical-align:-5.3pt;"><span class="ltx_transformed_inner" style="transform:translate(-176.8pt,93.2pt) scale(0.52919,0.52919) ;">
<p id="A1.T2.13.1" class="ltx_p"><span id="A1.T2.13.1.1" class="ltx_text">
<span id="A1.T2.13.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:751.1pt;height:406pt;vertical-align:-10.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A1.T2.13.1.1.1.1" class="ltx_p"><span id="A1.T2.13.1.1.1.1.1" class="ltx_text">
<span id="A1.T2.13.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="A1.T2.13.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_border_tt"></span>
<span id="A1.T2.13.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T2.13.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3">QDA</span>
<span id="A1.T2.13.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T2.13.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3">LDA</span>
<span id="A1.T2.13.1.1.1.1.1.1.1.1.6" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T2.13.1.1.1.1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3">ProtoNets</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="A1.T2.13.1.1.1.1.1.1.2.2.1.1" class="ltx_text ltx_font_bold">Dataset</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A1.T2.13.1.1.1.1.1.1.2.2.2.1" class="ltx_text ltx_font_bold">Shot</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">No Split</span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Split</span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Use All</span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2.6" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">No Split</span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Split</span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Use All</span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2.10" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2.11" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">No Split</span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2.12" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Split</span>
<span id="A1.T2.13.1.1.1.1.1.1.2.2.13" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Use All</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.3.3.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">1</span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">42.5±2.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">54.0±5.7</span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3.5" class="ltx_td ltx_align_left ltx_border_t">37.2±3.9</span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3.6" class="ltx_td ltx_border_t"></span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">36.7±4.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">54.0±5.7</span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3.9" class="ltx_td ltx_align_center ltx_border_t">28.5±2.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3.10" class="ltx_td ltx_border_t"></span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3.11" class="ltx_td ltx_align_center ltx_border_t">53.0±5.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3.12" class="ltx_td ltx_align_center ltx_border_t">52.9±5.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.3.3.13" class="ltx_td ltx_align_center ltx_border_t">53.0±5.1</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.4.4.1" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4.2" class="ltx_td ltx_align_center">2</span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4.3" class="ltx_td ltx_align_center">62.8±4.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4.4" class="ltx_td ltx_align_center">73.0±8.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4.5" class="ltx_td ltx_align_left">68.2±5.4</span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4.7" class="ltx_td ltx_align_center">60.4±1.6</span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4.8" class="ltx_td ltx_align_center">74.2±8.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4.9" class="ltx_td ltx_align_center">40.8±5.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4.11" class="ltx_td ltx_align_center">65.2±4.5</span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4.12" class="ltx_td ltx_align_center">68.9±9.4</span>
<span id="A1.T2.13.1.1.1.1.1.1.4.4.13" class="ltx_td ltx_align_center">65.2±4.5</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.5.5.1" class="ltx_td ltx_align_left">CIFAR10</span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5.3" class="ltx_td ltx_align_center">79.7±0.9</span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5.4" class="ltx_td ltx_align_center">85.4±3.9</span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5.5" class="ltx_td ltx_align_left">79.6±1.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5.7" class="ltx_td ltx_align_center">86.6±3.5</span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5.8" class="ltx_td ltx_align_center">86.4±4.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5.9" class="ltx_td ltx_align_center">69.4±3.5</span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5.11" class="ltx_td ltx_align_center">76.1±4.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5.12" class="ltx_td ltx_align_center">81.8±5.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.5.5.13" class="ltx_td ltx_align_center">75.6±9.3</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.6.6.1" class="ltx_td ltx_align_left"><cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib31" title="" class="ltx_ref">2009</a>)</cite></span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6.3" class="ltx_td ltx_align_center">84.2±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6.4" class="ltx_td ltx_align_center">89.5±1.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6.5" class="ltx_td ltx_align_left">84.0±0.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6.7" class="ltx_td ltx_align_center">92.3±0.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6.8" class="ltx_td ltx_align_center">90.6±1.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6.9" class="ltx_td ltx_align_center">87.3±0.9</span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6.11" class="ltx_td ltx_align_center">84.5±3.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6.12" class="ltx_td ltx_align_center">87.3±2.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.6.6.13" class="ltx_td ltx_align_center">81.9±4.5</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.7.7.1" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7.2" class="ltx_td ltx_align_center">All</span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7.3" class="ltx_td ltx_align_center">96.6±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7.4" class="ltx_td ltx_align_center">96.4±0.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7.5" class="ltx_td ltx_align_left">96.2±0.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7.7" class="ltx_td ltx_align_center">96.6±0.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7.8" class="ltx_td ltx_align_center">96.3±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7.9" class="ltx_td ltx_align_center">96.6±0.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7.11" class="ltx_td ltx_align_center">96.1±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7.12" class="ltx_td ltx_align_center">96.0±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.7.7.13" class="ltx_td ltx_align_center">95.4±0.0</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.8.8.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_t">1</span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8.3" class="ltx_td ltx_align_center ltx_border_t">33.0±3.9</span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8.4" class="ltx_td ltx_align_center ltx_border_t">33.8±0.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8.5" class="ltx_td ltx_align_left ltx_border_t">33.0±0.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8.6" class="ltx_td ltx_border_t"></span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8.7" class="ltx_td ltx_align_center ltx_border_t">32.8±2.7</span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8.8" class="ltx_td ltx_align_center ltx_border_t">33.8±0.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8.9" class="ltx_td ltx_align_center ltx_border_t">33.8±0.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8.10" class="ltx_td ltx_border_t"></span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8.11" class="ltx_td ltx_align_center ltx_border_t">30.7±0.7</span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8.12" class="ltx_td ltx_align_center ltx_border_t">30.7±0.7</span>
<span id="A1.T2.13.1.1.1.1.1.1.8.8.13" class="ltx_td ltx_align_center ltx_border_t">30.7±0.7</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.9.9.1" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9.2" class="ltx_td ltx_align_center">2</span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9.3" class="ltx_td ltx_align_center">54.5±2.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9.4" class="ltx_td ltx_align_center">55.1±1.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9.5" class="ltx_td ltx_align_left">45.6±2.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9.7" class="ltx_td ltx_align_center">55.6±1.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9.8" class="ltx_td ltx_align_center">54.5±1.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9.9" class="ltx_td ltx_align_center">45.1±3.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9.11" class="ltx_td ltx_align_center">52.3±2.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9.12" class="ltx_td ltx_align_center">50.6±1.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.9.9.13" class="ltx_td ltx_align_center">40.2±6.1</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.10.10.1" class="ltx_td ltx_align_left">CIFAR100</span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10.3" class="ltx_td ltx_align_center">69.7±1.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10.4" class="ltx_td ltx_align_center">69.0±0.7</span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10.5" class="ltx_td ltx_align_left">57.9±0.4</span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10.7" class="ltx_td ltx_align_center">69.8±1.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10.8" class="ltx_td ltx_align_center">69.5±1.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10.9" class="ltx_td ltx_align_center">57.6±1.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10.11" class="ltx_td ltx_align_center">68.7±1.5</span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10.12" class="ltx_td ltx_align_center">67.9±0.7</span>
<span id="A1.T2.13.1.1.1.1.1.1.10.10.13" class="ltx_td ltx_align_center">56.6±4.2</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.11.11.1" class="ltx_td ltx_align_left"><cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib31" title="" class="ltx_ref">2009</a>)</cite></span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11.3" class="ltx_td ltx_align_center">75.5±0.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11.4" class="ltx_td ltx_align_center">75.6±0.6</span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11.5" class="ltx_td ltx_align_left">67.6±7.9</span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11.7" class="ltx_td ltx_align_center">75.6±0.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11.8" class="ltx_td ltx_align_center">75.3±0.6</span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11.9" class="ltx_td ltx_align_center">67.0±3.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11.11" class="ltx_td ltx_align_center">74.8±0.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11.12" class="ltx_td ltx_align_center">74.7±0.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.11.11.13" class="ltx_td ltx_align_center">65.4±2.8</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.12.12.1" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12.2" class="ltx_td ltx_align_center">All</span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12.3" class="ltx_td ltx_align_center">82.4±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12.4" class="ltx_td ltx_align_center">82.1±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12.5" class="ltx_td ltx_align_left">77.2±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12.7" class="ltx_td ltx_align_center">82.6±0.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12.8" class="ltx_td ltx_align_center">82.6±0.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12.9" class="ltx_td ltx_align_center">81.1±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12.11" class="ltx_td ltx_align_center">80.6±0.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12.12" class="ltx_td ltx_align_center">80.3±0.4</span>
<span id="A1.T2.13.1.1.1.1.1.1.12.12.13" class="ltx_td ltx_align_center">78.2±0.1</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.13.13.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13.2" class="ltx_td ltx_align_center ltx_border_t">1</span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13.3" class="ltx_td ltx_align_center ltx_border_t">86.1±0.5</span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13.4" class="ltx_td ltx_align_center ltx_border_t">89.6±0.9</span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13.5" class="ltx_td ltx_align_left ltx_border_t">89.1±0.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13.6" class="ltx_td ltx_border_t"></span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13.7" class="ltx_td ltx_align_center ltx_border_t">82.1±0.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13.8" class="ltx_td ltx_align_center ltx_border_t">89.6±0.9</span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13.9" class="ltx_td ltx_align_center ltx_border_t">89.6±0.9</span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13.10" class="ltx_td ltx_border_t"></span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13.11" class="ltx_td ltx_align_center ltx_border_t">85.1±0.9</span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13.12" class="ltx_td ltx_align_center ltx_border_t">85.1±0.9</span>
<span id="A1.T2.13.1.1.1.1.1.1.13.13.13" class="ltx_td ltx_align_center ltx_border_t">85.1±0.9</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.14.14.1" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14.2" class="ltx_td ltx_align_center">2</span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14.3" class="ltx_td ltx_align_center">95.2±0.6</span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14.4" class="ltx_td ltx_align_center">95.6±0.5</span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14.5" class="ltx_td ltx_align_left">94.4±0.6</span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14.7" class="ltx_td ltx_align_center">95.6±0.5</span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14.8" class="ltx_td ltx_align_center">95.6±0.7</span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14.9" class="ltx_td ltx_align_center">94.9±0.5</span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14.11" class="ltx_td ltx_align_center">93.9±1.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14.12" class="ltx_td ltx_align_center">93.0±0.9</span>
<span id="A1.T2.13.1.1.1.1.1.1.14.14.13" class="ltx_td ltx_align_center">91.9±1.2</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.15.15.1" class="ltx_td ltx_align_left">Flowers102</span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15.3" class="ltx_td ltx_align_center">98.4±0.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15.4" class="ltx_td ltx_align_center">98.3±0.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15.5" class="ltx_td ltx_align_left">98.2±0.4</span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15.7" class="ltx_td ltx_align_center">98.5±0.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15.8" class="ltx_td ltx_align_center">98.4±0.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15.9" class="ltx_td ltx_align_center">97.4±0.4</span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15.11" class="ltx_td ltx_align_center">98.1±0.4</span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15.12" class="ltx_td ltx_align_center">98.0±0.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.15.15.13" class="ltx_td ltx_align_center">96.6±0.6</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.16.16.1" class="ltx_td ltx_align_left"><cite class="ltx_cite ltx_citemacro_citep">(Nilsback &amp; Zisserman, <a href="#bib.bib41" title="" class="ltx_ref">2008</a>)</cite></span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16.3" class="ltx_td ltx_align_center">99.0±0.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16.4" class="ltx_td ltx_align_center">99.0±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16.5" class="ltx_td ltx_align_left">98.9±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16.7" class="ltx_td ltx_align_center">98.9±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16.8" class="ltx_td ltx_align_center">98.8±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16.9" class="ltx_td ltx_align_center">98.5±0.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16.11" class="ltx_td ltx_align_center">98.6±0.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16.12" class="ltx_td ltx_align_center">98.6±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.16.16.13" class="ltx_td ltx_align_center">96.7±0.0</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.17.17.1" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17.2" class="ltx_td ltx_align_center">All</span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17.3" class="ltx_td ltx_align_center">99.1±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17.4" class="ltx_td ltx_align_center">99.0±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17.5" class="ltx_td ltx_align_left">98.8±0.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17.7" class="ltx_td ltx_align_center">99.0±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17.8" class="ltx_td ltx_align_center">98.9±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17.9" class="ltx_td ltx_align_center">98.4±0.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17.11" class="ltx_td ltx_align_center">98.8±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17.12" class="ltx_td ltx_align_center">98.6±0.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.17.17.13" class="ltx_td ltx_align_center">96.7±0.0</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.18.18.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18.2" class="ltx_td ltx_align_center ltx_border_t">1</span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18.3" class="ltx_td ltx_align_center ltx_border_t">29.4±3.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18.4" class="ltx_td ltx_align_center ltx_border_t">50.2±2.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18.5" class="ltx_td ltx_align_left ltx_border_t">50.2±2.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18.6" class="ltx_td ltx_border_t"></span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18.7" class="ltx_td ltx_align_center ltx_border_t">17.2±6.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18.8" class="ltx_td ltx_align_center ltx_border_t">50.1±3.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18.9" class="ltx_td ltx_align_center ltx_border_t">50.0±3.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18.10" class="ltx_td ltx_border_t"></span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18.11" class="ltx_td ltx_align_center ltx_border_t">46.6±2.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18.12" class="ltx_td ltx_align_center ltx_border_t">46.6±2.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.18.18.13" class="ltx_td ltx_align_center ltx_border_t">46.6±2.0</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.19.19.1" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19.2" class="ltx_td ltx_align_center">2</span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19.3" class="ltx_td ltx_align_center">53.0±2.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19.4" class="ltx_td ltx_align_center">74.8±1.4</span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19.5" class="ltx_td ltx_align_left">64.2±0.7</span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19.7" class="ltx_td ltx_align_center">49.4±5.7</span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19.8" class="ltx_td ltx_align_center">76.8±1.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19.9" class="ltx_td ltx_align_center">53.4±2.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19.11" class="ltx_td ltx_align_center">60.1±0.4</span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19.12" class="ltx_td ltx_align_center">72.8±2.7</span>
<span id="A1.T2.13.1.1.1.1.1.1.19.19.13" class="ltx_td ltx_align_center">60.1±0.4</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.20.20.1" class="ltx_td ltx_align_left">Pets</span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20.3" class="ltx_td ltx_align_center">81.2±2.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20.4" class="ltx_td ltx_align_center">80.0±0.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20.5" class="ltx_td ltx_align_left">73.6±1.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20.7" class="ltx_td ltx_align_center">82.1±2.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20.8" class="ltx_td ltx_align_center">82.5±0.4</span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20.9" class="ltx_td ltx_align_center">71.0±3.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20.11" class="ltx_td ltx_align_center">83.0±2.4</span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20.12" class="ltx_td ltx_align_center">78.4±0.7</span>
<span id="A1.T2.13.1.1.1.1.1.1.20.20.13" class="ltx_td ltx_align_center">67.4±6.2</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.21.21.1" class="ltx_td ltx_align_left"><cite class="ltx_cite ltx_citemacro_citep">(Parkhi et al., <a href="#bib.bib43" title="" class="ltx_ref">2012</a>)</cite></span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21.3" class="ltx_td ltx_align_center">87.3±1.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21.4" class="ltx_td ltx_align_center">86.2±1.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21.5" class="ltx_td ltx_align_left">80.0±6.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21.6" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21.7" class="ltx_td ltx_align_center">87.1±0.8</span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21.8" class="ltx_td ltx_align_center">86.9±1.5</span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21.9" class="ltx_td ltx_align_center">81.6±1.6</span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21.10" class="ltx_td"></span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21.11" class="ltx_td ltx_align_center">87.1±1.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21.12" class="ltx_td ltx_align_center">85.8±0.4</span>
<span id="A1.T2.13.1.1.1.1.1.1.21.21.13" class="ltx_td ltx_align_center">79.2±2.0</span></span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22" class="ltx_tr">
<span id="A1.T2.13.1.1.1.1.1.1.22.22.1" class="ltx_td ltx_border_bb"></span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22.2" class="ltx_td ltx_align_center ltx_border_bb">All</span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22.3" class="ltx_td ltx_align_center ltx_border_bb">92.1±0.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22.4" class="ltx_td ltx_align_center ltx_border_bb">91.7±0.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22.5" class="ltx_td ltx_align_left ltx_border_bb">77.8±0.0</span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22.6" class="ltx_td ltx_border_bb"></span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22.7" class="ltx_td ltx_align_center ltx_border_bb">91.8±0.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22.8" class="ltx_td ltx_align_center ltx_border_bb">91.9±0.3</span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22.9" class="ltx_td ltx_align_center ltx_border_bb">88.3±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22.10" class="ltx_td ltx_border_bb"></span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22.11" class="ltx_td ltx_align_center ltx_border_bb">91.8±0.2</span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22.12" class="ltx_td ltx_align_center ltx_border_bb">91.2±0.1</span>
<span id="A1.T2.13.1.1.1.1.1.1.22.22.13" class="ltx_td ltx_align_center ltx_border_bb">82.4±0.4</span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</figure>
</section>
</section>
<section id="A1.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Additional VTAB-1k Results</h3>

<div id="A1.SS5.p1" class="ltx_para">
<p id="A1.SS5.p1.1" class="ltx_p"><a href="#A1.T3" title="In A.5 Additional VTAB-1k Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.3</span></a> depicts a more comprehensive version of <a href="#S4.T2" title="In 4.2 VTAB-1k Results ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">2</span></a> including error bars and RMUS for each dataset.</p>
</div>
<figure id="A1.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table A.3: </span><span id="A1.T3.6.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FiT<span id="A1.T3.6.1.1" class="ltx_text ltx_font_upright"> outperforms BiT on VTAB-1k.</span></span> Classification accuracy and Relative Model Update Size (RMUS) for all three variants of <span id="A1.T3.7.2" class="ltx_text ltx_font_smallcaps">FiT</span> and BiT on the VTAB-1k benchmark. The backbone is BiT-M-R50x1. Accuracy figures are percentages and the <math id="A1.T3.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T3.2.m1.1b"><mo id="A1.T3.2.m1.1.1" xref="A1.T3.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T3.2.m1.1c"><csymbol cd="latexml" id="A1.T3.2.m1.1.1.cmml" xref="A1.T3.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.m1.1d">\pm</annotation></semantics></math> sign indicates the 95% confidence interval over 3 runs. Bold type indicates the highest scores (within the confidence interval).</figcaption>
<div id="A1.T3.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:287.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-124.9pt,90.3pt) scale(0.61417,0.61417) ;">
<p id="A1.T3.3.1" class="ltx_p"><span id="A1.T3.3.1.1" class="ltx_text">
<span id="A1.T3.3.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:647.2pt;height:468pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A1.T3.3.1.1.1.1" class="ltx_p"><span id="A1.T3.3.1.1.1.1.1" class="ltx_text">
<span id="A1.T3.3.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="A1.T3.3.1.1.1.1.1.1.2.1" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.2.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></span>
<span id="A1.T3.3.1.1.1.1.1.1.2.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></span>
<span id="A1.T3.3.1.1.1.1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2"><span id="A1.T3.3.1.1.1.1.1.1.2.1.3.1" class="ltx_text ltx_font_bold">BiT</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.2.1.4" class="ltx_td ltx_border_tt"></span>
<span id="A1.T3.3.1.1.1.1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_8"><span id="A1.T3.3.1.1.1.1.1.1.2.1.5.1" class="ltx_text ltx_font_bold">FiLM Transfer (FiT)</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.2.1.6" class="ltx_td ltx_border_tt"></span>
<span id="A1.T3.3.1.1.1.1.1.1.2.1.7" class="ltx_td ltx_border_tt"></span></span>
<span id="A1.T3.3.1.1.1.1.1.1.3.2" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.3.2.1" class="ltx_td ltx_th ltx_th_row"></span>
<span id="A1.T3.3.1.1.1.1.1.1.3.2.2" class="ltx_td ltx_th ltx_th_row"></span>
<span id="A1.T3.3.1.1.1.1.1.1.3.2.3" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.3.2.4" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.3.2.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.3.2.6" class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2"><span id="A1.T3.3.1.1.1.1.1.1.3.2.6.1" class="ltx_text ltx_font_bold">QDA</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.3.2.7" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.3.2.8" class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2"><span id="A1.T3.3.1.1.1.1.1.1.3.2.8.1" class="ltx_text ltx_font_bold">LDA</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.3.2.9" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.3.2.10" class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2"><span id="A1.T3.3.1.1.1.1.1.1.3.2.10.1" class="ltx_text ltx_font_bold">ProtoNets</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.3.2.11" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.3.2.12" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.3.2.12.1" class="ltx_text ltx_font_bold">EffNetV2-M</span></span></span>
<span id="A1.T3.3.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A1.T3.3.1.1.1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Dataset</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="A1.T3.3.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A1.T3.3.1.1.1.1.1.1.1.1.m1.1a"><mi id="A1.T3.3.1.1.1.1.1.1.1.1.m1.1.1" xref="A1.T3.3.1.1.1.1.1.1.1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.T3.3.1.1.1.1.1.1.1.1.m1.1b"><ci id="A1.T3.3.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A1.T3.3.1.1.1.1.1.1.1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.3.1.1.1.1.1.1.1.1.m1.1c">C</annotation></semantics></math></span>
<span id="A1.T3.3.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_center">Accuracy↑</span>
<span id="A1.T3.3.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center">RMUS↓</span>
<span id="A1.T3.3.1.1.1.1.1.1.1.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_t">Accuracy↑</span>
<span id="A1.T3.3.1.1.1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_border_t">RMUS↓</span>
<span id="A1.T3.3.1.1.1.1.1.1.1.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.1.9" class="ltx_td ltx_align_center ltx_border_t">Accuracy↑</span>
<span id="A1.T3.3.1.1.1.1.1.1.1.10" class="ltx_td ltx_align_center ltx_border_t">RMUS↓</span>
<span id="A1.T3.3.1.1.1.1.1.1.1.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.1.12" class="ltx_td ltx_align_center ltx_border_t">Accuracy↑</span>
<span id="A1.T3.3.1.1.1.1.1.1.1.13" class="ltx_td ltx_align_center ltx_border_t">RMUS↓</span>
<span id="A1.T3.3.1.1.1.1.1.1.1.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.1.15" class="ltx_td ltx_align_center ltx_border_t">Accuracy↑</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Caltech101</span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">102</span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t">88.0±0.2</span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_t">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.4.3.6.1" class="ltx_text ltx_font_bold">90.3±0.8</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.7" class="ltx_td ltx_align_center ltx_border_t">9.04</span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.8" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.9" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.4.3.9.1" class="ltx_text ltx_font_bold">90.4±0.8</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.10" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.4.3.10.1" class="ltx_text ltx_font_bold">0.0093</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.11" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.12" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.4.3.12.1" class="ltx_text ltx_font_bold">89.6±0.2</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.13" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.4.3.13.1" class="ltx_text ltx_font_bold">0.0093</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.14" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.4.3.15" class="ltx_td ltx_align_center ltx_border_t">96.1±0.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CIFAR100</span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">100</span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.3" class="ltx_td ltx_align_center">70.1±0.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.6" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.5.4.6.1" class="ltx_text ltx_font_bold">74.1±0.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.7" class="ltx_td ltx_align_center">8.86</span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.9" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.5.4.9.1" class="ltx_text ltx_font_bold">74.2±0.5</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.5.4.10.1" class="ltx_text ltx_font_bold">0.0091</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.12" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.5.4.12.1" class="ltx_text ltx_font_bold">73.9±0.3</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.5.4.13.1" class="ltx_text ltx_font_bold">0.0091</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.5.4.15" class="ltx_td ltx_align_center">81.3±0.2</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Flowers102</span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">102</span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.3" class="ltx_td ltx_align_center">98.6±0.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.6" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.6.5.6.1" class="ltx_text ltx_font_bold">99.1±0.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.7" class="ltx_td ltx_align_center">9.04</span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.9" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.6.5.9.1" class="ltx_text ltx_font_bold">99.0±0.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.6.5.10.1" class="ltx_text ltx_font_bold">0.0093</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.12" class="ltx_td ltx_align_center">98.6±0.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.6.5.13.1" class="ltx_text ltx_font_bold">0.0093</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.6.5.15" class="ltx_td ltx_align_center">99.6±0.0</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Pets</span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">37</span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.3" class="ltx_td ltx_align_center">88.4±0.2</span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.6" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.7.6.6.1" class="ltx_text ltx_font_bold">91.0±0.3</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.7" class="ltx_td ltx_align_center">3.30</span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.9" class="ltx_td ltx_align_center">90.5±0.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.7.6.10.1" class="ltx_text ltx_font_bold">0.0037</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.12" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.7.6.12.1" class="ltx_text ltx_font_bold">90.8±0.2</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.7.6.13.1" class="ltx_text ltx_font_bold">0.0037</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.7.6.15" class="ltx_td ltx_align_center">93.0±0.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Sun397</span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">397</span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.3" class="ltx_td ltx_align_center">48.0±0.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.6" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.8.7.6.1" class="ltx_text ltx_font_bold">51.1±0.7</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.7" class="ltx_td ltx_align_center">34.29</span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.9" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.8.7.9.1" class="ltx_text ltx_font_bold">51.6±0.5</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.8.7.10.1" class="ltx_text ltx_font_bold">0.0339</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.12" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.8.7.12.1" class="ltx_text ltx_font_bold">51.5±1.4</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.8.7.13.1" class="ltx_text ltx_font_bold">0.0339</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.8.7.15" class="ltx_td ltx_align_center">47.9±0.5</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SVHN</span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">10</span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.3" class="ltx_td ltx_align_center">73.0±0.2</span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.6" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.9.8.6.1" class="ltx_text ltx_font_bold">75.1±1.3</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.7" class="ltx_td ltx_align_center">0.89</span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.9" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.9.8.9.1" class="ltx_text ltx_font_bold">74.2±0.9</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.9.8.10.1" class="ltx_text ltx_font_bold">0.0014</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.12" class="ltx_td ltx_align_center">50.1±2.2</span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.9.8.13.1" class="ltx_text ltx_font_bold">0.0014</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.9.8.15" class="ltx_td ltx_align_center">85.1±1.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">DTD</span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">47</span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.3" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.10.9.3.1" class="ltx_text ltx_font_bold">72.7±0.3</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.6" class="ltx_td ltx_align_center">70.9±0.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.7" class="ltx_td ltx_align_center">4.18</span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.9" class="ltx_td ltx_align_center">70.9±0.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.10.9.10.1" class="ltx_text ltx_font_bold">0.0046</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.12" class="ltx_td ltx_align_center">68.2±1.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.10.9.13.1" class="ltx_text ltx_font_bold">0.0046</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.10.9.15" class="ltx_td ltx_align_center">72.4±0.6</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">EuroSAT</span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">10</span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.3" class="ltx_td ltx_align_center ltx_border_t">95.3±0.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.4" class="ltx_td ltx_align_center ltx_border_t">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.6" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.11.10.6.1" class="ltx_text ltx_font_bold">95.6±0.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.7" class="ltx_td ltx_align_center ltx_border_t">0.89</span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.8" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.9" class="ltx_td ltx_align_center ltx_border_t">95.1±0.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.10" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.11.10.10.1" class="ltx_text ltx_font_bold">0.0014</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.11" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.12" class="ltx_td ltx_align_center ltx_border_t">93.8±0.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.13" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.11.10.13.1" class="ltx_text ltx_font_bold">0.0014</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.14" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.11.10.15" class="ltx_td ltx_align_center ltx_border_t">96.0±0.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Resics45</span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">45</span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.3" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.12.11.3.1" class="ltx_text ltx_font_bold">85.9±0.0</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.6" class="ltx_td ltx_align_center">82.6±0.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.7" class="ltx_td ltx_align_center">4.01</span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.9" class="ltx_td ltx_align_center">82.5±0.2</span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.12.11.10.1" class="ltx_text ltx_font_bold">0.0044</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.12" class="ltx_td ltx_align_center">77.0±0.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.12.11.13.1" class="ltx_text ltx_font_bold">0.0044</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.12.11.15" class="ltx_td ltx_align_center">86.1±0.4</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.13.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Patch Camelyon</span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">2</span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.3" class="ltx_td ltx_align_center">69.3±0.8</span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.6" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.13.12.6.1" class="ltx_text ltx_font_bold">80.7±1.2</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.7" class="ltx_td ltx_align_center">0.18</span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.9" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.13.12.9.1" class="ltx_text ltx_font_bold">82.5±0.7</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.13.12.10.1" class="ltx_text ltx_font_bold">0.0007</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.12" class="ltx_td ltx_align_center">79.9±0.2</span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.13.12.13.1" class="ltx_text ltx_font_bold">0.0007</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.13.12.15" class="ltx_td ltx_align_center">82.9±1.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.14.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Retinopathy</span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.3" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.14.13.3.1" class="ltx_text ltx_font_bold">77.2±0.6</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.6" class="ltx_td ltx_align_center">70.4±0.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.7" class="ltx_td ltx_align_center">0.45</span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.9" class="ltx_td ltx_align_center">66.2±0.5</span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.14.13.10.1" class="ltx_text ltx_font_bold">0.0009</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.12" class="ltx_td ltx_align_center">57.9±0.3</span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.14.13.13.1" class="ltx_text ltx_font_bold">0.0009</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.14.13.15" class="ltx_td ltx_align_center">72.1±0.6</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.15.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">CLEVR-count</span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">8</span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.3" class="ltx_td ltx_align_center ltx_border_t">54.6±7.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.4" class="ltx_td ltx_align_center ltx_border_t">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.6" class="ltx_td ltx_align_center ltx_border_t">87.1±0.3</span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.7" class="ltx_td ltx_align_center ltx_border_t">0.71</span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.8" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.9" class="ltx_td ltx_align_center ltx_border_t">85.6±0.9</span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.10" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.15.14.10.1" class="ltx_text ltx_font_bold">0.0012</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.11" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.12" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.15.14.12.1" class="ltx_text ltx_font_bold">88.7±0.3</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.13" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.15.14.13.1" class="ltx_text ltx_font_bold">0.0012</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.14" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.15.14.15" class="ltx_td ltx_align_center ltx_border_t">94.9±0.5</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.16.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CLEVR-dist</span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">6</span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.3" class="ltx_td ltx_align_center">47.9±0.8</span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.6" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.16.15.6.1" class="ltx_text ltx_font_bold">58.1±0.8</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.7" class="ltx_td ltx_align_center">0.54</span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.9" class="ltx_td ltx_align_center">56.1±0.8</span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.16.15.10.1" class="ltx_text ltx_font_bold">0.0010</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.12" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.16.15.12.1" class="ltx_text ltx_font_bold">58.3±0.6</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.16.15.13.1" class="ltx_text ltx_font_bold">0.0010</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.16.15.15" class="ltx_td ltx_align_center">60.9±2.0</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.17.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">dSprites-loc</span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">16</span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.3" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.17.16.3.1" class="ltx_text ltx_font_bold">91.6±1.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.6" class="ltx_td ltx_align_center">77.1±2.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.7" class="ltx_td ltx_align_center">1.43</span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.9" class="ltx_td ltx_align_center">74.8±1.4</span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.17.16.10.1" class="ltx_text ltx_font_bold">0.0019</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.12" class="ltx_td ltx_align_center">68.6±2.4</span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.17.16.13.1" class="ltx_text ltx_font_bold">0.0019</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.17.16.15" class="ltx_td ltx_align_center">94.8±0.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.18.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">dSprites-ori</span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">16</span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.3" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.18.17.3.1" class="ltx_text ltx_font_bold">65.9±0.3</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.6" class="ltx_td ltx_align_center">56.7±0.3</span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.7" class="ltx_td ltx_align_center">1.43</span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.9" class="ltx_td ltx_align_center">51.3±0.7</span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.18.17.10.1" class="ltx_text ltx_font_bold">0.0019</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.12" class="ltx_td ltx_align_center">34.2±0.8</span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.18.17.13.1" class="ltx_text ltx_font_bold">0.0019</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.18.17.15" class="ltx_td ltx_align_center">60.8±1.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.19.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SmallNORB-azi</span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">18</span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.3" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.19.18.3.1" class="ltx_text ltx_font_bold">18.7±0.2</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.6" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.19.18.6.1" class="ltx_text ltx_font_bold">18.9±0.6</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.7" class="ltx_td ltx_align_center">1.61</span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.9" class="ltx_td ltx_align_center">16.2±0.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.19.18.10.1" class="ltx_text ltx_font_bold">0.0021</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.12" class="ltx_td ltx_align_center">13.5±0.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.19.18.13.1" class="ltx_text ltx_font_bold">0.0021</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.19.18.15" class="ltx_td ltx_align_center">16.9±1.0</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.20.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SmallNORB-elev</span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">9</span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.3" class="ltx_td ltx_align_center">25.8±0.9</span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.6" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.20.19.6.1" class="ltx_text ltx_font_bold">40.4±0.2</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.7" class="ltx_td ltx_align_center">0.80</span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.9" class="ltx_td ltx_align_center">37.0±0.6</span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.20.19.10.1" class="ltx_text ltx_font_bold">0.0013</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.12" class="ltx_td ltx_align_center">35.0±0.6</span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.20.19.13.1" class="ltx_text ltx_font_bold">0.0013</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.20.19.15" class="ltx_td ltx_align_center">53.5±1.3</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.21.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">DMLab</span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">6</span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.3" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.21.20.3.1" class="ltx_text ltx_font_bold">47.1±0.1</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.6" class="ltx_td ltx_align_center">43.8±0.3</span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.7" class="ltx_td ltx_align_center">0.54</span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.9" class="ltx_td ltx_align_center">41.6±0.6</span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.21.20.10.1" class="ltx_text ltx_font_bold">0.0010</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.12" class="ltx_td ltx_align_center">39.3±0.3</span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.21.20.13.1" class="ltx_text ltx_font_bold">0.0010</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.21.20.15" class="ltx_td ltx_align_center">45.6±1.3</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.22.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">KITTI-dist</span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">4</span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.3" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.22.21.3.1" class="ltx_text ltx_font_bold">80.1±0.9</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.4" class="ltx_td ltx_align_center">1.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.6" class="ltx_td ltx_align_center">77.5±0.7</span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.7" class="ltx_td ltx_align_center">0.36</span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.9" class="ltx_td ltx_align_center">77.7±0.8</span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.10" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.22.21.10.1" class="ltx_text ltx_font_bold">0.0008</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.12" class="ltx_td ltx_align_center">75.3±0.2</span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.13" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.22.21.13.1" class="ltx_text ltx_font_bold">0.0008</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.22.21.15" class="ltx_td ltx_align_center">82.2±0.4</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.23.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">All</span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.2" class="ltx_td ltx_th ltx_th_row ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.3" class="ltx_td ltx_align_center ltx_border_t">68.3</span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.4" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.6" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T3.3.1.1.1.1.1.1.23.22.6.1" class="ltx_text ltx_font_bold">70.6</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.7" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.8" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.9" class="ltx_td ltx_align_center ltx_border_t">69.3</span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.10" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.11" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.12" class="ltx_td ltx_align_center ltx_border_t">65.5</span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.13" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.14" class="ltx_td ltx_border_t"></span>
<span id="A1.T3.3.1.1.1.1.1.1.23.22.15" class="ltx_td ltx_align_center ltx_border_t">74.9</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.24.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Natural</span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.2" class="ltx_td ltx_th ltx_th_row"></span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.3" class="ltx_td ltx_align_center">77.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.4" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.6" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.24.23.6.1" class="ltx_text ltx_font_bold">78.8</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.7" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.9" class="ltx_td ltx_align_center">78.7</span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.10" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.12" class="ltx_td ltx_align_center">74.7</span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.13" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.24.23.15" class="ltx_td ltx_align_center">82.2</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.25.24.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Specialized</span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.2" class="ltx_td ltx_th ltx_th_row"></span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.3" class="ltx_td ltx_align_center">81.9</span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.4" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.5" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.6" class="ltx_td ltx_align_center"><span id="A1.T3.3.1.1.1.1.1.1.25.24.6.1" class="ltx_text ltx_font_bold">82.3</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.7" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.8" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.9" class="ltx_td ltx_align_center">81.5</span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.10" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.11" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.12" class="ltx_td ltx_align_center">77.1</span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.13" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.14" class="ltx_td"></span>
<span id="A1.T3.3.1.1.1.1.1.1.25.24.15" class="ltx_td ltx_align_center">84.3</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25" class="ltx_tr">
<span id="A1.T3.3.1.1.1.1.1.1.26.25.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Structured</span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.2" class="ltx_td ltx_th ltx_th_row ltx_border_bb"></span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.3" class="ltx_td ltx_align_center ltx_border_bb">54.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.4" class="ltx_td ltx_border_bb"></span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.5" class="ltx_td ltx_border_bb"></span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T3.3.1.1.1.1.1.1.26.25.6.1" class="ltx_text ltx_font_bold">57.5</span></span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.7" class="ltx_td ltx_border_bb"></span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.8" class="ltx_td ltx_border_bb"></span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.9" class="ltx_td ltx_align_center ltx_border_bb">55.0</span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.10" class="ltx_td ltx_border_bb"></span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.11" class="ltx_td ltx_border_bb"></span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.12" class="ltx_td ltx_align_center ltx_border_bb">51.6</span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.13" class="ltx_td ltx_border_bb"></span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.14" class="ltx_td ltx_border_bb"></span>
<span id="A1.T3.3.1.1.1.1.1.1.26.25.15" class="ltx_td ltx_align_center ltx_border_bb">63.7</span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</figure>
<section id="A1.SS5.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.5.1 </span>VTAB-1k Task Ablations</h4>

<div id="A1.SS5.SSS1.p1" class="ltx_para">
<p id="A1.SS5.SSS1.p1.1" class="ltx_p"><a href="#A1.T4" title="In A.5.1 VTAB-1k Task Ablations ‣ A.5 Additional VTAB-1k Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.4</span></a> shows the VTAB-1k results for all three variants of <span id="A1.SS5.SSS1.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> with different ablations on how the downstream dataset <math id="A1.SS5.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="A1.SS5.SSS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS5.SSS1.p1.1.m1.1.1" xref="A1.SS5.SSS1.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p1.1.m1.1b"><ci id="A1.SS5.SSS1.p1.1.m1.1.1.cmml" xref="A1.SS5.SSS1.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p1.1.m1.1c">\mathcal{D}</annotation></semantics></math> is allocated during training.
Refer to <a href="#A1.SS4.SSS2" title="A.4.2 Few-shot Task Ablations ‣ A.4 Additional Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.4.2</span></a> for the meanings of <span id="A1.SS5.SSS1.p1.1.2" class="ltx_text ltx_font_italic">No Split</span>, <span id="A1.SS5.SSS1.p1.1.3" class="ltx_text ltx_font_italic">Split</span>, and <span id="A1.SS5.SSS1.p1.1.4" class="ltx_text ltx_font_italic">Use All</span>.
With some minor exceptions, the <span id="A1.SS5.SSS1.p1.1.5" class="ltx_text ltx_font_italic">Use All</span> case performs the worst.
The performance of the <span id="A1.SS5.SSS1.p1.1.6" class="ltx_text ltx_font_italic">No Split</span> and <span id="A1.SS5.SSS1.p1.1.7" class="ltx_text ltx_font_italic">Split</span> options is very close, with <span id="A1.SS5.SSS1.p1.1.8" class="ltx_text ltx_font_italic">No Split</span> being slightly better when averaged over all of the datasets.
As a result, we use the <span id="A1.SS5.SSS1.p1.1.9" class="ltx_text ltx_font_italic">No Split</span> option when reporting the VTAB-1k results.</p>
</div>
<figure id="A1.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table A.4: </span>Classification accuracy for all three variants of <span id="A1.T4.6.1" class="ltx_text ltx_font_smallcaps">FiT</span> on the VTAB-1k benchmark as a function of how the downstream dataset <math id="A1.T4.3.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="A1.T4.3.m1.1b"><mi class="ltx_font_mathcaligraphic" id="A1.T4.3.m1.1.1" xref="A1.T4.3.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="A1.T4.3.m1.1c"><ci id="A1.T4.3.m1.1.1.cmml" xref="A1.T4.3.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.3.m1.1d">\mathcal{D}</annotation></semantics></math> is utilized during training. The backbone is BiT-M-R50x1. Accuracy figures are percentages and the <math id="A1.T4.4.m2.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T4.4.m2.1b"><mo id="A1.T4.4.m2.1.1" xref="A1.T4.4.m2.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T4.4.m2.1c"><csymbol cd="latexml" id="A1.T4.4.m2.1.1.cmml" xref="A1.T4.4.m2.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.4.m2.1d">\pm</annotation></semantics></math> sign indicates the 95% confidence interval over 3 runs. Bold type indicates the highest scores.</figcaption>
<div id="A1.T4.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:231pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-188.4pt,109.5pt) scale(0.5134,0.5134) ;">
<p id="A1.T4.7.1" class="ltx_p"><span id="A1.T4.7.1.1" class="ltx_text">
<span id="A1.T4.7.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:774.2pt;height:450pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A1.T4.7.1.1.1.1" class="ltx_p"><span id="A1.T4.7.1.1.1.1.1" class="ltx_text">
<span id="A1.T4.7.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="A1.T4.7.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></span>
<span id="A1.T4.7.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_3"><span id="A1.T4.7.1.1.1.1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">QDA</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_border_tt"></span>
<span id="A1.T4.7.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_3"><span id="A1.T4.7.1.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">LDA</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_border_tt"></span>
<span id="A1.T4.7.1.1.1.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_3"><span id="A1.T4.7.1.1.1.1.1.1.1.1.6.1" class="ltx_text ltx_font_bold">ProtoNets</span></span></span>
<span id="A1.T4.7.1.1.1.1.1.1.2.2" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A1.T4.7.1.1.1.1.1.1.2.2.1.1" class="ltx_text ltx_font_bold">Dataset</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">No Split</span>
<span id="A1.T4.7.1.1.1.1.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">Split</span>
<span id="A1.T4.7.1.1.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">Use All</span>
<span id="A1.T4.7.1.1.1.1.1.1.2.2.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">No Split</span>
<span id="A1.T4.7.1.1.1.1.1.1.2.2.7" class="ltx_td ltx_align_center ltx_border_t">Split</span>
<span id="A1.T4.7.1.1.1.1.1.1.2.2.8" class="ltx_td ltx_align_center ltx_border_t">Use All</span>
<span id="A1.T4.7.1.1.1.1.1.1.2.2.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.2.2.10" class="ltx_td ltx_align_center ltx_border_t">No Split</span>
<span id="A1.T4.7.1.1.1.1.1.1.2.2.11" class="ltx_td ltx_align_center ltx_border_t">Split</span>
<span id="A1.T4.7.1.1.1.1.1.1.2.2.12" class="ltx_td ltx_align_center ltx_border_t">Use All</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.3.3" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Caltech101 <cite class="ltx_cite ltx_citemacro_citep">(Fei-Fei et al., <a href="#bib.bib14" title="" class="ltx_ref">2006</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">90.3±0.8</span>
<span id="A1.T4.7.1.1.1.1.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">90.0±0.7</span>
<span id="A1.T4.7.1.1.1.1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">85.5±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.3.3.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T4.7.1.1.1.1.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">90.4±0.8</span>
<span id="A1.T4.7.1.1.1.1.1.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">90.7±0.7</span>
<span id="A1.T4.7.1.1.1.1.1.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">87.3±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.3.3.9" class="ltx_td ltx_border_t"></span>
<span id="A1.T4.7.1.1.1.1.1.1.3.3.10" class="ltx_td ltx_align_center ltx_border_t">89.6±0.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.3.3.11" class="ltx_td ltx_align_center ltx_border_t">89.7±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.3.3.12" class="ltx_td ltx_align_center ltx_border_t">82.3±0.0</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.4.4" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CIFAR100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib31" title="" class="ltx_ref">2009</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.4.4.2" class="ltx_td ltx_align_center">74.1±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.4.4.3" class="ltx_td ltx_align_center">74.8±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.4.4.4" class="ltx_td ltx_align_center">63.4±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.4.4.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.4.4.6" class="ltx_td ltx_align_center">74.2±0.5</span>
<span id="A1.T4.7.1.1.1.1.1.1.4.4.7" class="ltx_td ltx_align_center">74.1±0.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.4.4.8" class="ltx_td ltx_align_center">69.0±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.4.4.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.4.4.10" class="ltx_td ltx_align_center">73.9±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.4.4.11" class="ltx_td ltx_align_center">73.7±0.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.4.4.12" class="ltx_td ltx_align_center">65.5±0.2</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.5.5" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Flowers102 <cite class="ltx_cite ltx_citemacro_citep">(Nilsback &amp; Zisserman, <a href="#bib.bib41" title="" class="ltx_ref">2008</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.5.5.2" class="ltx_td ltx_align_center">99.1±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.5.5.3" class="ltx_td ltx_align_center">99.0±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.5.5.4" class="ltx_td ltx_align_center">98.8±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.5.5.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.5.5.6" class="ltx_td ltx_align_center">99.0±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.5.5.7" class="ltx_td ltx_align_center">98.9±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.5.5.8" class="ltx_td ltx_align_center">98.5±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.5.5.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.5.5.10" class="ltx_td ltx_align_center">98.6±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.5.5.11" class="ltx_td ltx_align_center">98.6±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.5.5.12" class="ltx_td ltx_align_center">96.7±0.0</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.6.6" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Pets <cite class="ltx_cite ltx_citemacro_citep">(Parkhi et al., <a href="#bib.bib43" title="" class="ltx_ref">2012</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.6.6.2" class="ltx_td ltx_align_center">91.0±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.6.6.3" class="ltx_td ltx_align_center">90.4±0.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.6.6.4" class="ltx_td ltx_align_center">75.6±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.6.6.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.6.6.6" class="ltx_td ltx_align_center">90.5±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.6.6.7" class="ltx_td ltx_align_center">90.5±0.5</span>
<span id="A1.T4.7.1.1.1.1.1.1.6.6.8" class="ltx_td ltx_align_center">87.2±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.6.6.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.6.6.10" class="ltx_td ltx_align_center">90.8±0.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.6.6.11" class="ltx_td ltx_align_center">90.4±0.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.6.6.12" class="ltx_td ltx_align_center">85.6±0.0</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.7.7" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Sun397 <cite class="ltx_cite ltx_citemacro_citep">(Xiao et al., <a href="#bib.bib61" title="" class="ltx_ref">2010</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.7.7.2" class="ltx_td ltx_align_center">51.1±0.7</span>
<span id="A1.T4.7.1.1.1.1.1.1.7.7.3" class="ltx_td ltx_align_center">52.1±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.7.7.4" class="ltx_td ltx_align_center">49.3±0.7</span>
<span id="A1.T4.7.1.1.1.1.1.1.7.7.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.7.7.6" class="ltx_td ltx_align_center">51.6±0.5</span>
<span id="A1.T4.7.1.1.1.1.1.1.7.7.7" class="ltx_td ltx_align_center">50.8±0.7</span>
<span id="A1.T4.7.1.1.1.1.1.1.7.7.8" class="ltx_td ltx_align_center">42.7±3.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.7.7.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.7.7.10" class="ltx_td ltx_align_center">51.5±1.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.7.7.11" class="ltx_td ltx_align_center">50.4±0.8</span>
<span id="A1.T4.7.1.1.1.1.1.1.7.7.12" class="ltx_td ltx_align_center">42.4±4.2</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.8.8" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SVHN <cite class="ltx_cite ltx_citemacro_citep">(Netzer et al., <a href="#bib.bib40" title="" class="ltx_ref">2011</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.8.8.2" class="ltx_td ltx_align_center">75.1±1.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.8.8.3" class="ltx_td ltx_align_center">73.3±1.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.8.8.4" class="ltx_td ltx_align_center">26.2±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.8.8.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.8.8.6" class="ltx_td ltx_align_center">74.2±0.9</span>
<span id="A1.T4.7.1.1.1.1.1.1.8.8.7" class="ltx_td ltx_align_center">71.5±0.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.8.8.8" class="ltx_td ltx_align_center">67.4±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.8.8.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.8.8.10" class="ltx_td ltx_align_center">50.1±2.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.8.8.11" class="ltx_td ltx_align_center">47.4±1.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.8.8.12" class="ltx_td ltx_align_center">35.1±0.1</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.9.9" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">DTD <cite class="ltx_cite ltx_citemacro_citep">(Cimpoi et al., <a href="#bib.bib8" title="" class="ltx_ref">2014</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.9.9.2" class="ltx_td ltx_align_center">70.9±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.9.9.3" class="ltx_td ltx_align_center">70.2±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.9.9.4" class="ltx_td ltx_align_center">72.8±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.9.9.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.9.9.6" class="ltx_td ltx_align_center">70.9±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.9.9.7" class="ltx_td ltx_align_center">70.8±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.9.9.8" class="ltx_td ltx_align_center">66.5±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.9.9.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.9.9.10" class="ltx_td ltx_align_center">68.2±1.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.9.9.11" class="ltx_td ltx_align_center">68.4±1.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.9.9.12" class="ltx_td ltx_align_center">61.3±0.2</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.10.10" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">EuroSAT <cite class="ltx_cite ltx_citemacro_citep">(Helber et al., <a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_t">95.6±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_t">94.7±0.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_t">93.5±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.10.10.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T4.7.1.1.1.1.1.1.10.10.6" class="ltx_td ltx_align_center ltx_border_t">95.1±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.10.10.7" class="ltx_td ltx_align_center ltx_border_t">94.3±0.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.10.10.8" class="ltx_td ltx_align_center ltx_border_t">94.3±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.10.10.9" class="ltx_td ltx_border_t"></span>
<span id="A1.T4.7.1.1.1.1.1.1.10.10.10" class="ltx_td ltx_align_center ltx_border_t">93.8±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.10.10.11" class="ltx_td ltx_align_center ltx_border_t">92.7±0.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.10.10.12" class="ltx_td ltx_align_center ltx_border_t">89.4±0.1</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.11.11" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Resics45 <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.11.11.2" class="ltx_td ltx_align_center">82.6±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.11.11.3" class="ltx_td ltx_align_center">82.0±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.11.11.4" class="ltx_td ltx_align_center">77.5±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.11.11.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.11.11.6" class="ltx_td ltx_align_center">82.5±0.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.11.11.7" class="ltx_td ltx_align_center">80.8±0.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.11.11.8" class="ltx_td ltx_align_center">78.3±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.11.11.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.11.11.10" class="ltx_td ltx_align_center">77.0±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.11.11.11" class="ltx_td ltx_align_center">76.4±0.8</span>
<span id="A1.T4.7.1.1.1.1.1.1.11.11.12" class="ltx_td ltx_align_center">71.9±0.1</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.12.12" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Patch Camelyon <cite class="ltx_cite ltx_citemacro_citep">(Veeling et al., <a href="#bib.bib58" title="" class="ltx_ref">2018</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.12.12.2" class="ltx_td ltx_align_center">80.7±1.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.12.12.3" class="ltx_td ltx_align_center">81.5±1.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.12.12.4" class="ltx_td ltx_align_center">65.7±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.12.12.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.12.12.6" class="ltx_td ltx_align_center">82.5±0.7</span>
<span id="A1.T4.7.1.1.1.1.1.1.12.12.7" class="ltx_td ltx_align_center">80.5±0.8</span>
<span id="A1.T4.7.1.1.1.1.1.1.12.12.8" class="ltx_td ltx_align_center">82.4±0.5</span>
<span id="A1.T4.7.1.1.1.1.1.1.12.12.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.12.12.10" class="ltx_td ltx_align_center">79.9±0.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.12.12.11" class="ltx_td ltx_align_center">78.5±2.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.12.12.12" class="ltx_td ltx_align_center">69.0±0.1</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.13.13" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Retinopathy <cite class="ltx_cite ltx_citemacro_citep">(Kaggle &amp; EyePacs, <a href="#bib.bib27" title="" class="ltx_ref">2015</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.13.13.2" class="ltx_td ltx_align_center">70.4±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.13.13.3" class="ltx_td ltx_align_center">67.5±1.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.13.13.4" class="ltx_td ltx_align_center">25.5±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.13.13.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.13.13.6" class="ltx_td ltx_align_center">66.2±0.5</span>
<span id="A1.T4.7.1.1.1.1.1.1.13.13.7" class="ltx_td ltx_align_center">63.4±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.13.13.8" class="ltx_td ltx_align_center">25.0±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.13.13.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.13.13.10" class="ltx_td ltx_align_center">57.9±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.13.13.11" class="ltx_td ltx_align_center">58.4±0.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.13.13.12" class="ltx_td ltx_align_center">17.0±0.0</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.14.14" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">CLEVR-count <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.14.14.2" class="ltx_td ltx_align_center ltx_border_t">87.1±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.14.14.3" class="ltx_td ltx_align_center ltx_border_t">84.9±1.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.14.14.4" class="ltx_td ltx_align_center ltx_border_t">40.6±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.14.14.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T4.7.1.1.1.1.1.1.14.14.6" class="ltx_td ltx_align_center ltx_border_t">85.6±0.9</span>
<span id="A1.T4.7.1.1.1.1.1.1.14.14.7" class="ltx_td ltx_align_center ltx_border_t">84.3±0.5</span>
<span id="A1.T4.7.1.1.1.1.1.1.14.14.8" class="ltx_td ltx_align_center ltx_border_t">82.0±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.14.14.9" class="ltx_td ltx_border_t"></span>
<span id="A1.T4.7.1.1.1.1.1.1.14.14.10" class="ltx_td ltx_align_center ltx_border_t">88.7±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.14.14.11" class="ltx_td ltx_align_center ltx_border_t">85.4±0.7</span>
<span id="A1.T4.7.1.1.1.1.1.1.14.14.12" class="ltx_td ltx_align_center ltx_border_t">87.4±0.1</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.15.15" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CLEVR-dist <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.15.15.2" class="ltx_td ltx_align_center">58.1±0.8</span>
<span id="A1.T4.7.1.1.1.1.1.1.15.15.3" class="ltx_td ltx_align_center">58.4±0.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.15.15.4" class="ltx_td ltx_align_center">39.1±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.15.15.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.15.15.6" class="ltx_td ltx_align_center">56.1±0.8</span>
<span id="A1.T4.7.1.1.1.1.1.1.15.15.7" class="ltx_td ltx_align_center">55.7±1.7</span>
<span id="A1.T4.7.1.1.1.1.1.1.15.15.8" class="ltx_td ltx_align_center">57.7±0.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.15.15.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.15.15.10" class="ltx_td ltx_align_center">58.3±0.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.15.15.11" class="ltx_td ltx_align_center">55.0±1.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.15.15.12" class="ltx_td ltx_align_center">33.7±0.2</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.16.16" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">dSprites-loc <cite class="ltx_cite ltx_citemacro_citep">(Matthey et al., <a href="#bib.bib36" title="" class="ltx_ref">2017</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.16.16.2" class="ltx_td ltx_align_center">77.1±2.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.16.16.3" class="ltx_td ltx_align_center">75.1±1.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.16.16.4" class="ltx_td ltx_align_center">13.5±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.16.16.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.16.16.6" class="ltx_td ltx_align_center">74.8±1.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.16.16.7" class="ltx_td ltx_align_center">71.1±1.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.16.16.8" class="ltx_td ltx_align_center">62.4±1.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.16.16.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.16.16.10" class="ltx_td ltx_align_center">68.6±2.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.16.16.11" class="ltx_td ltx_align_center">66.8±0.8</span>
<span id="A1.T4.7.1.1.1.1.1.1.16.16.12" class="ltx_td ltx_align_center">74.8±1.4</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.17.17" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.17.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">dSprites-ori <cite class="ltx_cite ltx_citemacro_citep">(Matthey et al., <a href="#bib.bib36" title="" class="ltx_ref">2017</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.17.17.2" class="ltx_td ltx_align_center">56.7±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.17.17.3" class="ltx_td ltx_align_center">55.6±0.7</span>
<span id="A1.T4.7.1.1.1.1.1.1.17.17.4" class="ltx_td ltx_align_center">39.6±1.8</span>
<span id="A1.T4.7.1.1.1.1.1.1.17.17.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.17.17.6" class="ltx_td ltx_align_center">51.3±0.7</span>
<span id="A1.T4.7.1.1.1.1.1.1.17.17.7" class="ltx_td ltx_align_center">48.0±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.17.17.8" class="ltx_td ltx_align_center">53.8±0.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.17.17.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.17.17.10" class="ltx_td ltx_align_center">34.2±0.8</span>
<span id="A1.T4.7.1.1.1.1.1.1.17.17.11" class="ltx_td ltx_align_center">32.4±1.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.17.17.12" class="ltx_td ltx_align_center">36.7±0.3</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.18.18" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.18.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SmallNORB-azi <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a href="#bib.bib32" title="" class="ltx_ref">2004</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.18.18.2" class="ltx_td ltx_align_center">18.9±0.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.18.18.3" class="ltx_td ltx_align_center">19.8±0.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.18.18.4" class="ltx_td ltx_align_center">14.0±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.18.18.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.18.18.6" class="ltx_td ltx_align_center">16.2±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.18.18.7" class="ltx_td ltx_align_center">17.1±1.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.18.18.8" class="ltx_td ltx_align_center">15.8±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.18.18.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.18.18.10" class="ltx_td ltx_align_center">13.5±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.18.18.11" class="ltx_td ltx_align_center">13.0±0.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.18.18.12" class="ltx_td ltx_align_center">13.1±0.0</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.19.19" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.19.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SmallNORB-elev <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a href="#bib.bib32" title="" class="ltx_ref">2004</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.19.19.2" class="ltx_td ltx_align_center">40.4±0.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.19.19.3" class="ltx_td ltx_align_center">40.3±1.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.19.19.4" class="ltx_td ltx_align_center">28.2±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.19.19.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.19.19.6" class="ltx_td ltx_align_center">37.0±0.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.19.19.7" class="ltx_td ltx_align_center">38.5±1.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.19.19.8" class="ltx_td ltx_align_center">36.1±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.19.19.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.19.19.10" class="ltx_td ltx_align_center">35.0±0.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.19.19.11" class="ltx_td ltx_align_center">34.0±0.9</span>
<span id="A1.T4.7.1.1.1.1.1.1.19.19.12" class="ltx_td ltx_align_center">26.5±0.1</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.20.20" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.20.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">DMLab <cite class="ltx_cite ltx_citemacro_citep">(Beattie et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.20.20.2" class="ltx_td ltx_align_center">43.8±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.20.20.3" class="ltx_td ltx_align_center">41.2±1.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.20.20.4" class="ltx_td ltx_align_center">33.7±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.20.20.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.20.20.6" class="ltx_td ltx_align_center">41.6±0.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.20.20.7" class="ltx_td ltx_align_center">39.5±1.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.20.20.8" class="ltx_td ltx_align_center">38.9±0.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.20.20.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.20.20.10" class="ltx_td ltx_align_center">39.3±0.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.20.20.11" class="ltx_td ltx_align_center">38.6±0.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.20.20.12" class="ltx_td ltx_align_center">28.2±0.1</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.21.21" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.21.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">KITTI-dist <cite class="ltx_cite ltx_citemacro_citep">(Geiger et al., <a href="#bib.bib16" title="" class="ltx_ref">2013</a>)</cite></span>
<span id="A1.T4.7.1.1.1.1.1.1.21.21.2" class="ltx_td ltx_align_center">77.5±0.7</span>
<span id="A1.T4.7.1.1.1.1.1.1.21.21.3" class="ltx_td ltx_align_center">77.2±2.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.21.21.4" class="ltx_td ltx_align_center">73.6±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.21.21.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.21.21.6" class="ltx_td ltx_align_center">77.7±0.8</span>
<span id="A1.T4.7.1.1.1.1.1.1.21.21.7" class="ltx_td ltx_align_center">77.5±1.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.21.21.8" class="ltx_td ltx_align_center">73.1±0.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.21.21.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.21.21.10" class="ltx_td ltx_align_center">75.3±0.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.21.21.11" class="ltx_td ltx_align_center">74.3±2.9</span>
<span id="A1.T4.7.1.1.1.1.1.1.21.21.12" class="ltx_td ltx_align_center">69.0±0.9</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.22.22" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.22.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">All</span>
<span id="A1.T4.7.1.1.1.1.1.1.22.22.2" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T4.7.1.1.1.1.1.1.22.22.2.1" class="ltx_text ltx_font_bold">70.6</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.22.22.3" class="ltx_td ltx_align_center ltx_border_t">69.9</span>
<span id="A1.T4.7.1.1.1.1.1.1.22.22.4" class="ltx_td ltx_align_center ltx_border_t">53.5</span>
<span id="A1.T4.7.1.1.1.1.1.1.22.22.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T4.7.1.1.1.1.1.1.22.22.6" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T4.7.1.1.1.1.1.1.22.22.6.1" class="ltx_text ltx_font_bold">69.3</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.22.22.7" class="ltx_td ltx_align_center ltx_border_t">68.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.22.22.8" class="ltx_td ltx_align_center ltx_border_t">64.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.22.22.9" class="ltx_td ltx_border_t"></span>
<span id="A1.T4.7.1.1.1.1.1.1.22.22.10" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T4.7.1.1.1.1.1.1.22.22.10.1" class="ltx_text ltx_font_bold">65.5</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.22.22.11" class="ltx_td ltx_align_center ltx_border_t">64.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.22.22.12" class="ltx_td ltx_align_center ltx_border_t">57.1</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.23.23" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.23.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Natural</span>
<span id="A1.T4.7.1.1.1.1.1.1.23.23.2" class="ltx_td ltx_align_center"><span id="A1.T4.7.1.1.1.1.1.1.23.23.2.1" class="ltx_text ltx_font_bold">78.8</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.23.23.3" class="ltx_td ltx_align_center">78.5</span>
<span id="A1.T4.7.1.1.1.1.1.1.23.23.4" class="ltx_td ltx_align_center">67.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.23.23.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.23.23.6" class="ltx_td ltx_align_center"><span id="A1.T4.7.1.1.1.1.1.1.23.23.6.1" class="ltx_text ltx_font_bold">78.7</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.23.23.7" class="ltx_td ltx_align_center">78.2</span>
<span id="A1.T4.7.1.1.1.1.1.1.23.23.8" class="ltx_td ltx_align_center">74.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.23.23.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.23.23.10" class="ltx_td ltx_align_center"><span id="A1.T4.7.1.1.1.1.1.1.23.23.10.1" class="ltx_text ltx_font_bold">74.7</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.23.23.11" class="ltx_td ltx_align_center">74.1</span>
<span id="A1.T4.7.1.1.1.1.1.1.23.23.12" class="ltx_td ltx_align_center">67.0</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.24.24" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.24.24.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Specialized</span>
<span id="A1.T4.7.1.1.1.1.1.1.24.24.2" class="ltx_td ltx_align_center"><span id="A1.T4.7.1.1.1.1.1.1.24.24.2.1" class="ltx_text ltx_font_bold">82.3</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.24.24.3" class="ltx_td ltx_align_center">81.4</span>
<span id="A1.T4.7.1.1.1.1.1.1.24.24.4" class="ltx_td ltx_align_center">65.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.24.24.5" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.24.24.6" class="ltx_td ltx_align_center"><span id="A1.T4.7.1.1.1.1.1.1.24.24.6.1" class="ltx_text ltx_font_bold">81.5</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.24.24.7" class="ltx_td ltx_align_center">79.7</span>
<span id="A1.T4.7.1.1.1.1.1.1.24.24.8" class="ltx_td ltx_align_center">70.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.24.24.9" class="ltx_td"></span>
<span id="A1.T4.7.1.1.1.1.1.1.24.24.10" class="ltx_td ltx_align_center"><span id="A1.T4.7.1.1.1.1.1.1.24.24.10.1" class="ltx_text ltx_font_bold">77.1</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.24.24.11" class="ltx_td ltx_align_center">76.5</span>
<span id="A1.T4.7.1.1.1.1.1.1.24.24.12" class="ltx_td ltx_align_center">61.8</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.25.25" class="ltx_tr">
<span id="A1.T4.7.1.1.1.1.1.1.25.25.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Structured</span>
<span id="A1.T4.7.1.1.1.1.1.1.25.25.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T4.7.1.1.1.1.1.1.25.25.2.1" class="ltx_text ltx_font_bold">57.5</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.25.25.3" class="ltx_td ltx_align_center ltx_border_bb">56.6</span>
<span id="A1.T4.7.1.1.1.1.1.1.25.25.4" class="ltx_td ltx_align_center ltx_border_bb">35.3</span>
<span id="A1.T4.7.1.1.1.1.1.1.25.25.5" class="ltx_td ltx_border_bb"></span>
<span id="A1.T4.7.1.1.1.1.1.1.25.25.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T4.7.1.1.1.1.1.1.25.25.6.1" class="ltx_text ltx_font_bold">55.0</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.25.25.7" class="ltx_td ltx_align_center ltx_border_bb">54.0</span>
<span id="A1.T4.7.1.1.1.1.1.1.25.25.8" class="ltx_td ltx_align_center ltx_border_bb">52.5</span>
<span id="A1.T4.7.1.1.1.1.1.1.25.25.9" class="ltx_td ltx_border_bb"></span>
<span id="A1.T4.7.1.1.1.1.1.1.25.25.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T4.7.1.1.1.1.1.1.25.25.10.1" class="ltx_text ltx_font_bold">51.6</span></span>
<span id="A1.T4.7.1.1.1.1.1.1.25.25.11" class="ltx_td ltx_align_center ltx_border_bb">49.9</span>
<span id="A1.T4.7.1.1.1.1.1.1.25.25.12" class="ltx_td ltx_align_center ltx_border_bb">46.2</span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</figure>
<div id="A1.SS5.SSS1.p2" class="ltx_para ltx_noindent">
<p id="A1.SS5.SSS1.p2.1" class="ltx_p"><a href="#A1.T5" title="In A.5.1 VTAB-1k Task Ablations ‣ A.5 Additional VTAB-1k Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.5</span></a> compares the classification accuracy of the LDA and linear heads as a function of the learnable parameters in the backbone. When all parameters in the backbone are learnable and when FiLM layers are employed, the Naive Bayes LDA head outperforms the linear head. In the case when all of the parameters in the backbone are frozen, the linear head is superior since in that case the LDA head has only 2 learnable parameters (the covariance weights <math id="A1.SS5.SSS1.p2.1.m1.1" class="ltx_Math" alttext="{\bm{e}}" display="inline"><semantics id="A1.SS5.SSS1.p2.1.m1.1a"><mi id="A1.SS5.SSS1.p2.1.m1.1.1" xref="A1.SS5.SSS1.p2.1.m1.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p2.1.m1.1b"><ci id="A1.SS5.SSS1.p2.1.m1.1.1.cmml" xref="A1.SS5.SSS1.p2.1.m1.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p2.1.m1.1c">{\bm{e}}</annotation></semantics></math>).</p>
</div>
<figure id="A1.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table A.5: </span>Comparison of the classification accuracy of LDA and linear heads on VTAB-1k as a function of the learnable parameters in the backbone. ”None” indicates that all of the parameters in the pre-trained backbone are frozen (i.e. no learnable parameters). ”FiLM” indicates the that the only learnable parameters in the backbone are the FiLM layers. ”All” indicates that all the parameters in backbone are learnable and that FiLM is not used. The backbone is BiT-M-R50x1. Accuracy figures are percentages and the <math id="A1.T5.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T5.2.m1.1b"><mo id="A1.T5.2.m1.1.1" xref="A1.T5.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T5.2.m1.1c"><csymbol cd="latexml" id="A1.T5.2.m1.1.1.cmml" xref="A1.T5.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.2.m1.1d">\pm</annotation></semantics></math> sign indicates the 95% confidence interval over 3 runs. This is the full version of <a href="#S2.F2.sf1" title="In Figure 2 ‣ 2 FiLM Transfer (FiT) ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(a)</span></a></figcaption>
<div id="A1.T5.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:299.1pt;vertical-align:-6.5pt;"><span class="ltx_transformed_inner" style="transform:translate(-106.9pt,78.7pt) scale(0.65031,0.65031) ;">
<p id="A1.T5.3.1" class="ltx_p"><span id="A1.T5.3.1.1" class="ltx_text">
<span id="A1.T5.3.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:611.2pt;height:460pt;vertical-align:-10.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A1.T5.3.1.1.1.1" class="ltx_p"><span id="A1.T5.3.1.1.1.1.1" class="ltx_text">
<span id="A1.T5.3.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="A1.T5.3.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></span>
<span id="A1.T5.3.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_3"><span id="A1.T5.3.1.1.1.1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">LDA</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_border_tt"></span>
<span id="A1.T5.3.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_3"><span id="A1.T5.3.1.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">Linear</span></span></span>
<span id="A1.T5.3.1.1.1.1.1.1.2.2" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A1.T5.3.1.1.1.1.1.1.2.2.1.1" class="ltx_text ltx_font_bold">Dataset</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T5.3.1.1.1.1.1.1.2.2.2.1" class="ltx_text ltx_font_bold">None</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T5.3.1.1.1.1.1.1.2.2.3.1" class="ltx_text ltx_font_bold">FiLM</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T5.3.1.1.1.1.1.1.2.2.4.1" class="ltx_text ltx_font_bold">All</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.2.2.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T5.3.1.1.1.1.1.1.2.2.6.1" class="ltx_text ltx_font_bold">None</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.2.2.7" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T5.3.1.1.1.1.1.1.2.2.7.1" class="ltx_text ltx_font_bold">FiLM</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.2.2.8" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T5.3.1.1.1.1.1.1.2.2.8.1" class="ltx_text ltx_font_bold">All</span></span></span>
<span id="A1.T5.3.1.1.1.1.1.1.3.3" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Caltech101 <cite class="ltx_cite ltx_citemacro_citep">(Fei-Fei et al., <a href="#bib.bib14" title="" class="ltx_ref">2006</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">86.0±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">90.4±0.8</span>
<span id="A1.T5.3.1.1.1.1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">90.4±0.5</span>
<span id="A1.T5.3.1.1.1.1.1.1.3.3.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T5.3.1.1.1.1.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">87.7±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">89.3±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">88.0±0.2</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.4.4" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CIFAR100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib31" title="" class="ltx_ref">2009</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.4.4.2" class="ltx_td ltx_align_center">64.8±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.4.4.3" class="ltx_td ltx_align_center">74.2±0.5</span>
<span id="A1.T5.3.1.1.1.1.1.1.4.4.4" class="ltx_td ltx_align_center">63.3±0.9</span>
<span id="A1.T5.3.1.1.1.1.1.1.4.4.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.4.4.6" class="ltx_td ltx_align_center">61.4±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.4.4.7" class="ltx_td ltx_align_center">70.2±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.4.4.8" class="ltx_td ltx_align_center">70.1±0.1</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.5.5" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Flowers102 <cite class="ltx_cite ltx_citemacro_citep">(Nilsback &amp; Zisserman, <a href="#bib.bib41" title="" class="ltx_ref">2008</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.5.5.2" class="ltx_td ltx_align_center">98.7±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.5.5.3" class="ltx_td ltx_align_center">99.0±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.5.5.4" class="ltx_td ltx_align_center">98.9±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.5.5.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.5.5.6" class="ltx_td ltx_align_center">98.6±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.5.5.7" class="ltx_td ltx_align_center">98.7±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.5.5.8" class="ltx_td ltx_align_center">98.6±0.0</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.6.6" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Pets <cite class="ltx_cite ltx_citemacro_citep">(Parkhi et al., <a href="#bib.bib43" title="" class="ltx_ref">2012</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.6.6.2" class="ltx_td ltx_align_center">85.7±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.6.6.3" class="ltx_td ltx_align_center">90.5±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.6.6.4" class="ltx_td ltx_align_center">90.7±0.4</span>
<span id="A1.T5.3.1.1.1.1.1.1.6.6.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.6.6.6" class="ltx_td ltx_align_center">84.7±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.6.6.7" class="ltx_td ltx_align_center">87.4±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.6.6.8" class="ltx_td ltx_align_center">88.4±0.2</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.7.7" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Sun397 <cite class="ltx_cite ltx_citemacro_citep">(Xiao et al., <a href="#bib.bib61" title="" class="ltx_ref">2010</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.7.7.2" class="ltx_td ltx_align_center">47.7±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.7.7.3" class="ltx_td ltx_align_center">51.6±0.5</span>
<span id="A1.T5.3.1.1.1.1.1.1.7.7.4" class="ltx_td ltx_align_center">38.6±1.4</span>
<span id="A1.T5.3.1.1.1.1.1.1.7.7.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.7.7.6" class="ltx_td ltx_align_center">46.8±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.7.7.7" class="ltx_td ltx_align_center">46.8±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.7.7.8" class="ltx_td ltx_align_center">48.0±0.1</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.8.8" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SVHN <cite class="ltx_cite ltx_citemacro_citep">(Netzer et al., <a href="#bib.bib40" title="" class="ltx_ref">2011</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.8.8.2" class="ltx_td ltx_align_center">40.9±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.8.8.3" class="ltx_td ltx_align_center">74.2±0.9</span>
<span id="A1.T5.3.1.1.1.1.1.1.8.8.4" class="ltx_td ltx_align_center">85.1±2.3</span>
<span id="A1.T5.3.1.1.1.1.1.1.8.8.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.8.8.6" class="ltx_td ltx_align_center">42.8±1.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.8.8.7" class="ltx_td ltx_align_center">54.9±0.4</span>
<span id="A1.T5.3.1.1.1.1.1.1.8.8.8" class="ltx_td ltx_align_center">73.0±0.2</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.9.9" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">DTD <cite class="ltx_cite ltx_citemacro_citep">(Cimpoi et al., <a href="#bib.bib8" title="" class="ltx_ref">2014</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.9.9.2" class="ltx_td ltx_align_center">72.0±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.9.9.3" class="ltx_td ltx_align_center">70.9±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.9.9.4" class="ltx_td ltx_align_center">71.7±1.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.9.9.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.9.9.6" class="ltx_td ltx_align_center">72.0±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.9.9.7" class="ltx_td ltx_align_center">72.3±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.9.9.8" class="ltx_td ltx_align_center">72.7±0.3</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.10.10" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">EuroSAT <cite class="ltx_cite ltx_citemacro_citep">(Helber et al., <a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_t">93.7±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_t">95.1±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_t">95.9±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.10.10.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T5.3.1.1.1.1.1.1.10.10.6" class="ltx_td ltx_align_center ltx_border_t">94.4±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.10.10.7" class="ltx_td ltx_align_center ltx_border_t">95.1±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.10.10.8" class="ltx_td ltx_align_center ltx_border_t">95.3±0.1</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.11.11" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Resics45 <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.11.11.2" class="ltx_td ltx_align_center">75.8±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.11.11.3" class="ltx_td ltx_align_center">82.5±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.11.11.4" class="ltx_td ltx_align_center">84.8±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.11.11.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.11.11.6" class="ltx_td ltx_align_center">78.4±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.11.11.7" class="ltx_td ltx_align_center">81.5±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.11.11.8" class="ltx_td ltx_align_center">85.9±0.0</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.12.12" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Patch Camelyon <cite class="ltx_cite ltx_citemacro_citep">(Veeling et al., <a href="#bib.bib58" title="" class="ltx_ref">2018</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.12.12.2" class="ltx_td ltx_align_center">81.7±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.12.12.3" class="ltx_td ltx_align_center">82.5±0.7</span>
<span id="A1.T5.3.1.1.1.1.1.1.12.12.4" class="ltx_td ltx_align_center">84.0±0.5</span>
<span id="A1.T5.3.1.1.1.1.1.1.12.12.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.12.12.6" class="ltx_td ltx_align_center">77.0±1.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.12.12.7" class="ltx_td ltx_align_center">81.3±0.6</span>
<span id="A1.T5.3.1.1.1.1.1.1.12.12.8" class="ltx_td ltx_align_center">69.3±0.8</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.13.13" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Retinopathy <cite class="ltx_cite ltx_citemacro_citep">(Kaggle &amp; EyePacs, <a href="#bib.bib27" title="" class="ltx_ref">2015</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.13.13.2" class="ltx_td ltx_align_center">49.5±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.13.13.3" class="ltx_td ltx_align_center">66.2±0.5</span>
<span id="A1.T5.3.1.1.1.1.1.1.13.13.4" class="ltx_td ltx_align_center">76.8±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.13.13.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.13.13.6" class="ltx_td ltx_align_center">75.0±0.4</span>
<span id="A1.T5.3.1.1.1.1.1.1.13.13.7" class="ltx_td ltx_align_center">75.2±0.6</span>
<span id="A1.T5.3.1.1.1.1.1.1.13.13.8" class="ltx_td ltx_align_center">77.2±0.6</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.14.14" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">CLEVR-count <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.14.14.2" class="ltx_td ltx_align_center ltx_border_t">38.1±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.14.14.3" class="ltx_td ltx_align_center ltx_border_t">85.6±0.9</span>
<span id="A1.T5.3.1.1.1.1.1.1.14.14.4" class="ltx_td ltx_align_center ltx_border_t">94.2±0.</span>
<span id="A1.T5.3.1.1.1.1.1.1.14.14.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T5.3.1.1.1.1.1.1.14.14.6" class="ltx_td ltx_align_center ltx_border_t">48.3±0.8</span>
<span id="A1.T5.3.1.1.1.1.1.1.14.14.7" class="ltx_td ltx_align_center ltx_border_t">68.1±2.8</span>
<span id="A1.T5.3.1.1.1.1.1.1.14.14.8" class="ltx_td ltx_align_center ltx_border_t">54.6±7.1</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.15.15" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CLEVR-dist <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.15.15.2" class="ltx_td ltx_align_center">33.6±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.15.15.3" class="ltx_td ltx_align_center">56.1±0.8</span>
<span id="A1.T5.3.1.1.1.1.1.1.15.15.4" class="ltx_td ltx_align_center">57.2±2.7</span>
<span id="A1.T5.3.1.1.1.1.1.1.15.15.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.15.15.6" class="ltx_td ltx_align_center">34.8±1.5</span>
<span id="A1.T5.3.1.1.1.1.1.1.15.15.7" class="ltx_td ltx_align_center">47.7±1.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.15.15.8" class="ltx_td ltx_align_center">47.9±0.8</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.16.16" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">dSprites-loc <cite class="ltx_cite ltx_citemacro_citep">(Matthey et al., <a href="#bib.bib36" title="" class="ltx_ref">2017</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.16.16.2" class="ltx_td ltx_align_center">21.6±1.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.16.16.3" class="ltx_td ltx_align_center">74.8±1.4</span>
<span id="A1.T5.3.1.1.1.1.1.1.16.16.4" class="ltx_td ltx_align_center">91.6±1.9</span>
<span id="A1.T5.3.1.1.1.1.1.1.16.16.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.16.16.6" class="ltx_td ltx_align_center">12.7±1.4</span>
<span id="A1.T5.3.1.1.1.1.1.1.16.16.7" class="ltx_td ltx_align_center">49.7±0.6</span>
<span id="A1.T5.3.1.1.1.1.1.1.16.16.8" class="ltx_td ltx_align_center">91.6±1.1</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.17.17" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.17.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">dSprites-ori <cite class="ltx_cite ltx_citemacro_citep">(Matthey et al., <a href="#bib.bib36" title="" class="ltx_ref">2017</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.17.17.2" class="ltx_td ltx_align_center">43.2±1.9</span>
<span id="A1.T5.3.1.1.1.1.1.1.17.17.3" class="ltx_td ltx_align_center">51.3±0.7</span>
<span id="A1.T5.3.1.1.1.1.1.1.17.17.4" class="ltx_td ltx_align_center">62.6±0.7</span>
<span id="A1.T5.3.1.1.1.1.1.1.17.17.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.17.17.6" class="ltx_td ltx_align_center">31.7±0.8</span>
<span id="A1.T5.3.1.1.1.1.1.1.17.17.7" class="ltx_td ltx_align_center">52.7±0.7</span>
<span id="A1.T5.3.1.1.1.1.1.1.17.17.8" class="ltx_td ltx_align_center">65.9±0.3</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.18.18" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.18.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SmallNORB-azi <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a href="#bib.bib32" title="" class="ltx_ref">2004</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.18.18.2" class="ltx_td ltx_align_center">11.9±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.18.18.3" class="ltx_td ltx_align_center">16.2±0.1</span>
<span id="A1.T5.3.1.1.1.1.1.1.18.18.4" class="ltx_td ltx_align_center">19.5±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.18.18.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.18.18.6" class="ltx_td ltx_align_center">11.5±0.9</span>
<span id="A1.T5.3.1.1.1.1.1.1.18.18.7" class="ltx_td ltx_align_center">15.0±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.18.18.8" class="ltx_td ltx_align_center">18.7±0.2</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.19.19" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.19.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SmallNORB-elev <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a href="#bib.bib32" title="" class="ltx_ref">2004</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.19.19.2" class="ltx_td ltx_align_center">28.1±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.19.19.3" class="ltx_td ltx_align_center">37.0±0.6</span>
<span id="A1.T5.3.1.1.1.1.1.1.19.19.4" class="ltx_td ltx_align_center">44.2±0.6</span>
<span id="A1.T5.3.1.1.1.1.1.1.19.19.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.19.19.6" class="ltx_td ltx_align_center">29.3±1.9</span>
<span id="A1.T5.3.1.1.1.1.1.1.19.19.7" class="ltx_td ltx_align_center">34.3±0.7</span>
<span id="A1.T5.3.1.1.1.1.1.1.19.19.8" class="ltx_td ltx_align_center">25.8±0.9</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.20.20" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.20.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">DMLab <cite class="ltx_cite ltx_citemacro_citep">(Beattie et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.20.20.2" class="ltx_td ltx_align_center">34.3±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.20.20.3" class="ltx_td ltx_align_center">41.6±0.6</span>
<span id="A1.T5.3.1.1.1.1.1.1.20.20.4" class="ltx_td ltx_align_center">46.9±0.8</span>
<span id="A1.T5.3.1.1.1.1.1.1.20.20.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.20.20.6" class="ltx_td ltx_align_center">37.3±1.3</span>
<span id="A1.T5.3.1.1.1.1.1.1.20.20.7" class="ltx_td ltx_align_center">41.8±0.7</span>
<span id="A1.T5.3.1.1.1.1.1.1.20.20.8" class="ltx_td ltx_align_center">47.1±0.1</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.21.21" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.21.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">KITTI-dist <cite class="ltx_cite ltx_citemacro_citep">(Geiger et al., <a href="#bib.bib16" title="" class="ltx_ref">2013</a>)</cite></span>
<span id="A1.T5.3.1.1.1.1.1.1.21.21.2" class="ltx_td ltx_align_center">66.0±0.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.21.21.3" class="ltx_td ltx_align_center">77.7±0.8</span>
<span id="A1.T5.3.1.1.1.1.1.1.21.21.4" class="ltx_td ltx_align_center">82.9±0.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.21.21.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.21.21.6" class="ltx_td ltx_align_center">69.2±0.7</span>
<span id="A1.T5.3.1.1.1.1.1.1.21.21.7" class="ltx_td ltx_align_center">78.1±1.5</span>
<span id="A1.T5.3.1.1.1.1.1.1.21.21.8" class="ltx_td ltx_align_center">80.1±0.9</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.22.22" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.22.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">All</span>
<span id="A1.T5.3.1.1.1.1.1.1.22.22.2" class="ltx_td ltx_align_center ltx_border_t">56.5</span>
<span id="A1.T5.3.1.1.1.1.1.1.22.22.3" class="ltx_td ltx_align_center ltx_border_t">69.3</span>
<span id="A1.T5.3.1.1.1.1.1.1.22.22.4" class="ltx_td ltx_align_center ltx_border_t">72.6</span>
<span id="A1.T5.3.1.1.1.1.1.1.22.22.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T5.3.1.1.1.1.1.1.22.22.6" class="ltx_td ltx_align_center ltx_border_t">57.5</span>
<span id="A1.T5.3.1.1.1.1.1.1.22.22.7" class="ltx_td ltx_align_center ltx_border_t">65.3</span>
<span id="A1.T5.3.1.1.1.1.1.1.22.22.8" class="ltx_td ltx_align_center ltx_border_t">68.3</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.23.23" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.23.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Natural</span>
<span id="A1.T5.3.1.1.1.1.1.1.23.23.2" class="ltx_td ltx_align_center">70.8</span>
<span id="A1.T5.3.1.1.1.1.1.1.23.23.3" class="ltx_td ltx_align_center">78.7</span>
<span id="A1.T5.3.1.1.1.1.1.1.23.23.4" class="ltx_td ltx_align_center">77.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.23.23.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.23.23.6" class="ltx_td ltx_align_center">70.6</span>
<span id="A1.T5.3.1.1.1.1.1.1.23.23.7" class="ltx_td ltx_align_center">74.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.23.23.8" class="ltx_td ltx_align_center">77.0</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.24.24" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.24.24.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Specialized</span>
<span id="A1.T5.3.1.1.1.1.1.1.24.24.2" class="ltx_td ltx_align_center">75.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.24.24.3" class="ltx_td ltx_align_center">81.5</span>
<span id="A1.T5.3.1.1.1.1.1.1.24.24.4" class="ltx_td ltx_align_center">85.3</span>
<span id="A1.T5.3.1.1.1.1.1.1.24.24.5" class="ltx_td"></span>
<span id="A1.T5.3.1.1.1.1.1.1.24.24.6" class="ltx_td ltx_align_center">81.2</span>
<span id="A1.T5.3.1.1.1.1.1.1.24.24.7" class="ltx_td ltx_align_center">83.3</span>
<span id="A1.T5.3.1.1.1.1.1.1.24.24.8" class="ltx_td ltx_align_center">81.9</span></span>
<span id="A1.T5.3.1.1.1.1.1.1.25.25" class="ltx_tr">
<span id="A1.T5.3.1.1.1.1.1.1.25.25.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Structured</span>
<span id="A1.T5.3.1.1.1.1.1.1.25.25.2" class="ltx_td ltx_align_center ltx_border_bb">34.6</span>
<span id="A1.T5.3.1.1.1.1.1.1.25.25.3" class="ltx_td ltx_align_center ltx_border_bb">55.0</span>
<span id="A1.T5.3.1.1.1.1.1.1.25.25.4" class="ltx_td ltx_align_center ltx_border_bb">62.4</span>
<span id="A1.T5.3.1.1.1.1.1.1.25.25.5" class="ltx_td ltx_border_bb"></span>
<span id="A1.T5.3.1.1.1.1.1.1.25.25.6" class="ltx_td ltx_align_center ltx_border_bb">34.4</span>
<span id="A1.T5.3.1.1.1.1.1.1.25.25.7" class="ltx_td ltx_align_center ltx_border_bb">48.4</span>
<span id="A1.T5.3.1.1.1.1.1.1.25.25.8" class="ltx_td ltx_align_center ltx_border_bb">54.0</span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</figure>
</section>
</section>
<section id="A1.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6 </span>Discussion of the empirical results</h3>

<div id="A1.SS6.p1" class="ltx_para ltx_noindent">
<p id="A1.SS6.p1.1" class="ltx_p">FiLM works well for low shots per class because it has a small number of parameters to adapt – this gets you a long way with large pre-trained backbones – and it also prevents over-fitting as compared to adapting all the parameters in the backbone.
Evidence: eventually as dataset size increases, full body adaptation is at least as good as FiLM.
For larger models, this transition happens at a larger number of data points and so we expect adapters to be especially useful as the field transitions to using large foundation models.
<a href="#S4.F3" title="In 4.1 Few-shot Results ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a> provides an empirical justification of this argument, showing that FiT-LDA outperforms BiT at low-shot.</p>
</div>
<div id="A1.SS6.p2" class="ltx_para ltx_noindent">
<p id="A1.SS6.p2.1" class="ltx_p">The linear head is more flexible and works best of all methods in high data, but in the low- to medium-shot setting the linear head appears to lead to increased overfitting and the meta-trained LDA head performs best in this region. See <a href="#S4.F3" title="In 4.1 Few-shot Results ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a> for empirical justification.</p>
</div>
<div id="A1.SS6.p3" class="ltx_para ltx_noindent">
<p id="A1.SS6.p3.1" class="ltx_p">The <span id="A1.SS6.p3.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> approach suffers when there are a fairly large number of data points and the dataset is very far from the pretraining data (ImageNet) e.g. see the DSprites results in <a href="#S4.T3" title="In 4.2 VTAB-1k Results ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">3</span></a> where BiT beats FiT-LDA by a large margin.
In addition, the LDA and QDA variants of the Naïve Bayes head are more computationally expensive compared to a linear head since LDA and QDA require inverting <math id="A1.SS6.p3.1.m1.1" class="ltx_Math" alttext="d_{b}\times d_{b}" display="inline"><semantics id="A1.SS6.p3.1.m1.1a"><mrow id="A1.SS6.p3.1.m1.1.1" xref="A1.SS6.p3.1.m1.1.1.cmml"><msub id="A1.SS6.p3.1.m1.1.1.2" xref="A1.SS6.p3.1.m1.1.1.2.cmml"><mi id="A1.SS6.p3.1.m1.1.1.2.2" xref="A1.SS6.p3.1.m1.1.1.2.2.cmml">d</mi><mi id="A1.SS6.p3.1.m1.1.1.2.3" xref="A1.SS6.p3.1.m1.1.1.2.3.cmml">b</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.SS6.p3.1.m1.1.1.1" xref="A1.SS6.p3.1.m1.1.1.1.cmml">×</mo><msub id="A1.SS6.p3.1.m1.1.1.3" xref="A1.SS6.p3.1.m1.1.1.3.cmml"><mi id="A1.SS6.p3.1.m1.1.1.3.2" xref="A1.SS6.p3.1.m1.1.1.3.2.cmml">d</mi><mi id="A1.SS6.p3.1.m1.1.1.3.3" xref="A1.SS6.p3.1.m1.1.1.3.3.cmml">b</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p3.1.m1.1b"><apply id="A1.SS6.p3.1.m1.1.1.cmml" xref="A1.SS6.p3.1.m1.1.1"><times id="A1.SS6.p3.1.m1.1.1.1.cmml" xref="A1.SS6.p3.1.m1.1.1.1"></times><apply id="A1.SS6.p3.1.m1.1.1.2.cmml" xref="A1.SS6.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS6.p3.1.m1.1.1.2.1.cmml" xref="A1.SS6.p3.1.m1.1.1.2">subscript</csymbol><ci id="A1.SS6.p3.1.m1.1.1.2.2.cmml" xref="A1.SS6.p3.1.m1.1.1.2.2">𝑑</ci><ci id="A1.SS6.p3.1.m1.1.1.2.3.cmml" xref="A1.SS6.p3.1.m1.1.1.2.3">𝑏</ci></apply><apply id="A1.SS6.p3.1.m1.1.1.3.cmml" xref="A1.SS6.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS6.p3.1.m1.1.1.3.1.cmml" xref="A1.SS6.p3.1.m1.1.1.3">subscript</csymbol><ci id="A1.SS6.p3.1.m1.1.1.3.2.cmml" xref="A1.SS6.p3.1.m1.1.1.3.2">𝑑</ci><ci id="A1.SS6.p3.1.m1.1.1.3.3.cmml" xref="A1.SS6.p3.1.m1.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p3.1.m1.1c">d_{b}\times d_{b}</annotation></semantics></math> matrices for each training iteration.</p>
</div>
</section>
<section id="A1.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.7 </span>FiLM Layer Parameter Variation</h3>

<div id="A1.SS7.p1" class="ltx_para">
<p id="A1.SS7.p1.1" class="ltx_p"><a href="#A1.F2.sf1" title="In Figure A.2 ‣ A.7 FiLM Layer Parameter Variation ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(a)</span></a> and <a href="#A1.F2.sf2" title="In Figure A.2 ‣ A.7 FiLM Layer Parameter Variation ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(b)</span></a> show the magnitude of the FiLM parameters as a function of layer for FiT-LDA on CIFAR100 and SHVN, respectively, in the VTAB-1k setting.
We see that for a dataset that differs from the pretraining data (SHVN), the FiLM layers are required to learn a greater degree of adjustment compared to a dataset that is similar to the pretraining data (CIFAR100).</p>
</div>
<figure id="A1.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A1.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.08671/assets/x8.png" id="A1.F2.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="179" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>CIFAR100 film layer plot. Left is <math id="A1.F2.sf1.3.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A1.F2.sf1.3.m1.1b"><mi id="A1.F2.sf1.3.m1.1.1" xref="A1.F2.sf1.3.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.F2.sf1.3.m1.1c"><ci id="A1.F2.sf1.3.m1.1.1.cmml" xref="A1.F2.sf1.3.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F2.sf1.3.m1.1d">\gamma</annotation></semantics></math> and right is <math id="A1.F2.sf1.4.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A1.F2.sf1.4.m2.1b"><mi id="A1.F2.sf1.4.m2.1.1" xref="A1.F2.sf1.4.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.F2.sf1.4.m2.1c"><ci id="A1.F2.sf1.4.m2.1.1.cmml" xref="A1.F2.sf1.4.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F2.sf1.4.m2.1d">\beta</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A1.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.08671/assets/x9.png" id="A1.F2.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="179" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>SVHN film layer plot. Left is <math id="A1.F2.sf2.3.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A1.F2.sf2.3.m1.1b"><mi id="A1.F2.sf2.3.m1.1.1" xref="A1.F2.sf2.3.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.F2.sf2.3.m1.1c"><ci id="A1.F2.sf2.3.m1.1.1.cmml" xref="A1.F2.sf2.3.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F2.sf2.3.m1.1d">\gamma</annotation></semantics></math> and right is <math id="A1.F2.sf2.4.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A1.F2.sf2.4.m2.1b"><mi id="A1.F2.sf2.4.m2.1.1" xref="A1.F2.sf2.4.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.F2.sf2.4.m2.1c"><ci id="A1.F2.sf2.4.m2.1.1.cmml" xref="A1.F2.sf2.4.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F2.sf2.4.m2.1d">\beta</annotation></semantics></math></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure A.2: </span>(Top) Box plots of the film parameter magnitudes as a function of layer in the feature extractor.</figcaption>
</figure>
<div id="A1.SS7.p2" class="ltx_para ltx_noindent">
<p id="A1.SS7.p2.1" class="ltx_p">https://eprint.iacr.org/2017/715.pdf</p>
</div>
</section>
<section id="A1.SS8" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.8 </span>Additional Few-shot Federated Learning Results</h3>

<figure id="A1.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table A.6: </span>Few-shot Federated Learning Results on CIFAR100 for different numbers of clients and shots per client. Accuracy figures are percentages and the <math id="A1.T6.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T6.4.m1.1b"><mo id="A1.T6.4.m1.1.1" xref="A1.T6.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.4.m1.1c"><csymbol cd="latexml" id="A1.T6.4.m1.1.1.cmml" xref="A1.T6.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.4.m1.1d">\pm</annotation></semantics></math> sign indicates the <math id="A1.T6.5.m2.1" class="ltx_Math" alttext="95\%" display="inline"><semantics id="A1.T6.5.m2.1b"><mrow id="A1.T6.5.m2.1.1" xref="A1.T6.5.m2.1.1.cmml"><mn id="A1.T6.5.m2.1.1.2" xref="A1.T6.5.m2.1.1.2.cmml">95</mn><mo id="A1.T6.5.m2.1.1.1" xref="A1.T6.5.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T6.5.m2.1c"><apply id="A1.T6.5.m2.1.1.cmml" xref="A1.T6.5.m2.1.1"><csymbol cd="latexml" id="A1.T6.5.m2.1.1.1.cmml" xref="A1.T6.5.m2.1.1.1">percent</csymbol><cn type="integer" id="A1.T6.5.m2.1.1.2.cmml" xref="A1.T6.5.m2.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.5.m2.1d">95\%</annotation></semantics></math> confidence interval over <math id="A1.T6.6.m3.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A1.T6.6.m3.1b"><mn id="A1.T6.6.m3.1.1" xref="A1.T6.6.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A1.T6.6.m3.1c"><cn type="integer" id="A1.T6.6.m3.1.1.cmml" xref="A1.T6.6.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.6.m3.1d">3</annotation></semantics></math> runs. Global stands for the global setting, while Personalized stands for the personalized scenario. FL indicates Federated Learning training.</figcaption>
<div id="A1.T6.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:207pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-44.1pt,22.9pt) scale(0.81834,0.81834) ;">
<p id="A1.T6.7.1" class="ltx_p"><span id="A1.T6.7.1.1" class="ltx_text">
<span id="A1.T6.7.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:485.7pt;height:253pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A1.T6.7.1.1.1.1" class="ltx_p"><span id="A1.T6.7.1.1.1.1.1" class="ltx_text">
<span id="A1.T6.7.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="A1.T6.7.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_border_tt"></span>
<span id="A1.T6.7.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T6.7.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T6.7.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3"><span id="A1.T6.7.1.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">Global</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T6.7.1.1.1.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3"><span id="A1.T6.7.1.1.1.1.1.1.1.1.6.1" class="ltx_text ltx_font_bold">Personalized</span></span></span>
<span id="A1.T6.7.1.1.1.1.1.1.2.2" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">Clients</span>
<span id="A1.T6.7.1.1.1.1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">Shot</span>
<span id="A1.T6.7.1.1.1.1.1.1.2.2.3" class="ltx_td ltx_th ltx_th_column ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Lower Bound</span>
<span id="A1.T6.7.1.1.1.1.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FL</span>
<span id="A1.T6.7.1.1.1.1.1.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Upper Bound</span>
<span id="A1.T6.7.1.1.1.1.1.1.2.2.7" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T6.7.1.1.1.1.1.1.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Lower Bound</span>
<span id="A1.T6.7.1.1.1.1.1.1.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FL</span>
<span id="A1.T6.7.1.1.1.1.1.1.2.2.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Upper Bound</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.3.3" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.3.3.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">2</span>
<span id="A1.T6.7.1.1.1.1.1.1.3.3.3" class="ltx_td ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">42.6±1.9</span>
<span id="A1.T6.7.1.1.1.1.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">49.3±1.3</span>
<span id="A1.T6.7.1.1.1.1.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">52.5±0.9</span>
<span id="A1.T6.7.1.1.1.1.1.1.3.3.7" class="ltx_td ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">73.2±1.4</span>
<span id="A1.T6.7.1.1.1.1.1.1.3.3.9" class="ltx_td ltx_align_center ltx_border_t">80.1±0.8</span>
<span id="A1.T6.7.1.1.1.1.1.1.3.3.10" class="ltx_td ltx_align_center ltx_border_t">81.7±1.2</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.4.4" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.4.4.1" class="ltx_td ltx_align_center">10</span>
<span id="A1.T6.7.1.1.1.1.1.1.4.4.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T6.7.1.1.1.1.1.1.4.4.3" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.4.4.4" class="ltx_td ltx_align_center">55.6±1.6</span>
<span id="A1.T6.7.1.1.1.1.1.1.4.4.5" class="ltx_td ltx_align_center">64.1±1.6</span>
<span id="A1.T6.7.1.1.1.1.1.1.4.4.6" class="ltx_td ltx_align_center">68.7±0.7</span>
<span id="A1.T6.7.1.1.1.1.1.1.4.4.7" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.4.4.8" class="ltx_td ltx_align_center">82.6±0.4</span>
<span id="A1.T6.7.1.1.1.1.1.1.4.4.9" class="ltx_td ltx_align_center">88.8±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.4.4.10" class="ltx_td ltx_align_center">90.6±0.4</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.5.5" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.5.5.1" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.5.5.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T6.7.1.1.1.1.1.1.5.5.3" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.5.5.4" class="ltx_td ltx_align_center">60.7±1.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.5.5.5" class="ltx_td ltx_align_center">71.5±0.8</span>
<span id="A1.T6.7.1.1.1.1.1.1.5.5.6" class="ltx_td ltx_align_center">74.7±0.3</span>
<span id="A1.T6.7.1.1.1.1.1.1.5.5.7" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.5.5.8" class="ltx_td ltx_align_center">86.6±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.5.5.9" class="ltx_td ltx_align_center">91.8±0.5</span>
<span id="A1.T6.7.1.1.1.1.1.1.5.5.10" class="ltx_td ltx_align_center">92.6±0.6</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.6.6" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.6.6.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t">2</span>
<span id="A1.T6.7.1.1.1.1.1.1.6.6.3" class="ltx_td ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t">59.9±0.6</span>
<span id="A1.T6.7.1.1.1.1.1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_t">68.5±0.3</span>
<span id="A1.T6.7.1.1.1.1.1.1.6.6.6" class="ltx_td ltx_align_center ltx_border_t">73.2±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.6.6.7" class="ltx_td ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.6.6.8" class="ltx_td ltx_align_center ltx_border_t">75.4±0.9</span>
<span id="A1.T6.7.1.1.1.1.1.1.6.6.9" class="ltx_td ltx_align_center ltx_border_t">84.6±0.5</span>
<span id="A1.T6.7.1.1.1.1.1.1.6.6.10" class="ltx_td ltx_align_center ltx_border_t">93.4±0.2</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.7.7" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.7.7.1" class="ltx_td ltx_align_center">50</span>
<span id="A1.T6.7.1.1.1.1.1.1.7.7.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T6.7.1.1.1.1.1.1.7.7.3" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.7.7.4" class="ltx_td ltx_align_center">63.0±0.8</span>
<span id="A1.T6.7.1.1.1.1.1.1.7.7.5" class="ltx_td ltx_align_center">73.8±0.7</span>
<span id="A1.T6.7.1.1.1.1.1.1.7.7.6" class="ltx_td ltx_align_center">78.0±0.1</span>
<span id="A1.T6.7.1.1.1.1.1.1.7.7.7" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.7.7.8" class="ltx_td ltx_align_center">83.5±0.5</span>
<span id="A1.T6.7.1.1.1.1.1.1.7.7.9" class="ltx_td ltx_align_center">91.0±0.4</span>
<span id="A1.T6.7.1.1.1.1.1.1.7.7.10" class="ltx_td ltx_align_center">94.9±0.2</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.8.8" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.8.8.1" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.8.8.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T6.7.1.1.1.1.1.1.8.8.3" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.8.8.4" class="ltx_td ltx_align_center">65.8±1.1</span>
<span id="A1.T6.7.1.1.1.1.1.1.8.8.5" class="ltx_td ltx_align_center">77.1±0.3</span>
<span id="A1.T6.7.1.1.1.1.1.1.8.8.6" class="ltx_td ltx_align_center">79.2±0.3</span>
<span id="A1.T6.7.1.1.1.1.1.1.8.8.7" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.8.8.8" class="ltx_td ltx_align_center">87.4±0.6</span>
<span id="A1.T6.7.1.1.1.1.1.1.8.8.9" class="ltx_td ltx_align_center">93.4±0.3</span>
<span id="A1.T6.7.1.1.1.1.1.1.8.8.10" class="ltx_td ltx_align_center">95.2±0.1</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.9.9" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.9.9.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_t">2</span>
<span id="A1.T6.7.1.1.1.1.1.1.9.9.3" class="ltx_td ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_t">65.6±0.6</span>
<span id="A1.T6.7.1.1.1.1.1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_t">74.4±0.3</span>
<span id="A1.T6.7.1.1.1.1.1.1.9.9.6" class="ltx_td ltx_align_center ltx_border_t">77.5±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.9.9.7" class="ltx_td ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.9.9.8" class="ltx_td ltx_align_center ltx_border_t">75.7±0.9</span>
<span id="A1.T6.7.1.1.1.1.1.1.9.9.9" class="ltx_td ltx_align_center ltx_border_t">85.3±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.9.9.10" class="ltx_td ltx_align_center ltx_border_t">94.6±0.2</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.10.10" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.10.10.1" class="ltx_td ltx_align_center">100</span>
<span id="A1.T6.7.1.1.1.1.1.1.10.10.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T6.7.1.1.1.1.1.1.10.10.3" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.10.10.4" class="ltx_td ltx_align_center">66.0±0.3</span>
<span id="A1.T6.7.1.1.1.1.1.1.10.10.5" class="ltx_td ltx_align_center">76.5±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.10.10.6" class="ltx_td ltx_align_center">79.5±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.10.10.7" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.10.10.8" class="ltx_td ltx_align_center">83.1±0.9</span>
<span id="A1.T6.7.1.1.1.1.1.1.10.10.9" class="ltx_td ltx_align_center">91.3±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.10.10.10" class="ltx_td ltx_align_center">95.3±0.1</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.11.11" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.11.11.1" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.11.11.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T6.7.1.1.1.1.1.1.11.11.3" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.11.11.4" class="ltx_td ltx_align_center">66.8±0.3</span>
<span id="A1.T6.7.1.1.1.1.1.1.11.11.5" class="ltx_td ltx_align_center">78.4±0.1</span>
<span id="A1.T6.7.1.1.1.1.1.1.11.11.6" class="ltx_td ltx_align_center">80.2±0.1</span>
<span id="A1.T6.7.1.1.1.1.1.1.11.11.7" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.11.11.8" class="ltx_td ltx_align_center">87.4±0.5</span>
<span id="A1.T6.7.1.1.1.1.1.1.11.11.9" class="ltx_td ltx_align_center">93.6±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.11.11.10" class="ltx_td ltx_align_center">95.5±0.1</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.12.12" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.12.12.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.12.12.2" class="ltx_td ltx_align_center ltx_border_t">2</span>
<span id="A1.T6.7.1.1.1.1.1.1.12.12.3" class="ltx_td ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.12.12.4" class="ltx_td ltx_align_center ltx_border_t">68.8±0.1</span>
<span id="A1.T6.7.1.1.1.1.1.1.12.12.5" class="ltx_td ltx_align_center ltx_border_t">77.9±0.4</span>
<span id="A1.T6.7.1.1.1.1.1.1.12.12.6" class="ltx_td ltx_align_center ltx_border_t">80.1±0.3</span>
<span id="A1.T6.7.1.1.1.1.1.1.12.12.7" class="ltx_td ltx_border_t"></span>
<span id="A1.T6.7.1.1.1.1.1.1.12.12.8" class="ltx_td ltx_align_center ltx_border_t">75.5±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.12.12.9" class="ltx_td ltx_align_center ltx_border_t">85.8±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.12.12.10" class="ltx_td ltx_align_center ltx_border_t">95.6±0.1</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.13.13" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.13.13.1" class="ltx_td ltx_align_center">500</span>
<span id="A1.T6.7.1.1.1.1.1.1.13.13.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T6.7.1.1.1.1.1.1.13.13.3" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.13.13.4" class="ltx_td ltx_align_center">67.6±0.1</span>
<span id="A1.T6.7.1.1.1.1.1.1.13.13.5" class="ltx_td ltx_align_center">77.6±0.1</span>
<span id="A1.T6.7.1.1.1.1.1.1.13.13.6" class="ltx_td ltx_align_center">80.6±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.13.13.7" class="ltx_td"></span>
<span id="A1.T6.7.1.1.1.1.1.1.13.13.8" class="ltx_td ltx_align_center">83.2±0.3</span>
<span id="A1.T6.7.1.1.1.1.1.1.13.13.9" class="ltx_td ltx_align_center">91.0±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.13.13.10" class="ltx_td ltx_align_center">95.7±0.1</span></span>
<span id="A1.T6.7.1.1.1.1.1.1.14.14" class="ltx_tr">
<span id="A1.T6.7.1.1.1.1.1.1.14.14.1" class="ltx_td ltx_border_bb"></span>
<span id="A1.T6.7.1.1.1.1.1.1.14.14.2" class="ltx_td ltx_align_center ltx_border_bb">10</span>
<span id="A1.T6.7.1.1.1.1.1.1.14.14.3" class="ltx_td ltx_border_bb"></span>
<span id="A1.T6.7.1.1.1.1.1.1.14.14.4" class="ltx_td ltx_align_center ltx_border_bb">67.7±0.1</span>
<span id="A1.T6.7.1.1.1.1.1.1.14.14.5" class="ltx_td ltx_align_center ltx_border_bb">79.2±0.3</span>
<span id="A1.T6.7.1.1.1.1.1.1.14.14.6" class="ltx_td ltx_align_center ltx_border_bb">80.8±0.2</span>
<span id="A1.T6.7.1.1.1.1.1.1.14.14.7" class="ltx_td ltx_border_bb"></span>
<span id="A1.T6.7.1.1.1.1.1.1.14.14.8" class="ltx_td ltx_align_center ltx_border_bb">87.7±0.1</span>
<span id="A1.T6.7.1.1.1.1.1.1.14.14.9" class="ltx_td ltx_align_center ltx_border_bb">94.3±0.1</span>
<span id="A1.T6.7.1.1.1.1.1.1.14.14.10" class="ltx_td ltx_align_center ltx_border_bb">96.2±0.1</span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</figure>
<div id="A1.SS8.p1" class="ltx_para ltx_noindent">
<p id="A1.SS8.p1.1" class="ltx_p"><a href="#A1.T6" title="In A.8 Additional Few-shot Federated Learning Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.6</span></a> shows the tabular version of <a href="#S4.F4" title="In 4.4 Few-shot Federated Learning ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>.
For the Federated Learning results, it includes only the resulting accuracy after training for <math id="A1.SS8.p1.1.m1.1" class="ltx_Math" alttext="60" display="inline"><semantics id="A1.SS8.p1.1.m1.1a"><mn id="A1.SS8.p1.1.m1.1.1" xref="A1.SS8.p1.1.m1.1.1.cmml">60</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p1.1.m1.1b"><cn type="integer" id="A1.SS8.p1.1.m1.1.1.cmml" xref="A1.SS8.p1.1.m1.1.1">60</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p1.1.m1.1c">60</annotation></semantics></math> communication rounds.
Refer to <a href="#S4.SS4" title="4.4 Few-shot Federated Learning ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.4</span></a> for analysis.</p>
</div>
<div id="A1.SS8.p2" class="ltx_para ltx_noindent">
<p id="A1.SS8.p2.1" class="ltx_p">In general, <span id="A1.SS8.p2.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> can operate well with other FL aggregation methods, as they are agnostic to the neural network architectures used to learn the parameters. However, as we are constructing a Naïve Bayes head instead of training a linear head via SGD, some of the theoretical convergence results of the methods mentioned may not hold. Despite this fact, <span id="A1.SS8.p2.1.2" class="ltx_text ltx_font_smallcaps">FiT</span> has shown to have quite fast convergence in practice. In <a href="#A1.T7" title="In A.8 Additional Few-shot Federated Learning Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.7</span></a> we provide the results of training <span id="A1.SS8.p2.1.3" class="ltx_text ltx_font_smallcaps">FiT</span> with Federated Averaging (FedAvg) and FedProx<cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<figure id="A1.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table A.7: </span><span id="A1.T7.10.1" class="ltx_text ltx_font_smallcaps">FiT</span> trained with different FL algorithms on CIFAR100 for different numbers of clients and shots per client. Federated averaging (FedAvg) and FedProx methods were used. For FedProx <math id="A1.T7.5.m1.1" class="ltx_Math" alttext="\mu=0.01" display="inline"><semantics id="A1.T7.5.m1.1b"><mrow id="A1.T7.5.m1.1.1" xref="A1.T7.5.m1.1.1.cmml"><mi id="A1.T7.5.m1.1.1.2" xref="A1.T7.5.m1.1.1.2.cmml">μ</mi><mo id="A1.T7.5.m1.1.1.1" xref="A1.T7.5.m1.1.1.1.cmml">=</mo><mn id="A1.T7.5.m1.1.1.3" xref="A1.T7.5.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T7.5.m1.1c"><apply id="A1.T7.5.m1.1.1.cmml" xref="A1.T7.5.m1.1.1"><eq id="A1.T7.5.m1.1.1.1.cmml" xref="A1.T7.5.m1.1.1.1"></eq><ci id="A1.T7.5.m1.1.1.2.cmml" xref="A1.T7.5.m1.1.1.2">𝜇</ci><cn type="float" id="A1.T7.5.m1.1.1.3.cmml" xref="A1.T7.5.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.5.m1.1d">\mu=0.01</annotation></semantics></math> is used. Accuracy figures are percentages and the <math id="A1.T7.6.m2.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T7.6.m2.1b"><mo id="A1.T7.6.m2.1.1" xref="A1.T7.6.m2.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.6.m2.1c"><csymbol cd="latexml" id="A1.T7.6.m2.1.1.cmml" xref="A1.T7.6.m2.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.6.m2.1d">\pm</annotation></semantics></math> sign indicates the <math id="A1.T7.7.m3.1" class="ltx_Math" alttext="95\%" display="inline"><semantics id="A1.T7.7.m3.1b"><mrow id="A1.T7.7.m3.1.1" xref="A1.T7.7.m3.1.1.cmml"><mn id="A1.T7.7.m3.1.1.2" xref="A1.T7.7.m3.1.1.2.cmml">95</mn><mo id="A1.T7.7.m3.1.1.1" xref="A1.T7.7.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T7.7.m3.1c"><apply id="A1.T7.7.m3.1.1.cmml" xref="A1.T7.7.m3.1.1"><csymbol cd="latexml" id="A1.T7.7.m3.1.1.1.cmml" xref="A1.T7.7.m3.1.1.1">percent</csymbol><cn type="integer" id="A1.T7.7.m3.1.1.2.cmml" xref="A1.T7.7.m3.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.7.m3.1d">95\%</annotation></semantics></math> confidence interval over <math id="A1.T7.8.m4.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A1.T7.8.m4.1b"><mn id="A1.T7.8.m4.1.1" xref="A1.T7.8.m4.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A1.T7.8.m4.1c"><cn type="integer" id="A1.T7.8.m4.1.1.cmml" xref="A1.T7.8.m4.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.8.m4.1d">3</annotation></semantics></math> runs. Global stands for the global setting, while Personalized stands for the personalized scenario.</figcaption>
<p id="A1.T7.11" class="ltx_p ltx_align_center"><span id="A1.T7.11.1" class="ltx_text">
<span id="A1.T7.11.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:309.7pt;height:252pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A1.T7.11.1.1.1" class="ltx_p"><span id="A1.T7.11.1.1.1.1" class="ltx_text">
<span id="A1.T7.11.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="A1.T7.11.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.1.1.1" class="ltx_td ltx_border_tt"></span>
<span id="A1.T7.11.1.1.1.1.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T7.11.1.1.1.1.1.1.1.3" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T7.11.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_2"><span id="A1.T7.11.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">Global</span></span>
<span id="A1.T7.11.1.1.1.1.1.1.1.5" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T7.11.1.1.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_2"><span id="A1.T7.11.1.1.1.1.1.1.1.6.1" class="ltx_text ltx_font_bold">Personalized</span></span></span>
<span id="A1.T7.11.1.1.1.1.1.2.2" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">Clients</span>
<span id="A1.T7.11.1.1.1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">Shot</span>
<span id="A1.T7.11.1.1.1.1.1.2.2.3" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T7.11.1.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FedProx</span>
<span id="A1.T7.11.1.1.1.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FedAvg</span>
<span id="A1.T7.11.1.1.1.1.1.2.2.6" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T7.11.1.1.1.1.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FedProx</span>
<span id="A1.T7.11.1.1.1.1.1.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FedAvg</span></span>
<span id="A1.T7.11.1.1.1.1.1.3.3" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.3.3.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T7.11.1.1.1.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">2</span>
<span id="A1.T7.11.1.1.1.1.1.3.3.3" class="ltx_td ltx_border_t"></span>
<span id="A1.T7.11.1.1.1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">50.1±2.2</span>
<span id="A1.T7.11.1.1.1.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">49.3±1.3</span>
<span id="A1.T7.11.1.1.1.1.1.3.3.6" class="ltx_td ltx_border_t"></span>
<span id="A1.T7.11.1.1.1.1.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">80.5±1.1</span>
<span id="A1.T7.11.1.1.1.1.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">80.1±0.8</span></span>
<span id="A1.T7.11.1.1.1.1.1.4.4" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.4.4.1" class="ltx_td ltx_align_center">10</span>
<span id="A1.T7.11.1.1.1.1.1.4.4.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T7.11.1.1.1.1.1.4.4.3" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.4.4.4" class="ltx_td ltx_align_center">64.3±1.6</span>
<span id="A1.T7.11.1.1.1.1.1.4.4.5" class="ltx_td ltx_align_center">64.1±1.6</span>
<span id="A1.T7.11.1.1.1.1.1.4.4.6" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.4.4.7" class="ltx_td ltx_align_center">88.9±0.3</span>
<span id="A1.T7.11.1.1.1.1.1.4.4.8" class="ltx_td ltx_align_center">88.8±0.2</span></span>
<span id="A1.T7.11.1.1.1.1.1.5.5" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.5.5.1" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.5.5.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T7.11.1.1.1.1.1.5.5.3" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.5.5.4" class="ltx_td ltx_align_center">71.5±0.8</span>
<span id="A1.T7.11.1.1.1.1.1.5.5.5" class="ltx_td ltx_align_center">71.5±0.8</span>
<span id="A1.T7.11.1.1.1.1.1.5.5.6" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.5.5.7" class="ltx_td ltx_align_center">91.9±0.3</span>
<span id="A1.T7.11.1.1.1.1.1.5.5.8" class="ltx_td ltx_align_center">91.8±0.5</span></span>
<span id="A1.T7.11.1.1.1.1.1.6.6" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.6.6.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T7.11.1.1.1.1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t">2</span>
<span id="A1.T7.11.1.1.1.1.1.6.6.3" class="ltx_td ltx_border_t"></span>
<span id="A1.T7.11.1.1.1.1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t">68.8±0.5</span>
<span id="A1.T7.11.1.1.1.1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_t">68.5±0.3</span>
<span id="A1.T7.11.1.1.1.1.1.6.6.6" class="ltx_td ltx_border_t"></span>
<span id="A1.T7.11.1.1.1.1.1.6.6.7" class="ltx_td ltx_align_center ltx_border_t">84.8±0.6</span>
<span id="A1.T7.11.1.1.1.1.1.6.6.8" class="ltx_td ltx_align_center ltx_border_t">84.6±0.5</span></span>
<span id="A1.T7.11.1.1.1.1.1.7.7" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.7.7.1" class="ltx_td ltx_align_center">50</span>
<span id="A1.T7.11.1.1.1.1.1.7.7.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T7.11.1.1.1.1.1.7.7.3" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.7.7.4" class="ltx_td ltx_align_center">74.0±0.5</span>
<span id="A1.T7.11.1.1.1.1.1.7.7.5" class="ltx_td ltx_align_center">73.8±0.7</span>
<span id="A1.T7.11.1.1.1.1.1.7.7.6" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.7.7.7" class="ltx_td ltx_align_center">91.2±0.4</span>
<span id="A1.T7.11.1.1.1.1.1.7.7.8" class="ltx_td ltx_align_center">91.0±0.4</span></span>
<span id="A1.T7.11.1.1.1.1.1.8.8" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.8.8.1" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.8.8.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T7.11.1.1.1.1.1.8.8.3" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.8.8.4" class="ltx_td ltx_align_center">77.1±0.1</span>
<span id="A1.T7.11.1.1.1.1.1.8.8.5" class="ltx_td ltx_align_center">77.1±0.3</span>
<span id="A1.T7.11.1.1.1.1.1.8.8.6" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.8.8.7" class="ltx_td ltx_align_center">93.5±0.2</span>
<span id="A1.T7.11.1.1.1.1.1.8.8.8" class="ltx_td ltx_align_center">93.4±0.3</span></span>
<span id="A1.T7.11.1.1.1.1.1.9.9" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.9.9.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T7.11.1.1.1.1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_t">2</span>
<span id="A1.T7.11.1.1.1.1.1.9.9.3" class="ltx_td ltx_border_t"></span>
<span id="A1.T7.11.1.1.1.1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_t">74.5±0.2</span>
<span id="A1.T7.11.1.1.1.1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_t">74.4±0.3</span>
<span id="A1.T7.11.1.1.1.1.1.9.9.6" class="ltx_td ltx_border_t"></span>
<span id="A1.T7.11.1.1.1.1.1.9.9.7" class="ltx_td ltx_align_center ltx_border_t">85.3±0.2</span>
<span id="A1.T7.11.1.1.1.1.1.9.9.8" class="ltx_td ltx_align_center ltx_border_t">85.3±0.2</span></span>
<span id="A1.T7.11.1.1.1.1.1.10.10" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.10.10.1" class="ltx_td ltx_align_center">100</span>
<span id="A1.T7.11.1.1.1.1.1.10.10.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T7.11.1.1.1.1.1.10.10.3" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.10.10.4" class="ltx_td ltx_align_center">76.9±0.3</span>
<span id="A1.T7.11.1.1.1.1.1.10.10.5" class="ltx_td ltx_align_center">76.5±0.2</span>
<span id="A1.T7.11.1.1.1.1.1.10.10.6" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.10.10.7" class="ltx_td ltx_align_center">91.4±0.3</span>
<span id="A1.T7.11.1.1.1.1.1.10.10.8" class="ltx_td ltx_align_center">91.3±0.2</span></span>
<span id="A1.T7.11.1.1.1.1.1.11.11" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.11.11.1" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.11.11.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T7.11.1.1.1.1.1.11.11.3" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.11.11.4" class="ltx_td ltx_align_center">78.4±0.2</span>
<span id="A1.T7.11.1.1.1.1.1.11.11.5" class="ltx_td ltx_align_center">78.4±0.1</span>
<span id="A1.T7.11.1.1.1.1.1.11.11.6" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.11.11.7" class="ltx_td ltx_align_center">93.7± 0.2</span>
<span id="A1.T7.11.1.1.1.1.1.11.11.8" class="ltx_td ltx_align_center">93.6±0.2</span></span>
<span id="A1.T7.11.1.1.1.1.1.12.12" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.12.12.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T7.11.1.1.1.1.1.12.12.2" class="ltx_td ltx_align_center ltx_border_t">2</span>
<span id="A1.T7.11.1.1.1.1.1.12.12.3" class="ltx_td ltx_border_t"></span>
<span id="A1.T7.11.1.1.1.1.1.12.12.4" class="ltx_td ltx_align_center ltx_border_t">78.1±0.4</span>
<span id="A1.T7.11.1.1.1.1.1.12.12.5" class="ltx_td ltx_align_center ltx_border_t">77.9±0.4</span>
<span id="A1.T7.11.1.1.1.1.1.12.12.6" class="ltx_td ltx_border_t"></span>
<span id="A1.T7.11.1.1.1.1.1.12.12.7" class="ltx_td ltx_align_center ltx_border_t">86.1±0.3</span>
<span id="A1.T7.11.1.1.1.1.1.12.12.8" class="ltx_td ltx_align_center ltx_border_t">85.8±0.2</span></span>
<span id="A1.T7.11.1.1.1.1.1.13.13" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.13.13.1" class="ltx_td ltx_align_center">500</span>
<span id="A1.T7.11.1.1.1.1.1.13.13.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T7.11.1.1.1.1.1.13.13.3" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.13.13.4" class="ltx_td ltx_align_center">77.9±0.1</span>
<span id="A1.T7.11.1.1.1.1.1.13.13.5" class="ltx_td ltx_align_center">77.6±0.1</span>
<span id="A1.T7.11.1.1.1.1.1.13.13.6" class="ltx_td"></span>
<span id="A1.T7.11.1.1.1.1.1.13.13.7" class="ltx_td ltx_align_center">91.1±0.2</span>
<span id="A1.T7.11.1.1.1.1.1.13.13.8" class="ltx_td ltx_align_center">91.0±0.2</span></span>
<span id="A1.T7.11.1.1.1.1.1.14.14" class="ltx_tr">
<span id="A1.T7.11.1.1.1.1.1.14.14.1" class="ltx_td ltx_border_bb"></span>
<span id="A1.T7.11.1.1.1.1.1.14.14.2" class="ltx_td ltx_align_center ltx_border_bb">10</span>
<span id="A1.T7.11.1.1.1.1.1.14.14.3" class="ltx_td ltx_border_bb"></span>
<span id="A1.T7.11.1.1.1.1.1.14.14.4" class="ltx_td ltx_align_center ltx_border_bb">79.3±0.3</span>
<span id="A1.T7.11.1.1.1.1.1.14.14.5" class="ltx_td ltx_align_center ltx_border_bb">79.2±0.3</span>
<span id="A1.T7.11.1.1.1.1.1.14.14.6" class="ltx_td ltx_border_bb"></span>
<span id="A1.T7.11.1.1.1.1.1.14.14.7" class="ltx_td ltx_align_center ltx_border_bb">94.3±0.1</span>
<span id="A1.T7.11.1.1.1.1.1.14.14.8" class="ltx_td ltx_align_center ltx_border_bb">94.3±0.1</span></span>
</span>
</span></span></span>
</span></span></span></p>
</figure>
<div id="A1.SS8.p3" class="ltx_para ltx_noindent">
<p id="A1.SS8.p3.7" class="ltx_p">To test distributed training of a <span id="A1.SS8.p3.7.1" class="ltx_text ltx_font_smallcaps">FiT</span> model on a more extreme, non-natural image dataset, we also include the results for federated training of <span id="A1.SS8.p3.7.2" class="ltx_text ltx_font_smallcaps">FiT</span> on the Quickdraw dataset.
As there is no pre-defined train/test split for the Quickdraw dataset, we randomly choose <math id="A1.SS8.p3.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A1.SS8.p3.1.m1.1a"><mn id="A1.SS8.p3.1.m1.1.1" xref="A1.SS8.p3.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p3.1.m1.1b"><cn type="integer" id="A1.SS8.p3.1.m1.1.1.cmml" xref="A1.SS8.p3.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p3.1.m1.1c">100</annotation></semantics></math> samples from each of the <math id="A1.SS8.p3.2.m2.1" class="ltx_Math" alttext="345" display="inline"><semantics id="A1.SS8.p3.2.m2.1a"><mn id="A1.SS8.p3.2.m2.1.1" xref="A1.SS8.p3.2.m2.1.1.cmml">345</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p3.2.m2.1b"><cn type="integer" id="A1.SS8.p3.2.m2.1.1.cmml" xref="A1.SS8.p3.2.m2.1.1">345</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p3.2.m2.1c">345</annotation></semantics></math> classes and use them for testing.
We train all federated training models for <math id="A1.SS8.p3.3.m3.1" class="ltx_Math" alttext="120" display="inline"><semantics id="A1.SS8.p3.3.m3.1a"><mn id="A1.SS8.p3.3.m3.1.1" xref="A1.SS8.p3.3.m3.1.1.cmml">120</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p3.3.m3.1b"><cn type="integer" id="A1.SS8.p3.3.m3.1.1.cmml" xref="A1.SS8.p3.3.m3.1.1">120</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p3.3.m3.1c">120</annotation></semantics></math> communication rounds, with <math id="A1.SS8.p3.4.m4.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.SS8.p3.4.m4.1a"><mn id="A1.SS8.p3.4.m4.1.1" xref="A1.SS8.p3.4.m4.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p3.4.m4.1b"><cn type="integer" id="A1.SS8.p3.4.m4.1.1.cmml" xref="A1.SS8.p3.4.m4.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p3.4.m4.1c">5</annotation></semantics></math> clients per round, and <math id="A1.SS8.p3.5.m5.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A1.SS8.p3.5.m5.1a"><mn id="A1.SS8.p3.5.m5.1.1" xref="A1.SS8.p3.5.m5.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p3.5.m5.1b"><cn type="integer" id="A1.SS8.p3.5.m5.1.1.cmml" xref="A1.SS8.p3.5.m5.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p3.5.m5.1c">10</annotation></semantics></math> update steps per client.
Since Quickdraw is a more difficult dataset than CIFAR100, it requires more communication rounds for training.
Each client has <math id="A1.SS8.p3.6.m6.1" class="ltx_Math" alttext="35" display="inline"><semantics id="A1.SS8.p3.6.m6.1a"><mn id="A1.SS8.p3.6.m6.1.1" xref="A1.SS8.p3.6.m6.1.1.cmml">35</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p3.6.m6.1b"><cn type="integer" id="A1.SS8.p3.6.m6.1.1.cmml" xref="A1.SS8.p3.6.m6.1.1">35</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p3.6.m6.1c">35</annotation></semantics></math> classes, which are sampled randomly at the start of training.
In our experiments, we omit the <math id="A1.SS8.p3.7.m7.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A1.SS8.p3.7.m7.1a"><mn id="A1.SS8.p3.7.m7.1.1" xref="A1.SS8.p3.7.m7.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p3.7.m7.1b"><cn type="integer" id="A1.SS8.p3.7.m7.1.1.cmml" xref="A1.SS8.p3.7.m7.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p3.7.m7.1c">10</annotation></semantics></math>-clients case, as the overall amount of data in the system is not enough to even train a robust global upper bound baseline model.</p>
</div>
<figure id="A1.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table A.8: </span>Comparison of BiT and <span id="A1.T8.12.1" class="ltx_text ltx_font_smallcaps">FiT</span> in few-shot federated setting on Quickdraw for different numbers of clients and shots per client. Global setting is used. Accuracy figures are percentages and the <math id="A1.T8.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T8.5.m1.1b"><mo id="A1.T8.5.m1.1.1" xref="A1.T8.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T8.5.m1.1c"><csymbol cd="latexml" id="A1.T8.5.m1.1.1.cmml" xref="A1.T8.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.5.m1.1d">\pm</annotation></semantics></math> sign indicates the <math id="A1.T8.6.m2.1" class="ltx_Math" alttext="95\%" display="inline"><semantics id="A1.T8.6.m2.1b"><mrow id="A1.T8.6.m2.1.1" xref="A1.T8.6.m2.1.1.cmml"><mn id="A1.T8.6.m2.1.1.2" xref="A1.T8.6.m2.1.1.2.cmml">95</mn><mo id="A1.T8.6.m2.1.1.1" xref="A1.T8.6.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T8.6.m2.1c"><apply id="A1.T8.6.m2.1.1.cmml" xref="A1.T8.6.m2.1.1"><csymbol cd="latexml" id="A1.T8.6.m2.1.1.1.cmml" xref="A1.T8.6.m2.1.1.1">percent</csymbol><cn type="integer" id="A1.T8.6.m2.1.1.2.cmml" xref="A1.T8.6.m2.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.6.m2.1d">95\%</annotation></semantics></math> confidence interval over <math id="A1.T8.7.m3.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A1.T8.7.m3.1b"><mn id="A1.T8.7.m3.1.1" xref="A1.T8.7.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A1.T8.7.m3.1c"><cn type="integer" id="A1.T8.7.m3.1.1.cmml" xref="A1.T8.7.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.7.m3.1d">3</annotation></semantics></math> runs. Both models were trained for <math id="A1.T8.8.m4.1" class="ltx_Math" alttext="60" display="inline"><semantics id="A1.T8.8.m4.1b"><mn id="A1.T8.8.m4.1.1" xref="A1.T8.8.m4.1.1.cmml">60</mn><annotation-xml encoding="MathML-Content" id="A1.T8.8.m4.1c"><cn type="integer" id="A1.T8.8.m4.1.1.cmml" xref="A1.T8.8.m4.1.1">60</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.8.m4.1d">60</annotation></semantics></math> communication rounds. Parameter cost indicates the number of parameters sent in server-client communication. <span id="A1.T8.13.2" class="ltx_text ltx_font_italic">Per round</span> is the number of parameters transmitted in each communication round and <span id="A1.T8.14.3" class="ltx_text ltx_font_italic">Overall</span> is the number of parameters transmitted during the whole training.</figcaption>
<div id="A1.T8.15" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:45.1pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-123.1pt,13.8pt) scale(0.61753,0.61753) ;">
<p id="A1.T8.15.1" class="ltx_p"><span id="A1.T8.15.1.1" class="ltx_text">
<span id="A1.T8.15.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:643.7pt;height:73pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A1.T8.15.1.1.1.1" class="ltx_p"><span id="A1.T8.15.1.1.1.1.1" class="ltx_text">
<span id="A1.T8.15.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="A1.T8.15.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T8.15.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_border_tt"></span>
<span id="A1.T8.15.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T8.15.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_2"><span id="A1.T8.15.1.1.1.1.1.1.1.1.3.1" class="ltx_text ltx_font_bold">Parameter cost</span></span>
<span id="A1.T8.15.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T8.15.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3"><span id="A1.T8.15.1.1.1.1.1.1.1.1.5.1" class="ltx_text ltx_font_bold">50 Clients</span></span>
<span id="A1.T8.15.1.1.1.1.1.1.1.1.6" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T8.15.1.1.1.1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3"><span id="A1.T8.15.1.1.1.1.1.1.1.1.7.1" class="ltx_text ltx_font_bold">100 Clients</span></span>
<span id="A1.T8.15.1.1.1.1.1.1.1.1.8" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T8.15.1.1.1.1.1.1.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3"><span id="A1.T8.15.1.1.1.1.1.1.1.1.9.1" class="ltx_text ltx_font_bold">500 Clients</span></span></span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2" class="ltx_tr">
<span id="A1.T8.15.1.1.1.1.1.1.2.2.1" class="ltx_td ltx_align_center">Models</span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.2" class="ltx_td"></span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">Per round</span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">Overall</span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.5" class="ltx_td"></span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">2-Shot</span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.7" class="ltx_td ltx_align_center ltx_border_t">5-Shot</span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.8" class="ltx_td ltx_align_center ltx_border_t">10-Shot</span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.9" class="ltx_td"></span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.10" class="ltx_td ltx_align_center ltx_border_t">2-Shot</span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.11" class="ltx_td ltx_align_center ltx_border_t">5-Shot</span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.12" class="ltx_td ltx_align_center ltx_border_t">10-Shot</span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.13" class="ltx_td"></span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.14" class="ltx_td ltx_align_center ltx_border_t">2-Shot</span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.15" class="ltx_td ltx_align_center ltx_border_t">5-Shot</span>
<span id="A1.T8.15.1.1.1.1.1.1.2.2.16" class="ltx_td ltx_align_center ltx_border_t">10-Shot</span></span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3" class="ltx_tr">
<span id="A1.T8.15.1.1.1.1.1.1.3.3.1" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T8.15.1.1.1.1.1.1.3.3.1.1" class="ltx_text ltx_font_smallcaps">FiT</span></span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.2" class="ltx_td ltx_border_t"></span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T8.15.1.1.1.1.1.1.3.3.3.1" class="ltx_text ltx_font_bold">0.1M</span></span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="A1.T8.15.1.1.1.1.1.1.3.3.4.1" class="ltx_text ltx_font_bold">7M</span></span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.5" class="ltx_td ltx_border_t"></span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">26.6±1.0</span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">40.8±0.6</span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">45.5±0.2</span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.9" class="ltx_td ltx_border_t"></span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.10" class="ltx_td ltx_align_center ltx_border_t">32.0±2.0</span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.11" class="ltx_td ltx_align_center ltx_border_t">44.0±0.7</span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.12" class="ltx_td ltx_align_center ltx_border_t">46.6±0.2</span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.13" class="ltx_td ltx_border_t"></span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.14" class="ltx_td ltx_align_center ltx_border_t">39.4±1.9</span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.15" class="ltx_td ltx_align_center ltx_border_t">45.6±0.1</span>
<span id="A1.T8.15.1.1.1.1.1.1.3.3.16" class="ltx_td ltx_align_center ltx_border_t">47.9±0.4</span></span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4" class="ltx_tr">
<span id="A1.T8.15.1.1.1.1.1.1.4.4.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">BiT</span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.2" class="ltx_td ltx_border_bb ltx_border_t"></span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">242M</span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">14.5B</span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.5" class="ltx_td ltx_border_bb ltx_border_t"></span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T8.15.1.1.1.1.1.1.4.4.6.1" class="ltx_text ltx_font_bold">37.5±2.2</span></span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">42.4±1.7</span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">44.4±0.7</span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.9" class="ltx_td ltx_border_bb ltx_border_t"></span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T8.15.1.1.1.1.1.1.4.4.10.1" class="ltx_text ltx_font_bold">40.4±0.5</span></span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.11" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">44.2±1.4</span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.12" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">46.4±0.9</span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.13" class="ltx_td ltx_border_bb ltx_border_t"></span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.14" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">41.1±2.5</span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.15" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">45.7±2.6</span>
<span id="A1.T8.15.1.1.1.1.1.1.4.4.16" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">47.5±1.7</span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</figure>
<div id="A1.SS8.p4" class="ltx_para ltx_noindent">
<p id="A1.SS8.p4.1" class="ltx_p"><a href="#A1.F3" title="In A.8 Additional Few-shot Federated Learning Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">A.3</span></a> shows global and personalized classification accuracy as a function of communication cost for different numbers of clients and shots per client for Quickdraw, while <a href="#A1.T9" title="In A.8 Additional Few-shot Federated Learning Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.9</span></a> shows the tabular version of this figure.</p>
</div>
<div id="A1.SS8.p5" class="ltx_para ltx_noindent">
<p id="A1.SS8.p5.5" class="ltx_p">Similarly to CIFAR100 experiments, we compare <span id="A1.SS8.p5.5.1" class="ltx_text ltx_font_smallcaps">FiT</span> to BiT on the Quickdraw dataset. We train both models for <math id="A1.SS8.p5.1.m1.1" class="ltx_Math" alttext="60" display="inline"><semantics id="A1.SS8.p5.1.m1.1a"><mn id="A1.SS8.p5.1.m1.1.1" xref="A1.SS8.p5.1.m1.1.1.cmml">60</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p5.1.m1.1b"><cn type="integer" id="A1.SS8.p5.1.m1.1.1.cmml" xref="A1.SS8.p5.1.m1.1.1">60</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p5.1.m1.1c">60</annotation></semantics></math> communication rounds. The results are presented in <a href="#A1.T8" title="In A.8 Additional Few-shot Federated Learning Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">A.8</span></a>. For <math id="A1.SS8.p5.2.m2.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.SS8.p5.2.m2.1a"><mn id="A1.SS8.p5.2.m2.1.1" xref="A1.SS8.p5.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p5.2.m2.1b"><cn type="integer" id="A1.SS8.p5.2.m2.1.1.cmml" xref="A1.SS8.p5.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p5.2.m2.1c">5</annotation></semantics></math> and <math id="A1.SS8.p5.3.m3.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A1.SS8.p5.3.m3.1a"><mn id="A1.SS8.p5.3.m3.1.1" xref="A1.SS8.p5.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p5.3.m3.1b"><cn type="integer" id="A1.SS8.p5.3.m3.1.1.cmml" xref="A1.SS8.p5.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p5.3.m3.1c">10</annotation></semantics></math> shots per class, <span id="A1.SS8.p5.5.2" class="ltx_text ltx_font_smallcaps">FiT</span> performs similarly to BiT for all numbers of clients tested. However, for <math id="A1.SS8.p5.4.m4.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A1.SS8.p5.4.m4.1a"><mn id="A1.SS8.p5.4.m4.1.1" xref="A1.SS8.p5.4.m4.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p5.4.m4.1b"><cn type="integer" id="A1.SS8.p5.4.m4.1.1.cmml" xref="A1.SS8.p5.4.m4.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p5.4.m4.1c">2</annotation></semantics></math>-shot, BiT outperforms <span id="A1.SS8.p5.5.3" class="ltx_text ltx_font_smallcaps">FiT</span> for all numbers of clients tested, but the performance gap is reduced as the number of clients is increased. We attribute this behavior to the use of the ProtoNets classifier. During training at each client’s optimization step, we construct a N-way local ProtoNets classifier using only one image per class, which may result in a classifier not robust enough for reasonable optimization of the FiLM layers. This hypothesis is also supported by <a href="#A1.F3" title="In A.8 Additional Few-shot Federated Learning Results ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">A.3</span></a>, where we see a huge gap between the performance of Federated Learning and centralized learning (the upper bound) for <math id="A1.SS8.p5.5.m5.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A1.SS8.p5.5.m5.1a"><mn id="A1.SS8.p5.5.m5.1.1" xref="A1.SS8.p5.5.m5.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A1.SS8.p5.5.m5.1b"><cn type="integer" id="A1.SS8.p5.5.m5.1.1.cmml" xref="A1.SS8.p5.5.m5.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p5.5.m5.1c">2</annotation></semantics></math>-shot. In contrast, the linear head in BiT is not local and is trained using all clients’ data, thus avoiding this pitfall. This leads us to the following observation – if there is enough local client data to construct a robust metric-based classifier, then Naïve Bayes head helps to significantly reduce communication cost without sacrificing the final model quality. However, if there is not enough local client data, then the use of a linear classification head may be more appropriate.</p>
</div>
<figure id="A1.F3" class="ltx_figure"><img src="/html/2206.08671/assets/x10.png" id="A1.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="227" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure A.3: </span>Global and personalized classification accuracy as a function of communication cost over <math id="A1.F3.3.m1.1" class="ltx_Math" alttext="120" display="inline"><semantics id="A1.F3.3.m1.1b"><mn id="A1.F3.3.m1.1.1" xref="A1.F3.3.m1.1.1.cmml">120</mn><annotation-xml encoding="MathML-Content" id="A1.F3.3.m1.1c"><cn type="integer" id="A1.F3.3.m1.1.1.cmml" xref="A1.F3.3.m1.1.1">120</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F3.3.m1.1d">120</annotation></semantics></math> rounds for different numbers of clients and shots per client on Quickdraw. Classification accuracy is on the vertical axis and is the average of <math id="A1.F3.4.m2.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A1.F3.4.m2.1b"><mn id="A1.F3.4.m2.1.1" xref="A1.F3.4.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A1.F3.4.m2.1c"><cn type="integer" id="A1.F3.4.m2.1.1.cmml" xref="A1.F3.4.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F3.4.m2.1d">3</annotation></semantics></math> runs with different data sampling seeds. The color of the line indicates the number of shots per class. The solid line shows the federated learning model, while dashed and dotted lines indicate the upper and lower bounds baselines, respectively.</figcaption>
</figure>
<figure id="A1.T9" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table A.9: </span>Few-shot Federated Learning Results on Quickdraw for different numbers of clients and shots per client. Accuracy figures are percentages and the <math id="A1.T9.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.T9.4.m1.1b"><mo id="A1.T9.4.m1.1.1" xref="A1.T9.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T9.4.m1.1c"><csymbol cd="latexml" id="A1.T9.4.m1.1.1.cmml" xref="A1.T9.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T9.4.m1.1d">\pm</annotation></semantics></math> sign indicates the <math id="A1.T9.5.m2.1" class="ltx_Math" alttext="95\%" display="inline"><semantics id="A1.T9.5.m2.1b"><mrow id="A1.T9.5.m2.1.1" xref="A1.T9.5.m2.1.1.cmml"><mn id="A1.T9.5.m2.1.1.2" xref="A1.T9.5.m2.1.1.2.cmml">95</mn><mo id="A1.T9.5.m2.1.1.1" xref="A1.T9.5.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T9.5.m2.1c"><apply id="A1.T9.5.m2.1.1.cmml" xref="A1.T9.5.m2.1.1"><csymbol cd="latexml" id="A1.T9.5.m2.1.1.1.cmml" xref="A1.T9.5.m2.1.1.1">percent</csymbol><cn type="integer" id="A1.T9.5.m2.1.1.2.cmml" xref="A1.T9.5.m2.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T9.5.m2.1d">95\%</annotation></semantics></math> confidence interval over <math id="A1.T9.6.m3.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A1.T9.6.m3.1b"><mn id="A1.T9.6.m3.1.1" xref="A1.T9.6.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A1.T9.6.m3.1c"><cn type="integer" id="A1.T9.6.m3.1.1.cmml" xref="A1.T9.6.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T9.6.m3.1d">3</annotation></semantics></math> runs. Global stands for the global setting, while Personalized stands for the personalized scenario. FL indicates Federated Learning training.</figcaption>
<div id="A1.T9.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:162.8pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-44.1pt,18.0pt) scale(0.81834,0.81834) ;">
<p id="A1.T9.7.1" class="ltx_p"><span id="A1.T9.7.1.1" class="ltx_text">
<span id="A1.T9.7.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:485.7pt;height:199pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A1.T9.7.1.1.1.1" class="ltx_p"><span id="A1.T9.7.1.1.1.1.1" class="ltx_text">
<span id="A1.T9.7.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="A1.T9.7.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T9.7.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_border_tt"></span>
<span id="A1.T9.7.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T9.7.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T9.7.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3"><span id="A1.T9.7.1.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">Global</span></span>
<span id="A1.T9.7.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></span>
<span id="A1.T9.7.1.1.1.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3"><span id="A1.T9.7.1.1.1.1.1.1.1.1.6.1" class="ltx_text ltx_font_bold">Personalized</span></span></span>
<span id="A1.T9.7.1.1.1.1.1.1.2.2" class="ltx_tr">
<span id="A1.T9.7.1.1.1.1.1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">Clients</span>
<span id="A1.T9.7.1.1.1.1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">Shot</span>
<span id="A1.T9.7.1.1.1.1.1.1.2.2.3" class="ltx_td ltx_th ltx_th_column ltx_border_t"></span>
<span id="A1.T9.7.1.1.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Lower Bound</span>
<span id="A1.T9.7.1.1.1.1.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FL</span>
<span id="A1.T9.7.1.1.1.1.1.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Upper Bound</span>
<span id="A1.T9.7.1.1.1.1.1.1.2.2.7" class="ltx_td ltx_th ltx_th_column"></span>
<span id="A1.T9.7.1.1.1.1.1.1.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Lower Bound</span>
<span id="A1.T9.7.1.1.1.1.1.1.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FL</span>
<span id="A1.T9.7.1.1.1.1.1.1.2.2.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Upper Bound</span></span>
<span id="A1.T9.7.1.1.1.1.1.1.3.3" class="ltx_tr">
<span id="A1.T9.7.1.1.1.1.1.1.3.3.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T9.7.1.1.1.1.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">2</span>
<span id="A1.T9.7.1.1.1.1.1.1.3.3.3" class="ltx_td ltx_border_t"></span>
<span id="A1.T9.7.1.1.1.1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">26.3±0.4</span>
<span id="A1.T9.7.1.1.1.1.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">29.0±0.5</span>
<span id="A1.T9.7.1.1.1.1.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">32.9±0.6</span>
<span id="A1.T9.7.1.1.1.1.1.1.3.3.7" class="ltx_td ltx_border_t"></span>
<span id="A1.T9.7.1.1.1.1.1.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">36.9±0.2</span>
<span id="A1.T9.7.1.1.1.1.1.1.3.3.9" class="ltx_td ltx_align_center ltx_border_t">43.4±0.6</span>
<span id="A1.T9.7.1.1.1.1.1.1.3.3.10" class="ltx_td ltx_align_center ltx_border_t">64.2±0.8</span></span>
<span id="A1.T9.7.1.1.1.1.1.1.4.4" class="ltx_tr">
<span id="A1.T9.7.1.1.1.1.1.1.4.4.1" class="ltx_td ltx_align_center">50</span>
<span id="A1.T9.7.1.1.1.1.1.1.4.4.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T9.7.1.1.1.1.1.1.4.4.3" class="ltx_td"></span>
<span id="A1.T9.7.1.1.1.1.1.1.4.4.4" class="ltx_td ltx_align_center">30.6±0.3</span>
<span id="A1.T9.7.1.1.1.1.1.1.4.4.5" class="ltx_td ltx_align_center">40.7±0.6</span>
<span id="A1.T9.7.1.1.1.1.1.1.4.4.6" class="ltx_td ltx_align_center">43.9±0.5</span>
<span id="A1.T9.7.1.1.1.1.1.1.4.4.7" class="ltx_td"></span>
<span id="A1.T9.7.1.1.1.1.1.1.4.4.8" class="ltx_td ltx_align_center">48.8±0.4</span>
<span id="A1.T9.7.1.1.1.1.1.1.4.4.9" class="ltx_td ltx_align_center">63.6±0.3</span>
<span id="A1.T9.7.1.1.1.1.1.1.4.4.10" class="ltx_td ltx_align_center">74.3±0.4</span></span>
<span id="A1.T9.7.1.1.1.1.1.1.5.5" class="ltx_tr">
<span id="A1.T9.7.1.1.1.1.1.1.5.5.1" class="ltx_td"></span>
<span id="A1.T9.7.1.1.1.1.1.1.5.5.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T9.7.1.1.1.1.1.1.5.5.3" class="ltx_td"></span>
<span id="A1.T9.7.1.1.1.1.1.1.5.5.4" class="ltx_td ltx_align_center">34.3±0.7</span>
<span id="A1.T9.7.1.1.1.1.1.1.5.5.5" class="ltx_td ltx_align_center">44.9±0.1</span>
<span id="A1.T9.7.1.1.1.1.1.1.5.5.6" class="ltx_td ltx_align_center">47.2±0.2</span>
<span id="A1.T9.7.1.1.1.1.1.1.5.5.7" class="ltx_td"></span>
<span id="A1.T9.7.1.1.1.1.1.1.5.5.8" class="ltx_td ltx_align_center">56.5±0.8</span>
<span id="A1.T9.7.1.1.1.1.1.1.5.5.9" class="ltx_td ltx_align_center">71.1±0.1</span>
<span id="A1.T9.7.1.1.1.1.1.1.5.5.10" class="ltx_td ltx_align_center">76.6±0.2</span></span>
<span id="A1.T9.7.1.1.1.1.1.1.6.6" class="ltx_tr">
<span id="A1.T9.7.1.1.1.1.1.1.6.6.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T9.7.1.1.1.1.1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t">2</span>
<span id="A1.T9.7.1.1.1.1.1.1.6.6.3" class="ltx_td ltx_border_t"></span>
<span id="A1.T9.7.1.1.1.1.1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t">28.5±0.1</span>
<span id="A1.T9.7.1.1.1.1.1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_t">32.4±0.8</span>
<span id="A1.T9.7.1.1.1.1.1.1.6.6.6" class="ltx_td ltx_align_center ltx_border_t">43.0±1.0</span>
<span id="A1.T9.7.1.1.1.1.1.1.6.6.7" class="ltx_td ltx_border_t"></span>
<span id="A1.T9.7.1.1.1.1.1.1.6.6.8" class="ltx_td ltx_align_center ltx_border_t">35.9±0.3</span>
<span id="A1.T9.7.1.1.1.1.1.1.6.6.9" class="ltx_td ltx_align_center ltx_border_t">43.9±1.0</span>
<span id="A1.T9.7.1.1.1.1.1.1.6.6.10" class="ltx_td ltx_align_center ltx_border_t">73.1±0.4</span></span>
<span id="A1.T9.7.1.1.1.1.1.1.7.7" class="ltx_tr">
<span id="A1.T9.7.1.1.1.1.1.1.7.7.1" class="ltx_td ltx_align_center">100</span>
<span id="A1.T9.7.1.1.1.1.1.1.7.7.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T9.7.1.1.1.1.1.1.7.7.3" class="ltx_td"></span>
<span id="A1.T9.7.1.1.1.1.1.1.7.7.4" class="ltx_td ltx_align_center">32.8±0.4</span>
<span id="A1.T9.7.1.1.1.1.1.1.7.7.5" class="ltx_td ltx_align_center">44.1±0.4</span>
<span id="A1.T9.7.1.1.1.1.1.1.7.7.6" class="ltx_td ltx_align_center">47.4±0.1</span>
<span id="A1.T9.7.1.1.1.1.1.1.7.7.7" class="ltx_td"></span>
<span id="A1.T9.7.1.1.1.1.1.1.7.7.8" class="ltx_td ltx_align_center">48.6±0.9</span>
<span id="A1.T9.7.1.1.1.1.1.1.7.7.9" class="ltx_td ltx_align_center">64.9±0.8</span>
<span id="A1.T9.7.1.1.1.1.1.1.7.7.10" class="ltx_td ltx_align_center">76.4±0.3</span></span>
<span id="A1.T9.7.1.1.1.1.1.1.8.8" class="ltx_tr">
<span id="A1.T9.7.1.1.1.1.1.1.8.8.1" class="ltx_td"></span>
<span id="A1.T9.7.1.1.1.1.1.1.8.8.2" class="ltx_td ltx_align_center">10</span>
<span id="A1.T9.7.1.1.1.1.1.1.8.8.3" class="ltx_td"></span>
<span id="A1.T9.7.1.1.1.1.1.1.8.8.4" class="ltx_td ltx_align_center">35.3±0.1</span>
<span id="A1.T9.7.1.1.1.1.1.1.8.8.5" class="ltx_td ltx_align_center">46.8±0.1</span>
<span id="A1.T9.7.1.1.1.1.1.1.8.8.6" class="ltx_td ltx_align_center">48.7±0.2</span>
<span id="A1.T9.7.1.1.1.1.1.1.8.8.7" class="ltx_td"></span>
<span id="A1.T9.7.1.1.1.1.1.1.8.8.8" class="ltx_td ltx_align_center">55.5±0.4</span>
<span id="A1.T9.7.1.1.1.1.1.1.8.8.9" class="ltx_td ltx_align_center">71.5±0.5</span>
<span id="A1.T9.7.1.1.1.1.1.1.8.8.10" class="ltx_td ltx_align_center">77.2±0.3</span></span>
<span id="A1.T9.7.1.1.1.1.1.1.9.9" class="ltx_tr">
<span id="A1.T9.7.1.1.1.1.1.1.9.9.1" class="ltx_td ltx_border_t"></span>
<span id="A1.T9.7.1.1.1.1.1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_t">2</span>
<span id="A1.T9.7.1.1.1.1.1.1.9.9.3" class="ltx_td ltx_border_t"></span>
<span id="A1.T9.7.1.1.1.1.1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_t">32.0±0.3</span>
<span id="A1.T9.7.1.1.1.1.1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_t">40.3±2.4</span>
<span id="A1.T9.7.1.1.1.1.1.1.9.9.6" class="ltx_td ltx_align_center ltx_border_t">49.1±0.3</span>
<span id="A1.T9.7.1.1.1.1.1.1.9.9.7" class="ltx_td ltx_border_t"></span>
<span id="A1.T9.7.1.1.1.1.1.1.9.9.8" class="ltx_td ltx_align_center ltx_border_t">36.2±0.1</span>
<span id="A1.T9.7.1.1.1.1.1.1.9.9.9" class="ltx_td ltx_align_center ltx_border_t">49.2±2.4</span>
<span id="A1.T9.7.1.1.1.1.1.1.9.9.10" class="ltx_td ltx_align_center ltx_border_t">77.6±0.3</span></span>
<span id="A1.T9.7.1.1.1.1.1.1.10.10" class="ltx_tr">
<span id="A1.T9.7.1.1.1.1.1.1.10.10.1" class="ltx_td ltx_align_center">500</span>
<span id="A1.T9.7.1.1.1.1.1.1.10.10.2" class="ltx_td ltx_align_center">5</span>
<span id="A1.T9.7.1.1.1.1.1.1.10.10.3" class="ltx_td"></span>
<span id="A1.T9.7.1.1.1.1.1.1.10.10.4" class="ltx_td ltx_align_center">34.0±0.1</span>
<span id="A1.T9.7.1.1.1.1.1.1.10.10.5" class="ltx_td ltx_align_center">46.1±0.1</span>
<span id="A1.T9.7.1.1.1.1.1.1.10.10.6" class="ltx_td ltx_align_center">48.6±2.2</span>
<span id="A1.T9.7.1.1.1.1.1.1.10.10.7" class="ltx_td"></span>
<span id="A1.T9.7.1.1.1.1.1.1.10.10.8" class="ltx_td ltx_align_center">48.7±0.2</span>
<span id="A1.T9.7.1.1.1.1.1.1.10.10.9" class="ltx_td ltx_align_center">65.8±0.3</span>
<span id="A1.T9.7.1.1.1.1.1.1.10.10.10" class="ltx_td ltx_align_center">77.0±1.7</span></span>
<span id="A1.T9.7.1.1.1.1.1.1.11.11" class="ltx_tr">
<span id="A1.T9.7.1.1.1.1.1.1.11.11.1" class="ltx_td ltx_border_bb"></span>
<span id="A1.T9.7.1.1.1.1.1.1.11.11.2" class="ltx_td ltx_align_center ltx_border_bb">10</span>
<span id="A1.T9.7.1.1.1.1.1.1.11.11.3" class="ltx_td ltx_border_bb"></span>
<span id="A1.T9.7.1.1.1.1.1.1.11.11.4" class="ltx_td ltx_align_center ltx_border_bb">36.1±0.1</span>
<span id="A1.T9.7.1.1.1.1.1.1.11.11.5" class="ltx_td ltx_align_center ltx_border_bb">48.1±0.4</span>
<span id="A1.T9.7.1.1.1.1.1.1.11.11.6" class="ltx_td ltx_align_center ltx_border_bb">48.2±1.2</span>
<span id="A1.T9.7.1.1.1.1.1.1.11.11.7" class="ltx_td ltx_border_bb"></span>
<span id="A1.T9.7.1.1.1.1.1.1.11.11.8" class="ltx_td ltx_align_center ltx_border_bb">55.7±0.1</span>
<span id="A1.T9.7.1.1.1.1.1.1.11.11.9" class="ltx_td ltx_align_center ltx_border_bb">72.2±0.2</span>
<span id="A1.T9.7.1.1.1.1.1.1.11.11.10" class="ltx_td ltx_align_center ltx_border_bb">76.7±0.9</span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</figure>
</section>
<section id="A1.SS9" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.9 </span>Connections to Personalized Federated Learning</h3>

<div id="A1.SS9.p1" class="ltx_para ltx_noindent">
<p id="A1.SS9.p1.1" class="ltx_p">Partial model based personalized federated learning (PFL) <cite class="ltx_cite ltx_citemacro_citep">(Collins et al., <a href="#bib.bib9" title="" class="ltx_ref">2021</a>; Arivazhagan et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>; Liang et al., <a href="#bib.bib34" title="" class="ltx_ref">2020</a>; Pillutla et al., <a href="#bib.bib46" title="" class="ltx_ref">2022</a>)</cite> is related to the personalized setting in our federated learning experiments, but it is different in important regards.
With regard to the similarities, the local Naïve Bayes head parameters in our approach may be considered as “personal” parameters (there are personalized parameters for each client), while the FiLM parameters could be viewed as “shared” parameters.
However, there are a few major differences between the ideas:</p>
<ul id="A1.I2" class="ltx_itemize">
<li id="A1.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I2.i1.p1" class="ltx_para">
<p id="A1.I2.i1.p1.1" class="ltx_p">The personalized parameters in our setting, i.e. the ProtoNets head, does not require an optimization loop to be learned. This simplifies deployment significantly.</p>
</div>
</li>
<li id="A1.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I2.i2.p1" class="ltx_para">
<p id="A1.I2.i2.p1.1" class="ltx_p">The partial model personalization literature <cite class="ltx_cite ltx_citemacro_citep">(Collins et al., <a href="#bib.bib9" title="" class="ltx_ref">2021</a>; Arivazhagan et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>; Liang et al., <a href="#bib.bib34" title="" class="ltx_ref">2020</a>; Pillutla et al., <a href="#bib.bib46" title="" class="ltx_ref">2022</a>)</cite> is more concerned with proposing stable federated training algorithms that would work within heterogeneous settings, where clients have diverse data and standard FedAvg algorithm would fail, thus necessitating a need to introduce ‘personal’ parameters. In contrast, personalized heads are required in our setup as each user has a different classification task to perform. Moreover, we propose a particular architecture that would be highly suitable for federated learning applications, as the number of parameters required to be transmitted is small, while most methods in PFL propose architecture agnostic optimization algorithms. Our model can then be trained with an arbitrary Federated Learning algorithm.</p>
</div>
</li>
<li id="A1.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I2.i3.p1" class="ltx_para ltx_noindent">
<p id="A1.I2.i3.p1.1" class="ltx_p">Another distinctive difference between the model personalization federated learning literature and our work is that in the former most of the methods train all model’s parameters, while in our work we used a deep pretrained network and fine-tune only the FiLM layers.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="A1.SS10" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.10 </span><span id="A1.SS10.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> Training Algorithms</h3>

<div id="A1.SS10.p1" class="ltx_para">
<p id="A1.SS10.p1.1" class="ltx_p"><a href="#alg1" title="In A.10 FiT Training Algorithms ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">A.1</span></a> and <a href="#alg2" title="In A.10 FiT Training Algorithms ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">A.2</span></a> detail how episodic fine-tuning tasks are split and sampled, respectively, for use in the <span id="A1.SS10.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> training protocol.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.4.1.1" class="ltx_text ltx_font_bold">Algorithm A.1</span> </span> Splitting the downstream dataset <math id="alg1.2.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="alg1.2.m1.1b"><mi class="ltx_font_mathcaligraphic" id="alg1.2.m1.1.1" xref="alg1.2.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m1.1c"><ci id="alg1.2.m1.1.1.cmml" xref="alg1.2.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m1.1d">\mathcal{D}</annotation></semantics></math></figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><math id="alg1.l1.m1.3" class="ltx_Math" alttext="\mathcal{D}=\{({\bm{x}}_{n},y_{n})\}_{n=1}^{N}=\{{\bm{x}},{\bm{y}}\}" display="inline"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.3.3.3" xref="alg1.l1.m1.3.3.3.cmml">𝒟</mi><mo id="alg1.l1.m1.3.3.4" xref="alg1.l1.m1.3.3.4.cmml">=</mo><msubsup id="alg1.l1.m1.3.3.1" xref="alg1.l1.m1.3.3.1.cmml"><mrow id="alg1.l1.m1.3.3.1.1.1.1" xref="alg1.l1.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l1.m1.3.3.1.1.1.1.2" xref="alg1.l1.m1.3.3.1.1.1.2.cmml">{</mo><mrow id="alg1.l1.m1.3.3.1.1.1.1.1.2" xref="alg1.l1.m1.3.3.1.1.1.1.1.3.cmml"><mo stretchy="false" id="alg1.l1.m1.3.3.1.1.1.1.1.2.3" xref="alg1.l1.m1.3.3.1.1.1.1.1.3.cmml">(</mo><msub id="alg1.l1.m1.3.3.1.1.1.1.1.1.1" xref="alg1.l1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m1.3.3.1.1.1.1.1.1.1.2" xref="alg1.l1.m1.3.3.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="alg1.l1.m1.3.3.1.1.1.1.1.1.1.3" xref="alg1.l1.m1.3.3.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="alg1.l1.m1.3.3.1.1.1.1.1.2.4" xref="alg1.l1.m1.3.3.1.1.1.1.1.3.cmml">,</mo><msub id="alg1.l1.m1.3.3.1.1.1.1.1.2.2" xref="alg1.l1.m1.3.3.1.1.1.1.1.2.2.cmml"><mi id="alg1.l1.m1.3.3.1.1.1.1.1.2.2.2" xref="alg1.l1.m1.3.3.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="alg1.l1.m1.3.3.1.1.1.1.1.2.2.3" xref="alg1.l1.m1.3.3.1.1.1.1.1.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="alg1.l1.m1.3.3.1.1.1.1.1.2.5" xref="alg1.l1.m1.3.3.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="alg1.l1.m1.3.3.1.1.1.1.3" xref="alg1.l1.m1.3.3.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m1.3.3.1.1.3" xref="alg1.l1.m1.3.3.1.1.3.cmml"><mi id="alg1.l1.m1.3.3.1.1.3.2" xref="alg1.l1.m1.3.3.1.1.3.2.cmml">n</mi><mo id="alg1.l1.m1.3.3.1.1.3.1" xref="alg1.l1.m1.3.3.1.1.3.1.cmml">=</mo><mn id="alg1.l1.m1.3.3.1.1.3.3" xref="alg1.l1.m1.3.3.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m1.3.3.1.3" xref="alg1.l1.m1.3.3.1.3.cmml">N</mi></msubsup><mo id="alg1.l1.m1.3.3.5" xref="alg1.l1.m1.3.3.5.cmml">=</mo><mrow id="alg1.l1.m1.3.3.6.2" xref="alg1.l1.m1.3.3.6.1.cmml"><mo stretchy="false" id="alg1.l1.m1.3.3.6.2.1" xref="alg1.l1.m1.3.3.6.1.cmml">{</mo><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">𝒙</mi><mo id="alg1.l1.m1.3.3.6.2.2" xref="alg1.l1.m1.3.3.6.1.cmml">,</mo><mi id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">𝒚</mi><mo stretchy="false" id="alg1.l1.m1.3.3.6.2.3" xref="alg1.l1.m1.3.3.6.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3"><and id="alg1.l1.m1.3.3a.cmml" xref="alg1.l1.m1.3.3"></and><apply id="alg1.l1.m1.3.3b.cmml" xref="alg1.l1.m1.3.3"><eq id="alg1.l1.m1.3.3.4.cmml" xref="alg1.l1.m1.3.3.4"></eq><ci id="alg1.l1.m1.3.3.3.cmml" xref="alg1.l1.m1.3.3.3">𝒟</ci><apply id="alg1.l1.m1.3.3.1.cmml" xref="alg1.l1.m1.3.3.1"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.1.2.cmml" xref="alg1.l1.m1.3.3.1">superscript</csymbol><apply id="alg1.l1.m1.3.3.1.1.cmml" xref="alg1.l1.m1.3.3.1"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.1.1.2.cmml" xref="alg1.l1.m1.3.3.1">subscript</csymbol><set id="alg1.l1.m1.3.3.1.1.1.2.cmml" xref="alg1.l1.m1.3.3.1.1.1.1"><interval closure="open" id="alg1.l1.m1.3.3.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.1.2"><apply id="alg1.l1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.1.1.1.2">𝒙</ci><ci id="alg1.l1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="alg1.l1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l1.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.1.2.2.2">𝑦</ci><ci id="alg1.l1.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.1.2.2.3">𝑛</ci></apply></interval></set><apply id="alg1.l1.m1.3.3.1.1.3.cmml" xref="alg1.l1.m1.3.3.1.1.3"><eq id="alg1.l1.m1.3.3.1.1.3.1.cmml" xref="alg1.l1.m1.3.3.1.1.3.1"></eq><ci id="alg1.l1.m1.3.3.1.1.3.2.cmml" xref="alg1.l1.m1.3.3.1.1.3.2">𝑛</ci><cn type="integer" id="alg1.l1.m1.3.3.1.1.3.3.cmml" xref="alg1.l1.m1.3.3.1.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m1.3.3.1.3.cmml" xref="alg1.l1.m1.3.3.1.3">𝑁</ci></apply></apply><apply id="alg1.l1.m1.3.3c.cmml" xref="alg1.l1.m1.3.3"><eq id="alg1.l1.m1.3.3.5.cmml" xref="alg1.l1.m1.3.3.5"></eq><share href="#alg1.l1.m1.3.3.1.cmml" id="alg1.l1.m1.3.3d.cmml" xref="alg1.l1.m1.3.3"></share><set id="alg1.l1.m1.3.3.6.1.cmml" xref="alg1.l1.m1.3.3.6.2"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝒙</ci><ci id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">𝒚</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">\mathcal{D}=\{({\bm{x}}_{n},y_{n})\}_{n=1}^{N}=\{{\bm{x}},{\bm{y}}\}</annotation></semantics></math>: downstream dataset

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><span id="alg1.l2.1" class="ltx_text ltx_font_typewriter">unique()</span> <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\equiv" display="inline"><semantics id="alg1.l2.m1.1a"><mo id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">≡</mo><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><equivalent id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"></equivalent></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\equiv</annotation></semantics></math> function that returns a list of unique classes and list of counts of each class

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><span id="alg1.l3.1" class="ltx_text ltx_font_typewriter">select_by_class</span>() <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\equiv" display="inline"><semantics id="alg1.l3.m1.1a"><mo id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">≡</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><equivalent id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"></equivalent></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\equiv</annotation></semantics></math> function that extracts samples of a specified class from a dataset

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span><span id="alg1.l4.1" class="ltx_text ltx_font_bold">procedure</span> <span id="alg1.l4.2" class="ltx_text ltx_font_smallcaps">split</span>(<math id="alg1.l4.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="alg1.l4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\mathcal{D}</annotation></semantics></math>)

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\mathcal{D}_{train}\leftarrow[\,]" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">𝒟</mi><mrow id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml"><mi id="alg1.l5.m1.1.1.2.3.2" xref="alg1.l5.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.2.3.1" xref="alg1.l5.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l5.m1.1.1.2.3.3" xref="alg1.l5.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.2.3.1a" xref="alg1.l5.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l5.m1.1.1.2.3.4" xref="alg1.l5.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.2.3.1b" xref="alg1.l5.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l5.m1.1.1.2.3.5" xref="alg1.l5.m1.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.2.3.1c" xref="alg1.l5.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l5.m1.1.1.2.3.6" xref="alg1.l5.m1.1.1.2.3.6.cmml">n</mi></mrow></msub><mo stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><mrow id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.cmml"><mo rspace="0.170em" stretchy="false" id="alg1.l5.m1.1.1.3.2.1" xref="alg1.l5.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="alg1.l5.m1.1.1.3.2.2" xref="alg1.l5.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝒟</ci><apply id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3"><times id="alg1.l5.m1.1.1.2.3.1.cmml" xref="alg1.l5.m1.1.1.2.3.1"></times><ci id="alg1.l5.m1.1.1.2.3.2.cmml" xref="alg1.l5.m1.1.1.2.3.2">𝑡</ci><ci id="alg1.l5.m1.1.1.2.3.3.cmml" xref="alg1.l5.m1.1.1.2.3.3">𝑟</ci><ci id="alg1.l5.m1.1.1.2.3.4.cmml" xref="alg1.l5.m1.1.1.2.3.4">𝑎</ci><ci id="alg1.l5.m1.1.1.2.3.5.cmml" xref="alg1.l5.m1.1.1.2.3.5">𝑖</ci><ci id="alg1.l5.m1.1.1.2.3.6.cmml" xref="alg1.l5.m1.1.1.2.3.6">𝑛</ci></apply></apply><list id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\mathcal{D}_{train}\leftarrow[\,]</annotation></semantics></math> <span id="alg1.l5.2" class="ltx_text" style="float:right;"><math id="alg1.l5.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation></semantics></math> Create an empty list to hold <math id="alg1.l5.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="alg1.l5.2.m2.1a"><msub id="alg1.l5.2.m2.1.1" xref="alg1.l5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.2.m2.1.1.2" xref="alg1.l5.2.m2.1.1.2.cmml">𝒟</mi><mrow id="alg1.l5.2.m2.1.1.3" xref="alg1.l5.2.m2.1.1.3.cmml"><mi id="alg1.l5.2.m2.1.1.3.2" xref="alg1.l5.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l5.2.m2.1.1.3.1" xref="alg1.l5.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l5.2.m2.1.1.3.3" xref="alg1.l5.2.m2.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l5.2.m2.1.1.3.1a" xref="alg1.l5.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l5.2.m2.1.1.3.4" xref="alg1.l5.2.m2.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l5.2.m2.1.1.3.1b" xref="alg1.l5.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l5.2.m2.1.1.3.5" xref="alg1.l5.2.m2.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l5.2.m2.1.1.3.1c" xref="alg1.l5.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l5.2.m2.1.1.3.6" xref="alg1.l5.2.m2.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.2.m2.1b"><apply id="alg1.l5.2.m2.1.1.cmml" xref="alg1.l5.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.2.m2.1.1.1.cmml" xref="alg1.l5.2.m2.1.1">subscript</csymbol><ci id="alg1.l5.2.m2.1.1.2.cmml" xref="alg1.l5.2.m2.1.1.2">𝒟</ci><apply id="alg1.l5.2.m2.1.1.3.cmml" xref="alg1.l5.2.m2.1.1.3"><times id="alg1.l5.2.m2.1.1.3.1.cmml" xref="alg1.l5.2.m2.1.1.3.1"></times><ci id="alg1.l5.2.m2.1.1.3.2.cmml" xref="alg1.l5.2.m2.1.1.3.2">𝑡</ci><ci id="alg1.l5.2.m2.1.1.3.3.cmml" xref="alg1.l5.2.m2.1.1.3.3">𝑟</ci><ci id="alg1.l5.2.m2.1.1.3.4.cmml" xref="alg1.l5.2.m2.1.1.3.4">𝑎</ci><ci id="alg1.l5.2.m2.1.1.3.5.cmml" xref="alg1.l5.2.m2.1.1.3.5">𝑖</ci><ci id="alg1.l5.2.m2.1.1.3.6.cmml" xref="alg1.l5.2.m2.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.2.m2.1c">\mathcal{D}_{train}</annotation></semantics></math>
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\mathcal{D}_{test}\leftarrow[\,]" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msub id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">𝒟</mi><mrow id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml"><mi id="alg1.l6.m1.1.1.2.3.2" xref="alg1.l6.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.2.3.1" xref="alg1.l6.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.1.1.2.3.3" xref="alg1.l6.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.2.3.1a" xref="alg1.l6.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.1.1.2.3.4" xref="alg1.l6.m1.1.1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.2.3.1b" xref="alg1.l6.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.1.1.2.3.5" xref="alg1.l6.m1.1.1.2.3.5.cmml">t</mi></mrow></msub><mo stretchy="false" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">←</mo><mrow id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.cmml"><mo rspace="0.170em" stretchy="false" id="alg1.l6.m1.1.1.3.2.1" xref="alg1.l6.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="alg1.l6.m1.1.1.3.2.2" xref="alg1.l6.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">𝒟</ci><apply id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3"><times id="alg1.l6.m1.1.1.2.3.1.cmml" xref="alg1.l6.m1.1.1.2.3.1"></times><ci id="alg1.l6.m1.1.1.2.3.2.cmml" xref="alg1.l6.m1.1.1.2.3.2">𝑡</ci><ci id="alg1.l6.m1.1.1.2.3.3.cmml" xref="alg1.l6.m1.1.1.2.3.3">𝑒</ci><ci id="alg1.l6.m1.1.1.2.3.4.cmml" xref="alg1.l6.m1.1.1.2.3.4">𝑠</ci><ci id="alg1.l6.m1.1.1.2.3.5.cmml" xref="alg1.l6.m1.1.1.2.3.5">𝑡</ci></apply></apply><list id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\mathcal{D}_{test}\leftarrow[\,]</annotation></semantics></math> <span id="alg1.l6.2" class="ltx_text" style="float:right;"><math id="alg1.l6.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation></semantics></math> Create an empty list to hold <math id="alg1.l6.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="alg1.l6.2.m2.1a"><msub id="alg1.l6.2.m2.1.1" xref="alg1.l6.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.2.m2.1.1.2" xref="alg1.l6.2.m2.1.1.2.cmml">𝒟</mi><mrow id="alg1.l6.2.m2.1.1.3" xref="alg1.l6.2.m2.1.1.3.cmml"><mi id="alg1.l6.2.m2.1.1.3.2" xref="alg1.l6.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l6.2.m2.1.1.3.1" xref="alg1.l6.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l6.2.m2.1.1.3.3" xref="alg1.l6.2.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.2.m2.1.1.3.1a" xref="alg1.l6.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l6.2.m2.1.1.3.4" xref="alg1.l6.2.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l6.2.m2.1.1.3.1b" xref="alg1.l6.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l6.2.m2.1.1.3.5" xref="alg1.l6.2.m2.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.2.m2.1b"><apply id="alg1.l6.2.m2.1.1.cmml" xref="alg1.l6.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.2.m2.1.1.1.cmml" xref="alg1.l6.2.m2.1.1">subscript</csymbol><ci id="alg1.l6.2.m2.1.1.2.cmml" xref="alg1.l6.2.m2.1.1.2">𝒟</ci><apply id="alg1.l6.2.m2.1.1.3.cmml" xref="alg1.l6.2.m2.1.1.3"><times id="alg1.l6.2.m2.1.1.3.1.cmml" xref="alg1.l6.2.m2.1.1.3.1"></times><ci id="alg1.l6.2.m2.1.1.3.2.cmml" xref="alg1.l6.2.m2.1.1.3.2">𝑡</ci><ci id="alg1.l6.2.m2.1.1.3.3.cmml" xref="alg1.l6.2.m2.1.1.3.3">𝑒</ci><ci id="alg1.l6.2.m2.1.1.3.4.cmml" xref="alg1.l6.2.m2.1.1.3.4">𝑠</ci><ci id="alg1.l6.2.m2.1.1.3.5.cmml" xref="alg1.l6.2.m2.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.2.m2.1c">\mathcal{D}_{test}</annotation></semantics></math>
</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <span id="alg1.l7.1" class="ltx_text ltx_font_typewriter">classes, class_counts</span> <math id="alg1.l7.m1.1" class="ltx_Math" alttext="\leftarrow\texttt{unique}({\bm{y}})" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.2" xref="alg1.l7.m1.1.2.cmml"><mi id="alg1.l7.m1.1.2.2" xref="alg1.l7.m1.1.2.2.cmml"></mi><mo stretchy="false" id="alg1.l7.m1.1.2.1" xref="alg1.l7.m1.1.2.1.cmml">←</mo><mrow id="alg1.l7.m1.1.2.3" xref="alg1.l7.m1.1.2.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l7.m1.1.2.3.2" xref="alg1.l7.m1.1.2.3.2a.cmml">unique</mtext><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.2.3.1" xref="alg1.l7.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l7.m1.1.2.3.3.2" xref="alg1.l7.m1.1.2.3.cmml"><mo stretchy="false" id="alg1.l7.m1.1.2.3.3.2.1" xref="alg1.l7.m1.1.2.3.cmml">(</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">𝒚</mi><mo stretchy="false" id="alg1.l7.m1.1.2.3.3.2.2" xref="alg1.l7.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.2.cmml" xref="alg1.l7.m1.1.2"><ci id="alg1.l7.m1.1.2.1.cmml" xref="alg1.l7.m1.1.2.1">←</ci><csymbol cd="latexml" id="alg1.l7.m1.1.2.2.cmml" xref="alg1.l7.m1.1.2.2">absent</csymbol><apply id="alg1.l7.m1.1.2.3.cmml" xref="alg1.l7.m1.1.2.3"><times id="alg1.l7.m1.1.2.3.1.cmml" xref="alg1.l7.m1.1.2.3.1"></times><ci id="alg1.l7.m1.1.2.3.2a.cmml" xref="alg1.l7.m1.1.2.3.2"><mtext class="ltx_mathvariant_monospace" id="alg1.l7.m1.1.2.3.2.cmml" xref="alg1.l7.m1.1.2.3.2">unique</mtext></ci><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝒚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\leftarrow\texttt{unique}({\bm{y}})</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <span id="alg1.l8.1" class="ltx_text ltx_font_bold">for all</span> <math id="alg1.l8.m1.1" class="ltx_Math" alttext="c\in\texttt{classes}" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">c</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">∈</mo><mtext class="ltx_mathvariant_monospace" id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3a.cmml">classes</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><in id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></in><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑐</ci><ci id="alg1.l8.m1.1.1.3a.cmml" xref="alg1.l8.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">classes</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">c\in\texttt{classes}</annotation></semantics></math> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>         <span id="alg1.l9.1" class="ltx_text ltx_font_typewriter">assert<math id="alg1.l9.1.m1.2" class="ltx_Math" alttext="(\texttt{class\_counts}(c)&gt;1)" display="inline"><semantics id="alg1.l9.1.m1.2a"><mrow id="alg1.l9.1.m1.2.2.1" xref="alg1.l9.1.m1.2.2.1.1.cmml"><mo stretchy="false" id="alg1.l9.1.m1.2.2.1.2" xref="alg1.l9.1.m1.2.2.1.1.cmml">(</mo><mrow id="alg1.l9.1.m1.2.2.1.1" xref="alg1.l9.1.m1.2.2.1.1.cmml"><mrow id="alg1.l9.1.m1.2.2.1.1.2" xref="alg1.l9.1.m1.2.2.1.1.2.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l9.1.m1.2.2.1.1.2.2" xref="alg1.l9.1.m1.2.2.1.1.2.2a.cmml">class_counts</mtext><mo lspace="0em" rspace="0em" id="alg1.l9.1.m1.2.2.1.1.2.1" xref="alg1.l9.1.m1.2.2.1.1.2.1.cmml">​</mo><mrow id="alg1.l9.1.m1.2.2.1.1.2.3.2" xref="alg1.l9.1.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l9.1.m1.2.2.1.1.2.3.2.1" xref="alg1.l9.1.m1.2.2.1.1.2.cmml">(</mo><mi id="alg1.l9.1.m1.1.1" xref="alg1.l9.1.m1.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l9.1.m1.2.2.1.1.2.3.2.2" xref="alg1.l9.1.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="alg1.l9.1.m1.2.2.1.1.1" xref="alg1.l9.1.m1.2.2.1.1.1.cmml">&gt;</mo><mn id="alg1.l9.1.m1.2.2.1.1.3" xref="alg1.l9.1.m1.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l9.1.m1.2.2.1.3" xref="alg1.l9.1.m1.2.2.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.1.m1.2b"><apply id="alg1.l9.1.m1.2.2.1.1.cmml" xref="alg1.l9.1.m1.2.2.1"><gt id="alg1.l9.1.m1.2.2.1.1.1.cmml" xref="alg1.l9.1.m1.2.2.1.1.1"></gt><apply id="alg1.l9.1.m1.2.2.1.1.2.cmml" xref="alg1.l9.1.m1.2.2.1.1.2"><times id="alg1.l9.1.m1.2.2.1.1.2.1.cmml" xref="alg1.l9.1.m1.2.2.1.1.2.1"></times><ci id="alg1.l9.1.m1.2.2.1.1.2.2a.cmml" xref="alg1.l9.1.m1.2.2.1.1.2.2"><mtext class="ltx_mathvariant_monospace" id="alg1.l9.1.m1.2.2.1.1.2.2.cmml" xref="alg1.l9.1.m1.2.2.1.1.2.2">class_counts</mtext></ci><ci id="alg1.l9.1.m1.1.1.cmml" xref="alg1.l9.1.m1.1.1">𝑐</ci></apply><cn type="integer" id="alg1.l9.1.m1.2.2.1.1.3.cmml" xref="alg1.l9.1.m1.2.2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.1.m1.2c">(\texttt{class\_counts}(c)&gt;1)</annotation></semantics></math></span> <span id="alg1.l9.2" class="ltx_text" style="float:right;"><math id="alg1.l9.2.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l9.2.m1.1a"><mo id="alg1.l9.2.m1.1.1" xref="alg1.l9.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l9.2.m1.1b"><ci id="alg1.l9.2.m1.1.1.cmml" xref="alg1.l9.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.2.m1.1c">\triangleright</annotation></semantics></math> Require a minimum of 2 shots per class.
</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>         <span id="alg1.l10.1" class="ltx_text ltx_font_typewriter">train_count</span> <math id="alg1.l10.m1.2" class="ltx_Math" alttext="\leftarrow\texttt{ceil}(\texttt{class\_counts}(c)/2)" display="inline"><semantics id="alg1.l10.m1.2a"><mrow id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml"><mi id="alg1.l10.m1.2.2.3" xref="alg1.l10.m1.2.2.3.cmml"></mi><mo stretchy="false" id="alg1.l10.m1.2.2.2" xref="alg1.l10.m1.2.2.2.cmml">←</mo><mrow id="alg1.l10.m1.2.2.1" xref="alg1.l10.m1.2.2.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l10.m1.2.2.1.3" xref="alg1.l10.m1.2.2.1.3a.cmml">ceil</mtext><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.1.2" xref="alg1.l10.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.l10.m1.2.2.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m1.2.2.1.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.cmml"><mrow id="alg1.l10.m1.2.2.1.1.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l10.m1.2.2.1.1.1.1.2.2" xref="alg1.l10.m1.2.2.1.1.1.1.2.2a.cmml">class_counts</mtext><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.1.1.1.1.2.1" xref="alg1.l10.m1.2.2.1.1.1.1.2.1.cmml">​</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1.2.3.2" xref="alg1.l10.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l10.m1.2.2.1.1.1.1.2.3.2.1" xref="alg1.l10.m1.2.2.1.1.1.1.2.cmml">(</mo><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l10.m1.2.2.1.1.1.1.2.3.2.2" xref="alg1.l10.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="alg1.l10.m1.2.2.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.cmml">/</mo><mn id="alg1.l10.m1.2.2.1.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="alg1.l10.m1.2.2.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><apply id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2"><ci id="alg1.l10.m1.2.2.2.cmml" xref="alg1.l10.m1.2.2.2">←</ci><csymbol cd="latexml" id="alg1.l10.m1.2.2.3.cmml" xref="alg1.l10.m1.2.2.3">absent</csymbol><apply id="alg1.l10.m1.2.2.1.cmml" xref="alg1.l10.m1.2.2.1"><times id="alg1.l10.m1.2.2.1.2.cmml" xref="alg1.l10.m1.2.2.1.2"></times><ci id="alg1.l10.m1.2.2.1.3a.cmml" xref="alg1.l10.m1.2.2.1.3"><mtext class="ltx_mathvariant_monospace" id="alg1.l10.m1.2.2.1.3.cmml" xref="alg1.l10.m1.2.2.1.3">ceil</mtext></ci><apply id="alg1.l10.m1.2.2.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1"><divide id="alg1.l10.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1"></divide><apply id="alg1.l10.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.2"><times id="alg1.l10.m1.2.2.1.1.1.1.2.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.2.1"></times><ci id="alg1.l10.m1.2.2.1.1.1.1.2.2a.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.2.2"><mtext class="ltx_mathvariant_monospace" id="alg1.l10.m1.2.2.1.1.1.1.2.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.2.2">class_counts</mtext></ci><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝑐</ci></apply><cn type="integer" id="alg1.l10.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">\leftarrow\texttt{ceil}(\texttt{class\_counts}(c)/2)</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>         <math id="alg1.l11.m1.1" class="ltx_Math" alttext="\mathcal{D}_{c}\leftarrow\texttt{select\_by\_class}(c)" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.2" xref="alg1.l11.m1.1.2.cmml"><msub id="alg1.l11.m1.1.2.2" xref="alg1.l11.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.2.2.2" xref="alg1.l11.m1.1.2.2.2.cmml">𝒟</mi><mi id="alg1.l11.m1.1.2.2.3" xref="alg1.l11.m1.1.2.2.3.cmml">c</mi></msub><mo stretchy="false" id="alg1.l11.m1.1.2.1" xref="alg1.l11.m1.1.2.1.cmml">←</mo><mrow id="alg1.l11.m1.1.2.3" xref="alg1.l11.m1.1.2.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l11.m1.1.2.3.2" xref="alg1.l11.m1.1.2.3.2a.cmml">select_by_class</mtext><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.2.3.1" xref="alg1.l11.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l11.m1.1.2.3.3.2" xref="alg1.l11.m1.1.2.3.cmml"><mo stretchy="false" id="alg1.l11.m1.1.2.3.3.2.1" xref="alg1.l11.m1.1.2.3.cmml">(</mo><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l11.m1.1.2.3.3.2.2" xref="alg1.l11.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.2.cmml" xref="alg1.l11.m1.1.2"><ci id="alg1.l11.m1.1.2.1.cmml" xref="alg1.l11.m1.1.2.1">←</ci><apply id="alg1.l11.m1.1.2.2.cmml" xref="alg1.l11.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.2.2.1.cmml" xref="alg1.l11.m1.1.2.2">subscript</csymbol><ci id="alg1.l11.m1.1.2.2.2.cmml" xref="alg1.l11.m1.1.2.2.2">𝒟</ci><ci id="alg1.l11.m1.1.2.2.3.cmml" xref="alg1.l11.m1.1.2.2.3">𝑐</ci></apply><apply id="alg1.l11.m1.1.2.3.cmml" xref="alg1.l11.m1.1.2.3"><times id="alg1.l11.m1.1.2.3.1.cmml" xref="alg1.l11.m1.1.2.3.1"></times><ci id="alg1.l11.m1.1.2.3.2a.cmml" xref="alg1.l11.m1.1.2.3.2"><mtext class="ltx_mathvariant_monospace" id="alg1.l11.m1.1.2.3.2.cmml" xref="alg1.l11.m1.1.2.3.2">select_by_class</mtext></ci><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\mathcal{D}_{c}\leftarrow\texttt{select\_by\_class}(c)</annotation></semantics></math> <span id="alg1.l11.3" class="ltx_text" style="float:right;"><math id="alg1.l11.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l11.1.m1.1a"><mo id="alg1.l11.1.m1.1.1" xref="alg1.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l11.1.m1.1b"><ci id="alg1.l11.1.m1.1.1.cmml" xref="alg1.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.1.m1.1c">\triangleright</annotation></semantics></math> Select examples of class <math id="alg1.l11.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg1.l11.2.m2.1a"><mi id="alg1.l11.2.m2.1.1" xref="alg1.l11.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.2.m2.1b"><ci id="alg1.l11.2.m2.1.1.cmml" xref="alg1.l11.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.2.m2.1c">c</annotation></semantics></math> from <math id="alg1.l11.3.m3.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="alg1.l11.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.3.m3.1.1" xref="alg1.l11.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.3.m3.1b"><ci id="alg1.l11.3.m3.1.1.cmml" xref="alg1.l11.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.3.m3.1c">\mathcal{D}</annotation></semantics></math>
</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>         <math id="alg1.l12.m1.1" class="ltx_math_unparsed" alttext="\mathcal{D}_{train}\leftarrow\mathcal{D}_{train}+\mathcal{D}_{c}[:\texttt{train\_count}]" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1b"><msub id="alg1.l12.m1.1.1"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.1.2">𝒟</mi><mrow id="alg1.l12.m1.1.1.3"><mi id="alg1.l12.m1.1.1.3.2">t</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.3.1">​</mo><mi id="alg1.l12.m1.1.1.3.3">r</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.3.1a">​</mo><mi id="alg1.l12.m1.1.1.3.4">a</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.3.1b">​</mo><mi id="alg1.l12.m1.1.1.3.5">i</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.3.1c">​</mo><mi id="alg1.l12.m1.1.1.3.6">n</mi></mrow></msub><mo stretchy="false" id="alg1.l12.m1.1.2">←</mo><msub id="alg1.l12.m1.1.3"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.3.2">𝒟</mi><mrow id="alg1.l12.m1.1.3.3"><mi id="alg1.l12.m1.1.3.3.2">t</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.3.3.1">​</mo><mi id="alg1.l12.m1.1.3.3.3">r</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.3.3.1a">​</mo><mi id="alg1.l12.m1.1.3.3.4">a</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.3.3.1b">​</mo><mi id="alg1.l12.m1.1.3.3.5">i</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.3.3.1c">​</mo><mi id="alg1.l12.m1.1.3.3.6">n</mi></mrow></msub><mo id="alg1.l12.m1.1.4">+</mo><msub id="alg1.l12.m1.1.5"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.5.2">𝒟</mi><mi id="alg1.l12.m1.1.5.3">c</mi></msub><mrow id="alg1.l12.m1.1.6"><mo stretchy="false" id="alg1.l12.m1.1.6.1">[</mo><mo rspace="0.278em" id="alg1.l12.m1.1.6.2">:</mo><mtext class="ltx_mathvariant_monospace" id="alg1.l12.m1.1.6.3">train_count</mtext><mo stretchy="false" id="alg1.l12.m1.1.6.4">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\mathcal{D}_{train}\leftarrow\mathcal{D}_{train}+\mathcal{D}_{c}[:\texttt{train\_count}]</annotation></semantics></math> <span id="alg1.l12.2" class="ltx_text" style="float:right;"><math id="alg1.l12.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l12.1.m1.1a"><mo id="alg1.l12.1.m1.1.1" xref="alg1.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.1.m1.1b"><ci id="alg1.l12.1.m1.1.1.cmml" xref="alg1.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.m1.1c">\triangleright</annotation></semantics></math> Add <span id="alg1.l12.2.1" class="ltx_text ltx_font_typewriter">train_count</span> examples to <math id="alg1.l12.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="alg1.l12.2.m2.1a"><msub id="alg1.l12.2.m2.1.1" xref="alg1.l12.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.2.m2.1.1.2" xref="alg1.l12.2.m2.1.1.2.cmml">𝒟</mi><mrow id="alg1.l12.2.m2.1.1.3" xref="alg1.l12.2.m2.1.1.3.cmml"><mi id="alg1.l12.2.m2.1.1.3.2" xref="alg1.l12.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l12.2.m2.1.1.3.1" xref="alg1.l12.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l12.2.m2.1.1.3.3" xref="alg1.l12.2.m2.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l12.2.m2.1.1.3.1a" xref="alg1.l12.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l12.2.m2.1.1.3.4" xref="alg1.l12.2.m2.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l12.2.m2.1.1.3.1b" xref="alg1.l12.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l12.2.m2.1.1.3.5" xref="alg1.l12.2.m2.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l12.2.m2.1.1.3.1c" xref="alg1.l12.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l12.2.m2.1.1.3.6" xref="alg1.l12.2.m2.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l12.2.m2.1b"><apply id="alg1.l12.2.m2.1.1.cmml" xref="alg1.l12.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l12.2.m2.1.1.1.cmml" xref="alg1.l12.2.m2.1.1">subscript</csymbol><ci id="alg1.l12.2.m2.1.1.2.cmml" xref="alg1.l12.2.m2.1.1.2">𝒟</ci><apply id="alg1.l12.2.m2.1.1.3.cmml" xref="alg1.l12.2.m2.1.1.3"><times id="alg1.l12.2.m2.1.1.3.1.cmml" xref="alg1.l12.2.m2.1.1.3.1"></times><ci id="alg1.l12.2.m2.1.1.3.2.cmml" xref="alg1.l12.2.m2.1.1.3.2">𝑡</ci><ci id="alg1.l12.2.m2.1.1.3.3.cmml" xref="alg1.l12.2.m2.1.1.3.3">𝑟</ci><ci id="alg1.l12.2.m2.1.1.3.4.cmml" xref="alg1.l12.2.m2.1.1.3.4">𝑎</ci><ci id="alg1.l12.2.m2.1.1.3.5.cmml" xref="alg1.l12.2.m2.1.1.3.5">𝑖</ci><ci id="alg1.l12.2.m2.1.1.3.6.cmml" xref="alg1.l12.2.m2.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.2.m2.1c">\mathcal{D}_{train}</annotation></semantics></math>
</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>         <math id="alg1.l13.m1.1" class="ltx_math_unparsed" alttext="\mathcal{D}_{test}\leftarrow\mathcal{D}_{test}+\mathcal{D}_{c}[\texttt{train\_count}:]" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1b"><msub id="alg1.l13.m1.1.1"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1.2">𝒟</mi><mrow id="alg1.l13.m1.1.1.3"><mi id="alg1.l13.m1.1.1.3.2">t</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.3.1">​</mo><mi id="alg1.l13.m1.1.1.3.3">e</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.3.1a">​</mo><mi id="alg1.l13.m1.1.1.3.4">s</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.3.1b">​</mo><mi id="alg1.l13.m1.1.1.3.5">t</mi></mrow></msub><mo stretchy="false" id="alg1.l13.m1.1.2">←</mo><msub id="alg1.l13.m1.1.3"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.3.2">𝒟</mi><mrow id="alg1.l13.m1.1.3.3"><mi id="alg1.l13.m1.1.3.3.2">t</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.3.3.1">​</mo><mi id="alg1.l13.m1.1.3.3.3">e</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.3.3.1a">​</mo><mi id="alg1.l13.m1.1.3.3.4">s</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.3.3.1b">​</mo><mi id="alg1.l13.m1.1.3.3.5">t</mi></mrow></msub><mo id="alg1.l13.m1.1.4">+</mo><msub id="alg1.l13.m1.1.5"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.5.2">𝒟</mi><mi id="alg1.l13.m1.1.5.3">c</mi></msub><mrow id="alg1.l13.m1.1.6"><mo stretchy="false" id="alg1.l13.m1.1.6.1">[</mo><mtext class="ltx_mathvariant_monospace" id="alg1.l13.m1.1.6.2">train_count</mtext><mo lspace="0.278em" rspace="0em" id="alg1.l13.m1.1.6.3">:</mo><mo stretchy="false" id="alg1.l13.m1.1.6.4">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\mathcal{D}_{test}\leftarrow\mathcal{D}_{test}+\mathcal{D}_{c}[\texttt{train\_count}:]</annotation></semantics></math> <span id="alg1.l13.2" class="ltx_text" style="float:right;"><math id="alg1.l13.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l13.1.m1.1a"><mo id="alg1.l13.1.m1.1.1" xref="alg1.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l13.1.m1.1b"><ci id="alg1.l13.1.m1.1.1.cmml" xref="alg1.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.1.m1.1c">\triangleright</annotation></semantics></math> Add remaining examples to <math id="alg1.l13.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="alg1.l13.2.m2.1a"><msub id="alg1.l13.2.m2.1.1" xref="alg1.l13.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.2.m2.1.1.2" xref="alg1.l13.2.m2.1.1.2.cmml">𝒟</mi><mrow id="alg1.l13.2.m2.1.1.3" xref="alg1.l13.2.m2.1.1.3.cmml"><mi id="alg1.l13.2.m2.1.1.3.2" xref="alg1.l13.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l13.2.m2.1.1.3.1" xref="alg1.l13.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l13.2.m2.1.1.3.3" xref="alg1.l13.2.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l13.2.m2.1.1.3.1a" xref="alg1.l13.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l13.2.m2.1.1.3.4" xref="alg1.l13.2.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l13.2.m2.1.1.3.1b" xref="alg1.l13.2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l13.2.m2.1.1.3.5" xref="alg1.l13.2.m2.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l13.2.m2.1b"><apply id="alg1.l13.2.m2.1.1.cmml" xref="alg1.l13.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l13.2.m2.1.1.1.cmml" xref="alg1.l13.2.m2.1.1">subscript</csymbol><ci id="alg1.l13.2.m2.1.1.2.cmml" xref="alg1.l13.2.m2.1.1.2">𝒟</ci><apply id="alg1.l13.2.m2.1.1.3.cmml" xref="alg1.l13.2.m2.1.1.3"><times id="alg1.l13.2.m2.1.1.3.1.cmml" xref="alg1.l13.2.m2.1.1.3.1"></times><ci id="alg1.l13.2.m2.1.1.3.2.cmml" xref="alg1.l13.2.m2.1.1.3.2">𝑡</ci><ci id="alg1.l13.2.m2.1.1.3.3.cmml" xref="alg1.l13.2.m2.1.1.3.3">𝑒</ci><ci id="alg1.l13.2.m2.1.1.3.4.cmml" xref="alg1.l13.2.m2.1.1.3.4">𝑠</ci><ci id="alg1.l13.2.m2.1.1.3.5.cmml" xref="alg1.l13.2.m2.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.2.m2.1c">\mathcal{D}_{test}</annotation></semantics></math>
</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>     <span id="alg1.l14.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l14.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>     <span id="alg1.l15.1" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l15.m1.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="alg1.l15.m1.1a"><msub id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">𝒟</mi><mrow id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.3.1" xref="alg1.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.3.1a" xref="alg1.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l15.m1.1.1.3.4" xref="alg1.l15.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.3.1b" xref="alg1.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l15.m1.1.1.3.5" xref="alg1.l15.m1.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.3.1c" xref="alg1.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l15.m1.1.1.3.6" xref="alg1.l15.m1.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">𝒟</ci><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><times id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3.1"></times><ci id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2">𝑡</ci><ci id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3">𝑟</ci><ci id="alg1.l15.m1.1.1.3.4.cmml" xref="alg1.l15.m1.1.1.3.4">𝑎</ci><ci id="alg1.l15.m1.1.1.3.5.cmml" xref="alg1.l15.m1.1.1.3.5">𝑖</ci><ci id="alg1.l15.m1.1.1.3.6.cmml" xref="alg1.l15.m1.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\mathcal{D}_{train}</annotation></semantics></math>, <math id="alg1.l15.m2.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="alg1.l15.m2.1a"><msub id="alg1.l15.m2.1.1" xref="alg1.l15.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m2.1.1.2" xref="alg1.l15.m2.1.1.2.cmml">𝒟</mi><mrow id="alg1.l15.m2.1.1.3" xref="alg1.l15.m2.1.1.3.cmml"><mi id="alg1.l15.m2.1.1.3.2" xref="alg1.l15.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m2.1.1.3.1" xref="alg1.l15.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l15.m2.1.1.3.3" xref="alg1.l15.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m2.1.1.3.1a" xref="alg1.l15.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l15.m2.1.1.3.4" xref="alg1.l15.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m2.1.1.3.1b" xref="alg1.l15.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l15.m2.1.1.3.5" xref="alg1.l15.m2.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l15.m2.1b"><apply id="alg1.l15.m2.1.1.cmml" xref="alg1.l15.m2.1.1"><csymbol cd="ambiguous" id="alg1.l15.m2.1.1.1.cmml" xref="alg1.l15.m2.1.1">subscript</csymbol><ci id="alg1.l15.m2.1.1.2.cmml" xref="alg1.l15.m2.1.1.2">𝒟</ci><apply id="alg1.l15.m2.1.1.3.cmml" xref="alg1.l15.m2.1.1.3"><times id="alg1.l15.m2.1.1.3.1.cmml" xref="alg1.l15.m2.1.1.3.1"></times><ci id="alg1.l15.m2.1.1.3.2.cmml" xref="alg1.l15.m2.1.1.3.2">𝑡</ci><ci id="alg1.l15.m2.1.1.3.3.cmml" xref="alg1.l15.m2.1.1.3.3">𝑒</ci><ci id="alg1.l15.m2.1.1.3.4.cmml" xref="alg1.l15.m2.1.1.3.4">𝑠</ci><ci id="alg1.l15.m2.1.1.3.5.cmml" xref="alg1.l15.m2.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m2.1c">\mathcal{D}_{test}</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span><span id="alg1.l16.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l16.2" class="ltx_text ltx_font_bold">procedure</span>
</div>
</div>
</figure>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.4.1.1" class="ltx_text ltx_font_bold">Algorithm A.2</span> </span> Sampling a task <math id="alg2.2.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg2.2.m1.1b"><mi id="alg2.2.m1.1.1" xref="alg2.2.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg2.2.m1.1c"><ci id="alg2.2.m1.1.1.cmml" xref="alg2.2.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.m1.1d">\tau</annotation></semantics></math></figcaption>
<div id="alg2.5" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><math id="alg2.l1.m1.3" class="ltx_Math" alttext="\mathcal{D}_{train}=\{({\bm{x}}_{s},y_{s})\}_{s=1}^{S_{\tau}}=\{{\bm{x}}_{S},{\bm{y}}_{S}\}" display="inline"><semantics id="alg2.l1.m1.3a"><mrow id="alg2.l1.m1.3.3" xref="alg2.l1.m1.3.3.cmml"><msub id="alg2.l1.m1.3.3.5" xref="alg2.l1.m1.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m1.3.3.5.2" xref="alg2.l1.m1.3.3.5.2.cmml">𝒟</mi><mrow id="alg2.l1.m1.3.3.5.3" xref="alg2.l1.m1.3.3.5.3.cmml"><mi id="alg2.l1.m1.3.3.5.3.2" xref="alg2.l1.m1.3.3.5.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m1.3.3.5.3.1" xref="alg2.l1.m1.3.3.5.3.1.cmml">​</mo><mi id="alg2.l1.m1.3.3.5.3.3" xref="alg2.l1.m1.3.3.5.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m1.3.3.5.3.1a" xref="alg2.l1.m1.3.3.5.3.1.cmml">​</mo><mi id="alg2.l1.m1.3.3.5.3.4" xref="alg2.l1.m1.3.3.5.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m1.3.3.5.3.1b" xref="alg2.l1.m1.3.3.5.3.1.cmml">​</mo><mi id="alg2.l1.m1.3.3.5.3.5" xref="alg2.l1.m1.3.3.5.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m1.3.3.5.3.1c" xref="alg2.l1.m1.3.3.5.3.1.cmml">​</mo><mi id="alg2.l1.m1.3.3.5.3.6" xref="alg2.l1.m1.3.3.5.3.6.cmml">n</mi></mrow></msub><mo id="alg2.l1.m1.3.3.6" xref="alg2.l1.m1.3.3.6.cmml">=</mo><msubsup id="alg2.l1.m1.1.1.1" xref="alg2.l1.m1.1.1.1.cmml"><mrow id="alg2.l1.m1.1.1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l1.m1.1.1.1.1.1.1.2" xref="alg2.l1.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="alg2.l1.m1.1.1.1.1.1.1.1.2" xref="alg2.l1.m1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="alg2.l1.m1.1.1.1.1.1.1.1.2.3" xref="alg2.l1.m1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="alg2.l1.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l1.m1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l1.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="alg2.l1.m1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l1.m1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="alg2.l1.m1.1.1.1.1.1.1.1.2.4" xref="alg2.l1.m1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="alg2.l1.m1.1.1.1.1.1.1.1.2.2" xref="alg2.l1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg2.l1.m1.1.1.1.1.1.1.1.2.2.2" xref="alg2.l1.m1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="alg2.l1.m1.1.1.1.1.1.1.1.2.2.3" xref="alg2.l1.m1.1.1.1.1.1.1.1.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l1.m1.1.1.1.1.1.1.1.2.5" xref="alg2.l1.m1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="alg2.l1.m1.1.1.1.1.1.1.3" xref="alg2.l1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l1.m1.1.1.1.1.3" xref="alg2.l1.m1.1.1.1.1.3.cmml"><mi id="alg2.l1.m1.1.1.1.1.3.2" xref="alg2.l1.m1.1.1.1.1.3.2.cmml">s</mi><mo id="alg2.l1.m1.1.1.1.1.3.1" xref="alg2.l1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="alg2.l1.m1.1.1.1.1.3.3" xref="alg2.l1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="alg2.l1.m1.1.1.1.3" xref="alg2.l1.m1.1.1.1.3.cmml"><mi id="alg2.l1.m1.1.1.1.3.2" xref="alg2.l1.m1.1.1.1.3.2.cmml">S</mi><mi id="alg2.l1.m1.1.1.1.3.3" xref="alg2.l1.m1.1.1.1.3.3.cmml">τ</mi></msub></msubsup><mo id="alg2.l1.m1.3.3.7" xref="alg2.l1.m1.3.3.7.cmml">=</mo><mrow id="alg2.l1.m1.3.3.3.2" xref="alg2.l1.m1.3.3.3.3.cmml"><mo stretchy="false" id="alg2.l1.m1.3.3.3.2.3" xref="alg2.l1.m1.3.3.3.3.cmml">{</mo><msub id="alg2.l1.m1.2.2.2.1.1" xref="alg2.l1.m1.2.2.2.1.1.cmml"><mi id="alg2.l1.m1.2.2.2.1.1.2" xref="alg2.l1.m1.2.2.2.1.1.2.cmml">𝒙</mi><mi id="alg2.l1.m1.2.2.2.1.1.3" xref="alg2.l1.m1.2.2.2.1.1.3.cmml">S</mi></msub><mo id="alg2.l1.m1.3.3.3.2.4" xref="alg2.l1.m1.3.3.3.3.cmml">,</mo><msub id="alg2.l1.m1.3.3.3.2.2" xref="alg2.l1.m1.3.3.3.2.2.cmml"><mi id="alg2.l1.m1.3.3.3.2.2.2" xref="alg2.l1.m1.3.3.3.2.2.2.cmml">𝒚</mi><mi id="alg2.l1.m1.3.3.3.2.2.3" xref="alg2.l1.m1.3.3.3.2.2.3.cmml">S</mi></msub><mo stretchy="false" id="alg2.l1.m1.3.3.3.2.5" xref="alg2.l1.m1.3.3.3.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.3b"><apply id="alg2.l1.m1.3.3.cmml" xref="alg2.l1.m1.3.3"><and id="alg2.l1.m1.3.3a.cmml" xref="alg2.l1.m1.3.3"></and><apply id="alg2.l1.m1.3.3b.cmml" xref="alg2.l1.m1.3.3"><eq id="alg2.l1.m1.3.3.6.cmml" xref="alg2.l1.m1.3.3.6"></eq><apply id="alg2.l1.m1.3.3.5.cmml" xref="alg2.l1.m1.3.3.5"><csymbol cd="ambiguous" id="alg2.l1.m1.3.3.5.1.cmml" xref="alg2.l1.m1.3.3.5">subscript</csymbol><ci id="alg2.l1.m1.3.3.5.2.cmml" xref="alg2.l1.m1.3.3.5.2">𝒟</ci><apply id="alg2.l1.m1.3.3.5.3.cmml" xref="alg2.l1.m1.3.3.5.3"><times id="alg2.l1.m1.3.3.5.3.1.cmml" xref="alg2.l1.m1.3.3.5.3.1"></times><ci id="alg2.l1.m1.3.3.5.3.2.cmml" xref="alg2.l1.m1.3.3.5.3.2">𝑡</ci><ci id="alg2.l1.m1.3.3.5.3.3.cmml" xref="alg2.l1.m1.3.3.5.3.3">𝑟</ci><ci id="alg2.l1.m1.3.3.5.3.4.cmml" xref="alg2.l1.m1.3.3.5.3.4">𝑎</ci><ci id="alg2.l1.m1.3.3.5.3.5.cmml" xref="alg2.l1.m1.3.3.5.3.5">𝑖</ci><ci id="alg2.l1.m1.3.3.5.3.6.cmml" xref="alg2.l1.m1.3.3.5.3.6">𝑛</ci></apply></apply><apply id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1">superscript</csymbol><apply id="alg2.l1.m1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1">subscript</csymbol><set id="alg2.l1.m1.1.1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1.1.1.1"><interval closure="open" id="alg2.l1.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.2"><apply id="alg2.l1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="alg2.l1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="alg2.l1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg2.l1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="alg2.l1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.2.2.3">𝑠</ci></apply></interval></set><apply id="alg2.l1.m1.1.1.1.1.3.cmml" xref="alg2.l1.m1.1.1.1.1.3"><eq id="alg2.l1.m1.1.1.1.1.3.1.cmml" xref="alg2.l1.m1.1.1.1.1.3.1"></eq><ci id="alg2.l1.m1.1.1.1.1.3.2.cmml" xref="alg2.l1.m1.1.1.1.1.3.2">𝑠</ci><cn type="integer" id="alg2.l1.m1.1.1.1.1.3.3.cmml" xref="alg2.l1.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg2.l1.m1.1.1.1.3.cmml" xref="alg2.l1.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.3.1.cmml" xref="alg2.l1.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l1.m1.1.1.1.3.2.cmml" xref="alg2.l1.m1.1.1.1.3.2">𝑆</ci><ci id="alg2.l1.m1.1.1.1.3.3.cmml" xref="alg2.l1.m1.1.1.1.3.3">𝜏</ci></apply></apply></apply><apply id="alg2.l1.m1.3.3c.cmml" xref="alg2.l1.m1.3.3"><eq id="alg2.l1.m1.3.3.7.cmml" xref="alg2.l1.m1.3.3.7"></eq><share href="#alg2.l1.m1.1.1.1.cmml" id="alg2.l1.m1.3.3d.cmml" xref="alg2.l1.m1.3.3"></share><set id="alg2.l1.m1.3.3.3.3.cmml" xref="alg2.l1.m1.3.3.3.2"><apply id="alg2.l1.m1.2.2.2.1.1.cmml" xref="alg2.l1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.2.1.1.1.cmml" xref="alg2.l1.m1.2.2.2.1.1">subscript</csymbol><ci id="alg2.l1.m1.2.2.2.1.1.2.cmml" xref="alg2.l1.m1.2.2.2.1.1.2">𝒙</ci><ci id="alg2.l1.m1.2.2.2.1.1.3.cmml" xref="alg2.l1.m1.2.2.2.1.1.3">𝑆</ci></apply><apply id="alg2.l1.m1.3.3.3.2.2.cmml" xref="alg2.l1.m1.3.3.3.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.3.3.3.2.2.1.cmml" xref="alg2.l1.m1.3.3.3.2.2">subscript</csymbol><ci id="alg2.l1.m1.3.3.3.2.2.2.cmml" xref="alg2.l1.m1.3.3.3.2.2.2">𝒚</ci><ci id="alg2.l1.m1.3.3.3.2.2.3.cmml" xref="alg2.l1.m1.3.3.3.2.2.3">𝑆</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.3c">\mathcal{D}_{train}=\{({\bm{x}}_{s},y_{s})\}_{s=1}^{S_{\tau}}=\{{\bm{x}}_{S},{\bm{y}}_{S}\}</annotation></semantics></math>: train portion of downstream dataset

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><math id="alg2.l2.m1.3" class="ltx_Math" alttext="\mathcal{D}_{test}=\{({\bm{x}}_{q},y_{q})\}_{q=1}^{Q_{\tau}}=\{{\bm{x}}_{Q},{\bm{y}}_{Q}\}" display="inline"><semantics id="alg2.l2.m1.3a"><mrow id="alg2.l2.m1.3.3" xref="alg2.l2.m1.3.3.cmml"><msub id="alg2.l2.m1.3.3.5" xref="alg2.l2.m1.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.3.3.5.2" xref="alg2.l2.m1.3.3.5.2.cmml">𝒟</mi><mrow id="alg2.l2.m1.3.3.5.3" xref="alg2.l2.m1.3.3.5.3.cmml"><mi id="alg2.l2.m1.3.3.5.3.2" xref="alg2.l2.m1.3.3.5.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.3.3.5.3.1" xref="alg2.l2.m1.3.3.5.3.1.cmml">​</mo><mi id="alg2.l2.m1.3.3.5.3.3" xref="alg2.l2.m1.3.3.5.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.3.3.5.3.1a" xref="alg2.l2.m1.3.3.5.3.1.cmml">​</mo><mi id="alg2.l2.m1.3.3.5.3.4" xref="alg2.l2.m1.3.3.5.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.3.3.5.3.1b" xref="alg2.l2.m1.3.3.5.3.1.cmml">​</mo><mi id="alg2.l2.m1.3.3.5.3.5" xref="alg2.l2.m1.3.3.5.3.5.cmml">t</mi></mrow></msub><mo id="alg2.l2.m1.3.3.6" xref="alg2.l2.m1.3.3.6.cmml">=</mo><msubsup id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml"><mrow id="alg2.l2.m1.1.1.1.1.1.1" xref="alg2.l2.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l2.m1.1.1.1.1.1.1.2" xref="alg2.l2.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="alg2.l2.m1.1.1.1.1.1.1.1.2" xref="alg2.l2.m1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="alg2.l2.m1.1.1.1.1.1.1.1.2.3" xref="alg2.l2.m1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="alg2.l2.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l2.m1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l2.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="alg2.l2.m1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l2.m1.1.1.1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="alg2.l2.m1.1.1.1.1.1.1.1.2.4" xref="alg2.l2.m1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="alg2.l2.m1.1.1.1.1.1.1.1.2.2" xref="alg2.l2.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg2.l2.m1.1.1.1.1.1.1.1.2.2.2" xref="alg2.l2.m1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="alg2.l2.m1.1.1.1.1.1.1.1.2.2.3" xref="alg2.l2.m1.1.1.1.1.1.1.1.2.2.3.cmml">q</mi></msub><mo stretchy="false" id="alg2.l2.m1.1.1.1.1.1.1.1.2.5" xref="alg2.l2.m1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="alg2.l2.m1.1.1.1.1.1.1.3" xref="alg2.l2.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l2.m1.1.1.1.1.3" xref="alg2.l2.m1.1.1.1.1.3.cmml"><mi id="alg2.l2.m1.1.1.1.1.3.2" xref="alg2.l2.m1.1.1.1.1.3.2.cmml">q</mi><mo id="alg2.l2.m1.1.1.1.1.3.1" xref="alg2.l2.m1.1.1.1.1.3.1.cmml">=</mo><mn id="alg2.l2.m1.1.1.1.1.3.3" xref="alg2.l2.m1.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="alg2.l2.m1.1.1.1.3" xref="alg2.l2.m1.1.1.1.3.cmml"><mi id="alg2.l2.m1.1.1.1.3.2" xref="alg2.l2.m1.1.1.1.3.2.cmml">Q</mi><mi id="alg2.l2.m1.1.1.1.3.3" xref="alg2.l2.m1.1.1.1.3.3.cmml">τ</mi></msub></msubsup><mo id="alg2.l2.m1.3.3.7" xref="alg2.l2.m1.3.3.7.cmml">=</mo><mrow id="alg2.l2.m1.3.3.3.2" xref="alg2.l2.m1.3.3.3.3.cmml"><mo stretchy="false" id="alg2.l2.m1.3.3.3.2.3" xref="alg2.l2.m1.3.3.3.3.cmml">{</mo><msub id="alg2.l2.m1.2.2.2.1.1" xref="alg2.l2.m1.2.2.2.1.1.cmml"><mi id="alg2.l2.m1.2.2.2.1.1.2" xref="alg2.l2.m1.2.2.2.1.1.2.cmml">𝒙</mi><mi id="alg2.l2.m1.2.2.2.1.1.3" xref="alg2.l2.m1.2.2.2.1.1.3.cmml">Q</mi></msub><mo id="alg2.l2.m1.3.3.3.2.4" xref="alg2.l2.m1.3.3.3.3.cmml">,</mo><msub id="alg2.l2.m1.3.3.3.2.2" xref="alg2.l2.m1.3.3.3.2.2.cmml"><mi id="alg2.l2.m1.3.3.3.2.2.2" xref="alg2.l2.m1.3.3.3.2.2.2.cmml">𝒚</mi><mi id="alg2.l2.m1.3.3.3.2.2.3" xref="alg2.l2.m1.3.3.3.2.2.3.cmml">Q</mi></msub><mo stretchy="false" id="alg2.l2.m1.3.3.3.2.5" xref="alg2.l2.m1.3.3.3.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.3b"><apply id="alg2.l2.m1.3.3.cmml" xref="alg2.l2.m1.3.3"><and id="alg2.l2.m1.3.3a.cmml" xref="alg2.l2.m1.3.3"></and><apply id="alg2.l2.m1.3.3b.cmml" xref="alg2.l2.m1.3.3"><eq id="alg2.l2.m1.3.3.6.cmml" xref="alg2.l2.m1.3.3.6"></eq><apply id="alg2.l2.m1.3.3.5.cmml" xref="alg2.l2.m1.3.3.5"><csymbol cd="ambiguous" id="alg2.l2.m1.3.3.5.1.cmml" xref="alg2.l2.m1.3.3.5">subscript</csymbol><ci id="alg2.l2.m1.3.3.5.2.cmml" xref="alg2.l2.m1.3.3.5.2">𝒟</ci><apply id="alg2.l2.m1.3.3.5.3.cmml" xref="alg2.l2.m1.3.3.5.3"><times id="alg2.l2.m1.3.3.5.3.1.cmml" xref="alg2.l2.m1.3.3.5.3.1"></times><ci id="alg2.l2.m1.3.3.5.3.2.cmml" xref="alg2.l2.m1.3.3.5.3.2">𝑡</ci><ci id="alg2.l2.m1.3.3.5.3.3.cmml" xref="alg2.l2.m1.3.3.5.3.3">𝑒</ci><ci id="alg2.l2.m1.3.3.5.3.4.cmml" xref="alg2.l2.m1.3.3.5.3.4">𝑠</ci><ci id="alg2.l2.m1.3.3.5.3.5.cmml" xref="alg2.l2.m1.3.3.5.3.5">𝑡</ci></apply></apply><apply id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.2.cmml" xref="alg2.l2.m1.1.1.1">superscript</csymbol><apply id="alg2.l2.m1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.1.2.cmml" xref="alg2.l2.m1.1.1.1">subscript</csymbol><set id="alg2.l2.m1.1.1.1.1.1.2.cmml" xref="alg2.l2.m1.1.1.1.1.1.1"><interval closure="open" id="alg2.l2.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l2.m1.1.1.1.1.1.1.1.2"><apply id="alg2.l2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l2.m1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="alg2.l2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l2.m1.1.1.1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="alg2.l2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l2.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg2.l2.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg2.l2.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg2.l2.m1.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="alg2.l2.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="alg2.l2.m1.1.1.1.1.1.1.1.2.2.3">𝑞</ci></apply></interval></set><apply id="alg2.l2.m1.1.1.1.1.3.cmml" xref="alg2.l2.m1.1.1.1.1.3"><eq id="alg2.l2.m1.1.1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.1.1.3.1"></eq><ci id="alg2.l2.m1.1.1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.1.1.3.2">𝑞</ci><cn type="integer" id="alg2.l2.m1.1.1.1.1.3.3.cmml" xref="alg2.l2.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg2.l2.m1.1.1.1.3.cmml" xref="alg2.l2.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l2.m1.1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.1.3.2">𝑄</ci><ci id="alg2.l2.m1.1.1.1.3.3.cmml" xref="alg2.l2.m1.1.1.1.3.3">𝜏</ci></apply></apply></apply><apply id="alg2.l2.m1.3.3c.cmml" xref="alg2.l2.m1.3.3"><eq id="alg2.l2.m1.3.3.7.cmml" xref="alg2.l2.m1.3.3.7"></eq><share href="#alg2.l2.m1.1.1.1.cmml" id="alg2.l2.m1.3.3d.cmml" xref="alg2.l2.m1.3.3"></share><set id="alg2.l2.m1.3.3.3.3.cmml" xref="alg2.l2.m1.3.3.3.2"><apply id="alg2.l2.m1.2.2.2.1.1.cmml" xref="alg2.l2.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.2.2.2.1.1.1.cmml" xref="alg2.l2.m1.2.2.2.1.1">subscript</csymbol><ci id="alg2.l2.m1.2.2.2.1.1.2.cmml" xref="alg2.l2.m1.2.2.2.1.1.2">𝒙</ci><ci id="alg2.l2.m1.2.2.2.1.1.3.cmml" xref="alg2.l2.m1.2.2.2.1.1.3">𝑄</ci></apply><apply id="alg2.l2.m1.3.3.3.2.2.cmml" xref="alg2.l2.m1.3.3.3.2.2"><csymbol cd="ambiguous" id="alg2.l2.m1.3.3.3.2.2.1.cmml" xref="alg2.l2.m1.3.3.3.2.2">subscript</csymbol><ci id="alg2.l2.m1.3.3.3.2.2.2.cmml" xref="alg2.l2.m1.3.3.3.2.2.2">𝒚</ci><ci id="alg2.l2.m1.3.3.3.2.2.3.cmml" xref="alg2.l2.m1.3.3.3.2.2.3">𝑄</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.3c">\mathcal{D}_{test}=\{({\bm{x}}_{q},y_{q})\}_{q=1}^{Q_{\tau}}=\{{\bm{x}}_{Q},{\bm{y}}_{Q}\}</annotation></semantics></math>: test portion of downstream dataset

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><span id="alg2.l3.1" class="ltx_text ltx_font_typewriter">support_set_size</span>: size of the support set <math id="alg2.l3.m1.1" class="ltx_Math" alttext="|\mathcal{D}_{S}^{\tau}|" display="inline"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.2.cmml"><mo stretchy="false" id="alg2.l3.m1.1.1.1.2" xref="alg2.l3.m1.1.1.2.1.cmml">|</mo><msubsup id="alg2.l3.m1.1.1.1.1" xref="alg2.l3.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.1.1.1.1.2.2" xref="alg2.l3.m1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="alg2.l3.m1.1.1.1.1.2.3" xref="alg2.l3.m1.1.1.1.1.2.3.cmml">S</mi><mi id="alg2.l3.m1.1.1.1.1.3" xref="alg2.l3.m1.1.1.1.1.3.cmml">τ</mi></msubsup><mo stretchy="false" id="alg2.l3.m1.1.1.1.3" xref="alg2.l3.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.1"><abs id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1.1.2"></abs><apply id="alg2.l3.m1.1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1.1">superscript</csymbol><apply id="alg2.l3.m1.1.1.1.1.2.cmml" xref="alg2.l3.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1.1.1">subscript</csymbol><ci id="alg2.l3.m1.1.1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.1.1.2.2">𝒟</ci><ci id="alg2.l3.m1.1.1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.1.1.2.3">𝑆</ci></apply><ci id="alg2.l3.m1.1.1.1.1.3.cmml" xref="alg2.l3.m1.1.1.1.1.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">|\mathcal{D}_{S}^{\tau}|</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span><span id="alg2.l4.1" class="ltx_text ltx_font_typewriter">unique()</span> <math id="alg2.l4.m1.1" class="ltx_Math" alttext="\equiv" display="inline"><semantics id="alg2.l4.m1.1a"><mo id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">≡</mo><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><equivalent id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"></equivalent></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\equiv</annotation></semantics></math> function that returns a list of unique classes and list of counts of each class

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span><span id="alg2.l5.1" class="ltx_text ltx_font_typewriter">randint(<math id="alg2.l5.1.m1.2" class="ltx_Math" alttext="min,max" display="inline"><semantics id="alg2.l5.1.m1.2a"><mrow id="alg2.l5.1.m1.2.2.2" xref="alg2.l5.1.m1.2.2.3.cmml"><mrow id="alg2.l5.1.m1.1.1.1.1" xref="alg2.l5.1.m1.1.1.1.1.cmml"><mi id="alg2.l5.1.m1.1.1.1.1.2" xref="alg2.l5.1.m1.1.1.1.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l5.1.m1.1.1.1.1.1" xref="alg2.l5.1.m1.1.1.1.1.1.cmml">​</mo><mi id="alg2.l5.1.m1.1.1.1.1.3" xref="alg2.l5.1.m1.1.1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l5.1.m1.1.1.1.1.1a" xref="alg2.l5.1.m1.1.1.1.1.1.cmml">​</mo><mi id="alg2.l5.1.m1.1.1.1.1.4" xref="alg2.l5.1.m1.1.1.1.1.4.cmml">n</mi></mrow><mo id="alg2.l5.1.m1.2.2.2.3" xref="alg2.l5.1.m1.2.2.3.cmml">,</mo><mrow id="alg2.l5.1.m1.2.2.2.2" xref="alg2.l5.1.m1.2.2.2.2.cmml"><mi id="alg2.l5.1.m1.2.2.2.2.2" xref="alg2.l5.1.m1.2.2.2.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l5.1.m1.2.2.2.2.1" xref="alg2.l5.1.m1.2.2.2.2.1.cmml">​</mo><mi id="alg2.l5.1.m1.2.2.2.2.3" xref="alg2.l5.1.m1.2.2.2.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l5.1.m1.2.2.2.2.1a" xref="alg2.l5.1.m1.2.2.2.2.1.cmml">​</mo><mi id="alg2.l5.1.m1.2.2.2.2.4" xref="alg2.l5.1.m1.2.2.2.2.4.cmml">x</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.1.m1.2b"><list id="alg2.l5.1.m1.2.2.3.cmml" xref="alg2.l5.1.m1.2.2.2"><apply id="alg2.l5.1.m1.1.1.1.1.cmml" xref="alg2.l5.1.m1.1.1.1.1"><times id="alg2.l5.1.m1.1.1.1.1.1.cmml" xref="alg2.l5.1.m1.1.1.1.1.1"></times><ci id="alg2.l5.1.m1.1.1.1.1.2.cmml" xref="alg2.l5.1.m1.1.1.1.1.2">𝑚</ci><ci id="alg2.l5.1.m1.1.1.1.1.3.cmml" xref="alg2.l5.1.m1.1.1.1.1.3">𝑖</ci><ci id="alg2.l5.1.m1.1.1.1.1.4.cmml" xref="alg2.l5.1.m1.1.1.1.1.4">𝑛</ci></apply><apply id="alg2.l5.1.m1.2.2.2.2.cmml" xref="alg2.l5.1.m1.2.2.2.2"><times id="alg2.l5.1.m1.2.2.2.2.1.cmml" xref="alg2.l5.1.m1.2.2.2.2.1"></times><ci id="alg2.l5.1.m1.2.2.2.2.2.cmml" xref="alg2.l5.1.m1.2.2.2.2.2">𝑚</ci><ci id="alg2.l5.1.m1.2.2.2.2.3.cmml" xref="alg2.l5.1.m1.2.2.2.2.3">𝑎</ci><ci id="alg2.l5.1.m1.2.2.2.2.4.cmml" xref="alg2.l5.1.m1.2.2.2.2.4">𝑥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.1.m1.2c">min,max</annotation></semantics></math>)</span> <math id="alg2.l5.m1.1" class="ltx_Math" alttext="\equiv" display="inline"><semantics id="alg2.l5.m1.1a"><mo id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">≡</mo><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><equivalent id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"></equivalent></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">\equiv</annotation></semantics></math> function that returns a random integer between <math id="alg2.l5.m2.1" class="ltx_Math" alttext="min" display="inline"><semantics id="alg2.l5.m2.1a"><mrow id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml"><mi id="alg2.l5.m2.1.1.2" xref="alg2.l5.m2.1.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l5.m2.1.1.1" xref="alg2.l5.m2.1.1.1.cmml">​</mo><mi id="alg2.l5.m2.1.1.3" xref="alg2.l5.m2.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l5.m2.1.1.1a" xref="alg2.l5.m2.1.1.1.cmml">​</mo><mi id="alg2.l5.m2.1.1.4" xref="alg2.l5.m2.1.1.4.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><apply id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1"><times id="alg2.l5.m2.1.1.1.cmml" xref="alg2.l5.m2.1.1.1"></times><ci id="alg2.l5.m2.1.1.2.cmml" xref="alg2.l5.m2.1.1.2">𝑚</ci><ci id="alg2.l5.m2.1.1.3.cmml" xref="alg2.l5.m2.1.1.3">𝑖</ci><ci id="alg2.l5.m2.1.1.4.cmml" xref="alg2.l5.m2.1.1.4">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">min</annotation></semantics></math> and <math id="alg2.l5.m3.1" class="ltx_Math" alttext="max" display="inline"><semantics id="alg2.l5.m3.1a"><mrow id="alg2.l5.m3.1.1" xref="alg2.l5.m3.1.1.cmml"><mi id="alg2.l5.m3.1.1.2" xref="alg2.l5.m3.1.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l5.m3.1.1.1" xref="alg2.l5.m3.1.1.1.cmml">​</mo><mi id="alg2.l5.m3.1.1.3" xref="alg2.l5.m3.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l5.m3.1.1.1a" xref="alg2.l5.m3.1.1.1.cmml">​</mo><mi id="alg2.l5.m3.1.1.4" xref="alg2.l5.m3.1.1.4.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m3.1b"><apply id="alg2.l5.m3.1.1.cmml" xref="alg2.l5.m3.1.1"><times id="alg2.l5.m3.1.1.1.cmml" xref="alg2.l5.m3.1.1.1"></times><ci id="alg2.l5.m3.1.1.2.cmml" xref="alg2.l5.m3.1.1.2">𝑚</ci><ci id="alg2.l5.m3.1.1.3.cmml" xref="alg2.l5.m3.1.1.3">𝑎</ci><ci id="alg2.l5.m3.1.1.4.cmml" xref="alg2.l5.m3.1.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m3.1c">max</annotation></semantics></math>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span><span id="alg2.l6.1" class="ltx_text ltx_font_typewriter">choice</span>(<math id="alg2.l6.m1.2" class="ltx_Math" alttext="range,count" display="inline"><semantics id="alg2.l6.m1.2a"><mrow id="alg2.l6.m1.2.2.2" xref="alg2.l6.m1.2.2.3.cmml"><mrow id="alg2.l6.m1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.cmml"><mi id="alg2.l6.m1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.cmml">​</mo><mi id="alg2.l6.m1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.1.1.1a" xref="alg2.l6.m1.1.1.1.1.1.cmml">​</mo><mi id="alg2.l6.m1.1.1.1.1.4" xref="alg2.l6.m1.1.1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.1.1.1b" xref="alg2.l6.m1.1.1.1.1.1.cmml">​</mo><mi id="alg2.l6.m1.1.1.1.1.5" xref="alg2.l6.m1.1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.1.1.1c" xref="alg2.l6.m1.1.1.1.1.1.cmml">​</mo><mi id="alg2.l6.m1.1.1.1.1.6" xref="alg2.l6.m1.1.1.1.1.6.cmml">e</mi></mrow><mo id="alg2.l6.m1.2.2.2.3" xref="alg2.l6.m1.2.2.3.cmml">,</mo><mrow id="alg2.l6.m1.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.cmml"><mi id="alg2.l6.m1.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.2.2.2.2.1" xref="alg2.l6.m1.2.2.2.2.1.cmml">​</mo><mi id="alg2.l6.m1.2.2.2.2.3" xref="alg2.l6.m1.2.2.2.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.2.2.2.2.1a" xref="alg2.l6.m1.2.2.2.2.1.cmml">​</mo><mi id="alg2.l6.m1.2.2.2.2.4" xref="alg2.l6.m1.2.2.2.2.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.2.2.2.2.1b" xref="alg2.l6.m1.2.2.2.2.1.cmml">​</mo><mi id="alg2.l6.m1.2.2.2.2.5" xref="alg2.l6.m1.2.2.2.2.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.2.2.2.2.1c" xref="alg2.l6.m1.2.2.2.2.1.cmml">​</mo><mi id="alg2.l6.m1.2.2.2.2.6" xref="alg2.l6.m1.2.2.2.2.6.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.2b"><list id="alg2.l6.m1.2.2.3.cmml" xref="alg2.l6.m1.2.2.2"><apply id="alg2.l6.m1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1"><times id="alg2.l6.m1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1"></times><ci id="alg2.l6.m1.1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.2">𝑟</ci><ci id="alg2.l6.m1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.3">𝑎</ci><ci id="alg2.l6.m1.1.1.1.1.4.cmml" xref="alg2.l6.m1.1.1.1.1.4">𝑛</ci><ci id="alg2.l6.m1.1.1.1.1.5.cmml" xref="alg2.l6.m1.1.1.1.1.5">𝑔</ci><ci id="alg2.l6.m1.1.1.1.1.6.cmml" xref="alg2.l6.m1.1.1.1.1.6">𝑒</ci></apply><apply id="alg2.l6.m1.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2"><times id="alg2.l6.m1.2.2.2.2.1.cmml" xref="alg2.l6.m1.2.2.2.2.1"></times><ci id="alg2.l6.m1.2.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2.2">𝑐</ci><ci id="alg2.l6.m1.2.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.2.3">𝑜</ci><ci id="alg2.l6.m1.2.2.2.2.4.cmml" xref="alg2.l6.m1.2.2.2.2.4">𝑢</ci><ci id="alg2.l6.m1.2.2.2.2.5.cmml" xref="alg2.l6.m1.2.2.2.2.5">𝑛</ci><ci id="alg2.l6.m1.2.2.2.2.6.cmml" xref="alg2.l6.m1.2.2.2.2.6">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.2c">range,count</annotation></semantics></math>) <math id="alg2.l6.m2.1" class="ltx_Math" alttext="\equiv" display="inline"><semantics id="alg2.l6.m2.1a"><mo id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml">≡</mo><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><equivalent id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1"></equivalent></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">\equiv</annotation></semantics></math> function that returns a random list of <math id="alg2.l6.m3.1" class="ltx_Math" alttext="count" display="inline"><semantics id="alg2.l6.m3.1a"><mrow id="alg2.l6.m3.1.1" xref="alg2.l6.m3.1.1.cmml"><mi id="alg2.l6.m3.1.1.2" xref="alg2.l6.m3.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m3.1.1.1" xref="alg2.l6.m3.1.1.1.cmml">​</mo><mi id="alg2.l6.m3.1.1.3" xref="alg2.l6.m3.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m3.1.1.1a" xref="alg2.l6.m3.1.1.1.cmml">​</mo><mi id="alg2.l6.m3.1.1.4" xref="alg2.l6.m3.1.1.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m3.1.1.1b" xref="alg2.l6.m3.1.1.1.cmml">​</mo><mi id="alg2.l6.m3.1.1.5" xref="alg2.l6.m3.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m3.1.1.1c" xref="alg2.l6.m3.1.1.1.cmml">​</mo><mi id="alg2.l6.m3.1.1.6" xref="alg2.l6.m3.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m3.1b"><apply id="alg2.l6.m3.1.1.cmml" xref="alg2.l6.m3.1.1"><times id="alg2.l6.m3.1.1.1.cmml" xref="alg2.l6.m3.1.1.1"></times><ci id="alg2.l6.m3.1.1.2.cmml" xref="alg2.l6.m3.1.1.2">𝑐</ci><ci id="alg2.l6.m3.1.1.3.cmml" xref="alg2.l6.m3.1.1.3">𝑜</ci><ci id="alg2.l6.m3.1.1.4.cmml" xref="alg2.l6.m3.1.1.4">𝑢</ci><ci id="alg2.l6.m3.1.1.5.cmml" xref="alg2.l6.m3.1.1.5">𝑛</ci><ci id="alg2.l6.m3.1.1.6.cmml" xref="alg2.l6.m3.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m3.1c">count</annotation></semantics></math> integers from <math id="alg2.l6.m4.1" class="ltx_Math" alttext="range" display="inline"><semantics id="alg2.l6.m4.1a"><mrow id="alg2.l6.m4.1.1" xref="alg2.l6.m4.1.1.cmml"><mi id="alg2.l6.m4.1.1.2" xref="alg2.l6.m4.1.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m4.1.1.1" xref="alg2.l6.m4.1.1.1.cmml">​</mo><mi id="alg2.l6.m4.1.1.3" xref="alg2.l6.m4.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m4.1.1.1a" xref="alg2.l6.m4.1.1.1.cmml">​</mo><mi id="alg2.l6.m4.1.1.4" xref="alg2.l6.m4.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m4.1.1.1b" xref="alg2.l6.m4.1.1.1.cmml">​</mo><mi id="alg2.l6.m4.1.1.5" xref="alg2.l6.m4.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m4.1.1.1c" xref="alg2.l6.m4.1.1.1.cmml">​</mo><mi id="alg2.l6.m4.1.1.6" xref="alg2.l6.m4.1.1.6.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m4.1b"><apply id="alg2.l6.m4.1.1.cmml" xref="alg2.l6.m4.1.1"><times id="alg2.l6.m4.1.1.1.cmml" xref="alg2.l6.m4.1.1.1"></times><ci id="alg2.l6.m4.1.1.2.cmml" xref="alg2.l6.m4.1.1.2">𝑟</ci><ci id="alg2.l6.m4.1.1.3.cmml" xref="alg2.l6.m4.1.1.3">𝑎</ci><ci id="alg2.l6.m4.1.1.4.cmml" xref="alg2.l6.m4.1.1.4">𝑛</ci><ci id="alg2.l6.m4.1.1.5.cmml" xref="alg2.l6.m4.1.1.5">𝑔</ci><ci id="alg2.l6.m4.1.1.6.cmml" xref="alg2.l6.m4.1.1.6">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m4.1c">range</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span><span id="alg2.l7.1" class="ltx_text ltx_font_bold">procedure</span> <span id="alg2.l7.2" class="ltx_text ltx_font_smallcaps">sample_task</span>(<math id="alg2.l7.m1.2" class="ltx_Math" alttext="\mathcal{D}_{train},\mathcal{D}_{test}" display="inline"><semantics id="alg2.l7.m1.2a"><mrow id="alg2.l7.m1.2.2.2" xref="alg2.l7.m1.2.2.3.cmml"><msub id="alg2.l7.m1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.2.cmml">𝒟</mi><mrow id="alg2.l7.m1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.3.cmml"><mi id="alg2.l7.m1.1.1.1.1.3.2" xref="alg2.l7.m1.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.1.1.3.1" xref="alg2.l7.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l7.m1.1.1.1.1.3.3" xref="alg2.l7.m1.1.1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.1.1.3.1a" xref="alg2.l7.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l7.m1.1.1.1.1.3.4" xref="alg2.l7.m1.1.1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.1.1.3.1b" xref="alg2.l7.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l7.m1.1.1.1.1.3.5" xref="alg2.l7.m1.1.1.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.1.1.3.1c" xref="alg2.l7.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l7.m1.1.1.1.1.3.6" xref="alg2.l7.m1.1.1.1.1.3.6.cmml">n</mi></mrow></msub><mo id="alg2.l7.m1.2.2.2.3" xref="alg2.l7.m1.2.2.3.cmml">,</mo><msub id="alg2.l7.m1.2.2.2.2" xref="alg2.l7.m1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m1.2.2.2.2.2" xref="alg2.l7.m1.2.2.2.2.2.cmml">𝒟</mi><mrow id="alg2.l7.m1.2.2.2.2.3" xref="alg2.l7.m1.2.2.2.2.3.cmml"><mi id="alg2.l7.m1.2.2.2.2.3.2" xref="alg2.l7.m1.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.2.2.3.1" xref="alg2.l7.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.2.2.3.3" xref="alg2.l7.m1.2.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.2.2.3.1a" xref="alg2.l7.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.2.2.3.4" xref="alg2.l7.m1.2.2.2.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.2.2.3.1b" xref="alg2.l7.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.2.2.3.5" xref="alg2.l7.m1.2.2.2.2.3.5.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.2b"><list id="alg2.l7.m1.2.2.3.cmml" xref="alg2.l7.m1.2.2.2"><apply id="alg2.l7.m1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1">subscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.2">𝒟</ci><apply id="alg2.l7.m1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.3"><times id="alg2.l7.m1.1.1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.1.1.3.1"></times><ci id="alg2.l7.m1.1.1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.1.1.3.2">𝑡</ci><ci id="alg2.l7.m1.1.1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.1.1.3.3">𝑟</ci><ci id="alg2.l7.m1.1.1.1.1.3.4.cmml" xref="alg2.l7.m1.1.1.1.1.3.4">𝑎</ci><ci id="alg2.l7.m1.1.1.1.1.3.5.cmml" xref="alg2.l7.m1.1.1.1.1.3.5">𝑖</ci><ci id="alg2.l7.m1.1.1.1.1.3.6.cmml" xref="alg2.l7.m1.1.1.1.1.3.6">𝑛</ci></apply></apply><apply id="alg2.l7.m1.2.2.2.2.cmml" xref="alg2.l7.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l7.m1.2.2.2.2.1.cmml" xref="alg2.l7.m1.2.2.2.2">subscript</csymbol><ci id="alg2.l7.m1.2.2.2.2.2.cmml" xref="alg2.l7.m1.2.2.2.2.2">𝒟</ci><apply id="alg2.l7.m1.2.2.2.2.3.cmml" xref="alg2.l7.m1.2.2.2.2.3"><times id="alg2.l7.m1.2.2.2.2.3.1.cmml" xref="alg2.l7.m1.2.2.2.2.3.1"></times><ci id="alg2.l7.m1.2.2.2.2.3.2.cmml" xref="alg2.l7.m1.2.2.2.2.3.2">𝑡</ci><ci id="alg2.l7.m1.2.2.2.2.3.3.cmml" xref="alg2.l7.m1.2.2.2.2.3.3">𝑒</ci><ci id="alg2.l7.m1.2.2.2.2.3.4.cmml" xref="alg2.l7.m1.2.2.2.2.3.4">𝑠</ci><ci id="alg2.l7.m1.2.2.2.2.3.5.cmml" xref="alg2.l7.m1.2.2.2.2.3.5">𝑡</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.2c">\mathcal{D}_{train},\mathcal{D}_{test}</annotation></semantics></math>, <span id="alg2.l7.3" class="ltx_text ltx_font_typewriter">support_set_size</span>)

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math id="alg2.l8.m1.1" class="ltx_Math" alttext="\mathcal{D}_{S}^{\tau}\leftarrow[\,]" display="inline"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><msubsup id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.1.1.2.2.2" xref="alg2.l8.m1.1.1.2.2.2.cmml">𝒟</mi><mi id="alg2.l8.m1.1.1.2.2.3" xref="alg2.l8.m1.1.1.2.2.3.cmml">S</mi><mi id="alg2.l8.m1.1.1.2.3" xref="alg2.l8.m1.1.1.2.3.cmml">τ</mi></msubsup><mo stretchy="false" id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml">←</mo><mrow id="alg2.l8.m1.1.1.3.2" xref="alg2.l8.m1.1.1.cmml"><mo rspace="0.170em" stretchy="false" id="alg2.l8.m1.1.1.3.2.1" xref="alg2.l8.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="alg2.l8.m1.1.1.3.2.2" xref="alg2.l8.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><ci id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1">←</ci><apply id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.2.1.cmml" xref="alg2.l8.m1.1.1.2">superscript</csymbol><apply id="alg2.l8.m1.1.1.2.2.cmml" xref="alg2.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.2.2.1.cmml" xref="alg2.l8.m1.1.1.2">subscript</csymbol><ci id="alg2.l8.m1.1.1.2.2.2.cmml" xref="alg2.l8.m1.1.1.2.2.2">𝒟</ci><ci id="alg2.l8.m1.1.1.2.2.3.cmml" xref="alg2.l8.m1.1.1.2.2.3">𝑆</ci></apply><ci id="alg2.l8.m1.1.1.2.3.cmml" xref="alg2.l8.m1.1.1.2.3">𝜏</ci></apply><list id="alg2.l8.m1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\mathcal{D}_{S}^{\tau}\leftarrow[\,]</annotation></semantics></math> <span id="alg2.l8.2" class="ltx_text" style="float:right;"><math id="alg2.l8.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l8.1.m1.1a"><mo id="alg2.l8.1.m1.1.1" xref="alg2.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l8.1.m1.1b"><ci id="alg2.l8.1.m1.1.1.cmml" xref="alg2.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.1.m1.1c">\triangleright</annotation></semantics></math> Create an empty list to hold <math id="alg2.l8.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{S}^{\tau}" display="inline"><semantics id="alg2.l8.2.m2.1a"><msubsup id="alg2.l8.2.m2.1.1" xref="alg2.l8.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.2.m2.1.1.2.2" xref="alg2.l8.2.m2.1.1.2.2.cmml">𝒟</mi><mi id="alg2.l8.2.m2.1.1.2.3" xref="alg2.l8.2.m2.1.1.2.3.cmml">S</mi><mi id="alg2.l8.2.m2.1.1.3" xref="alg2.l8.2.m2.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l8.2.m2.1b"><apply id="alg2.l8.2.m2.1.1.cmml" xref="alg2.l8.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l8.2.m2.1.1.1.cmml" xref="alg2.l8.2.m2.1.1">superscript</csymbol><apply id="alg2.l8.2.m2.1.1.2.cmml" xref="alg2.l8.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l8.2.m2.1.1.2.1.cmml" xref="alg2.l8.2.m2.1.1">subscript</csymbol><ci id="alg2.l8.2.m2.1.1.2.2.cmml" xref="alg2.l8.2.m2.1.1.2.2">𝒟</ci><ci id="alg2.l8.2.m2.1.1.2.3.cmml" xref="alg2.l8.2.m2.1.1.2.3">𝑆</ci></apply><ci id="alg2.l8.2.m2.1.1.3.cmml" xref="alg2.l8.2.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.2.m2.1c">\mathcal{D}_{S}^{\tau}</annotation></semantics></math>
</span>
</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math id="alg2.l9.m1.1" class="ltx_Math" alttext="\mathcal{D}_{Q}^{\tau}\leftarrow[\,]" display="inline"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><msubsup id="alg2.l9.m1.1.1.2" xref="alg2.l9.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.1.1.2.2.2" xref="alg2.l9.m1.1.1.2.2.2.cmml">𝒟</mi><mi id="alg2.l9.m1.1.1.2.2.3" xref="alg2.l9.m1.1.1.2.2.3.cmml">Q</mi><mi id="alg2.l9.m1.1.1.2.3" xref="alg2.l9.m1.1.1.2.3.cmml">τ</mi></msubsup><mo stretchy="false" id="alg2.l9.m1.1.1.1" xref="alg2.l9.m1.1.1.1.cmml">←</mo><mrow id="alg2.l9.m1.1.1.3.2" xref="alg2.l9.m1.1.1.cmml"><mo rspace="0.170em" stretchy="false" id="alg2.l9.m1.1.1.3.2.1" xref="alg2.l9.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="alg2.l9.m1.1.1.3.2.2" xref="alg2.l9.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><ci id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1">←</ci><apply id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1.2">superscript</csymbol><apply id="alg2.l9.m1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.2.2.1.cmml" xref="alg2.l9.m1.1.1.2">subscript</csymbol><ci id="alg2.l9.m1.1.1.2.2.2.cmml" xref="alg2.l9.m1.1.1.2.2.2">𝒟</ci><ci id="alg2.l9.m1.1.1.2.2.3.cmml" xref="alg2.l9.m1.1.1.2.2.3">𝑄</ci></apply><ci id="alg2.l9.m1.1.1.2.3.cmml" xref="alg2.l9.m1.1.1.2.3">𝜏</ci></apply><list id="alg2.l9.m1.1.1.3.1.cmml" xref="alg2.l9.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">\mathcal{D}_{Q}^{\tau}\leftarrow[\,]</annotation></semantics></math> <span id="alg2.l9.2" class="ltx_text" style="float:right;"><math id="alg2.l9.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l9.1.m1.1a"><mo id="alg2.l9.1.m1.1.1" xref="alg2.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l9.1.m1.1b"><ci id="alg2.l9.1.m1.1.1.cmml" xref="alg2.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.1.m1.1c">\triangleright</annotation></semantics></math> Create an empty list to hold <math id="alg2.l9.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{Q}^{\tau}" display="inline"><semantics id="alg2.l9.2.m2.1a"><msubsup id="alg2.l9.2.m2.1.1" xref="alg2.l9.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.2.m2.1.1.2.2" xref="alg2.l9.2.m2.1.1.2.2.cmml">𝒟</mi><mi id="alg2.l9.2.m2.1.1.2.3" xref="alg2.l9.2.m2.1.1.2.3.cmml">Q</mi><mi id="alg2.l9.2.m2.1.1.3" xref="alg2.l9.2.m2.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l9.2.m2.1b"><apply id="alg2.l9.2.m2.1.1.cmml" xref="alg2.l9.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l9.2.m2.1.1.1.cmml" xref="alg2.l9.2.m2.1.1">superscript</csymbol><apply id="alg2.l9.2.m2.1.1.2.cmml" xref="alg2.l9.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l9.2.m2.1.1.2.1.cmml" xref="alg2.l9.2.m2.1.1">subscript</csymbol><ci id="alg2.l9.2.m2.1.1.2.2.cmml" xref="alg2.l9.2.m2.1.1.2.2">𝒟</ci><ci id="alg2.l9.2.m2.1.1.2.3.cmml" xref="alg2.l9.2.m2.1.1.2.3">𝑄</ci></apply><ci id="alg2.l9.2.m2.1.1.3.cmml" xref="alg2.l9.2.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.2.m2.1c">\mathcal{D}_{Q}^{\tau}</annotation></semantics></math>
</span>
</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <span id="alg2.l10.1" class="ltx_text ltx_font_typewriter">train_classes, train_class_counts</span> <math id="alg2.l10.m1.1" class="ltx_Math" alttext="\leftarrow\texttt{unique}({\bm{y}}_{S})" display="inline"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><mi id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml"></mi><mo stretchy="false" id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml">←</mo><mrow id="alg2.l10.m1.1.1.1" xref="alg2.l10.m1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l10.m1.1.1.1.3" xref="alg2.l10.m1.1.1.1.3a.cmml">unique</mtext><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.1.2" xref="alg2.l10.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l10.m1.1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l10.m1.1.1.1.1.1.2" xref="alg2.l10.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l10.m1.1.1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l10.m1.1.1.1.1.1.1.2" xref="alg2.l10.m1.1.1.1.1.1.1.2.cmml">𝒚</mi><mi id="alg2.l10.m1.1.1.1.1.1.1.3" xref="alg2.l10.m1.1.1.1.1.1.1.3.cmml">S</mi></msub><mo stretchy="false" id="alg2.l10.m1.1.1.1.1.1.3" xref="alg2.l10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">←</ci><csymbol cd="latexml" id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3">absent</csymbol><apply id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1"><times id="alg2.l10.m1.1.1.1.2.cmml" xref="alg2.l10.m1.1.1.1.2"></times><ci id="alg2.l10.m1.1.1.1.3a.cmml" xref="alg2.l10.m1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg2.l10.m1.1.1.1.3.cmml" xref="alg2.l10.m1.1.1.1.3">unique</mtext></ci><apply id="alg2.l10.m1.1.1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l10.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.2">𝒚</ci><ci id="alg2.l10.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">\leftarrow\texttt{unique}({\bm{y}}_{S})</annotation></semantics></math>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <span id="alg2.l11.1" class="ltx_text ltx_font_typewriter">test_classes, test_class_counts</span> <math id="alg2.l11.m1.1" class="ltx_Math" alttext="\leftarrow\texttt{unique}({\bm{y}}_{Q})" display="inline"><semantics id="alg2.l11.m1.1a"><mrow id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml"><mi id="alg2.l11.m1.1.1.3" xref="alg2.l11.m1.1.1.3.cmml"></mi><mo stretchy="false" id="alg2.l11.m1.1.1.2" xref="alg2.l11.m1.1.1.2.cmml">←</mo><mrow id="alg2.l11.m1.1.1.1" xref="alg2.l11.m1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l11.m1.1.1.1.3" xref="alg2.l11.m1.1.1.1.3a.cmml">unique</mtext><mo lspace="0em" rspace="0em" id="alg2.l11.m1.1.1.1.2" xref="alg2.l11.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l11.m1.1.1.1.1.1" xref="alg2.l11.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l11.m1.1.1.1.1.1.2" xref="alg2.l11.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l11.m1.1.1.1.1.1.1" xref="alg2.l11.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l11.m1.1.1.1.1.1.1.2" xref="alg2.l11.m1.1.1.1.1.1.1.2.cmml">𝒚</mi><mi id="alg2.l11.m1.1.1.1.1.1.1.3" xref="alg2.l11.m1.1.1.1.1.1.1.3.cmml">Q</mi></msub><mo stretchy="false" id="alg2.l11.m1.1.1.1.1.1.3" xref="alg2.l11.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1"><ci id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1.2">←</ci><csymbol cd="latexml" id="alg2.l11.m1.1.1.3.cmml" xref="alg2.l11.m1.1.1.3">absent</csymbol><apply id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1"><times id="alg2.l11.m1.1.1.1.2.cmml" xref="alg2.l11.m1.1.1.1.2"></times><ci id="alg2.l11.m1.1.1.1.3a.cmml" xref="alg2.l11.m1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg2.l11.m1.1.1.1.3.cmml" xref="alg2.l11.m1.1.1.1.3">unique</mtext></ci><apply id="alg2.l11.m1.1.1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l11.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l11.m1.1.1.1.1.1.1.2">𝒚</ci><ci id="alg2.l11.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l11.m1.1.1.1.1.1.1.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">\leftarrow\texttt{unique}({\bm{y}}_{Q})</annotation></semantics></math>

</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>     <span id="alg2.l12.1" class="ltx_text ltx_font_typewriter">min_way</span> <math id="alg2.l12.m1.3" class="ltx_Math" alttext="\leftarrow\texttt{min}(\texttt{len}(\texttt{train\_classes}),5)" display="inline"><semantics id="alg2.l12.m1.3a"><mrow id="alg2.l12.m1.3.3" xref="alg2.l12.m1.3.3.cmml"><mi id="alg2.l12.m1.3.3.3" xref="alg2.l12.m1.3.3.3.cmml"></mi><mo stretchy="false" id="alg2.l12.m1.3.3.2" xref="alg2.l12.m1.3.3.2.cmml">←</mo><mrow id="alg2.l12.m1.3.3.1" xref="alg2.l12.m1.3.3.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l12.m1.3.3.1.3" xref="alg2.l12.m1.3.3.1.3a.cmml">min</mtext><mo lspace="0em" rspace="0em" id="alg2.l12.m1.3.3.1.2" xref="alg2.l12.m1.3.3.1.2.cmml">​</mo><mrow id="alg2.l12.m1.3.3.1.1.1" xref="alg2.l12.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="alg2.l12.m1.3.3.1.1.1.2" xref="alg2.l12.m1.3.3.1.1.2.cmml">(</mo><mrow id="alg2.l12.m1.3.3.1.1.1.1" xref="alg2.l12.m1.3.3.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l12.m1.3.3.1.1.1.1.2" xref="alg2.l12.m1.3.3.1.1.1.1.2a.cmml">len</mtext><mo lspace="0em" rspace="0em" id="alg2.l12.m1.3.3.1.1.1.1.1" xref="alg2.l12.m1.3.3.1.1.1.1.1.cmml">​</mo><mrow id="alg2.l12.m1.3.3.1.1.1.1.3.2" xref="alg2.l12.m1.1.1a.cmml"><mo stretchy="false" id="alg2.l12.m1.3.3.1.1.1.1.3.2.1" xref="alg2.l12.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml">train_classes</mtext><mo stretchy="false" id="alg2.l12.m1.3.3.1.1.1.1.3.2.2" xref="alg2.l12.m1.1.1a.cmml">)</mo></mrow></mrow><mo id="alg2.l12.m1.3.3.1.1.1.3" xref="alg2.l12.m1.3.3.1.1.2.cmml">,</mo><mn id="alg2.l12.m1.2.2" xref="alg2.l12.m1.2.2.cmml">5</mn><mo stretchy="false" id="alg2.l12.m1.3.3.1.1.1.4" xref="alg2.l12.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.3b"><apply id="alg2.l12.m1.3.3.cmml" xref="alg2.l12.m1.3.3"><ci id="alg2.l12.m1.3.3.2.cmml" xref="alg2.l12.m1.3.3.2">←</ci><csymbol cd="latexml" id="alg2.l12.m1.3.3.3.cmml" xref="alg2.l12.m1.3.3.3">absent</csymbol><apply id="alg2.l12.m1.3.3.1.cmml" xref="alg2.l12.m1.3.3.1"><times id="alg2.l12.m1.3.3.1.2.cmml" xref="alg2.l12.m1.3.3.1.2"></times><ci id="alg2.l12.m1.3.3.1.3a.cmml" xref="alg2.l12.m1.3.3.1.3"><mtext class="ltx_mathvariant_monospace" id="alg2.l12.m1.3.3.1.3.cmml" xref="alg2.l12.m1.3.3.1.3">min</mtext></ci><interval closure="open" id="alg2.l12.m1.3.3.1.1.2.cmml" xref="alg2.l12.m1.3.3.1.1.1"><apply id="alg2.l12.m1.3.3.1.1.1.1.cmml" xref="alg2.l12.m1.3.3.1.1.1.1"><times id="alg2.l12.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.1"></times><ci id="alg2.l12.m1.3.3.1.1.1.1.2a.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l12.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.2">len</mtext></ci><ci id="alg2.l12.m1.1.1a.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1">train_classes</mtext></ci></apply><cn type="integer" id="alg2.l12.m1.2.2.cmml" xref="alg2.l12.m1.2.2">5</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.3c">\leftarrow\texttt{min}(\texttt{len}(\texttt{train\_classes}),5)</annotation></semantics></math>

</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span id="alg2.l13.1" class="ltx_text ltx_font_typewriter">max_way</span> <math id="alg2.l13.m1.3" class="ltx_Math" alttext="\leftarrow\texttt{min}(\texttt{len}(\texttt{train\_classes}),\texttt{support\_set\_size})" display="inline"><semantics id="alg2.l13.m1.3a"><mrow id="alg2.l13.m1.3.3" xref="alg2.l13.m1.3.3.cmml"><mi id="alg2.l13.m1.3.3.3" xref="alg2.l13.m1.3.3.3.cmml"></mi><mo stretchy="false" id="alg2.l13.m1.3.3.2" xref="alg2.l13.m1.3.3.2.cmml">←</mo><mrow id="alg2.l13.m1.3.3.1" xref="alg2.l13.m1.3.3.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l13.m1.3.3.1.3" xref="alg2.l13.m1.3.3.1.3a.cmml">min</mtext><mo lspace="0em" rspace="0em" id="alg2.l13.m1.3.3.1.2" xref="alg2.l13.m1.3.3.1.2.cmml">​</mo><mrow id="alg2.l13.m1.3.3.1.1.1" xref="alg2.l13.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="alg2.l13.m1.3.3.1.1.1.2" xref="alg2.l13.m1.3.3.1.1.2.cmml">(</mo><mrow id="alg2.l13.m1.3.3.1.1.1.1" xref="alg2.l13.m1.3.3.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l13.m1.3.3.1.1.1.1.2" xref="alg2.l13.m1.3.3.1.1.1.1.2a.cmml">len</mtext><mo lspace="0em" rspace="0em" id="alg2.l13.m1.3.3.1.1.1.1.1" xref="alg2.l13.m1.3.3.1.1.1.1.1.cmml">​</mo><mrow id="alg2.l13.m1.3.3.1.1.1.1.3.2" xref="alg2.l13.m1.1.1a.cmml"><mo stretchy="false" id="alg2.l13.m1.3.3.1.1.1.1.3.2.1" xref="alg2.l13.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml">train_classes</mtext><mo stretchy="false" id="alg2.l13.m1.3.3.1.1.1.1.3.2.2" xref="alg2.l13.m1.1.1a.cmml">)</mo></mrow></mrow><mo id="alg2.l13.m1.3.3.1.1.1.3" xref="alg2.l13.m1.3.3.1.1.2.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l13.m1.2.2" xref="alg2.l13.m1.2.2a.cmml">support_set_size</mtext><mo stretchy="false" id="alg2.l13.m1.3.3.1.1.1.4" xref="alg2.l13.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.3b"><apply id="alg2.l13.m1.3.3.cmml" xref="alg2.l13.m1.3.3"><ci id="alg2.l13.m1.3.3.2.cmml" xref="alg2.l13.m1.3.3.2">←</ci><csymbol cd="latexml" id="alg2.l13.m1.3.3.3.cmml" xref="alg2.l13.m1.3.3.3">absent</csymbol><apply id="alg2.l13.m1.3.3.1.cmml" xref="alg2.l13.m1.3.3.1"><times id="alg2.l13.m1.3.3.1.2.cmml" xref="alg2.l13.m1.3.3.1.2"></times><ci id="alg2.l13.m1.3.3.1.3a.cmml" xref="alg2.l13.m1.3.3.1.3"><mtext class="ltx_mathvariant_monospace" id="alg2.l13.m1.3.3.1.3.cmml" xref="alg2.l13.m1.3.3.1.3">min</mtext></ci><interval closure="open" id="alg2.l13.m1.3.3.1.1.2.cmml" xref="alg2.l13.m1.3.3.1.1.1"><apply id="alg2.l13.m1.3.3.1.1.1.1.cmml" xref="alg2.l13.m1.3.3.1.1.1.1"><times id="alg2.l13.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l13.m1.3.3.1.1.1.1.1"></times><ci id="alg2.l13.m1.3.3.1.1.1.1.2a.cmml" xref="alg2.l13.m1.3.3.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l13.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l13.m1.3.3.1.1.1.1.2">len</mtext></ci><ci id="alg2.l13.m1.1.1a.cmml" xref="alg2.l13.m1.3.3.1.1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">train_classes</mtext></ci></apply><ci id="alg2.l13.m1.2.2a.cmml" xref="alg2.l13.m1.2.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l13.m1.2.2.cmml" xref="alg2.l13.m1.2.2">support_set_size</mtext></ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.3c">\leftarrow\texttt{min}(\texttt{len}(\texttt{train\_classes}),\texttt{support\_set\_size})</annotation></semantics></math>

</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>     <span id="alg2.l14.2" class="ltx_text ltx_font_typewriter">way</span> <math id="alg2.l14.m1.2" class="ltx_Math" alttext="\leftarrow\texttt{randint}(\texttt{min\_way},\texttt{max\_way})" display="inline"><semantics id="alg2.l14.m1.2a"><mrow id="alg2.l14.m1.2.3" xref="alg2.l14.m1.2.3.cmml"><mi id="alg2.l14.m1.2.3.2" xref="alg2.l14.m1.2.3.2.cmml"></mi><mo stretchy="false" id="alg2.l14.m1.2.3.1" xref="alg2.l14.m1.2.3.1.cmml">←</mo><mrow id="alg2.l14.m1.2.3.3" xref="alg2.l14.m1.2.3.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l14.m1.2.3.3.2" xref="alg2.l14.m1.2.3.3.2a.cmml">randint</mtext><mo lspace="0em" rspace="0em" id="alg2.l14.m1.2.3.3.1" xref="alg2.l14.m1.2.3.3.1.cmml">​</mo><mrow id="alg2.l14.m1.2.3.3.3.2" xref="alg2.l14.m1.2.3.3.3.1.cmml"><mo stretchy="false" id="alg2.l14.m1.2.3.3.3.2.1" xref="alg2.l14.m1.2.3.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1a.cmml">min_way</mtext><mo id="alg2.l14.m1.2.3.3.3.2.2" xref="alg2.l14.m1.2.3.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l14.m1.2.2" xref="alg2.l14.m1.2.2a.cmml">max_way</mtext><mo stretchy="false" id="alg2.l14.m1.2.3.3.3.2.3" xref="alg2.l14.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.2b"><apply id="alg2.l14.m1.2.3.cmml" xref="alg2.l14.m1.2.3"><ci id="alg2.l14.m1.2.3.1.cmml" xref="alg2.l14.m1.2.3.1">←</ci><csymbol cd="latexml" id="alg2.l14.m1.2.3.2.cmml" xref="alg2.l14.m1.2.3.2">absent</csymbol><apply id="alg2.l14.m1.2.3.3.cmml" xref="alg2.l14.m1.2.3.3"><times id="alg2.l14.m1.2.3.3.1.cmml" xref="alg2.l14.m1.2.3.3.1"></times><ci id="alg2.l14.m1.2.3.3.2a.cmml" xref="alg2.l14.m1.2.3.3.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l14.m1.2.3.3.2.cmml" xref="alg2.l14.m1.2.3.3.2">randint</mtext></ci><interval closure="open" id="alg2.l14.m1.2.3.3.3.1.cmml" xref="alg2.l14.m1.2.3.3.3.2"><ci id="alg2.l14.m1.1.1a.cmml" xref="alg2.l14.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1">min_way</mtext></ci><ci id="alg2.l14.m1.2.2a.cmml" xref="alg2.l14.m1.2.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l14.m1.2.2.cmml" xref="alg2.l14.m1.2.2">max_way</mtext></ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.2c">\leftarrow\texttt{randint}(\texttt{min\_way},\texttt{max\_way})</annotation></semantics></math> <span id="alg2.l14.1" class="ltx_text" style="float:right;"><math id="alg2.l14.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l14.1.m1.1a"><mo id="alg2.l14.1.m1.1.1" xref="alg2.l14.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l14.1.m1.1b"><ci id="alg2.l14.1.m1.1.1.cmml" xref="alg2.l14.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.1.m1.1c">\triangleright</annotation></semantics></math> Classification way to use for this task
</span>
</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>     <span id="alg2.l15.2" class="ltx_text ltx_font_typewriter">selected_classes</span> <math id="alg2.l15.m1.2" class="ltx_Math" alttext="\leftarrow\texttt{choice}(\texttt{train\_classes},\texttt{way})" display="inline"><semantics id="alg2.l15.m1.2a"><mrow id="alg2.l15.m1.2.3" xref="alg2.l15.m1.2.3.cmml"><mi id="alg2.l15.m1.2.3.2" xref="alg2.l15.m1.2.3.2.cmml"></mi><mo stretchy="false" id="alg2.l15.m1.2.3.1" xref="alg2.l15.m1.2.3.1.cmml">←</mo><mrow id="alg2.l15.m1.2.3.3" xref="alg2.l15.m1.2.3.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l15.m1.2.3.3.2" xref="alg2.l15.m1.2.3.3.2a.cmml">choice</mtext><mo lspace="0em" rspace="0em" id="alg2.l15.m1.2.3.3.1" xref="alg2.l15.m1.2.3.3.1.cmml">​</mo><mrow id="alg2.l15.m1.2.3.3.3.2" xref="alg2.l15.m1.2.3.3.3.1.cmml"><mo stretchy="false" id="alg2.l15.m1.2.3.3.3.2.1" xref="alg2.l15.m1.2.3.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1a.cmml">train_classes</mtext><mo id="alg2.l15.m1.2.3.3.3.2.2" xref="alg2.l15.m1.2.3.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l15.m1.2.2" xref="alg2.l15.m1.2.2a.cmml">way</mtext><mo stretchy="false" id="alg2.l15.m1.2.3.3.3.2.3" xref="alg2.l15.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.2b"><apply id="alg2.l15.m1.2.3.cmml" xref="alg2.l15.m1.2.3"><ci id="alg2.l15.m1.2.3.1.cmml" xref="alg2.l15.m1.2.3.1">←</ci><csymbol cd="latexml" id="alg2.l15.m1.2.3.2.cmml" xref="alg2.l15.m1.2.3.2">absent</csymbol><apply id="alg2.l15.m1.2.3.3.cmml" xref="alg2.l15.m1.2.3.3"><times id="alg2.l15.m1.2.3.3.1.cmml" xref="alg2.l15.m1.2.3.3.1"></times><ci id="alg2.l15.m1.2.3.3.2a.cmml" xref="alg2.l15.m1.2.3.3.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l15.m1.2.3.3.2.cmml" xref="alg2.l15.m1.2.3.3.2">choice</mtext></ci><interval closure="open" id="alg2.l15.m1.2.3.3.3.1.cmml" xref="alg2.l15.m1.2.3.3.3.2"><ci id="alg2.l15.m1.1.1a.cmml" xref="alg2.l15.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1">train_classes</mtext></ci><ci id="alg2.l15.m1.2.2a.cmml" xref="alg2.l15.m1.2.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l15.m1.2.2.cmml" xref="alg2.l15.m1.2.2">way</mtext></ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.2c">\leftarrow\texttt{choice}(\texttt{train\_classes},\texttt{way})</annotation></semantics></math> <span id="alg2.l15.1" class="ltx_text" style="float:right;"><math id="alg2.l15.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l15.1.m1.1a"><mo id="alg2.l15.1.m1.1.1" xref="alg2.l15.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l15.1.m1.1b"><ci id="alg2.l15.1.m1.1.1.cmml" xref="alg2.l15.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.1.m1.1c">\triangleright</annotation></semantics></math> List of classes to use in this task
</span>
</div>
<div id="alg2.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>     <span id="alg2.l16.1" class="ltx_text ltx_font_typewriter">balanced_shots</span> = <span id="alg2.l16.2" class="ltx_text ltx_font_typewriter">max</span>(<span id="alg2.l16.3" class="ltx_text ltx_font_typewriter">round</span>(<span id="alg2.l16.4" class="ltx_text ltx_font_typewriter">support_set_size</span> / <span id="alg2.l16.5" class="ltx_text ltx_font_typewriter">len</span>(<span id="alg2.l16.6" class="ltx_text ltx_font_typewriter">selected_classes</span>)), 1)

</div>
<div id="alg2.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>     <span id="alg2.l17.1" class="ltx_text ltx_font_typewriter">max_test_shots</span> <math id="alg2.l17.m1.2" class="ltx_Math" alttext="\leftarrow\texttt{max}(1,\texttt{floor}(2000/\texttt{way}))" display="inline"><semantics id="alg2.l17.m1.2a"><mrow id="alg2.l17.m1.2.2" xref="alg2.l17.m1.2.2.cmml"><mi id="alg2.l17.m1.2.2.3" xref="alg2.l17.m1.2.2.3.cmml"></mi><mo stretchy="false" id="alg2.l17.m1.2.2.2" xref="alg2.l17.m1.2.2.2.cmml">←</mo><mrow id="alg2.l17.m1.2.2.1" xref="alg2.l17.m1.2.2.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l17.m1.2.2.1.3" xref="alg2.l17.m1.2.2.1.3a.cmml">max</mtext><mo lspace="0em" rspace="0em" id="alg2.l17.m1.2.2.1.2" xref="alg2.l17.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l17.m1.2.2.1.1.1" xref="alg2.l17.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l17.m1.2.2.1.1.1.2" xref="alg2.l17.m1.2.2.1.1.2.cmml">(</mo><mn id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml">1</mn><mo id="alg2.l17.m1.2.2.1.1.1.3" xref="alg2.l17.m1.2.2.1.1.2.cmml">,</mo><mrow id="alg2.l17.m1.2.2.1.1.1.1" xref="alg2.l17.m1.2.2.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l17.m1.2.2.1.1.1.1.3" xref="alg2.l17.m1.2.2.1.1.1.1.3a.cmml">floor</mtext><mo lspace="0em" rspace="0em" id="alg2.l17.m1.2.2.1.1.1.1.2" xref="alg2.l17.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l17.m1.2.2.1.1.1.1.1.1" xref="alg2.l17.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l17.m1.2.2.1.1.1.1.1.1.2" xref="alg2.l17.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l17.m1.2.2.1.1.1.1.1.1.1" xref="alg2.l17.m1.2.2.1.1.1.1.1.1.1.cmml"><mn id="alg2.l17.m1.2.2.1.1.1.1.1.1.1.2" xref="alg2.l17.m1.2.2.1.1.1.1.1.1.1.2.cmml">2000</mn><mo id="alg2.l17.m1.2.2.1.1.1.1.1.1.1.1" xref="alg2.l17.m1.2.2.1.1.1.1.1.1.1.1.cmml">/</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l17.m1.2.2.1.1.1.1.1.1.1.3" xref="alg2.l17.m1.2.2.1.1.1.1.1.1.1.3a.cmml">way</mtext></mrow><mo stretchy="false" id="alg2.l17.m1.2.2.1.1.1.1.1.1.3" xref="alg2.l17.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.l17.m1.2.2.1.1.1.4" xref="alg2.l17.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.2b"><apply id="alg2.l17.m1.2.2.cmml" xref="alg2.l17.m1.2.2"><ci id="alg2.l17.m1.2.2.2.cmml" xref="alg2.l17.m1.2.2.2">←</ci><csymbol cd="latexml" id="alg2.l17.m1.2.2.3.cmml" xref="alg2.l17.m1.2.2.3">absent</csymbol><apply id="alg2.l17.m1.2.2.1.cmml" xref="alg2.l17.m1.2.2.1"><times id="alg2.l17.m1.2.2.1.2.cmml" xref="alg2.l17.m1.2.2.1.2"></times><ci id="alg2.l17.m1.2.2.1.3a.cmml" xref="alg2.l17.m1.2.2.1.3"><mtext class="ltx_mathvariant_monospace" id="alg2.l17.m1.2.2.1.3.cmml" xref="alg2.l17.m1.2.2.1.3">max</mtext></ci><interval closure="open" id="alg2.l17.m1.2.2.1.1.2.cmml" xref="alg2.l17.m1.2.2.1.1.1"><cn type="integer" id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1">1</cn><apply id="alg2.l17.m1.2.2.1.1.1.1.cmml" xref="alg2.l17.m1.2.2.1.1.1.1"><times id="alg2.l17.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l17.m1.2.2.1.1.1.1.2"></times><ci id="alg2.l17.m1.2.2.1.1.1.1.3a.cmml" xref="alg2.l17.m1.2.2.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg2.l17.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l17.m1.2.2.1.1.1.1.3">floor</mtext></ci><apply id="alg2.l17.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.l17.m1.2.2.1.1.1.1.1.1"><divide id="alg2.l17.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l17.m1.2.2.1.1.1.1.1.1.1.1"></divide><cn type="integer" id="alg2.l17.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg2.l17.m1.2.2.1.1.1.1.1.1.1.2">2000</cn><ci id="alg2.l17.m1.2.2.1.1.1.1.1.1.1.3a.cmml" xref="alg2.l17.m1.2.2.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg2.l17.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l17.m1.2.2.1.1.1.1.1.1.1.3">way</mtext></ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.2c">\leftarrow\texttt{max}(1,\texttt{floor}(2000/\texttt{way}))</annotation></semantics></math>

</div>
<div id="alg2.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>     <span id="alg2.l18.1" class="ltx_text ltx_font_bold">for all</span> <math id="alg2.l18.m1.1" class="ltx_Math" alttext="c\in\texttt{selected\_classes}" display="inline"><semantics id="alg2.l18.m1.1a"><mrow id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml"><mi id="alg2.l18.m1.1.1.2" xref="alg2.l18.m1.1.1.2.cmml">c</mi><mo id="alg2.l18.m1.1.1.1" xref="alg2.l18.m1.1.1.1.cmml">∈</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l18.m1.1.1.3" xref="alg2.l18.m1.1.1.3a.cmml">selected_classes</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.1b"><apply id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1"><in id="alg2.l18.m1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1"></in><ci id="alg2.l18.m1.1.1.2.cmml" xref="alg2.l18.m1.1.1.2">𝑐</ci><ci id="alg2.l18.m1.1.1.3a.cmml" xref="alg2.l18.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg2.l18.m1.1.1.3.cmml" xref="alg2.l18.m1.1.1.3">selected_classes</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.1c">c\in\texttt{selected\_classes}</annotation></semantics></math> <span id="alg2.l18.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>         <span id="alg2.l19.1" class="ltx_text ltx_font_typewriter">class_shots</span> <math id="alg2.l19.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l19.m1.1a"><mo stretchy="false" id="alg2.l19.m1.1.1" xref="alg2.l19.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l19.m1.1b"><ci id="alg2.l19.m1.1.1.cmml" xref="alg2.l19.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l19.m1.1c">\leftarrow</annotation></semantics></math> <span id="alg2.l19.2" class="ltx_text ltx_font_typewriter">train_class_counts</span>(<math id="alg2.l19.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg2.l19.m2.1a"><mi id="alg2.l19.m2.1.1" xref="alg2.l19.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg2.l19.m2.1b"><ci id="alg2.l19.m2.1.1.cmml" xref="alg2.l19.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l19.m2.1c">c</annotation></semantics></math>)

</div>
<div id="alg2.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>         <span id="alg2.l20.1" class="ltx_text ltx_font_typewriter">shots_to_use</span> <math id="alg2.l20.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l20.m1.1a"><mo stretchy="false" id="alg2.l20.m1.1.1" xref="alg2.l20.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l20.m1.1b"><ci id="alg2.l20.m1.1.1.cmml" xref="alg2.l20.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l20.m1.1c">\leftarrow</annotation></semantics></math> <span id="alg2.l20.2" class="ltx_text ltx_font_typewriter">min</span>(<span id="alg2.l20.3" class="ltx_text ltx_font_typewriter">class_shots</span>, <span id="alg2.l20.4" class="ltx_text ltx_font_typewriter">balanced_shots</span>)

</div>
<div id="alg2.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span>         <span id="alg2.l21.2" class="ltx_text ltx_font_typewriter">selected_shots</span> <math id="alg2.l21.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l21.m1.1a"><mo stretchy="false" id="alg2.l21.m1.1.1" xref="alg2.l21.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l21.m1.1b"><ci id="alg2.l21.m1.1.1.cmml" xref="alg2.l21.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.m1.1c">\leftarrow</annotation></semantics></math> <span id="alg2.l21.3" class="ltx_text ltx_font_typewriter">choice</span>(<span id="alg2.l21.4" class="ltx_text ltx_font_typewriter">class_shots</span>, <span id="alg2.l21.5" class="ltx_text ltx_font_typewriter">shots_to_use</span>) <span id="alg2.l21.1" class="ltx_text" style="float:right;"><math id="alg2.l21.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l21.1.m1.1a"><mo id="alg2.l21.1.m1.1.1" xref="alg2.l21.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l21.1.m1.1b"><ci id="alg2.l21.1.m1.1.1.cmml" xref="alg2.l21.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.1.m1.1c">\triangleright</annotation></semantics></math> Support shot list
</span>
</div>
<div id="alg2.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22:</span>         <math id="alg2.l22.m1.1" class="ltx_Math" alttext="\mathcal{D}_{S}^{\tau}\leftarrow\mathcal{D}_{S}^{\tau}+\mathcal{D}_{train}[\texttt{selected\_shots}]" display="inline"><semantics id="alg2.l22.m1.1a"><mrow id="alg2.l22.m1.1.2" xref="alg2.l22.m1.1.2.cmml"><msubsup id="alg2.l22.m1.1.2.2" xref="alg2.l22.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l22.m1.1.2.2.2.2" xref="alg2.l22.m1.1.2.2.2.2.cmml">𝒟</mi><mi id="alg2.l22.m1.1.2.2.2.3" xref="alg2.l22.m1.1.2.2.2.3.cmml">S</mi><mi id="alg2.l22.m1.1.2.2.3" xref="alg2.l22.m1.1.2.2.3.cmml">τ</mi></msubsup><mo stretchy="false" id="alg2.l22.m1.1.2.1" xref="alg2.l22.m1.1.2.1.cmml">←</mo><mrow id="alg2.l22.m1.1.2.3" xref="alg2.l22.m1.1.2.3.cmml"><msubsup id="alg2.l22.m1.1.2.3.2" xref="alg2.l22.m1.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l22.m1.1.2.3.2.2.2" xref="alg2.l22.m1.1.2.3.2.2.2.cmml">𝒟</mi><mi id="alg2.l22.m1.1.2.3.2.2.3" xref="alg2.l22.m1.1.2.3.2.2.3.cmml">S</mi><mi id="alg2.l22.m1.1.2.3.2.3" xref="alg2.l22.m1.1.2.3.2.3.cmml">τ</mi></msubsup><mo id="alg2.l22.m1.1.2.3.1" xref="alg2.l22.m1.1.2.3.1.cmml">+</mo><mrow id="alg2.l22.m1.1.2.3.3" xref="alg2.l22.m1.1.2.3.3.cmml"><msub id="alg2.l22.m1.1.2.3.3.2" xref="alg2.l22.m1.1.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l22.m1.1.2.3.3.2.2" xref="alg2.l22.m1.1.2.3.3.2.2.cmml">𝒟</mi><mrow id="alg2.l22.m1.1.2.3.3.2.3" xref="alg2.l22.m1.1.2.3.3.2.3.cmml"><mi id="alg2.l22.m1.1.2.3.3.2.3.2" xref="alg2.l22.m1.1.2.3.3.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l22.m1.1.2.3.3.2.3.1" xref="alg2.l22.m1.1.2.3.3.2.3.1.cmml">​</mo><mi id="alg2.l22.m1.1.2.3.3.2.3.3" xref="alg2.l22.m1.1.2.3.3.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l22.m1.1.2.3.3.2.3.1a" xref="alg2.l22.m1.1.2.3.3.2.3.1.cmml">​</mo><mi id="alg2.l22.m1.1.2.3.3.2.3.4" xref="alg2.l22.m1.1.2.3.3.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l22.m1.1.2.3.3.2.3.1b" xref="alg2.l22.m1.1.2.3.3.2.3.1.cmml">​</mo><mi id="alg2.l22.m1.1.2.3.3.2.3.5" xref="alg2.l22.m1.1.2.3.3.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l22.m1.1.2.3.3.2.3.1c" xref="alg2.l22.m1.1.2.3.3.2.3.1.cmml">​</mo><mi id="alg2.l22.m1.1.2.3.3.2.3.6" xref="alg2.l22.m1.1.2.3.3.2.3.6.cmml">n</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg2.l22.m1.1.2.3.3.1" xref="alg2.l22.m1.1.2.3.3.1.cmml">​</mo><mrow id="alg2.l22.m1.1.2.3.3.3.2" xref="alg2.l22.m1.1.2.3.3.3.1.cmml"><mo stretchy="false" id="alg2.l22.m1.1.2.3.3.3.2.1" xref="alg2.l22.m1.1.2.3.3.3.1.1.cmml">[</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l22.m1.1.1" xref="alg2.l22.m1.1.1a.cmml">selected_shots</mtext><mo stretchy="false" id="alg2.l22.m1.1.2.3.3.3.2.2" xref="alg2.l22.m1.1.2.3.3.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l22.m1.1b"><apply id="alg2.l22.m1.1.2.cmml" xref="alg2.l22.m1.1.2"><ci id="alg2.l22.m1.1.2.1.cmml" xref="alg2.l22.m1.1.2.1">←</ci><apply id="alg2.l22.m1.1.2.2.cmml" xref="alg2.l22.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l22.m1.1.2.2.1.cmml" xref="alg2.l22.m1.1.2.2">superscript</csymbol><apply id="alg2.l22.m1.1.2.2.2.cmml" xref="alg2.l22.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l22.m1.1.2.2.2.1.cmml" xref="alg2.l22.m1.1.2.2">subscript</csymbol><ci id="alg2.l22.m1.1.2.2.2.2.cmml" xref="alg2.l22.m1.1.2.2.2.2">𝒟</ci><ci id="alg2.l22.m1.1.2.2.2.3.cmml" xref="alg2.l22.m1.1.2.2.2.3">𝑆</ci></apply><ci id="alg2.l22.m1.1.2.2.3.cmml" xref="alg2.l22.m1.1.2.2.3">𝜏</ci></apply><apply id="alg2.l22.m1.1.2.3.cmml" xref="alg2.l22.m1.1.2.3"><plus id="alg2.l22.m1.1.2.3.1.cmml" xref="alg2.l22.m1.1.2.3.1"></plus><apply id="alg2.l22.m1.1.2.3.2.cmml" xref="alg2.l22.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l22.m1.1.2.3.2.1.cmml" xref="alg2.l22.m1.1.2.3.2">superscript</csymbol><apply id="alg2.l22.m1.1.2.3.2.2.cmml" xref="alg2.l22.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l22.m1.1.2.3.2.2.1.cmml" xref="alg2.l22.m1.1.2.3.2">subscript</csymbol><ci id="alg2.l22.m1.1.2.3.2.2.2.cmml" xref="alg2.l22.m1.1.2.3.2.2.2">𝒟</ci><ci id="alg2.l22.m1.1.2.3.2.2.3.cmml" xref="alg2.l22.m1.1.2.3.2.2.3">𝑆</ci></apply><ci id="alg2.l22.m1.1.2.3.2.3.cmml" xref="alg2.l22.m1.1.2.3.2.3">𝜏</ci></apply><apply id="alg2.l22.m1.1.2.3.3.cmml" xref="alg2.l22.m1.1.2.3.3"><times id="alg2.l22.m1.1.2.3.3.1.cmml" xref="alg2.l22.m1.1.2.3.3.1"></times><apply id="alg2.l22.m1.1.2.3.3.2.cmml" xref="alg2.l22.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l22.m1.1.2.3.3.2.1.cmml" xref="alg2.l22.m1.1.2.3.3.2">subscript</csymbol><ci id="alg2.l22.m1.1.2.3.3.2.2.cmml" xref="alg2.l22.m1.1.2.3.3.2.2">𝒟</ci><apply id="alg2.l22.m1.1.2.3.3.2.3.cmml" xref="alg2.l22.m1.1.2.3.3.2.3"><times id="alg2.l22.m1.1.2.3.3.2.3.1.cmml" xref="alg2.l22.m1.1.2.3.3.2.3.1"></times><ci id="alg2.l22.m1.1.2.3.3.2.3.2.cmml" xref="alg2.l22.m1.1.2.3.3.2.3.2">𝑡</ci><ci id="alg2.l22.m1.1.2.3.3.2.3.3.cmml" xref="alg2.l22.m1.1.2.3.3.2.3.3">𝑟</ci><ci id="alg2.l22.m1.1.2.3.3.2.3.4.cmml" xref="alg2.l22.m1.1.2.3.3.2.3.4">𝑎</ci><ci id="alg2.l22.m1.1.2.3.3.2.3.5.cmml" xref="alg2.l22.m1.1.2.3.3.2.3.5">𝑖</ci><ci id="alg2.l22.m1.1.2.3.3.2.3.6.cmml" xref="alg2.l22.m1.1.2.3.3.2.3.6">𝑛</ci></apply></apply><apply id="alg2.l22.m1.1.2.3.3.3.1.cmml" xref="alg2.l22.m1.1.2.3.3.3.2"><csymbol cd="latexml" id="alg2.l22.m1.1.2.3.3.3.1.1.cmml" xref="alg2.l22.m1.1.2.3.3.3.2.1">delimited-[]</csymbol><ci id="alg2.l22.m1.1.1a.cmml" xref="alg2.l22.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg2.l22.m1.1.1.cmml" xref="alg2.l22.m1.1.1">selected_shots</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l22.m1.1c">\mathcal{D}_{S}^{\tau}\leftarrow\mathcal{D}_{S}^{\tau}+\mathcal{D}_{train}[\texttt{selected\_shots}]</annotation></semantics></math> <span id="alg2.l22.2" class="ltx_text" style="float:right;"><math id="alg2.l22.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l22.1.m1.1a"><mo id="alg2.l22.1.m1.1.1" xref="alg2.l22.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l22.1.m1.1b"><ci id="alg2.l22.1.m1.1.1.cmml" xref="alg2.l22.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l22.1.m1.1c">\triangleright</annotation></semantics></math> Add examples to <math id="alg2.l22.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{S}^{\tau}" display="inline"><semantics id="alg2.l22.2.m2.1a"><msubsup id="alg2.l22.2.m2.1.1" xref="alg2.l22.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l22.2.m2.1.1.2.2" xref="alg2.l22.2.m2.1.1.2.2.cmml">𝒟</mi><mi id="alg2.l22.2.m2.1.1.2.3" xref="alg2.l22.2.m2.1.1.2.3.cmml">S</mi><mi id="alg2.l22.2.m2.1.1.3" xref="alg2.l22.2.m2.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l22.2.m2.1b"><apply id="alg2.l22.2.m2.1.1.cmml" xref="alg2.l22.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l22.2.m2.1.1.1.cmml" xref="alg2.l22.2.m2.1.1">superscript</csymbol><apply id="alg2.l22.2.m2.1.1.2.cmml" xref="alg2.l22.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l22.2.m2.1.1.2.1.cmml" xref="alg2.l22.2.m2.1.1">subscript</csymbol><ci id="alg2.l22.2.m2.1.1.2.2.cmml" xref="alg2.l22.2.m2.1.1.2.2">𝒟</ci><ci id="alg2.l22.2.m2.1.1.2.3.cmml" xref="alg2.l22.2.m2.1.1.2.3">𝑆</ci></apply><ci id="alg2.l22.2.m2.1.1.3.cmml" xref="alg2.l22.2.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l22.2.m2.1c">\mathcal{D}_{S}^{\tau}</annotation></semantics></math>
</span>
</div>
<div id="alg2.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23:</span>         <span id="alg2.l23.1" class="ltx_text ltx_font_typewriter">class_shots</span> <math id="alg2.l23.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l23.m1.1a"><mo stretchy="false" id="alg2.l23.m1.1.1" xref="alg2.l23.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l23.m1.1b"><ci id="alg2.l23.m1.1.1.cmml" xref="alg2.l23.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l23.m1.1c">\leftarrow</annotation></semantics></math> <span id="alg2.l23.2" class="ltx_text ltx_font_typewriter">test_class_counts</span>(<math id="alg2.l23.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg2.l23.m2.1a"><mi id="alg2.l23.m2.1.1" xref="alg2.l23.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg2.l23.m2.1b"><ci id="alg2.l23.m2.1.1.cmml" xref="alg2.l23.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l23.m2.1c">c</annotation></semantics></math>)

</div>
<div id="alg2.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24:</span>         <span id="alg2.l24.1" class="ltx_text ltx_font_typewriter">shots_to_use</span> <math id="alg2.l24.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l24.m1.1a"><mo stretchy="false" id="alg2.l24.m1.1.1" xref="alg2.l24.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l24.m1.1b"><ci id="alg2.l24.m1.1.1.cmml" xref="alg2.l24.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l24.m1.1c">\leftarrow</annotation></semantics></math> <span id="alg2.l24.2" class="ltx_text ltx_font_typewriter">min</span>(<span id="alg2.l24.3" class="ltx_text ltx_font_typewriter">class_shots</span>, <span id="alg2.l24.4" class="ltx_text ltx_font_typewriter">max_test_shots</span>)

</div>
<div id="alg2.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25:</span>         <span id="alg2.l25.2" class="ltx_text ltx_font_typewriter">selected_shots</span> <math id="alg2.l25.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l25.m1.1a"><mo stretchy="false" id="alg2.l25.m1.1.1" xref="alg2.l25.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l25.m1.1b"><ci id="alg2.l25.m1.1.1.cmml" xref="alg2.l25.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l25.m1.1c">\leftarrow</annotation></semantics></math> <span id="alg2.l25.3" class="ltx_text ltx_font_typewriter">choice</span>(<span id="alg2.l25.4" class="ltx_text ltx_font_typewriter">class_shots</span>, <span id="alg2.l25.5" class="ltx_text ltx_font_typewriter">shots_to_use</span>) <span id="alg2.l25.1" class="ltx_text" style="float:right;"><math id="alg2.l25.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l25.1.m1.1a"><mo id="alg2.l25.1.m1.1.1" xref="alg2.l25.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l25.1.m1.1b"><ci id="alg2.l25.1.m1.1.1.cmml" xref="alg2.l25.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l25.1.m1.1c">\triangleright</annotation></semantics></math> Query shot list
</span>
</div>
<div id="alg2.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26:</span>         <math id="alg2.l26.m1.1" class="ltx_Math" alttext="\mathcal{D}_{Q}^{\tau}\leftarrow\mathcal{D}_{Q}^{\tau}+\mathcal{D}_{test}[\texttt{selected\_shots}]" display="inline"><semantics id="alg2.l26.m1.1a"><mrow id="alg2.l26.m1.1.2" xref="alg2.l26.m1.1.2.cmml"><msubsup id="alg2.l26.m1.1.2.2" xref="alg2.l26.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l26.m1.1.2.2.2.2" xref="alg2.l26.m1.1.2.2.2.2.cmml">𝒟</mi><mi id="alg2.l26.m1.1.2.2.2.3" xref="alg2.l26.m1.1.2.2.2.3.cmml">Q</mi><mi id="alg2.l26.m1.1.2.2.3" xref="alg2.l26.m1.1.2.2.3.cmml">τ</mi></msubsup><mo stretchy="false" id="alg2.l26.m1.1.2.1" xref="alg2.l26.m1.1.2.1.cmml">←</mo><mrow id="alg2.l26.m1.1.2.3" xref="alg2.l26.m1.1.2.3.cmml"><msubsup id="alg2.l26.m1.1.2.3.2" xref="alg2.l26.m1.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l26.m1.1.2.3.2.2.2" xref="alg2.l26.m1.1.2.3.2.2.2.cmml">𝒟</mi><mi id="alg2.l26.m1.1.2.3.2.2.3" xref="alg2.l26.m1.1.2.3.2.2.3.cmml">Q</mi><mi id="alg2.l26.m1.1.2.3.2.3" xref="alg2.l26.m1.1.2.3.2.3.cmml">τ</mi></msubsup><mo id="alg2.l26.m1.1.2.3.1" xref="alg2.l26.m1.1.2.3.1.cmml">+</mo><mrow id="alg2.l26.m1.1.2.3.3" xref="alg2.l26.m1.1.2.3.3.cmml"><msub id="alg2.l26.m1.1.2.3.3.2" xref="alg2.l26.m1.1.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l26.m1.1.2.3.3.2.2" xref="alg2.l26.m1.1.2.3.3.2.2.cmml">𝒟</mi><mrow id="alg2.l26.m1.1.2.3.3.2.3" xref="alg2.l26.m1.1.2.3.3.2.3.cmml"><mi id="alg2.l26.m1.1.2.3.3.2.3.2" xref="alg2.l26.m1.1.2.3.3.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l26.m1.1.2.3.3.2.3.1" xref="alg2.l26.m1.1.2.3.3.2.3.1.cmml">​</mo><mi id="alg2.l26.m1.1.2.3.3.2.3.3" xref="alg2.l26.m1.1.2.3.3.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l26.m1.1.2.3.3.2.3.1a" xref="alg2.l26.m1.1.2.3.3.2.3.1.cmml">​</mo><mi id="alg2.l26.m1.1.2.3.3.2.3.4" xref="alg2.l26.m1.1.2.3.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.l26.m1.1.2.3.3.2.3.1b" xref="alg2.l26.m1.1.2.3.3.2.3.1.cmml">​</mo><mi id="alg2.l26.m1.1.2.3.3.2.3.5" xref="alg2.l26.m1.1.2.3.3.2.3.5.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg2.l26.m1.1.2.3.3.1" xref="alg2.l26.m1.1.2.3.3.1.cmml">​</mo><mrow id="alg2.l26.m1.1.2.3.3.3.2" xref="alg2.l26.m1.1.2.3.3.3.1.cmml"><mo stretchy="false" id="alg2.l26.m1.1.2.3.3.3.2.1" xref="alg2.l26.m1.1.2.3.3.3.1.1.cmml">[</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l26.m1.1.1" xref="alg2.l26.m1.1.1a.cmml">selected_shots</mtext><mo stretchy="false" id="alg2.l26.m1.1.2.3.3.3.2.2" xref="alg2.l26.m1.1.2.3.3.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l26.m1.1b"><apply id="alg2.l26.m1.1.2.cmml" xref="alg2.l26.m1.1.2"><ci id="alg2.l26.m1.1.2.1.cmml" xref="alg2.l26.m1.1.2.1">←</ci><apply id="alg2.l26.m1.1.2.2.cmml" xref="alg2.l26.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l26.m1.1.2.2.1.cmml" xref="alg2.l26.m1.1.2.2">superscript</csymbol><apply id="alg2.l26.m1.1.2.2.2.cmml" xref="alg2.l26.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l26.m1.1.2.2.2.1.cmml" xref="alg2.l26.m1.1.2.2">subscript</csymbol><ci id="alg2.l26.m1.1.2.2.2.2.cmml" xref="alg2.l26.m1.1.2.2.2.2">𝒟</ci><ci id="alg2.l26.m1.1.2.2.2.3.cmml" xref="alg2.l26.m1.1.2.2.2.3">𝑄</ci></apply><ci id="alg2.l26.m1.1.2.2.3.cmml" xref="alg2.l26.m1.1.2.2.3">𝜏</ci></apply><apply id="alg2.l26.m1.1.2.3.cmml" xref="alg2.l26.m1.1.2.3"><plus id="alg2.l26.m1.1.2.3.1.cmml" xref="alg2.l26.m1.1.2.3.1"></plus><apply id="alg2.l26.m1.1.2.3.2.cmml" xref="alg2.l26.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l26.m1.1.2.3.2.1.cmml" xref="alg2.l26.m1.1.2.3.2">superscript</csymbol><apply id="alg2.l26.m1.1.2.3.2.2.cmml" xref="alg2.l26.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l26.m1.1.2.3.2.2.1.cmml" xref="alg2.l26.m1.1.2.3.2">subscript</csymbol><ci id="alg2.l26.m1.1.2.3.2.2.2.cmml" xref="alg2.l26.m1.1.2.3.2.2.2">𝒟</ci><ci id="alg2.l26.m1.1.2.3.2.2.3.cmml" xref="alg2.l26.m1.1.2.3.2.2.3">𝑄</ci></apply><ci id="alg2.l26.m1.1.2.3.2.3.cmml" xref="alg2.l26.m1.1.2.3.2.3">𝜏</ci></apply><apply id="alg2.l26.m1.1.2.3.3.cmml" xref="alg2.l26.m1.1.2.3.3"><times id="alg2.l26.m1.1.2.3.3.1.cmml" xref="alg2.l26.m1.1.2.3.3.1"></times><apply id="alg2.l26.m1.1.2.3.3.2.cmml" xref="alg2.l26.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l26.m1.1.2.3.3.2.1.cmml" xref="alg2.l26.m1.1.2.3.3.2">subscript</csymbol><ci id="alg2.l26.m1.1.2.3.3.2.2.cmml" xref="alg2.l26.m1.1.2.3.3.2.2">𝒟</ci><apply id="alg2.l26.m1.1.2.3.3.2.3.cmml" xref="alg2.l26.m1.1.2.3.3.2.3"><times id="alg2.l26.m1.1.2.3.3.2.3.1.cmml" xref="alg2.l26.m1.1.2.3.3.2.3.1"></times><ci id="alg2.l26.m1.1.2.3.3.2.3.2.cmml" xref="alg2.l26.m1.1.2.3.3.2.3.2">𝑡</ci><ci id="alg2.l26.m1.1.2.3.3.2.3.3.cmml" xref="alg2.l26.m1.1.2.3.3.2.3.3">𝑒</ci><ci id="alg2.l26.m1.1.2.3.3.2.3.4.cmml" xref="alg2.l26.m1.1.2.3.3.2.3.4">𝑠</ci><ci id="alg2.l26.m1.1.2.3.3.2.3.5.cmml" xref="alg2.l26.m1.1.2.3.3.2.3.5">𝑡</ci></apply></apply><apply id="alg2.l26.m1.1.2.3.3.3.1.cmml" xref="alg2.l26.m1.1.2.3.3.3.2"><csymbol cd="latexml" id="alg2.l26.m1.1.2.3.3.3.1.1.cmml" xref="alg2.l26.m1.1.2.3.3.3.2.1">delimited-[]</csymbol><ci id="alg2.l26.m1.1.1a.cmml" xref="alg2.l26.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg2.l26.m1.1.1.cmml" xref="alg2.l26.m1.1.1">selected_shots</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l26.m1.1c">\mathcal{D}_{Q}^{\tau}\leftarrow\mathcal{D}_{Q}^{\tau}+\mathcal{D}_{test}[\texttt{selected\_shots}]</annotation></semantics></math> <span id="alg2.l26.2" class="ltx_text" style="float:right;"><math id="alg2.l26.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l26.1.m1.1a"><mo id="alg2.l26.1.m1.1.1" xref="alg2.l26.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l26.1.m1.1b"><ci id="alg2.l26.1.m1.1.1.cmml" xref="alg2.l26.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l26.1.m1.1c">\triangleright</annotation></semantics></math> Add examples to <math id="alg2.l26.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{Q}^{\tau}" display="inline"><semantics id="alg2.l26.2.m2.1a"><msubsup id="alg2.l26.2.m2.1.1" xref="alg2.l26.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l26.2.m2.1.1.2.2" xref="alg2.l26.2.m2.1.1.2.2.cmml">𝒟</mi><mi id="alg2.l26.2.m2.1.1.2.3" xref="alg2.l26.2.m2.1.1.2.3.cmml">Q</mi><mi id="alg2.l26.2.m2.1.1.3" xref="alg2.l26.2.m2.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l26.2.m2.1b"><apply id="alg2.l26.2.m2.1.1.cmml" xref="alg2.l26.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l26.2.m2.1.1.1.cmml" xref="alg2.l26.2.m2.1.1">superscript</csymbol><apply id="alg2.l26.2.m2.1.1.2.cmml" xref="alg2.l26.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l26.2.m2.1.1.2.1.cmml" xref="alg2.l26.2.m2.1.1">subscript</csymbol><ci id="alg2.l26.2.m2.1.1.2.2.cmml" xref="alg2.l26.2.m2.1.1.2.2">𝒟</ci><ci id="alg2.l26.2.m2.1.1.2.3.cmml" xref="alg2.l26.2.m2.1.1.2.3">𝑄</ci></apply><ci id="alg2.l26.2.m2.1.1.3.cmml" xref="alg2.l26.2.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l26.2.m2.1c">\mathcal{D}_{Q}^{\tau}</annotation></semantics></math>
</span>
</div>
<div id="alg2.l27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27:</span>     <span id="alg2.l27.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l27.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28:</span>     <span id="alg2.l28.1" class="ltx_text ltx_font_bold">return</span> <math id="alg2.l28.m1.1" class="ltx_Math" alttext="\mathcal{D}_{S}^{\tau}" display="inline"><semantics id="alg2.l28.m1.1a"><msubsup id="alg2.l28.m1.1.1" xref="alg2.l28.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l28.m1.1.1.2.2" xref="alg2.l28.m1.1.1.2.2.cmml">𝒟</mi><mi id="alg2.l28.m1.1.1.2.3" xref="alg2.l28.m1.1.1.2.3.cmml">S</mi><mi id="alg2.l28.m1.1.1.3" xref="alg2.l28.m1.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l28.m1.1b"><apply id="alg2.l28.m1.1.1.cmml" xref="alg2.l28.m1.1.1"><csymbol cd="ambiguous" id="alg2.l28.m1.1.1.1.cmml" xref="alg2.l28.m1.1.1">superscript</csymbol><apply id="alg2.l28.m1.1.1.2.cmml" xref="alg2.l28.m1.1.1"><csymbol cd="ambiguous" id="alg2.l28.m1.1.1.2.1.cmml" xref="alg2.l28.m1.1.1">subscript</csymbol><ci id="alg2.l28.m1.1.1.2.2.cmml" xref="alg2.l28.m1.1.1.2.2">𝒟</ci><ci id="alg2.l28.m1.1.1.2.3.cmml" xref="alg2.l28.m1.1.1.2.3">𝑆</ci></apply><ci id="alg2.l28.m1.1.1.3.cmml" xref="alg2.l28.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l28.m1.1c">\mathcal{D}_{S}^{\tau}</annotation></semantics></math>, <math id="alg2.l28.m2.1" class="ltx_Math" alttext="\mathcal{D}_{Q}^{\tau}" display="inline"><semantics id="alg2.l28.m2.1a"><msubsup id="alg2.l28.m2.1.1" xref="alg2.l28.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l28.m2.1.1.2.2" xref="alg2.l28.m2.1.1.2.2.cmml">𝒟</mi><mi id="alg2.l28.m2.1.1.2.3" xref="alg2.l28.m2.1.1.2.3.cmml">Q</mi><mi id="alg2.l28.m2.1.1.3" xref="alg2.l28.m2.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l28.m2.1b"><apply id="alg2.l28.m2.1.1.cmml" xref="alg2.l28.m2.1.1"><csymbol cd="ambiguous" id="alg2.l28.m2.1.1.1.cmml" xref="alg2.l28.m2.1.1">superscript</csymbol><apply id="alg2.l28.m2.1.1.2.cmml" xref="alg2.l28.m2.1.1"><csymbol cd="ambiguous" id="alg2.l28.m2.1.1.2.1.cmml" xref="alg2.l28.m2.1.1">subscript</csymbol><ci id="alg2.l28.m2.1.1.2.2.cmml" xref="alg2.l28.m2.1.1.2.2">𝒟</ci><ci id="alg2.l28.m2.1.1.2.3.cmml" xref="alg2.l28.m2.1.1.2.3">𝑄</ci></apply><ci id="alg2.l28.m2.1.1.3.cmml" xref="alg2.l28.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l28.m2.1c">\mathcal{D}_{Q}^{\tau}</annotation></semantics></math>

</div>
<div id="alg2.l29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29:</span><span id="alg2.l29.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l29.2" class="ltx_text ltx_font_bold">procedure</span>
</div>
</div>
</figure>
</section>
<section id="A1.SS11" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.11 </span>Training and Evaluation Details</h3>

<div id="A1.SS11.p1" class="ltx_para ltx_noindent">
<p id="A1.SS11.p1.1" class="ltx_p">In this section, we provide implementation details for all of the experiments in <a href="#S4" title="4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<section id="A1.SS11.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.11.1 </span>Few-shot and VTAB-1k Transfer Learning Experiments</h4>

<section id="A1.SS11.SSS1.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_font_smallcaps ltx_title_paragraph">FiT</h5>

<div id="A1.SS11.SSS1.Px1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS1.Px1.p1.5" class="ltx_p">All of the <span id="A1.SS11.SSS1.Px1.p1.5.1" class="ltx_text ltx_font_smallcaps">FiT</span> few-shot and VTAB-1k transfer learning experiments were carried out on a single NVIDIA A100 GPU with 80GB of memory.
The Adam optimizer <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite> with a constant learning rate of 0.0035, for 400 iterations, and <math id="A1.SS11.SSS1.Px1.p1.1.m1.1" class="ltx_Math" alttext="|\mathcal{D}_{S}^{\tau}|" display="inline"><semantics id="A1.SS11.SSS1.Px1.p1.1.m1.1a"><mrow id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.2.cmml"><mo stretchy="false" id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.2" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.2.1.cmml">|</mo><msubsup id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.2.2" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.2.3" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.2.3.cmml">S</mi><mi id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.3" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.3.cmml">τ</mi></msubsup><mo stretchy="false" id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.3" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS1.Px1.p1.1.m1.1b"><apply id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.2.cmml" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1"><abs id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.2.1.cmml" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.2"></abs><apply id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.cmml" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.1.cmml" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1">superscript</csymbol><apply id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.2.cmml" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.2.1.cmml" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.2.2.cmml" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.2.2">𝒟</ci><ci id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.2.3.cmml" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.2.3">𝑆</ci></apply><ci id="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.3.cmml" xref="A1.SS11.SSS1.Px1.p1.1.m1.1.1.1.1.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS1.Px1.p1.1.m1.1c">|\mathcal{D}_{S}^{\tau}|</annotation></semantics></math>=100 was used throughout.
No data augmentation was used and images were scaled to 384<math id="A1.SS11.SSS1.Px1.p1.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.SS11.SSS1.Px1.p1.2.m2.1a"><mo id="A1.SS11.SSS1.Px1.p1.2.m2.1.1" xref="A1.SS11.SSS1.Px1.p1.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS1.Px1.p1.2.m2.1b"><times id="A1.SS11.SSS1.Px1.p1.2.m2.1.1.cmml" xref="A1.SS11.SSS1.Px1.p1.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS1.Px1.p1.2.m2.1c">\times</annotation></semantics></math>384 pixels unless the image size was 32<math id="A1.SS11.SSS1.Px1.p1.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.SS11.SSS1.Px1.p1.3.m3.1a"><mo id="A1.SS11.SSS1.Px1.p1.3.m3.1.1" xref="A1.SS11.SSS1.Px1.p1.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS1.Px1.p1.3.m3.1b"><times id="A1.SS11.SSS1.Px1.p1.3.m3.1.1.cmml" xref="A1.SS11.SSS1.Px1.p1.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS1.Px1.p1.3.m3.1c">\times</annotation></semantics></math>32 pixels or less, in which case the images were scaled to 224<math id="A1.SS11.SSS1.Px1.p1.4.m4.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.SS11.SSS1.Px1.p1.4.m4.1a"><mo id="A1.SS11.SSS1.Px1.p1.4.m4.1.1" xref="A1.SS11.SSS1.Px1.p1.4.m4.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS1.Px1.p1.4.m4.1b"><times id="A1.SS11.SSS1.Px1.p1.4.m4.1.1.cmml" xref="A1.SS11.SSS1.Px1.p1.4.m4.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS1.Px1.p1.4.m4.1c">\times</annotation></semantics></math>224 pixels.
In each iteration of episodic fine tuning, we perform a single step of gradient ascent on <math id="A1.SS11.SSS1.Px1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{Q}^{\tau}" display="inline"><semantics id="A1.SS11.SSS1.Px1.p1.5.m5.1a"><msubsup id="A1.SS11.SSS1.Px1.p1.5.m5.1.1" xref="A1.SS11.SSS1.Px1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS11.SSS1.Px1.p1.5.m5.1.1.2.2" xref="A1.SS11.SSS1.Px1.p1.5.m5.1.1.2.2.cmml">𝒟</mi><mi id="A1.SS11.SSS1.Px1.p1.5.m5.1.1.2.3" xref="A1.SS11.SSS1.Px1.p1.5.m5.1.1.2.3.cmml">Q</mi><mi id="A1.SS11.SSS1.Px1.p1.5.m5.1.1.3" xref="A1.SS11.SSS1.Px1.p1.5.m5.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS1.Px1.p1.5.m5.1b"><apply id="A1.SS11.SSS1.Px1.p1.5.m5.1.1.cmml" xref="A1.SS11.SSS1.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS11.SSS1.Px1.p1.5.m5.1.1.1.cmml" xref="A1.SS11.SSS1.Px1.p1.5.m5.1.1">superscript</csymbol><apply id="A1.SS11.SSS1.Px1.p1.5.m5.1.1.2.cmml" xref="A1.SS11.SSS1.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS11.SSS1.Px1.p1.5.m5.1.1.2.1.cmml" xref="A1.SS11.SSS1.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="A1.SS11.SSS1.Px1.p1.5.m5.1.1.2.2.cmml" xref="A1.SS11.SSS1.Px1.p1.5.m5.1.1.2.2">𝒟</ci><ci id="A1.SS11.SSS1.Px1.p1.5.m5.1.1.2.3.cmml" xref="A1.SS11.SSS1.Px1.p1.5.m5.1.1.2.3">𝑄</ci></apply><ci id="A1.SS11.SSS1.Px1.p1.5.m5.1.1.3.cmml" xref="A1.SS11.SSS1.Px1.p1.5.m5.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS1.Px1.p1.5.m5.1c">\mathcal{D}_{Q}^{\tau}</annotation></semantics></math>.
These hyper-parameters were empirically derived from a small number of runs.</p>
</div>
<div id="A1.SS11.SSS1.Px1.p2" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS1.Px1.p2.1" class="ltx_p"><span id="A1.SS11.SSS1.Px1.p2.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-QDA, <span id="A1.SS11.SSS1.Px1.p2.1.2" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA, and <span id="A1.SS11.SSS1.Px1.p2.1.3" class="ltx_text ltx_font_smallcaps">FiT</span>-ProtoNets take approximately 12, 10, and 9 hours, respectively, to fine-tune on all 19 VTAB datasets and 5, 3, and 3 hours, respectively, to fine tune all shots on the 4 low-shot datasets.</p>
</div>
<div id="A1.SS11.SSS1.Px1.p3" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS1.Px1.p3.1" class="ltx_p">For the <span id="A1.SS11.SSS1.Px1.p3.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA results using the EfficientNetV2-M backbone in <a href="#S4.T3" title="In 4.2 VTAB-1k Results ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">3</span></a>, we used 1000 iterations instead of 400 and ran the experiments on 4 NVIDIA A100 GPUs, each with 80GB of memory.</p>
</div>
</section>
<section id="A1.SS11.SSS1.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">BiT</h5>

<div id="A1.SS11.SSS1.Px2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS1.Px2.p1.1" class="ltx_p">For the BiT few-shot experiments, we used the code supplied by the authors <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib30" title="" class="ltx_ref">2020</a>)</cite> with minor augmentations to read additional datasets.
The BiT few-shot experiments were run on a single NVIDIA V100 GPU with 16GB.</p>
</div>
<div id="A1.SS11.SSS1.Px2.p2" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS1.Px2.p2.1" class="ltx_p">For the BiT VTAB-1k experiments, we used the three fine-tuned models for each of the datasets that were provided by the authors <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib30" title="" class="ltx_ref">2020</a>)</cite>.
We evaluated all of the models on the respective test splits for each dataset and averaged the results of the three models.
The BiT-HyperRule <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite> was respected in all runs. These experiments were executed on a single NVIDIA GeForce RTX 3090 with 24GB of memory.</p>
</div>
</section>
</section>
<section id="A1.SS11.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.11.2 </span>Personalization on ORBIT Experiments</h4>

<div id="A1.SS11.SSS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS2.p1.1" class="ltx_p">The personalization experiments were carried out on a single NVIDIA GeForce RTX 3090 with 24GB of memory.
It takes approximately <math id="A1.SS11.SSS2.p1.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.SS11.SSS2.p1.1.m1.1a"><mn id="A1.SS11.SSS2.p1.1.m1.1.1" xref="A1.SS11.SSS2.p1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS2.p1.1.m1.1b"><cn type="integer" id="A1.SS11.SSS2.p1.1.m1.1.1.cmml" xref="A1.SS11.SSS2.p1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS2.p1.1.m1.1c">5</annotation></semantics></math> hours to train <span id="A1.SS11.SSS2.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA personalization models for all the ORBIT <cite class="ltx_cite ltx_citemacro_citep">(Massiceti et al., <a href="#bib.bib35" title="" class="ltx_ref">2021</a>)</cite> test tasks.
We derived all hyperparameters empirically from a small number of runs.
We used the ORBIT codebase<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a target="_blank" href="https://github.com/microsoft/ORBIT-Dataset" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/microsoft/ORBIT-Dataset</a></span></span></span> in our experiments, only adding the code for splitting test user tasks and slightly modifying the main training loop to make it suitable for <span id="A1.SS11.SSS2.p1.1.2" class="ltx_text ltx_font_smallcaps">FiT</span> training.</p>
</div>
<div id="A1.SS11.SSS2.p2" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS2.p2.3" class="ltx_p">In the comparison of <span id="A1.SS11.SSS2.p2.3.1" class="ltx_text ltx_font_smallcaps">FiT</span> to standard benchmarks on ORBIT (upper part of <a href="#S4.T4" title="In 4.3 Personalization ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">4</span></a>), all methods use an EfficientNet-B0 (<math id="A1.SS11.SSS2.p2.1.m1.1" class="ltx_Math" alttext="d_{b}=1280" display="inline"><semantics id="A1.SS11.SSS2.p2.1.m1.1a"><mrow id="A1.SS11.SSS2.p2.1.m1.1.1" xref="A1.SS11.SSS2.p2.1.m1.1.1.cmml"><msub id="A1.SS11.SSS2.p2.1.m1.1.1.2" xref="A1.SS11.SSS2.p2.1.m1.1.1.2.cmml"><mi id="A1.SS11.SSS2.p2.1.m1.1.1.2.2" xref="A1.SS11.SSS2.p2.1.m1.1.1.2.2.cmml">d</mi><mi id="A1.SS11.SSS2.p2.1.m1.1.1.2.3" xref="A1.SS11.SSS2.p2.1.m1.1.1.2.3.cmml">b</mi></msub><mo id="A1.SS11.SSS2.p2.1.m1.1.1.1" xref="A1.SS11.SSS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS11.SSS2.p2.1.m1.1.1.3" xref="A1.SS11.SSS2.p2.1.m1.1.1.3.cmml">1280</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS2.p2.1.m1.1b"><apply id="A1.SS11.SSS2.p2.1.m1.1.1.cmml" xref="A1.SS11.SSS2.p2.1.m1.1.1"><eq id="A1.SS11.SSS2.p2.1.m1.1.1.1.cmml" xref="A1.SS11.SSS2.p2.1.m1.1.1.1"></eq><apply id="A1.SS11.SSS2.p2.1.m1.1.1.2.cmml" xref="A1.SS11.SSS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS11.SSS2.p2.1.m1.1.1.2.1.cmml" xref="A1.SS11.SSS2.p2.1.m1.1.1.2">subscript</csymbol><ci id="A1.SS11.SSS2.p2.1.m1.1.1.2.2.cmml" xref="A1.SS11.SSS2.p2.1.m1.1.1.2.2">𝑑</ci><ci id="A1.SS11.SSS2.p2.1.m1.1.1.2.3.cmml" xref="A1.SS11.SSS2.p2.1.m1.1.1.2.3">𝑏</ci></apply><cn type="integer" id="A1.SS11.SSS2.p2.1.m1.1.1.3.cmml" xref="A1.SS11.SSS2.p2.1.m1.1.1.3">1280</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS2.p2.1.m1.1c">d_{b}=1280</annotation></semantics></math>) as the feature extractor and an image size of <math id="A1.SS11.SSS2.p2.2.m2.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="A1.SS11.SSS2.p2.2.m2.1a"><mrow id="A1.SS11.SSS2.p2.2.m2.1.1" xref="A1.SS11.SSS2.p2.2.m2.1.1.cmml"><mn id="A1.SS11.SSS2.p2.2.m2.1.1.2" xref="A1.SS11.SSS2.p2.2.m2.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="A1.SS11.SSS2.p2.2.m2.1.1.1" xref="A1.SS11.SSS2.p2.2.m2.1.1.1.cmml">×</mo><mn id="A1.SS11.SSS2.p2.2.m2.1.1.3" xref="A1.SS11.SSS2.p2.2.m2.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS2.p2.2.m2.1b"><apply id="A1.SS11.SSS2.p2.2.m2.1.1.cmml" xref="A1.SS11.SSS2.p2.2.m2.1.1"><times id="A1.SS11.SSS2.p2.2.m2.1.1.1.cmml" xref="A1.SS11.SSS2.p2.2.m2.1.1.1"></times><cn type="integer" id="A1.SS11.SSS2.p2.2.m2.1.1.2.cmml" xref="A1.SS11.SSS2.p2.2.m2.1.1.2">224</cn><cn type="integer" id="A1.SS11.SSS2.p2.2.m2.1.1.3.cmml" xref="A1.SS11.SSS2.p2.2.m2.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS2.p2.2.m2.1c">224\times 224</annotation></semantics></math>.
<span id="A1.SS11.SSS2.p2.3.2" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA, FineTuner <cite class="ltx_cite ltx_citemacro_citep">(Yosinski et al., <a href="#bib.bib63" title="" class="ltx_ref">2014</a>)</cite> and Simple CNAPs <cite class="ltx_cite ltx_citemacro_citep">(Bateni et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite> use a backbone pretrained on ImageNet <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a href="#bib.bib10" title="" class="ltx_ref">2009</a>)</cite>, while ProtoNets <cite class="ltx_cite ltx_citemacro_citep">(Snell et al., <a href="#bib.bib54" title="" class="ltx_ref">2017</a>)</cite> meta-trained the weights of the feature extractor on Meta-Dataset <cite class="ltx_cite ltx_citemacro_citep">(Dumoulin et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>.
The task encoder in Simple CNAPs <cite class="ltx_cite ltx_citemacro_citep">(Bateni et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite> is meta-trained on Meta-Dataset.
The results for all models (FineTuner <cite class="ltx_cite ltx_citemacro_citep">(Yosinski et al., <a href="#bib.bib63" title="" class="ltx_ref">2014</a>)</cite>, Simple CNAPs <cite class="ltx_cite ltx_citemacro_citep">(Bateni et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite> and ProtoNets <cite class="ltx_cite ltx_citemacro_citep">(Snell et al., <a href="#bib.bib54" title="" class="ltx_ref">2017</a>)</cite>) are from <cite class="ltx_cite ltx_citemacro_citep">(Bronskill et al., <a href="#bib.bib4" title="" class="ltx_ref">2021</a>)</cite>.
FiLM layers in <span id="A1.SS11.SSS2.p2.3.3" class="ltx_text ltx_font_smallcaps">FiT</span>-LDA are added to the feature extractor as described in <a href="#S2" title="2 FiLM Transfer (FiT) ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">2</span></a>, resulting in <math id="A1.SS11.SSS2.p2.3.m3.1" class="ltx_Math" alttext="|{\bm{\psi}}|=20544" display="inline"><semantics id="A1.SS11.SSS2.p2.3.m3.1a"><mrow id="A1.SS11.SSS2.p2.3.m3.1.2" xref="A1.SS11.SSS2.p2.3.m3.1.2.cmml"><mrow id="A1.SS11.SSS2.p2.3.m3.1.2.2.2" xref="A1.SS11.SSS2.p2.3.m3.1.2.2.1.cmml"><mo stretchy="false" id="A1.SS11.SSS2.p2.3.m3.1.2.2.2.1" xref="A1.SS11.SSS2.p2.3.m3.1.2.2.1.1.cmml">|</mo><mi id="A1.SS11.SSS2.p2.3.m3.1.1" xref="A1.SS11.SSS2.p2.3.m3.1.1.cmml">𝝍</mi><mo stretchy="false" id="A1.SS11.SSS2.p2.3.m3.1.2.2.2.2" xref="A1.SS11.SSS2.p2.3.m3.1.2.2.1.1.cmml">|</mo></mrow><mo id="A1.SS11.SSS2.p2.3.m3.1.2.1" xref="A1.SS11.SSS2.p2.3.m3.1.2.1.cmml">=</mo><mn id="A1.SS11.SSS2.p2.3.m3.1.2.3" xref="A1.SS11.SSS2.p2.3.m3.1.2.3.cmml">20544</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS2.p2.3.m3.1b"><apply id="A1.SS11.SSS2.p2.3.m3.1.2.cmml" xref="A1.SS11.SSS2.p2.3.m3.1.2"><eq id="A1.SS11.SSS2.p2.3.m3.1.2.1.cmml" xref="A1.SS11.SSS2.p2.3.m3.1.2.1"></eq><apply id="A1.SS11.SSS2.p2.3.m3.1.2.2.1.cmml" xref="A1.SS11.SSS2.p2.3.m3.1.2.2.2"><abs id="A1.SS11.SSS2.p2.3.m3.1.2.2.1.1.cmml" xref="A1.SS11.SSS2.p2.3.m3.1.2.2.2.1"></abs><ci id="A1.SS11.SSS2.p2.3.m3.1.1.cmml" xref="A1.SS11.SSS2.p2.3.m3.1.1">𝝍</ci></apply><cn type="integer" id="A1.SS11.SSS2.p2.3.m3.1.2.3.cmml" xref="A1.SS11.SSS2.p2.3.m3.1.2.3">20544</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS2.p2.3.m3.1c">|{\bm{\psi}}|=20544</annotation></semantics></math>.</p>
</div>
<div id="A1.SS11.SSS2.p3" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS2.p3.1" class="ltx_p">For the comparison of <span id="A1.SS11.SSS2.p3.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> and BiT (lower part of <a href="#S4.T4" title="In 4.3 Personalization ‣ 4 Experiments ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">4</span></a>), we use the BiT-M-R50x1 backbone pretrained on ImageNet-21K. BiT was trained using the BiT-HyperRule <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite> on every user task. For experiments with BiT, we used the code supplied by the authors <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite> with minor augmentations to read the ORBIT dataset.</p>
</div>
<div id="A1.SS11.SSS2.p4" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS2.p4.4" class="ltx_p">We follow the task sampling protocols described in <cite class="ltx_cite ltx_citemacro_citep">(Massiceti et al., <a href="#bib.bib35" title="" class="ltx_ref">2021</a>)</cite>, and train the <span id="A1.SS11.SSS2.p4.4.1" class="ltx_text ltx_font_smallcaps">FiT</span> model for <math id="A1.SS11.SSS2.p4.1.m1.1" class="ltx_Math" alttext="50" display="inline"><semantics id="A1.SS11.SSS2.p4.1.m1.1a"><mn id="A1.SS11.SSS2.p4.1.m1.1.1" xref="A1.SS11.SSS2.p4.1.m1.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS2.p4.1.m1.1b"><cn type="integer" id="A1.SS11.SSS2.p4.1.m1.1.1.cmml" xref="A1.SS11.SSS2.p4.1.m1.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS2.p4.1.m1.1c">50</annotation></semantics></math> optimization steps using the Adam optimizer with a learning rate of <math id="A1.SS11.SSS2.p4.2.m2.1" class="ltx_Math" alttext="0.007" display="inline"><semantics id="A1.SS11.SSS2.p4.2.m2.1a"><mn id="A1.SS11.SSS2.p4.2.m2.1.1" xref="A1.SS11.SSS2.p4.2.m2.1.1.cmml">0.007</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS2.p4.2.m2.1b"><cn type="float" id="A1.SS11.SSS2.p4.2.m2.1.1.cmml" xref="A1.SS11.SSS2.p4.2.m2.1.1">0.007</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS2.p4.2.m2.1c">0.007</annotation></semantics></math> for EfficientNet-B0 and <math id="A1.SS11.SSS2.p4.3.m3.1" class="ltx_Math" alttext="0.003" display="inline"><semantics id="A1.SS11.SSS2.p4.3.m3.1a"><mn id="A1.SS11.SSS2.p4.3.m3.1.1" xref="A1.SS11.SSS2.p4.3.m3.1.1.cmml">0.003</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS2.p4.3.m3.1b"><cn type="float" id="A1.SS11.SSS2.p4.3.m3.1.1.cmml" xref="A1.SS11.SSS2.p4.3.m3.1.1">0.003</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS2.p4.3.m3.1c">0.003</annotation></semantics></math> for BiT-M-R50x1.
The ORBIT test tasks have a slightly different structure in comparison to standard few-shot classification tasks, so in <a href="#alg3" title="In A.11.2 Personalization on ORBIT Experiments ‣ A.11 Training and Evaluation Details ‣ Appendix A Appendix ‣ FiT: Parameter Efficient Few-shot Transfer Learning for Personalized and Federated Image Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">A.3</span></a> we provide a modified version of the data splitting for the classifier head construction.
In particular, each test user has a number of objects (classes) they want to recognize, with several videos recorded per object.
Each video is split into clips, consecutive <math id="A1.SS11.SSS2.p4.4.m4.1" class="ltx_Math" alttext="8" display="inline"><semantics id="A1.SS11.SSS2.p4.4.m4.1a"><mn id="A1.SS11.SSS2.p4.4.m4.1.1" xref="A1.SS11.SSS2.p4.4.m4.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS2.p4.4.m4.1b"><cn type="integer" id="A1.SS11.SSS2.p4.4.m4.1.1.cmml" xref="A1.SS11.SSS2.p4.4.m4.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS2.p4.4.m4.1c">8</annotation></semantics></math>-frame parts of the video.
A user test task is comprised of these clips, randomly sampled from different videos of the user’s objects, and associated labels.
Since clips sampled from the same video can be semantically similar, we split the test task so that clips from the same video can only be in either the support or query set, except for the cases when there is only one video of an object available.</p>
</div>
<figure id="alg3" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg3.4.1.1" class="ltx_text ltx_font_bold">Algorithm A.3</span> </span> Splitting a test task <math id="alg3.2.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="alg3.2.m1.1b"><mi class="ltx_font_mathcaligraphic" id="alg3.2.m1.1.1" xref="alg3.2.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg3.2.m1.1c"><ci id="alg3.2.m1.1.1.cmml" xref="alg3.2.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.2.m1.1d">\mathcal{D}</annotation></semantics></math> for ORBIT personalization experiments</figcaption>
<div id="alg3.5" class="ltx_listing ltx_listing">
<div id="alg3.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><math id="alg3.l1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="alg3.l1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.l1.m1.1.1" xref="alg3.l1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.1b"><ci id="alg3.l1.m1.1.1.cmml" xref="alg3.l1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.1c">\mathcal{D}</annotation></semantics></math>: downstream dataset; <math id="alg3.l1.m2.1" class="ltx_Math" alttext="\mathcal{D}=\{\mathcal{D}_{c}\}_{c=1}^{C}" display="inline"><semantics id="alg3.l1.m2.1a"><mrow id="alg3.l1.m2.1.1" xref="alg3.l1.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l1.m2.1.1.3" xref="alg3.l1.m2.1.1.3.cmml">𝒟</mi><mo id="alg3.l1.m2.1.1.2" xref="alg3.l1.m2.1.1.2.cmml">=</mo><msubsup id="alg3.l1.m2.1.1.1" xref="alg3.l1.m2.1.1.1.cmml"><mrow id="alg3.l1.m2.1.1.1.1.1.1" xref="alg3.l1.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg3.l1.m2.1.1.1.1.1.1.2" xref="alg3.l1.m2.1.1.1.1.1.2.cmml">{</mo><msub id="alg3.l1.m2.1.1.1.1.1.1.1" xref="alg3.l1.m2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l1.m2.1.1.1.1.1.1.1.2" xref="alg3.l1.m2.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="alg3.l1.m2.1.1.1.1.1.1.1.3" xref="alg3.l1.m2.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="alg3.l1.m2.1.1.1.1.1.1.3" xref="alg3.l1.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg3.l1.m2.1.1.1.1.3" xref="alg3.l1.m2.1.1.1.1.3.cmml"><mi id="alg3.l1.m2.1.1.1.1.3.2" xref="alg3.l1.m2.1.1.1.1.3.2.cmml">c</mi><mo id="alg3.l1.m2.1.1.1.1.3.1" xref="alg3.l1.m2.1.1.1.1.3.1.cmml">=</mo><mn id="alg3.l1.m2.1.1.1.1.3.3" xref="alg3.l1.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg3.l1.m2.1.1.1.3" xref="alg3.l1.m2.1.1.1.3.cmml">C</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m2.1b"><apply id="alg3.l1.m2.1.1.cmml" xref="alg3.l1.m2.1.1"><eq id="alg3.l1.m2.1.1.2.cmml" xref="alg3.l1.m2.1.1.2"></eq><ci id="alg3.l1.m2.1.1.3.cmml" xref="alg3.l1.m2.1.1.3">𝒟</ci><apply id="alg3.l1.m2.1.1.1.cmml" xref="alg3.l1.m2.1.1.1"><csymbol cd="ambiguous" id="alg3.l1.m2.1.1.1.2.cmml" xref="alg3.l1.m2.1.1.1">superscript</csymbol><apply id="alg3.l1.m2.1.1.1.1.cmml" xref="alg3.l1.m2.1.1.1"><csymbol cd="ambiguous" id="alg3.l1.m2.1.1.1.1.2.cmml" xref="alg3.l1.m2.1.1.1">subscript</csymbol><set id="alg3.l1.m2.1.1.1.1.1.2.cmml" xref="alg3.l1.m2.1.1.1.1.1.1"><apply id="alg3.l1.m2.1.1.1.1.1.1.1.cmml" xref="alg3.l1.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l1.m2.1.1.1.1.1.1.1.1.cmml" xref="alg3.l1.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l1.m2.1.1.1.1.1.1.1.2.cmml" xref="alg3.l1.m2.1.1.1.1.1.1.1.2">𝒟</ci><ci id="alg3.l1.m2.1.1.1.1.1.1.1.3.cmml" xref="alg3.l1.m2.1.1.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="alg3.l1.m2.1.1.1.1.3.cmml" xref="alg3.l1.m2.1.1.1.1.3"><eq id="alg3.l1.m2.1.1.1.1.3.1.cmml" xref="alg3.l1.m2.1.1.1.1.3.1"></eq><ci id="alg3.l1.m2.1.1.1.1.3.2.cmml" xref="alg3.l1.m2.1.1.1.1.3.2">𝑐</ci><cn type="integer" id="alg3.l1.m2.1.1.1.1.3.3.cmml" xref="alg3.l1.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="alg3.l1.m2.1.1.1.3.cmml" xref="alg3.l1.m2.1.1.1.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m2.1c">\mathcal{D}=\{\mathcal{D}_{c}\}_{c=1}^{C}</annotation></semantics></math>, where <math id="alg3.l1.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg3.l1.m3.1a"><mi id="alg3.l1.m3.1.1" xref="alg3.l1.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m3.1b"><ci id="alg3.l1.m3.1.1.cmml" xref="alg3.l1.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m3.1c">C</annotation></semantics></math> is the number of classes in test task, <math id="alg3.l1.m4.1" class="ltx_Math" alttext="\mathcal{D}_{c}" display="inline"><semantics id="alg3.l1.m4.1a"><msub id="alg3.l1.m4.1.1" xref="alg3.l1.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l1.m4.1.1.2" xref="alg3.l1.m4.1.1.2.cmml">𝒟</mi><mi id="alg3.l1.m4.1.1.3" xref="alg3.l1.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m4.1b"><apply id="alg3.l1.m4.1.1.cmml" xref="alg3.l1.m4.1.1"><csymbol cd="ambiguous" id="alg3.l1.m4.1.1.1.cmml" xref="alg3.l1.m4.1.1">subscript</csymbol><ci id="alg3.l1.m4.1.1.2.cmml" xref="alg3.l1.m4.1.1.2">𝒟</ci><ci id="alg3.l1.m4.1.1.3.cmml" xref="alg3.l1.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m4.1c">\mathcal{D}_{c}</annotation></semantics></math> is data of class <math id="alg3.l1.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg3.l1.m5.1a"><mi id="alg3.l1.m5.1.1" xref="alg3.l1.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m5.1b"><ci id="alg3.l1.m5.1.1.cmml" xref="alg3.l1.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m5.1c">c</annotation></semantics></math>; <math id="alg3.l1.m6.1" class="ltx_Math" alttext="\mathcal{D}_{c}=\{V_{ci}\}_{i=1}^{n_{c}}" display="inline"><semantics id="alg3.l1.m6.1a"><mrow id="alg3.l1.m6.1.1" xref="alg3.l1.m6.1.1.cmml"><msub id="alg3.l1.m6.1.1.3" xref="alg3.l1.m6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l1.m6.1.1.3.2" xref="alg3.l1.m6.1.1.3.2.cmml">𝒟</mi><mi id="alg3.l1.m6.1.1.3.3" xref="alg3.l1.m6.1.1.3.3.cmml">c</mi></msub><mo id="alg3.l1.m6.1.1.2" xref="alg3.l1.m6.1.1.2.cmml">=</mo><msubsup id="alg3.l1.m6.1.1.1" xref="alg3.l1.m6.1.1.1.cmml"><mrow id="alg3.l1.m6.1.1.1.1.1.1" xref="alg3.l1.m6.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg3.l1.m6.1.1.1.1.1.1.2" xref="alg3.l1.m6.1.1.1.1.1.2.cmml">{</mo><msub id="alg3.l1.m6.1.1.1.1.1.1.1" xref="alg3.l1.m6.1.1.1.1.1.1.1.cmml"><mi id="alg3.l1.m6.1.1.1.1.1.1.1.2" xref="alg3.l1.m6.1.1.1.1.1.1.1.2.cmml">V</mi><mrow id="alg3.l1.m6.1.1.1.1.1.1.1.3" xref="alg3.l1.m6.1.1.1.1.1.1.1.3.cmml"><mi id="alg3.l1.m6.1.1.1.1.1.1.1.3.2" xref="alg3.l1.m6.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m6.1.1.1.1.1.1.1.3.1" xref="alg3.l1.m6.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg3.l1.m6.1.1.1.1.1.1.1.3.3" xref="alg3.l1.m6.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo stretchy="false" id="alg3.l1.m6.1.1.1.1.1.1.3" xref="alg3.l1.m6.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg3.l1.m6.1.1.1.1.3" xref="alg3.l1.m6.1.1.1.1.3.cmml"><mi id="alg3.l1.m6.1.1.1.1.3.2" xref="alg3.l1.m6.1.1.1.1.3.2.cmml">i</mi><mo id="alg3.l1.m6.1.1.1.1.3.1" xref="alg3.l1.m6.1.1.1.1.3.1.cmml">=</mo><mn id="alg3.l1.m6.1.1.1.1.3.3" xref="alg3.l1.m6.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="alg3.l1.m6.1.1.1.3" xref="alg3.l1.m6.1.1.1.3.cmml"><mi id="alg3.l1.m6.1.1.1.3.2" xref="alg3.l1.m6.1.1.1.3.2.cmml">n</mi><mi id="alg3.l1.m6.1.1.1.3.3" xref="alg3.l1.m6.1.1.1.3.3.cmml">c</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m6.1b"><apply id="alg3.l1.m6.1.1.cmml" xref="alg3.l1.m6.1.1"><eq id="alg3.l1.m6.1.1.2.cmml" xref="alg3.l1.m6.1.1.2"></eq><apply id="alg3.l1.m6.1.1.3.cmml" xref="alg3.l1.m6.1.1.3"><csymbol cd="ambiguous" id="alg3.l1.m6.1.1.3.1.cmml" xref="alg3.l1.m6.1.1.3">subscript</csymbol><ci id="alg3.l1.m6.1.1.3.2.cmml" xref="alg3.l1.m6.1.1.3.2">𝒟</ci><ci id="alg3.l1.m6.1.1.3.3.cmml" xref="alg3.l1.m6.1.1.3.3">𝑐</ci></apply><apply id="alg3.l1.m6.1.1.1.cmml" xref="alg3.l1.m6.1.1.1"><csymbol cd="ambiguous" id="alg3.l1.m6.1.1.1.2.cmml" xref="alg3.l1.m6.1.1.1">superscript</csymbol><apply id="alg3.l1.m6.1.1.1.1.cmml" xref="alg3.l1.m6.1.1.1"><csymbol cd="ambiguous" id="alg3.l1.m6.1.1.1.1.2.cmml" xref="alg3.l1.m6.1.1.1">subscript</csymbol><set id="alg3.l1.m6.1.1.1.1.1.2.cmml" xref="alg3.l1.m6.1.1.1.1.1.1"><apply id="alg3.l1.m6.1.1.1.1.1.1.1.cmml" xref="alg3.l1.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l1.m6.1.1.1.1.1.1.1.1.cmml" xref="alg3.l1.m6.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l1.m6.1.1.1.1.1.1.1.2.cmml" xref="alg3.l1.m6.1.1.1.1.1.1.1.2">𝑉</ci><apply id="alg3.l1.m6.1.1.1.1.1.1.1.3.cmml" xref="alg3.l1.m6.1.1.1.1.1.1.1.3"><times id="alg3.l1.m6.1.1.1.1.1.1.1.3.1.cmml" xref="alg3.l1.m6.1.1.1.1.1.1.1.3.1"></times><ci id="alg3.l1.m6.1.1.1.1.1.1.1.3.2.cmml" xref="alg3.l1.m6.1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="alg3.l1.m6.1.1.1.1.1.1.1.3.3.cmml" xref="alg3.l1.m6.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></set><apply id="alg3.l1.m6.1.1.1.1.3.cmml" xref="alg3.l1.m6.1.1.1.1.3"><eq id="alg3.l1.m6.1.1.1.1.3.1.cmml" xref="alg3.l1.m6.1.1.1.1.3.1"></eq><ci id="alg3.l1.m6.1.1.1.1.3.2.cmml" xref="alg3.l1.m6.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg3.l1.m6.1.1.1.1.3.3.cmml" xref="alg3.l1.m6.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg3.l1.m6.1.1.1.3.cmml" xref="alg3.l1.m6.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l1.m6.1.1.1.3.1.cmml" xref="alg3.l1.m6.1.1.1.3">subscript</csymbol><ci id="alg3.l1.m6.1.1.1.3.2.cmml" xref="alg3.l1.m6.1.1.1.3.2">𝑛</ci><ci id="alg3.l1.m6.1.1.1.3.3.cmml" xref="alg3.l1.m6.1.1.1.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m6.1c">\mathcal{D}_{c}=\{V_{ci}\}_{i=1}^{n_{c}}</annotation></semantics></math>, where <math id="alg3.l1.m7.1" class="ltx_Math" alttext="n_{c}" display="inline"><semantics id="alg3.l1.m7.1a"><msub id="alg3.l1.m7.1.1" xref="alg3.l1.m7.1.1.cmml"><mi id="alg3.l1.m7.1.1.2" xref="alg3.l1.m7.1.1.2.cmml">n</mi><mi id="alg3.l1.m7.1.1.3" xref="alg3.l1.m7.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m7.1b"><apply id="alg3.l1.m7.1.1.cmml" xref="alg3.l1.m7.1.1"><csymbol cd="ambiguous" id="alg3.l1.m7.1.1.1.cmml" xref="alg3.l1.m7.1.1">subscript</csymbol><ci id="alg3.l1.m7.1.1.2.cmml" xref="alg3.l1.m7.1.1.2">𝑛</ci><ci id="alg3.l1.m7.1.1.3.cmml" xref="alg3.l1.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m7.1c">n_{c}</annotation></semantics></math> is the number of videos in class <math id="alg3.l1.m8.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg3.l1.m8.1a"><mi id="alg3.l1.m8.1.1" xref="alg3.l1.m8.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m8.1b"><ci id="alg3.l1.m8.1.1.cmml" xref="alg3.l1.m8.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m8.1c">c</annotation></semantics></math>, <math id="alg3.l1.m9.1" class="ltx_Math" alttext="V_{ci}" display="inline"><semantics id="alg3.l1.m9.1a"><msub id="alg3.l1.m9.1.1" xref="alg3.l1.m9.1.1.cmml"><mi id="alg3.l1.m9.1.1.2" xref="alg3.l1.m9.1.1.2.cmml">V</mi><mrow id="alg3.l1.m9.1.1.3" xref="alg3.l1.m9.1.1.3.cmml"><mi id="alg3.l1.m9.1.1.3.2" xref="alg3.l1.m9.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m9.1.1.3.1" xref="alg3.l1.m9.1.1.3.1.cmml">​</mo><mi id="alg3.l1.m9.1.1.3.3" xref="alg3.l1.m9.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m9.1b"><apply id="alg3.l1.m9.1.1.cmml" xref="alg3.l1.m9.1.1"><csymbol cd="ambiguous" id="alg3.l1.m9.1.1.1.cmml" xref="alg3.l1.m9.1.1">subscript</csymbol><ci id="alg3.l1.m9.1.1.2.cmml" xref="alg3.l1.m9.1.1.2">𝑉</ci><apply id="alg3.l1.m9.1.1.3.cmml" xref="alg3.l1.m9.1.1.3"><times id="alg3.l1.m9.1.1.3.1.cmml" xref="alg3.l1.m9.1.1.3.1"></times><ci id="alg3.l1.m9.1.1.3.2.cmml" xref="alg3.l1.m9.1.1.3.2">𝑐</ci><ci id="alg3.l1.m9.1.1.3.3.cmml" xref="alg3.l1.m9.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m9.1c">V_{ci}</annotation></semantics></math> is the set of clips from <math id="alg3.l1.m10.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg3.l1.m10.1a"><mi id="alg3.l1.m10.1.1" xref="alg3.l1.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m10.1b"><ci id="alg3.l1.m10.1.1.cmml" xref="alg3.l1.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m10.1c">i</annotation></semantics></math>th video of class <math id="alg3.l1.m11.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg3.l1.m11.1a"><mi id="alg3.l1.m11.1.1" xref="alg3.l1.m11.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m11.1b"><ci id="alg3.l1.m11.1.1.cmml" xref="alg3.l1.m11.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m11.1c">c</annotation></semantics></math>; <math id="alg3.l1.m12.2" class="ltx_Math" alttext="V_{ci}=\{(x_{cij},c)\}_{j=1}^{n_{ci}}" display="inline"><semantics id="alg3.l1.m12.2a"><mrow id="alg3.l1.m12.2.2" xref="alg3.l1.m12.2.2.cmml"><msub id="alg3.l1.m12.2.2.3" xref="alg3.l1.m12.2.2.3.cmml"><mi id="alg3.l1.m12.2.2.3.2" xref="alg3.l1.m12.2.2.3.2.cmml">V</mi><mrow id="alg3.l1.m12.2.2.3.3" xref="alg3.l1.m12.2.2.3.3.cmml"><mi id="alg3.l1.m12.2.2.3.3.2" xref="alg3.l1.m12.2.2.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m12.2.2.3.3.1" xref="alg3.l1.m12.2.2.3.3.1.cmml">​</mo><mi id="alg3.l1.m12.2.2.3.3.3" xref="alg3.l1.m12.2.2.3.3.3.cmml">i</mi></mrow></msub><mo id="alg3.l1.m12.2.2.2" xref="alg3.l1.m12.2.2.2.cmml">=</mo><msubsup id="alg3.l1.m12.2.2.1" xref="alg3.l1.m12.2.2.1.cmml"><mrow id="alg3.l1.m12.2.2.1.1.1.1" xref="alg3.l1.m12.2.2.1.1.1.2.cmml"><mo stretchy="false" id="alg3.l1.m12.2.2.1.1.1.1.2" xref="alg3.l1.m12.2.2.1.1.1.2.cmml">{</mo><mrow id="alg3.l1.m12.2.2.1.1.1.1.1.1" xref="alg3.l1.m12.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg3.l1.m12.2.2.1.1.1.1.1.1.2" xref="alg3.l1.m12.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="alg3.l1.m12.2.2.1.1.1.1.1.1.1" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.2" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.2" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.1" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.3" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.1a" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.4" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.4.cmml">j</mi></mrow></msub><mo id="alg3.l1.m12.2.2.1.1.1.1.1.1.3" xref="alg3.l1.m12.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="alg3.l1.m12.1.1" xref="alg3.l1.m12.1.1.cmml">c</mi><mo stretchy="false" id="alg3.l1.m12.2.2.1.1.1.1.1.1.4" xref="alg3.l1.m12.2.2.1.1.1.1.1.2.cmml">)</mo></mrow><mo stretchy="false" id="alg3.l1.m12.2.2.1.1.1.1.3" xref="alg3.l1.m12.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="alg3.l1.m12.2.2.1.1.3" xref="alg3.l1.m12.2.2.1.1.3.cmml"><mi id="alg3.l1.m12.2.2.1.1.3.2" xref="alg3.l1.m12.2.2.1.1.3.2.cmml">j</mi><mo id="alg3.l1.m12.2.2.1.1.3.1" xref="alg3.l1.m12.2.2.1.1.3.1.cmml">=</mo><mn id="alg3.l1.m12.2.2.1.1.3.3" xref="alg3.l1.m12.2.2.1.1.3.3.cmml">1</mn></mrow><msub id="alg3.l1.m12.2.2.1.3" xref="alg3.l1.m12.2.2.1.3.cmml"><mi id="alg3.l1.m12.2.2.1.3.2" xref="alg3.l1.m12.2.2.1.3.2.cmml">n</mi><mrow id="alg3.l1.m12.2.2.1.3.3" xref="alg3.l1.m12.2.2.1.3.3.cmml"><mi id="alg3.l1.m12.2.2.1.3.3.2" xref="alg3.l1.m12.2.2.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m12.2.2.1.3.3.1" xref="alg3.l1.m12.2.2.1.3.3.1.cmml">​</mo><mi id="alg3.l1.m12.2.2.1.3.3.3" xref="alg3.l1.m12.2.2.1.3.3.3.cmml">i</mi></mrow></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m12.2b"><apply id="alg3.l1.m12.2.2.cmml" xref="alg3.l1.m12.2.2"><eq id="alg3.l1.m12.2.2.2.cmml" xref="alg3.l1.m12.2.2.2"></eq><apply id="alg3.l1.m12.2.2.3.cmml" xref="alg3.l1.m12.2.2.3"><csymbol cd="ambiguous" id="alg3.l1.m12.2.2.3.1.cmml" xref="alg3.l1.m12.2.2.3">subscript</csymbol><ci id="alg3.l1.m12.2.2.3.2.cmml" xref="alg3.l1.m12.2.2.3.2">𝑉</ci><apply id="alg3.l1.m12.2.2.3.3.cmml" xref="alg3.l1.m12.2.2.3.3"><times id="alg3.l1.m12.2.2.3.3.1.cmml" xref="alg3.l1.m12.2.2.3.3.1"></times><ci id="alg3.l1.m12.2.2.3.3.2.cmml" xref="alg3.l1.m12.2.2.3.3.2">𝑐</ci><ci id="alg3.l1.m12.2.2.3.3.3.cmml" xref="alg3.l1.m12.2.2.3.3.3">𝑖</ci></apply></apply><apply id="alg3.l1.m12.2.2.1.cmml" xref="alg3.l1.m12.2.2.1"><csymbol cd="ambiguous" id="alg3.l1.m12.2.2.1.2.cmml" xref="alg3.l1.m12.2.2.1">superscript</csymbol><apply id="alg3.l1.m12.2.2.1.1.cmml" xref="alg3.l1.m12.2.2.1"><csymbol cd="ambiguous" id="alg3.l1.m12.2.2.1.1.2.cmml" xref="alg3.l1.m12.2.2.1">subscript</csymbol><set id="alg3.l1.m12.2.2.1.1.1.2.cmml" xref="alg3.l1.m12.2.2.1.1.1.1"><interval closure="open" id="alg3.l1.m12.2.2.1.1.1.1.1.2.cmml" xref="alg3.l1.m12.2.2.1.1.1.1.1.1"><apply id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.cmml" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.2">𝑥</ci><apply id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3"><times id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.1"></times><ci id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.3">𝑖</ci><ci id="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.4.cmml" xref="alg3.l1.m12.2.2.1.1.1.1.1.1.1.3.4">𝑗</ci></apply></apply><ci id="alg3.l1.m12.1.1.cmml" xref="alg3.l1.m12.1.1">𝑐</ci></interval></set><apply id="alg3.l1.m12.2.2.1.1.3.cmml" xref="alg3.l1.m12.2.2.1.1.3"><eq id="alg3.l1.m12.2.2.1.1.3.1.cmml" xref="alg3.l1.m12.2.2.1.1.3.1"></eq><ci id="alg3.l1.m12.2.2.1.1.3.2.cmml" xref="alg3.l1.m12.2.2.1.1.3.2">𝑗</ci><cn type="integer" id="alg3.l1.m12.2.2.1.1.3.3.cmml" xref="alg3.l1.m12.2.2.1.1.3.3">1</cn></apply></apply><apply id="alg3.l1.m12.2.2.1.3.cmml" xref="alg3.l1.m12.2.2.1.3"><csymbol cd="ambiguous" id="alg3.l1.m12.2.2.1.3.1.cmml" xref="alg3.l1.m12.2.2.1.3">subscript</csymbol><ci id="alg3.l1.m12.2.2.1.3.2.cmml" xref="alg3.l1.m12.2.2.1.3.2">𝑛</ci><apply id="alg3.l1.m12.2.2.1.3.3.cmml" xref="alg3.l1.m12.2.2.1.3.3"><times id="alg3.l1.m12.2.2.1.3.3.1.cmml" xref="alg3.l1.m12.2.2.1.3.3.1"></times><ci id="alg3.l1.m12.2.2.1.3.3.2.cmml" xref="alg3.l1.m12.2.2.1.3.3.2">𝑐</ci><ci id="alg3.l1.m12.2.2.1.3.3.3.cmml" xref="alg3.l1.m12.2.2.1.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m12.2c">V_{ci}=\{(x_{cij},c)\}_{j=1}^{n_{ci}}</annotation></semantics></math>, where <math id="alg3.l1.m13.1" class="ltx_Math" alttext="n_{ci}" display="inline"><semantics id="alg3.l1.m13.1a"><msub id="alg3.l1.m13.1.1" xref="alg3.l1.m13.1.1.cmml"><mi id="alg3.l1.m13.1.1.2" xref="alg3.l1.m13.1.1.2.cmml">n</mi><mrow id="alg3.l1.m13.1.1.3" xref="alg3.l1.m13.1.1.3.cmml"><mi id="alg3.l1.m13.1.1.3.2" xref="alg3.l1.m13.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m13.1.1.3.1" xref="alg3.l1.m13.1.1.3.1.cmml">​</mo><mi id="alg3.l1.m13.1.1.3.3" xref="alg3.l1.m13.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m13.1b"><apply id="alg3.l1.m13.1.1.cmml" xref="alg3.l1.m13.1.1"><csymbol cd="ambiguous" id="alg3.l1.m13.1.1.1.cmml" xref="alg3.l1.m13.1.1">subscript</csymbol><ci id="alg3.l1.m13.1.1.2.cmml" xref="alg3.l1.m13.1.1.2">𝑛</ci><apply id="alg3.l1.m13.1.1.3.cmml" xref="alg3.l1.m13.1.1.3"><times id="alg3.l1.m13.1.1.3.1.cmml" xref="alg3.l1.m13.1.1.3.1"></times><ci id="alg3.l1.m13.1.1.3.2.cmml" xref="alg3.l1.m13.1.1.3.2">𝑐</ci><ci id="alg3.l1.m13.1.1.3.3.cmml" xref="alg3.l1.m13.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m13.1c">n_{ci}</annotation></semantics></math> is the number of clips in <math id="alg3.l1.m14.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg3.l1.m14.1a"><mi id="alg3.l1.m14.1.1" xref="alg3.l1.m14.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m14.1b"><ci id="alg3.l1.m14.1.1.cmml" xref="alg3.l1.m14.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m14.1c">i</annotation></semantics></math>th video of class <math id="alg3.l1.m15.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg3.l1.m15.1a"><mi id="alg3.l1.m15.1.1" xref="alg3.l1.m15.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m15.1b"><ci id="alg3.l1.m15.1.1.cmml" xref="alg3.l1.m15.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m15.1c">c</annotation></semantics></math>, <math id="alg3.l1.m16.1" class="ltx_Math" alttext="x_{cij}" display="inline"><semantics id="alg3.l1.m16.1a"><msub id="alg3.l1.m16.1.1" xref="alg3.l1.m16.1.1.cmml"><mi id="alg3.l1.m16.1.1.2" xref="alg3.l1.m16.1.1.2.cmml">x</mi><mrow id="alg3.l1.m16.1.1.3" xref="alg3.l1.m16.1.1.3.cmml"><mi id="alg3.l1.m16.1.1.3.2" xref="alg3.l1.m16.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m16.1.1.3.1" xref="alg3.l1.m16.1.1.3.1.cmml">​</mo><mi id="alg3.l1.m16.1.1.3.3" xref="alg3.l1.m16.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m16.1.1.3.1a" xref="alg3.l1.m16.1.1.3.1.cmml">​</mo><mi id="alg3.l1.m16.1.1.3.4" xref="alg3.l1.m16.1.1.3.4.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m16.1b"><apply id="alg3.l1.m16.1.1.cmml" xref="alg3.l1.m16.1.1"><csymbol cd="ambiguous" id="alg3.l1.m16.1.1.1.cmml" xref="alg3.l1.m16.1.1">subscript</csymbol><ci id="alg3.l1.m16.1.1.2.cmml" xref="alg3.l1.m16.1.1.2">𝑥</ci><apply id="alg3.l1.m16.1.1.3.cmml" xref="alg3.l1.m16.1.1.3"><times id="alg3.l1.m16.1.1.3.1.cmml" xref="alg3.l1.m16.1.1.3.1"></times><ci id="alg3.l1.m16.1.1.3.2.cmml" xref="alg3.l1.m16.1.1.3.2">𝑐</ci><ci id="alg3.l1.m16.1.1.3.3.cmml" xref="alg3.l1.m16.1.1.3.3">𝑖</ci><ci id="alg3.l1.m16.1.1.3.4.cmml" xref="alg3.l1.m16.1.1.3.4">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m16.1c">x_{cij}</annotation></semantics></math> is the <math id="alg3.l1.m17.1" class="ltx_Math" alttext="j" display="inline"><semantics id="alg3.l1.m17.1a"><mi id="alg3.l1.m17.1.1" xref="alg3.l1.m17.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m17.1b"><ci id="alg3.l1.m17.1.1.cmml" xref="alg3.l1.m17.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m17.1c">j</annotation></semantics></math>th clip from video <math id="alg3.l1.m18.1" class="ltx_Math" alttext="V_{ci}" display="inline"><semantics id="alg3.l1.m18.1a"><msub id="alg3.l1.m18.1.1" xref="alg3.l1.m18.1.1.cmml"><mi id="alg3.l1.m18.1.1.2" xref="alg3.l1.m18.1.1.2.cmml">V</mi><mrow id="alg3.l1.m18.1.1.3" xref="alg3.l1.m18.1.1.3.cmml"><mi id="alg3.l1.m18.1.1.3.2" xref="alg3.l1.m18.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m18.1.1.3.1" xref="alg3.l1.m18.1.1.3.1.cmml">​</mo><mi id="alg3.l1.m18.1.1.3.3" xref="alg3.l1.m18.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m18.1b"><apply id="alg3.l1.m18.1.1.cmml" xref="alg3.l1.m18.1.1"><csymbol cd="ambiguous" id="alg3.l1.m18.1.1.1.cmml" xref="alg3.l1.m18.1.1">subscript</csymbol><ci id="alg3.l1.m18.1.1.2.cmml" xref="alg3.l1.m18.1.1.2">𝑉</ci><apply id="alg3.l1.m18.1.1.3.cmml" xref="alg3.l1.m18.1.1.3"><times id="alg3.l1.m18.1.1.3.1.cmml" xref="alg3.l1.m18.1.1.3.1"></times><ci id="alg3.l1.m18.1.1.3.2.cmml" xref="alg3.l1.m18.1.1.3.2">𝑐</ci><ci id="alg3.l1.m18.1.1.3.3.cmml" xref="alg3.l1.m18.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m18.1c">V_{ci}</annotation></semantics></math>

</div>
<div id="alg3.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><span id="alg3.l2.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">batch_size</span>: size of context split

</div>
<div id="alg3.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><span id="alg3.l3.1" class="ltx_text ltx_font_typewriter">choose(<math id="alg3.l3.1.m1.2" class="ltx_Math" alttext="n,m" display="inline"><semantics id="alg3.l3.1.m1.2a"><mrow id="alg3.l3.1.m1.2.3.2" xref="alg3.l3.1.m1.2.3.1.cmml"><mi id="alg3.l3.1.m1.1.1" xref="alg3.l3.1.m1.1.1.cmml">n</mi><mo id="alg3.l3.1.m1.2.3.2.1" xref="alg3.l3.1.m1.2.3.1.cmml">,</mo><mi id="alg3.l3.1.m1.2.2" xref="alg3.l3.1.m1.2.2.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l3.1.m1.2b"><list id="alg3.l3.1.m1.2.3.1.cmml" xref="alg3.l3.1.m1.2.3.2"><ci id="alg3.l3.1.m1.1.1.cmml" xref="alg3.l3.1.m1.1.1">𝑛</ci><ci id="alg3.l3.1.m1.2.2.cmml" xref="alg3.l3.1.m1.2.2">𝑚</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.1.m1.2c">n,m</annotation></semantics></math>)</span> <math id="alg3.l3.m1.1" class="ltx_Math" alttext="\equiv" display="inline"><semantics id="alg3.l3.m1.1a"><mo id="alg3.l3.m1.1.1" xref="alg3.l3.m1.1.1.cmml">≡</mo><annotation-xml encoding="MathML-Content" id="alg3.l3.m1.1b"><equivalent id="alg3.l3.m1.1.1.cmml" xref="alg3.l3.m1.1.1"></equivalent></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m1.1c">\equiv</annotation></semantics></math> function that randomly samples <math id="alg3.l3.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg3.l3.m2.1a"><mi id="alg3.l3.m2.1.1" xref="alg3.l3.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg3.l3.m2.1b"><ci id="alg3.l3.m2.1.1.cmml" xref="alg3.l3.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m2.1c">m</annotation></semantics></math> different integers from a set <math id="alg3.l3.m3.1" class="ltx_Math" alttext="\{i\}_{i=1}^{n}" display="inline"><semantics id="alg3.l3.m3.1a"><msubsup id="alg3.l3.m3.1.2" xref="alg3.l3.m3.1.2.cmml"><mrow id="alg3.l3.m3.1.2.2.2.2" xref="alg3.l3.m3.1.2.2.2.1.cmml"><mo stretchy="false" id="alg3.l3.m3.1.2.2.2.2.1" xref="alg3.l3.m3.1.2.2.2.1.cmml">{</mo><mi id="alg3.l3.m3.1.1" xref="alg3.l3.m3.1.1.cmml">i</mi><mo stretchy="false" id="alg3.l3.m3.1.2.2.2.2.2" xref="alg3.l3.m3.1.2.2.2.1.cmml">}</mo></mrow><mrow id="alg3.l3.m3.1.2.2.3" xref="alg3.l3.m3.1.2.2.3.cmml"><mi id="alg3.l3.m3.1.2.2.3.2" xref="alg3.l3.m3.1.2.2.3.2.cmml">i</mi><mo id="alg3.l3.m3.1.2.2.3.1" xref="alg3.l3.m3.1.2.2.3.1.cmml">=</mo><mn id="alg3.l3.m3.1.2.2.3.3" xref="alg3.l3.m3.1.2.2.3.3.cmml">1</mn></mrow><mi id="alg3.l3.m3.1.2.3" xref="alg3.l3.m3.1.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg3.l3.m3.1b"><apply id="alg3.l3.m3.1.2.cmml" xref="alg3.l3.m3.1.2"><csymbol cd="ambiguous" id="alg3.l3.m3.1.2.1.cmml" xref="alg3.l3.m3.1.2">superscript</csymbol><apply id="alg3.l3.m3.1.2.2.cmml" xref="alg3.l3.m3.1.2"><csymbol cd="ambiguous" id="alg3.l3.m3.1.2.2.1.cmml" xref="alg3.l3.m3.1.2">subscript</csymbol><set id="alg3.l3.m3.1.2.2.2.1.cmml" xref="alg3.l3.m3.1.2.2.2.2"><ci id="alg3.l3.m3.1.1.cmml" xref="alg3.l3.m3.1.1">𝑖</ci></set><apply id="alg3.l3.m3.1.2.2.3.cmml" xref="alg3.l3.m3.1.2.2.3"><eq id="alg3.l3.m3.1.2.2.3.1.cmml" xref="alg3.l3.m3.1.2.2.3.1"></eq><ci id="alg3.l3.m3.1.2.2.3.2.cmml" xref="alg3.l3.m3.1.2.2.3.2">𝑖</ci><cn type="integer" id="alg3.l3.m3.1.2.2.3.3.cmml" xref="alg3.l3.m3.1.2.2.3.3">1</cn></apply></apply><ci id="alg3.l3.m3.1.2.3.cmml" xref="alg3.l3.m3.1.2.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m3.1c">\{i\}_{i=1}^{n}</annotation></semantics></math>

</div>
<div id="alg3.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span><span id="alg3.l4.1" class="ltx_text ltx_font_typewriter">select_by_index</span>(<math id="alg3.l4.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="alg3.l4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.1b"><ci id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.1c">\mathcal{D}</annotation></semantics></math>, <math id="alg3.l4.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg3.l4.m2.1a"><mi id="alg3.l4.m2.1.1" xref="alg3.l4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.l4.m2.1b"><ci id="alg3.l4.m2.1.1.cmml" xref="alg3.l4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m2.1c">i</annotation></semantics></math>) <math id="alg3.l4.m3.1" class="ltx_Math" alttext="\equiv" display="inline"><semantics id="alg3.l4.m3.1a"><mo id="alg3.l4.m3.1.1" xref="alg3.l4.m3.1.1.cmml">≡</mo><annotation-xml encoding="MathML-Content" id="alg3.l4.m3.1b"><equivalent id="alg3.l4.m3.1.1.cmml" xref="alg3.l4.m3.1.1"></equivalent></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m3.1c">\equiv</annotation></semantics></math> function that extracts samples of indices <math id="alg3.l4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg3.l4.m4.1a"><mi id="alg3.l4.m4.1.1" xref="alg3.l4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.l4.m4.1b"><ci id="alg3.l4.m4.1.1.cmml" xref="alg3.l4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m4.1c">i</annotation></semantics></math> from a dataset <math id="alg3.l4.m5.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="alg3.l4.m5.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.l4.m5.1.1" xref="alg3.l4.m5.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg3.l4.m5.1b"><ci id="alg3.l4.m5.1.1.cmml" xref="alg3.l4.m5.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m5.1c">\mathcal{D}</annotation></semantics></math>

</div>
<div id="alg3.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span><span id="alg3.l5.1" class="ltx_text ltx_font_typewriter">diff</span>(<math id="alg3.l5.m1.2" class="ltx_Math" alttext="a,b" display="inline"><semantics id="alg3.l5.m1.2a"><mrow id="alg3.l5.m1.2.3.2" xref="alg3.l5.m1.2.3.1.cmml"><mi id="alg3.l5.m1.1.1" xref="alg3.l5.m1.1.1.cmml">a</mi><mo id="alg3.l5.m1.2.3.2.1" xref="alg3.l5.m1.2.3.1.cmml">,</mo><mi id="alg3.l5.m1.2.2" xref="alg3.l5.m1.2.2.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.2b"><list id="alg3.l5.m1.2.3.1.cmml" xref="alg3.l5.m1.2.3.2"><ci id="alg3.l5.m1.1.1.cmml" xref="alg3.l5.m1.1.1">𝑎</ci><ci id="alg3.l5.m1.2.2.cmml" xref="alg3.l5.m1.2.2">𝑏</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.2c">a,b</annotation></semantics></math>) <math id="alg3.l5.m2.1" class="ltx_Math" alttext="\equiv" display="inline"><semantics id="alg3.l5.m2.1a"><mo id="alg3.l5.m2.1.1" xref="alg3.l5.m2.1.1.cmml">≡</mo><annotation-xml encoding="MathML-Content" id="alg3.l5.m2.1b"><equivalent id="alg3.l5.m2.1.1.cmml" xref="alg3.l5.m2.1.1"></equivalent></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m2.1c">\equiv</annotation></semantics></math> function that computes set difference between sets <math id="alg3.l5.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="alg3.l5.m3.1a"><mi id="alg3.l5.m3.1.1" xref="alg3.l5.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="alg3.l5.m3.1b"><ci id="alg3.l5.m3.1.1.cmml" xref="alg3.l5.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m3.1c">a</annotation></semantics></math> and <math id="alg3.l5.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="alg3.l5.m4.1a"><mi id="alg3.l5.m4.1.1" xref="alg3.l5.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="alg3.l5.m4.1b"><ci id="alg3.l5.m4.1.1.cmml" xref="alg3.l5.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m4.1c">b</annotation></semantics></math>

</div>
<div id="alg3.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span><span id="alg3.l6.1" class="ltx_text ltx_font_typewriter">range</span>(<math id="alg3.l6.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg3.l6.m1.1a"><mi id="alg3.l6.m1.1.1" xref="alg3.l6.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg3.l6.m1.1b"><ci id="alg3.l6.m1.1.1.cmml" xref="alg3.l6.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m1.1c">n</annotation></semantics></math>) <math id="alg3.l6.m2.1" class="ltx_Math" alttext="\equiv" display="inline"><semantics id="alg3.l6.m2.1a"><mo id="alg3.l6.m2.1.1" xref="alg3.l6.m2.1.1.cmml">≡</mo><annotation-xml encoding="MathML-Content" id="alg3.l6.m2.1b"><equivalent id="alg3.l6.m2.1.1.cmml" xref="alg3.l6.m2.1.1"></equivalent></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m2.1c">\equiv</annotation></semantics></math> function that returns a set of values <math id="alg3.l6.m3.1" class="ltx_Math" alttext="\{i\}_{i=1}^{n}" display="inline"><semantics id="alg3.l6.m3.1a"><msubsup id="alg3.l6.m3.1.2" xref="alg3.l6.m3.1.2.cmml"><mrow id="alg3.l6.m3.1.2.2.2.2" xref="alg3.l6.m3.1.2.2.2.1.cmml"><mo stretchy="false" id="alg3.l6.m3.1.2.2.2.2.1" xref="alg3.l6.m3.1.2.2.2.1.cmml">{</mo><mi id="alg3.l6.m3.1.1" xref="alg3.l6.m3.1.1.cmml">i</mi><mo stretchy="false" id="alg3.l6.m3.1.2.2.2.2.2" xref="alg3.l6.m3.1.2.2.2.1.cmml">}</mo></mrow><mrow id="alg3.l6.m3.1.2.2.3" xref="alg3.l6.m3.1.2.2.3.cmml"><mi id="alg3.l6.m3.1.2.2.3.2" xref="alg3.l6.m3.1.2.2.3.2.cmml">i</mi><mo id="alg3.l6.m3.1.2.2.3.1" xref="alg3.l6.m3.1.2.2.3.1.cmml">=</mo><mn id="alg3.l6.m3.1.2.2.3.3" xref="alg3.l6.m3.1.2.2.3.3.cmml">1</mn></mrow><mi id="alg3.l6.m3.1.2.3" xref="alg3.l6.m3.1.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg3.l6.m3.1b"><apply id="alg3.l6.m3.1.2.cmml" xref="alg3.l6.m3.1.2"><csymbol cd="ambiguous" id="alg3.l6.m3.1.2.1.cmml" xref="alg3.l6.m3.1.2">superscript</csymbol><apply id="alg3.l6.m3.1.2.2.cmml" xref="alg3.l6.m3.1.2"><csymbol cd="ambiguous" id="alg3.l6.m3.1.2.2.1.cmml" xref="alg3.l6.m3.1.2">subscript</csymbol><set id="alg3.l6.m3.1.2.2.2.1.cmml" xref="alg3.l6.m3.1.2.2.2.2"><ci id="alg3.l6.m3.1.1.cmml" xref="alg3.l6.m3.1.1">𝑖</ci></set><apply id="alg3.l6.m3.1.2.2.3.cmml" xref="alg3.l6.m3.1.2.2.3"><eq id="alg3.l6.m3.1.2.2.3.1.cmml" xref="alg3.l6.m3.1.2.2.3.1"></eq><ci id="alg3.l6.m3.1.2.2.3.2.cmml" xref="alg3.l6.m3.1.2.2.3.2">𝑖</ci><cn type="integer" id="alg3.l6.m3.1.2.2.3.3.cmml" xref="alg3.l6.m3.1.2.2.3.3">1</cn></apply></apply><ci id="alg3.l6.m3.1.2.3.cmml" xref="alg3.l6.m3.1.2.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m3.1c">\{i\}_{i=1}^{n}</annotation></semantics></math>

</div>
<div id="alg3.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span><span id="alg3.l7.1" class="ltx_text ltx_font_bold">procedure</span> <span id="alg3.l7.2" class="ltx_text ltx_font_smallcaps">split_orbit_task</span>(<math id="alg3.l7.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="alg3.l7.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.l7.m1.1.1" xref="alg3.l7.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg3.l7.m1.1b"><ci id="alg3.l7.m1.1.1.cmml" xref="alg3.l7.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m1.1c">\mathcal{D}</annotation></semantics></math>)

</div>
<div id="alg3.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math id="alg3.l8.m1.1" class="ltx_Math" alttext="\mathcal{D}_{train}\leftarrow[\,]" display="inline"><semantics id="alg3.l8.m1.1a"><mrow id="alg3.l8.m1.1.1" xref="alg3.l8.m1.1.1.cmml"><msub id="alg3.l8.m1.1.1.2" xref="alg3.l8.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l8.m1.1.1.2.2" xref="alg3.l8.m1.1.1.2.2.cmml">𝒟</mi><mrow id="alg3.l8.m1.1.1.2.3" xref="alg3.l8.m1.1.1.2.3.cmml"><mi id="alg3.l8.m1.1.1.2.3.2" xref="alg3.l8.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l8.m1.1.1.2.3.1" xref="alg3.l8.m1.1.1.2.3.1.cmml">​</mo><mi id="alg3.l8.m1.1.1.2.3.3" xref="alg3.l8.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg3.l8.m1.1.1.2.3.1a" xref="alg3.l8.m1.1.1.2.3.1.cmml">​</mo><mi id="alg3.l8.m1.1.1.2.3.4" xref="alg3.l8.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg3.l8.m1.1.1.2.3.1b" xref="alg3.l8.m1.1.1.2.3.1.cmml">​</mo><mi id="alg3.l8.m1.1.1.2.3.5" xref="alg3.l8.m1.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg3.l8.m1.1.1.2.3.1c" xref="alg3.l8.m1.1.1.2.3.1.cmml">​</mo><mi id="alg3.l8.m1.1.1.2.3.6" xref="alg3.l8.m1.1.1.2.3.6.cmml">n</mi></mrow></msub><mo stretchy="false" id="alg3.l8.m1.1.1.1" xref="alg3.l8.m1.1.1.1.cmml">←</mo><mrow id="alg3.l8.m1.1.1.3.2" xref="alg3.l8.m1.1.1.cmml"><mo rspace="0.170em" stretchy="false" id="alg3.l8.m1.1.1.3.2.1" xref="alg3.l8.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="alg3.l8.m1.1.1.3.2.2" xref="alg3.l8.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l8.m1.1b"><apply id="alg3.l8.m1.1.1.cmml" xref="alg3.l8.m1.1.1"><ci id="alg3.l8.m1.1.1.1.cmml" xref="alg3.l8.m1.1.1.1">←</ci><apply id="alg3.l8.m1.1.1.2.cmml" xref="alg3.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l8.m1.1.1.2.1.cmml" xref="alg3.l8.m1.1.1.2">subscript</csymbol><ci id="alg3.l8.m1.1.1.2.2.cmml" xref="alg3.l8.m1.1.1.2.2">𝒟</ci><apply id="alg3.l8.m1.1.1.2.3.cmml" xref="alg3.l8.m1.1.1.2.3"><times id="alg3.l8.m1.1.1.2.3.1.cmml" xref="alg3.l8.m1.1.1.2.3.1"></times><ci id="alg3.l8.m1.1.1.2.3.2.cmml" xref="alg3.l8.m1.1.1.2.3.2">𝑡</ci><ci id="alg3.l8.m1.1.1.2.3.3.cmml" xref="alg3.l8.m1.1.1.2.3.3">𝑟</ci><ci id="alg3.l8.m1.1.1.2.3.4.cmml" xref="alg3.l8.m1.1.1.2.3.4">𝑎</ci><ci id="alg3.l8.m1.1.1.2.3.5.cmml" xref="alg3.l8.m1.1.1.2.3.5">𝑖</ci><ci id="alg3.l8.m1.1.1.2.3.6.cmml" xref="alg3.l8.m1.1.1.2.3.6">𝑛</ci></apply></apply><list id="alg3.l8.m1.1.1.3.1.cmml" xref="alg3.l8.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l8.m1.1c">\mathcal{D}_{train}\leftarrow[\,]</annotation></semantics></math> 
</div>
<div id="alg3.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math id="alg3.l9.m1.1" class="ltx_Math" alttext="\mathcal{D}_{test}\leftarrow[\,]" display="inline"><semantics id="alg3.l9.m1.1a"><mrow id="alg3.l9.m1.1.1" xref="alg3.l9.m1.1.1.cmml"><msub id="alg3.l9.m1.1.1.2" xref="alg3.l9.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l9.m1.1.1.2.2" xref="alg3.l9.m1.1.1.2.2.cmml">𝒟</mi><mrow id="alg3.l9.m1.1.1.2.3" xref="alg3.l9.m1.1.1.2.3.cmml"><mi id="alg3.l9.m1.1.1.2.3.2" xref="alg3.l9.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.1.1.2.3.1" xref="alg3.l9.m1.1.1.2.3.1.cmml">​</mo><mi id="alg3.l9.m1.1.1.2.3.3" xref="alg3.l9.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.1.1.2.3.1a" xref="alg3.l9.m1.1.1.2.3.1.cmml">​</mo><mi id="alg3.l9.m1.1.1.2.3.4" xref="alg3.l9.m1.1.1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.1.1.2.3.1b" xref="alg3.l9.m1.1.1.2.3.1.cmml">​</mo><mi id="alg3.l9.m1.1.1.2.3.5" xref="alg3.l9.m1.1.1.2.3.5.cmml">t</mi></mrow></msub><mo stretchy="false" id="alg3.l9.m1.1.1.1" xref="alg3.l9.m1.1.1.1.cmml">←</mo><mrow id="alg3.l9.m1.1.1.3.2" xref="alg3.l9.m1.1.1.cmml"><mo rspace="0.170em" stretchy="false" id="alg3.l9.m1.1.1.3.2.1" xref="alg3.l9.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="alg3.l9.m1.1.1.3.2.2" xref="alg3.l9.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l9.m1.1b"><apply id="alg3.l9.m1.1.1.cmml" xref="alg3.l9.m1.1.1"><ci id="alg3.l9.m1.1.1.1.cmml" xref="alg3.l9.m1.1.1.1">←</ci><apply id="alg3.l9.m1.1.1.2.cmml" xref="alg3.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l9.m1.1.1.2.1.cmml" xref="alg3.l9.m1.1.1.2">subscript</csymbol><ci id="alg3.l9.m1.1.1.2.2.cmml" xref="alg3.l9.m1.1.1.2.2">𝒟</ci><apply id="alg3.l9.m1.1.1.2.3.cmml" xref="alg3.l9.m1.1.1.2.3"><times id="alg3.l9.m1.1.1.2.3.1.cmml" xref="alg3.l9.m1.1.1.2.3.1"></times><ci id="alg3.l9.m1.1.1.2.3.2.cmml" xref="alg3.l9.m1.1.1.2.3.2">𝑡</ci><ci id="alg3.l9.m1.1.1.2.3.3.cmml" xref="alg3.l9.m1.1.1.2.3.3">𝑒</ci><ci id="alg3.l9.m1.1.1.2.3.4.cmml" xref="alg3.l9.m1.1.1.2.3.4">𝑠</ci><ci id="alg3.l9.m1.1.1.2.3.5.cmml" xref="alg3.l9.m1.1.1.2.3.5">𝑡</ci></apply></apply><list id="alg3.l9.m1.1.1.3.1.cmml" xref="alg3.l9.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.m1.1c">\mathcal{D}_{test}\leftarrow[\,]</annotation></semantics></math> 
</div>
<div id="alg3.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <math id="alg3.l10.m1.1" class="ltx_Math" alttext="\texttt{num\_clips}\leftarrow\texttt{floor}\left(\texttt{batch\_size}/C\right)" display="inline"><semantics id="alg3.l10.m1.1a"><mrow id="alg3.l10.m1.1.1" xref="alg3.l10.m1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l10.m1.1.1.3" xref="alg3.l10.m1.1.1.3a.cmml">num_clips</mtext><mo stretchy="false" id="alg3.l10.m1.1.1.2" xref="alg3.l10.m1.1.1.2.cmml">←</mo><mrow id="alg3.l10.m1.1.1.1" xref="alg3.l10.m1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l10.m1.1.1.1.3" xref="alg3.l10.m1.1.1.1.3a.cmml">floor</mtext><mo lspace="0em" rspace="0em" id="alg3.l10.m1.1.1.1.2" xref="alg3.l10.m1.1.1.1.2.cmml">​</mo><mrow id="alg3.l10.m1.1.1.1.1.1" xref="alg3.l10.m1.1.1.1.1.1.1.cmml"><mo id="alg3.l10.m1.1.1.1.1.1.2" xref="alg3.l10.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l10.m1.1.1.1.1.1.1" xref="alg3.l10.m1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l10.m1.1.1.1.1.1.1.2" xref="alg3.l10.m1.1.1.1.1.1.1.2a.cmml">batch_size</mtext><mo id="alg3.l10.m1.1.1.1.1.1.1.1" xref="alg3.l10.m1.1.1.1.1.1.1.1.cmml">/</mo><mi id="alg3.l10.m1.1.1.1.1.1.1.3" xref="alg3.l10.m1.1.1.1.1.1.1.3.cmml">C</mi></mrow><mo id="alg3.l10.m1.1.1.1.1.1.3" xref="alg3.l10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l10.m1.1b"><apply id="alg3.l10.m1.1.1.cmml" xref="alg3.l10.m1.1.1"><ci id="alg3.l10.m1.1.1.2.cmml" xref="alg3.l10.m1.1.1.2">←</ci><ci id="alg3.l10.m1.1.1.3a.cmml" xref="alg3.l10.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l10.m1.1.1.3.cmml" xref="alg3.l10.m1.1.1.3">num_clips</mtext></ci><apply id="alg3.l10.m1.1.1.1.cmml" xref="alg3.l10.m1.1.1.1"><times id="alg3.l10.m1.1.1.1.2.cmml" xref="alg3.l10.m1.1.1.1.2"></times><ci id="alg3.l10.m1.1.1.1.3a.cmml" xref="alg3.l10.m1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l10.m1.1.1.1.3.cmml" xref="alg3.l10.m1.1.1.1.3">floor</mtext></ci><apply id="alg3.l10.m1.1.1.1.1.1.1.cmml" xref="alg3.l10.m1.1.1.1.1.1"><divide id="alg3.l10.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l10.m1.1.1.1.1.1.1.1"></divide><ci id="alg3.l10.m1.1.1.1.1.1.1.2a.cmml" xref="alg3.l10.m1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="alg3.l10.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l10.m1.1.1.1.1.1.1.2">batch_size</mtext></ci><ci id="alg3.l10.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l10.m1.1.1.1.1.1.1.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.m1.1c">\texttt{num\_clips}\leftarrow\texttt{floor}\left(\texttt{batch\_size}/C\right)</annotation></semantics></math> 
</div>
<div id="alg3.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <span id="alg3.l11.1" class="ltx_text ltx_font_bold">for</span> <math id="alg3.l11.m1.1" class="ltx_Math" alttext="c\leftarrow 1" display="inline"><semantics id="alg3.l11.m1.1a"><mrow id="alg3.l11.m1.1.1" xref="alg3.l11.m1.1.1.cmml"><mi id="alg3.l11.m1.1.1.2" xref="alg3.l11.m1.1.1.2.cmml">c</mi><mo stretchy="false" id="alg3.l11.m1.1.1.1" xref="alg3.l11.m1.1.1.1.cmml">←</mo><mn id="alg3.l11.m1.1.1.3" xref="alg3.l11.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.l11.m1.1b"><apply id="alg3.l11.m1.1.1.cmml" xref="alg3.l11.m1.1.1"><ci id="alg3.l11.m1.1.1.1.cmml" xref="alg3.l11.m1.1.1.1">←</ci><ci id="alg3.l11.m1.1.1.2.cmml" xref="alg3.l11.m1.1.1.2">𝑐</ci><cn type="integer" id="alg3.l11.m1.1.1.3.cmml" xref="alg3.l11.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.m1.1c">c\leftarrow 1</annotation></semantics></math> to <math id="alg3.l11.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg3.l11.m2.1a"><mi id="alg3.l11.m2.1.1" xref="alg3.l11.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg3.l11.m2.1b"><ci id="alg3.l11.m2.1.1.cmml" xref="alg3.l11.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.m2.1c">C</annotation></semantics></math> <span id="alg3.l11.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg3.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>         <math id="alg3.l12.m1.1" class="ltx_Math" alttext="\texttt{num\_context\_videos}\leftarrow\texttt{ceil}\left(n_{c}/2\right)" display="inline"><semantics id="alg3.l12.m1.1a"><mrow id="alg3.l12.m1.1.1" xref="alg3.l12.m1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l12.m1.1.1.3" xref="alg3.l12.m1.1.1.3a.cmml">num_context_videos</mtext><mo stretchy="false" id="alg3.l12.m1.1.1.2" xref="alg3.l12.m1.1.1.2.cmml">←</mo><mrow id="alg3.l12.m1.1.1.1" xref="alg3.l12.m1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l12.m1.1.1.1.3" xref="alg3.l12.m1.1.1.1.3a.cmml">ceil</mtext><mo lspace="0em" rspace="0em" id="alg3.l12.m1.1.1.1.2" xref="alg3.l12.m1.1.1.1.2.cmml">​</mo><mrow id="alg3.l12.m1.1.1.1.1.1" xref="alg3.l12.m1.1.1.1.1.1.1.cmml"><mo id="alg3.l12.m1.1.1.1.1.1.2" xref="alg3.l12.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l12.m1.1.1.1.1.1.1" xref="alg3.l12.m1.1.1.1.1.1.1.cmml"><msub id="alg3.l12.m1.1.1.1.1.1.1.2" xref="alg3.l12.m1.1.1.1.1.1.1.2.cmml"><mi id="alg3.l12.m1.1.1.1.1.1.1.2.2" xref="alg3.l12.m1.1.1.1.1.1.1.2.2.cmml">n</mi><mi id="alg3.l12.m1.1.1.1.1.1.1.2.3" xref="alg3.l12.m1.1.1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="alg3.l12.m1.1.1.1.1.1.1.1" xref="alg3.l12.m1.1.1.1.1.1.1.1.cmml">/</mo><mn id="alg3.l12.m1.1.1.1.1.1.1.3" xref="alg3.l12.m1.1.1.1.1.1.1.3.cmml">2</mn></mrow><mo id="alg3.l12.m1.1.1.1.1.1.3" xref="alg3.l12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l12.m1.1b"><apply id="alg3.l12.m1.1.1.cmml" xref="alg3.l12.m1.1.1"><ci id="alg3.l12.m1.1.1.2.cmml" xref="alg3.l12.m1.1.1.2">←</ci><ci id="alg3.l12.m1.1.1.3a.cmml" xref="alg3.l12.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l12.m1.1.1.3.cmml" xref="alg3.l12.m1.1.1.3">num_context_videos</mtext></ci><apply id="alg3.l12.m1.1.1.1.cmml" xref="alg3.l12.m1.1.1.1"><times id="alg3.l12.m1.1.1.1.2.cmml" xref="alg3.l12.m1.1.1.1.2"></times><ci id="alg3.l12.m1.1.1.1.3a.cmml" xref="alg3.l12.m1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l12.m1.1.1.1.3.cmml" xref="alg3.l12.m1.1.1.1.3">ceil</mtext></ci><apply id="alg3.l12.m1.1.1.1.1.1.1.cmml" xref="alg3.l12.m1.1.1.1.1.1"><divide id="alg3.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.1"></divide><apply id="alg3.l12.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg3.l12.m1.1.1.1.1.1.1.2.1.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg3.l12.m1.1.1.1.1.1.1.2.2.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.2.2">𝑛</ci><ci id="alg3.l12.m1.1.1.1.1.1.1.2.3.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.2.3">𝑐</ci></apply><cn type="integer" id="alg3.l12.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l12.m1.1c">\texttt{num\_context\_videos}\leftarrow\texttt{ceil}\left(n_{c}/2\right)</annotation></semantics></math> 
</div>
<div id="alg3.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>         <math id="alg3.l13.m1.2" class="ltx_Math" alttext="\texttt{context\_videos\_indices}\leftarrow\texttt{choose}(n_{c},\texttt{num\_context\_videos})" display="inline"><semantics id="alg3.l13.m1.2a"><mrow id="alg3.l13.m1.2.2" xref="alg3.l13.m1.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l13.m1.2.2.3" xref="alg3.l13.m1.2.2.3a.cmml">context_videos_indices</mtext><mo stretchy="false" id="alg3.l13.m1.2.2.2" xref="alg3.l13.m1.2.2.2.cmml">←</mo><mrow id="alg3.l13.m1.2.2.1" xref="alg3.l13.m1.2.2.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l13.m1.2.2.1.3" xref="alg3.l13.m1.2.2.1.3a.cmml">choose</mtext><mo lspace="0em" rspace="0em" id="alg3.l13.m1.2.2.1.2" xref="alg3.l13.m1.2.2.1.2.cmml">​</mo><mrow id="alg3.l13.m1.2.2.1.1.1" xref="alg3.l13.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg3.l13.m1.2.2.1.1.1.2" xref="alg3.l13.m1.2.2.1.1.2.cmml">(</mo><msub id="alg3.l13.m1.2.2.1.1.1.1" xref="alg3.l13.m1.2.2.1.1.1.1.cmml"><mi id="alg3.l13.m1.2.2.1.1.1.1.2" xref="alg3.l13.m1.2.2.1.1.1.1.2.cmml">n</mi><mi id="alg3.l13.m1.2.2.1.1.1.1.3" xref="alg3.l13.m1.2.2.1.1.1.1.3.cmml">c</mi></msub><mo id="alg3.l13.m1.2.2.1.1.1.3" xref="alg3.l13.m1.2.2.1.1.2.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg3.l13.m1.1.1" xref="alg3.l13.m1.1.1a.cmml">num_context_videos</mtext><mo stretchy="false" id="alg3.l13.m1.2.2.1.1.1.4" xref="alg3.l13.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l13.m1.2b"><apply id="alg3.l13.m1.2.2.cmml" xref="alg3.l13.m1.2.2"><ci id="alg3.l13.m1.2.2.2.cmml" xref="alg3.l13.m1.2.2.2">←</ci><ci id="alg3.l13.m1.2.2.3a.cmml" xref="alg3.l13.m1.2.2.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l13.m1.2.2.3.cmml" xref="alg3.l13.m1.2.2.3">context_videos_indices</mtext></ci><apply id="alg3.l13.m1.2.2.1.cmml" xref="alg3.l13.m1.2.2.1"><times id="alg3.l13.m1.2.2.1.2.cmml" xref="alg3.l13.m1.2.2.1.2"></times><ci id="alg3.l13.m1.2.2.1.3a.cmml" xref="alg3.l13.m1.2.2.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l13.m1.2.2.1.3.cmml" xref="alg3.l13.m1.2.2.1.3">choose</mtext></ci><interval closure="open" id="alg3.l13.m1.2.2.1.1.2.cmml" xref="alg3.l13.m1.2.2.1.1.1"><apply id="alg3.l13.m1.2.2.1.1.1.1.cmml" xref="alg3.l13.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l13.m1.2.2.1.1.1.1.1.cmml" xref="alg3.l13.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg3.l13.m1.2.2.1.1.1.1.2.cmml" xref="alg3.l13.m1.2.2.1.1.1.1.2">𝑛</ci><ci id="alg3.l13.m1.2.2.1.1.1.1.3.cmml" xref="alg3.l13.m1.2.2.1.1.1.1.3">𝑐</ci></apply><ci id="alg3.l13.m1.1.1a.cmml" xref="alg3.l13.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg3.l13.m1.1.1.cmml" xref="alg3.l13.m1.1.1">num_context_videos</mtext></ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.m1.2c">\texttt{context\_videos\_indices}\leftarrow\texttt{choose}(n_{c},\texttt{num\_context\_videos})</annotation></semantics></math> 
</div>
<div id="alg3.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>         <math id="alg3.l14.m1.1" class="ltx_Math" alttext="\texttt{num\_clips\_per\_video}\leftarrow\texttt{floor}\left(\texttt{num\_clips}/\texttt{num\_context\_videos}\right)" display="inline"><semantics id="alg3.l14.m1.1a"><mrow id="alg3.l14.m1.1.1" xref="alg3.l14.m1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l14.m1.1.1.3" xref="alg3.l14.m1.1.1.3a.cmml">num_clips_per_video</mtext><mo stretchy="false" id="alg3.l14.m1.1.1.2" xref="alg3.l14.m1.1.1.2.cmml">←</mo><mrow id="alg3.l14.m1.1.1.1" xref="alg3.l14.m1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l14.m1.1.1.1.3" xref="alg3.l14.m1.1.1.1.3a.cmml">floor</mtext><mo lspace="0em" rspace="0em" id="alg3.l14.m1.1.1.1.2" xref="alg3.l14.m1.1.1.1.2.cmml">​</mo><mrow id="alg3.l14.m1.1.1.1.1.1" xref="alg3.l14.m1.1.1.1.1.1.1.cmml"><mo id="alg3.l14.m1.1.1.1.1.1.2" xref="alg3.l14.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l14.m1.1.1.1.1.1.1" xref="alg3.l14.m1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l14.m1.1.1.1.1.1.1.2" xref="alg3.l14.m1.1.1.1.1.1.1.2a.cmml">num_clips</mtext><mo id="alg3.l14.m1.1.1.1.1.1.1.1" xref="alg3.l14.m1.1.1.1.1.1.1.1.cmml">/</mo><mtext class="ltx_mathvariant_monospace" id="alg3.l14.m1.1.1.1.1.1.1.3" xref="alg3.l14.m1.1.1.1.1.1.1.3a.cmml">num_context_videos</mtext></mrow><mo id="alg3.l14.m1.1.1.1.1.1.3" xref="alg3.l14.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l14.m1.1b"><apply id="alg3.l14.m1.1.1.cmml" xref="alg3.l14.m1.1.1"><ci id="alg3.l14.m1.1.1.2.cmml" xref="alg3.l14.m1.1.1.2">←</ci><ci id="alg3.l14.m1.1.1.3a.cmml" xref="alg3.l14.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l14.m1.1.1.3.cmml" xref="alg3.l14.m1.1.1.3">num_clips_per_video</mtext></ci><apply id="alg3.l14.m1.1.1.1.cmml" xref="alg3.l14.m1.1.1.1"><times id="alg3.l14.m1.1.1.1.2.cmml" xref="alg3.l14.m1.1.1.1.2"></times><ci id="alg3.l14.m1.1.1.1.3a.cmml" xref="alg3.l14.m1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l14.m1.1.1.1.3.cmml" xref="alg3.l14.m1.1.1.1.3">floor</mtext></ci><apply id="alg3.l14.m1.1.1.1.1.1.1.cmml" xref="alg3.l14.m1.1.1.1.1.1"><divide id="alg3.l14.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l14.m1.1.1.1.1.1.1.1"></divide><ci id="alg3.l14.m1.1.1.1.1.1.1.2a.cmml" xref="alg3.l14.m1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="alg3.l14.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l14.m1.1.1.1.1.1.1.2">num_clips</mtext></ci><ci id="alg3.l14.m1.1.1.1.1.1.1.3a.cmml" xref="alg3.l14.m1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l14.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l14.m1.1.1.1.1.1.1.3">num_context_videos</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l14.m1.1c">\texttt{num\_clips\_per\_video}\leftarrow\texttt{floor}\left(\texttt{num\_clips}/\texttt{num\_context\_videos}\right)</annotation></semantics></math> 
</div>
<div id="alg3.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>         <span id="alg3.l15.1" class="ltx_text ltx_font_bold">if</span> <math id="alg3.l15.m1.1" class="ltx_Math" alttext="n_{c}=1" display="inline"><semantics id="alg3.l15.m1.1a"><mrow id="alg3.l15.m1.1.1" xref="alg3.l15.m1.1.1.cmml"><msub id="alg3.l15.m1.1.1.2" xref="alg3.l15.m1.1.1.2.cmml"><mi id="alg3.l15.m1.1.1.2.2" xref="alg3.l15.m1.1.1.2.2.cmml">n</mi><mi id="alg3.l15.m1.1.1.2.3" xref="alg3.l15.m1.1.1.2.3.cmml">c</mi></msub><mo id="alg3.l15.m1.1.1.1" xref="alg3.l15.m1.1.1.1.cmml">=</mo><mn id="alg3.l15.m1.1.1.3" xref="alg3.l15.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.l15.m1.1b"><apply id="alg3.l15.m1.1.1.cmml" xref="alg3.l15.m1.1.1"><eq id="alg3.l15.m1.1.1.1.cmml" xref="alg3.l15.m1.1.1.1"></eq><apply id="alg3.l15.m1.1.1.2.cmml" xref="alg3.l15.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l15.m1.1.1.2.1.cmml" xref="alg3.l15.m1.1.1.2">subscript</csymbol><ci id="alg3.l15.m1.1.1.2.2.cmml" xref="alg3.l15.m1.1.1.2.2">𝑛</ci><ci id="alg3.l15.m1.1.1.2.3.cmml" xref="alg3.l15.m1.1.1.2.3">𝑐</ci></apply><cn type="integer" id="alg3.l15.m1.1.1.3.cmml" xref="alg3.l15.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l15.m1.1c">n_{c}=1</annotation></semantics></math> <span id="alg3.l15.2" class="ltx_text ltx_font_bold">then</span>

</div>
<div id="alg3.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>              <math id="alg3.l16.m1.2" class="ltx_Math" alttext="\texttt{context\_clips\_indices}\leftarrow\texttt{choose}(n_{c1},\texttt{num\_clips\_per\_video})" display="inline"><semantics id="alg3.l16.m1.2a"><mrow id="alg3.l16.m1.2.2" xref="alg3.l16.m1.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l16.m1.2.2.3" xref="alg3.l16.m1.2.2.3a.cmml">context_clips_indices</mtext><mo stretchy="false" id="alg3.l16.m1.2.2.2" xref="alg3.l16.m1.2.2.2.cmml">←</mo><mrow id="alg3.l16.m1.2.2.1" xref="alg3.l16.m1.2.2.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l16.m1.2.2.1.3" xref="alg3.l16.m1.2.2.1.3a.cmml">choose</mtext><mo lspace="0em" rspace="0em" id="alg3.l16.m1.2.2.1.2" xref="alg3.l16.m1.2.2.1.2.cmml">​</mo><mrow id="alg3.l16.m1.2.2.1.1.1" xref="alg3.l16.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg3.l16.m1.2.2.1.1.1.2" xref="alg3.l16.m1.2.2.1.1.2.cmml">(</mo><msub id="alg3.l16.m1.2.2.1.1.1.1" xref="alg3.l16.m1.2.2.1.1.1.1.cmml"><mi id="alg3.l16.m1.2.2.1.1.1.1.2" xref="alg3.l16.m1.2.2.1.1.1.1.2.cmml">n</mi><mrow id="alg3.l16.m1.2.2.1.1.1.1.3" xref="alg3.l16.m1.2.2.1.1.1.1.3.cmml"><mi id="alg3.l16.m1.2.2.1.1.1.1.3.2" xref="alg3.l16.m1.2.2.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l16.m1.2.2.1.1.1.1.3.1" xref="alg3.l16.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mn id="alg3.l16.m1.2.2.1.1.1.1.3.3" xref="alg3.l16.m1.2.2.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l16.m1.2.2.1.1.1.3" xref="alg3.l16.m1.2.2.1.1.2.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg3.l16.m1.1.1" xref="alg3.l16.m1.1.1a.cmml">num_clips_per_video</mtext><mo stretchy="false" id="alg3.l16.m1.2.2.1.1.1.4" xref="alg3.l16.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l16.m1.2b"><apply id="alg3.l16.m1.2.2.cmml" xref="alg3.l16.m1.2.2"><ci id="alg3.l16.m1.2.2.2.cmml" xref="alg3.l16.m1.2.2.2">←</ci><ci id="alg3.l16.m1.2.2.3a.cmml" xref="alg3.l16.m1.2.2.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l16.m1.2.2.3.cmml" xref="alg3.l16.m1.2.2.3">context_clips_indices</mtext></ci><apply id="alg3.l16.m1.2.2.1.cmml" xref="alg3.l16.m1.2.2.1"><times id="alg3.l16.m1.2.2.1.2.cmml" xref="alg3.l16.m1.2.2.1.2"></times><ci id="alg3.l16.m1.2.2.1.3a.cmml" xref="alg3.l16.m1.2.2.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l16.m1.2.2.1.3.cmml" xref="alg3.l16.m1.2.2.1.3">choose</mtext></ci><interval closure="open" id="alg3.l16.m1.2.2.1.1.2.cmml" xref="alg3.l16.m1.2.2.1.1.1"><apply id="alg3.l16.m1.2.2.1.1.1.1.cmml" xref="alg3.l16.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l16.m1.2.2.1.1.1.1.1.cmml" xref="alg3.l16.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg3.l16.m1.2.2.1.1.1.1.2.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.2">𝑛</ci><apply id="alg3.l16.m1.2.2.1.1.1.1.3.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.3"><times id="alg3.l16.m1.2.2.1.1.1.1.3.1.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.3.1"></times><ci id="alg3.l16.m1.2.2.1.1.1.1.3.2.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.3.2">𝑐</ci><cn type="integer" id="alg3.l16.m1.2.2.1.1.1.1.3.3.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.3.3">1</cn></apply></apply><ci id="alg3.l16.m1.1.1a.cmml" xref="alg3.l16.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg3.l16.m1.1.1.cmml" xref="alg3.l16.m1.1.1">num_clips_per_video</mtext></ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l16.m1.2c">\texttt{context\_clips\_indices}\leftarrow\texttt{choose}(n_{c1},\texttt{num\_clips\_per\_video})</annotation></semantics></math>

</div>
<div id="alg3.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>              <math id="alg3.l17.m1.2" class="ltx_Math" alttext="\texttt{target\_clips\_indices}\leftarrow\texttt{diff}(\texttt{range}(n_{c1}),\texttt{context\_clips\_indices})" display="inline"><semantics id="alg3.l17.m1.2a"><mrow id="alg3.l17.m1.2.2" xref="alg3.l17.m1.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l17.m1.2.2.3" xref="alg3.l17.m1.2.2.3a.cmml">target_clips_indices</mtext><mo stretchy="false" id="alg3.l17.m1.2.2.2" xref="alg3.l17.m1.2.2.2.cmml">←</mo><mrow id="alg3.l17.m1.2.2.1" xref="alg3.l17.m1.2.2.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l17.m1.2.2.1.3" xref="alg3.l17.m1.2.2.1.3a.cmml">diff</mtext><mo lspace="0em" rspace="0em" id="alg3.l17.m1.2.2.1.2" xref="alg3.l17.m1.2.2.1.2.cmml">​</mo><mrow id="alg3.l17.m1.2.2.1.1.1" xref="alg3.l17.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg3.l17.m1.2.2.1.1.1.2" xref="alg3.l17.m1.2.2.1.1.2.cmml">(</mo><mrow id="alg3.l17.m1.2.2.1.1.1.1" xref="alg3.l17.m1.2.2.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l17.m1.2.2.1.1.1.1.3" xref="alg3.l17.m1.2.2.1.1.1.1.3a.cmml">range</mtext><mo lspace="0em" rspace="0em" id="alg3.l17.m1.2.2.1.1.1.1.2" xref="alg3.l17.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="alg3.l17.m1.2.2.1.1.1.1.1.1" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l17.m1.2.2.1.1.1.1.1.1.2" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg3.l17.m1.2.2.1.1.1.1.1.1.1" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg3.l17.m1.2.2.1.1.1.1.1.1.1.2" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.2.cmml">n</mi><mrow id="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.2" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.1" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mn id="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.3" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg3.l17.m1.2.2.1.1.1.1.1.1.3" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l17.m1.2.2.1.1.1.3" xref="alg3.l17.m1.2.2.1.1.2.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg3.l17.m1.1.1" xref="alg3.l17.m1.1.1a.cmml">context_clips_indices</mtext><mo stretchy="false" id="alg3.l17.m1.2.2.1.1.1.4" xref="alg3.l17.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l17.m1.2b"><apply id="alg3.l17.m1.2.2.cmml" xref="alg3.l17.m1.2.2"><ci id="alg3.l17.m1.2.2.2.cmml" xref="alg3.l17.m1.2.2.2">←</ci><ci id="alg3.l17.m1.2.2.3a.cmml" xref="alg3.l17.m1.2.2.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l17.m1.2.2.3.cmml" xref="alg3.l17.m1.2.2.3">target_clips_indices</mtext></ci><apply id="alg3.l17.m1.2.2.1.cmml" xref="alg3.l17.m1.2.2.1"><times id="alg3.l17.m1.2.2.1.2.cmml" xref="alg3.l17.m1.2.2.1.2"></times><ci id="alg3.l17.m1.2.2.1.3a.cmml" xref="alg3.l17.m1.2.2.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l17.m1.2.2.1.3.cmml" xref="alg3.l17.m1.2.2.1.3">diff</mtext></ci><interval closure="open" id="alg3.l17.m1.2.2.1.1.2.cmml" xref="alg3.l17.m1.2.2.1.1.1"><apply id="alg3.l17.m1.2.2.1.1.1.1.cmml" xref="alg3.l17.m1.2.2.1.1.1.1"><times id="alg3.l17.m1.2.2.1.1.1.1.2.cmml" xref="alg3.l17.m1.2.2.1.1.1.1.2"></times><ci id="alg3.l17.m1.2.2.1.1.1.1.3a.cmml" xref="alg3.l17.m1.2.2.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l17.m1.2.2.1.1.1.1.3.cmml" xref="alg3.l17.m1.2.2.1.1.1.1.3">range</mtext></ci><apply id="alg3.l17.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg3.l17.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l17.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg3.l17.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l17.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.2">𝑛</ci><apply id="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3"><times id="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.1"></times><ci id="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.2">𝑐</ci><cn type="integer" id="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="alg3.l17.m1.2.2.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><ci id="alg3.l17.m1.1.1a.cmml" xref="alg3.l17.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg3.l17.m1.1.1.cmml" xref="alg3.l17.m1.1.1">context_clips_indices</mtext></ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l17.m1.2c">\texttt{target\_clips\_indices}\leftarrow\texttt{diff}(\texttt{range}(n_{c1}),\texttt{context\_clips\_indices})</annotation></semantics></math>

</div>
<div id="alg3.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>              <math id="alg3.l18.m1.2" class="ltx_Math" alttext="\mathcal{D}_{train}\leftarrow\mathcal{D}_{train}+\texttt{select\_by\_index}(V_{c1},\texttt{context\_clips\_indices})" display="inline"><semantics id="alg3.l18.m1.2a"><mrow id="alg3.l18.m1.2.2" xref="alg3.l18.m1.2.2.cmml"><msub id="alg3.l18.m1.2.2.3" xref="alg3.l18.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l18.m1.2.2.3.2" xref="alg3.l18.m1.2.2.3.2.cmml">𝒟</mi><mrow id="alg3.l18.m1.2.2.3.3" xref="alg3.l18.m1.2.2.3.3.cmml"><mi id="alg3.l18.m1.2.2.3.3.2" xref="alg3.l18.m1.2.2.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l18.m1.2.2.3.3.1" xref="alg3.l18.m1.2.2.3.3.1.cmml">​</mo><mi id="alg3.l18.m1.2.2.3.3.3" xref="alg3.l18.m1.2.2.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg3.l18.m1.2.2.3.3.1a" xref="alg3.l18.m1.2.2.3.3.1.cmml">​</mo><mi id="alg3.l18.m1.2.2.3.3.4" xref="alg3.l18.m1.2.2.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg3.l18.m1.2.2.3.3.1b" xref="alg3.l18.m1.2.2.3.3.1.cmml">​</mo><mi id="alg3.l18.m1.2.2.3.3.5" xref="alg3.l18.m1.2.2.3.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg3.l18.m1.2.2.3.3.1c" xref="alg3.l18.m1.2.2.3.3.1.cmml">​</mo><mi id="alg3.l18.m1.2.2.3.3.6" xref="alg3.l18.m1.2.2.3.3.6.cmml">n</mi></mrow></msub><mo stretchy="false" id="alg3.l18.m1.2.2.2" xref="alg3.l18.m1.2.2.2.cmml">←</mo><mrow id="alg3.l18.m1.2.2.1" xref="alg3.l18.m1.2.2.1.cmml"><msub id="alg3.l18.m1.2.2.1.3" xref="alg3.l18.m1.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l18.m1.2.2.1.3.2" xref="alg3.l18.m1.2.2.1.3.2.cmml">𝒟</mi><mrow id="alg3.l18.m1.2.2.1.3.3" xref="alg3.l18.m1.2.2.1.3.3.cmml"><mi id="alg3.l18.m1.2.2.1.3.3.2" xref="alg3.l18.m1.2.2.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l18.m1.2.2.1.3.3.1" xref="alg3.l18.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg3.l18.m1.2.2.1.3.3.3" xref="alg3.l18.m1.2.2.1.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg3.l18.m1.2.2.1.3.3.1a" xref="alg3.l18.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg3.l18.m1.2.2.1.3.3.4" xref="alg3.l18.m1.2.2.1.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg3.l18.m1.2.2.1.3.3.1b" xref="alg3.l18.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg3.l18.m1.2.2.1.3.3.5" xref="alg3.l18.m1.2.2.1.3.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg3.l18.m1.2.2.1.3.3.1c" xref="alg3.l18.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg3.l18.m1.2.2.1.3.3.6" xref="alg3.l18.m1.2.2.1.3.3.6.cmml">n</mi></mrow></msub><mo id="alg3.l18.m1.2.2.1.2" xref="alg3.l18.m1.2.2.1.2.cmml">+</mo><mrow id="alg3.l18.m1.2.2.1.1" xref="alg3.l18.m1.2.2.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l18.m1.2.2.1.1.3" xref="alg3.l18.m1.2.2.1.1.3a.cmml">select_by_index</mtext><mo lspace="0em" rspace="0em" id="alg3.l18.m1.2.2.1.1.2" xref="alg3.l18.m1.2.2.1.1.2.cmml">​</mo><mrow id="alg3.l18.m1.2.2.1.1.1.1" xref="alg3.l18.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="alg3.l18.m1.2.2.1.1.1.1.2" xref="alg3.l18.m1.2.2.1.1.1.2.cmml">(</mo><msub id="alg3.l18.m1.2.2.1.1.1.1.1" xref="alg3.l18.m1.2.2.1.1.1.1.1.cmml"><mi id="alg3.l18.m1.2.2.1.1.1.1.1.2" xref="alg3.l18.m1.2.2.1.1.1.1.1.2.cmml">V</mi><mrow id="alg3.l18.m1.2.2.1.1.1.1.1.3" xref="alg3.l18.m1.2.2.1.1.1.1.1.3.cmml"><mi id="alg3.l18.m1.2.2.1.1.1.1.1.3.2" xref="alg3.l18.m1.2.2.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l18.m1.2.2.1.1.1.1.1.3.1" xref="alg3.l18.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mn id="alg3.l18.m1.2.2.1.1.1.1.1.3.3" xref="alg3.l18.m1.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l18.m1.2.2.1.1.1.1.3" xref="alg3.l18.m1.2.2.1.1.1.2.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg3.l18.m1.1.1" xref="alg3.l18.m1.1.1a.cmml">context_clips_indices</mtext><mo stretchy="false" id="alg3.l18.m1.2.2.1.1.1.1.4" xref="alg3.l18.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l18.m1.2b"><apply id="alg3.l18.m1.2.2.cmml" xref="alg3.l18.m1.2.2"><ci id="alg3.l18.m1.2.2.2.cmml" xref="alg3.l18.m1.2.2.2">←</ci><apply id="alg3.l18.m1.2.2.3.cmml" xref="alg3.l18.m1.2.2.3"><csymbol cd="ambiguous" id="alg3.l18.m1.2.2.3.1.cmml" xref="alg3.l18.m1.2.2.3">subscript</csymbol><ci id="alg3.l18.m1.2.2.3.2.cmml" xref="alg3.l18.m1.2.2.3.2">𝒟</ci><apply id="alg3.l18.m1.2.2.3.3.cmml" xref="alg3.l18.m1.2.2.3.3"><times id="alg3.l18.m1.2.2.3.3.1.cmml" xref="alg3.l18.m1.2.2.3.3.1"></times><ci id="alg3.l18.m1.2.2.3.3.2.cmml" xref="alg3.l18.m1.2.2.3.3.2">𝑡</ci><ci id="alg3.l18.m1.2.2.3.3.3.cmml" xref="alg3.l18.m1.2.2.3.3.3">𝑟</ci><ci id="alg3.l18.m1.2.2.3.3.4.cmml" xref="alg3.l18.m1.2.2.3.3.4">𝑎</ci><ci id="alg3.l18.m1.2.2.3.3.5.cmml" xref="alg3.l18.m1.2.2.3.3.5">𝑖</ci><ci id="alg3.l18.m1.2.2.3.3.6.cmml" xref="alg3.l18.m1.2.2.3.3.6">𝑛</ci></apply></apply><apply id="alg3.l18.m1.2.2.1.cmml" xref="alg3.l18.m1.2.2.1"><plus id="alg3.l18.m1.2.2.1.2.cmml" xref="alg3.l18.m1.2.2.1.2"></plus><apply id="alg3.l18.m1.2.2.1.3.cmml" xref="alg3.l18.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg3.l18.m1.2.2.1.3.1.cmml" xref="alg3.l18.m1.2.2.1.3">subscript</csymbol><ci id="alg3.l18.m1.2.2.1.3.2.cmml" xref="alg3.l18.m1.2.2.1.3.2">𝒟</ci><apply id="alg3.l18.m1.2.2.1.3.3.cmml" xref="alg3.l18.m1.2.2.1.3.3"><times id="alg3.l18.m1.2.2.1.3.3.1.cmml" xref="alg3.l18.m1.2.2.1.3.3.1"></times><ci id="alg3.l18.m1.2.2.1.3.3.2.cmml" xref="alg3.l18.m1.2.2.1.3.3.2">𝑡</ci><ci id="alg3.l18.m1.2.2.1.3.3.3.cmml" xref="alg3.l18.m1.2.2.1.3.3.3">𝑟</ci><ci id="alg3.l18.m1.2.2.1.3.3.4.cmml" xref="alg3.l18.m1.2.2.1.3.3.4">𝑎</ci><ci id="alg3.l18.m1.2.2.1.3.3.5.cmml" xref="alg3.l18.m1.2.2.1.3.3.5">𝑖</ci><ci id="alg3.l18.m1.2.2.1.3.3.6.cmml" xref="alg3.l18.m1.2.2.1.3.3.6">𝑛</ci></apply></apply><apply id="alg3.l18.m1.2.2.1.1.cmml" xref="alg3.l18.m1.2.2.1.1"><times id="alg3.l18.m1.2.2.1.1.2.cmml" xref="alg3.l18.m1.2.2.1.1.2"></times><ci id="alg3.l18.m1.2.2.1.1.3a.cmml" xref="alg3.l18.m1.2.2.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l18.m1.2.2.1.1.3.cmml" xref="alg3.l18.m1.2.2.1.1.3">select_by_index</mtext></ci><interval closure="open" id="alg3.l18.m1.2.2.1.1.1.2.cmml" xref="alg3.l18.m1.2.2.1.1.1.1"><apply id="alg3.l18.m1.2.2.1.1.1.1.1.cmml" xref="alg3.l18.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l18.m1.2.2.1.1.1.1.1.1.cmml" xref="alg3.l18.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="alg3.l18.m1.2.2.1.1.1.1.1.2.cmml" xref="alg3.l18.m1.2.2.1.1.1.1.1.2">𝑉</ci><apply id="alg3.l18.m1.2.2.1.1.1.1.1.3.cmml" xref="alg3.l18.m1.2.2.1.1.1.1.1.3"><times id="alg3.l18.m1.2.2.1.1.1.1.1.3.1.cmml" xref="alg3.l18.m1.2.2.1.1.1.1.1.3.1"></times><ci id="alg3.l18.m1.2.2.1.1.1.1.1.3.2.cmml" xref="alg3.l18.m1.2.2.1.1.1.1.1.3.2">𝑐</ci><cn type="integer" id="alg3.l18.m1.2.2.1.1.1.1.1.3.3.cmml" xref="alg3.l18.m1.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="alg3.l18.m1.1.1a.cmml" xref="alg3.l18.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg3.l18.m1.1.1.cmml" xref="alg3.l18.m1.1.1">context_clips_indices</mtext></ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l18.m1.2c">\mathcal{D}_{train}\leftarrow\mathcal{D}_{train}+\texttt{select\_by\_index}(V_{c1},\texttt{context\_clips\_indices})</annotation></semantics></math>

</div>
<div id="alg3.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>              <math id="alg3.l19.m1.2" class="ltx_Math" alttext="\mathcal{D}_{test}\leftarrow\mathcal{D}_{test}+\texttt{select\_by\_index}(V_{c1},\texttt{target\_clips\_indices})" display="inline"><semantics id="alg3.l19.m1.2a"><mrow id="alg3.l19.m1.2.2" xref="alg3.l19.m1.2.2.cmml"><msub id="alg3.l19.m1.2.2.3" xref="alg3.l19.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l19.m1.2.2.3.2" xref="alg3.l19.m1.2.2.3.2.cmml">𝒟</mi><mrow id="alg3.l19.m1.2.2.3.3" xref="alg3.l19.m1.2.2.3.3.cmml"><mi id="alg3.l19.m1.2.2.3.3.2" xref="alg3.l19.m1.2.2.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l19.m1.2.2.3.3.1" xref="alg3.l19.m1.2.2.3.3.1.cmml">​</mo><mi id="alg3.l19.m1.2.2.3.3.3" xref="alg3.l19.m1.2.2.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg3.l19.m1.2.2.3.3.1a" xref="alg3.l19.m1.2.2.3.3.1.cmml">​</mo><mi id="alg3.l19.m1.2.2.3.3.4" xref="alg3.l19.m1.2.2.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg3.l19.m1.2.2.3.3.1b" xref="alg3.l19.m1.2.2.3.3.1.cmml">​</mo><mi id="alg3.l19.m1.2.2.3.3.5" xref="alg3.l19.m1.2.2.3.3.5.cmml">t</mi></mrow></msub><mo stretchy="false" id="alg3.l19.m1.2.2.2" xref="alg3.l19.m1.2.2.2.cmml">←</mo><mrow id="alg3.l19.m1.2.2.1" xref="alg3.l19.m1.2.2.1.cmml"><msub id="alg3.l19.m1.2.2.1.3" xref="alg3.l19.m1.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l19.m1.2.2.1.3.2" xref="alg3.l19.m1.2.2.1.3.2.cmml">𝒟</mi><mrow id="alg3.l19.m1.2.2.1.3.3" xref="alg3.l19.m1.2.2.1.3.3.cmml"><mi id="alg3.l19.m1.2.2.1.3.3.2" xref="alg3.l19.m1.2.2.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l19.m1.2.2.1.3.3.1" xref="alg3.l19.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg3.l19.m1.2.2.1.3.3.3" xref="alg3.l19.m1.2.2.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg3.l19.m1.2.2.1.3.3.1a" xref="alg3.l19.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg3.l19.m1.2.2.1.3.3.4" xref="alg3.l19.m1.2.2.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg3.l19.m1.2.2.1.3.3.1b" xref="alg3.l19.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg3.l19.m1.2.2.1.3.3.5" xref="alg3.l19.m1.2.2.1.3.3.5.cmml">t</mi></mrow></msub><mo id="alg3.l19.m1.2.2.1.2" xref="alg3.l19.m1.2.2.1.2.cmml">+</mo><mrow id="alg3.l19.m1.2.2.1.1" xref="alg3.l19.m1.2.2.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l19.m1.2.2.1.1.3" xref="alg3.l19.m1.2.2.1.1.3a.cmml">select_by_index</mtext><mo lspace="0em" rspace="0em" id="alg3.l19.m1.2.2.1.1.2" xref="alg3.l19.m1.2.2.1.1.2.cmml">​</mo><mrow id="alg3.l19.m1.2.2.1.1.1.1" xref="alg3.l19.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="alg3.l19.m1.2.2.1.1.1.1.2" xref="alg3.l19.m1.2.2.1.1.1.2.cmml">(</mo><msub id="alg3.l19.m1.2.2.1.1.1.1.1" xref="alg3.l19.m1.2.2.1.1.1.1.1.cmml"><mi id="alg3.l19.m1.2.2.1.1.1.1.1.2" xref="alg3.l19.m1.2.2.1.1.1.1.1.2.cmml">V</mi><mrow id="alg3.l19.m1.2.2.1.1.1.1.1.3" xref="alg3.l19.m1.2.2.1.1.1.1.1.3.cmml"><mi id="alg3.l19.m1.2.2.1.1.1.1.1.3.2" xref="alg3.l19.m1.2.2.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l19.m1.2.2.1.1.1.1.1.3.1" xref="alg3.l19.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mn id="alg3.l19.m1.2.2.1.1.1.1.1.3.3" xref="alg3.l19.m1.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l19.m1.2.2.1.1.1.1.3" xref="alg3.l19.m1.2.2.1.1.1.2.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg3.l19.m1.1.1" xref="alg3.l19.m1.1.1a.cmml">target_clips_indices</mtext><mo stretchy="false" id="alg3.l19.m1.2.2.1.1.1.1.4" xref="alg3.l19.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l19.m1.2b"><apply id="alg3.l19.m1.2.2.cmml" xref="alg3.l19.m1.2.2"><ci id="alg3.l19.m1.2.2.2.cmml" xref="alg3.l19.m1.2.2.2">←</ci><apply id="alg3.l19.m1.2.2.3.cmml" xref="alg3.l19.m1.2.2.3"><csymbol cd="ambiguous" id="alg3.l19.m1.2.2.3.1.cmml" xref="alg3.l19.m1.2.2.3">subscript</csymbol><ci id="alg3.l19.m1.2.2.3.2.cmml" xref="alg3.l19.m1.2.2.3.2">𝒟</ci><apply id="alg3.l19.m1.2.2.3.3.cmml" xref="alg3.l19.m1.2.2.3.3"><times id="alg3.l19.m1.2.2.3.3.1.cmml" xref="alg3.l19.m1.2.2.3.3.1"></times><ci id="alg3.l19.m1.2.2.3.3.2.cmml" xref="alg3.l19.m1.2.2.3.3.2">𝑡</ci><ci id="alg3.l19.m1.2.2.3.3.3.cmml" xref="alg3.l19.m1.2.2.3.3.3">𝑒</ci><ci id="alg3.l19.m1.2.2.3.3.4.cmml" xref="alg3.l19.m1.2.2.3.3.4">𝑠</ci><ci id="alg3.l19.m1.2.2.3.3.5.cmml" xref="alg3.l19.m1.2.2.3.3.5">𝑡</ci></apply></apply><apply id="alg3.l19.m1.2.2.1.cmml" xref="alg3.l19.m1.2.2.1"><plus id="alg3.l19.m1.2.2.1.2.cmml" xref="alg3.l19.m1.2.2.1.2"></plus><apply id="alg3.l19.m1.2.2.1.3.cmml" xref="alg3.l19.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg3.l19.m1.2.2.1.3.1.cmml" xref="alg3.l19.m1.2.2.1.3">subscript</csymbol><ci id="alg3.l19.m1.2.2.1.3.2.cmml" xref="alg3.l19.m1.2.2.1.3.2">𝒟</ci><apply id="alg3.l19.m1.2.2.1.3.3.cmml" xref="alg3.l19.m1.2.2.1.3.3"><times id="alg3.l19.m1.2.2.1.3.3.1.cmml" xref="alg3.l19.m1.2.2.1.3.3.1"></times><ci id="alg3.l19.m1.2.2.1.3.3.2.cmml" xref="alg3.l19.m1.2.2.1.3.3.2">𝑡</ci><ci id="alg3.l19.m1.2.2.1.3.3.3.cmml" xref="alg3.l19.m1.2.2.1.3.3.3">𝑒</ci><ci id="alg3.l19.m1.2.2.1.3.3.4.cmml" xref="alg3.l19.m1.2.2.1.3.3.4">𝑠</ci><ci id="alg3.l19.m1.2.2.1.3.3.5.cmml" xref="alg3.l19.m1.2.2.1.3.3.5">𝑡</ci></apply></apply><apply id="alg3.l19.m1.2.2.1.1.cmml" xref="alg3.l19.m1.2.2.1.1"><times id="alg3.l19.m1.2.2.1.1.2.cmml" xref="alg3.l19.m1.2.2.1.1.2"></times><ci id="alg3.l19.m1.2.2.1.1.3a.cmml" xref="alg3.l19.m1.2.2.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l19.m1.2.2.1.1.3.cmml" xref="alg3.l19.m1.2.2.1.1.3">select_by_index</mtext></ci><interval closure="open" id="alg3.l19.m1.2.2.1.1.1.2.cmml" xref="alg3.l19.m1.2.2.1.1.1.1"><apply id="alg3.l19.m1.2.2.1.1.1.1.1.cmml" xref="alg3.l19.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l19.m1.2.2.1.1.1.1.1.1.cmml" xref="alg3.l19.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="alg3.l19.m1.2.2.1.1.1.1.1.2.cmml" xref="alg3.l19.m1.2.2.1.1.1.1.1.2">𝑉</ci><apply id="alg3.l19.m1.2.2.1.1.1.1.1.3.cmml" xref="alg3.l19.m1.2.2.1.1.1.1.1.3"><times id="alg3.l19.m1.2.2.1.1.1.1.1.3.1.cmml" xref="alg3.l19.m1.2.2.1.1.1.1.1.3.1"></times><ci id="alg3.l19.m1.2.2.1.1.1.1.1.3.2.cmml" xref="alg3.l19.m1.2.2.1.1.1.1.1.3.2">𝑐</ci><cn type="integer" id="alg3.l19.m1.2.2.1.1.1.1.1.3.3.cmml" xref="alg3.l19.m1.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="alg3.l19.m1.1.1a.cmml" xref="alg3.l19.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg3.l19.m1.1.1.cmml" xref="alg3.l19.m1.1.1">target_clips_indices</mtext></ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l19.m1.2c">\mathcal{D}_{test}\leftarrow\mathcal{D}_{test}+\texttt{select\_by\_index}(V_{c1},\texttt{target\_clips\_indices})</annotation></semantics></math>

</div>
<div id="alg3.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>         <span id="alg3.l20.1" class="ltx_text ltx_font_bold">else</span>

</div>
<div id="alg3.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span>              <span id="alg3.l21.1" class="ltx_text ltx_font_bold">for</span> <math id="alg3.l21.m1.1" class="ltx_Math" alttext="j\leftarrow\texttt{context\_videos\_indices}" display="inline"><semantics id="alg3.l21.m1.1a"><mrow id="alg3.l21.m1.1.1" xref="alg3.l21.m1.1.1.cmml"><mi id="alg3.l21.m1.1.1.2" xref="alg3.l21.m1.1.1.2.cmml">j</mi><mo stretchy="false" id="alg3.l21.m1.1.1.1" xref="alg3.l21.m1.1.1.1.cmml">←</mo><mtext class="ltx_mathvariant_monospace" id="alg3.l21.m1.1.1.3" xref="alg3.l21.m1.1.1.3a.cmml">context_videos_indices</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg3.l21.m1.1b"><apply id="alg3.l21.m1.1.1.cmml" xref="alg3.l21.m1.1.1"><ci id="alg3.l21.m1.1.1.1.cmml" xref="alg3.l21.m1.1.1.1">←</ci><ci id="alg3.l21.m1.1.1.2.cmml" xref="alg3.l21.m1.1.1.2">𝑗</ci><ci id="alg3.l21.m1.1.1.3a.cmml" xref="alg3.l21.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l21.m1.1.1.3.cmml" xref="alg3.l21.m1.1.1.3">context_videos_indices</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l21.m1.1c">j\leftarrow\texttt{context\_videos\_indices}</annotation></semantics></math> <span id="alg3.l21.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg3.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22:</span>                  <math id="alg3.l22.m1.2" class="ltx_Math" alttext="\texttt{context\_clips\_indices}\leftarrow\texttt{choose}(n_{cj},\texttt{num\_clips\_per\_video})" display="inline"><semantics id="alg3.l22.m1.2a"><mrow id="alg3.l22.m1.2.2" xref="alg3.l22.m1.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l22.m1.2.2.3" xref="alg3.l22.m1.2.2.3a.cmml">context_clips_indices</mtext><mo stretchy="false" id="alg3.l22.m1.2.2.2" xref="alg3.l22.m1.2.2.2.cmml">←</mo><mrow id="alg3.l22.m1.2.2.1" xref="alg3.l22.m1.2.2.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l22.m1.2.2.1.3" xref="alg3.l22.m1.2.2.1.3a.cmml">choose</mtext><mo lspace="0em" rspace="0em" id="alg3.l22.m1.2.2.1.2" xref="alg3.l22.m1.2.2.1.2.cmml">​</mo><mrow id="alg3.l22.m1.2.2.1.1.1" xref="alg3.l22.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg3.l22.m1.2.2.1.1.1.2" xref="alg3.l22.m1.2.2.1.1.2.cmml">(</mo><msub id="alg3.l22.m1.2.2.1.1.1.1" xref="alg3.l22.m1.2.2.1.1.1.1.cmml"><mi id="alg3.l22.m1.2.2.1.1.1.1.2" xref="alg3.l22.m1.2.2.1.1.1.1.2.cmml">n</mi><mrow id="alg3.l22.m1.2.2.1.1.1.1.3" xref="alg3.l22.m1.2.2.1.1.1.1.3.cmml"><mi id="alg3.l22.m1.2.2.1.1.1.1.3.2" xref="alg3.l22.m1.2.2.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l22.m1.2.2.1.1.1.1.3.1" xref="alg3.l22.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="alg3.l22.m1.2.2.1.1.1.1.3.3" xref="alg3.l22.m1.2.2.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="alg3.l22.m1.2.2.1.1.1.3" xref="alg3.l22.m1.2.2.1.1.2.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg3.l22.m1.1.1" xref="alg3.l22.m1.1.1a.cmml">num_clips_per_video</mtext><mo stretchy="false" id="alg3.l22.m1.2.2.1.1.1.4" xref="alg3.l22.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l22.m1.2b"><apply id="alg3.l22.m1.2.2.cmml" xref="alg3.l22.m1.2.2"><ci id="alg3.l22.m1.2.2.2.cmml" xref="alg3.l22.m1.2.2.2">←</ci><ci id="alg3.l22.m1.2.2.3a.cmml" xref="alg3.l22.m1.2.2.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l22.m1.2.2.3.cmml" xref="alg3.l22.m1.2.2.3">context_clips_indices</mtext></ci><apply id="alg3.l22.m1.2.2.1.cmml" xref="alg3.l22.m1.2.2.1"><times id="alg3.l22.m1.2.2.1.2.cmml" xref="alg3.l22.m1.2.2.1.2"></times><ci id="alg3.l22.m1.2.2.1.3a.cmml" xref="alg3.l22.m1.2.2.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l22.m1.2.2.1.3.cmml" xref="alg3.l22.m1.2.2.1.3">choose</mtext></ci><interval closure="open" id="alg3.l22.m1.2.2.1.1.2.cmml" xref="alg3.l22.m1.2.2.1.1.1"><apply id="alg3.l22.m1.2.2.1.1.1.1.cmml" xref="alg3.l22.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l22.m1.2.2.1.1.1.1.1.cmml" xref="alg3.l22.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg3.l22.m1.2.2.1.1.1.1.2.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.2">𝑛</ci><apply id="alg3.l22.m1.2.2.1.1.1.1.3.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.3"><times id="alg3.l22.m1.2.2.1.1.1.1.3.1.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.3.1"></times><ci id="alg3.l22.m1.2.2.1.1.1.1.3.2.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.3.2">𝑐</ci><ci id="alg3.l22.m1.2.2.1.1.1.1.3.3.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.3.3">𝑗</ci></apply></apply><ci id="alg3.l22.m1.1.1a.cmml" xref="alg3.l22.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg3.l22.m1.1.1.cmml" xref="alg3.l22.m1.1.1">num_clips_per_video</mtext></ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l22.m1.2c">\texttt{context\_clips\_indices}\leftarrow\texttt{choose}(n_{cj},\texttt{num\_clips\_per\_video})</annotation></semantics></math>

</div>
<div id="alg3.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23:</span>                  <math id="alg3.l23.m1.2" class="ltx_Math" alttext="\mathcal{D}_{train}\leftarrow\mathcal{D}_{train}+\texttt{select\_by\_index}(V_{cj},\texttt{context\_clips\_indices})" display="inline"><semantics id="alg3.l23.m1.2a"><mrow id="alg3.l23.m1.2.2" xref="alg3.l23.m1.2.2.cmml"><msub id="alg3.l23.m1.2.2.3" xref="alg3.l23.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l23.m1.2.2.3.2" xref="alg3.l23.m1.2.2.3.2.cmml">𝒟</mi><mrow id="alg3.l23.m1.2.2.3.3" xref="alg3.l23.m1.2.2.3.3.cmml"><mi id="alg3.l23.m1.2.2.3.3.2" xref="alg3.l23.m1.2.2.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l23.m1.2.2.3.3.1" xref="alg3.l23.m1.2.2.3.3.1.cmml">​</mo><mi id="alg3.l23.m1.2.2.3.3.3" xref="alg3.l23.m1.2.2.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg3.l23.m1.2.2.3.3.1a" xref="alg3.l23.m1.2.2.3.3.1.cmml">​</mo><mi id="alg3.l23.m1.2.2.3.3.4" xref="alg3.l23.m1.2.2.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg3.l23.m1.2.2.3.3.1b" xref="alg3.l23.m1.2.2.3.3.1.cmml">​</mo><mi id="alg3.l23.m1.2.2.3.3.5" xref="alg3.l23.m1.2.2.3.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg3.l23.m1.2.2.3.3.1c" xref="alg3.l23.m1.2.2.3.3.1.cmml">​</mo><mi id="alg3.l23.m1.2.2.3.3.6" xref="alg3.l23.m1.2.2.3.3.6.cmml">n</mi></mrow></msub><mo stretchy="false" id="alg3.l23.m1.2.2.2" xref="alg3.l23.m1.2.2.2.cmml">←</mo><mrow id="alg3.l23.m1.2.2.1" xref="alg3.l23.m1.2.2.1.cmml"><msub id="alg3.l23.m1.2.2.1.3" xref="alg3.l23.m1.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l23.m1.2.2.1.3.2" xref="alg3.l23.m1.2.2.1.3.2.cmml">𝒟</mi><mrow id="alg3.l23.m1.2.2.1.3.3" xref="alg3.l23.m1.2.2.1.3.3.cmml"><mi id="alg3.l23.m1.2.2.1.3.3.2" xref="alg3.l23.m1.2.2.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l23.m1.2.2.1.3.3.1" xref="alg3.l23.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg3.l23.m1.2.2.1.3.3.3" xref="alg3.l23.m1.2.2.1.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg3.l23.m1.2.2.1.3.3.1a" xref="alg3.l23.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg3.l23.m1.2.2.1.3.3.4" xref="alg3.l23.m1.2.2.1.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg3.l23.m1.2.2.1.3.3.1b" xref="alg3.l23.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg3.l23.m1.2.2.1.3.3.5" xref="alg3.l23.m1.2.2.1.3.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg3.l23.m1.2.2.1.3.3.1c" xref="alg3.l23.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg3.l23.m1.2.2.1.3.3.6" xref="alg3.l23.m1.2.2.1.3.3.6.cmml">n</mi></mrow></msub><mo id="alg3.l23.m1.2.2.1.2" xref="alg3.l23.m1.2.2.1.2.cmml">+</mo><mrow id="alg3.l23.m1.2.2.1.1" xref="alg3.l23.m1.2.2.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l23.m1.2.2.1.1.3" xref="alg3.l23.m1.2.2.1.1.3a.cmml">select_by_index</mtext><mo lspace="0em" rspace="0em" id="alg3.l23.m1.2.2.1.1.2" xref="alg3.l23.m1.2.2.1.1.2.cmml">​</mo><mrow id="alg3.l23.m1.2.2.1.1.1.1" xref="alg3.l23.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="alg3.l23.m1.2.2.1.1.1.1.2" xref="alg3.l23.m1.2.2.1.1.1.2.cmml">(</mo><msub id="alg3.l23.m1.2.2.1.1.1.1.1" xref="alg3.l23.m1.2.2.1.1.1.1.1.cmml"><mi id="alg3.l23.m1.2.2.1.1.1.1.1.2" xref="alg3.l23.m1.2.2.1.1.1.1.1.2.cmml">V</mi><mrow id="alg3.l23.m1.2.2.1.1.1.1.1.3" xref="alg3.l23.m1.2.2.1.1.1.1.1.3.cmml"><mi id="alg3.l23.m1.2.2.1.1.1.1.1.3.2" xref="alg3.l23.m1.2.2.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l23.m1.2.2.1.1.1.1.1.3.1" xref="alg3.l23.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg3.l23.m1.2.2.1.1.1.1.1.3.3" xref="alg3.l23.m1.2.2.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="alg3.l23.m1.2.2.1.1.1.1.3" xref="alg3.l23.m1.2.2.1.1.1.2.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg3.l23.m1.1.1" xref="alg3.l23.m1.1.1a.cmml">context_clips_indices</mtext><mo stretchy="false" id="alg3.l23.m1.2.2.1.1.1.1.4" xref="alg3.l23.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l23.m1.2b"><apply id="alg3.l23.m1.2.2.cmml" xref="alg3.l23.m1.2.2"><ci id="alg3.l23.m1.2.2.2.cmml" xref="alg3.l23.m1.2.2.2">←</ci><apply id="alg3.l23.m1.2.2.3.cmml" xref="alg3.l23.m1.2.2.3"><csymbol cd="ambiguous" id="alg3.l23.m1.2.2.3.1.cmml" xref="alg3.l23.m1.2.2.3">subscript</csymbol><ci id="alg3.l23.m1.2.2.3.2.cmml" xref="alg3.l23.m1.2.2.3.2">𝒟</ci><apply id="alg3.l23.m1.2.2.3.3.cmml" xref="alg3.l23.m1.2.2.3.3"><times id="alg3.l23.m1.2.2.3.3.1.cmml" xref="alg3.l23.m1.2.2.3.3.1"></times><ci id="alg3.l23.m1.2.2.3.3.2.cmml" xref="alg3.l23.m1.2.2.3.3.2">𝑡</ci><ci id="alg3.l23.m1.2.2.3.3.3.cmml" xref="alg3.l23.m1.2.2.3.3.3">𝑟</ci><ci id="alg3.l23.m1.2.2.3.3.4.cmml" xref="alg3.l23.m1.2.2.3.3.4">𝑎</ci><ci id="alg3.l23.m1.2.2.3.3.5.cmml" xref="alg3.l23.m1.2.2.3.3.5">𝑖</ci><ci id="alg3.l23.m1.2.2.3.3.6.cmml" xref="alg3.l23.m1.2.2.3.3.6">𝑛</ci></apply></apply><apply id="alg3.l23.m1.2.2.1.cmml" xref="alg3.l23.m1.2.2.1"><plus id="alg3.l23.m1.2.2.1.2.cmml" xref="alg3.l23.m1.2.2.1.2"></plus><apply id="alg3.l23.m1.2.2.1.3.cmml" xref="alg3.l23.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg3.l23.m1.2.2.1.3.1.cmml" xref="alg3.l23.m1.2.2.1.3">subscript</csymbol><ci id="alg3.l23.m1.2.2.1.3.2.cmml" xref="alg3.l23.m1.2.2.1.3.2">𝒟</ci><apply id="alg3.l23.m1.2.2.1.3.3.cmml" xref="alg3.l23.m1.2.2.1.3.3"><times id="alg3.l23.m1.2.2.1.3.3.1.cmml" xref="alg3.l23.m1.2.2.1.3.3.1"></times><ci id="alg3.l23.m1.2.2.1.3.3.2.cmml" xref="alg3.l23.m1.2.2.1.3.3.2">𝑡</ci><ci id="alg3.l23.m1.2.2.1.3.3.3.cmml" xref="alg3.l23.m1.2.2.1.3.3.3">𝑟</ci><ci id="alg3.l23.m1.2.2.1.3.3.4.cmml" xref="alg3.l23.m1.2.2.1.3.3.4">𝑎</ci><ci id="alg3.l23.m1.2.2.1.3.3.5.cmml" xref="alg3.l23.m1.2.2.1.3.3.5">𝑖</ci><ci id="alg3.l23.m1.2.2.1.3.3.6.cmml" xref="alg3.l23.m1.2.2.1.3.3.6">𝑛</ci></apply></apply><apply id="alg3.l23.m1.2.2.1.1.cmml" xref="alg3.l23.m1.2.2.1.1"><times id="alg3.l23.m1.2.2.1.1.2.cmml" xref="alg3.l23.m1.2.2.1.1.2"></times><ci id="alg3.l23.m1.2.2.1.1.3a.cmml" xref="alg3.l23.m1.2.2.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l23.m1.2.2.1.1.3.cmml" xref="alg3.l23.m1.2.2.1.1.3">select_by_index</mtext></ci><interval closure="open" id="alg3.l23.m1.2.2.1.1.1.2.cmml" xref="alg3.l23.m1.2.2.1.1.1.1"><apply id="alg3.l23.m1.2.2.1.1.1.1.1.cmml" xref="alg3.l23.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l23.m1.2.2.1.1.1.1.1.1.cmml" xref="alg3.l23.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="alg3.l23.m1.2.2.1.1.1.1.1.2.cmml" xref="alg3.l23.m1.2.2.1.1.1.1.1.2">𝑉</ci><apply id="alg3.l23.m1.2.2.1.1.1.1.1.3.cmml" xref="alg3.l23.m1.2.2.1.1.1.1.1.3"><times id="alg3.l23.m1.2.2.1.1.1.1.1.3.1.cmml" xref="alg3.l23.m1.2.2.1.1.1.1.1.3.1"></times><ci id="alg3.l23.m1.2.2.1.1.1.1.1.3.2.cmml" xref="alg3.l23.m1.2.2.1.1.1.1.1.3.2">𝑐</ci><ci id="alg3.l23.m1.2.2.1.1.1.1.1.3.3.cmml" xref="alg3.l23.m1.2.2.1.1.1.1.1.3.3">𝑗</ci></apply></apply><ci id="alg3.l23.m1.1.1a.cmml" xref="alg3.l23.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg3.l23.m1.1.1.cmml" xref="alg3.l23.m1.1.1">context_clips_indices</mtext></ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l23.m1.2c">\mathcal{D}_{train}\leftarrow\mathcal{D}_{train}+\texttt{select\_by\_index}(V_{cj},\texttt{context\_clips\_indices})</annotation></semantics></math>

</div>
<div id="alg3.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24:</span>              <span id="alg3.l24.1" class="ltx_text ltx_font_bold">end</span> <span id="alg3.l24.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg3.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25:</span>              <span id="alg3.l25.1" class="ltx_text ltx_font_bold">for</span> <math id="alg3.l25.m1.2" class="ltx_Math" alttext="j\leftarrow\texttt{diff}(\texttt{range}(n_{c}),\texttt{context\_videos\_indices})" display="inline"><semantics id="alg3.l25.m1.2a"><mrow id="alg3.l25.m1.2.2" xref="alg3.l25.m1.2.2.cmml"><mi id="alg3.l25.m1.2.2.3" xref="alg3.l25.m1.2.2.3.cmml">j</mi><mo stretchy="false" id="alg3.l25.m1.2.2.2" xref="alg3.l25.m1.2.2.2.cmml">←</mo><mrow id="alg3.l25.m1.2.2.1" xref="alg3.l25.m1.2.2.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l25.m1.2.2.1.3" xref="alg3.l25.m1.2.2.1.3a.cmml">diff</mtext><mo lspace="0em" rspace="0em" id="alg3.l25.m1.2.2.1.2" xref="alg3.l25.m1.2.2.1.2.cmml">​</mo><mrow id="alg3.l25.m1.2.2.1.1.1" xref="alg3.l25.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg3.l25.m1.2.2.1.1.1.2" xref="alg3.l25.m1.2.2.1.1.2.cmml">(</mo><mrow id="alg3.l25.m1.2.2.1.1.1.1" xref="alg3.l25.m1.2.2.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg3.l25.m1.2.2.1.1.1.1.3" xref="alg3.l25.m1.2.2.1.1.1.1.3a.cmml">range</mtext><mo lspace="0em" rspace="0em" id="alg3.l25.m1.2.2.1.1.1.1.2" xref="alg3.l25.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="alg3.l25.m1.2.2.1.1.1.1.1.1" xref="alg3.l25.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l25.m1.2.2.1.1.1.1.1.1.2" xref="alg3.l25.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg3.l25.m1.2.2.1.1.1.1.1.1.1" xref="alg3.l25.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg3.l25.m1.2.2.1.1.1.1.1.1.1.2" xref="alg3.l25.m1.2.2.1.1.1.1.1.1.1.2.cmml">n</mi><mi id="alg3.l25.m1.2.2.1.1.1.1.1.1.1.3" xref="alg3.l25.m1.2.2.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="alg3.l25.m1.2.2.1.1.1.1.1.1.3" xref="alg3.l25.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l25.m1.2.2.1.1.1.3" xref="alg3.l25.m1.2.2.1.1.2.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg3.l25.m1.1.1" xref="alg3.l25.m1.1.1a.cmml">context_videos_indices</mtext><mo stretchy="false" id="alg3.l25.m1.2.2.1.1.1.4" xref="alg3.l25.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l25.m1.2b"><apply id="alg3.l25.m1.2.2.cmml" xref="alg3.l25.m1.2.2"><ci id="alg3.l25.m1.2.2.2.cmml" xref="alg3.l25.m1.2.2.2">←</ci><ci id="alg3.l25.m1.2.2.3.cmml" xref="alg3.l25.m1.2.2.3">𝑗</ci><apply id="alg3.l25.m1.2.2.1.cmml" xref="alg3.l25.m1.2.2.1"><times id="alg3.l25.m1.2.2.1.2.cmml" xref="alg3.l25.m1.2.2.1.2"></times><ci id="alg3.l25.m1.2.2.1.3a.cmml" xref="alg3.l25.m1.2.2.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l25.m1.2.2.1.3.cmml" xref="alg3.l25.m1.2.2.1.3">diff</mtext></ci><interval closure="open" id="alg3.l25.m1.2.2.1.1.2.cmml" xref="alg3.l25.m1.2.2.1.1.1"><apply id="alg3.l25.m1.2.2.1.1.1.1.cmml" xref="alg3.l25.m1.2.2.1.1.1.1"><times id="alg3.l25.m1.2.2.1.1.1.1.2.cmml" xref="alg3.l25.m1.2.2.1.1.1.1.2"></times><ci id="alg3.l25.m1.2.2.1.1.1.1.3a.cmml" xref="alg3.l25.m1.2.2.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg3.l25.m1.2.2.1.1.1.1.3.cmml" xref="alg3.l25.m1.2.2.1.1.1.1.3">range</mtext></ci><apply id="alg3.l25.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg3.l25.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l25.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg3.l25.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l25.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg3.l25.m1.2.2.1.1.1.1.1.1.1.2">𝑛</ci><ci id="alg3.l25.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg3.l25.m1.2.2.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><ci id="alg3.l25.m1.1.1a.cmml" xref="alg3.l25.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg3.l25.m1.1.1.cmml" xref="alg3.l25.m1.1.1">context_videos_indices</mtext></ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l25.m1.2c">j\leftarrow\texttt{diff}(\texttt{range}(n_{c}),\texttt{context\_videos\_indices})</annotation></semantics></math> <span id="alg3.l25.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg3.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26:</span>                  <math id="alg3.l26.m1.1" class="ltx_Math" alttext="\mathcal{D}_{test}\leftarrow\mathcal{D}_{test}+V_{cj}" display="inline"><semantics id="alg3.l26.m1.1a"><mrow id="alg3.l26.m1.1.1" xref="alg3.l26.m1.1.1.cmml"><msub id="alg3.l26.m1.1.1.2" xref="alg3.l26.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l26.m1.1.1.2.2" xref="alg3.l26.m1.1.1.2.2.cmml">𝒟</mi><mrow id="alg3.l26.m1.1.1.2.3" xref="alg3.l26.m1.1.1.2.3.cmml"><mi id="alg3.l26.m1.1.1.2.3.2" xref="alg3.l26.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l26.m1.1.1.2.3.1" xref="alg3.l26.m1.1.1.2.3.1.cmml">​</mo><mi id="alg3.l26.m1.1.1.2.3.3" xref="alg3.l26.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg3.l26.m1.1.1.2.3.1a" xref="alg3.l26.m1.1.1.2.3.1.cmml">​</mo><mi id="alg3.l26.m1.1.1.2.3.4" xref="alg3.l26.m1.1.1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg3.l26.m1.1.1.2.3.1b" xref="alg3.l26.m1.1.1.2.3.1.cmml">​</mo><mi id="alg3.l26.m1.1.1.2.3.5" xref="alg3.l26.m1.1.1.2.3.5.cmml">t</mi></mrow></msub><mo stretchy="false" id="alg3.l26.m1.1.1.1" xref="alg3.l26.m1.1.1.1.cmml">←</mo><mrow id="alg3.l26.m1.1.1.3" xref="alg3.l26.m1.1.1.3.cmml"><msub id="alg3.l26.m1.1.1.3.2" xref="alg3.l26.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l26.m1.1.1.3.2.2" xref="alg3.l26.m1.1.1.3.2.2.cmml">𝒟</mi><mrow id="alg3.l26.m1.1.1.3.2.3" xref="alg3.l26.m1.1.1.3.2.3.cmml"><mi id="alg3.l26.m1.1.1.3.2.3.2" xref="alg3.l26.m1.1.1.3.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l26.m1.1.1.3.2.3.1" xref="alg3.l26.m1.1.1.3.2.3.1.cmml">​</mo><mi id="alg3.l26.m1.1.1.3.2.3.3" xref="alg3.l26.m1.1.1.3.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg3.l26.m1.1.1.3.2.3.1a" xref="alg3.l26.m1.1.1.3.2.3.1.cmml">​</mo><mi id="alg3.l26.m1.1.1.3.2.3.4" xref="alg3.l26.m1.1.1.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg3.l26.m1.1.1.3.2.3.1b" xref="alg3.l26.m1.1.1.3.2.3.1.cmml">​</mo><mi id="alg3.l26.m1.1.1.3.2.3.5" xref="alg3.l26.m1.1.1.3.2.3.5.cmml">t</mi></mrow></msub><mo id="alg3.l26.m1.1.1.3.1" xref="alg3.l26.m1.1.1.3.1.cmml">+</mo><msub id="alg3.l26.m1.1.1.3.3" xref="alg3.l26.m1.1.1.3.3.cmml"><mi id="alg3.l26.m1.1.1.3.3.2" xref="alg3.l26.m1.1.1.3.3.2.cmml">V</mi><mrow id="alg3.l26.m1.1.1.3.3.3" xref="alg3.l26.m1.1.1.3.3.3.cmml"><mi id="alg3.l26.m1.1.1.3.3.3.2" xref="alg3.l26.m1.1.1.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l26.m1.1.1.3.3.3.1" xref="alg3.l26.m1.1.1.3.3.3.1.cmml">​</mo><mi id="alg3.l26.m1.1.1.3.3.3.3" xref="alg3.l26.m1.1.1.3.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l26.m1.1b"><apply id="alg3.l26.m1.1.1.cmml" xref="alg3.l26.m1.1.1"><ci id="alg3.l26.m1.1.1.1.cmml" xref="alg3.l26.m1.1.1.1">←</ci><apply id="alg3.l26.m1.1.1.2.cmml" xref="alg3.l26.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l26.m1.1.1.2.1.cmml" xref="alg3.l26.m1.1.1.2">subscript</csymbol><ci id="alg3.l26.m1.1.1.2.2.cmml" xref="alg3.l26.m1.1.1.2.2">𝒟</ci><apply id="alg3.l26.m1.1.1.2.3.cmml" xref="alg3.l26.m1.1.1.2.3"><times id="alg3.l26.m1.1.1.2.3.1.cmml" xref="alg3.l26.m1.1.1.2.3.1"></times><ci id="alg3.l26.m1.1.1.2.3.2.cmml" xref="alg3.l26.m1.1.1.2.3.2">𝑡</ci><ci id="alg3.l26.m1.1.1.2.3.3.cmml" xref="alg3.l26.m1.1.1.2.3.3">𝑒</ci><ci id="alg3.l26.m1.1.1.2.3.4.cmml" xref="alg3.l26.m1.1.1.2.3.4">𝑠</ci><ci id="alg3.l26.m1.1.1.2.3.5.cmml" xref="alg3.l26.m1.1.1.2.3.5">𝑡</ci></apply></apply><apply id="alg3.l26.m1.1.1.3.cmml" xref="alg3.l26.m1.1.1.3"><plus id="alg3.l26.m1.1.1.3.1.cmml" xref="alg3.l26.m1.1.1.3.1"></plus><apply id="alg3.l26.m1.1.1.3.2.cmml" xref="alg3.l26.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg3.l26.m1.1.1.3.2.1.cmml" xref="alg3.l26.m1.1.1.3.2">subscript</csymbol><ci id="alg3.l26.m1.1.1.3.2.2.cmml" xref="alg3.l26.m1.1.1.3.2.2">𝒟</ci><apply id="alg3.l26.m1.1.1.3.2.3.cmml" xref="alg3.l26.m1.1.1.3.2.3"><times id="alg3.l26.m1.1.1.3.2.3.1.cmml" xref="alg3.l26.m1.1.1.3.2.3.1"></times><ci id="alg3.l26.m1.1.1.3.2.3.2.cmml" xref="alg3.l26.m1.1.1.3.2.3.2">𝑡</ci><ci id="alg3.l26.m1.1.1.3.2.3.3.cmml" xref="alg3.l26.m1.1.1.3.2.3.3">𝑒</ci><ci id="alg3.l26.m1.1.1.3.2.3.4.cmml" xref="alg3.l26.m1.1.1.3.2.3.4">𝑠</ci><ci id="alg3.l26.m1.1.1.3.2.3.5.cmml" xref="alg3.l26.m1.1.1.3.2.3.5">𝑡</ci></apply></apply><apply id="alg3.l26.m1.1.1.3.3.cmml" xref="alg3.l26.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg3.l26.m1.1.1.3.3.1.cmml" xref="alg3.l26.m1.1.1.3.3">subscript</csymbol><ci id="alg3.l26.m1.1.1.3.3.2.cmml" xref="alg3.l26.m1.1.1.3.3.2">𝑉</ci><apply id="alg3.l26.m1.1.1.3.3.3.cmml" xref="alg3.l26.m1.1.1.3.3.3"><times id="alg3.l26.m1.1.1.3.3.3.1.cmml" xref="alg3.l26.m1.1.1.3.3.3.1"></times><ci id="alg3.l26.m1.1.1.3.3.3.2.cmml" xref="alg3.l26.m1.1.1.3.3.3.2">𝑐</ci><ci id="alg3.l26.m1.1.1.3.3.3.3.cmml" xref="alg3.l26.m1.1.1.3.3.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l26.m1.1c">\mathcal{D}_{test}\leftarrow\mathcal{D}_{test}+V_{cj}</annotation></semantics></math>

</div>
<div id="alg3.l27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27:</span>              <span id="alg3.l27.1" class="ltx_text ltx_font_bold">end</span> <span id="alg3.l27.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg3.l28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28:</span>         <span id="alg3.l28.1" class="ltx_text ltx_font_bold">end</span> <span id="alg3.l28.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg3.l29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29:</span>     <span id="alg3.l29.1" class="ltx_text ltx_font_bold">end</span> <span id="alg3.l29.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg3.l30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30:</span>     <span id="alg3.l30.1" class="ltx_text ltx_font_bold">return</span> <math id="alg3.l30.m1.1" class="ltx_Math" alttext="\mathcal{D}_{train}" display="inline"><semantics id="alg3.l30.m1.1a"><msub id="alg3.l30.m1.1.1" xref="alg3.l30.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l30.m1.1.1.2" xref="alg3.l30.m1.1.1.2.cmml">𝒟</mi><mrow id="alg3.l30.m1.1.1.3" xref="alg3.l30.m1.1.1.3.cmml"><mi id="alg3.l30.m1.1.1.3.2" xref="alg3.l30.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l30.m1.1.1.3.1" xref="alg3.l30.m1.1.1.3.1.cmml">​</mo><mi id="alg3.l30.m1.1.1.3.3" xref="alg3.l30.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg3.l30.m1.1.1.3.1a" xref="alg3.l30.m1.1.1.3.1.cmml">​</mo><mi id="alg3.l30.m1.1.1.3.4" xref="alg3.l30.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg3.l30.m1.1.1.3.1b" xref="alg3.l30.m1.1.1.3.1.cmml">​</mo><mi id="alg3.l30.m1.1.1.3.5" xref="alg3.l30.m1.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg3.l30.m1.1.1.3.1c" xref="alg3.l30.m1.1.1.3.1.cmml">​</mo><mi id="alg3.l30.m1.1.1.3.6" xref="alg3.l30.m1.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg3.l30.m1.1b"><apply id="alg3.l30.m1.1.1.cmml" xref="alg3.l30.m1.1.1"><csymbol cd="ambiguous" id="alg3.l30.m1.1.1.1.cmml" xref="alg3.l30.m1.1.1">subscript</csymbol><ci id="alg3.l30.m1.1.1.2.cmml" xref="alg3.l30.m1.1.1.2">𝒟</ci><apply id="alg3.l30.m1.1.1.3.cmml" xref="alg3.l30.m1.1.1.3"><times id="alg3.l30.m1.1.1.3.1.cmml" xref="alg3.l30.m1.1.1.3.1"></times><ci id="alg3.l30.m1.1.1.3.2.cmml" xref="alg3.l30.m1.1.1.3.2">𝑡</ci><ci id="alg3.l30.m1.1.1.3.3.cmml" xref="alg3.l30.m1.1.1.3.3">𝑟</ci><ci id="alg3.l30.m1.1.1.3.4.cmml" xref="alg3.l30.m1.1.1.3.4">𝑎</ci><ci id="alg3.l30.m1.1.1.3.5.cmml" xref="alg3.l30.m1.1.1.3.5">𝑖</ci><ci id="alg3.l30.m1.1.1.3.6.cmml" xref="alg3.l30.m1.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l30.m1.1c">\mathcal{D}_{train}</annotation></semantics></math>, <math id="alg3.l30.m2.1" class="ltx_Math" alttext="\mathcal{D}_{test}" display="inline"><semantics id="alg3.l30.m2.1a"><msub id="alg3.l30.m2.1.1" xref="alg3.l30.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l30.m2.1.1.2" xref="alg3.l30.m2.1.1.2.cmml">𝒟</mi><mrow id="alg3.l30.m2.1.1.3" xref="alg3.l30.m2.1.1.3.cmml"><mi id="alg3.l30.m2.1.1.3.2" xref="alg3.l30.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l30.m2.1.1.3.1" xref="alg3.l30.m2.1.1.3.1.cmml">​</mo><mi id="alg3.l30.m2.1.1.3.3" xref="alg3.l30.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg3.l30.m2.1.1.3.1a" xref="alg3.l30.m2.1.1.3.1.cmml">​</mo><mi id="alg3.l30.m2.1.1.3.4" xref="alg3.l30.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg3.l30.m2.1.1.3.1b" xref="alg3.l30.m2.1.1.3.1.cmml">​</mo><mi id="alg3.l30.m2.1.1.3.5" xref="alg3.l30.m2.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg3.l30.m2.1b"><apply id="alg3.l30.m2.1.1.cmml" xref="alg3.l30.m2.1.1"><csymbol cd="ambiguous" id="alg3.l30.m2.1.1.1.cmml" xref="alg3.l30.m2.1.1">subscript</csymbol><ci id="alg3.l30.m2.1.1.2.cmml" xref="alg3.l30.m2.1.1.2">𝒟</ci><apply id="alg3.l30.m2.1.1.3.cmml" xref="alg3.l30.m2.1.1.3"><times id="alg3.l30.m2.1.1.3.1.cmml" xref="alg3.l30.m2.1.1.3.1"></times><ci id="alg3.l30.m2.1.1.3.2.cmml" xref="alg3.l30.m2.1.1.3.2">𝑡</ci><ci id="alg3.l30.m2.1.1.3.3.cmml" xref="alg3.l30.m2.1.1.3.3">𝑒</ci><ci id="alg3.l30.m2.1.1.3.4.cmml" xref="alg3.l30.m2.1.1.3.4">𝑠</ci><ci id="alg3.l30.m2.1.1.3.5.cmml" xref="alg3.l30.m2.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l30.m2.1c">\mathcal{D}_{test}</annotation></semantics></math>

</div>
<div id="alg3.l31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31:</span><span id="alg3.l31.1" class="ltx_text ltx_font_bold">end</span> <span id="alg3.l31.2" class="ltx_text ltx_font_bold">procedure</span>
</div>
</div>
</figure>
</section>
<section id="A1.SS11.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.11.3 </span>Federated Learning Experiments</h4>

<div id="A1.SS11.SSS3.p1" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS3.p1.1" class="ltx_p">For each local update a new Adam optimizer is initialized.
In each communication round, <math id="A1.SS11.SSS3.p1.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.SS11.SSS3.p1.1.m1.1a"><mn id="A1.SS11.SSS3.p1.1.m1.1.1" xref="A1.SS11.SSS3.p1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.p1.1.m1.1b"><cn type="integer" id="A1.SS11.SSS3.p1.1.m1.1.1.cmml" xref="A1.SS11.SSS3.p1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.p1.1.m1.1c">5</annotation></semantics></math> clients are randomly chosen for making model updates.
All of the federated learning experiments were carried out on a single NVIDIA A100 GPU with 80GB of memory.
In all experiments we use <span id="A1.SS11.SSS3.p1.1.1" class="ltx_text ltx_font_smallcaps">FiT</span> with the BiT-M-R50x1 <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite> backbone pretrained on the ImageNet-21K <cite class="ltx_cite ltx_citemacro_citep">(Russakovsky et al., <a href="#bib.bib51" title="" class="ltx_ref">2015</a>)</cite> dataset and a ProtoNets head.
We derive all hyperparameters empirically from a small number of runs.</p>
</div>
<section id="A1.SS11.SSS3.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">BiT</h5>

<div id="A1.SS11.SSS3.Px1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS3.Px1.p1.2" class="ltx_p">As the training protocol proposed in BiT cannot be directly applied to the federated learning setting, we simplify it and train the BiT model for <math id="A1.SS11.SSS3.Px1.p1.1.m1.1" class="ltx_Math" alttext="60" display="inline"><semantics id="A1.SS11.SSS3.Px1.p1.1.m1.1a"><mn id="A1.SS11.SSS3.Px1.p1.1.m1.1.1" xref="A1.SS11.SSS3.Px1.p1.1.m1.1.1.cmml">60</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px1.p1.1.m1.1b"><cn type="integer" id="A1.SS11.SSS3.Px1.p1.1.m1.1.1.cmml" xref="A1.SS11.SSS3.Px1.p1.1.m1.1.1">60</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px1.p1.1.m1.1c">60</annotation></semantics></math> communication rounds with a constant learning rate of <math id="A1.SS11.SSS3.Px1.p1.2.m2.1" class="ltx_Math" alttext="0.003" display="inline"><semantics id="A1.SS11.SSS3.Px1.p1.2.m2.1a"><mn id="A1.SS11.SSS3.Px1.p1.2.m2.1.1" xref="A1.SS11.SSS3.Px1.p1.2.m2.1.1.cmml">0.003</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px1.p1.2.m2.1b"><cn type="float" id="A1.SS11.SSS3.Px1.p1.2.m2.1.1.cmml" xref="A1.SS11.SSS3.Px1.p1.2.m2.1.1">0.003</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px1.p1.2.m2.1c">0.003</annotation></semantics></math>.</p>
</div>
</section>
<section id="A1.SS11.SSS3.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">CIFAR100</h5>

<div id="A1.SS11.SSS3.Px2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS3.Px2.p1.14" class="ltx_p">We train all federated learning models with different number of clients and shots per client for <math id="A1.SS11.SSS3.Px2.p1.1.m1.1" class="ltx_Math" alttext="60" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.1.m1.1a"><mn id="A1.SS11.SSS3.Px2.p1.1.m1.1.1" xref="A1.SS11.SSS3.Px2.p1.1.m1.1.1.cmml">60</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.1.m1.1b"><cn type="integer" id="A1.SS11.SSS3.Px2.p1.1.m1.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.1.m1.1.1">60</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.1.m1.1c">60</annotation></semantics></math> communication rounds, with <math id="A1.SS11.SSS3.Px2.p1.2.m2.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.2.m2.1a"><mn id="A1.SS11.SSS3.Px2.p1.2.m2.1.1" xref="A1.SS11.SSS3.Px2.p1.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.2.m2.1b"><cn type="integer" id="A1.SS11.SSS3.Px2.p1.2.m2.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.2.m2.1c">5</annotation></semantics></math> clients per round and <math id="A1.SS11.SSS3.Px2.p1.3.m3.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.3.m3.1a"><mn id="A1.SS11.SSS3.Px2.p1.3.m3.1.1" xref="A1.SS11.SSS3.Px2.p1.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.3.m3.1b"><cn type="integer" id="A1.SS11.SSS3.Px2.p1.3.m3.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.3.m3.1c">10</annotation></semantics></math> update steps per client.
Each client has <math id="A1.SS11.SSS3.Px2.p1.4.m4.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.4.m4.1a"><mn id="A1.SS11.SSS3.Px2.p1.4.m4.1.1" xref="A1.SS11.SSS3.Px2.p1.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.4.m4.1b"><cn type="integer" id="A1.SS11.SSS3.Px2.p1.4.m4.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.4.m4.1c">10</annotation></semantics></math> classes, which are sampled uniformly before the start of training.
In our experiments, we used <math id="A1.SS11.SSS3.Px2.p1.5.m5.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.5.m5.1a"><mn id="A1.SS11.SSS3.Px2.p1.5.m5.1.1" xref="A1.SS11.SSS3.Px2.p1.5.m5.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.5.m5.1b"><cn type="integer" id="A1.SS11.SSS3.Px2.p1.5.m5.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.5.m5.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.5.m5.1c">2</annotation></semantics></math>, <math id="A1.SS11.SSS3.Px2.p1.6.m6.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.6.m6.1a"><mn id="A1.SS11.SSS3.Px2.p1.6.m6.1.1" xref="A1.SS11.SSS3.Px2.p1.6.m6.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.6.m6.1b"><cn type="integer" id="A1.SS11.SSS3.Px2.p1.6.m6.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.6.m6.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.6.m6.1c">5</annotation></semantics></math> or <math id="A1.SS11.SSS3.Px2.p1.7.m7.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.7.m7.1a"><mn id="A1.SS11.SSS3.Px2.p1.7.m7.1.1" xref="A1.SS11.SSS3.Px2.p1.7.m7.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.7.m7.1b"><cn type="integer" id="A1.SS11.SSS3.Px2.p1.7.m7.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.7.m7.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.7.m7.1c">10</annotation></semantics></math> shot per class.
For the global setting, we used the CIFAR100 test split for the global model evaluation.
For the personalized setting, we test each client using the CIFAR100 test split, but using only the classes that a particular client owns.
This results in <math id="A1.SS11.SSS3.Px2.p1.8.m8.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.8.m8.1a"><mn id="A1.SS11.SSS3.Px2.p1.8.m8.1.1" xref="A1.SS11.SSS3.Px2.p1.8.m8.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.8.m8.1b"><cn type="integer" id="A1.SS11.SSS3.Px2.p1.8.m8.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.8.m8.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.8.m8.1c">10</annotation></semantics></math>-class classification task.
We then report the average accuracy across all clients.
We use a learning rate of <math id="A1.SS11.SSS3.Px2.p1.9.m9.1" class="ltx_Math" alttext="0.003" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.9.m9.1a"><mn id="A1.SS11.SSS3.Px2.p1.9.m9.1.1" xref="A1.SS11.SSS3.Px2.p1.9.m9.1.1.cmml">0.003</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.9.m9.1b"><cn type="float" id="A1.SS11.SSS3.Px2.p1.9.m9.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.9.m9.1.1">0.003</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.9.m9.1c">0.003</annotation></semantics></math> at the start of the training, decaying it by <math id="A1.SS11.SSS3.Px2.p1.10.m10.1" class="ltx_Math" alttext="0.3" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.10.m10.1a"><mn id="A1.SS11.SSS3.Px2.p1.10.m10.1.1" xref="A1.SS11.SSS3.Px2.p1.10.m10.1.1.cmml">0.3</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.10.m10.1b"><cn type="float" id="A1.SS11.SSS3.Px2.p1.10.m10.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.10.m10.1.1">0.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.10.m10.1c">0.3</annotation></semantics></math> every <math id="A1.SS11.SSS3.Px2.p1.11.m11.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.11.m11.1a"><mn id="A1.SS11.SSS3.Px2.p1.11.m11.1.1" xref="A1.SS11.SSS3.Px2.p1.11.m11.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.11.m11.1b"><cn type="integer" id="A1.SS11.SSS3.Px2.p1.11.m11.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.11.m11.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.11.m11.1c">20</annotation></semantics></math> communication rounds.
Upper and lower bound baselines for both the global and personalized scenarios were trained for <math id="A1.SS11.SSS3.Px2.p1.12.m12.1" class="ltx_Math" alttext="400" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.12.m12.1a"><mn id="A1.SS11.SSS3.Px2.p1.12.m12.1.1" xref="A1.SS11.SSS3.Px2.p1.12.m12.1.1.cmml">400</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.12.m12.1b"><cn type="integer" id="A1.SS11.SSS3.Px2.p1.12.m12.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.12.m12.1.1">400</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.12.m12.1c">400</annotation></semantics></math> epochs using the Adam optimizer with a constant learning rate of <math id="A1.SS11.SSS3.Px2.p1.13.m13.1" class="ltx_Math" alttext="0.003" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.13.m13.1a"><mn id="A1.SS11.SSS3.Px2.p1.13.m13.1.1" xref="A1.SS11.SSS3.Px2.p1.13.m13.1.1.cmml">0.003</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.13.m13.1b"><cn type="float" id="A1.SS11.SSS3.Px2.p1.13.m13.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.13.m13.1.1">0.003</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.13.m13.1c">0.003</annotation></semantics></math>.
It takes around <math id="A1.SS11.SSS3.Px2.p1.14.m14.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A1.SS11.SSS3.Px2.p1.14.m14.1a"><mn id="A1.SS11.SSS3.Px2.p1.14.m14.1.1" xref="A1.SS11.SSS3.Px2.p1.14.m14.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px2.p1.14.m14.1b"><cn type="integer" id="A1.SS11.SSS3.Px2.p1.14.m14.1.1.cmml" xref="A1.SS11.SSS3.Px2.p1.14.m14.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px2.p1.14.m14.1c">20</annotation></semantics></math> minutes to train federated learning models, with slightly more training time required for the models with a larger number of shots.</p>
</div>
</section>
<section id="A1.SS11.SSS3.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Quickdraw</h5>

<div id="A1.SS11.SSS3.Px3.p1" class="ltx_para ltx_noindent">
<p id="A1.SS11.SSS3.Px3.p1.12" class="ltx_p">Each client has <math id="A1.SS11.SSS3.Px3.p1.1.m1.1" class="ltx_Math" alttext="35" display="inline"><semantics id="A1.SS11.SSS3.Px3.p1.1.m1.1a"><mn id="A1.SS11.SSS3.Px3.p1.1.m1.1.1" xref="A1.SS11.SSS3.Px3.p1.1.m1.1.1.cmml">35</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px3.p1.1.m1.1b"><cn type="integer" id="A1.SS11.SSS3.Px3.p1.1.m1.1.1.cmml" xref="A1.SS11.SSS3.Px3.p1.1.m1.1.1">35</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px3.p1.1.m1.1c">35</annotation></semantics></math> classes, which are sampled uniformly at the start of training.
As there is no pre-defined train/test split for the Quickdraw dataset, we randomly choose <math id="A1.SS11.SSS3.Px3.p1.2.m2.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A1.SS11.SSS3.Px3.p1.2.m2.1a"><mn id="A1.SS11.SSS3.Px3.p1.2.m2.1.1" xref="A1.SS11.SSS3.Px3.p1.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px3.p1.2.m2.1b"><cn type="integer" id="A1.SS11.SSS3.Px3.p1.2.m2.1.1.cmml" xref="A1.SS11.SSS3.Px3.p1.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px3.p1.2.m2.1c">100</annotation></semantics></math> samples from each of the <math id="A1.SS11.SSS3.Px3.p1.3.m3.1" class="ltx_Math" alttext="345" display="inline"><semantics id="A1.SS11.SSS3.Px3.p1.3.m3.1a"><mn id="A1.SS11.SSS3.Px3.p1.3.m3.1.1" xref="A1.SS11.SSS3.Px3.p1.3.m3.1.1.cmml">345</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px3.p1.3.m3.1b"><cn type="integer" id="A1.SS11.SSS3.Px3.p1.3.m3.1.1.cmml" xref="A1.SS11.SSS3.Px3.p1.3.m3.1.1">345</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px3.p1.3.m3.1c">345</annotation></semantics></math> classes and use them for testing.
This test data is then used to test both the personalized and global settings as described in the paragraph above.
We train all federated training models for <math id="A1.SS11.SSS3.Px3.p1.4.m4.1" class="ltx_Math" alttext="120" display="inline"><semantics id="A1.SS11.SSS3.Px3.p1.4.m4.1a"><mn id="A1.SS11.SSS3.Px3.p1.4.m4.1.1" xref="A1.SS11.SSS3.Px3.p1.4.m4.1.1.cmml">120</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px3.p1.4.m4.1b"><cn type="integer" id="A1.SS11.SSS3.Px3.p1.4.m4.1.1.cmml" xref="A1.SS11.SSS3.Px3.p1.4.m4.1.1">120</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px3.p1.4.m4.1c">120</annotation></semantics></math> communication rounds, with <math id="A1.SS11.SSS3.Px3.p1.5.m5.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.SS11.SSS3.Px3.p1.5.m5.1a"><mn id="A1.SS11.SSS3.Px3.p1.5.m5.1.1" xref="A1.SS11.SSS3.Px3.p1.5.m5.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px3.p1.5.m5.1b"><cn type="integer" id="A1.SS11.SSS3.Px3.p1.5.m5.1.1.cmml" xref="A1.SS11.SSS3.Px3.p1.5.m5.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px3.p1.5.m5.1c">5</annotation></semantics></math> clients per round, and <math id="A1.SS11.SSS3.Px3.p1.6.m6.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A1.SS11.SSS3.Px3.p1.6.m6.1a"><mn id="A1.SS11.SSS3.Px3.p1.6.m6.1.1" xref="A1.SS11.SSS3.Px3.p1.6.m6.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px3.p1.6.m6.1b"><cn type="integer" id="A1.SS11.SSS3.Px3.p1.6.m6.1.1.cmml" xref="A1.SS11.SSS3.Px3.p1.6.m6.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px3.p1.6.m6.1c">10</annotation></semantics></math> update steps per client.
We use a constant learning rate of <math id="A1.SS11.SSS3.Px3.p1.7.m7.1" class="ltx_Math" alttext="0.006" display="inline"><semantics id="A1.SS11.SSS3.Px3.p1.7.m7.1a"><mn id="A1.SS11.SSS3.Px3.p1.7.m7.1.1" xref="A1.SS11.SSS3.Px3.p1.7.m7.1.1.cmml">0.006</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px3.p1.7.m7.1b"><cn type="float" id="A1.SS11.SSS3.Px3.p1.7.m7.1.1.cmml" xref="A1.SS11.SSS3.Px3.p1.7.m7.1.1">0.006</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px3.p1.7.m7.1c">0.006</annotation></semantics></math> for training all federated learning models.
Upper bound baseline models, which require training a global model using all available data, were trained for <math id="A1.SS11.SSS3.Px3.p1.8.m8.1" class="ltx_Math" alttext="3000" display="inline"><semantics id="A1.SS11.SSS3.Px3.p1.8.m8.1a"><mn id="A1.SS11.SSS3.Px3.p1.8.m8.1.1" xref="A1.SS11.SSS3.Px3.p1.8.m8.1.1.cmml">3000</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px3.p1.8.m8.1b"><cn type="integer" id="A1.SS11.SSS3.Px3.p1.8.m8.1.1.cmml" xref="A1.SS11.SSS3.Px3.p1.8.m8.1.1">3000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px3.p1.8.m8.1c">3000</annotation></semantics></math> steps using the Adam optimizer with a constant learning rate of <math id="A1.SS11.SSS3.Px3.p1.9.m9.1" class="ltx_Math" alttext="0.006" display="inline"><semantics id="A1.SS11.SSS3.Px3.p1.9.m9.1a"><mn id="A1.SS11.SSS3.Px3.p1.9.m9.1.1" xref="A1.SS11.SSS3.Px3.p1.9.m9.1.1.cmml">0.006</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px3.p1.9.m9.1b"><cn type="float" id="A1.SS11.SSS3.Px3.p1.9.m9.1.1.cmml" xref="A1.SS11.SSS3.Px3.p1.9.m9.1.1">0.006</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px3.p1.9.m9.1c">0.006</annotation></semantics></math>.
Lower baseline models, requiring training a personalized model for each individual, were trained for <math id="A1.SS11.SSS3.Px3.p1.10.m10.1" class="ltx_Math" alttext="400" display="inline"><semantics id="A1.SS11.SSS3.Px3.p1.10.m10.1a"><mn id="A1.SS11.SSS3.Px3.p1.10.m10.1.1" xref="A1.SS11.SSS3.Px3.p1.10.m10.1.1.cmml">400</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px3.p1.10.m10.1b"><cn type="integer" id="A1.SS11.SSS3.Px3.p1.10.m10.1.1.cmml" xref="A1.SS11.SSS3.Px3.p1.10.m10.1.1">400</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px3.p1.10.m10.1c">400</annotation></semantics></math> steps using the Adam optimizer with a learning rate of <math id="A1.SS11.SSS3.Px3.p1.11.m11.1" class="ltx_Math" alttext="0.006" display="inline"><semantics id="A1.SS11.SSS3.Px3.p1.11.m11.1a"><mn id="A1.SS11.SSS3.Px3.p1.11.m11.1.1" xref="A1.SS11.SSS3.Px3.p1.11.m11.1.1.cmml">0.006</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px3.p1.11.m11.1b"><cn type="float" id="A1.SS11.SSS3.Px3.p1.11.m11.1.1.cmml" xref="A1.SS11.SSS3.Px3.p1.11.m11.1.1">0.006</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px3.p1.11.m11.1c">0.006</annotation></semantics></math>.
It takes around <math id="A1.SS11.SSS3.Px3.p1.12.m12.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A1.SS11.SSS3.Px3.p1.12.m12.1a"><mn id="A1.SS11.SSS3.Px3.p1.12.m12.1.1" xref="A1.SS11.SSS3.Px3.p1.12.m12.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A1.SS11.SSS3.Px3.p1.12.m12.1b"><cn type="integer" id="A1.SS11.SSS3.Px3.p1.12.m12.1.1.cmml" xref="A1.SS11.SSS3.Px3.p1.12.m12.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS11.SSS3.Px3.p1.12.m12.1c">2</annotation></semantics></math> hours to train federated learning models, with slightly more training time required for the models with a larger number of shots.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2206.08669" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2206.08671" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2206.08671">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2206.08671" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2206.08672" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Mar 11 17:30:40 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
