<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Drawf</title>
<!--Generated on Fri Jun 28 14:32:45 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.17032v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S1" title="In Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S2" title="In Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Definition of the problem</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S3" title="In Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Literature Review</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S3.SS1" title="In 3 Literature Review ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>General Overview of Explainability Approaches in Deep Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S3.SS2" title="In 3 Literature Review ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Explanation by Saliency</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S3.SS3" title="In 3 Literature Review ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Explanation by Feature Attribution</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S3.SS4" title="In 3 Literature Review ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Explanation by Text</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S3.SS5" title="In 3 Literature Review ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Explanation by Examples</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S4" title="In Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Datasets</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S4.SS1" title="In 4 Datasets ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>ChestX-Det Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S4.SS2" title="In 4 Datasets ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>CheXlocalize Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S4.SS3" title="In 4 Datasets ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Vindr-CXR Dataset</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S5" title="In Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S5.SS1" title="In 5 Method ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Construction of amendments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S5.SS2" title="In 5 Method ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Network Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S5.SS3" title="In 5 Method ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Finding-related Attention Map Refinement Network</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S5.SS4" title="In 5 Method ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Cyclic Training for Finding-Specific Knowledge Accumulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S5.SS5" title="In 5 Method ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Distill information to classification model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S5.SS6" title="In 5 Method ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.6 </span>Losses and network initialization</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S5.SS6.SSS1" title="In 5.6 Losses and network initialization ‣ 5 Method ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.6.1 </span>Loss</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S5.SS6.SSS2" title="In 5.6 Losses and network initialization ‣ 5 Method ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.6.2 </span>network parameters’ initialization</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S6" title="In Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Training Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S7" title="In Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S7.SS1" title="In 7 Evaluation ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.1 </span>Segmentation Metrics (Grounding Metrics)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S7.SS1.SSS1" title="In 7.1 Segmentation Metrics (Grounding Metrics) ‣ 7 Evaluation ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.1.1 </span>Dice Coefficient</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S7.SS1.SSS2" title="In 7.1 Segmentation Metrics (Grounding Metrics) ‣ 7 Evaluation ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.1.2 </span>Hit-rate Metric</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S7.SS2" title="In 7 Evaluation ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2 </span>Classification Metrics</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S7.SS2.SSS1" title="In 7.2 Classification Metrics ‣ 7 Evaluation ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2.1 </span>AUC (Area Under the Curve)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S7.SS2.SSS2" title="In 7.2 Classification Metrics ‣ 7 Evaluation ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2.2 </span>MCC (Matthews Correlation Coefficient)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S7.SS2.SSS3" title="In 7.2 Classification Metrics ‣ 7 Evaluation ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2.3 </span>F1 Score</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S8" title="In Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S8.SS1" title="In 8 Results ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.1 </span>Finding specific grounding experts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S8.SS2" title="In 8 Results ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.2 </span>Ablations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S8.SS3" title="In 8 Results ‣ Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.3 </span>Qualitative Result</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S9" title="In Drawf"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">9 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line" lang="en">
<h1 class="ltx_title ltx_title_document">Drawf</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Haozhe Luo
</span></span>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The importance of interpretability in medical imaging stems from the critical need for transparency and trust in healthcare applications of AI. Historically, medical imaging analysis focused primarily on accuracy, but as AI integration has grown, so has the emphasis on understandable and explainable AI systems. This evolution addresses the inherent complexities of medical data, potential risks of misdiagnosis, and ethical concerns. Current challenges include achieving a balance between interpretability and accuracy, handling diverse and intricate medical datasets, and navigating the legal and ethical ramifications of AI deployment in medical settings. The advancement of explainable AI (XAI) aims to render AI decision-making processes in medical imaging more comprehensible, promoting reliability and enabling healthcare professionals to effectively integrate AI tools into clinical practice. Current XAI methods interpret the output of the model through different means. However, due to the uncertainty and complexity of the patterns learned by deep learning itself, it is difficult to translate them into an intuitive interpretation for the user. In this work, we address the ”human out of the loop” and ”trustworthiness” issue in medical image analysis for interpretability. We incorporate medical professionals into the loop, utilizing their insights to enhance interpretability maps, aiming to align deep learning explanations more closely with medical intuition. This approach improves the relevance and utility of deep learning interpretations in medical diagnostics by leveraging expert feedback.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Definition of the problem</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">The goal is to optimize a multi-label classification model in medical imaging, incorporating the use of cross-attention feature maps to enhance interpretability. The optimization problem can be formulated as follows:</p>
</div>
<div class="ltx_para" id="S2.p2">
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\theta}\mathcal{L}_{total}(\theta)=\mathcal{L}_{cls}(\theta)+(1-\lambda)%
\mathcal{L}_{atten}(\theta)" class="ltx_Math" display="block" id="S2.E1.m1.4"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml"><mrow id="S2.E1.m1.4.4.3" xref="S2.E1.m1.4.4.3.cmml"><mrow id="S2.E1.m1.4.4.3.2" xref="S2.E1.m1.4.4.3.2.cmml"><munder id="S2.E1.m1.4.4.3.2.1" xref="S2.E1.m1.4.4.3.2.1.cmml"><mi id="S2.E1.m1.4.4.3.2.1.2" xref="S2.E1.m1.4.4.3.2.1.2.cmml">min</mi><mi id="S2.E1.m1.4.4.3.2.1.3" xref="S2.E1.m1.4.4.3.2.1.3.cmml">θ</mi></munder><mo id="S2.E1.m1.4.4.3.2a" lspace="0.167em" xref="S2.E1.m1.4.4.3.2.cmml">⁡</mo><msub id="S2.E1.m1.4.4.3.2.2" xref="S2.E1.m1.4.4.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.4.4.3.2.2.2" xref="S2.E1.m1.4.4.3.2.2.2.cmml">ℒ</mi><mrow id="S2.E1.m1.4.4.3.2.2.3" xref="S2.E1.m1.4.4.3.2.2.3.cmml"><mi id="S2.E1.m1.4.4.3.2.2.3.2" xref="S2.E1.m1.4.4.3.2.2.3.2.cmml">t</mi><mo id="S2.E1.m1.4.4.3.2.2.3.1" xref="S2.E1.m1.4.4.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.4.4.3.2.2.3.3" xref="S2.E1.m1.4.4.3.2.2.3.3.cmml">o</mi><mo id="S2.E1.m1.4.4.3.2.2.3.1a" xref="S2.E1.m1.4.4.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.4.4.3.2.2.3.4" xref="S2.E1.m1.4.4.3.2.2.3.4.cmml">t</mi><mo id="S2.E1.m1.4.4.3.2.2.3.1b" xref="S2.E1.m1.4.4.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.4.4.3.2.2.3.5" xref="S2.E1.m1.4.4.3.2.2.3.5.cmml">a</mi><mo id="S2.E1.m1.4.4.3.2.2.3.1c" xref="S2.E1.m1.4.4.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.4.4.3.2.2.3.6" xref="S2.E1.m1.4.4.3.2.2.3.6.cmml">l</mi></mrow></msub></mrow><mo id="S2.E1.m1.4.4.3.1" xref="S2.E1.m1.4.4.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.3.3.2" xref="S2.E1.m1.4.4.3.cmml"><mo id="S2.E1.m1.4.4.3.3.2.1" stretchy="false" xref="S2.E1.m1.4.4.3.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">θ</mi><mo id="S2.E1.m1.4.4.3.3.2.2" stretchy="false" xref="S2.E1.m1.4.4.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.4.4.2" xref="S2.E1.m1.4.4.2.cmml">=</mo><mrow id="S2.E1.m1.4.4.1" xref="S2.E1.m1.4.4.1.cmml"><mrow id="S2.E1.m1.4.4.1.3" xref="S2.E1.m1.4.4.1.3.cmml"><msub id="S2.E1.m1.4.4.1.3.2" xref="S2.E1.m1.4.4.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.4.4.1.3.2.2" xref="S2.E1.m1.4.4.1.3.2.2.cmml">ℒ</mi><mrow id="S2.E1.m1.4.4.1.3.2.3" xref="S2.E1.m1.4.4.1.3.2.3.cmml"><mi id="S2.E1.m1.4.4.1.3.2.3.2" xref="S2.E1.m1.4.4.1.3.2.3.2.cmml">c</mi><mo id="S2.E1.m1.4.4.1.3.2.3.1" xref="S2.E1.m1.4.4.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.4.4.1.3.2.3.3" xref="S2.E1.m1.4.4.1.3.2.3.3.cmml">l</mi><mo id="S2.E1.m1.4.4.1.3.2.3.1a" xref="S2.E1.m1.4.4.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.4.4.1.3.2.3.4" xref="S2.E1.m1.4.4.1.3.2.3.4.cmml">s</mi></mrow></msub><mo id="S2.E1.m1.4.4.1.3.1" xref="S2.E1.m1.4.4.1.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.1.3.3.2" xref="S2.E1.m1.4.4.1.3.cmml"><mo id="S2.E1.m1.4.4.1.3.3.2.1" stretchy="false" xref="S2.E1.m1.4.4.1.3.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">θ</mi><mo id="S2.E1.m1.4.4.1.3.3.2.2" stretchy="false" xref="S2.E1.m1.4.4.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.4.4.1.2" xref="S2.E1.m1.4.4.1.2.cmml">+</mo><mrow id="S2.E1.m1.4.4.1.1" xref="S2.E1.m1.4.4.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.cmml"><mo id="S2.E1.m1.4.4.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.4.4.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.cmml"><mn id="S2.E1.m1.4.4.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E1.m1.4.4.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E1.m1.4.4.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.3.cmml">λ</mi></mrow><mo id="S2.E1.m1.4.4.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E1.m1.4.4.1.1.2" xref="S2.E1.m1.4.4.1.1.2.cmml">⁢</mo><msub id="S2.E1.m1.4.4.1.1.3" xref="S2.E1.m1.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.4.4.1.1.3.2" xref="S2.E1.m1.4.4.1.1.3.2.cmml">ℒ</mi><mrow id="S2.E1.m1.4.4.1.1.3.3" xref="S2.E1.m1.4.4.1.1.3.3.cmml"><mi id="S2.E1.m1.4.4.1.1.3.3.2" xref="S2.E1.m1.4.4.1.1.3.3.2.cmml">a</mi><mo id="S2.E1.m1.4.4.1.1.3.3.1" xref="S2.E1.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E1.m1.4.4.1.1.3.3.3" xref="S2.E1.m1.4.4.1.1.3.3.3.cmml">t</mi><mo id="S2.E1.m1.4.4.1.1.3.3.1a" xref="S2.E1.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E1.m1.4.4.1.1.3.3.4" xref="S2.E1.m1.4.4.1.1.3.3.4.cmml">t</mi><mo id="S2.E1.m1.4.4.1.1.3.3.1b" xref="S2.E1.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E1.m1.4.4.1.1.3.3.5" xref="S2.E1.m1.4.4.1.1.3.3.5.cmml">e</mi><mo id="S2.E1.m1.4.4.1.1.3.3.1c" xref="S2.E1.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E1.m1.4.4.1.1.3.3.6" xref="S2.E1.m1.4.4.1.1.3.3.6.cmml">n</mi></mrow></msub><mo id="S2.E1.m1.4.4.1.1.2a" xref="S2.E1.m1.4.4.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.1.1.4.2" xref="S2.E1.m1.4.4.1.1.cmml"><mo id="S2.E1.m1.4.4.1.1.4.2.1" stretchy="false" xref="S2.E1.m1.4.4.1.1.cmml">(</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">θ</mi><mo id="S2.E1.m1.4.4.1.1.4.2.2" stretchy="false" xref="S2.E1.m1.4.4.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4"><eq id="S2.E1.m1.4.4.2.cmml" xref="S2.E1.m1.4.4.2"></eq><apply id="S2.E1.m1.4.4.3.cmml" xref="S2.E1.m1.4.4.3"><times id="S2.E1.m1.4.4.3.1.cmml" xref="S2.E1.m1.4.4.3.1"></times><apply id="S2.E1.m1.4.4.3.2.cmml" xref="S2.E1.m1.4.4.3.2"><apply id="S2.E1.m1.4.4.3.2.1.cmml" xref="S2.E1.m1.4.4.3.2.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.3.2.1.1.cmml" xref="S2.E1.m1.4.4.3.2.1">subscript</csymbol><min id="S2.E1.m1.4.4.3.2.1.2.cmml" xref="S2.E1.m1.4.4.3.2.1.2"></min><ci id="S2.E1.m1.4.4.3.2.1.3.cmml" xref="S2.E1.m1.4.4.3.2.1.3">𝜃</ci></apply><apply id="S2.E1.m1.4.4.3.2.2.cmml" xref="S2.E1.m1.4.4.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.3.2.2.1.cmml" xref="S2.E1.m1.4.4.3.2.2">subscript</csymbol><ci id="S2.E1.m1.4.4.3.2.2.2.cmml" xref="S2.E1.m1.4.4.3.2.2.2">ℒ</ci><apply id="S2.E1.m1.4.4.3.2.2.3.cmml" xref="S2.E1.m1.4.4.3.2.2.3"><times id="S2.E1.m1.4.4.3.2.2.3.1.cmml" xref="S2.E1.m1.4.4.3.2.2.3.1"></times><ci id="S2.E1.m1.4.4.3.2.2.3.2.cmml" xref="S2.E1.m1.4.4.3.2.2.3.2">𝑡</ci><ci id="S2.E1.m1.4.4.3.2.2.3.3.cmml" xref="S2.E1.m1.4.4.3.2.2.3.3">𝑜</ci><ci id="S2.E1.m1.4.4.3.2.2.3.4.cmml" xref="S2.E1.m1.4.4.3.2.2.3.4">𝑡</ci><ci id="S2.E1.m1.4.4.3.2.2.3.5.cmml" xref="S2.E1.m1.4.4.3.2.2.3.5">𝑎</ci><ci id="S2.E1.m1.4.4.3.2.2.3.6.cmml" xref="S2.E1.m1.4.4.3.2.2.3.6">𝑙</ci></apply></apply></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝜃</ci></apply><apply id="S2.E1.m1.4.4.1.cmml" xref="S2.E1.m1.4.4.1"><plus id="S2.E1.m1.4.4.1.2.cmml" xref="S2.E1.m1.4.4.1.2"></plus><apply id="S2.E1.m1.4.4.1.3.cmml" xref="S2.E1.m1.4.4.1.3"><times id="S2.E1.m1.4.4.1.3.1.cmml" xref="S2.E1.m1.4.4.1.3.1"></times><apply id="S2.E1.m1.4.4.1.3.2.cmml" xref="S2.E1.m1.4.4.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.3.2.1.cmml" xref="S2.E1.m1.4.4.1.3.2">subscript</csymbol><ci id="S2.E1.m1.4.4.1.3.2.2.cmml" xref="S2.E1.m1.4.4.1.3.2.2">ℒ</ci><apply id="S2.E1.m1.4.4.1.3.2.3.cmml" xref="S2.E1.m1.4.4.1.3.2.3"><times id="S2.E1.m1.4.4.1.3.2.3.1.cmml" xref="S2.E1.m1.4.4.1.3.2.3.1"></times><ci id="S2.E1.m1.4.4.1.3.2.3.2.cmml" xref="S2.E1.m1.4.4.1.3.2.3.2">𝑐</ci><ci id="S2.E1.m1.4.4.1.3.2.3.3.cmml" xref="S2.E1.m1.4.4.1.3.2.3.3">𝑙</ci><ci id="S2.E1.m1.4.4.1.3.2.3.4.cmml" xref="S2.E1.m1.4.4.1.3.2.3.4">𝑠</ci></apply></apply><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝜃</ci></apply><apply id="S2.E1.m1.4.4.1.1.cmml" xref="S2.E1.m1.4.4.1.1"><times id="S2.E1.m1.4.4.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.2"></times><apply id="S2.E1.m1.4.4.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1"><minus id="S2.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1"></minus><cn id="S2.E1.m1.4.4.1.1.1.1.1.2.cmml" type="integer" xref="S2.E1.m1.4.4.1.1.1.1.1.2">1</cn><ci id="S2.E1.m1.4.4.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.3">𝜆</ci></apply><apply id="S2.E1.m1.4.4.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.3">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.3.2">ℒ</ci><apply id="S2.E1.m1.4.4.1.1.3.3.cmml" xref="S2.E1.m1.4.4.1.1.3.3"><times id="S2.E1.m1.4.4.1.1.3.3.1.cmml" xref="S2.E1.m1.4.4.1.1.3.3.1"></times><ci id="S2.E1.m1.4.4.1.1.3.3.2.cmml" xref="S2.E1.m1.4.4.1.1.3.3.2">𝑎</ci><ci id="S2.E1.m1.4.4.1.1.3.3.3.cmml" xref="S2.E1.m1.4.4.1.1.3.3.3">𝑡</ci><ci id="S2.E1.m1.4.4.1.1.3.3.4.cmml" xref="S2.E1.m1.4.4.1.1.3.3.4">𝑡</ci><ci id="S2.E1.m1.4.4.1.1.3.3.5.cmml" xref="S2.E1.m1.4.4.1.1.3.3.5">𝑒</ci><ci id="S2.E1.m1.4.4.1.1.3.3.6.cmml" xref="S2.E1.m1.4.4.1.1.3.3.6">𝑛</ci></apply></apply><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">\min_{\theta}\mathcal{L}_{total}(\theta)=\mathcal{L}_{cls}(\theta)+(1-\lambda)%
\mathcal{L}_{atten}(\theta)</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.4d">roman_min start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_t italic_o italic_t italic_a italic_l end_POSTSUBSCRIPT ( italic_θ ) = caligraphic_L start_POSTSUBSCRIPT italic_c italic_l italic_s end_POSTSUBSCRIPT ( italic_θ ) + ( 1 - italic_λ ) caligraphic_L start_POSTSUBSCRIPT italic_a italic_t italic_t italic_e italic_n end_POSTSUBSCRIPT ( italic_θ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">where:</p>
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1"><math alttext="\theta" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.1"><semantics id="S2.I1.i1.p1.1.m1.1a"><mi id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><ci id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.1d">italic_θ</annotation></semantics></math> represents the parameters of the model.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1"><math alttext="\mathcal{L}_{total}(\theta)" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i2.p1.1.m1.1a"><mrow id="S2.I1.i2.p1.1.m1.1.2" xref="S2.I1.i2.p1.1.m1.1.2.cmml"><msub id="S2.I1.i2.p1.1.m1.1.2.2" xref="S2.I1.i2.p1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i2.p1.1.m1.1.2.2.2" xref="S2.I1.i2.p1.1.m1.1.2.2.2.cmml">ℒ</mi><mrow id="S2.I1.i2.p1.1.m1.1.2.2.3" xref="S2.I1.i2.p1.1.m1.1.2.2.3.cmml"><mi id="S2.I1.i2.p1.1.m1.1.2.2.3.2" xref="S2.I1.i2.p1.1.m1.1.2.2.3.2.cmml">t</mi><mo id="S2.I1.i2.p1.1.m1.1.2.2.3.1" xref="S2.I1.i2.p1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.I1.i2.p1.1.m1.1.2.2.3.3" xref="S2.I1.i2.p1.1.m1.1.2.2.3.3.cmml">o</mi><mo id="S2.I1.i2.p1.1.m1.1.2.2.3.1a" xref="S2.I1.i2.p1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.I1.i2.p1.1.m1.1.2.2.3.4" xref="S2.I1.i2.p1.1.m1.1.2.2.3.4.cmml">t</mi><mo id="S2.I1.i2.p1.1.m1.1.2.2.3.1b" xref="S2.I1.i2.p1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.I1.i2.p1.1.m1.1.2.2.3.5" xref="S2.I1.i2.p1.1.m1.1.2.2.3.5.cmml">a</mi><mo id="S2.I1.i2.p1.1.m1.1.2.2.3.1c" xref="S2.I1.i2.p1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.I1.i2.p1.1.m1.1.2.2.3.6" xref="S2.I1.i2.p1.1.m1.1.2.2.3.6.cmml">l</mi></mrow></msub><mo id="S2.I1.i2.p1.1.m1.1.2.1" xref="S2.I1.i2.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.I1.i2.p1.1.m1.1.2.3.2" xref="S2.I1.i2.p1.1.m1.1.2.cmml"><mo id="S2.I1.i2.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S2.I1.i2.p1.1.m1.1.2.cmml">(</mo><mi id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml">θ</mi><mo id="S2.I1.i2.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S2.I1.i2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.2"><times id="S2.I1.i2.p1.1.m1.1.2.1.cmml" xref="S2.I1.i2.p1.1.m1.1.2.1"></times><apply id="S2.I1.i2.p1.1.m1.1.2.2.cmml" xref="S2.I1.i2.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.2.2.1.cmml" xref="S2.I1.i2.p1.1.m1.1.2.2">subscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.2.2.2.cmml" xref="S2.I1.i2.p1.1.m1.1.2.2.2">ℒ</ci><apply id="S2.I1.i2.p1.1.m1.1.2.2.3.cmml" xref="S2.I1.i2.p1.1.m1.1.2.2.3"><times id="S2.I1.i2.p1.1.m1.1.2.2.3.1.cmml" xref="S2.I1.i2.p1.1.m1.1.2.2.3.1"></times><ci id="S2.I1.i2.p1.1.m1.1.2.2.3.2.cmml" xref="S2.I1.i2.p1.1.m1.1.2.2.3.2">𝑡</ci><ci id="S2.I1.i2.p1.1.m1.1.2.2.3.3.cmml" xref="S2.I1.i2.p1.1.m1.1.2.2.3.3">𝑜</ci><ci id="S2.I1.i2.p1.1.m1.1.2.2.3.4.cmml" xref="S2.I1.i2.p1.1.m1.1.2.2.3.4">𝑡</ci><ci id="S2.I1.i2.p1.1.m1.1.2.2.3.5.cmml" xref="S2.I1.i2.p1.1.m1.1.2.2.3.5">𝑎</ci><ci id="S2.I1.i2.p1.1.m1.1.2.2.3.6.cmml" xref="S2.I1.i2.p1.1.m1.1.2.2.3.6">𝑙</ci></apply></apply><ci id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">\mathcal{L}_{total}(\theta)</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_t italic_o italic_t italic_a italic_l end_POSTSUBSCRIPT ( italic_θ )</annotation></semantics></math> is the total loss function to be minimized.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.p1.1"><math alttext="\mathcal{L}_{cls}(\theta)" class="ltx_Math" display="inline" id="S2.I1.i3.p1.1.m1.1"><semantics id="S2.I1.i3.p1.1.m1.1a"><mrow id="S2.I1.i3.p1.1.m1.1.2" xref="S2.I1.i3.p1.1.m1.1.2.cmml"><msub id="S2.I1.i3.p1.1.m1.1.2.2" xref="S2.I1.i3.p1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i3.p1.1.m1.1.2.2.2" xref="S2.I1.i3.p1.1.m1.1.2.2.2.cmml">ℒ</mi><mrow id="S2.I1.i3.p1.1.m1.1.2.2.3" xref="S2.I1.i3.p1.1.m1.1.2.2.3.cmml"><mi id="S2.I1.i3.p1.1.m1.1.2.2.3.2" xref="S2.I1.i3.p1.1.m1.1.2.2.3.2.cmml">c</mi><mo id="S2.I1.i3.p1.1.m1.1.2.2.3.1" xref="S2.I1.i3.p1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.I1.i3.p1.1.m1.1.2.2.3.3" xref="S2.I1.i3.p1.1.m1.1.2.2.3.3.cmml">l</mi><mo id="S2.I1.i3.p1.1.m1.1.2.2.3.1a" xref="S2.I1.i3.p1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.I1.i3.p1.1.m1.1.2.2.3.4" xref="S2.I1.i3.p1.1.m1.1.2.2.3.4.cmml">s</mi></mrow></msub><mo id="S2.I1.i3.p1.1.m1.1.2.1" xref="S2.I1.i3.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.I1.i3.p1.1.m1.1.2.3.2" xref="S2.I1.i3.p1.1.m1.1.2.cmml"><mo id="S2.I1.i3.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S2.I1.i3.p1.1.m1.1.2.cmml">(</mo><mi id="S2.I1.i3.p1.1.m1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.cmml">θ</mi><mo id="S2.I1.i3.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S2.I1.i3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.1.m1.1b"><apply id="S2.I1.i3.p1.1.m1.1.2.cmml" xref="S2.I1.i3.p1.1.m1.1.2"><times id="S2.I1.i3.p1.1.m1.1.2.1.cmml" xref="S2.I1.i3.p1.1.m1.1.2.1"></times><apply id="S2.I1.i3.p1.1.m1.1.2.2.cmml" xref="S2.I1.i3.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.I1.i3.p1.1.m1.1.2.2.1.cmml" xref="S2.I1.i3.p1.1.m1.1.2.2">subscript</csymbol><ci id="S2.I1.i3.p1.1.m1.1.2.2.2.cmml" xref="S2.I1.i3.p1.1.m1.1.2.2.2">ℒ</ci><apply id="S2.I1.i3.p1.1.m1.1.2.2.3.cmml" xref="S2.I1.i3.p1.1.m1.1.2.2.3"><times id="S2.I1.i3.p1.1.m1.1.2.2.3.1.cmml" xref="S2.I1.i3.p1.1.m1.1.2.2.3.1"></times><ci id="S2.I1.i3.p1.1.m1.1.2.2.3.2.cmml" xref="S2.I1.i3.p1.1.m1.1.2.2.3.2">𝑐</ci><ci id="S2.I1.i3.p1.1.m1.1.2.2.3.3.cmml" xref="S2.I1.i3.p1.1.m1.1.2.2.3.3">𝑙</ci><ci id="S2.I1.i3.p1.1.m1.1.2.2.3.4.cmml" xref="S2.I1.i3.p1.1.m1.1.2.2.3.4">𝑠</ci></apply></apply><ci id="S2.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.1.m1.1c">\mathcal{L}_{cls}(\theta)</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_c italic_l italic_s end_POSTSUBSCRIPT ( italic_θ )</annotation></semantics></math> is the loss function associated with the multi-label classification accuracy.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i4.p1">
<p class="ltx_p" id="S2.I1.i4.p1.1"><math alttext="\mathcal{L}_{atten}(\theta)" class="ltx_Math" display="inline" id="S2.I1.i4.p1.1.m1.1"><semantics id="S2.I1.i4.p1.1.m1.1a"><mrow id="S2.I1.i4.p1.1.m1.1.2" xref="S2.I1.i4.p1.1.m1.1.2.cmml"><msub id="S2.I1.i4.p1.1.m1.1.2.2" xref="S2.I1.i4.p1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i4.p1.1.m1.1.2.2.2" xref="S2.I1.i4.p1.1.m1.1.2.2.2.cmml">ℒ</mi><mrow id="S2.I1.i4.p1.1.m1.1.2.2.3" xref="S2.I1.i4.p1.1.m1.1.2.2.3.cmml"><mi id="S2.I1.i4.p1.1.m1.1.2.2.3.2" xref="S2.I1.i4.p1.1.m1.1.2.2.3.2.cmml">a</mi><mo id="S2.I1.i4.p1.1.m1.1.2.2.3.1" xref="S2.I1.i4.p1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.I1.i4.p1.1.m1.1.2.2.3.3" xref="S2.I1.i4.p1.1.m1.1.2.2.3.3.cmml">t</mi><mo id="S2.I1.i4.p1.1.m1.1.2.2.3.1a" xref="S2.I1.i4.p1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.I1.i4.p1.1.m1.1.2.2.3.4" xref="S2.I1.i4.p1.1.m1.1.2.2.3.4.cmml">t</mi><mo id="S2.I1.i4.p1.1.m1.1.2.2.3.1b" xref="S2.I1.i4.p1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.I1.i4.p1.1.m1.1.2.2.3.5" xref="S2.I1.i4.p1.1.m1.1.2.2.3.5.cmml">e</mi><mo id="S2.I1.i4.p1.1.m1.1.2.2.3.1c" xref="S2.I1.i4.p1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.I1.i4.p1.1.m1.1.2.2.3.6" xref="S2.I1.i4.p1.1.m1.1.2.2.3.6.cmml">n</mi></mrow></msub><mo id="S2.I1.i4.p1.1.m1.1.2.1" xref="S2.I1.i4.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.I1.i4.p1.1.m1.1.2.3.2" xref="S2.I1.i4.p1.1.m1.1.2.cmml"><mo id="S2.I1.i4.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S2.I1.i4.p1.1.m1.1.2.cmml">(</mo><mi id="S2.I1.i4.p1.1.m1.1.1" xref="S2.I1.i4.p1.1.m1.1.1.cmml">θ</mi><mo id="S2.I1.i4.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S2.I1.i4.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.1.m1.1b"><apply id="S2.I1.i4.p1.1.m1.1.2.cmml" xref="S2.I1.i4.p1.1.m1.1.2"><times id="S2.I1.i4.p1.1.m1.1.2.1.cmml" xref="S2.I1.i4.p1.1.m1.1.2.1"></times><apply id="S2.I1.i4.p1.1.m1.1.2.2.cmml" xref="S2.I1.i4.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.I1.i4.p1.1.m1.1.2.2.1.cmml" xref="S2.I1.i4.p1.1.m1.1.2.2">subscript</csymbol><ci id="S2.I1.i4.p1.1.m1.1.2.2.2.cmml" xref="S2.I1.i4.p1.1.m1.1.2.2.2">ℒ</ci><apply id="S2.I1.i4.p1.1.m1.1.2.2.3.cmml" xref="S2.I1.i4.p1.1.m1.1.2.2.3"><times id="S2.I1.i4.p1.1.m1.1.2.2.3.1.cmml" xref="S2.I1.i4.p1.1.m1.1.2.2.3.1"></times><ci id="S2.I1.i4.p1.1.m1.1.2.2.3.2.cmml" xref="S2.I1.i4.p1.1.m1.1.2.2.3.2">𝑎</ci><ci id="S2.I1.i4.p1.1.m1.1.2.2.3.3.cmml" xref="S2.I1.i4.p1.1.m1.1.2.2.3.3">𝑡</ci><ci id="S2.I1.i4.p1.1.m1.1.2.2.3.4.cmml" xref="S2.I1.i4.p1.1.m1.1.2.2.3.4">𝑡</ci><ci id="S2.I1.i4.p1.1.m1.1.2.2.3.5.cmml" xref="S2.I1.i4.p1.1.m1.1.2.2.3.5">𝑒</ci><ci id="S2.I1.i4.p1.1.m1.1.2.2.3.6.cmml" xref="S2.I1.i4.p1.1.m1.1.2.2.3.6">𝑛</ci></apply></apply><ci id="S2.I1.i4.p1.1.m1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.1.m1.1c">\mathcal{L}_{atten}(\theta)</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_a italic_t italic_t italic_e italic_n end_POSTSUBSCRIPT ( italic_θ )</annotation></semantics></math> corresponds to the loss function for the interpretability, which measures the effectiveness of the cross-attention feature maps in highlighting relevant features.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i5.p1">
<p class="ltx_p" id="S2.I1.i5.p1.1"><math alttext="\lambda" class="ltx_Math" display="inline" id="S2.I1.i5.p1.1.m1.1"><semantics id="S2.I1.i5.p1.1.m1.1a"><mi id="S2.I1.i5.p1.1.m1.1.1" xref="S2.I1.i5.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.1.m1.1b"><ci id="S2.I1.i5.p1.1.m1.1.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.p1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i5.p1.1.m1.1d">italic_λ</annotation></semantics></math> is a hyperparameter that balances the trade-off between classification accuracy and interpretability.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">The objective is to simultaneously enhance the classification performance and the reliability of the interpretability provided by the cross-attention maps. This involves refining the model’s focus on critical areas in the images, which are significant for accurate diagnosis and transparent decision-making processes.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Literature Review</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>General Overview of Explainability Approaches in Deep Learning</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Explainable Artificial Intelligence (XAI) has emerged as a multifaceted field aimed at illuminating the inner workings of deep learning models. It encompasses a broad spectrum of strategies designed to make neural networks’ decisions transparent, especially in sensitive sectors such as healthcare. Model-agnostic techniques, such as LIME (Local Interpretable Model-agnostic Explanations) <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">ribeiro2016should</span>]</cite> and SHAP (SHapley Additive exPlanations)<cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">walia2022using</span>]</cite>, offer insights independent of model architecture, while model-specific methods delve into the architecture’s internals, like DeepLIFT (Deep Learning Important FeaTures) and layer-wise relevance propagation. Visual tools like Grad-CAM (Gradient-weighted Class Activation Mapping)<cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">selvaraju2017grad</span>]</cite> provide saliency maps to highlight decision-critical regions in image data. Example-based methods, including case-based reasoning<cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">gu2020case</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">duck2022analogy</span>]</cite> and prototype learning<cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">li2021adaptive</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">xu2020attribute</span>]</cite>, offer comparative insights by aligning model decisions with known examples. Collectively, these methods strive to bridge the gap between AI’s complexity and the need for human-intelligible explanations, fostering trust and facilitating model validation and improvement.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Explanation by Saliency</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Explanation by Saliency in deep learning offers a visual approach to decipher complex model decisions<cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">selvaraju2017grad</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">malhi2019explaining</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">rio2020understanding</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">lin2020covid</span>]</cite>, particularly within the realm of medical imaging. The primary strength of this method lies in its ability to produce saliency maps that highlight the areas within the input that significantly influence the model’s output. These visual cues enhance interpretability, allowing for a more intuitive understanding of the model’s focus and considerations. In clinical practice, such explanations can bridge the gap between AI models and human experts, fostering greater trust and collaboration. However, the method is not without its challenges. Saliency maps can sometimes be misinterpreted or might not provide a full explanation for a decision, especially when dealing with the high-dimensional data in medical applications. Additionally, the generation of saliency maps can introduce its own biases or highlight features that, while statistically significant, may lack practical clinical relevance, thus necessitating cautious application and expert oversight.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Explanation by Feature Attribution</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Explanation by Feature Attribution in deep learning is pivotal for understanding complex model decisions<cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">malhi2019explaining</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">eitel2019testing</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2021interpretability</span>]</cite>. Its primary advantage is enhancing interpretability by pinpointing influential features, fostering model transparency and trust, especially in critical healthcare applications. This method demystifies the model’s logic, facilitating clinical validation and offering insights into the model’s learning process. However, it also faces significant challenges. The complexity of medical data can lead to oversimplification in interpretations, potentially omitting critical nuances. Moreover, there’s a risk of bias in feature selection, where the model might focus on features that are not clinically relevant, leading to misleading interpretations<cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">geirhos2020shortcut</span>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Explanation by Text</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Explanation by Text in deep learning<cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang2017mdnet</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2018tienet</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">li2018hybrid</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">gale2019producing</span>]</cite>, especially for medical imaging, plays a crucial role in conveying complex model decisions in an understandable format. Its main advantage lies in its ability to translate intricate data interpretations into readable text, enhancing interpretability and user-friendliness for medical professionals. This approach helps in clarifying the reasoning behind model predictions, making AI tools more transparent and trustworthy in clinical settings. However, it also encounters significant hurdles. The simplification necessary for textual explanations can lead to a loss of detail, potentially overlooking crucial subtleties of medical data<cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">monshi2020deep</span>]</cite>. Furthermore, the reliance on language models raises concerns about the accuracy and relevance of these textual interpretations, which might not always align perfectly with clinical realities or model intricacies.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Explanation by Examples</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">Explanation by Examples in the context of deep learning for medical imaging<cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">tschandl2019diagnostic</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">lamy2019explainable</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">barnett2021interpretable</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">barata2021improving</span>]</cite> is essential for illustrating model decisions through practical demonstrations. Its primary strength lies in offering concrete cases or scenarios where the model’s predictions can be observed and analyzed, providing a tangible and relatable understanding for clinicians. This method helps in contextualizing the AI’s decision-making process, making it more approachable and verifiable in a clinical environment. Nonetheless, this technique faces its own set of challenges. The diversity and complexity of medical cases mean that examples might not always represent the full scope of the model’s capabilities or might focus on atypical scenarios. Additionally, there’s a risk of reinforcing biases if the selected examples are not representative or diverse enough, potentially leading to skewed interpretations and applications.</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.1">This integration of XAI into medical imaging marks a crucial step towards transparent, interpretable AI in healthcare. The following sections explore different methodologies applied to XAI in medical images.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Datasets</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>ChestX-Det Dataset</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">The ChestX-Det dataset is an expertly curated subset of the public NIH ChestX-ray14 dataset, designed specifically to support the development and evaluation of automated diagnostic models in medical imaging, particularly for chest X-rays. This dataset comprises approximately 3,500 high-quality images across 13 common thoracic disease categories. Each image in the dataset has been annotated with instance-level details (both bounding boxes and masks) by three board-certified radiologists to ensure the accuracy and reliability of the annotations. The ChestX-Det dataset is unique in its provision of detailed instance annotations, as opposed to the more common class labels, thereby enabling more precise training and validation of models designed for detailed localization and identification of thoracic diseases in X-ray images. This dataset serves as a critical resource for advancing research in automated chest X-ray analysis by providing a robust benchmark for evaluating the performance of novel diagnostic algorithms.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>CheXlocalize Dataset</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The CheXlocalize dataset serves as a specialized grounding verification subset of the CheXpert dataset, specifically curated for enhancing the validation of localization models in chest X-ray (CXR) interpretation. This dataset includes a subset of CXRs specifically chosen from the CheXpert dataset to focus on the precise localization of thoracic diseases. It comprises detailed annotations that go beyond the typical classification of pathologies, including exact coordinates for disease manifestations.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Vindr-CXR Dataset</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">The Vindr-CXR dataset is designed to support the development and evaluation of diagnostic models for chest X-ray imaging. It includes around 18,000 high-resolution images with detailed annotations for various thoracic conditions. Each image is annotated with bounding boxes and segmentation masks by experienced radiologists, ensuring high accuracy. This dataset is essential for training and validating models that focus on the localization and identification of thoracic pathologies and serves as a benchmark for evaluating the performance of automated chest X-ray analysis algorithms.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Method</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Although the XAI methods mentioned in related work each have their advantages, the significant variability in the features learned by the different model means that the areas of focus during prediction cannot be adequately delineated solely by information from partial layers. Furthermore, due to a lack of prior knowledge about classes, these methods exhibit insensitivity to specific features of different categories. In this section, we introduce a prior-knowledge injected feature map refinement approach capable of enhancing any pre-trained model. By employing a series of fine-tuning steps, this method enables the model to generate more compact, consistent, and precise feature maps for predictions across different classes.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">To enhance clinicians’ focus during the diagnostic process, we utilize annotation maps (bounding boxes or segmentation maps) as auxiliary information. This ensures that our model generates a more compact and accurate attention map, thereby improving clinicians’ confidence in the classification results.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Construction of amendments</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">To better formulate amendments to help training. We define the amendments into 3 parts. The first part is task assignment. To be specific, it’s a prompt like ”Refine saliency map”; The second part is for disease-specific adjustment, we add the specific disease name here to retain the disease related saliency map preference. The third part is the discription. During the training phase, we use the discription created by clinicians mixed with no discription ones(the text input only contains part1 and part2) to train our model. During the inference phase, we use part 1 and part 2 only to refine the saliency map.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">To alleviate the workload of clinical practitioners and generate more impactful prompts, we propose the following amendments to optimize the structure of prompts using ChatGPT:</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">Language Style Modification:</span> Transitioning from a formal to an informal style, or vice versa, to better align with the communication preferences of the target audience.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">Information Quantity Adjustment:</span> Increasing or decreasing the amount of information contained within the prompt to enhance clarity and relevance.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">Structural Alteration:</span> Modifying the prompt’s structure, such as transforming a question into a command, to streamline interaction and comprehension.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.1">Incorporation of Domain-specific Terminology:</span> Adding or modifying key terms related to the specific application scenario to ensure precision and applicability.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1">These strategies aim to refine the efficacy and applicability of prompts in clinical settings, thereby supporting medical professionals in their decision-making processes.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Network Architecture</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.6">The objective of our study is to refine the attention map by learning from disease-specific instances. We introduce a disease-weighted attention map refinement network (Dwarf), which is based on a Vision-Language Model (VLM). The input image, denoted as <math alttext="x" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">italic_x</annotation></semantics></math>, is fed into the image encoder with parameters <math alttext="f_{\theta_{i}}" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><msub id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mi id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml">f</mi><msub id="S5.SS2.p1.2.m2.1.1.3" xref="S5.SS2.p1.2.m2.1.1.3.cmml"><mi id="S5.SS2.p1.2.m2.1.1.3.2" xref="S5.SS2.p1.2.m2.1.1.3.2.cmml">θ</mi><mi id="S5.SS2.p1.2.m2.1.1.3.3" xref="S5.SS2.p1.2.m2.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2">𝑓</ci><apply id="S5.SS2.p1.2.m2.1.1.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.1.1.3.1.cmml" xref="S5.SS2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S5.SS2.p1.2.m2.1.1.3.2.cmml" xref="S5.SS2.p1.2.m2.1.1.3.2">𝜃</ci><ci id="S5.SS2.p1.2.m2.1.1.3.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">f_{\theta_{i}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, resulting in the embedding <math alttext="v^{I}=f_{\theta_{i}}(x)" class="ltx_Math" display="inline" id="S5.SS2.p1.3.m3.1"><semantics id="S5.SS2.p1.3.m3.1a"><mrow id="S5.SS2.p1.3.m3.1.2" xref="S5.SS2.p1.3.m3.1.2.cmml"><msup id="S5.SS2.p1.3.m3.1.2.2" xref="S5.SS2.p1.3.m3.1.2.2.cmml"><mi id="S5.SS2.p1.3.m3.1.2.2.2" xref="S5.SS2.p1.3.m3.1.2.2.2.cmml">v</mi><mi id="S5.SS2.p1.3.m3.1.2.2.3" xref="S5.SS2.p1.3.m3.1.2.2.3.cmml">I</mi></msup><mo id="S5.SS2.p1.3.m3.1.2.1" xref="S5.SS2.p1.3.m3.1.2.1.cmml">=</mo><mrow id="S5.SS2.p1.3.m3.1.2.3" xref="S5.SS2.p1.3.m3.1.2.3.cmml"><msub id="S5.SS2.p1.3.m3.1.2.3.2" xref="S5.SS2.p1.3.m3.1.2.3.2.cmml"><mi id="S5.SS2.p1.3.m3.1.2.3.2.2" xref="S5.SS2.p1.3.m3.1.2.3.2.2.cmml">f</mi><msub id="S5.SS2.p1.3.m3.1.2.3.2.3" xref="S5.SS2.p1.3.m3.1.2.3.2.3.cmml"><mi id="S5.SS2.p1.3.m3.1.2.3.2.3.2" xref="S5.SS2.p1.3.m3.1.2.3.2.3.2.cmml">θ</mi><mi id="S5.SS2.p1.3.m3.1.2.3.2.3.3" xref="S5.SS2.p1.3.m3.1.2.3.2.3.3.cmml">i</mi></msub></msub><mo id="S5.SS2.p1.3.m3.1.2.3.1" xref="S5.SS2.p1.3.m3.1.2.3.1.cmml">⁢</mo><mrow id="S5.SS2.p1.3.m3.1.2.3.3.2" xref="S5.SS2.p1.3.m3.1.2.3.cmml"><mo id="S5.SS2.p1.3.m3.1.2.3.3.2.1" stretchy="false" xref="S5.SS2.p1.3.m3.1.2.3.cmml">(</mo><mi id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml">x</mi><mo id="S5.SS2.p1.3.m3.1.2.3.3.2.2" stretchy="false" xref="S5.SS2.p1.3.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><apply id="S5.SS2.p1.3.m3.1.2.cmml" xref="S5.SS2.p1.3.m3.1.2"><eq id="S5.SS2.p1.3.m3.1.2.1.cmml" xref="S5.SS2.p1.3.m3.1.2.1"></eq><apply id="S5.SS2.p1.3.m3.1.2.2.cmml" xref="S5.SS2.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S5.SS2.p1.3.m3.1.2.2.1.cmml" xref="S5.SS2.p1.3.m3.1.2.2">superscript</csymbol><ci id="S5.SS2.p1.3.m3.1.2.2.2.cmml" xref="S5.SS2.p1.3.m3.1.2.2.2">𝑣</ci><ci id="S5.SS2.p1.3.m3.1.2.2.3.cmml" xref="S5.SS2.p1.3.m3.1.2.2.3">𝐼</ci></apply><apply id="S5.SS2.p1.3.m3.1.2.3.cmml" xref="S5.SS2.p1.3.m3.1.2.3"><times id="S5.SS2.p1.3.m3.1.2.3.1.cmml" xref="S5.SS2.p1.3.m3.1.2.3.1"></times><apply id="S5.SS2.p1.3.m3.1.2.3.2.cmml" xref="S5.SS2.p1.3.m3.1.2.3.2"><csymbol cd="ambiguous" id="S5.SS2.p1.3.m3.1.2.3.2.1.cmml" xref="S5.SS2.p1.3.m3.1.2.3.2">subscript</csymbol><ci id="S5.SS2.p1.3.m3.1.2.3.2.2.cmml" xref="S5.SS2.p1.3.m3.1.2.3.2.2">𝑓</ci><apply id="S5.SS2.p1.3.m3.1.2.3.2.3.cmml" xref="S5.SS2.p1.3.m3.1.2.3.2.3"><csymbol cd="ambiguous" id="S5.SS2.p1.3.m3.1.2.3.2.3.1.cmml" xref="S5.SS2.p1.3.m3.1.2.3.2.3">subscript</csymbol><ci id="S5.SS2.p1.3.m3.1.2.3.2.3.2.cmml" xref="S5.SS2.p1.3.m3.1.2.3.2.3.2">𝜃</ci><ci id="S5.SS2.p1.3.m3.1.2.3.2.3.3.cmml" xref="S5.SS2.p1.3.m3.1.2.3.2.3.3">𝑖</ci></apply></apply><ci id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">v^{I}=f_{\theta_{i}}(x)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.3.m3.1d">italic_v start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT = italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math>. This embedding, along with disease-specific textual information from a frozen text encoder, is processed through cross-attention layers, denoted as <math alttext="\text{CrossAttention}_{\theta_{\text{ca}}}" class="ltx_Math" display="inline" id="S5.SS2.p1.4.m4.1"><semantics id="S5.SS2.p1.4.m4.1a"><msub id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml"><mtext id="S5.SS2.p1.4.m4.1.1.2" xref="S5.SS2.p1.4.m4.1.1.2a.cmml">CrossAttention</mtext><msub id="S5.SS2.p1.4.m4.1.1.3" xref="S5.SS2.p1.4.m4.1.1.3.cmml"><mi id="S5.SS2.p1.4.m4.1.1.3.2" xref="S5.SS2.p1.4.m4.1.1.3.2.cmml">θ</mi><mtext id="S5.SS2.p1.4.m4.1.1.3.3" xref="S5.SS2.p1.4.m4.1.1.3.3a.cmml">ca</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><apply id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS2.p1.4.m4.1.1.2a.cmml" xref="S5.SS2.p1.4.m4.1.1.2"><mtext id="S5.SS2.p1.4.m4.1.1.2.cmml" xref="S5.SS2.p1.4.m4.1.1.2">CrossAttention</mtext></ci><apply id="S5.SS2.p1.4.m4.1.1.3.cmml" xref="S5.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.1.1.3.1.cmml" xref="S5.SS2.p1.4.m4.1.1.3">subscript</csymbol><ci id="S5.SS2.p1.4.m4.1.1.3.2.cmml" xref="S5.SS2.p1.4.m4.1.1.3.2">𝜃</ci><ci id="S5.SS2.p1.4.m4.1.1.3.3a.cmml" xref="S5.SS2.p1.4.m4.1.1.3.3"><mtext id="S5.SS2.p1.4.m4.1.1.3.3.cmml" mathsize="50%" xref="S5.SS2.p1.4.m4.1.1.3.3">ca</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">\text{CrossAttention}_{\theta_{\text{ca}}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.4.m4.1d">CrossAttention start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT ca end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>. Specifically, we use the embedding <math alttext="e_{M_{c}}" class="ltx_Math" display="inline" id="S5.SS2.p1.5.m5.1"><semantics id="S5.SS2.p1.5.m5.1a"><msub id="S5.SS2.p1.5.m5.1.1" xref="S5.SS2.p1.5.m5.1.1.cmml"><mi id="S5.SS2.p1.5.m5.1.1.2" xref="S5.SS2.p1.5.m5.1.1.2.cmml">e</mi><msub id="S5.SS2.p1.5.m5.1.1.3" xref="S5.SS2.p1.5.m5.1.1.3.cmml"><mi id="S5.SS2.p1.5.m5.1.1.3.2" xref="S5.SS2.p1.5.m5.1.1.3.2.cmml">M</mi><mi id="S5.SS2.p1.5.m5.1.1.3.3" xref="S5.SS2.p1.5.m5.1.1.3.3.cmml">c</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m5.1b"><apply id="S5.SS2.p1.5.m5.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.5.m5.1.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S5.SS2.p1.5.m5.1.1.2.cmml" xref="S5.SS2.p1.5.m5.1.1.2">𝑒</ci><apply id="S5.SS2.p1.5.m5.1.1.3.cmml" xref="S5.SS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p1.5.m5.1.1.3.1.cmml" xref="S5.SS2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S5.SS2.p1.5.m5.1.1.3.2.cmml" xref="S5.SS2.p1.5.m5.1.1.3.2">𝑀</ci><ci id="S5.SS2.p1.5.m5.1.1.3.3.cmml" xref="S5.SS2.p1.5.m5.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m5.1c">e_{M_{c}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.5.m5.1d">italic_e start_POSTSUBSCRIPT italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> from the image as the query and the text embedding <math alttext="e_{t}" class="ltx_Math" display="inline" id="S5.SS2.p1.6.m6.1"><semantics id="S5.SS2.p1.6.m6.1a"><msub id="S5.SS2.p1.6.m6.1.1" xref="S5.SS2.p1.6.m6.1.1.cmml"><mi id="S5.SS2.p1.6.m6.1.1.2" xref="S5.SS2.p1.6.m6.1.1.2.cmml">e</mi><mi id="S5.SS2.p1.6.m6.1.1.3" xref="S5.SS2.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.6.m6.1b"><apply id="S5.SS2.p1.6.m6.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.6.m6.1.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S5.SS2.p1.6.m6.1.1.2.cmml" xref="S5.SS2.p1.6.m6.1.1.2">𝑒</ci><ci id="S5.SS2.p1.6.m6.1.1.3.cmml" xref="S5.SS2.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.6.m6.1c">e_{t}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.6.m6.1d">italic_e start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as the key and value, resulting in the cross-attention output:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="e_{M_{c}t}=\text{CrossAttention}_{\theta_{\text{ca}}}(e_{M_{c}},e_{t})" class="ltx_Math" display="block" id="S5.Ex1.m1.2"><semantics id="S5.Ex1.m1.2a"><mrow id="S5.Ex1.m1.2.2" xref="S5.Ex1.m1.2.2.cmml"><msub id="S5.Ex1.m1.2.2.4" xref="S5.Ex1.m1.2.2.4.cmml"><mi id="S5.Ex1.m1.2.2.4.2" xref="S5.Ex1.m1.2.2.4.2.cmml">e</mi><mrow id="S5.Ex1.m1.2.2.4.3" xref="S5.Ex1.m1.2.2.4.3.cmml"><msub id="S5.Ex1.m1.2.2.4.3.2" xref="S5.Ex1.m1.2.2.4.3.2.cmml"><mi id="S5.Ex1.m1.2.2.4.3.2.2" xref="S5.Ex1.m1.2.2.4.3.2.2.cmml">M</mi><mi id="S5.Ex1.m1.2.2.4.3.2.3" xref="S5.Ex1.m1.2.2.4.3.2.3.cmml">c</mi></msub><mo id="S5.Ex1.m1.2.2.4.3.1" xref="S5.Ex1.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S5.Ex1.m1.2.2.4.3.3" xref="S5.Ex1.m1.2.2.4.3.3.cmml">t</mi></mrow></msub><mo id="S5.Ex1.m1.2.2.3" xref="S5.Ex1.m1.2.2.3.cmml">=</mo><mrow id="S5.Ex1.m1.2.2.2" xref="S5.Ex1.m1.2.2.2.cmml"><msub id="S5.Ex1.m1.2.2.2.4" xref="S5.Ex1.m1.2.2.2.4.cmml"><mtext id="S5.Ex1.m1.2.2.2.4.2" xref="S5.Ex1.m1.2.2.2.4.2a.cmml">CrossAttention</mtext><msub id="S5.Ex1.m1.2.2.2.4.3" xref="S5.Ex1.m1.2.2.2.4.3.cmml"><mi id="S5.Ex1.m1.2.2.2.4.3.2" xref="S5.Ex1.m1.2.2.2.4.3.2.cmml">θ</mi><mtext id="S5.Ex1.m1.2.2.2.4.3.3" xref="S5.Ex1.m1.2.2.2.4.3.3a.cmml">ca</mtext></msub></msub><mo id="S5.Ex1.m1.2.2.2.3" xref="S5.Ex1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S5.Ex1.m1.2.2.2.2.2" xref="S5.Ex1.m1.2.2.2.2.3.cmml"><mo id="S5.Ex1.m1.2.2.2.2.2.3" stretchy="false" xref="S5.Ex1.m1.2.2.2.2.3.cmml">(</mo><msub id="S5.Ex1.m1.1.1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.1.1.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.1.2" xref="S5.Ex1.m1.1.1.1.1.1.1.2.cmml">e</mi><msub id="S5.Ex1.m1.1.1.1.1.1.1.3" xref="S5.Ex1.m1.1.1.1.1.1.1.3.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.1.3.2" xref="S5.Ex1.m1.1.1.1.1.1.1.3.2.cmml">M</mi><mi id="S5.Ex1.m1.1.1.1.1.1.1.3.3" xref="S5.Ex1.m1.1.1.1.1.1.1.3.3.cmml">c</mi></msub></msub><mo id="S5.Ex1.m1.2.2.2.2.2.4" xref="S5.Ex1.m1.2.2.2.2.3.cmml">,</mo><msub id="S5.Ex1.m1.2.2.2.2.2.2" xref="S5.Ex1.m1.2.2.2.2.2.2.cmml"><mi id="S5.Ex1.m1.2.2.2.2.2.2.2" xref="S5.Ex1.m1.2.2.2.2.2.2.2.cmml">e</mi><mi id="S5.Ex1.m1.2.2.2.2.2.2.3" xref="S5.Ex1.m1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S5.Ex1.m1.2.2.2.2.2.5" stretchy="false" xref="S5.Ex1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex1.m1.2b"><apply id="S5.Ex1.m1.2.2.cmml" xref="S5.Ex1.m1.2.2"><eq id="S5.Ex1.m1.2.2.3.cmml" xref="S5.Ex1.m1.2.2.3"></eq><apply id="S5.Ex1.m1.2.2.4.cmml" xref="S5.Ex1.m1.2.2.4"><csymbol cd="ambiguous" id="S5.Ex1.m1.2.2.4.1.cmml" xref="S5.Ex1.m1.2.2.4">subscript</csymbol><ci id="S5.Ex1.m1.2.2.4.2.cmml" xref="S5.Ex1.m1.2.2.4.2">𝑒</ci><apply id="S5.Ex1.m1.2.2.4.3.cmml" xref="S5.Ex1.m1.2.2.4.3"><times id="S5.Ex1.m1.2.2.4.3.1.cmml" xref="S5.Ex1.m1.2.2.4.3.1"></times><apply id="S5.Ex1.m1.2.2.4.3.2.cmml" xref="S5.Ex1.m1.2.2.4.3.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.2.2.4.3.2.1.cmml" xref="S5.Ex1.m1.2.2.4.3.2">subscript</csymbol><ci id="S5.Ex1.m1.2.2.4.3.2.2.cmml" xref="S5.Ex1.m1.2.2.4.3.2.2">𝑀</ci><ci id="S5.Ex1.m1.2.2.4.3.2.3.cmml" xref="S5.Ex1.m1.2.2.4.3.2.3">𝑐</ci></apply><ci id="S5.Ex1.m1.2.2.4.3.3.cmml" xref="S5.Ex1.m1.2.2.4.3.3">𝑡</ci></apply></apply><apply id="S5.Ex1.m1.2.2.2.cmml" xref="S5.Ex1.m1.2.2.2"><times id="S5.Ex1.m1.2.2.2.3.cmml" xref="S5.Ex1.m1.2.2.2.3"></times><apply id="S5.Ex1.m1.2.2.2.4.cmml" xref="S5.Ex1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S5.Ex1.m1.2.2.2.4.1.cmml" xref="S5.Ex1.m1.2.2.2.4">subscript</csymbol><ci id="S5.Ex1.m1.2.2.2.4.2a.cmml" xref="S5.Ex1.m1.2.2.2.4.2"><mtext id="S5.Ex1.m1.2.2.2.4.2.cmml" xref="S5.Ex1.m1.2.2.2.4.2">CrossAttention</mtext></ci><apply id="S5.Ex1.m1.2.2.2.4.3.cmml" xref="S5.Ex1.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.2.2.2.4.3.1.cmml" xref="S5.Ex1.m1.2.2.2.4.3">subscript</csymbol><ci id="S5.Ex1.m1.2.2.2.4.3.2.cmml" xref="S5.Ex1.m1.2.2.2.4.3.2">𝜃</ci><ci id="S5.Ex1.m1.2.2.2.4.3.3a.cmml" xref="S5.Ex1.m1.2.2.2.4.3.3"><mtext id="S5.Ex1.m1.2.2.2.4.3.3.cmml" mathsize="50%" xref="S5.Ex1.m1.2.2.2.4.3.3">ca</mtext></ci></apply></apply><interval closure="open" id="S5.Ex1.m1.2.2.2.2.3.cmml" xref="S5.Ex1.m1.2.2.2.2.2"><apply id="S5.Ex1.m1.1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.2">𝑒</ci><apply id="S5.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.1.1.3.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.Ex1.m1.1.1.1.1.1.1.3.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.3.2">𝑀</ci><ci id="S5.Ex1.m1.1.1.1.1.1.1.3.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply><apply id="S5.Ex1.m1.2.2.2.2.2.2.cmml" xref="S5.Ex1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.2.2.2.2.2.2.1.cmml" xref="S5.Ex1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S5.Ex1.m1.2.2.2.2.2.2.2.cmml" xref="S5.Ex1.m1.2.2.2.2.2.2.2">𝑒</ci><ci id="S5.Ex1.m1.2.2.2.2.2.2.3.cmml" xref="S5.Ex1.m1.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex1.m1.2c">e_{M_{c}t}=\text{CrossAttention}_{\theta_{\text{ca}}}(e_{M_{c}},e_{t})</annotation><annotation encoding="application/x-llamapun" id="S5.Ex1.m1.2d">italic_e start_POSTSUBSCRIPT italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = CrossAttention start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT ca end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_e start_POSTSUBSCRIPT italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_e start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS2.p1.9">The final classification output <math alttext="y" class="ltx_Math" display="inline" id="S5.SS2.p1.7.m1.1"><semantics id="S5.SS2.p1.7.m1.1a"><mi id="S5.SS2.p1.7.m1.1.1" xref="S5.SS2.p1.7.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.7.m1.1b"><ci id="S5.SS2.p1.7.m1.1.1.cmml" xref="S5.SS2.p1.7.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.7.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.7.m1.1d">italic_y</annotation></semantics></math> is generated, and class-wise saliency maps <math alttext="M_{c}" class="ltx_Math" display="inline" id="S5.SS2.p1.8.m2.1"><semantics id="S5.SS2.p1.8.m2.1a"><msub id="S5.SS2.p1.8.m2.1.1" xref="S5.SS2.p1.8.m2.1.1.cmml"><mi id="S5.SS2.p1.8.m2.1.1.2" xref="S5.SS2.p1.8.m2.1.1.2.cmml">M</mi><mi id="S5.SS2.p1.8.m2.1.1.3" xref="S5.SS2.p1.8.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.8.m2.1b"><apply id="S5.SS2.p1.8.m2.1.1.cmml" xref="S5.SS2.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.8.m2.1.1.1.cmml" xref="S5.SS2.p1.8.m2.1.1">subscript</csymbol><ci id="S5.SS2.p1.8.m2.1.1.2.cmml" xref="S5.SS2.p1.8.m2.1.1.2">𝑀</ci><ci id="S5.SS2.p1.8.m2.1.1.3.cmml" xref="S5.SS2.p1.8.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.8.m2.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.8.m2.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> for each class <math alttext="c" class="ltx_Math" display="inline" id="S5.SS2.p1.9.m3.1"><semantics id="S5.SS2.p1.9.m3.1a"><mi id="S5.SS2.p1.9.m3.1.1" xref="S5.SS2.p1.9.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.9.m3.1b"><ci id="S5.SS2.p1.9.m3.1.1.cmml" xref="S5.SS2.p1.9.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.9.m3.1c">c</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.9.m3.1d">italic_c</annotation></semantics></math> are produced, enhancing the interpretability of the model by highlighting relevant regions in the input image.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Finding-related Attention Map Refinement Network</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.2">To refine the saliency map with finding-related prior knowledge, we introduce our Dwarf module, as shown in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S6.F2" title="Figure 2 ‣ 6 Training Details ‣ Drawf"><span class="ltx_text ltx_ref_tag">2</span></a>. The overall structure of Dwarf consists of a pretrained Vision-Language Model (VLM), denoted as <math alttext="f_{\text{vlm}}" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">f</mi><mtext id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3a.cmml">vlm</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝑓</ci><ci id="S5.SS3.p1.1.m1.1.1.3a.cmml" xref="S5.SS3.p1.1.m1.1.1.3"><mtext id="S5.SS3.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.SS3.p1.1.m1.1.1.3">vlm</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">f_{\text{vlm}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT vlm end_POSTSUBSCRIPT</annotation></semantics></math>, and expert heads <math alttext="f_{\text{heads}}" class="ltx_Math" display="inline" id="S5.SS3.p1.2.m2.1"><semantics id="S5.SS3.p1.2.m2.1a"><msub id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">f</mi><mtext id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3a.cmml">heads</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">𝑓</ci><ci id="S5.SS3.p1.2.m2.1.1.3a.cmml" xref="S5.SS3.p1.2.m2.1.1.3"><mtext id="S5.SS3.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S5.SS3.p1.2.m2.1.1.3">heads</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">f_{\text{heads}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT heads end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.3">For each epoch, given an input attention map <math alttext="M_{c}\in\mathbb{R}^{h\times w}" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><msub id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml"><mi id="S5.SS3.p2.1.m1.1.1.2.2" xref="S5.SS3.p2.1.m1.1.1.2.2.cmml">M</mi><mi id="S5.SS3.p2.1.m1.1.1.2.3" xref="S5.SS3.p2.1.m1.1.1.2.3.cmml">c</mi></msub><mo id="S5.SS3.p2.1.m1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml"><mi id="S5.SS3.p2.1.m1.1.1.3.2" xref="S5.SS3.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S5.SS3.p2.1.m1.1.1.3.3" xref="S5.SS3.p2.1.m1.1.1.3.3.cmml"><mi id="S5.SS3.p2.1.m1.1.1.3.3.2" xref="S5.SS3.p2.1.m1.1.1.3.3.2.cmml">h</mi><mo id="S5.SS3.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S5.SS3.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S5.SS3.p2.1.m1.1.1.3.3.3" xref="S5.SS3.p2.1.m1.1.1.3.3.3.cmml">w</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><in id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1"></in><apply id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.1.m1.1.1.2.1.cmml" xref="S5.SS3.p2.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.1.m1.1.1.2.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2.2">𝑀</ci><ci id="S5.SS3.p2.1.m1.1.1.2.3.cmml" xref="S5.SS3.p2.1.m1.1.1.2.3">𝑐</ci></apply><apply id="S5.SS3.p2.1.m1.1.1.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p2.1.m1.1.1.3.1.cmml" xref="S5.SS3.p2.1.m1.1.1.3">superscript</csymbol><ci id="S5.SS3.p2.1.m1.1.1.3.2.cmml" xref="S5.SS3.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S5.SS3.p2.1.m1.1.1.3.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3.3"><times id="S5.SS3.p2.1.m1.1.1.3.3.1.cmml" xref="S5.SS3.p2.1.m1.1.1.3.3.1"></times><ci id="S5.SS3.p2.1.m1.1.1.3.3.2.cmml" xref="S5.SS3.p2.1.m1.1.1.3.3.2">ℎ</ci><ci id="S5.SS3.p2.1.m1.1.1.3.3.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3.3.3">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">M_{c}\in\mathbb{R}^{h\times w}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_h × italic_w end_POSTSUPERSCRIPT</annotation></semantics></math> of class <math alttext="c" class="ltx_Math" display="inline" id="S5.SS3.p2.2.m2.1"><semantics id="S5.SS3.p2.2.m2.1a"><mi id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><ci id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.2.m2.1d">italic_c</annotation></semantics></math> , we initially utilize a finding-specific head to project the attenion map from its origin embedding space to the visualization space for clinicians. Finally we get the segmentation map <math alttext="M_{c}^{\prime}=f_{\text{head}}(M_{c})" class="ltx_Math" display="inline" id="S5.SS3.p2.3.m3.1"><semantics id="S5.SS3.p2.3.m3.1a"><mrow id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml"><msubsup id="S5.SS3.p2.3.m3.1.1.3" xref="S5.SS3.p2.3.m3.1.1.3.cmml"><mi id="S5.SS3.p2.3.m3.1.1.3.2.2" xref="S5.SS3.p2.3.m3.1.1.3.2.2.cmml">M</mi><mi id="S5.SS3.p2.3.m3.1.1.3.2.3" xref="S5.SS3.p2.3.m3.1.1.3.2.3.cmml">c</mi><mo id="S5.SS3.p2.3.m3.1.1.3.3" xref="S5.SS3.p2.3.m3.1.1.3.3.cmml">′</mo></msubsup><mo id="S5.SS3.p2.3.m3.1.1.2" xref="S5.SS3.p2.3.m3.1.1.2.cmml">=</mo><mrow id="S5.SS3.p2.3.m3.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.cmml"><msub id="S5.SS3.p2.3.m3.1.1.1.3" xref="S5.SS3.p2.3.m3.1.1.1.3.cmml"><mi id="S5.SS3.p2.3.m3.1.1.1.3.2" xref="S5.SS3.p2.3.m3.1.1.1.3.2.cmml">f</mi><mtext id="S5.SS3.p2.3.m3.1.1.1.3.3" xref="S5.SS3.p2.3.m3.1.1.1.3.3a.cmml">head</mtext></msub><mo id="S5.SS3.p2.3.m3.1.1.1.2" xref="S5.SS3.p2.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS3.p2.3.m3.1.1.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.1.1.1.cmml"><mo id="S5.SS3.p2.3.m3.1.1.1.1.1.2" stretchy="false" xref="S5.SS3.p2.3.m3.1.1.1.1.1.1.cmml">(</mo><msub id="S5.SS3.p2.3.m3.1.1.1.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.1.1.1.cmml"><mi id="S5.SS3.p2.3.m3.1.1.1.1.1.1.2" xref="S5.SS3.p2.3.m3.1.1.1.1.1.1.2.cmml">M</mi><mi id="S5.SS3.p2.3.m3.1.1.1.1.1.1.3" xref="S5.SS3.p2.3.m3.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S5.SS3.p2.3.m3.1.1.1.1.1.3" stretchy="false" xref="S5.SS3.p2.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><apply id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1"><eq id="S5.SS3.p2.3.m3.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.2"></eq><apply id="S5.SS3.p2.3.m3.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.1.1.3.1.cmml" xref="S5.SS3.p2.3.m3.1.1.3">superscript</csymbol><apply id="S5.SS3.p2.3.m3.1.1.3.2.cmml" xref="S5.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.1.1.3.2.1.cmml" xref="S5.SS3.p2.3.m3.1.1.3">subscript</csymbol><ci id="S5.SS3.p2.3.m3.1.1.3.2.2.cmml" xref="S5.SS3.p2.3.m3.1.1.3.2.2">𝑀</ci><ci id="S5.SS3.p2.3.m3.1.1.3.2.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3.2.3">𝑐</ci></apply><ci id="S5.SS3.p2.3.m3.1.1.3.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3.3">′</ci></apply><apply id="S5.SS3.p2.3.m3.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1"><times id="S5.SS3.p2.3.m3.1.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.1.2"></times><apply id="S5.SS3.p2.3.m3.1.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.1.1.1.3.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1.3">subscript</csymbol><ci id="S5.SS3.p2.3.m3.1.1.1.3.2.cmml" xref="S5.SS3.p2.3.m3.1.1.1.3.2">𝑓</ci><ci id="S5.SS3.p2.3.m3.1.1.1.3.3a.cmml" xref="S5.SS3.p2.3.m3.1.1.1.3.3"><mtext id="S5.SS3.p2.3.m3.1.1.1.3.3.cmml" mathsize="70%" xref="S5.SS3.p2.3.m3.1.1.1.3.3">head</mtext></ci></apply><apply id="S5.SS3.p2.3.m3.1.1.1.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S5.SS3.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.1.1.2">𝑀</ci><ci id="S5.SS3.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">M_{c}^{\prime}=f_{\text{head}}(M_{c})</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.3.m3.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_f start_POSTSUBSCRIPT head end_POSTSUBSCRIPT ( italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Cyclic Training for Finding-Specific Knowledge Accumulation</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.4">To accumulate finding-specific knowledge effectively, we introduce a cyclic training process. The cyclic training mechanism is designed to iteratively refine the network’s understanding and segmentation of specific findings. During each epoch, the process involves: 
<br class="ltx_break"/>1. **Data Collection**: Initially, each multi-label classification task is decomposed into multiple single-label tasks. For each finding (e.g., Atelectasis, Cardiomegaly, Consolidation), the corresponding images and their labels are extracted, creating a dataset focused on one specific finding at a time. This allows the model to concentrate on learning the characteristics and segmentation of each individual finding without interference from others. 
<br class="ltx_break"/>2. **Segmentation**: For a given finding, an initial segmentation map <math alttext="M_{c}" class="ltx_Math" display="inline" id="S5.SS4.p1.1.m1.1"><semantics id="S5.SS4.p1.1.m1.1a"><msub id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mi id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml">M</mi><mi id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2">𝑀</ci><ci id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.1.m1.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is generated using the corresponding segmentation expert head <math alttext="f_{\text{head}_{c}}" class="ltx_Math" display="inline" id="S5.SS4.p1.2.m2.1"><semantics id="S5.SS4.p1.2.m2.1a"><msub id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml"><mi id="S5.SS4.p1.2.m2.1.1.2" xref="S5.SS4.p1.2.m2.1.1.2.cmml">f</mi><msub id="S5.SS4.p1.2.m2.1.1.3" xref="S5.SS4.p1.2.m2.1.1.3.cmml"><mtext id="S5.SS4.p1.2.m2.1.1.3.2" xref="S5.SS4.p1.2.m2.1.1.3.2a.cmml">head</mtext><mi id="S5.SS4.p1.2.m2.1.1.3.3" xref="S5.SS4.p1.2.m2.1.1.3.3.cmml">c</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><apply id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.2.m2.1.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS4.p1.2.m2.1.1.2.cmml" xref="S5.SS4.p1.2.m2.1.1.2">𝑓</ci><apply id="S5.SS4.p1.2.m2.1.1.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.p1.2.m2.1.1.3.1.cmml" xref="S5.SS4.p1.2.m2.1.1.3">subscript</csymbol><ci id="S5.SS4.p1.2.m2.1.1.3.2a.cmml" xref="S5.SS4.p1.2.m2.1.1.3.2"><mtext id="S5.SS4.p1.2.m2.1.1.3.2.cmml" mathsize="70%" xref="S5.SS4.p1.2.m2.1.1.3.2">head</mtext></ci><ci id="S5.SS4.p1.2.m2.1.1.3.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">f_{\text{head}_{c}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT head start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>. This map highlights the regions of interest related to the specific finding. 
<br class="ltx_break"/>3. **Classification and Segmentation Feedback Loop**: The initial segmentation map <math alttext="M_{c}" class="ltx_Math" display="inline" id="S5.SS4.p1.3.m3.1"><semantics id="S5.SS4.p1.3.m3.1a"><msub id="S5.SS4.p1.3.m3.1.1" xref="S5.SS4.p1.3.m3.1.1.cmml"><mi id="S5.SS4.p1.3.m3.1.1.2" xref="S5.SS4.p1.3.m3.1.1.2.cmml">M</mi><mi id="S5.SS4.p1.3.m3.1.1.3" xref="S5.SS4.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.3.m3.1b"><apply id="S5.SS4.p1.3.m3.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.3.m3.1.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS4.p1.3.m3.1.1.2.cmml" xref="S5.SS4.p1.3.m3.1.1.2">𝑀</ci><ci id="S5.SS4.p1.3.m3.1.1.3.cmml" xref="S5.SS4.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.3.m3.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.3.m3.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and classification outputs are evaluated against the ground truth. The discrepancies between the initial predictions and the ground truth are used to calculate the loss for both classification and segmentation tasks. This loss is then used to update the network parameters. 
<br class="ltx_break"/>4. **Iterative Refinement**: This process is repeated cyclically for each finding. The model iteratively updates its parameters to improve the segmentation maps <math alttext="M_{c}" class="ltx_Math" display="inline" id="S5.SS4.p1.4.m4.1"><semantics id="S5.SS4.p1.4.m4.1a"><msub id="S5.SS4.p1.4.m4.1.1" xref="S5.SS4.p1.4.m4.1.1.cmml"><mi id="S5.SS4.p1.4.m4.1.1.2" xref="S5.SS4.p1.4.m4.1.1.2.cmml">M</mi><mi id="S5.SS4.p1.4.m4.1.1.3" xref="S5.SS4.p1.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.4.m4.1b"><apply id="S5.SS4.p1.4.m4.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.4.m4.1.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS4.p1.4.m4.1.1.2.cmml" xref="S5.SS4.p1.4.m4.1.1.2">𝑀</ci><ci id="S5.SS4.p1.4.m4.1.1.3.cmml" xref="S5.SS4.p1.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.4.m4.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.4.m4.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and classification accuracy. By focusing on one finding at a time, the network continuously refines its ability to accurately identify and segment specific medical conditions.</p>
</div>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">By incorporating cyclic training, the network can effectively refine its ability to identify and segment specific medical findings, leading to improved diagnostic performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Distill information to classification model</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.6">Besides supervised by ground truth, Dwarf could also utilize experts as teachers to impart knowledge about human preferences and disease characteristics to the classification model. As illustrated in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S6.F2" title="Figure 2 ‣ 6 Training Details ‣ Drawf"><span class="ltx_text ltx_ref_tag">2</span></a>, For each input image <math alttext="x" class="ltx_Math" display="inline" id="S5.SS5.p1.1.m1.1"><semantics id="S5.SS5.p1.1.m1.1a"><mi id="S5.SS5.p1.1.m1.1.1" xref="S5.SS5.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.1.m1.1b"><ci id="S5.SS5.p1.1.m1.1.1.cmml" xref="S5.SS5.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.1.m1.1d">italic_x</annotation></semantics></math>, it is fed into the classification model, generating a corresponding saliency map <math alttext="M_{c}" class="ltx_Math" display="inline" id="S5.SS5.p1.2.m2.1"><semantics id="S5.SS5.p1.2.m2.1a"><msub id="S5.SS5.p1.2.m2.1.1" xref="S5.SS5.p1.2.m2.1.1.cmml"><mi id="S5.SS5.p1.2.m2.1.1.2" xref="S5.SS5.p1.2.m2.1.1.2.cmml">M</mi><mi id="S5.SS5.p1.2.m2.1.1.3" xref="S5.SS5.p1.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.2.m2.1b"><apply id="S5.SS5.p1.2.m2.1.1.cmml" xref="S5.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS5.p1.2.m2.1.1.1.cmml" xref="S5.SS5.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS5.p1.2.m2.1.1.2.cmml" xref="S5.SS5.p1.2.m2.1.1.2">𝑀</ci><ci id="S5.SS5.p1.2.m2.1.1.3.cmml" xref="S5.SS5.p1.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.2.m2.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.2.m2.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, which is then upsampled. This upsampled map, <math alttext="M_{c}" class="ltx_Math" display="inline" id="S5.SS5.p1.3.m3.1"><semantics id="S5.SS5.p1.3.m3.1a"><msub id="S5.SS5.p1.3.m3.1.1" xref="S5.SS5.p1.3.m3.1.1.cmml"><mi id="S5.SS5.p1.3.m3.1.1.2" xref="S5.SS5.p1.3.m3.1.1.2.cmml">M</mi><mi id="S5.SS5.p1.3.m3.1.1.3" xref="S5.SS5.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.3.m3.1b"><apply id="S5.SS5.p1.3.m3.1.1.cmml" xref="S5.SS5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS5.p1.3.m3.1.1.1.cmml" xref="S5.SS5.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS5.p1.3.m3.1.1.2.cmml" xref="S5.SS5.p1.3.m3.1.1.2">𝑀</ci><ci id="S5.SS5.p1.3.m3.1.1.3.cmml" xref="S5.SS5.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.3.m3.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.3.m3.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, is input into a frozen DARF module, producing a revised saliency map <math alttext="M_{c}^{\prime}" class="ltx_Math" display="inline" id="S5.SS5.p1.4.m4.1"><semantics id="S5.SS5.p1.4.m4.1a"><msubsup id="S5.SS5.p1.4.m4.1.1" xref="S5.SS5.p1.4.m4.1.1.cmml"><mi id="S5.SS5.p1.4.m4.1.1.2.2" xref="S5.SS5.p1.4.m4.1.1.2.2.cmml">M</mi><mi id="S5.SS5.p1.4.m4.1.1.2.3" xref="S5.SS5.p1.4.m4.1.1.2.3.cmml">c</mi><mo id="S5.SS5.p1.4.m4.1.1.3" xref="S5.SS5.p1.4.m4.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.4.m4.1b"><apply id="S5.SS5.p1.4.m4.1.1.cmml" xref="S5.SS5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS5.p1.4.m4.1.1.1.cmml" xref="S5.SS5.p1.4.m4.1.1">superscript</csymbol><apply id="S5.SS5.p1.4.m4.1.1.2.cmml" xref="S5.SS5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS5.p1.4.m4.1.1.2.1.cmml" xref="S5.SS5.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS5.p1.4.m4.1.1.2.2.cmml" xref="S5.SS5.p1.4.m4.1.1.2.2">𝑀</ci><ci id="S5.SS5.p1.4.m4.1.1.2.3.cmml" xref="S5.SS5.p1.4.m4.1.1.2.3">𝑐</ci></apply><ci id="S5.SS5.p1.4.m4.1.1.3.cmml" xref="S5.SS5.p1.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.4.m4.1c">M_{c}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.4.m4.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. A Dice loss is calculated between <math alttext="M_{c}" class="ltx_Math" display="inline" id="S5.SS5.p1.5.m5.1"><semantics id="S5.SS5.p1.5.m5.1a"><msub id="S5.SS5.p1.5.m5.1.1" xref="S5.SS5.p1.5.m5.1.1.cmml"><mi id="S5.SS5.p1.5.m5.1.1.2" xref="S5.SS5.p1.5.m5.1.1.2.cmml">M</mi><mi id="S5.SS5.p1.5.m5.1.1.3" xref="S5.SS5.p1.5.m5.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.5.m5.1b"><apply id="S5.SS5.p1.5.m5.1.1.cmml" xref="S5.SS5.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS5.p1.5.m5.1.1.1.cmml" xref="S5.SS5.p1.5.m5.1.1">subscript</csymbol><ci id="S5.SS5.p1.5.m5.1.1.2.cmml" xref="S5.SS5.p1.5.m5.1.1.2">𝑀</ci><ci id="S5.SS5.p1.5.m5.1.1.3.cmml" xref="S5.SS5.p1.5.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.5.m5.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.5.m5.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="M_{c}^{\prime}" class="ltx_Math" display="inline" id="S5.SS5.p1.6.m6.1"><semantics id="S5.SS5.p1.6.m6.1a"><msubsup id="S5.SS5.p1.6.m6.1.1" xref="S5.SS5.p1.6.m6.1.1.cmml"><mi id="S5.SS5.p1.6.m6.1.1.2.2" xref="S5.SS5.p1.6.m6.1.1.2.2.cmml">M</mi><mi id="S5.SS5.p1.6.m6.1.1.2.3" xref="S5.SS5.p1.6.m6.1.1.2.3.cmml">c</mi><mo id="S5.SS5.p1.6.m6.1.1.3" xref="S5.SS5.p1.6.m6.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.6.m6.1b"><apply id="S5.SS5.p1.6.m6.1.1.cmml" xref="S5.SS5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS5.p1.6.m6.1.1.1.cmml" xref="S5.SS5.p1.6.m6.1.1">superscript</csymbol><apply id="S5.SS5.p1.6.m6.1.1.2.cmml" xref="S5.SS5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS5.p1.6.m6.1.1.2.1.cmml" xref="S5.SS5.p1.6.m6.1.1">subscript</csymbol><ci id="S5.SS5.p1.6.m6.1.1.2.2.cmml" xref="S5.SS5.p1.6.m6.1.1.2.2">𝑀</ci><ci id="S5.SS5.p1.6.m6.1.1.2.3.cmml" xref="S5.SS5.p1.6.m6.1.1.2.3">𝑐</ci></apply><ci id="S5.SS5.p1.6.m6.1.1.3.cmml" xref="S5.SS5.p1.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.6.m6.1c">M_{c}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.6.m6.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> to facilitate the distillation of knowledge from the DARF model into the classification model, effectively transferring crucial information regarding human preferences and disease-specific attributes. We ablate the performance with ground truth as shown in Tab.<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S8.T8" title="Table 8 ‣ 8.2 Ablations ‣ 8 Results ‣ Drawf"><span class="ltx_text ltx_ref_tag">8</span></a></p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6 </span>Losses and network initialization</h3>
<section class="ltx_subsubsection" id="S5.SS6.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.6.1 </span>Loss</h4>
<div class="ltx_para" id="S5.SS6.SSS1.p1">
<p class="ltx_p" id="S5.SS6.SSS1.p1.1">In our framework, we adopt cross entropy loss as multi-label classification loss while a modifed dice loss for optimizing attention map.
<br class="ltx_break"/>In medical image analysis, attention maps are usually considered to be sensitive to detect disease related markers. Unlike traditional segmentation tasks, the training and validation for attention map often utilize only positive samples, which can inadvertently lead to a model overestimating the presence of certain features or conditions, known as false positives. To counteract this, we implement a <span class="ltx_text ltx_font_bold" id="S5.SS6.SSS1.p1.1.1">False Positive Suppression</span> technique that adjusts the model’s scoring function.</p>
</div>
<div class="ltx_para" id="S5.SS6.SSS1.p2">
<p class="ltx_p" id="S5.SS6.SSS1.p2.1">The standard metric used is the Soft Dice Score, defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Soft Dice Score}=\frac{2\times\text{intersection}+\text{smooth}+%
\varepsilon}{\text{cardinality}+\text{smooth}+\varepsilon}" class="ltx_Math" display="block" id="S5.Ex2.m1.1"><semantics id="S5.Ex2.m1.1a"><mrow id="S5.Ex2.m1.1.1" xref="S5.Ex2.m1.1.1.cmml"><mtext id="S5.Ex2.m1.1.1.2" xref="S5.Ex2.m1.1.1.2a.cmml">Soft Dice Score</mtext><mo id="S5.Ex2.m1.1.1.1" xref="S5.Ex2.m1.1.1.1.cmml">=</mo><mfrac id="S5.Ex2.m1.1.1.3" xref="S5.Ex2.m1.1.1.3.cmml"><mrow id="S5.Ex2.m1.1.1.3.2" xref="S5.Ex2.m1.1.1.3.2.cmml"><mrow id="S5.Ex2.m1.1.1.3.2.2" xref="S5.Ex2.m1.1.1.3.2.2.cmml"><mn id="S5.Ex2.m1.1.1.3.2.2.2" xref="S5.Ex2.m1.1.1.3.2.2.2.cmml">2</mn><mo id="S5.Ex2.m1.1.1.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S5.Ex2.m1.1.1.3.2.2.1.cmml">×</mo><mtext id="S5.Ex2.m1.1.1.3.2.2.3" xref="S5.Ex2.m1.1.1.3.2.2.3a.cmml">intersection</mtext></mrow><mo id="S5.Ex2.m1.1.1.3.2.1" xref="S5.Ex2.m1.1.1.3.2.1.cmml">+</mo><mtext id="S5.Ex2.m1.1.1.3.2.3" xref="S5.Ex2.m1.1.1.3.2.3a.cmml">smooth</mtext><mo id="S5.Ex2.m1.1.1.3.2.1a" xref="S5.Ex2.m1.1.1.3.2.1.cmml">+</mo><mi id="S5.Ex2.m1.1.1.3.2.4" xref="S5.Ex2.m1.1.1.3.2.4.cmml">ε</mi></mrow><mrow id="S5.Ex2.m1.1.1.3.3" xref="S5.Ex2.m1.1.1.3.3.cmml"><mtext id="S5.Ex2.m1.1.1.3.3.2" xref="S5.Ex2.m1.1.1.3.3.2a.cmml">cardinality</mtext><mo id="S5.Ex2.m1.1.1.3.3.1" xref="S5.Ex2.m1.1.1.3.3.1.cmml">+</mo><mtext id="S5.Ex2.m1.1.1.3.3.3" xref="S5.Ex2.m1.1.1.3.3.3a.cmml">smooth</mtext><mo id="S5.Ex2.m1.1.1.3.3.1a" xref="S5.Ex2.m1.1.1.3.3.1.cmml">+</mo><mi id="S5.Ex2.m1.1.1.3.3.4" xref="S5.Ex2.m1.1.1.3.3.4.cmml">ε</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex2.m1.1b"><apply id="S5.Ex2.m1.1.1.cmml" xref="S5.Ex2.m1.1.1"><eq id="S5.Ex2.m1.1.1.1.cmml" xref="S5.Ex2.m1.1.1.1"></eq><ci id="S5.Ex2.m1.1.1.2a.cmml" xref="S5.Ex2.m1.1.1.2"><mtext id="S5.Ex2.m1.1.1.2.cmml" xref="S5.Ex2.m1.1.1.2">Soft Dice Score</mtext></ci><apply id="S5.Ex2.m1.1.1.3.cmml" xref="S5.Ex2.m1.1.1.3"><divide id="S5.Ex2.m1.1.1.3.1.cmml" xref="S5.Ex2.m1.1.1.3"></divide><apply id="S5.Ex2.m1.1.1.3.2.cmml" xref="S5.Ex2.m1.1.1.3.2"><plus id="S5.Ex2.m1.1.1.3.2.1.cmml" xref="S5.Ex2.m1.1.1.3.2.1"></plus><apply id="S5.Ex2.m1.1.1.3.2.2.cmml" xref="S5.Ex2.m1.1.1.3.2.2"><times id="S5.Ex2.m1.1.1.3.2.2.1.cmml" xref="S5.Ex2.m1.1.1.3.2.2.1"></times><cn id="S5.Ex2.m1.1.1.3.2.2.2.cmml" type="integer" xref="S5.Ex2.m1.1.1.3.2.2.2">2</cn><ci id="S5.Ex2.m1.1.1.3.2.2.3a.cmml" xref="S5.Ex2.m1.1.1.3.2.2.3"><mtext id="S5.Ex2.m1.1.1.3.2.2.3.cmml" xref="S5.Ex2.m1.1.1.3.2.2.3">intersection</mtext></ci></apply><ci id="S5.Ex2.m1.1.1.3.2.3a.cmml" xref="S5.Ex2.m1.1.1.3.2.3"><mtext id="S5.Ex2.m1.1.1.3.2.3.cmml" xref="S5.Ex2.m1.1.1.3.2.3">smooth</mtext></ci><ci id="S5.Ex2.m1.1.1.3.2.4.cmml" xref="S5.Ex2.m1.1.1.3.2.4">𝜀</ci></apply><apply id="S5.Ex2.m1.1.1.3.3.cmml" xref="S5.Ex2.m1.1.1.3.3"><plus id="S5.Ex2.m1.1.1.3.3.1.cmml" xref="S5.Ex2.m1.1.1.3.3.1"></plus><ci id="S5.Ex2.m1.1.1.3.3.2a.cmml" xref="S5.Ex2.m1.1.1.3.3.2"><mtext id="S5.Ex2.m1.1.1.3.3.2.cmml" xref="S5.Ex2.m1.1.1.3.3.2">cardinality</mtext></ci><ci id="S5.Ex2.m1.1.1.3.3.3a.cmml" xref="S5.Ex2.m1.1.1.3.3.3"><mtext id="S5.Ex2.m1.1.1.3.3.3.cmml" xref="S5.Ex2.m1.1.1.3.3.3">smooth</mtext></ci><ci id="S5.Ex2.m1.1.1.3.3.4.cmml" xref="S5.Ex2.m1.1.1.3.3.4">𝜀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex2.m1.1c">\text{Soft Dice Score}=\frac{2\times\text{intersection}+\text{smooth}+%
\varepsilon}{\text{cardinality}+\text{smooth}+\varepsilon}</annotation><annotation encoding="application/x-llamapun" id="S5.Ex2.m1.1d">Soft Dice Score = divide start_ARG 2 × intersection + smooth + italic_ε end_ARG start_ARG cardinality + smooth + italic_ε end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S5.SS6.SSS1.p3">
<p class="ltx_p" id="S5.SS6.SSS1.p3.1">To mitigate the issue of false positives, we introduce a penalty for false predictions:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Soft Dice Score with FP Penalty}=\frac{2\times\text{intersection}+\text{%
smooth}+\varepsilon}{\text{adjusted cardinality}+\text{smooth}+\varepsilon}" class="ltx_Math" display="block" id="S5.Ex3.m1.1"><semantics id="S5.Ex3.m1.1a"><mrow id="S5.Ex3.m1.1.1" xref="S5.Ex3.m1.1.1.cmml"><mtext id="S5.Ex3.m1.1.1.2" xref="S5.Ex3.m1.1.1.2a.cmml">Soft Dice Score with FP Penalty</mtext><mo id="S5.Ex3.m1.1.1.1" xref="S5.Ex3.m1.1.1.1.cmml">=</mo><mfrac id="S5.Ex3.m1.1.1.3" xref="S5.Ex3.m1.1.1.3.cmml"><mrow id="S5.Ex3.m1.1.1.3.2" xref="S5.Ex3.m1.1.1.3.2.cmml"><mrow id="S5.Ex3.m1.1.1.3.2.2" xref="S5.Ex3.m1.1.1.3.2.2.cmml"><mn id="S5.Ex3.m1.1.1.3.2.2.2" xref="S5.Ex3.m1.1.1.3.2.2.2.cmml">2</mn><mo id="S5.Ex3.m1.1.1.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S5.Ex3.m1.1.1.3.2.2.1.cmml">×</mo><mtext id="S5.Ex3.m1.1.1.3.2.2.3" xref="S5.Ex3.m1.1.1.3.2.2.3a.cmml">intersection</mtext></mrow><mo id="S5.Ex3.m1.1.1.3.2.1" xref="S5.Ex3.m1.1.1.3.2.1.cmml">+</mo><mtext id="S5.Ex3.m1.1.1.3.2.3" xref="S5.Ex3.m1.1.1.3.2.3a.cmml">smooth</mtext><mo id="S5.Ex3.m1.1.1.3.2.1a" xref="S5.Ex3.m1.1.1.3.2.1.cmml">+</mo><mi id="S5.Ex3.m1.1.1.3.2.4" xref="S5.Ex3.m1.1.1.3.2.4.cmml">ε</mi></mrow><mrow id="S5.Ex3.m1.1.1.3.3" xref="S5.Ex3.m1.1.1.3.3.cmml"><mtext id="S5.Ex3.m1.1.1.3.3.2" xref="S5.Ex3.m1.1.1.3.3.2a.cmml">adjusted cardinality</mtext><mo id="S5.Ex3.m1.1.1.3.3.1" xref="S5.Ex3.m1.1.1.3.3.1.cmml">+</mo><mtext id="S5.Ex3.m1.1.1.3.3.3" xref="S5.Ex3.m1.1.1.3.3.3a.cmml">smooth</mtext><mo id="S5.Ex3.m1.1.1.3.3.1a" xref="S5.Ex3.m1.1.1.3.3.1.cmml">+</mo><mi id="S5.Ex3.m1.1.1.3.3.4" xref="S5.Ex3.m1.1.1.3.3.4.cmml">ε</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex3.m1.1b"><apply id="S5.Ex3.m1.1.1.cmml" xref="S5.Ex3.m1.1.1"><eq id="S5.Ex3.m1.1.1.1.cmml" xref="S5.Ex3.m1.1.1.1"></eq><ci id="S5.Ex3.m1.1.1.2a.cmml" xref="S5.Ex3.m1.1.1.2"><mtext id="S5.Ex3.m1.1.1.2.cmml" xref="S5.Ex3.m1.1.1.2">Soft Dice Score with FP Penalty</mtext></ci><apply id="S5.Ex3.m1.1.1.3.cmml" xref="S5.Ex3.m1.1.1.3"><divide id="S5.Ex3.m1.1.1.3.1.cmml" xref="S5.Ex3.m1.1.1.3"></divide><apply id="S5.Ex3.m1.1.1.3.2.cmml" xref="S5.Ex3.m1.1.1.3.2"><plus id="S5.Ex3.m1.1.1.3.2.1.cmml" xref="S5.Ex3.m1.1.1.3.2.1"></plus><apply id="S5.Ex3.m1.1.1.3.2.2.cmml" xref="S5.Ex3.m1.1.1.3.2.2"><times id="S5.Ex3.m1.1.1.3.2.2.1.cmml" xref="S5.Ex3.m1.1.1.3.2.2.1"></times><cn id="S5.Ex3.m1.1.1.3.2.2.2.cmml" type="integer" xref="S5.Ex3.m1.1.1.3.2.2.2">2</cn><ci id="S5.Ex3.m1.1.1.3.2.2.3a.cmml" xref="S5.Ex3.m1.1.1.3.2.2.3"><mtext id="S5.Ex3.m1.1.1.3.2.2.3.cmml" xref="S5.Ex3.m1.1.1.3.2.2.3">intersection</mtext></ci></apply><ci id="S5.Ex3.m1.1.1.3.2.3a.cmml" xref="S5.Ex3.m1.1.1.3.2.3"><mtext id="S5.Ex3.m1.1.1.3.2.3.cmml" xref="S5.Ex3.m1.1.1.3.2.3">smooth</mtext></ci><ci id="S5.Ex3.m1.1.1.3.2.4.cmml" xref="S5.Ex3.m1.1.1.3.2.4">𝜀</ci></apply><apply id="S5.Ex3.m1.1.1.3.3.cmml" xref="S5.Ex3.m1.1.1.3.3"><plus id="S5.Ex3.m1.1.1.3.3.1.cmml" xref="S5.Ex3.m1.1.1.3.3.1"></plus><ci id="S5.Ex3.m1.1.1.3.3.2a.cmml" xref="S5.Ex3.m1.1.1.3.3.2"><mtext id="S5.Ex3.m1.1.1.3.3.2.cmml" xref="S5.Ex3.m1.1.1.3.3.2">adjusted cardinality</mtext></ci><ci id="S5.Ex3.m1.1.1.3.3.3a.cmml" xref="S5.Ex3.m1.1.1.3.3.3"><mtext id="S5.Ex3.m1.1.1.3.3.3.cmml" xref="S5.Ex3.m1.1.1.3.3.3">smooth</mtext></ci><ci id="S5.Ex3.m1.1.1.3.3.4.cmml" xref="S5.Ex3.m1.1.1.3.3.4">𝜀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex3.m1.1c">\text{Soft Dice Score with FP Penalty}=\frac{2\times\text{intersection}+\text{%
smooth}+\varepsilon}{\text{adjusted cardinality}+\text{smooth}+\varepsilon}</annotation><annotation encoding="application/x-llamapun" id="S5.Ex3.m1.1d">Soft Dice Score with FP Penalty = divide start_ARG 2 × intersection + smooth + italic_ε end_ARG start_ARG adjusted cardinality + smooth + italic_ε end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS6.SSS1.p3.2">where the adjusted cardinality is modified to penalize false positives:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{adjusted cardinality}=\text{cardinality}+(\text{weight}_{\text{fp}}-1)%
\times\text{false positives}" class="ltx_Math" display="block" id="S5.Ex4.m1.1"><semantics id="S5.Ex4.m1.1a"><mrow id="S5.Ex4.m1.1.1" xref="S5.Ex4.m1.1.1.cmml"><mtext id="S5.Ex4.m1.1.1.3" xref="S5.Ex4.m1.1.1.3a.cmml">adjusted cardinality</mtext><mo id="S5.Ex4.m1.1.1.2" xref="S5.Ex4.m1.1.1.2.cmml">=</mo><mrow id="S5.Ex4.m1.1.1.1" xref="S5.Ex4.m1.1.1.1.cmml"><mtext id="S5.Ex4.m1.1.1.1.3" xref="S5.Ex4.m1.1.1.1.3a.cmml">cardinality</mtext><mo id="S5.Ex4.m1.1.1.1.2" xref="S5.Ex4.m1.1.1.1.2.cmml">+</mo><mrow id="S5.Ex4.m1.1.1.1.1" xref="S5.Ex4.m1.1.1.1.1.cmml"><mrow id="S5.Ex4.m1.1.1.1.1.1.1" xref="S5.Ex4.m1.1.1.1.1.1.1.1.cmml"><mo id="S5.Ex4.m1.1.1.1.1.1.1.2" stretchy="false" xref="S5.Ex4.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.Ex4.m1.1.1.1.1.1.1.1" xref="S5.Ex4.m1.1.1.1.1.1.1.1.cmml"><msub id="S5.Ex4.m1.1.1.1.1.1.1.1.2" xref="S5.Ex4.m1.1.1.1.1.1.1.1.2.cmml"><mtext id="S5.Ex4.m1.1.1.1.1.1.1.1.2.2" xref="S5.Ex4.m1.1.1.1.1.1.1.1.2.2a.cmml">weight</mtext><mtext id="S5.Ex4.m1.1.1.1.1.1.1.1.2.3" xref="S5.Ex4.m1.1.1.1.1.1.1.1.2.3a.cmml">fp</mtext></msub><mo id="S5.Ex4.m1.1.1.1.1.1.1.1.1" xref="S5.Ex4.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S5.Ex4.m1.1.1.1.1.1.1.1.3" xref="S5.Ex4.m1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.Ex4.m1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S5.Ex4.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.Ex4.m1.1.1.1.1.2" rspace="0.222em" xref="S5.Ex4.m1.1.1.1.1.2.cmml">×</mo><mtext id="S5.Ex4.m1.1.1.1.1.3" xref="S5.Ex4.m1.1.1.1.1.3a.cmml">false positives</mtext></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex4.m1.1b"><apply id="S5.Ex4.m1.1.1.cmml" xref="S5.Ex4.m1.1.1"><eq id="S5.Ex4.m1.1.1.2.cmml" xref="S5.Ex4.m1.1.1.2"></eq><ci id="S5.Ex4.m1.1.1.3a.cmml" xref="S5.Ex4.m1.1.1.3"><mtext id="S5.Ex4.m1.1.1.3.cmml" xref="S5.Ex4.m1.1.1.3">adjusted cardinality</mtext></ci><apply id="S5.Ex4.m1.1.1.1.cmml" xref="S5.Ex4.m1.1.1.1"><plus id="S5.Ex4.m1.1.1.1.2.cmml" xref="S5.Ex4.m1.1.1.1.2"></plus><ci id="S5.Ex4.m1.1.1.1.3a.cmml" xref="S5.Ex4.m1.1.1.1.3"><mtext id="S5.Ex4.m1.1.1.1.3.cmml" xref="S5.Ex4.m1.1.1.1.3">cardinality</mtext></ci><apply id="S5.Ex4.m1.1.1.1.1.cmml" xref="S5.Ex4.m1.1.1.1.1"><times id="S5.Ex4.m1.1.1.1.1.2.cmml" xref="S5.Ex4.m1.1.1.1.1.2"></times><apply id="S5.Ex4.m1.1.1.1.1.1.1.1.cmml" xref="S5.Ex4.m1.1.1.1.1.1.1"><minus id="S5.Ex4.m1.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex4.m1.1.1.1.1.1.1.1.1"></minus><apply id="S5.Ex4.m1.1.1.1.1.1.1.1.2.cmml" xref="S5.Ex4.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex4.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.Ex4.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.Ex4.m1.1.1.1.1.1.1.1.2.2a.cmml" xref="S5.Ex4.m1.1.1.1.1.1.1.1.2.2"><mtext id="S5.Ex4.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.Ex4.m1.1.1.1.1.1.1.1.2.2">weight</mtext></ci><ci id="S5.Ex4.m1.1.1.1.1.1.1.1.2.3a.cmml" xref="S5.Ex4.m1.1.1.1.1.1.1.1.2.3"><mtext id="S5.Ex4.m1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S5.Ex4.m1.1.1.1.1.1.1.1.2.3">fp</mtext></ci></apply><cn id="S5.Ex4.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S5.Ex4.m1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S5.Ex4.m1.1.1.1.1.3a.cmml" xref="S5.Ex4.m1.1.1.1.1.3"><mtext id="S5.Ex4.m1.1.1.1.1.3.cmml" xref="S5.Ex4.m1.1.1.1.1.3">false positives</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex4.m1.1c">\text{adjusted cardinality}=\text{cardinality}+(\text{weight}_{\text{fp}}-1)%
\times\text{false positives}</annotation><annotation encoding="application/x-llamapun" id="S5.Ex4.m1.1d">adjusted cardinality = cardinality + ( weight start_POSTSUBSCRIPT fp end_POSTSUBSCRIPT - 1 ) × false positives</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS6.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.6.2 </span>network parameters’ initialization</h4>
<div class="ltx_para" id="S5.SS6.SSS2.p1">
<p class="ltx_p" id="S5.SS6.SSS2.p1.1">The image encoder, text encoder, and cross-attention layers of the pretrained network are based on the DeViDe. Besides, we introduce additional disese-related segmentation heads for each specific disease.</p>
</div>
<div class="ltx_para" id="S5.SS6.SSS2.p2">
<p class="ltx_p" id="S5.SS6.SSS2.p2.1">The <span class="ltx_text ltx_font_bold" id="S5.SS6.SSS2.p2.1.1">Identity Enhanced Initialization (IEI)</span> technique is proposed to overcome the shortcomings of random or simplistic initializations that often lead to suboptimal learning paths. IEI focuses on initializing the model parameters in a way that enhances its sensitivity to the structures relevant to specific diseases, steering the learning process towards more effective feature recognition from the onset.</p>
</div>
<div class="ltx_para" id="S5.SS6.SSS2.p3">
<p class="ltx_p" id="S5.SS6.SSS2.p3.1">This initialization ensures that the predictions are based not merely on the easiest or most apparent features (<span class="ltx_text ltx_font_italic" id="S5.SS6.SSS2.p3.1.1">short-cut path</span>) but rather on a comprehensive analysis of the images, facilitated by enhanced parameter settings. The initial parameter settings are thus crucial for the effective training of the model, especially in complex scenarios where accurate segmentation plays a critical role in diagnosis and treatment planning. The qualitative comparison is illustrated as Fig.<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S5.F1" title="Figure 1 ‣ 5.6.2 network parameters’ initialization ‣ 5.6 Losses and network initialization ‣ 5 Method ‣ Drawf"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS6.SSS2.p4">
<p class="ltx_p" id="S5.SS6.SSS2.p4.1">Through these methodologies, the model’s performance in distinguishing and accurately segmenting medical images is significantly improved, reducing both false positives and enhancing the reliability of the medical diagnosis process.</p>
</div>
<figure class="ltx_figure" id="S5.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="265" id="S5.F1.g1" src="x1.png" width="763"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>With random initialization, the model tends to directly learn shortcut results which always highlight the same area. While using IEI initialization, the model can start from pretrained VLM’s attention to refine its focus.</figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Training Details </h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">With ViT-B as the visual backbone and Med-KEBERT as the textual backbone, we finetune on the ChestX-Det dataset <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">lian2021structure</span>]</cite> on an image size of 224. We utilize the AdamW optimizer with learning rates <math alttext="lr=5\times 10^{-5}" class="ltx_Math" display="inline" id="S6.p1.1.m1.1"><semantics id="S6.p1.1.m1.1a"><mrow id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml"><mrow id="S6.p1.1.m1.1.1.2" xref="S6.p1.1.m1.1.1.2.cmml"><mi id="S6.p1.1.m1.1.1.2.2" xref="S6.p1.1.m1.1.1.2.2.cmml">l</mi><mo id="S6.p1.1.m1.1.1.2.1" xref="S6.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S6.p1.1.m1.1.1.2.3" xref="S6.p1.1.m1.1.1.2.3.cmml">r</mi></mrow><mo id="S6.p1.1.m1.1.1.1" xref="S6.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S6.p1.1.m1.1.1.3" xref="S6.p1.1.m1.1.1.3.cmml"><mn id="S6.p1.1.m1.1.1.3.2" xref="S6.p1.1.m1.1.1.3.2.cmml">5</mn><mo id="S6.p1.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S6.p1.1.m1.1.1.3.1.cmml">×</mo><msup id="S6.p1.1.m1.1.1.3.3" xref="S6.p1.1.m1.1.1.3.3.cmml"><mn id="S6.p1.1.m1.1.1.3.3.2" xref="S6.p1.1.m1.1.1.3.3.2.cmml">10</mn><mrow id="S6.p1.1.m1.1.1.3.3.3" xref="S6.p1.1.m1.1.1.3.3.3.cmml"><mo id="S6.p1.1.m1.1.1.3.3.3a" xref="S6.p1.1.m1.1.1.3.3.3.cmml">−</mo><mn id="S6.p1.1.m1.1.1.3.3.3.2" xref="S6.p1.1.m1.1.1.3.3.3.2.cmml">5</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><apply id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1"><eq id="S6.p1.1.m1.1.1.1.cmml" xref="S6.p1.1.m1.1.1.1"></eq><apply id="S6.p1.1.m1.1.1.2.cmml" xref="S6.p1.1.m1.1.1.2"><times id="S6.p1.1.m1.1.1.2.1.cmml" xref="S6.p1.1.m1.1.1.2.1"></times><ci id="S6.p1.1.m1.1.1.2.2.cmml" xref="S6.p1.1.m1.1.1.2.2">𝑙</ci><ci id="S6.p1.1.m1.1.1.2.3.cmml" xref="S6.p1.1.m1.1.1.2.3">𝑟</ci></apply><apply id="S6.p1.1.m1.1.1.3.cmml" xref="S6.p1.1.m1.1.1.3"><times id="S6.p1.1.m1.1.1.3.1.cmml" xref="S6.p1.1.m1.1.1.3.1"></times><cn id="S6.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S6.p1.1.m1.1.1.3.2">5</cn><apply id="S6.p1.1.m1.1.1.3.3.cmml" xref="S6.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S6.p1.1.m1.1.1.3.3.1.cmml" xref="S6.p1.1.m1.1.1.3.3">superscript</csymbol><cn id="S6.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S6.p1.1.m1.1.1.3.3.2">10</cn><apply id="S6.p1.1.m1.1.1.3.3.3.cmml" xref="S6.p1.1.m1.1.1.3.3.3"><minus id="S6.p1.1.m1.1.1.3.3.3.1.cmml" xref="S6.p1.1.m1.1.1.3.3.3"></minus><cn id="S6.p1.1.m1.1.1.3.3.3.2.cmml" type="integer" xref="S6.p1.1.m1.1.1.3.3.3.2">5</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">lr=5\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S6.p1.1.m1.1d">italic_l italic_r = 5 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math>. We optimize on V100 16G GPUS with a total batch size of 32 for a total of 500 epochs.</p>
</div>
<figure class="ltx_figure" id="S6.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="384" id="S6.F2.g1" src="x2.png" width="926"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Flow chart of finetuning the classification model. Our method only trains single disease each epoch with disease name as prompt. For each disease, we add an additional head to mapping origin attention to refined segmentation map. </figcaption>
</figure>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Evaluation</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">To systematically evaluate our proposed framework, we employed two validation methodologies: segmentation metrics and classification metrics.</p>
</div>
<section class="ltx_subsection" id="S7.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Segmentation Metrics (Grounding Metrics)</h3>
<section class="ltx_subsubsection" id="S7.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.1.1 </span>Dice Coefficient</h4>
<div class="ltx_para" id="S7.SS1.SSS1.p1">
<p class="ltx_p" id="S7.SS1.SSS1.p1.2">The Dice Coefficient assesses the alignment between the predicted regions (<math alttext="\hat{R}" class="ltx_Math" display="inline" id="S7.SS1.SSS1.p1.1.m1.1"><semantics id="S7.SS1.SSS1.p1.1.m1.1a"><mover accent="true" id="S7.SS1.SSS1.p1.1.m1.1.1" xref="S7.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="S7.SS1.SSS1.p1.1.m1.1.1.2" xref="S7.SS1.SSS1.p1.1.m1.1.1.2.cmml">R</mi><mo id="S7.SS1.SSS1.p1.1.m1.1.1.1" xref="S7.SS1.SSS1.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS1.p1.1.m1.1b"><apply id="S7.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S7.SS1.SSS1.p1.1.m1.1.1"><ci id="S7.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S7.SS1.SSS1.p1.1.m1.1.1.1">^</ci><ci id="S7.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S7.SS1.SSS1.p1.1.m1.1.1.2">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS1.p1.1.m1.1c">\hat{R}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.SSS1.p1.1.m1.1d">over^ start_ARG italic_R end_ARG</annotation></semantics></math>) and expert annotations (<math alttext="R" class="ltx_Math" display="inline" id="S7.SS1.SSS1.p1.2.m2.1"><semantics id="S7.SS1.SSS1.p1.2.m2.1a"><mi id="S7.SS1.SSS1.p1.2.m2.1.1" xref="S7.SS1.SSS1.p1.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS1.p1.2.m2.1b"><ci id="S7.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S7.SS1.SSS1.p1.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS1.p1.2.m2.1c">R</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.SSS1.p1.2.m2.1d">italic_R</annotation></semantics></math>). It is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S7.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Dice}=\frac{2|\hat{R}\cap R|}{|\hat{R}|+|R|}" class="ltx_Math" display="block" id="S7.Ex5.m1.3"><semantics id="S7.Ex5.m1.3a"><mrow id="S7.Ex5.m1.3.4" xref="S7.Ex5.m1.3.4.cmml"><mtext id="S7.Ex5.m1.3.4.2" xref="S7.Ex5.m1.3.4.2a.cmml">Dice</mtext><mo id="S7.Ex5.m1.3.4.1" xref="S7.Ex5.m1.3.4.1.cmml">=</mo><mfrac id="S7.Ex5.m1.3.3" xref="S7.Ex5.m1.3.3.cmml"><mrow id="S7.Ex5.m1.1.1.1" xref="S7.Ex5.m1.1.1.1.cmml"><mn id="S7.Ex5.m1.1.1.1.3" xref="S7.Ex5.m1.1.1.1.3.cmml">2</mn><mo id="S7.Ex5.m1.1.1.1.2" xref="S7.Ex5.m1.1.1.1.2.cmml">⁢</mo><mrow id="S7.Ex5.m1.1.1.1.1.1" xref="S7.Ex5.m1.1.1.1.1.2.cmml"><mo id="S7.Ex5.m1.1.1.1.1.1.2" stretchy="false" xref="S7.Ex5.m1.1.1.1.1.2.1.cmml">|</mo><mrow id="S7.Ex5.m1.1.1.1.1.1.1" xref="S7.Ex5.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S7.Ex5.m1.1.1.1.1.1.1.2" xref="S7.Ex5.m1.1.1.1.1.1.1.2.cmml"><mi id="S7.Ex5.m1.1.1.1.1.1.1.2.2" xref="S7.Ex5.m1.1.1.1.1.1.1.2.2.cmml">R</mi><mo id="S7.Ex5.m1.1.1.1.1.1.1.2.1" xref="S7.Ex5.m1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S7.Ex5.m1.1.1.1.1.1.1.1" xref="S7.Ex5.m1.1.1.1.1.1.1.1.cmml">∩</mo><mi id="S7.Ex5.m1.1.1.1.1.1.1.3" xref="S7.Ex5.m1.1.1.1.1.1.1.3.cmml">R</mi></mrow><mo id="S7.Ex5.m1.1.1.1.1.1.3" stretchy="false" xref="S7.Ex5.m1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mrow id="S7.Ex5.m1.3.3.3" xref="S7.Ex5.m1.3.3.3.cmml"><mrow id="S7.Ex5.m1.3.3.3.4.2" xref="S7.Ex5.m1.3.3.3.4.1.cmml"><mo id="S7.Ex5.m1.3.3.3.4.2.1" stretchy="false" xref="S7.Ex5.m1.3.3.3.4.1.1.cmml">|</mo><mover accent="true" id="S7.Ex5.m1.2.2.2.1" xref="S7.Ex5.m1.2.2.2.1.cmml"><mi id="S7.Ex5.m1.2.2.2.1.2" xref="S7.Ex5.m1.2.2.2.1.2.cmml">R</mi><mo id="S7.Ex5.m1.2.2.2.1.1" xref="S7.Ex5.m1.2.2.2.1.1.cmml">^</mo></mover><mo id="S7.Ex5.m1.3.3.3.4.2.2" stretchy="false" xref="S7.Ex5.m1.3.3.3.4.1.1.cmml">|</mo></mrow><mo id="S7.Ex5.m1.3.3.3.3" xref="S7.Ex5.m1.3.3.3.3.cmml">+</mo><mrow id="S7.Ex5.m1.3.3.3.5.2" xref="S7.Ex5.m1.3.3.3.5.1.cmml"><mo id="S7.Ex5.m1.3.3.3.5.2.1" stretchy="false" xref="S7.Ex5.m1.3.3.3.5.1.1.cmml">|</mo><mi id="S7.Ex5.m1.3.3.3.2" xref="S7.Ex5.m1.3.3.3.2.cmml">R</mi><mo id="S7.Ex5.m1.3.3.3.5.2.2" stretchy="false" xref="S7.Ex5.m1.3.3.3.5.1.1.cmml">|</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex5.m1.3b"><apply id="S7.Ex5.m1.3.4.cmml" xref="S7.Ex5.m1.3.4"><eq id="S7.Ex5.m1.3.4.1.cmml" xref="S7.Ex5.m1.3.4.1"></eq><ci id="S7.Ex5.m1.3.4.2a.cmml" xref="S7.Ex5.m1.3.4.2"><mtext id="S7.Ex5.m1.3.4.2.cmml" xref="S7.Ex5.m1.3.4.2">Dice</mtext></ci><apply id="S7.Ex5.m1.3.3.cmml" xref="S7.Ex5.m1.3.3"><divide id="S7.Ex5.m1.3.3.4.cmml" xref="S7.Ex5.m1.3.3"></divide><apply id="S7.Ex5.m1.1.1.1.cmml" xref="S7.Ex5.m1.1.1.1"><times id="S7.Ex5.m1.1.1.1.2.cmml" xref="S7.Ex5.m1.1.1.1.2"></times><cn id="S7.Ex5.m1.1.1.1.3.cmml" type="integer" xref="S7.Ex5.m1.1.1.1.3">2</cn><apply id="S7.Ex5.m1.1.1.1.1.2.cmml" xref="S7.Ex5.m1.1.1.1.1.1"><abs id="S7.Ex5.m1.1.1.1.1.2.1.cmml" xref="S7.Ex5.m1.1.1.1.1.1.2"></abs><apply id="S7.Ex5.m1.1.1.1.1.1.1.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1"><intersect id="S7.Ex5.m1.1.1.1.1.1.1.1.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.1"></intersect><apply id="S7.Ex5.m1.1.1.1.1.1.1.2.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.2"><ci id="S7.Ex5.m1.1.1.1.1.1.1.2.1.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.2.1">^</ci><ci id="S7.Ex5.m1.1.1.1.1.1.1.2.2.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.2.2">𝑅</ci></apply><ci id="S7.Ex5.m1.1.1.1.1.1.1.3.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.3">𝑅</ci></apply></apply></apply><apply id="S7.Ex5.m1.3.3.3.cmml" xref="S7.Ex5.m1.3.3.3"><plus id="S7.Ex5.m1.3.3.3.3.cmml" xref="S7.Ex5.m1.3.3.3.3"></plus><apply id="S7.Ex5.m1.3.3.3.4.1.cmml" xref="S7.Ex5.m1.3.3.3.4.2"><abs id="S7.Ex5.m1.3.3.3.4.1.1.cmml" xref="S7.Ex5.m1.3.3.3.4.2.1"></abs><apply id="S7.Ex5.m1.2.2.2.1.cmml" xref="S7.Ex5.m1.2.2.2.1"><ci id="S7.Ex5.m1.2.2.2.1.1.cmml" xref="S7.Ex5.m1.2.2.2.1.1">^</ci><ci id="S7.Ex5.m1.2.2.2.1.2.cmml" xref="S7.Ex5.m1.2.2.2.1.2">𝑅</ci></apply></apply><apply id="S7.Ex5.m1.3.3.3.5.1.cmml" xref="S7.Ex5.m1.3.3.3.5.2"><abs id="S7.Ex5.m1.3.3.3.5.1.1.cmml" xref="S7.Ex5.m1.3.3.3.5.2.1"></abs><ci id="S7.Ex5.m1.3.3.3.2.cmml" xref="S7.Ex5.m1.3.3.3.2">𝑅</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex5.m1.3c">\text{Dice}=\frac{2|\hat{R}\cap R|}{|\hat{R}|+|R|}</annotation><annotation encoding="application/x-llamapun" id="S7.Ex5.m1.3d">Dice = divide start_ARG 2 | over^ start_ARG italic_R end_ARG ∩ italic_R | end_ARG start_ARG | over^ start_ARG italic_R end_ARG | + | italic_R | end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S7.SS1.SSS1.p1.3">This metric emphasizes both precision and recall, capturing spatial overlap effectively. Compared to the Intersection over Union (IoU), defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S7.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{IoU}=\frac{|\hat{R}\cap R|}{|\hat{R}\cup R|}" class="ltx_Math" display="block" id="S7.Ex6.m1.2"><semantics id="S7.Ex6.m1.2a"><mrow id="S7.Ex6.m1.2.3" xref="S7.Ex6.m1.2.3.cmml"><mtext id="S7.Ex6.m1.2.3.2" xref="S7.Ex6.m1.2.3.2a.cmml">IoU</mtext><mo id="S7.Ex6.m1.2.3.1" xref="S7.Ex6.m1.2.3.1.cmml">=</mo><mfrac id="S7.Ex6.m1.2.2" xref="S7.Ex6.m1.2.2.cmml"><mrow id="S7.Ex6.m1.1.1.1.1" xref="S7.Ex6.m1.1.1.1.2.cmml"><mo id="S7.Ex6.m1.1.1.1.1.2" stretchy="false" xref="S7.Ex6.m1.1.1.1.2.1.cmml">|</mo><mrow id="S7.Ex6.m1.1.1.1.1.1" xref="S7.Ex6.m1.1.1.1.1.1.cmml"><mover accent="true" id="S7.Ex6.m1.1.1.1.1.1.2" xref="S7.Ex6.m1.1.1.1.1.1.2.cmml"><mi id="S7.Ex6.m1.1.1.1.1.1.2.2" xref="S7.Ex6.m1.1.1.1.1.1.2.2.cmml">R</mi><mo id="S7.Ex6.m1.1.1.1.1.1.2.1" xref="S7.Ex6.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S7.Ex6.m1.1.1.1.1.1.1" xref="S7.Ex6.m1.1.1.1.1.1.1.cmml">∩</mo><mi id="S7.Ex6.m1.1.1.1.1.1.3" xref="S7.Ex6.m1.1.1.1.1.1.3.cmml">R</mi></mrow><mo id="S7.Ex6.m1.1.1.1.1.3" stretchy="false" xref="S7.Ex6.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S7.Ex6.m1.2.2.2.1" xref="S7.Ex6.m1.2.2.2.2.cmml"><mo id="S7.Ex6.m1.2.2.2.1.2" stretchy="false" xref="S7.Ex6.m1.2.2.2.2.1.cmml">|</mo><mrow id="S7.Ex6.m1.2.2.2.1.1" xref="S7.Ex6.m1.2.2.2.1.1.cmml"><mover accent="true" id="S7.Ex6.m1.2.2.2.1.1.2" xref="S7.Ex6.m1.2.2.2.1.1.2.cmml"><mi id="S7.Ex6.m1.2.2.2.1.1.2.2" xref="S7.Ex6.m1.2.2.2.1.1.2.2.cmml">R</mi><mo id="S7.Ex6.m1.2.2.2.1.1.2.1" xref="S7.Ex6.m1.2.2.2.1.1.2.1.cmml">^</mo></mover><mo id="S7.Ex6.m1.2.2.2.1.1.1" xref="S7.Ex6.m1.2.2.2.1.1.1.cmml">∪</mo><mi id="S7.Ex6.m1.2.2.2.1.1.3" xref="S7.Ex6.m1.2.2.2.1.1.3.cmml">R</mi></mrow><mo id="S7.Ex6.m1.2.2.2.1.3" stretchy="false" xref="S7.Ex6.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex6.m1.2b"><apply id="S7.Ex6.m1.2.3.cmml" xref="S7.Ex6.m1.2.3"><eq id="S7.Ex6.m1.2.3.1.cmml" xref="S7.Ex6.m1.2.3.1"></eq><ci id="S7.Ex6.m1.2.3.2a.cmml" xref="S7.Ex6.m1.2.3.2"><mtext id="S7.Ex6.m1.2.3.2.cmml" xref="S7.Ex6.m1.2.3.2">IoU</mtext></ci><apply id="S7.Ex6.m1.2.2.cmml" xref="S7.Ex6.m1.2.2"><divide id="S7.Ex6.m1.2.2.3.cmml" xref="S7.Ex6.m1.2.2"></divide><apply id="S7.Ex6.m1.1.1.1.2.cmml" xref="S7.Ex6.m1.1.1.1.1"><abs id="S7.Ex6.m1.1.1.1.2.1.cmml" xref="S7.Ex6.m1.1.1.1.1.2"></abs><apply id="S7.Ex6.m1.1.1.1.1.1.cmml" xref="S7.Ex6.m1.1.1.1.1.1"><intersect id="S7.Ex6.m1.1.1.1.1.1.1.cmml" xref="S7.Ex6.m1.1.1.1.1.1.1"></intersect><apply id="S7.Ex6.m1.1.1.1.1.1.2.cmml" xref="S7.Ex6.m1.1.1.1.1.1.2"><ci id="S7.Ex6.m1.1.1.1.1.1.2.1.cmml" xref="S7.Ex6.m1.1.1.1.1.1.2.1">^</ci><ci id="S7.Ex6.m1.1.1.1.1.1.2.2.cmml" xref="S7.Ex6.m1.1.1.1.1.1.2.2">𝑅</ci></apply><ci id="S7.Ex6.m1.1.1.1.1.1.3.cmml" xref="S7.Ex6.m1.1.1.1.1.1.3">𝑅</ci></apply></apply><apply id="S7.Ex6.m1.2.2.2.2.cmml" xref="S7.Ex6.m1.2.2.2.1"><abs id="S7.Ex6.m1.2.2.2.2.1.cmml" xref="S7.Ex6.m1.2.2.2.1.2"></abs><apply id="S7.Ex6.m1.2.2.2.1.1.cmml" xref="S7.Ex6.m1.2.2.2.1.1"><union id="S7.Ex6.m1.2.2.2.1.1.1.cmml" xref="S7.Ex6.m1.2.2.2.1.1.1"></union><apply id="S7.Ex6.m1.2.2.2.1.1.2.cmml" xref="S7.Ex6.m1.2.2.2.1.1.2"><ci id="S7.Ex6.m1.2.2.2.1.1.2.1.cmml" xref="S7.Ex6.m1.2.2.2.1.1.2.1">^</ci><ci id="S7.Ex6.m1.2.2.2.1.1.2.2.cmml" xref="S7.Ex6.m1.2.2.2.1.1.2.2">𝑅</ci></apply><ci id="S7.Ex6.m1.2.2.2.1.1.3.cmml" xref="S7.Ex6.m1.2.2.2.1.1.3">𝑅</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex6.m1.2c">\text{IoU}=\frac{|\hat{R}\cap R|}{|\hat{R}\cup R|}</annotation><annotation encoding="application/x-llamapun" id="S7.Ex6.m1.2d">IoU = divide start_ARG | over^ start_ARG italic_R end_ARG ∩ italic_R | end_ARG start_ARG | over^ start_ARG italic_R end_ARG ∪ italic_R | end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S7.SS1.SSS1.p1.4">the Dice Coefficient generally yields higher values for partial overlaps and is more sensitive to small mismatches.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S7.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.1.2 </span>Hit-rate Metric</h4>
<div class="ltx_para" id="S7.SS1.SSS2.p1">
<p class="ltx_p" id="S7.SS1.SSS2.p1.1">The Hit-rate metric evaluates the extent to which algorithmically identified key areas overlap with expert annotations. A higher Hit-rate indicates better alignment between the model’s focus and expert annotations, highlighting improvements in interpretability.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S7.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span>Classification Metrics</h3>
<section class="ltx_subsubsection" id="S7.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.2.1 </span>AUC (Area Under the Curve)</h4>
<div class="ltx_para" id="S7.SS2.SSS1.p1">
<p class="ltx_p" id="S7.SS2.SSS1.p1.1">The AUC-ROC measures the model’s ability to distinguish between classes across different thresholds. An AUC value close to 1 indicates excellent performance, while a value around 0.5 suggests performance no better than random chance, demonstrating the model’s discriminative power.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S7.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.2.2 </span>MCC (Matthews Correlation Coefficient)</h4>
<div class="ltx_para" id="S7.SS2.SSS2.p1">
<p class="ltx_p" id="S7.SS2.SSS2.p1.1">The MCC evaluates binary classification quality, providing a balanced score even with unbalanced classes. Values range from -1 (total disagreement) to +1 (perfect prediction), with 0 indicating random guessing. MCC is particularly useful in fields like clinical diagnostics where balanced accuracy is critical.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S7.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.2.3 </span>F1 Score</h4>
<div class="ltx_para" id="S7.SS2.SSS3.p1">
<p class="ltx_p" id="S7.SS2.SSS3.p1.1">The F1 Score is the harmonic mean of precision and recall, ranging from 0 to 1. A score of 1 indicates perfect precision and recall. This metric is crucial in scenarios where both false positives and false negatives carry significant costs and performs well under uneven class distribution.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Results</h2>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">In this section, we evaluate our method with three prominent datasets and compare it with the baselines.</p>
</div>
<section class="ltx_subsection" id="S8.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.1 </span>Finding specific grounding experts</h3>
<div class="ltx_para" id="S8.SS1.p1">
<p class="ltx_p" id="S8.SS1.p1.1">In our derived version, we trained disease-specific experts to mimic human attention to categorised datasets without annotations as shown in Tab.<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S8.T1" title="Table 1 ‣ 8.1 Finding specific grounding experts ‣ 8 Results ‣ Drawf"><span class="ltx_text ltx_ref_tag">1</span></a>. We divide it into 3 versions. four findings version includes common findings includes Atelectasis, Cardiomegaly, Consolidation and Effusion. The improved 7 findings includes additional Diffuse Nodule, Emphysema and Mass. Those seven findings are with relative high performance. The full version is original ChexDet dataset with 14 findings.</p>
</div>
<figure class="ltx_table" id="S8.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Segmentation Experts for each disease</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S8.T1.1" style="width:433.6pt;height:241.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(71.3pt,-39.7pt) scale(1.48995908785167,1.48995908785167) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S8.T1.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S8.T1.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S8.T1.1.1.1.1.1">Finding</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S8.T1.1.1.1.1.2">Dice score</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S8.T1.1.1.1.1.3">Finding</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T1.1.1.1.1.4">Dice score</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.T1.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S8.T1.1.1.2.1.1">Atelectasis</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S8.T1.1.1.2.1.2"><span class="ltx_text" id="S8.T1.1.1.2.1.2.1" style="color:#FF0000;">0.3031</span></td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S8.T1.1.1.2.1.3">Fracture</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T1.1.1.2.1.4">0.0755</td>
</tr>
<tr class="ltx_tr" id="S8.T1.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S8.T1.1.1.3.2.1">Calcification</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S8.T1.1.1.3.2.2">0.0073</td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S8.T1.1.1.3.2.3">Mass</th>
<td class="ltx_td ltx_align_center" id="S8.T1.1.1.3.2.4"><span class="ltx_text" id="S8.T1.1.1.3.2.4.1" style="color:#00FF00;">0.4583</span></td>
</tr>
<tr class="ltx_tr" id="S8.T1.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S8.T1.1.1.4.3.1">Cardiomegaly</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S8.T1.1.1.4.3.2"><span class="ltx_text" id="S8.T1.1.1.4.3.2.1" style="color:#FF0000;">0.8342</span></td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S8.T1.1.1.4.3.3">Nodule</th>
<td class="ltx_td ltx_align_center" id="S8.T1.1.1.4.3.4">0.0355</td>
</tr>
<tr class="ltx_tr" id="S8.T1.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S8.T1.1.1.5.4.1">Consolidation</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S8.T1.1.1.5.4.2"><span class="ltx_text" id="S8.T1.1.1.5.4.2.1" style="color:#FF0000;">0.4288</span></td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S8.T1.1.1.5.4.3">Pleural Thickening</th>
<td class="ltx_td ltx_align_center" id="S8.T1.1.1.5.4.4">0.1355</td>
</tr>
<tr class="ltx_tr" id="S8.T1.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S8.T1.1.1.6.5.1">Diffuse Nodule</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S8.T1.1.1.6.5.2"><span class="ltx_text" id="S8.T1.1.1.6.5.2.1" style="color:#00FF00;">0.4441</span></td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S8.T1.1.1.6.5.3">Pneumothorax</th>
<td class="ltx_td ltx_align_center" id="S8.T1.1.1.6.5.4">0.0707</td>
</tr>
<tr class="ltx_tr" id="S8.T1.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S8.T1.1.1.7.6.1">Effusion</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S8.T1.1.1.7.6.2"><span class="ltx_text" id="S8.T1.1.1.7.6.2.1" style="color:#FF0000;">0.3525</span></td>
<th class="ltx_td ltx_th ltx_th_row" id="S8.T1.1.1.7.6.3"></th>
<td class="ltx_td" id="S8.T1.1.1.7.6.4"></td>
</tr>
<tr class="ltx_tr" id="S8.T1.1.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S8.T1.1.1.8.7.1">Emphysema</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S8.T1.1.1.8.7.2"><span class="ltx_text" id="S8.T1.1.1.8.7.2.1" style="color:#00FF00;">0.4355</span></td>
<th class="ltx_td ltx_th ltx_th_row" id="S8.T1.1.1.8.7.3"></th>
<td class="ltx_td" id="S8.T1.1.1.8.7.4"></td>
</tr>
<tr class="ltx_tr" id="S8.T1.1.1.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S8.T1.1.1.9.8.1">Fibrosis</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S8.T1.1.1.9.8.2">0.1621</td>
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb" id="S8.T1.1.1.9.8.3"></th>
<td class="ltx_td ltx_border_bb" id="S8.T1.1.1.9.8.4"></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S8.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Comparison between Dwarf and naive training with CLS Loss and Seg Loss</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S8.T2.1" style="width:433.6pt;height:129.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(5.7pt,-1.7pt) scale(1.02679032112138,1.02679032112138) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S8.T2.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S8.T2.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S8.T2.1.1.1.1.1">Backbone</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S8.T2.1.1.1.1.2">Disease number</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T2.1.1.1.1.3">Dice</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T2.1.1.1.1.4">AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T2.1.1.1.1.5">Max Dice</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T2.1.1.1.1.6">Max AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T2.1.1.1.1.7">F1/MCC</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.T2.1.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S8.T2.1.1.2.1.1" rowspan="3"><span class="ltx_text" id="S8.T2.1.1.2.1.1.1">CLS Loss only</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S8.T2.1.1.2.1.2">4</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T2.1.1.2.1.3">0.1438</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T2.1.1.2.1.4">0.8680</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T2.1.1.2.1.5">0.1438</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T2.1.1.2.1.6">0.8680</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T2.1.1.2.1.7"><span class="ltx_text ltx_font_bold" id="S8.T2.1.1.2.1.7.1">-</span></td>
</tr>
<tr class="ltx_tr" id="S8.T2.1.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S8.T2.1.1.3.2.1">7</th>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.3.2.2">0.1903</td>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.3.2.3">0.8519</td>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.3.2.4">0.1903</td>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.3.2.5">0.8519</td>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.3.2.6"><span class="ltx_text ltx_font_bold" id="S8.T2.1.1.3.2.6.1">-</span></td>
</tr>
<tr class="ltx_tr" id="S8.T2.1.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S8.T2.1.1.4.3.1">14</th>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.4.3.2">0.1385</td>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.4.3.3">0.8090</td>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.4.3.4">0.1390</td>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.4.3.5">0.8090</td>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.4.3.6">0.4857/0.4265</td>
</tr>
<tr class="ltx_tr" id="S8.T2.1.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S8.T2.1.1.5.4.1" rowspan="3"><span class="ltx_text" id="S8.T2.1.1.5.4.1.1">Dwarf</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S8.T2.1.1.5.4.2">4</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T2.1.1.5.4.3"><span class="ltx_text ltx_font_bold" id="S8.T2.1.1.5.4.3.1">0.3854</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T2.1.1.5.4.4"><span class="ltx_text ltx_font_bold" id="S8.T2.1.1.5.4.4.1">0.8729</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T2.1.1.5.4.5"><span class="ltx_text ltx_font_bold" id="S8.T2.1.1.5.4.5.1">0.4147</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T2.1.1.5.4.6"><span class="ltx_text ltx_font_bold" id="S8.T2.1.1.5.4.6.1">0.8871</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T2.1.1.5.4.7"><span class="ltx_text ltx_font_bold" id="S8.T2.1.1.5.4.7.1">-</span></td>
</tr>
<tr class="ltx_tr" id="S8.T2.1.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S8.T2.1.1.6.5.1">7</th>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.6.5.2"><span class="ltx_text ltx_font_bold" id="S8.T2.1.1.6.5.2.1">0.3492</span></td>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.6.5.3"><span class="ltx_text ltx_font_bold" id="S8.T2.1.1.6.5.3.1">0.8508</span></td>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.6.5.4"><span class="ltx_text ltx_font_bold" id="S8.T2.1.1.6.5.4.1">0.3559</span></td>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.6.5.5"><span class="ltx_text ltx_font_bold" id="S8.T2.1.1.6.5.5.1">0.8717</span></td>
<td class="ltx_td ltx_align_center" id="S8.T2.1.1.6.5.6">0.6017/0.5201</td>
</tr>
<tr class="ltx_tr" id="S8.T2.1.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S8.T2.1.1.7.6.1">14</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T2.1.1.7.6.2">0.1646</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T2.1.1.7.6.3">0.8114</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T2.1.1.7.6.4">0.1805</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T2.1.1.7.6.5">0.8157</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T2.1.1.7.6.6">0.5344/0.4992</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S8.SS1.tab1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Comparison between Dwarf and naive training with CLS Loss and Seg Loss</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S8.SS1.tab1.1" style="width:433.6pt;height:164.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(50.9pt,-19.3pt) scale(1.30684778338396,1.30684778338396) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S8.SS1.tab1.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S8.SS1.tab1.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.SS1.tab1.1.1.1.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.SS1.tab1.1.1.1.1.2">Dataset/Metrics</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.SS1.tab1.1.1.1.1.3">Max AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.SS1.tab1.1.1.1.1.4">Max Dice</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.SS1.tab1.1.1.1.1.5">F1 score</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.SS1.tab1.1.1.1.1.6">MCC</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.SS1.tab1.1.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.2.1.1"><span class="ltx_text" id="S8.SS1.tab1.1.1.2.1.1.1">w/o</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.2.1.2">ChestX-Det</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.2.1.3">0.8090</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.2.1.4">0.1390</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.2.1.5">0.4857</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.2.1.6">0.4265</td>
</tr>
<tr class="ltx_tr" id="S8.SS1.tab1.1.1.3.2">
<td class="ltx_td" id="S8.SS1.tab1.1.1.3.2.1"></td>
<td class="ltx_td ltx_align_center" id="S8.SS1.tab1.1.1.3.2.2"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.3.2.2.1">ChestX-Det</span></td>
<td class="ltx_td ltx_align_center" id="S8.SS1.tab1.1.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.3.2.3.1">0.8157</span></td>
<td class="ltx_td ltx_align_center" id="S8.SS1.tab1.1.1.3.2.4"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.3.2.4.1">0.1805</span></td>
<td class="ltx_td ltx_align_center" id="S8.SS1.tab1.1.1.3.2.5"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.3.2.5.1">0.5344</span></td>
<td class="ltx_td ltx_align_center" id="S8.SS1.tab1.1.1.3.2.6"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.3.2.6.1">0.4992</span></td>
</tr>
<tr class="ltx_tr" id="S8.SS1.tab1.1.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.4.3.1"><span class="ltx_text" id="S8.SS1.tab1.1.1.4.3.1.1">w/o</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.4.3.2">cheXlocalize</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.4.3.3">0.8364</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.4.3.4">0.1191</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.4.3.5">0.6286</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.4.3.6">0.5018</td>
</tr>
<tr class="ltx_tr" id="S8.SS1.tab1.1.1.5.4">
<td class="ltx_td" id="S8.SS1.tab1.1.1.5.4.1"></td>
<td class="ltx_td ltx_align_center" id="S8.SS1.tab1.1.1.5.4.2"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.5.4.2.1">cheXlocalize</span></td>
<td class="ltx_td ltx_align_center" id="S8.SS1.tab1.1.1.5.4.3"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.5.4.3.1">0.8488</span></td>
<td class="ltx_td ltx_align_center" id="S8.SS1.tab1.1.1.5.4.4"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.5.4.4.1">0.1289</span></td>
<td class="ltx_td ltx_align_center" id="S8.SS1.tab1.1.1.5.4.5"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.5.4.5.1">0.6364</span></td>
<td class="ltx_td ltx_align_center" id="S8.SS1.tab1.1.1.5.4.6"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.5.4.6.1">0.5047</span></td>
</tr>
<tr class="ltx_tr" id="S8.SS1.tab1.1.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.6.5.1"><span class="ltx_text" id="S8.SS1.tab1.1.1.6.5.1.1">w/o</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.6.5.2">Vindr-CXR</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.6.5.3">0.7851</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.6.5.4">0.0723</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.6.5.5">0.4520</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.SS1.tab1.1.1.6.5.6">0.3648</td>
</tr>
<tr class="ltx_tr" id="S8.SS1.tab1.1.1.7.6">
<td class="ltx_td ltx_border_bb" id="S8.SS1.tab1.1.1.7.6.1"></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.SS1.tab1.1.1.7.6.2"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.7.6.2.1">Vindr-CXR</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.SS1.tab1.1.1.7.6.3"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.7.6.3.1">0.7977</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.SS1.tab1.1.1.7.6.4"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.7.6.4.1">0.1062</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.SS1.tab1.1.1.7.6.5"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.7.6.5.1">0.4591</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.SS1.tab1.1.1.7.6.6"><span class="ltx_text ltx_font_bold" id="S8.SS1.tab1.1.1.7.6.6.1">0.3848</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S8.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comparison between cyclic training and direct multi-label Segmentation Loss</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S8.T4.1" style="width:433.6pt;height:78pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(66.7pt,-12.0pt) scale(1.44459564267475,1.44459564267475) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S8.T4.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S8.T4.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S8.T4.1.1.1.1.1">Backbone</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S8.T4.1.1.1.1.2">Disease number</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T4.1.1.1.1.3">Max Dice</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T4.1.1.1.1.4">Max AUC</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.T4.1.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S8.T4.1.1.2.1.1"><span class="ltx_text" id="S8.T4.1.1.2.1.1.1">CLS Loss + Seg Loss</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S8.T4.1.1.2.1.2">7</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.1.1.2.1.3">0.2335</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.1.1.2.1.4">0.8532</td>
</tr>
<tr class="ltx_tr" id="S8.T4.1.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S8.T4.1.1.3.2.1"><span class="ltx_text" id="S8.T4.1.1.3.2.1.1">Dwarf</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S8.T4.1.1.3.2.2">7</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T4.1.1.3.2.3">0.3559</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T4.1.1.3.2.4">0.871</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S8.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.2 </span>Ablations</h3>
<div class="ltx_para" id="S8.SS2.p1">
<p class="ltx_p" id="S8.SS2.p1.1">In this section, we conduct ablation study to investigate the contribution of disease specific head and our cyclic training strategy.
With our cyclic training framework, the Dice score result of multi-label segmentation performance improved from 0.2335 to <span class="ltx_text ltx_font_bold" id="S8.SS2.p1.1.1">0.3492</span>
as well as the max AUC score improves from 0.8532 to 0.8717 as shown in Tab.<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S8.T5" title="Table 5 ‣ 8.2 Ablations ‣ 8 Results ‣ Drawf"><span class="ltx_text ltx_ref_tag">5</span></a>. Also, We explored the scalability and stability of Dwarf. By comparing Dwarf with naive training using only CLS Loss and Seg Loss, we observed significant improvements across different numbers of diseases. For 7 diseases, the Dice score improved from 0.1903 to <span class="ltx_text ltx_font_bold" id="S8.SS2.p1.1.2">0.3492</span>, and the max AUC score increased from 0.8519 to <span class="ltx_text ltx_font_bold" id="S8.SS2.p1.1.3">0.8717</span>. Similarly, for 4 diseases, the Dice score improved from 0.1438 to <span class="ltx_text ltx_font_bold" id="S8.SS2.p1.1.4">0.3854</span>, and the max AUC score increased from 0.8660 to <span class="ltx_text ltx_font_bold" id="S8.SS2.p1.1.5">0.8871</span>. These results, as shown in the table below, highlight the consistent enhancement provided by Dwarf across different numbers of diseases.
Furthermore, we investigate the performance of different prompts (Tab.<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S8.T6" title="Table 6 ‣ 8.2 Ablations ‣ 8 Results ‣ Drawf"><span class="ltx_text ltx_ref_tag">6</span></a>), specifically those involving the disease name and visual cues created by radiologists. Directly using the disease name yields better performance, likely because the pretraining prompt consists only of the disease name.
Finally, since our model is only trained once per epoch, it might result in insufficient training within the same number of epochs. Therefore, we extended the training from 500 epochs to 1000 epochs to explore the scalability of the model’s performance. We found that the Dice score improved from 0.1805 to 0.2302 as shown in Tab.<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S8.T7" title="Table 7 ‣ 8.2 Ablations ‣ 8 Results ‣ Drawf"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<figure class="ltx_table" id="S8.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Ablations of disease-specific head</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S8.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S8.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S8.T5.1.1.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T5.1.1.1.2">Max DICE</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T5.1.1.1.3">Max AUC</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.T5.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S8.T5.1.2.1.1">Directly optimize</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T5.1.2.1.2">0.2288</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S8.T5.1.2.1.3">0.8663</td>
</tr>
<tr class="ltx_tr" id="S8.T5.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S8.T5.1.3.2.1">Introducing disease-specific head</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T5.1.3.2.2">0.3559</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S8.T5.1.3.2.3">0.8732</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S8.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Ablations of text input context</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S8.T6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S8.T6.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S8.T6.1.1.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T6.1.1.1.2">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T6.1.1.1.3">Max DICE</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T6.1.1.1.4">Max AUC</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.T6.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S8.T6.1.2.1.1">Disease name only</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T6.1.2.1.2">ChestX-Det</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T6.1.2.1.3">0.1805</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S8.T6.1.2.1.4">0.8157</td>
</tr>
<tr class="ltx_tr" id="S8.T6.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S8.T6.1.3.2.1">With detailed visual cues</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T6.1.3.2.2">ChestX-Det</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T6.1.3.2.3">0.1769</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S8.T6.1.3.2.4">0.8125</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S8.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Ablations of training epochs</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S8.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S8.T7.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S8.T7.1.1.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T7.1.1.1.2">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T7.1.1.1.3">Max DICE</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T7.1.1.1.4">Max AUC</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.T7.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S8.T7.1.2.1.1">500 epochs</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T7.1.2.1.2">ChestX-Det</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T7.1.2.1.3">0.1805</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S8.T7.1.2.1.4">0.8157</td>
</tr>
<tr class="ltx_tr" id="S8.T7.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S8.T7.1.3.2.1">1000 epochs</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T7.1.3.2.2">ChestX-Det</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T7.1.3.2.3">0.2302</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S8.T7.1.3.2.4">0.8231</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S8.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Ablations of expert supervision</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S8.T8.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S8.T8.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S8.T8.1.1.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S8.T8.1.1.1.2">Disease numbers</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T8.1.1.1.3">DICE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T8.1.1.1.4">AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T8.1.1.1.5">Max DICE</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T8.1.1.1.6">Max AUC</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.T8.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S8.T8.1.2.1.1">CLS Loss only</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S8.T8.1.2.1.2">7</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T8.1.2.1.3">0.1438</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T8.1.2.1.4">0.8680</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T8.1.2.1.5">0.1438</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S8.T8.1.2.1.6">0.8680</td>
</tr>
<tr class="ltx_tr" id="S8.T8.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S8.T8.1.3.2.1">Dwarf (expert teachers)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S8.T8.1.3.2.2">7</th>
<td class="ltx_td ltx_align_center" id="S8.T8.1.3.2.3">0.3171</td>
<td class="ltx_td ltx_align_center" id="S8.T8.1.3.2.4">0.8473</td>
<td class="ltx_td ltx_align_center" id="S8.T8.1.3.2.5">0.3694</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S8.T8.1.3.2.6">0.8757</td>
</tr>
<tr class="ltx_tr" id="S8.T8.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S8.T8.1.4.3.1">Dwarf</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S8.T8.1.4.3.2">7</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T8.1.4.3.3"><span class="ltx_text ltx_font_bold" id="S8.T8.1.4.3.3.1">0.3856</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T8.1.4.3.4"><span class="ltx_text ltx_font_bold" id="S8.T8.1.4.3.4.1">0.8578</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T8.1.4.3.5"><span class="ltx_text ltx_font_bold" id="S8.T8.1.4.3.5.1">0.3911</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S8.T8.1.4.3.6"><span class="ltx_text ltx_font_bold" id="S8.T8.1.4.3.6.1">0.8766</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S8.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.3 </span>Qualitative Result</h3>
<div class="ltx_para" id="S8.SS3.p1">
<p class="ltx_p" id="S8.SS3.p1.1">To enhance the clarity of the explanation regarding the visual explainability representation of our method, we illustrate the attention map using the test set of the CheX-Det dataset. As depicted in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S8.F3" title="Figure 3 ‣ 8.3 Qualitative Result ‣ 8 Results ‣ Drawf"><span class="ltx_text ltx_ref_tag">3</span></a>, our Dwarf method significantly improves the focus of the classification model’s attention. This enhancement allows the model to more precisely highlight the relevant areas that form the basis for its classification decisions. Also, we illustrates the attention map for different findings in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2406.17032v2#S8.F4" title="Figure 4 ‣ 8.3 Qualitative Result ‣ 8 Results ‣ Drawf"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure class="ltx_figure" id="S8.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="311" id="S8.F3.g1" src="x3.png" width="926"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Qualitative results of training with and without the Dwarf architecture demonstrate that utilizing our Dwarf framework consistently enhances the aggregation of feature maps and provides prior region information.</figcaption>
</figure>
<figure class="ltx_figure" id="S8.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="568" id="S8.F4.g1" src="x4.png" width="762"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Qualitative results of our method. Our method could precisely locates the diseases with only attention map as explainations.</figcaption>
</figure>
<figure class="ltx_figure" id="S8.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="200" id="S8.F5.g1" src="x5.png" width="762"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Qualitative results of more findings.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S9">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9 </span>Conclusion</h2>
<div class="ltx_para" id="S9.p1">
<p class="ltx_p" id="S9.p1.1">In this research, we have developed a two-stage saliency map revision strategy. This approach effectively integrates disease-related knowledge and clinicians’ preferences into the generation of saliency maps. By incorporating this methodology, we are also introducing clinicians into the AI training loop. This inclusion fosters enhanced human-computer interactions, making the AI more intuitive and relevant for medical professionals. This strategy not only improves the accuracy of the AI but also makes it more user-friendly for clinicians, ensuring that their expertise and insights are reflected in the AI’s learning process.</p>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Jun 28 14:32:45 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
