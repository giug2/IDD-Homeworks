<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600).</title>
<!--Generated on Tue Oct  8 11:36:05 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
Recommendation,  Large Language Models,  Knowledge Enhancement,  Reject Sample Fine-tuning
" lang="en" name="keywords"/>
<base href="/html/2410.05939v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S1" title="In RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">INTRODUCTION</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S2" title="In RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">METHODOLOGY</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S2.SS1" title="In II METHODOLOGY ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-A</span> </span><span class="ltx_text ltx_font_italic">Knowledge Augmentation from LLM</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S2.SS2" title="In II METHODOLOGY ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-B</span> </span><span class="ltx_text ltx_font_italic">Feedback of the Recommendations</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S2.SS3" title="In II METHODOLOGY ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-C</span> </span><span class="ltx_text ltx_font_italic">Knowledge Alignment</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3" title="In RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">EXPERIMENTS</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.SS1" title="In III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Experiments Settings</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.SS1.SSS1" title="In III-A Experiments Settings ‣ III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span>1 </span>Dadasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.SS1.SSS2" title="In III-A Experiments Settings ‣ III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span>2 </span>Backbones</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.SS1.SSS3" title="In III-A Experiments Settings ‣ III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span>3 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.SS1.SSS4" title="In III-A Experiments Settings ‣ III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span>4 </span>Implementation Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.SS2" title="In III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">Main Result</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.SS3" title="In III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span> </span><span class="ltx_text ltx_font_italic">Ablation Study</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.SS3.SSS1" title="In III-C Ablation Study ‣ III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span>1 </span>Performance with Knowledge and DPO</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.SS3.SSS2" title="In III-C Ablation Study ‣ III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span>2 </span>Performance with Iteration Number</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.SS3.SSS2.Px1" title="In III-C2 Performance with Iteration Number ‣ III-C Ablation Study ‣ III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title">MAP@5 (Figure a)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.SS3.SSS2.Px2" title="In III-C2 Performance with Iteration Number ‣ III-C Ablation Study ‣ III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_title">NDCG@5 (Figure b)</span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking
<span class="ltx_note ltx_role_thanks" id="id1.1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span><sup class="ltx_sup" id="id1.1.1"><span class="ltx_text ltx_font_italic" id="id1.1.1.1">⋆</span></sup>Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600).</span></span></span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">

Chao Sun<span class="ltx_text" id="id2.1.1" style="position:relative; bottom:0.0pt;"><sup class="ltx_sup" id="id2.1.1.1"><math alttext="1,2" class="ltx_Math" display="inline" id="id2.1.1.1.m1.2"><semantics id="id2.1.1.1.m1.2a"><mrow id="id2.1.1.1.m1.2.3.2" xref="id2.1.1.1.m1.2.3.1.cmml"><mn id="id2.1.1.1.m1.1.1" mathsize="80%" xref="id2.1.1.1.m1.1.1.cmml">1</mn><mo id="id2.1.1.1.m1.2.3.2.1" mathsize="80%" xref="id2.1.1.1.m1.2.3.1.cmml">,</mo><mn id="id2.1.1.1.m1.2.2" mathsize="80%" xref="id2.1.1.1.m1.2.2.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="id2.1.1.1.m1.2b"><list id="id2.1.1.1.m1.2.3.1.cmml" xref="id2.1.1.1.m1.2.3.2"><cn id="id2.1.1.1.m1.1.1.cmml" type="integer" xref="id2.1.1.1.m1.1.1">1</cn><cn id="id2.1.1.1.m1.2.2.cmml" type="integer" xref="id2.1.1.1.m1.2.2">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="id2.1.1.1.m1.2c">1,2</annotation><annotation encoding="application/x-llamapun" id="id2.1.1.1.m1.2d">1 , 2</annotation></semantics></math></sup></span>,
Yaobo Liang<span class="ltx_text" id="id3.2.2" style="position:relative; bottom:0.0pt;"><sup class="ltx_sup" id="id3.2.2.1"><math alttext="1,2" class="ltx_Math" display="inline" id="id3.2.2.1.m1.2"><semantics id="id3.2.2.1.m1.2a"><mrow id="id3.2.2.1.m1.2.3.2" xref="id3.2.2.1.m1.2.3.1.cmml"><mn id="id3.2.2.1.m1.1.1" mathsize="80%" xref="id3.2.2.1.m1.1.1.cmml">1</mn><mo id="id3.2.2.1.m1.2.3.2.1" mathsize="80%" xref="id3.2.2.1.m1.2.3.1.cmml">,</mo><mn id="id3.2.2.1.m1.2.2" mathsize="80%" xref="id3.2.2.1.m1.2.2.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="id3.2.2.1.m1.2b"><list id="id3.2.2.1.m1.2.3.1.cmml" xref="id3.2.2.1.m1.2.3.2"><cn id="id3.2.2.1.m1.1.1.cmml" type="integer" xref="id3.2.2.1.m1.1.1">1</cn><cn id="id3.2.2.1.m1.2.2.cmml" type="integer" xref="id3.2.2.1.m1.2.2">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="id3.2.2.1.m1.2c">1,2</annotation><annotation encoding="application/x-llamapun" id="id3.2.2.1.m1.2d">1 , 2</annotation></semantics></math></sup></span>,
Yaming Yang<span class="ltx_text" id="id4.3.3" style="position:relative; bottom:0.0pt;"><sup class="ltx_sup" id="id4.3.3.1"><math alttext="1,2" class="ltx_Math" display="inline" id="id4.3.3.1.m1.2"><semantics id="id4.3.3.1.m1.2a"><mrow id="id4.3.3.1.m1.2.3.2" xref="id4.3.3.1.m1.2.3.1.cmml"><mn id="id4.3.3.1.m1.1.1" mathsize="80%" xref="id4.3.3.1.m1.1.1.cmml">1</mn><mo id="id4.3.3.1.m1.2.3.2.1" mathsize="80%" xref="id4.3.3.1.m1.2.3.1.cmml">,</mo><mn id="id4.3.3.1.m1.2.2" mathsize="80%" xref="id4.3.3.1.m1.2.2.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="id4.3.3.1.m1.2b"><list id="id4.3.3.1.m1.2.3.1.cmml" xref="id4.3.3.1.m1.2.3.2"><cn id="id4.3.3.1.m1.1.1.cmml" type="integer" xref="id4.3.3.1.m1.1.1">1</cn><cn id="id4.3.3.1.m1.2.2.cmml" type="integer" xref="id4.3.3.1.m1.2.2">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="id4.3.3.1.m1.2c">1,2</annotation><annotation encoding="application/x-llamapun" id="id4.3.3.1.m1.2d">1 , 2</annotation></semantics></math></sup></span>,
Shilin Xu<span class="ltx_text" id="id5.4.4" style="position:relative; bottom:0.0pt;"><sup class="ltx_sup" id="id5.4.4.1"><math alttext="1,2" class="ltx_Math" display="inline" id="id5.4.4.1.m1.2"><semantics id="id5.4.4.1.m1.2a"><mrow id="id5.4.4.1.m1.2.3.2" xref="id5.4.4.1.m1.2.3.1.cmml"><mn id="id5.4.4.1.m1.1.1" mathsize="80%" xref="id5.4.4.1.m1.1.1.cmml">1</mn><mo id="id5.4.4.1.m1.2.3.2.1" mathsize="80%" xref="id5.4.4.1.m1.2.3.1.cmml">,</mo><mn id="id5.4.4.1.m1.2.2" mathsize="80%" xref="id5.4.4.1.m1.2.2.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="id5.4.4.1.m1.2b"><list id="id5.4.4.1.m1.2.3.1.cmml" xref="id5.4.4.1.m1.2.3.2"><cn id="id5.4.4.1.m1.1.1.cmml" type="integer" xref="id5.4.4.1.m1.1.1">1</cn><cn id="id5.4.4.1.m1.2.2.cmml" type="integer" xref="id5.4.4.1.m1.2.2">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="id5.4.4.1.m1.2c">1,2</annotation><annotation encoding="application/x-llamapun" id="id5.4.4.1.m1.2d">1 , 2</annotation></semantics></math></sup></span>,
Tianmeng Yang<span class="ltx_text" id="id6.5.5" style="position:relative; bottom:0.0pt;"><sup class="ltx_sup" id="id6.5.5.1"><math alttext="1,2" class="ltx_Math" display="inline" id="id6.5.5.1.m1.2"><semantics id="id6.5.5.1.m1.2a"><mrow id="id6.5.5.1.m1.2.3.2" xref="id6.5.5.1.m1.2.3.1.cmml"><mn id="id6.5.5.1.m1.1.1" mathsize="80%" xref="id6.5.5.1.m1.1.1.cmml">1</mn><mo id="id6.5.5.1.m1.2.3.2.1" mathsize="80%" xref="id6.5.5.1.m1.2.3.1.cmml">,</mo><mn id="id6.5.5.1.m1.2.2" mathsize="80%" xref="id6.5.5.1.m1.2.2.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="id6.5.5.1.m1.2b"><list id="id6.5.5.1.m1.2.3.1.cmml" xref="id6.5.5.1.m1.2.3.2"><cn id="id6.5.5.1.m1.1.1.cmml" type="integer" xref="id6.5.5.1.m1.1.1">1</cn><cn id="id6.5.5.1.m1.2.2.cmml" type="integer" xref="id6.5.5.1.m1.2.2">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="id6.5.5.1.m1.2c">1,2</annotation><annotation encoding="application/x-llamapun" id="id6.5.5.1.m1.2d">1 , 2</annotation></semantics></math></sup></span>,
Yunhai Tong<span class="ltx_text" id="id7.6.6" style="position:relative; bottom:0.0pt;"><sup class="ltx_sup" id="id7.6.6.1"><math alttext="1,2" class="ltx_Math" display="inline" id="id7.6.6.1.m1.2"><semantics id="id7.6.6.1.m1.2a"><mrow id="id7.6.6.1.m1.2.3.2" xref="id7.6.6.1.m1.2.3.1.cmml"><mn id="id7.6.6.1.m1.1.1" mathsize="80%" xref="id7.6.6.1.m1.1.1.cmml">1</mn><mo id="id7.6.6.1.m1.2.3.2.1" mathsize="80%" xref="id7.6.6.1.m1.2.3.1.cmml">,</mo><mn id="id7.6.6.1.m1.2.2" mathsize="80%" xref="id7.6.6.1.m1.2.2.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="id7.6.6.1.m1.2b"><list id="id7.6.6.1.m1.2.3.1.cmml" xref="id7.6.6.1.m1.2.3.2"><cn id="id7.6.6.1.m1.1.1.cmml" type="integer" xref="id7.6.6.1.m1.1.1">1</cn><cn id="id7.6.6.1.m1.2.2.cmml" type="integer" xref="id7.6.6.1.m1.2.2">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="id7.6.6.1.m1.2c">1,2</annotation><annotation encoding="application/x-llamapun" id="id7.6.6.1.m1.2d">1 , 2</annotation></semantics></math></sup></span><sup class="ltx_sup" id="id12.10.id1"><span class="ltx_text ltx_font_italic" id="id12.10.id1.1">⋆</span></sup>
<br class="ltx_break"/>
<br class="ltx_break"/>
<br class="ltx_break"/>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text" id="id9.8.1" style="position:relative; bottom:0.0pt;"><sup class="ltx_sup" id="id9.8.1.1"><math alttext="1" class="ltx_Math" display="inline" id="id9.8.1.1.m1.1"><semantics id="id9.8.1.1.m1.1a"><mn id="id9.8.1.1.m1.1.1" mathsize="80%" xref="id9.8.1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="id9.8.1.1.m1.1b"><cn id="id9.8.1.1.m1.1.1.cmml" type="integer" xref="id9.8.1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="id9.8.1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="id9.8.1.1.m1.1d">1</annotation></semantics></math></sup></span>School of Intelligence Science and Technology,Peking University
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text" id="id10.9.1" style="position:relative; bottom:0.0pt;"><sup class="ltx_sup" id="id10.9.1.1"><math alttext="2" class="ltx_Math" display="inline" id="id10.9.1.1.m1.1"><semantics id="id10.9.1.1.m1.1a"><mn id="id10.9.1.1.m1.1.1" mathsize="80%" xref="id10.9.1.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="id10.9.1.1.m1.1b"><cn id="id10.9.1.1.m1.1.1.cmml" type="integer" xref="id10.9.1.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="id10.9.1.1.m1.1c">2</annotation><annotation encoding="application/x-llamapun" id="id10.9.1.1.m1.1d">2</annotation></semantics></math></sup></span>National Key Laboratory of General Artificial Intelligence
</span>
<span class="ltx_contact ltx_role_affiliation">{sunc,youngtimmy,yhtong}@pku.edu.cn, {yaobo.liang,yamingyang,xushilin}@stu.pku.edu.cn
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id11.1">Large Language Models (LLMs) have demonstrated remarkable performance across diverse domains, prompting researchers to explore their potential for use in recommendation systems. Initial attempts have leveraged the exceptional capabilities of LLMs, such as rich knowledge and strong generalization through In-context Learning, which involves phrasing the recommendation task as prompts. Nevertheless, the performance of LLMs in recommendation tasks remains suboptimal due to a substantial disparity between the training tasks for LLMs and recommendation tasks and inadequate recommendation data during pre-training. This paper introduces RLRF4Rec, a novel framework integrating <span class="ltx_text ltx_font_bold" id="id11.1.1">R</span>einforcement <span class="ltx_text ltx_font_bold" id="id11.1.2">L</span>earning from <span class="ltx_text ltx_font_bold" id="id11.1.3">R</span>ecsys <span class="ltx_text ltx_font_bold" id="id11.1.4">F</span>eedback for Enhanced Recommendation Reranking(RLRF4Rec) with LLMs to address these challenges. Specifically, We first have the LLM generate inferred user preferences based on user interaction history, which is then used to augment traditional ID-based sequence recommendation models. Subsequently, we trained a reward model based on knowledge augmentation recommendation models to evaluate the quality of the reasoning knowledge from LLM. We then select the best and worst responses from the <math alttext="N" class="ltx_Math" display="inline" id="id11.1.m1.1"><semantics id="id11.1.m1.1a"><mi id="id11.1.m1.1.1" xref="id11.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="id11.1.m1.1b"><ci id="id11.1.m1.1.1.cmml" xref="id11.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="id11.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="id11.1.m1.1d">italic_N</annotation></semantics></math> samples to construct a dataset for <span class="ltx_text ltx_font_italic" id="id11.1.5">LLM</span> tuning. Finally, we design a structure alignment strategy with Direct Preference Optimization(DPO). We validate the effectiveness of RLRF4Rec through extensive experiments, demonstrating significant improvements in recommendation re-ranking metrics compared to baselines. This demonstrates that our approach significantly improves the capability of LLMs to respond to instructions within recommender systems.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Recommendation, Large Language Models, Knowledge Enhancement, Reject Sample Fine-tuning

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">INTRODUCTION</span>
</h2>
<figure class="ltx_figure" id="S1.F1">
<p class="ltx_p" id="S1.F1.1"><span class="ltx_text ltx_inline-block" id="S1.F1.1.1" style="width:433.6pt;">
<span class="ltx_inline-block ltx_transformed_outer" id="S1.F1.1.1.1.1" style="width:435.5pt;height:182.4pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="S1.F1.1.1.1.1.1"><span class="ltx_text" id="S1.F1.1.1.1.1.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="348" id="S1.F1.1.1.1.1.1.1.g1" src="x1.png" width="830"/></span></span>
</span></span></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Comparison between (a) Unidirectional LLM-based recommender systems and (b) Bidirectional LLM-based recommender systems.</figcaption>
</figure>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="347" id="S1.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Illustration of the RLRF4Rec framework constructed by three stages: knowledge augmentation, recommendation feedback, and knowledge alignment .For the knowledge augmentation stage, LLM generateste <math alttext="N" class="ltx_Math" display="inline" id="S1.F2.2.m1.1"><semantics id="S1.F2.2.m1.1b"><mi id="S1.F2.2.m1.1.1" xref="S1.F2.2.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.F2.2.m1.1c"><ci id="S1.F2.2.m1.1.1.cmml" xref="S1.F2.2.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.2.m1.1d">N</annotation><annotation encoding="application/x-llamapun" id="S1.F2.2.m1.1e">italic_N</annotation></semantics></math> responses from recommendation data. For the recommendation feedback stage, an existing recommendation model is trained as a reward model. For the knowledge alignment stage, the best and worst responses are selected by the reward model, then we implement DPO methods to get the final LLM. </figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The rise of large language models (LLMs) is marked by their advanced natural language understanding capabilities, which enable them to comprehend and generate human-like text with high accuracy<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib2" title="">2</a>]</cite>. These models exhibit impressive reasoning abilities, allowing them to perform complex cognitive tasks and provide insightful responses. A significant aspect of their impact is integrating traditional recommendation systems with these large models, enhancing the effectiveness of recommendation processes by leveraging LLMs’ extensive knowledge and contextual awareness<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib4" title="">4</a>]</cite>. Existing methods can be divided into two lines; The first is leveraging LLMs to make direct recommendations<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib12" title="">12</a>]</cite>. Typical approaches in the literature involve reformatting recommendation tasks — such as item reranking or click-through rate (CTR) prediction — into natural language constructs to facilitate the fine-tuning of LLMs<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib12" title="">12</a>]</cite>. The second uses LLMs to augment traditional recommendation models with enriched user/item representations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib18" title="">18</a>]</cite>, which to transfer the semantic knowledge from LLMs to collaborative models by aligning their latent representations, aiming to improve the recommendation performance of existing collaborative models.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, due to the abundant world knowledge of LLMs, the augmented data are more prominent and diverse than the raw data. AS shown in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S1.F1" title="Figure 1 ‣ I INTRODUCTION ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_tag">1</span></a>(a), recommendations with knowledge augmentation from LLM are currently implemented in a zero-shot, leading to the performance of LLMs in suboptimal recommendation tasks.
The challenges that arise include: <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">(1) How to align large language models with recommender systems. (2) How can collaborative relationships be represented using natural language and integrated into the training of recommendation models?</span></p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To address these challenges, we present RLRF4Rec, a framework for aligning an LLM for recommender systems. Drawing inspiration from the Reinforcement Learning from Human Feedback (RLHF) framework<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib19" title="">19</a>]</cite>. Specifically, We first have the LLM generate inferred user preferences based on user interaction history, which is then used to augment traditional ID-based sequence recommendation models. Subsequently, we designed a reward model based on Kar<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib14" title="">14</a>]</cite> to evaluate the quality of the reasoning knowledge from LLM. We then select the best and worst responses from the <math alttext="N" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_N</annotation></semantics></math> samples to construct a dataset for <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">LLM</span> tuning. Finally, we design a structure alignment strategy with DPO. So that we can still get good reasoning knowledge from LLM.
In total, our contributions are summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We study a new problem in recommendation — aligning the LLMs with the knowledge augmentation recommendation, where we reveal the limitations of In-context Learning-based approaches and underscore the significance of instruction tuning.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose a bidirectional approach that allows the recommendation model to provide feedback to the large language model, aligning it with the recommendation task.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We selected two datasets and conducted experiments with two models, validating the effectiveness and efficiency of the proposed framework. Our approach achieves performance improvements compared to the baselines.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">METHODOLOGY</span>
</h2>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="623" id="S2.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>A Prompt example aimed at extracting descriptive knowledge and user preferences about items using LLMs. The prompt template is represented by the blue bubble. A prompt can be generated by injecting specific information about the user content to be filled in the template shown in the yellow bubble into the prompt template. This prompt then instructs the LLM to generate descriptive knowledge and deduce user preferences, as indicated in the green bubble.</figcaption>
</figure>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">We proposed a new method, RLRF, mainly involving reinforcement learning from Recsys Feedback. As shown in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S1.F2" title="Figure 2 ‣ I INTRODUCTION ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_tag">2</span></a>, This framework is model-agnostic and consists of the following three stages:</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS1.4.1.1">II-A</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS1.5.2">Knowledge Augmentation from LLM</span>
</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">We first decompose the complex reasoning tasks by identifying major factors that determine user preferences and item characteristics. Then, according to each factor, publicly available pre-trained models (e.g., LLaMA 3.1) are required to generate reasoning knowledge about user preferences. Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S2.F3" title="Figure 3 ‣ II METHODOLOGY ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_tag">3</span></a> illustrates how to generate user preferences. We do not let LLM generate factual knowledge about items, but using public resources from KAR<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://github.com/YunjiaXi/Open-World-Knowledge-Augmented-Recommendation/tree/main/data/amz/knowledge</span></span></span>. We observe that reasoning and factual knowledge can improve the performance of backbone models, but reasoning knowledge exhibits a larger improvement. At last, an adaptor transforms this reasoning and factual knowledge into low-dimensional vectors, making it compatible with traditional recommendation models.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS2.4.1.1">II-B</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS2.5.2">Feedback of the Recommendations</span>
</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">First, We evaluate the quality of the reasoning knowledge generated by the LLM through the performance of the recommendations. Specifically, we use metrics that can be measured for individual users, such as NDCG/MAP, to select the best and worst reasoning knowledge samples for each user from the <math alttext="N" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_N</annotation></semantics></math> samples generated by the LLM. Then, we take the best and worst samples as recommendation prefer <span class="ltx_text ltx_font_italic" id="S2.SS2.p1.1.1">chosen</span> and <span class="ltx_text ltx_font_italic" id="S2.SS2.p1.1.2">rejected</span>, respectively, to construct a fine-tuning dataset. Finally, we apply a reinforcement learning method like DPO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib20" title="">20</a>]</cite> to train the LLM. The key innovation of DPO is to avoid explicit reward modeling. Instead, it directly optimizes the language model based on recommendation preferences. To achieve this, we first define a preference objective function, directly converting human preferences into the loss function used for training.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.3">Specifically, if the recommendation prefers one output <math alttext="y_{1}" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><msub id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">y</mi><mn id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝑦</ci><cn id="S2.SS2.p2.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">y_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> over another potential output <math alttext="y_{2}" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">y</mi><mn id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝑦</ci><cn id="S2.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">y_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, we can use the following binary cross-entropy loss function to optimize the language model <math alttext="\pi" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">italic_π</annotation></semantics></math> directly:</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}L_{\text{DPO}}=-\log\sigma\left(\beta\log\frac{\pi(y_{1}|x)}{\pi_%
{\text{ref}}(y_{1}|x)}-\beta\log\frac{\pi(y_{2}|x)}{\pi_{\text{ref}}(y_{2}|x)}%
\right)\end{split}" class="ltx_Math" display="block" id="S2.Ex1.m1.17"><semantics id="S2.Ex1.m1.17a"><mtable displaystyle="true" id="S2.Ex1.m1.17.17.2" xref="S2.Ex1.m1.16.16.1.cmml"><mtr id="S2.Ex1.m1.17.17.2a" xref="S2.Ex1.m1.16.16.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S2.Ex1.m1.17.17.2b" xref="S2.Ex1.m1.16.16.1.cmml"><mrow id="S2.Ex1.m1.17.17.2.16.16.16" xref="S2.Ex1.m1.16.16.1.cmml"><msub id="S2.Ex1.m1.17.17.2.16.16.16.17" xref="S2.Ex1.m1.16.16.1.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.cmml">L</mi><mtext id="S2.Ex1.m1.2.2.2.2.2.2.1" xref="S2.Ex1.m1.2.2.2.2.2.2.1a.cmml">DPO</mtext></msub><mo id="S2.Ex1.m1.3.3.3.3.3.3" xref="S2.Ex1.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S2.Ex1.m1.17.17.2.16.16.16.16" xref="S2.Ex1.m1.16.16.1.cmml"><mo id="S2.Ex1.m1.17.17.2.16.16.16.16a" rspace="0.167em" xref="S2.Ex1.m1.16.16.1.cmml">−</mo><mrow id="S2.Ex1.m1.17.17.2.16.16.16.16.1" xref="S2.Ex1.m1.16.16.1.cmml"><mrow id="S2.Ex1.m1.17.17.2.16.16.16.16.1.3" xref="S2.Ex1.m1.16.16.1.cmml"><mi id="S2.Ex1.m1.5.5.5.5.5.5" xref="S2.Ex1.m1.5.5.5.5.5.5.cmml">log</mi><mo id="S2.Ex1.m1.17.17.2.16.16.16.16.1.3a" lspace="0.167em" xref="S2.Ex1.m1.16.16.1.cmml">⁡</mo><mi id="S2.Ex1.m1.6.6.6.6.6.6" xref="S2.Ex1.m1.6.6.6.6.6.6.cmml">σ</mi></mrow><mo id="S2.Ex1.m1.17.17.2.16.16.16.16.1.2" xref="S2.Ex1.m1.16.16.1.cmml">⁢</mo><mrow id="S2.Ex1.m1.17.17.2.16.16.16.16.1.1.1" xref="S2.Ex1.m1.16.16.1.cmml"><mo id="S2.Ex1.m1.7.7.7.7.7.7" xref="S2.Ex1.m1.16.16.1.cmml">(</mo><mrow id="S2.Ex1.m1.17.17.2.16.16.16.16.1.1.1.1" xref="S2.Ex1.m1.16.16.1.cmml"><mrow id="S2.Ex1.m1.17.17.2.16.16.16.16.1.1.1.1.1" xref="S2.Ex1.m1.16.16.1.cmml"><mi id="S2.Ex1.m1.8.8.8.8.8.8" xref="S2.Ex1.m1.8.8.8.8.8.8.cmml">β</mi><mo id="S2.Ex1.m1.17.17.2.16.16.16.16.1.1.1.1.1.1" lspace="0.167em" xref="S2.Ex1.m1.16.16.1.cmml">⁢</mo><mrow id="S2.Ex1.m1.17.17.2.16.16.16.16.1.1.1.1.1.2" xref="S2.Ex1.m1.16.16.1.cmml"><mi id="S2.Ex1.m1.9.9.9.9.9.9" xref="S2.Ex1.m1.9.9.9.9.9.9.cmml">log</mi><mo id="S2.Ex1.m1.17.17.2.16.16.16.16.1.1.1.1.1.2a" lspace="0.167em" xref="S2.Ex1.m1.16.16.1.cmml">⁡</mo><mfrac id="S2.Ex1.m1.10.10.10.10.10.10" xref="S2.Ex1.m1.10.10.10.10.10.10.cmml"><mrow id="S2.Ex1.m1.10.10.10.10.10.10.1" xref="S2.Ex1.m1.10.10.10.10.10.10.1.cmml"><mi id="S2.Ex1.m1.10.10.10.10.10.10.1.3" xref="S2.Ex1.m1.10.10.10.10.10.10.1.3.cmml">π</mi><mo id="S2.Ex1.m1.10.10.10.10.10.10.1.2" xref="S2.Ex1.m1.10.10.10.10.10.10.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.cmml"><mo id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.cmml"><msub id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2.cmml"><mi id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2.2" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2.2.cmml">y</mi><mn id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2.3" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.1" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.3" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.3" stretchy="false" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.Ex1.m1.10.10.10.10.10.10.2" xref="S2.Ex1.m1.10.10.10.10.10.10.2.cmml"><msub id="S2.Ex1.m1.10.10.10.10.10.10.2.3" xref="S2.Ex1.m1.10.10.10.10.10.10.2.3.cmml"><mi id="S2.Ex1.m1.10.10.10.10.10.10.2.3.2" xref="S2.Ex1.m1.10.10.10.10.10.10.2.3.2.cmml">π</mi><mtext id="S2.Ex1.m1.10.10.10.10.10.10.2.3.3" xref="S2.Ex1.m1.10.10.10.10.10.10.2.3.3a.cmml">ref</mtext></msub><mo id="S2.Ex1.m1.10.10.10.10.10.10.2.2" xref="S2.Ex1.m1.10.10.10.10.10.10.2.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.cmml"><mo id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.2" stretchy="false" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.cmml"><msub id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2.cmml"><mi id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2.2" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2.2.cmml">y</mi><mn id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2.3" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.1" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.1.cmml">|</mo><mi id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.3" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.3" stretchy="false" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S2.Ex1.m1.11.11.11.11.11.11" xref="S2.Ex1.m1.11.11.11.11.11.11.cmml">−</mo><mrow id="S2.Ex1.m1.17.17.2.16.16.16.16.1.1.1.1.2" xref="S2.Ex1.m1.16.16.1.cmml"><mi id="S2.Ex1.m1.12.12.12.12.12.12" xref="S2.Ex1.m1.12.12.12.12.12.12.cmml">β</mi><mo id="S2.Ex1.m1.17.17.2.16.16.16.16.1.1.1.1.2.1" lspace="0.167em" xref="S2.Ex1.m1.16.16.1.cmml">⁢</mo><mrow id="S2.Ex1.m1.17.17.2.16.16.16.16.1.1.1.1.2.2" xref="S2.Ex1.m1.16.16.1.cmml"><mi id="S2.Ex1.m1.13.13.13.13.13.13" xref="S2.Ex1.m1.13.13.13.13.13.13.cmml">log</mi><mo id="S2.Ex1.m1.17.17.2.16.16.16.16.1.1.1.1.2.2a" lspace="0.167em" xref="S2.Ex1.m1.16.16.1.cmml">⁡</mo><mfrac id="S2.Ex1.m1.14.14.14.14.14.14" xref="S2.Ex1.m1.14.14.14.14.14.14.cmml"><mrow id="S2.Ex1.m1.14.14.14.14.14.14.1" xref="S2.Ex1.m1.14.14.14.14.14.14.1.cmml"><mi id="S2.Ex1.m1.14.14.14.14.14.14.1.3" xref="S2.Ex1.m1.14.14.14.14.14.14.1.3.cmml">π</mi><mo id="S2.Ex1.m1.14.14.14.14.14.14.1.2" xref="S2.Ex1.m1.14.14.14.14.14.14.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.cmml"><mo id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.cmml"><msub id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2.cmml"><mi id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2.2" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2.2.cmml">y</mi><mn id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2.3" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2.3.cmml">2</mn></msub><mo fence="false" id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.1" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.3" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.3" stretchy="false" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.Ex1.m1.14.14.14.14.14.14.2" xref="S2.Ex1.m1.14.14.14.14.14.14.2.cmml"><msub id="S2.Ex1.m1.14.14.14.14.14.14.2.3" xref="S2.Ex1.m1.14.14.14.14.14.14.2.3.cmml"><mi id="S2.Ex1.m1.14.14.14.14.14.14.2.3.2" xref="S2.Ex1.m1.14.14.14.14.14.14.2.3.2.cmml">π</mi><mtext id="S2.Ex1.m1.14.14.14.14.14.14.2.3.3" xref="S2.Ex1.m1.14.14.14.14.14.14.2.3.3a.cmml">ref</mtext></msub><mo id="S2.Ex1.m1.14.14.14.14.14.14.2.2" xref="S2.Ex1.m1.14.14.14.14.14.14.2.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.cmml"><mo id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.2" stretchy="false" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.cmml"><msub id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2.cmml"><mi id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2.2" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2.2.cmml">y</mi><mn id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2.3" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2.3.cmml">2</mn></msub><mo fence="false" id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.1" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.1.cmml">|</mo><mi id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.3" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.3" stretchy="false" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S2.Ex1.m1.15.15.15.15.15.15" xref="S2.Ex1.m1.16.16.1.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.17b"><apply id="S2.Ex1.m1.16.16.1.cmml" xref="S2.Ex1.m1.17.17.2"><eq id="S2.Ex1.m1.3.3.3.3.3.3.cmml" xref="S2.Ex1.m1.3.3.3.3.3.3"></eq><apply id="S2.Ex1.m1.16.16.1.3.cmml" xref="S2.Ex1.m1.17.17.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.16.16.1.3.1.cmml" xref="S2.Ex1.m1.17.17.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1">𝐿</ci><ci id="S2.Ex1.m1.2.2.2.2.2.2.1a.cmml" xref="S2.Ex1.m1.2.2.2.2.2.2.1"><mtext id="S2.Ex1.m1.2.2.2.2.2.2.1.cmml" mathsize="70%" xref="S2.Ex1.m1.2.2.2.2.2.2.1">DPO</mtext></ci></apply><apply id="S2.Ex1.m1.16.16.1.1.cmml" xref="S2.Ex1.m1.17.17.2"><minus id="S2.Ex1.m1.4.4.4.4.4.4.cmml" xref="S2.Ex1.m1.17.17.2"></minus><apply id="S2.Ex1.m1.16.16.1.1.1.cmml" xref="S2.Ex1.m1.17.17.2"><times id="S2.Ex1.m1.16.16.1.1.1.2.cmml" xref="S2.Ex1.m1.17.17.2"></times><apply id="S2.Ex1.m1.16.16.1.1.1.3.cmml" xref="S2.Ex1.m1.17.17.2"><log id="S2.Ex1.m1.5.5.5.5.5.5.cmml" xref="S2.Ex1.m1.5.5.5.5.5.5"></log><ci id="S2.Ex1.m1.6.6.6.6.6.6.cmml" xref="S2.Ex1.m1.6.6.6.6.6.6">𝜎</ci></apply><apply id="S2.Ex1.m1.16.16.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.17.17.2"><minus id="S2.Ex1.m1.11.11.11.11.11.11.cmml" xref="S2.Ex1.m1.11.11.11.11.11.11"></minus><apply id="S2.Ex1.m1.16.16.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.17.17.2"><times id="S2.Ex1.m1.16.16.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.17.17.2"></times><ci id="S2.Ex1.m1.8.8.8.8.8.8.cmml" xref="S2.Ex1.m1.8.8.8.8.8.8">𝛽</ci><apply id="S2.Ex1.m1.16.16.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.17.17.2"><log id="S2.Ex1.m1.9.9.9.9.9.9.cmml" xref="S2.Ex1.m1.9.9.9.9.9.9"></log><apply id="S2.Ex1.m1.10.10.10.10.10.10.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10"><divide id="S2.Ex1.m1.10.10.10.10.10.10.3.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10"></divide><apply id="S2.Ex1.m1.10.10.10.10.10.10.1.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.1"><times id="S2.Ex1.m1.10.10.10.10.10.10.1.2.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.1.2"></times><ci id="S2.Ex1.m1.10.10.10.10.10.10.1.3.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.1.3">𝜋</ci><apply id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.1.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.1">conditional</csymbol><apply id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2.2">𝑦</ci><cn id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2.3.cmml" type="integer" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.2.3">1</cn></apply><ci id="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.3.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.Ex1.m1.10.10.10.10.10.10.2.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.2"><times id="S2.Ex1.m1.10.10.10.10.10.10.2.2.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.2.2"></times><apply id="S2.Ex1.m1.10.10.10.10.10.10.2.3.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.10.10.10.10.10.10.2.3.1.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.2.3">subscript</csymbol><ci id="S2.Ex1.m1.10.10.10.10.10.10.2.3.2.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.2.3.2">𝜋</ci><ci id="S2.Ex1.m1.10.10.10.10.10.10.2.3.3a.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.2.3.3"><mtext id="S2.Ex1.m1.10.10.10.10.10.10.2.3.3.cmml" mathsize="70%" xref="S2.Ex1.m1.10.10.10.10.10.10.2.3.3">ref</mtext></ci></apply><apply id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.1.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.1">conditional</csymbol><apply id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2.1.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2">subscript</csymbol><ci id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2.2.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2.2">𝑦</ci><cn id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2.3.cmml" type="integer" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.2.3">1</cn></apply><ci id="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.3.cmml" xref="S2.Ex1.m1.10.10.10.10.10.10.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="S2.Ex1.m1.16.16.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.17.17.2"><times id="S2.Ex1.m1.16.16.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.17.17.2"></times><ci id="S2.Ex1.m1.12.12.12.12.12.12.cmml" xref="S2.Ex1.m1.12.12.12.12.12.12">𝛽</ci><apply id="S2.Ex1.m1.16.16.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.17.17.2"><log id="S2.Ex1.m1.13.13.13.13.13.13.cmml" xref="S2.Ex1.m1.13.13.13.13.13.13"></log><apply id="S2.Ex1.m1.14.14.14.14.14.14.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14"><divide id="S2.Ex1.m1.14.14.14.14.14.14.3.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14"></divide><apply id="S2.Ex1.m1.14.14.14.14.14.14.1.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.1"><times id="S2.Ex1.m1.14.14.14.14.14.14.1.2.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.1.2"></times><ci id="S2.Ex1.m1.14.14.14.14.14.14.1.3.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.1.3">𝜋</ci><apply id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.1.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.1">conditional</csymbol><apply id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2.2">𝑦</ci><cn id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2.3.cmml" type="integer" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.2.3">2</cn></apply><ci id="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.3.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.Ex1.m1.14.14.14.14.14.14.2.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.2"><times id="S2.Ex1.m1.14.14.14.14.14.14.2.2.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.2.2"></times><apply id="S2.Ex1.m1.14.14.14.14.14.14.2.3.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.14.14.14.14.14.14.2.3.1.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.2.3">subscript</csymbol><ci id="S2.Ex1.m1.14.14.14.14.14.14.2.3.2.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.2.3.2">𝜋</ci><ci id="S2.Ex1.m1.14.14.14.14.14.14.2.3.3a.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.2.3.3"><mtext id="S2.Ex1.m1.14.14.14.14.14.14.2.3.3.cmml" mathsize="70%" xref="S2.Ex1.m1.14.14.14.14.14.14.2.3.3">ref</mtext></ci></apply><apply id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.1.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.1">conditional</csymbol><apply id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2.1.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2">subscript</csymbol><ci id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2.2.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2.2">𝑦</ci><cn id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2.3.cmml" type="integer" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.2.3">2</cn></apply><ci id="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.3.cmml" xref="S2.Ex1.m1.14.14.14.14.14.14.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.17c">\begin{split}L_{\text{DPO}}=-\log\sigma\left(\beta\log\frac{\pi(y_{1}|x)}{\pi_%
{\text{ref}}(y_{1}|x)}-\beta\log\frac{\pi(y_{2}|x)}{\pi_{\text{ref}}(y_{2}|x)}%
\right)\end{split}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.17d">start_ROW start_CELL italic_L start_POSTSUBSCRIPT DPO end_POSTSUBSCRIPT = - roman_log italic_σ ( italic_β roman_log divide start_ARG italic_π ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_x ) end_ARG - italic_β roman_log divide start_ARG italic_π ( italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_x ) end_ARG ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p3.3">where <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S2.SS2.p3.1.m1.1"><semantics id="S2.SS2.p3.1.m1.1a"><msub id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml"><mi id="S2.SS2.p3.1.m1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.2.cmml">π</mi><mtext id="S2.SS2.p3.1.m1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><apply id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p3.1.m1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.2">𝜋</ci><ci id="S2.SS2.p3.1.m1.1.1.3a.cmml" xref="S2.SS2.p3.1.m1.1.1.3"><mtext id="S2.SS2.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS2.p3.1.m1.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.1.m1.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> is the base reference model. <math alttext="\sigma" class="ltx_Math" display="inline" id="S2.SS2.p3.2.m2.1"><semantics id="S2.SS2.p3.2.m2.1a"><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.2.m2.1d">italic_σ</annotation></semantics></math> is the sigmoid function and <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS2.p3.3.m3.1"><semantics id="S2.SS2.p3.3.m3.1a"><mi id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><ci id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.3.m3.1d">italic_β</annotation></semantics></math> is a hyperparameter that defaults to 0.01.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS3.4.1.1">II-C</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS3.5.2">Knowledge Alignment</span>
</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">We use reinforcement learning to align the sequence recommendation model with the capability of the LLM to generate user preferences. Unlike HLHF, which utilizes human preferences as feedback to train the reward model, we directly use the recommendation model as feedback. Specifically, we apply a multiple-generation approach by having the LLM generate N responses. We then use the pre-trained recommendation model as the reward model to evaluate the quality of these responses. The best and worst responses from the N are selected as the chosen and rejected examples. We then use the DPO method to train the LLM, resulting in the final LLM-based recommendation model. The detailed learning process is shown in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#alg1" title="Algorithm 1 ‣ II-C Knowledge Alignment ‣ II METHODOLOGY ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Iterative optimization method</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">Number of responses <math alttext="N" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_N</annotation></semantics></math>, pre-trained recommendation model <math alttext="Rec" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mrow id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">R</mi><mo id="alg1.l1.m2.1.1.1" xref="alg1.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">e</mi><mo id="alg1.l1.m2.1.1.1a" xref="alg1.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.4" xref="alg1.l1.m2.1.1.4.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><times id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1.1"></times><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝑅</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝑒</ci><ci id="alg1.l1.m2.1.1.4.cmml" xref="alg1.l1.m2.1.1.4">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">Rec</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_R italic_e italic_c</annotation></semantics></math>, LLM with parameters <math alttext="\theta_{LLM}" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><msub id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">θ</mi><mrow id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml"><mi id="alg1.l1.m3.1.1.3.2" xref="alg1.l1.m3.1.1.3.2.cmml">L</mi><mo id="alg1.l1.m3.1.1.3.1" xref="alg1.l1.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.3.3" xref="alg1.l1.m3.1.1.3.3.cmml">L</mi><mo id="alg1.l1.m3.1.1.3.1a" xref="alg1.l1.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.3.4" xref="alg1.l1.m3.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝜃</ci><apply id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3"><times id="alg1.l1.m3.1.1.3.1.cmml" xref="alg1.l1.m3.1.1.3.1"></times><ci id="alg1.l1.m3.1.1.3.2.cmml" xref="alg1.l1.m3.1.1.3.2">𝐿</ci><ci id="alg1.l1.m3.1.1.3.3.cmml" xref="alg1.l1.m3.1.1.3.3">𝐿</ci><ci id="alg1.l1.m3.1.1.3.4.cmml" xref="alg1.l1.m3.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\theta_{LLM}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_θ start_POSTSUBSCRIPT italic_L italic_L italic_M end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">Final LLM-based recommendation model

</div>
<div class="ltx_listingline" id="alg1.l3">Generate <math alttext="N" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_N</annotation></semantics></math> responses using the LLM:

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_text ltx_font_bold" id="alg1.l4.1">for</span> <math alttext="i=1" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">i</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mn id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑖</ci><cn id="alg1.l4.m1.1.1.3.cmml" type="integer" xref="alg1.l4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">i=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_i = 1</annotation></semantics></math> to <math alttext="N" class="ltx_Math" display="inline" id="alg1.l4.m2.1"><semantics id="alg1.l4.m2.1a"><mi id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m2.1d">italic_N</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l4.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">     <math alttext="response_{i}\leftarrow LLM.generate(prompt_{i})" class="ltx_Math" display="inline" id="alg1.l5.m1.2"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.3.cmml"><mrow id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml"><mrow id="alg1.l5.m1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.1.1.2.2" xref="alg1.l5.m1.1.1.1.1.2.2.cmml">r</mi><mo id="alg1.l5.m1.1.1.1.1.2.1" xref="alg1.l5.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.1.1.2.3" xref="alg1.l5.m1.1.1.1.1.2.3.cmml">e</mi><mo id="alg1.l5.m1.1.1.1.1.2.1a" xref="alg1.l5.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.1.1.2.4" xref="alg1.l5.m1.1.1.1.1.2.4.cmml">s</mi><mo id="alg1.l5.m1.1.1.1.1.2.1b" xref="alg1.l5.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.1.1.2.5" xref="alg1.l5.m1.1.1.1.1.2.5.cmml">p</mi><mo id="alg1.l5.m1.1.1.1.1.2.1c" xref="alg1.l5.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.1.1.2.6" xref="alg1.l5.m1.1.1.1.1.2.6.cmml">o</mi><mo id="alg1.l5.m1.1.1.1.1.2.1d" xref="alg1.l5.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.1.1.2.7" xref="alg1.l5.m1.1.1.1.1.2.7.cmml">n</mi><mo id="alg1.l5.m1.1.1.1.1.2.1e" xref="alg1.l5.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.1.1.2.8" xref="alg1.l5.m1.1.1.1.1.2.8.cmml">s</mi><mo id="alg1.l5.m1.1.1.1.1.2.1f" xref="alg1.l5.m1.1.1.1.1.2.1.cmml">⁢</mo><msub id="alg1.l5.m1.1.1.1.1.2.9" xref="alg1.l5.m1.1.1.1.1.2.9.cmml"><mi id="alg1.l5.m1.1.1.1.1.2.9.2" xref="alg1.l5.m1.1.1.1.1.2.9.2.cmml">e</mi><mi id="alg1.l5.m1.1.1.1.1.2.9.3" xref="alg1.l5.m1.1.1.1.1.2.9.3.cmml">i</mi></msub></mrow><mo id="alg1.l5.m1.1.1.1.1.1" stretchy="false" xref="alg1.l5.m1.1.1.1.1.1.cmml">←</mo><mrow id="alg1.l5.m1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.1.1.3.2" xref="alg1.l5.m1.1.1.1.1.3.2.cmml">L</mi><mo id="alg1.l5.m1.1.1.1.1.3.1" xref="alg1.l5.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.1.1.3.3" xref="alg1.l5.m1.1.1.1.1.3.3.cmml">L</mi><mo id="alg1.l5.m1.1.1.1.1.3.1a" xref="alg1.l5.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.1.1.3.4" xref="alg1.l5.m1.1.1.1.1.3.4.cmml">M</mi></mrow></mrow><mo id="alg1.l5.m1.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg1.l5.m1.2.2.3a.cmml">.</mo><mrow id="alg1.l5.m1.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.cmml"><mi id="alg1.l5.m1.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.3.cmml">g</mi><mo id="alg1.l5.m1.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l5.m1.2.2.2.2.4" xref="alg1.l5.m1.2.2.2.2.4.cmml">e</mi><mo id="alg1.l5.m1.2.2.2.2.2a" xref="alg1.l5.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l5.m1.2.2.2.2.5" xref="alg1.l5.m1.2.2.2.2.5.cmml">n</mi><mo id="alg1.l5.m1.2.2.2.2.2b" xref="alg1.l5.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l5.m1.2.2.2.2.6" xref="alg1.l5.m1.2.2.2.2.6.cmml">e</mi><mo id="alg1.l5.m1.2.2.2.2.2c" xref="alg1.l5.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l5.m1.2.2.2.2.7" xref="alg1.l5.m1.2.2.2.2.7.cmml">r</mi><mo id="alg1.l5.m1.2.2.2.2.2d" xref="alg1.l5.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l5.m1.2.2.2.2.8" xref="alg1.l5.m1.2.2.2.2.8.cmml">a</mi><mo id="alg1.l5.m1.2.2.2.2.2e" xref="alg1.l5.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l5.m1.2.2.2.2.9" xref="alg1.l5.m1.2.2.2.2.9.cmml">t</mi><mo id="alg1.l5.m1.2.2.2.2.2f" xref="alg1.l5.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l5.m1.2.2.2.2.10" xref="alg1.l5.m1.2.2.2.2.10.cmml">e</mi><mo id="alg1.l5.m1.2.2.2.2.2g" xref="alg1.l5.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="alg1.l5.m1.2.2.2.2.1.1" xref="alg1.l5.m1.2.2.2.2.1.1.1.cmml"><mo id="alg1.l5.m1.2.2.2.2.1.1.2" stretchy="false" xref="alg1.l5.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l5.m1.2.2.2.2.1.1.1" xref="alg1.l5.m1.2.2.2.2.1.1.1.cmml"><mi id="alg1.l5.m1.2.2.2.2.1.1.1.2" xref="alg1.l5.m1.2.2.2.2.1.1.1.2.cmml">p</mi><mo id="alg1.l5.m1.2.2.2.2.1.1.1.1" xref="alg1.l5.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.2.2.2.2.1.1.1.3" xref="alg1.l5.m1.2.2.2.2.1.1.1.3.cmml">r</mi><mo id="alg1.l5.m1.2.2.2.2.1.1.1.1a" xref="alg1.l5.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.2.2.2.2.1.1.1.4" xref="alg1.l5.m1.2.2.2.2.1.1.1.4.cmml">o</mi><mo id="alg1.l5.m1.2.2.2.2.1.1.1.1b" xref="alg1.l5.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.2.2.2.2.1.1.1.5" xref="alg1.l5.m1.2.2.2.2.1.1.1.5.cmml">m</mi><mo id="alg1.l5.m1.2.2.2.2.1.1.1.1c" xref="alg1.l5.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.2.2.2.2.1.1.1.6" xref="alg1.l5.m1.2.2.2.2.1.1.1.6.cmml">p</mi><mo id="alg1.l5.m1.2.2.2.2.1.1.1.1d" xref="alg1.l5.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><msub id="alg1.l5.m1.2.2.2.2.1.1.1.7" xref="alg1.l5.m1.2.2.2.2.1.1.1.7.cmml"><mi id="alg1.l5.m1.2.2.2.2.1.1.1.7.2" xref="alg1.l5.m1.2.2.2.2.1.1.1.7.2.cmml">t</mi><mi id="alg1.l5.m1.2.2.2.2.1.1.1.7.3" xref="alg1.l5.m1.2.2.2.2.1.1.1.7.3.cmml">i</mi></msub></mrow><mo id="alg1.l5.m1.2.2.2.2.1.1.3" stretchy="false" xref="alg1.l5.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.3a.cmml" xref="alg1.l5.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1"><ci id="alg1.l5.m1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.2"><times id="alg1.l5.m1.1.1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.1.1.2.1"></times><ci id="alg1.l5.m1.1.1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.1.1.2.2">𝑟</ci><ci id="alg1.l5.m1.1.1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.1.1.2.3">𝑒</ci><ci id="alg1.l5.m1.1.1.1.1.2.4.cmml" xref="alg1.l5.m1.1.1.1.1.2.4">𝑠</ci><ci id="alg1.l5.m1.1.1.1.1.2.5.cmml" xref="alg1.l5.m1.1.1.1.1.2.5">𝑝</ci><ci id="alg1.l5.m1.1.1.1.1.2.6.cmml" xref="alg1.l5.m1.1.1.1.1.2.6">𝑜</ci><ci id="alg1.l5.m1.1.1.1.1.2.7.cmml" xref="alg1.l5.m1.1.1.1.1.2.7">𝑛</ci><ci id="alg1.l5.m1.1.1.1.1.2.8.cmml" xref="alg1.l5.m1.1.1.1.1.2.8">𝑠</ci><apply id="alg1.l5.m1.1.1.1.1.2.9.cmml" xref="alg1.l5.m1.1.1.1.1.2.9"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.2.9.1.cmml" xref="alg1.l5.m1.1.1.1.1.2.9">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.2.9.2.cmml" xref="alg1.l5.m1.1.1.1.1.2.9.2">𝑒</ci><ci id="alg1.l5.m1.1.1.1.1.2.9.3.cmml" xref="alg1.l5.m1.1.1.1.1.2.9.3">𝑖</ci></apply></apply><apply id="alg1.l5.m1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.3"><times id="alg1.l5.m1.1.1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.1.1.3.1"></times><ci id="alg1.l5.m1.1.1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.1.1.3.2">𝐿</ci><ci id="alg1.l5.m1.1.1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.1.1.3.3">𝐿</ci><ci id="alg1.l5.m1.1.1.1.1.3.4.cmml" xref="alg1.l5.m1.1.1.1.1.3.4">𝑀</ci></apply></apply><apply id="alg1.l5.m1.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2"><times id="alg1.l5.m1.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2"></times><ci id="alg1.l5.m1.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.3">𝑔</ci><ci id="alg1.l5.m1.2.2.2.2.4.cmml" xref="alg1.l5.m1.2.2.2.2.4">𝑒</ci><ci id="alg1.l5.m1.2.2.2.2.5.cmml" xref="alg1.l5.m1.2.2.2.2.5">𝑛</ci><ci id="alg1.l5.m1.2.2.2.2.6.cmml" xref="alg1.l5.m1.2.2.2.2.6">𝑒</ci><ci id="alg1.l5.m1.2.2.2.2.7.cmml" xref="alg1.l5.m1.2.2.2.2.7">𝑟</ci><ci id="alg1.l5.m1.2.2.2.2.8.cmml" xref="alg1.l5.m1.2.2.2.2.8">𝑎</ci><ci id="alg1.l5.m1.2.2.2.2.9.cmml" xref="alg1.l5.m1.2.2.2.2.9">𝑡</ci><ci id="alg1.l5.m1.2.2.2.2.10.cmml" xref="alg1.l5.m1.2.2.2.2.10">𝑒</ci><apply id="alg1.l5.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l5.m1.2.2.2.2.1.1"><times id="alg1.l5.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l5.m1.2.2.2.2.1.1.1.1"></times><ci id="alg1.l5.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l5.m1.2.2.2.2.1.1.1.2">𝑝</ci><ci id="alg1.l5.m1.2.2.2.2.1.1.1.3.cmml" xref="alg1.l5.m1.2.2.2.2.1.1.1.3">𝑟</ci><ci id="alg1.l5.m1.2.2.2.2.1.1.1.4.cmml" xref="alg1.l5.m1.2.2.2.2.1.1.1.4">𝑜</ci><ci id="alg1.l5.m1.2.2.2.2.1.1.1.5.cmml" xref="alg1.l5.m1.2.2.2.2.1.1.1.5">𝑚</ci><ci id="alg1.l5.m1.2.2.2.2.1.1.1.6.cmml" xref="alg1.l5.m1.2.2.2.2.1.1.1.6">𝑝</ci><apply id="alg1.l5.m1.2.2.2.2.1.1.1.7.cmml" xref="alg1.l5.m1.2.2.2.2.1.1.1.7"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.1.1.1.7.1.cmml" xref="alg1.l5.m1.2.2.2.2.1.1.1.7">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.1.1.1.7.2.cmml" xref="alg1.l5.m1.2.2.2.2.1.1.1.7.2">𝑡</ci><ci id="alg1.l5.m1.2.2.2.2.1.1.1.7.3.cmml" xref="alg1.l5.m1.2.2.2.2.1.1.1.7.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">response_{i}\leftarrow LLM.generate(prompt_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.2d">italic_r italic_e italic_s italic_p italic_o italic_n italic_s italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← italic_L italic_L italic_M . italic_g italic_e italic_n italic_e italic_r italic_a italic_t italic_e ( italic_p italic_r italic_o italic_m italic_p italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_text ltx_font_bold" id="alg1.l6.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l6.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l7">Evaluate each response using the pre-trained recommendation model:

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_text ltx_font_bold" id="alg1.l8.1">for</span> <math alttext="i=1" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">i</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">=</mo><mn id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><eq id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></eq><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑖</ci><cn id="alg1.l8.m1.1.1.3.cmml" type="integer" xref="alg1.l8.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">i=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_i = 1</annotation></semantics></math> to <math alttext="N" class="ltx_Math" display="inline" id="alg1.l8.m2.1"><semantics id="alg1.l8.m2.1a"><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">italic_N</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l8.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l9">     <math alttext="score_{i}\leftarrow Rec.evaluate(response_{i})" class="ltx_Math" display="inline" id="alg1.l9.m1.2"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.2.2" xref="alg1.l9.m1.2.2.3.cmml"><mrow id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.2.2.cmml">s</mi><mo id="alg1.l9.m1.1.1.1.1.2.1" xref="alg1.l9.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.1.1.2.3" xref="alg1.l9.m1.1.1.1.1.2.3.cmml">c</mi><mo id="alg1.l9.m1.1.1.1.1.2.1a" xref="alg1.l9.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.1.1.2.4" xref="alg1.l9.m1.1.1.1.1.2.4.cmml">o</mi><mo id="alg1.l9.m1.1.1.1.1.2.1b" xref="alg1.l9.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.1.1.2.5" xref="alg1.l9.m1.1.1.1.1.2.5.cmml">r</mi><mo id="alg1.l9.m1.1.1.1.1.2.1c" xref="alg1.l9.m1.1.1.1.1.2.1.cmml">⁢</mo><msub id="alg1.l9.m1.1.1.1.1.2.6" xref="alg1.l9.m1.1.1.1.1.2.6.cmml"><mi id="alg1.l9.m1.1.1.1.1.2.6.2" xref="alg1.l9.m1.1.1.1.1.2.6.2.cmml">e</mi><mi id="alg1.l9.m1.1.1.1.1.2.6.3" xref="alg1.l9.m1.1.1.1.1.2.6.3.cmml">i</mi></msub></mrow><mo id="alg1.l9.m1.1.1.1.1.1" stretchy="false" xref="alg1.l9.m1.1.1.1.1.1.cmml">←</mo><mrow id="alg1.l9.m1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.1.3.2.cmml">R</mi><mo id="alg1.l9.m1.1.1.1.1.3.1" xref="alg1.l9.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.1.3.3.cmml">e</mi><mo id="alg1.l9.m1.1.1.1.1.3.1a" xref="alg1.l9.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.1.1.3.4" xref="alg1.l9.m1.1.1.1.1.3.4.cmml">c</mi></mrow></mrow><mo id="alg1.l9.m1.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg1.l9.m1.2.2.3a.cmml">.</mo><mrow id="alg1.l9.m1.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.cmml"><mi id="alg1.l9.m1.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.3.cmml">e</mi><mo id="alg1.l9.m1.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.4" xref="alg1.l9.m1.2.2.2.2.4.cmml">v</mi><mo id="alg1.l9.m1.2.2.2.2.2a" xref="alg1.l9.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.5" xref="alg1.l9.m1.2.2.2.2.5.cmml">a</mi><mo id="alg1.l9.m1.2.2.2.2.2b" xref="alg1.l9.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.6" xref="alg1.l9.m1.2.2.2.2.6.cmml">l</mi><mo id="alg1.l9.m1.2.2.2.2.2c" xref="alg1.l9.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.7" xref="alg1.l9.m1.2.2.2.2.7.cmml">u</mi><mo id="alg1.l9.m1.2.2.2.2.2d" xref="alg1.l9.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.8" xref="alg1.l9.m1.2.2.2.2.8.cmml">a</mi><mo id="alg1.l9.m1.2.2.2.2.2e" xref="alg1.l9.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.9" xref="alg1.l9.m1.2.2.2.2.9.cmml">t</mi><mo id="alg1.l9.m1.2.2.2.2.2f" xref="alg1.l9.m1.2.2.2.2.2.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.10" xref="alg1.l9.m1.2.2.2.2.10.cmml">e</mi><mo id="alg1.l9.m1.2.2.2.2.2g" xref="alg1.l9.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="alg1.l9.m1.2.2.2.2.1.1" xref="alg1.l9.m1.2.2.2.2.1.1.1.cmml"><mo id="alg1.l9.m1.2.2.2.2.1.1.2" stretchy="false" xref="alg1.l9.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l9.m1.2.2.2.2.1.1.1" xref="alg1.l9.m1.2.2.2.2.1.1.1.cmml"><mi id="alg1.l9.m1.2.2.2.2.1.1.1.2" xref="alg1.l9.m1.2.2.2.2.1.1.1.2.cmml">r</mi><mo id="alg1.l9.m1.2.2.2.2.1.1.1.1" xref="alg1.l9.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.1.1.1.3" xref="alg1.l9.m1.2.2.2.2.1.1.1.3.cmml">e</mi><mo id="alg1.l9.m1.2.2.2.2.1.1.1.1a" xref="alg1.l9.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.1.1.1.4" xref="alg1.l9.m1.2.2.2.2.1.1.1.4.cmml">s</mi><mo id="alg1.l9.m1.2.2.2.2.1.1.1.1b" xref="alg1.l9.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.1.1.1.5" xref="alg1.l9.m1.2.2.2.2.1.1.1.5.cmml">p</mi><mo id="alg1.l9.m1.2.2.2.2.1.1.1.1c" xref="alg1.l9.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.1.1.1.6" xref="alg1.l9.m1.2.2.2.2.1.1.1.6.cmml">o</mi><mo id="alg1.l9.m1.2.2.2.2.1.1.1.1d" xref="alg1.l9.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.1.1.1.7" xref="alg1.l9.m1.2.2.2.2.1.1.1.7.cmml">n</mi><mo id="alg1.l9.m1.2.2.2.2.1.1.1.1e" xref="alg1.l9.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.1.1.1.8" xref="alg1.l9.m1.2.2.2.2.1.1.1.8.cmml">s</mi><mo id="alg1.l9.m1.2.2.2.2.1.1.1.1f" xref="alg1.l9.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><msub id="alg1.l9.m1.2.2.2.2.1.1.1.9" xref="alg1.l9.m1.2.2.2.2.1.1.1.9.cmml"><mi id="alg1.l9.m1.2.2.2.2.1.1.1.9.2" xref="alg1.l9.m1.2.2.2.2.1.1.1.9.2.cmml">e</mi><mi id="alg1.l9.m1.2.2.2.2.1.1.1.9.3" xref="alg1.l9.m1.2.2.2.2.1.1.1.9.3.cmml">i</mi></msub></mrow><mo id="alg1.l9.m1.2.2.2.2.1.1.3" stretchy="false" xref="alg1.l9.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.3a.cmml" xref="alg1.l9.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1"><ci id="alg1.l9.m1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.2"><times id="alg1.l9.m1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.2.1"></times><ci id="alg1.l9.m1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.2.2">𝑠</ci><ci id="alg1.l9.m1.1.1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.2.3">𝑐</ci><ci id="alg1.l9.m1.1.1.1.1.2.4.cmml" xref="alg1.l9.m1.1.1.1.1.2.4">𝑜</ci><ci id="alg1.l9.m1.1.1.1.1.2.5.cmml" xref="alg1.l9.m1.1.1.1.1.2.5">𝑟</ci><apply id="alg1.l9.m1.1.1.1.1.2.6.cmml" xref="alg1.l9.m1.1.1.1.1.2.6"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.2.6.1.cmml" xref="alg1.l9.m1.1.1.1.1.2.6">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.2.6.2.cmml" xref="alg1.l9.m1.1.1.1.1.2.6.2">𝑒</ci><ci id="alg1.l9.m1.1.1.1.1.2.6.3.cmml" xref="alg1.l9.m1.1.1.1.1.2.6.3">𝑖</ci></apply></apply><apply id="alg1.l9.m1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.3"><times id="alg1.l9.m1.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.3.1"></times><ci id="alg1.l9.m1.1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.3.2">𝑅</ci><ci id="alg1.l9.m1.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.3.3">𝑒</ci><ci id="alg1.l9.m1.1.1.1.1.3.4.cmml" xref="alg1.l9.m1.1.1.1.1.3.4">𝑐</ci></apply></apply><apply id="alg1.l9.m1.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2"><times id="alg1.l9.m1.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2"></times><ci id="alg1.l9.m1.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.3">𝑒</ci><ci id="alg1.l9.m1.2.2.2.2.4.cmml" xref="alg1.l9.m1.2.2.2.2.4">𝑣</ci><ci id="alg1.l9.m1.2.2.2.2.5.cmml" xref="alg1.l9.m1.2.2.2.2.5">𝑎</ci><ci id="alg1.l9.m1.2.2.2.2.6.cmml" xref="alg1.l9.m1.2.2.2.2.6">𝑙</ci><ci id="alg1.l9.m1.2.2.2.2.7.cmml" xref="alg1.l9.m1.2.2.2.2.7">𝑢</ci><ci id="alg1.l9.m1.2.2.2.2.8.cmml" xref="alg1.l9.m1.2.2.2.2.8">𝑎</ci><ci id="alg1.l9.m1.2.2.2.2.9.cmml" xref="alg1.l9.m1.2.2.2.2.9">𝑡</ci><ci id="alg1.l9.m1.2.2.2.2.10.cmml" xref="alg1.l9.m1.2.2.2.2.10">𝑒</ci><apply id="alg1.l9.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l9.m1.2.2.2.2.1.1"><times id="alg1.l9.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.1"></times><ci id="alg1.l9.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.2">𝑟</ci><ci id="alg1.l9.m1.2.2.2.2.1.1.1.3.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.3">𝑒</ci><ci id="alg1.l9.m1.2.2.2.2.1.1.1.4.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.4">𝑠</ci><ci id="alg1.l9.m1.2.2.2.2.1.1.1.5.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.5">𝑝</ci><ci id="alg1.l9.m1.2.2.2.2.1.1.1.6.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.6">𝑜</ci><ci id="alg1.l9.m1.2.2.2.2.1.1.1.7.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.7">𝑛</ci><ci id="alg1.l9.m1.2.2.2.2.1.1.1.8.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.8">𝑠</ci><apply id="alg1.l9.m1.2.2.2.2.1.1.1.9.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.9"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.1.1.1.9.1.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.9">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.1.1.1.9.2.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.9.2">𝑒</ci><ci id="alg1.l9.m1.2.2.2.2.1.1.1.9.3.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.9.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">score_{i}\leftarrow Rec.evaluate(response_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.2d">italic_s italic_c italic_o italic_r italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← italic_R italic_e italic_c . italic_e italic_v italic_a italic_l italic_u italic_a italic_t italic_e ( italic_r italic_e italic_s italic_p italic_o italic_n italic_s italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_text ltx_font_bold" id="alg1.l10.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l10.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l11">Select the best and worst responses:

</div>
<div class="ltx_listingline" id="alg1.l12">
<math alttext="best\_response\leftarrow response_{\arg\max(score)}" class="ltx_Math" display="inline" id="alg1.l12.m1.2"><semantics id="alg1.l12.m1.2a"><mrow id="alg1.l12.m1.2.3" xref="alg1.l12.m1.2.3.cmml"><mrow id="alg1.l12.m1.2.3.2" xref="alg1.l12.m1.2.3.2.cmml"><mi id="alg1.l12.m1.2.3.2.2" xref="alg1.l12.m1.2.3.2.2.cmml">b</mi><mo id="alg1.l12.m1.2.3.2.1" xref="alg1.l12.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.2.3" xref="alg1.l12.m1.2.3.2.3.cmml">e</mi><mo id="alg1.l12.m1.2.3.2.1a" xref="alg1.l12.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.2.4" xref="alg1.l12.m1.2.3.2.4.cmml">s</mi><mo id="alg1.l12.m1.2.3.2.1b" xref="alg1.l12.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.2.5" xref="alg1.l12.m1.2.3.2.5.cmml">t</mi><mo id="alg1.l12.m1.2.3.2.1c" xref="alg1.l12.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.2.6" mathvariant="normal" xref="alg1.l12.m1.2.3.2.6.cmml">_</mi><mo id="alg1.l12.m1.2.3.2.1d" xref="alg1.l12.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.2.7" xref="alg1.l12.m1.2.3.2.7.cmml">r</mi><mo id="alg1.l12.m1.2.3.2.1e" xref="alg1.l12.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.2.8" xref="alg1.l12.m1.2.3.2.8.cmml">e</mi><mo id="alg1.l12.m1.2.3.2.1f" xref="alg1.l12.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.2.9" xref="alg1.l12.m1.2.3.2.9.cmml">s</mi><mo id="alg1.l12.m1.2.3.2.1g" xref="alg1.l12.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.2.10" xref="alg1.l12.m1.2.3.2.10.cmml">p</mi><mo id="alg1.l12.m1.2.3.2.1h" xref="alg1.l12.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.2.11" xref="alg1.l12.m1.2.3.2.11.cmml">o</mi><mo id="alg1.l12.m1.2.3.2.1i" xref="alg1.l12.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.2.12" xref="alg1.l12.m1.2.3.2.12.cmml">n</mi><mo id="alg1.l12.m1.2.3.2.1j" xref="alg1.l12.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.2.13" xref="alg1.l12.m1.2.3.2.13.cmml">s</mi><mo id="alg1.l12.m1.2.3.2.1k" xref="alg1.l12.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.2.14" xref="alg1.l12.m1.2.3.2.14.cmml">e</mi></mrow><mo id="alg1.l12.m1.2.3.1" stretchy="false" xref="alg1.l12.m1.2.3.1.cmml">←</mo><mrow id="alg1.l12.m1.2.3.3" xref="alg1.l12.m1.2.3.3.cmml"><mi id="alg1.l12.m1.2.3.3.2" xref="alg1.l12.m1.2.3.3.2.cmml">r</mi><mo id="alg1.l12.m1.2.3.3.1" xref="alg1.l12.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.3.3" xref="alg1.l12.m1.2.3.3.3.cmml">e</mi><mo id="alg1.l12.m1.2.3.3.1a" xref="alg1.l12.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.3.4" xref="alg1.l12.m1.2.3.3.4.cmml">s</mi><mo id="alg1.l12.m1.2.3.3.1b" xref="alg1.l12.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.3.5" xref="alg1.l12.m1.2.3.3.5.cmml">p</mi><mo id="alg1.l12.m1.2.3.3.1c" xref="alg1.l12.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.3.6" xref="alg1.l12.m1.2.3.3.6.cmml">o</mi><mo id="alg1.l12.m1.2.3.3.1d" xref="alg1.l12.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.3.7" xref="alg1.l12.m1.2.3.3.7.cmml">n</mi><mo id="alg1.l12.m1.2.3.3.1e" xref="alg1.l12.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.3.3.8" xref="alg1.l12.m1.2.3.3.8.cmml">s</mi><mo id="alg1.l12.m1.2.3.3.1f" xref="alg1.l12.m1.2.3.3.1.cmml">⁢</mo><msub id="alg1.l12.m1.2.3.3.9" xref="alg1.l12.m1.2.3.3.9.cmml"><mi id="alg1.l12.m1.2.3.3.9.2" xref="alg1.l12.m1.2.3.3.9.2.cmml">e</mi><mrow id="alg1.l12.m1.2.2.2" xref="alg1.l12.m1.2.2.2.cmml"><mi id="alg1.l12.m1.2.2.2.3" xref="alg1.l12.m1.2.2.2.3.cmml">arg</mi><mo id="alg1.l12.m1.2.2.2a" lspace="0.167em" xref="alg1.l12.m1.2.2.2.cmml">⁡</mo><mrow id="alg1.l12.m1.2.2.2.2.1" xref="alg1.l12.m1.2.2.2.2.2.cmml"><mi id="alg1.l12.m1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.cmml">max</mi><mo id="alg1.l12.m1.2.2.2.2.1a" xref="alg1.l12.m1.2.2.2.2.2.cmml">⁡</mo><mrow id="alg1.l12.m1.2.2.2.2.1.1" xref="alg1.l12.m1.2.2.2.2.2.cmml"><mo id="alg1.l12.m1.2.2.2.2.1.1.2" stretchy="false" xref="alg1.l12.m1.2.2.2.2.2.cmml">(</mo><mrow id="alg1.l12.m1.2.2.2.2.1.1.1" xref="alg1.l12.m1.2.2.2.2.1.1.1.cmml"><mi id="alg1.l12.m1.2.2.2.2.1.1.1.2" xref="alg1.l12.m1.2.2.2.2.1.1.1.2.cmml">s</mi><mo id="alg1.l12.m1.2.2.2.2.1.1.1.1" xref="alg1.l12.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.2.2.2.1.1.1.3" xref="alg1.l12.m1.2.2.2.2.1.1.1.3.cmml">c</mi><mo id="alg1.l12.m1.2.2.2.2.1.1.1.1a" xref="alg1.l12.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.2.2.2.1.1.1.4" xref="alg1.l12.m1.2.2.2.2.1.1.1.4.cmml">o</mi><mo id="alg1.l12.m1.2.2.2.2.1.1.1.1b" xref="alg1.l12.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.2.2.2.1.1.1.5" xref="alg1.l12.m1.2.2.2.2.1.1.1.5.cmml">r</mi><mo id="alg1.l12.m1.2.2.2.2.1.1.1.1c" xref="alg1.l12.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.2.2.2.1.1.1.6" xref="alg1.l12.m1.2.2.2.2.1.1.1.6.cmml">e</mi></mrow><mo id="alg1.l12.m1.2.2.2.2.1.1.3" stretchy="false" xref="alg1.l12.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.2b"><apply id="alg1.l12.m1.2.3.cmml" xref="alg1.l12.m1.2.3"><ci id="alg1.l12.m1.2.3.1.cmml" xref="alg1.l12.m1.2.3.1">←</ci><apply id="alg1.l12.m1.2.3.2.cmml" xref="alg1.l12.m1.2.3.2"><times id="alg1.l12.m1.2.3.2.1.cmml" xref="alg1.l12.m1.2.3.2.1"></times><ci id="alg1.l12.m1.2.3.2.2.cmml" xref="alg1.l12.m1.2.3.2.2">𝑏</ci><ci id="alg1.l12.m1.2.3.2.3.cmml" xref="alg1.l12.m1.2.3.2.3">𝑒</ci><ci id="alg1.l12.m1.2.3.2.4.cmml" xref="alg1.l12.m1.2.3.2.4">𝑠</ci><ci id="alg1.l12.m1.2.3.2.5.cmml" xref="alg1.l12.m1.2.3.2.5">𝑡</ci><ci id="alg1.l12.m1.2.3.2.6.cmml" xref="alg1.l12.m1.2.3.2.6">_</ci><ci id="alg1.l12.m1.2.3.2.7.cmml" xref="alg1.l12.m1.2.3.2.7">𝑟</ci><ci id="alg1.l12.m1.2.3.2.8.cmml" xref="alg1.l12.m1.2.3.2.8">𝑒</ci><ci id="alg1.l12.m1.2.3.2.9.cmml" xref="alg1.l12.m1.2.3.2.9">𝑠</ci><ci id="alg1.l12.m1.2.3.2.10.cmml" xref="alg1.l12.m1.2.3.2.10">𝑝</ci><ci id="alg1.l12.m1.2.3.2.11.cmml" xref="alg1.l12.m1.2.3.2.11">𝑜</ci><ci id="alg1.l12.m1.2.3.2.12.cmml" xref="alg1.l12.m1.2.3.2.12">𝑛</ci><ci id="alg1.l12.m1.2.3.2.13.cmml" xref="alg1.l12.m1.2.3.2.13">𝑠</ci><ci id="alg1.l12.m1.2.3.2.14.cmml" xref="alg1.l12.m1.2.3.2.14">𝑒</ci></apply><apply id="alg1.l12.m1.2.3.3.cmml" xref="alg1.l12.m1.2.3.3"><times id="alg1.l12.m1.2.3.3.1.cmml" xref="alg1.l12.m1.2.3.3.1"></times><ci id="alg1.l12.m1.2.3.3.2.cmml" xref="alg1.l12.m1.2.3.3.2">𝑟</ci><ci id="alg1.l12.m1.2.3.3.3.cmml" xref="alg1.l12.m1.2.3.3.3">𝑒</ci><ci id="alg1.l12.m1.2.3.3.4.cmml" xref="alg1.l12.m1.2.3.3.4">𝑠</ci><ci id="alg1.l12.m1.2.3.3.5.cmml" xref="alg1.l12.m1.2.3.3.5">𝑝</ci><ci id="alg1.l12.m1.2.3.3.6.cmml" xref="alg1.l12.m1.2.3.3.6">𝑜</ci><ci id="alg1.l12.m1.2.3.3.7.cmml" xref="alg1.l12.m1.2.3.3.7">𝑛</ci><ci id="alg1.l12.m1.2.3.3.8.cmml" xref="alg1.l12.m1.2.3.3.8">𝑠</ci><apply id="alg1.l12.m1.2.3.3.9.cmml" xref="alg1.l12.m1.2.3.3.9"><csymbol cd="ambiguous" id="alg1.l12.m1.2.3.3.9.1.cmml" xref="alg1.l12.m1.2.3.3.9">subscript</csymbol><ci id="alg1.l12.m1.2.3.3.9.2.cmml" xref="alg1.l12.m1.2.3.3.9.2">𝑒</ci><apply id="alg1.l12.m1.2.2.2.cmml" xref="alg1.l12.m1.2.2.2"><arg id="alg1.l12.m1.2.2.2.3.cmml" xref="alg1.l12.m1.2.2.2.3"></arg><apply id="alg1.l12.m1.2.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2.1"><max id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1"></max><apply id="alg1.l12.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l12.m1.2.2.2.2.1.1.1"><times id="alg1.l12.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.2.2.1.1.1.1"></times><ci id="alg1.l12.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l12.m1.2.2.2.2.1.1.1.2">𝑠</ci><ci id="alg1.l12.m1.2.2.2.2.1.1.1.3.cmml" xref="alg1.l12.m1.2.2.2.2.1.1.1.3">𝑐</ci><ci id="alg1.l12.m1.2.2.2.2.1.1.1.4.cmml" xref="alg1.l12.m1.2.2.2.2.1.1.1.4">𝑜</ci><ci id="alg1.l12.m1.2.2.2.2.1.1.1.5.cmml" xref="alg1.l12.m1.2.2.2.2.1.1.1.5">𝑟</ci><ci id="alg1.l12.m1.2.2.2.2.1.1.1.6.cmml" xref="alg1.l12.m1.2.2.2.2.1.1.1.6">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.2c">best\_response\leftarrow response_{\arg\max(score)}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.2d">italic_b italic_e italic_s italic_t _ italic_r italic_e italic_s italic_p italic_o italic_n italic_s italic_e ← italic_r italic_e italic_s italic_p italic_o italic_n italic_s italic_e start_POSTSUBSCRIPT roman_arg roman_max ( italic_s italic_c italic_o italic_r italic_e ) end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l13">
<math alttext="worst\_response\leftarrow response_{\arg\min(score)}" class="ltx_Math" display="inline" id="alg1.l13.m1.2"><semantics id="alg1.l13.m1.2a"><mrow id="alg1.l13.m1.2.3" xref="alg1.l13.m1.2.3.cmml"><mrow id="alg1.l13.m1.2.3.2" xref="alg1.l13.m1.2.3.2.cmml"><mi id="alg1.l13.m1.2.3.2.2" xref="alg1.l13.m1.2.3.2.2.cmml">w</mi><mo id="alg1.l13.m1.2.3.2.1" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.3" xref="alg1.l13.m1.2.3.2.3.cmml">o</mi><mo id="alg1.l13.m1.2.3.2.1a" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.4" xref="alg1.l13.m1.2.3.2.4.cmml">r</mi><mo id="alg1.l13.m1.2.3.2.1b" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.5" xref="alg1.l13.m1.2.3.2.5.cmml">s</mi><mo id="alg1.l13.m1.2.3.2.1c" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.6" xref="alg1.l13.m1.2.3.2.6.cmml">t</mi><mo id="alg1.l13.m1.2.3.2.1d" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.7" mathvariant="normal" xref="alg1.l13.m1.2.3.2.7.cmml">_</mi><mo id="alg1.l13.m1.2.3.2.1e" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.8" xref="alg1.l13.m1.2.3.2.8.cmml">r</mi><mo id="alg1.l13.m1.2.3.2.1f" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.9" xref="alg1.l13.m1.2.3.2.9.cmml">e</mi><mo id="alg1.l13.m1.2.3.2.1g" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.10" xref="alg1.l13.m1.2.3.2.10.cmml">s</mi><mo id="alg1.l13.m1.2.3.2.1h" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.11" xref="alg1.l13.m1.2.3.2.11.cmml">p</mi><mo id="alg1.l13.m1.2.3.2.1i" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.12" xref="alg1.l13.m1.2.3.2.12.cmml">o</mi><mo id="alg1.l13.m1.2.3.2.1j" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.13" xref="alg1.l13.m1.2.3.2.13.cmml">n</mi><mo id="alg1.l13.m1.2.3.2.1k" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.14" xref="alg1.l13.m1.2.3.2.14.cmml">s</mi><mo id="alg1.l13.m1.2.3.2.1l" xref="alg1.l13.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.2.15" xref="alg1.l13.m1.2.3.2.15.cmml">e</mi></mrow><mo id="alg1.l13.m1.2.3.1" stretchy="false" xref="alg1.l13.m1.2.3.1.cmml">←</mo><mrow id="alg1.l13.m1.2.3.3" xref="alg1.l13.m1.2.3.3.cmml"><mi id="alg1.l13.m1.2.3.3.2" xref="alg1.l13.m1.2.3.3.2.cmml">r</mi><mo id="alg1.l13.m1.2.3.3.1" xref="alg1.l13.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.3.3" xref="alg1.l13.m1.2.3.3.3.cmml">e</mi><mo id="alg1.l13.m1.2.3.3.1a" xref="alg1.l13.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.3.4" xref="alg1.l13.m1.2.3.3.4.cmml">s</mi><mo id="alg1.l13.m1.2.3.3.1b" xref="alg1.l13.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.3.5" xref="alg1.l13.m1.2.3.3.5.cmml">p</mi><mo id="alg1.l13.m1.2.3.3.1c" xref="alg1.l13.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.3.6" xref="alg1.l13.m1.2.3.3.6.cmml">o</mi><mo id="alg1.l13.m1.2.3.3.1d" xref="alg1.l13.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.3.7" xref="alg1.l13.m1.2.3.3.7.cmml">n</mi><mo id="alg1.l13.m1.2.3.3.1e" xref="alg1.l13.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.3.3.8" xref="alg1.l13.m1.2.3.3.8.cmml">s</mi><mo id="alg1.l13.m1.2.3.3.1f" xref="alg1.l13.m1.2.3.3.1.cmml">⁢</mo><msub id="alg1.l13.m1.2.3.3.9" xref="alg1.l13.m1.2.3.3.9.cmml"><mi id="alg1.l13.m1.2.3.3.9.2" xref="alg1.l13.m1.2.3.3.9.2.cmml">e</mi><mrow id="alg1.l13.m1.2.2.2" xref="alg1.l13.m1.2.2.2.cmml"><mi id="alg1.l13.m1.2.2.2.3" xref="alg1.l13.m1.2.2.2.3.cmml">arg</mi><mo id="alg1.l13.m1.2.2.2a" lspace="0.167em" xref="alg1.l13.m1.2.2.2.cmml">⁡</mo><mrow id="alg1.l13.m1.2.2.2.2.1" xref="alg1.l13.m1.2.2.2.2.2.cmml"><mi id="alg1.l13.m1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.cmml">min</mi><mo id="alg1.l13.m1.2.2.2.2.1a" xref="alg1.l13.m1.2.2.2.2.2.cmml">⁡</mo><mrow id="alg1.l13.m1.2.2.2.2.1.1" xref="alg1.l13.m1.2.2.2.2.2.cmml"><mo id="alg1.l13.m1.2.2.2.2.1.1.2" stretchy="false" xref="alg1.l13.m1.2.2.2.2.2.cmml">(</mo><mrow id="alg1.l13.m1.2.2.2.2.1.1.1" xref="alg1.l13.m1.2.2.2.2.1.1.1.cmml"><mi id="alg1.l13.m1.2.2.2.2.1.1.1.2" xref="alg1.l13.m1.2.2.2.2.1.1.1.2.cmml">s</mi><mo id="alg1.l13.m1.2.2.2.2.1.1.1.1" xref="alg1.l13.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.2.2.2.1.1.1.3" xref="alg1.l13.m1.2.2.2.2.1.1.1.3.cmml">c</mi><mo id="alg1.l13.m1.2.2.2.2.1.1.1.1a" xref="alg1.l13.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.2.2.2.1.1.1.4" xref="alg1.l13.m1.2.2.2.2.1.1.1.4.cmml">o</mi><mo id="alg1.l13.m1.2.2.2.2.1.1.1.1b" xref="alg1.l13.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.2.2.2.1.1.1.5" xref="alg1.l13.m1.2.2.2.2.1.1.1.5.cmml">r</mi><mo id="alg1.l13.m1.2.2.2.2.1.1.1.1c" xref="alg1.l13.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m1.2.2.2.2.1.1.1.6" xref="alg1.l13.m1.2.2.2.2.1.1.1.6.cmml">e</mi></mrow><mo id="alg1.l13.m1.2.2.2.2.1.1.3" stretchy="false" xref="alg1.l13.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.2b"><apply id="alg1.l13.m1.2.3.cmml" xref="alg1.l13.m1.2.3"><ci id="alg1.l13.m1.2.3.1.cmml" xref="alg1.l13.m1.2.3.1">←</ci><apply id="alg1.l13.m1.2.3.2.cmml" xref="alg1.l13.m1.2.3.2"><times id="alg1.l13.m1.2.3.2.1.cmml" xref="alg1.l13.m1.2.3.2.1"></times><ci id="alg1.l13.m1.2.3.2.2.cmml" xref="alg1.l13.m1.2.3.2.2">𝑤</ci><ci id="alg1.l13.m1.2.3.2.3.cmml" xref="alg1.l13.m1.2.3.2.3">𝑜</ci><ci id="alg1.l13.m1.2.3.2.4.cmml" xref="alg1.l13.m1.2.3.2.4">𝑟</ci><ci id="alg1.l13.m1.2.3.2.5.cmml" xref="alg1.l13.m1.2.3.2.5">𝑠</ci><ci id="alg1.l13.m1.2.3.2.6.cmml" xref="alg1.l13.m1.2.3.2.6">𝑡</ci><ci id="alg1.l13.m1.2.3.2.7.cmml" xref="alg1.l13.m1.2.3.2.7">_</ci><ci id="alg1.l13.m1.2.3.2.8.cmml" xref="alg1.l13.m1.2.3.2.8">𝑟</ci><ci id="alg1.l13.m1.2.3.2.9.cmml" xref="alg1.l13.m1.2.3.2.9">𝑒</ci><ci id="alg1.l13.m1.2.3.2.10.cmml" xref="alg1.l13.m1.2.3.2.10">𝑠</ci><ci id="alg1.l13.m1.2.3.2.11.cmml" xref="alg1.l13.m1.2.3.2.11">𝑝</ci><ci id="alg1.l13.m1.2.3.2.12.cmml" xref="alg1.l13.m1.2.3.2.12">𝑜</ci><ci id="alg1.l13.m1.2.3.2.13.cmml" xref="alg1.l13.m1.2.3.2.13">𝑛</ci><ci id="alg1.l13.m1.2.3.2.14.cmml" xref="alg1.l13.m1.2.3.2.14">𝑠</ci><ci id="alg1.l13.m1.2.3.2.15.cmml" xref="alg1.l13.m1.2.3.2.15">𝑒</ci></apply><apply id="alg1.l13.m1.2.3.3.cmml" xref="alg1.l13.m1.2.3.3"><times id="alg1.l13.m1.2.3.3.1.cmml" xref="alg1.l13.m1.2.3.3.1"></times><ci id="alg1.l13.m1.2.3.3.2.cmml" xref="alg1.l13.m1.2.3.3.2">𝑟</ci><ci id="alg1.l13.m1.2.3.3.3.cmml" xref="alg1.l13.m1.2.3.3.3">𝑒</ci><ci id="alg1.l13.m1.2.3.3.4.cmml" xref="alg1.l13.m1.2.3.3.4">𝑠</ci><ci id="alg1.l13.m1.2.3.3.5.cmml" xref="alg1.l13.m1.2.3.3.5">𝑝</ci><ci id="alg1.l13.m1.2.3.3.6.cmml" xref="alg1.l13.m1.2.3.3.6">𝑜</ci><ci id="alg1.l13.m1.2.3.3.7.cmml" xref="alg1.l13.m1.2.3.3.7">𝑛</ci><ci id="alg1.l13.m1.2.3.3.8.cmml" xref="alg1.l13.m1.2.3.3.8">𝑠</ci><apply id="alg1.l13.m1.2.3.3.9.cmml" xref="alg1.l13.m1.2.3.3.9"><csymbol cd="ambiguous" id="alg1.l13.m1.2.3.3.9.1.cmml" xref="alg1.l13.m1.2.3.3.9">subscript</csymbol><ci id="alg1.l13.m1.2.3.3.9.2.cmml" xref="alg1.l13.m1.2.3.3.9.2">𝑒</ci><apply id="alg1.l13.m1.2.2.2.cmml" xref="alg1.l13.m1.2.2.2"><arg id="alg1.l13.m1.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.3"></arg><apply id="alg1.l13.m1.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.1"><min id="alg1.l13.m1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1"></min><apply id="alg1.l13.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l13.m1.2.2.2.2.1.1.1"><times id="alg1.l13.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.2.2.1.1.1.1"></times><ci id="alg1.l13.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l13.m1.2.2.2.2.1.1.1.2">𝑠</ci><ci id="alg1.l13.m1.2.2.2.2.1.1.1.3.cmml" xref="alg1.l13.m1.2.2.2.2.1.1.1.3">𝑐</ci><ci id="alg1.l13.m1.2.2.2.2.1.1.1.4.cmml" xref="alg1.l13.m1.2.2.2.2.1.1.1.4">𝑜</ci><ci id="alg1.l13.m1.2.2.2.2.1.1.1.5.cmml" xref="alg1.l13.m1.2.2.2.2.1.1.1.5">𝑟</ci><ci id="alg1.l13.m1.2.2.2.2.1.1.1.6.cmml" xref="alg1.l13.m1.2.2.2.2.1.1.1.6">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.2c">worst\_response\leftarrow response_{\arg\min(score)}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.2d">italic_w italic_o italic_r italic_s italic_t _ italic_r italic_e italic_s italic_p italic_o italic_n italic_s italic_e ← italic_r italic_e italic_s italic_p italic_o italic_n italic_s italic_e start_POSTSUBSCRIPT roman_arg roman_min ( italic_s italic_c italic_o italic_r italic_e ) end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l14">Train the LLM using DPO with the best and worst responses:

</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_inline-block ltx_parbox ltx_align_top" id="alg1.l15.1" style="width:418.6pt;">
<span class="ltx_p" id="alg1.l15.1.1"><math alttext="LLM.train(prompt_{i},best\_response,worst\_response)" class="ltx_Math" display="inline" id="alg1.l15.1.1.m1.2"><semantics id="alg1.l15.1.1.m1.2a"><mrow id="alg1.l15.1.1.m1.2.2.2" xref="alg1.l15.1.1.m1.2.2.3.cmml"><mrow id="alg1.l15.1.1.m1.1.1.1.1" xref="alg1.l15.1.1.m1.1.1.1.1.cmml"><mi id="alg1.l15.1.1.m1.1.1.1.1.2" xref="alg1.l15.1.1.m1.1.1.1.1.2.cmml">L</mi><mo id="alg1.l15.1.1.m1.1.1.1.1.1" xref="alg1.l15.1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.1.1.1.1.3" xref="alg1.l15.1.1.m1.1.1.1.1.3.cmml">L</mi><mo id="alg1.l15.1.1.m1.1.1.1.1.1a" xref="alg1.l15.1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.1.1.1.1.4" xref="alg1.l15.1.1.m1.1.1.1.1.4.cmml">M</mi></mrow><mo id="alg1.l15.1.1.m1.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg1.l15.1.1.m1.2.2.3a.cmml">.</mo><mrow id="alg1.l15.1.1.m1.2.2.2.2" xref="alg1.l15.1.1.m1.2.2.2.2.cmml"><mi id="alg1.l15.1.1.m1.2.2.2.2.5" xref="alg1.l15.1.1.m1.2.2.2.2.5.cmml">t</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.4" xref="alg1.l15.1.1.m1.2.2.2.2.4.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.6" xref="alg1.l15.1.1.m1.2.2.2.2.6.cmml">r</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.4a" xref="alg1.l15.1.1.m1.2.2.2.2.4.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.7" xref="alg1.l15.1.1.m1.2.2.2.2.7.cmml">a</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.4b" xref="alg1.l15.1.1.m1.2.2.2.2.4.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.8" xref="alg1.l15.1.1.m1.2.2.2.2.8.cmml">i</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.4c" xref="alg1.l15.1.1.m1.2.2.2.2.4.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.9" xref="alg1.l15.1.1.m1.2.2.2.2.9.cmml">n</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.4d" xref="alg1.l15.1.1.m1.2.2.2.2.4.cmml">⁢</mo><mrow id="alg1.l15.1.1.m1.2.2.2.2.3.3" xref="alg1.l15.1.1.m1.2.2.2.2.3.4.cmml"><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.4" stretchy="false" xref="alg1.l15.1.1.m1.2.2.2.2.3.4.cmml">(</mo><mrow id="alg1.l15.1.1.m1.2.2.2.2.1.1.1" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.cmml"><mi id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.2" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.2.cmml">p</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.1" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.3" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.3.cmml">r</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.1a" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.4" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.4.cmml">o</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.1b" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.5" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.5.cmml">m</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.1c" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.6" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.6.cmml">p</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.1d" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><msub id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7.cmml"><mi id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7.2" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7.2.cmml">t</mi><mi id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7.3" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7.3.cmml">i</mi></msub></mrow><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.5" xref="alg1.l15.1.1.m1.2.2.2.2.3.4.cmml">,</mo><mrow id="alg1.l15.1.1.m1.2.2.2.2.2.2.2" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.cmml"><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.2" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.2.cmml">b</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.3" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.3.cmml">e</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1a" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.4" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.4.cmml">s</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1b" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.5" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.5.cmml">t</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1c" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.6" mathvariant="normal" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.6.cmml">_</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1d" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.7" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.7.cmml">r</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1e" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.8" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.8.cmml">e</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1f" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.9" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.9.cmml">s</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1g" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.10" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.10.cmml">p</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1h" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.11" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.11.cmml">o</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1i" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.12" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.12.cmml">n</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1j" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.13" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.13.cmml">s</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1k" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.14" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.14.cmml">e</mi></mrow><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.6" xref="alg1.l15.1.1.m1.2.2.2.2.3.4.cmml">,</mo><mrow id="alg1.l15.1.1.m1.2.2.2.2.3.3.3" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.cmml"><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.2" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.2.cmml">w</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.3" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.3.cmml">o</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1a" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.4" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.4.cmml">r</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1b" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.5" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.5.cmml">s</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1c" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.6" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.6.cmml">t</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1d" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.7" mathvariant="normal" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.7.cmml">_</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1e" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.8" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.8.cmml">r</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1f" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.9" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.9.cmml">e</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1g" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.10" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.10.cmml">s</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1h" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.11" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.11.cmml">p</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1i" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.12" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.12.cmml">o</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1j" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.13" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.13.cmml">n</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1k" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.14" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.14.cmml">s</mi><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1l" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.15" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.15.cmml">e</mi></mrow><mo id="alg1.l15.1.1.m1.2.2.2.2.3.3.7" stretchy="false" xref="alg1.l15.1.1.m1.2.2.2.2.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.1.1.m1.2b"><apply id="alg1.l15.1.1.m1.2.2.3.cmml" xref="alg1.l15.1.1.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.1.1.m1.2.2.3a.cmml" xref="alg1.l15.1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l15.1.1.m1.1.1.1.1.cmml" xref="alg1.l15.1.1.m1.1.1.1.1"><times id="alg1.l15.1.1.m1.1.1.1.1.1.cmml" xref="alg1.l15.1.1.m1.1.1.1.1.1"></times><ci id="alg1.l15.1.1.m1.1.1.1.1.2.cmml" xref="alg1.l15.1.1.m1.1.1.1.1.2">𝐿</ci><ci id="alg1.l15.1.1.m1.1.1.1.1.3.cmml" xref="alg1.l15.1.1.m1.1.1.1.1.3">𝐿</ci><ci id="alg1.l15.1.1.m1.1.1.1.1.4.cmml" xref="alg1.l15.1.1.m1.1.1.1.1.4">𝑀</ci></apply><apply id="alg1.l15.1.1.m1.2.2.2.2.cmml" xref="alg1.l15.1.1.m1.2.2.2.2"><times id="alg1.l15.1.1.m1.2.2.2.2.4.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.4"></times><ci id="alg1.l15.1.1.m1.2.2.2.2.5.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.5">𝑡</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.6.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.6">𝑟</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.7.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.7">𝑎</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.8.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.8">𝑖</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.9.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.9">𝑛</ci><vector id="alg1.l15.1.1.m1.2.2.2.2.3.4.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3"><apply id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1"><times id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.1"></times><ci id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.2">𝑝</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.3.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.3">𝑟</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.4.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.4">𝑜</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.5.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.5">𝑚</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.6.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.6">𝑝</ci><apply id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7"><csymbol cd="ambiguous" id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7.1.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7">subscript</csymbol><ci id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7.2.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7.2">𝑡</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7.3.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.1.1.1.7.3">𝑖</ci></apply></apply><apply id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2"><times id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.1"></times><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.2">𝑏</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.3">𝑒</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.4.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.4">𝑠</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.5.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.5">𝑡</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.6.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.6">_</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.7.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.7">𝑟</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.8.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.8">𝑒</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.9.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.9">𝑠</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.10.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.10">𝑝</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.11.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.11">𝑜</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.12.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.12">𝑛</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.13.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.13">𝑠</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.2.2.2.14.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.2.2.2.14">𝑒</ci></apply><apply id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3"><times id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.1"></times><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.2.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.2">𝑤</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.3.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.3">𝑜</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.4.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.4">𝑟</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.5.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.5">𝑠</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.6.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.6">𝑡</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.7.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.7">_</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.8.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.8">𝑟</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.9.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.9">𝑒</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.10.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.10">𝑠</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.11.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.11">𝑝</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.12.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.12">𝑜</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.13.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.13">𝑛</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.14.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.14">𝑠</ci><ci id="alg1.l15.1.1.m1.2.2.2.2.3.3.3.15.cmml" xref="alg1.l15.1.1.m1.2.2.2.2.3.3.3.15">𝑒</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.1.1.m1.2c">LLM.train(prompt_{i},best\_response,worst\_response)</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.1.1.m1.2d">italic_L italic_L italic_M . italic_t italic_r italic_a italic_i italic_n ( italic_p italic_r italic_o italic_m italic_p italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_b italic_e italic_s italic_t _ italic_r italic_e italic_s italic_p italic_o italic_n italic_s italic_e , italic_w italic_o italic_r italic_s italic_t _ italic_r italic_e italic_s italic_p italic_o italic_n italic_s italic_e )</annotation></semantics></math></span>
</span>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_text ltx_font_bold" id="alg1.l16.1">return</span> Final LLM-based recommendation model

</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">EXPERIMENTS</span>
</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.4.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.5.2">Experiments Settings</span>
</h3>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Performance comparison of models on MovieLens-1M and Amazon-Books datasets.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.1" style="width:287.0pt;height:115.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-35.9pt,14.4pt) scale(0.8,0.8) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.1.1">Backbone Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.1.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.2.1">PLM</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S3.T1.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.3.1">MovieLens-1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S3.T1.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.4.1">Amazon-Books</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.2.2">
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.2.1.1">MAP@5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.2.2.1">NDCG@5</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.2.2.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.2.3.1">MAP@5</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.2.2.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.2.4.1">NDCG@5</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.3.3.1" rowspan="3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.3.1.1">DLCM</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.3.3.2">base</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.3.3.3">0.72815</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.3.3.4">0.77053</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.3.3.5">0.63823</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.3.3.6">0.66078</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.4.4.1">KAR</th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4.2">0.73482</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.4.4.3">0.77622</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4.4">0.65794</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4.5">0.68434</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.5.5.1">RLRF4Rec</th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.5.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.5.2.1">0.73952</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.5.5.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.5.3.1">0.77942</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.5.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.5.4.1">0.66563</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.5.5"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.5.5.1">0.69310</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S3.T1.1.1.6.6.1" rowspan="3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.6.1.1">PRM</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.6.6.2">base</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.6.6.3">0.73471</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.6.6.4">0.77558</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.6.6.5">0.63808</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.6.6.6">0.65896</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.7.7.1">KAR</th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.7.2">0.74082</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.7.7.3">0.78171</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.7.4">0.66707</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.7.5">0.69481</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S3.T1.1.1.8.8.1">RLRF4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.1.1.8.8.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.8.8.2.1">0.74542</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.1.1.8.8.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.8.8.3.1">0.78529</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.1.1.8.8.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.8.8.4.1">0.67360</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.1.1.8.8.5"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.8.8.5.1">0.70131</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Ablation Experiment Results with DLCM.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S3.T2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.2.1">MovieLens-1M</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.3.1">Amazon-Books</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.2.1.1.1">RLRF4Rec</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.1.2"><span class="ltx_text ltx_font_bold" id="S3.T2.1.2.1.2.1">0.77942</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S3.T2.1.2.1.3.1">0.69310</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.3.2.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.3.2.1.1">RLRF4Rec(w/o Knowledge)</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.2.2">0.77053</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.2.3">0.66078</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T2.1.4.3.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.4.3.1.1">RLRF4Rec(w/o DPO)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.4.3.2">0.77671</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.4.3.3">0.68434</td>
</tr>
</tbody>
</table>
</figure>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS1.SSS1.4.1.1">III-A</span>1 </span>Dadasets</h4>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.2">Our experiments are conducted on public datasets, MovieLens-1M<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://grouplens.org/datasets/movielens/1m/</span></span></span></span> and Amazon-Book<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://cseweb.ucsd.edu/~jmcauley/datasets/amazon_v2/</span></span></span></span>. contains 1 million ratings provided by 6,040 users for 3,416 movies. Following the data processing similar to previous works<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib14" title="">14</a>]</cite>, We transform the ratings into binary labels by designating ratings 4 and 5 as positive and other ratings as negative. The data is split into training and testing sets based on user IDs, with <math alttext="90\%" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.1.m1.1"><semantics id="S3.SS1.SSS1.p1.1.m1.1a"><mrow id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml"><mn id="S3.SS1.SSS1.p1.1.m1.1.1.2" xref="S3.SS1.SSS1.p1.1.m1.1.1.2.cmml">90</mn><mo id="S3.SS1.SSS1.p1.1.m1.1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.1b"><apply id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1.1">percent</csymbol><cn id="S3.SS1.SSS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S3.SS1.SSS1.p1.1.m1.1.1.2">90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.1c">90\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.1.m1.1d">90 %</annotation></semantics></math> assigned to the training set and <math alttext="10\%" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.2.m2.1"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><mrow id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml"><mn id="S3.SS1.SSS1.p1.2.m2.1.1.2" xref="S3.SS1.SSS1.p1.2.m2.1.1.2.cmml">10</mn><mo id="S3.SS1.SSS1.p1.2.m2.1.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><apply id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S3.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.1">percent</csymbol><cn id="S3.SS1.SSS1.p1.2.m2.1.1.2.cmml" type="integer" xref="S3.SS1.SSS1.p1.2.m2.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.2.m2.1d">10 %</annotation></semantics></math> to the testing set. Amazon-Book [46] is the “Books” category of the Amazon Review Dataset. After filtering out the less-interacted users and items, we remain 11,906 users and 17,332 items with 1,406,582 interactions. The preprocessing is similar to MovieLens-1 M, with the difference being the absence of user features.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS1.SSS2.4.1.1">III-A</span>2 </span>Backbones</h4>
<div class="ltx_para" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.1">For the reranking task, we implement two of the state-of-the-art models, e.g., DLCM<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib22" title="">22</a>]</cite>, PRM<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib23" title="">23</a>]</cite>, as backbone models. DLCM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib22" title="">22</a>]</cite> first applies GRU to encode and rerank the top results. PRM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib23" title="">23</a>]</cite>employs self-attention to model the mutual influence between any pair of items and users’ preferences.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS1.SSS3.4.1.1">III-A</span>3 </span>Evaluation Metrics</h4>
<div class="ltx_para" id="S3.SS1.SSS3.p1">
<p class="ltx_p" id="S3.SS1.SSS3.p1.1">On reranking task, we employ widely used metrics NDCG@K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib24" title="">24</a>]</cite>and MAP@K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib25" title="">25</a>]</cite> as evaluation metrics following previous work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#bib.bib14" title="">14</a>]</cite>.These metrics are applied to evaluate the top-K items selected from the entire set of items not interacted with by the users.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS1.SSS4.4.1.1">III-A</span>4 </span>Implementation Details</h4>
<div class="ltx_para" id="S3.SS1.SSS4.p1">
<p class="ltx_p" id="S3.SS1.SSS4.p1.1">We utilize Llama-3.1-8B-Instruct<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://huggingface.co/meta-llama/Meta-Llama-3.1-8B-Instruct</span></span></span></span> as the LLM of RLRF4Rec and fine-tune it with LLaMA-Factory<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/hiyouga/LLaMA-Factory</span></span></span></span>, a framework designed to streamline the training of large language models. The same fine-tuning process and pipeline can be readily adapted to other LLMs. We used consistent parameters when training the recommendation model as the reward model to ensure a fair comparison between our model and the baseline models. As for the reward model training, we utilize BERT<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://huggingface.co/google-bert/bert-base-uncased</span></span></span></span> released by Hugging Face to encode the knowledge; We implement experiments with 64 as batch size, 1e-3 as the learning rate, 0.03 as the temperature, and 50 as the epoch. As for the DPO training, 2 is batch size, 5e-5 is the learning rate, 8 is the gradient accumulation steps, and 3.0 is the epoch.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.4.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.5.2">Main Result</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.T1" title="TABLE I ‣ III-A Experiments Settings ‣ III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_tag">I</span></a> shows the experimental results on MovieLens-1M and Amazon-Books datasets. As we can see, for all backbone models, RLRF4Rec outperforms the base and KAR models across both datasets. Specifically, in the DLCM model, RLRF4Rec achieves the highest MAP@5 and NDCG@5 scores on MovieLens-1M, with 0.73952 and 0.77942, respectively. Similarly, in the PRM model, RLRF4Rec also delivers superior performance with MAP@5 and NDCG@5 scores of 0.74542 and 0.78529 on MovieLens-1M.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">On the Amazon-Books dataset, RLRF4Rec again demonstrates its effectiveness. For DLCM, it surpasses both base and KAR, achieving a MAP@5 of 0.66563 and an NDCG@5 of 0.69310. For PRM, RLRF4Rec attains the best results with MAP@5 of 0.67360 and NDCG@5 of 0.70131.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">These results indicate that leveraging RLRF4Rec significantly boosts the recommendation quality, especially in terms of ranking precision, as evidenced by the higher MAP and NDCG values across both datasets.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS3.4.1.1">III-C</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS3.5.2">Ablation Study</span>
</h3>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS3.SSS1.4.1.1">III-C</span>1 </span>Performance with Knowledge and DPO</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.1">In the ablation study, we evaluated the performance of different components of the RLRF4Rec model. The results shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.T2" title="TABLE II ‣ III-A Experiments Settings ‣ III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_tag">II</span></a> demonstrate that the full model (RLRF4Rec) achieves the best performance on both the MovieLens-1M and Amazon-Books datasets, with scores of 0.77942 and 0.69310, respectively. When the knowledge component is removed, there is a significant performance drop, particularly on the Amazon-Books dataset, where the score decreases from 0.69310 to 0.66078, indicating that the knowledge component is crucial for recommendation effectiveness. Overall, the knowledge component contributes the most to the model’s performance, while the removal of the DPO component has a moderate impact, suggesting that the synergy of all components in the full model significantly enhances recommendation performance.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS3.SSS2.4.1.1">III-C</span>2 </span>Performance with Iteration Number</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.1">We want to verify the stabilization of two performance metrics, NDCG@5 and MAP@5, on the MovieLens-1M dataset after several iterations. The results are depicted in Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.05939v1#S3.F4" title="Figure 4 ‣ NDCG@5 (Figure b) ‣ III-C2 Performance with Iteration Number ‣ III-C Ablation Study ‣ III EXPERIMENTS ‣ RLRF4Rec: Reinforcement Learning from Recsys Feedback for Enhanced Recommendation Reranking ⋆Corresponding author. This work was supported by the National Key Research and Development Program of China (No. 2023YFC3807600)."><span class="ltx_text ltx_ref_tag">4</span></a>, where both metrics are shown across four rounds: the original, Round 1, Round 2, and Round 3.</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS2.Px1">
<h5 class="ltx_title ltx_title_paragraph">MAP@5 (Figure a)</h5>
<div class="ltx_para" id="S3.SS3.SSS2.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS2.Px1.p1.1">Initially, the model starts with a MAP@5 score of approximately 0.73595. After the first round, there is a slight improvement, with the score reaching about 0.73903, and by the round2, it increases marginally to 0.73952. The gains from round to round are minimal, indicating that after the first round, further improvements are very limited.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS2.Px2">
<h5 class="ltx_title ltx_title_paragraph">NDCG@5 (Figure b)</h5>
<div class="ltx_para" id="S3.SS3.SSS2.Px2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.Px2.p1.1">Similarly, the NDCG@5 score follows a similar trend. Starting from a value of 0.77671. With each subsequent round, there is a slight increase, reaching approximately 0.77942 by the round2. Again, the incremental improvement between rounds becomes negligible.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.Px2.p2">
<p class="ltx_p" id="S3.SS3.SSS2.Px2.p2.1">This analysis indicates that, after 2 of iterations, the improvement in performance for both metrics becomes negligible, suggesting that the model’s effectiveness has reached a saturation point. Therefore, additional iterations may not be necessary beyond this threshold.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="669" id="S3.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Performance with iterations on MovieLens-1M</figcaption>
</figure>
</section>
</section>
</section>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">CONCLUSION</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">In conclusion, this work presents RLRF4Rec, a novel framework designed to enhance the performance of large language models (LLMs) in recommendation systems by addressing the limitations posed by the disparity between LLM pre-training tasks and recommendation tasks. By integrating reinforcement learning from recommendation feedback, RLRF4Rec leverages inferred user preferences generated by LLMs to augment traditional sequence-based recommendation models. The framework introduces a reward model to evaluate reasoning knowledge and applies Direct Preference Optimization (DPO) to fine-tune LLMs, aligning them with recommendation tasks. Extensive experiments validate the effectiveness of RLRF4Rec, showing significant improvements in recommendation re-ranking metrics. This approach demonstrates that when properly guided and aligned, LLMs can substantially improve their performance in recommendation tasks.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
W. X. Zhao, K. Zhou, J. Li, T. Tang, X. Wang, Y. Hou, Y. Min, B. Zhang, J. Zhang, Z. Dong <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">et al.</em>, “A survey of large language models,” <em class="ltx_emph ltx_font_italic" id="bib.bib1.2.2">arXiv preprint arXiv:2303.18223</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
T. B. Brown, “Language models are few-shot learners,” <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2005.14165</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Z. Zhao, W. Fan, J. Li, Y. Liu, X. Mei, Y. Wang, Z. Wen, F. Wang, X. Zhao, J. Tang <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">et al.</em>, “Recommender systems in the era of large language models (llms),” <em class="ltx_emph ltx_font_italic" id="bib.bib3.2.2">arXiv preprint arXiv:2307.02046</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Y. Li, X. Lin, W. Wang, F. Feng, L. Pang, W. Li, L. Nie, X. He, and T.-S. Chua, “A survey of generative search and recommendation in the era of large language models,” <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2404.16924</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
S. Geng, S. Liu, Z. Fu, Y. Ge, and Y. Zhang, “Recommendation as language processing (rlp): A unified pretrain, personalized prompt &amp; predict paradigm (p5),” in <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 16th ACM Conference on Recommender Systems</em>, 2022, pp. 299–315.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
K. Bao, J. Zhang, Y. Zhang, W. Wang, F. Feng, and X. He, “Tallrec: An effective and efficient tuning framework to align large language model with recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 17th ACM Conference on Recommender Systems</em>, 2023, pp. 1007–1014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
S. Dai, N. Shao, H. Zhao, W. Yu, Z. Si, C. Xu, Z. Sun, X. Zhang, and J. Xu, “Uncovering chatgpt’s capabilities in recommender systems,” in <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 17th ACM Conference on Recommender Systems</em>, 2023, pp. 1126–1132.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
S. Geng, J. Tan, S. Liu, Z. Fu, and Y. Zhang, “Vip5: Towards multimodal foundation models for recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2305.14302</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
J. Li, W. Zhang, T. Wang, G. Xiong, A. Lu, and G. Medioni, “Gpt4rec: A generative framework for personalized recommendation and user interests interpretation,” <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2304.03879</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Y. Hou, J. Zhang, Z. Lin, H. Lu, R. Xie, J. McAuley, and W. X. Zhao, “Large language models are zero-shot rankers for recommender systems,” in <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">European Conference on Information Retrieval</em>.   Springer, 2024, pp. 364–381.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
J. Liu, C. Liu, P. Zhou, R. Lv, K. Zhou, and Y. Zhang, “Is chatgpt a good recommender? a preliminary study,” <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2304.10149</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
W. Lu, J. Lian, W. Zhang, G. Li, M. Zhou, H. Liao, and X. Xie, “Aligning large language models for controllable recommendations,” <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2403.05063</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
W. Luo, C. Song, L. Yi, and G. Cheng, “Kellmrec: Knowledge-enhanced large language models for recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2403.06642</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Y. Xi, W. Liu, J. Lin, X. Cai, H. Zhu, J. Zhu, B. Chen, R. Tang, W. Zhang, R. Zhang, and Y. Yu, “Towards open-world recommendation with knowledge augmentation from large language models.” [Online]. Available: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://arxiv.org/abs/2306.10933</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Q. Liu, N. Chen, T. Sakai, and X.-M. Wu, “A first look at llm-powered generative news recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2305.06566</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
C. Li, Y. Ge, J. Mao, D. Li, and Y. Shan, “Taggpt: Large language models are zero-shot multimodal taggers,” <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2304.03022</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
J. Wang, H. Lu, J. Caverlee, E. H. Chi, and M. Chen, “Large language models as data augmenters for cold-start item recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Companion Proceedings of the ACM on Web Conference 2024</em>, 2024, pp. 726–729.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
X. Ren, W. Wei, L. Xia, L. Su, S. Cheng, J. Wang, D. Yin, and C. Huang, “Representation learning with large language models for recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the ACM on Web Conference 2024</em>, 2024, pp. 3464–3475.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Y. Bai, A. Jones, K. Ndousse, A. Askell, A. Chen, N. DasSarma, D. Drain, S. Fort, D. Ganguli, T. Henighan <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">et al.</em>, “Training a helpful and harmless assistant with reinforcement learning from human feedback,” <em class="ltx_emph ltx_font_italic" id="bib.bib19.2.2">arXiv preprint arXiv:2204.05862</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
R. Rafailov, A. Sharma, E. Mitchell, C. D. Manning, S. Ermon, and C. Finn, “Direct preference optimization: Your language model is secretly a reward model,” <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Advances in Neural Information Processing Systems</em>, vol. 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
G. Zhou, X. Zhu, C. Song, Y. Fan, H. Zhu, X. Ma, Y. Yan, J. Jin, H. Li, and K. Gai, “Deep interest network for click-through rate prediction,” in <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>, 2018, pp. 1059–1068.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Q. Ai, K. Bi, J. Guo, and W. B. Croft, “Learning a deep listwise context model for ranking refinement,” in <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">The 41st international ACM SIGIR conference on research &amp; development in information retrieval</em>, 2018, pp. 135–144.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
C. Pei, Y. Zhang, Y. Zhang, F. Sun, X. Lin, H. Sun, J. Wu, P. Jiang, J. Ge, W. Ou <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">et al.</em>, “Personalized re-ranking for recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib23.2.2">Proceedings of the 13th ACM conference on recommender systems</em>, 2019, pp. 3–11.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
K. Järvelin and J. Kekäläinen, “Cumulated gain-based evaluation of ir techniques,” <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">ACM Transactions on Information Systems (TOIS)</em>, vol. 20, no. 4, pp. 422–446, 2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Y. Yue, T. Finley, F. Radlinski, and T. Joachims, “A support vector method for optimizing average precision,” in <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the 30th annual international ACM SIGIR conference on Research and development in information retrieval</em>, 2007, pp. 271–278.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Y. Xi, W. Liu, J. Zhu, X. Zhao, X. Dai, R. Tang, W. Zhang, R. Zhang, and Y. Yu, “Multi-level interaction reranking with user behavior history,” in <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, 2022, pp. 1336–1346.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Oct  8 11:36:05 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
