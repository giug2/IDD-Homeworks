<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2109.12273] FedProc: Prototypical Contrastive Federated Learning on Non-IID data</title><meta property="og:description" content="Federated learning allows multiple clients to collaborate to train high-performance deep learning models while keeping the training data locally. However, when the local data of all clients are not independent and iden…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedProc: Prototypical Contrastive Federated Learning on Non-IID data">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedProc: Prototypical Contrastive Federated Learning on Non-IID data">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2109.12273">

<!--Generated on Tue Mar 19 14:18:49 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FedProc: Prototypical Contrastive Federated Learning on Non-IID data</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Xutong Mu,<sup id="id2.1.id1" class="ltx_sup">1</sup>
Yulong Shen,<sup id="id3.2.id2" class="ltx_sup">1</sup>
Ke Cheng,<sup id="id4.3.id3" class="ltx_sup">1</sup>
Xueli Geng,<sup id="id5.4.id4" class="ltx_sup">2</sup>
Jiaxuan Fu,<sup id="id6.5.id5" class="ltx_sup">1</sup>
Tao Zhang,<sup id="id7.6.id6" class="ltx_sup">1</sup>
Zhiwei Zhang<sup id="id8.7.id7" class="ltx_sup">1</sup>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.1" class="ltx_p">Federated learning allows multiple clients to collaborate to train high-performance deep learning models while keeping the training data locally. However, when the local data of all clients are not independent and identically distributed (i.e., non-IID), it is challenging to implement this form of efficient collaborative learning. Although significant efforts have been dedicated to addressing this challenge, the effect on the image classification task is still not satisfactory. In this paper, we propose <span id="id1.1.1" class="ltx_text ltx_font_italic">FedProc</span>: prototypical contrastive federated learning, which is a simple and effective federated learning framework.
The key idea is to utilize the prototypes as global knowledge to correct the local training of each client.
We design a local network architecture and a global prototypical contrastive loss to regulate the training of local models, which makes local objectives consistent with the global optima. Eventually, the converged global model obtains a good performance on non-IID data.
Experimental results show that, compared to state-of-the-art federated learning methods, FedProc improves the accuracy by <math id="id1.1.m1.1" class="ltx_Math" alttext="1.6\%\sim 7.9\%" display="inline"><semantics id="id1.1.m1.1a"><mrow id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mrow id="id1.1.m1.1.1.2" xref="id1.1.m1.1.1.2.cmml"><mn id="id1.1.m1.1.1.2.2" xref="id1.1.m1.1.1.2.2.cmml">1.6</mn><mo id="id1.1.m1.1.1.2.1" xref="id1.1.m1.1.1.2.1.cmml">%</mo></mrow><mo id="id1.1.m1.1.1.1" xref="id1.1.m1.1.1.1.cmml">∼</mo><mrow id="id1.1.m1.1.1.3" xref="id1.1.m1.1.1.3.cmml"><mn id="id1.1.m1.1.1.3.2" xref="id1.1.m1.1.1.3.2.cmml">7.9</mn><mo id="id1.1.m1.1.1.3.1" xref="id1.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><csymbol cd="latexml" id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1.1">similar-to</csymbol><apply id="id1.1.m1.1.1.2.cmml" xref="id1.1.m1.1.1.2"><csymbol cd="latexml" id="id1.1.m1.1.1.2.1.cmml" xref="id1.1.m1.1.1.2.1">percent</csymbol><cn type="float" id="id1.1.m1.1.1.2.2.cmml" xref="id1.1.m1.1.1.2.2">1.6</cn></apply><apply id="id1.1.m1.1.1.3.cmml" xref="id1.1.m1.1.1.3"><csymbol cd="latexml" id="id1.1.m1.1.1.3.1.cmml" xref="id1.1.m1.1.1.3.1">percent</csymbol><cn type="float" id="id1.1.m1.1.1.3.2.cmml" xref="id1.1.m1.1.1.3.2">7.9</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">1.6\%\sim 7.9\%</annotation></semantics></math> with acceptable computation cost.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL), as a promising machine learning approach, has enabled distributed clients to collaboratively train a global model without accessing their data by sharing their local model parameters for aggregation.
This approach effectively mitigates privacy concerns in situations where raw data cannot be gathered into a central server for legal or privacy reasons. Serving as a communication-efficient and privacy-preserving learning scheme, FL has shown its potential to facilitate real-world applications, including medical image analysis <cite class="ltx_cite ltx_citemacro_citep">(Kaissis et al. <a href="#bib.bib16" title="" class="ltx_ref">2020</a>; Kumar et al. <a href="#bib.bib19" title="" class="ltx_ref">2021</a>)</cite>, biometrics analysis <cite class="ltx_cite ltx_citemacro_citep">(Aggarwal, Zhou, and Jain <a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite>, and object detection <cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite>, etc.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">FL has been shown to work well on the independent and identically distributed (IID) data. However, in practice, the data hold by different clients usually has a highly skewed distribution. Specifically, the local dataset of each client is non-independent and identically distributed (non-IID), which can result in a significant decrease in the performance of FL <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al. <a href="#bib.bib40" title="" class="ltx_ref">2018</a>; Kairouz et al. <a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite>. This unbalanced data distribution will bring about a drift of local model training in each client, making the local objective far from the global optima. How to mitigate the adverse effects of non-IID data for FL is still an open question.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">A variety of efforts have been made to tackle non-IID data issues, mainly from two complementary perspectives: one aims to improve the efficacy of model aggregation, such as FedNova <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib35" title="" class="ltx_ref">2020b</a>)</cite>, FedMA <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib34" title="" class="ltx_ref">2020a</a>)</cite>, FedAvgM <cite class="ltx_cite ltx_citemacro_citep">(Hsu, Qi, and Brown <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>.
Another focuses on stabilizing the local training phase by regulating the deviation of the local models from a global model over the parameter space, such as MOON <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>, FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib22" title="" class="ltx_ref">2020b</a>)</cite>, SCAFFOLD <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al. <a href="#bib.bib17" title="" class="ltx_ref">2019</a>)</cite>. However, whether in the model aggregation phase or local training phase, these approaches do not take full advantage of the underlying knowledge provided by each client.
As shown in the experiments (see Section 4),
the accuracy and computation efficiency of these approaches still have plenty of room for improvement.
</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Observing the challenge in the presence of non-IID data and the limitations of the prior arts, in this paper, we propose a prototypical contrastive federated learning framework, dubbed as FedProc. Inspired by the prototypical contrastive learning <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib20" title="" class="ltx_ref">2020a</a>)</cite>, we innovatively introduce prototypes into federated learning for fully utilizing the knowledge of each client to correct the local training. A prototype is defined as the mean vectors for the representations in each class <cite class="ltx_cite ltx_citemacro_citep">(Snell, Swersky, and Zemel <a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite>.
Specifically, the server first obtains the global class-prototypes by gathering the class-prototypes of the client and broadcasts them to clients as global knowledge to correct local training. Then, the clients use our elaborate local network architecture and loss function to regulate the training of local models, which makes local objectives consistent with the global optima.
This approach forces each sample of the client to be pulled toward the global prototype of its class and pushed away from the global prototypes of other classes, such that the classification performance of the local network would be improved.
In summary, FedProc is a simple and effective federated learning framework that addresses the non-IID data issues from a new perspective of prototype-based contrastive learning.
</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We experimentally evaluate the performance of FedProc on multiple image classification datasets, including CIFAR-10, CIFAR-100, and Tiny-ImageNet.
FedProc significantly outperforms the state-of-the-art federated learning algorithms <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib21" title="" class="ltx_ref">2021</a>; Li et al. <a href="#bib.bib22" title="" class="ltx_ref">2020b</a>; Karimireddy et al. <a href="#bib.bib17" title="" class="ltx_ref">2019</a>)</cite>.
With acceptable computation cost, FedProc improves accuracy by 1.6% on the CIFAR-10 dataset, and even more than 7% on the CIFAR-100 and Tiny-ImageNet datasets. As a highlight, on the CIFAR-100 dataset with 100 clients, FedProc achieves 70.6% top-1 accuracy, while the best result of existing approaches is 61.8%.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">We summarize our contributions as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a novel federated learning framework to address the non-IID data issues. The framework introduces the global class-prototypes to correct the local training, yielding a good classification performance.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We design a hybrid local network architecture and a global prototypical contrastive loss to make use of the underlying knowledge provided by global class-prototypes. The careful designs of the local network and the loss function enable FedProc to achieve a good performance.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We implement FedProc, and do extensive experiments on different datasets. The results demonstrate that FedProc significantly outperforms the state-of-the-art in terms of both inference accuracy and computational efficiency.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background and Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Federated Learning (FL) is first proposed as a decentralized machine learning paradigm <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite>, which is executed by following a typical four-step protocol illustrated in Figure <a href="#S2.F1" title="Figure 1 ‣ 2.1 Federated Learning ‣ 2 Background and Related Work ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. 1) The server randomly initializes the parameters of the global model and sends them to each client. 2) When receiving the global model, each client updates the model based on their local training data using stochastic gradient descent (SGD). 3) The selected clients upload their local model parameters back to the server. 4) The server averages the model parameters to produce a global model for the training of the next round. These steps are repeated until convergence is achieved.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Subsequent work along this line tackles different challenges faced by FL, including heterogeneity <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al. <a href="#bib.bib28" title="" class="ltx_ref">2019</a>; Briggs, Fan, and Andras <a href="#bib.bib4" title="" class="ltx_ref">2020</a>; Huang et al. <a href="#bib.bib13" title="" class="ltx_ref">2021b</a>)</cite>, privacy <cite class="ltx_cite ltx_citemacro_citep">(Truex et al. <a href="#bib.bib31" title="" class="ltx_ref">2019</a>; Wang et al. <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite>, communication efficiency <cite class="ltx_cite ltx_citemacro_citep">(Luping, Wei, and Bo <a href="#bib.bib24" title="" class="ltx_ref">2019</a>; Asad et al. <a href="#bib.bib2" title="" class="ltx_ref">2021</a>; Bouacida et al. <a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite>, and convergence analysis <cite class="ltx_cite ltx_citemacro_citep">(Huang et al. <a href="#bib.bib12" title="" class="ltx_ref">2021a</a>; Jin et al. <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite>.
Specifically, a wealth of work has been proposed to handle the non-IID issues, mainly from two complementary perspectives: one focuses on stabilizing the local training phase, such as MOON <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>, FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib22" title="" class="ltx_ref">2020b</a>)</cite>, SCAFFOLD <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al. <a href="#bib.bib17" title="" class="ltx_ref">2019</a>)</cite>. Another aims to improve the efficacy of model aggregation, such as FedNova <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib35" title="" class="ltx_ref">2020b</a>)</cite>, FedMA <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib34" title="" class="ltx_ref">2020a</a>)</cite>, FedAvgM <cite class="ltx_cite ltx_citemacro_citep">(Hsu, Qi, and Brown <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>. In addition, there are also other FL studies related to non-IID data setting, such as personalizing the local models for each client <cite class="ltx_cite ltx_citemacro_citep">(T Dinh, Tran, and Nguyen <a href="#bib.bib30" title="" class="ltx_ref">2020</a>; Fallah, Mokhtari, and Ozdaglar <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Hanzely et al. <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite> and designing robust algorithms against different combinations of local distributions <cite class="ltx_cite ltx_citemacro_citep">(Deng, Kamani, and Mahdavi <a href="#bib.bib6" title="" class="ltx_ref">2020</a>; Mohri, Sivek, and Suresh <a href="#bib.bib26" title="" class="ltx_ref">2019</a>; Reisizadeh et al. <a href="#bib.bib27" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2109.12273/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="238" height="202" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Federated learning process.</figcaption>
</figure>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Contrastive Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Contrastive learning has shown great promise in unsupervised representation learning <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib5" title="" class="ltx_ref">2020</a>; He et al. <a href="#bib.bib9" title="" class="ltx_ref">2020</a>)</cite>.
The key idea is to learn an embedding space where samples from the same instance are pulled closer (i.e., positive pairs) and samples from different instances are pushed apart (i.e., negative pairs).
Supervised contrastive learning <cite class="ltx_cite ltx_citemacro_citep">(Khosla et al. <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite> is an extension to contrastive learning by incorporating the label information to compose positive and negative images. A recent work <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite> improved the quality of learning features using supervised contrastive learning to solve the long-tail distribution problem in classification tasks.
Later, there emerges prototypical contrastive learning <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib20" title="" class="ltx_ref">2020a</a>)</cite>, which is an unsupervised feature learning method that bridges contrastive learning with clustering.
Different from prior work,
we design a local network architecture and a loss function tailored for federated learning to address the non-IID data issues from a perspective of supervised contrastive learning.</p>
</div>
<figure id="S2.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S2.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x2.png" id="S2.F2.sf1.g1" class="ltx_graphics ltx_img_landscape" width="111" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Client <math id="S2.F2.sf1.2.m1.1" class="ltx_Math" alttext="C_{1}" display="inline"><semantics id="S2.F2.sf1.2.m1.1b"><msub id="S2.F2.sf1.2.m1.1.1" xref="S2.F2.sf1.2.m1.1.1.cmml"><mi id="S2.F2.sf1.2.m1.1.1.2" xref="S2.F2.sf1.2.m1.1.1.2.cmml">C</mi><mn id="S2.F2.sf1.2.m1.1.1.3" xref="S2.F2.sf1.2.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.sf1.2.m1.1c"><apply id="S2.F2.sf1.2.m1.1.1.cmml" xref="S2.F2.sf1.2.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.sf1.2.m1.1.1.1.cmml" xref="S2.F2.sf1.2.m1.1.1">subscript</csymbol><ci id="S2.F2.sf1.2.m1.1.1.2.cmml" xref="S2.F2.sf1.2.m1.1.1.2">𝐶</ci><cn type="integer" id="S2.F2.sf1.2.m1.1.1.3.cmml" xref="S2.F2.sf1.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.sf1.2.m1.1d">C_{1}</annotation></semantics></math> in SOLO</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S2.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x3.png" id="S2.F2.sf2.g1" class="ltx_graphics ltx_img_landscape" width="100" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Client <math id="S2.F2.sf2.2.m1.1" class="ltx_Math" alttext="C_{2}" display="inline"><semantics id="S2.F2.sf2.2.m1.1b"><msub id="S2.F2.sf2.2.m1.1.1" xref="S2.F2.sf2.2.m1.1.1.cmml"><mi id="S2.F2.sf2.2.m1.1.1.2" xref="S2.F2.sf2.2.m1.1.1.2.cmml">C</mi><mn id="S2.F2.sf2.2.m1.1.1.3" xref="S2.F2.sf2.2.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.sf2.2.m1.1c"><apply id="S2.F2.sf2.2.m1.1.1.cmml" xref="S2.F2.sf2.2.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.sf2.2.m1.1.1.1.cmml" xref="S2.F2.sf2.2.m1.1.1">subscript</csymbol><ci id="S2.F2.sf2.2.m1.1.1.2.cmml" xref="S2.F2.sf2.2.m1.1.1.2">𝐶</ci><cn type="integer" id="S2.F2.sf2.2.m1.1.1.3.cmml" xref="S2.F2.sf2.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.sf2.2.m1.1d">C_{2}</annotation></semantics></math> in SOLO</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S2.F2.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x4.png" id="S2.F2.sf3.g1" class="ltx_graphics ltx_img_landscape" width="100" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Global distribution</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S2.F2.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x5.png" id="S2.F2.sf4.g1" class="ltx_graphics ltx_img_landscape" width="100" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Client <math id="S2.F2.sf4.2.m1.1" class="ltx_Math" alttext="C_{1}" display="inline"><semantics id="S2.F2.sf4.2.m1.1b"><msub id="S2.F2.sf4.2.m1.1.1" xref="S2.F2.sf4.2.m1.1.1.cmml"><mi id="S2.F2.sf4.2.m1.1.1.2" xref="S2.F2.sf4.2.m1.1.1.2.cmml">C</mi><mn id="S2.F2.sf4.2.m1.1.1.3" xref="S2.F2.sf4.2.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.sf4.2.m1.1c"><apply id="S2.F2.sf4.2.m1.1.1.cmml" xref="S2.F2.sf4.2.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.sf4.2.m1.1.1.1.cmml" xref="S2.F2.sf4.2.m1.1.1">subscript</csymbol><ci id="S2.F2.sf4.2.m1.1.1.2.cmml" xref="S2.F2.sf4.2.m1.1.1.2">𝐶</ci><cn type="integer" id="S2.F2.sf4.2.m1.1.1.3.cmml" xref="S2.F2.sf4.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.sf4.2.m1.1d">C_{1}</annotation></semantics></math> in FedProc</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S2.F2.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x6.png" id="S2.F2.sf5.g1" class="ltx_graphics ltx_img_landscape" width="100" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>Client <math id="S2.F2.sf5.2.m1.1" class="ltx_Math" alttext="C_{2}" display="inline"><semantics id="S2.F2.sf5.2.m1.1b"><msub id="S2.F2.sf5.2.m1.1.1" xref="S2.F2.sf5.2.m1.1.1.cmml"><mi id="S2.F2.sf5.2.m1.1.1.2" xref="S2.F2.sf5.2.m1.1.1.2.cmml">C</mi><mn id="S2.F2.sf5.2.m1.1.1.3" xref="S2.F2.sf5.2.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.sf5.2.m1.1c"><apply id="S2.F2.sf5.2.m1.1.1.cmml" xref="S2.F2.sf5.2.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.sf5.2.m1.1.1.1.cmml" xref="S2.F2.sf5.2.m1.1.1">subscript</csymbol><ci id="S2.F2.sf5.2.m1.1.1.2.cmml" xref="S2.F2.sf5.2.m1.1.1.2">𝐶</ci><cn type="integer" id="S2.F2.sf5.2.m1.1.1.3.cmml" xref="S2.F2.sf5.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.sf5.2.m1.1d">C_{2}</annotation></semantics></math> in FedProc</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>T-SNE visualizations of hidden vectors on CIFAR-10. Figure (a) and (b) show the SOLO representations at Client <math id="S2.F2.5.m1.1" class="ltx_Math" alttext="C_{1}" display="inline"><semantics id="S2.F2.5.m1.1b"><msub id="S2.F2.5.m1.1.1" xref="S2.F2.5.m1.1.1.cmml"><mi id="S2.F2.5.m1.1.1.2" xref="S2.F2.5.m1.1.1.2.cmml">C</mi><mn id="S2.F2.5.m1.1.1.3" xref="S2.F2.5.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.5.m1.1c"><apply id="S2.F2.5.m1.1.1.cmml" xref="S2.F2.5.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.5.m1.1.1.1.cmml" xref="S2.F2.5.m1.1.1">subscript</csymbol><ci id="S2.F2.5.m1.1.1.2.cmml" xref="S2.F2.5.m1.1.1.2">𝐶</ci><cn type="integer" id="S2.F2.5.m1.1.1.3.cmml" xref="S2.F2.5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.5.m1.1d">C_{1}</annotation></semantics></math> and <math id="S2.F2.6.m2.1" class="ltx_Math" alttext="C_{2}" display="inline"><semantics id="S2.F2.6.m2.1b"><msub id="S2.F2.6.m2.1.1" xref="S2.F2.6.m2.1.1.cmml"><mi id="S2.F2.6.m2.1.1.2" xref="S2.F2.6.m2.1.1.2.cmml">C</mi><mn id="S2.F2.6.m2.1.1.3" xref="S2.F2.6.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.6.m2.1c"><apply id="S2.F2.6.m2.1.1.cmml" xref="S2.F2.6.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.6.m2.1.1.1.cmml" xref="S2.F2.6.m2.1.1">subscript</csymbol><ci id="S2.F2.6.m2.1.1.2.cmml" xref="S2.F2.6.m2.1.1.2">𝐶</ci><cn type="integer" id="S2.F2.6.m2.1.1.3.cmml" xref="S2.F2.6.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.6.m2.1d">C_{2}</annotation></semantics></math>, respectively. Figure (c) shows global representation distribution. Figure (d) and (e) show the FedProc representations at Client <math id="S2.F2.7.m3.1" class="ltx_Math" alttext="C_{1}" display="inline"><semantics id="S2.F2.7.m3.1b"><msub id="S2.F2.7.m3.1.1" xref="S2.F2.7.m3.1.1.cmml"><mi id="S2.F2.7.m3.1.1.2" xref="S2.F2.7.m3.1.1.2.cmml">C</mi><mn id="S2.F2.7.m3.1.1.3" xref="S2.F2.7.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.7.m3.1c"><apply id="S2.F2.7.m3.1.1.cmml" xref="S2.F2.7.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.7.m3.1.1.1.cmml" xref="S2.F2.7.m3.1.1">subscript</csymbol><ci id="S2.F2.7.m3.1.1.2.cmml" xref="S2.F2.7.m3.1.1.2">𝐶</ci><cn type="integer" id="S2.F2.7.m3.1.1.3.cmml" xref="S2.F2.7.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.7.m3.1d">C_{1}</annotation></semantics></math> and <math id="S2.F2.8.m4.1" class="ltx_Math" alttext="C_{2}" display="inline"><semantics id="S2.F2.8.m4.1b"><msub id="S2.F2.8.m4.1.1" xref="S2.F2.8.m4.1.1.cmml"><mi id="S2.F2.8.m4.1.1.2" xref="S2.F2.8.m4.1.1.2.cmml">C</mi><mn id="S2.F2.8.m4.1.1.3" xref="S2.F2.8.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.8.m4.1c"><apply id="S2.F2.8.m4.1.1.cmml" xref="S2.F2.8.m4.1.1"><csymbol cd="ambiguous" id="S2.F2.8.m4.1.1.1.cmml" xref="S2.F2.8.m4.1.1">subscript</csymbol><ci id="S2.F2.8.m4.1.1.2.cmml" xref="S2.F2.8.m4.1.1.2">𝐶</ci><cn type="integer" id="S2.F2.8.m4.1.1.3.cmml" xref="S2.F2.8.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.m4.1d">C_{2}</annotation></semantics></math>, respectively. SOLO: A baseline approach where each client trains a model only by inputting its local data without federated learning.</figcaption>
</figure>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Contrastive Learning in Federated Learning</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Contrastive learning in federated learning has recently emerged as an effective approach to tackle the non-IID issue.
Some existing works <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a href="#bib.bib39" title="" class="ltx_ref">2020</a>; van Berlo, Saeed, and Ozcelebi <a href="#bib.bib32" title="" class="ltx_ref">2020</a>)</cite> focus on the unsupervised learning setting.
They use a contrastive loss to compare the representations of different images in order to make full use of the enormous unlabeled data on distributed edge devices.
MOON <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite> is based on the design of model-based comparative learning to solve non-IID data problems. This model-level comparative learning is performed by comparing the representations of different model learning, and the local update is corrected by maximizing the consistency between the current local model learning representation and the global model learning representation.
However, in this paper, we focus on the supervised learning setting, and we introduce prototypes to address the issues of inconsistency in the embedding space for each client.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Prototypical Contrastive Federated Learning</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Statement</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.12" class="ltx_p">FedProc involves <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">m</annotation></semantics></math> clients (denoted as <math id="S3.SS1.p1.2.m2.3" class="ltx_Math" alttext="C_{1},...,C_{m}" display="inline"><semantics id="S3.SS1.p1.2.m2.3a"><mrow id="S3.SS1.p1.2.m2.3.3.2" xref="S3.SS1.p1.2.m2.3.3.3.cmml"><msub id="S3.SS1.p1.2.m2.2.2.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.2.cmml">C</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.3.3.2.3" xref="S3.SS1.p1.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.3.3.2.4" xref="S3.SS1.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml">C</mi><mi id="S3.SS1.p1.2.m2.3.3.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.3b"><list id="S3.SS1.p1.2.m2.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2"><apply id="S3.SS1.p1.2.m2.2.2.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.2">𝐶</ci><cn type="integer" id="S3.SS1.p1.2.m2.2.2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci><apply id="S3.SS1.p1.2.m2.3.3.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">𝐶</ci><ci id="S3.SS1.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.3">𝑚</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.3c">C_{1},...,C_{m}</annotation></semantics></math>), where <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">C</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝐶</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">C_{i}</annotation></semantics></math> has a local dataset <math id="S3.SS1.p1.4.m4.2" class="ltx_Math" alttext="\mathcal{D}_{i}={\{(x_{j},y_{j})\}}^{N^{(i)}}_{j=1}" display="inline"><semantics id="S3.SS1.p1.4.m4.2a"><mrow id="S3.SS1.p1.4.m4.2.2" xref="S3.SS1.p1.4.m4.2.2.cmml"><msub id="S3.SS1.p1.4.m4.2.2.3" xref="S3.SS1.p1.4.m4.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.2.2.3.2" xref="S3.SS1.p1.4.m4.2.2.3.2.cmml">𝒟</mi><mi id="S3.SS1.p1.4.m4.2.2.3.3" xref="S3.SS1.p1.4.m4.2.2.3.3.cmml">i</mi></msub><mo id="S3.SS1.p1.4.m4.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.cmml">=</mo><msubsup id="S3.SS1.p1.4.m4.2.2.1" xref="S3.SS1.p1.4.m4.2.2.1.cmml"><mrow id="S3.SS1.p1.4.m4.2.2.1.1.1.1" xref="S3.SS1.p1.4.m4.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.2.2.1.1.1.1.2" xref="S3.SS1.p1.4.m4.2.2.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.3" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.4" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.5" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p1.4.m4.2.2.1.1.1.1.3" xref="S3.SS1.p1.4.m4.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.4.m4.2.2.1.3" xref="S3.SS1.p1.4.m4.2.2.1.3.cmml"><mi id="S3.SS1.p1.4.m4.2.2.1.3.2" xref="S3.SS1.p1.4.m4.2.2.1.3.2.cmml">j</mi><mo id="S3.SS1.p1.4.m4.2.2.1.3.1" xref="S3.SS1.p1.4.m4.2.2.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.4.m4.2.2.1.3.3" xref="S3.SS1.p1.4.m4.2.2.1.3.3.cmml">1</mn></mrow><msup id="S3.SS1.p1.4.m4.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.3.cmml">N</mi><mrow id="S3.SS1.p1.4.m4.1.1.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.1.1.1.1.1.3.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml">(</mo><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS1.p1.4.m4.1.1.1.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.1.cmml">)</mo></mrow></msup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.2b"><apply id="S3.SS1.p1.4.m4.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2"><eq id="S3.SS1.p1.4.m4.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2"></eq><apply id="S3.SS1.p1.4.m4.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.3.1.cmml" xref="S3.SS1.p1.4.m4.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.3.2.cmml" xref="S3.SS1.p1.4.m4.2.2.3.2">𝒟</ci><ci id="S3.SS1.p1.4.m4.2.2.3.3.cmml" xref="S3.SS1.p1.4.m4.2.2.3.3">𝑖</ci></apply><apply id="S3.SS1.p1.4.m4.2.2.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.1.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1">subscript</csymbol><apply id="S3.SS1.p1.4.m4.2.2.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.1.1.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1">superscript</csymbol><set id="S3.SS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1"><interval closure="open" id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2"><apply id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval></set><apply id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.3">𝑁</ci><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="S3.SS1.p1.4.m4.2.2.1.3.cmml" xref="S3.SS1.p1.4.m4.2.2.1.3"><eq id="S3.SS1.p1.4.m4.2.2.1.3.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.3.1"></eq><ci id="S3.SS1.p1.4.m4.2.2.1.3.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1.3.2">𝑗</ci><cn type="integer" id="S3.SS1.p1.4.m4.2.2.1.3.3.cmml" xref="S3.SS1.p1.4.m4.2.2.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.2c">\mathcal{D}_{i}={\{(x_{j},y_{j})\}}^{N^{(i)}}_{j=1}</annotation></semantics></math>, where <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="x_{j}\in\mathbb{R}^{P}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><msub id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.2" xref="S3.SS1.p1.5.m5.1.1.2.2.cmml">x</mi><mi id="S3.SS1.p1.5.m5.1.1.2.3" xref="S3.SS1.p1.5.m5.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml">P</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><in id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"></in><apply id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2">𝑥</ci><ci id="S3.SS1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3">𝑗</ci></apply><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">ℝ</ci><ci id="S3.SS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">x_{j}\in\mathbb{R}^{P}</annotation></semantics></math> is the <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">P</annotation></semantics></math>-dimensional feature vector of a sample, <math id="S3.SS1.p1.7.m7.4" class="ltx_Math" alttext="y_{j}\in{1,2,...,K}" display="inline"><semantics id="S3.SS1.p1.7.m7.4a"><mrow id="S3.SS1.p1.7.m7.4.5" xref="S3.SS1.p1.7.m7.4.5.cmml"><msub id="S3.SS1.p1.7.m7.4.5.2" xref="S3.SS1.p1.7.m7.4.5.2.cmml"><mi id="S3.SS1.p1.7.m7.4.5.2.2" xref="S3.SS1.p1.7.m7.4.5.2.2.cmml">y</mi><mi id="S3.SS1.p1.7.m7.4.5.2.3" xref="S3.SS1.p1.7.m7.4.5.2.3.cmml">j</mi></msub><mo id="S3.SS1.p1.7.m7.4.5.1" xref="S3.SS1.p1.7.m7.4.5.1.cmml">∈</mo><mrow id="S3.SS1.p1.7.m7.4.5.3.2" xref="S3.SS1.p1.7.m7.4.5.3.1.cmml"><mn id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">1</mn><mo id="S3.SS1.p1.7.m7.4.5.3.2.1" xref="S3.SS1.p1.7.m7.4.5.3.1.cmml">,</mo><mn id="S3.SS1.p1.7.m7.2.2" xref="S3.SS1.p1.7.m7.2.2.cmml">2</mn><mo id="S3.SS1.p1.7.m7.4.5.3.2.2" xref="S3.SS1.p1.7.m7.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.7.m7.3.3" xref="S3.SS1.p1.7.m7.3.3.cmml">…</mi><mo id="S3.SS1.p1.7.m7.4.5.3.2.3" xref="S3.SS1.p1.7.m7.4.5.3.1.cmml">,</mo><mi id="S3.SS1.p1.7.m7.4.4" xref="S3.SS1.p1.7.m7.4.4.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.4b"><apply id="S3.SS1.p1.7.m7.4.5.cmml" xref="S3.SS1.p1.7.m7.4.5"><in id="S3.SS1.p1.7.m7.4.5.1.cmml" xref="S3.SS1.p1.7.m7.4.5.1"></in><apply id="S3.SS1.p1.7.m7.4.5.2.cmml" xref="S3.SS1.p1.7.m7.4.5.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.4.5.2.1.cmml" xref="S3.SS1.p1.7.m7.4.5.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.4.5.2.2.cmml" xref="S3.SS1.p1.7.m7.4.5.2.2">𝑦</ci><ci id="S3.SS1.p1.7.m7.4.5.2.3.cmml" xref="S3.SS1.p1.7.m7.4.5.2.3">𝑗</ci></apply><list id="S3.SS1.p1.7.m7.4.5.3.1.cmml" xref="S3.SS1.p1.7.m7.4.5.3.2"><cn type="integer" id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">1</cn><cn type="integer" id="S3.SS1.p1.7.m7.2.2.cmml" xref="S3.SS1.p1.7.m7.2.2">2</cn><ci id="S3.SS1.p1.7.m7.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3">…</ci><ci id="S3.SS1.p1.7.m7.4.4.cmml" xref="S3.SS1.p1.7.m7.4.4">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.4c">y_{j}\in{1,2,...,K}</annotation></semantics></math> (a multi-classification learning task) is the corresponding label of <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="x_{j}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝑥</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">x_{j}</annotation></semantics></math>, and <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="N^{(i)}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><msup id="S3.SS1.p1.9.m9.1.2" xref="S3.SS1.p1.9.m9.1.2.cmml"><mi id="S3.SS1.p1.9.m9.1.2.2" xref="S3.SS1.p1.9.m9.1.2.2.cmml">N</mi><mrow id="S3.SS1.p1.9.m9.1.1.1.3" xref="S3.SS1.p1.9.m9.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.9.m9.1.1.1.3.1" xref="S3.SS1.p1.9.m9.1.2.cmml">(</mo><mi id="S3.SS1.p1.9.m9.1.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS1.p1.9.m9.1.1.1.3.2" xref="S3.SS1.p1.9.m9.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.2.cmml" xref="S3.SS1.p1.9.m9.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.2.1.cmml" xref="S3.SS1.p1.9.m9.1.2">superscript</csymbol><ci id="S3.SS1.p1.9.m9.1.2.2.cmml" xref="S3.SS1.p1.9.m9.1.2.2">𝑁</ci><ci id="S3.SS1.p1.9.m9.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">N^{(i)}</annotation></semantics></math> is the sample number in dataset <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><msub id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝒟</ci><ci id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">\mathcal{D}_{i}</annotation></semantics></math>.
Our goal is to learn a machine learning model <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">w</annotation></semantics></math> over the dataset
<math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{D}\triangleq\bigcup_{i\in|N|}\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><mrow id="S3.SS1.p1.12.m12.1.2" xref="S3.SS1.p1.12.m12.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m12.1.2.2" xref="S3.SS1.p1.12.m12.1.2.2.cmml">𝒟</mi><mo rspace="0.111em" id="S3.SS1.p1.12.m12.1.2.1" xref="S3.SS1.p1.12.m12.1.2.1.cmml">≜</mo><mrow id="S3.SS1.p1.12.m12.1.2.3" xref="S3.SS1.p1.12.m12.1.2.3.cmml"><msub id="S3.SS1.p1.12.m12.1.2.3.1" xref="S3.SS1.p1.12.m12.1.2.3.1.cmml"><mo id="S3.SS1.p1.12.m12.1.2.3.1.2" xref="S3.SS1.p1.12.m12.1.2.3.1.2.cmml">⋃</mo><mrow id="S3.SS1.p1.12.m12.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.1.3" xref="S3.SS1.p1.12.m12.1.1.1.3.cmml">i</mi><mo id="S3.SS1.p1.12.m12.1.1.1.2" xref="S3.SS1.p1.12.m12.1.1.1.2.cmml">∈</mo><mrow id="S3.SS1.p1.12.m12.1.1.1.4.2" xref="S3.SS1.p1.12.m12.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.SS1.p1.12.m12.1.1.1.4.2.1" xref="S3.SS1.p1.12.m12.1.1.1.4.1.1.cmml">|</mo><mi id="S3.SS1.p1.12.m12.1.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.1.cmml">N</mi><mo stretchy="false" id="S3.SS1.p1.12.m12.1.1.1.4.2.2" xref="S3.SS1.p1.12.m12.1.1.1.4.1.1.cmml">|</mo></mrow></mrow></msub><msub id="S3.SS1.p1.12.m12.1.2.3.2" xref="S3.SS1.p1.12.m12.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m12.1.2.3.2.2" xref="S3.SS1.p1.12.m12.1.2.3.2.2.cmml">𝒟</mi><mi id="S3.SS1.p1.12.m12.1.2.3.2.3" xref="S3.SS1.p1.12.m12.1.2.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.2.cmml" xref="S3.SS1.p1.12.m12.1.2"><ci id="S3.SS1.p1.12.m12.1.2.1.cmml" xref="S3.SS1.p1.12.m12.1.2.1">≜</ci><ci id="S3.SS1.p1.12.m12.1.2.2.cmml" xref="S3.SS1.p1.12.m12.1.2.2">𝒟</ci><apply id="S3.SS1.p1.12.m12.1.2.3.cmml" xref="S3.SS1.p1.12.m12.1.2.3"><apply id="S3.SS1.p1.12.m12.1.2.3.1.cmml" xref="S3.SS1.p1.12.m12.1.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.2.3.1.1.cmml" xref="S3.SS1.p1.12.m12.1.2.3.1">subscript</csymbol><union id="S3.SS1.p1.12.m12.1.2.3.1.2.cmml" xref="S3.SS1.p1.12.m12.1.2.3.1.2"></union><apply id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1"><in id="S3.SS1.p1.12.m12.1.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.1.2"></in><ci id="S3.SS1.p1.12.m12.1.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.1.3">𝑖</ci><apply id="S3.SS1.p1.12.m12.1.1.1.4.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1.4.2"><abs id="S3.SS1.p1.12.m12.1.1.1.4.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1.4.2.1"></abs><ci id="S3.SS1.p1.12.m12.1.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1">𝑁</ci></apply></apply></apply><apply id="S3.SS1.p1.12.m12.1.2.3.2.cmml" xref="S3.SS1.p1.12.m12.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.2.3.2.1.cmml" xref="S3.SS1.p1.12.m12.1.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.2.3.2.2.cmml" xref="S3.SS1.p1.12.m12.1.2.3.2.2">𝒟</ci><ci id="S3.SS1.p1.12.m12.1.2.3.2.3.cmml" xref="S3.SS1.p1.12.m12.1.2.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">\mathcal{D}\triangleq\bigcup_{i\in|N|}\mathcal{D}_{i}</annotation></semantics></math> with the help of a central server, while the raw data are not exchanged. The objective is to solve</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="\mathop{\arg\min}\limits_{w}\mathcal{L}(w)=\sum_{i=1}^{N}\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}L_{i}(w)" display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.5" xref="S3.E1.m1.4.5.cmml"><mrow id="S3.E1.m1.4.5.2" xref="S3.E1.m1.4.5.2.cmml"><munder id="S3.E1.m1.4.5.2.1" xref="S3.E1.m1.4.5.2.1.cmml"><mrow id="S3.E1.m1.4.5.2.1.2" xref="S3.E1.m1.4.5.2.1.2.cmml"><mi id="S3.E1.m1.4.5.2.1.2.1" xref="S3.E1.m1.4.5.2.1.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E1.m1.4.5.2.1.2a" xref="S3.E1.m1.4.5.2.1.2.cmml">⁡</mo><mi id="S3.E1.m1.4.5.2.1.2.2" xref="S3.E1.m1.4.5.2.1.2.2.cmml">min</mi></mrow><mi id="S3.E1.m1.4.5.2.1.3" xref="S3.E1.m1.4.5.2.1.3.cmml">w</mi></munder><mrow id="S3.E1.m1.4.5.2.2" xref="S3.E1.m1.4.5.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.5.2.2.2" xref="S3.E1.m1.4.5.2.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.5.2.2.1" xref="S3.E1.m1.4.5.2.2.1.cmml">​</mo><mrow id="S3.E1.m1.4.5.2.2.3.2" xref="S3.E1.m1.4.5.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.4.5.2.2.3.2.1" xref="S3.E1.m1.4.5.2.2.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">w</mi><mo stretchy="false" id="S3.E1.m1.4.5.2.2.3.2.2" xref="S3.E1.m1.4.5.2.2.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.111em" id="S3.E1.m1.4.5.1" xref="S3.E1.m1.4.5.1.cmml">=</mo><mrow id="S3.E1.m1.4.5.3" xref="S3.E1.m1.4.5.3.cmml"><munderover id="S3.E1.m1.4.5.3.1" xref="S3.E1.m1.4.5.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.4.5.3.1.2.2" xref="S3.E1.m1.4.5.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.4.5.3.1.2.3" xref="S3.E1.m1.4.5.3.1.2.3.cmml"><mi id="S3.E1.m1.4.5.3.1.2.3.2" xref="S3.E1.m1.4.5.3.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.4.5.3.1.2.3.1" xref="S3.E1.m1.4.5.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.4.5.3.1.2.3.3" xref="S3.E1.m1.4.5.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.4.5.3.1.3" xref="S3.E1.m1.4.5.3.1.3.cmml">N</mi></munderover><mrow id="S3.E1.m1.4.5.3.2" xref="S3.E1.m1.4.5.3.2.cmml"><mfrac id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.3.1" xref="S3.E1.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.2.1" xref="S3.E1.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E1.m1.2.2.2.3.2" xref="S3.E1.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.5.3.2.1" xref="S3.E1.m1.4.5.3.2.1.cmml">​</mo><msub id="S3.E1.m1.4.5.3.2.2" xref="S3.E1.m1.4.5.3.2.2.cmml"><mi id="S3.E1.m1.4.5.3.2.2.2" xref="S3.E1.m1.4.5.3.2.2.2.cmml">L</mi><mi id="S3.E1.m1.4.5.3.2.2.3" xref="S3.E1.m1.4.5.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.5.3.2.1a" xref="S3.E1.m1.4.5.3.2.1.cmml">​</mo><mrow id="S3.E1.m1.4.5.3.2.3.2" xref="S3.E1.m1.4.5.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.4.5.3.2.3.2.1" xref="S3.E1.m1.4.5.3.2.cmml">(</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">w</mi><mo stretchy="false" id="S3.E1.m1.4.5.3.2.3.2.2" xref="S3.E1.m1.4.5.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.5.cmml" xref="S3.E1.m1.4.5"><eq id="S3.E1.m1.4.5.1.cmml" xref="S3.E1.m1.4.5.1"></eq><apply id="S3.E1.m1.4.5.2.cmml" xref="S3.E1.m1.4.5.2"><apply id="S3.E1.m1.4.5.2.1.cmml" xref="S3.E1.m1.4.5.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.5.2.1.1.cmml" xref="S3.E1.m1.4.5.2.1">subscript</csymbol><apply id="S3.E1.m1.4.5.2.1.2.cmml" xref="S3.E1.m1.4.5.2.1.2"><arg id="S3.E1.m1.4.5.2.1.2.1.cmml" xref="S3.E1.m1.4.5.2.1.2.1"></arg><min id="S3.E1.m1.4.5.2.1.2.2.cmml" xref="S3.E1.m1.4.5.2.1.2.2"></min></apply><ci id="S3.E1.m1.4.5.2.1.3.cmml" xref="S3.E1.m1.4.5.2.1.3">𝑤</ci></apply><apply id="S3.E1.m1.4.5.2.2.cmml" xref="S3.E1.m1.4.5.2.2"><times id="S3.E1.m1.4.5.2.2.1.cmml" xref="S3.E1.m1.4.5.2.2.1"></times><ci id="S3.E1.m1.4.5.2.2.2.cmml" xref="S3.E1.m1.4.5.2.2.2">ℒ</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑤</ci></apply></apply><apply id="S3.E1.m1.4.5.3.cmml" xref="S3.E1.m1.4.5.3"><apply id="S3.E1.m1.4.5.3.1.cmml" xref="S3.E1.m1.4.5.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.5.3.1.1.cmml" xref="S3.E1.m1.4.5.3.1">superscript</csymbol><apply id="S3.E1.m1.4.5.3.1.2.cmml" xref="S3.E1.m1.4.5.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.5.3.1.2.1.cmml" xref="S3.E1.m1.4.5.3.1">subscript</csymbol><sum id="S3.E1.m1.4.5.3.1.2.2.cmml" xref="S3.E1.m1.4.5.3.1.2.2"></sum><apply id="S3.E1.m1.4.5.3.1.2.3.cmml" xref="S3.E1.m1.4.5.3.1.2.3"><eq id="S3.E1.m1.4.5.3.1.2.3.1.cmml" xref="S3.E1.m1.4.5.3.1.2.3.1"></eq><ci id="S3.E1.m1.4.5.3.1.2.3.2.cmml" xref="S3.E1.m1.4.5.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.4.5.3.1.2.3.3.cmml" xref="S3.E1.m1.4.5.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.4.5.3.1.3.cmml" xref="S3.E1.m1.4.5.3.1.3">𝑁</ci></apply><apply id="S3.E1.m1.4.5.3.2.cmml" xref="S3.E1.m1.4.5.3.2"><times id="S3.E1.m1.4.5.3.2.1.cmml" xref="S3.E1.m1.4.5.3.2.1"></times><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><divide id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2"></divide><apply id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1"><abs id="S3.E1.m1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2"></abs><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.3"><abs id="S3.E1.m1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.3.1"></abs><ci id="S3.E1.m1.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="S3.E1.m1.4.5.3.2.2.cmml" xref="S3.E1.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.5.3.2.2.1.cmml" xref="S3.E1.m1.4.5.3.2.2">subscript</csymbol><ci id="S3.E1.m1.4.5.3.2.2.2.cmml" xref="S3.E1.m1.4.5.3.2.2.2">𝐿</ci><ci id="S3.E1.m1.4.5.3.2.2.3.cmml" xref="S3.E1.m1.4.5.3.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\mathop{\arg\min}\limits_{w}\mathcal{L}(w)=\sum_{i=1}^{N}\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}L_{i}(w)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.3" class="ltx_p">where <math id="S3.SS1.p2.1.m1.7" class="ltx_Math" alttext="L_{i}(w)=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}[\ell_{i}(w;(x,y))]" display="inline"><semantics id="S3.SS1.p2.1.m1.7a"><mrow id="S3.SS1.p2.1.m1.7.7" xref="S3.SS1.p2.1.m1.7.7.cmml"><mrow id="S3.SS1.p2.1.m1.7.7.3" xref="S3.SS1.p2.1.m1.7.7.3.cmml"><msub id="S3.SS1.p2.1.m1.7.7.3.2" xref="S3.SS1.p2.1.m1.7.7.3.2.cmml"><mi id="S3.SS1.p2.1.m1.7.7.3.2.2" xref="S3.SS1.p2.1.m1.7.7.3.2.2.cmml">L</mi><mi id="S3.SS1.p2.1.m1.7.7.3.2.3" xref="S3.SS1.p2.1.m1.7.7.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.7.7.3.1" xref="S3.SS1.p2.1.m1.7.7.3.1.cmml">​</mo><mrow id="S3.SS1.p2.1.m1.7.7.3.3.2" xref="S3.SS1.p2.1.m1.7.7.3.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.7.7.3.3.2.1" xref="S3.SS1.p2.1.m1.7.7.3.cmml">(</mo><mi id="S3.SS1.p2.1.m1.3.3" xref="S3.SS1.p2.1.m1.3.3.cmml">w</mi><mo stretchy="false" id="S3.SS1.p2.1.m1.7.7.3.3.2.2" xref="S3.SS1.p2.1.m1.7.7.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.1.m1.7.7.2" xref="S3.SS1.p2.1.m1.7.7.2.cmml">=</mo><mrow id="S3.SS1.p2.1.m1.7.7.1" xref="S3.SS1.p2.1.m1.7.7.1.cmml"><msub id="S3.SS1.p2.1.m1.7.7.1.3" xref="S3.SS1.p2.1.m1.7.7.1.3.cmml"><mi id="S3.SS1.p2.1.m1.7.7.1.3.2" xref="S3.SS1.p2.1.m1.7.7.1.3.2.cmml">𝔼</mi><mrow id="S3.SS1.p2.1.m1.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.cmml"><mrow id="S3.SS1.p2.1.m1.2.2.2.4.2" xref="S3.SS1.p2.1.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.2.2.2.4.2.1" xref="S3.SS1.p2.1.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.SS1.p2.1.m1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.cmml">x</mi><mo id="S3.SS1.p2.1.m1.2.2.2.4.2.2" xref="S3.SS1.p2.1.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.SS1.p2.1.m1.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p2.1.m1.2.2.2.4.2.3" xref="S3.SS1.p2.1.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.SS1.p2.1.m1.2.2.2.3" xref="S3.SS1.p2.1.m1.2.2.2.3.cmml">∼</mo><msub id="S3.SS1.p2.1.m1.2.2.2.5" xref="S3.SS1.p2.1.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.2.2.2.5.2" xref="S3.SS1.p2.1.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.SS1.p2.1.m1.2.2.2.5.3" xref="S3.SS1.p2.1.m1.2.2.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.7.7.1.2" xref="S3.SS1.p2.1.m1.7.7.1.2.cmml">​</mo><mrow id="S3.SS1.p2.1.m1.7.7.1.1.1" xref="S3.SS1.p2.1.m1.7.7.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.7.7.1.1.1.2" xref="S3.SS1.p2.1.m1.7.7.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p2.1.m1.7.7.1.1.1.1" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.cmml"><msub id="S3.SS1.p2.1.m1.7.7.1.1.1.1.3" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.SS1.p2.1.m1.7.7.1.1.1.1.3.2" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.3.2.cmml">ℓ</mi><mi id="S3.SS1.p2.1.m1.7.7.1.1.1.1.3.3" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.7.7.1.1.1.1.2" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS1.p2.1.m1.6.6" xref="S3.SS1.p2.1.m1.6.6.cmml">w</mi><mo id="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.2.cmml">;</mo><mrow id="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.1.2.1" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p2.1.m1.4.4" xref="S3.SS1.p2.1.m1.4.4.cmml">x</mi><mo id="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.1.1.cmml">,</mo><mi id="S3.SS1.p2.1.m1.5.5" xref="S3.SS1.p2.1.m1.5.5.cmml">y</mi><mo stretchy="false" id="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.4" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS1.p2.1.m1.7.7.1.1.1.3" xref="S3.SS1.p2.1.m1.7.7.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.7b"><apply id="S3.SS1.p2.1.m1.7.7.cmml" xref="S3.SS1.p2.1.m1.7.7"><eq id="S3.SS1.p2.1.m1.7.7.2.cmml" xref="S3.SS1.p2.1.m1.7.7.2"></eq><apply id="S3.SS1.p2.1.m1.7.7.3.cmml" xref="S3.SS1.p2.1.m1.7.7.3"><times id="S3.SS1.p2.1.m1.7.7.3.1.cmml" xref="S3.SS1.p2.1.m1.7.7.3.1"></times><apply id="S3.SS1.p2.1.m1.7.7.3.2.cmml" xref="S3.SS1.p2.1.m1.7.7.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.7.7.3.2.1.cmml" xref="S3.SS1.p2.1.m1.7.7.3.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.7.7.3.2.2.cmml" xref="S3.SS1.p2.1.m1.7.7.3.2.2">𝐿</ci><ci id="S3.SS1.p2.1.m1.7.7.3.2.3.cmml" xref="S3.SS1.p2.1.m1.7.7.3.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.1.m1.3.3.cmml" xref="S3.SS1.p2.1.m1.3.3">𝑤</ci></apply><apply id="S3.SS1.p2.1.m1.7.7.1.cmml" xref="S3.SS1.p2.1.m1.7.7.1"><times id="S3.SS1.p2.1.m1.7.7.1.2.cmml" xref="S3.SS1.p2.1.m1.7.7.1.2"></times><apply id="S3.SS1.p2.1.m1.7.7.1.3.cmml" xref="S3.SS1.p2.1.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.7.7.1.3.1.cmml" xref="S3.SS1.p2.1.m1.7.7.1.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.7.7.1.3.2.cmml" xref="S3.SS1.p2.1.m1.7.7.1.3.2">𝔼</ci><apply id="S3.SS1.p2.1.m1.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2"><csymbol cd="latexml" id="S3.SS1.p2.1.m1.2.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.SS1.p2.1.m1.2.2.2.4.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.4.2"><ci id="S3.SS1.p2.1.m1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1">𝑥</ci><ci id="S3.SS1.p2.1.m1.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.SS1.p2.1.m1.2.2.2.5.cmml" xref="S3.SS1.p2.1.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.2.2.5.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.5">subscript</csymbol><ci id="S3.SS1.p2.1.m1.2.2.2.5.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.5.2">𝒟</ci><ci id="S3.SS1.p2.1.m1.2.2.2.5.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.SS1.p2.1.m1.7.7.1.1.2.cmml" xref="S3.SS1.p2.1.m1.7.7.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.1.m1.7.7.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.7.7.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p2.1.m1.7.7.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1"><times id="S3.SS1.p2.1.m1.7.7.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.2"></times><apply id="S3.SS1.p2.1.m1.7.7.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.7.7.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.7.7.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.3.2">ℓ</ci><ci id="S3.SS1.p2.1.m1.7.7.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.3.3">𝑖</ci></apply><list id="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1"><ci id="S3.SS1.p2.1.m1.6.6.cmml" xref="S3.SS1.p2.1.m1.6.6">𝑤</ci><interval closure="open" id="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.7.7.1.1.1.1.1.1.1.2"><ci id="S3.SS1.p2.1.m1.4.4.cmml" xref="S3.SS1.p2.1.m1.4.4">𝑥</ci><ci id="S3.SS1.p2.1.m1.5.5.cmml" xref="S3.SS1.p2.1.m1.5.5">𝑦</ci></interval></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.7c">L_{i}(w)=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}[\ell_{i}(w;(x,y))]</annotation></semantics></math> is the empirical loss of <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">C</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝐶</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">C_{i}</annotation></semantics></math>, and <math id="S3.SS1.p2.3.m3.4" class="ltx_Math" alttext="\ell_{i}(w;(x,y))" display="inline"><semantics id="S3.SS1.p2.3.m3.4a"><mrow id="S3.SS1.p2.3.m3.4.4" xref="S3.SS1.p2.3.m3.4.4.cmml"><msub id="S3.SS1.p2.3.m3.4.4.3" xref="S3.SS1.p2.3.m3.4.4.3.cmml"><mi mathvariant="normal" id="S3.SS1.p2.3.m3.4.4.3.2" xref="S3.SS1.p2.3.m3.4.4.3.2.cmml">ℓ</mi><mi id="S3.SS1.p2.3.m3.4.4.3.3" xref="S3.SS1.p2.3.m3.4.4.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.3.m3.4.4.2" xref="S3.SS1.p2.3.m3.4.4.2.cmml">​</mo><mrow id="S3.SS1.p2.3.m3.4.4.1.1" xref="S3.SS1.p2.3.m3.4.4.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.4.4.1.1.2" xref="S3.SS1.p2.3.m3.4.4.1.2.cmml">(</mo><mi id="S3.SS1.p2.3.m3.3.3" xref="S3.SS1.p2.3.m3.3.3.cmml">w</mi><mo id="S3.SS1.p2.3.m3.4.4.1.1.3" xref="S3.SS1.p2.3.m3.4.4.1.2.cmml">;</mo><mrow id="S3.SS1.p2.3.m3.4.4.1.1.1.2" xref="S3.SS1.p2.3.m3.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.4.4.1.1.1.2.1" xref="S3.SS1.p2.3.m3.4.4.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">x</mi><mo id="S3.SS1.p2.3.m3.4.4.1.1.1.2.2" xref="S3.SS1.p2.3.m3.4.4.1.1.1.1.cmml">,</mo><mi id="S3.SS1.p2.3.m3.2.2" xref="S3.SS1.p2.3.m3.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p2.3.m3.4.4.1.1.1.2.3" xref="S3.SS1.p2.3.m3.4.4.1.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p2.3.m3.4.4.1.1.4" xref="S3.SS1.p2.3.m3.4.4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.4b"><apply id="S3.SS1.p2.3.m3.4.4.cmml" xref="S3.SS1.p2.3.m3.4.4"><times id="S3.SS1.p2.3.m3.4.4.2.cmml" xref="S3.SS1.p2.3.m3.4.4.2"></times><apply id="S3.SS1.p2.3.m3.4.4.3.cmml" xref="S3.SS1.p2.3.m3.4.4.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.4.4.3.1.cmml" xref="S3.SS1.p2.3.m3.4.4.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.4.4.3.2.cmml" xref="S3.SS1.p2.3.m3.4.4.3.2">ℓ</ci><ci id="S3.SS1.p2.3.m3.4.4.3.3.cmml" xref="S3.SS1.p2.3.m3.4.4.3.3">𝑖</ci></apply><list id="S3.SS1.p2.3.m3.4.4.1.2.cmml" xref="S3.SS1.p2.3.m3.4.4.1.1"><ci id="S3.SS1.p2.3.m3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3">𝑤</ci><interval closure="open" id="S3.SS1.p2.3.m3.4.4.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.4.4.1.1.1.2"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑥</ci><ci id="S3.SS1.p2.3.m3.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2">𝑦</ci></interval></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.4c">\ell_{i}(w;(x,y))</annotation></semantics></math> is the
loss function.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Motivation</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">We now discuss the observations that motivate the correction of local training.
We begin by investigating the feature distribution of hidden layers of local network architecture during the training.
For that, we give a baseline approach named SOLO, where each client trains a model only by inputting its local data without federated learning. Specifically, we use SOLO to train models based on the different clients’ local data that are both the skewed subsets of CIRFAR-10. Then, we use t-SNE <cite class="ltx_cite ltx_citemacro_citep">(van der Maaten and Hinton <a href="#bib.bib33" title="" class="ltx_ref">2008</a>)</cite> to visualize the hidden layers’ features of these local data from two different clients <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="C_{1}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">C</mi><mn id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝐶</ci><cn type="integer" id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">C_{1}</annotation></semantics></math> and <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="C_{2}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">C</mi><mn id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝐶</ci><cn type="integer" id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">C_{2}</annotation></semantics></math>, as shown in Figure <a href="#S2.F2.sf1" title="In Figure 2 ‣ 2.2 Contrastive Learning ‣ 2 Background and Related Work ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a> and Figure <a href="#S2.F2.sf2" title="In Figure 2 ‣ 2.2 Contrastive Learning ‣ 2 Background and Related Work ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(b)</span></a>.
We observe that the feature distributions of images from two clients are quite different in terms of the cluster center and clustering degrees, as well as highly different from the global distribution shown in Figure <a href="#S2.F2.sf3" title="In Figure 2 ‣ 2.2 Contrastive Learning ‣ 2 Background and Related Work ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(c)</span></a>.
As a result, the local objective of each client is inconsistent with the global optima, which can influence the accuracy of federated learning a lot.
</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.4" class="ltx_p">FedProc tackles the above problem based on an intuitive idea: the prototypes can serve as global knowledge to correct the local training in federated learning. This idea enables the clients to pull the samples from the same class toward the global prototype of its class and away from the global prototypes of other classes, thus making the local objective of each client consistent with the global optima. To demonstrate the efficacy of this idea, we run the FedProc on the above local data of clients <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="C_{1}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">C</mi><mn id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐶</ci><cn type="integer" id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">C_{1}</annotation></semantics></math> and <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="C_{2}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">C</mi><mn id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐶</ci><cn type="integer" id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">C_{2}</annotation></semantics></math>, and show the feature distributions of images in Figure <a href="#S2.F2.sf4" title="In Figure 2 ‣ 2.2 Contrastive Learning ‣ 2 Background and Related Work ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(d)</span></a> and Figure <a href="#S2.F2.sf5" title="In Figure 2 ‣ 2.2 Contrastive Learning ‣ 2 Background and Related Work ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(e)</span></a>.
We find that the points with the same class in the two clients are constrained to the same domain centered in the global class-prototype.
Moreover, the distribution of the points in clients <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="C_{1}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">C</mi><mn id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝐶</ci><cn type="integer" id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">C_{1}</annotation></semantics></math> and <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="C_{2}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">C</mi><mn id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝐶</ci><cn type="integer" id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">C_{2}</annotation></semantics></math> both match with the global distribution shown in Figure <a href="#S2.F2.sf3" title="In Figure 2 ‣ 2.2 Contrastive Learning ‣ 2 Background and Related Work ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(c)</span></a>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Method</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Using the above insight, we present FedProc, a simple and effective FL framework based on FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite>.
Our main changes happen in the local training phase, where the local network architecture and the loss function are carefully designed for learning better representations, which boosts the classification performance of the local network. The overall federated learning algorithm is shown in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Local Network Architecture ‣ 3.3 Method ‣ 3 Prototypical Contrastive Federated Learning ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. In the following, we present the local network architecture, the local objectives, and global prototypical contrastive loss.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2109.12273/assets/x7.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="530" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Overview of the local network architecture in FedProc. The feature extraction network (including the base encoder and the projection head) extracts the representation <math id="S3.F3.8.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.F3.8.m1.1b"><mi id="S3.F3.8.m1.1.1" xref="S3.F3.8.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.F3.8.m1.1c"><ci id="S3.F3.8.m1.1.1.cmml" xref="S3.F3.8.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.8.m1.1d">z</annotation></semantics></math>, which is used to calculate the global prototypical contrastive loss <math id="S3.F3.9.m2.1" class="ltx_Math" alttext="\ell_{gpc}" display="inline"><semantics id="S3.F3.9.m2.1b"><msub id="S3.F3.9.m2.1.1" xref="S3.F3.9.m2.1.1.cmml"><mi mathvariant="normal" id="S3.F3.9.m2.1.1.2" xref="S3.F3.9.m2.1.1.2.cmml">ℓ</mi><mrow id="S3.F3.9.m2.1.1.3" xref="S3.F3.9.m2.1.1.3.cmml"><mi id="S3.F3.9.m2.1.1.3.2" xref="S3.F3.9.m2.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.F3.9.m2.1.1.3.1" xref="S3.F3.9.m2.1.1.3.1.cmml">​</mo><mi id="S3.F3.9.m2.1.1.3.3" xref="S3.F3.9.m2.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.F3.9.m2.1.1.3.1b" xref="S3.F3.9.m2.1.1.3.1.cmml">​</mo><mi id="S3.F3.9.m2.1.1.3.4" xref="S3.F3.9.m2.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F3.9.m2.1c"><apply id="S3.F3.9.m2.1.1.cmml" xref="S3.F3.9.m2.1.1"><csymbol cd="ambiguous" id="S3.F3.9.m2.1.1.1.cmml" xref="S3.F3.9.m2.1.1">subscript</csymbol><ci id="S3.F3.9.m2.1.1.2.cmml" xref="S3.F3.9.m2.1.1.2">ℓ</ci><apply id="S3.F3.9.m2.1.1.3.cmml" xref="S3.F3.9.m2.1.1.3"><times id="S3.F3.9.m2.1.1.3.1.cmml" xref="S3.F3.9.m2.1.1.3.1"></times><ci id="S3.F3.9.m2.1.1.3.2.cmml" xref="S3.F3.9.m2.1.1.3.2">𝑔</ci><ci id="S3.F3.9.m2.1.1.3.3.cmml" xref="S3.F3.9.m2.1.1.3.3">𝑝</ci><ci id="S3.F3.9.m2.1.1.3.4.cmml" xref="S3.F3.9.m2.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.9.m2.1d">\ell_{gpc}</annotation></semantics></math>.
By inputting the representation <math id="S3.F3.10.m3.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.F3.10.m3.1b"><mi id="S3.F3.10.m3.1.1" xref="S3.F3.10.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.F3.10.m3.1c"><ci id="S3.F3.10.m3.1.1.cmml" xref="S3.F3.10.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.10.m3.1d">z</annotation></semantics></math>, the output layer <math id="S3.F3.11.m4.1" class="ltx_Math" alttext="f_{c}(\cdot)" display="inline"><semantics id="S3.F3.11.m4.1b"><mrow id="S3.F3.11.m4.1.2" xref="S3.F3.11.m4.1.2.cmml"><msub id="S3.F3.11.m4.1.2.2" xref="S3.F3.11.m4.1.2.2.cmml"><mi id="S3.F3.11.m4.1.2.2.2" xref="S3.F3.11.m4.1.2.2.2.cmml">f</mi><mi id="S3.F3.11.m4.1.2.2.3" xref="S3.F3.11.m4.1.2.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.F3.11.m4.1.2.1" xref="S3.F3.11.m4.1.2.1.cmml">​</mo><mrow id="S3.F3.11.m4.1.2.3.2" xref="S3.F3.11.m4.1.2.cmml"><mo stretchy="false" id="S3.F3.11.m4.1.2.3.2.1" xref="S3.F3.11.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.F3.11.m4.1.1" xref="S3.F3.11.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.F3.11.m4.1.2.3.2.2" xref="S3.F3.11.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.11.m4.1c"><apply id="S3.F3.11.m4.1.2.cmml" xref="S3.F3.11.m4.1.2"><times id="S3.F3.11.m4.1.2.1.cmml" xref="S3.F3.11.m4.1.2.1"></times><apply id="S3.F3.11.m4.1.2.2.cmml" xref="S3.F3.11.m4.1.2.2"><csymbol cd="ambiguous" id="S3.F3.11.m4.1.2.2.1.cmml" xref="S3.F3.11.m4.1.2.2">subscript</csymbol><ci id="S3.F3.11.m4.1.2.2.2.cmml" xref="S3.F3.11.m4.1.2.2.2">𝑓</ci><ci id="S3.F3.11.m4.1.2.2.3.cmml" xref="S3.F3.11.m4.1.2.2.3">𝑐</ci></apply><ci id="S3.F3.11.m4.1.1.cmml" xref="S3.F3.11.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.11.m4.1d">f_{c}(\cdot)</annotation></semantics></math> predicts the class-wise logits <math id="S3.F3.12.m5.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.F3.12.m5.1b"><mi id="S3.F3.12.m5.1.1" xref="S3.F3.12.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.F3.12.m5.1c"><ci id="S3.F3.12.m5.1.1.cmml" xref="S3.F3.12.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.12.m5.1d">s</annotation></semantics></math>, which are used to compute the cross-entropy loss <math id="S3.F3.13.m6.1" class="ltx_Math" alttext="\ell_{ce}" display="inline"><semantics id="S3.F3.13.m6.1b"><msub id="S3.F3.13.m6.1.1" xref="S3.F3.13.m6.1.1.cmml"><mi mathvariant="normal" id="S3.F3.13.m6.1.1.2" xref="S3.F3.13.m6.1.1.2.cmml">ℓ</mi><mrow id="S3.F3.13.m6.1.1.3" xref="S3.F3.13.m6.1.1.3.cmml"><mi id="S3.F3.13.m6.1.1.3.2" xref="S3.F3.13.m6.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.F3.13.m6.1.1.3.1" xref="S3.F3.13.m6.1.1.3.1.cmml">​</mo><mi id="S3.F3.13.m6.1.1.3.3" xref="S3.F3.13.m6.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F3.13.m6.1c"><apply id="S3.F3.13.m6.1.1.cmml" xref="S3.F3.13.m6.1.1"><csymbol cd="ambiguous" id="S3.F3.13.m6.1.1.1.cmml" xref="S3.F3.13.m6.1.1">subscript</csymbol><ci id="S3.F3.13.m6.1.1.2.cmml" xref="S3.F3.13.m6.1.1.2">ℓ</ci><apply id="S3.F3.13.m6.1.1.3.cmml" xref="S3.F3.13.m6.1.1.3"><times id="S3.F3.13.m6.1.1.3.1.cmml" xref="S3.F3.13.m6.1.1.3.1"></times><ci id="S3.F3.13.m6.1.1.3.2.cmml" xref="S3.F3.13.m6.1.1.3.2">𝑐</ci><ci id="S3.F3.13.m6.1.1.3.3.cmml" xref="S3.F3.13.m6.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.13.m6.1d">\ell_{ce}</annotation></semantics></math>. A coefficient <math id="S3.F3.14.m7.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.F3.14.m7.1b"><mi id="S3.F3.14.m7.1.1" xref="S3.F3.14.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.F3.14.m7.1c"><ci id="S3.F3.14.m7.1.1.cmml" xref="S3.F3.14.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.14.m7.1d">\alpha</annotation></semantics></math> is introduced to adjust the weights of the two loss functions during the local training.</figcaption>
</figure>
<section id="S3.SS3.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_font_bold ltx_title_subsubsection">Local Network Architecture</h4>

<div id="S3.SS3.SSSx1.p1" class="ltx_para">
<p id="S3.SS3.SSSx1.p1.9" class="ltx_p">Figure <a href="#S3.F3" title="Figure 3 ‣ 3.3 Method ‣ 3 Prototypical Contrastive Federated Learning ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> describes the overview of the proposed local network architecture. The local network is comprised of three modules: a base encoder, a projection head, and an output layer. Firstly, the base encoder extracts representation <math id="S3.SS3.SSSx1.p1.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS3.SSSx1.p1.1.m1.1a"><mi id="S3.SS3.SSSx1.p1.1.m1.1.1" xref="S3.SS3.SSSx1.p1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.1.m1.1b"><ci id="S3.SS3.SSSx1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSSx1.p1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.1.m1.1c">r</annotation></semantics></math> from input <math id="S3.SS3.SSSx1.p1.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.SSSx1.p1.2.m2.1a"><mi id="S3.SS3.SSSx1.p1.2.m2.1.1" xref="S3.SS3.SSSx1.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.2.m2.1b"><ci id="S3.SS3.SSSx1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSSx1.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.2.m2.1c">x</annotation></semantics></math>. Then, the projection head maps the representation <math id="S3.SS3.SSSx1.p1.3.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS3.SSSx1.p1.3.m3.1a"><mi id="S3.SS3.SSSx1.p1.3.m3.1.1" xref="S3.SS3.SSSx1.p1.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.3.m3.1b"><ci id="S3.SS3.SSSx1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSSx1.p1.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.3.m3.1c">r</annotation></semantics></math> into a vector representation <math id="S3.SS3.SSSx1.p1.4.m4.1" class="ltx_Math" alttext="z\in\mathbb{R}^{Q}" display="inline"><semantics id="S3.SS3.SSSx1.p1.4.m4.1a"><mrow id="S3.SS3.SSSx1.p1.4.m4.1.1" xref="S3.SS3.SSSx1.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSSx1.p1.4.m4.1.1.2" xref="S3.SS3.SSSx1.p1.4.m4.1.1.2.cmml">z</mi><mo id="S3.SS3.SSSx1.p1.4.m4.1.1.1" xref="S3.SS3.SSSx1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSSx1.p1.4.m4.1.1.3" xref="S3.SS3.SSSx1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSSx1.p1.4.m4.1.1.3.2" xref="S3.SS3.SSSx1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSSx1.p1.4.m4.1.1.3.3" xref="S3.SS3.SSSx1.p1.4.m4.1.1.3.3.cmml">Q</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.4.m4.1b"><apply id="S3.SS3.SSSx1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSSx1.p1.4.m4.1.1"><in id="S3.SS3.SSSx1.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSSx1.p1.4.m4.1.1.1"></in><ci id="S3.SS3.SSSx1.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSSx1.p1.4.m4.1.1.2">𝑧</ci><apply id="S3.SS3.SSSx1.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSSx1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSSx1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.SSSx1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSSx1.p1.4.m4.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSSx1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSSx1.p1.4.m4.1.1.3.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.4.m4.1c">z\in\mathbb{R}^{Q}</annotation></semantics></math>, which is used to compute a global prototypical contrastive loss <math id="S3.SS3.SSSx1.p1.5.m5.1" class="ltx_Math" alttext="\ell_{gpc}" display="inline"><semantics id="S3.SS3.SSSx1.p1.5.m5.1a"><msub id="S3.SS3.SSSx1.p1.5.m5.1.1" xref="S3.SS3.SSSx1.p1.5.m5.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.SSSx1.p1.5.m5.1.1.2" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.SSSx1.p1.5.m5.1.1.3" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS3.SSSx1.p1.5.m5.1.1.3.2" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p1.5.m5.1.1.3.1" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.p1.5.m5.1.1.3.3" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p1.5.m5.1.1.3.1a" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.p1.5.m5.1.1.3.4" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.5.m5.1b"><apply id="S3.SS3.SSSx1.p1.5.m5.1.1.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2">ℓ</ci><apply id="S3.SS3.SSSx1.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3"><times id="S3.SS3.SSSx1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3.1"></times><ci id="S3.SS3.SSSx1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3.2">𝑔</ci><ci id="S3.SS3.SSSx1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3.3">𝑝</ci><ci id="S3.SS3.SSSx1.p1.5.m5.1.1.3.4.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.5.m5.1c">\ell_{gpc}</annotation></semantics></math> (will be illustrated in Eq. (<a href="#S3.E4" title="In Global Prototypical Contrastive Loss ‣ 3.3 Method ‣ 3 Prototypical Contrastive Federated Learning ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>)). Noth that, we use a multiple-layer perception (MLP) with one hidden layer to implement the projection head,
which is helpful in improving the representation ability of the layer before it <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite>. At last, by inputting the image representation <math id="S3.SS3.SSSx1.p1.6.m6.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS3.SSSx1.p1.6.m6.1a"><mi id="S3.SS3.SSSx1.p1.6.m6.1.1" xref="S3.SS3.SSSx1.p1.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.6.m6.1b"><ci id="S3.SS3.SSSx1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSSx1.p1.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.6.m6.1c">z</annotation></semantics></math>,
the output layer (i.e., a single linear layer <math id="S3.SS3.SSSx1.p1.7.m7.1" class="ltx_Math" alttext="f_{c}(\cdot)" display="inline"><semantics id="S3.SS3.SSSx1.p1.7.m7.1a"><mrow id="S3.SS3.SSSx1.p1.7.m7.1.2" xref="S3.SS3.SSSx1.p1.7.m7.1.2.cmml"><msub id="S3.SS3.SSSx1.p1.7.m7.1.2.2" xref="S3.SS3.SSSx1.p1.7.m7.1.2.2.cmml"><mi id="S3.SS3.SSSx1.p1.7.m7.1.2.2.2" xref="S3.SS3.SSSx1.p1.7.m7.1.2.2.2.cmml">f</mi><mi id="S3.SS3.SSSx1.p1.7.m7.1.2.2.3" xref="S3.SS3.SSSx1.p1.7.m7.1.2.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p1.7.m7.1.2.1" xref="S3.SS3.SSSx1.p1.7.m7.1.2.1.cmml">​</mo><mrow id="S3.SS3.SSSx1.p1.7.m7.1.2.3.2" xref="S3.SS3.SSSx1.p1.7.m7.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.p1.7.m7.1.2.3.2.1" xref="S3.SS3.SSSx1.p1.7.m7.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p1.7.m7.1.1" xref="S3.SS3.SSSx1.p1.7.m7.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.SSSx1.p1.7.m7.1.2.3.2.2" xref="S3.SS3.SSSx1.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.7.m7.1b"><apply id="S3.SS3.SSSx1.p1.7.m7.1.2.cmml" xref="S3.SS3.SSSx1.p1.7.m7.1.2"><times id="S3.SS3.SSSx1.p1.7.m7.1.2.1.cmml" xref="S3.SS3.SSSx1.p1.7.m7.1.2.1"></times><apply id="S3.SS3.SSSx1.p1.7.m7.1.2.2.cmml" xref="S3.SS3.SSSx1.p1.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p1.7.m7.1.2.2.1.cmml" xref="S3.SS3.SSSx1.p1.7.m7.1.2.2">subscript</csymbol><ci id="S3.SS3.SSSx1.p1.7.m7.1.2.2.2.cmml" xref="S3.SS3.SSSx1.p1.7.m7.1.2.2.2">𝑓</ci><ci id="S3.SS3.SSSx1.p1.7.m7.1.2.2.3.cmml" xref="S3.SS3.SSSx1.p1.7.m7.1.2.2.3">𝑐</ci></apply><ci id="S3.SS3.SSSx1.p1.7.m7.1.1.cmml" xref="S3.SS3.SSSx1.p1.7.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.7.m7.1c">f_{c}(\cdot)</annotation></semantics></math>) predicts the class-wise logits <math id="S3.SS3.SSSx1.p1.8.m8.1" class="ltx_Math" alttext="s\in\mathbb{R}^{K}" display="inline"><semantics id="S3.SS3.SSSx1.p1.8.m8.1a"><mrow id="S3.SS3.SSSx1.p1.8.m8.1.1" xref="S3.SS3.SSSx1.p1.8.m8.1.1.cmml"><mi id="S3.SS3.SSSx1.p1.8.m8.1.1.2" xref="S3.SS3.SSSx1.p1.8.m8.1.1.2.cmml">s</mi><mo id="S3.SS3.SSSx1.p1.8.m8.1.1.1" xref="S3.SS3.SSSx1.p1.8.m8.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSSx1.p1.8.m8.1.1.3" xref="S3.SS3.SSSx1.p1.8.m8.1.1.3.cmml"><mi id="S3.SS3.SSSx1.p1.8.m8.1.1.3.2" xref="S3.SS3.SSSx1.p1.8.m8.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSSx1.p1.8.m8.1.1.3.3" xref="S3.SS3.SSSx1.p1.8.m8.1.1.3.3.cmml">K</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.8.m8.1b"><apply id="S3.SS3.SSSx1.p1.8.m8.1.1.cmml" xref="S3.SS3.SSSx1.p1.8.m8.1.1"><in id="S3.SS3.SSSx1.p1.8.m8.1.1.1.cmml" xref="S3.SS3.SSSx1.p1.8.m8.1.1.1"></in><ci id="S3.SS3.SSSx1.p1.8.m8.1.1.2.cmml" xref="S3.SS3.SSSx1.p1.8.m8.1.1.2">𝑠</ci><apply id="S3.SS3.SSSx1.p1.8.m8.1.1.3.cmml" xref="S3.SS3.SSSx1.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p1.8.m8.1.1.3.1.cmml" xref="S3.SS3.SSSx1.p1.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS3.SSSx1.p1.8.m8.1.1.3.2.cmml" xref="S3.SS3.SSSx1.p1.8.m8.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSSx1.p1.8.m8.1.1.3.3.cmml" xref="S3.SS3.SSSx1.p1.8.m8.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.8.m8.1c">s\in\mathbb{R}^{K}</annotation></semantics></math>, which are used to compute the cross-entropy loss <math id="S3.SS3.SSSx1.p1.9.m9.1" class="ltx_Math" alttext="\ell_{ce}" display="inline"><semantics id="S3.SS3.SSSx1.p1.9.m9.1a"><msub id="S3.SS3.SSSx1.p1.9.m9.1.1" xref="S3.SS3.SSSx1.p1.9.m9.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.SSSx1.p1.9.m9.1.1.2" xref="S3.SS3.SSSx1.p1.9.m9.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.SSSx1.p1.9.m9.1.1.3" xref="S3.SS3.SSSx1.p1.9.m9.1.1.3.cmml"><mi id="S3.SS3.SSSx1.p1.9.m9.1.1.3.2" xref="S3.SS3.SSSx1.p1.9.m9.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p1.9.m9.1.1.3.1" xref="S3.SS3.SSSx1.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.p1.9.m9.1.1.3.3" xref="S3.SS3.SSSx1.p1.9.m9.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.9.m9.1b"><apply id="S3.SS3.SSSx1.p1.9.m9.1.1.cmml" xref="S3.SS3.SSSx1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p1.9.m9.1.1.1.cmml" xref="S3.SS3.SSSx1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.p1.9.m9.1.1.2.cmml" xref="S3.SS3.SSSx1.p1.9.m9.1.1.2">ℓ</ci><apply id="S3.SS3.SSSx1.p1.9.m9.1.1.3.cmml" xref="S3.SS3.SSSx1.p1.9.m9.1.1.3"><times id="S3.SS3.SSSx1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS3.SSSx1.p1.9.m9.1.1.3.1"></times><ci id="S3.SS3.SSSx1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS3.SSSx1.p1.9.m9.1.1.3.2">𝑐</ci><ci id="S3.SS3.SSSx1.p1.9.m9.1.1.3.3.cmml" xref="S3.SS3.SSSx1.p1.9.m9.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.9.m9.1c">\ell_{ce}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.SSSx1.p2" class="ltx_para">
<p id="S3.SS3.SSSx1.p2.11" class="ltx_p">For ease of presentation, with model weight <math id="S3.SS3.SSSx1.p2.1.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS3.SSSx1.p2.1.m1.1a"><mi id="S3.SS3.SSSx1.p2.1.m1.1.1" xref="S3.SS3.SSSx1.p2.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p2.1.m1.1b"><ci id="S3.SS3.SSSx1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSSx1.p2.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p2.1.m1.1c">w</annotation></semantics></math>, we use <math id="S3.SS3.SSSx1.p2.2.m2.1" class="ltx_Math" alttext="w_{e}" display="inline"><semantics id="S3.SS3.SSSx1.p2.2.m2.1a"><msub id="S3.SS3.SSSx1.p2.2.m2.1.1" xref="S3.SS3.SSSx1.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSSx1.p2.2.m2.1.1.2" xref="S3.SS3.SSSx1.p2.2.m2.1.1.2.cmml">w</mi><mi id="S3.SS3.SSSx1.p2.2.m2.1.1.3" xref="S3.SS3.SSSx1.p2.2.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p2.2.m2.1b"><apply id="S3.SS3.SSSx1.p2.2.m2.1.1.cmml" xref="S3.SS3.SSSx1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSSx1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSSx1.p2.2.m2.1.1.2">𝑤</ci><ci id="S3.SS3.SSSx1.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSSx1.p2.2.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p2.2.m2.1c">w_{e}</annotation></semantics></math> to represent the weight of the feature extraction network, which is composed of the base encoder and the projection head, and <math id="S3.SS3.SSSx1.p2.3.m3.1" class="ltx_Math" alttext="w_{c}" display="inline"><semantics id="S3.SS3.SSSx1.p2.3.m3.1a"><msub id="S3.SS3.SSSx1.p2.3.m3.1.1" xref="S3.SS3.SSSx1.p2.3.m3.1.1.cmml"><mi id="S3.SS3.SSSx1.p2.3.m3.1.1.2" xref="S3.SS3.SSSx1.p2.3.m3.1.1.2.cmml">w</mi><mi id="S3.SS3.SSSx1.p2.3.m3.1.1.3" xref="S3.SS3.SSSx1.p2.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p2.3.m3.1b"><apply id="S3.SS3.SSSx1.p2.3.m3.1.1.cmml" xref="S3.SS3.SSSx1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSSx1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSSx1.p2.3.m3.1.1.2">𝑤</ci><ci id="S3.SS3.SSSx1.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSSx1.p2.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p2.3.m3.1c">w_{c}</annotation></semantics></math> to represent the weight of the output layer.
Correspondingly, <math id="S3.SS3.SSSx1.p2.4.m4.2" class="ltx_Math" alttext="f_{e}(w_{e};\cdot):\mathbb{R}^{P}\rightarrow\mathbb{R}^{Q}" display="inline"><semantics id="S3.SS3.SSSx1.p2.4.m4.2a"><mrow id="S3.SS3.SSSx1.p2.4.m4.2.2" xref="S3.SS3.SSSx1.p2.4.m4.2.2.cmml"><mrow id="S3.SS3.SSSx1.p2.4.m4.2.2.1" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.cmml"><msub id="S3.SS3.SSSx1.p2.4.m4.2.2.1.3" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.3.cmml"><mi id="S3.SS3.SSSx1.p2.4.m4.2.2.1.3.2" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.3.2.cmml">f</mi><mi id="S3.SS3.SSSx1.p2.4.m4.2.2.1.3.3" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p2.4.m4.2.2.1.2" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.2" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.2.cmml">(</mo><msub id="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1.cmml"><mi id="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1.2" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1.2.cmml">w</mi><mi id="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1.3" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1.3.cmml">e</mi></msub><mo rspace="0em" id="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.3" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.2.cmml">;</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p2.4.m4.1.1" xref="S3.SS3.SSSx1.p2.4.m4.1.1.cmml">⋅</mo><mo rspace="0.278em" stretchy="false" id="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.4" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.SS3.SSSx1.p2.4.m4.2.2.2" xref="S3.SS3.SSSx1.p2.4.m4.2.2.2.cmml">:</mo><mrow id="S3.SS3.SSSx1.p2.4.m4.2.2.3" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.cmml"><msup id="S3.SS3.SSSx1.p2.4.m4.2.2.3.2" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.2.cmml"><mi id="S3.SS3.SSSx1.p2.4.m4.2.2.3.2.2" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.2.2.cmml">ℝ</mi><mi id="S3.SS3.SSSx1.p2.4.m4.2.2.3.2.3" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.2.3.cmml">P</mi></msup><mo stretchy="false" id="S3.SS3.SSSx1.p2.4.m4.2.2.3.1" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.1.cmml">→</mo><msup id="S3.SS3.SSSx1.p2.4.m4.2.2.3.3" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.3.cmml"><mi id="S3.SS3.SSSx1.p2.4.m4.2.2.3.3.2" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSSx1.p2.4.m4.2.2.3.3.3" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.3.3.cmml">Q</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p2.4.m4.2b"><apply id="S3.SS3.SSSx1.p2.4.m4.2.2.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2"><ci id="S3.SS3.SSSx1.p2.4.m4.2.2.2.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.2">:</ci><apply id="S3.SS3.SSSx1.p2.4.m4.2.2.1.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1"><times id="S3.SS3.SSSx1.p2.4.m4.2.2.1.2.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.2"></times><apply id="S3.SS3.SSSx1.p2.4.m4.2.2.1.3.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.4.m4.2.2.1.3.1.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.3">subscript</csymbol><ci id="S3.SS3.SSSx1.p2.4.m4.2.2.1.3.2.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.3.2">𝑓</ci><ci id="S3.SS3.SSSx1.p2.4.m4.2.2.1.3.3.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.3.3">𝑒</ci></apply><list id="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.2.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1"><apply id="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1.2.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1.2">𝑤</ci><ci id="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1.3.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.1.1.1.1.3">𝑒</ci></apply><ci id="S3.SS3.SSSx1.p2.4.m4.1.1.cmml" xref="S3.SS3.SSSx1.p2.4.m4.1.1">⋅</ci></list></apply><apply id="S3.SS3.SSSx1.p2.4.m4.2.2.3.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3"><ci id="S3.SS3.SSSx1.p2.4.m4.2.2.3.1.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.1">→</ci><apply id="S3.SS3.SSSx1.p2.4.m4.2.2.3.2.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.4.m4.2.2.3.2.1.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.2">superscript</csymbol><ci id="S3.SS3.SSSx1.p2.4.m4.2.2.3.2.2.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.2.2">ℝ</ci><ci id="S3.SS3.SSSx1.p2.4.m4.2.2.3.2.3.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.2.3">𝑃</ci></apply><apply id="S3.SS3.SSSx1.p2.4.m4.2.2.3.3.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.4.m4.2.2.3.3.1.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.3">superscript</csymbol><ci id="S3.SS3.SSSx1.p2.4.m4.2.2.3.3.2.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.3.2">ℝ</ci><ci id="S3.SS3.SSSx1.p2.4.m4.2.2.3.3.3.cmml" xref="S3.SS3.SSSx1.p2.4.m4.2.2.3.3.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p2.4.m4.2c">f_{e}(w_{e};\cdot):\mathbb{R}^{P}\rightarrow\mathbb{R}^{Q}</annotation></semantics></math> (with learnable parameters <math id="S3.SS3.SSSx1.p2.5.m5.1" class="ltx_Math" alttext="w_{e}" display="inline"><semantics id="S3.SS3.SSSx1.p2.5.m5.1a"><msub id="S3.SS3.SSSx1.p2.5.m5.1.1" xref="S3.SS3.SSSx1.p2.5.m5.1.1.cmml"><mi id="S3.SS3.SSSx1.p2.5.m5.1.1.2" xref="S3.SS3.SSSx1.p2.5.m5.1.1.2.cmml">w</mi><mi id="S3.SS3.SSSx1.p2.5.m5.1.1.3" xref="S3.SS3.SSSx1.p2.5.m5.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p2.5.m5.1b"><apply id="S3.SS3.SSSx1.p2.5.m5.1.1.cmml" xref="S3.SS3.SSSx1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.5.m5.1.1.1.cmml" xref="S3.SS3.SSSx1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.p2.5.m5.1.1.2.cmml" xref="S3.SS3.SSSx1.p2.5.m5.1.1.2">𝑤</ci><ci id="S3.SS3.SSSx1.p2.5.m5.1.1.3.cmml" xref="S3.SS3.SSSx1.p2.5.m5.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p2.5.m5.1c">w_{e}</annotation></semantics></math>) represents the feature extraction network, and <math id="S3.SS3.SSSx1.p2.6.m6.2" class="ltx_Math" alttext="f_{c}(w_{c};\cdot):\mathbb{R}^{Q}\rightarrow\mathbb{R}^{K}" display="inline"><semantics id="S3.SS3.SSSx1.p2.6.m6.2a"><mrow id="S3.SS3.SSSx1.p2.6.m6.2.2" xref="S3.SS3.SSSx1.p2.6.m6.2.2.cmml"><mrow id="S3.SS3.SSSx1.p2.6.m6.2.2.1" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.cmml"><msub id="S3.SS3.SSSx1.p2.6.m6.2.2.1.3" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.3.cmml"><mi id="S3.SS3.SSSx1.p2.6.m6.2.2.1.3.2" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.3.2.cmml">f</mi><mi id="S3.SS3.SSSx1.p2.6.m6.2.2.1.3.3" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p2.6.m6.2.2.1.2" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.2" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.2.cmml">(</mo><msub id="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1.cmml"><mi id="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1.2" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1.2.cmml">w</mi><mi id="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1.3" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1.3.cmml">c</mi></msub><mo rspace="0em" id="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.3" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.2.cmml">;</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p2.6.m6.1.1" xref="S3.SS3.SSSx1.p2.6.m6.1.1.cmml">⋅</mo><mo rspace="0.278em" stretchy="false" id="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.4" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.SS3.SSSx1.p2.6.m6.2.2.2" xref="S3.SS3.SSSx1.p2.6.m6.2.2.2.cmml">:</mo><mrow id="S3.SS3.SSSx1.p2.6.m6.2.2.3" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.cmml"><msup id="S3.SS3.SSSx1.p2.6.m6.2.2.3.2" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.2.cmml"><mi id="S3.SS3.SSSx1.p2.6.m6.2.2.3.2.2" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.2.2.cmml">ℝ</mi><mi id="S3.SS3.SSSx1.p2.6.m6.2.2.3.2.3" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.2.3.cmml">Q</mi></msup><mo stretchy="false" id="S3.SS3.SSSx1.p2.6.m6.2.2.3.1" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.1.cmml">→</mo><msup id="S3.SS3.SSSx1.p2.6.m6.2.2.3.3" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.3.cmml"><mi id="S3.SS3.SSSx1.p2.6.m6.2.2.3.3.2" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSSx1.p2.6.m6.2.2.3.3.3" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.3.3.cmml">K</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p2.6.m6.2b"><apply id="S3.SS3.SSSx1.p2.6.m6.2.2.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2"><ci id="S3.SS3.SSSx1.p2.6.m6.2.2.2.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.2">:</ci><apply id="S3.SS3.SSSx1.p2.6.m6.2.2.1.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1"><times id="S3.SS3.SSSx1.p2.6.m6.2.2.1.2.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.2"></times><apply id="S3.SS3.SSSx1.p2.6.m6.2.2.1.3.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.6.m6.2.2.1.3.1.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.3">subscript</csymbol><ci id="S3.SS3.SSSx1.p2.6.m6.2.2.1.3.2.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.3.2">𝑓</ci><ci id="S3.SS3.SSSx1.p2.6.m6.2.2.1.3.3.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.3.3">𝑐</ci></apply><list id="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.2.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1"><apply id="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1.2.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1.2">𝑤</ci><ci id="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1.3.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.1.1.1.1.3">𝑐</ci></apply><ci id="S3.SS3.SSSx1.p2.6.m6.1.1.cmml" xref="S3.SS3.SSSx1.p2.6.m6.1.1">⋅</ci></list></apply><apply id="S3.SS3.SSSx1.p2.6.m6.2.2.3.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3"><ci id="S3.SS3.SSSx1.p2.6.m6.2.2.3.1.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.1">→</ci><apply id="S3.SS3.SSSx1.p2.6.m6.2.2.3.2.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.6.m6.2.2.3.2.1.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.2">superscript</csymbol><ci id="S3.SS3.SSSx1.p2.6.m6.2.2.3.2.2.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.2.2">ℝ</ci><ci id="S3.SS3.SSSx1.p2.6.m6.2.2.3.2.3.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.2.3">𝑄</ci></apply><apply id="S3.SS3.SSSx1.p2.6.m6.2.2.3.3.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.6.m6.2.2.3.3.1.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.3">superscript</csymbol><ci id="S3.SS3.SSSx1.p2.6.m6.2.2.3.3.2.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.3.2">ℝ</ci><ci id="S3.SS3.SSSx1.p2.6.m6.2.2.3.3.3.cmml" xref="S3.SS3.SSSx1.p2.6.m6.2.2.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p2.6.m6.2c">f_{c}(w_{c};\cdot):\mathbb{R}^{Q}\rightarrow\mathbb{R}^{K}</annotation></semantics></math> (with learnable parameters <math id="S3.SS3.SSSx1.p2.7.m7.1" class="ltx_Math" alttext="w_{c}" display="inline"><semantics id="S3.SS3.SSSx1.p2.7.m7.1a"><msub id="S3.SS3.SSSx1.p2.7.m7.1.1" xref="S3.SS3.SSSx1.p2.7.m7.1.1.cmml"><mi id="S3.SS3.SSSx1.p2.7.m7.1.1.2" xref="S3.SS3.SSSx1.p2.7.m7.1.1.2.cmml">w</mi><mi id="S3.SS3.SSSx1.p2.7.m7.1.1.3" xref="S3.SS3.SSSx1.p2.7.m7.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p2.7.m7.1b"><apply id="S3.SS3.SSSx1.p2.7.m7.1.1.cmml" xref="S3.SS3.SSSx1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.7.m7.1.1.1.cmml" xref="S3.SS3.SSSx1.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.p2.7.m7.1.1.2.cmml" xref="S3.SS3.SSSx1.p2.7.m7.1.1.2">𝑤</ci><ci id="S3.SS3.SSSx1.p2.7.m7.1.1.3.cmml" xref="S3.SS3.SSSx1.p2.7.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p2.7.m7.1c">w_{c}</annotation></semantics></math>) represents the output layer network.
That is, <math id="S3.SS3.SSSx1.p2.8.m8.2" class="ltx_Math" alttext="z=f_{e}(w_{e};x)" display="inline"><semantics id="S3.SS3.SSSx1.p2.8.m8.2a"><mrow id="S3.SS3.SSSx1.p2.8.m8.2.2" xref="S3.SS3.SSSx1.p2.8.m8.2.2.cmml"><mi id="S3.SS3.SSSx1.p2.8.m8.2.2.3" xref="S3.SS3.SSSx1.p2.8.m8.2.2.3.cmml">z</mi><mo id="S3.SS3.SSSx1.p2.8.m8.2.2.2" xref="S3.SS3.SSSx1.p2.8.m8.2.2.2.cmml">=</mo><mrow id="S3.SS3.SSSx1.p2.8.m8.2.2.1" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.cmml"><msub id="S3.SS3.SSSx1.p2.8.m8.2.2.1.3" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.3.cmml"><mi id="S3.SS3.SSSx1.p2.8.m8.2.2.1.3.2" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.3.2.cmml">f</mi><mi id="S3.SS3.SSSx1.p2.8.m8.2.2.1.3.3" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p2.8.m8.2.2.1.2" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.2" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.2.cmml">(</mo><msub id="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1.cmml"><mi id="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1.2" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1.2.cmml">w</mi><mi id="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1.3" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1.3.cmml">e</mi></msub><mo id="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.3" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.2.cmml">;</mo><mi id="S3.SS3.SSSx1.p2.8.m8.1.1" xref="S3.SS3.SSSx1.p2.8.m8.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.4" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p2.8.m8.2b"><apply id="S3.SS3.SSSx1.p2.8.m8.2.2.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2"><eq id="S3.SS3.SSSx1.p2.8.m8.2.2.2.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.2"></eq><ci id="S3.SS3.SSSx1.p2.8.m8.2.2.3.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.3">𝑧</ci><apply id="S3.SS3.SSSx1.p2.8.m8.2.2.1.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1"><times id="S3.SS3.SSSx1.p2.8.m8.2.2.1.2.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.2"></times><apply id="S3.SS3.SSSx1.p2.8.m8.2.2.1.3.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.8.m8.2.2.1.3.1.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.3">subscript</csymbol><ci id="S3.SS3.SSSx1.p2.8.m8.2.2.1.3.2.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.3.2">𝑓</ci><ci id="S3.SS3.SSSx1.p2.8.m8.2.2.1.3.3.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.3.3">𝑒</ci></apply><list id="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.2.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1"><apply id="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1.2.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1.2">𝑤</ci><ci id="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1.3.cmml" xref="S3.SS3.SSSx1.p2.8.m8.2.2.1.1.1.1.3">𝑒</ci></apply><ci id="S3.SS3.SSSx1.p2.8.m8.1.1.cmml" xref="S3.SS3.SSSx1.p2.8.m8.1.1">𝑥</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p2.8.m8.2c">z=f_{e}(w_{e};x)</annotation></semantics></math> is the mapped representation of input <math id="S3.SS3.SSSx1.p2.9.m9.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.SSSx1.p2.9.m9.1a"><mi id="S3.SS3.SSSx1.p2.9.m9.1.1" xref="S3.SS3.SSSx1.p2.9.m9.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p2.9.m9.1b"><ci id="S3.SS3.SSSx1.p2.9.m9.1.1.cmml" xref="S3.SS3.SSSx1.p2.9.m9.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p2.9.m9.1c">x</annotation></semantics></math>, and <math id="S3.SS3.SSSx1.p2.10.m10.2" class="ltx_Math" alttext="s=f_{c}(w_{c};z)" display="inline"><semantics id="S3.SS3.SSSx1.p2.10.m10.2a"><mrow id="S3.SS3.SSSx1.p2.10.m10.2.2" xref="S3.SS3.SSSx1.p2.10.m10.2.2.cmml"><mi id="S3.SS3.SSSx1.p2.10.m10.2.2.3" xref="S3.SS3.SSSx1.p2.10.m10.2.2.3.cmml">s</mi><mo id="S3.SS3.SSSx1.p2.10.m10.2.2.2" xref="S3.SS3.SSSx1.p2.10.m10.2.2.2.cmml">=</mo><mrow id="S3.SS3.SSSx1.p2.10.m10.2.2.1" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.cmml"><msub id="S3.SS3.SSSx1.p2.10.m10.2.2.1.3" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.3.cmml"><mi id="S3.SS3.SSSx1.p2.10.m10.2.2.1.3.2" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.3.2.cmml">f</mi><mi id="S3.SS3.SSSx1.p2.10.m10.2.2.1.3.3" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p2.10.m10.2.2.1.2" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.2" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.2.cmml">(</mo><msub id="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1.cmml"><mi id="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1.2" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1.2.cmml">w</mi><mi id="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1.3" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.3" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.2.cmml">;</mo><mi id="S3.SS3.SSSx1.p2.10.m10.1.1" xref="S3.SS3.SSSx1.p2.10.m10.1.1.cmml">z</mi><mo stretchy="false" id="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.4" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p2.10.m10.2b"><apply id="S3.SS3.SSSx1.p2.10.m10.2.2.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2"><eq id="S3.SS3.SSSx1.p2.10.m10.2.2.2.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.2"></eq><ci id="S3.SS3.SSSx1.p2.10.m10.2.2.3.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.3">𝑠</ci><apply id="S3.SS3.SSSx1.p2.10.m10.2.2.1.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1"><times id="S3.SS3.SSSx1.p2.10.m10.2.2.1.2.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.2"></times><apply id="S3.SS3.SSSx1.p2.10.m10.2.2.1.3.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.10.m10.2.2.1.3.1.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.3">subscript</csymbol><ci id="S3.SS3.SSSx1.p2.10.m10.2.2.1.3.2.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.3.2">𝑓</ci><ci id="S3.SS3.SSSx1.p2.10.m10.2.2.1.3.3.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.3.3">𝑐</ci></apply><list id="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.2.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1"><apply id="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1.2.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1.2">𝑤</ci><ci id="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1.3.cmml" xref="S3.SS3.SSSx1.p2.10.m10.2.2.1.1.1.1.3">𝑐</ci></apply><ci id="S3.SS3.SSSx1.p2.10.m10.1.1.cmml" xref="S3.SS3.SSSx1.p2.10.m10.1.1">𝑧</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p2.10.m10.2c">s=f_{c}(w_{c};z)</annotation></semantics></math> is the prediction vector of the representation <math id="S3.SS3.SSSx1.p2.11.m11.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS3.SSSx1.p2.11.m11.1a"><mi id="S3.SS3.SSSx1.p2.11.m11.1.1" xref="S3.SS3.SSSx1.p2.11.m11.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p2.11.m11.1b"><ci id="S3.SS3.SSSx1.p2.11.m11.1.1.cmml" xref="S3.SS3.SSSx1.p2.11.m11.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p2.11.m11.1c">z</annotation></semantics></math>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> The FedProc framework</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">0:</span>  local datasets <math id="alg1.l0.m1.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="alg1.l0.m1.1a"><msub id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m1.1.1.2" xref="alg1.l0.m1.1.1.2.cmml">𝒟</mi><mi id="alg1.l0.m1.1.1.3" xref="alg1.l0.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><apply id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m1.1.1.1.cmml" xref="alg1.l0.m1.1.1">subscript</csymbol><ci id="alg1.l0.m1.1.1.2.cmml" xref="alg1.l0.m1.1.1.2">𝒟</ci><ci id="alg1.l0.m1.1.1.3.cmml" xref="alg1.l0.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">\mathcal{D}_{i}</annotation></semantics></math>, number of communication rounds <math id="alg1.l0.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">T</annotation></semantics></math>, number of local epochs <math id="alg1.l0.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">E</annotation></semantics></math>, number of classes <math id="alg1.l0.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l0.m4.1a"><mi id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><ci id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">K</annotation></semantics></math>, number of clients <math id="alg1.l0.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l0.m5.1a"><mi id="alg1.l0.m5.1.1" xref="alg1.l0.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.1b"><ci id="alg1.l0.m5.1.1.cmml" xref="alg1.l0.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.1c">m</annotation></semantics></math>, learning rate <math id="alg1.l0.m6.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.l0.m6.1a"><mi id="alg1.l0.m6.1.1" xref="alg1.l0.m6.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m6.1b"><ci id="alg1.l0.m6.1.1.cmml" xref="alg1.l0.m6.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m6.1c">\eta</annotation></semantics></math>.

</div>
<div id="alg1.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">0:</span>  The final model <math id="alg1.l0a.m1.1" class="ltx_Math" alttext="w^{T}" display="inline"><semantics id="alg1.l0a.m1.1a"><msup id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml"><mi id="alg1.l0a.m1.1.1.2" xref="alg1.l0a.m1.1.1.2.cmml">w</mi><mi id="alg1.l0a.m1.1.1.3" xref="alg1.l0a.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><apply id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m1.1.1.1.cmml" xref="alg1.l0a.m1.1.1">superscript</csymbol><ci id="alg1.l0a.m1.1.1.2.cmml" xref="alg1.l0a.m1.1.1.2">𝑤</ci><ci id="alg1.l0a.m1.1.1.3.cmml" xref="alg1.l0a.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">w^{T}</annotation></semantics></math>.

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span id="alg1.l1.1" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">Server executes:</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  initialize <math id="alg1.l2.m1.1" class="ltx_Math" alttext="w^{0}" display="inline"><semantics id="alg1.l2.m1.1a"><msup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">w</mi><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑤</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">w^{0}</annotation></semantics></math>, <math id="alg1.l2.m2.1" class="ltx_Math" alttext="c^{0}" display="inline"><semantics id="alg1.l2.m2.1a"><msup id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">c</mi><mn id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">superscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝑐</ci><cn type="integer" id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">c^{0}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.4" class="ltx_Math" alttext="t=0,1,...,T-1" display="inline"><semantics id="alg1.l3.m1.4a"><mrow id="alg1.l3.m1.4.4" xref="alg1.l3.m1.4.4.cmml"><mi id="alg1.l3.m1.4.4.3" xref="alg1.l3.m1.4.4.3.cmml">t</mi><mo id="alg1.l3.m1.4.4.2" xref="alg1.l3.m1.4.4.2.cmml">=</mo><mrow id="alg1.l3.m1.4.4.1.1" xref="alg1.l3.m1.4.4.1.2.cmml"><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">0</mn><mo id="alg1.l3.m1.4.4.1.1.2" xref="alg1.l3.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">1</mn><mo id="alg1.l3.m1.4.4.1.1.3" xref="alg1.l3.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">…</mi><mo id="alg1.l3.m1.4.4.1.1.4" xref="alg1.l3.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l3.m1.4.4.1.1.1" xref="alg1.l3.m1.4.4.1.1.1.cmml"><mi id="alg1.l3.m1.4.4.1.1.1.2" xref="alg1.l3.m1.4.4.1.1.1.2.cmml">T</mi><mo id="alg1.l3.m1.4.4.1.1.1.1" xref="alg1.l3.m1.4.4.1.1.1.1.cmml">−</mo><mn id="alg1.l3.m1.4.4.1.1.1.3" xref="alg1.l3.m1.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.4b"><apply id="alg1.l3.m1.4.4.cmml" xref="alg1.l3.m1.4.4"><eq id="alg1.l3.m1.4.4.2.cmml" xref="alg1.l3.m1.4.4.2"></eq><ci id="alg1.l3.m1.4.4.3.cmml" xref="alg1.l3.m1.4.4.3">𝑡</ci><list id="alg1.l3.m1.4.4.1.2.cmml" xref="alg1.l3.m1.4.4.1.1"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">0</cn><cn type="integer" id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">1</cn><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">…</ci><apply id="alg1.l3.m1.4.4.1.1.1.cmml" xref="alg1.l3.m1.4.4.1.1.1"><minus id="alg1.l3.m1.4.4.1.1.1.1.cmml" xref="alg1.l3.m1.4.4.1.1.1.1"></minus><ci id="alg1.l3.m1.4.4.1.1.1.2.cmml" xref="alg1.l3.m1.4.4.1.1.1.2">𝑇</ci><cn type="integer" id="alg1.l3.m1.4.4.1.1.1.3.cmml" xref="alg1.l3.m1.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.4c">t=0,1,...,T-1</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l4.m1.4" class="ltx_Math" alttext="i=1,2,...,m" display="inline"><semantics id="alg1.l4.m1.4a"><mrow id="alg1.l4.m1.4.5" xref="alg1.l4.m1.4.5.cmml"><mi id="alg1.l4.m1.4.5.2" xref="alg1.l4.m1.4.5.2.cmml">i</mi><mo id="alg1.l4.m1.4.5.1" xref="alg1.l4.m1.4.5.1.cmml">=</mo><mrow id="alg1.l4.m1.4.5.3.2" xref="alg1.l4.m1.4.5.3.1.cmml"><mn id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">1</mn><mo id="alg1.l4.m1.4.5.3.2.1" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">2</mn><mo id="alg1.l4.m1.4.5.3.2.2" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">…</mi><mo id="alg1.l4.m1.4.5.3.2.3" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l4.m1.4.4" xref="alg1.l4.m1.4.4.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.4b"><apply id="alg1.l4.m1.4.5.cmml" xref="alg1.l4.m1.4.5"><eq id="alg1.l4.m1.4.5.1.cmml" xref="alg1.l4.m1.4.5.1"></eq><ci id="alg1.l4.m1.4.5.2.cmml" xref="alg1.l4.m1.4.5.2">𝑖</ci><list id="alg1.l4.m1.4.5.3.1.cmml" xref="alg1.l4.m1.4.5.3.2"><cn type="integer" id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">1</cn><cn type="integer" id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">2</cn><ci id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3">…</ci><ci id="alg1.l4.m1.4.4.cmml" xref="alg1.l4.m1.4.4">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.4c">i=1,2,...,m</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>        send the global model <math id="alg1.l5.m1.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="alg1.l5.m1.1a"><msup id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">w</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑤</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">w^{t}</annotation></semantics></math> to <math id="alg1.l5.m2.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="alg1.l5.m2.1a"><msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">C</mi><mi id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝐶</ci><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">C_{i}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>        send the global class-prototypes <math id="alg1.l6.m1.1" class="ltx_Math" alttext="c^{t}" display="inline"><semantics id="alg1.l6.m1.1a"><msup id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">c</mi><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">superscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑐</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">c^{t}</annotation></semantics></math> to <math id="alg1.l6.m2.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="alg1.l6.m2.1a"><msub id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">C</mi><mi id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">subscript</csymbol><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝐶</ci><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">C_{i}</annotation></semantics></math> 
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>        <math id="alg1.l7.m1.2" class="ltx_Math" alttext="w_{i}^{t+1},c_{i}^{t+1}\leftarrow" display="inline"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml"><mrow id="alg1.l7.m1.2.2.2.2" xref="alg1.l7.m1.2.2.2.3.cmml"><msubsup id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.2.2" xref="alg1.l7.m1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l7.m1.1.1.1.1.1.2.3" xref="alg1.l7.m1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.3.2" xref="alg1.l7.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l7.m1.1.1.1.1.1.3.1" xref="alg1.l7.m1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l7.m1.1.1.1.1.1.3.3" xref="alg1.l7.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l7.m1.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.3.cmml">,</mo><msubsup id="alg1.l7.m1.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.2.cmml">c</mi><mi id="alg1.l7.m1.2.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.2.2.3.cmml">i</mi><mrow id="alg1.l7.m1.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.3.2" xref="alg1.l7.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l7.m1.2.2.2.2.2.3.1" xref="alg1.l7.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="alg1.l7.m1.2.2.2.2.2.3.3" xref="alg1.l7.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup></mrow><mo stretchy="false" id="alg1.l7.m1.2.2.3" xref="alg1.l7.m1.2.2.3.cmml">←</mo><mi id="alg1.l7.m1.2.2.4" xref="alg1.l7.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"><ci id="alg1.l7.m1.2.2.3.cmml" xref="alg1.l7.m1.2.2.3">←</ci><list id="alg1.l7.m1.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2"><apply id="alg1.l7.m1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l7.m1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l7.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l7.m1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.3"><plus id="alg1.l7.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.3.1"></plus><ci id="alg1.l7.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l7.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l7.m1.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.1.cmml" xref="alg1.l7.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l7.m1.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l7.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l7.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.2">𝑐</ci><ci id="alg1.l7.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="alg1.l7.m1.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.3"><plus id="alg1.l7.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.3.1"></plus><ci id="alg1.l7.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l7.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.3.3">1</cn></apply></apply></list><csymbol cd="latexml" id="alg1.l7.m1.2.2.4.cmml" xref="alg1.l7.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">w_{i}^{t+1},c_{i}^{t+1}\leftarrow</annotation></semantics></math> <span id="alg1.l7.1" class="ltx_text ltx_font_bold">ClientLocalTraining</span>(<math id="alg1.l7.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">i</annotation></semantics></math>, <math id="alg1.l7.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l7.m3.1a"><mi id="alg1.l7.m3.1.1" xref="alg1.l7.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.1b"><ci id="alg1.l7.m3.1.1.cmml" xref="alg1.l7.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.1c">t</annotation></semantics></math>, <math id="alg1.l7.m4.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="alg1.l7.m4.1a"><msup id="alg1.l7.m4.1.1" xref="alg1.l7.m4.1.1.cmml"><mi id="alg1.l7.m4.1.1.2" xref="alg1.l7.m4.1.1.2.cmml">w</mi><mi id="alg1.l7.m4.1.1.3" xref="alg1.l7.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l7.m4.1b"><apply id="alg1.l7.m4.1.1.cmml" xref="alg1.l7.m4.1.1"><csymbol cd="ambiguous" id="alg1.l7.m4.1.1.1.cmml" xref="alg1.l7.m4.1.1">superscript</csymbol><ci id="alg1.l7.m4.1.1.2.cmml" xref="alg1.l7.m4.1.1.2">𝑤</ci><ci id="alg1.l7.m4.1.1.3.cmml" xref="alg1.l7.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m4.1c">w^{t}</annotation></semantics></math>, <math id="alg1.l7.m5.1" class="ltx_Math" alttext="c^{t}" display="inline"><semantics id="alg1.l7.m5.1a"><msup id="alg1.l7.m5.1.1" xref="alg1.l7.m5.1.1.cmml"><mi id="alg1.l7.m5.1.1.2" xref="alg1.l7.m5.1.1.2.cmml">c</mi><mi id="alg1.l7.m5.1.1.3" xref="alg1.l7.m5.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l7.m5.1b"><apply id="alg1.l7.m5.1.1.cmml" xref="alg1.l7.m5.1.1"><csymbol cd="ambiguous" id="alg1.l7.m5.1.1.1.cmml" xref="alg1.l7.m5.1.1">superscript</csymbol><ci id="alg1.l7.m5.1.1.2.cmml" xref="alg1.l7.m5.1.1.2">𝑐</ci><ci id="alg1.l7.m5.1.1.3.cmml" xref="alg1.l7.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m5.1c">c^{t}</annotation></semantics></math>)

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <span id="alg1.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math id="alg1.l9.m1.1" class="ltx_Math" alttext="c^{t+1}\leftarrow\frac{1}{m}\sum_{i=1}^{m}c_{i}^{t+1}" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msup id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">c</mi><mrow id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml"><mi id="alg1.l9.m1.1.1.2.3.2" xref="alg1.l9.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.2.3.1" xref="alg1.l9.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l9.m1.1.1.2.3.3" xref="alg1.l9.m1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">←</mo><mrow id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mfrac id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml"><mn id="alg1.l9.m1.1.1.3.2.2" xref="alg1.l9.m1.1.1.3.2.2.cmml">1</mn><mi id="alg1.l9.m1.1.1.3.2.3" xref="alg1.l9.m1.1.1.3.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.3.1" xref="alg1.l9.m1.1.1.3.1.cmml">​</mo><mrow id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml"><msubsup id="alg1.l9.m1.1.1.3.3.1" xref="alg1.l9.m1.1.1.3.3.1.cmml"><mo id="alg1.l9.m1.1.1.3.3.1.2.2" xref="alg1.l9.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l9.m1.1.1.3.3.1.2.3" xref="alg1.l9.m1.1.1.3.3.1.2.3.cmml"><mi id="alg1.l9.m1.1.1.3.3.1.2.3.2" xref="alg1.l9.m1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="alg1.l9.m1.1.1.3.3.1.2.3.1" xref="alg1.l9.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="alg1.l9.m1.1.1.3.3.1.2.3.3" xref="alg1.l9.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l9.m1.1.1.3.3.1.3" xref="alg1.l9.m1.1.1.3.3.1.3.cmml">m</mi></msubsup><msubsup id="alg1.l9.m1.1.1.3.3.2" xref="alg1.l9.m1.1.1.3.3.2.cmml"><mi id="alg1.l9.m1.1.1.3.3.2.2.2" xref="alg1.l9.m1.1.1.3.3.2.2.2.cmml">c</mi><mi id="alg1.l9.m1.1.1.3.3.2.2.3" xref="alg1.l9.m1.1.1.3.3.2.2.3.cmml">i</mi><mrow id="alg1.l9.m1.1.1.3.3.2.3" xref="alg1.l9.m1.1.1.3.3.2.3.cmml"><mi id="alg1.l9.m1.1.1.3.3.2.3.2" xref="alg1.l9.m1.1.1.3.3.2.3.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.3.3.2.3.1" xref="alg1.l9.m1.1.1.3.3.2.3.1.cmml">+</mo><mn id="alg1.l9.m1.1.1.3.3.2.3.3" xref="alg1.l9.m1.1.1.3.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">superscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑐</ci><apply id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3"><plus id="alg1.l9.m1.1.1.2.3.1.cmml" xref="alg1.l9.m1.1.1.2.3.1"></plus><ci id="alg1.l9.m1.1.1.2.3.2.cmml" xref="alg1.l9.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l9.m1.1.1.2.3.3.cmml" xref="alg1.l9.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><times id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3.1"></times><apply id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2"><divide id="alg1.l9.m1.1.1.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.2"></divide><cn type="integer" id="alg1.l9.m1.1.1.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.2">1</cn><ci id="alg1.l9.m1.1.1.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.3">𝑚</ci></apply><apply id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3"><apply id="alg1.l9.m1.1.1.3.3.1.cmml" xref="alg1.l9.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.3.1.1.cmml" xref="alg1.l9.m1.1.1.3.3.1">superscript</csymbol><apply id="alg1.l9.m1.1.1.3.3.1.2.cmml" xref="alg1.l9.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.3.1.2.1.cmml" xref="alg1.l9.m1.1.1.3.3.1">subscript</csymbol><sum id="alg1.l9.m1.1.1.3.3.1.2.2.cmml" xref="alg1.l9.m1.1.1.3.3.1.2.2"></sum><apply id="alg1.l9.m1.1.1.3.3.1.2.3.cmml" xref="alg1.l9.m1.1.1.3.3.1.2.3"><eq id="alg1.l9.m1.1.1.3.3.1.2.3.1.cmml" xref="alg1.l9.m1.1.1.3.3.1.2.3.1"></eq><ci id="alg1.l9.m1.1.1.3.3.1.2.3.2.cmml" xref="alg1.l9.m1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.l9.m1.1.1.3.3.1.2.3.3.cmml" xref="alg1.l9.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l9.m1.1.1.3.3.1.3.cmml" xref="alg1.l9.m1.1.1.3.3.1.3">𝑚</ci></apply><apply id="alg1.l9.m1.1.1.3.3.2.cmml" xref="alg1.l9.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.3.2">superscript</csymbol><apply id="alg1.l9.m1.1.1.3.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.3.2.2.1.cmml" xref="alg1.l9.m1.1.1.3.3.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.3.2.2.2.cmml" xref="alg1.l9.m1.1.1.3.3.2.2.2">𝑐</ci><ci id="alg1.l9.m1.1.1.3.3.2.2.3.cmml" xref="alg1.l9.m1.1.1.3.3.2.2.3">𝑖</ci></apply><apply id="alg1.l9.m1.1.1.3.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.3.2.3"><plus id="alg1.l9.m1.1.1.3.3.2.3.1.cmml" xref="alg1.l9.m1.1.1.3.3.2.3.1"></plus><ci id="alg1.l9.m1.1.1.3.3.2.3.2.cmml" xref="alg1.l9.m1.1.1.3.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l9.m1.1.1.3.3.2.3.3.cmml" xref="alg1.l9.m1.1.1.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">c^{t+1}\leftarrow\frac{1}{m}\sum_{i=1}^{m}c_{i}^{t+1}</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <math id="alg1.l10.m1.2" class="ltx_Math" alttext="w^{t+1}\leftarrow\sum_{i=1}^{m}\frac{\left|\mathcal{D}_{i}\right|}{\left|\mathcal{D}\right|}w_{i}^{t+1}" display="inline"><semantics id="alg1.l10.m1.2a"><mrow id="alg1.l10.m1.2.3" xref="alg1.l10.m1.2.3.cmml"><msup id="alg1.l10.m1.2.3.2" xref="alg1.l10.m1.2.3.2.cmml"><mi id="alg1.l10.m1.2.3.2.2" xref="alg1.l10.m1.2.3.2.2.cmml">w</mi><mrow id="alg1.l10.m1.2.3.2.3" xref="alg1.l10.m1.2.3.2.3.cmml"><mi id="alg1.l10.m1.2.3.2.3.2" xref="alg1.l10.m1.2.3.2.3.2.cmml">t</mi><mo id="alg1.l10.m1.2.3.2.3.1" xref="alg1.l10.m1.2.3.2.3.1.cmml">+</mo><mn id="alg1.l10.m1.2.3.2.3.3" xref="alg1.l10.m1.2.3.2.3.3.cmml">1</mn></mrow></msup><mo rspace="0.111em" stretchy="false" id="alg1.l10.m1.2.3.1" xref="alg1.l10.m1.2.3.1.cmml">←</mo><mrow id="alg1.l10.m1.2.3.3" xref="alg1.l10.m1.2.3.3.cmml"><msubsup id="alg1.l10.m1.2.3.3.1" xref="alg1.l10.m1.2.3.3.1.cmml"><mo id="alg1.l10.m1.2.3.3.1.2.2" xref="alg1.l10.m1.2.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l10.m1.2.3.3.1.2.3" xref="alg1.l10.m1.2.3.3.1.2.3.cmml"><mi id="alg1.l10.m1.2.3.3.1.2.3.2" xref="alg1.l10.m1.2.3.3.1.2.3.2.cmml">i</mi><mo id="alg1.l10.m1.2.3.3.1.2.3.1" xref="alg1.l10.m1.2.3.3.1.2.3.1.cmml">=</mo><mn id="alg1.l10.m1.2.3.3.1.2.3.3" xref="alg1.l10.m1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l10.m1.2.3.3.1.3" xref="alg1.l10.m1.2.3.3.1.3.cmml">m</mi></msubsup><mrow id="alg1.l10.m1.2.3.3.2" xref="alg1.l10.m1.2.3.3.2.cmml"><mfrac id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml"><mrow id="alg1.l10.m1.1.1.1.1" xref="alg1.l10.m1.1.1.1.2.cmml"><mo id="alg1.l10.m1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.2.1.cmml">|</mo><msub id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="alg1.l10.m1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l10.m1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="alg1.l10.m1.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.cmml"><mo id="alg1.l10.m1.2.2.2.3.1" xref="alg1.l10.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.2.2.2.1" xref="alg1.l10.m1.2.2.2.1.cmml">𝒟</mi><mo id="alg1.l10.m1.2.2.2.3.2" xref="alg1.l10.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.3.3.2.1" xref="alg1.l10.m1.2.3.3.2.1.cmml">​</mo><msubsup id="alg1.l10.m1.2.3.3.2.2" xref="alg1.l10.m1.2.3.3.2.2.cmml"><mi id="alg1.l10.m1.2.3.3.2.2.2.2" xref="alg1.l10.m1.2.3.3.2.2.2.2.cmml">w</mi><mi id="alg1.l10.m1.2.3.3.2.2.2.3" xref="alg1.l10.m1.2.3.3.2.2.2.3.cmml">i</mi><mrow id="alg1.l10.m1.2.3.3.2.2.3" xref="alg1.l10.m1.2.3.3.2.2.3.cmml"><mi id="alg1.l10.m1.2.3.3.2.2.3.2" xref="alg1.l10.m1.2.3.3.2.2.3.2.cmml">t</mi><mo id="alg1.l10.m1.2.3.3.2.2.3.1" xref="alg1.l10.m1.2.3.3.2.2.3.1.cmml">+</mo><mn id="alg1.l10.m1.2.3.3.2.2.3.3" xref="alg1.l10.m1.2.3.3.2.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><apply id="alg1.l10.m1.2.3.cmml" xref="alg1.l10.m1.2.3"><ci id="alg1.l10.m1.2.3.1.cmml" xref="alg1.l10.m1.2.3.1">←</ci><apply id="alg1.l10.m1.2.3.2.cmml" xref="alg1.l10.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.3.2.1.cmml" xref="alg1.l10.m1.2.3.2">superscript</csymbol><ci id="alg1.l10.m1.2.3.2.2.cmml" xref="alg1.l10.m1.2.3.2.2">𝑤</ci><apply id="alg1.l10.m1.2.3.2.3.cmml" xref="alg1.l10.m1.2.3.2.3"><plus id="alg1.l10.m1.2.3.2.3.1.cmml" xref="alg1.l10.m1.2.3.2.3.1"></plus><ci id="alg1.l10.m1.2.3.2.3.2.cmml" xref="alg1.l10.m1.2.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l10.m1.2.3.2.3.3.cmml" xref="alg1.l10.m1.2.3.2.3.3">1</cn></apply></apply><apply id="alg1.l10.m1.2.3.3.cmml" xref="alg1.l10.m1.2.3.3"><apply id="alg1.l10.m1.2.3.3.1.cmml" xref="alg1.l10.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l10.m1.2.3.3.1.1.cmml" xref="alg1.l10.m1.2.3.3.1">superscript</csymbol><apply id="alg1.l10.m1.2.3.3.1.2.cmml" xref="alg1.l10.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l10.m1.2.3.3.1.2.1.cmml" xref="alg1.l10.m1.2.3.3.1">subscript</csymbol><sum id="alg1.l10.m1.2.3.3.1.2.2.cmml" xref="alg1.l10.m1.2.3.3.1.2.2"></sum><apply id="alg1.l10.m1.2.3.3.1.2.3.cmml" xref="alg1.l10.m1.2.3.3.1.2.3"><eq id="alg1.l10.m1.2.3.3.1.2.3.1.cmml" xref="alg1.l10.m1.2.3.3.1.2.3.1"></eq><ci id="alg1.l10.m1.2.3.3.1.2.3.2.cmml" xref="alg1.l10.m1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.l10.m1.2.3.3.1.2.3.3.cmml" xref="alg1.l10.m1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l10.m1.2.3.3.1.3.cmml" xref="alg1.l10.m1.2.3.3.1.3">𝑚</ci></apply><apply id="alg1.l10.m1.2.3.3.2.cmml" xref="alg1.l10.m1.2.3.3.2"><times id="alg1.l10.m1.2.3.3.2.1.cmml" xref="alg1.l10.m1.2.3.3.2.1"></times><apply id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2"><divide id="alg1.l10.m1.2.2.3.cmml" xref="alg1.l10.m1.2.2"></divide><apply id="alg1.l10.m1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1"><abs id="alg1.l10.m1.1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.2"></abs><apply id="alg1.l10.m1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.2">𝒟</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg1.l10.m1.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.3"><abs id="alg1.l10.m1.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.3.1"></abs><ci id="alg1.l10.m1.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="alg1.l10.m1.2.3.3.2.2.cmml" xref="alg1.l10.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.3.3.2.2.1.cmml" xref="alg1.l10.m1.2.3.3.2.2">superscript</csymbol><apply id="alg1.l10.m1.2.3.3.2.2.2.cmml" xref="alg1.l10.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.3.3.2.2.2.1.cmml" xref="alg1.l10.m1.2.3.3.2.2">subscript</csymbol><ci id="alg1.l10.m1.2.3.3.2.2.2.2.cmml" xref="alg1.l10.m1.2.3.3.2.2.2.2">𝑤</ci><ci id="alg1.l10.m1.2.3.3.2.2.2.3.cmml" xref="alg1.l10.m1.2.3.3.2.2.2.3">𝑖</ci></apply><apply id="alg1.l10.m1.2.3.3.2.2.3.cmml" xref="alg1.l10.m1.2.3.3.2.2.3"><plus id="alg1.l10.m1.2.3.3.2.2.3.1.cmml" xref="alg1.l10.m1.2.3.3.2.2.3.1"></plus><ci id="alg1.l10.m1.2.3.3.2.2.3.2.cmml" xref="alg1.l10.m1.2.3.3.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l10.m1.2.3.3.2.2.3.3.cmml" xref="alg1.l10.m1.2.3.3.2.2.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">w^{t+1}\leftarrow\sum_{i=1}^{m}\frac{\left|\mathcal{D}_{i}\right|}{\left|\mathcal{D}\right|}w_{i}^{t+1}</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>  <span id="alg1.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>  reture <math id="alg1.l12.m1.1" class="ltx_Math" alttext="w^{T}" display="inline"><semantics id="alg1.l12.m1.1a"><msup id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">w</mi><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">superscript</csymbol><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑤</ci><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">w^{T}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>  <span id="alg1.l13.1" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">ClientLocalTraining</span>(<math id="alg1.l13.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l13.m1.1a"><mi id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">i</annotation></semantics></math>, <math id="alg1.l13.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l13.m2.1a"><mi id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><ci id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">t</annotation></semantics></math>, <math id="alg1.l13.m3.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="alg1.l13.m3.1a"><msup id="alg1.l13.m3.1.1" xref="alg1.l13.m3.1.1.cmml"><mi id="alg1.l13.m3.1.1.2" xref="alg1.l13.m3.1.1.2.cmml">w</mi><mi id="alg1.l13.m3.1.1.3" xref="alg1.l13.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l13.m3.1b"><apply id="alg1.l13.m3.1.1.cmml" xref="alg1.l13.m3.1.1"><csymbol cd="ambiguous" id="alg1.l13.m3.1.1.1.cmml" xref="alg1.l13.m3.1.1">superscript</csymbol><ci id="alg1.l13.m3.1.1.2.cmml" xref="alg1.l13.m3.1.1.2">𝑤</ci><ci id="alg1.l13.m3.1.1.3.cmml" xref="alg1.l13.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m3.1c">w^{t}</annotation></semantics></math>, <math id="alg1.l13.m4.1" class="ltx_Math" alttext="c^{t}" display="inline"><semantics id="alg1.l13.m4.1a"><msup id="alg1.l13.m4.1.1" xref="alg1.l13.m4.1.1.cmml"><mi id="alg1.l13.m4.1.1.2" xref="alg1.l13.m4.1.1.2.cmml">c</mi><mi id="alg1.l13.m4.1.1.3" xref="alg1.l13.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l13.m4.1b"><apply id="alg1.l13.m4.1.1.cmml" xref="alg1.l13.m4.1.1"><csymbol cd="ambiguous" id="alg1.l13.m4.1.1.1.cmml" xref="alg1.l13.m4.1.1">superscript</csymbol><ci id="alg1.l13.m4.1.1.2.cmml" xref="alg1.l13.m4.1.1.2">𝑐</ci><ci id="alg1.l13.m4.1.1.3.cmml" xref="alg1.l13.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m4.1c">c^{t}</annotation></semantics></math>)<span id="alg1.l13.2" class="ltx_text ltx_font_bold">:</span>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>  <math id="alg1.l14.m1.2" class="ltx_Math" alttext="(w_{e_{i}}^{t},w_{c_{i}}^{t})\leftarrow w^{t}" display="inline"><semantics id="alg1.l14.m1.2a"><mrow id="alg1.l14.m1.2.2" xref="alg1.l14.m1.2.2.cmml"><mrow id="alg1.l14.m1.2.2.2.2" xref="alg1.l14.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l14.m1.2.2.2.2.3" xref="alg1.l14.m1.2.2.2.3.cmml">(</mo><msubsup id="alg1.l14.m1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.2.2" xref="alg1.l14.m1.1.1.1.1.1.2.2.cmml">w</mi><msub id="alg1.l14.m1.1.1.1.1.1.2.3" xref="alg1.l14.m1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.2.3.2" xref="alg1.l14.m1.1.1.1.1.1.2.3.2.cmml">e</mi><mi id="alg1.l14.m1.1.1.1.1.1.2.3.3" xref="alg1.l14.m1.1.1.1.1.1.2.3.3.cmml">i</mi></msub><mi id="alg1.l14.m1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="alg1.l14.m1.2.2.2.2.4" xref="alg1.l14.m1.2.2.2.3.cmml">,</mo><msubsup id="alg1.l14.m1.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.2.cmml"><mi id="alg1.l14.m1.2.2.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.2.2.2.cmml">w</mi><msub id="alg1.l14.m1.2.2.2.2.2.2.3" xref="alg1.l14.m1.2.2.2.2.2.2.3.cmml"><mi id="alg1.l14.m1.2.2.2.2.2.2.3.2" xref="alg1.l14.m1.2.2.2.2.2.2.3.2.cmml">c</mi><mi id="alg1.l14.m1.2.2.2.2.2.2.3.3" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.cmml">i</mi></msub><mi id="alg1.l14.m1.2.2.2.2.2.3" xref="alg1.l14.m1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l14.m1.2.2.2.2.5" xref="alg1.l14.m1.2.2.2.3.cmml">)</mo></mrow><mo stretchy="false" id="alg1.l14.m1.2.2.3" xref="alg1.l14.m1.2.2.3.cmml">←</mo><msup id="alg1.l14.m1.2.2.4" xref="alg1.l14.m1.2.2.4.cmml"><mi id="alg1.l14.m1.2.2.4.2" xref="alg1.l14.m1.2.2.4.2.cmml">w</mi><mi id="alg1.l14.m1.2.2.4.3" xref="alg1.l14.m1.2.2.4.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.2b"><apply id="alg1.l14.m1.2.2.cmml" xref="alg1.l14.m1.2.2"><ci id="alg1.l14.m1.2.2.3.cmml" xref="alg1.l14.m1.2.2.3">←</ci><interval closure="open" id="alg1.l14.m1.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2"><apply id="alg1.l14.m1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l14.m1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.2.2">𝑤</ci><apply id="alg1.l14.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.2.3.2">𝑒</ci><ci id="alg1.l14.m1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="alg1.l14.m1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l14.m1.2.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l14.m1.2.2.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l14.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.2">𝑤</ci><apply id="alg1.l14.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="alg1.l14.m1.2.2.2.2.2.2.3.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3.2">𝑐</ci><ci id="alg1.l14.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3.3">𝑖</ci></apply></apply><ci id="alg1.l14.m1.2.2.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2.2.3">𝑡</ci></apply></interval><apply id="alg1.l14.m1.2.2.4.cmml" xref="alg1.l14.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.4.1.cmml" xref="alg1.l14.m1.2.2.4">superscript</csymbol><ci id="alg1.l14.m1.2.2.4.2.cmml" xref="alg1.l14.m1.2.2.4.2">𝑤</ci><ci id="alg1.l14.m1.2.2.4.3.cmml" xref="alg1.l14.m1.2.2.4.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.2c">(w_{e_{i}}^{t},w_{c_{i}}^{t})\leftarrow w^{t}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>  <span id="alg1.l15.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l15.m1.4" class="ltx_Math" alttext="epoch=1,2,...,E" display="inline"><semantics id="alg1.l15.m1.4a"><mrow id="alg1.l15.m1.4.5" xref="alg1.l15.m1.4.5.cmml"><mrow id="alg1.l15.m1.4.5.2" xref="alg1.l15.m1.4.5.2.cmml"><mi id="alg1.l15.m1.4.5.2.2" xref="alg1.l15.m1.4.5.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.5.2.1" xref="alg1.l15.m1.4.5.2.1.cmml">​</mo><mi id="alg1.l15.m1.4.5.2.3" xref="alg1.l15.m1.4.5.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.5.2.1a" xref="alg1.l15.m1.4.5.2.1.cmml">​</mo><mi id="alg1.l15.m1.4.5.2.4" xref="alg1.l15.m1.4.5.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.5.2.1b" xref="alg1.l15.m1.4.5.2.1.cmml">​</mo><mi id="alg1.l15.m1.4.5.2.5" xref="alg1.l15.m1.4.5.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.4.5.2.1c" xref="alg1.l15.m1.4.5.2.1.cmml">​</mo><mi id="alg1.l15.m1.4.5.2.6" xref="alg1.l15.m1.4.5.2.6.cmml">h</mi></mrow><mo id="alg1.l15.m1.4.5.1" xref="alg1.l15.m1.4.5.1.cmml">=</mo><mrow id="alg1.l15.m1.4.5.3.2" xref="alg1.l15.m1.4.5.3.1.cmml"><mn id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">1</mn><mo id="alg1.l15.m1.4.5.3.2.1" xref="alg1.l15.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l15.m1.2.2" xref="alg1.l15.m1.2.2.cmml">2</mn><mo id="alg1.l15.m1.4.5.3.2.2" xref="alg1.l15.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l15.m1.3.3" xref="alg1.l15.m1.3.3.cmml">…</mi><mo id="alg1.l15.m1.4.5.3.2.3" xref="alg1.l15.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l15.m1.4.4" xref="alg1.l15.m1.4.4.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.4b"><apply id="alg1.l15.m1.4.5.cmml" xref="alg1.l15.m1.4.5"><eq id="alg1.l15.m1.4.5.1.cmml" xref="alg1.l15.m1.4.5.1"></eq><apply id="alg1.l15.m1.4.5.2.cmml" xref="alg1.l15.m1.4.5.2"><times id="alg1.l15.m1.4.5.2.1.cmml" xref="alg1.l15.m1.4.5.2.1"></times><ci id="alg1.l15.m1.4.5.2.2.cmml" xref="alg1.l15.m1.4.5.2.2">𝑒</ci><ci id="alg1.l15.m1.4.5.2.3.cmml" xref="alg1.l15.m1.4.5.2.3">𝑝</ci><ci id="alg1.l15.m1.4.5.2.4.cmml" xref="alg1.l15.m1.4.5.2.4">𝑜</ci><ci id="alg1.l15.m1.4.5.2.5.cmml" xref="alg1.l15.m1.4.5.2.5">𝑐</ci><ci id="alg1.l15.m1.4.5.2.6.cmml" xref="alg1.l15.m1.4.5.2.6">ℎ</ci></apply><list id="alg1.l15.m1.4.5.3.1.cmml" xref="alg1.l15.m1.4.5.3.2"><cn type="integer" id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">1</cn><cn type="integer" id="alg1.l15.m1.2.2.cmml" xref="alg1.l15.m1.2.2">2</cn><ci id="alg1.l15.m1.3.3.cmml" xref="alg1.l15.m1.3.3">…</ci><ci id="alg1.l15.m1.4.4.cmml" xref="alg1.l15.m1.4.4">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.4c">epoch=1,2,...,E</annotation></semantics></math> <span id="alg1.l15.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>     <span id="alg1.l16.1" class="ltx_text ltx_font_bold">for</span> each batch <math id="alg1.l16.m1.2" class="ltx_Math" alttext="\textbf{b}=\{x_{j},y_{j}\}" display="inline"><semantics id="alg1.l16.m1.2a"><mrow id="alg1.l16.m1.2.2" xref="alg1.l16.m1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l16.m1.2.2.4" xref="alg1.l16.m1.2.2.4a.cmml">b</mtext><mo id="alg1.l16.m1.2.2.3" xref="alg1.l16.m1.2.2.3.cmml">=</mo><mrow id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l16.m1.2.2.2.2.3" xref="alg1.l16.m1.2.2.2.3.cmml">{</mo><msub id="alg1.l16.m1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.l16.m1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg1.l16.m1.2.2.2.2.4" xref="alg1.l16.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l16.m1.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.cmml"><mi id="alg1.l16.m1.2.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.2.cmml">y</mi><mi id="alg1.l16.m1.2.2.2.2.2.3" xref="alg1.l16.m1.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="alg1.l16.m1.2.2.2.2.5" xref="alg1.l16.m1.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.2.cmml" xref="alg1.l16.m1.2.2"><eq id="alg1.l16.m1.2.2.3.cmml" xref="alg1.l16.m1.2.2.3"></eq><ci id="alg1.l16.m1.2.2.4a.cmml" xref="alg1.l16.m1.2.2.4"><mtext class="ltx_mathvariant_bold" id="alg1.l16.m1.2.2.4.cmml" xref="alg1.l16.m1.2.2.4">b</mtext></ci><set id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2"><apply id="alg1.l16.m1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.l16.m1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l16.m1.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.2.2.1.cmml" xref="alg1.l16.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l16.m1.2.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2.2">𝑦</ci><ci id="alg1.l16.m1.2.2.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2.2.3">𝑗</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">\textbf{b}=\{x_{j},y_{j}\}</annotation></semantics></math> of <math id="alg1.l16.m2.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="alg1.l16.m2.1a"><msub id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m2.1.1.2" xref="alg1.l16.m2.1.1.2.cmml">𝒟</mi><mi id="alg1.l16.m2.1.1.3" xref="alg1.l16.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><apply id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m2.1.1.1.cmml" xref="alg1.l16.m2.1.1">subscript</csymbol><ci id="alg1.l16.m2.1.1.2.cmml" xref="alg1.l16.m2.1.1.2">𝒟</ci><ci id="alg1.l16.m2.1.1.3.cmml" xref="alg1.l16.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">\mathcal{D}_{i}</annotation></semantics></math> <span id="alg1.l16.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>        <math id="alg1.l17.m1.2" class="ltx_Math" alttext="z_{j}\leftarrow f_{e}(w_{e_{i}}^{t};x_{j})" display="inline"><semantics id="alg1.l17.m1.2a"><mrow id="alg1.l17.m1.2.2" xref="alg1.l17.m1.2.2.cmml"><msub id="alg1.l17.m1.2.2.4" xref="alg1.l17.m1.2.2.4.cmml"><mi id="alg1.l17.m1.2.2.4.2" xref="alg1.l17.m1.2.2.4.2.cmml">z</mi><mi id="alg1.l17.m1.2.2.4.3" xref="alg1.l17.m1.2.2.4.3.cmml">j</mi></msub><mo stretchy="false" id="alg1.l17.m1.2.2.3" xref="alg1.l17.m1.2.2.3.cmml">←</mo><mrow id="alg1.l17.m1.2.2.2" xref="alg1.l17.m1.2.2.2.cmml"><msub id="alg1.l17.m1.2.2.2.4" xref="alg1.l17.m1.2.2.2.4.cmml"><mi id="alg1.l17.m1.2.2.2.4.2" xref="alg1.l17.m1.2.2.2.4.2.cmml">f</mi><mi id="alg1.l17.m1.2.2.2.4.3" xref="alg1.l17.m1.2.2.2.4.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l17.m1.2.2.2.3" xref="alg1.l17.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l17.m1.2.2.2.2.2" xref="alg1.l17.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l17.m1.2.2.2.2.2.3" xref="alg1.l17.m1.2.2.2.2.3.cmml">(</mo><msubsup id="alg1.l17.m1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.2.2" xref="alg1.l17.m1.1.1.1.1.1.1.2.2.cmml">w</mi><msub id="alg1.l17.m1.1.1.1.1.1.1.2.3" xref="alg1.l17.m1.1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.2.3.2" xref="alg1.l17.m1.1.1.1.1.1.1.2.3.2.cmml">e</mi><mi id="alg1.l17.m1.1.1.1.1.1.1.2.3.3" xref="alg1.l17.m1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub><mi id="alg1.l17.m1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="alg1.l17.m1.2.2.2.2.2.4" xref="alg1.l17.m1.2.2.2.2.3.cmml">;</mo><msub id="alg1.l17.m1.2.2.2.2.2.2" xref="alg1.l17.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l17.m1.2.2.2.2.2.2.2" xref="alg1.l17.m1.2.2.2.2.2.2.2.cmml">x</mi><mi id="alg1.l17.m1.2.2.2.2.2.2.3" xref="alg1.l17.m1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="alg1.l17.m1.2.2.2.2.2.5" xref="alg1.l17.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.2b"><apply id="alg1.l17.m1.2.2.cmml" xref="alg1.l17.m1.2.2"><ci id="alg1.l17.m1.2.2.3.cmml" xref="alg1.l17.m1.2.2.3">←</ci><apply id="alg1.l17.m1.2.2.4.cmml" xref="alg1.l17.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.4.1.cmml" xref="alg1.l17.m1.2.2.4">subscript</csymbol><ci id="alg1.l17.m1.2.2.4.2.cmml" xref="alg1.l17.m1.2.2.4.2">𝑧</ci><ci id="alg1.l17.m1.2.2.4.3.cmml" xref="alg1.l17.m1.2.2.4.3">𝑗</ci></apply><apply id="alg1.l17.m1.2.2.2.cmml" xref="alg1.l17.m1.2.2.2"><times id="alg1.l17.m1.2.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.3"></times><apply id="alg1.l17.m1.2.2.2.4.cmml" xref="alg1.l17.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.4.1.cmml" xref="alg1.l17.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l17.m1.2.2.2.4.2.cmml" xref="alg1.l17.m1.2.2.2.4.2">𝑓</ci><ci id="alg1.l17.m1.2.2.2.4.3.cmml" xref="alg1.l17.m1.2.2.2.4.3">𝑒</ci></apply><list id="alg1.l17.m1.2.2.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.2.2"><apply id="alg1.l17.m1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l17.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2.2">𝑤</ci><apply id="alg1.l17.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2.3.2">𝑒</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="alg1.l17.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l17.m1.2.2.2.2.2.2.cmml" xref="alg1.l17.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l17.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l17.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l17.m1.2.2.2.2.2.2.2">𝑥</ci><ci id="alg1.l17.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.2.2.2.3">𝑗</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.2c">z_{j}\leftarrow f_{e}(w_{e_{i}}^{t};x_{j})</annotation></semantics></math>

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>        <math id="alg1.l18.m1.12" class="ltx_Math" alttext="\ell_{gpc}\leftarrow-\log\frac{\exp(sim(z_{j},c_{i,k}^{t}))}{\exp(sim(z_{j},c_{i,k}^{t}))+\sum_{k^{\prime}}\exp(sim(z_{j},c_{i,k^{\prime}}^{t}))}" display="inline"><semantics id="alg1.l18.m1.12a"><mrow id="alg1.l18.m1.12.13" xref="alg1.l18.m1.12.13.cmml"><msub id="alg1.l18.m1.12.13.2" xref="alg1.l18.m1.12.13.2.cmml"><mi mathvariant="normal" id="alg1.l18.m1.12.13.2.2" xref="alg1.l18.m1.12.13.2.2.cmml">ℓ</mi><mrow id="alg1.l18.m1.12.13.2.3" xref="alg1.l18.m1.12.13.2.3.cmml"><mi id="alg1.l18.m1.12.13.2.3.2" xref="alg1.l18.m1.12.13.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.12.13.2.3.1" xref="alg1.l18.m1.12.13.2.3.1.cmml">​</mo><mi id="alg1.l18.m1.12.13.2.3.3" xref="alg1.l18.m1.12.13.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.12.13.2.3.1a" xref="alg1.l18.m1.12.13.2.3.1.cmml">​</mo><mi id="alg1.l18.m1.12.13.2.3.4" xref="alg1.l18.m1.12.13.2.3.4.cmml">c</mi></mrow></msub><mo stretchy="false" id="alg1.l18.m1.12.13.1" xref="alg1.l18.m1.12.13.1.cmml">←</mo><mrow id="alg1.l18.m1.12.13.3" xref="alg1.l18.m1.12.13.3.cmml"><mo rspace="0.167em" id="alg1.l18.m1.12.13.3a" xref="alg1.l18.m1.12.13.3.cmml">−</mo><mrow id="alg1.l18.m1.12.13.3.2" xref="alg1.l18.m1.12.13.3.2.cmml"><mi id="alg1.l18.m1.12.13.3.2.1" xref="alg1.l18.m1.12.13.3.2.1.cmml">log</mi><mo lspace="0.167em" id="alg1.l18.m1.12.13.3.2a" xref="alg1.l18.m1.12.13.3.2.cmml">⁡</mo><mfrac id="alg1.l18.m1.12.12" xref="alg1.l18.m1.12.12.cmml"><mrow id="alg1.l18.m1.4.4.4.4" xref="alg1.l18.m1.4.4.4.5.cmml"><mi id="alg1.l18.m1.3.3.3.3" xref="alg1.l18.m1.3.3.3.3.cmml">exp</mi><mo id="alg1.l18.m1.4.4.4.4a" xref="alg1.l18.m1.4.4.4.5.cmml">⁡</mo><mrow id="alg1.l18.m1.4.4.4.4.1" xref="alg1.l18.m1.4.4.4.5.cmml"><mo stretchy="false" id="alg1.l18.m1.4.4.4.4.1.2" xref="alg1.l18.m1.4.4.4.5.cmml">(</mo><mrow id="alg1.l18.m1.4.4.4.4.1.1" xref="alg1.l18.m1.4.4.4.4.1.1.cmml"><mi id="alg1.l18.m1.4.4.4.4.1.1.4" xref="alg1.l18.m1.4.4.4.4.1.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.4.4.4.4.1.1.3" xref="alg1.l18.m1.4.4.4.4.1.1.3.cmml">​</mo><mi id="alg1.l18.m1.4.4.4.4.1.1.5" xref="alg1.l18.m1.4.4.4.4.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.4.4.4.4.1.1.3a" xref="alg1.l18.m1.4.4.4.4.1.1.3.cmml">​</mo><mi id="alg1.l18.m1.4.4.4.4.1.1.6" xref="alg1.l18.m1.4.4.4.4.1.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.4.4.4.4.1.1.3b" xref="alg1.l18.m1.4.4.4.4.1.1.3.cmml">​</mo><mrow id="alg1.l18.m1.4.4.4.4.1.1.2.2" xref="alg1.l18.m1.4.4.4.4.1.1.2.3.cmml"><mo stretchy="false" id="alg1.l18.m1.4.4.4.4.1.1.2.2.3" xref="alg1.l18.m1.4.4.4.4.1.1.2.3.cmml">(</mo><msub id="alg1.l18.m1.4.4.4.4.1.1.1.1.1" xref="alg1.l18.m1.4.4.4.4.1.1.1.1.1.cmml"><mi id="alg1.l18.m1.4.4.4.4.1.1.1.1.1.2" xref="alg1.l18.m1.4.4.4.4.1.1.1.1.1.2.cmml">z</mi><mi id="alg1.l18.m1.4.4.4.4.1.1.1.1.1.3" xref="alg1.l18.m1.4.4.4.4.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg1.l18.m1.4.4.4.4.1.1.2.2.4" xref="alg1.l18.m1.4.4.4.4.1.1.2.3.cmml">,</mo><msubsup id="alg1.l18.m1.4.4.4.4.1.1.2.2.2" xref="alg1.l18.m1.4.4.4.4.1.1.2.2.2.cmml"><mi id="alg1.l18.m1.4.4.4.4.1.1.2.2.2.2.2" xref="alg1.l18.m1.4.4.4.4.1.1.2.2.2.2.2.cmml">c</mi><mrow id="alg1.l18.m1.2.2.2.2.2.4" xref="alg1.l18.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.cmml">i</mi><mo id="alg1.l18.m1.2.2.2.2.2.4.1" xref="alg1.l18.m1.2.2.2.2.2.3.cmml">,</mo><mi id="alg1.l18.m1.2.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.2.cmml">k</mi></mrow><mi id="alg1.l18.m1.4.4.4.4.1.1.2.2.2.3" xref="alg1.l18.m1.4.4.4.4.1.1.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l18.m1.4.4.4.4.1.1.2.2.5" xref="alg1.l18.m1.4.4.4.4.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l18.m1.4.4.4.4.1.3" xref="alg1.l18.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="alg1.l18.m1.12.12.12" xref="alg1.l18.m1.12.12.12.cmml"><mrow id="alg1.l18.m1.11.11.11.7.1" xref="alg1.l18.m1.11.11.11.7.2.cmml"><mi id="alg1.l18.m1.9.9.9.5" xref="alg1.l18.m1.9.9.9.5.cmml">exp</mi><mo id="alg1.l18.m1.11.11.11.7.1a" xref="alg1.l18.m1.11.11.11.7.2.cmml">⁡</mo><mrow id="alg1.l18.m1.11.11.11.7.1.1" xref="alg1.l18.m1.11.11.11.7.2.cmml"><mo stretchy="false" id="alg1.l18.m1.11.11.11.7.1.1.2" xref="alg1.l18.m1.11.11.11.7.2.cmml">(</mo><mrow id="alg1.l18.m1.11.11.11.7.1.1.1" xref="alg1.l18.m1.11.11.11.7.1.1.1.cmml"><mi id="alg1.l18.m1.11.11.11.7.1.1.1.4" xref="alg1.l18.m1.11.11.11.7.1.1.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.11.11.11.7.1.1.1.3" xref="alg1.l18.m1.11.11.11.7.1.1.1.3.cmml">​</mo><mi id="alg1.l18.m1.11.11.11.7.1.1.1.5" xref="alg1.l18.m1.11.11.11.7.1.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.11.11.11.7.1.1.1.3a" xref="alg1.l18.m1.11.11.11.7.1.1.1.3.cmml">​</mo><mi id="alg1.l18.m1.11.11.11.7.1.1.1.6" xref="alg1.l18.m1.11.11.11.7.1.1.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.11.11.11.7.1.1.1.3b" xref="alg1.l18.m1.11.11.11.7.1.1.1.3.cmml">​</mo><mrow id="alg1.l18.m1.11.11.11.7.1.1.1.2.2" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.3.cmml"><mo stretchy="false" id="alg1.l18.m1.11.11.11.7.1.1.1.2.2.3" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.3.cmml">(</mo><msub id="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1" xref="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1.cmml"><mi id="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1.2" xref="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1.2.cmml">z</mi><mi id="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1.3" xref="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg1.l18.m1.11.11.11.7.1.1.1.2.2.4" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.3.cmml">,</mo><msubsup id="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.cmml"><mi id="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.2.2" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.2.2.cmml">c</mi><mrow id="alg1.l18.m1.6.6.6.2.2.4" xref="alg1.l18.m1.6.6.6.2.2.3.cmml"><mi id="alg1.l18.m1.5.5.5.1.1.1" xref="alg1.l18.m1.5.5.5.1.1.1.cmml">i</mi><mo id="alg1.l18.m1.6.6.6.2.2.4.1" xref="alg1.l18.m1.6.6.6.2.2.3.cmml">,</mo><mi id="alg1.l18.m1.6.6.6.2.2.2" xref="alg1.l18.m1.6.6.6.2.2.2.cmml">k</mi></mrow><mi id="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.3" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l18.m1.11.11.11.7.1.1.1.2.2.5" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l18.m1.11.11.11.7.1.1.3" xref="alg1.l18.m1.11.11.11.7.2.cmml">)</mo></mrow></mrow><mo id="alg1.l18.m1.12.12.12.9" xref="alg1.l18.m1.12.12.12.9.cmml">+</mo><mrow id="alg1.l18.m1.12.12.12.8" xref="alg1.l18.m1.12.12.12.8.cmml"><mstyle displaystyle="false" id="alg1.l18.m1.12.12.12.8.2" xref="alg1.l18.m1.12.12.12.8.2.cmml"><msub id="alg1.l18.m1.12.12.12.8.2a" xref="alg1.l18.m1.12.12.12.8.2.cmml"><mo id="alg1.l18.m1.12.12.12.8.2.2" xref="alg1.l18.m1.12.12.12.8.2.2.cmml">∑</mo><msup id="alg1.l18.m1.12.12.12.8.2.3" xref="alg1.l18.m1.12.12.12.8.2.3.cmml"><mi id="alg1.l18.m1.12.12.12.8.2.3.2" xref="alg1.l18.m1.12.12.12.8.2.3.2.cmml">k</mi><mo id="alg1.l18.m1.12.12.12.8.2.3.3" xref="alg1.l18.m1.12.12.12.8.2.3.3.cmml">′</mo></msup></msub></mstyle><mrow id="alg1.l18.m1.12.12.12.8.1.1" xref="alg1.l18.m1.12.12.12.8.1.2.cmml"><mi id="alg1.l18.m1.10.10.10.6" xref="alg1.l18.m1.10.10.10.6.cmml">exp</mi><mo id="alg1.l18.m1.12.12.12.8.1.1a" xref="alg1.l18.m1.12.12.12.8.1.2.cmml">⁡</mo><mrow id="alg1.l18.m1.12.12.12.8.1.1.1" xref="alg1.l18.m1.12.12.12.8.1.2.cmml"><mo stretchy="false" id="alg1.l18.m1.12.12.12.8.1.1.1.2" xref="alg1.l18.m1.12.12.12.8.1.2.cmml">(</mo><mrow id="alg1.l18.m1.12.12.12.8.1.1.1.1" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.cmml"><mi id="alg1.l18.m1.12.12.12.8.1.1.1.1.4" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.12.12.12.8.1.1.1.1.3" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.3.cmml">​</mo><mi id="alg1.l18.m1.12.12.12.8.1.1.1.1.5" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.12.12.12.8.1.1.1.1.3a" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.3.cmml">​</mo><mi id="alg1.l18.m1.12.12.12.8.1.1.1.1.6" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.12.12.12.8.1.1.1.1.3b" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.3.cmml">​</mo><mrow id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.3.cmml"><mo stretchy="false" id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.3" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.3.cmml">(</mo><msub id="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1.cmml"><mi id="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1.2" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1.3" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.4" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.3.cmml">,</mo><msubsup id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.cmml"><mi id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.2.2" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.2.2.cmml">c</mi><mrow id="alg1.l18.m1.8.8.8.4.2.2" xref="alg1.l18.m1.8.8.8.4.2.3.cmml"><mi id="alg1.l18.m1.7.7.7.3.1.1" xref="alg1.l18.m1.7.7.7.3.1.1.cmml">i</mi><mo id="alg1.l18.m1.8.8.8.4.2.2.2" xref="alg1.l18.m1.8.8.8.4.2.3.cmml">,</mo><msup id="alg1.l18.m1.8.8.8.4.2.2.1" xref="alg1.l18.m1.8.8.8.4.2.2.1.cmml"><mi id="alg1.l18.m1.8.8.8.4.2.2.1.2" xref="alg1.l18.m1.8.8.8.4.2.2.1.2.cmml">k</mi><mo id="alg1.l18.m1.8.8.8.4.2.2.1.3" xref="alg1.l18.m1.8.8.8.4.2.2.1.3.cmml">′</mo></msup></mrow><mi id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.3" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.5" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l18.m1.12.12.12.8.1.1.1.3" xref="alg1.l18.m1.12.12.12.8.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.12b"><apply id="alg1.l18.m1.12.13.cmml" xref="alg1.l18.m1.12.13"><ci id="alg1.l18.m1.12.13.1.cmml" xref="alg1.l18.m1.12.13.1">←</ci><apply id="alg1.l18.m1.12.13.2.cmml" xref="alg1.l18.m1.12.13.2"><csymbol cd="ambiguous" id="alg1.l18.m1.12.13.2.1.cmml" xref="alg1.l18.m1.12.13.2">subscript</csymbol><ci id="alg1.l18.m1.12.13.2.2.cmml" xref="alg1.l18.m1.12.13.2.2">ℓ</ci><apply id="alg1.l18.m1.12.13.2.3.cmml" xref="alg1.l18.m1.12.13.2.3"><times id="alg1.l18.m1.12.13.2.3.1.cmml" xref="alg1.l18.m1.12.13.2.3.1"></times><ci id="alg1.l18.m1.12.13.2.3.2.cmml" xref="alg1.l18.m1.12.13.2.3.2">𝑔</ci><ci id="alg1.l18.m1.12.13.2.3.3.cmml" xref="alg1.l18.m1.12.13.2.3.3">𝑝</ci><ci id="alg1.l18.m1.12.13.2.3.4.cmml" xref="alg1.l18.m1.12.13.2.3.4">𝑐</ci></apply></apply><apply id="alg1.l18.m1.12.13.3.cmml" xref="alg1.l18.m1.12.13.3"><minus id="alg1.l18.m1.12.13.3.1.cmml" xref="alg1.l18.m1.12.13.3"></minus><apply id="alg1.l18.m1.12.13.3.2.cmml" xref="alg1.l18.m1.12.13.3.2"><log id="alg1.l18.m1.12.13.3.2.1.cmml" xref="alg1.l18.m1.12.13.3.2.1"></log><apply id="alg1.l18.m1.12.12.cmml" xref="alg1.l18.m1.12.12"><divide id="alg1.l18.m1.12.12.13.cmml" xref="alg1.l18.m1.12.12"></divide><apply id="alg1.l18.m1.4.4.4.5.cmml" xref="alg1.l18.m1.4.4.4.4"><exp id="alg1.l18.m1.3.3.3.3.cmml" xref="alg1.l18.m1.3.3.3.3"></exp><apply id="alg1.l18.m1.4.4.4.4.1.1.cmml" xref="alg1.l18.m1.4.4.4.4.1.1"><times id="alg1.l18.m1.4.4.4.4.1.1.3.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.3"></times><ci id="alg1.l18.m1.4.4.4.4.1.1.4.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.4">𝑠</ci><ci id="alg1.l18.m1.4.4.4.4.1.1.5.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.5">𝑖</ci><ci id="alg1.l18.m1.4.4.4.4.1.1.6.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.6">𝑚</ci><interval closure="open" id="alg1.l18.m1.4.4.4.4.1.1.2.3.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.2.2"><apply id="alg1.l18.m1.4.4.4.4.1.1.1.1.1.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.4.4.4.4.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.1.1.1">subscript</csymbol><ci id="alg1.l18.m1.4.4.4.4.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.1.1.1.2">𝑧</ci><ci id="alg1.l18.m1.4.4.4.4.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l18.m1.4.4.4.4.1.1.2.2.2.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.4.4.4.4.1.1.2.2.2.1.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.2.2.2">superscript</csymbol><apply id="alg1.l18.m1.4.4.4.4.1.1.2.2.2.2.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.4.4.4.4.1.1.2.2.2.2.1.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.2.2.2">subscript</csymbol><ci id="alg1.l18.m1.4.4.4.4.1.1.2.2.2.2.2.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.2.2.2.2.2">𝑐</ci><list id="alg1.l18.m1.2.2.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.2.4"><ci id="alg1.l18.m1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1">𝑖</ci><ci id="alg1.l18.m1.2.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.2.2">𝑘</ci></list></apply><ci id="alg1.l18.m1.4.4.4.4.1.1.2.2.2.3.cmml" xref="alg1.l18.m1.4.4.4.4.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply><apply id="alg1.l18.m1.12.12.12.cmml" xref="alg1.l18.m1.12.12.12"><plus id="alg1.l18.m1.12.12.12.9.cmml" xref="alg1.l18.m1.12.12.12.9"></plus><apply id="alg1.l18.m1.11.11.11.7.2.cmml" xref="alg1.l18.m1.11.11.11.7.1"><exp id="alg1.l18.m1.9.9.9.5.cmml" xref="alg1.l18.m1.9.9.9.5"></exp><apply id="alg1.l18.m1.11.11.11.7.1.1.1.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1"><times id="alg1.l18.m1.11.11.11.7.1.1.1.3.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.3"></times><ci id="alg1.l18.m1.11.11.11.7.1.1.1.4.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.4">𝑠</ci><ci id="alg1.l18.m1.11.11.11.7.1.1.1.5.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.5">𝑖</ci><ci id="alg1.l18.m1.11.11.11.7.1.1.1.6.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.6">𝑚</ci><interval closure="open" id="alg1.l18.m1.11.11.11.7.1.1.1.2.3.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.2"><apply id="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1.2">𝑧</ci><ci id="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.1.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2">superscript</csymbol><apply id="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.2.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.2.1.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.2.2.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.2.2">𝑐</ci><list id="alg1.l18.m1.6.6.6.2.2.3.cmml" xref="alg1.l18.m1.6.6.6.2.2.4"><ci id="alg1.l18.m1.5.5.5.1.1.1.cmml" xref="alg1.l18.m1.5.5.5.1.1.1">𝑖</ci><ci id="alg1.l18.m1.6.6.6.2.2.2.cmml" xref="alg1.l18.m1.6.6.6.2.2.2">𝑘</ci></list></apply><ci id="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.3.cmml" xref="alg1.l18.m1.11.11.11.7.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply><apply id="alg1.l18.m1.12.12.12.8.cmml" xref="alg1.l18.m1.12.12.12.8"><apply id="alg1.l18.m1.12.12.12.8.2.cmml" xref="alg1.l18.m1.12.12.12.8.2"><csymbol cd="ambiguous" id="alg1.l18.m1.12.12.12.8.2.1.cmml" xref="alg1.l18.m1.12.12.12.8.2">subscript</csymbol><sum id="alg1.l18.m1.12.12.12.8.2.2.cmml" xref="alg1.l18.m1.12.12.12.8.2.2"></sum><apply id="alg1.l18.m1.12.12.12.8.2.3.cmml" xref="alg1.l18.m1.12.12.12.8.2.3"><csymbol cd="ambiguous" id="alg1.l18.m1.12.12.12.8.2.3.1.cmml" xref="alg1.l18.m1.12.12.12.8.2.3">superscript</csymbol><ci id="alg1.l18.m1.12.12.12.8.2.3.2.cmml" xref="alg1.l18.m1.12.12.12.8.2.3.2">𝑘</ci><ci id="alg1.l18.m1.12.12.12.8.2.3.3.cmml" xref="alg1.l18.m1.12.12.12.8.2.3.3">′</ci></apply></apply><apply id="alg1.l18.m1.12.12.12.8.1.2.cmml" xref="alg1.l18.m1.12.12.12.8.1.1"><exp id="alg1.l18.m1.10.10.10.6.cmml" xref="alg1.l18.m1.10.10.10.6"></exp><apply id="alg1.l18.m1.12.12.12.8.1.1.1.1.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1"><times id="alg1.l18.m1.12.12.12.8.1.1.1.1.3.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.3"></times><ci id="alg1.l18.m1.12.12.12.8.1.1.1.1.4.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.4">𝑠</ci><ci id="alg1.l18.m1.12.12.12.8.1.1.1.1.5.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.5">𝑖</ci><ci id="alg1.l18.m1.12.12.12.8.1.1.1.1.6.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.6">𝑚</ci><interval closure="open" id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.3.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2"><apply id="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1.2">𝑧</ci><ci id="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.1.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2">superscript</csymbol><apply id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.2.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.2.2">𝑐</ci><list id="alg1.l18.m1.8.8.8.4.2.3.cmml" xref="alg1.l18.m1.8.8.8.4.2.2"><ci id="alg1.l18.m1.7.7.7.3.1.1.cmml" xref="alg1.l18.m1.7.7.7.3.1.1">𝑖</ci><apply id="alg1.l18.m1.8.8.8.4.2.2.1.cmml" xref="alg1.l18.m1.8.8.8.4.2.2.1"><csymbol cd="ambiguous" id="alg1.l18.m1.8.8.8.4.2.2.1.1.cmml" xref="alg1.l18.m1.8.8.8.4.2.2.1">superscript</csymbol><ci id="alg1.l18.m1.8.8.8.4.2.2.1.2.cmml" xref="alg1.l18.m1.8.8.8.4.2.2.1.2">𝑘</ci><ci id="alg1.l18.m1.8.8.8.4.2.2.1.3.cmml" xref="alg1.l18.m1.8.8.8.4.2.2.1.3">′</ci></apply></list></apply><ci id="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.3.cmml" xref="alg1.l18.m1.12.12.12.8.1.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.12c">\ell_{gpc}\leftarrow-\log\frac{\exp(sim(z_{j},c_{i,k}^{t}))}{\exp(sim(z_{j},c_{i,k}^{t}))+\sum_{k^{\prime}}\exp(sim(z_{j},c_{i,k^{\prime}}^{t}))}</annotation></semantics></math>

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>        <math id="alg1.l19.m1.2" class="ltx_Math" alttext="s_{j}\leftarrow f_{c}(w_{c_{i}}^{t};z_{j})" display="inline"><semantics id="alg1.l19.m1.2a"><mrow id="alg1.l19.m1.2.2" xref="alg1.l19.m1.2.2.cmml"><msub id="alg1.l19.m1.2.2.4" xref="alg1.l19.m1.2.2.4.cmml"><mi id="alg1.l19.m1.2.2.4.2" xref="alg1.l19.m1.2.2.4.2.cmml">s</mi><mi id="alg1.l19.m1.2.2.4.3" xref="alg1.l19.m1.2.2.4.3.cmml">j</mi></msub><mo stretchy="false" id="alg1.l19.m1.2.2.3" xref="alg1.l19.m1.2.2.3.cmml">←</mo><mrow id="alg1.l19.m1.2.2.2" xref="alg1.l19.m1.2.2.2.cmml"><msub id="alg1.l19.m1.2.2.2.4" xref="alg1.l19.m1.2.2.2.4.cmml"><mi id="alg1.l19.m1.2.2.2.4.2" xref="alg1.l19.m1.2.2.2.4.2.cmml">f</mi><mi id="alg1.l19.m1.2.2.2.4.3" xref="alg1.l19.m1.2.2.2.4.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l19.m1.2.2.2.3" xref="alg1.l19.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l19.m1.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l19.m1.2.2.2.2.2.3" xref="alg1.l19.m1.2.2.2.2.3.cmml">(</mo><msubsup id="alg1.l19.m1.1.1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l19.m1.1.1.1.1.1.1.2.2" xref="alg1.l19.m1.1.1.1.1.1.1.2.2.cmml">w</mi><msub id="alg1.l19.m1.1.1.1.1.1.1.2.3" xref="alg1.l19.m1.1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l19.m1.1.1.1.1.1.1.2.3.2" xref="alg1.l19.m1.1.1.1.1.1.1.2.3.2.cmml">c</mi><mi id="alg1.l19.m1.1.1.1.1.1.1.2.3.3" xref="alg1.l19.m1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub><mi id="alg1.l19.m1.1.1.1.1.1.1.3" xref="alg1.l19.m1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="alg1.l19.m1.2.2.2.2.2.4" xref="alg1.l19.m1.2.2.2.2.3.cmml">;</mo><msub id="alg1.l19.m1.2.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l19.m1.2.2.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.2.2.2.cmml">z</mi><mi id="alg1.l19.m1.2.2.2.2.2.2.3" xref="alg1.l19.m1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="alg1.l19.m1.2.2.2.2.2.5" xref="alg1.l19.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.2b"><apply id="alg1.l19.m1.2.2.cmml" xref="alg1.l19.m1.2.2"><ci id="alg1.l19.m1.2.2.3.cmml" xref="alg1.l19.m1.2.2.3">←</ci><apply id="alg1.l19.m1.2.2.4.cmml" xref="alg1.l19.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.4.1.cmml" xref="alg1.l19.m1.2.2.4">subscript</csymbol><ci id="alg1.l19.m1.2.2.4.2.cmml" xref="alg1.l19.m1.2.2.4.2">𝑠</ci><ci id="alg1.l19.m1.2.2.4.3.cmml" xref="alg1.l19.m1.2.2.4.3">𝑗</ci></apply><apply id="alg1.l19.m1.2.2.2.cmml" xref="alg1.l19.m1.2.2.2"><times id="alg1.l19.m1.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.3"></times><apply id="alg1.l19.m1.2.2.2.4.cmml" xref="alg1.l19.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.2.4.1.cmml" xref="alg1.l19.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l19.m1.2.2.2.4.2.cmml" xref="alg1.l19.m1.2.2.2.4.2">𝑓</ci><ci id="alg1.l19.m1.2.2.2.4.3.cmml" xref="alg1.l19.m1.2.2.2.4.3">𝑐</ci></apply><list id="alg1.l19.m1.2.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2.2"><apply id="alg1.l19.m1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l19.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2.2">𝑤</ci><apply id="alg1.l19.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2.3.2">𝑐</ci><ci id="alg1.l19.m1.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="alg1.l19.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l19.m1.2.2.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l19.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l19.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2.2.2.2">𝑧</ci><ci id="alg1.l19.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2.2.2.3">𝑗</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.2c">s_{j}\leftarrow f_{c}(w_{c_{i}}^{t};z_{j})</annotation></semantics></math>

</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>        <math id="alg1.l20.m1.2" class="ltx_Math" alttext="\ell_{ce}\leftarrow CrossEntropyLoss(y_{j},s_{j})" display="inline"><semantics id="alg1.l20.m1.2a"><mrow id="alg1.l20.m1.2.2" xref="alg1.l20.m1.2.2.cmml"><msub id="alg1.l20.m1.2.2.4" xref="alg1.l20.m1.2.2.4.cmml"><mi mathvariant="normal" id="alg1.l20.m1.2.2.4.2" xref="alg1.l20.m1.2.2.4.2.cmml">ℓ</mi><mrow id="alg1.l20.m1.2.2.4.3" xref="alg1.l20.m1.2.2.4.3.cmml"><mi id="alg1.l20.m1.2.2.4.3.2" xref="alg1.l20.m1.2.2.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.4.3.1" xref="alg1.l20.m1.2.2.4.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.2.4.3.3" xref="alg1.l20.m1.2.2.4.3.3.cmml">e</mi></mrow></msub><mo stretchy="false" id="alg1.l20.m1.2.2.3" xref="alg1.l20.m1.2.2.3.cmml">←</mo><mrow id="alg1.l20.m1.2.2.2" xref="alg1.l20.m1.2.2.2.cmml"><mi id="alg1.l20.m1.2.2.2.4" xref="alg1.l20.m1.2.2.2.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.5" xref="alg1.l20.m1.2.2.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3a" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.6" xref="alg1.l20.m1.2.2.2.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3b" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.7" xref="alg1.l20.m1.2.2.2.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3c" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.8" xref="alg1.l20.m1.2.2.2.8.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3d" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.9" xref="alg1.l20.m1.2.2.2.9.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3e" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.10" xref="alg1.l20.m1.2.2.2.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3f" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.11" xref="alg1.l20.m1.2.2.2.11.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3g" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.12" xref="alg1.l20.m1.2.2.2.12.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3h" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.13" xref="alg1.l20.m1.2.2.2.13.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3i" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.14" xref="alg1.l20.m1.2.2.2.14.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3j" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.15" xref="alg1.l20.m1.2.2.2.15.cmml">y</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3k" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.16" xref="alg1.l20.m1.2.2.2.16.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3l" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.17" xref="alg1.l20.m1.2.2.2.17.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3m" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.18" xref="alg1.l20.m1.2.2.2.18.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3n" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l20.m1.2.2.2.19" xref="alg1.l20.m1.2.2.2.19.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.2.2.3o" xref="alg1.l20.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l20.m1.2.2.2.2.2" xref="alg1.l20.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l20.m1.2.2.2.2.2.3" xref="alg1.l20.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l20.m1.1.1.1.1.1.1" xref="alg1.l20.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l20.m1.1.1.1.1.1.1.2" xref="alg1.l20.m1.1.1.1.1.1.1.2.cmml">y</mi><mi id="alg1.l20.m1.1.1.1.1.1.1.3" xref="alg1.l20.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg1.l20.m1.2.2.2.2.2.4" xref="alg1.l20.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l20.m1.2.2.2.2.2.2" xref="alg1.l20.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l20.m1.2.2.2.2.2.2.2" xref="alg1.l20.m1.2.2.2.2.2.2.2.cmml">s</mi><mi id="alg1.l20.m1.2.2.2.2.2.2.3" xref="alg1.l20.m1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="alg1.l20.m1.2.2.2.2.2.5" xref="alg1.l20.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.2b"><apply id="alg1.l20.m1.2.2.cmml" xref="alg1.l20.m1.2.2"><ci id="alg1.l20.m1.2.2.3.cmml" xref="alg1.l20.m1.2.2.3">←</ci><apply id="alg1.l20.m1.2.2.4.cmml" xref="alg1.l20.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l20.m1.2.2.4.1.cmml" xref="alg1.l20.m1.2.2.4">subscript</csymbol><ci id="alg1.l20.m1.2.2.4.2.cmml" xref="alg1.l20.m1.2.2.4.2">ℓ</ci><apply id="alg1.l20.m1.2.2.4.3.cmml" xref="alg1.l20.m1.2.2.4.3"><times id="alg1.l20.m1.2.2.4.3.1.cmml" xref="alg1.l20.m1.2.2.4.3.1"></times><ci id="alg1.l20.m1.2.2.4.3.2.cmml" xref="alg1.l20.m1.2.2.4.3.2">𝑐</ci><ci id="alg1.l20.m1.2.2.4.3.3.cmml" xref="alg1.l20.m1.2.2.4.3.3">𝑒</ci></apply></apply><apply id="alg1.l20.m1.2.2.2.cmml" xref="alg1.l20.m1.2.2.2"><times id="alg1.l20.m1.2.2.2.3.cmml" xref="alg1.l20.m1.2.2.2.3"></times><ci id="alg1.l20.m1.2.2.2.4.cmml" xref="alg1.l20.m1.2.2.2.4">𝐶</ci><ci id="alg1.l20.m1.2.2.2.5.cmml" xref="alg1.l20.m1.2.2.2.5">𝑟</ci><ci id="alg1.l20.m1.2.2.2.6.cmml" xref="alg1.l20.m1.2.2.2.6">𝑜</ci><ci id="alg1.l20.m1.2.2.2.7.cmml" xref="alg1.l20.m1.2.2.2.7">𝑠</ci><ci id="alg1.l20.m1.2.2.2.8.cmml" xref="alg1.l20.m1.2.2.2.8">𝑠</ci><ci id="alg1.l20.m1.2.2.2.9.cmml" xref="alg1.l20.m1.2.2.2.9">𝐸</ci><ci id="alg1.l20.m1.2.2.2.10.cmml" xref="alg1.l20.m1.2.2.2.10">𝑛</ci><ci id="alg1.l20.m1.2.2.2.11.cmml" xref="alg1.l20.m1.2.2.2.11">𝑡</ci><ci id="alg1.l20.m1.2.2.2.12.cmml" xref="alg1.l20.m1.2.2.2.12">𝑟</ci><ci id="alg1.l20.m1.2.2.2.13.cmml" xref="alg1.l20.m1.2.2.2.13">𝑜</ci><ci id="alg1.l20.m1.2.2.2.14.cmml" xref="alg1.l20.m1.2.2.2.14">𝑝</ci><ci id="alg1.l20.m1.2.2.2.15.cmml" xref="alg1.l20.m1.2.2.2.15">𝑦</ci><ci id="alg1.l20.m1.2.2.2.16.cmml" xref="alg1.l20.m1.2.2.2.16">𝐿</ci><ci id="alg1.l20.m1.2.2.2.17.cmml" xref="alg1.l20.m1.2.2.2.17">𝑜</ci><ci id="alg1.l20.m1.2.2.2.18.cmml" xref="alg1.l20.m1.2.2.2.18">𝑠</ci><ci id="alg1.l20.m1.2.2.2.19.cmml" xref="alg1.l20.m1.2.2.2.19">𝑠</ci><interval closure="open" id="alg1.l20.m1.2.2.2.2.3.cmml" xref="alg1.l20.m1.2.2.2.2.2"><apply id="alg1.l20.m1.1.1.1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l20.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l20.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="alg1.l20.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l20.m1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l20.m1.2.2.2.2.2.2.cmml" xref="alg1.l20.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l20.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l20.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l20.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l20.m1.2.2.2.2.2.2.2">𝑠</ci><ci id="alg1.l20.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l20.m1.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.2c">\ell_{ce}\leftarrow CrossEntropyLoss(y_{j},s_{j})</annotation></semantics></math>

</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span>        <math id="alg1.l21.m1.1" class="ltx_Math" alttext="\alpha\leftarrow 1-\frac{t}{T}" display="inline"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml">α</mi><mo stretchy="false" id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml">←</mo><mrow id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml"><mn id="alg1.l21.m1.1.1.3.2" xref="alg1.l21.m1.1.1.3.2.cmml">1</mn><mo id="alg1.l21.m1.1.1.3.1" xref="alg1.l21.m1.1.1.3.1.cmml">−</mo><mfrac id="alg1.l21.m1.1.1.3.3" xref="alg1.l21.m1.1.1.3.3.cmml"><mi id="alg1.l21.m1.1.1.3.3.2" xref="alg1.l21.m1.1.1.3.3.2.cmml">t</mi><mi id="alg1.l21.m1.1.1.3.3.3" xref="alg1.l21.m1.1.1.3.3.3.cmml">T</mi></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><ci id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1">←</ci><ci id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">𝛼</ci><apply id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3"><minus id="alg1.l21.m1.1.1.3.1.cmml" xref="alg1.l21.m1.1.1.3.1"></minus><cn type="integer" id="alg1.l21.m1.1.1.3.2.cmml" xref="alg1.l21.m1.1.1.3.2">1</cn><apply id="alg1.l21.m1.1.1.3.3.cmml" xref="alg1.l21.m1.1.1.3.3"><divide id="alg1.l21.m1.1.1.3.3.1.cmml" xref="alg1.l21.m1.1.1.3.3"></divide><ci id="alg1.l21.m1.1.1.3.3.2.cmml" xref="alg1.l21.m1.1.1.3.3.2">𝑡</ci><ci id="alg1.l21.m1.1.1.3.3.3.cmml" xref="alg1.l21.m1.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">\alpha\leftarrow 1-\frac{t}{T}</annotation></semantics></math>

</div>
<div id="alg1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22:</span>        <math id="alg1.l22.m1.1" class="ltx_Math" alttext="\ell\leftarrow\alpha\cdot\ell_{gpc}+(1-\alpha)\cdot\ell_{ce}" display="inline"><semantics id="alg1.l22.m1.1a"><mrow id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><mi mathvariant="normal" id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml">ℓ</mi><mo stretchy="false" id="alg1.l22.m1.1.1.2" xref="alg1.l22.m1.1.1.2.cmml">←</mo><mrow id="alg1.l22.m1.1.1.1" xref="alg1.l22.m1.1.1.1.cmml"><mrow id="alg1.l22.m1.1.1.1.3" xref="alg1.l22.m1.1.1.1.3.cmml"><mi id="alg1.l22.m1.1.1.1.3.2" xref="alg1.l22.m1.1.1.1.3.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l22.m1.1.1.1.3.1" xref="alg1.l22.m1.1.1.1.3.1.cmml">⋅</mo><msub id="alg1.l22.m1.1.1.1.3.3" xref="alg1.l22.m1.1.1.1.3.3.cmml"><mi mathvariant="normal" id="alg1.l22.m1.1.1.1.3.3.2" xref="alg1.l22.m1.1.1.1.3.3.2.cmml">ℓ</mi><mrow id="alg1.l22.m1.1.1.1.3.3.3" xref="alg1.l22.m1.1.1.1.3.3.3.cmml"><mi id="alg1.l22.m1.1.1.1.3.3.3.2" xref="alg1.l22.m1.1.1.1.3.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.1.1.1.3.3.3.1" xref="alg1.l22.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="alg1.l22.m1.1.1.1.3.3.3.3" xref="alg1.l22.m1.1.1.1.3.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.1.1.1.3.3.3.1a" xref="alg1.l22.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="alg1.l22.m1.1.1.1.3.3.3.4" xref="alg1.l22.m1.1.1.1.3.3.3.4.cmml">c</mi></mrow></msub></mrow><mo id="alg1.l22.m1.1.1.1.2" xref="alg1.l22.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l22.m1.1.1.1.1" xref="alg1.l22.m1.1.1.1.1.cmml"><mrow id="alg1.l22.m1.1.1.1.1.1.1" xref="alg1.l22.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l22.m1.1.1.1.1.1.1.2" xref="alg1.l22.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l22.m1.1.1.1.1.1.1.1" xref="alg1.l22.m1.1.1.1.1.1.1.1.cmml"><mn id="alg1.l22.m1.1.1.1.1.1.1.1.2" xref="alg1.l22.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l22.m1.1.1.1.1.1.1.1.1" xref="alg1.l22.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l22.m1.1.1.1.1.1.1.1.3" xref="alg1.l22.m1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo rspace="0.055em" stretchy="false" id="alg1.l22.m1.1.1.1.1.1.1.3" xref="alg1.l22.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="alg1.l22.m1.1.1.1.1.2" xref="alg1.l22.m1.1.1.1.1.2.cmml">⋅</mo><msub id="alg1.l22.m1.1.1.1.1.3" xref="alg1.l22.m1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="alg1.l22.m1.1.1.1.1.3.2" xref="alg1.l22.m1.1.1.1.1.3.2.cmml">ℓ</mi><mrow id="alg1.l22.m1.1.1.1.1.3.3" xref="alg1.l22.m1.1.1.1.1.3.3.cmml"><mi id="alg1.l22.m1.1.1.1.1.3.3.2" xref="alg1.l22.m1.1.1.1.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.1.1.1.1.3.3.1" xref="alg1.l22.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l22.m1.1.1.1.1.3.3.3" xref="alg1.l22.m1.1.1.1.1.3.3.3.cmml">e</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><ci id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1.2">←</ci><ci id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3">ℓ</ci><apply id="alg1.l22.m1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1"><plus id="alg1.l22.m1.1.1.1.2.cmml" xref="alg1.l22.m1.1.1.1.2"></plus><apply id="alg1.l22.m1.1.1.1.3.cmml" xref="alg1.l22.m1.1.1.1.3"><ci id="alg1.l22.m1.1.1.1.3.1.cmml" xref="alg1.l22.m1.1.1.1.3.1">⋅</ci><ci id="alg1.l22.m1.1.1.1.3.2.cmml" xref="alg1.l22.m1.1.1.1.3.2">𝛼</ci><apply id="alg1.l22.m1.1.1.1.3.3.cmml" xref="alg1.l22.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.1.3.3.1.cmml" xref="alg1.l22.m1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l22.m1.1.1.1.3.3.2.cmml" xref="alg1.l22.m1.1.1.1.3.3.2">ℓ</ci><apply id="alg1.l22.m1.1.1.1.3.3.3.cmml" xref="alg1.l22.m1.1.1.1.3.3.3"><times id="alg1.l22.m1.1.1.1.3.3.3.1.cmml" xref="alg1.l22.m1.1.1.1.3.3.3.1"></times><ci id="alg1.l22.m1.1.1.1.3.3.3.2.cmml" xref="alg1.l22.m1.1.1.1.3.3.3.2">𝑔</ci><ci id="alg1.l22.m1.1.1.1.3.3.3.3.cmml" xref="alg1.l22.m1.1.1.1.3.3.3.3">𝑝</ci><ci id="alg1.l22.m1.1.1.1.3.3.3.4.cmml" xref="alg1.l22.m1.1.1.1.3.3.3.4">𝑐</ci></apply></apply></apply><apply id="alg1.l22.m1.1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1.1"><ci id="alg1.l22.m1.1.1.1.1.2.cmml" xref="alg1.l22.m1.1.1.1.1.2">⋅</ci><apply id="alg1.l22.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1.1.1.1"><minus id="alg1.l22.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg1.l22.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.1.2">1</cn><ci id="alg1.l22.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="alg1.l22.m1.1.1.1.1.3.cmml" xref="alg1.l22.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.1.1.3.1.cmml" xref="alg1.l22.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l22.m1.1.1.1.1.3.2.cmml" xref="alg1.l22.m1.1.1.1.1.3.2">ℓ</ci><apply id="alg1.l22.m1.1.1.1.1.3.3.cmml" xref="alg1.l22.m1.1.1.1.1.3.3"><times id="alg1.l22.m1.1.1.1.1.3.3.1.cmml" xref="alg1.l22.m1.1.1.1.1.3.3.1"></times><ci id="alg1.l22.m1.1.1.1.1.3.3.2.cmml" xref="alg1.l22.m1.1.1.1.1.3.3.2">𝑐</ci><ci id="alg1.l22.m1.1.1.1.1.3.3.3.cmml" xref="alg1.l22.m1.1.1.1.1.3.3.3">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">\ell\leftarrow\alpha\cdot\ell_{gpc}+(1-\alpha)\cdot\ell_{ce}</annotation></semantics></math>

</div>
<div id="alg1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23:</span>        <math id="alg1.l23.m1.1" class="ltx_Math" alttext="w_{i}^{t+1}\leftarrow w_{i}^{t}-\eta\nabla\ell" display="inline"><semantics id="alg1.l23.m1.1a"><mrow id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml"><msubsup id="alg1.l23.m1.1.1.2" xref="alg1.l23.m1.1.1.2.cmml"><mi id="alg1.l23.m1.1.1.2.2.2" xref="alg1.l23.m1.1.1.2.2.2.cmml">w</mi><mi id="alg1.l23.m1.1.1.2.2.3" xref="alg1.l23.m1.1.1.2.2.3.cmml">i</mi><mrow id="alg1.l23.m1.1.1.2.3" xref="alg1.l23.m1.1.1.2.3.cmml"><mi id="alg1.l23.m1.1.1.2.3.2" xref="alg1.l23.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l23.m1.1.1.2.3.1" xref="alg1.l23.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l23.m1.1.1.2.3.3" xref="alg1.l23.m1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.l23.m1.1.1.1" xref="alg1.l23.m1.1.1.1.cmml">←</mo><mrow id="alg1.l23.m1.1.1.3" xref="alg1.l23.m1.1.1.3.cmml"><msubsup id="alg1.l23.m1.1.1.3.2" xref="alg1.l23.m1.1.1.3.2.cmml"><mi id="alg1.l23.m1.1.1.3.2.2.2" xref="alg1.l23.m1.1.1.3.2.2.2.cmml">w</mi><mi id="alg1.l23.m1.1.1.3.2.2.3" xref="alg1.l23.m1.1.1.3.2.2.3.cmml">i</mi><mi id="alg1.l23.m1.1.1.3.2.3" xref="alg1.l23.m1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="alg1.l23.m1.1.1.3.1" xref="alg1.l23.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l23.m1.1.1.3.3" xref="alg1.l23.m1.1.1.3.3.cmml"><mi id="alg1.l23.m1.1.1.3.3.2" xref="alg1.l23.m1.1.1.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l23.m1.1.1.3.3.1" xref="alg1.l23.m1.1.1.3.3.1.cmml">​</mo><mrow id="alg1.l23.m1.1.1.3.3.3" xref="alg1.l23.m1.1.1.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l23.m1.1.1.3.3.3.1" xref="alg1.l23.m1.1.1.3.3.3.1.cmml">∇</mo><mi mathvariant="normal" id="alg1.l23.m1.1.1.3.3.3.2" xref="alg1.l23.m1.1.1.3.3.3.2.cmml">ℓ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><apply id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1"><ci id="alg1.l23.m1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1">←</ci><apply id="alg1.l23.m1.1.1.2.cmml" xref="alg1.l23.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.2.1.cmml" xref="alg1.l23.m1.1.1.2">superscript</csymbol><apply id="alg1.l23.m1.1.1.2.2.cmml" xref="alg1.l23.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.2.2.1.cmml" xref="alg1.l23.m1.1.1.2">subscript</csymbol><ci id="alg1.l23.m1.1.1.2.2.2.cmml" xref="alg1.l23.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l23.m1.1.1.2.2.3.cmml" xref="alg1.l23.m1.1.1.2.2.3">𝑖</ci></apply><apply id="alg1.l23.m1.1.1.2.3.cmml" xref="alg1.l23.m1.1.1.2.3"><plus id="alg1.l23.m1.1.1.2.3.1.cmml" xref="alg1.l23.m1.1.1.2.3.1"></plus><ci id="alg1.l23.m1.1.1.2.3.2.cmml" xref="alg1.l23.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l23.m1.1.1.2.3.3.cmml" xref="alg1.l23.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l23.m1.1.1.3.cmml" xref="alg1.l23.m1.1.1.3"><minus id="alg1.l23.m1.1.1.3.1.cmml" xref="alg1.l23.m1.1.1.3.1"></minus><apply id="alg1.l23.m1.1.1.3.2.cmml" xref="alg1.l23.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.3.2.1.cmml" xref="alg1.l23.m1.1.1.3.2">superscript</csymbol><apply id="alg1.l23.m1.1.1.3.2.2.cmml" xref="alg1.l23.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.3.2.2.1.cmml" xref="alg1.l23.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l23.m1.1.1.3.2.2.2.cmml" xref="alg1.l23.m1.1.1.3.2.2.2">𝑤</ci><ci id="alg1.l23.m1.1.1.3.2.2.3.cmml" xref="alg1.l23.m1.1.1.3.2.2.3">𝑖</ci></apply><ci id="alg1.l23.m1.1.1.3.2.3.cmml" xref="alg1.l23.m1.1.1.3.2.3">𝑡</ci></apply><apply id="alg1.l23.m1.1.1.3.3.cmml" xref="alg1.l23.m1.1.1.3.3"><times id="alg1.l23.m1.1.1.3.3.1.cmml" xref="alg1.l23.m1.1.1.3.3.1"></times><ci id="alg1.l23.m1.1.1.3.3.2.cmml" xref="alg1.l23.m1.1.1.3.3.2">𝜂</ci><apply id="alg1.l23.m1.1.1.3.3.3.cmml" xref="alg1.l23.m1.1.1.3.3.3"><ci id="alg1.l23.m1.1.1.3.3.3.1.cmml" xref="alg1.l23.m1.1.1.3.3.3.1">∇</ci><ci id="alg1.l23.m1.1.1.3.3.3.2.cmml" xref="alg1.l23.m1.1.1.3.3.3.2">ℓ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">w_{i}^{t+1}\leftarrow w_{i}^{t}-\eta\nabla\ell</annotation></semantics></math>

</div>
<div id="alg1.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24:</span>     <span id="alg1.l24.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l24.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25:</span>  <span id="alg1.l25.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l25.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26:</span>  <math id="alg1.l26.m1.2" class="ltx_Math" alttext="(w_{e_{i}}^{t+1},w_{c_{i}}^{t+1})\leftarrow w_{i}^{t+1}" display="inline"><semantics id="alg1.l26.m1.2a"><mrow id="alg1.l26.m1.2.2" xref="alg1.l26.m1.2.2.cmml"><mrow id="alg1.l26.m1.2.2.2.2" xref="alg1.l26.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l26.m1.2.2.2.2.3" xref="alg1.l26.m1.2.2.2.3.cmml">(</mo><msubsup id="alg1.l26.m1.1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.1.cmml"><mi id="alg1.l26.m1.1.1.1.1.1.2.2" xref="alg1.l26.m1.1.1.1.1.1.2.2.cmml">w</mi><msub id="alg1.l26.m1.1.1.1.1.1.2.3" xref="alg1.l26.m1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l26.m1.1.1.1.1.1.2.3.2" xref="alg1.l26.m1.1.1.1.1.1.2.3.2.cmml">e</mi><mi id="alg1.l26.m1.1.1.1.1.1.2.3.3" xref="alg1.l26.m1.1.1.1.1.1.2.3.3.cmml">i</mi></msub><mrow id="alg1.l26.m1.1.1.1.1.1.3" xref="alg1.l26.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l26.m1.1.1.1.1.1.3.2" xref="alg1.l26.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l26.m1.1.1.1.1.1.3.1" xref="alg1.l26.m1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l26.m1.1.1.1.1.1.3.3" xref="alg1.l26.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l26.m1.2.2.2.2.4" xref="alg1.l26.m1.2.2.2.3.cmml">,</mo><msubsup id="alg1.l26.m1.2.2.2.2.2" xref="alg1.l26.m1.2.2.2.2.2.cmml"><mi id="alg1.l26.m1.2.2.2.2.2.2.2" xref="alg1.l26.m1.2.2.2.2.2.2.2.cmml">w</mi><msub id="alg1.l26.m1.2.2.2.2.2.2.3" xref="alg1.l26.m1.2.2.2.2.2.2.3.cmml"><mi id="alg1.l26.m1.2.2.2.2.2.2.3.2" xref="alg1.l26.m1.2.2.2.2.2.2.3.2.cmml">c</mi><mi id="alg1.l26.m1.2.2.2.2.2.2.3.3" xref="alg1.l26.m1.2.2.2.2.2.2.3.3.cmml">i</mi></msub><mrow id="alg1.l26.m1.2.2.2.2.2.3" xref="alg1.l26.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l26.m1.2.2.2.2.2.3.2" xref="alg1.l26.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l26.m1.2.2.2.2.2.3.1" xref="alg1.l26.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="alg1.l26.m1.2.2.2.2.2.3.3" xref="alg1.l26.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.l26.m1.2.2.2.2.5" xref="alg1.l26.m1.2.2.2.3.cmml">)</mo></mrow><mo stretchy="false" id="alg1.l26.m1.2.2.3" xref="alg1.l26.m1.2.2.3.cmml">←</mo><msubsup id="alg1.l26.m1.2.2.4" xref="alg1.l26.m1.2.2.4.cmml"><mi id="alg1.l26.m1.2.2.4.2.2" xref="alg1.l26.m1.2.2.4.2.2.cmml">w</mi><mi id="alg1.l26.m1.2.2.4.2.3" xref="alg1.l26.m1.2.2.4.2.3.cmml">i</mi><mrow id="alg1.l26.m1.2.2.4.3" xref="alg1.l26.m1.2.2.4.3.cmml"><mi id="alg1.l26.m1.2.2.4.3.2" xref="alg1.l26.m1.2.2.4.3.2.cmml">t</mi><mo id="alg1.l26.m1.2.2.4.3.1" xref="alg1.l26.m1.2.2.4.3.1.cmml">+</mo><mn id="alg1.l26.m1.2.2.4.3.3" xref="alg1.l26.m1.2.2.4.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.2b"><apply id="alg1.l26.m1.2.2.cmml" xref="alg1.l26.m1.2.2"><ci id="alg1.l26.m1.2.2.3.cmml" xref="alg1.l26.m1.2.2.3">←</ci><interval closure="open" id="alg1.l26.m1.2.2.2.3.cmml" xref="alg1.l26.m1.2.2.2.2"><apply id="alg1.l26.m1.1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l26.m1.1.1.1.1.1.2.cmml" xref="alg1.l26.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l26.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l26.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l26.m1.1.1.1.1.1.2.2">𝑤</ci><apply id="alg1.l26.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l26.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l26.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="alg1.l26.m1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l26.m1.1.1.1.1.1.2.3.2">𝑒</ci><ci id="alg1.l26.m1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l26.m1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l26.m1.1.1.1.1.1.3.cmml" xref="alg1.l26.m1.1.1.1.1.1.3"><plus id="alg1.l26.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l26.m1.1.1.1.1.1.3.1"></plus><ci id="alg1.l26.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l26.m1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l26.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l26.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l26.m1.2.2.2.2.2.cmml" xref="alg1.l26.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l26.m1.2.2.2.2.2.1.cmml" xref="alg1.l26.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l26.m1.2.2.2.2.2.2.cmml" xref="alg1.l26.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l26.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l26.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l26.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l26.m1.2.2.2.2.2.2.2">𝑤</ci><apply id="alg1.l26.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l26.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l26.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.l26.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="alg1.l26.m1.2.2.2.2.2.2.3.2.cmml" xref="alg1.l26.m1.2.2.2.2.2.2.3.2">𝑐</ci><ci id="alg1.l26.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.l26.m1.2.2.2.2.2.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l26.m1.2.2.2.2.2.3.cmml" xref="alg1.l26.m1.2.2.2.2.2.3"><plus id="alg1.l26.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l26.m1.2.2.2.2.2.3.1"></plus><ci id="alg1.l26.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l26.m1.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l26.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l26.m1.2.2.2.2.2.3.3">1</cn></apply></apply></interval><apply id="alg1.l26.m1.2.2.4.cmml" xref="alg1.l26.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l26.m1.2.2.4.1.cmml" xref="alg1.l26.m1.2.2.4">superscript</csymbol><apply id="alg1.l26.m1.2.2.4.2.cmml" xref="alg1.l26.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l26.m1.2.2.4.2.1.cmml" xref="alg1.l26.m1.2.2.4">subscript</csymbol><ci id="alg1.l26.m1.2.2.4.2.2.cmml" xref="alg1.l26.m1.2.2.4.2.2">𝑤</ci><ci id="alg1.l26.m1.2.2.4.2.3.cmml" xref="alg1.l26.m1.2.2.4.2.3">𝑖</ci></apply><apply id="alg1.l26.m1.2.2.4.3.cmml" xref="alg1.l26.m1.2.2.4.3"><plus id="alg1.l26.m1.2.2.4.3.1.cmml" xref="alg1.l26.m1.2.2.4.3.1"></plus><ci id="alg1.l26.m1.2.2.4.3.2.cmml" xref="alg1.l26.m1.2.2.4.3.2">𝑡</ci><cn type="integer" id="alg1.l26.m1.2.2.4.3.3.cmml" xref="alg1.l26.m1.2.2.4.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.2c">(w_{e_{i}}^{t+1},w_{c_{i}}^{t+1})\leftarrow w_{i}^{t+1}</annotation></semantics></math>

</div>
<div id="alg1.l27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27:</span>  <span id="alg1.l27.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l27.m1.4" class="ltx_Math" alttext="k=1,2,...,K" display="inline"><semantics id="alg1.l27.m1.4a"><mrow id="alg1.l27.m1.4.5" xref="alg1.l27.m1.4.5.cmml"><mi id="alg1.l27.m1.4.5.2" xref="alg1.l27.m1.4.5.2.cmml">k</mi><mo id="alg1.l27.m1.4.5.1" xref="alg1.l27.m1.4.5.1.cmml">=</mo><mrow id="alg1.l27.m1.4.5.3.2" xref="alg1.l27.m1.4.5.3.1.cmml"><mn id="alg1.l27.m1.1.1" xref="alg1.l27.m1.1.1.cmml">1</mn><mo id="alg1.l27.m1.4.5.3.2.1" xref="alg1.l27.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l27.m1.2.2" xref="alg1.l27.m1.2.2.cmml">2</mn><mo id="alg1.l27.m1.4.5.3.2.2" xref="alg1.l27.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l27.m1.3.3" xref="alg1.l27.m1.3.3.cmml">…</mi><mo id="alg1.l27.m1.4.5.3.2.3" xref="alg1.l27.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l27.m1.4.4" xref="alg1.l27.m1.4.4.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l27.m1.4b"><apply id="alg1.l27.m1.4.5.cmml" xref="alg1.l27.m1.4.5"><eq id="alg1.l27.m1.4.5.1.cmml" xref="alg1.l27.m1.4.5.1"></eq><ci id="alg1.l27.m1.4.5.2.cmml" xref="alg1.l27.m1.4.5.2">𝑘</ci><list id="alg1.l27.m1.4.5.3.1.cmml" xref="alg1.l27.m1.4.5.3.2"><cn type="integer" id="alg1.l27.m1.1.1.cmml" xref="alg1.l27.m1.1.1">1</cn><cn type="integer" id="alg1.l27.m1.2.2.cmml" xref="alg1.l27.m1.2.2">2</cn><ci id="alg1.l27.m1.3.3.cmml" xref="alg1.l27.m1.3.3">…</ci><ci id="alg1.l27.m1.4.4.cmml" xref="alg1.l27.m1.4.4">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m1.4c">k=1,2,...,K</annotation></semantics></math> <span id="alg1.l27.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28:</span>     <math id="alg1.l28.m1.7" class="ltx_Math" alttext="c_{i,k}^{t+1}\leftarrow\frac{1}{\left|\mathcal{D}_{i}^{k}\right|}\sum_{(x_{j},y_{j})\in\mathcal{D}_{i}^{k}}f_{e}(w_{e_{i}}^{t+1};x_{j})" display="inline"><semantics id="alg1.l28.m1.7a"><mrow id="alg1.l28.m1.7.7" xref="alg1.l28.m1.7.7.cmml"><msubsup id="alg1.l28.m1.7.7.4" xref="alg1.l28.m1.7.7.4.cmml"><mi id="alg1.l28.m1.7.7.4.2.2" xref="alg1.l28.m1.7.7.4.2.2.cmml">c</mi><mrow id="alg1.l28.m1.2.2.2.4" xref="alg1.l28.m1.2.2.2.3.cmml"><mi id="alg1.l28.m1.1.1.1.1" xref="alg1.l28.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l28.m1.2.2.2.4.1" xref="alg1.l28.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l28.m1.2.2.2.2" xref="alg1.l28.m1.2.2.2.2.cmml">k</mi></mrow><mrow id="alg1.l28.m1.7.7.4.3" xref="alg1.l28.m1.7.7.4.3.cmml"><mi id="alg1.l28.m1.7.7.4.3.2" xref="alg1.l28.m1.7.7.4.3.2.cmml">t</mi><mo id="alg1.l28.m1.7.7.4.3.1" xref="alg1.l28.m1.7.7.4.3.1.cmml">+</mo><mn id="alg1.l28.m1.7.7.4.3.3" xref="alg1.l28.m1.7.7.4.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.l28.m1.7.7.3" xref="alg1.l28.m1.7.7.3.cmml">←</mo><mrow id="alg1.l28.m1.7.7.2" xref="alg1.l28.m1.7.7.2.cmml"><mfrac id="alg1.l28.m1.3.3" xref="alg1.l28.m1.3.3.cmml"><mn id="alg1.l28.m1.3.3.3" xref="alg1.l28.m1.3.3.3.cmml">1</mn><mrow id="alg1.l28.m1.3.3.1.1" xref="alg1.l28.m1.3.3.1.2.cmml"><mo id="alg1.l28.m1.3.3.1.1.2" xref="alg1.l28.m1.3.3.1.2.1.cmml">|</mo><msubsup id="alg1.l28.m1.3.3.1.1.1" xref="alg1.l28.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l28.m1.3.3.1.1.1.2.2" xref="alg1.l28.m1.3.3.1.1.1.2.2.cmml">𝒟</mi><mi id="alg1.l28.m1.3.3.1.1.1.2.3" xref="alg1.l28.m1.3.3.1.1.1.2.3.cmml">i</mi><mi id="alg1.l28.m1.3.3.1.1.1.3" xref="alg1.l28.m1.3.3.1.1.1.3.cmml">k</mi></msubsup><mo id="alg1.l28.m1.3.3.1.1.3" xref="alg1.l28.m1.3.3.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l28.m1.7.7.2.3" xref="alg1.l28.m1.7.7.2.3.cmml">​</mo><mrow id="alg1.l28.m1.7.7.2.2" xref="alg1.l28.m1.7.7.2.2.cmml"><msub id="alg1.l28.m1.7.7.2.2.3" xref="alg1.l28.m1.7.7.2.2.3.cmml"><mo id="alg1.l28.m1.7.7.2.2.3.2" xref="alg1.l28.m1.7.7.2.2.3.2.cmml">∑</mo><mrow id="alg1.l28.m1.5.5.2" xref="alg1.l28.m1.5.5.2.cmml"><mrow id="alg1.l28.m1.5.5.2.2.2" xref="alg1.l28.m1.5.5.2.2.3.cmml"><mo stretchy="false" id="alg1.l28.m1.5.5.2.2.2.3" xref="alg1.l28.m1.5.5.2.2.3.cmml">(</mo><msub id="alg1.l28.m1.4.4.1.1.1.1" xref="alg1.l28.m1.4.4.1.1.1.1.cmml"><mi id="alg1.l28.m1.4.4.1.1.1.1.2" xref="alg1.l28.m1.4.4.1.1.1.1.2.cmml">x</mi><mi id="alg1.l28.m1.4.4.1.1.1.1.3" xref="alg1.l28.m1.4.4.1.1.1.1.3.cmml">j</mi></msub><mo id="alg1.l28.m1.5.5.2.2.2.4" xref="alg1.l28.m1.5.5.2.2.3.cmml">,</mo><msub id="alg1.l28.m1.5.5.2.2.2.2" xref="alg1.l28.m1.5.5.2.2.2.2.cmml"><mi id="alg1.l28.m1.5.5.2.2.2.2.2" xref="alg1.l28.m1.5.5.2.2.2.2.2.cmml">y</mi><mi id="alg1.l28.m1.5.5.2.2.2.2.3" xref="alg1.l28.m1.5.5.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="alg1.l28.m1.5.5.2.2.2.5" xref="alg1.l28.m1.5.5.2.2.3.cmml">)</mo></mrow><mo id="alg1.l28.m1.5.5.2.3" xref="alg1.l28.m1.5.5.2.3.cmml">∈</mo><msubsup id="alg1.l28.m1.5.5.2.4" xref="alg1.l28.m1.5.5.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l28.m1.5.5.2.4.2.2" xref="alg1.l28.m1.5.5.2.4.2.2.cmml">𝒟</mi><mi id="alg1.l28.m1.5.5.2.4.2.3" xref="alg1.l28.m1.5.5.2.4.2.3.cmml">i</mi><mi id="alg1.l28.m1.5.5.2.4.3" xref="alg1.l28.m1.5.5.2.4.3.cmml">k</mi></msubsup></mrow></msub><mrow id="alg1.l28.m1.7.7.2.2.2" xref="alg1.l28.m1.7.7.2.2.2.cmml"><msub id="alg1.l28.m1.7.7.2.2.2.4" xref="alg1.l28.m1.7.7.2.2.2.4.cmml"><mi id="alg1.l28.m1.7.7.2.2.2.4.2" xref="alg1.l28.m1.7.7.2.2.2.4.2.cmml">f</mi><mi id="alg1.l28.m1.7.7.2.2.2.4.3" xref="alg1.l28.m1.7.7.2.2.2.4.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l28.m1.7.7.2.2.2.3" xref="alg1.l28.m1.7.7.2.2.2.3.cmml">​</mo><mrow id="alg1.l28.m1.7.7.2.2.2.2.2" xref="alg1.l28.m1.7.7.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l28.m1.7.7.2.2.2.2.2.3" xref="alg1.l28.m1.7.7.2.2.2.2.3.cmml">(</mo><msubsup id="alg1.l28.m1.6.6.1.1.1.1.1.1" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.cmml"><mi id="alg1.l28.m1.6.6.1.1.1.1.1.1.2.2" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.2.2.cmml">w</mi><msub id="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3.2" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3.2.cmml">e</mi><mi id="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3.3" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub><mrow id="alg1.l28.m1.6.6.1.1.1.1.1.1.3" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="alg1.l28.m1.6.6.1.1.1.1.1.1.3.2" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l28.m1.6.6.1.1.1.1.1.1.3.1" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l28.m1.6.6.1.1.1.1.1.1.3.3" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l28.m1.7.7.2.2.2.2.2.4" xref="alg1.l28.m1.7.7.2.2.2.2.3.cmml">;</mo><msub id="alg1.l28.m1.7.7.2.2.2.2.2.2" xref="alg1.l28.m1.7.7.2.2.2.2.2.2.cmml"><mi id="alg1.l28.m1.7.7.2.2.2.2.2.2.2" xref="alg1.l28.m1.7.7.2.2.2.2.2.2.2.cmml">x</mi><mi id="alg1.l28.m1.7.7.2.2.2.2.2.2.3" xref="alg1.l28.m1.7.7.2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="alg1.l28.m1.7.7.2.2.2.2.2.5" xref="alg1.l28.m1.7.7.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.7b"><apply id="alg1.l28.m1.7.7.cmml" xref="alg1.l28.m1.7.7"><ci id="alg1.l28.m1.7.7.3.cmml" xref="alg1.l28.m1.7.7.3">←</ci><apply id="alg1.l28.m1.7.7.4.cmml" xref="alg1.l28.m1.7.7.4"><csymbol cd="ambiguous" id="alg1.l28.m1.7.7.4.1.cmml" xref="alg1.l28.m1.7.7.4">superscript</csymbol><apply id="alg1.l28.m1.7.7.4.2.cmml" xref="alg1.l28.m1.7.7.4"><csymbol cd="ambiguous" id="alg1.l28.m1.7.7.4.2.1.cmml" xref="alg1.l28.m1.7.7.4">subscript</csymbol><ci id="alg1.l28.m1.7.7.4.2.2.cmml" xref="alg1.l28.m1.7.7.4.2.2">𝑐</ci><list id="alg1.l28.m1.2.2.2.3.cmml" xref="alg1.l28.m1.2.2.2.4"><ci id="alg1.l28.m1.1.1.1.1.cmml" xref="alg1.l28.m1.1.1.1.1">𝑖</ci><ci id="alg1.l28.m1.2.2.2.2.cmml" xref="alg1.l28.m1.2.2.2.2">𝑘</ci></list></apply><apply id="alg1.l28.m1.7.7.4.3.cmml" xref="alg1.l28.m1.7.7.4.3"><plus id="alg1.l28.m1.7.7.4.3.1.cmml" xref="alg1.l28.m1.7.7.4.3.1"></plus><ci id="alg1.l28.m1.7.7.4.3.2.cmml" xref="alg1.l28.m1.7.7.4.3.2">𝑡</ci><cn type="integer" id="alg1.l28.m1.7.7.4.3.3.cmml" xref="alg1.l28.m1.7.7.4.3.3">1</cn></apply></apply><apply id="alg1.l28.m1.7.7.2.cmml" xref="alg1.l28.m1.7.7.2"><times id="alg1.l28.m1.7.7.2.3.cmml" xref="alg1.l28.m1.7.7.2.3"></times><apply id="alg1.l28.m1.3.3.cmml" xref="alg1.l28.m1.3.3"><divide id="alg1.l28.m1.3.3.2.cmml" xref="alg1.l28.m1.3.3"></divide><cn type="integer" id="alg1.l28.m1.3.3.3.cmml" xref="alg1.l28.m1.3.3.3">1</cn><apply id="alg1.l28.m1.3.3.1.2.cmml" xref="alg1.l28.m1.3.3.1.1"><abs id="alg1.l28.m1.3.3.1.2.1.cmml" xref="alg1.l28.m1.3.3.1.1.2"></abs><apply id="alg1.l28.m1.3.3.1.1.1.cmml" xref="alg1.l28.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l28.m1.3.3.1.1.1.1.cmml" xref="alg1.l28.m1.3.3.1.1.1">superscript</csymbol><apply id="alg1.l28.m1.3.3.1.1.1.2.cmml" xref="alg1.l28.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l28.m1.3.3.1.1.1.2.1.cmml" xref="alg1.l28.m1.3.3.1.1.1">subscript</csymbol><ci id="alg1.l28.m1.3.3.1.1.1.2.2.cmml" xref="alg1.l28.m1.3.3.1.1.1.2.2">𝒟</ci><ci id="alg1.l28.m1.3.3.1.1.1.2.3.cmml" xref="alg1.l28.m1.3.3.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l28.m1.3.3.1.1.1.3.cmml" xref="alg1.l28.m1.3.3.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="alg1.l28.m1.7.7.2.2.cmml" xref="alg1.l28.m1.7.7.2.2"><apply id="alg1.l28.m1.7.7.2.2.3.cmml" xref="alg1.l28.m1.7.7.2.2.3"><csymbol cd="ambiguous" id="alg1.l28.m1.7.7.2.2.3.1.cmml" xref="alg1.l28.m1.7.7.2.2.3">subscript</csymbol><sum id="alg1.l28.m1.7.7.2.2.3.2.cmml" xref="alg1.l28.m1.7.7.2.2.3.2"></sum><apply id="alg1.l28.m1.5.5.2.cmml" xref="alg1.l28.m1.5.5.2"><in id="alg1.l28.m1.5.5.2.3.cmml" xref="alg1.l28.m1.5.5.2.3"></in><interval closure="open" id="alg1.l28.m1.5.5.2.2.3.cmml" xref="alg1.l28.m1.5.5.2.2.2"><apply id="alg1.l28.m1.4.4.1.1.1.1.cmml" xref="alg1.l28.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l28.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l28.m1.4.4.1.1.1.1">subscript</csymbol><ci id="alg1.l28.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l28.m1.4.4.1.1.1.1.2">𝑥</ci><ci id="alg1.l28.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l28.m1.4.4.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l28.m1.5.5.2.2.2.2.cmml" xref="alg1.l28.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l28.m1.5.5.2.2.2.2.1.cmml" xref="alg1.l28.m1.5.5.2.2.2.2">subscript</csymbol><ci id="alg1.l28.m1.5.5.2.2.2.2.2.cmml" xref="alg1.l28.m1.5.5.2.2.2.2.2">𝑦</ci><ci id="alg1.l28.m1.5.5.2.2.2.2.3.cmml" xref="alg1.l28.m1.5.5.2.2.2.2.3">𝑗</ci></apply></interval><apply id="alg1.l28.m1.5.5.2.4.cmml" xref="alg1.l28.m1.5.5.2.4"><csymbol cd="ambiguous" id="alg1.l28.m1.5.5.2.4.1.cmml" xref="alg1.l28.m1.5.5.2.4">superscript</csymbol><apply id="alg1.l28.m1.5.5.2.4.2.cmml" xref="alg1.l28.m1.5.5.2.4"><csymbol cd="ambiguous" id="alg1.l28.m1.5.5.2.4.2.1.cmml" xref="alg1.l28.m1.5.5.2.4">subscript</csymbol><ci id="alg1.l28.m1.5.5.2.4.2.2.cmml" xref="alg1.l28.m1.5.5.2.4.2.2">𝒟</ci><ci id="alg1.l28.m1.5.5.2.4.2.3.cmml" xref="alg1.l28.m1.5.5.2.4.2.3">𝑖</ci></apply><ci id="alg1.l28.m1.5.5.2.4.3.cmml" xref="alg1.l28.m1.5.5.2.4.3">𝑘</ci></apply></apply></apply><apply id="alg1.l28.m1.7.7.2.2.2.cmml" xref="alg1.l28.m1.7.7.2.2.2"><times id="alg1.l28.m1.7.7.2.2.2.3.cmml" xref="alg1.l28.m1.7.7.2.2.2.3"></times><apply id="alg1.l28.m1.7.7.2.2.2.4.cmml" xref="alg1.l28.m1.7.7.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l28.m1.7.7.2.2.2.4.1.cmml" xref="alg1.l28.m1.7.7.2.2.2.4">subscript</csymbol><ci id="alg1.l28.m1.7.7.2.2.2.4.2.cmml" xref="alg1.l28.m1.7.7.2.2.2.4.2">𝑓</ci><ci id="alg1.l28.m1.7.7.2.2.2.4.3.cmml" xref="alg1.l28.m1.7.7.2.2.2.4.3">𝑒</ci></apply><list id="alg1.l28.m1.7.7.2.2.2.2.3.cmml" xref="alg1.l28.m1.7.7.2.2.2.2.2"><apply id="alg1.l28.m1.6.6.1.1.1.1.1.1.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l28.m1.6.6.1.1.1.1.1.1.1.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l28.m1.6.6.1.1.1.1.1.1.2.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l28.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l28.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.2.2">𝑤</ci><apply id="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3.2">𝑒</ci><ci id="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l28.m1.6.6.1.1.1.1.1.1.3.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.3"><plus id="alg1.l28.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.3.1"></plus><ci id="alg1.l28.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l28.m1.6.6.1.1.1.1.1.1.3.3.cmml" xref="alg1.l28.m1.6.6.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l28.m1.7.7.2.2.2.2.2.2.cmml" xref="alg1.l28.m1.7.7.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l28.m1.7.7.2.2.2.2.2.2.1.cmml" xref="alg1.l28.m1.7.7.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l28.m1.7.7.2.2.2.2.2.2.2.cmml" xref="alg1.l28.m1.7.7.2.2.2.2.2.2.2">𝑥</ci><ci id="alg1.l28.m1.7.7.2.2.2.2.2.2.3.cmml" xref="alg1.l28.m1.7.7.2.2.2.2.2.2.3">𝑗</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.7c">c_{i,k}^{t+1}\leftarrow\frac{1}{\left|\mathcal{D}_{i}^{k}\right|}\sum_{(x_{j},y_{j})\in\mathcal{D}_{i}^{k}}f_{e}(w_{e_{i}}^{t+1};x_{j})</annotation></semantics></math> 
</div>
<div id="alg1.l29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29:</span>  <span id="alg1.l29.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l29.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30:</span>  <math id="alg1.l30.m1.10" class="ltx_Math" alttext="c_{i}^{t+1}\leftarrow\{c_{i,1}^{t+1},c_{i,2}^{t+1},...,c_{i,K}^{t+1}\}" display="inline"><semantics id="alg1.l30.m1.10a"><mrow id="alg1.l30.m1.10.10" xref="alg1.l30.m1.10.10.cmml"><msubsup id="alg1.l30.m1.10.10.5" xref="alg1.l30.m1.10.10.5.cmml"><mi id="alg1.l30.m1.10.10.5.2.2" xref="alg1.l30.m1.10.10.5.2.2.cmml">c</mi><mi id="alg1.l30.m1.10.10.5.2.3" xref="alg1.l30.m1.10.10.5.2.3.cmml">i</mi><mrow id="alg1.l30.m1.10.10.5.3" xref="alg1.l30.m1.10.10.5.3.cmml"><mi id="alg1.l30.m1.10.10.5.3.2" xref="alg1.l30.m1.10.10.5.3.2.cmml">t</mi><mo id="alg1.l30.m1.10.10.5.3.1" xref="alg1.l30.m1.10.10.5.3.1.cmml">+</mo><mn id="alg1.l30.m1.10.10.5.3.3" xref="alg1.l30.m1.10.10.5.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.l30.m1.10.10.4" xref="alg1.l30.m1.10.10.4.cmml">←</mo><mrow id="alg1.l30.m1.10.10.3.3" xref="alg1.l30.m1.10.10.3.4.cmml"><mo stretchy="false" id="alg1.l30.m1.10.10.3.3.4" xref="alg1.l30.m1.10.10.3.4.cmml">{</mo><msubsup id="alg1.l30.m1.8.8.1.1.1" xref="alg1.l30.m1.8.8.1.1.1.cmml"><mi id="alg1.l30.m1.8.8.1.1.1.2.2" xref="alg1.l30.m1.8.8.1.1.1.2.2.cmml">c</mi><mrow id="alg1.l30.m1.2.2.2.4" xref="alg1.l30.m1.2.2.2.3.cmml"><mi id="alg1.l30.m1.1.1.1.1" xref="alg1.l30.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l30.m1.2.2.2.4.1" xref="alg1.l30.m1.2.2.2.3.cmml">,</mo><mn id="alg1.l30.m1.2.2.2.2" xref="alg1.l30.m1.2.2.2.2.cmml">1</mn></mrow><mrow id="alg1.l30.m1.8.8.1.1.1.3" xref="alg1.l30.m1.8.8.1.1.1.3.cmml"><mi id="alg1.l30.m1.8.8.1.1.1.3.2" xref="alg1.l30.m1.8.8.1.1.1.3.2.cmml">t</mi><mo id="alg1.l30.m1.8.8.1.1.1.3.1" xref="alg1.l30.m1.8.8.1.1.1.3.1.cmml">+</mo><mn id="alg1.l30.m1.8.8.1.1.1.3.3" xref="alg1.l30.m1.8.8.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l30.m1.10.10.3.3.5" xref="alg1.l30.m1.10.10.3.4.cmml">,</mo><msubsup id="alg1.l30.m1.9.9.2.2.2" xref="alg1.l30.m1.9.9.2.2.2.cmml"><mi id="alg1.l30.m1.9.9.2.2.2.2.2" xref="alg1.l30.m1.9.9.2.2.2.2.2.cmml">c</mi><mrow id="alg1.l30.m1.4.4.2.4" xref="alg1.l30.m1.4.4.2.3.cmml"><mi id="alg1.l30.m1.3.3.1.1" xref="alg1.l30.m1.3.3.1.1.cmml">i</mi><mo id="alg1.l30.m1.4.4.2.4.1" xref="alg1.l30.m1.4.4.2.3.cmml">,</mo><mn id="alg1.l30.m1.4.4.2.2" xref="alg1.l30.m1.4.4.2.2.cmml">2</mn></mrow><mrow id="alg1.l30.m1.9.9.2.2.2.3" xref="alg1.l30.m1.9.9.2.2.2.3.cmml"><mi id="alg1.l30.m1.9.9.2.2.2.3.2" xref="alg1.l30.m1.9.9.2.2.2.3.2.cmml">t</mi><mo id="alg1.l30.m1.9.9.2.2.2.3.1" xref="alg1.l30.m1.9.9.2.2.2.3.1.cmml">+</mo><mn id="alg1.l30.m1.9.9.2.2.2.3.3" xref="alg1.l30.m1.9.9.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l30.m1.10.10.3.3.6" xref="alg1.l30.m1.10.10.3.4.cmml">,</mo><mi mathvariant="normal" id="alg1.l30.m1.7.7" xref="alg1.l30.m1.7.7.cmml">…</mi><mo id="alg1.l30.m1.10.10.3.3.7" xref="alg1.l30.m1.10.10.3.4.cmml">,</mo><msubsup id="alg1.l30.m1.10.10.3.3.3" xref="alg1.l30.m1.10.10.3.3.3.cmml"><mi id="alg1.l30.m1.10.10.3.3.3.2.2" xref="alg1.l30.m1.10.10.3.3.3.2.2.cmml">c</mi><mrow id="alg1.l30.m1.6.6.2.4" xref="alg1.l30.m1.6.6.2.3.cmml"><mi id="alg1.l30.m1.5.5.1.1" xref="alg1.l30.m1.5.5.1.1.cmml">i</mi><mo id="alg1.l30.m1.6.6.2.4.1" xref="alg1.l30.m1.6.6.2.3.cmml">,</mo><mi id="alg1.l30.m1.6.6.2.2" xref="alg1.l30.m1.6.6.2.2.cmml">K</mi></mrow><mrow id="alg1.l30.m1.10.10.3.3.3.3" xref="alg1.l30.m1.10.10.3.3.3.3.cmml"><mi id="alg1.l30.m1.10.10.3.3.3.3.2" xref="alg1.l30.m1.10.10.3.3.3.3.2.cmml">t</mi><mo id="alg1.l30.m1.10.10.3.3.3.3.1" xref="alg1.l30.m1.10.10.3.3.3.3.1.cmml">+</mo><mn id="alg1.l30.m1.10.10.3.3.3.3.3" xref="alg1.l30.m1.10.10.3.3.3.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.l30.m1.10.10.3.3.8" xref="alg1.l30.m1.10.10.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l30.m1.10b"><apply id="alg1.l30.m1.10.10.cmml" xref="alg1.l30.m1.10.10"><ci id="alg1.l30.m1.10.10.4.cmml" xref="alg1.l30.m1.10.10.4">←</ci><apply id="alg1.l30.m1.10.10.5.cmml" xref="alg1.l30.m1.10.10.5"><csymbol cd="ambiguous" id="alg1.l30.m1.10.10.5.1.cmml" xref="alg1.l30.m1.10.10.5">superscript</csymbol><apply id="alg1.l30.m1.10.10.5.2.cmml" xref="alg1.l30.m1.10.10.5"><csymbol cd="ambiguous" id="alg1.l30.m1.10.10.5.2.1.cmml" xref="alg1.l30.m1.10.10.5">subscript</csymbol><ci id="alg1.l30.m1.10.10.5.2.2.cmml" xref="alg1.l30.m1.10.10.5.2.2">𝑐</ci><ci id="alg1.l30.m1.10.10.5.2.3.cmml" xref="alg1.l30.m1.10.10.5.2.3">𝑖</ci></apply><apply id="alg1.l30.m1.10.10.5.3.cmml" xref="alg1.l30.m1.10.10.5.3"><plus id="alg1.l30.m1.10.10.5.3.1.cmml" xref="alg1.l30.m1.10.10.5.3.1"></plus><ci id="alg1.l30.m1.10.10.5.3.2.cmml" xref="alg1.l30.m1.10.10.5.3.2">𝑡</ci><cn type="integer" id="alg1.l30.m1.10.10.5.3.3.cmml" xref="alg1.l30.m1.10.10.5.3.3">1</cn></apply></apply><set id="alg1.l30.m1.10.10.3.4.cmml" xref="alg1.l30.m1.10.10.3.3"><apply id="alg1.l30.m1.8.8.1.1.1.cmml" xref="alg1.l30.m1.8.8.1.1.1"><csymbol cd="ambiguous" id="alg1.l30.m1.8.8.1.1.1.1.cmml" xref="alg1.l30.m1.8.8.1.1.1">superscript</csymbol><apply id="alg1.l30.m1.8.8.1.1.1.2.cmml" xref="alg1.l30.m1.8.8.1.1.1"><csymbol cd="ambiguous" id="alg1.l30.m1.8.8.1.1.1.2.1.cmml" xref="alg1.l30.m1.8.8.1.1.1">subscript</csymbol><ci id="alg1.l30.m1.8.8.1.1.1.2.2.cmml" xref="alg1.l30.m1.8.8.1.1.1.2.2">𝑐</ci><list id="alg1.l30.m1.2.2.2.3.cmml" xref="alg1.l30.m1.2.2.2.4"><ci id="alg1.l30.m1.1.1.1.1.cmml" xref="alg1.l30.m1.1.1.1.1">𝑖</ci><cn type="integer" id="alg1.l30.m1.2.2.2.2.cmml" xref="alg1.l30.m1.2.2.2.2">1</cn></list></apply><apply id="alg1.l30.m1.8.8.1.1.1.3.cmml" xref="alg1.l30.m1.8.8.1.1.1.3"><plus id="alg1.l30.m1.8.8.1.1.1.3.1.cmml" xref="alg1.l30.m1.8.8.1.1.1.3.1"></plus><ci id="alg1.l30.m1.8.8.1.1.1.3.2.cmml" xref="alg1.l30.m1.8.8.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l30.m1.8.8.1.1.1.3.3.cmml" xref="alg1.l30.m1.8.8.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l30.m1.9.9.2.2.2.cmml" xref="alg1.l30.m1.9.9.2.2.2"><csymbol cd="ambiguous" id="alg1.l30.m1.9.9.2.2.2.1.cmml" xref="alg1.l30.m1.9.9.2.2.2">superscript</csymbol><apply id="alg1.l30.m1.9.9.2.2.2.2.cmml" xref="alg1.l30.m1.9.9.2.2.2"><csymbol cd="ambiguous" id="alg1.l30.m1.9.9.2.2.2.2.1.cmml" xref="alg1.l30.m1.9.9.2.2.2">subscript</csymbol><ci id="alg1.l30.m1.9.9.2.2.2.2.2.cmml" xref="alg1.l30.m1.9.9.2.2.2.2.2">𝑐</ci><list id="alg1.l30.m1.4.4.2.3.cmml" xref="alg1.l30.m1.4.4.2.4"><ci id="alg1.l30.m1.3.3.1.1.cmml" xref="alg1.l30.m1.3.3.1.1">𝑖</ci><cn type="integer" id="alg1.l30.m1.4.4.2.2.cmml" xref="alg1.l30.m1.4.4.2.2">2</cn></list></apply><apply id="alg1.l30.m1.9.9.2.2.2.3.cmml" xref="alg1.l30.m1.9.9.2.2.2.3"><plus id="alg1.l30.m1.9.9.2.2.2.3.1.cmml" xref="alg1.l30.m1.9.9.2.2.2.3.1"></plus><ci id="alg1.l30.m1.9.9.2.2.2.3.2.cmml" xref="alg1.l30.m1.9.9.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l30.m1.9.9.2.2.2.3.3.cmml" xref="alg1.l30.m1.9.9.2.2.2.3.3">1</cn></apply></apply><ci id="alg1.l30.m1.7.7.cmml" xref="alg1.l30.m1.7.7">…</ci><apply id="alg1.l30.m1.10.10.3.3.3.cmml" xref="alg1.l30.m1.10.10.3.3.3"><csymbol cd="ambiguous" id="alg1.l30.m1.10.10.3.3.3.1.cmml" xref="alg1.l30.m1.10.10.3.3.3">superscript</csymbol><apply id="alg1.l30.m1.10.10.3.3.3.2.cmml" xref="alg1.l30.m1.10.10.3.3.3"><csymbol cd="ambiguous" id="alg1.l30.m1.10.10.3.3.3.2.1.cmml" xref="alg1.l30.m1.10.10.3.3.3">subscript</csymbol><ci id="alg1.l30.m1.10.10.3.3.3.2.2.cmml" xref="alg1.l30.m1.10.10.3.3.3.2.2">𝑐</ci><list id="alg1.l30.m1.6.6.2.3.cmml" xref="alg1.l30.m1.6.6.2.4"><ci id="alg1.l30.m1.5.5.1.1.cmml" xref="alg1.l30.m1.5.5.1.1">𝑖</ci><ci id="alg1.l30.m1.6.6.2.2.cmml" xref="alg1.l30.m1.6.6.2.2">𝐾</ci></list></apply><apply id="alg1.l30.m1.10.10.3.3.3.3.cmml" xref="alg1.l30.m1.10.10.3.3.3.3"><plus id="alg1.l30.m1.10.10.3.3.3.3.1.cmml" xref="alg1.l30.m1.10.10.3.3.3.3.1"></plus><ci id="alg1.l30.m1.10.10.3.3.3.3.2.cmml" xref="alg1.l30.m1.10.10.3.3.3.3.2">𝑡</ci><cn type="integer" id="alg1.l30.m1.10.10.3.3.3.3.3.cmml" xref="alg1.l30.m1.10.10.3.3.3.3.3">1</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.m1.10c">c_{i}^{t+1}\leftarrow\{c_{i,1}^{t+1},c_{i,2}^{t+1},...,c_{i,K}^{t+1}\}</annotation></semantics></math>

</div>
<div id="alg1.l31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31:</span>  reture <math id="alg1.l31.m1.2" class="ltx_Math" alttext="w_{i}^{t+1},c_{i}^{t+1}" display="inline"><semantics id="alg1.l31.m1.2a"><mrow id="alg1.l31.m1.2.2.2" xref="alg1.l31.m1.2.2.3.cmml"><msubsup id="alg1.l31.m1.1.1.1.1" xref="alg1.l31.m1.1.1.1.1.cmml"><mi id="alg1.l31.m1.1.1.1.1.2.2" xref="alg1.l31.m1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l31.m1.1.1.1.1.2.3" xref="alg1.l31.m1.1.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l31.m1.1.1.1.1.3" xref="alg1.l31.m1.1.1.1.1.3.cmml"><mi id="alg1.l31.m1.1.1.1.1.3.2" xref="alg1.l31.m1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l31.m1.1.1.1.1.3.1" xref="alg1.l31.m1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l31.m1.1.1.1.1.3.3" xref="alg1.l31.m1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l31.m1.2.2.2.3" xref="alg1.l31.m1.2.2.3.cmml">,</mo><msubsup id="alg1.l31.m1.2.2.2.2" xref="alg1.l31.m1.2.2.2.2.cmml"><mi id="alg1.l31.m1.2.2.2.2.2.2" xref="alg1.l31.m1.2.2.2.2.2.2.cmml">c</mi><mi id="alg1.l31.m1.2.2.2.2.2.3" xref="alg1.l31.m1.2.2.2.2.2.3.cmml">i</mi><mrow id="alg1.l31.m1.2.2.2.2.3" xref="alg1.l31.m1.2.2.2.2.3.cmml"><mi id="alg1.l31.m1.2.2.2.2.3.2" xref="alg1.l31.m1.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l31.m1.2.2.2.2.3.1" xref="alg1.l31.m1.2.2.2.2.3.1.cmml">+</mo><mn id="alg1.l31.m1.2.2.2.2.3.3" xref="alg1.l31.m1.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l31.m1.2b"><list id="alg1.l31.m1.2.2.3.cmml" xref="alg1.l31.m1.2.2.2"><apply id="alg1.l31.m1.1.1.1.1.cmml" xref="alg1.l31.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l31.m1.1.1.1.1.1.cmml" xref="alg1.l31.m1.1.1.1.1">superscript</csymbol><apply id="alg1.l31.m1.1.1.1.1.2.cmml" xref="alg1.l31.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l31.m1.1.1.1.1.2.1.cmml" xref="alg1.l31.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l31.m1.1.1.1.1.2.2.cmml" xref="alg1.l31.m1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l31.m1.1.1.1.1.2.3.cmml" xref="alg1.l31.m1.1.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l31.m1.1.1.1.1.3.cmml" xref="alg1.l31.m1.1.1.1.1.3"><plus id="alg1.l31.m1.1.1.1.1.3.1.cmml" xref="alg1.l31.m1.1.1.1.1.3.1"></plus><ci id="alg1.l31.m1.1.1.1.1.3.2.cmml" xref="alg1.l31.m1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l31.m1.1.1.1.1.3.3.cmml" xref="alg1.l31.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l31.m1.2.2.2.2.cmml" xref="alg1.l31.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l31.m1.2.2.2.2.1.cmml" xref="alg1.l31.m1.2.2.2.2">superscript</csymbol><apply id="alg1.l31.m1.2.2.2.2.2.cmml" xref="alg1.l31.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l31.m1.2.2.2.2.2.1.cmml" xref="alg1.l31.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l31.m1.2.2.2.2.2.2.cmml" xref="alg1.l31.m1.2.2.2.2.2.2">𝑐</ci><ci id="alg1.l31.m1.2.2.2.2.2.3.cmml" xref="alg1.l31.m1.2.2.2.2.2.3">𝑖</ci></apply><apply id="alg1.l31.m1.2.2.2.2.3.cmml" xref="alg1.l31.m1.2.2.2.2.3"><plus id="alg1.l31.m1.2.2.2.2.3.1.cmml" xref="alg1.l31.m1.2.2.2.2.3.1"></plus><ci id="alg1.l31.m1.2.2.2.2.3.2.cmml" xref="alg1.l31.m1.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l31.m1.2.2.2.2.3.3.cmml" xref="alg1.l31.m1.2.2.2.2.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m1.2c">w_{i}^{t+1},c_{i}^{t+1}</annotation></semantics></math> to server

</div>
</div>
</figure>
</section>
<section id="S3.SS3.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_font_bold ltx_title_subsubsection">Local Objective</h4>

<div id="S3.SS3.SSSx2.p1" class="ltx_para">
<p id="S3.SS3.SSSx2.p1.7" class="ltx_p">The loss function of our local network is composed of two parts. The first part is our proposed global prototypical contrastive loss term <math id="S3.SS3.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="\ell_{gpc}" display="inline"><semantics id="S3.SS3.SSSx2.p1.1.m1.1a"><msub id="S3.SS3.SSSx2.p1.1.m1.1.1" xref="S3.SS3.SSSx2.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.SSSx2.p1.1.m1.1.1.2" xref="S3.SS3.SSSx2.p1.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.SSSx2.p1.1.m1.1.1.3" xref="S3.SS3.SSSx2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSSx2.p1.1.m1.1.1.3.2" xref="S3.SS3.SSSx2.p1.1.m1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx2.p1.1.m1.1.1.3.1" xref="S3.SS3.SSSx2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx2.p1.1.m1.1.1.3.3" xref="S3.SS3.SSSx2.p1.1.m1.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx2.p1.1.m1.1.1.3.1a" xref="S3.SS3.SSSx2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx2.p1.1.m1.1.1.3.4" xref="S3.SS3.SSSx2.p1.1.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx2.p1.1.m1.1b"><apply id="S3.SS3.SSSx2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSSx2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSSx2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSSx2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSSx2.p1.1.m1.1.1.2">ℓ</ci><apply id="S3.SS3.SSSx2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSSx2.p1.1.m1.1.1.3"><times id="S3.SS3.SSSx2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSSx2.p1.1.m1.1.1.3.1"></times><ci id="S3.SS3.SSSx2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSSx2.p1.1.m1.1.1.3.2">𝑔</ci><ci id="S3.SS3.SSSx2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSSx2.p1.1.m1.1.1.3.3">𝑝</ci><ci id="S3.SS3.SSSx2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS3.SSSx2.p1.1.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx2.p1.1.m1.1c">\ell_{gpc}</annotation></semantics></math>. This term makes the local network learn an embedding space that has the property of intra-class compactness and inter-class separability.
The second part is a typical cross-entropy loss <math id="S3.SS3.SSSx2.p1.2.m2.1" class="ltx_Math" alttext="\ell_{ce}" display="inline"><semantics id="S3.SS3.SSSx2.p1.2.m2.1a"><msub id="S3.SS3.SSSx2.p1.2.m2.1.1" xref="S3.SS3.SSSx2.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.SSSx2.p1.2.m2.1.1.2" xref="S3.SS3.SSSx2.p1.2.m2.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.SSSx2.p1.2.m2.1.1.3" xref="S3.SS3.SSSx2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSSx2.p1.2.m2.1.1.3.2" xref="S3.SS3.SSSx2.p1.2.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx2.p1.2.m2.1.1.3.1" xref="S3.SS3.SSSx2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx2.p1.2.m2.1.1.3.3" xref="S3.SS3.SSSx2.p1.2.m2.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx2.p1.2.m2.1b"><apply id="S3.SS3.SSSx2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSSx2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx2.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSSx2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSSx2.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSSx2.p1.2.m2.1.1.2">ℓ</ci><apply id="S3.SS3.SSSx2.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSSx2.p1.2.m2.1.1.3"><times id="S3.SS3.SSSx2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSSx2.p1.2.m2.1.1.3.1"></times><ci id="S3.SS3.SSSx2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSSx2.p1.2.m2.1.1.3.2">𝑐</ci><ci id="S3.SS3.SSSx2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSSx2.p1.2.m2.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx2.p1.2.m2.1c">\ell_{ce}</annotation></semantics></math> for classifier learning, which can be benefited from the above embedding space.
Inspired by cumulative learning <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al. <a href="#bib.bib41" title="" class="ltx_ref">2020</a>)</cite>, we introduce a coefficient <math id="S3.SS3.SSSx2.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.SSSx2.p1.3.m3.1a"><mi id="S3.SS3.SSSx2.p1.3.m3.1.1" xref="S3.SS3.SSSx2.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx2.p1.3.m3.1b"><ci id="S3.SS3.SSSx2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSSx2.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx2.p1.3.m3.1c">\alpha</annotation></semantics></math> for adjusting the weights
of the two terms during the local training phase. Concretely, the number of total communication rounds is denoted as <math id="S3.SS3.SSSx2.p1.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.SSSx2.p1.4.m4.1a"><mi id="S3.SS3.SSSx2.p1.4.m4.1.1" xref="S3.SS3.SSSx2.p1.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx2.p1.4.m4.1b"><ci id="S3.SS3.SSSx2.p1.4.m4.1.1.cmml" xref="S3.SS3.SSSx2.p1.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx2.p1.4.m4.1c">T</annotation></semantics></math>, and the current round is <math id="S3.SS3.SSSx2.p1.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.SSSx2.p1.5.m5.1a"><mi id="S3.SS3.SSSx2.p1.5.m5.1.1" xref="S3.SS3.SSSx2.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx2.p1.5.m5.1b"><ci id="S3.SS3.SSSx2.p1.5.m5.1.1.cmml" xref="S3.SS3.SSSx2.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx2.p1.5.m5.1c">t</annotation></semantics></math>, <math id="S3.SS3.SSSx2.p1.6.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.SSSx2.p1.6.m6.1a"><mi id="S3.SS3.SSSx2.p1.6.m6.1.1" xref="S3.SS3.SSSx2.p1.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx2.p1.6.m6.1b"><ci id="S3.SS3.SSSx2.p1.6.m6.1.1.cmml" xref="S3.SS3.SSSx2.p1.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx2.p1.6.m6.1c">\alpha</annotation></semantics></math> is calculated by <math id="S3.SS3.SSSx2.p1.7.m7.1" class="ltx_Math" alttext="\alpha=1-\frac{t}{T}" display="inline"><semantics id="S3.SS3.SSSx2.p1.7.m7.1a"><mrow id="S3.SS3.SSSx2.p1.7.m7.1.1" xref="S3.SS3.SSSx2.p1.7.m7.1.1.cmml"><mi id="S3.SS3.SSSx2.p1.7.m7.1.1.2" xref="S3.SS3.SSSx2.p1.7.m7.1.1.2.cmml">α</mi><mo id="S3.SS3.SSSx2.p1.7.m7.1.1.1" xref="S3.SS3.SSSx2.p1.7.m7.1.1.1.cmml">=</mo><mrow id="S3.SS3.SSSx2.p1.7.m7.1.1.3" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3.cmml"><mn id="S3.SS3.SSSx2.p1.7.m7.1.1.3.2" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSSx2.p1.7.m7.1.1.3.1" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3.1.cmml">−</mo><mfrac id="S3.SS3.SSSx2.p1.7.m7.1.1.3.3" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3.3.cmml"><mi id="S3.SS3.SSSx2.p1.7.m7.1.1.3.3.2" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3.3.2.cmml">t</mi><mi id="S3.SS3.SSSx2.p1.7.m7.1.1.3.3.3" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3.3.3.cmml">T</mi></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx2.p1.7.m7.1b"><apply id="S3.SS3.SSSx2.p1.7.m7.1.1.cmml" xref="S3.SS3.SSSx2.p1.7.m7.1.1"><eq id="S3.SS3.SSSx2.p1.7.m7.1.1.1.cmml" xref="S3.SS3.SSSx2.p1.7.m7.1.1.1"></eq><ci id="S3.SS3.SSSx2.p1.7.m7.1.1.2.cmml" xref="S3.SS3.SSSx2.p1.7.m7.1.1.2">𝛼</ci><apply id="S3.SS3.SSSx2.p1.7.m7.1.1.3.cmml" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3"><minus id="S3.SS3.SSSx2.p1.7.m7.1.1.3.1.cmml" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3.1"></minus><cn type="integer" id="S3.SS3.SSSx2.p1.7.m7.1.1.3.2.cmml" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3.2">1</cn><apply id="S3.SS3.SSSx2.p1.7.m7.1.1.3.3.cmml" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3.3"><divide id="S3.SS3.SSSx2.p1.7.m7.1.1.3.3.1.cmml" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3.3"></divide><ci id="S3.SS3.SSSx2.p1.7.m7.1.1.3.3.2.cmml" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3.3.2">𝑡</ci><ci id="S3.SS3.SSSx2.p1.7.m7.1.1.3.3.3.cmml" xref="S3.SS3.SSSx2.p1.7.m7.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx2.p1.7.m7.1c">\alpha=1-\frac{t}{T}</annotation></semantics></math>.
The final loss function for the network is:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\ell=\alpha\cdot\ell_{gpc}+(1-\alpha)\cdot\ell_{ce}" display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi mathvariant="normal" id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">ℓ</mi><mo id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.3.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.3.1.cmml">⋅</mo><msub id="S3.E2.m1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.3.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.3.3.2.cmml">ℓ</mi><mrow id="S3.E2.m1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.3.3.3.cmml"><mi id="S3.E2.m1.1.1.1.3.3.3.2" xref="S3.E2.m1.1.1.1.3.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.3.3.3.1" xref="S3.E2.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.3.3.3.3" xref="S3.E2.m1.1.1.1.3.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.3.3.3.1a" xref="S3.E2.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.3.3.3.4" xref="S3.E2.m1.1.1.1.3.3.3.4.cmml">c</mi></mrow></msub></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml">ℓ</mi><mrow id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.3.1" xref="S3.E2.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.3.3.3.cmml">e</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><eq id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2"></eq><ci id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3">ℓ</ci><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><plus id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></plus><apply id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3"><ci id="S3.E2.m1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.3.1">⋅</ci><ci id="S3.E2.m1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.3.2">𝛼</ci><apply id="S3.E2.m1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.3.3.2">ℓ</ci><apply id="S3.E2.m1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.3.3.3"><times id="S3.E2.m1.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.1.1.1.3.3.3.1"></times><ci id="S3.E2.m1.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.1.1.1.3.3.3.2">𝑔</ci><ci id="S3.E2.m1.1.1.1.3.3.3.3.cmml" xref="S3.E2.m1.1.1.1.3.3.3.3">𝑝</ci><ci id="S3.E2.m1.1.1.1.3.3.3.4.cmml" xref="S3.E2.m1.1.1.1.3.3.3.4">𝑐</ci></apply></apply></apply><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"><ci id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2">⋅</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><minus id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2">ℓ</ci><apply id="S3.E2.m1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><times id="S3.E2.m1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.1"></times><ci id="S3.E2.m1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2">𝑐</ci><ci id="S3.E2.m1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\ell=\alpha\cdot\ell_{gpc}+(1-\alpha)\cdot\ell_{ce}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSSx2.p1.8" class="ltx_p">This method makes the local learning to be progressively transited from feature learning to classifier learning with the increased rounds. The local objective is to minimize</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.8" class="ltx_Math" alttext="L_{i}(w)=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}[\alpha\cdot\ell_{gpc}(w_{e}^{t};(x,y))+(1-\alpha)\cdot\ell_{ce}(w^{t};(x,y))]" display="block"><semantics id="S3.E3.m1.8a"><mrow id="S3.E3.m1.8.8" xref="S3.E3.m1.8.8.cmml"><mrow id="S3.E3.m1.8.8.3" xref="S3.E3.m1.8.8.3.cmml"><msub id="S3.E3.m1.8.8.3.2" xref="S3.E3.m1.8.8.3.2.cmml"><mi id="S3.E3.m1.8.8.3.2.2" xref="S3.E3.m1.8.8.3.2.2.cmml">L</mi><mi id="S3.E3.m1.8.8.3.2.3" xref="S3.E3.m1.8.8.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.3.1" xref="S3.E3.m1.8.8.3.1.cmml">​</mo><mrow id="S3.E3.m1.8.8.3.3.2" xref="S3.E3.m1.8.8.3.cmml"><mo stretchy="false" id="S3.E3.m1.8.8.3.3.2.1" xref="S3.E3.m1.8.8.3.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">w</mi><mo stretchy="false" id="S3.E3.m1.8.8.3.3.2.2" xref="S3.E3.m1.8.8.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.8.8.2" xref="S3.E3.m1.8.8.2.cmml">=</mo><mrow id="S3.E3.m1.8.8.1" xref="S3.E3.m1.8.8.1.cmml"><msub id="S3.E3.m1.8.8.1.3" xref="S3.E3.m1.8.8.1.3.cmml"><mi id="S3.E3.m1.8.8.1.3.2" xref="S3.E3.m1.8.8.1.3.2.cmml">𝔼</mi><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><mrow id="S3.E3.m1.2.2.2.4.2" xref="S3.E3.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.4.2.1" xref="S3.E3.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">x</mi><mo id="S3.E3.m1.2.2.2.4.2.2" xref="S3.E3.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E3.m1.2.2.2.4.2.3" xref="S3.E3.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml">∼</mo><msub id="S3.E3.m1.2.2.2.5" xref="S3.E3.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.2.5.2" xref="S3.E3.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.E3.m1.2.2.2.5.3" xref="S3.E3.m1.2.2.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.1.2" xref="S3.E3.m1.8.8.1.2.cmml">​</mo><mrow id="S3.E3.m1.8.8.1.1.1" xref="S3.E3.m1.8.8.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.2" xref="S3.E3.m1.8.8.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.8.8.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.cmml"><mrow id="S3.E3.m1.8.8.1.1.1.1.2" xref="S3.E3.m1.8.8.1.1.1.1.2.cmml"><mrow id="S3.E3.m1.8.8.1.1.1.1.2.4" xref="S3.E3.m1.8.8.1.1.1.1.2.4.cmml"><mi id="S3.E3.m1.8.8.1.1.1.1.2.4.2" xref="S3.E3.m1.8.8.1.1.1.1.2.4.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.8.8.1.1.1.1.2.4.1" xref="S3.E3.m1.8.8.1.1.1.1.2.4.1.cmml">⋅</mo><msub id="S3.E3.m1.8.8.1.1.1.1.2.4.3" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.cmml"><mi mathvariant="normal" id="S3.E3.m1.8.8.1.1.1.1.2.4.3.2" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.2.cmml">ℓ</mi><mrow id="S3.E3.m1.8.8.1.1.1.1.2.4.3.3" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.cmml"><mi id="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.2" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.1" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.1.cmml">​</mo><mi id="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.3" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.1a" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.1.cmml">​</mo><mi id="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.4" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.4.cmml">c</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.1.1.1.1.2.3" xref="S3.E3.m1.8.8.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.2.2.2" xref="S3.E3.m1.8.8.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.1.2.2.2.3" xref="S3.E3.m1.8.8.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.2.3.cmml">e</mi><mi id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S3.E3.m1.8.8.1.1.1.1.2.2.2.4" xref="S3.E3.m1.8.8.1.1.1.1.2.2.3.cmml">;</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.8.8.1.1.1.1.2.2.2.2.1.cmml"><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.1.2.2.2.2.2.1" xref="S3.E3.m1.8.8.1.1.1.1.2.2.2.2.1.cmml">(</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">x</mi><mo id="S3.E3.m1.8.8.1.1.1.1.2.2.2.2.2.2" xref="S3.E3.m1.8.8.1.1.1.1.2.2.2.2.1.cmml">,</mo><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">y</mi><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.1.2.2.2.2.2.3" xref="S3.E3.m1.8.8.1.1.1.1.2.2.2.2.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.1.2.2.2.5" xref="S3.E3.m1.8.8.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.8.8.1.1.1.1.6" xref="S3.E3.m1.8.8.1.1.1.1.6.cmml">+</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.5" xref="S3.E3.m1.8.8.1.1.1.1.5.cmml"><mrow id="S3.E3.m1.8.8.1.1.1.1.3.1" xref="S3.E3.m1.8.8.1.1.1.1.3.1.cmml"><mrow id="S3.E3.m1.8.8.1.1.1.1.3.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.2" xref="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.cmml"><mn id="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.2" xref="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.2.cmml">1</mn><mo id="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.1.cmml">−</mo><mi id="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.3" xref="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.3.cmml">α</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.3" xref="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E3.m1.8.8.1.1.1.1.3.1.2" xref="S3.E3.m1.8.8.1.1.1.1.3.1.2.cmml">⋅</mo><msub id="S3.E3.m1.8.8.1.1.1.1.3.1.3" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3.cmml"><mi mathvariant="normal" id="S3.E3.m1.8.8.1.1.1.1.3.1.3.2" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3.2.cmml">ℓ</mi><mrow id="S3.E3.m1.8.8.1.1.1.1.3.1.3.3" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.cmml"><mi id="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.2" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.1" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.1.cmml">​</mo><mi id="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.3" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.3.cmml">e</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.1.1.1.1.5.4" xref="S3.E3.m1.8.8.1.1.1.1.5.4.cmml">​</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.5.3.2" xref="S3.E3.m1.8.8.1.1.1.1.5.3.3.cmml"><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.1.5.3.2.3" xref="S3.E3.m1.8.8.1.1.1.1.5.3.3.cmml">(</mo><msup id="S3.E3.m1.8.8.1.1.1.1.4.2.1.1" xref="S3.E3.m1.8.8.1.1.1.1.4.2.1.1.cmml"><mi id="S3.E3.m1.8.8.1.1.1.1.4.2.1.1.2" xref="S3.E3.m1.8.8.1.1.1.1.4.2.1.1.2.cmml">w</mi><mi id="S3.E3.m1.8.8.1.1.1.1.4.2.1.1.3" xref="S3.E3.m1.8.8.1.1.1.1.4.2.1.1.3.cmml">t</mi></msup><mo id="S3.E3.m1.8.8.1.1.1.1.5.3.2.4" xref="S3.E3.m1.8.8.1.1.1.1.5.3.3.cmml">;</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.5.3.2.2.2" xref="S3.E3.m1.8.8.1.1.1.1.5.3.2.2.1.cmml"><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.1.5.3.2.2.2.1" xref="S3.E3.m1.8.8.1.1.1.1.5.3.2.2.1.cmml">(</mo><mi id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml">x</mi><mo id="S3.E3.m1.8.8.1.1.1.1.5.3.2.2.2.2" xref="S3.E3.m1.8.8.1.1.1.1.5.3.2.2.1.cmml">,</mo><mi id="S3.E3.m1.7.7" xref="S3.E3.m1.7.7.cmml">y</mi><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.1.5.3.2.2.2.3" xref="S3.E3.m1.8.8.1.1.1.1.5.3.2.2.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.1.5.3.2.5" xref="S3.E3.m1.8.8.1.1.1.1.5.3.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.3" xref="S3.E3.m1.8.8.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.8b"><apply id="S3.E3.m1.8.8.cmml" xref="S3.E3.m1.8.8"><eq id="S3.E3.m1.8.8.2.cmml" xref="S3.E3.m1.8.8.2"></eq><apply id="S3.E3.m1.8.8.3.cmml" xref="S3.E3.m1.8.8.3"><times id="S3.E3.m1.8.8.3.1.cmml" xref="S3.E3.m1.8.8.3.1"></times><apply id="S3.E3.m1.8.8.3.2.cmml" xref="S3.E3.m1.8.8.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.3.2.1.cmml" xref="S3.E3.m1.8.8.3.2">subscript</csymbol><ci id="S3.E3.m1.8.8.3.2.2.cmml" xref="S3.E3.m1.8.8.3.2.2">𝐿</ci><ci id="S3.E3.m1.8.8.3.2.3.cmml" xref="S3.E3.m1.8.8.3.2.3">𝑖</ci></apply><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑤</ci></apply><apply id="S3.E3.m1.8.8.1.cmml" xref="S3.E3.m1.8.8.1"><times id="S3.E3.m1.8.8.1.2.cmml" xref="S3.E3.m1.8.8.1.2"></times><apply id="S3.E3.m1.8.8.1.3.cmml" xref="S3.E3.m1.8.8.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.3.1.cmml" xref="S3.E3.m1.8.8.1.3">subscript</csymbol><ci id="S3.E3.m1.8.8.1.3.2.cmml" xref="S3.E3.m1.8.8.1.3.2">𝔼</ci><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><csymbol cd="latexml" id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E3.m1.2.2.2.4.1.cmml" xref="S3.E3.m1.2.2.2.4.2"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑥</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E3.m1.2.2.2.5.cmml" xref="S3.E3.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.5.1.cmml" xref="S3.E3.m1.2.2.2.5">subscript</csymbol><ci id="S3.E3.m1.2.2.2.5.2.cmml" xref="S3.E3.m1.2.2.2.5.2">𝒟</ci><ci id="S3.E3.m1.2.2.2.5.3.cmml" xref="S3.E3.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.E3.m1.8.8.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.8.8.1.1.2.1.cmml" xref="S3.E3.m1.8.8.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.8.8.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1"><plus id="S3.E3.m1.8.8.1.1.1.1.6.cmml" xref="S3.E3.m1.8.8.1.1.1.1.6"></plus><apply id="S3.E3.m1.8.8.1.1.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2"><times id="S3.E3.m1.8.8.1.1.1.1.2.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.3"></times><apply id="S3.E3.m1.8.8.1.1.1.1.2.4.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.4"><ci id="S3.E3.m1.8.8.1.1.1.1.2.4.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.4.1">⋅</ci><ci id="S3.E3.m1.8.8.1.1.1.1.2.4.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.4.2">𝛼</ci><apply id="S3.E3.m1.8.8.1.1.1.1.2.4.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.1.1.2.4.3.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3">subscript</csymbol><ci id="S3.E3.m1.8.8.1.1.1.1.2.4.3.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.2">ℓ</ci><apply id="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.3"><times id="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.1"></times><ci id="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.2">𝑔</ci><ci id="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.3">𝑝</ci><ci id="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.4.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.4.3.3.4">𝑐</ci></apply></apply></apply><list id="S3.E3.m1.8.8.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.2.2"><apply id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.2.3">𝑒</ci></apply><ci id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><interval closure="open" id="S3.E3.m1.8.8.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2.2.2.2.2"><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝑥</ci><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">𝑦</ci></interval></list></apply><apply id="S3.E3.m1.8.8.1.1.1.1.5.cmml" xref="S3.E3.m1.8.8.1.1.1.1.5"><times id="S3.E3.m1.8.8.1.1.1.1.5.4.cmml" xref="S3.E3.m1.8.8.1.1.1.1.5.4"></times><apply id="S3.E3.m1.8.8.1.1.1.1.3.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1"><ci id="S3.E3.m1.8.8.1.1.1.1.3.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1.2">⋅</ci><apply id="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1.1.1"><minus id="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.1"></minus><cn type="integer" id="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.2">1</cn><ci id="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1.1.1.1.3">𝛼</ci></apply><apply id="S3.E3.m1.8.8.1.1.1.1.3.1.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.1.1.3.1.3.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3">subscript</csymbol><ci id="S3.E3.m1.8.8.1.1.1.1.3.1.3.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3.2">ℓ</ci><apply id="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3.3"><times id="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.1"></times><ci id="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.2">𝑐</ci><ci id="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3.1.3.3.3">𝑒</ci></apply></apply></apply><list id="S3.E3.m1.8.8.1.1.1.1.5.3.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.5.3.2"><apply id="S3.E3.m1.8.8.1.1.1.1.4.2.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.4.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.1.1.4.2.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.4.2.1.1">superscript</csymbol><ci id="S3.E3.m1.8.8.1.1.1.1.4.2.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.4.2.1.1.2">𝑤</ci><ci id="S3.E3.m1.8.8.1.1.1.1.4.2.1.1.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.4.2.1.1.3">𝑡</ci></apply><interval closure="open" id="S3.E3.m1.8.8.1.1.1.1.5.3.2.2.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.5.3.2.2.2"><ci id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6">𝑥</ci><ci id="S3.E3.m1.7.7.cmml" xref="S3.E3.m1.7.7">𝑦</ci></interval></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.8c">L_{i}(w)=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}[\alpha\cdot\ell_{gpc}(w_{e}^{t};(x,y))+(1-\alpha)\cdot\ell_{ce}(w^{t};(x,y))]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSSx2.p1.9" class="ltx_p">In the local training, each client updates the model based on their local training data using stochastic gradient descent (SGD), while the objective is defined in Eq. (<a href="#S3.E3" title="In Local Objective ‣ 3.3 Method ‣ 3 Prototypical Contrastive Federated Learning ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
</section>
<section id="S3.SS3.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_font_bold ltx_title_subsubsection">Global Prototypical Contrastive Loss</h4>

<div id="S3.SS3.SSSx3.p1" class="ltx_para">
<p id="S3.SS3.SSSx3.p1.1" class="ltx_p">To make the global class-prototypes serve as the knowledge to correct each client’s local training, we
propose a global prototypical contrastive loss <math id="S3.SS3.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="\ell_{gpc}" display="inline"><semantics id="S3.SS3.SSSx3.p1.1.m1.1a"><msub id="S3.SS3.SSSx3.p1.1.m1.1.1" xref="S3.SS3.SSSx3.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.SSSx3.p1.1.m1.1.1.2" xref="S3.SS3.SSSx3.p1.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.SSSx3.p1.1.m1.1.1.3" xref="S3.SS3.SSSx3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSSx3.p1.1.m1.1.1.3.2" xref="S3.SS3.SSSx3.p1.1.m1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx3.p1.1.m1.1.1.3.1" xref="S3.SS3.SSSx3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx3.p1.1.m1.1.1.3.3" xref="S3.SS3.SSSx3.p1.1.m1.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx3.p1.1.m1.1.1.3.1a" xref="S3.SS3.SSSx3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx3.p1.1.m1.1.1.3.4" xref="S3.SS3.SSSx3.p1.1.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.1.m1.1b"><apply id="S3.SS3.SSSx3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSSx3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSSx3.p1.1.m1.1.1.2">ℓ</ci><apply id="S3.SS3.SSSx3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSSx3.p1.1.m1.1.1.3"><times id="S3.SS3.SSSx3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSSx3.p1.1.m1.1.1.3.1"></times><ci id="S3.SS3.SSSx3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSSx3.p1.1.m1.1.1.3.2">𝑔</ci><ci id="S3.SS3.SSSx3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSSx3.p1.1.m1.1.1.3.3">𝑝</ci><ci id="S3.SS3.SSSx3.p1.1.m1.1.1.3.4.cmml" xref="S3.SS3.SSSx3.p1.1.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.1.m1.1c">\ell_{gpc}</annotation></semantics></math>. This loss forces each sample of the client to be close to the global prototype of its class and far away from the global prototypes of other classes.
We define the global prototypical contrastive loss as</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.12" class="ltx_Math" alttext="\ell_{gpc}=-\log\frac{\exp(sim(z_{j},c_{i,k}))}{\exp(sim(z_{j},c_{i,k}))+\sum_{k^{\prime}}\exp(sim(z_{j},c_{i,k^{\prime}}))}" display="block"><semantics id="S3.E4.m1.12a"><mrow id="S3.E4.m1.12.13" xref="S3.E4.m1.12.13.cmml"><msub id="S3.E4.m1.12.13.2" xref="S3.E4.m1.12.13.2.cmml"><mi mathvariant="normal" id="S3.E4.m1.12.13.2.2" xref="S3.E4.m1.12.13.2.2.cmml">ℓ</mi><mrow id="S3.E4.m1.12.13.2.3" xref="S3.E4.m1.12.13.2.3.cmml"><mi id="S3.E4.m1.12.13.2.3.2" xref="S3.E4.m1.12.13.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.12.13.2.3.1" xref="S3.E4.m1.12.13.2.3.1.cmml">​</mo><mi id="S3.E4.m1.12.13.2.3.3" xref="S3.E4.m1.12.13.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.12.13.2.3.1a" xref="S3.E4.m1.12.13.2.3.1.cmml">​</mo><mi id="S3.E4.m1.12.13.2.3.4" xref="S3.E4.m1.12.13.2.3.4.cmml">c</mi></mrow></msub><mo id="S3.E4.m1.12.13.1" xref="S3.E4.m1.12.13.1.cmml">=</mo><mrow id="S3.E4.m1.12.13.3" xref="S3.E4.m1.12.13.3.cmml"><mo rspace="0.167em" id="S3.E4.m1.12.13.3a" xref="S3.E4.m1.12.13.3.cmml">−</mo><mrow id="S3.E4.m1.12.13.3.2" xref="S3.E4.m1.12.13.3.2.cmml"><mi id="S3.E4.m1.12.13.3.2.1" xref="S3.E4.m1.12.13.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.E4.m1.12.13.3.2a" xref="S3.E4.m1.12.13.3.2.cmml">⁡</mo><mfrac id="S3.E4.m1.12.12" xref="S3.E4.m1.12.12.cmml"><mrow id="S3.E4.m1.4.4.4.4" xref="S3.E4.m1.4.4.4.5.cmml"><mi id="S3.E4.m1.3.3.3.3" xref="S3.E4.m1.3.3.3.3.cmml">exp</mi><mo id="S3.E4.m1.4.4.4.4a" xref="S3.E4.m1.4.4.4.5.cmml">⁡</mo><mrow id="S3.E4.m1.4.4.4.4.1" xref="S3.E4.m1.4.4.4.5.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.4.4.1.2" xref="S3.E4.m1.4.4.4.5.cmml">(</mo><mrow id="S3.E4.m1.4.4.4.4.1.1" xref="S3.E4.m1.4.4.4.4.1.1.cmml"><mi id="S3.E4.m1.4.4.4.4.1.1.4" xref="S3.E4.m1.4.4.4.4.1.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.4.1.1.3" xref="S3.E4.m1.4.4.4.4.1.1.3.cmml">​</mo><mi id="S3.E4.m1.4.4.4.4.1.1.5" xref="S3.E4.m1.4.4.4.4.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.4.1.1.3a" xref="S3.E4.m1.4.4.4.4.1.1.3.cmml">​</mo><mi id="S3.E4.m1.4.4.4.4.1.1.6" xref="S3.E4.m1.4.4.4.4.1.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.4.1.1.3b" xref="S3.E4.m1.4.4.4.4.1.1.3.cmml">​</mo><mrow id="S3.E4.m1.4.4.4.4.1.1.2.2" xref="S3.E4.m1.4.4.4.4.1.1.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.4.4.1.1.2.2.3" xref="S3.E4.m1.4.4.4.4.1.1.2.3.cmml">(</mo><msub id="S3.E4.m1.4.4.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.4.4.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.4.4.1.1.1.1.1.2" xref="S3.E4.m1.4.4.4.4.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E4.m1.4.4.4.4.1.1.1.1.1.3" xref="S3.E4.m1.4.4.4.4.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E4.m1.4.4.4.4.1.1.2.2.4" xref="S3.E4.m1.4.4.4.4.1.1.2.3.cmml">,</mo><msub id="S3.E4.m1.4.4.4.4.1.1.2.2.2" xref="S3.E4.m1.4.4.4.4.1.1.2.2.2.cmml"><mi id="S3.E4.m1.4.4.4.4.1.1.2.2.2.2" xref="S3.E4.m1.4.4.4.4.1.1.2.2.2.2.cmml">c</mi><mrow id="S3.E4.m1.2.2.2.2.2.4" xref="S3.E4.m1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E4.m1.2.2.2.2.2.4.1" xref="S3.E4.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.E4.m1.4.4.4.4.1.1.2.2.5" xref="S3.E4.m1.4.4.4.4.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.4.4.4.4.1.3" xref="S3.E4.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.12.12.12" xref="S3.E4.m1.12.12.12.cmml"><mrow id="S3.E4.m1.11.11.11.7.1" xref="S3.E4.m1.11.11.11.7.2.cmml"><mi id="S3.E4.m1.9.9.9.5" xref="S3.E4.m1.9.9.9.5.cmml">exp</mi><mo id="S3.E4.m1.11.11.11.7.1a" xref="S3.E4.m1.11.11.11.7.2.cmml">⁡</mo><mrow id="S3.E4.m1.11.11.11.7.1.1" xref="S3.E4.m1.11.11.11.7.2.cmml"><mo stretchy="false" id="S3.E4.m1.11.11.11.7.1.1.2" xref="S3.E4.m1.11.11.11.7.2.cmml">(</mo><mrow id="S3.E4.m1.11.11.11.7.1.1.1" xref="S3.E4.m1.11.11.11.7.1.1.1.cmml"><mi id="S3.E4.m1.11.11.11.7.1.1.1.4" xref="S3.E4.m1.11.11.11.7.1.1.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.11.7.1.1.1.3" xref="S3.E4.m1.11.11.11.7.1.1.1.3.cmml">​</mo><mi id="S3.E4.m1.11.11.11.7.1.1.1.5" xref="S3.E4.m1.11.11.11.7.1.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.11.7.1.1.1.3a" xref="S3.E4.m1.11.11.11.7.1.1.1.3.cmml">​</mo><mi id="S3.E4.m1.11.11.11.7.1.1.1.6" xref="S3.E4.m1.11.11.11.7.1.1.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.11.7.1.1.1.3b" xref="S3.E4.m1.11.11.11.7.1.1.1.3.cmml">​</mo><mrow id="S3.E4.m1.11.11.11.7.1.1.1.2.2" xref="S3.E4.m1.11.11.11.7.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.11.11.11.7.1.1.1.2.2.3" xref="S3.E4.m1.11.11.11.7.1.1.1.2.3.cmml">(</mo><msub id="S3.E4.m1.11.11.11.7.1.1.1.1.1.1" xref="S3.E4.m1.11.11.11.7.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.11.11.11.7.1.1.1.1.1.1.2" xref="S3.E4.m1.11.11.11.7.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E4.m1.11.11.11.7.1.1.1.1.1.1.3" xref="S3.E4.m1.11.11.11.7.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E4.m1.11.11.11.7.1.1.1.2.2.4" xref="S3.E4.m1.11.11.11.7.1.1.1.2.3.cmml">,</mo><msub id="S3.E4.m1.11.11.11.7.1.1.1.2.2.2" xref="S3.E4.m1.11.11.11.7.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.11.11.11.7.1.1.1.2.2.2.2" xref="S3.E4.m1.11.11.11.7.1.1.1.2.2.2.2.cmml">c</mi><mrow id="S3.E4.m1.6.6.6.2.2.4" xref="S3.E4.m1.6.6.6.2.2.3.cmml"><mi id="S3.E4.m1.5.5.5.1.1.1" xref="S3.E4.m1.5.5.5.1.1.1.cmml">i</mi><mo id="S3.E4.m1.6.6.6.2.2.4.1" xref="S3.E4.m1.6.6.6.2.2.3.cmml">,</mo><mi id="S3.E4.m1.6.6.6.2.2.2" xref="S3.E4.m1.6.6.6.2.2.2.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.E4.m1.11.11.11.7.1.1.1.2.2.5" xref="S3.E4.m1.11.11.11.7.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.11.11.11.7.1.1.3" xref="S3.E4.m1.11.11.11.7.2.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="S3.E4.m1.12.12.12.9" xref="S3.E4.m1.12.12.12.9.cmml">+</mo><mrow id="S3.E4.m1.12.12.12.8" xref="S3.E4.m1.12.12.12.8.cmml"><msub id="S3.E4.m1.12.12.12.8.2" xref="S3.E4.m1.12.12.12.8.2.cmml"><mo id="S3.E4.m1.12.12.12.8.2.2" xref="S3.E4.m1.12.12.12.8.2.2.cmml">∑</mo><msup id="S3.E4.m1.12.12.12.8.2.3" xref="S3.E4.m1.12.12.12.8.2.3.cmml"><mi id="S3.E4.m1.12.12.12.8.2.3.2" xref="S3.E4.m1.12.12.12.8.2.3.2.cmml">k</mi><mo id="S3.E4.m1.12.12.12.8.2.3.3" xref="S3.E4.m1.12.12.12.8.2.3.3.cmml">′</mo></msup></msub><mrow id="S3.E4.m1.12.12.12.8.1.1" xref="S3.E4.m1.12.12.12.8.1.2.cmml"><mi id="S3.E4.m1.10.10.10.6" xref="S3.E4.m1.10.10.10.6.cmml">exp</mi><mo id="S3.E4.m1.12.12.12.8.1.1a" xref="S3.E4.m1.12.12.12.8.1.2.cmml">⁡</mo><mrow id="S3.E4.m1.12.12.12.8.1.1.1" xref="S3.E4.m1.12.12.12.8.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.12.12.12.8.1.1.1.2" xref="S3.E4.m1.12.12.12.8.1.2.cmml">(</mo><mrow id="S3.E4.m1.12.12.12.8.1.1.1.1" xref="S3.E4.m1.12.12.12.8.1.1.1.1.cmml"><mi id="S3.E4.m1.12.12.12.8.1.1.1.1.4" xref="S3.E4.m1.12.12.12.8.1.1.1.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.12.12.12.8.1.1.1.1.3" xref="S3.E4.m1.12.12.12.8.1.1.1.1.3.cmml">​</mo><mi id="S3.E4.m1.12.12.12.8.1.1.1.1.5" xref="S3.E4.m1.12.12.12.8.1.1.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.12.12.12.8.1.1.1.1.3a" xref="S3.E4.m1.12.12.12.8.1.1.1.1.3.cmml">​</mo><mi id="S3.E4.m1.12.12.12.8.1.1.1.1.6" xref="S3.E4.m1.12.12.12.8.1.1.1.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.12.12.12.8.1.1.1.1.3b" xref="S3.E4.m1.12.12.12.8.1.1.1.1.3.cmml">​</mo><mrow id="S3.E4.m1.12.12.12.8.1.1.1.1.2.2" xref="S3.E4.m1.12.12.12.8.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.3" xref="S3.E4.m1.12.12.12.8.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1" xref="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1.2" xref="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1.3" xref="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.4" xref="S3.E4.m1.12.12.12.8.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.2" xref="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.2.2" xref="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.2.2.cmml">c</mi><mrow id="S3.E4.m1.8.8.8.4.2.2" xref="S3.E4.m1.8.8.8.4.2.3.cmml"><mi id="S3.E4.m1.7.7.7.3.1.1" xref="S3.E4.m1.7.7.7.3.1.1.cmml">i</mi><mo id="S3.E4.m1.8.8.8.4.2.2.2" xref="S3.E4.m1.8.8.8.4.2.3.cmml">,</mo><msup id="S3.E4.m1.8.8.8.4.2.2.1" xref="S3.E4.m1.8.8.8.4.2.2.1.cmml"><mi id="S3.E4.m1.8.8.8.4.2.2.1.2" xref="S3.E4.m1.8.8.8.4.2.2.1.2.cmml">k</mi><mo id="S3.E4.m1.8.8.8.4.2.2.1.3" xref="S3.E4.m1.8.8.8.4.2.2.1.3.cmml">′</mo></msup></mrow></msub><mo stretchy="false" id="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.5" xref="S3.E4.m1.12.12.12.8.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.12.12.12.8.1.1.1.3" xref="S3.E4.m1.12.12.12.8.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.12b"><apply id="S3.E4.m1.12.13.cmml" xref="S3.E4.m1.12.13"><eq id="S3.E4.m1.12.13.1.cmml" xref="S3.E4.m1.12.13.1"></eq><apply id="S3.E4.m1.12.13.2.cmml" xref="S3.E4.m1.12.13.2"><csymbol cd="ambiguous" id="S3.E4.m1.12.13.2.1.cmml" xref="S3.E4.m1.12.13.2">subscript</csymbol><ci id="S3.E4.m1.12.13.2.2.cmml" xref="S3.E4.m1.12.13.2.2">ℓ</ci><apply id="S3.E4.m1.12.13.2.3.cmml" xref="S3.E4.m1.12.13.2.3"><times id="S3.E4.m1.12.13.2.3.1.cmml" xref="S3.E4.m1.12.13.2.3.1"></times><ci id="S3.E4.m1.12.13.2.3.2.cmml" xref="S3.E4.m1.12.13.2.3.2">𝑔</ci><ci id="S3.E4.m1.12.13.2.3.3.cmml" xref="S3.E4.m1.12.13.2.3.3">𝑝</ci><ci id="S3.E4.m1.12.13.2.3.4.cmml" xref="S3.E4.m1.12.13.2.3.4">𝑐</ci></apply></apply><apply id="S3.E4.m1.12.13.3.cmml" xref="S3.E4.m1.12.13.3"><minus id="S3.E4.m1.12.13.3.1.cmml" xref="S3.E4.m1.12.13.3"></minus><apply id="S3.E4.m1.12.13.3.2.cmml" xref="S3.E4.m1.12.13.3.2"><log id="S3.E4.m1.12.13.3.2.1.cmml" xref="S3.E4.m1.12.13.3.2.1"></log><apply id="S3.E4.m1.12.12.cmml" xref="S3.E4.m1.12.12"><divide id="S3.E4.m1.12.12.13.cmml" xref="S3.E4.m1.12.12"></divide><apply id="S3.E4.m1.4.4.4.5.cmml" xref="S3.E4.m1.4.4.4.4"><exp id="S3.E4.m1.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3"></exp><apply id="S3.E4.m1.4.4.4.4.1.1.cmml" xref="S3.E4.m1.4.4.4.4.1.1"><times id="S3.E4.m1.4.4.4.4.1.1.3.cmml" xref="S3.E4.m1.4.4.4.4.1.1.3"></times><ci id="S3.E4.m1.4.4.4.4.1.1.4.cmml" xref="S3.E4.m1.4.4.4.4.1.1.4">𝑠</ci><ci id="S3.E4.m1.4.4.4.4.1.1.5.cmml" xref="S3.E4.m1.4.4.4.4.1.1.5">𝑖</ci><ci id="S3.E4.m1.4.4.4.4.1.1.6.cmml" xref="S3.E4.m1.4.4.4.4.1.1.6">𝑚</ci><interval closure="open" id="S3.E4.m1.4.4.4.4.1.1.2.3.cmml" xref="S3.E4.m1.4.4.4.4.1.1.2.2"><apply id="S3.E4.m1.4.4.4.4.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.4.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.4.4.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.4.4.1.1.1.1.1.2">𝑧</ci><ci id="S3.E4.m1.4.4.4.4.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.4.4.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E4.m1.4.4.4.4.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.4.1.1.2.2.2.1.cmml" xref="S3.E4.m1.4.4.4.4.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.4.4.4.4.1.1.2.2.2.2.cmml" xref="S3.E4.m1.4.4.4.4.1.1.2.2.2.2">𝑐</ci><list id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2">𝑘</ci></list></apply></interval></apply></apply><apply id="S3.E4.m1.12.12.12.cmml" xref="S3.E4.m1.12.12.12"><plus id="S3.E4.m1.12.12.12.9.cmml" xref="S3.E4.m1.12.12.12.9"></plus><apply id="S3.E4.m1.11.11.11.7.2.cmml" xref="S3.E4.m1.11.11.11.7.1"><exp id="S3.E4.m1.9.9.9.5.cmml" xref="S3.E4.m1.9.9.9.5"></exp><apply id="S3.E4.m1.11.11.11.7.1.1.1.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1"><times id="S3.E4.m1.11.11.11.7.1.1.1.3.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1.3"></times><ci id="S3.E4.m1.11.11.11.7.1.1.1.4.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1.4">𝑠</ci><ci id="S3.E4.m1.11.11.11.7.1.1.1.5.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1.5">𝑖</ci><ci id="S3.E4.m1.11.11.11.7.1.1.1.6.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1.6">𝑚</ci><interval closure="open" id="S3.E4.m1.11.11.11.7.1.1.1.2.3.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1.2.2"><apply id="S3.E4.m1.11.11.11.7.1.1.1.1.1.1.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.11.7.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.11.11.11.7.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E4.m1.11.11.11.7.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E4.m1.11.11.11.7.1.1.1.2.2.2.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.11.7.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.11.11.11.7.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.11.11.11.7.1.1.1.2.2.2.2">𝑐</ci><list id="S3.E4.m1.6.6.6.2.2.3.cmml" xref="S3.E4.m1.6.6.6.2.2.4"><ci id="S3.E4.m1.5.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.5.1.1.1">𝑖</ci><ci id="S3.E4.m1.6.6.6.2.2.2.cmml" xref="S3.E4.m1.6.6.6.2.2.2">𝑘</ci></list></apply></interval></apply></apply><apply id="S3.E4.m1.12.12.12.8.cmml" xref="S3.E4.m1.12.12.12.8"><apply id="S3.E4.m1.12.12.12.8.2.cmml" xref="S3.E4.m1.12.12.12.8.2"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.12.8.2.1.cmml" xref="S3.E4.m1.12.12.12.8.2">subscript</csymbol><sum id="S3.E4.m1.12.12.12.8.2.2.cmml" xref="S3.E4.m1.12.12.12.8.2.2"></sum><apply id="S3.E4.m1.12.12.12.8.2.3.cmml" xref="S3.E4.m1.12.12.12.8.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.12.8.2.3.1.cmml" xref="S3.E4.m1.12.12.12.8.2.3">superscript</csymbol><ci id="S3.E4.m1.12.12.12.8.2.3.2.cmml" xref="S3.E4.m1.12.12.12.8.2.3.2">𝑘</ci><ci id="S3.E4.m1.12.12.12.8.2.3.3.cmml" xref="S3.E4.m1.12.12.12.8.2.3.3">′</ci></apply></apply><apply id="S3.E4.m1.12.12.12.8.1.2.cmml" xref="S3.E4.m1.12.12.12.8.1.1"><exp id="S3.E4.m1.10.10.10.6.cmml" xref="S3.E4.m1.10.10.10.6"></exp><apply id="S3.E4.m1.12.12.12.8.1.1.1.1.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1"><times id="S3.E4.m1.12.12.12.8.1.1.1.1.3.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1.3"></times><ci id="S3.E4.m1.12.12.12.8.1.1.1.1.4.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1.4">𝑠</ci><ci id="S3.E4.m1.12.12.12.8.1.1.1.1.5.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1.5">𝑖</ci><ci id="S3.E4.m1.12.12.12.8.1.1.1.1.6.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1.6">𝑚</ci><interval closure="open" id="S3.E4.m1.12.12.12.8.1.1.1.1.2.3.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1.2.2"><apply id="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.12.12.12.8.1.1.1.1.2.2.2.2">𝑐</ci><list id="S3.E4.m1.8.8.8.4.2.3.cmml" xref="S3.E4.m1.8.8.8.4.2.2"><ci id="S3.E4.m1.7.7.7.3.1.1.cmml" xref="S3.E4.m1.7.7.7.3.1.1">𝑖</ci><apply id="S3.E4.m1.8.8.8.4.2.2.1.cmml" xref="S3.E4.m1.8.8.8.4.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.8.4.2.2.1.1.cmml" xref="S3.E4.m1.8.8.8.4.2.2.1">superscript</csymbol><ci id="S3.E4.m1.8.8.8.4.2.2.1.2.cmml" xref="S3.E4.m1.8.8.8.4.2.2.1.2">𝑘</ci><ci id="S3.E4.m1.8.8.8.4.2.2.1.3.cmml" xref="S3.E4.m1.8.8.8.4.2.2.1.3">′</ci></apply></list></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.12c">\ell_{gpc}=-\log\frac{\exp(sim(z_{j},c_{i,k}))}{\exp(sim(z_{j},c_{i,k}))+\sum_{k^{\prime}}\exp(sim(z_{j},c_{i,k^{\prime}}))}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSSx3.p1.10" class="ltx_p">where <math id="S3.SS3.SSSx3.p1.2.m1.10" class="ltx_Math" alttext="sim(z_{j},c_{i,k})=\frac{z_{j}^{\mathrm{T}}c_{i,k}}{\left\|z_{j}\right\|_{2}\cdot\left\|c_{i,k}\right\|_{2}}" display="inline"><semantics id="S3.SS3.SSSx3.p1.2.m1.10a"><mrow id="S3.SS3.SSSx3.p1.2.m1.10.10" xref="S3.SS3.SSSx3.p1.2.m1.10.10.cmml"><mrow id="S3.SS3.SSSx3.p1.2.m1.10.10.2" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.cmml"><mi id="S3.SS3.SSSx3.p1.2.m1.10.10.2.4" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx3.p1.2.m1.10.10.2.3" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.3.cmml">​</mo><mi id="S3.SS3.SSSx3.p1.2.m1.10.10.2.5" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx3.p1.2.m1.10.10.2.3a" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.3.cmml">​</mo><mi id="S3.SS3.SSSx3.p1.2.m1.10.10.2.6" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx3.p1.2.m1.10.10.2.3b" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.3.cmml">​</mo><mrow id="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.3" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.3.cmml">(</mo><msub id="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1" xref="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1.cmml"><mi id="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1.2" xref="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1.3" xref="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.4" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.3.cmml">,</mo><msub id="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.2" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.2.cmml"><mi id="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.2.2" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.2.2.cmml">c</mi><mrow id="S3.SS3.SSSx3.p1.2.m1.2.2.2.4" xref="S3.SS3.SSSx3.p1.2.m1.2.2.2.3.cmml"><mi id="S3.SS3.SSSx3.p1.2.m1.1.1.1.1" xref="S3.SS3.SSSx3.p1.2.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSSx3.p1.2.m1.2.2.2.4.1" xref="S3.SS3.SSSx3.p1.2.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSSx3.p1.2.m1.2.2.2.2" xref="S3.SS3.SSSx3.p1.2.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.5" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSSx3.p1.2.m1.10.10.3" xref="S3.SS3.SSSx3.p1.2.m1.10.10.3.cmml">=</mo><mfrac id="S3.SS3.SSSx3.p1.2.m1.8.8" xref="S3.SS3.SSSx3.p1.2.m1.8.8.cmml"><mrow id="S3.SS3.SSSx3.p1.2.m1.4.4.2" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.cmml"><msubsup id="S3.SS3.SSSx3.p1.2.m1.4.4.2.4" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.cmml"><mi id="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.2.2" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.2.2.cmml">z</mi><mi id="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.2.3" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.2.3.cmml">j</mi><mi mathvariant="normal" id="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.3" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx3.p1.2.m1.4.4.2.3" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.3.cmml">​</mo><msub id="S3.SS3.SSSx3.p1.2.m1.4.4.2.5" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.5.cmml"><mi id="S3.SS3.SSSx3.p1.2.m1.4.4.2.5.2" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.5.2.cmml">c</mi><mrow id="S3.SS3.SSSx3.p1.2.m1.4.4.2.2.2.4" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.2.2.3.cmml"><mi id="S3.SS3.SSSx3.p1.2.m1.3.3.1.1.1.1" xref="S3.SS3.SSSx3.p1.2.m1.3.3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSSx3.p1.2.m1.4.4.2.2.2.4.1" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSSx3.p1.2.m1.4.4.2.2.2.2" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.2.2.2.cmml">k</mi></mrow></msub></mrow><mrow id="S3.SS3.SSSx3.p1.2.m1.8.8.6" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.cmml"><msub id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.cmml"><mrow id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.2.cmml"><mo id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.2" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.2.1.cmml">‖</mo><msub id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1.cmml"><mi id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1.2" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1.3" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.3" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.3" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.3.cmml">2</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSSx3.p1.2.m1.8.8.6.5" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.5.cmml">⋅</mo><msub id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.cmml"><mrow id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.2.cmml"><mo id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.2" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.2.1.cmml">‖</mo><msub id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.1" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.1.cmml"><mi id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.1.2" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.1.2.cmml">c</mi><mrow id="S3.SS3.SSSx3.p1.2.m1.6.6.4.2.2.4" xref="S3.SS3.SSSx3.p1.2.m1.6.6.4.2.2.3.cmml"><mi id="S3.SS3.SSSx3.p1.2.m1.5.5.3.1.1.1" xref="S3.SS3.SSSx3.p1.2.m1.5.5.3.1.1.1.cmml">i</mi><mo id="S3.SS3.SSSx3.p1.2.m1.6.6.4.2.2.4.1" xref="S3.SS3.SSSx3.p1.2.m1.6.6.4.2.2.3.cmml">,</mo><mi id="S3.SS3.SSSx3.p1.2.m1.6.6.4.2.2.2" xref="S3.SS3.SSSx3.p1.2.m1.6.6.4.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.3" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.3" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.3.cmml">2</mn></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.2.m1.10b"><apply id="S3.SS3.SSSx3.p1.2.m1.10.10.cmml" xref="S3.SS3.SSSx3.p1.2.m1.10.10"><eq id="S3.SS3.SSSx3.p1.2.m1.10.10.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.10.10.3"></eq><apply id="S3.SS3.SSSx3.p1.2.m1.10.10.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2"><times id="S3.SS3.SSSx3.p1.2.m1.10.10.2.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.3"></times><ci id="S3.SS3.SSSx3.p1.2.m1.10.10.2.4.cmml" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.4">𝑠</ci><ci id="S3.SS3.SSSx3.p1.2.m1.10.10.2.5.cmml" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.5">𝑖</ci><ci id="S3.SS3.SSSx3.p1.2.m1.10.10.2.6.cmml" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.6">𝑚</ci><interval closure="open" id="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2"><apply id="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.9.9.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.2.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.2.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.10.10.2.2.2.2.2">𝑐</ci><list id="S3.SS3.SSSx3.p1.2.m1.2.2.2.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.2.2.2.4"><ci id="S3.SS3.SSSx3.p1.2.m1.1.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.1.1.1.1">𝑖</ci><ci id="S3.SS3.SSSx3.p1.2.m1.2.2.2.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.2.2.2.2">𝑘</ci></list></apply></interval></apply><apply id="S3.SS3.SSSx3.p1.2.m1.8.8.cmml" xref="S3.SS3.SSSx3.p1.2.m1.8.8"><divide id="S3.SS3.SSSx3.p1.2.m1.8.8.7.cmml" xref="S3.SS3.SSSx3.p1.2.m1.8.8"></divide><apply id="S3.SS3.SSSx3.p1.2.m1.4.4.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2"><times id="S3.SS3.SSSx3.p1.2.m1.4.4.2.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.3"></times><apply id="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.4">superscript</csymbol><apply id="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.2.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.4">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.2.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.2.2">𝑧</ci><ci id="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.2.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.2.3">𝑗</ci></apply><ci id="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.4.3">T</ci></apply><apply id="S3.SS3.SSSx3.p1.2.m1.4.4.2.5.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.5"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.2.m1.4.4.2.5.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.5">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.2.m1.4.4.2.5.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.5.2">𝑐</ci><list id="S3.SS3.SSSx3.p1.2.m1.4.4.2.2.2.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.2.2.4"><ci id="S3.SS3.SSSx3.p1.2.m1.3.3.1.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.3.3.1.1.1.1">𝑖</ci><ci id="S3.SS3.SSSx3.p1.2.m1.4.4.2.2.2.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.4.4.2.2.2.2">𝑘</ci></list></apply></apply><apply id="S3.SS3.SSSx3.p1.2.m1.8.8.6.cmml" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6"><ci id="S3.SS3.SSSx3.p1.2.m1.8.8.6.5.cmml" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.5">⋅</ci><apply id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3">subscript</csymbol><apply id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1"><csymbol cd="latexml" id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.2.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.2">norm</csymbol><apply id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.1.1.1.3">𝑗</ci></apply></apply><cn type="integer" id="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.7.7.5.3.3">2</cn></apply><apply id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.cmml" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4">subscript</csymbol><apply id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1"><csymbol cd="latexml" id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.2.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.2">norm</csymbol><apply id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.1">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.1.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.1.1.1.2">𝑐</ci><list id="S3.SS3.SSSx3.p1.2.m1.6.6.4.2.2.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.6.6.4.2.2.4"><ci id="S3.SS3.SSSx3.p1.2.m1.5.5.3.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.2.m1.5.5.3.1.1.1">𝑖</ci><ci id="S3.SS3.SSSx3.p1.2.m1.6.6.4.2.2.2.cmml" xref="S3.SS3.SSSx3.p1.2.m1.6.6.4.2.2.2">𝑘</ci></list></apply></apply><cn type="integer" id="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.3.cmml" xref="S3.SS3.SSSx3.p1.2.m1.8.8.6.4.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.2.m1.10c">sim(z_{j},c_{i,k})=\frac{z_{j}^{\mathrm{T}}c_{i,k}}{\left\|z_{j}\right\|_{2}\cdot\left\|c_{i,k}\right\|_{2}}</annotation></semantics></math> is the cosine similarity, and <math id="S3.SS3.SSSx3.p1.3.m2.1" class="ltx_Math" alttext="z_{j}" display="inline"><semantics id="S3.SS3.SSSx3.p1.3.m2.1a"><msub id="S3.SS3.SSSx3.p1.3.m2.1.1" xref="S3.SS3.SSSx3.p1.3.m2.1.1.cmml"><mi id="S3.SS3.SSSx3.p1.3.m2.1.1.2" xref="S3.SS3.SSSx3.p1.3.m2.1.1.2.cmml">z</mi><mi id="S3.SS3.SSSx3.p1.3.m2.1.1.3" xref="S3.SS3.SSSx3.p1.3.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.3.m2.1b"><apply id="S3.SS3.SSSx3.p1.3.m2.1.1.cmml" xref="S3.SS3.SSSx3.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.3.m2.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.3.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.3.m2.1.1.2.cmml" xref="S3.SS3.SSSx3.p1.3.m2.1.1.2">𝑧</ci><ci id="S3.SS3.SSSx3.p1.3.m2.1.1.3.cmml" xref="S3.SS3.SSSx3.p1.3.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.3.m2.1c">z_{j}</annotation></semantics></math> is the representation extracted by the feature extraction network when inputting <math id="S3.SS3.SSSx3.p1.4.m3.1" class="ltx_Math" alttext="x_{j}" display="inline"><semantics id="S3.SS3.SSSx3.p1.4.m3.1a"><msub id="S3.SS3.SSSx3.p1.4.m3.1.1" xref="S3.SS3.SSSx3.p1.4.m3.1.1.cmml"><mi id="S3.SS3.SSSx3.p1.4.m3.1.1.2" xref="S3.SS3.SSSx3.p1.4.m3.1.1.2.cmml">x</mi><mi id="S3.SS3.SSSx3.p1.4.m3.1.1.3" xref="S3.SS3.SSSx3.p1.4.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.4.m3.1b"><apply id="S3.SS3.SSSx3.p1.4.m3.1.1.cmml" xref="S3.SS3.SSSx3.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.4.m3.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.4.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.4.m3.1.1.2.cmml" xref="S3.SS3.SSSx3.p1.4.m3.1.1.2">𝑥</ci><ci id="S3.SS3.SSSx3.p1.4.m3.1.1.3.cmml" xref="S3.SS3.SSSx3.p1.4.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.4.m3.1c">x_{j}</annotation></semantics></math>.
Noth that, <math id="S3.SS3.SSSx3.p1.5.m4.2" class="ltx_Math" alttext="c_{i,k}" display="inline"><semantics id="S3.SS3.SSSx3.p1.5.m4.2a"><msub id="S3.SS3.SSSx3.p1.5.m4.2.3" xref="S3.SS3.SSSx3.p1.5.m4.2.3.cmml"><mi id="S3.SS3.SSSx3.p1.5.m4.2.3.2" xref="S3.SS3.SSSx3.p1.5.m4.2.3.2.cmml">c</mi><mrow id="S3.SS3.SSSx3.p1.5.m4.2.2.2.4" xref="S3.SS3.SSSx3.p1.5.m4.2.2.2.3.cmml"><mi id="S3.SS3.SSSx3.p1.5.m4.1.1.1.1" xref="S3.SS3.SSSx3.p1.5.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSSx3.p1.5.m4.2.2.2.4.1" xref="S3.SS3.SSSx3.p1.5.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSSx3.p1.5.m4.2.2.2.2" xref="S3.SS3.SSSx3.p1.5.m4.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.5.m4.2b"><apply id="S3.SS3.SSSx3.p1.5.m4.2.3.cmml" xref="S3.SS3.SSSx3.p1.5.m4.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.5.m4.2.3.1.cmml" xref="S3.SS3.SSSx3.p1.5.m4.2.3">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.5.m4.2.3.2.cmml" xref="S3.SS3.SSSx3.p1.5.m4.2.3.2">𝑐</ci><list id="S3.SS3.SSSx3.p1.5.m4.2.2.2.3.cmml" xref="S3.SS3.SSSx3.p1.5.m4.2.2.2.4"><ci id="S3.SS3.SSSx3.p1.5.m4.1.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.5.m4.1.1.1.1">𝑖</ci><ci id="S3.SS3.SSSx3.p1.5.m4.2.2.2.2.cmml" xref="S3.SS3.SSSx3.p1.5.m4.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.5.m4.2c">c_{i,k}</annotation></semantics></math> (resp. <math id="S3.SS3.SSSx3.p1.6.m5.2" class="ltx_Math" alttext="c_{i,k^{\prime}}" display="inline"><semantics id="S3.SS3.SSSx3.p1.6.m5.2a"><msub id="S3.SS3.SSSx3.p1.6.m5.2.3" xref="S3.SS3.SSSx3.p1.6.m5.2.3.cmml"><mi id="S3.SS3.SSSx3.p1.6.m5.2.3.2" xref="S3.SS3.SSSx3.p1.6.m5.2.3.2.cmml">c</mi><mrow id="S3.SS3.SSSx3.p1.6.m5.2.2.2.2" xref="S3.SS3.SSSx3.p1.6.m5.2.2.2.3.cmml"><mi id="S3.SS3.SSSx3.p1.6.m5.1.1.1.1" xref="S3.SS3.SSSx3.p1.6.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.2" xref="S3.SS3.SSSx3.p1.6.m5.2.2.2.3.cmml">,</mo><msup id="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1" xref="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1.cmml"><mi id="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1.2" xref="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1.2.cmml">k</mi><mo id="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1.3" xref="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1.3.cmml">′</mo></msup></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.6.m5.2b"><apply id="S3.SS3.SSSx3.p1.6.m5.2.3.cmml" xref="S3.SS3.SSSx3.p1.6.m5.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.6.m5.2.3.1.cmml" xref="S3.SS3.SSSx3.p1.6.m5.2.3">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.6.m5.2.3.2.cmml" xref="S3.SS3.SSSx3.p1.6.m5.2.3.2">𝑐</ci><list id="S3.SS3.SSSx3.p1.6.m5.2.2.2.3.cmml" xref="S3.SS3.SSSx3.p1.6.m5.2.2.2.2"><ci id="S3.SS3.SSSx3.p1.6.m5.1.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.6.m5.1.1.1.1">𝑖</ci><apply id="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1.cmml" xref="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1.1.cmml" xref="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1">superscript</csymbol><ci id="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1.2.cmml" xref="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1.2">𝑘</ci><ci id="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1.3.cmml" xref="S3.SS3.SSSx3.p1.6.m5.2.2.2.2.1.3">′</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.6.m5.2c">c_{i,k^{\prime}}</annotation></semantics></math>) denotes the mean representation of the samples belonging to class <math id="S3.SS3.SSSx3.p1.7.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.SSSx3.p1.7.m6.1a"><mi id="S3.SS3.SSSx3.p1.7.m6.1.1" xref="S3.SS3.SSSx3.p1.7.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.7.m6.1b"><ci id="S3.SS3.SSSx3.p1.7.m6.1.1.cmml" xref="S3.SS3.SSSx3.p1.7.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.7.m6.1c">k</annotation></semantics></math> (resp. other classes except for class <math id="S3.SS3.SSSx3.p1.8.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.SSSx3.p1.8.m7.1a"><mi id="S3.SS3.SSSx3.p1.8.m7.1.1" xref="S3.SS3.SSSx3.p1.8.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.8.m7.1b"><ci id="S3.SS3.SSSx3.p1.8.m7.1.1.cmml" xref="S3.SS3.SSSx3.p1.8.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.8.m7.1c">k</annotation></semantics></math>) in the client <math id="S3.SS3.SSSx3.p1.9.m8.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.SS3.SSSx3.p1.9.m8.1a"><msub id="S3.SS3.SSSx3.p1.9.m8.1.1" xref="S3.SS3.SSSx3.p1.9.m8.1.1.cmml"><mi id="S3.SS3.SSSx3.p1.9.m8.1.1.2" xref="S3.SS3.SSSx3.p1.9.m8.1.1.2.cmml">C</mi><mi id="S3.SS3.SSSx3.p1.9.m8.1.1.3" xref="S3.SS3.SSSx3.p1.9.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.9.m8.1b"><apply id="S3.SS3.SSSx3.p1.9.m8.1.1.cmml" xref="S3.SS3.SSSx3.p1.9.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.9.m8.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.9.m8.1.1">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.9.m8.1.1.2.cmml" xref="S3.SS3.SSSx3.p1.9.m8.1.1.2">𝐶</ci><ci id="S3.SS3.SSSx3.p1.9.m8.1.1.3.cmml" xref="S3.SS3.SSSx3.p1.9.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.9.m8.1c">C_{i}</annotation></semantics></math>.
The prototype <math id="S3.SS3.SSSx3.p1.10.m9.2" class="ltx_Math" alttext="c_{i,k}\in\mathbb{R}^{Q}" display="inline"><semantics id="S3.SS3.SSSx3.p1.10.m9.2a"><mrow id="S3.SS3.SSSx3.p1.10.m9.2.3" xref="S3.SS3.SSSx3.p1.10.m9.2.3.cmml"><msub id="S3.SS3.SSSx3.p1.10.m9.2.3.2" xref="S3.SS3.SSSx3.p1.10.m9.2.3.2.cmml"><mi id="S3.SS3.SSSx3.p1.10.m9.2.3.2.2" xref="S3.SS3.SSSx3.p1.10.m9.2.3.2.2.cmml">c</mi><mrow id="S3.SS3.SSSx3.p1.10.m9.2.2.2.4" xref="S3.SS3.SSSx3.p1.10.m9.2.2.2.3.cmml"><mi id="S3.SS3.SSSx3.p1.10.m9.1.1.1.1" xref="S3.SS3.SSSx3.p1.10.m9.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSSx3.p1.10.m9.2.2.2.4.1" xref="S3.SS3.SSSx3.p1.10.m9.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSSx3.p1.10.m9.2.2.2.2" xref="S3.SS3.SSSx3.p1.10.m9.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.SS3.SSSx3.p1.10.m9.2.3.1" xref="S3.SS3.SSSx3.p1.10.m9.2.3.1.cmml">∈</mo><msup id="S3.SS3.SSSx3.p1.10.m9.2.3.3" xref="S3.SS3.SSSx3.p1.10.m9.2.3.3.cmml"><mi id="S3.SS3.SSSx3.p1.10.m9.2.3.3.2" xref="S3.SS3.SSSx3.p1.10.m9.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSSx3.p1.10.m9.2.3.3.3" xref="S3.SS3.SSSx3.p1.10.m9.2.3.3.3.cmml">Q</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.10.m9.2b"><apply id="S3.SS3.SSSx3.p1.10.m9.2.3.cmml" xref="S3.SS3.SSSx3.p1.10.m9.2.3"><in id="S3.SS3.SSSx3.p1.10.m9.2.3.1.cmml" xref="S3.SS3.SSSx3.p1.10.m9.2.3.1"></in><apply id="S3.SS3.SSSx3.p1.10.m9.2.3.2.cmml" xref="S3.SS3.SSSx3.p1.10.m9.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.10.m9.2.3.2.1.cmml" xref="S3.SS3.SSSx3.p1.10.m9.2.3.2">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.10.m9.2.3.2.2.cmml" xref="S3.SS3.SSSx3.p1.10.m9.2.3.2.2">𝑐</ci><list id="S3.SS3.SSSx3.p1.10.m9.2.2.2.3.cmml" xref="S3.SS3.SSSx3.p1.10.m9.2.2.2.4"><ci id="S3.SS3.SSSx3.p1.10.m9.1.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.10.m9.1.1.1.1">𝑖</ci><ci id="S3.SS3.SSSx3.p1.10.m9.2.2.2.2.cmml" xref="S3.SS3.SSSx3.p1.10.m9.2.2.2.2">𝑘</ci></list></apply><apply id="S3.SS3.SSSx3.p1.10.m9.2.3.3.cmml" xref="S3.SS3.SSSx3.p1.10.m9.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.10.m9.2.3.3.1.cmml" xref="S3.SS3.SSSx3.p1.10.m9.2.3.3">superscript</csymbol><ci id="S3.SS3.SSSx3.p1.10.m9.2.3.3.2.cmml" xref="S3.SS3.SSSx3.p1.10.m9.2.3.3.2">ℝ</ci><ci id="S3.SS3.SSSx3.p1.10.m9.2.3.3.3.cmml" xref="S3.SS3.SSSx3.p1.10.m9.2.3.3.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.10.m9.2c">c_{i,k}\in\mathbb{R}^{Q}</annotation></semantics></math> is formulated as</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.7" class="ltx_Math" alttext="c_{i,k}=\frac{1}{\left|\mathcal{D}_{i}^{k}\right|}\sum_{(x,y)\in\mathcal{D}_{i}^{k}}f_{e}(w_{e_{i}};x)" display="block"><semantics id="S3.E5.m1.7a"><mrow id="S3.E5.m1.7.7" xref="S3.E5.m1.7.7.cmml"><msub id="S3.E5.m1.7.7.3" xref="S3.E5.m1.7.7.3.cmml"><mi id="S3.E5.m1.7.7.3.2" xref="S3.E5.m1.7.7.3.2.cmml">c</mi><mrow id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.2.2.2.4.1" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.E5.m1.7.7.2" xref="S3.E5.m1.7.7.2.cmml">=</mo><mrow id="S3.E5.m1.7.7.1" xref="S3.E5.m1.7.7.1.cmml"><mfrac id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml"><mn id="S3.E5.m1.3.3.3" xref="S3.E5.m1.3.3.3.cmml">1</mn><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.2.cmml"><mo id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.2.1.cmml">|</mo><msubsup id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.1.1.1.2.2" xref="S3.E5.m1.3.3.1.1.1.2.2.cmml">𝒟</mi><mi id="S3.E5.m1.3.3.1.1.1.2.3" xref="S3.E5.m1.3.3.1.1.1.2.3.cmml">i</mi><mi id="S3.E5.m1.3.3.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.E5.m1.3.3.1.1.3" xref="S3.E5.m1.3.3.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.1.2" xref="S3.E5.m1.7.7.1.2.cmml">​</mo><mrow id="S3.E5.m1.7.7.1.1" xref="S3.E5.m1.7.7.1.1.cmml"><munder id="S3.E5.m1.7.7.1.1.2" xref="S3.E5.m1.7.7.1.1.2.cmml"><mo movablelimits="false" id="S3.E5.m1.7.7.1.1.2.2" xref="S3.E5.m1.7.7.1.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.5.5.2" xref="S3.E5.m1.5.5.2.cmml"><mrow id="S3.E5.m1.5.5.2.4.2" xref="S3.E5.m1.5.5.2.4.1.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.2.4.2.1" xref="S3.E5.m1.5.5.2.4.1.cmml">(</mo><mi id="S3.E5.m1.4.4.1.1" xref="S3.E5.m1.4.4.1.1.cmml">x</mi><mo id="S3.E5.m1.5.5.2.4.2.2" xref="S3.E5.m1.5.5.2.4.1.cmml">,</mo><mi id="S3.E5.m1.5.5.2.2" xref="S3.E5.m1.5.5.2.2.cmml">y</mi><mo stretchy="false" id="S3.E5.m1.5.5.2.4.2.3" xref="S3.E5.m1.5.5.2.4.1.cmml">)</mo></mrow><mo id="S3.E5.m1.5.5.2.3" xref="S3.E5.m1.5.5.2.3.cmml">∈</mo><msubsup id="S3.E5.m1.5.5.2.5" xref="S3.E5.m1.5.5.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.5.5.2.5.2.2" xref="S3.E5.m1.5.5.2.5.2.2.cmml">𝒟</mi><mi id="S3.E5.m1.5.5.2.5.2.3" xref="S3.E5.m1.5.5.2.5.2.3.cmml">i</mi><mi id="S3.E5.m1.5.5.2.5.3" xref="S3.E5.m1.5.5.2.5.3.cmml">k</mi></msubsup></mrow></munder><mrow id="S3.E5.m1.7.7.1.1.1" xref="S3.E5.m1.7.7.1.1.1.cmml"><msub id="S3.E5.m1.7.7.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.3.cmml"><mi id="S3.E5.m1.7.7.1.1.1.3.2" xref="S3.E5.m1.7.7.1.1.1.3.2.cmml">f</mi><mi id="S3.E5.m1.7.7.1.1.1.3.3" xref="S3.E5.m1.7.7.1.1.1.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.1.1.1.2" xref="S3.E5.m1.7.7.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.7.7.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.7.7.1.1.1.1.1.2" xref="S3.E5.m1.7.7.1.1.1.1.2.cmml">(</mo><msub id="S3.E5.m1.7.7.1.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.2.cmml">w</mi><msub id="S3.E5.m1.7.7.1.1.1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.3.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.3.2.cmml">e</mi><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.3.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="S3.E5.m1.7.7.1.1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.1.2.cmml">;</mo><mi id="S3.E5.m1.6.6" xref="S3.E5.m1.6.6.cmml">x</mi><mo stretchy="false" id="S3.E5.m1.7.7.1.1.1.1.1.4" xref="S3.E5.m1.7.7.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.7b"><apply id="S3.E5.m1.7.7.cmml" xref="S3.E5.m1.7.7"><eq id="S3.E5.m1.7.7.2.cmml" xref="S3.E5.m1.7.7.2"></eq><apply id="S3.E5.m1.7.7.3.cmml" xref="S3.E5.m1.7.7.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.3.1.cmml" xref="S3.E5.m1.7.7.3">subscript</csymbol><ci id="S3.E5.m1.7.7.3.2.cmml" xref="S3.E5.m1.7.7.3.2">𝑐</ci><list id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.4"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑖</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑘</ci></list></apply><apply id="S3.E5.m1.7.7.1.cmml" xref="S3.E5.m1.7.7.1"><times id="S3.E5.m1.7.7.1.2.cmml" xref="S3.E5.m1.7.7.1.2"></times><apply id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3"><divide id="S3.E5.m1.3.3.2.cmml" xref="S3.E5.m1.3.3"></divide><cn type="integer" id="S3.E5.m1.3.3.3.cmml" xref="S3.E5.m1.3.3.3">1</cn><apply id="S3.E5.m1.3.3.1.2.cmml" xref="S3.E5.m1.3.3.1.1"><abs id="S3.E5.m1.3.3.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2"></abs><apply id="S3.E5.m1.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1">superscript</csymbol><apply id="S3.E5.m1.3.3.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.2.2">𝒟</ci><ci id="S3.E5.m1.3.3.1.1.1.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E5.m1.3.3.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S3.E5.m1.7.7.1.1.cmml" xref="S3.E5.m1.7.7.1.1"><apply id="S3.E5.m1.7.7.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.2.1.cmml" xref="S3.E5.m1.7.7.1.1.2">subscript</csymbol><sum id="S3.E5.m1.7.7.1.1.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2"></sum><apply id="S3.E5.m1.5.5.2.cmml" xref="S3.E5.m1.5.5.2"><in id="S3.E5.m1.5.5.2.3.cmml" xref="S3.E5.m1.5.5.2.3"></in><interval closure="open" id="S3.E5.m1.5.5.2.4.1.cmml" xref="S3.E5.m1.5.5.2.4.2"><ci id="S3.E5.m1.4.4.1.1.cmml" xref="S3.E5.m1.4.4.1.1">𝑥</ci><ci id="S3.E5.m1.5.5.2.2.cmml" xref="S3.E5.m1.5.5.2.2">𝑦</ci></interval><apply id="S3.E5.m1.5.5.2.5.cmml" xref="S3.E5.m1.5.5.2.5"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.2.5.1.cmml" xref="S3.E5.m1.5.5.2.5">superscript</csymbol><apply id="S3.E5.m1.5.5.2.5.2.cmml" xref="S3.E5.m1.5.5.2.5"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.2.5.2.1.cmml" xref="S3.E5.m1.5.5.2.5">subscript</csymbol><ci id="S3.E5.m1.5.5.2.5.2.2.cmml" xref="S3.E5.m1.5.5.2.5.2.2">𝒟</ci><ci id="S3.E5.m1.5.5.2.5.2.3.cmml" xref="S3.E5.m1.5.5.2.5.2.3">𝑖</ci></apply><ci id="S3.E5.m1.5.5.2.5.3.cmml" xref="S3.E5.m1.5.5.2.5.3">𝑘</ci></apply></apply></apply><apply id="S3.E5.m1.7.7.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1"><times id="S3.E5.m1.7.7.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.2"></times><apply id="S3.E5.m1.7.7.1.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.3.1.cmml" xref="S3.E5.m1.7.7.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.3.2.cmml" xref="S3.E5.m1.7.7.1.1.1.3.2">𝑓</ci><ci id="S3.E5.m1.7.7.1.1.1.3.3.cmml" xref="S3.E5.m1.7.7.1.1.1.3.3">𝑒</ci></apply><list id="S3.E5.m1.7.7.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1"><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.2">𝑤</ci><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.3.2">𝑒</ci><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S3.E5.m1.6.6.cmml" xref="S3.E5.m1.6.6">𝑥</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.7c">c_{i,k}=\frac{1}{\left|\mathcal{D}_{i}^{k}\right|}\sum_{(x,y)\in\mathcal{D}_{i}^{k}}f_{e}(w_{e_{i}};x)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSSx3.p1.13" class="ltx_p">where <math id="S3.SS3.SSSx3.p1.11.m1.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{k}" display="inline"><semantics id="S3.SS3.SSSx3.p1.11.m1.1a"><msubsup id="S3.SS3.SSSx3.p1.11.m1.1.1" xref="S3.SS3.SSSx3.p1.11.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx3.p1.11.m1.1.1.2.2" xref="S3.SS3.SSSx3.p1.11.m1.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS3.SSSx3.p1.11.m1.1.1.2.3" xref="S3.SS3.SSSx3.p1.11.m1.1.1.2.3.cmml">i</mi><mi id="S3.SS3.SSSx3.p1.11.m1.1.1.3" xref="S3.SS3.SSSx3.p1.11.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.11.m1.1b"><apply id="S3.SS3.SSSx3.p1.11.m1.1.1.cmml" xref="S3.SS3.SSSx3.p1.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.11.m1.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.11.m1.1.1">superscript</csymbol><apply id="S3.SS3.SSSx3.p1.11.m1.1.1.2.cmml" xref="S3.SS3.SSSx3.p1.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.11.m1.1.1.2.1.cmml" xref="S3.SS3.SSSx3.p1.11.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.11.m1.1.1.2.2.cmml" xref="S3.SS3.SSSx3.p1.11.m1.1.1.2.2">𝒟</ci><ci id="S3.SS3.SSSx3.p1.11.m1.1.1.2.3.cmml" xref="S3.SS3.SSSx3.p1.11.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.SSSx3.p1.11.m1.1.1.3.cmml" xref="S3.SS3.SSSx3.p1.11.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.11.m1.1c">\mathcal{D}_{i}^{k}</annotation></semantics></math> is the data of class <math id="S3.SS3.SSSx3.p1.12.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.SSSx3.p1.12.m2.1a"><mi id="S3.SS3.SSSx3.p1.12.m2.1.1" xref="S3.SS3.SSSx3.p1.12.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.12.m2.1b"><ci id="S3.SS3.SSSx3.p1.12.m2.1.1.cmml" xref="S3.SS3.SSSx3.p1.12.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.12.m2.1c">k</annotation></semantics></math> in the client <math id="S3.SS3.SSSx3.p1.13.m3.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.SS3.SSSx3.p1.13.m3.1a"><msub id="S3.SS3.SSSx3.p1.13.m3.1.1" xref="S3.SS3.SSSx3.p1.13.m3.1.1.cmml"><mi id="S3.SS3.SSSx3.p1.13.m3.1.1.2" xref="S3.SS3.SSSx3.p1.13.m3.1.1.2.cmml">C</mi><mi id="S3.SS3.SSSx3.p1.13.m3.1.1.3" xref="S3.SS3.SSSx3.p1.13.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx3.p1.13.m3.1b"><apply id="S3.SS3.SSSx3.p1.13.m3.1.1.cmml" xref="S3.SS3.SSSx3.p1.13.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx3.p1.13.m3.1.1.1.cmml" xref="S3.SS3.SSSx3.p1.13.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSSx3.p1.13.m3.1.1.2.cmml" xref="S3.SS3.SSSx3.p1.13.m3.1.1.2">𝐶</ci><ci id="S3.SS3.SSSx3.p1.13.m3.1.1.3.cmml" xref="S3.SS3.SSSx3.p1.13.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx3.p1.13.m3.1c">C_{i}</annotation></semantics></math>.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We implemented FedProc by PyTorch and ran experiments on the machines running Ubuntu 18.04 and equipped with two NVIDIA GeForce RTX 3090 GPUs and an Intel(R) Core(TM) i9-10900K CPU. To demonstrate the superiority of our work, we compare with the state-of-the-art federated learning algorithms, including 1) MOON <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>, 2) FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite>, 3) FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib22" title="" class="ltx_ref">2020b</a>)</cite>, 4)SCAFFOLD <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al. <a href="#bib.bib17" title="" class="ltx_ref">2019</a>)</cite>, and SOLO. Recall that SOLO is a baseline approach where each client trains a model with its local data without federated learning. In the following experiments, unless explicitly stated, all comparisons with the prior arts use reported results from respective papers.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.8" class="ltx_p">We conduct experiments over three standard datasets: CIFAR-10 (60,000 images with 10 classes), CIFAR-100 (60,000 images with 100 classes), and Tiny-ImageNet (100,000 images with 200 classes). For a fair comparison, we use the same modules in the local network for all approaches. As in the previous work <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>, we use a simple CNN model as the base encoder for CIFAR-<math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><cn type="integer" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">10</annotation></semantics></math> and use ResNet-50 <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite> as the base encoder for CIFAR-100 and Tiny-ImageNet. Note that the simple CNN model has two <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="5\times 5" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mn id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><times id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></times><cn type="integer" id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">5</cn><cn type="integer" id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">5\times 5</annotation></semantics></math> convolution layers followed by <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="2\times 2" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mn id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><times id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1"></times><cn type="integer" id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">2</cn><cn type="integer" id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">2\times 2</annotation></semantics></math> max pooling and two fully connected layers with ReLU activation.
For all datasets, the projection head consists of a 2-layer MLP with an output size of 256, and the output layer is just a single linear layer. We use Dirichlet distribution to generate the non-IID data distribution as previous studies <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib34" title="" class="ltx_ref">2020a</a>; Yurochkin et al. <a href="#bib.bib38" title="" class="ltx_ref">2019</a>)</cite>. Specifically, we draw <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="p^{k}\sim DirN(\beta)" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.2" xref="S4.SS1.p1.4.m4.1.2.cmml"><msup id="S4.SS1.p1.4.m4.1.2.2" xref="S4.SS1.p1.4.m4.1.2.2.cmml"><mi id="S4.SS1.p1.4.m4.1.2.2.2" xref="S4.SS1.p1.4.m4.1.2.2.2.cmml">p</mi><mi id="S4.SS1.p1.4.m4.1.2.2.3" xref="S4.SS1.p1.4.m4.1.2.2.3.cmml">k</mi></msup><mo id="S4.SS1.p1.4.m4.1.2.1" xref="S4.SS1.p1.4.m4.1.2.1.cmml">∼</mo><mrow id="S4.SS1.p1.4.m4.1.2.3" xref="S4.SS1.p1.4.m4.1.2.3.cmml"><mi id="S4.SS1.p1.4.m4.1.2.3.2" xref="S4.SS1.p1.4.m4.1.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.1.2.3.1" xref="S4.SS1.p1.4.m4.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.4.m4.1.2.3.3" xref="S4.SS1.p1.4.m4.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.1.2.3.1a" xref="S4.SS1.p1.4.m4.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.4.m4.1.2.3.4" xref="S4.SS1.p1.4.m4.1.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.1.2.3.1b" xref="S4.SS1.p1.4.m4.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.4.m4.1.2.3.5" xref="S4.SS1.p1.4.m4.1.2.3.5.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.1.2.3.1c" xref="S4.SS1.p1.4.m4.1.2.3.1.cmml">​</mo><mrow id="S4.SS1.p1.4.m4.1.2.3.6.2" xref="S4.SS1.p1.4.m4.1.2.3.cmml"><mo stretchy="false" id="S4.SS1.p1.4.m4.1.2.3.6.2.1" xref="S4.SS1.p1.4.m4.1.2.3.cmml">(</mo><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">β</mi><mo stretchy="false" id="S4.SS1.p1.4.m4.1.2.3.6.2.2" xref="S4.SS1.p1.4.m4.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.2.cmml" xref="S4.SS1.p1.4.m4.1.2"><csymbol cd="latexml" id="S4.SS1.p1.4.m4.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.2.1">similar-to</csymbol><apply id="S4.SS1.p1.4.m4.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.2.2.1.cmml" xref="S4.SS1.p1.4.m4.1.2.2">superscript</csymbol><ci id="S4.SS1.p1.4.m4.1.2.2.2.cmml" xref="S4.SS1.p1.4.m4.1.2.2.2">𝑝</ci><ci id="S4.SS1.p1.4.m4.1.2.2.3.cmml" xref="S4.SS1.p1.4.m4.1.2.2.3">𝑘</ci></apply><apply id="S4.SS1.p1.4.m4.1.2.3.cmml" xref="S4.SS1.p1.4.m4.1.2.3"><times id="S4.SS1.p1.4.m4.1.2.3.1.cmml" xref="S4.SS1.p1.4.m4.1.2.3.1"></times><ci id="S4.SS1.p1.4.m4.1.2.3.2.cmml" xref="S4.SS1.p1.4.m4.1.2.3.2">𝐷</ci><ci id="S4.SS1.p1.4.m4.1.2.3.3.cmml" xref="S4.SS1.p1.4.m4.1.2.3.3">𝑖</ci><ci id="S4.SS1.p1.4.m4.1.2.3.4.cmml" xref="S4.SS1.p1.4.m4.1.2.3.4">𝑟</ci><ci id="S4.SS1.p1.4.m4.1.2.3.5.cmml" xref="S4.SS1.p1.4.m4.1.2.3.5">𝑁</ci><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝛽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">p^{k}\sim DirN(\beta)</annotation></semantics></math> from a Dirichlet distribution and allocate a <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="p^{k}_{i}" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><msubsup id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2.2" xref="S4.SS1.p1.5.m5.1.1.2.2.cmml">p</mi><mi id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">i</mi><mi id="S4.SS1.p1.5.m5.1.1.2.3" xref="S4.SS1.p1.5.m5.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">subscript</csymbol><apply id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2.2">𝑝</ci><ci id="S4.SS1.p1.5.m5.1.1.2.3.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3">𝑘</ci></apply><ci id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">p^{k}_{i}</annotation></semantics></math> proportion of the instances of class <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">k</annotation></semantics></math> to client <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><msub id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">C</mi><mi id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">𝐶</ci><ci id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">C_{i}</annotation></semantics></math>, where <math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mi id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><ci id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">\beta</annotation></semantics></math> is a concentration parameter controlling the identicalness among clients.
Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Experimental Setup ‣ 4 Experiment ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> lists the default configuration of our work.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>The default configuration of our work</figcaption>
<table id="S4.T1.14" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.14.15.1" class="ltx_tr">
<th id="S4.T1.14.15.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:9.4pt;padding-right:9.4pt;">Parameter</th>
<th id="S4.T1.14.15.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:9.4pt;padding-right:9.4pt;">Default value</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.4.4" class="ltx_tr">
<th id="S4.T1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:9.4pt;padding-right:9.4pt;">Learning rate (<math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mi id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">\eta</annotation></semantics></math>)</th>
<td id="S4.T1.4.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.4pt;padding-right:9.4pt;">
<table id="S4.T1.4.4.4.3" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.3.3.3.2.2" class="ltx_tr">
<td id="S4.T1.3.3.3.2.2.2" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:9.4pt;padding-right:9.4pt;">
<math id="S4.T1.2.2.2.1.1.1.m1.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S4.T1.2.2.2.1.1.1.m1.1a"><mn id="S4.T1.2.2.2.1.1.1.m1.1.1" xref="S4.T1.2.2.2.1.1.1.m1.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.1.1.1.m1.1b"><cn type="float" id="S4.T1.2.2.2.1.1.1.m1.1.1.cmml" xref="S4.T1.2.2.2.1.1.1.m1.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.1.1.1.m1.1c">0.01</annotation></semantics></math>(CIFAR-<math id="S4.T1.3.3.3.2.2.2.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.T1.3.3.3.2.2.2.m2.1a"><mn id="S4.T1.3.3.3.2.2.2.m2.1.1" xref="S4.T1.3.3.3.2.2.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.2.2.2.m2.1b"><cn type="integer" id="S4.T1.3.3.3.2.2.2.m2.1.1.cmml" xref="S4.T1.3.3.3.2.2.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.2.2.2.m2.1c">10</annotation></semantics></math>)</td>
</tr>
<tr id="S4.T1.4.4.4.3.3" class="ltx_tr">
<td id="S4.T1.4.4.4.3.3.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:9.4pt;padding-right:9.4pt;">
<math id="S4.T1.4.4.4.3.3.1.m1.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S4.T1.4.4.4.3.3.1.m1.1a"><mn id="S4.T1.4.4.4.3.3.1.m1.1.1" xref="S4.T1.4.4.4.3.3.1.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.3.3.1.m1.1b"><cn type="float" id="S4.T1.4.4.4.3.3.1.m1.1.1.cmml" xref="S4.T1.4.4.4.3.3.1.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.3.3.1.m1.1c">0.1</annotation></semantics></math> (others)</td>
</tr>
</table>
</td>
</tr>
<tr id="S4.T1.6.6" class="ltx_tr">
<th id="S4.T1.5.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:9.4pt;padding-right:9.4pt;">Batch size (<math id="S4.T1.5.5.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.T1.5.5.1.m1.1a"><mi id="S4.T1.5.5.1.m1.1.1" xref="S4.T1.5.5.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.1.m1.1b"><ci id="S4.T1.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.1.m1.1c">B</annotation></semantics></math>)</th>
<td id="S4.T1.6.6.2" class="ltx_td ltx_align_center" style="padding-left:9.4pt;padding-right:9.4pt;"><math id="S4.T1.6.6.2.m1.1" class="ltx_Math" alttext="64" display="inline"><semantics id="S4.T1.6.6.2.m1.1a"><mn id="S4.T1.6.6.2.m1.1.1" xref="S4.T1.6.6.2.m1.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.2.m1.1b"><cn type="integer" id="S4.T1.6.6.2.m1.1.1.cmml" xref="S4.T1.6.6.2.m1.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.2.m1.1c">64</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.8.8" class="ltx_tr">
<th id="S4.T1.7.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:9.4pt;padding-right:9.4pt;">Number of clients (<math id="S4.T1.7.7.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.T1.7.7.1.m1.1a"><mi id="S4.T1.7.7.1.m1.1.1" xref="S4.T1.7.7.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.1.m1.1b"><ci id="S4.T1.7.7.1.m1.1.1.cmml" xref="S4.T1.7.7.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.1.m1.1c">m</annotation></semantics></math>)</th>
<td id="S4.T1.8.8.2" class="ltx_td ltx_align_center" style="padding-left:9.4pt;padding-right:9.4pt;"><math id="S4.T1.8.8.2.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.T1.8.8.2.m1.1a"><mn id="S4.T1.8.8.2.m1.1.1" xref="S4.T1.8.8.2.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.2.m1.1b"><cn type="integer" id="S4.T1.8.8.2.m1.1.1.cmml" xref="S4.T1.8.8.2.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.2.m1.1c">10</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.10.10" class="ltx_tr">
<th id="S4.T1.9.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:9.4pt;padding-right:9.4pt;">Number of communication rounds (<math id="S4.T1.9.9.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.T1.9.9.1.m1.1a"><mi id="S4.T1.9.9.1.m1.1.1" xref="S4.T1.9.9.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.1.m1.1b"><ci id="S4.T1.9.9.1.m1.1.1.cmml" xref="S4.T1.9.9.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.1.m1.1c">T</annotation></semantics></math>)</th>
<td id="S4.T1.10.10.2" class="ltx_td ltx_align_center" style="padding-left:9.4pt;padding-right:9.4pt;"><math id="S4.T1.10.10.2.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.T1.10.10.2.m1.1a"><mn id="S4.T1.10.10.2.m1.1.1" xref="S4.T1.10.10.2.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.T1.10.10.2.m1.1b"><cn type="integer" id="S4.T1.10.10.2.m1.1.1.cmml" xref="S4.T1.10.10.2.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.10.2.m1.1c">100</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.12.12" class="ltx_tr">
<th id="S4.T1.11.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:9.4pt;padding-right:9.4pt;">Number of local epochs (<math id="S4.T1.11.11.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.T1.11.11.1.m1.1a"><mi id="S4.T1.11.11.1.m1.1.1" xref="S4.T1.11.11.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.1.m1.1b"><ci id="S4.T1.11.11.1.m1.1.1.cmml" xref="S4.T1.11.11.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.1.m1.1c">E</annotation></semantics></math>)</th>
<td id="S4.T1.12.12.2" class="ltx_td ltx_align_center" style="padding-left:9.4pt;padding-right:9.4pt;"><math id="S4.T1.12.12.2.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.T1.12.12.2.m1.1a"><mn id="S4.T1.12.12.2.m1.1.1" xref="S4.T1.12.12.2.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.T1.12.12.2.m1.1b"><cn type="integer" id="S4.T1.12.12.2.m1.1.1.cmml" xref="S4.T1.12.12.2.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.12.2.m1.1c">10</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.14.14" class="ltx_tr">
<th id="S4.T1.13.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:9.4pt;padding-right:9.4pt;">Concentration parameter (<math id="S4.T1.13.13.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.T1.13.13.1.m1.1a"><mi id="S4.T1.13.13.1.m1.1.1" xref="S4.T1.13.13.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T1.13.13.1.m1.1b"><ci id="S4.T1.13.13.1.m1.1.1.cmml" xref="S4.T1.13.13.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.13.1.m1.1c">\beta</annotation></semantics></math>)</th>
<td id="S4.T1.14.14.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:9.4pt;padding-right:9.4pt;"><math id="S4.T1.14.14.2.m1.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S4.T1.14.14.2.m1.1a"><mn id="S4.T1.14.14.2.m1.1.1" xref="S4.T1.14.14.2.m1.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S4.T1.14.14.2.m1.1b"><cn type="float" id="S4.T1.14.14.2.m1.1.1.cmml" xref="S4.T1.14.14.2.m1.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.14.2.m1.1c">0.5</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x8.png" id="S4.F4.sf1.g1" class="ltx_graphics ltx_img_portrait" width="173" height="223" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>CIFAR-10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x9.png" id="S4.F4.sf2.g1" class="ltx_graphics ltx_img_portrait" width="173" height="223" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>CIFAR-100</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F4.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x10.png" id="S4.F4.sf3.g1" class="ltx_graphics ltx_img_portrait" width="173" height="223" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Tiny-ImageNet</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The top-1 test accuracy with different number of communication rounds (<math id="S4.F4.2.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.F4.2.m1.1b"><mi id="S4.F4.2.m1.1.1" xref="S4.F4.2.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.F4.2.m1.1c"><ci id="S4.F4.2.m1.1.1.cmml" xref="S4.F4.2.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.m1.1d">T</annotation></semantics></math>).</figcaption>
</figure>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x11.png" id="S4.F5.sf1.g1" class="ltx_graphics ltx_img_portrait" width="173" height="223" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>CIFAR-10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x12.png" id="S4.F5.sf2.g1" class="ltx_graphics ltx_img_portrait" width="173" height="223" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>CIFAR-100</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F5.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x13.png" id="S4.F5.sf3.g1" class="ltx_graphics ltx_img_portrait" width="173" height="223" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Tiny-ImageNet</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>The top-1 test accuracy with different number of local epochs (<math id="S4.F5.2.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.F5.2.m1.1b"><mi id="S4.F5.2.m1.1.1" xref="S4.F5.2.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.F5.2.m1.1c"><ci id="S4.F5.2.m1.1.1.cmml" xref="S4.F5.2.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.2.m1.1d">E</annotation></semantics></math>).</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Accuracy Results</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.3" class="ltx_p">Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Accuracy Results ‣ 4 Experiment ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> lists the top-<math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mn id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><cn type="integer" id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">1</annotation></semantics></math> test accuracy of all methods. SOLO shows the worst result among all methods, which demonstrates the advantages of federated learning. FedAvg is the first FL framework that uses cross-entropy loss to train the local network, which can be regarded as a baseline for FL. The other FL framework including SCAFFOLD, FedProx, and MOON are designed to address the non-IID data issue. Since FedAvg does not make any optimization for the non-IID setting, the accuracy of FedAvg is relatively low among all FL algorithms. Furthermore, SCAFFOLD is proposed to improve the accuracy on the CIFAR-10, but it has much worse results on CIFAR-100 and Tiny-ImageNet than FedAvg. For FedProx, its accuracy is very close to that of FedAvg. It is because that FedProx makes only minor modifications on the FedAvg by using re-parameterization techniques. MOON presents a model contrastive federated learning, which compares the representations learned by different models. This approach outperforms FedAvg by <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="1.3\%\sim 3\%" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mrow id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2.2" xref="S4.SS2.p1.2.m2.1.1.2.2.cmml">1.3</mn><mo id="S4.SS2.p1.2.m2.1.1.2.1" xref="S4.SS2.p1.2.m2.1.1.2.1.cmml">%</mo></mrow><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">∼</mo><mrow id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml"><mn id="S4.SS2.p1.2.m2.1.1.3.2" xref="S4.SS2.p1.2.m2.1.1.3.2.cmml">3</mn><mo id="S4.SS2.p1.2.m2.1.1.3.1" xref="S4.SS2.p1.2.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1">similar-to</csymbol><apply id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2"><csymbol cd="latexml" id="S4.SS2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS2.p1.2.m2.1.1.2.1">percent</csymbol><cn type="float" id="S4.SS2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2.2">1.3</cn></apply><apply id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3"><csymbol cd="latexml" id="S4.SS2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.p1.2.m2.1.1.3.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.p1.2.m2.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">1.3\%\sim 3\%</annotation></semantics></math> accuracy on the different datasets. As for our method (FedProc), we can observe that its accuracy results are always better than those of other methods for all datasets. Specifically, our method outperforms MOON by <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="1.6\%\sim 7.9\%" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mrow id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml"><mn id="S4.SS2.p1.3.m3.1.1.2.2" xref="S4.SS2.p1.3.m3.1.1.2.2.cmml">1.6</mn><mo id="S4.SS2.p1.3.m3.1.1.2.1" xref="S4.SS2.p1.3.m3.1.1.2.1.cmml">%</mo></mrow><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">∼</mo><mrow id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml"><mn id="S4.SS2.p1.3.m3.1.1.3.2" xref="S4.SS2.p1.3.m3.1.1.3.2.cmml">7.9</mn><mo id="S4.SS2.p1.3.m3.1.1.3.1" xref="S4.SS2.p1.3.m3.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1">similar-to</csymbol><apply id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2"><csymbol cd="latexml" id="S4.SS2.p1.3.m3.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.2.1">percent</csymbol><cn type="float" id="S4.SS2.p1.3.m3.1.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2.2">1.6</cn></apply><apply id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3"><csymbol cd="latexml" id="S4.SS2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.3.1">percent</csymbol><cn type="float" id="S4.SS2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.3.2">7.9</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">1.6\%\sim 7.9\%</annotation></semantics></math> on the different datasets. It is indicated that our method (prototypical contrastive federated learning) can effectively correct the local training.
Next, we explore the impact of different parameters on accuracy.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>The top-<math id="S4.T2.2.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.T2.2.m1.1b"><mn id="S4.T2.2.m1.1.1" xref="S4.T2.2.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.T2.2.m1.1c"><cn type="integer" id="S4.T2.2.m1.1.1.cmml" xref="S4.T2.2.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.m1.1d">1</annotation></semantics></math> accuracy of FedProc and the other methods on test datasets.</figcaption>
<table id="S4.T2.20" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.20.19.1" class="ltx_tr">
<th id="S4.T2.20.19.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:2.2pt;padding-right:2.2pt;">Method</th>
<th id="S4.T2.20.19.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:2.2pt;padding-right:2.2pt;">CIFAR-10</th>
<th id="S4.T2.20.19.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:2.2pt;padding-right:2.2pt;">CIFAR-100</th>
<th id="S4.T2.20.19.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.2pt;padding-right:2.2pt;">Tiny-ImageNet</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.5.3" class="ltx_tr">
<th id="S4.T2.5.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:2.2pt;padding-right:2.2pt;">SOLO</th>
<td id="S4.T2.3.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.3.1.1.m1.1" class="ltx_Math" alttext="46.3\%\pm 5.1\%" display="inline"><semantics id="S4.T2.3.1.1.m1.1a"><mrow id="S4.T2.3.1.1.m1.1.1" xref="S4.T2.3.1.1.m1.1.1.cmml"><mrow id="S4.T2.3.1.1.m1.1.1.2" xref="S4.T2.3.1.1.m1.1.1.2.cmml"><mn id="S4.T2.3.1.1.m1.1.1.2.2" xref="S4.T2.3.1.1.m1.1.1.2.2.cmml">46.3</mn><mo id="S4.T2.3.1.1.m1.1.1.2.1" xref="S4.T2.3.1.1.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.3.1.1.m1.1.1.1" xref="S4.T2.3.1.1.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.3.1.1.m1.1.1.3" xref="S4.T2.3.1.1.m1.1.1.3.cmml"><mn id="S4.T2.3.1.1.m1.1.1.3.2" xref="S4.T2.3.1.1.m1.1.1.3.2.cmml">5.1</mn><mo id="S4.T2.3.1.1.m1.1.1.3.1" xref="S4.T2.3.1.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.1.1.m1.1b"><apply id="S4.T2.3.1.1.m1.1.1.cmml" xref="S4.T2.3.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.3.1.1.m1.1.1.1.cmml" xref="S4.T2.3.1.1.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.3.1.1.m1.1.1.2.cmml" xref="S4.T2.3.1.1.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.3.1.1.m1.1.1.2.1.cmml" xref="S4.T2.3.1.1.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.3.1.1.m1.1.1.2.2.cmml" xref="S4.T2.3.1.1.m1.1.1.2.2">46.3</cn></apply><apply id="S4.T2.3.1.1.m1.1.1.3.cmml" xref="S4.T2.3.1.1.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.3.1.1.m1.1.1.3.1.cmml" xref="S4.T2.3.1.1.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.3.1.1.m1.1.1.3.2.cmml" xref="S4.T2.3.1.1.m1.1.1.3.2">5.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.1.1.m1.1c">46.3\%\pm 5.1\%</annotation></semantics></math></td>
<td id="S4.T2.4.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.4.2.2.m1.1" class="ltx_Math" alttext="22.3\%\pm 1.0\%" display="inline"><semantics id="S4.T2.4.2.2.m1.1a"><mrow id="S4.T2.4.2.2.m1.1.1" xref="S4.T2.4.2.2.m1.1.1.cmml"><mrow id="S4.T2.4.2.2.m1.1.1.2" xref="S4.T2.4.2.2.m1.1.1.2.cmml"><mn id="S4.T2.4.2.2.m1.1.1.2.2" xref="S4.T2.4.2.2.m1.1.1.2.2.cmml">22.3</mn><mo id="S4.T2.4.2.2.m1.1.1.2.1" xref="S4.T2.4.2.2.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.4.2.2.m1.1.1.1" xref="S4.T2.4.2.2.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.4.2.2.m1.1.1.3" xref="S4.T2.4.2.2.m1.1.1.3.cmml"><mn id="S4.T2.4.2.2.m1.1.1.3.2" xref="S4.T2.4.2.2.m1.1.1.3.2.cmml">1.0</mn><mo id="S4.T2.4.2.2.m1.1.1.3.1" xref="S4.T2.4.2.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.2.2.m1.1b"><apply id="S4.T2.4.2.2.m1.1.1.cmml" xref="S4.T2.4.2.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.4.2.2.m1.1.1.1.cmml" xref="S4.T2.4.2.2.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.4.2.2.m1.1.1.2.cmml" xref="S4.T2.4.2.2.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.4.2.2.m1.1.1.2.1.cmml" xref="S4.T2.4.2.2.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.4.2.2.m1.1.1.2.2.cmml" xref="S4.T2.4.2.2.m1.1.1.2.2">22.3</cn></apply><apply id="S4.T2.4.2.2.m1.1.1.3.cmml" xref="S4.T2.4.2.2.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.4.2.2.m1.1.1.3.1.cmml" xref="S4.T2.4.2.2.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.4.2.2.m1.1.1.3.2.cmml" xref="S4.T2.4.2.2.m1.1.1.3.2">1.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.2.2.m1.1c">22.3\%\pm 1.0\%</annotation></semantics></math></td>
<td id="S4.T2.5.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.5.3.3.m1.1" class="ltx_Math" alttext="8.9\%\pm 0.3\%" display="inline"><semantics id="S4.T2.5.3.3.m1.1a"><mrow id="S4.T2.5.3.3.m1.1.1" xref="S4.T2.5.3.3.m1.1.1.cmml"><mrow id="S4.T2.5.3.3.m1.1.1.2" xref="S4.T2.5.3.3.m1.1.1.2.cmml"><mn id="S4.T2.5.3.3.m1.1.1.2.2" xref="S4.T2.5.3.3.m1.1.1.2.2.cmml">8.9</mn><mo id="S4.T2.5.3.3.m1.1.1.2.1" xref="S4.T2.5.3.3.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.5.3.3.m1.1.1.1" xref="S4.T2.5.3.3.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.5.3.3.m1.1.1.3" xref="S4.T2.5.3.3.m1.1.1.3.cmml"><mn id="S4.T2.5.3.3.m1.1.1.3.2" xref="S4.T2.5.3.3.m1.1.1.3.2.cmml">0.3</mn><mo id="S4.T2.5.3.3.m1.1.1.3.1" xref="S4.T2.5.3.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.3.3.m1.1b"><apply id="S4.T2.5.3.3.m1.1.1.cmml" xref="S4.T2.5.3.3.m1.1.1"><csymbol cd="latexml" id="S4.T2.5.3.3.m1.1.1.1.cmml" xref="S4.T2.5.3.3.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.5.3.3.m1.1.1.2.cmml" xref="S4.T2.5.3.3.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.5.3.3.m1.1.1.2.1.cmml" xref="S4.T2.5.3.3.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.5.3.3.m1.1.1.2.2.cmml" xref="S4.T2.5.3.3.m1.1.1.2.2">8.9</cn></apply><apply id="S4.T2.5.3.3.m1.1.1.3.cmml" xref="S4.T2.5.3.3.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.5.3.3.m1.1.1.3.1.cmml" xref="S4.T2.5.3.3.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.5.3.3.m1.1.1.3.2.cmml" xref="S4.T2.5.3.3.m1.1.1.3.2">0.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.3.3.m1.1c">8.9\%\pm 0.3\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.8.6" class="ltx_tr">
<th id="S4.T2.8.6.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;">FedAvg</th>
<td id="S4.T2.6.4.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.6.4.1.m1.1" class="ltx_Math" alttext="66.3\%\pm 0.5\%" display="inline"><semantics id="S4.T2.6.4.1.m1.1a"><mrow id="S4.T2.6.4.1.m1.1.1" xref="S4.T2.6.4.1.m1.1.1.cmml"><mrow id="S4.T2.6.4.1.m1.1.1.2" xref="S4.T2.6.4.1.m1.1.1.2.cmml"><mn id="S4.T2.6.4.1.m1.1.1.2.2" xref="S4.T2.6.4.1.m1.1.1.2.2.cmml">66.3</mn><mo id="S4.T2.6.4.1.m1.1.1.2.1" xref="S4.T2.6.4.1.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.6.4.1.m1.1.1.1" xref="S4.T2.6.4.1.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.6.4.1.m1.1.1.3" xref="S4.T2.6.4.1.m1.1.1.3.cmml"><mn id="S4.T2.6.4.1.m1.1.1.3.2" xref="S4.T2.6.4.1.m1.1.1.3.2.cmml">0.5</mn><mo id="S4.T2.6.4.1.m1.1.1.3.1" xref="S4.T2.6.4.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.6.4.1.m1.1b"><apply id="S4.T2.6.4.1.m1.1.1.cmml" xref="S4.T2.6.4.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.6.4.1.m1.1.1.1.cmml" xref="S4.T2.6.4.1.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.6.4.1.m1.1.1.2.cmml" xref="S4.T2.6.4.1.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.6.4.1.m1.1.1.2.1.cmml" xref="S4.T2.6.4.1.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.6.4.1.m1.1.1.2.2.cmml" xref="S4.T2.6.4.1.m1.1.1.2.2">66.3</cn></apply><apply id="S4.T2.6.4.1.m1.1.1.3.cmml" xref="S4.T2.6.4.1.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.6.4.1.m1.1.1.3.1.cmml" xref="S4.T2.6.4.1.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.6.4.1.m1.1.1.3.2.cmml" xref="S4.T2.6.4.1.m1.1.1.3.2">0.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.4.1.m1.1c">66.3\%\pm 0.5\%</annotation></semantics></math></td>
<td id="S4.T2.7.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.7.5.2.m1.1" class="ltx_Math" alttext="64.5\%\pm 0.4\%" display="inline"><semantics id="S4.T2.7.5.2.m1.1a"><mrow id="S4.T2.7.5.2.m1.1.1" xref="S4.T2.7.5.2.m1.1.1.cmml"><mrow id="S4.T2.7.5.2.m1.1.1.2" xref="S4.T2.7.5.2.m1.1.1.2.cmml"><mn id="S4.T2.7.5.2.m1.1.1.2.2" xref="S4.T2.7.5.2.m1.1.1.2.2.cmml">64.5</mn><mo id="S4.T2.7.5.2.m1.1.1.2.1" xref="S4.T2.7.5.2.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.7.5.2.m1.1.1.1" xref="S4.T2.7.5.2.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.7.5.2.m1.1.1.3" xref="S4.T2.7.5.2.m1.1.1.3.cmml"><mn id="S4.T2.7.5.2.m1.1.1.3.2" xref="S4.T2.7.5.2.m1.1.1.3.2.cmml">0.4</mn><mo id="S4.T2.7.5.2.m1.1.1.3.1" xref="S4.T2.7.5.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.7.5.2.m1.1b"><apply id="S4.T2.7.5.2.m1.1.1.cmml" xref="S4.T2.7.5.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.7.5.2.m1.1.1.1.cmml" xref="S4.T2.7.5.2.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.7.5.2.m1.1.1.2.cmml" xref="S4.T2.7.5.2.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.7.5.2.m1.1.1.2.1.cmml" xref="S4.T2.7.5.2.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.7.5.2.m1.1.1.2.2.cmml" xref="S4.T2.7.5.2.m1.1.1.2.2">64.5</cn></apply><apply id="S4.T2.7.5.2.m1.1.1.3.cmml" xref="S4.T2.7.5.2.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.7.5.2.m1.1.1.3.1.cmml" xref="S4.T2.7.5.2.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.7.5.2.m1.1.1.3.2.cmml" xref="S4.T2.7.5.2.m1.1.1.3.2">0.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.5.2.m1.1c">64.5\%\pm 0.4\%</annotation></semantics></math></td>
<td id="S4.T2.8.6.3" class="ltx_td ltx_align_center" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.8.6.3.m1.1" class="ltx_Math" alttext="26.2\%\pm 0.1\%" display="inline"><semantics id="S4.T2.8.6.3.m1.1a"><mrow id="S4.T2.8.6.3.m1.1.1" xref="S4.T2.8.6.3.m1.1.1.cmml"><mrow id="S4.T2.8.6.3.m1.1.1.2" xref="S4.T2.8.6.3.m1.1.1.2.cmml"><mn id="S4.T2.8.6.3.m1.1.1.2.2" xref="S4.T2.8.6.3.m1.1.1.2.2.cmml">26.2</mn><mo id="S4.T2.8.6.3.m1.1.1.2.1" xref="S4.T2.8.6.3.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.8.6.3.m1.1.1.1" xref="S4.T2.8.6.3.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.8.6.3.m1.1.1.3" xref="S4.T2.8.6.3.m1.1.1.3.cmml"><mn id="S4.T2.8.6.3.m1.1.1.3.2" xref="S4.T2.8.6.3.m1.1.1.3.2.cmml">0.1</mn><mo id="S4.T2.8.6.3.m1.1.1.3.1" xref="S4.T2.8.6.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.8.6.3.m1.1b"><apply id="S4.T2.8.6.3.m1.1.1.cmml" xref="S4.T2.8.6.3.m1.1.1"><csymbol cd="latexml" id="S4.T2.8.6.3.m1.1.1.1.cmml" xref="S4.T2.8.6.3.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.8.6.3.m1.1.1.2.cmml" xref="S4.T2.8.6.3.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.8.6.3.m1.1.1.2.1.cmml" xref="S4.T2.8.6.3.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.8.6.3.m1.1.1.2.2.cmml" xref="S4.T2.8.6.3.m1.1.1.2.2">26.2</cn></apply><apply id="S4.T2.8.6.3.m1.1.1.3.cmml" xref="S4.T2.8.6.3.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.8.6.3.m1.1.1.3.1.cmml" xref="S4.T2.8.6.3.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.8.6.3.m1.1.1.3.2.cmml" xref="S4.T2.8.6.3.m1.1.1.3.2">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.6.3.m1.1c">26.2\%\pm 0.1\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.11.9" class="ltx_tr">
<th id="S4.T2.11.9.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;">SCAFFOLD</th>
<td id="S4.T2.9.7.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.9.7.1.m1.1" class="ltx_Math" alttext="66.6\%\pm 0.2\%" display="inline"><semantics id="S4.T2.9.7.1.m1.1a"><mrow id="S4.T2.9.7.1.m1.1.1" xref="S4.T2.9.7.1.m1.1.1.cmml"><mrow id="S4.T2.9.7.1.m1.1.1.2" xref="S4.T2.9.7.1.m1.1.1.2.cmml"><mn id="S4.T2.9.7.1.m1.1.1.2.2" xref="S4.T2.9.7.1.m1.1.1.2.2.cmml">66.6</mn><mo id="S4.T2.9.7.1.m1.1.1.2.1" xref="S4.T2.9.7.1.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.9.7.1.m1.1.1.1" xref="S4.T2.9.7.1.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.9.7.1.m1.1.1.3" xref="S4.T2.9.7.1.m1.1.1.3.cmml"><mn id="S4.T2.9.7.1.m1.1.1.3.2" xref="S4.T2.9.7.1.m1.1.1.3.2.cmml">0.2</mn><mo id="S4.T2.9.7.1.m1.1.1.3.1" xref="S4.T2.9.7.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.9.7.1.m1.1b"><apply id="S4.T2.9.7.1.m1.1.1.cmml" xref="S4.T2.9.7.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.9.7.1.m1.1.1.1.cmml" xref="S4.T2.9.7.1.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.9.7.1.m1.1.1.2.cmml" xref="S4.T2.9.7.1.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.9.7.1.m1.1.1.2.1.cmml" xref="S4.T2.9.7.1.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.9.7.1.m1.1.1.2.2.cmml" xref="S4.T2.9.7.1.m1.1.1.2.2">66.6</cn></apply><apply id="S4.T2.9.7.1.m1.1.1.3.cmml" xref="S4.T2.9.7.1.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.9.7.1.m1.1.1.3.1.cmml" xref="S4.T2.9.7.1.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.9.7.1.m1.1.1.3.2.cmml" xref="S4.T2.9.7.1.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.7.1.m1.1c">66.6\%\pm 0.2\%</annotation></semantics></math></td>
<td id="S4.T2.10.8.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.10.8.2.m1.1" class="ltx_Math" alttext="52.5\%\pm 0.3\%" display="inline"><semantics id="S4.T2.10.8.2.m1.1a"><mrow id="S4.T2.10.8.2.m1.1.1" xref="S4.T2.10.8.2.m1.1.1.cmml"><mrow id="S4.T2.10.8.2.m1.1.1.2" xref="S4.T2.10.8.2.m1.1.1.2.cmml"><mn id="S4.T2.10.8.2.m1.1.1.2.2" xref="S4.T2.10.8.2.m1.1.1.2.2.cmml">52.5</mn><mo id="S4.T2.10.8.2.m1.1.1.2.1" xref="S4.T2.10.8.2.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.10.8.2.m1.1.1.1" xref="S4.T2.10.8.2.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.10.8.2.m1.1.1.3" xref="S4.T2.10.8.2.m1.1.1.3.cmml"><mn id="S4.T2.10.8.2.m1.1.1.3.2" xref="S4.T2.10.8.2.m1.1.1.3.2.cmml">0.3</mn><mo id="S4.T2.10.8.2.m1.1.1.3.1" xref="S4.T2.10.8.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.10.8.2.m1.1b"><apply id="S4.T2.10.8.2.m1.1.1.cmml" xref="S4.T2.10.8.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.10.8.2.m1.1.1.1.cmml" xref="S4.T2.10.8.2.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.10.8.2.m1.1.1.2.cmml" xref="S4.T2.10.8.2.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.10.8.2.m1.1.1.2.1.cmml" xref="S4.T2.10.8.2.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.10.8.2.m1.1.1.2.2.cmml" xref="S4.T2.10.8.2.m1.1.1.2.2">52.5</cn></apply><apply id="S4.T2.10.8.2.m1.1.1.3.cmml" xref="S4.T2.10.8.2.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.10.8.2.m1.1.1.3.1.cmml" xref="S4.T2.10.8.2.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.10.8.2.m1.1.1.3.2.cmml" xref="S4.T2.10.8.2.m1.1.1.3.2">0.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.8.2.m1.1c">52.5\%\pm 0.3\%</annotation></semantics></math></td>
<td id="S4.T2.11.9.3" class="ltx_td ltx_align_center" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.11.9.3.m1.1" class="ltx_Math" alttext="17.9\%\pm 0.2\%" display="inline"><semantics id="S4.T2.11.9.3.m1.1a"><mrow id="S4.T2.11.9.3.m1.1.1" xref="S4.T2.11.9.3.m1.1.1.cmml"><mrow id="S4.T2.11.9.3.m1.1.1.2" xref="S4.T2.11.9.3.m1.1.1.2.cmml"><mn id="S4.T2.11.9.3.m1.1.1.2.2" xref="S4.T2.11.9.3.m1.1.1.2.2.cmml">17.9</mn><mo id="S4.T2.11.9.3.m1.1.1.2.1" xref="S4.T2.11.9.3.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.11.9.3.m1.1.1.1" xref="S4.T2.11.9.3.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.11.9.3.m1.1.1.3" xref="S4.T2.11.9.3.m1.1.1.3.cmml"><mn id="S4.T2.11.9.3.m1.1.1.3.2" xref="S4.T2.11.9.3.m1.1.1.3.2.cmml">0.2</mn><mo id="S4.T2.11.9.3.m1.1.1.3.1" xref="S4.T2.11.9.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.11.9.3.m1.1b"><apply id="S4.T2.11.9.3.m1.1.1.cmml" xref="S4.T2.11.9.3.m1.1.1"><csymbol cd="latexml" id="S4.T2.11.9.3.m1.1.1.1.cmml" xref="S4.T2.11.9.3.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.11.9.3.m1.1.1.2.cmml" xref="S4.T2.11.9.3.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.11.9.3.m1.1.1.2.1.cmml" xref="S4.T2.11.9.3.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.11.9.3.m1.1.1.2.2.cmml" xref="S4.T2.11.9.3.m1.1.1.2.2">17.9</cn></apply><apply id="S4.T2.11.9.3.m1.1.1.3.cmml" xref="S4.T2.11.9.3.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.11.9.3.m1.1.1.3.1.cmml" xref="S4.T2.11.9.3.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.11.9.3.m1.1.1.3.2.cmml" xref="S4.T2.11.9.3.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.9.3.m1.1c">17.9\%\pm 0.2\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.14.12" class="ltx_tr">
<th id="S4.T2.14.12.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;">FedProx</th>
<td id="S4.T2.12.10.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.12.10.1.m1.1" class="ltx_Math" alttext="66.9\%\pm 0.2\%" display="inline"><semantics id="S4.T2.12.10.1.m1.1a"><mrow id="S4.T2.12.10.1.m1.1.1" xref="S4.T2.12.10.1.m1.1.1.cmml"><mrow id="S4.T2.12.10.1.m1.1.1.2" xref="S4.T2.12.10.1.m1.1.1.2.cmml"><mn id="S4.T2.12.10.1.m1.1.1.2.2" xref="S4.T2.12.10.1.m1.1.1.2.2.cmml">66.9</mn><mo id="S4.T2.12.10.1.m1.1.1.2.1" xref="S4.T2.12.10.1.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.12.10.1.m1.1.1.1" xref="S4.T2.12.10.1.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.12.10.1.m1.1.1.3" xref="S4.T2.12.10.1.m1.1.1.3.cmml"><mn id="S4.T2.12.10.1.m1.1.1.3.2" xref="S4.T2.12.10.1.m1.1.1.3.2.cmml">0.2</mn><mo id="S4.T2.12.10.1.m1.1.1.3.1" xref="S4.T2.12.10.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.12.10.1.m1.1b"><apply id="S4.T2.12.10.1.m1.1.1.cmml" xref="S4.T2.12.10.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.12.10.1.m1.1.1.1.cmml" xref="S4.T2.12.10.1.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.12.10.1.m1.1.1.2.cmml" xref="S4.T2.12.10.1.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.12.10.1.m1.1.1.2.1.cmml" xref="S4.T2.12.10.1.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.12.10.1.m1.1.1.2.2.cmml" xref="S4.T2.12.10.1.m1.1.1.2.2">66.9</cn></apply><apply id="S4.T2.12.10.1.m1.1.1.3.cmml" xref="S4.T2.12.10.1.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.12.10.1.m1.1.1.3.1.cmml" xref="S4.T2.12.10.1.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.12.10.1.m1.1.1.3.2.cmml" xref="S4.T2.12.10.1.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.10.1.m1.1c">66.9\%\pm 0.2\%</annotation></semantics></math></td>
<td id="S4.T2.13.11.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.13.11.2.m1.1" class="ltx_Math" alttext="64.6\%\pm 0.2\%" display="inline"><semantics id="S4.T2.13.11.2.m1.1a"><mrow id="S4.T2.13.11.2.m1.1.1" xref="S4.T2.13.11.2.m1.1.1.cmml"><mrow id="S4.T2.13.11.2.m1.1.1.2" xref="S4.T2.13.11.2.m1.1.1.2.cmml"><mn id="S4.T2.13.11.2.m1.1.1.2.2" xref="S4.T2.13.11.2.m1.1.1.2.2.cmml">64.6</mn><mo id="S4.T2.13.11.2.m1.1.1.2.1" xref="S4.T2.13.11.2.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.13.11.2.m1.1.1.1" xref="S4.T2.13.11.2.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.13.11.2.m1.1.1.3" xref="S4.T2.13.11.2.m1.1.1.3.cmml"><mn id="S4.T2.13.11.2.m1.1.1.3.2" xref="S4.T2.13.11.2.m1.1.1.3.2.cmml">0.2</mn><mo id="S4.T2.13.11.2.m1.1.1.3.1" xref="S4.T2.13.11.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.13.11.2.m1.1b"><apply id="S4.T2.13.11.2.m1.1.1.cmml" xref="S4.T2.13.11.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.13.11.2.m1.1.1.1.cmml" xref="S4.T2.13.11.2.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.13.11.2.m1.1.1.2.cmml" xref="S4.T2.13.11.2.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.13.11.2.m1.1.1.2.1.cmml" xref="S4.T2.13.11.2.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.13.11.2.m1.1.1.2.2.cmml" xref="S4.T2.13.11.2.m1.1.1.2.2">64.6</cn></apply><apply id="S4.T2.13.11.2.m1.1.1.3.cmml" xref="S4.T2.13.11.2.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.13.11.2.m1.1.1.3.1.cmml" xref="S4.T2.13.11.2.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.13.11.2.m1.1.1.3.2.cmml" xref="S4.T2.13.11.2.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.11.2.m1.1c">64.6\%\pm 0.2\%</annotation></semantics></math></td>
<td id="S4.T2.14.12.3" class="ltx_td ltx_align_center" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.14.12.3.m1.1" class="ltx_Math" alttext="27.4\%\pm 0.2\%" display="inline"><semantics id="S4.T2.14.12.3.m1.1a"><mrow id="S4.T2.14.12.3.m1.1.1" xref="S4.T2.14.12.3.m1.1.1.cmml"><mrow id="S4.T2.14.12.3.m1.1.1.2" xref="S4.T2.14.12.3.m1.1.1.2.cmml"><mn id="S4.T2.14.12.3.m1.1.1.2.2" xref="S4.T2.14.12.3.m1.1.1.2.2.cmml">27.4</mn><mo id="S4.T2.14.12.3.m1.1.1.2.1" xref="S4.T2.14.12.3.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.14.12.3.m1.1.1.1" xref="S4.T2.14.12.3.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.14.12.3.m1.1.1.3" xref="S4.T2.14.12.3.m1.1.1.3.cmml"><mn id="S4.T2.14.12.3.m1.1.1.3.2" xref="S4.T2.14.12.3.m1.1.1.3.2.cmml">0.2</mn><mo id="S4.T2.14.12.3.m1.1.1.3.1" xref="S4.T2.14.12.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.14.12.3.m1.1b"><apply id="S4.T2.14.12.3.m1.1.1.cmml" xref="S4.T2.14.12.3.m1.1.1"><csymbol cd="latexml" id="S4.T2.14.12.3.m1.1.1.1.cmml" xref="S4.T2.14.12.3.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.14.12.3.m1.1.1.2.cmml" xref="S4.T2.14.12.3.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.14.12.3.m1.1.1.2.1.cmml" xref="S4.T2.14.12.3.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.14.12.3.m1.1.1.2.2.cmml" xref="S4.T2.14.12.3.m1.1.1.2.2">27.4</cn></apply><apply id="S4.T2.14.12.3.m1.1.1.3.cmml" xref="S4.T2.14.12.3.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.14.12.3.m1.1.1.3.1.cmml" xref="S4.T2.14.12.3.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.14.12.3.m1.1.1.3.2.cmml" xref="S4.T2.14.12.3.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.12.3.m1.1c">27.4\%\pm 0.2\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.17.15" class="ltx_tr">
<th id="S4.T2.17.15.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;">MOON</th>
<td id="S4.T2.15.13.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.15.13.1.m1.1" class="ltx_Math" alttext="69.1\%\pm 0.4\%" display="inline"><semantics id="S4.T2.15.13.1.m1.1a"><mrow id="S4.T2.15.13.1.m1.1.1" xref="S4.T2.15.13.1.m1.1.1.cmml"><mrow id="S4.T2.15.13.1.m1.1.1.2" xref="S4.T2.15.13.1.m1.1.1.2.cmml"><mn id="S4.T2.15.13.1.m1.1.1.2.2" xref="S4.T2.15.13.1.m1.1.1.2.2.cmml">69.1</mn><mo id="S4.T2.15.13.1.m1.1.1.2.1" xref="S4.T2.15.13.1.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.15.13.1.m1.1.1.1" xref="S4.T2.15.13.1.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.15.13.1.m1.1.1.3" xref="S4.T2.15.13.1.m1.1.1.3.cmml"><mn id="S4.T2.15.13.1.m1.1.1.3.2" xref="S4.T2.15.13.1.m1.1.1.3.2.cmml">0.4</mn><mo id="S4.T2.15.13.1.m1.1.1.3.1" xref="S4.T2.15.13.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.15.13.1.m1.1b"><apply id="S4.T2.15.13.1.m1.1.1.cmml" xref="S4.T2.15.13.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.15.13.1.m1.1.1.1.cmml" xref="S4.T2.15.13.1.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.15.13.1.m1.1.1.2.cmml" xref="S4.T2.15.13.1.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.15.13.1.m1.1.1.2.1.cmml" xref="S4.T2.15.13.1.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.15.13.1.m1.1.1.2.2.cmml" xref="S4.T2.15.13.1.m1.1.1.2.2">69.1</cn></apply><apply id="S4.T2.15.13.1.m1.1.1.3.cmml" xref="S4.T2.15.13.1.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.15.13.1.m1.1.1.3.1.cmml" xref="S4.T2.15.13.1.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.15.13.1.m1.1.1.3.2.cmml" xref="S4.T2.15.13.1.m1.1.1.3.2">0.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.13.1.m1.1c">69.1\%\pm 0.4\%</annotation></semantics></math></td>
<td id="S4.T2.16.14.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.16.14.2.m1.1" class="ltx_Math" alttext="67.5\%\pm 0.4\%" display="inline"><semantics id="S4.T2.16.14.2.m1.1a"><mrow id="S4.T2.16.14.2.m1.1.1" xref="S4.T2.16.14.2.m1.1.1.cmml"><mrow id="S4.T2.16.14.2.m1.1.1.2" xref="S4.T2.16.14.2.m1.1.1.2.cmml"><mn id="S4.T2.16.14.2.m1.1.1.2.2" xref="S4.T2.16.14.2.m1.1.1.2.2.cmml">67.5</mn><mo id="S4.T2.16.14.2.m1.1.1.2.1" xref="S4.T2.16.14.2.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.16.14.2.m1.1.1.1" xref="S4.T2.16.14.2.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.16.14.2.m1.1.1.3" xref="S4.T2.16.14.2.m1.1.1.3.cmml"><mn id="S4.T2.16.14.2.m1.1.1.3.2" xref="S4.T2.16.14.2.m1.1.1.3.2.cmml">0.4</mn><mo id="S4.T2.16.14.2.m1.1.1.3.1" xref="S4.T2.16.14.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.16.14.2.m1.1b"><apply id="S4.T2.16.14.2.m1.1.1.cmml" xref="S4.T2.16.14.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.16.14.2.m1.1.1.1.cmml" xref="S4.T2.16.14.2.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.16.14.2.m1.1.1.2.cmml" xref="S4.T2.16.14.2.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.16.14.2.m1.1.1.2.1.cmml" xref="S4.T2.16.14.2.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.16.14.2.m1.1.1.2.2.cmml" xref="S4.T2.16.14.2.m1.1.1.2.2">67.5</cn></apply><apply id="S4.T2.16.14.2.m1.1.1.3.cmml" xref="S4.T2.16.14.2.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.16.14.2.m1.1.1.3.1.cmml" xref="S4.T2.16.14.2.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.16.14.2.m1.1.1.3.2.cmml" xref="S4.T2.16.14.2.m1.1.1.3.2">0.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.14.2.m1.1c">67.5\%\pm 0.4\%</annotation></semantics></math></td>
<td id="S4.T2.17.15.3" class="ltx_td ltx_align_center" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.17.15.3.m1.1" class="ltx_Math" alttext="27.5\%\pm 0.1\%" display="inline"><semantics id="S4.T2.17.15.3.m1.1a"><mrow id="S4.T2.17.15.3.m1.1.1" xref="S4.T2.17.15.3.m1.1.1.cmml"><mrow id="S4.T2.17.15.3.m1.1.1.2" xref="S4.T2.17.15.3.m1.1.1.2.cmml"><mn id="S4.T2.17.15.3.m1.1.1.2.2" xref="S4.T2.17.15.3.m1.1.1.2.2.cmml">27.5</mn><mo id="S4.T2.17.15.3.m1.1.1.2.1" xref="S4.T2.17.15.3.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.17.15.3.m1.1.1.1" xref="S4.T2.17.15.3.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.17.15.3.m1.1.1.3" xref="S4.T2.17.15.3.m1.1.1.3.cmml"><mn id="S4.T2.17.15.3.m1.1.1.3.2" xref="S4.T2.17.15.3.m1.1.1.3.2.cmml">0.1</mn><mo id="S4.T2.17.15.3.m1.1.1.3.1" xref="S4.T2.17.15.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.17.15.3.m1.1b"><apply id="S4.T2.17.15.3.m1.1.1.cmml" xref="S4.T2.17.15.3.m1.1.1"><csymbol cd="latexml" id="S4.T2.17.15.3.m1.1.1.1.cmml" xref="S4.T2.17.15.3.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.17.15.3.m1.1.1.2.cmml" xref="S4.T2.17.15.3.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.17.15.3.m1.1.1.2.1.cmml" xref="S4.T2.17.15.3.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.17.15.3.m1.1.1.2.2.cmml" xref="S4.T2.17.15.3.m1.1.1.2.2">27.5</cn></apply><apply id="S4.T2.17.15.3.m1.1.1.3.cmml" xref="S4.T2.17.15.3.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.17.15.3.m1.1.1.3.1.cmml" xref="S4.T2.17.15.3.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.17.15.3.m1.1.1.3.2.cmml" xref="S4.T2.17.15.3.m1.1.1.3.2">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.15.3.m1.1c">27.5\%\pm 0.1\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.20.18" class="ltx_tr">
<th id="S4.T2.20.18.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;">FedProc</th>
<td id="S4.T2.18.16.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.18.16.1.m1.1" class="ltx_Math" alttext="\mathbf{70.7\%\pm 0.3\%}" display="inline"><semantics id="S4.T2.18.16.1.m1.1a"><mrow id="S4.T2.18.16.1.m1.1.1" xref="S4.T2.18.16.1.m1.1.1.cmml"><mrow id="S4.T2.18.16.1.m1.1.1.2" xref="S4.T2.18.16.1.m1.1.1.2.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.18.16.1.m1.1.1.2.2" xref="S4.T2.18.16.1.m1.1.1.2.2.cmml">70.7</mn><mo id="S4.T2.18.16.1.m1.1.1.2.1" xref="S4.T2.18.16.1.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.18.16.1.m1.1.1.1" xref="S4.T2.18.16.1.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.18.16.1.m1.1.1.3" xref="S4.T2.18.16.1.m1.1.1.3.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.18.16.1.m1.1.1.3.2" xref="S4.T2.18.16.1.m1.1.1.3.2.cmml">0.3</mn><mo id="S4.T2.18.16.1.m1.1.1.3.1" xref="S4.T2.18.16.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.18.16.1.m1.1b"><apply id="S4.T2.18.16.1.m1.1.1.cmml" xref="S4.T2.18.16.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.18.16.1.m1.1.1.1.cmml" xref="S4.T2.18.16.1.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.18.16.1.m1.1.1.2.cmml" xref="S4.T2.18.16.1.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.18.16.1.m1.1.1.2.1.cmml" xref="S4.T2.18.16.1.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.18.16.1.m1.1.1.2.2.cmml" xref="S4.T2.18.16.1.m1.1.1.2.2">70.7</cn></apply><apply id="S4.T2.18.16.1.m1.1.1.3.cmml" xref="S4.T2.18.16.1.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.18.16.1.m1.1.1.3.1.cmml" xref="S4.T2.18.16.1.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.18.16.1.m1.1.1.3.2.cmml" xref="S4.T2.18.16.1.m1.1.1.3.2">0.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.16.1.m1.1c">\mathbf{70.7\%\pm 0.3\%}</annotation></semantics></math></td>
<td id="S4.T2.19.17.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.19.17.2.m1.1" class="ltx_Math" alttext="\mathbf{74.6\%\pm 0.1\%}" display="inline"><semantics id="S4.T2.19.17.2.m1.1a"><mrow id="S4.T2.19.17.2.m1.1.1" xref="S4.T2.19.17.2.m1.1.1.cmml"><mrow id="S4.T2.19.17.2.m1.1.1.2" xref="S4.T2.19.17.2.m1.1.1.2.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.19.17.2.m1.1.1.2.2" xref="S4.T2.19.17.2.m1.1.1.2.2.cmml">74.6</mn><mo id="S4.T2.19.17.2.m1.1.1.2.1" xref="S4.T2.19.17.2.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.19.17.2.m1.1.1.1" xref="S4.T2.19.17.2.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.19.17.2.m1.1.1.3" xref="S4.T2.19.17.2.m1.1.1.3.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.19.17.2.m1.1.1.3.2" xref="S4.T2.19.17.2.m1.1.1.3.2.cmml">0.1</mn><mo id="S4.T2.19.17.2.m1.1.1.3.1" xref="S4.T2.19.17.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.19.17.2.m1.1b"><apply id="S4.T2.19.17.2.m1.1.1.cmml" xref="S4.T2.19.17.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.19.17.2.m1.1.1.1.cmml" xref="S4.T2.19.17.2.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.19.17.2.m1.1.1.2.cmml" xref="S4.T2.19.17.2.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.19.17.2.m1.1.1.2.1.cmml" xref="S4.T2.19.17.2.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.19.17.2.m1.1.1.2.2.cmml" xref="S4.T2.19.17.2.m1.1.1.2.2">74.6</cn></apply><apply id="S4.T2.19.17.2.m1.1.1.3.cmml" xref="S4.T2.19.17.2.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.19.17.2.m1.1.1.3.1.cmml" xref="S4.T2.19.17.2.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.19.17.2.m1.1.1.3.2.cmml" xref="S4.T2.19.17.2.m1.1.1.3.2">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.19.17.2.m1.1c">\mathbf{74.6\%\pm 0.1\%}</annotation></semantics></math></td>
<td id="S4.T2.20.18.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.2pt;padding-right:2.2pt;"><math id="S4.T2.20.18.3.m1.1" class="ltx_Math" alttext="\mathbf{35.4\%\pm 0.1\%}" display="inline"><semantics id="S4.T2.20.18.3.m1.1a"><mrow id="S4.T2.20.18.3.m1.1.1" xref="S4.T2.20.18.3.m1.1.1.cmml"><mrow id="S4.T2.20.18.3.m1.1.1.2" xref="S4.T2.20.18.3.m1.1.1.2.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.20.18.3.m1.1.1.2.2" xref="S4.T2.20.18.3.m1.1.1.2.2.cmml">35.4</mn><mo id="S4.T2.20.18.3.m1.1.1.2.1" xref="S4.T2.20.18.3.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.T2.20.18.3.m1.1.1.1" xref="S4.T2.20.18.3.m1.1.1.1.cmml">±</mo><mrow id="S4.T2.20.18.3.m1.1.1.3" xref="S4.T2.20.18.3.m1.1.1.3.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.20.18.3.m1.1.1.3.2" xref="S4.T2.20.18.3.m1.1.1.3.2.cmml">0.1</mn><mo id="S4.T2.20.18.3.m1.1.1.3.1" xref="S4.T2.20.18.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.20.18.3.m1.1b"><apply id="S4.T2.20.18.3.m1.1.1.cmml" xref="S4.T2.20.18.3.m1.1.1"><csymbol cd="latexml" id="S4.T2.20.18.3.m1.1.1.1.cmml" xref="S4.T2.20.18.3.m1.1.1.1">plus-or-minus</csymbol><apply id="S4.T2.20.18.3.m1.1.1.2.cmml" xref="S4.T2.20.18.3.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.20.18.3.m1.1.1.2.1.cmml" xref="S4.T2.20.18.3.m1.1.1.2.1">percent</csymbol><cn type="float" id="S4.T2.20.18.3.m1.1.1.2.2.cmml" xref="S4.T2.20.18.3.m1.1.1.2.2">35.4</cn></apply><apply id="S4.T2.20.18.3.m1.1.1.3.cmml" xref="S4.T2.20.18.3.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.20.18.3.m1.1.1.3.1.cmml" xref="S4.T2.20.18.3.m1.1.1.3.1">percent</csymbol><cn type="float" id="S4.T2.20.18.3.m1.1.1.3.2.cmml" xref="S4.T2.20.18.3.m1.1.1.3.2">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.20.18.3.m1.1c">\mathbf{35.4\%\pm 0.1\%}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<section id="S4.SS2.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Impact of number of communication rounds (<math id="S4.SS2.SSSx1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS2.SSSx1.1.m1.1b"><mi id="S4.SS2.SSSx1.1.m1.1.1" xref="S4.SS2.SSSx1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx1.1.m1.1c"><ci id="S4.SS2.SSSx1.1.m1.1.1.cmml" xref="S4.SS2.SSSx1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx1.1.m1.1d">T</annotation></semantics></math>)</h4>

<div id="S4.SS2.SSSx1.p1" class="ltx_para">
<p id="S4.SS2.SSSx1.p1.1" class="ltx_p">Figure <a href="#S4.F4" title="Figure 4 ‣ 4.1 Experimental Setup ‣ 4 Experiment ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the accuracy in each round during the training. We find that FedProc achieves the best performance at the end of the training. Further, the curves in Figure <a href="#S4.F4" title="Figure 4 ‣ 4.1 Experimental Setup ‣ 4 Experiment ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> show that FedProc improves the accuracy at the expense of the slow convergence speed. This is because feature learning plays a critical role at the beginning of training, and then classifier learning gradually dominates the training. In other words, FedProc learns better representations in the early stages of the training, which can benefit the classifier learning in the later stages.</p>
</div>
</section>
<section id="S4.SS2.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Impact of number of local epochs (<math id="S4.SS2.SSSx2.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS2.SSSx2.1.m1.1b"><mi id="S4.SS2.SSSx2.1.m1.1.1" xref="S4.SS2.SSSx2.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx2.1.m1.1c"><ci id="S4.SS2.SSSx2.1.m1.1.1.cmml" xref="S4.SS2.SSSx2.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx2.1.m1.1d">E</annotation></semantics></math>)</h4>

<div id="S4.SS2.SSSx2.p1" class="ltx_para">
<p id="S4.SS2.SSSx2.p1.3" class="ltx_p">Figure <a href="#S4.F4" title="Figure 4 ‣ 4.1 Experimental Setup ‣ 4 Experiment ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the accuracy as the number of local epoch increases during the training. We find that the accuracy of most of the methods is the highest when the number of local epochs <math id="S4.SS2.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="E=10" display="inline"><semantics id="S4.SS2.SSSx2.p1.1.m1.1a"><mrow id="S4.SS2.SSSx2.p1.1.m1.1.1" xref="S4.SS2.SSSx2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSSx2.p1.1.m1.1.1.2" xref="S4.SS2.SSSx2.p1.1.m1.1.1.2.cmml">E</mi><mo id="S4.SS2.SSSx2.p1.1.m1.1.1.1" xref="S4.SS2.SSSx2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.SSSx2.p1.1.m1.1.1.3" xref="S4.SS2.SSSx2.p1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx2.p1.1.m1.1b"><apply id="S4.SS2.SSSx2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSSx2.p1.1.m1.1.1"><eq id="S4.SS2.SSSx2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSSx2.p1.1.m1.1.1.1"></eq><ci id="S4.SS2.SSSx2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSSx2.p1.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S4.SS2.SSSx2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSSx2.p1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx2.p1.1.m1.1c">E=10</annotation></semantics></math>. This is because that, when <math id="S4.SS2.SSSx2.p1.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS2.SSSx2.p1.2.m2.1a"><mi id="S4.SS2.SSSx2.p1.2.m2.1.1" xref="S4.SS2.SSSx2.p1.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx2.p1.2.m2.1b"><ci id="S4.SS2.SSSx2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSSx2.p1.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx2.p1.2.m2.1c">E</annotation></semantics></math> is small, the local network can not be fully trained. But, when <math id="S4.SS2.SSSx2.p1.3.m3.1" class="ltx_Math" alttext="E&gt;10" display="inline"><semantics id="S4.SS2.SSSx2.p1.3.m3.1a"><mrow id="S4.SS2.SSSx2.p1.3.m3.1.1" xref="S4.SS2.SSSx2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.SSSx2.p1.3.m3.1.1.2" xref="S4.SS2.SSSx2.p1.3.m3.1.1.2.cmml">E</mi><mo id="S4.SS2.SSSx2.p1.3.m3.1.1.1" xref="S4.SS2.SSSx2.p1.3.m3.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.SSSx2.p1.3.m3.1.1.3" xref="S4.SS2.SSSx2.p1.3.m3.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx2.p1.3.m3.1b"><apply id="S4.SS2.SSSx2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSSx2.p1.3.m3.1.1"><gt id="S4.SS2.SSSx2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSSx2.p1.3.m3.1.1.1"></gt><ci id="S4.SS2.SSSx2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSSx2.p1.3.m3.1.1.2">𝐸</ci><cn type="integer" id="S4.SS2.SSSx2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.SSSx2.p1.3.m3.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx2.p1.3.m3.1c">E&gt;10</annotation></semantics></math>, there is over-fitting in the local training on the skewed data, which leads to a reduction in the accuracy of the global model.</p>
</div>
</section>
<section id="S4.SS2.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Impact of data heterogeneity (<math id="S4.SS2.SSSx3.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS2.SSSx3.1.m1.1b"><mi id="S4.SS2.SSSx3.1.m1.1.1" xref="S4.SS2.SSSx3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx3.1.m1.1c"><ci id="S4.SS2.SSSx3.1.m1.1.1.cmml" xref="S4.SS2.SSSx3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx3.1.m1.1d">\beta</annotation></semantics></math>)</h4>

<div id="S4.SS2.SSSx3.p1" class="ltx_para">
<p id="S4.SS2.SSSx3.p1.7" class="ltx_p">To assess the impact of the data heterogeneity on the accuracy, we ran the experiments on heterogeneous data by varying the concentration parameter <math id="S4.SS2.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS2.SSSx3.p1.1.m1.1a"><mi id="S4.SS2.SSSx3.p1.1.m1.1.1" xref="S4.SS2.SSSx3.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx3.p1.1.m1.1b"><ci id="S4.SS2.SSSx3.p1.1.m1.1.1.cmml" xref="S4.SS2.SSSx3.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx3.p1.1.m1.1c">\beta</annotation></semantics></math> of the Dirichlet distribution on the CIFAR100 dataset. A smaller <math id="S4.SS2.SSSx3.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS2.SSSx3.p1.2.m2.1a"><mi id="S4.SS2.SSSx3.p1.2.m2.1.1" xref="S4.SS2.SSSx3.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx3.p1.2.m2.1b"><ci id="S4.SS2.SSSx3.p1.2.m2.1.1.cmml" xref="S4.SS2.SSSx3.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx3.p1.2.m2.1c">\beta</annotation></semantics></math> indicates a more skewed data distribution. The results in Table <a href="#S4.T3" title="Table 3 ‣ Impact of data heterogeneity (𝛽) ‣ 4.2 Accuracy Results ‣ 4 Experiment ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows that FedProc consistently achieves the best accuracy with all levels of imbalance. Specifically, FedProc outperforms MOON by <math id="S4.SS2.SSSx3.p1.3.m3.1" class="ltx_Math" alttext="7.6\%" display="inline"><semantics id="S4.SS2.SSSx3.p1.3.m3.1a"><mrow id="S4.SS2.SSSx3.p1.3.m3.1.1" xref="S4.SS2.SSSx3.p1.3.m3.1.1.cmml"><mn id="S4.SS2.SSSx3.p1.3.m3.1.1.2" xref="S4.SS2.SSSx3.p1.3.m3.1.1.2.cmml">7.6</mn><mo id="S4.SS2.SSSx3.p1.3.m3.1.1.1" xref="S4.SS2.SSSx3.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx3.p1.3.m3.1b"><apply id="S4.SS2.SSSx3.p1.3.m3.1.1.cmml" xref="S4.SS2.SSSx3.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.SSSx3.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSSx3.p1.3.m3.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.SSSx3.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSSx3.p1.3.m3.1.1.2">7.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx3.p1.3.m3.1c">7.6\%</annotation></semantics></math> accuracy when <math id="S4.SS2.SSSx3.p1.4.m4.1" class="ltx_Math" alttext="\beta=5" display="inline"><semantics id="S4.SS2.SSSx3.p1.4.m4.1a"><mrow id="S4.SS2.SSSx3.p1.4.m4.1.1" xref="S4.SS2.SSSx3.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSSx3.p1.4.m4.1.1.2" xref="S4.SS2.SSSx3.p1.4.m4.1.1.2.cmml">β</mi><mo id="S4.SS2.SSSx3.p1.4.m4.1.1.1" xref="S4.SS2.SSSx3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.SSSx3.p1.4.m4.1.1.3" xref="S4.SS2.SSSx3.p1.4.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx3.p1.4.m4.1b"><apply id="S4.SS2.SSSx3.p1.4.m4.1.1.cmml" xref="S4.SS2.SSSx3.p1.4.m4.1.1"><eq id="S4.SS2.SSSx3.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSSx3.p1.4.m4.1.1.1"></eq><ci id="S4.SS2.SSSx3.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSSx3.p1.4.m4.1.1.2">𝛽</ci><cn type="integer" id="S4.SS2.SSSx3.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSSx3.p1.4.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx3.p1.4.m4.1c">\beta=5</annotation></semantics></math>.
When the data distributions are highly heterogeneous (<math id="S4.SS2.SSSx3.p1.5.m5.2" class="ltx_Math" alttext="\beta=0.5,0.1" display="inline"><semantics id="S4.SS2.SSSx3.p1.5.m5.2a"><mrow id="S4.SS2.SSSx3.p1.5.m5.2.3" xref="S4.SS2.SSSx3.p1.5.m5.2.3.cmml"><mi id="S4.SS2.SSSx3.p1.5.m5.2.3.2" xref="S4.SS2.SSSx3.p1.5.m5.2.3.2.cmml">β</mi><mo id="S4.SS2.SSSx3.p1.5.m5.2.3.1" xref="S4.SS2.SSSx3.p1.5.m5.2.3.1.cmml">=</mo><mrow id="S4.SS2.SSSx3.p1.5.m5.2.3.3.2" xref="S4.SS2.SSSx3.p1.5.m5.2.3.3.1.cmml"><mn id="S4.SS2.SSSx3.p1.5.m5.1.1" xref="S4.SS2.SSSx3.p1.5.m5.1.1.cmml">0.5</mn><mo id="S4.SS2.SSSx3.p1.5.m5.2.3.3.2.1" xref="S4.SS2.SSSx3.p1.5.m5.2.3.3.1.cmml">,</mo><mn id="S4.SS2.SSSx3.p1.5.m5.2.2" xref="S4.SS2.SSSx3.p1.5.m5.2.2.cmml">0.1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx3.p1.5.m5.2b"><apply id="S4.SS2.SSSx3.p1.5.m5.2.3.cmml" xref="S4.SS2.SSSx3.p1.5.m5.2.3"><eq id="S4.SS2.SSSx3.p1.5.m5.2.3.1.cmml" xref="S4.SS2.SSSx3.p1.5.m5.2.3.1"></eq><ci id="S4.SS2.SSSx3.p1.5.m5.2.3.2.cmml" xref="S4.SS2.SSSx3.p1.5.m5.2.3.2">𝛽</ci><list id="S4.SS2.SSSx3.p1.5.m5.2.3.3.1.cmml" xref="S4.SS2.SSSx3.p1.5.m5.2.3.3.2"><cn type="float" id="S4.SS2.SSSx3.p1.5.m5.1.1.cmml" xref="S4.SS2.SSSx3.p1.5.m5.1.1">0.5</cn><cn type="float" id="S4.SS2.SSSx3.p1.5.m5.2.2.cmml" xref="S4.SS2.SSSx3.p1.5.m5.2.2">0.1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx3.p1.5.m5.2c">\beta=0.5,0.1</annotation></semantics></math>), FedProc still outperformed MOON by <math id="S4.SS2.SSSx3.p1.6.m6.1" class="ltx_Math" alttext="7.1\%" display="inline"><semantics id="S4.SS2.SSSx3.p1.6.m6.1a"><mrow id="S4.SS2.SSSx3.p1.6.m6.1.1" xref="S4.SS2.SSSx3.p1.6.m6.1.1.cmml"><mn id="S4.SS2.SSSx3.p1.6.m6.1.1.2" xref="S4.SS2.SSSx3.p1.6.m6.1.1.2.cmml">7.1</mn><mo id="S4.SS2.SSSx3.p1.6.m6.1.1.1" xref="S4.SS2.SSSx3.p1.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx3.p1.6.m6.1b"><apply id="S4.SS2.SSSx3.p1.6.m6.1.1.cmml" xref="S4.SS2.SSSx3.p1.6.m6.1.1"><csymbol cd="latexml" id="S4.SS2.SSSx3.p1.6.m6.1.1.1.cmml" xref="S4.SS2.SSSx3.p1.6.m6.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.SSSx3.p1.6.m6.1.1.2.cmml" xref="S4.SS2.SSSx3.p1.6.m6.1.1.2">7.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx3.p1.6.m6.1c">7.1\%</annotation></semantics></math> and <math id="S4.SS2.SSSx3.p1.7.m7.1" class="ltx_Math" alttext="4.9\%" display="inline"><semantics id="S4.SS2.SSSx3.p1.7.m7.1a"><mrow id="S4.SS2.SSSx3.p1.7.m7.1.1" xref="S4.SS2.SSSx3.p1.7.m7.1.1.cmml"><mn id="S4.SS2.SSSx3.p1.7.m7.1.1.2" xref="S4.SS2.SSSx3.p1.7.m7.1.1.2.cmml">4.9</mn><mo id="S4.SS2.SSSx3.p1.7.m7.1.1.1" xref="S4.SS2.SSSx3.p1.7.m7.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx3.p1.7.m7.1b"><apply id="S4.SS2.SSSx3.p1.7.m7.1.1.cmml" xref="S4.SS2.SSSx3.p1.7.m7.1.1"><csymbol cd="latexml" id="S4.SS2.SSSx3.p1.7.m7.1.1.1.cmml" xref="S4.SS2.SSSx3.p1.7.m7.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.SSSx3.p1.7.m7.1.1.2.cmml" xref="S4.SS2.SSSx3.p1.7.m7.1.1.2">4.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx3.p1.7.m7.1c">4.9\%</annotation></semantics></math> accuracy, respectively. This result verifies our motivations, since the advantage of FedProc benefits from the introduction of class prototypes, which serve as global knowledge to correct the local training. In contrast, other methods do not make full use of the underlying knowledge, such as the global class-prototypes.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>The top-1 test accuracy with <math id="S4.T3.2.m1.3" class="ltx_Math" alttext="\beta=5,0.5,0.1" display="inline"><semantics id="S4.T3.2.m1.3b"><mrow id="S4.T3.2.m1.3.4" xref="S4.T3.2.m1.3.4.cmml"><mi id="S4.T3.2.m1.3.4.2" xref="S4.T3.2.m1.3.4.2.cmml">β</mi><mo id="S4.T3.2.m1.3.4.1" xref="S4.T3.2.m1.3.4.1.cmml">=</mo><mrow id="S4.T3.2.m1.3.4.3.2" xref="S4.T3.2.m1.3.4.3.1.cmml"><mn id="S4.T3.2.m1.1.1" xref="S4.T3.2.m1.1.1.cmml">5</mn><mo id="S4.T3.2.m1.3.4.3.2.1" xref="S4.T3.2.m1.3.4.3.1.cmml">,</mo><mn id="S4.T3.2.m1.2.2" xref="S4.T3.2.m1.2.2.cmml">0.5</mn><mo id="S4.T3.2.m1.3.4.3.2.2" xref="S4.T3.2.m1.3.4.3.1.cmml">,</mo><mn id="S4.T3.2.m1.3.3" xref="S4.T3.2.m1.3.3.cmml">0.1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.2.m1.3c"><apply id="S4.T3.2.m1.3.4.cmml" xref="S4.T3.2.m1.3.4"><eq id="S4.T3.2.m1.3.4.1.cmml" xref="S4.T3.2.m1.3.4.1"></eq><ci id="S4.T3.2.m1.3.4.2.cmml" xref="S4.T3.2.m1.3.4.2">𝛽</ci><list id="S4.T3.2.m1.3.4.3.1.cmml" xref="S4.T3.2.m1.3.4.3.2"><cn type="integer" id="S4.T3.2.m1.1.1.cmml" xref="S4.T3.2.m1.1.1">5</cn><cn type="float" id="S4.T3.2.m1.2.2.cmml" xref="S4.T3.2.m1.2.2">0.5</cn><cn type="float" id="S4.T3.2.m1.3.3.cmml" xref="S4.T3.2.m1.3.3">0.1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.m1.3d">\beta=5,0.5,0.1</annotation></semantics></math>.</figcaption>
<table id="S4.T3.23" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.5.3" class="ltx_tr">
<th id="S4.T3.5.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:13.7pt;padding-right:13.7pt;">Method</th>
<th id="S4.T3.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:13.7pt;padding-right:13.7pt;">
<math id="S4.T3.3.1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.T3.3.1.1.m1.1a"><mi id="S4.T3.3.1.1.m1.1.1" xref="S4.T3.3.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T3.3.1.1.m1.1b"><ci id="S4.T3.3.1.1.m1.1.1.cmml" xref="S4.T3.3.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.1.1.m1.1c">\beta</annotation></semantics></math> = 5</th>
<th id="S4.T3.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:13.7pt;padding-right:13.7pt;">
<math id="S4.T3.4.2.2.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.T3.4.2.2.m1.1a"><mi id="S4.T3.4.2.2.m1.1.1" xref="S4.T3.4.2.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T3.4.2.2.m1.1b"><ci id="S4.T3.4.2.2.m1.1.1.cmml" xref="S4.T3.4.2.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.2.2.m1.1c">\beta</annotation></semantics></math> = 0.5</th>
<th id="S4.T3.5.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:13.7pt;padding-right:13.7pt;">
<math id="S4.T3.5.3.3.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.T3.5.3.3.m1.1a"><mi id="S4.T3.5.3.3.m1.1.1" xref="S4.T3.5.3.3.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T3.5.3.3.m1.1b"><ci id="S4.T3.5.3.3.m1.1.1.cmml" xref="S4.T3.5.3.3.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.3.3.m1.1c">\beta</annotation></semantics></math> = 0.1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.8.6" class="ltx_tr">
<th id="S4.T3.8.6.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:13.7pt;padding-right:13.7pt;">SOLO</th>
<td id="S4.T3.6.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.6.4.1.m1.1" class="ltx_Math" alttext="26.6\%" display="inline"><semantics id="S4.T3.6.4.1.m1.1a"><mrow id="S4.T3.6.4.1.m1.1.1" xref="S4.T3.6.4.1.m1.1.1.cmml"><mn id="S4.T3.6.4.1.m1.1.1.2" xref="S4.T3.6.4.1.m1.1.1.2.cmml">26.6</mn><mo id="S4.T3.6.4.1.m1.1.1.1" xref="S4.T3.6.4.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.6.4.1.m1.1b"><apply id="S4.T3.6.4.1.m1.1.1.cmml" xref="S4.T3.6.4.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.6.4.1.m1.1.1.1.cmml" xref="S4.T3.6.4.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.6.4.1.m1.1.1.2.cmml" xref="S4.T3.6.4.1.m1.1.1.2">26.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.4.1.m1.1c">26.6\%</annotation></semantics></math></td>
<td id="S4.T3.7.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.7.5.2.m1.1" class="ltx_Math" alttext="22.3\%" display="inline"><semantics id="S4.T3.7.5.2.m1.1a"><mrow id="S4.T3.7.5.2.m1.1.1" xref="S4.T3.7.5.2.m1.1.1.cmml"><mn id="S4.T3.7.5.2.m1.1.1.2" xref="S4.T3.7.5.2.m1.1.1.2.cmml">22.3</mn><mo id="S4.T3.7.5.2.m1.1.1.1" xref="S4.T3.7.5.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.7.5.2.m1.1b"><apply id="S4.T3.7.5.2.m1.1.1.cmml" xref="S4.T3.7.5.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.7.5.2.m1.1.1.1.cmml" xref="S4.T3.7.5.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.7.5.2.m1.1.1.2.cmml" xref="S4.T3.7.5.2.m1.1.1.2">22.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.5.2.m1.1c">22.3\%</annotation></semantics></math></td>
<td id="S4.T3.8.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.8.6.3.m1.1" class="ltx_Math" alttext="15.9\%" display="inline"><semantics id="S4.T3.8.6.3.m1.1a"><mrow id="S4.T3.8.6.3.m1.1.1" xref="S4.T3.8.6.3.m1.1.1.cmml"><mn id="S4.T3.8.6.3.m1.1.1.2" xref="S4.T3.8.6.3.m1.1.1.2.cmml">15.9</mn><mo id="S4.T3.8.6.3.m1.1.1.1" xref="S4.T3.8.6.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.8.6.3.m1.1b"><apply id="S4.T3.8.6.3.m1.1.1.cmml" xref="S4.T3.8.6.3.m1.1.1"><csymbol cd="latexml" id="S4.T3.8.6.3.m1.1.1.1.cmml" xref="S4.T3.8.6.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.8.6.3.m1.1.1.2.cmml" xref="S4.T3.8.6.3.m1.1.1.2">15.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.6.3.m1.1c">15.9\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T3.11.9" class="ltx_tr">
<th id="S4.T3.11.9.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;">FedAvg</th>
<td id="S4.T3.9.7.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.9.7.1.m1.1" class="ltx_Math" alttext="65.7\%" display="inline"><semantics id="S4.T3.9.7.1.m1.1a"><mrow id="S4.T3.9.7.1.m1.1.1" xref="S4.T3.9.7.1.m1.1.1.cmml"><mn id="S4.T3.9.7.1.m1.1.1.2" xref="S4.T3.9.7.1.m1.1.1.2.cmml">65.7</mn><mo id="S4.T3.9.7.1.m1.1.1.1" xref="S4.T3.9.7.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.9.7.1.m1.1b"><apply id="S4.T3.9.7.1.m1.1.1.cmml" xref="S4.T3.9.7.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.9.7.1.m1.1.1.1.cmml" xref="S4.T3.9.7.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.9.7.1.m1.1.1.2.cmml" xref="S4.T3.9.7.1.m1.1.1.2">65.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.7.1.m1.1c">65.7\%</annotation></semantics></math></td>
<td id="S4.T3.10.8.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.10.8.2.m1.1" class="ltx_Math" alttext="64.5\%" display="inline"><semantics id="S4.T3.10.8.2.m1.1a"><mrow id="S4.T3.10.8.2.m1.1.1" xref="S4.T3.10.8.2.m1.1.1.cmml"><mn id="S4.T3.10.8.2.m1.1.1.2" xref="S4.T3.10.8.2.m1.1.1.2.cmml">64.5</mn><mo id="S4.T3.10.8.2.m1.1.1.1" xref="S4.T3.10.8.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.10.8.2.m1.1b"><apply id="S4.T3.10.8.2.m1.1.1.cmml" xref="S4.T3.10.8.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.10.8.2.m1.1.1.1.cmml" xref="S4.T3.10.8.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.10.8.2.m1.1.1.2.cmml" xref="S4.T3.10.8.2.m1.1.1.2">64.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.8.2.m1.1c">64.5\%</annotation></semantics></math></td>
<td id="S4.T3.11.9.3" class="ltx_td ltx_align_center" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.11.9.3.m1.1" class="ltx_Math" alttext="62.5\%" display="inline"><semantics id="S4.T3.11.9.3.m1.1a"><mrow id="S4.T3.11.9.3.m1.1.1" xref="S4.T3.11.9.3.m1.1.1.cmml"><mn id="S4.T3.11.9.3.m1.1.1.2" xref="S4.T3.11.9.3.m1.1.1.2.cmml">62.5</mn><mo id="S4.T3.11.9.3.m1.1.1.1" xref="S4.T3.11.9.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.11.9.3.m1.1b"><apply id="S4.T3.11.9.3.m1.1.1.cmml" xref="S4.T3.11.9.3.m1.1.1"><csymbol cd="latexml" id="S4.T3.11.9.3.m1.1.1.1.cmml" xref="S4.T3.11.9.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.11.9.3.m1.1.1.2.cmml" xref="S4.T3.11.9.3.m1.1.1.2">62.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.9.3.m1.1c">62.5\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T3.14.12" class="ltx_tr">
<th id="S4.T3.14.12.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;">SCAFFOLD</th>
<td id="S4.T3.12.10.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.12.10.1.m1.1" class="ltx_Math" alttext="55.0\%" display="inline"><semantics id="S4.T3.12.10.1.m1.1a"><mrow id="S4.T3.12.10.1.m1.1.1" xref="S4.T3.12.10.1.m1.1.1.cmml"><mn id="S4.T3.12.10.1.m1.1.1.2" xref="S4.T3.12.10.1.m1.1.1.2.cmml">55.0</mn><mo id="S4.T3.12.10.1.m1.1.1.1" xref="S4.T3.12.10.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.12.10.1.m1.1b"><apply id="S4.T3.12.10.1.m1.1.1.cmml" xref="S4.T3.12.10.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.12.10.1.m1.1.1.1.cmml" xref="S4.T3.12.10.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.12.10.1.m1.1.1.2.cmml" xref="S4.T3.12.10.1.m1.1.1.2">55.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.10.1.m1.1c">55.0\%</annotation></semantics></math></td>
<td id="S4.T3.13.11.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.13.11.2.m1.1" class="ltx_Math" alttext="52.5\%" display="inline"><semantics id="S4.T3.13.11.2.m1.1a"><mrow id="S4.T3.13.11.2.m1.1.1" xref="S4.T3.13.11.2.m1.1.1.cmml"><mn id="S4.T3.13.11.2.m1.1.1.2" xref="S4.T3.13.11.2.m1.1.1.2.cmml">52.5</mn><mo id="S4.T3.13.11.2.m1.1.1.1" xref="S4.T3.13.11.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.13.11.2.m1.1b"><apply id="S4.T3.13.11.2.m1.1.1.cmml" xref="S4.T3.13.11.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.13.11.2.m1.1.1.1.cmml" xref="S4.T3.13.11.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.13.11.2.m1.1.1.2.cmml" xref="S4.T3.13.11.2.m1.1.1.2">52.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.13.11.2.m1.1c">52.5\%</annotation></semantics></math></td>
<td id="S4.T3.14.12.3" class="ltx_td ltx_align_center" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.14.12.3.m1.1" class="ltx_Math" alttext="47.3\%" display="inline"><semantics id="S4.T3.14.12.3.m1.1a"><mrow id="S4.T3.14.12.3.m1.1.1" xref="S4.T3.14.12.3.m1.1.1.cmml"><mn id="S4.T3.14.12.3.m1.1.1.2" xref="S4.T3.14.12.3.m1.1.1.2.cmml">47.3</mn><mo id="S4.T3.14.12.3.m1.1.1.1" xref="S4.T3.14.12.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.14.12.3.m1.1b"><apply id="S4.T3.14.12.3.m1.1.1.cmml" xref="S4.T3.14.12.3.m1.1.1"><csymbol cd="latexml" id="S4.T3.14.12.3.m1.1.1.1.cmml" xref="S4.T3.14.12.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.14.12.3.m1.1.1.2.cmml" xref="S4.T3.14.12.3.m1.1.1.2">47.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.14.12.3.m1.1c">47.3\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T3.17.15" class="ltx_tr">
<th id="S4.T3.17.15.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;">FedProx</th>
<td id="S4.T3.15.13.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.15.13.1.m1.1" class="ltx_Math" alttext="64.9\%" display="inline"><semantics id="S4.T3.15.13.1.m1.1a"><mrow id="S4.T3.15.13.1.m1.1.1" xref="S4.T3.15.13.1.m1.1.1.cmml"><mn id="S4.T3.15.13.1.m1.1.1.2" xref="S4.T3.15.13.1.m1.1.1.2.cmml">64.9</mn><mo id="S4.T3.15.13.1.m1.1.1.1" xref="S4.T3.15.13.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.15.13.1.m1.1b"><apply id="S4.T3.15.13.1.m1.1.1.cmml" xref="S4.T3.15.13.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.15.13.1.m1.1.1.1.cmml" xref="S4.T3.15.13.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.15.13.1.m1.1.1.2.cmml" xref="S4.T3.15.13.1.m1.1.1.2">64.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.15.13.1.m1.1c">64.9\%</annotation></semantics></math></td>
<td id="S4.T3.16.14.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.16.14.2.m1.1" class="ltx_Math" alttext="64.6\%" display="inline"><semantics id="S4.T3.16.14.2.m1.1a"><mrow id="S4.T3.16.14.2.m1.1.1" xref="S4.T3.16.14.2.m1.1.1.cmml"><mn id="S4.T3.16.14.2.m1.1.1.2" xref="S4.T3.16.14.2.m1.1.1.2.cmml">64.6</mn><mo id="S4.T3.16.14.2.m1.1.1.1" xref="S4.T3.16.14.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.16.14.2.m1.1b"><apply id="S4.T3.16.14.2.m1.1.1.cmml" xref="S4.T3.16.14.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.16.14.2.m1.1.1.1.cmml" xref="S4.T3.16.14.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.16.14.2.m1.1.1.2.cmml" xref="S4.T3.16.14.2.m1.1.1.2">64.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.16.14.2.m1.1c">64.6\%</annotation></semantics></math></td>
<td id="S4.T3.17.15.3" class="ltx_td ltx_align_center" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.17.15.3.m1.1" class="ltx_Math" alttext="62.9\%" display="inline"><semantics id="S4.T3.17.15.3.m1.1a"><mrow id="S4.T3.17.15.3.m1.1.1" xref="S4.T3.17.15.3.m1.1.1.cmml"><mn id="S4.T3.17.15.3.m1.1.1.2" xref="S4.T3.17.15.3.m1.1.1.2.cmml">62.9</mn><mo id="S4.T3.17.15.3.m1.1.1.1" xref="S4.T3.17.15.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.17.15.3.m1.1b"><apply id="S4.T3.17.15.3.m1.1.1.cmml" xref="S4.T3.17.15.3.m1.1.1"><csymbol cd="latexml" id="S4.T3.17.15.3.m1.1.1.1.cmml" xref="S4.T3.17.15.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.17.15.3.m1.1.1.2.cmml" xref="S4.T3.17.15.3.m1.1.1.2">62.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.17.15.3.m1.1c">62.9\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T3.20.18" class="ltx_tr">
<th id="S4.T3.20.18.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;">MOON</th>
<td id="S4.T3.18.16.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.18.16.1.m1.1" class="ltx_Math" alttext="68.0\%" display="inline"><semantics id="S4.T3.18.16.1.m1.1a"><mrow id="S4.T3.18.16.1.m1.1.1" xref="S4.T3.18.16.1.m1.1.1.cmml"><mn id="S4.T3.18.16.1.m1.1.1.2" xref="S4.T3.18.16.1.m1.1.1.2.cmml">68.0</mn><mo id="S4.T3.18.16.1.m1.1.1.1" xref="S4.T3.18.16.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.18.16.1.m1.1b"><apply id="S4.T3.18.16.1.m1.1.1.cmml" xref="S4.T3.18.16.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.18.16.1.m1.1.1.1.cmml" xref="S4.T3.18.16.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.18.16.1.m1.1.1.2.cmml" xref="S4.T3.18.16.1.m1.1.1.2">68.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.18.16.1.m1.1c">68.0\%</annotation></semantics></math></td>
<td id="S4.T3.19.17.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.19.17.2.m1.1" class="ltx_Math" alttext="67.5\%" display="inline"><semantics id="S4.T3.19.17.2.m1.1a"><mrow id="S4.T3.19.17.2.m1.1.1" xref="S4.T3.19.17.2.m1.1.1.cmml"><mn id="S4.T3.19.17.2.m1.1.1.2" xref="S4.T3.19.17.2.m1.1.1.2.cmml">67.5</mn><mo id="S4.T3.19.17.2.m1.1.1.1" xref="S4.T3.19.17.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.19.17.2.m1.1b"><apply id="S4.T3.19.17.2.m1.1.1.cmml" xref="S4.T3.19.17.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.19.17.2.m1.1.1.1.cmml" xref="S4.T3.19.17.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.19.17.2.m1.1.1.2.cmml" xref="S4.T3.19.17.2.m1.1.1.2">67.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.19.17.2.m1.1c">67.5\%</annotation></semantics></math></td>
<td id="S4.T3.20.18.3" class="ltx_td ltx_align_center" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.20.18.3.m1.1" class="ltx_Math" alttext="64.0\%" display="inline"><semantics id="S4.T3.20.18.3.m1.1a"><mrow id="S4.T3.20.18.3.m1.1.1" xref="S4.T3.20.18.3.m1.1.1.cmml"><mn id="S4.T3.20.18.3.m1.1.1.2" xref="S4.T3.20.18.3.m1.1.1.2.cmml">64.0</mn><mo id="S4.T3.20.18.3.m1.1.1.1" xref="S4.T3.20.18.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.20.18.3.m1.1b"><apply id="S4.T3.20.18.3.m1.1.1.cmml" xref="S4.T3.20.18.3.m1.1.1"><csymbol cd="latexml" id="S4.T3.20.18.3.m1.1.1.1.cmml" xref="S4.T3.20.18.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.20.18.3.m1.1.1.2.cmml" xref="S4.T3.20.18.3.m1.1.1.2">64.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.20.18.3.m1.1c">64.0\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T3.23.21" class="ltx_tr">
<th id="S4.T3.23.21.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;">FedProc</th>
<td id="S4.T3.21.19.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.21.19.1.m1.1" class="ltx_Math" alttext="\mathbf{75.6\%}" display="inline"><semantics id="S4.T3.21.19.1.m1.1a"><mrow id="S4.T3.21.19.1.m1.1.1" xref="S4.T3.21.19.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T3.21.19.1.m1.1.1.2" xref="S4.T3.21.19.1.m1.1.1.2.cmml">75.6</mn><mo id="S4.T3.21.19.1.m1.1.1.1" xref="S4.T3.21.19.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.21.19.1.m1.1b"><apply id="S4.T3.21.19.1.m1.1.1.cmml" xref="S4.T3.21.19.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.21.19.1.m1.1.1.1.cmml" xref="S4.T3.21.19.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.21.19.1.m1.1.1.2.cmml" xref="S4.T3.21.19.1.m1.1.1.2">75.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.21.19.1.m1.1c">\mathbf{75.6\%}</annotation></semantics></math></td>
<td id="S4.T3.22.20.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.22.20.2.m1.1" class="ltx_Math" alttext="\mathbf{74.6\%}" display="inline"><semantics id="S4.T3.22.20.2.m1.1a"><mrow id="S4.T3.22.20.2.m1.1.1" xref="S4.T3.22.20.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T3.22.20.2.m1.1.1.2" xref="S4.T3.22.20.2.m1.1.1.2.cmml">74.6</mn><mo id="S4.T3.22.20.2.m1.1.1.1" xref="S4.T3.22.20.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.22.20.2.m1.1b"><apply id="S4.T3.22.20.2.m1.1.1.cmml" xref="S4.T3.22.20.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.22.20.2.m1.1.1.1.cmml" xref="S4.T3.22.20.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.22.20.2.m1.1.1.2.cmml" xref="S4.T3.22.20.2.m1.1.1.2">74.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.22.20.2.m1.1c">\mathbf{74.6\%}</annotation></semantics></math></td>
<td id="S4.T3.23.21.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:13.7pt;padding-right:13.7pt;"><math id="S4.T3.23.21.3.m1.1" class="ltx_Math" alttext="\mathbf{68.9\%}" display="inline"><semantics id="S4.T3.23.21.3.m1.1a"><mrow id="S4.T3.23.21.3.m1.1.1" xref="S4.T3.23.21.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T3.23.21.3.m1.1.1.2" xref="S4.T3.23.21.3.m1.1.1.2.cmml">68.9</mn><mo id="S4.T3.23.21.3.m1.1.1.1" xref="S4.T3.23.21.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.23.21.3.m1.1b"><apply id="S4.T3.23.21.3.m1.1.1.cmml" xref="S4.T3.23.21.3.m1.1.1"><csymbol cd="latexml" id="S4.T3.23.21.3.m1.1.1.1.cmml" xref="S4.T3.23.21.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T3.23.21.3.m1.1.1.2.cmml" xref="S4.T3.23.21.3.m1.1.1.2">68.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.23.21.3.m1.1c">\mathbf{68.9\%}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x14.png" id="S4.F6.sf1.g1" class="ltx_graphics ltx_img_portrait" width="238" height="308" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>50 clients</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.12273/assets/x15.png" id="S4.F6.sf2.g1" class="ltx_graphics ltx_img_portrait" width="238" height="308" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>100 clients</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>The top-1 test accuracy on CIFAR-100 with 50/100 clients.</figcaption>
</figure>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>The top-1 accuracy with different kinds of loss of local objective.</figcaption>
<table id="S4.T4.10" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.10.11.1" class="ltx_tr">
<th id="S4.T4.10.11.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:5.4pt;padding-right:5.4pt;">Method</th>
<th id="S4.T4.10.11.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:5.4pt;padding-right:5.4pt;">CIFAR-10</th>
<th id="S4.T4.10.11.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:5.4pt;padding-right:5.4pt;">CIFAR-100</th>
<th id="S4.T4.10.11.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:5.4pt;padding-right:5.4pt;">Tiny-ImageNet</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.3.3" class="ltx_tr">
<th id="S4.T4.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:5.4pt;padding-right:5.4pt;">Two-stage FL</th>
<td id="S4.T4.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.4pt;padding-right:5.4pt;"><math id="S4.T4.1.1.1.m1.1" class="ltx_Math" alttext="65.10\%" display="inline"><semantics id="S4.T4.1.1.1.m1.1a"><mrow id="S4.T4.1.1.1.m1.1.1" xref="S4.T4.1.1.1.m1.1.1.cmml"><mn id="S4.T4.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.m1.1.1.2.cmml">65.10</mn><mo id="S4.T4.1.1.1.m1.1.1.1" xref="S4.T4.1.1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T4.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T4.1.1.1.m1.1.1.2.cmml" xref="S4.T4.1.1.1.m1.1.1.2">65.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.m1.1c">65.10\%</annotation></semantics></math></td>
<td id="S4.T4.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.4pt;padding-right:5.4pt;"><math id="S4.T4.2.2.2.m1.1" class="ltx_Math" alttext="67.50\%" display="inline"><semantics id="S4.T4.2.2.2.m1.1a"><mrow id="S4.T4.2.2.2.m1.1.1" xref="S4.T4.2.2.2.m1.1.1.cmml"><mn id="S4.T4.2.2.2.m1.1.1.2" xref="S4.T4.2.2.2.m1.1.1.2.cmml">67.50</mn><mo id="S4.T4.2.2.2.m1.1.1.1" xref="S4.T4.2.2.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.m1.1b"><apply id="S4.T4.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.m1.1.1"><csymbol cd="latexml" id="S4.T4.2.2.2.m1.1.1.1.cmml" xref="S4.T4.2.2.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T4.2.2.2.m1.1.1.2.cmml" xref="S4.T4.2.2.2.m1.1.1.2">67.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.m1.1c">67.50\%</annotation></semantics></math></td>
<td id="S4.T4.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.4pt;padding-right:5.4pt;"><math id="S4.T4.3.3.3.m1.1" class="ltx_Math" alttext="24.70\%" display="inline"><semantics id="S4.T4.3.3.3.m1.1a"><mrow id="S4.T4.3.3.3.m1.1.1" xref="S4.T4.3.3.3.m1.1.1.cmml"><mn id="S4.T4.3.3.3.m1.1.1.2" xref="S4.T4.3.3.3.m1.1.1.2.cmml">24.70</mn><mo id="S4.T4.3.3.3.m1.1.1.1" xref="S4.T4.3.3.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.m1.1b"><apply id="S4.T4.3.3.3.m1.1.1.cmml" xref="S4.T4.3.3.3.m1.1.1"><csymbol cd="latexml" id="S4.T4.3.3.3.m1.1.1.1.cmml" xref="S4.T4.3.3.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T4.3.3.3.m1.1.1.2.cmml" xref="S4.T4.3.3.3.m1.1.1.2">24.70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.m1.1c">24.70\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T4.7.7" class="ltx_tr">
<th id="S4.T4.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:5.4pt;padding-right:5.4pt;">FedProc(<math id="S4.T4.4.4.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T4.4.4.1.m1.1a"><mi id="S4.T4.4.4.1.m1.1.1" xref="S4.T4.4.4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.1.m1.1b"><ci id="S4.T4.4.4.1.m1.1.1.cmml" xref="S4.T4.4.4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.1.m1.1c">\alpha</annotation></semantics></math>= 0.5)</th>
<td id="S4.T4.5.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.4pt;padding-right:5.4pt;"><math id="S4.T4.5.5.2.m1.1" class="ltx_Math" alttext="66.30\%" display="inline"><semantics id="S4.T4.5.5.2.m1.1a"><mrow id="S4.T4.5.5.2.m1.1.1" xref="S4.T4.5.5.2.m1.1.1.cmml"><mn id="S4.T4.5.5.2.m1.1.1.2" xref="S4.T4.5.5.2.m1.1.1.2.cmml">66.30</mn><mo id="S4.T4.5.5.2.m1.1.1.1" xref="S4.T4.5.5.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.2.m1.1b"><apply id="S4.T4.5.5.2.m1.1.1.cmml" xref="S4.T4.5.5.2.m1.1.1"><csymbol cd="latexml" id="S4.T4.5.5.2.m1.1.1.1.cmml" xref="S4.T4.5.5.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T4.5.5.2.m1.1.1.2.cmml" xref="S4.T4.5.5.2.m1.1.1.2">66.30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.2.m1.1c">66.30\%</annotation></semantics></math></td>
<td id="S4.T4.6.6.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.4pt;padding-right:5.4pt;"><math id="S4.T4.6.6.3.m1.1" class="ltx_Math" alttext="68.90\%" display="inline"><semantics id="S4.T4.6.6.3.m1.1a"><mrow id="S4.T4.6.6.3.m1.1.1" xref="S4.T4.6.6.3.m1.1.1.cmml"><mn id="S4.T4.6.6.3.m1.1.1.2" xref="S4.T4.6.6.3.m1.1.1.2.cmml">68.90</mn><mo id="S4.T4.6.6.3.m1.1.1.1" xref="S4.T4.6.6.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.6.6.3.m1.1b"><apply id="S4.T4.6.6.3.m1.1.1.cmml" xref="S4.T4.6.6.3.m1.1.1"><csymbol cd="latexml" id="S4.T4.6.6.3.m1.1.1.1.cmml" xref="S4.T4.6.6.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T4.6.6.3.m1.1.1.2.cmml" xref="S4.T4.6.6.3.m1.1.1.2">68.90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.6.3.m1.1c">68.90\%</annotation></semantics></math></td>
<td id="S4.T4.7.7.4" class="ltx_td ltx_align_center" style="padding-left:5.4pt;padding-right:5.4pt;"><math id="S4.T4.7.7.4.m1.1" class="ltx_Math" alttext="30.20\%" display="inline"><semantics id="S4.T4.7.7.4.m1.1a"><mrow id="S4.T4.7.7.4.m1.1.1" xref="S4.T4.7.7.4.m1.1.1.cmml"><mn id="S4.T4.7.7.4.m1.1.1.2" xref="S4.T4.7.7.4.m1.1.1.2.cmml">30.20</mn><mo id="S4.T4.7.7.4.m1.1.1.1" xref="S4.T4.7.7.4.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.7.7.4.m1.1b"><apply id="S4.T4.7.7.4.m1.1.1.cmml" xref="S4.T4.7.7.4.m1.1.1"><csymbol cd="latexml" id="S4.T4.7.7.4.m1.1.1.1.cmml" xref="S4.T4.7.7.4.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T4.7.7.4.m1.1.1.2.cmml" xref="S4.T4.7.7.4.m1.1.1.2">30.20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.7.4.m1.1c">30.20\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T4.10.10" class="ltx_tr">
<th id="S4.T4.10.10.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:5.4pt;padding-right:5.4pt;">FedProc</th>
<td id="S4.T4.8.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:5.4pt;padding-right:5.4pt;"><math id="S4.T4.8.8.1.m1.1" class="ltx_Math" alttext="\mathbf{70.70\%}" display="inline"><semantics id="S4.T4.8.8.1.m1.1a"><mrow id="S4.T4.8.8.1.m1.1.1" xref="S4.T4.8.8.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T4.8.8.1.m1.1.1.2" xref="S4.T4.8.8.1.m1.1.1.2.cmml">70.70</mn><mo id="S4.T4.8.8.1.m1.1.1.1" xref="S4.T4.8.8.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.8.8.1.m1.1b"><apply id="S4.T4.8.8.1.m1.1.1.cmml" xref="S4.T4.8.8.1.m1.1.1"><csymbol cd="latexml" id="S4.T4.8.8.1.m1.1.1.1.cmml" xref="S4.T4.8.8.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T4.8.8.1.m1.1.1.2.cmml" xref="S4.T4.8.8.1.m1.1.1.2">70.70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.8.1.m1.1c">\mathbf{70.70\%}</annotation></semantics></math></td>
<td id="S4.T4.9.9.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:5.4pt;padding-right:5.4pt;"><math id="S4.T4.9.9.2.m1.1" class="ltx_Math" alttext="\mathbf{74.60\%}" display="inline"><semantics id="S4.T4.9.9.2.m1.1a"><mrow id="S4.T4.9.9.2.m1.1.1" xref="S4.T4.9.9.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T4.9.9.2.m1.1.1.2" xref="S4.T4.9.9.2.m1.1.1.2.cmml">74.60</mn><mo id="S4.T4.9.9.2.m1.1.1.1" xref="S4.T4.9.9.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.9.9.2.m1.1b"><apply id="S4.T4.9.9.2.m1.1.1.cmml" xref="S4.T4.9.9.2.m1.1.1"><csymbol cd="latexml" id="S4.T4.9.9.2.m1.1.1.1.cmml" xref="S4.T4.9.9.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T4.9.9.2.m1.1.1.2.cmml" xref="S4.T4.9.9.2.m1.1.1.2">74.60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.9.9.2.m1.1c">\mathbf{74.60\%}</annotation></semantics></math></td>
<td id="S4.T4.10.10.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.4pt;padding-right:5.4pt;"><math id="S4.T4.10.10.3.m1.1" class="ltx_Math" alttext="\mathbf{35.40\%}" display="inline"><semantics id="S4.T4.10.10.3.m1.1a"><mrow id="S4.T4.10.10.3.m1.1.1" xref="S4.T4.10.10.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T4.10.10.3.m1.1.1.2" xref="S4.T4.10.10.3.m1.1.1.2.cmml">35.40</mn><mo id="S4.T4.10.10.3.m1.1.1.1" xref="S4.T4.10.10.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.10.10.3.m1.1b"><apply id="S4.T4.10.10.3.m1.1.1.cmml" xref="S4.T4.10.10.3.m1.1.1"><csymbol cd="latexml" id="S4.T4.10.10.3.m1.1.1.1.cmml" xref="S4.T4.10.10.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T4.10.10.3.m1.1.1.2.cmml" xref="S4.T4.10.10.3.m1.1.1.2">35.40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.10.10.3.m1.1c">\mathbf{35.40\%}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS2.SSSx4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Impact of coefficient in loss function (<math id="S4.SS2.SSSx4.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.SSSx4.1.m1.1b"><mi id="S4.SS2.SSSx4.1.m1.1.1" xref="S4.SS2.SSSx4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx4.1.m1.1c"><ci id="S4.SS2.SSSx4.1.m1.1.1.cmml" xref="S4.SS2.SSSx4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx4.1.m1.1d">\alpha</annotation></semantics></math>)</h4>

<div id="S4.SS2.SSSx4.p1" class="ltx_para">
<p id="S4.SS2.SSSx4.p1.5" class="ltx_p">In this work, we use the coefficient <math id="S4.SS2.SSSx4.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.SSSx4.p1.1.m1.1a"><mi id="S4.SS2.SSSx4.p1.1.m1.1.1" xref="S4.SS2.SSSx4.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx4.p1.1.m1.1b"><ci id="S4.SS2.SSSx4.p1.1.m1.1.1.cmml" xref="S4.SS2.SSSx4.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx4.p1.1.m1.1c">\alpha</annotation></semantics></math> to adjust the weights of the feature learning and classifier learning during the local training. To demonstrate the superiority of our method, we design a two-stage federated learning inspired by two-stage work <cite class="ltx_cite ltx_citemacro_citep">(Khosla et al. <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>. This method trains the features by <math id="S4.SS2.SSSx4.p1.2.m2.1" class="ltx_Math" alttext="\ell_{gpc}" display="inline"><semantics id="S4.SS2.SSSx4.p1.2.m2.1a"><msub id="S4.SS2.SSSx4.p1.2.m2.1.1" xref="S4.SS2.SSSx4.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.SSSx4.p1.2.m2.1.1.2" xref="S4.SS2.SSSx4.p1.2.m2.1.1.2.cmml">ℓ</mi><mrow id="S4.SS2.SSSx4.p1.2.m2.1.1.3" xref="S4.SS2.SSSx4.p1.2.m2.1.1.3.cmml"><mi id="S4.SS2.SSSx4.p1.2.m2.1.1.3.2" xref="S4.SS2.SSSx4.p1.2.m2.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSSx4.p1.2.m2.1.1.3.1" xref="S4.SS2.SSSx4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS2.SSSx4.p1.2.m2.1.1.3.3" xref="S4.SS2.SSSx4.p1.2.m2.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSSx4.p1.2.m2.1.1.3.1a" xref="S4.SS2.SSSx4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS2.SSSx4.p1.2.m2.1.1.3.4" xref="S4.SS2.SSSx4.p1.2.m2.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx4.p1.2.m2.1b"><apply id="S4.SS2.SSSx4.p1.2.m2.1.1.cmml" xref="S4.SS2.SSSx4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSSx4.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSSx4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSSx4.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSSx4.p1.2.m2.1.1.2">ℓ</ci><apply id="S4.SS2.SSSx4.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSSx4.p1.2.m2.1.1.3"><times id="S4.SS2.SSSx4.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.SSSx4.p1.2.m2.1.1.3.1"></times><ci id="S4.SS2.SSSx4.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.SSSx4.p1.2.m2.1.1.3.2">𝑔</ci><ci id="S4.SS2.SSSx4.p1.2.m2.1.1.3.3.cmml" xref="S4.SS2.SSSx4.p1.2.m2.1.1.3.3">𝑝</ci><ci id="S4.SS2.SSSx4.p1.2.m2.1.1.3.4.cmml" xref="S4.SS2.SSSx4.p1.2.m2.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx4.p1.2.m2.1c">\ell_{gpc}</annotation></semantics></math> loss in the first stage and then fixes the features to train classifiers in the second stage. As shown in Table <a href="#S4.T4" title="Table 4 ‣ Impact of data heterogeneity (𝛽) ‣ 4.2 Accuracy Results ‣ 4 Experiment ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the accuracy of our method is evidently higher than that of the two-stage training method. It is because that the training with two stages breaks the compatibility between feature learning and classifier learning. To validate the efficacy of the setting method of <math id="S4.SS2.SSSx4.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.SSSx4.p1.3.m3.1a"><mi id="S4.SS2.SSSx4.p1.3.m3.1.1" xref="S4.SS2.SSSx4.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx4.p1.3.m3.1b"><ci id="S4.SS2.SSSx4.p1.3.m3.1.1.cmml" xref="S4.SS2.SSSx4.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx4.p1.3.m3.1c">\alpha</annotation></semantics></math>, we re-run FedProc when fixing <math id="S4.SS2.SSSx4.p1.4.m4.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S4.SS2.SSSx4.p1.4.m4.1a"><mrow id="S4.SS2.SSSx4.p1.4.m4.1.1" xref="S4.SS2.SSSx4.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSSx4.p1.4.m4.1.1.2" xref="S4.SS2.SSSx4.p1.4.m4.1.1.2.cmml">α</mi><mo id="S4.SS2.SSSx4.p1.4.m4.1.1.1" xref="S4.SS2.SSSx4.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.SSSx4.p1.4.m4.1.1.3" xref="S4.SS2.SSSx4.p1.4.m4.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx4.p1.4.m4.1b"><apply id="S4.SS2.SSSx4.p1.4.m4.1.1.cmml" xref="S4.SS2.SSSx4.p1.4.m4.1.1"><eq id="S4.SS2.SSSx4.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSSx4.p1.4.m4.1.1.1"></eq><ci id="S4.SS2.SSSx4.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSSx4.p1.4.m4.1.1.2">𝛼</ci><cn type="float" id="S4.SS2.SSSx4.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSSx4.p1.4.m4.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx4.p1.4.m4.1c">\alpha=0.5</annotation></semantics></math>. Obviously, the results in this setting are worse than ours. When <math id="S4.SS2.SSSx4.p1.5.m5.1" class="ltx_Math" alttext="\alpha=1-\frac{t}{T}" display="inline"><semantics id="S4.SS2.SSSx4.p1.5.m5.1a"><mrow id="S4.SS2.SSSx4.p1.5.m5.1.1" xref="S4.SS2.SSSx4.p1.5.m5.1.1.cmml"><mi id="S4.SS2.SSSx4.p1.5.m5.1.1.2" xref="S4.SS2.SSSx4.p1.5.m5.1.1.2.cmml">α</mi><mo id="S4.SS2.SSSx4.p1.5.m5.1.1.1" xref="S4.SS2.SSSx4.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S4.SS2.SSSx4.p1.5.m5.1.1.3" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3.cmml"><mn id="S4.SS2.SSSx4.p1.5.m5.1.1.3.2" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3.2.cmml">1</mn><mo id="S4.SS2.SSSx4.p1.5.m5.1.1.3.1" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3.1.cmml">−</mo><mfrac id="S4.SS2.SSSx4.p1.5.m5.1.1.3.3" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3.3.cmml"><mi id="S4.SS2.SSSx4.p1.5.m5.1.1.3.3.2" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3.3.2.cmml">t</mi><mi id="S4.SS2.SSSx4.p1.5.m5.1.1.3.3.3" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3.3.3.cmml">T</mi></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx4.p1.5.m5.1b"><apply id="S4.SS2.SSSx4.p1.5.m5.1.1.cmml" xref="S4.SS2.SSSx4.p1.5.m5.1.1"><eq id="S4.SS2.SSSx4.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSSx4.p1.5.m5.1.1.1"></eq><ci id="S4.SS2.SSSx4.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSSx4.p1.5.m5.1.1.2">𝛼</ci><apply id="S4.SS2.SSSx4.p1.5.m5.1.1.3.cmml" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3"><minus id="S4.SS2.SSSx4.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3.1"></minus><cn type="integer" id="S4.SS2.SSSx4.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3.2">1</cn><apply id="S4.SS2.SSSx4.p1.5.m5.1.1.3.3.cmml" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3.3"><divide id="S4.SS2.SSSx4.p1.5.m5.1.1.3.3.1.cmml" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3.3"></divide><ci id="S4.SS2.SSSx4.p1.5.m5.1.1.3.3.2.cmml" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3.3.2">𝑡</ci><ci id="S4.SS2.SSSx4.p1.5.m5.1.1.3.3.3.cmml" xref="S4.SS2.SSSx4.p1.5.m5.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx4.p1.5.m5.1c">\alpha=1-\frac{t}{T}</annotation></semantics></math>, FedProc learns better representations in the early stages of the training, making it have the greater classification capacity in the later stages.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Computation Cost</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.2" class="ltx_p">To make a fair comparison, we measure the computation cost of all the above methods under the same machines. Table <a href="#S4.T5" title="Table 5 ‣ 4.3 Computation Cost ‣ 4 Experiment ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the average training time per round. We can observe that the average training time of FedAvg is the lowest of all. The reason is, FedProx, MOON, and FedProc introduce additional loss items based on FedAvg, and SCAFFOLD introduces additional control variables for the server and clients. We also find that the average training time of FedProc on CIFAR-<math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mn id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><cn type="integer" id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">10</annotation></semantics></math> and CIFAR-<math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mn id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><cn type="integer" id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">100</annotation></semantics></math> is nearly the same as most of the methods (e.g., SCAFFOLD and FedProx).
As a highlight, FedProc on Tiny-ImageNet is superior to other methods (except FedAvg). We can conclude that FedProc has more advantages in the computation cost as the volume of data and the scale of local networks increases.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>The average training time per round.</figcaption>
<table id="S4.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.1.1.1" class="ltx_tr">
<th id="S4.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:7.2pt;padding-right:7.2pt;">Method</th>
<th id="S4.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:7.2pt;padding-right:7.2pt;">CIFAR-10</th>
<th id="S4.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:7.2pt;padding-right:7.2pt;">CIFAR-100</th>
<th id="S4.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:7.2pt;padding-right:7.2pt;">Tiny-ImageNet</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.1.2.1" class="ltx_tr">
<td id="S4.T5.1.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:7.2pt;padding-right:7.2pt;">FedAvg</td>
<td id="S4.T5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:7.2pt;padding-right:7.2pt;">8min34s</td>
<td id="S4.T5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:7.2pt;padding-right:7.2pt;">24min36s</td>
<td id="S4.T5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.2pt;padding-right:7.2pt;">104min11s</td>
</tr>
<tr id="S4.T5.1.3.2" class="ltx_tr">
<td id="S4.T5.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.2pt;padding-right:7.2pt;">SCAFFOLD</td>
<td id="S4.T5.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.2pt;padding-right:7.2pt;"><span id="S4.T5.1.3.2.2.1" class="ltx_text ltx_font_bold">8min43s</span></td>
<td id="S4.T5.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.2pt;padding-right:7.2pt;">27min55s</td>
<td id="S4.T5.1.3.2.4" class="ltx_td ltx_align_center" style="padding-left:7.2pt;padding-right:7.2pt;">181min56s</td>
</tr>
<tr id="S4.T5.1.4.3" class="ltx_tr">
<td id="S4.T5.1.4.3.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.2pt;padding-right:7.2pt;">FedProx</td>
<td id="S4.T5.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.2pt;padding-right:7.2pt;">8min52s</td>
<td id="S4.T5.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.2pt;padding-right:7.2pt;"><span id="S4.T5.1.4.3.3.1" class="ltx_text ltx_font_bold">27min28s</span></td>
<td id="S4.T5.1.4.3.4" class="ltx_td ltx_align_center" style="padding-left:7.2pt;padding-right:7.2pt;">117min7s</td>
</tr>
<tr id="S4.T5.1.5.4" class="ltx_tr">
<td id="S4.T5.1.5.4.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.2pt;padding-right:7.2pt;">MOON</td>
<td id="S4.T5.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.2pt;padding-right:7.2pt;">9min6s</td>
<td id="S4.T5.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:7.2pt;padding-right:7.2pt;">45min5s</td>
<td id="S4.T5.1.5.4.4" class="ltx_td ltx_align_center" style="padding-left:7.2pt;padding-right:7.2pt;">186min10s</td>
</tr>
<tr id="S4.T5.1.6.5" class="ltx_tr">
<td id="S4.T5.1.6.5.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:7.2pt;padding-right:7.2pt;">FedProc</td>
<td id="S4.T5.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:7.2pt;padding-right:7.2pt;">11min57s</td>
<td id="S4.T5.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:7.2pt;padding-right:7.2pt;">27min41s</td>
<td id="S4.T5.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:7.2pt;padding-right:7.2pt;"><span id="S4.T5.1.6.5.4.1" class="ltx_text ltx_font_bold">111min12s</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Scalability</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.11" class="ltx_p">In order to demonstrate the scalability of FedProc, we ran the experiments on CIFAR-100 with a large number of clients. As in the previous work <cite class="ltx_cite ltx_citemacro_citep">(Li, He, and Song <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>, the number of clients (<math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">m</annotation></semantics></math>) is set to <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mn id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><cn type="integer" id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">50</annotation></semantics></math> (with sampling rate <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="\gamma=1" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><mrow id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml">γ</mi><mo id="S4.SS4.p1.3.m3.1.1.1" xref="S4.SS4.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><eq id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1.1"></eq><ci id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2">𝛾</ci><cn type="integer" id="S4.SS4.p1.3.m3.1.1.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">\gamma=1</annotation></semantics></math>) and <math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><mn id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><cn type="integer" id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">100</annotation></semantics></math> (with sampling rate <math id="S4.SS4.p1.5.m5.1" class="ltx_Math" alttext="\gamma=0.2" display="inline"><semantics id="S4.SS4.p1.5.m5.1a"><mrow id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml"><mi id="S4.SS4.p1.5.m5.1.1.2" xref="S4.SS4.p1.5.m5.1.1.2.cmml">γ</mi><mo id="S4.SS4.p1.5.m5.1.1.1" xref="S4.SS4.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.5.m5.1.1.3" xref="S4.SS4.p1.5.m5.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><apply id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1"><eq id="S4.SS4.p1.5.m5.1.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1"></eq><ci id="S4.SS4.p1.5.m5.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1.2">𝛾</ci><cn type="float" id="S4.SS4.p1.5.m5.1.1.3.cmml" xref="S4.SS4.p1.5.m5.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">\gamma=0.2</annotation></semantics></math>). Note that <math id="S4.SS4.p1.6.m6.1" class="ltx_Math" alttext="\gamma=0.2" display="inline"><semantics id="S4.SS4.p1.6.m6.1a"><mrow id="S4.SS4.p1.6.m6.1.1" xref="S4.SS4.p1.6.m6.1.1.cmml"><mi id="S4.SS4.p1.6.m6.1.1.2" xref="S4.SS4.p1.6.m6.1.1.2.cmml">γ</mi><mo id="S4.SS4.p1.6.m6.1.1.1" xref="S4.SS4.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.6.m6.1.1.3" xref="S4.SS4.p1.6.m6.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m6.1b"><apply id="S4.SS4.p1.6.m6.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1"><eq id="S4.SS4.p1.6.m6.1.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1.1"></eq><ci id="S4.SS4.p1.6.m6.1.1.2.cmml" xref="S4.SS4.p1.6.m6.1.1.2">𝛾</ci><cn type="float" id="S4.SS4.p1.6.m6.1.1.3.cmml" xref="S4.SS4.p1.6.m6.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m6.1c">\gamma=0.2</annotation></semantics></math> means that <math id="S4.SS4.p1.7.m7.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.SS4.p1.7.m7.1a"><mn id="S4.SS4.p1.7.m7.1.1" xref="S4.SS4.p1.7.m7.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.7.m7.1b"><cn type="integer" id="S4.SS4.p1.7.m7.1.1.cmml" xref="S4.SS4.p1.7.m7.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.7.m7.1c">20</annotation></semantics></math> clients out of <math id="S4.SS4.p1.8.m8.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS4.p1.8.m8.1a"><mn id="S4.SS4.p1.8.m8.1.1" xref="S4.SS4.p1.8.m8.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.8.m8.1b"><cn type="integer" id="S4.SS4.p1.8.m8.1.1.cmml" xref="S4.SS4.p1.8.m8.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.8.m8.1c">100</annotation></semantics></math> clients are randomly selected to participate in the training in each round (refer to FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> for client sampling technology).
The results in Table <a href="#S4.T6" title="Table 6 ‣ 4.4 Scalability ‣ 4 Experiment ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> and Figure <a href="#S4.F6" title="Figure 6 ‣ Impact of data heterogeneity (𝛽) ‣ 4.2 Accuracy Results ‣ 4 Experiment ‣ FedProc: Prototypical Contrastive Federated Learning on Non-IID data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> demonstrate the excellent scalability of FedProc, whose accuracy is far higher than those of the other methods. In particular, our method outperforms MOON by <math id="S4.SS4.p1.9.m9.1" class="ltx_Math" alttext="9.3\%" display="inline"><semantics id="S4.SS4.p1.9.m9.1a"><mrow id="S4.SS4.p1.9.m9.1.1" xref="S4.SS4.p1.9.m9.1.1.cmml"><mn id="S4.SS4.p1.9.m9.1.1.2" xref="S4.SS4.p1.9.m9.1.1.2.cmml">9.3</mn><mo id="S4.SS4.p1.9.m9.1.1.1" xref="S4.SS4.p1.9.m9.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.9.m9.1b"><apply id="S4.SS4.p1.9.m9.1.1.cmml" xref="S4.SS4.p1.9.m9.1.1"><csymbol cd="latexml" id="S4.SS4.p1.9.m9.1.1.1.cmml" xref="S4.SS4.p1.9.m9.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.p1.9.m9.1.1.2.cmml" xref="S4.SS4.p1.9.m9.1.1.2">9.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.9.m9.1c">9.3\%</annotation></semantics></math> accuracy when the number of rounds <math id="S4.SS4.p1.10.m10.1" class="ltx_Math" alttext="T=200" display="inline"><semantics id="S4.SS4.p1.10.m10.1a"><mrow id="S4.SS4.p1.10.m10.1.1" xref="S4.SS4.p1.10.m10.1.1.cmml"><mi id="S4.SS4.p1.10.m10.1.1.2" xref="S4.SS4.p1.10.m10.1.1.2.cmml">T</mi><mo id="S4.SS4.p1.10.m10.1.1.1" xref="S4.SS4.p1.10.m10.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.10.m10.1.1.3" xref="S4.SS4.p1.10.m10.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.10.m10.1b"><apply id="S4.SS4.p1.10.m10.1.1.cmml" xref="S4.SS4.p1.10.m10.1.1"><eq id="S4.SS4.p1.10.m10.1.1.1.cmml" xref="S4.SS4.p1.10.m10.1.1.1"></eq><ci id="S4.SS4.p1.10.m10.1.1.2.cmml" xref="S4.SS4.p1.10.m10.1.1.2">𝑇</ci><cn type="integer" id="S4.SS4.p1.10.m10.1.1.3.cmml" xref="S4.SS4.p1.10.m10.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.10.m10.1c">T=200</annotation></semantics></math> and the number of clients <math id="S4.SS4.p1.11.m11.1" class="ltx_Math" alttext="m=50" display="inline"><semantics id="S4.SS4.p1.11.m11.1a"><mrow id="S4.SS4.p1.11.m11.1.1" xref="S4.SS4.p1.11.m11.1.1.cmml"><mi id="S4.SS4.p1.11.m11.1.1.2" xref="S4.SS4.p1.11.m11.1.1.2.cmml">m</mi><mo id="S4.SS4.p1.11.m11.1.1.1" xref="S4.SS4.p1.11.m11.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.11.m11.1.1.3" xref="S4.SS4.p1.11.m11.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.11.m11.1b"><apply id="S4.SS4.p1.11.m11.1.1.cmml" xref="S4.SS4.p1.11.m11.1.1"><eq id="S4.SS4.p1.11.m11.1.1.1.cmml" xref="S4.SS4.p1.11.m11.1.1.1"></eq><ci id="S4.SS4.p1.11.m11.1.1.2.cmml" xref="S4.SS4.p1.11.m11.1.1.2">𝑚</ci><cn type="integer" id="S4.SS4.p1.11.m11.1.1.3.cmml" xref="S4.SS4.p1.11.m11.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.11.m11.1c">m=50</annotation></semantics></math>.
The excellent scalability of FedProc is due to the introduction of prototypical contrastive learning. This improvement makes local objectives of each client consistent with the global optima, such that the performance of FedProc will not be affected as the number of clients increases.</p>
</div>
<figure id="S4.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>The top-1 test accuracy with varying number of clients (<math id="S4.T6.4.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.T6.4.m1.1b"><mi id="S4.T6.4.m1.1.1" xref="S4.T6.4.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.T6.4.m1.1c"><ci id="S4.T6.4.m1.1.1.cmml" xref="S4.T6.4.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.4.m1.1d">m</annotation></semantics></math>) and varying number of communication rounds (<math id="S4.T6.5.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.T6.5.m2.1b"><mi id="S4.T6.5.m2.1.1" xref="S4.T6.5.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.T6.5.m2.1c"><ci id="S4.T6.5.m2.1.1.cmml" xref="S4.T6.5.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.5.m2.1d">T</annotation></semantics></math>) on CIFAR-<math id="S4.T6.6.m3.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.T6.6.m3.1b"><mn id="S4.T6.6.m3.1.1" xref="S4.T6.6.m3.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.T6.6.m3.1c"><cn type="integer" id="S4.T6.6.m3.1.1.cmml" xref="S4.T6.6.m3.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.6.m3.1d">100</annotation></semantics></math>.</figcaption>
<table id="S4.T6.32" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T6.8.2" class="ltx_tr">
<th id="S4.T6.8.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T6.8.2.3.1" class="ltx_text">Method</span></th>
<td id="S4.T6.7.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2"><math id="S4.T6.7.1.1.m1.1" class="ltx_Math" alttext="m=50" display="inline"><semantics id="S4.T6.7.1.1.m1.1a"><mrow id="S4.T6.7.1.1.m1.1.1" xref="S4.T6.7.1.1.m1.1.1.cmml"><mi id="S4.T6.7.1.1.m1.1.1.2" xref="S4.T6.7.1.1.m1.1.1.2.cmml">m</mi><mo id="S4.T6.7.1.1.m1.1.1.1" xref="S4.T6.7.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T6.7.1.1.m1.1.1.3" xref="S4.T6.7.1.1.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.7.1.1.m1.1b"><apply id="S4.T6.7.1.1.m1.1.1.cmml" xref="S4.T6.7.1.1.m1.1.1"><eq id="S4.T6.7.1.1.m1.1.1.1.cmml" xref="S4.T6.7.1.1.m1.1.1.1"></eq><ci id="S4.T6.7.1.1.m1.1.1.2.cmml" xref="S4.T6.7.1.1.m1.1.1.2">𝑚</ci><cn type="integer" id="S4.T6.7.1.1.m1.1.1.3.cmml" xref="S4.T6.7.1.1.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.7.1.1.m1.1c">m=50</annotation></semantics></math></td>
<td id="S4.T6.8.2.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><math id="S4.T6.8.2.2.m1.1" class="ltx_Math" alttext="m=100" display="inline"><semantics id="S4.T6.8.2.2.m1.1a"><mrow id="S4.T6.8.2.2.m1.1.1" xref="S4.T6.8.2.2.m1.1.1.cmml"><mi id="S4.T6.8.2.2.m1.1.1.2" xref="S4.T6.8.2.2.m1.1.1.2.cmml">m</mi><mo id="S4.T6.8.2.2.m1.1.1.1" xref="S4.T6.8.2.2.m1.1.1.1.cmml">=</mo><mn id="S4.T6.8.2.2.m1.1.1.3" xref="S4.T6.8.2.2.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.8.2.2.m1.1b"><apply id="S4.T6.8.2.2.m1.1.1.cmml" xref="S4.T6.8.2.2.m1.1.1"><eq id="S4.T6.8.2.2.m1.1.1.1.cmml" xref="S4.T6.8.2.2.m1.1.1.1"></eq><ci id="S4.T6.8.2.2.m1.1.1.2.cmml" xref="S4.T6.8.2.2.m1.1.1.2">𝑚</ci><cn type="integer" id="S4.T6.8.2.2.m1.1.1.3.cmml" xref="S4.T6.8.2.2.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.8.2.2.m1.1c">m=100</annotation></semantics></math></td>
</tr>
<tr id="S4.T6.12.6" class="ltx_tr">
<td id="S4.T6.9.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S4.T6.9.3.1.m1.1" class="ltx_Math" alttext="T=100" display="inline"><semantics id="S4.T6.9.3.1.m1.1a"><mrow id="S4.T6.9.3.1.m1.1.1" xref="S4.T6.9.3.1.m1.1.1.cmml"><mi id="S4.T6.9.3.1.m1.1.1.2" xref="S4.T6.9.3.1.m1.1.1.2.cmml">T</mi><mo id="S4.T6.9.3.1.m1.1.1.1" xref="S4.T6.9.3.1.m1.1.1.1.cmml">=</mo><mn id="S4.T6.9.3.1.m1.1.1.3" xref="S4.T6.9.3.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.9.3.1.m1.1b"><apply id="S4.T6.9.3.1.m1.1.1.cmml" xref="S4.T6.9.3.1.m1.1.1"><eq id="S4.T6.9.3.1.m1.1.1.1.cmml" xref="S4.T6.9.3.1.m1.1.1.1"></eq><ci id="S4.T6.9.3.1.m1.1.1.2.cmml" xref="S4.T6.9.3.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T6.9.3.1.m1.1.1.3.cmml" xref="S4.T6.9.3.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.9.3.1.m1.1c">T=100</annotation></semantics></math></td>
<td id="S4.T6.10.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S4.T6.10.4.2.m1.1" class="ltx_Math" alttext="T=200" display="inline"><semantics id="S4.T6.10.4.2.m1.1a"><mrow id="S4.T6.10.4.2.m1.1.1" xref="S4.T6.10.4.2.m1.1.1.cmml"><mi id="S4.T6.10.4.2.m1.1.1.2" xref="S4.T6.10.4.2.m1.1.1.2.cmml">T</mi><mo id="S4.T6.10.4.2.m1.1.1.1" xref="S4.T6.10.4.2.m1.1.1.1.cmml">=</mo><mn id="S4.T6.10.4.2.m1.1.1.3" xref="S4.T6.10.4.2.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.10.4.2.m1.1b"><apply id="S4.T6.10.4.2.m1.1.1.cmml" xref="S4.T6.10.4.2.m1.1.1"><eq id="S4.T6.10.4.2.m1.1.1.1.cmml" xref="S4.T6.10.4.2.m1.1.1.1"></eq><ci id="S4.T6.10.4.2.m1.1.1.2.cmml" xref="S4.T6.10.4.2.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T6.10.4.2.m1.1.1.3.cmml" xref="S4.T6.10.4.2.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.10.4.2.m1.1c">T=200</annotation></semantics></math></td>
<td id="S4.T6.11.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S4.T6.11.5.3.m1.1" class="ltx_Math" alttext="T=250" display="inline"><semantics id="S4.T6.11.5.3.m1.1a"><mrow id="S4.T6.11.5.3.m1.1.1" xref="S4.T6.11.5.3.m1.1.1.cmml"><mi id="S4.T6.11.5.3.m1.1.1.2" xref="S4.T6.11.5.3.m1.1.1.2.cmml">T</mi><mo id="S4.T6.11.5.3.m1.1.1.1" xref="S4.T6.11.5.3.m1.1.1.1.cmml">=</mo><mn id="S4.T6.11.5.3.m1.1.1.3" xref="S4.T6.11.5.3.m1.1.1.3.cmml">250</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.11.5.3.m1.1b"><apply id="S4.T6.11.5.3.m1.1.1.cmml" xref="S4.T6.11.5.3.m1.1.1"><eq id="S4.T6.11.5.3.m1.1.1.1.cmml" xref="S4.T6.11.5.3.m1.1.1.1"></eq><ci id="S4.T6.11.5.3.m1.1.1.2.cmml" xref="S4.T6.11.5.3.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T6.11.5.3.m1.1.1.3.cmml" xref="S4.T6.11.5.3.m1.1.1.3">250</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.11.5.3.m1.1c">T=250</annotation></semantics></math></td>
<td id="S4.T6.12.6.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T6.12.6.4.m1.1" class="ltx_Math" alttext="T=500" display="inline"><semantics id="S4.T6.12.6.4.m1.1a"><mrow id="S4.T6.12.6.4.m1.1.1" xref="S4.T6.12.6.4.m1.1.1.cmml"><mi id="S4.T6.12.6.4.m1.1.1.2" xref="S4.T6.12.6.4.m1.1.1.2.cmml">T</mi><mo id="S4.T6.12.6.4.m1.1.1.1" xref="S4.T6.12.6.4.m1.1.1.1.cmml">=</mo><mn id="S4.T6.12.6.4.m1.1.1.3" xref="S4.T6.12.6.4.m1.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.12.6.4.m1.1b"><apply id="S4.T6.12.6.4.m1.1.1.cmml" xref="S4.T6.12.6.4.m1.1.1"><eq id="S4.T6.12.6.4.m1.1.1.1.cmml" xref="S4.T6.12.6.4.m1.1.1.1"></eq><ci id="S4.T6.12.6.4.m1.1.1.2.cmml" xref="S4.T6.12.6.4.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T6.12.6.4.m1.1.1.3.cmml" xref="S4.T6.12.6.4.m1.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.12.6.4.m1.1c">T=500</annotation></semantics></math></td>
</tr>
<tr id="S4.T6.16.10" class="ltx_tr">
<th id="S4.T6.16.10.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">FedAvg</th>
<td id="S4.T6.13.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S4.T6.13.7.1.m1.1" class="ltx_Math" alttext="51.9\%" display="inline"><semantics id="S4.T6.13.7.1.m1.1a"><mrow id="S4.T6.13.7.1.m1.1.1" xref="S4.T6.13.7.1.m1.1.1.cmml"><mn id="S4.T6.13.7.1.m1.1.1.2" xref="S4.T6.13.7.1.m1.1.1.2.cmml">51.9</mn><mo id="S4.T6.13.7.1.m1.1.1.1" xref="S4.T6.13.7.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.13.7.1.m1.1b"><apply id="S4.T6.13.7.1.m1.1.1.cmml" xref="S4.T6.13.7.1.m1.1.1"><csymbol cd="latexml" id="S4.T6.13.7.1.m1.1.1.1.cmml" xref="S4.T6.13.7.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.13.7.1.m1.1.1.2.cmml" xref="S4.T6.13.7.1.m1.1.1.2">51.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.13.7.1.m1.1c">51.9\%</annotation></semantics></math></td>
<td id="S4.T6.14.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S4.T6.14.8.2.m1.1" class="ltx_Math" alttext="56.4\%" display="inline"><semantics id="S4.T6.14.8.2.m1.1a"><mrow id="S4.T6.14.8.2.m1.1.1" xref="S4.T6.14.8.2.m1.1.1.cmml"><mn id="S4.T6.14.8.2.m1.1.1.2" xref="S4.T6.14.8.2.m1.1.1.2.cmml">56.4</mn><mo id="S4.T6.14.8.2.m1.1.1.1" xref="S4.T6.14.8.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.14.8.2.m1.1b"><apply id="S4.T6.14.8.2.m1.1.1.cmml" xref="S4.T6.14.8.2.m1.1.1"><csymbol cd="latexml" id="S4.T6.14.8.2.m1.1.1.1.cmml" xref="S4.T6.14.8.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.14.8.2.m1.1.1.2.cmml" xref="S4.T6.14.8.2.m1.1.1.2">56.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.14.8.2.m1.1c">56.4\%</annotation></semantics></math></td>
<td id="S4.T6.15.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S4.T6.15.9.3.m1.1" class="ltx_Math" alttext="51.0\%" display="inline"><semantics id="S4.T6.15.9.3.m1.1a"><mrow id="S4.T6.15.9.3.m1.1.1" xref="S4.T6.15.9.3.m1.1.1.cmml"><mn id="S4.T6.15.9.3.m1.1.1.2" xref="S4.T6.15.9.3.m1.1.1.2.cmml">51.0</mn><mo id="S4.T6.15.9.3.m1.1.1.1" xref="S4.T6.15.9.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.15.9.3.m1.1b"><apply id="S4.T6.15.9.3.m1.1.1.cmml" xref="S4.T6.15.9.3.m1.1.1"><csymbol cd="latexml" id="S4.T6.15.9.3.m1.1.1.1.cmml" xref="S4.T6.15.9.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.15.9.3.m1.1.1.2.cmml" xref="S4.T6.15.9.3.m1.1.1.2">51.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.15.9.3.m1.1c">51.0\%</annotation></semantics></math></td>
<td id="S4.T6.16.10.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T6.16.10.4.m1.1" class="ltx_Math" alttext="55.0\%" display="inline"><semantics id="S4.T6.16.10.4.m1.1a"><mrow id="S4.T6.16.10.4.m1.1.1" xref="S4.T6.16.10.4.m1.1.1.cmml"><mn id="S4.T6.16.10.4.m1.1.1.2" xref="S4.T6.16.10.4.m1.1.1.2.cmml">55.0</mn><mo id="S4.T6.16.10.4.m1.1.1.1" xref="S4.T6.16.10.4.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.16.10.4.m1.1b"><apply id="S4.T6.16.10.4.m1.1.1.cmml" xref="S4.T6.16.10.4.m1.1.1"><csymbol cd="latexml" id="S4.T6.16.10.4.m1.1.1.1.cmml" xref="S4.T6.16.10.4.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.16.10.4.m1.1.1.2.cmml" xref="S4.T6.16.10.4.m1.1.1.2">55.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.16.10.4.m1.1c">55.0\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T6.20.14" class="ltx_tr">
<th id="S4.T6.20.14.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">SCAFFOLD</th>
<td id="S4.T6.17.11.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T6.17.11.1.m1.1" class="ltx_Math" alttext="35.8\%" display="inline"><semantics id="S4.T6.17.11.1.m1.1a"><mrow id="S4.T6.17.11.1.m1.1.1" xref="S4.T6.17.11.1.m1.1.1.cmml"><mn id="S4.T6.17.11.1.m1.1.1.2" xref="S4.T6.17.11.1.m1.1.1.2.cmml">35.8</mn><mo id="S4.T6.17.11.1.m1.1.1.1" xref="S4.T6.17.11.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.17.11.1.m1.1b"><apply id="S4.T6.17.11.1.m1.1.1.cmml" xref="S4.T6.17.11.1.m1.1.1"><csymbol cd="latexml" id="S4.T6.17.11.1.m1.1.1.1.cmml" xref="S4.T6.17.11.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.17.11.1.m1.1.1.2.cmml" xref="S4.T6.17.11.1.m1.1.1.2">35.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.17.11.1.m1.1c">35.8\%</annotation></semantics></math></td>
<td id="S4.T6.18.12.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T6.18.12.2.m1.1" class="ltx_Math" alttext="44.9\%" display="inline"><semantics id="S4.T6.18.12.2.m1.1a"><mrow id="S4.T6.18.12.2.m1.1.1" xref="S4.T6.18.12.2.m1.1.1.cmml"><mn id="S4.T6.18.12.2.m1.1.1.2" xref="S4.T6.18.12.2.m1.1.1.2.cmml">44.9</mn><mo id="S4.T6.18.12.2.m1.1.1.1" xref="S4.T6.18.12.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.18.12.2.m1.1b"><apply id="S4.T6.18.12.2.m1.1.1.cmml" xref="S4.T6.18.12.2.m1.1.1"><csymbol cd="latexml" id="S4.T6.18.12.2.m1.1.1.1.cmml" xref="S4.T6.18.12.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.18.12.2.m1.1.1.2.cmml" xref="S4.T6.18.12.2.m1.1.1.2">44.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.18.12.2.m1.1c">44.9\%</annotation></semantics></math></td>
<td id="S4.T6.19.13.3" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T6.19.13.3.m1.1" class="ltx_Math" alttext="37.4\%" display="inline"><semantics id="S4.T6.19.13.3.m1.1a"><mrow id="S4.T6.19.13.3.m1.1.1" xref="S4.T6.19.13.3.m1.1.1.cmml"><mn id="S4.T6.19.13.3.m1.1.1.2" xref="S4.T6.19.13.3.m1.1.1.2.cmml">37.4</mn><mo id="S4.T6.19.13.3.m1.1.1.1" xref="S4.T6.19.13.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.19.13.3.m1.1b"><apply id="S4.T6.19.13.3.m1.1.1.cmml" xref="S4.T6.19.13.3.m1.1.1"><csymbol cd="latexml" id="S4.T6.19.13.3.m1.1.1.1.cmml" xref="S4.T6.19.13.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.19.13.3.m1.1.1.2.cmml" xref="S4.T6.19.13.3.m1.1.1.2">37.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.19.13.3.m1.1c">37.4\%</annotation></semantics></math></td>
<td id="S4.T6.20.14.4" class="ltx_td ltx_align_center"><math id="S4.T6.20.14.4.m1.1" class="ltx_Math" alttext="44.5\%" display="inline"><semantics id="S4.T6.20.14.4.m1.1a"><mrow id="S4.T6.20.14.4.m1.1.1" xref="S4.T6.20.14.4.m1.1.1.cmml"><mn id="S4.T6.20.14.4.m1.1.1.2" xref="S4.T6.20.14.4.m1.1.1.2.cmml">44.5</mn><mo id="S4.T6.20.14.4.m1.1.1.1" xref="S4.T6.20.14.4.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.20.14.4.m1.1b"><apply id="S4.T6.20.14.4.m1.1.1.cmml" xref="S4.T6.20.14.4.m1.1.1"><csymbol cd="latexml" id="S4.T6.20.14.4.m1.1.1.1.cmml" xref="S4.T6.20.14.4.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.20.14.4.m1.1.1.2.cmml" xref="S4.T6.20.14.4.m1.1.1.2">44.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.20.14.4.m1.1c">44.5\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T6.24.18" class="ltx_tr">
<th id="S4.T6.24.18.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedProx</th>
<td id="S4.T6.21.15.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T6.21.15.1.m1.1" class="ltx_Math" alttext="52.7\%" display="inline"><semantics id="S4.T6.21.15.1.m1.1a"><mrow id="S4.T6.21.15.1.m1.1.1" xref="S4.T6.21.15.1.m1.1.1.cmml"><mn id="S4.T6.21.15.1.m1.1.1.2" xref="S4.T6.21.15.1.m1.1.1.2.cmml">52.7</mn><mo id="S4.T6.21.15.1.m1.1.1.1" xref="S4.T6.21.15.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.21.15.1.m1.1b"><apply id="S4.T6.21.15.1.m1.1.1.cmml" xref="S4.T6.21.15.1.m1.1.1"><csymbol cd="latexml" id="S4.T6.21.15.1.m1.1.1.1.cmml" xref="S4.T6.21.15.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.21.15.1.m1.1.1.2.cmml" xref="S4.T6.21.15.1.m1.1.1.2">52.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.21.15.1.m1.1c">52.7\%</annotation></semantics></math></td>
<td id="S4.T6.22.16.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T6.22.16.2.m1.1" class="ltx_Math" alttext="56.6\%" display="inline"><semantics id="S4.T6.22.16.2.m1.1a"><mrow id="S4.T6.22.16.2.m1.1.1" xref="S4.T6.22.16.2.m1.1.1.cmml"><mn id="S4.T6.22.16.2.m1.1.1.2" xref="S4.T6.22.16.2.m1.1.1.2.cmml">56.6</mn><mo id="S4.T6.22.16.2.m1.1.1.1" xref="S4.T6.22.16.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.22.16.2.m1.1b"><apply id="S4.T6.22.16.2.m1.1.1.cmml" xref="S4.T6.22.16.2.m1.1.1"><csymbol cd="latexml" id="S4.T6.22.16.2.m1.1.1.1.cmml" xref="S4.T6.22.16.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.22.16.2.m1.1.1.2.cmml" xref="S4.T6.22.16.2.m1.1.1.2">56.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.22.16.2.m1.1c">56.6\%</annotation></semantics></math></td>
<td id="S4.T6.23.17.3" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T6.23.17.3.m1.1" class="ltx_Math" alttext="51.3\%" display="inline"><semantics id="S4.T6.23.17.3.m1.1a"><mrow id="S4.T6.23.17.3.m1.1.1" xref="S4.T6.23.17.3.m1.1.1.cmml"><mn id="S4.T6.23.17.3.m1.1.1.2" xref="S4.T6.23.17.3.m1.1.1.2.cmml">51.3</mn><mo id="S4.T6.23.17.3.m1.1.1.1" xref="S4.T6.23.17.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.23.17.3.m1.1b"><apply id="S4.T6.23.17.3.m1.1.1.cmml" xref="S4.T6.23.17.3.m1.1.1"><csymbol cd="latexml" id="S4.T6.23.17.3.m1.1.1.1.cmml" xref="S4.T6.23.17.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.23.17.3.m1.1.1.2.cmml" xref="S4.T6.23.17.3.m1.1.1.2">51.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.23.17.3.m1.1c">51.3\%</annotation></semantics></math></td>
<td id="S4.T6.24.18.4" class="ltx_td ltx_align_center"><math id="S4.T6.24.18.4.m1.1" class="ltx_Math" alttext="54.6\%" display="inline"><semantics id="S4.T6.24.18.4.m1.1a"><mrow id="S4.T6.24.18.4.m1.1.1" xref="S4.T6.24.18.4.m1.1.1.cmml"><mn id="S4.T6.24.18.4.m1.1.1.2" xref="S4.T6.24.18.4.m1.1.1.2.cmml">54.6</mn><mo id="S4.T6.24.18.4.m1.1.1.1" xref="S4.T6.24.18.4.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.24.18.4.m1.1b"><apply id="S4.T6.24.18.4.m1.1.1.cmml" xref="S4.T6.24.18.4.m1.1.1"><csymbol cd="latexml" id="S4.T6.24.18.4.m1.1.1.1.cmml" xref="S4.T6.24.18.4.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.24.18.4.m1.1.1.2.cmml" xref="S4.T6.24.18.4.m1.1.1.2">54.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.24.18.4.m1.1c">54.6\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T6.28.22" class="ltx_tr">
<th id="S4.T6.28.22.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">MOON</th>
<td id="S4.T6.25.19.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T6.25.19.1.m1.1" class="ltx_Math" alttext="58.2\%" display="inline"><semantics id="S4.T6.25.19.1.m1.1a"><mrow id="S4.T6.25.19.1.m1.1.1" xref="S4.T6.25.19.1.m1.1.1.cmml"><mn id="S4.T6.25.19.1.m1.1.1.2" xref="S4.T6.25.19.1.m1.1.1.2.cmml">58.2</mn><mo id="S4.T6.25.19.1.m1.1.1.1" xref="S4.T6.25.19.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.25.19.1.m1.1b"><apply id="S4.T6.25.19.1.m1.1.1.cmml" xref="S4.T6.25.19.1.m1.1.1"><csymbol cd="latexml" id="S4.T6.25.19.1.m1.1.1.1.cmml" xref="S4.T6.25.19.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.25.19.1.m1.1.1.2.cmml" xref="S4.T6.25.19.1.m1.1.1.2">58.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.25.19.1.m1.1c">58.2\%</annotation></semantics></math></td>
<td id="S4.T6.26.20.2" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T6.26.20.2.m1.1" class="ltx_Math" alttext="63.2\%" display="inline"><semantics id="S4.T6.26.20.2.m1.1a"><mrow id="S4.T6.26.20.2.m1.1.1" xref="S4.T6.26.20.2.m1.1.1.cmml"><mn id="S4.T6.26.20.2.m1.1.1.2" xref="S4.T6.26.20.2.m1.1.1.2.cmml">63.2</mn><mo id="S4.T6.26.20.2.m1.1.1.1" xref="S4.T6.26.20.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.26.20.2.m1.1b"><apply id="S4.T6.26.20.2.m1.1.1.cmml" xref="S4.T6.26.20.2.m1.1.1"><csymbol cd="latexml" id="S4.T6.26.20.2.m1.1.1.1.cmml" xref="S4.T6.26.20.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.26.20.2.m1.1.1.2.cmml" xref="S4.T6.26.20.2.m1.1.1.2">63.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.26.20.2.m1.1c">63.2\%</annotation></semantics></math></td>
<td id="S4.T6.27.21.3" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T6.27.21.3.m1.1" class="ltx_Math" alttext="56.9\%" display="inline"><semantics id="S4.T6.27.21.3.m1.1a"><mrow id="S4.T6.27.21.3.m1.1.1" xref="S4.T6.27.21.3.m1.1.1.cmml"><mn id="S4.T6.27.21.3.m1.1.1.2" xref="S4.T6.27.21.3.m1.1.1.2.cmml">56.9</mn><mo id="S4.T6.27.21.3.m1.1.1.1" xref="S4.T6.27.21.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.27.21.3.m1.1b"><apply id="S4.T6.27.21.3.m1.1.1.cmml" xref="S4.T6.27.21.3.m1.1.1"><csymbol cd="latexml" id="S4.T6.27.21.3.m1.1.1.1.cmml" xref="S4.T6.27.21.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.27.21.3.m1.1.1.2.cmml" xref="S4.T6.27.21.3.m1.1.1.2">56.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.27.21.3.m1.1c">56.9\%</annotation></semantics></math></td>
<td id="S4.T6.28.22.4" class="ltx_td ltx_align_center"><math id="S4.T6.28.22.4.m1.1" class="ltx_Math" alttext="61.8\%" display="inline"><semantics id="S4.T6.28.22.4.m1.1a"><mrow id="S4.T6.28.22.4.m1.1.1" xref="S4.T6.28.22.4.m1.1.1.cmml"><mn id="S4.T6.28.22.4.m1.1.1.2" xref="S4.T6.28.22.4.m1.1.1.2.cmml">61.8</mn><mo id="S4.T6.28.22.4.m1.1.1.1" xref="S4.T6.28.22.4.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.28.22.4.m1.1b"><apply id="S4.T6.28.22.4.m1.1.1.cmml" xref="S4.T6.28.22.4.m1.1.1"><csymbol cd="latexml" id="S4.T6.28.22.4.m1.1.1.1.cmml" xref="S4.T6.28.22.4.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.28.22.4.m1.1.1.2.cmml" xref="S4.T6.28.22.4.m1.1.1.2">61.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.28.22.4.m1.1c">61.8\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T6.32.26" class="ltx_tr">
<th id="S4.T6.32.26.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">FedProc</th>
<td id="S4.T6.29.23.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><math id="S4.T6.29.23.1.m1.1" class="ltx_Math" alttext="\mathbf{63.6\%}" display="inline"><semantics id="S4.T6.29.23.1.m1.1a"><mrow id="S4.T6.29.23.1.m1.1.1" xref="S4.T6.29.23.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T6.29.23.1.m1.1.1.2" xref="S4.T6.29.23.1.m1.1.1.2.cmml">63.6</mn><mo id="S4.T6.29.23.1.m1.1.1.1" xref="S4.T6.29.23.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.29.23.1.m1.1b"><apply id="S4.T6.29.23.1.m1.1.1.cmml" xref="S4.T6.29.23.1.m1.1.1"><csymbol cd="latexml" id="S4.T6.29.23.1.m1.1.1.1.cmml" xref="S4.T6.29.23.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.29.23.1.m1.1.1.2.cmml" xref="S4.T6.29.23.1.m1.1.1.2">63.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.29.23.1.m1.1c">\mathbf{63.6\%}</annotation></semantics></math></td>
<td id="S4.T6.30.24.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><math id="S4.T6.30.24.2.m1.1" class="ltx_Math" alttext="\mathbf{72.5\%}" display="inline"><semantics id="S4.T6.30.24.2.m1.1a"><mrow id="S4.T6.30.24.2.m1.1.1" xref="S4.T6.30.24.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T6.30.24.2.m1.1.1.2" xref="S4.T6.30.24.2.m1.1.1.2.cmml">72.5</mn><mo id="S4.T6.30.24.2.m1.1.1.1" xref="S4.T6.30.24.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.30.24.2.m1.1b"><apply id="S4.T6.30.24.2.m1.1.1.cmml" xref="S4.T6.30.24.2.m1.1.1"><csymbol cd="latexml" id="S4.T6.30.24.2.m1.1.1.1.cmml" xref="S4.T6.30.24.2.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.30.24.2.m1.1.1.2.cmml" xref="S4.T6.30.24.2.m1.1.1.2">72.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.30.24.2.m1.1c">\mathbf{72.5\%}</annotation></semantics></math></td>
<td id="S4.T6.31.25.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><math id="S4.T6.31.25.3.m1.1" class="ltx_Math" alttext="\mathbf{68.9\%}" display="inline"><semantics id="S4.T6.31.25.3.m1.1a"><mrow id="S4.T6.31.25.3.m1.1.1" xref="S4.T6.31.25.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T6.31.25.3.m1.1.1.2" xref="S4.T6.31.25.3.m1.1.1.2.cmml">68.9</mn><mo id="S4.T6.31.25.3.m1.1.1.1" xref="S4.T6.31.25.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.31.25.3.m1.1b"><apply id="S4.T6.31.25.3.m1.1.1.cmml" xref="S4.T6.31.25.3.m1.1.1"><csymbol cd="latexml" id="S4.T6.31.25.3.m1.1.1.1.cmml" xref="S4.T6.31.25.3.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.31.25.3.m1.1.1.2.cmml" xref="S4.T6.31.25.3.m1.1.1.2">68.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.31.25.3.m1.1c">\mathbf{68.9\%}</annotation></semantics></math></td>
<td id="S4.T6.32.26.4" class="ltx_td ltx_align_center ltx_border_bb"><math id="S4.T6.32.26.4.m1.1" class="ltx_Math" alttext="\mathbf{70.6\%}" display="inline"><semantics id="S4.T6.32.26.4.m1.1a"><mrow id="S4.T6.32.26.4.m1.1.1" xref="S4.T6.32.26.4.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T6.32.26.4.m1.1.1.2" xref="S4.T6.32.26.4.m1.1.1.2.cmml">70.6</mn><mo id="S4.T6.32.26.4.m1.1.1.1" xref="S4.T6.32.26.4.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.32.26.4.m1.1b"><apply id="S4.T6.32.26.4.m1.1.1.cmml" xref="S4.T6.32.26.4.m1.1.1"><csymbol cd="latexml" id="S4.T6.32.26.4.m1.1.1.1.cmml" xref="S4.T6.32.26.4.m1.1.1.1">percent</csymbol><cn type="float" id="S4.T6.32.26.4.m1.1.1.2.cmml" xref="S4.T6.32.26.4.m1.1.1.2">70.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.32.26.4.m1.1c">\mathbf{70.6\%}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This paper proposes prototypical contrastive federated learning (FedProc), a simple and effective federated learning framework to tackle non-IID data issue. FedProc introduces class prototypes as global knowledge to correct the local training in federated learning. Technically, we design a local network architecture and global prototypical contrastive loss to make local objectives consistent with the global optima, yielding a good classification performance of the global model.
Extensive experiments on multiple datasets demonstrate the advantage of FedProc on non-IID data.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aggarwal, Zhou, and Jain (2021)</span>
<span class="ltx_bibblock">
Aggarwal, D.; Zhou, J.; and Jain, A. K. 2021.

</span>
<span class="ltx_bibblock">FedFace: Collaborative Learning of Face Recognition Model.

</span>
<span class="ltx_bibblock">arXiv:2104.03008.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Asad et al. (2021)</span>
<span class="ltx_bibblock">
Asad, M.; Moustafa, A.; Ito, T.; and Aslam, M. 2021.

</span>
<span class="ltx_bibblock">Evaluating the communication efficiency in federated learning
algorithms.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">2021 IEEE 24th International Conference on Computer
Supported Cooperative Work in Design (CSCWD)</em>, 552–557. IEEE.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bouacida et al. (2021)</span>
<span class="ltx_bibblock">
Bouacida, N.; Hou, J.; Zang, H.; and Liu, X. 2021.

</span>
<span class="ltx_bibblock">Adaptive federated dropout: Improving communication efficiency and
generalization for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">IEEE INFOCOM 2021-IEEE Conference on Computer Communications
Workshops (INFOCOM WKSHPS)</em>, 1–6. IEEE.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Briggs, Fan, and Andras (2020)</span>
<span class="ltx_bibblock">
Briggs, C.; Fan, Z.; and Andras, P. 2020.

</span>
<span class="ltx_bibblock">Federated learning with hierarchical clustering of local updates to
improve training on non-IID data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">2020 International Joint Conference on Neural Networks
(IJCNN)</em>, 1–9. IEEE.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020)</span>
<span class="ltx_bibblock">
Chen, T.; Kornblith, S.; Norouzi, M.; and Hinton, G. 2020.

</span>
<span class="ltx_bibblock">A Simple Framework for Contrastive Learning of Visual
Representations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 1597–1607.
PMLR.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng, Kamani, and Mahdavi (2020)</span>
<span class="ltx_bibblock">
Deng, Y.; Kamani, M. M.; and Mahdavi, M. 2020.

</span>
<span class="ltx_bibblock">Distributionally Robust Federated Averaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fallah, Mokhtari, and Ozdaglar (2020)</span>
<span class="ltx_bibblock">
Fallah, A.; Mokhtari, A.; and Ozdaglar, A. 2020.

</span>
<span class="ltx_bibblock">Personalized federated learning with theoretical guarantees: A
model-agnostic meta-learning approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:
3557–3568.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hanzely et al. (2020)</span>
<span class="ltx_bibblock">
Hanzely, F.; Hanzely, S.; Horváth, S.; and Richtarik, P. 2020.

</span>
<span class="ltx_bibblock">Lower Bounds and Optimal Algorithms for Personalized Federated
Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2020)</span>
<span class="ltx_bibblock">
He, K.; Fan, H.; Wu, Y.; Xie, S.; and Girshick, R. 2020.

</span>
<span class="ltx_bibblock">Momentum contrast for unsupervised visual representation learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 9729–9738.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
He, K.; Zhang, X.; Ren, S.; and Sun, J. 2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, 770–778.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu, Qi, and Brown (2019)</span>
<span class="ltx_bibblock">
Hsu, T.-M. H.; Qi, H.; and Brown, M. 2019.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for
federated visual classification.

</span>
<span class="ltx_bibblock">arXiv:1909.06335.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2021a)</span>
<span class="ltx_bibblock">
Huang, B.; Li, X.; Song, Z.; and Yang, X. 2021a.

</span>
<span class="ltx_bibblock">FL-NTK: A Neural Tangent Kernel-based Framework for Federated
Learning Analysis.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 4423–4434.
PMLR.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2021b)</span>
<span class="ltx_bibblock">
Huang, Y.; Chu, L.; Zhou, Z.; Wang, L.; Liu, J.; Pei, J.; and Zhang, Y.
2021b.

</span>
<span class="ltx_bibblock">Personalized cross-silo federated learning on non-iid data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 35, 7865–7873.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al. (2020)</span>
<span class="ltx_bibblock">
Jin, Y.; Jiao, L.; Qian, Z.; Zhang, S.; Lu, S.; and Wang, X. 2020.

</span>
<span class="ltx_bibblock">Resource-efficient and convergence-preserving online participant
selection in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">2020 IEEE 40th International Conference on Distributed
Computing Systems (ICDCS)</em>, 606–616. IEEE.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2019)</span>
<span class="ltx_bibblock">
Kairouz, P.; McMahan, H. B.; Avent, B.; Bellet, A.; Bennis, M.; Bhagoji, A. N.;
Bonawitz, K.; Charles, Z.; Cormode, G.; Cummings, R.; et al. 2019.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock">arXiv:1912.04977.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaissis et al. (2020)</span>
<span class="ltx_bibblock">
Kaissis, G. A.; Makowski, M. R.; Rückert, D.; and Braren, R. F. 2020.

</span>
<span class="ltx_bibblock">Secure, privacy-preserving and federated machine learning in medical
imaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Nature Machine Intelligence</em>, 2(6): 305–311.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2019)</span>
<span class="ltx_bibblock">
Karimireddy, S. P.; Kale, S.; Mohri, M.; Reddi, S. J.; Stich, S. U.; and
Suresh, A. T. 2019.

</span>
<span class="ltx_bibblock">SCAFFOLD: Stochastic Controlled Averaging for On-Device Federated
Learning.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khosla et al. (2020)</span>
<span class="ltx_bibblock">
Khosla, P.; Teterwak, P.; Wang, C.; Sarna, A.; Tian, Y.; Isola, P.; Maschinot,
A.; Liu, C.; and Krishnan, D. 2020.

</span>
<span class="ltx_bibblock">Supervised Contrastive Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. (2021)</span>
<span class="ltx_bibblock">
Kumar, R.; Khan, A. A.; Kumar, J.; Zakria, A.; Golilarz, N. A.; Zhang, S.;
Ting, Y.; Zheng, C.; and Wang, W. 2021.

</span>
<span class="ltx_bibblock">Blockchain-federated-learning and deep learning models for covid-19
detection using ct imaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IEEE Sensors Journal</em>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020a)</span>
<span class="ltx_bibblock">
Li, J.; Zhou, P.; Xiong, C.; and Hoi, S. 2020a.

</span>
<span class="ltx_bibblock">Prototypical Contrastive Learning of Unsupervised Representations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li, He, and Song (2021)</span>
<span class="ltx_bibblock">
Li, Q.; He, B.; and Song, D. 2021.

</span>
<span class="ltx_bibblock">Model-Contrastive Federated Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 10713–10722.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020b)</span>
<span class="ltx_bibblock">
Li, T.; Sahu, A. K.; Zaheer, M.; Sanjabi, M.; Talwalkar, A.; and Smith, V.
2020b.

</span>
<span class="ltx_bibblock">Federated Optimization in Heterogeneous Networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, volume 2,
429–450.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2020)</span>
<span class="ltx_bibblock">
Liu, Y.; Huang, A.; Luo, Y.; Huang, H.; Liu, Y.; Chen, Y.; Feng, L.; Chen, T.;
Yu, H.; and Yang, Q. 2020.

</span>
<span class="ltx_bibblock">Fedvision: An online visual object detection platform powered by
federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 34, 13172–13179.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luping, Wei, and Bo (2019)</span>
<span class="ltx_bibblock">
Luping, W.; Wei, W.; and Bo, L. 2019.

</span>
<span class="ltx_bibblock">CMFL: Mitigating communication overhead for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">2019 IEEE 39th International Conference on Distributed
Computing Systems (ICDCS)</em>, 954–964. IEEE.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B.; Moore, E.; Ramage, D.; Hampson, S.; and y Arcas, B. A. 2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, 1273–1282. PMLR.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohri, Sivek, and Suresh (2019)</span>
<span class="ltx_bibblock">
Mohri, M.; Sivek, G.; and Suresh, A. T. 2019.

</span>
<span class="ltx_bibblock">Agnostic federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 4615–4625.
PMLR.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reisizadeh et al. (2020)</span>
<span class="ltx_bibblock">
Reisizadeh, A.; Farnia, F.; Pedarsani, R.; and Jadbabaie, A. 2020.

</span>
<span class="ltx_bibblock">Robust Federated Learning: The Case of Affine Distribution Shifts.

</span>
<span class="ltx_bibblock">In Larochelle, H.; Ranzato, M.; Hadsell, R.; Balcan, M. F.; and Lin,
H., eds., <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume 33, 21554–21565. Curran Associates, Inc.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al. (2019)</span>
<span class="ltx_bibblock">
Sattler, F.; Wiedemann, S.; Müller, K.-R.; and Samek, W. 2019.

</span>
<span class="ltx_bibblock">Robust and communication-efficient federated learning from non-iid
data.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning systems</em>,
31(9): 3400–3413.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Snell, Swersky, and Zemel (2017)</span>
<span class="ltx_bibblock">
Snell, J.; Swersky, K.; and Zemel, R. 2017.

</span>
<span class="ltx_bibblock">Prototypical networks for few-shot learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 31st International Conference on Neural
Information Processing Systems</em>, 4080–4090.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">T Dinh, Tran, and Nguyen (2020)</span>
<span class="ltx_bibblock">
T Dinh, C.; Tran, N.; and Nguyen, T. D. 2020.

</span>
<span class="ltx_bibblock">Personalized Federated Learning with Moreau Envelopes.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Truex et al. (2019)</span>
<span class="ltx_bibblock">
Truex, S.; Baracaldo, N.; Anwar, A.; Steinke, T.; Ludwig, H.; Zhang, R.; and
Zhou, Y. 2019.

</span>
<span class="ltx_bibblock">A hybrid approach to privacy-preserving federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 12th ACM Workshop on Artificial
Intelligence and Security</em>, 1–11.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van Berlo, Saeed, and Ozcelebi (2020)</span>
<span class="ltx_bibblock">
van Berlo, B.; Saeed, A.; and Ozcelebi, T. 2020.

</span>
<span class="ltx_bibblock">Towards federated unsupervised representation learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Third ACM International Workshop on Edge
Systems, Analytics and Networking</em>, 31–36.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van der Maaten and Hinton (2008)</span>
<span class="ltx_bibblock">
van der Maaten, L.; and Hinton, G. 2008.

</span>
<span class="ltx_bibblock">Visualizing Data using t-SNE.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Journal of Machine Learning Research</em>, 9: 2579–2605.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020a)</span>
<span class="ltx_bibblock">
Wang, H.; Yurochkin, M.; Sun, Y.; Papailiopoulos, D.; and Khazaeni, Y.
2020a.

</span>
<span class="ltx_bibblock">Federated Learning with Matched Averaging.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020b)</span>
<span class="ltx_bibblock">
Wang, J.; Liu, Q.; Liang, H.; Joshi, G.; and Poor, H. V. 2020b.

</span>
<span class="ltx_bibblock">Tackling the Objective Inconsistency Problem in Heterogeneous
Federated Optimization.

</span>
<span class="ltx_bibblock">In Larochelle, H.; Ranzato, M.; Hadsell, R.; Balcan, M. F.; and Lin,
H., eds., <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume 33, 7611–7623. Curran Associates, Inc.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Wang, P.; Han, K.; Wei, X.-S.; Zhang, L.; and Wang, L. 2021.

</span>
<span class="ltx_bibblock">Contrastive Learning based Hybrid Networks for Long-Tailed Image
Classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 943–952.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Wang, Z.; Song, M.; Zhang, Z.; Song, Y.; Wang, Q.; and Qi, H. 2019.

</span>
<span class="ltx_bibblock">Beyond inferring class representatives: User-level privacy leakage
from federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">IEEE INFOCOM 2019-IEEE Conference on Computer
Communications</em>, 2512–2520. IEEE.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yurochkin et al. (2019)</span>
<span class="ltx_bibblock">
Yurochkin, M.; Agarwal, M.; Ghosh, S.; Greenewald, K.; Hoang, N.; and Khazaeni,
Y. 2019.

</span>
<span class="ltx_bibblock">Bayesian nonparametric federated learning of neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 7252–7261.
PMLR.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2020)</span>
<span class="ltx_bibblock">
Zhang, F.; Kuang, K.; You, Z.; Shen, T.; Xiao, J.; Zhang, Y.; Wu, C.; Zhuang,
Y.; and Li, X. 2020.

</span>
<span class="ltx_bibblock">Federated unsupervised representation learning.

</span>
<span class="ltx_bibblock">arXiv:2010.08982.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2018)</span>
<span class="ltx_bibblock">
Zhao, Y.; Li, M.; Lai, L.; Suda, N.; Civin, D.; and Chandra, V.
2018.

</span>
<span class="ltx_bibblock">Federated Learning with Non-IID Data.

</span>
<span class="ltx_bibblock">arXiv:1806.00582.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2020)</span>
<span class="ltx_bibblock">
Zhou, B.; Cui, Q.; Wei, X.-S.; and Chen, Z.-M. 2020.

</span>
<span class="ltx_bibblock">Bbn: Bilateral-branch network with cumulative learning for
long-tailed visual recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 9719–9728.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2109.12272" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2109.12273" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2109.12273">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2109.12273" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2109.12274" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Mar 19 14:18:49 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
