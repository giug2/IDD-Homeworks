<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models</title>
<!--Generated on Wed Oct  2 17:37:48 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.01782v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S1" title="In Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2" title="In Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span><span class="ltx_text ltx_font_smallcaps">Open-RAG</span>: Enhanced Retrieval-Augmented Reasoning</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS1" title="In 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS2" title="In 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span><span class="ltx_text ltx_font_smallcaps">Open-RAG</span> Training</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS2.SSS1" title="In 2.2 Open-RAG Training ‣ 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.1 </span>Data Collection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS2.SSS2" title="In 2.2 Open-RAG Training ‣ 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.2 </span>Parameter-Efficient MoE Finetuning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS3" title="In 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Hybrid Approach for Adaptive Retrieval</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S3" title="In Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S3.SS1" title="In 3 Experiments ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Tasks and Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S3.SS2" title="In 3 Experiments ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Experimental settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S3.SS3" title="In 3 Experiments ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Baselines</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S4" title="In Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Results and Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S4.SS1" title="In 4 Results and Analysis ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Main Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S4.SS2" title="In 4 Results and Analysis ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Performance-Speed by Adaptive Retrieval</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S4.SS3" title="In 4 Results and Analysis ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Studies</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S5" title="In Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S6" title="In Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S7" title="In Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#A1" title="In Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Training Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#A1.SS1" title="In Appendix A Training Details ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Dataset Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#A2" title="In Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Inference Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#A2.SS1" title="In Appendix B Inference Details ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Inference Hyper-parameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#A2.SS2" title="In Appendix B Inference Details ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Instruction Format</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_smallcaps" id="id14.id1">Open-RAG</span>: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Shayekh Bin Islam<sup class="ltx_sup" id="id15.14.id1"><span class="ltx_text ltx_font_italic" id="id15.14.id1.1">,1,6,7</span></sup>, Md Asib Rahman<span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span><sup class="ltx_sup" id="id16.15.id2"><span class="ltx_text ltx_font_italic" id="id16.15.id2.1">,1</span></sup>, K S M Tozammel Hossain<sup class="ltx_sup" id="id17.16.id3"><span class="ltx_text ltx_font_italic" id="id17.16.id3.1">2</span></sup>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id13.13.10"> Enamul Hoque<sup class="ltx_sup" id="id13.13.10.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id13.13.10.1.1">3</span></sup>,  Shafiq Joty<sup class="ltx_sup" id="id13.13.10.2"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id13.13.10.2.1">4</span></sup>,  Md Rizwan Parvez<sup class="ltx_sup" id="id13.13.10.3"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id13.13.10.3.1">5</span></sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id13.13.10.4"><span class="ltx_text ltx_font_medium" id="id13.13.10.4.1">1</span></sup>Bangladesh University of Engineering and Technology, <sup class="ltx_sup" id="id13.13.10.5"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id13.13.10.5.1">2</span></sup>University of North Texas 
<br class="ltx_break"/><sup class="ltx_sup" id="id13.13.10.6"><span class="ltx_text ltx_font_medium" id="id13.13.10.6.1">3</span></sup>York University, Canada,
<sup class="ltx_sup" id="id13.13.10.7"><span class="ltx_text ltx_font_medium" id="id13.13.10.7.1">4</span></sup>Salesforce Research,
<sup class="ltx_sup" id="id13.13.10.8"><span class="ltx_text ltx_font_medium" id="id13.13.10.8.1">5</span></sup>Qatar Computing Research Institute (QCRI) 
<br class="ltx_break"/><sup class="ltx_sup" id="id13.13.10.9"><span class="ltx_text ltx_font_medium" id="id13.13.10.9.1">6</span></sup>Fatima Al-Fihri Predoctoral Fellowship,
<sup class="ltx_sup" id="id13.13.10.10"><span class="ltx_text ltx_font_medium" id="id13.13.10.10.1">7</span></sup>Cohere For AI Community 
<br class="ltx_break"/></span><span class="ltx_text ltx_font_typewriter" id="id18.17.id4">
shayekh.bin.islam@gmail.com,
mparvez@hbku.edu.qa </span><span class="ltx_text ltx_font_bold" id="id19.18.id5">
</span>
</span><span class="ltx_author_notes">  Equal contribution.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id20.id1">Retrieval-Augmented Generation (RAG) has been shown to enhance the factual accuracy of Large Language Models (LLMs), but existing methods often suffer from limited reasoning capabilities in effectively using the retrieved evidence, particularly when using open-source LLMs. To mitigate this gap, we introduce a novel framework, <span class="ltx_text ltx_font_smallcaps" id="id20.id1.1">Open-RAG</span>, designed to enhance reasoning capabilities in RAG with open-source LLMs. Our framework transforms an arbitrary dense LLM into a parameter-efficient sparse mixture of experts (MoE) model capable of handling complex reasoning tasks, including both single- and multi-hop queries. <span class="ltx_text ltx_font_smallcaps" id="id20.id1.2">Open-RAG</span> uniquely trains the model to navigate challenging distractors that appear relevant but are misleading.
As a result,
<span class="ltx_text ltx_font_smallcaps" id="id20.id1.3">Open-RAG</span> leverages latent learning, dynamically selecting relevant experts and integrating external knowledge effectively for more accurate and contextually relevant responses.
In addition,
we propose a hybrid adaptive retrieval method to determine retrieval necessity and balance the trade-off between performance gain and inference speed. Experimental results show that the Llama2-7B-based <span class="ltx_text ltx_font_smallcaps" id="id20.id1.4">Open-RAG</span> outperforms state-of-the-art LLMs and RAG models
such as
ChatGPT, Self-RAG, and Command R+
in various knowledge-intensive tasks.
We open-source our code and models at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openragmoe.github.io/" title="">https://openragmoe.github.io/</a></p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<div class="ltx_block ltx_align_bottom" id="p1.13">
<p class="ltx_p" id="p1.13.14"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="p1.13.14.1">Open-RAG<span class="ltx_text ltx_font_upright" id="p1.13.14.1.1">: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models</span></span></p>
<br class="ltx_break ltx_centering"/>
<p class="ltx_p ltx_align_center" id="p1.13.13" style="width:433.6pt;"><span class="ltx_text ltx_inline-block" id="p1.13.13.13" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p1.13.13.13.13">
<span class="ltx_tbody">
<span class="ltx_tr" id="p1.3.3.3.3.3">
<span class="ltx_td ltx_align_center" id="p1.3.3.3.3.3.3"><span class="ltx_text ltx_font_bold" id="p1.3.3.3.3.3.3.3">
Shayekh Bin Islam<span class="ltx_note ltx_role_thanks" id="p1.3.3.3.3.3.3.3.1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span>  Equal contribution.</span></span></span><sup class="ltx_sup" id="p1.3.3.3.3.3.3.3.2"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.3.3.3.3.3.3.3.2.1">,1,6,7</span></sup>, Md Asib Rahman<span class="ltx_note ltx_role_footnotemark" id="footnotex2"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex2.1.1.1">1</span></span></span></span></span><sup class="ltx_sup" id="p1.3.3.3.3.3.3.3.3"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.3.3.3.3.3.3.3.3.1">,1</span></sup>, K S M Tozammel Hossain<sup class="ltx_sup" id="p1.3.3.3.3.3.3.3.4"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.3.3.3.3.3.3.3.4.1">2</span></sup></span></span></span>
<span class="ltx_tr" id="p1.6.6.6.6.6">
<span class="ltx_td ltx_align_center" id="p1.6.6.6.6.6.3"><span class="ltx_text ltx_font_bold" id="p1.6.6.6.6.6.3.3"> Enamul Hoque<sup class="ltx_sup" id="p1.6.6.6.6.6.3.3.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.6.6.6.6.6.3.3.1.1">3</span></sup>,  Shafiq Joty<sup class="ltx_sup" id="p1.6.6.6.6.6.3.3.2"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.6.6.6.6.6.3.3.2.1">4</span></sup>,  Md Rizwan Parvez<sup class="ltx_sup" id="p1.6.6.6.6.6.3.3.3"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.6.6.6.6.6.3.3.3.1">5</span></sup></span></span></span>
<span class="ltx_tr" id="p1.8.8.8.8.8">
<span class="ltx_td ltx_align_center" id="p1.8.8.8.8.8.2"><sup class="ltx_sup" id="p1.8.8.8.8.8.2.1">1</sup>Bangladesh University of Engineering and Technology, <sup class="ltx_sup" id="p1.8.8.8.8.8.2.2"><span class="ltx_text ltx_font_italic" id="p1.8.8.8.8.8.2.2.1">2</span></sup>University of North Texas</span></span>
<span class="ltx_tr" id="p1.11.11.11.11.11">
<span class="ltx_td ltx_align_center" id="p1.11.11.11.11.11.3"><sup class="ltx_sup" id="p1.11.11.11.11.11.3.1">3</sup>York University, Canada,
<sup class="ltx_sup" id="p1.11.11.11.11.11.3.2">4</sup>Salesforce Research,
<sup class="ltx_sup" id="p1.11.11.11.11.11.3.3">5</sup>Qatar Computing Research Institute (QCRI)</span></span>
<span class="ltx_tr" id="p1.13.13.13.13.13">
<span class="ltx_td ltx_align_center" id="p1.13.13.13.13.13.2"><sup class="ltx_sup" id="p1.13.13.13.13.13.2.1">6</sup>Fatima Al-Fihri Predoctoral Fellowship,
<sup class="ltx_sup" id="p1.13.13.13.13.13.2.2">7</sup>Cohere For AI Community</span></span>
<span class="ltx_tr" id="p1.13.13.13.13.14.1">
<span class="ltx_td ltx_align_center" id="p1.13.13.13.13.14.1.1"><span class="ltx_text ltx_font_typewriter" id="p1.13.13.13.13.14.1.1.1">
shayekh.bin.islam@gmail.com,
mparvez@hbku.edu.qa</span></span></span>
</span>
</span></span></p>
<br class="ltx_break ltx_centering"/>
</div>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The rapid advancement of Large Language Models (LLMs) has significantly improved various NLP tasks <cite class="ltx_cite ltx_citemacro_cite">Beeching et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib3" title="">2023</a>)</cite>. However, these models often suffer from factual inaccuracies <cite class="ltx_cite ltx_citemacro_cite">Min et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib27" title="">2023a</a>); Mallen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib25" title="">2022</a>)</cite>. Retrieval-Augmented Generation (RAG) has emerged as a promising approach to integrate LLMs with external knowledge, thereby improving generation accuracy <cite class="ltx_cite ltx_citemacro_cite">Asai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib1" title="">2023</a>); Lewis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib20" title="">2020</a>)</cite>. Despite this, existing RAG methods demonstrate limited reasoning capabilities, particularly when employing open-source LLMs and addressing high-complexity queries such as multi-hop retrieval augmented tasks <cite class="ltx_cite ltx_citemacro_cite">Jeong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib13" title="">2024b</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib51" title="">2024b</a>)</cite>. Thus, building an effective RAG model using open-source LLMs remains an open challenge. To address this gap, we present <span class="ltx_text ltx_font_smallcaps" id="S1.p1.1.1">Open-RAG</span>, a novel framework aimed at improving reasoning capabilities in RAG with open-source LLMs.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Reasoning over retrieved documents is particularly difficult. In general, retrievers are imperfect and can return noisy passages <cite class="ltx_cite ltx_citemacro_cite">Shi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib35" title="">2023</a>)</cite>. The generated outputs can also be inconsistent with retrieved passages <cite class="ltx_cite ltx_citemacro_cite">Gao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib9" title="">2023a</a>)</cite> or can even override the LLM’s accurate parametric knowledge <cite class="ltx_cite ltx_citemacro_cite">Parvez (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib31" title="">2024</a>)</cite>. Approaches like re-ranking or filtering retrieved documents <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib44" title="">2023</a>; Nogueira and Cho, <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib29" title="">2020</a>; Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib41" title="">2018</a>)</cite> and active retrieval methods (i.e., retrieve only when needed) <cite class="ltx_cite ltx_citemacro_citep">(Mallen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib26" title="">2023</a>; Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib14" title="">2023a</a>; Trivedi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib39" title="">2023a</a>)</cite> have shown promising success in tackling these, but they require substantial human annotations, can filter out useful information, often perform sequential and repetitive calls (hence slow), and can still suffer from distracting content, even in relevant passages <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib42" title="">2023</a>)</cite>.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="397" id="S1.F1.1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Inference pipeline in our framework, <span class="ltx_text ltx_font_smallcaps" id="S1.F1.3.1">Open-RAG</span>. It learns to generate retrieval/no_retrieval tokens, contrasts between relevant and irrelevant contexts, and categorizes answers as partially, fully, or not supported. Then at inference,
given a (multi-hop) user query,
we first enforce the model to generate an answer with conditional to no_retrieval as input, and based on the model confidence we dynamically determine if retrieval is needed.
</figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To address and control these behaviors such as retrieval frequency of the RAG model and guide the generation to be contextually consistent, Self-RAG and its variants <cite class="ltx_cite ltx_citemacro_cite">Asai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib2" title="">2024</a>); Yan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib45" title="">2024</a>); Jeong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib12" title="">2024a</a>)</cite> adopt a self-reflection-based method. During training, these models learn to generate both task output and intermittent special reflection or critic tokens (e.g., <em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">is_supported</em>, <em class="ltx_emph ltx_font_italic" id="S1.p3.1.2">is_relevant</em>, etc.), leveraging knowledge distillation from proprietary models like GPT-4. At inference, these generated tokens determine the usability of each candidate output. While these methods enable the model to effectively rank candidate outputs from different retrievals and partially improve grounded
generation, they struggle with navigating irrelevant or misleading information, especially when dealing with complex queries such as multi-hop retrieval tasks. This limitation arises since the models are not explicitly trained to contrast harder distractor passages and adhere to the facts from the retrievals.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To confront the challenge, our framework <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.1">Open-RAG</span> transforms an arbitrary dense LLM into a parameter-efficient (PEFT) sparse mixture of experts (MoE) model <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib43" title="">2024</a>); Komatsuzaki et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib19" title="">2022</a>)</cite> capable not only of self-reflection but also of handling complex reasoning tasks, including both single- and multi-hop queries. It uniquely trains the model to navigate challenging distractors that appear relevant but are misleading, while expanding the MoE only in the adapters, maintaining the model’s scale.
By combining constructive learning, architectural transformation, and reflection-based generation, <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.2">Open-RAG</span> leverages latent learning, dynamically selects relevant experts, and integrates external knowledge effectively for more accurate and contextually supported response generation and estimates of their usefulness.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">State-of-the-art (SoTA) open-LLM-based RAG models use external models to determine if retrieval is needed; e.g., <cite class="ltx_cite ltx_citemacro_citet">Asai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib2" title="">2024</a>)</cite> use GPT-4 distillation and <cite class="ltx_cite ltx_citemacro_citet">Jeong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib13" title="">2024b</a>)</cite> use a finetuned FlanT5-XXL for Llama2. However, since LLMs possess different parametric knowledge, it may not be effective to rely on another LLM to fully determine the retrieval necessity. To determine retrieval on-demand and balance performance and speed, we propose a hybrid adaptive retrieval method with two threshold alternatives based on model confidence. We train our model to generate <em class="ltx_emph ltx_font_italic" id="S1.p5.1.1">retrieval/no_retrieval</em> reflection tokens and measure the
confidence
of outputs conditioned on enforced <em class="ltx_emph ltx_font_italic" id="S1.p5.1.2">no_retrieval</em> during inference. If retrieval is needed, following <cite class="ltx_cite ltx_citemacro_citet">Asai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib2" title="">2024</a>)</cite>, we process all retrieved passages in parallel and rank them using the weighted linear sum of reflection token probabilities. Differently from other multi-step active or adaptive retrieval methods <cite class="ltx_cite ltx_citemacro_cite">Jeong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib13" title="">2024b</a>); Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib14" title="">2023a</a>); Trivedi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib39" title="">2023a</a>)</cite>, this eliminates the need for iterative generations.</p>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="223" id="S1.F2.1.g1" src="x2.png" width="813"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>
<span class="ltx_text ltx_font_smallcaps" id="S1.F2.8.1">Open-RAG</span> training data preparation involves generating four variations of new training instances from each original pair (<math alttext="q" class="ltx_Math" display="inline" id="S1.F2.4.m1.1"><semantics id="S1.F2.4.m1.1b"><mi id="S1.F2.4.m1.1.1" xref="S1.F2.4.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S1.F2.4.m1.1c"><ci id="S1.F2.4.m1.1.1.cmml" xref="S1.F2.4.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.4.m1.1d">q</annotation><annotation encoding="application/x-llamapun" id="S1.F2.4.m1.1e">italic_q</annotation></semantics></math>, <math alttext="y" class="ltx_Math" display="inline" id="S1.F2.5.m2.1"><semantics id="S1.F2.5.m2.1b"><mi id="S1.F2.5.m2.1.1" xref="S1.F2.5.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S1.F2.5.m2.1c"><ci id="S1.F2.5.m2.1.1.cmml" xref="S1.F2.5.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.5.m2.1d">y</annotation><annotation encoding="application/x-llamapun" id="S1.F2.5.m2.1e">italic_y</annotation></semantics></math>), each incorporating different <em class="ltx_emph ltx_font_italic" id="S1.F2.9.2">reflection</em> tokens using ground truth/LLM critic and retrieved passages. Our approach enables an LLM not only to reflect on generation quality but also to contrast distractors.</figcaption>
</figure>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In experiments, we evaluate our framework on a wide range of single/multi-hop short/long-form knowledge-intensive reasoning tasks, including PopQA, TriviaQA, PubQA, Bio, ALCE-ASQA, HotpotQA, MuSiQue, and 2WikiMultiHopQA benchmarks. Results show that our <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.1">Open-RAG</span> significantly improves the overall factual accuracy and reasoning capabilities w.r.t the prior open-source RAG models, often matching or outperforming state-of-the-art proprietary LLMs and their RAG models. In multiple tasks, <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.2">Open-RAG</span>, based on Llama2-7B, sets new benchmarks, surpassing ChatGPT-RAG, Self-RAG, RAG 2.0, and 104B RAG-Command R+. Through detailed ablations, examples, and analysis, we provide further insights into the effectiveness of <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.3">Open-RAG</span>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Open-RAG</span>: Enhanced Retrieval-Augmented Reasoning</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_smallcaps" id="S2.p1.1.1">Open-RAG</span> transforms an arbitrary dense LLM into a parameter-efficient sparse MoE model capable not only of self-reflection but also of handling complex reasoning tasks.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">Additionally, we devise an adaptive hybrid retrieval schema to balance the retrieval frequency and speed trade-off.
Below we first present the overview of <span class="ltx_text ltx_font_smallcaps" id="S2.p2.1.1">Open-RAG</span> and then discuss
the training, including dataset and fine-tuning,
and hybrid adaptive inference.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Overview</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.6">We define <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p1.6.1">Open-RAG</span> LLM as a model <math alttext="\mathcal{M}_{G}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><msub id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">ℳ</mi><mi id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">ℳ</ci><ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathcal{M}_{G}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math>  that, given an input query <math alttext="q" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_q</annotation></semantics></math><span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>With additional contexts if provided</span></span></span>, generates an output sequence of <math alttext="m" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_m</annotation></semantics></math> tokens <math alttext="o=[o_{1},o_{2},...,o_{m}]" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.4"><semantics id="S2.SS1.p1.4.m4.4a"><mrow id="S2.SS1.p1.4.m4.4.4" xref="S2.SS1.p1.4.m4.4.4.cmml"><mi id="S2.SS1.p1.4.m4.4.4.5" xref="S2.SS1.p1.4.m4.4.4.5.cmml">o</mi><mo id="S2.SS1.p1.4.m4.4.4.4" xref="S2.SS1.p1.4.m4.4.4.4.cmml">=</mo><mrow id="S2.SS1.p1.4.m4.4.4.3.3" xref="S2.SS1.p1.4.m4.4.4.3.4.cmml"><mo id="S2.SS1.p1.4.m4.4.4.3.3.4" stretchy="false" xref="S2.SS1.p1.4.m4.4.4.3.4.cmml">[</mo><msub id="S2.SS1.p1.4.m4.2.2.1.1.1" xref="S2.SS1.p1.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.4.m4.2.2.1.1.1.2" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml">o</mi><mn id="S2.SS1.p1.4.m4.2.2.1.1.1.3" xref="S2.SS1.p1.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.4.m4.4.4.3.3.5" xref="S2.SS1.p1.4.m4.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.4.m4.3.3.2.2.2" xref="S2.SS1.p1.4.m4.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.4.m4.3.3.2.2.2.2" xref="S2.SS1.p1.4.m4.3.3.2.2.2.2.cmml">o</mi><mn id="S2.SS1.p1.4.m4.3.3.2.2.2.3" xref="S2.SS1.p1.4.m4.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.4.m4.4.4.3.3.6" xref="S2.SS1.p1.4.m4.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p1.4.m4.1.1" mathvariant="normal" xref="S2.SS1.p1.4.m4.1.1.cmml">…</mi><mo id="S2.SS1.p1.4.m4.4.4.3.3.7" xref="S2.SS1.p1.4.m4.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.4.m4.4.4.3.3.3" xref="S2.SS1.p1.4.m4.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.4.m4.4.4.3.3.3.2" xref="S2.SS1.p1.4.m4.4.4.3.3.3.2.cmml">o</mi><mi id="S2.SS1.p1.4.m4.4.4.3.3.3.3" xref="S2.SS1.p1.4.m4.4.4.3.3.3.3.cmml">m</mi></msub><mo id="S2.SS1.p1.4.m4.4.4.3.3.8" stretchy="false" xref="S2.SS1.p1.4.m4.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.4b"><apply id="S2.SS1.p1.4.m4.4.4.cmml" xref="S2.SS1.p1.4.m4.4.4"><eq id="S2.SS1.p1.4.m4.4.4.4.cmml" xref="S2.SS1.p1.4.m4.4.4.4"></eq><ci id="S2.SS1.p1.4.m4.4.4.5.cmml" xref="S2.SS1.p1.4.m4.4.4.5">𝑜</ci><list id="S2.SS1.p1.4.m4.4.4.3.4.cmml" xref="S2.SS1.p1.4.m4.4.4.3.3"><apply id="S2.SS1.p1.4.m4.2.2.1.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2">𝑜</ci><cn id="S2.SS1.p1.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.4.m4.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.4.m4.3.3.2.2.2.cmml" xref="S2.SS1.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.4.m4.3.3.2.2.2.2">𝑜</ci><cn id="S2.SS1.p1.4.m4.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.4.m4.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">…</ci><apply id="S2.SS1.p1.4.m4.4.4.3.3.3.cmml" xref="S2.SS1.p1.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.4.m4.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.4.m4.4.4.3.3.3.2">𝑜</ci><ci id="S2.SS1.p1.4.m4.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.4.m4.4.4.3.3.3.3">𝑚</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.4c">o=[o_{1},o_{2},...,o_{m}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.4d">italic_o = [ italic_o start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_o start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ]</annotation></semantics></math>. To control model behavior and generate more context-supported responses, we adopt the reflection-based generation from Self-RAG <cite class="ltx_cite ltx_citemacro_cite">Asai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib2" title="">2024</a>)</cite> and augment output vocabularies with four types of special <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.6.2">reflection</em> tokens: <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.6.3">Retrieval</em>, <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.6.4">Relevance</em>, <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.6.5">Grounding</em> and <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.6.6">Utility</em>. During training, given <math alttext="q" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_q</annotation></semantics></math>, the model learns to first generate the <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.6.7">Retrieval</em> tokens (<span class="ltx_text ltx_font_typewriter" id="S2.SS1.p1.6.8">[RT]/[NoRT]</span>) that indicate whether retrieval is necessary to answer <math alttext="q" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_q</annotation></semantics></math>.<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>For long-form generation, we also use the <span class="ltx_text ltx_font_typewriter" id="footnote2.1">[Continue]</span> token, which indicates that the model can continue to use information from the previous segment.</span></span></span>
During inference, we employ a hybrid adaptive retrieval schema, leveraging both the <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.6.9">Retrieval</em> tokens and model confidence.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.23">If no retrieval is needed, <math alttext="\mathcal{M}_{G}" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><msub id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml">ℳ</mi><mi id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2">ℳ</ci><ci id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\mathcal{M}_{G}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math>  generates the response using only the parametric knowledge of the LLM (i.e., return <math alttext="o" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mi id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">o</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_o</annotation></semantics></math> as <math alttext="y_{pred}" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><msub id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml"><mi id="S2.SS1.p2.3.m3.1.1.2" xref="S2.SS1.p2.3.m3.1.1.2.cmml">y</mi><mrow id="S2.SS1.p2.3.m3.1.1.3" xref="S2.SS1.p2.3.m3.1.1.3.cmml"><mi id="S2.SS1.p2.3.m3.1.1.3.2" xref="S2.SS1.p2.3.m3.1.1.3.2.cmml">p</mi><mo id="S2.SS1.p2.3.m3.1.1.3.1" xref="S2.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.3.m3.1.1.3.3" xref="S2.SS1.p2.3.m3.1.1.3.3.cmml">r</mi><mo id="S2.SS1.p2.3.m3.1.1.3.1a" xref="S2.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.3.m3.1.1.3.4" xref="S2.SS1.p2.3.m3.1.1.3.4.cmml">e</mi><mo id="S2.SS1.p2.3.m3.1.1.3.1b" xref="S2.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.3.m3.1.1.3.5" xref="S2.SS1.p2.3.m3.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.2">𝑦</ci><apply id="S2.SS1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3"><times id="S2.SS1.p2.3.m3.1.1.3.1.cmml" xref="S2.SS1.p2.3.m3.1.1.3.1"></times><ci id="S2.SS1.p2.3.m3.1.1.3.2.cmml" xref="S2.SS1.p2.3.m3.1.1.3.2">𝑝</ci><ci id="S2.SS1.p2.3.m3.1.1.3.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3.3">𝑟</ci><ci id="S2.SS1.p2.3.m3.1.1.3.4.cmml" xref="S2.SS1.p2.3.m3.1.1.3.4">𝑒</ci><ci id="S2.SS1.p2.3.m3.1.1.3.5.cmml" xref="S2.SS1.p2.3.m3.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">y_{pred}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT</annotation></semantics></math>). If retrieval is needed, for both single- or multiple-hop from an external knowledge source <math alttext="D=\{d_{i}\}_{i=1}^{N_{d}}" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mrow id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">D</mi><mo id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">=</mo><msubsup id="S2.SS1.p2.4.m4.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.cmml"><mrow id="S2.SS1.p2.4.m4.1.1.1.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.cmml"><mo id="S2.SS1.p2.4.m4.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.2" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.2.cmml">d</mi><mi id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.3" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p2.4.m4.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p2.4.m4.1.1.1.1.3" xref="S2.SS1.p2.4.m4.1.1.1.1.3.cmml"><mi id="S2.SS1.p2.4.m4.1.1.1.1.3.2" xref="S2.SS1.p2.4.m4.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p2.4.m4.1.1.1.1.3.1" xref="S2.SS1.p2.4.m4.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p2.4.m4.1.1.1.1.3.3" xref="S2.SS1.p2.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S2.SS1.p2.4.m4.1.1.1.3" xref="S2.SS1.p2.4.m4.1.1.1.3.cmml"><mi id="S2.SS1.p2.4.m4.1.1.1.3.2" xref="S2.SS1.p2.4.m4.1.1.1.3.2.cmml">N</mi><mi id="S2.SS1.p2.4.m4.1.1.1.3.3" xref="S2.SS1.p2.4.m4.1.1.1.3.3.cmml">d</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><eq id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2"></eq><ci id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3">𝐷</ci><apply id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1">superscript</csymbol><apply id="S2.SS1.p2.4.m4.1.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1">subscript</csymbol><set id="S2.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1"><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.2">𝑑</ci><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.SS1.p2.4.m4.1.1.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.3"><eq id="S2.SS1.p2.4.m4.1.1.1.1.3.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.3.1"></eq><ci id="S2.SS1.p2.4.m4.1.1.1.1.3.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.3.2">𝑖</ci><cn id="S2.SS1.p2.4.m4.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p2.4.m4.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p2.4.m4.1.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.3.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.1.3.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.3.2">𝑁</ci><ci id="S2.SS1.p2.4.m4.1.1.1.3.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">D=\{d_{i}\}_{i=1}^{N_{d}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_D = { italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, we use a user-defined frozen retriever <math alttext="R" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><mi id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">R</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">italic_R</annotation></semantics></math> to retrieve the top-<math alttext="k" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m6.1"><semantics id="S2.SS1.p2.6.m6.1a"><mi id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.1b"><ci id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m6.1d">italic_k</annotation></semantics></math> documents <math alttext="S=\{s_{t}\}_{t=1}^{k}" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m7.1"><semantics id="S2.SS1.p2.7.m7.1a"><mrow id="S2.SS1.p2.7.m7.1.1" xref="S2.SS1.p2.7.m7.1.1.cmml"><mi id="S2.SS1.p2.7.m7.1.1.3" xref="S2.SS1.p2.7.m7.1.1.3.cmml">S</mi><mo id="S2.SS1.p2.7.m7.1.1.2" xref="S2.SS1.p2.7.m7.1.1.2.cmml">=</mo><msubsup id="S2.SS1.p2.7.m7.1.1.1" xref="S2.SS1.p2.7.m7.1.1.1.cmml"><mrow id="S2.SS1.p2.7.m7.1.1.1.1.1.1" xref="S2.SS1.p2.7.m7.1.1.1.1.1.2.cmml"><mo id="S2.SS1.p2.7.m7.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.7.m7.1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS1.p2.7.m7.1.1.1.1.1.1.1" xref="S2.SS1.p2.7.m7.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.7.m7.1.1.1.1.1.1.1.2" xref="S2.SS1.p2.7.m7.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.SS1.p2.7.m7.1.1.1.1.1.1.1.3" xref="S2.SS1.p2.7.m7.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS1.p2.7.m7.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.7.m7.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p2.7.m7.1.1.1.1.3" xref="S2.SS1.p2.7.m7.1.1.1.1.3.cmml"><mi id="S2.SS1.p2.7.m7.1.1.1.1.3.2" xref="S2.SS1.p2.7.m7.1.1.1.1.3.2.cmml">t</mi><mo id="S2.SS1.p2.7.m7.1.1.1.1.3.1" xref="S2.SS1.p2.7.m7.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p2.7.m7.1.1.1.1.3.3" xref="S2.SS1.p2.7.m7.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p2.7.m7.1.1.1.3" xref="S2.SS1.p2.7.m7.1.1.1.3.cmml">k</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.1b"><apply id="S2.SS1.p2.7.m7.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1"><eq id="S2.SS1.p2.7.m7.1.1.2.cmml" xref="S2.SS1.p2.7.m7.1.1.2"></eq><ci id="S2.SS1.p2.7.m7.1.1.3.cmml" xref="S2.SS1.p2.7.m7.1.1.3">𝑆</ci><apply id="S2.SS1.p2.7.m7.1.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m7.1.1.1.2.cmml" xref="S2.SS1.p2.7.m7.1.1.1">superscript</csymbol><apply id="S2.SS1.p2.7.m7.1.1.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m7.1.1.1.1.2.cmml" xref="S2.SS1.p2.7.m7.1.1.1">subscript</csymbol><set id="S2.SS1.p2.7.m7.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.7.m7.1.1.1.1.1.1"><apply id="S2.SS1.p2.7.m7.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m7.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.7.m7.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.7.m7.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.SS1.p2.7.m7.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.7.m7.1.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S2.SS1.p2.7.m7.1.1.1.1.3.cmml" xref="S2.SS1.p2.7.m7.1.1.1.1.3"><eq id="S2.SS1.p2.7.m7.1.1.1.1.3.1.cmml" xref="S2.SS1.p2.7.m7.1.1.1.1.3.1"></eq><ci id="S2.SS1.p2.7.m7.1.1.1.1.3.2.cmml" xref="S2.SS1.p2.7.m7.1.1.1.1.3.2">𝑡</ci><cn id="S2.SS1.p2.7.m7.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p2.7.m7.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS1.p2.7.m7.1.1.1.3.cmml" xref="S2.SS1.p2.7.m7.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.1c">S=\{s_{t}\}_{t=1}^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m7.1d">italic_S = { italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>, where each <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.8.m8.1"><semantics id="S2.SS1.p2.8.m8.1a"><msub id="S2.SS1.p2.8.m8.1.1" xref="S2.SS1.p2.8.m8.1.1.cmml"><mi id="S2.SS1.p2.8.m8.1.1.2" xref="S2.SS1.p2.8.m8.1.1.2.cmml">s</mi><mi id="S2.SS1.p2.8.m8.1.1.3" xref="S2.SS1.p2.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m8.1b"><apply id="S2.SS1.p2.8.m8.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m8.1.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S2.SS1.p2.8.m8.1.1.2.cmml" xref="S2.SS1.p2.8.m8.1.1.2">𝑠</ci><ci id="S2.SS1.p2.8.m8.1.1.3.cmml" xref="S2.SS1.p2.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m8.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.8.m8.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> consists of <math alttext="\{r_{j}\}_{j=1}^{N_{H}}" class="ltx_Math" display="inline" id="S2.SS1.p2.9.m9.1"><semantics id="S2.SS1.p2.9.m9.1a"><msubsup id="S2.SS1.p2.9.m9.1.1" xref="S2.SS1.p2.9.m9.1.1.cmml"><mrow id="S2.SS1.p2.9.m9.1.1.1.1.1" xref="S2.SS1.p2.9.m9.1.1.1.1.2.cmml"><mo id="S2.SS1.p2.9.m9.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.9.m9.1.1.1.1.2.cmml">{</mo><msub id="S2.SS1.p2.9.m9.1.1.1.1.1.1" xref="S2.SS1.p2.9.m9.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.9.m9.1.1.1.1.1.1.2" xref="S2.SS1.p2.9.m9.1.1.1.1.1.1.2.cmml">r</mi><mi id="S2.SS1.p2.9.m9.1.1.1.1.1.1.3" xref="S2.SS1.p2.9.m9.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S2.SS1.p2.9.m9.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.9.m9.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p2.9.m9.1.1.1.3" xref="S2.SS1.p2.9.m9.1.1.1.3.cmml"><mi id="S2.SS1.p2.9.m9.1.1.1.3.2" xref="S2.SS1.p2.9.m9.1.1.1.3.2.cmml">j</mi><mo id="S2.SS1.p2.9.m9.1.1.1.3.1" xref="S2.SS1.p2.9.m9.1.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p2.9.m9.1.1.1.3.3" xref="S2.SS1.p2.9.m9.1.1.1.3.3.cmml">1</mn></mrow><msub id="S2.SS1.p2.9.m9.1.1.3" xref="S2.SS1.p2.9.m9.1.1.3.cmml"><mi id="S2.SS1.p2.9.m9.1.1.3.2" xref="S2.SS1.p2.9.m9.1.1.3.2.cmml">N</mi><mi id="S2.SS1.p2.9.m9.1.1.3.3" xref="S2.SS1.p2.9.m9.1.1.3.3.cmml">H</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.9.m9.1b"><apply id="S2.SS1.p2.9.m9.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.9.m9.1.1.2.cmml" xref="S2.SS1.p2.9.m9.1.1">superscript</csymbol><apply id="S2.SS1.p2.9.m9.1.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.9.m9.1.1.1.2.cmml" xref="S2.SS1.p2.9.m9.1.1">subscript</csymbol><set id="S2.SS1.p2.9.m9.1.1.1.1.2.cmml" xref="S2.SS1.p2.9.m9.1.1.1.1.1"><apply id="S2.SS1.p2.9.m9.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.9.m9.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.9.m9.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.9.m9.1.1.1.1.1.1.2">𝑟</ci><ci id="S2.SS1.p2.9.m9.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.9.m9.1.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="S2.SS1.p2.9.m9.1.1.1.3.cmml" xref="S2.SS1.p2.9.m9.1.1.1.3"><eq id="S2.SS1.p2.9.m9.1.1.1.3.1.cmml" xref="S2.SS1.p2.9.m9.1.1.1.3.1"></eq><ci id="S2.SS1.p2.9.m9.1.1.1.3.2.cmml" xref="S2.SS1.p2.9.m9.1.1.1.3.2">𝑗</ci><cn id="S2.SS1.p2.9.m9.1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p2.9.m9.1.1.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p2.9.m9.1.1.3.cmml" xref="S2.SS1.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.9.m9.1.1.3.1.cmml" xref="S2.SS1.p2.9.m9.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.9.m9.1.1.3.2.cmml" xref="S2.SS1.p2.9.m9.1.1.3.2">𝑁</ci><ci id="S2.SS1.p2.9.m9.1.1.3.3.cmml" xref="S2.SS1.p2.9.m9.1.1.3.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.9.m9.1c">\{r_{j}\}_{j=1}^{N_{H}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.9.m9.1d">{ italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="r_{j}\in D" class="ltx_Math" display="inline" id="S2.SS1.p2.10.m10.1"><semantics id="S2.SS1.p2.10.m10.1a"><mrow id="S2.SS1.p2.10.m10.1.1" xref="S2.SS1.p2.10.m10.1.1.cmml"><msub id="S2.SS1.p2.10.m10.1.1.2" xref="S2.SS1.p2.10.m10.1.1.2.cmml"><mi id="S2.SS1.p2.10.m10.1.1.2.2" xref="S2.SS1.p2.10.m10.1.1.2.2.cmml">r</mi><mi id="S2.SS1.p2.10.m10.1.1.2.3" xref="S2.SS1.p2.10.m10.1.1.2.3.cmml">j</mi></msub><mo id="S2.SS1.p2.10.m10.1.1.1" xref="S2.SS1.p2.10.m10.1.1.1.cmml">∈</mo><mi id="S2.SS1.p2.10.m10.1.1.3" xref="S2.SS1.p2.10.m10.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.10.m10.1b"><apply id="S2.SS1.p2.10.m10.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1"><in id="S2.SS1.p2.10.m10.1.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1.1"></in><apply id="S2.SS1.p2.10.m10.1.1.2.cmml" xref="S2.SS1.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.10.m10.1.1.2.1.cmml" xref="S2.SS1.p2.10.m10.1.1.2">subscript</csymbol><ci id="S2.SS1.p2.10.m10.1.1.2.2.cmml" xref="S2.SS1.p2.10.m10.1.1.2.2">𝑟</ci><ci id="S2.SS1.p2.10.m10.1.1.2.3.cmml" xref="S2.SS1.p2.10.m10.1.1.2.3">𝑗</ci></apply><ci id="S2.SS1.p2.10.m10.1.1.3.cmml" xref="S2.SS1.p2.10.m10.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.10.m10.1c">r_{j}\in D</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.10.m10.1d">italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ italic_D</annotation></semantics></math> and <math alttext="N_{H}" class="ltx_Math" display="inline" id="S2.SS1.p2.11.m11.1"><semantics id="S2.SS1.p2.11.m11.1a"><msub id="S2.SS1.p2.11.m11.1.1" xref="S2.SS1.p2.11.m11.1.1.cmml"><mi id="S2.SS1.p2.11.m11.1.1.2" xref="S2.SS1.p2.11.m11.1.1.2.cmml">N</mi><mi id="S2.SS1.p2.11.m11.1.1.3" xref="S2.SS1.p2.11.m11.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.11.m11.1b"><apply id="S2.SS1.p2.11.m11.1.1.cmml" xref="S2.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.11.m11.1.1.1.cmml" xref="S2.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="S2.SS1.p2.11.m11.1.1.2.cmml" xref="S2.SS1.p2.11.m11.1.1.2">𝑁</ci><ci id="S2.SS1.p2.11.m11.1.1.3.cmml" xref="S2.SS1.p2.11.m11.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.11.m11.1c">N_{H}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.11.m11.1d">italic_N start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT</annotation></semantics></math> denoting the hop size. For each retrieved content <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.12.m12.1"><semantics id="S2.SS1.p2.12.m12.1a"><msub id="S2.SS1.p2.12.m12.1.1" xref="S2.SS1.p2.12.m12.1.1.cmml"><mi id="S2.SS1.p2.12.m12.1.1.2" xref="S2.SS1.p2.12.m12.1.1.2.cmml">s</mi><mi id="S2.SS1.p2.12.m12.1.1.3" xref="S2.SS1.p2.12.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.12.m12.1b"><apply id="S2.SS1.p2.12.m12.1.1.cmml" xref="S2.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.12.m12.1.1.1.cmml" xref="S2.SS1.p2.12.m12.1.1">subscript</csymbol><ci id="S2.SS1.p2.12.m12.1.1.2.cmml" xref="S2.SS1.p2.12.m12.1.1.2">𝑠</ci><ci id="S2.SS1.p2.12.m12.1.1.3.cmml" xref="S2.SS1.p2.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.12.m12.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.12.m12.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathcal{M}_{G}" class="ltx_Math" display="inline" id="S2.SS1.p2.13.m13.1"><semantics id="S2.SS1.p2.13.m13.1a"><msub id="S2.SS1.p2.13.m13.1.1" xref="S2.SS1.p2.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.13.m13.1.1.2" xref="S2.SS1.p2.13.m13.1.1.2.cmml">ℳ</mi><mi id="S2.SS1.p2.13.m13.1.1.3" xref="S2.SS1.p2.13.m13.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.13.m13.1b"><apply id="S2.SS1.p2.13.m13.1.1.cmml" xref="S2.SS1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.13.m13.1.1.1.cmml" xref="S2.SS1.p2.13.m13.1.1">subscript</csymbol><ci id="S2.SS1.p2.13.m13.1.1.2.cmml" xref="S2.SS1.p2.13.m13.1.1.2">ℳ</ci><ci id="S2.SS1.p2.13.m13.1.1.3.cmml" xref="S2.SS1.p2.13.m13.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.13.m13.1c">\mathcal{M}_{G}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.13.m13.1d">caligraphic_M start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math>  generates a <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.23.1">Relevance</em> token, the output response <math alttext="y_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.14.m14.1"><semantics id="S2.SS1.p2.14.m14.1a"><msub id="S2.SS1.p2.14.m14.1.1" xref="S2.SS1.p2.14.m14.1.1.cmml"><mi id="S2.SS1.p2.14.m14.1.1.2" xref="S2.SS1.p2.14.m14.1.1.2.cmml">y</mi><mi id="S2.SS1.p2.14.m14.1.1.3" xref="S2.SS1.p2.14.m14.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.14.m14.1b"><apply id="S2.SS1.p2.14.m14.1.1.cmml" xref="S2.SS1.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.14.m14.1.1.1.cmml" xref="S2.SS1.p2.14.m14.1.1">subscript</csymbol><ci id="S2.SS1.p2.14.m14.1.1.2.cmml" xref="S2.SS1.p2.14.m14.1.1.2">𝑦</ci><ci id="S2.SS1.p2.14.m14.1.1.3.cmml" xref="S2.SS1.p2.14.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.14.m14.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.14.m14.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, a <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.23.2">Grounding</em> token, and a <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.23.3">Utility</em> token.
The <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.23.4">Relevance</em> tokens (<span class="ltx_text ltx_font_typewriter" id="S2.SS1.p2.23.5">[Relevant/Irrelevant]</span>) indicate if <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.15.m15.1"><semantics id="S2.SS1.p2.15.m15.1a"><msub id="S2.SS1.p2.15.m15.1.1" xref="S2.SS1.p2.15.m15.1.1.cmml"><mi id="S2.SS1.p2.15.m15.1.1.2" xref="S2.SS1.p2.15.m15.1.1.2.cmml">s</mi><mi id="S2.SS1.p2.15.m15.1.1.3" xref="S2.SS1.p2.15.m15.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.15.m15.1b"><apply id="S2.SS1.p2.15.m15.1.1.cmml" xref="S2.SS1.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.15.m15.1.1.1.cmml" xref="S2.SS1.p2.15.m15.1.1">subscript</csymbol><ci id="S2.SS1.p2.15.m15.1.1.2.cmml" xref="S2.SS1.p2.15.m15.1.1.2">𝑠</ci><ci id="S2.SS1.p2.15.m15.1.1.3.cmml" xref="S2.SS1.p2.15.m15.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.15.m15.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.15.m15.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is relevant to <math alttext="q" class="ltx_Math" display="inline" id="S2.SS1.p2.16.m16.1"><semantics id="S2.SS1.p2.16.m16.1a"><mi id="S2.SS1.p2.16.m16.1.1" xref="S2.SS1.p2.16.m16.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.16.m16.1b"><ci id="S2.SS1.p2.16.m16.1.1.cmml" xref="S2.SS1.p2.16.m16.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.16.m16.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.16.m16.1d">italic_q</annotation></semantics></math>, the <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.23.6">Grounding</em> tokens (<span class="ltx_text ltx_font_typewriter" id="S2.SS1.p2.23.7">[Fully Supported/Partially Supported/No Support]</span>) indicate if <math alttext="y_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.17.m17.1"><semantics id="S2.SS1.p2.17.m17.1a"><msub id="S2.SS1.p2.17.m17.1.1" xref="S2.SS1.p2.17.m17.1.1.cmml"><mi id="S2.SS1.p2.17.m17.1.1.2" xref="S2.SS1.p2.17.m17.1.1.2.cmml">y</mi><mi id="S2.SS1.p2.17.m17.1.1.3" xref="S2.SS1.p2.17.m17.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.17.m17.1b"><apply id="S2.SS1.p2.17.m17.1.1.cmml" xref="S2.SS1.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.17.m17.1.1.1.cmml" xref="S2.SS1.p2.17.m17.1.1">subscript</csymbol><ci id="S2.SS1.p2.17.m17.1.1.2.cmml" xref="S2.SS1.p2.17.m17.1.1.2">𝑦</ci><ci id="S2.SS1.p2.17.m17.1.1.3.cmml" xref="S2.SS1.p2.17.m17.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.17.m17.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.17.m17.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is supported by <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.18.m18.1"><semantics id="S2.SS1.p2.18.m18.1a"><msub id="S2.SS1.p2.18.m18.1.1" xref="S2.SS1.p2.18.m18.1.1.cmml"><mi id="S2.SS1.p2.18.m18.1.1.2" xref="S2.SS1.p2.18.m18.1.1.2.cmml">s</mi><mi id="S2.SS1.p2.18.m18.1.1.3" xref="S2.SS1.p2.18.m18.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.18.m18.1b"><apply id="S2.SS1.p2.18.m18.1.1.cmml" xref="S2.SS1.p2.18.m18.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.18.m18.1.1.1.cmml" xref="S2.SS1.p2.18.m18.1.1">subscript</csymbol><ci id="S2.SS1.p2.18.m18.1.1.2.cmml" xref="S2.SS1.p2.18.m18.1.1.2">𝑠</ci><ci id="S2.SS1.p2.18.m18.1.1.3.cmml" xref="S2.SS1.p2.18.m18.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.18.m18.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.18.m18.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and the <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.23.8">Utility</em> tokens (<span class="ltx_text ltx_font_typewriter" id="S2.SS1.p2.23.9">[U:1]</span>-<span class="ltx_text ltx_font_typewriter" id="S2.SS1.p2.23.10">[U:5]</span>) define how useful <math alttext="y_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.19.m19.1"><semantics id="S2.SS1.p2.19.m19.1a"><msub id="S2.SS1.p2.19.m19.1.1" xref="S2.SS1.p2.19.m19.1.1.cmml"><mi id="S2.SS1.p2.19.m19.1.1.2" xref="S2.SS1.p2.19.m19.1.1.2.cmml">y</mi><mi id="S2.SS1.p2.19.m19.1.1.3" xref="S2.SS1.p2.19.m19.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.19.m19.1b"><apply id="S2.SS1.p2.19.m19.1.1.cmml" xref="S2.SS1.p2.19.m19.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.19.m19.1.1.1.cmml" xref="S2.SS1.p2.19.m19.1.1">subscript</csymbol><ci id="S2.SS1.p2.19.m19.1.1.2.cmml" xref="S2.SS1.p2.19.m19.1.1.2">𝑦</ci><ci id="S2.SS1.p2.19.m19.1.1.3.cmml" xref="S2.SS1.p2.19.m19.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.19.m19.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.19.m19.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is to <math alttext="q" class="ltx_Math" display="inline" id="S2.SS1.p2.20.m20.1"><semantics id="S2.SS1.p2.20.m20.1a"><mi id="S2.SS1.p2.20.m20.1.1" xref="S2.SS1.p2.20.m20.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.20.m20.1b"><ci id="S2.SS1.p2.20.m20.1.1.cmml" xref="S2.SS1.p2.20.m20.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.20.m20.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.20.m20.1d">italic_q</annotation></semantics></math>. We process each <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.21.m21.1"><semantics id="S2.SS1.p2.21.m21.1a"><msub id="S2.SS1.p2.21.m21.1.1" xref="S2.SS1.p2.21.m21.1.1.cmml"><mi id="S2.SS1.p2.21.m21.1.1.2" xref="S2.SS1.p2.21.m21.1.1.2.cmml">s</mi><mi id="S2.SS1.p2.21.m21.1.1.3" xref="S2.SS1.p2.21.m21.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.21.m21.1b"><apply id="S2.SS1.p2.21.m21.1.1.cmml" xref="S2.SS1.p2.21.m21.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.21.m21.1.1.1.cmml" xref="S2.SS1.p2.21.m21.1.1">subscript</csymbol><ci id="S2.SS1.p2.21.m21.1.1.2.cmml" xref="S2.SS1.p2.21.m21.1.1.2">𝑠</ci><ci id="S2.SS1.p2.21.m21.1.1.3.cmml" xref="S2.SS1.p2.21.m21.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.21.m21.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.21.m21.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in parallel and generate the final answer <math alttext="y_{pred}" class="ltx_Math" display="inline" id="S2.SS1.p2.22.m22.1"><semantics id="S2.SS1.p2.22.m22.1a"><msub id="S2.SS1.p2.22.m22.1.1" xref="S2.SS1.p2.22.m22.1.1.cmml"><mi id="S2.SS1.p2.22.m22.1.1.2" xref="S2.SS1.p2.22.m22.1.1.2.cmml">y</mi><mrow id="S2.SS1.p2.22.m22.1.1.3" xref="S2.SS1.p2.22.m22.1.1.3.cmml"><mi id="S2.SS1.p2.22.m22.1.1.3.2" xref="S2.SS1.p2.22.m22.1.1.3.2.cmml">p</mi><mo id="S2.SS1.p2.22.m22.1.1.3.1" xref="S2.SS1.p2.22.m22.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.22.m22.1.1.3.3" xref="S2.SS1.p2.22.m22.1.1.3.3.cmml">r</mi><mo id="S2.SS1.p2.22.m22.1.1.3.1a" xref="S2.SS1.p2.22.m22.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.22.m22.1.1.3.4" xref="S2.SS1.p2.22.m22.1.1.3.4.cmml">e</mi><mo id="S2.SS1.p2.22.m22.1.1.3.1b" xref="S2.SS1.p2.22.m22.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.22.m22.1.1.3.5" xref="S2.SS1.p2.22.m22.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.22.m22.1b"><apply id="S2.SS1.p2.22.m22.1.1.cmml" xref="S2.SS1.p2.22.m22.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.22.m22.1.1.1.cmml" xref="S2.SS1.p2.22.m22.1.1">subscript</csymbol><ci id="S2.SS1.p2.22.m22.1.1.2.cmml" xref="S2.SS1.p2.22.m22.1.1.2">𝑦</ci><apply id="S2.SS1.p2.22.m22.1.1.3.cmml" xref="S2.SS1.p2.22.m22.1.1.3"><times id="S2.SS1.p2.22.m22.1.1.3.1.cmml" xref="S2.SS1.p2.22.m22.1.1.3.1"></times><ci id="S2.SS1.p2.22.m22.1.1.3.2.cmml" xref="S2.SS1.p2.22.m22.1.1.3.2">𝑝</ci><ci id="S2.SS1.p2.22.m22.1.1.3.3.cmml" xref="S2.SS1.p2.22.m22.1.1.3.3">𝑟</ci><ci id="S2.SS1.p2.22.m22.1.1.3.4.cmml" xref="S2.SS1.p2.22.m22.1.1.3.4">𝑒</ci><ci id="S2.SS1.p2.22.m22.1.1.3.5.cmml" xref="S2.SS1.p2.22.m22.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.22.m22.1c">y_{pred}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.22.m22.1d">italic_y start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT</annotation></semantics></math> by ranking them (i.e., all <math alttext="y_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.23.m23.1"><semantics id="S2.SS1.p2.23.m23.1a"><msub id="S2.SS1.p2.23.m23.1.1" xref="S2.SS1.p2.23.m23.1.1.cmml"><mi id="S2.SS1.p2.23.m23.1.1.2" xref="S2.SS1.p2.23.m23.1.1.2.cmml">y</mi><mi id="S2.SS1.p2.23.m23.1.1.3" xref="S2.SS1.p2.23.m23.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.23.m23.1b"><apply id="S2.SS1.p2.23.m23.1.1.cmml" xref="S2.SS1.p2.23.m23.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.23.m23.1.1.1.cmml" xref="S2.SS1.p2.23.m23.1.1">subscript</csymbol><ci id="S2.SS1.p2.23.m23.1.1.2.cmml" xref="S2.SS1.p2.23.m23.1.1.2">𝑦</ci><ci id="S2.SS1.p2.23.m23.1.1.3.cmml" xref="S2.SS1.p2.23.m23.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.23.m23.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.23.m23.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>) based on the weighted sum of the normalized confidence of the corresponding predicted <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.23.11">Relevance</em>, <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.23.12">Grounding</em>, and <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.23.13">Utility</em> tokens<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>For long-form generation, we use the same segment-level beam search strategy as in Self-RAG <cite class="ltx_cite ltx_citemacro_cite">Asai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib2" title="">2024</a>)</cite> to obtain the <span class="ltx_text ltx_font_typewriter" id="footnote3.1">Top-<math alttext="B" class="ltx_Math" display="inline" id="footnote3.1.m1.1"><semantics id="footnote3.1.m1.1b"><mi id="footnote3.1.m1.1.1" xref="footnote3.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="footnote3.1.m1.1c"><ci id="footnote3.1.m1.1.1.cmml" xref="footnote3.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote3.1.m1.1d">B</annotation><annotation encoding="application/x-llamapun" id="footnote3.1.m1.1e">italic_B</annotation></semantics></math></span> segments, where <math alttext="B" class="ltx_Math" display="inline" id="footnote3.m1.1"><semantics id="footnote3.m1.1b"><mi id="footnote3.m1.1.1" xref="footnote3.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="footnote3.m1.1c"><ci id="footnote3.m1.1.1.cmml" xref="footnote3.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m1.1d">B</annotation><annotation encoding="application/x-llamapun" id="footnote3.m1.1e">italic_B</annotation></semantics></math> is the beam size, and return the best sequence at the end of generation.</span></span></span> (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span><span class="ltx_text ltx_font_smallcaps" id="S2.SS2.1.1">Open-RAG</span> Training</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Here, we discuss our training data collection (Sec <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS2.SSS1" title="2.2.1 Data Collection ‣ 2.2 Open-RAG Training ‣ 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">2.2.1</span></a>) and
parameter-efficient
MoE fine-tuning (Sec <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS2.SSS2" title="2.2.2 Parameter-Efficient MoE Finetuning ‣ 2.2 Open-RAG Training ‣ 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">2.2.2</span></a>).</p>
</div>
<section class="ltx_subsubsection" id="S2.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1 </span>Data Collection</h4>
<div class="ltx_para" id="S2.SS2.SSS1.p1">
<p class="ltx_p" id="S2.SS2.SSS1.p1.18">To empower <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS1.p1.18.1">Open-RAG</span> to tackle retrieval-free queries, as well as single- and multi-hop queries that require retrieval, we build our training data using various types of tasks and datasets. Given an input-output data pair (<math alttext="q" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.1.m1.1"><semantics id="S2.SS2.SSS1.p1.1.m1.1a"><mi id="S2.SS2.SSS1.p1.1.m1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.1b"><ci id="S2.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.1.m1.1d">italic_q</annotation></semantics></math>, <math alttext="y" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.2.m2.1"><semantics id="S2.SS2.SSS1.p1.2.m2.1a"><mi id="S2.SS2.SSS1.p1.2.m2.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m2.1b"><ci id="S2.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.2.m2.1d">italic_y</annotation></semantics></math>) in an original dataset, we augment the data with <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS1.p1.18.2">reflection</em> tokens (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS1" title="2.1 Overview ‣ 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">2.1</span></a>) leveraging ground truth annotation or critic LLM <math alttext="C" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.3.m3.1"><semantics id="S2.SS2.SSS1.p1.3.m3.1a"><mi id="S2.SS2.SSS1.p1.3.m3.1.1" xref="S2.SS2.SSS1.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.3.m3.1b"><ci id="S2.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.3.m3.1d">italic_C</annotation></semantics></math> to create supervised data. If the corresponding <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS1.p1.18.3">Retrieval</em> token added by <math alttext="C" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.4.m4.1"><semantics id="S2.SS2.SSS1.p1.4.m4.1a"><mi id="S2.SS2.SSS1.p1.4.m4.1.1" xref="S2.SS2.SSS1.p1.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.4.m4.1b"><ci id="S2.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.4.m4.1c">C</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.4.m4.1d">italic_C</annotation></semantics></math> is <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS1.p1.18.4">[RT]</span>, we further augment the data and create three different new instances accordingly as follows. First, we use <math alttext="R" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.5.m5.1"><semantics id="S2.SS2.SSS1.p1.5.m5.1a"><mi id="S2.SS2.SSS1.p1.5.m5.1.1" xref="S2.SS2.SSS1.p1.5.m5.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.5.m5.1b"><ci id="S2.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.5.m5.1c">R</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.5.m5.1d">italic_R</annotation></semantics></math> to retrieve the top-<math alttext="k" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.6.m6.1"><semantics id="S2.SS2.SSS1.p1.6.m6.1a"><mi id="S2.SS2.SSS1.p1.6.m6.1.1" xref="S2.SS2.SSS1.p1.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.6.m6.1b"><ci id="S2.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.6.m6.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.6.m6.1d">italic_k</annotation></semantics></math> documents <math alttext="S" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.7.m7.1"><semantics id="S2.SS2.SSS1.p1.7.m7.1a"><mi id="S2.SS2.SSS1.p1.7.m7.1.1" xref="S2.SS2.SSS1.p1.7.m7.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.7.m7.1b"><ci id="S2.SS2.SSS1.p1.7.m7.1.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.7.m7.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.7.m7.1d">italic_S</annotation></semantics></math>. For each retrieved document <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.8.m8.1"><semantics id="S2.SS2.SSS1.p1.8.m8.1a"><msub id="S2.SS2.SSS1.p1.8.m8.1.1" xref="S2.SS2.SSS1.p1.8.m8.1.1.cmml"><mi id="S2.SS2.SSS1.p1.8.m8.1.1.2" xref="S2.SS2.SSS1.p1.8.m8.1.1.2.cmml">s</mi><mi id="S2.SS2.SSS1.p1.8.m8.1.1.3" xref="S2.SS2.SSS1.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.8.m8.1b"><apply id="S2.SS2.SSS1.p1.8.m8.1.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.8.m8.1.1.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.8.m8.1.1.2.cmml" xref="S2.SS2.SSS1.p1.8.m8.1.1.2">𝑠</ci><ci id="S2.SS2.SSS1.p1.8.m8.1.1.3.cmml" xref="S2.SS2.SSS1.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.8.m8.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.8.m8.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="C" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.9.m9.1"><semantics id="S2.SS2.SSS1.p1.9.m9.1a"><mi id="S2.SS2.SSS1.p1.9.m9.1.1" xref="S2.SS2.SSS1.p1.9.m9.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.9.m9.1b"><ci id="S2.SS2.SSS1.p1.9.m9.1.1.cmml" xref="S2.SS2.SSS1.p1.9.m9.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.9.m9.1c">C</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.9.m9.1d">italic_C</annotation></semantics></math> evaluates whether <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.10.m10.1"><semantics id="S2.SS2.SSS1.p1.10.m10.1a"><msub id="S2.SS2.SSS1.p1.10.m10.1.1" xref="S2.SS2.SSS1.p1.10.m10.1.1.cmml"><mi id="S2.SS2.SSS1.p1.10.m10.1.1.2" xref="S2.SS2.SSS1.p1.10.m10.1.1.2.cmml">s</mi><mi id="S2.SS2.SSS1.p1.10.m10.1.1.3" xref="S2.SS2.SSS1.p1.10.m10.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.10.m10.1b"><apply id="S2.SS2.SSS1.p1.10.m10.1.1.cmml" xref="S2.SS2.SSS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.10.m10.1.1.1.cmml" xref="S2.SS2.SSS1.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.10.m10.1.1.2.cmml" xref="S2.SS2.SSS1.p1.10.m10.1.1.2">𝑠</ci><ci id="S2.SS2.SSS1.p1.10.m10.1.1.3.cmml" xref="S2.SS2.SSS1.p1.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.10.m10.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.10.m10.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is relevant or not and returns the <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS1.p1.18.5">Relevance</em> token. To address both single- and multi-hop queries, we equip our data pipeline with a hop-unified heuristic: if at least one passage <math alttext="\{r_{j}\}\in s_{t}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.11.m11.1"><semantics id="S2.SS2.SSS1.p1.11.m11.1a"><mrow id="S2.SS2.SSS1.p1.11.m11.1.1" xref="S2.SS2.SSS1.p1.11.m11.1.1.cmml"><mrow id="S2.SS2.SSS1.p1.11.m11.1.1.1.1" xref="S2.SS2.SSS1.p1.11.m11.1.1.1.2.cmml"><mo id="S2.SS2.SSS1.p1.11.m11.1.1.1.1.2" stretchy="false" xref="S2.SS2.SSS1.p1.11.m11.1.1.1.2.cmml">{</mo><msub id="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1" xref="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1.2" xref="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1.2.cmml">r</mi><mi id="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1.3" xref="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S2.SS2.SSS1.p1.11.m11.1.1.1.1.3" stretchy="false" xref="S2.SS2.SSS1.p1.11.m11.1.1.1.2.cmml">}</mo></mrow><mo id="S2.SS2.SSS1.p1.11.m11.1.1.2" xref="S2.SS2.SSS1.p1.11.m11.1.1.2.cmml">∈</mo><msub id="S2.SS2.SSS1.p1.11.m11.1.1.3" xref="S2.SS2.SSS1.p1.11.m11.1.1.3.cmml"><mi id="S2.SS2.SSS1.p1.11.m11.1.1.3.2" xref="S2.SS2.SSS1.p1.11.m11.1.1.3.2.cmml">s</mi><mi id="S2.SS2.SSS1.p1.11.m11.1.1.3.3" xref="S2.SS2.SSS1.p1.11.m11.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.11.m11.1b"><apply id="S2.SS2.SSS1.p1.11.m11.1.1.cmml" xref="S2.SS2.SSS1.p1.11.m11.1.1"><in id="S2.SS2.SSS1.p1.11.m11.1.1.2.cmml" xref="S2.SS2.SSS1.p1.11.m11.1.1.2"></in><set id="S2.SS2.SSS1.p1.11.m11.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.11.m11.1.1.1.1"><apply id="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1.2">𝑟</ci><ci id="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.11.m11.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="S2.SS2.SSS1.p1.11.m11.1.1.3.cmml" xref="S2.SS2.SSS1.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.11.m11.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.11.m11.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.11.m11.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.11.m11.1.1.3.2">𝑠</ci><ci id="S2.SS2.SSS1.p1.11.m11.1.1.3.3.cmml" xref="S2.SS2.SSS1.p1.11.m11.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.11.m11.1c">\{r_{j}\}\in s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.11.m11.1d">{ italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } ∈ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is relevant, we add the <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS1.p1.18.6">Relevance</em> token as <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS1.p1.18.7">[Relevant]</span>; otherwise, we use <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS1.p1.18.8">[Irrelevant]</span>. When <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS1.p1.18.9">[Relevant]</span> is predicted, to enable <math alttext="\mathcal{M}_{G}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.12.m12.1"><semantics id="S2.SS2.SSS1.p1.12.m12.1a"><msub id="S2.SS2.SSS1.p1.12.m12.1.1" xref="S2.SS2.SSS1.p1.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.12.m12.1.1.2" xref="S2.SS2.SSS1.p1.12.m12.1.1.2.cmml">ℳ</mi><mi id="S2.SS2.SSS1.p1.12.m12.1.1.3" xref="S2.SS2.SSS1.p1.12.m12.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.12.m12.1b"><apply id="S2.SS2.SSS1.p1.12.m12.1.1.cmml" xref="S2.SS2.SSS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.12.m12.1.1.1.cmml" xref="S2.SS2.SSS1.p1.12.m12.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.12.m12.1.1.2.cmml" xref="S2.SS2.SSS1.p1.12.m12.1.1.2">ℳ</ci><ci id="S2.SS2.SSS1.p1.12.m12.1.1.3.cmml" xref="S2.SS2.SSS1.p1.12.m12.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.12.m12.1c">\mathcal{M}_{G}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.12.m12.1d">caligraphic_M start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math>  to contrast between useful and distractor contexts in <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.13.m13.1"><semantics id="S2.SS2.SSS1.p1.13.m13.1a"><msub id="S2.SS2.SSS1.p1.13.m13.1.1" xref="S2.SS2.SSS1.p1.13.m13.1.1.cmml"><mi id="S2.SS2.SSS1.p1.13.m13.1.1.2" xref="S2.SS2.SSS1.p1.13.m13.1.1.2.cmml">s</mi><mi id="S2.SS2.SSS1.p1.13.m13.1.1.3" xref="S2.SS2.SSS1.p1.13.m13.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.13.m13.1b"><apply id="S2.SS2.SSS1.p1.13.m13.1.1.cmml" xref="S2.SS2.SSS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.13.m13.1.1.1.cmml" xref="S2.SS2.SSS1.p1.13.m13.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.13.m13.1.1.2.cmml" xref="S2.SS2.SSS1.p1.13.m13.1.1.2">𝑠</ci><ci id="S2.SS2.SSS1.p1.13.m13.1.1.3.cmml" xref="S2.SS2.SSS1.p1.13.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.13.m13.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.13.m13.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in a more fine-grained way, we design a data-contrastive heuristic: (i) for single-hop RAG datasets, we use <math alttext="C" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.14.m14.1"><semantics id="S2.SS2.SSS1.p1.14.m14.1a"><mi id="S2.SS2.SSS1.p1.14.m14.1.1" xref="S2.SS2.SSS1.p1.14.m14.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.14.m14.1b"><ci id="S2.SS2.SSS1.p1.14.m14.1.1.cmml" xref="S2.SS2.SSS1.p1.14.m14.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.14.m14.1c">C</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.14.m14.1d">italic_C</annotation></semantics></math> directly to label the <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS1.p1.18.10">Grounding</em> token; (ii) for multi-hop RAG datasets, if all passages <math alttext="\{r_{j}\}\in s_{t}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.15.m15.1"><semantics id="S2.SS2.SSS1.p1.15.m15.1a"><mrow id="S2.SS2.SSS1.p1.15.m15.1.1" xref="S2.SS2.SSS1.p1.15.m15.1.1.cmml"><mrow id="S2.SS2.SSS1.p1.15.m15.1.1.1.1" xref="S2.SS2.SSS1.p1.15.m15.1.1.1.2.cmml"><mo id="S2.SS2.SSS1.p1.15.m15.1.1.1.1.2" stretchy="false" xref="S2.SS2.SSS1.p1.15.m15.1.1.1.2.cmml">{</mo><msub id="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1" xref="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1.2" xref="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1.2.cmml">r</mi><mi id="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1.3" xref="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S2.SS2.SSS1.p1.15.m15.1.1.1.1.3" stretchy="false" xref="S2.SS2.SSS1.p1.15.m15.1.1.1.2.cmml">}</mo></mrow><mo id="S2.SS2.SSS1.p1.15.m15.1.1.2" xref="S2.SS2.SSS1.p1.15.m15.1.1.2.cmml">∈</mo><msub id="S2.SS2.SSS1.p1.15.m15.1.1.3" xref="S2.SS2.SSS1.p1.15.m15.1.1.3.cmml"><mi id="S2.SS2.SSS1.p1.15.m15.1.1.3.2" xref="S2.SS2.SSS1.p1.15.m15.1.1.3.2.cmml">s</mi><mi id="S2.SS2.SSS1.p1.15.m15.1.1.3.3" xref="S2.SS2.SSS1.p1.15.m15.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.15.m15.1b"><apply id="S2.SS2.SSS1.p1.15.m15.1.1.cmml" xref="S2.SS2.SSS1.p1.15.m15.1.1"><in id="S2.SS2.SSS1.p1.15.m15.1.1.2.cmml" xref="S2.SS2.SSS1.p1.15.m15.1.1.2"></in><set id="S2.SS2.SSS1.p1.15.m15.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.15.m15.1.1.1.1"><apply id="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1.2">𝑟</ci><ci id="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.15.m15.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="S2.SS2.SSS1.p1.15.m15.1.1.3.cmml" xref="S2.SS2.SSS1.p1.15.m15.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.15.m15.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.15.m15.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.15.m15.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.15.m15.1.1.3.2">𝑠</ci><ci id="S2.SS2.SSS1.p1.15.m15.1.1.3.3.cmml" xref="S2.SS2.SSS1.p1.15.m15.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.15.m15.1c">\{r_{j}\}\in s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.15.m15.1d">{ italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } ∈ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are individually predicted as <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS1.p1.18.11">[RT]</span>, then we add <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS1.p1.18.12">[Fully Supported]</span> as the <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS1.p1.18.13">Grounding</em> token; otherwise, we use <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS1.p1.18.14">[Partially Supported]</span>. Finally, regardless of the prediction of the <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS1.p1.18.15">Relevance</em> token, we use <math alttext="C" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.16.m16.1"><semantics id="S2.SS2.SSS1.p1.16.m16.1a"><mi id="S2.SS2.SSS1.p1.16.m16.1.1" xref="S2.SS2.SSS1.p1.16.m16.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.16.m16.1b"><ci id="S2.SS2.SSS1.p1.16.m16.1.1.cmml" xref="S2.SS2.SSS1.p1.16.m16.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.16.m16.1c">C</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.16.m16.1d">italic_C</annotation></semantics></math> to provide a <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS1.p1.18.16">Utility</em> score for <math alttext="y" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.17.m17.1"><semantics id="S2.SS2.SSS1.p1.17.m17.1a"><mi id="S2.SS2.SSS1.p1.17.m17.1.1" xref="S2.SS2.SSS1.p1.17.m17.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.17.m17.1b"><ci id="S2.SS2.SSS1.p1.17.m17.1.1.cmml" xref="S2.SS2.SSS1.p1.17.m17.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.17.m17.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.17.m17.1d">italic_y</annotation></semantics></math> with respect to <math alttext="q" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.18.m18.1"><semantics id="S2.SS2.SSS1.p1.18.m18.1a"><mi id="S2.SS2.SSS1.p1.18.m18.1.1" xref="S2.SS2.SSS1.p1.18.m18.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.18.m18.1b"><ci id="S2.SS2.SSS1.p1.18.m18.1.1.cmml" xref="S2.SS2.SSS1.p1.18.m18.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.18.m18.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.18.m18.1d">italic_q</annotation></semantics></math>. We depict an example of the training data collection for a 2-hop question in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2 </span>Parameter-Efficient MoE Finetuning</h4>
<div class="ltx_para" id="S2.SS2.SSS2.p1">
<p class="ltx_p" id="S2.SS2.SSS2.p1.1">RAG tasks are inherently complex, composed of various components such as queries with single (single-hop) or multiple (multi-hop) passages. The ability to leverage different parts of the model selectively based on such complexities can facilitate more adaptive and fine-grained reasoning capabilities over versatile input contexts. Therefore, instead of traditional dense models that treat all parts uniformly, we propose to transform <math alttext="\mathcal{M}_{G}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.1.m1.1"><semantics id="S2.SS2.SSS2.p1.1.m1.1a"><msub id="S2.SS2.SSS2.p1.1.m1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p1.1.m1.1.1.2" xref="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml">ℳ</mi><mi id="S2.SS2.SSS2.p1.1.m1.1.1.3" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.1.m1.1b"><apply id="S2.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.2">ℳ</ci><ci id="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.1.m1.1c">\mathcal{M}_{G}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math>  into a MoE architecture on the fly, which learns to selectively activate the most suitable experts dynamically for each query with versatile complexity (e.g., single/multi-hop). This selective activation is learned (fine-tuned) using our tailored training data, ensuring that the model learns to differentiate between useful and misleading information.</p>
</div>
<div class="ltx_para" id="S2.SS2.SSS2.p2">
<p class="ltx_p" id="S2.SS2.SSS2.p2.1">As open-source models are often used in low-compute settings, <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS2.p2.1.1">Open-RAG</span> employs sparse upcycling <cite class="ltx_cite ltx_citemacro_citep">(Komatsuzaki et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib19" title="">2022</a>; Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib43" title="">2024</a>)</cite> to transform <math alttext="\mathcal{M}_{G}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.1.m1.1"><semantics id="S2.SS2.SSS2.p2.1.m1.1a"><msub id="S2.SS2.SSS2.p2.1.m1.1.1" xref="S2.SS2.SSS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p2.1.m1.1.1.2" xref="S2.SS2.SSS2.p2.1.m1.1.1.2.cmml">ℳ</mi><mi id="S2.SS2.SSS2.p2.1.m1.1.1.3" xref="S2.SS2.SSS2.p2.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.1.m1.1b"><apply id="S2.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p2.1.m1.1.1.2">ℳ</ci><ci id="S2.SS2.SSS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p2.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.1.m1.1c">\mathcal{M}_{G}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math>  into a parameter-efficient sparse MoE. This approach adds only a few million adapter parameters, preserving the same order of active parameters as in the original LLM.</p>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="192" id="S2.F3.g1" src="x3.png" width="457"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
Architechture transformation (dense to PEFT MoE) in <span class="ltx_text ltx_font_smallcaps" id="S2.F3.6.1">Open-RAG</span>. Router <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S2.F3.3.m1.1"><semantics id="S2.F3.3.m1.1b"><mi class="ltx_font_mathcaligraphic" id="S2.F3.3.m1.1.1" xref="S2.F3.3.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.F3.3.m1.1c"><ci id="S2.F3.3.m1.1.1.cmml" xref="S2.F3.3.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.3.m1.1d">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S2.F3.3.m1.1e">caligraphic_R</annotation></semantics></math> is trained from scratch.
The FFN layer is kept frozen and adapted by parallel-adapter-based experts <math alttext="\mathbf{E}" class="ltx_Math" display="inline" id="S2.F3.4.m2.1"><semantics id="S2.F3.4.m2.1b"><mi id="S2.F3.4.m2.1.1" xref="S2.F3.4.m2.1.1.cmml">𝐄</mi><annotation-xml encoding="MathML-Content" id="S2.F3.4.m2.1c"><ci id="S2.F3.4.m2.1.1.cmml" xref="S2.F3.4.m2.1.1">𝐄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.4.m2.1d">\mathbf{E}</annotation><annotation encoding="application/x-llamapun" id="S2.F3.4.m2.1e">bold_E</annotation></semantics></math>. Other layers are being copied.
</figcaption>
</figure>
<div class="ltx_para" id="S2.SS2.SSS2.p3">
<p class="ltx_p" id="S2.SS2.SSS2.p3.4">The sparse MoE <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS2.p3.4.1">Open-RAG</span> model augments the FFN layer of the dense backbone LLM with a parameter-efficient MoE transformer block consisting of a set of expert layers <math alttext="\mathbf{E}=\{\mathcal{E}_{e}\}_{e=1}^{N_{E}}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.1.m1.1"><semantics id="S2.SS2.SSS2.p3.1.m1.1a"><mrow id="S2.SS2.SSS2.p3.1.m1.1.1" xref="S2.SS2.SSS2.p3.1.m1.1.1.cmml"><mi id="S2.SS2.SSS2.p3.1.m1.1.1.3" xref="S2.SS2.SSS2.p3.1.m1.1.1.3.cmml">𝐄</mi><mo id="S2.SS2.SSS2.p3.1.m1.1.1.2" xref="S2.SS2.SSS2.p3.1.m1.1.1.2.cmml">=</mo><msubsup id="S2.SS2.SSS2.p3.1.m1.1.1.1" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.cmml"><mrow id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.cmml"><mo id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.2" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.2.cmml">ℰ</mi><mi id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.3" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.cmml"><mi id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.2" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.2.cmml">e</mi><mo id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.1" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.3" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S2.SS2.SSS2.p3.1.m1.1.1.1.3" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.3.cmml"><mi id="S2.SS2.SSS2.p3.1.m1.1.1.1.3.2" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.3.2.cmml">N</mi><mi id="S2.SS2.SSS2.p3.1.m1.1.1.1.3.3" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.3.3.cmml">E</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.1.m1.1b"><apply id="S2.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1"><eq id="S2.SS2.SSS2.p3.1.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.2"></eq><ci id="S2.SS2.SSS2.p3.1.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.3">𝐄</ci><apply id="S2.SS2.SSS2.p3.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.1.m1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1">subscript</csymbol><set id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1"><apply id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.2">ℰ</ci><ci id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.3">𝑒</ci></apply></set><apply id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3"><eq id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.1"></eq><ci id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.2">𝑒</ci><cn id="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.SS2.SSS2.p3.1.m1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.1.m1.1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS2.p3.1.m1.1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.3.2">𝑁</ci><ci id="S2.SS2.SSS2.p3.1.m1.1.1.1.3.3.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1.1.3.3">𝐸</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.1.m1.1c">\mathbf{E}=\{\mathcal{E}_{e}\}_{e=1}^{N_{E}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.1.m1.1d">bold_E = { caligraphic_E start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_e = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> along with an efficient routing mechanism as in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.F3" title="Figure 3 ‣ 2.2.2 Parameter-Efficient MoE Finetuning ‣ 2.2 Open-RAG Training ‣ 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>. Each expert layer comprises a replicated original shared FFN layer weight, adapted by an adapter module <math alttext="\mathcal{A}_{e}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.2.m2.1"><semantics id="S2.SS2.SSS2.p3.2.m2.1a"><msub id="S2.SS2.SSS2.p3.2.m2.1.1" xref="S2.SS2.SSS2.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p3.2.m2.1.1.2" xref="S2.SS2.SSS2.p3.2.m2.1.1.2.cmml">𝒜</mi><mi id="S2.SS2.SSS2.p3.2.m2.1.1.3" xref="S2.SS2.SSS2.p3.2.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.2.m2.1b"><apply id="S2.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.2.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p3.2.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1.2">𝒜</ci><ci id="S2.SS2.SSS2.p3.2.m2.1.1.3.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.2.m2.1c">\mathcal{A}_{e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.2.m2.1d">caligraphic_A start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> with parameters <math alttext="\theta_{e}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.3.m3.1"><semantics id="S2.SS2.SSS2.p3.3.m3.1a"><msub id="S2.SS2.SSS2.p3.3.m3.1.1" xref="S2.SS2.SSS2.p3.3.m3.1.1.cmml"><mi id="S2.SS2.SSS2.p3.3.m3.1.1.2" xref="S2.SS2.SSS2.p3.3.m3.1.1.2.cmml">θ</mi><mi id="S2.SS2.SSS2.p3.3.m3.1.1.3" xref="S2.SS2.SSS2.p3.3.m3.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.3.m3.1b"><apply id="S2.SS2.SSS2.p3.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.3.m3.1.1.1.cmml" xref="S2.SS2.SSS2.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p3.3.m3.1.1.2.cmml" xref="S2.SS2.SSS2.p3.3.m3.1.1.2">𝜃</ci><ci id="S2.SS2.SSS2.p3.3.m3.1.1.3.cmml" xref="S2.SS2.SSS2.p3.3.m3.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.3.m3.1c">\theta_{e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.3.m3.1d">italic_θ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math>. To ensure parameter efficiency, in each expert, we keep the FFN layer frozen and train the adapter module <math alttext="\mathcal{A}_{e}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.4.m4.1"><semantics id="S2.SS2.SSS2.p3.4.m4.1a"><msub id="S2.SS2.SSS2.p3.4.m4.1.1" xref="S2.SS2.SSS2.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p3.4.m4.1.1.2" xref="S2.SS2.SSS2.p3.4.m4.1.1.2.cmml">𝒜</mi><mi id="S2.SS2.SSS2.p3.4.m4.1.1.3" xref="S2.SS2.SSS2.p3.4.m4.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.4.m4.1b"><apply id="S2.SS2.SSS2.p3.4.m4.1.1.cmml" xref="S2.SS2.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.4.m4.1.1.1.cmml" xref="S2.SS2.SSS2.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p3.4.m4.1.1.2.cmml" xref="S2.SS2.SSS2.p3.4.m4.1.1.2">𝒜</ci><ci id="S2.SS2.SSS2.p3.4.m4.1.1.3.cmml" xref="S2.SS2.SSS2.p3.4.m4.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.4.m4.1c">\mathcal{A}_{e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.4.m4.1d">caligraphic_A start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> only. In this way, we are only required to store one FFN replica keeping the model size unchanged except for the increase in the parameters in the adapter and the router modules. The rest of the layers, such as Norm and Attention, are copied from the dense model.</p>
</div>
<div class="ltx_para" id="S2.SS2.SSS2.p4">
<p class="ltx_p" id="S2.SS2.SSS2.p4.6">For a given input <math alttext="x" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p4.1.m1.1"><semantics id="S2.SS2.SSS2.p4.1.m1.1a"><mi id="S2.SS2.SSS2.p4.1.m1.1.1" xref="S2.SS2.SSS2.p4.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.1.m1.1b"><ci id="S2.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p4.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p4.1.m1.1d">italic_x</annotation></semantics></math>, the router module <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p4.2.m2.1"><semantics id="S2.SS2.SSS2.p4.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p4.2.m2.1.1" xref="S2.SS2.SSS2.p4.2.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.2.m2.1b"><ci id="S2.SS2.SSS2.p4.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p4.2.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.2.m2.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p4.2.m2.1d">caligraphic_R</annotation></semantics></math> activates <math alttext="\texttt{Top-}k" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p4.3.m3.1"><semantics id="S2.SS2.SSS2.p4.3.m3.1a"><mrow id="S2.SS2.SSS2.p4.3.m3.1.1" xref="S2.SS2.SSS2.p4.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S2.SS2.SSS2.p4.3.m3.1.1.2" xref="S2.SS2.SSS2.p4.3.m3.1.1.2a.cmml">Top-</mtext><mo id="S2.SS2.SSS2.p4.3.m3.1.1.1" xref="S2.SS2.SSS2.p4.3.m3.1.1.1.cmml">⁢</mo><mi id="S2.SS2.SSS2.p4.3.m3.1.1.3" xref="S2.SS2.SSS2.p4.3.m3.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.3.m3.1b"><apply id="S2.SS2.SSS2.p4.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p4.3.m3.1.1"><times id="S2.SS2.SSS2.p4.3.m3.1.1.1.cmml" xref="S2.SS2.SSS2.p4.3.m3.1.1.1"></times><ci id="S2.SS2.SSS2.p4.3.m3.1.1.2a.cmml" xref="S2.SS2.SSS2.p4.3.m3.1.1.2"><mtext class="ltx_mathvariant_monospace" id="S2.SS2.SSS2.p4.3.m3.1.1.2.cmml" xref="S2.SS2.SSS2.p4.3.m3.1.1.2">Top-</mtext></ci><ci id="S2.SS2.SSS2.p4.3.m3.1.1.3.cmml" xref="S2.SS2.SSS2.p4.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.3.m3.1c">\texttt{Top-}k</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p4.3.m3.1d">Top- italic_k</annotation></semantics></math> experts out of <math alttext="N_{E}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p4.4.m4.1"><semantics id="S2.SS2.SSS2.p4.4.m4.1a"><msub id="S2.SS2.SSS2.p4.4.m4.1.1" xref="S2.SS2.SSS2.p4.4.m4.1.1.cmml"><mi id="S2.SS2.SSS2.p4.4.m4.1.1.2" xref="S2.SS2.SSS2.p4.4.m4.1.1.2.cmml">N</mi><mi id="S2.SS2.SSS2.p4.4.m4.1.1.3" xref="S2.SS2.SSS2.p4.4.m4.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.4.m4.1b"><apply id="S2.SS2.SSS2.p4.4.m4.1.1.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.4.m4.1.1.1.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p4.4.m4.1.1.2.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1.2">𝑁</ci><ci id="S2.SS2.SSS2.p4.4.m4.1.1.3.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.4.m4.1c">N_{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p4.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT</annotation></semantics></math> experts based on the normalized output <math alttext="x_{in}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p4.5.m5.1"><semantics id="S2.SS2.SSS2.p4.5.m5.1a"><msub id="S2.SS2.SSS2.p4.5.m5.1.1" xref="S2.SS2.SSS2.p4.5.m5.1.1.cmml"><mi id="S2.SS2.SSS2.p4.5.m5.1.1.2" xref="S2.SS2.SSS2.p4.5.m5.1.1.2.cmml">x</mi><mrow id="S2.SS2.SSS2.p4.5.m5.1.1.3" xref="S2.SS2.SSS2.p4.5.m5.1.1.3.cmml"><mi id="S2.SS2.SSS2.p4.5.m5.1.1.3.2" xref="S2.SS2.SSS2.p4.5.m5.1.1.3.2.cmml">i</mi><mo id="S2.SS2.SSS2.p4.5.m5.1.1.3.1" xref="S2.SS2.SSS2.p4.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.SSS2.p4.5.m5.1.1.3.3" xref="S2.SS2.SSS2.p4.5.m5.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.5.m5.1b"><apply id="S2.SS2.SSS2.p4.5.m5.1.1.cmml" xref="S2.SS2.SSS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.5.m5.1.1.1.cmml" xref="S2.SS2.SSS2.p4.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p4.5.m5.1.1.2.cmml" xref="S2.SS2.SSS2.p4.5.m5.1.1.2">𝑥</ci><apply id="S2.SS2.SSS2.p4.5.m5.1.1.3.cmml" xref="S2.SS2.SSS2.p4.5.m5.1.1.3"><times id="S2.SS2.SSS2.p4.5.m5.1.1.3.1.cmml" xref="S2.SS2.SSS2.p4.5.m5.1.1.3.1"></times><ci id="S2.SS2.SSS2.p4.5.m5.1.1.3.2.cmml" xref="S2.SS2.SSS2.p4.5.m5.1.1.3.2">𝑖</ci><ci id="S2.SS2.SSS2.p4.5.m5.1.1.3.3.cmml" xref="S2.SS2.SSS2.p4.5.m5.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.5.m5.1c">x_{in}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p4.5.m5.1d">italic_x start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> of the attention layer. Given <math alttext="W_{|\cdot|}" class="ltx_math_unparsed" display="inline" id="S2.SS2.SSS2.p4.6.m6.1"><semantics id="S2.SS2.SSS2.p4.6.m6.1a"><msub id="S2.SS2.SSS2.p4.6.m6.1.1"><mi id="S2.SS2.SSS2.p4.6.m6.1.1.2">W</mi><mrow id="S2.SS2.SSS2.p4.6.m6.1.1.3"><mo fence="false" id="S2.SS2.SSS2.p4.6.m6.1.1.3.1" stretchy="false">|</mo><mo id="S2.SS2.SSS2.p4.6.m6.1.1.3.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S2.SS2.SSS2.p4.6.m6.1.1.3.3" stretchy="false">|</mo></mrow></msub><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.6.m6.1b">W_{|\cdot|}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p4.6.m6.1c">italic_W start_POSTSUBSCRIPT | ⋅ | end_POSTSUBSCRIPT</annotation></semantics></math> denotes the weight of the corresponding expert module, we define the router module as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{R}(x_{in})=\text{Softmax}(\texttt{Top-}k(W_{\mathcal{R}}\cdot x_{in}))" class="ltx_Math" display="block" id="S2.E1.m1.2"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.1.3" xref="S2.E1.m1.1.1.1.3.cmml">ℛ</mi><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S2.E1.m1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S2.E1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.3" xref="S2.E1.m1.2.2.3.cmml">=</mo><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><mtext id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3a.cmml">Softmax</mtext><mo id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.2.1.1" xref="S2.E1.m1.2.2.2.1.1.1.cmml"><mo id="S2.E1.m1.2.2.2.1.1.2" stretchy="false" xref="S2.E1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.2.2.2.1.1.1" xref="S2.E1.m1.2.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S2.E1.m1.2.2.2.1.1.1.3" xref="S2.E1.m1.2.2.2.1.1.1.3a.cmml">Top-</mtext><mo id="S2.E1.m1.2.2.2.1.1.1.2" xref="S2.E1.m1.2.2.2.1.1.1.2.cmml">⁢</mo><mi id="S2.E1.m1.2.2.2.1.1.1.4" xref="S2.E1.m1.2.2.2.1.1.1.4.cmml">k</mi><mo id="S2.E1.m1.2.2.2.1.1.1.2a" xref="S2.E1.m1.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.2.1.1.1.1.1" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.2.2.2.1.1.1.1.1.1" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.2.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.2.2.2.1.1.1.1.1.1.2.2" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.2.2.cmml">W</mi><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.2.1.1.1.1.1.1.2.3" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.2.3.cmml">ℛ</mi></msub><mo id="S2.E1.m1.2.2.2.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.1.cmml">⋅</mo><msub id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.2" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.1" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.3.cmml">n</mi></mrow></msub></mrow><mo id="S2.E1.m1.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.2.1.1.3" stretchy="false" xref="S2.E1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><eq id="S2.E1.m1.2.2.3.cmml" xref="S2.E1.m1.2.2.3"></eq><apply id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><times id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.2"></times><ci id="S2.E1.m1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.3">ℛ</ci><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2">𝑥</ci><apply id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3"><times id="S2.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.1"></times><ci id="S2.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><times id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2"></times><ci id="S2.E1.m1.2.2.2.3a.cmml" xref="S2.E1.m1.2.2.2.3"><mtext id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3">Softmax</mtext></ci><apply id="S2.E1.m1.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.2.1.1"><times id="S2.E1.m1.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.1.1.1.2"></times><ci id="S2.E1.m1.2.2.2.1.1.1.3a.cmml" xref="S2.E1.m1.2.2.2.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S2.E1.m1.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.1.1.1.3">Top-</mtext></ci><ci id="S2.E1.m1.2.2.2.1.1.1.4.cmml" xref="S2.E1.m1.2.2.2.1.1.1.4">𝑘</ci><apply id="S2.E1.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1"><ci id="S2.E1.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.1">⋅</ci><apply id="S2.E1.m1.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.2.2">𝑊</ci><ci id="S2.E1.m1.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.2.3">ℛ</ci></apply><apply id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3"><times id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.2.2.2.1.1.1.1.1.1.3.3.3">𝑛</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">\mathcal{R}(x_{in})=\text{Softmax}(\texttt{Top-}k(W_{\mathcal{R}}\cdot x_{in}))</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.2d">caligraphic_R ( italic_x start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT ) = Softmax ( Top- italic_k ( italic_W start_POSTSUBSCRIPT caligraphic_R end_POSTSUBSCRIPT ⋅ italic_x start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS2.SSS2.p5">
<p class="ltx_p" id="S2.SS2.SSS2.p5.1">We formulate the adapter <math alttext="\mathcal{A}_{e}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p5.1.m1.1"><semantics id="S2.SS2.SSS2.p5.1.m1.1a"><msub id="S2.SS2.SSS2.p5.1.m1.1.1" xref="S2.SS2.SSS2.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p5.1.m1.1.1.2" xref="S2.SS2.SSS2.p5.1.m1.1.1.2.cmml">𝒜</mi><mi id="S2.SS2.SSS2.p5.1.m1.1.1.3" xref="S2.SS2.SSS2.p5.1.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p5.1.m1.1b"><apply id="S2.SS2.SSS2.p5.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p5.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p5.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p5.1.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p5.1.m1.1.1.2">𝒜</ci><ci id="S2.SS2.SSS2.p5.1.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p5.1.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p5.1.m1.1c">\mathcal{A}_{e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p5.1.m1.1d">caligraphic_A start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{A}_{e}(x)=\sigma(xW_{e}^{down}){W_{e}^{up}}+x." class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1.3" xref="S2.E2.m1.2.2.1.1.3.cmml"><msub id="S2.E2.m1.2.2.1.1.3.2" xref="S2.E2.m1.2.2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.2.2.1.1.3.2.2" xref="S2.E2.m1.2.2.1.1.3.2.2.cmml">𝒜</mi><mi id="S2.E2.m1.2.2.1.1.3.2.3" xref="S2.E2.m1.2.2.1.1.3.2.3.cmml">e</mi></msub><mo id="S2.E2.m1.2.2.1.1.3.1" xref="S2.E2.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.3.3.2" xref="S2.E2.m1.2.2.1.1.3.cmml"><mo id="S2.E2.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S2.E2.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">x</mi><mo id="S2.E2.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S2.E2.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.2" xref="S2.E2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.3.cmml">σ</mi><mo id="S2.E2.m1.2.2.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml">x</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2.3.cmml">e</mi><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml">d</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml">o</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.1a" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.4" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.4.cmml">w</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.1b" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.5" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.5.cmml">n</mi></mrow></msubsup></mrow><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E2.m1.2.2.1.1.1.1.2a" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml">⁢</mo><msubsup id="S2.E2.m1.2.2.1.1.1.1.4" xref="S2.E2.m1.2.2.1.1.1.1.4.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.4.2.2" xref="S2.E2.m1.2.2.1.1.1.1.4.2.2.cmml">W</mi><mi id="S2.E2.m1.2.2.1.1.1.1.4.2.3" xref="S2.E2.m1.2.2.1.1.1.1.4.2.3.cmml">e</mi><mrow id="S2.E2.m1.2.2.1.1.1.1.4.3" xref="S2.E2.m1.2.2.1.1.1.1.4.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.4.3.2" xref="S2.E2.m1.2.2.1.1.1.1.4.3.2.cmml">u</mi><mo id="S2.E2.m1.2.2.1.1.1.1.4.3.1" xref="S2.E2.m1.2.2.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.1.1.4.3.3" xref="S2.E2.m1.2.2.1.1.1.1.4.3.3.cmml">p</mi></mrow></msubsup></mrow><mo id="S2.E2.m1.2.2.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.2.cmml">+</mo><mi id="S2.E2.m1.2.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.3.cmml">x</mi></mrow></mrow><mo id="S2.E2.m1.2.2.1.2" lspace="0em" xref="S2.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1"><eq id="S2.E2.m1.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2"></eq><apply id="S2.E2.m1.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.3"><times id="S2.E2.m1.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.3.1"></times><apply id="S2.E2.m1.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.3.2.1.cmml" xref="S2.E2.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.3.2.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2.2">𝒜</ci><ci id="S2.E2.m1.2.2.1.1.3.2.3.cmml" xref="S2.E2.m1.2.2.1.1.3.2.3">𝑒</ci></apply><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝑥</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><plus id="S2.E2.m1.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.2"></plus><apply id="S2.E2.m1.2.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1"><times id="S2.E2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2"></times><ci id="S2.E2.m1.2.2.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3">𝜎</ci><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1"><times id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1"></times><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2.2">𝑊</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2.3">𝑒</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3"><times id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.2">𝑑</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.3">𝑜</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.4.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.4">𝑤</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.5.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.5">𝑛</ci></apply></apply></apply><apply id="S2.E2.m1.2.2.1.1.1.1.4.cmml" xref="S2.E2.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.4.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.4">superscript</csymbol><apply id="S2.E2.m1.2.2.1.1.1.1.4.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.4.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.4.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.4.2.2">𝑊</ci><ci id="S2.E2.m1.2.2.1.1.1.1.4.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.4.2.3">𝑒</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.1.4.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.4.3"><times id="S2.E2.m1.2.2.1.1.1.1.4.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.4.3.1"></times><ci id="S2.E2.m1.2.2.1.1.1.1.4.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.4.3.2">𝑢</ci><ci id="S2.E2.m1.2.2.1.1.1.1.4.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.4.3.3">𝑝</ci></apply></apply></apply><ci id="S2.E2.m1.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">\mathcal{A}_{e}(x)=\sigma(xW_{e}^{down}){W_{e}^{up}}+x.</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">caligraphic_A start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( italic_x ) = italic_σ ( italic_x italic_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d italic_o italic_w italic_n end_POSTSUPERSCRIPT ) italic_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u italic_p end_POSTSUPERSCRIPT + italic_x .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS2.SSS2.p6">
<p class="ltx_p" id="S2.SS2.SSS2.p6.3">The efficiency of <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS2.p6.3.1">Open-RAG</span> model results from the setup that
<math alttext="|\theta_{e}|=|W_{e}^{down}|+|W_{e}^{up}|\ll|\phi_{o}|" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p6.1.m1.4"><semantics id="S2.SS2.SSS2.p6.1.m1.4a"><mrow id="S2.SS2.SSS2.p6.1.m1.4.4" xref="S2.SS2.SSS2.p6.1.m1.4.4.cmml"><mrow id="S2.SS2.SSS2.p6.1.m1.1.1.1.1" xref="S2.SS2.SSS2.p6.1.m1.1.1.1.2.cmml"><mo id="S2.SS2.SSS2.p6.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS2.SSS2.p6.1.m1.1.1.1.2.1.cmml">|</mo><msub id="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1" xref="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1.2" xref="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1.3" xref="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S2.SS2.SSS2.p6.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS2.SSS2.p6.1.m1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.SS2.SSS2.p6.1.m1.4.4.6" xref="S2.SS2.SSS2.p6.1.m1.4.4.6.cmml">=</mo><mrow id="S2.SS2.SSS2.p6.1.m1.3.3.3" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.cmml"><mrow id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.2.cmml"><mo id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.2" stretchy="false" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.2.1.cmml">|</mo><msubsup id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.cmml"><mi id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.2.2" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.2.2.cmml">W</mi><mi id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.2.3" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.2.3.cmml">e</mi><mrow id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.cmml"><mi id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.2" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.2.cmml">d</mi><mo id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.1" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.3" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.3.cmml">o</mi><mo id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.1a" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.4" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.4.cmml">w</mi><mo id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.1b" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.5" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.5.cmml">n</mi></mrow></msubsup><mo id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.3" stretchy="false" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.2.1.cmml">|</mo></mrow><mo id="S2.SS2.SSS2.p6.1.m1.3.3.3.3" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.3.cmml">+</mo><mrow id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.2.cmml"><mo id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.2" stretchy="false" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.2.1.cmml">|</mo><msubsup id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.cmml"><mi id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.2.2" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.2.2.cmml">W</mi><mi id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.2.3" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.2.3.cmml">e</mi><mrow id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.cmml"><mi id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.2" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.2.cmml">u</mi><mo id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.1" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.3" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.3.cmml">p</mi></mrow></msubsup><mo id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.3" stretchy="false" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.2.1.cmml">|</mo></mrow></mrow><mo id="S2.SS2.SSS2.p6.1.m1.4.4.7" xref="S2.SS2.SSS2.p6.1.m1.4.4.7.cmml">≪</mo><mrow id="S2.SS2.SSS2.p6.1.m1.4.4.4.1" xref="S2.SS2.SSS2.p6.1.m1.4.4.4.2.cmml"><mo id="S2.SS2.SSS2.p6.1.m1.4.4.4.1.2" stretchy="false" xref="S2.SS2.SSS2.p6.1.m1.4.4.4.2.1.cmml">|</mo><msub id="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1" xref="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1.cmml"><mi id="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1.2" xref="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1.2.cmml">ϕ</mi><mi id="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1.3" xref="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1.3.cmml">o</mi></msub><mo id="S2.SS2.SSS2.p6.1.m1.4.4.4.1.3" stretchy="false" xref="S2.SS2.SSS2.p6.1.m1.4.4.4.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p6.1.m1.4b"><apply id="S2.SS2.SSS2.p6.1.m1.4.4.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4"><and id="S2.SS2.SSS2.p6.1.m1.4.4a.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4"></and><apply id="S2.SS2.SSS2.p6.1.m1.4.4b.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4"><eq id="S2.SS2.SSS2.p6.1.m1.4.4.6.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4.6"></eq><apply id="S2.SS2.SSS2.p6.1.m1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p6.1.m1.1.1.1.1"><abs id="S2.SS2.SSS2.p6.1.m1.1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.1.1.1.1.2"></abs><apply id="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1.2">𝜃</ci><ci id="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p6.1.m1.1.1.1.1.1.3">𝑒</ci></apply></apply><apply id="S2.SS2.SSS2.p6.1.m1.3.3.3.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3"><plus id="S2.SS2.SSS2.p6.1.m1.3.3.3.3.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.3"></plus><apply id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.2.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1"><abs id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.2.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.2"></abs><apply id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.2.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.2.2">𝑊</ci><ci id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.2.3">𝑒</ci></apply><apply id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3"><times id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.1"></times><ci id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.2">𝑑</ci><ci id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.3.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.3">𝑜</ci><ci id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.4.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.4">𝑤</ci><ci id="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.5.cmml" xref="S2.SS2.SSS2.p6.1.m1.2.2.2.1.1.1.3.5">𝑛</ci></apply></apply></apply><apply id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.2.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1"><abs id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.2.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.2"></abs><apply id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.2.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.2.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.2.2.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.2.2">𝑊</ci><ci id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.2.3.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.2.3">𝑒</ci></apply><apply id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3"><times id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.1"></times><ci id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.2.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.2">𝑢</ci><ci id="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.3.cmml" xref="S2.SS2.SSS2.p6.1.m1.3.3.3.2.1.1.3.3">𝑝</ci></apply></apply></apply></apply></apply><apply id="S2.SS2.SSS2.p6.1.m1.4.4c.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4"><csymbol cd="latexml" id="S2.SS2.SSS2.p6.1.m1.4.4.7.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4.7">much-less-than</csymbol><share href="https://arxiv.org/html/2410.01782v1#S2.SS2.SSS2.p6.1.m1.3.3.3.cmml" id="S2.SS2.SSS2.p6.1.m1.4.4d.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4"></share><apply id="S2.SS2.SSS2.p6.1.m1.4.4.4.2.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4.4.1"><abs id="S2.SS2.SSS2.p6.1.m1.4.4.4.2.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4.4.1.2"></abs><apply id="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1.1.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1.2.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1.2">italic-ϕ</ci><ci id="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1.3.cmml" xref="S2.SS2.SSS2.p6.1.m1.4.4.4.1.1.3">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p6.1.m1.4c">|\theta_{e}|=|W_{e}^{down}|+|W_{e}^{up}|\ll|\phi_{o}|</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p6.1.m1.4d">| italic_θ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT | = | italic_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d italic_o italic_w italic_n end_POSTSUPERSCRIPT | + | italic_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u italic_p end_POSTSUPERSCRIPT | ≪ | italic_ϕ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT |</annotation></semantics></math>
where we keep <math alttext="\phi_{o}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p6.2.m2.1"><semantics id="S2.SS2.SSS2.p6.2.m2.1a"><msub id="S2.SS2.SSS2.p6.2.m2.1.1" xref="S2.SS2.SSS2.p6.2.m2.1.1.cmml"><mi id="S2.SS2.SSS2.p6.2.m2.1.1.2" xref="S2.SS2.SSS2.p6.2.m2.1.1.2.cmml">ϕ</mi><mi id="S2.SS2.SSS2.p6.2.m2.1.1.3" xref="S2.SS2.SSS2.p6.2.m2.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p6.2.m2.1b"><apply id="S2.SS2.SSS2.p6.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p6.2.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p6.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p6.2.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p6.2.m2.1.1.2">italic-ϕ</ci><ci id="S2.SS2.SSS2.p6.2.m2.1.1.3.cmml" xref="S2.SS2.SSS2.p6.2.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p6.2.m2.1c">\phi_{o}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p6.2.m2.1d">italic_ϕ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math> from the
dense LLM frozen during fine-tuning. Finally, we express the output <math alttext="y" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p6.3.m3.1"><semantics id="S2.SS2.SSS2.p6.3.m3.1a"><mi id="S2.SS2.SSS2.p6.3.m3.1.1" xref="S2.SS2.SSS2.p6.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p6.3.m3.1b"><ci id="S2.SS2.SSS2.p6.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p6.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p6.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p6.3.m3.1d">italic_y</annotation></semantics></math> of a parameter-efficient expert module as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="y=\sum_{e=1}^{N_{E}}\mathcal{R}(x)_{e}\mathcal{A}_{e}(\mathcal{E}_{e}(x))." class="ltx_Math" display="block" id="S2.E3.m1.3"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.3" xref="S2.E3.m1.3.3.1.1.3.cmml">y</mi><mo id="S2.E3.m1.3.3.1.1.2" rspace="0.111em" xref="S2.E3.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.3.3.1.1.1" xref="S2.E3.m1.3.3.1.1.1.cmml"><munderover id="S2.E3.m1.3.3.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.2.cmml"><mo id="S2.E3.m1.3.3.1.1.1.2.2.2" movablelimits="false" xref="S2.E3.m1.3.3.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m1.3.3.1.1.1.2.2.3" xref="S2.E3.m1.3.3.1.1.1.2.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.2.2.3.2" xref="S2.E3.m1.3.3.1.1.1.2.2.3.2.cmml">e</mi><mo id="S2.E3.m1.3.3.1.1.1.2.2.3.1" xref="S2.E3.m1.3.3.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m1.3.3.1.1.1.2.2.3.3" xref="S2.E3.m1.3.3.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S2.E3.m1.3.3.1.1.1.2.3" xref="S2.E3.m1.3.3.1.1.1.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.2.3.2" xref="S2.E3.m1.3.3.1.1.1.2.3.2.cmml">N</mi><mi id="S2.E3.m1.3.3.1.1.1.2.3.3" xref="S2.E3.m1.3.3.1.1.1.2.3.3.cmml">E</mi></msub></munderover><mrow id="S2.E3.m1.3.3.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.3.3.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.3.cmml">ℛ</mi><mo id="S2.E3.m1.3.3.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.2.cmml">⁢</mo><msub id="S2.E3.m1.3.3.1.1.1.1.4" xref="S2.E3.m1.3.3.1.1.1.1.4.cmml"><mrow id="S2.E3.m1.3.3.1.1.1.1.4.2.2" xref="S2.E3.m1.3.3.1.1.1.1.4.cmml"><mo id="S2.E3.m1.3.3.1.1.1.1.4.2.2.1" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.4.cmml">(</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">x</mi><mo id="S2.E3.m1.3.3.1.1.1.1.4.2.2.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.4.cmml">)</mo></mrow><mi id="S2.E3.m1.3.3.1.1.1.1.4.3" xref="S2.E3.m1.3.3.1.1.1.1.4.3.cmml">e</mi></msub><mo id="S2.E3.m1.3.3.1.1.1.1.2a" xref="S2.E3.m1.3.3.1.1.1.1.2.cmml">⁢</mo><msub id="S2.E3.m1.3.3.1.1.1.1.5" xref="S2.E3.m1.3.3.1.1.1.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.3.3.1.1.1.1.5.2" xref="S2.E3.m1.3.3.1.1.1.1.5.2.cmml">𝒜</mi><mi id="S2.E3.m1.3.3.1.1.1.1.5.3" xref="S2.E3.m1.3.3.1.1.1.1.5.3.cmml">e</mi></msub><mo id="S2.E3.m1.3.3.1.1.1.1.2b" xref="S2.E3.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">ℰ</mi><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">e</mi></msub><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">x</mi><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.2" lspace="0em" xref="S2.E3.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1"><eq id="S2.E3.m1.3.3.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2"></eq><ci id="S2.E3.m1.3.3.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.3">𝑦</ci><apply id="S2.E3.m1.3.3.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1"><apply id="S2.E3.m1.3.3.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.3.3.1.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S2.E3.m1.3.3.1.1.1.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.1.2.2.2"></sum><apply id="S2.E3.m1.3.3.1.1.1.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.1.2.2.3"><eq id="S2.E3.m1.3.3.1.1.1.2.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m1.3.3.1.1.1.2.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.2.2.3.2">𝑒</ci><cn id="S2.E3.m1.3.3.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E3.m1.3.3.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E3.m1.3.3.1.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.2.3">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.2.3.2">𝑁</ci><ci id="S2.E3.m1.3.3.1.1.1.2.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.2.3.3">𝐸</ci></apply></apply><apply id="S2.E3.m1.3.3.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1"><times id="S2.E3.m1.3.3.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.2"></times><ci id="S2.E3.m1.3.3.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3">ℛ</ci><apply id="S2.E3.m1.3.3.1.1.1.1.4.cmml" xref="S2.E3.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.4.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝑥</ci><ci id="S2.E3.m1.3.3.1.1.1.1.4.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.4.3">𝑒</ci></apply><apply id="S2.E3.m1.3.3.1.1.1.1.5.cmml" xref="S2.E3.m1.3.3.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.5.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.5">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.5.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.5.2">𝒜</ci><ci id="S2.E3.m1.3.3.1.1.1.1.5.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.5.3">𝑒</ci></apply><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1"><times id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1"></times><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.2">ℰ</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.3">𝑒</ci></apply><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">y=\sum_{e=1}^{N_{E}}\mathcal{R}(x)_{e}\mathcal{A}_{e}(\mathcal{E}_{e}(x)).</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.3d">italic_y = ∑ start_POSTSUBSCRIPT italic_e = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT end_POSTSUPERSCRIPT caligraphic_R ( italic_x ) start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( caligraphic_E start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( italic_x ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS2.SSS2.p7">
<p class="ltx_p" id="S2.SS2.SSS2.p7.5">In our implementation, we use <math alttext="N_{E}=8" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p7.1.m1.1"><semantics id="S2.SS2.SSS2.p7.1.m1.1a"><mrow id="S2.SS2.SSS2.p7.1.m1.1.1" xref="S2.SS2.SSS2.p7.1.m1.1.1.cmml"><msub id="S2.SS2.SSS2.p7.1.m1.1.1.2" xref="S2.SS2.SSS2.p7.1.m1.1.1.2.cmml"><mi id="S2.SS2.SSS2.p7.1.m1.1.1.2.2" xref="S2.SS2.SSS2.p7.1.m1.1.1.2.2.cmml">N</mi><mi id="S2.SS2.SSS2.p7.1.m1.1.1.2.3" xref="S2.SS2.SSS2.p7.1.m1.1.1.2.3.cmml">E</mi></msub><mo id="S2.SS2.SSS2.p7.1.m1.1.1.1" xref="S2.SS2.SSS2.p7.1.m1.1.1.1.cmml">=</mo><mn id="S2.SS2.SSS2.p7.1.m1.1.1.3" xref="S2.SS2.SSS2.p7.1.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p7.1.m1.1b"><apply id="S2.SS2.SSS2.p7.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p7.1.m1.1.1"><eq id="S2.SS2.SSS2.p7.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p7.1.m1.1.1.1"></eq><apply id="S2.SS2.SSS2.p7.1.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p7.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p7.1.m1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p7.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS2.SSS2.p7.1.m1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p7.1.m1.1.1.2.2">𝑁</ci><ci id="S2.SS2.SSS2.p7.1.m1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p7.1.m1.1.1.2.3">𝐸</ci></apply><cn id="S2.SS2.SSS2.p7.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p7.1.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p7.1.m1.1c">N_{E}=8</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p7.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT = 8</annotation></semantics></math> and <math alttext="k=2" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p7.2.m2.1"><semantics id="S2.SS2.SSS2.p7.2.m2.1a"><mrow id="S2.SS2.SSS2.p7.2.m2.1.1" xref="S2.SS2.SSS2.p7.2.m2.1.1.cmml"><mi id="S2.SS2.SSS2.p7.2.m2.1.1.2" xref="S2.SS2.SSS2.p7.2.m2.1.1.2.cmml">k</mi><mo id="S2.SS2.SSS2.p7.2.m2.1.1.1" xref="S2.SS2.SSS2.p7.2.m2.1.1.1.cmml">=</mo><mn id="S2.SS2.SSS2.p7.2.m2.1.1.3" xref="S2.SS2.SSS2.p7.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p7.2.m2.1b"><apply id="S2.SS2.SSS2.p7.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p7.2.m2.1.1"><eq id="S2.SS2.SSS2.p7.2.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p7.2.m2.1.1.1"></eq><ci id="S2.SS2.SSS2.p7.2.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p7.2.m2.1.1.2">𝑘</ci><cn id="S2.SS2.SSS2.p7.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p7.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p7.2.m2.1c">k=2</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p7.2.m2.1d">italic_k = 2</annotation></semantics></math> if not otherwise specified. In other words, only <math alttext="2" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p7.3.m3.1"><semantics id="S2.SS2.SSS2.p7.3.m3.1a"><mn id="S2.SS2.SSS2.p7.3.m3.1.1" xref="S2.SS2.SSS2.p7.3.m3.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p7.3.m3.1b"><cn id="S2.SS2.SSS2.p7.3.m3.1.1.cmml" type="integer" xref="S2.SS2.SSS2.p7.3.m3.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p7.3.m3.1c">2</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p7.3.m3.1d">2</annotation></semantics></math> of the <math alttext="8" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p7.4.m4.1"><semantics id="S2.SS2.SSS2.p7.4.m4.1a"><mn id="S2.SS2.SSS2.p7.4.m4.1.1" xref="S2.SS2.SSS2.p7.4.m4.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p7.4.m4.1b"><cn id="S2.SS2.SSS2.p7.4.m4.1.1.cmml" type="integer" xref="S2.SS2.SSS2.p7.4.m4.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p7.4.m4.1c">8</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p7.4.m4.1d">8</annotation></semantics></math> experts are active during training and inference. We train <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS2.p7.5.1">Open-RAG</span> with QLoRA <cite class="ltx_cite ltx_citemacro_cite">Dettmers et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib7" title="">2023</a>)</cite> adapters during fine-tuning which has a
load-balancing objective along with the standard conditional language modeling objective. To mitigate the approximation error in the expert adapters, we use the adapters with a dimension of <math alttext="512" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p7.5.m5.1"><semantics id="S2.SS2.SSS2.p7.5.m5.1a"><mn id="S2.SS2.SSS2.p7.5.m5.1.1" xref="S2.SS2.SSS2.p7.5.m5.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p7.5.m5.1b"><cn id="S2.SS2.SSS2.p7.5.m5.1.1.cmml" type="integer" xref="S2.SS2.SSS2.p7.5.m5.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p7.5.m5.1c">512</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p7.5.m5.1d">512</annotation></semantics></math> by default.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Hybrid Approach for Adaptive Retrieval</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Since LLMs possess different parametric knowledge, instead of using other LLMs, we propose a hybrid adaptive retrieval method with two threshold alternatives based on model confidence to determine retrieval on-demand and balance performance speed. We take motivation from both control token-based  <cite class="ltx_cite ltx_citemacro_citep">(Asai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib2" title="">2024</a>; Lu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib23" title="">2022</a>)</cite> and confidence-based  <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib22" title="">2023</a>); Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib14" title="">2023a</a>)</cite> inference methods.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.6">During training, <math alttext="\mathcal{M}_{G}" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><msub id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">ℳ</mi><mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2">ℳ</ci><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">\mathcal{M}_{G}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math>  learns to generate <em class="ltx_emph ltx_font_italic" id="S2.SS3.p2.6.1">Retrieval</em> reflection tokens (<span class="ltx_text ltx_font_typewriter" id="S2.SS3.p2.6.2">[RT]</span> and <span class="ltx_text ltx_font_typewriter" id="S2.SS3.p2.6.3">[NoRT]</span>). At inference, we measure the confidence of the output sequence <math alttext="o" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1"><semantics id="S2.SS3.p2.2.m2.1a"><mi id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><ci id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">o</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">italic_o</annotation></semantics></math> conditioned on an enforced no retrieval setting by adding <span class="ltx_text ltx_font_typewriter" id="S2.SS3.p2.6.4">[NoRT]</span> to the input, such that <math alttext="\hat{q}=q\oplus\texttt{[NoRT]}" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m3.1"><semantics id="S2.SS3.p2.3.m3.1a"><mrow id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><mover accent="true" id="S2.SS3.p2.3.m3.1.1.2" xref="S2.SS3.p2.3.m3.1.1.2.cmml"><mi id="S2.SS3.p2.3.m3.1.1.2.2" xref="S2.SS3.p2.3.m3.1.1.2.2.cmml">q</mi><mo id="S2.SS3.p2.3.m3.1.1.2.1" xref="S2.SS3.p2.3.m3.1.1.2.1.cmml">^</mo></mover><mo id="S2.SS3.p2.3.m3.1.1.1" xref="S2.SS3.p2.3.m3.1.1.1.cmml">=</mo><mrow id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml"><mi id="S2.SS3.p2.3.m3.1.1.3.2" xref="S2.SS3.p2.3.m3.1.1.3.2.cmml">q</mi><mo id="S2.SS3.p2.3.m3.1.1.3.1" xref="S2.SS3.p2.3.m3.1.1.3.1.cmml">⊕</mo><mtext class="ltx_mathvariant_monospace" id="S2.SS3.p2.3.m3.1.1.3.3" xref="S2.SS3.p2.3.m3.1.1.3.3a.cmml">[NoRT]</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><eq id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1.1"></eq><apply id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2"><ci id="S2.SS3.p2.3.m3.1.1.2.1.cmml" xref="S2.SS3.p2.3.m3.1.1.2.1">^</ci><ci id="S2.SS3.p2.3.m3.1.1.2.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2.2">𝑞</ci></apply><apply id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3"><csymbol cd="latexml" id="S2.SS3.p2.3.m3.1.1.3.1.cmml" xref="S2.SS3.p2.3.m3.1.1.3.1">direct-sum</csymbol><ci id="S2.SS3.p2.3.m3.1.1.3.2.cmml" xref="S2.SS3.p2.3.m3.1.1.3.2">𝑞</ci><ci id="S2.SS3.p2.3.m3.1.1.3.3a.cmml" xref="S2.SS3.p2.3.m3.1.1.3.3"><mtext class="ltx_mathvariant_monospace" id="S2.SS3.p2.3.m3.1.1.3.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3.3">[NoRT]</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">\hat{q}=q\oplus\texttt{[NoRT]}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m3.1d">over^ start_ARG italic_q end_ARG = italic_q ⊕ [NoRT]</annotation></semantics></math>. We design two different confidence scores <math alttext="f_{|\cdot|}" class="ltx_math_unparsed" display="inline" id="S2.SS3.p2.4.m4.1"><semantics id="S2.SS3.p2.4.m4.1a"><msub id="S2.SS3.p2.4.m4.1.1"><mi id="S2.SS3.p2.4.m4.1.1.2">f</mi><mrow id="S2.SS3.p2.4.m4.1.1.3"><mo fence="false" id="S2.SS3.p2.4.m4.1.1.3.1" stretchy="false">|</mo><mo id="S2.SS3.p2.4.m4.1.1.3.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S2.SS3.p2.4.m4.1.1.3.3" stretchy="false">|</mo></mrow></msub><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1b">f_{|\cdot|}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.4.m4.1c">italic_f start_POSTSUBSCRIPT | ⋅ | end_POSTSUBSCRIPT</annotation></semantics></math>: (i) <math alttext="f_{minp}" class="ltx_Math" display="inline" id="S2.SS3.p2.5.m5.1"><semantics id="S2.SS3.p2.5.m5.1a"><msub id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml"><mi id="S2.SS3.p2.5.m5.1.1.2" xref="S2.SS3.p2.5.m5.1.1.2.cmml">f</mi><mrow id="S2.SS3.p2.5.m5.1.1.3" xref="S2.SS3.p2.5.m5.1.1.3.cmml"><mi id="S2.SS3.p2.5.m5.1.1.3.2" xref="S2.SS3.p2.5.m5.1.1.3.2.cmml">m</mi><mo id="S2.SS3.p2.5.m5.1.1.3.1" xref="S2.SS3.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.5.m5.1.1.3.3" xref="S2.SS3.p2.5.m5.1.1.3.3.cmml">i</mi><mo id="S2.SS3.p2.5.m5.1.1.3.1a" xref="S2.SS3.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.5.m5.1.1.3.4" xref="S2.SS3.p2.5.m5.1.1.3.4.cmml">n</mi><mo id="S2.SS3.p2.5.m5.1.1.3.1b" xref="S2.SS3.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.5.m5.1.1.3.5" xref="S2.SS3.p2.5.m5.1.1.3.5.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.1b"><apply id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.1.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS3.p2.5.m5.1.1.2.cmml" xref="S2.SS3.p2.5.m5.1.1.2">𝑓</ci><apply id="S2.SS3.p2.5.m5.1.1.3.cmml" xref="S2.SS3.p2.5.m5.1.1.3"><times id="S2.SS3.p2.5.m5.1.1.3.1.cmml" xref="S2.SS3.p2.5.m5.1.1.3.1"></times><ci id="S2.SS3.p2.5.m5.1.1.3.2.cmml" xref="S2.SS3.p2.5.m5.1.1.3.2">𝑚</ci><ci id="S2.SS3.p2.5.m5.1.1.3.3.cmml" xref="S2.SS3.p2.5.m5.1.1.3.3">𝑖</ci><ci id="S2.SS3.p2.5.m5.1.1.3.4.cmml" xref="S2.SS3.p2.5.m5.1.1.3.4">𝑛</ci><ci id="S2.SS3.p2.5.m5.1.1.3.5.cmml" xref="S2.SS3.p2.5.m5.1.1.3.5">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.1c">f_{minp}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.5.m5.1d">italic_f start_POSTSUBSCRIPT italic_m italic_i italic_n italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, the minimum value of the probabilities of the individual tokens, and (ii) <math alttext="f_{meanp}" class="ltx_Math" display="inline" id="S2.SS3.p2.6.m6.1"><semantics id="S2.SS3.p2.6.m6.1a"><msub id="S2.SS3.p2.6.m6.1.1" xref="S2.SS3.p2.6.m6.1.1.cmml"><mi id="S2.SS3.p2.6.m6.1.1.2" xref="S2.SS3.p2.6.m6.1.1.2.cmml">f</mi><mrow id="S2.SS3.p2.6.m6.1.1.3" xref="S2.SS3.p2.6.m6.1.1.3.cmml"><mi id="S2.SS3.p2.6.m6.1.1.3.2" xref="S2.SS3.p2.6.m6.1.1.3.2.cmml">m</mi><mo id="S2.SS3.p2.6.m6.1.1.3.1" xref="S2.SS3.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.6.m6.1.1.3.3" xref="S2.SS3.p2.6.m6.1.1.3.3.cmml">e</mi><mo id="S2.SS3.p2.6.m6.1.1.3.1a" xref="S2.SS3.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.6.m6.1.1.3.4" xref="S2.SS3.p2.6.m6.1.1.3.4.cmml">a</mi><mo id="S2.SS3.p2.6.m6.1.1.3.1b" xref="S2.SS3.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.6.m6.1.1.3.5" xref="S2.SS3.p2.6.m6.1.1.3.5.cmml">n</mi><mo id="S2.SS3.p2.6.m6.1.1.3.1c" xref="S2.SS3.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.6.m6.1.1.3.6" xref="S2.SS3.p2.6.m6.1.1.3.6.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m6.1b"><apply id="S2.SS3.p2.6.m6.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.1.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.p2.6.m6.1.1.2.cmml" xref="S2.SS3.p2.6.m6.1.1.2">𝑓</ci><apply id="S2.SS3.p2.6.m6.1.1.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3"><times id="S2.SS3.p2.6.m6.1.1.3.1.cmml" xref="S2.SS3.p2.6.m6.1.1.3.1"></times><ci id="S2.SS3.p2.6.m6.1.1.3.2.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2">𝑚</ci><ci id="S2.SS3.p2.6.m6.1.1.3.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3.3">𝑒</ci><ci id="S2.SS3.p2.6.m6.1.1.3.4.cmml" xref="S2.SS3.p2.6.m6.1.1.3.4">𝑎</ci><ci id="S2.SS3.p2.6.m6.1.1.3.5.cmml" xref="S2.SS3.p2.6.m6.1.1.3.5">𝑛</ci><ci id="S2.SS3.p2.6.m6.1.1.3.6.cmml" xref="S2.SS3.p2.6.m6.1.1.3.6">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m6.1c">f_{meanp}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.6.m6.1d">italic_f start_POSTSUBSCRIPT italic_m italic_e italic_a italic_n italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, the geometric mean of the probabilities of the individual tokens in the generated sequence.</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx1">
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle f_{minp}(o|\hat{q})" class="ltx_Math" display="inline" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><msub id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml"><mi id="S2.E4.m1.1.1.3.2" xref="S2.E4.m1.1.1.3.2.cmml">f</mi><mrow id="S2.E4.m1.1.1.3.3" xref="S2.E4.m1.1.1.3.3.cmml"><mi id="S2.E4.m1.1.1.3.3.2" xref="S2.E4.m1.1.1.3.3.2.cmml">m</mi><mo id="S2.E4.m1.1.1.3.3.1" xref="S2.E4.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.3.3.3" xref="S2.E4.m1.1.1.3.3.3.cmml">i</mi><mo id="S2.E4.m1.1.1.3.3.1a" xref="S2.E4.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.3.3.4" xref="S2.E4.m1.1.1.3.3.4.cmml">n</mi><mo id="S2.E4.m1.1.1.3.3.1b" xref="S2.E4.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.3.3.5" xref="S2.E4.m1.1.1.3.3.5.cmml">p</mi></mrow></msub><mo id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S2.E4.m1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.cmml">|</mo><mover accent="true" id="S2.E4.m1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.1.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.3.2.cmml">q</mi><mo id="S2.E4.m1.1.1.1.1.1.3.1" xref="S2.E4.m1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S2.E4.m1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><times id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2"></times><apply id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.3.2">𝑓</ci><apply id="S2.E4.m1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.3.3"><times id="S2.E4.m1.1.1.3.3.1.cmml" xref="S2.E4.m1.1.1.3.3.1"></times><ci id="S2.E4.m1.1.1.3.3.2.cmml" xref="S2.E4.m1.1.1.3.3.2">𝑚</ci><ci id="S2.E4.m1.1.1.3.3.3.cmml" xref="S2.E4.m1.1.1.3.3.3">𝑖</ci><ci id="S2.E4.m1.1.1.3.3.4.cmml" xref="S2.E4.m1.1.1.3.3.4">𝑛</ci><ci id="S2.E4.m1.1.1.3.3.5.cmml" xref="S2.E4.m1.1.1.3.3.5">𝑝</ci></apply></apply><apply id="S2.E4.m1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E4.m1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.2">𝑜</ci><apply id="S2.E4.m1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3"><ci id="S2.E4.m1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.3.1">^</ci><ci id="S2.E4.m1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle f_{minp}(o|\hat{q})</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">italic_f start_POSTSUBSCRIPT italic_m italic_i italic_n italic_p end_POSTSUBSCRIPT ( italic_o | over^ start_ARG italic_q end_ARG )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\min_{i=1}^{m}p(o_{i}|\hat{q},o_{&lt;i})" class="ltx_Math" display="inline" id="S2.E4.m2.2"><semantics id="S2.E4.m2.2a"><mrow id="S2.E4.m2.2.2" xref="S2.E4.m2.2.2.cmml"><mi id="S2.E4.m2.2.2.3" xref="S2.E4.m2.2.2.3.cmml"></mi><mo id="S2.E4.m2.2.2.2" xref="S2.E4.m2.2.2.2.cmml">=</mo><mrow id="S2.E4.m2.2.2.1" xref="S2.E4.m2.2.2.1.cmml"><mrow id="S2.E4.m2.2.2.1.3" xref="S2.E4.m2.2.2.1.3.cmml"><munderover id="S2.E4.m2.2.2.1.3.1" xref="S2.E4.m2.2.2.1.3.1.cmml"><mi id="S2.E4.m2.2.2.1.3.1.2.2" xref="S2.E4.m2.2.2.1.3.1.2.2.cmml">min</mi><mrow id="S2.E4.m2.2.2.1.3.1.2.3" xref="S2.E4.m2.2.2.1.3.1.2.3.cmml"><mi id="S2.E4.m2.2.2.1.3.1.2.3.2" xref="S2.E4.m2.2.2.1.3.1.2.3.2.cmml">i</mi><mo id="S2.E4.m2.2.2.1.3.1.2.3.1" xref="S2.E4.m2.2.2.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E4.m2.2.2.1.3.1.2.3.3" xref="S2.E4.m2.2.2.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E4.m2.2.2.1.3.1.3" xref="S2.E4.m2.2.2.1.3.1.3.cmml">m</mi></munderover><mo id="S2.E4.m2.2.2.1.3a" lspace="0.167em" xref="S2.E4.m2.2.2.1.3.cmml">⁡</mo><mi id="S2.E4.m2.2.2.1.3.2" xref="S2.E4.m2.2.2.1.3.2.cmml">p</mi></mrow><mo id="S2.E4.m2.2.2.1.2" xref="S2.E4.m2.2.2.1.2.cmml">⁢</mo><mrow id="S2.E4.m2.2.2.1.1.1" xref="S2.E4.m2.2.2.1.1.1.1.cmml"><mo id="S2.E4.m2.2.2.1.1.1.2" stretchy="false" xref="S2.E4.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m2.2.2.1.1.1.1" xref="S2.E4.m2.2.2.1.1.1.1.cmml"><msub id="S2.E4.m2.2.2.1.1.1.1.3" xref="S2.E4.m2.2.2.1.1.1.1.3.cmml"><mi id="S2.E4.m2.2.2.1.1.1.1.3.2" xref="S2.E4.m2.2.2.1.1.1.1.3.2.cmml">o</mi><mi id="S2.E4.m2.2.2.1.1.1.1.3.3" xref="S2.E4.m2.2.2.1.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="S2.E4.m2.2.2.1.1.1.1.2" xref="S2.E4.m2.2.2.1.1.1.1.2.cmml">|</mo><mrow id="S2.E4.m2.2.2.1.1.1.1.1.1" xref="S2.E4.m2.2.2.1.1.1.1.1.2.cmml"><mover accent="true" id="S2.E4.m2.1.1" xref="S2.E4.m2.1.1.cmml"><mi id="S2.E4.m2.1.1.2" xref="S2.E4.m2.1.1.2.cmml">q</mi><mo id="S2.E4.m2.1.1.1" xref="S2.E4.m2.1.1.1.cmml">^</mo></mover><mo id="S2.E4.m2.2.2.1.1.1.1.1.1.2" xref="S2.E4.m2.2.2.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E4.m2.2.2.1.1.1.1.1.1.1" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m2.2.2.1.1.1.1.1.1.1.2" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1.2.cmml">o</mi><mrow id="S2.E4.m2.2.2.1.1.1.1.1.1.1.3" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.2" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.1" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.3" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S2.E4.m2.2.2.1.1.1.3" stretchy="false" xref="S2.E4.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.2b"><apply id="S2.E4.m2.2.2.cmml" xref="S2.E4.m2.2.2"><eq id="S2.E4.m2.2.2.2.cmml" xref="S2.E4.m2.2.2.2"></eq><csymbol cd="latexml" id="S2.E4.m2.2.2.3.cmml" xref="S2.E4.m2.2.2.3">absent</csymbol><apply id="S2.E4.m2.2.2.1.cmml" xref="S2.E4.m2.2.2.1"><times id="S2.E4.m2.2.2.1.2.cmml" xref="S2.E4.m2.2.2.1.2"></times><apply id="S2.E4.m2.2.2.1.3.cmml" xref="S2.E4.m2.2.2.1.3"><apply id="S2.E4.m2.2.2.1.3.1.cmml" xref="S2.E4.m2.2.2.1.3.1"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.1.3.1.1.cmml" xref="S2.E4.m2.2.2.1.3.1">superscript</csymbol><apply id="S2.E4.m2.2.2.1.3.1.2.cmml" xref="S2.E4.m2.2.2.1.3.1"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.1.3.1.2.1.cmml" xref="S2.E4.m2.2.2.1.3.1">subscript</csymbol><min id="S2.E4.m2.2.2.1.3.1.2.2.cmml" xref="S2.E4.m2.2.2.1.3.1.2.2"></min><apply id="S2.E4.m2.2.2.1.3.1.2.3.cmml" xref="S2.E4.m2.2.2.1.3.1.2.3"><eq id="S2.E4.m2.2.2.1.3.1.2.3.1.cmml" xref="S2.E4.m2.2.2.1.3.1.2.3.1"></eq><ci id="S2.E4.m2.2.2.1.3.1.2.3.2.cmml" xref="S2.E4.m2.2.2.1.3.1.2.3.2">𝑖</ci><cn id="S2.E4.m2.2.2.1.3.1.2.3.3.cmml" type="integer" xref="S2.E4.m2.2.2.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E4.m2.2.2.1.3.1.3.cmml" xref="S2.E4.m2.2.2.1.3.1.3">𝑚</ci></apply><ci id="S2.E4.m2.2.2.1.3.2.cmml" xref="S2.E4.m2.2.2.1.3.2">𝑝</ci></apply><apply id="S2.E4.m2.2.2.1.1.1.1.cmml" xref="S2.E4.m2.2.2.1.1.1"><csymbol cd="latexml" id="S2.E4.m2.2.2.1.1.1.1.2.cmml" xref="S2.E4.m2.2.2.1.1.1.1.2">conditional</csymbol><apply id="S2.E4.m2.2.2.1.1.1.1.3.cmml" xref="S2.E4.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.1.1.1.1.3.1.cmml" xref="S2.E4.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m2.2.2.1.1.1.1.3.2.cmml" xref="S2.E4.m2.2.2.1.1.1.1.3.2">𝑜</ci><ci id="S2.E4.m2.2.2.1.1.1.1.3.3.cmml" xref="S2.E4.m2.2.2.1.1.1.1.3.3">𝑖</ci></apply><list id="S2.E4.m2.2.2.1.1.1.1.1.2.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1"><apply id="S2.E4.m2.1.1.cmml" xref="S2.E4.m2.1.1"><ci id="S2.E4.m2.1.1.1.cmml" xref="S2.E4.m2.1.1.1">^</ci><ci id="S2.E4.m2.1.1.2.cmml" xref="S2.E4.m2.1.1.2">𝑞</ci></apply><apply id="S2.E4.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1.2">𝑜</ci><apply id="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1.3"><lt id="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.2c">\displaystyle=\min_{i=1}^{m}p(o_{i}|\hat{q},o_{&lt;i})</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m2.2d">= roman_min start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_p ( italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | over^ start_ARG italic_q end_ARG , italic_o start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle f_{meanp}(o|\hat{q})" class="ltx_Math" display="inline" id="S2.E5.m1.1"><semantics id="S2.E5.m1.1a"><mrow id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml"><msub id="S2.E5.m1.1.1.3" xref="S2.E5.m1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.3.2" xref="S2.E5.m1.1.1.3.2.cmml">f</mi><mrow id="S2.E5.m1.1.1.3.3" xref="S2.E5.m1.1.1.3.3.cmml"><mi id="S2.E5.m1.1.1.3.3.2" xref="S2.E5.m1.1.1.3.3.2.cmml">m</mi><mo id="S2.E5.m1.1.1.3.3.1" xref="S2.E5.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E5.m1.1.1.3.3.3" xref="S2.E5.m1.1.1.3.3.3.cmml">e</mi><mo id="S2.E5.m1.1.1.3.3.1a" xref="S2.E5.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E5.m1.1.1.3.3.4" xref="S2.E5.m1.1.1.3.3.4.cmml">a</mi><mo id="S2.E5.m1.1.1.3.3.1b" xref="S2.E5.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E5.m1.1.1.3.3.5" xref="S2.E5.m1.1.1.3.3.5.cmml">n</mi><mo id="S2.E5.m1.1.1.3.3.1c" xref="S2.E5.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E5.m1.1.1.3.3.6" xref="S2.E5.m1.1.1.3.3.6.cmml">p</mi></mrow></msub><mo id="S2.E5.m1.1.1.2" xref="S2.E5.m1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.1.1.1.1.2" stretchy="false" xref="S2.E5.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S2.E5.m1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.cmml">|</mo><mover accent="true" id="S2.E5.m1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.1.3.2.cmml">q</mi><mo id="S2.E5.m1.1.1.1.1.1.3.1" xref="S2.E5.m1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S2.E5.m1.1.1.1.1.3" stretchy="false" xref="S2.E5.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1"><times id="S2.E5.m1.1.1.2.cmml" xref="S2.E5.m1.1.1.2"></times><apply id="S2.E5.m1.1.1.3.cmml" xref="S2.E5.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.3.2">𝑓</ci><apply id="S2.E5.m1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.3.3"><times id="S2.E5.m1.1.1.3.3.1.cmml" xref="S2.E5.m1.1.1.3.3.1"></times><ci id="S2.E5.m1.1.1.3.3.2.cmml" xref="S2.E5.m1.1.1.3.3.2">𝑚</ci><ci id="S2.E5.m1.1.1.3.3.3.cmml" xref="S2.E5.m1.1.1.3.3.3">𝑒</ci><ci id="S2.E5.m1.1.1.3.3.4.cmml" xref="S2.E5.m1.1.1.3.3.4">𝑎</ci><ci id="S2.E5.m1.1.1.3.3.5.cmml" xref="S2.E5.m1.1.1.3.3.5">𝑛</ci><ci id="S2.E5.m1.1.1.3.3.6.cmml" xref="S2.E5.m1.1.1.3.3.6">𝑝</ci></apply></apply><apply id="S2.E5.m1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E5.m1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.2">𝑜</ci><apply id="S2.E5.m1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.3"><ci id="S2.E5.m1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.3.1">^</ci><ci id="S2.E5.m1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.3.2">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\displaystyle f_{meanp}(o|\hat{q})</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.1d">italic_f start_POSTSUBSCRIPT italic_m italic_e italic_a italic_n italic_p end_POSTSUBSCRIPT ( italic_o | over^ start_ARG italic_q end_ARG )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sqrt[m]{\prod_{i=1}^{m}p(o_{i}|\hat{q},o_{&lt;i})}" class="ltx_Math" display="inline" id="S2.E5.m2.2"><semantics id="S2.E5.m2.2a"><mrow id="S2.E5.m2.2.3" xref="S2.E5.m2.2.3.cmml"><mi id="S2.E5.m2.2.3.2" xref="S2.E5.m2.2.3.2.cmml"></mi><mo id="S2.E5.m2.2.3.1" xref="S2.E5.m2.2.3.1.cmml">=</mo><mroot id="S2.E5.m2.2.2" xref="S2.E5.m2.2.2.cmml"><mrow id="S2.E5.m2.2.2.2" xref="S2.E5.m2.2.2.2.cmml"><mstyle displaystyle="true" id="S2.E5.m2.2.2.2.3" xref="S2.E5.m2.2.2.2.3.cmml"><munderover id="S2.E5.m2.2.2.2.3a" xref="S2.E5.m2.2.2.2.3.cmml"><mo id="S2.E5.m2.2.2.2.3.2.2" movablelimits="false" xref="S2.E5.m2.2.2.2.3.2.2.cmml">∏</mo><mrow id="S2.E5.m2.2.2.2.3.2.3" xref="S2.E5.m2.2.2.2.3.2.3.cmml"><mi id="S2.E5.m2.2.2.2.3.2.3.2" xref="S2.E5.m2.2.2.2.3.2.3.2.cmml">i</mi><mo id="S2.E5.m2.2.2.2.3.2.3.1" xref="S2.E5.m2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E5.m2.2.2.2.3.2.3.3" xref="S2.E5.m2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E5.m2.2.2.2.3.3" xref="S2.E5.m2.2.2.2.3.3.cmml">m</mi></munderover></mstyle><mrow id="S2.E5.m2.2.2.2.2" xref="S2.E5.m2.2.2.2.2.cmml"><mi id="S2.E5.m2.2.2.2.2.3" xref="S2.E5.m2.2.2.2.2.3.cmml">p</mi><mo id="S2.E5.m2.2.2.2.2.2" xref="S2.E5.m2.2.2.2.2.2.cmml">⁢</mo><mrow id="S2.E5.m2.2.2.2.2.1.1" xref="S2.E5.m2.2.2.2.2.1.1.1.cmml"><mo id="S2.E5.m2.2.2.2.2.1.1.2" stretchy="false" xref="S2.E5.m2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E5.m2.2.2.2.2.1.1.1" xref="S2.E5.m2.2.2.2.2.1.1.1.cmml"><msub id="S2.E5.m2.2.2.2.2.1.1.1.3" xref="S2.E5.m2.2.2.2.2.1.1.1.3.cmml"><mi id="S2.E5.m2.2.2.2.2.1.1.1.3.2" xref="S2.E5.m2.2.2.2.2.1.1.1.3.2.cmml">o</mi><mi id="S2.E5.m2.2.2.2.2.1.1.1.3.3" xref="S2.E5.m2.2.2.2.2.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="S2.E5.m2.2.2.2.2.1.1.1.2" xref="S2.E5.m2.2.2.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.E5.m2.2.2.2.2.1.1.1.1.1" xref="S2.E5.m2.2.2.2.2.1.1.1.1.2.cmml"><mover accent="true" id="S2.E5.m2.1.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.2.cmml">q</mi><mo id="S2.E5.m2.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.cmml">^</mo></mover><mo id="S2.E5.m2.2.2.2.2.1.1.1.1.1.2" xref="S2.E5.m2.2.2.2.2.1.1.1.1.2.cmml">,</mo><msub id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.2" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.2.cmml">o</mi><mrow id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.2" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.1" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.3" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S2.E5.m2.2.2.2.2.1.1.3" stretchy="false" xref="S2.E5.m2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mi id="S2.E5.m2.2.2.4" xref="S2.E5.m2.2.2.4.cmml">m</mi></mroot></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.2b"><apply id="S2.E5.m2.2.3.cmml" xref="S2.E5.m2.2.3"><eq id="S2.E5.m2.2.3.1.cmml" xref="S2.E5.m2.2.3.1"></eq><csymbol cd="latexml" id="S2.E5.m2.2.3.2.cmml" xref="S2.E5.m2.2.3.2">absent</csymbol><apply id="S2.E5.m2.2.2.cmml" xref="S2.E5.m2.2.2"><root id="S2.E5.m2.2.2a.cmml" xref="S2.E5.m2.2.2"></root><degree id="S2.E5.m2.2.2b.cmml" xref="S2.E5.m2.2.2"><ci id="S2.E5.m2.2.2.4.cmml" xref="S2.E5.m2.2.2.4">𝑚</ci></degree><apply id="S2.E5.m2.2.2.2.cmml" xref="S2.E5.m2.2.2.2"><apply id="S2.E5.m2.2.2.2.3.cmml" xref="S2.E5.m2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E5.m2.2.2.2.3.1.cmml" xref="S2.E5.m2.2.2.2.3">superscript</csymbol><apply id="S2.E5.m2.2.2.2.3.2.cmml" xref="S2.E5.m2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E5.m2.2.2.2.3.2.1.cmml" xref="S2.E5.m2.2.2.2.3">subscript</csymbol><csymbol cd="latexml" id="S2.E5.m2.2.2.2.3.2.2.cmml" xref="S2.E5.m2.2.2.2.3.2.2">product</csymbol><apply id="S2.E5.m2.2.2.2.3.2.3.cmml" xref="S2.E5.m2.2.2.2.3.2.3"><eq id="S2.E5.m2.2.2.2.3.2.3.1.cmml" xref="S2.E5.m2.2.2.2.3.2.3.1"></eq><ci id="S2.E5.m2.2.2.2.3.2.3.2.cmml" xref="S2.E5.m2.2.2.2.3.2.3.2">𝑖</ci><cn id="S2.E5.m2.2.2.2.3.2.3.3.cmml" type="integer" xref="S2.E5.m2.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E5.m2.2.2.2.3.3.cmml" xref="S2.E5.m2.2.2.2.3.3">𝑚</ci></apply><apply id="S2.E5.m2.2.2.2.2.cmml" xref="S2.E5.m2.2.2.2.2"><times id="S2.E5.m2.2.2.2.2.2.cmml" xref="S2.E5.m2.2.2.2.2.2"></times><ci id="S2.E5.m2.2.2.2.2.3.cmml" xref="S2.E5.m2.2.2.2.2.3">𝑝</ci><apply id="S2.E5.m2.2.2.2.2.1.1.1.cmml" xref="S2.E5.m2.2.2.2.2.1.1"><csymbol cd="latexml" id="S2.E5.m2.2.2.2.2.1.1.1.2.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.2">conditional</csymbol><apply id="S2.E5.m2.2.2.2.2.1.1.1.3.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m2.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E5.m2.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.3.2">𝑜</ci><ci id="S2.E5.m2.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.3.3">𝑖</ci></apply><list id="S2.E5.m2.2.2.2.2.1.1.1.1.2.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1"><apply id="S2.E5.m2.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1"><ci id="S2.E5.m2.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1">^</ci><ci id="S2.E5.m2.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.2">𝑞</ci></apply><apply id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.2">𝑜</ci><apply id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3"><lt id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.2c">\displaystyle=\sqrt[m]{\prod_{i=1}^{m}p(o_{i}|\hat{q},o_{&lt;i})}</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m2.2d">= nth-root start_ARG italic_m end_ARG start_ARG ∏ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_p ( italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | over^ start_ARG italic_q end_ARG , italic_o start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p2.8">We control retrieval frequency with a tunable threshold <math alttext="\gamma" class="ltx_Math" display="inline" id="S2.SS3.p2.7.m1.1"><semantics id="S2.SS3.p2.7.m1.1a"><mi id="S2.SS3.p2.7.m1.1.1" xref="S2.SS3.p2.7.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.7.m1.1b"><ci id="S2.SS3.p2.7.m1.1.1.cmml" xref="S2.SS3.p2.7.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.7.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.7.m1.1d">italic_γ</annotation></semantics></math>, where retrieval occurs if <math alttext="f_{|\cdot|}&lt;\gamma" class="ltx_math_unparsed" display="inline" id="S2.SS3.p2.8.m2.1"><semantics id="S2.SS3.p2.8.m2.1a"><mrow id="S2.SS3.p2.8.m2.1.1"><msub id="S2.SS3.p2.8.m2.1.1.2"><mi id="S2.SS3.p2.8.m2.1.1.2.2">f</mi><mrow id="S2.SS3.p2.8.m2.1.1.2.3"><mo fence="false" id="S2.SS3.p2.8.m2.1.1.2.3.1" stretchy="false">|</mo><mo id="S2.SS3.p2.8.m2.1.1.2.3.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S2.SS3.p2.8.m2.1.1.2.3.3" stretchy="false">|</mo></mrow></msub><mo id="S2.SS3.p2.8.m2.1.1.1">&lt;</mo><mi id="S2.SS3.p2.8.m2.1.1.3">γ</mi></mrow><annotation encoding="application/x-tex" id="S2.SS3.p2.8.m2.1b">f_{|\cdot|}&lt;\gamma</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.8.m2.1c">italic_f start_POSTSUBSCRIPT | ⋅ | end_POSTSUBSCRIPT &lt; italic_γ</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Tasks and Datasets</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p1.1.1">Single-hop short-form tasks</span> include PopQA <cite class="ltx_cite ltx_citemacro_citep">(Mallen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib25" title="">2022</a>)</cite>, TriviaQA-unfiltered <cite class="ltx_cite ltx_citemacro_citep">(Joshi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib16" title="">2017</a>)</cite>, and PubHealth <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib50" title="">2023</a>)</cite>. These datasets involve answering factual questions and verifying public health facts, using retrieved contexts provided by Self-RAG. We use the accuracy metric for evaluation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">Single-hop long-form generation tasks</span> cover biography generation (Bio) <cite class="ltx_cite ltx_citemacro_citep">(Min et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib28" title="">2023b</a>)</cite> and the long-form QA benchmark ALCE-ASQA <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib10" title="">2023b</a>; Stelmakh et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib36" title="">2022</a>)</cite>. Biographies are evaluated with FactScore <cite class="ltx_cite ltx_citemacro_citep">(Min et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib28" title="">2023b</a>)</cite>, while ALCE-ASQA uses official metrics for correctness (str-em) and fluency based on MAUVE <cite class="ltx_cite ltx_citemacro_citep">(Pillutla et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib33" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.1.1">Multi-hop reasoning tasks</span> include HotpotQA (distractor dev split) <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib46" title="">2018a</a>)</cite>, MuSique-Ans <cite class="ltx_cite ltx_citemacro_citep">(Trivedi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib38" title="">2022</a>)</cite>, and 2WikiMultihopQA <cite class="ltx_cite ltx_citemacro_citep">(Ho et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib11" title="">2020</a>)</cite> which require systems to answer complex multi-hop questions. We use official EM and F1 metrics for evaluation.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Experimental settings</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.10"><span class="ltx_text ltx_font_bold" id="S3.SS2.p1.10.2">Training Data and Settings.</span>
In our data curation process, as detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS2.SSS1" title="2.2.1 Data Collection ‣ 2.2 Open-RAG Training ‣ 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">2.2.1</span></a>, we compile a diverse set of instruction-following input-output pairs encompassing retrieval-free, single-hop, and multi-hop datasets requiring retrieval. For no-retrieval and single-hop datasets, we utilize 150K instruction-output pairs curated by Self-RAG.
For the multi-hop dataset, we randomly sample 16K two-hop instances from the HotpotQA <cite class="ltx_cite ltx_citemacro_cite">Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib47" title="">2018b</a>)</cite> Distractor train split, each with 10 passages annotated with the ground truth <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.10.3">Relevance</em> tokens. Using our data collection method from Section <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS2.SSS1" title="2.2.1 Data Collection ‣ 2.2 Open-RAG Training ‣ 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">2.2.1</span></a>, we generate 28K new multi-hop training instances. All other <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.10.4">reflection</em> tokens are labeled by the Llama2<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1a" xref="S3.SS2.p1.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><ci id="S3.SS2.p1.1.m1.1.1.1a.cmml" xref="S3.SS2.p1.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.SS2.p1.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.SS2.p1.1.m1.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib37" title="">2023</a>)</cite> critic LLM in Self-RAG, which is distilled from GPT-4. Additional information regarding training is provided in Appendix Section <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#A1" title="Appendix A Training Details ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">A</span></a>. Following previous works and for a fair comparison, we use the Llama2<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1a" xref="S3.SS2.p1.2.m2.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><ci id="S3.SS2.p1.2.m2.1.1.1a.cmml" xref="S3.SS2.p1.2.m2.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.SS2.p1.2.m2.1.1.1.cmml" mathsize="70%" xref="S3.SS2.p1.2.m2.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math>  <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib37" title="">2023</a>)</cite> as the base RAG model <math alttext="\mathcal{M}_{G}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">ℳ</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathcal{M}_{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">caligraphic_M start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math>. <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.10.5">Open-RAG</span> is transformed into a MoE model with <math alttext="N_{E}=8" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><msub id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.2.2.cmml">N</mi><mi id="S3.SS2.p1.4.m4.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.2.3.cmml">E</mi></msub><mo id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><eq id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"></eq><apply id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2.2">𝑁</ci><ci id="S3.SS2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3">𝐸</ci></apply><cn id="S3.SS2.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p1.4.m4.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">N_{E}=8</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT = 8</annotation></semantics></math> and <math alttext="k=2" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">k</mi><mo id="S3.SS2.p1.5.m5.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><eq id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1"></eq><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝑘</ci><cn id="S3.SS2.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS2.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">k=2</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_k = 2</annotation></semantics></math>, incorporating adapters with a dimension of <math alttext="512" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mn id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><cn id="S3.SS2.p1.6.m6.1.1.cmml" type="integer" xref="S3.SS2.p1.6.m6.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">512</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">512</annotation></semantics></math>, totaling an additional (8<math alttext="\times" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><mo id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><times id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">×</annotation></semantics></math>135M) adapter model parameters. Moreover, we train a larger version of <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.10.6">Open-RAG</span> based on Llama2<math alttext="{}_{\textsc{13B}}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><msub id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1a" xref="S3.SS2.p1.8.m8.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.SS2.p1.8.m8.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1a.cmml">13B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><ci id="S3.SS2.p1.8.m8.1.1.1a.cmml" xref="S3.SS2.p1.8.m8.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.SS2.p1.8.m8.1.1.1.cmml" mathsize="70%" xref="S3.SS2.p1.8.m8.1.1.1">13B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">{}_{\textsc{13B}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">start_FLOATSUBSCRIPT 13B end_FLOATSUBSCRIPT</annotation></semantics></math>  with additional (8<math alttext="\times" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.1"><semantics id="S3.SS2.p1.9.m9.1a"><mo id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><times id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.1d">×</annotation></semantics></math>213M) parameters to demonstrate the scalability of our framework. By <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.10.7">Open-RAG</span> model, we indicate <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.10.1">Open-RAG<math alttext="{}_{\textsc{7B+8}\times\textsc{135M}}" class="ltx_Math" display="inline" id="S3.SS2.p1.10.1.m1.1"><semantics id="S3.SS2.p1.10.1.m1.1a"><msub id="S3.SS2.p1.10.1.m1.1.1" xref="S3.SS2.p1.10.1.m1.1.1.cmml"><mi id="S3.SS2.p1.10.1.m1.1.1a" xref="S3.SS2.p1.10.1.m1.1.1.cmml"></mi><mrow id="S3.SS2.p1.10.1.m1.1.1.1" xref="S3.SS2.p1.10.1.m1.1.1.1.cmml"><mtext class="ltx_font_smallcaps" id="S3.SS2.p1.10.1.m1.1.1.1.2" xref="S3.SS2.p1.10.1.m1.1.1.1.2a.cmml">7B+8</mtext><mo id="S3.SS2.p1.10.1.m1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.10.1.m1.1.1.1.1.cmml">×</mo><mtext class="ltx_font_smallcaps" id="S3.SS2.p1.10.1.m1.1.1.1.3" xref="S3.SS2.p1.10.1.m1.1.1.1.3a.cmml">135M</mtext></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.1.m1.1b"><apply id="S3.SS2.p1.10.1.m1.1.1.cmml" xref="S3.SS2.p1.10.1.m1.1.1"><apply id="S3.SS2.p1.10.1.m1.1.1.1.cmml" xref="S3.SS2.p1.10.1.m1.1.1.1"><times id="S3.SS2.p1.10.1.m1.1.1.1.1.cmml" xref="S3.SS2.p1.10.1.m1.1.1.1.1"></times><ci id="S3.SS2.p1.10.1.m1.1.1.1.2a.cmml" xref="S3.SS2.p1.10.1.m1.1.1.1.2"><mtext class="ltx_font_smallcaps" id="S3.SS2.p1.10.1.m1.1.1.1.2.cmml" mathsize="70%" xref="S3.SS2.p1.10.1.m1.1.1.1.2">7B+8</mtext></ci><ci id="S3.SS2.p1.10.1.m1.1.1.1.3a.cmml" xref="S3.SS2.p1.10.1.m1.1.1.1.3"><mtext class="ltx_font_smallcaps" id="S3.SS2.p1.10.1.m1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.10.1.m1.1.1.1.3">135M</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.1.m1.1c">{}_{\textsc{7B+8}\times\textsc{135M}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.1.m1.1d">start_FLOATSUBSCRIPT 7B+8 × 135M end_FLOATSUBSCRIPT</annotation></semantics></math></span>  if not explicitly mentioned.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.2"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.2.1">Inference Data and Settings.</span>
We assign the default weight of 1.0, 1.0, and 0.5 to <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.2.2">Relevance</em>, <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.2.3">Grounding</em>, and <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.2.4">Utility</em> tokens respectively. Following Self-RAG,
we compare the model performances with always retrieval and vary the retrieval frequency as discussed in Sec <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS3" title="2.3 Hybrid Approach for Adaptive Retrieval ‣ 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">2.3</span></a> only to demonstrate optimum thresholding and performance-speed trade-offs. In multi-hop evaluations, from the corresponding retrieval candidate passages, we use Beam Retriever <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib49" title="">2024a</a>)</cite> to retrieve <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p2.2.5">Top</span>-<math alttext="3" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mn id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><cn id="S3.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS2.p2.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">3</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">3</annotation></semantics></math> multi-hop contexts, each with the mentioned <math alttext="N_{H}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">N</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝑁</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">N_{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT</annotation></semantics></math> number of passages. For single-hop tasks, we use Self-RAG’s setup (See Appendix  <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#A2" title="Appendix B Inference Details ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>).</p>
</div>
<figure class="ltx_table" id="S3.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.22" style="width:433.6pt;height:468.9pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-16.7pt,18.0pt) scale(0.928504210003335,0.928504210003335) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T1.22.22">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.22.22.23.1">
<td class="ltx_td ltx_border_r ltx_border_tt" id="S3.T1.22.22.23.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3" id="S3.T1.22.22.23.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">Short-form</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="4" id="S3.T1.22.22.23.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Long-form generations</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S3.T1.22.22.23.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">Multi-hop generations</td>
<td class="ltx_td ltx_border_tt" id="S3.T1.22.22.23.1.5" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.22.24.2">
<td class="ltx_td ltx_border_r" id="S3.T1.22.22.24.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.24.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">Pop</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.24.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">TQA</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.22.22.24.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">Pub</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.24.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">Bio</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="S3.T1.22.22.24.2.6" style="padding-left:3.0pt;padding-right:3.0pt;">ALCE-ASQA</td>
<td class="ltx_td ltx_align_center" colspan="2" id="S3.T1.22.22.24.2.7" style="padding-left:3.0pt;padding-right:3.0pt;">Hotpot</td>
<td class="ltx_td ltx_align_center" colspan="2" id="S3.T1.22.22.24.2.8" style="padding-left:3.0pt;padding-right:3.0pt;">MuSiQue</td>
<td class="ltx_td ltx_align_center" colspan="2" id="S3.T1.22.22.24.2.9" style="padding-left:3.0pt;padding-right:3.0pt;">2WikiMH</td>
<td class="ltx_td" id="S3.T1.22.22.24.2.10" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.22.25.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.22.22.25.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">LM</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.25.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">Acc</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.25.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">Acc</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.22.22.25.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">Acc</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.25.3.5" style="padding-left:3.0pt;padding-right:3.0pt;">FS</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.25.3.6" style="padding-left:3.0pt;padding-right:3.0pt;">SM</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.25.3.7" style="padding-left:3.0pt;padding-right:3.0pt;">rg</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.22.22.25.3.8" style="padding-left:3.0pt;padding-right:3.0pt;">mau</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.25.3.9" style="padding-left:3.0pt;padding-right:3.0pt;">EM</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.25.3.10" style="padding-left:3.0pt;padding-right:3.0pt;">F1</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.25.3.11" style="padding-left:3.0pt;padding-right:3.0pt;">EM</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.25.3.12" style="padding-left:3.0pt;padding-right:3.0pt;">F1</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.25.3.13" style="padding-left:3.0pt;padding-right:3.0pt;">EM</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.25.3.14" style="padding-left:3.0pt;padding-right:3.0pt;">F1</td>
<td class="ltx_td" id="S3.T1.22.22.25.3.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.22.26.4">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="14" id="S3.T1.22.22.26.4.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="S3.T1.22.22.26.4.1.1">LMs with proprietary data/retriever</span></td>
<td class="ltx_td ltx_border_t" id="S3.T1.22.22.26.4.2" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.22.27.5">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.22.22.27.5.1" style="padding-left:3.0pt;padding-right:3.0pt;">Perplexity.ai</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.22.22.27.5.2" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.22.22.27.5.3" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T1.22.22.27.5.4" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.22.22.27.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">71.2</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.22.22.27.5.6" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.22.22.27.5.7" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T1.22.22.27.5.8" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.22.22.27.5.9" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.22.22.27.5.10" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.22.22.27.5.11" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.22.22.27.5.12" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.22.22.27.5.13" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.22.22.27.5.14" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_border_t" id="S3.T1.22.22.27.5.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.22.28.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.22.22.28.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">RAG 2.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.28.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.28.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.22.22.28.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.28.6.5" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.28.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.28.6.7" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.22.22.28.6.8" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.28.6.9" style="padding-left:3.0pt;padding-right:3.0pt;">54.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.28.6.10" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.28.6.11" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.28.6.12" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.28.6.13" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.28.6.14" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td" id="S3.T1.22.22.28.6.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.22.29.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.22.22.29.7.1" style="padding-left:3.0pt;padding-right:3.0pt;">ChatGPT</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.29.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">29.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.29.7.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.29.7.3.1" style="color:#808080;">74.3</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.22.22.29.7.4" style="padding-left:3.0pt;padding-right:3.0pt;">70.1</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.29.7.5" style="padding-left:3.0pt;padding-right:3.0pt;">71.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.29.7.6" style="padding-left:3.0pt;padding-right:3.0pt;">35.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.29.7.7" style="padding-left:3.0pt;padding-right:3.0pt;">36.2</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.22.22.29.7.8" style="padding-left:3.0pt;padding-right:3.0pt;">68.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.29.7.9" style="padding-left:3.0pt;padding-right:3.0pt;">22.4</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.29.7.10" style="padding-left:3.0pt;padding-right:3.0pt;">30.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.29.7.11" style="padding-left:3.0pt;padding-right:3.0pt;">3.1</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.29.7.12" style="padding-left:3.0pt;padding-right:3.0pt;">7.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.29.7.13" style="padding-left:3.0pt;padding-right:3.0pt;">18.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.29.7.14" style="padding-left:3.0pt;padding-right:3.0pt;">21.7</td>
<td class="ltx_td" id="S3.T1.22.22.29.7.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.22.30.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.22.22.30.8.1" style="padding-left:3.0pt;padding-right:3.0pt;">RAG-ChatGPT</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.30.8.2" style="padding-left:3.0pt;padding-right:3.0pt;">50.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.30.8.3" style="padding-left:3.0pt;padding-right:3.0pt;">65.7</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.22.22.30.8.4" style="padding-left:3.0pt;padding-right:3.0pt;">54.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.30.8.5" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.30.8.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.30.8.6.1" style="color:#808080;">40.7</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.30.8.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.30.8.7.1" style="color:#808080;">39.9</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.22.22.30.8.8" style="padding-left:3.0pt;padding-right:3.0pt;">79.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.30.8.9" style="padding-left:3.0pt;padding-right:3.0pt;">55.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.30.8.10" style="padding-left:3.0pt;padding-right:3.0pt;">69.9</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.30.8.11" style="padding-left:3.0pt;padding-right:3.0pt;">31.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.30.8.12" style="padding-left:3.0pt;padding-right:3.0pt;">43.5</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.30.8.13" style="padding-left:3.0pt;padding-right:3.0pt;">44.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.22.22.30.8.14" style="padding-left:3.0pt;padding-right:3.0pt;">54.8</td>
<td class="ltx_td" id="S3.T1.22.22.30.8.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.2.2.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.2.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">RAG-Command R+<sup class="ltx_sup" id="S3.T1.2.2.2.2.1">∗</sup><math alttext="{}_{\textsc{104B}}" class="ltx_Math" display="inline" id="S3.T1.2.2.2.2.m2.1"><semantics id="S3.T1.2.2.2.2.m2.1a"><msub id="S3.T1.2.2.2.2.m2.1.1" xref="S3.T1.2.2.2.2.m2.1.1.cmml"><mi id="S3.T1.2.2.2.2.m2.1.1a" xref="S3.T1.2.2.2.2.m2.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.2.2.2.2.m2.1.1.1" xref="S3.T1.2.2.2.2.m2.1.1.1a.cmml">104B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.2.m2.1b"><apply id="S3.T1.2.2.2.2.m2.1.1.cmml" xref="S3.T1.2.2.2.2.m2.1.1"><ci id="S3.T1.2.2.2.2.m2.1.1.1a.cmml" xref="S3.T1.2.2.2.2.m2.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.2.2.2.2.m2.1.1.1.cmml" mathsize="70%" xref="S3.T1.2.2.2.2.m2.1.1.1">104B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.2.m2.1c">{}_{\textsc{104B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.2.2.m2.1d">start_FLOATSUBSCRIPT 104B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.2.2.2.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.2.2.2.3.1" style="color:#808080;">59.9</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.2.2.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">74.0</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.2.2.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">46.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.2.2.2.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.2.2.2.6.1" style="color:#808080;">84.0</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.2.2.2.7" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.2.2.2.8" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.2.2.2.9" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.2.2.2.10" style="padding-left:3.0pt;padding-right:3.0pt;">60.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.2.2.2.11" style="padding-left:3.0pt;padding-right:3.0pt;">75.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.2.2.2.12" style="padding-left:3.0pt;padding-right:3.0pt;">41.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.2.2.2.13" style="padding-left:3.0pt;padding-right:3.0pt;">55.4</td>
<td class="ltx_td ltx_align_right" id="S3.T1.2.2.2.14" style="padding-left:3.0pt;padding-right:3.0pt;"> 57.1</td>
<td class="ltx_td ltx_align_right" id="S3.T1.2.2.2.15" style="padding-left:3.0pt;padding-right:3.0pt;">66.1</td>
<td class="ltx_td" id="S3.T1.2.2.2.16" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.4.4.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_ERROR undefined" id="S3.T1.4.4.4.2.1">\cdashline</span>1-14
RQ-RAG<sup class="ltx_sup" id="S3.T1.4.4.4.2.2"><span class="ltx_text ltx_font_italic" id="S3.T1.4.4.4.2.2.1">†</span></sup><math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="S3.T1.4.4.4.2.m2.1"><semantics id="S3.T1.4.4.4.2.m2.1a"><msub id="S3.T1.4.4.4.2.m2.1.1" xref="S3.T1.4.4.4.2.m2.1.1.cmml"><mi id="S3.T1.4.4.4.2.m2.1.1a" xref="S3.T1.4.4.4.2.m2.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.4.4.4.2.m2.1.1.1" xref="S3.T1.4.4.4.2.m2.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.4.2.m2.1b"><apply id="S3.T1.4.4.4.2.m2.1.1.cmml" xref="S3.T1.4.4.4.2.m2.1.1"><ci id="S3.T1.4.4.4.2.m2.1.1.1a.cmml" xref="S3.T1.4.4.4.2.m2.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.4.4.4.2.m2.1.1.1.cmml" mathsize="70%" xref="S3.T1.4.4.4.2.m2.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.4.2.m2.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.4.2.m2.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math> (ToT)</td>
<td class="ltx_td ltx_align_right" id="S3.T1.4.4.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">57.1</td>
<td class="ltx_td ltx_align_right" id="S3.T1.4.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.4.4.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.4.4.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.4.4.4.7" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.4.4.4.8" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.4.4.4.9" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.4.4.4.10" style="padding-left:3.0pt;padding-right:3.0pt;">62.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.4.4.4.11" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.4.4.4.12" style="padding-left:3.0pt;padding-right:3.0pt;">41.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.4.4.4.13" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.4.4.4.14" style="padding-left:3.0pt;padding-right:3.0pt;">44.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.4.4.4.15" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td" id="S3.T1.4.4.4.16" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.22.31.9">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="14" id="S3.T1.22.22.31.9.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="S3.T1.22.22.31.9.1.1">Baselines without retrieval</span></td>
<td class="ltx_td ltx_border_t" id="S3.T1.22.22.31.9.2" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.5.5">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.5.5.5.1" style="padding-left:3.0pt;padding-right:3.0pt;">Llama2<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="S3.T1.5.5.5.1.m1.1"><semantics id="S3.T1.5.5.5.1.m1.1a"><msub id="S3.T1.5.5.5.1.m1.1.1" xref="S3.T1.5.5.5.1.m1.1.1.cmml"><mi id="S3.T1.5.5.5.1.m1.1.1a" xref="S3.T1.5.5.5.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.5.5.5.1.m1.1.1.1" xref="S3.T1.5.5.5.1.m1.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.5.1.m1.1b"><apply id="S3.T1.5.5.5.1.m1.1.1.cmml" xref="S3.T1.5.5.5.1.m1.1.1"><ci id="S3.T1.5.5.5.1.m1.1.1.1a.cmml" xref="S3.T1.5.5.5.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.5.5.5.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.5.5.5.1.m1.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.5.1.m1.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.5.1.m1.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.5.5.5.2" style="padding-left:3.0pt;padding-right:3.0pt;">14.7</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.5.5.5.3" style="padding-left:3.0pt;padding-right:3.0pt;">30.5</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T1.5.5.5.4" style="padding-left:3.0pt;padding-right:3.0pt;">34.2</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.5.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">44.5</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.5.5.5.6" style="padding-left:3.0pt;padding-right:3.0pt;">7.9</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.5.5.5.7" style="padding-left:3.0pt;padding-right:3.0pt;">15.3</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T1.5.5.5.8" style="padding-left:3.0pt;padding-right:3.0pt;">19.0</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.5.5.5.9" style="padding-left:3.0pt;padding-right:3.0pt;">3.8</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.5.5.5.10" style="padding-left:3.0pt;padding-right:3.0pt;">9.3</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.5.5.5.11" style="padding-left:3.0pt;padding-right:3.0pt;">2.0</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.5.5.5.12" style="padding-left:3.0pt;padding-right:3.0pt;">3.3</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.5.5.5.13" style="padding-left:3.0pt;padding-right:3.0pt;">8.0</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.5.5.5.14" style="padding-left:3.0pt;padding-right:3.0pt;">14.5</td>
<td class="ltx_td ltx_border_t" id="S3.T1.5.5.5.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.6.6.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.6.6.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">Alpaca<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="S3.T1.6.6.6.1.m1.1"><semantics id="S3.T1.6.6.6.1.m1.1a"><msub id="S3.T1.6.6.6.1.m1.1.1" xref="S3.T1.6.6.6.1.m1.1.1.cmml"><mi id="S3.T1.6.6.6.1.m1.1.1a" xref="S3.T1.6.6.6.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.6.6.6.1.m1.1.1.1" xref="S3.T1.6.6.6.1.m1.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.6.1.m1.1b"><apply id="S3.T1.6.6.6.1.m1.1.1.cmml" xref="S3.T1.6.6.6.1.m1.1.1"><ci id="S3.T1.6.6.6.1.m1.1.1.1a.cmml" xref="S3.T1.6.6.6.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.6.6.6.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.6.6.6.1.m1.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.6.1.m1.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.6.6.1.m1.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.6.6.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">23.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.6.6.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">54.5</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.6.6.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">49.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.6.6.6.5" style="padding-left:3.0pt;padding-right:3.0pt;">45.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.6.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">18.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.6.6.6.7" style="padding-left:3.0pt;padding-right:3.0pt;">29.4</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.6.6.6.8" style="padding-left:3.0pt;padding-right:3.0pt;">61.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.6.6.6.9" style="padding-left:3.0pt;padding-right:3.0pt;">4.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.6.6.6.10" style="padding-left:3.0pt;padding-right:3.0pt;">11.5</td>
<td class="ltx_td ltx_align_right" id="S3.T1.6.6.6.11" style="padding-left:3.0pt;padding-right:3.0pt;">2.5</td>
<td class="ltx_td ltx_align_right" id="S3.T1.6.6.6.12" style="padding-left:3.0pt;padding-right:3.0pt;">3.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.6.6.6.13" style="padding-left:3.0pt;padding-right:3.0pt;">15.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.6.6.6.14" style="padding-left:3.0pt;padding-right:3.0pt;">20.0</td>
<td class="ltx_td" id="S3.T1.6.6.6.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.7.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.7.7.7.1" style="padding-left:3.0pt;padding-right:3.0pt;">SAIL<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="S3.T1.7.7.7.1.m1.1"><semantics id="S3.T1.7.7.7.1.m1.1a"><msub id="S3.T1.7.7.7.1.m1.1.1" xref="S3.T1.7.7.7.1.m1.1.1.cmml"><mi id="S3.T1.7.7.7.1.m1.1.1a" xref="S3.T1.7.7.7.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.7.7.7.1.m1.1.1.1" xref="S3.T1.7.7.7.1.m1.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.7.1.m1.1b"><apply id="S3.T1.7.7.7.1.m1.1.1.cmml" xref="S3.T1.7.7.7.1.m1.1.1"><ci id="S3.T1.7.7.7.1.m1.1.1.1a.cmml" xref="S3.T1.7.7.7.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.7.7.7.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.7.7.7.1.m1.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.7.1.m1.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.7.7.1.m1.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.7.7.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">22.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.7.7.7.3" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.7.7.7.4" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.7.7.7.5" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.7.7.7.6" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.7.7.7.7" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.7.7.7.8" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.7.7.7.9" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.7.7.7.10" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.7.7.7.11" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.7.7.7.12" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.7.7.7.13" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.7.7.7.14" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td" id="S3.T1.7.7.7.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.8.8.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.8.8.8.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_ERROR undefined" id="S3.T1.8.8.8.1.1">\cdashline</span>1-14
Llama2<math alttext="{}_{\textsc{13B}}" class="ltx_Math" display="inline" id="S3.T1.8.8.8.1.m1.1"><semantics id="S3.T1.8.8.8.1.m1.1a"><msub id="S3.T1.8.8.8.1.m1.1.1" xref="S3.T1.8.8.8.1.m1.1.1.cmml"><mi id="S3.T1.8.8.8.1.m1.1.1a" xref="S3.T1.8.8.8.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.8.8.8.1.m1.1.1.1" xref="S3.T1.8.8.8.1.m1.1.1.1a.cmml">13B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.8.1.m1.1b"><apply id="S3.T1.8.8.8.1.m1.1.1.cmml" xref="S3.T1.8.8.8.1.m1.1.1"><ci id="S3.T1.8.8.8.1.m1.1.1.1a.cmml" xref="S3.T1.8.8.8.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.8.8.8.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.8.8.8.1.m1.1.1.1">13B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.8.1.m1.1c">{}_{\textsc{13B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.8.8.1.m1.1d">start_FLOATSUBSCRIPT 13B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.8.8.8.2" style="padding-left:3.0pt;padding-right:3.0pt;">14.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.8.8.8.3" style="padding-left:3.0pt;padding-right:3.0pt;">38.5</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.8.8.8.4" style="padding-left:3.0pt;padding-right:3.0pt;">29.4</td>
<td class="ltx_td ltx_align_right" id="S3.T1.8.8.8.5" style="padding-left:3.0pt;padding-right:3.0pt;">53.4</td>
<td class="ltx_td ltx_align_right" id="S3.T1.8.8.8.6" style="padding-left:3.0pt;padding-right:3.0pt;">7.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.8.8.8.7" style="padding-left:3.0pt;padding-right:3.0pt;">12.4</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.8.8.8.8" style="padding-left:3.0pt;padding-right:3.0pt;">16.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.8.8.8.9" style="padding-left:3.0pt;padding-right:3.0pt;">14.9</td>
<td class="ltx_td ltx_align_right" id="S3.T1.8.8.8.10" style="padding-left:3.0pt;padding-right:3.0pt;">21.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.8.8.8.11" style="padding-left:3.0pt;padding-right:3.0pt;">1.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.8.8.8.12" style="padding-left:3.0pt;padding-right:3.0pt;">5.4</td>
<td class="ltx_td ltx_align_right" id="S3.T1.8.8.8.13" style="padding-left:3.0pt;padding-right:3.0pt;">21.4</td>
<td class="ltx_td ltx_align_right" id="S3.T1.8.8.8.14" style="padding-left:3.0pt;padding-right:3.0pt;">25.2</td>
<td class="ltx_td" id="S3.T1.8.8.8.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.9.9.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.9.9.9.1" style="padding-left:3.0pt;padding-right:3.0pt;">Alpaca<math alttext="{}_{\textsc{13B}}" class="ltx_Math" display="inline" id="S3.T1.9.9.9.1.m1.1"><semantics id="S3.T1.9.9.9.1.m1.1a"><msub id="S3.T1.9.9.9.1.m1.1.1" xref="S3.T1.9.9.9.1.m1.1.1.cmml"><mi id="S3.T1.9.9.9.1.m1.1.1a" xref="S3.T1.9.9.9.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.9.9.9.1.m1.1.1.1" xref="S3.T1.9.9.9.1.m1.1.1.1a.cmml">13B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.9.1.m1.1b"><apply id="S3.T1.9.9.9.1.m1.1.1.cmml" xref="S3.T1.9.9.9.1.m1.1.1"><ci id="S3.T1.9.9.9.1.m1.1.1.1a.cmml" xref="S3.T1.9.9.9.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.9.9.9.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.9.9.9.1.m1.1.1.1">13B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.9.1.m1.1c">{}_{\textsc{13B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.9.9.1.m1.1d">start_FLOATSUBSCRIPT 13B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.9.9.9.2" style="padding-left:3.0pt;padding-right:3.0pt;">24.4</td>
<td class="ltx_td ltx_align_right" id="S3.T1.9.9.9.3" style="padding-left:3.0pt;padding-right:3.0pt;">61.3</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.9.9.9.4" style="padding-left:3.0pt;padding-right:3.0pt;">55.5</td>
<td class="ltx_td ltx_align_right" id="S3.T1.9.9.9.5" style="padding-left:3.0pt;padding-right:3.0pt;">50.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.9.9.9.6" style="padding-left:3.0pt;padding-right:3.0pt;">22.9</td>
<td class="ltx_td ltx_align_right" id="S3.T1.9.9.9.7" style="padding-left:3.0pt;padding-right:3.0pt;">32.0</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.9.9.9.8" style="padding-left:3.0pt;padding-right:3.0pt;">70.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.9.9.9.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.9.9.9.10" style="padding-left:3.0pt;padding-right:3.0pt;">6.1</td>
<td class="ltx_td ltx_align_right" id="S3.T1.9.9.9.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.9.9.9.12" style="padding-left:3.0pt;padding-right:3.0pt;">3.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.9.9.9.13" style="padding-left:3.0pt;padding-right:3.0pt;">3.1</td>
<td class="ltx_td ltx_align_right" id="S3.T1.9.9.9.14" style="padding-left:3.0pt;padding-right:3.0pt;">12.0</td>
<td class="ltx_td" id="S3.T1.9.9.9.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.10.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.10.10.10.1" style="padding-left:3.0pt;padding-right:3.0pt;">CoVE<math alttext="{}_{\textsc{65B}}" class="ltx_Math" display="inline" id="S3.T1.10.10.10.1.m1.1"><semantics id="S3.T1.10.10.10.1.m1.1a"><msub id="S3.T1.10.10.10.1.m1.1.1" xref="S3.T1.10.10.10.1.m1.1.1.cmml"><mi id="S3.T1.10.10.10.1.m1.1.1a" xref="S3.T1.10.10.10.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.10.10.10.1.m1.1.1.1" xref="S3.T1.10.10.10.1.m1.1.1.1a.cmml">65B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.10.1.m1.1b"><apply id="S3.T1.10.10.10.1.m1.1.1.cmml" xref="S3.T1.10.10.10.1.m1.1.1"><ci id="S3.T1.10.10.10.1.m1.1.1.1a.cmml" xref="S3.T1.10.10.10.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.10.10.10.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.10.10.10.1.m1.1.1.1">65B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.10.1.m1.1c">{}_{\textsc{65B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.10.10.1.m1.1d">start_FLOATSUBSCRIPT 65B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.10.10.10.2" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.10.10.10.3" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.10.10.10.4" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.10.10.10.5" style="padding-left:3.0pt;padding-right:3.0pt;">71.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.10.10.10.6" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.10.10.10.7" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.10.10.10.8" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.10.10.10.9" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.10.10.10.10" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.10.10.10.11" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.10.10.10.12" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.10.10.10.13" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.10.10.10.14" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td" id="S3.T1.10.10.10.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.22.32.10">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="14" id="S3.T1.22.22.32.10.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="S3.T1.22.22.32.10.1.1">Baselines with retrieval</span></td>
<td class="ltx_td ltx_border_t" id="S3.T1.22.22.32.10.2" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.11.11.11">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.11.11.11.1" style="padding-left:3.0pt;padding-right:3.0pt;">Llama2<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="S3.T1.11.11.11.1.m1.1"><semantics id="S3.T1.11.11.11.1.m1.1a"><msub id="S3.T1.11.11.11.1.m1.1.1" xref="S3.T1.11.11.11.1.m1.1.1.cmml"><mi id="S3.T1.11.11.11.1.m1.1.1a" xref="S3.T1.11.11.11.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.11.11.11.1.m1.1.1.1" xref="S3.T1.11.11.11.1.m1.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.11.1.m1.1b"><apply id="S3.T1.11.11.11.1.m1.1.1.cmml" xref="S3.T1.11.11.11.1.m1.1.1"><ci id="S3.T1.11.11.11.1.m1.1.1.1a.cmml" xref="S3.T1.11.11.11.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.11.11.11.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.11.11.11.1.m1.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.11.1.m1.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.11.11.11.1.m1.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.11.11.11.2" style="padding-left:3.0pt;padding-right:3.0pt;">38.2</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.11.11.11.3" style="padding-left:3.0pt;padding-right:3.0pt;">48.8</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T1.11.11.11.4" style="padding-left:3.0pt;padding-right:3.0pt;">30.0</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.11.11.11.5" style="padding-left:3.0pt;padding-right:3.0pt;">78.0</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.11.11.11.6" style="padding-left:3.0pt;padding-right:3.0pt;">15.2</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.11.11.11.7" style="padding-left:3.0pt;padding-right:3.0pt;">22.1</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T1.11.11.11.8" style="padding-left:3.0pt;padding-right:3.0pt;">32.0</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.11.11.11.9" style="padding-left:3.0pt;padding-right:3.0pt;">5.9</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.11.11.11.10" style="padding-left:3.0pt;padding-right:3.0pt;">19.4</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.11.11.11.11" style="padding-left:3.0pt;padding-right:3.0pt;">3.4</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.11.11.11.12" style="padding-left:3.0pt;padding-right:3.0pt;">10.5</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.11.11.11.13" style="padding-left:3.0pt;padding-right:3.0pt;">11.9</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.11.11.11.14" style="padding-left:3.0pt;padding-right:3.0pt;">19.2</td>
<td class="ltx_td ltx_border_t" id="S3.T1.11.11.11.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.12.12.12">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.12.12.12.1" style="padding-left:3.0pt;padding-right:3.0pt;">Alpaca<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="S3.T1.12.12.12.1.m1.1"><semantics id="S3.T1.12.12.12.1.m1.1a"><msub id="S3.T1.12.12.12.1.m1.1.1" xref="S3.T1.12.12.12.1.m1.1.1.cmml"><mi id="S3.T1.12.12.12.1.m1.1.1a" xref="S3.T1.12.12.12.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.12.12.12.1.m1.1.1.1" xref="S3.T1.12.12.12.1.m1.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.12.1.m1.1b"><apply id="S3.T1.12.12.12.1.m1.1.1.cmml" xref="S3.T1.12.12.12.1.m1.1.1"><ci id="S3.T1.12.12.12.1.m1.1.1.1a.cmml" xref="S3.T1.12.12.12.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.12.12.12.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.12.12.12.1.m1.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.12.1.m1.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.12.12.12.1.m1.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.12.12.12.2" style="padding-left:3.0pt;padding-right:3.0pt;">46.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.12.12.12.3" style="padding-left:3.0pt;padding-right:3.0pt;">64.1</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.12.12.12.4" style="padding-left:3.0pt;padding-right:3.0pt;">40.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.12.12.12.5" style="padding-left:3.0pt;padding-right:3.0pt;">76.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.12.12.12.6" style="padding-left:3.0pt;padding-right:3.0pt;">30.9</td>
<td class="ltx_td ltx_align_right" id="S3.T1.12.12.12.7" style="padding-left:3.0pt;padding-right:3.0pt;">33.3</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.12.12.12.8" style="padding-left:3.0pt;padding-right:3.0pt;">57.9</td>
<td class="ltx_td ltx_align_right" id="S3.T1.12.12.12.9" style="padding-left:3.0pt;padding-right:3.0pt;">23.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.12.12.12.10" style="padding-left:3.0pt;padding-right:3.0pt;">35.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.12.12.12.11" style="padding-left:3.0pt;padding-right:3.0pt;">6.4</td>
<td class="ltx_td ltx_align_right" id="S3.T1.12.12.12.12" style="padding-left:3.0pt;padding-right:3.0pt;">14.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.12.12.12.13" style="padding-left:3.0pt;padding-right:3.0pt;">18.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.12.12.12.14" style="padding-left:3.0pt;padding-right:3.0pt;">23.8</td>
<td class="ltx_td" id="S3.T1.12.12.12.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.13.13.13">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.13.13.13.1" style="padding-left:3.0pt;padding-right:3.0pt;">SAIL<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="S3.T1.13.13.13.1.m1.1"><semantics id="S3.T1.13.13.13.1.m1.1a"><msub id="S3.T1.13.13.13.1.m1.1.1" xref="S3.T1.13.13.13.1.m1.1.1.cmml"><mi id="S3.T1.13.13.13.1.m1.1.1a" xref="S3.T1.13.13.13.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.13.13.13.1.m1.1.1.1" xref="S3.T1.13.13.13.1.m1.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.13.1.m1.1b"><apply id="S3.T1.13.13.13.1.m1.1.1.cmml" xref="S3.T1.13.13.13.1.m1.1.1"><ci id="S3.T1.13.13.13.1.m1.1.1.1a.cmml" xref="S3.T1.13.13.13.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.13.13.13.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.13.13.13.1.m1.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.13.1.m1.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.13.13.13.1.m1.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.13.13.13.2" style="padding-left:3.0pt;padding-right:3.0pt;">44.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.13.13.13.3" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.13.13.13.4" style="padding-left:3.0pt;padding-right:3.0pt;">69.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.13.13.13.5" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.13.13.13.6" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.13.13.13.7" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.13.13.13.8" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.13.13.13.9" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.13.13.13.10" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.13.13.13.11" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.13.13.13.12" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.13.13.13.13" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.13.13.13.14" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td" id="S3.T1.13.13.13.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.14.14">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.14.14.14.1" style="padding-left:3.0pt;padding-right:3.0pt;">Self-RAG<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="S3.T1.14.14.14.1.m1.1"><semantics id="S3.T1.14.14.14.1.m1.1a"><msub id="S3.T1.14.14.14.1.m1.1.1" xref="S3.T1.14.14.14.1.m1.1.1.cmml"><mi id="S3.T1.14.14.14.1.m1.1.1a" xref="S3.T1.14.14.14.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.14.14.14.1.m1.1.1.1" xref="S3.T1.14.14.14.1.m1.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.14.1.m1.1b"><apply id="S3.T1.14.14.14.1.m1.1.1.cmml" xref="S3.T1.14.14.14.1.m1.1.1"><ci id="S3.T1.14.14.14.1.m1.1.1.1a.cmml" xref="S3.T1.14.14.14.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.14.14.14.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.14.14.14.1.m1.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.14.1.m1.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.14.14.14.1.m1.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.14.14.14.2" style="padding-left:3.0pt;padding-right:3.0pt;">54.9</td>
<td class="ltx_td ltx_align_right" id="S3.T1.14.14.14.3" style="padding-left:3.0pt;padding-right:3.0pt;">66.1</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.14.14.14.4" style="padding-left:3.0pt;padding-right:3.0pt;">72.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.14.14.14.5" style="padding-left:3.0pt;padding-right:3.0pt;">78.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.14.14.14.6" style="padding-left:3.0pt;padding-right:3.0pt;">30.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.14.14.14.7" style="padding-left:3.0pt;padding-right:3.0pt;">35.7</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.14.14.14.8" style="padding-left:3.0pt;padding-right:3.0pt;">74.9</td>
<td class="ltx_td ltx_align_right" id="S3.T1.14.14.14.9" style="padding-left:3.0pt;padding-right:3.0pt;">40.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.14.14.14.10" style="padding-left:3.0pt;padding-right:3.0pt;">54.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.14.14.14.11" style="padding-left:3.0pt;padding-right:3.0pt;">22.1</td>
<td class="ltx_td ltx_align_right" id="S3.T1.14.14.14.12" style="padding-left:3.0pt;padding-right:3.0pt;">33.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.14.14.14.13" style="padding-left:3.0pt;padding-right:3.0pt;">24.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.14.14.14.14" style="padding-left:3.0pt;padding-right:3.0pt;">35.8</td>
<td class="ltx_td" id="S3.T1.14.14.14.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.15.15.15">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.15.15.15.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_ERROR undefined" id="S3.T1.15.15.15.1.1">\cdashline</span>1-14
Llama2<math alttext="{}_{\textsc{13B}}" class="ltx_Math" display="inline" id="S3.T1.15.15.15.1.m1.1"><semantics id="S3.T1.15.15.15.1.m1.1a"><msub id="S3.T1.15.15.15.1.m1.1.1" xref="S3.T1.15.15.15.1.m1.1.1.cmml"><mi id="S3.T1.15.15.15.1.m1.1.1a" xref="S3.T1.15.15.15.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.15.15.15.1.m1.1.1.1" xref="S3.T1.15.15.15.1.m1.1.1.1a.cmml">13B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.15.1.m1.1b"><apply id="S3.T1.15.15.15.1.m1.1.1.cmml" xref="S3.T1.15.15.15.1.m1.1.1"><ci id="S3.T1.15.15.15.1.m1.1.1.1a.cmml" xref="S3.T1.15.15.15.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.15.15.15.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.15.15.15.1.m1.1.1.1">13B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.15.1.m1.1c">{}_{\textsc{13B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.15.15.15.1.m1.1d">start_FLOATSUBSCRIPT 13B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.15.15.15.2" style="padding-left:3.0pt;padding-right:3.0pt;">38.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.15.15.15.3" style="padding-left:3.0pt;padding-right:3.0pt;">42.5</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.15.15.15.4" style="padding-left:3.0pt;padding-right:3.0pt;">30.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.15.15.15.5" style="padding-left:3.0pt;padding-right:3.0pt;">78.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.15.15.15.6" style="padding-left:3.0pt;padding-right:3.0pt;">15.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.15.15.15.7" style="padding-left:3.0pt;padding-right:3.0pt;">22.1</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.15.15.15.8" style="padding-left:3.0pt;padding-right:3.0pt;">32.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.15.15.15.9" style="padding-left:3.0pt;padding-right:3.0pt;">26.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.15.15.15.10" style="padding-left:3.0pt;padding-right:3.0pt;">38.5</td>
<td class="ltx_td ltx_align_right" id="S3.T1.15.15.15.11" style="padding-left:3.0pt;padding-right:3.0pt;">10.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.15.15.15.12" style="padding-left:3.0pt;padding-right:3.0pt;">18.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.15.15.15.13" style="padding-left:3.0pt;padding-right:3.0pt;">20.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.15.15.15.14" style="padding-left:3.0pt;padding-right:3.0pt;">27.4</td>
<td class="ltx_td" id="S3.T1.15.15.15.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.16.16.16">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.16.16.16.1" style="padding-left:3.0pt;padding-right:3.0pt;">Alpaca<math alttext="{}_{\textsc{13B}}" class="ltx_Math" display="inline" id="S3.T1.16.16.16.1.m1.1"><semantics id="S3.T1.16.16.16.1.m1.1a"><msub id="S3.T1.16.16.16.1.m1.1.1" xref="S3.T1.16.16.16.1.m1.1.1.cmml"><mi id="S3.T1.16.16.16.1.m1.1.1a" xref="S3.T1.16.16.16.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.16.16.16.1.m1.1.1.1" xref="S3.T1.16.16.16.1.m1.1.1.1a.cmml">13B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.16.1.m1.1b"><apply id="S3.T1.16.16.16.1.m1.1.1.cmml" xref="S3.T1.16.16.16.1.m1.1.1"><ci id="S3.T1.16.16.16.1.m1.1.1.1a.cmml" xref="S3.T1.16.16.16.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.16.16.16.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.16.16.16.1.m1.1.1.1">13B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.16.1.m1.1c">{}_{\textsc{13B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.16.16.16.1.m1.1d">start_FLOATSUBSCRIPT 13B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.16.16.16.2" style="padding-left:3.0pt;padding-right:3.0pt;">46.1</td>
<td class="ltx_td ltx_align_right" id="S3.T1.16.16.16.3" style="padding-left:3.0pt;padding-right:3.0pt;">66.9</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.16.16.16.4" style="padding-left:3.0pt;padding-right:3.0pt;">51.1</td>
<td class="ltx_td ltx_align_right" id="S3.T1.16.16.16.5" style="padding-left:3.0pt;padding-right:3.0pt;">77.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.16.16.16.6" style="padding-left:3.0pt;padding-right:3.0pt;">34.8</td>
<td class="ltx_td ltx_align_right" id="S3.T1.16.16.16.7" style="padding-left:3.0pt;padding-right:3.0pt;">36.7</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.16.16.16.8" style="padding-left:3.0pt;padding-right:3.0pt;">56.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.16.16.16.9" style="padding-left:3.0pt;padding-right:3.0pt;">12.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.16.16.16.10" style="padding-left:3.0pt;padding-right:3.0pt;">27.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.16.16.16.11" style="padding-left:3.0pt;padding-right:3.0pt;">2.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.16.16.16.12" style="padding-left:3.0pt;padding-right:3.0pt;">10.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.16.16.16.13" style="padding-left:3.0pt;padding-right:3.0pt;">7.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.16.16.16.14" style="padding-left:3.0pt;padding-right:3.0pt;">17.1</td>
<td class="ltx_td" id="S3.T1.16.16.16.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.17.17">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.17.17.17.1" style="padding-left:3.0pt;padding-right:3.0pt;">Self-RAG<math alttext="{}_{\textsc{13B}}" class="ltx_Math" display="inline" id="S3.T1.17.17.17.1.m1.1"><semantics id="S3.T1.17.17.17.1.m1.1a"><msub id="S3.T1.17.17.17.1.m1.1.1" xref="S3.T1.17.17.17.1.m1.1.1.cmml"><mi id="S3.T1.17.17.17.1.m1.1.1a" xref="S3.T1.17.17.17.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.17.17.17.1.m1.1.1.1" xref="S3.T1.17.17.17.1.m1.1.1.1a.cmml">13B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.17.1.m1.1b"><apply id="S3.T1.17.17.17.1.m1.1.1.cmml" xref="S3.T1.17.17.17.1.m1.1.1"><ci id="S3.T1.17.17.17.1.m1.1.1.1a.cmml" xref="S3.T1.17.17.17.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.17.17.17.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.17.17.17.1.m1.1.1.1">13B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.17.1.m1.1c">{}_{\textsc{13B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.17.17.17.1.m1.1d">start_FLOATSUBSCRIPT 13B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.17.17.17.2" style="padding-left:3.0pt;padding-right:3.0pt;">56.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.17.17.17.3" style="padding-left:3.0pt;padding-right:3.0pt;">67.5</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.17.17.17.4" style="padding-left:3.0pt;padding-right:3.0pt;">76.3</td>
<td class="ltx_td ltx_align_right" id="S3.T1.17.17.17.5" style="padding-left:3.0pt;padding-right:3.0pt;">81.1</td>
<td class="ltx_td ltx_align_right" id="S3.T1.17.17.17.6" style="padding-left:3.0pt;padding-right:3.0pt;">31.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.17.17.17.7" style="padding-left:3.0pt;padding-right:3.0pt;">35.9</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.17.17.17.8" style="padding-left:3.0pt;padding-right:3.0pt;">69.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.17.17.17.9" style="padding-left:3.0pt;padding-right:3.0pt;">44.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.17.17.17.10" style="padding-left:3.0pt;padding-right:3.0pt;">58.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.17.17.17.11" style="padding-left:3.0pt;padding-right:3.0pt;">22.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.17.17.17.12" style="padding-left:3.0pt;padding-right:3.0pt;">40.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.17.17.17.13" style="padding-left:3.0pt;padding-right:3.0pt;">17.7</td>
<td class="ltx_td ltx_align_right" id="S3.T1.17.17.17.14" style="padding-left:3.0pt;padding-right:3.0pt;">31.8</td>
<td class="ltx_td" id="S3.T1.17.17.17.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.18.18.18">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.18.18.18.1" style="padding-left:3.0pt;padding-right:3.0pt;">LongChat<math alttext="{}_{\textsc{13B}}" class="ltx_Math" display="inline" id="S3.T1.18.18.18.1.m1.1"><semantics id="S3.T1.18.18.18.1.m1.1a"><msub id="S3.T1.18.18.18.1.m1.1.1" xref="S3.T1.18.18.18.1.m1.1.1.cmml"><mi id="S3.T1.18.18.18.1.m1.1.1a" xref="S3.T1.18.18.18.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S3.T1.18.18.18.1.m1.1.1.1" xref="S3.T1.18.18.18.1.m1.1.1.1a.cmml">13B</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T1.18.18.18.1.m1.1b"><apply id="S3.T1.18.18.18.1.m1.1.1.cmml" xref="S3.T1.18.18.18.1.m1.1.1"><ci id="S3.T1.18.18.18.1.m1.1.1.1a.cmml" xref="S3.T1.18.18.18.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S3.T1.18.18.18.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T1.18.18.18.1.m1.1.1.1">13B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.18.18.1.m1.1c">{}_{\textsc{13B}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.18.18.18.1.m1.1d">start_FLOATSUBSCRIPT 13B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.18.18.18.2" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.18.18.18.3" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.18.18.18.4" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.18.18.18.5" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.18.18.18.6" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.18.18.18.7" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.18.18.18.8" style="padding-left:3.0pt;padding-right:3.0pt;">–</td>
<td class="ltx_td ltx_align_right" id="S3.T1.18.18.18.9" style="padding-left:3.0pt;padding-right:3.0pt;">25.0</td>
<td class="ltx_td ltx_align_right" id="S3.T1.18.18.18.10" style="padding-left:3.0pt;padding-right:3.0pt;">40.6</td>
<td class="ltx_td ltx_align_right" id="S3.T1.18.18.18.11" style="padding-left:3.0pt;padding-right:3.0pt;">7.9</td>
<td class="ltx_td ltx_align_right" id="S3.T1.18.18.18.12" style="padding-left:3.0pt;padding-right:3.0pt;">18.9</td>
<td class="ltx_td ltx_align_right" id="S3.T1.18.18.18.13" style="padding-left:3.0pt;padding-right:3.0pt;">18.2</td>
<td class="ltx_td ltx_align_right" id="S3.T1.18.18.18.14" style="padding-left:3.0pt;padding-right:3.0pt;">29.2</td>
<td class="ltx_td" id="S3.T1.18.18.18.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.20.20.20" style="background-color:#E6E6E6;">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.20.20.20.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_ERROR undefined" id="S3.T1.20.20.20.2.3">\cdashline</span>1-14
<span class="ltx_text" id="S3.T1.20.20.20.2.2" style="background-color:#E6E6E6;"> <span class="ltx_text ltx_font_smallcaps" id="S3.T1.20.20.20.2.2.2" style="background-color:#E6E6E6;">Open-RAG<sup class="ltx_sup" id="S3.T1.20.20.20.2.2.2.1"><span class="ltx_text ltx_font_italic" id="S3.T1.20.20.20.2.2.2.1.1">‡</span></sup><math alttext="{}_{\textsc{7B+8}\times\textsc{135M}}" class="ltx_Math" display="inline" id="S3.T1.20.20.20.2.2.2.m2.1"><semantics id="S3.T1.20.20.20.2.2.2.m2.1a"><msub id="S3.T1.20.20.20.2.2.2.m2.1.1" xref="S3.T1.20.20.20.2.2.2.m2.1.1.cmml"><mi id="S3.T1.20.20.20.2.2.2.m2.1.1a" xref="S3.T1.20.20.20.2.2.2.m2.1.1.cmml"></mi><mrow id="S3.T1.20.20.20.2.2.2.m2.1.1.1" xref="S3.T1.20.20.20.2.2.2.m2.1.1.1.cmml"><mtext class="ltx_font_smallcaps" id="S3.T1.20.20.20.2.2.2.m2.1.1.1.2" mathbackground="#E6E6E6" xref="S3.T1.20.20.20.2.2.2.m2.1.1.1.2a.cmml">7B+8</mtext><mo id="S3.T1.20.20.20.2.2.2.m2.1.1.1.1" lspace="0.222em" mathbackground="#E6E6E6" rspace="0.222em" xref="S3.T1.20.20.20.2.2.2.m2.1.1.1.1.cmml">×</mo><mtext class="ltx_font_smallcaps" id="S3.T1.20.20.20.2.2.2.m2.1.1.1.3" mathbackground="#E6E6E6" xref="S3.T1.20.20.20.2.2.2.m2.1.1.1.3a.cmml">135M</mtext></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.20.20.20.2.2.2.m2.1b"><apply id="S3.T1.20.20.20.2.2.2.m2.1.1.cmml" xref="S3.T1.20.20.20.2.2.2.m2.1.1"><apply id="S3.T1.20.20.20.2.2.2.m2.1.1.1.cmml" xref="S3.T1.20.20.20.2.2.2.m2.1.1.1"><times id="S3.T1.20.20.20.2.2.2.m2.1.1.1.1.cmml" xref="S3.T1.20.20.20.2.2.2.m2.1.1.1.1"></times><ci id="S3.T1.20.20.20.2.2.2.m2.1.1.1.2a.cmml" xref="S3.T1.20.20.20.2.2.2.m2.1.1.1.2"><mtext class="ltx_font_smallcaps" id="S3.T1.20.20.20.2.2.2.m2.1.1.1.2.cmml" mathbackground="#E6E6E6" mathsize="70%" xref="S3.T1.20.20.20.2.2.2.m2.1.1.1.2">7B+8</mtext></ci><ci id="S3.T1.20.20.20.2.2.2.m2.1.1.1.3a.cmml" xref="S3.T1.20.20.20.2.2.2.m2.1.1.1.3"><mtext class="ltx_font_smallcaps" id="S3.T1.20.20.20.2.2.2.m2.1.1.1.3.cmml" mathbackground="#E6E6E6" mathsize="70%" xref="S3.T1.20.20.20.2.2.2.m2.1.1.1.3">135M</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.20.20.20.2.2.2.m2.1c">{}_{\textsc{7B+8}\times\textsc{135M}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.20.20.20.2.2.2.m2.1d">start_FLOATSUBSCRIPT 7B+8 × 135M end_FLOATSUBSCRIPT</annotation></semantics></math></span></span>
</td>
<td class="ltx_td ltx_align_right" id="S3.T1.20.20.20.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.3.1" style="background-color:#E6E6E6;">58.3</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.20.20.20.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.4.1" style="background-color:#E6E6E6;">66.3</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.20.20.20.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.5.1" style="background-color:#E6E6E6;">75.9</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.20.20.20.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.6.1" style="background-color:#E6E6E6;">82.2</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.20.20.20.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.7.1" style="background-color:#E6E6E6;">31.9</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.20.20.20.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.8.1" style="background-color:#E6E6E6;">36.7</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.20.20.20.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.9.1" style="background-color:#E6E6E6;">84.3</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.20.20.20.10" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.10.1" style="background-color:#E6E6E6;">63.3</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.20.20.20.11" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.11.1" style="background-color:#E6E6E6;">76.9</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.20.20.20.12" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.12.1" style="background-color:#E6E6E6;">41.6</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.20.20.20.13" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.13.1" style="background-color:#E6E6E6;">55.3</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.20.20.20.14" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.14.1" style="background-color:#E6E6E6;">51.5</span></td>
<td class="ltx_td ltx_align_right" id="S3.T1.20.20.20.15" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.20.15.1" style="background-color:#E6E6E6;">61.0</span></td>
<td class="ltx_td" id="S3.T1.20.20.20.16" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.22.22" style="background-color:#E6E6E6;">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S3.T1.21.21.21.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.21.21.21.1.1" style="background-color:#E6E6E6;">Open-RAG<math alttext="{}_{\textsc{13B+8}\times\textsc{213M}}" class="ltx_Math" display="inline" id="S3.T1.21.21.21.1.1.m1.1"><semantics id="S3.T1.21.21.21.1.1.m1.1a"><msub id="S3.T1.21.21.21.1.1.m1.1.1" xref="S3.T1.21.21.21.1.1.m1.1.1.cmml"><mi id="S3.T1.21.21.21.1.1.m1.1.1a" xref="S3.T1.21.21.21.1.1.m1.1.1.cmml"></mi><mrow id="S3.T1.21.21.21.1.1.m1.1.1.1" xref="S3.T1.21.21.21.1.1.m1.1.1.1.cmml"><mtext class="ltx_font_smallcaps" id="S3.T1.21.21.21.1.1.m1.1.1.1.2" mathbackground="#E6E6E6" xref="S3.T1.21.21.21.1.1.m1.1.1.1.2a.cmml">13B+8</mtext><mo id="S3.T1.21.21.21.1.1.m1.1.1.1.1" lspace="0.222em" mathbackground="#E6E6E6" rspace="0.222em" xref="S3.T1.21.21.21.1.1.m1.1.1.1.1.cmml">×</mo><mtext class="ltx_font_smallcaps" id="S3.T1.21.21.21.1.1.m1.1.1.1.3" mathbackground="#E6E6E6" xref="S3.T1.21.21.21.1.1.m1.1.1.1.3a.cmml">213M</mtext></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.21.21.21.1.1.m1.1b"><apply id="S3.T1.21.21.21.1.1.m1.1.1.cmml" xref="S3.T1.21.21.21.1.1.m1.1.1"><apply id="S3.T1.21.21.21.1.1.m1.1.1.1.cmml" xref="S3.T1.21.21.21.1.1.m1.1.1.1"><times id="S3.T1.21.21.21.1.1.m1.1.1.1.1.cmml" xref="S3.T1.21.21.21.1.1.m1.1.1.1.1"></times><ci id="S3.T1.21.21.21.1.1.m1.1.1.1.2a.cmml" xref="S3.T1.21.21.21.1.1.m1.1.1.1.2"><mtext class="ltx_font_smallcaps" id="S3.T1.21.21.21.1.1.m1.1.1.1.2.cmml" mathbackground="#E6E6E6" mathsize="70%" xref="S3.T1.21.21.21.1.1.m1.1.1.1.2">13B+8</mtext></ci><ci id="S3.T1.21.21.21.1.1.m1.1.1.1.3a.cmml" xref="S3.T1.21.21.21.1.1.m1.1.1.1.3"><mtext class="ltx_font_smallcaps" id="S3.T1.21.21.21.1.1.m1.1.1.1.3.cmml" mathbackground="#E6E6E6" mathsize="70%" xref="S3.T1.21.21.21.1.1.m1.1.1.1.3">213M</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.21.21.21.1.1.m1.1c">{}_{\textsc{13B+8}\times\textsc{213M}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.21.21.21.1.1.m1.1d">start_FLOATSUBSCRIPT 13B+8 × 213M end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.22.22.22.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.3.1" style="background-color:#E6E6E6;">59.5</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.22.22.22.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.4.1" style="background-color:#E6E6E6;">69.6</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_r" id="S3.T1.22.22.22.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.5.1" style="background-color:#E6E6E6;">77.2</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.22.22.22.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.2.1" style="background-color:#E6E6E6;">81.7<sup class="ltx_sup" id="S3.T1.22.22.22.2.1.1"><span class="ltx_text ltx_font_medium" id="S3.T1.22.22.22.2.1.1.1">#</span></sup></span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.22.22.22.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.6.1" style="background-color:#E6E6E6;">36.3</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.22.22.22.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.7.1" style="background-color:#E6E6E6;">38.1</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_r" id="S3.T1.22.22.22.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.8.1" style="background-color:#E6E6E6;">80.0</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.22.22.22.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.9.1" style="background-color:#E6E6E6;">66.2</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.22.22.22.10" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.10.1" style="background-color:#E6E6E6;">80.1</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.22.22.22.11" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.11.1" style="background-color:#E6E6E6;">46.0</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.22.22.22.12" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.12.1" style="background-color:#E6E6E6;">60.1</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.22.22.22.13" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.13.1" style="background-color:#E6E6E6;">60.7</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.22.22.22.14" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.22.22.22.14.1" style="background-color:#E6E6E6;">70.9</span></td>
<td class="ltx_td ltx_border_bb" id="S3.T1.22.22.22.15" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>
Model performances on RAG tasks. Pop, TQA, Pub, Bio, Hotpot, MuSiQue, 2WikiMH denote PopQA, TriviaQA, PubHealth, Biography Generations, HotpotQA, MuSiQue-Ans, 2WikiMultihopQA. Acc, FS, SM, rg, mau, EM, and F1 denote accuracy, FactScore (factuality), str-em, rouge (correctness), MAUVE (fluency), exact match, and F1 scores. <sup class="ltx_sup" id="S3.T1.37.1">#</sup>: evaluated using ‘gpt-3.5-turbo-instruct’ instead of ‘text-davinci-003’. <sup class="ltx_sup" id="S3.T1.38.2">∗</sup>: using 4-bit quantized model. <sup class="ltx_sup" id="S3.T1.39.3"><span class="ltx_text ltx_font_italic" id="S3.T1.39.3.1">†</span></sup>: using a proprietary retriever with Tree-of-Thought prompting. <sup class="ltx_sup" id="S3.T1.40.4"><span class="ltx_text ltx_font_italic" id="S3.T1.40.4.1">‡</span></sup>: <span class="ltx_text ltx_font_smallcaps" id="S3.T1.41.5">Open-RAG</span> model with 7.8B total and 7.0B active parameters.
<span class="ltx_text" id="S3.T1.42.6" style="color:#808080;">Gray</span> results are best performances with larger/proprietary models.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Baselines</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p1.1.1">Baselines without retrievals.</span>
We compare ours with several strong, publicly available pre-trained LLMs, including Llama2-7B,13B  <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib37" title="">2023</a>)</cite>, SAIL-7B <cite class="ltx_cite ltx_citemacro_citep">(Luo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib24" title="">2023</a>)</cite> as well as instruction-tuned models, Alpaca-7B,13B <cite class="ltx_cite ltx_citemacro_citep">(Dubois et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib8" title="">2023</a>)</cite>. Additionally, we consider models trained and reinforced with private data such as ChatGPT <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib30" title="">2022</a>)</cite>. For instruction-tuned LMs, we utilize the official system prompt or instruction format of the corresponding model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p2.1.1">Baselines with retrievals.</span>
We evaluate models incorporating retrieval during both testing and training phases, focusing on standard Retrieval-Augmented Generation (RAG) baselines with open-source Large Language Models (LLMs) like Llama2, Alpaca and LongChat <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib21" title="">2023</a>)</cite>. These models generate outputs based on queries alongside top retrieved documents using our retriever. We also present results for RAG baselines utilizing private data, including RAG-ChatGPT, RAG2.0 <cite class="ltx_cite ltx_citemacro_citep">(Contextual.AI, <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib6" title="">2024</a>)</cite>, and RAG-Command R+ <cite class="ltx_cite ltx_citemacro_citep">(Cohere Team, <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib5" title="">2024</a>)</cite>, which prepend top-retrieved documents to the query.
Additionally, we assess RQ-RAG <cite class="ltx_cite ltx_citemacro_citep">(Chan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib4" title="">2024</a>)</cite>, which employs proprietary retriever models.
Finally, our comparisons extend to Perplexity.ai, Self-RAG <cite class="ltx_cite ltx_citemacro_citep">(Asai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib2" title="">2024</a>)</cite>, and SAIL <cite class="ltx_cite ltx_citemacro_citep">(Luo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib24" title="">2023</a>)</cite>, which are also finetuned with retrieved texts.</p>
</div>
<figure class="ltx_figure" id="S3.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S3.F4.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="220" id="S3.F4.1.g1" src="x4.png" width="830"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S3.F4.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="220" id="S3.F4.2.g1" src="x5.png" width="830"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>
(Top) Performance vs Retrieval by different adaptive retrieval strategies. 
(Bottom) Performance vs scores from adaptive retrieval. <math alttext="f_{ret}" class="ltx_Math" display="inline" id="S3.F4.4.m1.1"><semantics id="S3.F4.4.m1.1b"><msub id="S3.F4.4.m1.1.1" xref="S3.F4.4.m1.1.1.cmml"><mi id="S3.F4.4.m1.1.1.2" xref="S3.F4.4.m1.1.1.2.cmml">f</mi><mrow id="S3.F4.4.m1.1.1.3" xref="S3.F4.4.m1.1.1.3.cmml"><mi id="S3.F4.4.m1.1.1.3.2" xref="S3.F4.4.m1.1.1.3.2.cmml">r</mi><mo id="S3.F4.4.m1.1.1.3.1" xref="S3.F4.4.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.F4.4.m1.1.1.3.3" xref="S3.F4.4.m1.1.1.3.3.cmml">e</mi><mo id="S3.F4.4.m1.1.1.3.1b" xref="S3.F4.4.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.F4.4.m1.1.1.3.4" xref="S3.F4.4.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F4.4.m1.1c"><apply id="S3.F4.4.m1.1.1.cmml" xref="S3.F4.4.m1.1.1"><csymbol cd="ambiguous" id="S3.F4.4.m1.1.1.1.cmml" xref="S3.F4.4.m1.1.1">subscript</csymbol><ci id="S3.F4.4.m1.1.1.2.cmml" xref="S3.F4.4.m1.1.1.2">𝑓</ci><apply id="S3.F4.4.m1.1.1.3.cmml" xref="S3.F4.4.m1.1.1.3"><times id="S3.F4.4.m1.1.1.3.1.cmml" xref="S3.F4.4.m1.1.1.3.1"></times><ci id="S3.F4.4.m1.1.1.3.2.cmml" xref="S3.F4.4.m1.1.1.3.2">𝑟</ci><ci id="S3.F4.4.m1.1.1.3.3.cmml" xref="S3.F4.4.m1.1.1.3.3">𝑒</ci><ci id="S3.F4.4.m1.1.1.3.4.cmml" xref="S3.F4.4.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.4.m1.1d">f_{ret}</annotation><annotation encoding="application/x-llamapun" id="S3.F4.4.m1.1e">italic_f start_POSTSUBSCRIPT italic_r italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes probability score from external model distilled/predicted <em class="ltx_emph ltx_font_italic" id="S3.F4.6.1">reflection</em> token.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results and Analysis</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Here, we (i) evaluate the RAG models (ii) demonstrate the effectiveness of our adaptive retrieval in balancing the performance-speed (iii) present ablation studies and further analysis.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Main Results</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Comparison against baselines without retrieval.</span>
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S3.T1" title="Table 1 ‣ 3.2 Experimental settings ‣ 3 Experiments ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> (top and middle blocks) shows the performance of open-source baselines without retrieval. <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.1.2">Open-RAG</span> demonstrates substantial performance gains over all supervised fine-tuned LLMs, many of which are larger in size (e.g., 65B CoVE) and even our <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.1.3">Open-RAG</span> outperforms ChatGPT across all metrics and tasks. Particularly in multi-hop reasoning tasks such as HotpotQA, <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.1.4">Open-RAG</span> achieves a significant EM score of 63.3%, surpassing Alpaca<math alttext="{}_{\textsc{13B}}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1a" xref="S4.SS1.p1.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1a.cmml">13B</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><ci id="S4.SS1.p1.1.m1.1.1.1a.cmml" xref="S4.SS1.p1.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S4.SS1.p1.1.m1.1.1.1.cmml" mathsize="70%" xref="S4.SS1.p1.1.m1.1.1.1">13B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">{}_{\textsc{13B}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">start_FLOATSUBSCRIPT 13B end_FLOATSUBSCRIPT</annotation></semantics></math>’s 0.7%. In contrast, while ChatGPT achieves a decent score of 22.4% EM in HotpotQA, its performance drops notably in other multi-hop tasks like MuSiQue, where it achieves only 3.1% EM while <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.1.5">Open-RAG</span> achieves a much higher score of 41.6% EM in MuSiQue, highlighting its robustness and effectiveness in complex query handling compared to both open-source and proprietary LLMs.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.2"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.2.1">Comparison against baselines with retrieval.</span> As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S3.T1" title="Table 1 ‣ 3.2 Experimental settings ‣ 3 Experiments ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> (bottom), <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p2.2.2">Open-RAG</span> consistently outperforms existing open-source RAG models, even those larger in size. It achieves the top performance among non-proprietary LM-based models across all tasks, with the exception of TriviaQA and PubQA, where it is marginally surpassed (by 1.2% and 0.4%, respectively) by the larger Self-RAG<math alttext="{}_{\textsc{13B}}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><msub id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1a" xref="S4.SS1.p2.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1a.cmml">13B</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><ci id="S4.SS1.p2.1.m1.1.1.1a.cmml" xref="S4.SS1.p2.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S4.SS1.p2.1.m1.1.1.1.cmml" mathsize="70%" xref="S4.SS1.p2.1.m1.1.1.1">13B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">{}_{\textsc{13B}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">start_FLOATSUBSCRIPT 13B end_FLOATSUBSCRIPT</annotation></semantics></math> model, and by Alpaca<math alttext="{}_{\textsc{13B}}" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><msub id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1a" xref="S4.SS1.p2.2.m2.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1a.cmml">13B</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><ci id="S4.SS1.p2.2.m2.1.1.1a.cmml" xref="S4.SS1.p2.2.m2.1.1.1"><mtext class="ltx_font_smallcaps" id="S4.SS1.p2.2.m2.1.1.1.cmml" mathsize="70%" xref="S4.SS1.p2.2.m2.1.1.1">13B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">{}_{\textsc{13B}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">start_FLOATSUBSCRIPT 13B end_FLOATSUBSCRIPT</annotation></semantics></math> in a single metric within the ALCE-ASQA dataset.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">We observe that while baseline open-source RAG models achieve higher accuracy, even surpassing strong proprietary models like RAG-ChatGPT in single-hop reasoning tasks, their performance significantly lags in multi-hop reasoning tasks. Our contrastive learning of the distractor contexts substantially enhances the reasoning in <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p3.1.1">Open-RAG</span> and empowers it to outperform the proprietary RAG-ChatGPT in all complex multi-hop datasets.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">Moreover, <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p4.1.2">Open-RAG</span> surpasses RAG 2.0 and 104B Command R+, which are specifically built for RAG tasks, in HotpotQA (63.3% vs. 60.0% EM) and PubQA (75.9% vs. 46.3% Acc). In long-form generation, proprietary models often achieve higher scores, but ours remains highly competitive. For instance, RAG-Command R+ attains a FactScore (FS) of 84.0% in Bio, slightly outperforming <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p4.1.3">Open-RAG</span>’s 82.2%.
In addition, our <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p4.1.1">Open-RAG<math alttext="{}_{\textsc{13B+8}\times\textsc{213M}}" class="ltx_Math" display="inline" id="S4.SS1.p4.1.1.m1.1"><semantics id="S4.SS1.p4.1.1.m1.1a"><msub id="S4.SS1.p4.1.1.m1.1.1" xref="S4.SS1.p4.1.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.1.m1.1.1a" xref="S4.SS1.p4.1.1.m1.1.1.cmml"></mi><mrow id="S4.SS1.p4.1.1.m1.1.1.1" xref="S4.SS1.p4.1.1.m1.1.1.1.cmml"><mtext class="ltx_font_smallcaps" id="S4.SS1.p4.1.1.m1.1.1.1.2" xref="S4.SS1.p4.1.1.m1.1.1.1.2a.cmml">13B+8</mtext><mo id="S4.SS1.p4.1.1.m1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p4.1.1.m1.1.1.1.1.cmml">×</mo><mtext class="ltx_font_smallcaps" id="S4.SS1.p4.1.1.m1.1.1.1.3" xref="S4.SS1.p4.1.1.m1.1.1.1.3a.cmml">213M</mtext></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.1.m1.1b"><apply id="S4.SS1.p4.1.1.m1.1.1.cmml" xref="S4.SS1.p4.1.1.m1.1.1"><apply id="S4.SS1.p4.1.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.1.m1.1.1.1"><times id="S4.SS1.p4.1.1.m1.1.1.1.1.cmml" xref="S4.SS1.p4.1.1.m1.1.1.1.1"></times><ci id="S4.SS1.p4.1.1.m1.1.1.1.2a.cmml" xref="S4.SS1.p4.1.1.m1.1.1.1.2"><mtext class="ltx_font_smallcaps" id="S4.SS1.p4.1.1.m1.1.1.1.2.cmml" mathsize="70%" xref="S4.SS1.p4.1.1.m1.1.1.1.2">13B+8</mtext></ci><ci id="S4.SS1.p4.1.1.m1.1.1.1.3a.cmml" xref="S4.SS1.p4.1.1.m1.1.1.1.3"><mtext class="ltx_font_smallcaps" id="S4.SS1.p4.1.1.m1.1.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p4.1.1.m1.1.1.1.3">213M</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.1.m1.1c">{}_{\textsc{13B+8}\times\textsc{213M}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.1.m1.1d">start_FLOATSUBSCRIPT 13B+8 × 213M end_FLOATSUBSCRIPT</annotation></semantics></math></span> model outperforms all baselines in all multi-hop tasks; and all open baselines in all short-form tasks and shows competitive performance with the proprietary models.
These results highlight the superior ability of <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p4.1.4">Open-RAG</span> to effectively integrate and utilize retrieved information, enhancing both reasoning accuracy and fluency across varying complexities and both short- and long-form generations.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Performance-Speed by Adaptive Retrieval </h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.7">As discussed in Sec <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS3" title="2.3 Hybrid Approach for Adaptive Retrieval ‣ 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">2.3</span></a>, given the query, adaptive retrieval method provides a probability/confidence score from the model. By thresholding on that score, we can control the retrieval frequency and balance the performance-speed trade-off and this can also guide to determine when retrieval is needed. A better scoring method should achieve higher accuracy at any retrieval frequency.
In order to demonstrate our hybrid adaptive retrieval scoring over the existing reflection token probability-based method <math alttext="f_{ret}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">f</mi><mrow id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml"><mi id="S4.SS2.p1.1.m1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.3.2.cmml">r</mi><mo id="S4.SS2.p1.1.m1.1.1.3.1" xref="S4.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.1.m1.1.1.3.3" xref="S4.SS2.p1.1.m1.1.1.3.3.cmml">e</mi><mo id="S4.SS2.p1.1.m1.1.1.3.1a" xref="S4.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.1.m1.1.1.3.4" xref="S4.SS2.p1.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑓</ci><apply id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><times id="S4.SS2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.3.1"></times><ci id="S4.SS2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.3.2">𝑟</ci><ci id="S4.SS2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S4.SS2.p1.1.m1.1.1.3.4.cmml" xref="S4.SS2.p1.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">f_{ret}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_r italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in Self-RAG, in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S3.F4" title="Figure 4 ‣ 3.3 Baselines ‣ 3 Experiments ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, we plot the downstream accuracy vs retrieval frequency (top), and accuracy vs confidence score (bottom) for PopQA, PubHealth, and TriviaQA datasets by sweeping across different threshold values <math alttext="\gamma" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_γ</annotation></semantics></math> (larger <math alttext="\gamma" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_γ</annotation></semantics></math> causes less retrieval) from 0 to 1. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S3.F4" title="Figure 4 ‣ 3.3 Baselines ‣ 3 Experiments ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a> (bottom), we notice that for <math alttext="f_{meanp}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><msub id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">f</mi><mrow id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml"><mi id="S4.SS2.p1.4.m4.1.1.3.2" xref="S4.SS2.p1.4.m4.1.1.3.2.cmml">m</mi><mo id="S4.SS2.p1.4.m4.1.1.3.1" xref="S4.SS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.3.3" xref="S4.SS2.p1.4.m4.1.1.3.3.cmml">e</mi><mo id="S4.SS2.p1.4.m4.1.1.3.1a" xref="S4.SS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.3.4" xref="S4.SS2.p1.4.m4.1.1.3.4.cmml">a</mi><mo id="S4.SS2.p1.4.m4.1.1.3.1b" xref="S4.SS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.3.5" xref="S4.SS2.p1.4.m4.1.1.3.5.cmml">n</mi><mo id="S4.SS2.p1.4.m4.1.1.3.1c" xref="S4.SS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.3.6" xref="S4.SS2.p1.4.m4.1.1.3.6.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝑓</ci><apply id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3"><times id="S4.SS2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.3.1"></times><ci id="S4.SS2.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.3.2">𝑚</ci><ci id="S4.SS2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3">𝑒</ci><ci id="S4.SS2.p1.4.m4.1.1.3.4.cmml" xref="S4.SS2.p1.4.m4.1.1.3.4">𝑎</ci><ci id="S4.SS2.p1.4.m4.1.1.3.5.cmml" xref="S4.SS2.p1.4.m4.1.1.3.5">𝑛</ci><ci id="S4.SS2.p1.4.m4.1.1.3.6.cmml" xref="S4.SS2.p1.4.m4.1.1.3.6">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">f_{meanp}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">italic_f start_POSTSUBSCRIPT italic_m italic_e italic_a italic_n italic_p end_POSTSUBSCRIPT</annotation></semantics></math> or <math alttext="f_{minp}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><msub id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">f</mi><mrow id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.2" xref="S4.SS2.p1.5.m5.1.1.3.2.cmml">m</mi><mo id="S4.SS2.p1.5.m5.1.1.3.1" xref="S4.SS2.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.5.m5.1.1.3.3" xref="S4.SS2.p1.5.m5.1.1.3.3.cmml">i</mi><mo id="S4.SS2.p1.5.m5.1.1.3.1a" xref="S4.SS2.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.5.m5.1.1.3.4" xref="S4.SS2.p1.5.m5.1.1.3.4.cmml">n</mi><mo id="S4.SS2.p1.5.m5.1.1.3.1b" xref="S4.SS2.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.5.m5.1.1.3.5" xref="S4.SS2.p1.5.m5.1.1.3.5.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">𝑓</ci><apply id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3"><times id="S4.SS2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.1"></times><ci id="S4.SS2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2">𝑚</ci><ci id="S4.SS2.p1.5.m5.1.1.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3">𝑖</ci><ci id="S4.SS2.p1.5.m5.1.1.3.4.cmml" xref="S4.SS2.p1.5.m5.1.1.3.4">𝑛</ci><ci id="S4.SS2.p1.5.m5.1.1.3.5.cmml" xref="S4.SS2.p1.5.m5.1.1.3.5">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">f_{minp}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">italic_f start_POSTSUBSCRIPT italic_m italic_i italic_n italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, the accuracy increases with higher values of confidence while <math alttext="f_{meanp}" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.1"><semantics id="S4.SS2.p1.6.m6.1a"><msub id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml"><mi id="S4.SS2.p1.6.m6.1.1.2" xref="S4.SS2.p1.6.m6.1.1.2.cmml">f</mi><mrow id="S4.SS2.p1.6.m6.1.1.3" xref="S4.SS2.p1.6.m6.1.1.3.cmml"><mi id="S4.SS2.p1.6.m6.1.1.3.2" xref="S4.SS2.p1.6.m6.1.1.3.2.cmml">m</mi><mo id="S4.SS2.p1.6.m6.1.1.3.1" xref="S4.SS2.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.6.m6.1.1.3.3" xref="S4.SS2.p1.6.m6.1.1.3.3.cmml">e</mi><mo id="S4.SS2.p1.6.m6.1.1.3.1a" xref="S4.SS2.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.6.m6.1.1.3.4" xref="S4.SS2.p1.6.m6.1.1.3.4.cmml">a</mi><mo id="S4.SS2.p1.6.m6.1.1.3.1b" xref="S4.SS2.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.6.m6.1.1.3.5" xref="S4.SS2.p1.6.m6.1.1.3.5.cmml">n</mi><mo id="S4.SS2.p1.6.m6.1.1.3.1c" xref="S4.SS2.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.6.m6.1.1.3.6" xref="S4.SS2.p1.6.m6.1.1.3.6.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2">𝑓</ci><apply id="S4.SS2.p1.6.m6.1.1.3.cmml" xref="S4.SS2.p1.6.m6.1.1.3"><times id="S4.SS2.p1.6.m6.1.1.3.1.cmml" xref="S4.SS2.p1.6.m6.1.1.3.1"></times><ci id="S4.SS2.p1.6.m6.1.1.3.2.cmml" xref="S4.SS2.p1.6.m6.1.1.3.2">𝑚</ci><ci id="S4.SS2.p1.6.m6.1.1.3.3.cmml" xref="S4.SS2.p1.6.m6.1.1.3.3">𝑒</ci><ci id="S4.SS2.p1.6.m6.1.1.3.4.cmml" xref="S4.SS2.p1.6.m6.1.1.3.4">𝑎</ci><ci id="S4.SS2.p1.6.m6.1.1.3.5.cmml" xref="S4.SS2.p1.6.m6.1.1.3.5">𝑛</ci><ci id="S4.SS2.p1.6.m6.1.1.3.6.cmml" xref="S4.SS2.p1.6.m6.1.1.3.6">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">f_{meanp}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.1d">italic_f start_POSTSUBSCRIPT italic_m italic_e italic_a italic_n italic_p end_POSTSUBSCRIPT</annotation></semantics></math> is more robust, showing monotonically increasing accuracy with higher confidence scores consistently in all dataset. But in the case of <math alttext="f_{ret}" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m7.1"><semantics id="S4.SS2.p1.7.m7.1a"><msub id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">f</mi><mrow id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml"><mi id="S4.SS2.p1.7.m7.1.1.3.2" xref="S4.SS2.p1.7.m7.1.1.3.2.cmml">r</mi><mo id="S4.SS2.p1.7.m7.1.1.3.1" xref="S4.SS2.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.7.m7.1.1.3.3" xref="S4.SS2.p1.7.m7.1.1.3.3.cmml">e</mi><mo id="S4.SS2.p1.7.m7.1.1.3.1a" xref="S4.SS2.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.7.m7.1.1.3.4" xref="S4.SS2.p1.7.m7.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">𝑓</ci><apply id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3"><times id="S4.SS2.p1.7.m7.1.1.3.1.cmml" xref="S4.SS2.p1.7.m7.1.1.3.1"></times><ci id="S4.SS2.p1.7.m7.1.1.3.2.cmml" xref="S4.SS2.p1.7.m7.1.1.3.2">𝑟</ci><ci id="S4.SS2.p1.7.m7.1.1.3.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3.3">𝑒</ci><ci id="S4.SS2.p1.7.m7.1.1.3.4.cmml" xref="S4.SS2.p1.7.m7.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">f_{ret}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m7.1d">italic_f start_POSTSUBSCRIPT italic_r italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, no such pattern exists. Overall (top) as these benchmarks are knowledge-intensive, they typically perform better with retrieved contexts and our adaptive scoring shows a better determination of when to retrieve and when not – resulting in higher accuracy at any retrieval frequency. In fact, the advantage is more amplified in PubHealth where we can find a clear threshold confidence score which if achieved, retrieval data are found to be less effective than the parametric knowledge. This gives us a peak accuracy of 1% more than always retrieval, which can not be determined by Self-RAG.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Studies</h3>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="203" id="S4.F5.1.g1" src="x6.png" width="407"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Model performances utilizing CRAG contexts</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="220" id="S4.F6.1.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Layer-wise expert activation on single-hop (PopQA, PubHealth) vs multi-hop tasks (HotpotQA, MuSiQue).
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.1">Robustness to Different Retrieval (CRAG) Methods.</span>
CRAG <cite class="ltx_cite ltx_citemacro_cite">Yan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib45" title="">2024</a>)</cite> proposes a corrective RAG method where, if corpus (e.g., Wikipedia) retrievals are detected as low-quality, a web search is performed to obtain new retrievals. These new retrievals are then fed into the system. The Self-CRAG method combines both reflection-based models and CRAG-based datasets (Self-RAG + CRAG dataset). We evaluate <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.2">Open-RAG</span> and <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.3">Open-CRAG</span> (<span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.4">Open-RAG</span> + CRAG datasets) on the benchmarks (PopQA, PubHealth, and Bio) using CRAG, Self-RAG <cite class="ltx_cite ltx_citemacro_cite">Asai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib2" title="">2024</a>)</cite>, and Self-CRAG as baselines, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S4.F5" title="Figure 5 ‣ 4.3 Ablation Studies ‣ 4 Results and Analysis ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>. <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.5">Open-CRAG</span> outperforms all baselines across all tasks. Specifically, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.6">Open-RAG</span> achieves 2%, 4% higher accuracy than Self-CRAG in (Bio, PopQA) and PubHealth respectively. This demonstrates <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.7">Open-RAG</span>’s robustness to retrieval quality and its potential for improvement with high-quality contexts.</p>
</div>
<figure class="ltx_figure" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="199" id="S4.F7.1.g1" src="x8.png" width="398"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Performances (MAUVE for ALCE-ASQA; EM for HotpotQA and MuSiQue-Ans; and accuracy for PopQA and PubHealth ) with different architecture. </figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.6"><span class="ltx_text ltx_font_bold" id="S4.SS3.p2.6.2">Routing Analysis of <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.6.2.1">Open-RAG</span>.</span>
We perform routing analysis for PopQA, PubHealth, HotpotQA, and 2WikiMultihopQA tasks to demonstrate <span class="ltx_text ltx_font_typewriter" id="S4.SS3.p2.1.1">Top-<math alttext="2" class="ltx_Math" display="inline" id="S4.SS3.p2.1.1.m1.1"><semantics id="S4.SS3.p2.1.1.m1.1a"><mn id="S4.SS3.p2.1.1.m1.1.1" xref="S4.SS3.p2.1.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.1.m1.1b"><cn id="S4.SS3.p2.1.1.m1.1.1.cmml" type="integer" xref="S4.SS3.p2.1.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.1.m1.1c">2</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.1.m1.1d">2</annotation></semantics></math></span> expert activation in different layers during retrieval-free generation by <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.6.3">Open-RAG</span> as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S4.F6" title="Figure 6 ‣ 4.3 Ablation Studies ‣ 4 Results and Analysis ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>.
We observe, that <math alttext="\mathcal{E}_{7}" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m1.1"><semantics id="S4.SS3.p2.2.m1.1a"><msub id="S4.SS3.p2.2.m1.1.1" xref="S4.SS3.p2.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.2.m1.1.1.2" xref="S4.SS3.p2.2.m1.1.1.2.cmml">ℰ</mi><mn id="S4.SS3.p2.2.m1.1.1.3" xref="S4.SS3.p2.2.m1.1.1.3.cmml">7</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m1.1b"><apply id="S4.SS3.p2.2.m1.1.1.cmml" xref="S4.SS3.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m1.1.1.1.cmml" xref="S4.SS3.p2.2.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.2.m1.1.1.2.cmml" xref="S4.SS3.p2.2.m1.1.1.2">ℰ</ci><cn id="S4.SS3.p2.2.m1.1.1.3.cmml" type="integer" xref="S4.SS3.p2.2.m1.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m1.1c">\mathcal{E}_{7}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m1.1d">caligraphic_E start_POSTSUBSCRIPT 7 end_POSTSUBSCRIPT</annotation></semantics></math> is a general expert that is highly activated in the first (Layer 1), middle (Layer 16), and final (Layer 32) layers for all datasets. Whereas <math alttext="\mathcal{E}_{2}" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m2.1"><semantics id="S4.SS3.p2.3.m2.1a"><msub id="S4.SS3.p2.3.m2.1.1" xref="S4.SS3.p2.3.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.3.m2.1.1.2" xref="S4.SS3.p2.3.m2.1.1.2.cmml">ℰ</mi><mn id="S4.SS3.p2.3.m2.1.1.3" xref="S4.SS3.p2.3.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m2.1b"><apply id="S4.SS3.p2.3.m2.1.1.cmml" xref="S4.SS3.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m2.1.1.1.cmml" xref="S4.SS3.p2.3.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m2.1.1.2.cmml" xref="S4.SS3.p2.3.m2.1.1.2">ℰ</ci><cn id="S4.SS3.p2.3.m2.1.1.3.cmml" type="integer" xref="S4.SS3.p2.3.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m2.1c">\mathcal{E}_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m2.1d">caligraphic_E start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is activated in the first layer while <math alttext="\mathcal{E}_{6}" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m3.1"><semantics id="S4.SS3.p2.4.m3.1a"><msub id="S4.SS3.p2.4.m3.1.1" xref="S4.SS3.p2.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.4.m3.1.1.2" xref="S4.SS3.p2.4.m3.1.1.2.cmml">ℰ</mi><mn id="S4.SS3.p2.4.m3.1.1.3" xref="S4.SS3.p2.4.m3.1.1.3.cmml">6</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m3.1b"><apply id="S4.SS3.p2.4.m3.1.1.cmml" xref="S4.SS3.p2.4.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m3.1.1.1.cmml" xref="S4.SS3.p2.4.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.4.m3.1.1.2.cmml" xref="S4.SS3.p2.4.m3.1.1.2">ℰ</ci><cn id="S4.SS3.p2.4.m3.1.1.3.cmml" type="integer" xref="S4.SS3.p2.4.m3.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m3.1c">\mathcal{E}_{6}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m3.1d">caligraphic_E start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT</annotation></semantics></math> is activated mostly in the final layer. In the middle layer, we also observe a higher activation of <math alttext="\mathcal{E}_{5}" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m4.1"><semantics id="S4.SS3.p2.5.m4.1a"><msub id="S4.SS3.p2.5.m4.1.1" xref="S4.SS3.p2.5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.5.m4.1.1.2" xref="S4.SS3.p2.5.m4.1.1.2.cmml">ℰ</mi><mn id="S4.SS3.p2.5.m4.1.1.3" xref="S4.SS3.p2.5.m4.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m4.1b"><apply id="S4.SS3.p2.5.m4.1.1.cmml" xref="S4.SS3.p2.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m4.1.1.1.cmml" xref="S4.SS3.p2.5.m4.1.1">subscript</csymbol><ci id="S4.SS3.p2.5.m4.1.1.2.cmml" xref="S4.SS3.p2.5.m4.1.1.2">ℰ</ci><cn id="S4.SS3.p2.5.m4.1.1.3.cmml" type="integer" xref="S4.SS3.p2.5.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m4.1c">\mathcal{E}_{5}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m4.1d">caligraphic_E start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT</annotation></semantics></math> and a lower activation of <math alttext="\mathcal{E}_{7}" class="ltx_Math" display="inline" id="S4.SS3.p2.6.m5.1"><semantics id="S4.SS3.p2.6.m5.1a"><msub id="S4.SS3.p2.6.m5.1.1" xref="S4.SS3.p2.6.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.6.m5.1.1.2" xref="S4.SS3.p2.6.m5.1.1.2.cmml">ℰ</mi><mn id="S4.SS3.p2.6.m5.1.1.3" xref="S4.SS3.p2.6.m5.1.1.3.cmml">7</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m5.1b"><apply id="S4.SS3.p2.6.m5.1.1.cmml" xref="S4.SS3.p2.6.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m5.1.1.1.cmml" xref="S4.SS3.p2.6.m5.1.1">subscript</csymbol><ci id="S4.SS3.p2.6.m5.1.1.2.cmml" xref="S4.SS3.p2.6.m5.1.1.2">ℰ</ci><cn id="S4.SS3.p2.6.m5.1.1.3.cmml" type="integer" xref="S4.SS3.p2.6.m5.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m5.1c">\mathcal{E}_{7}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m5.1d">caligraphic_E start_POSTSUBSCRIPT 7 end_POSTSUBSCRIPT</annotation></semantics></math> in the PopQA and PubHealth datasets (single-hop), but the opposite in the case of multi-hop datasets – showing that the experts implicitly learn to identify query complexity and play important roles across layers for different kinds of task complexities.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.2"><span class="ltx_text ltx_font_bold" id="S4.SS3.p3.2.1">Sparse Upcycling Hyperparameters.</span> We experiment with different hyper-parameters of <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p3.2.2">Open-RAG</span> as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S4.T2" title="Table 2 ‣ 4.3 Ablation Studies ‣ 4 Results and Analysis ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>. We observe that increasing the number of experts <math alttext="N_{E}" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><msub id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2.cmml">N</mi><mi id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2">𝑁</ci><ci id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">N_{E}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT</annotation></semantics></math> slightly improves the performance in MuSiQue, and performance improvement in training longer (epoch 1 vs 2). Increasing the number of active experts <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><mi id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><ci id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">italic_k</annotation></semantics></math> from 2 to 4 causes performance degradation showing the necessity of less active experts.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p4.1.1">Impact of Modules.</span>
It is important to understand how much gain is coming from our contrastive learning and how much from the architectural transformation.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S4.F7" title="Figure 7 ‣ 4.3 Ablation Studies ‣ 4 Results and Analysis ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a> with reference to Self-RAG, we plot
<span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p4.1.2">Open-RAG</span> performances with both dense and MoE architecture.
<span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p4.1.3">Open-RAG</span>-Dense outperforms Self-RAG-7B by 1.8% in PopQA, 1.6% in PubHealth, 4.2% in ASQA (MAUVE), 17.9% in MuSiQue (EM) and 21.7% in HotpotQA (EM).
Moreover, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p4.1.4">Open-RAG</span>-MoE improves over <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p4.1.5">Open-RAG</span>-Dense by 1.6% in PopQA, 2.2% in PubHealth, 5.2% in ASQA (MAUVE), 1.6% in MuSiQue (EM) and 1.4% in HotpotQA (EM) – both components enhances the model significantly while contrastive learning as highest.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.2" style="width:216.8pt;height:86.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-27.6pt,10.9pt) scale(0.797277524890409,0.797277524890409) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T2.1.1.1.1"><math alttext="N_{E}" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.1.m1.1a"><msub id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml"><mi id="S4.T2.1.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.1.m1.1.1.2.cmml">N</mi><mi id="S4.T2.1.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.1.m1.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2">𝑁</ci><ci id="S4.T2.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">N_{E}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T2.2.2.2.2"><math alttext="k" class="ltx_Math" display="inline" id="S4.T2.2.2.2.2.m1.1"><semantics id="S4.T2.2.2.2.2.m1.1a"><mi id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><ci id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.2.m1.1d">italic_k</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.2.2.2.3">Epochs</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.2.2.2.4">PopQA</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.2.2.2.5">PubHealth</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T2.2.2.2.6">MuSiQue</th>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2.3.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row" id="S4.T2.2.2.3.1.1"></th>
<th class="ltx_td ltx_th ltx_th_column ltx_th_row" id="S4.T2.2.2.3.1.2"></th>
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T2.2.2.3.1.3"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.2.2.3.1.4">Acc</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.2.2.3.1.5">Acc</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.2.2.3.1.6">EM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.2.2.3.1.7">F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.2.2.4.1" style="background-color:#E6E6E6;">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T2.2.2.4.1.1"><span class="ltx_text" id="S4.T2.2.2.4.1.1.1" style="background-color:#E6E6E6;">8</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T2.2.2.4.1.2"><span class="ltx_text" id="S4.T2.2.2.4.1.2.1" style="background-color:#E6E6E6;">2</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.2.4.1.3"><span class="ltx_text" id="S4.T2.2.2.4.1.3.1" style="background-color:#E6E6E6;">1</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.4.1.4"><span class="ltx_text" id="S4.T2.2.2.4.1.4.1" style="background-color:#E6E6E6;">59.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.4.1.5"><span class="ltx_text" id="S4.T2.2.2.4.1.5.1" style="background-color:#E6E6E6;">74.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.4.1.6"><span class="ltx_text" id="S4.T2.2.2.4.1.6.1" style="background-color:#E6E6E6;">39.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.4.1.7"><span class="ltx_text" id="S4.T2.2.2.4.1.7.1" style="background-color:#E6E6E6;">54.4</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2.5.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.2.2.5.2.1">16</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.2.2.5.2.2">2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.2.5.2.3">1</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.2.5.2.4">59.2</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.2.5.2.5">74.6</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.2.5.2.6">40.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.2.5.2.7">54.4</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2.6.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.2.2.6.3.1">16</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.2.2.6.3.2">4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.2.6.3.3">1</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.2.6.3.4">59.0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.2.6.3.5">72.4</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.2.6.3.6">40.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.2.6.3.7">54.5</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2.7.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T2.2.2.7.4.1">
<span class="ltx_ERROR undefined" id="S4.T2.2.2.7.4.1.1">\cdashline</span>1-7
8</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T2.2.2.7.4.2">2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T2.2.2.7.4.3">2</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.2.7.4.4">58.3</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.2.7.4.5">75.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.2.7.4.6">41.6</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.2.7.4.7">55.3</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Ablation study model performances</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related work</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Complex factual reasoning requires contextualizing information from multiple documents <cite class="ltx_cite ltx_citemacro_cite">Trivedi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib38" title="">2022</a>); Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib47" title="">2018b</a>)</cite>. Prior works <cite class="ltx_cite ltx_citemacro_cite">Khattab et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib17" title="">2022</a>); Press et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib34" title="">2023</a>); Pereira et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib32" title="">2023</a>); Khot et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib18" title="">2023</a>)</cite> proposed decomposing multi-hop queries into single-hop queries, then repeatedly using LLMs and Retrievers. In addition,  <cite class="ltx_cite ltx_citemacro_citet">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib15" title="">2023b</a>)</cite> retrieved new documents if the tokens within generated sentences have low confidence. However, the performance improvement of these approaches often comes at the cost of resource-intensive techniques such as interleave Chain-of-Thought <cite class="ltx_cite ltx_citemacro_cite">Yao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib48" title="">2023</a>); Trivedi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib40" title="">2023b</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib51" title="">2024b</a>)</cite> or Tree-of-Thought <cite class="ltx_cite ltx_citemacro_cite">Chan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib4" title="">2024</a>)</cite> reasoning with document retrieval; and requiring external models  <cite class="ltx_cite ltx_citemacro_cite">Jeong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib13" title="">2024b</a>)</cite>. In this work, we train a single MoE model capable of answering complex questions in one iteration with a minimal increase in model complexity.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">To enhance reasoning capabilities in RAG models with open-source LLMs, we develop <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.1">Open-RAG</span> featuring a PEFT MoE architecture, contrastive learning, and adaptive retrieval.
<span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.2">Open-RAG</span> shows significant performance improvements in complex reasoning tasks, outperforming SoTA methods. However, there is still a gap in tasks like long-form generation compared to proprietary models, which we aim to address in future.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Limitations</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.3"><span class="ltx_text ltx_font_smallcaps" id="S7.p1.3.1">Open-RAG</span> has a higher memory footprint due to an increase in total parameters (7.81B) in comparison to Llama2<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="S7.p1.1.m1.1"><semantics id="S7.p1.1.m1.1a"><msub id="S7.p1.1.m1.1.1" xref="S7.p1.1.m1.1.1.cmml"><mi id="S7.p1.1.m1.1.1a" xref="S7.p1.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S7.p1.1.m1.1.1.1" xref="S7.p1.1.m1.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="S7.p1.1.m1.1b"><apply id="S7.p1.1.m1.1.1.cmml" xref="S7.p1.1.m1.1.1"><ci id="S7.p1.1.m1.1.1.1a.cmml" xref="S7.p1.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="S7.p1.1.m1.1.1.1.cmml" mathsize="70%" xref="S7.p1.1.m1.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.1.m1.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.1.m1.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math> family baselines (6.74B). But our <span class="ltx_text ltx_font_smallcaps" id="S7.p1.3.2">Open-RAG</span> outperforms open LLMs with total parameters ranging from 7B to 65B, rivaling proprietary models such as ChatGPT, Perplexity.ai, and Command R+ in various downstream tasks. Thus, <span class="ltx_text ltx_font_smallcaps" id="S7.p1.3.3">Open-RAG</span> eventually reduces the compute and memory cost with 7.01B active parameters during inference in comparison to its performance. Additionally, as our framework is general, future direction can be building stronger sparse-upcycled LLMs based on recent models such as Llama3<math alttext="{}_{\textsc{8B}}" class="ltx_Math" display="inline" id="S7.p1.2.m2.1"><semantics id="S7.p1.2.m2.1a"><msub id="S7.p1.2.m2.1.1" xref="S7.p1.2.m2.1.1.cmml"><mi id="S7.p1.2.m2.1.1a" xref="S7.p1.2.m2.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S7.p1.2.m2.1.1.1" xref="S7.p1.2.m2.1.1.1a.cmml">8B</mtext></msub><annotation-xml encoding="MathML-Content" id="S7.p1.2.m2.1b"><apply id="S7.p1.2.m2.1.1.cmml" xref="S7.p1.2.m2.1.1"><ci id="S7.p1.2.m2.1.1.1a.cmml" xref="S7.p1.2.m2.1.1.1"><mtext class="ltx_font_smallcaps" id="S7.p1.2.m2.1.1.1.cmml" mathsize="70%" xref="S7.p1.2.m2.1.1.1">8B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.2.m2.1c">{}_{\textsc{8B}}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.2.m2.1d">start_FLOATSUBSCRIPT 8B end_FLOATSUBSCRIPT</annotation></semantics></math>  and Mistral<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="S7.p1.3.m3.1"><semantics id="S7.p1.3.m3.1a"><msub id="S7.p1.3.m3.1.1" xref="S7.p1.3.m3.1.1.cmml"><mi id="S7.p1.3.m3.1.1a" xref="S7.p1.3.m3.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="S7.p1.3.m3.1.1.1" xref="S7.p1.3.m3.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="S7.p1.3.m3.1b"><apply id="S7.p1.3.m3.1.1.cmml" xref="S7.p1.3.m3.1.1"><ci id="S7.p1.3.m3.1.1.1a.cmml" xref="S7.p1.3.m3.1.1.1"><mtext class="ltx_font_smallcaps" id="S7.p1.3.m3.1.1.1.cmml" mathsize="70%" xref="S7.p1.3.m3.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.3.m3.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.3.m3.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math>  utilizing <span class="ltx_text ltx_font_smallcaps" id="S7.p1.3.4">Open-RAG</span> multi-hop training dataset. Although our approach is theoretically applicable to any domain, future work can explore developing high-performance domain-specific RAG based on our <span class="ltx_text ltx_font_smallcaps" id="S7.p1.3.5">Open-RAG</span>.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">We thank anonymous reviewers for their valuable feedback on the paper.
We also thank Mohamed El Banani and Amr Keleg for fruitful discussions.
We are grateful to Qatar Computing Research Institute for providing compute and OpenAI APIs.
Shayekh Bin Islam is supported by the Fatima Al-Fihri Predoctoral Fellowship sponsored by Hugging Face.
This work was supported in part by National Science Foundation (NSF) awards CNS-1730158, ACI-1540112, ACI-1541349, OAC-1826967, OAC-2112167, CNS-2100237, CNS-2120019, the University of California Office of the President, and the University of California San Diego’s California Institute for Telecommunications and Information Technology/Qualcomm Institute. Thanks to CENIC for the 100Gbps networks.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Asai et al. (2023)</span>
<span class="ltx_bibblock">
Akari Asai, Sewon Min, Zexuan Zhong, and Danqi Chen. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2023.acl-tutorials.6" title="">Retrieval-based language models and applications</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 6: Tutorial Abstracts)</em>, pages 41–46, Toronto, Canada. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Asai et al. (2024)</span>
<span class="ltx_bibblock">
Akari Asai, Zeqiu Wu, Yizhong Wang, Avirup Sil, and Hannaneh Hajishirzi. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=hSyW5go0v8" title="">Self-RAG: Learning to retrieve, generate, and critique through self-reflection</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">The Twelfth International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beeching et al. (2023)</span>
<span class="ltx_bibblock">
Edward Beeching, Clémentine Fourrier, Nathan Habib, Sheon Han, Nathan Lambert, Nazneen Rajani, Omar Sanseviero, Lewis Tunstall, and Thomas Wolf. 2023.

</span>
<span class="ltx_bibblock">Open LLM leaderboard.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard" title="">https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chan et al. (2024)</span>
<span class="ltx_bibblock">
Chi-Min Chan, Chunpu Xu, Ruibin Yuan, Hongyin Luo, Wei Xue, Yike Guo, and Jie Fu. 2024.

</span>
<span class="ltx_bibblock">RQ-RAG: Learning to refine queries for retrieval augmented generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2404.00610</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohere Team (2024)</span>
<span class="ltx_bibblock">
x Cohere Team. 2024.

</span>
<span class="ltx_bibblock">Introducing Command R+: A Scalable LLM Built for Business — cohere.com.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://cohere.com/blog/command-r-plus-microsoft-azure" title="">https://cohere.com/blog/command-r-plus-microsoft-azure</a>.

</span>
<span class="ltx_bibblock">[Accessed 14-06-2024].

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Contextual.AI (2024)</span>
<span class="ltx_bibblock">
Contextual.AI. 2024.

</span>
<span class="ltx_bibblock">Introducing RAG 2.0 - Contextual AI — contextual.ai.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://contextual.ai/introducing-rag2/" title="">https://contextual.ai/introducing-rag2/</a>.

</span>
<span class="ltx_bibblock">[Accessed 14-06-2024].

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers et al. (2023)</span>
<span class="ltx_bibblock">
Tim Dettmers, Artidoro Pagnoni, Ari Holtzman, and Luke Zettlemoyer. 2023.

</span>
<span class="ltx_bibblock">Qlora: Efficient finetuning of quantized llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arxiv</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubois et al. (2023)</span>
<span class="ltx_bibblock">
Yann Dubois, Xuechen Li, Rohan Taori, Tianyi Zhang, Ishaan Gulrajani, Jimmy Ba, Carlos Guestrin, Percy Liang, and Tatsunori B. Hashimoto. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2305.14387" title="">AlpacaFarm: A simulation framework for methods that learn from human feedback</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2305.14387</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2023a)</span>
<span class="ltx_bibblock">
Tianyu Gao, Howard Yen, Jiatong Yu, and Danqi Chen. 2023a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2023.emnlp-main.398" title="">Enabling large language models to generate text with citations</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 6465–6488, Singapore. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2023b)</span>
<span class="ltx_bibblock">
Tianyu Gao, Howard Yen, Jiatong Yu, and Danqi Chen. 2023b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2305.14627" title="">Enabling large language models to generate text with citations</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2305.14627</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al. (2020)</span>
<span class="ltx_bibblock">
Xanh Ho, Anh-Khoa Duong Nguyen, Saku Sugawara, and Akiko Aizawa. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2011.01060" title="">Constructing A multi-hop QA dataset for comprehensive evaluation of reasoning steps</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">CoRR</em>, abs/2011.01060.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeong et al. (2024a)</span>
<span class="ltx_bibblock">
Minbyul Jeong, Jiwoong Sohn, Mujeen Sung, and Jaewoo Kang. 2024a.

</span>
<span class="ltx_bibblock">Improving medical reasoning through retrieval and self-reflection with retrieval-augmented large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2401.15269</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeong et al. (2024b)</span>
<span class="ltx_bibblock">
Soyeong Jeong, Jinheon Baek, Sukmin Cho, Sung Ju Hwang, and Jong C Park. 2024b.

</span>
<span class="ltx_bibblock">Adaptive-rag: Learning to adapt retrieval-augmented large language models through question complexity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2403.14403</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2023a)</span>
<span class="ltx_bibblock">
Zhengbao Jiang, Frank F. Xu, Luyu Gao, Zhiqing Sun, Qian Liu, Jane Dwivedi-Yu, Yiming Yang, Jamie Callan, and Graham Neubig. 2023a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/pdf/2305.06983" title="">Active retrieval augmented generation</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2305.06983</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2023b)</span>
<span class="ltx_bibblock">
Zhengbao Jiang, Frank F. Xu, Luyu Gao, Zhiqing Sun, Qian Liu, Jane Dwivedi-Yu, Yiming Yang, Jamie Callan, and Graham Neubig. 2023b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2305.06983" title="">Active retrieval augmented generation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">EMNLP 2023</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joshi et al. (2017)</span>
<span class="ltx_bibblock">
Mandar Joshi, Eunsol Choi, Daniel Weld, and Luke Zettlemoyer. 2017.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/P17-1147" title="">TriviaQA: A large scale distantly supervised challenge dataset for reading comprehension</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khattab et al. (2022)</span>
<span class="ltx_bibblock">
Omar Khattab, Keshav Santhanam, Xiang Lisa Li, David Hall, Percy Liang, Christopher Potts, and Matei Zaharia. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2212.14024" title="">Demonstrate-Search-Predict: Composing retrieval and language models for knowledge-intensive NLP</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv.2212.14024</em>, abs/2212.14024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khot et al. (2023)</span>
<span class="ltx_bibblock">
Tushar Khot, Harsh Trivedi, Matthew Finlayson, Yao Fu, Kyle Richardson, Peter Clark, and Ashish Sabharwal. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/pdf?id=_nGgzQjzaRy" title="">Decomposed Prompting: A modular approach for solving complex tasks</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">The Eleventh International Conference on Learning Representations, ICLR 2023, Kigali, Rwanda, May 1-5, 2023</em>. OpenReview.net.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Komatsuzaki et al. (2022)</span>
<span class="ltx_bibblock">
Aran Komatsuzaki, Joan Puigcerver, James Lee-Thorp, Carlos Riquelme Ruiz, Basil Mustafa, Joshua Ainslie, Yi Tay, Mostafa Dehghani, and Neil Houlsby. 2022.

</span>
<span class="ltx_bibblock">Sparse upcycling: Training mixture-of-experts from dense checkpoints.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2212.05055</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2020)</span>
<span class="ltx_bibblock">
Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim Rocktäschel, Sebastian Riedel, and Douwe Kiela. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper_files/paper/2020/file/6b493230205f780e1bc26945df7481e5-Paper.pdf" title="">Retrieval-Augmented Generation for knowledge-intensive NLP tasks</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Advances in Neural Information Processing Systems</em>, volume 33, pages 9459–9474.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Dacheng Li, Rulin Shao, Anze Xie, Ying Sheng, Lianmin Zheng, Joseph Gonzalez, Ion Stoica, Xuezhe Ma, and Hao Zhang. 2023.

</span>
<span class="ltx_bibblock">How long can context length of open-source LLMs truly promise?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">NeurIPS 2023 Workshop on Instruction Tuning and Instruction Following</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023)</span>
<span class="ltx_bibblock">
Xin Liu, Muhammad Khalifa, and Lu Wang. 2023.

</span>
<span class="ltx_bibblock">Litcab: Lightweight calibration of language models on outputs of varied lengths.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2310.19208</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2022)</span>
<span class="ltx_bibblock">
Ximing Lu, Sean Welleck, Jack Hessel, Liwei Jiang, Lianhui Qin, Peter West, Prithviraj Ammanabrolu, and Yejin Choi. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=5HaIds3ux5O" title="">QUARK: Controllable text generation with reinforced unlearning</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Advances in Neural Information Processing Systems</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. (2023)</span>
<span class="ltx_bibblock">
Hongyin Luo, Yung-Sung Chuang, Yuan Gong, Tianhua Zhang, Yoon Kim, Xixin Wu, Danny Fox, Helen Meng, and James Glass. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2305.15225" title="">SAIL: Search-augmented instruction learning</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2305.15225</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mallen et al. (2022)</span>
<span class="ltx_bibblock">
Alex Mallen, Akari Asai, Victor Zhong, Rajarshi Das, Daniel Khashabi, and Hannaneh Hajishirzi. 2022.

</span>
<span class="ltx_bibblock">When not to trust language models: Investigating effectiveness of parametric and non-parametric memories.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2212.10511</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mallen et al. (2023)</span>
<span class="ltx_bibblock">
Alex Mallen, Akari Asai, Victor Zhong, Rajarshi Das, Daniel Khashabi, and Hannaneh Hajishirzi. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/pdf/2212.10511" title="">When not to trust language models: Investigating effectiveness of parametric and non-parametric memories</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2212.10511</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Min et al. (2023a)</span>
<span class="ltx_bibblock">
Sewon Min, Kalpesh Krishna, Xinxi Lyu, Mike Lewis, Wen-tau Yih, Pang Koh, Mohit Iyyer, Luke Zettlemoyer, and Hannaneh Hajishirzi. 2023a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2023.emnlp-main.741" title="">FActScore: Fine-grained atomic evaluation of factual precision in long form text generation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 12076–12100, Singapore. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Min et al. (2023b)</span>
<span class="ltx_bibblock">
Sewon Min, Kalpesh Krishna, Xinxi Lyu, Mike Lewis, Wen-tau Yih, Pang Wei Koh, Mohit Iyyer, Luke Zettlemoyer, and Hannaneh Hajishirzi. 2023b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2305.14251" title="">FActScore: Fine-grained atomic evaluation of factual precision in long form text generation</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2305.14251</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nogueira and Cho (2020)</span>
<span class="ltx_bibblock">
Rodrigo Nogueira and Kyunghyun Cho. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/pdf/1901.04085" title="">Passage re-ranking with BERT</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:1901.04085</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al. (2022)</span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Gray, John Schulman, Jacob Hilton, Fraser Kelton, Luke Miller, Maddie Simens, Amanda Askell, Peter Welinder, Paul Christiano, Jan Leike, and Ryan Lowe. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=TG8KACxEON" title="">Training language models to follow instructions with human feedback</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Advances in Neural Information Processing Systems</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Parvez (2024)</span>
<span class="ltx_bibblock">
Md Rizwan Parvez. 2024.

</span>
<span class="ltx_bibblock">Evidence to generate (e2g): A single-agent two-step prompting for context grounded and retrieval augmented reasoning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2401.05787</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pereira et al. (2023)</span>
<span class="ltx_bibblock">
Jayr Alencar Pereira, Robson do Nascimento Fidalgo, Roberto de Alencar Lotufo, and Rodrigo Frassetto Nogueira. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1007/978-3-031-28238-6_44" title="">Visconde: Multi-document QA with GPT-3 and neural reranking</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Advances in Information Retrieval - 45th European Conference on Information Retrieval, ECIR 2023, Dublin, Ireland, April 2-6, 2023, Proceedings, Part II</em>, volume 13981 of <em class="ltx_emph ltx_font_italic" id="bib.bib32.2.2">Lecture Notes in Computer Science</em>, pages 534–543. Springer.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pillutla et al. (2021)</span>
<span class="ltx_bibblock">
Krishna Pillutla, Swabha Swayamdipta, Rowan Zellers, John Thickstun, Sean Welleck, Yejin Choi, and Zaid Harchaoui. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=Tqx7nJp7PR" title="">MAUVE: Measuring the gap between neural text and human text using divergence frontiers</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Advances in Neural Information Processing Systems</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Press et al. (2023)</span>
<span class="ltx_bibblock">
Ofir Press, Muru Zhang, Sewon Min, Ludwig Schmidt, Noah A. Smith, and Mike Lewis. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2210.03350" title="">Measuring and narrowing the compositionality gap in language models</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Findings of the Association for Computational Linguistics: EMNLP 2023</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. (2023)</span>
<span class="ltx_bibblock">
Freda Shi, Xinyun Chen, Kanishka Misra, Nathan Scales, David Dohan, Ed H Chi, Nathanael Schärli, and Denny Zhou. 2023.

</span>
<span class="ltx_bibblock">Large language models can be easily distracted by irrelevant context.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">International Conference on Machine Learning</em>, pages 31210–31227. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stelmakh et al. (2022)</span>
<span class="ltx_bibblock">
Ivan Stelmakh, Yi Luan, Bhuwan Dhingra, and Ming-Wei Chang. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/2022.emnlp-main.566" title="">ASQA: Factoid questions meet long-form answers</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/pdf/2307.09288" title="">Llama 2: Open foundation and fine-tuned chat models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2307.09288</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Trivedi et al. (2022)</span>
<span class="ltx_bibblock">
Harsh Trivedi, Niranjan Balasubramanian, Tushar Khot, and Ashish Sabharwal. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1162/tacl_a_00475" title="">MuSiQue: Multihop questions via single-hop question composition</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Transactions of the Association for Computational Linguistics</em>, 10:539–554.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Trivedi et al. (2023a)</span>
<span class="ltx_bibblock">
Harsh Trivedi, Niranjan Balasubramanian, Tushar Khot, and Ashish Sabharwal. 2023a.

</span>
<span class="ltx_bibblock">Interleaving retrieval with chain-of-thought reasoning for knowledge-intensive multi-step questions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Association for Computational Linguistics</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Trivedi et al. (2023b)</span>
<span class="ltx_bibblock">
Harsh Trivedi, Niranjan Balasubramanian, Tushar Khot, and Ashish Sabharwal. 2023b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/2023.ACL-LONG.557" title="">Interleaving Retrieval with Chain-of-Thought Reasoning for Knowledge-Intensive Multi-Step Questions</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2023, Toronto, Canada, July 9-14, 2023</em>, pages 10014–10037. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2018)</span>
<span class="ltx_bibblock">
Shuohang Wang, Mo Yu, Xiaoxiao Guo, Zhiguo Wang, Tim Klinger, Wei Zhang, Shiyu Chang, Gerry Tesauro, Bowen Zhou, and Jing Jiang. 2018.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://dl.acm.org/doi/10.5555/3504035.3504769" title="">R3: Reinforced ranker-reader for open-domain question answering</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume 32.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023)</span>
<span class="ltx_bibblock">
Zhiruo Wang, Jun Araki, Zhengbao Jiang, Md Rizwan Parvez, and Graham Neubig. 2023.

</span>
<span class="ltx_bibblock">Learning to filter context for retrieval-augmented generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">arXiv preprint arXiv:2311.08377</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2024)</span>
<span class="ltx_bibblock">
Haoyuan Wu, Haisheng Zheng, and Bei Yu. 2024.

</span>
<span class="ltx_bibblock">Parameter-Efficient Sparsity Crafting from Dense to Mixture-of-Experts for Instruction Tuning on General Tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2401.02731</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2023)</span>
<span class="ltx_bibblock">
Fangyuan Xu, Weijia Shi, and Eunsol Choi. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2310.04408" title="">RECOMP: Improving retrieval-augmented lms with compression and selective augmentation</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Preprint</em>, arXiv:2310.04408.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al. (2024)</span>
<span class="ltx_bibblock">
Shi-Qi Yan, Jia-Chen Gu, Yun Zhu, and Zhen-Hua Ling. 2024.

</span>
<span class="ltx_bibblock">Corrective Retrieval Augmented Generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:2401.15884</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2018a)</span>
<span class="ltx_bibblock">
Zhilin Yang, Peng Qi, Saizheng Zhang, Yoshua Bengio, William Cohen, Ruslan Salakhutdinov, and Christopher D. Manning. 2018a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/D18-1259" title="">HotpotQA: A dataset for diverse, explainable multi-hop question answering</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing</em>, pages 2369–2380, Brussels, Belgium. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2018b)</span>
<span class="ltx_bibblock">
Zhilin Yang, Peng Qi, Saizheng Zhang, Yoshua Bengio, William Cohen, Ruslan Salakhutdinov, and Christopher D. Manning. 2018b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/D18-1259" title="">HotpotQA: A dataset for diverse, explainable multi-hop question answering</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing</em>, pages 2369–2380, Brussels, Belgium. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2023)</span>
<span class="ltx_bibblock">
Shunyu Yao, Jeffrey Zhao, Dian Yu, Nan Du, Izhak Shafran, Karthik R. Narasimhan, and Yuan Cao. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/pdf?id=WE_vluYUL-X" title="">ReAct: Synergizing reasoning and acting in language models</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">The Eleventh International Conference on Learning Representations, ICLR 2023, Kigali, Rwanda, May 1-5, 2023</em>. OpenReview.net.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024a)</span>
<span class="ltx_bibblock">
Jiahao Zhang, Haiyang Zhang, Dongmei Zhang, Yong Liu, and Shen Huang. 2024a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2308.08973" title="">End-to-End Beam Retrieval for Multi-Hop Question Answering</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">2024 Annual Conference of the North American Chapter of the Association for Computational Linguistics</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023)</span>
<span class="ltx_bibblock">
Tianhua Zhang, Hongyin Luo, Yung-Sung Chuang, Wei Fang, Luc Gaitskell, Thomas Hartvigsen, Xixin Wu, Danny Fox, Helen Meng, and James Glass. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2304.03728" title="">Interpretable unified language checking</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">arXiv preprint arXiv:2304.03728</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024b)</span>
<span class="ltx_bibblock">
Tianjun Zhang, Shishir G Patil, Naman Jain, Sheng Shen, Matei Zaharia, Ion Stoica, and Joseph E Gonzalez. 2024b.

</span>
<span class="ltx_bibblock">Raft: Adapting language model to domain specific rag.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">arXiv preprint arXiv:2403.10131</em>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Training Details</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">We train both MoE and Dense models with LoRA rank 64, LoRA <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.p1.1.m1.1"><semantics id="A1.p1.1.m1.1a"><mi id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><ci id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">italic_α</annotation></semantics></math> 16, and LoRA dropout 0.1. We optimize the models with the AdamW optimizer with a linear learning rate scheduler and a weight decay of 0.0. Both models have a context length of 4096 for facilitating long-context multi-hop QAs.
Other training hyper-parameters are mentioned in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#A1.T3" title="Table 3 ‣ Appendix A Training Details ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_table" id="A1.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T3.6" style="width:216.8pt;height:55.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-32.1pt,8.2pt) scale(0.771671758696857,0.771671758696857) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T3.6.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T3.6.6.7.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T3.6.6.7.1.1">LM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T3.6.6.7.1.2">LR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T3.6.6.7.1.3">Epoch</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T3.6.6.7.1.4">Quantization</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T3.6.6.7.1.5">Adapter Dim</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T3.2.2.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T3.1.1.1.1">Dense<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="A1.T3.1.1.1.1.m1.1"><semantics id="A1.T3.1.1.1.1.m1.1a"><msub id="A1.T3.1.1.1.1.m1.1.1" xref="A1.T3.1.1.1.1.m1.1.1.cmml"><mi id="A1.T3.1.1.1.1.m1.1.1a" xref="A1.T3.1.1.1.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="A1.T3.1.1.1.1.m1.1.1.1" xref="A1.T3.1.1.1.1.m1.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.T3.1.1.1.1.m1.1b"><apply id="A1.T3.1.1.1.1.m1.1.1.cmml" xref="A1.T3.1.1.1.1.m1.1.1"><ci id="A1.T3.1.1.1.1.m1.1.1.1a.cmml" xref="A1.T3.1.1.1.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="A1.T3.1.1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="A1.T3.1.1.1.1.m1.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.1.1.1.1.m1.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.1.1.1.1.m1.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.2.2.2.2"><math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="A1.T3.2.2.2.2.m1.1"><semantics id="A1.T3.2.2.2.2.m1.1a"><mrow id="A1.T3.2.2.2.2.m1.1.1" xref="A1.T3.2.2.2.2.m1.1.1.cmml"><mn id="A1.T3.2.2.2.2.m1.1.1.2" xref="A1.T3.2.2.2.2.m1.1.1.2.cmml">1</mn><mo id="A1.T3.2.2.2.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.T3.2.2.2.2.m1.1.1.1.cmml">×</mo><msup id="A1.T3.2.2.2.2.m1.1.1.3" xref="A1.T3.2.2.2.2.m1.1.1.3.cmml"><mn id="A1.T3.2.2.2.2.m1.1.1.3.2" xref="A1.T3.2.2.2.2.m1.1.1.3.2.cmml">10</mn><mrow id="A1.T3.2.2.2.2.m1.1.1.3.3" xref="A1.T3.2.2.2.2.m1.1.1.3.3.cmml"><mo id="A1.T3.2.2.2.2.m1.1.1.3.3a" xref="A1.T3.2.2.2.2.m1.1.1.3.3.cmml">−</mo><mn id="A1.T3.2.2.2.2.m1.1.1.3.3.2" xref="A1.T3.2.2.2.2.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.2.2.2.2.m1.1b"><apply id="A1.T3.2.2.2.2.m1.1.1.cmml" xref="A1.T3.2.2.2.2.m1.1.1"><times id="A1.T3.2.2.2.2.m1.1.1.1.cmml" xref="A1.T3.2.2.2.2.m1.1.1.1"></times><cn id="A1.T3.2.2.2.2.m1.1.1.2.cmml" type="integer" xref="A1.T3.2.2.2.2.m1.1.1.2">1</cn><apply id="A1.T3.2.2.2.2.m1.1.1.3.cmml" xref="A1.T3.2.2.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="A1.T3.2.2.2.2.m1.1.1.3.1.cmml" xref="A1.T3.2.2.2.2.m1.1.1.3">superscript</csymbol><cn id="A1.T3.2.2.2.2.m1.1.1.3.2.cmml" type="integer" xref="A1.T3.2.2.2.2.m1.1.1.3.2">10</cn><apply id="A1.T3.2.2.2.2.m1.1.1.3.3.cmml" xref="A1.T3.2.2.2.2.m1.1.1.3.3"><minus id="A1.T3.2.2.2.2.m1.1.1.3.3.1.cmml" xref="A1.T3.2.2.2.2.m1.1.1.3.3"></minus><cn id="A1.T3.2.2.2.2.m1.1.1.3.3.2.cmml" type="integer" xref="A1.T3.2.2.2.2.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.2.2.2.m1.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.2.2.2.2.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.2.2.2.3">3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.2.2.2.4">None</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.2.2.2.5">–</td>
</tr>
<tr class="ltx_tr" id="A1.T3.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T3.3.3.3.1">MoE<math alttext="{}_{\textsc{7B}}" class="ltx_Math" display="inline" id="A1.T3.3.3.3.1.m1.1"><semantics id="A1.T3.3.3.3.1.m1.1a"><msub id="A1.T3.3.3.3.1.m1.1.1" xref="A1.T3.3.3.3.1.m1.1.1.cmml"><mi id="A1.T3.3.3.3.1.m1.1.1a" xref="A1.T3.3.3.3.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="A1.T3.3.3.3.1.m1.1.1.1" xref="A1.T3.3.3.3.1.m1.1.1.1a.cmml">7B</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.T3.3.3.3.1.m1.1b"><apply id="A1.T3.3.3.3.1.m1.1.1.cmml" xref="A1.T3.3.3.3.1.m1.1.1"><ci id="A1.T3.3.3.3.1.m1.1.1.1a.cmml" xref="A1.T3.3.3.3.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="A1.T3.3.3.3.1.m1.1.1.1.cmml" mathsize="70%" xref="A1.T3.3.3.3.1.m1.1.1.1">7B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.3.3.3.1.m1.1c">{}_{\textsc{7B}}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.3.3.3.1.m1.1d">start_FLOATSUBSCRIPT 7B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="A1.T3.4.4.4.2"><math alttext="2\times 10^{-4}" class="ltx_Math" display="inline" id="A1.T3.4.4.4.2.m1.1"><semantics id="A1.T3.4.4.4.2.m1.1a"><mrow id="A1.T3.4.4.4.2.m1.1.1" xref="A1.T3.4.4.4.2.m1.1.1.cmml"><mn id="A1.T3.4.4.4.2.m1.1.1.2" xref="A1.T3.4.4.4.2.m1.1.1.2.cmml">2</mn><mo id="A1.T3.4.4.4.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.T3.4.4.4.2.m1.1.1.1.cmml">×</mo><msup id="A1.T3.4.4.4.2.m1.1.1.3" xref="A1.T3.4.4.4.2.m1.1.1.3.cmml"><mn id="A1.T3.4.4.4.2.m1.1.1.3.2" xref="A1.T3.4.4.4.2.m1.1.1.3.2.cmml">10</mn><mrow id="A1.T3.4.4.4.2.m1.1.1.3.3" xref="A1.T3.4.4.4.2.m1.1.1.3.3.cmml"><mo id="A1.T3.4.4.4.2.m1.1.1.3.3a" xref="A1.T3.4.4.4.2.m1.1.1.3.3.cmml">−</mo><mn id="A1.T3.4.4.4.2.m1.1.1.3.3.2" xref="A1.T3.4.4.4.2.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.4.4.4.2.m1.1b"><apply id="A1.T3.4.4.4.2.m1.1.1.cmml" xref="A1.T3.4.4.4.2.m1.1.1"><times id="A1.T3.4.4.4.2.m1.1.1.1.cmml" xref="A1.T3.4.4.4.2.m1.1.1.1"></times><cn id="A1.T3.4.4.4.2.m1.1.1.2.cmml" type="integer" xref="A1.T3.4.4.4.2.m1.1.1.2">2</cn><apply id="A1.T3.4.4.4.2.m1.1.1.3.cmml" xref="A1.T3.4.4.4.2.m1.1.1.3"><csymbol cd="ambiguous" id="A1.T3.4.4.4.2.m1.1.1.3.1.cmml" xref="A1.T3.4.4.4.2.m1.1.1.3">superscript</csymbol><cn id="A1.T3.4.4.4.2.m1.1.1.3.2.cmml" type="integer" xref="A1.T3.4.4.4.2.m1.1.1.3.2">10</cn><apply id="A1.T3.4.4.4.2.m1.1.1.3.3.cmml" xref="A1.T3.4.4.4.2.m1.1.1.3.3"><minus id="A1.T3.4.4.4.2.m1.1.1.3.3.1.cmml" xref="A1.T3.4.4.4.2.m1.1.1.3.3"></minus><cn id="A1.T3.4.4.4.2.m1.1.1.3.3.2.cmml" type="integer" xref="A1.T3.4.4.4.2.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.4.4.4.2.m1.1c">2\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.4.4.4.2.m1.1d">2 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A1.T3.4.4.4.3">2</td>
<td class="ltx_td ltx_align_center" id="A1.T3.4.4.4.4">QLoRA (NF4)</td>
<td class="ltx_td ltx_align_center" id="A1.T3.4.4.4.5">512</td>
</tr>
<tr class="ltx_tr" id="A1.T3.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A1.T3.5.5.5.1">MoE<math alttext="{}_{\textsc{13B}}" class="ltx_Math" display="inline" id="A1.T3.5.5.5.1.m1.1"><semantics id="A1.T3.5.5.5.1.m1.1a"><msub id="A1.T3.5.5.5.1.m1.1.1" xref="A1.T3.5.5.5.1.m1.1.1.cmml"><mi id="A1.T3.5.5.5.1.m1.1.1a" xref="A1.T3.5.5.5.1.m1.1.1.cmml"></mi><mtext class="ltx_font_smallcaps" id="A1.T3.5.5.5.1.m1.1.1.1" xref="A1.T3.5.5.5.1.m1.1.1.1a.cmml">13B</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.T3.5.5.5.1.m1.1b"><apply id="A1.T3.5.5.5.1.m1.1.1.cmml" xref="A1.T3.5.5.5.1.m1.1.1"><ci id="A1.T3.5.5.5.1.m1.1.1.1a.cmml" xref="A1.T3.5.5.5.1.m1.1.1.1"><mtext class="ltx_font_smallcaps" id="A1.T3.5.5.5.1.m1.1.1.1.cmml" mathsize="70%" xref="A1.T3.5.5.5.1.m1.1.1.1">13B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.5.5.5.1.m1.1c">{}_{\textsc{13B}}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.5.5.5.1.m1.1d">start_FLOATSUBSCRIPT 13B end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T3.6.6.6.2"><math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="A1.T3.6.6.6.2.m1.1"><semantics id="A1.T3.6.6.6.2.m1.1a"><mrow id="A1.T3.6.6.6.2.m1.1.1" xref="A1.T3.6.6.6.2.m1.1.1.cmml"><mn id="A1.T3.6.6.6.2.m1.1.1.2" xref="A1.T3.6.6.6.2.m1.1.1.2.cmml">1</mn><mo id="A1.T3.6.6.6.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.T3.6.6.6.2.m1.1.1.1.cmml">×</mo><msup id="A1.T3.6.6.6.2.m1.1.1.3" xref="A1.T3.6.6.6.2.m1.1.1.3.cmml"><mn id="A1.T3.6.6.6.2.m1.1.1.3.2" xref="A1.T3.6.6.6.2.m1.1.1.3.2.cmml">10</mn><mrow id="A1.T3.6.6.6.2.m1.1.1.3.3" xref="A1.T3.6.6.6.2.m1.1.1.3.3.cmml"><mo id="A1.T3.6.6.6.2.m1.1.1.3.3a" xref="A1.T3.6.6.6.2.m1.1.1.3.3.cmml">−</mo><mn id="A1.T3.6.6.6.2.m1.1.1.3.3.2" xref="A1.T3.6.6.6.2.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.6.6.6.2.m1.1b"><apply id="A1.T3.6.6.6.2.m1.1.1.cmml" xref="A1.T3.6.6.6.2.m1.1.1"><times id="A1.T3.6.6.6.2.m1.1.1.1.cmml" xref="A1.T3.6.6.6.2.m1.1.1.1"></times><cn id="A1.T3.6.6.6.2.m1.1.1.2.cmml" type="integer" xref="A1.T3.6.6.6.2.m1.1.1.2">1</cn><apply id="A1.T3.6.6.6.2.m1.1.1.3.cmml" xref="A1.T3.6.6.6.2.m1.1.1.3"><csymbol cd="ambiguous" id="A1.T3.6.6.6.2.m1.1.1.3.1.cmml" xref="A1.T3.6.6.6.2.m1.1.1.3">superscript</csymbol><cn id="A1.T3.6.6.6.2.m1.1.1.3.2.cmml" type="integer" xref="A1.T3.6.6.6.2.m1.1.1.3.2">10</cn><apply id="A1.T3.6.6.6.2.m1.1.1.3.3.cmml" xref="A1.T3.6.6.6.2.m1.1.1.3.3"><minus id="A1.T3.6.6.6.2.m1.1.1.3.3.1.cmml" xref="A1.T3.6.6.6.2.m1.1.1.3.3"></minus><cn id="A1.T3.6.6.6.2.m1.1.1.3.3.2.cmml" type="integer" xref="A1.T3.6.6.6.2.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.6.6.6.2.m1.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.6.6.6.2.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T3.6.6.6.3">2</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T3.6.6.6.4">QLoRA (NF4)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T3.6.6.6.5">512</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Training Hyper-parameters.</figcaption>
</figure>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.1">We train <span class="ltx_text ltx_font_smallcaps" id="A1.p2.1.1">Open-RAG</span> models using NVIDIA A100 GPUs with 80GB VRAM.
About 40 GPU days have been spent in total during training and model development.</p>
</div>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Dataset Details</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">The complete breakdown of <span class="ltx_text ltx_font_smallcaps" id="A1.SS1.p1.1.1">Open-RAG</span> training dataset is displayed in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#A1.T4" title="Table 4 ‣ A.1 Dataset Details ‣ Appendix A Training Details ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>. Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#alg1" title="Algorithm 1 ‣ B.2 Instruction Format ‣ Appendix B Inference Details ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> shows the process of the multi-hop training data preparation.</p>
</div>
<figure class="ltx_table" id="A1.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A1.T4.1.1.1.1">Dataset Name</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T4.1.1.1.2">Source</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T4.1.1.1.3">Number of Instances</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="3" id="A1.T4.1.2.2.1"><span class="ltx_text ltx_font_italic" id="A1.T4.1.2.2.1.1">Instruction-Following</span></th>
</tr>
<tr class="ltx_tr" id="A1.T4.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T4.1.3.3.1">GPT-4 Alpaca</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.3.3.2">Open-Instruct</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.3.3.3">26,168</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T4.1.4.4.1">Stanford Alpaca</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.4.4.2">Open-Instruct</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.4.4.3">25,153</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T4.1.5.5.1">FLAN-V2</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.5.5.2">Open-Instruct</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.5.5.3">17,817</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T4.1.6.6.1">ShareGPT</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.6.6.2">Open-Instruct</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.6.6.3">13,406</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T4.1.7.7.1">Open Assistant 1</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.7.7.2">Open-Instruct</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.7.7.3">9,464</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="3" id="A1.T4.1.8.8.1"><span class="ltx_text ltx_font_italic" id="A1.T4.1.8.8.1.1">Knowledge-Intensive (Single-Hop)</span></th>
</tr>
<tr class="ltx_tr" id="A1.T4.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T4.1.9.9.1">Wizard of Wikipedia</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.9.9.2">KILT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.9.9.3">17,367</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T4.1.10.10.1">Natural Questions</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.10.10.2">KILT</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.10.10.3">15,535</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T4.1.11.11.1">FEVER</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.11.11.2">KILT</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.11.11.3">9,966</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T4.1.12.12.1">OpenBoookQA</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.12.12.2">HF Dataset</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.12.12.3">4,699</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T4.1.13.13.1">Arc-Easy</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.13.13.2">HF Dataset</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.13.13.3">2,147</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T4.1.14.14.1">ASQA</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.14.14.2">ASQA</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.14.14.3">3,897</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.15.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="3" id="A1.T4.1.15.15.1"><span class="ltx_text ltx_font_italic" id="A1.T4.1.15.15.1.1">Knowledge-Intensive (Multi-Hop)</span></th>
</tr>
<tr class="ltx_tr" id="A1.T4.1.16.16" style="background-color:#E6E6E6;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A1.T4.1.16.16.1"><span class="ltx_text" id="A1.T4.1.16.16.1.1" style="background-color:#E6E6E6;">HotpotQA (Ours)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T4.1.16.16.2"><span class="ltx_text" id="A1.T4.1.16.16.2.1" style="background-color:#E6E6E6;">HotpotQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T4.1.16.16.3"><span class="ltx_text" id="A1.T4.1.16.16.3.1" style="background-color:#E6E6E6;">28,117</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>The generator LM training data statistics. Instruction-following and single-hop knowledge-intensive samples are from Self-RAG <cite class="ltx_cite ltx_citemacro_cite">Asai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#bib.bib2" title="">2024</a>)</cite>. We curate the multi-hop knowledge-intensive samples with reflection tokens.
</figcaption>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Inference Details</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Inference Hyper-parameters</h3>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.2">The weights of the <em class="ltx_emph ltx_font_italic" id="A2.SS1.p1.2.1">Relevance</em>, <em class="ltx_emph ltx_font_italic" id="A2.SS1.p1.2.2">Grounding</em>  and <em class="ltx_emph ltx_font_italic" id="A2.SS1.p1.2.3">Utility</em>  tokens types are 1.0, 1.0, and 0.5 respectively during inference of <span class="ltx_text ltx_font_smallcaps" id="A2.SS1.p1.2.4">Open-RAG</span> and Self-RAG. During long-form generation, we use the maximum depth of search of 7 and the size of the beam of 2 following Self-RAG. To evaluate the performance in the retrieval setting, we report the performance in the always retrieval setup in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S3.T1" title="Table 1 ‣ 3.2 Experimental settings ‣ 3 Experiments ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>.
Next, we employ greedy decoding for <span class="ltx_text ltx_font_smallcaps" id="A2.SS1.p1.2.5">Open-RAG</span> and Self-RAG; and top-<math alttext="p" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.1"><semantics id="A2.SS1.p1.1.m1.1a"><mi id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><ci id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.1d">italic_p</annotation></semantics></math> (nucleus) sampling for open baseline models with temperature 0.8 and <math alttext="p=0.95" class="ltx_Math" display="inline" id="A2.SS1.p1.2.m2.1"><semantics id="A2.SS1.p1.2.m2.1a"><mrow id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml"><mi id="A2.SS1.p1.2.m2.1.1.2" xref="A2.SS1.p1.2.m2.1.1.2.cmml">p</mi><mo id="A2.SS1.p1.2.m2.1.1.1" xref="A2.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="A2.SS1.p1.2.m2.1.1.3" xref="A2.SS1.p1.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><apply id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1"><eq id="A2.SS1.p1.2.m2.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1.1"></eq><ci id="A2.SS1.p1.2.m2.1.1.2.cmml" xref="A2.SS1.p1.2.m2.1.1.2">𝑝</ci><cn id="A2.SS1.p1.2.m2.1.1.3.cmml" type="float" xref="A2.SS1.p1.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">p=0.95</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.2.m2.1d">italic_p = 0.95</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.1">We discuss the different soft retrieval constraints in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S2.SS3" title="2.3 Hybrid Approach for Adaptive Retrieval ‣ 2 Open-RAG: Enhanced Retrieval-Augmented Reasoning ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">2.3</span></a> and Section <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#S4.SS2" title="4.2 Performance-Speed by Adaptive Retrieval ‣ 4 Results and Analysis ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">4.2</span></a>.
Moreover, we identify a bug <span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_href" href="https://github.com/AkariAsai/self-rag/blob/1fcdc420e48f50a7d7ab1ece5494221b93252e99/retrieval_lm/run_short_form.py#L79" title="">Implementation issue of soft-constraint in Self-RAG</a></span></span></span>
in the implementation of soft-constraint for adaptive retrieval in Self-RAG where the implementation utilizes the log-probability of the <span class="ltx_text ltx_font_italic" id="A2.SS1.p2.1.1">Retrieval</span> token instead of the probability.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Instruction Format</h3>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">We utilize standard prompt without any complex prompting, such as Chain-of-Thoughts (CoT). For single-hop tasks, we follow the instruction format in Self-RAG, whereas the instruction format for multi-hop question answering is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01782v1#A2.T5" title="Table 5 ‣ B.2 Instruction Format ‣ Appendix B Inference Details ‣ Open-RAG: Enhanced Retrieval-Augmented Reasoning with Open-Source Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure class="ltx_table" id="A2.T5">
<div class="ltx_inline-block ltx_transformed_outer" id="A2.T5.1" style="width:216.8pt;height:74.7pt;vertical-align:-6.4pt;"><span class="ltx_transformed_inner" style="transform:translate(-111.7pt,35.2pt) scale(0.492429186224767,0.492429186224767) ;"><svg class="ltx_picture" height="192.01" id="A2.T5.1.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.01) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 186.11 C 0 189.37 2.64 192.01 5.91 192.01 L 594.09 192.01 C 597.36 192.01 600 189.37 600 186.11 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 186.11 C 1.97 188.28 3.73 190.04 5.91 190.04 L 594.09 190.04 C 596.27 190.04 598.03 188.28 598.03 186.11 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g color="#404040" fill="#404040" stroke="#404040" stroke-dasharray="2.84528pt,2.84528pt" stroke-dashoffset="1.42264pt" stroke-opacity="1.0"><path d="M 1.97 87.7 L 598.03 87.7" style="fill:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 99.51)"><foreignobject color="#000000" height="78.72" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.T5.1.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A2.T5.1.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A2.T5.1.pic1.1.1.1.1.1.1.1">Instructions
<br class="ltx_break"/></span><span class="ltx_text ltx_font_typewriter" id="A2.T5.1.pic1.1.1.1.1.1.1.2">
You are a question answering agent. Given a context and a question, your task is to answer the question based on the context. Instead of a full sentence, your answer must be the shortest word or phrase or named entity. Some example outputs ’answer’ are: yes; no; Ibn Sina; Doha, Qatar; 2,132 seats, Los Angeles, California etc.</span></span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="62.11" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.T5.1.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A2.T5.1.pic1.2.2.2.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A2.T5.1.pic1.2.2.2.1.1.1.1">### Instruction 
<br class="ltx_break"/>What administrative territorial entity is the owner of Ciudad Deportiva located?</span>
<br class="ltx_break"/>
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="A2.T5.1.pic1.2.2.2.1.1.1.2">### Response:</span>
<br class="ltx_break"/></span>
</span></foreignobject></g></g></svg>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Instruction Example for Multi-Hop QAs.</figcaption>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.3.1.1">Algorithm 1</span> </span> <span class="ltx_text ltx_font_smallcaps" id="alg1.4.2">Open-RAG</span> Multi-Hop Training Data Preparation</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.5">
<div class="ltx_listingline" id="algx1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>Critic Model <math alttext="C" class="ltx_Math" display="inline" id="algx1.l1.m1.1"><semantics id="algx1.l1.m1.1a"><mi id="algx1.l1.m1.1.1" xref="algx1.l1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algx1.l1.m1.1b"><ci id="algx1.l1.m1.1.1.cmml" xref="algx1.l1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="algx1.l1.m1.1d">italic_C</annotation></semantics></math>, Multi-hop Reasoning QA collections <math alttext="(Q,Y)" class="ltx_Math" display="inline" id="algx1.l1.m2.2"><semantics id="algx1.l1.m2.2a"><mrow id="algx1.l1.m2.2.3.2" xref="algx1.l1.m2.2.3.1.cmml"><mo id="algx1.l1.m2.2.3.2.1" stretchy="false" xref="algx1.l1.m2.2.3.1.cmml">(</mo><mi id="algx1.l1.m2.1.1" xref="algx1.l1.m2.1.1.cmml">Q</mi><mo id="algx1.l1.m2.2.3.2.2" xref="algx1.l1.m2.2.3.1.cmml">,</mo><mi id="algx1.l1.m2.2.2" xref="algx1.l1.m2.2.2.cmml">Y</mi><mo id="algx1.l1.m2.2.3.2.3" stretchy="false" xref="algx1.l1.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algx1.l1.m2.2b"><interval closure="open" id="algx1.l1.m2.2.3.1.cmml" xref="algx1.l1.m2.2.3.2"><ci id="algx1.l1.m2.1.1.cmml" xref="algx1.l1.m2.1.1">𝑄</ci><ci id="algx1.l1.m2.2.2.cmml" xref="algx1.l1.m2.2.2">𝑌</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m2.2c">(Q,Y)</annotation><annotation encoding="application/x-llamapun" id="algx1.l1.m2.2d">( italic_Q , italic_Y )</annotation></semantics></math> with a set of supporting contexts <math alttext="\mathcal{P}_{i}" class="ltx_Math" display="inline" id="algx1.l1.m3.1"><semantics id="algx1.l1.m3.1a"><msub id="algx1.l1.m3.1.1" xref="algx1.l1.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l1.m3.1.1.2" xref="algx1.l1.m3.1.1.2.cmml">𝒫</mi><mi id="algx1.l1.m3.1.1.3" xref="algx1.l1.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l1.m3.1b"><apply id="algx1.l1.m3.1.1.cmml" xref="algx1.l1.m3.1.1"><csymbol cd="ambiguous" id="algx1.l1.m3.1.1.1.cmml" xref="algx1.l1.m3.1.1">subscript</csymbol><ci id="algx1.l1.m3.1.1.2.cmml" xref="algx1.l1.m3.1.1.2">𝒫</ci><ci id="algx1.l1.m3.1.1.3.cmml" xref="algx1.l1.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m3.1c">\mathcal{P}_{i}</annotation><annotation encoding="application/x-llamapun" id="algx1.l1.m3.1d">caligraphic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and a set of non-supporting contexts <math alttext="\mathcal{N}_{i}" class="ltx_Math" display="inline" id="algx1.l1.m4.1"><semantics id="algx1.l1.m4.1a"><msub id="algx1.l1.m4.1.1" xref="algx1.l1.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l1.m4.1.1.2" xref="algx1.l1.m4.1.1.2.cmml">𝒩</mi><mi id="algx1.l1.m4.1.1.3" xref="algx1.l1.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l1.m4.1b"><apply id="algx1.l1.m4.1.1.cmml" xref="algx1.l1.m4.1.1"><csymbol cd="ambiguous" id="algx1.l1.m4.1.1.1.cmml" xref="algx1.l1.m4.1.1">subscript</csymbol><ci id="algx1.l1.m4.1.1.2.cmml" xref="algx1.l1.m4.1.1.2">𝒩</ci><ci id="algx1.l1.m4.1.1.3.cmml" xref="algx1.l1.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m4.1c">\mathcal{N}_{i}</annotation><annotation encoding="application/x-llamapun" id="algx1.l1.m4.1d">caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for QA pair <math alttext="(q_{i},y_{i})" class="ltx_Math" display="inline" id="algx1.l1.m5.2"><semantics id="algx1.l1.m5.2a"><mrow id="algx1.l1.m5.2.2.2" xref="algx1.l1.m5.2.2.3.cmml"><mo id="algx1.l1.m5.2.2.2.3" stretchy="false" xref="algx1.l1.m5.2.2.3.cmml">(</mo><msub id="algx1.l1.m5.1.1.1.1" xref="algx1.l1.m5.1.1.1.1.cmml"><mi id="algx1.l1.m5.1.1.1.1.2" xref="algx1.l1.m5.1.1.1.1.2.cmml">q</mi><mi id="algx1.l1.m5.1.1.1.1.3" xref="algx1.l1.m5.1.1.1.1.3.cmml">i</mi></msub><mo id="algx1.l1.m5.2.2.2.4" xref="algx1.l1.m5.2.2.3.cmml">,</mo><msub id="algx1.l1.m5.2.2.2.2" xref="algx1.l1.m5.2.2.2.2.cmml"><mi id="algx1.l1.m5.2.2.2.2.2" xref="algx1.l1.m5.2.2.2.2.2.cmml">y</mi><mi id="algx1.l1.m5.2.2.2.2.3" xref="algx1.l1.m5.2.2.2.2.3.cmml">i</mi></msub><mo id="algx1.l1.m5.2.2.2.5" stretchy="false" xref="algx1.l1.m5.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algx1.l1.m5.2b"><interval closure="open" id="algx1.l1.m5.2.2.3.cmml" xref="algx1.l1.m5.2.2.2"><apply id="algx1.l1.m5.1.1.1.1.cmml" xref="algx1.l1.m5.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l1.m5.1.1.1.1.1.cmml" xref="algx1.l1.m5.1.1.1.1">subscript</csymbol><ci id="algx1.l1.m5.1.1.1.1.2.cmml" xref="algx1.l1.m5.1.1.1.1.2">𝑞</ci><ci id="algx1.l1.m5.1.1.1.1.3.cmml" xref="algx1.l1.m5.1.1.1.1.3">𝑖</ci></apply><apply id="algx1.l1.m5.2.2.2.2.cmml" xref="algx1.l1.m5.2.2.2.2"><csymbol cd="ambiguous" id="algx1.l1.m5.2.2.2.2.1.cmml" xref="algx1.l1.m5.2.2.2.2">subscript</csymbol><ci id="algx1.l1.m5.2.2.2.2.2.cmml" xref="algx1.l1.m5.2.2.2.2.2">𝑦</ci><ci id="algx1.l1.m5.2.2.2.2.3.cmml" xref="algx1.l1.m5.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m5.2c">(q_{i},y_{i})</annotation><annotation encoding="application/x-llamapun" id="algx1.l1.m5.2d">( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="algx1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="algx1.l2.1">Output:</span>
Multi-hop input-output pairs <math alttext="\hat{D}" class="ltx_Math" display="inline" id="algx1.l2.m1.1"><semantics id="algx1.l2.m1.1a"><mover accent="true" id="algx1.l2.m1.1.1" xref="algx1.l2.m1.1.1.cmml"><mi id="algx1.l2.m1.1.1.2" xref="algx1.l2.m1.1.1.2.cmml">D</mi><mo id="algx1.l2.m1.1.1.1" xref="algx1.l2.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="algx1.l2.m1.1b"><apply id="algx1.l2.m1.1.1.cmml" xref="algx1.l2.m1.1.1"><ci id="algx1.l2.m1.1.1.1.cmml" xref="algx1.l2.m1.1.1.1">^</ci><ci id="algx1.l2.m1.1.1.2.cmml" xref="algx1.l2.m1.1.1.2">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l2.m1.1c">\hat{D}</annotation><annotation encoding="application/x-llamapun" id="algx1.l2.m1.1d">over^ start_ARG italic_D end_ARG</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="algx1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><math alttext="C" class="ltx_Math" display="inline" id="algx1.l3.m1.1"><semantics id="algx1.l3.m1.1a"><mi id="algx1.l3.m1.1.1" xref="algx1.l3.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algx1.l3.m1.1b"><ci id="algx1.l3.m1.1.1.cmml" xref="algx1.l3.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="algx1.l3.m1.1d">italic_C</annotation></semantics></math> predicts <span class="ltx_text ltx_font_italic" id="algx1.l3.1">Retrieval</span> for <math alttext="q_{i}" class="ltx_Math" display="inline" id="algx1.l3.m2.1"><semantics id="algx1.l3.m2.1a"><msub id="algx1.l3.m2.1.1" xref="algx1.l3.m2.1.1.cmml"><mi id="algx1.l3.m2.1.1.2" xref="algx1.l3.m2.1.1.2.cmml">q</mi><mi id="algx1.l3.m2.1.1.3" xref="algx1.l3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l3.m2.1b"><apply id="algx1.l3.m2.1.1.cmml" xref="algx1.l3.m2.1.1"><csymbol cd="ambiguous" id="algx1.l3.m2.1.1.1.cmml" xref="algx1.l3.m2.1.1">subscript</csymbol><ci id="algx1.l3.m2.1.1.2.cmml" xref="algx1.l3.m2.1.1.2">𝑞</ci><ci id="algx1.l3.m2.1.1.3.cmml" xref="algx1.l3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m2.1c">q_{i}</annotation><annotation encoding="application/x-llamapun" id="algx1.l3.m2.1d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <span class="ltx_text ltx_font_italic" id="algx1.l3.2">Utility</span> <math alttext="U" class="ltx_Math" display="inline" id="algx1.l3.m3.1"><semantics id="algx1.l3.m3.1a"><mi id="algx1.l3.m3.1.1" xref="algx1.l3.m3.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="algx1.l3.m3.1b"><ci id="algx1.l3.m3.1.1.cmml" xref="algx1.l3.m3.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m3.1c">U</annotation><annotation encoding="application/x-llamapun" id="algx1.l3.m3.1d">italic_U</annotation></semantics></math> of <math alttext="y_{i}" class="ltx_Math" display="inline" id="algx1.l3.m4.1"><semantics id="algx1.l3.m4.1a"><msub id="algx1.l3.m4.1.1" xref="algx1.l3.m4.1.1.cmml"><mi id="algx1.l3.m4.1.1.2" xref="algx1.l3.m4.1.1.2.cmml">y</mi><mi id="algx1.l3.m4.1.1.3" xref="algx1.l3.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l3.m4.1b"><apply id="algx1.l3.m4.1.1.cmml" xref="algx1.l3.m4.1.1"><csymbol cd="ambiguous" id="algx1.l3.m4.1.1.1.cmml" xref="algx1.l3.m4.1.1">subscript</csymbol><ci id="algx1.l3.m4.1.1.2.cmml" xref="algx1.l3.m4.1.1.2">𝑦</ci><ci id="algx1.l3.m4.1.1.3.cmml" xref="algx1.l3.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m4.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="algx1.l3.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for answering <math alttext="q_{i}" class="ltx_Math" display="inline" id="algx1.l3.m5.1"><semantics id="algx1.l3.m5.1a"><msub id="algx1.l3.m5.1.1" xref="algx1.l3.m5.1.1.cmml"><mi id="algx1.l3.m5.1.1.2" xref="algx1.l3.m5.1.1.2.cmml">q</mi><mi id="algx1.l3.m5.1.1.3" xref="algx1.l3.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l3.m5.1b"><apply id="algx1.l3.m5.1.1.cmml" xref="algx1.l3.m5.1.1"><csymbol cd="ambiguous" id="algx1.l3.m5.1.1.1.cmml" xref="algx1.l3.m5.1.1">subscript</csymbol><ci id="algx1.l3.m5.1.1.2.cmml" xref="algx1.l3.m5.1.1.2">𝑞</ci><ci id="algx1.l3.m5.1.1.3.cmml" xref="algx1.l3.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m5.1c">q_{i}</annotation><annotation encoding="application/x-llamapun" id="algx1.l3.m5.1d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="algx1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>Initialize an empty list <math alttext="\hat{D}" class="ltx_Math" display="inline" id="algx1.l4.m1.1"><semantics id="algx1.l4.m1.1a"><mover accent="true" id="algx1.l4.m1.1.1" xref="algx1.l4.m1.1.1.cmml"><mi id="algx1.l4.m1.1.1.2" xref="algx1.l4.m1.1.1.2.cmml">D</mi><mo id="algx1.l4.m1.1.1.1" xref="algx1.l4.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="algx1.l4.m1.1b"><apply id="algx1.l4.m1.1.1.cmml" xref="algx1.l4.m1.1.1"><ci id="algx1.l4.m1.1.1.1.cmml" xref="algx1.l4.m1.1.1.1">^</ci><ci id="algx1.l4.m1.1.1.2.cmml" xref="algx1.l4.m1.1.1.2">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l4.m1.1c">\hat{D}</annotation><annotation encoding="application/x-llamapun" id="algx1.l4.m1.1d">over^ start_ARG italic_D end_ARG</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span><span class="ltx_text ltx_font_bold" id="algx1.l5.1">for</span> <math alttext="(q_{i},y_{i})\in\{Q,Y\}" class="ltx_Math" display="inline" id="algx1.l5.m1.4"><semantics id="algx1.l5.m1.4a"><mrow id="algx1.l5.m1.4.4" xref="algx1.l5.m1.4.4.cmml"><mrow id="algx1.l5.m1.4.4.2.2" xref="algx1.l5.m1.4.4.2.3.cmml"><mo id="algx1.l5.m1.4.4.2.2.3" stretchy="false" xref="algx1.l5.m1.4.4.2.3.cmml">(</mo><msub id="algx1.l5.m1.3.3.1.1.1" xref="algx1.l5.m1.3.3.1.1.1.cmml"><mi id="algx1.l5.m1.3.3.1.1.1.2" xref="algx1.l5.m1.3.3.1.1.1.2.cmml">q</mi><mi id="algx1.l5.m1.3.3.1.1.1.3" xref="algx1.l5.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo id="algx1.l5.m1.4.4.2.2.4" xref="algx1.l5.m1.4.4.2.3.cmml">,</mo><msub id="algx1.l5.m1.4.4.2.2.2" xref="algx1.l5.m1.4.4.2.2.2.cmml"><mi id="algx1.l5.m1.4.4.2.2.2.2" xref="algx1.l5.m1.4.4.2.2.2.2.cmml">y</mi><mi id="algx1.l5.m1.4.4.2.2.2.3" xref="algx1.l5.m1.4.4.2.2.2.3.cmml">i</mi></msub><mo id="algx1.l5.m1.4.4.2.2.5" stretchy="false" xref="algx1.l5.m1.4.4.2.3.cmml">)</mo></mrow><mo id="algx1.l5.m1.4.4.3" xref="algx1.l5.m1.4.4.3.cmml">∈</mo><mrow id="algx1.l5.m1.4.4.4.2" xref="algx1.l5.m1.4.4.4.1.cmml"><mo id="algx1.l5.m1.4.4.4.2.1" stretchy="false" xref="algx1.l5.m1.4.4.4.1.cmml">{</mo><mi id="algx1.l5.m1.1.1" xref="algx1.l5.m1.1.1.cmml">Q</mi><mo id="algx1.l5.m1.4.4.4.2.2" xref="algx1.l5.m1.4.4.4.1.cmml">,</mo><mi id="algx1.l5.m1.2.2" xref="algx1.l5.m1.2.2.cmml">Y</mi><mo id="algx1.l5.m1.4.4.4.2.3" stretchy="false" xref="algx1.l5.m1.4.4.4.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l5.m1.4b"><apply id="algx1.l5.m1.4.4.cmml" xref="algx1.l5.m1.4.4"><in id="algx1.l5.m1.4.4.3.cmml" xref="algx1.l5.m1.4.4.3"></in><interval closure="open" id="algx1.l5.m1.4.4.2.3.cmml" xref="algx1.l5.m1.4.4.2.2"><apply id="algx1.l5.m1.3.3.1.1.1.cmml" xref="algx1.l5.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="algx1.l5.m1.3.3.1.1.1.1.cmml" xref="algx1.l5.m1.3.3.1.1.1">subscript</csymbol><ci id="algx1.l5.m1.3.3.1.1.1.2.cmml" xref="algx1.l5.m1.3.3.1.1.1.2">𝑞</ci><ci id="algx1.l5.m1.3.3.1.1.1.3.cmml" xref="algx1.l5.m1.3.3.1.1.1.3">𝑖</ci></apply><apply id="algx1.l5.m1.4.4.2.2.2.cmml" xref="algx1.l5.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="algx1.l5.m1.4.4.2.2.2.1.cmml" xref="algx1.l5.m1.4.4.2.2.2">subscript</csymbol><ci id="algx1.l5.m1.4.4.2.2.2.2.cmml" xref="algx1.l5.m1.4.4.2.2.2.2">𝑦</ci><ci id="algx1.l5.m1.4.4.2.2.2.3.cmml" xref="algx1.l5.m1.4.4.2.2.2.3">𝑖</ci></apply></interval><set id="algx1.l5.m1.4.4.4.1.cmml" xref="algx1.l5.m1.4.4.4.2"><ci id="algx1.l5.m1.1.1.cmml" xref="algx1.l5.m1.1.1">𝑄</ci><ci id="algx1.l5.m1.2.2.cmml" xref="algx1.l5.m1.2.2">𝑌</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.m1.4c">(q_{i},y_{i})\in\{Q,Y\}</annotation><annotation encoding="application/x-llamapun" id="algx1.l5.m1.4d">( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∈ { italic_Q , italic_Y }</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="algx1.l5.2">do</span>
</div>
<div class="ltx_listingline" id="algx1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <span class="ltx_text ltx_font_bold" id="algx1.l6.1">if</span>  <span class="ltx_text ltx_font_italic" id="algx1.l6.2">Retrieval</span> == <span class="ltx_text ltx_font_typewriter" id="algx1.l6.3">[NoRT]</span>  <span class="ltx_text ltx_font_bold" id="algx1.l6.4">then</span>
</div>
<div class="ltx_listingline" id="algx1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>         <math alttext="\rho_{0}" class="ltx_Math" display="inline" id="algx1.l7.m1.1"><semantics id="algx1.l7.m1.1a"><msub id="algx1.l7.m1.1.1" xref="algx1.l7.m1.1.1.cmml"><mi id="algx1.l7.m1.1.1.2" xref="algx1.l7.m1.1.1.2.cmml">ρ</mi><mn id="algx1.l7.m1.1.1.3" xref="algx1.l7.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="algx1.l7.m1.1b"><apply id="algx1.l7.m1.1.1.cmml" xref="algx1.l7.m1.1.1"><csymbol cd="ambiguous" id="algx1.l7.m1.1.1.1.cmml" xref="algx1.l7.m1.1.1">subscript</csymbol><ci id="algx1.l7.m1.1.1.2.cmml" xref="algx1.l7.m1.1.1.2">𝜌</ci><cn id="algx1.l7.m1.1.1.3.cmml" type="integer" xref="algx1.l7.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.m1.1c">\rho_{0}</annotation><annotation encoding="application/x-llamapun" id="algx1.l7.m1.1d">italic_ρ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> =
<span class="ltx_text ltx_font_typewriter" id="algx1.l7.1">[NoRT]</span> <math alttext="\oplus\ y_{i}\ \oplus\ " class="ltx_Math" display="inline" id="algx1.l7.m2.1"><semantics id="algx1.l7.m2.1a"><mrow id="algx1.l7.m2.1.1" xref="algx1.l7.m2.1.1.cmml"><mrow id="algx1.l7.m2.1.1.2" xref="algx1.l7.m2.1.1.2.cmml"><mo id="algx1.l7.m2.1.1.2a" rspace="0em" xref="algx1.l7.m2.1.1.2.cmml">⊕</mo><msub id="algx1.l7.m2.1.1.2.2" xref="algx1.l7.m2.1.1.2.2.cmml"><mi id="algx1.l7.m2.1.1.2.2.2" xref="algx1.l7.m2.1.1.2.2.2.cmml">y</mi><mi id="algx1.l7.m2.1.1.2.2.3" xref="algx1.l7.m2.1.1.2.2.3.cmml">i</mi></msub></mrow><mo id="algx1.l7.m2.1.1.3" xref="algx1.l7.m2.1.1.3.cmml">⊕</mo></mrow><annotation-xml encoding="MathML-Content" id="algx1.l7.m2.1b"><apply id="algx1.l7.m2.1.1.cmml" xref="algx1.l7.m2.1.1"><csymbol cd="latexml" id="algx1.l7.m2.1.1.1.cmml" xref="algx1.l7.m2.1.1">limit-from</csymbol><apply id="algx1.l7.m2.1.1.2.cmml" xref="algx1.l7.m2.1.1.2"><csymbol cd="latexml" id="algx1.l7.m2.1.1.2.1.cmml" xref="algx1.l7.m2.1.1.2">direct-sum</csymbol><apply id="algx1.l7.m2.1.1.2.2.cmml" xref="algx1.l7.m2.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l7.m2.1.1.2.2.1.cmml" xref="algx1.l7.m2.1.1.2.2">subscript</csymbol><ci id="algx1.l7.m2.1.1.2.2.2.cmml" xref="algx1.l7.m2.1.1.2.2.2">𝑦</ci><ci id="algx1.l7.m2.1.1.2.2.3.cmml" xref="algx1.l7.m2.1.1.2.2.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="algx1.l7.m2.1.1.3.cmml" xref="algx1.l7.m2.1.1.3">direct-sum</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.m2.1c">\oplus\ y_{i}\ \oplus\ </annotation><annotation encoding="application/x-llamapun" id="algx1.l7.m2.1d">⊕ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⊕</annotation></semantics></math> <math alttext="U" class="ltx_Math" display="inline" id="algx1.l7.m3.1"><semantics id="algx1.l7.m3.1a"><mi id="algx1.l7.m3.1.1" xref="algx1.l7.m3.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="algx1.l7.m3.1b"><ci id="algx1.l7.m3.1.1.cmml" xref="algx1.l7.m3.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.m3.1c">U</annotation><annotation encoding="application/x-llamapun" id="algx1.l7.m3.1d">italic_U</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>         <math alttext="\hat{D}\coloneqq\hat{D}\cup\{(q_{i},\rho_{0})\}" class="ltx_Math" display="inline" id="algx1.l8.m1.1"><semantics id="algx1.l8.m1.1a"><mrow id="algx1.l8.m1.1.1" xref="algx1.l8.m1.1.1.cmml"><mover accent="true" id="algx1.l8.m1.1.1.3" xref="algx1.l8.m1.1.1.3.cmml"><mi id="algx1.l8.m1.1.1.3.2" xref="algx1.l8.m1.1.1.3.2.cmml">D</mi><mo id="algx1.l8.m1.1.1.3.1" xref="algx1.l8.m1.1.1.3.1.cmml">^</mo></mover><mo id="algx1.l8.m1.1.1.2" xref="algx1.l8.m1.1.1.2.cmml">≔</mo><mrow id="algx1.l8.m1.1.1.1" xref="algx1.l8.m1.1.1.1.cmml"><mover accent="true" id="algx1.l8.m1.1.1.1.3" xref="algx1.l8.m1.1.1.1.3.cmml"><mi id="algx1.l8.m1.1.1.1.3.2" xref="algx1.l8.m1.1.1.1.3.2.cmml">D</mi><mo id="algx1.l8.m1.1.1.1.3.1" xref="algx1.l8.m1.1.1.1.3.1.cmml">^</mo></mover><mo id="algx1.l8.m1.1.1.1.2" xref="algx1.l8.m1.1.1.1.2.cmml">∪</mo><mrow id="algx1.l8.m1.1.1.1.1.1" xref="algx1.l8.m1.1.1.1.1.2.cmml"><mo id="algx1.l8.m1.1.1.1.1.1.2" stretchy="false" xref="algx1.l8.m1.1.1.1.1.2.cmml">{</mo><mrow id="algx1.l8.m1.1.1.1.1.1.1.2" xref="algx1.l8.m1.1.1.1.1.1.1.3.cmml"><mo id="algx1.l8.m1.1.1.1.1.1.1.2.3" stretchy="false" xref="algx1.l8.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="algx1.l8.m1.1.1.1.1.1.1.1.1" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.cmml"><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.2" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.3" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algx1.l8.m1.1.1.1.1.1.1.2.4" xref="algx1.l8.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="algx1.l8.m1.1.1.1.1.1.1.2.2" xref="algx1.l8.m1.1.1.1.1.1.1.2.2.cmml"><mi id="algx1.l8.m1.1.1.1.1.1.1.2.2.2" xref="algx1.l8.m1.1.1.1.1.1.1.2.2.2.cmml">ρ</mi><mn id="algx1.l8.m1.1.1.1.1.1.1.2.2.3" xref="algx1.l8.m1.1.1.1.1.1.1.2.2.3.cmml">0</mn></msub><mo id="algx1.l8.m1.1.1.1.1.1.1.2.5" stretchy="false" xref="algx1.l8.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="algx1.l8.m1.1.1.1.1.1.3" stretchy="false" xref="algx1.l8.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l8.m1.1b"><apply id="algx1.l8.m1.1.1.cmml" xref="algx1.l8.m1.1.1"><ci id="algx1.l8.m1.1.1.2.cmml" xref="algx1.l8.m1.1.1.2">≔</ci><apply id="algx1.l8.m1.1.1.3.cmml" xref="algx1.l8.m1.1.1.3"><ci id="algx1.l8.m1.1.1.3.1.cmml" xref="algx1.l8.m1.1.1.3.1">^</ci><ci id="algx1.l8.m1.1.1.3.2.cmml" xref="algx1.l8.m1.1.1.3.2">𝐷</ci></apply><apply id="algx1.l8.m1.1.1.1.cmml" xref="algx1.l8.m1.1.1.1"><union id="algx1.l8.m1.1.1.1.2.cmml" xref="algx1.l8.m1.1.1.1.2"></union><apply id="algx1.l8.m1.1.1.1.3.cmml" xref="algx1.l8.m1.1.1.1.3"><ci id="algx1.l8.m1.1.1.1.3.1.cmml" xref="algx1.l8.m1.1.1.1.3.1">^</ci><ci id="algx1.l8.m1.1.1.1.3.2.cmml" xref="algx1.l8.m1.1.1.1.3.2">𝐷</ci></apply><set id="algx1.l8.m1.1.1.1.1.2.cmml" xref="algx1.l8.m1.1.1.1.1.1"><interval closure="open" id="algx1.l8.m1.1.1.1.1.1.1.3.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.2"><apply id="algx1.l8.m1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algx1.l8.m1.1.1.1.1.1.1.2.2.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l8.m1.1.1.1.1.1.1.2.2.1.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algx1.l8.m1.1.1.1.1.1.1.2.2.2.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.2.2.2">𝜌</ci><cn id="algx1.l8.m1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="algx1.l8.m1.1.1.1.1.1.1.2.2.3">0</cn></apply></interval></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l8.m1.1c">\hat{D}\coloneqq\hat{D}\cup\{(q_{i},\rho_{0})\}</annotation><annotation encoding="application/x-llamapun" id="algx1.l8.m1.1d">over^ start_ARG italic_D end_ARG ≔ over^ start_ARG italic_D end_ARG ∪ { ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_ρ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <span class="ltx_text ltx_font_bold" id="algx1.l9.1">else</span> <span class="ltx_text ltx_font_bold" id="algx1.l9.2">if</span>  <span class="ltx_text ltx_font_italic" id="algx1.l9.3">Retrieval</span> == <span class="ltx_text ltx_font_typewriter" id="algx1.l9.4">[RT]</span> <span class="ltx_text ltx_font_bold" id="algx1.l9.5">then</span>
</div>
<div class="ltx_listingline" id="algx1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>         // Relevant and fully supported context

</div>
<div class="ltx_listingline" id="algx1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>         Without replacement, uniformly sample two contexts <math alttext="(p_{i}^{1},p_{i}^{2})\subseteq\mathcal{P}_{i}" class="ltx_Math" display="inline" id="algx1.l11.m1.2"><semantics id="algx1.l11.m1.2a"><mrow id="algx1.l11.m1.2.2" xref="algx1.l11.m1.2.2.cmml"><mrow id="algx1.l11.m1.2.2.2.2" xref="algx1.l11.m1.2.2.2.3.cmml"><mo id="algx1.l11.m1.2.2.2.2.3" stretchy="false" xref="algx1.l11.m1.2.2.2.3.cmml">(</mo><msubsup id="algx1.l11.m1.1.1.1.1.1" xref="algx1.l11.m1.1.1.1.1.1.cmml"><mi id="algx1.l11.m1.1.1.1.1.1.2.2" xref="algx1.l11.m1.1.1.1.1.1.2.2.cmml">p</mi><mi id="algx1.l11.m1.1.1.1.1.1.2.3" xref="algx1.l11.m1.1.1.1.1.1.2.3.cmml">i</mi><mn id="algx1.l11.m1.1.1.1.1.1.3" xref="algx1.l11.m1.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="algx1.l11.m1.2.2.2.2.4" xref="algx1.l11.m1.2.2.2.3.cmml">,</mo><msubsup id="algx1.l11.m1.2.2.2.2.2" xref="algx1.l11.m1.2.2.2.2.2.cmml"><mi id="algx1.l11.m1.2.2.2.2.2.2.2" xref="algx1.l11.m1.2.2.2.2.2.2.2.cmml">p</mi><mi id="algx1.l11.m1.2.2.2.2.2.2.3" xref="algx1.l11.m1.2.2.2.2.2.2.3.cmml">i</mi><mn id="algx1.l11.m1.2.2.2.2.2.3" xref="algx1.l11.m1.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="algx1.l11.m1.2.2.2.2.5" stretchy="false" xref="algx1.l11.m1.2.2.2.3.cmml">)</mo></mrow><mo id="algx1.l11.m1.2.2.3" xref="algx1.l11.m1.2.2.3.cmml">⊆</mo><msub id="algx1.l11.m1.2.2.4" xref="algx1.l11.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l11.m1.2.2.4.2" xref="algx1.l11.m1.2.2.4.2.cmml">𝒫</mi><mi id="algx1.l11.m1.2.2.4.3" xref="algx1.l11.m1.2.2.4.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algx1.l11.m1.2b"><apply id="algx1.l11.m1.2.2.cmml" xref="algx1.l11.m1.2.2"><subset id="algx1.l11.m1.2.2.3.cmml" xref="algx1.l11.m1.2.2.3"></subset><interval closure="open" id="algx1.l11.m1.2.2.2.3.cmml" xref="algx1.l11.m1.2.2.2.2"><apply id="algx1.l11.m1.1.1.1.1.1.cmml" xref="algx1.l11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l11.m1.1.1.1.1.1.1.cmml" xref="algx1.l11.m1.1.1.1.1.1">superscript</csymbol><apply id="algx1.l11.m1.1.1.1.1.1.2.cmml" xref="algx1.l11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l11.m1.1.1.1.1.1.2.1.cmml" xref="algx1.l11.m1.1.1.1.1.1">subscript</csymbol><ci id="algx1.l11.m1.1.1.1.1.1.2.2.cmml" xref="algx1.l11.m1.1.1.1.1.1.2.2">𝑝</ci><ci id="algx1.l11.m1.1.1.1.1.1.2.3.cmml" xref="algx1.l11.m1.1.1.1.1.1.2.3">𝑖</ci></apply><cn id="algx1.l11.m1.1.1.1.1.1.3.cmml" type="integer" xref="algx1.l11.m1.1.1.1.1.1.3">1</cn></apply><apply id="algx1.l11.m1.2.2.2.2.2.cmml" xref="algx1.l11.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algx1.l11.m1.2.2.2.2.2.1.cmml" xref="algx1.l11.m1.2.2.2.2.2">superscript</csymbol><apply id="algx1.l11.m1.2.2.2.2.2.2.cmml" xref="algx1.l11.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algx1.l11.m1.2.2.2.2.2.2.1.cmml" xref="algx1.l11.m1.2.2.2.2.2">subscript</csymbol><ci id="algx1.l11.m1.2.2.2.2.2.2.2.cmml" xref="algx1.l11.m1.2.2.2.2.2.2.2">𝑝</ci><ci id="algx1.l11.m1.2.2.2.2.2.2.3.cmml" xref="algx1.l11.m1.2.2.2.2.2.2.3">𝑖</ci></apply><cn id="algx1.l11.m1.2.2.2.2.2.3.cmml" type="integer" xref="algx1.l11.m1.2.2.2.2.2.3">2</cn></apply></interval><apply id="algx1.l11.m1.2.2.4.cmml" xref="algx1.l11.m1.2.2.4"><csymbol cd="ambiguous" id="algx1.l11.m1.2.2.4.1.cmml" xref="algx1.l11.m1.2.2.4">subscript</csymbol><ci id="algx1.l11.m1.2.2.4.2.cmml" xref="algx1.l11.m1.2.2.4.2">𝒫</ci><ci id="algx1.l11.m1.2.2.4.3.cmml" xref="algx1.l11.m1.2.2.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l11.m1.2c">(p_{i}^{1},p_{i}^{2})\subseteq\mathcal{P}_{i}</annotation><annotation encoding="application/x-llamapun" id="algx1.l11.m1.2d">( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ⊆ caligraphic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>         <math alttext="\rho_{1}" class="ltx_Math" display="inline" id="algx1.l12.m1.1"><semantics id="algx1.l12.m1.1a"><msub id="algx1.l12.m1.1.1" xref="algx1.l12.m1.1.1.cmml"><mi id="algx1.l12.m1.1.1.2" xref="algx1.l12.m1.1.1.2.cmml">ρ</mi><mn id="algx1.l12.m1.1.1.3" xref="algx1.l12.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="algx1.l12.m1.1b"><apply id="algx1.l12.m1.1.1.cmml" xref="algx1.l12.m1.1.1"><csymbol cd="ambiguous" id="algx1.l12.m1.1.1.1.cmml" xref="algx1.l12.m1.1.1">subscript</csymbol><ci id="algx1.l12.m1.1.1.2.cmml" xref="algx1.l12.m1.1.1.2">𝜌</ci><cn id="algx1.l12.m1.1.1.3.cmml" type="integer" xref="algx1.l12.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l12.m1.1c">\rho_{1}</annotation><annotation encoding="application/x-llamapun" id="algx1.l12.m1.1d">italic_ρ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> =
<span class="ltx_text ltx_font_typewriter" id="algx1.l12.1">[RT]</span> <math alttext="\oplus" class="ltx_Math" display="inline" id="algx1.l12.m2.1"><semantics id="algx1.l12.m2.1a"><mo id="algx1.l12.m2.1.1" xref="algx1.l12.m2.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="algx1.l12.m2.1b"><csymbol cd="latexml" id="algx1.l12.m2.1.1.cmml" xref="algx1.l12.m2.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="algx1.l12.m2.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="algx1.l12.m2.1d">⊕</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algx1.l12.2">&lt;p&gt;</span> <math alttext="\oplus\ p_{i}^{1}\oplus p_{i}^{2}\ \oplus" class="ltx_Math" display="inline" id="algx1.l12.m3.1"><semantics id="algx1.l12.m3.1a"><mrow id="algx1.l12.m3.1.1" xref="algx1.l12.m3.1.1.cmml"><mrow id="algx1.l12.m3.1.1.2" xref="algx1.l12.m3.1.1.2.cmml"><mo id="algx1.l12.m3.1.1.2a" rspace="0em" xref="algx1.l12.m3.1.1.2.cmml">⊕</mo><msubsup id="algx1.l12.m3.1.1.2.2" xref="algx1.l12.m3.1.1.2.2.cmml"><mi id="algx1.l12.m3.1.1.2.2.2.2" xref="algx1.l12.m3.1.1.2.2.2.2.cmml">p</mi><mi id="algx1.l12.m3.1.1.2.2.2.3" xref="algx1.l12.m3.1.1.2.2.2.3.cmml">i</mi><mn id="algx1.l12.m3.1.1.2.2.3" xref="algx1.l12.m3.1.1.2.2.3.cmml">1</mn></msubsup></mrow><mo id="algx1.l12.m3.1.1.1" xref="algx1.l12.m3.1.1.1.cmml">⊕</mo><mrow id="algx1.l12.m3.1.1.3" xref="algx1.l12.m3.1.1.3.cmml"><msubsup id="algx1.l12.m3.1.1.3.2" xref="algx1.l12.m3.1.1.3.2.cmml"><mi id="algx1.l12.m3.1.1.3.2.2.2" xref="algx1.l12.m3.1.1.3.2.2.2.cmml">p</mi><mi id="algx1.l12.m3.1.1.3.2.2.3" xref="algx1.l12.m3.1.1.3.2.2.3.cmml">i</mi><mn id="algx1.l12.m3.1.1.3.2.3" xref="algx1.l12.m3.1.1.3.2.3.cmml">2</mn></msubsup><mo id="algx1.l12.m3.1.1.3.3" xref="algx1.l12.m3.1.1.3.3.cmml">⊕</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l12.m3.1b"><apply id="algx1.l12.m3.1.1.cmml" xref="algx1.l12.m3.1.1"><csymbol cd="latexml" id="algx1.l12.m3.1.1.1.cmml" xref="algx1.l12.m3.1.1.1">direct-sum</csymbol><apply id="algx1.l12.m3.1.1.2.cmml" xref="algx1.l12.m3.1.1.2"><csymbol cd="latexml" id="algx1.l12.m3.1.1.2.1.cmml" xref="algx1.l12.m3.1.1.2">direct-sum</csymbol><apply id="algx1.l12.m3.1.1.2.2.cmml" xref="algx1.l12.m3.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l12.m3.1.1.2.2.1.cmml" xref="algx1.l12.m3.1.1.2.2">superscript</csymbol><apply id="algx1.l12.m3.1.1.2.2.2.cmml" xref="algx1.l12.m3.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l12.m3.1.1.2.2.2.1.cmml" xref="algx1.l12.m3.1.1.2.2">subscript</csymbol><ci id="algx1.l12.m3.1.1.2.2.2.2.cmml" xref="algx1.l12.m3.1.1.2.2.2.2">𝑝</ci><ci id="algx1.l12.m3.1.1.2.2.2.3.cmml" xref="algx1.l12.m3.1.1.2.2.2.3">𝑖</ci></apply><cn id="algx1.l12.m3.1.1.2.2.3.cmml" type="integer" xref="algx1.l12.m3.1.1.2.2.3">1</cn></apply></apply><apply id="algx1.l12.m3.1.1.3.cmml" xref="algx1.l12.m3.1.1.3"><csymbol cd="latexml" id="algx1.l12.m3.1.1.3.1.cmml" xref="algx1.l12.m3.1.1.3">limit-from</csymbol><apply id="algx1.l12.m3.1.1.3.2.cmml" xref="algx1.l12.m3.1.1.3.2"><csymbol cd="ambiguous" id="algx1.l12.m3.1.1.3.2.1.cmml" xref="algx1.l12.m3.1.1.3.2">superscript</csymbol><apply id="algx1.l12.m3.1.1.3.2.2.cmml" xref="algx1.l12.m3.1.1.3.2"><csymbol cd="ambiguous" id="algx1.l12.m3.1.1.3.2.2.1.cmml" xref="algx1.l12.m3.1.1.3.2">subscript</csymbol><ci id="algx1.l12.m3.1.1.3.2.2.2.cmml" xref="algx1.l12.m3.1.1.3.2.2.2">𝑝</ci><ci id="algx1.l12.m3.1.1.3.2.2.3.cmml" xref="algx1.l12.m3.1.1.3.2.2.3">𝑖</ci></apply><cn id="algx1.l12.m3.1.1.3.2.3.cmml" type="integer" xref="algx1.l12.m3.1.1.3.2.3">2</cn></apply><csymbol cd="latexml" id="algx1.l12.m3.1.1.3.3.cmml" xref="algx1.l12.m3.1.1.3.3">direct-sum</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l12.m3.1c">\oplus\ p_{i}^{1}\oplus p_{i}^{2}\ \oplus</annotation><annotation encoding="application/x-llamapun" id="algx1.l12.m3.1d">⊕ italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ⊕ italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⊕</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algx1.l12.3">&lt;/p&gt;</span> <math alttext="\oplus" class="ltx_Math" display="inline" id="algx1.l12.m4.1"><semantics id="algx1.l12.m4.1a"><mo id="algx1.l12.m4.1.1" xref="algx1.l12.m4.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="algx1.l12.m4.1b"><csymbol cd="latexml" id="algx1.l12.m4.1.1.cmml" xref="algx1.l12.m4.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="algx1.l12.m4.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="algx1.l12.m4.1d">⊕</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algx1.l12.4">[Relevant]</span> <math alttext="\oplus y_{i}\ \oplus" class="ltx_Math" display="inline" id="algx1.l12.m5.1"><semantics id="algx1.l12.m5.1a"><mrow id="algx1.l12.m5.1.1" xref="algx1.l12.m5.1.1.cmml"><mrow id="algx1.l12.m5.1.1.2" xref="algx1.l12.m5.1.1.2.cmml"><mo id="algx1.l12.m5.1.1.2a" rspace="0em" xref="algx1.l12.m5.1.1.2.cmml">⊕</mo><msub id="algx1.l12.m5.1.1.2.2" xref="algx1.l12.m5.1.1.2.2.cmml"><mi id="algx1.l12.m5.1.1.2.2.2" xref="algx1.l12.m5.1.1.2.2.2.cmml">y</mi><mi id="algx1.l12.m5.1.1.2.2.3" xref="algx1.l12.m5.1.1.2.2.3.cmml">i</mi></msub></mrow><mo id="algx1.l12.m5.1.1.3" xref="algx1.l12.m5.1.1.3.cmml">⊕</mo></mrow><annotation-xml encoding="MathML-Content" id="algx1.l12.m5.1b"><apply id="algx1.l12.m5.1.1.cmml" xref="algx1.l12.m5.1.1"><csymbol cd="latexml" id="algx1.l12.m5.1.1.1.cmml" xref="algx1.l12.m5.1.1">limit-from</csymbol><apply id="algx1.l12.m5.1.1.2.cmml" xref="algx1.l12.m5.1.1.2"><csymbol cd="latexml" id="algx1.l12.m5.1.1.2.1.cmml" xref="algx1.l12.m5.1.1.2">direct-sum</csymbol><apply id="algx1.l12.m5.1.1.2.2.cmml" xref="algx1.l12.m5.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l12.m5.1.1.2.2.1.cmml" xref="algx1.l12.m5.1.1.2.2">subscript</csymbol><ci id="algx1.l12.m5.1.1.2.2.2.cmml" xref="algx1.l12.m5.1.1.2.2.2">𝑦</ci><ci id="algx1.l12.m5.1.1.2.2.3.cmml" xref="algx1.l12.m5.1.1.2.2.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="algx1.l12.m5.1.1.3.cmml" xref="algx1.l12.m5.1.1.3">direct-sum</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l12.m5.1c">\oplus y_{i}\ \oplus</annotation><annotation encoding="application/x-llamapun" id="algx1.l12.m5.1d">⊕ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⊕</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algx1.l12.5">[Fully supported]</span> <math alttext="\oplus\ " class="ltx_Math" display="inline" id="algx1.l12.m6.1"><semantics id="algx1.l12.m6.1a"><mo id="algx1.l12.m6.1.1" xref="algx1.l12.m6.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="algx1.l12.m6.1b"><csymbol cd="latexml" id="algx1.l12.m6.1.1.cmml" xref="algx1.l12.m6.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="algx1.l12.m6.1c">\oplus\ </annotation><annotation encoding="application/x-llamapun" id="algx1.l12.m6.1d">⊕</annotation></semantics></math> <math alttext="U" class="ltx_Math" display="inline" id="algx1.l12.m7.1"><semantics id="algx1.l12.m7.1a"><mi id="algx1.l12.m7.1.1" xref="algx1.l12.m7.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="algx1.l12.m7.1b"><ci id="algx1.l12.m7.1.1.cmml" xref="algx1.l12.m7.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l12.m7.1c">U</annotation><annotation encoding="application/x-llamapun" id="algx1.l12.m7.1d">italic_U</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>         // Relevant and partially supported context

</div>
<div class="ltx_listingline" id="algx1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>         Randomly sample one context <math alttext="p_{i}^{3}\in\mathcal{P}_{i}" class="ltx_Math" display="inline" id="algx1.l14.m1.1"><semantics id="algx1.l14.m1.1a"><mrow id="algx1.l14.m1.1.1" xref="algx1.l14.m1.1.1.cmml"><msubsup id="algx1.l14.m1.1.1.2" xref="algx1.l14.m1.1.1.2.cmml"><mi id="algx1.l14.m1.1.1.2.2.2" xref="algx1.l14.m1.1.1.2.2.2.cmml">p</mi><mi id="algx1.l14.m1.1.1.2.2.3" xref="algx1.l14.m1.1.1.2.2.3.cmml">i</mi><mn id="algx1.l14.m1.1.1.2.3" xref="algx1.l14.m1.1.1.2.3.cmml">3</mn></msubsup><mo id="algx1.l14.m1.1.1.1" xref="algx1.l14.m1.1.1.1.cmml">∈</mo><msub id="algx1.l14.m1.1.1.3" xref="algx1.l14.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l14.m1.1.1.3.2" xref="algx1.l14.m1.1.1.3.2.cmml">𝒫</mi><mi id="algx1.l14.m1.1.1.3.3" xref="algx1.l14.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algx1.l14.m1.1b"><apply id="algx1.l14.m1.1.1.cmml" xref="algx1.l14.m1.1.1"><in id="algx1.l14.m1.1.1.1.cmml" xref="algx1.l14.m1.1.1.1"></in><apply id="algx1.l14.m1.1.1.2.cmml" xref="algx1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l14.m1.1.1.2.1.cmml" xref="algx1.l14.m1.1.1.2">superscript</csymbol><apply id="algx1.l14.m1.1.1.2.2.cmml" xref="algx1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l14.m1.1.1.2.2.1.cmml" xref="algx1.l14.m1.1.1.2">subscript</csymbol><ci id="algx1.l14.m1.1.1.2.2.2.cmml" xref="algx1.l14.m1.1.1.2.2.2">𝑝</ci><ci id="algx1.l14.m1.1.1.2.2.3.cmml" xref="algx1.l14.m1.1.1.2.2.3">𝑖</ci></apply><cn id="algx1.l14.m1.1.1.2.3.cmml" type="integer" xref="algx1.l14.m1.1.1.2.3">3</cn></apply><apply id="algx1.l14.m1.1.1.3.cmml" xref="algx1.l14.m1.1.1.3"><csymbol cd="ambiguous" id="algx1.l14.m1.1.1.3.1.cmml" xref="algx1.l14.m1.1.1.3">subscript</csymbol><ci id="algx1.l14.m1.1.1.3.2.cmml" xref="algx1.l14.m1.1.1.3.2">𝒫</ci><ci id="algx1.l14.m1.1.1.3.3.cmml" xref="algx1.l14.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l14.m1.1c">p_{i}^{3}\in\mathcal{P}_{i}</annotation><annotation encoding="application/x-llamapun" id="algx1.l14.m1.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT ∈ caligraphic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>         Randomly sample one context <math alttext="n_{i}^{1}\in\mathcal{N}_{i}" class="ltx_Math" display="inline" id="algx1.l15.m1.1"><semantics id="algx1.l15.m1.1a"><mrow id="algx1.l15.m1.1.1" xref="algx1.l15.m1.1.1.cmml"><msubsup id="algx1.l15.m1.1.1.2" xref="algx1.l15.m1.1.1.2.cmml"><mi id="algx1.l15.m1.1.1.2.2.2" xref="algx1.l15.m1.1.1.2.2.2.cmml">n</mi><mi id="algx1.l15.m1.1.1.2.2.3" xref="algx1.l15.m1.1.1.2.2.3.cmml">i</mi><mn id="algx1.l15.m1.1.1.2.3" xref="algx1.l15.m1.1.1.2.3.cmml">1</mn></msubsup><mo id="algx1.l15.m1.1.1.1" xref="algx1.l15.m1.1.1.1.cmml">∈</mo><msub id="algx1.l15.m1.1.1.3" xref="algx1.l15.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l15.m1.1.1.3.2" xref="algx1.l15.m1.1.1.3.2.cmml">𝒩</mi><mi id="algx1.l15.m1.1.1.3.3" xref="algx1.l15.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algx1.l15.m1.1b"><apply id="algx1.l15.m1.1.1.cmml" xref="algx1.l15.m1.1.1"><in id="algx1.l15.m1.1.1.1.cmml" xref="algx1.l15.m1.1.1.1"></in><apply id="algx1.l15.m1.1.1.2.cmml" xref="algx1.l15.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l15.m1.1.1.2.1.cmml" xref="algx1.l15.m1.1.1.2">superscript</csymbol><apply id="algx1.l15.m1.1.1.2.2.cmml" xref="algx1.l15.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l15.m1.1.1.2.2.1.cmml" xref="algx1.l15.m1.1.1.2">subscript</csymbol><ci id="algx1.l15.m1.1.1.2.2.2.cmml" xref="algx1.l15.m1.1.1.2.2.2">𝑛</ci><ci id="algx1.l15.m1.1.1.2.2.3.cmml" xref="algx1.l15.m1.1.1.2.2.3">𝑖</ci></apply><cn id="algx1.l15.m1.1.1.2.3.cmml" type="integer" xref="algx1.l15.m1.1.1.2.3">1</cn></apply><apply id="algx1.l15.m1.1.1.3.cmml" xref="algx1.l15.m1.1.1.3"><csymbol cd="ambiguous" id="algx1.l15.m1.1.1.3.1.cmml" xref="algx1.l15.m1.1.1.3">subscript</csymbol><ci id="algx1.l15.m1.1.1.3.2.cmml" xref="algx1.l15.m1.1.1.3.2">𝒩</ci><ci id="algx1.l15.m1.1.1.3.3.cmml" xref="algx1.l15.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l15.m1.1c">n_{i}^{1}\in\mathcal{N}_{i}</annotation><annotation encoding="application/x-llamapun" id="algx1.l15.m1.1d">italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>         <math alttext="\rho_{2}" class="ltx_Math" display="inline" id="algx1.l16.m1.1"><semantics id="algx1.l16.m1.1a"><msub id="algx1.l16.m1.1.1" xref="algx1.l16.m1.1.1.cmml"><mi id="algx1.l16.m1.1.1.2" xref="algx1.l16.m1.1.1.2.cmml">ρ</mi><mn id="algx1.l16.m1.1.1.3" xref="algx1.l16.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="algx1.l16.m1.1b"><apply id="algx1.l16.m1.1.1.cmml" xref="algx1.l16.m1.1.1"><csymbol cd="ambiguous" id="algx1.l16.m1.1.1.1.cmml" xref="algx1.l16.m1.1.1">subscript</csymbol><ci id="algx1.l16.m1.1.1.2.cmml" xref="algx1.l16.m1.1.1.2">𝜌</ci><cn id="algx1.l16.m1.1.1.3.cmml" type="integer" xref="algx1.l16.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l16.m1.1c">\rho_{2}</annotation><annotation encoding="application/x-llamapun" id="algx1.l16.m1.1d">italic_ρ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> =
<span class="ltx_text ltx_font_typewriter" id="algx1.l16.1">[RT]</span> <math alttext="\oplus" class="ltx_Math" display="inline" id="algx1.l16.m2.1"><semantics id="algx1.l16.m2.1a"><mo id="algx1.l16.m2.1.1" xref="algx1.l16.m2.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="algx1.l16.m2.1b"><csymbol cd="latexml" id="algx1.l16.m2.1.1.cmml" xref="algx1.l16.m2.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="algx1.l16.m2.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="algx1.l16.m2.1d">⊕</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algx1.l16.2">&lt;p&gt;</span> <math alttext="\oplus\ p_{i}^{3}\ \oplus\ u_{i}^{1}\ \oplus" class="ltx_Math" display="inline" id="algx1.l16.m3.1"><semantics id="algx1.l16.m3.1a"><mrow id="algx1.l16.m3.1.1" xref="algx1.l16.m3.1.1.cmml"><mrow id="algx1.l16.m3.1.1.2" xref="algx1.l16.m3.1.1.2.cmml"><mo id="algx1.l16.m3.1.1.2a" rspace="0em" xref="algx1.l16.m3.1.1.2.cmml">⊕</mo><msubsup id="algx1.l16.m3.1.1.2.2" xref="algx1.l16.m3.1.1.2.2.cmml"><mi id="algx1.l16.m3.1.1.2.2.2.2" xref="algx1.l16.m3.1.1.2.2.2.2.cmml">p</mi><mi id="algx1.l16.m3.1.1.2.2.2.3" xref="algx1.l16.m3.1.1.2.2.2.3.cmml">i</mi><mn id="algx1.l16.m3.1.1.2.2.3" xref="algx1.l16.m3.1.1.2.2.3.cmml">3</mn></msubsup></mrow><mo id="algx1.l16.m3.1.1.1" rspace="0.722em" xref="algx1.l16.m3.1.1.1.cmml">⊕</mo><mrow id="algx1.l16.m3.1.1.3" xref="algx1.l16.m3.1.1.3.cmml"><msubsup id="algx1.l16.m3.1.1.3.2" xref="algx1.l16.m3.1.1.3.2.cmml"><mi id="algx1.l16.m3.1.1.3.2.2.2" xref="algx1.l16.m3.1.1.3.2.2.2.cmml">u</mi><mi id="algx1.l16.m3.1.1.3.2.2.3" xref="algx1.l16.m3.1.1.3.2.2.3.cmml">i</mi><mn id="algx1.l16.m3.1.1.3.2.3" xref="algx1.l16.m3.1.1.3.2.3.cmml">1</mn></msubsup><mo id="algx1.l16.m3.1.1.3.3" xref="algx1.l16.m3.1.1.3.3.cmml">⊕</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l16.m3.1b"><apply id="algx1.l16.m3.1.1.cmml" xref="algx1.l16.m3.1.1"><csymbol cd="latexml" id="algx1.l16.m3.1.1.1.cmml" xref="algx1.l16.m3.1.1.1">direct-sum</csymbol><apply id="algx1.l16.m3.1.1.2.cmml" xref="algx1.l16.m3.1.1.2"><csymbol cd="latexml" id="algx1.l16.m3.1.1.2.1.cmml" xref="algx1.l16.m3.1.1.2">direct-sum</csymbol><apply id="algx1.l16.m3.1.1.2.2.cmml" xref="algx1.l16.m3.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l16.m3.1.1.2.2.1.cmml" xref="algx1.l16.m3.1.1.2.2">superscript</csymbol><apply id="algx1.l16.m3.1.1.2.2.2.cmml" xref="algx1.l16.m3.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l16.m3.1.1.2.2.2.1.cmml" xref="algx1.l16.m3.1.1.2.2">subscript</csymbol><ci id="algx1.l16.m3.1.1.2.2.2.2.cmml" xref="algx1.l16.m3.1.1.2.2.2.2">𝑝</ci><ci id="algx1.l16.m3.1.1.2.2.2.3.cmml" xref="algx1.l16.m3.1.1.2.2.2.3">𝑖</ci></apply><cn id="algx1.l16.m3.1.1.2.2.3.cmml" type="integer" xref="algx1.l16.m3.1.1.2.2.3">3</cn></apply></apply><apply id="algx1.l16.m3.1.1.3.cmml" xref="algx1.l16.m3.1.1.3"><csymbol cd="latexml" id="algx1.l16.m3.1.1.3.1.cmml" xref="algx1.l16.m3.1.1.3">limit-from</csymbol><apply id="algx1.l16.m3.1.1.3.2.cmml" xref="algx1.l16.m3.1.1.3.2"><csymbol cd="ambiguous" id="algx1.l16.m3.1.1.3.2.1.cmml" xref="algx1.l16.m3.1.1.3.2">superscript</csymbol><apply id="algx1.l16.m3.1.1.3.2.2.cmml" xref="algx1.l16.m3.1.1.3.2"><csymbol cd="ambiguous" id="algx1.l16.m3.1.1.3.2.2.1.cmml" xref="algx1.l16.m3.1.1.3.2">subscript</csymbol><ci id="algx1.l16.m3.1.1.3.2.2.2.cmml" xref="algx1.l16.m3.1.1.3.2.2.2">𝑢</ci><ci id="algx1.l16.m3.1.1.3.2.2.3.cmml" xref="algx1.l16.m3.1.1.3.2.2.3">𝑖</ci></apply><cn id="algx1.l16.m3.1.1.3.2.3.cmml" type="integer" xref="algx1.l16.m3.1.1.3.2.3">1</cn></apply><csymbol cd="latexml" id="algx1.l16.m3.1.1.3.3.cmml" xref="algx1.l16.m3.1.1.3.3">direct-sum</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l16.m3.1c">\oplus\ p_{i}^{3}\ \oplus\ u_{i}^{1}\ \oplus</annotation><annotation encoding="application/x-llamapun" id="algx1.l16.m3.1d">⊕ italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT ⊕ italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ⊕</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algx1.l16.3">&lt;/p&gt;</span> <math alttext="\oplus" class="ltx_Math" display="inline" id="algx1.l16.m4.1"><semantics id="algx1.l16.m4.1a"><mo id="algx1.l16.m4.1.1" xref="algx1.l16.m4.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="algx1.l16.m4.1b"><csymbol cd="latexml" id="algx1.l16.m4.1.1.cmml" xref="algx1.l16.m4.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="algx1.l16.m4.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="algx1.l16.m4.1d">⊕</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algx1.l16.4">[Relevant]</span> <math alttext="\oplus y_{i}\oplus" class="ltx_Math" display="inline" id="algx1.l16.m5.1"><semantics id="algx1.l16.m5.1a"><mrow id="algx1.l16.m5.1.1" xref="algx1.l16.m5.1.1.cmml"><mrow id="algx1.l16.m5.1.1.2" xref="algx1.l16.m5.1.1.2.cmml"><mo id="algx1.l16.m5.1.1.2a" rspace="0em" xref="algx1.l16.m5.1.1.2.cmml">⊕</mo><msub id="algx1.l16.m5.1.1.2.2" xref="algx1.l16.m5.1.1.2.2.cmml"><mi id="algx1.l16.m5.1.1.2.2.2" xref="algx1.l16.m5.1.1.2.2.2.cmml">y</mi><mi id="algx1.l16.m5.1.1.2.2.3" xref="algx1.l16.m5.1.1.2.2.3.cmml">i</mi></msub></mrow><mo id="algx1.l16.m5.1.1.3" xref="algx1.l16.m5.1.1.3.cmml">⊕</mo></mrow><annotation-xml encoding="MathML-Content" id="algx1.l16.m5.1b"><apply id="algx1.l16.m5.1.1.cmml" xref="algx1.l16.m5.1.1"><csymbol cd="latexml" id="algx1.l16.m5.1.1.1.cmml" xref="algx1.l16.m5.1.1">limit-from</csymbol><apply id="algx1.l16.m5.1.1.2.cmml" xref="algx1.l16.m5.1.1.2"><csymbol cd="latexml" id="algx1.l16.m5.1.1.2.1.cmml" xref="algx1.l16.m5.1.1.2">direct-sum</csymbol><apply id="algx1.l16.m5.1.1.2.2.cmml" xref="algx1.l16.m5.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l16.m5.1.1.2.2.1.cmml" xref="algx1.l16.m5.1.1.2.2">subscript</csymbol><ci id="algx1.l16.m5.1.1.2.2.2.cmml" xref="algx1.l16.m5.1.1.2.2.2">𝑦</ci><ci id="algx1.l16.m5.1.1.2.2.3.cmml" xref="algx1.l16.m5.1.1.2.2.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="algx1.l16.m5.1.1.3.cmml" xref="algx1.l16.m5.1.1.3">direct-sum</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l16.m5.1c">\oplus y_{i}\oplus</annotation><annotation encoding="application/x-llamapun" id="algx1.l16.m5.1d">⊕ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⊕</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algx1.l16.5">[Partially supported]</span> <math alttext="\oplus\ " class="ltx_Math" display="inline" id="algx1.l16.m6.1"><semantics id="algx1.l16.m6.1a"><mo id="algx1.l16.m6.1.1" xref="algx1.l16.m6.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="algx1.l16.m6.1b"><csymbol cd="latexml" id="algx1.l16.m6.1.1.cmml" xref="algx1.l16.m6.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="algx1.l16.m6.1c">\oplus\ </annotation><annotation encoding="application/x-llamapun" id="algx1.l16.m6.1d">⊕</annotation></semantics></math> <math alttext="U" class="ltx_Math" display="inline" id="algx1.l16.m7.1"><semantics id="algx1.l16.m7.1a"><mi id="algx1.l16.m7.1.1" xref="algx1.l16.m7.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="algx1.l16.m7.1b"><ci id="algx1.l16.m7.1.1.cmml" xref="algx1.l16.m7.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l16.m7.1c">U</annotation><annotation encoding="application/x-llamapun" id="algx1.l16.m7.1d">italic_U</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>         // Irrelevant context

</div>
<div class="ltx_listingline" id="algx1.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span>         Without replacement, uniformly sample two contexts <math alttext="(n_{i}^{2},n_{i}^{3})\subseteq\mathcal{N}_{i}" class="ltx_Math" display="inline" id="algx1.l18.m1.2"><semantics id="algx1.l18.m1.2a"><mrow id="algx1.l18.m1.2.2" xref="algx1.l18.m1.2.2.cmml"><mrow id="algx1.l18.m1.2.2.2.2" xref="algx1.l18.m1.2.2.2.3.cmml"><mo id="algx1.l18.m1.2.2.2.2.3" stretchy="false" xref="algx1.l18.m1.2.2.2.3.cmml">(</mo><msubsup id="algx1.l18.m1.1.1.1.1.1" xref="algx1.l18.m1.1.1.1.1.1.cmml"><mi id="algx1.l18.m1.1.1.1.1.1.2.2" xref="algx1.l18.m1.1.1.1.1.1.2.2.cmml">n</mi><mi id="algx1.l18.m1.1.1.1.1.1.2.3" xref="algx1.l18.m1.1.1.1.1.1.2.3.cmml">i</mi><mn id="algx1.l18.m1.1.1.1.1.1.3" xref="algx1.l18.m1.1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="algx1.l18.m1.2.2.2.2.4" xref="algx1.l18.m1.2.2.2.3.cmml">,</mo><msubsup id="algx1.l18.m1.2.2.2.2.2" xref="algx1.l18.m1.2.2.2.2.2.cmml"><mi id="algx1.l18.m1.2.2.2.2.2.2.2" xref="algx1.l18.m1.2.2.2.2.2.2.2.cmml">n</mi><mi id="algx1.l18.m1.2.2.2.2.2.2.3" xref="algx1.l18.m1.2.2.2.2.2.2.3.cmml">i</mi><mn id="algx1.l18.m1.2.2.2.2.2.3" xref="algx1.l18.m1.2.2.2.2.2.3.cmml">3</mn></msubsup><mo id="algx1.l18.m1.2.2.2.2.5" stretchy="false" xref="algx1.l18.m1.2.2.2.3.cmml">)</mo></mrow><mo id="algx1.l18.m1.2.2.3" xref="algx1.l18.m1.2.2.3.cmml">⊆</mo><msub id="algx1.l18.m1.2.2.4" xref="algx1.l18.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l18.m1.2.2.4.2" xref="algx1.l18.m1.2.2.4.2.cmml">𝒩</mi><mi id="algx1.l18.m1.2.2.4.3" xref="algx1.l18.m1.2.2.4.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algx1.l18.m1.2b"><apply id="algx1.l18.m1.2.2.cmml" xref="algx1.l18.m1.2.2"><subset id="algx1.l18.m1.2.2.3.cmml" xref="algx1.l18.m1.2.2.3"></subset><interval closure="open" id="algx1.l18.m1.2.2.2.3.cmml" xref="algx1.l18.m1.2.2.2.2"><apply id="algx1.l18.m1.1.1.1.1.1.cmml" xref="algx1.l18.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l18.m1.1.1.1.1.1.1.cmml" xref="algx1.l18.m1.1.1.1.1.1">superscript</csymbol><apply id="algx1.l18.m1.1.1.1.1.1.2.cmml" xref="algx1.l18.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l18.m1.1.1.1.1.1.2.1.cmml" xref="algx1.l18.m1.1.1.1.1.1">subscript</csymbol><ci id="algx1.l18.m1.1.1.1.1.1.2.2.cmml" xref="algx1.l18.m1.1.1.1.1.1.2.2">𝑛</ci><ci id="algx1.l18.m1.1.1.1.1.1.2.3.cmml" xref="algx1.l18.m1.1.1.1.1.1.2.3">𝑖</ci></apply><cn id="algx1.l18.m1.1.1.1.1.1.3.cmml" type="integer" xref="algx1.l18.m1.1.1.1.1.1.3">2</cn></apply><apply id="algx1.l18.m1.2.2.2.2.2.cmml" xref="algx1.l18.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algx1.l18.m1.2.2.2.2.2.1.cmml" xref="algx1.l18.m1.2.2.2.2.2">superscript</csymbol><apply id="algx1.l18.m1.2.2.2.2.2.2.cmml" xref="algx1.l18.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algx1.l18.m1.2.2.2.2.2.2.1.cmml" xref="algx1.l18.m1.2.2.2.2.2">subscript</csymbol><ci id="algx1.l18.m1.2.2.2.2.2.2.2.cmml" xref="algx1.l18.m1.2.2.2.2.2.2.2">𝑛</ci><ci id="algx1.l18.m1.2.2.2.2.2.2.3.cmml" xref="algx1.l18.m1.2.2.2.2.2.2.3">𝑖</ci></apply><cn id="algx1.l18.m1.2.2.2.2.2.3.cmml" type="integer" xref="algx1.l18.m1.2.2.2.2.2.3">3</cn></apply></interval><apply id="algx1.l18.m1.2.2.4.cmml" xref="algx1.l18.m1.2.2.4"><csymbol cd="ambiguous" id="algx1.l18.m1.2.2.4.1.cmml" xref="algx1.l18.m1.2.2.4">subscript</csymbol><ci id="algx1.l18.m1.2.2.4.2.cmml" xref="algx1.l18.m1.2.2.4.2">𝒩</ci><ci id="algx1.l18.m1.2.2.4.3.cmml" xref="algx1.l18.m1.2.2.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l18.m1.2c">(n_{i}^{2},n_{i}^{3})\subseteq\mathcal{N}_{i}</annotation><annotation encoding="application/x-llamapun" id="algx1.l18.m1.2d">( italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT ) ⊆ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l19">
<span class="ltx_tag ltx_tag_listingline">19:</span>         <math alttext="\rho_{3}" class="ltx_Math" display="inline" id="algx1.l19.m1.1"><semantics id="algx1.l19.m1.1a"><msub id="algx1.l19.m1.1.1" xref="algx1.l19.m1.1.1.cmml"><mi id="algx1.l19.m1.1.1.2" xref="algx1.l19.m1.1.1.2.cmml">ρ</mi><mn id="algx1.l19.m1.1.1.3" xref="algx1.l19.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="algx1.l19.m1.1b"><apply id="algx1.l19.m1.1.1.cmml" xref="algx1.l19.m1.1.1"><csymbol cd="ambiguous" id="algx1.l19.m1.1.1.1.cmml" xref="algx1.l19.m1.1.1">subscript</csymbol><ci id="algx1.l19.m1.1.1.2.cmml" xref="algx1.l19.m1.1.1.2">𝜌</ci><cn id="algx1.l19.m1.1.1.3.cmml" type="integer" xref="algx1.l19.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l19.m1.1c">\rho_{3}</annotation><annotation encoding="application/x-llamapun" id="algx1.l19.m1.1d">italic_ρ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> =
<span class="ltx_text ltx_font_typewriter" id="algx1.l19.1">[RT]</span> <math alttext="\oplus" class="ltx_Math" display="inline" id="algx1.l19.m2.1"><semantics id="algx1.l19.m2.1a"><mo id="algx1.l19.m2.1.1" xref="algx1.l19.m2.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="algx1.l19.m2.1b"><csymbol cd="latexml" id="algx1.l19.m2.1.1.cmml" xref="algx1.l19.m2.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="algx1.l19.m2.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="algx1.l19.m2.1d">⊕</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algx1.l19.2">&lt;p&gt;</span> <math alttext="\oplus\ n_{i}^{2}\ \oplus n_{i}^{3}\ \oplus" class="ltx_Math" display="inline" id="algx1.l19.m3.1"><semantics id="algx1.l19.m3.1a"><mrow id="algx1.l19.m3.1.1" xref="algx1.l19.m3.1.1.cmml"><mrow id="algx1.l19.m3.1.1.2" xref="algx1.l19.m3.1.1.2.cmml"><mo id="algx1.l19.m3.1.1.2a" rspace="0em" xref="algx1.l19.m3.1.1.2.cmml">⊕</mo><msubsup id="algx1.l19.m3.1.1.2.2" xref="algx1.l19.m3.1.1.2.2.cmml"><mi id="algx1.l19.m3.1.1.2.2.2.2" xref="algx1.l19.m3.1.1.2.2.2.2.cmml">n</mi><mi id="algx1.l19.m3.1.1.2.2.2.3" xref="algx1.l19.m3.1.1.2.2.2.3.cmml">i</mi><mn id="algx1.l19.m3.1.1.2.2.3" xref="algx1.l19.m3.1.1.2.2.3.cmml">2</mn></msubsup></mrow><mo id="algx1.l19.m3.1.1.1" xref="algx1.l19.m3.1.1.1.cmml">⊕</mo><mrow id="algx1.l19.m3.1.1.3" xref="algx1.l19.m3.1.1.3.cmml"><msubsup id="algx1.l19.m3.1.1.3.2" xref="algx1.l19.m3.1.1.3.2.cmml"><mi id="algx1.l19.m3.1.1.3.2.2.2" xref="algx1.l19.m3.1.1.3.2.2.2.cmml">n</mi><mi id="algx1.l19.m3.1.1.3.2.2.3" xref="algx1.l19.m3.1.1.3.2.2.3.cmml">i</mi><mn id="algx1.l19.m3.1.1.3.2.3" xref="algx1.l19.m3.1.1.3.2.3.cmml">3</mn></msubsup><mo id="algx1.l19.m3.1.1.3.3" xref="algx1.l19.m3.1.1.3.3.cmml">⊕</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l19.m3.1b"><apply id="algx1.l19.m3.1.1.cmml" xref="algx1.l19.m3.1.1"><csymbol cd="latexml" id="algx1.l19.m3.1.1.1.cmml" xref="algx1.l19.m3.1.1.1">direct-sum</csymbol><apply id="algx1.l19.m3.1.1.2.cmml" xref="algx1.l19.m3.1.1.2"><csymbol cd="latexml" id="algx1.l19.m3.1.1.2.1.cmml" xref="algx1.l19.m3.1.1.2">direct-sum</csymbol><apply id="algx1.l19.m3.1.1.2.2.cmml" xref="algx1.l19.m3.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l19.m3.1.1.2.2.1.cmml" xref="algx1.l19.m3.1.1.2.2">superscript</csymbol><apply id="algx1.l19.m3.1.1.2.2.2.cmml" xref="algx1.l19.m3.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l19.m3.1.1.2.2.2.1.cmml" xref="algx1.l19.m3.1.1.2.2">subscript</csymbol><ci id="algx1.l19.m3.1.1.2.2.2.2.cmml" xref="algx1.l19.m3.1.1.2.2.2.2">𝑛</ci><ci id="algx1.l19.m3.1.1.2.2.2.3.cmml" xref="algx1.l19.m3.1.1.2.2.2.3">𝑖</ci></apply><cn id="algx1.l19.m3.1.1.2.2.3.cmml" type="integer" xref="algx1.l19.m3.1.1.2.2.3">2</cn></apply></apply><apply id="algx1.l19.m3.1.1.3.cmml" xref="algx1.l19.m3.1.1.3"><csymbol cd="latexml" id="algx1.l19.m3.1.1.3.1.cmml" xref="algx1.l19.m3.1.1.3">limit-from</csymbol><apply id="algx1.l19.m3.1.1.3.2.cmml" xref="algx1.l19.m3.1.1.3.2"><csymbol cd="ambiguous" id="algx1.l19.m3.1.1.3.2.1.cmml" xref="algx1.l19.m3.1.1.3.2">superscript</csymbol><apply id="algx1.l19.m3.1.1.3.2.2.cmml" xref="algx1.l19.m3.1.1.3.2"><csymbol cd="ambiguous" id="algx1.l19.m3.1.1.3.2.2.1.cmml" xref="algx1.l19.m3.1.1.3.2">subscript</csymbol><ci id="algx1.l19.m3.1.1.3.2.2.2.cmml" xref="algx1.l19.m3.1.1.3.2.2.2">𝑛</ci><ci id="algx1.l19.m3.1.1.3.2.2.3.cmml" xref="algx1.l19.m3.1.1.3.2.2.3">𝑖</ci></apply><cn id="algx1.l19.m3.1.1.3.2.3.cmml" type="integer" xref="algx1.l19.m3.1.1.3.2.3">3</cn></apply><csymbol cd="latexml" id="algx1.l19.m3.1.1.3.3.cmml" xref="algx1.l19.m3.1.1.3.3">direct-sum</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l19.m3.1c">\oplus\ n_{i}^{2}\ \oplus n_{i}^{3}\ \oplus</annotation><annotation encoding="application/x-llamapun" id="algx1.l19.m3.1d">⊕ italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⊕ italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT ⊕</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algx1.l19.3">&lt;/p&gt;</span> <math alttext="\oplus" class="ltx_Math" display="inline" id="algx1.l19.m4.1"><semantics id="algx1.l19.m4.1a"><mo id="algx1.l19.m4.1.1" xref="algx1.l19.m4.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="algx1.l19.m4.1b"><csymbol cd="latexml" id="algx1.l19.m4.1.1.cmml" xref="algx1.l19.m4.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="algx1.l19.m4.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="algx1.l19.m4.1d">⊕</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algx1.l19.4">[Irrelevant]</span> <math alttext="\oplus\ y_{i}\ \oplus" class="ltx_Math" display="inline" id="algx1.l19.m5.1"><semantics id="algx1.l19.m5.1a"><mrow id="algx1.l19.m5.1.1" xref="algx1.l19.m5.1.1.cmml"><mrow id="algx1.l19.m5.1.1.2" xref="algx1.l19.m5.1.1.2.cmml"><mo id="algx1.l19.m5.1.1.2a" rspace="0em" xref="algx1.l19.m5.1.1.2.cmml">⊕</mo><msub id="algx1.l19.m5.1.1.2.2" xref="algx1.l19.m5.1.1.2.2.cmml"><mi id="algx1.l19.m5.1.1.2.2.2" xref="algx1.l19.m5.1.1.2.2.2.cmml">y</mi><mi id="algx1.l19.m5.1.1.2.2.3" xref="algx1.l19.m5.1.1.2.2.3.cmml">i</mi></msub></mrow><mo id="algx1.l19.m5.1.1.3" xref="algx1.l19.m5.1.1.3.cmml">⊕</mo></mrow><annotation-xml encoding="MathML-Content" id="algx1.l19.m5.1b"><apply id="algx1.l19.m5.1.1.cmml" xref="algx1.l19.m5.1.1"><csymbol cd="latexml" id="algx1.l19.m5.1.1.1.cmml" xref="algx1.l19.m5.1.1">limit-from</csymbol><apply id="algx1.l19.m5.1.1.2.cmml" xref="algx1.l19.m5.1.1.2"><csymbol cd="latexml" id="algx1.l19.m5.1.1.2.1.cmml" xref="algx1.l19.m5.1.1.2">direct-sum</csymbol><apply id="algx1.l19.m5.1.1.2.2.cmml" xref="algx1.l19.m5.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l19.m5.1.1.2.2.1.cmml" xref="algx1.l19.m5.1.1.2.2">subscript</csymbol><ci id="algx1.l19.m5.1.1.2.2.2.cmml" xref="algx1.l19.m5.1.1.2.2.2">𝑦</ci><ci id="algx1.l19.m5.1.1.2.2.3.cmml" xref="algx1.l19.m5.1.1.2.2.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="algx1.l19.m5.1.1.3.cmml" xref="algx1.l19.m5.1.1.3">direct-sum</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l19.m5.1c">\oplus\ y_{i}\ \oplus</annotation><annotation encoding="application/x-llamapun" id="algx1.l19.m5.1d">⊕ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⊕</annotation></semantics></math> <math alttext="U" class="ltx_Math" display="inline" id="algx1.l19.m6.1"><semantics id="algx1.l19.m6.1a"><mi id="algx1.l19.m6.1.1" xref="algx1.l19.m6.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="algx1.l19.m6.1b"><ci id="algx1.l19.m6.1.1.cmml" xref="algx1.l19.m6.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l19.m6.1c">U</annotation><annotation encoding="application/x-llamapun" id="algx1.l19.m6.1d">italic_U</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l20">
<span class="ltx_tag ltx_tag_listingline">20:</span>         <math alttext="\hat{D}\coloneqq\hat{D}\cup\{(q_{i},\rho_{1}),(q_{i},\rho_{2}),(q_{i},\rho_{3})\}" class="ltx_Math" display="inline" id="algx1.l20.m1.3"><semantics id="algx1.l20.m1.3a"><mrow id="algx1.l20.m1.3.3" xref="algx1.l20.m1.3.3.cmml"><mover accent="true" id="algx1.l20.m1.3.3.5" xref="algx1.l20.m1.3.3.5.cmml"><mi id="algx1.l20.m1.3.3.5.2" xref="algx1.l20.m1.3.3.5.2.cmml">D</mi><mo id="algx1.l20.m1.3.3.5.1" xref="algx1.l20.m1.3.3.5.1.cmml">^</mo></mover><mo id="algx1.l20.m1.3.3.4" xref="algx1.l20.m1.3.3.4.cmml">≔</mo><mrow id="algx1.l20.m1.3.3.3" xref="algx1.l20.m1.3.3.3.cmml"><mover accent="true" id="algx1.l20.m1.3.3.3.5" xref="algx1.l20.m1.3.3.3.5.cmml"><mi id="algx1.l20.m1.3.3.3.5.2" xref="algx1.l20.m1.3.3.3.5.2.cmml">D</mi><mo id="algx1.l20.m1.3.3.3.5.1" xref="algx1.l20.m1.3.3.3.5.1.cmml">^</mo></mover><mo id="algx1.l20.m1.3.3.3.4" xref="algx1.l20.m1.3.3.3.4.cmml">∪</mo><mrow id="algx1.l20.m1.3.3.3.3.3" xref="algx1.l20.m1.3.3.3.3.4.cmml"><mo id="algx1.l20.m1.3.3.3.3.3.4" stretchy="false" xref="algx1.l20.m1.3.3.3.3.4.cmml">{</mo><mrow id="algx1.l20.m1.1.1.1.1.1.1.2" xref="algx1.l20.m1.1.1.1.1.1.1.3.cmml"><mo id="algx1.l20.m1.1.1.1.1.1.1.2.3" stretchy="false" xref="algx1.l20.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="algx1.l20.m1.1.1.1.1.1.1.1.1" xref="algx1.l20.m1.1.1.1.1.1.1.1.1.cmml"><mi id="algx1.l20.m1.1.1.1.1.1.1.1.1.2" xref="algx1.l20.m1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mi id="algx1.l20.m1.1.1.1.1.1.1.1.1.3" xref="algx1.l20.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algx1.l20.m1.1.1.1.1.1.1.2.4" xref="algx1.l20.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="algx1.l20.m1.1.1.1.1.1.1.2.2" xref="algx1.l20.m1.1.1.1.1.1.1.2.2.cmml"><mi id="algx1.l20.m1.1.1.1.1.1.1.2.2.2" xref="algx1.l20.m1.1.1.1.1.1.1.2.2.2.cmml">ρ</mi><mn id="algx1.l20.m1.1.1.1.1.1.1.2.2.3" xref="algx1.l20.m1.1.1.1.1.1.1.2.2.3.cmml">1</mn></msub><mo id="algx1.l20.m1.1.1.1.1.1.1.2.5" stretchy="false" xref="algx1.l20.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="algx1.l20.m1.3.3.3.3.3.5" xref="algx1.l20.m1.3.3.3.3.4.cmml">,</mo><mrow id="algx1.l20.m1.2.2.2.2.2.2.2" xref="algx1.l20.m1.2.2.2.2.2.2.3.cmml"><mo id="algx1.l20.m1.2.2.2.2.2.2.2.3" stretchy="false" xref="algx1.l20.m1.2.2.2.2.2.2.3.cmml">(</mo><msub id="algx1.l20.m1.2.2.2.2.2.2.1.1" xref="algx1.l20.m1.2.2.2.2.2.2.1.1.cmml"><mi id="algx1.l20.m1.2.2.2.2.2.2.1.1.2" xref="algx1.l20.m1.2.2.2.2.2.2.1.1.2.cmml">q</mi><mi id="algx1.l20.m1.2.2.2.2.2.2.1.1.3" xref="algx1.l20.m1.2.2.2.2.2.2.1.1.3.cmml">i</mi></msub><mo id="algx1.l20.m1.2.2.2.2.2.2.2.4" xref="algx1.l20.m1.2.2.2.2.2.2.3.cmml">,</mo><msub id="algx1.l20.m1.2.2.2.2.2.2.2.2" xref="algx1.l20.m1.2.2.2.2.2.2.2.2.cmml"><mi id="algx1.l20.m1.2.2.2.2.2.2.2.2.2" xref="algx1.l20.m1.2.2.2.2.2.2.2.2.2.cmml">ρ</mi><mn id="algx1.l20.m1.2.2.2.2.2.2.2.2.3" xref="algx1.l20.m1.2.2.2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="algx1.l20.m1.2.2.2.2.2.2.2.5" stretchy="false" xref="algx1.l20.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow><mo id="algx1.l20.m1.3.3.3.3.3.6" xref="algx1.l20.m1.3.3.3.3.4.cmml">,</mo><mrow id="algx1.l20.m1.3.3.3.3.3.3.2" xref="algx1.l20.m1.3.3.3.3.3.3.3.cmml"><mo id="algx1.l20.m1.3.3.3.3.3.3.2.3" stretchy="false" xref="algx1.l20.m1.3.3.3.3.3.3.3.cmml">(</mo><msub id="algx1.l20.m1.3.3.3.3.3.3.1.1" xref="algx1.l20.m1.3.3.3.3.3.3.1.1.cmml"><mi id="algx1.l20.m1.3.3.3.3.3.3.1.1.2" xref="algx1.l20.m1.3.3.3.3.3.3.1.1.2.cmml">q</mi><mi id="algx1.l20.m1.3.3.3.3.3.3.1.1.3" xref="algx1.l20.m1.3.3.3.3.3.3.1.1.3.cmml">i</mi></msub><mo id="algx1.l20.m1.3.3.3.3.3.3.2.4" xref="algx1.l20.m1.3.3.3.3.3.3.3.cmml">,</mo><msub id="algx1.l20.m1.3.3.3.3.3.3.2.2" xref="algx1.l20.m1.3.3.3.3.3.3.2.2.cmml"><mi id="algx1.l20.m1.3.3.3.3.3.3.2.2.2" xref="algx1.l20.m1.3.3.3.3.3.3.2.2.2.cmml">ρ</mi><mn id="algx1.l20.m1.3.3.3.3.3.3.2.2.3" xref="algx1.l20.m1.3.3.3.3.3.3.2.2.3.cmml">3</mn></msub><mo id="algx1.l20.m1.3.3.3.3.3.3.2.5" stretchy="false" xref="algx1.l20.m1.3.3.3.3.3.3.3.cmml">)</mo></mrow><mo id="algx1.l20.m1.3.3.3.3.3.7" stretchy="false" xref="algx1.l20.m1.3.3.3.3.4.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l20.m1.3b"><apply id="algx1.l20.m1.3.3.cmml" xref="algx1.l20.m1.3.3"><ci id="algx1.l20.m1.3.3.4.cmml" xref="algx1.l20.m1.3.3.4">≔</ci><apply id="algx1.l20.m1.3.3.5.cmml" xref="algx1.l20.m1.3.3.5"><ci id="algx1.l20.m1.3.3.5.1.cmml" xref="algx1.l20.m1.3.3.5.1">^</ci><ci id="algx1.l20.m1.3.3.5.2.cmml" xref="algx1.l20.m1.3.3.5.2">𝐷</ci></apply><apply id="algx1.l20.m1.3.3.3.cmml" xref="algx1.l20.m1.3.3.3"><union id="algx1.l20.m1.3.3.3.4.cmml" xref="algx1.l20.m1.3.3.3.4"></union><apply id="algx1.l20.m1.3.3.3.5.cmml" xref="algx1.l20.m1.3.3.3.5"><ci id="algx1.l20.m1.3.3.3.5.1.cmml" xref="algx1.l20.m1.3.3.3.5.1">^</ci><ci id="algx1.l20.m1.3.3.3.5.2.cmml" xref="algx1.l20.m1.3.3.3.5.2">𝐷</ci></apply><set id="algx1.l20.m1.3.3.3.3.4.cmml" xref="algx1.l20.m1.3.3.3.3.3"><interval closure="open" id="algx1.l20.m1.1.1.1.1.1.1.3.cmml" xref="algx1.l20.m1.1.1.1.1.1.1.2"><apply id="algx1.l20.m1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l20.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l20.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l20.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algx1.l20.m1.1.1.1.1.1.1.1.1.2.cmml" xref="algx1.l20.m1.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="algx1.l20.m1.1.1.1.1.1.1.1.1.3.cmml" xref="algx1.l20.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algx1.l20.m1.1.1.1.1.1.1.2.2.cmml" xref="algx1.l20.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l20.m1.1.1.1.1.1.1.2.2.1.cmml" xref="algx1.l20.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algx1.l20.m1.1.1.1.1.1.1.2.2.2.cmml" xref="algx1.l20.m1.1.1.1.1.1.1.2.2.2">𝜌</ci><cn id="algx1.l20.m1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="algx1.l20.m1.1.1.1.1.1.1.2.2.3">1</cn></apply></interval><interval closure="open" id="algx1.l20.m1.2.2.2.2.2.2.3.cmml" xref="algx1.l20.m1.2.2.2.2.2.2.2"><apply id="algx1.l20.m1.2.2.2.2.2.2.1.1.cmml" xref="algx1.l20.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="algx1.l20.m1.2.2.2.2.2.2.1.1.1.cmml" xref="algx1.l20.m1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="algx1.l20.m1.2.2.2.2.2.2.1.1.2.cmml" xref="algx1.l20.m1.2.2.2.2.2.2.1.1.2">𝑞</ci><ci id="algx1.l20.m1.2.2.2.2.2.2.1.1.3.cmml" xref="algx1.l20.m1.2.2.2.2.2.2.1.1.3">𝑖</ci></apply><apply id="algx1.l20.m1.2.2.2.2.2.2.2.2.cmml" xref="algx1.l20.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algx1.l20.m1.2.2.2.2.2.2.2.2.1.cmml" xref="algx1.l20.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="algx1.l20.m1.2.2.2.2.2.2.2.2.2.cmml" xref="algx1.l20.m1.2.2.2.2.2.2.2.2.2">𝜌</ci><cn id="algx1.l20.m1.2.2.2.2.2.2.2.2.3.cmml" type="integer" xref="algx1.l20.m1.2.2.2.2.2.2.2.2.3">2</cn></apply></interval><interval closure="open" id="algx1.l20.m1.3.3.3.3.3.3.3.cmml" xref="algx1.l20.m1.3.3.3.3.3.3.2"><apply id="algx1.l20.m1.3.3.3.3.3.3.1.1.cmml" xref="algx1.l20.m1.3.3.3.3.3.3.1.1"><csymbol cd="ambiguous" id="algx1.l20.m1.3.3.3.3.3.3.1.1.1.cmml" xref="algx1.l20.m1.3.3.3.3.3.3.1.1">subscript</csymbol><ci id="algx1.l20.m1.3.3.3.3.3.3.1.1.2.cmml" xref="algx1.l20.m1.3.3.3.3.3.3.1.1.2">𝑞</ci><ci id="algx1.l20.m1.3.3.3.3.3.3.1.1.3.cmml" xref="algx1.l20.m1.3.3.3.3.3.3.1.1.3">𝑖</ci></apply><apply id="algx1.l20.m1.3.3.3.3.3.3.2.2.cmml" xref="algx1.l20.m1.3.3.3.3.3.3.2.2"><csymbol cd="ambiguous" id="algx1.l20.m1.3.3.3.3.3.3.2.2.1.cmml" xref="algx1.l20.m1.3.3.3.3.3.3.2.2">subscript</csymbol><ci id="algx1.l20.m1.3.3.3.3.3.3.2.2.2.cmml" xref="algx1.l20.m1.3.3.3.3.3.3.2.2.2">𝜌</ci><cn id="algx1.l20.m1.3.3.3.3.3.3.2.2.3.cmml" type="integer" xref="algx1.l20.m1.3.3.3.3.3.3.2.2.3">3</cn></apply></interval></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l20.m1.3c">\hat{D}\coloneqq\hat{D}\cup\{(q_{i},\rho_{1}),(q_{i},\rho_{2}),(q_{i},\rho_{3})\}</annotation><annotation encoding="application/x-llamapun" id="algx1.l20.m1.3d">over^ start_ARG italic_D end_ARG ≔ over^ start_ARG italic_D end_ARG ∪ { ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_ρ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_ρ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) , ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_ρ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ) }</annotation></semantics></math>
     
</div>
</div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct  2 17:37:48 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
