<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2407.03038] On the Client Preference of LLM Fine-tuning in Federated Learning</title><meta property="og:description" content="Reinforcement learning with human feedback (RLHF) fine-tunes a pretrained large language model (LLM) using preference datasets, enabling the LLM to generate outputs that align with human preferences. Given the sensitiv…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="On the Client Preference of LLM Fine-tuning in Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="On the Client Preference of LLM Fine-tuning in Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2407.03038">

<!--Generated on Mon Aug  5 15:52:43 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">On the Client Preference of LLM Fine-tuning in Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id7.1.id1" class="ltx_text ltx_font_bold">Feijie Wu<sup id="id7.1.id1.1" class="ltx_sup">1</sup></span>,
<span id="id8.2.id2" class="ltx_text ltx_font_bold">Xiaoze Liu<sup id="id8.2.id2.1" class="ltx_sup">1</sup></span>,
<span id="id9.3.id3" class="ltx_text ltx_font_bold">Haoyu Wang<sup id="id9.3.id3.1" class="ltx_sup">1</sup></span>,
<span id="id10.4.id4" class="ltx_text ltx_font_bold">Xingchen Wang<sup id="id10.4.id4.1" class="ltx_sup">1</sup></span>,
<span id="id11.5.id5" class="ltx_text ltx_font_bold">Jing Gao<sup id="id11.5.id5.1" class="ltx_sup">1</sup></span>

<br class="ltx_break">
<br class="ltx_break"><sup id="id12.6.id6" class="ltx_sup">1</sup>Purdue University

<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id6.6" class="ltx_p">Reinforcement learning with human feedback (RLHF) fine-tunes a pretrained large language model (LLM) using preference datasets, enabling the LLM to generate outputs that align with human preferences. Given the sensitive nature of these preference datasets held by various clients, there is a need to implement RLHF within a federated learning (FL) framework, where clients are reluctant to share their data due to privacy concerns. To address this, we introduce a feasible framework in which clients collaboratively train a binary selector with their preference datasets using our proposed <span id="id6.6.1" class="ltx_text ltx_markedasmath">FedBis</span>. With a well-trained selector, we can further enhance the LLM that generates human-preferred completions. Meanwhile, we propose a novel algorithm, <span id="id6.6.2" class="ltx_text ltx_markedasmath">FedBiscuit</span>, that trains multiple selectors by organizing clients into balanced and disjoint clusters based on their preferences. Compared to the <span id="id6.6.3" class="ltx_text ltx_markedasmath">FedBis</span>, <span id="id6.6.4" class="ltx_text ltx_markedasmath">FedBiscuit</span> demonstrates superior performance in simulating human preferences for pairwise completions. Our extensive experiments on federated human preference datasets – marking the first benchmark to address heterogeneous data partitioning among clients – demonstrate that <span id="id6.6.5" class="ltx_text ltx_markedasmath">FedBiscuit</span> outperforms <span id="id6.6.6" class="ltx_text ltx_markedasmath">FedBis</span> and even surpasses traditional centralized training.</p>
</div>
<div id="p1" class="ltx_para ltx_noindent">
<div id="p1.1" class="ltx_block ltx_align_bottom">
<p id="p1.1.1" class="ltx_p"><span id="p1.1.1.1" class="ltx_text ltx_font_bold">On the Client Preference of LLM Fine-tuning in Federated Learning</span></p>
<br class="ltx_break ltx_centering">
<p id="p1.1.2" class="ltx_p ltx_align_center" style="width:433.6pt;"><span id="p1.1.2.1" class="ltx_text ltx_inline-block" style="width:0.0pt;">
<span id="p1.1.2.1.1" class="ltx_tabular ltx_align_top">
<span id="p1.1.2.1.1.1" class="ltx_tr">
<span id="p1.1.2.1.1.1.1" class="ltx_td ltx_align_center"><span id="p1.1.2.1.1.1.1.1" class="ltx_text ltx_font_bold">
Feijie Wu<sup id="p1.1.2.1.1.1.1.1.1" class="ltx_sup">1</sup>,
Xiaoze Liu<sup id="p1.1.2.1.1.1.1.1.2" class="ltx_sup">1</sup>,
Haoyu Wang<sup id="p1.1.2.1.1.1.1.1.3" class="ltx_sup">1</sup>,
Xingchen Wang<sup id="p1.1.2.1.1.1.1.1.4" class="ltx_sup">1</sup>,
Jing Gao<sup id="p1.1.2.1.1.1.1.1.5" class="ltx_sup">1</sup></span></span></span>
<span id="p1.1.2.1.1.2" class="ltx_tr">
<span id="p1.1.2.1.1.2.1" class="ltx_td ltx_align_center"><sup id="p1.1.2.1.1.2.1.1" class="ltx_sup">1</sup>Purdue University</span></span>
</span></span></p>
<br class="ltx_break ltx_centering">
</div>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Large language models (LLMs) have demonstrated remarkable capacities in responding to a wide range of open-ended instructions as professionally as human beings. This achievement is attributed to reinforcement learning with human feedback (RLHF) <cite class="ltx_cite ltx_citemacro_cite">Ziegler et al. (<a href="#bib.bib54" title="" class="ltx_ref">2019</a>); Christiano et al. (<a href="#bib.bib6" title="" class="ltx_ref">2017</a>); Ouyang et al. (<a href="#bib.bib32" title="" class="ltx_ref">2022</a>)</cite>, a method that aligns an LLM with human preferences. Specifically, it trains a reward model (a.k.a. preference model) with the help of a preference dataset, which includes the comparisons among various completions of given instructions. Then, it fine-tunes the LLM towards generating completions that closely match human preference,
evaluated by the reward model.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">While empirical studies have validated the effectiveness of RLHF in enhancing LLM performance, RLHF faces a challenge regarding preference data collection. There are two approaches for constructing preference datasets, namely, human efforts <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a href="#bib.bib4" title="" class="ltx_ref">2022</a>); Ganguli et al. (<a href="#bib.bib15" title="" class="ltx_ref">2022</a>); Stiennon et al. (<a href="#bib.bib37" title="" class="ltx_ref">2020</a>)</cite> and ChatGPT generation <cite class="ltx_cite ltx_citemacro_cite">Dubois et al. (<a href="#bib.bib10" title="" class="ltx_ref">2024</a>)</cite>. The former gathers the preference data from a team of labelers, who rank the completions of each instruction from best to worst. In contrast, the latter entails a set of instructions together with pairwise completions, with ChatGPT <cite class="ltx_cite ltx_citemacro_cite">Achiam et al. (<a href="#bib.bib1" title="" class="ltx_ref">2023</a>)</cite> tasked with selecting the superior completion for each instruction. As LLMs are deployed to serve diverse clients, a preference gap may occur between clients and labelers/ChatGPT, impeding the LLM’s ability to generate responses that satisfy real clients’ tastes. Therefore, there is a demand for a preference dataset that accurately mirrors clients’ preferences in order to facilitate LLM performance.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">One approach to meeting the demand is to collect client preference data and build a huge preference dataset, with which an LLM can be fine-tuned on a central entity (a.k.a. server). It is noticed that this approach has been applied to a recent open project named OASST <cite class="ltx_cite ltx_citemacro_cite">Köpf et al. (<a href="#bib.bib22" title="" class="ltx_ref">2024</a>)</cite>. However, this approach may be infeasible because most clients refuse the disclosure of their preference data out of privacy concerns.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2407.03038/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="150" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An outline of RLHF in federated learning.</figcaption>
</figure>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To this end, we adopt FedAvg, a conventional federated learning (FL) algorithm <cite class="ltx_cite ltx_citemacro_cite">Konečnỳ et al. (<a href="#bib.bib21" title="" class="ltx_ref">2016</a>); McMahan et al. (<a href="#bib.bib30" title="" class="ltx_ref">2017</a>)</cite> that avoids the collection of clients’ raw data. Specifically, each client trains a reward model with their preference data, and the server aggregates the reward models into a global model. While the process seems effective, we observe the following two limitations during training:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p"><span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Excessive Computation Overhead:</span> Conventionally, the reward model is designed to output a scalar value for a given prompt and completion <cite class="ltx_cite ltx_citemacro_cite">Stiennon et al. (<a href="#bib.bib37" title="" class="ltx_ref">2020</a>)</cite>. Its optimization is based on reward differences between preferred and dispreferred completions, i.e., the preferred completions should earn greater rewards than the dispreferred ones. As a result, when the optimization involves a data sample in training the model, it should simultaneously retain two computation graphs in the forward and backward pass, leading to significant computation overhead and intensive GPU requirements.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Degraded Performance:</span> Preference data are heterogeneous among the clients in view that the preferences vary among the clients.
Consequently, each client trains a reward model towards a local minima, deviating from the global optima and resulting in a longer training time to converge when compared to the centralized training. Moreover, the method is likely to suffer from reward hacking, a phenomenon where the reward model heads to a poor performance after several training rounds <cite class="ltx_cite ltx_citemacro_cite">Askell et al. (<a href="#bib.bib2" title="" class="ltx_ref">2021</a>); Michaud et al. (<a href="#bib.bib31" title="" class="ltx_ref">2020</a>); Tien et al. (<a href="#bib.bib41" title="" class="ltx_ref">2022</a>); Skalse et al. (<a href="#bib.bib36" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this paper, we propose to address these two limitations and propose effective and computationally efficient methods for preference collection and subsequent fine-tuning. We start with a solution that addresses the first limitation.
The key idea is to train a binary selector, which chooses a superior response between two completions under a given instruction. Compared with preference ranking, the binary selector requires much less computation during training.
Casting binary selector training into a federated learning setting, we thus propose the
<span id="S1.p5.1.1" class="ltx_text ltx_framed ltx_framed_underline">fed</span>erated <span id="S1.p5.1.2" class="ltx_text ltx_framed ltx_framed_underline">bi</span>nary <span id="S1.p5.1.3" class="ltx_text ltx_framed ltx_framed_underline">s</span>elector training (<span id="S1.p5.1.4" class="ltx_text ltx_markedasmath">FedBis</span>), as depicted in the first stage of Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Each client independently trains the selector with local preference dataset, and the server aggregates the selectors into a global one and broadcasts it to the clients. Afterwards, we utilize the binary selector to enhance the performance of LLM. Specifically, we assume the server holds a set of instructions, together with pairwise responses generated by an LLM. Then, we build a preference dataset with the help of the binary selector and boost the LLM by means of direct preference optimization (DPO) <cite class="ltx_cite ltx_citemacro_cite">Rafailov et al. (<a href="#bib.bib33" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.2" class="ltx_p">To further address the performance deterioration due to preference heterogeneity and reward hacking, we propose a method named <span id="S1.p6.1.1" class="ltx_text ltx_markedasmath ltx_framed ltx_framed_underline">FedBis</span> with <span id="S1.p6.2.2" class="ltx_text ltx_framed ltx_framed_underline">c</span>l<span id="S1.p6.2.3" class="ltx_text ltx_framed ltx_framed_underline">u</span>ster-w<span id="S1.p6.2.4" class="ltx_text ltx_framed ltx_framed_underline">i</span>se aggrega<span id="S1.p6.2.5" class="ltx_text ltx_framed ltx_framed_underline">t</span>ion (<span id="S1.p6.2.6" class="ltx_text ltx_markedasmath">FedBiscuit</span>).
This method ensembles multiple binary selectors, each trained by the clients possessing similar preferences. In light of privacy concerns, which prevent explicit sharing of clients’ data, the server intermittently collects client losses on all binary selectors. Subsequently, clients are organized into disjoint clusters,
and when comparing two completions, the one selected by the majority of binary selectors is deemed better. The proposed method has two main advantages. Firstly, clients with similar preferences jointly train a binary selector, moderating data heterogeneity and mitigating performance deterioration. Secondly, the method alleviates reward hacking by having numerous binary selectors jointly decide on optimal completions.</p>
</div>
<section id="S1.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Contributions.</h5>

<div id="S1.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S1.SS0.SSS0.Px1.p1.1" class="ltx_p">In this paper, our contributions are highlighted as follows:</p>
<ul id="S1.I2" class="ltx_itemize">
<li id="S1.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i1.p1" class="ltx_para">
<p id="S1.I2.i1.p1.2" class="ltx_p">To the best of our knowledge, this is the first feasible framework to achieve RLHF in FL. In detail, the framework trains binary selector(s) with clients’ local datasets, distills the selector(s) toward an LLM, and boosts LLM performance in the meantime. Under this framework, we introduce two methods, i.e., <span id="S1.I2.i1.p1.2.1" class="ltx_text ltx_markedasmath">FedBis</span> and <span id="S1.I2.i1.p1.2.2" class="ltx_text ltx_markedasmath">FedBiscuit</span>.</p>
</div>
</li>
<li id="S1.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i2.p1" class="ltx_para">
<p id="S1.I2.i2.p1.1" class="ltx_p">Previous works offer a number of human preference datasets, but none of them address the FL setting. This is the first work to discuss the possible data partition approaches to build a heterogeneous human preference dataset. To this end, we introduce a benchmark that includes several human preference datasets suitable for FL.</p>
</div>
</li>
<li id="S1.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i3.p1" class="ltx_para">
<p id="S1.I2.i3.p1.4" class="ltx_p">We conduct extensive experiments to demonstrate the performance of the proposed <span id="S1.I2.i3.p1.4.1" class="ltx_text ltx_markedasmath">FedBis</span> and <span id="S1.I2.i3.p1.4.2" class="ltx_text ltx_markedasmath">FedBiscuit</span>. As expected, <span id="S1.I2.i3.p1.4.3" class="ltx_text ltx_markedasmath">FedBiscuit</span> demonstrates superior performance over <span id="S1.I2.i3.p1.4.4" class="ltx_text ltx_markedasmath">FedBis</span> and even surpasses traditional centralized training. Meanwhile, we present some insights from the empirical studies.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">LLM Fine-tuning in FL.</h5>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">Recent studies have increasingly focused on fine-tuning large language models (LLMs) using federated datasets <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a href="#bib.bib39" title="" class="ltx_ref">2024</a>); Ye et al. (<a href="#bib.bib49" title="" class="ltx_ref">2024</a>); Zhang et al. (<a href="#bib.bib51" title="" class="ltx_ref">2023a</a>); Yi et al. (<a href="#bib.bib50" title="" class="ltx_ref">2023</a>); Zhang et al. (<a href="#bib.bib52" title="" class="ltx_ref">2023b</a>)</cite>. However, these approaches often suffer from high computation and communication costs due to the necessity of training and synchronizing the model with clients. To mitigate these issues, lightweight methods such as black-box fine-tuning <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a href="#bib.bib38" title="" class="ltx_ref">2023</a>); Lin et al. (<a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite> and offsite-tuning <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a href="#bib.bib46" title="" class="ltx_ref">2024</a>); Kuang et al. (<a href="#bib.bib23" title="" class="ltx_ref">2023</a>)</cite> have emerged. Despite their advancements, these methods primarily focus on fine-tuning LLMs for specific downstream tasks, neglecting user preferences in the generated responses. To address this gap, our work aims to align LLMs with human preferences and introduces a feasible training framework in federated learning.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Reinforcement Learning with Human Feedback (RLHF).</h5>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">RLHF typically involves supervised fine-tuning, reward modeling, and reward optimization, initially popularized by <cite class="ltx_cite ltx_citemacro_citet">Christiano et al. (<a href="#bib.bib6" title="" class="ltx_ref">2017</a>)</cite>. Proximal Policy Optimization (PPO) <cite class="ltx_cite ltx_citemacro_cite">Schulman et al. (<a href="#bib.bib35" title="" class="ltx_ref">2017</a>)</cite> is a common RLHF algorithm, yet it struggles with instability, inefficiency, and high resource demands <cite class="ltx_cite ltx_citemacro_cite">Choshen et al. (<a href="#bib.bib5" title="" class="ltx_ref">2019</a>); Engstrom et al. (<a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite>. These challenges have led to the development of alternative methods, such as Direct Preference Optimization (DPO) <cite class="ltx_cite ltx_citemacro_cite">Rafailov et al. (<a href="#bib.bib33" title="" class="ltx_ref">2023</a>)</cite> and others <cite class="ltx_cite ltx_citemacro_cite">Dong et al. (<a href="#bib.bib9" title="" class="ltx_ref">2023</a>); Zhao et al. (<a href="#bib.bib53" title="" class="ltx_ref">2023</a>); Azar et al. (<a href="#bib.bib3" title="" class="ltx_ref">2024</a>); Ethayarajh et al. (<a href="#bib.bib14" title="" class="ltx_ref">2024</a>); Gulcehre et al. (<a href="#bib.bib18" title="" class="ltx_ref">2023</a>)</cite>, which offer more stable and efficient solutions. However, these methods typically operate within a centralized training framework, where the LLM owner retains control over the preference data. In contrast, our work seeks to expand data sources and incorporate real user preferences during the fine-tuning of the LLM.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span id="S3.2.1" class="ltx_text ltx_markedasmath">FedBis</span>: A Feasible Framework for Achieving RLHF in FL</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.2" class="ltx_p">The objective of RLHF is to align a pretrained language model with human preferences. RLHF comprises two phases: (i) preference modeling and (ii) reinforcement-learning fine-tuning. The first phase aims to develop a model that simulates human preferences to select the superior options from numerous pairwise completions. Subsequently, the second phase enhances the language model’s performance by creating a preference dataset, enabling the model to generate responses preferred by humans. In the following, We describe the proposed <span id="S3.p1.2.1" class="ltx_text ltx_markedasmath">FedBis</span> that achieves RLHF in FL in the first two subsections, followed by a brief discussion of its limitations that motivate the proposed <span id="S3.p1.2.2" class="ltx_text ltx_markedasmath">FedBiscuit</span> presented in Section <a href="#S4" title="4 FedBiscuit: FedBis with Cluster-wise Aggregation ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Preference Modeling</h3>

<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Problem Formulation.</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.4" class="ltx_p">In preference modeling, our objective is to train a binary selector using data from multiple clients. Consider an FL system with <math id="S3.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.SSS1.p1.1.m1.1a"><mi id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.1b"><ci id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.1c">M</annotation></semantics></math> clients, coordinated by a central server. Denote the weight of client <math id="S3.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><mi id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><ci id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">m</annotation></semantics></math> as <math id="S3.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="p_{m}" display="inline"><semantics id="S3.SS1.SSS1.p1.3.m3.1a"><msub id="S3.SS1.SSS1.p1.3.m3.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.1.1.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml">p</mi><mi id="S3.SS1.SSS1.p1.3.m3.1.1.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m3.1b"><apply id="S3.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.2">𝑝</ci><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m3.1c">p_{m}</annotation></semantics></math> such that <math id="S3.SS1.SSS1.p1.4.m4.1" class="ltx_Math" alttext="\sum_{m\in[M]}p_{m}=1" display="inline"><semantics id="S3.SS1.SSS1.p1.4.m4.1a"><mrow id="S3.SS1.SSS1.p1.4.m4.1.2" xref="S3.SS1.SSS1.p1.4.m4.1.2.cmml"><mrow id="S3.SS1.SSS1.p1.4.m4.1.2.2" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.cmml"><msub id="S3.SS1.SSS1.p1.4.m4.1.2.2.1" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.1.cmml"><mo id="S3.SS1.SSS1.p1.4.m4.1.2.2.1.2" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.1.2.cmml">∑</mo><mrow id="S3.SS1.SSS1.p1.4.m4.1.1.1" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.4.m4.1.1.1.3" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.3.cmml">m</mi><mo id="S3.SS1.SSS1.p1.4.m4.1.1.1.2" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.2.cmml">∈</mo><mrow id="S3.SS1.SSS1.p1.4.m4.1.1.1.4.2" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.4.m4.1.1.1.4.2.1" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.4.1.1.cmml">[</mo><mi id="S3.SS1.SSS1.p1.4.m4.1.1.1.1" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.1.cmml">M</mi><mo stretchy="false" id="S3.SS1.SSS1.p1.4.m4.1.1.1.4.2.2" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><msub id="S3.SS1.SSS1.p1.4.m4.1.2.2.2" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.4.m4.1.2.2.2.2" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.2.2.cmml">p</mi><mi id="S3.SS1.SSS1.p1.4.m4.1.2.2.2.3" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.2.3.cmml">m</mi></msub></mrow><mo id="S3.SS1.SSS1.p1.4.m4.1.2.1" xref="S3.SS1.SSS1.p1.4.m4.1.2.1.cmml">=</mo><mn id="S3.SS1.SSS1.p1.4.m4.1.2.3" xref="S3.SS1.SSS1.p1.4.m4.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.4.m4.1b"><apply id="S3.SS1.SSS1.p1.4.m4.1.2.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.2"><eq id="S3.SS1.SSS1.p1.4.m4.1.2.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.2.1"></eq><apply id="S3.SS1.SSS1.p1.4.m4.1.2.2.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.2.2"><apply id="S3.SS1.SSS1.p1.4.m4.1.2.2.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.4.m4.1.2.2.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.1">subscript</csymbol><sum id="S3.SS1.SSS1.p1.4.m4.1.2.2.1.2.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.1.2"></sum><apply id="S3.SS1.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.1"><in id="S3.SS1.SSS1.p1.4.m4.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.2"></in><ci id="S3.SS1.SSS1.p1.4.m4.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.3">𝑚</ci><apply id="S3.SS1.SSS1.p1.4.m4.1.1.1.4.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.4.2"><csymbol cd="latexml" id="S3.SS1.SSS1.p1.4.m4.1.1.1.4.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.SS1.SSS1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.1">𝑀</ci></apply></apply></apply><apply id="S3.SS1.SSS1.p1.4.m4.1.2.2.2.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.4.m4.1.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.4.m4.1.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.2.2">𝑝</ci><ci id="S3.SS1.SSS1.p1.4.m4.1.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.2.2.2.3">𝑚</ci></apply></apply><cn type="integer" id="S3.SS1.SSS1.p1.4.m4.1.2.3.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.4.m4.1c">\sum_{m\in[M]}p_{m}=1</annotation></semantics></math>, and we aim to optimize the following objectives:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.5" class="ltx_Math" alttext="\min_{\phi\in\mathbb{R}^{d}}\quad F(\mathbf{\phi})\overset{\triangle}{=}\sum_{m\in[M]}p_{m}F_{m}(\mathbf{\phi})" display="block"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.2" xref="S3.E1.m1.5.5.3.cmml"><munder id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml">min</mi><mrow id="S3.E1.m1.4.4.1.1.3" xref="S3.E1.m1.4.4.1.1.3.cmml"><mi id="S3.E1.m1.4.4.1.1.3.2" xref="S3.E1.m1.4.4.1.1.3.2.cmml">ϕ</mi><mo id="S3.E1.m1.4.4.1.1.3.1" xref="S3.E1.m1.4.4.1.1.3.1.cmml">∈</mo><msup id="S3.E1.m1.4.4.1.1.3.3" xref="S3.E1.m1.4.4.1.1.3.3.cmml"><mi id="S3.E1.m1.4.4.1.1.3.3.2" xref="S3.E1.m1.4.4.1.1.3.3.2.cmml">ℝ</mi><mi id="S3.E1.m1.4.4.1.1.3.3.3" xref="S3.E1.m1.4.4.1.1.3.3.3.cmml">d</mi></msup></mrow></munder><mspace width="1.167em" id="S3.E1.m1.5.5.2.3" xref="S3.E1.m1.5.5.3.cmml"></mspace><mrow id="S3.E1.m1.5.5.2.2" xref="S3.E1.m1.5.5.2.2.cmml"><mi id="S3.E1.m1.5.5.2.2.2" xref="S3.E1.m1.5.5.2.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.2.2.1" xref="S3.E1.m1.5.5.2.2.1.cmml">​</mo><mrow id="S3.E1.m1.5.5.2.2.3.2" xref="S3.E1.m1.5.5.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.2.2.3.2.1" xref="S3.E1.m1.5.5.2.2.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">ϕ</mi><mo stretchy="false" id="S3.E1.m1.5.5.2.2.3.2.2" xref="S3.E1.m1.5.5.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.2.2.1a" xref="S3.E1.m1.5.5.2.2.1.cmml">​</mo><mover accent="true" id="S3.E1.m1.5.5.2.2.4" xref="S3.E1.m1.5.5.2.2.4.cmml"><mo id="S3.E1.m1.5.5.2.2.4.2" xref="S3.E1.m1.5.5.2.2.4.2.cmml">=</mo><mo id="S3.E1.m1.5.5.2.2.4.1" xref="S3.E1.m1.5.5.2.2.4.1.cmml">△</mo></mover><mo lspace="0.278em" rspace="0em" id="S3.E1.m1.5.5.2.2.1b" xref="S3.E1.m1.5.5.2.2.1.cmml">​</mo><mrow id="S3.E1.m1.5.5.2.2.5" xref="S3.E1.m1.5.5.2.2.5.cmml"><munder id="S3.E1.m1.5.5.2.2.5.1" xref="S3.E1.m1.5.5.2.2.5.1.cmml"><mo movablelimits="false" id="S3.E1.m1.5.5.2.2.5.1.2" xref="S3.E1.m1.5.5.2.2.5.1.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml">m</mi><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">∈</mo><mrow id="S3.E1.m1.1.1.1.4.2" xref="S3.E1.m1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.4.2.1" xref="S3.E1.m1.1.1.1.4.1.1.cmml">[</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">M</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.4.2.2" xref="S3.E1.m1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></munder><mrow id="S3.E1.m1.5.5.2.2.5.2" xref="S3.E1.m1.5.5.2.2.5.2.cmml"><msub id="S3.E1.m1.5.5.2.2.5.2.2" xref="S3.E1.m1.5.5.2.2.5.2.2.cmml"><mi id="S3.E1.m1.5.5.2.2.5.2.2.2" xref="S3.E1.m1.5.5.2.2.5.2.2.2.cmml">p</mi><mi id="S3.E1.m1.5.5.2.2.5.2.2.3" xref="S3.E1.m1.5.5.2.2.5.2.2.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.2.2.5.2.1" xref="S3.E1.m1.5.5.2.2.5.2.1.cmml">​</mo><msub id="S3.E1.m1.5.5.2.2.5.2.3" xref="S3.E1.m1.5.5.2.2.5.2.3.cmml"><mi id="S3.E1.m1.5.5.2.2.5.2.3.2" xref="S3.E1.m1.5.5.2.2.5.2.3.2.cmml">F</mi><mi id="S3.E1.m1.5.5.2.2.5.2.3.3" xref="S3.E1.m1.5.5.2.2.5.2.3.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.2.2.5.2.1a" xref="S3.E1.m1.5.5.2.2.5.2.1.cmml">​</mo><mrow id="S3.E1.m1.5.5.2.2.5.2.4.2" xref="S3.E1.m1.5.5.2.2.5.2.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.2.2.5.2.4.2.1" xref="S3.E1.m1.5.5.2.2.5.2.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">ϕ</mi><mo stretchy="false" id="S3.E1.m1.5.5.2.2.5.2.4.2.2" xref="S3.E1.m1.5.5.2.2.5.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><list id="S3.E1.m1.5.5.3.cmml" xref="S3.E1.m1.5.5.2"><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1">subscript</csymbol><min id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2"></min><apply id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3"><in id="S3.E1.m1.4.4.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1"></in><ci id="S3.E1.m1.4.4.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2">italic-ϕ</ci><apply id="S3.E1.m1.4.4.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.3.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2">ℝ</ci><ci id="S3.E1.m1.4.4.1.1.3.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3">𝑑</ci></apply></apply></apply><apply id="S3.E1.m1.5.5.2.2.cmml" xref="S3.E1.m1.5.5.2.2"><times id="S3.E1.m1.5.5.2.2.1.cmml" xref="S3.E1.m1.5.5.2.2.1"></times><ci id="S3.E1.m1.5.5.2.2.2.cmml" xref="S3.E1.m1.5.5.2.2.2">𝐹</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">italic-ϕ</ci><apply id="S3.E1.m1.5.5.2.2.4.cmml" xref="S3.E1.m1.5.5.2.2.4"><ci id="S3.E1.m1.5.5.2.2.4.1.cmml" xref="S3.E1.m1.5.5.2.2.4.1">△</ci><eq id="S3.E1.m1.5.5.2.2.4.2.cmml" xref="S3.E1.m1.5.5.2.2.4.2"></eq></apply><apply id="S3.E1.m1.5.5.2.2.5.cmml" xref="S3.E1.m1.5.5.2.2.5"><apply id="S3.E1.m1.5.5.2.2.5.1.cmml" xref="S3.E1.m1.5.5.2.2.5.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.2.2.5.1.1.cmml" xref="S3.E1.m1.5.5.2.2.5.1">subscript</csymbol><sum id="S3.E1.m1.5.5.2.2.5.1.2.cmml" xref="S3.E1.m1.5.5.2.2.5.1.2"></sum><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><in id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></in><ci id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3">𝑚</ci><apply id="S3.E1.m1.1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.1.4.2"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.4.1.1.cmml" xref="S3.E1.m1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑀</ci></apply></apply></apply><apply id="S3.E1.m1.5.5.2.2.5.2.cmml" xref="S3.E1.m1.5.5.2.2.5.2"><times id="S3.E1.m1.5.5.2.2.5.2.1.cmml" xref="S3.E1.m1.5.5.2.2.5.2.1"></times><apply id="S3.E1.m1.5.5.2.2.5.2.2.cmml" xref="S3.E1.m1.5.5.2.2.5.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.2.2.5.2.2.1.cmml" xref="S3.E1.m1.5.5.2.2.5.2.2">subscript</csymbol><ci id="S3.E1.m1.5.5.2.2.5.2.2.2.cmml" xref="S3.E1.m1.5.5.2.2.5.2.2.2">𝑝</ci><ci id="S3.E1.m1.5.5.2.2.5.2.2.3.cmml" xref="S3.E1.m1.5.5.2.2.5.2.2.3">𝑚</ci></apply><apply id="S3.E1.m1.5.5.2.2.5.2.3.cmml" xref="S3.E1.m1.5.5.2.2.5.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.2.2.5.2.3.1.cmml" xref="S3.E1.m1.5.5.2.2.5.2.3">subscript</csymbol><ci id="S3.E1.m1.5.5.2.2.5.2.3.2.cmml" xref="S3.E1.m1.5.5.2.2.5.2.3.2">𝐹</ci><ci id="S3.E1.m1.5.5.2.2.5.2.3.3.cmml" xref="S3.E1.m1.5.5.2.2.5.2.3.3">𝑚</ci></apply><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">italic-ϕ</ci></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\min_{\phi\in\mathbb{R}^{d}}\quad F(\mathbf{\phi})\overset{\triangle}{=}\sum_{m\in[M]}p_{m}F_{m}(\mathbf{\phi})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p1.17" class="ltx_p">where <math id="S3.SS1.SSS1.p1.5.m1.1" class="ltx_Math" alttext="F_{m}(\phi)" display="inline"><semantics id="S3.SS1.SSS1.p1.5.m1.1a"><mrow id="S3.SS1.SSS1.p1.5.m1.1.2" xref="S3.SS1.SSS1.p1.5.m1.1.2.cmml"><msub id="S3.SS1.SSS1.p1.5.m1.1.2.2" xref="S3.SS1.SSS1.p1.5.m1.1.2.2.cmml"><mi id="S3.SS1.SSS1.p1.5.m1.1.2.2.2" xref="S3.SS1.SSS1.p1.5.m1.1.2.2.2.cmml">F</mi><mi id="S3.SS1.SSS1.p1.5.m1.1.2.2.3" xref="S3.SS1.SSS1.p1.5.m1.1.2.2.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.5.m1.1.2.1" xref="S3.SS1.SSS1.p1.5.m1.1.2.1.cmml">​</mo><mrow id="S3.SS1.SSS1.p1.5.m1.1.2.3.2" xref="S3.SS1.SSS1.p1.5.m1.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.5.m1.1.2.3.2.1" xref="S3.SS1.SSS1.p1.5.m1.1.2.cmml">(</mo><mi id="S3.SS1.SSS1.p1.5.m1.1.1" xref="S3.SS1.SSS1.p1.5.m1.1.1.cmml">ϕ</mi><mo stretchy="false" id="S3.SS1.SSS1.p1.5.m1.1.2.3.2.2" xref="S3.SS1.SSS1.p1.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.5.m1.1b"><apply id="S3.SS1.SSS1.p1.5.m1.1.2.cmml" xref="S3.SS1.SSS1.p1.5.m1.1.2"><times id="S3.SS1.SSS1.p1.5.m1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.5.m1.1.2.1"></times><apply id="S3.SS1.SSS1.p1.5.m1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.5.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.5.m1.1.2.2.1.cmml" xref="S3.SS1.SSS1.p1.5.m1.1.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.5.m1.1.2.2.2.cmml" xref="S3.SS1.SSS1.p1.5.m1.1.2.2.2">𝐹</ci><ci id="S3.SS1.SSS1.p1.5.m1.1.2.2.3.cmml" xref="S3.SS1.SSS1.p1.5.m1.1.2.2.3">𝑚</ci></apply><ci id="S3.SS1.SSS1.p1.5.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m1.1.1">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.5.m1.1c">F_{m}(\phi)</annotation></semantics></math> is the expected loss on client <math id="S3.SS1.SSS1.p1.6.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.SSS1.p1.6.m2.1a"><mi id="S3.SS1.SSS1.p1.6.m2.1.1" xref="S3.SS1.SSS1.p1.6.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.6.m2.1b"><ci id="S3.SS1.SSS1.p1.6.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.6.m2.1c">m</annotation></semantics></math> given the binary selector <math id="S3.SS1.SSS1.p1.7.m3.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS1.SSS1.p1.7.m3.1a"><mi id="S3.SS1.SSS1.p1.7.m3.1.1" xref="S3.SS1.SSS1.p1.7.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.7.m3.1b"><ci id="S3.SS1.SSS1.p1.7.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.7.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.7.m3.1c">\phi</annotation></semantics></math>. Suppose client <math id="S3.SS1.SSS1.p1.8.m4.1" class="ltx_Math" alttext="m\in[M]" display="inline"><semantics id="S3.SS1.SSS1.p1.8.m4.1a"><mrow id="S3.SS1.SSS1.p1.8.m4.1.2" xref="S3.SS1.SSS1.p1.8.m4.1.2.cmml"><mi id="S3.SS1.SSS1.p1.8.m4.1.2.2" xref="S3.SS1.SSS1.p1.8.m4.1.2.2.cmml">m</mi><mo id="S3.SS1.SSS1.p1.8.m4.1.2.1" xref="S3.SS1.SSS1.p1.8.m4.1.2.1.cmml">∈</mo><mrow id="S3.SS1.SSS1.p1.8.m4.1.2.3.2" xref="S3.SS1.SSS1.p1.8.m4.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.8.m4.1.2.3.2.1" xref="S3.SS1.SSS1.p1.8.m4.1.2.3.1.1.cmml">[</mo><mi id="S3.SS1.SSS1.p1.8.m4.1.1" xref="S3.SS1.SSS1.p1.8.m4.1.1.cmml">M</mi><mo stretchy="false" id="S3.SS1.SSS1.p1.8.m4.1.2.3.2.2" xref="S3.SS1.SSS1.p1.8.m4.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.8.m4.1b"><apply id="S3.SS1.SSS1.p1.8.m4.1.2.cmml" xref="S3.SS1.SSS1.p1.8.m4.1.2"><in id="S3.SS1.SSS1.p1.8.m4.1.2.1.cmml" xref="S3.SS1.SSS1.p1.8.m4.1.2.1"></in><ci id="S3.SS1.SSS1.p1.8.m4.1.2.2.cmml" xref="S3.SS1.SSS1.p1.8.m4.1.2.2">𝑚</ci><apply id="S3.SS1.SSS1.p1.8.m4.1.2.3.1.cmml" xref="S3.SS1.SSS1.p1.8.m4.1.2.3.2"><csymbol cd="latexml" id="S3.SS1.SSS1.p1.8.m4.1.2.3.1.1.cmml" xref="S3.SS1.SSS1.p1.8.m4.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS1.SSS1.p1.8.m4.1.1.cmml" xref="S3.SS1.SSS1.p1.8.m4.1.1">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.8.m4.1c">m\in[M]</annotation></semantics></math> holds a set of pairwise data with the size of <math id="S3.SS1.SSS1.p1.9.m5.1" class="ltx_Math" alttext="n_{m}" display="inline"><semantics id="S3.SS1.SSS1.p1.9.m5.1a"><msub id="S3.SS1.SSS1.p1.9.m5.1.1" xref="S3.SS1.SSS1.p1.9.m5.1.1.cmml"><mi id="S3.SS1.SSS1.p1.9.m5.1.1.2" xref="S3.SS1.SSS1.p1.9.m5.1.1.2.cmml">n</mi><mi id="S3.SS1.SSS1.p1.9.m5.1.1.3" xref="S3.SS1.SSS1.p1.9.m5.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.9.m5.1b"><apply id="S3.SS1.SSS1.p1.9.m5.1.1.cmml" xref="S3.SS1.SSS1.p1.9.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.9.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p1.9.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.9.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p1.9.m5.1.1.2">𝑛</ci><ci id="S3.SS1.SSS1.p1.9.m5.1.1.3.cmml" xref="S3.SS1.SSS1.p1.9.m5.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.9.m5.1c">n_{m}</annotation></semantics></math>, i.e., <math id="S3.SS1.SSS1.p1.10.m6.6" class="ltx_Math" alttext="\hat{\mathcal{D}}_{m}=\{(x_{i},y_{i,w},y_{i,l})\}_{i\in[n_{m}]}" display="inline"><semantics id="S3.SS1.SSS1.p1.10.m6.6a"><mrow id="S3.SS1.SSS1.p1.10.m6.6.6" xref="S3.SS1.SSS1.p1.10.m6.6.6.cmml"><msub id="S3.SS1.SSS1.p1.10.m6.6.6.3" xref="S3.SS1.SSS1.p1.10.m6.6.6.3.cmml"><mover accent="true" id="S3.SS1.SSS1.p1.10.m6.6.6.3.2" xref="S3.SS1.SSS1.p1.10.m6.6.6.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.10.m6.6.6.3.2.2" xref="S3.SS1.SSS1.p1.10.m6.6.6.3.2.2.cmml">𝒟</mi><mo id="S3.SS1.SSS1.p1.10.m6.6.6.3.2.1" xref="S3.SS1.SSS1.p1.10.m6.6.6.3.2.1.cmml">^</mo></mover><mi id="S3.SS1.SSS1.p1.10.m6.6.6.3.3" xref="S3.SS1.SSS1.p1.10.m6.6.6.3.3.cmml">m</mi></msub><mo id="S3.SS1.SSS1.p1.10.m6.6.6.2" xref="S3.SS1.SSS1.p1.10.m6.6.6.2.cmml">=</mo><msub id="S3.SS1.SSS1.p1.10.m6.6.6.1" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.cmml"><mrow id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.2" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.2.cmml">{</mo><mrow id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.4.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.4" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.4.cmml">(</mo><msub id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1.2" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1.3" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.5" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.4.cmml">,</mo><msub id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.2.2" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.2.2.cmml"><mi id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.2.2.2" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.2.2.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p1.10.m6.2.2.2.4" xref="S3.SS1.SSS1.p1.10.m6.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.p1.10.m6.1.1.1.1" xref="S3.SS1.SSS1.p1.10.m6.1.1.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.10.m6.2.2.2.4.1" xref="S3.SS1.SSS1.p1.10.m6.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.10.m6.2.2.2.2" xref="S3.SS1.SSS1.p1.10.m6.2.2.2.2.cmml">w</mi></mrow></msub><mo id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.6" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.4.cmml">,</mo><msub id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.3" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.3.cmml"><mi id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.3.2" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.3.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p1.10.m6.4.4.2.4" xref="S3.SS1.SSS1.p1.10.m6.4.4.2.3.cmml"><mi id="S3.SS1.SSS1.p1.10.m6.3.3.1.1" xref="S3.SS1.SSS1.p1.10.m6.3.3.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.10.m6.4.4.2.4.1" xref="S3.SS1.SSS1.p1.10.m6.4.4.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.10.m6.4.4.2.2" xref="S3.SS1.SSS1.p1.10.m6.4.4.2.2.cmml">l</mi></mrow></msub><mo stretchy="false" id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.7" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.4.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.3" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.SSS1.p1.10.m6.5.5.1" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.cmml"><mi id="S3.SS1.SSS1.p1.10.m6.5.5.1.3" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.3.cmml">i</mi><mo id="S3.SS1.SSS1.p1.10.m6.5.5.1.2" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.2.cmml">∈</mo><mrow id="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.2" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.1.2.1.cmml">[</mo><msub id="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1.2" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1.2.cmml">n</mi><mi id="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1.3" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.3" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.10.m6.6b"><apply id="S3.SS1.SSS1.p1.10.m6.6.6.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6"><eq id="S3.SS1.SSS1.p1.10.m6.6.6.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.2"></eq><apply id="S3.SS1.SSS1.p1.10.m6.6.6.3.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.10.m6.6.6.3.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.3">subscript</csymbol><apply id="S3.SS1.SSS1.p1.10.m6.6.6.3.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.3.2"><ci id="S3.SS1.SSS1.p1.10.m6.6.6.3.2.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.3.2.1">^</ci><ci id="S3.SS1.SSS1.p1.10.m6.6.6.3.2.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.3.2.2">𝒟</ci></apply><ci id="S3.SS1.SSS1.p1.10.m6.6.6.3.3.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.3.3">𝑚</ci></apply><apply id="S3.SS1.SSS1.p1.10.m6.6.6.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.10.m6.6.6.1.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1">subscript</csymbol><set id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1"><vector id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.4.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3"><apply id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.2.2.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.2.2.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.2.2.2">𝑦</ci><list id="S3.SS1.SSS1.p1.10.m6.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.10.m6.2.2.2.4"><ci id="S3.SS1.SSS1.p1.10.m6.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.1.1.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.10.m6.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.2.2.2.2">𝑤</ci></list></apply><apply id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.3.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.3.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.6.6.1.1.1.1.3.3.2">𝑦</ci><list id="S3.SS1.SSS1.p1.10.m6.4.4.2.3.cmml" xref="S3.SS1.SSS1.p1.10.m6.4.4.2.4"><ci id="S3.SS1.SSS1.p1.10.m6.3.3.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.3.3.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.10.m6.4.4.2.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.4.4.2.2">𝑙</ci></list></apply></vector></set><apply id="S3.SS1.SSS1.p1.10.m6.5.5.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.5.5.1"><in id="S3.SS1.SSS1.p1.10.m6.5.5.1.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.2"></in><ci id="S3.SS1.SSS1.p1.10.m6.5.5.1.3.cmml" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.3">𝑖</ci><apply id="S3.SS1.SSS1.p1.10.m6.5.5.1.1.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS1.p1.10.m6.5.5.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1.2">𝑛</ci><ci id="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.10.m6.5.5.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.10.m6.6c">\hat{\mathcal{D}}_{m}=\{(x_{i},y_{i,w},y_{i,l})\}_{i\in[n_{m}]}</annotation></semantics></math>, where <math id="S3.SS1.SSS1.p1.11.m7.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S3.SS1.SSS1.p1.11.m7.1a"><msub id="S3.SS1.SSS1.p1.11.m7.1.1" xref="S3.SS1.SSS1.p1.11.m7.1.1.cmml"><mi id="S3.SS1.SSS1.p1.11.m7.1.1.2" xref="S3.SS1.SSS1.p1.11.m7.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS1.p1.11.m7.1.1.3" xref="S3.SS1.SSS1.p1.11.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.11.m7.1b"><apply id="S3.SS1.SSS1.p1.11.m7.1.1.cmml" xref="S3.SS1.SSS1.p1.11.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.11.m7.1.1.1.cmml" xref="S3.SS1.SSS1.p1.11.m7.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.11.m7.1.1.2.cmml" xref="S3.SS1.SSS1.p1.11.m7.1.1.2">𝑥</ci><ci id="S3.SS1.SSS1.p1.11.m7.1.1.3.cmml" xref="S3.SS1.SSS1.p1.11.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.11.m7.1c">x_{i}</annotation></semantics></math> is the prompt, <math id="S3.SS1.SSS1.p1.12.m8.2" class="ltx_Math" alttext="y_{i,w}" display="inline"><semantics id="S3.SS1.SSS1.p1.12.m8.2a"><msub id="S3.SS1.SSS1.p1.12.m8.2.3" xref="S3.SS1.SSS1.p1.12.m8.2.3.cmml"><mi id="S3.SS1.SSS1.p1.12.m8.2.3.2" xref="S3.SS1.SSS1.p1.12.m8.2.3.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p1.12.m8.2.2.2.4" xref="S3.SS1.SSS1.p1.12.m8.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.p1.12.m8.1.1.1.1" xref="S3.SS1.SSS1.p1.12.m8.1.1.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.12.m8.2.2.2.4.1" xref="S3.SS1.SSS1.p1.12.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.12.m8.2.2.2.2" xref="S3.SS1.SSS1.p1.12.m8.2.2.2.2.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.12.m8.2b"><apply id="S3.SS1.SSS1.p1.12.m8.2.3.cmml" xref="S3.SS1.SSS1.p1.12.m8.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.12.m8.2.3.1.cmml" xref="S3.SS1.SSS1.p1.12.m8.2.3">subscript</csymbol><ci id="S3.SS1.SSS1.p1.12.m8.2.3.2.cmml" xref="S3.SS1.SSS1.p1.12.m8.2.3.2">𝑦</ci><list id="S3.SS1.SSS1.p1.12.m8.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.12.m8.2.2.2.4"><ci id="S3.SS1.SSS1.p1.12.m8.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.12.m8.1.1.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.12.m8.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.12.m8.2.2.2.2">𝑤</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.12.m8.2c">y_{i,w}</annotation></semantics></math> is the preferred completion out of the pair of <math id="S3.SS1.SSS1.p1.13.m9.2" class="ltx_Math" alttext="y_{i,w}" display="inline"><semantics id="S3.SS1.SSS1.p1.13.m9.2a"><msub id="S3.SS1.SSS1.p1.13.m9.2.3" xref="S3.SS1.SSS1.p1.13.m9.2.3.cmml"><mi id="S3.SS1.SSS1.p1.13.m9.2.3.2" xref="S3.SS1.SSS1.p1.13.m9.2.3.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p1.13.m9.2.2.2.4" xref="S3.SS1.SSS1.p1.13.m9.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.p1.13.m9.1.1.1.1" xref="S3.SS1.SSS1.p1.13.m9.1.1.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.13.m9.2.2.2.4.1" xref="S3.SS1.SSS1.p1.13.m9.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.13.m9.2.2.2.2" xref="S3.SS1.SSS1.p1.13.m9.2.2.2.2.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.13.m9.2b"><apply id="S3.SS1.SSS1.p1.13.m9.2.3.cmml" xref="S3.SS1.SSS1.p1.13.m9.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.13.m9.2.3.1.cmml" xref="S3.SS1.SSS1.p1.13.m9.2.3">subscript</csymbol><ci id="S3.SS1.SSS1.p1.13.m9.2.3.2.cmml" xref="S3.SS1.SSS1.p1.13.m9.2.3.2">𝑦</ci><list id="S3.SS1.SSS1.p1.13.m9.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.13.m9.2.2.2.4"><ci id="S3.SS1.SSS1.p1.13.m9.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.13.m9.1.1.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.13.m9.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.13.m9.2.2.2.2">𝑤</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.13.m9.2c">y_{i,w}</annotation></semantics></math> and <math id="S3.SS1.SSS1.p1.14.m10.2" class="ltx_Math" alttext="y_{i,l}" display="inline"><semantics id="S3.SS1.SSS1.p1.14.m10.2a"><msub id="S3.SS1.SSS1.p1.14.m10.2.3" xref="S3.SS1.SSS1.p1.14.m10.2.3.cmml"><mi id="S3.SS1.SSS1.p1.14.m10.2.3.2" xref="S3.SS1.SSS1.p1.14.m10.2.3.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p1.14.m10.2.2.2.4" xref="S3.SS1.SSS1.p1.14.m10.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.p1.14.m10.1.1.1.1" xref="S3.SS1.SSS1.p1.14.m10.1.1.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.14.m10.2.2.2.4.1" xref="S3.SS1.SSS1.p1.14.m10.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.14.m10.2.2.2.2" xref="S3.SS1.SSS1.p1.14.m10.2.2.2.2.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.14.m10.2b"><apply id="S3.SS1.SSS1.p1.14.m10.2.3.cmml" xref="S3.SS1.SSS1.p1.14.m10.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.14.m10.2.3.1.cmml" xref="S3.SS1.SSS1.p1.14.m10.2.3">subscript</csymbol><ci id="S3.SS1.SSS1.p1.14.m10.2.3.2.cmml" xref="S3.SS1.SSS1.p1.14.m10.2.3.2">𝑦</ci><list id="S3.SS1.SSS1.p1.14.m10.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.14.m10.2.2.2.4"><ci id="S3.SS1.SSS1.p1.14.m10.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.14.m10.1.1.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.14.m10.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.14.m10.2.2.2.2">𝑙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.14.m10.2c">y_{i,l}</annotation></semantics></math>.
We reorganize these data and build a preference dataset <math id="S3.SS1.SSS1.p1.15.m11.1" class="ltx_Math" alttext="\mathcal{D}_{m}" display="inline"><semantics id="S3.SS1.SSS1.p1.15.m11.1a"><msub id="S3.SS1.SSS1.p1.15.m11.1.1" xref="S3.SS1.SSS1.p1.15.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.15.m11.1.1.2" xref="S3.SS1.SSS1.p1.15.m11.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.SSS1.p1.15.m11.1.1.3" xref="S3.SS1.SSS1.p1.15.m11.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.15.m11.1b"><apply id="S3.SS1.SSS1.p1.15.m11.1.1.cmml" xref="S3.SS1.SSS1.p1.15.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.15.m11.1.1.1.cmml" xref="S3.SS1.SSS1.p1.15.m11.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.15.m11.1.1.2.cmml" xref="S3.SS1.SSS1.p1.15.m11.1.1.2">𝒟</ci><ci id="S3.SS1.SSS1.p1.15.m11.1.1.3.cmml" xref="S3.SS1.SSS1.p1.15.m11.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.15.m11.1c">\mathcal{D}_{m}</annotation></semantics></math> to be <math id="S3.SS1.SSS1.p1.16.m12.16" class="ltx_Math" alttext="\{(x_{i},y_{i,w},y_{i,l},0),(x_{i},y_{i,l},y_{i,w},1)|(x_{i},y_{i,w},y_{i,l})\in\hat{\mathcal{D}}_{m}\}" display="inline"><semantics id="S3.SS1.SSS1.p1.16.m12.16a"><mrow id="S3.SS1.SSS1.p1.16.m12.16.16.2" xref="S3.SS1.SSS1.p1.16.m12.16.16.3.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.16.m12.16.16.2.3" xref="S3.SS1.SSS1.p1.16.m12.16.16.3.1.cmml">{</mo><mrow id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.3.cmml"><mrow id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.4.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.4" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.4.cmml">(</mo><msub id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1.2" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1.3" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.5" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.4.cmml">,</mo><msub id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.2.2" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.2.2.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.2.2.2" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.2.2.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p1.16.m12.2.2.2.4" xref="S3.SS1.SSS1.p1.16.m12.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.1.1.1.1" xref="S3.SS1.SSS1.p1.16.m12.1.1.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.16.m12.2.2.2.4.1" xref="S3.SS1.SSS1.p1.16.m12.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.16.m12.2.2.2.2" xref="S3.SS1.SSS1.p1.16.m12.2.2.2.2.cmml">w</mi></mrow></msub><mo id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.6" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.4.cmml">,</mo><msub id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.3" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.3.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.3.2" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.3.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p1.16.m12.4.4.2.4" xref="S3.SS1.SSS1.p1.16.m12.4.4.2.3.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.3.3.1.1" xref="S3.SS1.SSS1.p1.16.m12.3.3.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.16.m12.4.4.2.4.1" xref="S3.SS1.SSS1.p1.16.m12.4.4.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.16.m12.4.4.2.2" xref="S3.SS1.SSS1.p1.16.m12.4.4.2.2.cmml">l</mi></mrow></msub><mo id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.7" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.4.cmml">,</mo><mn id="S3.SS1.SSS1.p1.16.m12.13.13" xref="S3.SS1.SSS1.p1.16.m12.13.13.cmml">0</mn><mo stretchy="false" id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.8" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.4.cmml">)</mo></mrow><mo id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.3" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.3.cmml">,</mo><mrow id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.4.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.4" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.4.cmml">(</mo><msub id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1.2" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1.3" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.5" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.4.cmml">,</mo><msub id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.2.2" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.2.2.2" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.2.2.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p1.16.m12.6.6.2.4" xref="S3.SS1.SSS1.p1.16.m12.6.6.2.3.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.5.5.1.1" xref="S3.SS1.SSS1.p1.16.m12.5.5.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.16.m12.6.6.2.4.1" xref="S3.SS1.SSS1.p1.16.m12.6.6.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.16.m12.6.6.2.2" xref="S3.SS1.SSS1.p1.16.m12.6.6.2.2.cmml">l</mi></mrow></msub><mo id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.6" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.4.cmml">,</mo><msub id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.3" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.3.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.3.2" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.3.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p1.16.m12.8.8.2.4" xref="S3.SS1.SSS1.p1.16.m12.8.8.2.3.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.7.7.1.1" xref="S3.SS1.SSS1.p1.16.m12.7.7.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.16.m12.8.8.2.4.1" xref="S3.SS1.SSS1.p1.16.m12.8.8.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.16.m12.8.8.2.2" xref="S3.SS1.SSS1.p1.16.m12.8.8.2.2.cmml">w</mi></mrow></msub><mo id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.7" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.4.cmml">,</mo><mn id="S3.SS1.SSS1.p1.16.m12.14.14" xref="S3.SS1.SSS1.p1.16.m12.14.14.cmml">1</mn><mo stretchy="false" id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.8" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.4.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.16.m12.16.16.2.4" xref="S3.SS1.SSS1.p1.16.m12.16.16.3.1.cmml">|</mo><mrow id="S3.SS1.SSS1.p1.16.m12.16.16.2.2" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.cmml"><mrow id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.4.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.4" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.4.cmml">(</mo><msub id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1.2" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1.3" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.5" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.4.cmml">,</mo><msub id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.2.2.2" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.2.2.2.2" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.2.2.2.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p1.16.m12.10.10.2.4" xref="S3.SS1.SSS1.p1.16.m12.10.10.2.3.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.9.9.1.1" xref="S3.SS1.SSS1.p1.16.m12.9.9.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.16.m12.10.10.2.4.1" xref="S3.SS1.SSS1.p1.16.m12.10.10.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.16.m12.10.10.2.2" xref="S3.SS1.SSS1.p1.16.m12.10.10.2.2.cmml">w</mi></mrow></msub><mo id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.6" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.4.cmml">,</mo><msub id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.3" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.3.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.3.2" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.3.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p1.16.m12.12.12.2.4" xref="S3.SS1.SSS1.p1.16.m12.12.12.2.3.cmml"><mi id="S3.SS1.SSS1.p1.16.m12.11.11.1.1" xref="S3.SS1.SSS1.p1.16.m12.11.11.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.16.m12.12.12.2.4.1" xref="S3.SS1.SSS1.p1.16.m12.12.12.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.16.m12.12.12.2.2" xref="S3.SS1.SSS1.p1.16.m12.12.12.2.2.cmml">l</mi></mrow></msub><mo stretchy="false" id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.7" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.4.cmml">)</mo></mrow><mo id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.4" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.4.cmml">∈</mo><msub id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.cmml"><mover accent="true" id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.2" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.2.2" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.2.2.cmml">𝒟</mi><mo id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.2.1" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.2.1.cmml">^</mo></mover><mi id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.3" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.3.cmml">m</mi></msub></mrow><mo stretchy="false" id="S3.SS1.SSS1.p1.16.m12.16.16.2.5" xref="S3.SS1.SSS1.p1.16.m12.16.16.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.16.m12.16b"><apply id="S3.SS1.SSS1.p1.16.m12.16.16.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2"><csymbol cd="latexml" id="S3.SS1.SSS1.p1.16.m12.16.16.3.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.3">conditional-set</csymbol><list id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2"><vector id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.4.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3"><apply id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.2.2.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.2.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.2.2.2">𝑦</ci><list id="S3.SS1.SSS1.p1.16.m12.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.2.2.2.4"><ci id="S3.SS1.SSS1.p1.16.m12.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.1.1.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.16.m12.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.2.2.2.2">𝑤</ci></list></apply><apply id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.3.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.3.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.1.1.3.3.2">𝑦</ci><list id="S3.SS1.SSS1.p1.16.m12.4.4.2.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.4.4.2.4"><ci id="S3.SS1.SSS1.p1.16.m12.3.3.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.3.3.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.16.m12.4.4.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.4.4.2.2">𝑙</ci></list></apply><cn type="integer" id="S3.SS1.SSS1.p1.16.m12.13.13.cmml" xref="S3.SS1.SSS1.p1.16.m12.13.13">0</cn></vector><vector id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.4.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3"><apply id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1.2">𝑥</ci><ci id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.1.1.3">𝑖</ci></apply><apply id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.2.2.2">𝑦</ci><list id="S3.SS1.SSS1.p1.16.m12.6.6.2.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.6.6.2.4"><ci id="S3.SS1.SSS1.p1.16.m12.5.5.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.5.5.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.16.m12.6.6.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.6.6.2.2">𝑙</ci></list></apply><apply id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.3.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.3">subscript</csymbol><ci id="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.3.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.15.15.1.1.2.2.3.3.2">𝑦</ci><list id="S3.SS1.SSS1.p1.16.m12.8.8.2.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.8.8.2.4"><ci id="S3.SS1.SSS1.p1.16.m12.7.7.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.7.7.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.16.m12.8.8.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.8.8.2.2">𝑤</ci></list></apply><cn type="integer" id="S3.SS1.SSS1.p1.16.m12.14.14.cmml" xref="S3.SS1.SSS1.p1.16.m12.14.14">1</cn></vector></list><apply id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2"><in id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.4.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.4"></in><vector id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.4.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3"><apply id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1.2">𝑥</ci><ci id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.2.2.2.2">𝑦</ci><list id="S3.SS1.SSS1.p1.16.m12.10.10.2.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.10.10.2.4"><ci id="S3.SS1.SSS1.p1.16.m12.9.9.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.9.9.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.16.m12.10.10.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.10.10.2.2">𝑤</ci></list></apply><apply id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.3.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.3.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.3.3.3.2">𝑦</ci><list id="S3.SS1.SSS1.p1.16.m12.12.12.2.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.12.12.2.4"><ci id="S3.SS1.SSS1.p1.16.m12.11.11.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.11.11.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.16.m12.12.12.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.12.12.2.2">𝑙</ci></list></apply></vector><apply id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5">subscript</csymbol><apply id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.2"><ci id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.2.1.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.2.1">^</ci><ci id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.2.2.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.2.2">𝒟</ci></apply><ci id="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.3.cmml" xref="S3.SS1.SSS1.p1.16.m12.16.16.2.2.5.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.16.m12.16c">\{(x_{i},y_{i,w},y_{i,l},0),(x_{i},y_{i,l},y_{i,w},1)|(x_{i},y_{i,w},y_{i,l})\in\hat{\mathcal{D}}_{m}\}</annotation></semantics></math> for training, in which each contains the prompt, a pair of completions and preference selection. Apparently, this dataset eliminates the position effects, and we can train the selector as a classification task. Therefore, we utilize cross-entropy (CE) loss <math id="S3.SS1.SSS1.p1.17.m13.1" class="ltx_Math" alttext="\ell_{CE}" display="inline"><semantics id="S3.SS1.SSS1.p1.17.m13.1a"><msub id="S3.SS1.SSS1.p1.17.m13.1.1" xref="S3.SS1.SSS1.p1.17.m13.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.SSS1.p1.17.m13.1.1.2" xref="S3.SS1.SSS1.p1.17.m13.1.1.2.cmml">ℓ</mi><mrow id="S3.SS1.SSS1.p1.17.m13.1.1.3" xref="S3.SS1.SSS1.p1.17.m13.1.1.3.cmml"><mi id="S3.SS1.SSS1.p1.17.m13.1.1.3.2" xref="S3.SS1.SSS1.p1.17.m13.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.17.m13.1.1.3.1" xref="S3.SS1.SSS1.p1.17.m13.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p1.17.m13.1.1.3.3" xref="S3.SS1.SSS1.p1.17.m13.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.17.m13.1b"><apply id="S3.SS1.SSS1.p1.17.m13.1.1.cmml" xref="S3.SS1.SSS1.p1.17.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.17.m13.1.1.1.cmml" xref="S3.SS1.SSS1.p1.17.m13.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.17.m13.1.1.2.cmml" xref="S3.SS1.SSS1.p1.17.m13.1.1.2">ℓ</ci><apply id="S3.SS1.SSS1.p1.17.m13.1.1.3.cmml" xref="S3.SS1.SSS1.p1.17.m13.1.1.3"><times id="S3.SS1.SSS1.p1.17.m13.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.17.m13.1.1.3.1"></times><ci id="S3.SS1.SSS1.p1.17.m13.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.17.m13.1.1.3.2">𝐶</ci><ci id="S3.SS1.SSS1.p1.17.m13.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.17.m13.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.17.m13.1c">\ell_{CE}</annotation></semantics></math> to optimize the selector and formulate the expected loss as</p>
<table id="A2.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.8" class="ltx_Math" alttext="\displaystyle F_{m}(\phi)=\mathbb{E}_{(x,y_{0},y_{1},i)\sim\mathcal{D}_{m}}\left[\ell_{CE}(i|\phi;x,y_{0},y_{1})\right]." display="inline"><semantics id="S3.E2.m1.8a"><mrow id="S3.E2.m1.8.8.1" xref="S3.E2.m1.8.8.1.1.cmml"><mrow id="S3.E2.m1.8.8.1.1" xref="S3.E2.m1.8.8.1.1.cmml"><mrow id="S3.E2.m1.8.8.1.1.3" xref="S3.E2.m1.8.8.1.1.3.cmml"><msub id="S3.E2.m1.8.8.1.1.3.2" xref="S3.E2.m1.8.8.1.1.3.2.cmml"><mi id="S3.E2.m1.8.8.1.1.3.2.2" xref="S3.E2.m1.8.8.1.1.3.2.2.cmml">F</mi><mi id="S3.E2.m1.8.8.1.1.3.2.3" xref="S3.E2.m1.8.8.1.1.3.2.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.8.8.1.1.3.1" xref="S3.E2.m1.8.8.1.1.3.1.cmml">​</mo><mrow id="S3.E2.m1.8.8.1.1.3.3.2" xref="S3.E2.m1.8.8.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.8.8.1.1.3.3.2.1" xref="S3.E2.m1.8.8.1.1.3.cmml">(</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">ϕ</mi><mo stretchy="false" id="S3.E2.m1.8.8.1.1.3.3.2.2" xref="S3.E2.m1.8.8.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.8.8.1.1.2" xref="S3.E2.m1.8.8.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.8.8.1.1.1" xref="S3.E2.m1.8.8.1.1.1.cmml"><msub id="S3.E2.m1.8.8.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.3.cmml"><mi id="S3.E2.m1.8.8.1.1.1.3.2" xref="S3.E2.m1.8.8.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E2.m1.4.4.4" xref="S3.E2.m1.4.4.4.cmml"><mrow id="S3.E2.m1.4.4.4.4.2" xref="S3.E2.m1.4.4.4.4.3.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.4.4.2.3" xref="S3.E2.m1.4.4.4.4.3.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">x</mi><mo id="S3.E2.m1.4.4.4.4.2.4" xref="S3.E2.m1.4.4.4.4.3.cmml">,</mo><msub id="S3.E2.m1.3.3.3.3.1.1" xref="S3.E2.m1.3.3.3.3.1.1.cmml"><mi id="S3.E2.m1.3.3.3.3.1.1.2" xref="S3.E2.m1.3.3.3.3.1.1.2.cmml">y</mi><mn id="S3.E2.m1.3.3.3.3.1.1.3" xref="S3.E2.m1.3.3.3.3.1.1.3.cmml">0</mn></msub><mo id="S3.E2.m1.4.4.4.4.2.5" xref="S3.E2.m1.4.4.4.4.3.cmml">,</mo><msub id="S3.E2.m1.4.4.4.4.2.2" xref="S3.E2.m1.4.4.4.4.2.2.cmml"><mi id="S3.E2.m1.4.4.4.4.2.2.2" xref="S3.E2.m1.4.4.4.4.2.2.2.cmml">y</mi><mn id="S3.E2.m1.4.4.4.4.2.2.3" xref="S3.E2.m1.4.4.4.4.2.2.3.cmml">1</mn></msub><mo id="S3.E2.m1.4.4.4.4.2.6" xref="S3.E2.m1.4.4.4.4.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">i</mi><mo stretchy="false" id="S3.E2.m1.4.4.4.4.2.7" xref="S3.E2.m1.4.4.4.4.3.cmml">)</mo></mrow><mo id="S3.E2.m1.4.4.4.5" xref="S3.E2.m1.4.4.4.5.cmml">∼</mo><msub id="S3.E2.m1.4.4.4.6" xref="S3.E2.m1.4.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4.4.6.2" xref="S3.E2.m1.4.4.4.6.2.cmml">𝒟</mi><mi id="S3.E2.m1.4.4.4.6.3" xref="S3.E2.m1.4.4.4.6.3.cmml">m</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.8.8.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.2.cmml"><mo id="S3.E2.m1.8.8.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.8.8.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.8.8.1.1.1.1.1.1.3.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.2.cmml">ℓ</mi><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1.3.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.3.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.8.8.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.4.cmml">i</mi><mo fence="false" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">ϕ</mi><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3.cmml">;</mo><mi id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml">x</mi><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.5" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mn id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">1</mn></msub></mrow></mrow><mo stretchy="false" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.8.8.1.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.8.8.1.2" xref="S3.E2.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.8b"><apply id="S3.E2.m1.8.8.1.1.cmml" xref="S3.E2.m1.8.8.1"><eq id="S3.E2.m1.8.8.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.2"></eq><apply id="S3.E2.m1.8.8.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.3"><times id="S3.E2.m1.8.8.1.1.3.1.cmml" xref="S3.E2.m1.8.8.1.1.3.1"></times><apply id="S3.E2.m1.8.8.1.1.3.2.cmml" xref="S3.E2.m1.8.8.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.3.2.1.cmml" xref="S3.E2.m1.8.8.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.3.2.2.cmml" xref="S3.E2.m1.8.8.1.1.3.2.2">𝐹</ci><ci id="S3.E2.m1.8.8.1.1.3.2.3.cmml" xref="S3.E2.m1.8.8.1.1.3.2.3">𝑚</ci></apply><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">italic-ϕ</ci></apply><apply id="S3.E2.m1.8.8.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1"><times id="S3.E2.m1.8.8.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.2"></times><apply id="S3.E2.m1.8.8.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.3.1.cmml" xref="S3.E2.m1.8.8.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.3.2.cmml" xref="S3.E2.m1.8.8.1.1.1.3.2">𝔼</ci><apply id="S3.E2.m1.4.4.4.cmml" xref="S3.E2.m1.4.4.4"><csymbol cd="latexml" id="S3.E2.m1.4.4.4.5.cmml" xref="S3.E2.m1.4.4.4.5">similar-to</csymbol><vector id="S3.E2.m1.4.4.4.4.3.cmml" xref="S3.E2.m1.4.4.4.4.2"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑥</ci><apply id="S3.E2.m1.3.3.3.3.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.2">𝑦</ci><cn type="integer" id="S3.E2.m1.3.3.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.3">0</cn></apply><apply id="S3.E2.m1.4.4.4.4.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.2.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.2.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2">𝑦</ci><cn type="integer" id="S3.E2.m1.4.4.4.4.2.2.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2.3">1</cn></apply><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑖</ci></vector><apply id="S3.E2.m1.4.4.4.6.cmml" xref="S3.E2.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.6.1.cmml" xref="S3.E2.m1.4.4.4.6">subscript</csymbol><ci id="S3.E2.m1.4.4.4.6.2.cmml" xref="S3.E2.m1.4.4.4.6.2">𝒟</ci><ci id="S3.E2.m1.4.4.4.6.3.cmml" xref="S3.E2.m1.4.4.4.6.3">𝑚</ci></apply></apply></apply><apply id="S3.E2.m1.8.8.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.8.8.1.1.1.1.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1"><times id="S3.E2.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.2">ℓ</ci><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.3"><times id="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.2">𝐶</ci><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.3.3">𝐸</ci></apply></apply><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.3">conditional</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.4">𝑖</ci><list id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6">italic-ϕ</ci><ci id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7">𝑥</ci><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><cn type="integer" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3">0</cn></apply><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><cn type="integer" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2.2.2.3">1</cn></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.8c">\displaystyle F_{m}(\phi)=\mathbb{E}_{(x,y_{0},y_{1},i)\sim\mathcal{D}_{m}}\left[\ell_{CE}(i|\phi;x,y_{0},y_{1})\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.SSS1.p2" class="ltx_para">
<p id="S3.SS1.SSS1.p2.1" class="ltx_p">Next, we will discuss how to optimize the selector <math id="S3.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS1.SSS1.p2.1.m1.1a"><mi id="S3.SS1.SSS1.p2.1.m1.1.1" xref="S3.SS1.SSS1.p2.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.1.m1.1b"><ci id="S3.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.1.m1.1c">\phi</annotation></semantics></math> under the FL scenario.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Algorithm Design</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.1" class="ltx_p">We consider a practical and efficient FL scenario where not all clients but only a sampled subsets of clients participate in each communication round <cite class="ltx_cite ltx_citemacro_cite">Yang et al. (<a href="#bib.bib48" title="" class="ltx_ref">2020</a>)</cite>.
Before the commencement of FL training, we initialize the binary selector with a pretrained LLM such as LLaMA-2 <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a href="#bib.bib42" title="" class="ltx_ref">2023</a>)</cite>, and set the hyperparameters.</p>
</div>
<div id="S3.SS1.SSS2.p2" class="ltx_para">
<p id="S3.SS1.SSS2.p2.3" class="ltx_p">An FL algorithm requires multiple communication rounds and consists of three phases in each round, i.e., <span id="S3.SS1.SSS2.p2.3.1" class="ltx_text ltx_font_italic">model broadcast</span>, <span id="S3.SS1.SSS2.p2.3.2" class="ltx_text ltx_font_italic">local training</span>, and <span id="S3.SS1.SSS2.p2.3.3" class="ltx_text ltx_font_italic">global aggregation</span>.
Following this paradigm, we design <span id="S3.SS1.SSS2.p2.3.4" class="ltx_text ltx_markedasmath">FedBis</span> and optimize the selector <math id="S3.SS1.SSS2.p2.2.m2.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS1.SSS2.p2.2.m2.1a"><mi id="S3.SS1.SSS2.p2.2.m2.1.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.2.m2.1b"><ci id="S3.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.2.m2.1c">\phi</annotation></semantics></math>, i.e., in the communication round <math id="S3.SS1.SSS2.p2.3.m3.1" class="ltx_Math" alttext="r\in[R]" display="inline"><semantics id="S3.SS1.SSS2.p2.3.m3.1a"><mrow id="S3.SS1.SSS2.p2.3.m3.1.2" xref="S3.SS1.SSS2.p2.3.m3.1.2.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.1.2.2" xref="S3.SS1.SSS2.p2.3.m3.1.2.2.cmml">r</mi><mo id="S3.SS1.SSS2.p2.3.m3.1.2.1" xref="S3.SS1.SSS2.p2.3.m3.1.2.1.cmml">∈</mo><mrow id="S3.SS1.SSS2.p2.3.m3.1.2.3.2" xref="S3.SS1.SSS2.p2.3.m3.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.3.m3.1.2.3.2.1" xref="S3.SS1.SSS2.p2.3.m3.1.2.3.1.1.cmml">[</mo><mi id="S3.SS1.SSS2.p2.3.m3.1.1" xref="S3.SS1.SSS2.p2.3.m3.1.1.cmml">R</mi><mo stretchy="false" id="S3.SS1.SSS2.p2.3.m3.1.2.3.2.2" xref="S3.SS1.SSS2.p2.3.m3.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.3.m3.1b"><apply id="S3.SS1.SSS2.p2.3.m3.1.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.2"><in id="S3.SS1.SSS2.p2.3.m3.1.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.2.1"></in><ci id="S3.SS1.SSS2.p2.3.m3.1.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.2.2">𝑟</ci><apply id="S3.SS1.SSS2.p2.3.m3.1.2.3.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.2.3.2"><csymbol cd="latexml" id="S3.SS1.SSS2.p2.3.m3.1.2.3.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.1">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.3.m3.1c">r\in[R]</annotation></semantics></math>, as discussed as follows.</p>
</div>
<section id="S3.SS1.SSS2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Step 1: Model Broadcast.</h5>

<div id="S3.SS1.SSS2.Px1.p1" class="ltx_para">
<p id="S3.SS1.SSS2.Px1.p1.4" class="ltx_p">The server uniformly samples <math id="S3.SS1.SSS2.Px1.p1.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.SSS2.Px1.p1.1.m1.1a"><mi id="S3.SS1.SSS2.Px1.p1.1.m1.1.1" xref="S3.SS1.SSS2.Px1.p1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px1.p1.1.m1.1b"><ci id="S3.SS1.SSS2.Px1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS2.Px1.p1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px1.p1.1.m1.1c">A</annotation></semantics></math> clients without replacement, denoted by <math id="S3.SS1.SSS2.Px1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S3.SS1.SSS2.Px1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.Px1.p1.2.m2.1.1" xref="S3.SS1.SSS2.Px1.p1.2.m2.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px1.p1.2.m2.1b"><ci id="S3.SS1.SSS2.Px1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS2.Px1.p1.2.m2.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px1.p1.2.m2.1c">\mathcal{A}</annotation></semantics></math>. Let the selector be <math id="S3.SS1.SSS2.Px1.p1.3.m3.1" class="ltx_Math" alttext="\phi_{r}" display="inline"><semantics id="S3.SS1.SSS2.Px1.p1.3.m3.1a"><msub id="S3.SS1.SSS2.Px1.p1.3.m3.1.1" xref="S3.SS1.SSS2.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS2.Px1.p1.3.m3.1.1.2" xref="S3.SS1.SSS2.Px1.p1.3.m3.1.1.2.cmml">ϕ</mi><mi id="S3.SS1.SSS2.Px1.p1.3.m3.1.1.3" xref="S3.SS1.SSS2.Px1.p1.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px1.p1.3.m3.1b"><apply id="S3.SS1.SSS2.Px1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS2.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS2.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS2.Px1.p1.3.m3.1.1.2">italic-ϕ</ci><ci id="S3.SS1.SSS2.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS2.Px1.p1.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px1.p1.3.m3.1c">\phi_{r}</annotation></semantics></math> in the <math id="S3.SS1.SSS2.Px1.p1.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS1.SSS2.Px1.p1.4.m4.1a"><mi id="S3.SS1.SSS2.Px1.p1.4.m4.1.1" xref="S3.SS1.SSS2.Px1.p1.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px1.p1.4.m4.1b"><ci id="S3.SS1.SSS2.Px1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS2.Px1.p1.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px1.p1.4.m4.1c">r</annotation></semantics></math>-th communication round, and the server broadcasts it to the sampled clients.</p>
</div>
</section>
<section id="S3.SS1.SSS2.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Step 2: Local Training.</h5>

<div id="S3.SS1.SSS2.Px2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.Px2.p1.4" class="ltx_p">At this step, client <math id="S3.SS1.SSS2.Px2.p1.1.m1.1" class="ltx_Math" alttext="m\in\mathcal{A}" display="inline"><semantics id="S3.SS1.SSS2.Px2.p1.1.m1.1a"><mrow id="S3.SS1.SSS2.Px2.p1.1.m1.1.1" xref="S3.SS1.SSS2.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.Px2.p1.1.m1.1.1.2" xref="S3.SS1.SSS2.Px2.p1.1.m1.1.1.2.cmml">m</mi><mo id="S3.SS1.SSS2.Px2.p1.1.m1.1.1.1" xref="S3.SS1.SSS2.Px2.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.Px2.p1.1.m1.1.1.3" xref="S3.SS1.SSS2.Px2.p1.1.m1.1.1.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px2.p1.1.m1.1b"><apply id="S3.SS1.SSS2.Px2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.1.m1.1.1"><in id="S3.SS1.SSS2.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.1.m1.1.1.1"></in><ci id="S3.SS1.SSS2.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.Px2.p1.1.m1.1.1.2">𝑚</ci><ci id="S3.SS1.SSS2.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.Px2.p1.1.m1.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px2.p1.1.m1.1c">m\in\mathcal{A}</annotation></semantics></math> optimizes the selector based on local preference data. First, the client initializes the local selector <math id="S3.SS1.SSS2.Px2.p1.2.m2.2" class="ltx_Math" alttext="\phi_{r,0}^{m}" display="inline"><semantics id="S3.SS1.SSS2.Px2.p1.2.m2.2a"><msubsup id="S3.SS1.SSS2.Px2.p1.2.m2.2.3" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.3.cmml"><mi id="S3.SS1.SSS2.Px2.p1.2.m2.2.3.2.2" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.3.2.2.cmml">ϕ</mi><mrow id="S3.SS1.SSS2.Px2.p1.2.m2.2.2.2.4" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.Px2.p1.2.m2.1.1.1.1" xref="S3.SS1.SSS2.Px2.p1.2.m2.1.1.1.1.cmml">r</mi><mo id="S3.SS1.SSS2.Px2.p1.2.m2.2.2.2.4.1" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.2.2.3.cmml">,</mo><mn id="S3.SS1.SSS2.Px2.p1.2.m2.2.2.2.2" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.2.2.2.cmml">0</mn></mrow><mi id="S3.SS1.SSS2.Px2.p1.2.m2.2.3.3" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.3.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px2.p1.2.m2.2b"><apply id="S3.SS1.SSS2.Px2.p1.2.m2.2.3.cmml" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.Px2.p1.2.m2.2.3.1.cmml" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.3">superscript</csymbol><apply id="S3.SS1.SSS2.Px2.p1.2.m2.2.3.2.cmml" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.Px2.p1.2.m2.2.3.2.1.cmml" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.3">subscript</csymbol><ci id="S3.SS1.SSS2.Px2.p1.2.m2.2.3.2.2.cmml" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.3.2.2">italic-ϕ</ci><list id="S3.SS1.SSS2.Px2.p1.2.m2.2.2.2.3.cmml" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.2.2.4"><ci id="S3.SS1.SSS2.Px2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.2.m2.1.1.1.1">𝑟</ci><cn type="integer" id="S3.SS1.SSS2.Px2.p1.2.m2.2.2.2.2.cmml" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.2.2.2">0</cn></list></apply><ci id="S3.SS1.SSS2.Px2.p1.2.m2.2.3.3.cmml" xref="S3.SS1.SSS2.Px2.p1.2.m2.2.3.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px2.p1.2.m2.2c">\phi_{r,0}^{m}</annotation></semantics></math> with the global selector <math id="S3.SS1.SSS2.Px2.p1.3.m3.1" class="ltx_Math" alttext="\phi_{r}" display="inline"><semantics id="S3.SS1.SSS2.Px2.p1.3.m3.1a"><msub id="S3.SS1.SSS2.Px2.p1.3.m3.1.1" xref="S3.SS1.SSS2.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS2.Px2.p1.3.m3.1.1.2" xref="S3.SS1.SSS2.Px2.p1.3.m3.1.1.2.cmml">ϕ</mi><mi id="S3.SS1.SSS2.Px2.p1.3.m3.1.1.3" xref="S3.SS1.SSS2.Px2.p1.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px2.p1.3.m3.1b"><apply id="S3.SS1.SSS2.Px2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS2.Px2.p1.3.m3.1.1.2">italic-ϕ</ci><ci id="S3.SS1.SSS2.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS2.Px2.p1.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px2.p1.3.m3.1c">\phi_{r}</annotation></semantics></math> received from the server. Subsequently, the client trains the selector for <math id="S3.SS1.SSS2.Px2.p1.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.SSS2.Px2.p1.4.m4.1a"><mi id="S3.SS1.SSS2.Px2.p1.4.m4.1.1" xref="S3.SS1.SSS2.Px2.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px2.p1.4.m4.1b"><ci id="S3.SS1.SSS2.Px2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px2.p1.4.m4.1c">K</annotation></semantics></math> iterations, where the update rule between consecutive iterations follows:</p>
<table id="A2.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.9" class="ltx_Math" alttext="\displaystyle\phi_{r,k+1}^{m}=\phi_{r,k}^{m}-\eta\nabla F_{m}(\phi_{r,k}^{m}),k\in[K]" display="inline"><semantics id="S3.E3.m1.9a"><mrow id="S3.E3.m1.9.9.2" xref="S3.E3.m1.9.9.3.cmml"><mrow id="S3.E3.m1.8.8.1.1" xref="S3.E3.m1.8.8.1.1.cmml"><msubsup id="S3.E3.m1.8.8.1.1.3" xref="S3.E3.m1.8.8.1.1.3.cmml"><mi id="S3.E3.m1.8.8.1.1.3.2.2" xref="S3.E3.m1.8.8.1.1.3.2.2.cmml">ϕ</mi><mrow id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">r</mi><mo id="S3.E3.m1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mrow id="S3.E3.m1.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.1.cmml"><mi id="S3.E3.m1.2.2.2.2.1.2" xref="S3.E3.m1.2.2.2.2.1.2.cmml">k</mi><mo id="S3.E3.m1.2.2.2.2.1.1" xref="S3.E3.m1.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E3.m1.2.2.2.2.1.3" xref="S3.E3.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow><mi id="S3.E3.m1.8.8.1.1.3.3" xref="S3.E3.m1.8.8.1.1.3.3.cmml">m</mi></msubsup><mo id="S3.E3.m1.8.8.1.1.2" xref="S3.E3.m1.8.8.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.8.8.1.1.1" xref="S3.E3.m1.8.8.1.1.1.cmml"><msubsup id="S3.E3.m1.8.8.1.1.1.3" xref="S3.E3.m1.8.8.1.1.1.3.cmml"><mi id="S3.E3.m1.8.8.1.1.1.3.2.2" xref="S3.E3.m1.8.8.1.1.1.3.2.2.cmml">ϕ</mi><mrow id="S3.E3.m1.4.4.2.4" xref="S3.E3.m1.4.4.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml">r</mi><mo id="S3.E3.m1.4.4.2.4.1" xref="S3.E3.m1.4.4.2.3.cmml">,</mo><mi id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.2.cmml">k</mi></mrow><mi id="S3.E3.m1.8.8.1.1.1.3.3" xref="S3.E3.m1.8.8.1.1.1.3.3.cmml">m</mi></msubsup><mo id="S3.E3.m1.8.8.1.1.1.2" xref="S3.E3.m1.8.8.1.1.1.2.cmml">−</mo><mrow id="S3.E3.m1.8.8.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.cmml"><mi id="S3.E3.m1.8.8.1.1.1.1.3" xref="S3.E3.m1.8.8.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S3.E3.m1.8.8.1.1.1.1.2" xref="S3.E3.m1.8.8.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.4" xref="S3.E3.m1.8.8.1.1.1.1.4.cmml"><mo rspace="0.167em" id="S3.E3.m1.8.8.1.1.1.1.4.1" xref="S3.E3.m1.8.8.1.1.1.1.4.1.cmml">∇</mo><msub id="S3.E3.m1.8.8.1.1.1.1.4.2" xref="S3.E3.m1.8.8.1.1.1.1.4.2.cmml"><mi id="S3.E3.m1.8.8.1.1.1.1.4.2.2" xref="S3.E3.m1.8.8.1.1.1.1.4.2.2.cmml">F</mi><mi id="S3.E3.m1.8.8.1.1.1.1.4.2.3" xref="S3.E3.m1.8.8.1.1.1.1.4.2.3.cmml">m</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.1.1.1.1.2a" xref="S3.E3.m1.8.8.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.1.1.1.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.8.8.1.1.1.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.2.cmml">ϕ</mi><mrow id="S3.E3.m1.6.6.2.4" xref="S3.E3.m1.6.6.2.3.cmml"><mi id="S3.E3.m1.5.5.1.1" xref="S3.E3.m1.5.5.1.1.cmml">r</mi><mo id="S3.E3.m1.6.6.2.4.1" xref="S3.E3.m1.6.6.2.3.cmml">,</mo><mi id="S3.E3.m1.6.6.2.2" xref="S3.E3.m1.6.6.2.2.cmml">k</mi></mrow><mi id="S3.E3.m1.8.8.1.1.1.1.1.1.1.3" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.3.cmml">m</mi></msubsup><mo stretchy="false" id="S3.E3.m1.8.8.1.1.1.1.1.1.3" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.9.9.2.3" xref="S3.E3.m1.9.9.3a.cmml">,</mo><mrow id="S3.E3.m1.9.9.2.2" xref="S3.E3.m1.9.9.2.2.cmml"><mi id="S3.E3.m1.9.9.2.2.2" xref="S3.E3.m1.9.9.2.2.2.cmml">k</mi><mo id="S3.E3.m1.9.9.2.2.1" xref="S3.E3.m1.9.9.2.2.1.cmml">∈</mo><mrow id="S3.E3.m1.9.9.2.2.3.2" xref="S3.E3.m1.9.9.2.2.3.1.cmml"><mo stretchy="false" id="S3.E3.m1.9.9.2.2.3.2.1" xref="S3.E3.m1.9.9.2.2.3.1.1.cmml">[</mo><mi id="S3.E3.m1.7.7" xref="S3.E3.m1.7.7.cmml">K</mi><mo stretchy="false" id="S3.E3.m1.9.9.2.2.3.2.2" xref="S3.E3.m1.9.9.2.2.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.9b"><apply id="S3.E3.m1.9.9.3.cmml" xref="S3.E3.m1.9.9.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.3a.cmml" xref="S3.E3.m1.9.9.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.8.8.1.1.cmml" xref="S3.E3.m1.8.8.1.1"><eq id="S3.E3.m1.8.8.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.2"></eq><apply id="S3.E3.m1.8.8.1.1.3.cmml" xref="S3.E3.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.3.1.cmml" xref="S3.E3.m1.8.8.1.1.3">superscript</csymbol><apply id="S3.E3.m1.8.8.1.1.3.2.cmml" xref="S3.E3.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.3.2.1.cmml" xref="S3.E3.m1.8.8.1.1.3">subscript</csymbol><ci id="S3.E3.m1.8.8.1.1.3.2.2.cmml" xref="S3.E3.m1.8.8.1.1.3.2.2">italic-ϕ</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑟</ci><apply id="S3.E3.m1.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1"><plus id="S3.E3.m1.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1"></plus><ci id="S3.E3.m1.2.2.2.2.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.2">𝑘</ci><cn type="integer" id="S3.E3.m1.2.2.2.2.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.3">1</cn></apply></list></apply><ci id="S3.E3.m1.8.8.1.1.3.3.cmml" xref="S3.E3.m1.8.8.1.1.3.3">𝑚</ci></apply><apply id="S3.E3.m1.8.8.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1"><minus id="S3.E3.m1.8.8.1.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.2"></minus><apply id="S3.E3.m1.8.8.1.1.1.3.cmml" xref="S3.E3.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.1.3.1.cmml" xref="S3.E3.m1.8.8.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.8.8.1.1.1.3.2.cmml" xref="S3.E3.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.1.3.2.1.cmml" xref="S3.E3.m1.8.8.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.8.8.1.1.1.3.2.2.cmml" xref="S3.E3.m1.8.8.1.1.1.3.2.2">italic-ϕ</ci><list id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.4"><ci id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1">𝑟</ci><ci id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.2">𝑘</ci></list></apply><ci id="S3.E3.m1.8.8.1.1.1.3.3.cmml" xref="S3.E3.m1.8.8.1.1.1.3.3">𝑚</ci></apply><apply id="S3.E3.m1.8.8.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1"><times id="S3.E3.m1.8.8.1.1.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.2"></times><ci id="S3.E3.m1.8.8.1.1.1.1.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.3">𝜂</ci><apply id="S3.E3.m1.8.8.1.1.1.1.4.cmml" xref="S3.E3.m1.8.8.1.1.1.1.4"><ci id="S3.E3.m1.8.8.1.1.1.1.4.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.4.1">∇</ci><apply id="S3.E3.m1.8.8.1.1.1.1.4.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.1.1.4.2.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E3.m1.8.8.1.1.1.1.4.2.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.4.2.2">𝐹</ci><ci id="S3.E3.m1.8.8.1.1.1.1.4.2.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.4.2.3">𝑚</ci></apply></apply><apply id="S3.E3.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.2">italic-ϕ</ci><list id="S3.E3.m1.6.6.2.3.cmml" xref="S3.E3.m1.6.6.2.4"><ci id="S3.E3.m1.5.5.1.1.cmml" xref="S3.E3.m1.5.5.1.1">𝑟</ci><ci id="S3.E3.m1.6.6.2.2.cmml" xref="S3.E3.m1.6.6.2.2">𝑘</ci></list></apply><ci id="S3.E3.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply><apply id="S3.E3.m1.9.9.2.2.cmml" xref="S3.E3.m1.9.9.2.2"><in id="S3.E3.m1.9.9.2.2.1.cmml" xref="S3.E3.m1.9.9.2.2.1"></in><ci id="S3.E3.m1.9.9.2.2.2.cmml" xref="S3.E3.m1.9.9.2.2.2">𝑘</ci><apply id="S3.E3.m1.9.9.2.2.3.1.cmml" xref="S3.E3.m1.9.9.2.2.3.2"><csymbol cd="latexml" id="S3.E3.m1.9.9.2.2.3.1.1.cmml" xref="S3.E3.m1.9.9.2.2.3.2.1">delimited-[]</csymbol><ci id="S3.E3.m1.7.7.cmml" xref="S3.E3.m1.7.7">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.9c">\displaystyle\phi_{r,k+1}^{m}=\phi_{r,k}^{m}-\eta\nabla F_{m}(\phi_{r,k}^{m}),k\in[K]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS2.Px2.p1.8" class="ltx_p">where the gradient <math id="S3.SS1.SSS2.Px2.p1.5.m1.3" class="ltx_Math" alttext="\nabla F_{m}(\phi_{r,k}^{m})" display="inline"><semantics id="S3.SS1.SSS2.Px2.p1.5.m1.3a"><mrow id="S3.SS1.SSS2.Px2.p1.5.m1.3.3" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.cmml"><mrow id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.cmml"><mo rspace="0.167em" id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.1" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.1.cmml">∇</mo><msub id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2.cmml"><mi id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2.2" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2.2.cmml">F</mi><mi id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2.3" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2.3.cmml">m</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.2" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.2.cmml">​</mo><mrow id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.2" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.cmml">(</mo><msubsup id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.cmml"><mi id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.2.2" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.2.2.cmml">ϕ</mi><mrow id="S3.SS1.SSS2.Px2.p1.5.m1.2.2.2.4" xref="S3.SS1.SSS2.Px2.p1.5.m1.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.Px2.p1.5.m1.1.1.1.1" xref="S3.SS1.SSS2.Px2.p1.5.m1.1.1.1.1.cmml">r</mi><mo id="S3.SS1.SSS2.Px2.p1.5.m1.2.2.2.4.1" xref="S3.SS1.SSS2.Px2.p1.5.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.Px2.p1.5.m1.2.2.2.2" xref="S3.SS1.SSS2.Px2.p1.5.m1.2.2.2.2.cmml">k</mi></mrow><mi id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.3" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.3.cmml">m</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.3" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px2.p1.5.m1.3b"><apply id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3"><times id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.2.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.2"></times><apply id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3"><ci id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.1.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.1">∇</ci><apply id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2.1.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2">subscript</csymbol><ci id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2.2.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2.2">𝐹</ci><ci id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2.3.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.3.2.3">𝑚</ci></apply></apply><apply id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.2.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.2.1.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.2.2.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.2.2">italic-ϕ</ci><list id="S3.SS1.SSS2.Px2.p1.5.m1.2.2.2.3.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.2.2.2.4"><ci id="S3.SS1.SSS2.Px2.p1.5.m1.1.1.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.1.1.1.1">𝑟</ci><ci id="S3.SS1.SSS2.Px2.p1.5.m1.2.2.2.2.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.2.2.2.2">𝑘</ci></list></apply><ci id="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.3.cmml" xref="S3.SS1.SSS2.Px2.p1.5.m1.3.3.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px2.p1.5.m1.3c">\nabla F_{m}(\phi_{r,k}^{m})</annotation></semantics></math> is approximated using a data batch sampled from the local preference dataset <math id="S3.SS1.SSS2.Px2.p1.6.m2.1" class="ltx_Math" alttext="\mathcal{D}_{m}" display="inline"><semantics id="S3.SS1.SSS2.Px2.p1.6.m2.1a"><msub id="S3.SS1.SSS2.Px2.p1.6.m2.1.1" xref="S3.SS1.SSS2.Px2.p1.6.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.Px2.p1.6.m2.1.1.2" xref="S3.SS1.SSS2.Px2.p1.6.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.SSS2.Px2.p1.6.m2.1.1.3" xref="S3.SS1.SSS2.Px2.p1.6.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px2.p1.6.m2.1b"><apply id="S3.SS1.SSS2.Px2.p1.6.m2.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.Px2.p1.6.m2.1.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.6.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.Px2.p1.6.m2.1.1.2.cmml" xref="S3.SS1.SSS2.Px2.p1.6.m2.1.1.2">𝒟</ci><ci id="S3.SS1.SSS2.Px2.p1.6.m2.1.1.3.cmml" xref="S3.SS1.SSS2.Px2.p1.6.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px2.p1.6.m2.1c">\mathcal{D}_{m}</annotation></semantics></math>and can incorporate optimizers such as AdamW <cite class="ltx_cite ltx_citemacro_cite">Loshchilov and Hutter (<a href="#bib.bib28" title="" class="ltx_ref">2017</a>)</cite>. Finally, the client <math id="S3.SS1.SSS2.Px2.p1.7.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.SSS2.Px2.p1.7.m3.1a"><mi id="S3.SS1.SSS2.Px2.p1.7.m3.1.1" xref="S3.SS1.SSS2.Px2.p1.7.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px2.p1.7.m3.1b"><ci id="S3.SS1.SSS2.Px2.p1.7.m3.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.7.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px2.p1.7.m3.1c">m</annotation></semantics></math> transmits the updated local selector <math id="S3.SS1.SSS2.Px2.p1.8.m4.2" class="ltx_Math" alttext="\phi_{r,K}^{m}" display="inline"><semantics id="S3.SS1.SSS2.Px2.p1.8.m4.2a"><msubsup id="S3.SS1.SSS2.Px2.p1.8.m4.2.3" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.3.cmml"><mi id="S3.SS1.SSS2.Px2.p1.8.m4.2.3.2.2" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.3.2.2.cmml">ϕ</mi><mrow id="S3.SS1.SSS2.Px2.p1.8.m4.2.2.2.4" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.Px2.p1.8.m4.1.1.1.1" xref="S3.SS1.SSS2.Px2.p1.8.m4.1.1.1.1.cmml">r</mi><mo id="S3.SS1.SSS2.Px2.p1.8.m4.2.2.2.4.1" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.Px2.p1.8.m4.2.2.2.2" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.2.2.2.cmml">K</mi></mrow><mi id="S3.SS1.SSS2.Px2.p1.8.m4.2.3.3" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.3.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px2.p1.8.m4.2b"><apply id="S3.SS1.SSS2.Px2.p1.8.m4.2.3.cmml" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.Px2.p1.8.m4.2.3.1.cmml" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.3">superscript</csymbol><apply id="S3.SS1.SSS2.Px2.p1.8.m4.2.3.2.cmml" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.Px2.p1.8.m4.2.3.2.1.cmml" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.3">subscript</csymbol><ci id="S3.SS1.SSS2.Px2.p1.8.m4.2.3.2.2.cmml" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.3.2.2">italic-ϕ</ci><list id="S3.SS1.SSS2.Px2.p1.8.m4.2.2.2.3.cmml" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.2.2.4"><ci id="S3.SS1.SSS2.Px2.p1.8.m4.1.1.1.1.cmml" xref="S3.SS1.SSS2.Px2.p1.8.m4.1.1.1.1">𝑟</ci><ci id="S3.SS1.SSS2.Px2.p1.8.m4.2.2.2.2.cmml" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.2.2.2">𝐾</ci></list></apply><ci id="S3.SS1.SSS2.Px2.p1.8.m4.2.3.3.cmml" xref="S3.SS1.SSS2.Px2.p1.8.m4.2.3.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px2.p1.8.m4.2c">\phi_{r,K}^{m}</annotation></semantics></math> back to the server.</p>
</div>
</section>
<section id="S3.SS1.SSS2.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Step 3: Global Aggregation.</h5>

<div id="S3.SS1.SSS2.Px3.p1" class="ltx_para">
<p id="S3.SS1.SSS2.Px3.p1.1" class="ltx_p">After receiving the local selectors from the sampled clients <math id="S3.SS1.SSS2.Px3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S3.SS1.SSS2.Px3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.Px3.p1.1.m1.1.1" xref="S3.SS1.SSS2.Px3.p1.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px3.p1.1.m1.1b"><ci id="S3.SS1.SSS2.Px3.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS2.Px3.p1.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px3.p1.1.m1.1c">\mathcal{A}</annotation></semantics></math>, the server updates the global selector:</p>
<table id="A2.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.3" class="ltx_Math" alttext="\displaystyle\phi_{r+1}=\frac{M}{A}\sum_{m\in\mathcal{A}}p_{m}\phi_{r,K}^{m}." display="inline"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml"><mi id="S3.E4.m1.3.3.1.1.2.2" xref="S3.E4.m1.3.3.1.1.2.2.cmml">ϕ</mi><mrow id="S3.E4.m1.3.3.1.1.2.3" xref="S3.E4.m1.3.3.1.1.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.2.3.2" xref="S3.E4.m1.3.3.1.1.2.3.2.cmml">r</mi><mo id="S3.E4.m1.3.3.1.1.2.3.1" xref="S3.E4.m1.3.3.1.1.2.3.1.cmml">+</mo><mn id="S3.E4.m1.3.3.1.1.2.3.3" xref="S3.E4.m1.3.3.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E4.m1.3.3.1.1.3.2" xref="S3.E4.m1.3.3.1.1.3.2.cmml"><mfrac id="S3.E4.m1.3.3.1.1.3.2a" xref="S3.E4.m1.3.3.1.1.3.2.cmml"><mi id="S3.E4.m1.3.3.1.1.3.2.2" xref="S3.E4.m1.3.3.1.1.3.2.2.cmml">M</mi><mi id="S3.E4.m1.3.3.1.1.3.2.3" xref="S3.E4.m1.3.3.1.1.3.2.3.cmml">A</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.3.1" xref="S3.E4.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.3.3" xref="S3.E4.m1.3.3.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E4.m1.3.3.1.1.3.3.1" xref="S3.E4.m1.3.3.1.1.3.3.1.cmml"><munder id="S3.E4.m1.3.3.1.1.3.3.1a" xref="S3.E4.m1.3.3.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E4.m1.3.3.1.1.3.3.1.2" xref="S3.E4.m1.3.3.1.1.3.3.1.2.cmml">∑</mo><mrow id="S3.E4.m1.3.3.1.1.3.3.1.3" xref="S3.E4.m1.3.3.1.1.3.3.1.3.cmml"><mi id="S3.E4.m1.3.3.1.1.3.3.1.3.2" xref="S3.E4.m1.3.3.1.1.3.3.1.3.2.cmml">m</mi><mo id="S3.E4.m1.3.3.1.1.3.3.1.3.1" xref="S3.E4.m1.3.3.1.1.3.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.1.1.3.3.1.3.3" xref="S3.E4.m1.3.3.1.1.3.3.1.3.3.cmml">𝒜</mi></mrow></munder></mstyle><mrow id="S3.E4.m1.3.3.1.1.3.3.2" xref="S3.E4.m1.3.3.1.1.3.3.2.cmml"><msub id="S3.E4.m1.3.3.1.1.3.3.2.2" xref="S3.E4.m1.3.3.1.1.3.3.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.3.3.2.2.2" xref="S3.E4.m1.3.3.1.1.3.3.2.2.2.cmml">p</mi><mi id="S3.E4.m1.3.3.1.1.3.3.2.2.3" xref="S3.E4.m1.3.3.1.1.3.3.2.2.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.3.3.2.1" xref="S3.E4.m1.3.3.1.1.3.3.2.1.cmml">​</mo><msubsup id="S3.E4.m1.3.3.1.1.3.3.2.3" xref="S3.E4.m1.3.3.1.1.3.3.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.3.3.2.3.2.2" xref="S3.E4.m1.3.3.1.1.3.3.2.3.2.2.cmml">ϕ</mi><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">r</mi><mo id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">K</mi></mrow><mi id="S3.E4.m1.3.3.1.1.3.3.2.3.3" xref="S3.E4.m1.3.3.1.1.3.3.2.3.3.cmml">m</mi></msubsup></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1"><eq id="S3.E4.m1.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"></eq><apply id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2">italic-ϕ</ci><apply id="S3.E4.m1.3.3.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.3"><plus id="S3.E4.m1.3.3.1.1.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.2.3.1"></plus><ci id="S3.E4.m1.3.3.1.1.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.2.3.2">𝑟</ci><cn type="integer" id="S3.E4.m1.3.3.1.1.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E4.m1.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3"><times id="S3.E4.m1.3.3.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.1"></times><apply id="S3.E4.m1.3.3.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2"><divide id="S3.E4.m1.3.3.1.1.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2"></divide><ci id="S3.E4.m1.3.3.1.1.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2">𝑀</ci><ci id="S3.E4.m1.3.3.1.1.3.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.3">𝐴</ci></apply><apply id="S3.E4.m1.3.3.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3"><apply id="S3.E4.m1.3.3.1.1.3.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.1">subscript</csymbol><sum id="S3.E4.m1.3.3.1.1.3.3.1.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.1.2"></sum><apply id="S3.E4.m1.3.3.1.1.3.3.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.1.3"><in id="S3.E4.m1.3.3.1.1.3.3.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.1.3.1"></in><ci id="S3.E4.m1.3.3.1.1.3.3.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.1.3.2">𝑚</ci><ci id="S3.E4.m1.3.3.1.1.3.3.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.1.3.3">𝒜</ci></apply></apply><apply id="S3.E4.m1.3.3.1.1.3.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2"><times id="S3.E4.m1.3.3.1.1.3.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.1"></times><apply id="S3.E4.m1.3.3.1.1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.3.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.2.2">𝑝</ci><ci id="S3.E4.m1.3.3.1.1.3.3.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.2.3">𝑚</ci></apply><apply id="S3.E4.m1.3.3.1.1.3.3.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.3">superscript</csymbol><apply id="S3.E4.m1.3.3.1.1.3.3.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.2.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.3.2.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.3.2.2">italic-ϕ</ci><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑟</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝐾</ci></list></apply><ci id="S3.E4.m1.3.3.1.1.3.3.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.3.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">\displaystyle\phi_{r+1}=\frac{M}{A}\sum_{m\in\mathcal{A}}p_{m}\phi_{r,K}^{m}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS2.Px3.p1.2" class="ltx_p">This aggregation method, based on <cite class="ltx_cite ltx_citemacro_citet">Li et al. (<a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite> where the clients are uniformly sampled to train a global model, ensures consistency with Problem (<a href="#S3.E1" title="In 3.1.1 Problem Formulation. ‣ 3.1 Preference Modeling ‣ 3 FedBis: A Feasible Framework for Achieving RLHF in FL ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) in mathematical expectation.</p>
</div>
<div id="S3.SS1.SSS2.Px3.p2" class="ltx_para">
<p id="S3.SS1.SSS2.Px3.p2.3" class="ltx_p">After <math id="S3.SS1.SSS2.Px3.p2.1.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS1.SSS2.Px3.p2.1.m1.1a"><mi id="S3.SS1.SSS2.Px3.p2.1.m1.1.1" xref="S3.SS1.SSS2.Px3.p2.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px3.p2.1.m1.1b"><ci id="S3.SS1.SSS2.Px3.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS2.Px3.p2.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px3.p2.1.m1.1c">R</annotation></semantics></math> communication rounds of training, <span id="S3.SS1.SSS2.Px3.p2.3.1" class="ltx_text ltx_markedasmath">FedBis</span> outputs a binary selector <math id="S3.SS1.SSS2.Px3.p2.3.m3.1" class="ltx_Math" alttext="\phi_{R}" display="inline"><semantics id="S3.SS1.SSS2.Px3.p2.3.m3.1a"><msub id="S3.SS1.SSS2.Px3.p2.3.m3.1.1" xref="S3.SS1.SSS2.Px3.p2.3.m3.1.1.cmml"><mi id="S3.SS1.SSS2.Px3.p2.3.m3.1.1.2" xref="S3.SS1.SSS2.Px3.p2.3.m3.1.1.2.cmml">ϕ</mi><mi id="S3.SS1.SSS2.Px3.p2.3.m3.1.1.3" xref="S3.SS1.SSS2.Px3.p2.3.m3.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.Px3.p2.3.m3.1b"><apply id="S3.SS1.SSS2.Px3.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS2.Px3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.Px3.p2.3.m3.1.1.1.cmml" xref="S3.SS1.SSS2.Px3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.Px3.p2.3.m3.1.1.2.cmml" xref="S3.SS1.SSS2.Px3.p2.3.m3.1.1.2">italic-ϕ</ci><ci id="S3.SS1.SSS2.Px3.p2.3.m3.1.1.3.cmml" xref="S3.SS1.SSS2.Px3.p2.3.m3.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.Px3.p2.3.m3.1c">\phi_{R}</annotation></semantics></math> that reflects the overall preferences of all clients. The selector can then be used to enhance the performance of the LLM, as discussed in the next section.</p>
</div>
</section>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Reinforcement-learning Fine-tuning</h3>

<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Problem Formulation.</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.1" class="ltx_p">Traditionally, reinforcement-learning fine-tuning adopts PPO algorithm <cite class="ltx_cite ltx_citemacro_cite">Schulman et al. (<a href="#bib.bib35" title="" class="ltx_ref">2017</a>)</cite> to enhance the performance of an LLM using a reward model that can rate a completion <cite class="ltx_cite ltx_citemacro_cite">Stiennon et al. (<a href="#bib.bib37" title="" class="ltx_ref">2020</a>); Ouyang et al. (<a href="#bib.bib32" title="" class="ltx_ref">2022</a>); Dai et al. (<a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite>, which does not fit the proposed framework with a binary selector.</p>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para">
<p id="S3.SS2.SSS1.p2.7" class="ltx_p">One practical approach to aligning the LLM with clients’ preferences is to create a preference dataset with the help of the binary selector. Suppose the server holds a set of instructions <math id="S3.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\hat{\mathcal{D}}" display="inline"><semantics id="S3.SS2.SSS1.p2.1.m1.1a"><mover accent="true" id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.1.m1.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml">𝒟</mi><mo id="S3.SS2.SSS1.p2.1.m1.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.1b"><apply id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1"><ci id="S3.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1">^</ci><ci id="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.2">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.1c">\hat{\mathcal{D}}</annotation></semantics></math>, and we can expand it to a preference dataset <math id="S3.SS2.SSS1.p2.2.m2.4" class="ltx_Math" alttext="\mathcal{D}_{gen}=\{(x,y_{0},y_{1},i)|x\in\hat{\mathcal{D}}\}" display="inline"><semantics id="S3.SS2.SSS1.p2.2.m2.4a"><mrow id="S3.SS2.SSS1.p2.2.m2.4.4" xref="S3.SS2.SSS1.p2.2.m2.4.4.cmml"><msub id="S3.SS2.SSS1.p2.2.m2.4.4.4" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.2.m2.4.4.4.2" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.2.cmml">𝒟</mi><mrow id="S3.SS2.SSS1.p2.2.m2.4.4.4.3" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.3.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.4.4.4.3.2" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.2.m2.4.4.4.3.1" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.3.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.2.m2.4.4.4.3.3" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.2.m2.4.4.4.3.1a" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.3.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.2.m2.4.4.4.3.4" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.3.4.cmml">n</mi></mrow></msub><mo id="S3.SS2.SSS1.p2.2.m2.4.4.3" xref="S3.SS2.SSS1.p2.2.m2.4.4.3.cmml">=</mo><mrow id="S3.SS2.SSS1.p2.2.m2.4.4.2.2" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.3" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.3.1.cmml">{</mo><mrow id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.3" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.3.cmml">(</mo><mi id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml">x</mi><mo id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.4" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.3.cmml">,</mo><msub id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1.2.cmml">y</mi><mn id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.5" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.3.cmml">,</mo><msub id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2.2" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2.2.cmml">y</mi><mn id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2.3" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.6" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.3.cmml">,</mo><mi id="S3.SS2.SSS1.p2.2.m2.2.2" xref="S3.SS2.SSS1.p2.2.m2.2.2.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.7" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.4" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.3.1.cmml">|</mo><mrow id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.2" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.2.cmml">x</mi><mo id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.1" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.1.cmml">∈</mo><mover accent="true" id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.3" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.3.2" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.3.2.cmml">𝒟</mi><mo id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.3.1" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.3.1.cmml">^</mo></mover></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.5" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.4b"><apply id="S3.SS2.SSS1.p2.2.m2.4.4.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4"><eq id="S3.SS2.SSS1.p2.2.m2.4.4.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.3"></eq><apply id="S3.SS2.SSS1.p2.2.m2.4.4.4.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.4.4.4.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.4">subscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.4.4.4.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.2">𝒟</ci><apply id="S3.SS2.SSS1.p2.2.m2.4.4.4.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.3"><times id="S3.SS2.SSS1.p2.2.m2.4.4.4.3.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.3.1"></times><ci id="S3.SS2.SSS1.p2.2.m2.4.4.4.3.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.3.2">𝑔</ci><ci id="S3.SS2.SSS1.p2.2.m2.4.4.4.3.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.3.3">𝑒</ci><ci id="S3.SS2.SSS1.p2.2.m2.4.4.4.3.4.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.4.3.4">𝑛</ci></apply></apply><apply id="S3.SS2.SSS1.p2.2.m2.4.4.2.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.2.m2.4.4.2.3.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.3">conditional-set</csymbol><vector id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2"><ci id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">𝑥</ci><apply id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1.2">𝑦</ci><cn type="integer" id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.1.1.3">0</cn></apply><apply id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2.2">𝑦</ci><cn type="integer" id="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.3.3.1.1.1.2.2.3">1</cn></apply><ci id="S3.SS2.SSS1.p2.2.m2.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2">𝑖</ci></vector><apply id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2"><in id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.1"></in><ci id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.2">𝑥</ci><apply id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.3"><ci id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.3.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.3.1">^</ci><ci id="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.3.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.4.4.2.2.2.3.2">𝒟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.4c">\mathcal{D}_{gen}=\{(x,y_{0},y_{1},i)|x\in\hat{\mathcal{D}}\}</annotation></semantics></math>, where <math id="S3.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="y_{0}" display="inline"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><msub id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p2.3.m3.1.1.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml">y</mi><mn id="S3.SS2.SSS1.p2.3.m3.1.1.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><apply id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.2">𝑦</ci><cn type="integer" id="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">y_{0}</annotation></semantics></math> and <math id="S3.SS2.SSS1.p2.4.m4.1" class="ltx_Math" alttext="y_{1}" display="inline"><semantics id="S3.SS2.SSS1.p2.4.m4.1a"><msub id="S3.SS2.SSS1.p2.4.m4.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.1.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml">y</mi><mn id="S3.SS2.SSS1.p2.4.m4.1.1.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.4.m4.1b"><apply id="S3.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.2">𝑦</ci><cn type="integer" id="S3.SS2.SSS1.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.1c">y_{1}</annotation></semantics></math> are two completions generated by the LLM <math id="S3.SS2.SSS1.p2.5.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS2.SSS1.p2.5.m5.1a"><mi id="S3.SS2.SSS1.p2.5.m5.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.5.m5.1b"><ci id="S3.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m5.1c">\theta</annotation></semantics></math>, and <math id="S3.SS2.SSS1.p2.6.m6.2" class="ltx_Math" alttext="i\in\{0,1\}" display="inline"><semantics id="S3.SS2.SSS1.p2.6.m6.2a"><mrow id="S3.SS2.SSS1.p2.6.m6.2.3" xref="S3.SS2.SSS1.p2.6.m6.2.3.cmml"><mi id="S3.SS2.SSS1.p2.6.m6.2.3.2" xref="S3.SS2.SSS1.p2.6.m6.2.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p2.6.m6.2.3.1" xref="S3.SS2.SSS1.p2.6.m6.2.3.1.cmml">∈</mo><mrow id="S3.SS2.SSS1.p2.6.m6.2.3.3.2" xref="S3.SS2.SSS1.p2.6.m6.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.6.m6.2.3.3.2.1" xref="S3.SS2.SSS1.p2.6.m6.2.3.3.1.cmml">{</mo><mn id="S3.SS2.SSS1.p2.6.m6.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.cmml">0</mn><mo id="S3.SS2.SSS1.p2.6.m6.2.3.3.2.2" xref="S3.SS2.SSS1.p2.6.m6.2.3.3.1.cmml">,</mo><mn id="S3.SS2.SSS1.p2.6.m6.2.2" xref="S3.SS2.SSS1.p2.6.m6.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS2.SSS1.p2.6.m6.2.3.3.2.3" xref="S3.SS2.SSS1.p2.6.m6.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.6.m6.2b"><apply id="S3.SS2.SSS1.p2.6.m6.2.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.2.3"><in id="S3.SS2.SSS1.p2.6.m6.2.3.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.2.3.1"></in><ci id="S3.SS2.SSS1.p2.6.m6.2.3.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.2.3.2">𝑖</ci><set id="S3.SS2.SSS1.p2.6.m6.2.3.3.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.2.3.3.2"><cn type="integer" id="S3.SS2.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1">0</cn><cn type="integer" id="S3.SS2.SSS1.p2.6.m6.2.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.6.m6.2c">i\in\{0,1\}</annotation></semantics></math> indicates the preferred completion as chosen by the binary selector <math id="S3.SS2.SSS1.p2.7.m7.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS2.SSS1.p2.7.m7.1a"><mi id="S3.SS2.SSS1.p2.7.m7.1.1" xref="S3.SS2.SSS1.p2.7.m7.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.7.m7.1b"><ci id="S3.SS2.SSS1.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.7.m7.1c">\phi</annotation></semantics></math>. With this generated dataset, we apply the Direct Preference Optimization (DPO) algorithm <cite class="ltx_cite ltx_citemacro_cite">Rafailov et al. (<a href="#bib.bib33" title="" class="ltx_ref">2023</a>)</cite> to optimize the LLM consistent with clients’ preferences, which is formulated as</p>
<table id="A2.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m1.4" class="ltx_Math" alttext="\displaystyle\min_{\theta}\mathbb{E}_{\begin{subarray}{c}(x,y_{0},y_{1},i)\sim{\mathcal{D}_{gen}}\end{subarray}}\mathcal{L}_{DPO}\left(\theta|x,y_{0},y_{1},i\right)" display="inline"><semantics id="S3.E5.m1.4a"><mrow id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml"><mrow id="S3.E5.m1.4.4.3" xref="S3.E5.m1.4.4.3.cmml"><munder id="S3.E5.m1.4.4.3.1" xref="S3.E5.m1.4.4.3.1.cmml"><mi id="S3.E5.m1.4.4.3.1.2" xref="S3.E5.m1.4.4.3.1.2.cmml">min</mi><mi id="S3.E5.m1.4.4.3.1.3" xref="S3.E5.m1.4.4.3.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S3.E5.m1.4.4.3a" xref="S3.E5.m1.4.4.3.cmml">⁡</mo><mrow id="S3.E5.m1.4.4.3.2" xref="S3.E5.m1.4.4.3.2.cmml"><msub id="S3.E5.m1.4.4.3.2.2" xref="S3.E5.m1.4.4.3.2.2.cmml"><mi id="S3.E5.m1.4.4.3.2.2.2" xref="S3.E5.m1.4.4.3.2.2.2.cmml">𝔼</mi><mtable id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1a.2.cmml"><mtr id="S3.E5.m1.1.1.1.1.1.1a" xref="S3.E5.m1.1.1.1a.2.cmml"><mtd id="S3.E5.m1.1.1.1.1.1.1b" xref="S3.E5.m1.1.1.1a.2.cmml"><mrow id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.cmml"><mrow id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.3.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.3" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.3.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">x</mi><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.4" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.3.cmml">,</mo><msub id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1" xref="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.2.cmml">y</mi><mn id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.3.cmml">0</mn></msub><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.5" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.3.cmml">,</mo><msub id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2.2" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2.2.cmml">y</mi><mn id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2.3" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2.3.cmml">1</mn></msub><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.6" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.3.cmml">,</mo><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">i</mi><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.7" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.3.cmml">)</mo></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.5" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.5.cmml">∼</mo><msub id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.2" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.2.cmml">𝒟</mi><mrow id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.2" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.1" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.3" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.1a" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.4" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.4.cmml">n</mi></mrow></msub></mrow></mtd></mtr></mtable></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.4.3.2.1" xref="S3.E5.m1.4.4.3.2.1.cmml">​</mo><msub id="S3.E5.m1.4.4.3.2.3" xref="S3.E5.m1.4.4.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.4.3.2.3.2" xref="S3.E5.m1.4.4.3.2.3.2.cmml">ℒ</mi><mrow id="S3.E5.m1.4.4.3.2.3.3" xref="S3.E5.m1.4.4.3.2.3.3.cmml"><mi id="S3.E5.m1.4.4.3.2.3.3.2" xref="S3.E5.m1.4.4.3.2.3.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.4.3.2.3.3.1" xref="S3.E5.m1.4.4.3.2.3.3.1.cmml">​</mo><mi id="S3.E5.m1.4.4.3.2.3.3.3" xref="S3.E5.m1.4.4.3.2.3.3.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.4.3.2.3.3.1a" xref="S3.E5.m1.4.4.3.2.3.3.1.cmml">​</mo><mi id="S3.E5.m1.4.4.3.2.3.3.4" xref="S3.E5.m1.4.4.3.2.3.3.4.cmml">O</mi></mrow></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.4.2" xref="S3.E5.m1.4.4.2.cmml">​</mo><mrow id="S3.E5.m1.4.4.1.1" xref="S3.E5.m1.4.4.1.1.1.cmml"><mo id="S3.E5.m1.4.4.1.1.2" xref="S3.E5.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.4.4.1.1.1" xref="S3.E5.m1.4.4.1.1.1.cmml"><mi id="S3.E5.m1.4.4.1.1.1.4" xref="S3.E5.m1.4.4.1.1.1.4.cmml">θ</mi><mo fence="false" id="S3.E5.m1.4.4.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.3.cmml">|</mo><mrow id="S3.E5.m1.4.4.1.1.1.2.2" xref="S3.E5.m1.4.4.1.1.1.2.3.cmml"><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">x</mi><mo id="S3.E5.m1.4.4.1.1.1.2.2.3" xref="S3.E5.m1.4.4.1.1.1.2.3.cmml">,</mo><msub id="S3.E5.m1.4.4.1.1.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.cmml">y</mi><mn id="S3.E5.m1.4.4.1.1.1.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E5.m1.4.4.1.1.1.2.2.4" xref="S3.E5.m1.4.4.1.1.1.2.3.cmml">,</mo><msub id="S3.E5.m1.4.4.1.1.1.2.2.2" xref="S3.E5.m1.4.4.1.1.1.2.2.2.cmml"><mi id="S3.E5.m1.4.4.1.1.1.2.2.2.2" xref="S3.E5.m1.4.4.1.1.1.2.2.2.2.cmml">y</mi><mn id="S3.E5.m1.4.4.1.1.1.2.2.2.3" xref="S3.E5.m1.4.4.1.1.1.2.2.2.3.cmml">1</mn></msub><mo id="S3.E5.m1.4.4.1.1.1.2.2.5" xref="S3.E5.m1.4.4.1.1.1.2.3.cmml">,</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">i</mi></mrow></mrow><mo id="S3.E5.m1.4.4.1.1.3" xref="S3.E5.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.4b"><apply id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4"><times id="S3.E5.m1.4.4.2.cmml" xref="S3.E5.m1.4.4.2"></times><apply id="S3.E5.m1.4.4.3.cmml" xref="S3.E5.m1.4.4.3"><apply id="S3.E5.m1.4.4.3.1.cmml" xref="S3.E5.m1.4.4.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.3.1.1.cmml" xref="S3.E5.m1.4.4.3.1">subscript</csymbol><min id="S3.E5.m1.4.4.3.1.2.cmml" xref="S3.E5.m1.4.4.3.1.2"></min><ci id="S3.E5.m1.4.4.3.1.3.cmml" xref="S3.E5.m1.4.4.3.1.3">𝜃</ci></apply><apply id="S3.E5.m1.4.4.3.2.cmml" xref="S3.E5.m1.4.4.3.2"><times id="S3.E5.m1.4.4.3.2.1.cmml" xref="S3.E5.m1.4.4.3.2.1"></times><apply id="S3.E5.m1.4.4.3.2.2.cmml" xref="S3.E5.m1.4.4.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.3.2.2.1.cmml" xref="S3.E5.m1.4.4.3.2.2">subscript</csymbol><ci id="S3.E5.m1.4.4.3.2.2.2.cmml" xref="S3.E5.m1.4.4.3.2.2.2">𝔼</ci><list id="S3.E5.m1.1.1.1a.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><matrix id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><matrixrow id="S3.E5.m1.1.1.1.1.1.1a.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><apply id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.5.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.5">similar-to</csymbol><vector id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2"><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1">𝑥</ci><apply id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.2">𝑦</ci><cn type="integer" id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.3">0</cn></apply><apply id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2.2">𝑦</ci><cn type="integer" id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2.3">1</cn></apply><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.2.2">𝑖</ci></vector><apply id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.2">𝒟</ci><apply id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3"><times id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.1"></times><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.2">𝑔</ci><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.3">𝑒</ci><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.6.3.4">𝑛</ci></apply></apply></apply></matrixrow></matrix></list></apply><apply id="S3.E5.m1.4.4.3.2.3.cmml" xref="S3.E5.m1.4.4.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.3.2.3.1.cmml" xref="S3.E5.m1.4.4.3.2.3">subscript</csymbol><ci id="S3.E5.m1.4.4.3.2.3.2.cmml" xref="S3.E5.m1.4.4.3.2.3.2">ℒ</ci><apply id="S3.E5.m1.4.4.3.2.3.3.cmml" xref="S3.E5.m1.4.4.3.2.3.3"><times id="S3.E5.m1.4.4.3.2.3.3.1.cmml" xref="S3.E5.m1.4.4.3.2.3.3.1"></times><ci id="S3.E5.m1.4.4.3.2.3.3.2.cmml" xref="S3.E5.m1.4.4.3.2.3.3.2">𝐷</ci><ci id="S3.E5.m1.4.4.3.2.3.3.3.cmml" xref="S3.E5.m1.4.4.3.2.3.3.3">𝑃</ci><ci id="S3.E5.m1.4.4.3.2.3.3.4.cmml" xref="S3.E5.m1.4.4.3.2.3.3.4">𝑂</ci></apply></apply></apply></apply><apply id="S3.E5.m1.4.4.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1"><csymbol cd="latexml" id="S3.E5.m1.4.4.1.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.1.3">conditional</csymbol><ci id="S3.E5.m1.4.4.1.1.1.4.cmml" xref="S3.E5.m1.4.4.1.1.1.4">𝜃</ci><list id="S3.E5.m1.4.4.1.1.1.2.3.cmml" xref="S3.E5.m1.4.4.1.1.1.2.2"><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝑥</ci><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2">𝑦</ci><cn type="integer" id="S3.E5.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3">0</cn></apply><apply id="S3.E5.m1.4.4.1.1.1.2.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.2.2.2.2">𝑦</ci><cn type="integer" id="S3.E5.m1.4.4.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.4.4.1.1.1.2.2.2.3">1</cn></apply><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝑖</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.4c">\displaystyle\min_{\theta}\mathbb{E}_{\begin{subarray}{c}(x,y_{0},y_{1},i)\sim{\mathcal{D}_{gen}}\end{subarray}}\mathcal{L}_{DPO}\left(\theta|x,y_{0},y_{1},i\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p2.8" class="ltx_p">where the DPO loss is <math id="S3.SS2.SSS1.p2.8.m1.8" class="ltx_Math" alttext="\mathcal{L}_{DPO}\left(\theta|x,y_{0},y_{1},i\right)=-\log\sigma\left(\beta\log\frac{\pi_{\theta}(y_{i}|x)}{\pi_{\theta_{0}}(y_{i}|x)}-\beta\log\frac{\pi_{\theta}(y_{1-i}|x)}{\pi_{\theta_{0}}(y_{1-i}|x)}\right)" display="inline"><semantics id="S3.SS2.SSS1.p2.8.m1.8a"><mrow id="S3.SS2.SSS1.p2.8.m1.8.8" xref="S3.SS2.SSS1.p2.8.m1.8.8.cmml"><mrow id="S3.SS2.SSS1.p2.8.m1.7.7.1" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.cmml"><msub id="S3.SS2.SSS1.p2.8.m1.7.7.1.3" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.2" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.2.cmml">ℒ</mi><mrow id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.2" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.1" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.3" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.1a" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.4" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.4.cmml">O</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.8.m1.7.7.1.2" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.4" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.4.cmml">θ</mi><mo fence="false" id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.3.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.5.5" xref="S3.SS2.SSS1.p2.8.m1.5.5.cmml">x</mi><mo id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.3" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.4" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2.2" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2.2.cmml">y</mi><mn id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2.3" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.5" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.3.cmml">,</mo><mi id="S3.SS2.SSS1.p2.8.m1.6.6" xref="S3.SS2.SSS1.p2.8.m1.6.6.cmml">i</mi></mrow></mrow><mo id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS1.p2.8.m1.8.8.3" xref="S3.SS2.SSS1.p2.8.m1.8.8.3.cmml">=</mo><mrow id="S3.SS2.SSS1.p2.8.m1.8.8.2" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.cmml"><mo rspace="0.167em" id="S3.SS2.SSS1.p2.8.m1.8.8.2a" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.cmml">−</mo><mrow id="S3.SS2.SSS1.p2.8.m1.8.8.2.1" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.cmml"><mrow id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3.1" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3a" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3.cmml">⁡</mo><mi id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3.2" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3.2.cmml">σ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.2" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.cmml"><mrow id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.2" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.2.cmml">β</mi><mo lspace="0.167em" rspace="0em" id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.1" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.3" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.3.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.3.1" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.3a" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.3.cmml">⁡</mo><mfrac id="S3.SS2.SSS1.p2.8.m1.2.2" xref="S3.SS2.SSS1.p2.8.m1.2.2.cmml"><mrow id="S3.SS2.SSS1.p2.8.m1.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.cmml"><msub id="S3.SS2.SSS1.p2.8.m1.1.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.1.1.1.3.2" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.3.2.cmml">π</mi><mi id="S3.SS2.SSS1.p2.8.m1.1.1.1.3.3" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.8.m1.1.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.cmml"><msub id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2.3" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.SS2.SSS1.p2.8.m1.2.2.2" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.cmml"><msub id="S3.SS2.SSS1.p2.8.m1.2.2.2.3" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.3.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.2.2.2.3.2" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.3.2.cmml">π</mi><msub id="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3.2" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3.2.cmml">θ</mi><mn id="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3.3" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3.3.cmml">0</mn></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.8.m1.2.2.2.2" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.cmml"><msub id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2.2" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2.2.cmml">y</mi><mi id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2.3" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.1.cmml">−</mo><mrow id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.2" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.2.cmml">β</mi><mo lspace="0.167em" rspace="0em" id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.1" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.3" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.3.1" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.3a" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.3.cmml">⁡</mo><mfrac id="S3.SS2.SSS1.p2.8.m1.4.4" xref="S3.SS2.SSS1.p2.8.m1.4.4.cmml"><mrow id="S3.SS2.SSS1.p2.8.m1.3.3.1" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.cmml"><msub id="S3.SS2.SSS1.p2.8.m1.3.3.1.3" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.3.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.3.3.1.3.2" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.3.2.cmml">π</mi><mi id="S3.SS2.SSS1.p2.8.m1.3.3.1.3.3" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.8.m1.3.3.1.2" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.cmml"><msub id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.2" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.cmml"><mn id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.2" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.2.cmml">1</mn><mo id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.1" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.1.cmml">−</mo><mi id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.3" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.SS2.SSS1.p2.8.m1.4.4.2" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.cmml"><msub id="S3.SS2.SSS1.p2.8.m1.4.4.2.3" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.3.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.4.4.2.3.2" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.3.2.cmml">π</mi><msub id="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3.2" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3.2.cmml">θ</mi><mn id="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3.3" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3.3.cmml">0</mn></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.8.m1.4.4.2.2" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.cmml"><msub id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.2" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.2.cmml">y</mi><mrow id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.cmml"><mn id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.2" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.2.cmml">1</mn><mo id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.1" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.1.cmml">−</mo><mi id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.3" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.1" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.1.cmml">|</mo><mi id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.3" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.8.m1.8b"><apply id="S3.SS2.SSS1.p2.8.m1.8.8.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8"><eq id="S3.SS2.SSS1.p2.8.m1.8.8.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.3"></eq><apply id="S3.SS2.SSS1.p2.8.m1.7.7.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1"><times id="S3.SS2.SSS1.p2.8.m1.7.7.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.2"></times><apply id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.2">ℒ</ci><apply id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3"><times id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.1"></times><ci id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.2">𝐷</ci><ci id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.3">𝑃</ci><ci id="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.4.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.3.3.4">𝑂</ci></apply></apply><apply id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.3">conditional</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.4">𝜃</ci><list id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2"><ci id="S3.SS2.SSS1.p2.8.m1.5.5.cmml" xref="S3.SS2.SSS1.p2.8.m1.5.5">𝑥</ci><apply id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1.2">𝑦</ci><cn type="integer" id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.1.1.1.3">0</cn></apply><apply id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2.2">𝑦</ci><cn type="integer" id="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.7.7.1.1.1.1.2.2.2.3">1</cn></apply><ci id="S3.SS2.SSS1.p2.8.m1.6.6.cmml" xref="S3.SS2.SSS1.p2.8.m1.6.6">𝑖</ci></list></apply></apply><apply id="S3.SS2.SSS1.p2.8.m1.8.8.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2"><minus id="S3.SS2.SSS1.p2.8.m1.8.8.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2"></minus><apply id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1"><times id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.2"></times><apply id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3"><log id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3.1"></log><ci id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.3.2">𝜎</ci></apply><apply id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1"><minus id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.1"></minus><apply id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2"><times id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.1"></times><ci id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.2">𝛽</ci><apply id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.3"><log id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.2.3.1"></log><apply id="S3.SS2.SSS1.p2.8.m1.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2"><divide id="S3.SS2.SSS1.p2.8.m1.2.2.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2"></divide><apply id="S3.SS2.SSS1.p2.8.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1"><times id="S3.SS2.SSS1.p2.8.m1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.2"></times><apply id="S3.SS2.SSS1.p2.8.m1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.3.2">𝜋</ci><ci id="S3.SS2.SSS1.p2.8.m1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.SS2.SSS1.p2.8.m1.2.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2"><times id="S3.SS2.SSS1.p2.8.m1.2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.2"></times><apply id="S3.SS2.SSS1.p2.8.m1.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.2.2.2.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.2.2.2.3.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.3.2">𝜋</ci><apply id="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3.2">𝜃</ci><cn type="integer" id="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.3.3.3">0</cn></apply></apply><apply id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.1">conditional</csymbol><apply id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2.2">𝑦</ci><ci id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3"><times id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.1"></times><ci id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.2">𝛽</ci><apply id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.3"><log id="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.8.8.2.1.1.1.1.3.3.1"></log><apply id="S3.SS2.SSS1.p2.8.m1.4.4.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4"><divide id="S3.SS2.SSS1.p2.8.m1.4.4.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4"></divide><apply id="S3.SS2.SSS1.p2.8.m1.3.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1"><times id="S3.SS2.SSS1.p2.8.m1.3.3.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.2"></times><apply id="S3.SS2.SSS1.p2.8.m1.3.3.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.3.3.1.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.3.3.1.3.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.3.2">𝜋</ci><ci id="S3.SS2.SSS1.p2.8.m1.3.3.1.3.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.3.3">𝜃</ci></apply><apply id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.2">𝑦</ci><apply id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3"><minus id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.1"></minus><cn type="integer" id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.2">1</cn><ci id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.3.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.SS2.SSS1.p2.8.m1.4.4.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2"><times id="S3.SS2.SSS1.p2.8.m1.4.4.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.2"></times><apply id="S3.SS2.SSS1.p2.8.m1.4.4.2.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.4.4.2.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.4.4.2.3.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.3.2">𝜋</ci><apply id="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3.2">𝜃</ci><cn type="integer" id="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.3.3.3">0</cn></apply></apply><apply id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.1">conditional</csymbol><apply id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.2">𝑦</ci><apply id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3"><minus id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.1"></minus><cn type="integer" id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.2.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.2">1</cn><ci id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m1.4.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.8.m1.8c">\mathcal{L}_{DPO}\left(\theta|x,y_{0},y_{1},i\right)=-\log\sigma\left(\beta\log\frac{\pi_{\theta}(y_{i}|x)}{\pi_{\theta_{0}}(y_{i}|x)}-\beta\log\frac{\pi_{\theta}(y_{1-i}|x)}{\pi_{\theta_{0}}(y_{1-i}|x)}\right)</annotation></semantics></math>. Next we discuss the specifics of the preference data generation and LLM optimization.</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Algorithm Design</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.3" class="ltx_p">The reinforcement-learning fine-tuning takes place on the server and includes two phases: 1) a preference dataset is created with a pretrained LLM <math id="S3.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><msub id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml">θ</mi><mn id="S3.SS2.SSS2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2">𝜃</ci><cn type="integer" id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">\theta_{0}</annotation></semantics></math> and a well-trained selector <math id="S3.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\phi_{R}" display="inline"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><msub id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml">ϕ</mi><mi id="S3.SS2.SSS2.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><apply id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.2">italic-ϕ</ci><ci id="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">\phi_{R}</annotation></semantics></math> from <span id="S3.SS2.SSS2.p1.3.1" class="ltx_text ltx_markedasmath">FedBis</span>. 2) LLM is optimized according to the objective defined in Equation (<a href="#S3.E5" title="In 3.2.1 Problem Formulation. ‣ 3.2 Reinforcement-learning Fine-tuning ‣ 3 FedBis: A Feasible Framework for Achieving RLHF in FL ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) with the generated dataset.</p>
</div>
<section id="S3.SS2.SSS2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Step 1: Preference Dataset Generation.</h5>

<div id="S3.SS2.SSS2.Px1.p1" class="ltx_para">
<p id="S3.SS2.SSS2.Px1.p1.13" class="ltx_p">Suppose the server holds a set of instructions <math id="S3.SS2.SSS2.Px1.p1.1.m1.1" class="ltx_Math" alttext="\hat{\mathcal{D}}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.1.m1.1a"><mover accent="true" id="S3.SS2.SSS2.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.2.cmml">𝒟</mi><mo id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.1.m1.1b"><apply id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1"><ci id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1">^</ci><ci id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.2">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.1.m1.1c">\hat{\mathcal{D}}</annotation></semantics></math>. With the LLM <math id="S3.SS2.SSS2.Px1.p1.2.m2.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.2.m2.1a"><msub id="S3.SS2.SSS2.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.2.cmml">θ</mi><mn id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.2.m2.1b"><apply id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.2">𝜃</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.2.m2.1c">\theta_{0}</annotation></semantics></math>, we can generate multiple completions for an instruction <math id="S3.SS2.SSS2.Px1.p1.3.m3.1" class="ltx_Math" alttext="x\in\hat{\mathcal{D}}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.3.m3.1a"><mrow id="S3.SS2.SSS2.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.2.cmml">x</mi><mo id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.1" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.1.cmml">∈</mo><mover accent="true" id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.2.cmml">𝒟</mi><mo id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.1" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.3.m3.1b"><apply id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1"><in id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.1"></in><ci id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.2">𝑥</ci><apply id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3"><ci id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.1">^</ci><ci id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.3.2">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.3.m3.1c">x\in\hat{\mathcal{D}}</annotation></semantics></math>, resulting in a set of <math id="S3.SS2.SSS2.Px1.p1.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.4.m4.1a"><mi id="S3.SS2.SSS2.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.4.m4.1b"><ci id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.4.m4.1c">n</annotation></semantics></math> completions <math id="S3.SS2.SSS2.Px1.p1.5.m5.4" class="ltx_Math" alttext="(y_{0},\dots,y_{n-1})\sim\pi_{\theta_{0}}(y|x)" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.5.m5.4a"><mrow id="S3.SS2.SSS2.Px1.p1.5.m5.4.4" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.cmml"><mrow id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.3.cmml">(</mo><msub id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.2.cmml">y</mi><mn id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.4" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS2.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1.cmml">…</mi><mo id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.5" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.2.cmml">y</mi><mrow id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.2.cmml">n</mi><mo id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.1.cmml">−</mo><mn id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.6" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.3.cmml">)</mo></mrow><mo id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.4" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.4.cmml">∼</mo><mrow id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.cmml"><msub id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.2.cmml">π</mi><msub id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3.2.cmml">θ</mi><mn id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3.3.cmml">0</mn></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.1.cmml">|</mo><mi id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.5.m5.4b"><apply id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4"><csymbol cd="latexml" id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.4.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.4">similar-to</csymbol><vector id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2"><apply id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.2">𝑦</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.3">0</cn></apply><ci id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1">…</ci><apply id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.2">𝑦</ci><apply id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3"><minus id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.1"></minus><ci id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.2">𝑛</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.3.3.2.2.2.3.3">1</cn></apply></apply></vector><apply id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3"><times id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.2"></times><apply id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.2">𝜋</ci><apply id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3.2">𝜃</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.3.3.3">0</cn></apply></apply><apply id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.2">𝑦</ci><ci id="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.4.4.3.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.5.m5.4c">(y_{0},\dots,y_{n-1})\sim\pi_{\theta_{0}}(y|x)</annotation></semantics></math>. For each instruction, we can form a total of <math id="S3.SS2.SSS2.Px1.p1.6.m6.2" class="ltx_Math" alttext="\binom{n}{2}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.6.m6.2a"><mrow id="S3.SS2.SSS2.Px1.p1.6.m6.2.2.4" xref="S3.SS2.SSS2.Px1.p1.6.m6.2.2.3.cmml"><mo id="S3.SS2.SSS2.Px1.p1.6.m6.2.2.4.1" xref="S3.SS2.SSS2.Px1.p1.6.m6.2.2.3.1.cmml">(</mo><mfrac linethickness="0pt" id="S3.SS2.SSS2.Px1.p1.6.m6.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.6.m6.2.2.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.6.m6.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1.1.1.1.1.cmml">n</mi><mn id="S3.SS2.SSS2.Px1.p1.6.m6.2.2.2.2.2.1" xref="S3.SS2.SSS2.Px1.p1.6.m6.2.2.2.2.2.1.cmml">2</mn></mfrac><mo id="S3.SS2.SSS2.Px1.p1.6.m6.2.2.4.2" xref="S3.SS2.SSS2.Px1.p1.6.m6.2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.6.m6.2b"><apply id="S3.SS2.SSS2.Px1.p1.6.m6.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.6.m6.2.2.4"><csymbol cd="latexml" id="S3.SS2.SSS2.Px1.p1.6.m6.2.2.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.6.m6.2.2.4.1">binomial</csymbol><ci id="S3.SS2.SSS2.Px1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1.1.1.1.1">𝑛</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.6.m6.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.6.m6.2.2.2.2.2.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.6.m6.2c">\binom{n}{2}</annotation></semantics></math> pairs of completions. We then use the binary selector <math id="S3.SS2.SSS2.Px1.p1.7.m7.1" class="ltx_Math" alttext="\phi_{R}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.7.m7.1a"><msub id="S3.SS2.SSS2.Px1.p1.7.m7.1.1" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.2" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.2.cmml">ϕ</mi><mi id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.3" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.7.m7.1b"><apply id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.2">italic-ϕ</ci><ci id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.7.m7.1c">\phi_{R}</annotation></semantics></math> to choose the optimal completion for each pair <math id="S3.SS2.SSS2.Px1.p1.8.m8.2" class="ltx_Math" alttext="(y_{j},y_{l})" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.8.m8.2a"><mrow id="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2" xref="S3.SS2.SSS2.Px1.p1.8.m8.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.3" xref="S3.SS2.SSS2.Px1.p1.8.m8.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1.2.cmml">y</mi><mi id="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.4" xref="S3.SS2.SSS2.Px1.p1.8.m8.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2.2.cmml">y</mi><mi id="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2.3" xref="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.5" xref="S3.SS2.SSS2.Px1.p1.8.m8.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.8.m8.2b"><interval closure="open" id="S3.SS2.SSS2.Px1.p1.8.m8.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2"><apply id="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1.2">𝑦</ci><ci id="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2.2">𝑦</ci><ci id="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.8.m8.2.2.2.2.3">𝑙</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.8.m8.2c">(y_{j},y_{l})</annotation></semantics></math> where <math id="S3.SS2.SSS2.Px1.p1.9.m9.1" class="ltx_Math" alttext="0\leq j&lt;l\leq n-1" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.9.m9.1a"><mrow id="S3.SS2.SSS2.Px1.p1.9.m9.1.1" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.cmml"><mn id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2.cmml">0</mn><mo id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.cmml">≤</mo><mi id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.4" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.4.cmml">j</mi><mo id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.5" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.5.cmml">&lt;</mo><mi id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.6" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.6.cmml">l</mi><mo id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.7" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.7.cmml">≤</mo><mrow id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.cmml"><mi id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.2.cmml">n</mi><mo id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.1" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.1.cmml">−</mo><mn id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.3" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.9.m9.1b"><apply id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"><and id="S3.SS2.SSS2.Px1.p1.9.m9.1.1a.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"></and><apply id="S3.SS2.SSS2.Px1.p1.9.m9.1.1b.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"><leq id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3"></leq><cn type="integer" id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2">0</cn><ci id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.4.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.4">𝑗</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.9.m9.1.1c.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"><lt id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.5.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.5"></lt><share href="#S3.SS2.SSS2.Px1.p1.9.m9.1.1.4.cmml" id="S3.SS2.SSS2.Px1.p1.9.m9.1.1d.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"></share><ci id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.6.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.6">𝑙</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.9.m9.1.1e.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"><leq id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.7.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.7"></leq><share href="#S3.SS2.SSS2.Px1.p1.9.m9.1.1.6.cmml" id="S3.SS2.SSS2.Px1.p1.9.m9.1.1f.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"></share><apply id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8"><minus id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.1"></minus><ci id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.2.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.2">𝑛</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.3.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.8.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.9.m9.1c">0\leq j&lt;l\leq n-1</annotation></semantics></math>. The pair is labeled with <math id="S3.SS2.SSS2.Px1.p1.10.m10.1" class="ltx_Math" alttext="i=0" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.10.m10.1a"><mrow id="S3.SS2.SSS2.Px1.p1.10.m10.1.1" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.2" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.3" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.10.m10.1b"><apply id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1"><eq id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1"></eq><ci id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.2">𝑖</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.10.m10.1c">i=0</annotation></semantics></math> if the first logit output is greater than the second, i.e., <math id="S3.SS2.SSS2.Px1.p1.11.m11.4" class="ltx_Math" alttext="\pi_{\phi_{R}}(0|x,y_{j},y_{l})&gt;\pi_{\phi_{R}}(1|x,y_{j},y_{l})" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.11.m11.4a"><mrow id="S3.SS2.SSS2.Px1.p1.11.m11.4.4" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.cmml"><mrow id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.cmml"><msub id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.2.cmml">π</mi><msub id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3.2.cmml">ϕ</mi><mi id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3.3.cmml">R</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.cmml"><mn id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.4" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.4.cmml">0</mn><mo fence="false" id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.1.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.cmml">x</mi><mo id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.4" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2.3.cmml">l</mi></msub></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.3.cmml">&gt;</mo><mrow id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.cmml"><msub id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.2.cmml">π</mi><msub id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3.2.cmml">ϕ</mi><mi id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3.3.cmml">R</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.cmml"><mn id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.4" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.4.cmml">1</mn><mo fence="false" id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.3.cmml">|</mo><mrow id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.2.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.2.2.cmml">x</mi><mo id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1.2.cmml">y</mi><mi id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.4" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2.3.cmml">l</mi></msub></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.11.m11.4b"><apply id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4"><gt id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.3"></gt><apply id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1"><times id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.2"></times><apply id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.2">𝜋</ci><apply id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3.2">italic-ϕ</ci><ci id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.3.3.3">𝑅</ci></apply></apply><apply id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.3">conditional</csymbol><cn type="integer" id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.4.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.4">0</cn><list id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2"><ci id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1">𝑥</ci><apply id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.3.3.1.1.1.1.2.2.2.3">𝑙</ci></apply></list></apply></apply><apply id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2"><times id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.2"></times><apply id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.2">𝜋</ci><apply id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3.2">italic-ϕ</ci><ci id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.3.3.3">𝑅</ci></apply></apply><apply id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.3">conditional</csymbol><cn type="integer" id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.4.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.4">1</cn><list id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2"><ci id="S3.SS2.SSS2.Px1.p1.11.m11.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.2.2">𝑥</ci><apply id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.4.4.2.1.1.1.2.2.2.3">𝑙</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.11.m11.4c">\pi_{\phi_{R}}(0|x,y_{j},y_{l})&gt;\pi_{\phi_{R}}(1|x,y_{j},y_{l})</annotation></semantics></math>, or <math id="S3.SS2.SSS2.Px1.p1.12.m12.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.12.m12.1a"><mrow id="S3.SS2.SSS2.Px1.p1.12.m12.1.1" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.2" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.1" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.3" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.12.m12.1b"><apply id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1"><eq id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.1"></eq><ci id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.2">𝑖</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.12.m12.1c">i=1</annotation></semantics></math> otherwise. This process builds the preference dataset <math id="S3.SS2.SSS2.Px1.p1.13.m13.1" class="ltx_Math" alttext="\mathcal{D}_{gen}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.13.m13.1a"><msub id="S3.SS2.SSS2.Px1.p1.13.m13.1.1" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.2" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.2.cmml">𝒟</mi><mrow id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.1" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.1a" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.4" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.13.m13.1b"><apply id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.2">𝒟</ci><apply id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3"><times id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.1"></times><ci id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.2">𝑔</ci><ci id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.3">𝑒</ci><ci id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.4.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.13.m13.1c">\mathcal{D}_{gen}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS2.SSS2.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Step 2: LLM Fine-tuning.</h5>

<div id="S3.SS2.SSS2.Px2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.Px2.p1.5" class="ltx_p">With the constructed preference dataset <math id="S3.SS2.SSS2.Px2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{gen}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.1.m1.1a"><msub id="S3.SS2.SSS2.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2.cmml">𝒟</mi><mrow id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.1" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.1a" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.4" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2">𝒟</ci><apply id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3"><times id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.1"></times><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.2">𝑔</ci><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.1.m1.1c">\mathcal{D}_{gen}</annotation></semantics></math>, we evolve the LLM to align with clients’ preferences. Specifically, in the <math id="S3.SS2.SSS2.Px2.p1.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.2.m2.1a"><mi id="S3.SS2.SSS2.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.2.m2.1b"><ci id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.2.m2.1c">t</annotation></semantics></math>-th training round, where <math id="S3.SS2.SSS2.Px2.p1.3.m3.3" class="ltx_Math" alttext="t\in\{0,1,\dots\}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.3.m3.3a"><mrow id="S3.SS2.SSS2.Px2.p1.3.m3.3.4" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.4.cmml"><mi id="S3.SS2.SSS2.Px2.p1.3.m3.3.4.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.4.2.cmml">t</mi><mo id="S3.SS2.SSS2.Px2.p1.3.m3.3.4.1" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.4.1.cmml">∈</mo><mrow id="S3.SS2.SSS2.Px2.p1.3.m3.3.4.3.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.3.m3.3.4.3.2.1" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.4.3.1.cmml">{</mo><mn id="S3.SS2.SSS2.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.cmml">0</mn><mo id="S3.SS2.SSS2.Px2.p1.3.m3.3.4.3.2.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.4.3.1.cmml">,</mo><mn id="S3.SS2.SSS2.Px2.p1.3.m3.2.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.2.2.cmml">1</mn><mo id="S3.SS2.SSS2.Px2.p1.3.m3.3.4.3.2.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS2.Px2.p1.3.m3.3.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3.cmml">…</mi><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.3.m3.3.4.3.2.4" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.3.m3.3b"><apply id="S3.SS2.SSS2.Px2.p1.3.m3.3.4.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.4"><in id="S3.SS2.SSS2.Px2.p1.3.m3.3.4.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.4.1"></in><ci id="S3.SS2.SSS2.Px2.p1.3.m3.3.4.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.4.2">𝑡</ci><set id="S3.SS2.SSS2.Px2.p1.3.m3.3.4.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.4.3.2"><cn type="integer" id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1">0</cn><cn type="integer" id="S3.SS2.SSS2.Px2.p1.3.m3.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.2.2">1</cn><ci id="S3.SS2.SSS2.Px2.p1.3.m3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.3.3">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.3.m3.3c">t\in\{0,1,\dots\}</annotation></semantics></math>, we sample a data batch <math id="S3.SS2.SSS2.Px2.p1.4.m4.4" class="ltx_Math" alttext="(x,y_{0},y_{1},i)" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.4.m4.4a"><mrow id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.3.cmml">(</mo><mi id="S3.SS2.SSS2.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.cmml">x</mi><mo id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.4" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.3.cmml">,</mo><msub id="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1.2.cmml">y</mi><mn id="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1.3.cmml">0</mn></msub><mo id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.5" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.3.cmml">,</mo><msub id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2.cmml"><mi id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2.2.cmml">y</mi><mn id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.6" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.3.cmml">,</mo><mi id="S3.SS2.SSS2.Px2.p1.4.m4.2.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.2.2.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.7" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.4.m4.4b"><vector id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2"><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1">𝑥</ci><apply id="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1.2">𝑦</ci><cn type="integer" id="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.3.3.1.1.3">0</cn></apply><apply id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2.2">𝑦</ci><cn type="integer" id="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.4.4.2.2.3">1</cn></apply><ci id="S3.SS2.SSS2.Px2.p1.4.m4.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.2.2">𝑖</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.4.m4.4c">(x,y_{0},y_{1},i)</annotation></semantics></math> from <math id="S3.SS2.SSS2.Px2.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{gen}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.5.m5.1a"><msub id="S3.SS2.SSS2.Px2.p1.5.m5.1.1" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.2" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.2.cmml">𝒟</mi><mrow id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.1" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.1a" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.4" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.5.m5.1b"><apply id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.2">𝒟</ci><apply id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3"><times id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.1"></times><ci id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.2">𝑔</ci><ci id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.3">𝑒</ci><ci id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.4.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.5.m5.1c">\mathcal{D}_{gen}</annotation></semantics></math>, and update the LLM using the following rule:</p>
<table id="A2.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.3" class="ltx_Math" alttext="\displaystyle\theta_{t+1}=\theta_{t}-\eta\nabla\mathcal{L}_{DPO}\left(\theta_{t}|x,y_{0},y_{1},i\right)," display="inline"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><msub id="S3.E6.m1.3.3.1.1.3" xref="S3.E6.m1.3.3.1.1.3.cmml"><mi id="S3.E6.m1.3.3.1.1.3.2" xref="S3.E6.m1.3.3.1.1.3.2.cmml">θ</mi><mrow id="S3.E6.m1.3.3.1.1.3.3" xref="S3.E6.m1.3.3.1.1.3.3.cmml"><mi id="S3.E6.m1.3.3.1.1.3.3.2" xref="S3.E6.m1.3.3.1.1.3.3.2.cmml">t</mi><mo id="S3.E6.m1.3.3.1.1.3.3.1" xref="S3.E6.m1.3.3.1.1.3.3.1.cmml">+</mo><mn id="S3.E6.m1.3.3.1.1.3.3.3" xref="S3.E6.m1.3.3.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.3.3.1.1.1" xref="S3.E6.m1.3.3.1.1.1.cmml"><msub id="S3.E6.m1.3.3.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.3.2" xref="S3.E6.m1.3.3.1.1.1.3.2.cmml">θ</mi><mi id="S3.E6.m1.3.3.1.1.1.3.3" xref="S3.E6.m1.3.3.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E6.m1.3.3.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.2.cmml">−</mo><mrow id="S3.E6.m1.3.3.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.4" xref="S3.E6.m1.3.3.1.1.1.1.4.cmml"><mo rspace="0.167em" id="S3.E6.m1.3.3.1.1.1.1.4.1" xref="S3.E6.m1.3.3.1.1.1.1.4.1.cmml">∇</mo><msub id="S3.E6.m1.3.3.1.1.1.1.4.2" xref="S3.E6.m1.3.3.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.3.3.1.1.1.1.4.2.2" xref="S3.E6.m1.3.3.1.1.1.1.4.2.2.cmml">ℒ</mi><mrow id="S3.E6.m1.3.3.1.1.1.1.4.2.3" xref="S3.E6.m1.3.3.1.1.1.1.4.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.4.2.3.2" xref="S3.E6.m1.3.3.1.1.1.1.4.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.4.2.3.1" xref="S3.E6.m1.3.3.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.1.1.1.1.4.2.3.3" xref="S3.E6.m1.3.3.1.1.1.1.4.2.3.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.4.2.3.1a" xref="S3.E6.m1.3.3.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.1.1.1.1.4.2.3.4" xref="S3.E6.m1.3.3.1.1.1.1.4.2.3.4.cmml">O</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.2a" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.cmml">θ</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">x</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mn id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.3.cmml">1</mn></msub><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.5" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">i</mi></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.3.3.1.2" xref="S3.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1"><eq id="S3.E6.m1.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2"></eq><apply id="S3.E6.m1.3.3.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.3.2">𝜃</ci><apply id="S3.E6.m1.3.3.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.3.3"><plus id="S3.E6.m1.3.3.1.1.3.3.1.cmml" xref="S3.E6.m1.3.3.1.1.3.3.1"></plus><ci id="S3.E6.m1.3.3.1.1.3.3.2.cmml" xref="S3.E6.m1.3.3.1.1.3.3.2">𝑡</ci><cn type="integer" id="S3.E6.m1.3.3.1.1.3.3.3.cmml" xref="S3.E6.m1.3.3.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1"><minus id="S3.E6.m1.3.3.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2"></minus><apply id="S3.E6.m1.3.3.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.3.2">𝜃</ci><ci id="S3.E6.m1.3.3.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E6.m1.3.3.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1"><times id="S3.E6.m1.3.3.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2"></times><ci id="S3.E6.m1.3.3.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3">𝜂</ci><apply id="S3.E6.m1.3.3.1.1.1.1.4.cmml" xref="S3.E6.m1.3.3.1.1.1.1.4"><ci id="S3.E6.m1.3.3.1.1.1.1.4.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.4.1">∇</ci><apply id="S3.E6.m1.3.3.1.1.1.1.4.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.4.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.4.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.4.2.2">ℒ</ci><apply id="S3.E6.m1.3.3.1.1.1.1.4.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.4.2.3"><times id="S3.E6.m1.3.3.1.1.1.1.4.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.4.2.3.1"></times><ci id="S3.E6.m1.3.3.1.1.1.1.4.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.4.2.3.2">𝐷</ci><ci id="S3.E6.m1.3.3.1.1.1.1.4.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.4.2.3.3">𝑃</ci><ci id="S3.E6.m1.3.3.1.1.1.1.4.2.3.4.cmml" xref="S3.E6.m1.3.3.1.1.1.1.4.2.3.4">𝑂</ci></apply></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2">𝜃</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2"><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝑥</ci><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><cn type="integer" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">0</cn></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><cn type="integer" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.3">1</cn></apply><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝑖</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">\displaystyle\theta_{t+1}=\theta_{t}-\eta\nabla\mathcal{L}_{DPO}\left(\theta_{t}|x,y_{0},y_{1},i\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.Px2.p1.7" class="ltx_p">where <math id="S3.SS2.SSS2.Px2.p1.6.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.6.m1.1a"><mi id="S3.SS2.SSS2.Px2.p1.6.m1.1.1" xref="S3.SS2.SSS2.Px2.p1.6.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.6.m1.1b"><ci id="S3.SS2.SSS2.Px2.p1.6.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.6.m1.1c">\eta</annotation></semantics></math> is the learning rate. The gradient computation <math id="S3.SS2.SSS2.Px2.p1.7.m2.1" class="ltx_Math" alttext="\nabla\mathcal{L}_{DPO}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.7.m2.1a"><mrow id="S3.SS2.SSS2.Px2.p1.7.m2.1.1" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.cmml"><mo rspace="0.167em" id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.1" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.1.cmml">∇</mo><msub id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.2" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.2.cmml">ℒ</mi><mrow id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.2" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.1" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.3" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.1a" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.4" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.4.cmml">O</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.7.m2.1b"><apply id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1"><ci id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.1">∇</ci><apply id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.2">ℒ</ci><apply id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3"><times id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.1"></times><ci id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.2">𝐷</ci><ci id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.3">𝑃</ci><ci id="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.4.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m2.1.1.2.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.7.m2.1c">\nabla\mathcal{L}_{DPO}</annotation></semantics></math> is given by <cite class="ltx_cite ltx_citemacro_citet">Rafailov et al. (<a href="#bib.bib33" title="" class="ltx_ref">2023</a>)</cite>. In a nutshell, we distill the binary selector’s preferences into the LLM, allowing it to function as a binary selector itself implicitly.</p>
</div>
</section>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Discussion</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.2" class="ltx_p">We discuss the limitations of <span id="S3.SS3.p1.2.1" class="ltx_text ltx_markedasmath">FedBis</span> which motivate us to propose <span id="S3.SS3.p1.2.2" class="ltx_text ltx_markedasmath">FedBiscuit</span>.</p>
</div>
<section id="S3.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Preference Heterogeneity.</h5>

<div id="S3.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS3.SSS0.Px1.p1.2" class="ltx_p">A performance gap between <span id="S3.SS3.SSS0.Px1.p1.2.1" class="ltx_text ltx_markedasmath">FedBis</span> and centralized training could arise from data heterogeneity among clients, a common issue in FL.
Different from centralized training that aggregates all the clients’ data and samples an i.i.d. batch in each training round, <span id="S3.SS3.SSS0.Px1.p1.2.2" class="ltx_text ltx_markedasmath">FedBis</span> samples a subset of clients in each round, with each client independently optimizing the model based on their local data. This could result in a global aggregation that diverges from the global optimum <cite class="ltx_cite ltx_citemacro_cite">Karimireddy et al. (<a href="#bib.bib20" title="" class="ltx_ref">2020</a>); Wu et al. (<a href="#bib.bib45" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
</section>
<section id="S3.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Reward Hacking.</h5>

<div id="S3.SS3.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS3.SSS0.Px2.p1.1" class="ltx_p">As demonstrated in experiments, <span id="S3.SS3.SSS0.Px2.p1.1.1" class="ltx_text ltx_markedasmath">FedBis</span>’s performance improves first but may later decline with the increase of training rounds. This phenomenon, known as reward hacking, is discussed by <cite class="ltx_cite ltx_citemacro_citet">Skalse et al. (<a href="#bib.bib36" title="" class="ltx_ref">2022</a>)</cite> as an inevitable issue in training a reward proxy model, which is used to enhance the performance of a policy model (e.g., LLM). However, we can mitigate this impact by delaying the inflection point, allowing the reward proxy model to continue improving performance for more training rounds and ultimately achieve a higher rating.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><span id="S4.3.1" class="ltx_text ltx_markedasmath">FedBiscuit</span>: <span id="S4.4.2" class="ltx_text ltx_markedasmath">FedBis</span> with Cluster-wise Aggregation</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.2" class="ltx_p">In this section, we aim to address the aforementioned limitations of <span id="S4.p1.2.1" class="ltx_text ltx_markedasmath">FedBis</span>.
To tackle reward hacking, <cite class="ltx_cite ltx_citemacro_citet">Eisenstein et al. (<a href="#bib.bib11" title="" class="ltx_ref">2023</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Coste et al. (<a href="#bib.bib7" title="" class="ltx_ref">2024</a>)</cite> introduce a promising approach that trains multiple reward models at the same time because aggregation over multiple reward model outputs can provide a more robust reward estimate. Furthermore, recognizing that some clients may share similar preferences, we employ clustered FL <cite class="ltx_cite ltx_citemacro_cite">Sattler et al. (<a href="#bib.bib34" title="" class="ltx_ref">2020</a>); Ghosh et al. (<a href="#bib.bib16" title="" class="ltx_ref">2020</a>); Ma et al. (<a href="#bib.bib29" title="" class="ltx_ref">2023</a>)</cite> to group clients with similar preferences for joint model training. Notably, these two approaches complement each other, inspiring us to combine them into a novel algorithm <span id="S4.p1.2.2" class="ltx_text ltx_markedasmath">FedBiscuit</span> that simultaneously combats reward hacking and preference heterogeneity.</p>
</div>
<section id="S4.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Problem Formulation.</h5>

<div id="S4.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px1.p1.1" class="ltx_p">In this work, we consider training multiple binary selectors of <math id="S4.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S4.SS0.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.1.m1.1c">U</annotation></semantics></math>. To ensure that all selectors are trained without bias towards a small specific group, we mandate that these selectors be trained using evenly disjoint clusters of clients. Additionally, a client’s preference should align more closely with those within the same cluster than with those in different clusters. To this end, we can formulate the following objective:</p>
<table id="A2.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex1.m1.6" class="ltx_Math" alttext="\displaystyle\min_{\phi_{[U]}\in\mathbb{R}^{U\times d}}F({\phi_{[U]}})\overset{\triangle}{=}\sum_{m\in[M]}p_{m}\left(\min_{u\in[U]}F_{m}({\phi_{u}})\right)" display="inline"><semantics id="S4.Ex1.m1.6a"><mrow id="S4.Ex1.m1.6.6" xref="S4.Ex1.m1.6.6.cmml"><mrow id="S4.Ex1.m1.6.6.4" xref="S4.Ex1.m1.6.6.4.cmml"><munder id="S4.Ex1.m1.6.6.4.1" xref="S4.Ex1.m1.6.6.4.1.cmml"><mi id="S4.Ex1.m1.6.6.4.1.2" xref="S4.Ex1.m1.6.6.4.1.2.cmml">min</mi><mrow id="S4.Ex1.m1.1.1.1" xref="S4.Ex1.m1.1.1.1.cmml"><msub id="S4.Ex1.m1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.3.cmml"><mi id="S4.Ex1.m1.1.1.1.3.2" xref="S4.Ex1.m1.1.1.1.3.2.cmml">ϕ</mi><mrow id="S4.Ex1.m1.1.1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.Ex1.m1.1.1.1.1.1.3.1" xref="S4.Ex1.m1.1.1.1.1.1.2.1.cmml">[</mo><mi id="S4.Ex1.m1.1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.cmml">U</mi><mo stretchy="false" id="S4.Ex1.m1.1.1.1.1.1.3.2" xref="S4.Ex1.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></msub><mo id="S4.Ex1.m1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.2.cmml">∈</mo><msup id="S4.Ex1.m1.1.1.1.4" xref="S4.Ex1.m1.1.1.1.4.cmml"><mi id="S4.Ex1.m1.1.1.1.4.2" xref="S4.Ex1.m1.1.1.1.4.2.cmml">ℝ</mi><mrow id="S4.Ex1.m1.1.1.1.4.3" xref="S4.Ex1.m1.1.1.1.4.3.cmml"><mi id="S4.Ex1.m1.1.1.1.4.3.2" xref="S4.Ex1.m1.1.1.1.4.3.2.cmml">U</mi><mo lspace="0.222em" rspace="0.222em" id="S4.Ex1.m1.1.1.1.4.3.1" xref="S4.Ex1.m1.1.1.1.4.3.1.cmml">×</mo><mi id="S4.Ex1.m1.1.1.1.4.3.3" xref="S4.Ex1.m1.1.1.1.4.3.3.cmml">d</mi></mrow></msup></mrow></munder><mo lspace="0.167em" id="S4.Ex1.m1.6.6.4a" xref="S4.Ex1.m1.6.6.4.cmml">⁡</mo><mi id="S4.Ex1.m1.6.6.4.2" xref="S4.Ex1.m1.6.6.4.2.cmml">F</mi></mrow><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.6.6.3" xref="S4.Ex1.m1.6.6.3.cmml">​</mo><mrow id="S4.Ex1.m1.5.5.1.1" xref="S4.Ex1.m1.5.5.1.1.1.cmml"><mo stretchy="false" id="S4.Ex1.m1.5.5.1.1.2" xref="S4.Ex1.m1.5.5.1.1.1.cmml">(</mo><msub id="S4.Ex1.m1.5.5.1.1.1" xref="S4.Ex1.m1.5.5.1.1.1.cmml"><mi id="S4.Ex1.m1.5.5.1.1.1.2" xref="S4.Ex1.m1.5.5.1.1.1.2.cmml">ϕ</mi><mrow id="S4.Ex1.m1.2.2.1.3" xref="S4.Ex1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.Ex1.m1.2.2.1.3.1" xref="S4.Ex1.m1.2.2.1.2.1.cmml">[</mo><mi id="S4.Ex1.m1.2.2.1.1" xref="S4.Ex1.m1.2.2.1.1.cmml">U</mi><mo stretchy="false" id="S4.Ex1.m1.2.2.1.3.2" xref="S4.Ex1.m1.2.2.1.2.1.cmml">]</mo></mrow></msub><mo stretchy="false" id="S4.Ex1.m1.5.5.1.1.3" xref="S4.Ex1.m1.5.5.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.6.6.3a" xref="S4.Ex1.m1.6.6.3.cmml">​</mo><mover accent="true" id="S4.Ex1.m1.6.6.5" xref="S4.Ex1.m1.6.6.5.cmml"><mo id="S4.Ex1.m1.6.6.5.2" xref="S4.Ex1.m1.6.6.5.2.cmml">=</mo><mo id="S4.Ex1.m1.6.6.5.1" xref="S4.Ex1.m1.6.6.5.1.cmml">△</mo></mover><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.6.6.3b" xref="S4.Ex1.m1.6.6.3.cmml">​</mo><mrow id="S4.Ex1.m1.6.6.2" xref="S4.Ex1.m1.6.6.2.cmml"><mstyle displaystyle="true" id="S4.Ex1.m1.6.6.2.2" xref="S4.Ex1.m1.6.6.2.2.cmml"><munder id="S4.Ex1.m1.6.6.2.2a" xref="S4.Ex1.m1.6.6.2.2.cmml"><mo movablelimits="false" id="S4.Ex1.m1.6.6.2.2.2" xref="S4.Ex1.m1.6.6.2.2.2.cmml">∑</mo><mrow id="S4.Ex1.m1.3.3.1" xref="S4.Ex1.m1.3.3.1.cmml"><mi id="S4.Ex1.m1.3.3.1.3" xref="S4.Ex1.m1.3.3.1.3.cmml">m</mi><mo id="S4.Ex1.m1.3.3.1.2" xref="S4.Ex1.m1.3.3.1.2.cmml">∈</mo><mrow id="S4.Ex1.m1.3.3.1.4.2" xref="S4.Ex1.m1.3.3.1.4.1.cmml"><mo stretchy="false" id="S4.Ex1.m1.3.3.1.4.2.1" xref="S4.Ex1.m1.3.3.1.4.1.1.cmml">[</mo><mi id="S4.Ex1.m1.3.3.1.1" xref="S4.Ex1.m1.3.3.1.1.cmml">M</mi><mo stretchy="false" id="S4.Ex1.m1.3.3.1.4.2.2" xref="S4.Ex1.m1.3.3.1.4.1.1.cmml">]</mo></mrow></mrow></munder></mstyle><mrow id="S4.Ex1.m1.6.6.2.1" xref="S4.Ex1.m1.6.6.2.1.cmml"><msub id="S4.Ex1.m1.6.6.2.1.3" xref="S4.Ex1.m1.6.6.2.1.3.cmml"><mi id="S4.Ex1.m1.6.6.2.1.3.2" xref="S4.Ex1.m1.6.6.2.1.3.2.cmml">p</mi><mi id="S4.Ex1.m1.6.6.2.1.3.3" xref="S4.Ex1.m1.6.6.2.1.3.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.6.6.2.1.2" xref="S4.Ex1.m1.6.6.2.1.2.cmml">​</mo><mrow id="S4.Ex1.m1.6.6.2.1.1.1" xref="S4.Ex1.m1.6.6.2.1.1.1.1.cmml"><mo id="S4.Ex1.m1.6.6.2.1.1.1.2" xref="S4.Ex1.m1.6.6.2.1.1.1.1.cmml">(</mo><mrow id="S4.Ex1.m1.6.6.2.1.1.1.1" xref="S4.Ex1.m1.6.6.2.1.1.1.1.cmml"><mrow id="S4.Ex1.m1.6.6.2.1.1.1.1.3" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.cmml"><munder id="S4.Ex1.m1.6.6.2.1.1.1.1.3.1" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.1.cmml"><mi id="S4.Ex1.m1.6.6.2.1.1.1.1.3.1.2" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.1.2.cmml">min</mi><mrow id="S4.Ex1.m1.4.4.1" xref="S4.Ex1.m1.4.4.1.cmml"><mi id="S4.Ex1.m1.4.4.1.3" xref="S4.Ex1.m1.4.4.1.3.cmml">u</mi><mo id="S4.Ex1.m1.4.4.1.2" xref="S4.Ex1.m1.4.4.1.2.cmml">∈</mo><mrow id="S4.Ex1.m1.4.4.1.4.2" xref="S4.Ex1.m1.4.4.1.4.1.cmml"><mo stretchy="false" id="S4.Ex1.m1.4.4.1.4.2.1" xref="S4.Ex1.m1.4.4.1.4.1.1.cmml">[</mo><mi id="S4.Ex1.m1.4.4.1.1" xref="S4.Ex1.m1.4.4.1.1.cmml">U</mi><mo stretchy="false" id="S4.Ex1.m1.4.4.1.4.2.2" xref="S4.Ex1.m1.4.4.1.4.1.1.cmml">]</mo></mrow></mrow></munder><mo lspace="0.167em" id="S4.Ex1.m1.6.6.2.1.1.1.1.3a" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.cmml">⁡</mo><msub id="S4.Ex1.m1.6.6.2.1.1.1.1.3.2" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.2.cmml"><mi id="S4.Ex1.m1.6.6.2.1.1.1.1.3.2.2" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.2.2.cmml">F</mi><mi id="S4.Ex1.m1.6.6.2.1.1.1.1.3.2.3" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.2.3.cmml">m</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.6.6.2.1.1.1.1.2" xref="S4.Ex1.m1.6.6.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.Ex1.m1.6.6.2.1.1.1.1.1.1" xref="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.2" xref="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1" xref="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.3.cmml">u</mi></msub><mo stretchy="false" id="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.3" xref="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex1.m1.6.6.2.1.1.1.3" xref="S4.Ex1.m1.6.6.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.6b"><apply id="S4.Ex1.m1.6.6.cmml" xref="S4.Ex1.m1.6.6"><times id="S4.Ex1.m1.6.6.3.cmml" xref="S4.Ex1.m1.6.6.3"></times><apply id="S4.Ex1.m1.6.6.4.cmml" xref="S4.Ex1.m1.6.6.4"><apply id="S4.Ex1.m1.6.6.4.1.cmml" xref="S4.Ex1.m1.6.6.4.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.4.1.1.cmml" xref="S4.Ex1.m1.6.6.4.1">subscript</csymbol><min id="S4.Ex1.m1.6.6.4.1.2.cmml" xref="S4.Ex1.m1.6.6.4.1.2"></min><apply id="S4.Ex1.m1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1"><in id="S4.Ex1.m1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.2"></in><apply id="S4.Ex1.m1.1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.1.1.1.3.1.cmml" xref="S4.Ex1.m1.1.1.1.3">subscript</csymbol><ci id="S4.Ex1.m1.1.1.1.3.2.cmml" xref="S4.Ex1.m1.1.1.1.3.2">italic-ϕ</ci><apply id="S4.Ex1.m1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.1.1.3"><csymbol cd="latexml" id="S4.Ex1.m1.1.1.1.1.1.2.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.3.1">delimited-[]</csymbol><ci id="S4.Ex1.m1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1">𝑈</ci></apply></apply><apply id="S4.Ex1.m1.1.1.1.4.cmml" xref="S4.Ex1.m1.1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex1.m1.1.1.1.4.1.cmml" xref="S4.Ex1.m1.1.1.1.4">superscript</csymbol><ci id="S4.Ex1.m1.1.1.1.4.2.cmml" xref="S4.Ex1.m1.1.1.1.4.2">ℝ</ci><apply id="S4.Ex1.m1.1.1.1.4.3.cmml" xref="S4.Ex1.m1.1.1.1.4.3"><times id="S4.Ex1.m1.1.1.1.4.3.1.cmml" xref="S4.Ex1.m1.1.1.1.4.3.1"></times><ci id="S4.Ex1.m1.1.1.1.4.3.2.cmml" xref="S4.Ex1.m1.1.1.1.4.3.2">𝑈</ci><ci id="S4.Ex1.m1.1.1.1.4.3.3.cmml" xref="S4.Ex1.m1.1.1.1.4.3.3">𝑑</ci></apply></apply></apply></apply><ci id="S4.Ex1.m1.6.6.4.2.cmml" xref="S4.Ex1.m1.6.6.4.2">𝐹</ci></apply><apply id="S4.Ex1.m1.5.5.1.1.1.cmml" xref="S4.Ex1.m1.5.5.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.5.5.1.1.1.1.cmml" xref="S4.Ex1.m1.5.5.1.1">subscript</csymbol><ci id="S4.Ex1.m1.5.5.1.1.1.2.cmml" xref="S4.Ex1.m1.5.5.1.1.1.2">italic-ϕ</ci><apply id="S4.Ex1.m1.2.2.1.2.cmml" xref="S4.Ex1.m1.2.2.1.3"><csymbol cd="latexml" id="S4.Ex1.m1.2.2.1.2.1.cmml" xref="S4.Ex1.m1.2.2.1.3.1">delimited-[]</csymbol><ci id="S4.Ex1.m1.2.2.1.1.cmml" xref="S4.Ex1.m1.2.2.1.1">𝑈</ci></apply></apply><apply id="S4.Ex1.m1.6.6.5.cmml" xref="S4.Ex1.m1.6.6.5"><ci id="S4.Ex1.m1.6.6.5.1.cmml" xref="S4.Ex1.m1.6.6.5.1">△</ci><eq id="S4.Ex1.m1.6.6.5.2.cmml" xref="S4.Ex1.m1.6.6.5.2"></eq></apply><apply id="S4.Ex1.m1.6.6.2.cmml" xref="S4.Ex1.m1.6.6.2"><apply id="S4.Ex1.m1.6.6.2.2.cmml" xref="S4.Ex1.m1.6.6.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.2.2.1.cmml" xref="S4.Ex1.m1.6.6.2.2">subscript</csymbol><sum id="S4.Ex1.m1.6.6.2.2.2.cmml" xref="S4.Ex1.m1.6.6.2.2.2"></sum><apply id="S4.Ex1.m1.3.3.1.cmml" xref="S4.Ex1.m1.3.3.1"><in id="S4.Ex1.m1.3.3.1.2.cmml" xref="S4.Ex1.m1.3.3.1.2"></in><ci id="S4.Ex1.m1.3.3.1.3.cmml" xref="S4.Ex1.m1.3.3.1.3">𝑚</ci><apply id="S4.Ex1.m1.3.3.1.4.1.cmml" xref="S4.Ex1.m1.3.3.1.4.2"><csymbol cd="latexml" id="S4.Ex1.m1.3.3.1.4.1.1.cmml" xref="S4.Ex1.m1.3.3.1.4.2.1">delimited-[]</csymbol><ci id="S4.Ex1.m1.3.3.1.1.cmml" xref="S4.Ex1.m1.3.3.1.1">𝑀</ci></apply></apply></apply><apply id="S4.Ex1.m1.6.6.2.1.cmml" xref="S4.Ex1.m1.6.6.2.1"><times id="S4.Ex1.m1.6.6.2.1.2.cmml" xref="S4.Ex1.m1.6.6.2.1.2"></times><apply id="S4.Ex1.m1.6.6.2.1.3.cmml" xref="S4.Ex1.m1.6.6.2.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.2.1.3.1.cmml" xref="S4.Ex1.m1.6.6.2.1.3">subscript</csymbol><ci id="S4.Ex1.m1.6.6.2.1.3.2.cmml" xref="S4.Ex1.m1.6.6.2.1.3.2">𝑝</ci><ci id="S4.Ex1.m1.6.6.2.1.3.3.cmml" xref="S4.Ex1.m1.6.6.2.1.3.3">𝑚</ci></apply><apply id="S4.Ex1.m1.6.6.2.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1"><times id="S4.Ex1.m1.6.6.2.1.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.2"></times><apply id="S4.Ex1.m1.6.6.2.1.1.1.1.3.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3"><apply id="S4.Ex1.m1.6.6.2.1.1.1.1.3.1.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.2.1.1.1.1.3.1.1.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.1">subscript</csymbol><min id="S4.Ex1.m1.6.6.2.1.1.1.1.3.1.2.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.1.2"></min><apply id="S4.Ex1.m1.4.4.1.cmml" xref="S4.Ex1.m1.4.4.1"><in id="S4.Ex1.m1.4.4.1.2.cmml" xref="S4.Ex1.m1.4.4.1.2"></in><ci id="S4.Ex1.m1.4.4.1.3.cmml" xref="S4.Ex1.m1.4.4.1.3">𝑢</ci><apply id="S4.Ex1.m1.4.4.1.4.1.cmml" xref="S4.Ex1.m1.4.4.1.4.2"><csymbol cd="latexml" id="S4.Ex1.m1.4.4.1.4.1.1.cmml" xref="S4.Ex1.m1.4.4.1.4.2.1">delimited-[]</csymbol><ci id="S4.Ex1.m1.4.4.1.1.cmml" xref="S4.Ex1.m1.4.4.1.1">𝑈</ci></apply></apply></apply><apply id="S4.Ex1.m1.6.6.2.1.1.1.1.3.2.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.2.1.1.1.1.3.2.1.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.2">subscript</csymbol><ci id="S4.Ex1.m1.6.6.2.1.1.1.1.3.2.2.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.2.2">𝐹</ci><ci id="S4.Ex1.m1.6.6.2.1.1.1.1.3.2.3.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.3.2.3">𝑚</ci></apply></apply><apply id="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.6.6.2.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.6c">\displaystyle\min_{\phi_{[U]}\in\mathbb{R}^{U\times d}}F({\phi_{[U]}})\overset{\triangle}{=}\sum_{m\in[M]}p_{m}\left(\min_{u\in[U]}F_{m}({\phi_{u}})\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E7.m1.4" class="ltx_math_unparsed" alttext="\displaystyle s.t.\quad\max\{|M_{u}|\}_{u\in[U]}-\min\{|M_{u}|\}_{u\in[U]}\leq 1" display="inline"><semantics id="S4.E7.m1.4a"><mrow id="S4.E7.m1.4b"><mi id="S4.E7.m1.3.3">s</mi><mo lspace="0em" rspace="0.167em" id="S4.E7.m1.4.5">.</mo><mi id="S4.E7.m1.4.4">t</mi><mo lspace="0em" id="S4.E7.m1.4.6">.</mo><mspace width="1.334em" id="S4.E7.m1.4.7"></mspace><mi id="S4.E7.m1.4.8">max</mi><msub id="S4.E7.m1.4.9"><mrow id="S4.E7.m1.4.9.2"><mo stretchy="false" id="S4.E7.m1.4.9.2.1">{</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.E7.m1.4.9.2.2">|</mo><msub id="S4.E7.m1.4.9.2.3"><mi id="S4.E7.m1.4.9.2.3.2">M</mi><mi id="S4.E7.m1.4.9.2.3.3">u</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="S4.E7.m1.4.9.2.4">|</mo><mo stretchy="false" id="S4.E7.m1.4.9.2.5">}</mo></mrow><mrow id="S4.E7.m1.1.1.1"><mi id="S4.E7.m1.1.1.1.3">u</mi><mo id="S4.E7.m1.1.1.1.2">∈</mo><mrow id="S4.E7.m1.1.1.1.4.2"><mo stretchy="false" id="S4.E7.m1.1.1.1.4.2.1">[</mo><mi id="S4.E7.m1.1.1.1.1">U</mi><mo stretchy="false" id="S4.E7.m1.1.1.1.4.2.2">]</mo></mrow></mrow></msub><mo id="S4.E7.m1.4.10">−</mo><mi id="S4.E7.m1.4.11">min</mi><msub id="S4.E7.m1.4.12"><mrow id="S4.E7.m1.4.12.2"><mo stretchy="false" id="S4.E7.m1.4.12.2.1">{</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.E7.m1.4.12.2.2">|</mo><msub id="S4.E7.m1.4.12.2.3"><mi id="S4.E7.m1.4.12.2.3.2">M</mi><mi id="S4.E7.m1.4.12.2.3.3">u</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="S4.E7.m1.4.12.2.4">|</mo><mo stretchy="false" id="S4.E7.m1.4.12.2.5">}</mo></mrow><mrow id="S4.E7.m1.2.2.1"><mi id="S4.E7.m1.2.2.1.3">u</mi><mo id="S4.E7.m1.2.2.1.2">∈</mo><mrow id="S4.E7.m1.2.2.1.4.2"><mo stretchy="false" id="S4.E7.m1.2.2.1.4.2.1">[</mo><mi id="S4.E7.m1.2.2.1.1">U</mi><mo stretchy="false" id="S4.E7.m1.2.2.1.4.2.2">]</mo></mrow></mrow></msub><mo id="S4.E7.m1.4.13">≤</mo><mn id="S4.E7.m1.4.14">1</mn></mrow><annotation encoding="application/x-tex" id="S4.E7.m1.4c">\displaystyle s.t.\quad\max\{|M_{u}|\}_{u\in[U]}-\min\{|M_{u}|\}_{u\in[U]}\leq 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS0.SSS0.Px1.p1.8" class="ltx_p">where the function <math id="S4.SS0.SSS0.Px1.p1.2.m1.1" class="ltx_Math" alttext="F_{m}" display="inline"><semantics id="S4.SS0.SSS0.Px1.p1.2.m1.1a"><msub id="S4.SS0.SSS0.Px1.p1.2.m1.1.1" xref="S4.SS0.SSS0.Px1.p1.2.m1.1.1.cmml"><mi id="S4.SS0.SSS0.Px1.p1.2.m1.1.1.2" xref="S4.SS0.SSS0.Px1.p1.2.m1.1.1.2.cmml">F</mi><mi id="S4.SS0.SSS0.Px1.p1.2.m1.1.1.3" xref="S4.SS0.SSS0.Px1.p1.2.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.2.m1.1b"><apply id="S4.SS0.SSS0.Px1.p1.2.m1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.2.m1.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m1.1.1">subscript</csymbol><ci id="S4.SS0.SSS0.Px1.p1.2.m1.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m1.1.1.2">𝐹</ci><ci id="S4.SS0.SSS0.Px1.p1.2.m1.1.1.3.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.2.m1.1c">F_{m}</annotation></semantics></math> follows the same definition of Equation (<a href="#S3.E2" title="In 3.1.1 Problem Formulation. ‣ 3.1 Preference Modeling ‣ 3 FedBis: A Feasible Framework for Achieving RLHF in FL ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).
<math id="S4.SS0.SSS0.Px1.p1.3.m2.1" class="ltx_Math" alttext="\phi_{u}" display="inline"><semantics id="S4.SS0.SSS0.Px1.p1.3.m2.1a"><msub id="S4.SS0.SSS0.Px1.p1.3.m2.1.1" xref="S4.SS0.SSS0.Px1.p1.3.m2.1.1.cmml"><mi id="S4.SS0.SSS0.Px1.p1.3.m2.1.1.2" xref="S4.SS0.SSS0.Px1.p1.3.m2.1.1.2.cmml">ϕ</mi><mi id="S4.SS0.SSS0.Px1.p1.3.m2.1.1.3" xref="S4.SS0.SSS0.Px1.p1.3.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.3.m2.1b"><apply id="S4.SS0.SSS0.Px1.p1.3.m2.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.3.m2.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.3.m2.1.1">subscript</csymbol><ci id="S4.SS0.SSS0.Px1.p1.3.m2.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.3.m2.1.1.2">italic-ϕ</ci><ci id="S4.SS0.SSS0.Px1.p1.3.m2.1.1.3.cmml" xref="S4.SS0.SSS0.Px1.p1.3.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.3.m2.1c">\phi_{u}</annotation></semantics></math> indicates the <math id="S4.SS0.SSS0.Px1.p1.4.m3.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S4.SS0.SSS0.Px1.p1.4.m3.1a"><mi id="S4.SS0.SSS0.Px1.p1.4.m3.1.1" xref="S4.SS0.SSS0.Px1.p1.4.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.4.m3.1b"><ci id="S4.SS0.SSS0.Px1.p1.4.m3.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.4.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.4.m3.1c">u</annotation></semantics></math>-th binary selector, and <math id="S4.SS0.SSS0.Px1.p1.5.m4.1" class="ltx_Math" alttext="M_{u}" display="inline"><semantics id="S4.SS0.SSS0.Px1.p1.5.m4.1a"><msub id="S4.SS0.SSS0.Px1.p1.5.m4.1.1" xref="S4.SS0.SSS0.Px1.p1.5.m4.1.1.cmml"><mi id="S4.SS0.SSS0.Px1.p1.5.m4.1.1.2" xref="S4.SS0.SSS0.Px1.p1.5.m4.1.1.2.cmml">M</mi><mi id="S4.SS0.SSS0.Px1.p1.5.m4.1.1.3" xref="S4.SS0.SSS0.Px1.p1.5.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.5.m4.1b"><apply id="S4.SS0.SSS0.Px1.p1.5.m4.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.5.m4.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.5.m4.1.1">subscript</csymbol><ci id="S4.SS0.SSS0.Px1.p1.5.m4.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.5.m4.1.1.2">𝑀</ci><ci id="S4.SS0.SSS0.Px1.p1.5.m4.1.1.3.cmml" xref="S4.SS0.SSS0.Px1.p1.5.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.5.m4.1c">M_{u}</annotation></semantics></math> means a set of clients using the <math id="S4.SS0.SSS0.Px1.p1.6.m5.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S4.SS0.SSS0.Px1.p1.6.m5.1a"><mi id="S4.SS0.SSS0.Px1.p1.6.m5.1.1" xref="S4.SS0.SSS0.Px1.p1.6.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.6.m5.1b"><ci id="S4.SS0.SSS0.Px1.p1.6.m5.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.6.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.6.m5.1c">u</annotation></semantics></math>-th selector. By definition, <math id="S4.SS0.SSS0.Px1.p1.7.m6.2" class="ltx_Math" alttext="\cup_{u\in[U]}M_{u}=[M]" display="inline"><semantics id="S4.SS0.SSS0.Px1.p1.7.m6.2a"><mrow id="S4.SS0.SSS0.Px1.p1.7.m6.2.3" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.cmml"><mrow id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.cmml"><msub id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.1" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.1.cmml"><mo id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.1.2" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.1.2.cmml">∪</mo><mrow id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.cmml"><mi id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.3" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.3.cmml">u</mi><mo id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.2" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.2.cmml">∈</mo><mrow id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.4.2" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.4.1.cmml"><mo stretchy="false" id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.4.2.1" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.4.1.1.cmml">[</mo><mi id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.1" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.4.2.2" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><msub id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2.cmml"><mi id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2.2" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2.2.cmml">M</mi><mi id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2.3" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2.3.cmml">u</mi></msub></mrow><mo id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.1" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.1.cmml">=</mo><mrow id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.3.2" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.3.2.1" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.3.1.1.cmml">[</mo><mi id="S4.SS0.SSS0.Px1.p1.7.m6.2.2" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.2.cmml">M</mi><mo stretchy="false" id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.3.2.2" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.7.m6.2b"><apply id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3"><eq id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.1"></eq><apply id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2"><apply id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.1.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.1">subscript</csymbol><union id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.1.2"></union><apply id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1"><in id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.2"></in><ci id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.3.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.3">𝑢</ci><apply id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.4.1.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.4.2"><csymbol cd="latexml" id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.4.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.1.1.1.1">𝑈</ci></apply></apply></apply><apply id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2.1.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2">subscript</csymbol><ci id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2.2">𝑀</ci><ci id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2.3.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.2.2.3">𝑢</ci></apply></apply><apply id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.3.2"><csymbol cd="latexml" id="S4.SS0.SSS0.Px1.p1.7.m6.2.3.3.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.3.3.2.1">delimited-[]</csymbol><ci id="S4.SS0.SSS0.Px1.p1.7.m6.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.7.m6.2.2">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.7.m6.2c">\cup_{u\in[U]}M_{u}=[M]</annotation></semantics></math>, and <math id="S4.SS0.SSS0.Px1.p1.8.m7.1" class="ltx_Math" alttext="\cap_{u\in[U]}M_{u}=\emptyset" display="inline"><semantics id="S4.SS0.SSS0.Px1.p1.8.m7.1a"><mrow id="S4.SS0.SSS0.Px1.p1.8.m7.1.2" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.cmml"><mrow id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.cmml"><msub id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.1" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.1.cmml"><mo id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.1.2" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.1.2.cmml">∩</mo><mrow id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.cmml"><mi id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.3" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.3.cmml">u</mi><mo id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.2" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.2.cmml">∈</mo><mrow id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.4.2" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.4.1.cmml"><mo stretchy="false" id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.4.2.1" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.4.1.1.cmml">[</mo><mi id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.1" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.4.2.2" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><msub id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2.cmml"><mi id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2.2" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2.2.cmml">M</mi><mi id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2.3" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2.3.cmml">u</mi></msub></mrow><mo id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.1" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.1.cmml">=</mo><mi mathvariant="normal" id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.3" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.8.m7.1b"><apply id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2"><eq id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.1.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.1"></eq><apply id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2"><apply id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.1.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.1">subscript</csymbol><intersect id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.1.2"></intersect><apply id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1"><in id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.2"></in><ci id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.3.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.3">𝑢</ci><apply id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.4.1.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.4.2"><csymbol cd="latexml" id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.4.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.1.1.1">𝑈</ci></apply></apply></apply><apply id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2.1.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2">subscript</csymbol><ci id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2.2">𝑀</ci><ci id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2.3.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.2.2.3">𝑢</ci></apply></apply><emptyset id="S4.SS0.SSS0.Px1.p1.8.m7.1.2.3.cmml" xref="S4.SS0.SSS0.Px1.p1.8.m7.1.2.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.8.m7.1c">\cap_{u\in[U]}M_{u}=\emptyset</annotation></semantics></math>.</p>
</div>
<div id="S4.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="S4.SS0.SSS0.Px1.p2.1" class="ltx_p">Next we explore how the proposed <span id="S4.SS0.SSS0.Px1.p2.1.1" class="ltx_text ltx_markedasmath">FedBiscuit</span> optimizes Equation (<a href="#S4.E7" title="In Problem Formulation. ‣ 4 FedBiscuit: FedBis with Cluster-wise Aggregation ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>).</p>
</div>
</section>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Algorithm Design</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.6" class="ltx_p">Section <a href="#S3.SS1" title="3.1 Preference Modeling ‣ 3 FedBis: A Feasible Framework for Achieving RLHF in FL ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a> mentions that a client <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="m\in[M]" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.2" xref="S4.SS1.p1.1.m1.1.2.cmml"><mi id="S4.SS1.p1.1.m1.1.2.2" xref="S4.SS1.p1.1.m1.1.2.2.cmml">m</mi><mo id="S4.SS1.p1.1.m1.1.2.1" xref="S4.SS1.p1.1.m1.1.2.1.cmml">∈</mo><mrow id="S4.SS1.p1.1.m1.1.2.3.2" xref="S4.SS1.p1.1.m1.1.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.1.m1.1.2.3.2.1" xref="S4.SS1.p1.1.m1.1.2.3.1.1.cmml">[</mo><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">M</mi><mo stretchy="false" id="S4.SS1.p1.1.m1.1.2.3.2.2" xref="S4.SS1.p1.1.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.2"><in id="S4.SS1.p1.1.m1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.1"></in><ci id="S4.SS1.p1.1.m1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2">𝑚</ci><apply id="S4.SS1.p1.1.m1.1.2.3.1.cmml" xref="S4.SS1.p1.1.m1.1.2.3.2"><csymbol cd="latexml" id="S4.SS1.p1.1.m1.1.2.3.1.1.cmml" xref="S4.SS1.p1.1.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">m\in[M]</annotation></semantics></math> holds a preference dataset <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{m}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝒟</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mathcal{D}_{m}</annotation></semantics></math>. Before the model training, client <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">m</annotation></semantics></math> splits her dataset into two disjoint sets, namely, a training set <math id="S4.SS1.p1.4.m4.2" class="ltx_Math" alttext="\mathcal{D}_{m,train}" display="inline"><semantics id="S4.SS1.p1.4.m4.2a"><msub id="S4.SS1.p1.4.m4.2.3" xref="S4.SS1.p1.4.m4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m4.2.3.2" xref="S4.SS1.p1.4.m4.2.3.2.cmml">𝒟</mi><mrow id="S4.SS1.p1.4.m4.2.2.2.2" xref="S4.SS1.p1.4.m4.2.2.2.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.cmml">m</mi><mo id="S4.SS1.p1.4.m4.2.2.2.2.2" xref="S4.SS1.p1.4.m4.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.p1.4.m4.2.2.2.2.1" xref="S4.SS1.p1.4.m4.2.2.2.2.1.cmml"><mi id="S4.SS1.p1.4.m4.2.2.2.2.1.2" xref="S4.SS1.p1.4.m4.2.2.2.2.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.2.2.2.2.1.1" xref="S4.SS1.p1.4.m4.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.p1.4.m4.2.2.2.2.1.3" xref="S4.SS1.p1.4.m4.2.2.2.2.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.2.2.2.2.1.1a" xref="S4.SS1.p1.4.m4.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.p1.4.m4.2.2.2.2.1.4" xref="S4.SS1.p1.4.m4.2.2.2.2.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.2.2.2.2.1.1b" xref="S4.SS1.p1.4.m4.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.p1.4.m4.2.2.2.2.1.5" xref="S4.SS1.p1.4.m4.2.2.2.2.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.2.2.2.2.1.1c" xref="S4.SS1.p1.4.m4.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.p1.4.m4.2.2.2.2.1.6" xref="S4.SS1.p1.4.m4.2.2.2.2.1.6.cmml">n</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.2b"><apply id="S4.SS1.p1.4.m4.2.3.cmml" xref="S4.SS1.p1.4.m4.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.2.3.1.cmml" xref="S4.SS1.p1.4.m4.2.3">subscript</csymbol><ci id="S4.SS1.p1.4.m4.2.3.2.cmml" xref="S4.SS1.p1.4.m4.2.3.2">𝒟</ci><list id="S4.SS1.p1.4.m4.2.2.2.3.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2"><ci id="S4.SS1.p1.4.m4.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1">𝑚</ci><apply id="S4.SS1.p1.4.m4.2.2.2.2.1.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.1"><times id="S4.SS1.p1.4.m4.2.2.2.2.1.1.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.1.1"></times><ci id="S4.SS1.p1.4.m4.2.2.2.2.1.2.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.1.2">𝑡</ci><ci id="S4.SS1.p1.4.m4.2.2.2.2.1.3.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.1.3">𝑟</ci><ci id="S4.SS1.p1.4.m4.2.2.2.2.1.4.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.1.4">𝑎</ci><ci id="S4.SS1.p1.4.m4.2.2.2.2.1.5.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.1.5">𝑖</ci><ci id="S4.SS1.p1.4.m4.2.2.2.2.1.6.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.1.6">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.2c">\mathcal{D}_{m,train}</annotation></semantics></math> and a validation set <math id="S4.SS1.p1.5.m5.2" class="ltx_Math" alttext="\mathcal{D}_{m,val}" display="inline"><semantics id="S4.SS1.p1.5.m5.2a"><msub id="S4.SS1.p1.5.m5.2.3" xref="S4.SS1.p1.5.m5.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.5.m5.2.3.2" xref="S4.SS1.p1.5.m5.2.3.2.cmml">𝒟</mi><mrow id="S4.SS1.p1.5.m5.2.2.2.2" xref="S4.SS1.p1.5.m5.2.2.2.3.cmml"><mi id="S4.SS1.p1.5.m5.1.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.1.cmml">m</mi><mo id="S4.SS1.p1.5.m5.2.2.2.2.2" xref="S4.SS1.p1.5.m5.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.p1.5.m5.2.2.2.2.1" xref="S4.SS1.p1.5.m5.2.2.2.2.1.cmml"><mi id="S4.SS1.p1.5.m5.2.2.2.2.1.2" xref="S4.SS1.p1.5.m5.2.2.2.2.1.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.5.m5.2.2.2.2.1.1" xref="S4.SS1.p1.5.m5.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.p1.5.m5.2.2.2.2.1.3" xref="S4.SS1.p1.5.m5.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.5.m5.2.2.2.2.1.1a" xref="S4.SS1.p1.5.m5.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.p1.5.m5.2.2.2.2.1.4" xref="S4.SS1.p1.5.m5.2.2.2.2.1.4.cmml">l</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.2b"><apply id="S4.SS1.p1.5.m5.2.3.cmml" xref="S4.SS1.p1.5.m5.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.2.3.1.cmml" xref="S4.SS1.p1.5.m5.2.3">subscript</csymbol><ci id="S4.SS1.p1.5.m5.2.3.2.cmml" xref="S4.SS1.p1.5.m5.2.3.2">𝒟</ci><list id="S4.SS1.p1.5.m5.2.2.2.3.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2"><ci id="S4.SS1.p1.5.m5.1.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1">𝑚</ci><apply id="S4.SS1.p1.5.m5.2.2.2.2.1.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2.1"><times id="S4.SS1.p1.5.m5.2.2.2.2.1.1.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2.1.1"></times><ci id="S4.SS1.p1.5.m5.2.2.2.2.1.2.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2.1.2">𝑣</ci><ci id="S4.SS1.p1.5.m5.2.2.2.2.1.3.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2.1.3">𝑎</ci><ci id="S4.SS1.p1.5.m5.2.2.2.2.1.4.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2.1.4">𝑙</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.2c">\mathcal{D}_{m,val}</annotation></semantics></math>, where <math id="S4.SS1.p1.6.m6.6" class="ltx_Math" alttext="|\mathcal{D}_{m,train}|&gt;&gt;|\mathcal{D}_{m,val}|" display="inline"><semantics id="S4.SS1.p1.6.m6.6a"><mrow id="S4.SS1.p1.6.m6.6.6" xref="S4.SS1.p1.6.m6.6.6.cmml"><mrow id="S4.SS1.p1.6.m6.5.5.1.1" xref="S4.SS1.p1.6.m6.5.5.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.6.m6.5.5.1.1.2" xref="S4.SS1.p1.6.m6.5.5.1.2.1.cmml">|</mo><msub id="S4.SS1.p1.6.m6.5.5.1.1.1" xref="S4.SS1.p1.6.m6.5.5.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m6.5.5.1.1.1.2" xref="S4.SS1.p1.6.m6.5.5.1.1.1.2.cmml">𝒟</mi><mrow id="S4.SS1.p1.6.m6.2.2.2.2" xref="S4.SS1.p1.6.m6.2.2.2.3.cmml"><mi id="S4.SS1.p1.6.m6.1.1.1.1" xref="S4.SS1.p1.6.m6.1.1.1.1.cmml">m</mi><mo id="S4.SS1.p1.6.m6.2.2.2.2.2" xref="S4.SS1.p1.6.m6.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.p1.6.m6.2.2.2.2.1" xref="S4.SS1.p1.6.m6.2.2.2.2.1.cmml"><mi id="S4.SS1.p1.6.m6.2.2.2.2.1.2" xref="S4.SS1.p1.6.m6.2.2.2.2.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.6.m6.2.2.2.2.1.1" xref="S4.SS1.p1.6.m6.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.p1.6.m6.2.2.2.2.1.3" xref="S4.SS1.p1.6.m6.2.2.2.2.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.6.m6.2.2.2.2.1.1a" xref="S4.SS1.p1.6.m6.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.p1.6.m6.2.2.2.2.1.4" xref="S4.SS1.p1.6.m6.2.2.2.2.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.6.m6.2.2.2.2.1.1b" xref="S4.SS1.p1.6.m6.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.p1.6.m6.2.2.2.2.1.5" xref="S4.SS1.p1.6.m6.2.2.2.2.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.6.m6.2.2.2.2.1.1c" xref="S4.SS1.p1.6.m6.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.p1.6.m6.2.2.2.2.1.6" xref="S4.SS1.p1.6.m6.2.2.2.2.1.6.cmml">n</mi></mrow></mrow></msub><mo rspace="0.111em" stretchy="false" id="S4.SS1.p1.6.m6.5.5.1.1.3" xref="S4.SS1.p1.6.m6.5.5.1.2.1.cmml">|</mo></mrow><mo rspace="0.278em" id="S4.SS1.p1.6.m6.6.6.3" xref="S4.SS1.p1.6.m6.6.6.3.cmml">&gt;&gt;</mo><mrow id="S4.SS1.p1.6.m6.6.6.2.1" xref="S4.SS1.p1.6.m6.6.6.2.2.cmml"><mo stretchy="false" id="S4.SS1.p1.6.m6.6.6.2.1.2" xref="S4.SS1.p1.6.m6.6.6.2.2.1.cmml">|</mo><msub id="S4.SS1.p1.6.m6.6.6.2.1.1" xref="S4.SS1.p1.6.m6.6.6.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m6.6.6.2.1.1.2" xref="S4.SS1.p1.6.m6.6.6.2.1.1.2.cmml">𝒟</mi><mrow id="S4.SS1.p1.6.m6.4.4.2.2" xref="S4.SS1.p1.6.m6.4.4.2.3.cmml"><mi id="S4.SS1.p1.6.m6.3.3.1.1" xref="S4.SS1.p1.6.m6.3.3.1.1.cmml">m</mi><mo id="S4.SS1.p1.6.m6.4.4.2.2.2" xref="S4.SS1.p1.6.m6.4.4.2.3.cmml">,</mo><mrow id="S4.SS1.p1.6.m6.4.4.2.2.1" xref="S4.SS1.p1.6.m6.4.4.2.2.1.cmml"><mi id="S4.SS1.p1.6.m6.4.4.2.2.1.2" xref="S4.SS1.p1.6.m6.4.4.2.2.1.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.6.m6.4.4.2.2.1.1" xref="S4.SS1.p1.6.m6.4.4.2.2.1.1.cmml">​</mo><mi id="S4.SS1.p1.6.m6.4.4.2.2.1.3" xref="S4.SS1.p1.6.m6.4.4.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.6.m6.4.4.2.2.1.1a" xref="S4.SS1.p1.6.m6.4.4.2.2.1.1.cmml">​</mo><mi id="S4.SS1.p1.6.m6.4.4.2.2.1.4" xref="S4.SS1.p1.6.m6.4.4.2.2.1.4.cmml">l</mi></mrow></mrow></msub><mo stretchy="false" id="S4.SS1.p1.6.m6.6.6.2.1.3" xref="S4.SS1.p1.6.m6.6.6.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.6b"><apply id="S4.SS1.p1.6.m6.6.6.cmml" xref="S4.SS1.p1.6.m6.6.6"><csymbol cd="latexml" id="S4.SS1.p1.6.m6.6.6.3.cmml" xref="S4.SS1.p1.6.m6.6.6.3">much-greater-than</csymbol><apply id="S4.SS1.p1.6.m6.5.5.1.2.cmml" xref="S4.SS1.p1.6.m6.5.5.1.1"><abs id="S4.SS1.p1.6.m6.5.5.1.2.1.cmml" xref="S4.SS1.p1.6.m6.5.5.1.1.2"></abs><apply id="S4.SS1.p1.6.m6.5.5.1.1.1.cmml" xref="S4.SS1.p1.6.m6.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.5.5.1.1.1.1.cmml" xref="S4.SS1.p1.6.m6.5.5.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m6.5.5.1.1.1.2.cmml" xref="S4.SS1.p1.6.m6.5.5.1.1.1.2">𝒟</ci><list id="S4.SS1.p1.6.m6.2.2.2.3.cmml" xref="S4.SS1.p1.6.m6.2.2.2.2"><ci id="S4.SS1.p1.6.m6.1.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1.1">𝑚</ci><apply id="S4.SS1.p1.6.m6.2.2.2.2.1.cmml" xref="S4.SS1.p1.6.m6.2.2.2.2.1"><times id="S4.SS1.p1.6.m6.2.2.2.2.1.1.cmml" xref="S4.SS1.p1.6.m6.2.2.2.2.1.1"></times><ci id="S4.SS1.p1.6.m6.2.2.2.2.1.2.cmml" xref="S4.SS1.p1.6.m6.2.2.2.2.1.2">𝑡</ci><ci id="S4.SS1.p1.6.m6.2.2.2.2.1.3.cmml" xref="S4.SS1.p1.6.m6.2.2.2.2.1.3">𝑟</ci><ci id="S4.SS1.p1.6.m6.2.2.2.2.1.4.cmml" xref="S4.SS1.p1.6.m6.2.2.2.2.1.4">𝑎</ci><ci id="S4.SS1.p1.6.m6.2.2.2.2.1.5.cmml" xref="S4.SS1.p1.6.m6.2.2.2.2.1.5">𝑖</ci><ci id="S4.SS1.p1.6.m6.2.2.2.2.1.6.cmml" xref="S4.SS1.p1.6.m6.2.2.2.2.1.6">𝑛</ci></apply></list></apply></apply><apply id="S4.SS1.p1.6.m6.6.6.2.2.cmml" xref="S4.SS1.p1.6.m6.6.6.2.1"><abs id="S4.SS1.p1.6.m6.6.6.2.2.1.cmml" xref="S4.SS1.p1.6.m6.6.6.2.1.2"></abs><apply id="S4.SS1.p1.6.m6.6.6.2.1.1.cmml" xref="S4.SS1.p1.6.m6.6.6.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.6.6.2.1.1.1.cmml" xref="S4.SS1.p1.6.m6.6.6.2.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m6.6.6.2.1.1.2.cmml" xref="S4.SS1.p1.6.m6.6.6.2.1.1.2">𝒟</ci><list id="S4.SS1.p1.6.m6.4.4.2.3.cmml" xref="S4.SS1.p1.6.m6.4.4.2.2"><ci id="S4.SS1.p1.6.m6.3.3.1.1.cmml" xref="S4.SS1.p1.6.m6.3.3.1.1">𝑚</ci><apply id="S4.SS1.p1.6.m6.4.4.2.2.1.cmml" xref="S4.SS1.p1.6.m6.4.4.2.2.1"><times id="S4.SS1.p1.6.m6.4.4.2.2.1.1.cmml" xref="S4.SS1.p1.6.m6.4.4.2.2.1.1"></times><ci id="S4.SS1.p1.6.m6.4.4.2.2.1.2.cmml" xref="S4.SS1.p1.6.m6.4.4.2.2.1.2">𝑣</ci><ci id="S4.SS1.p1.6.m6.4.4.2.2.1.3.cmml" xref="S4.SS1.p1.6.m6.4.4.2.2.1.3">𝑎</ci><ci id="S4.SS1.p1.6.m6.4.4.2.2.1.4.cmml" xref="S4.SS1.p1.6.m6.4.4.2.2.1.4">𝑙</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.6c">|\mathcal{D}_{m,train}|&gt;&gt;|\mathcal{D}_{m,val}|</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.3" class="ltx_p">The proposed <span id="S4.SS1.p2.3.1" class="ltx_text ltx_markedasmath">FedBiscuit</span> consists of two phases: 1) We train each selector for a couple of rounds so that all <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">U</annotation></semantics></math> selectors have fundamental capacities in selecting the preferred completion, and 2) we divide the clients into disjoint clusters of size <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">U</annotation></semantics></math> and train each binary selector with a specific cluster.</p>
</div>
<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Phase 1: Warm-up.</h5>

<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p1.13" class="ltx_p">In the beginning, we initialize each binary selector <math id="S4.SS1.SSS0.Px1.p1.1.m1.2" class="ltx_Math" alttext="\phi_{u}(u\in[U])" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.2a"><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.cmml"><msub id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3.2.cmml">ϕ</mi><mi id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3.3.cmml">u</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.cmml">​</mo><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.cmml">∈</mo><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.2.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.1.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.2b"><apply id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2"><times id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2"></times><apply id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3.2">italic-ϕ</ci><ci id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3.3.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.3.3">𝑢</ci></apply><apply id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1"><in id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1"></in><ci id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2">𝑢</ci><apply id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.2"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.2.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1">𝑈</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.2c">\phi_{u}(u\in[U])</annotation></semantics></math> with an identical pretrained LLM. Subsequently, starting from <math id="S4.SS1.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="u=0" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1"><eq id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1"></eq><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2">𝑢</ci><cn type="integer" id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.1c">u=0</annotation></semantics></math>, we train a selector <math id="S4.SS1.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\phi_{u}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.3.m3.1a"><msub id="S4.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml">ϕ</mi><mi id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2">italic-ϕ</ci><ci id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.3.m3.1c">\phi_{u}</annotation></semantics></math> for <math id="S4.SS1.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="R_{pre}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.4.m4.1a"><msub id="S4.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml">R</mi><mrow id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.2" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.1" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.3" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.1a" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.4" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.4.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2">𝑅</ci><apply id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3"><times id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.1"></times><ci id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.2">𝑝</ci><ci id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.3">𝑟</ci><ci id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.4.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.4">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.4.m4.1c">R_{pre}</annotation></semantics></math> consecutive communication rounds following the steps of <span id="S4.SS1.SSS0.Px1.p1.13.1" class="ltx_text ltx_markedasmath">FedBis</span>: In each communication round, the server samples a subset of client <math id="S4.SS1.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.6.m6.1b"><ci id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.6.m6.1c">\mathcal{A}</annotation></semantics></math> and broadcasts the selector <math id="S4.SS1.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="\phi_{u}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.7.m7.1a"><msub id="S4.SS1.SSS0.Px1.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml">ϕ</mi><mi id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.3" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.7.m7.1b"><apply id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.2">italic-ϕ</ci><ci id="S4.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m7.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.7.m7.1c">\phi_{u}</annotation></semantics></math> to them. Each client <math id="S4.SS1.SSS0.Px1.p1.8.m8.1" class="ltx_Math" alttext="m\in\mathcal{A}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.8.m8.1a"><mrow id="S4.SS1.SSS0.Px1.p1.8.m8.1.1" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2.cmml">m</mi><mo id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.1" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.3" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.8.m8.1b"><apply id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1"><in id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.1"></in><ci id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.2">𝑚</ci><ci id="S4.SS1.SSS0.Px1.p1.8.m8.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.8.m8.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.8.m8.1c">m\in\mathcal{A}</annotation></semantics></math> then locally trains the selector for <math id="S4.SS1.SSS0.Px1.p1.9.m9.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.9.m9.1a"><mi id="S4.SS1.SSS0.Px1.p1.9.m9.1.1" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.9.m9.1b"><ci id="S4.SS1.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.9.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.9.m9.1c">K</annotation></semantics></math> iterations using the dataset <math id="S4.SS1.SSS0.Px1.p1.10.m10.2" class="ltx_Math" alttext="\mathcal{D}_{m,train}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.10.m10.2a"><msub id="S4.SS1.SSS0.Px1.p1.10.m10.2.3" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px1.p1.10.m10.2.3.2" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.3.2.cmml">𝒟</mi><mrow id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.1.1" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.cmml">m</mi><mo id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.2" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.2" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.1" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.3" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.1a" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.4" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.1b" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.5" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.1c" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.6" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.6.cmml">n</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.10.m10.2b"><apply id="S4.SS1.SSS0.Px1.p1.10.m10.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.10.m10.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.10.m10.2.3.2.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.3.2">𝒟</ci><list id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2"><ci id="S4.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.1.1.1.1">𝑚</ci><apply id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1"><times id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.1"></times><ci id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.2">𝑡</ci><ci id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.3">𝑟</ci><ci id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.4.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.4">𝑎</ci><ci id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.5.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.5">𝑖</ci><ci id="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.6.cmml" xref="S4.SS1.SSS0.Px1.p1.10.m10.2.2.2.2.1.6">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.10.m10.2c">\mathcal{D}_{m,train}</annotation></semantics></math>. At the end of the communication round, the server aggregates and updates the selector <math id="S4.SS1.SSS0.Px1.p1.11.m11.1" class="ltx_Math" alttext="\phi_{u}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.11.m11.1a"><msub id="S4.SS1.SSS0.Px1.p1.11.m11.1.1" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.11.m11.1.1.2" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1.2.cmml">ϕ</mi><mi id="S4.SS1.SSS0.Px1.p1.11.m11.1.1.3" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.11.m11.1b"><apply id="S4.SS1.SSS0.Px1.p1.11.m11.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.11.m11.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.11.m11.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1.2">italic-ϕ</ci><ci id="S4.SS1.SSS0.Px1.p1.11.m11.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.11.m11.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.11.m11.1c">\phi_{u}</annotation></semantics></math> via Equation (<a href="#S3.E4" title="In Step 3: Global Aggregation. ‣ 3.1.2 Algorithm Design ‣ 3.1 Preference Modeling ‣ 3 FedBis: A Feasible Framework for Achieving RLHF in FL ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). After completing the training of <math id="S4.SS1.SSS0.Px1.p1.12.m12.1" class="ltx_Math" alttext="\phi_{u}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.12.m12.1a"><msub id="S4.SS1.SSS0.Px1.p1.12.m12.1.1" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.2" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.2.cmml">ϕ</mi><mi id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.12.m12.1b"><apply id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.2">italic-ϕ</ci><ci id="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.12.m12.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.12.m12.1c">\phi_{u}</annotation></semantics></math>, the server initiates the training of the next selector <math id="S4.SS1.SSS0.Px1.p1.13.m13.1" class="ltx_Math" alttext="\phi_{u+1}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.13.m13.1a"><msub id="S4.SS1.SSS0.Px1.p1.13.m13.1.1" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.2" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.2.cmml">ϕ</mi><mrow id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.2" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.1" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.1.cmml">+</mo><mn id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.3" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.13.m13.1b"><apply id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.2">italic-ϕ</ci><apply id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3"><plus id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.2">𝑢</ci><cn type="integer" id="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p1.13.m13.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.13.m13.1c">\phi_{u+1}</annotation></semantics></math> by repeating the above steps until all selectors are trained.</p>
</div>
<div id="S4.SS1.SSS0.Px1.p2" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p2.1" class="ltx_p">The selectors are trained with different data distributions because the clients participating in each training round are randomly selected. Consequently, all the selectors <math id="S4.SS1.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="\phi_{[U]}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.1.m1.1a"><msub id="S4.SS1.SSS0.Px1.p2.1.m1.1.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p2.1.m1.1.2.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.2.2.cmml">ϕ</mi><mrow id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.3.1" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.2.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.3.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.2.1.cmml">]</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS1.SSS0.Px1.p2.1.m1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.1.m1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.1.m1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.2.2">italic-ϕ</ci><apply id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.3"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.1">𝑈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.1.m1.1c">\phi_{[U]}</annotation></semantics></math> have distinct model parameters, leading to varied performance in terms of final logit output when given an instruction and a pair of completions.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Phase 2: Clustered FL Training.</h5>

<div id="S4.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p1.6" class="ltx_p">After the first phase, we obtain <math id="S4.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.1c">U</annotation></semantics></math> different selectors, denoted as <math id="S4.SS1.SSS0.Px2.p1.2.m2.4" class="ltx_Math" alttext="\{\phi_{u,0}\}_{u\in[U]}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.2.m2.4a"><msub id="S4.SS1.SSS0.Px2.p1.2.m2.4.4" xref="S4.SS1.SSS0.Px2.p1.2.m2.4.4.cmml"><mrow id="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.2.cmml">{</mo><msub id="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1.1.2.cmml">ϕ</mi><mrow id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.4" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.cmml">u</mi><mo id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.4.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.3.cmml">,</mo><mn id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.cmml">0</mn></mrow></msub><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1.3" xref="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.3" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.3.cmml">u</mi><mo id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.2.cmml">∈</mo><mrow id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.4.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.4.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.4.2.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.4.1.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.4.2.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.4.1.1.cmml">]</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.2.m2.4b"><apply id="S4.SS1.SSS0.Px2.p1.2.m2.4.4.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.4.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.2.m2.4.4.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.4.4">subscript</csymbol><set id="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1"><apply id="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.4.4.1.1.1.2">italic-ϕ</ci><list id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.4"><ci id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.1">𝑢</ci><cn type="integer" id="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.2.2.2.2">0</cn></list></apply></set><apply id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1"><in id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.2"></in><ci id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.3">𝑢</ci><apply id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.4.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.4.2"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.4.2.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.3.3.1.1">𝑈</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.2.m2.4c">\{\phi_{u,0}\}_{u\in[U]}</annotation></semantics></math>. Unlike <span id="S4.SS1.SSS0.Px2.p1.6.1" class="ltx_text ltx_markedasmath">FedBis</span>, this phase includes an additional step called <span id="S4.SS1.SSS0.Px2.p1.6.2" class="ltx_text ltx_font_italic">client grouping</span>, which partitions the clients into multiple disjoint clusters based on their preferences. In each communication round <math id="S4.SS1.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="r\in[R]" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.4.m4.1a"><mrow id="S4.SS1.SSS0.Px2.p1.4.m4.1.2" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.4.m4.1.2.2" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.2.2.cmml">r</mi><mo id="S4.SS1.SSS0.Px2.p1.4.m4.1.2.1" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.2.1.cmml">∈</mo><mrow id="S4.SS1.SSS0.Px2.p1.4.m4.1.2.3.2" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.4.m4.1.2.3.2.1" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.2.3.1.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">R</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.4.m4.1.2.3.2.2" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.4.m4.1b"><apply id="S4.SS1.SSS0.Px2.p1.4.m4.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.2"><in id="S4.SS1.SSS0.Px2.p1.4.m4.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.2.1"></in><ci id="S4.SS1.SSS0.Px2.p1.4.m4.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.2.2">𝑟</ci><apply id="S4.SS1.SSS0.Px2.p1.4.m4.1.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.2.3.2"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p1.4.m4.1.2.3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.4.m4.1c">r\in[R]</annotation></semantics></math>, the proposed <span id="S4.SS1.SSS0.Px2.p1.6.3" class="ltx_text ltx_markedasmath">FedBiscuit</span> optimizes all the selectors <math id="S4.SS1.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="\phi_{[U]}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.6.m6.1a"><msub id="S4.SS1.SSS0.Px2.p1.6.m6.1.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.6.m6.1.2.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.2.2.cmml">ϕ</mi><mrow id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.3.1" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.2.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.2.1.cmml">]</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.6.m6.1b"><apply id="S4.SS1.SSS0.Px2.p1.6.m6.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.6.m6.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.6.m6.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.2.2">italic-ϕ</ci><apply id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.3"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.3.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.1">𝑈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.6.m6.1c">\phi_{[U]}</annotation></semantics></math> using the following four steps:</p>
</div>
<div id="S4.SS1.SSS0.Px2.p2" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p2.9" class="ltx_p"><span id="S4.SS1.SSS0.Px2.p2.9.1" class="ltx_text ltx_font_italic">Step 2.1: Client Grouping.</span> This step is executed every <math id="S4.SS1.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.1.m1.1a"><mi id="S4.SS1.SSS0.Px2.p2.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.1.m1.1b"><ci id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.1.m1.1c">\tau</annotation></semantics></math> communication rounds, i.e., when <math id="S4.SS1.SSS0.Px2.p2.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.2.m2.1a"><mi id="S4.SS1.SSS0.Px2.p2.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.2.m2.1b"><ci id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.2.m2.1c">r</annotation></semantics></math> can be divided by <math id="S4.SS1.SSS0.Px2.p2.3.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.3.m3.1a"><mi id="S4.SS1.SSS0.Px2.p2.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p2.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.3.m3.1b"><ci id="S4.SS1.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.3.m3.1c">\tau</annotation></semantics></math>, or <math id="S4.SS1.SSS0.Px2.p2.4.m4.1" class="ltx_Math" alttext="\tau|r" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.4.m4.1a"><mrow id="S4.SS1.SSS0.Px2.p2.4.m4.1.1" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.cmml">τ</mi><mo fence="false" id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.1" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.1.cmml">|</mo><mi id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.4.m4.1b"><apply id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.1">conditional</csymbol><ci id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2">𝜏</ci><ci id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.4.m4.1c">\tau|r</annotation></semantics></math>. During this step, the server broadcasts all selectors <math id="S4.SS1.SSS0.Px2.p2.5.m5.3" class="ltx_Math" alttext="\phi_{[U],r}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.5.m5.3a"><msub id="S4.SS1.SSS0.Px2.p2.5.m5.3.4" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.4.cmml"><mi id="S4.SS1.SSS0.Px2.p2.5.m5.3.4.2" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.4.2.cmml">ϕ</mi><mrow id="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.4.cmml"><mrow id="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3.1.2" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3.1.2.1" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3.1.1.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px2.p2.5.m5.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3.1.2.2" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3.1.1.1.cmml">]</mo></mrow><mo id="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3.2" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.4.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p2.5.m5.2.2.2.2" xref="S4.SS1.SSS0.Px2.p2.5.m5.2.2.2.2.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.5.m5.3b"><apply id="S4.SS1.SSS0.Px2.p2.5.m5.3.4.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.5.m5.3.4.1.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.5.m5.3.4.2.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.4.2">italic-ϕ</ci><list id="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.4.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3"><apply id="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3.1.2"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.3.3.3.3.1.2.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px2.p2.5.m5.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1.1.1">𝑈</ci></apply><ci id="S4.SS1.SSS0.Px2.p2.5.m5.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.2.2.2.2">𝑟</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.5.m5.3c">\phi_{[U],r}</annotation></semantics></math> to all clients <math id="S4.SS1.SSS0.Px2.p2.6.m6.1" class="ltx_Math" alttext="[M]" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.6.m6.1a"><mrow id="S4.SS1.SSS0.Px2.p2.6.m6.1.2.2" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.2.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.6.m6.1.2.2.1" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.2.1.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px2.p2.6.m6.1.1" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1.cmml">M</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.6.m6.1.2.2.2" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.6.m6.1b"><apply id="S4.SS1.SSS0.Px2.p2.6.m6.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.2.2"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p2.6.m6.1.2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.2.2.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px2.p2.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.6.m6.1c">[M]</annotation></semantics></math>. Then, a client <math id="S4.SS1.SSS0.Px2.p2.7.m7.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.7.m7.1a"><mi id="S4.SS1.SSS0.Px2.p2.7.m7.1.1" xref="S4.SS1.SSS0.Px2.p2.7.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.7.m7.1b"><ci id="S4.SS1.SSS0.Px2.p2.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.7.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.7.m7.1c">m</annotation></semantics></math> calculates the averaged loss for each selector <math id="S4.SS1.SSS0.Px2.p2.8.m8.2" class="ltx_Math" alttext="\phi_{u,r}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.8.m8.2a"><msub id="S4.SS1.SSS0.Px2.p2.8.m8.2.3" xref="S4.SS1.SSS0.Px2.p2.8.m8.2.3.cmml"><mi id="S4.SS1.SSS0.Px2.p2.8.m8.2.3.2" xref="S4.SS1.SSS0.Px2.p2.8.m8.2.3.2.cmml">ϕ</mi><mrow id="S4.SS1.SSS0.Px2.p2.8.m8.2.2.2.4" xref="S4.SS1.SSS0.Px2.p2.8.m8.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px2.p2.8.m8.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.8.m8.1.1.1.1.cmml">u</mi><mo id="S4.SS1.SSS0.Px2.p2.8.m8.2.2.2.4.1" xref="S4.SS1.SSS0.Px2.p2.8.m8.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p2.8.m8.2.2.2.2" xref="S4.SS1.SSS0.Px2.p2.8.m8.2.2.2.2.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.8.m8.2b"><apply id="S4.SS1.SSS0.Px2.p2.8.m8.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.8.m8.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.8.m8.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p2.8.m8.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.8.m8.2.3.2.cmml" xref="S4.SS1.SSS0.Px2.p2.8.m8.2.3.2">italic-ϕ</ci><list id="S4.SS1.SSS0.Px2.p2.8.m8.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.8.m8.2.2.2.4"><ci id="S4.SS1.SSS0.Px2.p2.8.m8.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.8.m8.1.1.1.1">𝑢</ci><ci id="S4.SS1.SSS0.Px2.p2.8.m8.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.8.m8.2.2.2.2">𝑟</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.8.m8.2c">\phi_{u,r}</annotation></semantics></math> using local validation set via <math id="S4.SS1.SSS0.Px2.p2.9.m9.13" class="ltx_Math" alttext="\frac{1}{|\mathcal{D}_{m,val}|}\sum_{(x,y_{0},y_{1},i)\sim\mathcal{D}_{m,val}}\left[\ell_{CE}(i|\phi_{u,r};x,y_{0},y_{1})\right]" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.9.m9.13a"><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.13.13" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.cmml"><mfrac id="S4.SS1.SSS0.Px2.p2.9.m9.3.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.cmml"><mn id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.5" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.5.cmml">1</mn><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.4.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.4.1.cmml">|</mo><msub id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.1.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.1.2.cmml">𝒟</mi><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px2.p2.9.m9.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.1.1.1.1.1.1.cmml">m</mi><mo id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.1a" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.4" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.4.cmml">l</mi></mrow></mrow></msub><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.4.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.2.cmml">​</mo><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.cmml"><msub id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.2.cmml"><mo rspace="0em" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.2.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.2.2.cmml">∑</mo><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.cmml"><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.3.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.3.cmml">(</mo><mi id="S4.SS1.SSS0.Px2.p2.9.m9.6.6.3.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.6.6.3.3.cmml">x</mi><mo id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.4" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1.2.cmml">y</mi><mn id="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1.3.cmml">0</mn></msub><mo id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.5" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2.2.cmml">y</mi><mn id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2.3.cmml">1</mn></msub><mo id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.6" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.3.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p2.9.m9.7.7.4.4" xref="S4.SS1.SSS0.Px2.p2.9.m9.7.7.4.4.cmml">i</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.7" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.3.cmml">)</mo></mrow><mo id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.7" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.7.cmml">∼</mo><msub id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.8" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.8.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.8.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.8.2.cmml">𝒟</mi><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px2.p2.9.m9.4.4.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.4.4.1.1.1.1.cmml">m</mi><mo id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.1a" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.4" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.4.cmml">l</mi></mrow></mrow></msub></mrow></msub><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.2.cmml"><mo id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.2.1.cmml">[</mo><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.cmml"><msub id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.2.cmml">ℓ</mi><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.cmml"><mi id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.3.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.5" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.5.cmml">i</mi><mo fence="false" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.4" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.4.cmml">|</mo><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.4.cmml"><msub id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mrow id="S4.SS1.SSS0.Px2.p2.9.m9.11.11.2.4" xref="S4.SS1.SSS0.Px2.p2.9.m9.11.11.2.3.cmml"><mi id="S4.SS1.SSS0.Px2.p2.9.m9.10.10.1.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.10.10.1.1.cmml">u</mi><mo id="S4.SS1.SSS0.Px2.p2.9.m9.11.11.2.4.1" xref="S4.SS1.SSS0.Px2.p2.9.m9.11.11.2.3.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p2.9.m9.11.11.2.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.11.11.2.2.cmml">r</mi></mrow></msub><mo id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.4" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.4.cmml">;</mo><mi id="S4.SS1.SSS0.Px2.p2.9.m9.12.12" xref="S4.SS1.SSS0.Px2.p2.9.m9.12.12.cmml">x</mi><mo id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.5" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mn id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2.3.cmml">0</mn></msub><mo id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.6" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3.2" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3.2.cmml">y</mi><mn id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></msub></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.3" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.9.m9.13b"><apply id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13"><times id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.2"></times><apply id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3"><divide id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.4.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3"></divide><cn type="integer" id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.5.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.5">1</cn><apply id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.4.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3"><abs id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.4.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.2"></abs><apply id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.3.3.3.3.1.2">𝒟</ci><list id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2"><ci id="S4.SS1.SSS0.Px2.p2.9.m9.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.1.1.1.1.1.1">𝑚</ci><apply id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1"><times id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.1"></times><ci id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.2">𝑣</ci><ci id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.3">𝑎</ci><ci id="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.4.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.2.2.2.2.2.2.1.4">𝑙</ci></apply></list></apply></apply></apply><apply id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1"><apply id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.2">subscript</csymbol><sum id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.2.2"></sum><apply id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.7.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.7">similar-to</csymbol><vector id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2"><ci id="S4.SS1.SSS0.Px2.p2.9.m9.6.6.3.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.6.6.3.3">𝑥</ci><apply id="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1.2">𝑦</ci><cn type="integer" id="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.8.8.5.5.1.1.3">0</cn></apply><apply id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2.2">𝑦</ci><cn type="integer" id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.6.2.2.3">1</cn></apply><ci id="S4.SS1.SSS0.Px2.p2.9.m9.7.7.4.4.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.7.7.4.4">𝑖</ci></vector><apply id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.8.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.8"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.8.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.8">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.8.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.9.9.6.8.2">𝒟</ci><list id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2"><ci id="S4.SS1.SSS0.Px2.p2.9.m9.4.4.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.4.4.1.1.1.1">𝑚</ci><apply id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1"><times id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.1"></times><ci id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.2">𝑣</ci><ci id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.3">𝑎</ci><ci id="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.4.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.5.5.2.2.2.2.1.4">𝑙</ci></apply></list></apply></apply></apply><apply id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1"><times id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.2"></times><apply id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.2">ℓ</ci><apply id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3"><times id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.1"></times><ci id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.2">𝐶</ci><ci id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.3.3.3">𝐸</ci></apply></apply><apply id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.4.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.4">conditional</csymbol><ci id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.5.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.5">𝑖</ci><list id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.4.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3"><apply id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.1.1.1.2">italic-ϕ</ci><list id="S4.SS1.SSS0.Px2.p2.9.m9.11.11.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.11.11.2.4"><ci id="S4.SS1.SSS0.Px2.p2.9.m9.10.10.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.10.10.1.1">𝑢</ci><ci id="S4.SS1.SSS0.Px2.p2.9.m9.11.11.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.11.11.2.2">𝑟</ci></list></apply><ci id="S4.SS1.SSS0.Px2.p2.9.m9.12.12.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.12.12">𝑥</ci><apply id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><cn type="integer" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.2.2.2.3">0</cn></apply><apply id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3.2">𝑦</ci><cn type="integer" id="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p2.9.m9.13.13.1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.9.m9.13c">\frac{1}{|\mathcal{D}_{m,val}|}\sum_{(x,y_{0},y_{1},i)\sim\mathcal{D}_{m,val}}\left[\ell_{CE}(i|\phi_{u,r};x,y_{0},y_{1})\right]</annotation></semantics></math>. The server thereby collects all these losses and adopts a greedy clustering approach <cite class="ltx_cite ltx_citemacro_cite">Sattler et al. (<a href="#bib.bib34" title="" class="ltx_ref">2020</a>); Ma et al. (<a href="#bib.bib29" title="" class="ltx_ref">2023</a>)</cite> to assign each client to the selector where they achieve the minimum loss. However, an obvious deficiency is an imbalance where some selectors are chosen by many clients and others by few. It is noted that the selectors trained with more clients achieve remarkable performance, while some may be overfitted to a specific group of clients. Therefore, the greedy clustering approach negatively impacts the overall performance when building a global preference dataset. To tackle the limitation, we propose to balance the clusters using the following steps repeatedly until the clients are evenly distributed:</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p">Choose the cluster selected by the most clients.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.2" class="ltx_p">If the cluster can accommodate <math id="S4.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.I1.i2.p1.1.m1.1a"><mi id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><ci id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">n</annotation></semantics></math> clients, cap the cluster at <math id="S4.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.I1.i2.p1.2.m2.1a"><mi id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><ci id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">n</annotation></semantics></math> clients and reassign the rest to other clusters where they achieve suboptimal loss.</p>
</div>
</li>
</ul>
<p id="S4.SS1.SSS0.Px2.p2.14" class="ltx_p">Finally, we obtain balanced and disjoint clusters. Let a client <math id="S4.SS1.SSS0.Px2.p2.10.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.10.m1.1a"><mi id="S4.SS1.SSS0.Px2.p2.10.m1.1.1" xref="S4.SS1.SSS0.Px2.p2.10.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.10.m1.1b"><ci id="S4.SS1.SSS0.Px2.p2.10.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.10.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.10.m1.1c">m</annotation></semantics></math> train with the <math id="S4.SS1.SSS0.Px2.p2.11.m2.1" class="ltx_Math" alttext="U_{m}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.11.m2.1a"><msub id="S4.SS1.SSS0.Px2.p2.11.m2.1.1" xref="S4.SS1.SSS0.Px2.p2.11.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.11.m2.1.1.2" xref="S4.SS1.SSS0.Px2.p2.11.m2.1.1.2.cmml">U</mi><mi id="S4.SS1.SSS0.Px2.p2.11.m2.1.1.3" xref="S4.SS1.SSS0.Px2.p2.11.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.11.m2.1b"><apply id="S4.SS1.SSS0.Px2.p2.11.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.11.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.11.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.11.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.11.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.11.m2.1.1.2">𝑈</ci><ci id="S4.SS1.SSS0.Px2.p2.11.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.11.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.11.m2.1c">U_{m}</annotation></semantics></math>-th selector <math id="S4.SS1.SSS0.Px2.p2.12.m3.1" class="ltx_Math" alttext="\phi_{U_{m}}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.12.m3.1a"><msub id="S4.SS1.SSS0.Px2.p2.12.m3.1.1" xref="S4.SS1.SSS0.Px2.p2.12.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.12.m3.1.1.2" xref="S4.SS1.SSS0.Px2.p2.12.m3.1.1.2.cmml">ϕ</mi><msub id="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3" xref="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3.2" xref="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3.2.cmml">U</mi><mi id="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3.3" xref="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3.3.cmml">m</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.12.m3.1b"><apply id="S4.SS1.SSS0.Px2.p2.12.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.12.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.12.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.12.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.12.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.12.m3.1.1.2">italic-ϕ</ci><apply id="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3.2">𝑈</ci><ci id="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p2.12.m3.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.12.m3.1c">\phi_{U_{m}}</annotation></semantics></math> for the next <math id="S4.SS1.SSS0.Px2.p2.13.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.13.m4.1a"><mi id="S4.SS1.SSS0.Px2.p2.13.m4.1.1" xref="S4.SS1.SSS0.Px2.p2.13.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.13.m4.1b"><ci id="S4.SS1.SSS0.Px2.p2.13.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.13.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.13.m4.1c">\tau</annotation></semantics></math> rounds. After client grouping step, the proposed method proceeds to the following three steps as outlined in <span id="S4.SS1.SSS0.Px2.p2.14.1" class="ltx_text ltx_markedasmath">FedBis</span>.</p>
</div>
<div id="S4.SS1.SSS0.Px2.p3" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p3.10" class="ltx_p"><span id="S4.SS1.SSS0.Px2.p3.10.1" class="ltx_text ltx_font_italic">Step 2.2: Model Broadcast.</span> Similar to <span id="S4.SS1.SSS0.Px2.p3.10.2" class="ltx_text ltx_markedasmath">FedBis</span>, the server samples <math id="S4.SS1.SSS0.Px2.p3.2.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS1.SSS0.Px2.p3.2.m2.1a"><mi id="S4.SS1.SSS0.Px2.p3.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p3.2.m2.1b"><ci id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p3.2.m2.1c">A</annotation></semantics></math> clients from all clients <math id="S4.SS1.SSS0.Px2.p3.3.m3.1" class="ltx_Math" alttext="[M]" display="inline"><semantics id="S4.SS1.SSS0.Px2.p3.3.m3.1a"><mrow id="S4.SS1.SSS0.Px2.p3.3.m3.1.2.2" xref="S4.SS1.SSS0.Px2.p3.3.m3.1.2.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p3.3.m3.1.2.2.1" xref="S4.SS1.SSS0.Px2.p3.3.m3.1.2.1.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px2.p3.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p3.3.m3.1.1.cmml">M</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p3.3.m3.1.2.2.2" xref="S4.SS1.SSS0.Px2.p3.3.m3.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p3.3.m3.1b"><apply id="S4.SS1.SSS0.Px2.p3.3.m3.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p3.3.m3.1.2.2"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p3.3.m3.1.2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.3.m3.1.2.2.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px2.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.3.m3.1.1">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p3.3.m3.1c">[M]</annotation></semantics></math>, denoted by <math id="S4.SS1.SSS0.Px2.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p3.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p3.4.m4.1.1" xref="S4.SS1.SSS0.Px2.p3.4.m4.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p3.4.m4.1b"><ci id="S4.SS1.SSS0.Px2.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.4.m4.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p3.4.m4.1c">\mathcal{A}</annotation></semantics></math>. For each selected client <math id="S4.SS1.SSS0.Px2.p3.5.m5.1" class="ltx_Math" alttext="m\in\mathcal{A}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p3.5.m5.1a"><mrow id="S4.SS1.SSS0.Px2.p3.5.m5.1.1" xref="S4.SS1.SSS0.Px2.p3.5.m5.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p3.5.m5.1.1.2" xref="S4.SS1.SSS0.Px2.p3.5.m5.1.1.2.cmml">m</mi><mo id="S4.SS1.SSS0.Px2.p3.5.m5.1.1.1" xref="S4.SS1.SSS0.Px2.p3.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p3.5.m5.1.1.3" xref="S4.SS1.SSS0.Px2.p3.5.m5.1.1.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p3.5.m5.1b"><apply id="S4.SS1.SSS0.Px2.p3.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.5.m5.1.1"><in id="S4.SS1.SSS0.Px2.p3.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.5.m5.1.1.1"></in><ci id="S4.SS1.SSS0.Px2.p3.5.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p3.5.m5.1.1.2">𝑚</ci><ci id="S4.SS1.SSS0.Px2.p3.5.m5.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p3.5.m5.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p3.5.m5.1c">m\in\mathcal{A}</annotation></semantics></math>, the server transmits the selector <math id="S4.SS1.SSS0.Px2.p3.6.m6.2" class="ltx_Math" alttext="\phi_{U_{m},r}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p3.6.m6.2a"><msub id="S4.SS1.SSS0.Px2.p3.6.m6.2.3" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.3.cmml"><mi id="S4.SS1.SSS0.Px2.p3.6.m6.2.3.2" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.3.2.cmml">ϕ</mi><mrow id="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.3.cmml"><msub id="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1.cmml"><mi id="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1.2" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1.2.cmml">U</mi><mi id="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1.3" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1.3.cmml">m</mi></msub><mo id="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p3.6.m6.1.1.1.1" xref="S4.SS1.SSS0.Px2.p3.6.m6.1.1.1.1.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p3.6.m6.2b"><apply id="S4.SS1.SSS0.Px2.p3.6.m6.2.3.cmml" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p3.6.m6.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p3.6.m6.2.3.2.cmml" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.3.2">italic-ϕ</ci><list id="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2"><apply id="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1.2">𝑈</ci><ci id="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1.3.cmml" xref="S4.SS1.SSS0.Px2.p3.6.m6.2.2.2.2.1.3">𝑚</ci></apply><ci id="S4.SS1.SSS0.Px2.p3.6.m6.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.6.m6.1.1.1.1">𝑟</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p3.6.m6.2c">\phi_{U_{m},r}</annotation></semantics></math>. This process can be characterized by defining <math id="S4.SS1.SSS0.Px2.p3.7.m7.1" class="ltx_Math" alttext="\mathcal{A}_{u}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p3.7.m7.1a"><msub id="S4.SS1.SSS0.Px2.p3.7.m7.1.1" xref="S4.SS1.SSS0.Px2.p3.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p3.7.m7.1.1.2" xref="S4.SS1.SSS0.Px2.p3.7.m7.1.1.2.cmml">𝒜</mi><mi id="S4.SS1.SSS0.Px2.p3.7.m7.1.1.3" xref="S4.SS1.SSS0.Px2.p3.7.m7.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p3.7.m7.1b"><apply id="S4.SS1.SSS0.Px2.p3.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p3.7.m7.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p3.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p3.7.m7.1.1.2">𝒜</ci><ci id="S4.SS1.SSS0.Px2.p3.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p3.7.m7.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p3.7.m7.1c">\mathcal{A}_{u}</annotation></semantics></math> as the group of clients chosen to train the selector <math id="S4.SS1.SSS0.Px2.p3.8.m8.1" class="ltx_Math" alttext="\phi_{u}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p3.8.m8.1a"><msub id="S4.SS1.SSS0.Px2.p3.8.m8.1.1" xref="S4.SS1.SSS0.Px2.p3.8.m8.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p3.8.m8.1.1.2" xref="S4.SS1.SSS0.Px2.p3.8.m8.1.1.2.cmml">ϕ</mi><mi id="S4.SS1.SSS0.Px2.p3.8.m8.1.1.3" xref="S4.SS1.SSS0.Px2.p3.8.m8.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p3.8.m8.1b"><apply id="S4.SS1.SSS0.Px2.p3.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p3.8.m8.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p3.8.m8.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p3.8.m8.1.1.2">italic-ϕ</ci><ci id="S4.SS1.SSS0.Px2.p3.8.m8.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p3.8.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p3.8.m8.1c">\phi_{u}</annotation></semantics></math>. This ensures that <math id="S4.SS1.SSS0.Px2.p3.9.m9.1" class="ltx_Math" alttext="\cup_{u\in[U]}\mathcal{A}_{u}=\mathcal{A}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p3.9.m9.1a"><mrow id="S4.SS1.SSS0.Px2.p3.9.m9.1.2" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.cmml"><mrow id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.cmml"><msub id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.1" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.1.cmml"><mo id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.1.2" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.1.2.cmml">∪</mo><mrow id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.3" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.3.cmml">u</mi><mo id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.2" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.2.cmml">∈</mo><mrow id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.4.2" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.4.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.4.2.1" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.4.1.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.1" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.4.2.2" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><msub id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2.2" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2.2.cmml">𝒜</mi><mi id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2.3" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2.3.cmml">u</mi></msub></mrow><mo id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.1" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.1.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.3" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p3.9.m9.1b"><apply id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2"><eq id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.1"></eq><apply id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2"><apply id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.1">subscript</csymbol><union id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.1.2"></union><apply id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1"><in id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.2"></in><ci id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.3">𝑢</ci><apply id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.4.1.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.4.2"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.1.1.1">𝑈</ci></apply></apply></apply><apply id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2.2">𝒜</ci><ci id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.2.2.3">𝑢</ci></apply></apply><ci id="S4.SS1.SSS0.Px2.p3.9.m9.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p3.9.m9.1.2.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p3.9.m9.1c">\cup_{u\in[U]}\mathcal{A}_{u}=\mathcal{A}</annotation></semantics></math> and <math id="S4.SS1.SSS0.Px2.p3.10.m10.1" class="ltx_Math" alttext="\cap_{u\in[U]}\mathcal{A}_{u}=\emptyset" display="inline"><semantics id="S4.SS1.SSS0.Px2.p3.10.m10.1a"><mrow id="S4.SS1.SSS0.Px2.p3.10.m10.1.2" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.cmml"><mrow id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.cmml"><msub id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.1" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.1.cmml"><mo id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.1.2" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.1.2.cmml">∩</mo><mrow id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.3" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.3.cmml">u</mi><mo id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.2" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.2.cmml">∈</mo><mrow id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.4.2" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.4.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.4.2.1" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.4.1.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.1" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.4.2.2" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><msub id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2.2" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2.2.cmml">𝒜</mi><mi id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2.3" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2.3.cmml">u</mi></msub></mrow><mo id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.1" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.1.cmml">=</mo><mi mathvariant="normal" id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.3" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p3.10.m10.1b"><apply id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2"><eq id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.1"></eq><apply id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2"><apply id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.1">subscript</csymbol><intersect id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.1.2"></intersect><apply id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1"><in id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.2"></in><ci id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.3">𝑢</ci><apply id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.4.1.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.4.2"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.1.1.1">𝑈</ci></apply></apply></apply><apply id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2.2">𝒜</ci><ci id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.2.2.3">𝑢</ci></apply></apply><emptyset id="S4.SS1.SSS0.Px2.p3.10.m10.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p3.10.m10.1.2.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p3.10.m10.1c">\cap_{u\in[U]}\mathcal{A}_{u}=\emptyset</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.SSS0.Px2.p4" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p4.4" class="ltx_p"><span id="S4.SS1.SSS0.Px2.p4.4.1" class="ltx_text ltx_font_italic">Step 2.3: Local Training.</span> The client <math id="S4.SS1.SSS0.Px2.p4.1.m1.1" class="ltx_Math" alttext="m\in\mathcal{A}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p4.1.m1.1a"><mrow id="S4.SS1.SSS0.Px2.p4.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.2" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.2.cmml">m</mi><mo id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p4.1.m1.1b"><apply id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1"><in id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1"></in><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.2">𝑚</ci><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p4.1.m1.1c">m\in\mathcal{A}</annotation></semantics></math> receives a binary selector <math id="S4.SS1.SSS0.Px2.p4.2.m2.2" class="ltx_Math" alttext="\phi_{U_{m},r}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p4.2.m2.2a"><msub id="S4.SS1.SSS0.Px2.p4.2.m2.2.3" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.3.cmml"><mi id="S4.SS1.SSS0.Px2.p4.2.m2.2.3.2" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.3.2.cmml">ϕ</mi><mrow id="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.3.cmml"><msub id="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1.cmml"><mi id="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1.2" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1.2.cmml">U</mi><mi id="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1.3" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1.3.cmml">m</mi></msub><mo id="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p4.2.m2.1.1.1.1" xref="S4.SS1.SSS0.Px2.p4.2.m2.1.1.1.1.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p4.2.m2.2b"><apply id="S4.SS1.SSS0.Px2.p4.2.m2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p4.2.m2.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p4.2.m2.2.3.2.cmml" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.3.2">italic-ϕ</ci><list id="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2"><apply id="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1.2">𝑈</ci><ci id="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1.3.cmml" xref="S4.SS1.SSS0.Px2.p4.2.m2.2.2.2.2.1.3">𝑚</ci></apply><ci id="S4.SS1.SSS0.Px2.p4.2.m2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.2.m2.1.1.1.1">𝑟</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p4.2.m2.2c">\phi_{U_{m},r}</annotation></semantics></math> from the server and trains the selector for <math id="S4.SS1.SSS0.Px2.p4.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS1.SSS0.Px2.p4.3.m3.1a"><mi id="S4.SS1.SSS0.Px2.p4.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p4.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p4.3.m3.1b"><ci id="S4.SS1.SSS0.Px2.p4.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p4.3.m3.1c">K</annotation></semantics></math> iterations following the update rule of Equation (<a href="#S3.E3" title="In Step 2: Local Training. ‣ 3.1.2 Algorithm Design ‣ 3.1 Preference Modeling ‣ 3 FedBis: A Feasible Framework for Achieving RLHF in FL ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). Finally, let the updated local selector be <math id="S4.SS1.SSS0.Px2.p4.4.m4.3" class="ltx_Math" alttext="\phi_{U_{m},r,K}^{m}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p4.4.m4.3a"><msubsup id="S4.SS1.SSS0.Px2.p4.4.m4.3.4" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.4.cmml"><mi id="S4.SS1.SSS0.Px2.p4.4.m4.3.4.2.2" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.4.2.2.cmml">ϕ</mi><mrow id="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.4.cmml"><msub id="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1.cmml"><mi id="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1.2" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1.2.cmml">U</mi><mi id="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1.3" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1.3.cmml">m</mi></msub><mo id="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.2" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.4.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p4.4.m4.1.1.1.1" xref="S4.SS1.SSS0.Px2.p4.4.m4.1.1.1.1.cmml">r</mi><mo id="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.3" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.4.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p4.4.m4.2.2.2.2" xref="S4.SS1.SSS0.Px2.p4.4.m4.2.2.2.2.cmml">K</mi></mrow><mi id="S4.SS1.SSS0.Px2.p4.4.m4.3.4.3" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.4.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p4.4.m4.3b"><apply id="S4.SS1.SSS0.Px2.p4.4.m4.3.4.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p4.4.m4.3.4.1.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.4">superscript</csymbol><apply id="S4.SS1.SSS0.Px2.p4.4.m4.3.4.2.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p4.4.m4.3.4.2.1.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p4.4.m4.3.4.2.2.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.4.2.2">italic-ϕ</ci><list id="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.4.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3"><apply id="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1.2.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1.2">𝑈</ci><ci id="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1.3.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.3.3.3.1.3">𝑚</ci></apply><ci id="S4.SS1.SSS0.Px2.p4.4.m4.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.1.1.1.1">𝑟</ci><ci id="S4.SS1.SSS0.Px2.p4.4.m4.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.2.2.2.2">𝐾</ci></list></apply><ci id="S4.SS1.SSS0.Px2.p4.4.m4.3.4.3.cmml" xref="S4.SS1.SSS0.Px2.p4.4.m4.3.4.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p4.4.m4.3c">\phi_{U_{m},r,K}^{m}</annotation></semantics></math>, and the client pushes it to the server.</p>
</div>
<div id="S4.SS1.SSS0.Px2.p5" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p5.2" class="ltx_p"><span id="S4.SS1.SSS0.Px2.p5.2.1" class="ltx_text ltx_font_italic">Step 2.4: Global Aggregation.</span> The server collects updated selectors from all participants <math id="S4.SS1.SSS0.Px2.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p5.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px2.p5.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p5.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p5.1.m1.1b"><ci id="S4.SS1.SSS0.Px2.p5.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p5.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p5.1.m1.1c">\mathcal{A}</annotation></semantics></math>. Since there are several binary selectors, the server updates each one with a designated group of clients intended to train on that specific selector. For instance, the aggregation rule for the selector <math id="S4.SS1.SSS0.Px2.p5.2.m2.1" class="ltx_Math" alttext="u\in[U]" display="inline"><semantics id="S4.SS1.SSS0.Px2.p5.2.m2.1a"><mrow id="S4.SS1.SSS0.Px2.p5.2.m2.1.2" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.2.cmml"><mi id="S4.SS1.SSS0.Px2.p5.2.m2.1.2.2" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.2.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px2.p5.2.m2.1.2.1" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.2.1.cmml">∈</mo><mrow id="S4.SS1.SSS0.Px2.p5.2.m2.1.2.3.2" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p5.2.m2.1.2.3.2.1" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.2.3.1.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px2.p5.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p5.2.m2.1.2.3.2.2" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p5.2.m2.1b"><apply id="S4.SS1.SSS0.Px2.p5.2.m2.1.2.cmml" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.2"><in id="S4.SS1.SSS0.Px2.p5.2.m2.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.2.1"></in><ci id="S4.SS1.SSS0.Px2.p5.2.m2.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.2.2">𝑢</ci><apply id="S4.SS1.SSS0.Px2.p5.2.m2.1.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.2.3.2"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p5.2.m2.1.2.3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px2.p5.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p5.2.m2.1.1">𝑈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p5.2.m2.1c">u\in[U]</annotation></semantics></math> follows</p>
<table id="A2.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E8.m1.8" class="ltx_Math" alttext="\displaystyle\phi_{u,r+1}=\left(1-\sum_{m\in\mathcal{A}_{u}}p_{m}\right)\phi_{u,r}+\sum_{m\in\mathcal{A}_{u}}p_{m}\phi_{u,r,K}^{m}" display="inline"><semantics id="S4.E8.m1.8a"><mrow id="S4.E8.m1.8.8" xref="S4.E8.m1.8.8.cmml"><msub id="S4.E8.m1.8.8.3" xref="S4.E8.m1.8.8.3.cmml"><mi id="S4.E8.m1.8.8.3.2" xref="S4.E8.m1.8.8.3.2.cmml">ϕ</mi><mrow id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.3.cmml"><mi id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml">u</mi><mo id="S4.E8.m1.2.2.2.2.2" xref="S4.E8.m1.2.2.2.3.cmml">,</mo><mrow id="S4.E8.m1.2.2.2.2.1" xref="S4.E8.m1.2.2.2.2.1.cmml"><mi id="S4.E8.m1.2.2.2.2.1.2" xref="S4.E8.m1.2.2.2.2.1.2.cmml">r</mi><mo id="S4.E8.m1.2.2.2.2.1.1" xref="S4.E8.m1.2.2.2.2.1.1.cmml">+</mo><mn id="S4.E8.m1.2.2.2.2.1.3" xref="S4.E8.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S4.E8.m1.8.8.2" xref="S4.E8.m1.8.8.2.cmml">=</mo><mrow id="S4.E8.m1.8.8.1" xref="S4.E8.m1.8.8.1.cmml"><mrow id="S4.E8.m1.8.8.1.1" xref="S4.E8.m1.8.8.1.1.cmml"><mrow id="S4.E8.m1.8.8.1.1.1.1" xref="S4.E8.m1.8.8.1.1.1.1.1.cmml"><mo id="S4.E8.m1.8.8.1.1.1.1.2" xref="S4.E8.m1.8.8.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.8.8.1.1.1.1.1" xref="S4.E8.m1.8.8.1.1.1.1.1.cmml"><mn id="S4.E8.m1.8.8.1.1.1.1.1.2" xref="S4.E8.m1.8.8.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E8.m1.8.8.1.1.1.1.1.1" xref="S4.E8.m1.8.8.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E8.m1.8.8.1.1.1.1.1.3" xref="S4.E8.m1.8.8.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S4.E8.m1.8.8.1.1.1.1.1.3.1" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.cmml"><munder id="S4.E8.m1.8.8.1.1.1.1.1.3.1a" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S4.E8.m1.8.8.1.1.1.1.1.3.1.2" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.cmml"><mi id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.2" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.2.cmml">m</mi><mo id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.1" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.1.cmml">∈</mo><msub id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3.2" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3.2.cmml">𝒜</mi><mi id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3.3" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3.3.cmml">u</mi></msub></mrow></munder></mstyle><msub id="S4.E8.m1.8.8.1.1.1.1.1.3.2" xref="S4.E8.m1.8.8.1.1.1.1.1.3.2.cmml"><mi id="S4.E8.m1.8.8.1.1.1.1.1.3.2.2" xref="S4.E8.m1.8.8.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S4.E8.m1.8.8.1.1.1.1.1.3.2.3" xref="S4.E8.m1.8.8.1.1.1.1.1.3.2.3.cmml">m</mi></msub></mrow></mrow><mo id="S4.E8.m1.8.8.1.1.1.1.3" xref="S4.E8.m1.8.8.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E8.m1.8.8.1.1.2" xref="S4.E8.m1.8.8.1.1.2.cmml">​</mo><msub id="S4.E8.m1.8.8.1.1.3" xref="S4.E8.m1.8.8.1.1.3.cmml"><mi id="S4.E8.m1.8.8.1.1.3.2" xref="S4.E8.m1.8.8.1.1.3.2.cmml">ϕ</mi><mrow id="S4.E8.m1.4.4.2.4" xref="S4.E8.m1.4.4.2.3.cmml"><mi id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1.cmml">u</mi><mo id="S4.E8.m1.4.4.2.4.1" xref="S4.E8.m1.4.4.2.3.cmml">,</mo><mi id="S4.E8.m1.4.4.2.2" xref="S4.E8.m1.4.4.2.2.cmml">r</mi></mrow></msub></mrow><mo id="S4.E8.m1.8.8.1.2" xref="S4.E8.m1.8.8.1.2.cmml">+</mo><mrow id="S4.E8.m1.8.8.1.3" xref="S4.E8.m1.8.8.1.3.cmml"><mstyle displaystyle="true" id="S4.E8.m1.8.8.1.3.1" xref="S4.E8.m1.8.8.1.3.1.cmml"><munder id="S4.E8.m1.8.8.1.3.1a" xref="S4.E8.m1.8.8.1.3.1.cmml"><mo movablelimits="false" id="S4.E8.m1.8.8.1.3.1.2" xref="S4.E8.m1.8.8.1.3.1.2.cmml">∑</mo><mrow id="S4.E8.m1.8.8.1.3.1.3" xref="S4.E8.m1.8.8.1.3.1.3.cmml"><mi id="S4.E8.m1.8.8.1.3.1.3.2" xref="S4.E8.m1.8.8.1.3.1.3.2.cmml">m</mi><mo id="S4.E8.m1.8.8.1.3.1.3.1" xref="S4.E8.m1.8.8.1.3.1.3.1.cmml">∈</mo><msub id="S4.E8.m1.8.8.1.3.1.3.3" xref="S4.E8.m1.8.8.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.8.8.1.3.1.3.3.2" xref="S4.E8.m1.8.8.1.3.1.3.3.2.cmml">𝒜</mi><mi id="S4.E8.m1.8.8.1.3.1.3.3.3" xref="S4.E8.m1.8.8.1.3.1.3.3.3.cmml">u</mi></msub></mrow></munder></mstyle><mrow id="S4.E8.m1.8.8.1.3.2" xref="S4.E8.m1.8.8.1.3.2.cmml"><msub id="S4.E8.m1.8.8.1.3.2.2" xref="S4.E8.m1.8.8.1.3.2.2.cmml"><mi id="S4.E8.m1.8.8.1.3.2.2.2" xref="S4.E8.m1.8.8.1.3.2.2.2.cmml">p</mi><mi id="S4.E8.m1.8.8.1.3.2.2.3" xref="S4.E8.m1.8.8.1.3.2.2.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.8.8.1.3.2.1" xref="S4.E8.m1.8.8.1.3.2.1.cmml">​</mo><msubsup id="S4.E8.m1.8.8.1.3.2.3" xref="S4.E8.m1.8.8.1.3.2.3.cmml"><mi id="S4.E8.m1.8.8.1.3.2.3.2.2" xref="S4.E8.m1.8.8.1.3.2.3.2.2.cmml">ϕ</mi><mrow id="S4.E8.m1.7.7.3.5" xref="S4.E8.m1.7.7.3.4.cmml"><mi id="S4.E8.m1.5.5.1.1" xref="S4.E8.m1.5.5.1.1.cmml">u</mi><mo id="S4.E8.m1.7.7.3.5.1" xref="S4.E8.m1.7.7.3.4.cmml">,</mo><mi id="S4.E8.m1.6.6.2.2" xref="S4.E8.m1.6.6.2.2.cmml">r</mi><mo id="S4.E8.m1.7.7.3.5.2" xref="S4.E8.m1.7.7.3.4.cmml">,</mo><mi id="S4.E8.m1.7.7.3.3" xref="S4.E8.m1.7.7.3.3.cmml">K</mi></mrow><mi id="S4.E8.m1.8.8.1.3.2.3.3" xref="S4.E8.m1.8.8.1.3.2.3.3.cmml">m</mi></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.8b"><apply id="S4.E8.m1.8.8.cmml" xref="S4.E8.m1.8.8"><eq id="S4.E8.m1.8.8.2.cmml" xref="S4.E8.m1.8.8.2"></eq><apply id="S4.E8.m1.8.8.3.cmml" xref="S4.E8.m1.8.8.3"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.3.1.cmml" xref="S4.E8.m1.8.8.3">subscript</csymbol><ci id="S4.E8.m1.8.8.3.2.cmml" xref="S4.E8.m1.8.8.3.2">italic-ϕ</ci><list id="S4.E8.m1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.2"><ci id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1">𝑢</ci><apply id="S4.E8.m1.2.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.2.1"><plus id="S4.E8.m1.2.2.2.2.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1"></plus><ci id="S4.E8.m1.2.2.2.2.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1.2">𝑟</ci><cn type="integer" id="S4.E8.m1.2.2.2.2.1.3.cmml" xref="S4.E8.m1.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="S4.E8.m1.8.8.1.cmml" xref="S4.E8.m1.8.8.1"><plus id="S4.E8.m1.8.8.1.2.cmml" xref="S4.E8.m1.8.8.1.2"></plus><apply id="S4.E8.m1.8.8.1.1.cmml" xref="S4.E8.m1.8.8.1.1"><times id="S4.E8.m1.8.8.1.1.2.cmml" xref="S4.E8.m1.8.8.1.1.2"></times><apply id="S4.E8.m1.8.8.1.1.1.1.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1"><minus id="S4.E8.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E8.m1.8.8.1.1.1.1.1.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.2">1</cn><apply id="S4.E8.m1.8.8.1.1.1.1.1.3.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3"><apply id="S4.E8.m1.8.8.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.1.1.1.3.1.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1">subscript</csymbol><sum id="S4.E8.m1.8.8.1.1.1.1.1.3.1.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.2"></sum><apply id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3"><in id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.1"></in><ci id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.2">𝑚</ci><apply id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3">subscript</csymbol><ci id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3.2">𝒜</ci><ci id="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3.3.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.1.3.3.3">𝑢</ci></apply></apply></apply><apply id="S4.E8.m1.8.8.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E8.m1.8.8.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S4.E8.m1.8.8.1.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.3.2.3">𝑚</ci></apply></apply></apply><apply id="S4.E8.m1.8.8.1.1.3.cmml" xref="S4.E8.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.3.1.cmml" xref="S4.E8.m1.8.8.1.1.3">subscript</csymbol><ci id="S4.E8.m1.8.8.1.1.3.2.cmml" xref="S4.E8.m1.8.8.1.1.3.2">italic-ϕ</ci><list id="S4.E8.m1.4.4.2.3.cmml" xref="S4.E8.m1.4.4.2.4"><ci id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1.1">𝑢</ci><ci id="S4.E8.m1.4.4.2.2.cmml" xref="S4.E8.m1.4.4.2.2">𝑟</ci></list></apply></apply><apply id="S4.E8.m1.8.8.1.3.cmml" xref="S4.E8.m1.8.8.1.3"><apply id="S4.E8.m1.8.8.1.3.1.cmml" xref="S4.E8.m1.8.8.1.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.3.1.1.cmml" xref="S4.E8.m1.8.8.1.3.1">subscript</csymbol><sum id="S4.E8.m1.8.8.1.3.1.2.cmml" xref="S4.E8.m1.8.8.1.3.1.2"></sum><apply id="S4.E8.m1.8.8.1.3.1.3.cmml" xref="S4.E8.m1.8.8.1.3.1.3"><in id="S4.E8.m1.8.8.1.3.1.3.1.cmml" xref="S4.E8.m1.8.8.1.3.1.3.1"></in><ci id="S4.E8.m1.8.8.1.3.1.3.2.cmml" xref="S4.E8.m1.8.8.1.3.1.3.2">𝑚</ci><apply id="S4.E8.m1.8.8.1.3.1.3.3.cmml" xref="S4.E8.m1.8.8.1.3.1.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.3.1.3.3.1.cmml" xref="S4.E8.m1.8.8.1.3.1.3.3">subscript</csymbol><ci id="S4.E8.m1.8.8.1.3.1.3.3.2.cmml" xref="S4.E8.m1.8.8.1.3.1.3.3.2">𝒜</ci><ci id="S4.E8.m1.8.8.1.3.1.3.3.3.cmml" xref="S4.E8.m1.8.8.1.3.1.3.3.3">𝑢</ci></apply></apply></apply><apply id="S4.E8.m1.8.8.1.3.2.cmml" xref="S4.E8.m1.8.8.1.3.2"><times id="S4.E8.m1.8.8.1.3.2.1.cmml" xref="S4.E8.m1.8.8.1.3.2.1"></times><apply id="S4.E8.m1.8.8.1.3.2.2.cmml" xref="S4.E8.m1.8.8.1.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.3.2.2.1.cmml" xref="S4.E8.m1.8.8.1.3.2.2">subscript</csymbol><ci id="S4.E8.m1.8.8.1.3.2.2.2.cmml" xref="S4.E8.m1.8.8.1.3.2.2.2">𝑝</ci><ci id="S4.E8.m1.8.8.1.3.2.2.3.cmml" xref="S4.E8.m1.8.8.1.3.2.2.3">𝑚</ci></apply><apply id="S4.E8.m1.8.8.1.3.2.3.cmml" xref="S4.E8.m1.8.8.1.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.3.2.3.1.cmml" xref="S4.E8.m1.8.8.1.3.2.3">superscript</csymbol><apply id="S4.E8.m1.8.8.1.3.2.3.2.cmml" xref="S4.E8.m1.8.8.1.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.3.2.3.2.1.cmml" xref="S4.E8.m1.8.8.1.3.2.3">subscript</csymbol><ci id="S4.E8.m1.8.8.1.3.2.3.2.2.cmml" xref="S4.E8.m1.8.8.1.3.2.3.2.2">italic-ϕ</ci><list id="S4.E8.m1.7.7.3.4.cmml" xref="S4.E8.m1.7.7.3.5"><ci id="S4.E8.m1.5.5.1.1.cmml" xref="S4.E8.m1.5.5.1.1">𝑢</ci><ci id="S4.E8.m1.6.6.2.2.cmml" xref="S4.E8.m1.6.6.2.2">𝑟</ci><ci id="S4.E8.m1.7.7.3.3.cmml" xref="S4.E8.m1.7.7.3.3">𝐾</ci></list></apply><ci id="S4.E8.m1.8.8.1.3.2.3.3.cmml" xref="S4.E8.m1.8.8.1.3.2.3.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.8c">\displaystyle\phi_{u,r+1}=\left(1-\sum_{m\in\mathcal{A}_{u}}p_{m}\right)\phi_{u,r}+\sum_{m\in\mathcal{A}_{u}}p_{m}\phi_{u,r,K}^{m}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS0.Px2.p5.3" class="ltx_p">It is noted that performance degradation occurs when a model is trained by clients with time-varying sizes in FedAvg <cite class="ltx_cite ltx_citemacro_cite">Gu et al. (<a href="#bib.bib17" title="" class="ltx_ref">2021</a>); Wang and Ji (<a href="#bib.bib44" title="" class="ltx_ref">2023</a>)</cite>. In other words, Equation (<a href="#S3.E4" title="In Step 3: Global Aggregation. ‣ 3.1.2 Algorithm Design ‣ 3.1 Preference Modeling ‣ 3 FedBis: A Feasible Framework for Achieving RLHF in FL ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) is no longer suitable for multi-selector aggregation due to the fluctuation in the number of clients training a selector in each communication round. Therefore, <span id="S4.SS1.SSS0.Px2.p5.3.1" class="ltx_text ltx_markedasmath">FedBiscuit</span> adopts a new aggregation rule as formulated in Equation (<a href="#S4.E8" title="In Phase 2: Clustered FL Training. ‣ 4.1 Algorithm Design ‣ 4 FedBiscuit: FedBis with Cluster-wise Aggregation ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>).</p>
</div>
<div id="S4.SS1.SSS0.Px2.p6" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p6.2" class="ltx_p"><span id="S4.SS1.SSS0.Px2.p6.2.1" class="ltx_text ltx_markedasmath">FedBiscuit</span> finally produces a set of well-trained selectors <math id="S4.SS1.SSS0.Px2.p6.2.m2.3" class="ltx_Math" alttext="\phi_{[U],R}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p6.2.m2.3a"><msub id="S4.SS1.SSS0.Px2.p6.2.m2.3.4" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.4.cmml"><mi id="S4.SS1.SSS0.Px2.p6.2.m2.3.4.2" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.4.2.cmml">ϕ</mi><mrow id="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.4.cmml"><mrow id="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3.1.2" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3.1.2.1" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3.1.1.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px2.p6.2.m2.1.1.1.1" xref="S4.SS1.SSS0.Px2.p6.2.m2.1.1.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3.1.2.2" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3.1.1.1.cmml">]</mo></mrow><mo id="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3.2" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.4.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p6.2.m2.2.2.2.2" xref="S4.SS1.SSS0.Px2.p6.2.m2.2.2.2.2.cmml">R</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p6.2.m2.3b"><apply id="S4.SS1.SSS0.Px2.p6.2.m2.3.4.cmml" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p6.2.m2.3.4.1.cmml" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.4">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p6.2.m2.3.4.2.cmml" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.4.2">italic-ϕ</ci><list id="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.4.cmml" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3"><apply id="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3.1.2"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p6.2.m2.3.3.3.3.1.2.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px2.p6.2.m2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p6.2.m2.1.1.1.1">𝑈</ci></apply><ci id="S4.SS1.SSS0.Px2.p6.2.m2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p6.2.m2.2.2.2.2">𝑅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p6.2.m2.3c">\phi_{[U],R}</annotation></semantics></math> and he subsequent objective is to enhance LLM performance with the help of these selectors, as explored below.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Reinforcement-learning Fine-tuning with Multiple Selectors.</h5>

<div id="S4.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px3.p1.7" class="ltx_p">We can leverage the methodology mentioned in Section <a href="#S3.SS2" title="3.2 Reinforcement-learning Fine-tuning ‣ 3 FedBis: A Feasible Framework for Achieving RLHF in FL ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, and one of the key steps involves constructing a preference dataset incorporating multiple selectors. For this, we employ a strategy of majority voting. Given an instruction <math id="S4.SS1.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="x\in\hat{\mathcal{D}}" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.1.m1.1a"><mrow id="S4.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml">x</mi><mo id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml">∈</mo><mover accent="true" id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.2" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.2.cmml">𝒟</mi><mo id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1"><in id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1"></in><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2">𝑥</ci><apply id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3"><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.1">^</ci><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.2">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.1.m1.1c">x\in\hat{\mathcal{D}}</annotation></semantics></math> and a pair of generated completions <math id="S4.SS1.SSS0.Px3.p1.2.m2.2" class="ltx_Math" alttext="(y_{0},y_{1})" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.2.m2.2a"><mrow id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.3" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.3.cmml">(</mo><msub id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.2" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.2.cmml">y</mi><mn id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.3" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.3.cmml">0</mn></msub><mo id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.4" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2.cmml"><mi id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2.2" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2.2.cmml">y</mi><mn id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2.3" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2.3.cmml">1</mn></msub><mo stretchy="false" id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.5" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.2.m2.2b"><interval closure="open" id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2"><apply id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.2">𝑦</ci><cn type="integer" id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.3">0</cn></apply><apply id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2.2">𝑦</ci><cn type="integer" id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.2.2.3">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.2.m2.2c">(y_{0},y_{1})</annotation></semantics></math>, we assume a selector <math id="S4.SS1.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="u\in[U]" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.3.m3.1a"><mrow id="S4.SS1.SSS0.Px3.p1.3.m3.1.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.2.cmml"><mi id="S4.SS1.SSS0.Px3.p1.3.m3.1.2.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.2.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px3.p1.3.m3.1.2.1" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.2.1.cmml">∈</mo><mrow id="S4.SS1.SSS0.Px3.p1.3.m3.1.2.3.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px3.p1.3.m3.1.2.3.2.1" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.2.3.1.1.cmml">[</mo><mi id="S4.SS1.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS1.SSS0.Px3.p1.3.m3.1.2.3.2.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px3.p1.3.m3.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.2"><in id="S4.SS1.SSS0.Px3.p1.3.m3.1.2.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.2.1"></in><ci id="S4.SS1.SSS0.Px3.p1.3.m3.1.2.2.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.2.2">𝑢</ci><apply id="S4.SS1.SSS0.Px3.p1.3.m3.1.2.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.2.3.2"><csymbol cd="latexml" id="S4.SS1.SSS0.Px3.p1.3.m3.1.2.3.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1">𝑈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.3.m3.1c">u\in[U]</annotation></semantics></math> prefers <math id="S4.SS1.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="y_{i_{u}}" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.4.m4.1a"><msub id="S4.SS1.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.2" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.2.cmml">y</mi><msub id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.2" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.2.cmml">i</mi><mi id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.3" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.cmml">u</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.4.m4.1b"><apply id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.2">𝑦</ci><apply id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.2">𝑖</ci><ci id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.4.m4.1c">y_{i_{u}}</annotation></semantics></math>, where <math id="S4.SS1.SSS0.Px3.p1.5.m5.2" class="ltx_Math" alttext="i_{u}\in\{0,1\}" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.5.m5.2a"><mrow id="S4.SS1.SSS0.Px3.p1.5.m5.2.3" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.cmml"><msub id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2.cmml"><mi id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2.2" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2.2.cmml">i</mi><mi id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2.3" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2.3.cmml">u</mi></msub><mo id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.1" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.1.cmml">∈</mo><mrow id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.3.2" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.3.2.1" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.3.1.cmml">{</mo><mn id="S4.SS1.SSS0.Px3.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.cmml">0</mn><mo id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.3.2.2" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.3.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px3.p1.5.m5.2.2" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.3.2.3" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.5.m5.2b"><apply id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3"><in id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.1"></in><apply id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2.2">𝑖</ci><ci id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2.3.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.2.3">𝑢</ci></apply><set id="S4.SS1.SSS0.Px3.p1.5.m5.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.3.3.2"><cn type="integer" id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1">0</cn><cn type="integer" id="S4.SS1.SSS0.Px3.p1.5.m5.2.2.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.5.m5.2c">i_{u}\in\{0,1\}</annotation></semantics></math>. Therefore, the pair is assigned a label <math id="S4.SS1.SSS0.Px3.p1.6.m6.2" class="ltx_math_unparsed" alttext="i=\arg\max\{i_{u}\}_{u\in[U]}" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.6.m6.2a"><mrow id="S4.SS1.SSS0.Px3.p1.6.m6.2b"><mi id="S4.SS1.SSS0.Px3.p1.6.m6.2.3">i</mi><mo id="S4.SS1.SSS0.Px3.p1.6.m6.2.4">=</mo><mi id="S4.SS1.SSS0.Px3.p1.6.m6.2.5">arg</mi><mi id="S4.SS1.SSS0.Px3.p1.6.m6.2.2">max</mi><msub id="S4.SS1.SSS0.Px3.p1.6.m6.2.6"><mrow id="S4.SS1.SSS0.Px3.p1.6.m6.2.6.2"><mo stretchy="false" id="S4.SS1.SSS0.Px3.p1.6.m6.2.6.2.1">{</mo><msub id="S4.SS1.SSS0.Px3.p1.6.m6.2.6.2.2"><mi id="S4.SS1.SSS0.Px3.p1.6.m6.2.6.2.2.2">i</mi><mi id="S4.SS1.SSS0.Px3.p1.6.m6.2.6.2.2.3">u</mi></msub><mo stretchy="false" id="S4.SS1.SSS0.Px3.p1.6.m6.2.6.2.3">}</mo></mrow><mrow id="S4.SS1.SSS0.Px3.p1.6.m6.1.1.1"><mi id="S4.SS1.SSS0.Px3.p1.6.m6.1.1.1.3">u</mi><mo id="S4.SS1.SSS0.Px3.p1.6.m6.1.1.1.2">∈</mo><mrow id="S4.SS1.SSS0.Px3.p1.6.m6.1.1.1.4.2"><mo stretchy="false" id="S4.SS1.SSS0.Px3.p1.6.m6.1.1.1.4.2.1">[</mo><mi id="S4.SS1.SSS0.Px3.p1.6.m6.1.1.1.1">U</mi><mo stretchy="false" id="S4.SS1.SSS0.Px3.p1.6.m6.1.1.1.4.2.2">]</mo></mrow></mrow></msub></mrow><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.6.m6.2c">i=\arg\max\{i_{u}\}_{u\in[U]}</annotation></semantics></math>, meaning that the completion <math id="S4.SS1.SSS0.Px3.p1.7.m7.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.7.m7.1a"><msub id="S4.SS1.SSS0.Px3.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px3.p1.7.m7.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.7.m7.1.1.2" xref="S4.SS1.SSS0.Px3.p1.7.m7.1.1.2.cmml">y</mi><mi id="S4.SS1.SSS0.Px3.p1.7.m7.1.1.3" xref="S4.SS1.SSS0.Px3.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.7.m7.1b"><apply id="S4.SS1.SSS0.Px3.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.7.m7.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.7.m7.1.1.2">𝑦</ci><ci id="S4.SS1.SSS0.Px3.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.7.m7.1c">y_{i}</annotation></semantics></math> is favored by the most clients.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Discussion: Integration with LoRA</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">As all binary selectors are LLM, training them may consume significant communication and computation overheads. Besides, multiple LLMs lead to considerable storage burdens shouldered by the server. To reduce the costs, we adopt a parameter-efficient fine-tuning approach LoRA <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a href="#bib.bib19" title="" class="ltx_ref">2021</a>)</cite>, where all binary selectors share the same base model while using different adapters.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.7" class="ltx_p">In comparison with <span id="S4.SS2.p2.7.1" class="ltx_text ltx_markedasmath">FedBis</span>, <span id="S4.SS2.p2.7.2" class="ltx_text ltx_markedasmath">FedBiscuit</span> requires extra costs, i.e., <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="O(MU\lfloor R/\tau\rfloor\cdot C)" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">​</mo><mrow id="S4.SS2.p2.3.m3.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.3.m3.1.1.1.1.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p2.3.m3.1.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.1.1.cmml"><mrow id="S4.SS2.p2.3.m3.1.1.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1.1.1.1.1.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.4" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.4.cmml">U</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1.1.1.1.1.2a" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.2.1.cmml">⌊</mo><mrow id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mo id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.1.cmml">/</mo><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo rspace="0.055em" stretchy="false" id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.2.1.cmml">⌋</mo></mrow></mrow><mo rspace="0.222em" id="S4.SS2.p2.3.m3.1.1.1.1.1.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.2.cmml">⋅</mo><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.3.cmml">C</mi></mrow><mo stretchy="false" id="S4.SS2.p2.3.m3.1.1.1.1.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><times id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2"></times><ci id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">𝑂</ci><apply id="S4.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1"><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.2">⋅</ci><apply id="S4.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1"><times id="S4.SS2.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.2"></times><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.3">𝑀</ci><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.4.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.4">𝑈</ci><apply id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1"><floor id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.2"></floor><apply id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1"><divide id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.1"></divide><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.2">𝑅</ci><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply></apply></apply><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">O(MU\lfloor R/\tau\rfloor\cdot C)</annotation></semantics></math>, where <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">C</annotation></semantics></math> is the communication cost of a selector. This is because <span id="S4.SS2.p2.7.3" class="ltx_text ltx_markedasmath">FedBiscuit</span> involves client grouping periodically, unilaterally transferring all selectors from the server to the clients. Despite the extra costs, extensive experiments demonstrate non-trivial improvement by comparing <span id="S4.SS2.p2.7.4" class="ltx_text ltx_markedasmath">FedBiscuit</span> with <span id="S4.SS2.p2.7.5" class="ltx_text ltx_markedasmath">FedBis</span>.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Federated Human Preference Benchmark</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This section mainly focuses on how we prepare federated human preference datasets, while the next section introduces the experimental setup and analyzes numerical results. Specifically, we cover two of the most common NLP tasks, i.e., summarization and question-answering. All two datasets are partitioned based on the public datasets, and the following subsections will include the details. We will release these datasets on HuggingFace soon.</p>
</div>
<section id="S5.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Summarization.</h5>

<div id="S5.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">Stiennon et al. (<a href="#bib.bib37" title="" class="ltx_ref">2020</a>)</cite> introduces a summarization dataset that consists of Reddit posts with human-written tl;dr <cite class="ltx_cite ltx_citemacro_cite">Völske et al. (<a href="#bib.bib43" title="" class="ltx_ref">2017</a>)</cite>. This dataset consists of two parts, one is a pretrained dataset, while the other is a dataset with human preference. As suggested by <cite class="ltx_cite ltx_citemacro_citet">Ouyang et al. (<a href="#bib.bib32" title="" class="ltx_ref">2022</a>)</cite>, we ensure a post does not appear in both datasets. We assume the pretrained dataset is stored on the server side, and 60% of data are served for model pertaining such that the model can perform well on summarization. The remaining 40% are used for the RLHF process to improve the LLM performance and generate human-preferred content. Since the human-preference dataset contains the worker ID, we partition the dataset based on the worker ID so that the dataset can be partitioned into 53 workers.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Question-Answering (QA).</h5>

<div id="S5.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px2.p1.1" class="ltx_p">We reconstruct the public dataset SHP, which comprises numerous questions from Reddit posts and their corresponding user answers <cite class="ltx_cite ltx_citemacro_cite">Ethayarajh et al. (<a href="#bib.bib13" title="" class="ltx_ref">2022</a>)</cite>. The preference indicator is based on the number of likes an answer receives. Given that the dataset spans 18 domains, we partition the dataset using a Dirichlet distribution with a parameter of 0.3, ensuring that no questions overlap between clients. In our experiment, we prepare 300 clients, and Figure <a href="#S5.F2" title="Figure 2 ‣ Question-Answering (QA). ‣ 5 Federated Human Preference Benchmark ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> visualizes the data distribution on the selected clients. For the RLHF process, we use a set of 2.6K Reddit questions.</p>
</div>
<figure id="S5.F2" class="ltx_figure"><img src="/html/2407.03038/assets/x2.png" id="S5.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="198" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Data distribution across different question domains on the selected clients.</figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experiments</h2>

<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Experimental Setup</h3>

<section id="S6.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Model and computation environment.</h5>

<div id="S6.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S6.SS1.SSS0.Px1.p1.1" class="ltx_p">We initialize the binary selector(s) using the pretrained LLaMA-2-7B <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a href="#bib.bib42" title="" class="ltx_ref">2023</a>)</cite>, configuring the final layer to produce binary outputs "A" and "B" only. The LLM chosen for content generation depends on the tasks: (i) For the summarization task, we start with LLaMA-2-7B and fine-tune it using a pretrained dataset; (ii) For the QA task, we initialize the LLM with Alpaca-7B <cite class="ltx_cite ltx_citemacro_cite">Taori et al. (<a href="#bib.bib40" title="" class="ltx_ref">2023</a>)</cite>. To reduce computation efforts, we employ LoRA to fine-tune the models. Our implementation, built upon FederatedScope <cite class="ltx_cite ltx_citemacro_cite">Xie et al. (<a href="#bib.bib47" title="" class="ltx_ref">2023</a>); Kuang et al. (<a href="#bib.bib23" title="" class="ltx_ref">2023</a>)</cite>, will soon be available on GitHub. The experiments are conducted on machines equipped with two Nvidia A100 GPU cards, Intel Xeon Platinum 8369B CPUs, and 256GB RAM.</p>
</div>
</section>
<section id="S6.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Evaluation.</h5>

<div id="S6.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S6.SS1.SSS0.Px2.p1.2" class="ltx_p">We evaluate two models produced by our proposed <span id="S6.SS1.SSS0.Px2.p1.2.1" class="ltx_text ltx_markedasmath">FedBis</span> and <span id="S6.SS1.SSS0.Px2.p1.2.2" class="ltx_text ltx_markedasmath">FedBiscuit</span>: a binary selector and an LLM. We employ different strategies to assess each model:</p>
<ul id="S6.I1" class="ltx_itemize">
<li id="S6.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I1.i1.p1" class="ltx_para">
<p id="S6.I1.i1.p1.3" class="ltx_p"><span id="S6.I1.i1.p1.3.1" class="ltx_text ltx_font_bold">Binary selector:</span> The evaluation includes two metrics: agreement and best-of-<math id="S6.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S6.I1.i1.p1.1.m1.1a"><mi id="S6.I1.i1.p1.1.m1.1.1" xref="S6.I1.i1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.1.m1.1b"><ci id="S6.I1.i1.p1.1.m1.1.1.cmml" xref="S6.I1.i1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.1.m1.1c">n</annotation></semantics></math>. Agreement measures the hit rate of a selector against a preference dataset annotated by humans or ChatGPT. Additionally, we use the best-of-<math id="S6.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S6.I1.i1.p1.2.m2.1a"><mi id="S6.I1.i1.p1.2.m2.1.1" xref="S6.I1.i1.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.2.m2.1b"><ci id="S6.I1.i1.p1.2.m2.1.1.cmml" xref="S6.I1.i1.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.2.m2.1c">n</annotation></semantics></math> approach by selecting the best completion from <math id="S6.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S6.I1.i1.p1.3.m3.1a"><mi id="S6.I1.i1.p1.3.m3.1.1" xref="S6.I1.i1.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.3.m3.1b"><ci id="S6.I1.i1.p1.3.m3.1.1.cmml" xref="S6.I1.i1.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.3.m3.1c">n</annotation></semantics></math> generated by a task-specific LLM. We then evaluate the average rating for the selector’s choices using Auto-J <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib24" title="" class="ltx_ref">2023a</a>)</cite>.</p>
</div>
</li>
<li id="S6.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I1.i2.p1" class="ltx_para">
<p id="S6.I1.i2.p1.1" class="ltx_p"><span id="S6.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">LLM:</span> After reinforcement-learning fine-tuning, the LLM is evaluated on its ability to generate human-preferred content. This means we can assess the quality of the generated texts. For example, given an instruction set, the LLM produces one completion per instruction, and Auto-J evaluates the average rating of these completions. Furthermore, we compare the generated completions with a reference set of responses, annotated by humans or ChatGPT, and calculate a win rate based on how often the generated response is superior to the reference one.</p>
</div>
</li>
</ul>
</div>
<div id="S6.SS1.SSS0.Px2.p2" class="ltx_para">
<p id="S6.SS1.SSS0.Px2.p2.2" class="ltx_p">Due to the space limit, the hyperparameter settings are presented in Appendix <a href="#A1" title="Appendix A More Implementation Details ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>. Moreover, Appendix <a href="#A2" title="Appendix B More Numerical Results and Analysis ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a> provides real cases to demonstrate the performance of the proposed <span id="S6.SS1.SSS0.Px2.p2.2.1" class="ltx_text ltx_markedasmath">FedBis</span> and <span id="S6.SS1.SSS0.Px2.p2.2.2" class="ltx_text ltx_markedasmath">FedBiscuit</span>. In particular, Appendix <a href="#A2.SS1" title="B.1 Numerical Results on QA ‣ Appendix B More Numerical Results and Analysis ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.1</span></a> discusses the results under the QA task.</p>
</div>
</section>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Numerical Results on Summarization</h3>

<figure id="S6.T1" class="ltx_table">
<div id="S6.T1.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:164.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(74.5pt,-28.3pt) scale(1.52338946936066,1.52338946936066) ;">
<table id="S6.T1.3.3" class="ltx_tabular ltx_align_middle">
<tr id="S6.T1.3.3.4" class="ltx_tr">
<td id="S6.T1.3.3.4.1" class="ltx_td ltx_border_r"></td>
<td id="S6.T1.3.3.4.2" class="ltx_td ltx_align_center" colspan="2">Selector</td>
<td id="S6.T1.3.3.4.3" class="ltx_td"></td>
<td id="S6.T1.3.3.4.4" class="ltx_td ltx_align_center" colspan="2">LLM</td>
</tr>
<tr id="S6.T1.1.1.1" class="ltx_tr">
<td id="S6.T1.1.1.1.2" class="ltx_td ltx_border_r"></td>
<td id="S6.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">Agreement</td>
<td id="S6.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t">Best-of-<math id="S6.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S6.T1.1.1.1.1.m1.1a"><mi id="S6.T1.1.1.1.1.m1.1.1" xref="S6.T1.1.1.1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S6.T1.1.1.1.1.m1.1b"><ci id="S6.T1.1.1.1.1.m1.1.1.cmml" xref="S6.T1.1.1.1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.1.1.1.1.m1.1c">n</annotation></semantics></math>
</td>
<td id="S6.T1.1.1.1.4" class="ltx_td"></td>
<td id="S6.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t">Rating</td>
<td id="S6.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_t">Win Rate</td>
</tr>
<tr id="S6.T1.3.3.5" class="ltx_tr">
<td id="S6.T1.3.3.5.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">SFT</td>
<td id="S6.T1.3.3.5.2" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S6.T1.3.3.5.3" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S6.T1.3.3.5.4" class="ltx_td ltx_border_t"></td>
<td id="S6.T1.3.3.5.5" class="ltx_td ltx_align_center ltx_border_t">5.028</td>
<td id="S6.T1.3.3.5.6" class="ltx_td ltx_align_center ltx_border_t">29.71%</td>
</tr>
<tr id="S6.T1.3.3.6" class="ltx_tr">
<td id="S6.T1.3.3.6.1" class="ltx_td ltx_align_center ltx_border_r">Centralized</td>
<td id="S6.T1.3.3.6.2" class="ltx_td ltx_align_center"><span id="S6.T1.3.3.6.2.1" class="ltx_text ltx_font_bold">73.10%</span></td>
<td id="S6.T1.3.3.6.3" class="ltx_td ltx_align_center">5.302</td>
<td id="S6.T1.3.3.6.4" class="ltx_td"></td>
<td id="S6.T1.3.3.6.5" class="ltx_td ltx_align_center">5.688</td>
<td id="S6.T1.3.3.6.6" class="ltx_td ltx_align_center">78.89%</td>
</tr>
<tr id="S6.T1.2.2.2" class="ltx_tr">
<td id="S6.T1.2.2.2.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S6.T1.2.2.2.1.1" class="ltx_text ltx_markedasmath">FedBis</span></td>
<td id="S6.T1.2.2.2.2" class="ltx_td ltx_align_center">70.44%</td>
<td id="S6.T1.2.2.2.3" class="ltx_td ltx_align_center">5.274</td>
<td id="S6.T1.2.2.2.4" class="ltx_td"></td>
<td id="S6.T1.2.2.2.5" class="ltx_td ltx_align_center">5.661</td>
<td id="S6.T1.2.2.2.6" class="ltx_td ltx_align_center">71.35%</td>
</tr>
<tr id="S6.T1.3.3.3" class="ltx_tr">
<td id="S6.T1.3.3.3.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S6.T1.3.3.3.1.1" class="ltx_text ltx_markedasmath">FedBiscuit</span></td>
<td id="S6.T1.3.3.3.2" class="ltx_td ltx_align_center">70.52%</td>
<td id="S6.T1.3.3.3.3" class="ltx_td ltx_align_center"><span id="S6.T1.3.3.3.3.1" class="ltx_text ltx_font_bold">5.305</span></td>
<td id="S6.T1.3.3.3.4" class="ltx_td"></td>
<td id="S6.T1.3.3.3.5" class="ltx_td ltx_align_center"><span id="S6.T1.3.3.3.5.1" class="ltx_text ltx_font_bold">5.703</span></td>
<td id="S6.T1.3.3.3.6" class="ltx_td ltx_align_center"><span id="S6.T1.3.3.3.6.1" class="ltx_text ltx_font_bold">80.65%</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Performce under summarization task. All values here indicate their best performance within 500 communication rounds of training.</figcaption>
</figure>
<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p">In this section, the evaluation data originates from the TL;DR dataset, as mentioned in Section <a href="#S5" title="5 Federated Human Preference Benchmark ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The dataset comprises two disjoint parts: one ranked by a group of labelers for model-generated responses, and the other written by users to summarize the key content of a post. We use the former to compute the consistency between the selector and the human annotator. For the latter, we apply various metrics, including best-of-<math id="S6.SS2.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S6.SS2.p1.1.m1.1a"><mi id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.1b"><ci id="S6.SS2.p1.1.m1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.1c">n</annotation></semantics></math>, rating, and win rate. The results are presented in Table <a href="#S6.T1" title="Table 1 ‣ 6.2 Numerical Results on Summarization ‣ 6 Experiments ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and Figure <a href="#S6.F3" title="Figure 3 ‣ 6.2 Numerical Results on Summarization ‣ 6 Experiments ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para">
<p id="S6.SS2.p2.3" class="ltx_p">The table shows that conventional centralized training outperforms the proposed <span id="S6.SS2.p2.3.1" class="ltx_text ltx_markedasmath">FedBiscuit</span> in terms of agreement. This is because the agreement evaluation data have a similar distribution to the training dataset, as their outputs are generated from the same language models and labeled by the same group of labelers <cite class="ltx_cite ltx_citemacro_cite">Stiennon et al. (<a href="#bib.bib37" title="" class="ltx_ref">2020</a>)</cite>. Consequently, centralized training performs better than the proposed <span id="S6.SS2.p2.3.2" class="ltx_text ltx_markedasmath">FedBis</span> and <span id="S6.SS2.p2.3.3" class="ltx_text ltx_markedasmath">FedBiscuit</span>, which are affected by data heterogeneity.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para">
<p id="S6.SS2.p3.4" class="ltx_p">However, when evaluating the selectors with datasets generated by a supervised fine-tuning model, the proposed <span id="S6.SS2.p3.4.1" class="ltx_text ltx_markedasmath">FedBiscuit</span> slightly outperforms centralized training. These results suggest that a centrally trained selector performs poorly in terms of generalization and is prone to overfitting to a specific dataset distribution. In contrast, comparing <span id="S6.SS2.p3.4.2" class="ltx_text ltx_markedasmath">FedBiscuit</span> with <span id="S6.SS2.p3.4.3" class="ltx_text ltx_markedasmath">FedBis</span>, we find that <span id="S6.SS2.p3.4.4" class="ltx_text ltx_markedasmath">FedBiscuit</span> mitigates data heterogeneity and produces a more robust selection of completion pairs.</p>
</div>
<figure id="S6.F3" class="ltx_figure"><img src="/html/2407.03038/assets/x3.png" id="S6.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="392" height="171" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Auto-J rating of best-of-<math id="S6.F3.2.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S6.F3.2.m1.1b"><mi id="S6.F3.2.m1.1.1" xref="S6.F3.2.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S6.F3.2.m1.1c"><ci id="S6.F3.2.m1.1.1.cmml" xref="S6.F3.2.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.2.m1.1d">n</annotation></semantics></math> against communication rounds under summarization tasks.</figcaption>
</figure>
<div id="S6.SS2.p4" class="ltx_para">
<p id="S6.SS2.p4.3" class="ltx_p">Figure <a href="#S6.F3" title="Figure 3 ‣ 6.2 Numerical Results on Summarization ‣ 6 Experiments ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the performance trend across communication rounds. As discussed in Section <a href="#S3.SS3" title="3.3 Discussion ‣ 3 FedBis: A Feasible Framework for Achieving RLHF in FL ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>, training a binary selector can lead to reward hacking. For both centralized training and <span id="S6.SS2.p4.3.1" class="ltx_text ltx_markedasmath">FedBis</span>, which train a single selector, we observe an inflection point where the selector’s performance begins to decline. However, this inflection point has not yet appeared in <span id="S6.SS2.p4.3.2" class="ltx_text ltx_markedasmath">FedBiscuit</span>, allowing it to continuously improve and eventually surpass the best performance of centralized training. It is important to note that the warmup rounds are included in the communication rounds, which explains <span id="S6.SS2.p4.3.3" class="ltx_text ltx_markedasmath">FedBiscuit</span>’s initial poor performance.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.5" class="ltx_p">In this work, we explore a feasible framework to achieve RLHF in FL. Specifically, we train a binary selector across different clients using their local preference datasets, and then use the well-trained selector to align an LLM with human preferences. We propose two approaches to enable selector training: <span id="S7.p1.5.1" class="ltx_text ltx_markedasmath">FedBis</span> and <span id="S7.p1.5.2" class="ltx_text ltx_markedasmath">FedBiscuit</span>. <span id="S7.p1.5.3" class="ltx_text ltx_markedasmath">FedBis</span> provides a framework to train a single selector, while <span id="S7.p1.5.4" class="ltx_text ltx_markedasmath">FedBiscuit</span> ensembles multiple selectors to more robustly simulate human preferences. With the proposed federated human preference datasets, we conduct empirical studies to validate our statements and demonstrate the superiority of <span id="S7.p1.5.5" class="ltx_text ltx_markedasmath">FedBiscuit</span>.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Ethics Statement</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This paper investigates clients’ preferences using a publicly available dataset, ensuring that all data sources are appropriately cited to maintain academic integrity and transparency. By leveraging this public dataset, we avoid using private or sensitive client data, thus upholding ethical standards in data usage and research practices. Furthermore, this work prioritizes the protection of clients’ privacy and strictly avoids any disclosure of local data. When clients utilize their own data to fine-tune the model, robust privacy measures are in place to ensure that no other clients can access or infer any information related to their data. This approach not only safeguards individual privacy but also fosters trust and security in the application of the model.</p>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Limitations</h2>

<div id="Sx2.p1" class="ltx_para">
<p id="Sx2.p1.1" class="ltx_p">One notable limitation of our work lies in the construction of the preference dataset, which relies solely on publicly available data rather than gathering information directly from real clients. By doing so, we miss out on the nuances and intricacies of individual preferences that can only be captured through firsthand data collection. As a result, our dataset may lack the depth and breadth necessary to fully comprehend the true heterogeneity of preferences among clients. Without access to authentic client data, we may inadvertently overlook important variations in preferences, potentially limiting the applicability and robustness of our findings.</p>
</div>
<div id="Sx2.p2" class="ltx_para">
<p id="Sx2.p2.1" class="ltx_p">Another limitation pertains to the use of a task-specific dataset rather than a more generalized one encompassing a broader spectrum of tasks. While task-specific datasets offer advantages such as focused analysis and tailored insights, they may also restrict the scope of our research and hinder its generalizability. By incorporating a more diverse range of tasks into our dataset, we could gain a more comprehensive understanding of clients’ preferences across various domains, thereby enhancing the versatility and validity of our findings.</p>
</div>
<div id="Sx2.p3" class="ltx_para">
<p id="Sx2.p3.1" class="ltx_p">Additionally, our work employs a binary selector that implicitly assumes one response is superior to another, overlooking scenarios where responses may exhibit similar levels of quality. This oversimplified approach fails to leverage valuable data that could provide valuable insights into subtle differences and nuances in preferences. By adopting a more nuanced and inclusive framework that acknowledges and incorporates variations in response quality, we could extract richer insights and make more informed decisions regarding client preferences. Addressing these limitations could bolster the robustness and validity of our research, ultimately enhancing its relevance and impact in real-world applications.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam et al. (2023)</span>
<span class="ltx_bibblock">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et al. 2023.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.08774</em>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Askell et al. (2021)</span>
<span class="ltx_bibblock">
Amanda Askell, Yuntao Bai, Anna Chen, Dawn Drain, Deep Ganguli, Tom Henighan, Andy Jones, Nicholas Joseph, Ben Mann, Nova DasSarma, et al. 2021.

</span>
<span class="ltx_bibblock">A general language assistant as a laboratory for alignment.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2112.00861</em>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Azar et al. (2024)</span>
<span class="ltx_bibblock">
Mohammad Gheshlaghi Azar, Zhaohan Daniel Guo, Bilal Piot, Remi Munos, Mark Rowland, Michal Valko, and Daniele Calandriello. 2024.

</span>
<span class="ltx_bibblock">A general theoretical paradigm to understand learning from human preferences.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and Statistics</em>, pages 4447–4455. PMLR.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2022)</span>
<span class="ltx_bibblock">
Yuntao Bai, Andy Jones, Kamal Ndousse, Amanda Askell, Anna Chen, Nova DasSarma, Dawn Drain, Stanislav Fort, Deep Ganguli, Tom Henighan, et al. 2022.

</span>
<span class="ltx_bibblock">Training a helpful and harmless assistant with reinforcement learning from human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2204.05862</em>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choshen et al. (2019)</span>
<span class="ltx_bibblock">
Leshem Choshen, Lior Fox, Zohar Aizenbud, and Omri Abend. 2019.

</span>
<span class="ltx_bibblock">On the weaknesses of reinforcement learning for neural machine translation.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1907.01752</em>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Christiano et al. (2017)</span>
<span class="ltx_bibblock">
Paul F Christiano, Jan Leike, Tom Brown, Miljan Martic, Shane Legg, and Dario Amodei. 2017.

</span>
<span class="ltx_bibblock">Deep reinforcement learning from human preferences.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Coste et al. (2024)</span>
<span class="ltx_bibblock">
Thomas Coste, Usman Anwar, Robert Kirk, and David Krueger. 2024.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://openreview.net/forum?id=dcjtMYkpXx" title="" class="ltx_ref ltx_href">Reward model ensembles help mitigate overoptimization</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">The Twelfth International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al. (2023)</span>
<span class="ltx_bibblock">
Josef Dai, Xuehai Pan, Ruiyang Sun, Jiaming Ji, Xinbo Xu, Mickel Liu, Yizhou Wang, and Yaodong Yang. 2023.

</span>
<span class="ltx_bibblock">Safe rlhf: Safe reinforcement learning from human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.12773</em>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et al. (2023)</span>
<span class="ltx_bibblock">
Hanze Dong, Wei Xiong, Deepanshu Goyal, Yihan Zhang, Winnie Chow, Rui Pan, Shizhe Diao, Jipeng Zhang, Kashun Shum, and Tong Zhang. 2023.

</span>
<span class="ltx_bibblock">Raft: Reward ranked finetuning for generative foundation model alignment.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.06767</em>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubois et al. (2024)</span>
<span class="ltx_bibblock">
Yann Dubois, Chen Xuechen Li, Rohan Taori, Tianyi Zhang, Ishaan Gulrajani, Jimmy Ba, Carlos Guestrin, Percy S Liang, and Tatsunori B Hashimoto. 2024.

</span>
<span class="ltx_bibblock">Alpacafarm: A simulation framework for methods that learn from human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Eisenstein et al. (2023)</span>
<span class="ltx_bibblock">
Jacob Eisenstein, Chirag Nagpal, Alekh Agarwal, Ahmad Beirami, Alex D’Amour, DJ Dvijotham, Adam Fisch, Katherine Heller, Stephen Pfohl, Deepak Ramachandran, et al. 2023.

</span>
<span class="ltx_bibblock">Helping or herding? reward model ensembles mitigate but do not eliminate reward hacking.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2312.09244</em>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Engstrom et al. (2020)</span>
<span class="ltx_bibblock">
Logan Engstrom, Andrew Ilyas, Shibani Santurkar, Dimitris Tsipras, Firdaus Janoos, Larry Rudolph, and Aleksander Madry. 2020.

</span>
<span class="ltx_bibblock">Implementation matters in deep policy gradients: A case study on ppo and trpo.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2005.12729</em>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ethayarajh et al. (2022)</span>
<span class="ltx_bibblock">
Kawin Ethayarajh, Yejin Choi, and Swabha Swayamdipta. 2022.

</span>
<span class="ltx_bibblock">Understanding dataset difficulty with <math id="bib.bib13.1.m1.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="bib.bib13.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="bib.bib13.1.m1.1.1" xref="bib.bib13.1.m1.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="bib.bib13.1.m1.1b"><ci id="bib.bib13.1.m1.1.1.cmml" xref="bib.bib13.1.m1.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib13.1.m1.1c">\mathcal{V}</annotation></semantics></math>-usable information.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.2.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pages 5988–6008. PMLR.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ethayarajh et al. (2024)</span>
<span class="ltx_bibblock">
Kawin Ethayarajh, Winnie Xu, Niklas Muennighoff, Dan Jurafsky, and Douwe Kiela. 2024.

</span>
<span class="ltx_bibblock">Kto: Model alignment as prospect theoretic optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.01306</em>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ganguli et al. (2022)</span>
<span class="ltx_bibblock">
Deep Ganguli, Liane Lovitt, Jackson Kernion, Amanda Askell, Yuntao Bai, Saurav Kadavath, Ben Mann, Ethan Perez, Nicholas Schiefer, Kamal Ndousse, et al. 2022.

</span>
<span class="ltx_bibblock">Red teaming language models to reduce harms: Methods, scaling behaviors, and lessons learned.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2209.07858</em>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghosh et al. (2020)</span>
<span class="ltx_bibblock">
Avishek Ghosh, Jichan Chung, Dong Yin, and Kannan Ramchandran. 2020.

</span>
<span class="ltx_bibblock">An efficient framework for clustered federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:19586–19597.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2021)</span>
<span class="ltx_bibblock">
Xinran Gu, Kaixuan Huang, Jingzhao Zhang, and Longbo Huang. 2021.

</span>
<span class="ltx_bibblock">Fast federated learning in the presence of arbitrary device unavailability.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 34:12052–12064.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gulcehre et al. (2023)</span>
<span class="ltx_bibblock">
Caglar Gulcehre, Tom Le Paine, Srivatsan Srinivasan, Ksenia Konyushkova, Lotte Weerts, Abhishek Sharma, Aditya Siddhant, Alex Ahern, Miaosen Wang, Chenjie Gu, et al. 2023.

</span>
<span class="ltx_bibblock">Reinforced self-training (rest) for language modeling.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2308.08998</em>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2021)</span>
<span class="ltx_bibblock">
Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen. 2021.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.09685</em>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian Stich, and Ananda Theertha Suresh. 2020.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pages 5132–5143. PMLR.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečnỳ et al. (2016)</span>
<span class="ltx_bibblock">
Jakub Konečnỳ, H Brendan McMahan, Felix X Yu, Peter Richtárik, Ananda Theertha Suresh, and Dave Bacon. 2016.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication efficiency.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1610.05492</em>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Köpf et al. (2024)</span>
<span class="ltx_bibblock">
Andreas Köpf, Yannic Kilcher, Dimitri von Rütte, Sotiris Anagnostidis, Zhi Rui Tam, Keith Stevens, Abdullah Barhoum, Duc Nguyen, Oliver Stanley, Richárd Nagyfi, et al. 2024.

</span>
<span class="ltx_bibblock">Openassistant conversations-democratizing large language model alignment.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kuang et al. (2023)</span>
<span class="ltx_bibblock">
Weirui Kuang, Bingchen Qian, Zitao Li, Daoyuan Chen, Dawei Gao, Xuchen Pan, Yuexiang Xie, Yaliang Li, Bolin Ding, and Jingren Zhou. 2023.

</span>
<span class="ltx_bibblock">Federatedscope-llm: A comprehensive package for fine-tuning large language models in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.00363</em>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023a)</span>
<span class="ltx_bibblock">
Junlong Li, Shichao Sun, Weizhe Yuan, Run-Ze Fan, Hai Zhao, and Pengfei Liu. 2023a.

</span>
<span class="ltx_bibblock">Generative judge for evaluating alignment.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.05470</em>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019)</span>
<span class="ltx_bibblock">
Xiang Li, Kaixuan Huang, Wenhao Yang, Shusen Wang, and Zhihua Zhang. 2019.

</span>
<span class="ltx_bibblock">On the convergence of fedavg on non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1907.02189</em>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023b)</span>
<span class="ltx_bibblock">
Xuechen Li, Tianyi Zhang, Yann Dubois, Rohan Taori, Ishaan Gulrajani, Carlos Guestrin, Percy Liang, and Tatsunori B. Hashimoto. 2023b.

</span>
<span class="ltx_bibblock">Alpacaeval: An automatic evaluator of instruction-following models.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/tatsu-lab/alpaca_eval" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/tatsu-lab/alpaca_eval</a>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2023)</span>
<span class="ltx_bibblock">
Zihao Lin, Yan Sun, Yifan Shi, Xueqian Wang, Lifu Huang, Li Shen, and Dacheng Tao. 2023.

</span>
<span class="ltx_bibblock">Efficient federated prompt tuning for black-box large pre-trained models.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.03123</em>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2017)</span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter. 2017.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1711.05101</em>.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2023)</span>
<span class="ltx_bibblock">
Jie Ma, Tianyi Zhou, Guodong Long, Jing Jiang, and Chengqi Zhang. 2023.

</span>
<span class="ltx_bibblock">Structured federated learning through clustered additive modeling.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y Arcas. 2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pages 1273–1282. PMLR.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Michaud et al. (2020)</span>
<span class="ltx_bibblock">
Eric J Michaud, Adam Gleave, and Stuart Russell. 2020.

</span>
<span class="ltx_bibblock">Understanding learned reward functions.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2012.05862</em>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al. (2022)</span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et al. 2022.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 35:27730–27744.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov et al. (2023)</span>
<span class="ltx_bibblock">
Rafael Rafailov, Archit Sharma, Eric Mitchell, Christopher D Manning, Stefano Ermon, and Chelsea Finn. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2023/file/a85b405ed65c6477a4fe8302b5e06ce7-Paper-Conference.pdf" title="" class="ltx_ref ltx_href">Direct preference optimization: Your language model is secretly a reward model</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, volume 36, pages 53728–53741. Curran Associates, Inc.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al. (2020)</span>
<span class="ltx_bibblock">
Felix Sattler, Klaus-Robert Müller, and Wojciech Samek. 2020.

</span>
<span class="ltx_bibblock">Clustered federated learning: Model-agnostic distributed multitask optimization under privacy constraints.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning systems</em>, 32(8):3710–3722.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et al. (2017)</span>
<span class="ltx_bibblock">
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov. 2017.

</span>
<span class="ltx_bibblock">Proximal policy optimization algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1707.06347</em>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Skalse et al. (2022)</span>
<span class="ltx_bibblock">
Joar Skalse, Nikolaus Howe, Dmitrii Krasheninnikov, and David Krueger. 2022.

</span>
<span class="ltx_bibblock">Defining and characterizing reward gaming.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35:9460–9471.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stiennon et al. (2020)</span>
<span class="ltx_bibblock">
Nisan Stiennon, Long Ouyang, Jeff Wu, Daniel M. Ziegler, Ryan Lowe, Chelsea Voss, Alec Radford, Dario Amodei, and Paul Christiano. 2020.

</span>
<span class="ltx_bibblock">Learning to summarize from human feedback.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2023)</span>
<span class="ltx_bibblock">
Jingwei Sun, Ziyue Xu, Hongxu Yin, Dong Yang, Daguang Xu, Yiran Chen, and Holger R Roth. 2023.

</span>
<span class="ltx_bibblock">Fedbpt: Efficient federated black-box prompt tuning for large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.01467</em>.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2024)</span>
<span class="ltx_bibblock">
Youbang Sun, Zitao Li, Yaliang Li, and Bolin Ding. 2024.

</span>
<span class="ltx_bibblock">Improving lora in privacy-preserving federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2403.12313</em>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taori et al. (2023)</span>
<span class="ltx_bibblock">
Rohan Taori, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos Guestrin, Percy Liang, and Tatsunori B. Hashimoto. 2023.

</span>
<span class="ltx_bibblock">Stanford alpaca: An instruction-following llama model.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/tatsu-lab/stanford_alpaca" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/tatsu-lab/stanford_alpaca</a>.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tien et al. (2022)</span>
<span class="ltx_bibblock">
Jeremy Tien, Jerry Zhi-Yang He, Zackory Erickson, Anca D Dragan, and Daniel S Brown. 2022.

</span>
<span class="ltx_bibblock">Causal confusion and reward misidentification in preference-based reward learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2204.06601</em>.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al. 2023.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.09288</em>.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Völske et al. (2017)</span>
<span class="ltx_bibblock">
Michael Völske, Martin Potthast, Shahbaz Syed, and Benno Stein. 2017.

</span>
<span class="ltx_bibblock">Tl; dr: Mining reddit to learn automatic summarization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Workshop on New Frontiers in Summarization</em>, pages 59–63.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Ji (2023)</span>
<span class="ltx_bibblock">
Shiqiang Wang and Mingyue Ji. 2023.

</span>
<span class="ltx_bibblock">A lightweight method for tackling unknown participation probabilities in federated averaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.03401</em>.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2023)</span>
<span class="ltx_bibblock">
Feijie Wu, Song Guo, Zhihao Qu, Shiqi He, Ziming Liu, and Jing Gao. 2023.

</span>
<span class="ltx_bibblock">Anchor sampling for federated learning with partial client participation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pages 37379–37416. PMLR.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2024)</span>
<span class="ltx_bibblock">
Feijie Wu, Zitao Li, Yaliang Li, Bolin Ding, and Jing Gao. 2024.

</span>
<span class="ltx_bibblock">Fedbiot: Llm local fine-tuning in federated learning without full model.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2406.17706</em>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2023)</span>
<span class="ltx_bibblock">
Yuexiang Xie, Zhen Wang, Dawei Gao, Daoyuan Chen, Liuyi Yao, Weirui Kuang, Yaliang Li, Bolin Ding, and Jingren Zhou. 2023.

</span>
<span class="ltx_bibblock">Federatedscope: A flexible federated learning platform for heterogeneity.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Proceedings of the VLDB Endowment</em>, 16(5):1059–1072.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2020)</span>
<span class="ltx_bibblock">
Haibo Yang, Minghong Fang, and Jia Liu. 2020.

</span>
<span class="ltx_bibblock">Achieving linear speedup with partial worker participation in non-iid federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. (2024)</span>
<span class="ltx_bibblock">
Rui Ye, Wenhao Wang, Jingyi Chai, Dihan Li, Zexi Li, Yinda Xu, Yaxin Du, Yanfeng Wang, and Siheng Chen. 2024.

</span>
<span class="ltx_bibblock">Openfedllm: Training large language models on decentralized private data via federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.06954</em>.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yi et al. (2023)</span>
<span class="ltx_bibblock">
Liping Yi, Han Yu, Gang Wang, and Xiaoguang Liu. 2023.

</span>
<span class="ltx_bibblock">Fedlora: Model-heterogeneous personalized federated learning with lora tuning.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.13283</em>.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023a)</span>
<span class="ltx_bibblock">
Jianyi Zhang, Saeed Vahidian, Martin Kuo, Chunyuan Li, Ruiyi Zhang, Guoyin Wang, and Yiran Chen. 2023a.

</span>
<span class="ltx_bibblock">Towards building the federated gpt: Federated instruction tuning.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.05644</em>.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023b)</span>
<span class="ltx_bibblock">
Zhuo Zhang, Yuanhang Yang, Yong Dai, Qifan Wang, Yue Yu, Lizhen Qu, and Zenglin Xu. 2023b.

</span>
<span class="ltx_bibblock">Fedpetuning: When federated learning meets the parameter-efficient tuning methods of pre-trained language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Annual Meeting of the Association of Computational Linguistics 2023</em>, pages 9963–9977. Association for Computational Linguistics (ACL).

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2023)</span>
<span class="ltx_bibblock">
Yao Zhao, Rishabh Joshi, Tianqi Liu, Misha Khalman, Mohammad Saleh, and Peter J Liu. 2023.

</span>
<span class="ltx_bibblock">Slic-hf: Sequence likelihood calibration with human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.10425</em>.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ziegler et al. (2019)</span>
<span class="ltx_bibblock">
Daniel M Ziegler, Nisan Stiennon, Jeffrey Wu, Tom B Brown, Alec Radford, Dario Amodei, Paul Christiano, and Geoffrey Irving. 2019.

</span>
<span class="ltx_bibblock">Fine-tuning language models from human preferences.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.08593</em>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>More Implementation Details</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">In this section, we include various settings, such as the prompt and the hyperparameters.</p>
</div>
<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Hyperparameter Settings</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.1" class="ltx_p">In our work, we fine-tune all models using LoRA, which is consistently set to rank 8, <math id="A1.SS1.p1.1.m1.1" class="ltx_Math" alttext="\alpha=16" display="inline"><semantics id="A1.SS1.p1.1.m1.1a"><mrow id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml"><mi id="A1.SS1.p1.1.m1.1.1.2" xref="A1.SS1.p1.1.m1.1.1.2.cmml">α</mi><mo id="A1.SS1.p1.1.m1.1.1.1" xref="A1.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS1.p1.1.m1.1.1.3" xref="A1.SS1.p1.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><apply id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1"><eq id="A1.SS1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1.1"></eq><ci id="A1.SS1.p1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.1.m1.1.1.2">𝛼</ci><cn type="integer" id="A1.SS1.p1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">\alpha=16</annotation></semantics></math>, and the dropout rate 0.0. For the generation, we apply with these parameters:</p>
<ul id="A1.I1" class="ltx_itemize">
<li id="A1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i1.p1" class="ltx_para">
<p id="A1.I1.i1.p1.1" class="ltx_p">If it is required to generate multiple completions, then we set the temperature to 1.0.</p>
</div>
</li>
<li id="A1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i2.p1" class="ltx_para">
<p id="A1.I1.i2.p1.1" class="ltx_p">If it is required to generate a single completion, then we adopt greedy search by setting the temperature to 0.0.</p>
</div>
</li>
</ul>
</div>
<div id="A1.SS1.p2" class="ltx_para">
<p id="A1.SS1.p2.1" class="ltx_p">In the following part, we show the hyperparameter setting for different tasks:</p>
</div>
<figure id="A1.T2" class="ltx_table">
<div id="A1.T2.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:210.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(68.2pt,-33.1pt) scale(1.45931509289604,1.45931509289604) ;">
<table id="A1.T2.3.3" class="ltx_tabular ltx_align_middle">
<tr id="A1.T2.3.3.4" class="ltx_tr">
<td id="A1.T2.3.3.4.1" class="ltx_td ltx_border_t"></td>
<td id="A1.T2.3.3.4.2" class="ltx_td ltx_align_center ltx_border_t">SFT</td>
<td id="A1.T2.3.3.4.3" class="ltx_td ltx_align_center ltx_border_t">Selector Training</td>
<td id="A1.T2.3.3.4.4" class="ltx_td ltx_align_center ltx_border_t">RLFT</td>
</tr>
<tr id="A1.T2.3.3.5" class="ltx_tr">
<td id="A1.T2.3.3.5.1" class="ltx_td ltx_align_left ltx_border_t">Participation Rate</td>
<td id="A1.T2.3.3.5.2" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="A1.T2.3.3.5.3" class="ltx_td ltx_align_center ltx_border_t">5/53</td>
<td id="A1.T2.3.3.5.4" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="A1.T2.3.3.6" class="ltx_tr">
<td id="A1.T2.3.3.6.1" class="ltx_td ltx_align_left">Local Iterations</td>
<td id="A1.T2.3.3.6.2" class="ltx_td ltx_align_center">30</td>
<td id="A1.T2.3.3.6.3" class="ltx_td ltx_align_center">30</td>
<td id="A1.T2.3.3.6.4" class="ltx_td ltx_align_center">30</td>
</tr>
<tr id="A1.T2.3.3.7" class="ltx_tr">
<td id="A1.T2.3.3.7.1" class="ltx_td ltx_align_left">Batch Size</td>
<td id="A1.T2.3.3.7.2" class="ltx_td ltx_align_center">32</td>
<td id="A1.T2.3.3.7.3" class="ltx_td ltx_align_center">16</td>
<td id="A1.T2.3.3.7.4" class="ltx_td ltx_align_center">32</td>
</tr>
<tr id="A1.T2.3.3.8" class="ltx_tr">
<td id="A1.T2.3.3.8.1" class="ltx_td ltx_align_left">Rounds</td>
<td id="A1.T2.3.3.8.2" class="ltx_td ltx_align_center">1000</td>
<td id="A1.T2.3.3.8.3" class="ltx_td ltx_align_center">500</td>
<td id="A1.T2.3.3.8.4" class="ltx_td ltx_align_center">500</td>
</tr>
<tr id="A1.T2.3.3.9" class="ltx_tr">
<td id="A1.T2.3.3.9.1" class="ltx_td ltx_align_left">Optimizer</td>
<td id="A1.T2.3.3.9.2" class="ltx_td ltx_align_center">AdamW</td>
<td id="A1.T2.3.3.9.3" class="ltx_td ltx_align_center">AdamW</td>
<td id="A1.T2.3.3.9.4" class="ltx_td ltx_align_center">RMSprop</td>
</tr>
<tr id="A1.T2.3.3.10" class="ltx_tr">
<td id="A1.T2.3.3.10.1" class="ltx_td ltx_align_left">Hyperparameters</td>
<td id="A1.T2.3.3.10.2" class="ltx_td ltx_align_center">(0.9, 0.95)</td>
<td id="A1.T2.3.3.10.3" class="ltx_td ltx_align_center">(0.9, 0.95)</td>
<td id="A1.T2.3.3.10.4" class="ltx_td ltx_align_center">–</td>
</tr>
<tr id="A1.T2.3.3.3" class="ltx_tr">
<td id="A1.T2.3.3.3.4" class="ltx_td ltx_align_left ltx_border_b">Learning rate</td>
<td id="A1.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_b"><math id="A1.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="1e-4" display="inline"><semantics id="A1.T2.1.1.1.1.m1.1a"><mrow id="A1.T2.1.1.1.1.m1.1.1" xref="A1.T2.1.1.1.1.m1.1.1.cmml"><mrow id="A1.T2.1.1.1.1.m1.1.1.2" xref="A1.T2.1.1.1.1.m1.1.1.2.cmml"><mn id="A1.T2.1.1.1.1.m1.1.1.2.2" xref="A1.T2.1.1.1.1.m1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.T2.1.1.1.1.m1.1.1.2.1" xref="A1.T2.1.1.1.1.m1.1.1.2.1.cmml">​</mo><mi id="A1.T2.1.1.1.1.m1.1.1.2.3" xref="A1.T2.1.1.1.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.T2.1.1.1.1.m1.1.1.1" xref="A1.T2.1.1.1.1.m1.1.1.1.cmml">−</mo><mn id="A1.T2.1.1.1.1.m1.1.1.3" xref="A1.T2.1.1.1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.1.1.1.1.m1.1b"><apply id="A1.T2.1.1.1.1.m1.1.1.cmml" xref="A1.T2.1.1.1.1.m1.1.1"><minus id="A1.T2.1.1.1.1.m1.1.1.1.cmml" xref="A1.T2.1.1.1.1.m1.1.1.1"></minus><apply id="A1.T2.1.1.1.1.m1.1.1.2.cmml" xref="A1.T2.1.1.1.1.m1.1.1.2"><times id="A1.T2.1.1.1.1.m1.1.1.2.1.cmml" xref="A1.T2.1.1.1.1.m1.1.1.2.1"></times><cn type="integer" id="A1.T2.1.1.1.1.m1.1.1.2.2.cmml" xref="A1.T2.1.1.1.1.m1.1.1.2.2">1</cn><ci id="A1.T2.1.1.1.1.m1.1.1.2.3.cmml" xref="A1.T2.1.1.1.1.m1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.T2.1.1.1.1.m1.1.1.3.cmml" xref="A1.T2.1.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.1.1.1.1.m1.1c">1e-4</annotation></semantics></math></td>
<td id="A1.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_b"><math id="A1.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="1e-5" display="inline"><semantics id="A1.T2.2.2.2.2.m1.1a"><mrow id="A1.T2.2.2.2.2.m1.1.1" xref="A1.T2.2.2.2.2.m1.1.1.cmml"><mrow id="A1.T2.2.2.2.2.m1.1.1.2" xref="A1.T2.2.2.2.2.m1.1.1.2.cmml"><mn id="A1.T2.2.2.2.2.m1.1.1.2.2" xref="A1.T2.2.2.2.2.m1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.T2.2.2.2.2.m1.1.1.2.1" xref="A1.T2.2.2.2.2.m1.1.1.2.1.cmml">​</mo><mi id="A1.T2.2.2.2.2.m1.1.1.2.3" xref="A1.T2.2.2.2.2.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.T2.2.2.2.2.m1.1.1.1" xref="A1.T2.2.2.2.2.m1.1.1.1.cmml">−</mo><mn id="A1.T2.2.2.2.2.m1.1.1.3" xref="A1.T2.2.2.2.2.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.2.2.2.2.m1.1b"><apply id="A1.T2.2.2.2.2.m1.1.1.cmml" xref="A1.T2.2.2.2.2.m1.1.1"><minus id="A1.T2.2.2.2.2.m1.1.1.1.cmml" xref="A1.T2.2.2.2.2.m1.1.1.1"></minus><apply id="A1.T2.2.2.2.2.m1.1.1.2.cmml" xref="A1.T2.2.2.2.2.m1.1.1.2"><times id="A1.T2.2.2.2.2.m1.1.1.2.1.cmml" xref="A1.T2.2.2.2.2.m1.1.1.2.1"></times><cn type="integer" id="A1.T2.2.2.2.2.m1.1.1.2.2.cmml" xref="A1.T2.2.2.2.2.m1.1.1.2.2">1</cn><ci id="A1.T2.2.2.2.2.m1.1.1.2.3.cmml" xref="A1.T2.2.2.2.2.m1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.T2.2.2.2.2.m1.1.1.3.cmml" xref="A1.T2.2.2.2.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.2.2.2.2.m1.1c">1e-5</annotation></semantics></math></td>
<td id="A1.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_b"><math id="A1.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="1e-6" display="inline"><semantics id="A1.T2.3.3.3.3.m1.1a"><mrow id="A1.T2.3.3.3.3.m1.1.1" xref="A1.T2.3.3.3.3.m1.1.1.cmml"><mrow id="A1.T2.3.3.3.3.m1.1.1.2" xref="A1.T2.3.3.3.3.m1.1.1.2.cmml"><mn id="A1.T2.3.3.3.3.m1.1.1.2.2" xref="A1.T2.3.3.3.3.m1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.T2.3.3.3.3.m1.1.1.2.1" xref="A1.T2.3.3.3.3.m1.1.1.2.1.cmml">​</mo><mi id="A1.T2.3.3.3.3.m1.1.1.2.3" xref="A1.T2.3.3.3.3.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.T2.3.3.3.3.m1.1.1.1" xref="A1.T2.3.3.3.3.m1.1.1.1.cmml">−</mo><mn id="A1.T2.3.3.3.3.m1.1.1.3" xref="A1.T2.3.3.3.3.m1.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.3.3.3.3.m1.1b"><apply id="A1.T2.3.3.3.3.m1.1.1.cmml" xref="A1.T2.3.3.3.3.m1.1.1"><minus id="A1.T2.3.3.3.3.m1.1.1.1.cmml" xref="A1.T2.3.3.3.3.m1.1.1.1"></minus><apply id="A1.T2.3.3.3.3.m1.1.1.2.cmml" xref="A1.T2.3.3.3.3.m1.1.1.2"><times id="A1.T2.3.3.3.3.m1.1.1.2.1.cmml" xref="A1.T2.3.3.3.3.m1.1.1.2.1"></times><cn type="integer" id="A1.T2.3.3.3.3.m1.1.1.2.2.cmml" xref="A1.T2.3.3.3.3.m1.1.1.2.2">1</cn><ci id="A1.T2.3.3.3.3.m1.1.1.2.3.cmml" xref="A1.T2.3.3.3.3.m1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.T2.3.3.3.3.m1.1.1.3.cmml" xref="A1.T2.3.3.3.3.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.3.3.3.3.m1.1c">1e-6</annotation></semantics></math></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Hyperparameter Settings for the Summarization Task</figcaption>
</figure>
<figure id="A1.T3" class="ltx_table">
<div id="A1.T3.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:259.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(96.5pt,-57.7pt) scale(1.80153435589916,1.80153435589916) ;">
<table id="A1.T3.2.2" class="ltx_tabular ltx_align_middle">
<tr id="A1.T3.2.2.3" class="ltx_tr">
<td id="A1.T3.2.2.3.1" class="ltx_td ltx_border_t"></td>
<td id="A1.T3.2.2.3.2" class="ltx_td ltx_align_center ltx_border_t">Selector Training</td>
<td id="A1.T3.2.2.3.3" class="ltx_td ltx_align_center ltx_border_t">RLFT</td>
</tr>
<tr id="A1.T3.2.2.4" class="ltx_tr">
<td id="A1.T3.2.2.4.1" class="ltx_td ltx_align_left ltx_border_t">Participation Rate</td>
<td id="A1.T3.2.2.4.2" class="ltx_td ltx_align_center ltx_border_t">10/300</td>
<td id="A1.T3.2.2.4.3" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="A1.T3.2.2.5" class="ltx_tr">
<td id="A1.T3.2.2.5.1" class="ltx_td ltx_align_left">Local Iterations</td>
<td id="A1.T3.2.2.5.2" class="ltx_td ltx_align_center">10</td>
<td id="A1.T3.2.2.5.3" class="ltx_td ltx_align_center">10</td>
</tr>
<tr id="A1.T3.2.2.6" class="ltx_tr">
<td id="A1.T3.2.2.6.1" class="ltx_td ltx_align_left">Batch Size</td>
<td id="A1.T3.2.2.6.2" class="ltx_td ltx_align_center">16</td>
<td id="A1.T3.2.2.6.3" class="ltx_td ltx_align_center">16</td>
</tr>
<tr id="A1.T3.2.2.7" class="ltx_tr">
<td id="A1.T3.2.2.7.1" class="ltx_td ltx_align_left">Rounds</td>
<td id="A1.T3.2.2.7.2" class="ltx_td ltx_align_center">200</td>
<td id="A1.T3.2.2.7.3" class="ltx_td ltx_align_center">200</td>
</tr>
<tr id="A1.T3.2.2.8" class="ltx_tr">
<td id="A1.T3.2.2.8.1" class="ltx_td ltx_align_left">Optimizer</td>
<td id="A1.T3.2.2.8.2" class="ltx_td ltx_align_center">AdamW</td>
<td id="A1.T3.2.2.8.3" class="ltx_td ltx_align_center">RMSprop</td>
</tr>
<tr id="A1.T3.2.2.9" class="ltx_tr">
<td id="A1.T3.2.2.9.1" class="ltx_td ltx_align_left">Hyperparameters</td>
<td id="A1.T3.2.2.9.2" class="ltx_td ltx_align_center">(0.9, 0.95)</td>
<td id="A1.T3.2.2.9.3" class="ltx_td ltx_align_center">–</td>
</tr>
<tr id="A1.T3.2.2.2" class="ltx_tr">
<td id="A1.T3.2.2.2.3" class="ltx_td ltx_align_left ltx_border_b">Learning rate</td>
<td id="A1.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_b"><math id="A1.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="1e-5" display="inline"><semantics id="A1.T3.1.1.1.1.m1.1a"><mrow id="A1.T3.1.1.1.1.m1.1.1" xref="A1.T3.1.1.1.1.m1.1.1.cmml"><mrow id="A1.T3.1.1.1.1.m1.1.1.2" xref="A1.T3.1.1.1.1.m1.1.1.2.cmml"><mn id="A1.T3.1.1.1.1.m1.1.1.2.2" xref="A1.T3.1.1.1.1.m1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.T3.1.1.1.1.m1.1.1.2.1" xref="A1.T3.1.1.1.1.m1.1.1.2.1.cmml">​</mo><mi id="A1.T3.1.1.1.1.m1.1.1.2.3" xref="A1.T3.1.1.1.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.T3.1.1.1.1.m1.1.1.1" xref="A1.T3.1.1.1.1.m1.1.1.1.cmml">−</mo><mn id="A1.T3.1.1.1.1.m1.1.1.3" xref="A1.T3.1.1.1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.1.1.1.1.m1.1b"><apply id="A1.T3.1.1.1.1.m1.1.1.cmml" xref="A1.T3.1.1.1.1.m1.1.1"><minus id="A1.T3.1.1.1.1.m1.1.1.1.cmml" xref="A1.T3.1.1.1.1.m1.1.1.1"></minus><apply id="A1.T3.1.1.1.1.m1.1.1.2.cmml" xref="A1.T3.1.1.1.1.m1.1.1.2"><times id="A1.T3.1.1.1.1.m1.1.1.2.1.cmml" xref="A1.T3.1.1.1.1.m1.1.1.2.1"></times><cn type="integer" id="A1.T3.1.1.1.1.m1.1.1.2.2.cmml" xref="A1.T3.1.1.1.1.m1.1.1.2.2">1</cn><ci id="A1.T3.1.1.1.1.m1.1.1.2.3.cmml" xref="A1.T3.1.1.1.1.m1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.T3.1.1.1.1.m1.1.1.3.cmml" xref="A1.T3.1.1.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.1.1.1.1.m1.1c">1e-5</annotation></semantics></math></td>
<td id="A1.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_b"><math id="A1.T3.2.2.2.2.m1.1" class="ltx_Math" alttext="1e-6" display="inline"><semantics id="A1.T3.2.2.2.2.m1.1a"><mrow id="A1.T3.2.2.2.2.m1.1.1" xref="A1.T3.2.2.2.2.m1.1.1.cmml"><mrow id="A1.T3.2.2.2.2.m1.1.1.2" xref="A1.T3.2.2.2.2.m1.1.1.2.cmml"><mn id="A1.T3.2.2.2.2.m1.1.1.2.2" xref="A1.T3.2.2.2.2.m1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.T3.2.2.2.2.m1.1.1.2.1" xref="A1.T3.2.2.2.2.m1.1.1.2.1.cmml">​</mo><mi id="A1.T3.2.2.2.2.m1.1.1.2.3" xref="A1.T3.2.2.2.2.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.T3.2.2.2.2.m1.1.1.1" xref="A1.T3.2.2.2.2.m1.1.1.1.cmml">−</mo><mn id="A1.T3.2.2.2.2.m1.1.1.3" xref="A1.T3.2.2.2.2.m1.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.2.2.2.2.m1.1b"><apply id="A1.T3.2.2.2.2.m1.1.1.cmml" xref="A1.T3.2.2.2.2.m1.1.1"><minus id="A1.T3.2.2.2.2.m1.1.1.1.cmml" xref="A1.T3.2.2.2.2.m1.1.1.1"></minus><apply id="A1.T3.2.2.2.2.m1.1.1.2.cmml" xref="A1.T3.2.2.2.2.m1.1.1.2"><times id="A1.T3.2.2.2.2.m1.1.1.2.1.cmml" xref="A1.T3.2.2.2.2.m1.1.1.2.1"></times><cn type="integer" id="A1.T3.2.2.2.2.m1.1.1.2.2.cmml" xref="A1.T3.2.2.2.2.m1.1.1.2.2">1</cn><ci id="A1.T3.2.2.2.2.m1.1.1.2.3.cmml" xref="A1.T3.2.2.2.2.m1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.T3.2.2.2.2.m1.1.1.3.cmml" xref="A1.T3.2.2.2.2.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.2.2.2.m1.1c">1e-6</annotation></semantics></math></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Hyperparameter Settings for the QA Task</figcaption>
</figure>
<section id="A1.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Special Setting for <span id="A1.SS1.SSS0.Px1.2.1" class="ltx_text ltx_markedasmath">FedBiscuit</span> </h5>

<div id="A1.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="A1.SS1.SSS0.Px1.p1.1" class="ltx_p">For the above two tasks, we ensemble three binary selectors (i.e., LoRAs). In the warmup round, we train the selector for 50 rounds under an FL framework. <span id="A1.SS1.SSS0.Px1.p1.1.1" class="ltx_text ltx_markedasmath">FedBiscuit</span> performs regrouping every 50 rounds in the summarization task, while regrouping every 100 rounds in the QA task.</p>
</div>
</section>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Instruction Tuning Prompt</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p">In this section, we highlight the prompts used to fine-tune the summarization tasks and the QA task:</p>
</div>
<section id="A1.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Summarization.</h5>

<div id="A1.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="A1.SS2.SSS0.Px1.p1.1" class="ltx_p">For pertaining (SFT) and the later reinforcement-learning fine-tuning (RLFT), it follows the prompt below</p>
</div>
<figure id="A1.SS2.SSS0.Px1.tab1" class="ltx_table">
<table id="A1.SS2.SSS0.Px1.tab1.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.SS2.SSS0.Px1.tab1.1.1" class="ltx_tr">
<td id="A1.SS2.SSS0.Px1.tab1.1.1.1" class="ltx_td ltx_align_justify ltx_border_b ltx_border_t">
<span id="A1.SS2.SSS0.Px1.tab1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS2.SSS0.Px1.tab1.1.1.1.1.1" class="ltx_p">Below is a forum post. Write a precise and concise summary that includes the most important points of the post.
<br class="ltx_break">
<br class="ltx_break">### SUBREDDIT: r/{subreddit}
<br class="ltx_break">### TITLE: {title}
<br class="ltx_break">### POST: {post}
<br class="ltx_break">### TL;DR:</span>
</span>
</td>
</tr>
</table>
</figure>
<div id="A1.SS2.SSS0.Px1.p2" class="ltx_para">
<p id="A1.SS2.SSS0.Px1.p2.1" class="ltx_p">For comparison:</p>
</div>
<figure id="A1.SS2.SSS0.Px1.tab2" class="ltx_table">
<table id="A1.SS2.SSS0.Px1.tab2.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.SS2.SSS0.Px1.tab2.1.1" class="ltx_tr">
<td id="A1.SS2.SSS0.Px1.tab2.1.1.1" class="ltx_td ltx_align_justify ltx_border_b ltx_border_t">
<span id="A1.SS2.SSS0.Px1.tab2.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS2.SSS0.Px1.tab2.1.1.1.1.1" class="ltx_p">Below is a forum post followed by two summaries. Pick a more precise and concise one that summarizes the most important points in the given forum post, without including unimportant or irrelevant details. State your choice with a single capital letter, i.e., Äïf SUMMARY A is better, B̈ïf SUMMARY B is better.
<br class="ltx_break">
<br class="ltx_break">### SUBREDDIT: r/{subreddit}
<br class="ltx_break">### TITLE: {title}
<br class="ltx_break">### POST: {post}
<br class="ltx_break">### SUMMARY A: {output_A}
<br class="ltx_break">### SUMMARY B: {output_B}
<br class="ltx_break">### YOUR CHOICE:</span>
</span>
</td>
</tr>
</table>
</figure>
</section>
<section id="A1.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">QA.</h5>

<div id="A1.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="A1.SS2.SSS0.Px2.p1.1" class="ltx_p">As the QA utilizes a pretrained model named Alpaca-7B, we follow its pretrained format</p>
</div>
<figure id="A1.SS2.SSS0.Px2.tab1" class="ltx_table">
<table id="A1.SS2.SSS0.Px2.tab1.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.SS2.SSS0.Px2.tab1.1.1" class="ltx_tr">
<td id="A1.SS2.SSS0.Px2.tab1.1.1.1" class="ltx_td ltx_align_justify ltx_border_b ltx_border_t">
<span id="A1.SS2.SSS0.Px2.tab1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS2.SSS0.Px2.tab1.1.1.1.1.1" class="ltx_p">Below is an instruction that describes a task, paired with an input that provides further context. Write a response that appropriately completes the request.

<br class="ltx_break">
<br class="ltx_break">### Instruction:
<br class="ltx_break">{instruction}

<br class="ltx_break">
<br class="ltx_break">### Input:
<br class="ltx_break">{input}

<br class="ltx_break">
<br class="ltx_break">### Response:</span>
</span>
</td>
</tr>
</table>
</figure>
<div id="A1.SS2.SSS0.Px2.p2" class="ltx_para">
<p id="A1.SS2.SSS0.Px2.p2.1" class="ltx_p">For comparison between the two responses:</p>
</div>
<figure id="A1.SS2.SSS0.Px2.tab2" class="ltx_table">
<table id="A1.SS2.SSS0.Px2.tab2.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.SS2.SSS0.Px2.tab2.1.1" class="ltx_tr">
<td id="A1.SS2.SSS0.Px2.tab2.1.1.1" class="ltx_td ltx_align_justify ltx_border_b ltx_border_t">
<span id="A1.SS2.SSS0.Px2.tab2.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS2.SSS0.Px2.tab2.1.1.1.1.1" class="ltx_p">Below is a query followed by two responses. Pick a helpful response that is precise, concise, and casual. State your choice with a single capital letter, i.e., Äïf RESPONSE A is better, B̈ïf RESPONSE B is better.
<br class="ltx_break">
<br class="ltx_break">### QUERY: {instruction}
<br class="ltx_break">### RESPONSE A: {output_A}
<br class="ltx_break">### RESPONSE B: {output_B}
<br class="ltx_break">### YOUR CHOICE:</span>
</span>
</td>
</tr>
</table>
</figure>
</section>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>More Numerical Results and Analysis</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Numerical Results on QA</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.1" class="ltx_p">In this section, the test dataset comes from AlpacaFarm <cite class="ltx_cite ltx_citemacro_cite">Dubois et al. (<a href="#bib.bib10" title="" class="ltx_ref">2024</a>); Li et al. (<a href="#bib.bib26" title="" class="ltx_ref">2023b</a>)</cite>. The results are as follows:</p>
</div>
<figure id="A2.T4" class="ltx_table">
<div id="A2.T4.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:186.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(111.9pt,-48.0pt) scale(2.06758865333884,2.06758865333884) ;">
<table id="A2.T4.2.2" class="ltx_tabular ltx_align_middle">
<tr id="A2.T4.2.2.3" class="ltx_tr">
<td id="A2.T4.2.2.3.1" class="ltx_td ltx_border_r"></td>
<td id="A2.T4.2.2.3.2" class="ltx_td ltx_align_center">2-completion</td>
<td id="A2.T4.2.2.3.3" class="ltx_td"></td>
<td id="A2.T4.2.2.3.4" class="ltx_td ltx_align_center">4-completion</td>
</tr>
<tr id="A2.T4.2.2.4" class="ltx_tr">
<td id="A2.T4.2.2.4.1" class="ltx_td ltx_border_r"></td>
<td id="A2.T4.2.2.4.2" class="ltx_td ltx_align_center">Rating</td>
<td id="A2.T4.2.2.4.3" class="ltx_td"></td>
<td id="A2.T4.2.2.4.4" class="ltx_td ltx_align_center">Rating</td>
</tr>
<tr id="A2.T4.2.2.5" class="ltx_tr">
<td id="A2.T4.2.2.5.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Alpaca-7B</td>
<td id="A2.T4.2.2.5.2" class="ltx_td ltx_align_center ltx_border_t">3.752</td>
<td id="A2.T4.2.2.5.3" class="ltx_td ltx_border_t"></td>
<td id="A2.T4.2.2.5.4" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="A2.T4.1.1.1" class="ltx_tr">
<td id="A2.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r"><span id="A2.T4.1.1.1.1.1" class="ltx_text ltx_markedasmath">FedBis</span></td>
<td id="A2.T4.1.1.1.2" class="ltx_td ltx_align_center">4.140</td>
<td id="A2.T4.1.1.1.3" class="ltx_td"></td>
<td id="A2.T4.1.1.1.4" class="ltx_td ltx_align_center">4.113</td>
</tr>
<tr id="A2.T4.2.2.2" class="ltx_tr">
<td id="A2.T4.2.2.2.1" class="ltx_td ltx_align_center ltx_border_r"><span id="A2.T4.2.2.2.1.1" class="ltx_text ltx_markedasmath">FedBiscuit</span></td>
<td id="A2.T4.2.2.2.2" class="ltx_td ltx_align_center">4.094</td>
<td id="A2.T4.2.2.2.3" class="ltx_td"></td>
<td id="A2.T4.2.2.2.4" class="ltx_td ltx_align_center">3.830</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Performce under QA.</figcaption>
</figure>
<div id="A2.SS1.p2" class="ltx_para">
<p id="A2.SS1.p2.2" class="ltx_p">As presented in Section <a href="#S4" title="4 FedBiscuit: FedBis with Cluster-wise Aggregation ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the LLM owner will generate a set of responses to a given instruction before building a preference dataset. Therefore, the column "2-completion" means the owner prepares 2 completions for each instruction, while "4-completion" means 4 completions for each instruction and forms 6 pairs. The row "Alpaca-7B" acts as a baseline to help us understand the performance of the proposed <span id="A2.SS1.p2.2.1" class="ltx_text ltx_markedasmath">FedBiscuit</span> and <span id="A2.SS1.p2.2.2" class="ltx_text ltx_markedasmath">FedBis</span>. All the rating comes from Auto-J <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib24" title="" class="ltx_ref">2023a</a>)</cite>, which would be different from the ratings reported by <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib26" title="" class="ltx_ref">2023b</a>)</cite> because it evaluates with GPT-4 <cite class="ltx_cite ltx_citemacro_cite">Achiam et al. (<a href="#bib.bib1" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
<div id="A2.SS1.p3" class="ltx_para">
<p id="A2.SS1.p3.8" class="ltx_p">The table above may lead to conclusions different from those drawn from the summarization task. First, <span id="A2.SS1.p3.8.1" class="ltx_text ltx_markedasmath">FedBis</span> achieves better performance than <span id="A2.SS1.p3.8.2" class="ltx_text ltx_markedasmath">FedBiscuit</span>. This is within our expectations. First, these selectors are trained for a total of 200 rounds. As presented in Figure <a href="#S6.F3" title="Figure 3 ‣ 6.2 Numerical Results on Summarization ‣ 6 Experiments ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, <span id="A2.SS1.p3.8.3" class="ltx_text ltx_markedasmath">FedBiscuit</span> surpasses <span id="A2.SS1.p3.8.4" class="ltx_text ltx_markedasmath">FedBis</span> after 300 communication rounds. This is because the selectors of <span id="A2.SS1.p3.8.5" class="ltx_text ltx_markedasmath">FedBiscuit</span> are trained for 100 rounds only, while the selector of <span id="A2.SS1.p3.8.6" class="ltx_text ltx_markedasmath">FedBis</span> has been fully trained for 200 rounds. When the inflection point appears in <span id="A2.SS1.p3.8.7" class="ltx_text ltx_markedasmath">FedBis</span>, we can hypothesize that the dominance of <span id="A2.SS1.p3.8.8" class="ltx_text ltx_markedasmath">FedBiscuit</span> still exists.</p>
</div>
<div id="A2.SS1.p4" class="ltx_para">
<p id="A2.SS1.p4.1" class="ltx_p">Another comparison arises between different numbers of generations to a given prompt. From the table, we notice that "2-completion" can achieve better performance than "4-completion," meaning that the performance may not be relevant to the size of the RLFT training set. Instead, it may rely on the quality of the training data. As we can see, Alpaca-7B hardly generates high-quality data, leading to limited improvement with training with these generated data. In other words, if we generate more low-quality completions, the improvement of the model would be more limited. At the same time, we can hypothesize that if the generated data are of high quality, "4-completion" may outperform "2-completion" in terms of the final rating.</p>
</div>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Examples on the Final RLHF Results</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.2" class="ltx_p">In this section, we prepare two examples to illustrate the performance of our proposed <span id="A2.SS2.p1.2.1" class="ltx_text ltx_markedasmath">FedBis</span> and <span id="A2.SS2.p1.2.2" class="ltx_text ltx_markedasmath">FedBiscuit</span> and compare them with other baselines. Refer to Table <a href="#A2.T5" title="Table 5 ‣ B.2 Examples on the Final RLHF Results ‣ Appendix B More Numerical Results and Analysis ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and Table <a href="#A2.T6" title="Table 6 ‣ B.2 Examples on the Final RLHF Results ‣ Appendix B More Numerical Results and Analysis ‣ On the Client Preference of LLM Fine-tuning in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> for the demonstration of the examples.</p>
</div>
<figure id="A2.T5" class="ltx_table">
<table id="A2.T5.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A2.T5.2.3" class="ltx_tr">
<td id="A2.T5.2.3.1" class="ltx_td ltx_align_justify">
<span id="A2.T5.2.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T5.2.3.1.1.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:2.0pt;background:black;display:inline-block;"> </span></span>
</span>
Subreddit: r/relationships
Title:
Me [25F] with my SO [27 M] of 3.5 years, I went through his texts and can’t stop thinking about something I saw.
Post:
I admit that going through his text messages was wrong and I do feel incredibly guilty about it now but the bigger issue for me is that I found something that I can’t stop thinking about. He was talking to his good female friend and I saw a text that said "am I being an idiot for leaving [my name]"? . I stopped reading after that because I started having a panic attack. The idea of breaking up was not even on my radar and I thought he was more than happy. Again, I know I shouldn’t have looked but whats done is done and now I can’t stop worrying about when it’s going to happen. And now i’m being clingy just because of my worry which i’m sure doesn’t help. I love him and don’t want to lose him.</td>
</tr>
<tr id="A2.T5.2.4" class="ltx_tr">
<td id="A2.T5.2.4.1" class="ltx_td ltx_align_justify ltx_border_t">
<span id="A2.T5.2.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T5.2.4.1.1.1" class="ltx_p"><span id="A2.T5.2.4.1.1.1.1" class="ltx_text ltx_font_bold">Human Summary:</span></span>
<span id="A2.T5.2.4.1.1.2" class="ltx_p">I saw a text from my SO to his friend about leaving me, can’t stop freaking out. Need serious advice.</span>
</span>
</td>
</tr>
<tr id="A2.T5.2.5" class="ltx_tr">
<td id="A2.T5.2.5.1" class="ltx_td ltx_align_justify ltx_border_t">
<span id="A2.T5.2.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T5.2.5.1.1.1" class="ltx_p"><span id="A2.T5.2.5.1.1.1.1" class="ltx_text ltx_font_bold">SFT:</span></span>
<span id="A2.T5.2.5.1.1.2" class="ltx_p">I went through my SO’s texts and found something I wasn’t supposed to. Now I’m being clingy and I don’t want to lose him.</span>
</span>
</td>
</tr>
<tr id="A2.T5.2.6" class="ltx_tr">
<td id="A2.T5.2.6.1" class="ltx_td ltx_align_justify ltx_border_t">
<span id="A2.T5.2.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T5.2.6.1.1.1" class="ltx_p"><span id="A2.T5.2.6.1.1.1.1" class="ltx_text ltx_font_bold">Centralized:</span></span>
<span id="A2.T5.2.6.1.1.2" class="ltx_p">went through my boyfriends texts and found something that i’m now worrying about when/if he’s going to break up with me. I love him and don’t want to lose him. Help.</span>
</span>
</td>
</tr>
<tr id="A2.T5.1.1" class="ltx_tr">
<td id="A2.T5.1.1.1" class="ltx_td ltx_align_justify ltx_border_t">
<span id="A2.T5.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T5.1.1.1.1.1" class="ltx_p"><span id="A2.T5.1.1.1.1.1.1" class="ltx_text ltx_markedasmath ltx_font_bold">FedBis</span><span id="A2.T5.1.1.1.1.1.2" class="ltx_text ltx_font_bold">:</span></span>
<span id="A2.T5.1.1.1.1.2" class="ltx_p">went through SO’s texts and found a text that said "am I being an idot for leaving [my name]"? and now I’m worried he’s going to break up with me and can’t stop thinking about it.</span>
</span>
</td>
</tr>
<tr id="A2.T5.2.2" class="ltx_tr">
<td id="A2.T5.2.2.1" class="ltx_td ltx_align_justify ltx_border_t">
<span id="A2.T5.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T5.2.2.1.1.1" class="ltx_p"><span id="A2.T5.2.2.1.1.1.1" class="ltx_text ltx_markedasmath ltx_font_bold">FedBiscuit</span><span id="A2.T5.2.2.1.1.1.2" class="ltx_text ltx_font_bold">:</span></span>
<span id="A2.T5.2.2.1.1.2" class="ltx_p">went through SO’s texts, found something that i’m now worrying about when the inevitable breakup is going to happen. Now being clingy and can’t stop thinking about it. Help!</span>
</span>
</td>
</tr>
<tr id="A2.T5.2.7" class="ltx_tr">
<td id="A2.T5.2.7.1" class="ltx_td ltx_align_justify ltx_border_t">
<span id="A2.T5.2.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T5.2.7.1.1.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:2.0pt;background:black;display:inline-block;"> </span></span>
</span>
</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>An example for summarization task. <span id="A2.T5.4.1" class="ltx_text" style="color:#FF0000;">Caution: The example data that may be offensive or harmful.</span></figcaption>
</figure>
<figure id="A2.T6" class="ltx_table">
<table id="A2.T6.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A2.T6.2.3" class="ltx_tr">
<td id="A2.T6.2.3.1" class="ltx_td ltx_align_justify">
<span id="A2.T6.2.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T6.2.3.1.1.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:2.0pt;background:black;display:inline-block;"> </span></span>
</span>
List the layers of the TCP/IP model and for each layer identify one protocol.</td>
</tr>
<tr id="A2.T6.2.4" class="ltx_tr">
<td id="A2.T6.2.4.1" class="ltx_td ltx_align_justify ltx_border_t">
<span id="A2.T6.2.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T6.2.4.1.1.1" class="ltx_p"><span id="A2.T6.2.4.1.1.1.1" class="ltx_text ltx_font_bold">Alpaca-7B:</span></span>
<span id="A2.T6.2.4.1.1.2" class="ltx_p">The TCP/IP model consists of four layers: the application layer, transport layer, internet layer and network access layer.</span>
<span id="A2.T6.2.4.1.1.3" class="ltx_p">Application Layer: HTTP
<br class="ltx_break">Transport Layer: TCP
<br class="ltx_break">Internet Layer: IP
<br class="ltx_break">Network Access Layer: Ethernet
<br class="ltx_break"></span>
</span>
</td>
</tr>
<tr id="A2.T6.1.1" class="ltx_tr">
<td id="A2.T6.1.1.1" class="ltx_td ltx_align_justify ltx_border_t">
<span id="A2.T6.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T6.1.1.1.1.1" class="ltx_p"><span id="A2.T6.1.1.1.1.1.1" class="ltx_text ltx_markedasmath ltx_font_bold">FedBis</span><span id="A2.T6.1.1.1.1.1.2" class="ltx_text ltx_font_bold">:</span></span>
<span id="A2.T6.1.1.1.1.2" class="ltx_p">The TCP/IP model has four layers: the application layer, transport layer, internet layer and network access layer. At the application layer, the protocol is TCP. At the transport layer, the protocol is UDP. At the internet layer, the protocol is IP. At the network access layer, the protocol is Ethernet.</span>
<span id="A2.T6.1.1.1.1.3" class="ltx_p">1. Application layer: TCP
<br class="ltx_break">2. Transport layer: UDP
<br class="ltx_break">3. Internet layer: IP
<br class="ltx_break">4. Network access layer: Ethernet</span>
</span>
</td>
</tr>
<tr id="A2.T6.2.2" class="ltx_tr">
<td id="A2.T6.2.2.1" class="ltx_td ltx_align_justify ltx_border_t">
<span id="A2.T6.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T6.2.2.1.1.1" class="ltx_p"><span id="A2.T6.2.2.1.1.1.1" class="ltx_text ltx_markedasmath ltx_font_bold">FedBiscuit</span><span id="A2.T6.2.2.1.1.1.2" class="ltx_text ltx_font_bold">:</span></span>
<span id="A2.T6.2.2.1.1.2" class="ltx_p">The TCP/IP model has four layers: the application layer, transport layer, internet layer and network access layer. At the application layer, the HTTP protocol is used. The transport layer uses the TCP protocol. At the internet layer, the IP protocol is used. Finally, the network access layer uses the Ethernet protocol.</span>
</span>
</td>
</tr>
<tr id="A2.T6.2.5" class="ltx_tr">
<td id="A2.T6.2.5.1" class="ltx_td ltx_align_justify ltx_border_t">
<span id="A2.T6.2.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T6.2.5.1.1.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:2.0pt;background:black;display:inline-block;"> </span></span>
</span>
</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>An example for QA task. <span id="A2.T6.4.1" class="ltx_text" style="color:#FF0000;">Caution: The example data that may be offensive or harmful.</span></figcaption>
</figure>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2407.03037" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2407.03038" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2407.03038">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2407.03038" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2407.03039" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Aug  5 15:52:43 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
