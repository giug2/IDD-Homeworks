<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2106.00275] H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning</title><meta property="og:description" content="The longstanding goals of federated learning (FL) require rigorous privacy guarantees and low communication overhead while holding a relatively high model accuracy. However, simultaneously achieving all the goals is ex…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2106.00275">

<!--Generated on Sun Mar  3 22:42:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
He Yang<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Contact Author</span></span></span>
<br class="ltx_break"><span id="id1.1.id1" class="ltx_ERROR undefined">\affiliations</span>Xi’an Jiaotong University
<br class="ltx_break"><span id="id2.2.id2" class="ltx_ERROR undefined">\emails</span>sleepingcat@stu.xjtu.edu.cn
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">The longstanding goals of federated learning (FL) require rigorous privacy guarantees and low communication overhead while holding a relatively high model accuracy. However, simultaneously achieving all the goals is extremely challenging. In this paper, we propose a novel framework called <span id="id3.id1.1" class="ltx_text ltx_font_bold">h</span>ierarchical <span id="id3.id1.2" class="ltx_text ltx_font_bold">f</span>ederated <span id="id3.id1.3" class="ltx_text ltx_font_bold">l</span>earning (H-FL) to tackle this challenge. Considering the degradation of the model performance due to the statistic heterogeneity of the training data, we devise a runtime distribution reconstruction strategy, which reallocates the clients appropriately and utilizes mediators to rearrange the local training of the clients. In addition, we design a compression-correction mechanism incorporated into H-FL to reduce the communication overhead while not sacrificing the model performance. To further provide privacy guarantees, we introduce differential privacy while performing local training, which injects moderate amount of noise into only part of the complete model. Experimental results show that our H-FL framework achieves the state-of-art performance on different datasets for the real-world image recognition tasks.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) is a promising distributed paradigm for training a shared model while keeping all the training data localized <span id="S1.p1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S1.p1.1.2" class="ltx_text ltx_font_bold">?</span>; <span id="S1.p1.1.3" class="ltx_text ltx_font_bold">?</span>; <span id="S1.p1.1.4" class="ltx_text ltx_font_bold">?<span id="S1.p1.1.4.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span>. However, FL always involves expensive communication and privacy concerns in order to maintain a great model performance <span id="S1.p1.1.5" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S1.p1.1.6" class="ltx_text ltx_font_bold">?</span>; <span id="S1.p1.1.7" class="ltx_text ltx_font_bold">?<span id="S1.p1.1.7.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span>. Therefore, how to find a great balance among model performance, communication overhead and privacy requirements is a long-term, challenging goal.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">From a methodological standpoint, DGC <span id="S1.p2.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S1.p2.1.2" class="ltx_text ltx_font_bold">?<span id="S1.p2.1.2.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> and FetchSGD <span id="S1.p2.1.3" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S1.p2.1.4" class="ltx_text ltx_font_bold">?<span id="S1.p2.1.4.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> have given a good trade-off between communication overhead and model performance by compressing the gradients and giving some corrections. NbAFL <span id="S1.p2.1.5" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S1.p2.1.6" class="ltx_text ltx_font_bold">?<span id="S1.p2.1.6.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> and DP-FedAVG  <span id="S1.p2.1.7" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S1.p2.1.8" class="ltx_text ltx_font_bold">?<span id="S1.p2.1.8.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> provide strong privacy guarantees via differential privacy without undue sacrifice on model performance. SplitNN <span id="S1.p2.1.9" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S1.p2.1.10" class="ltx_text ltx_font_bold">?<span id="S1.p2.1.10.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> can achieve higher model performance in contrast to the aforementioned methods while protecting sensitive raw data. All these works try to make some trade-offs from different perspectives. However, when treating model performance, communication overhead and privacy requirements as a whole perspective, it will introduce a completely new contradiction: the contradiction between communication overhead and privacy requirements while maintaining model performance in a certain level. Since when utilizing some privacy protection methods such as differential privacy and secure multiparty computing to provide privacy guarantees, it will inevitably introduce additional communication overhead directly or slow down the convergence rate, leading to requiring extra communication rounds for FL algorithms to converge. Therefore, we cannot just do simple combinations from different perspectives.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we develop a <span id="S1.p3.1.1" class="ltx_text ltx_font_bold">h</span>ierarchical <span id="S1.p3.1.2" class="ltx_text ltx_font_bold">f</span>ederated <span id="S1.p3.1.3" class="ltx_text ltx_font_bold">l</span>earning architecture (H-FL) as shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. To counter-weigh the degradation of model performance due to statistic heterogeneity of the training data, H-FL introduces mediators to reconstruct the local distributions. We cluster the clients according to the KL divergence between local distributions of each client and a uniform distribution, as well as the information entropy of the local distributions, and then reallocate them to different mediators. When participating in federated tasks, H-FL selects mediators rather than clients and each mediator rearranges its clients to perform the training tasks in order to alleviate the statistic heterogeneity. In addition, we design a compression-correction mechanism to reduce the communication overhead without sacrificing the model performance, which significantly compresses the extracted features of the clients uploaded to mediators and corrects the corresponding gradients download from the mediators. To further provide privacy guarantees for clients, we introduce differential privacy when each client conducts its local training.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2106.00275/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="361" height="154" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>H-FL architecture. FL server splits the complete model into two pieces: shallow model and deep model, and then distributes the former one to the <span id="S1.F1.11.1" class="ltx_text ltx_font_bold">A</span>ggregation <span id="S1.F1.12.2" class="ltx_text ltx_font_bold">M</span>ediator (<math id="S1.F1.5.m1.1" class="ltx_Math" alttext="\mathcal{AM}" display="inline"><semantics id="S1.F1.5.m1.1b"><mrow id="S1.F1.5.m1.1.1" xref="S1.F1.5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.5.m1.1.1.2" xref="S1.F1.5.m1.1.1.2.cmml">𝒜</mi><mo lspace="0em" rspace="0em" id="S1.F1.5.m1.1.1.1" xref="S1.F1.5.m1.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.5.m1.1.1.3" xref="S1.F1.5.m1.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.5.m1.1c"><apply id="S1.F1.5.m1.1.1.cmml" xref="S1.F1.5.m1.1.1"><times id="S1.F1.5.m1.1.1.1.cmml" xref="S1.F1.5.m1.1.1.1"></times><ci id="S1.F1.5.m1.1.1.2.cmml" xref="S1.F1.5.m1.1.1.2">𝒜</ci><ci id="S1.F1.5.m1.1.1.3.cmml" xref="S1.F1.5.m1.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.m1.1d">\mathcal{AM}</annotation></semantics></math>) and the latter one to the other Mediators (<math id="S1.F1.6.m2.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S1.F1.6.m2.1b"><mi class="ltx_font_mathcaligraphic" id="S1.F1.6.m2.1.1" xref="S1.F1.6.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S1.F1.6.m2.1c"><ci id="S1.F1.6.m2.1.1.cmml" xref="S1.F1.6.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m2.1d">\mathcal{M}</annotation></semantics></math>). <math id="S1.F1.7.m3.1" class="ltx_Math" alttext="\mathcal{AM}" display="inline"><semantics id="S1.F1.7.m3.1b"><mrow id="S1.F1.7.m3.1.1" xref="S1.F1.7.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.7.m3.1.1.2" xref="S1.F1.7.m3.1.1.2.cmml">𝒜</mi><mo lspace="0em" rspace="0em" id="S1.F1.7.m3.1.1.1" xref="S1.F1.7.m3.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.7.m3.1.1.3" xref="S1.F1.7.m3.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.7.m3.1c"><apply id="S1.F1.7.m3.1.1.cmml" xref="S1.F1.7.m3.1.1"><times id="S1.F1.7.m3.1.1.1.cmml" xref="S1.F1.7.m3.1.1.1"></times><ci id="S1.F1.7.m3.1.1.2.cmml" xref="S1.F1.7.m3.1.1.2">𝒜</ci><ci id="S1.F1.7.m3.1.1.3.cmml" xref="S1.F1.7.m3.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.7.m3.1d">\mathcal{AM}</annotation></semantics></math> distributes the shallow model to all the clients and is responsible for aggregating shallow models. In addition, FL server is responsible for aggregating deep models. Particularly, <math id="S1.F1.8.m4.1" class="ltx_Math" alttext="\mathcal{AM}" display="inline"><semantics id="S1.F1.8.m4.1b"><mrow id="S1.F1.8.m4.1.1" xref="S1.F1.8.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.8.m4.1.1.2" xref="S1.F1.8.m4.1.1.2.cmml">𝒜</mi><mo lspace="0em" rspace="0em" id="S1.F1.8.m4.1.1.1" xref="S1.F1.8.m4.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S1.F1.8.m4.1.1.3" xref="S1.F1.8.m4.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.8.m4.1c"><apply id="S1.F1.8.m4.1.1.cmml" xref="S1.F1.8.m4.1.1"><times id="S1.F1.8.m4.1.1.1.cmml" xref="S1.F1.8.m4.1.1.1"></times><ci id="S1.F1.8.m4.1.1.2.cmml" xref="S1.F1.8.m4.1.1.2">𝒜</ci><ci id="S1.F1.8.m4.1.1.3.cmml" xref="S1.F1.8.m4.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.8.m4.1d">\mathcal{AM}</annotation></semantics></math> sends the final global shallow model to FL server at the end of the collaborative training.</figcaption>
</figure>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our contributions can be summarized as following:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">To the best of our knowledge, H-FL is the first attempt to treat model performance, communication overhead and privacy requirements as a whole perspective to find a great balance among them.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We devise a runtime distribution reconstruction strategy to alleviate the statistic heterogeneity of the training data while not compromising user privacy. Moreover, we design a compression-correction mechanism to reduce the communication overhead without sacrificing the model performance.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Extensive experiments on different datasets show that our H-FL architecture achieves state-of-the-art performance on federated image recognition tasks.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Research</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Federated learning is a collaborative distributed learning paradigm which removes the necessity to pool the raw data out from local clients. Specifically, FedAVG algorithm proposed in <span id="S2.p1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S2.p1.1.2" class="ltx_text ltx_font_bold">?<span id="S2.p1.1.2.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> aims to reduce the communication overhead while maintaining a good performance of the model on non-IID (Independent and identically distributed) training data, which is used as our baseline in Section <a href="#S4" title="4 Experimental Results ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Furthermore, concurrent works such as <span id="S2.p1.1.3" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S2.p1.1.4" class="ltx_text ltx_font_bold">?</span>; <span id="S2.p1.1.5" class="ltx_text ltx_font_bold">?<span id="S2.p1.1.5.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> have focused on further reducing communication overhead in FL via gradient sparsification, and propose solutions to counter-weigh the reduction in accuracy due to the statistic heterogeneity of the training data. Concretely, DGC <span id="S2.p1.1.6" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S2.p1.1.7" class="ltx_text ltx_font_bold">?<span id="S2.p1.1.7.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> employs momentum correction and local gradient clipping on top of the gradient sparsification to ensure no loss of accuracy. In addition, DGC also uses momentum factor masking and warmup training to overcome the staleness problem caused by reduced communication. STC <span id="S2.p1.1.8" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S2.p1.1.9" class="ltx_text ltx_font_bold">?<span id="S2.p1.1.9.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> propose a sparse ternary compression (STC) framework to reduce the communication overhead in FL, which enables ternarization and optimal
Golomb encoding of the weight updates and also behaves robust to non-IID training data. We conduct a comprehensive analysis and comparison with the aforementioned methods in Section <a href="#S4" title="4 Experimental Results ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> to illustrate the effectiveness of our H-FL framework. in Section <a href="#S4" title="4 Experimental Results ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> to illustrate the effectiveness of our H-FL framework.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Our Approach</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we propose a hierarchical FL architecture as shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> to find a great balance among model performance, communication overhead and privacy requirements.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<table id="S3.T1.18" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.18.19.1" class="ltx_tr">
<th id="S3.T1.18.19.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt">Notation</th>
<th id="S3.T1.18.19.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Definition</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.2.2" class="ltx_tr">
<th id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="W^{(d)}_{t}" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><msubsup id="S3.T1.1.1.1.m1.1.2" xref="S3.T1.1.1.1.m1.1.2.cmml"><mi id="S3.T1.1.1.1.m1.1.2.2.2" xref="S3.T1.1.1.1.m1.1.2.2.2.cmml">W</mi><mi id="S3.T1.1.1.1.m1.1.2.3" xref="S3.T1.1.1.1.m1.1.2.3.cmml">t</mi><mrow id="S3.T1.1.1.1.m1.1.1.1.3" xref="S3.T1.1.1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.T1.1.1.1.m1.1.1.1.3.1" xref="S3.T1.1.1.1.m1.1.2.cmml">(</mo><mi id="S3.T1.1.1.1.m1.1.1.1.1" xref="S3.T1.1.1.1.m1.1.1.1.1.cmml">d</mi><mo stretchy="false" id="S3.T1.1.1.1.m1.1.1.1.3.2" xref="S3.T1.1.1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.m1.1.2.cmml" xref="S3.T1.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.T1.1.1.1.m1.1.2.1.cmml" xref="S3.T1.1.1.1.m1.1.2">subscript</csymbol><apply id="S3.T1.1.1.1.m1.1.2.2.cmml" xref="S3.T1.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.T1.1.1.1.m1.1.2.2.1.cmml" xref="S3.T1.1.1.1.m1.1.2">superscript</csymbol><ci id="S3.T1.1.1.1.m1.1.2.2.2.cmml" xref="S3.T1.1.1.1.m1.1.2.2.2">𝑊</ci><ci id="S3.T1.1.1.1.m1.1.1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1">𝑑</ci></apply><ci id="S3.T1.1.1.1.m1.1.2.3.cmml" xref="S3.T1.1.1.1.m1.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">W^{(d)}_{t}</annotation></semantics></math></th>
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_left ltx_border_t">global deep model at round <math id="S3.T1.2.2.2.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.T1.2.2.2.m1.1a"><mi id="S3.T1.2.2.2.m1.1.1" xref="S3.T1.2.2.2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.m1.1b"><ci id="S3.T1.2.2.2.m1.1.1.cmml" xref="S3.T1.2.2.2.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.m1.1c">t</annotation></semantics></math>
</td>
</tr>
<tr id="S3.T1.4.4" class="ltx_tr">
<th id="S3.T1.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S3.T1.3.3.1.m1.1" class="ltx_Math" alttext="W^{(s)}_{t}" display="inline"><semantics id="S3.T1.3.3.1.m1.1a"><msubsup id="S3.T1.3.3.1.m1.1.2" xref="S3.T1.3.3.1.m1.1.2.cmml"><mi id="S3.T1.3.3.1.m1.1.2.2.2" xref="S3.T1.3.3.1.m1.1.2.2.2.cmml">W</mi><mi id="S3.T1.3.3.1.m1.1.2.3" xref="S3.T1.3.3.1.m1.1.2.3.cmml">t</mi><mrow id="S3.T1.3.3.1.m1.1.1.1.3" xref="S3.T1.3.3.1.m1.1.2.cmml"><mo stretchy="false" id="S3.T1.3.3.1.m1.1.1.1.3.1" xref="S3.T1.3.3.1.m1.1.2.cmml">(</mo><mi id="S3.T1.3.3.1.m1.1.1.1.1" xref="S3.T1.3.3.1.m1.1.1.1.1.cmml">s</mi><mo stretchy="false" id="S3.T1.3.3.1.m1.1.1.1.3.2" xref="S3.T1.3.3.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.1.m1.1b"><apply id="S3.T1.3.3.1.m1.1.2.cmml" xref="S3.T1.3.3.1.m1.1.2"><csymbol cd="ambiguous" id="S3.T1.3.3.1.m1.1.2.1.cmml" xref="S3.T1.3.3.1.m1.1.2">subscript</csymbol><apply id="S3.T1.3.3.1.m1.1.2.2.cmml" xref="S3.T1.3.3.1.m1.1.2"><csymbol cd="ambiguous" id="S3.T1.3.3.1.m1.1.2.2.1.cmml" xref="S3.T1.3.3.1.m1.1.2">superscript</csymbol><ci id="S3.T1.3.3.1.m1.1.2.2.2.cmml" xref="S3.T1.3.3.1.m1.1.2.2.2">𝑊</ci><ci id="S3.T1.3.3.1.m1.1.1.1.1.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1">𝑠</ci></apply><ci id="S3.T1.3.3.1.m1.1.2.3.cmml" xref="S3.T1.3.3.1.m1.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.1.m1.1c">W^{(s)}_{t}</annotation></semantics></math></th>
<td id="S3.T1.4.4.2" class="ltx_td ltx_align_left">global shallow model at round <math id="S3.T1.4.4.2.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.T1.4.4.2.m1.1a"><mi id="S3.T1.4.4.2.m1.1.1" xref="S3.T1.4.4.2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.2.m1.1b"><ci id="S3.T1.4.4.2.m1.1.1.cmml" xref="S3.T1.4.4.2.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.2.m1.1c">t</annotation></semantics></math>
</td>
</tr>
<tr id="S3.T1.7.7" class="ltx_tr">
<th id="S3.T1.5.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S3.T1.5.5.1.m1.1" class="ltx_Math" alttext="W_{t}^{(c)}" display="inline"><semantics id="S3.T1.5.5.1.m1.1a"><msubsup id="S3.T1.5.5.1.m1.1.2" xref="S3.T1.5.5.1.m1.1.2.cmml"><mi id="S3.T1.5.5.1.m1.1.2.2.2" xref="S3.T1.5.5.1.m1.1.2.2.2.cmml">W</mi><mi id="S3.T1.5.5.1.m1.1.2.2.3" xref="S3.T1.5.5.1.m1.1.2.2.3.cmml">t</mi><mrow id="S3.T1.5.5.1.m1.1.1.1.3" xref="S3.T1.5.5.1.m1.1.2.cmml"><mo stretchy="false" id="S3.T1.5.5.1.m1.1.1.1.3.1" xref="S3.T1.5.5.1.m1.1.2.cmml">(</mo><mi id="S3.T1.5.5.1.m1.1.1.1.1" xref="S3.T1.5.5.1.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.T1.5.5.1.m1.1.1.1.3.2" xref="S3.T1.5.5.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.1.m1.1b"><apply id="S3.T1.5.5.1.m1.1.2.cmml" xref="S3.T1.5.5.1.m1.1.2"><csymbol cd="ambiguous" id="S3.T1.5.5.1.m1.1.2.1.cmml" xref="S3.T1.5.5.1.m1.1.2">superscript</csymbol><apply id="S3.T1.5.5.1.m1.1.2.2.cmml" xref="S3.T1.5.5.1.m1.1.2"><csymbol cd="ambiguous" id="S3.T1.5.5.1.m1.1.2.2.1.cmml" xref="S3.T1.5.5.1.m1.1.2">subscript</csymbol><ci id="S3.T1.5.5.1.m1.1.2.2.2.cmml" xref="S3.T1.5.5.1.m1.1.2.2.2">𝑊</ci><ci id="S3.T1.5.5.1.m1.1.2.2.3.cmml" xref="S3.T1.5.5.1.m1.1.2.2.3">𝑡</ci></apply><ci id="S3.T1.5.5.1.m1.1.1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.1.m1.1c">W_{t}^{(c)}</annotation></semantics></math></th>
<td id="S3.T1.7.7.3" class="ltx_td ltx_align_left">shallow model kept in client <math id="S3.T1.6.6.2.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.T1.6.6.2.m1.1a"><mi id="S3.T1.6.6.2.m1.1.1" xref="S3.T1.6.6.2.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.2.m1.1b"><ci id="S3.T1.6.6.2.m1.1.1.cmml" xref="S3.T1.6.6.2.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.2.m1.1c">c</annotation></semantics></math> at round <math id="S3.T1.7.7.3.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.T1.7.7.3.m2.1a"><mi id="S3.T1.7.7.3.m2.1.1" xref="S3.T1.7.7.3.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.3.m2.1b"><ci id="S3.T1.7.7.3.m2.1.1.cmml" xref="S3.T1.7.7.3.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.3.m2.1c">t</annotation></semantics></math>
</td>
</tr>
<tr id="S3.T1.10.10" class="ltx_tr">
<th id="S3.T1.8.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S3.T1.8.8.1.m1.1" class="ltx_Math" alttext="W_{t}^{(m)}" display="inline"><semantics id="S3.T1.8.8.1.m1.1a"><msubsup id="S3.T1.8.8.1.m1.1.2" xref="S3.T1.8.8.1.m1.1.2.cmml"><mi id="S3.T1.8.8.1.m1.1.2.2.2" xref="S3.T1.8.8.1.m1.1.2.2.2.cmml">W</mi><mi id="S3.T1.8.8.1.m1.1.2.2.3" xref="S3.T1.8.8.1.m1.1.2.2.3.cmml">t</mi><mrow id="S3.T1.8.8.1.m1.1.1.1.3" xref="S3.T1.8.8.1.m1.1.2.cmml"><mo stretchy="false" id="S3.T1.8.8.1.m1.1.1.1.3.1" xref="S3.T1.8.8.1.m1.1.2.cmml">(</mo><mi id="S3.T1.8.8.1.m1.1.1.1.1" xref="S3.T1.8.8.1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.T1.8.8.1.m1.1.1.1.3.2" xref="S3.T1.8.8.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.1.m1.1b"><apply id="S3.T1.8.8.1.m1.1.2.cmml" xref="S3.T1.8.8.1.m1.1.2"><csymbol cd="ambiguous" id="S3.T1.8.8.1.m1.1.2.1.cmml" xref="S3.T1.8.8.1.m1.1.2">superscript</csymbol><apply id="S3.T1.8.8.1.m1.1.2.2.cmml" xref="S3.T1.8.8.1.m1.1.2"><csymbol cd="ambiguous" id="S3.T1.8.8.1.m1.1.2.2.1.cmml" xref="S3.T1.8.8.1.m1.1.2">subscript</csymbol><ci id="S3.T1.8.8.1.m1.1.2.2.2.cmml" xref="S3.T1.8.8.1.m1.1.2.2.2">𝑊</ci><ci id="S3.T1.8.8.1.m1.1.2.2.3.cmml" xref="S3.T1.8.8.1.m1.1.2.2.3">𝑡</ci></apply><ci id="S3.T1.8.8.1.m1.1.1.1.1.cmml" xref="S3.T1.8.8.1.m1.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.1.m1.1c">W_{t}^{(m)}</annotation></semantics></math></th>
<td id="S3.T1.10.10.3" class="ltx_td ltx_align_left">deep model kept in meditor <math id="S3.T1.9.9.2.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.T1.9.9.2.m1.1a"><mi id="S3.T1.9.9.2.m1.1.1" xref="S3.T1.9.9.2.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.2.m1.1b"><ci id="S3.T1.9.9.2.m1.1.1.cmml" xref="S3.T1.9.9.2.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.2.m1.1c">m</annotation></semantics></math> at round <math id="S3.T1.10.10.3.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.T1.10.10.3.m2.1a"><mi id="S3.T1.10.10.3.m2.1.1" xref="S3.T1.10.10.3.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.3.m2.1b"><ci id="S3.T1.10.10.3.m2.1.1.cmml" xref="S3.T1.10.10.3.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.3.m2.1c">t</annotation></semantics></math>
</td>
</tr>
<tr id="S3.T1.11.11" class="ltx_tr">
<th id="S3.T1.11.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S3.T1.11.11.1.m1.1" class="ltx_Math" alttext="\mathcal{U}" display="inline"><semantics id="S3.T1.11.11.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T1.11.11.1.m1.1.1" xref="S3.T1.11.11.1.m1.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.1.m1.1b"><ci id="S3.T1.11.11.1.m1.1.1.cmml" xref="S3.T1.11.11.1.m1.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.1.m1.1c">\mathcal{U}</annotation></semantics></math></th>
<td id="S3.T1.11.11.2" class="ltx_td ltx_align_left">all the clients</td>
</tr>
<tr id="S3.T1.12.12" class="ltx_tr">
<th id="S3.T1.12.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S3.T1.12.12.1.m1.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S3.T1.12.12.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T1.12.12.1.m1.1.1" xref="S3.T1.12.12.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.1.m1.1b"><ci id="S3.T1.12.12.1.m1.1.1.cmml" xref="S3.T1.12.12.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.1.m1.1c">\mathcal{P}</annotation></semantics></math></th>
<td id="S3.T1.12.12.2" class="ltx_td ltx_align_left">sampling probability of each client</td>
</tr>
<tr id="S3.T1.13.13" class="ltx_tr">
<th id="S3.T1.13.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S3.T1.13.13.1.m1.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.T1.13.13.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T1.13.13.1.m1.1.1" xref="S3.T1.13.13.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.1.m1.1b"><ci id="S3.T1.13.13.1.m1.1.1.cmml" xref="S3.T1.13.13.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.1.m1.1c">\mathcal{S}</annotation></semantics></math></th>
<td id="S3.T1.13.13.2" class="ltx_td ltx_align_left">sampling probability of each example</td>
</tr>
<tr id="S3.T1.14.14" class="ltx_tr">
<th id="S3.T1.14.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S3.T1.14.14.1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.T1.14.14.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T1.14.14.1.m1.1.1" xref="S3.T1.14.14.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.1.m1.1b"><ci id="S3.T1.14.14.1.m1.1.1.cmml" xref="S3.T1.14.14.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.1.m1.1c">\mathcal{C}</annotation></semantics></math></th>
<td id="S3.T1.14.14.2" class="ltx_td ltx_align_left">global compression ratio</td>
</tr>
<tr id="S3.T1.15.15" class="ltx_tr">
<th id="S3.T1.15.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S3.T1.15.15.1.m1.1" class="ltx_Math" alttext="\mathcal{I}" display="inline"><semantics id="S3.T1.15.15.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T1.15.15.1.m1.1.1" xref="S3.T1.15.15.1.m1.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.1.m1.1b"><ci id="S3.T1.15.15.1.m1.1.1.cmml" xref="S3.T1.15.15.1.m1.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.1.m1.1c">\mathcal{I}</annotation></semantics></math></th>
<td id="S3.T1.15.15.2" class="ltx_td ltx_align_left">iterations of deep training</td>
</tr>
<tr id="S3.T1.17.17" class="ltx_tr">
<th id="S3.T1.16.16.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S3.T1.16.16.1.m1.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.T1.16.16.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T1.16.16.1.m1.1.1" xref="S3.T1.16.16.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.1.m1.1b"><ci id="S3.T1.16.16.1.m1.1.1.cmml" xref="S3.T1.16.16.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.1.m1.1c">\mathcal{L}</annotation></semantics></math></th>
<td id="S3.T1.17.17.2" class="ltx_td ltx_align_left">
<math id="S3.T1.17.17.2.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S3.T1.17.17.2.m1.1a"><msub id="S3.T1.17.17.2.m1.1.1" xref="S3.T1.17.17.2.m1.1.1.cmml"><mi mathvariant="normal" id="S3.T1.17.17.2.m1.1.1.2" xref="S3.T1.17.17.2.m1.1.1.2.cmml">ℓ</mi><mn id="S3.T1.17.17.2.m1.1.1.3" xref="S3.T1.17.17.2.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.2.m1.1b"><apply id="S3.T1.17.17.2.m1.1.1.cmml" xref="S3.T1.17.17.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.17.17.2.m1.1.1.1.cmml" xref="S3.T1.17.17.2.m1.1.1">subscript</csymbol><ci id="S3.T1.17.17.2.m1.1.1.2.cmml" xref="S3.T1.17.17.2.m1.1.1.2">ℓ</ci><cn type="integer" id="S3.T1.17.17.2.m1.1.1.3.cmml" xref="S3.T1.17.17.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.2.m1.1c">\ell_{2}</annotation></semantics></math>-norm of the clipped gradients</td>
</tr>
<tr id="S3.T1.18.18" class="ltx_tr">
<th id="S3.T1.18.18.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"><math id="S3.T1.18.18.1.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.T1.18.18.1.m1.1a"><mi id="S3.T1.18.18.1.m1.1.1" xref="S3.T1.18.18.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.T1.18.18.1.m1.1b"><ci id="S3.T1.18.18.1.m1.1.1.cmml" xref="S3.T1.18.18.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.18.1.m1.1c">\sigma</annotation></semantics></math></th>
<td id="S3.T1.18.18.2" class="ltx_td ltx_align_left ltx_border_bb">noise level</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Notations and Definitions</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Adversary Model</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">We first assume that all the components (FL Server, Mediators, Clients) in H-FL have following abilities: 1) they are <span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">honest-but-curious</span>, which means that they will honestly follow the designed protocol but are curious about the others’ local data; 2) they have arbitrary auxiliary information to help infer a specific client’s private information during the process of collaboratively building a shared model; 3) they do not collude with each other, which means that they will not provide any additional information to clients during the training.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Initialization</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.12" class="ltx_p">FL server first splits the complete model into two components: shallow model and deep model, then distributes the former one to the <span id="S3.SS2.p1.12.1" class="ltx_text ltx_font_bold">A</span>ggregation <span id="S3.SS2.p1.12.2" class="ltx_text ltx_font_bold">M</span>ediator (<math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{AM}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝒜</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><times id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></times><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝒜</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{AM}</annotation></semantics></math>) and the latter one to the other Mediators (<math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathcal{M}</annotation></semantics></math>). <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{AM}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">𝒜</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><times id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></times><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝒜</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathcal{AM}</annotation></semantics></math> distributes the shallow model to all the clients. At the same time, FL server initializes the global hyper-parameters such as learning rate <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\eta</annotation></semantics></math>, sampling probability of each client <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\mathcal{P}</annotation></semantics></math>, sampling probability of each example <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathcal{S}</annotation></semantics></math>, global compression ratio <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\mathcal{C}</annotation></semantics></math> (<math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{C}&lt;0.5" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><mrow id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml">𝒞</mi><mo id="S3.SS2.p1.8.m8.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.cmml">&lt;</mo><mn id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><lt id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1"></lt><ci id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2">𝒞</ci><cn type="float" id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">\mathcal{C}&lt;0.5</annotation></semantics></math>), iterations of deep training in mediators <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{I}" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><ci id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\mathcal{I}</annotation></semantics></math>, <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><msub id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.10.m10.1.1.2" xref="S3.SS2.p1.10.m10.1.1.2.cmml">ℓ</mi><mn id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2">ℓ</ci><cn type="integer" id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">\ell_{2}</annotation></semantics></math>-norm of the clipped gradients <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><ci id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">\mathcal{L}</annotation></semantics></math> and noise level <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><mi id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><ci id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">\sigma</annotation></semantics></math>. Specifically, when sampling locally in practice, we randomly permute the local data and partition them into mini-batches of the appropriate sizes for efficiency.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Runtime Distribution Reconstruction</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.8" class="ltx_p">In FL settings, as the training data resident in the individual clients is collected by the clients themselves on the basis of their local environments, the distribution of the local datasets will considerably differ with each other. Considering this characteristic, we redefine the optimization objective function of federated learning training on non-IID datasets as follows:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<div id="S3.E1.m1.1.1.1" class="ltx_inline-block ltx_markedasmath ltx_transformed_outer" style="width:394.6pt;height:34.4pt;vertical-align:-19.7pt;"><span class="ltx_transformed_inner" style="transform:translate(96.9pt,-3.6pt) scale(1.96576475401325,1.96576475401325) ;">
<p id="S3.E1.m1.1.1.1.1" class="ltx_p"><math id="S3.E1.m1.1.1.1.1.m1.12" class="ltx_Math" alttext="\displaystyle\left.\min_{w,p^{(c)}}\mathrm{E}_{(x,y)\sim p^{(c)}}\left[\ell(f\left(x;w^{(c)}\right),y\right)\right]+\sum_{c}\mathcal{D}_{KL}\left(p\|p^{(c)}\right)" display="inline"><semantics id="S3.E1.m1.1.1.1.1.m1.12a"><mrow id="S3.E1.m1.1.1.1.1.m1.12.12" xref="S3.E1.m1.1.1.1.1.m1.12.12.cmml"><mrow id="S3.E1.m1.1.1.1.1.m1.11.11.1" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.m1.11.11.1.3" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3.cmml"><munder id="S3.E1.m1.1.1.1.1.m1.11.11.1.3.1" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3.1.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.11.11.1.3.1.2" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3.1.2.cmml">min</mi><mrow id="S3.E1.m1.1.1.1.1.m1.3.3.3.3" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.4.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.cmml">w</mi><mo id="S3.E1.m1.1.1.1.1.m1.3.3.3.3.2" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.4.cmml">,</mo><msup id="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.2" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.2.cmml">p</mi><mrow id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.cmml">)</mo></mrow></msup></mrow></munder><mo lspace="0.167em" id="S3.E1.m1.1.1.1.1.m1.11.11.1.3a" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3.cmml">⁡</mo><msub id="S3.E1.m1.1.1.1.1.m1.11.11.1.3.2" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3.2.cmml"><mi mathvariant="normal" id="S3.E1.m1.1.1.1.1.m1.11.11.1.3.2.2" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3.2.2.cmml">E</mi><mrow id="S3.E1.m1.1.1.1.1.m1.6.6.3" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.m1.6.6.3.5.2" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.5.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.6.6.3.5.2.1" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.5.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1.m1.5.5.2.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.2.2.cmml">x</mi><mo id="S3.E1.m1.1.1.1.1.m1.6.6.3.5.2.2" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.5.1.cmml">,</mo><mi id="S3.E1.m1.1.1.1.1.m1.6.6.3.3" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.3.cmml">y</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.6.6.3.5.2.3" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.5.1.cmml">)</mo></mrow><mo id="S3.E1.m1.1.1.1.1.m1.6.6.3.4" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.4.cmml">∼</mo><msup id="S3.E1.m1.1.1.1.1.m1.6.6.3.6" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.6.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.6.6.3.6.2" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.6.2.cmml">p</mi><mrow id="S3.E1.m1.1.1.1.1.m1.4.4.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.6.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.4.4.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.6.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1.m1.4.4.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.4.4.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.4.4.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.6.cmml">)</mo></mrow></msup></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.m1.11.11.1.2" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.3.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1.m1.9.9" xref="S3.E1.m1.1.1.1.1.m1.9.9.cmml">x</mi><mo id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.2.cmml">;</mo><msup id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mrow id="S3.E1.m1.1.1.1.1.m1.7.7.1.3" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.7.7.1.3.1" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1.m1.7.7.1.1" xref="S3.E1.m1.1.1.1.1.m1.7.7.1.1.cmml">c</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.7.7.1.3.2" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E1.m1.1.1.1.1.m1.10.10" xref="S3.E1.m1.1.1.1.1.m1.10.10.cmml">y</mi><mo id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.m1.12.12.3" xref="S3.E1.m1.1.1.1.1.m1.12.12.3.cmml">+</mo><mrow id="S3.E1.m1.1.1.1.1.m1.12.12.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.cmml"><mstyle displaystyle="true" id="S3.E1.m1.1.1.1.1.m1.12.12.2.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.2.cmml"><munder id="S3.E1.m1.1.1.1.1.m1.12.12.2.2a" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.2.cmml"><mo movablelimits="false" id="S3.E1.m1.1.1.1.1.m1.12.12.2.2.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.2.2.cmml">∑</mo><mi id="S3.E1.m1.1.1.1.1.m1.12.12.2.2.3" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.2.3.cmml">c</mi></munder></mstyle><mrow id="S3.E1.m1.1.1.1.1.m1.12.12.2.1" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.cmml"><msub id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.2.cmml">𝒟</mi><mrow id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.1" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.3" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.2.cmml">p</mi><mo id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.1.cmml">∥</mo><msup id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3.2.cmml">p</mi><mrow id="S3.E1.m1.1.1.1.1.m1.8.8.1.3" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.8.8.1.3.1" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1.m1.8.8.1.1" xref="S3.E1.m1.1.1.1.1.m1.8.8.1.1.cmml">c</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.8.8.1.3.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1.1.1.1.m1.12b"><apply id="S3.E1.m1.1.1.1.1.m1.12.12.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12"><plus id="S3.E1.m1.1.1.1.1.m1.12.12.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.3"></plus><apply id="S3.E1.m1.1.1.1.1.m1.11.11.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1"><times id="S3.E1.m1.1.1.1.1.m1.11.11.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.2"></times><apply id="S3.E1.m1.1.1.1.1.m1.11.11.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3"><apply id="S3.E1.m1.1.1.1.1.m1.11.11.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.11.11.1.3.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3.1">subscript</csymbol><min id="S3.E1.m1.1.1.1.1.m1.11.11.1.3.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3.1.2"></min><list id="S3.E1.m1.1.1.1.1.m1.3.3.3.4.cmml" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3"><ci id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2">𝑤</ci><apply id="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.2">𝑝</ci><ci id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1">𝑐</ci></apply></list></apply><apply id="S3.E1.m1.1.1.1.1.m1.11.11.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.11.11.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.11.11.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.3.2.2">E</ci><apply id="S3.E1.m1.1.1.1.1.m1.6.6.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.6.6.3"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.m1.6.6.3.4.cmml" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.4">similar-to</csymbol><interval closure="open" id="S3.E1.m1.1.1.1.1.m1.6.6.3.5.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.5.2"><ci id="S3.E1.m1.1.1.1.1.m1.5.5.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.2.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.m1.6.6.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.3">𝑦</ci></interval><apply id="S3.E1.m1.1.1.1.1.m1.6.6.3.6.cmml" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.6"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.6.6.3.6.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.6">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.6.6.3.6.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.6.6.3.6.2">𝑝</ci><ci id="S3.E1.m1.1.1.1.1.m1.4.4.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.1.1.1.1">𝑐</ci></apply></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.3">ℓ</ci><interval closure="open" id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.3">𝑓</ci><list id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1"><ci id="S3.E1.m1.1.1.1.1.m1.9.9.cmml" xref="S3.E1.m1.1.1.1.1.m1.9.9">𝑥</ci><apply id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.1.1.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E1.m1.1.1.1.1.m1.7.7.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.7.7.1.1">𝑐</ci></apply></list></apply><ci id="S3.E1.m1.1.1.1.1.m1.10.10.cmml" xref="S3.E1.m1.1.1.1.1.m1.10.10">𝑦</ci></interval></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.m1.12.12.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2"><apply id="S3.E1.m1.1.1.1.1.m1.12.12.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.12.12.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.m1.12.12.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.2.2"></sum><ci id="S3.E1.m1.1.1.1.1.m1.12.12.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.2.3">𝑐</ci></apply><apply id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1"><times id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.2"></times><apply id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.2">𝒟</ci><apply id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3"><times id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.1"></times><ci id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.2">𝐾</ci><ci id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.3.3.3">𝐿</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.1">conditional</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.2">𝑝</ci><apply id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.2.1.1.1.1.3.2">𝑝</ci><ci id="S3.E1.m1.1.1.1.1.m1.8.8.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.1.1">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1.1.1.1.m1.12c">\displaystyle\left.\min_{w,p^{(c)}}\mathrm{E}_{(x,y)\sim p^{(c)}}\left[\ell(f\left(x;w^{(c)}\right),y\right)\right]+\sum_{c}\mathcal{D}_{KL}\left(p\|p^{(c)}\right)</annotation></semantics></math></p>
</span></div>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="0" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.7" class="ltx_p">where <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="w^{(c)}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msup id="S3.SS3.p1.1.m1.1.2" xref="S3.SS3.p1.1.m1.1.2.cmml"><mi id="S3.SS3.p1.1.m1.1.2.2" xref="S3.SS3.p1.1.m1.1.2.2.cmml">w</mi><mrow id="S3.SS3.p1.1.m1.1.1.1.3" xref="S3.SS3.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.1.1.1.3.1" xref="S3.SS3.p1.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS3.p1.1.m1.1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.1.2">superscript</csymbol><ci id="S3.SS3.p1.1.m1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.1.2.2">𝑤</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">w^{(c)}</annotation></semantics></math>, <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="p^{(c)}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><msup id="S3.SS3.p1.2.m2.1.2" xref="S3.SS3.p1.2.m2.1.2.cmml"><mi id="S3.SS3.p1.2.m2.1.2.2" xref="S3.SS3.p1.2.m2.1.2.2.cmml">p</mi><mrow id="S3.SS3.p1.2.m2.1.1.1.3" xref="S3.SS3.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.1.1.1.3.1" xref="S3.SS3.p1.2.m2.1.2.cmml">(</mo><mi id="S3.SS3.p1.2.m2.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS3.p1.2.m2.1.1.1.3.2" xref="S3.SS3.p1.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.2.cmml" xref="S3.SS3.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2">superscript</csymbol><ci id="S3.SS3.p1.2.m2.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2">𝑝</ci><ci id="S3.SS3.p1.2.m2.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">p^{(c)}</annotation></semantics></math>, <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">p</annotation></semantics></math>, <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{KL}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">𝒟</mi><mrow id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m4.1.1.3.1" xref="S3.SS3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.4.m4.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝒟</ci><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><times id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3.1"></times><ci id="S3.SS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2">𝐾</ci><ci id="S3.SS3.p1.4.m4.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\mathcal{D}_{KL}</annotation></semantics></math> are the weights of client <span id="S3.SS3.p1.7.1" class="ltx_text ltx_font_italic">c</span>, the local distribution of client <span id="S3.SS3.p1.7.2" class="ltx_text ltx_font_italic">c</span>, the distribution of potential global training data, KL divergence between <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">p</annotation></semantics></math> and <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="p^{(c)}" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><msup id="S3.SS3.p1.6.m6.1.2" xref="S3.SS3.p1.6.m6.1.2.cmml"><mi id="S3.SS3.p1.6.m6.1.2.2" xref="S3.SS3.p1.6.m6.1.2.2.cmml">p</mi><mrow id="S3.SS3.p1.6.m6.1.1.1.3" xref="S3.SS3.p1.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.6.m6.1.1.1.3.1" xref="S3.SS3.p1.6.m6.1.2.cmml">(</mo><mi id="S3.SS3.p1.6.m6.1.1.1.1" xref="S3.SS3.p1.6.m6.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS3.p1.6.m6.1.1.1.3.2" xref="S3.SS3.p1.6.m6.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.2.cmml" xref="S3.SS3.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.2.1.cmml" xref="S3.SS3.p1.6.m6.1.2">superscript</csymbol><ci id="S3.SS3.p1.6.m6.1.2.2.cmml" xref="S3.SS3.p1.6.m6.1.2.2">𝑝</ci><ci id="S3.SS3.p1.6.m6.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">p^{(c)}</annotation></semantics></math>, respectively. When the latter term is approximate to <span id="S3.SS3.p1.7.3" class="ltx_text ltx_font_italic">0</span>, it will degrade to an optimization problem under IID. In general FL settings, <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="p^{(c)}s" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><mrow id="S3.SS3.p1.7.m7.1.2" xref="S3.SS3.p1.7.m7.1.2.cmml"><msup id="S3.SS3.p1.7.m7.1.2.2" xref="S3.SS3.p1.7.m7.1.2.2.cmml"><mi id="S3.SS3.p1.7.m7.1.2.2.2" xref="S3.SS3.p1.7.m7.1.2.2.2.cmml">p</mi><mrow id="S3.SS3.p1.7.m7.1.1.1.3" xref="S3.SS3.p1.7.m7.1.2.2.cmml"><mo stretchy="false" id="S3.SS3.p1.7.m7.1.1.1.3.1" xref="S3.SS3.p1.7.m7.1.2.2.cmml">(</mo><mi id="S3.SS3.p1.7.m7.1.1.1.1" xref="S3.SS3.p1.7.m7.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS3.p1.7.m7.1.1.1.3.2" xref="S3.SS3.p1.7.m7.1.2.2.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p1.7.m7.1.2.1" xref="S3.SS3.p1.7.m7.1.2.1.cmml">​</mo><mi id="S3.SS3.p1.7.m7.1.2.3" xref="S3.SS3.p1.7.m7.1.2.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.2.cmml" xref="S3.SS3.p1.7.m7.1.2"><times id="S3.SS3.p1.7.m7.1.2.1.cmml" xref="S3.SS3.p1.7.m7.1.2.1"></times><apply id="S3.SS3.p1.7.m7.1.2.2.cmml" xref="S3.SS3.p1.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.2.2.1.cmml" xref="S3.SS3.p1.7.m7.1.2.2">superscript</csymbol><ci id="S3.SS3.p1.7.m7.1.2.2.2.cmml" xref="S3.SS3.p1.7.m7.1.2.2.2">𝑝</ci><ci id="S3.SS3.p1.7.m7.1.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1.1.1">𝑐</ci></apply><ci id="S3.SS3.p1.7.m7.1.2.3.cmml" xref="S3.SS3.p1.7.m7.1.2.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">p^{(c)}s</annotation></semantics></math> are a series of different fixed distributions such that the latter term is a fixed value and the optimization objective will be consistent.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.2" class="ltx_p">Whereas we consider <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="p^{(c)}s" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.2" xref="S3.SS3.p2.1.m1.1.2.cmml"><msup id="S3.SS3.p2.1.m1.1.2.2" xref="S3.SS3.p2.1.m1.1.2.2.cmml"><mi id="S3.SS3.p2.1.m1.1.2.2.2" xref="S3.SS3.p2.1.m1.1.2.2.2.cmml">p</mi><mrow id="S3.SS3.p2.1.m1.1.1.1.3" xref="S3.SS3.p2.1.m1.1.2.2.cmml"><mo stretchy="false" id="S3.SS3.p2.1.m1.1.1.1.3.1" xref="S3.SS3.p2.1.m1.1.2.2.cmml">(</mo><mi id="S3.SS3.p2.1.m1.1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS3.p2.1.m1.1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.2.2.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.2.1" xref="S3.SS3.p2.1.m1.1.2.1.cmml">​</mo><mi id="S3.SS3.p2.1.m1.1.2.3" xref="S3.SS3.p2.1.m1.1.2.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.2"><times id="S3.SS3.p2.1.m1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.2.1"></times><apply id="S3.SS3.p2.1.m1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.2.2.1.cmml" xref="S3.SS3.p2.1.m1.1.2.2">superscript</csymbol><ci id="S3.SS3.p2.1.m1.1.2.2.2.cmml" xref="S3.SS3.p2.1.m1.1.2.2.2">𝑝</ci><ci id="S3.SS3.p2.1.m1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1">𝑐</ci></apply><ci id="S3.SS3.p2.1.m1.1.2.3.cmml" xref="S3.SS3.p2.1.m1.1.2.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">p^{(c)}s</annotation></semantics></math> as variable distributions rather than fixed distributions in H-FL, so we can change local distributions arbitrarily. An intuitive way is to gather the clients’ local data and form a series of different new distributions, each of which is approximate to the potential global distribution <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">p</annotation></semantics></math>, enabling the latter term in Formula (<a href="#S3.E1" title="In 3.3 Runtime Distribution Reconstruction ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) to be <span id="S3.SS3.p2.2.1" class="ltx_text ltx_font_italic">0</span>. However, sharing local data raises serious privacy risks and causes high communication overhead. Therefore, we introduce the runtime distribution reconstruction strategy to mitigate differences among local distributions while meeting the privacy requirements.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.7" class="ltx_p">Specifically, a uniform distribution <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="p^{(r)}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><msup id="S3.SS3.p3.1.m1.1.2" xref="S3.SS3.p3.1.m1.1.2.cmml"><mi id="S3.SS3.p3.1.m1.1.2.2" xref="S3.SS3.p3.1.m1.1.2.2.cmml">p</mi><mrow id="S3.SS3.p3.1.m1.1.1.1.3" xref="S3.SS3.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.1.m1.1.1.1.3.1" xref="S3.SS3.p3.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p3.1.m1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S3.SS3.p3.1.m1.1.1.1.3.2" xref="S3.SS3.p3.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.1.2">superscript</csymbol><ci id="S3.SS3.p3.1.m1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.1.2.2">𝑝</ci><ci id="S3.SS3.p3.1.m1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">p^{(r)}</annotation></semantics></math> is initialized and broadcast among the clients. Each client calculates the information entropy <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{H}^{(c)}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msup id="S3.SS3.p3.2.m2.1.2" xref="S3.SS3.p3.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.2.m2.1.2.2" xref="S3.SS3.p3.2.m2.1.2.2.cmml">ℋ</mi><mrow id="S3.SS3.p3.2.m2.1.1.1.3" xref="S3.SS3.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.2.m2.1.1.1.3.1" xref="S3.SS3.p3.2.m2.1.2.cmml">(</mo><mi id="S3.SS3.p3.2.m2.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS3.p3.2.m2.1.1.1.3.2" xref="S3.SS3.p3.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.2.cmml" xref="S3.SS3.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.2.1.cmml" xref="S3.SS3.p3.2.m2.1.2">superscript</csymbol><ci id="S3.SS3.p3.2.m2.1.2.2.cmml" xref="S3.SS3.p3.2.m2.1.2.2">ℋ</ci><ci id="S3.SS3.p3.2.m2.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\mathcal{H}^{(c)}</annotation></semantics></math> of its local distribution <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="p^{(c)}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><msup id="S3.SS3.p3.3.m3.1.2" xref="S3.SS3.p3.3.m3.1.2.cmml"><mi id="S3.SS3.p3.3.m3.1.2.2" xref="S3.SS3.p3.3.m3.1.2.2.cmml">p</mi><mrow id="S3.SS3.p3.3.m3.1.1.1.3" xref="S3.SS3.p3.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.3.m3.1.1.1.3.1" xref="S3.SS3.p3.3.m3.1.2.cmml">(</mo><mi id="S3.SS3.p3.3.m3.1.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS3.p3.3.m3.1.1.1.3.2" xref="S3.SS3.p3.3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.2.cmml" xref="S3.SS3.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.2">superscript</csymbol><ci id="S3.SS3.p3.3.m3.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.2.2">𝑝</ci><ci id="S3.SS3.p3.3.m3.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">p^{(c)}</annotation></semantics></math> and KL divergence <math id="S3.SS3.p3.4.m4.3" class="ltx_Math" alttext="\mathcal{D}_{KL}(p^{(r)}\|p^{(c)})" display="inline"><semantics id="S3.SS3.p3.4.m4.3a"><mrow id="S3.SS3.p3.4.m4.3.3" xref="S3.SS3.p3.4.m4.3.3.cmml"><msub id="S3.SS3.p3.4.m4.3.3.3" xref="S3.SS3.p3.4.m4.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.4.m4.3.3.3.2" xref="S3.SS3.p3.4.m4.3.3.3.2.cmml">𝒟</mi><mrow id="S3.SS3.p3.4.m4.3.3.3.3" xref="S3.SS3.p3.4.m4.3.3.3.3.cmml"><mi id="S3.SS3.p3.4.m4.3.3.3.3.2" xref="S3.SS3.p3.4.m4.3.3.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m4.3.3.3.3.1" xref="S3.SS3.p3.4.m4.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.p3.4.m4.3.3.3.3.3" xref="S3.SS3.p3.4.m4.3.3.3.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m4.3.3.2" xref="S3.SS3.p3.4.m4.3.3.2.cmml">​</mo><mrow id="S3.SS3.p3.4.m4.3.3.1.1" xref="S3.SS3.p3.4.m4.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.4.m4.3.3.1.1.2" xref="S3.SS3.p3.4.m4.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.4.m4.3.3.1.1.1" xref="S3.SS3.p3.4.m4.3.3.1.1.1.cmml"><msup id="S3.SS3.p3.4.m4.3.3.1.1.1.2" xref="S3.SS3.p3.4.m4.3.3.1.1.1.2.cmml"><mi id="S3.SS3.p3.4.m4.3.3.1.1.1.2.2" xref="S3.SS3.p3.4.m4.3.3.1.1.1.2.2.cmml">p</mi><mrow id="S3.SS3.p3.4.m4.1.1.1.3" xref="S3.SS3.p3.4.m4.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.4.m4.1.1.1.3.1" xref="S3.SS3.p3.4.m4.3.3.1.1.1.2.cmml">(</mo><mi id="S3.SS3.p3.4.m4.1.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S3.SS3.p3.4.m4.1.1.1.3.2" xref="S3.SS3.p3.4.m4.3.3.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S3.SS3.p3.4.m4.3.3.1.1.1.1" xref="S3.SS3.p3.4.m4.3.3.1.1.1.1.cmml">∥</mo><msup id="S3.SS3.p3.4.m4.3.3.1.1.1.3" xref="S3.SS3.p3.4.m4.3.3.1.1.1.3.cmml"><mi id="S3.SS3.p3.4.m4.3.3.1.1.1.3.2" xref="S3.SS3.p3.4.m4.3.3.1.1.1.3.2.cmml">p</mi><mrow id="S3.SS3.p3.4.m4.2.2.1.3" xref="S3.SS3.p3.4.m4.3.3.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS3.p3.4.m4.2.2.1.3.1" xref="S3.SS3.p3.4.m4.3.3.1.1.1.3.cmml">(</mo><mi id="S3.SS3.p3.4.m4.2.2.1.1" xref="S3.SS3.p3.4.m4.2.2.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS3.p3.4.m4.2.2.1.3.2" xref="S3.SS3.p3.4.m4.3.3.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo stretchy="false" id="S3.SS3.p3.4.m4.3.3.1.1.3" xref="S3.SS3.p3.4.m4.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.3b"><apply id="S3.SS3.p3.4.m4.3.3.cmml" xref="S3.SS3.p3.4.m4.3.3"><times id="S3.SS3.p3.4.m4.3.3.2.cmml" xref="S3.SS3.p3.4.m4.3.3.2"></times><apply id="S3.SS3.p3.4.m4.3.3.3.cmml" xref="S3.SS3.p3.4.m4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.3.3.3.1.cmml" xref="S3.SS3.p3.4.m4.3.3.3">subscript</csymbol><ci id="S3.SS3.p3.4.m4.3.3.3.2.cmml" xref="S3.SS3.p3.4.m4.3.3.3.2">𝒟</ci><apply id="S3.SS3.p3.4.m4.3.3.3.3.cmml" xref="S3.SS3.p3.4.m4.3.3.3.3"><times id="S3.SS3.p3.4.m4.3.3.3.3.1.cmml" xref="S3.SS3.p3.4.m4.3.3.3.3.1"></times><ci id="S3.SS3.p3.4.m4.3.3.3.3.2.cmml" xref="S3.SS3.p3.4.m4.3.3.3.3.2">𝐾</ci><ci id="S3.SS3.p3.4.m4.3.3.3.3.3.cmml" xref="S3.SS3.p3.4.m4.3.3.3.3.3">𝐿</ci></apply></apply><apply id="S3.SS3.p3.4.m4.3.3.1.1.1.cmml" xref="S3.SS3.p3.4.m4.3.3.1.1"><csymbol cd="latexml" id="S3.SS3.p3.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS3.p3.4.m4.3.3.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p3.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS3.p3.4.m4.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.3.3.1.1.1.2.1.cmml" xref="S3.SS3.p3.4.m4.3.3.1.1.1.2">superscript</csymbol><ci id="S3.SS3.p3.4.m4.3.3.1.1.1.2.2.cmml" xref="S3.SS3.p3.4.m4.3.3.1.1.1.2.2">𝑝</ci><ci id="S3.SS3.p3.4.m4.1.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1.1.1">𝑟</ci></apply><apply id="S3.SS3.p3.4.m4.3.3.1.1.1.3.cmml" xref="S3.SS3.p3.4.m4.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.3.3.1.1.1.3.1.cmml" xref="S3.SS3.p3.4.m4.3.3.1.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.4.m4.3.3.1.1.1.3.2.cmml" xref="S3.SS3.p3.4.m4.3.3.1.1.1.3.2">𝑝</ci><ci id="S3.SS3.p3.4.m4.2.2.1.1.cmml" xref="S3.SS3.p3.4.m4.2.2.1.1">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.3c">\mathcal{D}_{KL}(p^{(r)}\|p^{(c)})</annotation></semantics></math> between <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="p^{(r)}" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><msup id="S3.SS3.p3.5.m5.1.2" xref="S3.SS3.p3.5.m5.1.2.cmml"><mi id="S3.SS3.p3.5.m5.1.2.2" xref="S3.SS3.p3.5.m5.1.2.2.cmml">p</mi><mrow id="S3.SS3.p3.5.m5.1.1.1.3" xref="S3.SS3.p3.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.5.m5.1.1.1.3.1" xref="S3.SS3.p3.5.m5.1.2.cmml">(</mo><mi id="S3.SS3.p3.5.m5.1.1.1.1" xref="S3.SS3.p3.5.m5.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S3.SS3.p3.5.m5.1.1.1.3.2" xref="S3.SS3.p3.5.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.2.cmml" xref="S3.SS3.p3.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.2.1.cmml" xref="S3.SS3.p3.5.m5.1.2">superscript</csymbol><ci id="S3.SS3.p3.5.m5.1.2.2.cmml" xref="S3.SS3.p3.5.m5.1.2.2">𝑝</ci><ci id="S3.SS3.p3.5.m5.1.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">p^{(r)}</annotation></semantics></math> and <math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="p^{(c)}" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><msup id="S3.SS3.p3.6.m6.1.2" xref="S3.SS3.p3.6.m6.1.2.cmml"><mi id="S3.SS3.p3.6.m6.1.2.2" xref="S3.SS3.p3.6.m6.1.2.2.cmml">p</mi><mrow id="S3.SS3.p3.6.m6.1.1.1.3" xref="S3.SS3.p3.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.6.m6.1.1.1.3.1" xref="S3.SS3.p3.6.m6.1.2.cmml">(</mo><mi id="S3.SS3.p3.6.m6.1.1.1.1" xref="S3.SS3.p3.6.m6.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS3.p3.6.m6.1.1.1.3.2" xref="S3.SS3.p3.6.m6.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.2.cmml" xref="S3.SS3.p3.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.2.1.cmml" xref="S3.SS3.p3.6.m6.1.2">superscript</csymbol><ci id="S3.SS3.p3.6.m6.1.2.2.cmml" xref="S3.SS3.p3.6.m6.1.2.2">𝑝</ci><ci id="S3.SS3.p3.6.m6.1.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">p^{(c)}</annotation></semantics></math>. Furthermore, K-means algorithm is utilized to cluster the clients according to the binary group <math id="S3.SS3.p3.7.m7.5" class="ltx_Math" alttext="(\mathcal{H}^{(c)},\mathcal{D}_{KL}(p^{(r)}\|p^{(c)}))" display="inline"><semantics id="S3.SS3.p3.7.m7.5a"><mrow id="S3.SS3.p3.7.m7.5.5.2" xref="S3.SS3.p3.7.m7.5.5.3.cmml"><mo stretchy="false" id="S3.SS3.p3.7.m7.5.5.2.3" xref="S3.SS3.p3.7.m7.5.5.3.cmml">(</mo><msup id="S3.SS3.p3.7.m7.4.4.1.1" xref="S3.SS3.p3.7.m7.4.4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.7.m7.4.4.1.1.2" xref="S3.SS3.p3.7.m7.4.4.1.1.2.cmml">ℋ</mi><mrow id="S3.SS3.p3.7.m7.1.1.1.3" xref="S3.SS3.p3.7.m7.4.4.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.7.m7.1.1.1.3.1" xref="S3.SS3.p3.7.m7.4.4.1.1.cmml">(</mo><mi id="S3.SS3.p3.7.m7.1.1.1.1" xref="S3.SS3.p3.7.m7.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS3.p3.7.m7.1.1.1.3.2" xref="S3.SS3.p3.7.m7.4.4.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS3.p3.7.m7.5.5.2.4" xref="S3.SS3.p3.7.m7.5.5.3.cmml">,</mo><mrow id="S3.SS3.p3.7.m7.5.5.2.2" xref="S3.SS3.p3.7.m7.5.5.2.2.cmml"><msub id="S3.SS3.p3.7.m7.5.5.2.2.3" xref="S3.SS3.p3.7.m7.5.5.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.7.m7.5.5.2.2.3.2" xref="S3.SS3.p3.7.m7.5.5.2.2.3.2.cmml">𝒟</mi><mrow id="S3.SS3.p3.7.m7.5.5.2.2.3.3" xref="S3.SS3.p3.7.m7.5.5.2.2.3.3.cmml"><mi id="S3.SS3.p3.7.m7.5.5.2.2.3.3.2" xref="S3.SS3.p3.7.m7.5.5.2.2.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.7.m7.5.5.2.2.3.3.1" xref="S3.SS3.p3.7.m7.5.5.2.2.3.3.1.cmml">​</mo><mi id="S3.SS3.p3.7.m7.5.5.2.2.3.3.3" xref="S3.SS3.p3.7.m7.5.5.2.2.3.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.7.m7.5.5.2.2.2" xref="S3.SS3.p3.7.m7.5.5.2.2.2.cmml">​</mo><mrow id="S3.SS3.p3.7.m7.5.5.2.2.1.1" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.7.m7.5.5.2.2.1.1.2" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.cmml"><msup id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2.cmml"><mi id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2.2" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2.2.cmml">p</mi><mrow id="S3.SS3.p3.7.m7.2.2.1.3" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.7.m7.2.2.1.3.1" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2.cmml">(</mo><mi id="S3.SS3.p3.7.m7.2.2.1.1" xref="S3.SS3.p3.7.m7.2.2.1.1.cmml">r</mi><mo stretchy="false" id="S3.SS3.p3.7.m7.2.2.1.3.2" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.1" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.1.cmml">∥</mo><msup id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3.cmml"><mi id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3.2" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3.2.cmml">p</mi><mrow id="S3.SS3.p3.7.m7.3.3.1.3" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS3.p3.7.m7.3.3.1.3.1" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3.cmml">(</mo><mi id="S3.SS3.p3.7.m7.3.3.1.1" xref="S3.SS3.p3.7.m7.3.3.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS3.p3.7.m7.3.3.1.3.2" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo stretchy="false" id="S3.SS3.p3.7.m7.5.5.2.2.1.1.3" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.p3.7.m7.5.5.2.5" xref="S3.SS3.p3.7.m7.5.5.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.5b"><interval closure="open" id="S3.SS3.p3.7.m7.5.5.3.cmml" xref="S3.SS3.p3.7.m7.5.5.2"><apply id="S3.SS3.p3.7.m7.4.4.1.1.cmml" xref="S3.SS3.p3.7.m7.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.4.4.1.1.1.cmml" xref="S3.SS3.p3.7.m7.4.4.1.1">superscript</csymbol><ci id="S3.SS3.p3.7.m7.4.4.1.1.2.cmml" xref="S3.SS3.p3.7.m7.4.4.1.1.2">ℋ</ci><ci id="S3.SS3.p3.7.m7.1.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1">𝑐</ci></apply><apply id="S3.SS3.p3.7.m7.5.5.2.2.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2"><times id="S3.SS3.p3.7.m7.5.5.2.2.2.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.2"></times><apply id="S3.SS3.p3.7.m7.5.5.2.2.3.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.5.5.2.2.3.1.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.3">subscript</csymbol><ci id="S3.SS3.p3.7.m7.5.5.2.2.3.2.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.3.2">𝒟</ci><apply id="S3.SS3.p3.7.m7.5.5.2.2.3.3.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.3.3"><times id="S3.SS3.p3.7.m7.5.5.2.2.3.3.1.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.3.3.1"></times><ci id="S3.SS3.p3.7.m7.5.5.2.2.3.3.2.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.3.3.2">𝐾</ci><ci id="S3.SS3.p3.7.m7.5.5.2.2.3.3.3.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.3.3.3">𝐿</ci></apply></apply><apply id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1"><csymbol cd="latexml" id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2">superscript</csymbol><ci id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2.2.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.2.2">𝑝</ci><ci id="S3.SS3.p3.7.m7.2.2.1.1.cmml" xref="S3.SS3.p3.7.m7.2.2.1.1">𝑟</ci></apply><apply id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3.1.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3.2.cmml" xref="S3.SS3.p3.7.m7.5.5.2.2.1.1.1.3.2">𝑝</ci><ci id="S3.SS3.p3.7.m7.3.3.1.1.cmml" xref="S3.SS3.p3.7.m7.3.3.1.1">𝑐</ci></apply></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.5c">(\mathcal{H}^{(c)},\mathcal{D}_{KL}(p^{(r)}\|p^{(c)}))</annotation></semantics></math>. Then H-FL randomly selects clients from each cluster, marks them as a group, and assigns the group to one of mediators. The allocation pattern loops until all the clients are assigned to the corresponding mediator.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.4" class="ltx_p">When performing local training, each client utilizes the shallow model to extract features, which will be compressed by the lossy compressor (introduced in subsection <a href="#S3.SS4" title="3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>) and sent to the corresponding mediator. After that, each mediator concatenates the received features through a connector (as shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) to obtain synthetic features. This procedure can be considered as sampling from a virtual reconstructed distribution <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="p^{(m)}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><msup id="S3.SS3.p4.1.m1.1.2" xref="S3.SS3.p4.1.m1.1.2.cmml"><mi id="S3.SS3.p4.1.m1.1.2.2" xref="S3.SS3.p4.1.m1.1.2.2.cmml">p</mi><mrow id="S3.SS3.p4.1.m1.1.1.1.3" xref="S3.SS3.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p4.1.m1.1.1.1.3.1" xref="S3.SS3.p4.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p4.1.m1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS3.p4.1.m1.1.1.1.3.2" xref="S3.SS3.p4.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.2.1.cmml" xref="S3.SS3.p4.1.m1.1.2">superscript</csymbol><ci id="S3.SS3.p4.1.m1.1.2.2.cmml" xref="S3.SS3.p4.1.m1.1.2.2">𝑝</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">p^{(m)}</annotation></semantics></math> and then conducting forward propagation using the shallow model (see Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.3 Runtime Distribution Reconstruction ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). Intuitively, <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="p^{(m)}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><msup id="S3.SS3.p4.2.m2.1.2" xref="S3.SS3.p4.2.m2.1.2.cmml"><mi id="S3.SS3.p4.2.m2.1.2.2" xref="S3.SS3.p4.2.m2.1.2.2.cmml">p</mi><mrow id="S3.SS3.p4.2.m2.1.1.1.3" xref="S3.SS3.p4.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p4.2.m2.1.1.1.3.1" xref="S3.SS3.p4.2.m2.1.2.cmml">(</mo><mi id="S3.SS3.p4.2.m2.1.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS3.p4.2.m2.1.1.1.3.2" xref="S3.SS3.p4.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.2.cmml" xref="S3.SS3.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.2.1.cmml" xref="S3.SS3.p4.2.m2.1.2">superscript</csymbol><ci id="S3.SS3.p4.2.m2.1.2.2.cmml" xref="S3.SS3.p4.2.m2.1.2.2">𝑝</ci><ci id="S3.SS3.p4.2.m2.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">p^{(m)}</annotation></semantics></math> will be more approximate to the potential global distribution <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">p</annotation></semantics></math> than <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="p^{(c)}" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><msup id="S3.SS3.p4.4.m4.1.2" xref="S3.SS3.p4.4.m4.1.2.cmml"><mi id="S3.SS3.p4.4.m4.1.2.2" xref="S3.SS3.p4.4.m4.1.2.2.cmml">p</mi><mrow id="S3.SS3.p4.4.m4.1.1.1.3" xref="S3.SS3.p4.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS3.p4.4.m4.1.1.1.3.1" xref="S3.SS3.p4.4.m4.1.2.cmml">(</mo><mi id="S3.SS3.p4.4.m4.1.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS3.p4.4.m4.1.1.1.3.2" xref="S3.SS3.p4.4.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.2.cmml" xref="S3.SS3.p4.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.2.1.cmml" xref="S3.SS3.p4.4.m4.1.2">superscript</csymbol><ci id="S3.SS3.p4.4.m4.1.2.2.cmml" xref="S3.SS3.p4.4.m4.1.2.2">𝑝</ci><ci id="S3.SS3.p4.4.m4.1.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">p^{(c)}</annotation></semantics></math>. The optimization objective function will be changed to the following form:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.36" class="ltx_Math" alttext="\begin{split}\min_{W,p^{(m)}}&amp;\mathrm{E}_{(x,y)\sim p^{(m)}}\left[\ell\left(f\left(x;W^{(c)},W^{(m)}\right),y\right)\right]\\
&amp;+\sum_{m}\mathcal{D}_{KL}\left(p\|p^{(m)}\right)\end{split}" display="block"><semantics id="S3.E2.m1.36a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E2.m1.36.36.4" xref="S3.E2.m1.34.34.2.cmml"><mtr id="S3.E2.m1.36.36.4a" xref="S3.E2.m1.34.34.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.36.36.4b" xref="S3.E2.m1.34.34.2.cmml"><munder id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.34.34.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">min</mi><mrow id="S3.E2.m1.2.2.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.2.2.1.4.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.2.2.1.2.cmml">W</mi><mo id="S3.E2.m1.2.2.2.2.2.2.1.3.2" xref="S3.E2.m1.2.2.2.2.2.2.1.4.cmml">,</mo><msup id="S3.E2.m1.2.2.2.2.2.2.1.3.1" xref="S3.E2.m1.2.2.2.2.2.2.1.3.1.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.1.3.1.2" xref="S3.E2.m1.2.2.2.2.2.2.1.3.1.2.cmml">p</mi><mrow id="S3.E2.m1.2.2.2.2.2.2.1.1.1.3" xref="S3.E2.m1.2.2.2.2.2.2.1.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.2.1.1.1.3.1" xref="S3.E2.m1.2.2.2.2.2.2.1.3.1.cmml">(</mo><mi id="S3.E2.m1.2.2.2.2.2.2.1.1.1.1" xref="S3.E2.m1.2.2.2.2.2.2.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.2.1.1.1.3.2" xref="S3.E2.m1.2.2.2.2.2.2.1.3.1.cmml">)</mo></mrow></msup></mrow></munder></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.36.36.4c" xref="S3.E2.m1.34.34.2.cmml"><mrow id="S3.E2.m1.35.35.3.33.22.20" xref="S3.E2.m1.34.34.2.cmml"><msub id="S3.E2.m1.35.35.3.33.22.20.22" xref="S3.E2.m1.34.34.2.cmml"><mi mathvariant="normal" id="S3.E2.m1.3.3.3.3.1.1" xref="S3.E2.m1.3.3.3.3.1.1.cmml">E</mi><mrow id="S3.E2.m1.4.4.4.4.2.2.1" xref="S3.E2.m1.4.4.4.4.2.2.1.cmml"><mrow id="S3.E2.m1.4.4.4.4.2.2.1.5.2" xref="S3.E2.m1.4.4.4.4.2.2.1.5.1.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.4.4.2.2.1.5.2.1" xref="S3.E2.m1.4.4.4.4.2.2.1.5.1.cmml">(</mo><mi id="S3.E2.m1.4.4.4.4.2.2.1.2" xref="S3.E2.m1.4.4.4.4.2.2.1.2.cmml">x</mi><mo id="S3.E2.m1.4.4.4.4.2.2.1.5.2.2" xref="S3.E2.m1.4.4.4.4.2.2.1.5.1.cmml">,</mo><mi id="S3.E2.m1.4.4.4.4.2.2.1.3" xref="S3.E2.m1.4.4.4.4.2.2.1.3.cmml">y</mi><mo stretchy="false" id="S3.E2.m1.4.4.4.4.2.2.1.5.2.3" xref="S3.E2.m1.4.4.4.4.2.2.1.5.1.cmml">)</mo></mrow><mo id="S3.E2.m1.4.4.4.4.2.2.1.4" xref="S3.E2.m1.4.4.4.4.2.2.1.4.cmml">∼</mo><msup id="S3.E2.m1.4.4.4.4.2.2.1.6" xref="S3.E2.m1.4.4.4.4.2.2.1.6.cmml"><mi id="S3.E2.m1.4.4.4.4.2.2.1.6.2" xref="S3.E2.m1.4.4.4.4.2.2.1.6.2.cmml">p</mi><mrow id="S3.E2.m1.4.4.4.4.2.2.1.1.1.3" xref="S3.E2.m1.4.4.4.4.2.2.1.6.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.4.4.2.2.1.1.1.3.1" xref="S3.E2.m1.4.4.4.4.2.2.1.6.cmml">(</mo><mi id="S3.E2.m1.4.4.4.4.2.2.1.1.1.1" xref="S3.E2.m1.4.4.4.4.2.2.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.E2.m1.4.4.4.4.2.2.1.1.1.3.2" xref="S3.E2.m1.4.4.4.4.2.2.1.6.cmml">)</mo></mrow></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.35.35.3.33.22.20.21" xref="S3.E2.m1.34.34.2.cmml">​</mo><mrow id="S3.E2.m1.35.35.3.33.22.20.20.1" xref="S3.E2.m1.34.34.2.cmml"><mo id="S3.E2.m1.5.5.5.5.3.3" xref="S3.E2.m1.34.34.2.cmml">[</mo><mrow id="S3.E2.m1.35.35.3.33.22.20.20.1.1" xref="S3.E2.m1.34.34.2.cmml"><mi mathvariant="normal" id="S3.E2.m1.6.6.6.6.4.4" xref="S3.E2.m1.6.6.6.6.4.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.35.35.3.33.22.20.20.1.1.2" xref="S3.E2.m1.34.34.2.cmml">​</mo><mrow id="S3.E2.m1.35.35.3.33.22.20.20.1.1.1.1" xref="S3.E2.m1.34.34.2.cmml"><mo id="S3.E2.m1.7.7.7.7.5.5" xref="S3.E2.m1.34.34.2.cmml">(</mo><mrow id="S3.E2.m1.35.35.3.33.22.20.20.1.1.1.1.1" xref="S3.E2.m1.34.34.2.cmml"><mi id="S3.E2.m1.8.8.8.8.6.6" xref="S3.E2.m1.8.8.8.8.6.6.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.35.35.3.33.22.20.20.1.1.1.1.1.3" xref="S3.E2.m1.34.34.2.cmml">​</mo><mrow id="S3.E2.m1.35.35.3.33.22.20.20.1.1.1.1.1.2.2" xref="S3.E2.m1.34.34.2.cmml"><mo id="S3.E2.m1.9.9.9.9.7.7" xref="S3.E2.m1.34.34.2.cmml">(</mo><mi id="S3.E2.m1.10.10.10.10.8.8" xref="S3.E2.m1.10.10.10.10.8.8.cmml">x</mi><mo id="S3.E2.m1.11.11.11.11.9.9" xref="S3.E2.m1.34.34.2.cmml">;</mo><msup id="S3.E2.m1.35.35.3.33.22.20.20.1.1.1.1.1.1.1.1" xref="S3.E2.m1.34.34.2.cmml"><mi id="S3.E2.m1.12.12.12.12.10.10" xref="S3.E2.m1.12.12.12.12.10.10.cmml">W</mi><mrow id="S3.E2.m1.13.13.13.13.11.11.1.3" xref="S3.E2.m1.34.34.2.cmml"><mo stretchy="false" id="S3.E2.m1.13.13.13.13.11.11.1.3.1" xref="S3.E2.m1.34.34.2.cmml">(</mo><mi id="S3.E2.m1.13.13.13.13.11.11.1.1" xref="S3.E2.m1.13.13.13.13.11.11.1.1.cmml">c</mi><mo stretchy="false" id="S3.E2.m1.13.13.13.13.11.11.1.3.2" xref="S3.E2.m1.34.34.2.cmml">)</mo></mrow></msup><mo id="S3.E2.m1.14.14.14.14.12.12" xref="S3.E2.m1.34.34.2.cmml">,</mo><msup id="S3.E2.m1.35.35.3.33.22.20.20.1.1.1.1.1.2.2.2" xref="S3.E2.m1.34.34.2.cmml"><mi id="S3.E2.m1.15.15.15.15.13.13" xref="S3.E2.m1.15.15.15.15.13.13.cmml">W</mi><mrow id="S3.E2.m1.16.16.16.16.14.14.1.3" xref="S3.E2.m1.34.34.2.cmml"><mo stretchy="false" id="S3.E2.m1.16.16.16.16.14.14.1.3.1" xref="S3.E2.m1.34.34.2.cmml">(</mo><mi id="S3.E2.m1.16.16.16.16.14.14.1.1" xref="S3.E2.m1.16.16.16.16.14.14.1.1.cmml">m</mi><mo stretchy="false" id="S3.E2.m1.16.16.16.16.14.14.1.3.2" xref="S3.E2.m1.34.34.2.cmml">)</mo></mrow></msup><mo id="S3.E2.m1.17.17.17.17.15.15" xref="S3.E2.m1.34.34.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.18.18.18.18.16.16" xref="S3.E2.m1.34.34.2.cmml">,</mo><mi id="S3.E2.m1.19.19.19.19.17.17" xref="S3.E2.m1.19.19.19.19.17.17.cmml">y</mi><mo id="S3.E2.m1.20.20.20.20.18.18" xref="S3.E2.m1.34.34.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.21.21.21.21.19.19" xref="S3.E2.m1.34.34.2.cmml">]</mo></mrow></mrow></mtd></mtr><mtr id="S3.E2.m1.36.36.4d" xref="S3.E2.m1.34.34.2.cmml"><mtd id="S3.E2.m1.36.36.4e" xref="S3.E2.m1.34.34.2.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.36.36.4f" xref="S3.E2.m1.34.34.2.cmml"><mrow id="S3.E2.m1.36.36.4.34.12.12" xref="S3.E2.m1.34.34.2.cmml"><mo id="S3.E2.m1.36.36.4.34.12.12a" xref="S3.E2.m1.34.34.2.cmml">+</mo><mrow id="S3.E2.m1.36.36.4.34.12.12.12" xref="S3.E2.m1.34.34.2.cmml"><munder id="S3.E2.m1.36.36.4.34.12.12.12.2" xref="S3.E2.m1.34.34.2.cmml"><mo movablelimits="false" id="S3.E2.m1.23.23.23.2.2.2" xref="S3.E2.m1.23.23.23.2.2.2.cmml">∑</mo><mi id="S3.E2.m1.24.24.24.3.3.3.1" xref="S3.E2.m1.24.24.24.3.3.3.1.cmml">m</mi></munder><mrow id="S3.E2.m1.36.36.4.34.12.12.12.1" xref="S3.E2.m1.34.34.2.cmml"><msub id="S3.E2.m1.36.36.4.34.12.12.12.1.3" xref="S3.E2.m1.34.34.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.25.25.25.4.4.4" xref="S3.E2.m1.25.25.25.4.4.4.cmml">𝒟</mi><mrow id="S3.E2.m1.26.26.26.5.5.5.1" xref="S3.E2.m1.26.26.26.5.5.5.1.cmml"><mi id="S3.E2.m1.26.26.26.5.5.5.1.2" xref="S3.E2.m1.26.26.26.5.5.5.1.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.26.26.26.5.5.5.1.1" xref="S3.E2.m1.26.26.26.5.5.5.1.1.cmml">​</mo><mi id="S3.E2.m1.26.26.26.5.5.5.1.3" xref="S3.E2.m1.26.26.26.5.5.5.1.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.36.36.4.34.12.12.12.1.2" xref="S3.E2.m1.34.34.2.cmml">​</mo><mrow id="S3.E2.m1.36.36.4.34.12.12.12.1.1.1" xref="S3.E2.m1.34.34.2.cmml"><mo id="S3.E2.m1.27.27.27.6.6.6" xref="S3.E2.m1.34.34.2.cmml">(</mo><mrow id="S3.E2.m1.36.36.4.34.12.12.12.1.1.1.1" xref="S3.E2.m1.34.34.2.cmml"><mi id="S3.E2.m1.28.28.28.7.7.7" xref="S3.E2.m1.28.28.28.7.7.7.cmml">p</mi><mo id="S3.E2.m1.29.29.29.8.8.8" xref="S3.E2.m1.29.29.29.8.8.8.cmml">∥</mo><msup id="S3.E2.m1.36.36.4.34.12.12.12.1.1.1.1.1" xref="S3.E2.m1.34.34.2.cmml"><mi id="S3.E2.m1.30.30.30.9.9.9" xref="S3.E2.m1.30.30.30.9.9.9.cmml">p</mi><mrow id="S3.E2.m1.31.31.31.10.10.10.1.3" xref="S3.E2.m1.34.34.2.cmml"><mo stretchy="false" id="S3.E2.m1.31.31.31.10.10.10.1.3.1" xref="S3.E2.m1.34.34.2.cmml">(</mo><mi id="S3.E2.m1.31.31.31.10.10.10.1.1" xref="S3.E2.m1.31.31.31.10.10.10.1.1.cmml">m</mi><mo stretchy="false" id="S3.E2.m1.31.31.31.10.10.10.1.3.2" xref="S3.E2.m1.34.34.2.cmml">)</mo></mrow></msup></mrow><mo id="S3.E2.m1.32.32.32.11.11.11" xref="S3.E2.m1.34.34.2.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E2.m1.36b"><apply id="S3.E2.m1.34.34.2.cmml" xref="S3.E2.m1.36.36.4"><plus id="S3.E2.m1.22.22.22.1.1.1.cmml" xref="S3.E2.m1.36.36.4"></plus><apply id="S3.E2.m1.33.33.1.1.cmml" xref="S3.E2.m1.36.36.4"><times id="S3.E2.m1.33.33.1.1.2.cmml" xref="S3.E2.m1.36.36.4"></times><apply id="S3.E2.m1.33.33.1.1.3.cmml" xref="S3.E2.m1.36.36.4"><apply id="S3.E2.m1.33.33.1.1.3.1.cmml" xref="S3.E2.m1.36.36.4"><csymbol cd="ambiguous" id="S3.E2.m1.33.33.1.1.3.1.1.cmml" xref="S3.E2.m1.36.36.4">subscript</csymbol><min id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"></min><list id="S3.E2.m1.2.2.2.2.2.2.1.4.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.3"><ci id="S3.E2.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.2">𝑊</ci><apply id="S3.E2.m1.2.2.2.2.2.2.1.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.1.3.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.3.1">superscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.1.3.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.3.1.2">𝑝</ci><ci id="S3.E2.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.1.1.1">𝑚</ci></apply></list></apply><apply id="S3.E2.m1.33.33.1.1.3.2.cmml" xref="S3.E2.m1.36.36.4"><csymbol cd="ambiguous" id="S3.E2.m1.33.33.1.1.3.2.1.cmml" xref="S3.E2.m1.36.36.4">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1">E</ci><apply id="S3.E2.m1.4.4.4.4.2.2.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2.1"><csymbol cd="latexml" id="S3.E2.m1.4.4.4.4.2.2.1.4.cmml" xref="S3.E2.m1.4.4.4.4.2.2.1.4">similar-to</csymbol><interval closure="open" id="S3.E2.m1.4.4.4.4.2.2.1.5.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2.1.5.2"><ci id="S3.E2.m1.4.4.4.4.2.2.1.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.1.2">𝑥</ci><ci id="S3.E2.m1.4.4.4.4.2.2.1.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2.1.3">𝑦</ci></interval><apply id="S3.E2.m1.4.4.4.4.2.2.1.6.cmml" xref="S3.E2.m1.4.4.4.4.2.2.1.6"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.2.1.6.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2.1.6">superscript</csymbol><ci id="S3.E2.m1.4.4.4.4.2.2.1.6.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.1.6.2">𝑝</ci><ci id="S3.E2.m1.4.4.4.4.2.2.1.1.1.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2.1.1.1.1">𝑚</ci></apply></apply></apply></apply><apply id="S3.E2.m1.33.33.1.1.1.2.cmml" xref="S3.E2.m1.36.36.4"><csymbol cd="latexml" id="S3.E2.m1.33.33.1.1.1.2.1.cmml" xref="S3.E2.m1.36.36.4">delimited-[]</csymbol><apply id="S3.E2.m1.33.33.1.1.1.1.1.cmml" xref="S3.E2.m1.36.36.4"><times id="S3.E2.m1.33.33.1.1.1.1.1.2.cmml" xref="S3.E2.m1.36.36.4"></times><ci id="S3.E2.m1.6.6.6.6.4.4.cmml" xref="S3.E2.m1.6.6.6.6.4.4">ℓ</ci><interval closure="open" id="S3.E2.m1.33.33.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.36.36.4"><apply id="S3.E2.m1.33.33.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.36.36.4"><times id="S3.E2.m1.33.33.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.36.36.4"></times><ci id="S3.E2.m1.8.8.8.8.6.6.cmml" xref="S3.E2.m1.8.8.8.8.6.6">𝑓</ci><list id="S3.E2.m1.33.33.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.36.36.4"><ci id="S3.E2.m1.10.10.10.10.8.8.cmml" xref="S3.E2.m1.10.10.10.10.8.8">𝑥</ci><apply id="S3.E2.m1.33.33.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.36.36.4"><csymbol cd="ambiguous" id="S3.E2.m1.33.33.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.36.36.4">superscript</csymbol><ci id="S3.E2.m1.12.12.12.12.10.10.cmml" xref="S3.E2.m1.12.12.12.12.10.10">𝑊</ci><ci id="S3.E2.m1.13.13.13.13.11.11.1.1.cmml" xref="S3.E2.m1.13.13.13.13.11.11.1.1">𝑐</ci></apply><apply id="S3.E2.m1.33.33.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.36.36.4"><csymbol cd="ambiguous" id="S3.E2.m1.33.33.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.36.36.4">superscript</csymbol><ci id="S3.E2.m1.15.15.15.15.13.13.cmml" xref="S3.E2.m1.15.15.15.15.13.13">𝑊</ci><ci id="S3.E2.m1.16.16.16.16.14.14.1.1.cmml" xref="S3.E2.m1.16.16.16.16.14.14.1.1">𝑚</ci></apply></list></apply><ci id="S3.E2.m1.19.19.19.19.17.17.cmml" xref="S3.E2.m1.19.19.19.19.17.17">𝑦</ci></interval></apply></apply></apply><apply id="S3.E2.m1.34.34.2.2.cmml" xref="S3.E2.m1.36.36.4"><apply id="S3.E2.m1.34.34.2.2.2.cmml" xref="S3.E2.m1.36.36.4"><csymbol cd="ambiguous" id="S3.E2.m1.34.34.2.2.2.1.cmml" xref="S3.E2.m1.36.36.4">subscript</csymbol><sum id="S3.E2.m1.23.23.23.2.2.2.cmml" xref="S3.E2.m1.23.23.23.2.2.2"></sum><ci id="S3.E2.m1.24.24.24.3.3.3.1.cmml" xref="S3.E2.m1.24.24.24.3.3.3.1">𝑚</ci></apply><apply id="S3.E2.m1.34.34.2.2.1.cmml" xref="S3.E2.m1.36.36.4"><times id="S3.E2.m1.34.34.2.2.1.2.cmml" xref="S3.E2.m1.36.36.4"></times><apply id="S3.E2.m1.34.34.2.2.1.3.cmml" xref="S3.E2.m1.36.36.4"><csymbol cd="ambiguous" id="S3.E2.m1.34.34.2.2.1.3.1.cmml" xref="S3.E2.m1.36.36.4">subscript</csymbol><ci id="S3.E2.m1.25.25.25.4.4.4.cmml" xref="S3.E2.m1.25.25.25.4.4.4">𝒟</ci><apply id="S3.E2.m1.26.26.26.5.5.5.1.cmml" xref="S3.E2.m1.26.26.26.5.5.5.1"><times id="S3.E2.m1.26.26.26.5.5.5.1.1.cmml" xref="S3.E2.m1.26.26.26.5.5.5.1.1"></times><ci id="S3.E2.m1.26.26.26.5.5.5.1.2.cmml" xref="S3.E2.m1.26.26.26.5.5.5.1.2">𝐾</ci><ci id="S3.E2.m1.26.26.26.5.5.5.1.3.cmml" xref="S3.E2.m1.26.26.26.5.5.5.1.3">𝐿</ci></apply></apply><apply id="S3.E2.m1.34.34.2.2.1.1.1.1.cmml" xref="S3.E2.m1.36.36.4"><csymbol cd="latexml" id="S3.E2.m1.29.29.29.8.8.8.cmml" xref="S3.E2.m1.29.29.29.8.8.8">conditional</csymbol><ci id="S3.E2.m1.28.28.28.7.7.7.cmml" xref="S3.E2.m1.28.28.28.7.7.7">𝑝</ci><apply id="S3.E2.m1.34.34.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.36.36.4"><csymbol cd="ambiguous" id="S3.E2.m1.34.34.2.2.1.1.1.1.3.1.cmml" xref="S3.E2.m1.36.36.4">superscript</csymbol><ci id="S3.E2.m1.30.30.30.9.9.9.cmml" xref="S3.E2.m1.30.30.30.9.9.9">𝑝</ci><ci id="S3.E2.m1.31.31.31.10.10.10.1.1.cmml" xref="S3.E2.m1.31.31.31.10.10.10.1.1">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.36c">\begin{split}\min_{W,p^{(m)}}&amp;\mathrm{E}_{(x,y)\sim p^{(m)}}\left[\ell\left(f\left(x;W^{(c)},W^{(m)}\right),y\right)\right]\\
&amp;+\sum_{m}\mathcal{D}_{KL}\left(p\|p^{(m)}\right)\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.1" class="ltx_p">Assuming that there exists enough clients, <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="p^{(m)}" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><msup id="S3.SS3.p5.1.m1.1.2" xref="S3.SS3.p5.1.m1.1.2.cmml"><mi id="S3.SS3.p5.1.m1.1.2.2" xref="S3.SS3.p5.1.m1.1.2.2.cmml">p</mi><mrow id="S3.SS3.p5.1.m1.1.1.1.3" xref="S3.SS3.p5.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p5.1.m1.1.1.1.3.1" xref="S3.SS3.p5.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p5.1.m1.1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS3.p5.1.m1.1.1.1.3.2" xref="S3.SS3.p5.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.2.1.cmml" xref="S3.SS3.p5.1.m1.1.2">superscript</csymbol><ci id="S3.SS3.p5.1.m1.1.2.2.cmml" xref="S3.SS3.p5.1.m1.1.2.2">𝑝</ci><ci id="S3.SS3.p5.1.m1.1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">p^{(m)}</annotation></semantics></math>s will infinitely approximate the potential global distribution <span id="S3.SS3.p5.1.1" class="ltx_text ltx_font_italic">p</span> and the latter term will be <span id="S3.SS3.p5.1.2" class="ltx_text ltx_font_italic">0</span>, which is translated to the optimization problem under IID. When finishing the distribution reconstruction, each mediator leverages the synthetic features to train the deep model and then sends back the gradients of the synthesized features to the clients to assist training the shallow model. In this way, H-FL alleviates the statistic heterogeneity of the training data while not compromising user privacy.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.9.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Runtime distribution reconstruction</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.7" class="ltx_p ltx_figure_panel"><span id="alg1.7.1" class="ltx_text ltx_font_bold">Input</span>: <math id="alg1.1.m1.1" class="ltx_Math" alttext="\mathcal{U}" display="inline"><semantics id="alg1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">\mathcal{U}</annotation></semantics></math>, <math id="alg1.2.m2.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="alg1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">\mathcal{M}</annotation></semantics></math>
<br class="ltx_break"><span id="alg1.7.2" class="ltx_text ltx_font_bold">Parameter</span>: <math id="alg1.3.m3.1" class="ltx_Math" alttext="W^{(c)}" display="inline"><semantics id="alg1.3.m3.1a"><msup id="alg1.3.m3.1.2" xref="alg1.3.m3.1.2.cmml"><mi id="alg1.3.m3.1.2.2" xref="alg1.3.m3.1.2.2.cmml">W</mi><mrow id="alg1.3.m3.1.1.1.3" xref="alg1.3.m3.1.2.cmml"><mo stretchy="false" id="alg1.3.m3.1.1.1.3.1" xref="alg1.3.m3.1.2.cmml">(</mo><mi id="alg1.3.m3.1.1.1.1" xref="alg1.3.m3.1.1.1.1.cmml">c</mi><mo stretchy="false" id="alg1.3.m3.1.1.1.3.2" xref="alg1.3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><apply id="alg1.3.m3.1.2.cmml" xref="alg1.3.m3.1.2"><csymbol cd="ambiguous" id="alg1.3.m3.1.2.1.cmml" xref="alg1.3.m3.1.2">superscript</csymbol><ci id="alg1.3.m3.1.2.2.cmml" xref="alg1.3.m3.1.2.2">𝑊</ci><ci id="alg1.3.m3.1.1.1.1.cmml" xref="alg1.3.m3.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">W^{(c)}</annotation></semantics></math>,<math id="alg1.4.m4.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="alg1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><ci id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">\mathcal{P}</annotation></semantics></math>, <math id="alg1.5.m5.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="alg1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.5.m5.1.1" xref="alg1.5.m5.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><ci id="alg1.5.m5.1.1.cmml" xref="alg1.5.m5.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">\mathcal{S}</annotation></semantics></math>, <math id="alg1.6.m6.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="alg1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.6.m6.1.1" xref="alg1.6.m6.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.6.m6.1b"><ci id="alg1.6.m6.1.1.cmml" xref="alg1.6.m6.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m6.1c">\mathcal{C}</annotation></semantics></math>
<br class="ltx_break"><span id="alg1.7.3" class="ltx_text ltx_font_bold">Output</span>: <math id="alg1.7.m7.1" class="ltx_Math" alttext="\mathcal{B}^{(m)}" display="inline"><semantics id="alg1.7.m7.1a"><msup id="alg1.7.m7.1.2" xref="alg1.7.m7.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.7.m7.1.2.2" xref="alg1.7.m7.1.2.2.cmml">ℬ</mi><mrow id="alg1.7.m7.1.1.1.3" xref="alg1.7.m7.1.2.cmml"><mo stretchy="false" id="alg1.7.m7.1.1.1.3.1" xref="alg1.7.m7.1.2.cmml">(</mo><mi id="alg1.7.m7.1.1.1.1" xref="alg1.7.m7.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg1.7.m7.1.1.1.3.2" xref="alg1.7.m7.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.7.m7.1b"><apply id="alg1.7.m7.1.2.cmml" xref="alg1.7.m7.1.2"><csymbol cd="ambiguous" id="alg1.7.m7.1.2.1.cmml" xref="alg1.7.m7.1.2">superscript</csymbol><ci id="alg1.7.m7.1.2.2.cmml" xref="alg1.7.m7.1.2.2">ℬ</ci><ci id="alg1.7.m7.1.1.1.1.cmml" xref="alg1.7.m7.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m7.1c">\mathcal{B}^{(m)}</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.10" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  Randomly initialize a distribution <math id="alg1.l1.m1.1" class="ltx_Math" alttext="p^{(r)}" display="inline"><semantics id="alg1.l1.m1.1a"><msup id="alg1.l1.m1.1.2" xref="alg1.l1.m1.1.2.cmml"><mi id="alg1.l1.m1.1.2.2" xref="alg1.l1.m1.1.2.2.cmml">p</mi><mrow id="alg1.l1.m1.1.1.1.3" xref="alg1.l1.m1.1.2.cmml"><mo stretchy="false" id="alg1.l1.m1.1.1.1.3.1" xref="alg1.l1.m1.1.2.cmml">(</mo><mi id="alg1.l1.m1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l1.m1.1.1.1.3.2" xref="alg1.l1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.2.cmml" xref="alg1.l1.m1.1.2"><csymbol cd="ambiguous" id="alg1.l1.m1.1.2.1.cmml" xref="alg1.l1.m1.1.2">superscript</csymbol><ci id="alg1.l1.m1.1.2.2.cmml" xref="alg1.l1.m1.1.2.2">𝑝</ci><ci id="alg1.l1.m1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">p^{(r)}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">for</span> each <math id="alg1.l2.m1.1" class="ltx_Math" alttext="c\in\mathcal{U}" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">c</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><in id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></in><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑐</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">c\in\mathcal{U}</annotation></semantics></math> <span id="alg1.l2.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>     Compute <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\mathcal{H}^{(c)}" display="inline"><semantics id="alg1.l3.m1.1a"><msup id="alg1.l3.m1.1.2" xref="alg1.l3.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.2.2" xref="alg1.l3.m1.1.2.2.cmml">ℋ</mi><mrow id="alg1.l3.m1.1.1.1.3" xref="alg1.l3.m1.1.2.cmml"><mo stretchy="false" id="alg1.l3.m1.1.1.1.3.1" xref="alg1.l3.m1.1.2.cmml">(</mo><mi id="alg1.l3.m1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l3.m1.1.1.1.3.2" xref="alg1.l3.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.2.cmml" xref="alg1.l3.m1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.2.1.cmml" xref="alg1.l3.m1.1.2">superscript</csymbol><ci id="alg1.l3.m1.1.2.2.cmml" xref="alg1.l3.m1.1.2.2">ℋ</ci><ci id="alg1.l3.m1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathcal{H}^{(c)}</annotation></semantics></math>, <math id="alg1.l3.m2.3" class="ltx_Math" alttext="\mathcal{D}_{KL}(p^{(r)}\|p^{(c)})" display="inline"><semantics id="alg1.l3.m2.3a"><mrow id="alg1.l3.m2.3.3" xref="alg1.l3.m2.3.3.cmml"><msub id="alg1.l3.m2.3.3.3" xref="alg1.l3.m2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m2.3.3.3.2" xref="alg1.l3.m2.3.3.3.2.cmml">𝒟</mi><mrow id="alg1.l3.m2.3.3.3.3" xref="alg1.l3.m2.3.3.3.3.cmml"><mi id="alg1.l3.m2.3.3.3.3.2" xref="alg1.l3.m2.3.3.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m2.3.3.3.3.1" xref="alg1.l3.m2.3.3.3.3.1.cmml">​</mo><mi id="alg1.l3.m2.3.3.3.3.3" xref="alg1.l3.m2.3.3.3.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg1.l3.m2.3.3.2" xref="alg1.l3.m2.3.3.2.cmml">​</mo><mrow id="alg1.l3.m2.3.3.1.1" xref="alg1.l3.m2.3.3.1.1.1.cmml"><mo stretchy="false" id="alg1.l3.m2.3.3.1.1.2" xref="alg1.l3.m2.3.3.1.1.1.cmml">(</mo><mrow id="alg1.l3.m2.3.3.1.1.1" xref="alg1.l3.m2.3.3.1.1.1.cmml"><msup id="alg1.l3.m2.3.3.1.1.1.2" xref="alg1.l3.m2.3.3.1.1.1.2.cmml"><mi id="alg1.l3.m2.3.3.1.1.1.2.2" xref="alg1.l3.m2.3.3.1.1.1.2.2.cmml">p</mi><mrow id="alg1.l3.m2.1.1.1.3" xref="alg1.l3.m2.3.3.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l3.m2.1.1.1.3.1" xref="alg1.l3.m2.3.3.1.1.1.2.cmml">(</mo><mi id="alg1.l3.m2.1.1.1.1" xref="alg1.l3.m2.1.1.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l3.m2.1.1.1.3.2" xref="alg1.l3.m2.3.3.1.1.1.2.cmml">)</mo></mrow></msup><mo id="alg1.l3.m2.3.3.1.1.1.1" xref="alg1.l3.m2.3.3.1.1.1.1.cmml">∥</mo><msup id="alg1.l3.m2.3.3.1.1.1.3" xref="alg1.l3.m2.3.3.1.1.1.3.cmml"><mi id="alg1.l3.m2.3.3.1.1.1.3.2" xref="alg1.l3.m2.3.3.1.1.1.3.2.cmml">p</mi><mrow id="alg1.l3.m2.2.2.1.3" xref="alg1.l3.m2.3.3.1.1.1.3.cmml"><mo stretchy="false" id="alg1.l3.m2.2.2.1.3.1" xref="alg1.l3.m2.3.3.1.1.1.3.cmml">(</mo><mi id="alg1.l3.m2.2.2.1.1" xref="alg1.l3.m2.2.2.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l3.m2.2.2.1.3.2" xref="alg1.l3.m2.3.3.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo stretchy="false" id="alg1.l3.m2.3.3.1.1.3" xref="alg1.l3.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.3b"><apply id="alg1.l3.m2.3.3.cmml" xref="alg1.l3.m2.3.3"><times id="alg1.l3.m2.3.3.2.cmml" xref="alg1.l3.m2.3.3.2"></times><apply id="alg1.l3.m2.3.3.3.cmml" xref="alg1.l3.m2.3.3.3"><csymbol cd="ambiguous" id="alg1.l3.m2.3.3.3.1.cmml" xref="alg1.l3.m2.3.3.3">subscript</csymbol><ci id="alg1.l3.m2.3.3.3.2.cmml" xref="alg1.l3.m2.3.3.3.2">𝒟</ci><apply id="alg1.l3.m2.3.3.3.3.cmml" xref="alg1.l3.m2.3.3.3.3"><times id="alg1.l3.m2.3.3.3.3.1.cmml" xref="alg1.l3.m2.3.3.3.3.1"></times><ci id="alg1.l3.m2.3.3.3.3.2.cmml" xref="alg1.l3.m2.3.3.3.3.2">𝐾</ci><ci id="alg1.l3.m2.3.3.3.3.3.cmml" xref="alg1.l3.m2.3.3.3.3.3">𝐿</ci></apply></apply><apply id="alg1.l3.m2.3.3.1.1.1.cmml" xref="alg1.l3.m2.3.3.1.1"><csymbol cd="latexml" id="alg1.l3.m2.3.3.1.1.1.1.cmml" xref="alg1.l3.m2.3.3.1.1.1.1">conditional</csymbol><apply id="alg1.l3.m2.3.3.1.1.1.2.cmml" xref="alg1.l3.m2.3.3.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m2.3.3.1.1.1.2.1.cmml" xref="alg1.l3.m2.3.3.1.1.1.2">superscript</csymbol><ci id="alg1.l3.m2.3.3.1.1.1.2.2.cmml" xref="alg1.l3.m2.3.3.1.1.1.2.2">𝑝</ci><ci id="alg1.l3.m2.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1">𝑟</ci></apply><apply id="alg1.l3.m2.3.3.1.1.1.3.cmml" xref="alg1.l3.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l3.m2.3.3.1.1.1.3.1.cmml" xref="alg1.l3.m2.3.3.1.1.1.3">superscript</csymbol><ci id="alg1.l3.m2.3.3.1.1.1.3.2.cmml" xref="alg1.l3.m2.3.3.1.1.1.3.2">𝑝</ci><ci id="alg1.l3.m2.2.2.1.1.cmml" xref="alg1.l3.m2.2.2.1.1">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.3c">\mathcal{D}_{KL}(p^{(r)}\|p^{(c)})</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>  <span id="alg1.l4.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>  Cluster according to <math id="alg1.l5.m1.5" class="ltx_Math" alttext="(\mathcal{H}^{(c)},\mathcal{D}_{KL}(p^{(r)}\|p^{(c)}))" display="inline"><semantics id="alg1.l5.m1.5a"><mrow id="alg1.l5.m1.5.5.2" xref="alg1.l5.m1.5.5.3.cmml"><mo stretchy="false" id="alg1.l5.m1.5.5.2.3" xref="alg1.l5.m1.5.5.3.cmml">(</mo><msup id="alg1.l5.m1.4.4.1.1" xref="alg1.l5.m1.4.4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.4.4.1.1.2" xref="alg1.l5.m1.4.4.1.1.2.cmml">ℋ</mi><mrow id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.4.4.1.1.cmml"><mo stretchy="false" id="alg1.l5.m1.1.1.1.3.1" xref="alg1.l5.m1.4.4.1.1.cmml">(</mo><mi id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l5.m1.1.1.1.3.2" xref="alg1.l5.m1.4.4.1.1.cmml">)</mo></mrow></msup><mo id="alg1.l5.m1.5.5.2.4" xref="alg1.l5.m1.5.5.3.cmml">,</mo><mrow id="alg1.l5.m1.5.5.2.2" xref="alg1.l5.m1.5.5.2.2.cmml"><msub id="alg1.l5.m1.5.5.2.2.3" xref="alg1.l5.m1.5.5.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.5.5.2.2.3.2" xref="alg1.l5.m1.5.5.2.2.3.2.cmml">𝒟</mi><mrow id="alg1.l5.m1.5.5.2.2.3.3" xref="alg1.l5.m1.5.5.2.2.3.3.cmml"><mi id="alg1.l5.m1.5.5.2.2.3.3.2" xref="alg1.l5.m1.5.5.2.2.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.5.5.2.2.3.3.1" xref="alg1.l5.m1.5.5.2.2.3.3.1.cmml">​</mo><mi id="alg1.l5.m1.5.5.2.2.3.3.3" xref="alg1.l5.m1.5.5.2.2.3.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg1.l5.m1.5.5.2.2.2" xref="alg1.l5.m1.5.5.2.2.2.cmml">​</mo><mrow id="alg1.l5.m1.5.5.2.2.1.1" xref="alg1.l5.m1.5.5.2.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l5.m1.5.5.2.2.1.1.2" xref="alg1.l5.m1.5.5.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l5.m1.5.5.2.2.1.1.1" xref="alg1.l5.m1.5.5.2.2.1.1.1.cmml"><msup id="alg1.l5.m1.5.5.2.2.1.1.1.2" xref="alg1.l5.m1.5.5.2.2.1.1.1.2.cmml"><mi id="alg1.l5.m1.5.5.2.2.1.1.1.2.2" xref="alg1.l5.m1.5.5.2.2.1.1.1.2.2.cmml">p</mi><mrow id="alg1.l5.m1.2.2.1.3" xref="alg1.l5.m1.5.5.2.2.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l5.m1.2.2.1.3.1" xref="alg1.l5.m1.5.5.2.2.1.1.1.2.cmml">(</mo><mi id="alg1.l5.m1.2.2.1.1" xref="alg1.l5.m1.2.2.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l5.m1.2.2.1.3.2" xref="alg1.l5.m1.5.5.2.2.1.1.1.2.cmml">)</mo></mrow></msup><mo id="alg1.l5.m1.5.5.2.2.1.1.1.1" xref="alg1.l5.m1.5.5.2.2.1.1.1.1.cmml">∥</mo><msup id="alg1.l5.m1.5.5.2.2.1.1.1.3" xref="alg1.l5.m1.5.5.2.2.1.1.1.3.cmml"><mi id="alg1.l5.m1.5.5.2.2.1.1.1.3.2" xref="alg1.l5.m1.5.5.2.2.1.1.1.3.2.cmml">p</mi><mrow id="alg1.l5.m1.3.3.1.3" xref="alg1.l5.m1.5.5.2.2.1.1.1.3.cmml"><mo stretchy="false" id="alg1.l5.m1.3.3.1.3.1" xref="alg1.l5.m1.5.5.2.2.1.1.1.3.cmml">(</mo><mi id="alg1.l5.m1.3.3.1.1" xref="alg1.l5.m1.3.3.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l5.m1.3.3.1.3.2" xref="alg1.l5.m1.5.5.2.2.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo stretchy="false" id="alg1.l5.m1.5.5.2.2.1.1.3" xref="alg1.l5.m1.5.5.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l5.m1.5.5.2.5" xref="alg1.l5.m1.5.5.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.5b"><interval closure="open" id="alg1.l5.m1.5.5.3.cmml" xref="alg1.l5.m1.5.5.2"><apply id="alg1.l5.m1.4.4.1.1.cmml" xref="alg1.l5.m1.4.4.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.1.1.1.cmml" xref="alg1.l5.m1.4.4.1.1">superscript</csymbol><ci id="alg1.l5.m1.4.4.1.1.2.cmml" xref="alg1.l5.m1.4.4.1.1.2">ℋ</ci><ci id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">𝑐</ci></apply><apply id="alg1.l5.m1.5.5.2.2.cmml" xref="alg1.l5.m1.5.5.2.2"><times id="alg1.l5.m1.5.5.2.2.2.cmml" xref="alg1.l5.m1.5.5.2.2.2"></times><apply id="alg1.l5.m1.5.5.2.2.3.cmml" xref="alg1.l5.m1.5.5.2.2.3"><csymbol cd="ambiguous" id="alg1.l5.m1.5.5.2.2.3.1.cmml" xref="alg1.l5.m1.5.5.2.2.3">subscript</csymbol><ci id="alg1.l5.m1.5.5.2.2.3.2.cmml" xref="alg1.l5.m1.5.5.2.2.3.2">𝒟</ci><apply id="alg1.l5.m1.5.5.2.2.3.3.cmml" xref="alg1.l5.m1.5.5.2.2.3.3"><times id="alg1.l5.m1.5.5.2.2.3.3.1.cmml" xref="alg1.l5.m1.5.5.2.2.3.3.1"></times><ci id="alg1.l5.m1.5.5.2.2.3.3.2.cmml" xref="alg1.l5.m1.5.5.2.2.3.3.2">𝐾</ci><ci id="alg1.l5.m1.5.5.2.2.3.3.3.cmml" xref="alg1.l5.m1.5.5.2.2.3.3.3">𝐿</ci></apply></apply><apply id="alg1.l5.m1.5.5.2.2.1.1.1.cmml" xref="alg1.l5.m1.5.5.2.2.1.1"><csymbol cd="latexml" id="alg1.l5.m1.5.5.2.2.1.1.1.1.cmml" xref="alg1.l5.m1.5.5.2.2.1.1.1.1">conditional</csymbol><apply id="alg1.l5.m1.5.5.2.2.1.1.1.2.cmml" xref="alg1.l5.m1.5.5.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.5.5.2.2.1.1.1.2.1.cmml" xref="alg1.l5.m1.5.5.2.2.1.1.1.2">superscript</csymbol><ci id="alg1.l5.m1.5.5.2.2.1.1.1.2.2.cmml" xref="alg1.l5.m1.5.5.2.2.1.1.1.2.2">𝑝</ci><ci id="alg1.l5.m1.2.2.1.1.cmml" xref="alg1.l5.m1.2.2.1.1">𝑟</ci></apply><apply id="alg1.l5.m1.5.5.2.2.1.1.1.3.cmml" xref="alg1.l5.m1.5.5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.5.5.2.2.1.1.1.3.1.cmml" xref="alg1.l5.m1.5.5.2.2.1.1.1.3">superscript</csymbol><ci id="alg1.l5.m1.5.5.2.2.1.1.1.3.2.cmml" xref="alg1.l5.m1.5.5.2.2.1.1.1.3.2">𝑝</ci><ci id="alg1.l5.m1.3.3.1.1.cmml" xref="alg1.l5.m1.3.3.1.1">𝑐</ci></apply></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.5c">(\mathcal{H}^{(c)},\mathcal{D}_{KL}(p^{(r)}\|p^{(c)}))</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>  <span id="alg1.l6.1" class="ltx_text ltx_font_bold">for</span> each <math id="alg1.l6.m1.1" class="ltx_Math" alttext="m\in\mathcal{M}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">m</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><in id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></in><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑚</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">m\in\mathcal{M}</annotation></semantics></math> <span id="alg1.l6.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     Randomly select clients from each cluster according to the same ratio <math id="alg1.l7.m1.1" class="ltx_Math" alttext="1/\left|\mathcal{M}\right|" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.2" xref="alg1.l7.m1.1.2.cmml"><mn id="alg1.l7.m1.1.2.2" xref="alg1.l7.m1.1.2.2.cmml">1</mn><mo id="alg1.l7.m1.1.2.1" xref="alg1.l7.m1.1.2.1.cmml">/</mo><mrow id="alg1.l7.m1.1.2.3.2" xref="alg1.l7.m1.1.2.3.1.cmml"><mo id="alg1.l7.m1.1.2.3.2.1" xref="alg1.l7.m1.1.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">ℳ</mi><mo id="alg1.l7.m1.1.2.3.2.2" xref="alg1.l7.m1.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.2.cmml" xref="alg1.l7.m1.1.2"><divide id="alg1.l7.m1.1.2.1.cmml" xref="alg1.l7.m1.1.2.1"></divide><cn type="integer" id="alg1.l7.m1.1.2.2.cmml" xref="alg1.l7.m1.1.2.2">1</cn><apply id="alg1.l7.m1.1.2.3.1.cmml" xref="alg1.l7.m1.1.2.3.2"><abs id="alg1.l7.m1.1.2.3.1.1.cmml" xref="alg1.l7.m1.1.2.3.2.1"></abs><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">ℳ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">1/\left|\mathcal{M}\right|</annotation></semantics></math> and assign them to <span id="alg1.l7.1" class="ltx_text ltx_font_italic">m</span>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math id="alg1.l8.m1.1" class="ltx_Math" alttext="\mathcal{B}^{(m)}\leftarrow\emptyset" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.2" xref="alg1.l8.m1.1.2.cmml"><msup id="alg1.l8.m1.1.2.2" xref="alg1.l8.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.2.2.2" xref="alg1.l8.m1.1.2.2.2.cmml">ℬ</mi><mrow id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.1.2.2.cmml"><mo stretchy="false" id="alg1.l8.m1.1.1.1.3.1" xref="alg1.l8.m1.1.2.2.cmml">(</mo><mi id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg1.l8.m1.1.1.1.3.2" xref="alg1.l8.m1.1.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg1.l8.m1.1.2.1" xref="alg1.l8.m1.1.2.1.cmml">←</mo><mi mathvariant="normal" id="alg1.l8.m1.1.2.3" xref="alg1.l8.m1.1.2.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.2.cmml" xref="alg1.l8.m1.1.2"><ci id="alg1.l8.m1.1.2.1.cmml" xref="alg1.l8.m1.1.2.1">←</ci><apply id="alg1.l8.m1.1.2.2.cmml" xref="alg1.l8.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.2.1.cmml" xref="alg1.l8.m1.1.2.2">superscript</csymbol><ci id="alg1.l8.m1.1.2.2.2.cmml" xref="alg1.l8.m1.1.2.2.2">ℬ</ci><ci id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1">𝑚</ci></apply><emptyset id="alg1.l8.m1.1.2.3.cmml" xref="alg1.l8.m1.1.2.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\mathcal{B}^{(m)}\leftarrow\emptyset</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>  <span id="alg1.l9.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>  <math id="alg1.l10.m1.1" class="ltx_Math" alttext="\mathcal{M}^{t}\leftarrow" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msup id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">ℳ</mi><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">t</mi></msup><mo stretchy="false" id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">←</mo><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2">superscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">ℳ</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\mathcal{M}^{t}\leftarrow</annotation></semantics></math> (Randomly sampling mediators in <math id="alg1.l10.m2.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="alg1.l10.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">\mathcal{M}</annotation></semantics></math>)

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>  <span id="alg1.l11.1" class="ltx_text ltx_font_bold">for</span> each <math id="alg1.l11.m1.1" class="ltx_Math" alttext="m\in\mathcal{M}^{t}" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">m</mi><mo id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">∈</mo><msup id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">ℳ</mi><mi id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><in id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"></in><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝑚</ci><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3">superscript</csymbol><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">ℳ</ci><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">m\in\mathcal{M}^{t}</annotation></semantics></math> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>     <math id="alg1.l12.m1.1" class="ltx_Math" alttext="\mathcal{U}^{t}\leftarrow" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msup id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.1.2.2" xref="alg1.l12.m1.1.1.2.2.cmml">𝒰</mi><mi id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml">t</mi></msup><mo stretchy="false" id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">←</mo><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2">superscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2.2">𝒰</ci><ci id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\mathcal{U}^{t}\leftarrow</annotation></semantics></math> (Randomly sampling clients in <math id="alg1.l12.m2.1" class="ltx_Math" alttext="\mathcal{U}" display="inline"><semantics id="alg1.l12.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><ci id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">\mathcal{U}</annotation></semantics></math> with <math id="alg1.l12.m3.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="alg1.l12.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m3.1.1" xref="alg1.l12.m3.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.m3.1b"><ci id="alg1.l12.m3.1.1.cmml" xref="alg1.l12.m3.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m3.1c">\mathcal{P}</annotation></semantics></math>)

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span id="alg1.l13.1" class="ltx_text ltx_font_bold">for</span> each <math id="alg1.l13.m1.1" class="ltx_Math" alttext="c\in\mathcal{U}^{t}" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">c</mi><mo id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">∈</mo><msup id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">𝒰</mi><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><in id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></in><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">𝑐</ci><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3">superscript</csymbol><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">𝒰</ci><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">c\in\mathcal{U}^{t}</annotation></semantics></math> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>        Randomly sampling a mini-batch <math id="alg1.l14.m1.1" class="ltx_Math" alttext="X^{(c)}" display="inline"><semantics id="alg1.l14.m1.1a"><msup id="alg1.l14.m1.1.2" xref="alg1.l14.m1.1.2.cmml"><mi id="alg1.l14.m1.1.2.2" xref="alg1.l14.m1.1.2.2.cmml">X</mi><mrow id="alg1.l14.m1.1.1.1.3" xref="alg1.l14.m1.1.2.cmml"><mo stretchy="false" id="alg1.l14.m1.1.1.1.3.1" xref="alg1.l14.m1.1.2.cmml">(</mo><mi id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l14.m1.1.1.1.3.2" xref="alg1.l14.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.2.cmml" xref="alg1.l14.m1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.2.1.cmml" xref="alg1.l14.m1.1.2">superscript</csymbol><ci id="alg1.l14.m1.1.2.2.cmml" xref="alg1.l14.m1.1.2.2">𝑋</ci><ci id="alg1.l14.m1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">X^{(c)}</annotation></semantics></math> with <math id="alg1.l14.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg1.l14.m2.1a"><mi id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b"><ci id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.1c">S</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>        <math id="alg1.l15.m1.3" class="ltx_Math" alttext="\mathcal{O}^{(c)}\leftarrow W^{(c)}X^{(c)}" display="inline"><semantics id="alg1.l15.m1.3a"><mrow id="alg1.l15.m1.3.4" xref="alg1.l15.m1.3.4.cmml"><msup id="alg1.l15.m1.3.4.2" xref="alg1.l15.m1.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.3.4.2.2" xref="alg1.l15.m1.3.4.2.2.cmml">𝒪</mi><mrow id="alg1.l15.m1.1.1.1.3" xref="alg1.l15.m1.3.4.2.cmml"><mo stretchy="false" id="alg1.l15.m1.1.1.1.3.1" xref="alg1.l15.m1.3.4.2.cmml">(</mo><mi id="alg1.l15.m1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l15.m1.1.1.1.3.2" xref="alg1.l15.m1.3.4.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg1.l15.m1.3.4.1" xref="alg1.l15.m1.3.4.1.cmml">←</mo><mrow id="alg1.l15.m1.3.4.3" xref="alg1.l15.m1.3.4.3.cmml"><msup id="alg1.l15.m1.3.4.3.2" xref="alg1.l15.m1.3.4.3.2.cmml"><mi id="alg1.l15.m1.3.4.3.2.2" xref="alg1.l15.m1.3.4.3.2.2.cmml">W</mi><mrow id="alg1.l15.m1.2.2.1.3" xref="alg1.l15.m1.3.4.3.2.cmml"><mo stretchy="false" id="alg1.l15.m1.2.2.1.3.1" xref="alg1.l15.m1.3.4.3.2.cmml">(</mo><mi id="alg1.l15.m1.2.2.1.1" xref="alg1.l15.m1.2.2.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l15.m1.2.2.1.3.2" xref="alg1.l15.m1.3.4.3.2.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="alg1.l15.m1.3.4.3.1" xref="alg1.l15.m1.3.4.3.1.cmml">​</mo><msup id="alg1.l15.m1.3.4.3.3" xref="alg1.l15.m1.3.4.3.3.cmml"><mi id="alg1.l15.m1.3.4.3.3.2" xref="alg1.l15.m1.3.4.3.3.2.cmml">X</mi><mrow id="alg1.l15.m1.3.3.1.3" xref="alg1.l15.m1.3.4.3.3.cmml"><mo stretchy="false" id="alg1.l15.m1.3.3.1.3.1" xref="alg1.l15.m1.3.4.3.3.cmml">(</mo><mi id="alg1.l15.m1.3.3.1.1" xref="alg1.l15.m1.3.3.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l15.m1.3.3.1.3.2" xref="alg1.l15.m1.3.4.3.3.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.3b"><apply id="alg1.l15.m1.3.4.cmml" xref="alg1.l15.m1.3.4"><ci id="alg1.l15.m1.3.4.1.cmml" xref="alg1.l15.m1.3.4.1">←</ci><apply id="alg1.l15.m1.3.4.2.cmml" xref="alg1.l15.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l15.m1.3.4.2.1.cmml" xref="alg1.l15.m1.3.4.2">superscript</csymbol><ci id="alg1.l15.m1.3.4.2.2.cmml" xref="alg1.l15.m1.3.4.2.2">𝒪</ci><ci id="alg1.l15.m1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1">𝑐</ci></apply><apply id="alg1.l15.m1.3.4.3.cmml" xref="alg1.l15.m1.3.4.3"><times id="alg1.l15.m1.3.4.3.1.cmml" xref="alg1.l15.m1.3.4.3.1"></times><apply id="alg1.l15.m1.3.4.3.2.cmml" xref="alg1.l15.m1.3.4.3.2"><csymbol cd="ambiguous" id="alg1.l15.m1.3.4.3.2.1.cmml" xref="alg1.l15.m1.3.4.3.2">superscript</csymbol><ci id="alg1.l15.m1.3.4.3.2.2.cmml" xref="alg1.l15.m1.3.4.3.2.2">𝑊</ci><ci id="alg1.l15.m1.2.2.1.1.cmml" xref="alg1.l15.m1.2.2.1.1">𝑐</ci></apply><apply id="alg1.l15.m1.3.4.3.3.cmml" xref="alg1.l15.m1.3.4.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.3.4.3.3.1.cmml" xref="alg1.l15.m1.3.4.3.3">superscript</csymbol><ci id="alg1.l15.m1.3.4.3.3.2.cmml" xref="alg1.l15.m1.3.4.3.3.2">𝑋</ci><ci id="alg1.l15.m1.3.3.1.1.cmml" xref="alg1.l15.m1.3.3.1.1">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.3c">\mathcal{O}^{(c)}\leftarrow W^{(c)}X^{(c)}</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>        <math id="alg1.l16.m1.2" class="ltx_Math" alttext="k\leftarrow\lfloor\left|\mathcal{O}^{(c)}\right|*C\rfloor" display="inline"><semantics id="alg1.l16.m1.2a"><mrow id="alg1.l16.m1.2.2" xref="alg1.l16.m1.2.2.cmml"><mi id="alg1.l16.m1.2.2.3" xref="alg1.l16.m1.2.2.3.cmml">k</mi><mo stretchy="false" id="alg1.l16.m1.2.2.2" xref="alg1.l16.m1.2.2.2.cmml">←</mo><mrow id="alg1.l16.m1.2.2.1.1" xref="alg1.l16.m1.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l16.m1.2.2.1.1.2" xref="alg1.l16.m1.2.2.1.2.1.cmml">⌊</mo><mrow id="alg1.l16.m1.2.2.1.1.1" xref="alg1.l16.m1.2.2.1.1.1.cmml"><mrow id="alg1.l16.m1.2.2.1.1.1.1.1" xref="alg1.l16.m1.2.2.1.1.1.1.2.cmml"><mo id="alg1.l16.m1.2.2.1.1.1.1.1.2" xref="alg1.l16.m1.2.2.1.1.1.1.2.1.cmml">|</mo><msup id="alg1.l16.m1.2.2.1.1.1.1.1.1" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.2.cmml">𝒪</mi><mrow id="alg1.l16.m1.1.1.1.3" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l16.m1.1.1.1.3.1" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mi id="alg1.l16.m1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l16.m1.1.1.1.3.2" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo rspace="0.055em" id="alg1.l16.m1.2.2.1.1.1.1.1.3" xref="alg1.l16.m1.2.2.1.1.1.1.2.1.cmml">|</mo></mrow><mo rspace="0.222em" id="alg1.l16.m1.2.2.1.1.1.2" xref="alg1.l16.m1.2.2.1.1.1.2.cmml">∗</mo><mi id="alg1.l16.m1.2.2.1.1.1.3" xref="alg1.l16.m1.2.2.1.1.1.3.cmml">C</mi></mrow><mo stretchy="false" id="alg1.l16.m1.2.2.1.1.3" xref="alg1.l16.m1.2.2.1.2.1.cmml">⌋</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.2.cmml" xref="alg1.l16.m1.2.2"><ci id="alg1.l16.m1.2.2.2.cmml" xref="alg1.l16.m1.2.2.2">←</ci><ci id="alg1.l16.m1.2.2.3.cmml" xref="alg1.l16.m1.2.2.3">𝑘</ci><apply id="alg1.l16.m1.2.2.1.2.cmml" xref="alg1.l16.m1.2.2.1.1"><floor id="alg1.l16.m1.2.2.1.2.1.cmml" xref="alg1.l16.m1.2.2.1.1.2"></floor><apply id="alg1.l16.m1.2.2.1.1.1.cmml" xref="alg1.l16.m1.2.2.1.1.1"><times id="alg1.l16.m1.2.2.1.1.1.2.cmml" xref="alg1.l16.m1.2.2.1.1.1.2"></times><apply id="alg1.l16.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l16.m1.2.2.1.1.1.1.1"><abs id="alg1.l16.m1.2.2.1.1.1.1.2.1.cmml" xref="alg1.l16.m1.2.2.1.1.1.1.1.2"></abs><apply id="alg1.l16.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l16.m1.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.2">𝒪</ci><ci id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1">𝑐</ci></apply></apply><ci id="alg1.l16.m1.2.2.1.1.1.3.cmml" xref="alg1.l16.m1.2.2.1.1.1.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">k\leftarrow\lfloor\left|\mathcal{O}^{(c)}\right|*C\rfloor</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>        <math id="alg1.l17.m1.4" class="ltx_Math" alttext="\mathcal{B}^{(m)}\leftarrow\mathcal{B}^{(m)}\cup LF(\mathcal{O}^{(c)})" display="inline"><semantics id="alg1.l17.m1.4a"><mrow id="alg1.l17.m1.4.4" xref="alg1.l17.m1.4.4.cmml"><msup id="alg1.l17.m1.4.4.3" xref="alg1.l17.m1.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.4.4.3.2" xref="alg1.l17.m1.4.4.3.2.cmml">ℬ</mi><mrow id="alg1.l17.m1.1.1.1.3" xref="alg1.l17.m1.4.4.3.cmml"><mo stretchy="false" id="alg1.l17.m1.1.1.1.3.1" xref="alg1.l17.m1.4.4.3.cmml">(</mo><mi id="alg1.l17.m1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg1.l17.m1.1.1.1.3.2" xref="alg1.l17.m1.4.4.3.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg1.l17.m1.4.4.2" xref="alg1.l17.m1.4.4.2.cmml">←</mo><mrow id="alg1.l17.m1.4.4.1" xref="alg1.l17.m1.4.4.1.cmml"><msup id="alg1.l17.m1.4.4.1.3" xref="alg1.l17.m1.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.4.4.1.3.2" xref="alg1.l17.m1.4.4.1.3.2.cmml">ℬ</mi><mrow id="alg1.l17.m1.2.2.1.3" xref="alg1.l17.m1.4.4.1.3.cmml"><mo stretchy="false" id="alg1.l17.m1.2.2.1.3.1" xref="alg1.l17.m1.4.4.1.3.cmml">(</mo><mi id="alg1.l17.m1.2.2.1.1" xref="alg1.l17.m1.2.2.1.1.cmml">m</mi><mo stretchy="false" id="alg1.l17.m1.2.2.1.3.2" xref="alg1.l17.m1.4.4.1.3.cmml">)</mo></mrow></msup><mo id="alg1.l17.m1.4.4.1.2" xref="alg1.l17.m1.4.4.1.2.cmml">∪</mo><mrow id="alg1.l17.m1.4.4.1.1" xref="alg1.l17.m1.4.4.1.1.cmml"><mi id="alg1.l17.m1.4.4.1.1.3" xref="alg1.l17.m1.4.4.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.4.4.1.1.2" xref="alg1.l17.m1.4.4.1.1.2.cmml">​</mo><mi id="alg1.l17.m1.4.4.1.1.4" xref="alg1.l17.m1.4.4.1.1.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.4.4.1.1.2a" xref="alg1.l17.m1.4.4.1.1.2.cmml">​</mo><mrow id="alg1.l17.m1.4.4.1.1.1.1" xref="alg1.l17.m1.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l17.m1.4.4.1.1.1.1.2" xref="alg1.l17.m1.4.4.1.1.1.1.1.cmml">(</mo><msup id="alg1.l17.m1.4.4.1.1.1.1.1" xref="alg1.l17.m1.4.4.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.4.4.1.1.1.1.1.2" xref="alg1.l17.m1.4.4.1.1.1.1.1.2.cmml">𝒪</mi><mrow id="alg1.l17.m1.3.3.1.3" xref="alg1.l17.m1.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l17.m1.3.3.1.3.1" xref="alg1.l17.m1.4.4.1.1.1.1.1.cmml">(</mo><mi id="alg1.l17.m1.3.3.1.1" xref="alg1.l17.m1.3.3.1.1.cmml">c</mi><mo stretchy="false" id="alg1.l17.m1.3.3.1.3.2" xref="alg1.l17.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg1.l17.m1.4.4.1.1.1.1.3" xref="alg1.l17.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.4b"><apply id="alg1.l17.m1.4.4.cmml" xref="alg1.l17.m1.4.4"><ci id="alg1.l17.m1.4.4.2.cmml" xref="alg1.l17.m1.4.4.2">←</ci><apply id="alg1.l17.m1.4.4.3.cmml" xref="alg1.l17.m1.4.4.3"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.3.1.cmml" xref="alg1.l17.m1.4.4.3">superscript</csymbol><ci id="alg1.l17.m1.4.4.3.2.cmml" xref="alg1.l17.m1.4.4.3.2">ℬ</ci><ci id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1">𝑚</ci></apply><apply id="alg1.l17.m1.4.4.1.cmml" xref="alg1.l17.m1.4.4.1"><union id="alg1.l17.m1.4.4.1.2.cmml" xref="alg1.l17.m1.4.4.1.2"></union><apply id="alg1.l17.m1.4.4.1.3.cmml" xref="alg1.l17.m1.4.4.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.1.3.1.cmml" xref="alg1.l17.m1.4.4.1.3">superscript</csymbol><ci id="alg1.l17.m1.4.4.1.3.2.cmml" xref="alg1.l17.m1.4.4.1.3.2">ℬ</ci><ci id="alg1.l17.m1.2.2.1.1.cmml" xref="alg1.l17.m1.2.2.1.1">𝑚</ci></apply><apply id="alg1.l17.m1.4.4.1.1.cmml" xref="alg1.l17.m1.4.4.1.1"><times id="alg1.l17.m1.4.4.1.1.2.cmml" xref="alg1.l17.m1.4.4.1.1.2"></times><ci id="alg1.l17.m1.4.4.1.1.3.cmml" xref="alg1.l17.m1.4.4.1.1.3">𝐿</ci><ci id="alg1.l17.m1.4.4.1.1.4.cmml" xref="alg1.l17.m1.4.4.1.1.4">𝐹</ci><apply id="alg1.l17.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l17.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.4.4.1.1.1.1">superscript</csymbol><ci id="alg1.l17.m1.4.4.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.4.4.1.1.1.1.1.2">𝒪</ci><ci id="alg1.l17.m1.3.3.1.1.cmml" xref="alg1.l17.m1.3.3.1.1">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.4c">\mathcal{B}^{(m)}\leftarrow\mathcal{B}^{(m)}\cup LF(\mathcal{O}^{(c)})</annotation></semantics></math>

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>     <span id="alg1.l18.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l18.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>  <span id="alg1.l19.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>  <span id="alg1.l20.1" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l20.m1.1" class="ltx_Math" alttext="\mathcal{B}^{(m)}" display="inline"><semantics id="alg1.l20.m1.1a"><msup id="alg1.l20.m1.1.2" xref="alg1.l20.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l20.m1.1.2.2" xref="alg1.l20.m1.1.2.2.cmml">ℬ</mi><mrow id="alg1.l20.m1.1.1.1.3" xref="alg1.l20.m1.1.2.cmml"><mo stretchy="false" id="alg1.l20.m1.1.1.1.3.1" xref="alg1.l20.m1.1.2.cmml">(</mo><mi id="alg1.l20.m1.1.1.1.1" xref="alg1.l20.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg1.l20.m1.1.1.1.3.2" xref="alg1.l20.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.2.cmml" xref="alg1.l20.m1.1.2"><csymbol cd="ambiguous" id="alg1.l20.m1.1.2.1.cmml" xref="alg1.l20.m1.1.2">superscript</csymbol><ci id="alg1.l20.m1.1.2.2.cmml" xref="alg1.l20.m1.1.2.2">ℬ</ci><ci id="alg1.l20.m1.1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">\mathcal{B}^{(m)}</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Compression-Correction Mechanism</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.12" class="ltx_p">To reduce the communication overhead, each participating client compresses the extracted features through the lossy compressor in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> by:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_math_unparsed" alttext="LF(\mathcal{O})=U_{\mathcal{O}}[:,:k]\Sigma_{\mathcal{O}}[:k]V^{T}_{\mathcal{O}}[:k]" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1b"><mi id="S3.E3.m1.1.2">L</mi><mi id="S3.E3.m1.1.3">F</mi><mrow id="S3.E3.m1.1.4"><mo stretchy="false" id="S3.E3.m1.1.4.1">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1">𝒪</mi><mo stretchy="false" id="S3.E3.m1.1.4.2">)</mo></mrow><mo id="S3.E3.m1.1.5">=</mo><msub id="S3.E3.m1.1.6"><mi id="S3.E3.m1.1.6.2">U</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.6.3">𝒪</mi></msub><mrow id="S3.E3.m1.1.7"><mo stretchy="false" id="S3.E3.m1.1.7.1">[</mo><mo rspace="0em" id="S3.E3.m1.1.7.2">:</mo><mo id="S3.E3.m1.1.7.3">,</mo><mo rspace="0.278em" id="S3.E3.m1.1.7.4">:</mo><mi id="S3.E3.m1.1.7.5">k</mi><mo stretchy="false" id="S3.E3.m1.1.7.6">]</mo></mrow><msub id="S3.E3.m1.1.8"><mi mathvariant="normal" id="S3.E3.m1.1.8.2">Σ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.8.3">𝒪</mi></msub><mrow id="S3.E3.m1.1.9"><mo stretchy="false" id="S3.E3.m1.1.9.1">[</mo><mo rspace="0.278em" id="S3.E3.m1.1.9.2">:</mo><mi id="S3.E3.m1.1.9.3">k</mi><mo stretchy="false" id="S3.E3.m1.1.9.4">]</mo></mrow><msubsup id="S3.E3.m1.1.10"><mi id="S3.E3.m1.1.10.2.2">V</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.10.3">𝒪</mi><mi id="S3.E3.m1.1.10.2.3">T</mi></msubsup><mrow id="S3.E3.m1.1.11"><mo stretchy="false" id="S3.E3.m1.1.11.1">[</mo><mo rspace="0.278em" id="S3.E3.m1.1.11.2">:</mo><mi id="S3.E3.m1.1.11.3">k</mi><mo stretchy="false" id="S3.E3.m1.1.11.4">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E3.m1.1c">LF(\mathcal{O})=U_{\mathcal{O}}[:,:k]\Sigma_{\mathcal{O}}[:k]V^{T}_{\mathcal{O}}[:k]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.11" class="ltx_p">where <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{O}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">𝒪</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝒪</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\mathcal{O}</annotation></semantics></math> is feature matrix extracted by the shallow model, <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="U_{\mathcal{O}}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">U</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">𝒪</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝑈</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝒪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">U_{\mathcal{O}}</annotation></semantics></math>, <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="\Sigma_{\mathcal{O}}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><msub id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">Σ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">𝒪</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">Σ</ci><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝒪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">\Sigma_{\mathcal{O}}</annotation></semantics></math> and <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="V^{T}_{\mathcal{O}}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><msubsup id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2.2" xref="S3.SS4.p1.4.m4.1.1.2.2.cmml">V</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml">𝒪</mi><mi id="S3.SS4.p1.4.m4.1.1.2.3" xref="S3.SS4.p1.4.m4.1.1.2.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">subscript</csymbol><apply id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.2.1.cmml" xref="S3.SS4.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2.2">𝑉</ci><ci id="S3.SS4.p1.4.m4.1.1.2.3.cmml" xref="S3.SS4.p1.4.m4.1.1.2.3">𝑇</ci></apply><ci id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3">𝒪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">V^{T}_{\mathcal{O}}</annotation></semantics></math> are the results of singular value decomposition (SVD) respectively, <math id="S3.SS4.p1.5.m5.1" class="ltx_math_unparsed" alttext="U_{\mathcal{O}}[:,:k]" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><mrow id="S3.SS4.p1.5.m5.1b"><msub id="S3.SS4.p1.5.m5.1.1"><mi id="S3.SS4.p1.5.m5.1.1.2">U</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.5.m5.1.1.3">𝒪</mi></msub><mrow id="S3.SS4.p1.5.m5.1.2"><mo stretchy="false" id="S3.SS4.p1.5.m5.1.2.1">[</mo><mo rspace="0em" id="S3.SS4.p1.5.m5.1.2.2">:</mo><mo id="S3.SS4.p1.5.m5.1.2.3">,</mo><mo rspace="0.278em" id="S3.SS4.p1.5.m5.1.2.4">:</mo><mi id="S3.SS4.p1.5.m5.1.2.5">k</mi><mo stretchy="false" id="S3.SS4.p1.5.m5.1.2.6">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">U_{\mathcal{O}}[:,:k]</annotation></semantics></math>, <math id="S3.SS4.p1.6.m6.1" class="ltx_math_unparsed" alttext="\Sigma_{\mathcal{O}}[:k]" display="inline"><semantics id="S3.SS4.p1.6.m6.1a"><mrow id="S3.SS4.p1.6.m6.1b"><msub id="S3.SS4.p1.6.m6.1.1"><mi mathvariant="normal" id="S3.SS4.p1.6.m6.1.1.2">Σ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.6.m6.1.1.3">𝒪</mi></msub><mrow id="S3.SS4.p1.6.m6.1.2"><mo stretchy="false" id="S3.SS4.p1.6.m6.1.2.1">[</mo><mo rspace="0.278em" id="S3.SS4.p1.6.m6.1.2.2">:</mo><mi id="S3.SS4.p1.6.m6.1.2.3">k</mi><mo stretchy="false" id="S3.SS4.p1.6.m6.1.2.4">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">\Sigma_{\mathcal{O}}[:k]</annotation></semantics></math> and <math id="S3.SS4.p1.7.m7.1" class="ltx_math_unparsed" alttext="V_{\mathcal{O}}[:k]" display="inline"><semantics id="S3.SS4.p1.7.m7.1a"><mrow id="S3.SS4.p1.7.m7.1b"><msub id="S3.SS4.p1.7.m7.1.1"><mi id="S3.SS4.p1.7.m7.1.1.2">V</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.7.m7.1.1.3">𝒪</mi></msub><mrow id="S3.SS4.p1.7.m7.1.2"><mo stretchy="false" id="S3.SS4.p1.7.m7.1.2.1">[</mo><mo rspace="0.278em" id="S3.SS4.p1.7.m7.1.2.2">:</mo><mi id="S3.SS4.p1.7.m7.1.2.3">k</mi><mo stretchy="false" id="S3.SS4.p1.7.m7.1.2.4">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">V_{\mathcal{O}}[:k]</annotation></semantics></math> represent the first <math id="S3.SS4.p1.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS4.p1.8.m8.1a"><mi id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><ci id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">k</annotation></semantics></math> columns of <math id="S3.SS4.p1.9.m9.1" class="ltx_Math" alttext="U_{\mathcal{O}}" display="inline"><semantics id="S3.SS4.p1.9.m9.1a"><msub id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml"><mi id="S3.SS4.p1.9.m9.1.1.2" xref="S3.SS4.p1.9.m9.1.1.2.cmml">U</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.9.m9.1.1.3" xref="S3.SS4.p1.9.m9.1.1.3.cmml">𝒪</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.1b"><apply id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2">𝑈</ci><ci id="S3.SS4.p1.9.m9.1.1.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3">𝒪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.1c">U_{\mathcal{O}}</annotation></semantics></math>, <math id="S3.SS4.p1.10.m10.1" class="ltx_Math" alttext="\Sigma_{\mathcal{O}}" display="inline"><semantics id="S3.SS4.p1.10.m10.1a"><msub id="S3.SS4.p1.10.m10.1.1" xref="S3.SS4.p1.10.m10.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p1.10.m10.1.1.2" xref="S3.SS4.p1.10.m10.1.1.2.cmml">Σ</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.10.m10.1.1.3" xref="S3.SS4.p1.10.m10.1.1.3.cmml">𝒪</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.1b"><apply id="S3.SS4.p1.10.m10.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS4.p1.10.m10.1.1.2.cmml" xref="S3.SS4.p1.10.m10.1.1.2">Σ</ci><ci id="S3.SS4.p1.10.m10.1.1.3.cmml" xref="S3.SS4.p1.10.m10.1.1.3">𝒪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.1c">\Sigma_{\mathcal{O}}</annotation></semantics></math> and <math id="S3.SS4.p1.11.m11.1" class="ltx_Math" alttext="V_{\mathcal{O}}" display="inline"><semantics id="S3.SS4.p1.11.m11.1a"><msub id="S3.SS4.p1.11.m11.1.1" xref="S3.SS4.p1.11.m11.1.1.cmml"><mi id="S3.SS4.p1.11.m11.1.1.2" xref="S3.SS4.p1.11.m11.1.1.2.cmml">V</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.11.m11.1.1.3" xref="S3.SS4.p1.11.m11.1.1.3.cmml">𝒪</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m11.1b"><apply id="S3.SS4.p1.11.m11.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS4.p1.11.m11.1.1.2.cmml" xref="S3.SS4.p1.11.m11.1.1.2">𝑉</ci><ci id="S3.SS4.p1.11.m11.1.1.3.cmml" xref="S3.SS4.p1.11.m11.1.1.3">𝒪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m11.1c">V_{\mathcal{O}}</annotation></semantics></math> respectively. In this way, the feature matrix can be changed to a low-rank matrix that can be expressed by as the product of two relatively small matrices, thus reducing the communication overhead.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.3" class="ltx_p">For the sake of clarification, let us introduce some new representations:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.7" class="ltx_Math" alttext="\begin{array}[]{l}\mathcal{O}=W^{(c)}X^{(c)}\\
\mathcal{B}=LF(\mathcal{O})\\
\mathcal{A}=W^{(m)}\mathcal{B}\\
\mathcal{L}=\mathrm{E}[\ell(\mathcal{A},y)]\end{array}" display="block"><semantics id="S3.E4.m1.7a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml"><mtr id="S3.E4.m1.7.7a" xref="S3.E4.m1.7.7.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.7.7b" xref="S3.E4.m1.7.7.cmml"><mrow id="S3.E4.m1.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.2.2.2.2.4" xref="S3.E4.m1.2.2.2.2.2.4.cmml">𝒪</mi><mo id="S3.E4.m1.2.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.3.cmml">=</mo><mrow id="S3.E4.m1.2.2.2.2.2.5" xref="S3.E4.m1.2.2.2.2.2.5.cmml"><msup id="S3.E4.m1.2.2.2.2.2.5.2" xref="S3.E4.m1.2.2.2.2.2.5.2.cmml"><mi id="S3.E4.m1.2.2.2.2.2.5.2.2" xref="S3.E4.m1.2.2.2.2.2.5.2.2.cmml">W</mi><mrow id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.2.2.2.5.2.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.2.2.2.2.2.5.2.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.2.2.2.2.2.5.2.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.5.1" xref="S3.E4.m1.2.2.2.2.2.5.1.cmml">​</mo><msup id="S3.E4.m1.2.2.2.2.2.5.3" xref="S3.E4.m1.2.2.2.2.2.5.3.cmml"><mi id="S3.E4.m1.2.2.2.2.2.5.3.2" xref="S3.E4.m1.2.2.2.2.2.5.3.2.cmml">X</mi><mrow id="S3.E4.m1.2.2.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.2.2.5.3.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.2.2.2.2.1.3.1" xref="S3.E4.m1.2.2.2.2.2.5.3.cmml">(</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.2.2.1.1.cmml">c</mi><mo stretchy="false" id="S3.E4.m1.2.2.2.2.2.2.1.3.2" xref="S3.E4.m1.2.2.2.2.2.5.3.cmml">)</mo></mrow></msup></mrow></mrow></mtd></mtr><mtr id="S3.E4.m1.7.7c" xref="S3.E4.m1.7.7.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.7.7d" xref="S3.E4.m1.7.7.cmml"><mrow id="S3.E4.m1.3.3.3.1.1" xref="S3.E4.m1.3.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.3.1.1.3" xref="S3.E4.m1.3.3.3.1.1.3.cmml">ℬ</mi><mo id="S3.E4.m1.3.3.3.1.1.2" xref="S3.E4.m1.3.3.3.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.3.3.3.1.1.4" xref="S3.E4.m1.3.3.3.1.1.4.cmml"><mi id="S3.E4.m1.3.3.3.1.1.4.2" xref="S3.E4.m1.3.3.3.1.1.4.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.1.1.4.1" xref="S3.E4.m1.3.3.3.1.1.4.1.cmml">​</mo><mi id="S3.E4.m1.3.3.3.1.1.4.3" xref="S3.E4.m1.3.3.3.1.1.4.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.1.1.4.1a" xref="S3.E4.m1.3.3.3.1.1.4.1.cmml">​</mo><mrow id="S3.E4.m1.3.3.3.1.1.4.4.2" xref="S3.E4.m1.3.3.3.1.1.4.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.3.1.1.4.4.2.1" xref="S3.E4.m1.3.3.3.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.3.1.1.1" xref="S3.E4.m1.3.3.3.1.1.1.cmml">𝒪</mi><mo stretchy="false" id="S3.E4.m1.3.3.3.1.1.4.4.2.2" xref="S3.E4.m1.3.3.3.1.1.4.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E4.m1.7.7e" xref="S3.E4.m1.7.7.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.7.7f" xref="S3.E4.m1.7.7.cmml"><mrow id="S3.E4.m1.4.4.4.1.1" xref="S3.E4.m1.4.4.4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.4.4.1.1.3" xref="S3.E4.m1.4.4.4.1.1.3.cmml">𝒜</mi><mo id="S3.E4.m1.4.4.4.1.1.2" xref="S3.E4.m1.4.4.4.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.4.4.4.1.1.4" xref="S3.E4.m1.4.4.4.1.1.4.cmml"><msup id="S3.E4.m1.4.4.4.1.1.4.2" xref="S3.E4.m1.4.4.4.1.1.4.2.cmml"><mi id="S3.E4.m1.4.4.4.1.1.4.2.2" xref="S3.E4.m1.4.4.4.1.1.4.2.2.cmml">W</mi><mrow id="S3.E4.m1.4.4.4.1.1.1.1.3" xref="S3.E4.m1.4.4.4.1.1.4.2.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.4.1.1.1.1.3.1" xref="S3.E4.m1.4.4.4.1.1.4.2.cmml">(</mo><mi id="S3.E4.m1.4.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.4.1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.E4.m1.4.4.4.1.1.1.1.3.2" xref="S3.E4.m1.4.4.4.1.1.4.2.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.1.1.4.1" xref="S3.E4.m1.4.4.4.1.1.4.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.4.4.1.1.4.3" xref="S3.E4.m1.4.4.4.1.1.4.3.cmml">ℬ</mi></mrow></mrow></mtd></mtr><mtr id="S3.E4.m1.7.7g" xref="S3.E4.m1.7.7.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.7.7h" xref="S3.E4.m1.7.7.cmml"><mrow id="S3.E4.m1.7.7.7.3.3" xref="S3.E4.m1.7.7.7.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.7.7.7.3.3.5" xref="S3.E4.m1.7.7.7.3.3.5.cmml">ℒ</mi><mo id="S3.E4.m1.7.7.7.3.3.4" xref="S3.E4.m1.7.7.7.3.3.4.cmml">=</mo><mrow id="S3.E4.m1.7.7.7.3.3.3" xref="S3.E4.m1.7.7.7.3.3.3.cmml"><mi mathvariant="normal" id="S3.E4.m1.7.7.7.3.3.3.3" xref="S3.E4.m1.7.7.7.3.3.3.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.7.3.3.3.2" xref="S3.E4.m1.7.7.7.3.3.3.2.cmml">​</mo><mrow id="S3.E4.m1.7.7.7.3.3.3.1.1" xref="S3.E4.m1.7.7.7.3.3.3.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.7.7.7.3.3.3.1.1.2" xref="S3.E4.m1.7.7.7.3.3.3.1.2.1.cmml">[</mo><mrow id="S3.E4.m1.7.7.7.3.3.3.1.1.1" xref="S3.E4.m1.7.7.7.3.3.3.1.1.1.cmml"><mi mathvariant="normal" id="S3.E4.m1.7.7.7.3.3.3.1.1.1.2" xref="S3.E4.m1.7.7.7.3.3.3.1.1.1.2.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.7.3.3.3.1.1.1.1" xref="S3.E4.m1.7.7.7.3.3.3.1.1.1.1.cmml">​</mo><mrow id="S3.E4.m1.7.7.7.3.3.3.1.1.1.3.2" xref="S3.E4.m1.7.7.7.3.3.3.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E4.m1.7.7.7.3.3.3.1.1.1.3.2.1" xref="S3.E4.m1.7.7.7.3.3.3.1.1.1.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.5.5.5.1.1.1" xref="S3.E4.m1.5.5.5.1.1.1.cmml">𝒜</mi><mo id="S3.E4.m1.7.7.7.3.3.3.1.1.1.3.2.2" xref="S3.E4.m1.7.7.7.3.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.E4.m1.6.6.6.2.2.2" xref="S3.E4.m1.6.6.6.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E4.m1.7.7.7.3.3.3.1.1.1.3.2.3" xref="S3.E4.m1.7.7.7.3.3.3.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.7.7.7.3.3.3.1.1.3" xref="S3.E4.m1.7.7.7.3.3.3.1.2.1.cmml">]</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.7b"><matrix id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7"><matrixrow id="S3.E4.m1.7.7a.cmml" xref="S3.E4.m1.7.7"><apply id="S3.E4.m1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2"><eq id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.3"></eq><ci id="S3.E4.m1.2.2.2.2.2.4.cmml" xref="S3.E4.m1.2.2.2.2.2.4">𝒪</ci><apply id="S3.E4.m1.2.2.2.2.2.5.cmml" xref="S3.E4.m1.2.2.2.2.2.5"><times id="S3.E4.m1.2.2.2.2.2.5.1.cmml" xref="S3.E4.m1.2.2.2.2.2.5.1"></times><apply id="S3.E4.m1.2.2.2.2.2.5.2.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.5.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2">superscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.5.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.2">𝑊</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1">𝑐</ci></apply><apply id="S3.E4.m1.2.2.2.2.2.5.3.cmml" xref="S3.E4.m1.2.2.2.2.2.5.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.5.3.1.cmml" xref="S3.E4.m1.2.2.2.2.2.5.3">superscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.5.3.2.cmml" xref="S3.E4.m1.2.2.2.2.2.5.3.2">𝑋</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.1">𝑐</ci></apply></apply></apply></matrixrow><matrixrow id="S3.E4.m1.7.7b.cmml" xref="S3.E4.m1.7.7"><apply id="S3.E4.m1.3.3.3.1.1.cmml" xref="S3.E4.m1.3.3.3.1.1"><eq id="S3.E4.m1.3.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.3.1.1.2"></eq><ci id="S3.E4.m1.3.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.3.1.1.3">ℬ</ci><apply id="S3.E4.m1.3.3.3.1.1.4.cmml" xref="S3.E4.m1.3.3.3.1.1.4"><times id="S3.E4.m1.3.3.3.1.1.4.1.cmml" xref="S3.E4.m1.3.3.3.1.1.4.1"></times><ci id="S3.E4.m1.3.3.3.1.1.4.2.cmml" xref="S3.E4.m1.3.3.3.1.1.4.2">𝐿</ci><ci id="S3.E4.m1.3.3.3.1.1.4.3.cmml" xref="S3.E4.m1.3.3.3.1.1.4.3">𝐹</ci><ci id="S3.E4.m1.3.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.3.1.1.1">𝒪</ci></apply></apply></matrixrow><matrixrow id="S3.E4.m1.7.7c.cmml" xref="S3.E4.m1.7.7"><apply id="S3.E4.m1.4.4.4.1.1.cmml" xref="S3.E4.m1.4.4.4.1.1"><eq id="S3.E4.m1.4.4.4.1.1.2.cmml" xref="S3.E4.m1.4.4.4.1.1.2"></eq><ci id="S3.E4.m1.4.4.4.1.1.3.cmml" xref="S3.E4.m1.4.4.4.1.1.3">𝒜</ci><apply id="S3.E4.m1.4.4.4.1.1.4.cmml" xref="S3.E4.m1.4.4.4.1.1.4"><times id="S3.E4.m1.4.4.4.1.1.4.1.cmml" xref="S3.E4.m1.4.4.4.1.1.4.1"></times><apply id="S3.E4.m1.4.4.4.1.1.4.2.cmml" xref="S3.E4.m1.4.4.4.1.1.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.1.1.4.2.1.cmml" xref="S3.E4.m1.4.4.4.1.1.4.2">superscript</csymbol><ci id="S3.E4.m1.4.4.4.1.1.4.2.2.cmml" xref="S3.E4.m1.4.4.4.1.1.4.2.2">𝑊</ci><ci id="S3.E4.m1.4.4.4.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.4.1.1.1.1.1">𝑚</ci></apply><ci id="S3.E4.m1.4.4.4.1.1.4.3.cmml" xref="S3.E4.m1.4.4.4.1.1.4.3">ℬ</ci></apply></apply></matrixrow><matrixrow id="S3.E4.m1.7.7d.cmml" xref="S3.E4.m1.7.7"><apply id="S3.E4.m1.7.7.7.3.3.cmml" xref="S3.E4.m1.7.7.7.3.3"><eq id="S3.E4.m1.7.7.7.3.3.4.cmml" xref="S3.E4.m1.7.7.7.3.3.4"></eq><ci id="S3.E4.m1.7.7.7.3.3.5.cmml" xref="S3.E4.m1.7.7.7.3.3.5">ℒ</ci><apply id="S3.E4.m1.7.7.7.3.3.3.cmml" xref="S3.E4.m1.7.7.7.3.3.3"><times id="S3.E4.m1.7.7.7.3.3.3.2.cmml" xref="S3.E4.m1.7.7.7.3.3.3.2"></times><ci id="S3.E4.m1.7.7.7.3.3.3.3.cmml" xref="S3.E4.m1.7.7.7.3.3.3.3">E</ci><apply id="S3.E4.m1.7.7.7.3.3.3.1.2.cmml" xref="S3.E4.m1.7.7.7.3.3.3.1.1"><csymbol cd="latexml" id="S3.E4.m1.7.7.7.3.3.3.1.2.1.cmml" xref="S3.E4.m1.7.7.7.3.3.3.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.7.7.7.3.3.3.1.1.1.cmml" xref="S3.E4.m1.7.7.7.3.3.3.1.1.1"><times id="S3.E4.m1.7.7.7.3.3.3.1.1.1.1.cmml" xref="S3.E4.m1.7.7.7.3.3.3.1.1.1.1"></times><ci id="S3.E4.m1.7.7.7.3.3.3.1.1.1.2.cmml" xref="S3.E4.m1.7.7.7.3.3.3.1.1.1.2">ℓ</ci><interval closure="open" id="S3.E4.m1.7.7.7.3.3.3.1.1.1.3.1.cmml" xref="S3.E4.m1.7.7.7.3.3.3.1.1.1.3.2"><ci id="S3.E4.m1.5.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.5.1.1.1">𝒜</ci><ci id="S3.E4.m1.6.6.6.2.2.2.cmml" xref="S3.E4.m1.6.6.6.2.2.2">𝑦</ci></interval></apply></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.7c">\begin{array}[]{l}\mathcal{O}=W^{(c)}X^{(c)}\\
\mathcal{B}=LF(\mathcal{O})\\
\mathcal{A}=W^{(m)}\mathcal{B}\\
\mathcal{L}=\mathrm{E}[\ell(\mathcal{A},y)]\end{array}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p2.2" class="ltx_p">When updating <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="W^{(c)}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><msup id="S3.SS4.p2.1.m1.1.2" xref="S3.SS4.p2.1.m1.1.2.cmml"><mi id="S3.SS4.p2.1.m1.1.2.2" xref="S3.SS4.p2.1.m1.1.2.2.cmml">W</mi><mrow id="S3.SS4.p2.1.m1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p2.1.m1.1.1.1.3.1" xref="S3.SS4.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS4.p2.1.m1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p2.1.m1.1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.1.2">superscript</csymbol><ci id="S3.SS4.p2.1.m1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.1.2.2">𝑊</ci><ci id="S3.SS4.p2.1.m1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">W^{(c)}</annotation></semantics></math>, we should compute <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="dW^{(c)}" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><mrow id="S3.SS4.p2.2.m2.1.2" xref="S3.SS4.p2.2.m2.1.2.cmml"><mi id="S3.SS4.p2.2.m2.1.2.2" xref="S3.SS4.p2.2.m2.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.2.m2.1.2.1" xref="S3.SS4.p2.2.m2.1.2.1.cmml">​</mo><msup id="S3.SS4.p2.2.m2.1.2.3" xref="S3.SS4.p2.2.m2.1.2.3.cmml"><mi id="S3.SS4.p2.2.m2.1.2.3.2" xref="S3.SS4.p2.2.m2.1.2.3.2.cmml">W</mi><mrow id="S3.SS4.p2.2.m2.1.1.1.3" xref="S3.SS4.p2.2.m2.1.2.3.cmml"><mo stretchy="false" id="S3.SS4.p2.2.m2.1.1.1.3.1" xref="S3.SS4.p2.2.m2.1.2.3.cmml">(</mo><mi id="S3.SS4.p2.2.m2.1.1.1.1" xref="S3.SS4.p2.2.m2.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p2.2.m2.1.1.1.3.2" xref="S3.SS4.p2.2.m2.1.2.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.2.cmml" xref="S3.SS4.p2.2.m2.1.2"><times id="S3.SS4.p2.2.m2.1.2.1.cmml" xref="S3.SS4.p2.2.m2.1.2.1"></times><ci id="S3.SS4.p2.2.m2.1.2.2.cmml" xref="S3.SS4.p2.2.m2.1.2.2">𝑑</ci><apply id="S3.SS4.p2.2.m2.1.2.3.cmml" xref="S3.SS4.p2.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.2.3.1.cmml" xref="S3.SS4.p2.2.m2.1.2.3">superscript</csymbol><ci id="S3.SS4.p2.2.m2.1.2.3.2.cmml" xref="S3.SS4.p2.2.m2.1.2.3.2">𝑊</ci><ci id="S3.SS4.p2.2.m2.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">dW^{(c)}</annotation></semantics></math> as follows according to the chain rule:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.2" class="ltx_Math" alttext="dW^{(c)}=\frac{\partial\mathcal{L}}{\partial\mathcal{A}}\cdot\frac{\partial\mathcal{A}}{\partial\mathcal{B}}\cdot\frac{\partial\mathcal{B}}{\partial W^{(c)}}" display="block"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.3" xref="S3.E5.m1.2.3.cmml"><mrow id="S3.E5.m1.2.3.2" xref="S3.E5.m1.2.3.2.cmml"><mi id="S3.E5.m1.2.3.2.2" xref="S3.E5.m1.2.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.3.2.1" xref="S3.E5.m1.2.3.2.1.cmml">​</mo><msup id="S3.E5.m1.2.3.2.3" xref="S3.E5.m1.2.3.2.3.cmml"><mi id="S3.E5.m1.2.3.2.3.2" xref="S3.E5.m1.2.3.2.3.2.cmml">W</mi><mrow id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.2.3.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.3.1" xref="S3.E5.m1.2.3.2.3.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E5.m1.1.1.1.3.2" xref="S3.E5.m1.2.3.2.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.E5.m1.2.3.1" xref="S3.E5.m1.2.3.1.cmml">=</mo><mrow id="S3.E5.m1.2.3.3" xref="S3.E5.m1.2.3.3.cmml"><mfrac id="S3.E5.m1.2.3.3.2" xref="S3.E5.m1.2.3.3.2.cmml"><mrow id="S3.E5.m1.2.3.3.2.2" xref="S3.E5.m1.2.3.3.2.2.cmml"><mo rspace="0em" id="S3.E5.m1.2.3.3.2.2.1" xref="S3.E5.m1.2.3.3.2.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.3.3.2.2.2" xref="S3.E5.m1.2.3.3.2.2.2.cmml">ℒ</mi></mrow><mrow id="S3.E5.m1.2.3.3.2.3" xref="S3.E5.m1.2.3.3.2.3.cmml"><mo rspace="0em" id="S3.E5.m1.2.3.3.2.3.1" xref="S3.E5.m1.2.3.3.2.3.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.3.3.2.3.2" xref="S3.E5.m1.2.3.3.2.3.2.cmml">𝒜</mi></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.2.3.3.1" xref="S3.E5.m1.2.3.3.1.cmml">⋅</mo><mfrac id="S3.E5.m1.2.3.3.3" xref="S3.E5.m1.2.3.3.3.cmml"><mrow id="S3.E5.m1.2.3.3.3.2" xref="S3.E5.m1.2.3.3.3.2.cmml"><mo rspace="0em" id="S3.E5.m1.2.3.3.3.2.1" xref="S3.E5.m1.2.3.3.3.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.3.3.3.2.2" xref="S3.E5.m1.2.3.3.3.2.2.cmml">𝒜</mi></mrow><mrow id="S3.E5.m1.2.3.3.3.3" xref="S3.E5.m1.2.3.3.3.3.cmml"><mo rspace="0em" id="S3.E5.m1.2.3.3.3.3.1" xref="S3.E5.m1.2.3.3.3.3.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.3.3.3.3.2" xref="S3.E5.m1.2.3.3.3.3.2.cmml">ℬ</mi></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.2.3.3.1a" xref="S3.E5.m1.2.3.3.1.cmml">⋅</mo><mfrac id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><mrow id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml"><mo rspace="0em" id="S3.E5.m1.2.2.3.1" xref="S3.E5.m1.2.2.3.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.3.2" xref="S3.E5.m1.2.2.3.2.cmml">ℬ</mi></mrow><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.cmml"><mo rspace="0em" id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.2.cmml">∂</mo><msup id="S3.E5.m1.2.2.1.3" xref="S3.E5.m1.2.2.1.3.cmml"><mi id="S3.E5.m1.2.2.1.3.2" xref="S3.E5.m1.2.2.1.3.2.cmml">W</mi><mrow id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.3.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.3.1" xref="S3.E5.m1.2.2.1.3.cmml">(</mo><mi id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.3.2" xref="S3.E5.m1.2.2.1.3.cmml">)</mo></mrow></msup></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.3.cmml" xref="S3.E5.m1.2.3"><eq id="S3.E5.m1.2.3.1.cmml" xref="S3.E5.m1.2.3.1"></eq><apply id="S3.E5.m1.2.3.2.cmml" xref="S3.E5.m1.2.3.2"><times id="S3.E5.m1.2.3.2.1.cmml" xref="S3.E5.m1.2.3.2.1"></times><ci id="S3.E5.m1.2.3.2.2.cmml" xref="S3.E5.m1.2.3.2.2">𝑑</ci><apply id="S3.E5.m1.2.3.2.3.cmml" xref="S3.E5.m1.2.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.3.2.3.1.cmml" xref="S3.E5.m1.2.3.2.3">superscript</csymbol><ci id="S3.E5.m1.2.3.2.3.2.cmml" xref="S3.E5.m1.2.3.2.3.2">𝑊</ci><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑐</ci></apply></apply><apply id="S3.E5.m1.2.3.3.cmml" xref="S3.E5.m1.2.3.3"><ci id="S3.E5.m1.2.3.3.1.cmml" xref="S3.E5.m1.2.3.3.1">⋅</ci><apply id="S3.E5.m1.2.3.3.2.cmml" xref="S3.E5.m1.2.3.3.2"><divide id="S3.E5.m1.2.3.3.2.1.cmml" xref="S3.E5.m1.2.3.3.2"></divide><apply id="S3.E5.m1.2.3.3.2.2.cmml" xref="S3.E5.m1.2.3.3.2.2"><partialdiff id="S3.E5.m1.2.3.3.2.2.1.cmml" xref="S3.E5.m1.2.3.3.2.2.1"></partialdiff><ci id="S3.E5.m1.2.3.3.2.2.2.cmml" xref="S3.E5.m1.2.3.3.2.2.2">ℒ</ci></apply><apply id="S3.E5.m1.2.3.3.2.3.cmml" xref="S3.E5.m1.2.3.3.2.3"><partialdiff id="S3.E5.m1.2.3.3.2.3.1.cmml" xref="S3.E5.m1.2.3.3.2.3.1"></partialdiff><ci id="S3.E5.m1.2.3.3.2.3.2.cmml" xref="S3.E5.m1.2.3.3.2.3.2">𝒜</ci></apply></apply><apply id="S3.E5.m1.2.3.3.3.cmml" xref="S3.E5.m1.2.3.3.3"><divide id="S3.E5.m1.2.3.3.3.1.cmml" xref="S3.E5.m1.2.3.3.3"></divide><apply id="S3.E5.m1.2.3.3.3.2.cmml" xref="S3.E5.m1.2.3.3.3.2"><partialdiff id="S3.E5.m1.2.3.3.3.2.1.cmml" xref="S3.E5.m1.2.3.3.3.2.1"></partialdiff><ci id="S3.E5.m1.2.3.3.3.2.2.cmml" xref="S3.E5.m1.2.3.3.3.2.2">𝒜</ci></apply><apply id="S3.E5.m1.2.3.3.3.3.cmml" xref="S3.E5.m1.2.3.3.3.3"><partialdiff id="S3.E5.m1.2.3.3.3.3.1.cmml" xref="S3.E5.m1.2.3.3.3.3.1"></partialdiff><ci id="S3.E5.m1.2.3.3.3.3.2.cmml" xref="S3.E5.m1.2.3.3.3.3.2">ℬ</ci></apply></apply><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><divide id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2"></divide><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.3"><partialdiff id="S3.E5.m1.2.2.3.1.cmml" xref="S3.E5.m1.2.2.3.1"></partialdiff><ci id="S3.E5.m1.2.2.3.2.cmml" xref="S3.E5.m1.2.2.3.2">ℬ</ci></apply><apply id="S3.E5.m1.2.2.1.cmml" xref="S3.E5.m1.2.2.1"><partialdiff id="S3.E5.m1.2.2.1.2.cmml" xref="S3.E5.m1.2.2.1.2"></partialdiff><apply id="S3.E5.m1.2.2.1.3.cmml" xref="S3.E5.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.3.1.cmml" xref="S3.E5.m1.2.2.1.3">superscript</csymbol><ci id="S3.E5.m1.2.2.1.3.2.cmml" xref="S3.E5.m1.2.2.1.3.2">𝑊</ci><ci id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">dW^{(c)}=\frac{\partial\mathcal{L}}{\partial\mathcal{A}}\cdot\frac{\partial\mathcal{A}}{\partial\mathcal{B}}\cdot\frac{\partial\mathcal{B}}{\partial W^{(c)}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.5" class="ltx_p">However, according to formula (<a href="#S3.E3" title="In 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), we cannot compute <math id="S3.SS4.p3.1.m1.1" class="ltx_Math" alttext="\partial\mathcal{B}/\partial W^{(c)}" display="inline"><semantics id="S3.SS4.p3.1.m1.1a"><mrow id="S3.SS4.p3.1.m1.1.2" xref="S3.SS4.p3.1.m1.1.2.cmml"><mo rspace="0em" id="S3.SS4.p3.1.m1.1.2.1" xref="S3.SS4.p3.1.m1.1.2.1.cmml">∂</mo><mrow id="S3.SS4.p3.1.m1.1.2.2" xref="S3.SS4.p3.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.1.m1.1.2.2.2" xref="S3.SS4.p3.1.m1.1.2.2.2.cmml">ℬ</mi><mo id="S3.SS4.p3.1.m1.1.2.2.1" xref="S3.SS4.p3.1.m1.1.2.2.1.cmml">/</mo><mrow id="S3.SS4.p3.1.m1.1.2.2.3" xref="S3.SS4.p3.1.m1.1.2.2.3.cmml"><mo lspace="0em" rspace="0em" id="S3.SS4.p3.1.m1.1.2.2.3.1" xref="S3.SS4.p3.1.m1.1.2.2.3.1.cmml">∂</mo><msup id="S3.SS4.p3.1.m1.1.2.2.3.2" xref="S3.SS4.p3.1.m1.1.2.2.3.2.cmml"><mi id="S3.SS4.p3.1.m1.1.2.2.3.2.2" xref="S3.SS4.p3.1.m1.1.2.2.3.2.2.cmml">W</mi><mrow id="S3.SS4.p3.1.m1.1.1.1.3" xref="S3.SS4.p3.1.m1.1.2.2.3.2.cmml"><mo stretchy="false" id="S3.SS4.p3.1.m1.1.1.1.3.1" xref="S3.SS4.p3.1.m1.1.2.2.3.2.cmml">(</mo><mi id="S3.SS4.p3.1.m1.1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p3.1.m1.1.1.1.3.2" xref="S3.SS4.p3.1.m1.1.2.2.3.2.cmml">)</mo></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.2"><partialdiff id="S3.SS4.p3.1.m1.1.2.1.cmml" xref="S3.SS4.p3.1.m1.1.2.1"></partialdiff><apply id="S3.SS4.p3.1.m1.1.2.2.cmml" xref="S3.SS4.p3.1.m1.1.2.2"><divide id="S3.SS4.p3.1.m1.1.2.2.1.cmml" xref="S3.SS4.p3.1.m1.1.2.2.1"></divide><ci id="S3.SS4.p3.1.m1.1.2.2.2.cmml" xref="S3.SS4.p3.1.m1.1.2.2.2">ℬ</ci><apply id="S3.SS4.p3.1.m1.1.2.2.3.cmml" xref="S3.SS4.p3.1.m1.1.2.2.3"><partialdiff id="S3.SS4.p3.1.m1.1.2.2.3.1.cmml" xref="S3.SS4.p3.1.m1.1.2.2.3.1"></partialdiff><apply id="S3.SS4.p3.1.m1.1.2.2.3.2.cmml" xref="S3.SS4.p3.1.m1.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.2.2.3.2.1.cmml" xref="S3.SS4.p3.1.m1.1.2.2.3.2">superscript</csymbol><ci id="S3.SS4.p3.1.m1.1.2.2.3.2.2.cmml" xref="S3.SS4.p3.1.m1.1.2.2.3.2.2">𝑊</ci><ci id="S3.SS4.p3.1.m1.1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">\partial\mathcal{B}/\partial W^{(c)}</annotation></semantics></math> directly since there is no direct differentiable mapping from <math id="S3.SS4.p3.2.m2.1" class="ltx_Math" alttext="W^{(c)}" display="inline"><semantics id="S3.SS4.p3.2.m2.1a"><msup id="S3.SS4.p3.2.m2.1.2" xref="S3.SS4.p3.2.m2.1.2.cmml"><mi id="S3.SS4.p3.2.m2.1.2.2" xref="S3.SS4.p3.2.m2.1.2.2.cmml">W</mi><mrow id="S3.SS4.p3.2.m2.1.1.1.3" xref="S3.SS4.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS4.p3.2.m2.1.1.1.3.1" xref="S3.SS4.p3.2.m2.1.2.cmml">(</mo><mi id="S3.SS4.p3.2.m2.1.1.1.1" xref="S3.SS4.p3.2.m2.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p3.2.m2.1.1.1.3.2" xref="S3.SS4.p3.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.2.cmml" xref="S3.SS4.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.2.1.cmml" xref="S3.SS4.p3.2.m2.1.2">superscript</csymbol><ci id="S3.SS4.p3.2.m2.1.2.2.cmml" xref="S3.SS4.p3.2.m2.1.2.2">𝑊</ci><ci id="S3.SS4.p3.2.m2.1.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">W^{(c)}</annotation></semantics></math> to <math id="S3.SS4.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="S3.SS4.p3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><ci id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">\mathcal{B}</annotation></semantics></math>. For convenience, <math id="S3.SS4.p3.4.m4.1" class="ltx_Math" alttext="\partial\mathcal{O}/\partial W^{(c)}" display="inline"><semantics id="S3.SS4.p3.4.m4.1a"><mrow id="S3.SS4.p3.4.m4.1.2" xref="S3.SS4.p3.4.m4.1.2.cmml"><mo rspace="0em" id="S3.SS4.p3.4.m4.1.2.1" xref="S3.SS4.p3.4.m4.1.2.1.cmml">∂</mo><mrow id="S3.SS4.p3.4.m4.1.2.2" xref="S3.SS4.p3.4.m4.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.4.m4.1.2.2.2" xref="S3.SS4.p3.4.m4.1.2.2.2.cmml">𝒪</mi><mo id="S3.SS4.p3.4.m4.1.2.2.1" xref="S3.SS4.p3.4.m4.1.2.2.1.cmml">/</mo><mrow id="S3.SS4.p3.4.m4.1.2.2.3" xref="S3.SS4.p3.4.m4.1.2.2.3.cmml"><mo lspace="0em" rspace="0em" id="S3.SS4.p3.4.m4.1.2.2.3.1" xref="S3.SS4.p3.4.m4.1.2.2.3.1.cmml">∂</mo><msup id="S3.SS4.p3.4.m4.1.2.2.3.2" xref="S3.SS4.p3.4.m4.1.2.2.3.2.cmml"><mi id="S3.SS4.p3.4.m4.1.2.2.3.2.2" xref="S3.SS4.p3.4.m4.1.2.2.3.2.2.cmml">W</mi><mrow id="S3.SS4.p3.4.m4.1.1.1.3" xref="S3.SS4.p3.4.m4.1.2.2.3.2.cmml"><mo stretchy="false" id="S3.SS4.p3.4.m4.1.1.1.3.1" xref="S3.SS4.p3.4.m4.1.2.2.3.2.cmml">(</mo><mi id="S3.SS4.p3.4.m4.1.1.1.1" xref="S3.SS4.p3.4.m4.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p3.4.m4.1.1.1.3.2" xref="S3.SS4.p3.4.m4.1.2.2.3.2.cmml">)</mo></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><apply id="S3.SS4.p3.4.m4.1.2.cmml" xref="S3.SS4.p3.4.m4.1.2"><partialdiff id="S3.SS4.p3.4.m4.1.2.1.cmml" xref="S3.SS4.p3.4.m4.1.2.1"></partialdiff><apply id="S3.SS4.p3.4.m4.1.2.2.cmml" xref="S3.SS4.p3.4.m4.1.2.2"><divide id="S3.SS4.p3.4.m4.1.2.2.1.cmml" xref="S3.SS4.p3.4.m4.1.2.2.1"></divide><ci id="S3.SS4.p3.4.m4.1.2.2.2.cmml" xref="S3.SS4.p3.4.m4.1.2.2.2">𝒪</ci><apply id="S3.SS4.p3.4.m4.1.2.2.3.cmml" xref="S3.SS4.p3.4.m4.1.2.2.3"><partialdiff id="S3.SS4.p3.4.m4.1.2.2.3.1.cmml" xref="S3.SS4.p3.4.m4.1.2.2.3.1"></partialdiff><apply id="S3.SS4.p3.4.m4.1.2.2.3.2.cmml" xref="S3.SS4.p3.4.m4.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p3.4.m4.1.2.2.3.2.1.cmml" xref="S3.SS4.p3.4.m4.1.2.2.3.2">superscript</csymbol><ci id="S3.SS4.p3.4.m4.1.2.2.3.2.2.cmml" xref="S3.SS4.p3.4.m4.1.2.2.3.2.2">𝑊</ci><ci id="S3.SS4.p3.4.m4.1.1.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1.1.1">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">\partial\mathcal{O}/\partial W^{(c)}</annotation></semantics></math> can be used instead of <math id="S3.SS4.p3.5.m5.1" class="ltx_Math" alttext="\partial\mathcal{B}/\partial W^{(c)}" display="inline"><semantics id="S3.SS4.p3.5.m5.1a"><mrow id="S3.SS4.p3.5.m5.1.2" xref="S3.SS4.p3.5.m5.1.2.cmml"><mo rspace="0em" id="S3.SS4.p3.5.m5.1.2.1" xref="S3.SS4.p3.5.m5.1.2.1.cmml">∂</mo><mrow id="S3.SS4.p3.5.m5.1.2.2" xref="S3.SS4.p3.5.m5.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.5.m5.1.2.2.2" xref="S3.SS4.p3.5.m5.1.2.2.2.cmml">ℬ</mi><mo id="S3.SS4.p3.5.m5.1.2.2.1" xref="S3.SS4.p3.5.m5.1.2.2.1.cmml">/</mo><mrow id="S3.SS4.p3.5.m5.1.2.2.3" xref="S3.SS4.p3.5.m5.1.2.2.3.cmml"><mo lspace="0em" rspace="0em" id="S3.SS4.p3.5.m5.1.2.2.3.1" xref="S3.SS4.p3.5.m5.1.2.2.3.1.cmml">∂</mo><msup id="S3.SS4.p3.5.m5.1.2.2.3.2" xref="S3.SS4.p3.5.m5.1.2.2.3.2.cmml"><mi id="S3.SS4.p3.5.m5.1.2.2.3.2.2" xref="S3.SS4.p3.5.m5.1.2.2.3.2.2.cmml">W</mi><mrow id="S3.SS4.p3.5.m5.1.1.1.3" xref="S3.SS4.p3.5.m5.1.2.2.3.2.cmml"><mo stretchy="false" id="S3.SS4.p3.5.m5.1.1.1.3.1" xref="S3.SS4.p3.5.m5.1.2.2.3.2.cmml">(</mo><mi id="S3.SS4.p3.5.m5.1.1.1.1" xref="S3.SS4.p3.5.m5.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p3.5.m5.1.1.1.3.2" xref="S3.SS4.p3.5.m5.1.2.2.3.2.cmml">)</mo></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m5.1b"><apply id="S3.SS4.p3.5.m5.1.2.cmml" xref="S3.SS4.p3.5.m5.1.2"><partialdiff id="S3.SS4.p3.5.m5.1.2.1.cmml" xref="S3.SS4.p3.5.m5.1.2.1"></partialdiff><apply id="S3.SS4.p3.5.m5.1.2.2.cmml" xref="S3.SS4.p3.5.m5.1.2.2"><divide id="S3.SS4.p3.5.m5.1.2.2.1.cmml" xref="S3.SS4.p3.5.m5.1.2.2.1"></divide><ci id="S3.SS4.p3.5.m5.1.2.2.2.cmml" xref="S3.SS4.p3.5.m5.1.2.2.2">ℬ</ci><apply id="S3.SS4.p3.5.m5.1.2.2.3.cmml" xref="S3.SS4.p3.5.m5.1.2.2.3"><partialdiff id="S3.SS4.p3.5.m5.1.2.2.3.1.cmml" xref="S3.SS4.p3.5.m5.1.2.2.3.1"></partialdiff><apply id="S3.SS4.p3.5.m5.1.2.2.3.2.cmml" xref="S3.SS4.p3.5.m5.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p3.5.m5.1.2.2.3.2.1.cmml" xref="S3.SS4.p3.5.m5.1.2.2.3.2">superscript</csymbol><ci id="S3.SS4.p3.5.m5.1.2.2.3.2.2.cmml" xref="S3.SS4.p3.5.m5.1.2.2.3.2.2">𝑊</ci><ci id="S3.SS4.p3.5.m5.1.1.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1.1.1">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m5.1c">\partial\mathcal{B}/\partial W^{(c)}</annotation></semantics></math>, which may still work but it leads to a reduction in model accuracy.</p>
</div>
<div id="S3.SS4.p4" class="ltx_para">
<p id="S3.SS4.p4.3" class="ltx_p">Therefore, we design a bias corrector on clients to correct the gradients of lossy features, which could build the mapping from <math id="S3.SS4.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{O}" display="inline"><semantics id="S3.SS4.p4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml">𝒪</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><ci id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">𝒪</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">\mathcal{O}</annotation></semantics></math> to <math id="S3.SS4.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="S3.SS4.p4.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.2.m2.1.1" xref="S3.SS4.p4.2.m2.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.1b"><ci id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">\mathcal{B}</annotation></semantics></math> so that we can better approximate <math id="S3.SS4.p4.3.m3.1" class="ltx_Math" alttext="\partial\mathcal{B}/\partial W^{(c)}" display="inline"><semantics id="S3.SS4.p4.3.m3.1a"><mrow id="S3.SS4.p4.3.m3.1.2" xref="S3.SS4.p4.3.m3.1.2.cmml"><mo rspace="0em" id="S3.SS4.p4.3.m3.1.2.1" xref="S3.SS4.p4.3.m3.1.2.1.cmml">∂</mo><mrow id="S3.SS4.p4.3.m3.1.2.2" xref="S3.SS4.p4.3.m3.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.3.m3.1.2.2.2" xref="S3.SS4.p4.3.m3.1.2.2.2.cmml">ℬ</mi><mo id="S3.SS4.p4.3.m3.1.2.2.1" xref="S3.SS4.p4.3.m3.1.2.2.1.cmml">/</mo><mrow id="S3.SS4.p4.3.m3.1.2.2.3" xref="S3.SS4.p4.3.m3.1.2.2.3.cmml"><mo lspace="0em" rspace="0em" id="S3.SS4.p4.3.m3.1.2.2.3.1" xref="S3.SS4.p4.3.m3.1.2.2.3.1.cmml">∂</mo><msup id="S3.SS4.p4.3.m3.1.2.2.3.2" xref="S3.SS4.p4.3.m3.1.2.2.3.2.cmml"><mi id="S3.SS4.p4.3.m3.1.2.2.3.2.2" xref="S3.SS4.p4.3.m3.1.2.2.3.2.2.cmml">W</mi><mrow id="S3.SS4.p4.3.m3.1.1.1.3" xref="S3.SS4.p4.3.m3.1.2.2.3.2.cmml"><mo stretchy="false" id="S3.SS4.p4.3.m3.1.1.1.3.1" xref="S3.SS4.p4.3.m3.1.2.2.3.2.cmml">(</mo><mi id="S3.SS4.p4.3.m3.1.1.1.1" xref="S3.SS4.p4.3.m3.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p4.3.m3.1.1.1.3.2" xref="S3.SS4.p4.3.m3.1.2.2.3.2.cmml">)</mo></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m3.1b"><apply id="S3.SS4.p4.3.m3.1.2.cmml" xref="S3.SS4.p4.3.m3.1.2"><partialdiff id="S3.SS4.p4.3.m3.1.2.1.cmml" xref="S3.SS4.p4.3.m3.1.2.1"></partialdiff><apply id="S3.SS4.p4.3.m3.1.2.2.cmml" xref="S3.SS4.p4.3.m3.1.2.2"><divide id="S3.SS4.p4.3.m3.1.2.2.1.cmml" xref="S3.SS4.p4.3.m3.1.2.2.1"></divide><ci id="S3.SS4.p4.3.m3.1.2.2.2.cmml" xref="S3.SS4.p4.3.m3.1.2.2.2">ℬ</ci><apply id="S3.SS4.p4.3.m3.1.2.2.3.cmml" xref="S3.SS4.p4.3.m3.1.2.2.3"><partialdiff id="S3.SS4.p4.3.m3.1.2.2.3.1.cmml" xref="S3.SS4.p4.3.m3.1.2.2.3.1"></partialdiff><apply id="S3.SS4.p4.3.m3.1.2.2.3.2.cmml" xref="S3.SS4.p4.3.m3.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p4.3.m3.1.2.2.3.2.1.cmml" xref="S3.SS4.p4.3.m3.1.2.2.3.2">superscript</csymbol><ci id="S3.SS4.p4.3.m3.1.2.2.3.2.2.cmml" xref="S3.SS4.p4.3.m3.1.2.2.3.2.2">𝑊</ci><ci id="S3.SS4.p4.3.m3.1.1.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1.1.1">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m3.1c">\partial\mathcal{B}/\partial W^{(c)}</annotation></semantics></math> and counter-weigh the reduction. According to the feature of SVD, we can get:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\mathcal{B}=U_{\mathcal{O}}\mathcal{D}_{k}U_{\mathcal{O}}^{T}\mathcal{O}" display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">ℬ</mi><mo id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><msub id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml"><mi id="S3.E6.m1.1.1.3.2.2" xref="S3.E6.m1.1.1.3.2.2.cmml">U</mi><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.3.2.3" xref="S3.E6.m1.1.1.3.2.3.cmml">𝒪</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.3.1" xref="S3.E6.m1.1.1.3.1.cmml">​</mo><msub id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.3.3.2" xref="S3.E6.m1.1.1.3.3.2.cmml">𝒟</mi><mi id="S3.E6.m1.1.1.3.3.3" xref="S3.E6.m1.1.1.3.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.3.1a" xref="S3.E6.m1.1.1.3.1.cmml">​</mo><msubsup id="S3.E6.m1.1.1.3.4" xref="S3.E6.m1.1.1.3.4.cmml"><mi id="S3.E6.m1.1.1.3.4.2.2" xref="S3.E6.m1.1.1.3.4.2.2.cmml">U</mi><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.3.4.2.3" xref="S3.E6.m1.1.1.3.4.2.3.cmml">𝒪</mi><mi id="S3.E6.m1.1.1.3.4.3" xref="S3.E6.m1.1.1.3.4.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.3.1b" xref="S3.E6.m1.1.1.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.3.5" xref="S3.E6.m1.1.1.3.5.cmml">𝒪</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"></eq><ci id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2">ℬ</ci><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><times id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3.1"></times><apply id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2">𝑈</ci><ci id="S3.E6.m1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.3.2.3">𝒪</ci></apply><apply id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.3.3.2">𝒟</ci><ci id="S3.E6.m1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.3.3.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.3.4.cmml" xref="S3.E6.m1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.4.1.cmml" xref="S3.E6.m1.1.1.3.4">superscript</csymbol><apply id="S3.E6.m1.1.1.3.4.2.cmml" xref="S3.E6.m1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.4.2.1.cmml" xref="S3.E6.m1.1.1.3.4">subscript</csymbol><ci id="S3.E6.m1.1.1.3.4.2.2.cmml" xref="S3.E6.m1.1.1.3.4.2.2">𝑈</ci><ci id="S3.E6.m1.1.1.3.4.2.3.cmml" xref="S3.E6.m1.1.1.3.4.2.3">𝒪</ci></apply><ci id="S3.E6.m1.1.1.3.4.3.cmml" xref="S3.E6.m1.1.1.3.4.3">𝑇</ci></apply><ci id="S3.E6.m1.1.1.3.5.cmml" xref="S3.E6.m1.1.1.3.5">𝒪</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\mathcal{B}=U_{\mathcal{O}}\mathcal{D}_{k}U_{\mathcal{O}}^{T}\mathcal{O}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p4.8" class="ltx_p">where <math id="S3.SS4.p4.4.m1.1" class="ltx_Math" alttext="U_{\mathcal{O}}" display="inline"><semantics id="S3.SS4.p4.4.m1.1a"><msub id="S3.SS4.p4.4.m1.1.1" xref="S3.SS4.p4.4.m1.1.1.cmml"><mi id="S3.SS4.p4.4.m1.1.1.2" xref="S3.SS4.p4.4.m1.1.1.2.cmml">U</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.4.m1.1.1.3" xref="S3.SS4.p4.4.m1.1.1.3.cmml">𝒪</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.m1.1b"><apply id="S3.SS4.p4.4.m1.1.1.cmml" xref="S3.SS4.p4.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m1.1.1.1.cmml" xref="S3.SS4.p4.4.m1.1.1">subscript</csymbol><ci id="S3.SS4.p4.4.m1.1.1.2.cmml" xref="S3.SS4.p4.4.m1.1.1.2">𝑈</ci><ci id="S3.SS4.p4.4.m1.1.1.3.cmml" xref="S3.SS4.p4.4.m1.1.1.3">𝒪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.m1.1c">U_{\mathcal{O}}</annotation></semantics></math> here is just the same thing as the <math id="S3.SS4.p4.5.m2.1" class="ltx_Math" alttext="U_{\mathcal{O}}" display="inline"><semantics id="S3.SS4.p4.5.m2.1a"><msub id="S3.SS4.p4.5.m2.1.1" xref="S3.SS4.p4.5.m2.1.1.cmml"><mi id="S3.SS4.p4.5.m2.1.1.2" xref="S3.SS4.p4.5.m2.1.1.2.cmml">U</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.5.m2.1.1.3" xref="S3.SS4.p4.5.m2.1.1.3.cmml">𝒪</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.5.m2.1b"><apply id="S3.SS4.p4.5.m2.1.1.cmml" xref="S3.SS4.p4.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m2.1.1.1.cmml" xref="S3.SS4.p4.5.m2.1.1">subscript</csymbol><ci id="S3.SS4.p4.5.m2.1.1.2.cmml" xref="S3.SS4.p4.5.m2.1.1.2">𝑈</ci><ci id="S3.SS4.p4.5.m2.1.1.3.cmml" xref="S3.SS4.p4.5.m2.1.1.3">𝒪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.5.m2.1c">U_{\mathcal{O}}</annotation></semantics></math> in formula (<a href="#S3.E3" title="In 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), <math id="S3.SS4.p4.6.m3.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS4.p4.6.m3.1a"><msub id="S3.SS4.p4.6.m3.1.1" xref="S3.SS4.p4.6.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.6.m3.1.1.2" xref="S3.SS4.p4.6.m3.1.1.2.cmml">𝒟</mi><mi id="S3.SS4.p4.6.m3.1.1.3" xref="S3.SS4.p4.6.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.6.m3.1b"><apply id="S3.SS4.p4.6.m3.1.1.cmml" xref="S3.SS4.p4.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.6.m3.1.1.1.cmml" xref="S3.SS4.p4.6.m3.1.1">subscript</csymbol><ci id="S3.SS4.p4.6.m3.1.1.2.cmml" xref="S3.SS4.p4.6.m3.1.1.2">𝒟</ci><ci id="S3.SS4.p4.6.m3.1.1.3.cmml" xref="S3.SS4.p4.6.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.6.m3.1c">\mathcal{D}_{k}</annotation></semantics></math> represents a diagonal matrix where its first <math id="S3.SS4.p4.7.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS4.p4.7.m4.1a"><mi id="S3.SS4.p4.7.m4.1.1" xref="S3.SS4.p4.7.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.7.m4.1b"><ci id="S3.SS4.p4.7.m4.1.1.cmml" xref="S3.SS4.p4.7.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.7.m4.1c">k</annotation></semantics></math> elements on the diagonal are <span id="S3.SS4.p4.8.1" class="ltx_text ltx_font_italic">1</span> and the rest are <span id="S3.SS4.p4.8.2" class="ltx_text ltx_font_italic">0</span>. Therefore, <math id="S3.SS4.p4.8.m5.1" class="ltx_Math" alttext="\partial\mathcal{B}/\partial W^{(c)}" display="inline"><semantics id="S3.SS4.p4.8.m5.1a"><mrow id="S3.SS4.p4.8.m5.1.2" xref="S3.SS4.p4.8.m5.1.2.cmml"><mo rspace="0em" id="S3.SS4.p4.8.m5.1.2.1" xref="S3.SS4.p4.8.m5.1.2.1.cmml">∂</mo><mrow id="S3.SS4.p4.8.m5.1.2.2" xref="S3.SS4.p4.8.m5.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.8.m5.1.2.2.2" xref="S3.SS4.p4.8.m5.1.2.2.2.cmml">ℬ</mi><mo id="S3.SS4.p4.8.m5.1.2.2.1" xref="S3.SS4.p4.8.m5.1.2.2.1.cmml">/</mo><mrow id="S3.SS4.p4.8.m5.1.2.2.3" xref="S3.SS4.p4.8.m5.1.2.2.3.cmml"><mo lspace="0em" rspace="0em" id="S3.SS4.p4.8.m5.1.2.2.3.1" xref="S3.SS4.p4.8.m5.1.2.2.3.1.cmml">∂</mo><msup id="S3.SS4.p4.8.m5.1.2.2.3.2" xref="S3.SS4.p4.8.m5.1.2.2.3.2.cmml"><mi id="S3.SS4.p4.8.m5.1.2.2.3.2.2" xref="S3.SS4.p4.8.m5.1.2.2.3.2.2.cmml">W</mi><mrow id="S3.SS4.p4.8.m5.1.1.1.3" xref="S3.SS4.p4.8.m5.1.2.2.3.2.cmml"><mo stretchy="false" id="S3.SS4.p4.8.m5.1.1.1.3.1" xref="S3.SS4.p4.8.m5.1.2.2.3.2.cmml">(</mo><mi id="S3.SS4.p4.8.m5.1.1.1.1" xref="S3.SS4.p4.8.m5.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p4.8.m5.1.1.1.3.2" xref="S3.SS4.p4.8.m5.1.2.2.3.2.cmml">)</mo></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.8.m5.1b"><apply id="S3.SS4.p4.8.m5.1.2.cmml" xref="S3.SS4.p4.8.m5.1.2"><partialdiff id="S3.SS4.p4.8.m5.1.2.1.cmml" xref="S3.SS4.p4.8.m5.1.2.1"></partialdiff><apply id="S3.SS4.p4.8.m5.1.2.2.cmml" xref="S3.SS4.p4.8.m5.1.2.2"><divide id="S3.SS4.p4.8.m5.1.2.2.1.cmml" xref="S3.SS4.p4.8.m5.1.2.2.1"></divide><ci id="S3.SS4.p4.8.m5.1.2.2.2.cmml" xref="S3.SS4.p4.8.m5.1.2.2.2">ℬ</ci><apply id="S3.SS4.p4.8.m5.1.2.2.3.cmml" xref="S3.SS4.p4.8.m5.1.2.2.3"><partialdiff id="S3.SS4.p4.8.m5.1.2.2.3.1.cmml" xref="S3.SS4.p4.8.m5.1.2.2.3.1"></partialdiff><apply id="S3.SS4.p4.8.m5.1.2.2.3.2.cmml" xref="S3.SS4.p4.8.m5.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p4.8.m5.1.2.2.3.2.1.cmml" xref="S3.SS4.p4.8.m5.1.2.2.3.2">superscript</csymbol><ci id="S3.SS4.p4.8.m5.1.2.2.3.2.2.cmml" xref="S3.SS4.p4.8.m5.1.2.2.3.2.2">𝑊</ci><ci id="S3.SS4.p4.8.m5.1.1.1.1.cmml" xref="S3.SS4.p4.8.m5.1.1.1.1">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.8.m5.1c">\partial\mathcal{B}/\partial W^{(c)}</annotation></semantics></math> can be rewritten as:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.3" class="ltx_Math" alttext="\partial\mathcal{B}/\partial{W}^{(c)}\approx U_{\mathcal{O}}\mathcal{D}_{k}U_{\mathcal{O}}^{T}\cdot(\partial\mathcal{O}/\partial W^{(c)})" display="block"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml"><mrow id="S3.E7.m1.3.3.3" xref="S3.E7.m1.3.3.3.cmml"><mo rspace="0em" id="S3.E7.m1.3.3.3.1" xref="S3.E7.m1.3.3.3.1.cmml">∂</mo><mrow id="S3.E7.m1.3.3.3.2" xref="S3.E7.m1.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.3.2.2" xref="S3.E7.m1.3.3.3.2.2.cmml">ℬ</mi><mo id="S3.E7.m1.3.3.3.2.1" xref="S3.E7.m1.3.3.3.2.1.cmml">/</mo><mrow id="S3.E7.m1.3.3.3.2.3" xref="S3.E7.m1.3.3.3.2.3.cmml"><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.3.2.3.1" xref="S3.E7.m1.3.3.3.2.3.1.cmml">∂</mo><msup id="S3.E7.m1.3.3.3.2.3.2" xref="S3.E7.m1.3.3.3.2.3.2.cmml"><mi id="S3.E7.m1.3.3.3.2.3.2.2" xref="S3.E7.m1.3.3.3.2.3.2.2.cmml">W</mi><mrow id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.3.3.3.2.3.2.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.3.1" xref="S3.E7.m1.3.3.3.2.3.2.cmml">(</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E7.m1.1.1.1.3.2" xref="S3.E7.m1.3.3.3.2.3.2.cmml">)</mo></mrow></msup></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.2" xref="S3.E7.m1.3.3.2.cmml">≈</mo><mrow id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.cmml"><mrow id="S3.E7.m1.3.3.1.3" xref="S3.E7.m1.3.3.1.3.cmml"><msub id="S3.E7.m1.3.3.1.3.2" xref="S3.E7.m1.3.3.1.3.2.cmml"><mi id="S3.E7.m1.3.3.1.3.2.2" xref="S3.E7.m1.3.3.1.3.2.2.cmml">U</mi><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.3.2.3" xref="S3.E7.m1.3.3.1.3.2.3.cmml">𝒪</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.3.1" xref="S3.E7.m1.3.3.1.3.1.cmml">​</mo><msub id="S3.E7.m1.3.3.1.3.3" xref="S3.E7.m1.3.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.3.3.2" xref="S3.E7.m1.3.3.1.3.3.2.cmml">𝒟</mi><mi id="S3.E7.m1.3.3.1.3.3.3" xref="S3.E7.m1.3.3.1.3.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.3.1a" xref="S3.E7.m1.3.3.1.3.1.cmml">​</mo><msubsup id="S3.E7.m1.3.3.1.3.4" xref="S3.E7.m1.3.3.1.3.4.cmml"><mi id="S3.E7.m1.3.3.1.3.4.2.2" xref="S3.E7.m1.3.3.1.3.4.2.2.cmml">U</mi><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.3.4.2.3" xref="S3.E7.m1.3.3.1.3.4.2.3.cmml">𝒪</mi><mi id="S3.E7.m1.3.3.1.3.4.3" xref="S3.E7.m1.3.3.1.3.4.3.cmml">T</mi></msubsup></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.E7.m1.3.3.1.2" xref="S3.E7.m1.3.3.1.2.cmml">⋅</mo><mrow id="S3.E7.m1.3.3.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.3.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.cmml">∂</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.1.1.1.2.2" xref="S3.E7.m1.3.3.1.1.1.1.2.2.cmml">𝒪</mi><mo id="S3.E7.m1.3.3.1.1.1.1.2.1" xref="S3.E7.m1.3.3.1.1.1.1.2.1.cmml">/</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.2.3" xref="S3.E7.m1.3.3.1.1.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.2.3.1" xref="S3.E7.m1.3.3.1.1.1.1.2.3.1.cmml">∂</mo><msup id="S3.E7.m1.3.3.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.1.1.1.1.2.3.2.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.2.3.2.2" xref="S3.E7.m1.3.3.1.1.1.1.2.3.2.2.cmml">W</mi><mrow id="S3.E7.m1.2.2.1.3" xref="S3.E7.m1.3.3.1.1.1.1.2.3.2.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.3.1" xref="S3.E7.m1.3.3.1.1.1.1.2.3.2.cmml">(</mo><mi id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml">c</mi><mo stretchy="false" id="S3.E7.m1.2.2.1.3.2" xref="S3.E7.m1.3.3.1.1.1.1.2.3.2.cmml">)</mo></mrow></msup></mrow></mrow></mrow><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3"><approx id="S3.E7.m1.3.3.2.cmml" xref="S3.E7.m1.3.3.2"></approx><apply id="S3.E7.m1.3.3.3.cmml" xref="S3.E7.m1.3.3.3"><partialdiff id="S3.E7.m1.3.3.3.1.cmml" xref="S3.E7.m1.3.3.3.1"></partialdiff><apply id="S3.E7.m1.3.3.3.2.cmml" xref="S3.E7.m1.3.3.3.2"><divide id="S3.E7.m1.3.3.3.2.1.cmml" xref="S3.E7.m1.3.3.3.2.1"></divide><ci id="S3.E7.m1.3.3.3.2.2.cmml" xref="S3.E7.m1.3.3.3.2.2">ℬ</ci><apply id="S3.E7.m1.3.3.3.2.3.cmml" xref="S3.E7.m1.3.3.3.2.3"><partialdiff id="S3.E7.m1.3.3.3.2.3.1.cmml" xref="S3.E7.m1.3.3.3.2.3.1"></partialdiff><apply id="S3.E7.m1.3.3.3.2.3.2.cmml" xref="S3.E7.m1.3.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.2.3.2.1.cmml" xref="S3.E7.m1.3.3.3.2.3.2">superscript</csymbol><ci id="S3.E7.m1.3.3.3.2.3.2.2.cmml" xref="S3.E7.m1.3.3.3.2.3.2.2">𝑊</ci><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑐</ci></apply></apply></apply></apply><apply id="S3.E7.m1.3.3.1.cmml" xref="S3.E7.m1.3.3.1"><ci id="S3.E7.m1.3.3.1.2.cmml" xref="S3.E7.m1.3.3.1.2">⋅</ci><apply id="S3.E7.m1.3.3.1.3.cmml" xref="S3.E7.m1.3.3.1.3"><times id="S3.E7.m1.3.3.1.3.1.cmml" xref="S3.E7.m1.3.3.1.3.1"></times><apply id="S3.E7.m1.3.3.1.3.2.cmml" xref="S3.E7.m1.3.3.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.3.2.1.cmml" xref="S3.E7.m1.3.3.1.3.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.3.2.2.cmml" xref="S3.E7.m1.3.3.1.3.2.2">𝑈</ci><ci id="S3.E7.m1.3.3.1.3.2.3.cmml" xref="S3.E7.m1.3.3.1.3.2.3">𝒪</ci></apply><apply id="S3.E7.m1.3.3.1.3.3.cmml" xref="S3.E7.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.3.3.1.cmml" xref="S3.E7.m1.3.3.1.3.3">subscript</csymbol><ci id="S3.E7.m1.3.3.1.3.3.2.cmml" xref="S3.E7.m1.3.3.1.3.3.2">𝒟</ci><ci id="S3.E7.m1.3.3.1.3.3.3.cmml" xref="S3.E7.m1.3.3.1.3.3.3">𝑘</ci></apply><apply id="S3.E7.m1.3.3.1.3.4.cmml" xref="S3.E7.m1.3.3.1.3.4"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.3.4.1.cmml" xref="S3.E7.m1.3.3.1.3.4">superscript</csymbol><apply id="S3.E7.m1.3.3.1.3.4.2.cmml" xref="S3.E7.m1.3.3.1.3.4"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.3.4.2.1.cmml" xref="S3.E7.m1.3.3.1.3.4">subscript</csymbol><ci id="S3.E7.m1.3.3.1.3.4.2.2.cmml" xref="S3.E7.m1.3.3.1.3.4.2.2">𝑈</ci><ci id="S3.E7.m1.3.3.1.3.4.2.3.cmml" xref="S3.E7.m1.3.3.1.3.4.2.3">𝒪</ci></apply><ci id="S3.E7.m1.3.3.1.3.4.3.cmml" xref="S3.E7.m1.3.3.1.3.4.3">𝑇</ci></apply></apply><apply id="S3.E7.m1.3.3.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1"><partialdiff id="S3.E7.m1.3.3.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1"></partialdiff><apply id="S3.E7.m1.3.3.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2"><divide id="S3.E7.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2.1"></divide><ci id="S3.E7.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2.2">𝒪</ci><apply id="S3.E7.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2.3"><partialdiff id="S3.E7.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2.3.1"></partialdiff><apply id="S3.E7.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.2.3.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2.3.2">superscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.2.3.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2.3.2.2">𝑊</ci><ci id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1.1">𝑐</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\partial\mathcal{B}/\partial{W}^{(c)}\approx U_{\mathcal{O}}\mathcal{D}_{k}U_{\mathcal{O}}^{T}\cdot(\partial\mathcal{O}/\partial W^{(c)})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p4.9" class="ltx_p">Thus, the bias corrector can be considered as consisting of many fully connected layers stacked on top of each other, and the parameters depend on the SVD results of the features extracted from the shallow model. In other words, the parameters of the bias corrector will be updated during the procedure of forward propagation. We also compare the results for the presence or absence of the bias corrector through appropriate experiments in Section <a href="#S4" title="4 Experimental Results ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.15.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> The workflow for H-FL</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.13" class="ltx_p ltx_figure_panel"><span id="alg2.13.1" class="ltx_text ltx_font_bold">Input</span>: <math id="alg2.1.m1.1" class="ltx_Math" alttext="\mathcal{U}" display="inline"><semantics id="alg2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.1.m1.1.1" xref="alg2.1.m1.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="alg2.1.m1.1b"><ci id="alg2.1.m1.1.1.cmml" xref="alg2.1.m1.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.m1.1c">\mathcal{U}</annotation></semantics></math>, <math id="alg2.2.m2.1" class="ltx_Math" alttext="\mathcal{AM}" display="inline"><semantics id="alg2.2.m2.1a"><mrow id="alg2.2.m2.1.1" xref="alg2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.2.m2.1.1.2" xref="alg2.2.m2.1.1.2.cmml">𝒜</mi><mo lspace="0em" rspace="0em" id="alg2.2.m2.1.1.1" xref="alg2.2.m2.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="alg2.2.m2.1.1.3" xref="alg2.2.m2.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.2.m2.1b"><apply id="alg2.2.m2.1.1.cmml" xref="alg2.2.m2.1.1"><times id="alg2.2.m2.1.1.1.cmml" xref="alg2.2.m2.1.1.1"></times><ci id="alg2.2.m2.1.1.2.cmml" xref="alg2.2.m2.1.1.2">𝒜</ci><ci id="alg2.2.m2.1.1.3.cmml" xref="alg2.2.m2.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.m2.1c">\mathcal{AM}</annotation></semantics></math>, <math id="alg2.3.m3.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="alg2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.3.m3.1.1" xref="alg2.3.m3.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg2.3.m3.1b"><ci id="alg2.3.m3.1.1.cmml" xref="alg2.3.m3.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.m3.1c">\mathcal{M}</annotation></semantics></math>
<br class="ltx_break"><span id="alg2.13.2" class="ltx_text ltx_font_bold">Parameter</span>: <math id="alg2.4.m4.1" class="ltx_Math" alttext="W^{(m)}_{t}" display="inline"><semantics id="alg2.4.m4.1a"><msubsup id="alg2.4.m4.1.2" xref="alg2.4.m4.1.2.cmml"><mi id="alg2.4.m4.1.2.2.2" xref="alg2.4.m4.1.2.2.2.cmml">W</mi><mi id="alg2.4.m4.1.2.3" xref="alg2.4.m4.1.2.3.cmml">t</mi><mrow id="alg2.4.m4.1.1.1.3" xref="alg2.4.m4.1.2.cmml"><mo stretchy="false" id="alg2.4.m4.1.1.1.3.1" xref="alg2.4.m4.1.2.cmml">(</mo><mi id="alg2.4.m4.1.1.1.1" xref="alg2.4.m4.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg2.4.m4.1.1.1.3.2" xref="alg2.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.4.m4.1b"><apply id="alg2.4.m4.1.2.cmml" xref="alg2.4.m4.1.2"><csymbol cd="ambiguous" id="alg2.4.m4.1.2.1.cmml" xref="alg2.4.m4.1.2">subscript</csymbol><apply id="alg2.4.m4.1.2.2.cmml" xref="alg2.4.m4.1.2"><csymbol cd="ambiguous" id="alg2.4.m4.1.2.2.1.cmml" xref="alg2.4.m4.1.2">superscript</csymbol><ci id="alg2.4.m4.1.2.2.2.cmml" xref="alg2.4.m4.1.2.2.2">𝑊</ci><ci id="alg2.4.m4.1.1.1.1.cmml" xref="alg2.4.m4.1.1.1.1">𝑚</ci></apply><ci id="alg2.4.m4.1.2.3.cmml" xref="alg2.4.m4.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.m4.1c">W^{(m)}_{t}</annotation></semantics></math>, <math id="alg2.5.m5.1" class="ltx_Math" alttext="W^{(c)}_{t}" display="inline"><semantics id="alg2.5.m5.1a"><msubsup id="alg2.5.m5.1.2" xref="alg2.5.m5.1.2.cmml"><mi id="alg2.5.m5.1.2.2.2" xref="alg2.5.m5.1.2.2.2.cmml">W</mi><mi id="alg2.5.m5.1.2.3" xref="alg2.5.m5.1.2.3.cmml">t</mi><mrow id="alg2.5.m5.1.1.1.3" xref="alg2.5.m5.1.2.cmml"><mo stretchy="false" id="alg2.5.m5.1.1.1.3.1" xref="alg2.5.m5.1.2.cmml">(</mo><mi id="alg2.5.m5.1.1.1.1" xref="alg2.5.m5.1.1.1.1.cmml">c</mi><mo stretchy="false" id="alg2.5.m5.1.1.1.3.2" xref="alg2.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.5.m5.1b"><apply id="alg2.5.m5.1.2.cmml" xref="alg2.5.m5.1.2"><csymbol cd="ambiguous" id="alg2.5.m5.1.2.1.cmml" xref="alg2.5.m5.1.2">subscript</csymbol><apply id="alg2.5.m5.1.2.2.cmml" xref="alg2.5.m5.1.2"><csymbol cd="ambiguous" id="alg2.5.m5.1.2.2.1.cmml" xref="alg2.5.m5.1.2">superscript</csymbol><ci id="alg2.5.m5.1.2.2.2.cmml" xref="alg2.5.m5.1.2.2.2">𝑊</ci><ci id="alg2.5.m5.1.1.1.1.cmml" xref="alg2.5.m5.1.1.1.1">𝑐</ci></apply><ci id="alg2.5.m5.1.2.3.cmml" xref="alg2.5.m5.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.m5.1c">W^{(c)}_{t}</annotation></semantics></math>, <math id="alg2.6.m6.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="alg2.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.6.m6.1.1" xref="alg2.6.m6.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="alg2.6.m6.1b"><ci id="alg2.6.m6.1.1.cmml" xref="alg2.6.m6.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.m6.1c">\mathcal{P}</annotation></semantics></math>, <math id="alg2.7.m7.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="alg2.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.7.m7.1.1" xref="alg2.7.m7.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="alg2.7.m7.1b"><ci id="alg2.7.m7.1.1.cmml" xref="alg2.7.m7.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.m7.1c">\mathcal{S}</annotation></semantics></math>, <math id="alg2.8.m8.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="alg2.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.8.m8.1.1" xref="alg2.8.m8.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg2.8.m8.1b"><ci id="alg2.8.m8.1.1.cmml" xref="alg2.8.m8.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.m8.1c">\mathcal{C}</annotation></semantics></math>, <math id="alg2.9.m9.1" class="ltx_Math" alttext="\mathcal{I}" display="inline"><semantics id="alg2.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.9.m9.1.1" xref="alg2.9.m9.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="alg2.9.m9.1b"><ci id="alg2.9.m9.1.1.cmml" xref="alg2.9.m9.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.m9.1c">\mathcal{I}</annotation></semantics></math>, <math id="alg2.10.m10.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="alg2.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.10.m10.1.1" xref="alg2.10.m10.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg2.10.m10.1b"><ci id="alg2.10.m10.1.1.cmml" xref="alg2.10.m10.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.m10.1c">\mathcal{L}</annotation></semantics></math>, <math id="alg2.11.m11.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="alg2.11.m11.1a"><mi id="alg2.11.m11.1.1" xref="alg2.11.m11.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="alg2.11.m11.1b"><ci id="alg2.11.m11.1.1.cmml" xref="alg2.11.m11.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.m11.1c">\sigma</annotation></semantics></math>
<br class="ltx_break"><span id="alg2.13.3" class="ltx_text ltx_font_bold">Output</span>: <math id="alg2.12.m12.1" class="ltx_Math" alttext="W^{(d)}_{t+1}" display="inline"><semantics id="alg2.12.m12.1a"><msubsup id="alg2.12.m12.1.2" xref="alg2.12.m12.1.2.cmml"><mi id="alg2.12.m12.1.2.2.2" xref="alg2.12.m12.1.2.2.2.cmml">W</mi><mrow id="alg2.12.m12.1.2.3" xref="alg2.12.m12.1.2.3.cmml"><mi id="alg2.12.m12.1.2.3.2" xref="alg2.12.m12.1.2.3.2.cmml">t</mi><mo id="alg2.12.m12.1.2.3.1" xref="alg2.12.m12.1.2.3.1.cmml">+</mo><mn id="alg2.12.m12.1.2.3.3" xref="alg2.12.m12.1.2.3.3.cmml">1</mn></mrow><mrow id="alg2.12.m12.1.1.1.3" xref="alg2.12.m12.1.2.cmml"><mo stretchy="false" id="alg2.12.m12.1.1.1.3.1" xref="alg2.12.m12.1.2.cmml">(</mo><mi id="alg2.12.m12.1.1.1.1" xref="alg2.12.m12.1.1.1.1.cmml">d</mi><mo stretchy="false" id="alg2.12.m12.1.1.1.3.2" xref="alg2.12.m12.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.12.m12.1b"><apply id="alg2.12.m12.1.2.cmml" xref="alg2.12.m12.1.2"><csymbol cd="ambiguous" id="alg2.12.m12.1.2.1.cmml" xref="alg2.12.m12.1.2">subscript</csymbol><apply id="alg2.12.m12.1.2.2.cmml" xref="alg2.12.m12.1.2"><csymbol cd="ambiguous" id="alg2.12.m12.1.2.2.1.cmml" xref="alg2.12.m12.1.2">superscript</csymbol><ci id="alg2.12.m12.1.2.2.2.cmml" xref="alg2.12.m12.1.2.2.2">𝑊</ci><ci id="alg2.12.m12.1.1.1.1.cmml" xref="alg2.12.m12.1.1.1.1">𝑑</ci></apply><apply id="alg2.12.m12.1.2.3.cmml" xref="alg2.12.m12.1.2.3"><plus id="alg2.12.m12.1.2.3.1.cmml" xref="alg2.12.m12.1.2.3.1"></plus><ci id="alg2.12.m12.1.2.3.2.cmml" xref="alg2.12.m12.1.2.3.2">𝑡</ci><cn type="integer" id="alg2.12.m12.1.2.3.3.cmml" xref="alg2.12.m12.1.2.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.m12.1c">W^{(d)}_{t+1}</annotation></semantics></math>, <math id="alg2.13.m13.1" class="ltx_Math" alttext="W^{(s)}_{t+1}" display="inline"><semantics id="alg2.13.m13.1a"><msubsup id="alg2.13.m13.1.2" xref="alg2.13.m13.1.2.cmml"><mi id="alg2.13.m13.1.2.2.2" xref="alg2.13.m13.1.2.2.2.cmml">W</mi><mrow id="alg2.13.m13.1.2.3" xref="alg2.13.m13.1.2.3.cmml"><mi id="alg2.13.m13.1.2.3.2" xref="alg2.13.m13.1.2.3.2.cmml">t</mi><mo id="alg2.13.m13.1.2.3.1" xref="alg2.13.m13.1.2.3.1.cmml">+</mo><mn id="alg2.13.m13.1.2.3.3" xref="alg2.13.m13.1.2.3.3.cmml">1</mn></mrow><mrow id="alg2.13.m13.1.1.1.3" xref="alg2.13.m13.1.2.cmml"><mo stretchy="false" id="alg2.13.m13.1.1.1.3.1" xref="alg2.13.m13.1.2.cmml">(</mo><mi id="alg2.13.m13.1.1.1.1" xref="alg2.13.m13.1.1.1.1.cmml">s</mi><mo stretchy="false" id="alg2.13.m13.1.1.1.3.2" xref="alg2.13.m13.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.13.m13.1b"><apply id="alg2.13.m13.1.2.cmml" xref="alg2.13.m13.1.2"><csymbol cd="ambiguous" id="alg2.13.m13.1.2.1.cmml" xref="alg2.13.m13.1.2">subscript</csymbol><apply id="alg2.13.m13.1.2.2.cmml" xref="alg2.13.m13.1.2"><csymbol cd="ambiguous" id="alg2.13.m13.1.2.2.1.cmml" xref="alg2.13.m13.1.2">superscript</csymbol><ci id="alg2.13.m13.1.2.2.2.cmml" xref="alg2.13.m13.1.2.2.2">𝑊</ci><ci id="alg2.13.m13.1.1.1.1.cmml" xref="alg2.13.m13.1.1.1.1">𝑠</ci></apply><apply id="alg2.13.m13.1.2.3.cmml" xref="alg2.13.m13.1.2.3"><plus id="alg2.13.m13.1.2.3.1.cmml" xref="alg2.13.m13.1.2.3.1"></plus><ci id="alg2.13.m13.1.2.3.2.cmml" xref="alg2.13.m13.1.2.3.2">𝑡</ci><cn type="integer" id="alg2.13.m13.1.2.3.3.cmml" xref="alg2.13.m13.1.2.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.13.m13.1c">W^{(s)}_{t+1}</annotation></semantics></math> 
<br class="ltx_break"><span id="alg2.13.4" class="ltx_text ltx_font_bold ltx_font_italic">Mediators</span>:</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg2.16" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math id="alg2.l1.m1.1" class="ltx_Math" alttext="\mathcal{B}^{(m)}\leftarrow" display="inline"><semantics id="alg2.l1.m1.1a"><mrow id="alg2.l1.m1.1.2" xref="alg2.l1.m1.1.2.cmml"><msup id="alg2.l1.m1.1.2.2" xref="alg2.l1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m1.1.2.2.2" xref="alg2.l1.m1.1.2.2.2.cmml">ℬ</mi><mrow id="alg2.l1.m1.1.1.1.3" xref="alg2.l1.m1.1.2.2.cmml"><mo stretchy="false" id="alg2.l1.m1.1.1.1.3.1" xref="alg2.l1.m1.1.2.2.cmml">(</mo><mi id="alg2.l1.m1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg2.l1.m1.1.1.1.3.2" xref="alg2.l1.m1.1.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg2.l1.m1.1.2.1" xref="alg2.l1.m1.1.2.1.cmml">←</mo><mi id="alg2.l1.m1.1.2.3" xref="alg2.l1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.2.cmml" xref="alg2.l1.m1.1.2"><ci id="alg2.l1.m1.1.2.1.cmml" xref="alg2.l1.m1.1.2.1">←</ci><apply id="alg2.l1.m1.1.2.2.cmml" xref="alg2.l1.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.1.2.2.1.cmml" xref="alg2.l1.m1.1.2.2">superscript</csymbol><ci id="alg2.l1.m1.1.2.2.2.cmml" xref="alg2.l1.m1.1.2.2.2">ℬ</ci><ci id="alg2.l1.m1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1">𝑚</ci></apply><csymbol cd="latexml" id="alg2.l1.m1.1.2.3.cmml" xref="alg2.l1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\mathcal{B}^{(m)}\leftarrow</annotation></semantics></math> Run-time data augmentation

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span id="alg2.l2.1" class="ltx_text ltx_font_bold">for</span> each <math id="alg2.l2.m1.1" class="ltx_Math" alttext="m\in\mathcal{M}\setminus\mathcal{AM}" display="inline"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">m</mi><mo id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">∈</mo><mrow id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.1.1.3.2" xref="alg2.l2.m1.1.1.3.2.cmml">ℳ</mi><mo id="alg2.l2.m1.1.1.3.1" xref="alg2.l2.m1.1.1.3.1.cmml">∖</mo><mrow id="alg2.l2.m1.1.1.3.3" xref="alg2.l2.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.1.1.3.3.2" xref="alg2.l2.m1.1.1.3.3.2.cmml">𝒜</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.1.1.3.3.1" xref="alg2.l2.m1.1.1.3.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.1.1.3.3.3" xref="alg2.l2.m1.1.1.3.3.3.cmml">ℳ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><in id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></in><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝑚</ci><apply id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3"><setdiff id="alg2.l2.m1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.3.1"></setdiff><ci id="alg2.l2.m1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.3.2">ℳ</ci><apply id="alg2.l2.m1.1.1.3.3.cmml" xref="alg2.l2.m1.1.1.3.3"><times id="alg2.l2.m1.1.1.3.3.1.cmml" xref="alg2.l2.m1.1.1.3.3.1"></times><ci id="alg2.l2.m1.1.1.3.3.2.cmml" xref="alg2.l2.m1.1.1.3.3.2">𝒜</ci><ci id="alg2.l2.m1.1.1.3.3.3.cmml" xref="alg2.l2.m1.1.1.3.3.3">ℳ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">m\in\mathcal{M}\setminus\mathcal{AM}</annotation></semantics></math> <span id="alg2.l2.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg2.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <span id="alg2.l3.1" class="ltx_text ltx_font_bold">for</span> each epoch <math id="alg2.l3.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l3.m1.1a"><mi id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><ci id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">i</annotation></semantics></math> from 1 to <math id="alg2.l3.m2.1" class="ltx_Math" alttext="\mathcal{I}" display="inline"><semantics id="alg2.l3.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><ci id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">\mathcal{I}</annotation></semantics></math> <span id="alg2.l3.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>        <math id="alg2.l4.m1.7" class="ltx_Math" alttext="W^{(m)}_{t}\leftarrow W^{(m)}_{t}-\eta\nabla_{W^{(m)}_{t}}\ell(W^{(m)}_{t}\mathcal{B}^{(m)},y)" display="inline"><semantics id="alg2.l4.m1.7a"><mrow id="alg2.l4.m1.7.7" xref="alg2.l4.m1.7.7.cmml"><msubsup id="alg2.l4.m1.7.7.3" xref="alg2.l4.m1.7.7.3.cmml"><mi id="alg2.l4.m1.7.7.3.2.2" xref="alg2.l4.m1.7.7.3.2.2.cmml">W</mi><mi id="alg2.l4.m1.7.7.3.3" xref="alg2.l4.m1.7.7.3.3.cmml">t</mi><mrow id="alg2.l4.m1.1.1.1.3" xref="alg2.l4.m1.7.7.3.cmml"><mo stretchy="false" id="alg2.l4.m1.1.1.1.3.1" xref="alg2.l4.m1.7.7.3.cmml">(</mo><mi id="alg2.l4.m1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg2.l4.m1.1.1.1.3.2" xref="alg2.l4.m1.7.7.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg2.l4.m1.7.7.2" xref="alg2.l4.m1.7.7.2.cmml">←</mo><mrow id="alg2.l4.m1.7.7.1" xref="alg2.l4.m1.7.7.1.cmml"><msubsup id="alg2.l4.m1.7.7.1.3" xref="alg2.l4.m1.7.7.1.3.cmml"><mi id="alg2.l4.m1.7.7.1.3.2.2" xref="alg2.l4.m1.7.7.1.3.2.2.cmml">W</mi><mi id="alg2.l4.m1.7.7.1.3.3" xref="alg2.l4.m1.7.7.1.3.3.cmml">t</mi><mrow id="alg2.l4.m1.2.2.1.3" xref="alg2.l4.m1.7.7.1.3.cmml"><mo stretchy="false" id="alg2.l4.m1.2.2.1.3.1" xref="alg2.l4.m1.7.7.1.3.cmml">(</mo><mi id="alg2.l4.m1.2.2.1.1" xref="alg2.l4.m1.2.2.1.1.cmml">m</mi><mo stretchy="false" id="alg2.l4.m1.2.2.1.3.2" xref="alg2.l4.m1.7.7.1.3.cmml">)</mo></mrow></msubsup><mo id="alg2.l4.m1.7.7.1.2" xref="alg2.l4.m1.7.7.1.2.cmml">−</mo><mrow id="alg2.l4.m1.7.7.1.1" xref="alg2.l4.m1.7.7.1.1.cmml"><mi id="alg2.l4.m1.7.7.1.1.3" xref="alg2.l4.m1.7.7.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg2.l4.m1.7.7.1.1.2" xref="alg2.l4.m1.7.7.1.1.2.cmml">​</mo><mrow id="alg2.l4.m1.7.7.1.1.4" xref="alg2.l4.m1.7.7.1.1.4.cmml"><msub id="alg2.l4.m1.7.7.1.1.4.1" xref="alg2.l4.m1.7.7.1.1.4.1.cmml"><mo rspace="0.167em" id="alg2.l4.m1.7.7.1.1.4.1.2" xref="alg2.l4.m1.7.7.1.1.4.1.2.cmml">∇</mo><msubsup id="alg2.l4.m1.3.3.1" xref="alg2.l4.m1.3.3.1.cmml"><mi id="alg2.l4.m1.3.3.1.3.2" xref="alg2.l4.m1.3.3.1.3.2.cmml">W</mi><mi id="alg2.l4.m1.3.3.1.4" xref="alg2.l4.m1.3.3.1.4.cmml">t</mi><mrow id="alg2.l4.m1.3.3.1.1.1.3" xref="alg2.l4.m1.3.3.1.cmml"><mo stretchy="false" id="alg2.l4.m1.3.3.1.1.1.3.1" xref="alg2.l4.m1.3.3.1.cmml">(</mo><mi id="alg2.l4.m1.3.3.1.1.1.1" xref="alg2.l4.m1.3.3.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg2.l4.m1.3.3.1.1.1.3.2" xref="alg2.l4.m1.3.3.1.cmml">)</mo></mrow></msubsup></msub><mi mathvariant="normal" id="alg2.l4.m1.7.7.1.1.4.2" xref="alg2.l4.m1.7.7.1.1.4.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l4.m1.7.7.1.1.2a" xref="alg2.l4.m1.7.7.1.1.2.cmml">​</mo><mrow id="alg2.l4.m1.7.7.1.1.1.1" xref="alg2.l4.m1.7.7.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l4.m1.7.7.1.1.1.1.2" xref="alg2.l4.m1.7.7.1.1.1.2.cmml">(</mo><mrow id="alg2.l4.m1.7.7.1.1.1.1.1" xref="alg2.l4.m1.7.7.1.1.1.1.1.cmml"><msubsup id="alg2.l4.m1.7.7.1.1.1.1.1.2" xref="alg2.l4.m1.7.7.1.1.1.1.1.2.cmml"><mi id="alg2.l4.m1.7.7.1.1.1.1.1.2.2.2" xref="alg2.l4.m1.7.7.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="alg2.l4.m1.7.7.1.1.1.1.1.2.3" xref="alg2.l4.m1.7.7.1.1.1.1.1.2.3.cmml">t</mi><mrow id="alg2.l4.m1.4.4.1.3" xref="alg2.l4.m1.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l4.m1.4.4.1.3.1" xref="alg2.l4.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mi id="alg2.l4.m1.4.4.1.1" xref="alg2.l4.m1.4.4.1.1.cmml">m</mi><mo stretchy="false" id="alg2.l4.m1.4.4.1.3.2" xref="alg2.l4.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg2.l4.m1.7.7.1.1.1.1.1.1" xref="alg2.l4.m1.7.7.1.1.1.1.1.1.cmml">​</mo><msup id="alg2.l4.m1.7.7.1.1.1.1.1.3" xref="alg2.l4.m1.7.7.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.7.7.1.1.1.1.1.3.2" xref="alg2.l4.m1.7.7.1.1.1.1.1.3.2.cmml">ℬ</mi><mrow id="alg2.l4.m1.5.5.1.3" xref="alg2.l4.m1.7.7.1.1.1.1.1.3.cmml"><mo stretchy="false" id="alg2.l4.m1.5.5.1.3.1" xref="alg2.l4.m1.7.7.1.1.1.1.1.3.cmml">(</mo><mi id="alg2.l4.m1.5.5.1.1" xref="alg2.l4.m1.5.5.1.1.cmml">m</mi><mo stretchy="false" id="alg2.l4.m1.5.5.1.3.2" xref="alg2.l4.m1.7.7.1.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="alg2.l4.m1.7.7.1.1.1.1.3" xref="alg2.l4.m1.7.7.1.1.1.2.cmml">,</mo><mi id="alg2.l4.m1.6.6" xref="alg2.l4.m1.6.6.cmml">y</mi><mo stretchy="false" id="alg2.l4.m1.7.7.1.1.1.1.4" xref="alg2.l4.m1.7.7.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.7b"><apply id="alg2.l4.m1.7.7.cmml" xref="alg2.l4.m1.7.7"><ci id="alg2.l4.m1.7.7.2.cmml" xref="alg2.l4.m1.7.7.2">←</ci><apply id="alg2.l4.m1.7.7.3.cmml" xref="alg2.l4.m1.7.7.3"><csymbol cd="ambiguous" id="alg2.l4.m1.7.7.3.1.cmml" xref="alg2.l4.m1.7.7.3">subscript</csymbol><apply id="alg2.l4.m1.7.7.3.2.cmml" xref="alg2.l4.m1.7.7.3"><csymbol cd="ambiguous" id="alg2.l4.m1.7.7.3.2.1.cmml" xref="alg2.l4.m1.7.7.3">superscript</csymbol><ci id="alg2.l4.m1.7.7.3.2.2.cmml" xref="alg2.l4.m1.7.7.3.2.2">𝑊</ci><ci id="alg2.l4.m1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1">𝑚</ci></apply><ci id="alg2.l4.m1.7.7.3.3.cmml" xref="alg2.l4.m1.7.7.3.3">𝑡</ci></apply><apply id="alg2.l4.m1.7.7.1.cmml" xref="alg2.l4.m1.7.7.1"><minus id="alg2.l4.m1.7.7.1.2.cmml" xref="alg2.l4.m1.7.7.1.2"></minus><apply id="alg2.l4.m1.7.7.1.3.cmml" xref="alg2.l4.m1.7.7.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.7.7.1.3.1.cmml" xref="alg2.l4.m1.7.7.1.3">subscript</csymbol><apply id="alg2.l4.m1.7.7.1.3.2.cmml" xref="alg2.l4.m1.7.7.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.7.7.1.3.2.1.cmml" xref="alg2.l4.m1.7.7.1.3">superscript</csymbol><ci id="alg2.l4.m1.7.7.1.3.2.2.cmml" xref="alg2.l4.m1.7.7.1.3.2.2">𝑊</ci><ci id="alg2.l4.m1.2.2.1.1.cmml" xref="alg2.l4.m1.2.2.1.1">𝑚</ci></apply><ci id="alg2.l4.m1.7.7.1.3.3.cmml" xref="alg2.l4.m1.7.7.1.3.3">𝑡</ci></apply><apply id="alg2.l4.m1.7.7.1.1.cmml" xref="alg2.l4.m1.7.7.1.1"><times id="alg2.l4.m1.7.7.1.1.2.cmml" xref="alg2.l4.m1.7.7.1.1.2"></times><ci id="alg2.l4.m1.7.7.1.1.3.cmml" xref="alg2.l4.m1.7.7.1.1.3">𝜂</ci><apply id="alg2.l4.m1.7.7.1.1.4.cmml" xref="alg2.l4.m1.7.7.1.1.4"><apply id="alg2.l4.m1.7.7.1.1.4.1.cmml" xref="alg2.l4.m1.7.7.1.1.4.1"><csymbol cd="ambiguous" id="alg2.l4.m1.7.7.1.1.4.1.1.cmml" xref="alg2.l4.m1.7.7.1.1.4.1">subscript</csymbol><ci id="alg2.l4.m1.7.7.1.1.4.1.2.cmml" xref="alg2.l4.m1.7.7.1.1.4.1.2">∇</ci><apply id="alg2.l4.m1.3.3.1.cmml" xref="alg2.l4.m1.3.3.1"><csymbol cd="ambiguous" id="alg2.l4.m1.3.3.1.2.cmml" xref="alg2.l4.m1.3.3.1">subscript</csymbol><apply id="alg2.l4.m1.3.3.1.3.cmml" xref="alg2.l4.m1.3.3.1"><csymbol cd="ambiguous" id="alg2.l4.m1.3.3.1.3.1.cmml" xref="alg2.l4.m1.3.3.1">superscript</csymbol><ci id="alg2.l4.m1.3.3.1.3.2.cmml" xref="alg2.l4.m1.3.3.1.3.2">𝑊</ci><ci id="alg2.l4.m1.3.3.1.1.1.1.cmml" xref="alg2.l4.m1.3.3.1.1.1.1">𝑚</ci></apply><ci id="alg2.l4.m1.3.3.1.4.cmml" xref="alg2.l4.m1.3.3.1.4">𝑡</ci></apply></apply><ci id="alg2.l4.m1.7.7.1.1.4.2.cmml" xref="alg2.l4.m1.7.7.1.1.4.2">ℓ</ci></apply><interval closure="open" id="alg2.l4.m1.7.7.1.1.1.2.cmml" xref="alg2.l4.m1.7.7.1.1.1.1"><apply id="alg2.l4.m1.7.7.1.1.1.1.1.cmml" xref="alg2.l4.m1.7.7.1.1.1.1.1"><times id="alg2.l4.m1.7.7.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.7.7.1.1.1.1.1.1"></times><apply id="alg2.l4.m1.7.7.1.1.1.1.1.2.cmml" xref="alg2.l4.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m1.7.7.1.1.1.1.1.2.1.cmml" xref="alg2.l4.m1.7.7.1.1.1.1.1.2">subscript</csymbol><apply id="alg2.l4.m1.7.7.1.1.1.1.1.2.2.cmml" xref="alg2.l4.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m1.7.7.1.1.1.1.1.2.2.1.cmml" xref="alg2.l4.m1.7.7.1.1.1.1.1.2">superscript</csymbol><ci id="alg2.l4.m1.7.7.1.1.1.1.1.2.2.2.cmml" xref="alg2.l4.m1.7.7.1.1.1.1.1.2.2.2">𝑊</ci><ci id="alg2.l4.m1.4.4.1.1.cmml" xref="alg2.l4.m1.4.4.1.1">𝑚</ci></apply><ci id="alg2.l4.m1.7.7.1.1.1.1.1.2.3.cmml" xref="alg2.l4.m1.7.7.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="alg2.l4.m1.7.7.1.1.1.1.1.3.cmml" xref="alg2.l4.m1.7.7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.7.7.1.1.1.1.1.3.1.cmml" xref="alg2.l4.m1.7.7.1.1.1.1.1.3">superscript</csymbol><ci id="alg2.l4.m1.7.7.1.1.1.1.1.3.2.cmml" xref="alg2.l4.m1.7.7.1.1.1.1.1.3.2">ℬ</ci><ci id="alg2.l4.m1.5.5.1.1.cmml" xref="alg2.l4.m1.5.5.1.1">𝑚</ci></apply></apply><ci id="alg2.l4.m1.6.6.cmml" xref="alg2.l4.m1.6.6">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.7c">W^{(m)}_{t}\leftarrow W^{(m)}_{t}-\eta\nabla_{W^{(m)}_{t}}\ell(W^{(m)}_{t}\mathcal{B}^{(m)},y)</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <span id="alg2.l5.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l5.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math id="alg2.l6.m1.6" class="ltx_Math" alttext="d\mathcal{B}^{(m)}\leftarrow\nabla_{\mathcal{B}^{(m)}}\ell(W^{(m)}_{t}\mathcal{B}^{(m)},y)" display="inline"><semantics id="alg2.l6.m1.6a"><mrow id="alg2.l6.m1.6.6" xref="alg2.l6.m1.6.6.cmml"><mrow id="alg2.l6.m1.6.6.3" xref="alg2.l6.m1.6.6.3.cmml"><mi id="alg2.l6.m1.6.6.3.2" xref="alg2.l6.m1.6.6.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.6.6.3.1" xref="alg2.l6.m1.6.6.3.1.cmml">​</mo><msup id="alg2.l6.m1.6.6.3.3" xref="alg2.l6.m1.6.6.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.6.6.3.3.2" xref="alg2.l6.m1.6.6.3.3.2.cmml">ℬ</mi><mrow id="alg2.l6.m1.1.1.1.3" xref="alg2.l6.m1.6.6.3.3.cmml"><mo stretchy="false" id="alg2.l6.m1.1.1.1.3.1" xref="alg2.l6.m1.6.6.3.3.cmml">(</mo><mi id="alg2.l6.m1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg2.l6.m1.1.1.1.3.2" xref="alg2.l6.m1.6.6.3.3.cmml">)</mo></mrow></msup></mrow><mo stretchy="false" id="alg2.l6.m1.6.6.2" xref="alg2.l6.m1.6.6.2.cmml">←</mo><mrow id="alg2.l6.m1.6.6.1" xref="alg2.l6.m1.6.6.1.cmml"><mrow id="alg2.l6.m1.6.6.1.3" xref="alg2.l6.m1.6.6.1.3.cmml"><msub id="alg2.l6.m1.6.6.1.3.1" xref="alg2.l6.m1.6.6.1.3.1.cmml"><mo rspace="0.167em" id="alg2.l6.m1.6.6.1.3.1.2" xref="alg2.l6.m1.6.6.1.3.1.2.cmml">∇</mo><msup id="alg2.l6.m1.2.2.1" xref="alg2.l6.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.2.2.1.3" xref="alg2.l6.m1.2.2.1.3.cmml">ℬ</mi><mrow id="alg2.l6.m1.2.2.1.1.1.3" xref="alg2.l6.m1.2.2.1.cmml"><mo stretchy="false" id="alg2.l6.m1.2.2.1.1.1.3.1" xref="alg2.l6.m1.2.2.1.cmml">(</mo><mi id="alg2.l6.m1.2.2.1.1.1.1" xref="alg2.l6.m1.2.2.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg2.l6.m1.2.2.1.1.1.3.2" xref="alg2.l6.m1.2.2.1.cmml">)</mo></mrow></msup></msub><mi mathvariant="normal" id="alg2.l6.m1.6.6.1.3.2" xref="alg2.l6.m1.6.6.1.3.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l6.m1.6.6.1.2" xref="alg2.l6.m1.6.6.1.2.cmml">​</mo><mrow id="alg2.l6.m1.6.6.1.1.1" xref="alg2.l6.m1.6.6.1.1.2.cmml"><mo stretchy="false" id="alg2.l6.m1.6.6.1.1.1.2" xref="alg2.l6.m1.6.6.1.1.2.cmml">(</mo><mrow id="alg2.l6.m1.6.6.1.1.1.1" xref="alg2.l6.m1.6.6.1.1.1.1.cmml"><msubsup id="alg2.l6.m1.6.6.1.1.1.1.2" xref="alg2.l6.m1.6.6.1.1.1.1.2.cmml"><mi id="alg2.l6.m1.6.6.1.1.1.1.2.2.2" xref="alg2.l6.m1.6.6.1.1.1.1.2.2.2.cmml">W</mi><mi id="alg2.l6.m1.6.6.1.1.1.1.2.3" xref="alg2.l6.m1.6.6.1.1.1.1.2.3.cmml">t</mi><mrow id="alg2.l6.m1.3.3.1.3" xref="alg2.l6.m1.6.6.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l6.m1.3.3.1.3.1" xref="alg2.l6.m1.6.6.1.1.1.1.2.cmml">(</mo><mi id="alg2.l6.m1.3.3.1.1" xref="alg2.l6.m1.3.3.1.1.cmml">m</mi><mo stretchy="false" id="alg2.l6.m1.3.3.1.3.2" xref="alg2.l6.m1.6.6.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg2.l6.m1.6.6.1.1.1.1.1" xref="alg2.l6.m1.6.6.1.1.1.1.1.cmml">​</mo><msup id="alg2.l6.m1.6.6.1.1.1.1.3" xref="alg2.l6.m1.6.6.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.6.6.1.1.1.1.3.2" xref="alg2.l6.m1.6.6.1.1.1.1.3.2.cmml">ℬ</mi><mrow id="alg2.l6.m1.4.4.1.3" xref="alg2.l6.m1.6.6.1.1.1.1.3.cmml"><mo stretchy="false" id="alg2.l6.m1.4.4.1.3.1" xref="alg2.l6.m1.6.6.1.1.1.1.3.cmml">(</mo><mi id="alg2.l6.m1.4.4.1.1" xref="alg2.l6.m1.4.4.1.1.cmml">m</mi><mo stretchy="false" id="alg2.l6.m1.4.4.1.3.2" xref="alg2.l6.m1.6.6.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="alg2.l6.m1.6.6.1.1.1.3" xref="alg2.l6.m1.6.6.1.1.2.cmml">,</mo><mi id="alg2.l6.m1.5.5" xref="alg2.l6.m1.5.5.cmml">y</mi><mo stretchy="false" id="alg2.l6.m1.6.6.1.1.1.4" xref="alg2.l6.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.6b"><apply id="alg2.l6.m1.6.6.cmml" xref="alg2.l6.m1.6.6"><ci id="alg2.l6.m1.6.6.2.cmml" xref="alg2.l6.m1.6.6.2">←</ci><apply id="alg2.l6.m1.6.6.3.cmml" xref="alg2.l6.m1.6.6.3"><times id="alg2.l6.m1.6.6.3.1.cmml" xref="alg2.l6.m1.6.6.3.1"></times><ci id="alg2.l6.m1.6.6.3.2.cmml" xref="alg2.l6.m1.6.6.3.2">𝑑</ci><apply id="alg2.l6.m1.6.6.3.3.cmml" xref="alg2.l6.m1.6.6.3.3"><csymbol cd="ambiguous" id="alg2.l6.m1.6.6.3.3.1.cmml" xref="alg2.l6.m1.6.6.3.3">superscript</csymbol><ci id="alg2.l6.m1.6.6.3.3.2.cmml" xref="alg2.l6.m1.6.6.3.3.2">ℬ</ci><ci id="alg2.l6.m1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1">𝑚</ci></apply></apply><apply id="alg2.l6.m1.6.6.1.cmml" xref="alg2.l6.m1.6.6.1"><times id="alg2.l6.m1.6.6.1.2.cmml" xref="alg2.l6.m1.6.6.1.2"></times><apply id="alg2.l6.m1.6.6.1.3.cmml" xref="alg2.l6.m1.6.6.1.3"><apply id="alg2.l6.m1.6.6.1.3.1.cmml" xref="alg2.l6.m1.6.6.1.3.1"><csymbol cd="ambiguous" id="alg2.l6.m1.6.6.1.3.1.1.cmml" xref="alg2.l6.m1.6.6.1.3.1">subscript</csymbol><ci id="alg2.l6.m1.6.6.1.3.1.2.cmml" xref="alg2.l6.m1.6.6.1.3.1.2">∇</ci><apply id="alg2.l6.m1.2.2.1.cmml" xref="alg2.l6.m1.2.2.1"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.1.2.cmml" xref="alg2.l6.m1.2.2.1">superscript</csymbol><ci id="alg2.l6.m1.2.2.1.3.cmml" xref="alg2.l6.m1.2.2.1.3">ℬ</ci><ci id="alg2.l6.m1.2.2.1.1.1.1.cmml" xref="alg2.l6.m1.2.2.1.1.1.1">𝑚</ci></apply></apply><ci id="alg2.l6.m1.6.6.1.3.2.cmml" xref="alg2.l6.m1.6.6.1.3.2">ℓ</ci></apply><interval closure="open" id="alg2.l6.m1.6.6.1.1.2.cmml" xref="alg2.l6.m1.6.6.1.1.1"><apply id="alg2.l6.m1.6.6.1.1.1.1.cmml" xref="alg2.l6.m1.6.6.1.1.1.1"><times id="alg2.l6.m1.6.6.1.1.1.1.1.cmml" xref="alg2.l6.m1.6.6.1.1.1.1.1"></times><apply id="alg2.l6.m1.6.6.1.1.1.1.2.cmml" xref="alg2.l6.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l6.m1.6.6.1.1.1.1.2.1.cmml" xref="alg2.l6.m1.6.6.1.1.1.1.2">subscript</csymbol><apply id="alg2.l6.m1.6.6.1.1.1.1.2.2.cmml" xref="alg2.l6.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l6.m1.6.6.1.1.1.1.2.2.1.cmml" xref="alg2.l6.m1.6.6.1.1.1.1.2">superscript</csymbol><ci id="alg2.l6.m1.6.6.1.1.1.1.2.2.2.cmml" xref="alg2.l6.m1.6.6.1.1.1.1.2.2.2">𝑊</ci><ci id="alg2.l6.m1.3.3.1.1.cmml" xref="alg2.l6.m1.3.3.1.1">𝑚</ci></apply><ci id="alg2.l6.m1.6.6.1.1.1.1.2.3.cmml" xref="alg2.l6.m1.6.6.1.1.1.1.2.3">𝑡</ci></apply><apply id="alg2.l6.m1.6.6.1.1.1.1.3.cmml" xref="alg2.l6.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l6.m1.6.6.1.1.1.1.3.1.cmml" xref="alg2.l6.m1.6.6.1.1.1.1.3">superscript</csymbol><ci id="alg2.l6.m1.6.6.1.1.1.1.3.2.cmml" xref="alg2.l6.m1.6.6.1.1.1.1.3.2">ℬ</ci><ci id="alg2.l6.m1.4.4.1.1.cmml" xref="alg2.l6.m1.4.4.1.1">𝑚</ci></apply></apply><ci id="alg2.l6.m1.5.5.cmml" xref="alg2.l6.m1.5.5">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.6c">d\mathcal{B}^{(m)}\leftarrow\nabla_{\mathcal{B}^{(m)}}\ell(W^{(m)}_{t}\mathcal{B}^{(m)},y)</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <span id="alg2.l7.1" class="ltx_text ltx_font_bold">for</span> each <math id="alg2.l7.m1.1" class="ltx_Math" alttext="c\in m" display="inline"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><mi id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">c</mi><mo id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml">∈</mo><mi id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><in id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1"></in><ci id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2">𝑐</ci><ci id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">c\in m</annotation></semantics></math> <span id="alg2.l7.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>        <math id="alg2.l8.m1.3" class="ltx_math_unparsed" alttext="d\mathcal{B}^{(c)}\leftarrow d\mathcal{B}^{(m)}[:n^{(c)}]" display="inline"><semantics id="alg2.l8.m1.3a"><mrow id="alg2.l8.m1.3b"><mi id="alg2.l8.m1.3.4">d</mi><msup id="alg2.l8.m1.3.5"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.3.5.2">ℬ</mi><mrow id="alg2.l8.m1.1.1.1.3"><mo stretchy="false" id="alg2.l8.m1.1.1.1.3.1">(</mo><mi id="alg2.l8.m1.1.1.1.1">c</mi><mo stretchy="false" id="alg2.l8.m1.1.1.1.3.2">)</mo></mrow></msup><mo stretchy="false" id="alg2.l8.m1.3.6">←</mo><mi id="alg2.l8.m1.3.7">d</mi><msup id="alg2.l8.m1.3.8"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.3.8.2">ℬ</mi><mrow id="alg2.l8.m1.2.2.1.3"><mo stretchy="false" id="alg2.l8.m1.2.2.1.3.1">(</mo><mi id="alg2.l8.m1.2.2.1.1">m</mi><mo stretchy="false" id="alg2.l8.m1.2.2.1.3.2">)</mo></mrow></msup><mrow id="alg2.l8.m1.3.9"><mo stretchy="false" id="alg2.l8.m1.3.9.1">[</mo><mo rspace="0.278em" id="alg2.l8.m1.3.9.2">:</mo><msup id="alg2.l8.m1.3.9.3"><mi id="alg2.l8.m1.3.9.3.2">n</mi><mrow id="alg2.l8.m1.3.3.1.3"><mo stretchy="false" id="alg2.l8.m1.3.3.1.3.1">(</mo><mi id="alg2.l8.m1.3.3.1.1">c</mi><mo stretchy="false" id="alg2.l8.m1.3.3.1.3.2">)</mo></mrow></msup><mo stretchy="false" id="alg2.l8.m1.3.9.4">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg2.l8.m1.3c">d\mathcal{B}^{(c)}\leftarrow d\mathcal{B}^{(m)}[:n^{(c)}]</annotation></semantics></math>

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>        <math id="alg2.l9.m1.3" class="ltx_math_unparsed" alttext="d\mathcal{B}^{(m)}\leftarrow d\mathcal{B}^{(m)}[n^{(c)}:]" display="inline"><semantics id="alg2.l9.m1.3a"><mrow id="alg2.l9.m1.3b"><mi id="alg2.l9.m1.3.4">d</mi><msup id="alg2.l9.m1.3.5"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.3.5.2">ℬ</mi><mrow id="alg2.l9.m1.1.1.1.3"><mo stretchy="false" id="alg2.l9.m1.1.1.1.3.1">(</mo><mi id="alg2.l9.m1.1.1.1.1">m</mi><mo stretchy="false" id="alg2.l9.m1.1.1.1.3.2">)</mo></mrow></msup><mo stretchy="false" id="alg2.l9.m1.3.6">←</mo><mi id="alg2.l9.m1.3.7">d</mi><msup id="alg2.l9.m1.3.8"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.3.8.2">ℬ</mi><mrow id="alg2.l9.m1.2.2.1.3"><mo stretchy="false" id="alg2.l9.m1.2.2.1.3.1">(</mo><mi id="alg2.l9.m1.2.2.1.1">m</mi><mo stretchy="false" id="alg2.l9.m1.2.2.1.3.2">)</mo></mrow></msup><mrow id="alg2.l9.m1.3.9"><mo stretchy="false" id="alg2.l9.m1.3.9.1">[</mo><msup id="alg2.l9.m1.3.9.2"><mi id="alg2.l9.m1.3.9.2.2">n</mi><mrow id="alg2.l9.m1.3.3.1.3"><mo stretchy="false" id="alg2.l9.m1.3.3.1.3.1">(</mo><mi id="alg2.l9.m1.3.3.1.1">c</mi><mo stretchy="false" id="alg2.l9.m1.3.3.1.3.2">)</mo></mrow></msup><mo lspace="0.278em" rspace="0em" id="alg2.l9.m1.3.9.3">:</mo><mo stretchy="false" id="alg2.l9.m1.3.9.4">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg2.l9.m1.3c">d\mathcal{B}^{(m)}\leftarrow d\mathcal{B}^{(m)}[n^{(c)}:]</annotation></semantics></math>

</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <span id="alg2.l10.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l10.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>  <span id="alg2.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.17" class="ltx_p ltx_figure_panel"><span id="alg2.17.1" class="ltx_text ltx_font_bold ltx_font_italic">Clients</span>:</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg2.18" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg2.l1a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span id="alg2.l1a.1" class="ltx_text ltx_font_bold">for</span> each <math id="alg2.l1a.m1.1" class="ltx_Math" alttext="c\in\mathcal{U}^{t}" display="inline"><semantics id="alg2.l1a.m1.1a"><mrow id="alg2.l1a.m1.1.1" xref="alg2.l1a.m1.1.1.cmml"><mi id="alg2.l1a.m1.1.1.2" xref="alg2.l1a.m1.1.1.2.cmml">c</mi><mo id="alg2.l1a.m1.1.1.1" xref="alg2.l1a.m1.1.1.1.cmml">∈</mo><msup id="alg2.l1a.m1.1.1.3" xref="alg2.l1a.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1a.m1.1.1.3.2" xref="alg2.l1a.m1.1.1.3.2.cmml">𝒰</mi><mi id="alg2.l1a.m1.1.1.3.3" xref="alg2.l1a.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1a.m1.1b"><apply id="alg2.l1a.m1.1.1.cmml" xref="alg2.l1a.m1.1.1"><in id="alg2.l1a.m1.1.1.1.cmml" xref="alg2.l1a.m1.1.1.1"></in><ci id="alg2.l1a.m1.1.1.2.cmml" xref="alg2.l1a.m1.1.1.2">𝑐</ci><apply id="alg2.l1a.m1.1.1.3.cmml" xref="alg2.l1a.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l1a.m1.1.1.3.1.cmml" xref="alg2.l1a.m1.1.1.3">superscript</csymbol><ci id="alg2.l1a.m1.1.1.3.2.cmml" xref="alg2.l1a.m1.1.1.3.2">𝒰</ci><ci id="alg2.l1a.m1.1.1.3.3.cmml" xref="alg2.l1a.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1a.m1.1c">c\in\mathcal{U}^{t}</annotation></semantics></math> <span id="alg2.l1a.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg2.l1a.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l2a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>     <math id="alg2.l2a.m1.5" class="ltx_Math" alttext="\mathcal{B}^{(c)}\leftarrow U_{\mathcal{O}}^{(c)}D_{k}^{(c)}U_{\mathcal{O}}^{(c)T}\mathcal{O}^{(c)}" display="inline"><semantics id="alg2.l2a.m1.5a"><mrow id="alg2.l2a.m1.5.6" xref="alg2.l2a.m1.5.6.cmml"><msup id="alg2.l2a.m1.5.6.2" xref="alg2.l2a.m1.5.6.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l2a.m1.5.6.2.2" xref="alg2.l2a.m1.5.6.2.2.cmml">ℬ</mi><mrow id="alg2.l2a.m1.1.1.1.3" xref="alg2.l2a.m1.5.6.2.cmml"><mo stretchy="false" id="alg2.l2a.m1.1.1.1.3.1" xref="alg2.l2a.m1.5.6.2.cmml">(</mo><mi id="alg2.l2a.m1.1.1.1.1" xref="alg2.l2a.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l2a.m1.1.1.1.3.2" xref="alg2.l2a.m1.5.6.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg2.l2a.m1.5.6.1" xref="alg2.l2a.m1.5.6.1.cmml">←</mo><mrow id="alg2.l2a.m1.5.6.3" xref="alg2.l2a.m1.5.6.3.cmml"><msubsup id="alg2.l2a.m1.5.6.3.2" xref="alg2.l2a.m1.5.6.3.2.cmml"><mi id="alg2.l2a.m1.5.6.3.2.2.2" xref="alg2.l2a.m1.5.6.3.2.2.2.cmml">U</mi><mi class="ltx_font_mathcaligraphic" id="alg2.l2a.m1.5.6.3.2.2.3" xref="alg2.l2a.m1.5.6.3.2.2.3.cmml">𝒪</mi><mrow id="alg2.l2a.m1.2.2.1.3" xref="alg2.l2a.m1.5.6.3.2.cmml"><mo stretchy="false" id="alg2.l2a.m1.2.2.1.3.1" xref="alg2.l2a.m1.5.6.3.2.cmml">(</mo><mi id="alg2.l2a.m1.2.2.1.1" xref="alg2.l2a.m1.2.2.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l2a.m1.2.2.1.3.2" xref="alg2.l2a.m1.5.6.3.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg2.l2a.m1.5.6.3.1" xref="alg2.l2a.m1.5.6.3.1.cmml">​</mo><msubsup id="alg2.l2a.m1.5.6.3.3" xref="alg2.l2a.m1.5.6.3.3.cmml"><mi id="alg2.l2a.m1.5.6.3.3.2.2" xref="alg2.l2a.m1.5.6.3.3.2.2.cmml">D</mi><mi id="alg2.l2a.m1.5.6.3.3.2.3" xref="alg2.l2a.m1.5.6.3.3.2.3.cmml">k</mi><mrow id="alg2.l2a.m1.3.3.1.3" xref="alg2.l2a.m1.5.6.3.3.cmml"><mo stretchy="false" id="alg2.l2a.m1.3.3.1.3.1" xref="alg2.l2a.m1.5.6.3.3.cmml">(</mo><mi id="alg2.l2a.m1.3.3.1.1" xref="alg2.l2a.m1.3.3.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l2a.m1.3.3.1.3.2" xref="alg2.l2a.m1.5.6.3.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg2.l2a.m1.5.6.3.1a" xref="alg2.l2a.m1.5.6.3.1.cmml">​</mo><msubsup id="alg2.l2a.m1.5.6.3.4" xref="alg2.l2a.m1.5.6.3.4.cmml"><mi id="alg2.l2a.m1.5.6.3.4.2.2" xref="alg2.l2a.m1.5.6.3.4.2.2.cmml">U</mi><mi class="ltx_font_mathcaligraphic" id="alg2.l2a.m1.5.6.3.4.2.3" xref="alg2.l2a.m1.5.6.3.4.2.3.cmml">𝒪</mi><mrow id="alg2.l2a.m1.4.4.1" xref="alg2.l2a.m1.4.4.1.cmml"><mrow id="alg2.l2a.m1.4.4.1.3.2" xref="alg2.l2a.m1.4.4.1.cmml"><mo stretchy="false" id="alg2.l2a.m1.4.4.1.3.2.1" xref="alg2.l2a.m1.4.4.1.cmml">(</mo><mi id="alg2.l2a.m1.4.4.1.1" xref="alg2.l2a.m1.4.4.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l2a.m1.4.4.1.3.2.2" xref="alg2.l2a.m1.4.4.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg2.l2a.m1.4.4.1.2" xref="alg2.l2a.m1.4.4.1.2.cmml">​</mo><mi id="alg2.l2a.m1.4.4.1.4" xref="alg2.l2a.m1.4.4.1.4.cmml">T</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg2.l2a.m1.5.6.3.1b" xref="alg2.l2a.m1.5.6.3.1.cmml">​</mo><msup id="alg2.l2a.m1.5.6.3.5" xref="alg2.l2a.m1.5.6.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l2a.m1.5.6.3.5.2" xref="alg2.l2a.m1.5.6.3.5.2.cmml">𝒪</mi><mrow id="alg2.l2a.m1.5.5.1.3" xref="alg2.l2a.m1.5.6.3.5.cmml"><mo stretchy="false" id="alg2.l2a.m1.5.5.1.3.1" xref="alg2.l2a.m1.5.6.3.5.cmml">(</mo><mi id="alg2.l2a.m1.5.5.1.1" xref="alg2.l2a.m1.5.5.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l2a.m1.5.5.1.3.2" xref="alg2.l2a.m1.5.6.3.5.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2a.m1.5b"><apply id="alg2.l2a.m1.5.6.cmml" xref="alg2.l2a.m1.5.6"><ci id="alg2.l2a.m1.5.6.1.cmml" xref="alg2.l2a.m1.5.6.1">←</ci><apply id="alg2.l2a.m1.5.6.2.cmml" xref="alg2.l2a.m1.5.6.2"><csymbol cd="ambiguous" id="alg2.l2a.m1.5.6.2.1.cmml" xref="alg2.l2a.m1.5.6.2">superscript</csymbol><ci id="alg2.l2a.m1.5.6.2.2.cmml" xref="alg2.l2a.m1.5.6.2.2">ℬ</ci><ci id="alg2.l2a.m1.1.1.1.1.cmml" xref="alg2.l2a.m1.1.1.1.1">𝑐</ci></apply><apply id="alg2.l2a.m1.5.6.3.cmml" xref="alg2.l2a.m1.5.6.3"><times id="alg2.l2a.m1.5.6.3.1.cmml" xref="alg2.l2a.m1.5.6.3.1"></times><apply id="alg2.l2a.m1.5.6.3.2.cmml" xref="alg2.l2a.m1.5.6.3.2"><csymbol cd="ambiguous" id="alg2.l2a.m1.5.6.3.2.1.cmml" xref="alg2.l2a.m1.5.6.3.2">superscript</csymbol><apply id="alg2.l2a.m1.5.6.3.2.2.cmml" xref="alg2.l2a.m1.5.6.3.2"><csymbol cd="ambiguous" id="alg2.l2a.m1.5.6.3.2.2.1.cmml" xref="alg2.l2a.m1.5.6.3.2">subscript</csymbol><ci id="alg2.l2a.m1.5.6.3.2.2.2.cmml" xref="alg2.l2a.m1.5.6.3.2.2.2">𝑈</ci><ci id="alg2.l2a.m1.5.6.3.2.2.3.cmml" xref="alg2.l2a.m1.5.6.3.2.2.3">𝒪</ci></apply><ci id="alg2.l2a.m1.2.2.1.1.cmml" xref="alg2.l2a.m1.2.2.1.1">𝑐</ci></apply><apply id="alg2.l2a.m1.5.6.3.3.cmml" xref="alg2.l2a.m1.5.6.3.3"><csymbol cd="ambiguous" id="alg2.l2a.m1.5.6.3.3.1.cmml" xref="alg2.l2a.m1.5.6.3.3">superscript</csymbol><apply id="alg2.l2a.m1.5.6.3.3.2.cmml" xref="alg2.l2a.m1.5.6.3.3"><csymbol cd="ambiguous" id="alg2.l2a.m1.5.6.3.3.2.1.cmml" xref="alg2.l2a.m1.5.6.3.3">subscript</csymbol><ci id="alg2.l2a.m1.5.6.3.3.2.2.cmml" xref="alg2.l2a.m1.5.6.3.3.2.2">𝐷</ci><ci id="alg2.l2a.m1.5.6.3.3.2.3.cmml" xref="alg2.l2a.m1.5.6.3.3.2.3">𝑘</ci></apply><ci id="alg2.l2a.m1.3.3.1.1.cmml" xref="alg2.l2a.m1.3.3.1.1">𝑐</ci></apply><apply id="alg2.l2a.m1.5.6.3.4.cmml" xref="alg2.l2a.m1.5.6.3.4"><csymbol cd="ambiguous" id="alg2.l2a.m1.5.6.3.4.1.cmml" xref="alg2.l2a.m1.5.6.3.4">superscript</csymbol><apply id="alg2.l2a.m1.5.6.3.4.2.cmml" xref="alg2.l2a.m1.5.6.3.4"><csymbol cd="ambiguous" id="alg2.l2a.m1.5.6.3.4.2.1.cmml" xref="alg2.l2a.m1.5.6.3.4">subscript</csymbol><ci id="alg2.l2a.m1.5.6.3.4.2.2.cmml" xref="alg2.l2a.m1.5.6.3.4.2.2">𝑈</ci><ci id="alg2.l2a.m1.5.6.3.4.2.3.cmml" xref="alg2.l2a.m1.5.6.3.4.2.3">𝒪</ci></apply><apply id="alg2.l2a.m1.4.4.1.cmml" xref="alg2.l2a.m1.4.4.1"><times id="alg2.l2a.m1.4.4.1.2.cmml" xref="alg2.l2a.m1.4.4.1.2"></times><ci id="alg2.l2a.m1.4.4.1.1.cmml" xref="alg2.l2a.m1.4.4.1.1">𝑐</ci><ci id="alg2.l2a.m1.4.4.1.4.cmml" xref="alg2.l2a.m1.4.4.1.4">𝑇</ci></apply></apply><apply id="alg2.l2a.m1.5.6.3.5.cmml" xref="alg2.l2a.m1.5.6.3.5"><csymbol cd="ambiguous" id="alg2.l2a.m1.5.6.3.5.1.cmml" xref="alg2.l2a.m1.5.6.3.5">superscript</csymbol><ci id="alg2.l2a.m1.5.6.3.5.2.cmml" xref="alg2.l2a.m1.5.6.3.5.2">𝒪</ci><ci id="alg2.l2a.m1.5.5.1.1.cmml" xref="alg2.l2a.m1.5.5.1.1">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2a.m1.5c">\mathcal{B}^{(c)}\leftarrow U_{\mathcal{O}}^{(c)}D_{k}^{(c)}U_{\mathcal{O}}^{(c)T}\mathcal{O}^{(c)}</annotation></semantics></math>

</div>
<div id="alg2.l3a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <math id="alg2.l3a.m1.4" class="ltx_Math" alttext="dW^{(c)}_{t}\leftarrow d\mathcal{B}^{(c)}\partial\mathcal{B}^{(c)}/\partial W^{(c)}_{t}" display="inline"><semantics id="alg2.l3a.m1.4a"><mrow id="alg2.l3a.m1.4.5" xref="alg2.l3a.m1.4.5.cmml"><mrow id="alg2.l3a.m1.4.5.2" xref="alg2.l3a.m1.4.5.2.cmml"><mi id="alg2.l3a.m1.4.5.2.2" xref="alg2.l3a.m1.4.5.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l3a.m1.4.5.2.1" xref="alg2.l3a.m1.4.5.2.1.cmml">​</mo><msubsup id="alg2.l3a.m1.4.5.2.3" xref="alg2.l3a.m1.4.5.2.3.cmml"><mi id="alg2.l3a.m1.4.5.2.3.2.2" xref="alg2.l3a.m1.4.5.2.3.2.2.cmml">W</mi><mi id="alg2.l3a.m1.4.5.2.3.3" xref="alg2.l3a.m1.4.5.2.3.3.cmml">t</mi><mrow id="alg2.l3a.m1.1.1.1.3" xref="alg2.l3a.m1.4.5.2.3.cmml"><mo stretchy="false" id="alg2.l3a.m1.1.1.1.3.1" xref="alg2.l3a.m1.4.5.2.3.cmml">(</mo><mi id="alg2.l3a.m1.1.1.1.1" xref="alg2.l3a.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l3a.m1.1.1.1.3.2" xref="alg2.l3a.m1.4.5.2.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="alg2.l3a.m1.4.5.1" xref="alg2.l3a.m1.4.5.1.cmml">←</mo><mrow id="alg2.l3a.m1.4.5.3" xref="alg2.l3a.m1.4.5.3.cmml"><mi id="alg2.l3a.m1.4.5.3.2" xref="alg2.l3a.m1.4.5.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l3a.m1.4.5.3.1" xref="alg2.l3a.m1.4.5.3.1.cmml">​</mo><msup id="alg2.l3a.m1.4.5.3.3" xref="alg2.l3a.m1.4.5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3a.m1.4.5.3.3.2" xref="alg2.l3a.m1.4.5.3.3.2.cmml">ℬ</mi><mrow id="alg2.l3a.m1.2.2.1.3" xref="alg2.l3a.m1.4.5.3.3.cmml"><mo stretchy="false" id="alg2.l3a.m1.2.2.1.3.1" xref="alg2.l3a.m1.4.5.3.3.cmml">(</mo><mi id="alg2.l3a.m1.2.2.1.1" xref="alg2.l3a.m1.2.2.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l3a.m1.2.2.1.3.2" xref="alg2.l3a.m1.4.5.3.3.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="alg2.l3a.m1.4.5.3.1a" xref="alg2.l3a.m1.4.5.3.1.cmml">​</mo><mrow id="alg2.l3a.m1.4.5.3.4" xref="alg2.l3a.m1.4.5.3.4.cmml"><mo rspace="0em" id="alg2.l3a.m1.4.5.3.4.1" xref="alg2.l3a.m1.4.5.3.4.1.cmml">∂</mo><mrow id="alg2.l3a.m1.4.5.3.4.2" xref="alg2.l3a.m1.4.5.3.4.2.cmml"><msup id="alg2.l3a.m1.4.5.3.4.2.2" xref="alg2.l3a.m1.4.5.3.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3a.m1.4.5.3.4.2.2.2" xref="alg2.l3a.m1.4.5.3.4.2.2.2.cmml">ℬ</mi><mrow id="alg2.l3a.m1.3.3.1.3" xref="alg2.l3a.m1.4.5.3.4.2.2.cmml"><mo stretchy="false" id="alg2.l3a.m1.3.3.1.3.1" xref="alg2.l3a.m1.4.5.3.4.2.2.cmml">(</mo><mi id="alg2.l3a.m1.3.3.1.1" xref="alg2.l3a.m1.3.3.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l3a.m1.3.3.1.3.2" xref="alg2.l3a.m1.4.5.3.4.2.2.cmml">)</mo></mrow></msup><mo id="alg2.l3a.m1.4.5.3.4.2.1" xref="alg2.l3a.m1.4.5.3.4.2.1.cmml">/</mo><mrow id="alg2.l3a.m1.4.5.3.4.2.3" xref="alg2.l3a.m1.4.5.3.4.2.3.cmml"><mo lspace="0em" rspace="0em" id="alg2.l3a.m1.4.5.3.4.2.3.1" xref="alg2.l3a.m1.4.5.3.4.2.3.1.cmml">∂</mo><msubsup id="alg2.l3a.m1.4.5.3.4.2.3.2" xref="alg2.l3a.m1.4.5.3.4.2.3.2.cmml"><mi id="alg2.l3a.m1.4.5.3.4.2.3.2.2.2" xref="alg2.l3a.m1.4.5.3.4.2.3.2.2.2.cmml">W</mi><mi id="alg2.l3a.m1.4.5.3.4.2.3.2.3" xref="alg2.l3a.m1.4.5.3.4.2.3.2.3.cmml">t</mi><mrow id="alg2.l3a.m1.4.4.1.3" xref="alg2.l3a.m1.4.5.3.4.2.3.2.cmml"><mo stretchy="false" id="alg2.l3a.m1.4.4.1.3.1" xref="alg2.l3a.m1.4.5.3.4.2.3.2.cmml">(</mo><mi id="alg2.l3a.m1.4.4.1.1" xref="alg2.l3a.m1.4.4.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l3a.m1.4.4.1.3.2" xref="alg2.l3a.m1.4.5.3.4.2.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3a.m1.4b"><apply id="alg2.l3a.m1.4.5.cmml" xref="alg2.l3a.m1.4.5"><ci id="alg2.l3a.m1.4.5.1.cmml" xref="alg2.l3a.m1.4.5.1">←</ci><apply id="alg2.l3a.m1.4.5.2.cmml" xref="alg2.l3a.m1.4.5.2"><times id="alg2.l3a.m1.4.5.2.1.cmml" xref="alg2.l3a.m1.4.5.2.1"></times><ci id="alg2.l3a.m1.4.5.2.2.cmml" xref="alg2.l3a.m1.4.5.2.2">𝑑</ci><apply id="alg2.l3a.m1.4.5.2.3.cmml" xref="alg2.l3a.m1.4.5.2.3"><csymbol cd="ambiguous" id="alg2.l3a.m1.4.5.2.3.1.cmml" xref="alg2.l3a.m1.4.5.2.3">subscript</csymbol><apply id="alg2.l3a.m1.4.5.2.3.2.cmml" xref="alg2.l3a.m1.4.5.2.3"><csymbol cd="ambiguous" id="alg2.l3a.m1.4.5.2.3.2.1.cmml" xref="alg2.l3a.m1.4.5.2.3">superscript</csymbol><ci id="alg2.l3a.m1.4.5.2.3.2.2.cmml" xref="alg2.l3a.m1.4.5.2.3.2.2">𝑊</ci><ci id="alg2.l3a.m1.1.1.1.1.cmml" xref="alg2.l3a.m1.1.1.1.1">𝑐</ci></apply><ci id="alg2.l3a.m1.4.5.2.3.3.cmml" xref="alg2.l3a.m1.4.5.2.3.3">𝑡</ci></apply></apply><apply id="alg2.l3a.m1.4.5.3.cmml" xref="alg2.l3a.m1.4.5.3"><times id="alg2.l3a.m1.4.5.3.1.cmml" xref="alg2.l3a.m1.4.5.3.1"></times><ci id="alg2.l3a.m1.4.5.3.2.cmml" xref="alg2.l3a.m1.4.5.3.2">𝑑</ci><apply id="alg2.l3a.m1.4.5.3.3.cmml" xref="alg2.l3a.m1.4.5.3.3"><csymbol cd="ambiguous" id="alg2.l3a.m1.4.5.3.3.1.cmml" xref="alg2.l3a.m1.4.5.3.3">superscript</csymbol><ci id="alg2.l3a.m1.4.5.3.3.2.cmml" xref="alg2.l3a.m1.4.5.3.3.2">ℬ</ci><ci id="alg2.l3a.m1.2.2.1.1.cmml" xref="alg2.l3a.m1.2.2.1.1">𝑐</ci></apply><apply id="alg2.l3a.m1.4.5.3.4.cmml" xref="alg2.l3a.m1.4.5.3.4"><partialdiff id="alg2.l3a.m1.4.5.3.4.1.cmml" xref="alg2.l3a.m1.4.5.3.4.1"></partialdiff><apply id="alg2.l3a.m1.4.5.3.4.2.cmml" xref="alg2.l3a.m1.4.5.3.4.2"><divide id="alg2.l3a.m1.4.5.3.4.2.1.cmml" xref="alg2.l3a.m1.4.5.3.4.2.1"></divide><apply id="alg2.l3a.m1.4.5.3.4.2.2.cmml" xref="alg2.l3a.m1.4.5.3.4.2.2"><csymbol cd="ambiguous" id="alg2.l3a.m1.4.5.3.4.2.2.1.cmml" xref="alg2.l3a.m1.4.5.3.4.2.2">superscript</csymbol><ci id="alg2.l3a.m1.4.5.3.4.2.2.2.cmml" xref="alg2.l3a.m1.4.5.3.4.2.2.2">ℬ</ci><ci id="alg2.l3a.m1.3.3.1.1.cmml" xref="alg2.l3a.m1.3.3.1.1">𝑐</ci></apply><apply id="alg2.l3a.m1.4.5.3.4.2.3.cmml" xref="alg2.l3a.m1.4.5.3.4.2.3"><partialdiff id="alg2.l3a.m1.4.5.3.4.2.3.1.cmml" xref="alg2.l3a.m1.4.5.3.4.2.3.1"></partialdiff><apply id="alg2.l3a.m1.4.5.3.4.2.3.2.cmml" xref="alg2.l3a.m1.4.5.3.4.2.3.2"><csymbol cd="ambiguous" id="alg2.l3a.m1.4.5.3.4.2.3.2.1.cmml" xref="alg2.l3a.m1.4.5.3.4.2.3.2">subscript</csymbol><apply id="alg2.l3a.m1.4.5.3.4.2.3.2.2.cmml" xref="alg2.l3a.m1.4.5.3.4.2.3.2"><csymbol cd="ambiguous" id="alg2.l3a.m1.4.5.3.4.2.3.2.2.1.cmml" xref="alg2.l3a.m1.4.5.3.4.2.3.2">superscript</csymbol><ci id="alg2.l3a.m1.4.5.3.4.2.3.2.2.2.cmml" xref="alg2.l3a.m1.4.5.3.4.2.3.2.2.2">𝑊</ci><ci id="alg2.l3a.m1.4.4.1.1.cmml" xref="alg2.l3a.m1.4.4.1.1">𝑐</ci></apply><ci id="alg2.l3a.m1.4.5.3.4.2.3.2.3.cmml" xref="alg2.l3a.m1.4.5.3.4.2.3.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3a.m1.4c">dW^{(c)}_{t}\leftarrow d\mathcal{B}^{(c)}\partial\mathcal{B}^{(c)}/\partial W^{(c)}_{t}</annotation></semantics></math>

</div>
<div id="alg2.l4a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <math id="alg2.l4a.m1.5" class="ltx_Math" alttext="dW^{(c)}_{t}\leftarrow dW^{(c)}_{t}+\mathcal{N}\left(0,\sigma^{2}\mathcal{L}^{2}I/n^{(c)}\right)" display="inline"><semantics id="alg2.l4a.m1.5a"><mrow id="alg2.l4a.m1.5.5" xref="alg2.l4a.m1.5.5.cmml"><mrow id="alg2.l4a.m1.5.5.3" xref="alg2.l4a.m1.5.5.3.cmml"><mi id="alg2.l4a.m1.5.5.3.2" xref="alg2.l4a.m1.5.5.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l4a.m1.5.5.3.1" xref="alg2.l4a.m1.5.5.3.1.cmml">​</mo><msubsup id="alg2.l4a.m1.5.5.3.3" xref="alg2.l4a.m1.5.5.3.3.cmml"><mi id="alg2.l4a.m1.5.5.3.3.2.2" xref="alg2.l4a.m1.5.5.3.3.2.2.cmml">W</mi><mi id="alg2.l4a.m1.5.5.3.3.3" xref="alg2.l4a.m1.5.5.3.3.3.cmml">t</mi><mrow id="alg2.l4a.m1.1.1.1.3" xref="alg2.l4a.m1.5.5.3.3.cmml"><mo stretchy="false" id="alg2.l4a.m1.1.1.1.3.1" xref="alg2.l4a.m1.5.5.3.3.cmml">(</mo><mi id="alg2.l4a.m1.1.1.1.1" xref="alg2.l4a.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l4a.m1.1.1.1.3.2" xref="alg2.l4a.m1.5.5.3.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="alg2.l4a.m1.5.5.2" xref="alg2.l4a.m1.5.5.2.cmml">←</mo><mrow id="alg2.l4a.m1.5.5.1" xref="alg2.l4a.m1.5.5.1.cmml"><mrow id="alg2.l4a.m1.5.5.1.3" xref="alg2.l4a.m1.5.5.1.3.cmml"><mi id="alg2.l4a.m1.5.5.1.3.2" xref="alg2.l4a.m1.5.5.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l4a.m1.5.5.1.3.1" xref="alg2.l4a.m1.5.5.1.3.1.cmml">​</mo><msubsup id="alg2.l4a.m1.5.5.1.3.3" xref="alg2.l4a.m1.5.5.1.3.3.cmml"><mi id="alg2.l4a.m1.5.5.1.3.3.2.2" xref="alg2.l4a.m1.5.5.1.3.3.2.2.cmml">W</mi><mi id="alg2.l4a.m1.5.5.1.3.3.3" xref="alg2.l4a.m1.5.5.1.3.3.3.cmml">t</mi><mrow id="alg2.l4a.m1.2.2.1.3" xref="alg2.l4a.m1.5.5.1.3.3.cmml"><mo stretchy="false" id="alg2.l4a.m1.2.2.1.3.1" xref="alg2.l4a.m1.5.5.1.3.3.cmml">(</mo><mi id="alg2.l4a.m1.2.2.1.1" xref="alg2.l4a.m1.2.2.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l4a.m1.2.2.1.3.2" xref="alg2.l4a.m1.5.5.1.3.3.cmml">)</mo></mrow></msubsup></mrow><mo id="alg2.l4a.m1.5.5.1.2" xref="alg2.l4a.m1.5.5.1.2.cmml">+</mo><mrow id="alg2.l4a.m1.5.5.1.1" xref="alg2.l4a.m1.5.5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4a.m1.5.5.1.1.3" xref="alg2.l4a.m1.5.5.1.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="alg2.l4a.m1.5.5.1.1.2" xref="alg2.l4a.m1.5.5.1.1.2.cmml">​</mo><mrow id="alg2.l4a.m1.5.5.1.1.1.1" xref="alg2.l4a.m1.5.5.1.1.1.2.cmml"><mo id="alg2.l4a.m1.5.5.1.1.1.1.2" xref="alg2.l4a.m1.5.5.1.1.1.2.cmml">(</mo><mn id="alg2.l4a.m1.4.4" xref="alg2.l4a.m1.4.4.cmml">0</mn><mo id="alg2.l4a.m1.5.5.1.1.1.1.3" xref="alg2.l4a.m1.5.5.1.1.1.2.cmml">,</mo><mrow id="alg2.l4a.m1.5.5.1.1.1.1.1" xref="alg2.l4a.m1.5.5.1.1.1.1.1.cmml"><mrow id="alg2.l4a.m1.5.5.1.1.1.1.1.2" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.cmml"><msup id="alg2.l4a.m1.5.5.1.1.1.1.1.2.2" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.2.cmml"><mi id="alg2.l4a.m1.5.5.1.1.1.1.1.2.2.2" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.2.2.cmml">σ</mi><mn id="alg2.l4a.m1.5.5.1.1.1.1.1.2.2.3" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="alg2.l4a.m1.5.5.1.1.1.1.1.2.1" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.1.cmml">​</mo><msup id="alg2.l4a.m1.5.5.1.1.1.1.1.2.3" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4a.m1.5.5.1.1.1.1.1.2.3.2" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.3.2.cmml">ℒ</mi><mn id="alg2.l4a.m1.5.5.1.1.1.1.1.2.3.3" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.3.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="alg2.l4a.m1.5.5.1.1.1.1.1.2.1a" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.1.cmml">​</mo><mi id="alg2.l4a.m1.5.5.1.1.1.1.1.2.4" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.4.cmml">I</mi></mrow><mo id="alg2.l4a.m1.5.5.1.1.1.1.1.1" xref="alg2.l4a.m1.5.5.1.1.1.1.1.1.cmml">/</mo><msup id="alg2.l4a.m1.5.5.1.1.1.1.1.3" xref="alg2.l4a.m1.5.5.1.1.1.1.1.3.cmml"><mi id="alg2.l4a.m1.5.5.1.1.1.1.1.3.2" xref="alg2.l4a.m1.5.5.1.1.1.1.1.3.2.cmml">n</mi><mrow id="alg2.l4a.m1.3.3.1.3" xref="alg2.l4a.m1.5.5.1.1.1.1.1.3.cmml"><mo stretchy="false" id="alg2.l4a.m1.3.3.1.3.1" xref="alg2.l4a.m1.5.5.1.1.1.1.1.3.cmml">(</mo><mi id="alg2.l4a.m1.3.3.1.1" xref="alg2.l4a.m1.3.3.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l4a.m1.3.3.1.3.2" xref="alg2.l4a.m1.5.5.1.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="alg2.l4a.m1.5.5.1.1.1.1.4" xref="alg2.l4a.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4a.m1.5b"><apply id="alg2.l4a.m1.5.5.cmml" xref="alg2.l4a.m1.5.5"><ci id="alg2.l4a.m1.5.5.2.cmml" xref="alg2.l4a.m1.5.5.2">←</ci><apply id="alg2.l4a.m1.5.5.3.cmml" xref="alg2.l4a.m1.5.5.3"><times id="alg2.l4a.m1.5.5.3.1.cmml" xref="alg2.l4a.m1.5.5.3.1"></times><ci id="alg2.l4a.m1.5.5.3.2.cmml" xref="alg2.l4a.m1.5.5.3.2">𝑑</ci><apply id="alg2.l4a.m1.5.5.3.3.cmml" xref="alg2.l4a.m1.5.5.3.3"><csymbol cd="ambiguous" id="alg2.l4a.m1.5.5.3.3.1.cmml" xref="alg2.l4a.m1.5.5.3.3">subscript</csymbol><apply id="alg2.l4a.m1.5.5.3.3.2.cmml" xref="alg2.l4a.m1.5.5.3.3"><csymbol cd="ambiguous" id="alg2.l4a.m1.5.5.3.3.2.1.cmml" xref="alg2.l4a.m1.5.5.3.3">superscript</csymbol><ci id="alg2.l4a.m1.5.5.3.3.2.2.cmml" xref="alg2.l4a.m1.5.5.3.3.2.2">𝑊</ci><ci id="alg2.l4a.m1.1.1.1.1.cmml" xref="alg2.l4a.m1.1.1.1.1">𝑐</ci></apply><ci id="alg2.l4a.m1.5.5.3.3.3.cmml" xref="alg2.l4a.m1.5.5.3.3.3">𝑡</ci></apply></apply><apply id="alg2.l4a.m1.5.5.1.cmml" xref="alg2.l4a.m1.5.5.1"><plus id="alg2.l4a.m1.5.5.1.2.cmml" xref="alg2.l4a.m1.5.5.1.2"></plus><apply id="alg2.l4a.m1.5.5.1.3.cmml" xref="alg2.l4a.m1.5.5.1.3"><times id="alg2.l4a.m1.5.5.1.3.1.cmml" xref="alg2.l4a.m1.5.5.1.3.1"></times><ci id="alg2.l4a.m1.5.5.1.3.2.cmml" xref="alg2.l4a.m1.5.5.1.3.2">𝑑</ci><apply id="alg2.l4a.m1.5.5.1.3.3.cmml" xref="alg2.l4a.m1.5.5.1.3.3"><csymbol cd="ambiguous" id="alg2.l4a.m1.5.5.1.3.3.1.cmml" xref="alg2.l4a.m1.5.5.1.3.3">subscript</csymbol><apply id="alg2.l4a.m1.5.5.1.3.3.2.cmml" xref="alg2.l4a.m1.5.5.1.3.3"><csymbol cd="ambiguous" id="alg2.l4a.m1.5.5.1.3.3.2.1.cmml" xref="alg2.l4a.m1.5.5.1.3.3">superscript</csymbol><ci id="alg2.l4a.m1.5.5.1.3.3.2.2.cmml" xref="alg2.l4a.m1.5.5.1.3.3.2.2">𝑊</ci><ci id="alg2.l4a.m1.2.2.1.1.cmml" xref="alg2.l4a.m1.2.2.1.1">𝑐</ci></apply><ci id="alg2.l4a.m1.5.5.1.3.3.3.cmml" xref="alg2.l4a.m1.5.5.1.3.3.3">𝑡</ci></apply></apply><apply id="alg2.l4a.m1.5.5.1.1.cmml" xref="alg2.l4a.m1.5.5.1.1"><times id="alg2.l4a.m1.5.5.1.1.2.cmml" xref="alg2.l4a.m1.5.5.1.1.2"></times><ci id="alg2.l4a.m1.5.5.1.1.3.cmml" xref="alg2.l4a.m1.5.5.1.1.3">𝒩</ci><interval closure="open" id="alg2.l4a.m1.5.5.1.1.1.2.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1"><cn type="integer" id="alg2.l4a.m1.4.4.cmml" xref="alg2.l4a.m1.4.4">0</cn><apply id="alg2.l4a.m1.5.5.1.1.1.1.1.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1"><divide id="alg2.l4a.m1.5.5.1.1.1.1.1.1.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.1"></divide><apply id="alg2.l4a.m1.5.5.1.1.1.1.1.2.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2"><times id="alg2.l4a.m1.5.5.1.1.1.1.1.2.1.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.1"></times><apply id="alg2.l4a.m1.5.5.1.1.1.1.1.2.2.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l4a.m1.5.5.1.1.1.1.1.2.2.1.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.2">superscript</csymbol><ci id="alg2.l4a.m1.5.5.1.1.1.1.1.2.2.2.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.2.2">𝜎</ci><cn type="integer" id="alg2.l4a.m1.5.5.1.1.1.1.1.2.2.3.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.2.3">2</cn></apply><apply id="alg2.l4a.m1.5.5.1.1.1.1.1.2.3.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l4a.m1.5.5.1.1.1.1.1.2.3.1.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.3">superscript</csymbol><ci id="alg2.l4a.m1.5.5.1.1.1.1.1.2.3.2.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.3.2">ℒ</ci><cn type="integer" id="alg2.l4a.m1.5.5.1.1.1.1.1.2.3.3.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.3.3">2</cn></apply><ci id="alg2.l4a.m1.5.5.1.1.1.1.1.2.4.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.2.4">𝐼</ci></apply><apply id="alg2.l4a.m1.5.5.1.1.1.1.1.3.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4a.m1.5.5.1.1.1.1.1.3.1.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.3">superscript</csymbol><ci id="alg2.l4a.m1.5.5.1.1.1.1.1.3.2.cmml" xref="alg2.l4a.m1.5.5.1.1.1.1.1.3.2">𝑛</ci><ci id="alg2.l4a.m1.3.3.1.1.cmml" xref="alg2.l4a.m1.3.3.1.1">𝑐</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4a.m1.5c">dW^{(c)}_{t}\leftarrow dW^{(c)}_{t}+\mathcal{N}\left(0,\sigma^{2}\mathcal{L}^{2}I/n^{(c)}\right)</annotation></semantics></math>

</div>
<div id="alg2.l5a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math id="alg2.l5a.m1.3" class="ltx_Math" alttext="W^{(c)}_{t}\leftarrow W^{(c)}_{t}-\eta dW^{(c)}_{t}" display="inline"><semantics id="alg2.l5a.m1.3a"><mrow id="alg2.l5a.m1.3.4" xref="alg2.l5a.m1.3.4.cmml"><msubsup id="alg2.l5a.m1.3.4.2" xref="alg2.l5a.m1.3.4.2.cmml"><mi id="alg2.l5a.m1.3.4.2.2.2" xref="alg2.l5a.m1.3.4.2.2.2.cmml">W</mi><mi id="alg2.l5a.m1.3.4.2.3" xref="alg2.l5a.m1.3.4.2.3.cmml">t</mi><mrow id="alg2.l5a.m1.1.1.1.3" xref="alg2.l5a.m1.3.4.2.cmml"><mo stretchy="false" id="alg2.l5a.m1.1.1.1.3.1" xref="alg2.l5a.m1.3.4.2.cmml">(</mo><mi id="alg2.l5a.m1.1.1.1.1" xref="alg2.l5a.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l5a.m1.1.1.1.3.2" xref="alg2.l5a.m1.3.4.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg2.l5a.m1.3.4.1" xref="alg2.l5a.m1.3.4.1.cmml">←</mo><mrow id="alg2.l5a.m1.3.4.3" xref="alg2.l5a.m1.3.4.3.cmml"><msubsup id="alg2.l5a.m1.3.4.3.2" xref="alg2.l5a.m1.3.4.3.2.cmml"><mi id="alg2.l5a.m1.3.4.3.2.2.2" xref="alg2.l5a.m1.3.4.3.2.2.2.cmml">W</mi><mi id="alg2.l5a.m1.3.4.3.2.3" xref="alg2.l5a.m1.3.4.3.2.3.cmml">t</mi><mrow id="alg2.l5a.m1.2.2.1.3" xref="alg2.l5a.m1.3.4.3.2.cmml"><mo stretchy="false" id="alg2.l5a.m1.2.2.1.3.1" xref="alg2.l5a.m1.3.4.3.2.cmml">(</mo><mi id="alg2.l5a.m1.2.2.1.1" xref="alg2.l5a.m1.2.2.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l5a.m1.2.2.1.3.2" xref="alg2.l5a.m1.3.4.3.2.cmml">)</mo></mrow></msubsup><mo id="alg2.l5a.m1.3.4.3.1" xref="alg2.l5a.m1.3.4.3.1.cmml">−</mo><mrow id="alg2.l5a.m1.3.4.3.3" xref="alg2.l5a.m1.3.4.3.3.cmml"><mi id="alg2.l5a.m1.3.4.3.3.2" xref="alg2.l5a.m1.3.4.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="alg2.l5a.m1.3.4.3.3.1" xref="alg2.l5a.m1.3.4.3.3.1.cmml">​</mo><mi id="alg2.l5a.m1.3.4.3.3.3" xref="alg2.l5a.m1.3.4.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l5a.m1.3.4.3.3.1a" xref="alg2.l5a.m1.3.4.3.3.1.cmml">​</mo><msubsup id="alg2.l5a.m1.3.4.3.3.4" xref="alg2.l5a.m1.3.4.3.3.4.cmml"><mi id="alg2.l5a.m1.3.4.3.3.4.2.2" xref="alg2.l5a.m1.3.4.3.3.4.2.2.cmml">W</mi><mi id="alg2.l5a.m1.3.4.3.3.4.3" xref="alg2.l5a.m1.3.4.3.3.4.3.cmml">t</mi><mrow id="alg2.l5a.m1.3.3.1.3" xref="alg2.l5a.m1.3.4.3.3.4.cmml"><mo stretchy="false" id="alg2.l5a.m1.3.3.1.3.1" xref="alg2.l5a.m1.3.4.3.3.4.cmml">(</mo><mi id="alg2.l5a.m1.3.3.1.1" xref="alg2.l5a.m1.3.3.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l5a.m1.3.3.1.3.2" xref="alg2.l5a.m1.3.4.3.3.4.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5a.m1.3b"><apply id="alg2.l5a.m1.3.4.cmml" xref="alg2.l5a.m1.3.4"><ci id="alg2.l5a.m1.3.4.1.cmml" xref="alg2.l5a.m1.3.4.1">←</ci><apply id="alg2.l5a.m1.3.4.2.cmml" xref="alg2.l5a.m1.3.4.2"><csymbol cd="ambiguous" id="alg2.l5a.m1.3.4.2.1.cmml" xref="alg2.l5a.m1.3.4.2">subscript</csymbol><apply id="alg2.l5a.m1.3.4.2.2.cmml" xref="alg2.l5a.m1.3.4.2"><csymbol cd="ambiguous" id="alg2.l5a.m1.3.4.2.2.1.cmml" xref="alg2.l5a.m1.3.4.2">superscript</csymbol><ci id="alg2.l5a.m1.3.4.2.2.2.cmml" xref="alg2.l5a.m1.3.4.2.2.2">𝑊</ci><ci id="alg2.l5a.m1.1.1.1.1.cmml" xref="alg2.l5a.m1.1.1.1.1">𝑐</ci></apply><ci id="alg2.l5a.m1.3.4.2.3.cmml" xref="alg2.l5a.m1.3.4.2.3">𝑡</ci></apply><apply id="alg2.l5a.m1.3.4.3.cmml" xref="alg2.l5a.m1.3.4.3"><minus id="alg2.l5a.m1.3.4.3.1.cmml" xref="alg2.l5a.m1.3.4.3.1"></minus><apply id="alg2.l5a.m1.3.4.3.2.cmml" xref="alg2.l5a.m1.3.4.3.2"><csymbol cd="ambiguous" id="alg2.l5a.m1.3.4.3.2.1.cmml" xref="alg2.l5a.m1.3.4.3.2">subscript</csymbol><apply id="alg2.l5a.m1.3.4.3.2.2.cmml" xref="alg2.l5a.m1.3.4.3.2"><csymbol cd="ambiguous" id="alg2.l5a.m1.3.4.3.2.2.1.cmml" xref="alg2.l5a.m1.3.4.3.2">superscript</csymbol><ci id="alg2.l5a.m1.3.4.3.2.2.2.cmml" xref="alg2.l5a.m1.3.4.3.2.2.2">𝑊</ci><ci id="alg2.l5a.m1.2.2.1.1.cmml" xref="alg2.l5a.m1.2.2.1.1">𝑐</ci></apply><ci id="alg2.l5a.m1.3.4.3.2.3.cmml" xref="alg2.l5a.m1.3.4.3.2.3">𝑡</ci></apply><apply id="alg2.l5a.m1.3.4.3.3.cmml" xref="alg2.l5a.m1.3.4.3.3"><times id="alg2.l5a.m1.3.4.3.3.1.cmml" xref="alg2.l5a.m1.3.4.3.3.1"></times><ci id="alg2.l5a.m1.3.4.3.3.2.cmml" xref="alg2.l5a.m1.3.4.3.3.2">𝜂</ci><ci id="alg2.l5a.m1.3.4.3.3.3.cmml" xref="alg2.l5a.m1.3.4.3.3.3">𝑑</ci><apply id="alg2.l5a.m1.3.4.3.3.4.cmml" xref="alg2.l5a.m1.3.4.3.3.4"><csymbol cd="ambiguous" id="alg2.l5a.m1.3.4.3.3.4.1.cmml" xref="alg2.l5a.m1.3.4.3.3.4">subscript</csymbol><apply id="alg2.l5a.m1.3.4.3.3.4.2.cmml" xref="alg2.l5a.m1.3.4.3.3.4"><csymbol cd="ambiguous" id="alg2.l5a.m1.3.4.3.3.4.2.1.cmml" xref="alg2.l5a.m1.3.4.3.3.4">superscript</csymbol><ci id="alg2.l5a.m1.3.4.3.3.4.2.2.cmml" xref="alg2.l5a.m1.3.4.3.3.4.2.2">𝑊</ci><ci id="alg2.l5a.m1.3.3.1.1.cmml" xref="alg2.l5a.m1.3.3.1.1">𝑐</ci></apply><ci id="alg2.l5a.m1.3.4.3.3.4.3.cmml" xref="alg2.l5a.m1.3.4.3.3.4.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5a.m1.3c">W^{(c)}_{t}\leftarrow W^{(c)}_{t}-\eta dW^{(c)}_{t}</annotation></semantics></math>

</div>
<div id="alg2.l6a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>  <span id="alg2.l6a.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l6a.2" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.19" class="ltx_p ltx_figure_panel"><span id="alg2.19.1" class="ltx_text ltx_font_bold ltx_font_italic">FL Server</span>:</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg2.20" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg2.l1b" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math id="alg2.l1b.m1.3" class="ltx_Math" alttext="W^{(d)}_{t+1}\leftarrow\frac{\sum_{m\in\mathcal{M}\setminus AM}W^{(m)}_{t}}{|\mathcal{M}\setminus AM|}" display="inline"><semantics id="alg2.l1b.m1.3a"><mrow id="alg2.l1b.m1.3.4" xref="alg2.l1b.m1.3.4.cmml"><msubsup id="alg2.l1b.m1.3.4.2" xref="alg2.l1b.m1.3.4.2.cmml"><mi id="alg2.l1b.m1.3.4.2.2.2" xref="alg2.l1b.m1.3.4.2.2.2.cmml">W</mi><mrow id="alg2.l1b.m1.3.4.2.3" xref="alg2.l1b.m1.3.4.2.3.cmml"><mi id="alg2.l1b.m1.3.4.2.3.2" xref="alg2.l1b.m1.3.4.2.3.2.cmml">t</mi><mo id="alg2.l1b.m1.3.4.2.3.1" xref="alg2.l1b.m1.3.4.2.3.1.cmml">+</mo><mn id="alg2.l1b.m1.3.4.2.3.3" xref="alg2.l1b.m1.3.4.2.3.3.cmml">1</mn></mrow><mrow id="alg2.l1b.m1.1.1.1.3" xref="alg2.l1b.m1.3.4.2.cmml"><mo stretchy="false" id="alg2.l1b.m1.1.1.1.3.1" xref="alg2.l1b.m1.3.4.2.cmml">(</mo><mi id="alg2.l1b.m1.1.1.1.1" xref="alg2.l1b.m1.1.1.1.1.cmml">d</mi><mo stretchy="false" id="alg2.l1b.m1.1.1.1.3.2" xref="alg2.l1b.m1.3.4.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg2.l1b.m1.3.4.1" xref="alg2.l1b.m1.3.4.1.cmml">←</mo><mfrac id="alg2.l1b.m1.3.3" xref="alg2.l1b.m1.3.3.cmml"><mrow id="alg2.l1b.m1.2.2.1" xref="alg2.l1b.m1.2.2.1.cmml"><mstyle displaystyle="false" id="alg2.l1b.m1.2.2.1.2" xref="alg2.l1b.m1.2.2.1.2.cmml"><msub id="alg2.l1b.m1.2.2.1.2a" xref="alg2.l1b.m1.2.2.1.2.cmml"><mo id="alg2.l1b.m1.2.2.1.2.2" xref="alg2.l1b.m1.2.2.1.2.2.cmml">∑</mo><mrow id="alg2.l1b.m1.2.2.1.2.3" xref="alg2.l1b.m1.2.2.1.2.3.cmml"><mi id="alg2.l1b.m1.2.2.1.2.3.2" xref="alg2.l1b.m1.2.2.1.2.3.2.cmml">m</mi><mo id="alg2.l1b.m1.2.2.1.2.3.1" xref="alg2.l1b.m1.2.2.1.2.3.1.cmml">∈</mo><mrow id="alg2.l1b.m1.2.2.1.2.3.3" xref="alg2.l1b.m1.2.2.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1b.m1.2.2.1.2.3.3.2" xref="alg2.l1b.m1.2.2.1.2.3.3.2.cmml">ℳ</mi><mo id="alg2.l1b.m1.2.2.1.2.3.3.1" xref="alg2.l1b.m1.2.2.1.2.3.3.1.cmml">∖</mo><mrow id="alg2.l1b.m1.2.2.1.2.3.3.3" xref="alg2.l1b.m1.2.2.1.2.3.3.3.cmml"><mi id="alg2.l1b.m1.2.2.1.2.3.3.3.2" xref="alg2.l1b.m1.2.2.1.2.3.3.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="alg2.l1b.m1.2.2.1.2.3.3.3.1" xref="alg2.l1b.m1.2.2.1.2.3.3.3.1.cmml">​</mo><mi id="alg2.l1b.m1.2.2.1.2.3.3.3.3" xref="alg2.l1b.m1.2.2.1.2.3.3.3.3.cmml">M</mi></mrow></mrow></mrow></msub></mstyle><msubsup id="alg2.l1b.m1.2.2.1.3" xref="alg2.l1b.m1.2.2.1.3.cmml"><mi id="alg2.l1b.m1.2.2.1.3.2.2" xref="alg2.l1b.m1.2.2.1.3.2.2.cmml">W</mi><mi id="alg2.l1b.m1.2.2.1.3.3" xref="alg2.l1b.m1.2.2.1.3.3.cmml">t</mi><mrow id="alg2.l1b.m1.2.2.1.1.1.3" xref="alg2.l1b.m1.2.2.1.3.cmml"><mo stretchy="false" id="alg2.l1b.m1.2.2.1.1.1.3.1" xref="alg2.l1b.m1.2.2.1.3.cmml">(</mo><mi id="alg2.l1b.m1.2.2.1.1.1.1" xref="alg2.l1b.m1.2.2.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg2.l1b.m1.2.2.1.1.1.3.2" xref="alg2.l1b.m1.2.2.1.3.cmml">)</mo></mrow></msubsup></mrow><mrow id="alg2.l1b.m1.3.3.2.1" xref="alg2.l1b.m1.3.3.2.2.cmml"><mo stretchy="false" id="alg2.l1b.m1.3.3.2.1.2" xref="alg2.l1b.m1.3.3.2.2.1.cmml">|</mo><mrow id="alg2.l1b.m1.3.3.2.1.1" xref="alg2.l1b.m1.3.3.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1b.m1.3.3.2.1.1.2" xref="alg2.l1b.m1.3.3.2.1.1.2.cmml">ℳ</mi><mo id="alg2.l1b.m1.3.3.2.1.1.1" xref="alg2.l1b.m1.3.3.2.1.1.1.cmml">∖</mo><mrow id="alg2.l1b.m1.3.3.2.1.1.3" xref="alg2.l1b.m1.3.3.2.1.1.3.cmml"><mi id="alg2.l1b.m1.3.3.2.1.1.3.2" xref="alg2.l1b.m1.3.3.2.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="alg2.l1b.m1.3.3.2.1.1.3.1" xref="alg2.l1b.m1.3.3.2.1.1.3.1.cmml">​</mo><mi id="alg2.l1b.m1.3.3.2.1.1.3.3" xref="alg2.l1b.m1.3.3.2.1.1.3.3.cmml">M</mi></mrow></mrow><mo stretchy="false" id="alg2.l1b.m1.3.3.2.1.3" xref="alg2.l1b.m1.3.3.2.2.1.cmml">|</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1b.m1.3b"><apply id="alg2.l1b.m1.3.4.cmml" xref="alg2.l1b.m1.3.4"><ci id="alg2.l1b.m1.3.4.1.cmml" xref="alg2.l1b.m1.3.4.1">←</ci><apply id="alg2.l1b.m1.3.4.2.cmml" xref="alg2.l1b.m1.3.4.2"><csymbol cd="ambiguous" id="alg2.l1b.m1.3.4.2.1.cmml" xref="alg2.l1b.m1.3.4.2">subscript</csymbol><apply id="alg2.l1b.m1.3.4.2.2.cmml" xref="alg2.l1b.m1.3.4.2"><csymbol cd="ambiguous" id="alg2.l1b.m1.3.4.2.2.1.cmml" xref="alg2.l1b.m1.3.4.2">superscript</csymbol><ci id="alg2.l1b.m1.3.4.2.2.2.cmml" xref="alg2.l1b.m1.3.4.2.2.2">𝑊</ci><ci id="alg2.l1b.m1.1.1.1.1.cmml" xref="alg2.l1b.m1.1.1.1.1">𝑑</ci></apply><apply id="alg2.l1b.m1.3.4.2.3.cmml" xref="alg2.l1b.m1.3.4.2.3"><plus id="alg2.l1b.m1.3.4.2.3.1.cmml" xref="alg2.l1b.m1.3.4.2.3.1"></plus><ci id="alg2.l1b.m1.3.4.2.3.2.cmml" xref="alg2.l1b.m1.3.4.2.3.2">𝑡</ci><cn type="integer" id="alg2.l1b.m1.3.4.2.3.3.cmml" xref="alg2.l1b.m1.3.4.2.3.3">1</cn></apply></apply><apply id="alg2.l1b.m1.3.3.cmml" xref="alg2.l1b.m1.3.3"><divide id="alg2.l1b.m1.3.3.3.cmml" xref="alg2.l1b.m1.3.3"></divide><apply id="alg2.l1b.m1.2.2.1.cmml" xref="alg2.l1b.m1.2.2.1"><apply id="alg2.l1b.m1.2.2.1.2.cmml" xref="alg2.l1b.m1.2.2.1.2"><csymbol cd="ambiguous" id="alg2.l1b.m1.2.2.1.2.1.cmml" xref="alg2.l1b.m1.2.2.1.2">subscript</csymbol><sum id="alg2.l1b.m1.2.2.1.2.2.cmml" xref="alg2.l1b.m1.2.2.1.2.2"></sum><apply id="alg2.l1b.m1.2.2.1.2.3.cmml" xref="alg2.l1b.m1.2.2.1.2.3"><in id="alg2.l1b.m1.2.2.1.2.3.1.cmml" xref="alg2.l1b.m1.2.2.1.2.3.1"></in><ci id="alg2.l1b.m1.2.2.1.2.3.2.cmml" xref="alg2.l1b.m1.2.2.1.2.3.2">𝑚</ci><apply id="alg2.l1b.m1.2.2.1.2.3.3.cmml" xref="alg2.l1b.m1.2.2.1.2.3.3"><setdiff id="alg2.l1b.m1.2.2.1.2.3.3.1.cmml" xref="alg2.l1b.m1.2.2.1.2.3.3.1"></setdiff><ci id="alg2.l1b.m1.2.2.1.2.3.3.2.cmml" xref="alg2.l1b.m1.2.2.1.2.3.3.2">ℳ</ci><apply id="alg2.l1b.m1.2.2.1.2.3.3.3.cmml" xref="alg2.l1b.m1.2.2.1.2.3.3.3"><times id="alg2.l1b.m1.2.2.1.2.3.3.3.1.cmml" xref="alg2.l1b.m1.2.2.1.2.3.3.3.1"></times><ci id="alg2.l1b.m1.2.2.1.2.3.3.3.2.cmml" xref="alg2.l1b.m1.2.2.1.2.3.3.3.2">𝐴</ci><ci id="alg2.l1b.m1.2.2.1.2.3.3.3.3.cmml" xref="alg2.l1b.m1.2.2.1.2.3.3.3.3">𝑀</ci></apply></apply></apply></apply><apply id="alg2.l1b.m1.2.2.1.3.cmml" xref="alg2.l1b.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l1b.m1.2.2.1.3.1.cmml" xref="alg2.l1b.m1.2.2.1.3">subscript</csymbol><apply id="alg2.l1b.m1.2.2.1.3.2.cmml" xref="alg2.l1b.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l1b.m1.2.2.1.3.2.1.cmml" xref="alg2.l1b.m1.2.2.1.3">superscript</csymbol><ci id="alg2.l1b.m1.2.2.1.3.2.2.cmml" xref="alg2.l1b.m1.2.2.1.3.2.2">𝑊</ci><ci id="alg2.l1b.m1.2.2.1.1.1.1.cmml" xref="alg2.l1b.m1.2.2.1.1.1.1">𝑚</ci></apply><ci id="alg2.l1b.m1.2.2.1.3.3.cmml" xref="alg2.l1b.m1.2.2.1.3.3">𝑡</ci></apply></apply><apply id="alg2.l1b.m1.3.3.2.2.cmml" xref="alg2.l1b.m1.3.3.2.1"><abs id="alg2.l1b.m1.3.3.2.2.1.cmml" xref="alg2.l1b.m1.3.3.2.1.2"></abs><apply id="alg2.l1b.m1.3.3.2.1.1.cmml" xref="alg2.l1b.m1.3.3.2.1.1"><setdiff id="alg2.l1b.m1.3.3.2.1.1.1.cmml" xref="alg2.l1b.m1.3.3.2.1.1.1"></setdiff><ci id="alg2.l1b.m1.3.3.2.1.1.2.cmml" xref="alg2.l1b.m1.3.3.2.1.1.2">ℳ</ci><apply id="alg2.l1b.m1.3.3.2.1.1.3.cmml" xref="alg2.l1b.m1.3.3.2.1.1.3"><times id="alg2.l1b.m1.3.3.2.1.1.3.1.cmml" xref="alg2.l1b.m1.3.3.2.1.1.3.1"></times><ci id="alg2.l1b.m1.3.3.2.1.1.3.2.cmml" xref="alg2.l1b.m1.3.3.2.1.1.3.2">𝐴</ci><ci id="alg2.l1b.m1.3.3.2.1.1.3.3.cmml" xref="alg2.l1b.m1.3.3.2.1.1.3.3">𝑀</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1b.m1.3c">W^{(d)}_{t+1}\leftarrow\frac{\sum_{m\in\mathcal{M}\setminus AM}W^{(m)}_{t}}{|\mathcal{M}\setminus AM|}</annotation></semantics></math>

</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.21" class="ltx_p ltx_figure_panel"><span id="alg2.21.1" class="ltx_text ltx_font_bold ltx_font_italic">AM</span>:</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg2.22" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg2.l1c" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math id="alg2.l1c.m1.3" class="ltx_Math" alttext="W^{(s)}_{t+1}\leftarrow\frac{\sum_{c\in\mathcal{U}^{t}}W^{(c)}_{t}}{\left|\mathcal{U}^{t}\right|}" display="inline"><semantics id="alg2.l1c.m1.3a"><mrow id="alg2.l1c.m1.3.4" xref="alg2.l1c.m1.3.4.cmml"><msubsup id="alg2.l1c.m1.3.4.2" xref="alg2.l1c.m1.3.4.2.cmml"><mi id="alg2.l1c.m1.3.4.2.2.2" xref="alg2.l1c.m1.3.4.2.2.2.cmml">W</mi><mrow id="alg2.l1c.m1.3.4.2.3" xref="alg2.l1c.m1.3.4.2.3.cmml"><mi id="alg2.l1c.m1.3.4.2.3.2" xref="alg2.l1c.m1.3.4.2.3.2.cmml">t</mi><mo id="alg2.l1c.m1.3.4.2.3.1" xref="alg2.l1c.m1.3.4.2.3.1.cmml">+</mo><mn id="alg2.l1c.m1.3.4.2.3.3" xref="alg2.l1c.m1.3.4.2.3.3.cmml">1</mn></mrow><mrow id="alg2.l1c.m1.1.1.1.3" xref="alg2.l1c.m1.3.4.2.cmml"><mo stretchy="false" id="alg2.l1c.m1.1.1.1.3.1" xref="alg2.l1c.m1.3.4.2.cmml">(</mo><mi id="alg2.l1c.m1.1.1.1.1" xref="alg2.l1c.m1.1.1.1.1.cmml">s</mi><mo stretchy="false" id="alg2.l1c.m1.1.1.1.3.2" xref="alg2.l1c.m1.3.4.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg2.l1c.m1.3.4.1" xref="alg2.l1c.m1.3.4.1.cmml">←</mo><mfrac id="alg2.l1c.m1.3.3" xref="alg2.l1c.m1.3.3.cmml"><mrow id="alg2.l1c.m1.2.2.1" xref="alg2.l1c.m1.2.2.1.cmml"><mstyle displaystyle="false" id="alg2.l1c.m1.2.2.1.2" xref="alg2.l1c.m1.2.2.1.2.cmml"><msub id="alg2.l1c.m1.2.2.1.2a" xref="alg2.l1c.m1.2.2.1.2.cmml"><mo id="alg2.l1c.m1.2.2.1.2.2" xref="alg2.l1c.m1.2.2.1.2.2.cmml">∑</mo><mrow id="alg2.l1c.m1.2.2.1.2.3" xref="alg2.l1c.m1.2.2.1.2.3.cmml"><mi id="alg2.l1c.m1.2.2.1.2.3.2" xref="alg2.l1c.m1.2.2.1.2.3.2.cmml">c</mi><mo id="alg2.l1c.m1.2.2.1.2.3.1" xref="alg2.l1c.m1.2.2.1.2.3.1.cmml">∈</mo><msup id="alg2.l1c.m1.2.2.1.2.3.3" xref="alg2.l1c.m1.2.2.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1c.m1.2.2.1.2.3.3.2" xref="alg2.l1c.m1.2.2.1.2.3.3.2.cmml">𝒰</mi><mi id="alg2.l1c.m1.2.2.1.2.3.3.3" xref="alg2.l1c.m1.2.2.1.2.3.3.3.cmml">t</mi></msup></mrow></msub></mstyle><msubsup id="alg2.l1c.m1.2.2.1.3" xref="alg2.l1c.m1.2.2.1.3.cmml"><mi id="alg2.l1c.m1.2.2.1.3.2.2" xref="alg2.l1c.m1.2.2.1.3.2.2.cmml">W</mi><mi id="alg2.l1c.m1.2.2.1.3.3" xref="alg2.l1c.m1.2.2.1.3.3.cmml">t</mi><mrow id="alg2.l1c.m1.2.2.1.1.1.3" xref="alg2.l1c.m1.2.2.1.3.cmml"><mo stretchy="false" id="alg2.l1c.m1.2.2.1.1.1.3.1" xref="alg2.l1c.m1.2.2.1.3.cmml">(</mo><mi id="alg2.l1c.m1.2.2.1.1.1.1" xref="alg2.l1c.m1.2.2.1.1.1.1.cmml">c</mi><mo stretchy="false" id="alg2.l1c.m1.2.2.1.1.1.3.2" xref="alg2.l1c.m1.2.2.1.3.cmml">)</mo></mrow></msubsup></mrow><mrow id="alg2.l1c.m1.3.3.2.1" xref="alg2.l1c.m1.3.3.2.2.cmml"><mo id="alg2.l1c.m1.3.3.2.1.2" xref="alg2.l1c.m1.3.3.2.2.1.cmml">|</mo><msup id="alg2.l1c.m1.3.3.2.1.1" xref="alg2.l1c.m1.3.3.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1c.m1.3.3.2.1.1.2" xref="alg2.l1c.m1.3.3.2.1.1.2.cmml">𝒰</mi><mi id="alg2.l1c.m1.3.3.2.1.1.3" xref="alg2.l1c.m1.3.3.2.1.1.3.cmml">t</mi></msup><mo id="alg2.l1c.m1.3.3.2.1.3" xref="alg2.l1c.m1.3.3.2.2.1.cmml">|</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1c.m1.3b"><apply id="alg2.l1c.m1.3.4.cmml" xref="alg2.l1c.m1.3.4"><ci id="alg2.l1c.m1.3.4.1.cmml" xref="alg2.l1c.m1.3.4.1">←</ci><apply id="alg2.l1c.m1.3.4.2.cmml" xref="alg2.l1c.m1.3.4.2"><csymbol cd="ambiguous" id="alg2.l1c.m1.3.4.2.1.cmml" xref="alg2.l1c.m1.3.4.2">subscript</csymbol><apply id="alg2.l1c.m1.3.4.2.2.cmml" xref="alg2.l1c.m1.3.4.2"><csymbol cd="ambiguous" id="alg2.l1c.m1.3.4.2.2.1.cmml" xref="alg2.l1c.m1.3.4.2">superscript</csymbol><ci id="alg2.l1c.m1.3.4.2.2.2.cmml" xref="alg2.l1c.m1.3.4.2.2.2">𝑊</ci><ci id="alg2.l1c.m1.1.1.1.1.cmml" xref="alg2.l1c.m1.1.1.1.1">𝑠</ci></apply><apply id="alg2.l1c.m1.3.4.2.3.cmml" xref="alg2.l1c.m1.3.4.2.3"><plus id="alg2.l1c.m1.3.4.2.3.1.cmml" xref="alg2.l1c.m1.3.4.2.3.1"></plus><ci id="alg2.l1c.m1.3.4.2.3.2.cmml" xref="alg2.l1c.m1.3.4.2.3.2">𝑡</ci><cn type="integer" id="alg2.l1c.m1.3.4.2.3.3.cmml" xref="alg2.l1c.m1.3.4.2.3.3">1</cn></apply></apply><apply id="alg2.l1c.m1.3.3.cmml" xref="alg2.l1c.m1.3.3"><divide id="alg2.l1c.m1.3.3.3.cmml" xref="alg2.l1c.m1.3.3"></divide><apply id="alg2.l1c.m1.2.2.1.cmml" xref="alg2.l1c.m1.2.2.1"><apply id="alg2.l1c.m1.2.2.1.2.cmml" xref="alg2.l1c.m1.2.2.1.2"><csymbol cd="ambiguous" id="alg2.l1c.m1.2.2.1.2.1.cmml" xref="alg2.l1c.m1.2.2.1.2">subscript</csymbol><sum id="alg2.l1c.m1.2.2.1.2.2.cmml" xref="alg2.l1c.m1.2.2.1.2.2"></sum><apply id="alg2.l1c.m1.2.2.1.2.3.cmml" xref="alg2.l1c.m1.2.2.1.2.3"><in id="alg2.l1c.m1.2.2.1.2.3.1.cmml" xref="alg2.l1c.m1.2.2.1.2.3.1"></in><ci id="alg2.l1c.m1.2.2.1.2.3.2.cmml" xref="alg2.l1c.m1.2.2.1.2.3.2">𝑐</ci><apply id="alg2.l1c.m1.2.2.1.2.3.3.cmml" xref="alg2.l1c.m1.2.2.1.2.3.3"><csymbol cd="ambiguous" id="alg2.l1c.m1.2.2.1.2.3.3.1.cmml" xref="alg2.l1c.m1.2.2.1.2.3.3">superscript</csymbol><ci id="alg2.l1c.m1.2.2.1.2.3.3.2.cmml" xref="alg2.l1c.m1.2.2.1.2.3.3.2">𝒰</ci><ci id="alg2.l1c.m1.2.2.1.2.3.3.3.cmml" xref="alg2.l1c.m1.2.2.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg2.l1c.m1.2.2.1.3.cmml" xref="alg2.l1c.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l1c.m1.2.2.1.3.1.cmml" xref="alg2.l1c.m1.2.2.1.3">subscript</csymbol><apply id="alg2.l1c.m1.2.2.1.3.2.cmml" xref="alg2.l1c.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l1c.m1.2.2.1.3.2.1.cmml" xref="alg2.l1c.m1.2.2.1.3">superscript</csymbol><ci id="alg2.l1c.m1.2.2.1.3.2.2.cmml" xref="alg2.l1c.m1.2.2.1.3.2.2">𝑊</ci><ci id="alg2.l1c.m1.2.2.1.1.1.1.cmml" xref="alg2.l1c.m1.2.2.1.1.1.1">𝑐</ci></apply><ci id="alg2.l1c.m1.2.2.1.3.3.cmml" xref="alg2.l1c.m1.2.2.1.3.3">𝑡</ci></apply></apply><apply id="alg2.l1c.m1.3.3.2.2.cmml" xref="alg2.l1c.m1.3.3.2.1"><abs id="alg2.l1c.m1.3.3.2.2.1.cmml" xref="alg2.l1c.m1.3.3.2.1.2"></abs><apply id="alg2.l1c.m1.3.3.2.1.1.cmml" xref="alg2.l1c.m1.3.3.2.1.1"><csymbol cd="ambiguous" id="alg2.l1c.m1.3.3.2.1.1.1.cmml" xref="alg2.l1c.m1.3.3.2.1.1">superscript</csymbol><ci id="alg2.l1c.m1.3.3.2.1.1.2.cmml" xref="alg2.l1c.m1.3.3.2.1.1.2">𝒰</ci><ci id="alg2.l1c.m1.3.3.2.1.1.3.cmml" xref="alg2.l1c.m1.3.3.2.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1c.m1.3c">W^{(s)}_{t+1}\leftarrow\frac{\sum_{c\in\mathcal{U}^{t}}W^{(c)}_{t}}{\left|\mathcal{U}^{t}\right|}</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F2.sf1" class="ltx_figure ltx_figure_panel">
<div id="S3.F2.sf1.1" class="ltx_block ltx_minipage ltx_align_top" style="width:138.8pt;">
<img src="/html/2106.00275/assets/FMNIST_Methods.png" id="S3.F2.sf1.1.g1" class="ltx_graphics ltx_img_square" width="698" height="617" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Methods On FMNIST</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F2.sf2" class="ltx_figure ltx_figure_panel">
<div id="S3.F2.sf2.1" class="ltx_block ltx_minipage ltx_align_top" style="width:138.8pt;">
<img src="/html/2106.00275/assets/CIFAR10_Methods.png" id="S3.F2.sf2.1.g1" class="ltx_graphics ltx_img_square" width="698" height="617" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Methods On CIFAR10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F2.sf3" class="ltx_figure ltx_figure_panel">
<div id="S3.F2.sf3.1" class="ltx_block ltx_minipage ltx_align_top" style="width:138.8pt;">
<img src="/html/2106.00275/assets/Participating_Ratio.png" id="S3.F2.sf3.1.g1" class="ltx_graphics ltx_img_square" width="698" height="617" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Participating Ratio <math id="S3.F2.sf3.3.m1.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S3.F2.sf3.3.m1.1b"><mi class="ltx_font_mathcaligraphic" id="S3.F2.sf3.3.m1.1.1" xref="S3.F2.sf3.3.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.F2.sf3.3.m1.1c"><ci id="S3.F2.sf3.3.m1.1.1.cmml" xref="S3.F2.sf3.3.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf3.3.m1.1d">\mathcal{P}</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F2.sf4" class="ltx_figure ltx_figure_panel">
<div id="S3.F2.sf4.1" class="ltx_block ltx_minipage ltx_align_top" style="width:138.8pt;">
<img src="/html/2106.00275/assets/Sampling_Probability.png" id="S3.F2.sf4.1.g1" class="ltx_graphics ltx_img_square" width="698" height="617" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Sampling Probability <math id="S3.F2.sf4.3.m1.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.F2.sf4.3.m1.1b"><mi class="ltx_font_mathcaligraphic" id="S3.F2.sf4.3.m1.1.1" xref="S3.F2.sf4.3.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.F2.sf4.3.m1.1c"><ci id="S3.F2.sf4.3.m1.1.1.cmml" xref="S3.F2.sf4.3.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf4.3.m1.1d">\mathcal{S}</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F2.sf5" class="ltx_figure ltx_figure_panel">
<div id="S3.F2.sf5.1" class="ltx_block ltx_minipage ltx_align_top" style="width:138.8pt;">
<img src="/html/2106.00275/assets/Compression_Ratio.png" id="S3.F2.sf5.1.g1" class="ltx_graphics ltx_img_square" width="698" height="617" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>Compression Ratio <math id="S3.F2.sf5.3.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.F2.sf5.3.m1.1b"><mi class="ltx_font_mathcaligraphic" id="S3.F2.sf5.3.m1.1.1" xref="S3.F2.sf5.3.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.F2.sf5.3.m1.1c"><ci id="S3.F2.sf5.3.m1.1.1.cmml" xref="S3.F2.sf5.3.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf5.3.m1.1d">\mathcal{C}</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F2.sf6" class="ltx_figure ltx_figure_panel">
<div id="S3.F2.sf6.1" class="ltx_block ltx_minipage ltx_align_top" style="width:138.8pt;">
<img src="/html/2106.00275/assets/Noise_Level.png" id="S3.F2.sf6.1.g1" class="ltx_graphics ltx_img_square" width="698" height="617" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>Noise Level <math id="S3.F2.sf6.3.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.F2.sf6.3.m1.1b"><mi id="S3.F2.sf6.3.m1.1.1" xref="S3.F2.sf6.3.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.F2.sf6.3.m1.1c"><ci id="S3.F2.sf6.3.m1.1.1.cmml" xref="S3.F2.sf6.3.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf6.3.m1.1d">\sigma</annotation></semantics></math></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Behavior of the Model Performance and Influence of Different Parameters for H-FL.</figcaption>
</figure>
<div id="S3.SS4.p5" class="ltx_para">
<p id="S3.SS4.p5.4" class="ltx_p">After we obtain rectified <math id="S3.SS4.p5.1.m1.1" class="ltx_Math" alttext="dW^{(c)}" display="inline"><semantics id="S3.SS4.p5.1.m1.1a"><mrow id="S3.SS4.p5.1.m1.1.2" xref="S3.SS4.p5.1.m1.1.2.cmml"><mi id="S3.SS4.p5.1.m1.1.2.2" xref="S3.SS4.p5.1.m1.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.1.m1.1.2.1" xref="S3.SS4.p5.1.m1.1.2.1.cmml">​</mo><msup id="S3.SS4.p5.1.m1.1.2.3" xref="S3.SS4.p5.1.m1.1.2.3.cmml"><mi id="S3.SS4.p5.1.m1.1.2.3.2" xref="S3.SS4.p5.1.m1.1.2.3.2.cmml">W</mi><mrow id="S3.SS4.p5.1.m1.1.1.1.3" xref="S3.SS4.p5.1.m1.1.2.3.cmml"><mo stretchy="false" id="S3.SS4.p5.1.m1.1.1.1.3.1" xref="S3.SS4.p5.1.m1.1.2.3.cmml">(</mo><mi id="S3.SS4.p5.1.m1.1.1.1.1" xref="S3.SS4.p5.1.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p5.1.m1.1.1.1.3.2" xref="S3.SS4.p5.1.m1.1.2.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.1.m1.1b"><apply id="S3.SS4.p5.1.m1.1.2.cmml" xref="S3.SS4.p5.1.m1.1.2"><times id="S3.SS4.p5.1.m1.1.2.1.cmml" xref="S3.SS4.p5.1.m1.1.2.1"></times><ci id="S3.SS4.p5.1.m1.1.2.2.cmml" xref="S3.SS4.p5.1.m1.1.2.2">𝑑</ci><apply id="S3.SS4.p5.1.m1.1.2.3.cmml" xref="S3.SS4.p5.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p5.1.m1.1.2.3.1.cmml" xref="S3.SS4.p5.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS4.p5.1.m1.1.2.3.2.cmml" xref="S3.SS4.p5.1.m1.1.2.3.2">𝑊</ci><ci id="S3.SS4.p5.1.m1.1.1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.1.m1.1c">dW^{(c)}</annotation></semantics></math>, we conduct gradient clipping so that the <math id="S3.SS4.p5.2.m2.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S3.SS4.p5.2.m2.1a"><msub id="S3.SS4.p5.2.m2.1.1" xref="S3.SS4.p5.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p5.2.m2.1.1.2" xref="S3.SS4.p5.2.m2.1.1.2.cmml">ℓ</mi><mn id="S3.SS4.p5.2.m2.1.1.3" xref="S3.SS4.p5.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.2.m2.1b"><apply id="S3.SS4.p5.2.m2.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.2.m2.1.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p5.2.m2.1.1.2.cmml" xref="S3.SS4.p5.2.m2.1.1.2">ℓ</ci><cn type="integer" id="S3.SS4.p5.2.m2.1.1.3.cmml" xref="S3.SS4.p5.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.2.m2.1c">\ell_{2}</annotation></semantics></math> norm of <math id="S3.SS4.p5.3.m3.1" class="ltx_Math" alttext="dW^{(c)}" display="inline"><semantics id="S3.SS4.p5.3.m3.1a"><mrow id="S3.SS4.p5.3.m3.1.2" xref="S3.SS4.p5.3.m3.1.2.cmml"><mi id="S3.SS4.p5.3.m3.1.2.2" xref="S3.SS4.p5.3.m3.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.3.m3.1.2.1" xref="S3.SS4.p5.3.m3.1.2.1.cmml">​</mo><msup id="S3.SS4.p5.3.m3.1.2.3" xref="S3.SS4.p5.3.m3.1.2.3.cmml"><mi id="S3.SS4.p5.3.m3.1.2.3.2" xref="S3.SS4.p5.3.m3.1.2.3.2.cmml">W</mi><mrow id="S3.SS4.p5.3.m3.1.1.1.3" xref="S3.SS4.p5.3.m3.1.2.3.cmml"><mo stretchy="false" id="S3.SS4.p5.3.m3.1.1.1.3.1" xref="S3.SS4.p5.3.m3.1.2.3.cmml">(</mo><mi id="S3.SS4.p5.3.m3.1.1.1.1" xref="S3.SS4.p5.3.m3.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p5.3.m3.1.1.1.3.2" xref="S3.SS4.p5.3.m3.1.2.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.3.m3.1b"><apply id="S3.SS4.p5.3.m3.1.2.cmml" xref="S3.SS4.p5.3.m3.1.2"><times id="S3.SS4.p5.3.m3.1.2.1.cmml" xref="S3.SS4.p5.3.m3.1.2.1"></times><ci id="S3.SS4.p5.3.m3.1.2.2.cmml" xref="S3.SS4.p5.3.m3.1.2.2">𝑑</ci><apply id="S3.SS4.p5.3.m3.1.2.3.cmml" xref="S3.SS4.p5.3.m3.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p5.3.m3.1.2.3.1.cmml" xref="S3.SS4.p5.3.m3.1.2.3">superscript</csymbol><ci id="S3.SS4.p5.3.m3.1.2.3.2.cmml" xref="S3.SS4.p5.3.m3.1.2.3.2">𝑊</ci><ci id="S3.SS4.p5.3.m3.1.1.1.1.cmml" xref="S3.SS4.p5.3.m3.1.1.1.1">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.3.m3.1c">dW^{(c)}</annotation></semantics></math> is limited to <math id="S3.SS4.p5.4.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS4.p5.4.m4.1a"><mi id="S3.SS4.p5.4.m4.1.1" xref="S3.SS4.p5.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.4.m4.1b"><ci id="S3.SS4.p5.4.m4.1.1.cmml" xref="S3.SS4.p5.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.4.m4.1c">L</annotation></semantics></math> and then add noise for it in order to protect privacy:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.8" class="ltx_Math" alttext="g^{(c)}\leftarrow\frac{g^{(c)}}{\max\left(1,\left\|g^{(c)}\right\|_{2}/L\right)}+\mathcal{N}\left(0,\frac{\sigma^{2}L^{2}I}{n^{(c)}}\right)" display="block"><semantics id="S3.E8.m1.8a"><mrow id="S3.E8.m1.8.9" xref="S3.E8.m1.8.9.cmml"><msup id="S3.E8.m1.8.9.2" xref="S3.E8.m1.8.9.2.cmml"><mi id="S3.E8.m1.8.9.2.2" xref="S3.E8.m1.8.9.2.2.cmml">g</mi><mrow id="S3.E8.m1.1.1.1.3" xref="S3.E8.m1.8.9.2.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.3.1" xref="S3.E8.m1.8.9.2.cmml">(</mo><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E8.m1.1.1.1.3.2" xref="S3.E8.m1.8.9.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.E8.m1.8.9.1" xref="S3.E8.m1.8.9.1.cmml">←</mo><mrow id="S3.E8.m1.8.9.3" xref="S3.E8.m1.8.9.3.cmml"><mfrac id="S3.E8.m1.6.6" xref="S3.E8.m1.6.6.cmml"><msup id="S3.E8.m1.2.2.1" xref="S3.E8.m1.2.2.1.cmml"><mi id="S3.E8.m1.2.2.1.3" xref="S3.E8.m1.2.2.1.3.cmml">g</mi><mrow id="S3.E8.m1.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.3.1" xref="S3.E8.m1.2.2.1.cmml">(</mo><mi id="S3.E8.m1.2.2.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.3.2" xref="S3.E8.m1.2.2.1.cmml">)</mo></mrow></msup><mrow id="S3.E8.m1.6.6.5.4" xref="S3.E8.m1.6.6.5.5.cmml"><mi id="S3.E8.m1.4.4.3.2" xref="S3.E8.m1.4.4.3.2.cmml">max</mi><mo id="S3.E8.m1.6.6.5.4a" xref="S3.E8.m1.6.6.5.5.cmml">⁡</mo><mrow id="S3.E8.m1.6.6.5.4.1" xref="S3.E8.m1.6.6.5.5.cmml"><mo id="S3.E8.m1.6.6.5.4.1.2" xref="S3.E8.m1.6.6.5.5.cmml">(</mo><mn id="S3.E8.m1.5.5.4.3" xref="S3.E8.m1.5.5.4.3.cmml">1</mn><mo id="S3.E8.m1.6.6.5.4.1.3" xref="S3.E8.m1.6.6.5.5.cmml">,</mo><mrow id="S3.E8.m1.6.6.5.4.1.1" xref="S3.E8.m1.6.6.5.4.1.1.cmml"><msub id="S3.E8.m1.6.6.5.4.1.1.1" xref="S3.E8.m1.6.6.5.4.1.1.1.cmml"><mrow id="S3.E8.m1.6.6.5.4.1.1.1.1.1" xref="S3.E8.m1.6.6.5.4.1.1.1.1.2.cmml"><mo id="S3.E8.m1.6.6.5.4.1.1.1.1.1.2" xref="S3.E8.m1.6.6.5.4.1.1.1.1.2.1.cmml">‖</mo><msup id="S3.E8.m1.6.6.5.4.1.1.1.1.1.1" xref="S3.E8.m1.6.6.5.4.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.6.6.5.4.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.5.4.1.1.1.1.1.1.2.cmml">g</mi><mrow id="S3.E8.m1.3.3.2.1.1.3" xref="S3.E8.m1.6.6.5.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.3.3.2.1.1.3.1" xref="S3.E8.m1.6.6.5.4.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E8.m1.3.3.2.1.1.1" xref="S3.E8.m1.3.3.2.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E8.m1.3.3.2.1.1.3.2" xref="S3.E8.m1.6.6.5.4.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E8.m1.6.6.5.4.1.1.1.1.1.3" xref="S3.E8.m1.6.6.5.4.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E8.m1.6.6.5.4.1.1.1.3" xref="S3.E8.m1.6.6.5.4.1.1.1.3.cmml">2</mn></msub><mo id="S3.E8.m1.6.6.5.4.1.1.2" xref="S3.E8.m1.6.6.5.4.1.1.2.cmml">/</mo><mi id="S3.E8.m1.6.6.5.4.1.1.3" xref="S3.E8.m1.6.6.5.4.1.1.3.cmml">L</mi></mrow><mo id="S3.E8.m1.6.6.5.4.1.4" xref="S3.E8.m1.6.6.5.5.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E8.m1.8.9.3.1" xref="S3.E8.m1.8.9.3.1.cmml">+</mo><mrow id="S3.E8.m1.8.9.3.2" xref="S3.E8.m1.8.9.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.8.9.3.2.2" xref="S3.E8.m1.8.9.3.2.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.8.9.3.2.1" xref="S3.E8.m1.8.9.3.2.1.cmml">​</mo><mrow id="S3.E8.m1.8.9.3.2.3.2" xref="S3.E8.m1.8.9.3.2.3.1.cmml"><mo id="S3.E8.m1.8.9.3.2.3.2.1" xref="S3.E8.m1.8.9.3.2.3.1.cmml">(</mo><mn id="S3.E8.m1.8.8" xref="S3.E8.m1.8.8.cmml">0</mn><mo id="S3.E8.m1.8.9.3.2.3.2.2" xref="S3.E8.m1.8.9.3.2.3.1.cmml">,</mo><mfrac id="S3.E8.m1.7.7" xref="S3.E8.m1.7.7.cmml"><mrow id="S3.E8.m1.7.7.3" xref="S3.E8.m1.7.7.3.cmml"><msup id="S3.E8.m1.7.7.3.2" xref="S3.E8.m1.7.7.3.2.cmml"><mi id="S3.E8.m1.7.7.3.2.2" xref="S3.E8.m1.7.7.3.2.2.cmml">σ</mi><mn id="S3.E8.m1.7.7.3.2.3" xref="S3.E8.m1.7.7.3.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.E8.m1.7.7.3.1" xref="S3.E8.m1.7.7.3.1.cmml">​</mo><msup id="S3.E8.m1.7.7.3.3" xref="S3.E8.m1.7.7.3.3.cmml"><mi id="S3.E8.m1.7.7.3.3.2" xref="S3.E8.m1.7.7.3.3.2.cmml">L</mi><mn id="S3.E8.m1.7.7.3.3.3" xref="S3.E8.m1.7.7.3.3.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.E8.m1.7.7.3.1a" xref="S3.E8.m1.7.7.3.1.cmml">​</mo><mi id="S3.E8.m1.7.7.3.4" xref="S3.E8.m1.7.7.3.4.cmml">I</mi></mrow><msup id="S3.E8.m1.7.7.1" xref="S3.E8.m1.7.7.1.cmml"><mi id="S3.E8.m1.7.7.1.3" xref="S3.E8.m1.7.7.1.3.cmml">n</mi><mrow id="S3.E8.m1.7.7.1.1.1.3" xref="S3.E8.m1.7.7.1.cmml"><mo stretchy="false" id="S3.E8.m1.7.7.1.1.1.3.1" xref="S3.E8.m1.7.7.1.cmml">(</mo><mi id="S3.E8.m1.7.7.1.1.1.1" xref="S3.E8.m1.7.7.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E8.m1.7.7.1.1.1.3.2" xref="S3.E8.m1.7.7.1.cmml">)</mo></mrow></msup></mfrac><mo id="S3.E8.m1.8.9.3.2.3.2.3" xref="S3.E8.m1.8.9.3.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.8b"><apply id="S3.E8.m1.8.9.cmml" xref="S3.E8.m1.8.9"><ci id="S3.E8.m1.8.9.1.cmml" xref="S3.E8.m1.8.9.1">←</ci><apply id="S3.E8.m1.8.9.2.cmml" xref="S3.E8.m1.8.9.2"><csymbol cd="ambiguous" id="S3.E8.m1.8.9.2.1.cmml" xref="S3.E8.m1.8.9.2">superscript</csymbol><ci id="S3.E8.m1.8.9.2.2.cmml" xref="S3.E8.m1.8.9.2.2">𝑔</ci><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝑐</ci></apply><apply id="S3.E8.m1.8.9.3.cmml" xref="S3.E8.m1.8.9.3"><plus id="S3.E8.m1.8.9.3.1.cmml" xref="S3.E8.m1.8.9.3.1"></plus><apply id="S3.E8.m1.6.6.cmml" xref="S3.E8.m1.6.6"><divide id="S3.E8.m1.6.6.6.cmml" xref="S3.E8.m1.6.6"></divide><apply id="S3.E8.m1.2.2.1.cmml" xref="S3.E8.m1.2.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.2.cmml" xref="S3.E8.m1.2.2.1">superscript</csymbol><ci id="S3.E8.m1.2.2.1.3.cmml" xref="S3.E8.m1.2.2.1.3">𝑔</ci><ci id="S3.E8.m1.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1">𝑐</ci></apply><apply id="S3.E8.m1.6.6.5.5.cmml" xref="S3.E8.m1.6.6.5.4"><max id="S3.E8.m1.4.4.3.2.cmml" xref="S3.E8.m1.4.4.3.2"></max><cn type="integer" id="S3.E8.m1.5.5.4.3.cmml" xref="S3.E8.m1.5.5.4.3">1</cn><apply id="S3.E8.m1.6.6.5.4.1.1.cmml" xref="S3.E8.m1.6.6.5.4.1.1"><divide id="S3.E8.m1.6.6.5.4.1.1.2.cmml" xref="S3.E8.m1.6.6.5.4.1.1.2"></divide><apply id="S3.E8.m1.6.6.5.4.1.1.1.cmml" xref="S3.E8.m1.6.6.5.4.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.5.4.1.1.1.2.cmml" xref="S3.E8.m1.6.6.5.4.1.1.1">subscript</csymbol><apply id="S3.E8.m1.6.6.5.4.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.5.4.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.6.6.5.4.1.1.1.1.2.1.cmml" xref="S3.E8.m1.6.6.5.4.1.1.1.1.1.2">norm</csymbol><apply id="S3.E8.m1.6.6.5.4.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.5.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.5.4.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.5.4.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m1.6.6.5.4.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.5.4.1.1.1.1.1.1.2">𝑔</ci><ci id="S3.E8.m1.3.3.2.1.1.1.cmml" xref="S3.E8.m1.3.3.2.1.1.1">𝑐</ci></apply></apply><cn type="integer" id="S3.E8.m1.6.6.5.4.1.1.1.3.cmml" xref="S3.E8.m1.6.6.5.4.1.1.1.3">2</cn></apply><ci id="S3.E8.m1.6.6.5.4.1.1.3.cmml" xref="S3.E8.m1.6.6.5.4.1.1.3">𝐿</ci></apply></apply></apply><apply id="S3.E8.m1.8.9.3.2.cmml" xref="S3.E8.m1.8.9.3.2"><times id="S3.E8.m1.8.9.3.2.1.cmml" xref="S3.E8.m1.8.9.3.2.1"></times><ci id="S3.E8.m1.8.9.3.2.2.cmml" xref="S3.E8.m1.8.9.3.2.2">𝒩</ci><interval closure="open" id="S3.E8.m1.8.9.3.2.3.1.cmml" xref="S3.E8.m1.8.9.3.2.3.2"><cn type="integer" id="S3.E8.m1.8.8.cmml" xref="S3.E8.m1.8.8">0</cn><apply id="S3.E8.m1.7.7.cmml" xref="S3.E8.m1.7.7"><divide id="S3.E8.m1.7.7.2.cmml" xref="S3.E8.m1.7.7"></divide><apply id="S3.E8.m1.7.7.3.cmml" xref="S3.E8.m1.7.7.3"><times id="S3.E8.m1.7.7.3.1.cmml" xref="S3.E8.m1.7.7.3.1"></times><apply id="S3.E8.m1.7.7.3.2.cmml" xref="S3.E8.m1.7.7.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.3.2.1.cmml" xref="S3.E8.m1.7.7.3.2">superscript</csymbol><ci id="S3.E8.m1.7.7.3.2.2.cmml" xref="S3.E8.m1.7.7.3.2.2">𝜎</ci><cn type="integer" id="S3.E8.m1.7.7.3.2.3.cmml" xref="S3.E8.m1.7.7.3.2.3">2</cn></apply><apply id="S3.E8.m1.7.7.3.3.cmml" xref="S3.E8.m1.7.7.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.3.3.1.cmml" xref="S3.E8.m1.7.7.3.3">superscript</csymbol><ci id="S3.E8.m1.7.7.3.3.2.cmml" xref="S3.E8.m1.7.7.3.3.2">𝐿</ci><cn type="integer" id="S3.E8.m1.7.7.3.3.3.cmml" xref="S3.E8.m1.7.7.3.3.3">2</cn></apply><ci id="S3.E8.m1.7.7.3.4.cmml" xref="S3.E8.m1.7.7.3.4">𝐼</ci></apply><apply id="S3.E8.m1.7.7.1.cmml" xref="S3.E8.m1.7.7.1"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.2.cmml" xref="S3.E8.m1.7.7.1">superscript</csymbol><ci id="S3.E8.m1.7.7.1.3.cmml" xref="S3.E8.m1.7.7.1.3">𝑛</ci><ci id="S3.E8.m1.7.7.1.1.1.1.cmml" xref="S3.E8.m1.7.7.1.1.1.1">𝑐</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.8c">g^{(c)}\leftarrow\frac{g^{(c)}}{\max\left(1,\left\|g^{(c)}\right\|_{2}/L\right)}+\mathcal{N}\left(0,\frac{\sigma^{2}L^{2}I}{n^{(c)}}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p6" class="ltx_para">
<p id="S3.SS4.p6.6" class="ltx_p">where <math id="S3.SS4.p6.1.m1.1" class="ltx_Math" alttext="g^{(c)}" display="inline"><semantics id="S3.SS4.p6.1.m1.1a"><msup id="S3.SS4.p6.1.m1.1.2" xref="S3.SS4.p6.1.m1.1.2.cmml"><mi id="S3.SS4.p6.1.m1.1.2.2" xref="S3.SS4.p6.1.m1.1.2.2.cmml">g</mi><mrow id="S3.SS4.p6.1.m1.1.1.1.3" xref="S3.SS4.p6.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p6.1.m1.1.1.1.3.1" xref="S3.SS4.p6.1.m1.1.2.cmml">(</mo><mi id="S3.SS4.p6.1.m1.1.1.1.1" xref="S3.SS4.p6.1.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p6.1.m1.1.1.1.3.2" xref="S3.SS4.p6.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.1.m1.1b"><apply id="S3.SS4.p6.1.m1.1.2.cmml" xref="S3.SS4.p6.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p6.1.m1.1.2.1.cmml" xref="S3.SS4.p6.1.m1.1.2">superscript</csymbol><ci id="S3.SS4.p6.1.m1.1.2.2.cmml" xref="S3.SS4.p6.1.m1.1.2.2">𝑔</ci><ci id="S3.SS4.p6.1.m1.1.1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.1.m1.1c">g^{(c)}</annotation></semantics></math> is <math id="S3.SS4.p6.2.m2.1" class="ltx_Math" alttext="dW^{(c)}" display="inline"><semantics id="S3.SS4.p6.2.m2.1a"><mrow id="S3.SS4.p6.2.m2.1.2" xref="S3.SS4.p6.2.m2.1.2.cmml"><mi id="S3.SS4.p6.2.m2.1.2.2" xref="S3.SS4.p6.2.m2.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p6.2.m2.1.2.1" xref="S3.SS4.p6.2.m2.1.2.1.cmml">​</mo><msup id="S3.SS4.p6.2.m2.1.2.3" xref="S3.SS4.p6.2.m2.1.2.3.cmml"><mi id="S3.SS4.p6.2.m2.1.2.3.2" xref="S3.SS4.p6.2.m2.1.2.3.2.cmml">W</mi><mrow id="S3.SS4.p6.2.m2.1.1.1.3" xref="S3.SS4.p6.2.m2.1.2.3.cmml"><mo stretchy="false" id="S3.SS4.p6.2.m2.1.1.1.3.1" xref="S3.SS4.p6.2.m2.1.2.3.cmml">(</mo><mi id="S3.SS4.p6.2.m2.1.1.1.1" xref="S3.SS4.p6.2.m2.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p6.2.m2.1.1.1.3.2" xref="S3.SS4.p6.2.m2.1.2.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.2.m2.1b"><apply id="S3.SS4.p6.2.m2.1.2.cmml" xref="S3.SS4.p6.2.m2.1.2"><times id="S3.SS4.p6.2.m2.1.2.1.cmml" xref="S3.SS4.p6.2.m2.1.2.1"></times><ci id="S3.SS4.p6.2.m2.1.2.2.cmml" xref="S3.SS4.p6.2.m2.1.2.2">𝑑</ci><apply id="S3.SS4.p6.2.m2.1.2.3.cmml" xref="S3.SS4.p6.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p6.2.m2.1.2.3.1.cmml" xref="S3.SS4.p6.2.m2.1.2.3">superscript</csymbol><ci id="S3.SS4.p6.2.m2.1.2.3.2.cmml" xref="S3.SS4.p6.2.m2.1.2.3.2">𝑊</ci><ci id="S3.SS4.p6.2.m2.1.1.1.1.cmml" xref="S3.SS4.p6.2.m2.1.1.1.1">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.2.m2.1c">dW^{(c)}</annotation></semantics></math> itself, <math id="S3.SS4.p6.3.m3.1" class="ltx_Math" alttext="n^{(c)}" display="inline"><semantics id="S3.SS4.p6.3.m3.1a"><msup id="S3.SS4.p6.3.m3.1.2" xref="S3.SS4.p6.3.m3.1.2.cmml"><mi id="S3.SS4.p6.3.m3.1.2.2" xref="S3.SS4.p6.3.m3.1.2.2.cmml">n</mi><mrow id="S3.SS4.p6.3.m3.1.1.1.3" xref="S3.SS4.p6.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS4.p6.3.m3.1.1.1.3.1" xref="S3.SS4.p6.3.m3.1.2.cmml">(</mo><mi id="S3.SS4.p6.3.m3.1.1.1.1" xref="S3.SS4.p6.3.m3.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.p6.3.m3.1.1.1.3.2" xref="S3.SS4.p6.3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.3.m3.1b"><apply id="S3.SS4.p6.3.m3.1.2.cmml" xref="S3.SS4.p6.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS4.p6.3.m3.1.2.1.cmml" xref="S3.SS4.p6.3.m3.1.2">superscript</csymbol><ci id="S3.SS4.p6.3.m3.1.2.2.cmml" xref="S3.SS4.p6.3.m3.1.2.2">𝑛</ci><ci id="S3.SS4.p6.3.m3.1.1.1.1.cmml" xref="S3.SS4.p6.3.m3.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.3.m3.1c">n^{(c)}</annotation></semantics></math> is the size of the sampled mini-batch in client <math id="S3.SS4.p6.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS4.p6.4.m4.1a"><mi id="S3.SS4.p6.4.m4.1.1" xref="S3.SS4.p6.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.4.m4.1b"><ci id="S3.SS4.p6.4.m4.1.1.cmml" xref="S3.SS4.p6.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.4.m4.1c">c</annotation></semantics></math>, <math id="S3.SS4.p6.5.m5.1" class="ltx_Math" alttext="\mathcal{N}" display="inline"><semantics id="S3.SS4.p6.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.5.m5.1.1" xref="S3.SS4.p6.5.m5.1.1.cmml">𝒩</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.5.m5.1b"><ci id="S3.SS4.p6.5.m5.1.1.cmml" xref="S3.SS4.p6.5.m5.1.1">𝒩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.5.m5.1c">\mathcal{N}</annotation></semantics></math> is the Gaussian distribution with mean <span id="S3.SS4.p6.6.1" class="ltx_text ltx_font_italic">0</span> and standard deviation <math id="S3.SS4.p6.6.m6.1" class="ltx_Math" alttext="\sigma LI/\sqrt{n}" display="inline"><semantics id="S3.SS4.p6.6.m6.1a"><mrow id="S3.SS4.p6.6.m6.1.1" xref="S3.SS4.p6.6.m6.1.1.cmml"><mrow id="S3.SS4.p6.6.m6.1.1.2" xref="S3.SS4.p6.6.m6.1.1.2.cmml"><mi id="S3.SS4.p6.6.m6.1.1.2.2" xref="S3.SS4.p6.6.m6.1.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p6.6.m6.1.1.2.1" xref="S3.SS4.p6.6.m6.1.1.2.1.cmml">​</mo><mi id="S3.SS4.p6.6.m6.1.1.2.3" xref="S3.SS4.p6.6.m6.1.1.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p6.6.m6.1.1.2.1a" xref="S3.SS4.p6.6.m6.1.1.2.1.cmml">​</mo><mi id="S3.SS4.p6.6.m6.1.1.2.4" xref="S3.SS4.p6.6.m6.1.1.2.4.cmml">I</mi></mrow><mo id="S3.SS4.p6.6.m6.1.1.1" xref="S3.SS4.p6.6.m6.1.1.1.cmml">/</mo><msqrt id="S3.SS4.p6.6.m6.1.1.3" xref="S3.SS4.p6.6.m6.1.1.3.cmml"><mi id="S3.SS4.p6.6.m6.1.1.3.2" xref="S3.SS4.p6.6.m6.1.1.3.2.cmml">n</mi></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.6.m6.1b"><apply id="S3.SS4.p6.6.m6.1.1.cmml" xref="S3.SS4.p6.6.m6.1.1"><divide id="S3.SS4.p6.6.m6.1.1.1.cmml" xref="S3.SS4.p6.6.m6.1.1.1"></divide><apply id="S3.SS4.p6.6.m6.1.1.2.cmml" xref="S3.SS4.p6.6.m6.1.1.2"><times id="S3.SS4.p6.6.m6.1.1.2.1.cmml" xref="S3.SS4.p6.6.m6.1.1.2.1"></times><ci id="S3.SS4.p6.6.m6.1.1.2.2.cmml" xref="S3.SS4.p6.6.m6.1.1.2.2">𝜎</ci><ci id="S3.SS4.p6.6.m6.1.1.2.3.cmml" xref="S3.SS4.p6.6.m6.1.1.2.3">𝐿</ci><ci id="S3.SS4.p6.6.m6.1.1.2.4.cmml" xref="S3.SS4.p6.6.m6.1.1.2.4">𝐼</ci></apply><apply id="S3.SS4.p6.6.m6.1.1.3.cmml" xref="S3.SS4.p6.6.m6.1.1.3"><root id="S3.SS4.p6.6.m6.1.1.3a.cmml" xref="S3.SS4.p6.6.m6.1.1.3"></root><ci id="S3.SS4.p6.6.m6.1.1.3.2.cmml" xref="S3.SS4.p6.6.m6.1.1.3.2">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.6.m6.1c">\sigma LI/\sqrt{n}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS4.p7" class="ltx_para">
<p id="S3.SS4.p7.1" class="ltx_p">In summary, the workflow of H-FL mainly includes runtime distribution reconstruction, training and aggregation, the pseudo-code of which is given as Algorithm <a href="#alg2" title="Algorithm 2 ‣ 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="Thmtheorem1" class="ltx_theorem ltx_theorem_theorem">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmtheorem1.1.1.1" class="ltx_text ltx_font_bold">Theorem 1</span></span><span id="Thmtheorem1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmtheorem1.p1" class="ltx_para">
<p id="Thmtheorem1.p1.1" class="ltx_p"><span id="Thmtheorem1.p1.1.1" class="ltx_text ltx_font_italic">Formula (<a href="#S3.E8" title="In 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) satisfies differential privacy in distribute environment and the privacy loss can be tracked via moments accountant.</span></p>
</div>
</div>
<div id="S3.SS4.4" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="S3.SS4.1.p1" class="ltx_para">
<p id="S3.SS4.1.p1.1" class="ltx_p">We can consider the first term of formula (<a href="#S3.E8" title="In 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) as follows approximately:</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.9" class="ltx_Math" alttext="g^{(c)}=\frac{\sum_{i=1}^{n^{(c)}}g\left(x_{i}^{(c)}\right)/\max\left(1,\left\|g\left(x_{i}^{(c)}\right)\right\|_{2}/L\right)}{n^{(c)}}" display="block"><semantics id="S3.E9.m1.9a"><mrow id="S3.E9.m1.9.10" xref="S3.E9.m1.9.10.cmml"><msup id="S3.E9.m1.9.10.2" xref="S3.E9.m1.9.10.2.cmml"><mi id="S3.E9.m1.9.10.2.2" xref="S3.E9.m1.9.10.2.2.cmml">g</mi><mrow id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.9.10.2.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.3.1" xref="S3.E9.m1.9.10.2.cmml">(</mo><mi id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E9.m1.1.1.1.3.2" xref="S3.E9.m1.9.10.2.cmml">)</mo></mrow></msup><mo id="S3.E9.m1.9.10.1" xref="S3.E9.m1.9.10.1.cmml">=</mo><mfrac id="S3.E9.m1.9.9" xref="S3.E9.m1.9.9.cmml"><mrow id="S3.E9.m1.8.8.7" xref="S3.E9.m1.8.8.7.cmml"><msubsup id="S3.E9.m1.8.8.7.8" xref="S3.E9.m1.8.8.7.8.cmml"><mo id="S3.E9.m1.8.8.7.8.2.2" xref="S3.E9.m1.8.8.7.8.2.2.cmml">∑</mo><mrow id="S3.E9.m1.8.8.7.8.2.3" xref="S3.E9.m1.8.8.7.8.2.3.cmml"><mi id="S3.E9.m1.8.8.7.8.2.3.2" xref="S3.E9.m1.8.8.7.8.2.3.2.cmml">i</mi><mo id="S3.E9.m1.8.8.7.8.2.3.1" xref="S3.E9.m1.8.8.7.8.2.3.1.cmml">=</mo><mn id="S3.E9.m1.8.8.7.8.2.3.3" xref="S3.E9.m1.8.8.7.8.2.3.3.cmml">1</mn></mrow><msup id="S3.E9.m1.2.2.1.1.1" xref="S3.E9.m1.2.2.1.1.1.cmml"><mi id="S3.E9.m1.2.2.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.3.cmml">n</mi><mrow id="S3.E9.m1.2.2.1.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.1.1.1.1.1.3.1" xref="S3.E9.m1.2.2.1.1.1.cmml">(</mo><mi id="S3.E9.m1.2.2.1.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E9.m1.2.2.1.1.1.1.1.3.2" xref="S3.E9.m1.2.2.1.1.1.cmml">)</mo></mrow></msup></msubsup><mrow id="S3.E9.m1.8.8.7.7" xref="S3.E9.m1.8.8.7.7.cmml"><mrow id="S3.E9.m1.7.7.6.6.1" xref="S3.E9.m1.7.7.6.6.1.cmml"><mi id="S3.E9.m1.7.7.6.6.1.3" xref="S3.E9.m1.7.7.6.6.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.7.7.6.6.1.2" xref="S3.E9.m1.7.7.6.6.1.2.cmml">​</mo><mrow id="S3.E9.m1.7.7.6.6.1.1.1" xref="S3.E9.m1.7.7.6.6.1.1.1.1.cmml"><mo id="S3.E9.m1.7.7.6.6.1.1.1.2" xref="S3.E9.m1.7.7.6.6.1.1.1.1.cmml">(</mo><msubsup id="S3.E9.m1.7.7.6.6.1.1.1.1" xref="S3.E9.m1.7.7.6.6.1.1.1.1.cmml"><mi id="S3.E9.m1.7.7.6.6.1.1.1.1.2.2" xref="S3.E9.m1.7.7.6.6.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E9.m1.7.7.6.6.1.1.1.1.2.3" xref="S3.E9.m1.7.7.6.6.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E9.m1.3.3.2.2.1.3" xref="S3.E9.m1.7.7.6.6.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.3.3.2.2.1.3.1" xref="S3.E9.m1.7.7.6.6.1.1.1.1.cmml">(</mo><mi id="S3.E9.m1.3.3.2.2.1.1" xref="S3.E9.m1.3.3.2.2.1.1.cmml">c</mi><mo stretchy="false" id="S3.E9.m1.3.3.2.2.1.3.2" xref="S3.E9.m1.7.7.6.6.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E9.m1.7.7.6.6.1.1.1.3" xref="S3.E9.m1.7.7.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.8.8.7.7.3" xref="S3.E9.m1.8.8.7.7.3.cmml">/</mo><mrow id="S3.E9.m1.8.8.7.7.2.1" xref="S3.E9.m1.8.8.7.7.2.2.cmml"><mi id="S3.E9.m1.5.5.4.4" xref="S3.E9.m1.5.5.4.4.cmml">max</mi><mo id="S3.E9.m1.8.8.7.7.2.1a" xref="S3.E9.m1.8.8.7.7.2.2.cmml">⁡</mo><mrow id="S3.E9.m1.8.8.7.7.2.1.1" xref="S3.E9.m1.8.8.7.7.2.2.cmml"><mo id="S3.E9.m1.8.8.7.7.2.1.1.2" xref="S3.E9.m1.8.8.7.7.2.2.cmml">(</mo><mn id="S3.E9.m1.6.6.5.5" xref="S3.E9.m1.6.6.5.5.cmml">1</mn><mo id="S3.E9.m1.8.8.7.7.2.1.1.3" xref="S3.E9.m1.8.8.7.7.2.2.cmml">,</mo><mrow id="S3.E9.m1.8.8.7.7.2.1.1.1" xref="S3.E9.m1.8.8.7.7.2.1.1.1.cmml"><msub id="S3.E9.m1.8.8.7.7.2.1.1.1.1" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.cmml"><mrow id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.2.cmml"><mo id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.2" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.3" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.2" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E9.m1.4.4.3.3.1.3" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.4.4.3.3.1.3.1" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E9.m1.4.4.3.3.1.1" xref="S3.E9.m1.4.4.3.3.1.1.cmml">c</mi><mo stretchy="false" id="S3.E9.m1.4.4.3.3.1.3.2" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.3" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E9.m1.8.8.7.7.2.1.1.1.1.3" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E9.m1.8.8.7.7.2.1.1.1.2" xref="S3.E9.m1.8.8.7.7.2.1.1.1.2.cmml">/</mo><mi id="S3.E9.m1.8.8.7.7.2.1.1.1.3" xref="S3.E9.m1.8.8.7.7.2.1.1.1.3.cmml">L</mi></mrow><mo id="S3.E9.m1.8.8.7.7.2.1.1.4" xref="S3.E9.m1.8.8.7.7.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><msup id="S3.E9.m1.9.9.8" xref="S3.E9.m1.9.9.8.cmml"><mi id="S3.E9.m1.9.9.8.3" xref="S3.E9.m1.9.9.8.3.cmml">n</mi><mrow id="S3.E9.m1.9.9.8.1.1.3" xref="S3.E9.m1.9.9.8.cmml"><mo stretchy="false" id="S3.E9.m1.9.9.8.1.1.3.1" xref="S3.E9.m1.9.9.8.cmml">(</mo><mi id="S3.E9.m1.9.9.8.1.1.1" xref="S3.E9.m1.9.9.8.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E9.m1.9.9.8.1.1.3.2" xref="S3.E9.m1.9.9.8.cmml">)</mo></mrow></msup></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.9b"><apply id="S3.E9.m1.9.10.cmml" xref="S3.E9.m1.9.10"><eq id="S3.E9.m1.9.10.1.cmml" xref="S3.E9.m1.9.10.1"></eq><apply id="S3.E9.m1.9.10.2.cmml" xref="S3.E9.m1.9.10.2"><csymbol cd="ambiguous" id="S3.E9.m1.9.10.2.1.cmml" xref="S3.E9.m1.9.10.2">superscript</csymbol><ci id="S3.E9.m1.9.10.2.2.cmml" xref="S3.E9.m1.9.10.2.2">𝑔</ci><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">𝑐</ci></apply><apply id="S3.E9.m1.9.9.cmml" xref="S3.E9.m1.9.9"><divide id="S3.E9.m1.9.9.9.cmml" xref="S3.E9.m1.9.9"></divide><apply id="S3.E9.m1.8.8.7.cmml" xref="S3.E9.m1.8.8.7"><apply id="S3.E9.m1.8.8.7.8.cmml" xref="S3.E9.m1.8.8.7.8"><csymbol cd="ambiguous" id="S3.E9.m1.8.8.7.8.1.cmml" xref="S3.E9.m1.8.8.7.8">superscript</csymbol><apply id="S3.E9.m1.8.8.7.8.2.cmml" xref="S3.E9.m1.8.8.7.8"><csymbol cd="ambiguous" id="S3.E9.m1.8.8.7.8.2.1.cmml" xref="S3.E9.m1.8.8.7.8">subscript</csymbol><sum id="S3.E9.m1.8.8.7.8.2.2.cmml" xref="S3.E9.m1.8.8.7.8.2.2"></sum><apply id="S3.E9.m1.8.8.7.8.2.3.cmml" xref="S3.E9.m1.8.8.7.8.2.3"><eq id="S3.E9.m1.8.8.7.8.2.3.1.cmml" xref="S3.E9.m1.8.8.7.8.2.3.1"></eq><ci id="S3.E9.m1.8.8.7.8.2.3.2.cmml" xref="S3.E9.m1.8.8.7.8.2.3.2">𝑖</ci><cn type="integer" id="S3.E9.m1.8.8.7.8.2.3.3.cmml" xref="S3.E9.m1.8.8.7.8.2.3.3">1</cn></apply></apply><apply id="S3.E9.m1.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.E9.m1.2.2.1.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.1.3">𝑛</ci><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1">𝑐</ci></apply></apply><apply id="S3.E9.m1.8.8.7.7.cmml" xref="S3.E9.m1.8.8.7.7"><divide id="S3.E9.m1.8.8.7.7.3.cmml" xref="S3.E9.m1.8.8.7.7.3"></divide><apply id="S3.E9.m1.7.7.6.6.1.cmml" xref="S3.E9.m1.7.7.6.6.1"><times id="S3.E9.m1.7.7.6.6.1.2.cmml" xref="S3.E9.m1.7.7.6.6.1.2"></times><ci id="S3.E9.m1.7.7.6.6.1.3.cmml" xref="S3.E9.m1.7.7.6.6.1.3">𝑔</ci><apply id="S3.E9.m1.7.7.6.6.1.1.1.1.cmml" xref="S3.E9.m1.7.7.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.7.7.6.6.1.1.1.1.1.cmml" xref="S3.E9.m1.7.7.6.6.1.1.1">superscript</csymbol><apply id="S3.E9.m1.7.7.6.6.1.1.1.1.2.cmml" xref="S3.E9.m1.7.7.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.7.7.6.6.1.1.1.1.2.1.cmml" xref="S3.E9.m1.7.7.6.6.1.1.1">subscript</csymbol><ci id="S3.E9.m1.7.7.6.6.1.1.1.1.2.2.cmml" xref="S3.E9.m1.7.7.6.6.1.1.1.1.2.2">𝑥</ci><ci id="S3.E9.m1.7.7.6.6.1.1.1.1.2.3.cmml" xref="S3.E9.m1.7.7.6.6.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E9.m1.3.3.2.2.1.1.cmml" xref="S3.E9.m1.3.3.2.2.1.1">𝑐</ci></apply></apply><apply id="S3.E9.m1.8.8.7.7.2.2.cmml" xref="S3.E9.m1.8.8.7.7.2.1"><max id="S3.E9.m1.5.5.4.4.cmml" xref="S3.E9.m1.5.5.4.4"></max><cn type="integer" id="S3.E9.m1.6.6.5.5.cmml" xref="S3.E9.m1.6.6.5.5">1</cn><apply id="S3.E9.m1.8.8.7.7.2.1.1.1.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1"><divide id="S3.E9.m1.8.8.7.7.2.1.1.1.2.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.2"></divide><apply id="S3.E9.m1.8.8.7.7.2.1.1.1.1.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.8.8.7.7.2.1.1.1.1.2.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1">subscript</csymbol><apply id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.2.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1"><times id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.2"></times><ci id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.3">𝑔</ci><apply id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E9.m1.4.4.3.3.1.1.cmml" xref="S3.E9.m1.4.4.3.3.1.1">𝑐</ci></apply></apply></apply><cn type="integer" id="S3.E9.m1.8.8.7.7.2.1.1.1.1.3.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.1.3">2</cn></apply><ci id="S3.E9.m1.8.8.7.7.2.1.1.1.3.cmml" xref="S3.E9.m1.8.8.7.7.2.1.1.1.3">𝐿</ci></apply></apply></apply></apply><apply id="S3.E9.m1.9.9.8.cmml" xref="S3.E9.m1.9.9.8"><csymbol cd="ambiguous" id="S3.E9.m1.9.9.8.2.cmml" xref="S3.E9.m1.9.9.8">superscript</csymbol><ci id="S3.E9.m1.9.9.8.3.cmml" xref="S3.E9.m1.9.9.8.3">𝑛</ci><ci id="S3.E9.m1.9.9.8.1.1.1.cmml" xref="S3.E9.m1.9.9.8.1.1.1">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.9c">g^{(c)}=\frac{\sum_{i=1}^{n^{(c)}}g\left(x_{i}^{(c)}\right)/\max\left(1,\left\|g\left(x_{i}^{(c)}\right)\right\|_{2}/L\right)}{n^{(c)}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.2.p2" class="ltx_para">
<p id="S3.SS4.2.p2.2" class="ltx_p">where <span id="S3.SS4.2.p2.2.1" class="ltx_text ltx_font_italic">g</span> is the gradient of backward propagation, <math id="S3.SS4.2.p2.1.m1.1" class="ltx_Math" alttext="x_{i}^{(c)}" display="inline"><semantics id="S3.SS4.2.p2.1.m1.1a"><msubsup id="S3.SS4.2.p2.1.m1.1.2" xref="S3.SS4.2.p2.1.m1.1.2.cmml"><mi id="S3.SS4.2.p2.1.m1.1.2.2.2" xref="S3.SS4.2.p2.1.m1.1.2.2.2.cmml">x</mi><mi id="S3.SS4.2.p2.1.m1.1.2.2.3" xref="S3.SS4.2.p2.1.m1.1.2.2.3.cmml">i</mi><mrow id="S3.SS4.2.p2.1.m1.1.1.1.3" xref="S3.SS4.2.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS4.2.p2.1.m1.1.1.1.3.1" xref="S3.SS4.2.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS4.2.p2.1.m1.1.1.1.1" xref="S3.SS4.2.p2.1.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.2.p2.1.m1.1.1.1.3.2" xref="S3.SS4.2.p2.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.2.p2.1.m1.1b"><apply id="S3.SS4.2.p2.1.m1.1.2.cmml" xref="S3.SS4.2.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS4.2.p2.1.m1.1.2.1.cmml" xref="S3.SS4.2.p2.1.m1.1.2">superscript</csymbol><apply id="S3.SS4.2.p2.1.m1.1.2.2.cmml" xref="S3.SS4.2.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS4.2.p2.1.m1.1.2.2.1.cmml" xref="S3.SS4.2.p2.1.m1.1.2">subscript</csymbol><ci id="S3.SS4.2.p2.1.m1.1.2.2.2.cmml" xref="S3.SS4.2.p2.1.m1.1.2.2.2">𝑥</ci><ci id="S3.SS4.2.p2.1.m1.1.2.2.3.cmml" xref="S3.SS4.2.p2.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS4.2.p2.1.m1.1.1.1.1.cmml" xref="S3.SS4.2.p2.1.m1.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.2.p2.1.m1.1c">x_{i}^{(c)}</annotation></semantics></math> is the <span id="S3.SS4.2.p2.2.2" class="ltx_text ltx_font_italic">i</span>-th example of client <span id="S3.SS4.2.p2.2.3" class="ltx_text ltx_font_italic">c</span> and <math id="S3.SS4.2.p2.2.m2.1" class="ltx_Math" alttext="n^{(c)}" display="inline"><semantics id="S3.SS4.2.p2.2.m2.1a"><msup id="S3.SS4.2.p2.2.m2.1.2" xref="S3.SS4.2.p2.2.m2.1.2.cmml"><mi id="S3.SS4.2.p2.2.m2.1.2.2" xref="S3.SS4.2.p2.2.m2.1.2.2.cmml">n</mi><mrow id="S3.SS4.2.p2.2.m2.1.1.1.3" xref="S3.SS4.2.p2.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS4.2.p2.2.m2.1.1.1.3.1" xref="S3.SS4.2.p2.2.m2.1.2.cmml">(</mo><mi id="S3.SS4.2.p2.2.m2.1.1.1.1" xref="S3.SS4.2.p2.2.m2.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.SS4.2.p2.2.m2.1.1.1.3.2" xref="S3.SS4.2.p2.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.2.p2.2.m2.1b"><apply id="S3.SS4.2.p2.2.m2.1.2.cmml" xref="S3.SS4.2.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS4.2.p2.2.m2.1.2.1.cmml" xref="S3.SS4.2.p2.2.m2.1.2">superscript</csymbol><ci id="S3.SS4.2.p2.2.m2.1.2.2.cmml" xref="S3.SS4.2.p2.2.m2.1.2.2">𝑛</ci><ci id="S3.SS4.2.p2.2.m2.1.1.1.1.cmml" xref="S3.SS4.2.p2.2.m2.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.2.p2.2.m2.1c">n^{(c)}</annotation></semantics></math> is the size of sampled mini-batch of client <span id="S3.SS4.2.p2.2.4" class="ltx_text ltx_font_italic">c</span>. In addition, we can also consider the latter term of formula (<a href="#S3.E8" title="In 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) as follows according to central limit theorem:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.6" class="ltx_Math" alttext="\mathcal{N}\left(0,\frac{\sigma^{2}L^{2}I}{n^{(c)}}\right)=\frac{\sum_{i=1}^{n^{(c)}}\mathcal{N}\left(0,\sigma^{2}L^{2}I\right)}{n^{(c)}}" display="block"><semantics id="S3.E10.m1.6a"><mrow id="S3.E10.m1.6.7" xref="S3.E10.m1.6.7.cmml"><mrow id="S3.E10.m1.6.7.2" xref="S3.E10.m1.6.7.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.6.7.2.2" xref="S3.E10.m1.6.7.2.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.6.7.2.1" xref="S3.E10.m1.6.7.2.1.cmml">​</mo><mrow id="S3.E10.m1.6.7.2.3.2" xref="S3.E10.m1.6.7.2.3.1.cmml"><mo id="S3.E10.m1.6.7.2.3.2.1" xref="S3.E10.m1.6.7.2.3.1.cmml">(</mo><mn id="S3.E10.m1.6.6" xref="S3.E10.m1.6.6.cmml">0</mn><mo id="S3.E10.m1.6.7.2.3.2.2" xref="S3.E10.m1.6.7.2.3.1.cmml">,</mo><mfrac id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><mrow id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml"><msup id="S3.E10.m1.1.1.3.2" xref="S3.E10.m1.1.1.3.2.cmml"><mi id="S3.E10.m1.1.1.3.2.2" xref="S3.E10.m1.1.1.3.2.2.cmml">σ</mi><mn id="S3.E10.m1.1.1.3.2.3" xref="S3.E10.m1.1.1.3.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.3.1" xref="S3.E10.m1.1.1.3.1.cmml">​</mo><msup id="S3.E10.m1.1.1.3.3" xref="S3.E10.m1.1.1.3.3.cmml"><mi id="S3.E10.m1.1.1.3.3.2" xref="S3.E10.m1.1.1.3.3.2.cmml">L</mi><mn id="S3.E10.m1.1.1.3.3.3" xref="S3.E10.m1.1.1.3.3.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.3.1a" xref="S3.E10.m1.1.1.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.3.4" xref="S3.E10.m1.1.1.3.4.cmml">I</mi></mrow><msup id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.3" xref="S3.E10.m1.1.1.1.3.cmml">n</mi><mrow id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.3.1" xref="S3.E10.m1.1.1.1.cmml">(</mo><mi id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.cmml">)</mo></mrow></msup></mfrac><mo id="S3.E10.m1.6.7.2.3.2.3" xref="S3.E10.m1.6.7.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.6.7.1" xref="S3.E10.m1.6.7.1.cmml">=</mo><mfrac id="S3.E10.m1.5.5" xref="S3.E10.m1.5.5.cmml"><mrow id="S3.E10.m1.4.4.3" xref="S3.E10.m1.4.4.3.cmml"><msubsup id="S3.E10.m1.4.4.3.4" xref="S3.E10.m1.4.4.3.4.cmml"><mo id="S3.E10.m1.4.4.3.4.2.2" xref="S3.E10.m1.4.4.3.4.2.2.cmml">∑</mo><mrow id="S3.E10.m1.4.4.3.4.2.3" xref="S3.E10.m1.4.4.3.4.2.3.cmml"><mi id="S3.E10.m1.4.4.3.4.2.3.2" xref="S3.E10.m1.4.4.3.4.2.3.2.cmml">i</mi><mo id="S3.E10.m1.4.4.3.4.2.3.1" xref="S3.E10.m1.4.4.3.4.2.3.1.cmml">=</mo><mn id="S3.E10.m1.4.4.3.4.2.3.3" xref="S3.E10.m1.4.4.3.4.2.3.3.cmml">1</mn></mrow><msup id="S3.E10.m1.2.2.1.1.1" xref="S3.E10.m1.2.2.1.1.1.cmml"><mi id="S3.E10.m1.2.2.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.3.cmml">n</mi><mrow id="S3.E10.m1.2.2.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.1.3.1" xref="S3.E10.m1.2.2.1.1.1.cmml">(</mo><mi id="S3.E10.m1.2.2.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.1.3.2" xref="S3.E10.m1.2.2.1.1.1.cmml">)</mo></mrow></msup></msubsup><mrow id="S3.E10.m1.4.4.3.3" xref="S3.E10.m1.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.4.4.3.3.3" xref="S3.E10.m1.4.4.3.3.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.4.4.3.3.2" xref="S3.E10.m1.4.4.3.3.2.cmml">​</mo><mrow id="S3.E10.m1.4.4.3.3.1.1" xref="S3.E10.m1.4.4.3.3.1.2.cmml"><mo id="S3.E10.m1.4.4.3.3.1.1.2" xref="S3.E10.m1.4.4.3.3.1.2.cmml">(</mo><mn id="S3.E10.m1.3.3.2.2" xref="S3.E10.m1.3.3.2.2.cmml">0</mn><mo id="S3.E10.m1.4.4.3.3.1.1.3" xref="S3.E10.m1.4.4.3.3.1.2.cmml">,</mo><mrow id="S3.E10.m1.4.4.3.3.1.1.1" xref="S3.E10.m1.4.4.3.3.1.1.1.cmml"><msup id="S3.E10.m1.4.4.3.3.1.1.1.2" xref="S3.E10.m1.4.4.3.3.1.1.1.2.cmml"><mi id="S3.E10.m1.4.4.3.3.1.1.1.2.2" xref="S3.E10.m1.4.4.3.3.1.1.1.2.2.cmml">σ</mi><mn id="S3.E10.m1.4.4.3.3.1.1.1.2.3" xref="S3.E10.m1.4.4.3.3.1.1.1.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.E10.m1.4.4.3.3.1.1.1.1" xref="S3.E10.m1.4.4.3.3.1.1.1.1.cmml">​</mo><msup id="S3.E10.m1.4.4.3.3.1.1.1.3" xref="S3.E10.m1.4.4.3.3.1.1.1.3.cmml"><mi id="S3.E10.m1.4.4.3.3.1.1.1.3.2" xref="S3.E10.m1.4.4.3.3.1.1.1.3.2.cmml">L</mi><mn id="S3.E10.m1.4.4.3.3.1.1.1.3.3" xref="S3.E10.m1.4.4.3.3.1.1.1.3.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.E10.m1.4.4.3.3.1.1.1.1a" xref="S3.E10.m1.4.4.3.3.1.1.1.1.cmml">​</mo><mi id="S3.E10.m1.4.4.3.3.1.1.1.4" xref="S3.E10.m1.4.4.3.3.1.1.1.4.cmml">I</mi></mrow><mo id="S3.E10.m1.4.4.3.3.1.1.4" xref="S3.E10.m1.4.4.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><msup id="S3.E10.m1.5.5.4" xref="S3.E10.m1.5.5.4.cmml"><mi id="S3.E10.m1.5.5.4.3" xref="S3.E10.m1.5.5.4.3.cmml">n</mi><mrow id="S3.E10.m1.5.5.4.1.1.3" xref="S3.E10.m1.5.5.4.cmml"><mo stretchy="false" id="S3.E10.m1.5.5.4.1.1.3.1" xref="S3.E10.m1.5.5.4.cmml">(</mo><mi id="S3.E10.m1.5.5.4.1.1.1" xref="S3.E10.m1.5.5.4.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E10.m1.5.5.4.1.1.3.2" xref="S3.E10.m1.5.5.4.cmml">)</mo></mrow></msup></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.6b"><apply id="S3.E10.m1.6.7.cmml" xref="S3.E10.m1.6.7"><eq id="S3.E10.m1.6.7.1.cmml" xref="S3.E10.m1.6.7.1"></eq><apply id="S3.E10.m1.6.7.2.cmml" xref="S3.E10.m1.6.7.2"><times id="S3.E10.m1.6.7.2.1.cmml" xref="S3.E10.m1.6.7.2.1"></times><ci id="S3.E10.m1.6.7.2.2.cmml" xref="S3.E10.m1.6.7.2.2">𝒩</ci><interval closure="open" id="S3.E10.m1.6.7.2.3.1.cmml" xref="S3.E10.m1.6.7.2.3.2"><cn type="integer" id="S3.E10.m1.6.6.cmml" xref="S3.E10.m1.6.6">0</cn><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><divide id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1"></divide><apply id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3"><times id="S3.E10.m1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.3.1"></times><apply id="S3.E10.m1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.2.1.cmml" xref="S3.E10.m1.1.1.3.2">superscript</csymbol><ci id="S3.E10.m1.1.1.3.2.2.cmml" xref="S3.E10.m1.1.1.3.2.2">𝜎</ci><cn type="integer" id="S3.E10.m1.1.1.3.2.3.cmml" xref="S3.E10.m1.1.1.3.2.3">2</cn></apply><apply id="S3.E10.m1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.3.1.cmml" xref="S3.E10.m1.1.1.3.3">superscript</csymbol><ci id="S3.E10.m1.1.1.3.3.2.cmml" xref="S3.E10.m1.1.1.3.3.2">𝐿</ci><cn type="integer" id="S3.E10.m1.1.1.3.3.3.cmml" xref="S3.E10.m1.1.1.3.3.3">2</cn></apply><ci id="S3.E10.m1.1.1.3.4.cmml" xref="S3.E10.m1.1.1.3.4">𝐼</ci></apply><apply id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1">superscript</csymbol><ci id="S3.E10.m1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.3">𝑛</ci><ci id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1">𝑐</ci></apply></apply></interval></apply><apply id="S3.E10.m1.5.5.cmml" xref="S3.E10.m1.5.5"><divide id="S3.E10.m1.5.5.5.cmml" xref="S3.E10.m1.5.5"></divide><apply id="S3.E10.m1.4.4.3.cmml" xref="S3.E10.m1.4.4.3"><apply id="S3.E10.m1.4.4.3.4.cmml" xref="S3.E10.m1.4.4.3.4"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.3.4.1.cmml" xref="S3.E10.m1.4.4.3.4">superscript</csymbol><apply id="S3.E10.m1.4.4.3.4.2.cmml" xref="S3.E10.m1.4.4.3.4"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.3.4.2.1.cmml" xref="S3.E10.m1.4.4.3.4">subscript</csymbol><sum id="S3.E10.m1.4.4.3.4.2.2.cmml" xref="S3.E10.m1.4.4.3.4.2.2"></sum><apply id="S3.E10.m1.4.4.3.4.2.3.cmml" xref="S3.E10.m1.4.4.3.4.2.3"><eq id="S3.E10.m1.4.4.3.4.2.3.1.cmml" xref="S3.E10.m1.4.4.3.4.2.3.1"></eq><ci id="S3.E10.m1.4.4.3.4.2.3.2.cmml" xref="S3.E10.m1.4.4.3.4.2.3.2">𝑖</ci><cn type="integer" id="S3.E10.m1.4.4.3.4.2.3.3.cmml" xref="S3.E10.m1.4.4.3.4.2.3.3">1</cn></apply></apply><apply id="S3.E10.m1.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.3">𝑛</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1">𝑐</ci></apply></apply><apply id="S3.E10.m1.4.4.3.3.cmml" xref="S3.E10.m1.4.4.3.3"><times id="S3.E10.m1.4.4.3.3.2.cmml" xref="S3.E10.m1.4.4.3.3.2"></times><ci id="S3.E10.m1.4.4.3.3.3.cmml" xref="S3.E10.m1.4.4.3.3.3">𝒩</ci><interval closure="open" id="S3.E10.m1.4.4.3.3.1.2.cmml" xref="S3.E10.m1.4.4.3.3.1.1"><cn type="integer" id="S3.E10.m1.3.3.2.2.cmml" xref="S3.E10.m1.3.3.2.2">0</cn><apply id="S3.E10.m1.4.4.3.3.1.1.1.cmml" xref="S3.E10.m1.4.4.3.3.1.1.1"><times id="S3.E10.m1.4.4.3.3.1.1.1.1.cmml" xref="S3.E10.m1.4.4.3.3.1.1.1.1"></times><apply id="S3.E10.m1.4.4.3.3.1.1.1.2.cmml" xref="S3.E10.m1.4.4.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.3.3.1.1.1.2.1.cmml" xref="S3.E10.m1.4.4.3.3.1.1.1.2">superscript</csymbol><ci id="S3.E10.m1.4.4.3.3.1.1.1.2.2.cmml" xref="S3.E10.m1.4.4.3.3.1.1.1.2.2">𝜎</ci><cn type="integer" id="S3.E10.m1.4.4.3.3.1.1.1.2.3.cmml" xref="S3.E10.m1.4.4.3.3.1.1.1.2.3">2</cn></apply><apply id="S3.E10.m1.4.4.3.3.1.1.1.3.cmml" xref="S3.E10.m1.4.4.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.3.3.1.1.1.3.1.cmml" xref="S3.E10.m1.4.4.3.3.1.1.1.3">superscript</csymbol><ci id="S3.E10.m1.4.4.3.3.1.1.1.3.2.cmml" xref="S3.E10.m1.4.4.3.3.1.1.1.3.2">𝐿</ci><cn type="integer" id="S3.E10.m1.4.4.3.3.1.1.1.3.3.cmml" xref="S3.E10.m1.4.4.3.3.1.1.1.3.3">2</cn></apply><ci id="S3.E10.m1.4.4.3.3.1.1.1.4.cmml" xref="S3.E10.m1.4.4.3.3.1.1.1.4">𝐼</ci></apply></interval></apply></apply><apply id="S3.E10.m1.5.5.4.cmml" xref="S3.E10.m1.5.5.4"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.4.2.cmml" xref="S3.E10.m1.5.5.4">superscript</csymbol><ci id="S3.E10.m1.5.5.4.3.cmml" xref="S3.E10.m1.5.5.4.3">𝑛</ci><ci id="S3.E10.m1.5.5.4.1.1.1.cmml" xref="S3.E10.m1.5.5.4.1.1.1">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.6c">\mathcal{N}\left(0,\frac{\sigma^{2}L^{2}I}{n^{(c)}}\right)=\frac{\sum_{i=1}^{n^{(c)}}\mathcal{N}\left(0,\sigma^{2}L^{2}I\right)}{n^{(c)}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.3.p3" class="ltx_para">
<p id="S3.SS4.3.p3.2" class="ltx_p">Therefore, we can rewrite formula (<a href="#S3.E8" title="In 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) as formula (<a href="#S3.E11" title="In Proof. ‣ 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>), which satisfies example-level differential privacy for each client according to Theorem 2 <span id="S3.SS4.3.p3.2.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S3.SS4.3.p3.2.2" class="ltx_text ltx_font_bold">?<span id="S3.SS4.3.p3.2.2.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span>. In addition, since <math id="S3.SS4.3.p3.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS4.3.p3.1.m1.1a"><mi id="S3.SS4.3.p3.1.m1.1.1" xref="S3.SS4.3.p3.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.3.p3.1.m1.1b"><ci id="S3.SS4.3.p3.1.m1.1.1.cmml" xref="S3.SS4.3.p3.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.3.p3.1.m1.1c">L</annotation></semantics></math> and <math id="S3.SS4.3.p3.2.m2.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS4.3.p3.2.m2.1a"><mi id="S3.SS4.3.p3.2.m2.1.1" xref="S3.SS4.3.p3.2.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.3.p3.2.m2.1b"><ci id="S3.SS4.3.p3.2.m2.1.1.cmml" xref="S3.SS4.3.p3.2.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.3.p3.2.m2.1c">\sigma</annotation></semantics></math> are the same for all clients, the privacy loss accumulated via moment accountant for each client in the distributed environment is the same. It also satisfies differential privacy in the distributed environment according to differential privacy parallel principle.</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<div id="S3.E11.m1.1.1.1" class="ltx_inline-block ltx_markedasmath ltx_transformed_outer" style="width:394.6pt;height:70.5pt;vertical-align:-8.4pt;"><span class="ltx_transformed_inner" style="transform:translate(121.9pt,-19.2pt) scale(2.61807706473437,2.61807706473437) ;">
<p id="S3.E11.m1.1.1.1.1" class="ltx_p"><math id="S3.E11.m1.1.1.1.1.m1.11" class="ltx_Math" alttext="\displaystyle g^{(c)}=\frac{\sum_{i=1}^{n^{(c)}}\frac{g\left(x_{i}^{(c)}\right)}{\max\left(1,\left\|g\left(x_{i}^{(c)}\right)\right\|_{2}/L\right)}+\mathcal{N}\left(0,\sigma^{2}L^{2}I\right)}{n^{(c)}}" display="inline"><semantics id="S3.E11.m1.1.1.1.1.m1.11a"><mrow id="S3.E11.m1.1.1.1.1.m1.11.12" xref="S3.E11.m1.1.1.1.1.m1.11.12.cmml"><msup id="S3.E11.m1.1.1.1.1.m1.11.12.2" xref="S3.E11.m1.1.1.1.1.m1.11.12.2.cmml"><mi id="S3.E11.m1.1.1.1.1.m1.11.12.2.2" xref="S3.E11.m1.1.1.1.1.m1.11.12.2.2.cmml">g</mi><mrow id="S3.E11.m1.1.1.1.1.m1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.11.12.2.cmml"><mo stretchy="false" id="S3.E11.m1.1.1.1.1.m1.1.1.1.3.1" xref="S3.E11.m1.1.1.1.1.m1.11.12.2.cmml">(</mo><mi id="S3.E11.m1.1.1.1.1.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E11.m1.1.1.1.1.m1.1.1.1.3.2" xref="S3.E11.m1.1.1.1.1.m1.11.12.2.cmml">)</mo></mrow></msup><mo id="S3.E11.m1.1.1.1.1.m1.11.12.1" xref="S3.E11.m1.1.1.1.1.m1.11.12.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E11.m1.1.1.1.1.m1.11.11" xref="S3.E11.m1.1.1.1.1.m1.11.11.cmml"><mfrac id="S3.E11.m1.1.1.1.1.m1.11.11a" xref="S3.E11.m1.1.1.1.1.m1.11.11.cmml"><mrow id="S3.E11.m1.1.1.1.1.m1.10.10.9" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.cmml"><mrow id="S3.E11.m1.1.1.1.1.m1.10.10.9.11" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.cmml"><msubsup id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.cmml"><mo id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.2" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.2.cmml">∑</mo><mrow id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.2" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.2.cmml">i</mi><mo id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.1" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.1.cmml">=</mo><mn id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.3" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.3.cmml">1</mn></mrow><msup id="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.cmml"><mi id="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.3.cmml">n</mi><mrow id="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.1.1.3.1" xref="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.cmml">(</mo><mi id="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.1.1.3.2" xref="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></msup></msubsup><mfrac id="S3.E11.m1.1.1.1.1.m1.8.8.7.7" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.cmml"><mrow id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.cmml"><mi id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.4" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.3" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.3.cmml">​</mo><mrow id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.cmml"><mo id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.2" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.cmml">(</mo><msubsup id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.cmml"><mi id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.2.2" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.2.2.cmml">x</mi><mi id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.2.3" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.2.3.cmml">i</mi><mrow id="S3.E11.m1.1.1.1.1.m1.3.3.2.2.1.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.1.1.1.1.m1.3.3.2.2.1.1.1.3.1" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.cmml">(</mo><mi id="S3.E11.m1.1.1.1.1.m1.3.3.2.2.1.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.3.3.2.2.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E11.m1.1.1.1.1.m1.3.3.2.2.1.1.1.3.2" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.3" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.5.cmml"><mi id="S3.E11.m1.1.1.1.1.m1.6.6.5.5.4.2" xref="S3.E11.m1.1.1.1.1.m1.6.6.5.5.4.2.cmml">max</mi><mo id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4a" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.5.cmml">⁡</mo><mrow id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.5.cmml"><mo id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.2" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.5.cmml">(</mo><mn id="S3.E11.m1.1.1.1.1.m1.7.7.6.6.5.3" xref="S3.E11.m1.1.1.1.1.m1.7.7.6.6.5.3.cmml">1</mn><mo id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.3" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.5.cmml">,</mo><mrow id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.cmml"><msub id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.cmml"><mrow id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.2.cmml"><mo id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E11.m1.1.1.1.1.m1.5.5.4.4.3.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.1.1.1.1.m1.5.5.4.4.3.1.1.3.1" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E11.m1.1.1.1.1.m1.5.5.4.4.3.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.5.5.4.4.3.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E11.m1.1.1.1.1.m1.5.5.4.4.3.1.1.3.2" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.3.cmml">2</mn></msub><mo id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.2" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.2.cmml">/</mo><mi id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.3.cmml">L</mi></mrow><mo id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.4" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.5.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.E11.m1.1.1.1.1.m1.10.10.9.10" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.10.cmml">+</mo><mrow id="S3.E11.m1.1.1.1.1.m1.10.10.9.9" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.3" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.2" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.2.cmml">​</mo><mrow id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.2.cmml"><mo id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.2" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.2.cmml">(</mo><mn id="S3.E11.m1.1.1.1.1.m1.9.9.8.8" xref="S3.E11.m1.1.1.1.1.m1.9.9.8.8.cmml">0</mn><mo id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.2.cmml">,</mo><mrow id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.cmml"><msup id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2.cmml"><mi id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2.2.cmml">σ</mi><mn id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2.3" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.1.cmml">​</mo><msup id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3.cmml"><mi id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3.2" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3.2.cmml">L</mi><mn id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3.3" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.1a" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.1.cmml">​</mo><mi id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.4" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.4.cmml">I</mi></mrow><mo id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.4" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.2.cmml">)</mo></mrow></mrow></mrow><msup id="S3.E11.m1.1.1.1.1.m1.11.11.10" xref="S3.E11.m1.1.1.1.1.m1.11.11.10.cmml"><mi id="S3.E11.m1.1.1.1.1.m1.11.11.10.3" xref="S3.E11.m1.1.1.1.1.m1.11.11.10.3.cmml">n</mi><mrow id="S3.E11.m1.1.1.1.1.m1.11.11.10.1.1.3" xref="S3.E11.m1.1.1.1.1.m1.11.11.10.cmml"><mo stretchy="false" id="S3.E11.m1.1.1.1.1.m1.11.11.10.1.1.3.1" xref="S3.E11.m1.1.1.1.1.m1.11.11.10.cmml">(</mo><mi id="S3.E11.m1.1.1.1.1.m1.11.11.10.1.1.1" xref="S3.E11.m1.1.1.1.1.m1.11.11.10.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E11.m1.1.1.1.1.m1.11.11.10.1.1.3.2" xref="S3.E11.m1.1.1.1.1.m1.11.11.10.cmml">)</mo></mrow></msup></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1.1.1.1.m1.11b"><apply id="S3.E11.m1.1.1.1.1.m1.11.12.cmml" xref="S3.E11.m1.1.1.1.1.m1.11.12"><eq id="S3.E11.m1.1.1.1.1.m1.11.12.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.11.12.1"></eq><apply id="S3.E11.m1.1.1.1.1.m1.11.12.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.11.12.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.m1.11.12.2.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.11.12.2">superscript</csymbol><ci id="S3.E11.m1.1.1.1.1.m1.11.12.2.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.11.12.2.2">𝑔</ci><ci id="S3.E11.m1.1.1.1.1.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.1.1.1.1">𝑐</ci></apply><apply id="S3.E11.m1.1.1.1.1.m1.11.11.cmml" xref="S3.E11.m1.1.1.1.1.m1.11.11"><divide id="S3.E11.m1.1.1.1.1.m1.11.11.11.cmml" xref="S3.E11.m1.1.1.1.1.m1.11.11"></divide><apply id="S3.E11.m1.1.1.1.1.m1.10.10.9.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9"><plus id="S3.E11.m1.1.1.1.1.m1.10.10.9.10.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.10"></plus><apply id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11"><apply id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1">subscript</csymbol><sum id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.2"></sum><apply id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3"><eq id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.1"></eq><ci id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.11.1.2.3.3">1</cn></apply></apply><apply id="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.3">𝑛</ci><ci id="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.2.2.1.1.1.1.1.1">𝑐</ci></apply></apply><apply id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7"><divide id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.7.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7"></divide><apply id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2"><times id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.3"></times><ci id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.4.cmml" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.4">𝑔</ci><apply id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.2.2">𝑥</ci><ci id="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.4.4.3.3.2.2.1.1.2.3">𝑖</ci></apply><ci id="S3.E11.m1.1.1.1.1.m1.3.3.2.2.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.3.3.2.2.1.1.1.1">𝑐</ci></apply></apply><apply id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.5.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4"><max id="S3.E11.m1.1.1.1.1.m1.6.6.5.5.4.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.6.6.5.5.4.2"></max><cn type="integer" id="S3.E11.m1.1.1.1.1.m1.7.7.6.6.5.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.7.7.6.6.5.3">1</cn><apply id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1"><divide id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.2"></divide><apply id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1">subscript</csymbol><apply id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1"><csymbol cd="latexml" id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.2">norm</csymbol><apply id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1"><times id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.2"></times><ci id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.3">𝑔</ci><apply id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E11.m1.1.1.1.1.m1.5.5.4.4.3.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.5.5.4.4.3.1.1.1">𝑐</ci></apply></apply></apply><cn type="integer" id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.1.3">2</cn></apply><ci id="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.8.8.7.7.6.4.1.1.3">𝐿</ci></apply></apply></apply></apply><apply id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9"><times id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.2"></times><ci id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.3">𝒩</ci><interval closure="open" id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1"><cn type="integer" id="S3.E11.m1.1.1.1.1.m1.9.9.8.8.cmml" xref="S3.E11.m1.1.1.1.1.m1.9.9.8.8">0</cn><apply id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1"><times id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.1"></times><apply id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2">superscript</csymbol><ci id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2.2">𝜎</ci><cn type="integer" id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.2.3">2</cn></apply><apply id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3">superscript</csymbol><ci id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3.2">𝐿</ci><cn type="integer" id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.3.3">2</cn></apply><ci id="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.4.cmml" xref="S3.E11.m1.1.1.1.1.m1.10.10.9.9.1.1.1.4">𝐼</ci></apply></interval></apply></apply><apply id="S3.E11.m1.1.1.1.1.m1.11.11.10.cmml" xref="S3.E11.m1.1.1.1.1.m1.11.11.10"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.m1.11.11.10.2.cmml" xref="S3.E11.m1.1.1.1.1.m1.11.11.10">superscript</csymbol><ci id="S3.E11.m1.1.1.1.1.m1.11.11.10.3.cmml" xref="S3.E11.m1.1.1.1.1.m1.11.11.10.3">𝑛</ci><ci id="S3.E11.m1.1.1.1.1.m1.11.11.10.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.m1.11.11.10.1.1.1">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1.1.1.1.m1.11c">\displaystyle g^{(c)}=\frac{\sum_{i=1}^{n^{(c)}}\frac{g\left(x_{i}^{(c)}\right)}{\max\left(1,\left\|g\left(x_{i}^{(c)}\right)\right\|_{2}/L\right)}+\mathcal{N}\left(0,\sigma^{2}L^{2}I\right)}{n^{(c)}}</annotation></semantics></math></p>
</span></div>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="0" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.4.p4" class="ltx_para">
<p id="S3.SS4.4.p4.1" class="ltx_p">∎</p>
</div>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Results</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We evaluate H-FL on different datasets and compare the performance to FedAVG <span id="S4.p1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S4.p1.1.2" class="ltx_text ltx_font_bold">?<span id="S4.p1.1.2.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span>, STC <span id="S4.p1.1.3" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S4.p1.1.4" class="ltx_text ltx_font_bold">?<span id="S4.p1.1.4.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> and DGC <span id="S4.p1.1.5" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S4.p1.1.6" class="ltx_text ltx_font_bold">?<span id="S4.p1.1.6.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> in non-IID environments. Specifically, we have trained a modified version of <span id="S4.p1.1.7" class="ltx_text ltx_font_italic">LeNet5</span> <span id="S4.p1.1.8" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S4.p1.1.9" class="ltx_text ltx_font_bold">?<span id="S4.p1.1.9.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> network on FMNIST <span id="S4.p1.1.10" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S4.p1.1.11" class="ltx_text ltx_font_bold">?<span id="S4.p1.1.11.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> and a modified <span id="S4.p1.1.12" class="ltx_text ltx_font_italic">VGG16</span> <span id="S4.p1.1.13" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S4.p1.1.14" class="ltx_text ltx_font_bold">?<span id="S4.p1.1.14.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> network network on <span id="S4.p1.1.15" class="ltx_text ltx_font_italic">CIFAR10</span> <span id="S4.p1.1.16" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span><span id="S4.p1.1.17" class="ltx_text ltx_font_bold">?<span id="S4.p1.1.17.1" class="ltx_text ltx_font_medium" style="position:relative; bottom:0.9pt;">]</span></span> respectively. In addition, the first two CNN blocks of VGG16 and the first one CNN block of modified LeNet5 are set to the shallow part in practice. All the batch-normalization layers are removed in the shallow model. The experiment settings are listed in Table <a href="#S4.T2" title="Table 2 ‣ 4 Experimental Results ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<div id="S4.T2.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:394.6pt;height:67pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(38.4pt,-6.5pt) scale(1.24162493944371,1.24162493944371) ;">
<table id="S4.T2.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.3.3.3" class="ltx_tr">
<th id="S4.T2.3.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Dataset</th>
<th id="S4.T2.3.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Clients</th>
<th id="S4.T2.3.3.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Mediators</th>
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\eta</annotation></semantics></math></th>
<th id="S4.T2.3.3.3.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">classes per client</th>
<th id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S4.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="\mathcal{I}" display="inline"><semantics id="S4.T2.2.2.2.2.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><ci id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">\mathcal{I}</annotation></semantics></math></th>
<th id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S4.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S4.T2.3.3.3.3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.T2.3.3.3.3.m1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.1b"><ci id="S4.T2.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.1c">\mathcal{L}</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.3.3.4.1" class="ltx_tr">
<td id="S4.T2.3.3.4.1.1" class="ltx_td ltx_align_center ltx_border_t">CIFAR10</td>
<td id="S4.T2.3.3.4.1.2" class="ltx_td ltx_align_center ltx_border_t">100</td>
<td id="S4.T2.3.3.4.1.3" class="ltx_td ltx_align_center ltx_border_t">3</td>
<td id="S4.T2.3.3.4.1.4" class="ltx_td ltx_align_center ltx_border_t">0.015</td>
<td id="S4.T2.3.3.4.1.5" class="ltx_td ltx_align_center ltx_border_t">3</td>
<td id="S4.T2.3.3.4.1.6" class="ltx_td ltx_align_center ltx_border_t">10</td>
<td id="S4.T2.3.3.4.1.7" class="ltx_td ltx_align_center ltx_border_t">1</td>
</tr>
<tr id="S4.T2.3.3.5.2" class="ltx_tr">
<td id="S4.T2.3.3.5.2.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">FMNIST</td>
<td id="S4.T2.3.3.5.2.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">100</td>
<td id="S4.T2.3.3.5.2.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">3</td>
<td id="S4.T2.3.3.5.2.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.015</td>
<td id="S4.T2.3.3.5.2.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">2</td>
<td id="S4.T2.3.3.5.2.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">10</td>
<td id="S4.T2.3.3.5.2.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">1</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Experiment Settings</figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Behavior Of The Model Performance</h3>

<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel">
<div id="S4.F3.sf1.1" class="ltx_block ltx_minipage ltx_align_top" style="width:138.8pt;">
<img src="/html/2106.00275/assets/Bias_Corrector.png" id="S4.F3.sf1.1.g1" class="ltx_graphics ltx_img_square" width="698" height="617" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Effectiveness of Bias Corrector</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel">
<div id="S4.F3.sf2.1" class="ltx_block ltx_minipage ltx_align_top" style="width:138.8pt;">
<img src="/html/2106.00275/assets/FMNST_Overhead.png" id="S4.F3.sf2.1.g1" class="ltx_graphics ltx_img_square" width="698" height="617" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Communication Overhead On FMNIST</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F3.sf3" class="ltx_figure ltx_figure_panel">
<div id="S4.F3.sf3.1" class="ltx_block ltx_minipage ltx_align_top" style="width:138.8pt;">
<img src="/html/2106.00275/assets/CIFAR10_Overhead.png" id="S4.F3.sf3.1.g1" class="ltx_graphics ltx_img_square" width="698" height="617" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Communication Overhead On CIFAR10</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Effectiveness of the Bias Corrector and Communication Overhead</figcaption>
</figure>
<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Figure <a href="#S3.F2.sf1" title="In Figure 2 ‣ 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a> and Figure <a href="#S3.F2.sf2" title="In Figure 2 ‣ 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(b)</span></a> show the top-1 accuracy of <span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_italic">LeNet-5</span> on FMNIST after 200 communication rounds and the accuracy of <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_italic">VGG16</span> on <span id="S4.SS1.p1.1.3" class="ltx_text ltx_font_italic">CIFAR10</span> after 2000 communication rounds respectively using H-FL and the aforementioned three methods. The magenta dotted line refers to an accuracy of 80%. The experiment results show that H-FL outperforms the other methods both on convergence rate and final accuracy. The results are quite reasonable since H-FL reconstructs a series of virtual distributions <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="p^{(m)}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msup id="S4.SS1.p1.1.m1.1.2" xref="S4.SS1.p1.1.m1.1.2.cmml"><mi id="S4.SS1.p1.1.m1.1.2.2" xref="S4.SS1.p1.1.m1.1.2.2.cmml">p</mi><mrow id="S4.SS1.p1.1.m1.1.1.1.3" xref="S4.SS1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.1.m1.1.1.1.3.1" xref="S4.SS1.p1.1.m1.1.2.cmml">(</mo><mi id="S4.SS1.p1.1.m1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S4.SS1.p1.1.m1.1.1.1.3.2" xref="S4.SS1.p1.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2">superscript</csymbol><ci id="S4.SS1.p1.1.m1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2">𝑝</ci><ci id="S4.SS1.p1.1.m1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">p^{(m)}</annotation></semantics></math>s, each of which is more closer to the potential global distribution and the optimization problem under non-IID is almost turn into that under IID. Thus, H-FL have the better capability to handle the heterogeneous dataset. Specifically, we take the average of the last 10 rounds of the accuracy as the final accuracy after 200 rounds on FMNIST and 2000 rounds on CIFAR10 respectively. H-FL achieves an accuracy of 88.16% on FMNIST, whereas FedAVG, DGC and STC only achieve 82.28%, 82.00%, and 82.12% respectively. Moreover H-FL achieves an accuracy of 87.28% on CIFAR10, whereas FedAVG, DGC and STC only achieve 73.83%, 81.25% and 81.24%.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Influence Of Different Parameters For H-FL</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.9" class="ltx_p">From Figure <a href="#S3.F2.sf3" title="In Figure 2 ‣ 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(c)</span></a>, Figure <a href="#S3.F2.sf4" title="In Figure 2 ‣ 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(d)</span></a> and Figure <a href="#S3.F2.sf5" title="In Figure 2 ‣ 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(e)</span></a>, we can observe that as <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mathcal{P}</annotation></semantics></math>, <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\mathcal{S}</annotation></semantics></math> and <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\mathcal{C}</annotation></semantics></math> increase, the model performance and the convergence behavior are getting better. The phenomenon is quite reasonable because: 1) As aforementioned, the procedure of reconstructing distributions in H-FL is closely related to the training samples of each client. The larger <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\mathcal{P}</annotation></semantics></math> and <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\mathcal{S}</annotation></semantics></math> are, the more the training samples are, and the closer the reconstructed distribution is to the potential global distribution, thus reducing the impact of non-IID and obtaining a relatively ideal effect; 2) The number of training samples of each client has a great impact on noise injecting. As <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">\mathcal{S}</annotation></semantics></math> increase, the number of training samples of each client becomes larger, so that the <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="n^{(c)}" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><msup id="S4.SS2.p1.7.m7.1.2" xref="S4.SS2.p1.7.m7.1.2.cmml"><mi id="S4.SS2.p1.7.m7.1.2.2" xref="S4.SS2.p1.7.m7.1.2.2.cmml">n</mi><mrow id="S4.SS2.p1.7.m7.1.1.1.3" xref="S4.SS2.p1.7.m7.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.7.m7.1.1.1.3.1" xref="S4.SS2.p1.7.m7.1.2.cmml">(</mo><mi id="S4.SS2.p1.7.m7.1.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S4.SS2.p1.7.m7.1.1.1.3.2" xref="S4.SS2.p1.7.m7.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.2.cmml" xref="S4.SS2.p1.7.m7.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.2.1.cmml" xref="S4.SS2.p1.7.m7.1.2">superscript</csymbol><ci id="S4.SS2.p1.7.m7.1.2.2.cmml" xref="S4.SS2.p1.7.m7.1.2.2">𝑛</ci><ci id="S4.SS2.p1.7.m7.1.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">n^{(c)}</annotation></semantics></math> in Formula <a href="#S3.E8" title="In 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> will be larger and the injected noise is correspondingly small; 3) As <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><ci id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">\mathcal{C}</annotation></semantics></math> increases, the lossy compression becomes less and less effective and the behavior will get better. In addition, as the noise level <math id="S4.SS2.p1.9.m9.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS2.p1.9.m9.1a"><mi id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><ci id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">\sigma</annotation></semantics></math> increases in Figure <a href="#S3.F2.sf6" title="In Figure 2 ‣ 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(f)</span></a>, the oscillation amplitude of the accuracy curve becomes larger, the convergence speed becomes slower and the model performance becomes worse.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Effectiveness Of The Bias Corrector</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.2" class="ltx_p">Figure <a href="#S4.F3.sf1" title="In Figure 3 ‣ 4.1 Behavior Of The Model Performance ‣ 4 Experimental Results ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(a)</span></a> shows the top-1 accuracy of <span id="S4.SS3.p1.2.1" class="ltx_text ltx_font_italic">VGG16</span> on <span id="S4.SS3.p1.2.2" class="ltx_text ltx_font_italic">CIFAR10</span> with and without the bias corrector. The black dotted line refers to an accuracy of 85%. As we can see, bias corrector has significant influence on the convergence behavior and the final accuracy of H-FL. When there exists the bias corrector, the accuracy of the global model converges to 85% around 1000 rounds. Whereas when we remove the bias corrector, the accuracy gradually approximates to 85% until 2000 rounds. Additionally, we take the average of the last 10 rounds of the accuracy as the final accuracy after 2000 rounds, and the bias corrector can achieve an improvement of 2.47 percentage points. The result of the experiment is in line with our expectation since the bias corrector gives a relatively precise approximation of <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="dW^{(c)}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.2" xref="S4.SS3.p1.1.m1.1.2.cmml"><mi id="S4.SS3.p1.1.m1.1.2.2" xref="S4.SS3.p1.1.m1.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.1.m1.1.2.1" xref="S4.SS3.p1.1.m1.1.2.1.cmml">​</mo><msup id="S4.SS3.p1.1.m1.1.2.3" xref="S4.SS3.p1.1.m1.1.2.3.cmml"><mi id="S4.SS3.p1.1.m1.1.2.3.2" xref="S4.SS3.p1.1.m1.1.2.3.2.cmml">W</mi><mrow id="S4.SS3.p1.1.m1.1.1.1.3" xref="S4.SS3.p1.1.m1.1.2.3.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m1.1.1.1.3.1" xref="S4.SS3.p1.1.m1.1.2.3.cmml">(</mo><mi id="S4.SS3.p1.1.m1.1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S4.SS3.p1.1.m1.1.1.1.3.2" xref="S4.SS3.p1.1.m1.1.2.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.2"><times id="S4.SS3.p1.1.m1.1.2.1.cmml" xref="S4.SS3.p1.1.m1.1.2.1"></times><ci id="S4.SS3.p1.1.m1.1.2.2.cmml" xref="S4.SS3.p1.1.m1.1.2.2">𝑑</ci><apply id="S4.SS3.p1.1.m1.1.2.3.cmml" xref="S4.SS3.p1.1.m1.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.2.3.1.cmml" xref="S4.SS3.p1.1.m1.1.2.3">superscript</csymbol><ci id="S4.SS3.p1.1.m1.1.2.3.2.cmml" xref="S4.SS3.p1.1.m1.1.2.3.2">𝑊</ci><ci id="S4.SS3.p1.1.m1.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">dW^{(c)}</annotation></semantics></math> when it can’t be calculated directly, and once we remove the bias corrector, it will obtain a biased <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="dW^{(c)}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.2" xref="S4.SS3.p1.2.m2.1.2.cmml"><mi id="S4.SS3.p1.2.m2.1.2.2" xref="S4.SS3.p1.2.m2.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.1.2.1" xref="S4.SS3.p1.2.m2.1.2.1.cmml">​</mo><msup id="S4.SS3.p1.2.m2.1.2.3" xref="S4.SS3.p1.2.m2.1.2.3.cmml"><mi id="S4.SS3.p1.2.m2.1.2.3.2" xref="S4.SS3.p1.2.m2.1.2.3.2.cmml">W</mi><mrow id="S4.SS3.p1.2.m2.1.1.1.3" xref="S4.SS3.p1.2.m2.1.2.3.cmml"><mo stretchy="false" id="S4.SS3.p1.2.m2.1.1.1.3.1" xref="S4.SS3.p1.2.m2.1.2.3.cmml">(</mo><mi id="S4.SS3.p1.2.m2.1.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S4.SS3.p1.2.m2.1.1.1.3.2" xref="S4.SS3.p1.2.m2.1.2.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.2.cmml" xref="S4.SS3.p1.2.m2.1.2"><times id="S4.SS3.p1.2.m2.1.2.1.cmml" xref="S4.SS3.p1.2.m2.1.2.1"></times><ci id="S4.SS3.p1.2.m2.1.2.2.cmml" xref="S4.SS3.p1.2.m2.1.2.2">𝑑</ci><apply id="S4.SS3.p1.2.m2.1.2.3.cmml" xref="S4.SS3.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.2.3.1.cmml" xref="S4.SS3.p1.2.m2.1.2.3">superscript</csymbol><ci id="S4.SS3.p1.2.m2.1.2.3.2.cmml" xref="S4.SS3.p1.2.m2.1.2.3.2">𝑊</ci><ci id="S4.SS3.p1.2.m2.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">dW^{(c)}</annotation></semantics></math>, leading to the degradation in model performance and other metrics (convergence behavior).</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Communication Overhead</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">Finally, we compare the different methods with respect to the communication overhead which are required to achieve a certain target accuracy. As we can see in the Figure <a href="#S3.F2.sf1" title="In Figure 2 ‣ 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a> and Figure <a href="#S3.F2.sf2" title="In Figure 2 ‣ 3.4 Compression-Correction Mechanism ‣ 3 Our Approach ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(b)</span></a>, the convergence behavior is much better than other methods, which considerably reduces the communication rounds. Notice that FedAVG does not converge on <span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_italic">CIFAR10</span>, thus we do not show that in Figure <a href="#S4.F3.sf3" title="In Figure 3 ‣ 4.1 Behavior Of The Model Performance ‣ 4 Experimental Results ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(c)</span></a>. To compare the communication overhead, we set a window of size 10, which is utilized to calculate an average of 10 rounds. The communication overhead accumulates while moving forward the window until the average accuracy is no less than the target accuracy (80% in our experiments). Figure <a href="#S4.F3.sf2" title="In Figure 3 ‣ 4.1 Behavior Of The Model Performance ‣ 4 Experimental Results ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(b)</span></a> and Figure <a href="#S4.F3.sf3" title="In Figure 3 ‣ 4.1 Behavior Of The Model Performance ‣ 4 Experimental Results ‣ H-FL: A Hierarchical Communication-Efficient and Privacy-Protected Architecture for Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(c)</span></a> show the communication overhead required to achieve the target accuracy for the different methods on <span id="S4.SS4.p1.1.2" class="ltx_text ltx_font_italic">FMNIST</span> and <span id="S4.SS4.p1.1.3" class="ltx_text ltx_font_italic">CIFAR10</span> respectively.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we present a <span id="S5.p1.1.1" class="ltx_text ltx_font_bold">H</span>ierarchical <span id="S5.p1.1.2" class="ltx_text ltx_font_bold">F</span>ederated <span id="S5.p1.1.3" class="ltx_text ltx_font_bold">L</span>earning architecture (H-FL) to find a great balance among model performance, communication overhead and privacy requirements. Firstly, we devise a runtime distribution reconstruction strategy to counter-weigh the degradation due to non-IID. Then we design a compression-correction mechanism to reduce the communication overhead without sacrificing the model performance. The experimental results have proved that H-FL achieves the state-of-the-art performance under different federated learning tasks.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">We would like to thank anonymous reviewers for their helpful comments. This work was supported by the the National Key Research and Development Program of China (No. 2018AAA0100500), NSFC Grant No. 61872285, 62072367, 61772413, the Key Research and Development Program of Shaanxi Province (2020GY-033), Key Science and Technology Project of Henan Province (201300210400), Fundamental Research Funds for the Central Universities (xzy012020112).</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bibx1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx1.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Abadi <span id="bib.bibx1.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2016<span id="bib.bibx1.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Martin Abadi, Andy Chu, Ian Goodfellow, H Brendan McMahan, Ilya Mironov, Kunal
Talwar, and Li Zhang.

</span>
<span class="ltx_bibblock">Deep learning with differential privacy.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx1.6.1" class="ltx_text ltx_font_italic">Proceedings of the 2016 ACM SIGSAC Conference on Computer and
Communications Security</span>, pages 308–318, 2016.

</span>
</li>
<li id="bib.bibx2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx2.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Kairouz <span id="bib.bibx2.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2019<span id="bib.bibx2.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Peter Kairouz, H Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi
Bennis, Arjun Nitin Bhagoji, Keith Bonawitz, Zachary Charles, Graham Cormode,
Rachel Cummings, et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bibx2.6.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1912.04977</span>, 2019.

</span>
</li>
<li id="bib.bibx3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx3.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Konečnỳ <span id="bib.bibx3.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2016<span id="bib.bibx3.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Jakub Konečnỳ, H Brendan McMahan, Felix X Yu, Peter Richtárik,
Ananda Theertha Suresh, and Dave Bacon.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication
efficiency.

</span>
<span class="ltx_bibblock"><span id="bib.bibx3.6.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1610.05492</span>, 2016.

</span>
</li>
<li id="bib.bibx4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx4.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Krizhevsky <span id="bib.bibx4.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2009<span id="bib.bibx4.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Alex Krizhevsky, Geoffrey Hinton, et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock"><span id="bib.bibx4.6.1" class="ltx_text ltx_font_italic">Master’s thesis, University of Tront</span>, 2009.

</span>
</li>
<li id="bib.bibx5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx5.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>LeCun <span id="bib.bibx5.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 1998<span id="bib.bibx5.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Yann LeCun, Léon Bottou, Yoshua Bengio, and Patrick Haffner.

</span>
<span class="ltx_bibblock">Gradient-based learning applied to document recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bibx5.6.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE</span>, 86(11):2278–2324, 1998.

</span>
</li>
<li id="bib.bibx6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx6.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Li <span id="bib.bibx6.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2020<span id="bib.bibx6.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Ameet Talwalkar, and Virginia Smith.

</span>
<span class="ltx_bibblock">Federated learning: Challenges, methods, and future directions.

</span>
<span class="ltx_bibblock"><span id="bib.bibx6.6.1" class="ltx_text ltx_font_italic">IEEE Signal Processing Magazine</span>, 37(3):50–60, 2020.

</span>
</li>
<li id="bib.bibx7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx7.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Lin <span id="bib.bibx7.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2017<span id="bib.bibx7.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Yujun Lin, Song Han, Huizi Mao, Yu Wang, and William J Dally.

</span>
<span class="ltx_bibblock">Deep gradient compression: Reducing the communication bandwidth for
distributed training.

</span>
<span class="ltx_bibblock"><span id="bib.bibx7.6.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1712.01887</span>, 2017.

</span>
</li>
<li id="bib.bibx8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx8.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Lin <span id="bib.bibx8.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2018<span id="bib.bibx8.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Yujun Lin, Song Han, Huizi Mao, Yu Wang, and William J Dally.

</span>
<span class="ltx_bibblock">Deep Gradient Compression: Reducing the communication bandwidth for
distributed training.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx8.6.1" class="ltx_text ltx_font_italic">The International Conference on Learning Representations</span>,
2018.

</span>
</li>
<li id="bib.bibx9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx9.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>McMahan <span id="bib.bibx9.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2017a<span id="bib.bibx9.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx9.6.1" class="ltx_text ltx_font_italic">Artificial Intelligence and Statistics</span>, pages 1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bibx10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx10.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>McMahan <span id="bib.bibx10.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2017b<span id="bib.bibx10.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
H Brendan McMahan, Daniel Ramage, Kunal Talwar, and Li Zhang.

</span>
<span class="ltx_bibblock">Learning differentially private recurrent language models.

</span>
<span class="ltx_bibblock"><span id="bib.bibx10.6.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1710.06963</span>, 2017.

</span>
</li>
<li id="bib.bibx11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx11.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Rothchild <span id="bib.bibx11.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2020<span id="bib.bibx11.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Daniel Rothchild, Ashwinee Panda, Enayat Ullah, Nikita Ivkin, Ion Stoica,
Vladimir Braverman, Joseph Gonzalez, and Raman Arora.

</span>
<span class="ltx_bibblock">Fetchsgd: Communication-efficient federated learning with sketching.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx11.6.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
8253–8265. PMLR, 2020.

</span>
</li>
<li id="bib.bibx12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx12.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Sattler <span id="bib.bibx12.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2019<span id="bib.bibx12.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Felix Sattler, Simon Wiedemann, Klaus-Robert Müller, and Wojciech Samek.

</span>
<span class="ltx_bibblock">Robust and communication-efficient federated learning from non-iid
data.

</span>
<span class="ltx_bibblock"><span id="bib.bibx12.6.1" class="ltx_text ltx_font_italic">IEEE transactions on neural networks and learning systems</span>,
2019.

</span>
</li>
<li id="bib.bibx13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx13.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Simonyan and
Zisserman, 2014<span id="bib.bibx13.2.2.2" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Karen Simonyan and Andrew Zisserman.

</span>
<span class="ltx_bibblock">Very deep convolutional networks for large-scale image recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bibx13.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1409.1556</span>, 2014.

</span>
</li>
<li id="bib.bibx14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx14.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Vepakomma <span id="bib.bibx14.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2018<span id="bib.bibx14.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Praneeth Vepakomma, Otkrist Gupta, Tristan Swedish, and Ramesh Raskar.

</span>
<span class="ltx_bibblock">Split learning for health: Distributed deep learning without sharing
raw patient data.

</span>
<span class="ltx_bibblock"><span id="bib.bibx14.6.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.00564</span>, 2018.

</span>
</li>
<li id="bib.bibx15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx15.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Wei <span id="bib.bibx15.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2020<span id="bib.bibx15.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Kang Wei, Jun Li, Ming Ding, Chuan Ma, Howard H Yang, Farhad Farokhi, Shi Jin,
Tony QS Quek, and H Vincent Poor.

</span>
<span class="ltx_bibblock">Federated learning with differential privacy: Algorithms and
performance analysis.

</span>
<span class="ltx_bibblock"><span id="bib.bibx15.6.1" class="ltx_text ltx_font_italic">IEEE Transactions on Information Forensics and Security</span>, 2020.

</span>
</li>
<li id="bib.bibx16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx16.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Xiao <span id="bib.bibx16.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2017<span id="bib.bibx16.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Han Xiao, Kashif Rasul, and Roland Vollgraf.

</span>
<span class="ltx_bibblock">Fashion-mnist: a novel image dataset for benchmarking machine
learning algorithms.

</span>
<span class="ltx_bibblock"><span id="bib.bibx16.6.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1708.07747</span>, 2017.

</span>
</li>
<li id="bib.bibx17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx17.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Yang <span id="bib.bibx17.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2019<span id="bib.bibx17.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Qiang Yang, Yang Liu, Tianjian Chen, and Yongxin Tong.

</span>
<span class="ltx_bibblock">Federated machine learning: Concept and applications.

</span>
<span class="ltx_bibblock"><span id="bib.bibx17.6.1" class="ltx_text ltx_font_italic">ACM Transactions on Intelligent Systems and Technology (TIST)</span>,
10(2):1–19, 2019.

</span>
</li>
<li id="bib.bibx18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem"><span id="bib.bibx18.1.1.1" class="ltx_text" style="position:relative; bottom:0.9pt;">[</span>Zhang <span id="bib.bibx18.2.2.2" class="ltx_text ltx_font_italic">et al.</span>, 2021<span id="bib.bibx18.3.3.3" class="ltx_text" style="position:relative; bottom:0.9pt;">]</span> </span>
<span class="ltx_bibblock">
Qingsong Zhang, Bin Gu, Cheng Deng, and Heng Huang.

</span>
<span class="ltx_bibblock">Secure bilevel asynchronous vertical federated learning with backward
updating.

</span>
<span class="ltx_bibblock"><span id="bib.bibx18.6.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2103.00958</span>, 2021.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2106.00274" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2106.00275" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2106.00275">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2106.00275" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2106.00276" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Mar  3 22:42:32 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
